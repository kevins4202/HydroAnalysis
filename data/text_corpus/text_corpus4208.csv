index,text
21040,submerged breakwater as the main structure of coastal engineering to protect coast is widely laid on the seabed because of its significant wave dissipation performance to reveal the interaction mechanism between waves and submerged breakwater the hydrodynamic characteristics of a wave passing over different solid breakwaters were numerically and experimentally studied compared with the previous research considering breakwater made up of porous media and the effects of extreme waves generated by hurricanes or tsunamis this paper systematically investigates the effects of the semi circular porous medium breakwater on the breaking solitary wave run up based on a numerical model with the immersed boundary ib method the computational capability of this model is verified firstly then depending on the model a series of cases are carried out to research the effects of different breakwaters on the run up of solitary waves the results show that the influence of porous breakwater on wave propagation is more significant than that of the solid breakwater with the increase of the gravel particle median diameter the maximum run up height and the horizontal hydrodynamic force on the breakwater decrease while the vertical hydrodynamic force on the breakwater increases increasing the size of the breakwater is beneficial to reducing the wave run up height and the forces on the sloping beach compared with the single breakwater the impact of the tandem breakwater on the wave propagation is more significant keywords solitary wave porous media submerged breakwater flow field hydrodynamic load 1 introduction due to the submarine earthquake volcanic eruption submarine landslide or meteorological changes a large amount of energy is released into the ocean causing water oscillation and generating the water waves referred to as tsunamis when the tsunami reaches the shallow water coast the wave length decreases but the wave height increases sharply forming a water wall with the great energy some tsunamis have already caused a serious impact on human society zhao et al 2019a on december 26th 2004 more than 230 000 people were killed in the indian ocean earthquake and tsunami on march 11th 2011 a 9 0 magnitude earthquake triggered a huge tsunami the total number of casualties and missing persons is about 20 000 and many infrastructures were destroyed in japan on september 28th 2018 indonesia s sulawesi island suffered a strong tsunami several coastal cities were seriously damaged with a death toll of 1200 suppasri et al 2012a and b heidarzadeh et al 2018 suppasri et al 2012a 2012b heidarzadeh et al 2018 in order to reduce the disasters caused by the tsunami it is particularly important to investigate the hydrodynamic characteristics of the tsunami wave propagation and run up because tsunami wave and solitary wave are similar in stable waveform and small wave energy loss solitary wave is often used for the simulation of tsunami wave synolakis 1986 1987 synolakis 1986 1987 presented an approximate theory for non breaking waves and several empirical formulas for the maximum run up of solitary wave madsen and schäffer 2010 madsen and schäffer 2010 derived some analytical solutions of nonlinear shallow water equations for the solitary wave run up and run down liang et al 2013 liang et al 2013 numerically investigated the run up processes of solitary waves on a vertical wall using a shock capturing boussinesq type model xiao et al 2010 xiao et al 2010 numerically studied the transient wave propagation the sediment transport the morphological change and the seabed elastodynamics response when the solitary wave runs up and down on sloping beach through these studies the prediction of solitary wave run up height is conducive to the design of the angle and height of the bank however the strong action of the waves may damage the bunding and the wave will overtop the bunding and cause disaster once the wave run up height is higher than the bunding in order to protect the bunding and coast the submerged breakwater is developed and widely applied in harbor and coastal engineering as a buffer against wave damage flood and erosion when the wave passes over the submerged breakwater the interaction between the wave and breakwater can dissipate the wave energy reduce the run up and enhance the coastal resilience to better understand the breakwater effects on coastal protection extensive experiments and numerical studies have been carried out on the hydrodynamic characteristics of breakwater wave interaction in the past decades li and zhang 2019 li and zhang 2019 numerically studied the wave propagation after the wave passes through the submerged low crested breakwater indicating that the wave transmission coefficient is affected by the submerged depth of the breakwater and the wave steepness klonaris et al 2019 klonaris et al 2019 studied the bed morphodynamics in the lee of a submerged breakwater under the regular and irregular waves numerically and experimentally ji et al 2017 ji et al 2017 numerically studied the wave transformations around rectangle or trapezoid submerged breakwaters under regular wave and solitary wave barbosa lópez et al 2019 barbosa lópez et al 2019 investigated the hydrodynamic characteristics caused by the interaction between the linear long waves and the cycloidal geometric submerged breakwater and obtained the reflection and transmission coefficients and the free surface elevation li et al 2020 li et al 2020 analyzed the interaction between the water wave and a submerged fluid filled semi circular membrane breakwater up to now various types of submerged breakwater have been studied according to previous studies it is found that the semi circular caisson breakwater has certain advantages and has been applied in practical engineering fig 1 xie 1999 li et al 2019 xie 1999 li et al 2019 when the wave passes through the semi circle breakwater the hydrodynamic force on the breakwater causes almost zero overturning moments on the caisson with the high stability in addition this breakwater is easy to construct and dismantle and is suitable for the soft soil foundation therefore many studies about the rigid semi circular breakwater have been carried out however the submerged breakwater is usually constructed of porous media such as blocks silt stone and gravel losada et al 1996 losada et al 1996 predicted the change of regular waves passing through porous breakwaters liu et al 1999 liu et al 1999 simulated the interaction between the wave and the porous structure considering the mechanism of turbulence generation and dissipation metallinos et al 2019 metallinos et al 2019 used an extended boussinesq type model to simulate wave propagation over the submerged porous breakwater and predict the velocity distribution although some studies have been done on porous media the influence of semi circular marine structure with the porous media on the wave propagation is rarely studied according to the existing research it is important to investigate whether the submerged semi circular porous breakwater has a significant impact on the wave propagation especially under the extreme marine conditions given the inadequacy of the existing research about the protection of breakwater against the coast under the extreme wave the influence of the semi circular porous media breakwater on the run up of the solitary wave and the forces on the breakwater and the sloping beach are studied in this paper to reveal the hydrodynamic characteristics of solitary wave propagation the accurate simulation of this process depends on the coupling model of flow and porous medium modules based on immersed boundary ib method zhao et al 2020 zhao et al 2020 the rest of the paper is organized as follows section 2 introduces the model including the flow and the porous media modules the verification of this model is conducted depending on the experiment in section 3 section 4 discusses the effects of various submerged porous medium semi circular breakwaters on the different solitary waves and reveals some mechanisms of the interaction among the wave the breakwater and the sloping beach section 5 provides some concluding remarks 2 model description in the numerical model the flow module and the porous breakwater module are coupled using the immersed boundary ib method 2 1 flow module the mass and momentum conservation equations of the flow domain are written as 1 a u 0 2 u t 1 v f a u u 1 ρ p g f d where is the gradient operator u is the bulk velocity ρ is the fluid density p is the pressure g is the object acceleration vector f is the viscous acceleration vector of flow d is the flow loss reflected by forchheimer saturated drag in porous media in the immersed boundary method geometries of breakwater and sloping beach are constructed in the calculation domain given an object occupying the grid the grid is separated into two parts by the interface of the object i e the open volume part water and the object filling part breakwater depending on the open volume fraction in the grid the flow and porous volumes are divided in the grid based on the object parameters in order to calculate the mass and moment equations in one divided grid the fractional volume method is introduced a is the area fraction for the fluid in the mesh of cartesian coordinate system and vf is the volume fraction for the fluid according to the volume of fluid vof method combined with switching technique for advection and capturing of surfaces stacs darwish and moukalled 2006 darwish and moukalled 2006 the free surface transportation equation between water and air is defined as 3 γ t 1 v f γ a u 0 where γ is the water volume fraction in the cell of a free surface γ 0 0 γ 1 and γ 1 control the different phases of air interface and water the viscous acceleration vector f in three directions of cartesian coordinate can be written as 4 ρ v f f x s x x a x τ x x y a y τ x y z a z τ x z 5 ρ v f f y s y x a x τ y x y a y τ y y z a z τ y z 6 ρ v f f z s z x a x τ z x y a y τ z y z a z τ z z where s i x y z is wall stress in three directions τ is the term of shear stress to calculate the dynamic viscosity μ two equation κ ε turbulence model is introduced as 7 k t 1 v f u a x k x v a y k y w a z k z p t g t d ε 8 ε t 1 v f u a x ε x v a y ε y w a z ε z c 1 ε ε k p t c 3 ε g t d ε c 2 ε ε 2 k where k is the turbulent kinetic energy coefficient ε is turbulent energy dissipation rate u v and w are the velocities in x y and z directions pt is the turbulent kinetic energy production gt is buoyancy production term d and dε demonstrate diffusion terms and c1ε c2ε and c3ε are constant values respectively the flow characteristics are simulated using the incompressible flow solver with immersed boundary ifs ib zhao et al 2020 zhao et al 2019 zhao et al 2019b 2020 the finite volume method with the secondary order approximation scheme for derivatives of time and space is used to discrete the calculation domain pressure implicit split operator piso method is for velocity and pressure resolution and poisson equation is solved by generalized minimal residual gmres method at the inlet of the computational domain the solitary wave is generated based on mccowan s theory and the surface elevation is defined as mccowan 1891 wu 2004 mccowan 1891 wu 2004 9 η p h where η is the water elevation h is the still water depth p is the reference value calculated as follows 10 p e f sin f 1 p cos f 1 p cosh f x h 11 e 2 3 sin 2 f 1 2 h 3 h f e h h tan 1 2 f 1 h h 12 x x c 0 t the velocity is defined as 13 u c 0 e 1 cos f z h cosh f x h cos f z h cosh f x h 2 14 w c 0 e sin f z h sinh f x h cos f z h cosh f x h 2 where h is the wave height x and z represent the locations in horizontal and vertical directions in the coordinate system respectively c0 g h d 1 2 is the wave speed in still water t is the time the equations from 10 to 14 are nonlinear and solved using the newton raphson method the water elevation is initially estimated depending on boussinesq s solution as follows 15 η d ε sech 2 3 ε 4 x h where ε h h the initial estimates of e and f are 3ε 1 2 and 2ε respectively at the bottom of the simulation domain and the slope surface the nonslip wall conditions are imposed atmospheric pressure is applied on the top boundary and symmetric boundaries are used at two sides of the simulation domain 2 2 porous media module in the calculation domain the porous medium region is matched with the breakwater geometry based on the volume fraction method the mesh point and volume in the porous medium region are marked as porous medium mesh point and volume respectively fig 2 the flow rate through porous media is proportional to the applied pressure difference which is commonly referred to as the resistance in porous media module the resistance of a porous medium to flow is represented in the navier stokes equations as a drag term d when the water flows into and out of the porous media the hydrodynamic characteristics of the flow are affected by the forchheimer saturated drag d which is defined as losada et al 1996 liu et al 1999 lara et al 2006 lin and karunarathna 2007 losada et al 1996 liu et al 1999 lara et al 2006 lin and karunarathna 2007 16 d f d u m where fd is the porous media drag coefficient and u m is the microscopic flow velocity 17 f d μ n ρ k where n is the porous medium porosity the open volume in a porous medium divided by the total volume k is the intrinsic permeability factor of the material according to darcy law in henry darcy equation the relationship formula among the microscopic flow velocity u m the media effective porosity n the bulk velocity u the applied pressure difference p and the intrinsic permeability factor k is written as losada et al 1996 losada et al 1996 18 u m u n k n μ p where p is the pressure gradient in real space within the porous media the forchheimer s equation includes viscous linear and form quadratic drag terms so the pressure drop including both the linear and square functions of the velocity is given by 19 p μ n k 1 u m ρ n 2 k 2 u m u m 20 k 1 n 3 a 1 n 2 k 2 n 3 b 1 n where k1 and k2 are the darcian and non darcian inertial permeability respectively a and b are media specific loss coefficients which can be established as 21 a α d s 2 b β d s where α is a carman kozeny constant with a typical value of 180 derived from the hydraulic radius theory and β is a roughness factor defined as 2 9 ds is the average equivalent spherical diameter combining the above equations the forchheimer saturated drag d including the darcian and non darcian flow losses can be written as 22 f d u m 1 ρ p a μ ρ 1 n n 2 u m b 1 n n u m u m therefore the navier stokes equations in the porosity media material can be written as 23 u t 1 v f a u u 1 ρ p g f a μ 1 n 2 ρ n 3 u b 1 n n 3 u u when the porosity coefficient n is 0 the forchheimer saturated drag d approaches infinity which means that this region is covered by the solid structure when the porosity coefficient of n is 1 the forchheimer saturated drag d is void and the navier stokes equation is for the fluid which means that this region is covered by the fluid when the porosity coefficient is between 0 and 1 the fluid in the porosity medium is controlled by the forchheimer saturated drag d when the fluid reaches the porous medium area the forchheimer saturated drag d starts to act on the microscopic flow when it flows out the forchheimer saturated drag d disappears and the water flows without the effect of the porous medium 3 model validation the calculation accuracy of the numerical model in predicting the flow over the permeable medium and the wave run up height is verified in sections 3 1 and 3 2 besides the verification of the wave force on the structure has been carried out in previous works zhao et al 2019 2020 zhao et al 2019a 2020 3 1 solitary wave over permeable breakwater the experiments were conducted by wu and hsiao 2013 wu and hsiao 2013 the uniform glass spheres with a diameter of 1 50 cm are not staggered to form the breakwater with a porosity of 0 52 the permeable breakwater is with a length of 13 cm and a height of 6 5 cm the origin of the coordinate system is defined at the intersection of the left side of the breakwater and the bottom of the flume fig 3 shows the simulation layout the calculation domain is 15 m long and 0 25 m high the distance from the inlet to the left side of the breakwater is 5 m two wave gauges wg1 x 1 8 m wg2 x 1 8 m are set before and after the breakwater to measure the temporal evolution of the wave surface the still water depth h is 10 6 cm and the wave height h is 4 77 cm with the ratio of h d 0 45 the mesh resolution in the breakwater zone is 0 001 m fig 4 depicts the temporal evolution of water elevation between the simulation and experiment results recorded at wg1 and wg2 and fig 5 shows the wave surface comparisons at different times when the wave passes through the breakwater the flow is blocked by the porous media the velocity decreases and the flow field changes in addition the comparison results of horizontal and vertical velocity along the water depth are shown in fig 6 the time ranges from 1 45 s to 2 05 s with the interval of 0 2 s to sum up the numerical results of wave free surface and velocity agree well with experimental results and this model can accurately predict the solitary wave propagation over the permeable breakwater 3 2 wave run up in this section the numerical results of wave run up are compared to the experimental results from synolakis 1986 synolakis 1986 fig 7 shows the simulation layout where β is the sloping beach angle tanβ 0 05 the computational domain is 20 m long and 0 5 m high and the distance from the inlet boundary to the sloping toe is half of the wavelength the still water depth h and wave height h are 0 2 m and 0 06 m respectively the grid solution around the beach is 0 001 m fig 8 shows the comparison results of wave surface where the time scale of the calculation results has been shifted to be consistent with the experimental data t t g d 1 2 as the wave approaches the beach the wave length becomes shorter and shorter and the wave height increases due to the sloping beach barrier when the wave is very steep the wave breaks up at t 25 the water flows upward along the sloping beach and reaches the maximum height then the water drops along the sloping beach in both the run up and run down processes of solitary wave on the beach the results of predicted water surfaces are in good agreement with experimental data indicating that this model can predict the solitary wave propagation along the sloping beach accurately 4 results and discussion in this section the effects of semi circle gravel permeable breakwater on the run up of the solitary wave and the forces on the breakwater and the sloping beach are investigated the sketch of the experimental layout is depicted in fig 9 where the computing domain is 500 0 m in length and 16 0 m in height the distance from the submerged breakwater centroid o to the toe of the sloping beach is denoted as l r r n and l represent the wave run up height the breakwater radius the porosity coefficient and the unit width of the sloping beach respectively the still water depth h is kept at 6 0 m and the sloping beach angle β of the beach is the same tanβ 1 5 in all following simulations the grid resolution around the permeable breakwater and the beach is 0 001 m besides the impact of the breakwaters in tandem on the solitary wave propagation is also considered and s represents the distance between two breakwater centroids two wave elevation gauges wg1 and wg2 are located at x 195 m and x 205 m before and after the breakwater respectively in addition two velocity and turbulent kinetic energy tke sensors are installed at vs1 x 195 m z 1 5 m and vs2 x 205 m z 1 5 m the turbulent kinetic energy tke is defined as 24 t k e ρ 2 u 2 w 2 d v where u and w are the velocity magnitudes in x and z directions associated with chaotic turbulent fluctuations which are equal to 10 of the mean flow velocity in the undisturbed flow the hydrodynamic forces on the breakwater and the beach are calculated considering the flow pressure the shear stress and the pore pressure in the porous breakwater to better analyze and compare the forces the hydrodynamic forces are normalized as 25 f n 2 f tan β ρ g l h 2 4 1 effect of porous medium characteristics since the characteristics of the gravel permeable breakwaters are different the effects of the porosity coefficient n and medium diameter d50 on the wave run up and the forces on the breakwater and the sloping beach are analyzed in this section the wave height h is 2 m and the radius r of the breakwater is 3 m the distance l between the breakwater and the sloping beach is 50 m 4 1 1 porosity coefficient seven porosity coefficients n are set as 0 0 0 2 0 4 0 5 0 6 0 8 and 1 0 and the medium diameter d50 is 0 3 m fig 10 shows the velocity contours of the flow fields at 15 16 2 and 18 6 s under different porosities when the wave approaches the breakwater for the first time t 15 s the flow velocity around the solid breakwater n 0 0 is higher than that around the porous breakwater with the increase in porosity the velocity in the breakwater increases because large pores allow more water to enter at 16 2 s when the wave crest is above the breakwater the velocity on the breakwater reaches the maximum after the wave passes over the breakwater at 18 6 s it is found that the velocity behind the breakwater increases with the increase of the porosity because the larger the porosity the more fluid seeps out fig 11 depicts the vorticity contours of the flow fields around the breakwaters with the different porosities at 15 18 6 and 21 s when the wave arrives the vortex attached to the breakwater is generated due to the seepage of pores the streamlines passing through the porous breakwater are deflected after the wave crosses the breakwater at 18 6 s the vortices become larger compared with the vortices behind the solid breakwater the vortices behind the porous breakwater are much bigger when the time is 21 s the vortex sheds from the breakwater and the patterns of vortices are different two reasons are inferred here firstly when the wave passes over the breakwater the flow circumfluence occurs behind the breakwater when the breakwater is solid the vortex adheres to the breakwater and the seabed however when the breakwater is porosity besides the circumfluence water some water seeps out of the breakwater and the interaction between the two kinds of water will lead to the increase of turbulent intensity and vorticity secondly the greater the porosity the stronger the flow intensity of the seepage water resulting in the larger vortex and the faster shedding speed figs 12 and 13 show the velocity and the turbulent kinetic energy tke contours on the sloping beach after the wave passes through the breakwater from 20 4 s to 39 0 s when the wave crest arrives at the sloping beach t 20 4 s the speed of the wave convex head is the highest the friction interaction between the sloping beach and the water causes the increase of turbulent kinetic energy at the interface as the water rises the kinetic energy of the water gradually decreases the gravitational potential energy increases and the run up height of the water increases when the water head velocity reduces to the minimum the water body begins to fall the potential energy of the water body is converted into kinetic energy and the fluid velocity increases at the junction of the horizontal water surface and the sloping beach there is a strong turbulence in the water and a large vortex are generated fig 12e besides the tke also reaches the maximum value due to the velocity increase and the strong turbulence fig 13e and f before and after the wave passes over the different breakwaters the temporal evolutions of the water free surface recorded at wg1 and wg2 and velocity magnitude recorded at vs1 and vs2 are shown in fig 14 when the breakwater is solid n 0 0 the water level in front of the breakwater rises slightly and the flow velocity decreases due to the water blockage caused by breakwater due to the barrier of the breakwater and the energy dissipation after the wave passes over the breakwater the water level at the back of the breakwater decreases the change of water level under porosity of 0 0 is similar to that under porosity of 0 5 however the velocity magnitude behind the porous breakwater n 0 5 is less than that behind the solid breakwater n 0 0 indicating that the porous media has a more significant influence on flow velocity with the increase of the porosity the amount of water passing through breakwater increases when the breakwater with n 1 0 is completely empty the water level and flow velocity before and after the breakwater do not change fig 15 shows the temporal evolution of run up height and the maximum run up height under different porosity when the wave arrives at the sloping beach the run up height increases significantly and reaches the maximum then the water level drops to a stationary level although the wave run up process is basically similar the maximum run up heights are various under different porosity coefficient fig 15a when the porosity coefficient n is less than 0 5 the maximum height decreases almost linearly with the increase of the porosity when the porosity coefficient n is 0 6 the maximum run up height is larger than that under n 0 5 then the maximum run up height decreases to the minimum at n 0 8 without the breakwater the run up height is the maximum it is noted that the influence of porous breakwater on wave propagation is more significant than that of solid breakwater the breakwater with pores can effectively block the wave propagation and reduce the run up height however with the increase of the porosity the maximum run up height does not always decrease linearly fig 16 depicts the temporal evolution of the hydrodynamic force on the breakwater with the increase of the porosity the horizontal and vertical maximum hydrodynamic forces on the breakwater decrease because the larger the pore size the more the water passing through the breakwater and the smaller the forces caused by pressure difference on the breakwater after the wave crosses the breakwater the backflow of water leads to the negative value of the horizontal force the vertical forces on the breakwater are always negative because the wave will produce vertical downward pressure on the breakwater under the wave weight when the wave climbs on the sloping beach the horizontal and vertical hydrodynamic forces on the slope are depicted in fig 17 with the increase of the wave run up both the horizontal and vertical forces increase and then decreases gradually which matches the change of the wave run up height however the maximum force is different under different porosity if there is no breakwater n 1 0 the forces on the sloping beach are the largest when the porosity n is 0 4 the forces are the minimum indicating that this type of porous breakwater can effectively dissipate wave energy and reduce the acting force on the slope considering the wave run up height and the forces on the breakwater and sloping beach the porosity can be considered between 0 4 and 0 8 4 1 2 median diameter seven gravel median diameters d50 of breakwater are set to be 0 05 0 10 0 15 0 20 0 25 0 30 and 0 35 m and the porosity coefficient n is 0 6 when the waves pass through three breakwaters with different median diameters of 0 05 and 0 35 m the velocity contours of the flow fields at 15 16 2 and 18 6 s are shown in fig 18 when the wave reaches the breakwater the flow velocity in the breakwater increases with the increase of the median diameter because under a certain porosity the larger the particle size the larger the interstice between particles and the stronger the flow intensity in the pore when the wave crest is above the breakwater the flow speed in the breakwater with the median diameter of 0 35 m is higher than that with the median diameter of 0 05 m and the speed of external flow field is lower after the wave passes through the breakwater the flow speed around the breakwater increases with the increase of the median diameter the temporal evolutions of the wave run up heights under different median diameters are shown in fig 19 with the increase of the median diameter the maximum run up height decreases which means that at a certain porosity the larger the medium diameter the more the wave energy dissipates the weaker the wave propagation and the lower the run up height the horizontal and vertical hydrodynamic forces on the breakwaters with different median diameters are depicted in fig 20 where the ratio α is of the median diameter d50 to the unit length of breakwater with the increase of the median diameter the micro flow in the breakwater increases the pressure difference in front and rear of the breakwater decreases and the horizontal force decreases for the vertical hydrodynamic force when the wave peak is located on the breakwater fig 18 according to bernoulli equation the larger the median diameter is the lower the flow speed above the breakwater and the greater the vertical pressure on the breakwater therefore with the increase of the median diameter the vertical force magnitude increases when the wave climbs along the sloping beach the horizontal and vertical hydrodynamic forces on the sloping beach are shown in fig 21 when the median diameter is less than 0 25 m the hydrodynamic force magnitude decreases with the increase of the median diameter when the median diameter is 0 25 m the hydrodynamic forces are the smallest and then increase with the increase of the median diameter in general with the increase of the median diameter the maximum run up height and the horizontal hydrodynamic force on the breakwater decrease the vertical hydrodynamic force on the breakwater increases considering the effects of the porosity and the median diameter on the wave run up height and the forces on the breakwater and the sloping beach the influence of the porosity is more significant than the median diameter therefore the porosity is the primary consideration for the protection submerged breakwater and on this basis the appropriate median diameter can be selected 4 2 effect of breakwater structure in this section the effects of different breakwaters on the solitary wave propagation and run up on the sloping beach are analyzed in three aspects breakwater radius location and tandem breakwater the wave height h is 2 m the porosity of breakwater n is 0 6 and median diameter d50 is 0 3 m 4 2 1 breakwater radius seven breakwater radiuses are set as 2 0 2 5 3 0 3 5 4 0 4 5 and 5 0 m and the distance l between the breakwater center and the slope root is 50 m fig 22 shows the velocity contours of the flow fields at 15 16 2 and 18 6 s under three radiuses of 2 5 and 4 5 m when the wave approaches the breakwater with the increase of the radius the flow velocity around the breakwater increases due to the blocking and squeezing action of breakwater on water flow when the wave peak is above the breakwater the larger the radius the lower the flux above the breakwater but the greater the velocity after the wave passes over the breakwater with the increase of the radius the flow speed above the breakwater increases and due to the block of the breakwater the low speed area increases behind the breakwater the vorticity contours at 15 18 6 and 21 s are also depicted in fig 23 when the wave arrives the small vortices attached to the breakwater surface are generated then the vortices gradually increase and move backward along the breakwater surface accompanied by wave propagation a small anticlockwise vortex is generated between the breakwater and the large clockwise vortex after the wave leaves the pair of vortices begin to shed the bigger the breakwater is the larger the vortex is when the wave climbs on the sloping beach the water level profiles at different times are depicted in fig 24 when the wave peak arrives at the sloping beach at t 24 00 s the wave elevation under the radius of 5 0 m is the lowest however the wave run up height is similar to each other in the process of wave climbing with the increase of the radius both the wave run up height and velocity decrease at the time of 32 40 s the run up height reaches the maximum the maximum height at a radius of 5 0 m is lower than that at other radiuses fig 25 a shows the temporal evolutions of wave run up heights under seven radiuses in the whole wave climbing process the run up height under the radius of 5 0 m is always lower than that under other radius at the same time fig 25b shows the maximum run up height when the radius is less than 3 m the maximum run up height is similar to each other however when the radius is between 3 m and 4 5 m the height decreases seriously as the radius continues to increase the height will no longer change significantly which means that within a certain range of size the breakwater has a significant regulation effect on wave propagation figs 26 and 27 show the temporal evolutions of the horizontal and vertical hydrodynamic forces on the breakwater and the slopes respectively with the increase of the radius both the horizontal and vertical hydrodynamic forces on the breakwater increase because the larger the radius the larger the force area on the breakwater however the forces on the sloping beach decrease because both the wave velocity and run up height on the sloping beach decrease with the increase of radius the reduced gradient of force on both the breakwater and the slope increases significantly on the premise of ensuring the breakwater safety under the wave increasing the size of the breakwater is beneficial to reducing the wave run up height and the forces on the sloping beach 4 2 2 breakwater location in this section the effect of the breakwater at different position on the wave propagation is investigated and five locations are selected where the distances l between the center of the breakwater and the root of sloping beach are 5 10 20 30 40 and 50 m respectively when the distance l is 20 m the velocity contour of the flow field is shown in fig 28 when the water flows back the velocity above the breakwater increases and the flow direction reverses fig 28f at the interface between the water surface and the sloping beach intense turbulence occurs in the water body fig 29 depicts the vorticity contours when the wave runs up the sloping beach the vortex behind the breakwater begins to shed but the vortex on the sloping beach is very weak as the water descends on the slope the flow direction is opposite to the wave propagation direction and the shedding vortices around the breakwater flows from back to the front the vortex decreases in size and increases in number the intense turbulence leads to the maximum vortices around the sloping beach fig 30 shows the temporal elevation of the wave run up height on the sloping beach and the maximum run up heights under different breakwater locations the wave run up process is basically similar to each other where the wave run up height reaches the maximum at the same time and then decreases however the maximum run up heights under different locations are different fig 30b when the distance is less than 40 m with the increase of the distance l the maximum run up height decreases indicating that when the breakwater is very close to the sloping beach the effect of the breakwater on the wave run up height is very weak because the reduction of the distance reduces the dissipation time of wave energy however when the distance is 50 m the maximum run up height increases slightly fig 31 shows the horizontal and vertical hydrodynamic forces on the breakwater due to the different locations of breakwaters the arrival time of the wave to the breakwater is different with the increase of the distance the forces on the breakwater increase slightly which may be caused by the back up of the sloping beach when the breakwater is very close to the slope due to the block of the sloping beach the wave propagation velocity is reduced and the forces on the breakwater decrease the maximum hydrodynamic forces on slopes at different locations are shown in fig 32 where the ratio β is the distance l to the unit length of the sloping beach when the distance l is between 20 m and 30 m the hydrodynamic forces on the slope are the minimum in general the influence of the breakwater location on the sloping beach is more significant than that on the breakwater considering the effects of the breakwater location on the wave run up height and the forces on the breakwater and the sloping beach the breakwater should not be too close or too far from the beach 4 2 3 breakwaters in tandem in order to effectively protect the coast and reduce the wave run up height the tandem breakwater is often designed on some coasts in this section the effects of the tandem breakwaters on the wave propagation are studied and six distances s between two breakwater centers are set as 0 10 20 30 40 and 45 m when the distance is 30 m the velocity and vorticity contours of the flow fields are shown in figs 33 and 34 respectively when the wave approaches the front breakwater the velocity between two breakwaters is very low when the water peak is above the tandem breakwater the velocities in the gap and behind the breakwater increase and the vortices around the tandem breakwater become bigger and bigger after the wave passes over the rear breakwater due to the intense turbulence of the fluid in the gap between two breakwaters the velocity gradient in the gap is very large and the vortices continue to increase after the wave leaves the breakwater the velocity in the flow field reduces and the vortices fall off the breakwater when the wave runs on the slope the free surface comparisons under different tandem breakwaters are shown in fig 35 when the distance s is 0 m the breakwater is single and the wave run up height is higher than that under the tandem breakwater fig 35b when the wave run up heights reach the maximum fig 35c the maximum run up heights under the tandem breakwater with a distance of 20 m and the single breakwater are the lowest and the highest respectively the weakening effect of the tandem breakwater on the turbulence of the water body is more significant than that of the single breakwater fig 36 shows the temporal evolution of the run up height and the comparison of the maximum run up height under different tandem breakwaters when the distance s is from 0 to 20 m the wave run up height decreases then the wave height increase slightly fig 37 depicts the horizontal and vertical hydrodynamic forces on the breakwaters at different distance when the distance s is less than 40 m compared with the force on the front breakwater the horizontal force on the rear breakwater is always larger but the vertical force is smaller at the same distance since the vertical force is much larger than the horizontal force the overall force on the breakwater is consistent with the vertical force therefore the overall force on the front breakwater is larger than that on the rear breakwater however when the distance s is 45 m the forces on the rear breakwater are larger than that on the front breakwater due to the reliance of the sloping beach and the backflow the maximum hydrodynamic forces on the sloping beach are shown in fig 38 under the single breakwater the forces on the sloping beach are larger than that under the tandem breakwater which means that the tandem breakwater has better protection function for the sloping beach when the distance is 30 m the force on the slope is the smallest in general in this case the distance between two breakwaters from 20 m to 30 m is appropriate 4 3 effect of marine environment in the ocean the wave heights are varied in order to analyze the effect of the breakwater on the wave propagation at different wave height six wave heights are designed 1 6 1 8 2 0 2 2 2 4 and 2 6 m and the radius porosity coefficient and the medium diameter of the breakwater are 3 m 0 6 and 0 3 m respectively the distance between the breakwater center and the root of the sloping beach is 50 m the attenuation coefficient of the wave run up height and the fluctuation factor of the force are defined as 26 θ r z z 100 27 ω f m n f m 1 n h h m h m 1 100 where z is the free surface height z h h fm n and hm are the normalized force and wave height at the step of m when the wave passes through breakwater the maximum free surface elevations recorded at wg1 and wg2 are shown in fig 39 with the increase of the wave height both the free surface elevation and the attenuation coefficients increase the larger the attenuation coefficient is the more serious the wave surface drops under the same wave height difference indicating that the influence of the breakwater on the wave with high wave height is more significant than that with low wave height the velocity and vorticity contours of the flow fields at three wave heights of 2 2 and 2 4 m are show in figs 40 and 41 when the wave arrives at the breakwater with the increase of the wave height the flow velocities around and in the breakwater increase however these vortices are similar to each other when the wave crest is above the breakwater the high velocity area above the breakwater at 2 4 m wave height is much larger than that under other wave heights after the wave passes over the breakwater both the velocity and the vortex behind the breakwater increases the higher the wave height the larger the vortex and the greater the velocity magnitude after the wave leaves the vortices begin to shed and with the increase of the wave height the shedding vortices also increase the free surface elevations under three wave heights of 1 8 2 2 and 2 6 m at different moments are drawn in fig 42 with the increase of the wave height the water level above the sloping beach increases and there is an obvious water bag when the wave height is 2 6 m then the wave flows along the sloping beach when the wave run up height reaches the maximum the run up height at the wave height of 2 6 m is the highest soon the wave drops along the sloping beach the higher the wave height the higher the wave run up height fig 43 a with the increase of the wave height the attenuation coefficient increases substantially linearly which means that the higher the wave height the more serious the decrease of the run up height under the same wave height difference fig 43b the horizontal and vertical hydrodynamic forces on the breakwater are shown in fig 44 with the increase of the wave height both the wave velocity and the volume increase leading to the increase of the forces on the breakwater the fluctuation factor represents the gradient variation of the forces with the increase of the wave height the factor decreases indicating that the higher the wave height the smaller the force difference on the breakwater as for the sloping beach with the increase of the wave height the forces on the sloping beach are also increasing but the wave fluctuation factor has undergone serious changes which are different from those for breakwater fig 45 when the wave height difference changes from 0 4 m to 0 6 m the factor increases by 20 which means that in the vicinity of the wave height of 2 2 m the forces on the sloping beach changes seriously and the sloping beach is highly sensitive to this wave height in general although the breakwater can affect the wave propagation and reduce the wave run up height and forces on the sloping beach according to the attenuation coefficient and the fluctuation factor the influence degree and sensitivity of the breakwater to the waves with different wave heights are completely different 5 conclusions in this study the effects of different semi circular porous media submerged breakwater on wave propagation are investigated numerically the properties and the structural changes of the breakwater include the porosity the particle median diameter and the breakwater radius besides the effects of the breakwater location and the tandem breakwater are considered due to the complexity of marine environment the influence of waves with different wave heights on the breakwater and the sloping beach is also investigated the main conclusions are as follows 1 when the breakwater is porosity besides the circumfluence flow behind the breakwater some water seeps out of the breakwater and the interaction between these two types of water leads to the increase of flow turbulent intensity and vorticity the larger the porosity the stronger the flow intensity of the seeping water resulting in the larger vortex and the faster shedding speed the porosity breakwater can effectively block the wave propagation and reduce the run up height however with the increase of the porosity the maximum run up height does not always decrease linearly when the gravel median diameter changes with the increase of the median diameter the maximum run up height and the horizontal hydrodynamic force on the breakwater decrease but the vertical hydrodynamic force on the breakwater increases comparing the effects of the porosity and the median diameter the influence of porosity is more significant than medium diameter therefore the porosity is the primary factor to be considered in protecting the coast by submerged breakwater and on this basis an appropriate medium diameter can be selected 2 with the increase of the breakwater size the maximum wave run up height and the forces on the sloping beach decrease however the forces on the breakwater increase which may cause the mechanical destruction of the breakwater depending on the research of the effect of the breakwater location on the wave propagation it is found that if the distance between the breakwater and the sloping beach is too small or too large both the maximum run up height and the forces on the sloping beach increase compared with the single breakwater the tandem breakwater can reduce the run up height seriously in this case the distance between two breakwaters from 20 m to 30 m is appropriate for the reduction of the wave run up height and the force 3 when the wave changes with the increase of the wave height the wave run up height increases however the run up height difference and the fluctuation factor of force on the breakwater decrease indicating that the higher the wave height the smaller the force difference on the breakwater under the same wave height difference for the sloping beach in the vicinity of this wave height of 2 2 m the forces on the sloping beach change seriously and the sloping beach is highly sensitive to this wave height although the breakwater can affect the wave propagation and reduce the wave run up height and forces on the sloping beach according to the attenuation coefficient and the fluctuation factor the influence degree and sensitivity of the breakwater to the waves with different wave heights are completely different credit authorship contribution statement enjin zhao conceptualization methodology validation investigation writing original draft data curation formal analysis visualization project administration writing review editing youkou dong conceptualization methodology validation investigation writing original draft data curation formal analysis visualization project administration writing review editing yuezhao tang visualization project administration writing review editing xiaoyu xia visualization project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grant no 52001286 51909248 and special open fund of shandong key laboratory of ocean engineering in 2019 the authors are grateful to the anonymous reviewers for their valuable input 
21040,submerged breakwater as the main structure of coastal engineering to protect coast is widely laid on the seabed because of its significant wave dissipation performance to reveal the interaction mechanism between waves and submerged breakwater the hydrodynamic characteristics of a wave passing over different solid breakwaters were numerically and experimentally studied compared with the previous research considering breakwater made up of porous media and the effects of extreme waves generated by hurricanes or tsunamis this paper systematically investigates the effects of the semi circular porous medium breakwater on the breaking solitary wave run up based on a numerical model with the immersed boundary ib method the computational capability of this model is verified firstly then depending on the model a series of cases are carried out to research the effects of different breakwaters on the run up of solitary waves the results show that the influence of porous breakwater on wave propagation is more significant than that of the solid breakwater with the increase of the gravel particle median diameter the maximum run up height and the horizontal hydrodynamic force on the breakwater decrease while the vertical hydrodynamic force on the breakwater increases increasing the size of the breakwater is beneficial to reducing the wave run up height and the forces on the sloping beach compared with the single breakwater the impact of the tandem breakwater on the wave propagation is more significant keywords solitary wave porous media submerged breakwater flow field hydrodynamic load 1 introduction due to the submarine earthquake volcanic eruption submarine landslide or meteorological changes a large amount of energy is released into the ocean causing water oscillation and generating the water waves referred to as tsunamis when the tsunami reaches the shallow water coast the wave length decreases but the wave height increases sharply forming a water wall with the great energy some tsunamis have already caused a serious impact on human society zhao et al 2019a on december 26th 2004 more than 230 000 people were killed in the indian ocean earthquake and tsunami on march 11th 2011 a 9 0 magnitude earthquake triggered a huge tsunami the total number of casualties and missing persons is about 20 000 and many infrastructures were destroyed in japan on september 28th 2018 indonesia s sulawesi island suffered a strong tsunami several coastal cities were seriously damaged with a death toll of 1200 suppasri et al 2012a and b heidarzadeh et al 2018 suppasri et al 2012a 2012b heidarzadeh et al 2018 in order to reduce the disasters caused by the tsunami it is particularly important to investigate the hydrodynamic characteristics of the tsunami wave propagation and run up because tsunami wave and solitary wave are similar in stable waveform and small wave energy loss solitary wave is often used for the simulation of tsunami wave synolakis 1986 1987 synolakis 1986 1987 presented an approximate theory for non breaking waves and several empirical formulas for the maximum run up of solitary wave madsen and schäffer 2010 madsen and schäffer 2010 derived some analytical solutions of nonlinear shallow water equations for the solitary wave run up and run down liang et al 2013 liang et al 2013 numerically investigated the run up processes of solitary waves on a vertical wall using a shock capturing boussinesq type model xiao et al 2010 xiao et al 2010 numerically studied the transient wave propagation the sediment transport the morphological change and the seabed elastodynamics response when the solitary wave runs up and down on sloping beach through these studies the prediction of solitary wave run up height is conducive to the design of the angle and height of the bank however the strong action of the waves may damage the bunding and the wave will overtop the bunding and cause disaster once the wave run up height is higher than the bunding in order to protect the bunding and coast the submerged breakwater is developed and widely applied in harbor and coastal engineering as a buffer against wave damage flood and erosion when the wave passes over the submerged breakwater the interaction between the wave and breakwater can dissipate the wave energy reduce the run up and enhance the coastal resilience to better understand the breakwater effects on coastal protection extensive experiments and numerical studies have been carried out on the hydrodynamic characteristics of breakwater wave interaction in the past decades li and zhang 2019 li and zhang 2019 numerically studied the wave propagation after the wave passes through the submerged low crested breakwater indicating that the wave transmission coefficient is affected by the submerged depth of the breakwater and the wave steepness klonaris et al 2019 klonaris et al 2019 studied the bed morphodynamics in the lee of a submerged breakwater under the regular and irregular waves numerically and experimentally ji et al 2017 ji et al 2017 numerically studied the wave transformations around rectangle or trapezoid submerged breakwaters under regular wave and solitary wave barbosa lópez et al 2019 barbosa lópez et al 2019 investigated the hydrodynamic characteristics caused by the interaction between the linear long waves and the cycloidal geometric submerged breakwater and obtained the reflection and transmission coefficients and the free surface elevation li et al 2020 li et al 2020 analyzed the interaction between the water wave and a submerged fluid filled semi circular membrane breakwater up to now various types of submerged breakwater have been studied according to previous studies it is found that the semi circular caisson breakwater has certain advantages and has been applied in practical engineering fig 1 xie 1999 li et al 2019 xie 1999 li et al 2019 when the wave passes through the semi circle breakwater the hydrodynamic force on the breakwater causes almost zero overturning moments on the caisson with the high stability in addition this breakwater is easy to construct and dismantle and is suitable for the soft soil foundation therefore many studies about the rigid semi circular breakwater have been carried out however the submerged breakwater is usually constructed of porous media such as blocks silt stone and gravel losada et al 1996 losada et al 1996 predicted the change of regular waves passing through porous breakwaters liu et al 1999 liu et al 1999 simulated the interaction between the wave and the porous structure considering the mechanism of turbulence generation and dissipation metallinos et al 2019 metallinos et al 2019 used an extended boussinesq type model to simulate wave propagation over the submerged porous breakwater and predict the velocity distribution although some studies have been done on porous media the influence of semi circular marine structure with the porous media on the wave propagation is rarely studied according to the existing research it is important to investigate whether the submerged semi circular porous breakwater has a significant impact on the wave propagation especially under the extreme marine conditions given the inadequacy of the existing research about the protection of breakwater against the coast under the extreme wave the influence of the semi circular porous media breakwater on the run up of the solitary wave and the forces on the breakwater and the sloping beach are studied in this paper to reveal the hydrodynamic characteristics of solitary wave propagation the accurate simulation of this process depends on the coupling model of flow and porous medium modules based on immersed boundary ib method zhao et al 2020 zhao et al 2020 the rest of the paper is organized as follows section 2 introduces the model including the flow and the porous media modules the verification of this model is conducted depending on the experiment in section 3 section 4 discusses the effects of various submerged porous medium semi circular breakwaters on the different solitary waves and reveals some mechanisms of the interaction among the wave the breakwater and the sloping beach section 5 provides some concluding remarks 2 model description in the numerical model the flow module and the porous breakwater module are coupled using the immersed boundary ib method 2 1 flow module the mass and momentum conservation equations of the flow domain are written as 1 a u 0 2 u t 1 v f a u u 1 ρ p g f d where is the gradient operator u is the bulk velocity ρ is the fluid density p is the pressure g is the object acceleration vector f is the viscous acceleration vector of flow d is the flow loss reflected by forchheimer saturated drag in porous media in the immersed boundary method geometries of breakwater and sloping beach are constructed in the calculation domain given an object occupying the grid the grid is separated into two parts by the interface of the object i e the open volume part water and the object filling part breakwater depending on the open volume fraction in the grid the flow and porous volumes are divided in the grid based on the object parameters in order to calculate the mass and moment equations in one divided grid the fractional volume method is introduced a is the area fraction for the fluid in the mesh of cartesian coordinate system and vf is the volume fraction for the fluid according to the volume of fluid vof method combined with switching technique for advection and capturing of surfaces stacs darwish and moukalled 2006 darwish and moukalled 2006 the free surface transportation equation between water and air is defined as 3 γ t 1 v f γ a u 0 where γ is the water volume fraction in the cell of a free surface γ 0 0 γ 1 and γ 1 control the different phases of air interface and water the viscous acceleration vector f in three directions of cartesian coordinate can be written as 4 ρ v f f x s x x a x τ x x y a y τ x y z a z τ x z 5 ρ v f f y s y x a x τ y x y a y τ y y z a z τ y z 6 ρ v f f z s z x a x τ z x y a y τ z y z a z τ z z where s i x y z is wall stress in three directions τ is the term of shear stress to calculate the dynamic viscosity μ two equation κ ε turbulence model is introduced as 7 k t 1 v f u a x k x v a y k y w a z k z p t g t d ε 8 ε t 1 v f u a x ε x v a y ε y w a z ε z c 1 ε ε k p t c 3 ε g t d ε c 2 ε ε 2 k where k is the turbulent kinetic energy coefficient ε is turbulent energy dissipation rate u v and w are the velocities in x y and z directions pt is the turbulent kinetic energy production gt is buoyancy production term d and dε demonstrate diffusion terms and c1ε c2ε and c3ε are constant values respectively the flow characteristics are simulated using the incompressible flow solver with immersed boundary ifs ib zhao et al 2020 zhao et al 2019 zhao et al 2019b 2020 the finite volume method with the secondary order approximation scheme for derivatives of time and space is used to discrete the calculation domain pressure implicit split operator piso method is for velocity and pressure resolution and poisson equation is solved by generalized minimal residual gmres method at the inlet of the computational domain the solitary wave is generated based on mccowan s theory and the surface elevation is defined as mccowan 1891 wu 2004 mccowan 1891 wu 2004 9 η p h where η is the water elevation h is the still water depth p is the reference value calculated as follows 10 p e f sin f 1 p cos f 1 p cosh f x h 11 e 2 3 sin 2 f 1 2 h 3 h f e h h tan 1 2 f 1 h h 12 x x c 0 t the velocity is defined as 13 u c 0 e 1 cos f z h cosh f x h cos f z h cosh f x h 2 14 w c 0 e sin f z h sinh f x h cos f z h cosh f x h 2 where h is the wave height x and z represent the locations in horizontal and vertical directions in the coordinate system respectively c0 g h d 1 2 is the wave speed in still water t is the time the equations from 10 to 14 are nonlinear and solved using the newton raphson method the water elevation is initially estimated depending on boussinesq s solution as follows 15 η d ε sech 2 3 ε 4 x h where ε h h the initial estimates of e and f are 3ε 1 2 and 2ε respectively at the bottom of the simulation domain and the slope surface the nonslip wall conditions are imposed atmospheric pressure is applied on the top boundary and symmetric boundaries are used at two sides of the simulation domain 2 2 porous media module in the calculation domain the porous medium region is matched with the breakwater geometry based on the volume fraction method the mesh point and volume in the porous medium region are marked as porous medium mesh point and volume respectively fig 2 the flow rate through porous media is proportional to the applied pressure difference which is commonly referred to as the resistance in porous media module the resistance of a porous medium to flow is represented in the navier stokes equations as a drag term d when the water flows into and out of the porous media the hydrodynamic characteristics of the flow are affected by the forchheimer saturated drag d which is defined as losada et al 1996 liu et al 1999 lara et al 2006 lin and karunarathna 2007 losada et al 1996 liu et al 1999 lara et al 2006 lin and karunarathna 2007 16 d f d u m where fd is the porous media drag coefficient and u m is the microscopic flow velocity 17 f d μ n ρ k where n is the porous medium porosity the open volume in a porous medium divided by the total volume k is the intrinsic permeability factor of the material according to darcy law in henry darcy equation the relationship formula among the microscopic flow velocity u m the media effective porosity n the bulk velocity u the applied pressure difference p and the intrinsic permeability factor k is written as losada et al 1996 losada et al 1996 18 u m u n k n μ p where p is the pressure gradient in real space within the porous media the forchheimer s equation includes viscous linear and form quadratic drag terms so the pressure drop including both the linear and square functions of the velocity is given by 19 p μ n k 1 u m ρ n 2 k 2 u m u m 20 k 1 n 3 a 1 n 2 k 2 n 3 b 1 n where k1 and k2 are the darcian and non darcian inertial permeability respectively a and b are media specific loss coefficients which can be established as 21 a α d s 2 b β d s where α is a carman kozeny constant with a typical value of 180 derived from the hydraulic radius theory and β is a roughness factor defined as 2 9 ds is the average equivalent spherical diameter combining the above equations the forchheimer saturated drag d including the darcian and non darcian flow losses can be written as 22 f d u m 1 ρ p a μ ρ 1 n n 2 u m b 1 n n u m u m therefore the navier stokes equations in the porosity media material can be written as 23 u t 1 v f a u u 1 ρ p g f a μ 1 n 2 ρ n 3 u b 1 n n 3 u u when the porosity coefficient n is 0 the forchheimer saturated drag d approaches infinity which means that this region is covered by the solid structure when the porosity coefficient of n is 1 the forchheimer saturated drag d is void and the navier stokes equation is for the fluid which means that this region is covered by the fluid when the porosity coefficient is between 0 and 1 the fluid in the porosity medium is controlled by the forchheimer saturated drag d when the fluid reaches the porous medium area the forchheimer saturated drag d starts to act on the microscopic flow when it flows out the forchheimer saturated drag d disappears and the water flows without the effect of the porous medium 3 model validation the calculation accuracy of the numerical model in predicting the flow over the permeable medium and the wave run up height is verified in sections 3 1 and 3 2 besides the verification of the wave force on the structure has been carried out in previous works zhao et al 2019 2020 zhao et al 2019a 2020 3 1 solitary wave over permeable breakwater the experiments were conducted by wu and hsiao 2013 wu and hsiao 2013 the uniform glass spheres with a diameter of 1 50 cm are not staggered to form the breakwater with a porosity of 0 52 the permeable breakwater is with a length of 13 cm and a height of 6 5 cm the origin of the coordinate system is defined at the intersection of the left side of the breakwater and the bottom of the flume fig 3 shows the simulation layout the calculation domain is 15 m long and 0 25 m high the distance from the inlet to the left side of the breakwater is 5 m two wave gauges wg1 x 1 8 m wg2 x 1 8 m are set before and after the breakwater to measure the temporal evolution of the wave surface the still water depth h is 10 6 cm and the wave height h is 4 77 cm with the ratio of h d 0 45 the mesh resolution in the breakwater zone is 0 001 m fig 4 depicts the temporal evolution of water elevation between the simulation and experiment results recorded at wg1 and wg2 and fig 5 shows the wave surface comparisons at different times when the wave passes through the breakwater the flow is blocked by the porous media the velocity decreases and the flow field changes in addition the comparison results of horizontal and vertical velocity along the water depth are shown in fig 6 the time ranges from 1 45 s to 2 05 s with the interval of 0 2 s to sum up the numerical results of wave free surface and velocity agree well with experimental results and this model can accurately predict the solitary wave propagation over the permeable breakwater 3 2 wave run up in this section the numerical results of wave run up are compared to the experimental results from synolakis 1986 synolakis 1986 fig 7 shows the simulation layout where β is the sloping beach angle tanβ 0 05 the computational domain is 20 m long and 0 5 m high and the distance from the inlet boundary to the sloping toe is half of the wavelength the still water depth h and wave height h are 0 2 m and 0 06 m respectively the grid solution around the beach is 0 001 m fig 8 shows the comparison results of wave surface where the time scale of the calculation results has been shifted to be consistent with the experimental data t t g d 1 2 as the wave approaches the beach the wave length becomes shorter and shorter and the wave height increases due to the sloping beach barrier when the wave is very steep the wave breaks up at t 25 the water flows upward along the sloping beach and reaches the maximum height then the water drops along the sloping beach in both the run up and run down processes of solitary wave on the beach the results of predicted water surfaces are in good agreement with experimental data indicating that this model can predict the solitary wave propagation along the sloping beach accurately 4 results and discussion in this section the effects of semi circle gravel permeable breakwater on the run up of the solitary wave and the forces on the breakwater and the sloping beach are investigated the sketch of the experimental layout is depicted in fig 9 where the computing domain is 500 0 m in length and 16 0 m in height the distance from the submerged breakwater centroid o to the toe of the sloping beach is denoted as l r r n and l represent the wave run up height the breakwater radius the porosity coefficient and the unit width of the sloping beach respectively the still water depth h is kept at 6 0 m and the sloping beach angle β of the beach is the same tanβ 1 5 in all following simulations the grid resolution around the permeable breakwater and the beach is 0 001 m besides the impact of the breakwaters in tandem on the solitary wave propagation is also considered and s represents the distance between two breakwater centroids two wave elevation gauges wg1 and wg2 are located at x 195 m and x 205 m before and after the breakwater respectively in addition two velocity and turbulent kinetic energy tke sensors are installed at vs1 x 195 m z 1 5 m and vs2 x 205 m z 1 5 m the turbulent kinetic energy tke is defined as 24 t k e ρ 2 u 2 w 2 d v where u and w are the velocity magnitudes in x and z directions associated with chaotic turbulent fluctuations which are equal to 10 of the mean flow velocity in the undisturbed flow the hydrodynamic forces on the breakwater and the beach are calculated considering the flow pressure the shear stress and the pore pressure in the porous breakwater to better analyze and compare the forces the hydrodynamic forces are normalized as 25 f n 2 f tan β ρ g l h 2 4 1 effect of porous medium characteristics since the characteristics of the gravel permeable breakwaters are different the effects of the porosity coefficient n and medium diameter d50 on the wave run up and the forces on the breakwater and the sloping beach are analyzed in this section the wave height h is 2 m and the radius r of the breakwater is 3 m the distance l between the breakwater and the sloping beach is 50 m 4 1 1 porosity coefficient seven porosity coefficients n are set as 0 0 0 2 0 4 0 5 0 6 0 8 and 1 0 and the medium diameter d50 is 0 3 m fig 10 shows the velocity contours of the flow fields at 15 16 2 and 18 6 s under different porosities when the wave approaches the breakwater for the first time t 15 s the flow velocity around the solid breakwater n 0 0 is higher than that around the porous breakwater with the increase in porosity the velocity in the breakwater increases because large pores allow more water to enter at 16 2 s when the wave crest is above the breakwater the velocity on the breakwater reaches the maximum after the wave passes over the breakwater at 18 6 s it is found that the velocity behind the breakwater increases with the increase of the porosity because the larger the porosity the more fluid seeps out fig 11 depicts the vorticity contours of the flow fields around the breakwaters with the different porosities at 15 18 6 and 21 s when the wave arrives the vortex attached to the breakwater is generated due to the seepage of pores the streamlines passing through the porous breakwater are deflected after the wave crosses the breakwater at 18 6 s the vortices become larger compared with the vortices behind the solid breakwater the vortices behind the porous breakwater are much bigger when the time is 21 s the vortex sheds from the breakwater and the patterns of vortices are different two reasons are inferred here firstly when the wave passes over the breakwater the flow circumfluence occurs behind the breakwater when the breakwater is solid the vortex adheres to the breakwater and the seabed however when the breakwater is porosity besides the circumfluence water some water seeps out of the breakwater and the interaction between the two kinds of water will lead to the increase of turbulent intensity and vorticity secondly the greater the porosity the stronger the flow intensity of the seepage water resulting in the larger vortex and the faster shedding speed figs 12 and 13 show the velocity and the turbulent kinetic energy tke contours on the sloping beach after the wave passes through the breakwater from 20 4 s to 39 0 s when the wave crest arrives at the sloping beach t 20 4 s the speed of the wave convex head is the highest the friction interaction between the sloping beach and the water causes the increase of turbulent kinetic energy at the interface as the water rises the kinetic energy of the water gradually decreases the gravitational potential energy increases and the run up height of the water increases when the water head velocity reduces to the minimum the water body begins to fall the potential energy of the water body is converted into kinetic energy and the fluid velocity increases at the junction of the horizontal water surface and the sloping beach there is a strong turbulence in the water and a large vortex are generated fig 12e besides the tke also reaches the maximum value due to the velocity increase and the strong turbulence fig 13e and f before and after the wave passes over the different breakwaters the temporal evolutions of the water free surface recorded at wg1 and wg2 and velocity magnitude recorded at vs1 and vs2 are shown in fig 14 when the breakwater is solid n 0 0 the water level in front of the breakwater rises slightly and the flow velocity decreases due to the water blockage caused by breakwater due to the barrier of the breakwater and the energy dissipation after the wave passes over the breakwater the water level at the back of the breakwater decreases the change of water level under porosity of 0 0 is similar to that under porosity of 0 5 however the velocity magnitude behind the porous breakwater n 0 5 is less than that behind the solid breakwater n 0 0 indicating that the porous media has a more significant influence on flow velocity with the increase of the porosity the amount of water passing through breakwater increases when the breakwater with n 1 0 is completely empty the water level and flow velocity before and after the breakwater do not change fig 15 shows the temporal evolution of run up height and the maximum run up height under different porosity when the wave arrives at the sloping beach the run up height increases significantly and reaches the maximum then the water level drops to a stationary level although the wave run up process is basically similar the maximum run up heights are various under different porosity coefficient fig 15a when the porosity coefficient n is less than 0 5 the maximum height decreases almost linearly with the increase of the porosity when the porosity coefficient n is 0 6 the maximum run up height is larger than that under n 0 5 then the maximum run up height decreases to the minimum at n 0 8 without the breakwater the run up height is the maximum it is noted that the influence of porous breakwater on wave propagation is more significant than that of solid breakwater the breakwater with pores can effectively block the wave propagation and reduce the run up height however with the increase of the porosity the maximum run up height does not always decrease linearly fig 16 depicts the temporal evolution of the hydrodynamic force on the breakwater with the increase of the porosity the horizontal and vertical maximum hydrodynamic forces on the breakwater decrease because the larger the pore size the more the water passing through the breakwater and the smaller the forces caused by pressure difference on the breakwater after the wave crosses the breakwater the backflow of water leads to the negative value of the horizontal force the vertical forces on the breakwater are always negative because the wave will produce vertical downward pressure on the breakwater under the wave weight when the wave climbs on the sloping beach the horizontal and vertical hydrodynamic forces on the slope are depicted in fig 17 with the increase of the wave run up both the horizontal and vertical forces increase and then decreases gradually which matches the change of the wave run up height however the maximum force is different under different porosity if there is no breakwater n 1 0 the forces on the sloping beach are the largest when the porosity n is 0 4 the forces are the minimum indicating that this type of porous breakwater can effectively dissipate wave energy and reduce the acting force on the slope considering the wave run up height and the forces on the breakwater and sloping beach the porosity can be considered between 0 4 and 0 8 4 1 2 median diameter seven gravel median diameters d50 of breakwater are set to be 0 05 0 10 0 15 0 20 0 25 0 30 and 0 35 m and the porosity coefficient n is 0 6 when the waves pass through three breakwaters with different median diameters of 0 05 and 0 35 m the velocity contours of the flow fields at 15 16 2 and 18 6 s are shown in fig 18 when the wave reaches the breakwater the flow velocity in the breakwater increases with the increase of the median diameter because under a certain porosity the larger the particle size the larger the interstice between particles and the stronger the flow intensity in the pore when the wave crest is above the breakwater the flow speed in the breakwater with the median diameter of 0 35 m is higher than that with the median diameter of 0 05 m and the speed of external flow field is lower after the wave passes through the breakwater the flow speed around the breakwater increases with the increase of the median diameter the temporal evolutions of the wave run up heights under different median diameters are shown in fig 19 with the increase of the median diameter the maximum run up height decreases which means that at a certain porosity the larger the medium diameter the more the wave energy dissipates the weaker the wave propagation and the lower the run up height the horizontal and vertical hydrodynamic forces on the breakwaters with different median diameters are depicted in fig 20 where the ratio α is of the median diameter d50 to the unit length of breakwater with the increase of the median diameter the micro flow in the breakwater increases the pressure difference in front and rear of the breakwater decreases and the horizontal force decreases for the vertical hydrodynamic force when the wave peak is located on the breakwater fig 18 according to bernoulli equation the larger the median diameter is the lower the flow speed above the breakwater and the greater the vertical pressure on the breakwater therefore with the increase of the median diameter the vertical force magnitude increases when the wave climbs along the sloping beach the horizontal and vertical hydrodynamic forces on the sloping beach are shown in fig 21 when the median diameter is less than 0 25 m the hydrodynamic force magnitude decreases with the increase of the median diameter when the median diameter is 0 25 m the hydrodynamic forces are the smallest and then increase with the increase of the median diameter in general with the increase of the median diameter the maximum run up height and the horizontal hydrodynamic force on the breakwater decrease the vertical hydrodynamic force on the breakwater increases considering the effects of the porosity and the median diameter on the wave run up height and the forces on the breakwater and the sloping beach the influence of the porosity is more significant than the median diameter therefore the porosity is the primary consideration for the protection submerged breakwater and on this basis the appropriate median diameter can be selected 4 2 effect of breakwater structure in this section the effects of different breakwaters on the solitary wave propagation and run up on the sloping beach are analyzed in three aspects breakwater radius location and tandem breakwater the wave height h is 2 m the porosity of breakwater n is 0 6 and median diameter d50 is 0 3 m 4 2 1 breakwater radius seven breakwater radiuses are set as 2 0 2 5 3 0 3 5 4 0 4 5 and 5 0 m and the distance l between the breakwater center and the slope root is 50 m fig 22 shows the velocity contours of the flow fields at 15 16 2 and 18 6 s under three radiuses of 2 5 and 4 5 m when the wave approaches the breakwater with the increase of the radius the flow velocity around the breakwater increases due to the blocking and squeezing action of breakwater on water flow when the wave peak is above the breakwater the larger the radius the lower the flux above the breakwater but the greater the velocity after the wave passes over the breakwater with the increase of the radius the flow speed above the breakwater increases and due to the block of the breakwater the low speed area increases behind the breakwater the vorticity contours at 15 18 6 and 21 s are also depicted in fig 23 when the wave arrives the small vortices attached to the breakwater surface are generated then the vortices gradually increase and move backward along the breakwater surface accompanied by wave propagation a small anticlockwise vortex is generated between the breakwater and the large clockwise vortex after the wave leaves the pair of vortices begin to shed the bigger the breakwater is the larger the vortex is when the wave climbs on the sloping beach the water level profiles at different times are depicted in fig 24 when the wave peak arrives at the sloping beach at t 24 00 s the wave elevation under the radius of 5 0 m is the lowest however the wave run up height is similar to each other in the process of wave climbing with the increase of the radius both the wave run up height and velocity decrease at the time of 32 40 s the run up height reaches the maximum the maximum height at a radius of 5 0 m is lower than that at other radiuses fig 25 a shows the temporal evolutions of wave run up heights under seven radiuses in the whole wave climbing process the run up height under the radius of 5 0 m is always lower than that under other radius at the same time fig 25b shows the maximum run up height when the radius is less than 3 m the maximum run up height is similar to each other however when the radius is between 3 m and 4 5 m the height decreases seriously as the radius continues to increase the height will no longer change significantly which means that within a certain range of size the breakwater has a significant regulation effect on wave propagation figs 26 and 27 show the temporal evolutions of the horizontal and vertical hydrodynamic forces on the breakwater and the slopes respectively with the increase of the radius both the horizontal and vertical hydrodynamic forces on the breakwater increase because the larger the radius the larger the force area on the breakwater however the forces on the sloping beach decrease because both the wave velocity and run up height on the sloping beach decrease with the increase of radius the reduced gradient of force on both the breakwater and the slope increases significantly on the premise of ensuring the breakwater safety under the wave increasing the size of the breakwater is beneficial to reducing the wave run up height and the forces on the sloping beach 4 2 2 breakwater location in this section the effect of the breakwater at different position on the wave propagation is investigated and five locations are selected where the distances l between the center of the breakwater and the root of sloping beach are 5 10 20 30 40 and 50 m respectively when the distance l is 20 m the velocity contour of the flow field is shown in fig 28 when the water flows back the velocity above the breakwater increases and the flow direction reverses fig 28f at the interface between the water surface and the sloping beach intense turbulence occurs in the water body fig 29 depicts the vorticity contours when the wave runs up the sloping beach the vortex behind the breakwater begins to shed but the vortex on the sloping beach is very weak as the water descends on the slope the flow direction is opposite to the wave propagation direction and the shedding vortices around the breakwater flows from back to the front the vortex decreases in size and increases in number the intense turbulence leads to the maximum vortices around the sloping beach fig 30 shows the temporal elevation of the wave run up height on the sloping beach and the maximum run up heights under different breakwater locations the wave run up process is basically similar to each other where the wave run up height reaches the maximum at the same time and then decreases however the maximum run up heights under different locations are different fig 30b when the distance is less than 40 m with the increase of the distance l the maximum run up height decreases indicating that when the breakwater is very close to the sloping beach the effect of the breakwater on the wave run up height is very weak because the reduction of the distance reduces the dissipation time of wave energy however when the distance is 50 m the maximum run up height increases slightly fig 31 shows the horizontal and vertical hydrodynamic forces on the breakwater due to the different locations of breakwaters the arrival time of the wave to the breakwater is different with the increase of the distance the forces on the breakwater increase slightly which may be caused by the back up of the sloping beach when the breakwater is very close to the slope due to the block of the sloping beach the wave propagation velocity is reduced and the forces on the breakwater decrease the maximum hydrodynamic forces on slopes at different locations are shown in fig 32 where the ratio β is the distance l to the unit length of the sloping beach when the distance l is between 20 m and 30 m the hydrodynamic forces on the slope are the minimum in general the influence of the breakwater location on the sloping beach is more significant than that on the breakwater considering the effects of the breakwater location on the wave run up height and the forces on the breakwater and the sloping beach the breakwater should not be too close or too far from the beach 4 2 3 breakwaters in tandem in order to effectively protect the coast and reduce the wave run up height the tandem breakwater is often designed on some coasts in this section the effects of the tandem breakwaters on the wave propagation are studied and six distances s between two breakwater centers are set as 0 10 20 30 40 and 45 m when the distance is 30 m the velocity and vorticity contours of the flow fields are shown in figs 33 and 34 respectively when the wave approaches the front breakwater the velocity between two breakwaters is very low when the water peak is above the tandem breakwater the velocities in the gap and behind the breakwater increase and the vortices around the tandem breakwater become bigger and bigger after the wave passes over the rear breakwater due to the intense turbulence of the fluid in the gap between two breakwaters the velocity gradient in the gap is very large and the vortices continue to increase after the wave leaves the breakwater the velocity in the flow field reduces and the vortices fall off the breakwater when the wave runs on the slope the free surface comparisons under different tandem breakwaters are shown in fig 35 when the distance s is 0 m the breakwater is single and the wave run up height is higher than that under the tandem breakwater fig 35b when the wave run up heights reach the maximum fig 35c the maximum run up heights under the tandem breakwater with a distance of 20 m and the single breakwater are the lowest and the highest respectively the weakening effect of the tandem breakwater on the turbulence of the water body is more significant than that of the single breakwater fig 36 shows the temporal evolution of the run up height and the comparison of the maximum run up height under different tandem breakwaters when the distance s is from 0 to 20 m the wave run up height decreases then the wave height increase slightly fig 37 depicts the horizontal and vertical hydrodynamic forces on the breakwaters at different distance when the distance s is less than 40 m compared with the force on the front breakwater the horizontal force on the rear breakwater is always larger but the vertical force is smaller at the same distance since the vertical force is much larger than the horizontal force the overall force on the breakwater is consistent with the vertical force therefore the overall force on the front breakwater is larger than that on the rear breakwater however when the distance s is 45 m the forces on the rear breakwater are larger than that on the front breakwater due to the reliance of the sloping beach and the backflow the maximum hydrodynamic forces on the sloping beach are shown in fig 38 under the single breakwater the forces on the sloping beach are larger than that under the tandem breakwater which means that the tandem breakwater has better protection function for the sloping beach when the distance is 30 m the force on the slope is the smallest in general in this case the distance between two breakwaters from 20 m to 30 m is appropriate 4 3 effect of marine environment in the ocean the wave heights are varied in order to analyze the effect of the breakwater on the wave propagation at different wave height six wave heights are designed 1 6 1 8 2 0 2 2 2 4 and 2 6 m and the radius porosity coefficient and the medium diameter of the breakwater are 3 m 0 6 and 0 3 m respectively the distance between the breakwater center and the root of the sloping beach is 50 m the attenuation coefficient of the wave run up height and the fluctuation factor of the force are defined as 26 θ r z z 100 27 ω f m n f m 1 n h h m h m 1 100 where z is the free surface height z h h fm n and hm are the normalized force and wave height at the step of m when the wave passes through breakwater the maximum free surface elevations recorded at wg1 and wg2 are shown in fig 39 with the increase of the wave height both the free surface elevation and the attenuation coefficients increase the larger the attenuation coefficient is the more serious the wave surface drops under the same wave height difference indicating that the influence of the breakwater on the wave with high wave height is more significant than that with low wave height the velocity and vorticity contours of the flow fields at three wave heights of 2 2 and 2 4 m are show in figs 40 and 41 when the wave arrives at the breakwater with the increase of the wave height the flow velocities around and in the breakwater increase however these vortices are similar to each other when the wave crest is above the breakwater the high velocity area above the breakwater at 2 4 m wave height is much larger than that under other wave heights after the wave passes over the breakwater both the velocity and the vortex behind the breakwater increases the higher the wave height the larger the vortex and the greater the velocity magnitude after the wave leaves the vortices begin to shed and with the increase of the wave height the shedding vortices also increase the free surface elevations under three wave heights of 1 8 2 2 and 2 6 m at different moments are drawn in fig 42 with the increase of the wave height the water level above the sloping beach increases and there is an obvious water bag when the wave height is 2 6 m then the wave flows along the sloping beach when the wave run up height reaches the maximum the run up height at the wave height of 2 6 m is the highest soon the wave drops along the sloping beach the higher the wave height the higher the wave run up height fig 43 a with the increase of the wave height the attenuation coefficient increases substantially linearly which means that the higher the wave height the more serious the decrease of the run up height under the same wave height difference fig 43b the horizontal and vertical hydrodynamic forces on the breakwater are shown in fig 44 with the increase of the wave height both the wave velocity and the volume increase leading to the increase of the forces on the breakwater the fluctuation factor represents the gradient variation of the forces with the increase of the wave height the factor decreases indicating that the higher the wave height the smaller the force difference on the breakwater as for the sloping beach with the increase of the wave height the forces on the sloping beach are also increasing but the wave fluctuation factor has undergone serious changes which are different from those for breakwater fig 45 when the wave height difference changes from 0 4 m to 0 6 m the factor increases by 20 which means that in the vicinity of the wave height of 2 2 m the forces on the sloping beach changes seriously and the sloping beach is highly sensitive to this wave height in general although the breakwater can affect the wave propagation and reduce the wave run up height and forces on the sloping beach according to the attenuation coefficient and the fluctuation factor the influence degree and sensitivity of the breakwater to the waves with different wave heights are completely different 5 conclusions in this study the effects of different semi circular porous media submerged breakwater on wave propagation are investigated numerically the properties and the structural changes of the breakwater include the porosity the particle median diameter and the breakwater radius besides the effects of the breakwater location and the tandem breakwater are considered due to the complexity of marine environment the influence of waves with different wave heights on the breakwater and the sloping beach is also investigated the main conclusions are as follows 1 when the breakwater is porosity besides the circumfluence flow behind the breakwater some water seeps out of the breakwater and the interaction between these two types of water leads to the increase of flow turbulent intensity and vorticity the larger the porosity the stronger the flow intensity of the seeping water resulting in the larger vortex and the faster shedding speed the porosity breakwater can effectively block the wave propagation and reduce the run up height however with the increase of the porosity the maximum run up height does not always decrease linearly when the gravel median diameter changes with the increase of the median diameter the maximum run up height and the horizontal hydrodynamic force on the breakwater decrease but the vertical hydrodynamic force on the breakwater increases comparing the effects of the porosity and the median diameter the influence of porosity is more significant than medium diameter therefore the porosity is the primary factor to be considered in protecting the coast by submerged breakwater and on this basis an appropriate medium diameter can be selected 2 with the increase of the breakwater size the maximum wave run up height and the forces on the sloping beach decrease however the forces on the breakwater increase which may cause the mechanical destruction of the breakwater depending on the research of the effect of the breakwater location on the wave propagation it is found that if the distance between the breakwater and the sloping beach is too small or too large both the maximum run up height and the forces on the sloping beach increase compared with the single breakwater the tandem breakwater can reduce the run up height seriously in this case the distance between two breakwaters from 20 m to 30 m is appropriate for the reduction of the wave run up height and the force 3 when the wave changes with the increase of the wave height the wave run up height increases however the run up height difference and the fluctuation factor of force on the breakwater decrease indicating that the higher the wave height the smaller the force difference on the breakwater under the same wave height difference for the sloping beach in the vicinity of this wave height of 2 2 m the forces on the sloping beach change seriously and the sloping beach is highly sensitive to this wave height although the breakwater can affect the wave propagation and reduce the wave run up height and forces on the sloping beach according to the attenuation coefficient and the fluctuation factor the influence degree and sensitivity of the breakwater to the waves with different wave heights are completely different credit authorship contribution statement enjin zhao conceptualization methodology validation investigation writing original draft data curation formal analysis visualization project administration writing review editing youkou dong conceptualization methodology validation investigation writing original draft data curation formal analysis visualization project administration writing review editing yuezhao tang visualization project administration writing review editing xiaoyu xia visualization project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grant no 52001286 51909248 and special open fund of shandong key laboratory of ocean engineering in 2019 the authors are grateful to the anonymous reviewers for their valuable input 
21041,there has been an increasing attention to the effect of hull roughness on ship resistance and powering in conventional studies the hull surfaces have been treated as uniform rough surfaces while the real ships hulls are exposed heterogeneous fouling accumulation the work described here presents an experimental investigation into the effect of heterogeneous hull roughness on ship resistance a series of towing tests were conducted using a ship model of the wigley hull with various hull roughness conditions including homogeneous conditions i e smooth and full rough conditions and heterogeneous conditions i e ¼ bow rough ¼ aft rough ½ bow rough and ½ aft rough conditions the bow rough conditions e g ¼ bow rough and ½ bow rough showed larger added resistance than aft rough conditions e g ¼ aft rough and ½ aft rough with the same wetted surface area of the rough region this finding suggests that the hull roughness of the forward part of the hull is more significant than the others in terms of the added resistance finally a new method was proposed to predict the added resistance due to the heterogeneous hull roughness based on granville s similarity law scaling and the predictions were compared with the experimental result keywords roughness effect wigley hull ship resistance towing test heterogeneous hull roughness 1 introduction one of the main reasons for the performance degradation of ships is increased hull roughness the hull roughness of a ship increases by time due to various factors such as corrosion and biofouling tezdogan and demirel 2014 townsin 2003 the ship resistance increases markedly with increased hull roughness and thus economic and environmental penalties follow accordingly there has been extensive research carried out in order to predict the effect of hull roughness on ship resistance and powering either using the similarity law scaling or computational fluid dynamics cfd the similarity law scaling method of granville 1958 1978 has been the most popular method to predict the roughness effect on ship resistance e g schultz 2002 schultz 2004 schultz and flack 2007 flack and schultz 2010 schultz et al 2011 demirel et al 2017a demirel et al 2019 li et al 2019 uzun et al 2019 2020 the advantages of using the granville s method include that it can predict the roughness effect on the skin friction of a flat plate of arbitrary length and speeds once the roughness function of the surface is known this flat plate assumption is generally considered as reasonable and it shows good agreement with other high fidelity methods demirel et al 2017b song et al 2019a while it requires much less computational cost recently song et al 2020a validated this method by comparing the predicted result with the experimental data involving a towed ship model with a rough surface during the past few years there has been increasing attention to modelling the roughness effect using cfd simulations one of the merits of using cfd is that the three dimensional 3d effects can be taken into account which makes it possible to predict the roughness effect on the pressure related ship resistance components as well as the effect on the propeller performance a recent trend is using modified wall functions by employing the roughness function of the given rough surface into the simulation models e g demirel et al 2014 demirel et al 2017b farkas et al 2018 song et al 2019a song et al 2019b song et al 2020b song et al 2020c song et al 2020d farkas et al 2020 recently song et al 2020e validated the similarity law scaling and the cfd approach by comparing the predictions with the towing tests involving a ship model with a rough surface however in the above studies the hull surfaces have been treated as uniformly rough while the real ships surfaces are not uniform due to the exposition to heterogeneous fouling accumulation this difference can introduce uncertainties in the added resistance predictions as claimed by demirel et al 2017a furthermore pullin et al 2017 asserted that the roughness effect varies with the downstream distance this implies that the hull roughness in the different regions may have different contributions to the added resistance therefore it is worthwhile to investigate whether the heterogeneous distribution of hull roughness brings different results compared to the case of homogeneous hull roughness i e evenly distributed hull roughness to the best of the authors knowledge there exists no specific study investigating the effect of heterogeneous distributions of hull roughness on ship resistance therefore this study aims to fill this gap by conducting towing tests of a ship model with heterogeneous hull roughness in this study towing tests were conducted using a wigley hull model with heterogeneous hull roughness conditions i e ¼ bow rough ¼ aft rough ½ bow rough and ½ aft rough conditions as well as homogeneous conditions i e smooth and full rough conditions by applying sand grit on the hull surface systematically a new prediction method was proposed to predict the added resistance due to the heterogeneous hull roughness and the predictions were compared with the experimental result 2 methodology 2 1 approach fig 1 schematically illustrates the methodology used in this study a series of towing tests of the wigley hull model were conducted with different hull conditions including the heterogeneous hull conditions i e ¼ bow rough ¼ aft rough ½ bow rough and ½ aft rough conditions as well as the homogeneous hull conditions i e smooth and full rough conditions in order to roughen the hull surface heterogeneously sand grit aluminium oxide abrasive powder was gradually applied on the different regions of the hull surface as shown in fig 2 the wigley hull has a symmetric hull shape to the midship therefore the same hull surfaces can be used for both the bow rough and aft rough conditions by towing the model in different directions for example the ½ rough hull surface in fig 2 was used for both the ½ bow rough and ½ aft rough conditions as shown in fig 3 a new prediction method was proposed based on the similarity law scaling granville 1958 1978 to predict the added resistance due to heterogeneous hull roughness considering the wetted surface areas of different hull regions with different hull roughness the similarity law scaling was performed using the roughness function δ u of the sand grit which was obtained from our previous study song et al 2020a and the added resistance values of the wigley model due to the heterogeneous hull roughness were predicted and compared with the results of the towing tests of the wigley model 2 2 experimental setup 2 2 1 towing tank the towing test was carried out in the kelvin hydrodynamics laboratory khl of the university of strathclyde the tank has a dimension of 76 0 m l 4 6 m w 2 5 m d the tank is equipped with a digitally controlled towing carriage a state of the art absorbing wave maker and a highly effective sloping beach the carriage has a velocity range of 0 5 m s the carriage is able to be driven in the reverse direction fig 3 shows the towing carriage in the khl and the wigley model towed in the forward and backward directions with the ½ rough surface condition fresh water was used for the experiments wherein the water temperature was monitored during the tests 2 2 2 wigley hull model in this study a wigley hull model with standard proportions was used the wigley hull is a parabolic hull form which can be represented by 1 y b 2 1 2 x l 2 1 z t 2 where l b and t are the length waterline beam and the draft of the model the principal particulars of the wigley model can be found in table 1 fig 4 illustrates the experimental setup used for the towing test during the test the model was free to trim and sink a load cell was attached at the tow point to measure the total resistance of the model ship the model was towed with the speed range of 1 08 2 71 m s which corresponds to the froude number fn of 0 2 0 5 for roughening the surface clarke aluminium oxide abrasive powder 60 80 grit rt50 353 μm was applied on the surface as used by song et al 2020a 2 3 uncertainty analysis the uncertainties of the measurements in the tests were estimated following the ittc recommended procedures ittc 2014 the precision limits were determined through the repeatability test and the bias limits were calculated considering the uncertainties associated with the calibration data acquisition data reduction and conceptual bias the repeatability tests of the bow rough conditions e g ¼ bow rough and ½ bow rough were conducted only at the highest speed while the repeatability tests of the aft rough conditions e g ¼ aft rough and ½ aft rough were conducted only at the lowest speed table 2 shows the absolute and relative overall uncertainties of the total resistance coefficient of the wigley model 3 result 3 1 verification of model symmetricity as mentioned earlier the bow rough and aft rough conditions e g ½ bow rough and ½ aft rough in fig 1 were realised by towing the model in different directions while using the same hull surfaces e g ½ rough surface in fig 2 as shown in fig 3 therefore it is necessary to verify the model symmetricity before investigating the effect of heterogeneous hull roughness the towing test results of the homogeneous hull conditions e g smooth and full rough conditions in different towing directions were compared for the verification of the model symmetricity fig 5 compares total resistance coefficient c t of the wigley model with the homogeneous hull conditions e g smooth and full rough conditions as shown in the figures the c t values of the smooth condition were observed not to be significaltly affected by the towing directions showing the deviations within the uncertainty levels of the experiment this suggests that the geometric accuracy of the model is within a satisfactory level therefore the differences between the bow and aft rough conditions i e difference between ¼ bow rough and ¼ aft rough conditions can be purely attributed to the different locations of the hull roughness similarly the c t values of the full rough conditions were almost identical regardless of the towing directions this validates again the geometric symmetricity of the model and also suggests that the potential imperfections of the sand grit application do not affect the result significantly 3 2 effect of heterogeneous hull roughness as shown in fig 6 the model with the ¼ bow rough condition showed larger c t values compared to the c t values of the ¼ aft rough condition the percentage increases in c t compared to the smooth condition δ c t are 12 18 for the ¼ bow rough condition and 8 10 for the ¼ aft rough condition similarly the wigley hull with the ½ bow rough condition showed larger c t values than the results of the ½ aft rough condition as shown in fig 7 the δ c t values with the ½ bow rough condition are 21 30 while these values are 16 22 for the ½ aft rough condition these results imply that the hull roughness of the fore part of the ship results in greater added resistance than the roughness of the aft part 3 3 rationale behind the effect of heterogeneous roughness as differences in the roughness effect on the c t were observed between the bow rough and aft rough conditions as shown in figs 6 and 7 it is worthwhile to discuss the possible rationale behind this observation one of the most likely reason is the varying contributions of the local skin friction c f to the total drag of the ship it is a well known fact that regardless of the roughness effect the c f is larger near the leading edge due to the active transition behaviours and it decreases as the flow is developed along the hull i e the bow region of the wigley model has larger wall shear stress τ w accordingly the roughness reynolds numbers k k u τ ν in the bow region become larger and the roughness effect in this region becomes more evident where k is the roughness height u τ τ w ρ is the frictional velocity and ν is the kinematic viscosity of water although the local skin friction on the wigley model was not measured during the test alternatively this rationale could be supported by cfd simulations conducted in our previous study which involves a 1 5 m towed flat plate in smooth and rough surface conditions song et al 2020e fig 8 compares the c f values of the plate in the smooth and rough conditions along the line of z 2 t and the difference δ c f between the smooth and rough cases as shown in the figure the smooth plate shows larger c f near the leading edge and the values gradually reduce along the flat plate the rough plate shows an even larger peak of the c f near the leading edge accordingly the δ c f is greater in the forward region and it reduces gradually along the plate which is in correspondence with the k values on the plate surface as shown in fig 9 it is of note that fig 9 shows the k values on the vertically towed flat plate crossing free surface and therefore low k values appear in the dry region above the free surface due to the low viscosity of air from this observation it can be deduced that the roughness effect on the skin friction i e δ c f is greater in the forward region of the flat plate and the same logic can be applied to ship hulls 4 new prediction method for heterogeneous hull roughness in this study a new prediction method was developed for the added resistance of a ship due to the heterogeneous hull roughness based on the added resistance predictions obtained from the similarity law scaling of granville 1958 1978 this new method considers the effect of different wetted surface areas of the individual regions with different hull roughness while neglecting the effect of the different locations of the roughness the added frictional resistance of a ship δ c f with n different roughness regions is determined as 2 δ c f i 1 n w s a i w s a s h i p δ c f i where w s a i is the wetted surface area of the i t h region w s a s h i p is the total wetted surface area of the ship δ c f i is the added frictional resistance with the hull roughness in the i t h region obtained from the granville s method under the assumption of the homogeneous distribution of the given hull roughness details of granville s similarity law scaling can be found in our previous studies demirel et al 2019 song et al 2020a the frictional resistance of the ship c f r with heterogeneous hull roughness can be determined as 3 c f r c f s δ c f in which c f s is the frictional resistance coefficient of a smooth ship that can be obtained by using kàrmàn schoenherr friction line schoenherr 1932 as 4 0 242 c f log r e l c f where r e l is the reynolds number based on the length of the ship the obtained c f r can be used to predict the total resistance coefficient c t of a ship with heterogeneous hull roughness recently song et al 2020a used two different added resistance prediction methods due to hull roughness based on the hypotheses of froude and hughes namely 2d method and 3d method song et al 2020a concluded that the 3d method predicts the total resistance more accurately than the 2d method due to the fact that the hull roughness not only affects the skin friction but also increases the viscous pressure resistance c v p this conclusion is supported by other recent studies involving cfd simulations song et al 2019a 2020c 2020d therefore 3d method is used to predict the c t of the wigley model together with the obtained c f r values in the 3d method the total resistance for the rough ship model c t r is determined by 5 c t r 1 k c f r c w where c w is the wave making resistance of the ship k is the form factor of the ship 4 1 resistance prediction and comparison against efd before predicting the frictional resistance of the wigley model with different surface conditions using equation 2 the frictional resistance of the sand grit surface was predicted first using the similarity law scaling song et al 2020a showed that the roughness functions of the same sand grit surface follow the nikuradse type roughness function model of cebeci and bradshaw 1977 when the equivalent sand grain roughness height k s 1 73 r t 50 is used r t 50 353 μm as shown in fig 10 therefore the similarity law scaling was conducted using the roughness function model of cebeci and bradshaw 1977 defined as 6 δ u 0 k 2 25 1 κ ln 0 253 k sin π 2 log k 2 25 log 90 2 25 2 25 k 90 1 κ ln 0 253 k 90 k fig 11 shows the c f values of the wigley hull with different surface conditions predicted using the newly proposed method equations 2 and 3 in the figure the smooth type c f values were calculated using the kàrmàn schoenherr friction line equation 4 to calculate the c t of the ship using the 3d method the form factor k and the wave making resistance coefficient c w values are needed equation 5 unfortunately the prohaska s test could not be conducted in this study as the result at low towing speed f n 0 2 was unstable due to the absence of turbulence stimulator alternatively the form factor was obtained by reproducing the experimental data of ju 1983 which used a similar length l 3 048 m of wigley model with a similar water temperature 13 c as well as the same free trim and sinkage condition as shown in fig 12 the form factor value k 0 12 was calculated using a regression line of the data at the low speed region f n 0 2 also the potential based c w values for the wigley hull with free trim and sinkage determined by chen et al 2019 were used for the c t prediction figs 13 15 show the c t of the wigley model obtained from the towing test and the predicted c t values from the newly proposed method the predicted c t values show a reasonable agreement with the towing test results as shown in figs 13 and 14 the predicted c t values of the heterogeneous hull conditions located mostly in between the bow rough and aft rough results of the experiment this can be attributed to the fact that the newly proposed prediction method does not consider the effect of different locations of the hull roughness while it considers the effect of the different wetted surface areas of the individual roughness regions on the other hand the prediction for the full rough condition shows a fair agreement in general as shown in fig 15 but relatively higher deviations were observed at high speeds f n 0 4 possible reasons for these deviations include the unknown impacts of hull roughness on the form factor k and wave making resistance c w inaccuracies of the granville s extrapolation as well as the uncertainties of the experimentally obtained roughness functions it is of note that this new prediction method does not differ from the conventional granville s approach for a homogeneously distributed hull roughness e g full rough condition in fig 15 5 concluding remarks towing tests were conducted involving a wigley hull model with different hull roughness conditions including the heterogeneous hull conditions i e ¼ bow rough ¼ aft rough ½ bow rough and ½ aft rough conditions and the homogeneous hull conditions i e smooth and full rough conditions the bow rough conditions i e ¼ bow rough and ½ bow rough showed larger added resistance compared to the aft rough conditions ¼ aft rough and ½ aft rough with the same wetted surface area of the roughness region the finding suggests that the hull roughness of the front part of the ship results in more added resistance than the hull roughness in other regions the rationale behind this difference was discussed with an example of a cfd simulation conducted in the previous study song et al 2020e a new method was proposed to predict the effect of heterogeneous hull roughness on ship resistance based on the similarity law scaling the method considers the different wetted surface areas of the different roughness regions while neglecting the location of the hull roughness the results predicted using the newly proposed method showed a reasonable agreement with the towing test results considering that the heterogeneous roughness conditions used in this study are rather extreme i e sudden changes in the hull roughness from a smooth surface to a remarkably rough surface the newly proposed method could establish better predictions for real ship cases with milder heterogeneous distributions of hull roughness therefore future work may include applying the new prediction method for other types of hull conditions such as heterogeneous fouling surfaces the study presents a useful investigation into the effect of heterogeneous hull roughness suggesting that the hull roughness in different locations can bring different roughness effects on the ship resistance for better understandings regarding this new observation the study should be extended using cfd simulations which will enable an investigation into the flow characteristics around the heterogeneous hull roughness another recommended future work is case studies to predict the added resistance due to heterogeneous hull roughness using cfd simulations and the newly proposed prediction method to examine the agreement between these low and high fidelity methods credit authorship contribution statement soonseok song writing original draft data curation software formal analysis investigation validation visualization roberto ravenna data curation investigation formal analysis saishuai dai data curation investigation validation claire demarco muscat fenech writing review editing project administration funding acquisition giorgio tani writing review editing project administration supervision yigit kemal demirel conceptualization methodology supervision writing review editing project administration resources funding acquisition mehmet atlar writing review editing project administration supervision sandy day resources writing review editing project administration supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors gratefully acknowledge that the research presented in this paper was carried out as part of the eu funded h2020 project venture grant no 856887 
21041,there has been an increasing attention to the effect of hull roughness on ship resistance and powering in conventional studies the hull surfaces have been treated as uniform rough surfaces while the real ships hulls are exposed heterogeneous fouling accumulation the work described here presents an experimental investigation into the effect of heterogeneous hull roughness on ship resistance a series of towing tests were conducted using a ship model of the wigley hull with various hull roughness conditions including homogeneous conditions i e smooth and full rough conditions and heterogeneous conditions i e ¼ bow rough ¼ aft rough ½ bow rough and ½ aft rough conditions the bow rough conditions e g ¼ bow rough and ½ bow rough showed larger added resistance than aft rough conditions e g ¼ aft rough and ½ aft rough with the same wetted surface area of the rough region this finding suggests that the hull roughness of the forward part of the hull is more significant than the others in terms of the added resistance finally a new method was proposed to predict the added resistance due to the heterogeneous hull roughness based on granville s similarity law scaling and the predictions were compared with the experimental result keywords roughness effect wigley hull ship resistance towing test heterogeneous hull roughness 1 introduction one of the main reasons for the performance degradation of ships is increased hull roughness the hull roughness of a ship increases by time due to various factors such as corrosion and biofouling tezdogan and demirel 2014 townsin 2003 the ship resistance increases markedly with increased hull roughness and thus economic and environmental penalties follow accordingly there has been extensive research carried out in order to predict the effect of hull roughness on ship resistance and powering either using the similarity law scaling or computational fluid dynamics cfd the similarity law scaling method of granville 1958 1978 has been the most popular method to predict the roughness effect on ship resistance e g schultz 2002 schultz 2004 schultz and flack 2007 flack and schultz 2010 schultz et al 2011 demirel et al 2017a demirel et al 2019 li et al 2019 uzun et al 2019 2020 the advantages of using the granville s method include that it can predict the roughness effect on the skin friction of a flat plate of arbitrary length and speeds once the roughness function of the surface is known this flat plate assumption is generally considered as reasonable and it shows good agreement with other high fidelity methods demirel et al 2017b song et al 2019a while it requires much less computational cost recently song et al 2020a validated this method by comparing the predicted result with the experimental data involving a towed ship model with a rough surface during the past few years there has been increasing attention to modelling the roughness effect using cfd simulations one of the merits of using cfd is that the three dimensional 3d effects can be taken into account which makes it possible to predict the roughness effect on the pressure related ship resistance components as well as the effect on the propeller performance a recent trend is using modified wall functions by employing the roughness function of the given rough surface into the simulation models e g demirel et al 2014 demirel et al 2017b farkas et al 2018 song et al 2019a song et al 2019b song et al 2020b song et al 2020c song et al 2020d farkas et al 2020 recently song et al 2020e validated the similarity law scaling and the cfd approach by comparing the predictions with the towing tests involving a ship model with a rough surface however in the above studies the hull surfaces have been treated as uniformly rough while the real ships surfaces are not uniform due to the exposition to heterogeneous fouling accumulation this difference can introduce uncertainties in the added resistance predictions as claimed by demirel et al 2017a furthermore pullin et al 2017 asserted that the roughness effect varies with the downstream distance this implies that the hull roughness in the different regions may have different contributions to the added resistance therefore it is worthwhile to investigate whether the heterogeneous distribution of hull roughness brings different results compared to the case of homogeneous hull roughness i e evenly distributed hull roughness to the best of the authors knowledge there exists no specific study investigating the effect of heterogeneous distributions of hull roughness on ship resistance therefore this study aims to fill this gap by conducting towing tests of a ship model with heterogeneous hull roughness in this study towing tests were conducted using a wigley hull model with heterogeneous hull roughness conditions i e ¼ bow rough ¼ aft rough ½ bow rough and ½ aft rough conditions as well as homogeneous conditions i e smooth and full rough conditions by applying sand grit on the hull surface systematically a new prediction method was proposed to predict the added resistance due to the heterogeneous hull roughness and the predictions were compared with the experimental result 2 methodology 2 1 approach fig 1 schematically illustrates the methodology used in this study a series of towing tests of the wigley hull model were conducted with different hull conditions including the heterogeneous hull conditions i e ¼ bow rough ¼ aft rough ½ bow rough and ½ aft rough conditions as well as the homogeneous hull conditions i e smooth and full rough conditions in order to roughen the hull surface heterogeneously sand grit aluminium oxide abrasive powder was gradually applied on the different regions of the hull surface as shown in fig 2 the wigley hull has a symmetric hull shape to the midship therefore the same hull surfaces can be used for both the bow rough and aft rough conditions by towing the model in different directions for example the ½ rough hull surface in fig 2 was used for both the ½ bow rough and ½ aft rough conditions as shown in fig 3 a new prediction method was proposed based on the similarity law scaling granville 1958 1978 to predict the added resistance due to heterogeneous hull roughness considering the wetted surface areas of different hull regions with different hull roughness the similarity law scaling was performed using the roughness function δ u of the sand grit which was obtained from our previous study song et al 2020a and the added resistance values of the wigley model due to the heterogeneous hull roughness were predicted and compared with the results of the towing tests of the wigley model 2 2 experimental setup 2 2 1 towing tank the towing test was carried out in the kelvin hydrodynamics laboratory khl of the university of strathclyde the tank has a dimension of 76 0 m l 4 6 m w 2 5 m d the tank is equipped with a digitally controlled towing carriage a state of the art absorbing wave maker and a highly effective sloping beach the carriage has a velocity range of 0 5 m s the carriage is able to be driven in the reverse direction fig 3 shows the towing carriage in the khl and the wigley model towed in the forward and backward directions with the ½ rough surface condition fresh water was used for the experiments wherein the water temperature was monitored during the tests 2 2 2 wigley hull model in this study a wigley hull model with standard proportions was used the wigley hull is a parabolic hull form which can be represented by 1 y b 2 1 2 x l 2 1 z t 2 where l b and t are the length waterline beam and the draft of the model the principal particulars of the wigley model can be found in table 1 fig 4 illustrates the experimental setup used for the towing test during the test the model was free to trim and sink a load cell was attached at the tow point to measure the total resistance of the model ship the model was towed with the speed range of 1 08 2 71 m s which corresponds to the froude number fn of 0 2 0 5 for roughening the surface clarke aluminium oxide abrasive powder 60 80 grit rt50 353 μm was applied on the surface as used by song et al 2020a 2 3 uncertainty analysis the uncertainties of the measurements in the tests were estimated following the ittc recommended procedures ittc 2014 the precision limits were determined through the repeatability test and the bias limits were calculated considering the uncertainties associated with the calibration data acquisition data reduction and conceptual bias the repeatability tests of the bow rough conditions e g ¼ bow rough and ½ bow rough were conducted only at the highest speed while the repeatability tests of the aft rough conditions e g ¼ aft rough and ½ aft rough were conducted only at the lowest speed table 2 shows the absolute and relative overall uncertainties of the total resistance coefficient of the wigley model 3 result 3 1 verification of model symmetricity as mentioned earlier the bow rough and aft rough conditions e g ½ bow rough and ½ aft rough in fig 1 were realised by towing the model in different directions while using the same hull surfaces e g ½ rough surface in fig 2 as shown in fig 3 therefore it is necessary to verify the model symmetricity before investigating the effect of heterogeneous hull roughness the towing test results of the homogeneous hull conditions e g smooth and full rough conditions in different towing directions were compared for the verification of the model symmetricity fig 5 compares total resistance coefficient c t of the wigley model with the homogeneous hull conditions e g smooth and full rough conditions as shown in the figures the c t values of the smooth condition were observed not to be significaltly affected by the towing directions showing the deviations within the uncertainty levels of the experiment this suggests that the geometric accuracy of the model is within a satisfactory level therefore the differences between the bow and aft rough conditions i e difference between ¼ bow rough and ¼ aft rough conditions can be purely attributed to the different locations of the hull roughness similarly the c t values of the full rough conditions were almost identical regardless of the towing directions this validates again the geometric symmetricity of the model and also suggests that the potential imperfections of the sand grit application do not affect the result significantly 3 2 effect of heterogeneous hull roughness as shown in fig 6 the model with the ¼ bow rough condition showed larger c t values compared to the c t values of the ¼ aft rough condition the percentage increases in c t compared to the smooth condition δ c t are 12 18 for the ¼ bow rough condition and 8 10 for the ¼ aft rough condition similarly the wigley hull with the ½ bow rough condition showed larger c t values than the results of the ½ aft rough condition as shown in fig 7 the δ c t values with the ½ bow rough condition are 21 30 while these values are 16 22 for the ½ aft rough condition these results imply that the hull roughness of the fore part of the ship results in greater added resistance than the roughness of the aft part 3 3 rationale behind the effect of heterogeneous roughness as differences in the roughness effect on the c t were observed between the bow rough and aft rough conditions as shown in figs 6 and 7 it is worthwhile to discuss the possible rationale behind this observation one of the most likely reason is the varying contributions of the local skin friction c f to the total drag of the ship it is a well known fact that regardless of the roughness effect the c f is larger near the leading edge due to the active transition behaviours and it decreases as the flow is developed along the hull i e the bow region of the wigley model has larger wall shear stress τ w accordingly the roughness reynolds numbers k k u τ ν in the bow region become larger and the roughness effect in this region becomes more evident where k is the roughness height u τ τ w ρ is the frictional velocity and ν is the kinematic viscosity of water although the local skin friction on the wigley model was not measured during the test alternatively this rationale could be supported by cfd simulations conducted in our previous study which involves a 1 5 m towed flat plate in smooth and rough surface conditions song et al 2020e fig 8 compares the c f values of the plate in the smooth and rough conditions along the line of z 2 t and the difference δ c f between the smooth and rough cases as shown in the figure the smooth plate shows larger c f near the leading edge and the values gradually reduce along the flat plate the rough plate shows an even larger peak of the c f near the leading edge accordingly the δ c f is greater in the forward region and it reduces gradually along the plate which is in correspondence with the k values on the plate surface as shown in fig 9 it is of note that fig 9 shows the k values on the vertically towed flat plate crossing free surface and therefore low k values appear in the dry region above the free surface due to the low viscosity of air from this observation it can be deduced that the roughness effect on the skin friction i e δ c f is greater in the forward region of the flat plate and the same logic can be applied to ship hulls 4 new prediction method for heterogeneous hull roughness in this study a new prediction method was developed for the added resistance of a ship due to the heterogeneous hull roughness based on the added resistance predictions obtained from the similarity law scaling of granville 1958 1978 this new method considers the effect of different wetted surface areas of the individual regions with different hull roughness while neglecting the effect of the different locations of the roughness the added frictional resistance of a ship δ c f with n different roughness regions is determined as 2 δ c f i 1 n w s a i w s a s h i p δ c f i where w s a i is the wetted surface area of the i t h region w s a s h i p is the total wetted surface area of the ship δ c f i is the added frictional resistance with the hull roughness in the i t h region obtained from the granville s method under the assumption of the homogeneous distribution of the given hull roughness details of granville s similarity law scaling can be found in our previous studies demirel et al 2019 song et al 2020a the frictional resistance of the ship c f r with heterogeneous hull roughness can be determined as 3 c f r c f s δ c f in which c f s is the frictional resistance coefficient of a smooth ship that can be obtained by using kàrmàn schoenherr friction line schoenherr 1932 as 4 0 242 c f log r e l c f where r e l is the reynolds number based on the length of the ship the obtained c f r can be used to predict the total resistance coefficient c t of a ship with heterogeneous hull roughness recently song et al 2020a used two different added resistance prediction methods due to hull roughness based on the hypotheses of froude and hughes namely 2d method and 3d method song et al 2020a concluded that the 3d method predicts the total resistance more accurately than the 2d method due to the fact that the hull roughness not only affects the skin friction but also increases the viscous pressure resistance c v p this conclusion is supported by other recent studies involving cfd simulations song et al 2019a 2020c 2020d therefore 3d method is used to predict the c t of the wigley model together with the obtained c f r values in the 3d method the total resistance for the rough ship model c t r is determined by 5 c t r 1 k c f r c w where c w is the wave making resistance of the ship k is the form factor of the ship 4 1 resistance prediction and comparison against efd before predicting the frictional resistance of the wigley model with different surface conditions using equation 2 the frictional resistance of the sand grit surface was predicted first using the similarity law scaling song et al 2020a showed that the roughness functions of the same sand grit surface follow the nikuradse type roughness function model of cebeci and bradshaw 1977 when the equivalent sand grain roughness height k s 1 73 r t 50 is used r t 50 353 μm as shown in fig 10 therefore the similarity law scaling was conducted using the roughness function model of cebeci and bradshaw 1977 defined as 6 δ u 0 k 2 25 1 κ ln 0 253 k sin π 2 log k 2 25 log 90 2 25 2 25 k 90 1 κ ln 0 253 k 90 k fig 11 shows the c f values of the wigley hull with different surface conditions predicted using the newly proposed method equations 2 and 3 in the figure the smooth type c f values were calculated using the kàrmàn schoenherr friction line equation 4 to calculate the c t of the ship using the 3d method the form factor k and the wave making resistance coefficient c w values are needed equation 5 unfortunately the prohaska s test could not be conducted in this study as the result at low towing speed f n 0 2 was unstable due to the absence of turbulence stimulator alternatively the form factor was obtained by reproducing the experimental data of ju 1983 which used a similar length l 3 048 m of wigley model with a similar water temperature 13 c as well as the same free trim and sinkage condition as shown in fig 12 the form factor value k 0 12 was calculated using a regression line of the data at the low speed region f n 0 2 also the potential based c w values for the wigley hull with free trim and sinkage determined by chen et al 2019 were used for the c t prediction figs 13 15 show the c t of the wigley model obtained from the towing test and the predicted c t values from the newly proposed method the predicted c t values show a reasonable agreement with the towing test results as shown in figs 13 and 14 the predicted c t values of the heterogeneous hull conditions located mostly in between the bow rough and aft rough results of the experiment this can be attributed to the fact that the newly proposed prediction method does not consider the effect of different locations of the hull roughness while it considers the effect of the different wetted surface areas of the individual roughness regions on the other hand the prediction for the full rough condition shows a fair agreement in general as shown in fig 15 but relatively higher deviations were observed at high speeds f n 0 4 possible reasons for these deviations include the unknown impacts of hull roughness on the form factor k and wave making resistance c w inaccuracies of the granville s extrapolation as well as the uncertainties of the experimentally obtained roughness functions it is of note that this new prediction method does not differ from the conventional granville s approach for a homogeneously distributed hull roughness e g full rough condition in fig 15 5 concluding remarks towing tests were conducted involving a wigley hull model with different hull roughness conditions including the heterogeneous hull conditions i e ¼ bow rough ¼ aft rough ½ bow rough and ½ aft rough conditions and the homogeneous hull conditions i e smooth and full rough conditions the bow rough conditions i e ¼ bow rough and ½ bow rough showed larger added resistance compared to the aft rough conditions ¼ aft rough and ½ aft rough with the same wetted surface area of the roughness region the finding suggests that the hull roughness of the front part of the ship results in more added resistance than the hull roughness in other regions the rationale behind this difference was discussed with an example of a cfd simulation conducted in the previous study song et al 2020e a new method was proposed to predict the effect of heterogeneous hull roughness on ship resistance based on the similarity law scaling the method considers the different wetted surface areas of the different roughness regions while neglecting the location of the hull roughness the results predicted using the newly proposed method showed a reasonable agreement with the towing test results considering that the heterogeneous roughness conditions used in this study are rather extreme i e sudden changes in the hull roughness from a smooth surface to a remarkably rough surface the newly proposed method could establish better predictions for real ship cases with milder heterogeneous distributions of hull roughness therefore future work may include applying the new prediction method for other types of hull conditions such as heterogeneous fouling surfaces the study presents a useful investigation into the effect of heterogeneous hull roughness suggesting that the hull roughness in different locations can bring different roughness effects on the ship resistance for better understandings regarding this new observation the study should be extended using cfd simulations which will enable an investigation into the flow characteristics around the heterogeneous hull roughness another recommended future work is case studies to predict the added resistance due to heterogeneous hull roughness using cfd simulations and the newly proposed prediction method to examine the agreement between these low and high fidelity methods credit authorship contribution statement soonseok song writing original draft data curation software formal analysis investigation validation visualization roberto ravenna data curation investigation formal analysis saishuai dai data curation investigation validation claire demarco muscat fenech writing review editing project administration funding acquisition giorgio tani writing review editing project administration supervision yigit kemal demirel conceptualization methodology supervision writing review editing project administration resources funding acquisition mehmet atlar writing review editing project administration supervision sandy day resources writing review editing project administration supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors gratefully acknowledge that the research presented in this paper was carried out as part of the eu funded h2020 project venture grant no 856887 
21042,an articulated intervention autonomous underwater vehicle aiauv is a slender multi articulated underwater robot accurate trajectory tracking is essential for aiauv operations furthermore due to hydrodynamic and hydrostatic parameter uncertainties uncertain thruster characteristics unknown disturbances and unmodelled dynamic effects robustness is crucial in this paper we present a super twisting algorithm sta with adaptive gains and a generalized super twisting algorithm gsta for trajectory tracking of the position and orientation of aiauvs a higher order sliding mode observer hosmo for estimating the linear and angular velocities when velocity measurements are unavailable is also presented the tracking errors for the resulting system are proven to converge asymptotically to zero finally we demonstrate the applicability of the presented control laws with comprehensive simulation and experimental results and perform a comparison study with two tests c shape and c shape with a moving head between the two algorithms and also a benchmark pid controller the sta with adaptive gains exhibits the best overall tracking performance with average position root mean square error rmse 0 0121 m and average orientation rmse 0 0335 rad the gsta also presented good results with average position rmse 0 0267 m and average orientation rmse 0 0292 rad the pid controller gave average position rmse 0 0371 m and average orientation rmse 0 0491 rad keywords experimental results sliding mode control autonomous underwater vehicle robotics control application 1 introduction an articulated intervention autonomous underwater vehicle aiauv is an underwater swimming manipulator it has the slender multi articulated body of an underwater snake robot usr which imparts the aiauv with accessibility and flexibility but it also has multiple thrusters along its body the thrusters enable the aiauv to move forward without using an undulating gait pattern and provides it with the ability to hover this property is especially important for station keeping and trajectory tracking in narrow and confined spaces these capabilities enable the aiauv to operate as a floating base manipulator moreover the aiauv has adopted the flexibility and high kinematic redundancy of the usr and the energy efficient shape and tether less operation of autonomous underwater vehicles auvs compared to standard survey auvs the aiauv has the advantage that it has full actuation and it can perform intervention tasks since it can use its slender body to access narrow spaces use its thrusters to keep itself stationary and then use its joints to perform intervention tasks the aiauv can exploit the full potential of the inherent kinematic redundancy which has been addressed in detail in sverdrup thygeson et al 2016 sverdrup thygeson et al 2018 the controller design for underwater vehicles uvs such as aiauvs auvs usrs and remotely operated vehicles rovs is a complex problem antonelli 2014 underwater vehicles are often subject to hydrodynamic and hydrostatic parameter uncertainties uncertain thruster characteristics unknown disturbances and unmodelled dynamic effects however the control design for the aiauv is more complex than for the other mentioned uvs and control methods used for these type of vehicles can therefore not be directly applied specifically the aiauv has the same mechanical structure as a usr while also possessing hovering and intervention capabilities because of the thrusters path following and manoeuvring control of usrs are discussed in kelasidi et al 2014 2017a kohl et al 2016a 2016b 2017a 2017b however these method are not suitable for utilizing the aiauv s hovering and intervention capabilities the auv is a single body uv and some methods for control design have been proposed in fossen 2011 while the aiauv is a floating base manipulator arm we therefore face the additional challenge of handling the interaction forces also referred to as coupling forces between the arm and the vehicle several different control approaches that address these challenges are summarized and presented in antonelli 2014 however antonelli 2014 considers mostly rovs rovs also face these challenges but for the aiauv the motion of the joints has a more significant effect on the overall motion of the aiauv than for rovs this is because the aiauv has no separate vehicle base and a low mass compared to an rov while rovs have a separate base with a larger inertia than that of the manipulator arm furthermore inertia drag forces and restoring forces and moments caused by the joint motion have a significant effect on the overall motion of the whole mechanism for which any joint motion leads to a corresponding change in the direction of the thrusters that are distributed along the robot all this increases the complexity of the motion for the aiauv thereby rendering the control problem even more complex than for rovs for the aiauv in particular some methods for propulsion have been proposed in kelasidi et al 2016 kelasidi et al 2017b and energy efficient methods for long distance travel have been proposed in wrzos kaminska et al 2019 in sverdrup thygeson et al 2016 2018 a control framework for aiauvs that uses inverse kinematic ik control together with a dynamic controller is proposed however in both papers ik is the main focus the dynamic controller proposed in sverdrup thygeson et al 2016 is only a simple p controller and the controller proposed in sverdrup thygeson et al 2018 is a feedback linearisation controller combined with a velocity based proportional integral derivative pid controller moreover none of these methods focus on robust control which is essential for the aiauv due to large coupling forces unknown disturbances and other unmodelled dynamic effects that affect the aiauv sliding mode control smc is a robust and versatile non linear control approach that is particularly well suited for situations where unknown non linearities affect the system as in the case of aiauvs in this paper we therefore investigate using smc to obtain a robust trajectory tracking controller in recent years several results have been reported regarding the use of smc for many complex dynamic systems for uvs in general some relevant contributions are the following in antonelli and chiaverini 1998 an smc approach for the regulation problem of an underwater vehicle manipulator system is developed this control law is inspired by fjellstad and fossen 1994 and avoids the inversion of the system jacobian and is therefore singularity free in fossen 1991 and fossen and sagatun 1991 an smc is used to address input uncertainty due to partly known non linear thruster characteristics in soylu et al 2008 a chattering free smc is proposed for trajectory control the chattering free approach is developed by combining the smc with adaptive proportional integral derivative controller gains and having an adaptive update of the upper bound on the disturbance and parameter uncertainties in dannigan and russell 1998 an smc is used to address the coupling effects between a manipulator and an uv by combining a virtual velocity control and smc a hybrid control strategy is developed in zhu and sun 2013 for the trajectory tracking of an unmanned uv in xu et al 2015 the trajectory tracking problem of an under actuated unmanned uv is studied by combining backstepping and smc an attitude controller for an auv is designed in cui et al 2016 by using a sliding mode based adaptive controller in liu et al 2017 the trajectory tracking problem for an uv subject to unknown system uncertainties and time varying external disturbances is considered and is solved by using a non linear disturbance observer based backstepping finite time smc scheme in von ellenrieder and henninger 2019 a third order sliding mode disturbance observer coupled with a modified super twisting controller is proposed for the trajectory tracking of fully actuated marine vehicles in the presence of unknown time varying disturbances however as mentioned in the previous section the control design for the aiauv is more complex than for the other mentioned uvs and control methods used for these type of vehicles can therefore not be directly applied in recent years smc has been further developed into higher order smc schemes which removes the chattering problem the super twisting algorithm sta with adaptive gains proposed by shtessel et al 2010 is the most powerful second order continuous smc algorithm as it attenuates chattering and does not require the consideration of any conservative upper bound on the disturbance to maintain sliding because of the adaptive gains motivated by this borlaug et al 2019a applied the sta together with a higher order sliding mode observer hosmo kumari et al 2016 to an aiauv the tracking problem of the centre of mass of the aiauv in 2dof was considered the tracking errors were proven to converge asymptomatically to zero and the simulation results demonstrated that the proposed control method provided excellent tracking capabilities however the tracking control problem was restricted to considering the position of the aiauv in 2dof and the movements of the joints were considered to be a disturbance we therefore extended these results in borlaug et al 2018 by considering the aiauv in 6dof and examining the tracking problem for the position orientation and joint angles equally good results were obtained in 6dof as in 2dof both in theory and in simulations in borlaug et al 2019a and borlaug et al 2018 an hosmo had to be used because velocity measurements were unavailable in borlaug et al 2019b we proposed using the generalized super twisting algorithm gsta proposed in castillo et al 2018 for trajectory tracking of an aiauv in 6dof in borlaug et al 2020 we extended the results obtained in borlaug et al 2019b to include results with and without an hosmo for trajectory tracking of an aiauv in 6dof the gsta is an extension of the sta that provides finite time convergence in the presence of time and state dependent perturbations which is essential for robust control of the aiauv these properties provide the gsta with additional theoretical advantages over the sta with adaptive gains these theoretical advantages enable verification that the tracking errors converge asymptotically to zero when the gsta is used without an hosmo which is not possible for the sta with adaptive gains in this paper we investigate the use of the sta with adaptive gains compared to the use of the gsta specifically we use both the sta with adaptive gains and the gsta for the trajectory tracking of the position and orientation of the base of an aiauv in 6dof we also solve the tracking problem using a pid controller to evaluate how the smc algorithms perform compared to a linear controller an hosmo for estimating the linear and angular velocities when velocity measurements are unavailable is also presented furthermore the tracking errors for the control law using the sta with adaptive gains in combination with the hosmo are proven to converge asymptotically to zero finally we demonstrate the applicability of the proposed control laws with comprehensive simulation and experimental results and we compare the results the main objective of this paper is a comparison between the sta with adaptive gains the gsta and a pid controller in addition the paper extends the results obtained in borlaug et al 2019a from 2dof to 6dof in borlaug et al 2019a the tracking problem of the centre of mass of the aiauv in 2dof was considered and solved using the sta with adaptive gains in combination with an hosmo and the tracking errors were proven to converge asymptotically to zero preliminary results were presented in borlaug et al 2018 in this paper these results are extended by also solving the tracking control problem using the sta with adaptive gains without an hosmo we also include extensive simulation and experimental results not presented in borlaug et al 2018 using the sta with adaptive gains in borlaug et al 2019b the tracking control problem is considered and solved using the gsta without an hosmo in borlaug et al 2020 the tracking control problem is considered and solved using the gsta with and without an hosmo and simulation and experimental results are given the simulation and experimental results given in borlaug et al 2020 are included in this paper to perform a comparison study between the sta with adaptive gains proposed here with the gsta proposed in borlaug et al 2020 the two algorithms are further compared with a benchmark pid controller the contributions of this paper can be summarized as follows the trajectory tracking control problem of an aiauv in 6dof is solved using the sta with adaptive gains the trajectory tracking control problem is also solved by using the algorithm in combination with an hosmo additionally the tracking errors for the control law using the sta with adaptive gains in combination with the hosmo are proven to converge asymptotically to zero we demonstrate the applicability of the presented control laws with comprehensive simulation and experimental results and we compare these results with the gsta proposed in borlaug et al 2020 as well as with a pid controller the remainder of this paper is organized as follows in sec 2 the model and the tracking control problem for the aiauv are defined mathematically the control law and observer design for tracking the desired trajectory are presented and analysed in sec 3 for all three algorithms a description of the implemented simulation model and the simulation results are provided in sec 4 in sec 5 the experimental set up and the experimental results are given the conclusions and suggestions for future work are presented in sec 6 2 aiauv model and problem statement in this section we provide the model and the mathematical definition of the tracking control problem for the aiauv fig 1 the aiauv consists of n links connected by n 1 motorized joints each joint is treated as a one dimensional euclidean joint to follow the convention used in the robotics community the first link is referred to as the base of the manipulator the base link is link 1 and the front link where the end effector is positioned is link n a visual representation of the relevant frames is given in fig 2 in the right corner of fig 2 the link frames blue coordinate systems have been visualized for a completely outstretched robot note that link frame 1 corresponds to the base frame the joints are numbered from i 1 to n 1 such that link i and link i 1 are connected by joint i furthermore the aiauv is equipped with m thrusters including one or more thrusters acting along the body of the aiauv to provide forward thrust and tunnel thrusters acting through the links to provide station keeping capability the aiauv is considered to be a floating base manipulator operating in an underwater environment subject to added mass forces dissipative drag forces and gravity and buoyancy forces which allows us to model the aiauv as an underwater vehicle manipulator system uvms with dynamic equations given in matrix form by antonelli 2014 from et al 2014 1 m q ζ c q ζ ζ d q ζ ζ g q r b i τ q where q r n 1 is the vector representing the joint angles ζ r 6 n 1 is the vector of body fixed velocities m q is the inertia matrix including added mass terms c q ζ is the coriolis centripetal matrix d q ζ is the damping matrix and g q r b i is the matrix of gravitational and buoyancy forces the control input is given by the generalized forces τ q 2 τ q t q 0 6 n 1 0 n 1 m i n 1 n 1 τ t h r τ q where t q r 6 m is the thruster configuration matrix τ t h r r m is the vector of thruster forces and τ q r n 1 represents the joint torques to implement the control input τ q a thruster allocation scheme as proposed in sverdrup thygeson et al 2018 needs to be implemented to distribute the desired control inputs onto the m thrusters the vector of body fixed velocities ζ is defined as 3 ζ v t ω t q t t where v and ω are the body fixed linear and angular velocities of the base of the aiauv respectively and q is the vector of joint angle velocities the desired velocities are denoted as 4 ζ d v d t ω d t q d t t in the body fixed frame the velocity errors can then be defined as 5 ζ ζ ζ d where ζ and ζ d are defined as in 3 and 4 respectively to represent the orientation of the aiauv both euler angles and quaternions can be used in this paper we will describe both methods as we use quaternions to describe the dynamics when we create the control laws without the hosmo and euler angles when we create the control laws that use the estimated velocities from the hosmo the reason is that the hosmo does not work with quaternions as a different number of states in position versus velocity then occurs 2 1 model representation using euler angles in this section we will describe the model using euler angles a well known problem when we use euler angles is that the jacobian can become singular at θ π 2 x y z convention however if we stay away from that angle the jacobian is well defined and the inverse of the jacobian matrix can still be used when we use euler angles to describe the aiauv we can use the hosmo from kumari et al 2016 to estimate the velocity such that we do not require velocity measurements the complete state vector specifying the position orientation and shape of the aiauv when euler angles are used is defined as 6 ξ e η 1 t η 2 t q t t r 6 n 1 where η 1 x y z t r 3 is the position of the base and η 2 φ θ ψ t r 3 are the euler angles describing the orientation of the base in the inertial frame the relationship between the body fixed velocities and the complete state vector is given by the differential equation 7 ξ e j e η 2 ζ r b i 0 3 3 0 3 n 1 0 3 3 j k o 1 0 3 n 1 0 n 1 3 0 n 1 3 i n 1 n 1 ζ where 8 r i b η 2 c ψ c θ s ψ c θ s θ s ψ c φ c ψ s θ s φ c ψ c φ s ψ s θ s φ s φ c θ s ψ s φ c ψ s θ c φ c ψ s φ s ψ s θ c φ c φ c θ with c x cos x and s x sin x is the rotation matrix expressing the transformation from the inertial frame to the body fixed frame and 9 j k o η 2 1 0 s θ 0 c φ c θ s φ 0 s φ c θ c φ is the jacobian matrix by defining the desired trajectory as ξ e d η 1 d t η 2 d t q d t t the tracking error vector can be defined as 10 ξ e η 1 η 2 q η 1 η 1 d η 2 η 2 d q q d the goal of the tracking problem is to make the error vector ξ e converge to zero therefore the tracking control objective is to make ξ e ζ 0 0 an asymptotically stable equilibrium point of 1 and 7 which will ensure that the tracking errors will converge to zero 2 2 model representation using quaternions in this section we will describe the model using quaternions when we use quaternions to represent the model we avoid the singularities in the jacobian matrix that arise from the euler angles we therefore obtain the advantage of a well defined jacobian which means that we can use the inverse of the jacobian matrix the complete state vector specifying the position orientation and shape of the aiauv when quaternions are used is defined as 11 ξ q η 1 t p t q t t r 7 n 1 where η 1 x y z t r 3 is the position of the base and p ε t η t ε 1 ε 2 ε 3 η t r 4 is the unit quaternion describing the orientation of the base in the inertial frame the relationship between the body fixed velocities and the complete state vector specifying the position orientation and shape of the aiauv is given by the differential equation 12 ξ q j q p ζ r b i p 0 3 3 0 3 n 1 0 4 3 j k o q p 0 4 n 1 0 n 1 3 0 n 1 3 i n 1 n 1 ζ where r i b is the rotation matrix expressing the transformation from the inertial frame to the body fixed frame and j k o q p 1 2 η i 3 s ε ε t where i 3 is the 3 3 identity matrix and s is the cross product operator defined as in 10 definition2 2 by defining the desired trajectories as 13 ξ q d η 1 d t p d t q d t t where p d ε d t η d t the orientation error which is computed via the composition quaternion product antonelli 2014 is then given by 14 p ε η η ε d η d ε s ε d ε η η d ε t ε d the complete tracking error can then be defined as 15 ξ q η 1 ε q η 1 η 1 d η ε d η d ε s ε d ε q q d remark 1 note that for the orientation the goal is to ensure that p p d which corresponds to p 0 1 3 1 t now since the euler parameters satisfy η 2 ε t ε 1 it is sufficient to make ε 0 because then p 0 1 3 1 t therefore η is not included as an independent state in 15 the goal of the tracking problem is to make the error vector 15 converge to zero therefore the tracking control objective is to make ξ q ζ 0 0 an asymptotically stable equilibrium point of 1 and 12 which will ensure that the tracking error will converge to zero 3 tracking control laws in this section we will present the tracking control laws for the aiauv using three different algorithms the sta with adaptive gains the gsta and a pid controller the control laws based on the gsta obtained in borlaug et al 2020 are briefly presented here for completeness the control structure used when velocity measurements are available is presented in fig 3 and the control structure used when a hosmo is used for state estimation is presented in fig 4 3 1 super twisting algorithm with adaptive gains in this section we will present two tracking control laws for the aiauv based on the sta with adaptive gains one where only the sta with adaptive gains is used and one where the sta with adaptive gains is combined with an hosmo 3 1 1 control law based on the sta with adaptive gains in this section a control law based on the sta with adaptive gains is presented sliding surface for smc to be used a sliding surface needs to be designed the surface should be designed such that when the sliding variable σ goes to zero the state variables asymptotically converge to zero and such that the control input τ q appears in the first derivative of σ define x 1 q ξ q where ξ q is given by 15 and 16 x 2 q r b i p 0 3 3 0 3 n 1 0 3 3 1 2 η i 3 s ε 0 3 n 1 0 n 1 3 0 n 1 3 i n 1 n 1 ζ ζ d t q p ζ where ζ and ζ d are defined in 3 and 4 respectively the sliding surface can then be chosen as 17 σ q x 1 q x 2 q r 6 n 1 if σ q 0 we will now have x 1 q x 2 q 0 since x 2 q x 1 q we can write this as 18 x 1 q x 1 q which will ensure that x 1 q globally exponentially converges to zero now since x 1 q ξ q the state variables ξ q will also globally exponentially converge to zero if σ q 0 to drive the sliding surface to zero we will use the sta with adaptive gains super twisting algorithm with adaptive gains here we present the equations describing the sta with adaptive gains in detail the sta with adaptive gains proposed in shtessel et al 2010 can be written by 19 u sta σ α σ 1 2 sgn σ v ℝ 6 n 1 v β s g n σ where the adaptive gains are defined as 20 α ω 1 γ 1 2 if σ 0 0 if σ 0 and 21 β 2 ε α λ 4 ε 2 where ε r 6 n 1 λ r 6 n 1 γ 1 r 6 n 1 and ω 1 r 6 n 1 are positive constants and σ is the sliding surface note that the mathematical operations in 19 20 and 21 are performed in an element wise manner for implementation purposes a small boundary is placed on the sliding surface such that the adaptive gains can be expressed as 22 α ω 1 γ 1 2 if σ α m 0 if σ α m β 2 ε α λ 4 ε 2 where the design parameter α m is a small positive constant selected empirically this boundary is introduced because numerically σ will never be exactly zero meaning that in practical implementations the second condition of 20 will never be met which would make the adaptive gains increase to infinity the sta with adaptive gains makes σ and σ go to zero in finite time shtessel et al 2010 control input now we want the control input τ q to be selected such that σ q u sta so that σ q and σ q will reach zero in finite time however since we do not know anything about the model we choose our control input to be 23 τ q u sta σ q with σ q defined as in 17 with this choice u sta appears in σ q as desired 3 1 2 control law based on the sta with adaptive gains combined with a higher order sliding mode observer in this section a control law based on the sta with adaptive gains combined with an hosmo will be derived using lyapunov theory we will show that ξ e ζ 0 0 is an asymptotically stable equilibrium point of 1 and 7 with the proposed control law state observer because velocity measurements are not available a state observer has to be designed we want to use the third order sliding mode observer smo presented in kumari et al 2016 as it has been proven to be finite time stable in moreno 2012 to use this third order smo we introduce a change of variables define x 1 e ξ e where ξ e is given by 6 and x 2 e j e η 2 ζ where j e η 2 ζ is given by 7 the dynamics can then be written as 24 x 1 e x 2 e x 2 e d d t j e η 2 j e 1 η 2 x 2 e m 1 q j e η 2 c q j e 1 η 2 x 2 e j e 1 η 2 x 2 e d q j e 1 η 2 x 2 e j e 1 η 2 x 2 e g q r b i τ q assumption 1 we assume that d d t j e η 2 j e 1 η 2 x 2 e is a small bounded disturbance which we will call d t we also define f c q j e 1 η 2 x 2 e j e 1 η 2 x 2 e d q j e 1 η 2 x 2 e j e 1 η 2 x 2 e g q r b i to reduce the space used to write the model the model can then be written as 25 x 1 e x 2 e x 2 e d t m 1 q j e η 2 f τ q by designing the third order smo structure as in kumari et al 2016 the third order smo can be written as 26 x ˆ 1 x ˆ 2 z 1 x ˆ 2 x ˆ 3 z 2 m 1 q j e η 2 τ q x ˆ 3 z 3 where 27 z 1 k 1 e 1 2 3 sgn e 1 z 2 k 2 e 1 1 3 sgn e 1 z 3 k 3 sgn e 1 and k 1 r 6 n 1 k 2 r 6 n 1 and k 3 r 6 n 1 are gains to be chosen according to levant 1998 and levant 2003 where e 1 x 1 e x ˆ 1 r 6 n 1 one choice of parameters that satisfies the requirements in levant 1998 and levant 2003 is according to chalanga et al 2016 k 1 6 l 1 3 k 2 11 l 1 2 and k 3 6 l where l r 6 n 1 is a sufficiently large constant note that the mathematical operations in 26 and 27 are performed in an element wise manner by defining e 2 x 2 e x ˆ 2 and e 3 x ˆ 3 f where f d t m 1 q j e η 2 f the error dynamics of the hosmo can be written as 28 e 1 k 1 e 1 2 3 sgn e 1 e 2 e 2 k 2 e 1 1 3 sgn e 1 e 3 e 3 k 3 sgn e 1 f if f δ then the third order smo errors go to zero in finite time moreno 2012 since f is a combination of d t c q j e 1 η 2 x 2 e j e 1 η 2 x 2 e d q j e 1 η 2 x 2 e j e 1 η 2 x 2 e and g q r b i and since the aiauv is a mechanical system these matrices will not change infinitely fast therefore assuming that f p ζ η 2 is bounded is a valid assumption sliding surface as mentioned previously we have to design a sliding surface to use smc the sliding surface is designed in the same manner as in sec 3 1 1 when the velocity measurement is available we choose the sliding surface to be 29 σ e x 1 e x 2 e r 6 n 1 where x 1 e ξ e with ξ e defined as in 10 and x 2 e j e η 2 ζ j e η 2 d ζ d where j e η 2 ζ is defined in 7 if σ e 0 we will now have x 1 e x 2 e 0 since x 2 e x 1 e we can write this as 30 x 1 e x 1 e which will ensure that x 1 e globally exponentially converges to zero now since x 1 e ξ e the state variables ξ e will also globally exponentially converge to zero if σ e 0 when the velocity measurement is not available the observed state values are used and we can therefore write the sliding surface with the observed values as 31 σ ˆ e x ˆ 1 x ˆ 2 r 6 n 1 where x ˆ 1 x ˆ 1 ξ e d and x ˆ 2 x ˆ 2 j e η 2 d ζ d since the third order smo errors in 28 go to zero in finite time σ ˆ e σ e after some finite time thus if σ ˆ e goes to zero the tracking objective will be satisfied to drive the sliding surface to zero we will use the sta with adaptive gains control input by designing the control input τ q such that σ ˆ e u sta we achieve that σ ˆ e and σ ˆ e reach zero in finite time since the sta is finite time stable taking the time derivative of 31 and substituting x ˆ 1 and x ˆ 2 defined in 26 we find that 32 σ ˆ e x ˆ 1 x ˆ 2 x ˆ 1 x 1 d x ˆ 2 x 2 d x ˆ 2 z 1 x 1 d x ˆ 3 z 2 m q 1 j e η 2 τ q x 2 d by choosing τ q to be 33 τ q j e η 2 1 m q x ˆ 2 z 1 x 1 d x ˆ 3 z 2 x 2 d u sta we obtain 34 σ ˆ e u sta σ ˆ e stability in this section we perform a stability analysis of the closed loop system and show that the tracking error converges asymptotically to zero we consider the closed loop system defined by 1 7 and 33 by using the fact that x ˆ 1 x 1 e e 1 and that x ˆ 2 x 2 e e 2 from sec 3 1 2 31 can be written as 35 σ ˆ e x 1 e e 1 x 1 d x 2 e e 2 x 2 d ξ e e 1 ξ e e 2 through rearranging we obtain that the tracking error dynamics are expressed as 36 ξ e ξ e σ ˆ e e 1 e 2 furthermore the velocity tracking error ζ is represented by the sliding variable σ ˆ e cf 24 and 31 the overall closed loop dynamics with τ q given by 23 is thus given by σ ˆ e given in 34 ξ e given in 36 and the state observer error given in 28 the closed loop dynamics are thus expressed as 37 1 ξ e ξ e σ ˆ e e 1 e 2 σ ˆ e α σ ˆ e 1 2 s g n σ ˆ e v v β sgn σ ˆ e 2 e 1 k 1 e 1 2 3 sgn e 1 e 2 e 2 k 2 e 1 1 3 sgn e 1 e 3 e 3 k 3 sgn e 1 f theorem 1 consider the closed loop system 1 7 and 33 assume that the hosmo in 26 and 27 is used to estimate x 1 e and x 2 e where f δ is assumed and the sliding surface is selected as in 31 then the complete system is represented by the cascaded system in 37 and the origin of the cascaded system is uniformly globally asymptotically stable ugas which ensures the asymptotic convergence of the tracking error proof the proof follows along the lines of the proof of borlaug et al 2019a theorem 1 but for 6dof instead of for 2dof analysis of subsystem 1 with e 1 0 and e 2 0 with e 1 0 and e 2 0 subsystem 1 can be written as 38 1 ξ e ξ e σ ˆ e σ ˆ e α σ ˆ e 1 2 s g n σ ˆ e v v β sta sgn σ ˆ e this can then be divided into two subsystems 39 11 ξ e ξ e σ ˆ e 12 σ ˆ e α σ ˆ e 1 2 s g n σ ˆ e v v β sta sgn σ ˆ e where loría and panteley 2005 lemma 2 1 can be used subsystem σ 11 with σ ˆ e 0 is analysed first which is clearly a globally exponentially stable linear system but since we will need a lyapunov function to analyse this system when σ ˆ e 0 we use the lyapunov function candidate v 11 ξ e 1 2 ξ e 2 for the analysis the derivative of v 11 yields 40 v 11 ξ e ξ e ξ e ξ e ξ e ξ e 2 ξ e 2 this indicates that the lyapunov function satisfies 41 k 1 x a v 11 x k 2 x a v 11 x f 11 t x k 3 x a with k 1 k 2 1 2 k 3 1 and a 2 hence by virtue of khalil 2002 theorem 4 10 the origin for subsystem σ 11 with σ ˆ e 0 is globally exponentially stable subsystem σ 12 has the structure of the sta with adaptive gains in shtessel et al 2010 a lyapunov function is proposed for systems with this structure here it is proven that the lyapunov function proposed is indeed a lyapunov function for subsystem σ 12 and that for any initial conditions σ ˆ e σ ˆ e 0 in finite time by using the sta with adaptive gains given by eq 20 and eq 21 where ε λ γ 1 and ω 1 are arbitrary positive constants the sliding surface σ ˆ e 0 is also proven to be reached in finite time now since the subsystem is gfts and autonomous it is also ugas by polyakov and fridman 2014 proposition 2 and proposition 3 which also implies that σ ˆ e t β 1 t 0 to verify that the solutions of σ 1 are uniformly globally bounded ugb subsystem σ 11 must be analysed with σ ˆ e 0 the derivative of the lyapunov function v 11 is then as follows 42 v 11 ξ e ξ e 2 σ ˆ e ξ e ξ e 2 θ ξ e 2 θ ξ e 2 β 1 ξ e 1 θ ξ e 2 ξ e β 1 θ where 0 θ 1 the solutions are then ugb because the conditions of khalil 2002 theorem 4 18 are satisfied consequently the conditions of loría and panteley 2005 lemma 2 1 are satisfied which implies that the origin of subsystem σ 1 is ugas analysis of subsystem 2 in moreno 2012 a lyapunov function is proposed for a third order observer the lyapunov function is proven to be radially unbounded and positive definite and that it is a lyapunov function for subsystem σ 2 whose trajectories converge in finite time to the origin e 0 for every value of f t as long as f t is bounded since f t is bounded by assumptions the origin is gfts for every value of f t which means that the origin is also ugas by polyakov and fridman 2014 proposition 2 and proposition 3 which in turn implies e t β 2 t 0 analysis of the complete system to analyse the complete system loría and panteley 2005 lemma 2 1 is used to check if the solutions of the complete system are ugb the boundedness of ξ e must be evaluated when e 1 0 and e 2 0 and for this the lyapunov function v 11 is used note that the boundedness of σ ˆ e follows from σ 12 being ugas because σ 12 is not perturbed by σ 2 43 v 11 ξ e ξ e 2 σ ˆ e e 1 e 2 ξ e ξ e 2 θ ξ e 2 θ ξ e 2 β 1 2 β 2 ξ e 1 θ ξ e 2 ξ e β 1 2 β 2 θ where 0 θ 1 the solutions are then ugb because the conditions of khalil 2002 theorem 4 18 are satisfied consequently the conditions of loría and panteley 2005 lemma 2 1 are satisfied which implies that the complete system is ugas 3 2 generalized super twisting algorithm in this section two tracking control laws for the aiauv based on the gsta will be presented one where only the gsta is used and one where the gsta is combined with an hosmo these control laws were derived and proven to achieve the tracking control objective in borlaug et al 2020 but we briefly present them here for completeness 3 2 1 control law based on the gsta in this subsection the tracking control law for the aiauv using the gsta will be presented in borlaug et al 2020 the control input that achieves the tracking control objective was found to be 44 τ q t q 1 p u gsta σ where p is defined as in 14 t q p is defined as in 16 σ is defined as in 17 and u gsta σ is defined as in castillo et al 2018 45 u gsta σ k 1 φ 1 σ z r 6 n 1 z k 2 φ 2 σ where 46 φ 1 σ σ 1 2 β gsta σ φ 2 σ 1 2 σ 0 3 2 β gsta σ 1 2 β gsta 2 σ where a b a b sgn a where b is a constant and k 1 r 6 n 1 k 2 r 6 n 1 and β gsta r 6 n 1 are controller gains note that the mathematical operations in 45 and 46 are performed in an element wise manner the two extra terms in φ 2 σ compared to the sta with adaptive gains in 19 provide one more parameter to adjust when designing the gsta gains k 1 k 2 and β gsta the linear growth term β gsta σ in φ 1 helps to counteract the effects of state dependent perturbations which can exponentially increase in time in borlaug et al 2020 it was proven that the control input 44 makes the closed loop system ugas and that the tracking errors for the complete system converge asymptotically to zero 3 2 2 control law based on the gsta with a higher order sliding mode observer in this subsection the tracking control law for the aiauv using the gsta combined with an hosmo is presented the hosmo that is used is the third order smo presented in sec 3 1 2 in borlaug et al 2020 the control input that achieves the tracking control objective was found to be 47 τ q j e 1 m x ˆ 2 z 1 x 1 d x ˆ 3 z 2 x 2 d u gsta σ where σ is as in 31 and where u gsta σ is defined as in castillo et al 2018 i e 45 in borlaug et al 2020 it was proven that the control input 44 makes the closed loop system ugas and that the tracking errors for the complete system converge asymptotically to zero 3 3 pid controller to benchmark the two smc algorithms we also include a pid controller in the comparison therefore in this section we propose two tracking control laws for the aiauv based on the pid controller one where we assume that the velocity is known and one where we use the estimated velocity from the hosmo 3 3 1 control law based on the pid controller in this subsection the tracking control law for the aiauv using the pid controller is presented the control input when the pid controller is used is defined as 48 τ q k p ξ e k d ζ k i ξ e d t where ξ e is defined as in 10 and ζ ζ ζ d where ζ and ζ d are defined as in 3 and 4 respectively the constants k p k d and k i are controller gains 3 3 2 control law based on the pid controller combined with a higher order sliding mode observer in this subsection the tracking control law for the aiauv using the pid controller with the estimated velocity from the hosmo is presented the control input when the pid controller with the velocity from the third order smo from sec 3 1 2 is used can be found as 49 τ q k p ξ e k d ζ ˆ k i ξ e d t where ξ e is defined as in 10 and ζ ˆ j e η 2 1 x ˆ 2 ζ d where x ˆ 2 and ζ d are defined as in 26 and 4 respectively the constants k p k d and k i are controller gains 4 simulation results in this section we present the implemented simulation model the test cases and the simulation results for trajectory tracking using the control laws presented in sec 3 4 1 implementation the aiauv model is implemented using the method described in schmidt didlaukies et al 2018 in matlab simulink together with the controllers the implemented aiauv is based on the eelume robot fig 1 which is the robot used in the experiments presented in sec 5 the aiauv has n 1 9 cylindrical links with a radius of 0 09 m n 8 revolute joints and m 7 thrusters the link frames are right hand coordinate systems in which the completely outstretched robot is placed such that the x axes point forward and the z axes point upwards in table 1 the properties of each link are presented in the thrusters column 2 z y means that the link has 2 thrusters one imposing a force in the z direction and one imposing a force in the y direction the maximum thrust of each thruster is approximately 50 n joints 1 3 5 and 7 rotate around the z axis and joints 2 4 6 and 8 rotate around the y axis the joint rotation occurs in the link frame of the corresponding link i e joint 1 rotates around the z axis of link 1 to ensure a valid comparison between the simulations and the experiments we use a p controller for the joints the reason for this choice is that the eelume robot has an internal joint controller which is a p controller to create a continuous trajectory we do not use inverse kinematic control as in borlaug et al 2018 and borlaug et al 2019b rather we use a filter to generate a continuous trajectory between setpoints the reason is that the joint controller on the eelume robot we used is not sufficiently precise to satisfy the assumption that q q d which is a prerequisite for the inverse kinematic control to perform properly the thruster allocation matrix is implemented as proposed in sverdrup thygeson et al 2018 for the simulations the ode3 fixed step solver with a step size of 0 002 was used 4 2 simulation cases in this section we describe the different test cases considered in the simulations to validate and compare the control laws presented in sec 3 we created two different test cases to represent the operation mode a mode that is thoroughly explained in sverdrup thygeson et al 2018 in operation mode we perform inspection and intervention tasks therefore accuracy is extremely important the robot that we used during the experiments is unactuated in roll when the aiauv is straight all joint angels are equal to zero and accurate control of rolling when the robot is straight is therefore not possible we therefore found a shape which we call c shape where the robot is actuated in every dof such that we can perform accurate control in every dof we therefore have one test case called c shape which is explained in detail in sec 4 2 1 we also wanted to include a test case where the robustness of the algorithms would be evaluated we therefore wanted to introduce some disturbance in our second test however we do not have access to a tank where we can introduce current we therefore introduce disturbance by using the joints thus the second test case is the c shape with a moving head which is explained in detail in sec 4 2 2 this test captures operation mode where the robot performs an inspection by looking around in a circular motion with its head and the motion also introduces a disturbance the reference trajectories for the position and orientation used for the two test cases are shown in fig 5 the references for x y and ψ are changed at 100 s and at 300 s the references for z and θ are changed the references for x ψ and θ are also changed at 450 s and for x y and z at 600 s the reference value for z is however slightly different from case to case because during the experiments we observed that some of the joints were emerging from the water and creating problems for the measurement system when we started the trajectory at 1 for the c shape with a moving head the reference value for z is therefore as in fig 5 for the c shape i e the reference value starts at 1 and changes to 0 7 whereas for the c shape with a moving head the reference value starts at 0 7 and changes to 0 5 the z reference for the c shape with a moving head when the control law with the hosmo is used is also changed at 100 s i e the reference value starts at 1 changes to 0 7 at 100 s and then changes to 0 5 at 300 s 4 2 1 c shape in the c shape configuration the aiauv is shaped like a c in this shape the aiauv is actuated in every dof since the thrusters are oriented such that the robot can provide thrust in all 6dofs and the c shape is therefore ideal for the operation mode in the c shape the joint angles references are set to q d 45 deg 0 deg 45 deg 0 deg 45 deg 0 deg 45 deg 0 deg t and in fig 6 the configuration of the robot is shown 4 2 2 c shape with a moving head the case of the c shape with a moving head is almost identical to the c shape case but in this case we move the head of the aiauv around specifically joint nr 7 and joint nr 8 are moved such that the camera positioned at joint nr 8 the head is looking around the joint angles together with their reference trajectories for the c shape with a moving head are presented in fig 7 4 3 simulation results in this section the results from the performed simulation test cases are presented to ensure that the comparison between the simulations and experiments is as fair as possible the gains used during the simulations are the gains found during the experiments the gains for the sta with adaptive gains and the hosmo are presented in table 2 for the gsta and the hosmo the gains are presented in table 3 and for the pid controller the gains are presented in table 4 for the smc algorithms the gains for the hosmo l are different from those used during the experiments for the c shape and the c shape with a moving head because we observed chattering in the simulations when we used l 0 01 which was not experienced in the experiments the trajectory tracking results using the control laws from sec 3 1 1 sec 3 2 1 and sec 3 3 1 i e without the hosmo are presented in fig 8 the trajectory tracking results include both the position errors and the orientation errors for both test cases the corresponding thruster forces are shown for the c shape in fig 9 and for the c shape with a moving head in fig 10 in table 5 the root mean square error rmse and maximum error for the position and orientation are given for each control law without the hosmo and for both simulation test cases i e the c shape and the c shape with a moving head in table 6 the root mean square rms for the thruster forces and the derivative of the thruster forces are given for each control law without the hosmo and for both simulation test cases the rms of the thruster forces provides an idea of how much force is used and the rms of the derivative of the thruster forces provides a measure of how much chattering is present in the thruster forces the trajectory tracking results using the control laws from sec 3 1 2 sec 3 2 2 and sec 3 3 2 i e with the hosmo are presented in fig 11 the corresponding thruster forces are shown for the c shape in fig 12 and for the c shape with a moving head in fig 13 in table 7 the rmse and maximum error for the position and orientation are given for each control law with the hosmo and for both simulation test cases in table 8 the rms for the thruster forces and the derivative of the thruster forces are given for each control law with the hosmo and for both simulation test cases in fig 14 and fig 15 the estimation errors for the hosmo are shown for the c shape and the c shape with a moving head respectively the first sub plot shows e 1 x 1 e x ˆ 1 and the second sub plot shows e 2 x 2 e x ˆ 2 note that if higher gains had been used in the simulations the results would have improved at least for the gsta 4 4 discussion as shown in fig 8 the aiauv follows the given position and orientation very well for both test cases as all errors are usually below 0 5 2 cm in position and 1 3 deg in orientation when the control laws from sec 3 1 1 sec 3 2 1 and sec 3 3 1 i e without the hosmo are used this result indicates that all the control laws are applicable as shown in figs 8a and 8b in the c shape case the sta with adaptive gains provides the lowest error and therefore the best result overall and the gsta provides the second best results the reason why the sta with adaptive gains provides better results than the gsta is likely because it adaptively finds the best gains whereas the gsta must be tuned manually however if we more closely examine some of the results for φ and θ we do find that for φ the gsta provides the lowest error and for θ gsta and pid provide a slightly lower error than the sta with adaptive gains from figs 8c and 8d we observe the same tendencies for the c shape with a moving head as for the c shape case i e in x y z and ψ the sta with adaptive gains provides the smallest error and the gsta is the second best however for φ and θ the errors are much more similar examining table 5 confirms what we can observe from fig 8 i e that the sta with adaptive gains provides the smallest position errors with an rmse value of 0 0008 m for the c shape and 0 0019 m for the c shape with a moving head and that the gsta is the second best with an rmse value of 0 0054 m for the c shape and 0 0068 m for the c shape with a moving head while the pid controller gives the largest position errors with an rmse value of 0 0087 m for the c shape and 0 0115 m for the c shape with a moving head for the orientation errors however the gsta gives an rmse value of 0 0114 rad for the c shape and 0 0193 rad for the c shape with a moving head while the sta with adaptive gains gives an rmse value of 0 0116 rad for the c shape and 0 0228 rad for the c shape with moving head so the results are much more similar and the gsta actually provides slightly better results the pid controller clearly offers the worst tracking performance for orientation with an rmse value of 0 0154 rad for the c shape and 0 0249 rad for the c shape with a moving head we see the same results for the maximum error value if we take the thruster use of the different algorithms into consideration presented in figs 9 and 10 we find that for both test cases the sta with adaptive gains uses more force than the gsta and the pid controller while the gsta and the pid use very similar amounts of force however the rms of τ t h r in table 6 shows that over time the amount of force used is not actually very different the sta with adaptive gains uses slightly more force in the c shape case with an rms value of 2 16 while the gsta and the pid controller uses a very similar amount of force with rms values of 1 84 and 1 80 respectively for the case of the c shape with a moving head however all the algorithms use a very similar amount of force with rms values between 1 87 1 91 from the rms values of τ t h r we find that the most chattering occurs in the control input from the sta with adaptive gains with rms value of 5 32 for the c shape and 2 19 for the c shape with a moving head and that less chattering occurs in that from the gsta with rms value of 5 05 for the c shape and 0 31 for the c shape with a moving head while the control input from the pid controller shows the least rapid changes in the thrust forces with rms value of 0 74 for the c shape and 0 67 for the c shape with a moving head however the value of the rms of τ t h r is so small that the chattering that is introduced by the sta with adaptive gains is negligible from figs 14 and 15 we can see that the estimation errors for the hosmo are quite small the hosmo is therefore applicable for state estimation when the control laws with the hosmo are used i e the control laws from sec 3 1 2 sec 3 2 2 and sec 3 3 2 we observe the same tendencies in fig 11 as when the control laws without the hosmo are used as shown in figs 11a and 11b the sta with adaptive gains provides the smallest errors for x y z and ψ and the gsta yields the second smallest errors for φ however the gsta provides the smallest error while the sta with adaptive gains results in oscillations for θ the results are more similar between the sta with adaptive gains and the gsta while the pid controller gives rise to a larger error as shown in figs 11c and 11d the results for the c shape with a moving head are the same as those for the c shape case except that the results for φ and θ are now more similar examining table 7 confirms what we can observe from fig 11 i e that the sta with adaptive gains provides the best results for position with an rmse value of 0 0009 m for the c shape and 0 0032 m for the c shape with a moving head and that the gsta is the second best with an rmse value of 0 0059 m for the c shape and 0 0075 m for the c shape with a moving head while the pid controller gives the largest position errors with an rmse value of 0 0083 m for the c shape and 0 0112 m for the c shape with a moving head for the orientation errors however the gsta gives an rmse value of 0 0072 rad for the c shape and 0 0125 rad for the c shape with a moving head while the sta with adaptive gains gives an rmse value of 0 0078 rad for the c shape and 0 0198 rad for the c shape with moving head so the results are much more similar and the gsta actually provides slightly better results the pid controller clearly offers the worst tracking performance for orientation with an rmse value of 0 0147 rad for the c shape and 0 0245 rad for the c shape with a moving head we see the same results for the maximum error value if we take the thruster use of the different algorithms into consideration presented in figs 12 and 13 we find that the sta with adaptive gains also uses more force for both test cases whereas the gsta and the pid controller use quite similar amounts of force over time however as seen in table 8 from the rms value of τ t h r the amount of force used is not actually very different the sta with adaptive gains uses slightly more force in the c shape case with an rms value of 2 25 while the gsta uses the second most amount of force with an rms value of 2 11 while the pid controller uses the least amount of force with an rms value of 1 82 for the c shape with a moving head however the gsta actually uses the most amount of force with an rms value of 2 22 and the sta with adaptive gains uses the second most amount of force with an rms value of 2 05 the pid controller does however also for the c shape with a moving head case use the least amount of force with an rms value of 1 89 from the rms values of τ t h r we find that the most chattering occurs in the control input from the sta with adaptive gains with rms value of 15 78 for the c shape and 9 48 for the c shape with a moving head and that less chattering occurs in that from the gsta with rms value of 10 99 for the c shape and 7 90 for the c shape with a moving head while the control input from the pid controller shows the least rapid changes in the thrust forces with rms value of 1 43 for the c shape and 1 37 for the c shape with a moving head however the value of the rms of τ t h r is so small that the chattering that is introduced by the sta with adaptive gains is negligible if we compare the results obtained with the control laws from sec 3 1 1 sec 3 2 1 and sec 3 3 1 i e without the hosmo and the results obtained with the control laws from sec 3 1 2 sec 3 2 2 and sec 3 3 2 i e when the hosmo is used by comparing table 5 with table 7 table 6 and table 8 we find that when the hosmo is used we obtain better tracking results for the orientation for all the algorithms as well as better tracking for position when the pid controller is used additionally note that the difference between the position errors i e with and without the hosmo is smaller than the difference between the orientation errors i e the control laws with the hosmo provide the best performance overall the reason for the better tracking performance is likely due to the increase in thruster use the thruster use is however well within the boundaries of what the eelume aiauv can provide which is 50 n to conclude we find that we obtain the best tracking performance in position by using the sta with adaptive gains and the gsta provides the best tracking performance in orientation if we simultaneously consider the errors for position and orientation we find that the sta with adaptive gains provides the best tracking performance but a large difference does not occur between the sta with adaptive gains and the gsta the reason for this difference is likely that we have to tune the gsta manually whereas the method with adaptive gains adaptively finds the best gains and thus has an advantage if we use the hosmo to estimate the linear and angular velocities in the control laws we improve our results 5 experimental investigation this section describes the eelume robot used during the experiments the experimental set up and the obtained results 5 1 the eelume robot the aiauv robot eely which was used during the experiments was the first aiauv created by the eelume company and the aiauv is described in detail in liljebäck and mills 2017 which is the aiauv on which the implemented simulation model is based the eelume aiauv has internal joint controllers which are p controllers therefore during the experiments we could only provide a desired joint reference q d to the aiauv we thus also used a p controller in the simulations as explained in sec 4 1 for the fairest possible comparison between the simulations and experiments 5 2 experimental set up we performed the experiments at the mc lab at ntnu trondheim norway marine cybernetics labora 2018 the tank located in the mc lab has the following dimensions length of 40 m height of 1 5 m and width of 6 45 m the underwater motion capture system from qualisys qualisys motion capture s 2018 is installed in the basin to provide us with real time measurements of the position and orientation of the base of the aiauv the qualisys system has six identical cameras allowing us to track reflective markers attached to the base of the aiauv underwater as shown in fig 16 the cameras allow us to track the reflective markers inside a working area with dimensions of 10 m 1 35 m 5 45 m the system structure used during the experiments is illustrated in fig 17 the six cameras indicated by blue boxes in fig 17 tracked reflective markers in the working area indicated by the red box in fig 17 the qualisys system or camera positioning system sent the measured position and orientation from an external computer to which the qualisys system was connected through the user datagram protocol udp to labview 2016 labview was then connected to the aiauv through an optical fibre cable and through udp to another computer running matlab simulink with the dynamic controller thruster allocation which was implemented as in sverdrup thygeson et al 2018 and the reference generator the computer running matlab simulink received the measured position and orientation and if the control laws without the hosmo were used also an estimate of the linear and angular velocities which were estimated by using a simple kalman filter when the control laws with the hosmo were used the linear and angular velocities were estimated by the hosmo in the dynamic controller the computer running matlab simulink then sent the thrust commands and the desired joint angles back to labview through udp these were then passed through to the aiauv through the optical fibre cable the trajectories for the position and orientation of the base of the aiauv and the joints were generated by setting setpoints and then using a filter to create a continuous trajectory between them 5 3 test cases the test cases considered during the experiments are the test cases that were explained in sec 4 2 and reproduced in the simulations i e the c shape and the c shape with a moving head 5 4 experimental results in this section the results from the experiments are presented all three algorithms i e the sta with adaptive gains the gsta and the pid controller were easy to apply successfully in the experiments and none of them required much effort in tuning in the experiments we increased the gains until we observed that the aiauv started to oscillate around the reference instead of following it the gains that we chose therefore create a small deviation from the reference rather than oscillations around the reference if we would have chosen more aggressive higher gains the aiauv would have oscillated these oscillations might be caused by delays in the thrusters for all the algorithms we attempted to use the same gains for both test cases i e we attempted to find the best possible gains for the c shape and then we used the same for the c shape with a moving head for a fair comparison for the sta with adaptive gains the choice of gains is not very important because the gains will adapt to their best possible values by themselves we did however observe that if we chose the initial adaptive gains to be too high the eelume aiauv started to oscillate we therefore had to use lower gains when the hosmo was used in the case of the c shape with a moving head likely because when the hosmo was used the thruster forces increased the gains for the sta with adaptive gains and the hosmo are presented in table 2 for the gsta and the hosmo the gains are presented in table 3 and for the pid controller the gains are listed in table 4 note that for the smc algorithms the hosmo gain l was chosen as l 0 01 in the experiments the trajectory tracking results using the control laws from sec 3 1 1 sec 3 2 1 and sec 3 3 1 i e without the hosmo are presented in fig 18 the trajectory tracking results include both the position errors and the orientation errors for both test cases the corresponding thruster forces are shown for the c shape in fig 19 and for the c shape with a moving head in fig 20 note that the thruster forces shown are the output from the control scheme i e the desired thruster forces since we are not able to measure the actual force of the thrusters or the thruster speed in table 9 the rmse and maximum error for the position and orientation are given for each control law without the hosmo and for both test cases in table 10 the rms for the thruster forces and the derivative of the thruster forces are given for each control law without the hosmo and for both test cases the trajectory tracking results using the control laws from sec 3 1 2 sec 3 2 2 and sec 3 3 2 i e with the hosmo are presented in fig 21 the corresponding thruster forces are shown for the c shape in fig 22 and for the c shape with a moving head in fig 23 in table 11 the rmse and maximum error for the position and orientation are given for each control law with the hosmo and for both test cases in table 12 the rms for the thruster forces and the derivative of the thruster forces are given for each control law with the hosmo and for both test cases note that the simulation study indicates that if higher gains could have been used without causing oscillations then the tracking accuracy would have been improved 5 5 discussion as shown in fig 18 the aiauv follows the given position and orientation very well for both test cases as all errors are usually below 1 4 cm in position and 2 5 deg in orientation when the control laws from sec 3 1 1 sec 3 2 1 and sec 3 3 1 i e without the hosmo are used as shown in fig 18a in the c shape case the sta with adaptive gains provides the best results for the position the gsta and pid controller have much more similar results for the position as the gsta has almost as large position errors as the pid controller however we do observe that the position errors for the pid controller oscillate more than the position errors for the gsta as shown in fig 18b for the orientation the results are more similar for all algorithms from figs 18c and 18d the same tendencies are observed for the c shape with a moving head as for the c shape case i e for the position the sta with adaptive gains achieves the smallest error whereas for the orientation the tracking performance is more similar examining table 9 confirms what we find from fig 18 i e that the sta with adaptive gains achieves the smallest position errors with an rmse value of 0 0054 m for the c shape and 0 0121 m for the c shape with a moving head and that the gsta is the second best with an rmse value of 0 0133 m for the c shape and 0 0327 m for the c shape with a moving head while the pid controller gives the largest position errors with an rmse value of 0 0158 m for the c shape and 0 0392 m for the c shape with a moving head for the orientation errors however the gsta gives an rmse value of 0 0210 rad for the c shape and 0 0216 rad for the c shape with a moving head while the sta with adaptive gains gives an rmse value of 0 0163 rad for the c shape and 0 0255 rad for the c shape with moving head so the sta with adaptive gains gives the best results for the c shape and the gsta gives the best results for the c shape with a moving head the pid controller actually also gives better results than the gsta for the c shape case with an rmse value of 0 0194 rad while for the c shape with a moving head the pid controller gives the worst tracking performance in orientation with an rmse value of 0 0362 rad we see the same results for the maximum error value the reason why the sta with adaptive gains outperforms the two other algorithms is likely because it has adaptive gains and is therefore robust against tuning if we take the thruster use of the different algorithms into consideration by looking at figs 19 and 20 we find that for both test cases the sta with adaptive gains uses more force than the gsta and the pid controller and that the gsta uses more force than the pid controller however based on the rms value of τ t h r table 10 shows that over time the amount of force used is not actually very different in the c shape case the sta with adaptive gains uses slightly more force with an rms value of 1 94 than the gsta that has an rms value 1 82 and the gsta uses more force than the pid controller that has an rms value of 1 44 in the case of the c shape with a moving head however the gsta and the pid controller uses very similar amounts of force with rms values of 2 18 and 2 14 respectively while the sta with adaptive gains uses more with an rms value of 2 76 from the rms values of τ t h r we find that the most chattering occurs in the control input from the sta with adaptive gains with rms value of 2 95 for the c shape and 7 24 for the c shape with a moving head and that less chattering occurs in that from the gsta with rms value of 1 46 for the c shape and 1 95 for the c shape with a moving head while the control input from the pid controller shows the least rapid changes in the thrust forces with rms value of 0 75 for the c shape and 0 93 for the c shape with a moving head however the value of the rms of τ t h r is so small that the chattering that is introduced by the sta with adaptive gains is almost negligible the reason why the chattering may appear to be considerable in the plots is because of the time scale used when the control laws with the hosmo are used i e from sec 3 1 2 sec 3 2 2 and sec 3 3 2 we observe the same tendencies in fig 21 as when the control laws without the hosmo are used but we find from figs 21a and 21b and from figs 21c and 21d that the sta with adaptive gains is no longer clearly better we also observe that we have some more measurement noise and outliers in the measurements from the measurement system see for instance the jumps in figs 21a and fig 21b between 200 s and 300 s the performance of the algorithm indicates that the algorithms are robust against this noise and the outliers as shown in table 11 we have the same results as those when the hosmo is not used i e the sta with adaptive gains provides the smallest position errors with an rmse value of 0 0064 m for the c shape and 0 0177 m for the c shape with a moving head and that the gsta is the second best with an rmse value of 0 0100 m for the c shape and 0 0252 m for the c shape with a moving head while the pid controller gives the largest position errors with an rmse value of 0 0143 m for the c shape and 0 0394 m for the c shape with a moving head for the orientation errors however the gsta gives an rmse value of 0 0062 rad for the c shape and 0 0147 rad for the c shape with a moving head while the sta with adaptive gains gives an rmse value of 0 0087 rad for the c shape and 0 0215 rad for the c shape with moving head so the results are much more similar and the gsta provides slightly better results the pid controller clearly offers the worst tracking performance for orientation with an rmse value of 0 0181 rad for the c shape and 0 0431 rad for the c shape with a moving head from the maximum errors in table 11 we can see that the measurement noise impacts the maximum error results since if we would have filtered the position measurements such that the peaks outliers in the measurements were removed we would have obtained a lower maximum error for all algorithms particularly the sta with adaptive gains and the gsta as some large peak outliers exist in those measurements if we take the thruster use of the different algorithms into consideration presented in figs 22 and 23 we find that the sta with adaptive gains uses more force for both test cases and that the gsta uses more force than the pid controller in the c shape case whereas in the case of the c shape with a moving head the pid controller and the gsta use almost the same amount of force however as shown in table 12 the rms of τ t h r indicates that the sta does use more force with an rms value of 3 02 for the c shape and 3 34 for the c shape with a moving head than the gsta with an rms value of 1 85 for the c shape and 2 23 for the c shape with a moving head and the pid controller with an rms value of 1 71 for the c shape and 2 09 for the c shape with a moving head the gsta and the pid controller does however use a very similar amount of force from the rms values of τ t h r we find that the most chattering occurs in the control input from the sta with adaptive gains with rms value of 17 49 for the c shape and 13 51 for the c shape with a moving head and that less chattering occurs in that from the gsta with rms value of 4 77 for the c shape and 5 05 for the c shape with a moving head while the control input from the pid controller shows the least rapid changes in the thrust forces with rms value of 4 27 for the c shape and 4 64 for the c shape with a moving head however the value of the rms of τ t h r is so small that the chattering that is introduced by the sta with adaptive gains is negligible the reason why considerable chattering may be evident in the plots is again because of the time scale used if we compare the results obtained with the control laws from sec 3 1 1 sec 3 2 1 and sec 3 3 1 i e without the hosmo and the results obtained with the control laws from sec 3 1 2 sec 3 2 2 and sec 3 3 2 i e when the hosmo is used by comparing table 9 with table 11 table 10 and table 12 we find that when the hosmo is used we obtain better tracking results for the orientation for all the algorithms as well as better tracking for position when the gsta is used additionally note that the difference between the position errors i e with and without the hosmo is smaller than the difference between the orientation errors i e the control laws with the hosmo provide the overall best performance the reason for the better tracking performance is likely due to the increase in thruster use the thruster use is however well within the boundaries of what the eelume aiauv can provide which is 50 n if we compare the simulation results figs 8 and 11 and the experimental results figs 18 and 21 for both test cases we find that the results are quite similar and that all algorithms are applicable with and without the hosmo to control the aiauv we also find that the same algorithms provide the best tracking results in the simulations and the experiments i e the sta with adaptive gains and the gsta in a good second place we also observed an improvement in the tracking performance for all algorithms when the hosmo was used in both simulations and experiments of course the tracking errors i e the position and orientation errors are larger in the experiments than in the simulations but that is to be expected because of measurement noise and outliers from the measurements system thruster dynamics and other unmodelled dynamics the fact that we did not have feedback from the thrusters likely also affected the errors because we did not necessarily obtain the desired forces from the thrusters 6 conclusions and future research in this paper we have presented and compared three different algorithms for solving the trajectory tracking problem for aiauvs in 6dof the sta with adaptive gains the gsta and a pid controller comprehensive simulation and experimental results for two different test cases have been presented and used to compare the performance of the three mentioned algorithms in both the simulations and in the experiments the sta with adaptive gains provided the best overall tracking performance but the gsta was not far from achieving the same tracking results thus the fact that we had to tune the gsta manually is likely the reason that we achieved lower tracking performance with this algorithm the sta with adaptive gains is therefore better in practice than the gsta but the gsta is proved to provide global finite time stability for a larger class of systems furthermore we have also solved the 6dof trajectory tracking problem using the three mentioned algorithms in combination with an hosmo additionally we have proven that the closed loop system when the sta with adaptive gains is used in combination with a hosmo is ugas the same two test cases were used to obtain comprehensive simulation and experimental results for the three algorithms in combination with the hosmo the results have been used to compare the control laws and to study the performance of the hosmo when the hosmo was used to estimate the linear and angular velocities in the control laws we improved our results indicating that the hosmo is indeed applicable for state estimation future work includes proving when assumption 24 holds moreover identifying and including an hosmo that works with quaternions is future work as well as to determine whether adaptive gains can be used with the gsta we could then realize both the theoretical advantages afforded by the gsta and the practical advantages afforded by having adaptive gains credit authorship contribution statement ida louise g borlaug conceptualization methodology software validation formal analysis investigation data curation writing original draft visualization kristin y pettersen funding acquisition supervision writing review editing jan tommy gravdahl supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was partly supported by the research council of norway through the centres of excellence funding scheme project no 223254 ntnu amos and project no 304667 
21042,an articulated intervention autonomous underwater vehicle aiauv is a slender multi articulated underwater robot accurate trajectory tracking is essential for aiauv operations furthermore due to hydrodynamic and hydrostatic parameter uncertainties uncertain thruster characteristics unknown disturbances and unmodelled dynamic effects robustness is crucial in this paper we present a super twisting algorithm sta with adaptive gains and a generalized super twisting algorithm gsta for trajectory tracking of the position and orientation of aiauvs a higher order sliding mode observer hosmo for estimating the linear and angular velocities when velocity measurements are unavailable is also presented the tracking errors for the resulting system are proven to converge asymptotically to zero finally we demonstrate the applicability of the presented control laws with comprehensive simulation and experimental results and perform a comparison study with two tests c shape and c shape with a moving head between the two algorithms and also a benchmark pid controller the sta with adaptive gains exhibits the best overall tracking performance with average position root mean square error rmse 0 0121 m and average orientation rmse 0 0335 rad the gsta also presented good results with average position rmse 0 0267 m and average orientation rmse 0 0292 rad the pid controller gave average position rmse 0 0371 m and average orientation rmse 0 0491 rad keywords experimental results sliding mode control autonomous underwater vehicle robotics control application 1 introduction an articulated intervention autonomous underwater vehicle aiauv is an underwater swimming manipulator it has the slender multi articulated body of an underwater snake robot usr which imparts the aiauv with accessibility and flexibility but it also has multiple thrusters along its body the thrusters enable the aiauv to move forward without using an undulating gait pattern and provides it with the ability to hover this property is especially important for station keeping and trajectory tracking in narrow and confined spaces these capabilities enable the aiauv to operate as a floating base manipulator moreover the aiauv has adopted the flexibility and high kinematic redundancy of the usr and the energy efficient shape and tether less operation of autonomous underwater vehicles auvs compared to standard survey auvs the aiauv has the advantage that it has full actuation and it can perform intervention tasks since it can use its slender body to access narrow spaces use its thrusters to keep itself stationary and then use its joints to perform intervention tasks the aiauv can exploit the full potential of the inherent kinematic redundancy which has been addressed in detail in sverdrup thygeson et al 2016 sverdrup thygeson et al 2018 the controller design for underwater vehicles uvs such as aiauvs auvs usrs and remotely operated vehicles rovs is a complex problem antonelli 2014 underwater vehicles are often subject to hydrodynamic and hydrostatic parameter uncertainties uncertain thruster characteristics unknown disturbances and unmodelled dynamic effects however the control design for the aiauv is more complex than for the other mentioned uvs and control methods used for these type of vehicles can therefore not be directly applied specifically the aiauv has the same mechanical structure as a usr while also possessing hovering and intervention capabilities because of the thrusters path following and manoeuvring control of usrs are discussed in kelasidi et al 2014 2017a kohl et al 2016a 2016b 2017a 2017b however these method are not suitable for utilizing the aiauv s hovering and intervention capabilities the auv is a single body uv and some methods for control design have been proposed in fossen 2011 while the aiauv is a floating base manipulator arm we therefore face the additional challenge of handling the interaction forces also referred to as coupling forces between the arm and the vehicle several different control approaches that address these challenges are summarized and presented in antonelli 2014 however antonelli 2014 considers mostly rovs rovs also face these challenges but for the aiauv the motion of the joints has a more significant effect on the overall motion of the aiauv than for rovs this is because the aiauv has no separate vehicle base and a low mass compared to an rov while rovs have a separate base with a larger inertia than that of the manipulator arm furthermore inertia drag forces and restoring forces and moments caused by the joint motion have a significant effect on the overall motion of the whole mechanism for which any joint motion leads to a corresponding change in the direction of the thrusters that are distributed along the robot all this increases the complexity of the motion for the aiauv thereby rendering the control problem even more complex than for rovs for the aiauv in particular some methods for propulsion have been proposed in kelasidi et al 2016 kelasidi et al 2017b and energy efficient methods for long distance travel have been proposed in wrzos kaminska et al 2019 in sverdrup thygeson et al 2016 2018 a control framework for aiauvs that uses inverse kinematic ik control together with a dynamic controller is proposed however in both papers ik is the main focus the dynamic controller proposed in sverdrup thygeson et al 2016 is only a simple p controller and the controller proposed in sverdrup thygeson et al 2018 is a feedback linearisation controller combined with a velocity based proportional integral derivative pid controller moreover none of these methods focus on robust control which is essential for the aiauv due to large coupling forces unknown disturbances and other unmodelled dynamic effects that affect the aiauv sliding mode control smc is a robust and versatile non linear control approach that is particularly well suited for situations where unknown non linearities affect the system as in the case of aiauvs in this paper we therefore investigate using smc to obtain a robust trajectory tracking controller in recent years several results have been reported regarding the use of smc for many complex dynamic systems for uvs in general some relevant contributions are the following in antonelli and chiaverini 1998 an smc approach for the regulation problem of an underwater vehicle manipulator system is developed this control law is inspired by fjellstad and fossen 1994 and avoids the inversion of the system jacobian and is therefore singularity free in fossen 1991 and fossen and sagatun 1991 an smc is used to address input uncertainty due to partly known non linear thruster characteristics in soylu et al 2008 a chattering free smc is proposed for trajectory control the chattering free approach is developed by combining the smc with adaptive proportional integral derivative controller gains and having an adaptive update of the upper bound on the disturbance and parameter uncertainties in dannigan and russell 1998 an smc is used to address the coupling effects between a manipulator and an uv by combining a virtual velocity control and smc a hybrid control strategy is developed in zhu and sun 2013 for the trajectory tracking of an unmanned uv in xu et al 2015 the trajectory tracking problem of an under actuated unmanned uv is studied by combining backstepping and smc an attitude controller for an auv is designed in cui et al 2016 by using a sliding mode based adaptive controller in liu et al 2017 the trajectory tracking problem for an uv subject to unknown system uncertainties and time varying external disturbances is considered and is solved by using a non linear disturbance observer based backstepping finite time smc scheme in von ellenrieder and henninger 2019 a third order sliding mode disturbance observer coupled with a modified super twisting controller is proposed for the trajectory tracking of fully actuated marine vehicles in the presence of unknown time varying disturbances however as mentioned in the previous section the control design for the aiauv is more complex than for the other mentioned uvs and control methods used for these type of vehicles can therefore not be directly applied in recent years smc has been further developed into higher order smc schemes which removes the chattering problem the super twisting algorithm sta with adaptive gains proposed by shtessel et al 2010 is the most powerful second order continuous smc algorithm as it attenuates chattering and does not require the consideration of any conservative upper bound on the disturbance to maintain sliding because of the adaptive gains motivated by this borlaug et al 2019a applied the sta together with a higher order sliding mode observer hosmo kumari et al 2016 to an aiauv the tracking problem of the centre of mass of the aiauv in 2dof was considered the tracking errors were proven to converge asymptomatically to zero and the simulation results demonstrated that the proposed control method provided excellent tracking capabilities however the tracking control problem was restricted to considering the position of the aiauv in 2dof and the movements of the joints were considered to be a disturbance we therefore extended these results in borlaug et al 2018 by considering the aiauv in 6dof and examining the tracking problem for the position orientation and joint angles equally good results were obtained in 6dof as in 2dof both in theory and in simulations in borlaug et al 2019a and borlaug et al 2018 an hosmo had to be used because velocity measurements were unavailable in borlaug et al 2019b we proposed using the generalized super twisting algorithm gsta proposed in castillo et al 2018 for trajectory tracking of an aiauv in 6dof in borlaug et al 2020 we extended the results obtained in borlaug et al 2019b to include results with and without an hosmo for trajectory tracking of an aiauv in 6dof the gsta is an extension of the sta that provides finite time convergence in the presence of time and state dependent perturbations which is essential for robust control of the aiauv these properties provide the gsta with additional theoretical advantages over the sta with adaptive gains these theoretical advantages enable verification that the tracking errors converge asymptotically to zero when the gsta is used without an hosmo which is not possible for the sta with adaptive gains in this paper we investigate the use of the sta with adaptive gains compared to the use of the gsta specifically we use both the sta with adaptive gains and the gsta for the trajectory tracking of the position and orientation of the base of an aiauv in 6dof we also solve the tracking problem using a pid controller to evaluate how the smc algorithms perform compared to a linear controller an hosmo for estimating the linear and angular velocities when velocity measurements are unavailable is also presented furthermore the tracking errors for the control law using the sta with adaptive gains in combination with the hosmo are proven to converge asymptotically to zero finally we demonstrate the applicability of the proposed control laws with comprehensive simulation and experimental results and we compare the results the main objective of this paper is a comparison between the sta with adaptive gains the gsta and a pid controller in addition the paper extends the results obtained in borlaug et al 2019a from 2dof to 6dof in borlaug et al 2019a the tracking problem of the centre of mass of the aiauv in 2dof was considered and solved using the sta with adaptive gains in combination with an hosmo and the tracking errors were proven to converge asymptotically to zero preliminary results were presented in borlaug et al 2018 in this paper these results are extended by also solving the tracking control problem using the sta with adaptive gains without an hosmo we also include extensive simulation and experimental results not presented in borlaug et al 2018 using the sta with adaptive gains in borlaug et al 2019b the tracking control problem is considered and solved using the gsta without an hosmo in borlaug et al 2020 the tracking control problem is considered and solved using the gsta with and without an hosmo and simulation and experimental results are given the simulation and experimental results given in borlaug et al 2020 are included in this paper to perform a comparison study between the sta with adaptive gains proposed here with the gsta proposed in borlaug et al 2020 the two algorithms are further compared with a benchmark pid controller the contributions of this paper can be summarized as follows the trajectory tracking control problem of an aiauv in 6dof is solved using the sta with adaptive gains the trajectory tracking control problem is also solved by using the algorithm in combination with an hosmo additionally the tracking errors for the control law using the sta with adaptive gains in combination with the hosmo are proven to converge asymptotically to zero we demonstrate the applicability of the presented control laws with comprehensive simulation and experimental results and we compare these results with the gsta proposed in borlaug et al 2020 as well as with a pid controller the remainder of this paper is organized as follows in sec 2 the model and the tracking control problem for the aiauv are defined mathematically the control law and observer design for tracking the desired trajectory are presented and analysed in sec 3 for all three algorithms a description of the implemented simulation model and the simulation results are provided in sec 4 in sec 5 the experimental set up and the experimental results are given the conclusions and suggestions for future work are presented in sec 6 2 aiauv model and problem statement in this section we provide the model and the mathematical definition of the tracking control problem for the aiauv fig 1 the aiauv consists of n links connected by n 1 motorized joints each joint is treated as a one dimensional euclidean joint to follow the convention used in the robotics community the first link is referred to as the base of the manipulator the base link is link 1 and the front link where the end effector is positioned is link n a visual representation of the relevant frames is given in fig 2 in the right corner of fig 2 the link frames blue coordinate systems have been visualized for a completely outstretched robot note that link frame 1 corresponds to the base frame the joints are numbered from i 1 to n 1 such that link i and link i 1 are connected by joint i furthermore the aiauv is equipped with m thrusters including one or more thrusters acting along the body of the aiauv to provide forward thrust and tunnel thrusters acting through the links to provide station keeping capability the aiauv is considered to be a floating base manipulator operating in an underwater environment subject to added mass forces dissipative drag forces and gravity and buoyancy forces which allows us to model the aiauv as an underwater vehicle manipulator system uvms with dynamic equations given in matrix form by antonelli 2014 from et al 2014 1 m q ζ c q ζ ζ d q ζ ζ g q r b i τ q where q r n 1 is the vector representing the joint angles ζ r 6 n 1 is the vector of body fixed velocities m q is the inertia matrix including added mass terms c q ζ is the coriolis centripetal matrix d q ζ is the damping matrix and g q r b i is the matrix of gravitational and buoyancy forces the control input is given by the generalized forces τ q 2 τ q t q 0 6 n 1 0 n 1 m i n 1 n 1 τ t h r τ q where t q r 6 m is the thruster configuration matrix τ t h r r m is the vector of thruster forces and τ q r n 1 represents the joint torques to implement the control input τ q a thruster allocation scheme as proposed in sverdrup thygeson et al 2018 needs to be implemented to distribute the desired control inputs onto the m thrusters the vector of body fixed velocities ζ is defined as 3 ζ v t ω t q t t where v and ω are the body fixed linear and angular velocities of the base of the aiauv respectively and q is the vector of joint angle velocities the desired velocities are denoted as 4 ζ d v d t ω d t q d t t in the body fixed frame the velocity errors can then be defined as 5 ζ ζ ζ d where ζ and ζ d are defined as in 3 and 4 respectively to represent the orientation of the aiauv both euler angles and quaternions can be used in this paper we will describe both methods as we use quaternions to describe the dynamics when we create the control laws without the hosmo and euler angles when we create the control laws that use the estimated velocities from the hosmo the reason is that the hosmo does not work with quaternions as a different number of states in position versus velocity then occurs 2 1 model representation using euler angles in this section we will describe the model using euler angles a well known problem when we use euler angles is that the jacobian can become singular at θ π 2 x y z convention however if we stay away from that angle the jacobian is well defined and the inverse of the jacobian matrix can still be used when we use euler angles to describe the aiauv we can use the hosmo from kumari et al 2016 to estimate the velocity such that we do not require velocity measurements the complete state vector specifying the position orientation and shape of the aiauv when euler angles are used is defined as 6 ξ e η 1 t η 2 t q t t r 6 n 1 where η 1 x y z t r 3 is the position of the base and η 2 φ θ ψ t r 3 are the euler angles describing the orientation of the base in the inertial frame the relationship between the body fixed velocities and the complete state vector is given by the differential equation 7 ξ e j e η 2 ζ r b i 0 3 3 0 3 n 1 0 3 3 j k o 1 0 3 n 1 0 n 1 3 0 n 1 3 i n 1 n 1 ζ where 8 r i b η 2 c ψ c θ s ψ c θ s θ s ψ c φ c ψ s θ s φ c ψ c φ s ψ s θ s φ s φ c θ s ψ s φ c ψ s θ c φ c ψ s φ s ψ s θ c φ c φ c θ with c x cos x and s x sin x is the rotation matrix expressing the transformation from the inertial frame to the body fixed frame and 9 j k o η 2 1 0 s θ 0 c φ c θ s φ 0 s φ c θ c φ is the jacobian matrix by defining the desired trajectory as ξ e d η 1 d t η 2 d t q d t t the tracking error vector can be defined as 10 ξ e η 1 η 2 q η 1 η 1 d η 2 η 2 d q q d the goal of the tracking problem is to make the error vector ξ e converge to zero therefore the tracking control objective is to make ξ e ζ 0 0 an asymptotically stable equilibrium point of 1 and 7 which will ensure that the tracking errors will converge to zero 2 2 model representation using quaternions in this section we will describe the model using quaternions when we use quaternions to represent the model we avoid the singularities in the jacobian matrix that arise from the euler angles we therefore obtain the advantage of a well defined jacobian which means that we can use the inverse of the jacobian matrix the complete state vector specifying the position orientation and shape of the aiauv when quaternions are used is defined as 11 ξ q η 1 t p t q t t r 7 n 1 where η 1 x y z t r 3 is the position of the base and p ε t η t ε 1 ε 2 ε 3 η t r 4 is the unit quaternion describing the orientation of the base in the inertial frame the relationship between the body fixed velocities and the complete state vector specifying the position orientation and shape of the aiauv is given by the differential equation 12 ξ q j q p ζ r b i p 0 3 3 0 3 n 1 0 4 3 j k o q p 0 4 n 1 0 n 1 3 0 n 1 3 i n 1 n 1 ζ where r i b is the rotation matrix expressing the transformation from the inertial frame to the body fixed frame and j k o q p 1 2 η i 3 s ε ε t where i 3 is the 3 3 identity matrix and s is the cross product operator defined as in 10 definition2 2 by defining the desired trajectories as 13 ξ q d η 1 d t p d t q d t t where p d ε d t η d t the orientation error which is computed via the composition quaternion product antonelli 2014 is then given by 14 p ε η η ε d η d ε s ε d ε η η d ε t ε d the complete tracking error can then be defined as 15 ξ q η 1 ε q η 1 η 1 d η ε d η d ε s ε d ε q q d remark 1 note that for the orientation the goal is to ensure that p p d which corresponds to p 0 1 3 1 t now since the euler parameters satisfy η 2 ε t ε 1 it is sufficient to make ε 0 because then p 0 1 3 1 t therefore η is not included as an independent state in 15 the goal of the tracking problem is to make the error vector 15 converge to zero therefore the tracking control objective is to make ξ q ζ 0 0 an asymptotically stable equilibrium point of 1 and 12 which will ensure that the tracking error will converge to zero 3 tracking control laws in this section we will present the tracking control laws for the aiauv using three different algorithms the sta with adaptive gains the gsta and a pid controller the control laws based on the gsta obtained in borlaug et al 2020 are briefly presented here for completeness the control structure used when velocity measurements are available is presented in fig 3 and the control structure used when a hosmo is used for state estimation is presented in fig 4 3 1 super twisting algorithm with adaptive gains in this section we will present two tracking control laws for the aiauv based on the sta with adaptive gains one where only the sta with adaptive gains is used and one where the sta with adaptive gains is combined with an hosmo 3 1 1 control law based on the sta with adaptive gains in this section a control law based on the sta with adaptive gains is presented sliding surface for smc to be used a sliding surface needs to be designed the surface should be designed such that when the sliding variable σ goes to zero the state variables asymptotically converge to zero and such that the control input τ q appears in the first derivative of σ define x 1 q ξ q where ξ q is given by 15 and 16 x 2 q r b i p 0 3 3 0 3 n 1 0 3 3 1 2 η i 3 s ε 0 3 n 1 0 n 1 3 0 n 1 3 i n 1 n 1 ζ ζ d t q p ζ where ζ and ζ d are defined in 3 and 4 respectively the sliding surface can then be chosen as 17 σ q x 1 q x 2 q r 6 n 1 if σ q 0 we will now have x 1 q x 2 q 0 since x 2 q x 1 q we can write this as 18 x 1 q x 1 q which will ensure that x 1 q globally exponentially converges to zero now since x 1 q ξ q the state variables ξ q will also globally exponentially converge to zero if σ q 0 to drive the sliding surface to zero we will use the sta with adaptive gains super twisting algorithm with adaptive gains here we present the equations describing the sta with adaptive gains in detail the sta with adaptive gains proposed in shtessel et al 2010 can be written by 19 u sta σ α σ 1 2 sgn σ v ℝ 6 n 1 v β s g n σ where the adaptive gains are defined as 20 α ω 1 γ 1 2 if σ 0 0 if σ 0 and 21 β 2 ε α λ 4 ε 2 where ε r 6 n 1 λ r 6 n 1 γ 1 r 6 n 1 and ω 1 r 6 n 1 are positive constants and σ is the sliding surface note that the mathematical operations in 19 20 and 21 are performed in an element wise manner for implementation purposes a small boundary is placed on the sliding surface such that the adaptive gains can be expressed as 22 α ω 1 γ 1 2 if σ α m 0 if σ α m β 2 ε α λ 4 ε 2 where the design parameter α m is a small positive constant selected empirically this boundary is introduced because numerically σ will never be exactly zero meaning that in practical implementations the second condition of 20 will never be met which would make the adaptive gains increase to infinity the sta with adaptive gains makes σ and σ go to zero in finite time shtessel et al 2010 control input now we want the control input τ q to be selected such that σ q u sta so that σ q and σ q will reach zero in finite time however since we do not know anything about the model we choose our control input to be 23 τ q u sta σ q with σ q defined as in 17 with this choice u sta appears in σ q as desired 3 1 2 control law based on the sta with adaptive gains combined with a higher order sliding mode observer in this section a control law based on the sta with adaptive gains combined with an hosmo will be derived using lyapunov theory we will show that ξ e ζ 0 0 is an asymptotically stable equilibrium point of 1 and 7 with the proposed control law state observer because velocity measurements are not available a state observer has to be designed we want to use the third order sliding mode observer smo presented in kumari et al 2016 as it has been proven to be finite time stable in moreno 2012 to use this third order smo we introduce a change of variables define x 1 e ξ e where ξ e is given by 6 and x 2 e j e η 2 ζ where j e η 2 ζ is given by 7 the dynamics can then be written as 24 x 1 e x 2 e x 2 e d d t j e η 2 j e 1 η 2 x 2 e m 1 q j e η 2 c q j e 1 η 2 x 2 e j e 1 η 2 x 2 e d q j e 1 η 2 x 2 e j e 1 η 2 x 2 e g q r b i τ q assumption 1 we assume that d d t j e η 2 j e 1 η 2 x 2 e is a small bounded disturbance which we will call d t we also define f c q j e 1 η 2 x 2 e j e 1 η 2 x 2 e d q j e 1 η 2 x 2 e j e 1 η 2 x 2 e g q r b i to reduce the space used to write the model the model can then be written as 25 x 1 e x 2 e x 2 e d t m 1 q j e η 2 f τ q by designing the third order smo structure as in kumari et al 2016 the third order smo can be written as 26 x ˆ 1 x ˆ 2 z 1 x ˆ 2 x ˆ 3 z 2 m 1 q j e η 2 τ q x ˆ 3 z 3 where 27 z 1 k 1 e 1 2 3 sgn e 1 z 2 k 2 e 1 1 3 sgn e 1 z 3 k 3 sgn e 1 and k 1 r 6 n 1 k 2 r 6 n 1 and k 3 r 6 n 1 are gains to be chosen according to levant 1998 and levant 2003 where e 1 x 1 e x ˆ 1 r 6 n 1 one choice of parameters that satisfies the requirements in levant 1998 and levant 2003 is according to chalanga et al 2016 k 1 6 l 1 3 k 2 11 l 1 2 and k 3 6 l where l r 6 n 1 is a sufficiently large constant note that the mathematical operations in 26 and 27 are performed in an element wise manner by defining e 2 x 2 e x ˆ 2 and e 3 x ˆ 3 f where f d t m 1 q j e η 2 f the error dynamics of the hosmo can be written as 28 e 1 k 1 e 1 2 3 sgn e 1 e 2 e 2 k 2 e 1 1 3 sgn e 1 e 3 e 3 k 3 sgn e 1 f if f δ then the third order smo errors go to zero in finite time moreno 2012 since f is a combination of d t c q j e 1 η 2 x 2 e j e 1 η 2 x 2 e d q j e 1 η 2 x 2 e j e 1 η 2 x 2 e and g q r b i and since the aiauv is a mechanical system these matrices will not change infinitely fast therefore assuming that f p ζ η 2 is bounded is a valid assumption sliding surface as mentioned previously we have to design a sliding surface to use smc the sliding surface is designed in the same manner as in sec 3 1 1 when the velocity measurement is available we choose the sliding surface to be 29 σ e x 1 e x 2 e r 6 n 1 where x 1 e ξ e with ξ e defined as in 10 and x 2 e j e η 2 ζ j e η 2 d ζ d where j e η 2 ζ is defined in 7 if σ e 0 we will now have x 1 e x 2 e 0 since x 2 e x 1 e we can write this as 30 x 1 e x 1 e which will ensure that x 1 e globally exponentially converges to zero now since x 1 e ξ e the state variables ξ e will also globally exponentially converge to zero if σ e 0 when the velocity measurement is not available the observed state values are used and we can therefore write the sliding surface with the observed values as 31 σ ˆ e x ˆ 1 x ˆ 2 r 6 n 1 where x ˆ 1 x ˆ 1 ξ e d and x ˆ 2 x ˆ 2 j e η 2 d ζ d since the third order smo errors in 28 go to zero in finite time σ ˆ e σ e after some finite time thus if σ ˆ e goes to zero the tracking objective will be satisfied to drive the sliding surface to zero we will use the sta with adaptive gains control input by designing the control input τ q such that σ ˆ e u sta we achieve that σ ˆ e and σ ˆ e reach zero in finite time since the sta is finite time stable taking the time derivative of 31 and substituting x ˆ 1 and x ˆ 2 defined in 26 we find that 32 σ ˆ e x ˆ 1 x ˆ 2 x ˆ 1 x 1 d x ˆ 2 x 2 d x ˆ 2 z 1 x 1 d x ˆ 3 z 2 m q 1 j e η 2 τ q x 2 d by choosing τ q to be 33 τ q j e η 2 1 m q x ˆ 2 z 1 x 1 d x ˆ 3 z 2 x 2 d u sta we obtain 34 σ ˆ e u sta σ ˆ e stability in this section we perform a stability analysis of the closed loop system and show that the tracking error converges asymptotically to zero we consider the closed loop system defined by 1 7 and 33 by using the fact that x ˆ 1 x 1 e e 1 and that x ˆ 2 x 2 e e 2 from sec 3 1 2 31 can be written as 35 σ ˆ e x 1 e e 1 x 1 d x 2 e e 2 x 2 d ξ e e 1 ξ e e 2 through rearranging we obtain that the tracking error dynamics are expressed as 36 ξ e ξ e σ ˆ e e 1 e 2 furthermore the velocity tracking error ζ is represented by the sliding variable σ ˆ e cf 24 and 31 the overall closed loop dynamics with τ q given by 23 is thus given by σ ˆ e given in 34 ξ e given in 36 and the state observer error given in 28 the closed loop dynamics are thus expressed as 37 1 ξ e ξ e σ ˆ e e 1 e 2 σ ˆ e α σ ˆ e 1 2 s g n σ ˆ e v v β sgn σ ˆ e 2 e 1 k 1 e 1 2 3 sgn e 1 e 2 e 2 k 2 e 1 1 3 sgn e 1 e 3 e 3 k 3 sgn e 1 f theorem 1 consider the closed loop system 1 7 and 33 assume that the hosmo in 26 and 27 is used to estimate x 1 e and x 2 e where f δ is assumed and the sliding surface is selected as in 31 then the complete system is represented by the cascaded system in 37 and the origin of the cascaded system is uniformly globally asymptotically stable ugas which ensures the asymptotic convergence of the tracking error proof the proof follows along the lines of the proof of borlaug et al 2019a theorem 1 but for 6dof instead of for 2dof analysis of subsystem 1 with e 1 0 and e 2 0 with e 1 0 and e 2 0 subsystem 1 can be written as 38 1 ξ e ξ e σ ˆ e σ ˆ e α σ ˆ e 1 2 s g n σ ˆ e v v β sta sgn σ ˆ e this can then be divided into two subsystems 39 11 ξ e ξ e σ ˆ e 12 σ ˆ e α σ ˆ e 1 2 s g n σ ˆ e v v β sta sgn σ ˆ e where loría and panteley 2005 lemma 2 1 can be used subsystem σ 11 with σ ˆ e 0 is analysed first which is clearly a globally exponentially stable linear system but since we will need a lyapunov function to analyse this system when σ ˆ e 0 we use the lyapunov function candidate v 11 ξ e 1 2 ξ e 2 for the analysis the derivative of v 11 yields 40 v 11 ξ e ξ e ξ e ξ e ξ e ξ e 2 ξ e 2 this indicates that the lyapunov function satisfies 41 k 1 x a v 11 x k 2 x a v 11 x f 11 t x k 3 x a with k 1 k 2 1 2 k 3 1 and a 2 hence by virtue of khalil 2002 theorem 4 10 the origin for subsystem σ 11 with σ ˆ e 0 is globally exponentially stable subsystem σ 12 has the structure of the sta with adaptive gains in shtessel et al 2010 a lyapunov function is proposed for systems with this structure here it is proven that the lyapunov function proposed is indeed a lyapunov function for subsystem σ 12 and that for any initial conditions σ ˆ e σ ˆ e 0 in finite time by using the sta with adaptive gains given by eq 20 and eq 21 where ε λ γ 1 and ω 1 are arbitrary positive constants the sliding surface σ ˆ e 0 is also proven to be reached in finite time now since the subsystem is gfts and autonomous it is also ugas by polyakov and fridman 2014 proposition 2 and proposition 3 which also implies that σ ˆ e t β 1 t 0 to verify that the solutions of σ 1 are uniformly globally bounded ugb subsystem σ 11 must be analysed with σ ˆ e 0 the derivative of the lyapunov function v 11 is then as follows 42 v 11 ξ e ξ e 2 σ ˆ e ξ e ξ e 2 θ ξ e 2 θ ξ e 2 β 1 ξ e 1 θ ξ e 2 ξ e β 1 θ where 0 θ 1 the solutions are then ugb because the conditions of khalil 2002 theorem 4 18 are satisfied consequently the conditions of loría and panteley 2005 lemma 2 1 are satisfied which implies that the origin of subsystem σ 1 is ugas analysis of subsystem 2 in moreno 2012 a lyapunov function is proposed for a third order observer the lyapunov function is proven to be radially unbounded and positive definite and that it is a lyapunov function for subsystem σ 2 whose trajectories converge in finite time to the origin e 0 for every value of f t as long as f t is bounded since f t is bounded by assumptions the origin is gfts for every value of f t which means that the origin is also ugas by polyakov and fridman 2014 proposition 2 and proposition 3 which in turn implies e t β 2 t 0 analysis of the complete system to analyse the complete system loría and panteley 2005 lemma 2 1 is used to check if the solutions of the complete system are ugb the boundedness of ξ e must be evaluated when e 1 0 and e 2 0 and for this the lyapunov function v 11 is used note that the boundedness of σ ˆ e follows from σ 12 being ugas because σ 12 is not perturbed by σ 2 43 v 11 ξ e ξ e 2 σ ˆ e e 1 e 2 ξ e ξ e 2 θ ξ e 2 θ ξ e 2 β 1 2 β 2 ξ e 1 θ ξ e 2 ξ e β 1 2 β 2 θ where 0 θ 1 the solutions are then ugb because the conditions of khalil 2002 theorem 4 18 are satisfied consequently the conditions of loría and panteley 2005 lemma 2 1 are satisfied which implies that the complete system is ugas 3 2 generalized super twisting algorithm in this section two tracking control laws for the aiauv based on the gsta will be presented one where only the gsta is used and one where the gsta is combined with an hosmo these control laws were derived and proven to achieve the tracking control objective in borlaug et al 2020 but we briefly present them here for completeness 3 2 1 control law based on the gsta in this subsection the tracking control law for the aiauv using the gsta will be presented in borlaug et al 2020 the control input that achieves the tracking control objective was found to be 44 τ q t q 1 p u gsta σ where p is defined as in 14 t q p is defined as in 16 σ is defined as in 17 and u gsta σ is defined as in castillo et al 2018 45 u gsta σ k 1 φ 1 σ z r 6 n 1 z k 2 φ 2 σ where 46 φ 1 σ σ 1 2 β gsta σ φ 2 σ 1 2 σ 0 3 2 β gsta σ 1 2 β gsta 2 σ where a b a b sgn a where b is a constant and k 1 r 6 n 1 k 2 r 6 n 1 and β gsta r 6 n 1 are controller gains note that the mathematical operations in 45 and 46 are performed in an element wise manner the two extra terms in φ 2 σ compared to the sta with adaptive gains in 19 provide one more parameter to adjust when designing the gsta gains k 1 k 2 and β gsta the linear growth term β gsta σ in φ 1 helps to counteract the effects of state dependent perturbations which can exponentially increase in time in borlaug et al 2020 it was proven that the control input 44 makes the closed loop system ugas and that the tracking errors for the complete system converge asymptotically to zero 3 2 2 control law based on the gsta with a higher order sliding mode observer in this subsection the tracking control law for the aiauv using the gsta combined with an hosmo is presented the hosmo that is used is the third order smo presented in sec 3 1 2 in borlaug et al 2020 the control input that achieves the tracking control objective was found to be 47 τ q j e 1 m x ˆ 2 z 1 x 1 d x ˆ 3 z 2 x 2 d u gsta σ where σ is as in 31 and where u gsta σ is defined as in castillo et al 2018 i e 45 in borlaug et al 2020 it was proven that the control input 44 makes the closed loop system ugas and that the tracking errors for the complete system converge asymptotically to zero 3 3 pid controller to benchmark the two smc algorithms we also include a pid controller in the comparison therefore in this section we propose two tracking control laws for the aiauv based on the pid controller one where we assume that the velocity is known and one where we use the estimated velocity from the hosmo 3 3 1 control law based on the pid controller in this subsection the tracking control law for the aiauv using the pid controller is presented the control input when the pid controller is used is defined as 48 τ q k p ξ e k d ζ k i ξ e d t where ξ e is defined as in 10 and ζ ζ ζ d where ζ and ζ d are defined as in 3 and 4 respectively the constants k p k d and k i are controller gains 3 3 2 control law based on the pid controller combined with a higher order sliding mode observer in this subsection the tracking control law for the aiauv using the pid controller with the estimated velocity from the hosmo is presented the control input when the pid controller with the velocity from the third order smo from sec 3 1 2 is used can be found as 49 τ q k p ξ e k d ζ ˆ k i ξ e d t where ξ e is defined as in 10 and ζ ˆ j e η 2 1 x ˆ 2 ζ d where x ˆ 2 and ζ d are defined as in 26 and 4 respectively the constants k p k d and k i are controller gains 4 simulation results in this section we present the implemented simulation model the test cases and the simulation results for trajectory tracking using the control laws presented in sec 3 4 1 implementation the aiauv model is implemented using the method described in schmidt didlaukies et al 2018 in matlab simulink together with the controllers the implemented aiauv is based on the eelume robot fig 1 which is the robot used in the experiments presented in sec 5 the aiauv has n 1 9 cylindrical links with a radius of 0 09 m n 8 revolute joints and m 7 thrusters the link frames are right hand coordinate systems in which the completely outstretched robot is placed such that the x axes point forward and the z axes point upwards in table 1 the properties of each link are presented in the thrusters column 2 z y means that the link has 2 thrusters one imposing a force in the z direction and one imposing a force in the y direction the maximum thrust of each thruster is approximately 50 n joints 1 3 5 and 7 rotate around the z axis and joints 2 4 6 and 8 rotate around the y axis the joint rotation occurs in the link frame of the corresponding link i e joint 1 rotates around the z axis of link 1 to ensure a valid comparison between the simulations and the experiments we use a p controller for the joints the reason for this choice is that the eelume robot has an internal joint controller which is a p controller to create a continuous trajectory we do not use inverse kinematic control as in borlaug et al 2018 and borlaug et al 2019b rather we use a filter to generate a continuous trajectory between setpoints the reason is that the joint controller on the eelume robot we used is not sufficiently precise to satisfy the assumption that q q d which is a prerequisite for the inverse kinematic control to perform properly the thruster allocation matrix is implemented as proposed in sverdrup thygeson et al 2018 for the simulations the ode3 fixed step solver with a step size of 0 002 was used 4 2 simulation cases in this section we describe the different test cases considered in the simulations to validate and compare the control laws presented in sec 3 we created two different test cases to represent the operation mode a mode that is thoroughly explained in sverdrup thygeson et al 2018 in operation mode we perform inspection and intervention tasks therefore accuracy is extremely important the robot that we used during the experiments is unactuated in roll when the aiauv is straight all joint angels are equal to zero and accurate control of rolling when the robot is straight is therefore not possible we therefore found a shape which we call c shape where the robot is actuated in every dof such that we can perform accurate control in every dof we therefore have one test case called c shape which is explained in detail in sec 4 2 1 we also wanted to include a test case where the robustness of the algorithms would be evaluated we therefore wanted to introduce some disturbance in our second test however we do not have access to a tank where we can introduce current we therefore introduce disturbance by using the joints thus the second test case is the c shape with a moving head which is explained in detail in sec 4 2 2 this test captures operation mode where the robot performs an inspection by looking around in a circular motion with its head and the motion also introduces a disturbance the reference trajectories for the position and orientation used for the two test cases are shown in fig 5 the references for x y and ψ are changed at 100 s and at 300 s the references for z and θ are changed the references for x ψ and θ are also changed at 450 s and for x y and z at 600 s the reference value for z is however slightly different from case to case because during the experiments we observed that some of the joints were emerging from the water and creating problems for the measurement system when we started the trajectory at 1 for the c shape with a moving head the reference value for z is therefore as in fig 5 for the c shape i e the reference value starts at 1 and changes to 0 7 whereas for the c shape with a moving head the reference value starts at 0 7 and changes to 0 5 the z reference for the c shape with a moving head when the control law with the hosmo is used is also changed at 100 s i e the reference value starts at 1 changes to 0 7 at 100 s and then changes to 0 5 at 300 s 4 2 1 c shape in the c shape configuration the aiauv is shaped like a c in this shape the aiauv is actuated in every dof since the thrusters are oriented such that the robot can provide thrust in all 6dofs and the c shape is therefore ideal for the operation mode in the c shape the joint angles references are set to q d 45 deg 0 deg 45 deg 0 deg 45 deg 0 deg 45 deg 0 deg t and in fig 6 the configuration of the robot is shown 4 2 2 c shape with a moving head the case of the c shape with a moving head is almost identical to the c shape case but in this case we move the head of the aiauv around specifically joint nr 7 and joint nr 8 are moved such that the camera positioned at joint nr 8 the head is looking around the joint angles together with their reference trajectories for the c shape with a moving head are presented in fig 7 4 3 simulation results in this section the results from the performed simulation test cases are presented to ensure that the comparison between the simulations and experiments is as fair as possible the gains used during the simulations are the gains found during the experiments the gains for the sta with adaptive gains and the hosmo are presented in table 2 for the gsta and the hosmo the gains are presented in table 3 and for the pid controller the gains are presented in table 4 for the smc algorithms the gains for the hosmo l are different from those used during the experiments for the c shape and the c shape with a moving head because we observed chattering in the simulations when we used l 0 01 which was not experienced in the experiments the trajectory tracking results using the control laws from sec 3 1 1 sec 3 2 1 and sec 3 3 1 i e without the hosmo are presented in fig 8 the trajectory tracking results include both the position errors and the orientation errors for both test cases the corresponding thruster forces are shown for the c shape in fig 9 and for the c shape with a moving head in fig 10 in table 5 the root mean square error rmse and maximum error for the position and orientation are given for each control law without the hosmo and for both simulation test cases i e the c shape and the c shape with a moving head in table 6 the root mean square rms for the thruster forces and the derivative of the thruster forces are given for each control law without the hosmo and for both simulation test cases the rms of the thruster forces provides an idea of how much force is used and the rms of the derivative of the thruster forces provides a measure of how much chattering is present in the thruster forces the trajectory tracking results using the control laws from sec 3 1 2 sec 3 2 2 and sec 3 3 2 i e with the hosmo are presented in fig 11 the corresponding thruster forces are shown for the c shape in fig 12 and for the c shape with a moving head in fig 13 in table 7 the rmse and maximum error for the position and orientation are given for each control law with the hosmo and for both simulation test cases in table 8 the rms for the thruster forces and the derivative of the thruster forces are given for each control law with the hosmo and for both simulation test cases in fig 14 and fig 15 the estimation errors for the hosmo are shown for the c shape and the c shape with a moving head respectively the first sub plot shows e 1 x 1 e x ˆ 1 and the second sub plot shows e 2 x 2 e x ˆ 2 note that if higher gains had been used in the simulations the results would have improved at least for the gsta 4 4 discussion as shown in fig 8 the aiauv follows the given position and orientation very well for both test cases as all errors are usually below 0 5 2 cm in position and 1 3 deg in orientation when the control laws from sec 3 1 1 sec 3 2 1 and sec 3 3 1 i e without the hosmo are used this result indicates that all the control laws are applicable as shown in figs 8a and 8b in the c shape case the sta with adaptive gains provides the lowest error and therefore the best result overall and the gsta provides the second best results the reason why the sta with adaptive gains provides better results than the gsta is likely because it adaptively finds the best gains whereas the gsta must be tuned manually however if we more closely examine some of the results for φ and θ we do find that for φ the gsta provides the lowest error and for θ gsta and pid provide a slightly lower error than the sta with adaptive gains from figs 8c and 8d we observe the same tendencies for the c shape with a moving head as for the c shape case i e in x y z and ψ the sta with adaptive gains provides the smallest error and the gsta is the second best however for φ and θ the errors are much more similar examining table 5 confirms what we can observe from fig 8 i e that the sta with adaptive gains provides the smallest position errors with an rmse value of 0 0008 m for the c shape and 0 0019 m for the c shape with a moving head and that the gsta is the second best with an rmse value of 0 0054 m for the c shape and 0 0068 m for the c shape with a moving head while the pid controller gives the largest position errors with an rmse value of 0 0087 m for the c shape and 0 0115 m for the c shape with a moving head for the orientation errors however the gsta gives an rmse value of 0 0114 rad for the c shape and 0 0193 rad for the c shape with a moving head while the sta with adaptive gains gives an rmse value of 0 0116 rad for the c shape and 0 0228 rad for the c shape with moving head so the results are much more similar and the gsta actually provides slightly better results the pid controller clearly offers the worst tracking performance for orientation with an rmse value of 0 0154 rad for the c shape and 0 0249 rad for the c shape with a moving head we see the same results for the maximum error value if we take the thruster use of the different algorithms into consideration presented in figs 9 and 10 we find that for both test cases the sta with adaptive gains uses more force than the gsta and the pid controller while the gsta and the pid use very similar amounts of force however the rms of τ t h r in table 6 shows that over time the amount of force used is not actually very different the sta with adaptive gains uses slightly more force in the c shape case with an rms value of 2 16 while the gsta and the pid controller uses a very similar amount of force with rms values of 1 84 and 1 80 respectively for the case of the c shape with a moving head however all the algorithms use a very similar amount of force with rms values between 1 87 1 91 from the rms values of τ t h r we find that the most chattering occurs in the control input from the sta with adaptive gains with rms value of 5 32 for the c shape and 2 19 for the c shape with a moving head and that less chattering occurs in that from the gsta with rms value of 5 05 for the c shape and 0 31 for the c shape with a moving head while the control input from the pid controller shows the least rapid changes in the thrust forces with rms value of 0 74 for the c shape and 0 67 for the c shape with a moving head however the value of the rms of τ t h r is so small that the chattering that is introduced by the sta with adaptive gains is negligible from figs 14 and 15 we can see that the estimation errors for the hosmo are quite small the hosmo is therefore applicable for state estimation when the control laws with the hosmo are used i e the control laws from sec 3 1 2 sec 3 2 2 and sec 3 3 2 we observe the same tendencies in fig 11 as when the control laws without the hosmo are used as shown in figs 11a and 11b the sta with adaptive gains provides the smallest errors for x y z and ψ and the gsta yields the second smallest errors for φ however the gsta provides the smallest error while the sta with adaptive gains results in oscillations for θ the results are more similar between the sta with adaptive gains and the gsta while the pid controller gives rise to a larger error as shown in figs 11c and 11d the results for the c shape with a moving head are the same as those for the c shape case except that the results for φ and θ are now more similar examining table 7 confirms what we can observe from fig 11 i e that the sta with adaptive gains provides the best results for position with an rmse value of 0 0009 m for the c shape and 0 0032 m for the c shape with a moving head and that the gsta is the second best with an rmse value of 0 0059 m for the c shape and 0 0075 m for the c shape with a moving head while the pid controller gives the largest position errors with an rmse value of 0 0083 m for the c shape and 0 0112 m for the c shape with a moving head for the orientation errors however the gsta gives an rmse value of 0 0072 rad for the c shape and 0 0125 rad for the c shape with a moving head while the sta with adaptive gains gives an rmse value of 0 0078 rad for the c shape and 0 0198 rad for the c shape with moving head so the results are much more similar and the gsta actually provides slightly better results the pid controller clearly offers the worst tracking performance for orientation with an rmse value of 0 0147 rad for the c shape and 0 0245 rad for the c shape with a moving head we see the same results for the maximum error value if we take the thruster use of the different algorithms into consideration presented in figs 12 and 13 we find that the sta with adaptive gains also uses more force for both test cases whereas the gsta and the pid controller use quite similar amounts of force over time however as seen in table 8 from the rms value of τ t h r the amount of force used is not actually very different the sta with adaptive gains uses slightly more force in the c shape case with an rms value of 2 25 while the gsta uses the second most amount of force with an rms value of 2 11 while the pid controller uses the least amount of force with an rms value of 1 82 for the c shape with a moving head however the gsta actually uses the most amount of force with an rms value of 2 22 and the sta with adaptive gains uses the second most amount of force with an rms value of 2 05 the pid controller does however also for the c shape with a moving head case use the least amount of force with an rms value of 1 89 from the rms values of τ t h r we find that the most chattering occurs in the control input from the sta with adaptive gains with rms value of 15 78 for the c shape and 9 48 for the c shape with a moving head and that less chattering occurs in that from the gsta with rms value of 10 99 for the c shape and 7 90 for the c shape with a moving head while the control input from the pid controller shows the least rapid changes in the thrust forces with rms value of 1 43 for the c shape and 1 37 for the c shape with a moving head however the value of the rms of τ t h r is so small that the chattering that is introduced by the sta with adaptive gains is negligible if we compare the results obtained with the control laws from sec 3 1 1 sec 3 2 1 and sec 3 3 1 i e without the hosmo and the results obtained with the control laws from sec 3 1 2 sec 3 2 2 and sec 3 3 2 i e when the hosmo is used by comparing table 5 with table 7 table 6 and table 8 we find that when the hosmo is used we obtain better tracking results for the orientation for all the algorithms as well as better tracking for position when the pid controller is used additionally note that the difference between the position errors i e with and without the hosmo is smaller than the difference between the orientation errors i e the control laws with the hosmo provide the best performance overall the reason for the better tracking performance is likely due to the increase in thruster use the thruster use is however well within the boundaries of what the eelume aiauv can provide which is 50 n to conclude we find that we obtain the best tracking performance in position by using the sta with adaptive gains and the gsta provides the best tracking performance in orientation if we simultaneously consider the errors for position and orientation we find that the sta with adaptive gains provides the best tracking performance but a large difference does not occur between the sta with adaptive gains and the gsta the reason for this difference is likely that we have to tune the gsta manually whereas the method with adaptive gains adaptively finds the best gains and thus has an advantage if we use the hosmo to estimate the linear and angular velocities in the control laws we improve our results 5 experimental investigation this section describes the eelume robot used during the experiments the experimental set up and the obtained results 5 1 the eelume robot the aiauv robot eely which was used during the experiments was the first aiauv created by the eelume company and the aiauv is described in detail in liljebäck and mills 2017 which is the aiauv on which the implemented simulation model is based the eelume aiauv has internal joint controllers which are p controllers therefore during the experiments we could only provide a desired joint reference q d to the aiauv we thus also used a p controller in the simulations as explained in sec 4 1 for the fairest possible comparison between the simulations and experiments 5 2 experimental set up we performed the experiments at the mc lab at ntnu trondheim norway marine cybernetics labora 2018 the tank located in the mc lab has the following dimensions length of 40 m height of 1 5 m and width of 6 45 m the underwater motion capture system from qualisys qualisys motion capture s 2018 is installed in the basin to provide us with real time measurements of the position and orientation of the base of the aiauv the qualisys system has six identical cameras allowing us to track reflective markers attached to the base of the aiauv underwater as shown in fig 16 the cameras allow us to track the reflective markers inside a working area with dimensions of 10 m 1 35 m 5 45 m the system structure used during the experiments is illustrated in fig 17 the six cameras indicated by blue boxes in fig 17 tracked reflective markers in the working area indicated by the red box in fig 17 the qualisys system or camera positioning system sent the measured position and orientation from an external computer to which the qualisys system was connected through the user datagram protocol udp to labview 2016 labview was then connected to the aiauv through an optical fibre cable and through udp to another computer running matlab simulink with the dynamic controller thruster allocation which was implemented as in sverdrup thygeson et al 2018 and the reference generator the computer running matlab simulink received the measured position and orientation and if the control laws without the hosmo were used also an estimate of the linear and angular velocities which were estimated by using a simple kalman filter when the control laws with the hosmo were used the linear and angular velocities were estimated by the hosmo in the dynamic controller the computer running matlab simulink then sent the thrust commands and the desired joint angles back to labview through udp these were then passed through to the aiauv through the optical fibre cable the trajectories for the position and orientation of the base of the aiauv and the joints were generated by setting setpoints and then using a filter to create a continuous trajectory between them 5 3 test cases the test cases considered during the experiments are the test cases that were explained in sec 4 2 and reproduced in the simulations i e the c shape and the c shape with a moving head 5 4 experimental results in this section the results from the experiments are presented all three algorithms i e the sta with adaptive gains the gsta and the pid controller were easy to apply successfully in the experiments and none of them required much effort in tuning in the experiments we increased the gains until we observed that the aiauv started to oscillate around the reference instead of following it the gains that we chose therefore create a small deviation from the reference rather than oscillations around the reference if we would have chosen more aggressive higher gains the aiauv would have oscillated these oscillations might be caused by delays in the thrusters for all the algorithms we attempted to use the same gains for both test cases i e we attempted to find the best possible gains for the c shape and then we used the same for the c shape with a moving head for a fair comparison for the sta with adaptive gains the choice of gains is not very important because the gains will adapt to their best possible values by themselves we did however observe that if we chose the initial adaptive gains to be too high the eelume aiauv started to oscillate we therefore had to use lower gains when the hosmo was used in the case of the c shape with a moving head likely because when the hosmo was used the thruster forces increased the gains for the sta with adaptive gains and the hosmo are presented in table 2 for the gsta and the hosmo the gains are presented in table 3 and for the pid controller the gains are listed in table 4 note that for the smc algorithms the hosmo gain l was chosen as l 0 01 in the experiments the trajectory tracking results using the control laws from sec 3 1 1 sec 3 2 1 and sec 3 3 1 i e without the hosmo are presented in fig 18 the trajectory tracking results include both the position errors and the orientation errors for both test cases the corresponding thruster forces are shown for the c shape in fig 19 and for the c shape with a moving head in fig 20 note that the thruster forces shown are the output from the control scheme i e the desired thruster forces since we are not able to measure the actual force of the thrusters or the thruster speed in table 9 the rmse and maximum error for the position and orientation are given for each control law without the hosmo and for both test cases in table 10 the rms for the thruster forces and the derivative of the thruster forces are given for each control law without the hosmo and for both test cases the trajectory tracking results using the control laws from sec 3 1 2 sec 3 2 2 and sec 3 3 2 i e with the hosmo are presented in fig 21 the corresponding thruster forces are shown for the c shape in fig 22 and for the c shape with a moving head in fig 23 in table 11 the rmse and maximum error for the position and orientation are given for each control law with the hosmo and for both test cases in table 12 the rms for the thruster forces and the derivative of the thruster forces are given for each control law with the hosmo and for both test cases note that the simulation study indicates that if higher gains could have been used without causing oscillations then the tracking accuracy would have been improved 5 5 discussion as shown in fig 18 the aiauv follows the given position and orientation very well for both test cases as all errors are usually below 1 4 cm in position and 2 5 deg in orientation when the control laws from sec 3 1 1 sec 3 2 1 and sec 3 3 1 i e without the hosmo are used as shown in fig 18a in the c shape case the sta with adaptive gains provides the best results for the position the gsta and pid controller have much more similar results for the position as the gsta has almost as large position errors as the pid controller however we do observe that the position errors for the pid controller oscillate more than the position errors for the gsta as shown in fig 18b for the orientation the results are more similar for all algorithms from figs 18c and 18d the same tendencies are observed for the c shape with a moving head as for the c shape case i e for the position the sta with adaptive gains achieves the smallest error whereas for the orientation the tracking performance is more similar examining table 9 confirms what we find from fig 18 i e that the sta with adaptive gains achieves the smallest position errors with an rmse value of 0 0054 m for the c shape and 0 0121 m for the c shape with a moving head and that the gsta is the second best with an rmse value of 0 0133 m for the c shape and 0 0327 m for the c shape with a moving head while the pid controller gives the largest position errors with an rmse value of 0 0158 m for the c shape and 0 0392 m for the c shape with a moving head for the orientation errors however the gsta gives an rmse value of 0 0210 rad for the c shape and 0 0216 rad for the c shape with a moving head while the sta with adaptive gains gives an rmse value of 0 0163 rad for the c shape and 0 0255 rad for the c shape with moving head so the sta with adaptive gains gives the best results for the c shape and the gsta gives the best results for the c shape with a moving head the pid controller actually also gives better results than the gsta for the c shape case with an rmse value of 0 0194 rad while for the c shape with a moving head the pid controller gives the worst tracking performance in orientation with an rmse value of 0 0362 rad we see the same results for the maximum error value the reason why the sta with adaptive gains outperforms the two other algorithms is likely because it has adaptive gains and is therefore robust against tuning if we take the thruster use of the different algorithms into consideration by looking at figs 19 and 20 we find that for both test cases the sta with adaptive gains uses more force than the gsta and the pid controller and that the gsta uses more force than the pid controller however based on the rms value of τ t h r table 10 shows that over time the amount of force used is not actually very different in the c shape case the sta with adaptive gains uses slightly more force with an rms value of 1 94 than the gsta that has an rms value 1 82 and the gsta uses more force than the pid controller that has an rms value of 1 44 in the case of the c shape with a moving head however the gsta and the pid controller uses very similar amounts of force with rms values of 2 18 and 2 14 respectively while the sta with adaptive gains uses more with an rms value of 2 76 from the rms values of τ t h r we find that the most chattering occurs in the control input from the sta with adaptive gains with rms value of 2 95 for the c shape and 7 24 for the c shape with a moving head and that less chattering occurs in that from the gsta with rms value of 1 46 for the c shape and 1 95 for the c shape with a moving head while the control input from the pid controller shows the least rapid changes in the thrust forces with rms value of 0 75 for the c shape and 0 93 for the c shape with a moving head however the value of the rms of τ t h r is so small that the chattering that is introduced by the sta with adaptive gains is almost negligible the reason why the chattering may appear to be considerable in the plots is because of the time scale used when the control laws with the hosmo are used i e from sec 3 1 2 sec 3 2 2 and sec 3 3 2 we observe the same tendencies in fig 21 as when the control laws without the hosmo are used but we find from figs 21a and 21b and from figs 21c and 21d that the sta with adaptive gains is no longer clearly better we also observe that we have some more measurement noise and outliers in the measurements from the measurement system see for instance the jumps in figs 21a and fig 21b between 200 s and 300 s the performance of the algorithm indicates that the algorithms are robust against this noise and the outliers as shown in table 11 we have the same results as those when the hosmo is not used i e the sta with adaptive gains provides the smallest position errors with an rmse value of 0 0064 m for the c shape and 0 0177 m for the c shape with a moving head and that the gsta is the second best with an rmse value of 0 0100 m for the c shape and 0 0252 m for the c shape with a moving head while the pid controller gives the largest position errors with an rmse value of 0 0143 m for the c shape and 0 0394 m for the c shape with a moving head for the orientation errors however the gsta gives an rmse value of 0 0062 rad for the c shape and 0 0147 rad for the c shape with a moving head while the sta with adaptive gains gives an rmse value of 0 0087 rad for the c shape and 0 0215 rad for the c shape with moving head so the results are much more similar and the gsta provides slightly better results the pid controller clearly offers the worst tracking performance for orientation with an rmse value of 0 0181 rad for the c shape and 0 0431 rad for the c shape with a moving head from the maximum errors in table 11 we can see that the measurement noise impacts the maximum error results since if we would have filtered the position measurements such that the peaks outliers in the measurements were removed we would have obtained a lower maximum error for all algorithms particularly the sta with adaptive gains and the gsta as some large peak outliers exist in those measurements if we take the thruster use of the different algorithms into consideration presented in figs 22 and 23 we find that the sta with adaptive gains uses more force for both test cases and that the gsta uses more force than the pid controller in the c shape case whereas in the case of the c shape with a moving head the pid controller and the gsta use almost the same amount of force however as shown in table 12 the rms of τ t h r indicates that the sta does use more force with an rms value of 3 02 for the c shape and 3 34 for the c shape with a moving head than the gsta with an rms value of 1 85 for the c shape and 2 23 for the c shape with a moving head and the pid controller with an rms value of 1 71 for the c shape and 2 09 for the c shape with a moving head the gsta and the pid controller does however use a very similar amount of force from the rms values of τ t h r we find that the most chattering occurs in the control input from the sta with adaptive gains with rms value of 17 49 for the c shape and 13 51 for the c shape with a moving head and that less chattering occurs in that from the gsta with rms value of 4 77 for the c shape and 5 05 for the c shape with a moving head while the control input from the pid controller shows the least rapid changes in the thrust forces with rms value of 4 27 for the c shape and 4 64 for the c shape with a moving head however the value of the rms of τ t h r is so small that the chattering that is introduced by the sta with adaptive gains is negligible the reason why considerable chattering may be evident in the plots is again because of the time scale used if we compare the results obtained with the control laws from sec 3 1 1 sec 3 2 1 and sec 3 3 1 i e without the hosmo and the results obtained with the control laws from sec 3 1 2 sec 3 2 2 and sec 3 3 2 i e when the hosmo is used by comparing table 9 with table 11 table 10 and table 12 we find that when the hosmo is used we obtain better tracking results for the orientation for all the algorithms as well as better tracking for position when the gsta is used additionally note that the difference between the position errors i e with and without the hosmo is smaller than the difference between the orientation errors i e the control laws with the hosmo provide the overall best performance the reason for the better tracking performance is likely due to the increase in thruster use the thruster use is however well within the boundaries of what the eelume aiauv can provide which is 50 n if we compare the simulation results figs 8 and 11 and the experimental results figs 18 and 21 for both test cases we find that the results are quite similar and that all algorithms are applicable with and without the hosmo to control the aiauv we also find that the same algorithms provide the best tracking results in the simulations and the experiments i e the sta with adaptive gains and the gsta in a good second place we also observed an improvement in the tracking performance for all algorithms when the hosmo was used in both simulations and experiments of course the tracking errors i e the position and orientation errors are larger in the experiments than in the simulations but that is to be expected because of measurement noise and outliers from the measurements system thruster dynamics and other unmodelled dynamics the fact that we did not have feedback from the thrusters likely also affected the errors because we did not necessarily obtain the desired forces from the thrusters 6 conclusions and future research in this paper we have presented and compared three different algorithms for solving the trajectory tracking problem for aiauvs in 6dof the sta with adaptive gains the gsta and a pid controller comprehensive simulation and experimental results for two different test cases have been presented and used to compare the performance of the three mentioned algorithms in both the simulations and in the experiments the sta with adaptive gains provided the best overall tracking performance but the gsta was not far from achieving the same tracking results thus the fact that we had to tune the gsta manually is likely the reason that we achieved lower tracking performance with this algorithm the sta with adaptive gains is therefore better in practice than the gsta but the gsta is proved to provide global finite time stability for a larger class of systems furthermore we have also solved the 6dof trajectory tracking problem using the three mentioned algorithms in combination with an hosmo additionally we have proven that the closed loop system when the sta with adaptive gains is used in combination with a hosmo is ugas the same two test cases were used to obtain comprehensive simulation and experimental results for the three algorithms in combination with the hosmo the results have been used to compare the control laws and to study the performance of the hosmo when the hosmo was used to estimate the linear and angular velocities in the control laws we improved our results indicating that the hosmo is indeed applicable for state estimation future work includes proving when assumption 24 holds moreover identifying and including an hosmo that works with quaternions is future work as well as to determine whether adaptive gains can be used with the gsta we could then realize both the theoretical advantages afforded by the gsta and the practical advantages afforded by having adaptive gains credit authorship contribution statement ida louise g borlaug conceptualization methodology software validation formal analysis investigation data curation writing original draft visualization kristin y pettersen funding acquisition supervision writing review editing jan tommy gravdahl supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was partly supported by the research council of norway through the centres of excellence funding scheme project no 223254 ntnu amos and project no 304667 
21043,submarine pipelines as an important tool for oil and gas transportation have been distributed in offshore oil and gas fields worldwide under extreme waves a large number of submarine pipelines have been damaged in the past decades in order to investigate the effect of extreme marine environments on the pipelines the joint effect of solitary waves and background currents on the pipelines is numerically studied in this paper by using a numerical wave tank developed with a free surface tracking approach and the immersed boundary method the sediment transport module including packed and suspended sediment is incorporated with the flow module in order to ensure the calculation accuracy of this model three verification cases related to the wave propagation profile the hydrodynamic force on the cylinder and the scour hole profile are simulated and the numerical results match the experimental and analytical results well given the combined wave exerts on the different pipelines the environmental variables consider the background current velocity and wave height and the pipeline arrangement includes the different diameters and the suspended pipeline and tandem pipeline it is noted that the hydrodynamic characteristics the forces and the local scour around the pipeline are closely related to the background current and the diameter and layout of the pipeline it is anticipated that the findings in this paper will enhance our understanding of the damage mechanism of submarine pipeline by waves and may also be useful in future design practices for pipelines keywords submarine pipeline solitary wave background current volume of fluid hydrodynamic load local scour 1 introduction submarine pipelines are an important tool for oil and gas transportation as they connect platforms and oil and gas gathering points in order to ensure the safety of the pipeline various influencing factors are comprehensively considered in the preliminary design of the pipeline however pipelines are often exposed above the seabed and hence subjected to various loads in complex marine environments also the sediment around the pipeline can be scoured which causes the pipeline to become suspended across the scour hole under the action of ocean waves and currents suspended pipelines are prone to vibration and fatigue damage particularly at the shoulders of the scour hole the interaction between the pipelines and seabed tends to cause stress damage to the pipelines fig 1 shows a pipeline in normal operation http news cntv cn 20111104 111420 shtml and a ruptured pipeline about one mile underneath a drilling platform http news sohu com 20100513 n272101776 shtml in order to reveal the mechanism of local scour and hydrodynamic load on the submarine pipeline many investigations have been performed using numerical or experimental methods yang et al 2017 simulated the scour process around a submarine pipeline induced by currents using coupled computational fluid dynamics and the discrete element method cfd dem finding that the motion of the sediment particles and their interactions are more intense in the tunnel erosion stage liu et al 2016 investigated the influence of nonlinear waves with different heights and periods on the local scour around pipelines placed on a flat or sloping seabed using a two dimensional numerical model xu et al 2010 carried out experimental tests to investigate the hydrodynamic loads on submarine pipelines and the seabed evolution around a pipeline under regular waves it was found that the wave forces on the pipeline depend on the bedform evolution in addition to regular waves kumar 2005 measured the wave pressures and uplift forces on different submarine pipelines under random waves showing that the wave pressure and force on pipelines at a high consistency index is smaller than that at a lower consistency index the consistency index i c of soil is defined as i c ll nmc ll pl where ll is the liquid limit of soil nmc is the natural moisture content pl is the plastic limit of soil fuhrman et al 2014 simulated wave induced scour and backfilling processes around submarine pipelines using a fully coupled hydrodynamic and morphodynamic cfd model which reveals that the scour depth is governed by the new wave climate in different backfilling situations zhao et al 2018 investigated the local scour around the submarine piggyback pipeline in steady flow depending on the experimental and numerical methods and a formula was derived to predict the maximum scour depth under the piggyback pipeline however submarine pipelines are more vulnerable to extreme marine conditions such as large surges and waves generated by hurricanes and tsunamis with elevated water levels and high speed currents in the east china sea a large number of submarine pipelines laid on the pinghu oil and gas field were destroyed due to the joint action of waves and currents in 2000 in 2005 about 102 submarine pipelines in the gulf of mexico were significantly damaged during hurricane katrina zhao et al 2019 in order to investigate the hydrodynamic characteristics of offshore and onshore infrastructures subjected to extreme marine conditions the solitary wave has always been regarded as an extreme sea wave that impinges on marine structures in experiments and numerical simulations aristodemo et al 2017 studied the horizontal and vertical hydrodynamic forces on submerged horizontal cylinders under solitary waves and proposed simple empirical formulas to calculate the hydrodynamic coefficients larsen et al 2017 2018 investigated a scour process around a monopole foundation under a representation of a tsunami with the free stream velocity and presented a fully coupled numerical model for the scour simulation it is found that under successive solitary waves the equilibrium scour depth converges with the depth under the limited steady current qu et al 2017 used the wave formed by the superposition of solitary waves to investigate the interaction between tsunamis and pipelines although the solitary wave can be employed to characterize an extreme wave waves and currents exist simultaneously in a natural ocean environment especially when the water level is rising and the flow is generated by a pressure gradient force in the early stage of a storm surge event the co existence and mutual coupling of waves and currents are relatively significant which has an important influence on the damage process of marine infrastructures xiao et al 2013 however few investigations have been conducted to describe the waves impinging on marine structures with consideration of the coupling of waves and currents particularly solitary waves and currents under extreme marine conditions ahmad et al 2019 numerically investigated pipeline scour by combining the second order stokes waves and currents which correlated with the values of the current and the flow field below the pipeline the scour depth and the temporal variation of the scouring process it is found that the scour depth and the horizontal extent of the scour hole below the pipeline increase with the current for a given kc keulegan carpenter number li et al 2019 numerically studied the two dimensional 2d local scour beneath the tandem pipelines under wave plus current conditions which revealed that the smaller horizontal gap ratio between two pipelines causes delayed scour beneath the downstream pipeline when the current has equal strength to the wave however investigations of local scour around the coastal and offshore structures under extreme marine conditions are rather limited a detailed description of the scour processes and hydrodynamic characteristics around the submarine pipeline under coupling extreme marine conditions as well as pipeline vulnerability is urgently needed the present study aims to further reveal the forces on the pipeline and the scour characteristics around the pipeline under the coupling marine conditions with solitary waves and currents based on a fully coupled numerical model the influence of the primary factors including current speed wave height pipeline diameter suspended height and tandem pipeline on the hydrodynamic loads and the scour is discussed interactions among waves background currents pipelines and the seabed are also analyzed the remainder of this paper is organized as follows in section 2 the solitary wave and current coupling control equations are described section 3 presents a coupled numerical model including flow and sediment scour modules section 4 compares measurement data and simulation results depending on three cases wave profiles hydrodynamic loads under solitary waves and scour hole profiles in a steady current the results and discussion of this study are presented in section 5 section 6 lists the concluding remarks and principal findings 2 coupling method of solitary wave and current solitary wave is a nonlinear non oscillatory wave which is completely above the still water level with a single crest in this study the solitary wave solution is based on mccowan s theory mccowan 1891 in the direction of wave propagation the background current and wave can be superposed at the inlet of the computational domain the surface elevation and velocity are generated depending on the following formulas 1 η p h where η is the water elevation h is the still water depth p is the reference value 2 p e f sin f 1 p cos f 1 p cosh f x h 3 e 2 3 sin 2 f 1 2 h 3 h f e h h tan 1 2 f 1 h h 4 x x u c 0 t the horizontal and vertical velocities at the inlet is defined as 5 u c 0 e 1 cos f y h cosh f x h cos f y h cosh f x h 2 u 6 v c 0 e sin f y h sinh f x h cos f y h cosh f x h 2 where h is the wave height x and y represent the locations in horizontal and vertical directions respectively u is the background current velocity c 0 g h h 1 2 is the wave velocity t is the time the equations from 2 to 6 are solved using the newton raphson method the water elevation is initially estimated depending on boussinesq s solution 7 η ε h sech 2 3 ε 4 x h where ε h h the initial estimates of e and f are 3ε 1 2 and 2ε respectively 3 numerical solver for coupled model geometries of submarine pipeline and sandy bed are constructed in the calculation domain by assembling these geometric objects to the flow region for the simulation given an object occupies the grid the grid is separated into two parts by the interface of the object i e the open volume part and the object filling part depending on the open volume fraction in the grid the geometry is reconstructed based on the object parameters which is also used to represent the changing geometry of the sediment in the mesh cells at the bed interface the bed shear stress the critical shields parameter the erosion rate and the bedload transport rate are calculated to determine the location orientation and area of the interface at each time step the area and volume fractions of the packed sediments in the mesh cells are calculated throughout the domain depending on the fractional volume method through the process above the numerical submarine pipeline and sandy bed are fully coupled in the fluid domain hirt and sicilian 1985 zhao et al 2019a 3 1 flow model in the free surface flow the mass and momentum conservation equations in the flow can be expressed as 8 a u 0 9 u t 1 v f a u u 1 ρ p g f where is the gradient operator u is the velocity vector a is the area fraction of fluid in the mesh of cartesian coordinate system v f is the volume fraction ρ is the fluid density p is the pressure g is the acceleration vector f is the viscous acceleration vector of flow according to the volume of fluid vof method switching technique for advection and capturing of surfaces stacs is used darwish and moukalled 2006 and the transportation equation of the free surface between water and air is formulated as 10 γ t 1 v f γ a u 0 where γ is the water volume fraction in the free surface cell γ 0 0 γ 1 and γ 1 control the different phases of air interface and water the viscous acceleration vector f in two directions of cartesian coordinate are written as 11 ρ v f f x s x x a x τ x x y a y τ x y 12 ρ v f f y s y x a x τ y x y a y τ y y where s i x y z is wall stress in two directions the terms of shear stress are calculated as 13 τ x x 2 μ 2 3 u x 1 3 v y τ x y μ v x u y τ y y 2 μ 1 3 u x 2 3 v y in order to calculate the turbulent viscosity μ two equation κ ε turbulence model is introduced as 14 k t 1 v f u a x k x v a y k y p t g t d ε 15 ε t 1 v f u a x ε x v a y ε y c 1 ε ε k p t c 3 ε g t d ε c 2 ε ε 2 k where k is the turbulent kinetic energy ε is turbulent energy dissipation rate u and v are the velocities in x and y directions p t is the turbulent kinetic energy production g t is buoyancy production term d and d ε demonstrate diffusion terms and c 1ε c 2ε and c 3ε are constant values of 1 44 1 92 and 0 2 respectively in this study the flow characteristics are simulated using the incompressible flow solver with immersed boundary ifs ib zhao et al 2019a 2019b 2019c 2020 table 1 lists the numerical solutions and control methods solitary wave and current are generated at the inlet at the pipeline surface nonslip wall condition is imposed where the velocity at the wall is zero with the increase of the distance from the wall the velocity gradually increases to the mainstream velocity cebeci and chang 1978 li et al 2019 the standard wall function with roughness coefficients k 0 4187 and e 9 793 is used for defining the mesh distribution around the pipeline and the first layer mesh thickness is 0 0004d zhao and cheng 2010 atmospheric pressure is applied on the top boundary and symmetric boundaries are used at two sides of the simulation domain wave absorbing boundary with neumann conditions is used at the outlet 3 2 sediment transport module the packed and suspended sediments are non cohesive it is beyond the current computation capability to compute the hydrodynamic characteristics of each individual grain of sediment therefore a number of empirical formulas are introduced and the model is described as follows 3 2 1 packed sediment the critical shields number is written as soulsby 1997 16 θ c 0 3 1 1 2 d 0 055 1 exp 0 02 d where d is the dimensionless parameter related to the sand diameter d s mastbergen and van den berg 2003 zhao et al 2015 17 d d s ρ s ρ 1 g ν 2 1 3 where d s is the sediment particle size ρ s is the sediment density g is the magnitude of the gravitational acceleration υ is the fluid kinetic viscosity the packed sediment laying on the sloping interface can be easily entrained by the flow down the slope correspondingly the critical shields number is modified for the sloping surface soulsby 1997 18 θ c s θ c cos φ sin β cos 2 β tan 2 ϕ sin 2 φ sin 2 β tan ϕ where θ c is 0 05 φ is the angle between the flow and the upslope direction β is the slope angle of the bed ϕ is the static angle of repose for sediment defined as 32 the local shields number caused by the turbulence flow is calculated by 19 θ τ g d s ρ s ρ where τ is the local bed shear stress 20 τ ρ u f 2 at the bottom seabed boundary the friction velocity u f is determined from the parallel component of the velocity adjacent to the seabed calculated based on an assumed logarithmic velocity distribution fuhrman et al 2014 ahmad et al 2018 2019 21 u u f 1 κ ln 30 y c k s where y c δy 2 is the normal distance from the wall to the cell center δy is the cell thickness κ 0 4 is the von karman constant and k s 2 5d s is nikuradse s equivalent sand roughness for the local shields number θ larger than the critical shields number θ cs the onset of sediment transport occurs and the dimensionless volumetric transport rate of sediment per width of bed is computed van and rijn 1984 22 φ 0 053 θ θ c s 1 2 1 d 0 3 the bed load transport rate q in units of volume per bed width per time is related to the dimensionless volumetric transport rate φ 23 q g ρ s ρ 1 d s 3 0 5 φ the bed load depth is estimated as 24 δ 0 3 d s d 0 7 θ θ c s 1 0 5 3 2 2 suspended sediment the suspended sediment concentration is calculated as 25 c s t u s c s a c s where c s is the sediment mass per volume of fluid sediment mixture a is the diffusivity u s is calculated as soulsby 1997 26 u s u m u d c s ρ s 27 u d υ d s 1 049 d 3 10 36 2 0 5 10 36 n where u m is the velocity of the fluid sediment mixture u d is the settling velocity of the suspended sediment n is the unit vector in the direction of gravity 4 model verification prior to the investigations of the joint action of solitary wave and background current on the submarine pipeline and local scour the numerical model is verified to ensure the accuracy of the simulation results three cases have been implemented including the wave elevation the hydrodynamic loads on the pipelines under solitary wave and the local scour around a pipeline in a steady flow 4 1 wave elevation profile in the simulation the length and height of the numerical calculation domain were 500 m and 20 m respectively the still water depth h and wave height h of the solitary wave were 8 m and 2 m respectively in the vertical region from 8 m to 10 m where the wave propagates 50 layers of meshes are initialized in the whole calculation domain about 389 554 grids were distributed four different background currents with u n u gh 0 5 0 1 0 2 0 3 and 0 4 which were related to the froude number were applied to vary the propagation of the solitary wave comparisons between the numerical and the analytical solutions of the instant joint wave profiles are shown in fig 2 a showing that they have good agreement with each other an experiment was carried out by aristodemo et al 2017 using the solitary wave only the wave height h and the still water depth h were 0 071 m and 0 401 m respectively the surface elevation was defined as η t 0 071 sech2 1 801t the calculation domain was 0 8 m in height and 20 m in length the mesh consisting of 320 150 quadrilateral grids and 40 mesh layers has been used to resolve the wave height region the numerical and experimental wave profiles are shown in fig 2b where t is the period of the solitary wave the results clearly depict that the numerical wave profile is in good agreement with the analytical and experimental results through the comparisons the numerical model is capable of generating different joint waves accurately 4 2 hydrodynamic load based on the experiment conducted by sibley 1991 numerical simulations of a solitary wave impinging on the cylinder near the bottom were carried out the whole simulation domain was 5 m in length and 0 4 m in height the wave height and still water depth were 0 04 m and 0 17 m respectively the length from the wave generation boundary to the center of the pipeline with a diameter of 0 034 m was 1 0 m and the distance between the center and the bottom was 0 0374 m in order to verify the mesh accuracy of the simulation three different meshes were used with dense medium and coarse meshes consisting of 453 452 152 482 and 42 156 grids respectively fig 3 shows the hydrodynamic loads in horizontal and vertical directions on the cylinder normalized by ρgπd 2 l 4 d is the cylinder diameter and l is the cylinder unit length when the wave approached and impinged on the pipeline both the horizontal and vertical forces increased to the peak values after the wave left the forces began to decline and oscillate due to the complex interaction between the wave and cylinder the simulation results with the dense mesh agree better with experimental data and hence will be used in the following simulations based on the scaling principle 4 3 scour hole profile the accuracy of the scour module was verified based on the scour experiments in the steady flow conducted by hansen et al 1986 sumer et al 1988 zhao and cheng 2010 the still water depth was 0 35 m and the average flow velocity was 0 5 m s the median sediment particle size was d 50 0 36 mm the thickness of the sand bed was 0 5 m the pipeline with a diameter of 0 1 m laid on the sand bed directly without a gap the length and height of the calculation domain covered by 325 254 grids were 14 0 m and 1 0 m respectively fig 4 shows the comparison of the scour hole profile and depth between the experimental and numerical results at 30 min and 4 h respectively because of the differences between the two research methods the numerical simulation time is earlier than that of the experiment and the time shown here is the experimental time the scour hole profiles at two moments fig 4a and b and the temporal evolution of the scour hole depth fig 4c in the numerical simulation agree well with those under experimental tests therefore the accuracy of the scour module is sufficiently verified 5 results and discussion in this section the flow fields the hydrodynamic loads and the local scour around the submarine pipeline under different environmental conditions are investigated and analyzed the simulation layout is shown in fig 5 the whole simulation domain is 500 m in length and 15 m in height the still water depth h and the thickness of the sediment layer h s are 8 0 m and 2 0 m respectively the sediment grain diameter and the wet density of the sediment are 1 0 mm and 1250 kg m3 respectively wang et al 2016 the submarine pipeline is set 20 m downstream from the wave generation boundary s denotes the distance between the bottom of the pipeline and the seabed and d is the pipeline diameter a velocity sensor is located at x 10 0 m and z 0 6 m the tandem pipeline is considered with g as the distance between two pipes the hydrodynamic forces on the submarine pipeline and the scour depth are normalized as follows 28 f x n f z n f x f z ρ g h l 2 10 2 29 d s n d s d 0 u n u g h 1 2 where f x and f z are the horizontal and vertical hydrodynamic forces on the pipeline l and d 0 are the unit length and unit diameter of the pipeline respectively the positive or negative horizontal force indicates that the force is in an aligning or reverse direction of the wave propagation direction the positive or negative vertical force stands for an upward force or a downward force respectively 5 1 effect of background current the effect of the background current with the solitary wave on the submarine pipeline and the local scour is investigated the diameter of the submarine pipeline d and distance s are 1 0 m and 0 0 m respectively the wave height of the solitary wave is 2 0 m nine groups of background current velocities are considered which change from 0 00 to 0 40 with an interval of 0 05 fig 6 depicts the temporal evolution of the velocity magnitude recorded at the sensor when the current velocity is null only the solitary wave passes over the pipeline and causes the local scour fig 7 shows the vorticity contours around the pipeline when the solitary wave approaches the pipeline t 7 8 s the onset of the sediment transport under the pipeline has occurred and a small vortex attached to the sand bed is generated due to the interaction between the flow pipeline and sand bed when the wave peak arrives at the pipeline the flow speed around the pipeline reaches the peak value the vortices behind the pipeline increase and the scour hole expands at t 10 8 s an obvious vortex is formed between the pipeline and sand bed at the scour hole which causes the drift of suspended sediment following the vortex and the retrogression of bedload sediment after the solitary wave passes the vortices rotate around the pipeline and dissipate gradually inducing the sand bed to be scoured again fig 7e and f until the scour reaches the equilibrium t 10 9 s fig 8 shows the vorticity contours with a background current at two moments of the wave leaving and the scour equilibrium under un 0 05 and 0 15 for the velocity u n of 0 05 after the wave leaves the vortices fall off behind the pipeline as the downstream background flow fig 8b for the velocity u n of 0 15 compared with the vortices under the solitary wave the vortices under the combined wave are larger due to the superimposing effects additionally a strong flow disturbance is more likely to cause the sediment scour after the wave passes the size of the vortices reaches the maximum fig 8d due to the effect of the background current there are still some attached vortices behind the pipeline and in the scour hole with the increase in the background current velocity the vortices increase gradually the vortex form behind the pipeline also changes from falling off to attachment after the combined wave passes through the pipeline and the scour intensity of sediment also increases the velocity contours under different currents with a wave crest above the pipeline are shown in fig 9 with the increase in the background current velocity the flow of the whole field has been strengthened an obvious stagnation point is formed in front of the pipeline and the flow velocities above and below the pipeline are very high however the flow velocity between the scour hole and pipeline is higher than that above the pipeline fig 9d where a channel has been formed through which the fluid passes quickly the rapid flow in the channel will accelerate the erosion of the sand bed according to the bernoulli equation the higher the velocity the lower the relative pressure which causes the pressure above the pipeline to become greater than that below the pipeline in the vertical direction the force on the pipeline is directed downwards toward the sand bed with the propagation of the wave the temporal evolutions of the forces on the pipeline and scour depth under current velocities of u n 0 0 and 0 2 are compared in fig 10 only at the moment the solitary wave with u n 0 0 approaches the pipeline the horizontal forces f x n on the pipeline increase from 0 0 to 2 1 and the sediment begins to scour when the crest of the wave is above the pipeline the force magnitude is the maximum and the horizontal force f x n of 2 1 is larger than the vertical force f z n of 1 4 the speed of the sediment scour has accelerated and the scour depth increases after the wave passes the force reduces and the scour depth d s n changes from 0 to 0 15 when the background current exits u n 0 2 the sand bed is scoured and the pipeline is subjected to the forces caused by the solitary wave and background current when the peak of the wave reaches the pipeline the forces on the pipeline reach the maximum about of 4 5 fig 10 the vertical force is negative because the flow pressure above the pipeline is greater than the pressure underneath after the wave passes the scour has basically reached the equilibrium and the scour depth changes from 0 to 0 5 compared with the solitary wave the forces are greater the scour hole is bigger and the scour duration is longer under the combined action of the solitary wave and background current fig 11 a shows the temporal evolution of the scour depth under different currents before the solitary wave reaches the pipeline t 5 s the scour depth increases only under the background current with the increase in the background current velocity u n from 0 0 to 0 3 the scour hole depth d s n increases from 0 to 0 35 when the solitary wave passes through the pipeline from 5 s to 11 s the coupling effect of the wave and current accelerates the local scour the average increase in the amplitude of the scour depth is about 0 21 when the background current velocity u n is less than 0 20 the solitary wave dominates the scour so the scour hole depth will not change after the solitary wave passes through the pipeline when the u n is larger than 0 20 the solitary wave accelerates the scour but the background current plays a leading role in the scour therefore after the solitary wave passes the scour depth still increases slightly the shapes of the scour holes when the scour reaches the equilibrium are shown in fig 11b with the increase in the current velocity u n from 0 to 0 30 both the depth and the width of the scour hole increase because in addition to the effect of the solitary wave the current can cause the larger shear force on the sand bed surface and more drifting and movement of the sediment the faster the background current the larger the shear stress and the more serious the scour when the velocity u n is 0 30 the scour depth d s n is the maximum which is about 0 82 fig 11c shows the maximum scour depth under different background currents the scour depth d s n increases from 0 16 to 1 04 as a linear function of the current velocity u n from 0 to 0 40 and the fitting formula is d s n 2 2406 u n 0 13434 with the r2 0 99653 the maximum hydrodynamic force magnitudes in the horizontal and vertical directions when the scour reaches the equilibrium are shown in fig 12 with the increase in the background current velocity u n from 0 0 to 0 4 the horizontal force f x n increases linearly from 2 1 to 7 2 when the velocity u n is less than 0 05 the vertical force f z n remains unchanged because the background current velocity is so small that the velocity of the solitary wave plays a dominant role in the force on the pipeline when the background current velocity u n exceeds 0 10 the vertical force f z n increases rapidly from 2 2 to 11 5 it is noted that when the speed is more than 0 20 the vertical force f z n starts to become greater than the horizontal force f x n and as the speed increases the vertical force f z n will become far greater than the horizontal force f x n when the velocity u n is 0 4 the vertical force f z n of 11 5 is about 1 6 times the horizontal force f x n of 7 2 it is inferred that due to the formation of the scour hole the flow has a serious impact on the vertical force in summary compared with the solitary wave the combined wave of the solitary wave and background current causes a more serious impact on the pipeline force and the seabed scour the larger the background current the easier the pipeline will be damaged when studying the interaction between waves and structures under extreme marine conditions the effects of the background current on structures cannot be ignored 5 2 effect of wave height in marine environmental conditions wave height is one of the most important factors in how different waves affect marine structures qu et al 2017 zhao et al 2019a jiang and chen 2013 in this section seven wave heights from 1 5 m to 3 0m with an interval of 0 25 m are set to investigate the effects of the different waves on the local scour around the submarine pipeline the pipeline diameter is 1 0 m and the background current velocities are u n 0 0 0 1 0 2 and 0 3 fig 13 a displays the wave propagation profiles with different wave heights at t 15s under the background current u n of 0 0 and 2 0 the wave heights are similar to each other under different background currents with the increase in the wave height the velocity magnitude increases fig 13b when the background current exists the combined velocity caused by the solitary wave and background current is higher than that only under the solitary wave and the propagation of the combined wave is faster than the solitary wave fig 14 a shows the temporal evolution of the scour depth under different background and wave heights where the solitary wave passes over the pipeline from 5 s to 11 s and where the height ratio α is of the wave height h to the still water depth h when the background current velocity u n is 0 0 with the increase in the wave height the scour depth d s n increases significantly from 0 12 to 0 22 indicating that the wave has a principal effect on the scour when the background current velocity u n increases from 0 1 to 0 2 the influence of the background current on the scour is gradually strengthened and the difference in the scour hole profile is reduced under different wave heights under the higher background current velocity the solitary wave shortens the time for scouring to reach equilibrium for example the average scour hole depth under different wave heights increases rapidly from 0 11 to 0 32 under u n 0 1 after the solitary wave passes the scour hole depth still increases slightly under u n 0 2 hence the background current determines the final scour hole profile under the strong background current fig 14b shows the scour hole profile after the solitary wave passes through the pipeline under the different wave height at the current velocity u n 0 1 the higher the wave height the larger the combined speed of the background current and solitary wave and the bigger the scour hole fig 14c depicts the maximum scour depth under different background currents and wave heights with the increase in the height ratio α from 0 1875 to 0 375 when the velocity u n is less than 0 1 the growth value δd s n of the scour depth is 0 1 but once the velocity u n is larger than 0 1 the scour depth increases slightly and the growth value δd s n is 0 03 under u n 0 3 at the same wave height ratio with the increase in the velocity u n from 0 0 to 0 4 the scour intensity is strengthened and the average growth value δd s n of the equilibrium scour depth increases significantly from 0 16 to 0 8 fig 15 shows the maximum horizontal and vertical force magnitudes the horizontal force magnitude f x n increases linearly as a function of the wave height h when the wave height ratio α changes from 0 1875 to 0 375 the horizontal forces f x n increase from 1 3 to 3 1 and from 5 2 to 7 8 under u n 0 0 and 0 3 respectively the vertical force f z n also increases with the wave height the higher the current velocity and wave height the faster the vertical force increases furthermore at the same wave height the vertical force growth gradient also increases with the linear increase in the background current velocity u n for example at the wave height of 2 0 m α 0 25 when the current velocity u n increases from 0 0 to 0 1 and from 0 2 to 0 3 the increased gradients of vertical force f z n are 0 97 and 3 47 respectively the effect of the wave height on the vertical force is more serious than that on the horizontal force in general although extreme waves cause some serious impacts on some marine infrastructures the effects of only the wave on the pipelines laid on the seabed is relatively weak under the strong background current under the joint action of an extreme wave and current the forces on the pipeline and local scour will be more serious 5 3 effect of pipeline arrangement in marine oil and gas fields pipelines are designed depending on the characteristics of the conveying medium resulting in the existence of various pipelines as shown in fig 1a due to the undulation of the seabed topography some pipelines may be suspended considering the complicated pipeline form and distribution the hydrodynamic characteristics around different pipelines are investigated under the joint action of solitary waves and currents the wave height h and still wave depth h are 2 0 m and 8 0 m respectively and four current velocities are considered as u n 0 0 0 1 0 2 and 0 3 5 3 1 effect of pipeline diameter in the simulation the seven pipeline diameters d from 0 6 m to 1 8 m with an interval of 0 2 m are selected fig 16 shows the vorticity contours with different pipeline diameters when the combined wave passes through the pipeline under the background current velocity u n of 0 1 the moment of the first column figures is when the wave crest is above the pipeline and the second moment is after the wave leaves the pipeline at the first moment when the pipeline diameter is 0 6 m there are three long vortices behind the pipeline where a couple of symmetric vortices are formed another vortex is generated due to the backflow from the scour hole when the diameter of the pipeline is small d 0 6 m the symmetric vortices formed suppress the expansion of the lower vortex so the bottom vortex also presents a narrow shape with the increase in the pipeline diameter the shielding area behind the pipeline increases the backflow range after the water bypasses the pipeline becomes large and the vortex length is shortened the growth space of the bottom vortex increases and the suppression effect of the upper vortices is weakened causing the vortex on the sand bed to develop and become bigger and bigger fig 16b and c at the second moment under the effect of the background flow the attached vortices behind the pipeline fall off and the bottom vortex grows gradually and rotates away from the sand bed in summary with the increase in the pipeline diameter the whirl intensity behind the pipeline increases and the vortex becomes bigger and bigger because the background current flows from upstream to downstream the whirl sheds along with the current which is very different from the vortex only under the solitary wave fig 17 a shows the temporal evolution of the scour depth under different pipeline diameters where the diameter ratio β is of the pipeline diameter to the unit diameter when the time is from 0 s to 5 s the local scour occurs only under the background current with the increase in the background current velocity u n from 0 to 0 2 the average scour depth d s n increases from 0 to 0 2 when the solitary wave passes over the pipeline from 5 s to 11 s the combined action of the background current and solitary wave on the seabed accelerates the local scour and the growth gradient of the scour depth increases intensively after the wave passes the scour hole depth basically no longer changes the larger the pipeline diameter the deeper the scour depth this is because when the flow hits the pipeline it separates at the stagnation point of the pipeline one part of which passes below the pipeline and causes the sediment scour the larger the pipeline diameter the more serious the flow diversion a large amount of water passes beneath the pipeline causing more serious scour for example when the background current velocity u n is 0 1 the scour depths d s n are 0 26 and 0 38 under the diameter ratio β of 0 6 and 1 8 respectively when the scour reaches the equilibrium with the increase in the pipeline diameter the scour hole increases slightly fig 17b shows the scour hole profile at un 0 2 after the solitary wave passes through the pipeline the scour depth d s n under the diameter ratio β of 1 8 is 1 75 times that of the scour depth under the diameter ratio of 0 6 fig 17c shows the maximum scour depth in different conditions with the increase in the background current the scour hole depth increases for example when the pipeline diameter is 1 0 m the scour depth under u n 0 1 is 0 34 which is two times that of the scour depth under u n 0 0 and the higher the current velocity the greater the increase in the scour depth the maximum force magnitudes when the waves pass through the different pipelines are recorded in fig 18 when the pipeline diameter ratio β increases from 0 6 to 1 8 under the velocity u n of 0 0 and 0 3 the maximum horizontal forces f x n increase from 1 0 to 3 8 and from 4 5 to 13 2 respectively the larger the pipeline diameter the greater the force growth rate therefore the slope of the horizontal force curve increases significantly under the same background current as for the vertical force fig 18b when the background current velocity u n is less than 0 1 the influence of the background flow on the force is very weak the force magnitude under u n 0 10 is similar to that of the force magnitude under un 0 00 with the increase in the pipeline diameter and background current velocity the vertical forces f z n increase significantly especially when the pipeline diameter ratio is larger than 1 5 the maximum force magnitude under u n 0 3 is about four times that of the maximum force magnitude under u n 0 1 and under the same background current the force increases significantly with the pipeline diameter to sum up with the increase in the diameter both the horizontal and vertical forces increase and the strong background current has a great influence on the forces especially for the pipeline with a large diameter 5 3 2 effect of pipeline suspended height due to uneven seabed topography the phenomenon of pipeline spanning is very common this section discusses the joint action of solitary waves and currents on different suspended pipelines with a diameter d 1 0 m seven suspended heights s from the sand bed to the bottom of the pipeline change from 0 0 m to 1 2 m with an interval of 0 2 m under the background currents with velocities u n 0 0 0 1 0 2 and 0 3 fig 19 displays the vorticity contours under different suspended heights when the wave passes through the pipeline when the wave peak arrives at the pipeline a vortex is generated on the sand bed at s 0 0 m due to the backflow of the injected water from the scour hole and the suppression of the vortex behind the pipeline with the increase in the suspended height the gap between the pipeline and sand bed increases inducing the decrease of the flow velocity below the pipeline under the weak flow the scour intensity is also weakened and the scour hole shrinks however the further away the pipeline is from the sand bed the higher the flow velocity is around the pipeline and the more serious the interaction is between the pipeline and the flow so the vortices behind the pipeline become bigger and bigger with the suspended height with the increase in the suspended height the vortex on the sand bed disappears because it is blown away by the background flow without the shielding of the pipeline and the vortices behind the pipeline enlarge and shed when the gap s is 0 8 m there is an obvious vortex shedding phenomenon and the interaction between these vortices and the sand bed hardly exists it is concluded that with the increase in the suspended height the hydrodynamics around the pipeline are strengthened but the local scour is weakened fig 20 shows the temporal evolution of the scour hole depth under the different suspended heights where the height ratio χ is of the suspended height s to the pipeline diameter after the solitary wave passes through the pipeline with the increase in the pipeline suspended height the gap s between the pipeline and sand bed becomes bigger and bigger through which more flow is allowed to pass under the same fluid flux the large gap induces the velocity decrease so with the increase in the suspended height the shear effect of the fluid on the sand bed is weakened and the scour hole becomes smaller and smaller for example when the background current velocity u n is 0 1 the scour depth d s n under the height ratio χ of 0 0 is about 0 32 which is about 5 5 times that of the scour depth under the χ 1 2 with the increase in the velocity u n under the combined effect of the solitary wave and background current the scour depth increases when the background current velocity around the pipeline is larger than that of the solitary wave the background current dominates the profile and the equilibrium state of the scour hole fig 20b shows the scour hole profile at u n 0 1 at the equilibrium state with the increase in the suspended height the scour hole depth decreases but the width increases which means that the higher pipeline affects a wide range of the flow fig 20c shows the maximum scour depth at different currents and suspended heights when the suspended height ratio χ is less than 0 6 the scour depth at u n 0 0 decreases from 0 18 to 0 04 but when χ is larger than 0 6 it basically does not change because the interference effect of the pipeline on the flow above the sand bed is weakening when the background current velocity u n is 0 3 with the increase in the suspended height the maximum scour depth d s n decreases linearly from 0 81 to 0 39 this is because the higher the flow velocity the more strongly the pipeline disturbs the fluid even if the pipeline is at a higher position on the ground the disturbed flow will still affect the scour under a high velocity background current the maximum force magnitudes in horizontal and vertical directions are shown in fig 21 with the increase in the suspended height the maximum horizontal forces f x n decrease slightly when the height s is less than 0 8 m because when the gap between the pipeline and sand bed is small the flow velocity below the pipeline is very high which causes high shear stress on the pipeline when the gap s is larger than 0 8 m the maximum horizontal forces f x n begin to increase because the closer the pipeline is to the free surface of the water the higher the flow velocity around it is the change trend of the vertical force f z n is similar to that of the horizontal force but the influence of the suspended height on the vertical force is more serious than that on the horizontal force when the gap s is 1 2 m the vertical force is obviously reduced because the flow velocities above and below the pipeline are basically the same and the vertical pressures on the pipeline are counteracted with the increase in the background current velocity u n both the vertical and horizontal hydrodynamic forces on the pipeline increase 5 3 3 effect of tandem pipeline in offshore oil and gas fields tandem pipelines often exist in offshore oil and gas fields while they can satisfy the transportation of a large amount of oil and gas in abundant quantities they are also beneficial for the transportation of different media in this section the hydrodynamic characteristics around a tandem pipeline under the joint action of solitary waves and currents are investigated in detail the pipeline diameter d is 1 0 m and there are five gaps from 1 0 m to 3 0 m with an interval of 0 5 m between two pipelines fig 22 shows the vorticity contours with g 2 0 m at different moments when only the solitary wave affects the tandem pipeline when the solitary wave approaches the tandem pipeline a couple of vortices are generated behind each pipeline when the wave crest is above the pipeline the vortices grow and shed the vortices from the upstream pipeline affect the downstream pipeline the shapes of which are distorted and changed because of the block of the downstream pipeline the vortices from the downstream pipeline with a narrow vortex shedding state are not affected by the upstream vortex shedding fig 22d after the wave leaves the pipeline the turbulent intensity of upstream vortices is stronger than that of downstream vortices fig 23 shows the vorticity contours with different gaps when the background current velocity u n is 0 1 after the wave leaves the pipeline a big vortex is generated behind the downstream pipeline when the gap g is 1 0 m the vortices behind the downstream pipeline are larger than those in other cases with the increase in the distance the vortices dissipate gradually but the vortices between the tandem pipelines become bigger and bigger fig 23c fig 24 a shows the temporal evolution of the scour depth under different tandem pipelines where the distance ratio δ is of the distance g between the tandem pipeline to the pipeline diameter when the solitary wave passes over the pipeline the upstream and downstream scour depths increase consistently at u n 0 0 the scour holes are similar to each other and the average scour depth d s n is about 0 14 when the scour reaches the equilibrium when the background current velocity u n is 0 1 the maximum scour depth d s n under the upstream pipeline is about 0 32 which is 1 45 times that of the maximum scour depth under the downstream pipeline because the current passes through the upstream pipeline with a high velocity which induces more sediment to be transported by flow due to the block of the upstream pipeline the current with a low velocity passes through the downstream pipeline inducing a relevant small scour hole under the same background current although the gap between the two pipes changes the scour hole depth beneath the downstream pipeline does not change obviously when the scour reaches the equilibrium fig 24b shows the scour hole profiles under current velocities u n 0 1 and 0 2 with the increase in the gap the deepest point of the scour hole moves with the downstream pipeline and the scour hole becomes bigger and bigger between the upstream and downstream scour holes a bulge formed by sediment accumulation is generated when the current velocity u n is larger than 0 2 the downstream scour hole changes severely because in the violent flow the upstream and downstream pipelines with a small gap can basically be regarded as a whole to disturb the flow so when the gap g is 1 0 m the downstream scour hole connects with the upstream scour hole with the increase in the gap g the outline of the downstream scour hole becomes more and more obvious because the larger the gap is the more significant the downstream pipeline s effect on the scour the bulge between the pipelines is also getting bigger and bigger when the scour is in the equilibrium fig 24c shows the maximum scour depth below the tandem pipeline when the scour is in the equilibrium with the increase in the gap g the scour depth under the tandem pipeline changes slightly under a faint background current with the increase in the background current velocity the scour depth increases the maximum force magnitudes on the tandem pipelines at different cases have been recorded in fig 25 with the increase in the gap g the horizontal forces f x n on the upstream pipelines are similar under the same background current which means that the downstream pipeline will not have a great influence on the forces of the upstream pipeline compared with the upstream pipeline the horizontal force f x n on the downstream pipeline is smaller under the same current because of the shielding effect of the upstream pipeline additionally when the current velocity u n is 0 3 the background flow is intense and the shielding effect of the upstream pipeline is more significant causing the horizontal force f x n to drop from 6 5 to 4 4 on the downstream pipeline fig 25a with the increase in the gap the vertical forces f z n on the tandem pipeline are similar under the solitary wave but the forces decrease significantly under the strong background current this is because when the current velocity is very high and the gap between the pipelines is very small the tandem pipeline can be regarded as a whole block that resists the flow with the increase in the distance between the tandem pipelines the turbulence in the gap between the pipelines intensifies which induces the upper and lower forces on the upstream pipeline to be offset even so the vertical forces on the upstream pipeline are larger than those on the downstream pipeline due to the shield of the upstream pipeline with the increase in the background current velocity all the force magnitudes on the tandem pipeline increase under the same distance g 6 conclusions in this paper the hydrodynamics and local scour around different submarine pipelines under the joint action of solitary waves and background currents were investigated based on a coupled model of the flow and sediment transport modules in a large numerical wave tank using the immersed boundary ib method the non dimensional background current velocities u n were varied in the range of 0 0 0 4 and the wave height changed from 1 5 m to 3 0 m when the background current was small u n 0 2 the solitary wave dominated the scour equilibrium state however when the background current was strong u n 0 2 the solitary wave accelerated the scour but the background current played a leading role in the scour equilibrium state at the same wave height with the increase in the velocity u n from 0 0 to 0 4 the scour intensity was strengthened and the average growth value of equilibrium scour depth d s n increased significantly from 0 16 to 0 8 when the pipeline arrangement changed the scour depth d s n under the pipeline diameter ratio β of 1 8 was 1 75 times that of the scour depth under the diameter ratio of 0 6 at un 0 2 which indicated that in extreme marine conditions the pipeline with a large diameter can be damaged easily due to the hydrodynamic force and suspended span with the increase in the pipeline suspended height ratio χ from 0 to 0 6 the descending values of horizontal force f x n and vertical force f z n were 1 2 and 4 9 under un 0 3 and the scour depth d s n decreased from 0 82 to 0 58 it is found that although the pipeline was at a higher position on the ground the erosion under the pipeline was weakened but the pipeline was more prone to stress or vibration damage and had a strong disturbance to the whole flow field additionally when the pipeline was in tandem the shielding effect of the upstream pipeline was more significant on the downstream pipeline at un 0 3 in this study all the calculation forces and local scour are under the fixed pipeline and the influence of different waves on the sinking pipeline deserves further study credit authorship contribution statement enjin zhao conceptualization methodology validation formal analysis writing original draft writing review editing youkou dong conceptualization methodology validation formal analysis writing original draft writing review editing yuezhao tang writing review editing junkai sun writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national natural science foundation of china grant no 52001286 51909248 the national key research and development program of china grant no 2018yfc0309601 and special open fund of shandong key laboratory of ocean engineering in 2019 the authors are grateful to the anonymous reviewers for their valuable input 
21043,submarine pipelines as an important tool for oil and gas transportation have been distributed in offshore oil and gas fields worldwide under extreme waves a large number of submarine pipelines have been damaged in the past decades in order to investigate the effect of extreme marine environments on the pipelines the joint effect of solitary waves and background currents on the pipelines is numerically studied in this paper by using a numerical wave tank developed with a free surface tracking approach and the immersed boundary method the sediment transport module including packed and suspended sediment is incorporated with the flow module in order to ensure the calculation accuracy of this model three verification cases related to the wave propagation profile the hydrodynamic force on the cylinder and the scour hole profile are simulated and the numerical results match the experimental and analytical results well given the combined wave exerts on the different pipelines the environmental variables consider the background current velocity and wave height and the pipeline arrangement includes the different diameters and the suspended pipeline and tandem pipeline it is noted that the hydrodynamic characteristics the forces and the local scour around the pipeline are closely related to the background current and the diameter and layout of the pipeline it is anticipated that the findings in this paper will enhance our understanding of the damage mechanism of submarine pipeline by waves and may also be useful in future design practices for pipelines keywords submarine pipeline solitary wave background current volume of fluid hydrodynamic load local scour 1 introduction submarine pipelines are an important tool for oil and gas transportation as they connect platforms and oil and gas gathering points in order to ensure the safety of the pipeline various influencing factors are comprehensively considered in the preliminary design of the pipeline however pipelines are often exposed above the seabed and hence subjected to various loads in complex marine environments also the sediment around the pipeline can be scoured which causes the pipeline to become suspended across the scour hole under the action of ocean waves and currents suspended pipelines are prone to vibration and fatigue damage particularly at the shoulders of the scour hole the interaction between the pipelines and seabed tends to cause stress damage to the pipelines fig 1 shows a pipeline in normal operation http news cntv cn 20111104 111420 shtml and a ruptured pipeline about one mile underneath a drilling platform http news sohu com 20100513 n272101776 shtml in order to reveal the mechanism of local scour and hydrodynamic load on the submarine pipeline many investigations have been performed using numerical or experimental methods yang et al 2017 simulated the scour process around a submarine pipeline induced by currents using coupled computational fluid dynamics and the discrete element method cfd dem finding that the motion of the sediment particles and their interactions are more intense in the tunnel erosion stage liu et al 2016 investigated the influence of nonlinear waves with different heights and periods on the local scour around pipelines placed on a flat or sloping seabed using a two dimensional numerical model xu et al 2010 carried out experimental tests to investigate the hydrodynamic loads on submarine pipelines and the seabed evolution around a pipeline under regular waves it was found that the wave forces on the pipeline depend on the bedform evolution in addition to regular waves kumar 2005 measured the wave pressures and uplift forces on different submarine pipelines under random waves showing that the wave pressure and force on pipelines at a high consistency index is smaller than that at a lower consistency index the consistency index i c of soil is defined as i c ll nmc ll pl where ll is the liquid limit of soil nmc is the natural moisture content pl is the plastic limit of soil fuhrman et al 2014 simulated wave induced scour and backfilling processes around submarine pipelines using a fully coupled hydrodynamic and morphodynamic cfd model which reveals that the scour depth is governed by the new wave climate in different backfilling situations zhao et al 2018 investigated the local scour around the submarine piggyback pipeline in steady flow depending on the experimental and numerical methods and a formula was derived to predict the maximum scour depth under the piggyback pipeline however submarine pipelines are more vulnerable to extreme marine conditions such as large surges and waves generated by hurricanes and tsunamis with elevated water levels and high speed currents in the east china sea a large number of submarine pipelines laid on the pinghu oil and gas field were destroyed due to the joint action of waves and currents in 2000 in 2005 about 102 submarine pipelines in the gulf of mexico were significantly damaged during hurricane katrina zhao et al 2019 in order to investigate the hydrodynamic characteristics of offshore and onshore infrastructures subjected to extreme marine conditions the solitary wave has always been regarded as an extreme sea wave that impinges on marine structures in experiments and numerical simulations aristodemo et al 2017 studied the horizontal and vertical hydrodynamic forces on submerged horizontal cylinders under solitary waves and proposed simple empirical formulas to calculate the hydrodynamic coefficients larsen et al 2017 2018 investigated a scour process around a monopole foundation under a representation of a tsunami with the free stream velocity and presented a fully coupled numerical model for the scour simulation it is found that under successive solitary waves the equilibrium scour depth converges with the depth under the limited steady current qu et al 2017 used the wave formed by the superposition of solitary waves to investigate the interaction between tsunamis and pipelines although the solitary wave can be employed to characterize an extreme wave waves and currents exist simultaneously in a natural ocean environment especially when the water level is rising and the flow is generated by a pressure gradient force in the early stage of a storm surge event the co existence and mutual coupling of waves and currents are relatively significant which has an important influence on the damage process of marine infrastructures xiao et al 2013 however few investigations have been conducted to describe the waves impinging on marine structures with consideration of the coupling of waves and currents particularly solitary waves and currents under extreme marine conditions ahmad et al 2019 numerically investigated pipeline scour by combining the second order stokes waves and currents which correlated with the values of the current and the flow field below the pipeline the scour depth and the temporal variation of the scouring process it is found that the scour depth and the horizontal extent of the scour hole below the pipeline increase with the current for a given kc keulegan carpenter number li et al 2019 numerically studied the two dimensional 2d local scour beneath the tandem pipelines under wave plus current conditions which revealed that the smaller horizontal gap ratio between two pipelines causes delayed scour beneath the downstream pipeline when the current has equal strength to the wave however investigations of local scour around the coastal and offshore structures under extreme marine conditions are rather limited a detailed description of the scour processes and hydrodynamic characteristics around the submarine pipeline under coupling extreme marine conditions as well as pipeline vulnerability is urgently needed the present study aims to further reveal the forces on the pipeline and the scour characteristics around the pipeline under the coupling marine conditions with solitary waves and currents based on a fully coupled numerical model the influence of the primary factors including current speed wave height pipeline diameter suspended height and tandem pipeline on the hydrodynamic loads and the scour is discussed interactions among waves background currents pipelines and the seabed are also analyzed the remainder of this paper is organized as follows in section 2 the solitary wave and current coupling control equations are described section 3 presents a coupled numerical model including flow and sediment scour modules section 4 compares measurement data and simulation results depending on three cases wave profiles hydrodynamic loads under solitary waves and scour hole profiles in a steady current the results and discussion of this study are presented in section 5 section 6 lists the concluding remarks and principal findings 2 coupling method of solitary wave and current solitary wave is a nonlinear non oscillatory wave which is completely above the still water level with a single crest in this study the solitary wave solution is based on mccowan s theory mccowan 1891 in the direction of wave propagation the background current and wave can be superposed at the inlet of the computational domain the surface elevation and velocity are generated depending on the following formulas 1 η p h where η is the water elevation h is the still water depth p is the reference value 2 p e f sin f 1 p cos f 1 p cosh f x h 3 e 2 3 sin 2 f 1 2 h 3 h f e h h tan 1 2 f 1 h h 4 x x u c 0 t the horizontal and vertical velocities at the inlet is defined as 5 u c 0 e 1 cos f y h cosh f x h cos f y h cosh f x h 2 u 6 v c 0 e sin f y h sinh f x h cos f y h cosh f x h 2 where h is the wave height x and y represent the locations in horizontal and vertical directions respectively u is the background current velocity c 0 g h h 1 2 is the wave velocity t is the time the equations from 2 to 6 are solved using the newton raphson method the water elevation is initially estimated depending on boussinesq s solution 7 η ε h sech 2 3 ε 4 x h where ε h h the initial estimates of e and f are 3ε 1 2 and 2ε respectively 3 numerical solver for coupled model geometries of submarine pipeline and sandy bed are constructed in the calculation domain by assembling these geometric objects to the flow region for the simulation given an object occupies the grid the grid is separated into two parts by the interface of the object i e the open volume part and the object filling part depending on the open volume fraction in the grid the geometry is reconstructed based on the object parameters which is also used to represent the changing geometry of the sediment in the mesh cells at the bed interface the bed shear stress the critical shields parameter the erosion rate and the bedload transport rate are calculated to determine the location orientation and area of the interface at each time step the area and volume fractions of the packed sediments in the mesh cells are calculated throughout the domain depending on the fractional volume method through the process above the numerical submarine pipeline and sandy bed are fully coupled in the fluid domain hirt and sicilian 1985 zhao et al 2019a 3 1 flow model in the free surface flow the mass and momentum conservation equations in the flow can be expressed as 8 a u 0 9 u t 1 v f a u u 1 ρ p g f where is the gradient operator u is the velocity vector a is the area fraction of fluid in the mesh of cartesian coordinate system v f is the volume fraction ρ is the fluid density p is the pressure g is the acceleration vector f is the viscous acceleration vector of flow according to the volume of fluid vof method switching technique for advection and capturing of surfaces stacs is used darwish and moukalled 2006 and the transportation equation of the free surface between water and air is formulated as 10 γ t 1 v f γ a u 0 where γ is the water volume fraction in the free surface cell γ 0 0 γ 1 and γ 1 control the different phases of air interface and water the viscous acceleration vector f in two directions of cartesian coordinate are written as 11 ρ v f f x s x x a x τ x x y a y τ x y 12 ρ v f f y s y x a x τ y x y a y τ y y where s i x y z is wall stress in two directions the terms of shear stress are calculated as 13 τ x x 2 μ 2 3 u x 1 3 v y τ x y μ v x u y τ y y 2 μ 1 3 u x 2 3 v y in order to calculate the turbulent viscosity μ two equation κ ε turbulence model is introduced as 14 k t 1 v f u a x k x v a y k y p t g t d ε 15 ε t 1 v f u a x ε x v a y ε y c 1 ε ε k p t c 3 ε g t d ε c 2 ε ε 2 k where k is the turbulent kinetic energy ε is turbulent energy dissipation rate u and v are the velocities in x and y directions p t is the turbulent kinetic energy production g t is buoyancy production term d and d ε demonstrate diffusion terms and c 1ε c 2ε and c 3ε are constant values of 1 44 1 92 and 0 2 respectively in this study the flow characteristics are simulated using the incompressible flow solver with immersed boundary ifs ib zhao et al 2019a 2019b 2019c 2020 table 1 lists the numerical solutions and control methods solitary wave and current are generated at the inlet at the pipeline surface nonslip wall condition is imposed where the velocity at the wall is zero with the increase of the distance from the wall the velocity gradually increases to the mainstream velocity cebeci and chang 1978 li et al 2019 the standard wall function with roughness coefficients k 0 4187 and e 9 793 is used for defining the mesh distribution around the pipeline and the first layer mesh thickness is 0 0004d zhao and cheng 2010 atmospheric pressure is applied on the top boundary and symmetric boundaries are used at two sides of the simulation domain wave absorbing boundary with neumann conditions is used at the outlet 3 2 sediment transport module the packed and suspended sediments are non cohesive it is beyond the current computation capability to compute the hydrodynamic characteristics of each individual grain of sediment therefore a number of empirical formulas are introduced and the model is described as follows 3 2 1 packed sediment the critical shields number is written as soulsby 1997 16 θ c 0 3 1 1 2 d 0 055 1 exp 0 02 d where d is the dimensionless parameter related to the sand diameter d s mastbergen and van den berg 2003 zhao et al 2015 17 d d s ρ s ρ 1 g ν 2 1 3 where d s is the sediment particle size ρ s is the sediment density g is the magnitude of the gravitational acceleration υ is the fluid kinetic viscosity the packed sediment laying on the sloping interface can be easily entrained by the flow down the slope correspondingly the critical shields number is modified for the sloping surface soulsby 1997 18 θ c s θ c cos φ sin β cos 2 β tan 2 ϕ sin 2 φ sin 2 β tan ϕ where θ c is 0 05 φ is the angle between the flow and the upslope direction β is the slope angle of the bed ϕ is the static angle of repose for sediment defined as 32 the local shields number caused by the turbulence flow is calculated by 19 θ τ g d s ρ s ρ where τ is the local bed shear stress 20 τ ρ u f 2 at the bottom seabed boundary the friction velocity u f is determined from the parallel component of the velocity adjacent to the seabed calculated based on an assumed logarithmic velocity distribution fuhrman et al 2014 ahmad et al 2018 2019 21 u u f 1 κ ln 30 y c k s where y c δy 2 is the normal distance from the wall to the cell center δy is the cell thickness κ 0 4 is the von karman constant and k s 2 5d s is nikuradse s equivalent sand roughness for the local shields number θ larger than the critical shields number θ cs the onset of sediment transport occurs and the dimensionless volumetric transport rate of sediment per width of bed is computed van and rijn 1984 22 φ 0 053 θ θ c s 1 2 1 d 0 3 the bed load transport rate q in units of volume per bed width per time is related to the dimensionless volumetric transport rate φ 23 q g ρ s ρ 1 d s 3 0 5 φ the bed load depth is estimated as 24 δ 0 3 d s d 0 7 θ θ c s 1 0 5 3 2 2 suspended sediment the suspended sediment concentration is calculated as 25 c s t u s c s a c s where c s is the sediment mass per volume of fluid sediment mixture a is the diffusivity u s is calculated as soulsby 1997 26 u s u m u d c s ρ s 27 u d υ d s 1 049 d 3 10 36 2 0 5 10 36 n where u m is the velocity of the fluid sediment mixture u d is the settling velocity of the suspended sediment n is the unit vector in the direction of gravity 4 model verification prior to the investigations of the joint action of solitary wave and background current on the submarine pipeline and local scour the numerical model is verified to ensure the accuracy of the simulation results three cases have been implemented including the wave elevation the hydrodynamic loads on the pipelines under solitary wave and the local scour around a pipeline in a steady flow 4 1 wave elevation profile in the simulation the length and height of the numerical calculation domain were 500 m and 20 m respectively the still water depth h and wave height h of the solitary wave were 8 m and 2 m respectively in the vertical region from 8 m to 10 m where the wave propagates 50 layers of meshes are initialized in the whole calculation domain about 389 554 grids were distributed four different background currents with u n u gh 0 5 0 1 0 2 0 3 and 0 4 which were related to the froude number were applied to vary the propagation of the solitary wave comparisons between the numerical and the analytical solutions of the instant joint wave profiles are shown in fig 2 a showing that they have good agreement with each other an experiment was carried out by aristodemo et al 2017 using the solitary wave only the wave height h and the still water depth h were 0 071 m and 0 401 m respectively the surface elevation was defined as η t 0 071 sech2 1 801t the calculation domain was 0 8 m in height and 20 m in length the mesh consisting of 320 150 quadrilateral grids and 40 mesh layers has been used to resolve the wave height region the numerical and experimental wave profiles are shown in fig 2b where t is the period of the solitary wave the results clearly depict that the numerical wave profile is in good agreement with the analytical and experimental results through the comparisons the numerical model is capable of generating different joint waves accurately 4 2 hydrodynamic load based on the experiment conducted by sibley 1991 numerical simulations of a solitary wave impinging on the cylinder near the bottom were carried out the whole simulation domain was 5 m in length and 0 4 m in height the wave height and still water depth were 0 04 m and 0 17 m respectively the length from the wave generation boundary to the center of the pipeline with a diameter of 0 034 m was 1 0 m and the distance between the center and the bottom was 0 0374 m in order to verify the mesh accuracy of the simulation three different meshes were used with dense medium and coarse meshes consisting of 453 452 152 482 and 42 156 grids respectively fig 3 shows the hydrodynamic loads in horizontal and vertical directions on the cylinder normalized by ρgπd 2 l 4 d is the cylinder diameter and l is the cylinder unit length when the wave approached and impinged on the pipeline both the horizontal and vertical forces increased to the peak values after the wave left the forces began to decline and oscillate due to the complex interaction between the wave and cylinder the simulation results with the dense mesh agree better with experimental data and hence will be used in the following simulations based on the scaling principle 4 3 scour hole profile the accuracy of the scour module was verified based on the scour experiments in the steady flow conducted by hansen et al 1986 sumer et al 1988 zhao and cheng 2010 the still water depth was 0 35 m and the average flow velocity was 0 5 m s the median sediment particle size was d 50 0 36 mm the thickness of the sand bed was 0 5 m the pipeline with a diameter of 0 1 m laid on the sand bed directly without a gap the length and height of the calculation domain covered by 325 254 grids were 14 0 m and 1 0 m respectively fig 4 shows the comparison of the scour hole profile and depth between the experimental and numerical results at 30 min and 4 h respectively because of the differences between the two research methods the numerical simulation time is earlier than that of the experiment and the time shown here is the experimental time the scour hole profiles at two moments fig 4a and b and the temporal evolution of the scour hole depth fig 4c in the numerical simulation agree well with those under experimental tests therefore the accuracy of the scour module is sufficiently verified 5 results and discussion in this section the flow fields the hydrodynamic loads and the local scour around the submarine pipeline under different environmental conditions are investigated and analyzed the simulation layout is shown in fig 5 the whole simulation domain is 500 m in length and 15 m in height the still water depth h and the thickness of the sediment layer h s are 8 0 m and 2 0 m respectively the sediment grain diameter and the wet density of the sediment are 1 0 mm and 1250 kg m3 respectively wang et al 2016 the submarine pipeline is set 20 m downstream from the wave generation boundary s denotes the distance between the bottom of the pipeline and the seabed and d is the pipeline diameter a velocity sensor is located at x 10 0 m and z 0 6 m the tandem pipeline is considered with g as the distance between two pipes the hydrodynamic forces on the submarine pipeline and the scour depth are normalized as follows 28 f x n f z n f x f z ρ g h l 2 10 2 29 d s n d s d 0 u n u g h 1 2 where f x and f z are the horizontal and vertical hydrodynamic forces on the pipeline l and d 0 are the unit length and unit diameter of the pipeline respectively the positive or negative horizontal force indicates that the force is in an aligning or reverse direction of the wave propagation direction the positive or negative vertical force stands for an upward force or a downward force respectively 5 1 effect of background current the effect of the background current with the solitary wave on the submarine pipeline and the local scour is investigated the diameter of the submarine pipeline d and distance s are 1 0 m and 0 0 m respectively the wave height of the solitary wave is 2 0 m nine groups of background current velocities are considered which change from 0 00 to 0 40 with an interval of 0 05 fig 6 depicts the temporal evolution of the velocity magnitude recorded at the sensor when the current velocity is null only the solitary wave passes over the pipeline and causes the local scour fig 7 shows the vorticity contours around the pipeline when the solitary wave approaches the pipeline t 7 8 s the onset of the sediment transport under the pipeline has occurred and a small vortex attached to the sand bed is generated due to the interaction between the flow pipeline and sand bed when the wave peak arrives at the pipeline the flow speed around the pipeline reaches the peak value the vortices behind the pipeline increase and the scour hole expands at t 10 8 s an obvious vortex is formed between the pipeline and sand bed at the scour hole which causes the drift of suspended sediment following the vortex and the retrogression of bedload sediment after the solitary wave passes the vortices rotate around the pipeline and dissipate gradually inducing the sand bed to be scoured again fig 7e and f until the scour reaches the equilibrium t 10 9 s fig 8 shows the vorticity contours with a background current at two moments of the wave leaving and the scour equilibrium under un 0 05 and 0 15 for the velocity u n of 0 05 after the wave leaves the vortices fall off behind the pipeline as the downstream background flow fig 8b for the velocity u n of 0 15 compared with the vortices under the solitary wave the vortices under the combined wave are larger due to the superimposing effects additionally a strong flow disturbance is more likely to cause the sediment scour after the wave passes the size of the vortices reaches the maximum fig 8d due to the effect of the background current there are still some attached vortices behind the pipeline and in the scour hole with the increase in the background current velocity the vortices increase gradually the vortex form behind the pipeline also changes from falling off to attachment after the combined wave passes through the pipeline and the scour intensity of sediment also increases the velocity contours under different currents with a wave crest above the pipeline are shown in fig 9 with the increase in the background current velocity the flow of the whole field has been strengthened an obvious stagnation point is formed in front of the pipeline and the flow velocities above and below the pipeline are very high however the flow velocity between the scour hole and pipeline is higher than that above the pipeline fig 9d where a channel has been formed through which the fluid passes quickly the rapid flow in the channel will accelerate the erosion of the sand bed according to the bernoulli equation the higher the velocity the lower the relative pressure which causes the pressure above the pipeline to become greater than that below the pipeline in the vertical direction the force on the pipeline is directed downwards toward the sand bed with the propagation of the wave the temporal evolutions of the forces on the pipeline and scour depth under current velocities of u n 0 0 and 0 2 are compared in fig 10 only at the moment the solitary wave with u n 0 0 approaches the pipeline the horizontal forces f x n on the pipeline increase from 0 0 to 2 1 and the sediment begins to scour when the crest of the wave is above the pipeline the force magnitude is the maximum and the horizontal force f x n of 2 1 is larger than the vertical force f z n of 1 4 the speed of the sediment scour has accelerated and the scour depth increases after the wave passes the force reduces and the scour depth d s n changes from 0 to 0 15 when the background current exits u n 0 2 the sand bed is scoured and the pipeline is subjected to the forces caused by the solitary wave and background current when the peak of the wave reaches the pipeline the forces on the pipeline reach the maximum about of 4 5 fig 10 the vertical force is negative because the flow pressure above the pipeline is greater than the pressure underneath after the wave passes the scour has basically reached the equilibrium and the scour depth changes from 0 to 0 5 compared with the solitary wave the forces are greater the scour hole is bigger and the scour duration is longer under the combined action of the solitary wave and background current fig 11 a shows the temporal evolution of the scour depth under different currents before the solitary wave reaches the pipeline t 5 s the scour depth increases only under the background current with the increase in the background current velocity u n from 0 0 to 0 3 the scour hole depth d s n increases from 0 to 0 35 when the solitary wave passes through the pipeline from 5 s to 11 s the coupling effect of the wave and current accelerates the local scour the average increase in the amplitude of the scour depth is about 0 21 when the background current velocity u n is less than 0 20 the solitary wave dominates the scour so the scour hole depth will not change after the solitary wave passes through the pipeline when the u n is larger than 0 20 the solitary wave accelerates the scour but the background current plays a leading role in the scour therefore after the solitary wave passes the scour depth still increases slightly the shapes of the scour holes when the scour reaches the equilibrium are shown in fig 11b with the increase in the current velocity u n from 0 to 0 30 both the depth and the width of the scour hole increase because in addition to the effect of the solitary wave the current can cause the larger shear force on the sand bed surface and more drifting and movement of the sediment the faster the background current the larger the shear stress and the more serious the scour when the velocity u n is 0 30 the scour depth d s n is the maximum which is about 0 82 fig 11c shows the maximum scour depth under different background currents the scour depth d s n increases from 0 16 to 1 04 as a linear function of the current velocity u n from 0 to 0 40 and the fitting formula is d s n 2 2406 u n 0 13434 with the r2 0 99653 the maximum hydrodynamic force magnitudes in the horizontal and vertical directions when the scour reaches the equilibrium are shown in fig 12 with the increase in the background current velocity u n from 0 0 to 0 4 the horizontal force f x n increases linearly from 2 1 to 7 2 when the velocity u n is less than 0 05 the vertical force f z n remains unchanged because the background current velocity is so small that the velocity of the solitary wave plays a dominant role in the force on the pipeline when the background current velocity u n exceeds 0 10 the vertical force f z n increases rapidly from 2 2 to 11 5 it is noted that when the speed is more than 0 20 the vertical force f z n starts to become greater than the horizontal force f x n and as the speed increases the vertical force f z n will become far greater than the horizontal force f x n when the velocity u n is 0 4 the vertical force f z n of 11 5 is about 1 6 times the horizontal force f x n of 7 2 it is inferred that due to the formation of the scour hole the flow has a serious impact on the vertical force in summary compared with the solitary wave the combined wave of the solitary wave and background current causes a more serious impact on the pipeline force and the seabed scour the larger the background current the easier the pipeline will be damaged when studying the interaction between waves and structures under extreme marine conditions the effects of the background current on structures cannot be ignored 5 2 effect of wave height in marine environmental conditions wave height is one of the most important factors in how different waves affect marine structures qu et al 2017 zhao et al 2019a jiang and chen 2013 in this section seven wave heights from 1 5 m to 3 0m with an interval of 0 25 m are set to investigate the effects of the different waves on the local scour around the submarine pipeline the pipeline diameter is 1 0 m and the background current velocities are u n 0 0 0 1 0 2 and 0 3 fig 13 a displays the wave propagation profiles with different wave heights at t 15s under the background current u n of 0 0 and 2 0 the wave heights are similar to each other under different background currents with the increase in the wave height the velocity magnitude increases fig 13b when the background current exists the combined velocity caused by the solitary wave and background current is higher than that only under the solitary wave and the propagation of the combined wave is faster than the solitary wave fig 14 a shows the temporal evolution of the scour depth under different background and wave heights where the solitary wave passes over the pipeline from 5 s to 11 s and where the height ratio α is of the wave height h to the still water depth h when the background current velocity u n is 0 0 with the increase in the wave height the scour depth d s n increases significantly from 0 12 to 0 22 indicating that the wave has a principal effect on the scour when the background current velocity u n increases from 0 1 to 0 2 the influence of the background current on the scour is gradually strengthened and the difference in the scour hole profile is reduced under different wave heights under the higher background current velocity the solitary wave shortens the time for scouring to reach equilibrium for example the average scour hole depth under different wave heights increases rapidly from 0 11 to 0 32 under u n 0 1 after the solitary wave passes the scour hole depth still increases slightly under u n 0 2 hence the background current determines the final scour hole profile under the strong background current fig 14b shows the scour hole profile after the solitary wave passes through the pipeline under the different wave height at the current velocity u n 0 1 the higher the wave height the larger the combined speed of the background current and solitary wave and the bigger the scour hole fig 14c depicts the maximum scour depth under different background currents and wave heights with the increase in the height ratio α from 0 1875 to 0 375 when the velocity u n is less than 0 1 the growth value δd s n of the scour depth is 0 1 but once the velocity u n is larger than 0 1 the scour depth increases slightly and the growth value δd s n is 0 03 under u n 0 3 at the same wave height ratio with the increase in the velocity u n from 0 0 to 0 4 the scour intensity is strengthened and the average growth value δd s n of the equilibrium scour depth increases significantly from 0 16 to 0 8 fig 15 shows the maximum horizontal and vertical force magnitudes the horizontal force magnitude f x n increases linearly as a function of the wave height h when the wave height ratio α changes from 0 1875 to 0 375 the horizontal forces f x n increase from 1 3 to 3 1 and from 5 2 to 7 8 under u n 0 0 and 0 3 respectively the vertical force f z n also increases with the wave height the higher the current velocity and wave height the faster the vertical force increases furthermore at the same wave height the vertical force growth gradient also increases with the linear increase in the background current velocity u n for example at the wave height of 2 0 m α 0 25 when the current velocity u n increases from 0 0 to 0 1 and from 0 2 to 0 3 the increased gradients of vertical force f z n are 0 97 and 3 47 respectively the effect of the wave height on the vertical force is more serious than that on the horizontal force in general although extreme waves cause some serious impacts on some marine infrastructures the effects of only the wave on the pipelines laid on the seabed is relatively weak under the strong background current under the joint action of an extreme wave and current the forces on the pipeline and local scour will be more serious 5 3 effect of pipeline arrangement in marine oil and gas fields pipelines are designed depending on the characteristics of the conveying medium resulting in the existence of various pipelines as shown in fig 1a due to the undulation of the seabed topography some pipelines may be suspended considering the complicated pipeline form and distribution the hydrodynamic characteristics around different pipelines are investigated under the joint action of solitary waves and currents the wave height h and still wave depth h are 2 0 m and 8 0 m respectively and four current velocities are considered as u n 0 0 0 1 0 2 and 0 3 5 3 1 effect of pipeline diameter in the simulation the seven pipeline diameters d from 0 6 m to 1 8 m with an interval of 0 2 m are selected fig 16 shows the vorticity contours with different pipeline diameters when the combined wave passes through the pipeline under the background current velocity u n of 0 1 the moment of the first column figures is when the wave crest is above the pipeline and the second moment is after the wave leaves the pipeline at the first moment when the pipeline diameter is 0 6 m there are three long vortices behind the pipeline where a couple of symmetric vortices are formed another vortex is generated due to the backflow from the scour hole when the diameter of the pipeline is small d 0 6 m the symmetric vortices formed suppress the expansion of the lower vortex so the bottom vortex also presents a narrow shape with the increase in the pipeline diameter the shielding area behind the pipeline increases the backflow range after the water bypasses the pipeline becomes large and the vortex length is shortened the growth space of the bottom vortex increases and the suppression effect of the upper vortices is weakened causing the vortex on the sand bed to develop and become bigger and bigger fig 16b and c at the second moment under the effect of the background flow the attached vortices behind the pipeline fall off and the bottom vortex grows gradually and rotates away from the sand bed in summary with the increase in the pipeline diameter the whirl intensity behind the pipeline increases and the vortex becomes bigger and bigger because the background current flows from upstream to downstream the whirl sheds along with the current which is very different from the vortex only under the solitary wave fig 17 a shows the temporal evolution of the scour depth under different pipeline diameters where the diameter ratio β is of the pipeline diameter to the unit diameter when the time is from 0 s to 5 s the local scour occurs only under the background current with the increase in the background current velocity u n from 0 to 0 2 the average scour depth d s n increases from 0 to 0 2 when the solitary wave passes over the pipeline from 5 s to 11 s the combined action of the background current and solitary wave on the seabed accelerates the local scour and the growth gradient of the scour depth increases intensively after the wave passes the scour hole depth basically no longer changes the larger the pipeline diameter the deeper the scour depth this is because when the flow hits the pipeline it separates at the stagnation point of the pipeline one part of which passes below the pipeline and causes the sediment scour the larger the pipeline diameter the more serious the flow diversion a large amount of water passes beneath the pipeline causing more serious scour for example when the background current velocity u n is 0 1 the scour depths d s n are 0 26 and 0 38 under the diameter ratio β of 0 6 and 1 8 respectively when the scour reaches the equilibrium with the increase in the pipeline diameter the scour hole increases slightly fig 17b shows the scour hole profile at un 0 2 after the solitary wave passes through the pipeline the scour depth d s n under the diameter ratio β of 1 8 is 1 75 times that of the scour depth under the diameter ratio of 0 6 fig 17c shows the maximum scour depth in different conditions with the increase in the background current the scour hole depth increases for example when the pipeline diameter is 1 0 m the scour depth under u n 0 1 is 0 34 which is two times that of the scour depth under u n 0 0 and the higher the current velocity the greater the increase in the scour depth the maximum force magnitudes when the waves pass through the different pipelines are recorded in fig 18 when the pipeline diameter ratio β increases from 0 6 to 1 8 under the velocity u n of 0 0 and 0 3 the maximum horizontal forces f x n increase from 1 0 to 3 8 and from 4 5 to 13 2 respectively the larger the pipeline diameter the greater the force growth rate therefore the slope of the horizontal force curve increases significantly under the same background current as for the vertical force fig 18b when the background current velocity u n is less than 0 1 the influence of the background flow on the force is very weak the force magnitude under u n 0 10 is similar to that of the force magnitude under un 0 00 with the increase in the pipeline diameter and background current velocity the vertical forces f z n increase significantly especially when the pipeline diameter ratio is larger than 1 5 the maximum force magnitude under u n 0 3 is about four times that of the maximum force magnitude under u n 0 1 and under the same background current the force increases significantly with the pipeline diameter to sum up with the increase in the diameter both the horizontal and vertical forces increase and the strong background current has a great influence on the forces especially for the pipeline with a large diameter 5 3 2 effect of pipeline suspended height due to uneven seabed topography the phenomenon of pipeline spanning is very common this section discusses the joint action of solitary waves and currents on different suspended pipelines with a diameter d 1 0 m seven suspended heights s from the sand bed to the bottom of the pipeline change from 0 0 m to 1 2 m with an interval of 0 2 m under the background currents with velocities u n 0 0 0 1 0 2 and 0 3 fig 19 displays the vorticity contours under different suspended heights when the wave passes through the pipeline when the wave peak arrives at the pipeline a vortex is generated on the sand bed at s 0 0 m due to the backflow of the injected water from the scour hole and the suppression of the vortex behind the pipeline with the increase in the suspended height the gap between the pipeline and sand bed increases inducing the decrease of the flow velocity below the pipeline under the weak flow the scour intensity is also weakened and the scour hole shrinks however the further away the pipeline is from the sand bed the higher the flow velocity is around the pipeline and the more serious the interaction is between the pipeline and the flow so the vortices behind the pipeline become bigger and bigger with the suspended height with the increase in the suspended height the vortex on the sand bed disappears because it is blown away by the background flow without the shielding of the pipeline and the vortices behind the pipeline enlarge and shed when the gap s is 0 8 m there is an obvious vortex shedding phenomenon and the interaction between these vortices and the sand bed hardly exists it is concluded that with the increase in the suspended height the hydrodynamics around the pipeline are strengthened but the local scour is weakened fig 20 shows the temporal evolution of the scour hole depth under the different suspended heights where the height ratio χ is of the suspended height s to the pipeline diameter after the solitary wave passes through the pipeline with the increase in the pipeline suspended height the gap s between the pipeline and sand bed becomes bigger and bigger through which more flow is allowed to pass under the same fluid flux the large gap induces the velocity decrease so with the increase in the suspended height the shear effect of the fluid on the sand bed is weakened and the scour hole becomes smaller and smaller for example when the background current velocity u n is 0 1 the scour depth d s n under the height ratio χ of 0 0 is about 0 32 which is about 5 5 times that of the scour depth under the χ 1 2 with the increase in the velocity u n under the combined effect of the solitary wave and background current the scour depth increases when the background current velocity around the pipeline is larger than that of the solitary wave the background current dominates the profile and the equilibrium state of the scour hole fig 20b shows the scour hole profile at u n 0 1 at the equilibrium state with the increase in the suspended height the scour hole depth decreases but the width increases which means that the higher pipeline affects a wide range of the flow fig 20c shows the maximum scour depth at different currents and suspended heights when the suspended height ratio χ is less than 0 6 the scour depth at u n 0 0 decreases from 0 18 to 0 04 but when χ is larger than 0 6 it basically does not change because the interference effect of the pipeline on the flow above the sand bed is weakening when the background current velocity u n is 0 3 with the increase in the suspended height the maximum scour depth d s n decreases linearly from 0 81 to 0 39 this is because the higher the flow velocity the more strongly the pipeline disturbs the fluid even if the pipeline is at a higher position on the ground the disturbed flow will still affect the scour under a high velocity background current the maximum force magnitudes in horizontal and vertical directions are shown in fig 21 with the increase in the suspended height the maximum horizontal forces f x n decrease slightly when the height s is less than 0 8 m because when the gap between the pipeline and sand bed is small the flow velocity below the pipeline is very high which causes high shear stress on the pipeline when the gap s is larger than 0 8 m the maximum horizontal forces f x n begin to increase because the closer the pipeline is to the free surface of the water the higher the flow velocity around it is the change trend of the vertical force f z n is similar to that of the horizontal force but the influence of the suspended height on the vertical force is more serious than that on the horizontal force when the gap s is 1 2 m the vertical force is obviously reduced because the flow velocities above and below the pipeline are basically the same and the vertical pressures on the pipeline are counteracted with the increase in the background current velocity u n both the vertical and horizontal hydrodynamic forces on the pipeline increase 5 3 3 effect of tandem pipeline in offshore oil and gas fields tandem pipelines often exist in offshore oil and gas fields while they can satisfy the transportation of a large amount of oil and gas in abundant quantities they are also beneficial for the transportation of different media in this section the hydrodynamic characteristics around a tandem pipeline under the joint action of solitary waves and currents are investigated in detail the pipeline diameter d is 1 0 m and there are five gaps from 1 0 m to 3 0 m with an interval of 0 5 m between two pipelines fig 22 shows the vorticity contours with g 2 0 m at different moments when only the solitary wave affects the tandem pipeline when the solitary wave approaches the tandem pipeline a couple of vortices are generated behind each pipeline when the wave crest is above the pipeline the vortices grow and shed the vortices from the upstream pipeline affect the downstream pipeline the shapes of which are distorted and changed because of the block of the downstream pipeline the vortices from the downstream pipeline with a narrow vortex shedding state are not affected by the upstream vortex shedding fig 22d after the wave leaves the pipeline the turbulent intensity of upstream vortices is stronger than that of downstream vortices fig 23 shows the vorticity contours with different gaps when the background current velocity u n is 0 1 after the wave leaves the pipeline a big vortex is generated behind the downstream pipeline when the gap g is 1 0 m the vortices behind the downstream pipeline are larger than those in other cases with the increase in the distance the vortices dissipate gradually but the vortices between the tandem pipelines become bigger and bigger fig 23c fig 24 a shows the temporal evolution of the scour depth under different tandem pipelines where the distance ratio δ is of the distance g between the tandem pipeline to the pipeline diameter when the solitary wave passes over the pipeline the upstream and downstream scour depths increase consistently at u n 0 0 the scour holes are similar to each other and the average scour depth d s n is about 0 14 when the scour reaches the equilibrium when the background current velocity u n is 0 1 the maximum scour depth d s n under the upstream pipeline is about 0 32 which is 1 45 times that of the maximum scour depth under the downstream pipeline because the current passes through the upstream pipeline with a high velocity which induces more sediment to be transported by flow due to the block of the upstream pipeline the current with a low velocity passes through the downstream pipeline inducing a relevant small scour hole under the same background current although the gap between the two pipes changes the scour hole depth beneath the downstream pipeline does not change obviously when the scour reaches the equilibrium fig 24b shows the scour hole profiles under current velocities u n 0 1 and 0 2 with the increase in the gap the deepest point of the scour hole moves with the downstream pipeline and the scour hole becomes bigger and bigger between the upstream and downstream scour holes a bulge formed by sediment accumulation is generated when the current velocity u n is larger than 0 2 the downstream scour hole changes severely because in the violent flow the upstream and downstream pipelines with a small gap can basically be regarded as a whole to disturb the flow so when the gap g is 1 0 m the downstream scour hole connects with the upstream scour hole with the increase in the gap g the outline of the downstream scour hole becomes more and more obvious because the larger the gap is the more significant the downstream pipeline s effect on the scour the bulge between the pipelines is also getting bigger and bigger when the scour is in the equilibrium fig 24c shows the maximum scour depth below the tandem pipeline when the scour is in the equilibrium with the increase in the gap g the scour depth under the tandem pipeline changes slightly under a faint background current with the increase in the background current velocity the scour depth increases the maximum force magnitudes on the tandem pipelines at different cases have been recorded in fig 25 with the increase in the gap g the horizontal forces f x n on the upstream pipelines are similar under the same background current which means that the downstream pipeline will not have a great influence on the forces of the upstream pipeline compared with the upstream pipeline the horizontal force f x n on the downstream pipeline is smaller under the same current because of the shielding effect of the upstream pipeline additionally when the current velocity u n is 0 3 the background flow is intense and the shielding effect of the upstream pipeline is more significant causing the horizontal force f x n to drop from 6 5 to 4 4 on the downstream pipeline fig 25a with the increase in the gap the vertical forces f z n on the tandem pipeline are similar under the solitary wave but the forces decrease significantly under the strong background current this is because when the current velocity is very high and the gap between the pipelines is very small the tandem pipeline can be regarded as a whole block that resists the flow with the increase in the distance between the tandem pipelines the turbulence in the gap between the pipelines intensifies which induces the upper and lower forces on the upstream pipeline to be offset even so the vertical forces on the upstream pipeline are larger than those on the downstream pipeline due to the shield of the upstream pipeline with the increase in the background current velocity all the force magnitudes on the tandem pipeline increase under the same distance g 6 conclusions in this paper the hydrodynamics and local scour around different submarine pipelines under the joint action of solitary waves and background currents were investigated based on a coupled model of the flow and sediment transport modules in a large numerical wave tank using the immersed boundary ib method the non dimensional background current velocities u n were varied in the range of 0 0 0 4 and the wave height changed from 1 5 m to 3 0 m when the background current was small u n 0 2 the solitary wave dominated the scour equilibrium state however when the background current was strong u n 0 2 the solitary wave accelerated the scour but the background current played a leading role in the scour equilibrium state at the same wave height with the increase in the velocity u n from 0 0 to 0 4 the scour intensity was strengthened and the average growth value of equilibrium scour depth d s n increased significantly from 0 16 to 0 8 when the pipeline arrangement changed the scour depth d s n under the pipeline diameter ratio β of 1 8 was 1 75 times that of the scour depth under the diameter ratio of 0 6 at un 0 2 which indicated that in extreme marine conditions the pipeline with a large diameter can be damaged easily due to the hydrodynamic force and suspended span with the increase in the pipeline suspended height ratio χ from 0 to 0 6 the descending values of horizontal force f x n and vertical force f z n were 1 2 and 4 9 under un 0 3 and the scour depth d s n decreased from 0 82 to 0 58 it is found that although the pipeline was at a higher position on the ground the erosion under the pipeline was weakened but the pipeline was more prone to stress or vibration damage and had a strong disturbance to the whole flow field additionally when the pipeline was in tandem the shielding effect of the upstream pipeline was more significant on the downstream pipeline at un 0 3 in this study all the calculation forces and local scour are under the fixed pipeline and the influence of different waves on the sinking pipeline deserves further study credit authorship contribution statement enjin zhao conceptualization methodology validation formal analysis writing original draft writing review editing youkou dong conceptualization methodology validation formal analysis writing original draft writing review editing yuezhao tang writing review editing junkai sun writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national natural science foundation of china grant no 52001286 51909248 the national key research and development program of china grant no 2018yfc0309601 and special open fund of shandong key laboratory of ocean engineering in 2019 the authors are grateful to the anonymous reviewers for their valuable input 
21044,this paper proposes a novel neural finite time formation control algorithm for multiple underactuated surface vessels with actuator faults in the algorithm the leader follower formation problem is formulated as a two stage tracking problem first to address the leader follower configuration without the information of leader velocity the virtual vessel is designed to track the reference trajectory of the leader second an adaptive finite time fault tolerant control afftc algorithm is presented for the follower to track the virtual vessel by fusion of the neural network nn and the fractional power the model uncertainty is approximated and the finite time convergence is obtained furthermore a concise adaptive law is developed to compensate the upper bounded of nn weights and lump disturbance which include the approximation error of nn control gain uncertainty actuator faults and marine environmental disturbance on the basis of lyapunov theory stability analysis proves that all the signals in the closed loop system are practical finite time stable finally numerical simulations are performed to demonstrate the performance and superiority of the proposed algorithm keywords underactuated surface vessels formation control neural network fault tolerant control finite time control 1 introduction in the past two decades interest in formation control of multiple marine surface vehicles has attracted extensive concern successful applications can be found in diverse scenarios and challenging tasks including ocean resource surveys maritime patrol surveillance maritime search and rescue such tasks usually can not be accomplished by a single vessel even with advanced equipments since it has limited operation range and fault tolerant capability to achieve the formation control various approaches have been developed e g virtual structure beard jr and hadaegh 2001 sadowska van den broek huijberts and van de wouw 2011 leader follower consolini et al 2008 behavior based balch and arkin 1999 and so on among these approaches the leader follower strategy is more popular in practical engineering due to its reliability and simplicity many results about the leader follower formation control can be seen in the literatures cui et al 2009 fahimi 2007 dai et al 2019 he et al 2019 currently there are several challenges with relation to leader follower formation control still worth investigating by researchers two of which will be addressed in this paper the first challenge is relation to the inter vehicle communication between the leader and follower in practical engineering the position and heading angle of the leader can be easily obtained by the ship borne equipment e g dgps and gyrocompass however accurate measurement of velocity is unavailable to followers performance degradation of the closed loop system may occur when velocity of the leader is obtained from position differentiation to alleviate requirement on leader velocity a virtual vehicle approach is developed for full actuated vehicles to assist the leader follower control in kyrkjeb and pettersen 2006 similar approach is extended in ghommam et al 2013 an adaptive nn based controller was designed for follower robot with uncertain dynamics in yang zhu chen feng and guan 2020b a solution to leader follower configuration is proposed by designing an estimator only bearing measurements are involved in the formation control scheme in gao and guo 2019 yang xiao and chen 2020a a modified observer is constructed to observe the leader velocity the desired formation of multiple mobile robots is achieved with relative information although the problem of leader follower control without leader velocity is well addressed in above literatures only asymptotical stable or uniform ultimate bound results of the closed loop system are obtained which means that the desired formation will be built in infinite time period in order to improve the robustness and convergence of the system it is necessary to reconstruct the leader velocity in finite time another challenge relates to the actuator faults of marine surface vessels when ship proceeds in awful conditions e g rough sea condition lack of routine maintenance the probability of actuator faults and failures will increase greatly therefore a variety of fault tolerant control strategies are proposed by researches cui et al 2010 qin et al 2019 ning et al 2019 in gallehdari et al 2016 a distributed reconfigured control strategy is developed for multi agent systems in the presence of actuator faults and the adverse effect of the faulty agent is eliminated by hamilton jacobi bellman equations in park and yoo 2016 tracking control of underactuated surface vessel is considered the problem of actuator faults is settled via the integrated error surfaces in xuelian et al 2016 a switching controller is designed for underactuated ships with actuator faults and failures furthermore multiple controllers are developed for different cases of actuator failures in zewei et al 2018 a fault tolerant path following algorithm is presented for uncertain surface vessels both multiplicative and additive actuator faults are compensated by the nonlinear disturbance observer although the actuator faults and failures are considered in existing works fault tolerant control of the underactuated ship still is an sophisticated mechanism and need to be further investigated according to engineering practice motivated by above observations we propose a novel nn finite time leader follower control algorithm for multiple underactuated vessels with actuator faults the main contributions of this work can be summarized as follows 1 an improved adaptive velocity adjusting algorithm is designed for virtual vessels to track reference trajectories using only relative position the velocity information of the leader is estimated effectively different from conventional results the proposed approach is with advantages of fast convergence rate and high estimation accuracy 2 a novel adaptive finite time fault tolerant control afftc algorithm is proposed for followers by employing the radial basis neural network the model uncertainty is approximated and compensated furthermore a concise adaptive law is developed to compensate the upper bound of nn weights and the lump disturbance which include the approximation error of nn control gain uncertainty actuator faults and environmental disturbance 2 problem formulation and preliminaries throughout this paper denotes the absolute operator of a scalar is the euclidean norm of a vector λ min denotes the minimum eigenvalue of the matrix ˆ where ˆ is the estimation value of 2 1 radial basis function neural network in traditional control problems neural network is usually utilized as an universal approximator to approximate unknown functions thanks to the powerful approximation capacity radial basis function neural network rbf nn is selected as a good candidate the detail expression of rbf nn can be illustrated as lemma 1 lemma 1 for any given continuous function f x with f 0 0 where x ω x r q ω x is a compact set rbf nn can be used to approximate any nonlinear function f x to any arbitrary accuracy as 1 f x w s x ε x x ω x where w ω 1 ω 2 ω n denotes the ideal constant weights ε x is the bounded approximation error which ε ε where ε is the upper bound of the approximation error s x s 1 x s 2 x s l x is a vector of radial basis functions with the form of gaussian functions 2 s i x 1 2 π h i exp x ζ i 2 h i i 1 2 ł where ζ i r q denotes the center of the receptive field h i denotes the width of the gaussian function 2 2 mathematical model of underactuated surface vessels consider a group of follower vessels in the horizontal plane their mathematical models are derived from the newtonian and lagrangian mechanics fossen 1998 guoqing and xianku 2014 where the kinematics of each vessel can be described as 3 η r ψ υ where η x y ψ denotes the position vector in earth fixed plane x y is the position ψ is the yaw angle of the follower υ u v r denotes the velocity vector in body fixed plane u v r are the surge sway and yaw angular velocities respectively r ψ is the rotational matrix and can be described as r ψ cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 the dynamics of each vessel is 4 u f u υ g u m u t u 1 m u d w u v f v υ 1 m v d w v r f r υ g r m r t r 1 m r d w r with f u υ m v m u v r d u 1 m u u d u 2 m u u u d u 3 m u u 3 f v υ m u m v u r d v 1 m v v d v 2 m v v v d v 3 m v v 3 f r υ m u m v m r u v d r 1 m r r d r 2 m r r r d r 3 m r r 3 where m u m v m r are inertia coefficients d w u d w v d w r are bounded environmental disturbance induced by wind wave and current d i 1 d i 2 d i 3 i u v r are the hydrodynamic damping and nonlinear damping terms g u g r denote the unknown control gain function t u t r are control inputs in surge and yaw directions respectively which are subject to actuator faults and failures generally there are multiplicative and additive actuator faults considered in the existing works which can be formulated as 5 t u μ u τ u τ u t r μ r τ r τ r where τ u τ r are the desired control force and moment produced by the propeller and rudder respectively μ u μ r denote the multiplicative actuator faults and τ u τ r denote the additive actuator faults if no actuator faults occurs we have μ u μ r 1 τ u τ r 0 the general structure of leader follower formation can be seen in fig 1 define the position vector of the leader as η l x l y l ψ l the velocity vector of leader as υ l u l v l ψ l the angle between the leader and follower is λ the distance between the leader and the follower can be formulated as 6 ρ x l x 2 y l y 2 assumption 1 the sway velocity of each underactuated vessel is passive bounded furthermore the velocity vector υ l of the leader is bounded by positive constant υ m assumption 2 a the product of the control gain functions g u g r and the multiplicative faults μ u μ r are with lower bound g u μ u δ u m i n g r μ r δ r m i n b for the time varying environmental disturbance d w u d w v d w r there exist unknown positive constants d w u d w v d w r such that d w u d w u d w v d w v d w r d w r lemma 2 chen et al 2011 for any σ 0 and χ r the following inequality always holds 7 0 χ χ tanh χ σ k p σ k p 0 2785 lemma 3 yu yu shirinzadeh and man 2011 consider the system x f x suppose v x is a positive definite function with v 0 0 for any real numbers ϖ 1 ϖ 2 0 0 p 1 and ϱ 0 such that 8 v x ϖ 1 v x ϖ 2 v p x ϱ then the system x f x is a practical finite time stable pfs system with residual set min ϱ 1 γ ϖ 1 ϱ 1 γ ϖ 2 1 p of the solution where 0 γ 1 the settling time is estimated by 9 t m a x 1 γ ϖ 1 1 p ln γ ϖ 1 v 1 p x 0 ϖ 2 ϖ 2 1 ϖ 1 1 p ln ϖ 1 v 1 p x 0 γ ϖ 2 γ ϖ 2 remark 1 in assumption 1 since the sway motion is dominated and damped out by the hydrodynamic force the sway dynamics of the underactuated vessel is passive boundedness the assumption is in line with the practical engineering and has been systematically analyzed in jihong et al 2008 meanwhile the vecolity of the leader is also subject to the hydrodynamic damping force and mechanical constraint when proceeding on the sea the surge speed is finite in practice control objective design an adaptive finite time fault tolerant controller τ u τ r for the follower underactuated vessels without the velocity of the leader such that all followers can track their reference trajectories and maintain the desired formation with model uncertainty environmental disturbance control gain uncertainty and actuator faults 3 formation controller design the procedure of controller design is two fold first in order to achieve desired geometric formation an improved adaptive velocity adjusting algorithm is designed for the virtual vessel without using the velocity information of the leader second a novel afftc is proposed for the follower to track the virtual vessel by employing the nn technique the model uncertainty is approximated a concise adaptive law is developed to compensate the lump disturbance which consists of the upper bound of environmental disturbance approximation error of nn control gain uncertainty and actuator faults 3 1 leader follower formation set up in this subsection the virtual vessel is introduced to track the reference position η r which generated by shifting the position of the leader η l with desired distance ρ d and desired angle λ d to address the leader follower configuration an improved adaptive velocity adjusting algorithm is presented for virtual vessel with no need of the leader velocity in earth fixed plane the reference position can be derived as 10 η r η l r ψ l l where l ρ d cos λ d ρ d sin λ d 0 similar to 3 the following equation can be derived 11 η r r ψ l υ r from 10 11 we can see that the desired geometric pattern can be built and maintained when followers move along the reference position η r with reference velocity υ r note that υ r contains the velocity information of the leader considering the practical engineering only the position and yaw angle of the leader can be obtained by followers directly hence the virtual vessel is introduced to assist in the construction of leader follower configuration define position vector of the virtual vessel as η v x v y v ψ v then 12 η v r ψ v υ v where υ v u v v v r v denotes the velocity vector of the virtual vessel define the position error as η e η r η v by assumption 1 there exists a positive constant υ m such that υ r 2 υ m to guarantee that the virtual vessel is capable to track the reference position in finite time the velocity adjusting algorithm is designed as 13 υ v r ψ v k 1 η e k 2 sig 1 2 η e υ ˆ m tanh η e σ e where k 1 k 2 r 3 3 are positive design matrices σ e is a positive design constant sig 1 2 η e sign η e η e 1 2 sign η e 1 η e 1 1 2 sign η e 2 η e 2 1 2 sign η e 3 η e 3 1 2 υ ˆ m is a adaptive parameter for υ m and υ ˆ m is updated by 14 υ ˆ m λ 1 η e tanh η e σ e k v υ ˆ m where λ 1 k v are positive design constants theorem 1 under assumption 1 consider the dynamics of the virtual vessel 12 the velocity adjusting algorithm 13 and the adaptive law 14 for any bounded initial states the virtual vessel is capable to track the reference position in finite time proof select the lyapunov candidate as follows 15 v 1 1 2 η e η e 1 2 λ 1 υ m 2 differentiating v 1 with respect to time 16 v 1 η e η e 1 λ 1 υ m υ ˆ m according to 11 12 13 and lemma1 2 we have 17 η e η e η e υ m η e r ψ v υ v 0 275 σ e υ m υ m η e tanh η e σ e η e k 1 η e k 2 η e 3 2 υ ˆ m η e tanh η e σ e λ min k 1 η e 2 λ min k 2 η e 3 2 υ m η e tanh η e σ e 0 275 σ e υ m in the light of 14 the following equation can be derived 18 1 λ 1 υ m υ ˆ υ m η e tanh η e σ e k v υ m υ ˆ m and the term k v υ m υ ˆ m can be transformed into 19 k v υ m υ ˆ m k v 2 υ m 2 k v 2 υ m 2 k v 8 υ m 2 k v 2 υ m 3 2 k v 8 k v 2 υ m 2 from 16 17 18 19 we have 20 v 1 λ min k 1 η e 2 k v 8 υ m 2 λ min k 2 η e 3 2 k v 2 υ m 3 2 ϱ 1 2 λ min k 1 1 2 η e 2 k v λ 1 4 1 2 λ 1 υ m 2 2 3 4 λ min k 2 1 2 η e 2 3 4 k v λ 1 3 2 1 4 1 2 λ 1 υ m 2 3 4 ϱ 1 with ϱ 1 0 275 σ e υ m k v 8 k v 2 υ m 2 then we have 21 v 1 α 1 v 1 α 2 v 1 3 4 ϱ 1 where α 1 min 2 λ min k 1 k v λ 1 4 α 2 min 2 3 4 λ min k 1 k v λ 1 3 2 1 4 based on lemma 3 the error signals η e υ m can converge into the region 1 min ϱ 1 1 γ 1 α 1 ϱ 1 1 γ 1 α 2 1 4 in finite time the settling time can be calculated by t 1 max 4 γ 1 α 1 ln γ 1 α 1 v 1 4 η e 0 υ m 0 α 2 α 2 4 α 1 ln α 1 v 1 4 η e 0 υ m 0 γ 1 α 2 γ 1 α 2 where 0 γ 1 1 the region is with the radius min 2 ϱ 1 1 γ 2 α 1 2 ϱ 1 1 γ 2 α 2 therefore all the signals in the closed loop system is pfs this completes the proof of theorem 1 remark 2 compared with the leader follower control scheme in cui et al 2010 there are two main advantages in proposed algorithm 1 the fractional power is introduced to program the velocity of the virtual vessel in 13 which guarantee that the virtual vessel could track the reference position in finite time 2 a concise adaptive law is designed to estimate the upper bound of reference velocity this facilitate the leader follower formation control without using the information of leader velocity 3 2 nn based formation tracking control this subsection aims to solve the problem of formation tracking control i e design a novel algorithm for each follower to track the position of the virtual vessel fig 2 shows the principle of formation tracking procedure in the proposed algorithm the rbf nn is employed to approximate and compensate the model uncertainty of followers the fractional power is introduced to obtain the finite time convergence of tracking controller furthermore a concise adaptive law is presented to estimate the upper bound of nn weights and lump disturbance the design of the formation tracking controller are divided into two steps as follows step 1 define the tracking errors of the virtual vessel and the follower 22 x e x v x y e y v y ψ e ψ d ψ where ψ d is the azimuth angle of follower relative to the virtual vessel and can be described as 23 ψ d 0 5 1 sgn x e sgn y e π arctan y e x e z e 0 ψ v z e 0 the distance between the virtual vessel and the follower vessel is 24 z e x e 2 y e 2 from fig 2 it can be seen that 25 x e z e cos ψ d y e z e sin ψ d according to 3 22 and 25 we have 26 z e x v cos ψ d y v sin ψ d u cos ψ e v sin ψ e ψ e ψ d r design the virtual controllers α u α r for u and r 27 α u cos ψ e 1 x v cos ψ d y v sin ψ d v sin ψ d k 1 z e σ x y k 2 sig 1 2 z e σ x y α r k 3 ψ e k 4 sig 1 2 ψ e ψ d where k 1 k 2 k 3 k 4 are all positive design constants δ x y is a small positive constant and is introduced to guarantee that the follower is always behind the virtual vessel also it is necessary to note that there is no definition for α u when ψ e π 2 thus the condition ψ e π 2 should be guaranteed in practical engineering 28 ψ e ψ e π ψ e 0 5 π ψ e 0 5 π ψ e 0 5 π ψ e π ψ e 0 5 π step 2 let i e i α i i u r taking the time derivative of i e we have 29 i e f i υ g i m i t i 1 m i d w i α i since the detail information about f i υ is difficult to be obtained rbf nn is employed to approximate the unknown part as follows 30 f i υ w i t s i υ ε i eq 29 can be rewritten as 31 i e w i t s i υ ε i g i m i t i 1 m i d w i α i design the formation tracking controllers for followers as 32 τ i k i 1 i e k i 2 sig 1 2 i e α i ξ ˆ i i e s i υ 2 φ 1 i ϕ ˆ i where k i 1 k i 2 φ 1 i are all positive design constants sig i e 1 2 sign i e i e 1 2 α i can be obtained by using the differential filer s t d s 1 instead of analytical calculation where t d is a time constant e g t d 0 01 s such calculation is common in control engineering the adaptive law are developed as 33 ξ ˆ i ε 1 i i e ε 2 i ξ ˆ i ϕ ˆ i ε 3 i i e 2 s i υ 2 φ 1 i ε 4 i ϕ ˆ i where ε 1 i ε 2 i ε 3 i ε 4 i are positive design constants remark 3 note that the nn approximation in 30 is an extension of that in guoqing and xianku 2014 since the coupled states is included in f i υ the strong coupling of ship dynamics can be addressed directly such design can also simply the design of the nn based formation tracking controller theorem 2 under assumption 1 2 consider the ship dynamics of follower vessels 3 4 with actuator faults 5 formation tracking controller 32 and the adaptive law 33 for any bounded initial states the follower can tack the virtual vessel in finite time with model uncertainty environmental disturbance control gain uncertainty and actuator faults proof consider the following lyapunov candidate 34 v 2 z e δ x y 2 ψ e 2 1 2 i i r i e 2 1 2 i u r m i δ i m i n ε 1 i ξ i δ i m i n m i ξ ˆ i 2 1 2 i i r m i δ i m i n ε 3 i ϕ i δ i m i n m i ϕ ˆ i 2 where ξ i sup t 0 i ω i ε i g i τ i m i d w i m i ϕ i sup t 0 i ω i w i 2 differentiating v 2 with respect to time 35 v 2 z e σ x y z e ψ e ψ e i u r i e i e i u r 1 ε 1 i ξ i δ i m i n m i ξ i ˆ i u r 1 ε 3 i ϕ i δ i m i n m i ϕ ˆ i ϕ ˆ i according to 26 27 and young s inequality the following equation can be derived 36 z e δ x y z e z e δ x y u e cos ψ e k 1 z e δ x y k 2 sig 1 2 z e δ x y k 1 1 2 z e δ x y 2 k 2 z e δ x y 3 2 1 2 u e 2 and the term ψ e ψ e is transformed into 37 ψ e ψ e ψ e k 3 ψ e k 4 sig 1 2 ψ e r e k 3 1 2 ψ e 2 k 4 ψ e 3 2 1 2 r e 2 substituting 5 32 into 31 we have 38 i e i e i e w i s i υ i e α i i e ε i g i τ i m i d w i m i i e g i μ i τ i m i i e ϕ i s i υ i e α i i e ξ i i e δ i min τ i m i δ i min m i k i 1 i e 2 δ i min m i k 2 i i e 3 2 1 δ i min m i α i e ξ i δ i min m i ξ ˆ i i e ϕ i δ i min m i ϕ ˆ i s i υ 2 φ 1 i i e 2 φ 1 i δ i min m i k 1 i 1 φ 2 i 1 δ i min m i 2 α i 2 i e 2 δ i min m i k 2 i i 2 3 2 ξ i δ i min m i ξ ˆ i i e ϕ i δ i min m i ϕ ˆ i s i υ 2 φ 1 i i e 2 φ 1 i φ 2 i from 33 and young s inequality we have 39 1 ε 1 i ξ i δ i m i n m i ξ ˆ i ξ ˆ ξ i δ i m i n m i ξ ˆ i i e ε 2 i ε 1 i ξ i δ i m i n m i ξ ˆ i ξ ˆ i let ξ ξ i δ i m i n m i ξ ˆ i then 40 ε 2 i ε 1 i ξ i δ i m i n m i ξ ˆ i ξ ˆ i ε 2 i m i ε 1 i δ i m i n 1 8 ξ i 2 1 2 ξ 3 2 1 2 ξ i 2 1 8 substitute 40 into 39 we have 41 1 ε 1 i ξ i δ i m i n m i ξ i ξ ξ i δ i m i n m i ξ ˆ i i e ε 2 i m i 8 ε 1 i δ i m i n ξ i δ i m i n m i ξ ˆ i 2 ε 2 i m i 2 ε 1 i δ i m i n ξ i δ i m i n m i ξ ˆ i 3 2 ε 2 i m i 2 ε 1 i δ i m i n ξ 2 ε 2 i m i 8 ε 1 i δ i m i n similar to 41 we have 42 1 ε 3 i ϕ i δ i m i n m i ϕ ˆ i ϕ ˆ i ϕ i δ i m i n m i ϕ ˆ i i e 2 s i υ 2 φ 1 i ε 4 i m i 8 ε 3 i δ i m i n ϕ i δ i m i n m i ϕ ˆ i 2 ε 4 i m i 2 ε 3 i δ i m i n ϕ i δ i m i n m i ϕ ˆ i 3 2 ε 4 i m i 2 ε 3 i δ i m i n ϕ i 2 ε 4 i m i 8 ε 3 i δ i m i n based on 36 37 38 41 and 42 we have 43 v 2 2 k 1 1 1 2 z e δ x y 2 2 k 3 1 1 2 ψ e 2 2 δ i min m i k 1 i 2 φ 2 i 1 δ i min m i 2 α i 2 1 1 2 i e 2 ε 2 i m i 4 ε 1 i δ i min 1 2 ξ i δ i min m i ξ ˆ i 2 ε 4 i m i 4 ε 3 i δ i min 1 2 ϕ i δ i min m i ϕ ˆ i 2 2 3 4 k 2 1 2 z e δ x y 2 3 4 2 3 4 k 4 1 2 ψ e 2 3 4 2 3 4 δ i min m i k 2 i 1 2 i e 2 3 4 2 3 4 ε 2 i m i 2 ε 1 i δ i min 1 2 ξ i δ i min m i ξ ˆ i 2 3 4 2 3 4 ε 4 i m i 2 ε 3 i δ i min 1 2 ϕ i δ i min m i ϕ ˆ i 2 3 4 ϱ 2 with ϱ 2 ε 2 i m i 2 ε 1 i δ i m i n ξ 2 ε 4 i m i 2 ε 3 i δ i m i n ϕ i 2 ε 2 i m i 8 ε 1 i δ i m i n ε 4 i m i 8 ε 3 i δ i m i n φ 1 i φ 2 i the following inequality can be obtained 44 v 2 β 1 v 2 β 2 v 2 3 4 ϱ 2 where β 1 min 2 k 1 1 2 k 3 1 2 δ i m i n m i k 1 i 2 φ 2 i 1 δ i m i n m i 2 α i 2 1 ε 2 i m i 4 ε 1 i δ i m i n ε 4 i m i 4 ε 3 i δ i m i n β 2 min 2 3 4 k 2 2 3 4 k 4 2 3 4 δ i m i n m i k 2 i 2 3 4 ε 2 i m i 2 ε 1 i δ i m i n 2 3 4 ε 4 i m i 2 ε 3 i δ i m i n according to lemma 3 all the signals in the closed loop system can converge into a disc region of origin 2 min ϱ 2 1 γ 2 β 1 ϱ 2 1 γ 2 β 2 1 4 in finite time t 2 max 4 γ 2 β 1 ln γ 2 β 1 v 1 4 χ 0 β 2 β 2 4 β 1 ln β 1 v 1 4 χ 0 γ 2 β 2 γ 2 β 2 where 0 γ 2 1 χ z e ψ e u e r e the convergence region is with the radius min 2 ϱ 2 1 γ 2 β 1 2 ϱ 2 1 γ 2 β 2 1 4 thus all the signals in the closed loop system is pfs this completes the proof remark 4 the proposed nn based formation tracking algorithm is with two main advantages 1 benefit by the fractional power the finite time convergence of the closed loop system is achieved this is different from the result in yu et al 2018 where semi global uniform ultimate boundedness is obtained 2 the adaptive law is developed to estimate the upper bound of the weight matrix w i t rather than tune the whole weight matrix w i t which result in smaller computation load in the proposed algorithm and this could facilitate the implementation of the proposed algorithm in practical engineering 4 numerical simulations in this section numerical simulations are performed to verify the effectiveness of the proposed velocity adjusting algorithm 13 14 and the adaptive finite time formation tracking controller 32 33 for multiple underactuated vessels the formation system which consists of leader and followers is considered the cybership ii l 1 255m b 0 29m is selected as the control plant for each follower roger skjetne 2004 motivated by the jonswap wave spectrums and norsok wind spectrum fossen 2011 the simulated ocean disturbance is constructed to model the real sea state which is induced by the sea wind and irregular wind generated waves the 6th level sea state the average velocity of wind v wind 15 7 m s the wind direction ψ wind 160 is considered as the environmental disturbance fig 3 shows the 3d view of the simulated ocean disturbance as for the nonlinear terms f u υ f r υ 25 neurons are applied for each nn the width of the gaussian function is h i 3 i 1 2 ł with centers spaced in 10 m s 10 m s for surge velocity u 2 5 rad s 2 5 rad s for the yaw velocity r 4 1 closed loop performance the formation of five underactuated surface vessels is considered i e the leader the follower 1 the follower 2 the follower 3 and the follower 4 the geometric formation is constructed as a straight line and the desired leader follower configuration is set as ρ d 1 ρ d 2 40 m ρ d 3 ρ d 4 80 m λ d 1 λ d 3 π 2 rad λ d 2 λ d 4 π 2 rad initial states of the leader is selected as η l 0 m 0 m 0 rad υ l 0 m s 0 m s 0 rad s the yaw angle of the leader r l satisfies the following condition r l 0 rad s 0 s t 40 s π 50 rad s 40 s t 50 s 0 rad s 50 s t 70 s π 33 rad s 70 s t 80 s 0 rad s 80 s t 200 s for follower 1 follower 2 follower 3 and follower 4 initial states are chosen as η 1 0 m 40 m π 8 rad υ 1 0 m s 0 m s 0 rad s η 2 0 m 40 m π 8 rad υ 2 0 m s 0 m s 0 rad s η 3 10 m 80 m π 6 rad υ 3 0 m s 0 m s 0 rad s η 4 10 m 80 m π 6 rad υ 4 0 m s 0 m s 0 rad s for the velocity adjusting algorithm 13 14 design parameters are chosen as k 1 diag 1 1 1 k 2 diag 1 1 1 λ 1 1 σ e 1 k v 1 initial value of the adaptive parameter for the leader velocity is chosen as υ ˆ m 0 0 for the adaptive finite time formation controller 32 33 main design parameters are chosen as k 1 1 5 k 2 1 2 k 3 4 k u 1 18 k r 1 12 ε 1 u ε 1 r 0 1 ε 2 u ε 2 r 0 6 ε 3 u ε 3 r 8 ε 4 u ε 4 r 3 initial value of adaptive parameters for the formation tracking controller are chosen as ξ ˆ u 0 ξ ˆ r 0 0 ϕ ˆ u 0 ϕ ˆ r 0 0 the control gain uncertainty is chosen as g u g r 0 85 for actuator faults the following model is considered 45 t i 1 t μ i τ i t 3 h 3 h 1 t i 2 t τ i t 3 h 3 h 1 h 1 3 i u r the actuator faults model 45 indicates that the actuator of followers encounter partial loss of effectiveness every 3 s and then runs normally for the next 3 s meanwhile the actuator of followers also undergoes stuck faults every 3 s and then runs normally for the next 3 s the parameters of actuator faults are chosen as μ u μ r 0 8 τ u 15 n τ r 10 n m fig 4 shows the formation trajectory of multiple followers under the proposed algorithm we learn that the desired straight line formation can be constructed and maintained by 4 followers and one leader successfully fig 5 shows the tracking errors of virtual vessels where e 1 e 2 e 3 denote the tracking error in surge sway and yaw direction respectively velocities of virtual vessels and their adaptive parameters can be seen in fig 6 fig 7 we can see that the velocities synchronization of virtual vessels can be achieved under proposed algorithm eqs 13 and 14 tracking errors of followers are shown in fig 8 we can learn that tracking errors of 4 followers all converge to the small neighborhood of origin desired control inputs of each follower are shown in fig 9 although effected by environmental disturbances actuator faults control gain uncertainty and model uncertainty the convergence of control signals are guaranteed under proposed algorithm the results of parameter adaptation are shown in fig 10 fig 11 we can learn that each adaptive parameter converge under proposed adaptive law 4 2 comparison study in order to further evaluate the performance of the proposed adaptive finite time fault tolerant control afftc algorithm a comparison with result under the disturbance observer based control dobc algorithm in yu et al 2018 is presented for the purpose of simplicity one single pair of leader follower vessels is considered where the leader is assigned to track a trajectory which consists of straight line and curve the desired distance between the leader and follower is set as ρ d 40 m the desired bearing angle with respect to the leader is set as λ d π 2 rad initial states of the leader is selected as η l 0 m 0 m 0 rad υ l 0 m s 0 m s 0 rad s the yaw angle velocity r l of the leader satisfies that r l 0 rad s when 0 s t 30 s and r l 50 π rad s when 30 s t 200 s initial states of follower is selected as η 1 25 m 50 m 0 rad s υ 1 0 m s 0 m s 0 rad s the design parameters are taken as in subsection 4 1 the same conditions are also considered for the dobc in yu et al 2018 comparative results are shown in fig 12 fig 13 from fig 12 we can learn that the follower can track the reference trajectory under control algorithm in fig 13 however it can be seen that the convergence rate of the afftc is faster than that dobc meanwhile the convergence region of tracking errors under the afttc is smaller than that dobc 46 mae 1 t f t 0 t 0 t f e t dt mai 1 t f t 0 t 0 t f τ t dt mtv 1 t f t 0 t 0 t f τ t 1 τ t dt to further verify the comparison result quantity analysis are performed by introducing popular performance indexes e g mean absolute error mae mean absolute control inputs mai and mean total variation mtv mae denotes the stability performance of the control plant mai and mtv are employed to describe the energy consumption table 1 shows the quantitative result of the three performance indexes we can learn that the proposed afftc algorithm is with better tracking performance than the dobc 5 conclusions in this paper a novel leader follower control algorithm with actuator faults has been proposed for multiple underactuated surface vessels the velocity information of the leader is assumed unavailable for the leader follower configuration virtual vessels are introduced to track the reference trajectory of the leader by fusion of nn and fractional power techniques model uncertainty is addressed and finite time convergence is achieved a concise adaptive law is developed to compensate the upper bounded of nn and lump disturbance which includes the approximation error of nn environmental disturbance control gain uncertainty and actuator faults that could reduce the calculation load and facilitate the implementation of the algorithm in practical engineering all signals in the closed loop system are proved to be practical finite time stable by lyapunov theory future research would consider the decentralized leader follower formation control that save the communication resource between the inter vehicle of the formation credit authorship contribution statement chenfeng huang conceptualization methodology software writing original draft preperation xianku zhang supervision writing review editing guoqing zhang visualization investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is partially supported by the national science foundation of china no 51679024 51909018 the fundamental research funds for the central university no 3132019501 3132019502 the national high technology research and development program of china no 2015aa016404 the university 111 project of china no b08046 the doctoral scientific research foundation of liaoning province grant no 20170520189 the doctoral innovation program of dalian maritime university no bscxxm001 the authors wold like to thank anonymous reviewers for their valuable comments to improve the quality of this article 
21044,this paper proposes a novel neural finite time formation control algorithm for multiple underactuated surface vessels with actuator faults in the algorithm the leader follower formation problem is formulated as a two stage tracking problem first to address the leader follower configuration without the information of leader velocity the virtual vessel is designed to track the reference trajectory of the leader second an adaptive finite time fault tolerant control afftc algorithm is presented for the follower to track the virtual vessel by fusion of the neural network nn and the fractional power the model uncertainty is approximated and the finite time convergence is obtained furthermore a concise adaptive law is developed to compensate the upper bounded of nn weights and lump disturbance which include the approximation error of nn control gain uncertainty actuator faults and marine environmental disturbance on the basis of lyapunov theory stability analysis proves that all the signals in the closed loop system are practical finite time stable finally numerical simulations are performed to demonstrate the performance and superiority of the proposed algorithm keywords underactuated surface vessels formation control neural network fault tolerant control finite time control 1 introduction in the past two decades interest in formation control of multiple marine surface vehicles has attracted extensive concern successful applications can be found in diverse scenarios and challenging tasks including ocean resource surveys maritime patrol surveillance maritime search and rescue such tasks usually can not be accomplished by a single vessel even with advanced equipments since it has limited operation range and fault tolerant capability to achieve the formation control various approaches have been developed e g virtual structure beard jr and hadaegh 2001 sadowska van den broek huijberts and van de wouw 2011 leader follower consolini et al 2008 behavior based balch and arkin 1999 and so on among these approaches the leader follower strategy is more popular in practical engineering due to its reliability and simplicity many results about the leader follower formation control can be seen in the literatures cui et al 2009 fahimi 2007 dai et al 2019 he et al 2019 currently there are several challenges with relation to leader follower formation control still worth investigating by researchers two of which will be addressed in this paper the first challenge is relation to the inter vehicle communication between the leader and follower in practical engineering the position and heading angle of the leader can be easily obtained by the ship borne equipment e g dgps and gyrocompass however accurate measurement of velocity is unavailable to followers performance degradation of the closed loop system may occur when velocity of the leader is obtained from position differentiation to alleviate requirement on leader velocity a virtual vehicle approach is developed for full actuated vehicles to assist the leader follower control in kyrkjeb and pettersen 2006 similar approach is extended in ghommam et al 2013 an adaptive nn based controller was designed for follower robot with uncertain dynamics in yang zhu chen feng and guan 2020b a solution to leader follower configuration is proposed by designing an estimator only bearing measurements are involved in the formation control scheme in gao and guo 2019 yang xiao and chen 2020a a modified observer is constructed to observe the leader velocity the desired formation of multiple mobile robots is achieved with relative information although the problem of leader follower control without leader velocity is well addressed in above literatures only asymptotical stable or uniform ultimate bound results of the closed loop system are obtained which means that the desired formation will be built in infinite time period in order to improve the robustness and convergence of the system it is necessary to reconstruct the leader velocity in finite time another challenge relates to the actuator faults of marine surface vessels when ship proceeds in awful conditions e g rough sea condition lack of routine maintenance the probability of actuator faults and failures will increase greatly therefore a variety of fault tolerant control strategies are proposed by researches cui et al 2010 qin et al 2019 ning et al 2019 in gallehdari et al 2016 a distributed reconfigured control strategy is developed for multi agent systems in the presence of actuator faults and the adverse effect of the faulty agent is eliminated by hamilton jacobi bellman equations in park and yoo 2016 tracking control of underactuated surface vessel is considered the problem of actuator faults is settled via the integrated error surfaces in xuelian et al 2016 a switching controller is designed for underactuated ships with actuator faults and failures furthermore multiple controllers are developed for different cases of actuator failures in zewei et al 2018 a fault tolerant path following algorithm is presented for uncertain surface vessels both multiplicative and additive actuator faults are compensated by the nonlinear disturbance observer although the actuator faults and failures are considered in existing works fault tolerant control of the underactuated ship still is an sophisticated mechanism and need to be further investigated according to engineering practice motivated by above observations we propose a novel nn finite time leader follower control algorithm for multiple underactuated vessels with actuator faults the main contributions of this work can be summarized as follows 1 an improved adaptive velocity adjusting algorithm is designed for virtual vessels to track reference trajectories using only relative position the velocity information of the leader is estimated effectively different from conventional results the proposed approach is with advantages of fast convergence rate and high estimation accuracy 2 a novel adaptive finite time fault tolerant control afftc algorithm is proposed for followers by employing the radial basis neural network the model uncertainty is approximated and compensated furthermore a concise adaptive law is developed to compensate the upper bound of nn weights and the lump disturbance which include the approximation error of nn control gain uncertainty actuator faults and environmental disturbance 2 problem formulation and preliminaries throughout this paper denotes the absolute operator of a scalar is the euclidean norm of a vector λ min denotes the minimum eigenvalue of the matrix ˆ where ˆ is the estimation value of 2 1 radial basis function neural network in traditional control problems neural network is usually utilized as an universal approximator to approximate unknown functions thanks to the powerful approximation capacity radial basis function neural network rbf nn is selected as a good candidate the detail expression of rbf nn can be illustrated as lemma 1 lemma 1 for any given continuous function f x with f 0 0 where x ω x r q ω x is a compact set rbf nn can be used to approximate any nonlinear function f x to any arbitrary accuracy as 1 f x w s x ε x x ω x where w ω 1 ω 2 ω n denotes the ideal constant weights ε x is the bounded approximation error which ε ε where ε is the upper bound of the approximation error s x s 1 x s 2 x s l x is a vector of radial basis functions with the form of gaussian functions 2 s i x 1 2 π h i exp x ζ i 2 h i i 1 2 ł where ζ i r q denotes the center of the receptive field h i denotes the width of the gaussian function 2 2 mathematical model of underactuated surface vessels consider a group of follower vessels in the horizontal plane their mathematical models are derived from the newtonian and lagrangian mechanics fossen 1998 guoqing and xianku 2014 where the kinematics of each vessel can be described as 3 η r ψ υ where η x y ψ denotes the position vector in earth fixed plane x y is the position ψ is the yaw angle of the follower υ u v r denotes the velocity vector in body fixed plane u v r are the surge sway and yaw angular velocities respectively r ψ is the rotational matrix and can be described as r ψ cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 the dynamics of each vessel is 4 u f u υ g u m u t u 1 m u d w u v f v υ 1 m v d w v r f r υ g r m r t r 1 m r d w r with f u υ m v m u v r d u 1 m u u d u 2 m u u u d u 3 m u u 3 f v υ m u m v u r d v 1 m v v d v 2 m v v v d v 3 m v v 3 f r υ m u m v m r u v d r 1 m r r d r 2 m r r r d r 3 m r r 3 where m u m v m r are inertia coefficients d w u d w v d w r are bounded environmental disturbance induced by wind wave and current d i 1 d i 2 d i 3 i u v r are the hydrodynamic damping and nonlinear damping terms g u g r denote the unknown control gain function t u t r are control inputs in surge and yaw directions respectively which are subject to actuator faults and failures generally there are multiplicative and additive actuator faults considered in the existing works which can be formulated as 5 t u μ u τ u τ u t r μ r τ r τ r where τ u τ r are the desired control force and moment produced by the propeller and rudder respectively μ u μ r denote the multiplicative actuator faults and τ u τ r denote the additive actuator faults if no actuator faults occurs we have μ u μ r 1 τ u τ r 0 the general structure of leader follower formation can be seen in fig 1 define the position vector of the leader as η l x l y l ψ l the velocity vector of leader as υ l u l v l ψ l the angle between the leader and follower is λ the distance between the leader and the follower can be formulated as 6 ρ x l x 2 y l y 2 assumption 1 the sway velocity of each underactuated vessel is passive bounded furthermore the velocity vector υ l of the leader is bounded by positive constant υ m assumption 2 a the product of the control gain functions g u g r and the multiplicative faults μ u μ r are with lower bound g u μ u δ u m i n g r μ r δ r m i n b for the time varying environmental disturbance d w u d w v d w r there exist unknown positive constants d w u d w v d w r such that d w u d w u d w v d w v d w r d w r lemma 2 chen et al 2011 for any σ 0 and χ r the following inequality always holds 7 0 χ χ tanh χ σ k p σ k p 0 2785 lemma 3 yu yu shirinzadeh and man 2011 consider the system x f x suppose v x is a positive definite function with v 0 0 for any real numbers ϖ 1 ϖ 2 0 0 p 1 and ϱ 0 such that 8 v x ϖ 1 v x ϖ 2 v p x ϱ then the system x f x is a practical finite time stable pfs system with residual set min ϱ 1 γ ϖ 1 ϱ 1 γ ϖ 2 1 p of the solution where 0 γ 1 the settling time is estimated by 9 t m a x 1 γ ϖ 1 1 p ln γ ϖ 1 v 1 p x 0 ϖ 2 ϖ 2 1 ϖ 1 1 p ln ϖ 1 v 1 p x 0 γ ϖ 2 γ ϖ 2 remark 1 in assumption 1 since the sway motion is dominated and damped out by the hydrodynamic force the sway dynamics of the underactuated vessel is passive boundedness the assumption is in line with the practical engineering and has been systematically analyzed in jihong et al 2008 meanwhile the vecolity of the leader is also subject to the hydrodynamic damping force and mechanical constraint when proceeding on the sea the surge speed is finite in practice control objective design an adaptive finite time fault tolerant controller τ u τ r for the follower underactuated vessels without the velocity of the leader such that all followers can track their reference trajectories and maintain the desired formation with model uncertainty environmental disturbance control gain uncertainty and actuator faults 3 formation controller design the procedure of controller design is two fold first in order to achieve desired geometric formation an improved adaptive velocity adjusting algorithm is designed for the virtual vessel without using the velocity information of the leader second a novel afftc is proposed for the follower to track the virtual vessel by employing the nn technique the model uncertainty is approximated a concise adaptive law is developed to compensate the lump disturbance which consists of the upper bound of environmental disturbance approximation error of nn control gain uncertainty and actuator faults 3 1 leader follower formation set up in this subsection the virtual vessel is introduced to track the reference position η r which generated by shifting the position of the leader η l with desired distance ρ d and desired angle λ d to address the leader follower configuration an improved adaptive velocity adjusting algorithm is presented for virtual vessel with no need of the leader velocity in earth fixed plane the reference position can be derived as 10 η r η l r ψ l l where l ρ d cos λ d ρ d sin λ d 0 similar to 3 the following equation can be derived 11 η r r ψ l υ r from 10 11 we can see that the desired geometric pattern can be built and maintained when followers move along the reference position η r with reference velocity υ r note that υ r contains the velocity information of the leader considering the practical engineering only the position and yaw angle of the leader can be obtained by followers directly hence the virtual vessel is introduced to assist in the construction of leader follower configuration define position vector of the virtual vessel as η v x v y v ψ v then 12 η v r ψ v υ v where υ v u v v v r v denotes the velocity vector of the virtual vessel define the position error as η e η r η v by assumption 1 there exists a positive constant υ m such that υ r 2 υ m to guarantee that the virtual vessel is capable to track the reference position in finite time the velocity adjusting algorithm is designed as 13 υ v r ψ v k 1 η e k 2 sig 1 2 η e υ ˆ m tanh η e σ e where k 1 k 2 r 3 3 are positive design matrices σ e is a positive design constant sig 1 2 η e sign η e η e 1 2 sign η e 1 η e 1 1 2 sign η e 2 η e 2 1 2 sign η e 3 η e 3 1 2 υ ˆ m is a adaptive parameter for υ m and υ ˆ m is updated by 14 υ ˆ m λ 1 η e tanh η e σ e k v υ ˆ m where λ 1 k v are positive design constants theorem 1 under assumption 1 consider the dynamics of the virtual vessel 12 the velocity adjusting algorithm 13 and the adaptive law 14 for any bounded initial states the virtual vessel is capable to track the reference position in finite time proof select the lyapunov candidate as follows 15 v 1 1 2 η e η e 1 2 λ 1 υ m 2 differentiating v 1 with respect to time 16 v 1 η e η e 1 λ 1 υ m υ ˆ m according to 11 12 13 and lemma1 2 we have 17 η e η e η e υ m η e r ψ v υ v 0 275 σ e υ m υ m η e tanh η e σ e η e k 1 η e k 2 η e 3 2 υ ˆ m η e tanh η e σ e λ min k 1 η e 2 λ min k 2 η e 3 2 υ m η e tanh η e σ e 0 275 σ e υ m in the light of 14 the following equation can be derived 18 1 λ 1 υ m υ ˆ υ m η e tanh η e σ e k v υ m υ ˆ m and the term k v υ m υ ˆ m can be transformed into 19 k v υ m υ ˆ m k v 2 υ m 2 k v 2 υ m 2 k v 8 υ m 2 k v 2 υ m 3 2 k v 8 k v 2 υ m 2 from 16 17 18 19 we have 20 v 1 λ min k 1 η e 2 k v 8 υ m 2 λ min k 2 η e 3 2 k v 2 υ m 3 2 ϱ 1 2 λ min k 1 1 2 η e 2 k v λ 1 4 1 2 λ 1 υ m 2 2 3 4 λ min k 2 1 2 η e 2 3 4 k v λ 1 3 2 1 4 1 2 λ 1 υ m 2 3 4 ϱ 1 with ϱ 1 0 275 σ e υ m k v 8 k v 2 υ m 2 then we have 21 v 1 α 1 v 1 α 2 v 1 3 4 ϱ 1 where α 1 min 2 λ min k 1 k v λ 1 4 α 2 min 2 3 4 λ min k 1 k v λ 1 3 2 1 4 based on lemma 3 the error signals η e υ m can converge into the region 1 min ϱ 1 1 γ 1 α 1 ϱ 1 1 γ 1 α 2 1 4 in finite time the settling time can be calculated by t 1 max 4 γ 1 α 1 ln γ 1 α 1 v 1 4 η e 0 υ m 0 α 2 α 2 4 α 1 ln α 1 v 1 4 η e 0 υ m 0 γ 1 α 2 γ 1 α 2 where 0 γ 1 1 the region is with the radius min 2 ϱ 1 1 γ 2 α 1 2 ϱ 1 1 γ 2 α 2 therefore all the signals in the closed loop system is pfs this completes the proof of theorem 1 remark 2 compared with the leader follower control scheme in cui et al 2010 there are two main advantages in proposed algorithm 1 the fractional power is introduced to program the velocity of the virtual vessel in 13 which guarantee that the virtual vessel could track the reference position in finite time 2 a concise adaptive law is designed to estimate the upper bound of reference velocity this facilitate the leader follower formation control without using the information of leader velocity 3 2 nn based formation tracking control this subsection aims to solve the problem of formation tracking control i e design a novel algorithm for each follower to track the position of the virtual vessel fig 2 shows the principle of formation tracking procedure in the proposed algorithm the rbf nn is employed to approximate and compensate the model uncertainty of followers the fractional power is introduced to obtain the finite time convergence of tracking controller furthermore a concise adaptive law is presented to estimate the upper bound of nn weights and lump disturbance the design of the formation tracking controller are divided into two steps as follows step 1 define the tracking errors of the virtual vessel and the follower 22 x e x v x y e y v y ψ e ψ d ψ where ψ d is the azimuth angle of follower relative to the virtual vessel and can be described as 23 ψ d 0 5 1 sgn x e sgn y e π arctan y e x e z e 0 ψ v z e 0 the distance between the virtual vessel and the follower vessel is 24 z e x e 2 y e 2 from fig 2 it can be seen that 25 x e z e cos ψ d y e z e sin ψ d according to 3 22 and 25 we have 26 z e x v cos ψ d y v sin ψ d u cos ψ e v sin ψ e ψ e ψ d r design the virtual controllers α u α r for u and r 27 α u cos ψ e 1 x v cos ψ d y v sin ψ d v sin ψ d k 1 z e σ x y k 2 sig 1 2 z e σ x y α r k 3 ψ e k 4 sig 1 2 ψ e ψ d where k 1 k 2 k 3 k 4 are all positive design constants δ x y is a small positive constant and is introduced to guarantee that the follower is always behind the virtual vessel also it is necessary to note that there is no definition for α u when ψ e π 2 thus the condition ψ e π 2 should be guaranteed in practical engineering 28 ψ e ψ e π ψ e 0 5 π ψ e 0 5 π ψ e 0 5 π ψ e π ψ e 0 5 π step 2 let i e i α i i u r taking the time derivative of i e we have 29 i e f i υ g i m i t i 1 m i d w i α i since the detail information about f i υ is difficult to be obtained rbf nn is employed to approximate the unknown part as follows 30 f i υ w i t s i υ ε i eq 29 can be rewritten as 31 i e w i t s i υ ε i g i m i t i 1 m i d w i α i design the formation tracking controllers for followers as 32 τ i k i 1 i e k i 2 sig 1 2 i e α i ξ ˆ i i e s i υ 2 φ 1 i ϕ ˆ i where k i 1 k i 2 φ 1 i are all positive design constants sig i e 1 2 sign i e i e 1 2 α i can be obtained by using the differential filer s t d s 1 instead of analytical calculation where t d is a time constant e g t d 0 01 s such calculation is common in control engineering the adaptive law are developed as 33 ξ ˆ i ε 1 i i e ε 2 i ξ ˆ i ϕ ˆ i ε 3 i i e 2 s i υ 2 φ 1 i ε 4 i ϕ ˆ i where ε 1 i ε 2 i ε 3 i ε 4 i are positive design constants remark 3 note that the nn approximation in 30 is an extension of that in guoqing and xianku 2014 since the coupled states is included in f i υ the strong coupling of ship dynamics can be addressed directly such design can also simply the design of the nn based formation tracking controller theorem 2 under assumption 1 2 consider the ship dynamics of follower vessels 3 4 with actuator faults 5 formation tracking controller 32 and the adaptive law 33 for any bounded initial states the follower can tack the virtual vessel in finite time with model uncertainty environmental disturbance control gain uncertainty and actuator faults proof consider the following lyapunov candidate 34 v 2 z e δ x y 2 ψ e 2 1 2 i i r i e 2 1 2 i u r m i δ i m i n ε 1 i ξ i δ i m i n m i ξ ˆ i 2 1 2 i i r m i δ i m i n ε 3 i ϕ i δ i m i n m i ϕ ˆ i 2 where ξ i sup t 0 i ω i ε i g i τ i m i d w i m i ϕ i sup t 0 i ω i w i 2 differentiating v 2 with respect to time 35 v 2 z e σ x y z e ψ e ψ e i u r i e i e i u r 1 ε 1 i ξ i δ i m i n m i ξ i ˆ i u r 1 ε 3 i ϕ i δ i m i n m i ϕ ˆ i ϕ ˆ i according to 26 27 and young s inequality the following equation can be derived 36 z e δ x y z e z e δ x y u e cos ψ e k 1 z e δ x y k 2 sig 1 2 z e δ x y k 1 1 2 z e δ x y 2 k 2 z e δ x y 3 2 1 2 u e 2 and the term ψ e ψ e is transformed into 37 ψ e ψ e ψ e k 3 ψ e k 4 sig 1 2 ψ e r e k 3 1 2 ψ e 2 k 4 ψ e 3 2 1 2 r e 2 substituting 5 32 into 31 we have 38 i e i e i e w i s i υ i e α i i e ε i g i τ i m i d w i m i i e g i μ i τ i m i i e ϕ i s i υ i e α i i e ξ i i e δ i min τ i m i δ i min m i k i 1 i e 2 δ i min m i k 2 i i e 3 2 1 δ i min m i α i e ξ i δ i min m i ξ ˆ i i e ϕ i δ i min m i ϕ ˆ i s i υ 2 φ 1 i i e 2 φ 1 i δ i min m i k 1 i 1 φ 2 i 1 δ i min m i 2 α i 2 i e 2 δ i min m i k 2 i i 2 3 2 ξ i δ i min m i ξ ˆ i i e ϕ i δ i min m i ϕ ˆ i s i υ 2 φ 1 i i e 2 φ 1 i φ 2 i from 33 and young s inequality we have 39 1 ε 1 i ξ i δ i m i n m i ξ ˆ i ξ ˆ ξ i δ i m i n m i ξ ˆ i i e ε 2 i ε 1 i ξ i δ i m i n m i ξ ˆ i ξ ˆ i let ξ ξ i δ i m i n m i ξ ˆ i then 40 ε 2 i ε 1 i ξ i δ i m i n m i ξ ˆ i ξ ˆ i ε 2 i m i ε 1 i δ i m i n 1 8 ξ i 2 1 2 ξ 3 2 1 2 ξ i 2 1 8 substitute 40 into 39 we have 41 1 ε 1 i ξ i δ i m i n m i ξ i ξ ξ i δ i m i n m i ξ ˆ i i e ε 2 i m i 8 ε 1 i δ i m i n ξ i δ i m i n m i ξ ˆ i 2 ε 2 i m i 2 ε 1 i δ i m i n ξ i δ i m i n m i ξ ˆ i 3 2 ε 2 i m i 2 ε 1 i δ i m i n ξ 2 ε 2 i m i 8 ε 1 i δ i m i n similar to 41 we have 42 1 ε 3 i ϕ i δ i m i n m i ϕ ˆ i ϕ ˆ i ϕ i δ i m i n m i ϕ ˆ i i e 2 s i υ 2 φ 1 i ε 4 i m i 8 ε 3 i δ i m i n ϕ i δ i m i n m i ϕ ˆ i 2 ε 4 i m i 2 ε 3 i δ i m i n ϕ i δ i m i n m i ϕ ˆ i 3 2 ε 4 i m i 2 ε 3 i δ i m i n ϕ i 2 ε 4 i m i 8 ε 3 i δ i m i n based on 36 37 38 41 and 42 we have 43 v 2 2 k 1 1 1 2 z e δ x y 2 2 k 3 1 1 2 ψ e 2 2 δ i min m i k 1 i 2 φ 2 i 1 δ i min m i 2 α i 2 1 1 2 i e 2 ε 2 i m i 4 ε 1 i δ i min 1 2 ξ i δ i min m i ξ ˆ i 2 ε 4 i m i 4 ε 3 i δ i min 1 2 ϕ i δ i min m i ϕ ˆ i 2 2 3 4 k 2 1 2 z e δ x y 2 3 4 2 3 4 k 4 1 2 ψ e 2 3 4 2 3 4 δ i min m i k 2 i 1 2 i e 2 3 4 2 3 4 ε 2 i m i 2 ε 1 i δ i min 1 2 ξ i δ i min m i ξ ˆ i 2 3 4 2 3 4 ε 4 i m i 2 ε 3 i δ i min 1 2 ϕ i δ i min m i ϕ ˆ i 2 3 4 ϱ 2 with ϱ 2 ε 2 i m i 2 ε 1 i δ i m i n ξ 2 ε 4 i m i 2 ε 3 i δ i m i n ϕ i 2 ε 2 i m i 8 ε 1 i δ i m i n ε 4 i m i 8 ε 3 i δ i m i n φ 1 i φ 2 i the following inequality can be obtained 44 v 2 β 1 v 2 β 2 v 2 3 4 ϱ 2 where β 1 min 2 k 1 1 2 k 3 1 2 δ i m i n m i k 1 i 2 φ 2 i 1 δ i m i n m i 2 α i 2 1 ε 2 i m i 4 ε 1 i δ i m i n ε 4 i m i 4 ε 3 i δ i m i n β 2 min 2 3 4 k 2 2 3 4 k 4 2 3 4 δ i m i n m i k 2 i 2 3 4 ε 2 i m i 2 ε 1 i δ i m i n 2 3 4 ε 4 i m i 2 ε 3 i δ i m i n according to lemma 3 all the signals in the closed loop system can converge into a disc region of origin 2 min ϱ 2 1 γ 2 β 1 ϱ 2 1 γ 2 β 2 1 4 in finite time t 2 max 4 γ 2 β 1 ln γ 2 β 1 v 1 4 χ 0 β 2 β 2 4 β 1 ln β 1 v 1 4 χ 0 γ 2 β 2 γ 2 β 2 where 0 γ 2 1 χ z e ψ e u e r e the convergence region is with the radius min 2 ϱ 2 1 γ 2 β 1 2 ϱ 2 1 γ 2 β 2 1 4 thus all the signals in the closed loop system is pfs this completes the proof remark 4 the proposed nn based formation tracking algorithm is with two main advantages 1 benefit by the fractional power the finite time convergence of the closed loop system is achieved this is different from the result in yu et al 2018 where semi global uniform ultimate boundedness is obtained 2 the adaptive law is developed to estimate the upper bound of the weight matrix w i t rather than tune the whole weight matrix w i t which result in smaller computation load in the proposed algorithm and this could facilitate the implementation of the proposed algorithm in practical engineering 4 numerical simulations in this section numerical simulations are performed to verify the effectiveness of the proposed velocity adjusting algorithm 13 14 and the adaptive finite time formation tracking controller 32 33 for multiple underactuated vessels the formation system which consists of leader and followers is considered the cybership ii l 1 255m b 0 29m is selected as the control plant for each follower roger skjetne 2004 motivated by the jonswap wave spectrums and norsok wind spectrum fossen 2011 the simulated ocean disturbance is constructed to model the real sea state which is induced by the sea wind and irregular wind generated waves the 6th level sea state the average velocity of wind v wind 15 7 m s the wind direction ψ wind 160 is considered as the environmental disturbance fig 3 shows the 3d view of the simulated ocean disturbance as for the nonlinear terms f u υ f r υ 25 neurons are applied for each nn the width of the gaussian function is h i 3 i 1 2 ł with centers spaced in 10 m s 10 m s for surge velocity u 2 5 rad s 2 5 rad s for the yaw velocity r 4 1 closed loop performance the formation of five underactuated surface vessels is considered i e the leader the follower 1 the follower 2 the follower 3 and the follower 4 the geometric formation is constructed as a straight line and the desired leader follower configuration is set as ρ d 1 ρ d 2 40 m ρ d 3 ρ d 4 80 m λ d 1 λ d 3 π 2 rad λ d 2 λ d 4 π 2 rad initial states of the leader is selected as η l 0 m 0 m 0 rad υ l 0 m s 0 m s 0 rad s the yaw angle of the leader r l satisfies the following condition r l 0 rad s 0 s t 40 s π 50 rad s 40 s t 50 s 0 rad s 50 s t 70 s π 33 rad s 70 s t 80 s 0 rad s 80 s t 200 s for follower 1 follower 2 follower 3 and follower 4 initial states are chosen as η 1 0 m 40 m π 8 rad υ 1 0 m s 0 m s 0 rad s η 2 0 m 40 m π 8 rad υ 2 0 m s 0 m s 0 rad s η 3 10 m 80 m π 6 rad υ 3 0 m s 0 m s 0 rad s η 4 10 m 80 m π 6 rad υ 4 0 m s 0 m s 0 rad s for the velocity adjusting algorithm 13 14 design parameters are chosen as k 1 diag 1 1 1 k 2 diag 1 1 1 λ 1 1 σ e 1 k v 1 initial value of the adaptive parameter for the leader velocity is chosen as υ ˆ m 0 0 for the adaptive finite time formation controller 32 33 main design parameters are chosen as k 1 1 5 k 2 1 2 k 3 4 k u 1 18 k r 1 12 ε 1 u ε 1 r 0 1 ε 2 u ε 2 r 0 6 ε 3 u ε 3 r 8 ε 4 u ε 4 r 3 initial value of adaptive parameters for the formation tracking controller are chosen as ξ ˆ u 0 ξ ˆ r 0 0 ϕ ˆ u 0 ϕ ˆ r 0 0 the control gain uncertainty is chosen as g u g r 0 85 for actuator faults the following model is considered 45 t i 1 t μ i τ i t 3 h 3 h 1 t i 2 t τ i t 3 h 3 h 1 h 1 3 i u r the actuator faults model 45 indicates that the actuator of followers encounter partial loss of effectiveness every 3 s and then runs normally for the next 3 s meanwhile the actuator of followers also undergoes stuck faults every 3 s and then runs normally for the next 3 s the parameters of actuator faults are chosen as μ u μ r 0 8 τ u 15 n τ r 10 n m fig 4 shows the formation trajectory of multiple followers under the proposed algorithm we learn that the desired straight line formation can be constructed and maintained by 4 followers and one leader successfully fig 5 shows the tracking errors of virtual vessels where e 1 e 2 e 3 denote the tracking error in surge sway and yaw direction respectively velocities of virtual vessels and their adaptive parameters can be seen in fig 6 fig 7 we can see that the velocities synchronization of virtual vessels can be achieved under proposed algorithm eqs 13 and 14 tracking errors of followers are shown in fig 8 we can learn that tracking errors of 4 followers all converge to the small neighborhood of origin desired control inputs of each follower are shown in fig 9 although effected by environmental disturbances actuator faults control gain uncertainty and model uncertainty the convergence of control signals are guaranteed under proposed algorithm the results of parameter adaptation are shown in fig 10 fig 11 we can learn that each adaptive parameter converge under proposed adaptive law 4 2 comparison study in order to further evaluate the performance of the proposed adaptive finite time fault tolerant control afftc algorithm a comparison with result under the disturbance observer based control dobc algorithm in yu et al 2018 is presented for the purpose of simplicity one single pair of leader follower vessels is considered where the leader is assigned to track a trajectory which consists of straight line and curve the desired distance between the leader and follower is set as ρ d 40 m the desired bearing angle with respect to the leader is set as λ d π 2 rad initial states of the leader is selected as η l 0 m 0 m 0 rad υ l 0 m s 0 m s 0 rad s the yaw angle velocity r l of the leader satisfies that r l 0 rad s when 0 s t 30 s and r l 50 π rad s when 30 s t 200 s initial states of follower is selected as η 1 25 m 50 m 0 rad s υ 1 0 m s 0 m s 0 rad s the design parameters are taken as in subsection 4 1 the same conditions are also considered for the dobc in yu et al 2018 comparative results are shown in fig 12 fig 13 from fig 12 we can learn that the follower can track the reference trajectory under control algorithm in fig 13 however it can be seen that the convergence rate of the afftc is faster than that dobc meanwhile the convergence region of tracking errors under the afttc is smaller than that dobc 46 mae 1 t f t 0 t 0 t f e t dt mai 1 t f t 0 t 0 t f τ t dt mtv 1 t f t 0 t 0 t f τ t 1 τ t dt to further verify the comparison result quantity analysis are performed by introducing popular performance indexes e g mean absolute error mae mean absolute control inputs mai and mean total variation mtv mae denotes the stability performance of the control plant mai and mtv are employed to describe the energy consumption table 1 shows the quantitative result of the three performance indexes we can learn that the proposed afftc algorithm is with better tracking performance than the dobc 5 conclusions in this paper a novel leader follower control algorithm with actuator faults has been proposed for multiple underactuated surface vessels the velocity information of the leader is assumed unavailable for the leader follower configuration virtual vessels are introduced to track the reference trajectory of the leader by fusion of nn and fractional power techniques model uncertainty is addressed and finite time convergence is achieved a concise adaptive law is developed to compensate the upper bounded of nn and lump disturbance which includes the approximation error of nn environmental disturbance control gain uncertainty and actuator faults that could reduce the calculation load and facilitate the implementation of the algorithm in practical engineering all signals in the closed loop system are proved to be practical finite time stable by lyapunov theory future research would consider the decentralized leader follower formation control that save the communication resource between the inter vehicle of the formation credit authorship contribution statement chenfeng huang conceptualization methodology software writing original draft preperation xianku zhang supervision writing review editing guoqing zhang visualization investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is partially supported by the national science foundation of china no 51679024 51909018 the fundamental research funds for the central university no 3132019501 3132019502 the national high technology research and development program of china no 2015aa016404 the university 111 project of china no b08046 the doctoral scientific research foundation of liaoning province grant no 20170520189 the doctoral innovation program of dalian maritime university no bscxxm001 the authors wold like to thank anonymous reviewers for their valuable comments to improve the quality of this article 
