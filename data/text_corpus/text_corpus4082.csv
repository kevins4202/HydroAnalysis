index,text
20410,the wave body interaction of resonant oscillating wave energy converters wecs is complex and nonlinear rapid development of wecs needs a reliable simulation tool for analysis and design procedure with the ability to capture the instantaneous nonlinear behavior this paper presents a methodology to study the behavior of a flap type wec utilizing hybrid physical and numerical simulation dynamic characteristics of the device as isolated and in an array are estimated and the time and oscillation amplitude dependency of these parameters are explained this methodology is developed for a device composed of a series of flaps placed on a vertical breakwater however the developed algorithm can be updated for any other wec concept with special consideration on the consequent changes in the load transfer surrounding hydrodynamic and wave structure interaction this paper increases our understanding and knowledge of all involved phenomena and their direct effects on the natural period and the response and can be used for tunning dynamic characteristics of wec device to incoming waves finally the developed numerical model is used for the simulation of the wec to different wave loads and the results are validated with the experimental tests keywords wave energy converter numerical simulation experimental tests nonlinear dynamic analysis wave structure interaction 1 introduction in recent years there has been great attention to renewable energy development to meet increasing electricity demands in a sustainable and clean way zhu et al 2020 this trend even can be seen in countries with a strong dependency on the fossil fuels market bouraiou et al 2020 jahangir et al 2020 or with a tendency to use nuclear power bragg sitton et al 2020 wave energy receives attention among various sources of renewable energy karimirad 2014 mainly because wave climate resources can be relatively well predicted corsatea et al 2014 mofor et al 2014 consequently there has been continuous progress toward commercialization in the wave energy industry over the last years previsic 2012 in the commercialization process wec array implementation would be necessary for widespread wave energy extraction correia da fonseca et al 2016 however the performance and the behavior of a device in an array are affected by the presence of other bodies correia da fonseca et al 2016 lópez ruiz et al 2018 thiruvenkatasamy and neelamani 1997 the commercialization and development of each wec needs a good understanding of the device s performance as isolated or in an array the type of wec device and its required operational conditions a thorough understanding of wec behavior can be achieved by full scale tests however this involves lots of limitations and functional difficulties these limitations encourage the industry to use numerical simulation tools or develop small scale laboratory models representing the behavior of the device in real conditions e g saeidtehrani 2016 saeidtehrani et al 2017 considerable research efforts focus on the acceptability and accurate usage of experimental tests e g kamarlouei et al 2020 sheng et al 2014 and examining the existent numerical tools and development of new simulation models for wec devices babarit et al 2012 folley 2016 sheng 2019 the classical approach for numerical modeling should consider the hydrodynamics around the converter and the dynamics of the body evans 1983 mei 1976 2012 the wave body interaction problem is complex and highly nonlinear e g saeidtehrani et al 2017 however under special situations it is possible to make some simplifications folley 2016 the common approach is using potential flow theory for the hydrodynamic model coupled with a mass spring damper system for the body motion some mathematical models include another damping term to simulate the nonlinearities and viscous effects babarit et al 2012 xu et al 2019 the hydrodynamic model can be simulated in frequency or time domains babarit et al 2012 babarit and delhommeau 2015 lee 1995 most of the methods apart from being frequency or time dependent use some coefficients such as added mass or radiation damping for representing the hydrodynamic of wecs which could only simulate the steady state motion faedo et al 2020 saeidtehrani et al 2019 although some researches have been carried out on the performance of wec device in an array erselcan and kükner 2017 lópez ruiz et al 2018 tomey bozo et al 2019 little is known about the interdependency of wecs to each other s performance and wave structure interaction in terms of variable time dependent fluid pressure around each device due to the presence of other bodies this paper aims to provide a reliable tool and methodology to study the behavior of a flap type wec with a combination of numerical and physical modeling the device is composed of five flaps placed on a breakwater as it was patented by the university of rome tor vergata michele et al 2015 michele et al 2016 michele et al 2016 sammarco et al 2013 it should be emphasized what makes the wave structure problem in this project even more complicated is a multipurpose structure of an array of flaps and the breakwater the numerical model uses the time domain interdependency of the flow to the dynamic motion of the flaps therefore it could grab instantaneous change in the fluid due to the rapid motion of the wec devices dynamic equation consists of a nonlinear term for the simulation of nonlinear period dependent phenomena here by a hybrid physical and numerical simulation the required parameters to represent different sources of damping are calculated more details by using the mathematical descriptions and flow charts are provided in the following sections this paper granularly develops the numerical model by using experimental measurements and is organized as follows a case study geometry and designed experimental tests are presented in the second section the methodology for developing numerical simulation is described in detail through section 3 final remarks and discussions are dedicated to the experimental simulation and validation of the numerical model with the experimental results under the action of waves a detailed investigation is also provided for the interdependency of flaps behavior in an array nonlinearity of wave structure interaction and the possibility to amplify the wecs response by estimation and usage of dynamic characteristics 1 1 device structure geometry and experimental tests a flap type device composed of five flaps placed on a breakwater as it was patented by the university of rome tor vergata michele et al 2015 michele et al 2016 michele et al 2016 sammarco et al 2013 is selected for this study experimental tests have been designed to study the dynamic response of the flaps by performing free oscillation dry tests decay tests in water and testing the flaps behavior under wave action the primary tests are proposed and conducted to extract wave structure dynamic characteristics the last set of experiments are conducted to validate the numerical results a 1 40 scale model of a flap type wec device has been constructed and tested in the laboratory of roma tre university saeidtehrani 2016 where five flaps are arranged on a caisson type vertical breakwater sammarco et al 2015 the flaps are hinged to the seaward horizontal surface of the breakwater photographic views of the structure are shown in fig 1 note that the flaps are leaned back on the breakwater vertical wall in the absence of water saeidtehrani 2016 the proposed flap has the dimension of 0 0725 x 0 050 x 0 043 m the exact dimensions of the small scale physical model after construction with 1 2 mm tolerance and its set up in the flume is shown in fig 2 saeidtehrani 2016 the five flaps are also numbered in this figure the device is originally proposed for the port of piombino in southern tuscany sammarco et al 2016 considering the average 12 m water depth the still water level swl in front of the breakwater for the scaled model was assumed 0 30 m in which 0 05 m of the flap height was underwater the first two sets of experiments have been carried out to study the behavior of the flaps without the presence of an external force i e wave action the concept of both experiments is to apply energy to the system and study how the system reacts free decay tests in these experiments the energy is applied by imposing an initial displacement to each flap and tracking its motion the period of one complete oscillation i e the natural period can be extracted from the time series responses it also shows how much energy is lost in the system due to the presence of dissipative forces i e friction of hinges or the energy used to displace water with the flap radiation damping or the drag effects in the first set the experiments have been done without the presence of water in the air hereafter it is called free oscillation dry test wec systems are multidisciplinary in nature and a deep understanding of the behavior need considering all phenomena involved including soil structure environmental load interaction here the flaps are directly mounted on the caisson therefore soil characteristics don t come into account however the attachment to the caisson is important to be considered as it will be shown this connection is one of the damping and stiffness sources of the system the second group of experiments has been performed in a wave flume the decay tests in water this group studies the wave structure interaction without the presence of wave loads the last series of experiments deals with studying the response of the flaps to the wave action the following sections describe the results of the experimental testing each set of experiments have been repeated at least five times to be sure about the accuracy of the results during the experiments the rotation of each flap was tracked by an allied vision gige camera a red point was marked at the center of the top surface of each flap to track the motion in each frame of the recorded video the marker on the flap has a radius of 15 pixels which provides enough accuracy to track the position of the flap in each video image 1920 x 1080 pixel resolution the length and width of the flaps are used as a reference length for the video processing in order to provide enough resolution in time and accurately describe the flap s motion it is necessary to set up a frame rate that could be well estimated by considering the rate of the minimum incoming wave period and the natural period of the flap because these two periods are dominant in the flap s response oscillation the minimum incoming wave period during the experiments was 0 30 s which is less than the natural period of the flaps more details about the calculation of the natural period are provided in the following sections therefore the frame rate has been selected to be 30 per second to capture a minimum of 9 frames to describe a full cycle of the flap motion to the wave with the minimum period by increasing the period of the incoming wave to 1 s there are 30 frames to describe the whole cycle of a flap s motion period based selection of frame rates could help us to not lose any important change in a cycle or misinterpret the time series response 1 2 free oscillation dry tests this section presents the experimental study of the free oscillation dry tests to characterize the damping caused by friction of hinges for each test the device was set upside down to give the flap freedom to rotate like a pendulum see fig 3 an initial displacement was applied to each flap separately and then it was released to move freely until it stops as explained earlier the movement of the flaps is recorded by the camera an image processing algorithm was developed in matlab matlab 2019 to analyse and locate the markers of the moving flaps frame by frame of the video the camera was placed on the ground such that it was looking up to the device the placement of the device the camera and some sample frames of the video are shown in fig 3 for further information see saeidtehrani 2016 videos were processed to map the pixels of each frame to a reference coordinate system and detect the location of the marker the length and width of the flaps were used as a reference length to map pixels to the coordinates of the flaps the marker position time series were converted to a roll angle time series as it is expected the rotation should have a pattern of free decay oscillation of under critically damped systems e g clough and penzien 1993 jia 2014 in which the amplitude of oscillation is decreasing with time because of the damping effect i e friction at the hinge fig 4 shows a schematic free oscillation response of under critically damped system θ ˆ is the amplitude of the flap rotation and td is the damped natural period of oscillation this time series free oscillation response of under critically damped system can be mathematically described as follows brebbia and walker 1979 clough and penzien 1993 1 m θ c θ k θ 0 m c and k are mass damping and stiffness coefficients respectively θ is the flap angle of rotation θ θ are its first and second time derivatives it is important to stress that putting the device upside down and out of the water make the dynamic system completely different in which its mass and stiffness are not the same as the mass and stiffness due to wave structure interaction therefore m and k for the flap acting like a pendulum and without the presence of water are calculated analytically e g zonetti et al 1999 and are used for calculation of the damping due to the friction of hinges the extracted damping coefficient can be later used for simulating the damping effect of hinges in the numerical model sections 3 1 and 4 5 1 3 decay tests in water in the second set of tests the device was placed in a glass flume 9 m long 0 27 m wide and 0 5 m deep with transparent walls the water depth in this experiment was 30 cm the device was placed approximately 4 m from the wave maker which is located at one of the flume ends see fig 5 four wave gauges wg were placed in the flume to measure the surface elevation at different positions between the wave maker and the device the camera was installed above the breakwater fig 6 shows the placement of the camera and wgs in the flume further details can be found in saeidtehrani 2016 during the decay tests in water each flap was initially rotated so that the flap was held in the maximum rotation on one side and then released to freely oscillate it is expected that the rotation time series has a decay pattern however due to the interference of flaps and the presence of the breakwater it doesn t completely fit with a classic decay pattern in which the amplitude of oscillation is decreasing to almost zero with time by releasing a flap from its initial position it starts to oscillate and its motion generates waves as expected and after a while the wave which is radiated from a moving flap propagates to the breakwater and after a fraction of time returns to all flaps therefore all flaps start to oscillate and in turn affect the pressure field the movement of one flap causes that other flaps start to move hereafter there will be five flaps that change the pressure field around and again waves are going towards the breakwater and coming back to the flaps as a result there is a continuous change in the pressure field around each flap and all the wave interference affects the period of the oscillation and the phase difference between the flaps rotation so the mathematical model should correlate the flaps dynamic motion to the simultaneous change in the pressure field as it will be explained in the mathematical background section 3 1 1 4 response to wave action the last set of experimental testing was performed to study the behavior of the flaps under regular wave action the device was placed in the flume using the same instruments and following the same procedure as has been used for the decay tests in water waves with equal height and different periods were generated and the motions of the flaps were recorded by the camera for each flap the amplitude of the rotation in both directions seaward and shoreward have been extracted from the video time series and then the rms of this amplitude is calculated 2 θ ˆ r m s 1 m i 1 m θ ˆ i 2 where θ ˆ is the positive or negative amplitudes of the flap rotation seaward and shoreward respectively m is the number of maxima and rms stands for the root mean square it is worth noting that due to the expected large oscillations e g retes et al 2015 nonlinear behavior of the flaps e g saeidtehrani 2016 sammarco et al 1997 and the period dependency of the response the rms is selected for representing the response amplitude since other representations such as the response amplitude operator rao are normally valid for the linear motion of the floating bodies e g chakrabarti 1987 karimirad 2014 2 numerical simulation in this section the development of the numerical simulation is presented the numerical simulation has been performed using comsol and matlab introduction to comsol multiphysics 2014 matlab 2019 multiphysics 2016 the first part of this section is dedicated to the mathematical model describing the behavior of flaps in water throughout the second part the calculation of the drag coefficient another source of damping of an oscillating body in a fluid is outlined for the simulation of damping different models from viscous proportional to velocity and hysteresis or fluid proportional to the square of the velocity or as it called quadratic damping can be used e g chakrabarti 1994 jia 2014 the mechanical damping and the drag coefficients coefficient of quadratic damping term are used as an approximation for the loss of energy and cannot be calculated mathematically due to the difficulties in the mathematical description of the physical mechanisms adhikari 2000 in this study mechanical damping is directly extracted from the free oscillation dry tests and the drag coefficient is calculated utilizing hybrid physical numerical simulation the required steps for this methodology is described in more detail in section 3 2 then the mechanical damping and the drag coefficient are used in the simulation model to reproduce the response of the flaps to the wave action 2 1 theory and mathematical background this section presents the mathematical model of wave body interaction based on newton s second law the forces acting on the wec must be in balance with the inertial force falnes 2002 mei et al 2005 the force on the flap can be estimated from the pressure consists of hydrostatic and dynamic terms as described by linearized first order bernoulli equation e g svendsen 2006 3 p ρ g z ρ ϕ t from the conservation of angular momentum and substituting the pressure p on the body the resultant equation can be written for one degree of freedom i e the rotation of the flap e g e renzi a abdolali and dias 2012 sammarco et al 2013 4 m h θ c θ k h θ d θ θ ρ s z z 0 ϕ t n d s as can be seen this equation can bond the flap s dynamic motion to the potential flow describing the velocity field around the flap the source of mass and stiffness are different from dry test and are the moment of inertia m h and the hydrostatic stiffness k h that can be analytically calculated see e g mei et al 2005 sammarco et al 2013 and the dynamic pressure can be substituted with the derivative of potential flow e g e renzi a abdolali and dias 2012 sammarco et al 2013 further explanation on the development of this equation can be found in mei et al 2005 the first three terms on the left hand side represent the torque associated with inertia mass damping and buoyancy of each flap respectively the last term on the left hand side describes the torque of the drag force as a quadratic expression of the angular velocity the right hand side describes the moment due to the whole dynamic pressure field induced by the surrounding hydrodynamics in equation 4 θ t is the flap angle of rotation θ θ are its first and second time derivatives m h is the mass moment of inertia and can be calculated analytically see e g mei et al 2005 m l2 c is the damping coefficient m l2 t 1 k h is the hydrostatic stiffness or the restoring torque per unit rotation angle and can be calculated analytically see e g mei et al 2005 m l2 t 2 d is the drag coefficient m l2 ρ is the density of water m l 3 s is the instantaneous wetted body surface z0 is the z coordinate of the center of rotation l ϕ is the fluid flow velocity potential which is a scalar function of space and time and incorporates all the scattered radiated and incoming waves ϕ t is the time derivative of the fluid flow velocity potential l2 t 2 and n is the unit normal vector pointing into the body the pressure on the moving bodies can be approximately estimated by the fluid flow velocity potential which can be obtained from the solution of the laplace equation under proper initial and boundary conditions considering only linear terms by introducing wave maker boundary condition at one end of the domain the wave propagation is simulated the presence of the radiation is assured by a boundary condition correlating the flap motion to the pressure on the flap e g mei et al 2005 therefore in this study instead of using frequency dependent parameters such as added mass and damping to describe the hydrodynamic around the flaps which are more effective close to the natural frequency jia 2014 the fluid velocity is directly connected to the dynamic equation of flap 5 2 ϕ 0 the sea bottom is assumed impermeable so a zero flux condition can be defined 6 ϕ z 0 a t z d where d is the water depth the subscripts state the time or space derivatives the kinematic and dynamic condition can be combined to have a free surface boundary condition 7 ϕ t t g ϕ z 0 a t z 0 another boundary condition relates the flap s motion to the component of the fluid velocity normal to the body surface ϕ n based on the linearized equations of motion ϕ n must be equal to the local velocity of the solid boundary at the flap boundaries mei 2012 it is also worth noting that the consistency of the direction and local axis should be considered in the numerical simulation 8 ϕ n θ t z z 0 for the simulation of experimental tests in a flume the surrounding walls and the fixed part of the caisson are considered reflective 9 ϕ 0 one wall of a flume is simulated as a wave maker boundary condition which could generate and absorb waves 10 ϕ x k ω ϕ t g h k c o s h k d z ω c o s h k d c o s ω t k x k is wave number ω is wave angular frequency g is gravity acceleration h is wave height d is water depth x 0 is the place of wave maker and its equilibrium position the first term works as an open boundary condition and absorbs back waves and allows them to travel without any disturbance the second term is connected with the progressive waves to verify the wave generation and its associated boundary condition the flume without the presence of the caisson breakwater is simulated several wave characteristics are simulated but to make this brief the generation of wave h 0 05 m t 0 3 s is simulated and the wave surfaces in distance 0 0 5 and 1 m from the wave maker are provided in fig 7 as demonstrated in fig 7 it is apparent that the exact wave is generated by increasing the distance from the wave maker there will be a delay in wave formation at the location of the probe point this delay is the required time for wave travel and is equal to the ratio of distance to the wave speed fig 8 shows the comparison between the generated wave in the flume recorded by the first wave gauge set up at around 0 90 m from the wavemaker and the numerically simulated wave during the experiments it was observed that a smooth wave can be obtained after almost 10 s bear in mind that by increasing mesh number and time step the smooth harmonic waves can be numerically simulated see fig 8 even for the first cycles which in fig 7 has jagged edges it is beyond the scope of this study to elaborate more on the boundary condition of wave maker detailed information can be found in flick and guza 1980 kusumawinahyu et al 2017 it should be emphasized that in this study an ordinary differential equation representing the dynamic motion of the flap is combined with a partial differential equation on the one hand the developed equation relates the motion of the flap to the surrounding hydrodynamics on the other hand the boundary condition defined on each flap s surface bonds its movement to fluid particles as earlier mentioned each flap has one degree of freedom therefore for 3 d simulation five equations for the flaps representing five degrees of freedom are used on the surface of each flap the boundary condition is defined the presence of five equations of motion and the corresponding boundary conditions ensure the flap fluid flap interaction in section 4 the interaction between the flaps observed in the experimental test and the numerical simulation are extensively discussed 2 2 calculation of quadratic damping here a methodology for calculating the drag coefficient is provided by combining numerical and experimental results to increase the fidelity of the numerical simulation the numerical simulation is used to compute the instantaneous change in the pressure field due to the flap s movements in an inviscid flow without the presence of quadratic damping term 11 m h θ c θ k h θ ρ s z z 0 ϕ t n d s m h and k h are calculated analytically see e g mei et al 2005 c is coming from the first set of experimental tests free oscillation dry tests θ was measured and θ θ were computed consequently fig 9 shows the flowchart for the computation of a nonlinear coefficient drag d 3 results and discussions in this section the results are systematically elaborated and described it starts with the experimental test group 1 free oscillation dry tests and extracting damping coefficient c the time series responses of flaps are used to estimate the natural period of each flap in air and get a better understanding of its dynamic characteristics in air and its differences with and without the presence of water then the results of the experimental test group 2 decay tests in water are provided from the flap s rotation time series of experimental results and by combination with numerical simulation as explained in previous sections and demonstrated in fig 10 the drag coefficient is evaluated finally by having both linear and nonlinear damping coefficient all unknowns of equation 4 are determined and the mathematical model can be used for the simulation of the nonlinear dynamic behavior of the flaps the results of the developed model are compared and validated with the experimental test group 3 response to wave action 3 1 experimental simulation of free oscillation dry tests free oscillation dry test was conducted for each flap by imposing a maximum rotation and then releasing it to freely oscillate in short the roll angle time series of flap 3 is presented as an example fig 10 that resembles the schematic free oscillation response of under critically damped system see fig 4 zero crossing analysis has been carried out on the results and the average period is reported in table 1 as already discussed the free oscillation dry test can be mathematically described by equation 1 where θ is known from the experimental measurements m and k have been calculated analytically and are equal to 1 61 10 4 kgm2 and 0 0218 kgm2 s 2 respectively see e g zonetti et al 1999 not need to mention that m and k here are the values calculated for the dry tests in which its dynamic characteristics are similar to a pendulum but when it is deployed in water m h is the mass moment of inertia and k h is hydrostatic stiffness to estimate the value of c the mechanical damping coefficient equation 1 is rewritten to obtain the time dependent value of c 12 c t m θ t k θ t θ t therefore the value of c can be computed for every time step the same procedure was repeated for all flaps the average of the mechanical damping c and the natural period t for each flap are summarized in table 1 although there is an insignificant difference between the natural periods of the flaps each flap has different mechanical damping the mechanical damping is found to be amplitude dependent as was also observed in experimental tests found in the literature see e g clough and penzien 1993 3 2 experimental simulation of decay tests in water the same procedure for the first group of tests has been repeated in water however some necessary test set up and post processing code adaptations have been carried out for accurate video recording and processing for brevity only the test results of flap 3 are provided here fig 11 shows the rotation of each flap due to the decay test of flap 3 the line style of flap 3 is selected differently to show that this is the flap that has an initial displacement and other flaps consequently started to oscillate due to its movement as already mentioned throughout this paper θ1 to θ5 refers to the rotation of flaps 1 to 5 respectively since the initial position is applied to flap 3 its oscillation starts with a large amplitude in comparison to other flaps therefore a window of time series after all flaps started to oscillate 1 5 s was chosen to show how the flaps move together because of the motion of one flap although the oscillation has a decay pattern its amplitude is changing in time due to the interaction between the flaps the natural periods extracted from the decay tests in water are summarized in table 2 as previously mentioned the mechanical damping is amplitude dependent as it was also reported in similar tests clough and penzien 1993 this fact the various gaps between flaps and consequent different boundary conditions are the main sources of period variety in a range of 0 27 s 0 55 s t σt the natural period extracted from decay tests in water table 2 is also different from the ones estimated from the free oscillation dry tests table 1 since the dynamic characteristics of the flap in the air are different from the ones in the water the source of damping during the dry flap oscillation is hinge friction however in the water different sources of damping are affecting the oscillation at the same time the mass and stiffness are completely different the oscillation of a flap in the air is not significantly affected by the presence of other flaps however in water the surrounding hydrodynamic directly connects the flap s behavior to each other the reported period is the period of a moving flap in a whole system considering the interaction between flaps the effect of the natural period on the dynamic response of the flaps to wave action is studied in more detail in the following sections the little gap between some flaps caused the intendancy of flaps to move together on the other hand their movement can be canceled by out of phase movement of another flap in the system this will be more explained in section 4 3 3 3 experimental simulation of the flaps response to wave action the third set of experiments investigates the response of the flaps to the wave action with the same height h 0 05 m and various periods t 0 3 1 1 s by steps of 0 10 s though for accurate capture of expected behavior under different wave actions some additional tests with extra periods are also conducted the wave parameters in the flume are corresponding to h 2 00 m and periods t 1 9 7 0 s in prototype according to froude scale effects since these kinds of wecs are mostly recognized as resonant devices the findings should be used in the direction of the wave period correlation with the natural period of the flaps therefore the wave height is the maximum expected wave height with a range of expected wave periods that have been used for the preliminary analystical solutions sammarco et al 2015 here additional wave periods based on the extracted periods from dry and decay tests are also used to provide a whole picture of the possible waves which could make the maximum responses in the flaps the experimental results are focused on the flaps motions and how the flaps work together for the sake of brevity some of the time series responses and the results of their signal processing are provided here further explanation about the wave body interaction for each case is also given a graph will summarize all the rms responses of all flaps to the waves it is worth noting that the presence of the breakwater causes a limitation on the movement of the flaps in one direction yielding an asymmetric rotation amplitude thus to differentiate this in tables and graphs the results were labeled as shoreward towards the breakwater and seaward fig 12 shows the time series response to wave with 0 4 s period it is observed that in the first cycles there are more out of phase responses among flaps because of their different natural period in the first cycles the transient response is dominant and flaps are oscillating with their natural period they don t have a similar period so they could respond out of phase after the transient response vanishes they will start to move together table 3 summarizes the maximum response and the rms response of each flap the results have been reported for both directions seaward and shoreward to highlight the effect of the breakwater apart from the physical limitation caused by breakwater for the shoreward movement it could be seen that reflecting waves from breakwater increase the seaward rotation a period equal to 0 4 s is not exactly the same but close to the natural period of flaps 1 to 4 the proximity of the incoming wave period to the natural period increases the response of some flaps due to resonance however the interaction of flaps the out of phase responses and the corresponding beating or cancellation effects e g kerschen et al 2015 also influence the rms and maximum responses two other interesting responses are due to waves with a period equal to 0 60 and 0 68 s see fig 13 and fig 15 the tendency of flaps to move in phase is growing with increasing the wave period it shows that the wave structure interaction arrives in the zone of wave period dominance as discussed the natural period of each flap oscillation falls in a range of 0 27 s 0 55 s t σt flap 1 and flap 4 have the maxseaward and maxshoreward individually according to decay tests in water their minimum natural period is 0 3 s which is half of the exciting wave period the results fig 13 and table 4 confirm the interpretations of free oscillation and a linear and nonlinear correlation between the natural period and the exciting wave period alenitsyn et al 1997 butikov 1999 nayfeh and mook 1979 keen observation and reviewing the videos for different wave periods also reveals the presence of transverse waves in the distance between flaps and breakwater fig 14 transverse waves are perpendicular to the wave direction and can be formed due to unequal pressure disturbance e g fleming 2018 in this case the rapid oscillation of the flaps the presence of the breakwater wall and the reflective sidewalls can cause the formation of transverse waves they were shaped even for other periods but for this wave their presence is bolder the transverse wave length was determined in this picture distance between two crests the transverse waves could make differences in the response and magnify or weaken the pressure field at the back of the flaps in accordance with their phase response to wave period equal to 0 68 s see fig 15 which is almost two times the natural period of some flaps can also aid to increase our understanding of nonlinear resonance alenitsyn et al 1997 butikov 1999 nayfeh and mook 1979 as can be seen by increasing the period around 13 percent the response of flaps is amplified by an average of 28 in comparison to the response to wave period 0 60s see tables 4 and 5 indeed flap 2 maximum seaward response that has half of the incoming wave period shows 38 rise comparing the maximum response values seaward shows that the minimum growth rate is around 12 for flap 1 see table 4 and table 5 another interesting observed phenomenon was a complete disturbance before and after the flaps position which was less observed in the previous trials this could be because of maximum movement which flaps are experiencing to this wave and also the neighborhood of vortex periods to the natural period of the flaps it could be more explained by the role of flow separation which was expected because of the wave amplitude to the floater size ratio mei et al 2005 the fluid flow is almost detached from the surface of flaps fig 16 besides the formation of vortex could be seen fig 17 that has further strengthened the assumption of inviscid fluid cannot effectively be used for the numerical simulations if the frequency of the vortex shedding reaches the frequency of the flap it could cause additional movement the responses could be almost overestimated because of ignoring the presence of vortex shedding the results show clearly that this assumption cannot be used for the waves with a period of more than 0 60 s to be more precise by increasing the flaps oscillation of more than 1 radian some nonlinear wave body interaction can be seen this observation will be implied by mathematically correlating the nonlinear term to the amplitude of oscillation which will be further explained in numerical simulation results and discussions section 4 4 the speed of the wave is 1 04 m s which means that after 0 16 s the transmitted waves from flaps will return to them on the other hand incoming waves have a period equal to 0 68 s therefore we could consider a period in the range of 0 16 0 34 for the vortex generated behind flaps which are quite close to the natural period reported in table 2 fig 18 shows the experimental results for the seaward direction generally by increasing the period the amplitude of the response is increasing however some local peaks can be seen in fig 19 interestingly the local maximum response of each flap is observed under the action of waves with a period close to equal or twice the natural period of the flap the nearest period to the mean value and twice of the mean value is also shown in this figure when two flaps experience resonance the response of all flaps has the local maximum due to the interaction of the flaps with each other it especially shows itself for higher periods that the incoming wave makes more force on the flaps and the flaps tend to move together these results confirm the correlation between the natural period of a moving object with an exciting force and it goes even further to show how this correlation could happen as super harmonic resonance the resonance generally understood as increasing the amplitude of a response due to the proximity of the exciting force period to the natural period however resonance can also happen when the period of an exciting force is multiple or a fraction of the natural period of the body in the literature resonance often is categorized as traditional resonance subharmonic or super harmonic resonance butikov 1999 for example the natural period of the observed oscillations for flap 1 considering the standard deviation has a range of 0 30 0 55 s with the average period equal to 0 43 s the noticeable local maximum responses happen to waves with periods equal to 0 30 0 40 and 0 90 which are approximately equal to or twice the observed natural period of flap 1 it was shown in the decay tests in water that flaps are working together and can have amplification or cancellation effects on the movement of each other therefore when a wave has a period in the range of the most flaps natural period the response would be amplified because most of the flaps are acting in resonance take for instance one of the local maximum in the response of flap 1 response to wave period equal to 0 30 s this period is not only in the range of natural period of flap 1 but also in the range of the natural period of flap 2 and flap 4 in other words if each flap is working alone it was expected that local maximum happens in response to waves with an exact period equal or multiple of the natural period however when the flaps are working in series it also relates to the other flaps behavior three sets of experimental tests including decay tests with and without the presence of water and forced oscillation provide a thorough understanding of the flaps dynamic behavior and the interaction between the flaps these experimental investigations are also used to estimate the unknown terms in the simulation model including the mechanical damping and the drag coefficient which are used in developing a more accurate simulation model the following sections review a hybrid experimental numerical procedure to develop the advanced numerical model that can provide more insight into the flaps behavior under the wave action 3 4 calculation of quadratic damping by hybrid physical and numerical simulation as described above initially it is assumed that the fluid is inviscid therefore the simulation model doesn t consist of the higher order damping nonlinearities such as drag effects however according to the experimental results decay tests in water see fig 12 the flap s motion is not similar to the oscillation of the linearized damped system the rapid decay in the first part of the oscillation and the slow rate at the last cycles can be considered as an indication of the nonlinear effects roberts 2003 the flaps significantly affect each other and continuously make the pressure field change this dynamic energy dissipation in fluid flow can be simulated by quadratic damping dixon 1999 this section represents a combined methodology to estimate the drag that will be finally used for the advanced numerical simulation equation 4 calculation of drag is not only useful in simulating the viscous effects e g babarit et al 2012 xu et al 2019 but also improves the model to capture the associated nonlinearities in the wave structure interaction since only by the presence of a nonlinear term in the mathematical description the nonlinear behavior can be simulated alenitsyn et al 1997 butikov 1999 nayfeh and mook 1979 this model equation 11 is solved to find the right hand term ρ s z z 0 ϕ t n d s time series of the pressure field fig 19 shows the numerical simulation of the experimental tests group 2 by using equation 11 to represent decay tests in water it should be emphasized that the time series responses of flap 1 5 and flap 2 4 are overlapped in fig 19 due to the symmetry in the numerical domain hence by using the experimental measurements synchronous with the calculated time series of the pressure field the drag coefficient can be estimated mathematically speaking the experimental measurements of θ its time derivatives and the dynamic characteristics such as the mass moment of inertia damping coefficient hydrostatic stiffness and the unknown drag term complete the left hand side of equation 4 m h the mass moment of inertia and k h the hydrostatic stiffness are calculated analytically see e g mei et al 2005 and are equal to 5 82 10 5 kgm2 and 0 019 kgm2 s 2 respectively as was mentioned earlier the sources of mass and stiffness are completely different in air and water c is related to the mechanical damping and was calculated in the previous section and is related to the hinge connection of flaps to the breakwater finally equation 4 will be solved to find the only unknown the drag coefficient d the comparison between the numerical simulation of decay oscillation of flap 3 and experimental simulation is presented in fig 20 it must be noted that this graph shows the comparison of the numerical model corresponding to equation 11 in which it doesn t simulate the drag effect with declining the amplitude of oscillation the difference between numerical and experimental results is decreasing which means that the viscous effects are related to the amplitude of oscillation in some literature it is shown that damping has the amplitude dependent nature see e g clough and penzien 1993 a similar pattern was observed during the experimental simulation of this study flow separation is recognized and visually observed by increasing the amplitude of oscillation fig 16 it is also known that the detachment of fluids from the surface of a body flow separation dramatically intensify drag fig 21 shows the comparison between the numerical moment of pressure induced by the surrounding hydrodynamics and the moment of inertia hydrostatic stiffness and damping using the experimental measurements the difference between the torque caused by the mass spring damper system and the torque induced by the surrounding hydrodynamics is the drag term which as was described is amplitude dependent it can be seen in fig 21 that after two cycles the torque induced by the mass spring damper system has an amplitude approximately equal to the torque induced by the surrounding hydrodynamics and with a phase shift both figs 20 and 21 show the same pattern since the only change in fluid pressure is induced by the movement of flaps the phase difference can be expected due to the accumulation of small phase difference over a period of time towne 2014 the equality of the torque values after two cycles shows that there is no other source of damping and the mass spring damper system can effectively model the low amplitude vibrations however in the first two cycles as it was seen in the experimental tests the high amplitude of oscillation and the speed of movement increases the flow separation this kind of loss of energy can be described by the higher power of the velocity therefore two average values based on the comparison between numerical and experimental results were estimated for drag coefficient 2 10 ˆ 4 kgm2 for the amplitude of oscillation less than 1 radian and 2 10 ˆ 3 kgm2 for more than 1 radian the model incorporating mechanical damping see section 4 1 and the amplitude dependent drag coefficient calculated in this section is used to simulate the response of the flaps to wave action in section 4 5 numerical simulation of the flaps response to wave action 3 5 numerical simulation of the flaps response to wave action finally the numerical model of equation 4 which incorporates mechanical damping and the drag effect is used to simulate the response of the flaps to wave action during the experimental tests fig 22 shows the time series response of flap 3 to different wave actions fig 23 presents the mean values and 99 confidence intervals of experimental results and the comparison between experimental and numerical rms response amplitude of the flaps for different incident wave periods as it can be seen the interval confidence is reasonably narrow for both flaps which means that the variance is small montgomery and runger 2011 this figure also shows the experimental results which were previously reported in fig 18 the figure includes the measured amplitude of all flaps as well as the computed response of flap 3 by solving expression 4 where the corresponding parameters have been computed as described in the previous sections flap 3 is chosen because its behavior can be considered as representative of a flap in a series of flaps one interesting phenomenon which is seen during the experiments is induced by different dynamic parameters of the flaps due to the test uncertainties these differences cause the flaps to oscillate with some kind of phase difference therefore they could change the pressure field around each other and reduce the other flaps movement fig 24 shows some frames of experimental tests in which the flaps are not moving together the added nonlinear term amplitude dependent drag coefficient gives a distinct advantage which makes the model able to predict even the nonlinear resonant response of flaps the generally called resonance can be categorized as traditional resonance subharmonic or super harmonic resonance which can increase the amplitude of oscillation when the period of an incoming wave is equal or multiple or a fraction of the natural period of the body the model can capture all these three forms of resonance if and only if it contains a nonlinear term as was included in this model alenitsyn et al 1997 butikov 1999 nayfeh and mook 1979 the difference between the results of the numerical model and the experimental measurements to wave periods 0 60 and 0 70 s can be explained by cancelation effects of the oscillation of flaps the significant flap wave interaction due to the presence of multiple bodies and the breakwater caused different flaps period so various waves with different periods can excite the system in general the model can represent the nonlinear dynamic response of the flaps to waves 4 conclusions wave body interaction has been studied by a large number of researchers mostly with some simplifications to overcome the complexities of these kinds of problems these complexities are increased if there exist multiple bodies in proximity ma 2010 newman 2001 in this study as it is shown the location of a series of flaps in front of the vertical wall of the breakwater and proximity of flaps causes the continuous change in hydrodynamics and flaps experience significant interaction the diversity of the mechanical damping the hinge stiffness the gaps between flaps and the boundary conditions whether wall or another flap leads to various natural periods which in turn causes the phase differences in the flaps movement as a result the movement of each flap can amplify or cancel the movement of other flaps in addition to the wave flap interaction the presence of radiated and scattered waves there are some trapped waves between the flaps and the breakwater which continuously modifies the surrounding hydrodynamics all in all cause a highly dynamic wave body interaction in which the pressure field is changing continuously in this study hybrid numerical and physical modelling is used to develop a fairly accurate simulation tool for the isolated and in an array behavior of the device the developed simulation model could represent the dynamic behavior as was validated with the experimental results which show that the assumptions are acceptable and the model can reproduce the general behavior and the peaks of the response due to the resonance effect the numerical model is able to capture different period dependent phenomena such as traditional subharmonic or super harmonic resonance due to the nonlinear term added to the mathematical model it is shown that by 8 increasing the incoming wave period to reach the average period of the flap the super harmonic resonance could increase the amplitude of oscillation by 35 this concept and the lessons learned from this study can be effectively used for tuning dynamic characteristics developing an efficient pto system and accurate design of the breakwater and flap structure of the wec device for future works e g saeidtehrani and karimirad 2021 the developed verified numerical tool can be further progressed to define proper boundary conditions for eliminating sidewalls of the flume and simulation of the randomness of waves in the real sea declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement i would like to thank professors leopoldo franco and giorgio bellotti for their support during my phd course at roma tre university i am grateful to dr pedro lomónaco for his valuable advice during my visit to oregon state university 
20410,the wave body interaction of resonant oscillating wave energy converters wecs is complex and nonlinear rapid development of wecs needs a reliable simulation tool for analysis and design procedure with the ability to capture the instantaneous nonlinear behavior this paper presents a methodology to study the behavior of a flap type wec utilizing hybrid physical and numerical simulation dynamic characteristics of the device as isolated and in an array are estimated and the time and oscillation amplitude dependency of these parameters are explained this methodology is developed for a device composed of a series of flaps placed on a vertical breakwater however the developed algorithm can be updated for any other wec concept with special consideration on the consequent changes in the load transfer surrounding hydrodynamic and wave structure interaction this paper increases our understanding and knowledge of all involved phenomena and their direct effects on the natural period and the response and can be used for tunning dynamic characteristics of wec device to incoming waves finally the developed numerical model is used for the simulation of the wec to different wave loads and the results are validated with the experimental tests keywords wave energy converter numerical simulation experimental tests nonlinear dynamic analysis wave structure interaction 1 introduction in recent years there has been great attention to renewable energy development to meet increasing electricity demands in a sustainable and clean way zhu et al 2020 this trend even can be seen in countries with a strong dependency on the fossil fuels market bouraiou et al 2020 jahangir et al 2020 or with a tendency to use nuclear power bragg sitton et al 2020 wave energy receives attention among various sources of renewable energy karimirad 2014 mainly because wave climate resources can be relatively well predicted corsatea et al 2014 mofor et al 2014 consequently there has been continuous progress toward commercialization in the wave energy industry over the last years previsic 2012 in the commercialization process wec array implementation would be necessary for widespread wave energy extraction correia da fonseca et al 2016 however the performance and the behavior of a device in an array are affected by the presence of other bodies correia da fonseca et al 2016 lópez ruiz et al 2018 thiruvenkatasamy and neelamani 1997 the commercialization and development of each wec needs a good understanding of the device s performance as isolated or in an array the type of wec device and its required operational conditions a thorough understanding of wec behavior can be achieved by full scale tests however this involves lots of limitations and functional difficulties these limitations encourage the industry to use numerical simulation tools or develop small scale laboratory models representing the behavior of the device in real conditions e g saeidtehrani 2016 saeidtehrani et al 2017 considerable research efforts focus on the acceptability and accurate usage of experimental tests e g kamarlouei et al 2020 sheng et al 2014 and examining the existent numerical tools and development of new simulation models for wec devices babarit et al 2012 folley 2016 sheng 2019 the classical approach for numerical modeling should consider the hydrodynamics around the converter and the dynamics of the body evans 1983 mei 1976 2012 the wave body interaction problem is complex and highly nonlinear e g saeidtehrani et al 2017 however under special situations it is possible to make some simplifications folley 2016 the common approach is using potential flow theory for the hydrodynamic model coupled with a mass spring damper system for the body motion some mathematical models include another damping term to simulate the nonlinearities and viscous effects babarit et al 2012 xu et al 2019 the hydrodynamic model can be simulated in frequency or time domains babarit et al 2012 babarit and delhommeau 2015 lee 1995 most of the methods apart from being frequency or time dependent use some coefficients such as added mass or radiation damping for representing the hydrodynamic of wecs which could only simulate the steady state motion faedo et al 2020 saeidtehrani et al 2019 although some researches have been carried out on the performance of wec device in an array erselcan and kükner 2017 lópez ruiz et al 2018 tomey bozo et al 2019 little is known about the interdependency of wecs to each other s performance and wave structure interaction in terms of variable time dependent fluid pressure around each device due to the presence of other bodies this paper aims to provide a reliable tool and methodology to study the behavior of a flap type wec with a combination of numerical and physical modeling the device is composed of five flaps placed on a breakwater as it was patented by the university of rome tor vergata michele et al 2015 michele et al 2016 michele et al 2016 sammarco et al 2013 it should be emphasized what makes the wave structure problem in this project even more complicated is a multipurpose structure of an array of flaps and the breakwater the numerical model uses the time domain interdependency of the flow to the dynamic motion of the flaps therefore it could grab instantaneous change in the fluid due to the rapid motion of the wec devices dynamic equation consists of a nonlinear term for the simulation of nonlinear period dependent phenomena here by a hybrid physical and numerical simulation the required parameters to represent different sources of damping are calculated more details by using the mathematical descriptions and flow charts are provided in the following sections this paper granularly develops the numerical model by using experimental measurements and is organized as follows a case study geometry and designed experimental tests are presented in the second section the methodology for developing numerical simulation is described in detail through section 3 final remarks and discussions are dedicated to the experimental simulation and validation of the numerical model with the experimental results under the action of waves a detailed investigation is also provided for the interdependency of flaps behavior in an array nonlinearity of wave structure interaction and the possibility to amplify the wecs response by estimation and usage of dynamic characteristics 1 1 device structure geometry and experimental tests a flap type device composed of five flaps placed on a breakwater as it was patented by the university of rome tor vergata michele et al 2015 michele et al 2016 michele et al 2016 sammarco et al 2013 is selected for this study experimental tests have been designed to study the dynamic response of the flaps by performing free oscillation dry tests decay tests in water and testing the flaps behavior under wave action the primary tests are proposed and conducted to extract wave structure dynamic characteristics the last set of experiments are conducted to validate the numerical results a 1 40 scale model of a flap type wec device has been constructed and tested in the laboratory of roma tre university saeidtehrani 2016 where five flaps are arranged on a caisson type vertical breakwater sammarco et al 2015 the flaps are hinged to the seaward horizontal surface of the breakwater photographic views of the structure are shown in fig 1 note that the flaps are leaned back on the breakwater vertical wall in the absence of water saeidtehrani 2016 the proposed flap has the dimension of 0 0725 x 0 050 x 0 043 m the exact dimensions of the small scale physical model after construction with 1 2 mm tolerance and its set up in the flume is shown in fig 2 saeidtehrani 2016 the five flaps are also numbered in this figure the device is originally proposed for the port of piombino in southern tuscany sammarco et al 2016 considering the average 12 m water depth the still water level swl in front of the breakwater for the scaled model was assumed 0 30 m in which 0 05 m of the flap height was underwater the first two sets of experiments have been carried out to study the behavior of the flaps without the presence of an external force i e wave action the concept of both experiments is to apply energy to the system and study how the system reacts free decay tests in these experiments the energy is applied by imposing an initial displacement to each flap and tracking its motion the period of one complete oscillation i e the natural period can be extracted from the time series responses it also shows how much energy is lost in the system due to the presence of dissipative forces i e friction of hinges or the energy used to displace water with the flap radiation damping or the drag effects in the first set the experiments have been done without the presence of water in the air hereafter it is called free oscillation dry test wec systems are multidisciplinary in nature and a deep understanding of the behavior need considering all phenomena involved including soil structure environmental load interaction here the flaps are directly mounted on the caisson therefore soil characteristics don t come into account however the attachment to the caisson is important to be considered as it will be shown this connection is one of the damping and stiffness sources of the system the second group of experiments has been performed in a wave flume the decay tests in water this group studies the wave structure interaction without the presence of wave loads the last series of experiments deals with studying the response of the flaps to the wave action the following sections describe the results of the experimental testing each set of experiments have been repeated at least five times to be sure about the accuracy of the results during the experiments the rotation of each flap was tracked by an allied vision gige camera a red point was marked at the center of the top surface of each flap to track the motion in each frame of the recorded video the marker on the flap has a radius of 15 pixels which provides enough accuracy to track the position of the flap in each video image 1920 x 1080 pixel resolution the length and width of the flaps are used as a reference length for the video processing in order to provide enough resolution in time and accurately describe the flap s motion it is necessary to set up a frame rate that could be well estimated by considering the rate of the minimum incoming wave period and the natural period of the flap because these two periods are dominant in the flap s response oscillation the minimum incoming wave period during the experiments was 0 30 s which is less than the natural period of the flaps more details about the calculation of the natural period are provided in the following sections therefore the frame rate has been selected to be 30 per second to capture a minimum of 9 frames to describe a full cycle of the flap motion to the wave with the minimum period by increasing the period of the incoming wave to 1 s there are 30 frames to describe the whole cycle of a flap s motion period based selection of frame rates could help us to not lose any important change in a cycle or misinterpret the time series response 1 2 free oscillation dry tests this section presents the experimental study of the free oscillation dry tests to characterize the damping caused by friction of hinges for each test the device was set upside down to give the flap freedom to rotate like a pendulum see fig 3 an initial displacement was applied to each flap separately and then it was released to move freely until it stops as explained earlier the movement of the flaps is recorded by the camera an image processing algorithm was developed in matlab matlab 2019 to analyse and locate the markers of the moving flaps frame by frame of the video the camera was placed on the ground such that it was looking up to the device the placement of the device the camera and some sample frames of the video are shown in fig 3 for further information see saeidtehrani 2016 videos were processed to map the pixels of each frame to a reference coordinate system and detect the location of the marker the length and width of the flaps were used as a reference length to map pixels to the coordinates of the flaps the marker position time series were converted to a roll angle time series as it is expected the rotation should have a pattern of free decay oscillation of under critically damped systems e g clough and penzien 1993 jia 2014 in which the amplitude of oscillation is decreasing with time because of the damping effect i e friction at the hinge fig 4 shows a schematic free oscillation response of under critically damped system θ ˆ is the amplitude of the flap rotation and td is the damped natural period of oscillation this time series free oscillation response of under critically damped system can be mathematically described as follows brebbia and walker 1979 clough and penzien 1993 1 m θ c θ k θ 0 m c and k are mass damping and stiffness coefficients respectively θ is the flap angle of rotation θ θ are its first and second time derivatives it is important to stress that putting the device upside down and out of the water make the dynamic system completely different in which its mass and stiffness are not the same as the mass and stiffness due to wave structure interaction therefore m and k for the flap acting like a pendulum and without the presence of water are calculated analytically e g zonetti et al 1999 and are used for calculation of the damping due to the friction of hinges the extracted damping coefficient can be later used for simulating the damping effect of hinges in the numerical model sections 3 1 and 4 5 1 3 decay tests in water in the second set of tests the device was placed in a glass flume 9 m long 0 27 m wide and 0 5 m deep with transparent walls the water depth in this experiment was 30 cm the device was placed approximately 4 m from the wave maker which is located at one of the flume ends see fig 5 four wave gauges wg were placed in the flume to measure the surface elevation at different positions between the wave maker and the device the camera was installed above the breakwater fig 6 shows the placement of the camera and wgs in the flume further details can be found in saeidtehrani 2016 during the decay tests in water each flap was initially rotated so that the flap was held in the maximum rotation on one side and then released to freely oscillate it is expected that the rotation time series has a decay pattern however due to the interference of flaps and the presence of the breakwater it doesn t completely fit with a classic decay pattern in which the amplitude of oscillation is decreasing to almost zero with time by releasing a flap from its initial position it starts to oscillate and its motion generates waves as expected and after a while the wave which is radiated from a moving flap propagates to the breakwater and after a fraction of time returns to all flaps therefore all flaps start to oscillate and in turn affect the pressure field the movement of one flap causes that other flaps start to move hereafter there will be five flaps that change the pressure field around and again waves are going towards the breakwater and coming back to the flaps as a result there is a continuous change in the pressure field around each flap and all the wave interference affects the period of the oscillation and the phase difference between the flaps rotation so the mathematical model should correlate the flaps dynamic motion to the simultaneous change in the pressure field as it will be explained in the mathematical background section 3 1 1 4 response to wave action the last set of experimental testing was performed to study the behavior of the flaps under regular wave action the device was placed in the flume using the same instruments and following the same procedure as has been used for the decay tests in water waves with equal height and different periods were generated and the motions of the flaps were recorded by the camera for each flap the amplitude of the rotation in both directions seaward and shoreward have been extracted from the video time series and then the rms of this amplitude is calculated 2 θ ˆ r m s 1 m i 1 m θ ˆ i 2 where θ ˆ is the positive or negative amplitudes of the flap rotation seaward and shoreward respectively m is the number of maxima and rms stands for the root mean square it is worth noting that due to the expected large oscillations e g retes et al 2015 nonlinear behavior of the flaps e g saeidtehrani 2016 sammarco et al 1997 and the period dependency of the response the rms is selected for representing the response amplitude since other representations such as the response amplitude operator rao are normally valid for the linear motion of the floating bodies e g chakrabarti 1987 karimirad 2014 2 numerical simulation in this section the development of the numerical simulation is presented the numerical simulation has been performed using comsol and matlab introduction to comsol multiphysics 2014 matlab 2019 multiphysics 2016 the first part of this section is dedicated to the mathematical model describing the behavior of flaps in water throughout the second part the calculation of the drag coefficient another source of damping of an oscillating body in a fluid is outlined for the simulation of damping different models from viscous proportional to velocity and hysteresis or fluid proportional to the square of the velocity or as it called quadratic damping can be used e g chakrabarti 1994 jia 2014 the mechanical damping and the drag coefficients coefficient of quadratic damping term are used as an approximation for the loss of energy and cannot be calculated mathematically due to the difficulties in the mathematical description of the physical mechanisms adhikari 2000 in this study mechanical damping is directly extracted from the free oscillation dry tests and the drag coefficient is calculated utilizing hybrid physical numerical simulation the required steps for this methodology is described in more detail in section 3 2 then the mechanical damping and the drag coefficient are used in the simulation model to reproduce the response of the flaps to the wave action 2 1 theory and mathematical background this section presents the mathematical model of wave body interaction based on newton s second law the forces acting on the wec must be in balance with the inertial force falnes 2002 mei et al 2005 the force on the flap can be estimated from the pressure consists of hydrostatic and dynamic terms as described by linearized first order bernoulli equation e g svendsen 2006 3 p ρ g z ρ ϕ t from the conservation of angular momentum and substituting the pressure p on the body the resultant equation can be written for one degree of freedom i e the rotation of the flap e g e renzi a abdolali and dias 2012 sammarco et al 2013 4 m h θ c θ k h θ d θ θ ρ s z z 0 ϕ t n d s as can be seen this equation can bond the flap s dynamic motion to the potential flow describing the velocity field around the flap the source of mass and stiffness are different from dry test and are the moment of inertia m h and the hydrostatic stiffness k h that can be analytically calculated see e g mei et al 2005 sammarco et al 2013 and the dynamic pressure can be substituted with the derivative of potential flow e g e renzi a abdolali and dias 2012 sammarco et al 2013 further explanation on the development of this equation can be found in mei et al 2005 the first three terms on the left hand side represent the torque associated with inertia mass damping and buoyancy of each flap respectively the last term on the left hand side describes the torque of the drag force as a quadratic expression of the angular velocity the right hand side describes the moment due to the whole dynamic pressure field induced by the surrounding hydrodynamics in equation 4 θ t is the flap angle of rotation θ θ are its first and second time derivatives m h is the mass moment of inertia and can be calculated analytically see e g mei et al 2005 m l2 c is the damping coefficient m l2 t 1 k h is the hydrostatic stiffness or the restoring torque per unit rotation angle and can be calculated analytically see e g mei et al 2005 m l2 t 2 d is the drag coefficient m l2 ρ is the density of water m l 3 s is the instantaneous wetted body surface z0 is the z coordinate of the center of rotation l ϕ is the fluid flow velocity potential which is a scalar function of space and time and incorporates all the scattered radiated and incoming waves ϕ t is the time derivative of the fluid flow velocity potential l2 t 2 and n is the unit normal vector pointing into the body the pressure on the moving bodies can be approximately estimated by the fluid flow velocity potential which can be obtained from the solution of the laplace equation under proper initial and boundary conditions considering only linear terms by introducing wave maker boundary condition at one end of the domain the wave propagation is simulated the presence of the radiation is assured by a boundary condition correlating the flap motion to the pressure on the flap e g mei et al 2005 therefore in this study instead of using frequency dependent parameters such as added mass and damping to describe the hydrodynamic around the flaps which are more effective close to the natural frequency jia 2014 the fluid velocity is directly connected to the dynamic equation of flap 5 2 ϕ 0 the sea bottom is assumed impermeable so a zero flux condition can be defined 6 ϕ z 0 a t z d where d is the water depth the subscripts state the time or space derivatives the kinematic and dynamic condition can be combined to have a free surface boundary condition 7 ϕ t t g ϕ z 0 a t z 0 another boundary condition relates the flap s motion to the component of the fluid velocity normal to the body surface ϕ n based on the linearized equations of motion ϕ n must be equal to the local velocity of the solid boundary at the flap boundaries mei 2012 it is also worth noting that the consistency of the direction and local axis should be considered in the numerical simulation 8 ϕ n θ t z z 0 for the simulation of experimental tests in a flume the surrounding walls and the fixed part of the caisson are considered reflective 9 ϕ 0 one wall of a flume is simulated as a wave maker boundary condition which could generate and absorb waves 10 ϕ x k ω ϕ t g h k c o s h k d z ω c o s h k d c o s ω t k x k is wave number ω is wave angular frequency g is gravity acceleration h is wave height d is water depth x 0 is the place of wave maker and its equilibrium position the first term works as an open boundary condition and absorbs back waves and allows them to travel without any disturbance the second term is connected with the progressive waves to verify the wave generation and its associated boundary condition the flume without the presence of the caisson breakwater is simulated several wave characteristics are simulated but to make this brief the generation of wave h 0 05 m t 0 3 s is simulated and the wave surfaces in distance 0 0 5 and 1 m from the wave maker are provided in fig 7 as demonstrated in fig 7 it is apparent that the exact wave is generated by increasing the distance from the wave maker there will be a delay in wave formation at the location of the probe point this delay is the required time for wave travel and is equal to the ratio of distance to the wave speed fig 8 shows the comparison between the generated wave in the flume recorded by the first wave gauge set up at around 0 90 m from the wavemaker and the numerically simulated wave during the experiments it was observed that a smooth wave can be obtained after almost 10 s bear in mind that by increasing mesh number and time step the smooth harmonic waves can be numerically simulated see fig 8 even for the first cycles which in fig 7 has jagged edges it is beyond the scope of this study to elaborate more on the boundary condition of wave maker detailed information can be found in flick and guza 1980 kusumawinahyu et al 2017 it should be emphasized that in this study an ordinary differential equation representing the dynamic motion of the flap is combined with a partial differential equation on the one hand the developed equation relates the motion of the flap to the surrounding hydrodynamics on the other hand the boundary condition defined on each flap s surface bonds its movement to fluid particles as earlier mentioned each flap has one degree of freedom therefore for 3 d simulation five equations for the flaps representing five degrees of freedom are used on the surface of each flap the boundary condition is defined the presence of five equations of motion and the corresponding boundary conditions ensure the flap fluid flap interaction in section 4 the interaction between the flaps observed in the experimental test and the numerical simulation are extensively discussed 2 2 calculation of quadratic damping here a methodology for calculating the drag coefficient is provided by combining numerical and experimental results to increase the fidelity of the numerical simulation the numerical simulation is used to compute the instantaneous change in the pressure field due to the flap s movements in an inviscid flow without the presence of quadratic damping term 11 m h θ c θ k h θ ρ s z z 0 ϕ t n d s m h and k h are calculated analytically see e g mei et al 2005 c is coming from the first set of experimental tests free oscillation dry tests θ was measured and θ θ were computed consequently fig 9 shows the flowchart for the computation of a nonlinear coefficient drag d 3 results and discussions in this section the results are systematically elaborated and described it starts with the experimental test group 1 free oscillation dry tests and extracting damping coefficient c the time series responses of flaps are used to estimate the natural period of each flap in air and get a better understanding of its dynamic characteristics in air and its differences with and without the presence of water then the results of the experimental test group 2 decay tests in water are provided from the flap s rotation time series of experimental results and by combination with numerical simulation as explained in previous sections and demonstrated in fig 10 the drag coefficient is evaluated finally by having both linear and nonlinear damping coefficient all unknowns of equation 4 are determined and the mathematical model can be used for the simulation of the nonlinear dynamic behavior of the flaps the results of the developed model are compared and validated with the experimental test group 3 response to wave action 3 1 experimental simulation of free oscillation dry tests free oscillation dry test was conducted for each flap by imposing a maximum rotation and then releasing it to freely oscillate in short the roll angle time series of flap 3 is presented as an example fig 10 that resembles the schematic free oscillation response of under critically damped system see fig 4 zero crossing analysis has been carried out on the results and the average period is reported in table 1 as already discussed the free oscillation dry test can be mathematically described by equation 1 where θ is known from the experimental measurements m and k have been calculated analytically and are equal to 1 61 10 4 kgm2 and 0 0218 kgm2 s 2 respectively see e g zonetti et al 1999 not need to mention that m and k here are the values calculated for the dry tests in which its dynamic characteristics are similar to a pendulum but when it is deployed in water m h is the mass moment of inertia and k h is hydrostatic stiffness to estimate the value of c the mechanical damping coefficient equation 1 is rewritten to obtain the time dependent value of c 12 c t m θ t k θ t θ t therefore the value of c can be computed for every time step the same procedure was repeated for all flaps the average of the mechanical damping c and the natural period t for each flap are summarized in table 1 although there is an insignificant difference between the natural periods of the flaps each flap has different mechanical damping the mechanical damping is found to be amplitude dependent as was also observed in experimental tests found in the literature see e g clough and penzien 1993 3 2 experimental simulation of decay tests in water the same procedure for the first group of tests has been repeated in water however some necessary test set up and post processing code adaptations have been carried out for accurate video recording and processing for brevity only the test results of flap 3 are provided here fig 11 shows the rotation of each flap due to the decay test of flap 3 the line style of flap 3 is selected differently to show that this is the flap that has an initial displacement and other flaps consequently started to oscillate due to its movement as already mentioned throughout this paper θ1 to θ5 refers to the rotation of flaps 1 to 5 respectively since the initial position is applied to flap 3 its oscillation starts with a large amplitude in comparison to other flaps therefore a window of time series after all flaps started to oscillate 1 5 s was chosen to show how the flaps move together because of the motion of one flap although the oscillation has a decay pattern its amplitude is changing in time due to the interaction between the flaps the natural periods extracted from the decay tests in water are summarized in table 2 as previously mentioned the mechanical damping is amplitude dependent as it was also reported in similar tests clough and penzien 1993 this fact the various gaps between flaps and consequent different boundary conditions are the main sources of period variety in a range of 0 27 s 0 55 s t σt the natural period extracted from decay tests in water table 2 is also different from the ones estimated from the free oscillation dry tests table 1 since the dynamic characteristics of the flap in the air are different from the ones in the water the source of damping during the dry flap oscillation is hinge friction however in the water different sources of damping are affecting the oscillation at the same time the mass and stiffness are completely different the oscillation of a flap in the air is not significantly affected by the presence of other flaps however in water the surrounding hydrodynamic directly connects the flap s behavior to each other the reported period is the period of a moving flap in a whole system considering the interaction between flaps the effect of the natural period on the dynamic response of the flaps to wave action is studied in more detail in the following sections the little gap between some flaps caused the intendancy of flaps to move together on the other hand their movement can be canceled by out of phase movement of another flap in the system this will be more explained in section 4 3 3 3 experimental simulation of the flaps response to wave action the third set of experiments investigates the response of the flaps to the wave action with the same height h 0 05 m and various periods t 0 3 1 1 s by steps of 0 10 s though for accurate capture of expected behavior under different wave actions some additional tests with extra periods are also conducted the wave parameters in the flume are corresponding to h 2 00 m and periods t 1 9 7 0 s in prototype according to froude scale effects since these kinds of wecs are mostly recognized as resonant devices the findings should be used in the direction of the wave period correlation with the natural period of the flaps therefore the wave height is the maximum expected wave height with a range of expected wave periods that have been used for the preliminary analystical solutions sammarco et al 2015 here additional wave periods based on the extracted periods from dry and decay tests are also used to provide a whole picture of the possible waves which could make the maximum responses in the flaps the experimental results are focused on the flaps motions and how the flaps work together for the sake of brevity some of the time series responses and the results of their signal processing are provided here further explanation about the wave body interaction for each case is also given a graph will summarize all the rms responses of all flaps to the waves it is worth noting that the presence of the breakwater causes a limitation on the movement of the flaps in one direction yielding an asymmetric rotation amplitude thus to differentiate this in tables and graphs the results were labeled as shoreward towards the breakwater and seaward fig 12 shows the time series response to wave with 0 4 s period it is observed that in the first cycles there are more out of phase responses among flaps because of their different natural period in the first cycles the transient response is dominant and flaps are oscillating with their natural period they don t have a similar period so they could respond out of phase after the transient response vanishes they will start to move together table 3 summarizes the maximum response and the rms response of each flap the results have been reported for both directions seaward and shoreward to highlight the effect of the breakwater apart from the physical limitation caused by breakwater for the shoreward movement it could be seen that reflecting waves from breakwater increase the seaward rotation a period equal to 0 4 s is not exactly the same but close to the natural period of flaps 1 to 4 the proximity of the incoming wave period to the natural period increases the response of some flaps due to resonance however the interaction of flaps the out of phase responses and the corresponding beating or cancellation effects e g kerschen et al 2015 also influence the rms and maximum responses two other interesting responses are due to waves with a period equal to 0 60 and 0 68 s see fig 13 and fig 15 the tendency of flaps to move in phase is growing with increasing the wave period it shows that the wave structure interaction arrives in the zone of wave period dominance as discussed the natural period of each flap oscillation falls in a range of 0 27 s 0 55 s t σt flap 1 and flap 4 have the maxseaward and maxshoreward individually according to decay tests in water their minimum natural period is 0 3 s which is half of the exciting wave period the results fig 13 and table 4 confirm the interpretations of free oscillation and a linear and nonlinear correlation between the natural period and the exciting wave period alenitsyn et al 1997 butikov 1999 nayfeh and mook 1979 keen observation and reviewing the videos for different wave periods also reveals the presence of transverse waves in the distance between flaps and breakwater fig 14 transverse waves are perpendicular to the wave direction and can be formed due to unequal pressure disturbance e g fleming 2018 in this case the rapid oscillation of the flaps the presence of the breakwater wall and the reflective sidewalls can cause the formation of transverse waves they were shaped even for other periods but for this wave their presence is bolder the transverse wave length was determined in this picture distance between two crests the transverse waves could make differences in the response and magnify or weaken the pressure field at the back of the flaps in accordance with their phase response to wave period equal to 0 68 s see fig 15 which is almost two times the natural period of some flaps can also aid to increase our understanding of nonlinear resonance alenitsyn et al 1997 butikov 1999 nayfeh and mook 1979 as can be seen by increasing the period around 13 percent the response of flaps is amplified by an average of 28 in comparison to the response to wave period 0 60s see tables 4 and 5 indeed flap 2 maximum seaward response that has half of the incoming wave period shows 38 rise comparing the maximum response values seaward shows that the minimum growth rate is around 12 for flap 1 see table 4 and table 5 another interesting observed phenomenon was a complete disturbance before and after the flaps position which was less observed in the previous trials this could be because of maximum movement which flaps are experiencing to this wave and also the neighborhood of vortex periods to the natural period of the flaps it could be more explained by the role of flow separation which was expected because of the wave amplitude to the floater size ratio mei et al 2005 the fluid flow is almost detached from the surface of flaps fig 16 besides the formation of vortex could be seen fig 17 that has further strengthened the assumption of inviscid fluid cannot effectively be used for the numerical simulations if the frequency of the vortex shedding reaches the frequency of the flap it could cause additional movement the responses could be almost overestimated because of ignoring the presence of vortex shedding the results show clearly that this assumption cannot be used for the waves with a period of more than 0 60 s to be more precise by increasing the flaps oscillation of more than 1 radian some nonlinear wave body interaction can be seen this observation will be implied by mathematically correlating the nonlinear term to the amplitude of oscillation which will be further explained in numerical simulation results and discussions section 4 4 the speed of the wave is 1 04 m s which means that after 0 16 s the transmitted waves from flaps will return to them on the other hand incoming waves have a period equal to 0 68 s therefore we could consider a period in the range of 0 16 0 34 for the vortex generated behind flaps which are quite close to the natural period reported in table 2 fig 18 shows the experimental results for the seaward direction generally by increasing the period the amplitude of the response is increasing however some local peaks can be seen in fig 19 interestingly the local maximum response of each flap is observed under the action of waves with a period close to equal or twice the natural period of the flap the nearest period to the mean value and twice of the mean value is also shown in this figure when two flaps experience resonance the response of all flaps has the local maximum due to the interaction of the flaps with each other it especially shows itself for higher periods that the incoming wave makes more force on the flaps and the flaps tend to move together these results confirm the correlation between the natural period of a moving object with an exciting force and it goes even further to show how this correlation could happen as super harmonic resonance the resonance generally understood as increasing the amplitude of a response due to the proximity of the exciting force period to the natural period however resonance can also happen when the period of an exciting force is multiple or a fraction of the natural period of the body in the literature resonance often is categorized as traditional resonance subharmonic or super harmonic resonance butikov 1999 for example the natural period of the observed oscillations for flap 1 considering the standard deviation has a range of 0 30 0 55 s with the average period equal to 0 43 s the noticeable local maximum responses happen to waves with periods equal to 0 30 0 40 and 0 90 which are approximately equal to or twice the observed natural period of flap 1 it was shown in the decay tests in water that flaps are working together and can have amplification or cancellation effects on the movement of each other therefore when a wave has a period in the range of the most flaps natural period the response would be amplified because most of the flaps are acting in resonance take for instance one of the local maximum in the response of flap 1 response to wave period equal to 0 30 s this period is not only in the range of natural period of flap 1 but also in the range of the natural period of flap 2 and flap 4 in other words if each flap is working alone it was expected that local maximum happens in response to waves with an exact period equal or multiple of the natural period however when the flaps are working in series it also relates to the other flaps behavior three sets of experimental tests including decay tests with and without the presence of water and forced oscillation provide a thorough understanding of the flaps dynamic behavior and the interaction between the flaps these experimental investigations are also used to estimate the unknown terms in the simulation model including the mechanical damping and the drag coefficient which are used in developing a more accurate simulation model the following sections review a hybrid experimental numerical procedure to develop the advanced numerical model that can provide more insight into the flaps behavior under the wave action 3 4 calculation of quadratic damping by hybrid physical and numerical simulation as described above initially it is assumed that the fluid is inviscid therefore the simulation model doesn t consist of the higher order damping nonlinearities such as drag effects however according to the experimental results decay tests in water see fig 12 the flap s motion is not similar to the oscillation of the linearized damped system the rapid decay in the first part of the oscillation and the slow rate at the last cycles can be considered as an indication of the nonlinear effects roberts 2003 the flaps significantly affect each other and continuously make the pressure field change this dynamic energy dissipation in fluid flow can be simulated by quadratic damping dixon 1999 this section represents a combined methodology to estimate the drag that will be finally used for the advanced numerical simulation equation 4 calculation of drag is not only useful in simulating the viscous effects e g babarit et al 2012 xu et al 2019 but also improves the model to capture the associated nonlinearities in the wave structure interaction since only by the presence of a nonlinear term in the mathematical description the nonlinear behavior can be simulated alenitsyn et al 1997 butikov 1999 nayfeh and mook 1979 this model equation 11 is solved to find the right hand term ρ s z z 0 ϕ t n d s time series of the pressure field fig 19 shows the numerical simulation of the experimental tests group 2 by using equation 11 to represent decay tests in water it should be emphasized that the time series responses of flap 1 5 and flap 2 4 are overlapped in fig 19 due to the symmetry in the numerical domain hence by using the experimental measurements synchronous with the calculated time series of the pressure field the drag coefficient can be estimated mathematically speaking the experimental measurements of θ its time derivatives and the dynamic characteristics such as the mass moment of inertia damping coefficient hydrostatic stiffness and the unknown drag term complete the left hand side of equation 4 m h the mass moment of inertia and k h the hydrostatic stiffness are calculated analytically see e g mei et al 2005 and are equal to 5 82 10 5 kgm2 and 0 019 kgm2 s 2 respectively as was mentioned earlier the sources of mass and stiffness are completely different in air and water c is related to the mechanical damping and was calculated in the previous section and is related to the hinge connection of flaps to the breakwater finally equation 4 will be solved to find the only unknown the drag coefficient d the comparison between the numerical simulation of decay oscillation of flap 3 and experimental simulation is presented in fig 20 it must be noted that this graph shows the comparison of the numerical model corresponding to equation 11 in which it doesn t simulate the drag effect with declining the amplitude of oscillation the difference between numerical and experimental results is decreasing which means that the viscous effects are related to the amplitude of oscillation in some literature it is shown that damping has the amplitude dependent nature see e g clough and penzien 1993 a similar pattern was observed during the experimental simulation of this study flow separation is recognized and visually observed by increasing the amplitude of oscillation fig 16 it is also known that the detachment of fluids from the surface of a body flow separation dramatically intensify drag fig 21 shows the comparison between the numerical moment of pressure induced by the surrounding hydrodynamics and the moment of inertia hydrostatic stiffness and damping using the experimental measurements the difference between the torque caused by the mass spring damper system and the torque induced by the surrounding hydrodynamics is the drag term which as was described is amplitude dependent it can be seen in fig 21 that after two cycles the torque induced by the mass spring damper system has an amplitude approximately equal to the torque induced by the surrounding hydrodynamics and with a phase shift both figs 20 and 21 show the same pattern since the only change in fluid pressure is induced by the movement of flaps the phase difference can be expected due to the accumulation of small phase difference over a period of time towne 2014 the equality of the torque values after two cycles shows that there is no other source of damping and the mass spring damper system can effectively model the low amplitude vibrations however in the first two cycles as it was seen in the experimental tests the high amplitude of oscillation and the speed of movement increases the flow separation this kind of loss of energy can be described by the higher power of the velocity therefore two average values based on the comparison between numerical and experimental results were estimated for drag coefficient 2 10 ˆ 4 kgm2 for the amplitude of oscillation less than 1 radian and 2 10 ˆ 3 kgm2 for more than 1 radian the model incorporating mechanical damping see section 4 1 and the amplitude dependent drag coefficient calculated in this section is used to simulate the response of the flaps to wave action in section 4 5 numerical simulation of the flaps response to wave action 3 5 numerical simulation of the flaps response to wave action finally the numerical model of equation 4 which incorporates mechanical damping and the drag effect is used to simulate the response of the flaps to wave action during the experimental tests fig 22 shows the time series response of flap 3 to different wave actions fig 23 presents the mean values and 99 confidence intervals of experimental results and the comparison between experimental and numerical rms response amplitude of the flaps for different incident wave periods as it can be seen the interval confidence is reasonably narrow for both flaps which means that the variance is small montgomery and runger 2011 this figure also shows the experimental results which were previously reported in fig 18 the figure includes the measured amplitude of all flaps as well as the computed response of flap 3 by solving expression 4 where the corresponding parameters have been computed as described in the previous sections flap 3 is chosen because its behavior can be considered as representative of a flap in a series of flaps one interesting phenomenon which is seen during the experiments is induced by different dynamic parameters of the flaps due to the test uncertainties these differences cause the flaps to oscillate with some kind of phase difference therefore they could change the pressure field around each other and reduce the other flaps movement fig 24 shows some frames of experimental tests in which the flaps are not moving together the added nonlinear term amplitude dependent drag coefficient gives a distinct advantage which makes the model able to predict even the nonlinear resonant response of flaps the generally called resonance can be categorized as traditional resonance subharmonic or super harmonic resonance which can increase the amplitude of oscillation when the period of an incoming wave is equal or multiple or a fraction of the natural period of the body the model can capture all these three forms of resonance if and only if it contains a nonlinear term as was included in this model alenitsyn et al 1997 butikov 1999 nayfeh and mook 1979 the difference between the results of the numerical model and the experimental measurements to wave periods 0 60 and 0 70 s can be explained by cancelation effects of the oscillation of flaps the significant flap wave interaction due to the presence of multiple bodies and the breakwater caused different flaps period so various waves with different periods can excite the system in general the model can represent the nonlinear dynamic response of the flaps to waves 4 conclusions wave body interaction has been studied by a large number of researchers mostly with some simplifications to overcome the complexities of these kinds of problems these complexities are increased if there exist multiple bodies in proximity ma 2010 newman 2001 in this study as it is shown the location of a series of flaps in front of the vertical wall of the breakwater and proximity of flaps causes the continuous change in hydrodynamics and flaps experience significant interaction the diversity of the mechanical damping the hinge stiffness the gaps between flaps and the boundary conditions whether wall or another flap leads to various natural periods which in turn causes the phase differences in the flaps movement as a result the movement of each flap can amplify or cancel the movement of other flaps in addition to the wave flap interaction the presence of radiated and scattered waves there are some trapped waves between the flaps and the breakwater which continuously modifies the surrounding hydrodynamics all in all cause a highly dynamic wave body interaction in which the pressure field is changing continuously in this study hybrid numerical and physical modelling is used to develop a fairly accurate simulation tool for the isolated and in an array behavior of the device the developed simulation model could represent the dynamic behavior as was validated with the experimental results which show that the assumptions are acceptable and the model can reproduce the general behavior and the peaks of the response due to the resonance effect the numerical model is able to capture different period dependent phenomena such as traditional subharmonic or super harmonic resonance due to the nonlinear term added to the mathematical model it is shown that by 8 increasing the incoming wave period to reach the average period of the flap the super harmonic resonance could increase the amplitude of oscillation by 35 this concept and the lessons learned from this study can be effectively used for tuning dynamic characteristics developing an efficient pto system and accurate design of the breakwater and flap structure of the wec device for future works e g saeidtehrani and karimirad 2021 the developed verified numerical tool can be further progressed to define proper boundary conditions for eliminating sidewalls of the flume and simulation of the randomness of waves in the real sea declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement i would like to thank professors leopoldo franco and giorgio bellotti for their support during my phd course at roma tre university i am grateful to dr pedro lomónaco for his valuable advice during my visit to oregon state university 
20411,offshore installations e g marine transportation oil platforms etc are strongly dependent on sea conditions which means low working efficiency and economic loss due to unworkable sea conditions to increase the workable time of carrying out these operations a stewart platform is installed on a ship deck to serve as a motion compensation base and equipment such as cranes and drilling platforms can be placed on the base to eliminate the effect of wave induced ship motions herein ship mounted stewart platforms work in the non inertial frame and their movements are influenced by persistent and unpredictable ship motions as a result they present much more complicated dynamical characteristics which bring much more challenges for the controller design to deal with the aforementioned problem this paper presents a sliding mode control scheme for the ship mounted stewart platform specifically by employing kane s method the dynamics model is established with the effect of ship s motion on the top platform considered furthermore a novel velocity feedforward compensator is proposed to improve control performance a command filtered based sliding mode backstepping controller is subsequently developed finally it is rigorously proven that the control errors are bounded employing lyapunov based analysis and simulations are included to illustrate the effectiveness of the proposed control scheme graphical abstract keywords motion compensation ship mounted stewart platform sliding mode control velocity feedforward 1 introduction there is an increasing development for offshore industry such as oil platforms wind turbines and offshore cranes etc frank et al 2014 tordal and hovland 2017 for the above applications loads and personnel have to be transferred from one ship to another or between a ship and solid offshore structures safely however the above offshore operations are strongly dependent on weather and sea conditions which means low working efficiency and economic loss due to unworkable sea conditions fang et al 2013 sun et al 2017a lu et al 2017 sun et al 2017a e g for offshore crane operations once the significant wave height reaches 1 m to 1 5 m on the pierson moskowitz sea spectrum the crane operations have to be aborted due to undesirable pendulation of the cargo data have been presented to show that typical crane ships in the north sea has an available work time of no more than half an year based on vertical displacement of the crane tip alone brennodden et al 1989 for the assembly and maintenance of wind turbines it is required to hoist parts from a ship onto the fixed base of the wind turbine those parts can collide with the wind turbine and cause damage due to wave induced ship motions to increase the workable time of carrying out these operations this paper proposes a solution stewart platform to address the ship motions i e the wave induced ship motions can be compensated for then the top platform can keep motionless in the inertial frame by controlling length of actuators and loads and personnel can be transferred more easily a ship at sea experiences some roll pitch surge yaw sway and heave motions in rough sea conditions fossen 2011 perez 2005 which make motion compensation difficult to carry out unlike traditional land fixed stewart platform systems their bases are equipped on the ship deck whose motions are influenced by sea waves and ocean currents this means that to accurately carry out marine transportation it is required to address the ship motions which make the system dynamics more complex and stronger nonlinearity over the last few decades control problems for land fixed mechanical systems have been extensively investigated and many ambitious fruits have been reported in the literature fewer results have been reported for mechanical systems operated in the non inertia frame due to their complicated dynamical characteristics strong nonlinearity and unexpected disturbances however we can still find some results reported for ship mounted mechanical systems küchler et al 2011 put forward an active control approach for single degree of freedom motion compensation system by properly predicting the ship movements shizhen et al 2017 proposed a nonlinear cascade controller with an adaptive extended disturbance observer to address the external perturbations and the parameter uncertainties for a hybrid active passive heave compensation system in addition many control methods were proposed for the offshore crane systems to address problems of parametric uncertainties and persistent ship induced perturbations and asymptotic convergence results were obtained lu et al 2017 sun et al 2017a he et al 2015 sun et al 2017b fang et al 2013 qian et al 2018 compared with vertical motion compensation systems and offshore crane systems the ship mounted stewart platform has more complicated dynamics salzmann 2010 proposed the idea of using the stewart platform as a motion compensation system and safety philosophy and two methods of dimension synthesis were investigated madsen and kristensen 2012 investigated kinematic optimization and design for ship mounted stewart platforms with different configurations based on the global condition index and manipulability index wei et al 2019 investigated a method of solving inverse kinematics based on fuzzy algorithm for a hybrid boarding system which is a combination of a ship mounted stewart platform and a 3 dof tandem manipulator the kinematical redundant problem was addressed zhao et al 2016 investigated a 6 dof foldable parallel mechanism for the ship based stabilized platform and stiffness and singularity analysis were carried out campos et al 2008 utilized a stewart gough platform as helicopter floating helideck upon landing on and taking off from ships or offshore and a simple kinematics control method was used cai et al 2021 analyzed the effects of ship motions on the stewart platform and the application of velocity feedforward however the rigorous stability analysis and the dynamics decoupling are not carried out for the designed controller according to the literature review above dimension synthesis of the ship mounted stewart platform has been investigated deeply but for the control problem of ship mounted stewart platforms most models in the existing results did not consider the influence of the ship motion disturbances or were the linearized models and existing results needed the actuator velocity and acceleration for the controller design however the signals cannot be sensed directly moreover the ship motions resulting from sea waves will unavoidably degrade the control performance or lead to closed loop instability hence the stabilization problem of ship mounted stewart platforms is still an open problem the systematic method of high performance control has not be given out in this paper we investigate the modeling and stabilization scheme for a ship mounted stewart platform with the ship motion disturbances considered specifically the dynamics model is set up for a ship mounted stewart platform by employing kane s method secondly a sliding mode dual loop controller based on a velocity feedforward compensator is proposed and it can guarantee stability of closed loop system finally lyapunov based method is implemented to support the entire theoretical analysis and comparative simulation results are provided to illustrate the effectiveness of the proposed control schemes specifically the contributions and novelties of the brief reside in the following aspects 1 different from the aforementioned models in campos et al 2008 frank et al 2014 tordal and hovland 2017 the proposed dynamics model for ship mounted stewart platforms fully consider the effect of ship motions on the stewart platform 2 unlike the traditional idea in campos et al 2008 frank et al 2014 tordal and hovland 2017 a velocity feedforward compensator is first proposed for ship mounted equipments 3 the proposed control scheme is the first method of combining the velocity feedforward compensator with motion controller and does not need sensor information i e the actuator velocity and acceleration which facilitates engineering application 4 the proposed method can ensure the stability of system s equilibrium point as supported by lyapunov based stability analysis the remaining parts of this paper are organized as follows in section 2 system dynamics model of the ship mounted stewart platform system is set up section 3 designs a sliding mode controller and implements the stability analysis section 4 provides some simulation results to illustrate performance of the ship mounted stewart platform controller and section 5 gives the conclusions of this paper notations throughout the paper s α and c α are utilized to denote functions sin α and cos α respectively s k is a skew symmetric matrix of a vector k diag k is a corresponding diagonal matrix of a vector k 2 problem statement 2 1 nonlinear model of the ship mounted stewart platform 1 stewart platform subsystem as shown in fig 1 a stewart platform is mounted on a ship s deck to keep top platform motionless relative to the inertial reference frame the ship motions can be measured with a motion sensor which has three accelerometers for detecting surge sway and heave and three rotation rate sensors for measuring roll pitch and yaw the acceleration signals are double integrated to obtain the positions of a ship as feedback signal and the rotation rate signals are integrated once to obtain the rotations after continuously measuring the ship s position and orientation with respect to the inertial reference frame then control the length of actuators to counteract the ship s movements to establish dynamics model for a mechanical system kane s method is usually employed in an inertial reference frame for clarity as shown in fig 2 an attached reference frame o m x m y m z m is defined where the origin o m is the center of a motion sensor in the frame the x m axis points to the forehead which is also the forward moving direction of the ship whereas the z m axis is perpendicular to the deck another coordinate system o s x s y s z s is defined where the origin o s is the center of upper gimbal points with its axis parallel with the corresponding axis in the frame o m the inertial reference frame o b x b y b z b is fixed on the ground with the x b axis parallel with the x m axis and the z b axis parallel with the z m axis to analyze the dynamics of the ship mounted stewart platform the first step is to describe the ship s states mathematically the orientation between the two frames of o m and o b is described by the euler angles ψ m θ m φ m and the transformation matrix r b m can be given by 1 r b m c ψ m c θ m c ψ m s θ m s φ m s ψ m c φ m c ψ m s θ m c φ m s ψ m s φ m s ψ m c θ m s ψ m s θ m s φ m c ψ m c φ m s ψ m s θ m c φ m c ψ m s φ m s θ m c θ m s φ m c θ m c φ m additionally for the translation of the ship relative to the inertial frame o b we utilize a vector t m to denote the displacement x m y m z m t similarly the orientation between the two frames of o s and o m is described by the euler angles ψ s θ s φ s and the transformation matrix r m s can be given by 2 r m s c ψ s c θ s c ψ s s θ s s φ s s ψ s c φ s c ψ s s θ s c φ s s ψ s s φ s s ψ s c θ s s ψ s s θ s s φ s c ψ s c φ s s ψ s s θ s c φ s c ψ s s φ s s θ s c θ s s φ s c v θ s c φ s and for the translation of the top platform relative to the attached reference frame o m we utilize a vector t s to denote the displacement x s y s z s t the stewart platform is fixed at point c i i 1 6 of the ship see fig 2 with c m ℜ 3 6 denoting the constant vector from o m to c i the displacement vector from o s to d i on the top platform corresponding to the gimbal pair is denoted as d s ℜ 3 6 similarly the displacement vector from o s to the mass centroid is denoted as ρ s ℜ 3 1 then define two generalized displacement vectors q m ψ m θ m φ m x m y m z m t and q s ψ s θ s φ s x s y s z s t in order to obtain a simpler form of expression all vectors about kinematics analysis are expressed in the attached reference frame o m due to the six identical limbs the following analysis focuses on the moving platform and the symbol i is omitted in the dynamics modeling process after performing careful vector analysis the length of each actuator can be expressed as 3 l t s r m s d s c m angular velocity of the top platform can be written as 4 ω s r b m t ω m ω s m where ω m denotes the angular velocity of the base platform expressed in the inertial reference frame ω s m denotes the angular velocity of the top platform relative to the base platform in the attached reference frame o m furthermore simplify 4 as 5 ω s j ω s m r b m t j ω m q j ω s q with 6 j ω m 0 s ψ m c ψ m c θ m 0 c ψ m s ψ m c θ m 1 0 s θ m 0 0 0 0 0 0 0 0 0 7 j ω s m 0 s ψ s c ψ s c θ s 0 c ψ s s ψ s c θ s 1 0 s θ s 0 0 0 0 0 0 0 0 0 where j ω s denotes the jacobian matrix of the angular velocity of the top platform j ω s m denotes the jacobian matrix of the angular velocity of the top platform relative to the base platform and q q s t q m t t it is not hard that in the attached reference frame velocity of the upper gimbal points d i can be given by 8 v d j t s s r m s d s j ω s m r b m t j t m s t s r b m t j ω m s r m s d s r b m t j ω m j d q where j t m j t s 0 3 3 i 3 3 and i 3 3 denotes a 3 3 unit matrix furthermore the actuator velocity can be given by 9 l l n t r m s d s l n t t s ω s m j q s where l n is the unit vector in direction of the actuator and l n of each limb are stacked in l n then the centroid velocity of the top platform relative to the inertial frame in the attached reference frame o m can be given by 10 v p j t s s r m s ρ s j ω s m r b m t j t m s t s r b m t j ω m s r m s ρ s r b m t j ω m j p q here we still need to express the velocity vectors in the inertial reference frame and employ kane method to obtain dynamics equations therefore they are written as 11 ω s r b m j ω s m j ω m q j ωs q 12 v p r b m j p q j p q through the previous kinematics analysis it can be seen that velocity jacobian matrices consist of two parts one for q s and the other one for q m therefore we write them in a form of j s j b e g j p j ps j pb moreover differentiation of jacobian matrix in 10 can be obtained as eq 13 given in box i with 14 j ω m 0 ψ m c ψ m ψ m s ψ m c θ m θ m c ψ m s θ m 0 ψ m s ψ m ψ m c ψ m c θ m θ m s ψ m s θ m 0 0 θ m c θ m 0 0 0 0 0 0 0 0 0 15 j ω s m 0 ψ s c ψ s ψ s s ψ s c θ s θ s c ψ s s θ s 0 ψ s s ψ s ψ s c ψ s c θ s θ s s ψ s s θ s 0 0 θ s c θ s 0 0 0 0 0 0 0 0 0 then the centroid acceleration of the top platform can be calculated with 16 v p j p q j p q in order to reduce computational complexity and facilitate programming we establish dynamics model by applying kane method here the inertia force the inertia moment and the gravity as well as the actuation force are projected into the task space through the jacobian matrices as the generalized inertia force and the generalized driving force then the dynamics equations are obtained based on the d alembert principle for the top platform the generalized inertial forces can be given by 17 f p i j ps t m p j ps q s j pb q m j pb q m j ps q s j ωss t i p j ωsb q m j ωss q s j ωss q s j ωsb q m s ω s i p j ωss q s j ωsb q m where m p denotes the mass of the top platform and i p represent inertia tensor of the top platform in the inertial reference frame moreover i p r b m r m s i p s r b m r m s t and i p s denotes inertia tensor of the platform in the platform coordinate frame o s similarly the generalized driving force can also be given by 18 f p a j ps t m p g j t f a where g is the gravity vector and f a f a 1 f a 6 t is the actuator force of six actuators after very tedious mathematical calculation and flexible manipulation the following dynamics equations are obtained 19 m s q s c s q s g s m m q m c m q m j t f a with 20 m s j ps t m p j ps j ωss t i p j ωss 21 m m j ps t m p j pb j ωss t i p j ωsb 22 c s j ps t m p j ps j ωss t i p j ωss j ωss t s ω s i p j ωss 23 c m j ps t m p j pb j ωss t i p j ωsb j ωss t s ω s i p j ωsb where m s and c s denote the inertial matrix and the coriolis centripetal matrix respectively the last two terms on the left side of 19 denote inertial forces induced by ship motions disturbance forces to facilitate the controller design rewrite the dynamics model in the joint space as 24 m l l c l l g l m b q m c b q m f a 25 m l j t m s j 1 26 m b j t m m 27 c l j t c s j 1 j t m s j 1 j j 1 28 c b j t c m 29 g l j t j ps t m p g 2 actuator subsystems in this study electrohydraulic actuators are chosen for active control of the ship mounted stewart platform for each limb their dynamics are taken into consideration in fig 3 the ratio of area gradients of spool ports are w 2 w 1 w 3 w 4 m 0 the sub indexes 1 and 2 refer respectively to the rodless chamber and the rod chamber of a piston v 1 v 10 a 1 y and v 2 v 20 a 2 y are volumes of the chambers with v 10 and v 20 corresponding to their initial values and assume that v 10 v 20 holds p 1 and p 2 are the chambers pressures q 1 and q 2 are the flow rates through ports of the chambers a 1 and a 2 are the ram areas of the two chambers the area ratio of the asymmetric piston is a 2 a 1 n 0 p l p 1 n 0 p 2 is the load pressure p s denotes the supply pressure of a pump y l l o is the displacement of the piston l o is the length of the actuator when the stewart platform is at neutral position herein the valve dynamics is neglected due to the low frequency range of wave spectrum and the actuator dynamics of the entire limbs for the controller design can be approximately written as a matrix equation 30 p l 1 n 0 2 β e k 0 f p l u a 1 l c t c p l v 10 where β e is the oil bulk modulus c t c is the equivalent leakage coefficient and k 0 m 0 q n v n p s δ p n n 0 3 m 0 2 is a constant q n is the rated flow of servo valves v n is the rated voltage of servo valves δ p n is the rated pressure drop per metering orifice u denotes an input voltage vector of servo valves p l p l p s f p l is a nonlinear function matrix and the diagonal matrix represents the nonlinearity of the hydraulic system and f p l 1 p l u 0 n 0 p l u 0 detailed system simulation model is given in guo et al 2008 define state variables as x x 1 x 2 x 3 t l t l t p l t t the entire system can be expressed in a state space form as 31 x 1 x 2 32 m l x 2 a 1 x 3 c l x 2 g l m b q m c b q m 33 x 3 1 n 0 2 β e k 0 f x 3 u a 1 x 2 c t c x 3 v 10 the entire system model satisfies the following properties property 1 the inertial matrix m l is symmetric positive definite roy et al 2018 34 m 1 ξ 2 ξ t m l ξ m 2 ξ 2 ξ ℜ 6 where m 1 m 2 are positive constants property 2 a skew symmetric relationship exists between the inertial matrix m l and the coriolis centripetal matrix c l as roy et al 2018 35 ξ t m l 2 c l ξ 0 ξ ℜ 6 property 3 for a real ship mounted stewart platform ship motions can be conveniently measured by such motion sensors as octans iii equipped on the ship then q m q m q m can be obtained in real time and we assume q m q m q m l property 4 the most significant masses and inertias are the top platform and load hence only the top platform is needed to be included in the dynamics model with the load equipped on the top platform lemma 1 consider the command filter 50 on t 0 t a for any given small τ r there exists a sufficiently large ω so that ε 3 d τ t 0 t a farrell et al 2009 proof please see farrell et al 2009 for the proof 2 2 control task to keep the top platform motionless relative to the inertial reference frame we must keep the orientation between the two frames of o s and o b unchanged and the displacement vector of the top platform expressed in the inertial reference frame a constant vector in addition pose of the top platform cannot be measured directly we have to control the length of actuators to reach our target indirectly based on the sensed ship motions we need to determine motion trajectory of the top platform with reapect to the base platform and they can be calculated with the following expressions 36 θ s arcsin r b m 1 3 37 φ s arcsin r b m 2 3 c θ s 38 ψ s arcsin r b m 1 2 c θ s 39 t s r b m t t s b t m where r b m i j denotes the element in the i t h row and j t h column of the matrix r b m t s b denotes position vector t s in the inertial reference frame when the stewart platform is at neutral position with using 3 the desired actuator length can be calculated with 40 l d t s r m s d s c m furthermore the desired unit vector in direction of the actuator l n d can also be obtained and it can be utilized in controller design as a result the control objective of the stewart platform is to design a bounded control input u so that the actual lengths of the actuator track desired length as closely as possible in spite of time varying disturbances 3 controller design and stability analysis 3 1 velocity feedforward compensator according to the previous control objective it seems that kinematic control method can be employed in this case unfortunately this idea cannot achieve satisfactory performance due to persistent ship disturbances induced by sea waves on the other hand we note that the actuator velocity can be calculated utilizing motions of the top platform relative to the ship based on 9 which indicates that the velocity contains two components one induced by the ship motions and the other one induced by motions of top platform for this reason we propose a velocity feedforward compensator cai et al 2021 to decouple ship s motion disturbances and the objective of the compensator is to compensate for the velocity component induced by the ship motions to improve system performance the compensated velocity component can be calculated with 41 l b l n t c m l n t r b m t 0 3 3 0 3 3 r b m t ω m t m j v v m where v m is the velocity of the motion sensor expressed in the attached reference frame o m furthermore combining 33 with 41 and considering the nonlinearity of servovalve flow the velocity feedforward compensator is proposed as 42 u v a 1 k 0 f p l 1 j v v m 3 2 motion controller design and stability analysis based on the previous velocity feedforward compensator the entire controller contains velocity feedforward loop and motion control loop see fig 4 the first loop is to decouple ship s motion disturbances in 33 the latter loop is a position tracking controller to make the actual length of the actuator approach the desired length for the motion controller we develop a sliding mode controller to compensate for the disturbance forces in 32 and the recursive backstepping technique is utilized to design controller to facilitate the controller design define an error vector as x 1 x 1 l d and a sliding surface s in a form 43 s x 1 λ x 1 where λ is a positive definite diagonal matrix furthermore define an auxiliary vector v as 44 v l d λ 0 t x 1 d t since the filter transfer function is stable slotine et al 1987 sun et al 2015 making x 1 converge to zero or be bounded is equivalent to making s converge to zero or be bounded as a result the rest work in this step is to make s as small as possible in this step the goal is to determine a virtual control law x 3 d to make s as small as possible substituting 32 and 33 into the above nonlinear state space representation and the mechanical system model can be rewritten as 45 m l s a 1 x 3 c l s m l v c l v g l m b q m c b q m in order to carry out stability analysis choose a lyapunov function candidate as 46 v s s t m l s 2 considering property 2 the derivative of the lyapunov function is given by 47 v s s t a 1 x 3 d m l v c l v g l m b q m c b q m x 3 t a 1 s a virtual controller x 3 d for x 3 is designed as 48 x 3 d m l v c l v g l m b q m c b q m c 1 s c 2 tanh s a 1 where c 1 and c 2 are positive definite diagonal matrices and a continuous function tanh is defined as 49 tanh t e t e t e t e t the term c 2 tanh s in 48 is designed to avoid chattering qian et al 2018 and compensate for the error due to velocity feedforward compensator and the introduced second order command filter we find that calculating the time derivative of x 3 d is a difficult task due to the complicated dynamics hence x 3 d is passed through a second order command filter farrell et al 2009 pan et al 2017 and let x 3 d x 3 d the filtered counterparts be the virtual controller input 50 z 1 z 2 z 2 2 ζ ω z 2 ω 2 x 3 d z 1 with z 1 0 x 3 d 0 and z 2 0 0 in which x 3 d z 1 x 3 d z 2 ω r is a natural frequency and ζ r is a damping ratio define the tracking error x 3 x 3 x 3 d and x 3 d x 3 d ε 3 d substituting the above virtual controller into 48 yields 51 m l s a 1 x 3 ε 3 d c 1 s c 2 tanh s c l s then the above derivative of the lyapunov function is rewritten as 52 v s a 1 s t ε 3 d a 1 x 3 t s s t c 1 s s t c 2 tanh s the next step is to determine the real input vector u c to keep x 3 tracking x 3 d as close as possible based on the velocity feedforward and the actuator system model can be rewritten as 53 x 3 1 n 0 2 β e k 0 f x 3 u c c t c x 3 v 10 x 3 d ε where ε is the error of velocity feedforward compensation and ε ε 0 now choose a total lyapunov function candidate as v v s x 3 t x 3 2 and the derivative of the total lyapunov function can be given as 54 v a 1 s t x 3 d a 1 s t ε 3 d a 1 x 3 t s s t c 1 s s t c 2 tanh s x 3 t 1 n 0 2 β e k 0 f x 3 u c c t c x 3 v 10 x 3 d ε design a controller u c to stabilize 53 as 55 u c k 0 f x 3 1 v 10 x 3 d β e 1 n 0 2 v 10 a 1 s β e 1 n 0 2 c 3 x 3 c t c x 3 where c 3 is a positive definite diagonal matrix of controller gain substituting the above controller u c into 54 yields 56 v a 1 s t ε 3 d x 3 t ε s t c 1 s s t c 2 tanh s x 3 t c 3 x 3 since controllers includes the above sliding surface we can choose an appropriate parameter c 2 to ensure that the following inequation holds 57 v s t c 1 s x 3 t c 3 x 3 ϑ δ v ϑ where ϑ is a positive constant since the total lyapunov function is a positive continuous function of time according to the lyapunov s theorem we know from 57 that s and x 3 are uniformly ultimately bounded albertisidori 1989 moreover it follows v v 0 ϑ δ e δ t ϑ δ so that the error s and x 3 will converge to a compact set consequently we can deduce that the control law u c is bounded combined with the above analysis the total control law is written as 58 u u c u v in conclusion the proposed control method is illustrated in fig 4 remark 1 with the velocity feedforward compensator added in control system the existing control method in campos et al 2008 frank et al 2014 tordal and hovland 2017 presents better control accuracy from the following simulation results however there is a problem that calculating the jacobian matrix j v needs kinematics forward solution herein we utilize the above vector l n d to avoid the process instead of l n this is a simplified process of the controller remark 2 in the actuator model see 53 the term a 1 x 2 is omitted although the actuator velocity contains the two components the main component of the actuator velocity is still generated by motions of the base platform for a good ship mounted stewart platform i e l l b in other words the velocity term in 33 is compensated for with minor error and we employ ε to represent the error of the above velocity feedforward compensation remark 3 the proposed control scheme needs sensor information including motions of the ship q m q m q m the actuators l and l and load pressure p l to calculate inertial matrix and the coriolis centripetal matrix in 48 among the above sensor information velocity of the actuator i e l cannot be obtained directly herein we utilize l b to avoid differentiating length of the actuator remark 4 to obtain the virtual controller 48 l d and l d need to be calculated and they can be obtained by differentiating from 36 to 40 59 q s m 1 n 0 3 3 h r b m t q m with 60 m c ψ s c θ s s ψ s s θ s 0 0 c θ s 0 0 s θ s s φ s c θ s c φ s 61 n s ψ m s θ m s φ m c ψ m c φ m c ψ m c θ m s φ m c ψ m s θ m c φ m s ψ m s φ m s ψ m s θ m c φ m c ψ m s φ m c ψ m c θ m c φ m c ψ m s θ m s φ m s ψ m c φ m c ψ m s θ m c φ m s ψ m s φ m s ψ m c θ m c φ m s ψ m s θ m s φ m c ψ m c φ m 62 h r b m t t s b t m r b m t j t m q m furthermore we can calculate l d using 9 similarly l d can also be obtained remark 5 note that 55 includes the control input u on both sides of the equation since the controller input u is in the function f x 3 hence 55 cannot be obtained directly herein a modified control law is given out 63 u k 0 f u b x 3 1 u b 64 u b v 10 x 3 d β e 1 n 0 2 v 10 a 1 s β e 1 n 0 2 c 3 x 3 c t c x 3 a 1 j v v m 4 simulation results in this section the scaled model simulation is provided to further verify the effectiveness of the proposed control scheme a dynamics simulator is built in the matlab simulink environment in which the motion sensor e g octans iii gives motions of the base platform to the controller the time step of the controller is set as 1 ms the actuator stroke range is assigned to be from 0 41 m to 0 44 m and the other parameters see fig 2 of the ship mounted stewart platform are listed in table 1 the initial poses of the top platform in the attached reference frame and the base platform in the inertial reference frame are set as q s 0 0 0 0 0 h t q m 0 0 0 0 0 0 t where h is height difference between the two platforms at neutral position to my knowledge there are not many results about stabilization problem for ship mounted stewart platforms hence in this study two control methods are compared 1 control method in campos et al 2008 frank et al 2014 tordal and hovland 2017 i e kinematic control method based on pid controller a pi controller with pressure feedback is tested for comparison the control law u p i d is u pi k p x 1 k i 0 t x 1 d t k d p x 3 then the velocity feedforward compensator is added in the above pi controller and simulation results are compared after sufficient tuning a group of controller parameters are selected as k p diag 100 100 100 100 100 100 k i diag 70 70 70 70 70 70 k d p 1 0 1 0 7 2 the proposed sliding mode controller the control parameters are set as λ diag 20 20 20 20 20 20 c 1 diag 200000 200000 200000 200000 200000 200000 c 2 diag 1 1 0 5 1 1 0 5 1 1 0 5 1 1 0 5 1 1 0 5 1 1 0 5 c 3 diag 8 1 0 10 8 1 0 10 8 1 0 10 8 1 0 10 8 1 0 10 8 1 0 10 on the consideration that the control object is to keep the top platform motionless relative to the inertial reference frame all the time thus the pose deviation in the inertial reference frame is used as motion compensation error to evaluate control system performance and the deviation is also motion responses of the top platform to ship motion induced perturbations moreover the delay and noise are considered for the simulation cases since the actuator latency is described by the nonlinear model the sensor delay is the main latency and set as 10 ms for the controller and the white noise signals whose maximum amplitude and frequency are 0 001 m rad and 2 hz are utilized to simulate system noise due to the low frequency range of wave spectrum for fair comparison all control parameters are fixed for different motion disturbance cases since the ship mounted stewart platform can compensate for the full degrees of freedom motions of a ship single degree of freedom motion simulations and multiple degree of freedom motion simulations are carried out to verify control performance of the proposed controller firstly single degree of freedom motions obtained from the motion sensor are given for the heave disturbance motion and roll motion disturbance respectively since the frequencies of ship motion disturbances are mainly concentrated between 0 1 to 0 25 hz motions heave and roll are assumed to be equal to sin waves 65 z m 0 4 sin 2 π ω d i s t 66 φ m 13 sin 2 π ω d i s t propagating with a variable frequency starting with ω d i s 0 and ending with ω d i s 0 3 hz as shown in fig 5 for the above single degree of freedom motion simulations fig 6 a shows the z direction response of the top platform to the heave motion disturbance and fig 6 b d present the rotation y direction and z direction response of the top platform to the roll motion disturbance using different controllers i e pi controller pi controller with velocity feedforward and the proposed controller when ship roll motion disturbance is given the kinematic control method i e pi controller is unstable and parasitic motions in y and z direction are presented with red curves in fig 6 c and d maximum values are 0 44 m and 0 05 m respectively it can be seen that using the velocity feedforward in the kinematic control method control performance is improved significantly and parasitic motions are well suppressed in addition it can be seen that the proposed controller performs better performance compared with pi controller with velocity feedforward in the whole frequency band since the model for the controller design in 30 needs model simplification to obtain the equivalent leakage coefficient the minor steady state error occurs in fig 6 d if the leakage of hydraulic actuator is ignored the minor steady error does not occur it can be seen that the model simplification has little influence on the control performance then we mainly compare control performance of pi controller with velocity feedforward and the proposed controller since the ship s position and heading can be controlled by using its own thrusters and the dynamic positioning system the horizontal motions remain a relatively small value hence a 5 degree of freedom simulation heave roll pitch surge and sway is carried out herein we select sinusoidal signals with a fixed amplitude and frequency in this case the ship motion disturbances are chosen as z m 0 21sin 2 π t 8 φ m 6sin 2 π t 10 and θ m 5sin 2 π t 5 x m 0 03sin 2 π t 10 y m 0 03sin 2 π t 10 fig 7 shows 6 degree of freedom motion responses of the top platform to the 5 degree of freedom motion disturbance compared with light blue and purple curves in the subplots maximum values of motion responses in 6 degree of freedom directions are 0 22deg 0 25deg 0 03deg 8 mm 3 5 mm and 4 mm using pi controller with velocity feedforward and the maximum values are 0 08deg 0 09deg 0 2 7 mm 1 3 mm and 2 mm using the proposed controller obviously the proposed controller has better control performance for controller simplification we utilize l b to replace l to calculate inertial matrix and the coriolis centripetal matrix then compared with blue and purple curves in the subplots we can see that similar control performance can be obtained after controller simplification except that a little longer response time and greater overshoot occur for the simplified controller in addition to the above simulations the ship mounted stewart platform is utilized in the field of ocean engineering hence random signals generated by wave spectrum are utilized to test convergence properties of the proposed controller simulated signals of ship motion induced perturbations heave and roll motion disturbance are generated by using stochastic wave motion theory based on the jonswap spectrum with the help of the marine system simulator mss toolbox for matlab fossen 2002 pierson and moskowitz 1964 the two parameters of the wave spectrum are defined by the peak period t p and the significant wave height h s considering the limited stroke lengths of the actuator the two parameters are set as t p 5 s and h s 0 6 m and the random signals for heave and roll motion disturbances are shown in fig 8 for the above random signal inputs fig 9 shows position and orientation deviation of the top platform in the inertial reference frame specifically fig 9 a shows z direction response to random signal of heave motion and fig 9 b d present the rotation y direction and z direction response to random signal of roll motion using different controllers by contrast without retuning the control parameters the simplified controller blue curves maintains excellent control performance which is consistent with the previous conclusions and the above simulation results indicate the control performance of the proposed scheme has been improved by about 50 compared with pi controller with velocity feedforward 5 conclusion in this paper the dynamics for a complicated ship mounted stewart platform system were fully investigated by employing kane s method based on the obtained model a novel velocity feedforward compensator is proposed to improve control performance furthermore a command filtered based sliding mode backstepping controller is subsequently developed for the ship mounted stewart platform to address the disturbance caused by the ship s motion efficiently and a simplified controller is proposed based on the previous controller the stability of the designed controller is proven by rigorous theoretical analysis and the results indicate the control performance of the proposed scheme has been improved by about 50 compared with pi controller with velocity feedforward credit authorship contribution statement yunfei cai conceptualization software writing original draft shutao zheng methodology weitian liu control scheme simulation and analysis zhiyong qu data curation jiyue zhu data curation junwei han project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20411,offshore installations e g marine transportation oil platforms etc are strongly dependent on sea conditions which means low working efficiency and economic loss due to unworkable sea conditions to increase the workable time of carrying out these operations a stewart platform is installed on a ship deck to serve as a motion compensation base and equipment such as cranes and drilling platforms can be placed on the base to eliminate the effect of wave induced ship motions herein ship mounted stewart platforms work in the non inertial frame and their movements are influenced by persistent and unpredictable ship motions as a result they present much more complicated dynamical characteristics which bring much more challenges for the controller design to deal with the aforementioned problem this paper presents a sliding mode control scheme for the ship mounted stewart platform specifically by employing kane s method the dynamics model is established with the effect of ship s motion on the top platform considered furthermore a novel velocity feedforward compensator is proposed to improve control performance a command filtered based sliding mode backstepping controller is subsequently developed finally it is rigorously proven that the control errors are bounded employing lyapunov based analysis and simulations are included to illustrate the effectiveness of the proposed control scheme graphical abstract keywords motion compensation ship mounted stewart platform sliding mode control velocity feedforward 1 introduction there is an increasing development for offshore industry such as oil platforms wind turbines and offshore cranes etc frank et al 2014 tordal and hovland 2017 for the above applications loads and personnel have to be transferred from one ship to another or between a ship and solid offshore structures safely however the above offshore operations are strongly dependent on weather and sea conditions which means low working efficiency and economic loss due to unworkable sea conditions fang et al 2013 sun et al 2017a lu et al 2017 sun et al 2017a e g for offshore crane operations once the significant wave height reaches 1 m to 1 5 m on the pierson moskowitz sea spectrum the crane operations have to be aborted due to undesirable pendulation of the cargo data have been presented to show that typical crane ships in the north sea has an available work time of no more than half an year based on vertical displacement of the crane tip alone brennodden et al 1989 for the assembly and maintenance of wind turbines it is required to hoist parts from a ship onto the fixed base of the wind turbine those parts can collide with the wind turbine and cause damage due to wave induced ship motions to increase the workable time of carrying out these operations this paper proposes a solution stewart platform to address the ship motions i e the wave induced ship motions can be compensated for then the top platform can keep motionless in the inertial frame by controlling length of actuators and loads and personnel can be transferred more easily a ship at sea experiences some roll pitch surge yaw sway and heave motions in rough sea conditions fossen 2011 perez 2005 which make motion compensation difficult to carry out unlike traditional land fixed stewart platform systems their bases are equipped on the ship deck whose motions are influenced by sea waves and ocean currents this means that to accurately carry out marine transportation it is required to address the ship motions which make the system dynamics more complex and stronger nonlinearity over the last few decades control problems for land fixed mechanical systems have been extensively investigated and many ambitious fruits have been reported in the literature fewer results have been reported for mechanical systems operated in the non inertia frame due to their complicated dynamical characteristics strong nonlinearity and unexpected disturbances however we can still find some results reported for ship mounted mechanical systems küchler et al 2011 put forward an active control approach for single degree of freedom motion compensation system by properly predicting the ship movements shizhen et al 2017 proposed a nonlinear cascade controller with an adaptive extended disturbance observer to address the external perturbations and the parameter uncertainties for a hybrid active passive heave compensation system in addition many control methods were proposed for the offshore crane systems to address problems of parametric uncertainties and persistent ship induced perturbations and asymptotic convergence results were obtained lu et al 2017 sun et al 2017a he et al 2015 sun et al 2017b fang et al 2013 qian et al 2018 compared with vertical motion compensation systems and offshore crane systems the ship mounted stewart platform has more complicated dynamics salzmann 2010 proposed the idea of using the stewart platform as a motion compensation system and safety philosophy and two methods of dimension synthesis were investigated madsen and kristensen 2012 investigated kinematic optimization and design for ship mounted stewart platforms with different configurations based on the global condition index and manipulability index wei et al 2019 investigated a method of solving inverse kinematics based on fuzzy algorithm for a hybrid boarding system which is a combination of a ship mounted stewart platform and a 3 dof tandem manipulator the kinematical redundant problem was addressed zhao et al 2016 investigated a 6 dof foldable parallel mechanism for the ship based stabilized platform and stiffness and singularity analysis were carried out campos et al 2008 utilized a stewart gough platform as helicopter floating helideck upon landing on and taking off from ships or offshore and a simple kinematics control method was used cai et al 2021 analyzed the effects of ship motions on the stewart platform and the application of velocity feedforward however the rigorous stability analysis and the dynamics decoupling are not carried out for the designed controller according to the literature review above dimension synthesis of the ship mounted stewart platform has been investigated deeply but for the control problem of ship mounted stewart platforms most models in the existing results did not consider the influence of the ship motion disturbances or were the linearized models and existing results needed the actuator velocity and acceleration for the controller design however the signals cannot be sensed directly moreover the ship motions resulting from sea waves will unavoidably degrade the control performance or lead to closed loop instability hence the stabilization problem of ship mounted stewart platforms is still an open problem the systematic method of high performance control has not be given out in this paper we investigate the modeling and stabilization scheme for a ship mounted stewart platform with the ship motion disturbances considered specifically the dynamics model is set up for a ship mounted stewart platform by employing kane s method secondly a sliding mode dual loop controller based on a velocity feedforward compensator is proposed and it can guarantee stability of closed loop system finally lyapunov based method is implemented to support the entire theoretical analysis and comparative simulation results are provided to illustrate the effectiveness of the proposed control schemes specifically the contributions and novelties of the brief reside in the following aspects 1 different from the aforementioned models in campos et al 2008 frank et al 2014 tordal and hovland 2017 the proposed dynamics model for ship mounted stewart platforms fully consider the effect of ship motions on the stewart platform 2 unlike the traditional idea in campos et al 2008 frank et al 2014 tordal and hovland 2017 a velocity feedforward compensator is first proposed for ship mounted equipments 3 the proposed control scheme is the first method of combining the velocity feedforward compensator with motion controller and does not need sensor information i e the actuator velocity and acceleration which facilitates engineering application 4 the proposed method can ensure the stability of system s equilibrium point as supported by lyapunov based stability analysis the remaining parts of this paper are organized as follows in section 2 system dynamics model of the ship mounted stewart platform system is set up section 3 designs a sliding mode controller and implements the stability analysis section 4 provides some simulation results to illustrate performance of the ship mounted stewart platform controller and section 5 gives the conclusions of this paper notations throughout the paper s α and c α are utilized to denote functions sin α and cos α respectively s k is a skew symmetric matrix of a vector k diag k is a corresponding diagonal matrix of a vector k 2 problem statement 2 1 nonlinear model of the ship mounted stewart platform 1 stewart platform subsystem as shown in fig 1 a stewart platform is mounted on a ship s deck to keep top platform motionless relative to the inertial reference frame the ship motions can be measured with a motion sensor which has three accelerometers for detecting surge sway and heave and three rotation rate sensors for measuring roll pitch and yaw the acceleration signals are double integrated to obtain the positions of a ship as feedback signal and the rotation rate signals are integrated once to obtain the rotations after continuously measuring the ship s position and orientation with respect to the inertial reference frame then control the length of actuators to counteract the ship s movements to establish dynamics model for a mechanical system kane s method is usually employed in an inertial reference frame for clarity as shown in fig 2 an attached reference frame o m x m y m z m is defined where the origin o m is the center of a motion sensor in the frame the x m axis points to the forehead which is also the forward moving direction of the ship whereas the z m axis is perpendicular to the deck another coordinate system o s x s y s z s is defined where the origin o s is the center of upper gimbal points with its axis parallel with the corresponding axis in the frame o m the inertial reference frame o b x b y b z b is fixed on the ground with the x b axis parallel with the x m axis and the z b axis parallel with the z m axis to analyze the dynamics of the ship mounted stewart platform the first step is to describe the ship s states mathematically the orientation between the two frames of o m and o b is described by the euler angles ψ m θ m φ m and the transformation matrix r b m can be given by 1 r b m c ψ m c θ m c ψ m s θ m s φ m s ψ m c φ m c ψ m s θ m c φ m s ψ m s φ m s ψ m c θ m s ψ m s θ m s φ m c ψ m c φ m s ψ m s θ m c φ m c ψ m s φ m s θ m c θ m s φ m c θ m c φ m additionally for the translation of the ship relative to the inertial frame o b we utilize a vector t m to denote the displacement x m y m z m t similarly the orientation between the two frames of o s and o m is described by the euler angles ψ s θ s φ s and the transformation matrix r m s can be given by 2 r m s c ψ s c θ s c ψ s s θ s s φ s s ψ s c φ s c ψ s s θ s c φ s s ψ s s φ s s ψ s c θ s s ψ s s θ s s φ s c ψ s c φ s s ψ s s θ s c φ s c ψ s s φ s s θ s c θ s s φ s c v θ s c φ s and for the translation of the top platform relative to the attached reference frame o m we utilize a vector t s to denote the displacement x s y s z s t the stewart platform is fixed at point c i i 1 6 of the ship see fig 2 with c m ℜ 3 6 denoting the constant vector from o m to c i the displacement vector from o s to d i on the top platform corresponding to the gimbal pair is denoted as d s ℜ 3 6 similarly the displacement vector from o s to the mass centroid is denoted as ρ s ℜ 3 1 then define two generalized displacement vectors q m ψ m θ m φ m x m y m z m t and q s ψ s θ s φ s x s y s z s t in order to obtain a simpler form of expression all vectors about kinematics analysis are expressed in the attached reference frame o m due to the six identical limbs the following analysis focuses on the moving platform and the symbol i is omitted in the dynamics modeling process after performing careful vector analysis the length of each actuator can be expressed as 3 l t s r m s d s c m angular velocity of the top platform can be written as 4 ω s r b m t ω m ω s m where ω m denotes the angular velocity of the base platform expressed in the inertial reference frame ω s m denotes the angular velocity of the top platform relative to the base platform in the attached reference frame o m furthermore simplify 4 as 5 ω s j ω s m r b m t j ω m q j ω s q with 6 j ω m 0 s ψ m c ψ m c θ m 0 c ψ m s ψ m c θ m 1 0 s θ m 0 0 0 0 0 0 0 0 0 7 j ω s m 0 s ψ s c ψ s c θ s 0 c ψ s s ψ s c θ s 1 0 s θ s 0 0 0 0 0 0 0 0 0 where j ω s denotes the jacobian matrix of the angular velocity of the top platform j ω s m denotes the jacobian matrix of the angular velocity of the top platform relative to the base platform and q q s t q m t t it is not hard that in the attached reference frame velocity of the upper gimbal points d i can be given by 8 v d j t s s r m s d s j ω s m r b m t j t m s t s r b m t j ω m s r m s d s r b m t j ω m j d q where j t m j t s 0 3 3 i 3 3 and i 3 3 denotes a 3 3 unit matrix furthermore the actuator velocity can be given by 9 l l n t r m s d s l n t t s ω s m j q s where l n is the unit vector in direction of the actuator and l n of each limb are stacked in l n then the centroid velocity of the top platform relative to the inertial frame in the attached reference frame o m can be given by 10 v p j t s s r m s ρ s j ω s m r b m t j t m s t s r b m t j ω m s r m s ρ s r b m t j ω m j p q here we still need to express the velocity vectors in the inertial reference frame and employ kane method to obtain dynamics equations therefore they are written as 11 ω s r b m j ω s m j ω m q j ωs q 12 v p r b m j p q j p q through the previous kinematics analysis it can be seen that velocity jacobian matrices consist of two parts one for q s and the other one for q m therefore we write them in a form of j s j b e g j p j ps j pb moreover differentiation of jacobian matrix in 10 can be obtained as eq 13 given in box i with 14 j ω m 0 ψ m c ψ m ψ m s ψ m c θ m θ m c ψ m s θ m 0 ψ m s ψ m ψ m c ψ m c θ m θ m s ψ m s θ m 0 0 θ m c θ m 0 0 0 0 0 0 0 0 0 15 j ω s m 0 ψ s c ψ s ψ s s ψ s c θ s θ s c ψ s s θ s 0 ψ s s ψ s ψ s c ψ s c θ s θ s s ψ s s θ s 0 0 θ s c θ s 0 0 0 0 0 0 0 0 0 then the centroid acceleration of the top platform can be calculated with 16 v p j p q j p q in order to reduce computational complexity and facilitate programming we establish dynamics model by applying kane method here the inertia force the inertia moment and the gravity as well as the actuation force are projected into the task space through the jacobian matrices as the generalized inertia force and the generalized driving force then the dynamics equations are obtained based on the d alembert principle for the top platform the generalized inertial forces can be given by 17 f p i j ps t m p j ps q s j pb q m j pb q m j ps q s j ωss t i p j ωsb q m j ωss q s j ωss q s j ωsb q m s ω s i p j ωss q s j ωsb q m where m p denotes the mass of the top platform and i p represent inertia tensor of the top platform in the inertial reference frame moreover i p r b m r m s i p s r b m r m s t and i p s denotes inertia tensor of the platform in the platform coordinate frame o s similarly the generalized driving force can also be given by 18 f p a j ps t m p g j t f a where g is the gravity vector and f a f a 1 f a 6 t is the actuator force of six actuators after very tedious mathematical calculation and flexible manipulation the following dynamics equations are obtained 19 m s q s c s q s g s m m q m c m q m j t f a with 20 m s j ps t m p j ps j ωss t i p j ωss 21 m m j ps t m p j pb j ωss t i p j ωsb 22 c s j ps t m p j ps j ωss t i p j ωss j ωss t s ω s i p j ωss 23 c m j ps t m p j pb j ωss t i p j ωsb j ωss t s ω s i p j ωsb where m s and c s denote the inertial matrix and the coriolis centripetal matrix respectively the last two terms on the left side of 19 denote inertial forces induced by ship motions disturbance forces to facilitate the controller design rewrite the dynamics model in the joint space as 24 m l l c l l g l m b q m c b q m f a 25 m l j t m s j 1 26 m b j t m m 27 c l j t c s j 1 j t m s j 1 j j 1 28 c b j t c m 29 g l j t j ps t m p g 2 actuator subsystems in this study electrohydraulic actuators are chosen for active control of the ship mounted stewart platform for each limb their dynamics are taken into consideration in fig 3 the ratio of area gradients of spool ports are w 2 w 1 w 3 w 4 m 0 the sub indexes 1 and 2 refer respectively to the rodless chamber and the rod chamber of a piston v 1 v 10 a 1 y and v 2 v 20 a 2 y are volumes of the chambers with v 10 and v 20 corresponding to their initial values and assume that v 10 v 20 holds p 1 and p 2 are the chambers pressures q 1 and q 2 are the flow rates through ports of the chambers a 1 and a 2 are the ram areas of the two chambers the area ratio of the asymmetric piston is a 2 a 1 n 0 p l p 1 n 0 p 2 is the load pressure p s denotes the supply pressure of a pump y l l o is the displacement of the piston l o is the length of the actuator when the stewart platform is at neutral position herein the valve dynamics is neglected due to the low frequency range of wave spectrum and the actuator dynamics of the entire limbs for the controller design can be approximately written as a matrix equation 30 p l 1 n 0 2 β e k 0 f p l u a 1 l c t c p l v 10 where β e is the oil bulk modulus c t c is the equivalent leakage coefficient and k 0 m 0 q n v n p s δ p n n 0 3 m 0 2 is a constant q n is the rated flow of servo valves v n is the rated voltage of servo valves δ p n is the rated pressure drop per metering orifice u denotes an input voltage vector of servo valves p l p l p s f p l is a nonlinear function matrix and the diagonal matrix represents the nonlinearity of the hydraulic system and f p l 1 p l u 0 n 0 p l u 0 detailed system simulation model is given in guo et al 2008 define state variables as x x 1 x 2 x 3 t l t l t p l t t the entire system can be expressed in a state space form as 31 x 1 x 2 32 m l x 2 a 1 x 3 c l x 2 g l m b q m c b q m 33 x 3 1 n 0 2 β e k 0 f x 3 u a 1 x 2 c t c x 3 v 10 the entire system model satisfies the following properties property 1 the inertial matrix m l is symmetric positive definite roy et al 2018 34 m 1 ξ 2 ξ t m l ξ m 2 ξ 2 ξ ℜ 6 where m 1 m 2 are positive constants property 2 a skew symmetric relationship exists between the inertial matrix m l and the coriolis centripetal matrix c l as roy et al 2018 35 ξ t m l 2 c l ξ 0 ξ ℜ 6 property 3 for a real ship mounted stewart platform ship motions can be conveniently measured by such motion sensors as octans iii equipped on the ship then q m q m q m can be obtained in real time and we assume q m q m q m l property 4 the most significant masses and inertias are the top platform and load hence only the top platform is needed to be included in the dynamics model with the load equipped on the top platform lemma 1 consider the command filter 50 on t 0 t a for any given small τ r there exists a sufficiently large ω so that ε 3 d τ t 0 t a farrell et al 2009 proof please see farrell et al 2009 for the proof 2 2 control task to keep the top platform motionless relative to the inertial reference frame we must keep the orientation between the two frames of o s and o b unchanged and the displacement vector of the top platform expressed in the inertial reference frame a constant vector in addition pose of the top platform cannot be measured directly we have to control the length of actuators to reach our target indirectly based on the sensed ship motions we need to determine motion trajectory of the top platform with reapect to the base platform and they can be calculated with the following expressions 36 θ s arcsin r b m 1 3 37 φ s arcsin r b m 2 3 c θ s 38 ψ s arcsin r b m 1 2 c θ s 39 t s r b m t t s b t m where r b m i j denotes the element in the i t h row and j t h column of the matrix r b m t s b denotes position vector t s in the inertial reference frame when the stewart platform is at neutral position with using 3 the desired actuator length can be calculated with 40 l d t s r m s d s c m furthermore the desired unit vector in direction of the actuator l n d can also be obtained and it can be utilized in controller design as a result the control objective of the stewart platform is to design a bounded control input u so that the actual lengths of the actuator track desired length as closely as possible in spite of time varying disturbances 3 controller design and stability analysis 3 1 velocity feedforward compensator according to the previous control objective it seems that kinematic control method can be employed in this case unfortunately this idea cannot achieve satisfactory performance due to persistent ship disturbances induced by sea waves on the other hand we note that the actuator velocity can be calculated utilizing motions of the top platform relative to the ship based on 9 which indicates that the velocity contains two components one induced by the ship motions and the other one induced by motions of top platform for this reason we propose a velocity feedforward compensator cai et al 2021 to decouple ship s motion disturbances and the objective of the compensator is to compensate for the velocity component induced by the ship motions to improve system performance the compensated velocity component can be calculated with 41 l b l n t c m l n t r b m t 0 3 3 0 3 3 r b m t ω m t m j v v m where v m is the velocity of the motion sensor expressed in the attached reference frame o m furthermore combining 33 with 41 and considering the nonlinearity of servovalve flow the velocity feedforward compensator is proposed as 42 u v a 1 k 0 f p l 1 j v v m 3 2 motion controller design and stability analysis based on the previous velocity feedforward compensator the entire controller contains velocity feedforward loop and motion control loop see fig 4 the first loop is to decouple ship s motion disturbances in 33 the latter loop is a position tracking controller to make the actual length of the actuator approach the desired length for the motion controller we develop a sliding mode controller to compensate for the disturbance forces in 32 and the recursive backstepping technique is utilized to design controller to facilitate the controller design define an error vector as x 1 x 1 l d and a sliding surface s in a form 43 s x 1 λ x 1 where λ is a positive definite diagonal matrix furthermore define an auxiliary vector v as 44 v l d λ 0 t x 1 d t since the filter transfer function is stable slotine et al 1987 sun et al 2015 making x 1 converge to zero or be bounded is equivalent to making s converge to zero or be bounded as a result the rest work in this step is to make s as small as possible in this step the goal is to determine a virtual control law x 3 d to make s as small as possible substituting 32 and 33 into the above nonlinear state space representation and the mechanical system model can be rewritten as 45 m l s a 1 x 3 c l s m l v c l v g l m b q m c b q m in order to carry out stability analysis choose a lyapunov function candidate as 46 v s s t m l s 2 considering property 2 the derivative of the lyapunov function is given by 47 v s s t a 1 x 3 d m l v c l v g l m b q m c b q m x 3 t a 1 s a virtual controller x 3 d for x 3 is designed as 48 x 3 d m l v c l v g l m b q m c b q m c 1 s c 2 tanh s a 1 where c 1 and c 2 are positive definite diagonal matrices and a continuous function tanh is defined as 49 tanh t e t e t e t e t the term c 2 tanh s in 48 is designed to avoid chattering qian et al 2018 and compensate for the error due to velocity feedforward compensator and the introduced second order command filter we find that calculating the time derivative of x 3 d is a difficult task due to the complicated dynamics hence x 3 d is passed through a second order command filter farrell et al 2009 pan et al 2017 and let x 3 d x 3 d the filtered counterparts be the virtual controller input 50 z 1 z 2 z 2 2 ζ ω z 2 ω 2 x 3 d z 1 with z 1 0 x 3 d 0 and z 2 0 0 in which x 3 d z 1 x 3 d z 2 ω r is a natural frequency and ζ r is a damping ratio define the tracking error x 3 x 3 x 3 d and x 3 d x 3 d ε 3 d substituting the above virtual controller into 48 yields 51 m l s a 1 x 3 ε 3 d c 1 s c 2 tanh s c l s then the above derivative of the lyapunov function is rewritten as 52 v s a 1 s t ε 3 d a 1 x 3 t s s t c 1 s s t c 2 tanh s the next step is to determine the real input vector u c to keep x 3 tracking x 3 d as close as possible based on the velocity feedforward and the actuator system model can be rewritten as 53 x 3 1 n 0 2 β e k 0 f x 3 u c c t c x 3 v 10 x 3 d ε where ε is the error of velocity feedforward compensation and ε ε 0 now choose a total lyapunov function candidate as v v s x 3 t x 3 2 and the derivative of the total lyapunov function can be given as 54 v a 1 s t x 3 d a 1 s t ε 3 d a 1 x 3 t s s t c 1 s s t c 2 tanh s x 3 t 1 n 0 2 β e k 0 f x 3 u c c t c x 3 v 10 x 3 d ε design a controller u c to stabilize 53 as 55 u c k 0 f x 3 1 v 10 x 3 d β e 1 n 0 2 v 10 a 1 s β e 1 n 0 2 c 3 x 3 c t c x 3 where c 3 is a positive definite diagonal matrix of controller gain substituting the above controller u c into 54 yields 56 v a 1 s t ε 3 d x 3 t ε s t c 1 s s t c 2 tanh s x 3 t c 3 x 3 since controllers includes the above sliding surface we can choose an appropriate parameter c 2 to ensure that the following inequation holds 57 v s t c 1 s x 3 t c 3 x 3 ϑ δ v ϑ where ϑ is a positive constant since the total lyapunov function is a positive continuous function of time according to the lyapunov s theorem we know from 57 that s and x 3 are uniformly ultimately bounded albertisidori 1989 moreover it follows v v 0 ϑ δ e δ t ϑ δ so that the error s and x 3 will converge to a compact set consequently we can deduce that the control law u c is bounded combined with the above analysis the total control law is written as 58 u u c u v in conclusion the proposed control method is illustrated in fig 4 remark 1 with the velocity feedforward compensator added in control system the existing control method in campos et al 2008 frank et al 2014 tordal and hovland 2017 presents better control accuracy from the following simulation results however there is a problem that calculating the jacobian matrix j v needs kinematics forward solution herein we utilize the above vector l n d to avoid the process instead of l n this is a simplified process of the controller remark 2 in the actuator model see 53 the term a 1 x 2 is omitted although the actuator velocity contains the two components the main component of the actuator velocity is still generated by motions of the base platform for a good ship mounted stewart platform i e l l b in other words the velocity term in 33 is compensated for with minor error and we employ ε to represent the error of the above velocity feedforward compensation remark 3 the proposed control scheme needs sensor information including motions of the ship q m q m q m the actuators l and l and load pressure p l to calculate inertial matrix and the coriolis centripetal matrix in 48 among the above sensor information velocity of the actuator i e l cannot be obtained directly herein we utilize l b to avoid differentiating length of the actuator remark 4 to obtain the virtual controller 48 l d and l d need to be calculated and they can be obtained by differentiating from 36 to 40 59 q s m 1 n 0 3 3 h r b m t q m with 60 m c ψ s c θ s s ψ s s θ s 0 0 c θ s 0 0 s θ s s φ s c θ s c φ s 61 n s ψ m s θ m s φ m c ψ m c φ m c ψ m c θ m s φ m c ψ m s θ m c φ m s ψ m s φ m s ψ m s θ m c φ m c ψ m s φ m c ψ m c θ m c φ m c ψ m s θ m s φ m s ψ m c φ m c ψ m s θ m c φ m s ψ m s φ m s ψ m c θ m c φ m s ψ m s θ m s φ m c ψ m c φ m 62 h r b m t t s b t m r b m t j t m q m furthermore we can calculate l d using 9 similarly l d can also be obtained remark 5 note that 55 includes the control input u on both sides of the equation since the controller input u is in the function f x 3 hence 55 cannot be obtained directly herein a modified control law is given out 63 u k 0 f u b x 3 1 u b 64 u b v 10 x 3 d β e 1 n 0 2 v 10 a 1 s β e 1 n 0 2 c 3 x 3 c t c x 3 a 1 j v v m 4 simulation results in this section the scaled model simulation is provided to further verify the effectiveness of the proposed control scheme a dynamics simulator is built in the matlab simulink environment in which the motion sensor e g octans iii gives motions of the base platform to the controller the time step of the controller is set as 1 ms the actuator stroke range is assigned to be from 0 41 m to 0 44 m and the other parameters see fig 2 of the ship mounted stewart platform are listed in table 1 the initial poses of the top platform in the attached reference frame and the base platform in the inertial reference frame are set as q s 0 0 0 0 0 h t q m 0 0 0 0 0 0 t where h is height difference between the two platforms at neutral position to my knowledge there are not many results about stabilization problem for ship mounted stewart platforms hence in this study two control methods are compared 1 control method in campos et al 2008 frank et al 2014 tordal and hovland 2017 i e kinematic control method based on pid controller a pi controller with pressure feedback is tested for comparison the control law u p i d is u pi k p x 1 k i 0 t x 1 d t k d p x 3 then the velocity feedforward compensator is added in the above pi controller and simulation results are compared after sufficient tuning a group of controller parameters are selected as k p diag 100 100 100 100 100 100 k i diag 70 70 70 70 70 70 k d p 1 0 1 0 7 2 the proposed sliding mode controller the control parameters are set as λ diag 20 20 20 20 20 20 c 1 diag 200000 200000 200000 200000 200000 200000 c 2 diag 1 1 0 5 1 1 0 5 1 1 0 5 1 1 0 5 1 1 0 5 1 1 0 5 c 3 diag 8 1 0 10 8 1 0 10 8 1 0 10 8 1 0 10 8 1 0 10 8 1 0 10 on the consideration that the control object is to keep the top platform motionless relative to the inertial reference frame all the time thus the pose deviation in the inertial reference frame is used as motion compensation error to evaluate control system performance and the deviation is also motion responses of the top platform to ship motion induced perturbations moreover the delay and noise are considered for the simulation cases since the actuator latency is described by the nonlinear model the sensor delay is the main latency and set as 10 ms for the controller and the white noise signals whose maximum amplitude and frequency are 0 001 m rad and 2 hz are utilized to simulate system noise due to the low frequency range of wave spectrum for fair comparison all control parameters are fixed for different motion disturbance cases since the ship mounted stewart platform can compensate for the full degrees of freedom motions of a ship single degree of freedom motion simulations and multiple degree of freedom motion simulations are carried out to verify control performance of the proposed controller firstly single degree of freedom motions obtained from the motion sensor are given for the heave disturbance motion and roll motion disturbance respectively since the frequencies of ship motion disturbances are mainly concentrated between 0 1 to 0 25 hz motions heave and roll are assumed to be equal to sin waves 65 z m 0 4 sin 2 π ω d i s t 66 φ m 13 sin 2 π ω d i s t propagating with a variable frequency starting with ω d i s 0 and ending with ω d i s 0 3 hz as shown in fig 5 for the above single degree of freedom motion simulations fig 6 a shows the z direction response of the top platform to the heave motion disturbance and fig 6 b d present the rotation y direction and z direction response of the top platform to the roll motion disturbance using different controllers i e pi controller pi controller with velocity feedforward and the proposed controller when ship roll motion disturbance is given the kinematic control method i e pi controller is unstable and parasitic motions in y and z direction are presented with red curves in fig 6 c and d maximum values are 0 44 m and 0 05 m respectively it can be seen that using the velocity feedforward in the kinematic control method control performance is improved significantly and parasitic motions are well suppressed in addition it can be seen that the proposed controller performs better performance compared with pi controller with velocity feedforward in the whole frequency band since the model for the controller design in 30 needs model simplification to obtain the equivalent leakage coefficient the minor steady state error occurs in fig 6 d if the leakage of hydraulic actuator is ignored the minor steady error does not occur it can be seen that the model simplification has little influence on the control performance then we mainly compare control performance of pi controller with velocity feedforward and the proposed controller since the ship s position and heading can be controlled by using its own thrusters and the dynamic positioning system the horizontal motions remain a relatively small value hence a 5 degree of freedom simulation heave roll pitch surge and sway is carried out herein we select sinusoidal signals with a fixed amplitude and frequency in this case the ship motion disturbances are chosen as z m 0 21sin 2 π t 8 φ m 6sin 2 π t 10 and θ m 5sin 2 π t 5 x m 0 03sin 2 π t 10 y m 0 03sin 2 π t 10 fig 7 shows 6 degree of freedom motion responses of the top platform to the 5 degree of freedom motion disturbance compared with light blue and purple curves in the subplots maximum values of motion responses in 6 degree of freedom directions are 0 22deg 0 25deg 0 03deg 8 mm 3 5 mm and 4 mm using pi controller with velocity feedforward and the maximum values are 0 08deg 0 09deg 0 2 7 mm 1 3 mm and 2 mm using the proposed controller obviously the proposed controller has better control performance for controller simplification we utilize l b to replace l to calculate inertial matrix and the coriolis centripetal matrix then compared with blue and purple curves in the subplots we can see that similar control performance can be obtained after controller simplification except that a little longer response time and greater overshoot occur for the simplified controller in addition to the above simulations the ship mounted stewart platform is utilized in the field of ocean engineering hence random signals generated by wave spectrum are utilized to test convergence properties of the proposed controller simulated signals of ship motion induced perturbations heave and roll motion disturbance are generated by using stochastic wave motion theory based on the jonswap spectrum with the help of the marine system simulator mss toolbox for matlab fossen 2002 pierson and moskowitz 1964 the two parameters of the wave spectrum are defined by the peak period t p and the significant wave height h s considering the limited stroke lengths of the actuator the two parameters are set as t p 5 s and h s 0 6 m and the random signals for heave and roll motion disturbances are shown in fig 8 for the above random signal inputs fig 9 shows position and orientation deviation of the top platform in the inertial reference frame specifically fig 9 a shows z direction response to random signal of heave motion and fig 9 b d present the rotation y direction and z direction response to random signal of roll motion using different controllers by contrast without retuning the control parameters the simplified controller blue curves maintains excellent control performance which is consistent with the previous conclusions and the above simulation results indicate the control performance of the proposed scheme has been improved by about 50 compared with pi controller with velocity feedforward 5 conclusion in this paper the dynamics for a complicated ship mounted stewart platform system were fully investigated by employing kane s method based on the obtained model a novel velocity feedforward compensator is proposed to improve control performance furthermore a command filtered based sliding mode backstepping controller is subsequently developed for the ship mounted stewart platform to address the disturbance caused by the ship s motion efficiently and a simplified controller is proposed based on the previous controller the stability of the designed controller is proven by rigorous theoretical analysis and the results indicate the control performance of the proposed scheme has been improved by about 50 compared with pi controller with velocity feedforward credit authorship contribution statement yunfei cai conceptualization software writing original draft shutao zheng methodology weitian liu control scheme simulation and analysis zhiyong qu data curation jiyue zhu data curation junwei han project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20412,two degree of freedom 2dof flow induced vibrations fiv for a pair of elastically mounted circular cylinders in tandem arrangement with varying centre to centre spacings s x are numerically studied the reynolds number range r e 1470 10320 belongs to the subcritical flow regime two identical cylinders with a mass ratio of m 2 6 and a mass damping parameter of m c a ζ 0 013 are considered in the simulation four spacing ratios s x d where d is the identical diameter ranging from 3 0 to 8 0 are employed to investigate the effect of s x d on the fiv responses hydrodynamic characteristics and wake patterns of the two cylinders it is found that the effect of the downstream cylinder on the fiv of the upstream one becomes insignificant when s x d 4 0 due to the unsteady wake cylinder interactions multi peak responses are observed for the downstream cylinder dual resonance with the 2 1 in line to cross flow oscillation frequency ratio and figure eight orbital trajectories is found to occur for the upstream cylinder in contrast the trajectories of the downstream cylinder are rather irregular because of the low frequency components in the in line response at high reduced velocity v r both shear flow and vortex shedding may appear in the gap region depending on s x d and the relative motion of the two cylinders in general the vortex shedding modes of the upstream cylinder are similar to those of a single cylinder whereas the analyses on the wake patterns suggest that the interactions of the upstream wake with the downstream cylinder and its own wake contribute to the unsteady fluid dynamics which is crucial to maintaining the large amplitude vibrations of the downstream cylinder at high v r keywords flow induced vibrations fiv tandem circular cylinders effect of spacing wake induced vibrations wiv reynolds averaged navier stokes rans 1 introduction clustered cylindrical structures in tandem configurations are common in many offshore engineering applications such as risers tendons mooring lines and subsea cables these structures are susceptible to the complex fluid structure interaction fsi phenomena known as the flow induced vibrations fiv fiv is one of the main sources of fatigue damage to offshore slender structures moreover fiv of tandem cylinders involves intricate interactions between the fluid flow and the cylinder motion owing to its theoretical value and practical significance extensive studies have been carried out relevant research progress has been reviewed by chen 1986 zdravkovich 1988 païdoussis and price 1988 moretti 1993 and bearman 1993 early studies were generally focussed on the flow fields of two stationary cylinders in tandem arrangement igarashi 1981 zdravkovich 1987 ljungkrona and sundèn 1993 wu et al 1994 for two in line stationary cylinders three main flow regimes were identified based on the centre to centre spacing ratio s x d at small s x d the shear layers separated from the upstream cylinder wrap around the downstream cylinder without reattaching onto its surface and form a single kármán vortex street in the wake extended body regime with a slight increase in s x d the separated shear layers from the upstream cylinder reattach onto the surface of the downstream cylinder reattachment regime when s x d is increased beyond the critical spacing ratio s x c d vortex shedding starts to occur from the upstream cylinder co shedding regime according to xu and zhou 1988 s x c d at which the shear layer reattachment switched to alternate vortex shedding behind the upstream cylinder varied from 3 5 to 5 0 depending on the reynolds number r e u d ν where u is the freestream velocity d is the cylinder diameter and ν is the kinematic viscosity of the fluid when one or two cylinders in the tandem system are allowed to vibrate freely the wake modes become rather complex leading to more unique vibration phenomena of the cylinders compared to the abundant research on the flow past two tandem stationary cylinders there have been fewer studies on the fiv responses and flow patterns of two elastically mounted circular cylinders in tandem arrangement and a great portion of the previous investigations were concentrated on the fiv of a downstream cylinder immersed in the wake flow of an upstream stationary one hover and triantafyllou 2001 considered the effect of the upstream cylinder wake on the fiv response of the downstream cylinder in their study s x d 4 75 and r e 30000 it was found that the downstream cylinder underwent large amplitude galloping response assi et al 2010 2013 experimentally studied the cross flow fiv characteristics of the downstream cylinder in a tandem pair for r e up to 30000 and proposed the concept of wake stiffness for the first time they observed the wake induced vibration wiv response with a continuously growing amplitude as the reduced velocity v r u f n d where u is the freestream velocity and f n is the natural frequency of the cylinder was increased the occurrence of wiv rooted in the unsteady vortex structure interactions between the downstream cylinder and its upstream wake assi 2014 further investigated the two degree of freedom 2dof wiv of the downstream cylinder subject to the stationary cylinder wake at a fixed s x d of 4 0 r e ranged from 2000 25000 the experimental data showed that once v r was increased beyond the vortex induced vibration viv synchronisation range the wiv mechanism would dominate the 2dof response in a similar way to that it dominated the one degree of freedom 1dof vibrations for a more complicated case where both cylinders may oscillate kim et al 2009 examined the transverse only fiv of two circular cylinders arranged in tandem with s x d 1 1 4 2 at r e 4365 74200 depending on s x d fluctuating lift forces and vibration characteristics of the cylinders five response regimes were identified huang and herfjord 2013 experimentally investigated the fiv of two elastically mounted cylinders placed at various tandem and staggered positions s x d was varied from 2 0 to 5 0 and r e ranged from 1 12 1 0 4 to 5 52 1 0 4 it was found that the upstream cylinder was nearly unaffected by the downstream cylinder when s x d was greater than 3 0 and the response of the downstream cylinder was dependent upon v r of the upstream cylinder and its own v r based on the actual mean wake velocity in a more recent study by armin et al 2018 similar conclusions were reached although the r e and s x d ranges were wider different s x values from 3 5 d to 20 0 d with r e 8 7 1 0 3 5 2 1 0 4 were considered in armin et al 2018 fiv of two identical elastically mounted circular cylinders in tandem arrangement was explored by xu et al 2019 r e in their experiment ranged from 2 86 1 0 4 to 1 14 1 0 5 and four spacing ratios were considered i e s x d 1 57 2 57 3 57 and 4 57 the fiv response of the upstream cylinder at s x d 1 57 was significantly different from that of an isolated cylinder whereas for the rest of the spacing ratios the dynamic behaviours of the upstream cylinder subject to fiv resembled the single cylinder within the s x d range tested the vibration and fluid forces of the downstream cylinder were obviously influenced by the upstream cylinder in terms of flexible cylinders huera huarte and bearman 2011 and huera huarte and gharib 2011 experimentally studied the viv and wiv of two flexible cylinders in tandem arrangement in a r e range up to 12000 s x d 2 0 8 0 was chosen for the largest s x d considered the downstream cylinder exhibited non classic viv resonance with large amplitudes at high v r which could be attributed to the existence of vortex shedding between the cylinders while at smaller s x d the upstream cylinder was subject to larger vibrations than the downstream one sanaati and kato 2013 examined the effect of wake interference on the dynamic responses of two pre tensioned flexible cylinders in tandem arrangement four spacing ratios from 2 75 to 11 0 were tested and r e ranged from 1400 to 20000 for all the spacing ratios considered the downstream cylinder did not show build up of the upper branch in the lock in region of the classic viv for an isolated cylinder huera huarte et al 2016 investigated the fiv of a flexible cylinder towed behind a stationary one at various spacings between 2 0 d and 6 0 d with r e 22000 the incoming wake exhibited a clear effect as the amplitude responses were considerably higher than those for an isolated one the response was also found to be more multi modal which consisted of large amplitude contributions from several adjacent modes xu et al 2018 performed experimental tests to evaluate the effect of s x d on the multi mode fiv of two tandem flexible cylinders within the r e range of 800 16000 five spacing ratios s x d 4 0 6 0 8 0 10 0 and 16 0 were considered the results showed that the fiv behaviours of the upstream cylinder were similar to an isolated one within the s x d range tested the response of the downstream cylinder obviously differed from that of the upstream one due to the wake shielding effect there have been an increasing number of numerical studies on the fiv of two circular cylinders arranged in tandem over the last decade the majority of the previous numerical studies were two dimensional 2d among which some were focussed on the 1dof transverse fiv of rigid cylinders camo et al 2011 numerically investigated fiv of a downstream cylinder in a tandem pair exposed to the wake of a fixed cylinder at a low r e of 150 for s x d 1 5 8 0 the downstream cylinder demonstrated larger vibration amplitudes and wider lock in ranges zhao 2013 conducted numerical simulations for fiv of two rigidly coupled circular cylinders in tandem arrangement at spacing ratios ranged from 1 5 to 6 0 at r e 150 it was found that the gap between the two cylinders had a significant effect on the responses of the cylinders the effect of tandem spacing on fiv of two cylinders with passive turbulence control was numerically studied by ding et al 2017 at r e 30 000 100000 s x d was varied from 2 0 to 6 0 their results showed that the influence of the downstream cylinder on the amplitude and frequency responses of the upstream cylinder was almost negligible when s x d 2 0 a build up of the downstream cylinder vibration amplitude was observed for all the cases in the r e range of 2 1 0 4 3 1 0 5 lin et al 2020 presented the numerical results for cross flow fiv of two elastically mounted cylinders arranged in tandem at subcritical r e the fiv response of the downstream cylinder was characterised by two frequency branches i e a dominant frequency branch associated with the wake interference mechanism and a secondary frequency branch related to the upstream vortex shedding mechanism numerical simulations have also been used to examine the 2dof fiv of two in line cylinders papaioannnou et al 2008 studied the effect of s x d on fiv of two rigid cylinders in tandem arrangement for s x d 2 5 5 0 at a fixed r e of 160 the response region of the upstream cylinder became wider with the decrease in s x d and there was an increase in the maximum vibration amplitude of the downstream cylinder when the cylinders were brought to s x d corresponding to the reattachment regime for the stationary system borazjani and sotiropoulos 2009 investigated fiv of two tandem cylinders with a proximity interference spacing ratio of s x d 1 5 at r e 200 at low v r the oscillation amplitude of the upstream cylinder surpassed that of the downstream one larger amplitude was observed for the downstream cylinder once v r was beyond a critical value which could be attributed to the emergence of the gap flow griffith et al 2017 expanded the work by borazjani and sotiropoulos 2009 three modes differentiated by oscillation amplitudes oscillation phase difference and gap flow vortex dynamics were identified bao et al 2012 studied the 2dof viv of two tandem cylinders with varying natural frequency ratios at r e 150 a fixed spacing ratio of s x d 5 0 was considered it was found that the in line response of the downstream cylinder was more sensitive to the natural frequency ratio camo et al 2011 compared the three dimensional 3d numerical results for fiv of an elastically mounted circular cylinder immersed in the wake of an upstream stationary cylinder at r e 300 with their 2d simulation results at r e 150 the variation trends of the 3d simulation results agreed with that of the 2d simulation results strongly three dimensional flow field was observed for most of the configurations numerical studies on fiv of two flexible cylinders in tandem arrangement were more rarely reported chen et al 2013 presented results for viv and wiv of two vertical risers in tandem and side by side arrangements at r e 8400 for two risers in tandem the vortex street between the risers was suppressed and the shear layers from the upstream riser reattached onto the downstream one at s x d 3 0 with an increase in s x d to 4 0 intermittent reattachment of the upstream riser shear layers was observed gonzález et al 2015 conducted computational fluid dynamics cfd simulation for the experimental campaign on fiv of two tandem flexible cylinders by huera huarte et al 2014 at r e 16000 the numerical results qualitatively reproduced the physical phenomena however the oversimplification of the numerical model caused numerical instability of the computation the cross flow fiv of two flexible cylinders in tandem arrangement with s x d ranging from 2 5 to 5 0 at r e 500 was studied using a two way fsi method in wang et al 2017 it was observed that the responses of the two flexible cylinders were similar to the classic viv response at small s x d once s x d was large enough for the vortices to be shed from the upstream cylinder the response of the upstream cylinder resembled the typical viv response whereas the downstream cylinder underwent wiv it can be interpreted that the existing publications on fiv of two circular cylinders in tandem arrangement were mostly experiments and the majority of the previous numerical studies mainly lay in the low r e laminar flow regime systematic numerical investigations which can reflect the effect of s x d on fiv of two in line cylinders at subcritical r e are still quite limited in this study 2dof fiv of two elastically mounted circular cylinders arranged in tandem at r e 1470 10320 is explored numerically for four spacing ratios i e s x d 3 0 4 0 5 0 and 8 0 particular attention is paid to the influence of s x d on important aspects of fiv such as the dynamic responses the hydrodynamic coefficients and the wake patterns with the purpose of revealing the underlying fsi mechanisms the outline of the paper is as follows the numerical methods adopted in the numerical simulations are provided in section 2 section 3 gives a detailed description of the problem investigated in the present study in section 4 the results for the fiv of two tandem circular cylinders at various spacing ratios are presented and analysed finally the main findings and conclusions of this paper are summarised in section 5 2 numerical method 2 1 flow model the flow around the circular cylinders is modelled by solving the 2d unsteady incompressible reynolds averaged navier stokes rans equations on overset grids the mathematical formulations are as follows 1 u i x i 0 2 u i t u j u i x j 1 ρ p x i x j 2 ν s i j u i u j where x 1 and x 2 are the cartesian coordinates in the in line and cross flow directions respectively u i is the fluid velocity component in x i direction t represents the time ρ stands for the fluid density p is the pressure and s i j denotes the mean strain rate tensor defined as 3 s i j 1 2 u i x j u j x i according to boussinesq s hypothesis boussinesq 1877 schmitt 2007 the reynolds stress tensor can be written in the following way 4 u i u j 2 ν t s i j 2 3 k δ i j where ν t represents the eddy viscosity and k stands for the turbulent kinetic energy and δ i j is the kronecker symbol the shear stress transport sst k ω turbulence model is employed to approximate the eddy viscosity herein ω is the specific dissipation rate this model was first proposed by menter 1994 and has been found to give a good prediction of the adverse pressure gradient flows zhao and cheng 2011 gao et al 2018 the governing equations are as follows 5 k t u j k x j p k β k ω x j ν σ k ν t k x j 6 ω t u j ω x j γ ν t p k β ω 2 x j ν σ ω ν t ω x j 2 1 f 1 σ ω 2 1 ω k x j ω x j where β 0 09 and the function f 1 is defined by 7 f 1 tanh min max k β ω y w 500 ν y w 2 ω 4 σ ω 2 k c d k ω y w 2 4 with c d k ω max 2 σ ω 2 1 ω k x j ω x j 1 0 20 and y w being the distance to wall the production of the turbulent kinetic energy is 8 p k τ i j u i x j and it is limited by p k min p k 10 β k ω the turbulent eddy viscosity is computed by 9 ν t k ω 1 max 1 α s f 2 a 1 ω where α is a coefficient s 2 s i j s i j and a 1 0 31 the function f 2 is defined by 10 f 2 tanh max 2 k β ω y w 500 ν y w 2 ω 2 the coefficient α damps the turbulent viscosity causing a low r e correction it is expressed as 11 α α α 0 r e t r k 1 r e t r k where α 1 r e t k ν ω r k 6 α 0 β i 3 and β i 0 072 all the constants σ k σ ω β and γ are computed by a blend from the corresponding constants using ϕ f 1 ϕ 1 1 f 1 ϕ 2 in which f 1 can be calculated from eq 7 and the values of ϕ 1 and ϕ 2 are given in table 1 the commercial software package ansys fluent ansys inc 2020 is adopted to solve the fsi problem in this paper the governing equations are discretised with a finite volume method fvm a first order implicit scheme is employed for time marching while a second order upwind scheme is used to discretise the convective terms a pressure based coupled algorithm solves a coupled system of equations comprising the continuity equation and the momentum equations the overset also known as chimera mesh method is used to handle the dynamic mesh this method is convenient to deal with problems which involve large displacements and or relative motion of multiple bodies without causing excessive deformation of the mesh each object of interest is wrapped with a body fitted mesh and overlapped with other stationary or moving meshes cells are marked as fringe cells which need interpolation from other meshes field cells which are involved in the solution of the governing equations and hole cells that lie inside the solid body in the present study a distance weighted function as shown in eq 12 is employed to facilitate the exchange of information between different meshes 12 ϕ r i 1 n ϕ i d i i 1 n 1 d i where ϕ r is the flow variable at the receptor n stands for the number of donors ϕ i represents the flow variable at donor i and d i denotes the distance from a donor i to its receptor 2 2 structural dynamic model according to zhao and cheng 2011 and wang et al 2017 the 2dof motion for each of the elastically mounted circular cylinders in the tandem pair is given by 13 m x x c x x k x x f x 14 m y y c y y k y y f y where x and y are the in line and cross flow displacements a dot denotes differentiation with respect to time m x and m y are the cylinder masses per unit length in the x and y directions c x and c y are the structural damping coefficients in the x and y directions and k x and k y are the structural stiffnesses in the x and y directions in the present study it is assumed that the two cylinders have identical structural properties and these properties are the same in the in line and cross flow directions i e m x m y m c x c y c and k x k y k the identical mass ratios of the cylinders are calculated by m 4 m ρ π d 2 the damping coefficients can be nondimensionalised by the critical damping inferring the damping ratios ζ c 2 m m a k where m a is the added mass and the natural frequencies in water are expressed as f n k m m a 2 π a fourth order runge kutta method as used by gao et al 2018 2020 is employed to integrate eqs 13 and 14 the interested readers may refer to those papers gao et al 2018 2020 for detailed formulations of the runge kutta method 2 3 fluid structure interaction the fsi problem can be solved by using a loosely coupled approach wang et al 2018 2019 in this approach the information hydrodynamic loads and motion quantities of the cylinders is exchanged between the flow model and the structural dynamic model at each time step with no subiterations being performed a brief summary of the fsi procedures is as follows i the interpolation stencils are generated for the communication between the different meshes and the navier stokes equations are solved to derive the in line and cross flow hydrodynamic forces f x and f y computed by summing the dot products of the pressure and viscous forces with the specified force vectors on the circular cylinders ii f x and f y are transferred to the structural dynamic model to yield the motion quantities of the cylinders iii the new mesh configuration is evaluated based on the motion quantities of the cylinders and the interpolation stencils are updated and iv the navier stokes equations are solved on the new mesh configuration this fsi loop is repeated in every time step until the end of the simulation in the present study a user defined function udf written in c programming language is compiled in ansys fluent to compute f x and f y then to substitute them into eqs 13 and 14 and finally to solve the motion equations with the fourth order runge kutta method 3 description of the problem 3 1 simulation parameters fiv of two elastically mounted circular cylinders in tandem arrangement at different spacing ratios is numerically investigated in this study the cylinders are free to vibrate simultaneously in the in line and cross flow directions it is assumed that the two cylinders both possess the same structural parameters as the one in the experiment by jauvtis and williamson 2004 with identical mass ratios and mass damping parameters being m 2 6 and m c a ζ 0 013 respectively such low mass ratios are selected because cylindrical structures in offshore applications usually have mass ratios of the same order of magnitude and moreover a dramatic change in the fsi of 2dof viv of a single cylinder was observed in jauvtis and williamson 2004 when m 6 0 similar to the experiment the identical in line and cross flow natural frequencies of each cylinder are kept constant as f n 0 4 hz v r is systematically varied from 2 0 to 14 0 by increasing u the corresponding r e ranges from 1470 to 10320 belonging to the subcritical flow regime four different spacing ratios are considered in the simulation i e s x d 3 0 4 0 5 0 and 8 0 the effect of s x d on the response features hydrodynamic characteristics and wake patterns of the two tandem cylinders undergoing oscillations is examined the choice of s x d mainly covers the reattachment and co shedding regimes of two tandem stationary cylinders with the critical spacing ratio range specifically being taken into account within the present parameter space s x d 3 0 would result in the collision of the two cylinders which involves more complicated mechanisms and is also beyond the scope of this study thus the smallest s x d is chosen as 3 0 3 2 computational domain and boundary conditions a 60 d 40 d planar computational domain as shown in fig 1 a is used in the present study the origin of the cartesian coordinate system is situated at the centre of gravity cog of the upstream cylinder while the cog of the upstream cylinder is located at 20 d downstream the inlet boundary along the longitudinal centreline of the domain the computational mesh and a close up of the mesh around the cylinders are depicted in fig 1 b and c respectively o grid zones extending up to 2 5 d radially from the cylinder centres are generated as the component meshes on top of the background mesh the surface of each cylinder is discretised by 160 nodal points and the minimum mesh size adjoining the cylinder surface in the radial direction is 0 001 d the nondimensional distance y is defined as y u f y w ν where u f is the friction velocity and y w stands for the wall normal distance the y value in the present simulation is maintained less than 1 the background mesh is refined near the cylinders and in the wake region in order to better capture the flow features in those regions the boundary conditions for the governing equations are as follows the surfaces of the cylinders are assumed to be smooth where a no slip boundary condition is employed at the wall boundary the turbulent kinetic energy k is zero and the specific dissipation rate ω is given by ω w 6 ν w β 1 y w 2 where ν w is the kinematic viscosity of the fluid near the wall the inlet boundary conditions are set as u u and v 0 and turbulence intensity and turbulence length scale are respectively i 0 9 govardhan and williamson 2006 and l 0 07 d ansys inc 2020 at the outlet boundary the gradients of the fluid velocity and the turbulent quantities in the direction normal to the boundary are set to be zero pressure at the outlet boundary is given a reference value of zero a slip boundary condition is imposed on the two lateral boundaries at t 0 the cylinders are assumed to be at rest with zero displacements and velocities as it was used by han et al 2018 a static flow field is adopted to initialise the simulation in order to reproduce the super upper response branch a mesh dependency study is conducted to ensure that further refinement of the mesh makes little difference on the results 2dof fiv of two circular cylinders in tandem arrangement with s x d 5 0 and v r 8 0 is simulated using three different meshes and the comparison of the results is tabulated in table 2 n c n c m e and n b m e are respectively the number of nodes in the circumferential direction of each cylinder the number of elements of each body fitted component mesh and the number of elements of the background mesh quantitative comparisons are made for the in line and cross flow dimensionless response amplitudes a x d and a y d the mean drag coefficients c d and the root mean square rms values of the drag and lift coefficients c d and c l for both the upstream and downstream cylinders c d and c l are defined as c d f x 0 5 ρ u 2 d and c l f y 0 5 ρ u 2 d respectively it can be seen from the table that the maximum difference between the results from m1 and m2 is about 1 85 occurring in a x d of the downstream cylinder for the rest of the results computed using the two meshes the differences remain less than 1 32 as the mesh is densified from m2 to m3 the maximum difference between the results from the two meshes reduces to around 1 1 and it appears in a x d of the upstream cylinder the differences for the remainder of the results are below 1 the comparison of the results from the different meshes suggests that the mesh density of m2 is sufficient for providing acceptable accuracy for simulating fiv of two tandem cylinders in the present study for all the cases the time step sizes are selected to satisfy the condition that the courant number is less than 0 5 3 3 validation test the numerical method is first verified by performing a simulation for the 2dof viv of an elastically mounted circular cylinder in order to facilitate the comparison the same structural parameters as those in jauvtis and williamson 2004 are adopted details about the structural parameters in the experiment are also described in section 3 1 of this paper fig 2 shows the comparison of the amplitude and cross flow frequency responses between the present numerical results with the experimental data it can be seen that good agreement is reached between the two sets of results the super upper branch with large oscillation amplitudes in both the in line and cross flow directions is successfully reproduced the vortex wake modes from the present simulation at four different reduced velocities i e v r 2 0 3 0 8 0 and 9 0 are demonstrated in fig 3 they represent the ss mode a symmetric pair of vortices formed in each cycle the as mode two single vortices formed in each cycle the 2t mode two triplets of vortices formed in each cycle and the 2p mode two pairs of vortices formed in each cycle as per the observations by jauvtis and williamson 2004 the qualitative and quantitative agreement between the numerical and experimental results shows that the present numerical methods are capable of accurately capturing the 2dof viv response of an elastically mounted circular cylinder with low mass and damping at subcritical r e 4 results and discussion the results for 2dof fiv of two elastically mounted circular cylinders in tandem arrangement with various spacing ratios at subcritical r e are presented and analysed in this section 4 1 response amplitudes the variations of a x d and a y d of the upstream cylinder with v r are displayed in fig 4 the amplitude responses of an identical single cylinder are also included for comparison as shown in fig 4 a the in line amplitude responses of the upstream cylinder at s x d 4 0 5 0 and 8 0 follow similar trends to that of the single cylinder streamwise vibration modes are observed for v r 4 0 a x d curves for different spacing ratios reach their maxima of 0 33 at the same v r value of 8 0 the responses enter the lower branch with the increase in v r characterised by reasonably constant levels of amplitude until the synchronisations end at v r around 12 0 a dramatic change in the in line amplitude response of the upstream cylinder is observed when the cylinder pair is brought to s x d 3 0 compared to the rest of the cases the peak a x d of the upstream cylinder for s x d 3 0 increases slightly to approximately 0 34 and it shifts to a lower v r of 7 0 in the range of v r 9 0 14 0 distinct from the upstream cylinder at other spacing ratios as well as the single cylinder a relatively large a x d is maintained when s x d 3 0 similarly the transverse amplitude responses of the upstream cylinder for s x d 4 0 5 0 and 8 0 nearly coincide with that of the single cylinder a y d is rather small in the streamwise vibration modes when v r 4 0 it increases with increasing v r and peaks at v r 8 0 with a y d 1 5 corresponding to the super upper branch termed by jauvtis and williamson 2004 as v r is further increased the cross flow amplitude responses of the upstream cylinder jump to the lower branch and a y d levels off at around 0 65 before it diminishes in the desynchronisation range discrepancies in the cross flow amplitude responses are observed for the upstream cylinder between the s x d 3 0 case and the other cases especially at high v r when s x d 3 0 the maximum a y d of the upstream cylinder is slightly smaller taking the value of 1 3 and appears at a lower reduced velocity of v r 7 0 a y d reaches a plateau at approximately 0 75 in the range of v r 8 0 10 0 it then starts to decrease gradually with the increase in v r it is particularly noted that for v r 13 0 and 14 0 a y d of the upstream cylinder for s x d 3 0 still remains at around 0 3 0 4 which is obviously larger than the other cases in general the in line and cross flow amplitude responses of the upstream cylinder for s x d 4 0 5 0 and 8 0 resemble those of the single cylinder indicating that the presence and vibrations of the downstream cylinder have an almost negligible influence on the fiv of the upstream cylinder when s x d 4 0 papaioannnou et al 2008 put forward that when vortex shedding was initiated behind the upstream cylinder it acted similarly to a single cylinder it can therefore be deduced that wake behind the upstream cylinder for s x d 4 0 8 0 is fully developed some differences exist in the in line and cross flow amplitude responses of the upstream cylinder at s x d 3 0 in particular when v r is high the response curve widths in terms of v r of the upstream cylinder increase at this small s x d similar observations have also been reported by papaioannnou et al 2008 in their numerical simulation at low r e it is preliminarily inferred that the distinct response features of the upstream cylinder when s x d 3 0 could be attributed to the strong interference in the gap flow caused by the oscillations of the downstream cylinder fig 5 illustrates a x d and a y d of the downstream cylinder as functions of v r due to the influence of the upstream cylinder oscillations and its associated wake the downstream cylinder possesses completely different response curves from those of the single cylinder as shown in fig 5 a multiple peaks appear in a x d of the downstream cylinder for the spacing ratios considered the multi peak responses of the downstream cylinder have also been observed by bao et al 2012 and yu et al 2016 in their numerical simulations and by armin et al 2018 in their experimental tests the downstream cylinder undergoes appreciable in line oscillations with noticeably higher amplitudes than the single cylinder case in the range of 3 0 v r 5 0 this peak of a x d is mainly related to the vortex shedding of the upstream cylinder as v r is increased a x d of the downstream cylinder experiences several humps the maximum a x d values of the downstream cylinder at different s x d are reached in the v r range of 10 13 which are much higher than the v r associated with the maximum a x d of the single cylinder due to the shielding effect of the upstream cylinder the velocity of the flow passing the trailing cylinder is less than the freestream velocity therefore the delay in v r corresponding to the maximum a x d of the downstream cylinder can be attributed to the shielding effect in addition the maximum a x d decreases slightly with increasing s x d the reduction in the maximum a x d is due to the weakening of the buffeting force on the downstream cylinder at larger s x d as the upstream vortices lose a fraction of energy as a result of dissipation the a x d curves for all the s x d considered exhibit decline once they pass their maxima however the in line amplitude response of the downstream cylinder at s x d 3 0 demonstrates an upward trend at the high end of the v r range in this study a y d curves of the downstream cylinder at different s x d also exhibit multiple peaks the first a y d peak accompanies the first peak of a x d in the range of v r 3 0 5 0 as v r is increased a y d starts to increase gradually and the maximum a y d values of the downstream cylinder for different s x d appear at v r values identical to those associated with the maximum a x d values only the maximum a y d at s x d 3 0 is evidently larger than that of the single cylinder while those for the other cases are of similar magnitudes as mentioned previously with the decrease in the buffeting force of the upstream vortices on the downstream cylinder its maximum a y d also reduces with the growth of s x d after the maxima of a y d the curves start to decrease when v r is further increased similar to in line responses a y d for s x d 3 0 also shows the tendency to increase at high v r in contrast to assi 2014 the build up of the response amplitudes with v r beyond the viv resonance range for the downstream cylinder is not observed in the present simulation assi 2014 attributed the increase in the amplitudes at high v r to the unsteady vortex structure interactions and introduced the wake stiffness concept to explain the phenomenon it should be noted that the upstream cylinder in assi s experiment was fixed whereas that in the present study is free to oscillate in both the in line and cross flow directions the vortex shedding of the upstream cylinder in our simulation is more complex compared to his experiment therefore the wake stiffness is subject to larger variations and it might not be as dominant as the one in assi 2014 it is deduced that this could be the cause of the disappearances of the continuously increasing a x d and a y d at s x d 4 0 8 0 when both cylinders were allowed to vibrate as in armin et al 2018 and xu et al 2019 qualitatively similar downstream cylinder amplitude responses to our simulation were observed 4 2 response frequencies the normalised power spectral density psd plots of the in line and cross flow displacements of the two cylinders as functions of v r and the nondimensionalised oscillation frequencies f o x f n and f o y f n are presented in fig 6 along with the dominant vibration frequencies the blue dash lines in the figure denote the dominant oscillation frequencies of the single cylinder as shown in the figure in some cases the cylinder responses consist of multiple frequency components especially for the in line responses there are also cases with single frequency responses the transverse dominant frequencies of the two cylinders agree fairly well with that of the single cylinder as v r is increased whereas the streamwise dominant frequencies of the tandem cylinder pair demonstrate large discrepancies with in line frequency response of the single cylinder thus it can be interpreted that the in line vibration frequencies of both the upstream and downstream cylinders are more influenced than those in the cross flow direction the in line dominant frequencies of the two cylinders follow that of the single one at low v r with their values twice the corresponding transverse vibration frequencies as v r is increased the in line dominant frequencies of both cylinders deviate from that of the single cylinder and low frequency components predominate the streamwise responses of both cylinders at high v r the low frequency components in the streamwise direction have also been reported by huang and sworn 2011 and armin et al 2018 for two tandem cylinders and by assi 2014 for the downstream cylinder they are believed to take root in the interactions between the wake of the upstream cylinder and the oscillating downstream cylinder it is observed that the smaller s x d is the more distinct the differences in the in line dominant frequencies between the upstream cylinder and the single one become this is because for a smaller s x d the downstream cylinder interacts with the upstream wake closer to the leeside of the upstream cylinder imposing a stronger impact on it and this impact gets weaker with the increase in s x d for the downstream cylinder because of the stronger wake shielding effect and the flow velocity over the downstream cylinder being slower the in line dominant frequencies of the downstream cylinder at s x d 3 0 are lower than the other spacing ratios the observations for the frequency responses of the downstream cylinder at high v r are qualitatively analogous to that of assi 2014 i e the low frequency components dominate the in line response at high v r while the cross flow frequency curves follow that of the single cylinder as explained by assi 2014 these observations could be possibly attributed to the 2dof wiv of the downstream cylinder however due to the fact that the upstream cylinder is free to vibrate in the present simulation its vortex shedding is more complicated than an upstream stationary cylinder leading to more complex interactions between the upstream wake and the downstream cylinder therefore the low in line dominant frequency at high v r does not show an almost linearly increasing trend as reported in assi 2014 4 3 orbital trajectories the orbital shape of a cylinder is critical in defining the amplitude and frequency contents of the hydrodynamic forces dahl et al 2008 and the direction of the orbital motion is closely related to the energy transfer between the fluid and structure bourguet et al 2013 therefore it is of importance to examine the orbital trajectories of the two tandem cylinders for different spacing ratios fig 7 shows the variations of the orbital trajectories with v r at different s x d for the two cylinders arranged in tandem it can be seen from the figure that the orbital trajectories of the upstream cylinder vary similarly to the single cylinder as in jauvtis and williamson 2004 blevins and coughran 2009 dahl et al 2010 and srinil et al 2013 with respect to v r in similar subcritical r e ranges at the low end of v r the upstream cylinder is subject to nearly pure in line motion with the increase in v r the orbital trajectories develop into figure eight shapes corresponding to the 2 1 in line to cross flow dominant frequency ratios in fig 6 the figure eight trajectories indicate the occurrence of dual resonance bao et al 2012 dahl et al 2006 2010 srinil et al 2013 wang et al 2017 when a x d and a y d reach their maxima the trajectories of the upstream cylinder exhibit crescent shapes as reported by jauvtis and williamson 2004 the orbital trajectories of the upstream cylinder for s x d 3 0 become nonrepeatable at high v r indicating the modulatory nature of the cylinder motion which is caused by the interference of the downstream cylinder this interference is weakened by increasing s x d oblique figure eight trajectories similar to those reported by kang and jia 2013 gedikli and dahl 2014 and wang et al 2017 are observed for the upstream cylinder when v r 9 0 these asymmetric lissajous figures can be attributed to the low frequency components in the in line vibrations apart from the dominant frequency component at twice the cross flow oscillation frequency unlike its upstream counterpart the motion trajectories of the downstream cylinder are more unstable and irregular due to the interference of the upstream wake as shown in fig 7 b the in line vibration of the downstream cylinder is dominated by broadband low frequency contents mixed with higher harmonic frequencies for the range of v r considered the downstream cylinder demonstrates nonperiodic orbits composed of figure eight and oval shapes with the equilibrium positions shifting unrepeatably from cycle to cycle these trajectories are associated with the complex vortex shedding in the near wake region relatively periodic oval orbits are only observed at v r 10 0 when s x d 4 0 where the oscillating frequencies approach the natural frequencies in the two directions 4 4 hydrodynamic coefficients fig 8 shows the variations of c d c d and c l of the two tandem cylinders with v r for different s x d in comparison with those of the single cylinder undergoing viv for the r e range considered in the present study when s x d 4 0 8 0 the spacing is large enough for the free shear layers separated from the upstream cylinder to roll up into vortices leading to an almost fully developed wake behind the upstream cylinder the downstream cylinder demonstrates limited influence on c d c d and c l of the upstream cylinder bao et al 2012 also claimed that the hydrodynamic force coefficient curves of the upstream cylinder were near those of the single one for s x d 5 0 at a low r e of 150 whereas as s x d is decreased to 3 0 c d c d and c l of the upstream cylinder deviate slightly from those of the single one this indicates that the reduction in s x d intensifies the interference effect of the downstream oscillating cylinder on the near wake of the upstream one in contrast the hydrodynamic force coefficients of the downstream cylinder are quite different from those of the upstream and single cylinders due to the effect of the upstream wake for low v r c d values of the downstream cylinder are evidently smaller than those of the single cylinder except for v r 4 0 and s x d 5 0 this is because the real flow velocity past the downstream cylinder is deficient under the wake shielding effect c d of the downstream cylinder approaches that of the single cylinder at high v r corresponding to its lower response branch as the flow velocity in the gap recovers there exist multiple peaks in c d of the downstream cylinder when v r is low the convecting vortices from the upstream cylinder is gradually generated and the in line oscillations of the downstream cylinder is hence excited in the meanwhile a peak in the c d is also observed in the range of v r 6 0 8 0 a y d of the upstream cylinder is larger than the downstream one and the vortices shed from the upstream cylinder envelop the trajectories of the downstream cylinder leading to the troughs of the c d curves nevertheless at high v r a y d of the downstream cylinder predominates that of the upstream one thus the upstream vortices are fully developed and able to impinge perpetually onto the downstream cylinder which causes the fluctuations in c d of the downstream cylinder as depicted in fig 8 e and f the c l peaks of the downstream cylinder are slightly larger than those of the upstream one at low v r similar to the conclusion of prasanth and mittal 2009 it is speculated that the upstream wake has a strong effect on the boundary layers over the downstream cylinder surface enhancing the intensity of the vortex shedding behind it c l of the downstream cylinder tends to decline with increasing v r after the first peaks of the in line and cross flow amplitude responses beyond v r 9 0 c l of the downstream cylinder reaches a plateau or rises gradually with the overall values larger than that of the single cylinder at high v r the downstream cylinder is obviously excited by the wake and the wiv counteracts the influence of the viv desynchronisation however xu et al 2019 found that c l of the downstream cylinder and that of the single one were alike at high v r for similar s x d due to the higher r e considered by xu et al 2019 the upstream vortices in their experiment are more unstable and dissipative hence the response of the downstream cylinder was less affected the hydrodynamic forces on the oscillating cylinders in each direction can be decomposed into two components those in phase with the velocities are referred to as the in line and cross flow excitation coefficients c e x and c e y and the ones in phase with the accelerations are named the in line and cross flow added mass coefficients c a x and c a y song et al 2016 xu et al 2021b according to song et al 2016 and xu et al 2021a the hydrodynamic forces in the in line and cross flow directions f x and f y can be expressed respectively as 15 f x ρ u 2 d 2 2 x r m s c e x x ρ π d 2 4 c a x x 16 f y ρ u 2 d 2 2 y r m s c e y y ρ π d 2 4 c a y y where x r m s and y r m s are the rms values of the response velocities in the in line and cross flow directions respectively a least squares method by song et al 2016 is employed to determine the four hydrodynamic coefficients and the following equations show the detailed derivations 17 c e x 2 2 x r m s ρ u 2 d g 2 g 5 g 3 g 4 g 2 2 g 1 g 4 18 c a x 4 ρ π d 2 g 1 g 5 g 2 g 3 g 2 2 g 1 g 4 19 c e y 2 2 y r m s ρ u 2 d g 7 g 10 g 8 g 9 g 7 2 g 6 g 9 20 c a y 4 ρ π d 2 g 6 g 10 g 7 g 8 g 7 2 g 6 g 9 where g 1 i 1 m x 2 g 2 i 1 m x x g 3 i 1 m f x x g 4 i 1 m x 2 g 5 i 1 m f x x g 6 i 1 m y 2 g 7 i 1 m y y g 8 i 1 m f y y g 9 i 1 m y 2 and g 10 i 1 m f y y the variations of c a x with v r for the two tandem cylinders are depicted in fig 9 a and b c a x of the upstream cylinder in all cases declines with increasing v r following the c a x trend of the single cylinder for v r 10 0 this decline in c a x is also reflected from the increase of f o x f n in fig 6 as the low oscillation frequency components grow at high v r the upstream cylinder has slightly larger c a x compared to the single cylinder case larger deviations in c a x are observed between the downstream cylinder and the single one as the low frequency components are more predominant in the in line oscillations of the downstream cylinder the c a x curves of the downstream cylinder are also more modulatory which is associated with the larger variations of f o x f n as shown in fig 6 fig 9 c and d demonstrate c a y of the two cylinders in tandem against v r the c a y curves of the upstream cylinder are in good agreement with that of the single cylinder for s x d 4 0 5 0 and 8 0 except for the range of v r 2 0 6 0 there exist slight differences in v r values corresponding to the maximum c a y for all the s x d considered c a y of the downstream cylinder is qualitatively similar to those of the upstream cylinder and the single one with no obvious peaks when v r 3 0 6 0 as s x d is increased the c a y curves of the downstream cylinder approach that of the single cylinder c a y values of both cylinders decrease with the increase in v r which is also indicated by the increasing trend of f o y f n as observed from fig 6 overall the deviations of c a y from the single cylinder results are not as evident as c a x the c e x curves with respect to v r of the two cylinders arranged in tandem are presented in fig 9 e and f the in line vibrations of the two cylinders are more susceptible to the complex interference such as the gap suction impingement of vortices shear layer reattachment etc in the meanwhile the interaction between the two cylinders is also rather strong the changes in c e x as functions of v r are consequently more complex and fluctuating at s x d 8 0 a larger c e x is found between v r 6 0 and 8 0 for the upstream cylinder indicating that the vortex street behind it is better developed whereas c e x values of the downstream cylinder get closer to zero at high v r when the influence of the upstream vortices on the in line excitation is weakened fig 9 g and h are the variations of c e y versus v r it is noted that the transverse vibrations of the two cylinders are affected by the in line motion in the present study consequently the variation trends of c e y are more complex compared with the 1dof results obtained by xu et al 2019 c e y of the upstream cylinder is analogous to that of the single one when v r 6 0 for smaller s x d c e y of the upstream cylinder hits the trough at v r 4 0 or 5 0 c e y of the downstream cylinder experiences more fluctuations compared to the single cylinder case with the increase in s x d the fluctuations tend to be smoothed and thus the variation trends of c e y are more consistent with that of the single one furthermore the c e y curves of both cylinders at high v r slowly decrease and approach to zero reflecting the self limiting feature of the fiv 4 5 wake patterns the analyses of the wake patterns provide insights into the underlying mechanisms of the wake cylinder interference which can be useful for explaining the specific fiv phenomena and characteristics from the results discussed above this section presents the wake patterns of different cases at representative v r values figs 10 and 11 exhibit the vorticity contours at various v r for different s x d at low v r v r 4 0 except for the case with s x d 8 0 the vortices detached from the upstream cylinder interact strongly with the downstream one so that irregular small vortices develop behind it for s x d 8 0 the spacing between the two cylinders is large enough for a full single vortex street to be formed in the gap region the vortex shedding from the downstream cylinder becomes more periodic with a slight increase in v r the downstream cylinder for all the s x d considered is entirely trapped in the parallel vortex street from its upstream counterpart and the vibrations of the downstream cylinder are inhibited when v r is increased to 8 0 the 2t vortex shedding mode two triplets of vortices being shed per cycle discovered by jauvtis and williamson 2004 gives rise to the large amplitude vibrations of the upstream cylinder in cases of s x d 4 0 5 0 and 8 0 the strong buffeting force of the 2t vortex shedding mode leads to the increase in the vibration amplitudes of the downstream cylinder for the case of s x d 3 0 and v r 8 0 the shear layers separated from the upstream cylinder fail to roll up into the triplets of vortices and thus the response amplitudes of the upstream cylinder drop in advance in the range of v r 10 0 12 0 the oscillation amplitudes of the downstream cylinder exceed those of the upstream one when s x d 3 0 and 4 0 the shear flow dominates in the gap however at s x d 5 0 and 8 0 vortex shedding occurs in the gap region finally when v r rises to 14 0 regular 2s vortex shedding mode two single vortices being shed per cycle is formed behind both cylinders as their response amplitudes are attenuated for the s x d considered in the present study more detailed discussions about the wake patterns are as follows when v r 2 0 both cylinders are subject to in line vibrations the vibration of the upstream cylinder is caused by the symmetric vortex shedding and the vortices develop into kármán vortex street as they are convected downstream the symmetric vortex shedding leads to the in line dominant frequency of the upstream cylinder being around f n whereas the downstream cylinder is exposed to the upstream vortices and the vortices interact with the shear layers of the downstream cylinder at v r 4 0 for the s x d values considered the response of the upstream cylinder is in the initial branch while the downstream cylinder exhibits an evidently larger a x d according to the analyses in section 4 1 as shown in fig 10 c and d and fig 11 c and d the upstream vortices continuously impinge on the surface of the downstream cylinder which enhances its drag fluctuations the interactions between the upstream vortices with the shear layers of the downstream cylinder lead to the irregular vortex street in the near wake of the downstream cylinder and the less fluctuating lift when v r is increased to around 6 0 the downstream cylinder is confined within the double row vortex street of the upstream one owing to the shielding effect u around the downstream cylinder is significantly reduced it can be seen from fig 10 e and f and fig 11 e and f that the vorticity in the shear layers separated from the downstream cylinder is weak and these shear layers coalesce with the upstream vortices with the same sign and are convected downstream hence the vortex shedding from the downstream cylinder is suppressed and its vibrations are restrained similar observations have also been reported by borazjani and sotiropoulos 2009 and bao et al 2012 it is observed from fig 4 that the upstream cylinder reaches its maximum vibration amplitudes at slightly lower v r of 7 0 the vorticity contours at different time instants in one oscillation cycle of the upstream cylinder for this specific case are shown in fig 12 the two cylinders are vibrating out of phase this allows enough spacing for the shear layers from the upstream cylinder to develop into the 2t vortex shedding mode which triggers the large amplitude vibration of the upstream cylinder in contrast the downstream cylinder is completely trapped in the wake of the upstream one and the its vibration is subsequently suppressed the immersion of the downstream cylinder in the upstream wake has also been reported by borazjani and sotiropoulos 2009 in their numerical simulation for a smaller s x d at a lower r e as v r is increased to 8 0 the response amplitudes of the upstream cylinder for s x d 3 0 drop earlier than the other s x d values a y d of the downstream cylinder is enhanced by the upstream wake fig 13 presents the vorticity contours at different time instants in one vibration cycle of the upstream cylinder for s x d 3 0 and v r 8 0 for this case in the present study the shear layers separated from the upstream cylinder cannot roll up fully in the narrow gap but are squeezed by the downstream one as a result the response amplitudes of the upstream cylinder decrease on the other hand the gap flow adds additional vorticity in the near wake of the downstream cylinder which enlarges its a y d for s x d 4 0 the spacing between the two cylinders at v r 8 0 is large enough for the 2t wake mode to be formed behind the upstream cylinder consequently the amplitude responses of the upstream cylinder are similar to those of the single one in the range of v r 10 12 the upstream cylinder is in the lower response branch of classic viv the downstream cylinder demonstrates various response characteristics governed by the complex wake mechanisms for s x d 3 0 and v r 10 0 the oscillation amplitudes of the two tandem cylinders increase fig 14 presents the vorticity contours when the downstream cylinder moves to peaks in the positive y direction it can be seen that for this small s x d due to the vibrations of the two cylinders the shear layers of the upstream cylinder are able to roll up but cannot become completely detached instead they are stretched and pushed through the gap by the downstream cylinder the alternately swinging pattern of the shear layers forms a fishtail like wake in the gap in contrast the downstream cylinder encounters varying wake patterns from cycle to cycle because of the vigorous coupling between the wakes of the two cylinders for this small s x d the interactions between the vortices from the two cylinders are enhanced both squeeze and coalescence of the vortices are observed based on the discussions of camo et al 2011 the downstream cylinder gains a large lift as a result of the oscillating gap flow the unsteady interactions between the upstream vortices and the motion of the downstream cylinder play a key role in transferring energy from the flow to the downstream cylinder that keeps its amplitudes at high levels fig 15 shows the variations of the vorticity contours in the wakes of the two cylinders at time instants when the downstream cylinder is at peaks of y d for s x d 4 0 and v r 11 0 compared to the case of s x d 3 0 and v r 10 0 the vibration amplitudes of both cylinders are smaller at some time instants the vortices are able to be entirely shed from the upstream cylinder whereas at other instants the shear layers from the upstream cylinder interact with those of the downstream one analogous to the observations from fig 14 the upstream wake impinging on the downstream cylinder is different for different vibration cycles when s x d is increased to 5 0 vortices from the upstream cylinder emerge in the gap region in contrast to figs 14 and 15 the wake patterns encountered by the downstream cylinder in different vibration cycles are almost the same as shown in fig 16 as depicted in fig 17 vortex shedding is also found in the gap for s x d 8 0 and v r 12 0 semblable vortex patterns are found for different cycles indicating that the wake cylinder interactions occur at similar timing when v r is increased to 13 14 it is found that the vibrations of the two cylinders become weak except for s x d 3 0 based on the analyses in section 4 1 as shown in fig 10 m and n and fig 11 m and n the downstream cylinder is influenced by the periodic 2s wake mode of the upstream one for s x d 3 0 the gap flow brings about the low excitation frequency components in the in line oscillation of the upstream cylinder because of the smaller spacing the gap flow interacts with the shear layers of the downstream cylinder in the nearer wake which is deduced to be the reason for the larger amplitudes in terms of s x d 4 0 the impinging vortices on the downstream cylinder not only interact with its shear layer on the one side but also squeeze its own vortex on the other side 5 conclusions the response and hydrodynamic characteristics of two elastically mounted circular cylinders arranged in tandem undergoing fiv at subcritical reynolds numbers are investigated numerically in this study the circular cylinders are identical in terms of their structural properties with m 2 6 and m c a ζ 0 013 the reynolds number lies in r e 1470 10320 and s x d is varied from 3 0 up to 8 0 to examine the effect of the spacing ratio for the upstream cylinder the amplitude responses with respect to v r in both the in line and cross flow directions agree well with those of a single cylinder except for the smallest spacing ratio considered in the present study i e s x d 3 0 it indicates that when s x d 4 0 5 0 and 8 0 the downstream cylinder has limited effect on the responses of the upstream one which is also reflected from the similar variation trends of the hydrodynamic coefficients with v r to the single cylinder while for s x d 3 0 the peak amplitudes decrease slightly and shift to a lower v r in the meanwhile larger amplitudes are observed at high v r where the freely oscillating downstream cylinder strongly disturbs the vortex shedding from the upstream one the in line to cross flow oscillation frequency ratio f o x f o y of the upstream cylinder is approximately around 2 0 indicating the occurrence of dual resonance with its orbital trajectories mainly of a figure eight shape at high v r the contributions of the low frequency components in the in line vibrations give rise to asymmetric lissajous figures in terms of the downstream cylinder multiple peaks are observed for both the in line and cross flow amplitude responses the fiv responses and hydrodynamic characteristics of the downstream cylinder are influenced by the combination of the shielding effect and vortex buffeting of the upstream cylinder due to the shielding effect v r corresponding to the maximum amplitude of the downstream cylinder is delayed to a higher value with increasing s x d there exists a slight reduction in the maximum amplitudes because the buffeting force of the upstream cylinder wake gets weaker as the upstream cylinder in the present simulation is free to oscillate in 2dof the associated vortex shedding is more complicated and the wake stiffness experiences larger variations which results in the disappearance of the build up of the response amplitudes owing to the interactions between the upstream wake and the vibrating downstream cylinder low frequency components dominate the in line response resulting in the more chaotic orbital trajectories of the downstream cylinder at high v r c d and c l of the downstream cylinder are higher compared to the single cylinder at low v r the wake modes of the upstream cylinder are mainly symmetric vortex shedding and kármán vortex shedding the continuous impingement of the upstream vortices on the downstream cylinder leads to the development of small vortices behind it and enhances its drag fluctuations when v r is around 6 0 the large amplitude vibrations of the upstream cylinder and the associated wider wake trap the downstream cylinder in the parallel vortex street and suppress its vortex shedding the 2t vortex shedding mode is found to be related to the maximum amplitudes of the upstream cylinder the appearance of this very wake mode shifts to a lower v r as s x d is reduced the stronger buffeting force of the 2t vortex shedding mode gives rise to the increase in the vibration amplitudes of the downstream cylinder as the response amplitudes of the downstream cylinder surpass its upstream counterpart the shear flow dominates in the gap at s x d 3 0 and 4 0 whereas vortex shedding is observed for s x d 5 0 and 8 0 the corresponding vortex shedding of the two cylinders at the high end of v r in this study is in the 2s mode credit authorship contribution statement wanhai xu conceptualization data curation writing review editing supervision funding acquisition haokai wu validation investigation visualisation formal analysis writing original draft kun jia formal analysis writing review editing enhao wang methodology investigation visualisation formal analysis writing original draft supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was funded by the national natural science foundation of china grant nos 51909189 51679167 and 51979193 and the state key laboratory of ocean engineering at shanghai jiao tong university grant no 1811 
20412,two degree of freedom 2dof flow induced vibrations fiv for a pair of elastically mounted circular cylinders in tandem arrangement with varying centre to centre spacings s x are numerically studied the reynolds number range r e 1470 10320 belongs to the subcritical flow regime two identical cylinders with a mass ratio of m 2 6 and a mass damping parameter of m c a ζ 0 013 are considered in the simulation four spacing ratios s x d where d is the identical diameter ranging from 3 0 to 8 0 are employed to investigate the effect of s x d on the fiv responses hydrodynamic characteristics and wake patterns of the two cylinders it is found that the effect of the downstream cylinder on the fiv of the upstream one becomes insignificant when s x d 4 0 due to the unsteady wake cylinder interactions multi peak responses are observed for the downstream cylinder dual resonance with the 2 1 in line to cross flow oscillation frequency ratio and figure eight orbital trajectories is found to occur for the upstream cylinder in contrast the trajectories of the downstream cylinder are rather irregular because of the low frequency components in the in line response at high reduced velocity v r both shear flow and vortex shedding may appear in the gap region depending on s x d and the relative motion of the two cylinders in general the vortex shedding modes of the upstream cylinder are similar to those of a single cylinder whereas the analyses on the wake patterns suggest that the interactions of the upstream wake with the downstream cylinder and its own wake contribute to the unsteady fluid dynamics which is crucial to maintaining the large amplitude vibrations of the downstream cylinder at high v r keywords flow induced vibrations fiv tandem circular cylinders effect of spacing wake induced vibrations wiv reynolds averaged navier stokes rans 1 introduction clustered cylindrical structures in tandem configurations are common in many offshore engineering applications such as risers tendons mooring lines and subsea cables these structures are susceptible to the complex fluid structure interaction fsi phenomena known as the flow induced vibrations fiv fiv is one of the main sources of fatigue damage to offshore slender structures moreover fiv of tandem cylinders involves intricate interactions between the fluid flow and the cylinder motion owing to its theoretical value and practical significance extensive studies have been carried out relevant research progress has been reviewed by chen 1986 zdravkovich 1988 païdoussis and price 1988 moretti 1993 and bearman 1993 early studies were generally focussed on the flow fields of two stationary cylinders in tandem arrangement igarashi 1981 zdravkovich 1987 ljungkrona and sundèn 1993 wu et al 1994 for two in line stationary cylinders three main flow regimes were identified based on the centre to centre spacing ratio s x d at small s x d the shear layers separated from the upstream cylinder wrap around the downstream cylinder without reattaching onto its surface and form a single kármán vortex street in the wake extended body regime with a slight increase in s x d the separated shear layers from the upstream cylinder reattach onto the surface of the downstream cylinder reattachment regime when s x d is increased beyond the critical spacing ratio s x c d vortex shedding starts to occur from the upstream cylinder co shedding regime according to xu and zhou 1988 s x c d at which the shear layer reattachment switched to alternate vortex shedding behind the upstream cylinder varied from 3 5 to 5 0 depending on the reynolds number r e u d ν where u is the freestream velocity d is the cylinder diameter and ν is the kinematic viscosity of the fluid when one or two cylinders in the tandem system are allowed to vibrate freely the wake modes become rather complex leading to more unique vibration phenomena of the cylinders compared to the abundant research on the flow past two tandem stationary cylinders there have been fewer studies on the fiv responses and flow patterns of two elastically mounted circular cylinders in tandem arrangement and a great portion of the previous investigations were concentrated on the fiv of a downstream cylinder immersed in the wake flow of an upstream stationary one hover and triantafyllou 2001 considered the effect of the upstream cylinder wake on the fiv response of the downstream cylinder in their study s x d 4 75 and r e 30000 it was found that the downstream cylinder underwent large amplitude galloping response assi et al 2010 2013 experimentally studied the cross flow fiv characteristics of the downstream cylinder in a tandem pair for r e up to 30000 and proposed the concept of wake stiffness for the first time they observed the wake induced vibration wiv response with a continuously growing amplitude as the reduced velocity v r u f n d where u is the freestream velocity and f n is the natural frequency of the cylinder was increased the occurrence of wiv rooted in the unsteady vortex structure interactions between the downstream cylinder and its upstream wake assi 2014 further investigated the two degree of freedom 2dof wiv of the downstream cylinder subject to the stationary cylinder wake at a fixed s x d of 4 0 r e ranged from 2000 25000 the experimental data showed that once v r was increased beyond the vortex induced vibration viv synchronisation range the wiv mechanism would dominate the 2dof response in a similar way to that it dominated the one degree of freedom 1dof vibrations for a more complicated case where both cylinders may oscillate kim et al 2009 examined the transverse only fiv of two circular cylinders arranged in tandem with s x d 1 1 4 2 at r e 4365 74200 depending on s x d fluctuating lift forces and vibration characteristics of the cylinders five response regimes were identified huang and herfjord 2013 experimentally investigated the fiv of two elastically mounted cylinders placed at various tandem and staggered positions s x d was varied from 2 0 to 5 0 and r e ranged from 1 12 1 0 4 to 5 52 1 0 4 it was found that the upstream cylinder was nearly unaffected by the downstream cylinder when s x d was greater than 3 0 and the response of the downstream cylinder was dependent upon v r of the upstream cylinder and its own v r based on the actual mean wake velocity in a more recent study by armin et al 2018 similar conclusions were reached although the r e and s x d ranges were wider different s x values from 3 5 d to 20 0 d with r e 8 7 1 0 3 5 2 1 0 4 were considered in armin et al 2018 fiv of two identical elastically mounted circular cylinders in tandem arrangement was explored by xu et al 2019 r e in their experiment ranged from 2 86 1 0 4 to 1 14 1 0 5 and four spacing ratios were considered i e s x d 1 57 2 57 3 57 and 4 57 the fiv response of the upstream cylinder at s x d 1 57 was significantly different from that of an isolated cylinder whereas for the rest of the spacing ratios the dynamic behaviours of the upstream cylinder subject to fiv resembled the single cylinder within the s x d range tested the vibration and fluid forces of the downstream cylinder were obviously influenced by the upstream cylinder in terms of flexible cylinders huera huarte and bearman 2011 and huera huarte and gharib 2011 experimentally studied the viv and wiv of two flexible cylinders in tandem arrangement in a r e range up to 12000 s x d 2 0 8 0 was chosen for the largest s x d considered the downstream cylinder exhibited non classic viv resonance with large amplitudes at high v r which could be attributed to the existence of vortex shedding between the cylinders while at smaller s x d the upstream cylinder was subject to larger vibrations than the downstream one sanaati and kato 2013 examined the effect of wake interference on the dynamic responses of two pre tensioned flexible cylinders in tandem arrangement four spacing ratios from 2 75 to 11 0 were tested and r e ranged from 1400 to 20000 for all the spacing ratios considered the downstream cylinder did not show build up of the upper branch in the lock in region of the classic viv for an isolated cylinder huera huarte et al 2016 investigated the fiv of a flexible cylinder towed behind a stationary one at various spacings between 2 0 d and 6 0 d with r e 22000 the incoming wake exhibited a clear effect as the amplitude responses were considerably higher than those for an isolated one the response was also found to be more multi modal which consisted of large amplitude contributions from several adjacent modes xu et al 2018 performed experimental tests to evaluate the effect of s x d on the multi mode fiv of two tandem flexible cylinders within the r e range of 800 16000 five spacing ratios s x d 4 0 6 0 8 0 10 0 and 16 0 were considered the results showed that the fiv behaviours of the upstream cylinder were similar to an isolated one within the s x d range tested the response of the downstream cylinder obviously differed from that of the upstream one due to the wake shielding effect there have been an increasing number of numerical studies on the fiv of two circular cylinders arranged in tandem over the last decade the majority of the previous numerical studies were two dimensional 2d among which some were focussed on the 1dof transverse fiv of rigid cylinders camo et al 2011 numerically investigated fiv of a downstream cylinder in a tandem pair exposed to the wake of a fixed cylinder at a low r e of 150 for s x d 1 5 8 0 the downstream cylinder demonstrated larger vibration amplitudes and wider lock in ranges zhao 2013 conducted numerical simulations for fiv of two rigidly coupled circular cylinders in tandem arrangement at spacing ratios ranged from 1 5 to 6 0 at r e 150 it was found that the gap between the two cylinders had a significant effect on the responses of the cylinders the effect of tandem spacing on fiv of two cylinders with passive turbulence control was numerically studied by ding et al 2017 at r e 30 000 100000 s x d was varied from 2 0 to 6 0 their results showed that the influence of the downstream cylinder on the amplitude and frequency responses of the upstream cylinder was almost negligible when s x d 2 0 a build up of the downstream cylinder vibration amplitude was observed for all the cases in the r e range of 2 1 0 4 3 1 0 5 lin et al 2020 presented the numerical results for cross flow fiv of two elastically mounted cylinders arranged in tandem at subcritical r e the fiv response of the downstream cylinder was characterised by two frequency branches i e a dominant frequency branch associated with the wake interference mechanism and a secondary frequency branch related to the upstream vortex shedding mechanism numerical simulations have also been used to examine the 2dof fiv of two in line cylinders papaioannnou et al 2008 studied the effect of s x d on fiv of two rigid cylinders in tandem arrangement for s x d 2 5 5 0 at a fixed r e of 160 the response region of the upstream cylinder became wider with the decrease in s x d and there was an increase in the maximum vibration amplitude of the downstream cylinder when the cylinders were brought to s x d corresponding to the reattachment regime for the stationary system borazjani and sotiropoulos 2009 investigated fiv of two tandem cylinders with a proximity interference spacing ratio of s x d 1 5 at r e 200 at low v r the oscillation amplitude of the upstream cylinder surpassed that of the downstream one larger amplitude was observed for the downstream cylinder once v r was beyond a critical value which could be attributed to the emergence of the gap flow griffith et al 2017 expanded the work by borazjani and sotiropoulos 2009 three modes differentiated by oscillation amplitudes oscillation phase difference and gap flow vortex dynamics were identified bao et al 2012 studied the 2dof viv of two tandem cylinders with varying natural frequency ratios at r e 150 a fixed spacing ratio of s x d 5 0 was considered it was found that the in line response of the downstream cylinder was more sensitive to the natural frequency ratio camo et al 2011 compared the three dimensional 3d numerical results for fiv of an elastically mounted circular cylinder immersed in the wake of an upstream stationary cylinder at r e 300 with their 2d simulation results at r e 150 the variation trends of the 3d simulation results agreed with that of the 2d simulation results strongly three dimensional flow field was observed for most of the configurations numerical studies on fiv of two flexible cylinders in tandem arrangement were more rarely reported chen et al 2013 presented results for viv and wiv of two vertical risers in tandem and side by side arrangements at r e 8400 for two risers in tandem the vortex street between the risers was suppressed and the shear layers from the upstream riser reattached onto the downstream one at s x d 3 0 with an increase in s x d to 4 0 intermittent reattachment of the upstream riser shear layers was observed gonzález et al 2015 conducted computational fluid dynamics cfd simulation for the experimental campaign on fiv of two tandem flexible cylinders by huera huarte et al 2014 at r e 16000 the numerical results qualitatively reproduced the physical phenomena however the oversimplification of the numerical model caused numerical instability of the computation the cross flow fiv of two flexible cylinders in tandem arrangement with s x d ranging from 2 5 to 5 0 at r e 500 was studied using a two way fsi method in wang et al 2017 it was observed that the responses of the two flexible cylinders were similar to the classic viv response at small s x d once s x d was large enough for the vortices to be shed from the upstream cylinder the response of the upstream cylinder resembled the typical viv response whereas the downstream cylinder underwent wiv it can be interpreted that the existing publications on fiv of two circular cylinders in tandem arrangement were mostly experiments and the majority of the previous numerical studies mainly lay in the low r e laminar flow regime systematic numerical investigations which can reflect the effect of s x d on fiv of two in line cylinders at subcritical r e are still quite limited in this study 2dof fiv of two elastically mounted circular cylinders arranged in tandem at r e 1470 10320 is explored numerically for four spacing ratios i e s x d 3 0 4 0 5 0 and 8 0 particular attention is paid to the influence of s x d on important aspects of fiv such as the dynamic responses the hydrodynamic coefficients and the wake patterns with the purpose of revealing the underlying fsi mechanisms the outline of the paper is as follows the numerical methods adopted in the numerical simulations are provided in section 2 section 3 gives a detailed description of the problem investigated in the present study in section 4 the results for the fiv of two tandem circular cylinders at various spacing ratios are presented and analysed finally the main findings and conclusions of this paper are summarised in section 5 2 numerical method 2 1 flow model the flow around the circular cylinders is modelled by solving the 2d unsteady incompressible reynolds averaged navier stokes rans equations on overset grids the mathematical formulations are as follows 1 u i x i 0 2 u i t u j u i x j 1 ρ p x i x j 2 ν s i j u i u j where x 1 and x 2 are the cartesian coordinates in the in line and cross flow directions respectively u i is the fluid velocity component in x i direction t represents the time ρ stands for the fluid density p is the pressure and s i j denotes the mean strain rate tensor defined as 3 s i j 1 2 u i x j u j x i according to boussinesq s hypothesis boussinesq 1877 schmitt 2007 the reynolds stress tensor can be written in the following way 4 u i u j 2 ν t s i j 2 3 k δ i j where ν t represents the eddy viscosity and k stands for the turbulent kinetic energy and δ i j is the kronecker symbol the shear stress transport sst k ω turbulence model is employed to approximate the eddy viscosity herein ω is the specific dissipation rate this model was first proposed by menter 1994 and has been found to give a good prediction of the adverse pressure gradient flows zhao and cheng 2011 gao et al 2018 the governing equations are as follows 5 k t u j k x j p k β k ω x j ν σ k ν t k x j 6 ω t u j ω x j γ ν t p k β ω 2 x j ν σ ω ν t ω x j 2 1 f 1 σ ω 2 1 ω k x j ω x j where β 0 09 and the function f 1 is defined by 7 f 1 tanh min max k β ω y w 500 ν y w 2 ω 4 σ ω 2 k c d k ω y w 2 4 with c d k ω max 2 σ ω 2 1 ω k x j ω x j 1 0 20 and y w being the distance to wall the production of the turbulent kinetic energy is 8 p k τ i j u i x j and it is limited by p k min p k 10 β k ω the turbulent eddy viscosity is computed by 9 ν t k ω 1 max 1 α s f 2 a 1 ω where α is a coefficient s 2 s i j s i j and a 1 0 31 the function f 2 is defined by 10 f 2 tanh max 2 k β ω y w 500 ν y w 2 ω 2 the coefficient α damps the turbulent viscosity causing a low r e correction it is expressed as 11 α α α 0 r e t r k 1 r e t r k where α 1 r e t k ν ω r k 6 α 0 β i 3 and β i 0 072 all the constants σ k σ ω β and γ are computed by a blend from the corresponding constants using ϕ f 1 ϕ 1 1 f 1 ϕ 2 in which f 1 can be calculated from eq 7 and the values of ϕ 1 and ϕ 2 are given in table 1 the commercial software package ansys fluent ansys inc 2020 is adopted to solve the fsi problem in this paper the governing equations are discretised with a finite volume method fvm a first order implicit scheme is employed for time marching while a second order upwind scheme is used to discretise the convective terms a pressure based coupled algorithm solves a coupled system of equations comprising the continuity equation and the momentum equations the overset also known as chimera mesh method is used to handle the dynamic mesh this method is convenient to deal with problems which involve large displacements and or relative motion of multiple bodies without causing excessive deformation of the mesh each object of interest is wrapped with a body fitted mesh and overlapped with other stationary or moving meshes cells are marked as fringe cells which need interpolation from other meshes field cells which are involved in the solution of the governing equations and hole cells that lie inside the solid body in the present study a distance weighted function as shown in eq 12 is employed to facilitate the exchange of information between different meshes 12 ϕ r i 1 n ϕ i d i i 1 n 1 d i where ϕ r is the flow variable at the receptor n stands for the number of donors ϕ i represents the flow variable at donor i and d i denotes the distance from a donor i to its receptor 2 2 structural dynamic model according to zhao and cheng 2011 and wang et al 2017 the 2dof motion for each of the elastically mounted circular cylinders in the tandem pair is given by 13 m x x c x x k x x f x 14 m y y c y y k y y f y where x and y are the in line and cross flow displacements a dot denotes differentiation with respect to time m x and m y are the cylinder masses per unit length in the x and y directions c x and c y are the structural damping coefficients in the x and y directions and k x and k y are the structural stiffnesses in the x and y directions in the present study it is assumed that the two cylinders have identical structural properties and these properties are the same in the in line and cross flow directions i e m x m y m c x c y c and k x k y k the identical mass ratios of the cylinders are calculated by m 4 m ρ π d 2 the damping coefficients can be nondimensionalised by the critical damping inferring the damping ratios ζ c 2 m m a k where m a is the added mass and the natural frequencies in water are expressed as f n k m m a 2 π a fourth order runge kutta method as used by gao et al 2018 2020 is employed to integrate eqs 13 and 14 the interested readers may refer to those papers gao et al 2018 2020 for detailed formulations of the runge kutta method 2 3 fluid structure interaction the fsi problem can be solved by using a loosely coupled approach wang et al 2018 2019 in this approach the information hydrodynamic loads and motion quantities of the cylinders is exchanged between the flow model and the structural dynamic model at each time step with no subiterations being performed a brief summary of the fsi procedures is as follows i the interpolation stencils are generated for the communication between the different meshes and the navier stokes equations are solved to derive the in line and cross flow hydrodynamic forces f x and f y computed by summing the dot products of the pressure and viscous forces with the specified force vectors on the circular cylinders ii f x and f y are transferred to the structural dynamic model to yield the motion quantities of the cylinders iii the new mesh configuration is evaluated based on the motion quantities of the cylinders and the interpolation stencils are updated and iv the navier stokes equations are solved on the new mesh configuration this fsi loop is repeated in every time step until the end of the simulation in the present study a user defined function udf written in c programming language is compiled in ansys fluent to compute f x and f y then to substitute them into eqs 13 and 14 and finally to solve the motion equations with the fourth order runge kutta method 3 description of the problem 3 1 simulation parameters fiv of two elastically mounted circular cylinders in tandem arrangement at different spacing ratios is numerically investigated in this study the cylinders are free to vibrate simultaneously in the in line and cross flow directions it is assumed that the two cylinders both possess the same structural parameters as the one in the experiment by jauvtis and williamson 2004 with identical mass ratios and mass damping parameters being m 2 6 and m c a ζ 0 013 respectively such low mass ratios are selected because cylindrical structures in offshore applications usually have mass ratios of the same order of magnitude and moreover a dramatic change in the fsi of 2dof viv of a single cylinder was observed in jauvtis and williamson 2004 when m 6 0 similar to the experiment the identical in line and cross flow natural frequencies of each cylinder are kept constant as f n 0 4 hz v r is systematically varied from 2 0 to 14 0 by increasing u the corresponding r e ranges from 1470 to 10320 belonging to the subcritical flow regime four different spacing ratios are considered in the simulation i e s x d 3 0 4 0 5 0 and 8 0 the effect of s x d on the response features hydrodynamic characteristics and wake patterns of the two tandem cylinders undergoing oscillations is examined the choice of s x d mainly covers the reattachment and co shedding regimes of two tandem stationary cylinders with the critical spacing ratio range specifically being taken into account within the present parameter space s x d 3 0 would result in the collision of the two cylinders which involves more complicated mechanisms and is also beyond the scope of this study thus the smallest s x d is chosen as 3 0 3 2 computational domain and boundary conditions a 60 d 40 d planar computational domain as shown in fig 1 a is used in the present study the origin of the cartesian coordinate system is situated at the centre of gravity cog of the upstream cylinder while the cog of the upstream cylinder is located at 20 d downstream the inlet boundary along the longitudinal centreline of the domain the computational mesh and a close up of the mesh around the cylinders are depicted in fig 1 b and c respectively o grid zones extending up to 2 5 d radially from the cylinder centres are generated as the component meshes on top of the background mesh the surface of each cylinder is discretised by 160 nodal points and the minimum mesh size adjoining the cylinder surface in the radial direction is 0 001 d the nondimensional distance y is defined as y u f y w ν where u f is the friction velocity and y w stands for the wall normal distance the y value in the present simulation is maintained less than 1 the background mesh is refined near the cylinders and in the wake region in order to better capture the flow features in those regions the boundary conditions for the governing equations are as follows the surfaces of the cylinders are assumed to be smooth where a no slip boundary condition is employed at the wall boundary the turbulent kinetic energy k is zero and the specific dissipation rate ω is given by ω w 6 ν w β 1 y w 2 where ν w is the kinematic viscosity of the fluid near the wall the inlet boundary conditions are set as u u and v 0 and turbulence intensity and turbulence length scale are respectively i 0 9 govardhan and williamson 2006 and l 0 07 d ansys inc 2020 at the outlet boundary the gradients of the fluid velocity and the turbulent quantities in the direction normal to the boundary are set to be zero pressure at the outlet boundary is given a reference value of zero a slip boundary condition is imposed on the two lateral boundaries at t 0 the cylinders are assumed to be at rest with zero displacements and velocities as it was used by han et al 2018 a static flow field is adopted to initialise the simulation in order to reproduce the super upper response branch a mesh dependency study is conducted to ensure that further refinement of the mesh makes little difference on the results 2dof fiv of two circular cylinders in tandem arrangement with s x d 5 0 and v r 8 0 is simulated using three different meshes and the comparison of the results is tabulated in table 2 n c n c m e and n b m e are respectively the number of nodes in the circumferential direction of each cylinder the number of elements of each body fitted component mesh and the number of elements of the background mesh quantitative comparisons are made for the in line and cross flow dimensionless response amplitudes a x d and a y d the mean drag coefficients c d and the root mean square rms values of the drag and lift coefficients c d and c l for both the upstream and downstream cylinders c d and c l are defined as c d f x 0 5 ρ u 2 d and c l f y 0 5 ρ u 2 d respectively it can be seen from the table that the maximum difference between the results from m1 and m2 is about 1 85 occurring in a x d of the downstream cylinder for the rest of the results computed using the two meshes the differences remain less than 1 32 as the mesh is densified from m2 to m3 the maximum difference between the results from the two meshes reduces to around 1 1 and it appears in a x d of the upstream cylinder the differences for the remainder of the results are below 1 the comparison of the results from the different meshes suggests that the mesh density of m2 is sufficient for providing acceptable accuracy for simulating fiv of two tandem cylinders in the present study for all the cases the time step sizes are selected to satisfy the condition that the courant number is less than 0 5 3 3 validation test the numerical method is first verified by performing a simulation for the 2dof viv of an elastically mounted circular cylinder in order to facilitate the comparison the same structural parameters as those in jauvtis and williamson 2004 are adopted details about the structural parameters in the experiment are also described in section 3 1 of this paper fig 2 shows the comparison of the amplitude and cross flow frequency responses between the present numerical results with the experimental data it can be seen that good agreement is reached between the two sets of results the super upper branch with large oscillation amplitudes in both the in line and cross flow directions is successfully reproduced the vortex wake modes from the present simulation at four different reduced velocities i e v r 2 0 3 0 8 0 and 9 0 are demonstrated in fig 3 they represent the ss mode a symmetric pair of vortices formed in each cycle the as mode two single vortices formed in each cycle the 2t mode two triplets of vortices formed in each cycle and the 2p mode two pairs of vortices formed in each cycle as per the observations by jauvtis and williamson 2004 the qualitative and quantitative agreement between the numerical and experimental results shows that the present numerical methods are capable of accurately capturing the 2dof viv response of an elastically mounted circular cylinder with low mass and damping at subcritical r e 4 results and discussion the results for 2dof fiv of two elastically mounted circular cylinders in tandem arrangement with various spacing ratios at subcritical r e are presented and analysed in this section 4 1 response amplitudes the variations of a x d and a y d of the upstream cylinder with v r are displayed in fig 4 the amplitude responses of an identical single cylinder are also included for comparison as shown in fig 4 a the in line amplitude responses of the upstream cylinder at s x d 4 0 5 0 and 8 0 follow similar trends to that of the single cylinder streamwise vibration modes are observed for v r 4 0 a x d curves for different spacing ratios reach their maxima of 0 33 at the same v r value of 8 0 the responses enter the lower branch with the increase in v r characterised by reasonably constant levels of amplitude until the synchronisations end at v r around 12 0 a dramatic change in the in line amplitude response of the upstream cylinder is observed when the cylinder pair is brought to s x d 3 0 compared to the rest of the cases the peak a x d of the upstream cylinder for s x d 3 0 increases slightly to approximately 0 34 and it shifts to a lower v r of 7 0 in the range of v r 9 0 14 0 distinct from the upstream cylinder at other spacing ratios as well as the single cylinder a relatively large a x d is maintained when s x d 3 0 similarly the transverse amplitude responses of the upstream cylinder for s x d 4 0 5 0 and 8 0 nearly coincide with that of the single cylinder a y d is rather small in the streamwise vibration modes when v r 4 0 it increases with increasing v r and peaks at v r 8 0 with a y d 1 5 corresponding to the super upper branch termed by jauvtis and williamson 2004 as v r is further increased the cross flow amplitude responses of the upstream cylinder jump to the lower branch and a y d levels off at around 0 65 before it diminishes in the desynchronisation range discrepancies in the cross flow amplitude responses are observed for the upstream cylinder between the s x d 3 0 case and the other cases especially at high v r when s x d 3 0 the maximum a y d of the upstream cylinder is slightly smaller taking the value of 1 3 and appears at a lower reduced velocity of v r 7 0 a y d reaches a plateau at approximately 0 75 in the range of v r 8 0 10 0 it then starts to decrease gradually with the increase in v r it is particularly noted that for v r 13 0 and 14 0 a y d of the upstream cylinder for s x d 3 0 still remains at around 0 3 0 4 which is obviously larger than the other cases in general the in line and cross flow amplitude responses of the upstream cylinder for s x d 4 0 5 0 and 8 0 resemble those of the single cylinder indicating that the presence and vibrations of the downstream cylinder have an almost negligible influence on the fiv of the upstream cylinder when s x d 4 0 papaioannnou et al 2008 put forward that when vortex shedding was initiated behind the upstream cylinder it acted similarly to a single cylinder it can therefore be deduced that wake behind the upstream cylinder for s x d 4 0 8 0 is fully developed some differences exist in the in line and cross flow amplitude responses of the upstream cylinder at s x d 3 0 in particular when v r is high the response curve widths in terms of v r of the upstream cylinder increase at this small s x d similar observations have also been reported by papaioannnou et al 2008 in their numerical simulation at low r e it is preliminarily inferred that the distinct response features of the upstream cylinder when s x d 3 0 could be attributed to the strong interference in the gap flow caused by the oscillations of the downstream cylinder fig 5 illustrates a x d and a y d of the downstream cylinder as functions of v r due to the influence of the upstream cylinder oscillations and its associated wake the downstream cylinder possesses completely different response curves from those of the single cylinder as shown in fig 5 a multiple peaks appear in a x d of the downstream cylinder for the spacing ratios considered the multi peak responses of the downstream cylinder have also been observed by bao et al 2012 and yu et al 2016 in their numerical simulations and by armin et al 2018 in their experimental tests the downstream cylinder undergoes appreciable in line oscillations with noticeably higher amplitudes than the single cylinder case in the range of 3 0 v r 5 0 this peak of a x d is mainly related to the vortex shedding of the upstream cylinder as v r is increased a x d of the downstream cylinder experiences several humps the maximum a x d values of the downstream cylinder at different s x d are reached in the v r range of 10 13 which are much higher than the v r associated with the maximum a x d of the single cylinder due to the shielding effect of the upstream cylinder the velocity of the flow passing the trailing cylinder is less than the freestream velocity therefore the delay in v r corresponding to the maximum a x d of the downstream cylinder can be attributed to the shielding effect in addition the maximum a x d decreases slightly with increasing s x d the reduction in the maximum a x d is due to the weakening of the buffeting force on the downstream cylinder at larger s x d as the upstream vortices lose a fraction of energy as a result of dissipation the a x d curves for all the s x d considered exhibit decline once they pass their maxima however the in line amplitude response of the downstream cylinder at s x d 3 0 demonstrates an upward trend at the high end of the v r range in this study a y d curves of the downstream cylinder at different s x d also exhibit multiple peaks the first a y d peak accompanies the first peak of a x d in the range of v r 3 0 5 0 as v r is increased a y d starts to increase gradually and the maximum a y d values of the downstream cylinder for different s x d appear at v r values identical to those associated with the maximum a x d values only the maximum a y d at s x d 3 0 is evidently larger than that of the single cylinder while those for the other cases are of similar magnitudes as mentioned previously with the decrease in the buffeting force of the upstream vortices on the downstream cylinder its maximum a y d also reduces with the growth of s x d after the maxima of a y d the curves start to decrease when v r is further increased similar to in line responses a y d for s x d 3 0 also shows the tendency to increase at high v r in contrast to assi 2014 the build up of the response amplitudes with v r beyond the viv resonance range for the downstream cylinder is not observed in the present simulation assi 2014 attributed the increase in the amplitudes at high v r to the unsteady vortex structure interactions and introduced the wake stiffness concept to explain the phenomenon it should be noted that the upstream cylinder in assi s experiment was fixed whereas that in the present study is free to oscillate in both the in line and cross flow directions the vortex shedding of the upstream cylinder in our simulation is more complex compared to his experiment therefore the wake stiffness is subject to larger variations and it might not be as dominant as the one in assi 2014 it is deduced that this could be the cause of the disappearances of the continuously increasing a x d and a y d at s x d 4 0 8 0 when both cylinders were allowed to vibrate as in armin et al 2018 and xu et al 2019 qualitatively similar downstream cylinder amplitude responses to our simulation were observed 4 2 response frequencies the normalised power spectral density psd plots of the in line and cross flow displacements of the two cylinders as functions of v r and the nondimensionalised oscillation frequencies f o x f n and f o y f n are presented in fig 6 along with the dominant vibration frequencies the blue dash lines in the figure denote the dominant oscillation frequencies of the single cylinder as shown in the figure in some cases the cylinder responses consist of multiple frequency components especially for the in line responses there are also cases with single frequency responses the transverse dominant frequencies of the two cylinders agree fairly well with that of the single cylinder as v r is increased whereas the streamwise dominant frequencies of the tandem cylinder pair demonstrate large discrepancies with in line frequency response of the single cylinder thus it can be interpreted that the in line vibration frequencies of both the upstream and downstream cylinders are more influenced than those in the cross flow direction the in line dominant frequencies of the two cylinders follow that of the single one at low v r with their values twice the corresponding transverse vibration frequencies as v r is increased the in line dominant frequencies of both cylinders deviate from that of the single cylinder and low frequency components predominate the streamwise responses of both cylinders at high v r the low frequency components in the streamwise direction have also been reported by huang and sworn 2011 and armin et al 2018 for two tandem cylinders and by assi 2014 for the downstream cylinder they are believed to take root in the interactions between the wake of the upstream cylinder and the oscillating downstream cylinder it is observed that the smaller s x d is the more distinct the differences in the in line dominant frequencies between the upstream cylinder and the single one become this is because for a smaller s x d the downstream cylinder interacts with the upstream wake closer to the leeside of the upstream cylinder imposing a stronger impact on it and this impact gets weaker with the increase in s x d for the downstream cylinder because of the stronger wake shielding effect and the flow velocity over the downstream cylinder being slower the in line dominant frequencies of the downstream cylinder at s x d 3 0 are lower than the other spacing ratios the observations for the frequency responses of the downstream cylinder at high v r are qualitatively analogous to that of assi 2014 i e the low frequency components dominate the in line response at high v r while the cross flow frequency curves follow that of the single cylinder as explained by assi 2014 these observations could be possibly attributed to the 2dof wiv of the downstream cylinder however due to the fact that the upstream cylinder is free to vibrate in the present simulation its vortex shedding is more complicated than an upstream stationary cylinder leading to more complex interactions between the upstream wake and the downstream cylinder therefore the low in line dominant frequency at high v r does not show an almost linearly increasing trend as reported in assi 2014 4 3 orbital trajectories the orbital shape of a cylinder is critical in defining the amplitude and frequency contents of the hydrodynamic forces dahl et al 2008 and the direction of the orbital motion is closely related to the energy transfer between the fluid and structure bourguet et al 2013 therefore it is of importance to examine the orbital trajectories of the two tandem cylinders for different spacing ratios fig 7 shows the variations of the orbital trajectories with v r at different s x d for the two cylinders arranged in tandem it can be seen from the figure that the orbital trajectories of the upstream cylinder vary similarly to the single cylinder as in jauvtis and williamson 2004 blevins and coughran 2009 dahl et al 2010 and srinil et al 2013 with respect to v r in similar subcritical r e ranges at the low end of v r the upstream cylinder is subject to nearly pure in line motion with the increase in v r the orbital trajectories develop into figure eight shapes corresponding to the 2 1 in line to cross flow dominant frequency ratios in fig 6 the figure eight trajectories indicate the occurrence of dual resonance bao et al 2012 dahl et al 2006 2010 srinil et al 2013 wang et al 2017 when a x d and a y d reach their maxima the trajectories of the upstream cylinder exhibit crescent shapes as reported by jauvtis and williamson 2004 the orbital trajectories of the upstream cylinder for s x d 3 0 become nonrepeatable at high v r indicating the modulatory nature of the cylinder motion which is caused by the interference of the downstream cylinder this interference is weakened by increasing s x d oblique figure eight trajectories similar to those reported by kang and jia 2013 gedikli and dahl 2014 and wang et al 2017 are observed for the upstream cylinder when v r 9 0 these asymmetric lissajous figures can be attributed to the low frequency components in the in line vibrations apart from the dominant frequency component at twice the cross flow oscillation frequency unlike its upstream counterpart the motion trajectories of the downstream cylinder are more unstable and irregular due to the interference of the upstream wake as shown in fig 7 b the in line vibration of the downstream cylinder is dominated by broadband low frequency contents mixed with higher harmonic frequencies for the range of v r considered the downstream cylinder demonstrates nonperiodic orbits composed of figure eight and oval shapes with the equilibrium positions shifting unrepeatably from cycle to cycle these trajectories are associated with the complex vortex shedding in the near wake region relatively periodic oval orbits are only observed at v r 10 0 when s x d 4 0 where the oscillating frequencies approach the natural frequencies in the two directions 4 4 hydrodynamic coefficients fig 8 shows the variations of c d c d and c l of the two tandem cylinders with v r for different s x d in comparison with those of the single cylinder undergoing viv for the r e range considered in the present study when s x d 4 0 8 0 the spacing is large enough for the free shear layers separated from the upstream cylinder to roll up into vortices leading to an almost fully developed wake behind the upstream cylinder the downstream cylinder demonstrates limited influence on c d c d and c l of the upstream cylinder bao et al 2012 also claimed that the hydrodynamic force coefficient curves of the upstream cylinder were near those of the single one for s x d 5 0 at a low r e of 150 whereas as s x d is decreased to 3 0 c d c d and c l of the upstream cylinder deviate slightly from those of the single one this indicates that the reduction in s x d intensifies the interference effect of the downstream oscillating cylinder on the near wake of the upstream one in contrast the hydrodynamic force coefficients of the downstream cylinder are quite different from those of the upstream and single cylinders due to the effect of the upstream wake for low v r c d values of the downstream cylinder are evidently smaller than those of the single cylinder except for v r 4 0 and s x d 5 0 this is because the real flow velocity past the downstream cylinder is deficient under the wake shielding effect c d of the downstream cylinder approaches that of the single cylinder at high v r corresponding to its lower response branch as the flow velocity in the gap recovers there exist multiple peaks in c d of the downstream cylinder when v r is low the convecting vortices from the upstream cylinder is gradually generated and the in line oscillations of the downstream cylinder is hence excited in the meanwhile a peak in the c d is also observed in the range of v r 6 0 8 0 a y d of the upstream cylinder is larger than the downstream one and the vortices shed from the upstream cylinder envelop the trajectories of the downstream cylinder leading to the troughs of the c d curves nevertheless at high v r a y d of the downstream cylinder predominates that of the upstream one thus the upstream vortices are fully developed and able to impinge perpetually onto the downstream cylinder which causes the fluctuations in c d of the downstream cylinder as depicted in fig 8 e and f the c l peaks of the downstream cylinder are slightly larger than those of the upstream one at low v r similar to the conclusion of prasanth and mittal 2009 it is speculated that the upstream wake has a strong effect on the boundary layers over the downstream cylinder surface enhancing the intensity of the vortex shedding behind it c l of the downstream cylinder tends to decline with increasing v r after the first peaks of the in line and cross flow amplitude responses beyond v r 9 0 c l of the downstream cylinder reaches a plateau or rises gradually with the overall values larger than that of the single cylinder at high v r the downstream cylinder is obviously excited by the wake and the wiv counteracts the influence of the viv desynchronisation however xu et al 2019 found that c l of the downstream cylinder and that of the single one were alike at high v r for similar s x d due to the higher r e considered by xu et al 2019 the upstream vortices in their experiment are more unstable and dissipative hence the response of the downstream cylinder was less affected the hydrodynamic forces on the oscillating cylinders in each direction can be decomposed into two components those in phase with the velocities are referred to as the in line and cross flow excitation coefficients c e x and c e y and the ones in phase with the accelerations are named the in line and cross flow added mass coefficients c a x and c a y song et al 2016 xu et al 2021b according to song et al 2016 and xu et al 2021a the hydrodynamic forces in the in line and cross flow directions f x and f y can be expressed respectively as 15 f x ρ u 2 d 2 2 x r m s c e x x ρ π d 2 4 c a x x 16 f y ρ u 2 d 2 2 y r m s c e y y ρ π d 2 4 c a y y where x r m s and y r m s are the rms values of the response velocities in the in line and cross flow directions respectively a least squares method by song et al 2016 is employed to determine the four hydrodynamic coefficients and the following equations show the detailed derivations 17 c e x 2 2 x r m s ρ u 2 d g 2 g 5 g 3 g 4 g 2 2 g 1 g 4 18 c a x 4 ρ π d 2 g 1 g 5 g 2 g 3 g 2 2 g 1 g 4 19 c e y 2 2 y r m s ρ u 2 d g 7 g 10 g 8 g 9 g 7 2 g 6 g 9 20 c a y 4 ρ π d 2 g 6 g 10 g 7 g 8 g 7 2 g 6 g 9 where g 1 i 1 m x 2 g 2 i 1 m x x g 3 i 1 m f x x g 4 i 1 m x 2 g 5 i 1 m f x x g 6 i 1 m y 2 g 7 i 1 m y y g 8 i 1 m f y y g 9 i 1 m y 2 and g 10 i 1 m f y y the variations of c a x with v r for the two tandem cylinders are depicted in fig 9 a and b c a x of the upstream cylinder in all cases declines with increasing v r following the c a x trend of the single cylinder for v r 10 0 this decline in c a x is also reflected from the increase of f o x f n in fig 6 as the low oscillation frequency components grow at high v r the upstream cylinder has slightly larger c a x compared to the single cylinder case larger deviations in c a x are observed between the downstream cylinder and the single one as the low frequency components are more predominant in the in line oscillations of the downstream cylinder the c a x curves of the downstream cylinder are also more modulatory which is associated with the larger variations of f o x f n as shown in fig 6 fig 9 c and d demonstrate c a y of the two cylinders in tandem against v r the c a y curves of the upstream cylinder are in good agreement with that of the single cylinder for s x d 4 0 5 0 and 8 0 except for the range of v r 2 0 6 0 there exist slight differences in v r values corresponding to the maximum c a y for all the s x d considered c a y of the downstream cylinder is qualitatively similar to those of the upstream cylinder and the single one with no obvious peaks when v r 3 0 6 0 as s x d is increased the c a y curves of the downstream cylinder approach that of the single cylinder c a y values of both cylinders decrease with the increase in v r which is also indicated by the increasing trend of f o y f n as observed from fig 6 overall the deviations of c a y from the single cylinder results are not as evident as c a x the c e x curves with respect to v r of the two cylinders arranged in tandem are presented in fig 9 e and f the in line vibrations of the two cylinders are more susceptible to the complex interference such as the gap suction impingement of vortices shear layer reattachment etc in the meanwhile the interaction between the two cylinders is also rather strong the changes in c e x as functions of v r are consequently more complex and fluctuating at s x d 8 0 a larger c e x is found between v r 6 0 and 8 0 for the upstream cylinder indicating that the vortex street behind it is better developed whereas c e x values of the downstream cylinder get closer to zero at high v r when the influence of the upstream vortices on the in line excitation is weakened fig 9 g and h are the variations of c e y versus v r it is noted that the transverse vibrations of the two cylinders are affected by the in line motion in the present study consequently the variation trends of c e y are more complex compared with the 1dof results obtained by xu et al 2019 c e y of the upstream cylinder is analogous to that of the single one when v r 6 0 for smaller s x d c e y of the upstream cylinder hits the trough at v r 4 0 or 5 0 c e y of the downstream cylinder experiences more fluctuations compared to the single cylinder case with the increase in s x d the fluctuations tend to be smoothed and thus the variation trends of c e y are more consistent with that of the single one furthermore the c e y curves of both cylinders at high v r slowly decrease and approach to zero reflecting the self limiting feature of the fiv 4 5 wake patterns the analyses of the wake patterns provide insights into the underlying mechanisms of the wake cylinder interference which can be useful for explaining the specific fiv phenomena and characteristics from the results discussed above this section presents the wake patterns of different cases at representative v r values figs 10 and 11 exhibit the vorticity contours at various v r for different s x d at low v r v r 4 0 except for the case with s x d 8 0 the vortices detached from the upstream cylinder interact strongly with the downstream one so that irregular small vortices develop behind it for s x d 8 0 the spacing between the two cylinders is large enough for a full single vortex street to be formed in the gap region the vortex shedding from the downstream cylinder becomes more periodic with a slight increase in v r the downstream cylinder for all the s x d considered is entirely trapped in the parallel vortex street from its upstream counterpart and the vibrations of the downstream cylinder are inhibited when v r is increased to 8 0 the 2t vortex shedding mode two triplets of vortices being shed per cycle discovered by jauvtis and williamson 2004 gives rise to the large amplitude vibrations of the upstream cylinder in cases of s x d 4 0 5 0 and 8 0 the strong buffeting force of the 2t vortex shedding mode leads to the increase in the vibration amplitudes of the downstream cylinder for the case of s x d 3 0 and v r 8 0 the shear layers separated from the upstream cylinder fail to roll up into the triplets of vortices and thus the response amplitudes of the upstream cylinder drop in advance in the range of v r 10 0 12 0 the oscillation amplitudes of the downstream cylinder exceed those of the upstream one when s x d 3 0 and 4 0 the shear flow dominates in the gap however at s x d 5 0 and 8 0 vortex shedding occurs in the gap region finally when v r rises to 14 0 regular 2s vortex shedding mode two single vortices being shed per cycle is formed behind both cylinders as their response amplitudes are attenuated for the s x d considered in the present study more detailed discussions about the wake patterns are as follows when v r 2 0 both cylinders are subject to in line vibrations the vibration of the upstream cylinder is caused by the symmetric vortex shedding and the vortices develop into kármán vortex street as they are convected downstream the symmetric vortex shedding leads to the in line dominant frequency of the upstream cylinder being around f n whereas the downstream cylinder is exposed to the upstream vortices and the vortices interact with the shear layers of the downstream cylinder at v r 4 0 for the s x d values considered the response of the upstream cylinder is in the initial branch while the downstream cylinder exhibits an evidently larger a x d according to the analyses in section 4 1 as shown in fig 10 c and d and fig 11 c and d the upstream vortices continuously impinge on the surface of the downstream cylinder which enhances its drag fluctuations the interactions between the upstream vortices with the shear layers of the downstream cylinder lead to the irregular vortex street in the near wake of the downstream cylinder and the less fluctuating lift when v r is increased to around 6 0 the downstream cylinder is confined within the double row vortex street of the upstream one owing to the shielding effect u around the downstream cylinder is significantly reduced it can be seen from fig 10 e and f and fig 11 e and f that the vorticity in the shear layers separated from the downstream cylinder is weak and these shear layers coalesce with the upstream vortices with the same sign and are convected downstream hence the vortex shedding from the downstream cylinder is suppressed and its vibrations are restrained similar observations have also been reported by borazjani and sotiropoulos 2009 and bao et al 2012 it is observed from fig 4 that the upstream cylinder reaches its maximum vibration amplitudes at slightly lower v r of 7 0 the vorticity contours at different time instants in one oscillation cycle of the upstream cylinder for this specific case are shown in fig 12 the two cylinders are vibrating out of phase this allows enough spacing for the shear layers from the upstream cylinder to develop into the 2t vortex shedding mode which triggers the large amplitude vibration of the upstream cylinder in contrast the downstream cylinder is completely trapped in the wake of the upstream one and the its vibration is subsequently suppressed the immersion of the downstream cylinder in the upstream wake has also been reported by borazjani and sotiropoulos 2009 in their numerical simulation for a smaller s x d at a lower r e as v r is increased to 8 0 the response amplitudes of the upstream cylinder for s x d 3 0 drop earlier than the other s x d values a y d of the downstream cylinder is enhanced by the upstream wake fig 13 presents the vorticity contours at different time instants in one vibration cycle of the upstream cylinder for s x d 3 0 and v r 8 0 for this case in the present study the shear layers separated from the upstream cylinder cannot roll up fully in the narrow gap but are squeezed by the downstream one as a result the response amplitudes of the upstream cylinder decrease on the other hand the gap flow adds additional vorticity in the near wake of the downstream cylinder which enlarges its a y d for s x d 4 0 the spacing between the two cylinders at v r 8 0 is large enough for the 2t wake mode to be formed behind the upstream cylinder consequently the amplitude responses of the upstream cylinder are similar to those of the single one in the range of v r 10 12 the upstream cylinder is in the lower response branch of classic viv the downstream cylinder demonstrates various response characteristics governed by the complex wake mechanisms for s x d 3 0 and v r 10 0 the oscillation amplitudes of the two tandem cylinders increase fig 14 presents the vorticity contours when the downstream cylinder moves to peaks in the positive y direction it can be seen that for this small s x d due to the vibrations of the two cylinders the shear layers of the upstream cylinder are able to roll up but cannot become completely detached instead they are stretched and pushed through the gap by the downstream cylinder the alternately swinging pattern of the shear layers forms a fishtail like wake in the gap in contrast the downstream cylinder encounters varying wake patterns from cycle to cycle because of the vigorous coupling between the wakes of the two cylinders for this small s x d the interactions between the vortices from the two cylinders are enhanced both squeeze and coalescence of the vortices are observed based on the discussions of camo et al 2011 the downstream cylinder gains a large lift as a result of the oscillating gap flow the unsteady interactions between the upstream vortices and the motion of the downstream cylinder play a key role in transferring energy from the flow to the downstream cylinder that keeps its amplitudes at high levels fig 15 shows the variations of the vorticity contours in the wakes of the two cylinders at time instants when the downstream cylinder is at peaks of y d for s x d 4 0 and v r 11 0 compared to the case of s x d 3 0 and v r 10 0 the vibration amplitudes of both cylinders are smaller at some time instants the vortices are able to be entirely shed from the upstream cylinder whereas at other instants the shear layers from the upstream cylinder interact with those of the downstream one analogous to the observations from fig 14 the upstream wake impinging on the downstream cylinder is different for different vibration cycles when s x d is increased to 5 0 vortices from the upstream cylinder emerge in the gap region in contrast to figs 14 and 15 the wake patterns encountered by the downstream cylinder in different vibration cycles are almost the same as shown in fig 16 as depicted in fig 17 vortex shedding is also found in the gap for s x d 8 0 and v r 12 0 semblable vortex patterns are found for different cycles indicating that the wake cylinder interactions occur at similar timing when v r is increased to 13 14 it is found that the vibrations of the two cylinders become weak except for s x d 3 0 based on the analyses in section 4 1 as shown in fig 10 m and n and fig 11 m and n the downstream cylinder is influenced by the periodic 2s wake mode of the upstream one for s x d 3 0 the gap flow brings about the low excitation frequency components in the in line oscillation of the upstream cylinder because of the smaller spacing the gap flow interacts with the shear layers of the downstream cylinder in the nearer wake which is deduced to be the reason for the larger amplitudes in terms of s x d 4 0 the impinging vortices on the downstream cylinder not only interact with its shear layer on the one side but also squeeze its own vortex on the other side 5 conclusions the response and hydrodynamic characteristics of two elastically mounted circular cylinders arranged in tandem undergoing fiv at subcritical reynolds numbers are investigated numerically in this study the circular cylinders are identical in terms of their structural properties with m 2 6 and m c a ζ 0 013 the reynolds number lies in r e 1470 10320 and s x d is varied from 3 0 up to 8 0 to examine the effect of the spacing ratio for the upstream cylinder the amplitude responses with respect to v r in both the in line and cross flow directions agree well with those of a single cylinder except for the smallest spacing ratio considered in the present study i e s x d 3 0 it indicates that when s x d 4 0 5 0 and 8 0 the downstream cylinder has limited effect on the responses of the upstream one which is also reflected from the similar variation trends of the hydrodynamic coefficients with v r to the single cylinder while for s x d 3 0 the peak amplitudes decrease slightly and shift to a lower v r in the meanwhile larger amplitudes are observed at high v r where the freely oscillating downstream cylinder strongly disturbs the vortex shedding from the upstream one the in line to cross flow oscillation frequency ratio f o x f o y of the upstream cylinder is approximately around 2 0 indicating the occurrence of dual resonance with its orbital trajectories mainly of a figure eight shape at high v r the contributions of the low frequency components in the in line vibrations give rise to asymmetric lissajous figures in terms of the downstream cylinder multiple peaks are observed for both the in line and cross flow amplitude responses the fiv responses and hydrodynamic characteristics of the downstream cylinder are influenced by the combination of the shielding effect and vortex buffeting of the upstream cylinder due to the shielding effect v r corresponding to the maximum amplitude of the downstream cylinder is delayed to a higher value with increasing s x d there exists a slight reduction in the maximum amplitudes because the buffeting force of the upstream cylinder wake gets weaker as the upstream cylinder in the present simulation is free to oscillate in 2dof the associated vortex shedding is more complicated and the wake stiffness experiences larger variations which results in the disappearance of the build up of the response amplitudes owing to the interactions between the upstream wake and the vibrating downstream cylinder low frequency components dominate the in line response resulting in the more chaotic orbital trajectories of the downstream cylinder at high v r c d and c l of the downstream cylinder are higher compared to the single cylinder at low v r the wake modes of the upstream cylinder are mainly symmetric vortex shedding and kármán vortex shedding the continuous impingement of the upstream vortices on the downstream cylinder leads to the development of small vortices behind it and enhances its drag fluctuations when v r is around 6 0 the large amplitude vibrations of the upstream cylinder and the associated wider wake trap the downstream cylinder in the parallel vortex street and suppress its vortex shedding the 2t vortex shedding mode is found to be related to the maximum amplitudes of the upstream cylinder the appearance of this very wake mode shifts to a lower v r as s x d is reduced the stronger buffeting force of the 2t vortex shedding mode gives rise to the increase in the vibration amplitudes of the downstream cylinder as the response amplitudes of the downstream cylinder surpass its upstream counterpart the shear flow dominates in the gap at s x d 3 0 and 4 0 whereas vortex shedding is observed for s x d 5 0 and 8 0 the corresponding vortex shedding of the two cylinders at the high end of v r in this study is in the 2s mode credit authorship contribution statement wanhai xu conceptualization data curation writing review editing supervision funding acquisition haokai wu validation investigation visualisation formal analysis writing original draft kun jia formal analysis writing review editing enhao wang methodology investigation visualisation formal analysis writing original draft supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was funded by the national natural science foundation of china grant nos 51909189 51679167 and 51979193 and the state key laboratory of ocean engineering at shanghai jiao tong university grant no 1811 
20413,a dedicated neural network architecture called noisenet has been developed to predict urn underwater radiated noise of cavitating marine propellers the noisenet predicts the sound pressure level at the first three blade passing frequencies with knowing the propeller geometry ship hull wake field and working conditions the physical mechanism of the urn generation is firstly analyzed thereafter the physical knowledge about the hydrodynamics and hydroacoustics of marine propellers are used to develop the noisenet architecture a dataset obtained with the boundary element method and ffowcs williams hawkings acoustic analogy is used for the training and evaluation the evaluation conducted on fully unseen cases shows a mean absolute error of 7 34 db graphical abstract keywords noise neural network machine learning marine propeller cavitation 1 introduction it has been reported that the underwater background noise is raised by a significant value due to human activities krasilnikov 2019 this background noise raising as well as the impulsing underwater noise can very probably cause damage to marine life european commission 2019 shipping is recognized as one of the main sources of underwater noise and the cavitating propeller is the main sound source of the shipping thus it is important to have low noise marine propeller designs for underwater noise reduction fast and accurate numerical prediction methods of urn would help the designing and improvement activities recently the investigation about accurate numerical prediction methods of urn receives considerable attention the common choice is combining hydrodynamic solvers and acoustic analogies the rans les or bem boundary element method are used to calculate hydrodynamics and the fwh ffowcs williams hawkings acoustic analogy williams and hawkings 1969 is used to evaluate the noise all methods are time consuming because of the intrinsic unsteadiness of the problem the accuracy is also a concern the best setup for the cavitation and hydroacoustic calculation is still under research wang et al 2020 bensow and liefvendahl 2016 li et al 2018 lidtke et al 2016 meanwhile the ann artificial neural network is becoming a universal tool for the prediction of dynamic system behavior in different advanced engineering applications the ann is even used to solve pde systems raissi et al 2019 geneva and zabaras 2020 it has also attracted attention in the maritime community for examples yuan et al 2020 employed lstm long short term memory in vessel trajectory repair gkerekos et al 2019 utilized ann to predict ship fuel oil consumption under varying sailing profiles the application of ann to marine propeller urn prediction has also been explored aktas 2017 developed an ann using model scale measurement data a subset of the meridian propeller series was measured in a cavitation tunnel with various axial wake fields tunnel vacuum conditions and propeller speeds to generate the dataset two independent anns were developed to predict the total and background noise level at the 31 1 3 octave center frequencies from 20 hz to 20 khz respectively the net noise level of the propeller was then predicted by subtracting the background noise from the total noise 12 features were used as inputs including 3 propeller design parameters 3 wake parameters 3 propeller performance coefficients and 3 differently defined cavitation numbers one hidden layer was used in both anns the optimal numbers of neurons in the hidden layer were found by the sweep function two test cases having full scale urn data were used for the validation miglianti et al 2019 has developed a pure data driven model and a hybrid model for the marine propeller urn prediction using model scale measurement data in a cavitation tunnel two controllable pitch propellers of twin screw ships with one single wake field for each propeller were measured in their work they have compared the physical model pure data driven model and the hybrid model which combines the physical model and data driven model through multi task learning the kernel regularized least squares method with a single hidden layer was adopted for the data driven model inputs for models were a set of scalar parameters providing a global description of the propeller and its functioning the output of the data driven model consisted of 9 variables to describe a simplified continuous spectrum the results were validated for working conditions within and out of the ones exploited for building the model it was found that the hybrid model performs better than the pure physical model or pure data driven model miglianti et al 2020 continued their investigation by extending the dataset to 3 controllable pitch propellers and 6 wake fields different input feature sets and different noise spectra parametrizations as output have been explored convolutional layers were adopted to reduce the number of trainable parameters in the ann for large input feature sets it was indicated that best performances were obtained when all the features were considered together in general an ann being able to evaluate the marine propeller urn would help to reduce the computation time required for example to the authors experience a bem fwh method simulating ten propeller revolutions would require several hours for a single case while a purely ann prediction takes less than one second besides ann has the potential to achieve better prediction accuracy than canonical numerical methods e g rans fwh or bem fwh if high quality model or full scale marine propeller urn measurement data are used for the training according to the experiences in the machine learning community the dedicated architecture is the key to reduce the requirement of data amount and to increase the prediction accuracy for example cnn convolution neural network is developed for image related problems and rnn recurrent neural network is developed for time series problems based on these special layers the dedicated architectures lenet 5 lecun et al 1998a alexnet krizhevsky et al 2017 vgg simonyan and zisserman 2015 and residualnet he et al 2016 have been designed to improve the image recognition accuracy the dedicated encoder decoder architecture cho et al 2014 bahdanau et al 2016 was designed for machine translation and the rnn ctc connectionist temporal classification architecture graves and jaitly 2014 was designed for speech recognition all of them have helped to increase the machine learning ability for the marine propeller urn problem there are a lot of features e g pointwise velocity values in the wake field and all propeller geometry parameters that can influence the urn personally chosen global description features could lead to the loss of information this might hinder the exploitation of the full ability of machine learning and constrain the ann s applicability to specific propeller classes or working scenarios a simple fully connected ann architecture with considering all features would result in many trainable parameters which might then require an unaffordable amount of data for a meaningful training thus a dedicated ann architecture using the raw features as inputs and considering the specific attributes of the marine propeller urn problem needs to be developed in this paper such a dedicated neural network architecture for the prediction of marine propeller urn will be described the physical relationship is taken into consideration in the architecture the dataset being used is obtained through simulations with the bem fwh coupling method the high computational efficiency of the bem fwh method enables the collection of a relatively large amount of data the large dataset facilitates the exploration of the possible ann architecture for marine propeller urn prediction the bem fwh method has been used to calculate the radiated noise of both non cavitating propeller wang et al 2020 testa et al 2018 and cavitating propeller cases göttsche et al 2019 göttsche 2020 although bem is not a good tool for the broadband noise previous work showed that it can give satisfactory predictions of tonal noise at least up to the 3rd blade harmonics göttsche et al 2019 thus we strict us to the analysis of tonal noise at 1st to 3rd bpfs blade passing frequency in the current work the manuscript is organized as follows in section 2 the physical problem is analyzed and the dataset being used is described in section 3 the noisenet architecture is presented together with the idea behind it in section 4 some training and test results as well as comparisons of noisenet with two other simple neural networks are given further discussions and conclusions are given in section 5 2 problem analysis and the dataset the problem being solved is predicting the urn of cavitating marine propellers in this section the problem i e the main noise source and physical relationship between the knowns and the noise is analyzed to help develop an effective ann architecture then a dataset obtained with bem fwh simulations is described 2 1 problem analysis in most cases the marine propeller works downstream of the ship hull or other structures the inflow velocity in front of the propeller disk is not uniform the velocity distribution can be described by the ship hull wake field an example of which is shown in fig 1 as the marine propeller rotates in such a flow field the angle of attack aoa of the blade sections would change over time this results in pressure fluctuations on the blades the cavitation occurs where the pressure is below the saturated vapor pressure the cavity volume also varies with time due to the pressure fluctuation this has an effect of volume fluctuation because of the low density ratio between vapor and water the rotation motion the pressure fluctuation and the cavity volume fluctuation would all produce underwater noise the above described relation is depicted in fig 2 to facilitate the development of an effective ann architecture the main sound source is analyzed with the bem fwh coupling method the urn of the open access kp505 propeller moeri 2008 working in the ship hull wake field shown in fig 1 is analyzed several observers are placed on the starboard side of the propeller with different distances to the propeller the sound pressure level spl for the first three bpfs are calculated and analyzed our in house code panmare is used for the calculation its implementation has been verified in previous studies göttsche et al 2019 wang et al 2020 the farassat 1 a formulation farassat 2007 of the fwh equation is used the formulation is divided here into sub items to get their relative importance in the urn the formulation is 1 p x t p t x t p l x t p t 1 p t 2 p l 1 p l 2 p l 3 where p x t is the sound pressure at the observer x and time t and the other terms are 2 4 π p t 1 f 0 ρ 0 u n u n r 1 m r 2 ret d s 3 4 π p t 2 f 0 ρ 0 u n m r c 0 m r m 2 r 2 1 m r 3 ret d s 4 4 π p l 1 1 c 0 f 0 l r r 1 m r 2 ret d s 5 4 π p l 2 f 0 l r l m r 2 1 m r 2 ret d s 6 4 π p l 3 1 c 0 f 0 l r r m r c 0 m r m 2 r 2 1 m r 3 ret d s where 7 u v ρ ρ 0 u v 8 l p n ρ u u n v n in the above equations f 0 denotes the integration surface for fwh equation or sound source surface ρ is the fluid density ρ 0 is the undisturbed value c 0 is the sound speed and p is the absolute pressure u is the fluid velocity v is the surface moving velocity both are defined in a coordinate where the undisturbed fluid or far field fluid is static m is the vectorial mach number i e m v c 0 r is the vector from the source point to observer position r is its length the subscript ret means that variables inside the square brackets are computed at the corresponding retarded times i e at τ t r c 0 the subscripted variables denote dot products of a vector and a unit vector implied by the subscript except for l m l m and n is the unit normal vector on the surface directing into the fluid domain the dot over a variable means time derivative with the sound pressure obtained with above equations the spl is calculated by its definition 9 spl 20 log 10 2 mag f p p r e f where f denotes the fourier transformation mag means the magnitude of complex fourier coefficients for specific positive frequencies p r e f 1 1 0 6 pa is the reference pressure and 2 is used to scale the two sided amplitude spectrum to root mean square values of sound pressure the spl calculated by considering different single sub items are shown in fig 3 as functions of distance to the propeller center it can be observed that the term p t 1 is obviously dominant with physical consideration u n u n u n in p t 1 is the time derivative of the normal velocity of fluid on the blade surface the surface integration of this term is actually the second time derivative of the total cavity volume v c a v thus the main sound source term is the temporal variation of the cavity volume this correlates well with the observation that cavitating propellers have much more noise than the non cavitating cases bertschneider et al 2014 fréchou et al 2001 turkmen et al 2017 2 2 dataset the dataset used in this work is generated by the hydroacoustic simulations with the bem fwh method more exactly using our in house code panmare multiple propellers and ship hull wake fields are used every possible pairing of propeller and wake field are simulated to maximize the data number in the dataset because the bem method is used for the hydrodynamic simulations the dataset is named bem dataset in the simulation the spls at three observer points for the first three bpfs are evaluated after the simulation the results are transformed to the points having a distance of 1 m to the propeller center and then averaged to obtain the standard sound source strength i e db at 1 m re 1 μ pa the three observer points have a lateral distance of 100 m to the propeller center and are posed on the starboard side for right hand propellers and the port side for left hand propellers their depths are 10 m 25 m and 40 m respectively using three observers and averaging the sound pressures helps reduce the effect of sound directivity in the simulation no reflection due to free surface or seafloor is considered for the simulation the time step corresponds to 5 degrees of propeller rotation angle the maximum blade number of the propellers being considered is 5 thus such a time step is enough to give results for the 3rd bpf different time steps have been used for the case in section 2 1 the spls obtained are listed in table 1 further refinement of the timestep does not change the results significantly the difference between the spls obtained with 5 degrees in one time step and 2 degrees in one time step are within 1 db for the 1st bpf and within 2 db for the 2nd and 3rd bpf this relative large time step also enables us to run a large number of simulations with available resources the maximum simulated time for the hydrodynamic computation is set to be 10 propeller revolutions when the hydrodynamic results thrust torque and cavity volume converge in 10 rotations then two more revolutions are simulated to provide data for the acoustic evaluation when the hydrodynamic results do not converge in 10 rotations the case is excluded from the bem dataset totally 17 propellers are used including the propeller geometries provided by industrial partners and open access propellers totally 25 wake fields are used of which 8 are for single screw ships and 17 for twin screw ships for every pair of propeller and wake field two advance ratios and 4 cavitation numbers are considered to generate 8 data items thus there are totally 3400 cases being simulated after the simulations the unconverged cases are removed finally there are 3098 valid data items in the bem dataset 3 noisenet architecture in this work the function of the ann being developed noisenet is predicting the urn at the first three bpfs of cavitating marine propeller with knowing the propeller geometry ship hull wake field and working conditions e g advance ratio propeller rotation rate cavitation number etc as known from the problem analysis in section 2 1 the cavity volume and sound pressure are time series data while the spl are variables in the frequency domain thus as depicted in fig 4 the basic idea of the noisenet architecture is to use an ann block block 1 block 2 to predict the time series variables in every time step and use another ann block from cnn to the output block to predict the frequency domain spl from time series data in every time step i e t 0 t n different blade sections are firstly handled separately block 1 and then another ann block block 2 is used to consider the interactions and combined effect considering the common cavitation locations the information at three radii are taken as input i e r 1 0 8 r r 2 0 9 r and r 3 0 95 r such a basic architecture would have the same number of parameters when the number of time step or the number of blade sections changes the inputs for the noisenet consist of two parts i e the time sequence input and scalar input the sequence input of one data item is a 3 dimension array with the size t x n r n x with t x being the number of time steps n r the number of radii 3 and n x the number of input variables for one radius at one time step that means n x variables are used to describe the hydrodynamic situation of a blade section when the blade is at a specific azimuthal position which corresponds to the time t i the value of n x is 8 and the variables consist of aoa α static pressure p 0 time derivative of both variables α and p 0 maximum camber chord ratio f c maximum thickness chord ratio t c rotation velocity v and the chord length c the aoa α is calculated with the propeller advance speed rotation rate and the wake field no induced velocity is considered the static pressure p 0 is calculated with 10 p 0 p c e n t e r ρ g r cos θ where p c e n t e r is the pressure at the propeller center ρ is the water density g is the gravitational coefficient r is the radius of the section being considered and θ is the azimuthal angle with value 0 denoting the position where the blade is vertically upwards α p 0 and their temporal derivatives describe the working conditions of the section the camber and thickness describe the geometry property of the section the rotation velocity v and chord length are the most important velocity scale and length scale for the section the rotation velocity is calculated by 11 v 2 π n r where n is the propeller rotation rate in rps the scalar inputs consist of 6 variables i e propeller diameter d blade number z rotation rate n and the distances of leading edge to blade reference line at the three radii the last three variables are thought to be important for the interaction between different sections the sequence inputs are used only once at the input layer while the scalar inputs are used multiple times for different blocks in the ann as shown in fig 4 the input features are normalized before being inputted into the ann the normalization is carried out with the approximate median m e d i a n and range r a n g e i e 12 x x 0 m e d i a n 0 5 r a n g e where x 0 denotes the original variable value and x is the value inputted in the ann in the noisenet architecture the blocks i e block 1 block 2 block 3 block 4 and the output block are all simple neural networks as shown in fig 5 the blocks with the same number e g all block 1 share the same architecture and parameters weights and biases a physical procedure analogy is used here to help understand the data flow in the noisenet architecture the block 1 can be regarded to estimate hydrodynamic performance on every radius section at every time step then the block 2 approximates the interaction between different radii and therefore the scalar input is also inputs of block 2 the cnn 1d layer is meant to learn a finite difference relation to transfer v c a v to v c a v the fft layer does fourier transformation and selects out the magnitudes at the three bpf frequencies therefore the blade number would be an input of the fft layer the log layer does only the logarithmic operation and helps to transfer sound pressure amplitude information to sound pressure levels the block 3 is to estimate the sound interference of different blades the block 4 is to consider possible energy transfer between different frequencies the output block ensures that the output number and scale are correct from the analogical explanation it could be seen that the noisenet architecture is based on the assumption that the sectional cavitation dynamics depends on the n x variables and the relation is similar on every section and at every time point the sectional interaction is considered by block 2 and the temporal interaction is considered by the cnn layer this implies that the architecture has an intrinsic characteristic of the blade element concept which might constraint its ability for situations where strong 3d effects exist it should be noted that the real meaning of the sub block s output would be decided by the learning procedure they are not guaranteed to be in line with the analogies given here the numbers of layers and number of nodes for block 1 to bock 4 are summarized in table 2 the architecture of the simple ann is showed in fig 5 for the activation function in the simple ann tanh is always used except for the output block the tanh function has the expression 13 tanh z e z e z e z e z the output range of tanh function is 1 1 and it is centered around 0 i e tanh 0 0 these properties make tanh superior to the sigmoid function for the back propagation lecun et al 1998b the tanh function also has stronger non linearity than relu rectified linear unit which can be helpful to learn non linear functions for the cnn layer the number of filters is 2 and the kernel size is 5 for the output block there are two layers the first layer is a fully connected layer with three nodes and a linear activation function this is to make sure that the number of outputs is 3 and the output value can go a little beyond 1 1 the second layer is a lambda function y 170 30 x this is to scale up the output range from around 1 1 to around 140 200 there are no parameters in the fft layer and log layer totally there are 4193 trainable parameters in the noisenet the decision process of the hyperparameters number of layers and nodes given here will be discussed in the next section the neural network was implemented in python python software foundation 2021 with the tensorflow framework the timedistributed layer has been used for the realization of block 1 block 2 and block 3 the implementation of the fft layer as well as the whole noisenet architecture is available under the link https gitlab com youjiang wang noisenet for comparison purposes two other simple neural networks are also built the first one is named as simplenet it uses the same inputs as noisenet the time sequence input and scalar input are combined together and organized as a 1d array the second one involves feature engineering and is named as fe simplenet fe stands for feature engineering five features are used to describe the variation of aoa at each radius they are the maximum aoa range of aoa largest and smallest time derivative of aoa and width of large aoa region being defined as 14 α w i d t h p α α m a x α m i n 2 where p denotes the possibility α m a x and α m i n are the maximum and minimum aoa at the radius in one rotation the cavitation number being defined at 0 9 r with the rotation rate is used to replace the pressure variation its definition is 15 σ n 0 9 p c e n t e r 0 9 ρ g r p v 0 5 ρ n 2 d 2 where p v is the vapor pressure besides all the scalar values in the input features of noisenet are included in the input features of fe simplenet they are the propeller diameter d blade number z rotation rate n as well as the distances of leading edge to blade reference line the maximum camber chord ratio f c maximum thickness chord ratio t c rotation velocity v and the chord length c at the three radii 0 8 r 0 9 r and 0 95 r thus there are totally 34 5 3 1 3 5 3 features for fe simplenet with hyper parameter optimization 3 hidden layers with 8 nodes in each layer are used in simplenet and 7 hidden layers with 32 nodes in each layer are used for fe simplenet the tanh function is used as the activation function in the hidden layers the same output block as in noisenet is adopted for both simplenet and fe simplenet which consists of a fully connected layer with 3 nodes and linear activation function and a lambda function layer with the function y 170 30x 4 results the training and test of the noisenet with the bem dataset are presented in this section in the current work the mse mean square error is used as the loss function and the mae mean absolute error is used as the main metric to judge the ann performance they are defined as 16 mse 1 m n y i m j n y y ˆ j i y j i 2 17 mae 1 m n y i m j n y y ˆ j i y j i where y ˆ is the ann prediction and y is the spl data from the bem dataset the subscript denotes the component of y and the superscript is used to distinguish the single data item i e y j i denotes the j th component of i th data item m is the number of data items being considered and n y 3 is the number of y s components when the mae and mse of a single component is concerned n y is set to 1 besides the pearson product moment correlation coefficient ppmcc is used to measure the linear dependency between the ann prediction and real data for each component it is defined as 18 ppmcc j i m y j i y j y ˆ j i y ˆ j i m y j i y j 2 i m y ˆ j i y ˆ j 2 where y j 1 m i m y j i y ˆ j 1 m i m y ˆ j i the value of ppmcc lies between 0 and 1 ppmcc 1 denotes the strongest linear dependency the value ranges ppmcc 0 5 0 3 ppmcc 0 5 and ppmcc 0 3 indicate the strong medium and weak linear dependency respectively in the following the popular random training test data split is first used afterwards a more strict data split is used and the regularization is investigated using the k fold cross validation method 4 1 random training test data split in this section 80 of the data in the bem dataset are chosen randomly for the training and the rest 20 for the test the adam optimizer kingma and ba 2017 is used for the training except for the learning rate all other parameters are set to their default values i e β 1 0 9 and β 2 0 99 the initial learning rate is set to 0 01 when the epoch number is larger than 15 and less than 50 the learning rate is timed with 0 9 in every epoch after 50 epochs the learning rate is timed with 0 99 in every epoch with such a setup different hyperparameters have been compared for the fairness purpose the same seed number is used to make sure that the random data split and ann s initial state is the same for different hyperparameters it is impractical to check all hyperparameter possibilities therefore the sub block is investigated one by one iteratively when one sub block is investigated the other sub blocks hyperparameters are kept constant for each sub block the strategy is to firstly study the effect of the number of nodes and secondly the effect of the number of layers the test mae after 50 epochs of training is used as the metric to choose the optimal hyperparameters going through all sub blocks is regarded as one iteration totally 3 iterations have been conducted the results in the last iteration are listed in tables 3 to 7 with these results the values in table 2 have been chosen for the hyperparameters with the best performed configuration a training is conducted for 200 epochs the training history is shown in fig 6 the overfitting is not obvious although no regularization was applied the mae of the training data is 4 0377 db and the test mae is 4 4387 db the ppmcc for the three components are 0 9341 0 8368 and 0 8043 respectively the linear dependency between the ann prediction and the real data is strong the comparison of the spl predicted by ann and the spl given in the bem dataset for the test dataset is shown in fig 7 the trend is clear and correct the points lie around the perfect regression line the optimization of the number of nodes and hidden layers for the simplenet and fe simplenet follows the same procedure the number of nodes is decided by comparing the test mae of networks having a single hidden layer with different numbers of nodes afterwards the number of hidden layers is decided by comparing the test mae of networks having different numbers of hidden layers with this procedure the best performed configuration for simplenet is 3 hidden layers with 8 nodes in each layer for fe simplenet it is 7 hidden layers with 32 nodes in each layer for the comparison between different neural networks 30 times independent training are conducted with noisenet simplenet and fe simplenet respectively the means and standard variances of the test mae are listed in table 8 following a levene s test levene et al 1960 for equality of variances the t test is used to check the statistical equality of means the student s t test is adopted if equal variances assumption is accepted otherwise welch s t test is exploited the threshold p value for the tests is set to 0 01 which means the equality assumption is rejected only when the confidence is larger than 99 the p values of tests are given in table 8 the small t test p values ensures that statistical differences exist between test mae mean values with high confidence the noisenet performs significantly better than the simplenet with 2 1 db less test mae while slightly worse than the fe simplenet with 0 06 db more test mae the simplenet has large number of trainable parameters in the first hidden layer due to the larger number of features this makes it hard to train and consequently perform worse than the other neural networks the performance difference between noisenet and fe simplenet is not significant with the random training test split they will be compared further in more difficult scenarios the random training test data split in this section is not strictly appropriate when considering the purpose of the ann the ann would be used to assess the hydroacoustic performance of new propeller designs with new ship hull wake fields the random data split means that the propellers and wake fields in the test data are very probably also included in the training data although the combinations are different this would make the test easier for the ann and cannot be used to judge the ann prediction quality for this reason another training test data split is used and investigated in the next section 4 2 strict training test data split a strict training test data split avoids both common propellers and wake fields in the training and test dataset its comparison with the random data split are depicted in fig 8 a training is conducted with such a strict data split 4 propellers and 5 wake fields 2 for single screw ships and 3 for twin screw ships are randomly selected for the test and the rest for the training this results in 1759 data items for the training and 180 data items for the test the noisednet and fe simplenet are both trained for 200 epochs for noisenet the train mae obtained is 4 15 db while the test mae is 9 84 db for fe simplenet the train mae is 4 42 db and test mae is 10 08 db this indicates serious overfitting the l2 regularization goodfellow et al 2016 chapter 7 is adopted to solve the overfitting problem with the l2 regularization the mean squares of ann weights are added into the loss function after being multiplied by a coefficient in this way the learning process reduces not only the mse of the training data but also the weights absolute value this helps alleviate the overfitting the k fold cross validation method james et al 2013 is used to find the optimal coefficient for the l2 regularization in the k fold cross validation method the dataset is divided into k folds for each l2 regularization coefficient k iterations are run through in the i th iteration the i th fold is used as the test data while the others as the training data the test mae is computed and averaged over the k iterations the optimal l2 regularization coefficient is then chosen according to the averaged test mae value as shown in fig 8 the strict training test split leads to some data wasting considering that the bem dataset is already small this kind of data wasting could hurt the training and other investigations it would be better if all the data could be used for the k fold cross validation for this purpose it has been investigated on which component i e the propeller or the wake field the overfitting happens two kinds of semi strict training test split are introduced they are the propeller key and wake field key training test data split as depicted in fig 9 with the propeller key method there is no common propeller in the training and test dataset but common wake fields are allowed with the wake field key method common propellers are allowed in the training and test dataset but common wake fields are avoided ten random data splits are built with both methods the noisenet and fe simplenet are trained for 200 epochs on each training data the train mae and test mae obtained are listed in tables 9 and 10 while the train maes of all cases are around 4 db 3 8 4 4 the test maes with propeller key data split are around 9 db 7 13 4 and the test mae with wake field key data split are around 5 db 4 5 5 8 it can be concluded that the overfitting happens mainly on the propeller the cause could be that the information provided about propeller geometry is insufficient therefore the ann fails to build a correct relation between cavitation dynamics and detailed propeller designs while both fe simplenet and noisenet experience severe overfitting in regards to propeller geometry and much less overfitting in regards to the wake field noisenet is better at avoiding overfitting on wake field fe simplenet generates higher test mae than noisenet for cases w2 w5 and w9 as showed in table 10 the corresponding test maes of fe simplenet are larger than 5 5 db higher than test maes of noisenet for all wake field key data split cases to verify the differences with a more rigorous procedure 30 times independent training of noisenet and fe simplenet are conducted on w2 w5 and w9 training test split cases the levene s and t test are carried out to ensure the statistical differences with enough confidence 99 the results are listed in table 11 for w5 case the large t test p value indicates that the difference between test mae mean values cannot be assured with 99 confidence the large test mae for w5 in table 10 is occasional for w2 and w9 it can be deemed with 99 confidence that the test mae mean value of noisenet is smaller than that of fe simplenet the differences are 0 5 db and 0 59 db respectively this observation implies that fe simplenet would perform worse than noisenet in some scenarios in the aspect of overfitting in regards to wake field the reason is that less information about the wake field is provided in features of fe simplenet when compared to that of noisenet with less information overfitting is easier to occur other feature engineerings may lead to better performances but a lengthy investigation by trial and error is needed due to the relative advantage of noisenet the following investigation about regularization is carried out only for noisenet with the finding that the overfitting happens mainly on the propeller the bem dataset is divided into 6 folds using the propeller key data split there are 3 propellers in each of the first 5 folds and 2 propellers in the last fold a series of l2 regularization coefficients from 0 to 8 is tried and the averaged test mae obtained with the k fold cross validation are given in fig 10 although the variation is not smooth a clear trough is observed near the value of 5 thus the value of 5 is recommended and used in the following for the l2 regularization coefficient in the noisenet with the regularization the noisenet is trained and evaluated again with the same training and test dataset at the beginning of this section i e the ones obtained with the most strict data split the training runs for more epochs the changes of loss mae and learning rate during the training are shown in fig 11 the initial learning rate is still 0 01 and the dynamic adjustment is done with the following formula 19 lr lr if epoch mod 50 30 lr e 0 02 else the learning rate is reinitialized at the 2000th and 3000th epochs to help the learning escape the local optimum trap and find better solutions after 4000 epochs the train mae is 5 86 db and the test mae is 7 34 db the comparison between the ann predicted spl and the real spl for the test data is given in fig 12 the accuracy is not so good as in fig 7 but the overall trend is still correct the distribution of the test absolute errors is given in fig 13 in the form of histograms and cdf cumulative distribution function it can be observed that 70 of the errors are less than 10 db and 40 are less than 5 db regarding the components train mae for the 1st 2nd and 3rd bpf is 4 89 db 6 08 db and 6 65 db respectively the test mae is 7 89 db 6 47 db and 7 66 db respectively this indicates that during the training it is easier to fit the 1st and 2nd bpf while for the test the errors are on the same level for all three harmonics the ppmcc for the three components are 0 5634 0 6548 and 0 4747 respectively the linear dependency between the ann prediction and real data for the 1st and 2nd bpf are strong the linear dependency for the 3rd bpf harmonic is medium ppmcc 3 0 5 that means the ann prediction for the 3rd bpf harmonic is less reliable this could be due to the decreasing accuracy of the bem fwh method for higher order harmonics fig 14 shows the variation of spl as a function of the cavitation number for two propellers both the ann predicted values and the values from the bem dataset are shown one propeller is in the training dataset and the other is in the test dataset the ann prediction follows the trend that the noise level decreases with the increasing cavitation number the correlation between the ann prediction and the bem dataset for the 1st and 2nd bpf is better than that for the 3rd bpf to study the stability of noisenet 500 independent training with different random initial states are carried out on the same training the test dataset all the training were run for 200 epochs with the same setup for the learning rate and optimizer as in section 4 1 fig 15 shows the distribution of the test maes all the values are between 6 2 db and 9 db the mean value is 7 63 db and the standard variance is 0 41 db the test mae we presented previously 7 34 db is around the mean value for a final ann product it is suggested to baby sit a training to achieve the best performance on the test dataset fig 15 implies that a test mae of 6 2 db is achievable by choosing initial state nevertheless lots of trials would be necessary the test mae value we presented i e 7 34 db could easily be achieved by more training epochs and several trials with learning rate reinitialization 5 discussion conclusion in this work the noisenet has been developed as a dedicated ann architecture for predicting the marine propeller urn with knowing the propeller geometry wake field and working conditions the noisenet has been trained and evaluated on a dataset obtained with bem fwh simulations the test mae is 7 34 db for a strict training test data split i e the propellers and wakes in the test data are fully unseen in the training data 70 of the absolute errors are less than 10 db the standard variance of the test mae regarding the random initial state is 0 41 db the current work provides a basic neural network architecture for the acoustic or hydrodynamic predictions about rotating machines with consideration of the physical knowledge the inputs are organized into different sections and different time steps different blocks are used to learn the sectional hydrodynamics interactions between different sections and time steps increasing the number of sections and keeping only block 1 and block 2 in noisenet could be adjusted to predict propellers open water performance keeping block 1 block 2 and cnn layer could result in a network for unsteady hydrodynamic and cavitation prediction these ideas need yet validations on corresponding datasets due to the property of the dataset the current work is restricted to the prediction of the spl sound pressure level at the first three bpfs blade passing frequencies nevertheless modifying the output of the fft layer would make noisenet able to predict noise levels at other frequencies or for 1 3 octave bands its suitability and ability for such predictions would need further validation on datasets with these noise level information the necessity of further hyperparameter optimization is also expected although the noisenet is deep and have a large number of inputs it is not large there are totally 4193 trainable parameters in the noisenet it has been found that 2k or even 1k data are enough to train a meaningful network industrial designers and manufacturers or even some researchers could afford this amount of data for the prediction of urn the current inputs and the noisenet architecture capture the wake field property very well no obvious overfitting in regards to the wake field has been found in the contrast serious overfitting in regards to the propeller was observed the regularization being used to alleviate the overfitting serves as a main source for the low accuracy the cause for the overfitting could be that only the maximum camber chord ratio f c and the maximum thickness chord ratio t c are used to describe the profile of a blade section the distribution of the camber and thickness are also important for the hydrodynamics of the profile i e they affect the pressure distribution and cavitation dynamics to a significant extend a set of suitable parameters to describe the 2d section profile is to be investigated in the future an encoder decoder architecture taking pointwise profile data as input and give cavitation volume as output would be tried to find the minimal set of variables to describe the profile this minimal set of variables will then be used as inputs for the noisenet to improve the prediction accuracy credit authorship contribution statement youjiang wang conceptualization methodology software validation formal analysis investigation data curation writing original draft visualization keqi wang validation investigation data curation writing review editing moustafa abdel maksoud conceptualization methodology software writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is supported by the german federal ministry of economic affairs and energy germany bmwi under the project proakus grant number 03sx461c which is part of the european project pronovi being co funded by the martera era net program 
20413,a dedicated neural network architecture called noisenet has been developed to predict urn underwater radiated noise of cavitating marine propellers the noisenet predicts the sound pressure level at the first three blade passing frequencies with knowing the propeller geometry ship hull wake field and working conditions the physical mechanism of the urn generation is firstly analyzed thereafter the physical knowledge about the hydrodynamics and hydroacoustics of marine propellers are used to develop the noisenet architecture a dataset obtained with the boundary element method and ffowcs williams hawkings acoustic analogy is used for the training and evaluation the evaluation conducted on fully unseen cases shows a mean absolute error of 7 34 db graphical abstract keywords noise neural network machine learning marine propeller cavitation 1 introduction it has been reported that the underwater background noise is raised by a significant value due to human activities krasilnikov 2019 this background noise raising as well as the impulsing underwater noise can very probably cause damage to marine life european commission 2019 shipping is recognized as one of the main sources of underwater noise and the cavitating propeller is the main sound source of the shipping thus it is important to have low noise marine propeller designs for underwater noise reduction fast and accurate numerical prediction methods of urn would help the designing and improvement activities recently the investigation about accurate numerical prediction methods of urn receives considerable attention the common choice is combining hydrodynamic solvers and acoustic analogies the rans les or bem boundary element method are used to calculate hydrodynamics and the fwh ffowcs williams hawkings acoustic analogy williams and hawkings 1969 is used to evaluate the noise all methods are time consuming because of the intrinsic unsteadiness of the problem the accuracy is also a concern the best setup for the cavitation and hydroacoustic calculation is still under research wang et al 2020 bensow and liefvendahl 2016 li et al 2018 lidtke et al 2016 meanwhile the ann artificial neural network is becoming a universal tool for the prediction of dynamic system behavior in different advanced engineering applications the ann is even used to solve pde systems raissi et al 2019 geneva and zabaras 2020 it has also attracted attention in the maritime community for examples yuan et al 2020 employed lstm long short term memory in vessel trajectory repair gkerekos et al 2019 utilized ann to predict ship fuel oil consumption under varying sailing profiles the application of ann to marine propeller urn prediction has also been explored aktas 2017 developed an ann using model scale measurement data a subset of the meridian propeller series was measured in a cavitation tunnel with various axial wake fields tunnel vacuum conditions and propeller speeds to generate the dataset two independent anns were developed to predict the total and background noise level at the 31 1 3 octave center frequencies from 20 hz to 20 khz respectively the net noise level of the propeller was then predicted by subtracting the background noise from the total noise 12 features were used as inputs including 3 propeller design parameters 3 wake parameters 3 propeller performance coefficients and 3 differently defined cavitation numbers one hidden layer was used in both anns the optimal numbers of neurons in the hidden layer were found by the sweep function two test cases having full scale urn data were used for the validation miglianti et al 2019 has developed a pure data driven model and a hybrid model for the marine propeller urn prediction using model scale measurement data in a cavitation tunnel two controllable pitch propellers of twin screw ships with one single wake field for each propeller were measured in their work they have compared the physical model pure data driven model and the hybrid model which combines the physical model and data driven model through multi task learning the kernel regularized least squares method with a single hidden layer was adopted for the data driven model inputs for models were a set of scalar parameters providing a global description of the propeller and its functioning the output of the data driven model consisted of 9 variables to describe a simplified continuous spectrum the results were validated for working conditions within and out of the ones exploited for building the model it was found that the hybrid model performs better than the pure physical model or pure data driven model miglianti et al 2020 continued their investigation by extending the dataset to 3 controllable pitch propellers and 6 wake fields different input feature sets and different noise spectra parametrizations as output have been explored convolutional layers were adopted to reduce the number of trainable parameters in the ann for large input feature sets it was indicated that best performances were obtained when all the features were considered together in general an ann being able to evaluate the marine propeller urn would help to reduce the computation time required for example to the authors experience a bem fwh method simulating ten propeller revolutions would require several hours for a single case while a purely ann prediction takes less than one second besides ann has the potential to achieve better prediction accuracy than canonical numerical methods e g rans fwh or bem fwh if high quality model or full scale marine propeller urn measurement data are used for the training according to the experiences in the machine learning community the dedicated architecture is the key to reduce the requirement of data amount and to increase the prediction accuracy for example cnn convolution neural network is developed for image related problems and rnn recurrent neural network is developed for time series problems based on these special layers the dedicated architectures lenet 5 lecun et al 1998a alexnet krizhevsky et al 2017 vgg simonyan and zisserman 2015 and residualnet he et al 2016 have been designed to improve the image recognition accuracy the dedicated encoder decoder architecture cho et al 2014 bahdanau et al 2016 was designed for machine translation and the rnn ctc connectionist temporal classification architecture graves and jaitly 2014 was designed for speech recognition all of them have helped to increase the machine learning ability for the marine propeller urn problem there are a lot of features e g pointwise velocity values in the wake field and all propeller geometry parameters that can influence the urn personally chosen global description features could lead to the loss of information this might hinder the exploitation of the full ability of machine learning and constrain the ann s applicability to specific propeller classes or working scenarios a simple fully connected ann architecture with considering all features would result in many trainable parameters which might then require an unaffordable amount of data for a meaningful training thus a dedicated ann architecture using the raw features as inputs and considering the specific attributes of the marine propeller urn problem needs to be developed in this paper such a dedicated neural network architecture for the prediction of marine propeller urn will be described the physical relationship is taken into consideration in the architecture the dataset being used is obtained through simulations with the bem fwh coupling method the high computational efficiency of the bem fwh method enables the collection of a relatively large amount of data the large dataset facilitates the exploration of the possible ann architecture for marine propeller urn prediction the bem fwh method has been used to calculate the radiated noise of both non cavitating propeller wang et al 2020 testa et al 2018 and cavitating propeller cases göttsche et al 2019 göttsche 2020 although bem is not a good tool for the broadband noise previous work showed that it can give satisfactory predictions of tonal noise at least up to the 3rd blade harmonics göttsche et al 2019 thus we strict us to the analysis of tonal noise at 1st to 3rd bpfs blade passing frequency in the current work the manuscript is organized as follows in section 2 the physical problem is analyzed and the dataset being used is described in section 3 the noisenet architecture is presented together with the idea behind it in section 4 some training and test results as well as comparisons of noisenet with two other simple neural networks are given further discussions and conclusions are given in section 5 2 problem analysis and the dataset the problem being solved is predicting the urn of cavitating marine propellers in this section the problem i e the main noise source and physical relationship between the knowns and the noise is analyzed to help develop an effective ann architecture then a dataset obtained with bem fwh simulations is described 2 1 problem analysis in most cases the marine propeller works downstream of the ship hull or other structures the inflow velocity in front of the propeller disk is not uniform the velocity distribution can be described by the ship hull wake field an example of which is shown in fig 1 as the marine propeller rotates in such a flow field the angle of attack aoa of the blade sections would change over time this results in pressure fluctuations on the blades the cavitation occurs where the pressure is below the saturated vapor pressure the cavity volume also varies with time due to the pressure fluctuation this has an effect of volume fluctuation because of the low density ratio between vapor and water the rotation motion the pressure fluctuation and the cavity volume fluctuation would all produce underwater noise the above described relation is depicted in fig 2 to facilitate the development of an effective ann architecture the main sound source is analyzed with the bem fwh coupling method the urn of the open access kp505 propeller moeri 2008 working in the ship hull wake field shown in fig 1 is analyzed several observers are placed on the starboard side of the propeller with different distances to the propeller the sound pressure level spl for the first three bpfs are calculated and analyzed our in house code panmare is used for the calculation its implementation has been verified in previous studies göttsche et al 2019 wang et al 2020 the farassat 1 a formulation farassat 2007 of the fwh equation is used the formulation is divided here into sub items to get their relative importance in the urn the formulation is 1 p x t p t x t p l x t p t 1 p t 2 p l 1 p l 2 p l 3 where p x t is the sound pressure at the observer x and time t and the other terms are 2 4 π p t 1 f 0 ρ 0 u n u n r 1 m r 2 ret d s 3 4 π p t 2 f 0 ρ 0 u n m r c 0 m r m 2 r 2 1 m r 3 ret d s 4 4 π p l 1 1 c 0 f 0 l r r 1 m r 2 ret d s 5 4 π p l 2 f 0 l r l m r 2 1 m r 2 ret d s 6 4 π p l 3 1 c 0 f 0 l r r m r c 0 m r m 2 r 2 1 m r 3 ret d s where 7 u v ρ ρ 0 u v 8 l p n ρ u u n v n in the above equations f 0 denotes the integration surface for fwh equation or sound source surface ρ is the fluid density ρ 0 is the undisturbed value c 0 is the sound speed and p is the absolute pressure u is the fluid velocity v is the surface moving velocity both are defined in a coordinate where the undisturbed fluid or far field fluid is static m is the vectorial mach number i e m v c 0 r is the vector from the source point to observer position r is its length the subscript ret means that variables inside the square brackets are computed at the corresponding retarded times i e at τ t r c 0 the subscripted variables denote dot products of a vector and a unit vector implied by the subscript except for l m l m and n is the unit normal vector on the surface directing into the fluid domain the dot over a variable means time derivative with the sound pressure obtained with above equations the spl is calculated by its definition 9 spl 20 log 10 2 mag f p p r e f where f denotes the fourier transformation mag means the magnitude of complex fourier coefficients for specific positive frequencies p r e f 1 1 0 6 pa is the reference pressure and 2 is used to scale the two sided amplitude spectrum to root mean square values of sound pressure the spl calculated by considering different single sub items are shown in fig 3 as functions of distance to the propeller center it can be observed that the term p t 1 is obviously dominant with physical consideration u n u n u n in p t 1 is the time derivative of the normal velocity of fluid on the blade surface the surface integration of this term is actually the second time derivative of the total cavity volume v c a v thus the main sound source term is the temporal variation of the cavity volume this correlates well with the observation that cavitating propellers have much more noise than the non cavitating cases bertschneider et al 2014 fréchou et al 2001 turkmen et al 2017 2 2 dataset the dataset used in this work is generated by the hydroacoustic simulations with the bem fwh method more exactly using our in house code panmare multiple propellers and ship hull wake fields are used every possible pairing of propeller and wake field are simulated to maximize the data number in the dataset because the bem method is used for the hydrodynamic simulations the dataset is named bem dataset in the simulation the spls at three observer points for the first three bpfs are evaluated after the simulation the results are transformed to the points having a distance of 1 m to the propeller center and then averaged to obtain the standard sound source strength i e db at 1 m re 1 μ pa the three observer points have a lateral distance of 100 m to the propeller center and are posed on the starboard side for right hand propellers and the port side for left hand propellers their depths are 10 m 25 m and 40 m respectively using three observers and averaging the sound pressures helps reduce the effect of sound directivity in the simulation no reflection due to free surface or seafloor is considered for the simulation the time step corresponds to 5 degrees of propeller rotation angle the maximum blade number of the propellers being considered is 5 thus such a time step is enough to give results for the 3rd bpf different time steps have been used for the case in section 2 1 the spls obtained are listed in table 1 further refinement of the timestep does not change the results significantly the difference between the spls obtained with 5 degrees in one time step and 2 degrees in one time step are within 1 db for the 1st bpf and within 2 db for the 2nd and 3rd bpf this relative large time step also enables us to run a large number of simulations with available resources the maximum simulated time for the hydrodynamic computation is set to be 10 propeller revolutions when the hydrodynamic results thrust torque and cavity volume converge in 10 rotations then two more revolutions are simulated to provide data for the acoustic evaluation when the hydrodynamic results do not converge in 10 rotations the case is excluded from the bem dataset totally 17 propellers are used including the propeller geometries provided by industrial partners and open access propellers totally 25 wake fields are used of which 8 are for single screw ships and 17 for twin screw ships for every pair of propeller and wake field two advance ratios and 4 cavitation numbers are considered to generate 8 data items thus there are totally 3400 cases being simulated after the simulations the unconverged cases are removed finally there are 3098 valid data items in the bem dataset 3 noisenet architecture in this work the function of the ann being developed noisenet is predicting the urn at the first three bpfs of cavitating marine propeller with knowing the propeller geometry ship hull wake field and working conditions e g advance ratio propeller rotation rate cavitation number etc as known from the problem analysis in section 2 1 the cavity volume and sound pressure are time series data while the spl are variables in the frequency domain thus as depicted in fig 4 the basic idea of the noisenet architecture is to use an ann block block 1 block 2 to predict the time series variables in every time step and use another ann block from cnn to the output block to predict the frequency domain spl from time series data in every time step i e t 0 t n different blade sections are firstly handled separately block 1 and then another ann block block 2 is used to consider the interactions and combined effect considering the common cavitation locations the information at three radii are taken as input i e r 1 0 8 r r 2 0 9 r and r 3 0 95 r such a basic architecture would have the same number of parameters when the number of time step or the number of blade sections changes the inputs for the noisenet consist of two parts i e the time sequence input and scalar input the sequence input of one data item is a 3 dimension array with the size t x n r n x with t x being the number of time steps n r the number of radii 3 and n x the number of input variables for one radius at one time step that means n x variables are used to describe the hydrodynamic situation of a blade section when the blade is at a specific azimuthal position which corresponds to the time t i the value of n x is 8 and the variables consist of aoa α static pressure p 0 time derivative of both variables α and p 0 maximum camber chord ratio f c maximum thickness chord ratio t c rotation velocity v and the chord length c the aoa α is calculated with the propeller advance speed rotation rate and the wake field no induced velocity is considered the static pressure p 0 is calculated with 10 p 0 p c e n t e r ρ g r cos θ where p c e n t e r is the pressure at the propeller center ρ is the water density g is the gravitational coefficient r is the radius of the section being considered and θ is the azimuthal angle with value 0 denoting the position where the blade is vertically upwards α p 0 and their temporal derivatives describe the working conditions of the section the camber and thickness describe the geometry property of the section the rotation velocity v and chord length are the most important velocity scale and length scale for the section the rotation velocity is calculated by 11 v 2 π n r where n is the propeller rotation rate in rps the scalar inputs consist of 6 variables i e propeller diameter d blade number z rotation rate n and the distances of leading edge to blade reference line at the three radii the last three variables are thought to be important for the interaction between different sections the sequence inputs are used only once at the input layer while the scalar inputs are used multiple times for different blocks in the ann as shown in fig 4 the input features are normalized before being inputted into the ann the normalization is carried out with the approximate median m e d i a n and range r a n g e i e 12 x x 0 m e d i a n 0 5 r a n g e where x 0 denotes the original variable value and x is the value inputted in the ann in the noisenet architecture the blocks i e block 1 block 2 block 3 block 4 and the output block are all simple neural networks as shown in fig 5 the blocks with the same number e g all block 1 share the same architecture and parameters weights and biases a physical procedure analogy is used here to help understand the data flow in the noisenet architecture the block 1 can be regarded to estimate hydrodynamic performance on every radius section at every time step then the block 2 approximates the interaction between different radii and therefore the scalar input is also inputs of block 2 the cnn 1d layer is meant to learn a finite difference relation to transfer v c a v to v c a v the fft layer does fourier transformation and selects out the magnitudes at the three bpf frequencies therefore the blade number would be an input of the fft layer the log layer does only the logarithmic operation and helps to transfer sound pressure amplitude information to sound pressure levels the block 3 is to estimate the sound interference of different blades the block 4 is to consider possible energy transfer between different frequencies the output block ensures that the output number and scale are correct from the analogical explanation it could be seen that the noisenet architecture is based on the assumption that the sectional cavitation dynamics depends on the n x variables and the relation is similar on every section and at every time point the sectional interaction is considered by block 2 and the temporal interaction is considered by the cnn layer this implies that the architecture has an intrinsic characteristic of the blade element concept which might constraint its ability for situations where strong 3d effects exist it should be noted that the real meaning of the sub block s output would be decided by the learning procedure they are not guaranteed to be in line with the analogies given here the numbers of layers and number of nodes for block 1 to bock 4 are summarized in table 2 the architecture of the simple ann is showed in fig 5 for the activation function in the simple ann tanh is always used except for the output block the tanh function has the expression 13 tanh z e z e z e z e z the output range of tanh function is 1 1 and it is centered around 0 i e tanh 0 0 these properties make tanh superior to the sigmoid function for the back propagation lecun et al 1998b the tanh function also has stronger non linearity than relu rectified linear unit which can be helpful to learn non linear functions for the cnn layer the number of filters is 2 and the kernel size is 5 for the output block there are two layers the first layer is a fully connected layer with three nodes and a linear activation function this is to make sure that the number of outputs is 3 and the output value can go a little beyond 1 1 the second layer is a lambda function y 170 30 x this is to scale up the output range from around 1 1 to around 140 200 there are no parameters in the fft layer and log layer totally there are 4193 trainable parameters in the noisenet the decision process of the hyperparameters number of layers and nodes given here will be discussed in the next section the neural network was implemented in python python software foundation 2021 with the tensorflow framework the timedistributed layer has been used for the realization of block 1 block 2 and block 3 the implementation of the fft layer as well as the whole noisenet architecture is available under the link https gitlab com youjiang wang noisenet for comparison purposes two other simple neural networks are also built the first one is named as simplenet it uses the same inputs as noisenet the time sequence input and scalar input are combined together and organized as a 1d array the second one involves feature engineering and is named as fe simplenet fe stands for feature engineering five features are used to describe the variation of aoa at each radius they are the maximum aoa range of aoa largest and smallest time derivative of aoa and width of large aoa region being defined as 14 α w i d t h p α α m a x α m i n 2 where p denotes the possibility α m a x and α m i n are the maximum and minimum aoa at the radius in one rotation the cavitation number being defined at 0 9 r with the rotation rate is used to replace the pressure variation its definition is 15 σ n 0 9 p c e n t e r 0 9 ρ g r p v 0 5 ρ n 2 d 2 where p v is the vapor pressure besides all the scalar values in the input features of noisenet are included in the input features of fe simplenet they are the propeller diameter d blade number z rotation rate n as well as the distances of leading edge to blade reference line the maximum camber chord ratio f c maximum thickness chord ratio t c rotation velocity v and the chord length c at the three radii 0 8 r 0 9 r and 0 95 r thus there are totally 34 5 3 1 3 5 3 features for fe simplenet with hyper parameter optimization 3 hidden layers with 8 nodes in each layer are used in simplenet and 7 hidden layers with 32 nodes in each layer are used for fe simplenet the tanh function is used as the activation function in the hidden layers the same output block as in noisenet is adopted for both simplenet and fe simplenet which consists of a fully connected layer with 3 nodes and linear activation function and a lambda function layer with the function y 170 30x 4 results the training and test of the noisenet with the bem dataset are presented in this section in the current work the mse mean square error is used as the loss function and the mae mean absolute error is used as the main metric to judge the ann performance they are defined as 16 mse 1 m n y i m j n y y ˆ j i y j i 2 17 mae 1 m n y i m j n y y ˆ j i y j i where y ˆ is the ann prediction and y is the spl data from the bem dataset the subscript denotes the component of y and the superscript is used to distinguish the single data item i e y j i denotes the j th component of i th data item m is the number of data items being considered and n y 3 is the number of y s components when the mae and mse of a single component is concerned n y is set to 1 besides the pearson product moment correlation coefficient ppmcc is used to measure the linear dependency between the ann prediction and real data for each component it is defined as 18 ppmcc j i m y j i y j y ˆ j i y ˆ j i m y j i y j 2 i m y ˆ j i y ˆ j 2 where y j 1 m i m y j i y ˆ j 1 m i m y ˆ j i the value of ppmcc lies between 0 and 1 ppmcc 1 denotes the strongest linear dependency the value ranges ppmcc 0 5 0 3 ppmcc 0 5 and ppmcc 0 3 indicate the strong medium and weak linear dependency respectively in the following the popular random training test data split is first used afterwards a more strict data split is used and the regularization is investigated using the k fold cross validation method 4 1 random training test data split in this section 80 of the data in the bem dataset are chosen randomly for the training and the rest 20 for the test the adam optimizer kingma and ba 2017 is used for the training except for the learning rate all other parameters are set to their default values i e β 1 0 9 and β 2 0 99 the initial learning rate is set to 0 01 when the epoch number is larger than 15 and less than 50 the learning rate is timed with 0 9 in every epoch after 50 epochs the learning rate is timed with 0 99 in every epoch with such a setup different hyperparameters have been compared for the fairness purpose the same seed number is used to make sure that the random data split and ann s initial state is the same for different hyperparameters it is impractical to check all hyperparameter possibilities therefore the sub block is investigated one by one iteratively when one sub block is investigated the other sub blocks hyperparameters are kept constant for each sub block the strategy is to firstly study the effect of the number of nodes and secondly the effect of the number of layers the test mae after 50 epochs of training is used as the metric to choose the optimal hyperparameters going through all sub blocks is regarded as one iteration totally 3 iterations have been conducted the results in the last iteration are listed in tables 3 to 7 with these results the values in table 2 have been chosen for the hyperparameters with the best performed configuration a training is conducted for 200 epochs the training history is shown in fig 6 the overfitting is not obvious although no regularization was applied the mae of the training data is 4 0377 db and the test mae is 4 4387 db the ppmcc for the three components are 0 9341 0 8368 and 0 8043 respectively the linear dependency between the ann prediction and the real data is strong the comparison of the spl predicted by ann and the spl given in the bem dataset for the test dataset is shown in fig 7 the trend is clear and correct the points lie around the perfect regression line the optimization of the number of nodes and hidden layers for the simplenet and fe simplenet follows the same procedure the number of nodes is decided by comparing the test mae of networks having a single hidden layer with different numbers of nodes afterwards the number of hidden layers is decided by comparing the test mae of networks having different numbers of hidden layers with this procedure the best performed configuration for simplenet is 3 hidden layers with 8 nodes in each layer for fe simplenet it is 7 hidden layers with 32 nodes in each layer for the comparison between different neural networks 30 times independent training are conducted with noisenet simplenet and fe simplenet respectively the means and standard variances of the test mae are listed in table 8 following a levene s test levene et al 1960 for equality of variances the t test is used to check the statistical equality of means the student s t test is adopted if equal variances assumption is accepted otherwise welch s t test is exploited the threshold p value for the tests is set to 0 01 which means the equality assumption is rejected only when the confidence is larger than 99 the p values of tests are given in table 8 the small t test p values ensures that statistical differences exist between test mae mean values with high confidence the noisenet performs significantly better than the simplenet with 2 1 db less test mae while slightly worse than the fe simplenet with 0 06 db more test mae the simplenet has large number of trainable parameters in the first hidden layer due to the larger number of features this makes it hard to train and consequently perform worse than the other neural networks the performance difference between noisenet and fe simplenet is not significant with the random training test split they will be compared further in more difficult scenarios the random training test data split in this section is not strictly appropriate when considering the purpose of the ann the ann would be used to assess the hydroacoustic performance of new propeller designs with new ship hull wake fields the random data split means that the propellers and wake fields in the test data are very probably also included in the training data although the combinations are different this would make the test easier for the ann and cannot be used to judge the ann prediction quality for this reason another training test data split is used and investigated in the next section 4 2 strict training test data split a strict training test data split avoids both common propellers and wake fields in the training and test dataset its comparison with the random data split are depicted in fig 8 a training is conducted with such a strict data split 4 propellers and 5 wake fields 2 for single screw ships and 3 for twin screw ships are randomly selected for the test and the rest for the training this results in 1759 data items for the training and 180 data items for the test the noisednet and fe simplenet are both trained for 200 epochs for noisenet the train mae obtained is 4 15 db while the test mae is 9 84 db for fe simplenet the train mae is 4 42 db and test mae is 10 08 db this indicates serious overfitting the l2 regularization goodfellow et al 2016 chapter 7 is adopted to solve the overfitting problem with the l2 regularization the mean squares of ann weights are added into the loss function after being multiplied by a coefficient in this way the learning process reduces not only the mse of the training data but also the weights absolute value this helps alleviate the overfitting the k fold cross validation method james et al 2013 is used to find the optimal coefficient for the l2 regularization in the k fold cross validation method the dataset is divided into k folds for each l2 regularization coefficient k iterations are run through in the i th iteration the i th fold is used as the test data while the others as the training data the test mae is computed and averaged over the k iterations the optimal l2 regularization coefficient is then chosen according to the averaged test mae value as shown in fig 8 the strict training test split leads to some data wasting considering that the bem dataset is already small this kind of data wasting could hurt the training and other investigations it would be better if all the data could be used for the k fold cross validation for this purpose it has been investigated on which component i e the propeller or the wake field the overfitting happens two kinds of semi strict training test split are introduced they are the propeller key and wake field key training test data split as depicted in fig 9 with the propeller key method there is no common propeller in the training and test dataset but common wake fields are allowed with the wake field key method common propellers are allowed in the training and test dataset but common wake fields are avoided ten random data splits are built with both methods the noisenet and fe simplenet are trained for 200 epochs on each training data the train mae and test mae obtained are listed in tables 9 and 10 while the train maes of all cases are around 4 db 3 8 4 4 the test maes with propeller key data split are around 9 db 7 13 4 and the test mae with wake field key data split are around 5 db 4 5 5 8 it can be concluded that the overfitting happens mainly on the propeller the cause could be that the information provided about propeller geometry is insufficient therefore the ann fails to build a correct relation between cavitation dynamics and detailed propeller designs while both fe simplenet and noisenet experience severe overfitting in regards to propeller geometry and much less overfitting in regards to the wake field noisenet is better at avoiding overfitting on wake field fe simplenet generates higher test mae than noisenet for cases w2 w5 and w9 as showed in table 10 the corresponding test maes of fe simplenet are larger than 5 5 db higher than test maes of noisenet for all wake field key data split cases to verify the differences with a more rigorous procedure 30 times independent training of noisenet and fe simplenet are conducted on w2 w5 and w9 training test split cases the levene s and t test are carried out to ensure the statistical differences with enough confidence 99 the results are listed in table 11 for w5 case the large t test p value indicates that the difference between test mae mean values cannot be assured with 99 confidence the large test mae for w5 in table 10 is occasional for w2 and w9 it can be deemed with 99 confidence that the test mae mean value of noisenet is smaller than that of fe simplenet the differences are 0 5 db and 0 59 db respectively this observation implies that fe simplenet would perform worse than noisenet in some scenarios in the aspect of overfitting in regards to wake field the reason is that less information about the wake field is provided in features of fe simplenet when compared to that of noisenet with less information overfitting is easier to occur other feature engineerings may lead to better performances but a lengthy investigation by trial and error is needed due to the relative advantage of noisenet the following investigation about regularization is carried out only for noisenet with the finding that the overfitting happens mainly on the propeller the bem dataset is divided into 6 folds using the propeller key data split there are 3 propellers in each of the first 5 folds and 2 propellers in the last fold a series of l2 regularization coefficients from 0 to 8 is tried and the averaged test mae obtained with the k fold cross validation are given in fig 10 although the variation is not smooth a clear trough is observed near the value of 5 thus the value of 5 is recommended and used in the following for the l2 regularization coefficient in the noisenet with the regularization the noisenet is trained and evaluated again with the same training and test dataset at the beginning of this section i e the ones obtained with the most strict data split the training runs for more epochs the changes of loss mae and learning rate during the training are shown in fig 11 the initial learning rate is still 0 01 and the dynamic adjustment is done with the following formula 19 lr lr if epoch mod 50 30 lr e 0 02 else the learning rate is reinitialized at the 2000th and 3000th epochs to help the learning escape the local optimum trap and find better solutions after 4000 epochs the train mae is 5 86 db and the test mae is 7 34 db the comparison between the ann predicted spl and the real spl for the test data is given in fig 12 the accuracy is not so good as in fig 7 but the overall trend is still correct the distribution of the test absolute errors is given in fig 13 in the form of histograms and cdf cumulative distribution function it can be observed that 70 of the errors are less than 10 db and 40 are less than 5 db regarding the components train mae for the 1st 2nd and 3rd bpf is 4 89 db 6 08 db and 6 65 db respectively the test mae is 7 89 db 6 47 db and 7 66 db respectively this indicates that during the training it is easier to fit the 1st and 2nd bpf while for the test the errors are on the same level for all three harmonics the ppmcc for the three components are 0 5634 0 6548 and 0 4747 respectively the linear dependency between the ann prediction and real data for the 1st and 2nd bpf are strong the linear dependency for the 3rd bpf harmonic is medium ppmcc 3 0 5 that means the ann prediction for the 3rd bpf harmonic is less reliable this could be due to the decreasing accuracy of the bem fwh method for higher order harmonics fig 14 shows the variation of spl as a function of the cavitation number for two propellers both the ann predicted values and the values from the bem dataset are shown one propeller is in the training dataset and the other is in the test dataset the ann prediction follows the trend that the noise level decreases with the increasing cavitation number the correlation between the ann prediction and the bem dataset for the 1st and 2nd bpf is better than that for the 3rd bpf to study the stability of noisenet 500 independent training with different random initial states are carried out on the same training the test dataset all the training were run for 200 epochs with the same setup for the learning rate and optimizer as in section 4 1 fig 15 shows the distribution of the test maes all the values are between 6 2 db and 9 db the mean value is 7 63 db and the standard variance is 0 41 db the test mae we presented previously 7 34 db is around the mean value for a final ann product it is suggested to baby sit a training to achieve the best performance on the test dataset fig 15 implies that a test mae of 6 2 db is achievable by choosing initial state nevertheless lots of trials would be necessary the test mae value we presented i e 7 34 db could easily be achieved by more training epochs and several trials with learning rate reinitialization 5 discussion conclusion in this work the noisenet has been developed as a dedicated ann architecture for predicting the marine propeller urn with knowing the propeller geometry wake field and working conditions the noisenet has been trained and evaluated on a dataset obtained with bem fwh simulations the test mae is 7 34 db for a strict training test data split i e the propellers and wakes in the test data are fully unseen in the training data 70 of the absolute errors are less than 10 db the standard variance of the test mae regarding the random initial state is 0 41 db the current work provides a basic neural network architecture for the acoustic or hydrodynamic predictions about rotating machines with consideration of the physical knowledge the inputs are organized into different sections and different time steps different blocks are used to learn the sectional hydrodynamics interactions between different sections and time steps increasing the number of sections and keeping only block 1 and block 2 in noisenet could be adjusted to predict propellers open water performance keeping block 1 block 2 and cnn layer could result in a network for unsteady hydrodynamic and cavitation prediction these ideas need yet validations on corresponding datasets due to the property of the dataset the current work is restricted to the prediction of the spl sound pressure level at the first three bpfs blade passing frequencies nevertheless modifying the output of the fft layer would make noisenet able to predict noise levels at other frequencies or for 1 3 octave bands its suitability and ability for such predictions would need further validation on datasets with these noise level information the necessity of further hyperparameter optimization is also expected although the noisenet is deep and have a large number of inputs it is not large there are totally 4193 trainable parameters in the noisenet it has been found that 2k or even 1k data are enough to train a meaningful network industrial designers and manufacturers or even some researchers could afford this amount of data for the prediction of urn the current inputs and the noisenet architecture capture the wake field property very well no obvious overfitting in regards to the wake field has been found in the contrast serious overfitting in regards to the propeller was observed the regularization being used to alleviate the overfitting serves as a main source for the low accuracy the cause for the overfitting could be that only the maximum camber chord ratio f c and the maximum thickness chord ratio t c are used to describe the profile of a blade section the distribution of the camber and thickness are also important for the hydrodynamics of the profile i e they affect the pressure distribution and cavitation dynamics to a significant extend a set of suitable parameters to describe the 2d section profile is to be investigated in the future an encoder decoder architecture taking pointwise profile data as input and give cavitation volume as output would be tried to find the minimal set of variables to describe the profile this minimal set of variables will then be used as inputs for the noisenet to improve the prediction accuracy credit authorship contribution statement youjiang wang conceptualization methodology software validation formal analysis investigation data curation writing original draft visualization keqi wang validation investigation data curation writing review editing moustafa abdel maksoud conceptualization methodology software writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is supported by the german federal ministry of economic affairs and energy germany bmwi under the project proakus grant number 03sx461c which is part of the european project pronovi being co funded by the martera era net program 
20414,in this paper a turning circle based trajectory planning method tcbtpm is proposed to conduct trajectory planning of an underactuated autonomous underwater vehicle auv for mobile docking mission firstly the six degrees of freedom kinematics and dynamics model of underactuated auv is acquired following this the simulation of horizontal turning circle trial is studied and the overview of mobile docking mission is introduced furthermore tcbtpm is used to predict the relative position of auv and the mobile docking station mds in advance and generate a feasible trajectory for the mobile docking mission finally a mobile docking guidance system containing tcbtpm pure pursuit pp guidance law and line of sight los guidance law is employed to obtain desired guidance commands and guides the underactuated auv to dock efficiently and reliably keywords trajectory planning turning circle underwater mobile docking underactuated auv 1 introduction autonomous underwater vehicles auvs are widely used in underwater survey mineral exploration and oceanographic mapping li et al 2009 the need of auvs has become increasingly apparent and the research on auvs has been absorbing significant attention of researchers yazdani et al 2020 automated underwater docking technology is a research focus because it is useful for the underwater recycling of auvs and can greatly reduce manual operation besides auvs can charge automatically at any time which is an alternative solution to improve auvs mission endurance since the operational endurance of auvs is limited by their battery capacity what s more auvs can transfer at high speed the vast amounts of data with the help of automated underwater docking technology compared to the fixed docking technology mobile docking has more flexibility for example an unmanned surface vehicle usv can be a support and delivery platform for auvs and they will collaborate on more complex tasks lots of theoretical research and experiments on underwater docking raspante 2012 li et al 2015 yang et al 2016 sans muntadas et al 2016 sarda and dhanak 2018 palomeras et al 2018 liu et al 2019 are being carried out because auv underwater docking technology is of great research significance and practical value a reliable vision positioning method using two cameras is introduced which switches between combining monocular and binocular positioning method according to the image number of mark points in both cameras and underwater docking experiments are conducted to prove that auv can enter into fixed funnel shaped docking station at different start point li et al 2015 two complementary and cost effective localization systems have been developed and auv can complete the docking maneuver with low cost equipment and minimal requirements on both the vehicle and the docking station sides palomeras et al 2018 an automated launch and recovery system lars has been designed which enables two alternatives using either a mobile or station keeping usv to launch and recover an auv and the sea trials have demonstrated that a station keeping usv can be utilized to launch and recover an auv autonomously sarda and dhanak 2018 a vision based framework has been proposed for automatically recovering an auv by another auv in shallow water and the field experiments have validated that the proposed visual navigation method is reliable liu et al 2019 on the other hand considering reducing the actuator cost vehicle weight and energy consumption or increasing the reliability of the system due to actuator failure most of auvs use rudders and elevators to control yaw and pitch instead of thrusters repoulias and papadopoulos 2007 there is a deviation between heading and course of the underactuated auv which is caused by the effect of ocean currents and can induce some serious collisions therefore in order to make the vehicle s position attitude and approach velocity satisfy those of the docking station during the terminal docking phase the guidance and control laws are a research focus too sans muntadas et al 2016 park et al 2011 auv guidance system is an essential part of the underwater docking mission and it produces feasible and applicable guidance commands that would enable an underactuated auv to home and dock efficiently and reliably besides the guidance system needs to take both the limitations of the vehicle s actuators and environmental constraints into account the problem of docking trajectory generation for auvs is usually considered as an optimal control problem with constraints and its numerical solutions can be categorized into two major branches rao 2014 the first one is indirect solutions which use pontryagin s maximum principle to construct the first order necessary conditions and then convert an optimal control problem into a hamiltonian boundary value problem yazdani et al 2020 the second branch is direct solutions which transcribe the continuous optimal control problem into a nonlinear programming problem by parameterizing states and or controls yazdani et al 2016 2017 the major concern is these methods may not work in real time applications because they require a lot of computational resources in addition a useful guidance method is based on fuzzy inference system teo et al 2012 2015 2015 pearson et al 2014 which can provide the desired heading and speed commands for auv to complete docking mission and the sea trials have demonstrated the effectiveness of the implemented guidance algorithms in the fixed docking mission however this approach will waste a lot of time in mobile docking mission because fuzzy logic guidance method can t take the movement of mobile docking station mds into consideration and only gives guidance commands based on the current position of mds based on the above analysis the turning circle based trajectory planning method tcbtpm is proposed here the planned trajectory is a combination of turning circular arcs and line segments auv s maximum speed and its turning ability can be measured by simulation or field experiments then auv s position can be calculated at any time when it moves along the planned trajectory if mds does a uniform linear motion the relative position of auv and the mds can be predicted in advance and it is easy to generate a feasible trajectory for auv s mobile docking mission the proposed trajectory planning method can also estimate the position and time of successful docking and be able to guide auv to complete turning motion in advance so that the auv has the same heading as the mds and docks from behind when underactuated auv moves in opposite direction to the mds besides a mobile docking guidance system containing tcbtpm pure pursuit pp guidance law and line of sight los guidance law is used to generate desired surge velocity yaw angle pitch angle and guides the underactuated auv to dock efficiently and reliably what s more this method has low computational burden and is suitable for real time applications the rest of this paper is organized as follows the mathematical model of an underactuated auv system is presented in section 2 in section 3 a mobile docking guidance system containing tcbtpm pp guidance law and los guidance law is used to generate desired surge velocity yaw angle pitch angle and guide the underactuated auv to dock efficiently and reliably the simulation and analysis are provided in section 4 finally some conclusions of this paper are brought forward in section 5 2 auv modeling this section presents the six degrees of freedom kinematics and dynamics model of an underactuated auv we define the earth fixed coordinate system i and the body fixed coordinate system b of the auv as shown in fig 1 where x y and z represent the inertial coordinates of the vehicle in the earth fixed frame u v w are the surge sway and heave velocities respectively defined in the body fixed frame p q and r represent roll angular velocity pitch angular velocity and yaw angular velocity ϕ θ and ψ are roll angle pitch angle and yaw angle the six degrees of freedom kinematics equations can be written as fossen 1994 xu et al 2013 1a x u cos ψ cos θ v cos ψ sin θ sin ϕ sin ψ cos ϕ w cos ψ sin θ sin ϕ sin ψ sin ϕ 1b y u sin ψ cos θ v sin ψ sin θ sin ϕ cos ψ cos ϕ w sin ψ sin θ cos ϕ cos ψ sin ϕ 1c z u sin θ v cos θ sin ϕ w cos θ cos ϕ 1d ϕ p q sin ϕ tan θ r cos ϕ tan θ 1e θ q cos ϕ r sin ϕ 1f ψ q sin ϕ r cos ϕ cos θ the dynamics equations of underactuated auv are 2a m u v r w q x g q 2 r 2 y g p q r z g p r q x h x g τ u 2b m v w p u r y g r 2 p 2 z g q r p x g q p r y h y g 2c m w u q v p z g p 2 q 2 x g r p q y g r q p z h z g 2d i x p i z i y q r m y g w p v q u z g v u r w p k h k g 2e i y q i x i z r p m z g u w p v r x g w p v u q m h m g m u u δ s u 2 δ s 2f i z r i y i z p q m x g v u r p w y g u q w v r n h n g n u u δ r u 2 δ r and 3a x h x q q q 2 x r r r 2 x r p r p x u u x v r v r x w q w q x u u u 2 x v v v 2 x w w w 2 3b y h y r r y p p y p p p p y p q p q y q r q r y v v y v q v q y w p w p y w r w r y r u r y p u p y v r v v v 2 w 2 1 2 r y 0 u 2 y v u v y v v v v v 2 w 2 1 2 y v w v w 3c z h z q q z p p p 2 z r r r 2 z r p r p z w w z v r v r z v p v p z q u q z w q w w v 2 w 2 1 2 q z 0 u 2 z w u w z w w w v 2 w 2 1 2 z w u w z w w w v 2 w 2 1 2 z v v v 2 3d k h k p p k r r k q r q r k p q p q k p p p p k p u p k r u r k v v k v q v q k w p w p k w r w r k 0 u 2 k v u v k v v v v 2 w 2 1 2 k v w v w 3e m h m q q m p p p 2 m r r r 2 m q q q q m w w m v r v r m v p v p m q u q m w q v 2 w 2 1 2 q m 0 u 2 m w u w m w w w v 2 w 2 1 2 m w u w m w w w v 2 w 2 1 2 m v v v 2 3f n h n r r n p p n p q p q n q r q r n r r r r n v v n w r w r n w p w p n v q v q n p u p n r u r n v r v 2 w 2 1 2 r n 0 u 2 n v u v n v v v v 2 w 2 1 2 n v w v w the vehicle experiences hydrostatic forces and moments as a result of the combined effects of the vehicle weight w and buoyancy b the equations of hydrostatic forces and moments are written as 4a x g w b sin θ 4b y g w b cos θ sin ϕ 4c z g w b cos θ cos ϕ 4d k g y g w y b b cos θ cos ϕ z g w z b b cos θ sin ϕ 4e m g z g w z b b sin θ x g w x b b cos θ cos ϕ 4f n g x g w x b b cos θ sin ϕ y g w y b b sin θ where m is the mass of the vehicle i x i y and i z are the moments of inertia x q q etc are the hydrodynamic coefficients x g y g and z g are the coordinates of the center of gravity x b y b and z b are the coordinates of the center of buoyancy the surge force τ u elevator angle δ s and rudder angle δ r are considered as the available control inputs assumption the underactuated auv s available control inputs are bounded i e τ u τ u δ s δ s and δ r δ r where τ u δ s and δ r are the known upper bounds 3 mobile docking guidance system in this section a mobile docking guidance system containing tcbtpm pp guidance law and los guidance law is used to generate desired surge velocity u d desired yaw angle ψ d and desired pitch angle θ d that enable an underactuated auv to dock efficiently and reliably 3 1 simulation of horizontal turning circle trial this trial is mainly used to calculate the vehicle s steady turning radius and to check how well the steering machine performs under course changing maneuvers fossen 1994 the simulations are conducted by turning the auv over at a constant speed and with a constant rudder angle fig 2 shows the trajectories of the auv gravity center in the horizontal plane and table 1 gives the turning radiuses and the turning periods under different rudder angles but the same speed as can be seen the minimum turning radius is about 13 31 m at a specific speed of 1 5 m s and with a rudder angle of maximum 24 3 2 mobile docking guidance system the overview of mobile docking mission is shown in fig 3 assuming that mds does a uniform linear motion at a speed of u d which is carried by the mother vessel and auv approaches the mds at a maximum speed of u r u r u d auv can sense the position of mds using the ultrashort baseline acoustic position system usbl and cameras if the auv is captured successfully it will be towed by the mds with its propeller stopped and will maintain a surge velocity which will be the same as the mds if not mds s heading can be estimated by using the measurements of usbl doppler velocity log dvl and dead reckoning zhou et al 2018 we establish mds fixed reference frame x o y on the position of mds that x axis goes along mds s heading and the relative position errors x e y e z e between the auv and mds can be calculated then the desired surge velocity u d yaw angle ψ d and pitch angle θ d can be obtained by the guidance system finally auv is controlled automatically by the controller and the actuators to approach the mds from behind and complete the mobile docking mission tcbtpm is proposed to estimate the position and time of successful docking and the complete process of the mobile docking guidance system fig 4 is shown as follows step 1 as seen in fig 5 the docking region is divided into two sections in the horizontal plane initialize all kinds of parameters d 1 d 2 d 3 k 1 k 2 k 3 k 4 k 5 b 0 and choose the turning radius r the turning period t for trajectory planning and the angular velocity of turning motion can be calculated by ω 2 π t step 2 calculate the relative position errors x e y e z e between auv and mds if the mobile docking mission is completed go to step 11 otherwise go to step 3 step 3 the desired pitch angle is calculated by the equation θ d arctan z e k 1 step 4 first determine whether b is 0 if it is not equal to 0 then go to step 7 for control according to the planned trajectory and los guidance law if equal to 0 then go to step 5 step 5 determine which section the auv is in if auv is in section 1 los guidance law is adopted and the desired yaw angle and the desired surge velocity are calculated by equations 5 and 6 and go to step 10 5 ψ d arctan y e k 2 arctan v u 6 u d u r x e 0 y e 1 z e 1 u d x e d 3 k 3 e l s e where d 3 is considered as the safe distance if auv is in section 2 first determine whether x e is greater than or equal to 0 if so calculate the angle a 1 between the x axis of the mds fixed reference frame and the straight line which connects auv and mds and then go to step 6 otherwise one case of tcbtpm is shown in fig 6 where mds is at point o and auv is at point a in this case the planned trajectory is a combination of a circular arc and a line segment besides auv s theoretical traveling time t t o t a l on the planned trajectory and the angle a are the solution of equations 7 and 8 then assign b a non zero value and call the current mds fixed reference frame x o y as x o y record the current time t 1 t the theoretical time t 2 t 3 when auv reaches b c along the planned trajectory and go to step 7 7 t t o t a l a ω u r cos a r sin a u d t t o t a l d 3 x e 8 t t o t a l a ω u r sin a r 1 cos a y e step 6 the remaining two cases of tcbtpm are shown in figs 7 and 8 where mds is at point o and auv is at point a the second one is shown in fig 7 when y e r cos a 1 r the planned trajectory is a combination of two circular arcs and a line segment in this case the circle o 1 is tangent to the straight line o a at point a the circle o 2 is tangent to the x axis at point d and the line segment b c is parallel to the y axis and is tangent to both circle o 1 and circle o 2 it s easy to know that a 2 π 2 a 1 and calculate auv s theoretical traveling time t t o t a l on the planned trajectory if the condition x e d 3 is satisfied when the auv reaches the x axis along the planned trajectory it is considered that the auv will not collide with the mds and the trajectory planning is considered to be successful then assign b a non zero value and call the current mds fixed reference frame x o y as x o y record the current time t 1 t and the theoretical time t 2 t 3 t 4 when auv reaches b c d along the planned trajectory assign s i g based on equation 9 and go to step 7 if the condition x e d 3 is not satisfied the trajectory planning is considered to be unsuccessful and then go to step 9 the third case is shown in fig 8 when y e r cos a 1 r the trajectory of turning motion is a combination of two circular arcs in this case the circle o 1 is tangent to the straight line o a at point a the circle o 2 o 2 is tangent to both the x axis and circle o 1 it s easy to know that a 2 arccos o 1 d o 1 o 2 and calculate auv s theoretical traveling time t t o t a l on the planned trajectory when a 2 a 1 the planned trajectory is the arc a b c when a 2 a 1 the planned trajectory is the arc a b c if the condition x e d 3 t t o t a l t is satisfied when the auv reaches the x axis along the planned trajectory it is considered that the auv will not collide with the mds and the trajectory planning is considered to be successful then assign b a non zero value and call the current mds fixed reference frame x o y as x o y record the current time t 1 t and theoretical time t 3 when auv reaches b b c c along the planned trajectory assign s i g based on equation 9 and go to step 7 if the condition x e d 3 t t o t a l t is not satisfied the trajectory planning is considered to be unsuccessful and then go to step 9 9 s i g 1 y e 0 1 y e 0 step 7 if the actual time of auv traveling on the planned trajectory is greater than the theoretical traveling time t t o t a l on th t 2 e planned trajectory that means t t 1 t t o t a l or the condition x e d 3 is satisfied let b 0 and then go to step 8 step 8 the desired surge velocity u d yaw angle ψ d is calculated according to the planned trajectory which is generated by tcbtpm x o i y o i are defined as the center coordinate of turning circle o 1 and o 2 in the reference frame x o y φ 0 i denotes the angle between the x axis and the vector that points from center of the circle to the starting point of each circular arc t 0 i is the time when the auv starts from the starting point of each circular arc the coordinate of desired position in circular trajectory can be obtained as follows 10 x d x o i r cos ω t t 0 i φ 0 i y d y o i r sin ω t t 0 i φ 0 i where ω ω corresponds to anti clockwise motion and ω ω corresponds to clockwise motion the coordinate of desired position in straight trajectory can be obtained as follows 11 x d x o 1 r y d y o 1 s i g u r t t 2 consider a path fixed reference frame with origin at x d y d and the x axis of this reference frame is tangent to the circle or goes along the straight line when auv tracks the circular trajectory the x axis of this reference frame has been rotated a angle relative to the x axis of the reference frame x o y 12 ψ d 0 d x d y 0 π 2 d x 0 d y 0 π 2 d x 0 d y 0 arctan d y d x d x 0 arctan d y d x π d y 0 where 13 d x ω r sin ω t t 0 i φ 0 i d y ω r cos ω t t 0 i φ 0 i when auv tracks the straight trajectory ψ d s i g π 2 the trajectory tracking errors are defined as 14 s x e u d t t 1 x d cos ψ d y e y d sin ψ d e x e u d t t 1 x d sin ψ d y e y d cos ψ d the los guidance law fossen et al 2015 is adopted and go to step 10 15 ψ d ψ d arctan e k 4 arctan v u 16 u d u r s k 5 step 9 the pp guidance law fossen 2011 is adopted and the desired yaw angle and the desired surge velocity are calculated by equations 17 and 18 17 ψ d 0 x e y e 0 π 2 x e 0 y e 0 π 2 x e 0 y e 0 arctan y e x e x e 0 arctan y e x e π x e 0 18 u d u r step 10 auv is controlled based on the desired surge velocity u d yaw angle ψ d pitch angle θ d and go back to step 2 for the planning and control of next time step step 11 auv is towed by the mds with its propeller stopped 4 simulation and discussion this section presents the trajectory generated by tcbtpm is feasible and s plane controller sun et al 2011 is employed to control surge velocity yaw angle and pitch angle the mds s trajectory is given as follows 19 ξ d u d t m η d 0 m ζ d 10 m all simulation cases are studied in matlab r2019b on a personal computer equipped with an intel core i5 9300hf processor 2 4 ghz cpu and 8 gb ram in the environment of windows 10 and the following two cases are considered case 1 trajectory planning using different turning radiuses and turning periods case 2 the following three guidance methods are compared 1 tcbtpm marked as tc in figures 2 fuzzy logic guidance method marked as fuzzy in figures pearson et al 2014 3 multiple interval chebyshev pseudospectral method marked as pm in figures mao et al 2021 each problem is solved using the fmincon solver with the sqp algorithm the optimization options of fmincon are set as maxfunevals inf optimalitytolerance 10 4 and steptolerance 10 2 in case 1 the auv s initial conditions are set as follows x 0 250 m y 0 0 m z 0 5 m ϕ 0 0 r a d θ 0 0 r a d ψ 0 π r a d u 0 0 1 m s v 0 0 m s w 0 0 m s p 0 0 r a d s q 0 0 r a d s r 0 0 r a d s the upper bounds of control inputs are τ u 40 n δ s 24 and δ r 24 the parameters used in tcbtpm are as follows u d 1 m s u r 1 5 m s d 1 50 m d 2 20 m d 3 5 m k 1 8 k 2 8 k 3 10 k 4 8 k 5 10 different turning radiuses and turning periods correspond to the four different rudder angles in the turning circle trial are chosen and the simulation results of planned trajectory and vehicle actual trajectory are shown in fig 9 the larger the rudder angle is the smaller the turning radius and turning period are in the turning circle trial besides the smaller the turning radius and turning period chosen in the trajectory planning the closer the starting point of the planned trajectory is to the mds and the worse the performance of trajectory tracking is because more of the maximum rudder angle is used in the turning motion and less of the maximum rudder angle is left to be controlled the distance between auv and mds and the position error x e y e z e are displayed in fig 10 theoretically the smaller the turning radius and turning period chosen in the trajectory planning the earlier the mobile docking mission will be completed however the actual results fell short of expectations since it puts too much pressure on the controller when we choose the turning radius and turning period which correspond to the maximum rudder angle of 24 in the turning circle trial in case 2 three scenarios where auv start from different initial positions are as follows scenario 1 the auv s initial conditions are set as follows x 0 250 m y 0 50 m z 0 5 m ϕ 0 0 r a d θ 0 0 r a d ψ 0 π r a d u 0 0 1 m s v 0 0 m s w 0 0 m s p 0 0 r a d s q 0 0 r a d s r 0 0 r a d s the parameters used in tcbtpm are as follows u d 1 m s u r 1 5 m s d 1 50 m d 2 20 m d 3 5 m r 15 9 m t 66 6 s k 1 8 k 2 8 k 3 10 k 4 8 k 5 10 scenario 2 the auv s initial conditions are set as follows x 0 250 m y 0 300 m z 0 5 m ϕ 0 0 r a d θ 0 0 r a d ψ 0 π r a d u 0 0 1 m s v 0 0 m s w 0 0 m s p 0 0 r a d s q 0 0 r a d s r 0 0 r a d s the parameters used in tcbtpm are as follows u d 1 m s u r 1 5 m s d 1 50 m d 2 20 m d 3 5 m r 19 78 m t 82 8 s k 1 8 k 2 8 k 3 10 k 4 8 k 5 10 the ocean current disturbances are set as v c 0 2 m s ψ c π 4 r a d scenario 3 the auv s initial conditions are set as follows x 0 50 m y 0 100 m z 0 5 m ϕ 0 0 r a d θ 0 0 r a d ψ 0 π 4 r a d u 0 0 1 m s v 0 0 m s w 0 0 m s p 0 0 r a d s q 0 0 r a d s r 0 0 r a d s the parameters used in tcbtpm are as follows u d 1 m s u r 1 5 m s d 1 50 m d 2 20 m d 3 5 m r 13 31 m t 55 8 s k 1 8 k 2 8 k 3 10 k 4 8 k 5 10 the ocean current disturbances are set as v c 0 2 m s ψ c 3 π 4 r a d the simulation results of the three scenarios are shown in figs 11 22 according to the guidance system proposed here for the scenario 1 and scenario 2 auv is guided by pp guidance law at first and then tracks the planned trajectory which is generated by tcbtpm finally auv completes the mobile docking mission guided by los guidance law for the scenario 3 auv tracks the planned trajectory at first which is generated by tcbtpm and then completes the mobile docking mission guided by los guidance law the parameters of tcbtpm are the turning radius r and turning period t which can be obtained by the horizontal turning circle trial the simulation results when different parameters are chosen in tcbtpm are shown in table 2 the smaller the turning radius r and turning period t chosen in the trajectory planning the less of theoretical time t c that auv takes to reach the position which is d 3 meters directly behind mds along the planned trajectory however there are some gaps between the actual tracking results and the theory according to the total time of successful docking t e in table 2 it s easy to see that ocean current only has a great influence on the circular arc trajectory tracking of auv so the turning radius r and turning period t should be chosen a little larger such as the parameters which correspond to δ r 20 in the turning circle trial when there is a big difference between the heading angle of auv and that of mds if there exists ocean current at the same time then the turning radius r and turning period t should be chosen much larger such as the parameters which correspond to δ r 15 in the turning circle trial as can be seen auv can enter into mds guided by all three guidance methods but it takes more time for auv when it is guided by fuzzy logic guidance method to complete mobile docking mission because fuzzy logic guidance method can t take mds s movement into consideration and only gives guidance commands based on the current position of mds the further away the auv s starting position is from the mds and the faster mds moves the more time the auv wastes in the mobile docking mission multiple interval chebyshev pseudospectral method is a direct solution of nonlinear optimal control problem although the simulation results of multiple interval chebyshev pseudospectral method and tcbtpm are similar the computing time of multiple interval chebyshev pseudospectral method more than 100 s in all three scenarios is too long to be used in practice besides it could happen that auv has deviated far from the planned trajectory when the calculation of multiple interval chebyshev pseudospectral method is finished and the planned trajectory is no longer optimal compared with multiple interval chebyshev pseudospectral method tcbtpm is simpler and the results are reasonable 5 conclusions in this work tcbtpm is proposed to predict the relative position of auv and the mobile docking station in advance and generate a feasible trajectory for the mobile docking mission besides a mobile docking guidance system containing tcbtpm pp guidance law and los guidance law is employed to generate desired guidance commands and guide the underactuated auv to dock efficiently and reliably what s more according to the simulation and comparative analysis conclusions can be drawn that tcbtpm is simpler than multiple interval chebyshev pseudospectral method and the results are reasonable however mds is assumed to do a uniform linear motion here so other situation where mds moves along a rectangular or circular trajectory will be studied and the mobile docking experiments will be conducted to demonstrate the effectiveness of the guidance system proposed here in the near future funding this work is supported by national key research and development program of china no 2017yfc0305700 national natural science foundation of china no 51879057 no u1806228 and no 51809064 fundamental research funds for the central universities no 3072019cfj0103 open funds of laboratory of science and technology on marine navigation and control 2020010301 and open funds of science and technology on underwater vehicles laboratory 6142215190110 credit authorship contribution statement tianqi xie conceptualization methodology formal analysis data curation writing original draft writing review editing supervision ye li conceptualization project administration validation supervision funding acquisition yanqing jiang conceptualization supervision validation funding acquisition shuo pang data curation formal analysis writing original draft haowei wu software validation visualization declaration of competing interest we declare that we have no financial and personal relationships with other people or organizations that can inappropriately influence our work there is no professional or other personal interest of any nature or kind in any product service and or company that could be construed as influencing the position presented in or the review of the manuscript entitled turning circle based trajectory planning method of an underactuated auv for the mobile docking mission 
20414,in this paper a turning circle based trajectory planning method tcbtpm is proposed to conduct trajectory planning of an underactuated autonomous underwater vehicle auv for mobile docking mission firstly the six degrees of freedom kinematics and dynamics model of underactuated auv is acquired following this the simulation of horizontal turning circle trial is studied and the overview of mobile docking mission is introduced furthermore tcbtpm is used to predict the relative position of auv and the mobile docking station mds in advance and generate a feasible trajectory for the mobile docking mission finally a mobile docking guidance system containing tcbtpm pure pursuit pp guidance law and line of sight los guidance law is employed to obtain desired guidance commands and guides the underactuated auv to dock efficiently and reliably keywords trajectory planning turning circle underwater mobile docking underactuated auv 1 introduction autonomous underwater vehicles auvs are widely used in underwater survey mineral exploration and oceanographic mapping li et al 2009 the need of auvs has become increasingly apparent and the research on auvs has been absorbing significant attention of researchers yazdani et al 2020 automated underwater docking technology is a research focus because it is useful for the underwater recycling of auvs and can greatly reduce manual operation besides auvs can charge automatically at any time which is an alternative solution to improve auvs mission endurance since the operational endurance of auvs is limited by their battery capacity what s more auvs can transfer at high speed the vast amounts of data with the help of automated underwater docking technology compared to the fixed docking technology mobile docking has more flexibility for example an unmanned surface vehicle usv can be a support and delivery platform for auvs and they will collaborate on more complex tasks lots of theoretical research and experiments on underwater docking raspante 2012 li et al 2015 yang et al 2016 sans muntadas et al 2016 sarda and dhanak 2018 palomeras et al 2018 liu et al 2019 are being carried out because auv underwater docking technology is of great research significance and practical value a reliable vision positioning method using two cameras is introduced which switches between combining monocular and binocular positioning method according to the image number of mark points in both cameras and underwater docking experiments are conducted to prove that auv can enter into fixed funnel shaped docking station at different start point li et al 2015 two complementary and cost effective localization systems have been developed and auv can complete the docking maneuver with low cost equipment and minimal requirements on both the vehicle and the docking station sides palomeras et al 2018 an automated launch and recovery system lars has been designed which enables two alternatives using either a mobile or station keeping usv to launch and recover an auv and the sea trials have demonstrated that a station keeping usv can be utilized to launch and recover an auv autonomously sarda and dhanak 2018 a vision based framework has been proposed for automatically recovering an auv by another auv in shallow water and the field experiments have validated that the proposed visual navigation method is reliable liu et al 2019 on the other hand considering reducing the actuator cost vehicle weight and energy consumption or increasing the reliability of the system due to actuator failure most of auvs use rudders and elevators to control yaw and pitch instead of thrusters repoulias and papadopoulos 2007 there is a deviation between heading and course of the underactuated auv which is caused by the effect of ocean currents and can induce some serious collisions therefore in order to make the vehicle s position attitude and approach velocity satisfy those of the docking station during the terminal docking phase the guidance and control laws are a research focus too sans muntadas et al 2016 park et al 2011 auv guidance system is an essential part of the underwater docking mission and it produces feasible and applicable guidance commands that would enable an underactuated auv to home and dock efficiently and reliably besides the guidance system needs to take both the limitations of the vehicle s actuators and environmental constraints into account the problem of docking trajectory generation for auvs is usually considered as an optimal control problem with constraints and its numerical solutions can be categorized into two major branches rao 2014 the first one is indirect solutions which use pontryagin s maximum principle to construct the first order necessary conditions and then convert an optimal control problem into a hamiltonian boundary value problem yazdani et al 2020 the second branch is direct solutions which transcribe the continuous optimal control problem into a nonlinear programming problem by parameterizing states and or controls yazdani et al 2016 2017 the major concern is these methods may not work in real time applications because they require a lot of computational resources in addition a useful guidance method is based on fuzzy inference system teo et al 2012 2015 2015 pearson et al 2014 which can provide the desired heading and speed commands for auv to complete docking mission and the sea trials have demonstrated the effectiveness of the implemented guidance algorithms in the fixed docking mission however this approach will waste a lot of time in mobile docking mission because fuzzy logic guidance method can t take the movement of mobile docking station mds into consideration and only gives guidance commands based on the current position of mds based on the above analysis the turning circle based trajectory planning method tcbtpm is proposed here the planned trajectory is a combination of turning circular arcs and line segments auv s maximum speed and its turning ability can be measured by simulation or field experiments then auv s position can be calculated at any time when it moves along the planned trajectory if mds does a uniform linear motion the relative position of auv and the mds can be predicted in advance and it is easy to generate a feasible trajectory for auv s mobile docking mission the proposed trajectory planning method can also estimate the position and time of successful docking and be able to guide auv to complete turning motion in advance so that the auv has the same heading as the mds and docks from behind when underactuated auv moves in opposite direction to the mds besides a mobile docking guidance system containing tcbtpm pure pursuit pp guidance law and line of sight los guidance law is used to generate desired surge velocity yaw angle pitch angle and guides the underactuated auv to dock efficiently and reliably what s more this method has low computational burden and is suitable for real time applications the rest of this paper is organized as follows the mathematical model of an underactuated auv system is presented in section 2 in section 3 a mobile docking guidance system containing tcbtpm pp guidance law and los guidance law is used to generate desired surge velocity yaw angle pitch angle and guide the underactuated auv to dock efficiently and reliably the simulation and analysis are provided in section 4 finally some conclusions of this paper are brought forward in section 5 2 auv modeling this section presents the six degrees of freedom kinematics and dynamics model of an underactuated auv we define the earth fixed coordinate system i and the body fixed coordinate system b of the auv as shown in fig 1 where x y and z represent the inertial coordinates of the vehicle in the earth fixed frame u v w are the surge sway and heave velocities respectively defined in the body fixed frame p q and r represent roll angular velocity pitch angular velocity and yaw angular velocity ϕ θ and ψ are roll angle pitch angle and yaw angle the six degrees of freedom kinematics equations can be written as fossen 1994 xu et al 2013 1a x u cos ψ cos θ v cos ψ sin θ sin ϕ sin ψ cos ϕ w cos ψ sin θ sin ϕ sin ψ sin ϕ 1b y u sin ψ cos θ v sin ψ sin θ sin ϕ cos ψ cos ϕ w sin ψ sin θ cos ϕ cos ψ sin ϕ 1c z u sin θ v cos θ sin ϕ w cos θ cos ϕ 1d ϕ p q sin ϕ tan θ r cos ϕ tan θ 1e θ q cos ϕ r sin ϕ 1f ψ q sin ϕ r cos ϕ cos θ the dynamics equations of underactuated auv are 2a m u v r w q x g q 2 r 2 y g p q r z g p r q x h x g τ u 2b m v w p u r y g r 2 p 2 z g q r p x g q p r y h y g 2c m w u q v p z g p 2 q 2 x g r p q y g r q p z h z g 2d i x p i z i y q r m y g w p v q u z g v u r w p k h k g 2e i y q i x i z r p m z g u w p v r x g w p v u q m h m g m u u δ s u 2 δ s 2f i z r i y i z p q m x g v u r p w y g u q w v r n h n g n u u δ r u 2 δ r and 3a x h x q q q 2 x r r r 2 x r p r p x u u x v r v r x w q w q x u u u 2 x v v v 2 x w w w 2 3b y h y r r y p p y p p p p y p q p q y q r q r y v v y v q v q y w p w p y w r w r y r u r y p u p y v r v v v 2 w 2 1 2 r y 0 u 2 y v u v y v v v v v 2 w 2 1 2 y v w v w 3c z h z q q z p p p 2 z r r r 2 z r p r p z w w z v r v r z v p v p z q u q z w q w w v 2 w 2 1 2 q z 0 u 2 z w u w z w w w v 2 w 2 1 2 z w u w z w w w v 2 w 2 1 2 z v v v 2 3d k h k p p k r r k q r q r k p q p q k p p p p k p u p k r u r k v v k v q v q k w p w p k w r w r k 0 u 2 k v u v k v v v v 2 w 2 1 2 k v w v w 3e m h m q q m p p p 2 m r r r 2 m q q q q m w w m v r v r m v p v p m q u q m w q v 2 w 2 1 2 q m 0 u 2 m w u w m w w w v 2 w 2 1 2 m w u w m w w w v 2 w 2 1 2 m v v v 2 3f n h n r r n p p n p q p q n q r q r n r r r r n v v n w r w r n w p w p n v q v q n p u p n r u r n v r v 2 w 2 1 2 r n 0 u 2 n v u v n v v v v 2 w 2 1 2 n v w v w the vehicle experiences hydrostatic forces and moments as a result of the combined effects of the vehicle weight w and buoyancy b the equations of hydrostatic forces and moments are written as 4a x g w b sin θ 4b y g w b cos θ sin ϕ 4c z g w b cos θ cos ϕ 4d k g y g w y b b cos θ cos ϕ z g w z b b cos θ sin ϕ 4e m g z g w z b b sin θ x g w x b b cos θ cos ϕ 4f n g x g w x b b cos θ sin ϕ y g w y b b sin θ where m is the mass of the vehicle i x i y and i z are the moments of inertia x q q etc are the hydrodynamic coefficients x g y g and z g are the coordinates of the center of gravity x b y b and z b are the coordinates of the center of buoyancy the surge force τ u elevator angle δ s and rudder angle δ r are considered as the available control inputs assumption the underactuated auv s available control inputs are bounded i e τ u τ u δ s δ s and δ r δ r where τ u δ s and δ r are the known upper bounds 3 mobile docking guidance system in this section a mobile docking guidance system containing tcbtpm pp guidance law and los guidance law is used to generate desired surge velocity u d desired yaw angle ψ d and desired pitch angle θ d that enable an underactuated auv to dock efficiently and reliably 3 1 simulation of horizontal turning circle trial this trial is mainly used to calculate the vehicle s steady turning radius and to check how well the steering machine performs under course changing maneuvers fossen 1994 the simulations are conducted by turning the auv over at a constant speed and with a constant rudder angle fig 2 shows the trajectories of the auv gravity center in the horizontal plane and table 1 gives the turning radiuses and the turning periods under different rudder angles but the same speed as can be seen the minimum turning radius is about 13 31 m at a specific speed of 1 5 m s and with a rudder angle of maximum 24 3 2 mobile docking guidance system the overview of mobile docking mission is shown in fig 3 assuming that mds does a uniform linear motion at a speed of u d which is carried by the mother vessel and auv approaches the mds at a maximum speed of u r u r u d auv can sense the position of mds using the ultrashort baseline acoustic position system usbl and cameras if the auv is captured successfully it will be towed by the mds with its propeller stopped and will maintain a surge velocity which will be the same as the mds if not mds s heading can be estimated by using the measurements of usbl doppler velocity log dvl and dead reckoning zhou et al 2018 we establish mds fixed reference frame x o y on the position of mds that x axis goes along mds s heading and the relative position errors x e y e z e between the auv and mds can be calculated then the desired surge velocity u d yaw angle ψ d and pitch angle θ d can be obtained by the guidance system finally auv is controlled automatically by the controller and the actuators to approach the mds from behind and complete the mobile docking mission tcbtpm is proposed to estimate the position and time of successful docking and the complete process of the mobile docking guidance system fig 4 is shown as follows step 1 as seen in fig 5 the docking region is divided into two sections in the horizontal plane initialize all kinds of parameters d 1 d 2 d 3 k 1 k 2 k 3 k 4 k 5 b 0 and choose the turning radius r the turning period t for trajectory planning and the angular velocity of turning motion can be calculated by ω 2 π t step 2 calculate the relative position errors x e y e z e between auv and mds if the mobile docking mission is completed go to step 11 otherwise go to step 3 step 3 the desired pitch angle is calculated by the equation θ d arctan z e k 1 step 4 first determine whether b is 0 if it is not equal to 0 then go to step 7 for control according to the planned trajectory and los guidance law if equal to 0 then go to step 5 step 5 determine which section the auv is in if auv is in section 1 los guidance law is adopted and the desired yaw angle and the desired surge velocity are calculated by equations 5 and 6 and go to step 10 5 ψ d arctan y e k 2 arctan v u 6 u d u r x e 0 y e 1 z e 1 u d x e d 3 k 3 e l s e where d 3 is considered as the safe distance if auv is in section 2 first determine whether x e is greater than or equal to 0 if so calculate the angle a 1 between the x axis of the mds fixed reference frame and the straight line which connects auv and mds and then go to step 6 otherwise one case of tcbtpm is shown in fig 6 where mds is at point o and auv is at point a in this case the planned trajectory is a combination of a circular arc and a line segment besides auv s theoretical traveling time t t o t a l on the planned trajectory and the angle a are the solution of equations 7 and 8 then assign b a non zero value and call the current mds fixed reference frame x o y as x o y record the current time t 1 t the theoretical time t 2 t 3 when auv reaches b c along the planned trajectory and go to step 7 7 t t o t a l a ω u r cos a r sin a u d t t o t a l d 3 x e 8 t t o t a l a ω u r sin a r 1 cos a y e step 6 the remaining two cases of tcbtpm are shown in figs 7 and 8 where mds is at point o and auv is at point a the second one is shown in fig 7 when y e r cos a 1 r the planned trajectory is a combination of two circular arcs and a line segment in this case the circle o 1 is tangent to the straight line o a at point a the circle o 2 is tangent to the x axis at point d and the line segment b c is parallel to the y axis and is tangent to both circle o 1 and circle o 2 it s easy to know that a 2 π 2 a 1 and calculate auv s theoretical traveling time t t o t a l on the planned trajectory if the condition x e d 3 is satisfied when the auv reaches the x axis along the planned trajectory it is considered that the auv will not collide with the mds and the trajectory planning is considered to be successful then assign b a non zero value and call the current mds fixed reference frame x o y as x o y record the current time t 1 t and the theoretical time t 2 t 3 t 4 when auv reaches b c d along the planned trajectory assign s i g based on equation 9 and go to step 7 if the condition x e d 3 is not satisfied the trajectory planning is considered to be unsuccessful and then go to step 9 the third case is shown in fig 8 when y e r cos a 1 r the trajectory of turning motion is a combination of two circular arcs in this case the circle o 1 is tangent to the straight line o a at point a the circle o 2 o 2 is tangent to both the x axis and circle o 1 it s easy to know that a 2 arccos o 1 d o 1 o 2 and calculate auv s theoretical traveling time t t o t a l on the planned trajectory when a 2 a 1 the planned trajectory is the arc a b c when a 2 a 1 the planned trajectory is the arc a b c if the condition x e d 3 t t o t a l t is satisfied when the auv reaches the x axis along the planned trajectory it is considered that the auv will not collide with the mds and the trajectory planning is considered to be successful then assign b a non zero value and call the current mds fixed reference frame x o y as x o y record the current time t 1 t and theoretical time t 3 when auv reaches b b c c along the planned trajectory assign s i g based on equation 9 and go to step 7 if the condition x e d 3 t t o t a l t is not satisfied the trajectory planning is considered to be unsuccessful and then go to step 9 9 s i g 1 y e 0 1 y e 0 step 7 if the actual time of auv traveling on the planned trajectory is greater than the theoretical traveling time t t o t a l on th t 2 e planned trajectory that means t t 1 t t o t a l or the condition x e d 3 is satisfied let b 0 and then go to step 8 step 8 the desired surge velocity u d yaw angle ψ d is calculated according to the planned trajectory which is generated by tcbtpm x o i y o i are defined as the center coordinate of turning circle o 1 and o 2 in the reference frame x o y φ 0 i denotes the angle between the x axis and the vector that points from center of the circle to the starting point of each circular arc t 0 i is the time when the auv starts from the starting point of each circular arc the coordinate of desired position in circular trajectory can be obtained as follows 10 x d x o i r cos ω t t 0 i φ 0 i y d y o i r sin ω t t 0 i φ 0 i where ω ω corresponds to anti clockwise motion and ω ω corresponds to clockwise motion the coordinate of desired position in straight trajectory can be obtained as follows 11 x d x o 1 r y d y o 1 s i g u r t t 2 consider a path fixed reference frame with origin at x d y d and the x axis of this reference frame is tangent to the circle or goes along the straight line when auv tracks the circular trajectory the x axis of this reference frame has been rotated a angle relative to the x axis of the reference frame x o y 12 ψ d 0 d x d y 0 π 2 d x 0 d y 0 π 2 d x 0 d y 0 arctan d y d x d x 0 arctan d y d x π d y 0 where 13 d x ω r sin ω t t 0 i φ 0 i d y ω r cos ω t t 0 i φ 0 i when auv tracks the straight trajectory ψ d s i g π 2 the trajectory tracking errors are defined as 14 s x e u d t t 1 x d cos ψ d y e y d sin ψ d e x e u d t t 1 x d sin ψ d y e y d cos ψ d the los guidance law fossen et al 2015 is adopted and go to step 10 15 ψ d ψ d arctan e k 4 arctan v u 16 u d u r s k 5 step 9 the pp guidance law fossen 2011 is adopted and the desired yaw angle and the desired surge velocity are calculated by equations 17 and 18 17 ψ d 0 x e y e 0 π 2 x e 0 y e 0 π 2 x e 0 y e 0 arctan y e x e x e 0 arctan y e x e π x e 0 18 u d u r step 10 auv is controlled based on the desired surge velocity u d yaw angle ψ d pitch angle θ d and go back to step 2 for the planning and control of next time step step 11 auv is towed by the mds with its propeller stopped 4 simulation and discussion this section presents the trajectory generated by tcbtpm is feasible and s plane controller sun et al 2011 is employed to control surge velocity yaw angle and pitch angle the mds s trajectory is given as follows 19 ξ d u d t m η d 0 m ζ d 10 m all simulation cases are studied in matlab r2019b on a personal computer equipped with an intel core i5 9300hf processor 2 4 ghz cpu and 8 gb ram in the environment of windows 10 and the following two cases are considered case 1 trajectory planning using different turning radiuses and turning periods case 2 the following three guidance methods are compared 1 tcbtpm marked as tc in figures 2 fuzzy logic guidance method marked as fuzzy in figures pearson et al 2014 3 multiple interval chebyshev pseudospectral method marked as pm in figures mao et al 2021 each problem is solved using the fmincon solver with the sqp algorithm the optimization options of fmincon are set as maxfunevals inf optimalitytolerance 10 4 and steptolerance 10 2 in case 1 the auv s initial conditions are set as follows x 0 250 m y 0 0 m z 0 5 m ϕ 0 0 r a d θ 0 0 r a d ψ 0 π r a d u 0 0 1 m s v 0 0 m s w 0 0 m s p 0 0 r a d s q 0 0 r a d s r 0 0 r a d s the upper bounds of control inputs are τ u 40 n δ s 24 and δ r 24 the parameters used in tcbtpm are as follows u d 1 m s u r 1 5 m s d 1 50 m d 2 20 m d 3 5 m k 1 8 k 2 8 k 3 10 k 4 8 k 5 10 different turning radiuses and turning periods correspond to the four different rudder angles in the turning circle trial are chosen and the simulation results of planned trajectory and vehicle actual trajectory are shown in fig 9 the larger the rudder angle is the smaller the turning radius and turning period are in the turning circle trial besides the smaller the turning radius and turning period chosen in the trajectory planning the closer the starting point of the planned trajectory is to the mds and the worse the performance of trajectory tracking is because more of the maximum rudder angle is used in the turning motion and less of the maximum rudder angle is left to be controlled the distance between auv and mds and the position error x e y e z e are displayed in fig 10 theoretically the smaller the turning radius and turning period chosen in the trajectory planning the earlier the mobile docking mission will be completed however the actual results fell short of expectations since it puts too much pressure on the controller when we choose the turning radius and turning period which correspond to the maximum rudder angle of 24 in the turning circle trial in case 2 three scenarios where auv start from different initial positions are as follows scenario 1 the auv s initial conditions are set as follows x 0 250 m y 0 50 m z 0 5 m ϕ 0 0 r a d θ 0 0 r a d ψ 0 π r a d u 0 0 1 m s v 0 0 m s w 0 0 m s p 0 0 r a d s q 0 0 r a d s r 0 0 r a d s the parameters used in tcbtpm are as follows u d 1 m s u r 1 5 m s d 1 50 m d 2 20 m d 3 5 m r 15 9 m t 66 6 s k 1 8 k 2 8 k 3 10 k 4 8 k 5 10 scenario 2 the auv s initial conditions are set as follows x 0 250 m y 0 300 m z 0 5 m ϕ 0 0 r a d θ 0 0 r a d ψ 0 π r a d u 0 0 1 m s v 0 0 m s w 0 0 m s p 0 0 r a d s q 0 0 r a d s r 0 0 r a d s the parameters used in tcbtpm are as follows u d 1 m s u r 1 5 m s d 1 50 m d 2 20 m d 3 5 m r 19 78 m t 82 8 s k 1 8 k 2 8 k 3 10 k 4 8 k 5 10 the ocean current disturbances are set as v c 0 2 m s ψ c π 4 r a d scenario 3 the auv s initial conditions are set as follows x 0 50 m y 0 100 m z 0 5 m ϕ 0 0 r a d θ 0 0 r a d ψ 0 π 4 r a d u 0 0 1 m s v 0 0 m s w 0 0 m s p 0 0 r a d s q 0 0 r a d s r 0 0 r a d s the parameters used in tcbtpm are as follows u d 1 m s u r 1 5 m s d 1 50 m d 2 20 m d 3 5 m r 13 31 m t 55 8 s k 1 8 k 2 8 k 3 10 k 4 8 k 5 10 the ocean current disturbances are set as v c 0 2 m s ψ c 3 π 4 r a d the simulation results of the three scenarios are shown in figs 11 22 according to the guidance system proposed here for the scenario 1 and scenario 2 auv is guided by pp guidance law at first and then tracks the planned trajectory which is generated by tcbtpm finally auv completes the mobile docking mission guided by los guidance law for the scenario 3 auv tracks the planned trajectory at first which is generated by tcbtpm and then completes the mobile docking mission guided by los guidance law the parameters of tcbtpm are the turning radius r and turning period t which can be obtained by the horizontal turning circle trial the simulation results when different parameters are chosen in tcbtpm are shown in table 2 the smaller the turning radius r and turning period t chosen in the trajectory planning the less of theoretical time t c that auv takes to reach the position which is d 3 meters directly behind mds along the planned trajectory however there are some gaps between the actual tracking results and the theory according to the total time of successful docking t e in table 2 it s easy to see that ocean current only has a great influence on the circular arc trajectory tracking of auv so the turning radius r and turning period t should be chosen a little larger such as the parameters which correspond to δ r 20 in the turning circle trial when there is a big difference between the heading angle of auv and that of mds if there exists ocean current at the same time then the turning radius r and turning period t should be chosen much larger such as the parameters which correspond to δ r 15 in the turning circle trial as can be seen auv can enter into mds guided by all three guidance methods but it takes more time for auv when it is guided by fuzzy logic guidance method to complete mobile docking mission because fuzzy logic guidance method can t take mds s movement into consideration and only gives guidance commands based on the current position of mds the further away the auv s starting position is from the mds and the faster mds moves the more time the auv wastes in the mobile docking mission multiple interval chebyshev pseudospectral method is a direct solution of nonlinear optimal control problem although the simulation results of multiple interval chebyshev pseudospectral method and tcbtpm are similar the computing time of multiple interval chebyshev pseudospectral method more than 100 s in all three scenarios is too long to be used in practice besides it could happen that auv has deviated far from the planned trajectory when the calculation of multiple interval chebyshev pseudospectral method is finished and the planned trajectory is no longer optimal compared with multiple interval chebyshev pseudospectral method tcbtpm is simpler and the results are reasonable 5 conclusions in this work tcbtpm is proposed to predict the relative position of auv and the mobile docking station in advance and generate a feasible trajectory for the mobile docking mission besides a mobile docking guidance system containing tcbtpm pp guidance law and los guidance law is employed to generate desired guidance commands and guide the underactuated auv to dock efficiently and reliably what s more according to the simulation and comparative analysis conclusions can be drawn that tcbtpm is simpler than multiple interval chebyshev pseudospectral method and the results are reasonable however mds is assumed to do a uniform linear motion here so other situation where mds moves along a rectangular or circular trajectory will be studied and the mobile docking experiments will be conducted to demonstrate the effectiveness of the guidance system proposed here in the near future funding this work is supported by national key research and development program of china no 2017yfc0305700 national natural science foundation of china no 51879057 no u1806228 and no 51809064 fundamental research funds for the central universities no 3072019cfj0103 open funds of laboratory of science and technology on marine navigation and control 2020010301 and open funds of science and technology on underwater vehicles laboratory 6142215190110 credit authorship contribution statement tianqi xie conceptualization methodology formal analysis data curation writing original draft writing review editing supervision ye li conceptualization project administration validation supervision funding acquisition yanqing jiang conceptualization supervision validation funding acquisition shuo pang data curation formal analysis writing original draft haowei wu software validation visualization declaration of competing interest we declare that we have no financial and personal relationships with other people or organizations that can inappropriately influence our work there is no professional or other personal interest of any nature or kind in any product service and or company that could be construed as influencing the position presented in or the review of the manuscript entitled turning circle based trajectory planning method of an underactuated auv for the mobile docking mission 
