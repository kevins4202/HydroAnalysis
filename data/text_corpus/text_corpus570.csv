index,text
2850,this paper considers the influence of geometry and flow conditions on the relative permeability of wetting and non wetting components of multiphase flows through fractures using an explicit immiscible two phase fracture flow model 945 multiphase flow simulations were conducted on artificially generated fracture geometries these simulations accounted for the effects of initial fracture roughness confining stress pressure gradient surface tension and volume fraction on the fracture flow time averaged relative permeabilities were recorded for both the wetting and non wetting phases in each of the simulations the simulation results demonstrate that relative permeability curves are strongly influenced by contact area fracture morphology and competition between viscous and capillary forces increasing the normal stress creates more contact in the fracture plane which increases interference between the fluid phases the effect is more pronounced in fractures with strongly correlated apertures where the chance of fluid trapping is increased the relative importance of viscous forces compared to capillary forces was investigated by applying different pressure gradients to the fluids increasing the pressure gradient tends to cause the flow paths to segregate and the relative permeability curves approach the linear model in agreement with experimental results from these observations two new relative permeability models were introduced to describe the behavior of wetting and non wetting phases in fractures the performance of the new models were compared to other published relative permeability models for fracture geometries the new models were found to more accurately predict the relative permeability when compared to the other available models for both the wetting and non wetting phases keywords multiphase flow relative permeability fracture flow data availability data will be made available on request 1 introduction predicting multiphase flow through fractures is of great importance in many subsurface engineering applications such as oil and gas production geological storage of carbon dioxide or nuclear wastes seepage control of rock slopes exploitation of geothermal energy and compact heat exchangers mahmoodi et al 2020 chen et al 2020 liu et al 2021 phillips et al 2020 however the macroscopic models used to describe multiphase flows in fractures have been largely derived from those used in porous media with the assumption that multiphase flows behave in the same way in pores and fracture apertures despite the change in geometry sheng et al 2019 wong et al 2008 nevertheless the two dimensional nature of fracture flows makes them distinct from flows in porous media da silva et al 2019 for example in porous media it is quite common for both phases to flow simultaneously as multiple percolating pathways can be supported in three dimensions however in two dimensions this is only possible if both phases flow in parallel or if there is interference between the phases watanabe et al 2015 huo and benson 2016 thus it is worthwhile examining the development of flow pathways in fractures and the effect of fluids intervention on their hydraulic properties multiphase flows in porous and fractured media are governed by the relative saturation of the wetting and non wetting phases naik et al 2021 ni et al 2021 wetting fluids tend to occupy the smaller pores due to higher capillary forces while the non wetting fluid fills the larger pores causing the interference of each phase on the flow of the other zhao et al 2020 the level of interference is governed by the capillary pressure produced at the fluid interface which is more significant in small pores zou et al 2020 relative permeability has been introduced to quantify the degree of interference defined as the ratio of the effective permeability of each phase to the absolute permeability of the medium i e the permeability for single phase flows 1 k r k i k where k r is the relative permeability of phase i k i is the effective permeability of phase i and k is the absolute permeability of the medium i e the permeability for single phase flows while permeability is a function of geometry alone independent of fluid properties mourzenko et al 2018 this is not the case for effective permeability in particular if fluid interference occurs it must necessarily be a function of the mixed fluid s constitutive properties its surface tension and viscosity and the properties of the flow the applied pressure gradient this fact is often overlooked in models of relative permeability for three dimensional flows as the two fluids can find percolating pathways that allow both fluids to flow simultaneously without interference however the same is not true of two dimensional fluid flows watanabe et al 2015 yang et al 2013 initial experimental studies on two phase flow in fractures by romm 1972 suggested that relative permeability for each phase is a linear function of its saturation indicating that neither phases interfered with the flow of the other nevertheless later experimental works demonstrated deviation from the linear model proposed by romm pieters and graves 1994 pan et al 1996 diomampo et al 2001 fourar and lenormand 1998 introduced a viscous coupling model based on the assumption that the complexity of the fluids interaction can be modeled by the theory of viscous coupling between fluids which had already been applied in porous media using this model they could successfully capture the deviation of the experimental data from the linear model two phase gas liquid flow experiments were performed by chen et al 2004 between parallel plates to quantify the effect of the flow patterns on the relative permeabilities based on the liquid and gas superficial velocities four flow regimes were identified bubble flow slug flow unstable channel flow and channel flow they defined two tortuosity parameters for gas and liquid based on their flow structures to rectify the deviation of the experimental data from the x model in a similar study conducted by wong et al 2008 it was shown that for the channel flow regime where both phase are continuous the relative permeability curves follow the x model while for the dispersed and mix flow regimes where one of the phases are discontinuous there is a non linear relationship between relative permeability and saturation using the van genuchten mualem model mualem 1976 for capillary pressure in porous media sheng et al 2019 derived an analytical expressions for two phase relative permeability in fractures it was demonstrated that the final form of the relative permeability in fractures is similar to that of van genuchten mualem relative permeability model in porous media the validity of the model was proved against liquid gas experimental data multiphase fracture flow processes are restricted to a roughly planar geometry hence the flow properties are primarily governed by the fracture s aperture distribution a normal or shear stress on the fracture plane will deform the fracture geometry and change the fracture s hydraulic properties mourzenko et al 1997 including the relative permeability saturation relations liu et al 2013 studied the effect of the normal stress on the two phase flow properties in fractures they proposed constitutive relationships between relative permeability capillary pressure and saturation for deformable horizontal fractures based on a two part hook s model in this model the fracture apertures are divided into soft and hard part with the hard part is subjected to a lower deformation and the hook s law with different strain values is applied on each part separately the validity of these relationships were shown by their consistency with the experimental data a physical model was introduced by li et al 2014 to estimate capillary pressure and relative permeability for rough walled fractures subjected to normal and shear stresses in this model the relative permeability of each phase is the cubic ratio between the representative mean of apertures occupied by that phase and the total representative mean aperture obtained from a strain dependent physical model laboratory experiments were performed by huo and benson 2016 to measure the relative permeability of nitrogen water system at two normal stress conditions of 2 07 mpa and 5 52 mpa the results demonstrated that at higher stress the phase interference increases and the flow becomes more viscous dominated watanabe et al 2015 studied two phase flow in fractures at different combinations of mean fracture aperture wettability condition and confining stress they showed that at higher aperture and contact angles near 90 where the capillary pressure is negligible the relative permeability curves follow the x model however for the conditions under the influence of capillarity they indicated that the corey model can describe the wetting phase relative permeability curve while for the non wetting phase they proposed a new ν type model ye et al 2017 developed constitutive relationships between relative permeability and saturation based on the simulations of two phase flow under normal deformation conditions they showed high sensitivity of the relative permeability to spacial correlation of aperture distribution and normal stress many of the above studies were conducted on a limited number of fractures with idealized geometries moreover the effect of fracture morphology and flow conditions on the relative permeability behavior were not discussed in detail table 1 presents relative permeability models used in fractures for both wetting and non wetting phases apart from the x model most of the models like the brooks corey model brooks and corey 1966 or the van genuchten mualem model mualem 1976 have been originally developed for porous media or derived based on an analogy between porous medial and fractures here we perform immiscible two phase flow simulations in fractures to study the effect of fracture geometry normal stress and the competition between the viscous and capillary forces on the wetting and non wetting relative permeability curves then we introduce a simple model to predict the relative permeability in fractures and compare its performance with the available models the remainder of this study is organized as follow section 2 is dedicated to description of the methodology to generate the synthetic fractures and the contact mechanistic model used to compute actual fracture geometries in this section we also briefly present the multiphase flow model utilized to calculate the relative permeability and show its validity by comparing the results with the experimental measurements in section 3 the effect of normal stress correlation length and pressure gradient on the wetting and non wetting relative permeabilities is discussed finally we propose the new relative permeability model and verify its accuracy against the available models the main findings and potential future works are summarized in the last section 2 methodology to characterize the behavior of multiphase flows through fractures we conducted a series of explicit simulations using an immiscible fracture flow model on a set of artificially generated fracture geometries the artificial fracture geometries used in this study were originally developed in a previous study by javanmard et al 2021 the procedure used to generate the synthetic aperture fields and the contact mechanistic model employed to compute the final aperture distribution under normal stresses have been also briefly explained in section 2 1 the details of the immiscible two phase flow model are presented in section 2 2 along with results validating the model against previously published experimental results 2 1 generation of synthetic apertures the two phase flow simulations were performed using fracture geometries originally developed by javanmard et al 2021 a short summary of this process is provided below unloaded fracture geometries were originally generated using the gstat package in r the fractures have a mean and standard deviation of 0 24 and 0 17 mm respectively typical for natural fractures mourzenko et al 1996 keller 1997 zhang and chai 2020 to study the effect of the spacial correlation of the aperture field on the relative permeability behavior the correlation lengths λ of the aperture distribution were set to 1 10 or 20 mm based on an exponential semi variogram model the correlation length determines as the maximum in plane distance below which the apertures can be considered to be similar javanmard et al 2021 a correlation length of 1 mm corresponds to the distributions were the apertures are weakly correlated while the correlation length of 20 mm represents a highly correlated field fracture geometries under in situ stresses were then computed from the generated fractures using pastewka s contact mechanics model kling et al 2018 the elastic contact deformation model simulates the frictionless contact of two surfaces by solving the equations of linear elasticity for an infinite half space under contact loading johnson and johnson 1987 the effective young s modulus e that determines the elastic properties of the contacting surfaces is calculated using the young s modulus e and poisson modulus v of the matrix material 2 1 e 2 1 v 2 e by ignoring the in plane displacement the normal closure u x y can be related to the normal stress σ n x y using the following a green s function equation 3 u x y g x x y y σ n x y d x d y using a fourier transform based convolution method this equation is reduced to 4 u x y g q x q y σ n q x q y where g and σ n are the fourier transform of the corresponding quantities and q x and q y are the wavevectors in reciprocal space in x and y directions respectively for more details please refer to kling et al 2018 unlike other contact models pyrak nolte and nolte 2016 wang and cardenas 2016 this model retains the exact fracture geometry without simplifying the asperity shape the surface displacement contact stresses and the resulting aperture distribution were calculated for each fracture under each applied normal stress in this study the typical values of 11 gpa for young s modulus e and 0 25 for poisson ratio ν were used to describe the mechanical properties of the rock fractures vogler et al 2018 and the final aperture distributions were generated at three normal stress levels of 0 5 kpa 28 mpa and 50 mpa for more details on the aperture distribution calculations we refer the reader to javanmard et al 2021 2 2 multiphase flow simulation we use an immiscible multiphase flow model that explicitly represents the changes in the fracture aperture or flow properties while implicitly solving the cross sectional flow walsh and carroll 2013 this model has three main components i a parallel plate model to provide the cross sectional flow ii a lattice boltzmann like color gradient model to provide phase separation and iii a surface tension model to track the interface between the fluids the parallel plate model which describes the flow of the mixture of fluids is coupled with a recoloration technique that segregates the two phases the recoloration strategy described by a color function allows the fluid components to moderately mix producing a diffusive interface which its properties are determined using the surface tension model the recoloration strategy used here is based on that presented by latva kokko and rothman 2005 for each timestep the change in the color function φ consists of a diffusive component and an advective component 5 δ φ δ φ d i f f δ φ a d v for two adjacent cells say a and b the diffusive term is defined by 6 δ φ a b d i f f d w a b 2 φ b 1 β 1 φ b cos θ φ a 1 β 1 φ a cos θ δ t where d is the diffusion coefficient w a b is the distance between the cells center β is the anti diffusion coefficient which controls the interface width and θ is the angle between the color function gradient and the normal to the cell s face i e cos θ ϕ n ˆ ϕ an upwind scheme is used to calculate the advective term 7 δ φ a b a d v t a b v p b p a δ p a b ϕ a b u p where 8 ϕ a b u p ϕ a if p b p a δ p a b 0 ϕ b if p b p a δ p a b 0 here t a b is transmissibility between cells a and b v is the volume of the cell and p denotes pressure the key parameter that allows coupling the above model to the parallel plate model is the pressure differential δ p a b that can be determined using the following expression 9 δ p a b δ κ δ ϕ f b where δ is surface tension κ is curvature δ ϕ is the change in the color function and f b is the body force exerted on the fluid components the curvature in this equation comprises of in plane κ and out of plane κ curvatures the out of plane curvature is calculated using the following equation glass et al 2003 10 κ 2 cos α w α c h where h is the fracture aperture α w is the wettability angle of the fracture surface and α c is the convergence angle of the fracture planes relative variations the surface height between the upper and lower fracture surface are accounted for through the aperture distribution variations in absolute height can be accounted for by elevating and lowering the underlying 2d mesh the in plane curvature is determined from the color function distribution using the mac scheme provided in brackbill et al 1992 11 κ ϕ ϕ this δ p is then used in the parallel plate model to provide the cross sectional flow of the fluids a more detailed explanation of the model can be found in walsh and carroll 2013 and hatami and walsh 2021 in the simulations considered here periodic boundary conditions are enforced on each edge of the domain and a body force is applied in the x direction to induce the multiphase flow the same approach has been used and validated in other similar studies e g li et al 2005 sukop and thorne 2006 hao and cheng 2010 huang et al 2015 fig 1 show an example of the flow simulation in one of the fracture with the correlation length of 1 mm and surface roughness of 2 8 under a normal stress of 0 0005 mpa the simulations were initiated at different saturation of non wetting phases and for each phase the average flow rate was measured the relative permeability was determined by comparing the flux of each fluid to that of the same fracture when fully saturated with only one of the phases experimental data of kerosene water flow from pieters and graves 1994 oil water flow from pan et al 1996 and oil water experiments from wong et al 2008 were used to validate the model s ability to predict relative permeability saturation relations the same fracture aperture and fluid properties as those of the experiments were used in the simulation it should also be noted that in the experiments by pan et al 1996 and wong et al 2008 they first mixed the fluids in a separate vessel prior to injecting them into the fracture the same condition was mimicked in the simulations by using an initial random distribution of fluids in the domain fig 2a b and c show the comparison between the experimental data and the simulation results as can be seen in the figures the simulations are in good agreement with the laboratory data confirming the model s ability to capture the fluid interaction additional validation studies against analytical solutions can also be found in walsh and carroll 2013 and hatami and walsh 2021 3 simulation results in total the two phase immiscible flow model was used to perform 945 simulations in fractures with different geometries and flow conditions table 2 summarizes the range of confining stress mean aperture surface roughness which is defined as mean aperture divided by apertures standard deviation applied pressure gradient and number of simulations for each set of fractures with the initial correlation length of 1 10 and 20 mm five different realizations were considered for each correlation length under a specific effective confining stress for each realization simulations were performed at nine saturation levels from 0 1 0 9 as well as fully saturated case in the following sections the effect of effective normal stress fracture correlation length and pressure gradient on the relative permeability curves will be discussed finally two simple models for the relative permeability of wetting and non wetting phases are proposed and its accuracy is compared to the available literature models 3 1 effect of the normal stress the original apertures which initially had a log normal distribution were subjected to the effective normal stresses of 0 0005 28 or 50 mpa the normal stress of 0 0005 mpa was selected just to bring the fracture planes together without deforming the initial distribution fig 3a b and c show the evolution of aperture distribution by increasing the normal stress for the fractures with the initial correlation length of 1 10 and 20 mm respectively for all three cases as the normal stress increases the apertures become smaller and the distribution skewed to the left which is consistent with the behavior observed in other studies e g kang et al 2016 comparing fig 3a b and c reveals that weakly correlated apertures experience lower deformation under the same level of stress this is because of the fact that in the weakly correlated apertures the applied stress creates abundant and well distributed contact points which support the fracture against deformation and consequently making the fracture mechanically stiffer fig 4 presents the effect of the normal stress on the wetting and non wetting phase relative permeability curves for the fractures with different correlation length under different pressure gradients at a fixed correlation length and pressure gradient increasing the normal stress has two major effects on the relative permeability curves i it increases the residual saturation for both wetting and non wetting fluids and ii it increases the non linearity of the curves as discussed earlier in this section the fracture aperture decreases as a result of the applied normal stress which will reversely affect the capillary pressure between the fluids the capillary pressure in fractures can be calculated using the young laplace equation 12 p c δ 1 r 1 r where r and r are the out of plane and in plane radius of curvature respectively and δ is the interfacial tension between the fluids the two curvatures are calculated using a similar method to that described in glass et al 2003 and detwiler et al 2009 the in plane curvature is determined from the color distribution function the out of plane curvature which is also known as aperture induced curvature is related to the fracture aperture b and contact angle θ through the following equation 13 r b 2 cos θ by decreasing the aperture the capillary pressure increases and as a result the fluids will pose more intervention on the flow of each other this makes the relative permeability curves deviate from the x model comparing the relative permeability curves in each case of fig 4 also suggests that the normal stress has more influence on the residual saturation of the non wetting rather than that of the wetting phase due to the greater attractive forces the wetting fluid has the tendency to occupy the smaller apertures leaving the larger ones for the non wetting fluid to illustrate this consider fig 5a which shows the aperture distribution for a fracture with the surface roughness of 0 85 and correlation length of 20 mm a snapshot of fluid distribution for the same fracture at a pressure gradient of 0 1 kpa m is presented in fig 5b although the non wetting fluid has a volumetric saturation of 70 it occupies less than 40 of the fracture surface area hence under the same conditions the percolation threshold for the non wet occurs at larger volumetric saturation which also explains its higher residual saturation fig 5 3 2 effect of correlation length fig 6 demonstrates the effect of correlation length on the wetting and non wetting relative permeability for different normal stresses and pressure gradients at the lowest normal stress considered left column of fig 6 the correlation length did not have a considerable effect on the relative permeability curves particularly at higher pressure gradients at low stresses the fractures retain their initial log normal aperture distribution regardless of the correlation length however as the stress is increased the fractures with different correlation lengths experience different changes to their geometry yielding different relative permeability curves this can be observed in fig 6d e and f in fig 6d by increasing the correlation length the non wetting phase residual saturation increases and the relative permeability curves deviates more from the x model correlation length also affects the flow regimes in the system fig 7a c and e illustrate the aperture distribution in the fractures with correlation length of 1 10 and 20 mm snapshots of fluid distribution in these fractures at the non wetting saturation of 0 3 under a pressure gradient of 10 kpa m have been shown in fig 7b d and f correspondingly at the correlation length of 1 mm we can observe continuous channel flow regime in fig 7b which reduces the phase interference and makes the relative permeability curves linear as can be seen in fig 6f however the slug flow regimes observed in fig 7d and f corresponding to the correlation length of 10 and 20 mm respectively increase the influence of one phase over the flow of the other this in turn causes the relative permeability curves to deviate from the x model 3 3 effect of pressure gradient fig 8 shows the effect of pressure gradient on the wetting and non wetting relative permeability curves at different values of normal stress and correlation length as can be seen in all of the cases by increasing the pressure gradient the residual saturation is decreased and the curves become more linear capillary forces increase fluid interference and consequently the degree of non linearity in the relative permeability curves however when a high pressure gradient is applied on the fluids the capillary force becomes negligible compared to the resulting viscous force which acts as a driving force for the fluids movement moreover a high pressure gradient may dislodge fluids that have been retained in the apertures due to the capillary forces therefore as can be seen in fig 8 by increasing the pressure gradient the relative permeability curves approach the x model in contrast when the capillary forces dominate a large portion of the non wetting fluid becomes trapped in the apertures in this situation the fluids only flow when they reach their percolation threshold and create a continuous pathway in the fracture plane fig 9a presents the aperture distribution in a fracture with the correlation length of 20 mm and surface roughness of 0 72 fig 9b and c show snapshots of fluid distribution in the same fracture for the non wetting saturation of 0 7 and 0 8 respectively under a pressure gradient of 0 1 kpa m at the non wetting saturation of 0 7 the fluid has been totally trapped in the large apertures however when the saturation increases to 0 8 it starts to peculate through the continuous pathway across the fracture plane the flow of the non wetting phase also pushes the wetting phase that occupied the smaller spaces this is the reason for observing a spike in the wet relative permeability curve for the low pressure gradient of 0 1 kpa m as in fig 8f 3 4 relative permeability modeling analysis of the simulation results found that the following models can be used to describe the wetting and non wetting relative permeabilities in fractures 14 k r w s w s w r 1 s w r m 15 k r n w s n w s n w r 1 s n w r n where m and n are the models parameters and s w r and s n w r are the residual wetting and non wetting saturations respectively these functional forms represent modified versions of the standard x model adjusted to account for residual wetting and non wetting saturations the power terms are added to capture the non linearity observed in the relative permeability curve the performance of the relative permeability models described by eq 14 and eq 15 was examined against the models listed in table 1 the relative permeabilities from x model was calculated using both saturation and fraction of area covered by each phase in the fracture plane it is worth mentioning that the empirical parameters of the models listed in table 1 were optimized for each fracture fig 10a and b summarize each model s performance using box plots of the deviation factor which describes the difference between the model s prediction for relative permeability and the actual value 16 deviationfactor k r p r e d i c t e d k r m e a s u r e d as can be seen in fig 10a for the wetting phase the let model and the new model both return reliable results it should be noted that although the let model has a smaller range for the deviation factor it contains three empirical parameters for each phase as compared to the new developed model which has just one parameter for the non wetting phase fig 10b the new developed model provides the best performance with less than four percent deviation from the actual data it is rewarding to mention that using area fraction covered by each phase instead of the saturation improves the non wetting relative permeability prediction by the x model this is because of its higher sensitivity to the change in fracture aperture which can be better explained using the area fraction the parameters m and n reflect the complex effect of fracture morphology and the competition between the forces as we have seen so far the shape of the relative permeability curves is mainly governed by the spacial distribution of the apertures and the competition between the viscous and capillary forces to consider these effects we fitted empirical expressions for both m and n in terms of surface roughness γ and the capillary number n c a μ v n w δ i e the ratio between the viscous force and capillary force and is calculated using the fluids velocity v viscosity μ and interfacial tension δ for the fractures considered in this study we found that these parameters could be estimated from the empirically fitted quadratic relationships below 17 m 0 45 2 012 γ 0 489 γ 2 321 08 n c a 51455 15 n c a 2 18 n 0 7 0 294 γ 0 037 γ 2 164 45 n c a 29475 54 n c a 2 similar empirical expressions were also found to describe the residual saturations for the wetting and non wetting phases 19 s w r 0 1698 0 0588 log 10 γ 0 0276 log 10 2 n c a 20 s n w r 0 2149 0 3454 log 10 γ 0 2483 log 10 2 γ 0 0017 log 10 n c a 0 0042 log 10 2 n c a the above equations have been fitted to the data with surface roughnesses between 0 715 and 2 805 and capillary numbers between 1 72 1 0 8 and 5 34 1 0 3 fig 11 shows the relative permeability predicted by the new model versus the measured values from the simulations here model parameters i e m and n and residual saturations s w r and s n w r were estimated from eqs 17 to 20 using the estimated parameters the model returns reliable results for both the wetting and non wetting phases with the correlation coefficients of 0 9 and 0 95 respectively it should be mentioned that the new models for the relative permeability of wetting and non wetting phases were validated against the simulation results broader application of these models still needs to be confirmed by using laboratory measurements of two phase flow in rough walled fractures 4 conclusions multiphase flow in fractures involves greater phase interference lack of percolating pathways and different flow patterns compared to similar flows in porous media nevertheless most models used to describe the hydraulic properties of multiphase flows in fractures have been borrowed from porous media in this study we conducted a comprehensive set of simulations examining wetting and non wetting relative permeability in fractures with a wide range of geometries under different normal stress and flow conditions the results suggest that the normal stress has a strong effect on immiscible multiphase flows in fractures with strongly correlated apertures for larger normal stresses the relative permeability curves deviate from the linear model and the residual saturations increase this is most pronounced for the non wetting phase as high stresses increase the fracture s contact area increasing the chance of fluid trapping spacial correlation between fracture apertures influences the flow geometry under the same flow conditions the flow regime varies in fractures with different correlation lengths affecting the relative permeability however the effect of correlation length on relative permeability reduces at high pressure gradients as the flow of fluids in the fractures is influenced by the competition between the viscous and capillary forces increasing the pressure gradient diminishes the capillary forces compared to viscous forces as a result the fluids experience less interference and the relative permeability curves approach the linear model a new model was introduced to predict the wetting and non wetting relative permeability in fractures the model returns reliable results for the relative permeability of both wetting and non wetting phases when compared to the other available model a further set of empirical correlations were also suggested to predict the model parameters and residual saturations based on the surface roughness and capillary number credit authorship contribution statement sobhan hatami writing visualization software formal analysis stuart d c walsh writing editing resources conceptualization formal analysis supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
2850,this paper considers the influence of geometry and flow conditions on the relative permeability of wetting and non wetting components of multiphase flows through fractures using an explicit immiscible two phase fracture flow model 945 multiphase flow simulations were conducted on artificially generated fracture geometries these simulations accounted for the effects of initial fracture roughness confining stress pressure gradient surface tension and volume fraction on the fracture flow time averaged relative permeabilities were recorded for both the wetting and non wetting phases in each of the simulations the simulation results demonstrate that relative permeability curves are strongly influenced by contact area fracture morphology and competition between viscous and capillary forces increasing the normal stress creates more contact in the fracture plane which increases interference between the fluid phases the effect is more pronounced in fractures with strongly correlated apertures where the chance of fluid trapping is increased the relative importance of viscous forces compared to capillary forces was investigated by applying different pressure gradients to the fluids increasing the pressure gradient tends to cause the flow paths to segregate and the relative permeability curves approach the linear model in agreement with experimental results from these observations two new relative permeability models were introduced to describe the behavior of wetting and non wetting phases in fractures the performance of the new models were compared to other published relative permeability models for fracture geometries the new models were found to more accurately predict the relative permeability when compared to the other available models for both the wetting and non wetting phases keywords multiphase flow relative permeability fracture flow data availability data will be made available on request 1 introduction predicting multiphase flow through fractures is of great importance in many subsurface engineering applications such as oil and gas production geological storage of carbon dioxide or nuclear wastes seepage control of rock slopes exploitation of geothermal energy and compact heat exchangers mahmoodi et al 2020 chen et al 2020 liu et al 2021 phillips et al 2020 however the macroscopic models used to describe multiphase flows in fractures have been largely derived from those used in porous media with the assumption that multiphase flows behave in the same way in pores and fracture apertures despite the change in geometry sheng et al 2019 wong et al 2008 nevertheless the two dimensional nature of fracture flows makes them distinct from flows in porous media da silva et al 2019 for example in porous media it is quite common for both phases to flow simultaneously as multiple percolating pathways can be supported in three dimensions however in two dimensions this is only possible if both phases flow in parallel or if there is interference between the phases watanabe et al 2015 huo and benson 2016 thus it is worthwhile examining the development of flow pathways in fractures and the effect of fluids intervention on their hydraulic properties multiphase flows in porous and fractured media are governed by the relative saturation of the wetting and non wetting phases naik et al 2021 ni et al 2021 wetting fluids tend to occupy the smaller pores due to higher capillary forces while the non wetting fluid fills the larger pores causing the interference of each phase on the flow of the other zhao et al 2020 the level of interference is governed by the capillary pressure produced at the fluid interface which is more significant in small pores zou et al 2020 relative permeability has been introduced to quantify the degree of interference defined as the ratio of the effective permeability of each phase to the absolute permeability of the medium i e the permeability for single phase flows 1 k r k i k where k r is the relative permeability of phase i k i is the effective permeability of phase i and k is the absolute permeability of the medium i e the permeability for single phase flows while permeability is a function of geometry alone independent of fluid properties mourzenko et al 2018 this is not the case for effective permeability in particular if fluid interference occurs it must necessarily be a function of the mixed fluid s constitutive properties its surface tension and viscosity and the properties of the flow the applied pressure gradient this fact is often overlooked in models of relative permeability for three dimensional flows as the two fluids can find percolating pathways that allow both fluids to flow simultaneously without interference however the same is not true of two dimensional fluid flows watanabe et al 2015 yang et al 2013 initial experimental studies on two phase flow in fractures by romm 1972 suggested that relative permeability for each phase is a linear function of its saturation indicating that neither phases interfered with the flow of the other nevertheless later experimental works demonstrated deviation from the linear model proposed by romm pieters and graves 1994 pan et al 1996 diomampo et al 2001 fourar and lenormand 1998 introduced a viscous coupling model based on the assumption that the complexity of the fluids interaction can be modeled by the theory of viscous coupling between fluids which had already been applied in porous media using this model they could successfully capture the deviation of the experimental data from the linear model two phase gas liquid flow experiments were performed by chen et al 2004 between parallel plates to quantify the effect of the flow patterns on the relative permeabilities based on the liquid and gas superficial velocities four flow regimes were identified bubble flow slug flow unstable channel flow and channel flow they defined two tortuosity parameters for gas and liquid based on their flow structures to rectify the deviation of the experimental data from the x model in a similar study conducted by wong et al 2008 it was shown that for the channel flow regime where both phase are continuous the relative permeability curves follow the x model while for the dispersed and mix flow regimes where one of the phases are discontinuous there is a non linear relationship between relative permeability and saturation using the van genuchten mualem model mualem 1976 for capillary pressure in porous media sheng et al 2019 derived an analytical expressions for two phase relative permeability in fractures it was demonstrated that the final form of the relative permeability in fractures is similar to that of van genuchten mualem relative permeability model in porous media the validity of the model was proved against liquid gas experimental data multiphase fracture flow processes are restricted to a roughly planar geometry hence the flow properties are primarily governed by the fracture s aperture distribution a normal or shear stress on the fracture plane will deform the fracture geometry and change the fracture s hydraulic properties mourzenko et al 1997 including the relative permeability saturation relations liu et al 2013 studied the effect of the normal stress on the two phase flow properties in fractures they proposed constitutive relationships between relative permeability capillary pressure and saturation for deformable horizontal fractures based on a two part hook s model in this model the fracture apertures are divided into soft and hard part with the hard part is subjected to a lower deformation and the hook s law with different strain values is applied on each part separately the validity of these relationships were shown by their consistency with the experimental data a physical model was introduced by li et al 2014 to estimate capillary pressure and relative permeability for rough walled fractures subjected to normal and shear stresses in this model the relative permeability of each phase is the cubic ratio between the representative mean of apertures occupied by that phase and the total representative mean aperture obtained from a strain dependent physical model laboratory experiments were performed by huo and benson 2016 to measure the relative permeability of nitrogen water system at two normal stress conditions of 2 07 mpa and 5 52 mpa the results demonstrated that at higher stress the phase interference increases and the flow becomes more viscous dominated watanabe et al 2015 studied two phase flow in fractures at different combinations of mean fracture aperture wettability condition and confining stress they showed that at higher aperture and contact angles near 90 where the capillary pressure is negligible the relative permeability curves follow the x model however for the conditions under the influence of capillarity they indicated that the corey model can describe the wetting phase relative permeability curve while for the non wetting phase they proposed a new ν type model ye et al 2017 developed constitutive relationships between relative permeability and saturation based on the simulations of two phase flow under normal deformation conditions they showed high sensitivity of the relative permeability to spacial correlation of aperture distribution and normal stress many of the above studies were conducted on a limited number of fractures with idealized geometries moreover the effect of fracture morphology and flow conditions on the relative permeability behavior were not discussed in detail table 1 presents relative permeability models used in fractures for both wetting and non wetting phases apart from the x model most of the models like the brooks corey model brooks and corey 1966 or the van genuchten mualem model mualem 1976 have been originally developed for porous media or derived based on an analogy between porous medial and fractures here we perform immiscible two phase flow simulations in fractures to study the effect of fracture geometry normal stress and the competition between the viscous and capillary forces on the wetting and non wetting relative permeability curves then we introduce a simple model to predict the relative permeability in fractures and compare its performance with the available models the remainder of this study is organized as follow section 2 is dedicated to description of the methodology to generate the synthetic fractures and the contact mechanistic model used to compute actual fracture geometries in this section we also briefly present the multiphase flow model utilized to calculate the relative permeability and show its validity by comparing the results with the experimental measurements in section 3 the effect of normal stress correlation length and pressure gradient on the wetting and non wetting relative permeabilities is discussed finally we propose the new relative permeability model and verify its accuracy against the available models the main findings and potential future works are summarized in the last section 2 methodology to characterize the behavior of multiphase flows through fractures we conducted a series of explicit simulations using an immiscible fracture flow model on a set of artificially generated fracture geometries the artificial fracture geometries used in this study were originally developed in a previous study by javanmard et al 2021 the procedure used to generate the synthetic aperture fields and the contact mechanistic model employed to compute the final aperture distribution under normal stresses have been also briefly explained in section 2 1 the details of the immiscible two phase flow model are presented in section 2 2 along with results validating the model against previously published experimental results 2 1 generation of synthetic apertures the two phase flow simulations were performed using fracture geometries originally developed by javanmard et al 2021 a short summary of this process is provided below unloaded fracture geometries were originally generated using the gstat package in r the fractures have a mean and standard deviation of 0 24 and 0 17 mm respectively typical for natural fractures mourzenko et al 1996 keller 1997 zhang and chai 2020 to study the effect of the spacial correlation of the aperture field on the relative permeability behavior the correlation lengths λ of the aperture distribution were set to 1 10 or 20 mm based on an exponential semi variogram model the correlation length determines as the maximum in plane distance below which the apertures can be considered to be similar javanmard et al 2021 a correlation length of 1 mm corresponds to the distributions were the apertures are weakly correlated while the correlation length of 20 mm represents a highly correlated field fracture geometries under in situ stresses were then computed from the generated fractures using pastewka s contact mechanics model kling et al 2018 the elastic contact deformation model simulates the frictionless contact of two surfaces by solving the equations of linear elasticity for an infinite half space under contact loading johnson and johnson 1987 the effective young s modulus e that determines the elastic properties of the contacting surfaces is calculated using the young s modulus e and poisson modulus v of the matrix material 2 1 e 2 1 v 2 e by ignoring the in plane displacement the normal closure u x y can be related to the normal stress σ n x y using the following a green s function equation 3 u x y g x x y y σ n x y d x d y using a fourier transform based convolution method this equation is reduced to 4 u x y g q x q y σ n q x q y where g and σ n are the fourier transform of the corresponding quantities and q x and q y are the wavevectors in reciprocal space in x and y directions respectively for more details please refer to kling et al 2018 unlike other contact models pyrak nolte and nolte 2016 wang and cardenas 2016 this model retains the exact fracture geometry without simplifying the asperity shape the surface displacement contact stresses and the resulting aperture distribution were calculated for each fracture under each applied normal stress in this study the typical values of 11 gpa for young s modulus e and 0 25 for poisson ratio ν were used to describe the mechanical properties of the rock fractures vogler et al 2018 and the final aperture distributions were generated at three normal stress levels of 0 5 kpa 28 mpa and 50 mpa for more details on the aperture distribution calculations we refer the reader to javanmard et al 2021 2 2 multiphase flow simulation we use an immiscible multiphase flow model that explicitly represents the changes in the fracture aperture or flow properties while implicitly solving the cross sectional flow walsh and carroll 2013 this model has three main components i a parallel plate model to provide the cross sectional flow ii a lattice boltzmann like color gradient model to provide phase separation and iii a surface tension model to track the interface between the fluids the parallel plate model which describes the flow of the mixture of fluids is coupled with a recoloration technique that segregates the two phases the recoloration strategy described by a color function allows the fluid components to moderately mix producing a diffusive interface which its properties are determined using the surface tension model the recoloration strategy used here is based on that presented by latva kokko and rothman 2005 for each timestep the change in the color function φ consists of a diffusive component and an advective component 5 δ φ δ φ d i f f δ φ a d v for two adjacent cells say a and b the diffusive term is defined by 6 δ φ a b d i f f d w a b 2 φ b 1 β 1 φ b cos θ φ a 1 β 1 φ a cos θ δ t where d is the diffusion coefficient w a b is the distance between the cells center β is the anti diffusion coefficient which controls the interface width and θ is the angle between the color function gradient and the normal to the cell s face i e cos θ ϕ n ˆ ϕ an upwind scheme is used to calculate the advective term 7 δ φ a b a d v t a b v p b p a δ p a b ϕ a b u p where 8 ϕ a b u p ϕ a if p b p a δ p a b 0 ϕ b if p b p a δ p a b 0 here t a b is transmissibility between cells a and b v is the volume of the cell and p denotes pressure the key parameter that allows coupling the above model to the parallel plate model is the pressure differential δ p a b that can be determined using the following expression 9 δ p a b δ κ δ ϕ f b where δ is surface tension κ is curvature δ ϕ is the change in the color function and f b is the body force exerted on the fluid components the curvature in this equation comprises of in plane κ and out of plane κ curvatures the out of plane curvature is calculated using the following equation glass et al 2003 10 κ 2 cos α w α c h where h is the fracture aperture α w is the wettability angle of the fracture surface and α c is the convergence angle of the fracture planes relative variations the surface height between the upper and lower fracture surface are accounted for through the aperture distribution variations in absolute height can be accounted for by elevating and lowering the underlying 2d mesh the in plane curvature is determined from the color function distribution using the mac scheme provided in brackbill et al 1992 11 κ ϕ ϕ this δ p is then used in the parallel plate model to provide the cross sectional flow of the fluids a more detailed explanation of the model can be found in walsh and carroll 2013 and hatami and walsh 2021 in the simulations considered here periodic boundary conditions are enforced on each edge of the domain and a body force is applied in the x direction to induce the multiphase flow the same approach has been used and validated in other similar studies e g li et al 2005 sukop and thorne 2006 hao and cheng 2010 huang et al 2015 fig 1 show an example of the flow simulation in one of the fracture with the correlation length of 1 mm and surface roughness of 2 8 under a normal stress of 0 0005 mpa the simulations were initiated at different saturation of non wetting phases and for each phase the average flow rate was measured the relative permeability was determined by comparing the flux of each fluid to that of the same fracture when fully saturated with only one of the phases experimental data of kerosene water flow from pieters and graves 1994 oil water flow from pan et al 1996 and oil water experiments from wong et al 2008 were used to validate the model s ability to predict relative permeability saturation relations the same fracture aperture and fluid properties as those of the experiments were used in the simulation it should also be noted that in the experiments by pan et al 1996 and wong et al 2008 they first mixed the fluids in a separate vessel prior to injecting them into the fracture the same condition was mimicked in the simulations by using an initial random distribution of fluids in the domain fig 2a b and c show the comparison between the experimental data and the simulation results as can be seen in the figures the simulations are in good agreement with the laboratory data confirming the model s ability to capture the fluid interaction additional validation studies against analytical solutions can also be found in walsh and carroll 2013 and hatami and walsh 2021 3 simulation results in total the two phase immiscible flow model was used to perform 945 simulations in fractures with different geometries and flow conditions table 2 summarizes the range of confining stress mean aperture surface roughness which is defined as mean aperture divided by apertures standard deviation applied pressure gradient and number of simulations for each set of fractures with the initial correlation length of 1 10 and 20 mm five different realizations were considered for each correlation length under a specific effective confining stress for each realization simulations were performed at nine saturation levels from 0 1 0 9 as well as fully saturated case in the following sections the effect of effective normal stress fracture correlation length and pressure gradient on the relative permeability curves will be discussed finally two simple models for the relative permeability of wetting and non wetting phases are proposed and its accuracy is compared to the available literature models 3 1 effect of the normal stress the original apertures which initially had a log normal distribution were subjected to the effective normal stresses of 0 0005 28 or 50 mpa the normal stress of 0 0005 mpa was selected just to bring the fracture planes together without deforming the initial distribution fig 3a b and c show the evolution of aperture distribution by increasing the normal stress for the fractures with the initial correlation length of 1 10 and 20 mm respectively for all three cases as the normal stress increases the apertures become smaller and the distribution skewed to the left which is consistent with the behavior observed in other studies e g kang et al 2016 comparing fig 3a b and c reveals that weakly correlated apertures experience lower deformation under the same level of stress this is because of the fact that in the weakly correlated apertures the applied stress creates abundant and well distributed contact points which support the fracture against deformation and consequently making the fracture mechanically stiffer fig 4 presents the effect of the normal stress on the wetting and non wetting phase relative permeability curves for the fractures with different correlation length under different pressure gradients at a fixed correlation length and pressure gradient increasing the normal stress has two major effects on the relative permeability curves i it increases the residual saturation for both wetting and non wetting fluids and ii it increases the non linearity of the curves as discussed earlier in this section the fracture aperture decreases as a result of the applied normal stress which will reversely affect the capillary pressure between the fluids the capillary pressure in fractures can be calculated using the young laplace equation 12 p c δ 1 r 1 r where r and r are the out of plane and in plane radius of curvature respectively and δ is the interfacial tension between the fluids the two curvatures are calculated using a similar method to that described in glass et al 2003 and detwiler et al 2009 the in plane curvature is determined from the color distribution function the out of plane curvature which is also known as aperture induced curvature is related to the fracture aperture b and contact angle θ through the following equation 13 r b 2 cos θ by decreasing the aperture the capillary pressure increases and as a result the fluids will pose more intervention on the flow of each other this makes the relative permeability curves deviate from the x model comparing the relative permeability curves in each case of fig 4 also suggests that the normal stress has more influence on the residual saturation of the non wetting rather than that of the wetting phase due to the greater attractive forces the wetting fluid has the tendency to occupy the smaller apertures leaving the larger ones for the non wetting fluid to illustrate this consider fig 5a which shows the aperture distribution for a fracture with the surface roughness of 0 85 and correlation length of 20 mm a snapshot of fluid distribution for the same fracture at a pressure gradient of 0 1 kpa m is presented in fig 5b although the non wetting fluid has a volumetric saturation of 70 it occupies less than 40 of the fracture surface area hence under the same conditions the percolation threshold for the non wet occurs at larger volumetric saturation which also explains its higher residual saturation fig 5 3 2 effect of correlation length fig 6 demonstrates the effect of correlation length on the wetting and non wetting relative permeability for different normal stresses and pressure gradients at the lowest normal stress considered left column of fig 6 the correlation length did not have a considerable effect on the relative permeability curves particularly at higher pressure gradients at low stresses the fractures retain their initial log normal aperture distribution regardless of the correlation length however as the stress is increased the fractures with different correlation lengths experience different changes to their geometry yielding different relative permeability curves this can be observed in fig 6d e and f in fig 6d by increasing the correlation length the non wetting phase residual saturation increases and the relative permeability curves deviates more from the x model correlation length also affects the flow regimes in the system fig 7a c and e illustrate the aperture distribution in the fractures with correlation length of 1 10 and 20 mm snapshots of fluid distribution in these fractures at the non wetting saturation of 0 3 under a pressure gradient of 10 kpa m have been shown in fig 7b d and f correspondingly at the correlation length of 1 mm we can observe continuous channel flow regime in fig 7b which reduces the phase interference and makes the relative permeability curves linear as can be seen in fig 6f however the slug flow regimes observed in fig 7d and f corresponding to the correlation length of 10 and 20 mm respectively increase the influence of one phase over the flow of the other this in turn causes the relative permeability curves to deviate from the x model 3 3 effect of pressure gradient fig 8 shows the effect of pressure gradient on the wetting and non wetting relative permeability curves at different values of normal stress and correlation length as can be seen in all of the cases by increasing the pressure gradient the residual saturation is decreased and the curves become more linear capillary forces increase fluid interference and consequently the degree of non linearity in the relative permeability curves however when a high pressure gradient is applied on the fluids the capillary force becomes negligible compared to the resulting viscous force which acts as a driving force for the fluids movement moreover a high pressure gradient may dislodge fluids that have been retained in the apertures due to the capillary forces therefore as can be seen in fig 8 by increasing the pressure gradient the relative permeability curves approach the x model in contrast when the capillary forces dominate a large portion of the non wetting fluid becomes trapped in the apertures in this situation the fluids only flow when they reach their percolation threshold and create a continuous pathway in the fracture plane fig 9a presents the aperture distribution in a fracture with the correlation length of 20 mm and surface roughness of 0 72 fig 9b and c show snapshots of fluid distribution in the same fracture for the non wetting saturation of 0 7 and 0 8 respectively under a pressure gradient of 0 1 kpa m at the non wetting saturation of 0 7 the fluid has been totally trapped in the large apertures however when the saturation increases to 0 8 it starts to peculate through the continuous pathway across the fracture plane the flow of the non wetting phase also pushes the wetting phase that occupied the smaller spaces this is the reason for observing a spike in the wet relative permeability curve for the low pressure gradient of 0 1 kpa m as in fig 8f 3 4 relative permeability modeling analysis of the simulation results found that the following models can be used to describe the wetting and non wetting relative permeabilities in fractures 14 k r w s w s w r 1 s w r m 15 k r n w s n w s n w r 1 s n w r n where m and n are the models parameters and s w r and s n w r are the residual wetting and non wetting saturations respectively these functional forms represent modified versions of the standard x model adjusted to account for residual wetting and non wetting saturations the power terms are added to capture the non linearity observed in the relative permeability curve the performance of the relative permeability models described by eq 14 and eq 15 was examined against the models listed in table 1 the relative permeabilities from x model was calculated using both saturation and fraction of area covered by each phase in the fracture plane it is worth mentioning that the empirical parameters of the models listed in table 1 were optimized for each fracture fig 10a and b summarize each model s performance using box plots of the deviation factor which describes the difference between the model s prediction for relative permeability and the actual value 16 deviationfactor k r p r e d i c t e d k r m e a s u r e d as can be seen in fig 10a for the wetting phase the let model and the new model both return reliable results it should be noted that although the let model has a smaller range for the deviation factor it contains three empirical parameters for each phase as compared to the new developed model which has just one parameter for the non wetting phase fig 10b the new developed model provides the best performance with less than four percent deviation from the actual data it is rewarding to mention that using area fraction covered by each phase instead of the saturation improves the non wetting relative permeability prediction by the x model this is because of its higher sensitivity to the change in fracture aperture which can be better explained using the area fraction the parameters m and n reflect the complex effect of fracture morphology and the competition between the forces as we have seen so far the shape of the relative permeability curves is mainly governed by the spacial distribution of the apertures and the competition between the viscous and capillary forces to consider these effects we fitted empirical expressions for both m and n in terms of surface roughness γ and the capillary number n c a μ v n w δ i e the ratio between the viscous force and capillary force and is calculated using the fluids velocity v viscosity μ and interfacial tension δ for the fractures considered in this study we found that these parameters could be estimated from the empirically fitted quadratic relationships below 17 m 0 45 2 012 γ 0 489 γ 2 321 08 n c a 51455 15 n c a 2 18 n 0 7 0 294 γ 0 037 γ 2 164 45 n c a 29475 54 n c a 2 similar empirical expressions were also found to describe the residual saturations for the wetting and non wetting phases 19 s w r 0 1698 0 0588 log 10 γ 0 0276 log 10 2 n c a 20 s n w r 0 2149 0 3454 log 10 γ 0 2483 log 10 2 γ 0 0017 log 10 n c a 0 0042 log 10 2 n c a the above equations have been fitted to the data with surface roughnesses between 0 715 and 2 805 and capillary numbers between 1 72 1 0 8 and 5 34 1 0 3 fig 11 shows the relative permeability predicted by the new model versus the measured values from the simulations here model parameters i e m and n and residual saturations s w r and s n w r were estimated from eqs 17 to 20 using the estimated parameters the model returns reliable results for both the wetting and non wetting phases with the correlation coefficients of 0 9 and 0 95 respectively it should be mentioned that the new models for the relative permeability of wetting and non wetting phases were validated against the simulation results broader application of these models still needs to be confirmed by using laboratory measurements of two phase flow in rough walled fractures 4 conclusions multiphase flow in fractures involves greater phase interference lack of percolating pathways and different flow patterns compared to similar flows in porous media nevertheless most models used to describe the hydraulic properties of multiphase flows in fractures have been borrowed from porous media in this study we conducted a comprehensive set of simulations examining wetting and non wetting relative permeability in fractures with a wide range of geometries under different normal stress and flow conditions the results suggest that the normal stress has a strong effect on immiscible multiphase flows in fractures with strongly correlated apertures for larger normal stresses the relative permeability curves deviate from the linear model and the residual saturations increase this is most pronounced for the non wetting phase as high stresses increase the fracture s contact area increasing the chance of fluid trapping spacial correlation between fracture apertures influences the flow geometry under the same flow conditions the flow regime varies in fractures with different correlation lengths affecting the relative permeability however the effect of correlation length on relative permeability reduces at high pressure gradients as the flow of fluids in the fractures is influenced by the competition between the viscous and capillary forces increasing the pressure gradient diminishes the capillary forces compared to viscous forces as a result the fluids experience less interference and the relative permeability curves approach the linear model a new model was introduced to predict the wetting and non wetting relative permeability in fractures the model returns reliable results for the relative permeability of both wetting and non wetting phases when compared to the other available model a further set of empirical correlations were also suggested to predict the model parameters and residual saturations based on the surface roughness and capillary number credit authorship contribution statement sobhan hatami writing visualization software formal analysis stuart d c walsh writing editing resources conceptualization formal analysis supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
2851,the present study proposes and evaluates an integrated framework in which water quality distribution model of the lake and reservoir operation optimization are linked for improving the environmental management of the reservoir coupled remote sensing data processing machine learning model was utilized to simulate water quality distribution in the reservoir in which one machine learning model was used for converting the spectral images to the total dissolved solids tds distribution in the reservoir then another machine learning model was developed based on the generated data by the first model for predicting water quality distribution map for unseens reservoir inflow outflow scenarios this machine learning model was applied in the structure of reservoir operation optimization particle swarm optimization was utilized in the optimization process based on the results in the case study the proposed method is able to minimize environmental impacts in the reservoir while the benefits from the reservoir such as water supply are maximized however its performance is not perfect that seems logical in fact the proposed model is able to balance the environmental requirements and losses of the reservoir according to the generated water quality distribution map in a critical month of the simulated period tds concentration alters in range of 258 mg l to 1091 mg l in the lake that demonstrates using water quality distribution model in the optimal reservoir operation is necessary the proposed method highlights the importance of using the remote sensing based models in the structure of water resources optimization systems keywords optimal reservoir operation remote sensing analysis artificial intelligence methods water quality distribution particle swarm optimization data availability data is available through requesting from the corresponding author upon the reasonable request 1 introduction large dams are the most important hydraulic structures in the rivers that might play a significant role for water or electricity supply ho et al 2017 these structures generally provide a large reservoir or artificial lake wherever are constructed due to considerable costs of the large dams optimal operation of the reservoir is highlighted in the literature e g moeini and babaei 2017 the initial objective function was defined in the form of loss function in which difference between target such as water demand and release from the reservoir could be minimized constraints of the reservoir management such as storage constraints should be added to the optimization model as well more details presented by ehteram et al 2018 another aspect that might be effective on the optimal management of the reservoir operation is which optimization method should be applied for finding the best solution the linear programming lp non linear programming nlp and dynamic programming dp were initially applied in the optimization process e g lee et al 2008 dogan et al 2021 rani et al 2020 it is demonstrated that metaheuristic algorithms are efficient and powerful methods for the reservoir operation optimization due to complexities of the objective function ahmad et al 2014 many algorithms have been developed for the metaheuristic optimization that are generally classified as the classic and new generation algorithms or animal and non animal inspired algorithms dokeroglu et al 2019 jahandideh tehrani et al 2021 the classic algorithms such as genetic algorithm and particle swarm optimization indicated the robust performance in many optimization problems reviewed by jain et al 2018 lambora et al 2019 banks et al 2007 however many new generation algorithms have been developed to improve the optimal solutions according to the literature classic and new generation algorithms might have robust performance in the optimization of the reservoir operation ahmad et al 2014 large dams exacerbate environmental impacts at downstream and upstream that might be highly destructive for the aquatic habitats and depended terrestrial habitats wu et al 2019 some previous studies focused on the assessment of the environmental flow at downstream of the reservoirs and diversion dams in which different methods have been utilized in the assessment of the environmental flow e g suwal et al 2020 sedighkia et al 2021a large dams might terminate the immigration process of the fishes toward the upstream of the rivers wu et al 2019 hence the suitability of the reservoir habitats is highly important moreover the lake might be applied for the cage fish farming as one of the side economic activities for the reservoirs dochin and stoyneva 2014 remote sensing analysis is a robust tool in the water quality assessment of the water bodies ritchie et al 2003 many previous studies highlighted the water quality assessment of the water bodies using remote sensing analysis or spectral images analysis that indicates the applicability of the remote sensing analysis in the water quality assessment e g kapalanga et al 2021 erena et al 2019 da silva et al 2021 images by landsat 8 and sentinel 2 are mostly used to convert the spectral images to simulate water quality parameters in the previous studies e g bonansea et al 2019 machine learning models are the novel tools that could be used in the environmental modelling neural networks are one of the known ai methods which has been used as a machine learning method in engineering problems in many previous studies reviewed by huang and fu 2019 artificial neural networks anns comprise three layers including input layer hidden layers and outputs layers more details regarding the theory and applications of the neural networks have been addressed in the literature e g cao et al 2018 the previous studies corroborate the high efficiency of the neural networks in the water resource management and engineering e g salleh et al 2021 khan et al 2018 the present study proposes a novel integrated system for environmental management of the reservoirs in which reservoir operation optimization remote sensing analysis and machine learning models are linked with a focus on water quality suitability in the reservoir the main purpose of the proposed method is to mitigate environmental impacts in the artificial lake of the large dams through the optimal operation of the reservoir it should be noted that an optimal operation of the reservoir should be able to provide proper environment in the lake that might be essential for the inhabited aquatics and other activities such as cage fish farming moreover this method is able to minimize losses of the reservoirs and consider the constraints in the reservoir operation in fact simultaneous environmental management of the reservoir and benefits of the reservoir could be provided by the proposed method the present study opens the new windows regarding the environmental management of the reservoirs using the novel methods of the environmental modelling the main novelty of the present study is to develop a novel system for reservoir management in which remote sensing data processing and ai methods are linked to the operation model for improving the environmental management of the reservoirs 2 application and methodology 2 1 overview on the methodology due to complexities of the developed system it might be helpful to have an overview on the methodology several steps should be carried out to achieve the defined purposes as discussed at the previous section remote sensing data processing was carried out through two steps including data acquisition and developing a data driven model to convert spectral images to water quality distribution in the reservoir then another data driven model was developed to simulate water quality distribution for unseen optimal scenarios in which spectral images are not available in the next step a novel reservoir operation model was developed to optimize release from the reservoir based on the defined environmental and reservoir loss purposes in which second data driven model was applied in the structure of the model the output of this step was optimal release of the reservoir in the simulated period finally the water quality distribution map of the lake in the optimal operation was generated by the data driven model as an example of the generated maps water quality distribution in one of the critical months were displayed as a test of results fig 1a shows the workflow of the proposed method 2 2 study area the proposed method was applied in the dez dam where is constructed on the dez river in the khuzestan province iran this dam is responsible for supply of water at downstream agricultural lands however it obstructed the immigration path of the fishes from the sea to the upstream of the river for the reproduction hence many fishes should live in the reservoir as the main habitat and immigrate to the upstream river for reproduction moreover some point and non point sources of the pollutants have been recognized at the upstream of the reservoir that might be a serious threat for the habitats in the reservoir in fact environmentalists have serious concerns regarding the suitability of the lake habitats for the native fish species moreover the cage fish farming has been planned as the beneficial economic activity for the local people who need to improve the income some initial measurements were demonstrated that the operation of the reservoir is highly effective on the water quality distribution in the reservoir based on the previous ecological studies in the dez river basin total dissolved solids tds is the most important water quality factor that might threaten the suitability of the aquatic habitats hence it seems that focusing on the tds as the key factor in the present study is logical tds distribution in the february is critical in the reservoir due to reproduction of the valuable native fish species in the reservoir however general suitability of the tds is important in all other months fig 1b displays the location of the reservoir and sampling points of the reservoir in which tds was measured in a long term period 2 3 remote sensing data processing data acquisition is one of the main steps in the remote sensing data processing that might be highly effective on the results in the present study generated spectral images by the landsat 8 were utilized this satellite was launched on an atlas v rocket from vandenberg air force base california on february 11 2013 the operational land imager oli is the main instrument to capture the spectral images from the earth landsat 8 is able to capture the spectral images in intervals of 16 days in other words images are available for the study in each 16 days all the available images from the study area were downloaded from the usgs data bank preprocessing was carried out on the images more details regarding the preprocessing are addressed in the literature e g pizani et al 2020 seven bands of the downloaded images were used in the present study fig 2 shows one of the downloaded images in which seven available bands in the study area are displayed yellow border displays the selected region for study in the reservoir based on the technical considerations in the case study field studies of tds in the reservoir in the sampling points as shown in the fig 1a b were carried out in a long term period however data was not available in all the downloaded spectral images 360 points were used in the development of the data driven model to convert the spectral images to the tds distribution in the reservoir eighty percent of the points were used in the training of the model and rest of them was applied in the testing process of the model we applied an optimal ann as the data driven model in which the number of hidden layers were optimized to achieve the most accurate model the general structure of the ann is displayed in the fig 3 different algorithms or methods might be useable in the training process of the model we applied levenberg marquardt algorithm lma or just lm as the training algorithm that is one of the efficient methods in this regard fig 4 displays the optimization process of the ann in the remote sensing analysis in which 20 of the training data was used to compute the rmse for selecting the best number of hidden layers it should be noted that two stages of testing were applied in the present study including testing process for selecting the optimal number of hidden layers and testing process for evaluating the performance of finalized data driven model table 1 shows more details regarding the data driven model that was used for converting the spectral images to the tds distribution in the reservoir each data driven model might need some indices to measure the robustness of the model in the present study two indices were utilized to measure the performance of the data driven models including the nash sutcliffe efficiency nse and root mean square error rmse that are known indices in this regard eqs 1 and 2 display the mathematical form of these indices where mi is modelled data in the point i oi is the observed data in the point i and om is the mean of the observed data 1 nse 1 t 1 t m t o t 2 t 1 t o t o m 2 2 rmse t 1 t m t o t 2 t 2 4 simulating tds distribution in the reservoir by machine learning model another data driven model was developed in the present study that could be applied as the machine learning model to simulate tds distribution for unseen scenarios such as optimal operation of the reservoir in which no spectral image is available twenty images were selected for development of this data driven model in which 3 images were utilized for testing the performance of the model general structure of this model was the same with the first data driven model that could be applied for converting the spectral images however inputs are different including longitude and latitude of each point in the reservoir inflow and outflow to the reservoir and tds inflow to the reservoir in fact these parameters were identified as the most important factors on the water quality distribution hence the machine learning model is able to generate the tds distribution map in the reservoir it should be noted that available remote sensing data for each month in the middle of the month was adopted for simulating mean tds distribution in that month 2 5 optimization model defining a correct objective function is the main step to develop an optimization model that should be based on the initial objective of the optimization system in the present study the purpose of the optimization model is to manage and control the tds concentration in the reservoir thus release from the reservoir should be able to satisfy environmental requirements of the reservoir management as well as water supply and storage constraints as the defined benefits for the dam eq 3 displays developed objective function in the present study where tt is target in time step t rt is release from the reservoir in time step t ftd is mean favourite total dissolved solids in the reservoir and atdt is actual total dissolved solids in time step t in the reservoir in fact the optimization model minimizes the difference between target and release and the difference between mean favourite tds concentration and actual tds concentration in the reservoir in the simulated period t is time horizon ftd was defined as 360 mg l based on the previous ecological studies and opinion by an experienced ecologist who was familiar with the aquatic ecological requirements in the study area 3 minimize o f t 1 t ftd atd t ftd 2 t t r t t t 2 the output of the optimization system is able to balance the environmental requirements of the dam s lake and benefits of the reservoir for the community each reservoir operation optimization might need some constraints that should be added to the optimization system in the present study four constraints should be considered in the structure of the optimization model including 1 downstream release should not be less than minimum environmental flow 2 downstream release should not be more than defined target in the optimization model 3 storage of the reservoir should not be less than minimum operational storage and 4 storage of the reservoir should not be more than the capacity of the reservoir or maximum storage of the reservoir the penalty function method is one of the appropriate methods to convert the constrained optimization problem to unconstrained one that is highly applicable in the metaheuristic optimization this method has been utilized in many previous studies hence we applied this method in the present study by adding four penalty functions to the optimization model eq 4 displays the added penalty functions to the system where st is storage in time step t envmin is minimum environmental flow smin is minimum operational storage in the reservoir and smax is capacity of the reservoir or maximum storage 4 if s t s max p 1 c 1 s t s max s max 2 i f s t s min p 2 c 2 s t s min s min 2 i f r t env min p 2 c 2 r t env min env min 2 i f r t t t p 1 c 1 r t t t t t 2 storage should be updated in each time step by eq 5 in which overflow could be computed by eq 6 5 s t 1 s t i t r t f t e t a t 1000 t 1 2 t where s is storage i is inflow of the reservoir e is evaporation from the surface a is area of the reservoir surface r is release and f is overflow 6 i f s t i t e t a t 1000 s max f t s t i t e t a t 1000 s max i f s t i t e t a t 1000 s max f t 0 it should be noted that atdt is computed based on the eq 7 in which tds is computed in each point i of the reservoir x means longitude and y means latitude and n means total number of points in the reservoir we applied landsat 8 spectral images in which the cell size is 30 30 that means each point is in the central of each cell 7 atd t i 1 n t d s xi y i n each optimization system might need some indices to measure the performance of the system in the present study two indices were used including reliability index for supply of defined target and rmse for mean tds concentration in the reservoir as displayed in the eqs 8 and 9 8 reliabilityindex t 1 t r t t 1 t t t 9 rmse optimizationsystem t 1 t atd t f t d 2 t 3 results in the first step it is essential to present results and performance of the data driven models the first data driven model was used for converting the spectral images to the tds concentration distribution according to optimization process of the number of hidden layers using 32 hidden layers was the best option to finalize the first data driven model fig 5 displays the results of the testing process of this data driven model rmse and nse are displayed on the figure as well according to the literature if nse is more than 0 5 the predictive skill of the model is robust if nse is 1 then the performance of the model is perfect based on the results in the present study the developed data driven model for converting the spectral images to the tds distribution in the reservoir is highly reliable nse and rmse are 0 96 and 22 4 respectively that demonstrate the generated model could convert the spectral images to the tds distribution accurately fig 6 shows the regression model for computing habitat suitability index in the present study in which the input is tds concentration and output of the regression model is hsi between zero and one this regression model was developed based on the previous ecological studies in the study area regarding the estimated population of the fish species in different levels of tds in the next step investigation the performance of the machine learning model to simulate tds distribution in the reservoir for unseen events is essential in fact this model was used in the structure of the optimization model to simulate tds distribution in the reservoir optimal number of hidden layers for this model was 6 that has been used to finalize the model then three tests were considered for investigating the robustness of the tds machine leaning model for simulating tds distribution map in other words three spectral images were selected in which required data for the machine learning model such as inflow outflow and tds inflow was available first tds distribution map was generated by remote sensing analysis then tds distribution map was simulated by machine learning model as displayed in the figs 7 to 9 the nse and rmse as the measurement indices are displayed in the caption of the figures it seems that the performance of the machine learning model to simulate tds distribution for unseen events is generally reliable however its performance in test 3 is not as robust as two other tests in the fig 10 suitability map for the test 1 is shown in which tds concentration has been converted to the habitat suitability index hsi it sounds that the machine learning model is acceptably able to identify suitable regions in the reservoir hence the application of the developed machine learning model to simulate lake suitability in the structure of the reservoir operation optimization is tenable in the next step it is necessary to present the results of the reservoir operation optimization fig 11 displays the main outputs of the optimization model in which target inflow release storage and mean tds concentration time series could be observed it sounds that optimal release is able to supply considerable part of defined target in the optimization model however we applied reliability index to measure the performance of the optimization model in terms of supply of demand the reliability index is 0 613 that indicates the optimal operation of the reservoir is able to supply more than 50 of demand it should be noted that other reservoirs and ground water resources could be utilized for water supply in the study area as well moreover fig 11 displays the storage time series in the simulated period the performance of the optimization system in terms of storage is acceptable the performance of storage penalty functions including minimum operational storage function and maximum storage function are robust in other words storage in the reservoir is not less than minimum operational storage and is not more than the capacity of the reservoir in all the time steps minimum defined storage was 250 mcm and maximum storage was 2698 mcm furthermore mean tds concentration in the reservoir is displayed in the fig 11 according to the results the optimization model is not able to provide predefined favourite tds concentration in the reservoir in all the time steps however it could effectively reduce the tds concentration in some months the maximum mean concentration is less than 600 mg l rmse for means tds concentration in the reservoir was 137 38 mg l that means the performance of the optimization model is not perfect however it sounds acceptable it should be noted that it is not expected to have favourite tds concentration in the reservoir in the simulated period in fact reservoir should be able to carry out defined responsibilities such as water supply in the next step tds distribution map in the reservoir for optimal reservoir operation should be generated in the simulated period in the case study february was the critical months in the environmental management of reservoir due to two reasons first juvenile fishes would enter to the reservoir in this month that means low habitat suitability might be considerably destructive moreover this month is one of the critical months for the cage fish farming in the study area that means tds distribution map could be helpful for identification of suitable zones for cage fish farming hence we presented the tds distribution in the reservoir in the first february in the simulated period to test the ability of the developed system fig 12 displays the tds distribution map in the selected area of the reservoir in which tds concentration is changed in range of 258 mg l to 1091 mg l moreover fig 13 shows the suability map in this month some points should be discussed regarding the results in the case study first range of changing tds in the reservoir is considerable that means simulation of tds distribution in the reservoir is necessary and mean tds could not be helpful for environmental management of the reservoir it should be noted that reservoir as an artificial lake is an important habitat in the river basins in fact some aquatic species use the reservoir as the main habitat for living that means environmental management of the reservoir might be crucial moreover cage fish farming needs suitable habitats for installing the cages according to the results in one of the critical months habitats are not suitable in the close regions to the dams however bankful regions where are far from the dam are more suitable for the aquatics hence it is recommendable to utilize these regions for the cage fish farming it seems that the output of the present study is useful for integrated management of the reservoir considering environmental challenges in the reservoirs 4 discussion a full discussion on technical and computational aspects of the present study is necessary moreover it is essential to highlight the advantages and limitations of the developed framework in this section we discuss on the technical and computational aspects of the research work 4 1 strengths and technical points of the proposed mechanism the present study developed a novel form of the reservoir operation in which remote sensing and artificial intelligence methods are effectively used to improve the environmental management of the reservoir in fact the proposed method is an integrated method for managing reservoir operation in which environmental degradations in the lake and downstream river have been mitigated while the reservoir losses are minimized furthermore constraints in the reservoir operation such as storage constraints have been considered in the structure of the optimization model hence it might be a complete model to manage the reservoir the most important advantage of the proposed method is to generate the tds distribution map in the reservoir that is applicable for the better environmental management and cage fish farming management in the reservoir it should be noted that the previous reservoir operation models are not able to generate the habitat suitability in the reservoir in fact using hydrodynamic simulation was recommended in the previous studies e g martin et al 2018 to simulate water quality parameters distribution in the reservoir that might not be applicable in the structure of reservoir operation optimization in fact it could not be coupled with the optimization model however the present study developed a coupled rs ai model to simulate tds distribution that was applied in the structure of optimization model in other words the proposed method is able to convert the reservoir operation optimization from a water management model to an environmental management model in the reservoirs the developed model is able to work as a robust model to simulate water quality distribution in the reservoir it should be noted that we focused on the tds as one of the most important water quality parameters in the case study however the proposed framework is utilizable for other water quality parameters as well our research team had extensive ecological field studies in the case study for investigating the impact of water quality parameters on the population of the aquatic species the ecological observations demonstrated that the fish population would be highly dependent on changing tds in the river basin other water quality factors were effective on the population however observations corroborated the significant impact of tds compared with other factors it should be noted that the impact of different factors might be altered in other case studies due to changing inhabited aquatic species and environmental characteristics hence it is recommendable to have ecological field studies to select the best water quality parameters as the environmental indices 4 2 computational advantages disadvantages and future research fields we applied an optimal neural network in the present study to convert the spectral images to the tds distribution in the reservoir based on the results this method is robust in this regard the results indicated that optimizing the number of hidden layers in the development of neural network might be highly important to have a robust model hence it is recommendable to apply the optimal neural network in the future studies other forms of ai methods such as support vector machine and neuro fuzzy inference systems might be applicable in this regard however it should be noted that the proposed model is advantageous compared with other methods such ash neuro fuzzy inference systems for example training time is one of the limitations in the application of machine learning methods the proposed ann method needs limited time for training process that is a remarkable advantage for this model we used the lm method in the training of the ann that presented the acceptable performance however other methods might be applicable as well hence it is recommendable to utilize other training methods in the future studies for example evolutionary algorithms could be used in this regard it should be noted that training process is the most important step to develop a robust data driven model thus it might be worthwhile to allocate much time for finding the best training algorithm another computational aspect that should be discussed is the optimization algorithm in the present study we developed a single objective function that was solved by pso as one of the known evolutionary algorithms two points need to be explained in this stage first why we applied a single objective function in the present study moreover what needs should be noticed in the future studies regarding the optimization algorithm as could be observed the developed objective function contains two terms that means it might be possible to use each term as a standalone function then a multiobjective optimization algorithms could be applied to find the best solution using this procedure might seem logical at the first glance however some limitations might diminish the applicability of this method first a multi objective optimization might have more computational complexities compared with the single objective optimization the computational complexities might be defined as the needed time and memory for finding the optimal solution by the optimization algorithm it is highly important in the engineering projects that might need numerous simulations or covering a long term period in fact engineers are not willing to implement the complex optimization systems due to considerable costs hence the proposed method is beneficial in this regard because it is able to find the appropriate optimal solution while the computational complexities are not high moreover it should be noted that limited number of multiobjective optimization algorithms have been developed in the literature in contrast many single objective optimization algorithms are available to find the best solution it should be answered why we need to apply different evolutionary algorithms to find the optimal solution in the projects in the present study we only applied pso to test the developed optimization system however it might be needed to utilize other algorithms as well then the optimal solution could be selected by a decisions making system in fact the evolutionary algorithms are not able to guarantee the global optimization that might be a significant drawback for these algorithms hence using different algorithms might be helpful for finding the best optimal solution 4 3 significance of using the proposed method it seems that applying the conventional form of the reservoir operation optimization is not efficient for facing the environmental challenges in the river basins in fact the environmental issues regarding the construction of the reservoirs have been highlighted in recent decades all the previous studies corroborated that an optimal operation of the reservoir should be able to address the economic benefits and environmental impacts simultaneously e g sedighkia et al 2021b some studies focused on the downstream ecological impact of the reservoir by proposing novel forms of the optimization of the reservoir operation however considering upstream environmental impacts might not be easy in the structure of the optimization model when a dam is constructed the connection between upstream and downstream habitats is obstructed that means the new artificial lake is a new ecosystem for the aquatics hence it is critical to provide a suitable ecological status in the reservoir water quality is the most important factor for having suitable habitats in the lakes hence it is logical to focus on it the conventional reservoir operation models do not include any tool or model for considering lake suitability in the structure of the model it should be noted that water quality distribution in the reservoir is dependent on the inflow and outflow of the reservoir in other words it is not possible to maximize suitability in the reservoir unless an optimization model that includes a water quality model is applied to optimize outflow from the reservoir in fact the optimization adjusts inflow and outflow of the reservoir for environmental management of the reservoir and minimizing loss of the reservoir the proposed model might open the new windows regarding the management of the reservoir considering environmental degradations at upstream of the dam or in the lake of the dam another advantage of the proposed is to apply remote sensing analysis in the structure of the optimization model effectively in fact remote sensing analysis helps engineer to manage the complex environmental problems in the reservoir management the machine learning model could link the remote sensing analysis to the optimization model it should be noted that we utilized the machine learning model in two stages in the present study first this method was used to convert the spectral images to the tds distribution the previous studies mainly applied the regression models for assessing the water quality using the remote sensing data processing e g abdelmalik 2018 however the results of the present study corroborated that using robust machine learning methods such as optimal neural network might be more reliable and easier than previous methods the machine learning method is able to find a map between spectral bands and tds concentration hence we recommend using the proposed model for converting the spectral images to the water quality distribution the significant novelty of the proposed method is to develop another machine learning model in which outputs of the converting spectral images was used as the observation data in fact the water quality distribution is dependent on some key factors such as inflow outflow and tds inflow to the reservoir lack of adequate data is the main drawback for developing a robust machine learning model to generate water quality distribution map in the reservoir remote sensing data could fill this gap for developing a machine learning model it seems that this might be helpful to develop new generation of the water quality models in the water bodies such as lakes or coastal regions the proposed integrated model is able to clarify all the environmental aspects regarding the environmental managements of the dams lakes for the environmentalist who are concerned regarding the environmental impacts of the reservoir operation 5 conclusions the present study developed a novel method to improve water quality management of the reservoirs through linking remote sensing analysis machine learning models and reservoir operation optimization based on the results in the case study linked remote sensing artificial intelligence model is acceptably able to generate tds distribution map in the lake tds concentration might alter in a wide range in the lake that demonstrates using water quality distribution in the reservoir operation optimization is necessary for water quality management of the reservoir the proposed optimization model is able to balance reservoir losses and environmental impacts of the lake simultaneously utilizing the developed method is recommendable for optimizing release of the reservoirs due to integrating environmental challenges and benefits of the reservoirs in a simulation optimization model credit authorship contribution statement mahdi sedighkia conceptualization methodology software formal analysis investigation validation visualization writing original draft asghar abdoli data curation supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
2851,the present study proposes and evaluates an integrated framework in which water quality distribution model of the lake and reservoir operation optimization are linked for improving the environmental management of the reservoir coupled remote sensing data processing machine learning model was utilized to simulate water quality distribution in the reservoir in which one machine learning model was used for converting the spectral images to the total dissolved solids tds distribution in the reservoir then another machine learning model was developed based on the generated data by the first model for predicting water quality distribution map for unseens reservoir inflow outflow scenarios this machine learning model was applied in the structure of reservoir operation optimization particle swarm optimization was utilized in the optimization process based on the results in the case study the proposed method is able to minimize environmental impacts in the reservoir while the benefits from the reservoir such as water supply are maximized however its performance is not perfect that seems logical in fact the proposed model is able to balance the environmental requirements and losses of the reservoir according to the generated water quality distribution map in a critical month of the simulated period tds concentration alters in range of 258 mg l to 1091 mg l in the lake that demonstrates using water quality distribution model in the optimal reservoir operation is necessary the proposed method highlights the importance of using the remote sensing based models in the structure of water resources optimization systems keywords optimal reservoir operation remote sensing analysis artificial intelligence methods water quality distribution particle swarm optimization data availability data is available through requesting from the corresponding author upon the reasonable request 1 introduction large dams are the most important hydraulic structures in the rivers that might play a significant role for water or electricity supply ho et al 2017 these structures generally provide a large reservoir or artificial lake wherever are constructed due to considerable costs of the large dams optimal operation of the reservoir is highlighted in the literature e g moeini and babaei 2017 the initial objective function was defined in the form of loss function in which difference between target such as water demand and release from the reservoir could be minimized constraints of the reservoir management such as storage constraints should be added to the optimization model as well more details presented by ehteram et al 2018 another aspect that might be effective on the optimal management of the reservoir operation is which optimization method should be applied for finding the best solution the linear programming lp non linear programming nlp and dynamic programming dp were initially applied in the optimization process e g lee et al 2008 dogan et al 2021 rani et al 2020 it is demonstrated that metaheuristic algorithms are efficient and powerful methods for the reservoir operation optimization due to complexities of the objective function ahmad et al 2014 many algorithms have been developed for the metaheuristic optimization that are generally classified as the classic and new generation algorithms or animal and non animal inspired algorithms dokeroglu et al 2019 jahandideh tehrani et al 2021 the classic algorithms such as genetic algorithm and particle swarm optimization indicated the robust performance in many optimization problems reviewed by jain et al 2018 lambora et al 2019 banks et al 2007 however many new generation algorithms have been developed to improve the optimal solutions according to the literature classic and new generation algorithms might have robust performance in the optimization of the reservoir operation ahmad et al 2014 large dams exacerbate environmental impacts at downstream and upstream that might be highly destructive for the aquatic habitats and depended terrestrial habitats wu et al 2019 some previous studies focused on the assessment of the environmental flow at downstream of the reservoirs and diversion dams in which different methods have been utilized in the assessment of the environmental flow e g suwal et al 2020 sedighkia et al 2021a large dams might terminate the immigration process of the fishes toward the upstream of the rivers wu et al 2019 hence the suitability of the reservoir habitats is highly important moreover the lake might be applied for the cage fish farming as one of the side economic activities for the reservoirs dochin and stoyneva 2014 remote sensing analysis is a robust tool in the water quality assessment of the water bodies ritchie et al 2003 many previous studies highlighted the water quality assessment of the water bodies using remote sensing analysis or spectral images analysis that indicates the applicability of the remote sensing analysis in the water quality assessment e g kapalanga et al 2021 erena et al 2019 da silva et al 2021 images by landsat 8 and sentinel 2 are mostly used to convert the spectral images to simulate water quality parameters in the previous studies e g bonansea et al 2019 machine learning models are the novel tools that could be used in the environmental modelling neural networks are one of the known ai methods which has been used as a machine learning method in engineering problems in many previous studies reviewed by huang and fu 2019 artificial neural networks anns comprise three layers including input layer hidden layers and outputs layers more details regarding the theory and applications of the neural networks have been addressed in the literature e g cao et al 2018 the previous studies corroborate the high efficiency of the neural networks in the water resource management and engineering e g salleh et al 2021 khan et al 2018 the present study proposes a novel integrated system for environmental management of the reservoirs in which reservoir operation optimization remote sensing analysis and machine learning models are linked with a focus on water quality suitability in the reservoir the main purpose of the proposed method is to mitigate environmental impacts in the artificial lake of the large dams through the optimal operation of the reservoir it should be noted that an optimal operation of the reservoir should be able to provide proper environment in the lake that might be essential for the inhabited aquatics and other activities such as cage fish farming moreover this method is able to minimize losses of the reservoirs and consider the constraints in the reservoir operation in fact simultaneous environmental management of the reservoir and benefits of the reservoir could be provided by the proposed method the present study opens the new windows regarding the environmental management of the reservoirs using the novel methods of the environmental modelling the main novelty of the present study is to develop a novel system for reservoir management in which remote sensing data processing and ai methods are linked to the operation model for improving the environmental management of the reservoirs 2 application and methodology 2 1 overview on the methodology due to complexities of the developed system it might be helpful to have an overview on the methodology several steps should be carried out to achieve the defined purposes as discussed at the previous section remote sensing data processing was carried out through two steps including data acquisition and developing a data driven model to convert spectral images to water quality distribution in the reservoir then another data driven model was developed to simulate water quality distribution for unseen optimal scenarios in which spectral images are not available in the next step a novel reservoir operation model was developed to optimize release from the reservoir based on the defined environmental and reservoir loss purposes in which second data driven model was applied in the structure of the model the output of this step was optimal release of the reservoir in the simulated period finally the water quality distribution map of the lake in the optimal operation was generated by the data driven model as an example of the generated maps water quality distribution in one of the critical months were displayed as a test of results fig 1a shows the workflow of the proposed method 2 2 study area the proposed method was applied in the dez dam where is constructed on the dez river in the khuzestan province iran this dam is responsible for supply of water at downstream agricultural lands however it obstructed the immigration path of the fishes from the sea to the upstream of the river for the reproduction hence many fishes should live in the reservoir as the main habitat and immigrate to the upstream river for reproduction moreover some point and non point sources of the pollutants have been recognized at the upstream of the reservoir that might be a serious threat for the habitats in the reservoir in fact environmentalists have serious concerns regarding the suitability of the lake habitats for the native fish species moreover the cage fish farming has been planned as the beneficial economic activity for the local people who need to improve the income some initial measurements were demonstrated that the operation of the reservoir is highly effective on the water quality distribution in the reservoir based on the previous ecological studies in the dez river basin total dissolved solids tds is the most important water quality factor that might threaten the suitability of the aquatic habitats hence it seems that focusing on the tds as the key factor in the present study is logical tds distribution in the february is critical in the reservoir due to reproduction of the valuable native fish species in the reservoir however general suitability of the tds is important in all other months fig 1b displays the location of the reservoir and sampling points of the reservoir in which tds was measured in a long term period 2 3 remote sensing data processing data acquisition is one of the main steps in the remote sensing data processing that might be highly effective on the results in the present study generated spectral images by the landsat 8 were utilized this satellite was launched on an atlas v rocket from vandenberg air force base california on february 11 2013 the operational land imager oli is the main instrument to capture the spectral images from the earth landsat 8 is able to capture the spectral images in intervals of 16 days in other words images are available for the study in each 16 days all the available images from the study area were downloaded from the usgs data bank preprocessing was carried out on the images more details regarding the preprocessing are addressed in the literature e g pizani et al 2020 seven bands of the downloaded images were used in the present study fig 2 shows one of the downloaded images in which seven available bands in the study area are displayed yellow border displays the selected region for study in the reservoir based on the technical considerations in the case study field studies of tds in the reservoir in the sampling points as shown in the fig 1a b were carried out in a long term period however data was not available in all the downloaded spectral images 360 points were used in the development of the data driven model to convert the spectral images to the tds distribution in the reservoir eighty percent of the points were used in the training of the model and rest of them was applied in the testing process of the model we applied an optimal ann as the data driven model in which the number of hidden layers were optimized to achieve the most accurate model the general structure of the ann is displayed in the fig 3 different algorithms or methods might be useable in the training process of the model we applied levenberg marquardt algorithm lma or just lm as the training algorithm that is one of the efficient methods in this regard fig 4 displays the optimization process of the ann in the remote sensing analysis in which 20 of the training data was used to compute the rmse for selecting the best number of hidden layers it should be noted that two stages of testing were applied in the present study including testing process for selecting the optimal number of hidden layers and testing process for evaluating the performance of finalized data driven model table 1 shows more details regarding the data driven model that was used for converting the spectral images to the tds distribution in the reservoir each data driven model might need some indices to measure the robustness of the model in the present study two indices were utilized to measure the performance of the data driven models including the nash sutcliffe efficiency nse and root mean square error rmse that are known indices in this regard eqs 1 and 2 display the mathematical form of these indices where mi is modelled data in the point i oi is the observed data in the point i and om is the mean of the observed data 1 nse 1 t 1 t m t o t 2 t 1 t o t o m 2 2 rmse t 1 t m t o t 2 t 2 4 simulating tds distribution in the reservoir by machine learning model another data driven model was developed in the present study that could be applied as the machine learning model to simulate tds distribution for unseen scenarios such as optimal operation of the reservoir in which no spectral image is available twenty images were selected for development of this data driven model in which 3 images were utilized for testing the performance of the model general structure of this model was the same with the first data driven model that could be applied for converting the spectral images however inputs are different including longitude and latitude of each point in the reservoir inflow and outflow to the reservoir and tds inflow to the reservoir in fact these parameters were identified as the most important factors on the water quality distribution hence the machine learning model is able to generate the tds distribution map in the reservoir it should be noted that available remote sensing data for each month in the middle of the month was adopted for simulating mean tds distribution in that month 2 5 optimization model defining a correct objective function is the main step to develop an optimization model that should be based on the initial objective of the optimization system in the present study the purpose of the optimization model is to manage and control the tds concentration in the reservoir thus release from the reservoir should be able to satisfy environmental requirements of the reservoir management as well as water supply and storage constraints as the defined benefits for the dam eq 3 displays developed objective function in the present study where tt is target in time step t rt is release from the reservoir in time step t ftd is mean favourite total dissolved solids in the reservoir and atdt is actual total dissolved solids in time step t in the reservoir in fact the optimization model minimizes the difference between target and release and the difference between mean favourite tds concentration and actual tds concentration in the reservoir in the simulated period t is time horizon ftd was defined as 360 mg l based on the previous ecological studies and opinion by an experienced ecologist who was familiar with the aquatic ecological requirements in the study area 3 minimize o f t 1 t ftd atd t ftd 2 t t r t t t 2 the output of the optimization system is able to balance the environmental requirements of the dam s lake and benefits of the reservoir for the community each reservoir operation optimization might need some constraints that should be added to the optimization system in the present study four constraints should be considered in the structure of the optimization model including 1 downstream release should not be less than minimum environmental flow 2 downstream release should not be more than defined target in the optimization model 3 storage of the reservoir should not be less than minimum operational storage and 4 storage of the reservoir should not be more than the capacity of the reservoir or maximum storage of the reservoir the penalty function method is one of the appropriate methods to convert the constrained optimization problem to unconstrained one that is highly applicable in the metaheuristic optimization this method has been utilized in many previous studies hence we applied this method in the present study by adding four penalty functions to the optimization model eq 4 displays the added penalty functions to the system where st is storage in time step t envmin is minimum environmental flow smin is minimum operational storage in the reservoir and smax is capacity of the reservoir or maximum storage 4 if s t s max p 1 c 1 s t s max s max 2 i f s t s min p 2 c 2 s t s min s min 2 i f r t env min p 2 c 2 r t env min env min 2 i f r t t t p 1 c 1 r t t t t t 2 storage should be updated in each time step by eq 5 in which overflow could be computed by eq 6 5 s t 1 s t i t r t f t e t a t 1000 t 1 2 t where s is storage i is inflow of the reservoir e is evaporation from the surface a is area of the reservoir surface r is release and f is overflow 6 i f s t i t e t a t 1000 s max f t s t i t e t a t 1000 s max i f s t i t e t a t 1000 s max f t 0 it should be noted that atdt is computed based on the eq 7 in which tds is computed in each point i of the reservoir x means longitude and y means latitude and n means total number of points in the reservoir we applied landsat 8 spectral images in which the cell size is 30 30 that means each point is in the central of each cell 7 atd t i 1 n t d s xi y i n each optimization system might need some indices to measure the performance of the system in the present study two indices were used including reliability index for supply of defined target and rmse for mean tds concentration in the reservoir as displayed in the eqs 8 and 9 8 reliabilityindex t 1 t r t t 1 t t t 9 rmse optimizationsystem t 1 t atd t f t d 2 t 3 results in the first step it is essential to present results and performance of the data driven models the first data driven model was used for converting the spectral images to the tds concentration distribution according to optimization process of the number of hidden layers using 32 hidden layers was the best option to finalize the first data driven model fig 5 displays the results of the testing process of this data driven model rmse and nse are displayed on the figure as well according to the literature if nse is more than 0 5 the predictive skill of the model is robust if nse is 1 then the performance of the model is perfect based on the results in the present study the developed data driven model for converting the spectral images to the tds distribution in the reservoir is highly reliable nse and rmse are 0 96 and 22 4 respectively that demonstrate the generated model could convert the spectral images to the tds distribution accurately fig 6 shows the regression model for computing habitat suitability index in the present study in which the input is tds concentration and output of the regression model is hsi between zero and one this regression model was developed based on the previous ecological studies in the study area regarding the estimated population of the fish species in different levels of tds in the next step investigation the performance of the machine learning model to simulate tds distribution in the reservoir for unseen events is essential in fact this model was used in the structure of the optimization model to simulate tds distribution in the reservoir optimal number of hidden layers for this model was 6 that has been used to finalize the model then three tests were considered for investigating the robustness of the tds machine leaning model for simulating tds distribution map in other words three spectral images were selected in which required data for the machine learning model such as inflow outflow and tds inflow was available first tds distribution map was generated by remote sensing analysis then tds distribution map was simulated by machine learning model as displayed in the figs 7 to 9 the nse and rmse as the measurement indices are displayed in the caption of the figures it seems that the performance of the machine learning model to simulate tds distribution for unseen events is generally reliable however its performance in test 3 is not as robust as two other tests in the fig 10 suitability map for the test 1 is shown in which tds concentration has been converted to the habitat suitability index hsi it sounds that the machine learning model is acceptably able to identify suitable regions in the reservoir hence the application of the developed machine learning model to simulate lake suitability in the structure of the reservoir operation optimization is tenable in the next step it is necessary to present the results of the reservoir operation optimization fig 11 displays the main outputs of the optimization model in which target inflow release storage and mean tds concentration time series could be observed it sounds that optimal release is able to supply considerable part of defined target in the optimization model however we applied reliability index to measure the performance of the optimization model in terms of supply of demand the reliability index is 0 613 that indicates the optimal operation of the reservoir is able to supply more than 50 of demand it should be noted that other reservoirs and ground water resources could be utilized for water supply in the study area as well moreover fig 11 displays the storage time series in the simulated period the performance of the optimization system in terms of storage is acceptable the performance of storage penalty functions including minimum operational storage function and maximum storage function are robust in other words storage in the reservoir is not less than minimum operational storage and is not more than the capacity of the reservoir in all the time steps minimum defined storage was 250 mcm and maximum storage was 2698 mcm furthermore mean tds concentration in the reservoir is displayed in the fig 11 according to the results the optimization model is not able to provide predefined favourite tds concentration in the reservoir in all the time steps however it could effectively reduce the tds concentration in some months the maximum mean concentration is less than 600 mg l rmse for means tds concentration in the reservoir was 137 38 mg l that means the performance of the optimization model is not perfect however it sounds acceptable it should be noted that it is not expected to have favourite tds concentration in the reservoir in the simulated period in fact reservoir should be able to carry out defined responsibilities such as water supply in the next step tds distribution map in the reservoir for optimal reservoir operation should be generated in the simulated period in the case study february was the critical months in the environmental management of reservoir due to two reasons first juvenile fishes would enter to the reservoir in this month that means low habitat suitability might be considerably destructive moreover this month is one of the critical months for the cage fish farming in the study area that means tds distribution map could be helpful for identification of suitable zones for cage fish farming hence we presented the tds distribution in the reservoir in the first february in the simulated period to test the ability of the developed system fig 12 displays the tds distribution map in the selected area of the reservoir in which tds concentration is changed in range of 258 mg l to 1091 mg l moreover fig 13 shows the suability map in this month some points should be discussed regarding the results in the case study first range of changing tds in the reservoir is considerable that means simulation of tds distribution in the reservoir is necessary and mean tds could not be helpful for environmental management of the reservoir it should be noted that reservoir as an artificial lake is an important habitat in the river basins in fact some aquatic species use the reservoir as the main habitat for living that means environmental management of the reservoir might be crucial moreover cage fish farming needs suitable habitats for installing the cages according to the results in one of the critical months habitats are not suitable in the close regions to the dams however bankful regions where are far from the dam are more suitable for the aquatics hence it is recommendable to utilize these regions for the cage fish farming it seems that the output of the present study is useful for integrated management of the reservoir considering environmental challenges in the reservoirs 4 discussion a full discussion on technical and computational aspects of the present study is necessary moreover it is essential to highlight the advantages and limitations of the developed framework in this section we discuss on the technical and computational aspects of the research work 4 1 strengths and technical points of the proposed mechanism the present study developed a novel form of the reservoir operation in which remote sensing and artificial intelligence methods are effectively used to improve the environmental management of the reservoir in fact the proposed method is an integrated method for managing reservoir operation in which environmental degradations in the lake and downstream river have been mitigated while the reservoir losses are minimized furthermore constraints in the reservoir operation such as storage constraints have been considered in the structure of the optimization model hence it might be a complete model to manage the reservoir the most important advantage of the proposed method is to generate the tds distribution map in the reservoir that is applicable for the better environmental management and cage fish farming management in the reservoir it should be noted that the previous reservoir operation models are not able to generate the habitat suitability in the reservoir in fact using hydrodynamic simulation was recommended in the previous studies e g martin et al 2018 to simulate water quality parameters distribution in the reservoir that might not be applicable in the structure of reservoir operation optimization in fact it could not be coupled with the optimization model however the present study developed a coupled rs ai model to simulate tds distribution that was applied in the structure of optimization model in other words the proposed method is able to convert the reservoir operation optimization from a water management model to an environmental management model in the reservoirs the developed model is able to work as a robust model to simulate water quality distribution in the reservoir it should be noted that we focused on the tds as one of the most important water quality parameters in the case study however the proposed framework is utilizable for other water quality parameters as well our research team had extensive ecological field studies in the case study for investigating the impact of water quality parameters on the population of the aquatic species the ecological observations demonstrated that the fish population would be highly dependent on changing tds in the river basin other water quality factors were effective on the population however observations corroborated the significant impact of tds compared with other factors it should be noted that the impact of different factors might be altered in other case studies due to changing inhabited aquatic species and environmental characteristics hence it is recommendable to have ecological field studies to select the best water quality parameters as the environmental indices 4 2 computational advantages disadvantages and future research fields we applied an optimal neural network in the present study to convert the spectral images to the tds distribution in the reservoir based on the results this method is robust in this regard the results indicated that optimizing the number of hidden layers in the development of neural network might be highly important to have a robust model hence it is recommendable to apply the optimal neural network in the future studies other forms of ai methods such as support vector machine and neuro fuzzy inference systems might be applicable in this regard however it should be noted that the proposed model is advantageous compared with other methods such ash neuro fuzzy inference systems for example training time is one of the limitations in the application of machine learning methods the proposed ann method needs limited time for training process that is a remarkable advantage for this model we used the lm method in the training of the ann that presented the acceptable performance however other methods might be applicable as well hence it is recommendable to utilize other training methods in the future studies for example evolutionary algorithms could be used in this regard it should be noted that training process is the most important step to develop a robust data driven model thus it might be worthwhile to allocate much time for finding the best training algorithm another computational aspect that should be discussed is the optimization algorithm in the present study we developed a single objective function that was solved by pso as one of the known evolutionary algorithms two points need to be explained in this stage first why we applied a single objective function in the present study moreover what needs should be noticed in the future studies regarding the optimization algorithm as could be observed the developed objective function contains two terms that means it might be possible to use each term as a standalone function then a multiobjective optimization algorithms could be applied to find the best solution using this procedure might seem logical at the first glance however some limitations might diminish the applicability of this method first a multi objective optimization might have more computational complexities compared with the single objective optimization the computational complexities might be defined as the needed time and memory for finding the optimal solution by the optimization algorithm it is highly important in the engineering projects that might need numerous simulations or covering a long term period in fact engineers are not willing to implement the complex optimization systems due to considerable costs hence the proposed method is beneficial in this regard because it is able to find the appropriate optimal solution while the computational complexities are not high moreover it should be noted that limited number of multiobjective optimization algorithms have been developed in the literature in contrast many single objective optimization algorithms are available to find the best solution it should be answered why we need to apply different evolutionary algorithms to find the optimal solution in the projects in the present study we only applied pso to test the developed optimization system however it might be needed to utilize other algorithms as well then the optimal solution could be selected by a decisions making system in fact the evolutionary algorithms are not able to guarantee the global optimization that might be a significant drawback for these algorithms hence using different algorithms might be helpful for finding the best optimal solution 4 3 significance of using the proposed method it seems that applying the conventional form of the reservoir operation optimization is not efficient for facing the environmental challenges in the river basins in fact the environmental issues regarding the construction of the reservoirs have been highlighted in recent decades all the previous studies corroborated that an optimal operation of the reservoir should be able to address the economic benefits and environmental impacts simultaneously e g sedighkia et al 2021b some studies focused on the downstream ecological impact of the reservoir by proposing novel forms of the optimization of the reservoir operation however considering upstream environmental impacts might not be easy in the structure of the optimization model when a dam is constructed the connection between upstream and downstream habitats is obstructed that means the new artificial lake is a new ecosystem for the aquatics hence it is critical to provide a suitable ecological status in the reservoir water quality is the most important factor for having suitable habitats in the lakes hence it is logical to focus on it the conventional reservoir operation models do not include any tool or model for considering lake suitability in the structure of the model it should be noted that water quality distribution in the reservoir is dependent on the inflow and outflow of the reservoir in other words it is not possible to maximize suitability in the reservoir unless an optimization model that includes a water quality model is applied to optimize outflow from the reservoir in fact the optimization adjusts inflow and outflow of the reservoir for environmental management of the reservoir and minimizing loss of the reservoir the proposed model might open the new windows regarding the management of the reservoir considering environmental degradations at upstream of the dam or in the lake of the dam another advantage of the proposed is to apply remote sensing analysis in the structure of the optimization model effectively in fact remote sensing analysis helps engineer to manage the complex environmental problems in the reservoir management the machine learning model could link the remote sensing analysis to the optimization model it should be noted that we utilized the machine learning model in two stages in the present study first this method was used to convert the spectral images to the tds distribution the previous studies mainly applied the regression models for assessing the water quality using the remote sensing data processing e g abdelmalik 2018 however the results of the present study corroborated that using robust machine learning methods such as optimal neural network might be more reliable and easier than previous methods the machine learning method is able to find a map between spectral bands and tds concentration hence we recommend using the proposed model for converting the spectral images to the water quality distribution the significant novelty of the proposed method is to develop another machine learning model in which outputs of the converting spectral images was used as the observation data in fact the water quality distribution is dependent on some key factors such as inflow outflow and tds inflow to the reservoir lack of adequate data is the main drawback for developing a robust machine learning model to generate water quality distribution map in the reservoir remote sensing data could fill this gap for developing a machine learning model it seems that this might be helpful to develop new generation of the water quality models in the water bodies such as lakes or coastal regions the proposed integrated model is able to clarify all the environmental aspects regarding the environmental managements of the dams lakes for the environmentalist who are concerned regarding the environmental impacts of the reservoir operation 5 conclusions the present study developed a novel method to improve water quality management of the reservoirs through linking remote sensing analysis machine learning models and reservoir operation optimization based on the results in the case study linked remote sensing artificial intelligence model is acceptably able to generate tds distribution map in the lake tds concentration might alter in a wide range in the lake that demonstrates using water quality distribution in the reservoir operation optimization is necessary for water quality management of the reservoir the proposed optimization model is able to balance reservoir losses and environmental impacts of the lake simultaneously utilizing the developed method is recommendable for optimizing release of the reservoirs due to integrating environmental challenges and benefits of the reservoirs in a simulation optimization model credit authorship contribution statement mahdi sedighkia conceptualization methodology software formal analysis investigation validation visualization writing original draft asghar abdoli data curation supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
2852,electrokinetic remediation ekr is a promising remediation technology for low permeability porous media contaminated with organic pollutants to reveal the processes of nonlinear electroosmotic flow eof and to elucidate the key factors controlling the efficiency of ekr a process based pore scale numerical model was established nernst planck poisson equation is coupled with navier stokes equation to describe the transport of species 1 pk model is applied to evaluate time varying zeta potential during ekr process totally 33 cases are simulated which include the settings of 3 background concentrations c b of ions in media 3 pk values 3 enhanced factor d corresponding to reciprocal of diameter of electrode well values and two different initial conditions it is found that all of c b pk and d impact eof and the removal efficiency of organic species from this study media with pk of 3 5 and 8 5 are more suitable for ekr with about 5 10 times faster remove rate than media with pk of 5 5 nonlinear eof including decreasing eof rate and reverse eof is more likely to occur in cases with pk of 5 5 and higher values of c b and d which can reduce efficiency of ekr by 2 4 times using an electrolyte with ion concentration closer to the original background concentrations of ions in soil can favour better removal efficiency keywords ekr electroosmosis organic pollutant numerical simulation pore scale data availability no data was used for the research described in the article 1 introduction removing organic contaminants such as chlorinated solvents from the field sites with clayey soil layers remains a big challenge electrokinetic remediation ekr is a promising remediation technology for low permeability porous media contaminated with organic inorganic and mixed pollutants by applying low strength electric field chowdhury et al 2017 gill et al 2014 li and yu 2015 qin et al 2015 souza et al 2017 xu et al 2019 yeung and datla 1995 yeung and gu 2011 which includes three mechanisms of electromigration electroosmosis and electrophoresis electroosmosis is the main mechanism for removing noncharged species ko et al 2000 qiao et al 2018 shi et al 2008 such as organic contaminants like phenol shapiro and probstein 1993 trichlorobenzene qiao et al 2018 and chlorinated ethenes sprocati et al 2020 electromigration is attributed to charged ions directional moving which causes relative slide between the electric double layer edl and the stern layer shear plane and simultaneously drags surrounding fluid carrying noncharged species to flow fig 1 a although directional and stable electroosmotic flow eof is designed and expected the nonlinear eof eof with a variable electroosmotic coefficient or unexpected eof including decreasing eof rate cessation of eof even reverse eof reof happens in many lab and field implementations acar and alshawabkeh 1993 dzenitis 1997 eykholt and daniel 1994 revil 2017 shapiro and probstein 1993 zhang and wang 2015 zhang and wang 2017 which reduces the efficiency of ekr what are major characteristics controlling the unexpected eof and how the nonlinear eof occurs along ekr processes are not well understood complicated and nonlinear ekr process can t be characterized by constant zeta potential ξ which is usually assumed when simulating simplified linear electroosmotic flow vizcaíno et al 2017 rezaee et al 2019 sprocati et al 2020 sun et al 2019 zeta potential might vary with ph and concentrations of ions in pore fluid and the zero point potential ph value pk of media acar and alshawabkeh 1993 crespy et al 2007 masi et al 2017 thormann et al 1998 the most common approach for the modeling of eof in porous media involves solving macroscopic conservation of charge and momentum in macro scale simulation a simplified exponential relationship with a couple of parameters is widely used to depict the relationship between ξ and ph crespy et al 2007 eykholt and daniel 1994 masi et al 2017 however this approach fails to capture flow details that can only be understood at the pore scale alizadeh et al 2019 godinez brizuela and niasar 2020 hlushkou et al 2007 pore scale numerical simulation can reveal detailed ekr process and nonuniform eof hlushkou et al 2007 using lattice boltzmann method lbm demonstrated that the pore scale velocity profile for eof is nonuniform even under most ideal conditions including a uniform distribution of the zeta potential at the solid liquid interface and the absence of applied pressure gradients godinez brizuela and niasar 2020 using pore network modelling approach explored the simultaneous pore scale pressure and electroosmosis driven flow in charged porous media with constant zeta potential alizadeh et al 2019 using lb method found that when the scenario with inhomogeneous charge local surface charge based on local ph and ion concentrations was taken into account the predicted electroosmotic permeability was higher in comparison with the prescribed homogeneous case zhang and wang 2017 established a pore scale numerical model to observe nonlinear eof with inhomogeneous surface charge and nonuniform zeta potential using 1 pk model de lima et al 2010a de lima et al 2010b zhang and wang 2017 assumed a steady condition for the simulation of eof in the soil with pk 5 5 and focused on the impact of ph but put aside the ion concentration from the ek remediation point of view ion concentration and ph in pore fluids and eof itself might change with time along ekr process acar and alshawabkeh 1993 shapiro and probstein 1993 different soils have very different pk values which is a key factor impacting eof acar and alshawabkeh 1993 in addition to ph ion concentration of electrolyte could strongly influence eof acar and alshawabkeh 1993 shapiro and probstein 1993 to the best of authors knowledge solute transport coupling with time and space variable zeta potential to analyze the electrokinetic remediation with nonlinear eof has not been investigated in porous media at pore scale the objective of this study is to reveal the mechanisms of nonlinear eof controlled by pk ph and ion concentration in pore fluids based on a process based pore scale numerical simulation with fully coupled flow concentration and electric potential fields it could help to develop process optimization schemes and pertinent design of ekr field implementations 2 modeling approach 2 1 mathematical models of ekr at pore scale the mathematical models of ekr at pore scale mainly include flow model to describe velocity and pressure 1 pk model to evaluate the variable zeta potential due to the change of ph and ionic strength species transport model to describe species migration and electrode reactions model to involve the electrolysis of water which is included as the boundary conditions of variable ph 2 1 1 flow model the navier stokes nse and the continuity equations are used to describe laminar and incompressible electro osmotic flow in pore scale domains 2 1 ρ u t ρ u u p i μ u u t f 2 2 ρ u 0 where ρ is the density u is the fluid velocity vector p is the pressure i is the direction vector and f is the body force vector introduced by electrical field because the thickness of edl is typically several nanometers appelo 2017 yang and wang 2019 smaller than the characteristic geometric length of media such as low permeable fine sand the charge distribution within edl can be overlooked alizadeh et al 2019 alizadeh et al 2017 coelho et al 1996 godinez brizuela and niasar 2020 peters et al 2016 zhang and wang 2017 hence electrical body force can be replaced by the slip velocity on the media surface dutta and beskok 2001 zhang and wang 2017 helmholtz smoluchowski equation hse is appropriate to be applied as slip velocity u hs 2 3 u hs ε 0 ε r ξ μ e where ε0 is the vacuum dielectric constant εr is the relative permittivity ξ is zeta potential μ is dynamic viscosity e φ and e is the electric field strength φ the potential 2 1 2 1 pk model of zeta potential 1 pk model is used in this study to evaluate the change of ξ during ekr process which considers a single surface protonation deprotonation complexation reaction de lima et al 2010a de lima et al 2010b zhang and wang 2017 2 4 me oh 1 2 h me oh 2 1 2 where me represents a metallic ion lying in the tetrahedral si 4 or octahedral al 3 layers of clay particle surface charge density σ can be expressed in two ways based on 1 pk model 2 5 σ f γ max 2 k c h b exp f ξ rt 1 k c h b exp f ξ rt 1 with k γ me oh 2 1 2 γ me oh 1 2 c h b exp f ξ rt or 8 ε 0 ε r r t c b sinh f ξ 2 r t where γ max γ me oh 2 1 2 γ me oh 1 2 is the maximum surface density γ me oh 2 1 2 and γ me oh 1 2 are the surface density of the complex me oh 2 1 2 and me oh 1 2 respectively site nm2 c h b and c b are the local bulk concentration of hydrogen ion and electrolyte solution respectively mol l r the ideal gas constant t the temperature 298 15 k f the faraday s constant εr relative permittivity ε0 the vacuum dielectric constant zeta potential ξ can be derived from those equations with variable ions concentration and ph de lima et al 2010b 2 6 ξ ln h ln 1 1 h h 2 a h c b 1 2 a h c b rt f where h k c h b 1 10 p h p k a 8 ε 0 ε r r t f γ max and pk is defined as log10k is the isoelectric point according to 1 pk model ξ strongly depends on ph and pk 3 5 5 5 and 8 5 but relative weakly depends on electrolyte solution concentration of c b 0 1 1 and 10 mm fig 1b 2 1 3 species transport model in addition to convection caused by pressure gradient external electric potential gradient can also induce species convection by electro osmotic mechanism nernst planck equation npe considers three main processes diffusion electromigration and convection 2 7 j i d i c i d i c i z i f rt φ u c i where di is the diffusion coefficient ci is the concentration of species zi is the valence of species among that u is controlled by two driving forces pressure and electric potential same as macro scale simulation sprocati et al 2021 sun et al 2019 the governing transport equation of multicomponent species is derived by mass conservation equation 2 8 c i t j i r i where ri is the reactive source sink term poisson s equation pe is used to control potential distribution and maintain electroneutrality of fluid as follows 2 9 2 φ ρ e ε 0 ε r where ρe is charge density ρ e f z i c i combining equations 2 8 and 2 9 generates the so called nernst planck poisson equations nppes which describe the combined transient effects of species transport due to electroosmosis convection diffusion and electromigration of a multicomponent system 2 1 4 electrode reactions the electrode reactions are included to simulate the boundary conditions of variable ph although buffering of electrolysis reactions can achieve better performances as performed by several authors cang et al 2013 vizcaíno et al 2018 xu et al 2020 incomplete neutralization can occur in the actual repair process and our study can provide understanding of these phenomena ignoring the conductivity contribution of media sprocati et al 2019 electric current flux i can be expressed as 2 10 i f i 1 n z i j i where n is the number of charged species the current flux generated by the movement of ions in pore water can be expressed as the sum of each component of total flux as 2 11 i f i 1 n z i d i c i f 2 i 1 n z i 2 d i c i rt φ f u i 1 n z i c i applied electric field causes water electrolysis reactions at the electrodes based on their reduction potentials assuming only water redox reactions happen at electrodes with oxidation reaction at the anode 2 12 o 2 4h 4e 2h 2 o e 0 1 229v and reduction reaction at cathode 2 13 2h 2 o 2e h 2 2oh e 0 0 8277v according to faraday s law the resulting generation fluxes of h and oh j i we at the electrodes can be expressed as 2 14 j h we j oh we i f the size of the electrode chambers used in macroscale simulation influences the changing trends of ph at the boundaries this concept is taken to indicate the extents of ph varying on boundaries under pore scale concentration of species changing with time can be expressed sprocati et al 2019 sun et al 2019 2 15 c i t j i j we d where d 1 m is defined as enhanced factor here at pore scale which is the ratio of cross sectional area to volume of the electrode chamber or reciprocal of diameter of electrode well sprocati et al 2019 sun et al 2019 at macro scale the extents of ph varying at boundaries caused by electrolysis reactions can be controlled by the parameter of d lower d values correspond to the enhanced ekr with better control of ph change ionization of water can be expressed as 2 16 h 2 o h oh ignoring ion activity in relatively low concentration conditions and assuming instantaneous equilibrium of water ionization thermodynamic equilibrium constant can be written as k w c h c oh 10 14 mol2 l2 in 298 15 k this study does not consider the process of ion reduction in solution caused by adsorption all the units of variables are system international units si unless otherwise specified all governing equations are coupled and solved by using a fully coupled solver built in the commercial software comsol multiphysics 5 4 the comsol physics used in our simulation includes creeping flow electrostatics transport of diluted species mathematics for boundary odes and daes and multiphysics coupling which consists of space charge density coupling potential coupling and flow coupling 2 2 numerical simulation five component system is considered which includes 4 ionic species of h oh representative monovalent background ions pair a and b and a noncharged organic species denoted as org each species has its own nppes except oh which is calculated by c oh k w c h to keep constant ionic product of water the space charge density coupling built in comsol multiphysics to define ρe is recoded to include the contribution of oh and maintain electric neutrality the values of parameters in the mathematical models of ekr are listed in table 1 the specific settings of numerical experiments which include settings of three characteristic factors construction of pore structure boundary conditions and initial conditions are presented below 2 2 1 settings of three characteristic factors numerical experiments are conducted with a series of settings of c b pk and d values to investigate the potential control factors of electrokinetic remediation in this study we consider 3 different background ions concentrations c b 0 1 mm 1 mm 10 mm 3 pk values 3 5 5 5 8 5 bray et al 2014 liu et al 2013 zhang and zhang 1992 and 3 values of d 0 01 m 1 0 1 m 1 1 m 1 table 2 2 2 2 construction of pore structure porous media structure plays a critical role in flow and transport processes especially in pore scale simulations although recent advances in computing power and the advantage of parallel computing to solve large problems three dimensional time varying pore scale electrokinetic numerical simulations are still computationally expensive hochstetler et al 2013 zhang and wang 2015 zhang and wang 2017 as depicted in hochstetler et al 2013 two dimensional pore scale porous media models provide useful insight in several situations especially in the case of limited computing power structure properties such as porosity grain size may cause different pollution plume shape under electrokinetic remediation yang et al 1996 proposed a grain packing method which was modified to simulate pore scale two dimensional flow or solute transport hochstetler et al 2013 hou et al 2018 rolle and kitanidis 2014 and same packing method was selected to generate pore structures solid particles are effectively circles in two dimension and referred to as grains in the manuscript same as hochstetler et al 2013 this method first randomly generates varisized grains from a truncated lognormal distribution to maintain prescribed porosity secondly the position of each grain is initialized randomly within a given domain permitting overlaps hou et al 2018 finally we iteratively check for overlap of grains and move overlapping grains away from each other until free from overlap meanwhile maintain the periodic boundary condition in perpendicular to the main direction yang et al 1996 the grain geometry following truncated lognormal distribution is designed the mean and standard deviation of grain sizes are set to 2 5 10 5m and 1 5 10 5m respectively with porosity of 0 35 and the pore structure and grain distribution are shown in fig 2 the computational domain 2 mm long and 1 mm wide is automatic discretized with about 4 million degrees of freedom the simulation duration 30 or 60 min depends on the time required for org to flow out of the domain 2 2 3 boundary conditions for flow simulation pressure gradient is fixed to 0 note in real applications it does not mean zero but negligible impact on the system low intensity electrical potential gradient 1 v cm is set between two boundaries by fixing the electric potential at two boundaries u hs is set as slip electroosmotic velocity and grain surface charges are set to zero for transport model all species except noncharged organic species org are set to time varying condition on the inlet and outlet boundaries c org of 0 means it is removed immediately once transferring out of the media the lateral boundaries are periodic all boundary conditions and involved parameters are summarized in table 2 2 2 4 initial conditions the initial concentrations of electrolyte on boundaries c bc and that in the media c bg might be same or different so two kinds of initial condition settings situations are considered situation i is c bc equals c bg c bc and c bg both denote as c b situation ii is that c bc is different from c bg which induces concentration gradient near the boundaries for situation ii finer mesh about 10 times smaller than that for situation i is needed to maintain calculation accuracy therefore a smaller and simplified two dimensional structure is used as the geometry for the simulation the domain is 2 mm long and 0 1 mm wide filled with 9 same ellipse grains long and short axes are 0 095 mm and 0 044 mm respectively with porosity of 0 35 fig 3 two groups of cases are organized based on two c bg denoted as lcb with c bg 0 1 mm hcb with c bg 1 mm to study the influence of prescribed initial concentration each group contains 3 values of c bc therefore totally 6 cases are conducted for situation ii table 3 pk 5 5 and d 0 1 m 1 are chosen to facilitate the comparison with the results of situation i 3 results and discussions to quantify the displacement efficiency of ekr average values of three variables over integral domains are calculated and analyzed average ion concentrations on boundaries c i are 3 1 c i t c i t d ω l ω l average electroosmotic velocity u over the whole domain is 3 2 u t u t d ω s ω s and average concentration of org c org over the whole domain is 3 3 c org t c org t d ω s ω s where ω l and ω s are the boundary and the domain respectively 3 1 results of cases with initial condition of situation i 3 1 1 ion concentrations on boundaries the variable concentrations of h or ph on boundaries with simulation of electrode reactions are denoted as c h a and c h c on anode and cathode sides respectively which are mainly influenced by d and c b but almost not impacted by pk fig 4 the main mechanism of h accumulation on the boundaries is electrolysis process of water rather than h transport so that the influence of pk is weak larger d or c b values result larger extent of ph change the red lines in fig 4a and 4c show that ph changes from 7 0 to 6 7 with d 0 01 m 1 and to 4 4 with d 1 m 1 30 min which means the smaller d can better maintain stable ph on boundary the blue red and green lines in fig 4c show that ph changes from 7 0 to 5 8 4 4 and 3 0 with c b values of 0 1 mm 1 mm and 10 mm respectively due to promoting water electrolysis 30 min from the results of 27 cases in fig 4 one can see that the conditions with d 0 01 m 1 and c b 0 1 mm green lines in fig 4a d indicate smaller enhanced factor and lower concentrations of electrolyte are favorable for stable ph on boundaries a decreases on anode side denoted as c a a and increases on cathode side c a c while b increases on anode c b a and decreases on cathode side c b c by all cases the displayed simulation time is all 30 min for the convenience of discussion fig 5 which are mainly caused by electromigration a and b have consistent concentration before simulation since they have similar diffusion coefficients and the same valence similar concentration increases or decreases are expected however oh and h can be generated from hydrolysis progress which causes a certain degree of ion accumulation a and b are forced to balance the excess oh and h respectively under the coulombic effects which induces inconsistent concentration changes on both sides unlike h the concentrations of a and b varying on boundaries are caused by exchange with media under two mechanisms of electromigration and electroosmosis pk shows significant influence on concentrations of a and b when d 1 m 1 divergent blue lines in fig 5 minor change in ph will result in a small change in electroosmotic flow lower values of d leading to relatively uniform potential gradient through relative stable ph weaken the influence of pk on concentrations of a and b convergent green and red lines in fig 5 for pk 5 5 a sharp varying tendence on cathode side is observed 20 min blue solid lines in fig 5h k cationic a transfers from media to cathode side to balance the negative charge of oh generated by water electrolysis which causes the rapid accumulation in c a c blue solid line in fig 5h to ensure charge electroneutrality sharp decrease in c b c is also caused by ions interaction and the occurrence and increase in reof blue solid line in fig 5k this phenomenon is not obvious on anode side because h has larger value of diffusivity compared with oh table 1 which attenuated the change in c a a and c b a based on the authors literature survey most cases show acid fronts due to lack of h neutralization for pk 3 5 dashed line in fig 5 cationic a has same transport direction of electromigration and electroosmosis which causes the most decrease in c a a and accumulation in c a c transports of anionic b by electromigration and electroosmosis are in opposite direction which weakens the increase and decrease in c b a and c b c respectively for pk 8 5 dash dot lines in fig 5 the initial direction of electroosmotic flow is reof which reversing the varying pattern of concentrations of a and b on boundaries compared with pk of 3 5 higher value of pk essentially shifts the reof at an earlier time causing parts of a and b near the cathode side to move to the anode side by electroosmosis 3 1 2 organic species transport electroosmosis is the key mechanism to control organic species org displacement the velocity below is electroosmotic velocity or eof because of none pressure gradient in the numerical modeling fig 6 cases with d 0 1 m 1 get moderate changes in c h a or c h c fig 4b e for different values of c b and part of cases reach the specified threshold ph 3 5 5 5 8 5 c b affects the electroosmosis by controlling the boundary ph and further amplifies the impact of pk in eof fig 6 it takes 15 60 min for species org to exit the domain along with increase in c b for pk 5 5 solid lines in fig 7 specifically 1 h is needed to displace org when c b 10 mm blue solid lines in fig 7 c org decrease rapidly at early stage 0 20 min corresponding to decrease in u blue solid lines in fig 6 after that c org tends to stagnate at middle stage 21 30 min although with increase in u this stagnation is due to backflow of org caused by occurring of reof and which is gradually dominant after 15 min fig 8 finally c org decrease fast at late stage 31 60 min with org removal from anode boundary the local velocity demonstrates nearly one order of magnitude change during simulation fig 8 u keeps monotonic decrease or increase with pk 3 5 or 8 5 respectively the cases with pk 3 5 show the maximum initial u dashed lines in fig 6 and the shortest retention time of org which is 6 10 min dashed lines in fig 7 and low values of c b can accelerate removal of org by attenuating the change in c h a however in cases with pk 8 5 high values of c b can accelerate discharge of org by strengthening the change in c h a which take approximately 10 min to displace org dash dot lines in fig 7 when d 0 01 m 1 c h c or c h a does not reach the specified threshold ph 3 5 5 5 8 5 to change the direction of u during the simulation periods fig 4a d one can deduce that even the ph can achieve threshold in later time however org could already exit from domain the curves of u are relatively straight and monotonous with small fluctuation range of 3 9 10 6m s fig 9 so that the hypothesis of constant electroosmotic flow coefficient used in some macroscopic formulas can be proper under this condition it can be considered as ph well controlled cases the cases with pk 3 5 show the fastest initial u and best displacement capability which take 6 min to displace org fig 10 when d 1 m 1 the influences of the pk and c b on removal efficiency in terms of the length of displaced time are obvious figs 11 and 12 as we can see from figs 6 7 and 9 12 compared with d 0 01 m 1 and 0 1 m 1 the differences between different lines pks and different colors c b s become significantly larger when d 1 m 1 the cases with pk 5 5 always take longer time 20 60 min to remove org compared with pk 3 5 and 8 5 both take 6 12 min the hypothesis of constant electroosmotic flow coefficient used in some macroscopic formulas is not suitable under this circumstance same as d 0 1 m 1 u keeps monotonous decrease or increase for pk 3 5 and 8 5 respectively figs 5 and 11 there is no monotonous relationship between the value of c b and the displacement efficiency when pk 5 5 the highest c b value 10 mm makes u reach the minimum earliest but the displacement efficiency is better than the cases with 1 mm of c b which is attributed to reof promoting the transport of org this set of simulations reveals the conditions which make the removal efficiency relatively unpredictable in the actual remediation all the factors of pk c b and d obviously impact on transport of org especially the value of pk from this study media with lower pk of 3 5 and higher pk of 8 5 are more suitable for ekr with about 5 10 times faster remove rate nonlinear eof including decreasing eof rate and reverse eof is more likely to occur in cases with pk of 5 5 and higher values of c b and d which can reduce efficiency of ekr by 2 4 times taking 15 20 min when d 0 01 m 1 and 30 60 min when d 1 m 1 3 2 results of cases with initial condition of situation ii as shown in fig 13 a d higher c bc causes larger ph changes on boundaries same as situation i with higher c b as we can see from eq 2 15 higher background ion concentrations on the boundary c bc will induce larger current under same electric potential gradient and a larger current will promote water electrolysis which causes larger h or ph changes the change of u of cases with initial condition of situation ii fig 13b e is more complicated compared to the cases with initial condition of situation i fig 6 at early stage of ekr when large initial concentration gradient exists there will be a gradient equilibrium process this balancing process usually occurs in the early stage of ekr which induces complex change trends of flow rate higher c bc reduces the average velocity at the beginning but the premature electroosmotic flow decrease is not beneficial to the progress of ekr when c bc less than c bg the average electroosmotic flow rate reduces in the early stage of simulation blue lines in fig 13b e with different values of c bg cases with lcb c bg 0 1 mm and hcb c bg 1 mm obtain similar curves of c org and u under the same value of c bc green lines in fig 13b c and read lines in fig 13e f compared with c bg c bc plays more important role in the change of electroosmotic flow rate and displacement efficiency of ekr media with pk 5 5 experience a process of electroosmotic flow decreasing and then increasing a high c bc reduces the average velocity at the beginning but the premature electroosmotic flow decrease is not suitable to the progress of ekr in general using an initial electrolyte concentration which is same or close to the background ion concentration in soil can achieve better removal efficiency both in hcb and lcb conditions fig 13c f when c bc 10 mm in hcb reof causes delay of org transport and takes nearly three times time to complete the displacement the c bg also affects the residual concentration of org in medium and higher c bg 1 mm causes more residue of org during 10 30 min and results in longer time to remove all org 4 conclusions a pore scale numerical simulation with fully coupled flow transport and electric potential fields is developed by combining nernst planck poisson equation navier stokes equation 1 pk model and boundary conditions with electrode reactions totally 33 cases with the settings of 3 c b values 3 pk values 3 enhanced factor values of d and two different initial conditions are simulated the detailed processes of nonlinear eof including variable eof rate cessation of eof even reof are revealed along ekr it is found that all c b pk and d impact eof and the removal efficiency of organic species from this study media with pk of 3 5 and 8 5 are more suitable for ekr with about 5 10 times faster remove rate than media with pk of 5 5 nonlinear eof including decreasing eof rate and reverse eof is more likely to occur in cases with pk of 5 5 and higher values of c b and d which can reduce efficiency of ekr by 2 4 times although the numerical simulations are conducted in pore scale the results could provide some engineering implication for the ekr implementation the properties of contaminated media and the implementation of ekr should be critically assessed in advance to evaluate the influence of pk c b and d on ekr according to this study soils with pk 3 5 and 8 5 are in good conditions for ekr compared that with pk 5 5 the hypothesis of constant electroosmotic flow coefficient used in some macroscopic formulas can be satisfied under well enhanced ekr like d 0 01 m 1 to maintain stable ph in both electrode chambers the electrolyte concentrations in the electrode chambers c bc have an important influence on the removal efficiency using an electrolyte with ion concentration c bc closer to the original background concentrations of ions in soil c bg can help to achieve better removal efficiency using selective permeable membranes and other recirculation strategies to buffer electrolysis reactions generated at the electrodes is recommended which could assist to keep ph at the electrode wells as constant as possible to increase overall performances and reliability of the ekr system the present model evaluates zeta potential based on 1 pk model which is derived from a simple one electron reaction doubly or higher charged ions are common in the environment of water and soil so the model to describe zeta potential involving highly charged ions needs be investigated in the future credit authorship contribution statement ping yang methodology formal analysis visualization writing original draft shujun ye conceptualization supervision writing review editing project administration funding acquisition jianfeng wu methodology writing review editing jichun wu methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we gratefully acknowledge funding from national key r d program of china no 2018yfc1802501 and the national natural science foundation of china no 42077174 all calculations are done in the high performance computing center of nanjing university we thank the anonymous reviewers for their careful review thoughtful comments and insights 
2852,electrokinetic remediation ekr is a promising remediation technology for low permeability porous media contaminated with organic pollutants to reveal the processes of nonlinear electroosmotic flow eof and to elucidate the key factors controlling the efficiency of ekr a process based pore scale numerical model was established nernst planck poisson equation is coupled with navier stokes equation to describe the transport of species 1 pk model is applied to evaluate time varying zeta potential during ekr process totally 33 cases are simulated which include the settings of 3 background concentrations c b of ions in media 3 pk values 3 enhanced factor d corresponding to reciprocal of diameter of electrode well values and two different initial conditions it is found that all of c b pk and d impact eof and the removal efficiency of organic species from this study media with pk of 3 5 and 8 5 are more suitable for ekr with about 5 10 times faster remove rate than media with pk of 5 5 nonlinear eof including decreasing eof rate and reverse eof is more likely to occur in cases with pk of 5 5 and higher values of c b and d which can reduce efficiency of ekr by 2 4 times using an electrolyte with ion concentration closer to the original background concentrations of ions in soil can favour better removal efficiency keywords ekr electroosmosis organic pollutant numerical simulation pore scale data availability no data was used for the research described in the article 1 introduction removing organic contaminants such as chlorinated solvents from the field sites with clayey soil layers remains a big challenge electrokinetic remediation ekr is a promising remediation technology for low permeability porous media contaminated with organic inorganic and mixed pollutants by applying low strength electric field chowdhury et al 2017 gill et al 2014 li and yu 2015 qin et al 2015 souza et al 2017 xu et al 2019 yeung and datla 1995 yeung and gu 2011 which includes three mechanisms of electromigration electroosmosis and electrophoresis electroosmosis is the main mechanism for removing noncharged species ko et al 2000 qiao et al 2018 shi et al 2008 such as organic contaminants like phenol shapiro and probstein 1993 trichlorobenzene qiao et al 2018 and chlorinated ethenes sprocati et al 2020 electromigration is attributed to charged ions directional moving which causes relative slide between the electric double layer edl and the stern layer shear plane and simultaneously drags surrounding fluid carrying noncharged species to flow fig 1 a although directional and stable electroosmotic flow eof is designed and expected the nonlinear eof eof with a variable electroosmotic coefficient or unexpected eof including decreasing eof rate cessation of eof even reverse eof reof happens in many lab and field implementations acar and alshawabkeh 1993 dzenitis 1997 eykholt and daniel 1994 revil 2017 shapiro and probstein 1993 zhang and wang 2015 zhang and wang 2017 which reduces the efficiency of ekr what are major characteristics controlling the unexpected eof and how the nonlinear eof occurs along ekr processes are not well understood complicated and nonlinear ekr process can t be characterized by constant zeta potential ξ which is usually assumed when simulating simplified linear electroosmotic flow vizcaíno et al 2017 rezaee et al 2019 sprocati et al 2020 sun et al 2019 zeta potential might vary with ph and concentrations of ions in pore fluid and the zero point potential ph value pk of media acar and alshawabkeh 1993 crespy et al 2007 masi et al 2017 thormann et al 1998 the most common approach for the modeling of eof in porous media involves solving macroscopic conservation of charge and momentum in macro scale simulation a simplified exponential relationship with a couple of parameters is widely used to depict the relationship between ξ and ph crespy et al 2007 eykholt and daniel 1994 masi et al 2017 however this approach fails to capture flow details that can only be understood at the pore scale alizadeh et al 2019 godinez brizuela and niasar 2020 hlushkou et al 2007 pore scale numerical simulation can reveal detailed ekr process and nonuniform eof hlushkou et al 2007 using lattice boltzmann method lbm demonstrated that the pore scale velocity profile for eof is nonuniform even under most ideal conditions including a uniform distribution of the zeta potential at the solid liquid interface and the absence of applied pressure gradients godinez brizuela and niasar 2020 using pore network modelling approach explored the simultaneous pore scale pressure and electroosmosis driven flow in charged porous media with constant zeta potential alizadeh et al 2019 using lb method found that when the scenario with inhomogeneous charge local surface charge based on local ph and ion concentrations was taken into account the predicted electroosmotic permeability was higher in comparison with the prescribed homogeneous case zhang and wang 2017 established a pore scale numerical model to observe nonlinear eof with inhomogeneous surface charge and nonuniform zeta potential using 1 pk model de lima et al 2010a de lima et al 2010b zhang and wang 2017 assumed a steady condition for the simulation of eof in the soil with pk 5 5 and focused on the impact of ph but put aside the ion concentration from the ek remediation point of view ion concentration and ph in pore fluids and eof itself might change with time along ekr process acar and alshawabkeh 1993 shapiro and probstein 1993 different soils have very different pk values which is a key factor impacting eof acar and alshawabkeh 1993 in addition to ph ion concentration of electrolyte could strongly influence eof acar and alshawabkeh 1993 shapiro and probstein 1993 to the best of authors knowledge solute transport coupling with time and space variable zeta potential to analyze the electrokinetic remediation with nonlinear eof has not been investigated in porous media at pore scale the objective of this study is to reveal the mechanisms of nonlinear eof controlled by pk ph and ion concentration in pore fluids based on a process based pore scale numerical simulation with fully coupled flow concentration and electric potential fields it could help to develop process optimization schemes and pertinent design of ekr field implementations 2 modeling approach 2 1 mathematical models of ekr at pore scale the mathematical models of ekr at pore scale mainly include flow model to describe velocity and pressure 1 pk model to evaluate the variable zeta potential due to the change of ph and ionic strength species transport model to describe species migration and electrode reactions model to involve the electrolysis of water which is included as the boundary conditions of variable ph 2 1 1 flow model the navier stokes nse and the continuity equations are used to describe laminar and incompressible electro osmotic flow in pore scale domains 2 1 ρ u t ρ u u p i μ u u t f 2 2 ρ u 0 where ρ is the density u is the fluid velocity vector p is the pressure i is the direction vector and f is the body force vector introduced by electrical field because the thickness of edl is typically several nanometers appelo 2017 yang and wang 2019 smaller than the characteristic geometric length of media such as low permeable fine sand the charge distribution within edl can be overlooked alizadeh et al 2019 alizadeh et al 2017 coelho et al 1996 godinez brizuela and niasar 2020 peters et al 2016 zhang and wang 2017 hence electrical body force can be replaced by the slip velocity on the media surface dutta and beskok 2001 zhang and wang 2017 helmholtz smoluchowski equation hse is appropriate to be applied as slip velocity u hs 2 3 u hs ε 0 ε r ξ μ e where ε0 is the vacuum dielectric constant εr is the relative permittivity ξ is zeta potential μ is dynamic viscosity e φ and e is the electric field strength φ the potential 2 1 2 1 pk model of zeta potential 1 pk model is used in this study to evaluate the change of ξ during ekr process which considers a single surface protonation deprotonation complexation reaction de lima et al 2010a de lima et al 2010b zhang and wang 2017 2 4 me oh 1 2 h me oh 2 1 2 where me represents a metallic ion lying in the tetrahedral si 4 or octahedral al 3 layers of clay particle surface charge density σ can be expressed in two ways based on 1 pk model 2 5 σ f γ max 2 k c h b exp f ξ rt 1 k c h b exp f ξ rt 1 with k γ me oh 2 1 2 γ me oh 1 2 c h b exp f ξ rt or 8 ε 0 ε r r t c b sinh f ξ 2 r t where γ max γ me oh 2 1 2 γ me oh 1 2 is the maximum surface density γ me oh 2 1 2 and γ me oh 1 2 are the surface density of the complex me oh 2 1 2 and me oh 1 2 respectively site nm2 c h b and c b are the local bulk concentration of hydrogen ion and electrolyte solution respectively mol l r the ideal gas constant t the temperature 298 15 k f the faraday s constant εr relative permittivity ε0 the vacuum dielectric constant zeta potential ξ can be derived from those equations with variable ions concentration and ph de lima et al 2010b 2 6 ξ ln h ln 1 1 h h 2 a h c b 1 2 a h c b rt f where h k c h b 1 10 p h p k a 8 ε 0 ε r r t f γ max and pk is defined as log10k is the isoelectric point according to 1 pk model ξ strongly depends on ph and pk 3 5 5 5 and 8 5 but relative weakly depends on electrolyte solution concentration of c b 0 1 1 and 10 mm fig 1b 2 1 3 species transport model in addition to convection caused by pressure gradient external electric potential gradient can also induce species convection by electro osmotic mechanism nernst planck equation npe considers three main processes diffusion electromigration and convection 2 7 j i d i c i d i c i z i f rt φ u c i where di is the diffusion coefficient ci is the concentration of species zi is the valence of species among that u is controlled by two driving forces pressure and electric potential same as macro scale simulation sprocati et al 2021 sun et al 2019 the governing transport equation of multicomponent species is derived by mass conservation equation 2 8 c i t j i r i where ri is the reactive source sink term poisson s equation pe is used to control potential distribution and maintain electroneutrality of fluid as follows 2 9 2 φ ρ e ε 0 ε r where ρe is charge density ρ e f z i c i combining equations 2 8 and 2 9 generates the so called nernst planck poisson equations nppes which describe the combined transient effects of species transport due to electroosmosis convection diffusion and electromigration of a multicomponent system 2 1 4 electrode reactions the electrode reactions are included to simulate the boundary conditions of variable ph although buffering of electrolysis reactions can achieve better performances as performed by several authors cang et al 2013 vizcaíno et al 2018 xu et al 2020 incomplete neutralization can occur in the actual repair process and our study can provide understanding of these phenomena ignoring the conductivity contribution of media sprocati et al 2019 electric current flux i can be expressed as 2 10 i f i 1 n z i j i where n is the number of charged species the current flux generated by the movement of ions in pore water can be expressed as the sum of each component of total flux as 2 11 i f i 1 n z i d i c i f 2 i 1 n z i 2 d i c i rt φ f u i 1 n z i c i applied electric field causes water electrolysis reactions at the electrodes based on their reduction potentials assuming only water redox reactions happen at electrodes with oxidation reaction at the anode 2 12 o 2 4h 4e 2h 2 o e 0 1 229v and reduction reaction at cathode 2 13 2h 2 o 2e h 2 2oh e 0 0 8277v according to faraday s law the resulting generation fluxes of h and oh j i we at the electrodes can be expressed as 2 14 j h we j oh we i f the size of the electrode chambers used in macroscale simulation influences the changing trends of ph at the boundaries this concept is taken to indicate the extents of ph varying on boundaries under pore scale concentration of species changing with time can be expressed sprocati et al 2019 sun et al 2019 2 15 c i t j i j we d where d 1 m is defined as enhanced factor here at pore scale which is the ratio of cross sectional area to volume of the electrode chamber or reciprocal of diameter of electrode well sprocati et al 2019 sun et al 2019 at macro scale the extents of ph varying at boundaries caused by electrolysis reactions can be controlled by the parameter of d lower d values correspond to the enhanced ekr with better control of ph change ionization of water can be expressed as 2 16 h 2 o h oh ignoring ion activity in relatively low concentration conditions and assuming instantaneous equilibrium of water ionization thermodynamic equilibrium constant can be written as k w c h c oh 10 14 mol2 l2 in 298 15 k this study does not consider the process of ion reduction in solution caused by adsorption all the units of variables are system international units si unless otherwise specified all governing equations are coupled and solved by using a fully coupled solver built in the commercial software comsol multiphysics 5 4 the comsol physics used in our simulation includes creeping flow electrostatics transport of diluted species mathematics for boundary odes and daes and multiphysics coupling which consists of space charge density coupling potential coupling and flow coupling 2 2 numerical simulation five component system is considered which includes 4 ionic species of h oh representative monovalent background ions pair a and b and a noncharged organic species denoted as org each species has its own nppes except oh which is calculated by c oh k w c h to keep constant ionic product of water the space charge density coupling built in comsol multiphysics to define ρe is recoded to include the contribution of oh and maintain electric neutrality the values of parameters in the mathematical models of ekr are listed in table 1 the specific settings of numerical experiments which include settings of three characteristic factors construction of pore structure boundary conditions and initial conditions are presented below 2 2 1 settings of three characteristic factors numerical experiments are conducted with a series of settings of c b pk and d values to investigate the potential control factors of electrokinetic remediation in this study we consider 3 different background ions concentrations c b 0 1 mm 1 mm 10 mm 3 pk values 3 5 5 5 8 5 bray et al 2014 liu et al 2013 zhang and zhang 1992 and 3 values of d 0 01 m 1 0 1 m 1 1 m 1 table 2 2 2 2 construction of pore structure porous media structure plays a critical role in flow and transport processes especially in pore scale simulations although recent advances in computing power and the advantage of parallel computing to solve large problems three dimensional time varying pore scale electrokinetic numerical simulations are still computationally expensive hochstetler et al 2013 zhang and wang 2015 zhang and wang 2017 as depicted in hochstetler et al 2013 two dimensional pore scale porous media models provide useful insight in several situations especially in the case of limited computing power structure properties such as porosity grain size may cause different pollution plume shape under electrokinetic remediation yang et al 1996 proposed a grain packing method which was modified to simulate pore scale two dimensional flow or solute transport hochstetler et al 2013 hou et al 2018 rolle and kitanidis 2014 and same packing method was selected to generate pore structures solid particles are effectively circles in two dimension and referred to as grains in the manuscript same as hochstetler et al 2013 this method first randomly generates varisized grains from a truncated lognormal distribution to maintain prescribed porosity secondly the position of each grain is initialized randomly within a given domain permitting overlaps hou et al 2018 finally we iteratively check for overlap of grains and move overlapping grains away from each other until free from overlap meanwhile maintain the periodic boundary condition in perpendicular to the main direction yang et al 1996 the grain geometry following truncated lognormal distribution is designed the mean and standard deviation of grain sizes are set to 2 5 10 5m and 1 5 10 5m respectively with porosity of 0 35 and the pore structure and grain distribution are shown in fig 2 the computational domain 2 mm long and 1 mm wide is automatic discretized with about 4 million degrees of freedom the simulation duration 30 or 60 min depends on the time required for org to flow out of the domain 2 2 3 boundary conditions for flow simulation pressure gradient is fixed to 0 note in real applications it does not mean zero but negligible impact on the system low intensity electrical potential gradient 1 v cm is set between two boundaries by fixing the electric potential at two boundaries u hs is set as slip electroosmotic velocity and grain surface charges are set to zero for transport model all species except noncharged organic species org are set to time varying condition on the inlet and outlet boundaries c org of 0 means it is removed immediately once transferring out of the media the lateral boundaries are periodic all boundary conditions and involved parameters are summarized in table 2 2 2 4 initial conditions the initial concentrations of electrolyte on boundaries c bc and that in the media c bg might be same or different so two kinds of initial condition settings situations are considered situation i is c bc equals c bg c bc and c bg both denote as c b situation ii is that c bc is different from c bg which induces concentration gradient near the boundaries for situation ii finer mesh about 10 times smaller than that for situation i is needed to maintain calculation accuracy therefore a smaller and simplified two dimensional structure is used as the geometry for the simulation the domain is 2 mm long and 0 1 mm wide filled with 9 same ellipse grains long and short axes are 0 095 mm and 0 044 mm respectively with porosity of 0 35 fig 3 two groups of cases are organized based on two c bg denoted as lcb with c bg 0 1 mm hcb with c bg 1 mm to study the influence of prescribed initial concentration each group contains 3 values of c bc therefore totally 6 cases are conducted for situation ii table 3 pk 5 5 and d 0 1 m 1 are chosen to facilitate the comparison with the results of situation i 3 results and discussions to quantify the displacement efficiency of ekr average values of three variables over integral domains are calculated and analyzed average ion concentrations on boundaries c i are 3 1 c i t c i t d ω l ω l average electroosmotic velocity u over the whole domain is 3 2 u t u t d ω s ω s and average concentration of org c org over the whole domain is 3 3 c org t c org t d ω s ω s where ω l and ω s are the boundary and the domain respectively 3 1 results of cases with initial condition of situation i 3 1 1 ion concentrations on boundaries the variable concentrations of h or ph on boundaries with simulation of electrode reactions are denoted as c h a and c h c on anode and cathode sides respectively which are mainly influenced by d and c b but almost not impacted by pk fig 4 the main mechanism of h accumulation on the boundaries is electrolysis process of water rather than h transport so that the influence of pk is weak larger d or c b values result larger extent of ph change the red lines in fig 4a and 4c show that ph changes from 7 0 to 6 7 with d 0 01 m 1 and to 4 4 with d 1 m 1 30 min which means the smaller d can better maintain stable ph on boundary the blue red and green lines in fig 4c show that ph changes from 7 0 to 5 8 4 4 and 3 0 with c b values of 0 1 mm 1 mm and 10 mm respectively due to promoting water electrolysis 30 min from the results of 27 cases in fig 4 one can see that the conditions with d 0 01 m 1 and c b 0 1 mm green lines in fig 4a d indicate smaller enhanced factor and lower concentrations of electrolyte are favorable for stable ph on boundaries a decreases on anode side denoted as c a a and increases on cathode side c a c while b increases on anode c b a and decreases on cathode side c b c by all cases the displayed simulation time is all 30 min for the convenience of discussion fig 5 which are mainly caused by electromigration a and b have consistent concentration before simulation since they have similar diffusion coefficients and the same valence similar concentration increases or decreases are expected however oh and h can be generated from hydrolysis progress which causes a certain degree of ion accumulation a and b are forced to balance the excess oh and h respectively under the coulombic effects which induces inconsistent concentration changes on both sides unlike h the concentrations of a and b varying on boundaries are caused by exchange with media under two mechanisms of electromigration and electroosmosis pk shows significant influence on concentrations of a and b when d 1 m 1 divergent blue lines in fig 5 minor change in ph will result in a small change in electroosmotic flow lower values of d leading to relatively uniform potential gradient through relative stable ph weaken the influence of pk on concentrations of a and b convergent green and red lines in fig 5 for pk 5 5 a sharp varying tendence on cathode side is observed 20 min blue solid lines in fig 5h k cationic a transfers from media to cathode side to balance the negative charge of oh generated by water electrolysis which causes the rapid accumulation in c a c blue solid line in fig 5h to ensure charge electroneutrality sharp decrease in c b c is also caused by ions interaction and the occurrence and increase in reof blue solid line in fig 5k this phenomenon is not obvious on anode side because h has larger value of diffusivity compared with oh table 1 which attenuated the change in c a a and c b a based on the authors literature survey most cases show acid fronts due to lack of h neutralization for pk 3 5 dashed line in fig 5 cationic a has same transport direction of electromigration and electroosmosis which causes the most decrease in c a a and accumulation in c a c transports of anionic b by electromigration and electroosmosis are in opposite direction which weakens the increase and decrease in c b a and c b c respectively for pk 8 5 dash dot lines in fig 5 the initial direction of electroosmotic flow is reof which reversing the varying pattern of concentrations of a and b on boundaries compared with pk of 3 5 higher value of pk essentially shifts the reof at an earlier time causing parts of a and b near the cathode side to move to the anode side by electroosmosis 3 1 2 organic species transport electroosmosis is the key mechanism to control organic species org displacement the velocity below is electroosmotic velocity or eof because of none pressure gradient in the numerical modeling fig 6 cases with d 0 1 m 1 get moderate changes in c h a or c h c fig 4b e for different values of c b and part of cases reach the specified threshold ph 3 5 5 5 8 5 c b affects the electroosmosis by controlling the boundary ph and further amplifies the impact of pk in eof fig 6 it takes 15 60 min for species org to exit the domain along with increase in c b for pk 5 5 solid lines in fig 7 specifically 1 h is needed to displace org when c b 10 mm blue solid lines in fig 7 c org decrease rapidly at early stage 0 20 min corresponding to decrease in u blue solid lines in fig 6 after that c org tends to stagnate at middle stage 21 30 min although with increase in u this stagnation is due to backflow of org caused by occurring of reof and which is gradually dominant after 15 min fig 8 finally c org decrease fast at late stage 31 60 min with org removal from anode boundary the local velocity demonstrates nearly one order of magnitude change during simulation fig 8 u keeps monotonic decrease or increase with pk 3 5 or 8 5 respectively the cases with pk 3 5 show the maximum initial u dashed lines in fig 6 and the shortest retention time of org which is 6 10 min dashed lines in fig 7 and low values of c b can accelerate removal of org by attenuating the change in c h a however in cases with pk 8 5 high values of c b can accelerate discharge of org by strengthening the change in c h a which take approximately 10 min to displace org dash dot lines in fig 7 when d 0 01 m 1 c h c or c h a does not reach the specified threshold ph 3 5 5 5 8 5 to change the direction of u during the simulation periods fig 4a d one can deduce that even the ph can achieve threshold in later time however org could already exit from domain the curves of u are relatively straight and monotonous with small fluctuation range of 3 9 10 6m s fig 9 so that the hypothesis of constant electroosmotic flow coefficient used in some macroscopic formulas can be proper under this condition it can be considered as ph well controlled cases the cases with pk 3 5 show the fastest initial u and best displacement capability which take 6 min to displace org fig 10 when d 1 m 1 the influences of the pk and c b on removal efficiency in terms of the length of displaced time are obvious figs 11 and 12 as we can see from figs 6 7 and 9 12 compared with d 0 01 m 1 and 0 1 m 1 the differences between different lines pks and different colors c b s become significantly larger when d 1 m 1 the cases with pk 5 5 always take longer time 20 60 min to remove org compared with pk 3 5 and 8 5 both take 6 12 min the hypothesis of constant electroosmotic flow coefficient used in some macroscopic formulas is not suitable under this circumstance same as d 0 1 m 1 u keeps monotonous decrease or increase for pk 3 5 and 8 5 respectively figs 5 and 11 there is no monotonous relationship between the value of c b and the displacement efficiency when pk 5 5 the highest c b value 10 mm makes u reach the minimum earliest but the displacement efficiency is better than the cases with 1 mm of c b which is attributed to reof promoting the transport of org this set of simulations reveals the conditions which make the removal efficiency relatively unpredictable in the actual remediation all the factors of pk c b and d obviously impact on transport of org especially the value of pk from this study media with lower pk of 3 5 and higher pk of 8 5 are more suitable for ekr with about 5 10 times faster remove rate nonlinear eof including decreasing eof rate and reverse eof is more likely to occur in cases with pk of 5 5 and higher values of c b and d which can reduce efficiency of ekr by 2 4 times taking 15 20 min when d 0 01 m 1 and 30 60 min when d 1 m 1 3 2 results of cases with initial condition of situation ii as shown in fig 13 a d higher c bc causes larger ph changes on boundaries same as situation i with higher c b as we can see from eq 2 15 higher background ion concentrations on the boundary c bc will induce larger current under same electric potential gradient and a larger current will promote water electrolysis which causes larger h or ph changes the change of u of cases with initial condition of situation ii fig 13b e is more complicated compared to the cases with initial condition of situation i fig 6 at early stage of ekr when large initial concentration gradient exists there will be a gradient equilibrium process this balancing process usually occurs in the early stage of ekr which induces complex change trends of flow rate higher c bc reduces the average velocity at the beginning but the premature electroosmotic flow decrease is not beneficial to the progress of ekr when c bc less than c bg the average electroosmotic flow rate reduces in the early stage of simulation blue lines in fig 13b e with different values of c bg cases with lcb c bg 0 1 mm and hcb c bg 1 mm obtain similar curves of c org and u under the same value of c bc green lines in fig 13b c and read lines in fig 13e f compared with c bg c bc plays more important role in the change of electroosmotic flow rate and displacement efficiency of ekr media with pk 5 5 experience a process of electroosmotic flow decreasing and then increasing a high c bc reduces the average velocity at the beginning but the premature electroosmotic flow decrease is not suitable to the progress of ekr in general using an initial electrolyte concentration which is same or close to the background ion concentration in soil can achieve better removal efficiency both in hcb and lcb conditions fig 13c f when c bc 10 mm in hcb reof causes delay of org transport and takes nearly three times time to complete the displacement the c bg also affects the residual concentration of org in medium and higher c bg 1 mm causes more residue of org during 10 30 min and results in longer time to remove all org 4 conclusions a pore scale numerical simulation with fully coupled flow transport and electric potential fields is developed by combining nernst planck poisson equation navier stokes equation 1 pk model and boundary conditions with electrode reactions totally 33 cases with the settings of 3 c b values 3 pk values 3 enhanced factor values of d and two different initial conditions are simulated the detailed processes of nonlinear eof including variable eof rate cessation of eof even reof are revealed along ekr it is found that all c b pk and d impact eof and the removal efficiency of organic species from this study media with pk of 3 5 and 8 5 are more suitable for ekr with about 5 10 times faster remove rate than media with pk of 5 5 nonlinear eof including decreasing eof rate and reverse eof is more likely to occur in cases with pk of 5 5 and higher values of c b and d which can reduce efficiency of ekr by 2 4 times although the numerical simulations are conducted in pore scale the results could provide some engineering implication for the ekr implementation the properties of contaminated media and the implementation of ekr should be critically assessed in advance to evaluate the influence of pk c b and d on ekr according to this study soils with pk 3 5 and 8 5 are in good conditions for ekr compared that with pk 5 5 the hypothesis of constant electroosmotic flow coefficient used in some macroscopic formulas can be satisfied under well enhanced ekr like d 0 01 m 1 to maintain stable ph in both electrode chambers the electrolyte concentrations in the electrode chambers c bc have an important influence on the removal efficiency using an electrolyte with ion concentration c bc closer to the original background concentrations of ions in soil c bg can help to achieve better removal efficiency using selective permeable membranes and other recirculation strategies to buffer electrolysis reactions generated at the electrodes is recommended which could assist to keep ph at the electrode wells as constant as possible to increase overall performances and reliability of the ekr system the present model evaluates zeta potential based on 1 pk model which is derived from a simple one electron reaction doubly or higher charged ions are common in the environment of water and soil so the model to describe zeta potential involving highly charged ions needs be investigated in the future credit authorship contribution statement ping yang methodology formal analysis visualization writing original draft shujun ye conceptualization supervision writing review editing project administration funding acquisition jianfeng wu methodology writing review editing jichun wu methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we gratefully acknowledge funding from national key r d program of china no 2018yfc1802501 and the national natural science foundation of china no 42077174 all calculations are done in the high performance computing center of nanjing university we thank the anonymous reviewers for their careful review thoughtful comments and insights 
2853,accurate understanding the spatiotemporal variability of snow cover and snow phenology over high mountain asia hma is of great interest because of their vital impacts on the hydrological processes global climate system and regional water resource management this study investigates the spatiotemporal variability of snow covered extent sce snow covered days scd snow onset date sod snow end date sed and snow duration days sdd of hma using the daily cloud free moderate resolution imaging spectroradiometer modis snow cover products from the hydrological year 2002 to 2020 the vertical difference of the effect of elevation on snow phenology and the response of snow phenology to climate change are explored the results indicate that the monthly sce over the whole hma exhibited a slight decreasing in most months over the study period the variability of snow cover and snow phenology over the whole hma generally showed decreased scd significant decrease accounts for 15 73 delayed sod significant delay accounts for 14 35 advanced sed significant advance accounts for 15 46 and shortened sdd significant shorten accounts for 16 01 it is worth noting that the snow cover in the west himalaya was enhancing with its increased sce increased scd and lengthened sdd there is an elevation dependence of snow phenology changes over hma with the high altitude mountain ranges generally having a higher scd earlier sod later sed and longer sdd than low altitude areas the air temperature of snow accumulation period is the dominant factor affecting the interannual variation of sod and the air temperature of snow melt period is the dominant factor affecting the interannual variation of sed the increase of air temperature leads to the delayed sod advanced sed and shortened sdd keywords snow cover modis snow phenology high mountain asia climate change data availability data will be made available on request 1 introduction snow cover is a critical component of both the global energy and water cycles covering about 40 to 50 of the northern hemisphere during winter dietz et al 2012a due to its high albedo and high emissivity as well as low thermal conductivity snow cover has a large scale cooling effect on the global climate system through strong interaction with the surface energy budget brown and mote 2009 dong 2018 groisman et al 1994 kang et al 2010 you et al 2020 moreover as the natural solid water reservoir of the cryosphere snow cover provides more than one sixth of the world s population with fresh drinking water through snowmelt and further supports other uses such as hydropower generation irrigation and industry barnett et al 2005 bormann et al 2018 seasonal snow cover in high latitude and altitude regions in the northern and southern hemispheres is very sensitive to climate change rising air temperature will inevitably affect the changes of snow accumulation and melting processes which can be exhibited through the snow phenology variations in contrast the change in snow state will have feedback on climate through snow albedo from the snow phenology we can get insight of the impact of climate change on cryospheric system according to the sixth assessment report of the intergovernmental panel on climate change ipcc ar6 masson delmotte et al 2021 the climate warming is still continuously ongoing and the global surface temperature in the first two decades of the 21st century 2001 2020 was 0 99 0 84 1 10 c higher than 1850 1900 in this climate change context the snow covered extent sce in the northern hemisphere has undergone significant reductions over the past decades and this trend will continue brown and robinson 2011 fox kemper et al 2021 hock et al 2019 hori et al 2017 meanwhile snow covered days scd and snow phenology parameters including snow onset date sod snow end date sed and snow duration days sdd have also experienced notable changes chen et al 2015 peng et al 2013 previous studies have given considerable attention to studying the variations in snow cover and their causes based on both the satellite remote sensing data and in situ observations at multiple spatial scales including the hemispherical chen et al 2015 choi et al 2010 peng et al 2013 continental sun et al 2020 zeng et al 2018 zhang and ma 2018 and regional li et al 2020b tang et al 2017 wang et al 2017 xiong et al 2017 yi et al 2021 scales compared to limited field survey and snowfall data recorded at the meteorological stations the use of satellite remote sensing data including optical remote sensing data and passive microwave data to monitor the snow phenology dynamics is a mainstream approach chen et al 2015 huang et al 2016 wang et al 2017 xiong et al 2017 yang et al 2019 zhang and ma 2018 among them there are remote sensing products with coarse resolution like 25 km or with multi day composites like 8 day composites which make it difficult to capture the continuous state of snow cover accurately in contrast the daily snow cover product generated from the moderate resolution imaging spectroradiometer modis has the advantages of high spectral resolution high temporal resolution wide spatial coverage and being freely available which provide an excellent opportunity to study the snow cover for global or large scale areas the variation of snow cover has strong spatial and temporal heterogeneity which varies with the study area and time for example chen et al 2015 found contrasting changes in snow phenology with increased snow cover duration in the northern middle latitudes and decreased snow cover duration in high latitudes from 2001 to 2014 huang et al 2016 found scd and snow depth sd have decreased in the north of xinjiang province china while increasing on the southwest edge and in the southeast part of the tibetan plateau from december 2000 to november 2014 tang et al 2017 found 26 39 and 34 26 of the tienshan mountains showed declining and increasing trend in scd respectively ackroyd et al 2021 found snow cover of high mountain asia hma was in decline which was most pronounced in elevation bands where snow is most likely to be present and most needed to sustain glaciers wang et al 2017 found no widespread decline in snow cover over the tibetan plateau from 2000 to 2015 using modis snow cover products yang et al 2019 found the regional diversities in snow phenology in the tienshan mountains with shortened sdd in high altitude regions and the fergana valley while increased sdd in the ili valley and upper reaches of the chu and aksu rivers from 1979 to 2016 xiong et al 2017 found the snowmelt onset date was becoming earlier in hma region during 1988 2015 except the karakorum mountains and part of the western kunlun mountains tang et al 2020 found the snowline altitude at the end of melting season of hma generally showed a rising trend in the recent years 2001 2016 which exhibits the snow cover dynamics in the altitudinal direction deng et al 2021 found the snowline altitude over the tienshan mountains generally showed an increasing trend from 2001 to 2019 the inconsistency between study region time frame and scale makes it a challenge for understanding where and how snow cover is changing hma is the third largest cryosphere on earth outside of the earth s polar regions known as the third pole of the earth the birthplace of many great rivers known as water tower of asia immerzeel et al 2020 immerzeel et al 2010 and the core area of the silk road economic belt as one of the most sensitive and prominent regions responding to global climate changes hma has experienced a considerable warming trend and the components of cryosphere such as snow cover and glaciers have been rapid shrinking over the last decades brun et al 2017 hock et al 2019 hu et al 2014 kraaijenbrink et al 2021 zhan et al 2017 impacts of climate change on the cryosphere strongly led to changes in mountainous hydrological processes and water resources and increased the hma s runoff due to the accelerated glacier snowmelt chen et al 2017 duethmann et al 2015 li et al 2020a lutz et al 2014 previous studies mainly focused on changes in the snow cover extent and snow depth while the integrated analysis about spatiotemporal patterns of snow phenology in the whole of hma is also extremely necessary in addition elevation is presumed to be the dominant factor affecting snow cover in mountainous regions tong et al 2009 wang et al 2022 and the role of air temperature and precipitation in snow cover variations can also differ according to elevation zones therefore it is necessary to make an investigation on the vertical difference of the relation of elevation to snow phenology and the potential influence of climate factors on snow phenology variations in hma this knowledge is critical for assessing and projecting the future climate in addition to better understand the changes in snow cover and snow phenology the mechanisms driving them and their impacts on the earth s climate system both the entire study area and the sub regional scale of the hma are currently needed the focus of this study is the detection and exhaustive analysis of spatiotemporal variability of the latest snow cover and snow phenology over hma using the daily cloud free modis snow cover products the main objectives of this study are to 1 extract the snow cover parameters sce scd sod sed and sdd and analyse their spatiotemporal variations 2 reveal the vertical difference of the relation of elevation to snow phenology 3 to investigate the potential influence of climate factors on snow phenology variations 2 materials 2 1 geographic region the hma 64 107 e and 22 47 n encompasses the tibetan plateau and the adjacent mountain ranges tien shan pamir hindu kush and karakoram in the west the himalayas in the south and southeast and qilian shan in the east khanal et al 2021 fig 1 with an average elevation of more than 4000 m it constitutes the largest glacierized and snow covered regions outside of the earth s polar regions as well as the headwater area of the main river basins syr darya amu darya indus ganges brahmaputra yangtze and yellow providing a major source of water for approximately 1 4 billion of inhabitants in the downstream low lying plains immerzeel et al 2010 khanal et al 2021 shean et al 2020 in the context of global warming the hma cryosphere has indeed undergone considerable change the estimated 118200 km2 of glaciated area has been rapidly retreating and losing mass over the past decades brun et al 2017 gardner et al 2013 which has both impacted local communities and has contributed to global sea level rise gardner et al 2013 the hma has become a hotspot for global climate change and cryospheric change researches in this study the hma with an elevation greater than 1500 m is the focus of our analysis with a total area of about 5 14 106 km2 and the hma is divided into 15 subregions according to the version 6 of the randolph glacier inventory rgi 6 0 arendt et al 2017 2 2 dataset 2 2 1 modis snow cover products the modis terra and modis aqua daily snow cover products mod10a1 and myd10a1 version c6 during 2002 2021 from nasa s eosdis earthdata https earthdata nasa gov search are utilized in this study the version c6 product includes a range of improvements in the snow cover algorithms and provides two new layers ndsi snow cover and raw ndsi in place of the two layers binary snow cover and fractional snow cover fsc in the version c5 product nine tiles i e h23v04 h23v05 h24v04 h24v05 h24v06 h25v05 h25v06 h26v05 and h26v06 are required to cover the whole study area the modis reprojection tool dwyer and schmidt 2006 is used to mosaic each of the nine tiles via nearest neighbor resampling method and reproject the primitive sinusoidal projection into a geographic projection using the wgs84 coordinate system and 0 005 about 500 m resolution the final mosaiced images are converted to geotiff file format furthermore the original myd10a1 and mod10a1 products are reclassified for further analysis with only two value ranges remaining 1 ndsi snow cover values of 0 100 inland water and ocean are set to 0 2 cloud gap values of 250 cloud gap includes the original descriptions of cloud detector saturated missing data night and no decision 2 2 2 meteorological data the era5 is the latest released fifth generation reanalysis from the european center for medium range weather forecasts ecmwf covering the time period from january 1 1979 to near real time hersbach et al 2020 although there are not yet any explicit studies of era5 performance over the larger hma it has been shown that era5 has better applicability in the tibetan plateau compared to other climate reanalysis data huai et al 2021 kraaijenbrink et al 2021 liu et al 2021 era5 land is a replay of the land component of the era5 climate reanalysis with a finer spatial resolution 0 10 than era5 monthly averaged data on single levels from 1979 to the present 0 25 chen et al 2021 muñoz sabater 2019 to survey the linkages between the snow phenology and climate change the monthly averaged 2 m air temperature and total precipitation are extracted from the era5 land reanalysis dataset from 2002 to 2021 2 2 3 auxiliary data the daily sd observed by 44 meteorological stations during 2002 2013 are used to extract the ground observed snow phenology and are employed as ground truth to verify the performance of the snow phenology retrieved by daily cloud free modis ndsi product all the sd observations are produced by the national meteorological information center and the tibet meteorological bureau china https data tpdc ac cn zh hans data 72d6dadf 8e1c 458b b24e 91539042dfe6 chu et al 2018 national meteorological information center tibet meteorological bureau 2018 based on the observation guidelines of china meteorological administration 2003 if at least half of the observation fetch of the station is covered by snow the sd is measured by a ruler and then rounded to the nearest integer in centimeters i e the lowest sd value is 1 cm for a snow cover day china meteorological administration 2003 the released sd data have been quality controlled and homogenized including evaluations of the climatological limit station or regional extremes internal consistency and temporal and spatial consistency the distribution of the selected sd observations is shown in fig 1 the shuttle radar topography mission srtm digital elevation model dem data srtm v4 90 m is freely available from cgiar consortium for spatial information cgiarcsi https srtm csi cgiar org the resolution of the dem is resampled to 500 m in order to remain consistent with the modis data 3 methodology 3 1 cloud removal of the daily modis ndsi product the extensive cloud cover over snow covered region is a critical issue that greatly limits the applications of the modis snow cover product to monitor the snow cover since clouds have the rapidly changing daily shifting features and snow changes gradually over time tang et al 2013 used the cubic spline interpolation algorithm to eliminate the cloud contaminated pixels and filled the gaps under the cloud contaminated pixels successfully in modis fsc product in this study the same cloud gap filling strategy is used with the addition of the combination of mod10a1 and myd10a1 for the daily cloud free modis ndsi product generation from 2002 to 2021 3 1 1 combination of mod10a1 and myd10a1 because of the different overpass time of mod10a1 and myd10a1 and the characteristics of cloud movement it is an opportunity to replace the cloud pixels with non cloud pixels after combining the two products on the same day the strategy is that if a cloud pixel is present in mod10a1 but non cloud is observed in myd10a1 then the pixel is replaced with the non cloud pixel accordingly the combination procedure of the two products can be completely explained by eq 1 gafurov and bárdossy 2009 parajka and blöschl 2008 1 s i j t min m o d i j t m y d i j t where i and j are the row and column of modis ndsi product grid respectively t is the day index of pixel s and mod and myd show pixels of mod10a1 and myd10a1 respectively in this combination procedure the pixels that are identified as clouds in mod10a1 but observed as snow land or water in myd10a1 will be automatically replaced with the same pixel from the myd10a1 the min function can implement this replacement by comparing the new classification value of cloud pixels with that of other class pixels because the new classification value of cloud pixels is the highest value 3 1 2 cloud gap filling method after completing the above combination process the cubic spline interpolation algorithm is used to reconstruct the ground information ndsi value of the cloud gaps caused by clouds or other reasons specifically each cloud pixel in combination images is interpolated to ndsi value using the cubic spline interpolation algorithm based on the observations ndsi value of cloud free days if the interpolated value 0 then reassign it with 0 and if the interpolated value greater than 100 then reassign it with 100 0 ndsi snow cover 100 3 1 3 accuracy assessment based on cloud assumption the validation of cloud gap filling method based on in situ sd observations may not provide a comprehensive view of the whole study area thus the mod10a1 myd10a1 combination product of 12 days i e february 5 april 7 july 31 and november 4 of 2018 february 16 april 12 august 12 and december 8 of 2019 march 27 may 23 september 17 and november 10 of 2020 during 2018 2020 are considered to be reference true ndsi images in this study in these images the ndsi values of the pixels under clear sky conditions are considered as the true values for assessing the cloud gap filling method then the 12 true ndsi images are assumed to be completely covered by clouds i e the pixel value is 250 simultaneously the 12 masked cloud images are reconstructed again using the cloud gap filling method and the results i e the simulated ndsi values are compared with the reference true ndsi values two performance evaluation metrics i e mean absolute error mae eq 2 and root mean square error rmse eq 3 are calculated as follows 2 mae i 1 n c i s i n 3 rmse i 1 n c i s i 2 n where ci and si are the simulated value and true value respectively n is the total number of pixels with true values additionally the cloud persistence days cpd of each cloud pixel is calculated based on the daily mod10a1 myd10a1 combination image during 2018 2020 the cpd represents the number of consecutive days of cloud observed for a pixel from the last cloud free observation to the next cloud free observation the cpd map is convenient to assess the accuracy of the cloud gap filling method under different cpd conditions 3 2 snow cover parameters retrieval five snow cover parameters sce scd and including snow phenology parameters sod sed sdd are derived from the daily cloud free modis ndsi product during the hydrological year of 2002 2020 the hydrological year was set from 1st september to 31th august of the following year zhang et al 2021 found a region wide optimal ndsi threshold for binary snow cover estimation on the tibetan plateau of 0 29 which has better accuracy than the global reference ndsi threshold of 0 4 proposed by previous studies dozier et al 2008 hall et al 1995 hall et al 2002 thus the image pixels with ndsi 0 29 are considered as snow covered pixels in the extraction of snow parameters in this study 3 2 1 sce and scd estimations the scd is calculated as the number of days a pixel is covered by snow in a hydrological year wang and xie 2009 following eq 4 4 scd i 1 n ceil d i 0 29 where n is the total number of days images within a hydrological year and di is ndsi in a pixel 0 di 1 ceil di 0 29 counts the numbers of di 0 29 for instance if the pixel value on the image is 0 6 then the scd adds 1 if the pixel value on the image is 0 1 then the scd adds 0 3 2 2 snow phenology estimation and validation during a hydrological year the sod is defined as the first date of the first five continuous snow cover days the sed is defined as the last date of the last five continuous snow cover days the sdd is defined as the duration days from sod to sed fig 2 shows a schematic diagram of the definition of snow phenology this continuous five days method can reduce the influence of ephemeral snow cover on the snow phenology calculation and is widely adopted to extract snow phenology parameters in previous studies chen et al 2015 choi et al 2010 peng et al 2013 sun et al 2020 wang et al 2022 yang et al 2019 although there are large differences in the spatial representation of snow phenology parameters retrieved by modis and in situ observations in situ observations still provide the most convincing results when compared with modis considering that much of the snow depth is relatively thin and fragmented in hma especially on the tibetan plateau most of previous studies took 1 cm as the threshold and that it may represent a wider range of snow conditions huang et al 2011 ke et al 2016 ma et al 2020 zhang et al 2019 therefore the snow cover determination rules based on sd observations sd greater than or equal to 1 cm is viewed as snow cover is used to extract the ground observed snow phenology in this study the two performance evaluation metrics mae and rmse are used to evaluate the accuracy of snow phenology parameters retrieved by modis relative to sd observations during 2002 2013 3 3 statistical analyses to assess the temporal trends and trend significance of the snow phenology parameters and climate factors for the period from the hydrological year 2002 to 2020 the sen s slope and mann kendall test are adopted sen s slope is used to estimate the magnitude of trends in snow phenology parameters and climate factors the advantage of sen s slope is to deal with data of non normal distribution and it is used instead of a linear regression because it limits the influence that the outliers have on the slope hirsch et al 1982 sen 1968 sen s slope calculation is shown by eq 5 5 β median x j x i j i 1 i j n where β is the trend slope of the time series median is the median function n is the number of the years notes when β 0 the series has an increasing trend when β 0 the series has an insignificant trend when β 0 the series has a decreasing trend the m k test is used to assess the temporal significance of trends in snow phenology parameters and climate factors it is a nonparametric method of monotonic trends that has successfully been applied to detect trends in a time series in meteorology and hydrology hamed 2008 li et al 2011 yue et al 2002 the calculation formula is as follows 6 s i 1 n 1 j i 1 n sgn x j x i sgn x j x i 1 x j x i 0 x j x i 1 x j x i 1 i j n 7 z s 1 v a r s s 0 0 s 0 s 1 v a r s s 0 var s n n 1 2 n 5 18 where n is the number of the years notes the statistical significance of the temporal trend is assumed by the z value when z 1 28 1 64 2 32 the significance tests with 90 95 and 99 confidence levels i e p 0 1 0 5 0 01 are passed respectively the change trend of snow cover and snow phenology is tested at the 90 significance level in this study the pearson correlation coefficient is performed for correlation analysis between snow phenology parameters and climate factors the pearson correlation coefficient calculation is shown by eq 8 in addition the main controlling factor influencing the change in snow phenology is defined as if the correlation between snow phenology and air temperature is significant and the correlation with precipitation is not significant then the pixel shows that air temperature is the main control factor if the correlation between snow phenology and precipitation is significant and the correlation with air temperature is not significant then the pixel shows that precipitation is the main control factor and if the correlations between snow phenology and air temperature precipitation are all significant then the correlation coefficient values are compared 8 r i 1 n x i x y i y i 1 n x i x 2 i 1 n y i y 2 where r is the pearson correlation coefficient n is the number of the years x represents snow phenology parameters y represents climate factors the correlation coefficient r is tested at the 95 significance level in this study 4 results 4 1 accuracy validation results 4 1 1 comparison of mod10a1 myd10a1 combination result the combination of mod10a1 and myd10a1 based on a daily perspective can reduce cloud cover taking 10 february 2019 as an example the mod10a1 observes 62 2 cloud coverage fig 3 a whereas the myd10a1 after a time shift of a few hours observes 63 5 cloud coverage fig 3b after the combination of mod10a1 and myd10a1 products the cloud coverage reduces to 47 7 i e 14 5 and 15 8 less than the mod10a1 and myd10a1 products respectively fig 3c effectively removing some cloud cover in addition the situation of cloud coverage before and after combination for the whole study area in the year 2019 is displayed in fig 3d it can be seen that the extensive cloud cover especially during the winter seriously limits the monitoring of snow cover dynamics the mod10a1 and myd10a1 have high cloud coverage averaging 48 7 and 56 6 respectively after the combination the average cloud coverage decreases to 39 8 and the maximum cloud coverage reduction could reach 36 3 12 april 2019 4 1 2 effectiveness of the cloud gap filling method fig 4 presents the mean frequency of cpd and cloud removal accuracy under different cpd conditions it can be seen that the frequency of the cpd reduces gradually as the increasing of cpd value and the frequency of cpd within 5 d and 15 d for the cloud covered pixels reach 73 55 and 94 96 respectively the accuracy of the cloud gap filling method is influenced by cpd with the mae and rmse increase as the rising of cpd fig 4b this method has very high accuracy with mae and rmse 0 08 and 0 15 respectively when cpd 5 d it can bring relatively greater error with mae and rmse greater than 0 15 and 0 25 respectively when cpd is larger than 20 days but this situation is very rare fig 4a the overall mae and rmse of the cloud gap filling method using the frequency of cpd as the weight fig 4a are 0 054 and 0 125 respectively these indicate that the cloud gap filling method has the efficient performance in terms of accuracy to fill in the missing data due to cloud obscuration or swath gaps fig 5 shows the comparisons of mod10a1 myd10a1 combination map modis ndsi map from the cloud gap filling method and cpd map over the whole region on 25 april 2020 using the cloud gap filling method for each cloud covered pixel on 25 april 2020 the ndsi value is effectively retrieved fig 5b the corresponding cpd map fig 5c probably reflects the confidence of the retrieved ndsi data at each pixel the cpd of most cloud covered pixels is 6 days 4 1 3 validation of snow phenology based on in situ sd observations the snow phenology parameters sod sed sdd retrieved from the daily cloud free modis ndsi product are evaluated by the observed snow depth of 44 meteorological stations from 2002 to 2013 as shown in fig 6 the average sod sed and sdd retrieved by modis are well consistent with the ones extracted based meteorological stations the values of mae are controlled within 13 d and the r values are acceptable for all snow phenology parameters the difference in the two extraction results may be caused by the coarse spatial resolution of the modis product which cannot completely capture and reflect the real value of sod sed and sdd at a specific location 4 2 spatiotemporal patterns of snow cover fig 7 a shows the perennial annual average scd from the hydrological year 2002 to 2020 which reflects the extremely uneven distribution of the snow cover in hma the area with the scd of over 60 d is regarded as the stable snow covered area and the source of the water resource occupying about 33 83 of the whole study area and the areas of high scd are primarily distributed in high altitude mountain ranges such as tien shan karakoram kunlun qilian shan hengduan shan and himalayas the areas of low scd scd 20 d are primarily distributed in the interior of the plateau and low altitude areas around the tibetan plateau accounting for 41 74 of the whole study area fig 7b and 7c show strong seasonal fluctuations in sce for most subregions and the whole hma for areas with very little water vapor such as kunlun qilian shan inner tibet and s and e tibet their sce are relatively low and the seasonal variations are not significant in addition the high sce is mainly concentrated from december to january during this period the large standard deviations of sce reflect the high interannual variability in the end of snow melting july august the sce fluctuates slightly and maintains the lowest level with a relatively small interannual variability the spatial patterns of monthly snow cover over the hma exhibit large spatial differences fig 8 and corresponds well with the distribution of scd fig 7a the annual variation of snow cover can be expressed as three stages 1 snow accumulation period from september to january in which the sce continue to expand from high altitude mountains to valleys and plains 2 snowmelt period from february to june in which the sce gradually decrease from plains to high mountains and 3 perennial snow cover appearing stage july august in which the perennial snow cover almost exclusively distributes on the top of high mountains in the study area in addition the interannual variations of scd and sce are displayed in fig 9 and table 1 respectively it is shown that the decreased scd accounts for 59 60 of the snow covered area fig 9 the decreases are significant in 15 73 of the snow covered area p 0 1 mainly concentrated in the west tien shan kun lun central and east himalaya and hengduan shan with the change trend of approximately 1 62 d a moreover the area with increased scd accounts for 36 20 of the snow covered area and the increases are significant in only 5 42 of the snow covered area these areas are scattered in the east tien shan west himalaya and south and east tibet with the change trend of approximately 1 68 d a these results indicate that the scd exhibits an overall decreasing trend over hma the monthly sce over the whole hma shows a declining but not significant trend in most months table 1 the interannual variations of monthly sce vary in different subregions for example the monthly sce in the tien shan both west tien shan and east tien shan is declining except for the may july months in contrast the monthly sce in the west himalaya and central himalaya show an increasing trend in most months 4 3 spatiotemporal patterns of snow phenology 4 3 1 spatial distribution of snow phenology fig 10 illustrates the spatial distributions of the perennial annual average sod sed and sdd of hma the pixels which have not over 19 years of effective snow phenology detection are considered as snow free pixels overall the snow phenology over the hma presents extremely spatial heterogeneity the sod is mainly concentrated in september december while the sed is mainly concentrated in march june in high altitude mountain ranges such as tien shan karakorum west kunlun himalayas and hengduan shan the sod generally starts earlier the sed appears later and the sdd tends to be longer however there are later sod earlier sed and shorter sdd in the low altitude areas like the hinterland of the tibetan plateau and the peripheral area of the hindu kush 4 3 2 interannual variation of snow phenology not only are changes in the snow phenology spatially complex but they exhibit distinct temporal heterogeneity as well fig 11 table 2 as seen in the interannual variation of sod fig 11a fig 11b the sod in most areas of hma is predominantly delayed approximately 14 35 of the snow covered area in the study area shows significantly delayed sod p 0 1 with the change trend of approximately 2 32 d a mainly distributed in the central and east himalaya the area with significantly advanced sod with the change trend of approximately 1 53 d a accounts for about 9 30 of the snow covered area sparsely distributed in the low altitude areas around the tien shan and west himalaya for the interannual variation of the sed fig 11c fig 11d it can be seen that the sed in most areas of hma is predominantly advanced approximately 15 46 of the snow covered area shows significantly advanced sed with the change trend of approximately 1 69 d a primarily distributed in the tien shan and hengduan shan the area with significantly delayed sed with the change trend of approximately 2 14 d a accounts for only 6 35 of the snow covered area scattered in the east tien shan central himalaya and central tibetan plateau as far as the interannual variation of the sdd is concerned fig 11e fig 11f an overall shortened trend is found in most areas of hma the sdd changes are significantly related to both sod and sed variations more specifically approximately 16 01 of the snow covered area shows significantly shortened sdd with the change trend of approximately 3 33 d a mainly concentrated in the karakoram west tien shan central and east himalaya and hengduan shan however only 5 41 of the snow covered area shows significantly lengthened sdd with the change trend of approximately 2 81 d a sparsely distributed in the east tien shan and west himalaya table 2 further examines the significant changes of sod sed and sdd for different subregions of particular note is the sod in the tien shan and hissar alay are mainly advanced while all other subregions are delayed except for the west himalaya central himalaya and inner tibet the sed of the other subregions are significantly advanced in addition the sdd of all subregions are significantly shortened 4 4 the vertical difference of the relation of elevation to snow phenology to quantitatively describe the vertical difference of the effect of elevation on snow phenology fig 12 shows the variation of snow phenology with elevation with elevation intervals of 100 m the obvious elevation dependences are found for sod with advancing as the elevation increases fig 12a the sod advances at different rates with the increased elevation in addition as the elevation increases the interannual fluctuations of sod tend to increase at first reach the maximum and then starts to decrease the vertical zonal distribution mainly influenced by elevation is also found for sed fig 12b contrary to sod sed delays as the elevation increases the interannual fluctuations of sed increase first and then decrease with the increased elevation the sdd in high altitude mountainous areas is longer than the low altitude area 12c trend analysis shows that the sod is advanced below 3300 m with a weak trend fig 12d besides the sod shows a gradually strengthened delayed trend between 3300 and 5700 m and then with a weaker trend with further increase of elevation the sed shows delayed trends in almost all elevation belts especially with high trends between 2100 and 2600 m fig 12e the sdd shortens in every elevation belt with a gradually strengthened trend below 5800 m and with a weaker trend with further increase of elevation fig 12f 4 5 possible impacts of climate factors on the changes of snow phenology to further investigate the response mechanism of snow phenology to climate change the relationship between sod sed and air temperature precipitation of snow accumulation period and snow melt period are analysed at the pixel level using the pearson correlation coefficient r fig 13 the snow accumulation period is set to september december and the snow melt period is set to march june as shown in fig 13a the sod is mainly controlled by air temperature in 40 83 of the snow covered area in the study area p 0 05 40 67 of the snow covered area shows a significant positive correlation and 0 16 shows a significant negative correlation and the sod is mainly controlled by precipitation in 21 32 of the snow covered area in the study area 0 08 of the snow covered area shows a significant positive correlation while 21 24 shows a significant negative correlation the sed is mainly controlled by air temperature in 27 99 of the snow covered area 26 99 of the snow covered area shows a significant negative correlation and 1 shows a significant positive correlation fig 13b and the sed is mainly controlled by precipitation in 9 41 of the snow covered area 8 89 of the snow covered area shows a significant positive correlation and 0 51 shows a significant negative correlation table 3 further displays the correlation of sod sed and air temperature precipitation of snow accumulation period and snow melt period for different subregions it can be clearly seen that the sod is positively correlated with air temperature and negatively correlated with precipitation during the accumulation period for all subregions and the sod is more correlated with air temperature than precipitation during the accumulation period in almost the whole hma except hissar alay and west tien shan the sed is negatively correlated with air temperature and positively correlated with precipitation during the snow melt period for all subregions and the sed is more correlated with air temperature than precipitation during the snow melt period except in karakoram inner tibet central himalaya and east himalaya these results taken together indicate that the air temperature significantly dominates the interannual variability of sod and sed 5 discussion 5 1 uncertainties and limitations the results of this study heavily rely on the modis snow cover products and are therefore subject to limitations in those even though modis has a coarse resolution 500 m compared to landsat data and sentinel 2 data it is still currently the most suitable data source for monitoring the spatiotemporal dynamics of snow cover for a large scale and the long time series however cloud cover contamination seriously limits the application of modis snow cover products in the last few decades a large number of cloud removal methods for snow cover products have been proposed as li et al 2019 summarized 1 the spatial methods the spatial filter the snowline mapping approach and the locally weighted logistic regression gafurov and bárdossy 2009 lópez burgos et al 2013 parajka et al 2010 2 the temporal methods terra and aqua combined temporal filters including adjacent temporal deduction multi day combination season filter and temporal interpolation using a mathematical function dietz et al 2012b dozier et al 2008 gafurov and bárdossy 2009 parajka and blöschl 2008 paudel and andersen 2011 tang et al 2013 3 the spatial and temporal combination methods dariane et al 2017 jing et al 2019 li et al 2017c 4 the multi source fusion methods optical microwave and station observations brown et al 2010 gafurov et al 2015 huang et al 2016 liang et al 2008 in this study the terra and aqua combined method and the cubic spline interpolation algorithm are composited to eliminate cloud contamination this cloud gap filling method is simple and effective with the efficient performance in terms of accuracy to fill in the missing data under the cloud cover section 4 1 2 however the temporal interpolation algorithm may cause some error in the case of long cloud persistence days as shown in fig 4 when cpd is greater than 10 days although the frequency is 10 the mae of ndsi is greater than 0 1 in the case of high cpd the spatiotemporal weighted method jing et al 2019 li et al 2017c may improve the precision of cloud removal to a certain extent in addition the modis snow cover products are far from being perfect due to the difficulty of detection of snow in the mountainous area with complex terrain and land cover possibly implying that there are strong scaling effects arsenault et al 2014 masson et al 2018 it has not been resolved in this study which depends on the further improvement of the modis snow cover mapping algorithm in mountain and forest areas the errors of the snow phenology estimation come from both the effectiveness of cloud removal and snow cover mapping algorithm 5 2 comparisons with previous studies under the context of global warming the cryosphere snow cover glaciers glacial lakes and permafrost of the hma has been changing rapidly brun et al 2017 dehecq et al 2018 ding et al 2019 hock et al 2019 li et al 2017b zhang et al 2017 zhang et al 2015 these non negligible changes in the cryosphere including glacier retreat soil warming and permafrost degradation can have significant impact on regional water and energy balance in this study we systematically analysed the spatiotemporal variability of the snow cover and snow phenology over hma widespread decreases of sce are found in the most regions of the hma though slightly increased during winter months this is partially in line with previous studies huang et al 2017 li et al 2017a notarnicola 2020 wang et al 2017 and the decline of sce during summer months represented by permanent snow cover and glaciers is consistent with the reports regarding substantial glacier shrinkage chen et al 2016 cogley 2016 the trends in snow phenology may be more important to understand snow dynamics in response to climate change in general the trends toward later sod earlier sed and shorter sdd are found in the most regions of the hma especially in major glacier areas from the hydrological year 2002 to 2020 in this study although there is a lack of studies on snow phenology across the whole hma in previous studies similar results were reported in the tibetan plateau chen et al 2018 sun et al 2020 wang et al 2017 and central asia li et al 2020b wang et al 2022 yang et al 2019 as well it is worthwhile mentioning that in tien shan both sod and sed advanced indicating that the shortened sdd is more related to the advanced sed than advanced sod a recent study conducted by yi et al 2021 indicated that there is a decreasing trend in sdd a delayed trend in sod and an advanced trend in sed in most area of the yarkant river basin and the west of upper indus basin associated with the karakoram mountains the results presented in fig 11 fits well with their findings the earlier sed in the snowmelt dominated river basins would contribute to increased snowmelt and advance the runoff peak to earlier the increased snowmelt will increase the risk of floods and increase the difficulties of the regional reservoir and agriculture management yang et al 2019 5 3 possible mechanisms for recent snow cover changes snow cover in areas with similar climatic conditions might respond differently given their different and complex topographies in hma previous studies have investigated the linkage between snow cover and topographic factors such as elevation aspect and slope gradient deng et al 2021 gurung et al 2017 li et al 2020b misra et al 2020 sharma et al 2014 in this study we explore the relationship between elevation and snow phenology fig 12 the regions with short sdd late sod and early sed are mainly located at low altitude area the reasons may be that has relatively high air temperature at low altitude area typically above 0 c makes it difficult for snow accumulation the low air temperature generally below 0 c at high altitudes coupled with abundant precipitation fully satisfy the conditions for the continuous development of snow thus sdd is more durable sod is more earlier and sed is more later easily forming permanent snow cover and glaciers areas at high altitudes moreover the change trend of snow phenology shows large differences under different elevations that is the sod is slightly advanced in the relatively low altitudes with elevation below 3300 m while sed and sdd show slight advanced and shortened trends in this case the shortened sdd could be mainly related to the advanced sed in these altitudes however in high altitudes with elevation above 3300 m it is obvious that the trend of sdd under different elevations corresponds very well to the trend of sod where the larger sod delay rightly corresponds to the higher sdd decrease significantly according to the correlation analysis between snow phenology and air temperature precipitation as shown in fig 13 the air temperature mainly has a positive impact on sod but a negative impact on sed accounting for 65 44 and 72 18 of all significantly controlled areas respectively the decreased air temperature could increase the probability of snowfall and is favorable for the maintenance of snow cover which would cause earlier sod during snow accumulation period however higher air temperature would trigger earlier sed earlier during snow melt period the precipitation mainly has a negative impact on sod but a positive impact on sed accounting for 34 18 and 23 78 of all significantly controlled areas respectively in the beginning of snow accumulation period the air temperature is usually below the frozen point thus the precipitation probably occurred as snowfall therefore the increased precipitation causes earlier sod and vice versa similarly more snowfall would delay sed during snow melt period in addition zhang et al 2022 confirmed the elevation dependence and variation characteristics of snow cover change over the tibetan plateau in our study the effects of air temperature and precipitation on snow phenology vary under different altitudes indeed fig 14 the sod is more correlated with air temperature than precipitation under almost all elevation zones especially in the elevation ranges of 5000 6000 m however the sed is more correlated with air temperature than precipitation below 4300 m and then the precipitation become the dominant factor with further increase of elevation moreover the air temperature of both snow accumulation period and snow melt period are almost rising under different elevations which coincides with the change trend of snow phenology as displayed in fig 12 the precipitation of snow accumulation period shows a decreased trend between 5000 and 6000 m which affects the postponement of sod even though the precipitation of snow melt period shows an increasing trend in all elevation zones this trend is too small to affect the advance of sed compared to the effect of air temperature 6 conclusions understanding the snow cover dynamic is critical for hydrological processes and climate system in this study the cloud removal of the daily modis snow cover products during 2002 2021 was firstly carried out on this basis this study investigated the spatiotemporal variations in snow cover with a special focus on the snow phenology from the hydrological year 2002 to 2020 and then the vertical difference of the effect of elevation on snow phenology and the relationship between snow phenology and air temperature precipitation were analysed the main findings are summarized as follows 1 the cloud gap filling method for modis snow cover products can effectively obtain the ndsi value under the cloud cover the overall mae and rmse of the cloud gap filling method are 0 054 and 0 125 respectively indicating that this method has relatively high accuracy on cloud reduction and snow information retrieval 2 spatiotemporal patterns of snow cover in hma show strong seasonal fluctuations and a large spatial heterogeneity the monthly sce over the whole hma generally showed a decreasing trend in most months from the hydrological year 2002 to 2020 during the study period the scd generally decreased the sod generally delayed the sed generally advanced and the sdd generally shortened and these changes were significant in 15 73 14 35 15 46 and 16 01 of the snow covered area respectively the snow cover in the west himalaya was enhancing with its increased sce increased scd and lengthened sdd 3 the spatial variability of snow phenology in hma shows a vertical zonality influenced by the altitude that is the sdd is longer the sod is earlier and the sed is later with higher elevation correlation analysis between snow phenology and air temperature precipitation showed that the snow phenology is significantly related to the changed air temperature and precipitation the increase of air temperature or the decrease of precipitation lead to the delayed sod and advanced sed the air temperature was the dominant factor affecting the interannual variability of sod and sed credit authorship contribution statement zhiguang tang conceptualization methodology formal analysis writing review editing supervision project administration funding acquisition gang deng methodology validation formal analysis investigation data curation software writing original draft guojie hu writing review editing hongbo zhang writing review editing haizhu pan writing review editing guoqing sang data curation software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national natural science foundation of china no 41871058 the state key laboratory of cryospheric science northwest institute of eco environment and resources chinese academy sciences no sklcs op 2020 08 and the scientific research foundation of hunan education department china no 20b227 
2853,accurate understanding the spatiotemporal variability of snow cover and snow phenology over high mountain asia hma is of great interest because of their vital impacts on the hydrological processes global climate system and regional water resource management this study investigates the spatiotemporal variability of snow covered extent sce snow covered days scd snow onset date sod snow end date sed and snow duration days sdd of hma using the daily cloud free moderate resolution imaging spectroradiometer modis snow cover products from the hydrological year 2002 to 2020 the vertical difference of the effect of elevation on snow phenology and the response of snow phenology to climate change are explored the results indicate that the monthly sce over the whole hma exhibited a slight decreasing in most months over the study period the variability of snow cover and snow phenology over the whole hma generally showed decreased scd significant decrease accounts for 15 73 delayed sod significant delay accounts for 14 35 advanced sed significant advance accounts for 15 46 and shortened sdd significant shorten accounts for 16 01 it is worth noting that the snow cover in the west himalaya was enhancing with its increased sce increased scd and lengthened sdd there is an elevation dependence of snow phenology changes over hma with the high altitude mountain ranges generally having a higher scd earlier sod later sed and longer sdd than low altitude areas the air temperature of snow accumulation period is the dominant factor affecting the interannual variation of sod and the air temperature of snow melt period is the dominant factor affecting the interannual variation of sed the increase of air temperature leads to the delayed sod advanced sed and shortened sdd keywords snow cover modis snow phenology high mountain asia climate change data availability data will be made available on request 1 introduction snow cover is a critical component of both the global energy and water cycles covering about 40 to 50 of the northern hemisphere during winter dietz et al 2012a due to its high albedo and high emissivity as well as low thermal conductivity snow cover has a large scale cooling effect on the global climate system through strong interaction with the surface energy budget brown and mote 2009 dong 2018 groisman et al 1994 kang et al 2010 you et al 2020 moreover as the natural solid water reservoir of the cryosphere snow cover provides more than one sixth of the world s population with fresh drinking water through snowmelt and further supports other uses such as hydropower generation irrigation and industry barnett et al 2005 bormann et al 2018 seasonal snow cover in high latitude and altitude regions in the northern and southern hemispheres is very sensitive to climate change rising air temperature will inevitably affect the changes of snow accumulation and melting processes which can be exhibited through the snow phenology variations in contrast the change in snow state will have feedback on climate through snow albedo from the snow phenology we can get insight of the impact of climate change on cryospheric system according to the sixth assessment report of the intergovernmental panel on climate change ipcc ar6 masson delmotte et al 2021 the climate warming is still continuously ongoing and the global surface temperature in the first two decades of the 21st century 2001 2020 was 0 99 0 84 1 10 c higher than 1850 1900 in this climate change context the snow covered extent sce in the northern hemisphere has undergone significant reductions over the past decades and this trend will continue brown and robinson 2011 fox kemper et al 2021 hock et al 2019 hori et al 2017 meanwhile snow covered days scd and snow phenology parameters including snow onset date sod snow end date sed and snow duration days sdd have also experienced notable changes chen et al 2015 peng et al 2013 previous studies have given considerable attention to studying the variations in snow cover and their causes based on both the satellite remote sensing data and in situ observations at multiple spatial scales including the hemispherical chen et al 2015 choi et al 2010 peng et al 2013 continental sun et al 2020 zeng et al 2018 zhang and ma 2018 and regional li et al 2020b tang et al 2017 wang et al 2017 xiong et al 2017 yi et al 2021 scales compared to limited field survey and snowfall data recorded at the meteorological stations the use of satellite remote sensing data including optical remote sensing data and passive microwave data to monitor the snow phenology dynamics is a mainstream approach chen et al 2015 huang et al 2016 wang et al 2017 xiong et al 2017 yang et al 2019 zhang and ma 2018 among them there are remote sensing products with coarse resolution like 25 km or with multi day composites like 8 day composites which make it difficult to capture the continuous state of snow cover accurately in contrast the daily snow cover product generated from the moderate resolution imaging spectroradiometer modis has the advantages of high spectral resolution high temporal resolution wide spatial coverage and being freely available which provide an excellent opportunity to study the snow cover for global or large scale areas the variation of snow cover has strong spatial and temporal heterogeneity which varies with the study area and time for example chen et al 2015 found contrasting changes in snow phenology with increased snow cover duration in the northern middle latitudes and decreased snow cover duration in high latitudes from 2001 to 2014 huang et al 2016 found scd and snow depth sd have decreased in the north of xinjiang province china while increasing on the southwest edge and in the southeast part of the tibetan plateau from december 2000 to november 2014 tang et al 2017 found 26 39 and 34 26 of the tienshan mountains showed declining and increasing trend in scd respectively ackroyd et al 2021 found snow cover of high mountain asia hma was in decline which was most pronounced in elevation bands where snow is most likely to be present and most needed to sustain glaciers wang et al 2017 found no widespread decline in snow cover over the tibetan plateau from 2000 to 2015 using modis snow cover products yang et al 2019 found the regional diversities in snow phenology in the tienshan mountains with shortened sdd in high altitude regions and the fergana valley while increased sdd in the ili valley and upper reaches of the chu and aksu rivers from 1979 to 2016 xiong et al 2017 found the snowmelt onset date was becoming earlier in hma region during 1988 2015 except the karakorum mountains and part of the western kunlun mountains tang et al 2020 found the snowline altitude at the end of melting season of hma generally showed a rising trend in the recent years 2001 2016 which exhibits the snow cover dynamics in the altitudinal direction deng et al 2021 found the snowline altitude over the tienshan mountains generally showed an increasing trend from 2001 to 2019 the inconsistency between study region time frame and scale makes it a challenge for understanding where and how snow cover is changing hma is the third largest cryosphere on earth outside of the earth s polar regions known as the third pole of the earth the birthplace of many great rivers known as water tower of asia immerzeel et al 2020 immerzeel et al 2010 and the core area of the silk road economic belt as one of the most sensitive and prominent regions responding to global climate changes hma has experienced a considerable warming trend and the components of cryosphere such as snow cover and glaciers have been rapid shrinking over the last decades brun et al 2017 hock et al 2019 hu et al 2014 kraaijenbrink et al 2021 zhan et al 2017 impacts of climate change on the cryosphere strongly led to changes in mountainous hydrological processes and water resources and increased the hma s runoff due to the accelerated glacier snowmelt chen et al 2017 duethmann et al 2015 li et al 2020a lutz et al 2014 previous studies mainly focused on changes in the snow cover extent and snow depth while the integrated analysis about spatiotemporal patterns of snow phenology in the whole of hma is also extremely necessary in addition elevation is presumed to be the dominant factor affecting snow cover in mountainous regions tong et al 2009 wang et al 2022 and the role of air temperature and precipitation in snow cover variations can also differ according to elevation zones therefore it is necessary to make an investigation on the vertical difference of the relation of elevation to snow phenology and the potential influence of climate factors on snow phenology variations in hma this knowledge is critical for assessing and projecting the future climate in addition to better understand the changes in snow cover and snow phenology the mechanisms driving them and their impacts on the earth s climate system both the entire study area and the sub regional scale of the hma are currently needed the focus of this study is the detection and exhaustive analysis of spatiotemporal variability of the latest snow cover and snow phenology over hma using the daily cloud free modis snow cover products the main objectives of this study are to 1 extract the snow cover parameters sce scd sod sed and sdd and analyse their spatiotemporal variations 2 reveal the vertical difference of the relation of elevation to snow phenology 3 to investigate the potential influence of climate factors on snow phenology variations 2 materials 2 1 geographic region the hma 64 107 e and 22 47 n encompasses the tibetan plateau and the adjacent mountain ranges tien shan pamir hindu kush and karakoram in the west the himalayas in the south and southeast and qilian shan in the east khanal et al 2021 fig 1 with an average elevation of more than 4000 m it constitutes the largest glacierized and snow covered regions outside of the earth s polar regions as well as the headwater area of the main river basins syr darya amu darya indus ganges brahmaputra yangtze and yellow providing a major source of water for approximately 1 4 billion of inhabitants in the downstream low lying plains immerzeel et al 2010 khanal et al 2021 shean et al 2020 in the context of global warming the hma cryosphere has indeed undergone considerable change the estimated 118200 km2 of glaciated area has been rapidly retreating and losing mass over the past decades brun et al 2017 gardner et al 2013 which has both impacted local communities and has contributed to global sea level rise gardner et al 2013 the hma has become a hotspot for global climate change and cryospheric change researches in this study the hma with an elevation greater than 1500 m is the focus of our analysis with a total area of about 5 14 106 km2 and the hma is divided into 15 subregions according to the version 6 of the randolph glacier inventory rgi 6 0 arendt et al 2017 2 2 dataset 2 2 1 modis snow cover products the modis terra and modis aqua daily snow cover products mod10a1 and myd10a1 version c6 during 2002 2021 from nasa s eosdis earthdata https earthdata nasa gov search are utilized in this study the version c6 product includes a range of improvements in the snow cover algorithms and provides two new layers ndsi snow cover and raw ndsi in place of the two layers binary snow cover and fractional snow cover fsc in the version c5 product nine tiles i e h23v04 h23v05 h24v04 h24v05 h24v06 h25v05 h25v06 h26v05 and h26v06 are required to cover the whole study area the modis reprojection tool dwyer and schmidt 2006 is used to mosaic each of the nine tiles via nearest neighbor resampling method and reproject the primitive sinusoidal projection into a geographic projection using the wgs84 coordinate system and 0 005 about 500 m resolution the final mosaiced images are converted to geotiff file format furthermore the original myd10a1 and mod10a1 products are reclassified for further analysis with only two value ranges remaining 1 ndsi snow cover values of 0 100 inland water and ocean are set to 0 2 cloud gap values of 250 cloud gap includes the original descriptions of cloud detector saturated missing data night and no decision 2 2 2 meteorological data the era5 is the latest released fifth generation reanalysis from the european center for medium range weather forecasts ecmwf covering the time period from january 1 1979 to near real time hersbach et al 2020 although there are not yet any explicit studies of era5 performance over the larger hma it has been shown that era5 has better applicability in the tibetan plateau compared to other climate reanalysis data huai et al 2021 kraaijenbrink et al 2021 liu et al 2021 era5 land is a replay of the land component of the era5 climate reanalysis with a finer spatial resolution 0 10 than era5 monthly averaged data on single levels from 1979 to the present 0 25 chen et al 2021 muñoz sabater 2019 to survey the linkages between the snow phenology and climate change the monthly averaged 2 m air temperature and total precipitation are extracted from the era5 land reanalysis dataset from 2002 to 2021 2 2 3 auxiliary data the daily sd observed by 44 meteorological stations during 2002 2013 are used to extract the ground observed snow phenology and are employed as ground truth to verify the performance of the snow phenology retrieved by daily cloud free modis ndsi product all the sd observations are produced by the national meteorological information center and the tibet meteorological bureau china https data tpdc ac cn zh hans data 72d6dadf 8e1c 458b b24e 91539042dfe6 chu et al 2018 national meteorological information center tibet meteorological bureau 2018 based on the observation guidelines of china meteorological administration 2003 if at least half of the observation fetch of the station is covered by snow the sd is measured by a ruler and then rounded to the nearest integer in centimeters i e the lowest sd value is 1 cm for a snow cover day china meteorological administration 2003 the released sd data have been quality controlled and homogenized including evaluations of the climatological limit station or regional extremes internal consistency and temporal and spatial consistency the distribution of the selected sd observations is shown in fig 1 the shuttle radar topography mission srtm digital elevation model dem data srtm v4 90 m is freely available from cgiar consortium for spatial information cgiarcsi https srtm csi cgiar org the resolution of the dem is resampled to 500 m in order to remain consistent with the modis data 3 methodology 3 1 cloud removal of the daily modis ndsi product the extensive cloud cover over snow covered region is a critical issue that greatly limits the applications of the modis snow cover product to monitor the snow cover since clouds have the rapidly changing daily shifting features and snow changes gradually over time tang et al 2013 used the cubic spline interpolation algorithm to eliminate the cloud contaminated pixels and filled the gaps under the cloud contaminated pixels successfully in modis fsc product in this study the same cloud gap filling strategy is used with the addition of the combination of mod10a1 and myd10a1 for the daily cloud free modis ndsi product generation from 2002 to 2021 3 1 1 combination of mod10a1 and myd10a1 because of the different overpass time of mod10a1 and myd10a1 and the characteristics of cloud movement it is an opportunity to replace the cloud pixels with non cloud pixels after combining the two products on the same day the strategy is that if a cloud pixel is present in mod10a1 but non cloud is observed in myd10a1 then the pixel is replaced with the non cloud pixel accordingly the combination procedure of the two products can be completely explained by eq 1 gafurov and bárdossy 2009 parajka and blöschl 2008 1 s i j t min m o d i j t m y d i j t where i and j are the row and column of modis ndsi product grid respectively t is the day index of pixel s and mod and myd show pixels of mod10a1 and myd10a1 respectively in this combination procedure the pixels that are identified as clouds in mod10a1 but observed as snow land or water in myd10a1 will be automatically replaced with the same pixel from the myd10a1 the min function can implement this replacement by comparing the new classification value of cloud pixels with that of other class pixels because the new classification value of cloud pixels is the highest value 3 1 2 cloud gap filling method after completing the above combination process the cubic spline interpolation algorithm is used to reconstruct the ground information ndsi value of the cloud gaps caused by clouds or other reasons specifically each cloud pixel in combination images is interpolated to ndsi value using the cubic spline interpolation algorithm based on the observations ndsi value of cloud free days if the interpolated value 0 then reassign it with 0 and if the interpolated value greater than 100 then reassign it with 100 0 ndsi snow cover 100 3 1 3 accuracy assessment based on cloud assumption the validation of cloud gap filling method based on in situ sd observations may not provide a comprehensive view of the whole study area thus the mod10a1 myd10a1 combination product of 12 days i e february 5 april 7 july 31 and november 4 of 2018 february 16 april 12 august 12 and december 8 of 2019 march 27 may 23 september 17 and november 10 of 2020 during 2018 2020 are considered to be reference true ndsi images in this study in these images the ndsi values of the pixels under clear sky conditions are considered as the true values for assessing the cloud gap filling method then the 12 true ndsi images are assumed to be completely covered by clouds i e the pixel value is 250 simultaneously the 12 masked cloud images are reconstructed again using the cloud gap filling method and the results i e the simulated ndsi values are compared with the reference true ndsi values two performance evaluation metrics i e mean absolute error mae eq 2 and root mean square error rmse eq 3 are calculated as follows 2 mae i 1 n c i s i n 3 rmse i 1 n c i s i 2 n where ci and si are the simulated value and true value respectively n is the total number of pixels with true values additionally the cloud persistence days cpd of each cloud pixel is calculated based on the daily mod10a1 myd10a1 combination image during 2018 2020 the cpd represents the number of consecutive days of cloud observed for a pixel from the last cloud free observation to the next cloud free observation the cpd map is convenient to assess the accuracy of the cloud gap filling method under different cpd conditions 3 2 snow cover parameters retrieval five snow cover parameters sce scd and including snow phenology parameters sod sed sdd are derived from the daily cloud free modis ndsi product during the hydrological year of 2002 2020 the hydrological year was set from 1st september to 31th august of the following year zhang et al 2021 found a region wide optimal ndsi threshold for binary snow cover estimation on the tibetan plateau of 0 29 which has better accuracy than the global reference ndsi threshold of 0 4 proposed by previous studies dozier et al 2008 hall et al 1995 hall et al 2002 thus the image pixels with ndsi 0 29 are considered as snow covered pixels in the extraction of snow parameters in this study 3 2 1 sce and scd estimations the scd is calculated as the number of days a pixel is covered by snow in a hydrological year wang and xie 2009 following eq 4 4 scd i 1 n ceil d i 0 29 where n is the total number of days images within a hydrological year and di is ndsi in a pixel 0 di 1 ceil di 0 29 counts the numbers of di 0 29 for instance if the pixel value on the image is 0 6 then the scd adds 1 if the pixel value on the image is 0 1 then the scd adds 0 3 2 2 snow phenology estimation and validation during a hydrological year the sod is defined as the first date of the first five continuous snow cover days the sed is defined as the last date of the last five continuous snow cover days the sdd is defined as the duration days from sod to sed fig 2 shows a schematic diagram of the definition of snow phenology this continuous five days method can reduce the influence of ephemeral snow cover on the snow phenology calculation and is widely adopted to extract snow phenology parameters in previous studies chen et al 2015 choi et al 2010 peng et al 2013 sun et al 2020 wang et al 2022 yang et al 2019 although there are large differences in the spatial representation of snow phenology parameters retrieved by modis and in situ observations in situ observations still provide the most convincing results when compared with modis considering that much of the snow depth is relatively thin and fragmented in hma especially on the tibetan plateau most of previous studies took 1 cm as the threshold and that it may represent a wider range of snow conditions huang et al 2011 ke et al 2016 ma et al 2020 zhang et al 2019 therefore the snow cover determination rules based on sd observations sd greater than or equal to 1 cm is viewed as snow cover is used to extract the ground observed snow phenology in this study the two performance evaluation metrics mae and rmse are used to evaluate the accuracy of snow phenology parameters retrieved by modis relative to sd observations during 2002 2013 3 3 statistical analyses to assess the temporal trends and trend significance of the snow phenology parameters and climate factors for the period from the hydrological year 2002 to 2020 the sen s slope and mann kendall test are adopted sen s slope is used to estimate the magnitude of trends in snow phenology parameters and climate factors the advantage of sen s slope is to deal with data of non normal distribution and it is used instead of a linear regression because it limits the influence that the outliers have on the slope hirsch et al 1982 sen 1968 sen s slope calculation is shown by eq 5 5 β median x j x i j i 1 i j n where β is the trend slope of the time series median is the median function n is the number of the years notes when β 0 the series has an increasing trend when β 0 the series has an insignificant trend when β 0 the series has a decreasing trend the m k test is used to assess the temporal significance of trends in snow phenology parameters and climate factors it is a nonparametric method of monotonic trends that has successfully been applied to detect trends in a time series in meteorology and hydrology hamed 2008 li et al 2011 yue et al 2002 the calculation formula is as follows 6 s i 1 n 1 j i 1 n sgn x j x i sgn x j x i 1 x j x i 0 x j x i 1 x j x i 1 i j n 7 z s 1 v a r s s 0 0 s 0 s 1 v a r s s 0 var s n n 1 2 n 5 18 where n is the number of the years notes the statistical significance of the temporal trend is assumed by the z value when z 1 28 1 64 2 32 the significance tests with 90 95 and 99 confidence levels i e p 0 1 0 5 0 01 are passed respectively the change trend of snow cover and snow phenology is tested at the 90 significance level in this study the pearson correlation coefficient is performed for correlation analysis between snow phenology parameters and climate factors the pearson correlation coefficient calculation is shown by eq 8 in addition the main controlling factor influencing the change in snow phenology is defined as if the correlation between snow phenology and air temperature is significant and the correlation with precipitation is not significant then the pixel shows that air temperature is the main control factor if the correlation between snow phenology and precipitation is significant and the correlation with air temperature is not significant then the pixel shows that precipitation is the main control factor and if the correlations between snow phenology and air temperature precipitation are all significant then the correlation coefficient values are compared 8 r i 1 n x i x y i y i 1 n x i x 2 i 1 n y i y 2 where r is the pearson correlation coefficient n is the number of the years x represents snow phenology parameters y represents climate factors the correlation coefficient r is tested at the 95 significance level in this study 4 results 4 1 accuracy validation results 4 1 1 comparison of mod10a1 myd10a1 combination result the combination of mod10a1 and myd10a1 based on a daily perspective can reduce cloud cover taking 10 february 2019 as an example the mod10a1 observes 62 2 cloud coverage fig 3 a whereas the myd10a1 after a time shift of a few hours observes 63 5 cloud coverage fig 3b after the combination of mod10a1 and myd10a1 products the cloud coverage reduces to 47 7 i e 14 5 and 15 8 less than the mod10a1 and myd10a1 products respectively fig 3c effectively removing some cloud cover in addition the situation of cloud coverage before and after combination for the whole study area in the year 2019 is displayed in fig 3d it can be seen that the extensive cloud cover especially during the winter seriously limits the monitoring of snow cover dynamics the mod10a1 and myd10a1 have high cloud coverage averaging 48 7 and 56 6 respectively after the combination the average cloud coverage decreases to 39 8 and the maximum cloud coverage reduction could reach 36 3 12 april 2019 4 1 2 effectiveness of the cloud gap filling method fig 4 presents the mean frequency of cpd and cloud removal accuracy under different cpd conditions it can be seen that the frequency of the cpd reduces gradually as the increasing of cpd value and the frequency of cpd within 5 d and 15 d for the cloud covered pixels reach 73 55 and 94 96 respectively the accuracy of the cloud gap filling method is influenced by cpd with the mae and rmse increase as the rising of cpd fig 4b this method has very high accuracy with mae and rmse 0 08 and 0 15 respectively when cpd 5 d it can bring relatively greater error with mae and rmse greater than 0 15 and 0 25 respectively when cpd is larger than 20 days but this situation is very rare fig 4a the overall mae and rmse of the cloud gap filling method using the frequency of cpd as the weight fig 4a are 0 054 and 0 125 respectively these indicate that the cloud gap filling method has the efficient performance in terms of accuracy to fill in the missing data due to cloud obscuration or swath gaps fig 5 shows the comparisons of mod10a1 myd10a1 combination map modis ndsi map from the cloud gap filling method and cpd map over the whole region on 25 april 2020 using the cloud gap filling method for each cloud covered pixel on 25 april 2020 the ndsi value is effectively retrieved fig 5b the corresponding cpd map fig 5c probably reflects the confidence of the retrieved ndsi data at each pixel the cpd of most cloud covered pixels is 6 days 4 1 3 validation of snow phenology based on in situ sd observations the snow phenology parameters sod sed sdd retrieved from the daily cloud free modis ndsi product are evaluated by the observed snow depth of 44 meteorological stations from 2002 to 2013 as shown in fig 6 the average sod sed and sdd retrieved by modis are well consistent with the ones extracted based meteorological stations the values of mae are controlled within 13 d and the r values are acceptable for all snow phenology parameters the difference in the two extraction results may be caused by the coarse spatial resolution of the modis product which cannot completely capture and reflect the real value of sod sed and sdd at a specific location 4 2 spatiotemporal patterns of snow cover fig 7 a shows the perennial annual average scd from the hydrological year 2002 to 2020 which reflects the extremely uneven distribution of the snow cover in hma the area with the scd of over 60 d is regarded as the stable snow covered area and the source of the water resource occupying about 33 83 of the whole study area and the areas of high scd are primarily distributed in high altitude mountain ranges such as tien shan karakoram kunlun qilian shan hengduan shan and himalayas the areas of low scd scd 20 d are primarily distributed in the interior of the plateau and low altitude areas around the tibetan plateau accounting for 41 74 of the whole study area fig 7b and 7c show strong seasonal fluctuations in sce for most subregions and the whole hma for areas with very little water vapor such as kunlun qilian shan inner tibet and s and e tibet their sce are relatively low and the seasonal variations are not significant in addition the high sce is mainly concentrated from december to january during this period the large standard deviations of sce reflect the high interannual variability in the end of snow melting july august the sce fluctuates slightly and maintains the lowest level with a relatively small interannual variability the spatial patterns of monthly snow cover over the hma exhibit large spatial differences fig 8 and corresponds well with the distribution of scd fig 7a the annual variation of snow cover can be expressed as three stages 1 snow accumulation period from september to january in which the sce continue to expand from high altitude mountains to valleys and plains 2 snowmelt period from february to june in which the sce gradually decrease from plains to high mountains and 3 perennial snow cover appearing stage july august in which the perennial snow cover almost exclusively distributes on the top of high mountains in the study area in addition the interannual variations of scd and sce are displayed in fig 9 and table 1 respectively it is shown that the decreased scd accounts for 59 60 of the snow covered area fig 9 the decreases are significant in 15 73 of the snow covered area p 0 1 mainly concentrated in the west tien shan kun lun central and east himalaya and hengduan shan with the change trend of approximately 1 62 d a moreover the area with increased scd accounts for 36 20 of the snow covered area and the increases are significant in only 5 42 of the snow covered area these areas are scattered in the east tien shan west himalaya and south and east tibet with the change trend of approximately 1 68 d a these results indicate that the scd exhibits an overall decreasing trend over hma the monthly sce over the whole hma shows a declining but not significant trend in most months table 1 the interannual variations of monthly sce vary in different subregions for example the monthly sce in the tien shan both west tien shan and east tien shan is declining except for the may july months in contrast the monthly sce in the west himalaya and central himalaya show an increasing trend in most months 4 3 spatiotemporal patterns of snow phenology 4 3 1 spatial distribution of snow phenology fig 10 illustrates the spatial distributions of the perennial annual average sod sed and sdd of hma the pixels which have not over 19 years of effective snow phenology detection are considered as snow free pixels overall the snow phenology over the hma presents extremely spatial heterogeneity the sod is mainly concentrated in september december while the sed is mainly concentrated in march june in high altitude mountain ranges such as tien shan karakorum west kunlun himalayas and hengduan shan the sod generally starts earlier the sed appears later and the sdd tends to be longer however there are later sod earlier sed and shorter sdd in the low altitude areas like the hinterland of the tibetan plateau and the peripheral area of the hindu kush 4 3 2 interannual variation of snow phenology not only are changes in the snow phenology spatially complex but they exhibit distinct temporal heterogeneity as well fig 11 table 2 as seen in the interannual variation of sod fig 11a fig 11b the sod in most areas of hma is predominantly delayed approximately 14 35 of the snow covered area in the study area shows significantly delayed sod p 0 1 with the change trend of approximately 2 32 d a mainly distributed in the central and east himalaya the area with significantly advanced sod with the change trend of approximately 1 53 d a accounts for about 9 30 of the snow covered area sparsely distributed in the low altitude areas around the tien shan and west himalaya for the interannual variation of the sed fig 11c fig 11d it can be seen that the sed in most areas of hma is predominantly advanced approximately 15 46 of the snow covered area shows significantly advanced sed with the change trend of approximately 1 69 d a primarily distributed in the tien shan and hengduan shan the area with significantly delayed sed with the change trend of approximately 2 14 d a accounts for only 6 35 of the snow covered area scattered in the east tien shan central himalaya and central tibetan plateau as far as the interannual variation of the sdd is concerned fig 11e fig 11f an overall shortened trend is found in most areas of hma the sdd changes are significantly related to both sod and sed variations more specifically approximately 16 01 of the snow covered area shows significantly shortened sdd with the change trend of approximately 3 33 d a mainly concentrated in the karakoram west tien shan central and east himalaya and hengduan shan however only 5 41 of the snow covered area shows significantly lengthened sdd with the change trend of approximately 2 81 d a sparsely distributed in the east tien shan and west himalaya table 2 further examines the significant changes of sod sed and sdd for different subregions of particular note is the sod in the tien shan and hissar alay are mainly advanced while all other subregions are delayed except for the west himalaya central himalaya and inner tibet the sed of the other subregions are significantly advanced in addition the sdd of all subregions are significantly shortened 4 4 the vertical difference of the relation of elevation to snow phenology to quantitatively describe the vertical difference of the effect of elevation on snow phenology fig 12 shows the variation of snow phenology with elevation with elevation intervals of 100 m the obvious elevation dependences are found for sod with advancing as the elevation increases fig 12a the sod advances at different rates with the increased elevation in addition as the elevation increases the interannual fluctuations of sod tend to increase at first reach the maximum and then starts to decrease the vertical zonal distribution mainly influenced by elevation is also found for sed fig 12b contrary to sod sed delays as the elevation increases the interannual fluctuations of sed increase first and then decrease with the increased elevation the sdd in high altitude mountainous areas is longer than the low altitude area 12c trend analysis shows that the sod is advanced below 3300 m with a weak trend fig 12d besides the sod shows a gradually strengthened delayed trend between 3300 and 5700 m and then with a weaker trend with further increase of elevation the sed shows delayed trends in almost all elevation belts especially with high trends between 2100 and 2600 m fig 12e the sdd shortens in every elevation belt with a gradually strengthened trend below 5800 m and with a weaker trend with further increase of elevation fig 12f 4 5 possible impacts of climate factors on the changes of snow phenology to further investigate the response mechanism of snow phenology to climate change the relationship between sod sed and air temperature precipitation of snow accumulation period and snow melt period are analysed at the pixel level using the pearson correlation coefficient r fig 13 the snow accumulation period is set to september december and the snow melt period is set to march june as shown in fig 13a the sod is mainly controlled by air temperature in 40 83 of the snow covered area in the study area p 0 05 40 67 of the snow covered area shows a significant positive correlation and 0 16 shows a significant negative correlation and the sod is mainly controlled by precipitation in 21 32 of the snow covered area in the study area 0 08 of the snow covered area shows a significant positive correlation while 21 24 shows a significant negative correlation the sed is mainly controlled by air temperature in 27 99 of the snow covered area 26 99 of the snow covered area shows a significant negative correlation and 1 shows a significant positive correlation fig 13b and the sed is mainly controlled by precipitation in 9 41 of the snow covered area 8 89 of the snow covered area shows a significant positive correlation and 0 51 shows a significant negative correlation table 3 further displays the correlation of sod sed and air temperature precipitation of snow accumulation period and snow melt period for different subregions it can be clearly seen that the sod is positively correlated with air temperature and negatively correlated with precipitation during the accumulation period for all subregions and the sod is more correlated with air temperature than precipitation during the accumulation period in almost the whole hma except hissar alay and west tien shan the sed is negatively correlated with air temperature and positively correlated with precipitation during the snow melt period for all subregions and the sed is more correlated with air temperature than precipitation during the snow melt period except in karakoram inner tibet central himalaya and east himalaya these results taken together indicate that the air temperature significantly dominates the interannual variability of sod and sed 5 discussion 5 1 uncertainties and limitations the results of this study heavily rely on the modis snow cover products and are therefore subject to limitations in those even though modis has a coarse resolution 500 m compared to landsat data and sentinel 2 data it is still currently the most suitable data source for monitoring the spatiotemporal dynamics of snow cover for a large scale and the long time series however cloud cover contamination seriously limits the application of modis snow cover products in the last few decades a large number of cloud removal methods for snow cover products have been proposed as li et al 2019 summarized 1 the spatial methods the spatial filter the snowline mapping approach and the locally weighted logistic regression gafurov and bárdossy 2009 lópez burgos et al 2013 parajka et al 2010 2 the temporal methods terra and aqua combined temporal filters including adjacent temporal deduction multi day combination season filter and temporal interpolation using a mathematical function dietz et al 2012b dozier et al 2008 gafurov and bárdossy 2009 parajka and blöschl 2008 paudel and andersen 2011 tang et al 2013 3 the spatial and temporal combination methods dariane et al 2017 jing et al 2019 li et al 2017c 4 the multi source fusion methods optical microwave and station observations brown et al 2010 gafurov et al 2015 huang et al 2016 liang et al 2008 in this study the terra and aqua combined method and the cubic spline interpolation algorithm are composited to eliminate cloud contamination this cloud gap filling method is simple and effective with the efficient performance in terms of accuracy to fill in the missing data under the cloud cover section 4 1 2 however the temporal interpolation algorithm may cause some error in the case of long cloud persistence days as shown in fig 4 when cpd is greater than 10 days although the frequency is 10 the mae of ndsi is greater than 0 1 in the case of high cpd the spatiotemporal weighted method jing et al 2019 li et al 2017c may improve the precision of cloud removal to a certain extent in addition the modis snow cover products are far from being perfect due to the difficulty of detection of snow in the mountainous area with complex terrain and land cover possibly implying that there are strong scaling effects arsenault et al 2014 masson et al 2018 it has not been resolved in this study which depends on the further improvement of the modis snow cover mapping algorithm in mountain and forest areas the errors of the snow phenology estimation come from both the effectiveness of cloud removal and snow cover mapping algorithm 5 2 comparisons with previous studies under the context of global warming the cryosphere snow cover glaciers glacial lakes and permafrost of the hma has been changing rapidly brun et al 2017 dehecq et al 2018 ding et al 2019 hock et al 2019 li et al 2017b zhang et al 2017 zhang et al 2015 these non negligible changes in the cryosphere including glacier retreat soil warming and permafrost degradation can have significant impact on regional water and energy balance in this study we systematically analysed the spatiotemporal variability of the snow cover and snow phenology over hma widespread decreases of sce are found in the most regions of the hma though slightly increased during winter months this is partially in line with previous studies huang et al 2017 li et al 2017a notarnicola 2020 wang et al 2017 and the decline of sce during summer months represented by permanent snow cover and glaciers is consistent with the reports regarding substantial glacier shrinkage chen et al 2016 cogley 2016 the trends in snow phenology may be more important to understand snow dynamics in response to climate change in general the trends toward later sod earlier sed and shorter sdd are found in the most regions of the hma especially in major glacier areas from the hydrological year 2002 to 2020 in this study although there is a lack of studies on snow phenology across the whole hma in previous studies similar results were reported in the tibetan plateau chen et al 2018 sun et al 2020 wang et al 2017 and central asia li et al 2020b wang et al 2022 yang et al 2019 as well it is worthwhile mentioning that in tien shan both sod and sed advanced indicating that the shortened sdd is more related to the advanced sed than advanced sod a recent study conducted by yi et al 2021 indicated that there is a decreasing trend in sdd a delayed trend in sod and an advanced trend in sed in most area of the yarkant river basin and the west of upper indus basin associated with the karakoram mountains the results presented in fig 11 fits well with their findings the earlier sed in the snowmelt dominated river basins would contribute to increased snowmelt and advance the runoff peak to earlier the increased snowmelt will increase the risk of floods and increase the difficulties of the regional reservoir and agriculture management yang et al 2019 5 3 possible mechanisms for recent snow cover changes snow cover in areas with similar climatic conditions might respond differently given their different and complex topographies in hma previous studies have investigated the linkage between snow cover and topographic factors such as elevation aspect and slope gradient deng et al 2021 gurung et al 2017 li et al 2020b misra et al 2020 sharma et al 2014 in this study we explore the relationship between elevation and snow phenology fig 12 the regions with short sdd late sod and early sed are mainly located at low altitude area the reasons may be that has relatively high air temperature at low altitude area typically above 0 c makes it difficult for snow accumulation the low air temperature generally below 0 c at high altitudes coupled with abundant precipitation fully satisfy the conditions for the continuous development of snow thus sdd is more durable sod is more earlier and sed is more later easily forming permanent snow cover and glaciers areas at high altitudes moreover the change trend of snow phenology shows large differences under different elevations that is the sod is slightly advanced in the relatively low altitudes with elevation below 3300 m while sed and sdd show slight advanced and shortened trends in this case the shortened sdd could be mainly related to the advanced sed in these altitudes however in high altitudes with elevation above 3300 m it is obvious that the trend of sdd under different elevations corresponds very well to the trend of sod where the larger sod delay rightly corresponds to the higher sdd decrease significantly according to the correlation analysis between snow phenology and air temperature precipitation as shown in fig 13 the air temperature mainly has a positive impact on sod but a negative impact on sed accounting for 65 44 and 72 18 of all significantly controlled areas respectively the decreased air temperature could increase the probability of snowfall and is favorable for the maintenance of snow cover which would cause earlier sod during snow accumulation period however higher air temperature would trigger earlier sed earlier during snow melt period the precipitation mainly has a negative impact on sod but a positive impact on sed accounting for 34 18 and 23 78 of all significantly controlled areas respectively in the beginning of snow accumulation period the air temperature is usually below the frozen point thus the precipitation probably occurred as snowfall therefore the increased precipitation causes earlier sod and vice versa similarly more snowfall would delay sed during snow melt period in addition zhang et al 2022 confirmed the elevation dependence and variation characteristics of snow cover change over the tibetan plateau in our study the effects of air temperature and precipitation on snow phenology vary under different altitudes indeed fig 14 the sod is more correlated with air temperature than precipitation under almost all elevation zones especially in the elevation ranges of 5000 6000 m however the sed is more correlated with air temperature than precipitation below 4300 m and then the precipitation become the dominant factor with further increase of elevation moreover the air temperature of both snow accumulation period and snow melt period are almost rising under different elevations which coincides with the change trend of snow phenology as displayed in fig 12 the precipitation of snow accumulation period shows a decreased trend between 5000 and 6000 m which affects the postponement of sod even though the precipitation of snow melt period shows an increasing trend in all elevation zones this trend is too small to affect the advance of sed compared to the effect of air temperature 6 conclusions understanding the snow cover dynamic is critical for hydrological processes and climate system in this study the cloud removal of the daily modis snow cover products during 2002 2021 was firstly carried out on this basis this study investigated the spatiotemporal variations in snow cover with a special focus on the snow phenology from the hydrological year 2002 to 2020 and then the vertical difference of the effect of elevation on snow phenology and the relationship between snow phenology and air temperature precipitation were analysed the main findings are summarized as follows 1 the cloud gap filling method for modis snow cover products can effectively obtain the ndsi value under the cloud cover the overall mae and rmse of the cloud gap filling method are 0 054 and 0 125 respectively indicating that this method has relatively high accuracy on cloud reduction and snow information retrieval 2 spatiotemporal patterns of snow cover in hma show strong seasonal fluctuations and a large spatial heterogeneity the monthly sce over the whole hma generally showed a decreasing trend in most months from the hydrological year 2002 to 2020 during the study period the scd generally decreased the sod generally delayed the sed generally advanced and the sdd generally shortened and these changes were significant in 15 73 14 35 15 46 and 16 01 of the snow covered area respectively the snow cover in the west himalaya was enhancing with its increased sce increased scd and lengthened sdd 3 the spatial variability of snow phenology in hma shows a vertical zonality influenced by the altitude that is the sdd is longer the sod is earlier and the sed is later with higher elevation correlation analysis between snow phenology and air temperature precipitation showed that the snow phenology is significantly related to the changed air temperature and precipitation the increase of air temperature or the decrease of precipitation lead to the delayed sod and advanced sed the air temperature was the dominant factor affecting the interannual variability of sod and sed credit authorship contribution statement zhiguang tang conceptualization methodology formal analysis writing review editing supervision project administration funding acquisition gang deng methodology validation formal analysis investigation data curation software writing original draft guojie hu writing review editing hongbo zhang writing review editing haizhu pan writing review editing guoqing sang data curation software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national natural science foundation of china no 41871058 the state key laboratory of cryospheric science northwest institute of eco environment and resources chinese academy sciences no sklcs op 2020 08 and the scientific research foundation of hunan education department china no 20b227 
2854,a new dynamic wave cellular automata framework for two dimensional 2d shallow water flow swf modeling is herein proposed during the last decade the concept of cellular automata ca has been widely adopted to develop various 2d shallow water flow models such ca models use simple transition rules that only consider the conservation of mass and neglect the conservation of momentum as a result the models behave like the non inertia wave approximation which are not suitable for modeling strong discontinuous flows i e transcritical flows and wet dry interfaces to overcome this limitation the present study proposes a new ca framework swfca for 2d shallow water flow modeling in which the bernoulli hydraulic head is adopted to replace water level as the key factor to determine water movements a novel methodology for linking water depths and velocities in the framework is developed model verification is carried out through four cases of regular flows and six benchmark cases with strong discontinuous flows model efficiency assessment is also conducted to analyze the numerical performance under various flow conditions the outcomes indicate that the proposed swfca model and a non inertia wave ca based model wca2d both provide satisfactory results on regular flows in modeling strong discontinuous flows the swfca model performs better than the wca2d model and provides the same accuracy as the finite volume model with a hllc scheme fv hllc in the aspect of moving wet dry interfaces and flows under the partially wet condition the swfca model can achieve higher accuracy than the fv hllc model the numerical efficiency of the swfca model relates to the flow conditions involved as the portion of strong discontinuous flows in the computational domain is increasing the swfca model can be up to 305 5 and 121 0 1282 2 faster than the wca2d model and the fv hllc model respectively this novel ca based framework has been proved its accuracy and efficiency for shallow water flow modeling therefore it has considerable potentials as a useful tool for real time flood inundation modeling keywords shallow water flow cellular automata dynamic wave bernoulli hydraulic head data availability data will be made available on request 1 introduction shallow water flows reflect the conditions in which the water depth is much smaller than the horizontal dimensions of motion castro orgaz and hager 2019 in hydraulic engineering flows in rivers floodplains canals lakes reservoirs and coastal and urban areas are often regarded as shallow water flows and are generally described by the two dimensional 2d shallow water equations swes the 2d swes are a set of time dependent 2d nonlinear partial differential equations of hyperbolic type which are mathematically the depth averaged version of the three dimensional navier stokes equations in the past two decades a variety of numerical methods have been used to solve the 2d swes including mesh based methods such as finite difference methods finite element methods finite volume methods etc and meshless methods like smoothed particle hydrodynamics and moving particle semi implicit toro 2001 and castro orgaz and hager 2019 have extensive summaries on mesh based methods and chang et al 2014 2016 and sarkhosh and jin 2021 have detailed discussion on meshless methods so far the finite volume methods are one of the most commonly used modeling techniques due to their strong capabilities to efficiently handle flow transition xia et al 2017 hou et al 2018 yu and chang 2021 zhao and liang 2022 although the aforementioned methods can simulate conditions consisting of transcritical flows and wet dry interfaces with good accuracy toro 2001 the numerical efficiency could still be improved especially for large spatial scale applications solving the 2d swes at high spatial resolutions demands substantial computational resources which inevitably increases the required computational time to enhance numerical efficiency many researchers established their models using ca framework such as the ca flood inundation model dottori and todini 2011 the ca2d model ghimire et al 2013 the flood routing model cai et al 2014 the urban flood inundation model liu et al 2015 the wca2d model guidolin et al 2016 the ofs ca model jahanbazi et al 2017 and the ca ffé model jamali et al 2019 to replace the tedious numerical procedures with a set of simple generic transition rules executed on each computational cell wolfram 1984 in this way ca framework enables researchers to efficiently simulate complex physics by combining simple algebraic equations without adopting numerical iteration and or matrix solving guidolin et al 2016 some of them are coincidently identical to the finite volume methods under particular choices of numerical schemes caviedes voullième et al 2018 nevertheless each method has its advantages and drawbacks the finite volume methods use mathematical approaches e g local riemann solvers to explicitly or implicitly solve 2d swes and they often suffer from heavy computational demands on the other hand the ca solvers conceptually describe the movement of water by a set of transition rules thus the efficiency is greatly improved in particular the wca2d model has further lowered its computational demands by incorporating the local weight system giving significant improvement on efficiency without losing the required accuracy thus it has been widely applied to various applications in conjunction with other models e g water quality milašinović et al 2019 yin et al 2020 and urban flood inundation modeling wang et al 2018 chang et al 2021 all the aforementioned ca based models use water levels to determine water movements such that they behave like a non inertia wave approximation caviedes voullième et al 2018 these non inertia wave models subsequently fail to simulate strong discontinuous flows i e transcritical flows and wet dry interfaces but can provide good results on regular flows hereinafter defined as flows other than strong discontinuous flows costabile et al 2017 according to the above reviews numerical models that use explicit ca based algebraic equations as the transition rules to simulate shallow water flows efficiently and accurately are not yet available to fill this gap the main objective of the study is to develop a new dynamic wave ca framework for 2d shallow water flow modeling this new ca based 2d shallow water flow solver swfca adopts the bernoulli hydraulic head instead of water level as the key factor to determine the directions of water movement and a novel methodology for linking water depths and velocities in the framework is established to sequentially determine the transported amount of mass water depths and inertias water velocities the swfca model is first verified through four cases of regular flows which were previously used to validate the wca2d model then six benchmark cases with strong discontinuous flows moving wet dry interfaces transcritical flows with hydraulic jump and dam break flows are adopted to compare the accuracy of the swfca model wca2d model and a selected finite volume model technical attention is given to the local accuracy nearby strong discontinuities finally the numerical efficiency of the swfca model in different flow conditions is examined detailed discussion is devoted to the numerical performances on the global efficiency of the swfca model 2 shallow water flow solver based on cellular automata swfca in the present study the swfca model that can benefit from the high efficiency of ca framework without losing the required accuracy for simulating both regular flows and strong discontinuous flows is proposed the swfca model adopts the bernoulli hydraulic head a new methodology to link the water depths and velocities instead of the water level to determine the water movements to build the swfca model on ca framework three components are required to be processed i e 1 determine the neighborhood configuration 2 establish variables to describe the state of each discretized computational cell and 3 evolve the states of computational cells into new time steps by a set of transition rules these components are introduced in sections 2 1 to 2 3 respectively both the determinations of the adaptive time steps and the assignments of boundary conditions are parts of the transition rules such that they are introduced in section 2 3 in section 2 4 the proposed swfca and wca2d models are theoretically compared in the aspects of their numerical accuracy and efficiency 2 1 determine the neighborhood configuration the proposed swfca model adopts the square shaped cell to discretize the studied computational domain for the sake of programming convenience the swfca model selects the von neumann neighborhood configuration to define the spatial relation between a central cell and its surrounding cells chopard 2009 thus for each central cell there are four neighbor cells situated at the east north west and south sides for simplicity the central cell is indexed as 0 and its neighbor cells at the east north west and south sides are indexed as 1 2 3 and 4 respectively as fig 1a depicts the states of the central cell and its four neighbor cells are all utilized to evolve the states of the central cell into the next time step 2 2 establish variables to describe the state of each discretized computational cell the wca2d model uses water levels to distribute water directions and relates water velocities with water levels indirectly by utilizing the manning s and critical flow equations guidolin et al 2016 hence the wca2d model behaves like a non inertia wave approximation chang et al 2021 to enable the swfca model s capaity of handling strong discontinuous flows like dynamic wave models it is crucial to find an appropriate but simple way to describe the coupled relations between water depths and velocities of 2d swes thus the bernoulli hydraulic head is adopted as an essential factor for this task consequently the states of each computational cell are water depth water velocity along the x direction water velocity along the y direction and the bernoulli hydraulic head other related variables such as bed elevation and manning s roughness coefficient are both time invariant variables i e assuming no morphological and roughness changes all the aforementioned variables are defined at the center of each cell herein the bernoulli hydraulic head of a central cell is calculated as 1 h 0 z 0 d 0 u 0 2 v 0 2 2 g where g is the gravitational acceleration 9 81 m s2 u 0 and v 0 are the depth averaged velocities along the x and y directions respectively z 0 is the bed elevation d 0 is the water depth and h 0 is the bernoulli hydraulic head of the central cell in eq 1 z 0 d 0 u 0 2 v 0 2 2 g and h 0 refer to the elevation head pressure head velocity head and total head respectively with the bernoulli hydraulic head the swfca model gains the ability to simulate flow transition such as hydraulic jump where the consideration of water velocities is essential 2 3 evolve the states of computational cells into new time steps by a set of transition rules to advance the water depth water velocities and bernoulli hydraulic head at each time step a computing method comprising a set of transition rules is established to sequentially distribute mass water depths and inertias water velocities from a central cell to its neighbor cells through four flow transport routes between the central cell and the neighbor cells for each flow transport route the bernoulli hydraulic heads at the centers of the two connected cells and mass flux of the route are used to judge the flow direction of this route for either normal or special flow conditions the computing method under the normal flow condition is first introduced in section 2 3 1 then the detection of the special flow condition and the corresponding computing method are introduced in section 2 3 2 lastly section 2 3 3 presents the calculations of adaptive time steps and assignments of boundary conditions after the water depths and velocities in the computational domain are all updated 2 3 1 computing method normal flow condition the computing method under the normal flow condition consists of five sequential steps they are introduced as follows step 1 determine the flow direction based on the bernoulli hydraulic head and mass flux in this study the central cell sends out mass and inertias through a flow transport route on the condition that 1 the bernoulli hydraulic head of the central cell is greater than the neighbor cell 2 the mass flux of this route is outward from the central cell or zero and 3 the water depth of the central cell is greater than a threshold the first and second criteria refer to the flow directions at the next and current time steps respectively the second criterion is incorporated to prevent the potential chequerboard instability problem that the flow directions change oppositely between the two subsequent time steps bates et al 2010 the third criterion represents a restriction that no mass and inertias can leave a dry cell based on the three criteria concerning a wet cell when the mass flux of a route is zero the flow direction of the route is decided by criterion one only on the other hand if the mass flux is not zero both criteria 1 and 2 determine the flow direction considering the route between the central cell and i th neighbor cell for illustration the above three criteria are respectively formulated as the three inequalities in eq 2 2 h 0 h i ε and q 0 i θ 0 i 0 and d 0 δ where ε is the tolerance of the bernoulli hydraulic head difference δ refers to the water depth threshold that defines the central cell to be dry or wet i is the index of the neighbor cell i 1 to 4 0 i represents the i th flow transport route between the central cell and i th neighbor cell h 0 and h i are the bernoulli hydraulic heads at the central cell and i th neighbor cell respectively q 0 i is the mass flux of this route and is set as zero prior to the simulation d 0 refers to the water depth of the central cell θ 0 i is an internal variable of θ 0 1 1 θ 0 2 1 θ 0 3 1 and θ 0 4 1 to represent the flow direction it is noted that q 0 i θ 0 i 0 is equivalent to q 0 i 0 taking the central cell in fig 1a as an example there is no flow from the central cell to the 2 nd neighbor cell because h 2 h 0 conversely the central cell sends out mass and inertias through the other three routes and these three routes are marked to be under the normal flow condition the mass and inertia fluxes of the three routes are determined in steps 2 4 on the other hand the flow may move from the wet central cell to the wet neighbor cell despite the bernoulli hydraulic head of the neighbor cell is greater than the central cell and the mass flux of the route is outward from the central cell this condition is hereinafter referred to as the special flow condition and is resulted from the backwater effect lateral inflow of the neighbor cell or the lateral outflow from the central cell to obey the fundamental principle that water flows from larger to smaller bernoulli hydraulic heads the magnitude of the mass flux is subsequently lowered at least to zero to let the bernoulli hydraulic head of the central cell greater than that of the neighbor cell the identification of the special flow condition and the alternative ways for determining flow direction and mass flux are introduced in section 2 3 2 the inertia flux is computed by using the same step under the normal flow condition step 4 step 2 update the mass flux at each flow transport route in step 1 in step 2 based on the flow direction decided in step 1 each central cell updates the mass fluxes of its flow transport routes under the normal flow condition by using the manning s and weir equations for the central cell in fig 1b the mass fluxes of its 1 st 3 rd and 4 th routes are determined by 3 q 0 i θ i min q 0 i m a n n q 0 i w e i r where q 0 i m a n n is the mass flux computed by the manning s equation 4 q 0 i m a n n 1 n 0 l d i 5 3 h 0 h i l in which l is the cell length n 0 refers to the manning s roughness coefficient of the central cell d i is the water depth at the cell edge d 0 d i 2 q 0 i w e i r is the mass flux by the weir equation chaudhry 2022 that is modified to consider the bernoulli hydraulic head 5 q 0 i w e i r 2 3 l 2 g ψ h 0 3 2 6 ψ 1 h i h 0 1 5 0 385 in which z i max z 0 z i h 0 h 0 z i and h i max 0 h i z i in eq 6 ψ represents the free 1 or submerged weir flows the manning s and weir equations both relate the bernoulli hydraulic head to the mass flux therefore inertias are considered when determining a mass flux step 3 calculate the predicted water depth of each cell from the mass fluxes in step 2 after the mass flux of each flow transport route is updated in step 2 the predicted water depth of each central cell d 0 is then calculated by 7 d 0 d 0 δ t l 2 q 0 1 q 0 2 q 0 3 q 0 4 in which δ t is the adaptive time step q 0 1 q 0 2 q 0 3 and q 0 4 are the computed mass fluxes by eq 3 or eq 22 of the 1 st 2 nd 3 rd and 4 th routes respectively as fig 1c displays eq 7 is a simple equation that is based on mass conservation after the predicted water depth of each central cell is computed the computing method checks if any predicted water depth is negative also the flow directions determined in step 1 should remain unchanged with these predicted water depths taking the 1 st route in fig 1b as an example a criterion is applied to check if the flow direction is unchanged 8 h 0 ε z 1 d 1 u 1 2 v 1 2 2 g if negative predicted water depths are detected and or eq 8 is not satisfied δ t in eq 7 is globally decreased and step 3 is redone again step 4 predict the downstream water velocity of each flow transport route based on the predicted water depths in step 3 in this step the inertia flux of a flow transport route with a flow through is determined by calculating the predicted water velocity at the downstream end of the route a specific form of the energy equation with friction loss is used for this task due to its simplicity in relating the water depths and velocities for the central cell in fig 1d the adopted energy equation of the three routes can be formulated in a general form written in an implicit manner 9 h i h 0 l s f 0 i in which l is the length h 0 and h i are the updated bernoulli hydraulic heads of the central and i th neighbor cells respectively and s f 0 i is the updated friction loss of the i th route in eq 9 all terms except length l are undetermined the central and the i th neighbor cells are at the upstream and downstream ends of the route respectively with eq 9 the swfca model considers the effects of the convective acceleration water pressure gradient bed slope and friction slope terms in the 2d swes from the velocity head pressure head and elevation head and friction loss respectively as to the local acceleration of 2d swes it is indirectly simulated in the established transition rules nevertheless eq 9 has too many variables to be solved and thus it is explicitly expressed by the standard step method the only undetermined variable is the water velocity at the downstream end of the route taking the 1 st route in fig 1d as an example the explicitly exprressed eq 9 of the route is written as 10 u 2 0 1 v 2 1 2 g d 1 z 1 h 1 h 0 h 0 l 2 n 1 2 u 1 u 0 1 d 1 4 3 n 0 2 u 0 2 d 0 4 3 l s f 0 1 in which u 0 1 is the predicted water velocity at the downstream 1 st neighbor cell of this route and it is the only undetermined variable d 1 v 1 and n 1 are the predicted water depth from step 3 depth averaged velocity along the y direction and the manning s roughness coefficient respectively of the 1 st neighbor cell other variables related to the central cell h 0 d 0 u 0 are at the current time step the friction loss of the 1 st neighbor cell is written in a semi implicit manner which can help increase the numerical stability particularly at wet dry interfaces cea and bladé 2015 to meet the flow direction determined in step 1 u 0 1 should be larger than 0 i e u 0 1 0 and eq 10 is consequently written as eq 12 11 f u 0 1 1 2 g u 0 1 2 l 2 n 1 2 u 1 d 1 4 3 u 0 1 v 2 1 2 g d 1 z 1 l 2 n 0 2 u 0 2 d 0 4 3 h 0 12 f u 0 1 0 the two solutions in eq 12 can be easily decided without numerical iterations since f u 0 1 is a quadratic function of u 0 1 and only the solution that complies with u 0 1 0 is the final answer otherwise u 0 1 is given as 0 similarly to calculate the predicted water velocities at the downstream of the 3 rd and 4 th routes in fig 1d u 0 3 and v 0 4 respectively the corresponding quadratic functions of the two variables are respectively given in eqs 13 and 14 with u 0 3 0 and v 0 4 0 13 f u 0 3 1 2 g u 0 3 2 l 2 n 3 2 u 3 d 3 4 3 u 0 3 v 2 3 2 g d 3 z 3 l 2 n 0 2 u 0 2 d 0 4 3 h 0 14 f v 0 4 1 2 g v 0 4 2 l 2 n 4 2 v 4 d 4 4 3 v 0 4 u 2 4 2 g d 4 z 4 l 2 n 0 2 v 0 2 d 0 4 3 h 0 the final solutions of u 0 3 and v 0 4 are both determined in a similar manner of u 0 1 it is stressed that no special treatment of the bed elevation is involved when computing the predicted water velocities because the computations use the bed elevations at the cell centers therefore the proposed swfca model can correctly predict the water velocity on a steep plate which is numerically complicated for some finite volume dynamic wave models delestre et al 2012 xia et al 2017 zhao and liang 2022 nonetheless as the bed slope gradient is not limited in this formulation an extremely high value of the predicted water velocity may be computed when there is an abrupt change in terrain which could significantly decrease the adaptive time steps when the free water surface is horizontal and all of the water velocities are zero u 0 0 v 0 0 i e case of water at rest the bernoulli hydraulic head of each central cell eq 1 is exactly the water level z 0 d 0 in such a condition each route is judged to have no flow with its mass and inertia fluxes both equal to zero q 0 i 0 in step 2 and u 0 i 0 or v 0 i 0 in step 4 such that the swfca model can maintain a still free water surface the above deduction proves that the swfca model is inherently able to preserve the well balanced property or the c property without the need to use a special treatment of bed elevation on the other hand for other models such as the finite volume dynamic wave models a special bed slope discretization that cooperates with the reconstruction method is often required to maintain the well balanced property hou et al 2013 cea and bladé 2015 xia et al 2017 zhao and liang 2022 step 5 update the water depth velocities and the bernoulli hydraulic head of each cell from steps 3 and 4 in this step the water depth the water velocities and the bernoulli hydraulic head of each central cell are updated as presented in fig 1e the water depth d 0 is updated by considering the predicted water depth from step 3 d 0 and the other input output water volumes as 15 d 0 d 0 δ v 0 i n l 2 δ v 0 o u t l 2 in which δ v 0 i n refers to the input water volume of the central cell such as the precipitation and inflows from upstream catchments δ v 0 o u t is the output water volume of the central cell such as the infiltration or lateral outflows concerning the update of water velocities u 0 v 0 the predicted water velocities at the downstream of the routes through which the central cell sends water are considered as 16 u 0 γ u 0 1 u 0 1 γ u 0 3 u 0 3 17 v 0 γ v 0 2 v 0 2 γ v 0 4 v 0 4 with γ function given as 18 γ u 1 0 u 0 u 0 2 3 2 computing method special flow condition the special flow condition refers to the condition that the mass flux of a flow transport route is outward from a wet central cell to its wet i th neighbor cell when the central cell has a smaller bernoulli hydraulic head than the neighbor cell this condition is the consequence of the backwater effect lateral inflow at the neighbor cell or the lateral outflow of the central cell in this flow condition the flow through the route is damped leading to two possible circumstances i e 1 the flow direction of the route is unchanged but the magnitudes of the transported mass and inertias are both decreased or 2 the flow direction is reversed in the present study the second circumstance is excluded because the flow direction changes oppositely between the subsequent time steps in this circumstance to fulfill the basic rule that water can only move from larger to smaller bernoulli hydraulic heads alternative ways to delineate the flow direction and determine the mass flux of the route are herein proposed the same method is used to calculate the predicted water velocity at the downstream end of the route step 4 in section 2 3 1 first if a flow transport route does not satisfy eq 2 its flow direction is decided by a simple formula in analogy to the normal flow condition step 1 as 19 h i h 0 ε and q 0 i θ 0 i 0 and d 0 δ and d i δ in which h i h 0 ε violates the aforementioned basic rule and requires adjustment to follow the basic rule if eq 19 is fulfilled this route is marked to be under the special flow condition as illustrated in fig 2a the 1 st route does not fulfill eq 2 but satisfies eq 19 such that there is a flow from the central cell through this route otherwise there is no flow after the flow direction is determined the mass flux of this route is computed in an alternative way to let the bernoulli hydraulic head of the central cell be greater than the neighbor cell again step 2 as drawn in fig 2b the magnitude of the mass flux q 0 1 at the 1 st route is lowered with a magnitude as δ q 0 1 to satisfy eq 2 resulting in the inequality as 20 h 0 δ q 0 1 δ t l 2 h 1 δ q 0 1 δ t l 2 ε in which h 0 δ q 0 1 δ t l 2 represents the increased bernoulli hydraulic head of the central cell h 1 δ q 0 1 δ t l 2 refers to the lowered bernoulli hydraulic head of the neighbor cell δ q 0 1 δ t l 2 is the change of bernoulli hydraulic head due to the change of water depth pressure head it is noted that the 1 st neighbor cell should remain as a wet cell after this adjustment i e δ q 0 1 δ t l 2 d 1 δ considering the equal sign in eq 20 δ q 0 1 is formulated as 21 δ q 0 1 min l 2 2 δ t h 1 h 0 ε l 2 δ t d 1 δ the computed mass flux q 0 1 is finally given as 22 q 0 1 s i g n q 0 1 q 0 1 δ q 0 1 where sign is the sign function it is noted that if q 0 1 q 0 1 is less than 0 there is no flow through this route i e q 0 1 0 for the other routes the mass fluxes of them can be adjusted in the same way if they are marked to be under the special flow condition 2 3 3 stability criterion and boundary conditions 2 3 3 1 stability criterion the swfca model follows the courant friedrichs lewy cfl condition to determine the adaptive time step 23 δ t cfl min l u 2 v 2 gd where cfl is the courant number that ranges between 0 and 1 2 3 3 2 boundary conditions in the swfca model the assignments of boundary conditions are processed after step 5 closed inlet and outlet boundaries are considered herein no mass and inertias can pass through a closed boundary the same as a reflective boundary thus there is no input output water volume at the adjacent computational cell and the water velocity of the cell is unchanged at an inlet boundary the water depth of the inner computational cell is updated by adding the inflow m3 s as an input water volume to consider the inertia effect of the inflow the water velocity of the inflow is determined according to the specified flow condition under supercritical flows this water velocity u or v is imposed by the user in cases of subcritical flows the water velocity is calculated by using the water depth at the cell as q l d 0 for critical flows the critical water depth d critical of the given mass flux q is first calculated by the critical flow equation 24 d critical q l 2 g 1 3 then the water velocity of the inflow is computed q l d critical and the water velocity of the cell along the normal direction of the inflow is subsequently updated next the bernoulli hydraulic head of the cell is calculated again eq 1 at an outlet boundary the outflow m3 s is determined by using the water depth and velocity of the inner computational cell according to the alignment of the outlet boundary q l u 0 d 0 or q l v 0 d 0 and the water depth of the cell is subsequently updated by subtracting the outflow as an output water volume then the water velocity of the outflow is computed to include the inertia effect of the outflow for supercritical flows the water velocity is calculated by using the water depth of the inner computational cell as to subcritical flows the water depth imposed by the user is used for computing the water velocity in terms of critical flows the critical water depth is determined by eq 24 and then the water velocity of the outflow is decided next the water velocity with a direction from the cell to the outlet boundary is used to replace the water velocity of the inner computational cell along the direction normal to the outlet boundary finally the bernoulli hydraulic head of the cell is calculated again 2 4 comparison of the computing method and solving procedures between the wca2d and swfca models the major difference between the wca2d and swfca models is on the computation of water movement between adjacent cells the wca2d model uses water levels to determine the intercellular volumes of water across cell edges as it lacks the inertia terms the permissible intercellular velocities involved in the computations are subsequently determined based on water level gradients by using the manning s and critical flow equations guidolin et al 2016 the magnitude and direction of an intercellular volume may change rapidly between subsequent time steps hence the wca2d model can only handle critical and subcritical flows because the intercellular velocities are constrained by the critical flow equation guidolin et al 2016 chang et al 2021 such that the wca2d model can only obtain accurate results on regular flows under critical subcritical flow conditions on the other side the proposed swfca model uses the bernoulli hydraulic head to distribute water such that the spatial and temporal changes of inertias are both simulated the computing method of the swfca model uses the bernoulli hydraulic head and a particular form of the energy equation with friction loss to decide the changes in mass and inertias through flow transport routes as the adopted energy equation is a special form of the 2d swes the swfca model is expected to accurately handle regular flows and strong discontinuous flows like the dynamic wave models the accuracy of the two ca based models is next compared in section 3 as to the numerical efficiency the execution time on cpu instead of gpu is used for comparison since the technique of parallelization is beyond the scope of this manuscript the total cpu time is influenced by two factors i e the required time to execute the solving procedure in each time step and the magnitudes of adaptive time steps in terms of the solving procedures in each time step the wca2d model consists of two steps to determine the intercellular volumes and update the state of each central cell based on these intercellular volumes guidolin et al 2016 the swfca model comprises four steps steps 1 to 4 in section 2 3 1 to determine the fluxes of mass and inertias through each flow transport route and update the states water depth and velocities of each central cell based on these fluxes step 5 in section 2 3 1 hence the swfca model demands more computational effort to execute the solving procedure in each time step compared to the wca2d model as to the magnitudes of adaptive time steps the wca2d model behaves like the non inertia wave approximation thus it takes the minimum value between the cfl condition and the formula given by hunter et al 2005 as the adaptive time step to maintain its numerical and physical stabilities on the other side as the swfca model simulates inertias like the other dynamic wave models the adaptive time step of it is calculated by the cfl condition only the relative relationship between the wca2d and swfca models in terms of the adaptive time steps is thus similar to that of the non inertia wave and dynamic wave models and the wca2d model is expected to use smaller adaptive time steps than the swfca model hunter et al 2005 caviedes voullième et al 2020 in general despite the swfca model involves more computational procedures within a time step the total cpu time of these two models is still affected by the magnitudes of the adaptive time steps thus which model is faster is case by case for a simulation in milder flow conditions with relatively smooth profiles of water depths and velocities both the wca2d and swfca models have relatively larger adaptive time steps by contrast in severe flow conditions the adaptive time steps of the wca2d model are smaller than those of the swfca model therefore the swfca model could perfom faster conversely when the flow conditions in a simulation are largely milder the efficiency of the wca2d model can outperform the swfca model based on the above deduction the numerical efficiency of the swfca model is related to the flow conditions involved to confirm the above deduction the numerical efficiency assessment in sections 4 and 5 is given to compare the efficiency of the proposed swfca model with the wca2d model on the test cases with various flow conditions 3 model verification in this section the accuracy of the swfca model is verified through four cases with regular flows and six benchmark cases of strong discontinuous flows the widely used wca2d model is selected to compare with the swfca model in section 3 1 the swfca model is verified through four regular flow cases which were previously studied by guidolin et al 2016 to demonstrate their wca2d model in subsections 3 2 six benchmark cases with a relatively large portion of strong discontinuous flows are adopted to understand the capability of the proposed swfca model on handling this kind of extreme flow conditions in addition among various dynamic wave models the present study chooses the first order godunov type finite volume model to further find out how accurate the proposed swfca model can be on simulating strong discontinuous flows this finite volume model uses the hllc scheme which is popularly used in many academic and commercial programs to compute numerical fluxes on cell edges yu and chang 2021 and it is hereinafter to be referred to as the fv hllc model for simplicity in these ten cases the numerical accuracy of each selected model is quantified by calculating the l2 norm between the numerical and measured analytical results chang et al 2016 yu and chang 2021 3 1 regular flows among the cases given by guidolin et al 2016 this study selects the first fourth cases one 1d analytical case and three ea benchmark cases for model verification the first case refers to non breaking wave propagation over a horizontal plane in this case most of the shallow water flows are having low froude numbers the other three selected cases are all ea benchmark test cases including filling of a floodplain eat2 flood propagation over an extended floodplain eat4 and runoff produced by rainfalls and a point source in an urban area eat8a the grid resolution is 1 m for the first case thus there are 5 001 computational cells in the first case as to the other three cases the grid resolutions are 20 m 5 m and 2 m respectively hence the three ea cases have 10 000 80 000 and 97 000 computational cells respectively the rest settings of the four cases are all the same as in guidolin et al 2016 to compute l2 norms for water depths in the four cases the analytical solution and simulated results reported in guidolin et al 2016 are used in the first case the simulated analytical water depth profiles when the time is 3600 s are used for computing l2 norms so there is 5 001 data for each l2 norm computation as for the other three cases the temporal water depth profiles at the specified locations of the selected dynamic wave model in guidolin et al 2016 are taken to compute a single l2 norm for each case thus based on the output frequencies given by néelz and pender 2013 the rest three cases respectively use 577 901 and 601 data to compute their l2 norms for the wca2d model the l2 norms are computed by using the simulated results under the fine type slope tolerance which has better accuracy than the coarse type slope tolerance guidolin et al 2016 the values of the fine type slope tolerance can be found in table 2 of guidolin et al 2016 the calculated l2 norms for water depths of the wca2d and swfca models in the four cases are listed in table 1 from table 1 the l2 norms of the wca2d model in these cases are 0 011 0 003 0 006 and 0 001 respectively and the l2 norms of the swfca model are 0 011 0 001 0 001 and 0 001 respectively the results show that both the wca2d and swfca models simulate regular flows in these four cases accurately nevertheless the accuracy of the swfca model is slightly better than the wca2d model because there are still some strong discontinuous flows in these cases 3 2 strong discontinuous flows six benchmark cases with a large portion of strong discontinuous flows in the computational domain are adopted herein to verify the accuracy of the proposed swfca model the wca2d and fv hllc models are also selected for comparison in the first two cases cases a and b unsteady flows with a large portion of moving wet dry interfaces on uneven terrain are considered a special focus is devoted to examining the capability of the swfca model in simulating moving wet dry interfaces with changes in terrain case a and very shallow overland flows on the steep hillside case b then transcritical flows with a hydraulic jump in the steady state are considered case c to test if the swfca model can correctly simulate hydraulic jumps then the swfca model is evaluated through three dam break flow cases on idealized case d and realistic terrain cases e and f to verify its numerical performance on more complicated flow conditions case d considers dam break flows over a symmetric triangular bump with various downstream boundary conditions in this case hydraulic jumps drops moving wet dry interfaces and partially reflective waves occurred for case e a real dam break event i e the malpasset dam break event is used to test the applicability of the swfca model in handling dam break flows on a realistic terrain with complex river floodplain interactions as the dam break flows pass through the meander reyran river valley strong discontinuous flows moving wet dry interfaces hydraulic jumps drops all occur finally in case f the present study considers 2d dam break flows over the field scale floodplain with a staggered configuration of buildings when the dam break flows pass through these buildings hydraulic jumps occurred in fronts of buildings because of the limited flow paths consequently moving wet dry interfaces along with the dam break flows and hydraulic jumps drops around the buildings emerged along both x and y directions 3 2 1 case a moving shorelines in a 2d frictional parabolic bowl moving wet dry interfaces case a involves moving shorelines in a 2d frictional parabolic bowl the analytical bed elevation water levels and water velocities are presented by sampson et al 2006 following the works by hou et al 2013 and zhao and liang 2022 the center of the 8000 m 8000 m square computational domain is at 4000 m 4000 m as for other parameters h 0 10 m a 3000 m b 5 m s and τ 0 002 1 s which leads to p 0 0093 1 s and s 0 0046 1 s all boundaries are closed the bowl shaped terrain of the computational domain is depicted in fig 3a as the topography line for illustration initially the water levels and velocities of the computational domain are filled with the analytical values with t 0 s the simulation duration is 6000 s as to the setting of friction the friction parameter τ is used instead of the manning s roughness coefficient n hence each selected model is modified to use the friction parameter τ for the fv hllc model the friction slope vector in eq 13 of yu and chang 2021 is redefined as 25 s f i j s 1 0 τ q x s 1 i j τ q y s 1 i j t in which s f s 1 q x s 1 and q y s 1 are defined in yu and chang 2021 concerning the proposed swfca model eq 11 is rewritten as 26 f u 0 1 1 2 g u 0 1 2 l τ 2 g u 0 1 v 2 1 2 g d 1 z 1 l τ 2 g u 0 h 0 eqs 13 and 14 can also be rewritten in the same way as to the wca2d model the maximum permissible intercellular velocity v m in eq 9 and the adaptive time step δ t in eq 18 of guidolin et al 2016 are respectively rewritten as 27 v m min d 0 g g τ δ l 0 m δ x 0 m 28 δ t δ x 2 4 min τ gr s σ the definitions of δ l 0 m δ x 0 m r s and σ can be found in guidolin et al 2016 to quantify the accuracy of the selected model the simulated water level and velocity profiles on the diagonal line between point 0 m 0 m and point 8000 m 8000 m at t 1 375 t s period t 1377 68 s are used to calculate the l2 norms for water levels and velocities respectively a grid convergence test is undertaken first to decide an optimal grid resolution that can lead to an acceptable accuracy meanwhile the numerical diffusion and dispersion properties of the swfca model are also investigated then an accuracy comparison among the selected models is performed under this grid resolution 1 grid convergence test several grid resolutions are considered in this test for the sake of demonstration only the results at the grid resolutions of 5 m 10 m 25 m and 50 m are presented here consequently calculations of the l2 norm at these four grid resolutions take 1 600 800 320 and 160 data respectively the calculated l2 norms for water levels and velocities are all listed in table 2 when the grid resolution becomes finer all the three l2 norms are decreased furthermore when the grid resolution is finer than 10 m the swfca model can provide accurate results compared to the analytical solutions proving the correctness of the swfca model on handling the fluxes mass and inertias bed elevation and friction under proper grid resolutions this result also confirms that the numerical diffusion and dispersion of the swfca model become less when the grid resolution is getting finer finally for the accuracy comparison the grid resolution of 10 m is selected since the subsequent accuracy is acceptable 2 accuracy comparison the accuracy comparison is conducted under the grid resolution of 10 m leading to the grid system of 800 800 the simulated profiles of water levels and velocities u and v on the diagonal line are drawn in figs 3a 3b and 3c the analytical solutions are also plotted in these figures concerning the water level profiles fig 3a displays the results of the fv hllc and swfca models both match the analytical solutions well but the wca2d model can only produce a still water level profile as to the u velocity profiles depicted in fig 3b the results of the fv hllc and swfca models are both in good agreement with the analytical profile despite some overestimations nearby the moving wet dry interfaces from fig 3b the swfca model has less overestimation on the u velocity profile around the wet dry interfaces than the fv hllc model from the viewpoint of the v velocity profiles drawn in fig 3c both the fv hllc and swfca models provide reliable and identical predictions the l2 norms for water levels and velocities are listed in table 3 for comparison from figs 3a 3b and 3c and table 3 the wca2d model fails to simulate the flows in case a because it lacks the consideration of inertias the swfca model is confirmed to be as accurate as the fv hllc model on water level and v velocity profiles and can be more accurate than the fv hllc model on u velocity profiles particularly around the wet dry interfaces this result is related to the differences in determining the water velocities between the two models in the selected fv hllc model the water velocity is indirectly calculated and inversely proportional to the water depth since the model solves conserved variables d du dv making the water velocity increase to a spurious extent at the wet dry interface where water depth is quite small toro 2001 on the other hand the swfca model decides the predicted water depth and then finds the predicted water velocity by a special form of the energy equation with friction loss eqs 11 13 or 14 in step 4 and eqs 16 and 17 in step 5 such that the water velocity at the wet dry interface is constrained by the friction loss term thus the swfca model produces less overestimation of the water velocity compared to the fv hllc model 3 2 2 case b shallow overland flows in a steep v shape catchment moving wet dry interfaces in case b very shallow overland flows and channel flows are involved in an idealized v shape catchment xia et al 2017 hou et al 2018 zhao and liang 2022 this study case was originally studied by di giammarco et al 1996 and the analytical solutions for discharge hydrographs were provided by utilizing the kinematic wave theory later simons et al 2014 reproduced the analytical solutions the rectangular computational domain consists of two hillsides with the same size of 1000 m 800 m and a 20 m wide 1000 m long channel in between the two hillsides as illustrated in fig 4a on the two hillsides the slopes in the directions parallel and normal to the channel are 0 and 0 05 respectively as to the channel the slope is 0 02 and the depth of it ranges from 1 m upstream end to 20 m downstream end a uniform rainfall with a constant rainfall intensity of 10 8 mm hr drops water on the two hillsides for 1 5 hrs all boundaries are closed except for the channel outlet where the open boundary condition the same as the transmissive boundary condition is imposed to let water flows out initially the whole computational domain is dry the simulation duration is about 3 3 hrs 12000 s when the rainfall started the water fell on the hillsides and became very shallow overland flows due to the steep slope these runoffs then flowed into the channel with a sudden drop in terrain after the rainfall stopped the runoffs began to recede and the computational domain gradually dried the manning s roughness coefficients are 0 015 s m1 3 on the hillsides and 0 15 s m1 3 on the channel to quantify the numerical accuracy the simulated and analytical discharge hydrographs at the hillside and the channel outlet are used to determine two l2 norms for discharge hydrographs hence the computations of l2 norms use 11 880 and 5 805 data at the hillside and the channel outlet respectively similar to case a a grid convergence test is performed and the grid resolution of 10 m is recognized to be the most suitable therefore for the following accuracy comparison the square cell with the length of 10 m is used to discretize the computational domain into 16 463 cells figures 4b and 4c depict the simulated discharge hydrographs at the channel outlet and hillside respectively the analytical solutions are also drawn in these figures obviously the fv hllc model fails to simulate the discharge hydrograph at the channel outlet correctly thus the simulated results of another fv hllc model with a more robust scheme i e the pm model by zhao and liang 2022 are included in the figures as the pm model clearly the swfca and pm models have very identical results that are both in close agreement with the analytical solutions on the other hand the fv hllc model can only provide satisfactory results for the discharge hydrograph at the hillside since it cannot resolve the partially wet condition in case b zhao and liang 2022 the discharge hydrographs of the wca2d model are both significantly delayed because the intercellular velocities on the hillsides are forced not to exceed critical velocities the time series of water depths at the channel outlet and the downstream end of the hillside are drawn in figs 4d and 4e respectively similar relations among the four models are shown again the swfca model computes almost the identical water depth series compared to the pm model on the other hand the fv hllc model underestimates the water depths at both two locations which is also seen in the work of zhao and liang 2022 the major cause of this difference is due to the incapability of the fv hllc model in handling the partially wet conditions that occurred on the hillside in case b xia et al 2017 zhao and liang 2022 the l2 norms for discharge hydrographs at the hillside and channel outlet of the selected models for this case are listed in table 3 inspection of table 3 confirms that the swfca model is as accurate as the fv hllc model in predicting the discharge at the hillside and has better performance on the discharge at the channel outlet than the fv hllc model as to the wca2d model it is not suitable to simulate case b to sum up cases a and b prove that the swfca model has the same accuracy as the fv hllc model and has better performance than the wca2d model nevertheless in the aspect of moving wet dry interfaces case a and flows under the partially wet condition case b the swfca model is more robust than the selected fv hllc model and can even provide the same accurate results as another fv hllc model with more complicated numerical procedures pm model by zhao and liang 2022 for case b this result is related to the numerical procedures in the swfca and fv hllc models from the viewpoint of moving wet dry interfaces in case a the water velocity and depth are inversely proportional in the selected fv hllc model such that the water velocity may raise to an extremely high value at the wet dry interface because of the considerably small water depth conversely the swfca model first updates the predicted water depth steps 2 and 3 and then computes the predicted water velocity step 4 letting the water velocity at the wet dry interface be constrained by the friction loss term eqs 11 13 and 14 in case b because the water depths on the hillsides about 0 005 m from fig 4e are much smaller than the bed elevation difference between two adjacent cells the selected fv hllc model numerically defines the local riemann problem as the dry bed dam break problem such that the uniform overland flows on the hillsides are modeled as waterfall which is physically wrong xia et al 2017 this waterfall effect can be resolved by using a more robust reconstruction method like the pm model does zhao and liang 2022 unlike the two fv hllc models the swfca model directly uses nodal bed elevations to compute the transported mass and inertias thus it can successfully handle this partially wet condition overall the computing method of the swfca model has shown its capability to handle flows on uneven terrain and terrain with a steep hillside 3 2 3 case c transcritical river flows with hydraulic jump transcritical flows case c considers river flows with mixed flow conditions the analytical solutions of the bed slope bed elevation and water depths provided by macdonald et al 1997 were all modified to fulfill the wide rectangular channel assumption of the selected models the length and width of the computational domain are 1000 m and 10 m respectively a time invariant inflow of 20 m3 s is given on the left edge as the upstream boundary condition as for the downstream boundary condition a fixed water depth of 1 35 m from the exact water depth profile is set on the right edge to introduce the backwater effect initially the water depths of the computational domain are given as the exact water depths as for the water velocities they are initially given as zero after the simulation starts water comes from the upstream boundary and moves downward to ensure the flows become steady again the simulation lasts for 3600 s the manning s roughness coefficient of the computational domain is given as 0 02 s m1 3 macdonald et al 1997 the simulated profiles of water depths and velocities at t 3600 s are used to calculate the l2 norms for water depths and velocities respectively to focus on the numerical performance around the hydraulic jump only data with its x coordinate being between 550 m and 650 m is adopted for the computations of l2 norms after a grid convergence test like case a square cells with a cell length of 1 m are used to discretize the computational domain into 11 011 computational cells consequently there are 101 uniformly distributed data used for determining each l2 norm the simulated water level profiles of the three selected models are plotted in fig 5a the analytical water level profile is displayed in fig 5a as well as for the water velocity profiles the simulated together with the analytical profiles are drawn in fig 5b apparently from these two figures the wca2d model fails to correctly simulate the hydraulic jump as expected also the wca2d model cannot simulate supercritical flows because the water velocity is constrained by the critical flow equation the simulated profiles of the swfca and fv hllc models are very similar and are both in good agreement with the analytical solution the comparison of numerical accuracy is listed in table 3 from this table and figs 5a and 5b the swfca model has shown its ability to simulate hydraulic jump and it can provide the same accurate results as the fv hllc model 3 2 4 case d dam break flows over a symmetric triangular bump with various downstream boundary conditions dam break flows on idealized terrain in case d a cadam test case morris 2000 with moving dam break flows over a symmetric triangular bump is studied zhou et al 2004 kao and chang 2012 to examine the performance of the proposed swfca model with complex boundary conditions partially reflective waves hydraulic jumps drops and wet dry interfaces all emerge because of the irregular bed slope a reservoir with a length of 15 5 m a width of 1 0 m and a height of 1 0 m is connected to a rectangular rough channel with a length of 22 5 m the gate of the reservoir is placed at x 15 5 m the center of the symmetric triangular bump is at x 28 5 m with a length of 6 0 m and a height of 0 4 m both the slopes in the reservoir and the channel are zero the configuration of the case is depicted in fig 6a water depth hydrographs were measured at four water depth gauges i e g4 g10 g13 and g20 as their locations are displayed in fig 6a there were originally three scenarios tested in the case the present study adopts the first two scenarios among the three scenarios because the wca2d model cannot simulate the third scenario the first scenario refers to the dry bed condition with the open end at the right edge and the second scenario is the wet bed condition with the closed end at the right edge in these two scenarios the initial water depth in the reservoir is given as 0 75 m as to the downstream boundary conditions in the first scenario the downstream channel located at the downstream side of the triangular bump is initially dry and this channel is open at the right end as fig 6a illustrates for the second scenario an initial water depth of 0 15 m is prescribed on the downstream channel by incorporating a vertical wall at the end of the channel drawn in fig 6b in both two scenarios dam break flows propagate downward in the supercritical flow condition after the simulations start the simulation durations of the two scenarios are both 40 s the manning s roughness coefficient is 0 0125 s m1 3 chang et al 2011 kao and chang 2012 concerning the settings of the boundary conditions at the right end the open and closed ends are respectively prescribed as the transmissive and reflective boundaries for both the swfca and fv hllc models l2 norms for water depths are used to evaluate the numerical accuracy of the three selected models for each l2 norm the simulated water depth hydrographs at the four gauges are all used with the measured data to determine a single l2 norm value thus for each selected model there are 142 and 152 data used for the computation of water depth l2 norms in the first and second scenarios respectively a grid convergence is undertaken in the same way as case a and the computational domain is discretized by square cells with a length of 0 1 m leading to 4 411 cells the simulated water depth hydrographs at the four selected gauges in the first and second scenarios are plotted in figs 6c and 6d respectively the simulated water level profiles of the three models at t 9 7 s in the two scenarios are presented in figs 6e and 6f respectively the measured data is also displayed in these figures from figs 6c and 6d in both the two scenarios there exist significant discrepancies between the simulated results of the wca2d model and the measured data at these four water depth gauges specifically the overtopping of water across the triangular bump and the reflective wave are both not correctly simulated by the wca2d model this result is majorly attributed to the use of the critical flow equation that constrains the water velocity of the dam break front by contrast the swfca and fv hllc models both provide accurate enough profiles in spite of some small discrepancies between the simulated profiles and measure data at water depth gauge g20 these differences are also observed in chang et al 2011 since the selected models are 2d shallow water flow models that lack the consideration of vertical acceleration terms in their numerical schemes nevertheless inspection from figs 6e and 6f reveals that the swfca and fv hllc models provide almost identical water level profiles and both successfully simulate partially reflective waves as well as hydraulic jumps drops on the other hand the wca2d model fails to give reasonable outcomes the l2 norms for water depths of the three models in the two scenarios are displayed in table 3 which confirms that the accuracy between the swfca and fv hllc models is very identical hence the computing method of the swfca model can successfully simulate very complicated flows with moving shock waves partially reflective waves and overtopping water amounts accurately in these two scenarios 3 2 5 case e malpasset dam break event on the reyran river floodplain dam break flows on realistic terrain the malpasset dam break event is a real dam break event that happened in france in 1959 killing 423 people in the resulting flood on the downstream side of the reyran river floodplain this dam break event is included in the cadam project soares frazão et al 1999 and is a useful benchmark case for studying dam break waves propagation in a natural topography kao and chang 2012 hou et al 2013 the configuration of the reyran river floodplain is drawn in fig 7a for illustration the local police investigated and reported the maximum water levels at 17 locations p1 to p17 along the reyran river valley soares frazão et al 1999 three electric transformers t1 to t3 were destroyed by the flood and their shutdown times represent the wave arrival times of the flood wave moreover a non distorted 1 400 scale model was built and calibrated against the observations aforementioned from this scale model the maximum water levels and wave arrival times of 9 gauges s6 to s14 downstream the dam were measured the locations of the aforementioned 17 investigated points 3 electric transformers and 9 experimental gauges are depicted in fig 7a initially the whole computational domain is assumed to be dry except for the reservoir where a constant water level of 100 m with zero velocities is prescribed the boundaries in the sea are opened and the rest boundaries are closed the simulation lasts for 3600 s and the manning s roughness coefficient of the computational domain is given as 0 033 s m1 3 kao and chang 2012 hou et al 2013 the malpasset dam is simplified as a straight line in the narrow valley of the reyran river and the ruins of the dam are assumed to have no effects on the dam break flows soares frazão et al 1999 the maximum water levels at the 17 investigated points and 9 experimental gauges are used to calculate a single l2 norm for the maximum water levels similarly a single l2 norm for wave arrival times is decided by using the arrival times at the 3 electric transformers and 9 experimental gauges similar to previous cases a grid convergence test is taken and the computational domain is subsequently discretized into 520 359 square cells with a length of 10 m the bed elevation of each computational cell is interpolated by employing the natural neighbor interpolation figures 7b and 7c display the simulated maximum water levels at the 17 investigated points and at the 9 experimental gauges respectively the wave arrival times at the 3 electric transformers and the 9 experimental gauges are drawn in figs 7d and 7e respectively the measured data is included in these figures for comparison the simulated results of the swfca and fv hllc models are found to be very similar and agree reasonably well with the measured data on the other hand the wca2d model tends to overestimate the maximum water levels in the narrow valley i e p3 p5 p6 p8 and s10 and underestimate the maximum water levels in the downstream floodplain i e p10 to p17 and s11 to s14 this result is related to the use of the critical flow equation in the wca2d model that slows down the movement of the dam break flows leading to the underestimations of the arrival times shown in figs 7d and 7e the l2 norms for the maximum water levels and arrival times are listed in table 3 as the l2 norms between the swfca and fv hllc models are the same the swfca model is found to have the same accuracy as the fv hllc model on simulating 2d dam break flows in a realistic river floodplain 3 2 6 case f discharge flows over the toce floodplain with staggered buildings dam break flows on realistic terrain in this case dam break flows towards buildings in the staggered configuration are studied by adopting the experimental case originating from impact and cadam projects testa et al 2007 in the present study the original valley geometry scaled 100 times down from the toce river valley is adopted as shown in fig 8a all the three inflows hydrographs given at the left edge are adopted displayed in fig 8a as well leading to three scenarios in case f as low medium and high inflow scenarios in these three scenarios a staggered building layout is considered fig 8a ten water depth hydrographs were measured at ten water depth gauges locations are also depicted in fig 8a the simulation durations of the three scenarios are all 60 s the elevations of the cells where the buildings locate are raised up by 0 15 m the manning s roughness coefficient is given as 0 0162 s m1 3 as suggested by testa et al 2007 among ten water depth gauges the water depth hydrographs at eight gauges p3 to p10 in fig 8a are used to determine a single water depth l2 norm yu and chang 2021 consequently there are 2 408 measured data for the computation of each l2 norm for water depth a grid convergence test is performed and square cells with a cell size of 2 5 cm are used to discretize the computational domain into 54 964 cells figs 8b 8c and 8d display the simulated and measured profiles of water depths at the selected gauges for the low medium and high inflow scenarios respectively from these figures the simulated results of the swfca and fv hllc models all match the measured data reasonably well at the selected gauges nonetheless for the wca2d model the simulated water depths at the p3 to p6 gauges are obviously underpredicted this result is because the wca2d model cannot reflect the raise of water depths due to hydraulic jumps costabile et al 2017 nevertheless at the p7 to p10 gauges the wca2d model is capable to give satisfactory water depths because the flow conditions turn into regular flows the l2 norms for water depths in the three scenarios are calculated and listed in table 3 for accuracy comparison in table 3 the accuracy of the swfca model is again demonstrated to be the same as the fv hllc model hence it is confirmed that the proposed swfca model has the ability to accurately simulate 2d dam break flows on a complex terrain with hydraulic jumps drops and moving wet dry interfaces in case f based on the results from cases d e and f the swfca model has shown its remarkable robustness on handling the complex interactions between dam break flows topography and boundary conditions through the accuracy comparison between the simulated and analytical results the swfca model can achieve good accuracy as the fv hllc model on partially reflective waves hydraulic jumps drops moving wet dry interfaces and regular flows on idealized and realistic terrain hence the swfca model can produce reliable results on dam break flows the wca2d model has less accuracy than the swfca model as expected in general the swfca model can accurately simulate regular flows and strong discontinuous flows through these representative cases the wca2d model is found to have satisfactory accuracy only in cases with a small portion of strong discontinuous flows on the other hand the swfca model is as accurate as the fv hllc model in these selected cases which is not surprising because the used form of the energy equation in the swfca model is actually another special form of the 2d swes also the l2 norms for evaluating the numerical accuracy use a relatively large range of simulated measured data nevertheless the swfca model has better accuracy than the fv hllc model for simulating moving wet dry interfaces and flows under the partially wet condition despite that it is still worth mentioning that the performance of the swfca model in other cases with stronger discontinuities should be tested in the future 4 model efficiency assessment section 3 has demonstrated through ten cases that the swfca model can accurately simulate regular flows and strong discontinuous flows in particular for strong discontinuous flows the swfca model is as accurate as the fv hllc model and can be more accurate than the fv hllc model under specified flow conditions on the other hand the wca2d model can only provide satisfactory results on regular flows the next issue is about the efficiency of the swfca model in this section the model efficiency of the swfca model is assessed and compared with the wca2d model through the ten cases in section 3 in total there are thirteen simulations for each model to minimize the differences in the numerical implementation the swfca model is written in the same code structure as the wca2d model and their simulations are all executed on an intel r core tm i9 9900k pc equipped with 6 0 gb ram without activating parallel computing the clock speed of the core is 3 4 ghz the total cpu time of the two models in the ten cases is recorded and listed in table 4 in terms of the regular flow cases the wca2d model takes more the total cpu time than the swfca model in the first and third cases mainly because the moving wet dry fronts of the inflows occurred in these two cases involve considerably high froude numbers by contrast the wca2d model outperforms the swfca model in the second and fourth cases as expected for the strong discontinuous flow cases in case a the wca2d model spends less the total cpu time than the swfca model simply because there is no intercellular volume computation after the simulated water levels become still from the other five cases the swfca model is 162 9 to 23760 0 faster than the wca2d model since the latter tend to use very small adaptive time steps to stably propagate flows this result may also be attributed to the fact that the grid resolutions in cases b to f are quite small making the adaptive time steps of the wca2d model very small to comply with the required accuracy conversely the swfca model can efficiently simulate regular flows and strong discontinuous flows nevertheless because the involved flow conditions in these ten cases are quite different it is difficult to explain the above results by the deduction in section 2 4 thus an extended evaluation to investigate the model efficiency of the swfca model in a designed condition is conducted next 5 extended model efficiency evaluation as discussed in section 2 4 the total cpu time is influenced by the required time to execute the solving procedure in each time step and the magnitudes of adaptive time steps consequently the flow conditions involved also have an impact on the efficiency of the wca2d and swfca models when the portion of strong discontinuous flows in the computational domain increases the swfca model could simulate more efficiently than the wca2d model as the potion is small the wca2d model is faster than the swfca model despite the efficiency comparison of the swfca and wca2d models is performed in section 4 it is very hard to explain the compared results as the flow conditions in ten cases are different therefore an extended model efficiency evaluation with various designed flow conditions is conducted to qualitatively compare the efficiency between the wca2d and swfca models the fv hllc model used in section 3 is included for efficiency comparison as well and it s also rewritten in the same code structure as the wca2d model for the comparison for non inertia wave numerical models to maintain physical and numerical stabilities the adaptive time steps are quadratically decreased with respect to grid resolutions which subsequently introduces heavy computational loads i e very long the total cpu time for fine grid resolutions hunter et al 2005 generally non inertia wave models are often used on problems with relatively coarser grids caviedes voullième et al 2020 this characteristic also accounts for the significant difference of efficiency between the wca2d and swfca models in strong discontinuous flow cases thus to have a fair comparison this extended model efficiency evaluation uses the same layout of case f but scales it back to the original scale in this way the cell length of each computational cell is 2 5 m a short duration 130 mins heavy rainfall event that occurred on 21 august 2019 in taipei city is used 20190821 flood event see fig 5a in chang et al 2021 the details of this event have been listed in table 1 of chang et al 2021 the manning s roughness coefficient is given as 0 025 s m1 3 in this extended evaluation the bed slope of the computational domain is decreased by five factors 1 1 2 1 4 1 8 and 1 16 to slow down water velocities leading to five scenarios 100 0 50 0 25 0 12 5 and 6 3 bed slopes with various flow conditions and the portion of strong discontinuous flows is expected to reduce as the bed slope of the computational domain is decreased the simulation durations of the five scenarios are determined as the times when the outflow is less than 5 of the peak outflow the accuracy requirement of the wca2d model is the same as in case f i e the maximum difference in water depth between the simulated measured is less than 0 1 m all the simulations are executed on the same computer used in section 4 the comparison of numerical efficiency is displayed in table 5 which shows that the swfca and fv hllc models are both faster than the wca2d model when the bed slope of the computational domain is relatively steeper as the bed slope of the computational domain is relatively milder the wca2d model outperforms the swfca and fv hllc models the swfca model can be up to 305 5 more efficient than the wca2d model as for the swfca and fv hllc models the swfca model is about 121 0 128 2 faster than the fv hllc model the average time steps of the three models are all increasing as the bed slope of the computational domain is decreasing the average time step of the wca2d model is found to be much less than the swfca model in the steepest bed slope 100 0 bed slopes scenario and gradually becomes larger than the swfca model as the bed slope of the computational domain becomes milder this result proves the deduction that the wca2d model may not be advantageous if a relatively large part of the flow conditions in a simulation is severe flow conditions the average time steps of the fv hllc model are all slightly larger than the swfca model because the swfca model indirectly simulates the local inertias of 2d swes in its transition rules thus the swfca model requires relatively smaller adaptive time steps by using relatively smaller cfl numbers to simulate local inertias compared to the fv hllc model nevertheless the differences in the average adaptive time steps between the swfca and fv hllc models are small hence it is reasonable that the numerical efficiency of the swfca model is higher than the fv hllc model since the latter introduces a longer the required time to execute its solving procedure in each time step yu and chang 2021 the portions of strong discontinuous flows in the five scenarios are displayed in fig 9 and the average portions of strong discontinuous flows in these scenarios are 21 1 18 8 16 5 11 5 and 7 0 respectively from fig 9 it is confirmed that as the bed slope of the computational domain is decreased water velocities are slowed down and consequently the portion of strong discontinuous flows is decreased inspection of table 5 also proves that the numerical efficiency of the swfca and fv hllc models is related to the portion of strong discontinuous flows and the numerical efficiency of the swfca and fv hllc models is higher than the wca2d model as the portion of strong discontinuous flows is relatively larger at most up to 305 5 when the portion of strong discontinuous flows is relatively smaller the wca2d model is again faster than the swfca and fv hllc models in addition the efficiency of the swfca model is found to be higher than the fv hllc model 121 0 128 2 therefore the swfca model is demonstrated to be more efficient than the wca2d and fv hllc models 6 conclusions this study proposes a new ca based shallow water flow solver swfca that adopts the bernoulli hydraulic head instead of water level as the key factor to distribute water movement directions a novel methodology sequentially determining flow directions mass fluxes and inertias fluxes between two adjacent cells is established to link water depths and velocities four regular flow cases and six benchmark cases with strong discontinuous flows are selected to verify the numerical accuracy and efficiency of the swfca model with the wca2d and fv hllc models then the efficiency of the swfca model on various flow conditions is evaluated through an extended case with various portions of strong discontinuous flows the analysis shows that the swfca and wca2d models both provide satisfactory results on regular flows in modeling strong discontinuous flows the swfca model produces the same accurate results as the fv hllc model nevertheless the swfca model has higher accuracy than the fv hllc model in simulating moving wet dry interfaces and flows under the partially wet condition as to the numerical efficiency based on the outcomes from the extended case the efficiency is confirmed to be related to the portion of strong discontinuous flows when the portion of strong discontinuous fows is relatively large the swfca model outperforms the wca2d and fv hllc models by 305 5 and 121 0 128 2 respectively hence the swfca model can efficiently produce reliable 2d shallow water flow modeling results which could be applied to real time flood inundation modeling credit authorship contribution statement tsang jung chang conceptualization methodology validation supervision project administration writing review editing hsiang lin yu conceptualization methodology software validation formal analysis investigation data curation visualization writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the accomplishment of this work is partially supported by the ministry of science and technology taiwan under grant nos 109 2221 e 002 010 my3 the authors are grateful for the support 
2854,a new dynamic wave cellular automata framework for two dimensional 2d shallow water flow swf modeling is herein proposed during the last decade the concept of cellular automata ca has been widely adopted to develop various 2d shallow water flow models such ca models use simple transition rules that only consider the conservation of mass and neglect the conservation of momentum as a result the models behave like the non inertia wave approximation which are not suitable for modeling strong discontinuous flows i e transcritical flows and wet dry interfaces to overcome this limitation the present study proposes a new ca framework swfca for 2d shallow water flow modeling in which the bernoulli hydraulic head is adopted to replace water level as the key factor to determine water movements a novel methodology for linking water depths and velocities in the framework is developed model verification is carried out through four cases of regular flows and six benchmark cases with strong discontinuous flows model efficiency assessment is also conducted to analyze the numerical performance under various flow conditions the outcomes indicate that the proposed swfca model and a non inertia wave ca based model wca2d both provide satisfactory results on regular flows in modeling strong discontinuous flows the swfca model performs better than the wca2d model and provides the same accuracy as the finite volume model with a hllc scheme fv hllc in the aspect of moving wet dry interfaces and flows under the partially wet condition the swfca model can achieve higher accuracy than the fv hllc model the numerical efficiency of the swfca model relates to the flow conditions involved as the portion of strong discontinuous flows in the computational domain is increasing the swfca model can be up to 305 5 and 121 0 1282 2 faster than the wca2d model and the fv hllc model respectively this novel ca based framework has been proved its accuracy and efficiency for shallow water flow modeling therefore it has considerable potentials as a useful tool for real time flood inundation modeling keywords shallow water flow cellular automata dynamic wave bernoulli hydraulic head data availability data will be made available on request 1 introduction shallow water flows reflect the conditions in which the water depth is much smaller than the horizontal dimensions of motion castro orgaz and hager 2019 in hydraulic engineering flows in rivers floodplains canals lakes reservoirs and coastal and urban areas are often regarded as shallow water flows and are generally described by the two dimensional 2d shallow water equations swes the 2d swes are a set of time dependent 2d nonlinear partial differential equations of hyperbolic type which are mathematically the depth averaged version of the three dimensional navier stokes equations in the past two decades a variety of numerical methods have been used to solve the 2d swes including mesh based methods such as finite difference methods finite element methods finite volume methods etc and meshless methods like smoothed particle hydrodynamics and moving particle semi implicit toro 2001 and castro orgaz and hager 2019 have extensive summaries on mesh based methods and chang et al 2014 2016 and sarkhosh and jin 2021 have detailed discussion on meshless methods so far the finite volume methods are one of the most commonly used modeling techniques due to their strong capabilities to efficiently handle flow transition xia et al 2017 hou et al 2018 yu and chang 2021 zhao and liang 2022 although the aforementioned methods can simulate conditions consisting of transcritical flows and wet dry interfaces with good accuracy toro 2001 the numerical efficiency could still be improved especially for large spatial scale applications solving the 2d swes at high spatial resolutions demands substantial computational resources which inevitably increases the required computational time to enhance numerical efficiency many researchers established their models using ca framework such as the ca flood inundation model dottori and todini 2011 the ca2d model ghimire et al 2013 the flood routing model cai et al 2014 the urban flood inundation model liu et al 2015 the wca2d model guidolin et al 2016 the ofs ca model jahanbazi et al 2017 and the ca ffé model jamali et al 2019 to replace the tedious numerical procedures with a set of simple generic transition rules executed on each computational cell wolfram 1984 in this way ca framework enables researchers to efficiently simulate complex physics by combining simple algebraic equations without adopting numerical iteration and or matrix solving guidolin et al 2016 some of them are coincidently identical to the finite volume methods under particular choices of numerical schemes caviedes voullième et al 2018 nevertheless each method has its advantages and drawbacks the finite volume methods use mathematical approaches e g local riemann solvers to explicitly or implicitly solve 2d swes and they often suffer from heavy computational demands on the other hand the ca solvers conceptually describe the movement of water by a set of transition rules thus the efficiency is greatly improved in particular the wca2d model has further lowered its computational demands by incorporating the local weight system giving significant improvement on efficiency without losing the required accuracy thus it has been widely applied to various applications in conjunction with other models e g water quality milašinović et al 2019 yin et al 2020 and urban flood inundation modeling wang et al 2018 chang et al 2021 all the aforementioned ca based models use water levels to determine water movements such that they behave like a non inertia wave approximation caviedes voullième et al 2018 these non inertia wave models subsequently fail to simulate strong discontinuous flows i e transcritical flows and wet dry interfaces but can provide good results on regular flows hereinafter defined as flows other than strong discontinuous flows costabile et al 2017 according to the above reviews numerical models that use explicit ca based algebraic equations as the transition rules to simulate shallow water flows efficiently and accurately are not yet available to fill this gap the main objective of the study is to develop a new dynamic wave ca framework for 2d shallow water flow modeling this new ca based 2d shallow water flow solver swfca adopts the bernoulli hydraulic head instead of water level as the key factor to determine the directions of water movement and a novel methodology for linking water depths and velocities in the framework is established to sequentially determine the transported amount of mass water depths and inertias water velocities the swfca model is first verified through four cases of regular flows which were previously used to validate the wca2d model then six benchmark cases with strong discontinuous flows moving wet dry interfaces transcritical flows with hydraulic jump and dam break flows are adopted to compare the accuracy of the swfca model wca2d model and a selected finite volume model technical attention is given to the local accuracy nearby strong discontinuities finally the numerical efficiency of the swfca model in different flow conditions is examined detailed discussion is devoted to the numerical performances on the global efficiency of the swfca model 2 shallow water flow solver based on cellular automata swfca in the present study the swfca model that can benefit from the high efficiency of ca framework without losing the required accuracy for simulating both regular flows and strong discontinuous flows is proposed the swfca model adopts the bernoulli hydraulic head a new methodology to link the water depths and velocities instead of the water level to determine the water movements to build the swfca model on ca framework three components are required to be processed i e 1 determine the neighborhood configuration 2 establish variables to describe the state of each discretized computational cell and 3 evolve the states of computational cells into new time steps by a set of transition rules these components are introduced in sections 2 1 to 2 3 respectively both the determinations of the adaptive time steps and the assignments of boundary conditions are parts of the transition rules such that they are introduced in section 2 3 in section 2 4 the proposed swfca and wca2d models are theoretically compared in the aspects of their numerical accuracy and efficiency 2 1 determine the neighborhood configuration the proposed swfca model adopts the square shaped cell to discretize the studied computational domain for the sake of programming convenience the swfca model selects the von neumann neighborhood configuration to define the spatial relation between a central cell and its surrounding cells chopard 2009 thus for each central cell there are four neighbor cells situated at the east north west and south sides for simplicity the central cell is indexed as 0 and its neighbor cells at the east north west and south sides are indexed as 1 2 3 and 4 respectively as fig 1a depicts the states of the central cell and its four neighbor cells are all utilized to evolve the states of the central cell into the next time step 2 2 establish variables to describe the state of each discretized computational cell the wca2d model uses water levels to distribute water directions and relates water velocities with water levels indirectly by utilizing the manning s and critical flow equations guidolin et al 2016 hence the wca2d model behaves like a non inertia wave approximation chang et al 2021 to enable the swfca model s capaity of handling strong discontinuous flows like dynamic wave models it is crucial to find an appropriate but simple way to describe the coupled relations between water depths and velocities of 2d swes thus the bernoulli hydraulic head is adopted as an essential factor for this task consequently the states of each computational cell are water depth water velocity along the x direction water velocity along the y direction and the bernoulli hydraulic head other related variables such as bed elevation and manning s roughness coefficient are both time invariant variables i e assuming no morphological and roughness changes all the aforementioned variables are defined at the center of each cell herein the bernoulli hydraulic head of a central cell is calculated as 1 h 0 z 0 d 0 u 0 2 v 0 2 2 g where g is the gravitational acceleration 9 81 m s2 u 0 and v 0 are the depth averaged velocities along the x and y directions respectively z 0 is the bed elevation d 0 is the water depth and h 0 is the bernoulli hydraulic head of the central cell in eq 1 z 0 d 0 u 0 2 v 0 2 2 g and h 0 refer to the elevation head pressure head velocity head and total head respectively with the bernoulli hydraulic head the swfca model gains the ability to simulate flow transition such as hydraulic jump where the consideration of water velocities is essential 2 3 evolve the states of computational cells into new time steps by a set of transition rules to advance the water depth water velocities and bernoulli hydraulic head at each time step a computing method comprising a set of transition rules is established to sequentially distribute mass water depths and inertias water velocities from a central cell to its neighbor cells through four flow transport routes between the central cell and the neighbor cells for each flow transport route the bernoulli hydraulic heads at the centers of the two connected cells and mass flux of the route are used to judge the flow direction of this route for either normal or special flow conditions the computing method under the normal flow condition is first introduced in section 2 3 1 then the detection of the special flow condition and the corresponding computing method are introduced in section 2 3 2 lastly section 2 3 3 presents the calculations of adaptive time steps and assignments of boundary conditions after the water depths and velocities in the computational domain are all updated 2 3 1 computing method normal flow condition the computing method under the normal flow condition consists of five sequential steps they are introduced as follows step 1 determine the flow direction based on the bernoulli hydraulic head and mass flux in this study the central cell sends out mass and inertias through a flow transport route on the condition that 1 the bernoulli hydraulic head of the central cell is greater than the neighbor cell 2 the mass flux of this route is outward from the central cell or zero and 3 the water depth of the central cell is greater than a threshold the first and second criteria refer to the flow directions at the next and current time steps respectively the second criterion is incorporated to prevent the potential chequerboard instability problem that the flow directions change oppositely between the two subsequent time steps bates et al 2010 the third criterion represents a restriction that no mass and inertias can leave a dry cell based on the three criteria concerning a wet cell when the mass flux of a route is zero the flow direction of the route is decided by criterion one only on the other hand if the mass flux is not zero both criteria 1 and 2 determine the flow direction considering the route between the central cell and i th neighbor cell for illustration the above three criteria are respectively formulated as the three inequalities in eq 2 2 h 0 h i ε and q 0 i θ 0 i 0 and d 0 δ where ε is the tolerance of the bernoulli hydraulic head difference δ refers to the water depth threshold that defines the central cell to be dry or wet i is the index of the neighbor cell i 1 to 4 0 i represents the i th flow transport route between the central cell and i th neighbor cell h 0 and h i are the bernoulli hydraulic heads at the central cell and i th neighbor cell respectively q 0 i is the mass flux of this route and is set as zero prior to the simulation d 0 refers to the water depth of the central cell θ 0 i is an internal variable of θ 0 1 1 θ 0 2 1 θ 0 3 1 and θ 0 4 1 to represent the flow direction it is noted that q 0 i θ 0 i 0 is equivalent to q 0 i 0 taking the central cell in fig 1a as an example there is no flow from the central cell to the 2 nd neighbor cell because h 2 h 0 conversely the central cell sends out mass and inertias through the other three routes and these three routes are marked to be under the normal flow condition the mass and inertia fluxes of the three routes are determined in steps 2 4 on the other hand the flow may move from the wet central cell to the wet neighbor cell despite the bernoulli hydraulic head of the neighbor cell is greater than the central cell and the mass flux of the route is outward from the central cell this condition is hereinafter referred to as the special flow condition and is resulted from the backwater effect lateral inflow of the neighbor cell or the lateral outflow from the central cell to obey the fundamental principle that water flows from larger to smaller bernoulli hydraulic heads the magnitude of the mass flux is subsequently lowered at least to zero to let the bernoulli hydraulic head of the central cell greater than that of the neighbor cell the identification of the special flow condition and the alternative ways for determining flow direction and mass flux are introduced in section 2 3 2 the inertia flux is computed by using the same step under the normal flow condition step 4 step 2 update the mass flux at each flow transport route in step 1 in step 2 based on the flow direction decided in step 1 each central cell updates the mass fluxes of its flow transport routes under the normal flow condition by using the manning s and weir equations for the central cell in fig 1b the mass fluxes of its 1 st 3 rd and 4 th routes are determined by 3 q 0 i θ i min q 0 i m a n n q 0 i w e i r where q 0 i m a n n is the mass flux computed by the manning s equation 4 q 0 i m a n n 1 n 0 l d i 5 3 h 0 h i l in which l is the cell length n 0 refers to the manning s roughness coefficient of the central cell d i is the water depth at the cell edge d 0 d i 2 q 0 i w e i r is the mass flux by the weir equation chaudhry 2022 that is modified to consider the bernoulli hydraulic head 5 q 0 i w e i r 2 3 l 2 g ψ h 0 3 2 6 ψ 1 h i h 0 1 5 0 385 in which z i max z 0 z i h 0 h 0 z i and h i max 0 h i z i in eq 6 ψ represents the free 1 or submerged weir flows the manning s and weir equations both relate the bernoulli hydraulic head to the mass flux therefore inertias are considered when determining a mass flux step 3 calculate the predicted water depth of each cell from the mass fluxes in step 2 after the mass flux of each flow transport route is updated in step 2 the predicted water depth of each central cell d 0 is then calculated by 7 d 0 d 0 δ t l 2 q 0 1 q 0 2 q 0 3 q 0 4 in which δ t is the adaptive time step q 0 1 q 0 2 q 0 3 and q 0 4 are the computed mass fluxes by eq 3 or eq 22 of the 1 st 2 nd 3 rd and 4 th routes respectively as fig 1c displays eq 7 is a simple equation that is based on mass conservation after the predicted water depth of each central cell is computed the computing method checks if any predicted water depth is negative also the flow directions determined in step 1 should remain unchanged with these predicted water depths taking the 1 st route in fig 1b as an example a criterion is applied to check if the flow direction is unchanged 8 h 0 ε z 1 d 1 u 1 2 v 1 2 2 g if negative predicted water depths are detected and or eq 8 is not satisfied δ t in eq 7 is globally decreased and step 3 is redone again step 4 predict the downstream water velocity of each flow transport route based on the predicted water depths in step 3 in this step the inertia flux of a flow transport route with a flow through is determined by calculating the predicted water velocity at the downstream end of the route a specific form of the energy equation with friction loss is used for this task due to its simplicity in relating the water depths and velocities for the central cell in fig 1d the adopted energy equation of the three routes can be formulated in a general form written in an implicit manner 9 h i h 0 l s f 0 i in which l is the length h 0 and h i are the updated bernoulli hydraulic heads of the central and i th neighbor cells respectively and s f 0 i is the updated friction loss of the i th route in eq 9 all terms except length l are undetermined the central and the i th neighbor cells are at the upstream and downstream ends of the route respectively with eq 9 the swfca model considers the effects of the convective acceleration water pressure gradient bed slope and friction slope terms in the 2d swes from the velocity head pressure head and elevation head and friction loss respectively as to the local acceleration of 2d swes it is indirectly simulated in the established transition rules nevertheless eq 9 has too many variables to be solved and thus it is explicitly expressed by the standard step method the only undetermined variable is the water velocity at the downstream end of the route taking the 1 st route in fig 1d as an example the explicitly exprressed eq 9 of the route is written as 10 u 2 0 1 v 2 1 2 g d 1 z 1 h 1 h 0 h 0 l 2 n 1 2 u 1 u 0 1 d 1 4 3 n 0 2 u 0 2 d 0 4 3 l s f 0 1 in which u 0 1 is the predicted water velocity at the downstream 1 st neighbor cell of this route and it is the only undetermined variable d 1 v 1 and n 1 are the predicted water depth from step 3 depth averaged velocity along the y direction and the manning s roughness coefficient respectively of the 1 st neighbor cell other variables related to the central cell h 0 d 0 u 0 are at the current time step the friction loss of the 1 st neighbor cell is written in a semi implicit manner which can help increase the numerical stability particularly at wet dry interfaces cea and bladé 2015 to meet the flow direction determined in step 1 u 0 1 should be larger than 0 i e u 0 1 0 and eq 10 is consequently written as eq 12 11 f u 0 1 1 2 g u 0 1 2 l 2 n 1 2 u 1 d 1 4 3 u 0 1 v 2 1 2 g d 1 z 1 l 2 n 0 2 u 0 2 d 0 4 3 h 0 12 f u 0 1 0 the two solutions in eq 12 can be easily decided without numerical iterations since f u 0 1 is a quadratic function of u 0 1 and only the solution that complies with u 0 1 0 is the final answer otherwise u 0 1 is given as 0 similarly to calculate the predicted water velocities at the downstream of the 3 rd and 4 th routes in fig 1d u 0 3 and v 0 4 respectively the corresponding quadratic functions of the two variables are respectively given in eqs 13 and 14 with u 0 3 0 and v 0 4 0 13 f u 0 3 1 2 g u 0 3 2 l 2 n 3 2 u 3 d 3 4 3 u 0 3 v 2 3 2 g d 3 z 3 l 2 n 0 2 u 0 2 d 0 4 3 h 0 14 f v 0 4 1 2 g v 0 4 2 l 2 n 4 2 v 4 d 4 4 3 v 0 4 u 2 4 2 g d 4 z 4 l 2 n 0 2 v 0 2 d 0 4 3 h 0 the final solutions of u 0 3 and v 0 4 are both determined in a similar manner of u 0 1 it is stressed that no special treatment of the bed elevation is involved when computing the predicted water velocities because the computations use the bed elevations at the cell centers therefore the proposed swfca model can correctly predict the water velocity on a steep plate which is numerically complicated for some finite volume dynamic wave models delestre et al 2012 xia et al 2017 zhao and liang 2022 nonetheless as the bed slope gradient is not limited in this formulation an extremely high value of the predicted water velocity may be computed when there is an abrupt change in terrain which could significantly decrease the adaptive time steps when the free water surface is horizontal and all of the water velocities are zero u 0 0 v 0 0 i e case of water at rest the bernoulli hydraulic head of each central cell eq 1 is exactly the water level z 0 d 0 in such a condition each route is judged to have no flow with its mass and inertia fluxes both equal to zero q 0 i 0 in step 2 and u 0 i 0 or v 0 i 0 in step 4 such that the swfca model can maintain a still free water surface the above deduction proves that the swfca model is inherently able to preserve the well balanced property or the c property without the need to use a special treatment of bed elevation on the other hand for other models such as the finite volume dynamic wave models a special bed slope discretization that cooperates with the reconstruction method is often required to maintain the well balanced property hou et al 2013 cea and bladé 2015 xia et al 2017 zhao and liang 2022 step 5 update the water depth velocities and the bernoulli hydraulic head of each cell from steps 3 and 4 in this step the water depth the water velocities and the bernoulli hydraulic head of each central cell are updated as presented in fig 1e the water depth d 0 is updated by considering the predicted water depth from step 3 d 0 and the other input output water volumes as 15 d 0 d 0 δ v 0 i n l 2 δ v 0 o u t l 2 in which δ v 0 i n refers to the input water volume of the central cell such as the precipitation and inflows from upstream catchments δ v 0 o u t is the output water volume of the central cell such as the infiltration or lateral outflows concerning the update of water velocities u 0 v 0 the predicted water velocities at the downstream of the routes through which the central cell sends water are considered as 16 u 0 γ u 0 1 u 0 1 γ u 0 3 u 0 3 17 v 0 γ v 0 2 v 0 2 γ v 0 4 v 0 4 with γ function given as 18 γ u 1 0 u 0 u 0 2 3 2 computing method special flow condition the special flow condition refers to the condition that the mass flux of a flow transport route is outward from a wet central cell to its wet i th neighbor cell when the central cell has a smaller bernoulli hydraulic head than the neighbor cell this condition is the consequence of the backwater effect lateral inflow at the neighbor cell or the lateral outflow of the central cell in this flow condition the flow through the route is damped leading to two possible circumstances i e 1 the flow direction of the route is unchanged but the magnitudes of the transported mass and inertias are both decreased or 2 the flow direction is reversed in the present study the second circumstance is excluded because the flow direction changes oppositely between the subsequent time steps in this circumstance to fulfill the basic rule that water can only move from larger to smaller bernoulli hydraulic heads alternative ways to delineate the flow direction and determine the mass flux of the route are herein proposed the same method is used to calculate the predicted water velocity at the downstream end of the route step 4 in section 2 3 1 first if a flow transport route does not satisfy eq 2 its flow direction is decided by a simple formula in analogy to the normal flow condition step 1 as 19 h i h 0 ε and q 0 i θ 0 i 0 and d 0 δ and d i δ in which h i h 0 ε violates the aforementioned basic rule and requires adjustment to follow the basic rule if eq 19 is fulfilled this route is marked to be under the special flow condition as illustrated in fig 2a the 1 st route does not fulfill eq 2 but satisfies eq 19 such that there is a flow from the central cell through this route otherwise there is no flow after the flow direction is determined the mass flux of this route is computed in an alternative way to let the bernoulli hydraulic head of the central cell be greater than the neighbor cell again step 2 as drawn in fig 2b the magnitude of the mass flux q 0 1 at the 1 st route is lowered with a magnitude as δ q 0 1 to satisfy eq 2 resulting in the inequality as 20 h 0 δ q 0 1 δ t l 2 h 1 δ q 0 1 δ t l 2 ε in which h 0 δ q 0 1 δ t l 2 represents the increased bernoulli hydraulic head of the central cell h 1 δ q 0 1 δ t l 2 refers to the lowered bernoulli hydraulic head of the neighbor cell δ q 0 1 δ t l 2 is the change of bernoulli hydraulic head due to the change of water depth pressure head it is noted that the 1 st neighbor cell should remain as a wet cell after this adjustment i e δ q 0 1 δ t l 2 d 1 δ considering the equal sign in eq 20 δ q 0 1 is formulated as 21 δ q 0 1 min l 2 2 δ t h 1 h 0 ε l 2 δ t d 1 δ the computed mass flux q 0 1 is finally given as 22 q 0 1 s i g n q 0 1 q 0 1 δ q 0 1 where sign is the sign function it is noted that if q 0 1 q 0 1 is less than 0 there is no flow through this route i e q 0 1 0 for the other routes the mass fluxes of them can be adjusted in the same way if they are marked to be under the special flow condition 2 3 3 stability criterion and boundary conditions 2 3 3 1 stability criterion the swfca model follows the courant friedrichs lewy cfl condition to determine the adaptive time step 23 δ t cfl min l u 2 v 2 gd where cfl is the courant number that ranges between 0 and 1 2 3 3 2 boundary conditions in the swfca model the assignments of boundary conditions are processed after step 5 closed inlet and outlet boundaries are considered herein no mass and inertias can pass through a closed boundary the same as a reflective boundary thus there is no input output water volume at the adjacent computational cell and the water velocity of the cell is unchanged at an inlet boundary the water depth of the inner computational cell is updated by adding the inflow m3 s as an input water volume to consider the inertia effect of the inflow the water velocity of the inflow is determined according to the specified flow condition under supercritical flows this water velocity u or v is imposed by the user in cases of subcritical flows the water velocity is calculated by using the water depth at the cell as q l d 0 for critical flows the critical water depth d critical of the given mass flux q is first calculated by the critical flow equation 24 d critical q l 2 g 1 3 then the water velocity of the inflow is computed q l d critical and the water velocity of the cell along the normal direction of the inflow is subsequently updated next the bernoulli hydraulic head of the cell is calculated again eq 1 at an outlet boundary the outflow m3 s is determined by using the water depth and velocity of the inner computational cell according to the alignment of the outlet boundary q l u 0 d 0 or q l v 0 d 0 and the water depth of the cell is subsequently updated by subtracting the outflow as an output water volume then the water velocity of the outflow is computed to include the inertia effect of the outflow for supercritical flows the water velocity is calculated by using the water depth of the inner computational cell as to subcritical flows the water depth imposed by the user is used for computing the water velocity in terms of critical flows the critical water depth is determined by eq 24 and then the water velocity of the outflow is decided next the water velocity with a direction from the cell to the outlet boundary is used to replace the water velocity of the inner computational cell along the direction normal to the outlet boundary finally the bernoulli hydraulic head of the cell is calculated again 2 4 comparison of the computing method and solving procedures between the wca2d and swfca models the major difference between the wca2d and swfca models is on the computation of water movement between adjacent cells the wca2d model uses water levels to determine the intercellular volumes of water across cell edges as it lacks the inertia terms the permissible intercellular velocities involved in the computations are subsequently determined based on water level gradients by using the manning s and critical flow equations guidolin et al 2016 the magnitude and direction of an intercellular volume may change rapidly between subsequent time steps hence the wca2d model can only handle critical and subcritical flows because the intercellular velocities are constrained by the critical flow equation guidolin et al 2016 chang et al 2021 such that the wca2d model can only obtain accurate results on regular flows under critical subcritical flow conditions on the other side the proposed swfca model uses the bernoulli hydraulic head to distribute water such that the spatial and temporal changes of inertias are both simulated the computing method of the swfca model uses the bernoulli hydraulic head and a particular form of the energy equation with friction loss to decide the changes in mass and inertias through flow transport routes as the adopted energy equation is a special form of the 2d swes the swfca model is expected to accurately handle regular flows and strong discontinuous flows like the dynamic wave models the accuracy of the two ca based models is next compared in section 3 as to the numerical efficiency the execution time on cpu instead of gpu is used for comparison since the technique of parallelization is beyond the scope of this manuscript the total cpu time is influenced by two factors i e the required time to execute the solving procedure in each time step and the magnitudes of adaptive time steps in terms of the solving procedures in each time step the wca2d model consists of two steps to determine the intercellular volumes and update the state of each central cell based on these intercellular volumes guidolin et al 2016 the swfca model comprises four steps steps 1 to 4 in section 2 3 1 to determine the fluxes of mass and inertias through each flow transport route and update the states water depth and velocities of each central cell based on these fluxes step 5 in section 2 3 1 hence the swfca model demands more computational effort to execute the solving procedure in each time step compared to the wca2d model as to the magnitudes of adaptive time steps the wca2d model behaves like the non inertia wave approximation thus it takes the minimum value between the cfl condition and the formula given by hunter et al 2005 as the adaptive time step to maintain its numerical and physical stabilities on the other side as the swfca model simulates inertias like the other dynamic wave models the adaptive time step of it is calculated by the cfl condition only the relative relationship between the wca2d and swfca models in terms of the adaptive time steps is thus similar to that of the non inertia wave and dynamic wave models and the wca2d model is expected to use smaller adaptive time steps than the swfca model hunter et al 2005 caviedes voullième et al 2020 in general despite the swfca model involves more computational procedures within a time step the total cpu time of these two models is still affected by the magnitudes of the adaptive time steps thus which model is faster is case by case for a simulation in milder flow conditions with relatively smooth profiles of water depths and velocities both the wca2d and swfca models have relatively larger adaptive time steps by contrast in severe flow conditions the adaptive time steps of the wca2d model are smaller than those of the swfca model therefore the swfca model could perfom faster conversely when the flow conditions in a simulation are largely milder the efficiency of the wca2d model can outperform the swfca model based on the above deduction the numerical efficiency of the swfca model is related to the flow conditions involved to confirm the above deduction the numerical efficiency assessment in sections 4 and 5 is given to compare the efficiency of the proposed swfca model with the wca2d model on the test cases with various flow conditions 3 model verification in this section the accuracy of the swfca model is verified through four cases with regular flows and six benchmark cases of strong discontinuous flows the widely used wca2d model is selected to compare with the swfca model in section 3 1 the swfca model is verified through four regular flow cases which were previously studied by guidolin et al 2016 to demonstrate their wca2d model in subsections 3 2 six benchmark cases with a relatively large portion of strong discontinuous flows are adopted to understand the capability of the proposed swfca model on handling this kind of extreme flow conditions in addition among various dynamic wave models the present study chooses the first order godunov type finite volume model to further find out how accurate the proposed swfca model can be on simulating strong discontinuous flows this finite volume model uses the hllc scheme which is popularly used in many academic and commercial programs to compute numerical fluxes on cell edges yu and chang 2021 and it is hereinafter to be referred to as the fv hllc model for simplicity in these ten cases the numerical accuracy of each selected model is quantified by calculating the l2 norm between the numerical and measured analytical results chang et al 2016 yu and chang 2021 3 1 regular flows among the cases given by guidolin et al 2016 this study selects the first fourth cases one 1d analytical case and three ea benchmark cases for model verification the first case refers to non breaking wave propagation over a horizontal plane in this case most of the shallow water flows are having low froude numbers the other three selected cases are all ea benchmark test cases including filling of a floodplain eat2 flood propagation over an extended floodplain eat4 and runoff produced by rainfalls and a point source in an urban area eat8a the grid resolution is 1 m for the first case thus there are 5 001 computational cells in the first case as to the other three cases the grid resolutions are 20 m 5 m and 2 m respectively hence the three ea cases have 10 000 80 000 and 97 000 computational cells respectively the rest settings of the four cases are all the same as in guidolin et al 2016 to compute l2 norms for water depths in the four cases the analytical solution and simulated results reported in guidolin et al 2016 are used in the first case the simulated analytical water depth profiles when the time is 3600 s are used for computing l2 norms so there is 5 001 data for each l2 norm computation as for the other three cases the temporal water depth profiles at the specified locations of the selected dynamic wave model in guidolin et al 2016 are taken to compute a single l2 norm for each case thus based on the output frequencies given by néelz and pender 2013 the rest three cases respectively use 577 901 and 601 data to compute their l2 norms for the wca2d model the l2 norms are computed by using the simulated results under the fine type slope tolerance which has better accuracy than the coarse type slope tolerance guidolin et al 2016 the values of the fine type slope tolerance can be found in table 2 of guidolin et al 2016 the calculated l2 norms for water depths of the wca2d and swfca models in the four cases are listed in table 1 from table 1 the l2 norms of the wca2d model in these cases are 0 011 0 003 0 006 and 0 001 respectively and the l2 norms of the swfca model are 0 011 0 001 0 001 and 0 001 respectively the results show that both the wca2d and swfca models simulate regular flows in these four cases accurately nevertheless the accuracy of the swfca model is slightly better than the wca2d model because there are still some strong discontinuous flows in these cases 3 2 strong discontinuous flows six benchmark cases with a large portion of strong discontinuous flows in the computational domain are adopted herein to verify the accuracy of the proposed swfca model the wca2d and fv hllc models are also selected for comparison in the first two cases cases a and b unsteady flows with a large portion of moving wet dry interfaces on uneven terrain are considered a special focus is devoted to examining the capability of the swfca model in simulating moving wet dry interfaces with changes in terrain case a and very shallow overland flows on the steep hillside case b then transcritical flows with a hydraulic jump in the steady state are considered case c to test if the swfca model can correctly simulate hydraulic jumps then the swfca model is evaluated through three dam break flow cases on idealized case d and realistic terrain cases e and f to verify its numerical performance on more complicated flow conditions case d considers dam break flows over a symmetric triangular bump with various downstream boundary conditions in this case hydraulic jumps drops moving wet dry interfaces and partially reflective waves occurred for case e a real dam break event i e the malpasset dam break event is used to test the applicability of the swfca model in handling dam break flows on a realistic terrain with complex river floodplain interactions as the dam break flows pass through the meander reyran river valley strong discontinuous flows moving wet dry interfaces hydraulic jumps drops all occur finally in case f the present study considers 2d dam break flows over the field scale floodplain with a staggered configuration of buildings when the dam break flows pass through these buildings hydraulic jumps occurred in fronts of buildings because of the limited flow paths consequently moving wet dry interfaces along with the dam break flows and hydraulic jumps drops around the buildings emerged along both x and y directions 3 2 1 case a moving shorelines in a 2d frictional parabolic bowl moving wet dry interfaces case a involves moving shorelines in a 2d frictional parabolic bowl the analytical bed elevation water levels and water velocities are presented by sampson et al 2006 following the works by hou et al 2013 and zhao and liang 2022 the center of the 8000 m 8000 m square computational domain is at 4000 m 4000 m as for other parameters h 0 10 m a 3000 m b 5 m s and τ 0 002 1 s which leads to p 0 0093 1 s and s 0 0046 1 s all boundaries are closed the bowl shaped terrain of the computational domain is depicted in fig 3a as the topography line for illustration initially the water levels and velocities of the computational domain are filled with the analytical values with t 0 s the simulation duration is 6000 s as to the setting of friction the friction parameter τ is used instead of the manning s roughness coefficient n hence each selected model is modified to use the friction parameter τ for the fv hllc model the friction slope vector in eq 13 of yu and chang 2021 is redefined as 25 s f i j s 1 0 τ q x s 1 i j τ q y s 1 i j t in which s f s 1 q x s 1 and q y s 1 are defined in yu and chang 2021 concerning the proposed swfca model eq 11 is rewritten as 26 f u 0 1 1 2 g u 0 1 2 l τ 2 g u 0 1 v 2 1 2 g d 1 z 1 l τ 2 g u 0 h 0 eqs 13 and 14 can also be rewritten in the same way as to the wca2d model the maximum permissible intercellular velocity v m in eq 9 and the adaptive time step δ t in eq 18 of guidolin et al 2016 are respectively rewritten as 27 v m min d 0 g g τ δ l 0 m δ x 0 m 28 δ t δ x 2 4 min τ gr s σ the definitions of δ l 0 m δ x 0 m r s and σ can be found in guidolin et al 2016 to quantify the accuracy of the selected model the simulated water level and velocity profiles on the diagonal line between point 0 m 0 m and point 8000 m 8000 m at t 1 375 t s period t 1377 68 s are used to calculate the l2 norms for water levels and velocities respectively a grid convergence test is undertaken first to decide an optimal grid resolution that can lead to an acceptable accuracy meanwhile the numerical diffusion and dispersion properties of the swfca model are also investigated then an accuracy comparison among the selected models is performed under this grid resolution 1 grid convergence test several grid resolutions are considered in this test for the sake of demonstration only the results at the grid resolutions of 5 m 10 m 25 m and 50 m are presented here consequently calculations of the l2 norm at these four grid resolutions take 1 600 800 320 and 160 data respectively the calculated l2 norms for water levels and velocities are all listed in table 2 when the grid resolution becomes finer all the three l2 norms are decreased furthermore when the grid resolution is finer than 10 m the swfca model can provide accurate results compared to the analytical solutions proving the correctness of the swfca model on handling the fluxes mass and inertias bed elevation and friction under proper grid resolutions this result also confirms that the numerical diffusion and dispersion of the swfca model become less when the grid resolution is getting finer finally for the accuracy comparison the grid resolution of 10 m is selected since the subsequent accuracy is acceptable 2 accuracy comparison the accuracy comparison is conducted under the grid resolution of 10 m leading to the grid system of 800 800 the simulated profiles of water levels and velocities u and v on the diagonal line are drawn in figs 3a 3b and 3c the analytical solutions are also plotted in these figures concerning the water level profiles fig 3a displays the results of the fv hllc and swfca models both match the analytical solutions well but the wca2d model can only produce a still water level profile as to the u velocity profiles depicted in fig 3b the results of the fv hllc and swfca models are both in good agreement with the analytical profile despite some overestimations nearby the moving wet dry interfaces from fig 3b the swfca model has less overestimation on the u velocity profile around the wet dry interfaces than the fv hllc model from the viewpoint of the v velocity profiles drawn in fig 3c both the fv hllc and swfca models provide reliable and identical predictions the l2 norms for water levels and velocities are listed in table 3 for comparison from figs 3a 3b and 3c and table 3 the wca2d model fails to simulate the flows in case a because it lacks the consideration of inertias the swfca model is confirmed to be as accurate as the fv hllc model on water level and v velocity profiles and can be more accurate than the fv hllc model on u velocity profiles particularly around the wet dry interfaces this result is related to the differences in determining the water velocities between the two models in the selected fv hllc model the water velocity is indirectly calculated and inversely proportional to the water depth since the model solves conserved variables d du dv making the water velocity increase to a spurious extent at the wet dry interface where water depth is quite small toro 2001 on the other hand the swfca model decides the predicted water depth and then finds the predicted water velocity by a special form of the energy equation with friction loss eqs 11 13 or 14 in step 4 and eqs 16 and 17 in step 5 such that the water velocity at the wet dry interface is constrained by the friction loss term thus the swfca model produces less overestimation of the water velocity compared to the fv hllc model 3 2 2 case b shallow overland flows in a steep v shape catchment moving wet dry interfaces in case b very shallow overland flows and channel flows are involved in an idealized v shape catchment xia et al 2017 hou et al 2018 zhao and liang 2022 this study case was originally studied by di giammarco et al 1996 and the analytical solutions for discharge hydrographs were provided by utilizing the kinematic wave theory later simons et al 2014 reproduced the analytical solutions the rectangular computational domain consists of two hillsides with the same size of 1000 m 800 m and a 20 m wide 1000 m long channel in between the two hillsides as illustrated in fig 4a on the two hillsides the slopes in the directions parallel and normal to the channel are 0 and 0 05 respectively as to the channel the slope is 0 02 and the depth of it ranges from 1 m upstream end to 20 m downstream end a uniform rainfall with a constant rainfall intensity of 10 8 mm hr drops water on the two hillsides for 1 5 hrs all boundaries are closed except for the channel outlet where the open boundary condition the same as the transmissive boundary condition is imposed to let water flows out initially the whole computational domain is dry the simulation duration is about 3 3 hrs 12000 s when the rainfall started the water fell on the hillsides and became very shallow overland flows due to the steep slope these runoffs then flowed into the channel with a sudden drop in terrain after the rainfall stopped the runoffs began to recede and the computational domain gradually dried the manning s roughness coefficients are 0 015 s m1 3 on the hillsides and 0 15 s m1 3 on the channel to quantify the numerical accuracy the simulated and analytical discharge hydrographs at the hillside and the channel outlet are used to determine two l2 norms for discharge hydrographs hence the computations of l2 norms use 11 880 and 5 805 data at the hillside and the channel outlet respectively similar to case a a grid convergence test is performed and the grid resolution of 10 m is recognized to be the most suitable therefore for the following accuracy comparison the square cell with the length of 10 m is used to discretize the computational domain into 16 463 cells figures 4b and 4c depict the simulated discharge hydrographs at the channel outlet and hillside respectively the analytical solutions are also drawn in these figures obviously the fv hllc model fails to simulate the discharge hydrograph at the channel outlet correctly thus the simulated results of another fv hllc model with a more robust scheme i e the pm model by zhao and liang 2022 are included in the figures as the pm model clearly the swfca and pm models have very identical results that are both in close agreement with the analytical solutions on the other hand the fv hllc model can only provide satisfactory results for the discharge hydrograph at the hillside since it cannot resolve the partially wet condition in case b zhao and liang 2022 the discharge hydrographs of the wca2d model are both significantly delayed because the intercellular velocities on the hillsides are forced not to exceed critical velocities the time series of water depths at the channel outlet and the downstream end of the hillside are drawn in figs 4d and 4e respectively similar relations among the four models are shown again the swfca model computes almost the identical water depth series compared to the pm model on the other hand the fv hllc model underestimates the water depths at both two locations which is also seen in the work of zhao and liang 2022 the major cause of this difference is due to the incapability of the fv hllc model in handling the partially wet conditions that occurred on the hillside in case b xia et al 2017 zhao and liang 2022 the l2 norms for discharge hydrographs at the hillside and channel outlet of the selected models for this case are listed in table 3 inspection of table 3 confirms that the swfca model is as accurate as the fv hllc model in predicting the discharge at the hillside and has better performance on the discharge at the channel outlet than the fv hllc model as to the wca2d model it is not suitable to simulate case b to sum up cases a and b prove that the swfca model has the same accuracy as the fv hllc model and has better performance than the wca2d model nevertheless in the aspect of moving wet dry interfaces case a and flows under the partially wet condition case b the swfca model is more robust than the selected fv hllc model and can even provide the same accurate results as another fv hllc model with more complicated numerical procedures pm model by zhao and liang 2022 for case b this result is related to the numerical procedures in the swfca and fv hllc models from the viewpoint of moving wet dry interfaces in case a the water velocity and depth are inversely proportional in the selected fv hllc model such that the water velocity may raise to an extremely high value at the wet dry interface because of the considerably small water depth conversely the swfca model first updates the predicted water depth steps 2 and 3 and then computes the predicted water velocity step 4 letting the water velocity at the wet dry interface be constrained by the friction loss term eqs 11 13 and 14 in case b because the water depths on the hillsides about 0 005 m from fig 4e are much smaller than the bed elevation difference between two adjacent cells the selected fv hllc model numerically defines the local riemann problem as the dry bed dam break problem such that the uniform overland flows on the hillsides are modeled as waterfall which is physically wrong xia et al 2017 this waterfall effect can be resolved by using a more robust reconstruction method like the pm model does zhao and liang 2022 unlike the two fv hllc models the swfca model directly uses nodal bed elevations to compute the transported mass and inertias thus it can successfully handle this partially wet condition overall the computing method of the swfca model has shown its capability to handle flows on uneven terrain and terrain with a steep hillside 3 2 3 case c transcritical river flows with hydraulic jump transcritical flows case c considers river flows with mixed flow conditions the analytical solutions of the bed slope bed elevation and water depths provided by macdonald et al 1997 were all modified to fulfill the wide rectangular channel assumption of the selected models the length and width of the computational domain are 1000 m and 10 m respectively a time invariant inflow of 20 m3 s is given on the left edge as the upstream boundary condition as for the downstream boundary condition a fixed water depth of 1 35 m from the exact water depth profile is set on the right edge to introduce the backwater effect initially the water depths of the computational domain are given as the exact water depths as for the water velocities they are initially given as zero after the simulation starts water comes from the upstream boundary and moves downward to ensure the flows become steady again the simulation lasts for 3600 s the manning s roughness coefficient of the computational domain is given as 0 02 s m1 3 macdonald et al 1997 the simulated profiles of water depths and velocities at t 3600 s are used to calculate the l2 norms for water depths and velocities respectively to focus on the numerical performance around the hydraulic jump only data with its x coordinate being between 550 m and 650 m is adopted for the computations of l2 norms after a grid convergence test like case a square cells with a cell length of 1 m are used to discretize the computational domain into 11 011 computational cells consequently there are 101 uniformly distributed data used for determining each l2 norm the simulated water level profiles of the three selected models are plotted in fig 5a the analytical water level profile is displayed in fig 5a as well as for the water velocity profiles the simulated together with the analytical profiles are drawn in fig 5b apparently from these two figures the wca2d model fails to correctly simulate the hydraulic jump as expected also the wca2d model cannot simulate supercritical flows because the water velocity is constrained by the critical flow equation the simulated profiles of the swfca and fv hllc models are very similar and are both in good agreement with the analytical solution the comparison of numerical accuracy is listed in table 3 from this table and figs 5a and 5b the swfca model has shown its ability to simulate hydraulic jump and it can provide the same accurate results as the fv hllc model 3 2 4 case d dam break flows over a symmetric triangular bump with various downstream boundary conditions dam break flows on idealized terrain in case d a cadam test case morris 2000 with moving dam break flows over a symmetric triangular bump is studied zhou et al 2004 kao and chang 2012 to examine the performance of the proposed swfca model with complex boundary conditions partially reflective waves hydraulic jumps drops and wet dry interfaces all emerge because of the irregular bed slope a reservoir with a length of 15 5 m a width of 1 0 m and a height of 1 0 m is connected to a rectangular rough channel with a length of 22 5 m the gate of the reservoir is placed at x 15 5 m the center of the symmetric triangular bump is at x 28 5 m with a length of 6 0 m and a height of 0 4 m both the slopes in the reservoir and the channel are zero the configuration of the case is depicted in fig 6a water depth hydrographs were measured at four water depth gauges i e g4 g10 g13 and g20 as their locations are displayed in fig 6a there were originally three scenarios tested in the case the present study adopts the first two scenarios among the three scenarios because the wca2d model cannot simulate the third scenario the first scenario refers to the dry bed condition with the open end at the right edge and the second scenario is the wet bed condition with the closed end at the right edge in these two scenarios the initial water depth in the reservoir is given as 0 75 m as to the downstream boundary conditions in the first scenario the downstream channel located at the downstream side of the triangular bump is initially dry and this channel is open at the right end as fig 6a illustrates for the second scenario an initial water depth of 0 15 m is prescribed on the downstream channel by incorporating a vertical wall at the end of the channel drawn in fig 6b in both two scenarios dam break flows propagate downward in the supercritical flow condition after the simulations start the simulation durations of the two scenarios are both 40 s the manning s roughness coefficient is 0 0125 s m1 3 chang et al 2011 kao and chang 2012 concerning the settings of the boundary conditions at the right end the open and closed ends are respectively prescribed as the transmissive and reflective boundaries for both the swfca and fv hllc models l2 norms for water depths are used to evaluate the numerical accuracy of the three selected models for each l2 norm the simulated water depth hydrographs at the four gauges are all used with the measured data to determine a single l2 norm value thus for each selected model there are 142 and 152 data used for the computation of water depth l2 norms in the first and second scenarios respectively a grid convergence is undertaken in the same way as case a and the computational domain is discretized by square cells with a length of 0 1 m leading to 4 411 cells the simulated water depth hydrographs at the four selected gauges in the first and second scenarios are plotted in figs 6c and 6d respectively the simulated water level profiles of the three models at t 9 7 s in the two scenarios are presented in figs 6e and 6f respectively the measured data is also displayed in these figures from figs 6c and 6d in both the two scenarios there exist significant discrepancies between the simulated results of the wca2d model and the measured data at these four water depth gauges specifically the overtopping of water across the triangular bump and the reflective wave are both not correctly simulated by the wca2d model this result is majorly attributed to the use of the critical flow equation that constrains the water velocity of the dam break front by contrast the swfca and fv hllc models both provide accurate enough profiles in spite of some small discrepancies between the simulated profiles and measure data at water depth gauge g20 these differences are also observed in chang et al 2011 since the selected models are 2d shallow water flow models that lack the consideration of vertical acceleration terms in their numerical schemes nevertheless inspection from figs 6e and 6f reveals that the swfca and fv hllc models provide almost identical water level profiles and both successfully simulate partially reflective waves as well as hydraulic jumps drops on the other hand the wca2d model fails to give reasonable outcomes the l2 norms for water depths of the three models in the two scenarios are displayed in table 3 which confirms that the accuracy between the swfca and fv hllc models is very identical hence the computing method of the swfca model can successfully simulate very complicated flows with moving shock waves partially reflective waves and overtopping water amounts accurately in these two scenarios 3 2 5 case e malpasset dam break event on the reyran river floodplain dam break flows on realistic terrain the malpasset dam break event is a real dam break event that happened in france in 1959 killing 423 people in the resulting flood on the downstream side of the reyran river floodplain this dam break event is included in the cadam project soares frazão et al 1999 and is a useful benchmark case for studying dam break waves propagation in a natural topography kao and chang 2012 hou et al 2013 the configuration of the reyran river floodplain is drawn in fig 7a for illustration the local police investigated and reported the maximum water levels at 17 locations p1 to p17 along the reyran river valley soares frazão et al 1999 three electric transformers t1 to t3 were destroyed by the flood and their shutdown times represent the wave arrival times of the flood wave moreover a non distorted 1 400 scale model was built and calibrated against the observations aforementioned from this scale model the maximum water levels and wave arrival times of 9 gauges s6 to s14 downstream the dam were measured the locations of the aforementioned 17 investigated points 3 electric transformers and 9 experimental gauges are depicted in fig 7a initially the whole computational domain is assumed to be dry except for the reservoir where a constant water level of 100 m with zero velocities is prescribed the boundaries in the sea are opened and the rest boundaries are closed the simulation lasts for 3600 s and the manning s roughness coefficient of the computational domain is given as 0 033 s m1 3 kao and chang 2012 hou et al 2013 the malpasset dam is simplified as a straight line in the narrow valley of the reyran river and the ruins of the dam are assumed to have no effects on the dam break flows soares frazão et al 1999 the maximum water levels at the 17 investigated points and 9 experimental gauges are used to calculate a single l2 norm for the maximum water levels similarly a single l2 norm for wave arrival times is decided by using the arrival times at the 3 electric transformers and 9 experimental gauges similar to previous cases a grid convergence test is taken and the computational domain is subsequently discretized into 520 359 square cells with a length of 10 m the bed elevation of each computational cell is interpolated by employing the natural neighbor interpolation figures 7b and 7c display the simulated maximum water levels at the 17 investigated points and at the 9 experimental gauges respectively the wave arrival times at the 3 electric transformers and the 9 experimental gauges are drawn in figs 7d and 7e respectively the measured data is included in these figures for comparison the simulated results of the swfca and fv hllc models are found to be very similar and agree reasonably well with the measured data on the other hand the wca2d model tends to overestimate the maximum water levels in the narrow valley i e p3 p5 p6 p8 and s10 and underestimate the maximum water levels in the downstream floodplain i e p10 to p17 and s11 to s14 this result is related to the use of the critical flow equation in the wca2d model that slows down the movement of the dam break flows leading to the underestimations of the arrival times shown in figs 7d and 7e the l2 norms for the maximum water levels and arrival times are listed in table 3 as the l2 norms between the swfca and fv hllc models are the same the swfca model is found to have the same accuracy as the fv hllc model on simulating 2d dam break flows in a realistic river floodplain 3 2 6 case f discharge flows over the toce floodplain with staggered buildings dam break flows on realistic terrain in this case dam break flows towards buildings in the staggered configuration are studied by adopting the experimental case originating from impact and cadam projects testa et al 2007 in the present study the original valley geometry scaled 100 times down from the toce river valley is adopted as shown in fig 8a all the three inflows hydrographs given at the left edge are adopted displayed in fig 8a as well leading to three scenarios in case f as low medium and high inflow scenarios in these three scenarios a staggered building layout is considered fig 8a ten water depth hydrographs were measured at ten water depth gauges locations are also depicted in fig 8a the simulation durations of the three scenarios are all 60 s the elevations of the cells where the buildings locate are raised up by 0 15 m the manning s roughness coefficient is given as 0 0162 s m1 3 as suggested by testa et al 2007 among ten water depth gauges the water depth hydrographs at eight gauges p3 to p10 in fig 8a are used to determine a single water depth l2 norm yu and chang 2021 consequently there are 2 408 measured data for the computation of each l2 norm for water depth a grid convergence test is performed and square cells with a cell size of 2 5 cm are used to discretize the computational domain into 54 964 cells figs 8b 8c and 8d display the simulated and measured profiles of water depths at the selected gauges for the low medium and high inflow scenarios respectively from these figures the simulated results of the swfca and fv hllc models all match the measured data reasonably well at the selected gauges nonetheless for the wca2d model the simulated water depths at the p3 to p6 gauges are obviously underpredicted this result is because the wca2d model cannot reflect the raise of water depths due to hydraulic jumps costabile et al 2017 nevertheless at the p7 to p10 gauges the wca2d model is capable to give satisfactory water depths because the flow conditions turn into regular flows the l2 norms for water depths in the three scenarios are calculated and listed in table 3 for accuracy comparison in table 3 the accuracy of the swfca model is again demonstrated to be the same as the fv hllc model hence it is confirmed that the proposed swfca model has the ability to accurately simulate 2d dam break flows on a complex terrain with hydraulic jumps drops and moving wet dry interfaces in case f based on the results from cases d e and f the swfca model has shown its remarkable robustness on handling the complex interactions between dam break flows topography and boundary conditions through the accuracy comparison between the simulated and analytical results the swfca model can achieve good accuracy as the fv hllc model on partially reflective waves hydraulic jumps drops moving wet dry interfaces and regular flows on idealized and realistic terrain hence the swfca model can produce reliable results on dam break flows the wca2d model has less accuracy than the swfca model as expected in general the swfca model can accurately simulate regular flows and strong discontinuous flows through these representative cases the wca2d model is found to have satisfactory accuracy only in cases with a small portion of strong discontinuous flows on the other hand the swfca model is as accurate as the fv hllc model in these selected cases which is not surprising because the used form of the energy equation in the swfca model is actually another special form of the 2d swes also the l2 norms for evaluating the numerical accuracy use a relatively large range of simulated measured data nevertheless the swfca model has better accuracy than the fv hllc model for simulating moving wet dry interfaces and flows under the partially wet condition despite that it is still worth mentioning that the performance of the swfca model in other cases with stronger discontinuities should be tested in the future 4 model efficiency assessment section 3 has demonstrated through ten cases that the swfca model can accurately simulate regular flows and strong discontinuous flows in particular for strong discontinuous flows the swfca model is as accurate as the fv hllc model and can be more accurate than the fv hllc model under specified flow conditions on the other hand the wca2d model can only provide satisfactory results on regular flows the next issue is about the efficiency of the swfca model in this section the model efficiency of the swfca model is assessed and compared with the wca2d model through the ten cases in section 3 in total there are thirteen simulations for each model to minimize the differences in the numerical implementation the swfca model is written in the same code structure as the wca2d model and their simulations are all executed on an intel r core tm i9 9900k pc equipped with 6 0 gb ram without activating parallel computing the clock speed of the core is 3 4 ghz the total cpu time of the two models in the ten cases is recorded and listed in table 4 in terms of the regular flow cases the wca2d model takes more the total cpu time than the swfca model in the first and third cases mainly because the moving wet dry fronts of the inflows occurred in these two cases involve considerably high froude numbers by contrast the wca2d model outperforms the swfca model in the second and fourth cases as expected for the strong discontinuous flow cases in case a the wca2d model spends less the total cpu time than the swfca model simply because there is no intercellular volume computation after the simulated water levels become still from the other five cases the swfca model is 162 9 to 23760 0 faster than the wca2d model since the latter tend to use very small adaptive time steps to stably propagate flows this result may also be attributed to the fact that the grid resolutions in cases b to f are quite small making the adaptive time steps of the wca2d model very small to comply with the required accuracy conversely the swfca model can efficiently simulate regular flows and strong discontinuous flows nevertheless because the involved flow conditions in these ten cases are quite different it is difficult to explain the above results by the deduction in section 2 4 thus an extended evaluation to investigate the model efficiency of the swfca model in a designed condition is conducted next 5 extended model efficiency evaluation as discussed in section 2 4 the total cpu time is influenced by the required time to execute the solving procedure in each time step and the magnitudes of adaptive time steps consequently the flow conditions involved also have an impact on the efficiency of the wca2d and swfca models when the portion of strong discontinuous flows in the computational domain increases the swfca model could simulate more efficiently than the wca2d model as the potion is small the wca2d model is faster than the swfca model despite the efficiency comparison of the swfca and wca2d models is performed in section 4 it is very hard to explain the compared results as the flow conditions in ten cases are different therefore an extended model efficiency evaluation with various designed flow conditions is conducted to qualitatively compare the efficiency between the wca2d and swfca models the fv hllc model used in section 3 is included for efficiency comparison as well and it s also rewritten in the same code structure as the wca2d model for the comparison for non inertia wave numerical models to maintain physical and numerical stabilities the adaptive time steps are quadratically decreased with respect to grid resolutions which subsequently introduces heavy computational loads i e very long the total cpu time for fine grid resolutions hunter et al 2005 generally non inertia wave models are often used on problems with relatively coarser grids caviedes voullième et al 2020 this characteristic also accounts for the significant difference of efficiency between the wca2d and swfca models in strong discontinuous flow cases thus to have a fair comparison this extended model efficiency evaluation uses the same layout of case f but scales it back to the original scale in this way the cell length of each computational cell is 2 5 m a short duration 130 mins heavy rainfall event that occurred on 21 august 2019 in taipei city is used 20190821 flood event see fig 5a in chang et al 2021 the details of this event have been listed in table 1 of chang et al 2021 the manning s roughness coefficient is given as 0 025 s m1 3 in this extended evaluation the bed slope of the computational domain is decreased by five factors 1 1 2 1 4 1 8 and 1 16 to slow down water velocities leading to five scenarios 100 0 50 0 25 0 12 5 and 6 3 bed slopes with various flow conditions and the portion of strong discontinuous flows is expected to reduce as the bed slope of the computational domain is decreased the simulation durations of the five scenarios are determined as the times when the outflow is less than 5 of the peak outflow the accuracy requirement of the wca2d model is the same as in case f i e the maximum difference in water depth between the simulated measured is less than 0 1 m all the simulations are executed on the same computer used in section 4 the comparison of numerical efficiency is displayed in table 5 which shows that the swfca and fv hllc models are both faster than the wca2d model when the bed slope of the computational domain is relatively steeper as the bed slope of the computational domain is relatively milder the wca2d model outperforms the swfca and fv hllc models the swfca model can be up to 305 5 more efficient than the wca2d model as for the swfca and fv hllc models the swfca model is about 121 0 128 2 faster than the fv hllc model the average time steps of the three models are all increasing as the bed slope of the computational domain is decreasing the average time step of the wca2d model is found to be much less than the swfca model in the steepest bed slope 100 0 bed slopes scenario and gradually becomes larger than the swfca model as the bed slope of the computational domain becomes milder this result proves the deduction that the wca2d model may not be advantageous if a relatively large part of the flow conditions in a simulation is severe flow conditions the average time steps of the fv hllc model are all slightly larger than the swfca model because the swfca model indirectly simulates the local inertias of 2d swes in its transition rules thus the swfca model requires relatively smaller adaptive time steps by using relatively smaller cfl numbers to simulate local inertias compared to the fv hllc model nevertheless the differences in the average adaptive time steps between the swfca and fv hllc models are small hence it is reasonable that the numerical efficiency of the swfca model is higher than the fv hllc model since the latter introduces a longer the required time to execute its solving procedure in each time step yu and chang 2021 the portions of strong discontinuous flows in the five scenarios are displayed in fig 9 and the average portions of strong discontinuous flows in these scenarios are 21 1 18 8 16 5 11 5 and 7 0 respectively from fig 9 it is confirmed that as the bed slope of the computational domain is decreased water velocities are slowed down and consequently the portion of strong discontinuous flows is decreased inspection of table 5 also proves that the numerical efficiency of the swfca and fv hllc models is related to the portion of strong discontinuous flows and the numerical efficiency of the swfca and fv hllc models is higher than the wca2d model as the portion of strong discontinuous flows is relatively larger at most up to 305 5 when the portion of strong discontinuous flows is relatively smaller the wca2d model is again faster than the swfca and fv hllc models in addition the efficiency of the swfca model is found to be higher than the fv hllc model 121 0 128 2 therefore the swfca model is demonstrated to be more efficient than the wca2d and fv hllc models 6 conclusions this study proposes a new ca based shallow water flow solver swfca that adopts the bernoulli hydraulic head instead of water level as the key factor to distribute water movement directions a novel methodology sequentially determining flow directions mass fluxes and inertias fluxes between two adjacent cells is established to link water depths and velocities four regular flow cases and six benchmark cases with strong discontinuous flows are selected to verify the numerical accuracy and efficiency of the swfca model with the wca2d and fv hllc models then the efficiency of the swfca model on various flow conditions is evaluated through an extended case with various portions of strong discontinuous flows the analysis shows that the swfca and wca2d models both provide satisfactory results on regular flows in modeling strong discontinuous flows the swfca model produces the same accurate results as the fv hllc model nevertheless the swfca model has higher accuracy than the fv hllc model in simulating moving wet dry interfaces and flows under the partially wet condition as to the numerical efficiency based on the outcomes from the extended case the efficiency is confirmed to be related to the portion of strong discontinuous flows when the portion of strong discontinuous fows is relatively large the swfca model outperforms the wca2d and fv hllc models by 305 5 and 121 0 128 2 respectively hence the swfca model can efficiently produce reliable 2d shallow water flow modeling results which could be applied to real time flood inundation modeling credit authorship contribution statement tsang jung chang conceptualization methodology validation supervision project administration writing review editing hsiang lin yu conceptualization methodology software validation formal analysis investigation data curation visualization writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the accomplishment of this work is partially supported by the ministry of science and technology taiwan under grant nos 109 2221 e 002 010 my3 the authors are grateful for the support 
