index,text
25635,this paper aims to simulate and predict global permafrost distribution and analyse its change from 2010 to 2100 under different climate scenarios based on different factors topography land cover climate and location and global permafrost distribution status logistic regression model lrm is chosen and constructed to simulate and predict the global permafrost distributions thus the global permafrost distributions at t1 2010 2040 t2 2040 2070 and t3 2070 2100 are predicted under different climate scenarios rcp26 rcp45 and rcp85 from t1 to t3 the area of global permafrost has the largest degradation under rcp85 scenarios from rcp26 to rcp85 at t3 the area of the degraded permafrost reached 0 671 108 km2 the degraded permafrost mainly distributes in east asia west asia north europe and north america the west asia has the highest degrading distance about 600 km under the situations of both rcp85 from t1 to t3 and from rcp26 to rcp85 at t3 keywords global permafrost distribution permafrost degradation logistic regression model permafrost distribution simulation and prediction topographic factors climate scenarios 1 introduction as one of the physical geographic factors permafrost distribution is sensitive to climate change jiang et al 2003 zhao et al 2012 zheng et al 2019 global climate change especially global warming due to greenhouse effect is expected to intensify permafrost degradation wu et al 2009 sterman et al 2013 lu et al 2020 conversely the degradation of the permafrost will emit large amount of methane and carbon dioxide which will accelerate the greenhouse effect vonk et al 2012 cooper et al 2017 wickland et al 2020 meanwhile permafrost degradation not only intensifies the desertification but also affects such things as biochemical processes and human infrastructures yang et al 2010 muerth and mauser 2012 hence understanding global permafrost degradation status due to climate change has mush scientific and practical significance zhao et al 2019 li et al 2021 permafrost distribution is difficult to acquire merely by field survey or directly by remote sensing monitoring trofaier et al 2017 so model simulation becomes a useful way that simulates permafrost distribution based on different factors malevsky malevich et al 2001 such as topographic parameters imhof 1996 equivalent elevation lewkowic and bonnaventure 2011 air temperature zhao et al 2007 ground temperature li and wu 2005 bottom temperature of snow cover bts hoelzle 1992 ishikawa and hirakawa 2000 and so on about the simulation model it includes regional climate model rcm salzmann et al 2007 logistic regression model lrm janke 2005 etzelmüller et al 2006 zhao et al 2012 2019 decision and regression tree approaches pastick et al 2015 process based model based on remote sensing data zheng et al 2020 etc due to the absence of global permafrost distribution these models and various factors are mostly adopted to simulate regional permafrost distribution and its changing tendency and the permafrost simulation at global extent is scarce considering the closing links between climate change and permafrost distribution it is meaningful to simulate permafrost distribution and predict its changing tendency at global scale zhao et al 2019 lu et al 2020 based on the existing permafrost distribution in the northern hemisphere this research firstly infers permafrost distribution in the southern hemisphere using topography land cover and location factors then global permafrost distribution is simulated and predicted under different climate scenarios from 2010 to 2100 finally global permafrost distribution change is analyzed during this period and between different climate scenarios this research achieves global permafrost distribution status and its change tendency which provides reference for the study of climate change and other physical geographical factors such as vegetation glacier and lake at global scale zheng et al 2020 2 main data sources the main data sources in this research includes topographic data location data climate data land cover data and permafrost distribution data all the data are transformed to gcs wgs 1984 projection which is a geographic projection all the raster data are resampled to 0 125 which is consistent to the spatial resolution of land use cover change lucc data at global scale yue et al 2007 fan et al 2013 2015 2019 the brief introduction to the main data sources is the following 2 1 topographic data topographic data are computed based on the dem data which chooses the gtopo30 data in this research the gtopo30 data is made by the u s geological survey s eros data center which covers the whole globe and has the spatial resolution of 30 about 1 km at the equator the gtopo30 data is firstly resampled to 0 125 the values of which are elevation data then the slope data and the aspect data are computed based on the gtopo30 data the aspect data is the category type so the sine values and cosine values are computed based on the aspect data thus the topographic data are acquired including elevation slope sine value and cosine value of aspect data 2 2 location data location data include longitude and latitude data longitude and latitude data are raster type with the pixel size of 0 125 the value of every pixel is the longitude or latitude of its center location longitude data represents the arid zonation at some extent cheng 1984 wu et al 2009 and the latitude data affects global heat distribution zhao et al 2012 2 3 climate data this research chooses temperature and precipitation factors as the climate data the climate data are acquired during four phases one current phase and three future phases t1 2010 2040 t2 2040 2070 t3 2070 2100 fan et al 2013 2015 the annual average climate production of the international station data are firstly downloaded from data centre of national meteorological science in the chinese meteorological data website http data cma cn then the climate data are interpolated from the station data with a spatial resolution of 0 125 and the climate data are acquired at the current phase accordingly the climate factors at three future phases chooses a new version of the model for interdisciplinary research on climate miroc5 under the coupled model intercomparison project phase 5 cmip5 in the world climate research programme https esgf node llnl gov search cmip5 the miroc5 is an atmosphere ocean general circulation model which is produced by the japanese research community meanwhile three climate scenarios rcp26 rcp45 and rcp85 are selected for the climate factors at the three future phases fan et al 2019 2 4 land cover data the land cover data at the current phase uses the global land cover data in 2000 glc2000 in this research which is produced by the european commission s joint research centre based on the data from the vegetation sensor boarded on spot4 the glc2000 data is acquired through class definition image classification and quality assurance bartholomé and belward 2005 land cover data at three future phases adopt the land use and land cover lucc data under different climate scenarios rcp26 rcp45 and rcp85 with spatial resolution of 0 125 through comparing the difference of the classification system for glc2000 and holdridge life zone hlz the lucc data are acquired based on the constructed marginal conversion raster model of land cover fan et al 2005 2013 2015 2019 2 5 permafrost distribution data about global permafrost distribution data this research searches the circum arctic map of permafrost and ground ice conditions v2 as the base data brown et al 2002 the map presents permafrost distribution and properties in the northern hemisphere 20 n to 90 n it is available in esri shapefile format and can be downloaded from national snow and ice data center nsidc https nsidc org data ggd318 3 methods the work flow of this research is illustrated in fig 1 fig 1 shows based on the gtopo30 glc2000 latitude and longitude data the permafrost distribution in the southern hemisphere is inferred by referencing that in the northern hemisphere and the global permafrost distribution data is achieved accordingly model simulation factors are composed of global permafrost distribution topographic factors glc2000 location factors and climate factors at current phase assigning the values of the simulation factors to the sample points the simulation model is constructed accordingly based on the simulation model topographic factors lucc data and climate factors at three future phases and under different climate scenarios rcp26 rcp45 and rcp85 global permafrost distribution probability is computed at corresponding phases and climate scenarios through determining the cut value for the distribution probability global permafrost distribution are achieved finally global permafrost distribution change especially degradation status are analyzed at different phases and under three climate scenarios in this section we will give the acquisition process of global permafrost distribution and the simulation model construction process 3 1 acquisition of global permafrost distribution permafrost distribution in the northern hemisphere adopts the circum arctic map of permafrost and ground ice conditions which presents the permafrost distribution properties between 20 n and 90 n using five classes non permafrost isolated patches sporadic permafrost discontinuous permafrost continuous permafrost and glaciers they are merged into two classes non permafrost and permafrost which is combined other four classes into one class rouyet et al 2019 as to the permafrost distribution in the southern hemisphere it is acquired based on the glc2000 gtopo30 longitude and latitude data referencing the permafrost distribution in the northern hemisphere the glacier distribution areas in the glc2000 data are defined as permafrost class in the southern hemisphere firstly then the glc2000 data is re classified into six classes forest grassland bare land water body snow and ice building area as to the non glacier regions in the southern hemisphere the areas south to 60 s are mainly the antarctic continent and these areas are also defined as the permafrost class in the areas between 60 s and 30 s considering the longitude distributions this research determines the regions where the elevation is higher than 2500 m and the land cover is grassland or bare land as the permafrost class finally the areas between 30 s and the equator considering the longitude factor the permafrost class mainly distributes in the regions where the elevation is higher than 3000 m and the land cover is grassland or bare land hence the permafrost distribution is acquired in the southern hemisphere through combining the permafrost distribution both in the northern hemisphere and southern hemisphere together global permafrost distribution in the original version is acquired accordingly 3 2 simulation model construction 3 2 1 simulation model introduction as the global permafrost distribution has two classes permafrost and non permafrost logistic regression model lrm is chosen to simulate global permafrost distribution in this research lrm is suitable when the dependent variable is the binomially classified so it is usually selected to simulate permafrost distribution after 2000 lewkowicz and ednie 2004 li et al 2009 zhao et al 2019 the equation of the lrm is the following 1 ln p 1 p a b x c y where p is the probability of global permafrost distribution 0 p 1 a is the constant b and c are the coefficients x and y are the independent variables based on equation 1 the probability of global permafrost distribution can be computed using the following equation 2 p 1 1 e a b x c y in equations 1 and 2 the independent variables are the simulation factors in the lrm through determining the cut value of the probability the classes of global permafrost distribution can be computed accordingly 3 2 2 data process to construct the lrm model the simulation factors should be consistent in both boundary and format the datasets in vector format are transformed into raster format and all the datasets are resampled into the same spatial resolution of 0 125 through clipping process all the data sources have the same boundary with the values to the raster data one pixel corresponds to a sample point and 1 365 234 sample points are acquired accordingly finally the values of global permafrost distribution and simulation factors are assigned to the sample points 3 2 3 model construction based on the values of sample points the lrm model is constructed using the spss software the performance of the lrm is judged by the correct percentage of the permafrost distribution points between the simulation values and original values as the simulation value is the probability the cut value of the probability chooses 0 5 to determine the permafrost distribution classes through experiments the lrm model has the best performance when it adopts all the simulation factors except for the aspect data in this condition the simulation model has the nagelkerke r2 of 0 942 and cox snell r2 of 0 706 meanwhile the overall corrected percentage of the simulation points reaches 97 0 so the simulation model presents a good fitting degree to guarantee enough decimals for the coefficients the factors are scaled down through dividing a number for example longitude divided by 1000 latitude divided by 100 elevation divided by 1000 slope divided by 100 the cosine and sine values of the aspect divided by 1000 respectively temperature divided by 10 precipitation divided by 1000 through adjusting the values of the factors the coefficients and the constant in the lrm model is finally computed in table 1 in table 1 most of the simulation factors have low sig values except for the cosine and sine values of the aspect data low sig values represents high significance the cosine and sine values of the aspect data have high sig values but they can also raise the correct percentage of the simulation points at some extent as to the glc factors two classes of the snow and ice and the budding area have high sig values which is because snow and ice are mainly permafrost distribution areas and building area seldom distributes permafrost 4 results based on the simulation model and the simulation factors global permafrost distribution and its change are acquired and analyzed to compute the area the acquired results in this section choose mollweide projection which is an equal area pseudocylindrical projection the pixel size sets 1000 m for the raster product 4 1 distribution of the global permafrost by different methods global permafrost distribution can be acquired by combining the distribution both in the northern hemisphere and northern hemisphere original version based on the simulation points and the simulation model the distribution of global permafrost by different methods can be shown in fig 2 through fig 2 we can see that permafrost mainly distributes in high latitude areas in the middle latitude areas permafrost mainly distributes in the qinghai tibet plateau of northern hemisphere and andes mountains of southern american continent making an area computation to the global permafrost distribution acquired by different methods the results are shown in table 2 in table 2 the area of the permafrost is approximate to that of the non permafrost while the area of permafrost is a little higher than that of the non permafrost for original distribution and simulation points for the simulation model it is reverse the total area for the original distribution is a little higher than that for the simulation points and simulation model which is because the boundary consistency process decreases the area at some extent compared the areas of the simulation points to that of the simulation model the correct percentage is about 96 7 for the permafrost distribution when comparing the number of the simulation points to that the correct percentage is 97 0 this inconsistency is due to the projection transformation from gcs wgs84 to mollweide 4 2 distribution of the global permafrost under different climate scenarios in different periods global permafrost distributions can be acquired based on the simulation model and using the simulation factors in different future phases and under three climate scenarios which are shown in fig 3 fig 4 and fig 5 respectively in these figures figs 3 figs 4 and 5 the simulation factors adopt fixed topographic and location data while dynamic lucc and climate data are selected in different phases and under three climate scenarios from these figures we can see that global permafrost distributions are generally similar in different periods and under various climate scenarios while the permafrost degradation can be found in some cases such as from t1 to t3 under rcp85 scenarios to quantify the permafrost distribution change in different periods and under various climate scenarios the computation results are shown in table 3 table 3 illustrates that from t1 to t3 global permafrost degrades continually under every climate scenarios meanwhile the degradation status becomes serious from rcp26 to rcp85 for example the degradation area is 0 108 108 km2 under rcp26 0 337 108 km2 under rcp45 while it is 0 780 108 km2 under rcp85 much higher than that under both rcp26 and rcp45 4 3 distribution change of the global permafrost under different climate scenarios or during different periods the distribution change of global permafrost can be divided into four classes unchanged non permafrost degraded permafrost increased permafrost and unchanged permafrost through overlapping process between two datasets the global permafrost distribution changes are not only conducted from t1 to t3 under different climate scenarios fig 6 but also from rcp26 to rcp85 rcp26 to rcp45 and rcp45 to rcp85 at t3 phase fig 7 fig 6 presents that it is difficult to find the increased permafrost as to the degraded permafrost it mainly distributes in the southern edge of the eastern asia western asia northern europe and northern america especially the western asia where distributes the longest degradation distance in the southern hemisphere the southern part of the andes mountains also distributes a little permafrost degradation from t1 to t3 the degradation distance is narrow under rcp26 scenario a little wider under rcp45 scenario and the widest under rcp85 scenario from fig 7 we can see that between different climate scenarios the degradation distribution status is similar to that from t1 phase to t3 phase under each climate scenario at t3 phase global permafrost distribution change from rcp26 to rcp45 is similar to that from t1 to t3 under rcp26 scenario global permafrost distribution change from rcp26 to rcp85 is similar to that from t1 to t3 under rcp85 scenario global permafrost distribution change from rcp45 to rcp85 is similar to that from t1 to t3 under rcp45 scenario making an area statistics to global permafrost distribution changes during different periods and under various climate scenarios the results can be computed as shown in table 4 table 4 shows that the increased permafrost is limited the area of which is 0 001 108 km2 except for 0 002 108 km2 from t1 to t3 under rcp85 scenarios as to the degraded permafrost from t1 to t3 the degraded permafrost area increases from rcp26 to rcp45 and then to rcp85 so the rcp85 has the highest degraded permafrost area 0 782 108 km2 at t3 phase the degraded permafrost from rcp26 to rcp85 has the highest area which is 0 671 108 km2 the next is that from rcp45 to rcp85 and that from rcp26 to rcp45 has the lowest area 4 4 degrading distance of the global permafrost change in typical continents under different situations based on the global permafrost distribution change under different situations the permafrost degradation is mainly distributed in east asia west asia north europe and north america to quantify the degrading distance in the four typical continents four test points are determined by referencing the global permafrost degrading status in different situations taking the global permafrost change under rcp85 scenario from t1 2010 2040 to t3 2070 2010 as the reference the distribution of the four test points is shown in fig 8 fig 8 presents that the degrading distance is various in different typical continents so the four test point are chosen to represent the degrading distance in the four typical continents in other places of the typical continents the degrading distance is different compared to the test points using distance measurement tool the degrading distances of the permafrost distribution are acquired at the four points under different situations table 5 from table 5 we can see that the west asia has the highest degrading distance then the north europe and north america which are similar generally and the east asia has the lowest degrading distance as to the different climate scenarios rcp85 from t1 to t3 has the highest degrading distance at t3 phase the climate scenarios change from rcp26 to rcp85 has the highest degrading distance 5 discussions 5 1 innovations the innovations of this research are the following 1 the first product of global permafrost distribution referencing the circum arctic map of permafrost and ground ice conditions this research acquired global permafrost distribution by using the glc2000 data elevation data longitude and latitude data in the southern hemisphere this is the first product of global permafrost distribution which provides fundamental data for global permafrost distribution simulation and prediction 2 an effective model to simulate and predict global permafrost distribution status through experiments based on the performance the lrm model adopted in this research has the nagelkerke r2 of 0 942 and the corrected percentage of 97 0 which shows a good fitting degree of the constructed model coon et al 2016 meanwhile compared to previous model such as the models based on topographic conditions imhof 1996 lewkowic and bonnaventure 2011 various temperature indexes hoelzle 1992 ishikawa and hirakawa 2000 li and wu 2005 zhao et al 2007 cheng et al 2012 and rcm salzmann et al 2007 the lrm model in this research adopts various factors including topography location lucc and climate status furthermore besides the climate factors the lucc factors in this research are acquired in different periods and under various climate scenarios the dynamic factors of the lucc and the climate make the prediction of global permafrost distribution available 3 global permafrost distribution and its change under various climate scenarios based on the dynamic simulation factors and the lrm model global permafrost distribution are acquired in different periods and under various climate scenarios so the change of global permafrost distribution can be computed and analyzed between every two periods under each climate scenario and between every two climate scenarios at each phase the acquisition of global permafrost distribution change especially permafrost degradation has much significance in ecology and environment protection infrastructure construction and disaster prevention in permafrost thawing regions sannel and kuhry 2011 cassidy et al 2017 lewkowic and way 2019 furthermore permafrost degradation status provides important reference for future climate scenarios selection and carbon dioxide emission controlling schuur et al 2015 olefeldt et al 2016 kokelj et al 2017 fraser et al 2018 5 2 prospects nevertheless there are still some aspects that can be strengthened in the future relevant researches 1 a unified global permafrost distribution dataset there are not unified global permafrost distribution map or data at present the permafrost distribution data with the largest region until now is the circum arctic map brown et al 2002 which presents permafrost distribution in the northern hemisphere so the permafrost distribution in the southern hemisphere is acquired by referencing it in the northern hemisphere and based on topography glc2000 and location data the quality inconsistency may degraded the simulation and prediction results of the global permafrost distribution so a unified global permafrost dataset can be achieved to create more rational results in future researches 2 more climate scenarios and more rational periods this research chooses three climate scenarios rcp26 pcp45 and rcp85 meanwhile the future periods chooses t1 2010 2040 t2 2040 2070 and t3 2070 2100 future researches can selects more climate scenarios such as rcp65 and more rational periods such as 10 years as a phase more climate scenarios and more rational periods may make global permafrost distribution simulation and prediction much more meaningful 3 lag effect in permafrost degradation the lrm model presents a good performance in this research nevertheless it is a scenario type model which does not consider the lag effect between climate change and permafrost degradation bonnaventure and lewkowicz 2010 due to thermal inertia the permafrost will exist in a period after the changed climate due to lag effect zhao et al 2012 2019 so the lag effect should be considered or a more rational model can be pursued in future research janke 2005 6 conclusions based on the acquired global permafrost distribution this research constructed the lrm model to simulate and predict global permafrost distribution in different periods and under various climate scenarios the global permafrost distribution change and degradation distance are analyzed accordingly through this research the following conclusions can be acquired 1 lrm model adopts all the simulation factors topography land cover climate and location except for the aspect data has the best performance which has nagelkerke r2 of 0 942 and the corrected percentage of 97 0 so it can fit global permafrost distribution simulation and prediction at a high degree 2 global permafrost mainly distributes in high latitude area and the qinghai tibet plateau and andes mountains of the middle latitude area the distribution area is 6 968 108 km2 which is similar to non permafrost area 3 from t1 to t3 global permafrost degrades from 7 127 108 km2 to 7 019 108 km2 under rcp26 scenario but from 7 129 108 km2 to 6 349 108 km2 under rcp85 scenario different climate scenarios results to remarkable effect to global degradation status the degraded permafrost mainly distributes in the southern edge of the eastern asia western asia northern europe and northern america of the northern hemisphere 4 through four test points in the main degrading areas the west asia has the highest degrading distance which reaches about 600 km from t1 to t3 under rcp85 scenarios the next are the north europe and north america which are similar generally and the east asia has the lowest degrading distance declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was jointly supported by the national key research and development program china 2017yfb0503603 2018yfb0505402 the natural science foundation of shanxi province china 201901d111098 the national natural science foundation of china 42130110 42171424 zhuojian li ding ma and qidong gao provide help in data collection and analysis appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105307 
25635,this paper aims to simulate and predict global permafrost distribution and analyse its change from 2010 to 2100 under different climate scenarios based on different factors topography land cover climate and location and global permafrost distribution status logistic regression model lrm is chosen and constructed to simulate and predict the global permafrost distributions thus the global permafrost distributions at t1 2010 2040 t2 2040 2070 and t3 2070 2100 are predicted under different climate scenarios rcp26 rcp45 and rcp85 from t1 to t3 the area of global permafrost has the largest degradation under rcp85 scenarios from rcp26 to rcp85 at t3 the area of the degraded permafrost reached 0 671 108 km2 the degraded permafrost mainly distributes in east asia west asia north europe and north america the west asia has the highest degrading distance about 600 km under the situations of both rcp85 from t1 to t3 and from rcp26 to rcp85 at t3 keywords global permafrost distribution permafrost degradation logistic regression model permafrost distribution simulation and prediction topographic factors climate scenarios 1 introduction as one of the physical geographic factors permafrost distribution is sensitive to climate change jiang et al 2003 zhao et al 2012 zheng et al 2019 global climate change especially global warming due to greenhouse effect is expected to intensify permafrost degradation wu et al 2009 sterman et al 2013 lu et al 2020 conversely the degradation of the permafrost will emit large amount of methane and carbon dioxide which will accelerate the greenhouse effect vonk et al 2012 cooper et al 2017 wickland et al 2020 meanwhile permafrost degradation not only intensifies the desertification but also affects such things as biochemical processes and human infrastructures yang et al 2010 muerth and mauser 2012 hence understanding global permafrost degradation status due to climate change has mush scientific and practical significance zhao et al 2019 li et al 2021 permafrost distribution is difficult to acquire merely by field survey or directly by remote sensing monitoring trofaier et al 2017 so model simulation becomes a useful way that simulates permafrost distribution based on different factors malevsky malevich et al 2001 such as topographic parameters imhof 1996 equivalent elevation lewkowic and bonnaventure 2011 air temperature zhao et al 2007 ground temperature li and wu 2005 bottom temperature of snow cover bts hoelzle 1992 ishikawa and hirakawa 2000 and so on about the simulation model it includes regional climate model rcm salzmann et al 2007 logistic regression model lrm janke 2005 etzelmüller et al 2006 zhao et al 2012 2019 decision and regression tree approaches pastick et al 2015 process based model based on remote sensing data zheng et al 2020 etc due to the absence of global permafrost distribution these models and various factors are mostly adopted to simulate regional permafrost distribution and its changing tendency and the permafrost simulation at global extent is scarce considering the closing links between climate change and permafrost distribution it is meaningful to simulate permafrost distribution and predict its changing tendency at global scale zhao et al 2019 lu et al 2020 based on the existing permafrost distribution in the northern hemisphere this research firstly infers permafrost distribution in the southern hemisphere using topography land cover and location factors then global permafrost distribution is simulated and predicted under different climate scenarios from 2010 to 2100 finally global permafrost distribution change is analyzed during this period and between different climate scenarios this research achieves global permafrost distribution status and its change tendency which provides reference for the study of climate change and other physical geographical factors such as vegetation glacier and lake at global scale zheng et al 2020 2 main data sources the main data sources in this research includes topographic data location data climate data land cover data and permafrost distribution data all the data are transformed to gcs wgs 1984 projection which is a geographic projection all the raster data are resampled to 0 125 which is consistent to the spatial resolution of land use cover change lucc data at global scale yue et al 2007 fan et al 2013 2015 2019 the brief introduction to the main data sources is the following 2 1 topographic data topographic data are computed based on the dem data which chooses the gtopo30 data in this research the gtopo30 data is made by the u s geological survey s eros data center which covers the whole globe and has the spatial resolution of 30 about 1 km at the equator the gtopo30 data is firstly resampled to 0 125 the values of which are elevation data then the slope data and the aspect data are computed based on the gtopo30 data the aspect data is the category type so the sine values and cosine values are computed based on the aspect data thus the topographic data are acquired including elevation slope sine value and cosine value of aspect data 2 2 location data location data include longitude and latitude data longitude and latitude data are raster type with the pixel size of 0 125 the value of every pixel is the longitude or latitude of its center location longitude data represents the arid zonation at some extent cheng 1984 wu et al 2009 and the latitude data affects global heat distribution zhao et al 2012 2 3 climate data this research chooses temperature and precipitation factors as the climate data the climate data are acquired during four phases one current phase and three future phases t1 2010 2040 t2 2040 2070 t3 2070 2100 fan et al 2013 2015 the annual average climate production of the international station data are firstly downloaded from data centre of national meteorological science in the chinese meteorological data website http data cma cn then the climate data are interpolated from the station data with a spatial resolution of 0 125 and the climate data are acquired at the current phase accordingly the climate factors at three future phases chooses a new version of the model for interdisciplinary research on climate miroc5 under the coupled model intercomparison project phase 5 cmip5 in the world climate research programme https esgf node llnl gov search cmip5 the miroc5 is an atmosphere ocean general circulation model which is produced by the japanese research community meanwhile three climate scenarios rcp26 rcp45 and rcp85 are selected for the climate factors at the three future phases fan et al 2019 2 4 land cover data the land cover data at the current phase uses the global land cover data in 2000 glc2000 in this research which is produced by the european commission s joint research centre based on the data from the vegetation sensor boarded on spot4 the glc2000 data is acquired through class definition image classification and quality assurance bartholomé and belward 2005 land cover data at three future phases adopt the land use and land cover lucc data under different climate scenarios rcp26 rcp45 and rcp85 with spatial resolution of 0 125 through comparing the difference of the classification system for glc2000 and holdridge life zone hlz the lucc data are acquired based on the constructed marginal conversion raster model of land cover fan et al 2005 2013 2015 2019 2 5 permafrost distribution data about global permafrost distribution data this research searches the circum arctic map of permafrost and ground ice conditions v2 as the base data brown et al 2002 the map presents permafrost distribution and properties in the northern hemisphere 20 n to 90 n it is available in esri shapefile format and can be downloaded from national snow and ice data center nsidc https nsidc org data ggd318 3 methods the work flow of this research is illustrated in fig 1 fig 1 shows based on the gtopo30 glc2000 latitude and longitude data the permafrost distribution in the southern hemisphere is inferred by referencing that in the northern hemisphere and the global permafrost distribution data is achieved accordingly model simulation factors are composed of global permafrost distribution topographic factors glc2000 location factors and climate factors at current phase assigning the values of the simulation factors to the sample points the simulation model is constructed accordingly based on the simulation model topographic factors lucc data and climate factors at three future phases and under different climate scenarios rcp26 rcp45 and rcp85 global permafrost distribution probability is computed at corresponding phases and climate scenarios through determining the cut value for the distribution probability global permafrost distribution are achieved finally global permafrost distribution change especially degradation status are analyzed at different phases and under three climate scenarios in this section we will give the acquisition process of global permafrost distribution and the simulation model construction process 3 1 acquisition of global permafrost distribution permafrost distribution in the northern hemisphere adopts the circum arctic map of permafrost and ground ice conditions which presents the permafrost distribution properties between 20 n and 90 n using five classes non permafrost isolated patches sporadic permafrost discontinuous permafrost continuous permafrost and glaciers they are merged into two classes non permafrost and permafrost which is combined other four classes into one class rouyet et al 2019 as to the permafrost distribution in the southern hemisphere it is acquired based on the glc2000 gtopo30 longitude and latitude data referencing the permafrost distribution in the northern hemisphere the glacier distribution areas in the glc2000 data are defined as permafrost class in the southern hemisphere firstly then the glc2000 data is re classified into six classes forest grassland bare land water body snow and ice building area as to the non glacier regions in the southern hemisphere the areas south to 60 s are mainly the antarctic continent and these areas are also defined as the permafrost class in the areas between 60 s and 30 s considering the longitude distributions this research determines the regions where the elevation is higher than 2500 m and the land cover is grassland or bare land as the permafrost class finally the areas between 30 s and the equator considering the longitude factor the permafrost class mainly distributes in the regions where the elevation is higher than 3000 m and the land cover is grassland or bare land hence the permafrost distribution is acquired in the southern hemisphere through combining the permafrost distribution both in the northern hemisphere and southern hemisphere together global permafrost distribution in the original version is acquired accordingly 3 2 simulation model construction 3 2 1 simulation model introduction as the global permafrost distribution has two classes permafrost and non permafrost logistic regression model lrm is chosen to simulate global permafrost distribution in this research lrm is suitable when the dependent variable is the binomially classified so it is usually selected to simulate permafrost distribution after 2000 lewkowicz and ednie 2004 li et al 2009 zhao et al 2019 the equation of the lrm is the following 1 ln p 1 p a b x c y where p is the probability of global permafrost distribution 0 p 1 a is the constant b and c are the coefficients x and y are the independent variables based on equation 1 the probability of global permafrost distribution can be computed using the following equation 2 p 1 1 e a b x c y in equations 1 and 2 the independent variables are the simulation factors in the lrm through determining the cut value of the probability the classes of global permafrost distribution can be computed accordingly 3 2 2 data process to construct the lrm model the simulation factors should be consistent in both boundary and format the datasets in vector format are transformed into raster format and all the datasets are resampled into the same spatial resolution of 0 125 through clipping process all the data sources have the same boundary with the values to the raster data one pixel corresponds to a sample point and 1 365 234 sample points are acquired accordingly finally the values of global permafrost distribution and simulation factors are assigned to the sample points 3 2 3 model construction based on the values of sample points the lrm model is constructed using the spss software the performance of the lrm is judged by the correct percentage of the permafrost distribution points between the simulation values and original values as the simulation value is the probability the cut value of the probability chooses 0 5 to determine the permafrost distribution classes through experiments the lrm model has the best performance when it adopts all the simulation factors except for the aspect data in this condition the simulation model has the nagelkerke r2 of 0 942 and cox snell r2 of 0 706 meanwhile the overall corrected percentage of the simulation points reaches 97 0 so the simulation model presents a good fitting degree to guarantee enough decimals for the coefficients the factors are scaled down through dividing a number for example longitude divided by 1000 latitude divided by 100 elevation divided by 1000 slope divided by 100 the cosine and sine values of the aspect divided by 1000 respectively temperature divided by 10 precipitation divided by 1000 through adjusting the values of the factors the coefficients and the constant in the lrm model is finally computed in table 1 in table 1 most of the simulation factors have low sig values except for the cosine and sine values of the aspect data low sig values represents high significance the cosine and sine values of the aspect data have high sig values but they can also raise the correct percentage of the simulation points at some extent as to the glc factors two classes of the snow and ice and the budding area have high sig values which is because snow and ice are mainly permafrost distribution areas and building area seldom distributes permafrost 4 results based on the simulation model and the simulation factors global permafrost distribution and its change are acquired and analyzed to compute the area the acquired results in this section choose mollweide projection which is an equal area pseudocylindrical projection the pixel size sets 1000 m for the raster product 4 1 distribution of the global permafrost by different methods global permafrost distribution can be acquired by combining the distribution both in the northern hemisphere and northern hemisphere original version based on the simulation points and the simulation model the distribution of global permafrost by different methods can be shown in fig 2 through fig 2 we can see that permafrost mainly distributes in high latitude areas in the middle latitude areas permafrost mainly distributes in the qinghai tibet plateau of northern hemisphere and andes mountains of southern american continent making an area computation to the global permafrost distribution acquired by different methods the results are shown in table 2 in table 2 the area of the permafrost is approximate to that of the non permafrost while the area of permafrost is a little higher than that of the non permafrost for original distribution and simulation points for the simulation model it is reverse the total area for the original distribution is a little higher than that for the simulation points and simulation model which is because the boundary consistency process decreases the area at some extent compared the areas of the simulation points to that of the simulation model the correct percentage is about 96 7 for the permafrost distribution when comparing the number of the simulation points to that the correct percentage is 97 0 this inconsistency is due to the projection transformation from gcs wgs84 to mollweide 4 2 distribution of the global permafrost under different climate scenarios in different periods global permafrost distributions can be acquired based on the simulation model and using the simulation factors in different future phases and under three climate scenarios which are shown in fig 3 fig 4 and fig 5 respectively in these figures figs 3 figs 4 and 5 the simulation factors adopt fixed topographic and location data while dynamic lucc and climate data are selected in different phases and under three climate scenarios from these figures we can see that global permafrost distributions are generally similar in different periods and under various climate scenarios while the permafrost degradation can be found in some cases such as from t1 to t3 under rcp85 scenarios to quantify the permafrost distribution change in different periods and under various climate scenarios the computation results are shown in table 3 table 3 illustrates that from t1 to t3 global permafrost degrades continually under every climate scenarios meanwhile the degradation status becomes serious from rcp26 to rcp85 for example the degradation area is 0 108 108 km2 under rcp26 0 337 108 km2 under rcp45 while it is 0 780 108 km2 under rcp85 much higher than that under both rcp26 and rcp45 4 3 distribution change of the global permafrost under different climate scenarios or during different periods the distribution change of global permafrost can be divided into four classes unchanged non permafrost degraded permafrost increased permafrost and unchanged permafrost through overlapping process between two datasets the global permafrost distribution changes are not only conducted from t1 to t3 under different climate scenarios fig 6 but also from rcp26 to rcp85 rcp26 to rcp45 and rcp45 to rcp85 at t3 phase fig 7 fig 6 presents that it is difficult to find the increased permafrost as to the degraded permafrost it mainly distributes in the southern edge of the eastern asia western asia northern europe and northern america especially the western asia where distributes the longest degradation distance in the southern hemisphere the southern part of the andes mountains also distributes a little permafrost degradation from t1 to t3 the degradation distance is narrow under rcp26 scenario a little wider under rcp45 scenario and the widest under rcp85 scenario from fig 7 we can see that between different climate scenarios the degradation distribution status is similar to that from t1 phase to t3 phase under each climate scenario at t3 phase global permafrost distribution change from rcp26 to rcp45 is similar to that from t1 to t3 under rcp26 scenario global permafrost distribution change from rcp26 to rcp85 is similar to that from t1 to t3 under rcp85 scenario global permafrost distribution change from rcp45 to rcp85 is similar to that from t1 to t3 under rcp45 scenario making an area statistics to global permafrost distribution changes during different periods and under various climate scenarios the results can be computed as shown in table 4 table 4 shows that the increased permafrost is limited the area of which is 0 001 108 km2 except for 0 002 108 km2 from t1 to t3 under rcp85 scenarios as to the degraded permafrost from t1 to t3 the degraded permafrost area increases from rcp26 to rcp45 and then to rcp85 so the rcp85 has the highest degraded permafrost area 0 782 108 km2 at t3 phase the degraded permafrost from rcp26 to rcp85 has the highest area which is 0 671 108 km2 the next is that from rcp45 to rcp85 and that from rcp26 to rcp45 has the lowest area 4 4 degrading distance of the global permafrost change in typical continents under different situations based on the global permafrost distribution change under different situations the permafrost degradation is mainly distributed in east asia west asia north europe and north america to quantify the degrading distance in the four typical continents four test points are determined by referencing the global permafrost degrading status in different situations taking the global permafrost change under rcp85 scenario from t1 2010 2040 to t3 2070 2010 as the reference the distribution of the four test points is shown in fig 8 fig 8 presents that the degrading distance is various in different typical continents so the four test point are chosen to represent the degrading distance in the four typical continents in other places of the typical continents the degrading distance is different compared to the test points using distance measurement tool the degrading distances of the permafrost distribution are acquired at the four points under different situations table 5 from table 5 we can see that the west asia has the highest degrading distance then the north europe and north america which are similar generally and the east asia has the lowest degrading distance as to the different climate scenarios rcp85 from t1 to t3 has the highest degrading distance at t3 phase the climate scenarios change from rcp26 to rcp85 has the highest degrading distance 5 discussions 5 1 innovations the innovations of this research are the following 1 the first product of global permafrost distribution referencing the circum arctic map of permafrost and ground ice conditions this research acquired global permafrost distribution by using the glc2000 data elevation data longitude and latitude data in the southern hemisphere this is the first product of global permafrost distribution which provides fundamental data for global permafrost distribution simulation and prediction 2 an effective model to simulate and predict global permafrost distribution status through experiments based on the performance the lrm model adopted in this research has the nagelkerke r2 of 0 942 and the corrected percentage of 97 0 which shows a good fitting degree of the constructed model coon et al 2016 meanwhile compared to previous model such as the models based on topographic conditions imhof 1996 lewkowic and bonnaventure 2011 various temperature indexes hoelzle 1992 ishikawa and hirakawa 2000 li and wu 2005 zhao et al 2007 cheng et al 2012 and rcm salzmann et al 2007 the lrm model in this research adopts various factors including topography location lucc and climate status furthermore besides the climate factors the lucc factors in this research are acquired in different periods and under various climate scenarios the dynamic factors of the lucc and the climate make the prediction of global permafrost distribution available 3 global permafrost distribution and its change under various climate scenarios based on the dynamic simulation factors and the lrm model global permafrost distribution are acquired in different periods and under various climate scenarios so the change of global permafrost distribution can be computed and analyzed between every two periods under each climate scenario and between every two climate scenarios at each phase the acquisition of global permafrost distribution change especially permafrost degradation has much significance in ecology and environment protection infrastructure construction and disaster prevention in permafrost thawing regions sannel and kuhry 2011 cassidy et al 2017 lewkowic and way 2019 furthermore permafrost degradation status provides important reference for future climate scenarios selection and carbon dioxide emission controlling schuur et al 2015 olefeldt et al 2016 kokelj et al 2017 fraser et al 2018 5 2 prospects nevertheless there are still some aspects that can be strengthened in the future relevant researches 1 a unified global permafrost distribution dataset there are not unified global permafrost distribution map or data at present the permafrost distribution data with the largest region until now is the circum arctic map brown et al 2002 which presents permafrost distribution in the northern hemisphere so the permafrost distribution in the southern hemisphere is acquired by referencing it in the northern hemisphere and based on topography glc2000 and location data the quality inconsistency may degraded the simulation and prediction results of the global permafrost distribution so a unified global permafrost dataset can be achieved to create more rational results in future researches 2 more climate scenarios and more rational periods this research chooses three climate scenarios rcp26 pcp45 and rcp85 meanwhile the future periods chooses t1 2010 2040 t2 2040 2070 and t3 2070 2100 future researches can selects more climate scenarios such as rcp65 and more rational periods such as 10 years as a phase more climate scenarios and more rational periods may make global permafrost distribution simulation and prediction much more meaningful 3 lag effect in permafrost degradation the lrm model presents a good performance in this research nevertheless it is a scenario type model which does not consider the lag effect between climate change and permafrost degradation bonnaventure and lewkowicz 2010 due to thermal inertia the permafrost will exist in a period after the changed climate due to lag effect zhao et al 2012 2019 so the lag effect should be considered or a more rational model can be pursued in future research janke 2005 6 conclusions based on the acquired global permafrost distribution this research constructed the lrm model to simulate and predict global permafrost distribution in different periods and under various climate scenarios the global permafrost distribution change and degradation distance are analyzed accordingly through this research the following conclusions can be acquired 1 lrm model adopts all the simulation factors topography land cover climate and location except for the aspect data has the best performance which has nagelkerke r2 of 0 942 and the corrected percentage of 97 0 so it can fit global permafrost distribution simulation and prediction at a high degree 2 global permafrost mainly distributes in high latitude area and the qinghai tibet plateau and andes mountains of the middle latitude area the distribution area is 6 968 108 km2 which is similar to non permafrost area 3 from t1 to t3 global permafrost degrades from 7 127 108 km2 to 7 019 108 km2 under rcp26 scenario but from 7 129 108 km2 to 6 349 108 km2 under rcp85 scenario different climate scenarios results to remarkable effect to global degradation status the degraded permafrost mainly distributes in the southern edge of the eastern asia western asia northern europe and northern america of the northern hemisphere 4 through four test points in the main degrading areas the west asia has the highest degrading distance which reaches about 600 km from t1 to t3 under rcp85 scenarios the next are the north europe and north america which are similar generally and the east asia has the lowest degrading distance declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was jointly supported by the national key research and development program china 2017yfb0503603 2018yfb0505402 the natural science foundation of shanxi province china 201901d111098 the national natural science foundation of china 42130110 42171424 zhuojian li ding ma and qidong gao provide help in data collection and analysis appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105307 
25636,a coupled hydrodynamic biogeochemical model was applied to simulate scenarios of classic restoration practices to address eutrophication in a cascade system comprised of six reservoirs along the tietê river brazil from 2008 to 2016 each restoration scenario was propagated along the cascade system by using a sequential modelling approach the simulated scenarios revealed which on land and in lake restoration techniques are capable of promoting water quality improvements that are propagated to all downstream reservoirs along the cascade system the present findings may provide a useful management strategy to develop better restoration practices at a basin catchment scale for other lakes and reservoirs along cascade systems worldwide especially in highly anthropogenic impacted areas taking advantage of the propagation of water quality improvements in a downstream direction due to a domino effect triggered by the feedback from one water body to the next in a chain keywords lake degradation glm aed model phosphorus chlorophyll a trophic state index water management 1 introduction cultural eutrophication is widespread globally and across lake types regardless of latitude or morphometry ho et al 2019 and is the major problem facing inland waters downing 2014 eutrophication impacts can seriously impair the delivery of ecosystem services janssen et al 2020 and also promote negative economic consequences such as increased costs for public health and losses in commercially important fisheries mccrackin et al 2017 according to the period of exposure and degradation intensity eutrophication in water bodies can move from reversible when restoration follows the reduction of nutrient inputs to hysterestic when eutrophication can be reversed by combining nutrient input controls with temporary interventions then to irreversible when eutrophication cannot be reversed even by severe reductions in nutrient input carpenter et al 1999 therefore during the past several decades much effort has been made to restore degraded lakes and reservoirs as nutrient input is the primary cause of eutrophication in aquatic ecosystems worldwide great efforts and vast amounts of financial resources have been used to reduce the external nutrient loadings chou et al 2021 by managing both point and nonpoint sources in the basin catchment dolph et al 2019 in addition to accelerate recovery a suite of physical chemical and biological methods are applied after external loading reduction jeppesen et al 2017 to reactively combat both causes and consequences of eutrophication these methods are based on i reducing internal nutrient loads such as using an inactivation agent to permanently bind phosphorus in the sediments gibbs et al 2011 huser et al 2016b lucena silva et al 2019 ii biomanipulation burns et al 2014 jeppesen et al 2007 iii phytoplankton control by application of algicides matthijs et al 2016 or natural polymers as flocculants yuan et al 2016 zou et al 2006 and iv hydrologic manipulation niemistö et al 2016 while these methods have been discussed for decades eutrophication problems persist and recovery remains a global challenge wurtsbaugh et al 2019 either because external loading has not been reduced sufficiently or because internal lake mechanisms prevent or delay recovery søndergaard et al 2007 fortunately an increasing number of water bodies are reversing towards re oligotrophication in western europe and north america anneville et al 2019 indeed many of europe s largest lakes have been recovered from eutrophication schindler 2012 following tertiary wastewater treatment and the removal of phosphorus from sewage effluent jeppesen et al 2005 in contrast point sources are now progressively increasing to affect the quality of the environment for various systems in developing nations where the population is growing jenny et al 2020 despite successes in north america and europe in reducing eutrophication the number of case studies on the recovery from eutrophication in tropical climates is far less advanced than in temperate lakes coveney et al 2005 liu et al 2018 in the case of brazilian lakes and reservoirs the effects of rapid population growth not accompanied by a proportionate increase in sanitation infrastructure have resulted in eutrophication in 57 of the lentic environments ana 2012 however this number is potentially quite underestimated considering that there are not many monitored water bodies in addition the country faces sociopolitical challenges due to conflicts because of overarching goals for economic development in detriment of adequate attention to environmental protection by the state thomaz et al 2020 which poses further stress in highly degraded aquatic ecosystems a large body of literature reports the response of aquatic ecosystems to restoration methods for individual study sites however the effects of restoration methods on lakes and reservoirs situated along a cascade system are understudied the feedback from one water body to the next in a chain is of crucial importance due to a domino effect in water quality along the network teurlincx et al 2019 in this study we recognize the need of incorporating the connectivity through reservoirs to potentialise restoration efforts in water bodies connected by a cascade system a cascade system comprised of six reservoirs located in southeast brazil was selected as the case study the main goals were 1 to apply the hydrodynamic general lake model coupled to the biogeochemical aquatic ecodynamics library glm aed previously calibrated and validated to simulate scenarios of classic restoration methods and investigate the reservoirs response in terms of the trophic state index 2 to investigate how the restoration scenarios are propagated along the cascade system by using a sequential modelling approach to transport the feedback from one reservoir to the next one in the chain and 3 to elaborate a scenario consisting of a combination of the most efficient restoration methods to promote an overall improvement in water quality not only in one reservoir but in all water bodies along the cascade system we intend to provide subsidies for water managers to develop better restoration methods at a basin catchment scale to recover aquatic ecosystems considering the synergistic propagation in a downstream direction 2 methods 2 1 site description from the 1960s to the 1990s a cascade system comprised of six reservoirs was built along the tietê river southeast brazil the reservoirs are from up to downstream barra bonita bb bariri ba ibitinga ib promissão pr nova avanhandava na and três irmãos ti they are hydrologically connected through the tietê river for operational optimization through flow regulation to attend the common purpose of hydropower generation as a result reservoirs affect water quantity and quality from up to downstream along the cascade system besides they attend multiple uses including navigation drinking water supply irrigation fishery flood regulation and tourism the reservoirs have a varied range of physical characteristics with maximum depths from 19 2 to 45 6 m surface areas from 46 to 654 km2 and hydraulic residence times from 15 days to 1 2 year the thermal regime in the first two reservoirs is polymictic and in the other four reservoirs it is warm monomictic more detailed morphometric and hydrodynamic features of the reservoirs are described in soares et al 2020 the reservoirs are located in a sub tropical climate cwa köppen 1948 the annual mean air temperature is 22 6 c and the mean rainfall is 1400 mm of which about 80 falls from october to march inmet 2019 2 2 land use within the catchment and sources of external nutrient loads the total catchment basin of the cascade system covers 69 900 km2 the land within the catchment is mostly used for agriculture urban and pasture purposes while fragments of forestry and native vegetation cover small areas table 1 ibge 2018 barra bonita s catchment is the highest density region in the country where the são paulo metropolitan region is located there are large urban areas with more than 25 million inhabitants and several industries in addition there are agricultural lands mostly for sugarcane crops the sub catchments of ba ib pr and na reservoirs are quite similar in terms of land use and occupation agriculture lands mostly for the cultivation of oranges to supply the food industry and sugarcane to attend the sugar and alcohol industry are dominant in the sub catchments there are a total of 2 million inhabitants in which 94 lives in urban areas in the ti reservoir s sub catchment the land is used also for sugarcane crops and for cattle pasture there are 500 000 inhabitants 91 of whom live in urban areas 2 3 water quality within the reservoirs the water quality along the cascade system is characterized by a remarked trophic state gradient from up to downstream in response to the capacity of nutrient removal in each sub catchment basin fig 1 historically the uppermost reservoir barra bonita receives high amounts of nutrient loads from the high population density in its sub catchment the water quality has been severely compromised in this reservoir since the 1980s when blooms became established calijuri 1988 external nutrient loads to the reservoir are dominated by point sources from domestic raw sewage effluents from several industrial plants and discharges from wastewater plants with primary and secondary treatments which have low efficiency of nutrient removal cetesb 2019 in addition the inappropriate disposal of solid waste and improper discharge of sewage into the rainfall drainage system are other common sources of external nutrient loads ana 2012 in the ba and ib sub catchments nutrient loads come from the discharge of domestic raw sewage in freshwaters fertilizers applied in the intensive agriculture which reach the surroundings of the reservoirs in some stretches are other important contributors to the total nutrient load the pr reservoir is currently in the process of eutrophication due to external nutrient loads mostly from urban and agricultural non point sources in na and ti sub catchments external nutrient loads come mostly from non point sources such as agriculture pasture and runoff from urban areas 2 4 coupled hydrodynamic and biogeochemical modelling the one dimensional vertical general lake model glm coupled to the aquatic ecodynamics aed library simulates the hydrodynamics and biogeochemistry processes in lentic water bodies hipsey et al 2013 2019 both glm and aed are open source and freely available glm aed has been found to successfully reproduce observed water temperatures and quality of lakes with varying conditions around the world bucak et al 2018 fenocchi et al 2019 ladwig et al 2018 snortheim et al 2017 weng et al 2020 glm dynamically simulates vertical temperature profiles density and salinity at the whole lake water column averaged over the horizontal axis by using a lagrangian approach to the layer structure where layers expand and shrink based on changing vertical density gradients both the mass balance and the energy budget are computed every time step of the simulation aed simulates the interactions between nutrients organic matter phytoplankton and zooplankton the model accounts for the processes of atmospheric exchange sediment oxygen demand organic matter hydrolysis and mineralisation nitrification denitrification nitrogen fixation and adsorption desorption of filterable reactive phosphorus po4 the biological process of primary production respiration mortality excretion settling or resuspension and grazing processes are also included in the model components further information regarding the model process equations state variables and parameters can be found in the science manuals for glm hipsey et al 2019 and aed hipsey et al 2013 2 5 modelling procedure in the present study it was adopted the same configuration of glm aed version 2 2 0 previously applied to the study sites following three steps for these three steps the model was run at an hourly time step over a 9 year period from 2008 to 2016 a calibration procedure was performed to optimize state variables for the reservoirs with measured field data bb ib pr and ti from 2009 to 2012 the best fitted model was validated using an independent dataset from 2013 to 2016 as ba and na reservoirs lack field data the calibration and validation procedures could not be performed thus the parameters were maintained at their initial values based on the aed manual hipsey et al 2013 and in the literature the first year of simulation 2008 was considered a warm up period so it was not included for performance assessment to ensure the independence of the simulation results from the initial conditions the statistical software r 3 2 5 was used to simulate and analyze modelling results through a framework of open source packages glmr hipsey et al 2014 glmtools read et al 2014 glmgui poschlod et al 2018 and rlakeanalyzer winslow et al 2018 step 1 hydrodynamic modelling a sensitivity analysis was performed using the one at a time oat method glm parameters with sensitivity index si 0 01 were calibrated to optimize water level and temperature simultaneously table s1 an automatic calibration procedure was executed using the glmgui package poschlod et al 2018 which implements the brute force method the model performance was assessed through the root mean squared error rmse its value normalized value by the data range nrmse and the linear correlation coefficient r computed from simulated and measured water level and water temperature table s2 the wedderburn number was applied as an index of 1 d suitability as it is a relative measure of the vertical stratification strength against the horizontal wind energy at the surface the mean values of the simulated wedderburn number much greater than 1 attested to the adequacy of the 1 d assumption for all six reservoirs more details of the underlying procedures applied for hydrodynamic modelling are given in soares et al 2020 step 2 biogeochemical modelling the major processes in the water column were represented to simulate dissolved oxygen do total phosphorus tp nitrate no3 ammonium nh4 and phytoplankton in the lacustrine zone of each reservoir within the phytoplankton module all chlorophyll a was assumed to be cyanobacteria this assumption was adopted in face of the unavailability of regular time series of measured phytoplankton composition and it was supported by academic studies that occasionally performed the identification of phytoplankton composition in the study sites over the last decades attesting that cyanobacteria was the dominant functional group e g santos 2010 the aed parameters to be calibrated were selected based on their medium or high sensitivity and identifiability indexes they were simultaneously adjusted through a manual trial and error approach within a range of values set according to the literature table s3 calibration was carried out until the fit to observations could no longer be appreciably improved the goodness of fit metrics rmse nrmse r attested that the glm aed model was able to reasonably reproduce tp nh4 no3 do and chl a with a similar performance among reservoirs table s4 further details regarding the coupled hydrodynamic biogeochemical modelling are provided by soares and calijuri 2021 step 3 coupled hydrodynamic biogeochemical modelling following a sequential approach to represent the interconnection among reservoirs in a cascade system instead of simulating each reservoir alone the interconnection between them in a network of unidirectional water flow was simulated by taking into account the transfer of nutrients do and algae biomass from the outflow of one reservoir to the inflow of the next one the assumption of a hydrological connection among reservoirs was supported by the absence of important tributaries between the reservoirs in terms of discharge and external loads and the stretch of the tietê river between reservoirs is short varying from 22 km between bb and ba reservoirs to less than 7 km between the other reservoirs thus the hydrological patterns and nutrient inputs from those rivers were negligible the following methodological steps were implemented firstly the input loads to the uppermost reservoir were obtained from field measurements in the tributaries secondly the simulated daily concentrations of do po4 no3 nh4 and algae biomass in the bb outflow were used as input to ba reservoir then the same procedure was repeated from one reservoir to the next i e simulated daily concentrations of do po4 no3 nh4 and algae biomass in the ba outflow were used as input to ib reservoir and then successively until ti the last reservoir along the cascade system nutrient concentrations in both the outlet and the overflow which eventually occurred when the water volume exceeded the maximum storage volume were summed and weighted by each discharge chl a concentration only in the overflow was used as input for the next reservoir this procedure enabled an approach that fully links reservoir processes along the cascade system taking into account the feedback from one water body to the next 2 6 assessment of the trophic state index the trophic state index tsi adapted for subtropical reservoirs cunha et al 2013 was computed for the six reservoirs based on the simulated geometrical mean of tp and chlorophyll a chl a concentrations on the surface the index classifies the trophic state into six categories ultraoligotrophic tsi 51 1 oligotrophic 51 2 tsi 53 1 mesotrophic 53 2 tsi 55 7 eutrophic 55 8 tsi 58 1 supereutrophic 58 2 tsi 59 0 and hypereutrophic tsi 59 1 2 7 design of scenarios six scenarios s1 s6 were simulated to represent classical restoration practices encompassing both external and internal techniques that are usually used to address eutrophication in lakes and reservoirs worldwide abell et al 2020 ilec 2005 jilbert et al 2020 lürling et al 2016 stroom and kardinaal 2016 the scenarios were simulated by the model by changing specific forcing variables and parameter values that would be directly affected by the restoration method table 2 s1 reduction of external po4 load the reduction of po4 loads from point and non point sources within the basin catchment was represented by the reduction of the current daily inflow loads into the bb reservoir s2 reduction of internal po4 load by inactivation the usage of chemical agents to adsorb po4 enhancing its precipitation from the water column and immobilization on the sediment was simulated by decreasing the maximum sedimentation flux parameter for po4 f s e d p o 4 across the sediment water interface s3 reduction of phytoplankton biomass by algicides the usage of compounds to increase cyanobacteria mortality was represented by increasing the phytoplankton metabolic loss r r e s p s4 reduction of phytoplankton biomass by sedimentation the usage of flocculants to enhance phytoplankton settling was represented by increasing the phytoplankton sedimentation rate ω p h y s5 hypolimnetic withdrawal the discharge of nutrient rich hypolimentic water reducing the nutrient availability for epilimnetic primary producers was simulated by changing the withdrawal elevation outl elvs to be closer to the bottom s6 hypolimnetic aeration and oxygenation the increase of do concentration at the bottom to suppress sediment release and entrainment of nutrient rich bottom waters into the epilimnion was simulated by increasing the sediment oxygen flux f s e d o 2 the parameter s value was increased until the mean do concentration at the bottom reached 10 mg l 1 the daily po4 load into the bb reservoir is directly related to the tp concentration within the water body equation 1 thus decreasing the external po4 load will reduce the reservoir s tp concentration the parameter f s e d p o 4 is directly related to the flux of po4 from the sediment to the water interface f s e d p o 4 equation 2 a positive value means that the sediment releases po4 into the water column i e the sediment is a source of po4 otherwise a negative value means that po4 precipitates from the water column and the sediment is a sink of po4 thus decreasing f s e d p o 4 will decrease the po4 concentration at the bottom layers of water which can eventually be resuspended during turnover events ultimately decreasing its availability for primary production on the surface parameter r r e s p is directly related to phytoplankton mortality f m o r t equation 3 thus its increase will reduce phytoplankton biomass in the water column the parameter ω p h y is directly related to phytoplankton settling to the bottom f s e t t equation 4 thus its increase will reduce phytoplankton biomass at the euphotic zone the user defined outlet elevation outl elvs determines if the withdrawal is shallow or deep within the water column thus a deeper outlet elevation will promote the withdrawal of hypolimnetic waters and the parameter f s e d o 2 is directly related to the do concentration in the water layer immediately above the sediments f s e d o 2 equation 5 thus its increase will increase the hypolimnetic oxygenation 1 t p p o 4 p o 4 a d s d o p p o p p h y p 2 f s e d p o 4 f s e d p o 4 k s e d p o 4 k s e d p o 4 o 2 θ s e d p o 4 t 20 3 f m o r t 1 k f d o m r r e s p p h y n p 4 f s e t t ω p h y d z p h y n p 5 f s e d o 2 f s e d o 2 o 2 k s e d o 2 o 2 θ s e d o 2 t 20 where p o 4 is the concentration of filterable reactive phosphorus p o 4 a d s is the concentration of adsorbed filterable reactive phosphorus d o p is the concentration of dissolved organic phosphorus p o p is the concentration of particulate organic phosphorus p h y n p is the internal nitrogen and phosphorus concentration respectively within the phytoplankton k s e d p o 4 is the half saturation constant for oxygen dependence of sediment po4 flux o 2 is the do concentration in the water θ s e d p o 4 is the arrhenius temperature multiplier for sediment po4 flux t is the water temperature k f d o m is the fraction of metabolic loss that is dissolved organic matter d z is the thickness of the zth layer in the water column k s e d o 2 is the half saturation constant for oxygen dependence of sediment oxygen flux and θ s e d o 2 is the arrhenius temperature multiplier for sediment oxygen flux 2 8 simulation of scenarios two major assumptions guided the modelling procedure first all six restoration methods were simulated only to the uppermost reservoir in the chain and then they were propagated through one reservoir to the next following a sequential modelling approach in which the outflow from the first modeled reservoir was used as the inflow for the consecutive one in the network this assumption was based on the ability of the first reservoir along a cascade system to trigger a domino effect of regime shifts in the downstream direction hilt et al 2011 second the reduction of phosphorus concentration is mandatory for the recovery of the trophic state in reservoirs since phosphorus has historically been identified as the key factor in controlling eutrophication in inland waters lee et al 1980 and is generally found as the limiting nutrient for many ecological systems brett and benjamin 2008 maavara et al 2015 xu et al 2020 the forcing variable and parameter values were manually increased or decreased from their initial values by applying incremental steps table 3 until the mean trophic state index in the bb reservoir was changed from the hypereutrophic to the mesotrophic category each scenario was simulated separately changing the corresponding forcing variable or parameter while all other conditions were kept at their initial values the trophic state index in each reservoir was compared with the current condition s0 to assess the most efficient strategies for restoration and management of the cascade system from the simulated s1 s6 scenarios the most efficient ones were selected to comprise an additional scenario s7 in which the restoration methods were simulated simultaneously the scenarios were simulated for the 2008 2016 period but the first year of simulation 2008 was not considered for comparison purposes to eliminate the uncertainties of the model initial conditions 3 results 3 1 scenarios of individual restoration methods in the tietê river s cascade system po4 mainly originates from allochthonous inflow loads from the catchment reaching 2290 tons per year into the bb reservoir hence the restoration method intended to reduce external po4 load was expected to be successful indeed the simulation results show that the reduction of external po4 load s1 considerably decreased both the tp and chl a concentrations in the bb reservoir with mean values of 0 022 mg l 1 and 14 62 μg l 1 respectively table 4 figs 2 and 3 fulfilling the water quality threshold for avoiding mean tsi at the eutrophic categories similarly a substantial effect on both tp and chl a concentrations was also found for the reduction of internal po4 load by inactivation s2 revealing that the autochthonous po4 content that is released from the sediments is also an important source of phosphorus in the bb reservoir the decrease in chl a concentration following the reduction of po4 loads indicates that the phytoplankton is under direct bottom up control of phosphorus the bb reservoir s response to s1 and s2 scenarios was propagated along the cascade system promoting a domino effect of restoration and improving conditions in the five downstream reservoirs the decrease in tp and chl a concentrations were substantial in all reservoirs resulting in the suppression of eutrophy not only in the bb reservoir but along the cascade system fig 4 hence the reduction of po4 loads was proved to be an efficient method for restoration at the basin catchment scale however the requirements for achieving the mesotrophic threshold are as enormously high as the 95 reduction of external po4 load relative to the current condition and a sedimentation flux for phosphate of 3 000 mmol m 2 d 1 which was out of the range of values found in the literature table 5 restoration methods devoted to decreasing the phytoplankton biomass by its mortality using algicides s3 or by its sedimentation using flocculants s4 resulted in a markedly reduction on chl a concentration in the bb reservoir tp concentration also declined and thus the tsi was changed from hypereutrophic to mesotrophic in both scenarios these methods were proved to be successful at a local scale however improvements in the tsi of the bb reservoir were not propagated throughout the reservoirs cascade system thus the tsi was unchanged in the other five downstream reservoirs both parameter alterations r r e s p 0 09 and ω p h y 0 60 were in the range of values founded in previous studies indicating the viability of these methods to reduce phytoplankton biomass simulations of hypolimnetic withdrawal s5 showed that even if the outlet elevation was at 433 5 m only 0 5 m from the bottom the effects on tp and chl a concentrations would be small and not sufficient to improve the trophic condition in the bb reservoir similarly the increase of the sedimentation flux for do from 6 00 to 180 00 mmol m 2 d 1 to promote hypolimentic aeration and oxygenation s6 was not sufficient to improve the tsi in the bb reservoir despite a high do concentration in the bottom layers for both scenarios the tsi remained above 59 1 sustaining the hypertrophy within the reservoir no significant effects of these restoration methods were observed in the downstream reservoirs as well the low efficiency of both s5 and s6 is attributed to the polymictic behaviour of the bb reservoir where the outlet elevation is of lower importance as nutrient concentrations are frequently uniform along the water column the current do depletion and hypoxic conditions developed in the bottom waters were not suppressed even by a high increase in the sedimentation flux for do which was out of the literature range 3 2 scenarios of restoration methods acting simultaneously based on the simulated tsi for s1 s6 scenarios scenario s7 was comprised of the two methods intended to treat the excessive po4 load within the bb reservoir s1 and s2 i e the root cause of its severely degraded condition firstly the po4 sedimentation parameter f s e d p o 4 in the bb reservoir was adopted as 0 84 mmol m 2 d 1 to be within the literature range which was assumed as a viable sedimentation rate then the external po4 load was reduced at incremental 5 steps until the mesotrophic condition was achieved table 5 both methods acting simultaneously were able to considerably decrease the required reduction of external po4 load from 95 to 60 the s7 scenario proved to be a restoration strategy to improve the water quality at a catchment scale as both tp and chl a concentrations decreased in all downstream reservoirs table 4 avoiding the eutrophic condition ba reservoir was also mesotrophic ib was oligotrophic and pr na and ti reservoirs were ultraoligotrophic see fig 4 however episodic events of algal blooms still occurred in bb and ba reservoirs see fig 4 4 discussion 4 1 restoration methods 4 1 1 reducing external po4 loads from the catchment reducing external nutrient loads is a fundamental premise for lake restoration chorus et al 2020 chou et al 2021 liu et al 2018 and management efforts often focus on achieving this goal according to the model simulations a reduction of the external po4 load would be effective at controlling eutrophication in the reservoirs along the tietê river s cascade system the primary factor sustaining high external po4 load into the bb reservoir is point source pollution from domestic sewage due to its lack or insufficient collection and treatment 60 of sewage collection and 44 of treatment from which only 10 is submitted to tertiary treatment for phosphorus removal ana 2012 other point sources of external po4 loads are industrial effluents from more than 1000 industries of diverse sectors such as textile paper pulp food industry and sugar plants located at the catchment cetesb 2019 hence the most important strategy to control external po4 load into the bb reservoir is 1 to install interception facilities to collect raw sewage and convey its discharge to wastewater treatment plants wwtps huang et al 2019 moreover 2 the establishment of additional infra structures increasing sewage treatment capacity within the catchment by building new wwtps and implementing the tertiary treatment in the current ones are required to accommodate the continuously increasing urban and agricultural activities additionally 3 a river water treatment plant in the tietê river coutinho 2007 upstream from the reservoir s inlet and 4 constructed wetlands paerl and barnard 2020 could be efficient methods to improve the inflow water quality non point sources of po4 loads come from fertilizers pesticides deforestation and improper soil management diffuse pollution in both agricultural and urban areas and solid waste improperly disposed ana 2012 on land strategies to reduce diffuse load should include 5 controls on fertilizer usage in crops and adoption of better agriculture practices marttila et al 2020 6 efforts to implement reforestation and afforestation can also help to reduce the external po4 load since the loss of forest cover usually increases land erosion and sediment transport ilec 2005 in view of the lack of riparian vegetation in the bb reservoir s surroundings 7 the implementation of vegetated buffers composed by trees shrubs and grasses alongside the water body and its tributaries could remediate direct non point source pollution zhang et al 2010 8 land use planning and soil conservation practices can be effective in minimizing soil loss from poor land management in agricultural areas such as overgrazing fallow cultivation gully erosion and unstabilized streambanks ilec 2005 additionally 9 policy development and decision making for in catchment management should be based on best management practices and legislation designed to mitigate nutrient loads qiu et al 2018 finally 10 the financial compensation to landowners that provide ecosystem services from their land use through payment for ecosystem services may be an innovative sustainable way to reduce diffuse po4 sources into the reservoir mueller et al 2019 4 1 2 reducing internal po4 load by inactivation the introduction of compounds is used to adsorb po4 and form a stable complex that precipitates and remains permanently bound in the sediments ultimately being unavailable for phytoplankton uptake indeed in the present study the higher sedimentation of po4 completely removed any internal load from sediment to water column and the reservoir acted as a sink for po4 as a result tp concentration within the reservoir strongly reduced to 22 in comparison to the base scenario in response chl a concentration considerably reduced to 58 of its initial value revealing an effective bottom up regulation of phytoplankton through tp the most frequently used chemical agents have been aluminum salts iron lanthanium and calcium gibbs et al 2011 lürling et al 2016 søndergaard et al 2003 when used appropriately these materials have proved effective and produced rapid initial response to the treatment huser et al 2016a moreover these geoengineering materials were found to be ecosafe because they did not promote cyanobacterial cell lysis and did not release the intra and extracellular toxins in the water lucena silva et al 2019 the side effect of this method is the intrinsically po4 accumulation in the sediment as bb is a polymictic reservoir frequent mixing events may induce resuspension of the sediment p pool thus associated methods are required such as capping sediments to create a physical barrier between the sediment water interface hamilton et al 2016 or dredging bed sediments cao et al 2007 although dredging is costly and it can adversely affect benthic organisms and pose difficulties for disposing dredged sediments this method is most feasible for reservoirs in high use urban areas abell et al 2020 as is the case of the bb reservoir a key point to note is that none internal po4 inactivation method was found to be capable of removing a rate as high as 3 0 mmol m 2 d 1 285 mg m 2 d 1 for instance chemical treatments based on phosphorus inactivation succeeded to achieve sedimentation fluxes around 27 mg m 2 d 1 for the lake rotorua new zealand gibbs et al 2011 1 6 mg m 2 d 1 in six swedish lakes agstam norlin et al 2021 and 5 12 and 10 24 mg m 2 d 1 in two polish lakes kowalczewska madura et al 2017 2018 this implies that scenario s2 is not technically feasible outside of the modelling scenario as the phosphorus legacy within a water body originates from the external po4 load the efficiency of po4 inactivation is only sustainable with a concomitant control of the external po4 load or its association with other combined restoration methods barçante et al 2020 bormans et al 2016 huser et al 2016b when inactivation agents are applied in association with other restoration methods for managing internal phosphorus loads such as in scenario s7 80 mg m 2 d 1 higher sedimentation fluxes might be achieved e g 27 5 96 8 mg m 2 d 1 in lake vesijärvi finland niemistö et al 2016 4 1 3 reducing phytoplankton biomass by algicides algicides in particular copper sulfate hydrogen peroxide and potassium permanganate have been widely used to control phytoplankton biomass abell et al 2020 in the present study increasing phytoplankton mortality proved to be an efficient technique able to reduce 87 of chl a concentration in the water surface however considering the potential side effects of algicides on non target organisms such as zooplankton mollusks and fish due to excessive release of cyanotoxins water managers and stakeholders are usually reluctant to use chemical control stroom and kardinaal 2016 more recently new compounds for directed suppression of uniquely cyanobacteria which are so called as cyanocide show better specificity for cyanobacteria and are biodegradable or transform into non toxic products after applications demonstrating good prospects for sustainability matthijs et al 2016 as both algicides or cyanocides treat only a symptom of eutrophication but not its root cause resulting in a temporary effectiveness when they are the unique restoration method moss 2007 they must be applied in parallel with the reduction of external nutrient loads 4 1 4 reducing phytoplankton biomass by sedimentation the application of flocculants are intended to aggregate algal biomass and sink them with a ballast to the bottom lürling et al 2016 in the present study simulations of increasing the sedimentation rate of the phytoplankton achieved a high removal rate of 87 removal efficiencies of 60 90 were found for microcystis aeruginosa in freshwater li and pan 2013 traditional flocculants did not used to be environmental friendly or cost effective zou et al 2006 fortunately in recent years efforts have been made to develop flocculants based on natural and nontoxic clays such as montmorillonite kaolinite and phosphatic pan et al 2006 or on the soil particles from a bank near the water body modified by adding a small amount of biodegradable natural polymers or proteins such as chitosan pan et al 2011 therefore representing a lower risk to human and environmental health for instance flocculants were found to not affect metal residuals thus not threatening the aquatic ecosystem yuan et al 2016 hence reducing phytoplankton biomass by sedimentation can be a welcome technique combined with nutrient control methods for eutrophication management 4 1 5 hypolimnetic withdrawal withdrawal of nutrient rich water from the hypolimnion is a low cost technique often used in reservoirs discharging water for hydropower generation that frequently leads to a decrease in phosphorus and chlorophyll a concentrations in the epilimnion increases water transparency and decreases phosphorus concentration as well as anoxia in the hypolimnion jilbert et al 2020 however in the present study alterations on tp and chl a concentrations were smaller than 1 relative to the base scenario the main cause of the inefficiency of this method is attributed to the polymictic behaviour in the bb reservoir the frequent mixing events homogenise the water column thus nutrient concentration is quite vertically uniform for this reason this method is best suited for deep water bodies that exhibit stable stratification most importantly the hypolimentic withdrawal in the bb reservoir is not recommended because the withdrawal of nutrient rich waters will be the input for the ba reservoir which is the next one in the cascade system 4 1 6 hypolimnetic aeration and oxygenation hypolimnetic aeration can be achieved by adding oxygen to bottom waters using mechanical agitation direct injection of pure oxygen and direct injection of air bormans et al 2016 to promote oxic conditions at the sediment water interface aiming at suppressing the sediment release previous studies reported that the hypolimnetic aeration promoted sufficient do at the bottom but no effect on p reduction and phytoplankton biomass was achieved suggesting that aeration induced the mineralisation of organic matter and the phosphorus recycling niemistö et al 2016 taipale et al 2020 similarly the simulated scenario of hypolimentic aeration did not affect tp and chl a concentrations within the reservoir despite the increase of do concentration at the bottom layers as the parameters of the glm aed model are constant over the simulation period the sedimentation flux for do f s e d o 2 could not be increased only during specific hypoxic events thus the mean do at the bottom was quite high 10 mg l 1 but during some days its concentration was below the hypoxic threshold 2 mg l 1 this is a limitation of the simulated scenario that impairs a reliable assessment of the effects of hypolimentic aeration on tp and chl a concentrations which merits further investigations in future studies 4 2 managing highly degraded reservoirs along a cascade system the current hypereutrophic condition in bb and ba reservoirs prevents any use of these water bodies for water supply or recreational purposes and impairs ecosystem services they may provide in addition ib and pr reservoirs are currently under eutrophication and a progressive downstream degradation is forecasted reaching na and ti reservoirs barbosa et al 1999 hence it is urgent to implement restoration actions in order to maintain tp and chl a concentrations below critical thresholds and mitigate the severe degradation in reservoirs at the basin catchment scale the present study provides evidence that efforts to treat the root cause i e the external po4 load through the tietê river must be a priority to eliminate issues of water quality impairment not only in the uppermost reservoir but also in the downstream ones along the cascade system more than three decades have passed since the recognition of environmental degradation in the bb reservoir calijuri 1988 matsumura tundisi and tundisi 2005 the current trophic state is difficult to reverse due to established land use activities and high content of nutrients within the water body mueller et al 2015 indeed the accomplishment of the required 95 reduction of external po4 load into the bb reservoir if this were the only restoration method would demand enormous efforts in terms of planning and management infrastructure resources and financial investment similarly a reduction in the external nitrogen load by 70 was required to meet the water quality standards in a meso eutrophic reservoir in china chou et al 2021 when a water body receives extreme phosphorus inputs for an extended period of time its recovery may become irreversible i e it cannot be restored by input controls alone carpenter et al 1999 indeed the legacy of the internal phosphorus content may be very persistent due to its accumulation and subsequent release resulting in biogeochemical lags that delay improvements in water quality following the reduction of external po4 load abell et al 2020 water quality can therefore remain poor for years even after external loads have been remarkably reduced for example time recovery can extend from 2 to 4 years hanson et al 2017 to 10 15 years where there is a highly enriched bottom sediment jeppesen et al 2005 for this reason the inactivation of po4 from the water column can be a valuable method in parallel to the reduction of external po4 load into the bb reservoir comprising a combination of in lake and on land treatments to reinforce the reservoir s recovery besides additional interventions to treat eutrophication symptoms including the reduction of phytoplankton biomass by both algicides and sedimentation are recommended since they proved to be efficient methods to decrease tp and chl a concentrations within the bb reservoir it is important to emphasize that neither on land management nor in lake controls alone are capable of completely mitigating the eutrophication at the basin catchment scale but rather they are useful complimentary strategies to recover water quality long term effects of in lake treatments can however be difficult to achieve and in many cases lake restoration may need to be conducted on a regular basis rather than a once and for all solution søndergaard et al 2007 as part of a management plan research and educational programs are always helpful to foster citizens engagement with environmental protection finally long term monitoring campaigns at higher spatial and temporal resolution to obtain data records at a higher frequency are highly recommended 4 3 limitations while the present study applied the standard source code of the glm aed model to simulate six restoration methods future studies could implement other management scenarios in face of the model s open source adapting the model code can be useful for simulating the dredging of sediments which is envisaged as a required method in the bb reservoir especially following the inactivation of po4 by chemical agents and the sedimentation of phytoplankton by flocculants moreover the physical removal of surface phytoplankton scum by superficial skimming also requires further investigation as the model does not simulate high levels of biodiversity such as macrophytes and fish biomanipulation methods involving the introduction of species that affect the food web in a beneficial way could not be included in the present study besides the limitation of the model the study sites lack a detailed knowledge of the aquatic ecology of the reservoirs and the long term presence of ecological monitoring finally other hydrologic restoration strategies such as water level alterations were not implemented because they are incompatible with the reservoirs operation 4 4 restoration challenges in a changing climate increasing temperature in a future climate will likely act to negatively impact lake water quality me et al 2018 leading to an intensified impact in high nutrient reservoirs farrell et al 2020 previous studies chang et al 2015 rolighed et al 2016 ficker et al 2017 suggest that in lake phosphorus availability is expected to be enhanced by higher mineralisation rates and release from bottom sediments triggered by higher water temperatures in addition more frequent large storm events arising from climate change will likely result in increased exports of both dissolved and particulate phosphorus from agricultural lands in the catchment dolph et al 2019 considering the ongoing significant warming in the bb reservoir since 1993 with heating rates as high as 1 02 c per decade on the surface soares et al 2021 it is likely that more rigorous mitigation efforts may be needed to accomplish an even higher reduction of external nutrient load beyond current restoration targets to counteract the deterioration bucak et al 2018 in face of complex interactions and many controlling factors of eutrophication within lakes and reservoirs a dynamic coupled atmospheric land lake modelling approach has the potential to provide more realistic strategies for reducing po4 load from the catchment and move toward a holistic prediction of restoration management scenarios sharma et al 2018 5 conclusions the glm aed model was a valuable tool to assess the response of a reservoirs cascade system to different restoration methods over the 2009 2016 period whereas many studies evaluated restoration methods to a single water body as the authors are aware this is the first study evaluating the propagation of water quality improvements taking into account the feedback from one water body to the next in summary the major findings of the present study were 1 the reduction of both external and internal po4 loads is highly recommended as they treat the root cause of hypereutrophy in the bb reservoir besides the adopted model approach revealed the bottom up control of cyanobacteria and the propagation of improvements in all downstream reservoirs along the cascade system 2 the reduction of phytoplankton biomass proved to be a successful method to improve the trophic state in the bb reservoir however it did not support positive effects along the cascade system 3 no effects were promoted by hypolimnetic withdrawal or hypolimnetic aeration due to the polymictic behaviour in the bb reservoir and 4 the required 95 reduction in the external po 4 load when this method is applied alone would demand huge financial investment and commitment and is almost practically impossible to achieve hence the effective restoration at a basin catchment scale must comprise a combination of on land and in lake restoration techniques to make the recovery more feasible in highly degraded reservoirs the present study provides a methodology to investigate restoration methods that result in positive effects not only in the reservoir itself but also promoting an overall improvement in water quality at a basin catchment scale a restoration program of the aquatic ecosystems in the tietê river s cascade system is still absent even after thirty years since the recognition of eutrophication in the bb reservoir projecting a downstream degradation the presented findings have important implications for the studied system but can also be applied for other situations where lakes and reservoirs are located in cascade systems especially in highly anthropogenic impacted catchments declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national council for scientific and technological development cnpq appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105308 
25636,a coupled hydrodynamic biogeochemical model was applied to simulate scenarios of classic restoration practices to address eutrophication in a cascade system comprised of six reservoirs along the tietê river brazil from 2008 to 2016 each restoration scenario was propagated along the cascade system by using a sequential modelling approach the simulated scenarios revealed which on land and in lake restoration techniques are capable of promoting water quality improvements that are propagated to all downstream reservoirs along the cascade system the present findings may provide a useful management strategy to develop better restoration practices at a basin catchment scale for other lakes and reservoirs along cascade systems worldwide especially in highly anthropogenic impacted areas taking advantage of the propagation of water quality improvements in a downstream direction due to a domino effect triggered by the feedback from one water body to the next in a chain keywords lake degradation glm aed model phosphorus chlorophyll a trophic state index water management 1 introduction cultural eutrophication is widespread globally and across lake types regardless of latitude or morphometry ho et al 2019 and is the major problem facing inland waters downing 2014 eutrophication impacts can seriously impair the delivery of ecosystem services janssen et al 2020 and also promote negative economic consequences such as increased costs for public health and losses in commercially important fisheries mccrackin et al 2017 according to the period of exposure and degradation intensity eutrophication in water bodies can move from reversible when restoration follows the reduction of nutrient inputs to hysterestic when eutrophication can be reversed by combining nutrient input controls with temporary interventions then to irreversible when eutrophication cannot be reversed even by severe reductions in nutrient input carpenter et al 1999 therefore during the past several decades much effort has been made to restore degraded lakes and reservoirs as nutrient input is the primary cause of eutrophication in aquatic ecosystems worldwide great efforts and vast amounts of financial resources have been used to reduce the external nutrient loadings chou et al 2021 by managing both point and nonpoint sources in the basin catchment dolph et al 2019 in addition to accelerate recovery a suite of physical chemical and biological methods are applied after external loading reduction jeppesen et al 2017 to reactively combat both causes and consequences of eutrophication these methods are based on i reducing internal nutrient loads such as using an inactivation agent to permanently bind phosphorus in the sediments gibbs et al 2011 huser et al 2016b lucena silva et al 2019 ii biomanipulation burns et al 2014 jeppesen et al 2007 iii phytoplankton control by application of algicides matthijs et al 2016 or natural polymers as flocculants yuan et al 2016 zou et al 2006 and iv hydrologic manipulation niemistö et al 2016 while these methods have been discussed for decades eutrophication problems persist and recovery remains a global challenge wurtsbaugh et al 2019 either because external loading has not been reduced sufficiently or because internal lake mechanisms prevent or delay recovery søndergaard et al 2007 fortunately an increasing number of water bodies are reversing towards re oligotrophication in western europe and north america anneville et al 2019 indeed many of europe s largest lakes have been recovered from eutrophication schindler 2012 following tertiary wastewater treatment and the removal of phosphorus from sewage effluent jeppesen et al 2005 in contrast point sources are now progressively increasing to affect the quality of the environment for various systems in developing nations where the population is growing jenny et al 2020 despite successes in north america and europe in reducing eutrophication the number of case studies on the recovery from eutrophication in tropical climates is far less advanced than in temperate lakes coveney et al 2005 liu et al 2018 in the case of brazilian lakes and reservoirs the effects of rapid population growth not accompanied by a proportionate increase in sanitation infrastructure have resulted in eutrophication in 57 of the lentic environments ana 2012 however this number is potentially quite underestimated considering that there are not many monitored water bodies in addition the country faces sociopolitical challenges due to conflicts because of overarching goals for economic development in detriment of adequate attention to environmental protection by the state thomaz et al 2020 which poses further stress in highly degraded aquatic ecosystems a large body of literature reports the response of aquatic ecosystems to restoration methods for individual study sites however the effects of restoration methods on lakes and reservoirs situated along a cascade system are understudied the feedback from one water body to the next in a chain is of crucial importance due to a domino effect in water quality along the network teurlincx et al 2019 in this study we recognize the need of incorporating the connectivity through reservoirs to potentialise restoration efforts in water bodies connected by a cascade system a cascade system comprised of six reservoirs located in southeast brazil was selected as the case study the main goals were 1 to apply the hydrodynamic general lake model coupled to the biogeochemical aquatic ecodynamics library glm aed previously calibrated and validated to simulate scenarios of classic restoration methods and investigate the reservoirs response in terms of the trophic state index 2 to investigate how the restoration scenarios are propagated along the cascade system by using a sequential modelling approach to transport the feedback from one reservoir to the next one in the chain and 3 to elaborate a scenario consisting of a combination of the most efficient restoration methods to promote an overall improvement in water quality not only in one reservoir but in all water bodies along the cascade system we intend to provide subsidies for water managers to develop better restoration methods at a basin catchment scale to recover aquatic ecosystems considering the synergistic propagation in a downstream direction 2 methods 2 1 site description from the 1960s to the 1990s a cascade system comprised of six reservoirs was built along the tietê river southeast brazil the reservoirs are from up to downstream barra bonita bb bariri ba ibitinga ib promissão pr nova avanhandava na and três irmãos ti they are hydrologically connected through the tietê river for operational optimization through flow regulation to attend the common purpose of hydropower generation as a result reservoirs affect water quantity and quality from up to downstream along the cascade system besides they attend multiple uses including navigation drinking water supply irrigation fishery flood regulation and tourism the reservoirs have a varied range of physical characteristics with maximum depths from 19 2 to 45 6 m surface areas from 46 to 654 km2 and hydraulic residence times from 15 days to 1 2 year the thermal regime in the first two reservoirs is polymictic and in the other four reservoirs it is warm monomictic more detailed morphometric and hydrodynamic features of the reservoirs are described in soares et al 2020 the reservoirs are located in a sub tropical climate cwa köppen 1948 the annual mean air temperature is 22 6 c and the mean rainfall is 1400 mm of which about 80 falls from october to march inmet 2019 2 2 land use within the catchment and sources of external nutrient loads the total catchment basin of the cascade system covers 69 900 km2 the land within the catchment is mostly used for agriculture urban and pasture purposes while fragments of forestry and native vegetation cover small areas table 1 ibge 2018 barra bonita s catchment is the highest density region in the country where the são paulo metropolitan region is located there are large urban areas with more than 25 million inhabitants and several industries in addition there are agricultural lands mostly for sugarcane crops the sub catchments of ba ib pr and na reservoirs are quite similar in terms of land use and occupation agriculture lands mostly for the cultivation of oranges to supply the food industry and sugarcane to attend the sugar and alcohol industry are dominant in the sub catchments there are a total of 2 million inhabitants in which 94 lives in urban areas in the ti reservoir s sub catchment the land is used also for sugarcane crops and for cattle pasture there are 500 000 inhabitants 91 of whom live in urban areas 2 3 water quality within the reservoirs the water quality along the cascade system is characterized by a remarked trophic state gradient from up to downstream in response to the capacity of nutrient removal in each sub catchment basin fig 1 historically the uppermost reservoir barra bonita receives high amounts of nutrient loads from the high population density in its sub catchment the water quality has been severely compromised in this reservoir since the 1980s when blooms became established calijuri 1988 external nutrient loads to the reservoir are dominated by point sources from domestic raw sewage effluents from several industrial plants and discharges from wastewater plants with primary and secondary treatments which have low efficiency of nutrient removal cetesb 2019 in addition the inappropriate disposal of solid waste and improper discharge of sewage into the rainfall drainage system are other common sources of external nutrient loads ana 2012 in the ba and ib sub catchments nutrient loads come from the discharge of domestic raw sewage in freshwaters fertilizers applied in the intensive agriculture which reach the surroundings of the reservoirs in some stretches are other important contributors to the total nutrient load the pr reservoir is currently in the process of eutrophication due to external nutrient loads mostly from urban and agricultural non point sources in na and ti sub catchments external nutrient loads come mostly from non point sources such as agriculture pasture and runoff from urban areas 2 4 coupled hydrodynamic and biogeochemical modelling the one dimensional vertical general lake model glm coupled to the aquatic ecodynamics aed library simulates the hydrodynamics and biogeochemistry processes in lentic water bodies hipsey et al 2013 2019 both glm and aed are open source and freely available glm aed has been found to successfully reproduce observed water temperatures and quality of lakes with varying conditions around the world bucak et al 2018 fenocchi et al 2019 ladwig et al 2018 snortheim et al 2017 weng et al 2020 glm dynamically simulates vertical temperature profiles density and salinity at the whole lake water column averaged over the horizontal axis by using a lagrangian approach to the layer structure where layers expand and shrink based on changing vertical density gradients both the mass balance and the energy budget are computed every time step of the simulation aed simulates the interactions between nutrients organic matter phytoplankton and zooplankton the model accounts for the processes of atmospheric exchange sediment oxygen demand organic matter hydrolysis and mineralisation nitrification denitrification nitrogen fixation and adsorption desorption of filterable reactive phosphorus po4 the biological process of primary production respiration mortality excretion settling or resuspension and grazing processes are also included in the model components further information regarding the model process equations state variables and parameters can be found in the science manuals for glm hipsey et al 2019 and aed hipsey et al 2013 2 5 modelling procedure in the present study it was adopted the same configuration of glm aed version 2 2 0 previously applied to the study sites following three steps for these three steps the model was run at an hourly time step over a 9 year period from 2008 to 2016 a calibration procedure was performed to optimize state variables for the reservoirs with measured field data bb ib pr and ti from 2009 to 2012 the best fitted model was validated using an independent dataset from 2013 to 2016 as ba and na reservoirs lack field data the calibration and validation procedures could not be performed thus the parameters were maintained at their initial values based on the aed manual hipsey et al 2013 and in the literature the first year of simulation 2008 was considered a warm up period so it was not included for performance assessment to ensure the independence of the simulation results from the initial conditions the statistical software r 3 2 5 was used to simulate and analyze modelling results through a framework of open source packages glmr hipsey et al 2014 glmtools read et al 2014 glmgui poschlod et al 2018 and rlakeanalyzer winslow et al 2018 step 1 hydrodynamic modelling a sensitivity analysis was performed using the one at a time oat method glm parameters with sensitivity index si 0 01 were calibrated to optimize water level and temperature simultaneously table s1 an automatic calibration procedure was executed using the glmgui package poschlod et al 2018 which implements the brute force method the model performance was assessed through the root mean squared error rmse its value normalized value by the data range nrmse and the linear correlation coefficient r computed from simulated and measured water level and water temperature table s2 the wedderburn number was applied as an index of 1 d suitability as it is a relative measure of the vertical stratification strength against the horizontal wind energy at the surface the mean values of the simulated wedderburn number much greater than 1 attested to the adequacy of the 1 d assumption for all six reservoirs more details of the underlying procedures applied for hydrodynamic modelling are given in soares et al 2020 step 2 biogeochemical modelling the major processes in the water column were represented to simulate dissolved oxygen do total phosphorus tp nitrate no3 ammonium nh4 and phytoplankton in the lacustrine zone of each reservoir within the phytoplankton module all chlorophyll a was assumed to be cyanobacteria this assumption was adopted in face of the unavailability of regular time series of measured phytoplankton composition and it was supported by academic studies that occasionally performed the identification of phytoplankton composition in the study sites over the last decades attesting that cyanobacteria was the dominant functional group e g santos 2010 the aed parameters to be calibrated were selected based on their medium or high sensitivity and identifiability indexes they were simultaneously adjusted through a manual trial and error approach within a range of values set according to the literature table s3 calibration was carried out until the fit to observations could no longer be appreciably improved the goodness of fit metrics rmse nrmse r attested that the glm aed model was able to reasonably reproduce tp nh4 no3 do and chl a with a similar performance among reservoirs table s4 further details regarding the coupled hydrodynamic biogeochemical modelling are provided by soares and calijuri 2021 step 3 coupled hydrodynamic biogeochemical modelling following a sequential approach to represent the interconnection among reservoirs in a cascade system instead of simulating each reservoir alone the interconnection between them in a network of unidirectional water flow was simulated by taking into account the transfer of nutrients do and algae biomass from the outflow of one reservoir to the inflow of the next one the assumption of a hydrological connection among reservoirs was supported by the absence of important tributaries between the reservoirs in terms of discharge and external loads and the stretch of the tietê river between reservoirs is short varying from 22 km between bb and ba reservoirs to less than 7 km between the other reservoirs thus the hydrological patterns and nutrient inputs from those rivers were negligible the following methodological steps were implemented firstly the input loads to the uppermost reservoir were obtained from field measurements in the tributaries secondly the simulated daily concentrations of do po4 no3 nh4 and algae biomass in the bb outflow were used as input to ba reservoir then the same procedure was repeated from one reservoir to the next i e simulated daily concentrations of do po4 no3 nh4 and algae biomass in the ba outflow were used as input to ib reservoir and then successively until ti the last reservoir along the cascade system nutrient concentrations in both the outlet and the overflow which eventually occurred when the water volume exceeded the maximum storage volume were summed and weighted by each discharge chl a concentration only in the overflow was used as input for the next reservoir this procedure enabled an approach that fully links reservoir processes along the cascade system taking into account the feedback from one water body to the next 2 6 assessment of the trophic state index the trophic state index tsi adapted for subtropical reservoirs cunha et al 2013 was computed for the six reservoirs based on the simulated geometrical mean of tp and chlorophyll a chl a concentrations on the surface the index classifies the trophic state into six categories ultraoligotrophic tsi 51 1 oligotrophic 51 2 tsi 53 1 mesotrophic 53 2 tsi 55 7 eutrophic 55 8 tsi 58 1 supereutrophic 58 2 tsi 59 0 and hypereutrophic tsi 59 1 2 7 design of scenarios six scenarios s1 s6 were simulated to represent classical restoration practices encompassing both external and internal techniques that are usually used to address eutrophication in lakes and reservoirs worldwide abell et al 2020 ilec 2005 jilbert et al 2020 lürling et al 2016 stroom and kardinaal 2016 the scenarios were simulated by the model by changing specific forcing variables and parameter values that would be directly affected by the restoration method table 2 s1 reduction of external po4 load the reduction of po4 loads from point and non point sources within the basin catchment was represented by the reduction of the current daily inflow loads into the bb reservoir s2 reduction of internal po4 load by inactivation the usage of chemical agents to adsorb po4 enhancing its precipitation from the water column and immobilization on the sediment was simulated by decreasing the maximum sedimentation flux parameter for po4 f s e d p o 4 across the sediment water interface s3 reduction of phytoplankton biomass by algicides the usage of compounds to increase cyanobacteria mortality was represented by increasing the phytoplankton metabolic loss r r e s p s4 reduction of phytoplankton biomass by sedimentation the usage of flocculants to enhance phytoplankton settling was represented by increasing the phytoplankton sedimentation rate ω p h y s5 hypolimnetic withdrawal the discharge of nutrient rich hypolimentic water reducing the nutrient availability for epilimnetic primary producers was simulated by changing the withdrawal elevation outl elvs to be closer to the bottom s6 hypolimnetic aeration and oxygenation the increase of do concentration at the bottom to suppress sediment release and entrainment of nutrient rich bottom waters into the epilimnion was simulated by increasing the sediment oxygen flux f s e d o 2 the parameter s value was increased until the mean do concentration at the bottom reached 10 mg l 1 the daily po4 load into the bb reservoir is directly related to the tp concentration within the water body equation 1 thus decreasing the external po4 load will reduce the reservoir s tp concentration the parameter f s e d p o 4 is directly related to the flux of po4 from the sediment to the water interface f s e d p o 4 equation 2 a positive value means that the sediment releases po4 into the water column i e the sediment is a source of po4 otherwise a negative value means that po4 precipitates from the water column and the sediment is a sink of po4 thus decreasing f s e d p o 4 will decrease the po4 concentration at the bottom layers of water which can eventually be resuspended during turnover events ultimately decreasing its availability for primary production on the surface parameter r r e s p is directly related to phytoplankton mortality f m o r t equation 3 thus its increase will reduce phytoplankton biomass in the water column the parameter ω p h y is directly related to phytoplankton settling to the bottom f s e t t equation 4 thus its increase will reduce phytoplankton biomass at the euphotic zone the user defined outlet elevation outl elvs determines if the withdrawal is shallow or deep within the water column thus a deeper outlet elevation will promote the withdrawal of hypolimnetic waters and the parameter f s e d o 2 is directly related to the do concentration in the water layer immediately above the sediments f s e d o 2 equation 5 thus its increase will increase the hypolimnetic oxygenation 1 t p p o 4 p o 4 a d s d o p p o p p h y p 2 f s e d p o 4 f s e d p o 4 k s e d p o 4 k s e d p o 4 o 2 θ s e d p o 4 t 20 3 f m o r t 1 k f d o m r r e s p p h y n p 4 f s e t t ω p h y d z p h y n p 5 f s e d o 2 f s e d o 2 o 2 k s e d o 2 o 2 θ s e d o 2 t 20 where p o 4 is the concentration of filterable reactive phosphorus p o 4 a d s is the concentration of adsorbed filterable reactive phosphorus d o p is the concentration of dissolved organic phosphorus p o p is the concentration of particulate organic phosphorus p h y n p is the internal nitrogen and phosphorus concentration respectively within the phytoplankton k s e d p o 4 is the half saturation constant for oxygen dependence of sediment po4 flux o 2 is the do concentration in the water θ s e d p o 4 is the arrhenius temperature multiplier for sediment po4 flux t is the water temperature k f d o m is the fraction of metabolic loss that is dissolved organic matter d z is the thickness of the zth layer in the water column k s e d o 2 is the half saturation constant for oxygen dependence of sediment oxygen flux and θ s e d o 2 is the arrhenius temperature multiplier for sediment oxygen flux 2 8 simulation of scenarios two major assumptions guided the modelling procedure first all six restoration methods were simulated only to the uppermost reservoir in the chain and then they were propagated through one reservoir to the next following a sequential modelling approach in which the outflow from the first modeled reservoir was used as the inflow for the consecutive one in the network this assumption was based on the ability of the first reservoir along a cascade system to trigger a domino effect of regime shifts in the downstream direction hilt et al 2011 second the reduction of phosphorus concentration is mandatory for the recovery of the trophic state in reservoirs since phosphorus has historically been identified as the key factor in controlling eutrophication in inland waters lee et al 1980 and is generally found as the limiting nutrient for many ecological systems brett and benjamin 2008 maavara et al 2015 xu et al 2020 the forcing variable and parameter values were manually increased or decreased from their initial values by applying incremental steps table 3 until the mean trophic state index in the bb reservoir was changed from the hypereutrophic to the mesotrophic category each scenario was simulated separately changing the corresponding forcing variable or parameter while all other conditions were kept at their initial values the trophic state index in each reservoir was compared with the current condition s0 to assess the most efficient strategies for restoration and management of the cascade system from the simulated s1 s6 scenarios the most efficient ones were selected to comprise an additional scenario s7 in which the restoration methods were simulated simultaneously the scenarios were simulated for the 2008 2016 period but the first year of simulation 2008 was not considered for comparison purposes to eliminate the uncertainties of the model initial conditions 3 results 3 1 scenarios of individual restoration methods in the tietê river s cascade system po4 mainly originates from allochthonous inflow loads from the catchment reaching 2290 tons per year into the bb reservoir hence the restoration method intended to reduce external po4 load was expected to be successful indeed the simulation results show that the reduction of external po4 load s1 considerably decreased both the tp and chl a concentrations in the bb reservoir with mean values of 0 022 mg l 1 and 14 62 μg l 1 respectively table 4 figs 2 and 3 fulfilling the water quality threshold for avoiding mean tsi at the eutrophic categories similarly a substantial effect on both tp and chl a concentrations was also found for the reduction of internal po4 load by inactivation s2 revealing that the autochthonous po4 content that is released from the sediments is also an important source of phosphorus in the bb reservoir the decrease in chl a concentration following the reduction of po4 loads indicates that the phytoplankton is under direct bottom up control of phosphorus the bb reservoir s response to s1 and s2 scenarios was propagated along the cascade system promoting a domino effect of restoration and improving conditions in the five downstream reservoirs the decrease in tp and chl a concentrations were substantial in all reservoirs resulting in the suppression of eutrophy not only in the bb reservoir but along the cascade system fig 4 hence the reduction of po4 loads was proved to be an efficient method for restoration at the basin catchment scale however the requirements for achieving the mesotrophic threshold are as enormously high as the 95 reduction of external po4 load relative to the current condition and a sedimentation flux for phosphate of 3 000 mmol m 2 d 1 which was out of the range of values found in the literature table 5 restoration methods devoted to decreasing the phytoplankton biomass by its mortality using algicides s3 or by its sedimentation using flocculants s4 resulted in a markedly reduction on chl a concentration in the bb reservoir tp concentration also declined and thus the tsi was changed from hypereutrophic to mesotrophic in both scenarios these methods were proved to be successful at a local scale however improvements in the tsi of the bb reservoir were not propagated throughout the reservoirs cascade system thus the tsi was unchanged in the other five downstream reservoirs both parameter alterations r r e s p 0 09 and ω p h y 0 60 were in the range of values founded in previous studies indicating the viability of these methods to reduce phytoplankton biomass simulations of hypolimnetic withdrawal s5 showed that even if the outlet elevation was at 433 5 m only 0 5 m from the bottom the effects on tp and chl a concentrations would be small and not sufficient to improve the trophic condition in the bb reservoir similarly the increase of the sedimentation flux for do from 6 00 to 180 00 mmol m 2 d 1 to promote hypolimentic aeration and oxygenation s6 was not sufficient to improve the tsi in the bb reservoir despite a high do concentration in the bottom layers for both scenarios the tsi remained above 59 1 sustaining the hypertrophy within the reservoir no significant effects of these restoration methods were observed in the downstream reservoirs as well the low efficiency of both s5 and s6 is attributed to the polymictic behaviour of the bb reservoir where the outlet elevation is of lower importance as nutrient concentrations are frequently uniform along the water column the current do depletion and hypoxic conditions developed in the bottom waters were not suppressed even by a high increase in the sedimentation flux for do which was out of the literature range 3 2 scenarios of restoration methods acting simultaneously based on the simulated tsi for s1 s6 scenarios scenario s7 was comprised of the two methods intended to treat the excessive po4 load within the bb reservoir s1 and s2 i e the root cause of its severely degraded condition firstly the po4 sedimentation parameter f s e d p o 4 in the bb reservoir was adopted as 0 84 mmol m 2 d 1 to be within the literature range which was assumed as a viable sedimentation rate then the external po4 load was reduced at incremental 5 steps until the mesotrophic condition was achieved table 5 both methods acting simultaneously were able to considerably decrease the required reduction of external po4 load from 95 to 60 the s7 scenario proved to be a restoration strategy to improve the water quality at a catchment scale as both tp and chl a concentrations decreased in all downstream reservoirs table 4 avoiding the eutrophic condition ba reservoir was also mesotrophic ib was oligotrophic and pr na and ti reservoirs were ultraoligotrophic see fig 4 however episodic events of algal blooms still occurred in bb and ba reservoirs see fig 4 4 discussion 4 1 restoration methods 4 1 1 reducing external po4 loads from the catchment reducing external nutrient loads is a fundamental premise for lake restoration chorus et al 2020 chou et al 2021 liu et al 2018 and management efforts often focus on achieving this goal according to the model simulations a reduction of the external po4 load would be effective at controlling eutrophication in the reservoirs along the tietê river s cascade system the primary factor sustaining high external po4 load into the bb reservoir is point source pollution from domestic sewage due to its lack or insufficient collection and treatment 60 of sewage collection and 44 of treatment from which only 10 is submitted to tertiary treatment for phosphorus removal ana 2012 other point sources of external po4 loads are industrial effluents from more than 1000 industries of diverse sectors such as textile paper pulp food industry and sugar plants located at the catchment cetesb 2019 hence the most important strategy to control external po4 load into the bb reservoir is 1 to install interception facilities to collect raw sewage and convey its discharge to wastewater treatment plants wwtps huang et al 2019 moreover 2 the establishment of additional infra structures increasing sewage treatment capacity within the catchment by building new wwtps and implementing the tertiary treatment in the current ones are required to accommodate the continuously increasing urban and agricultural activities additionally 3 a river water treatment plant in the tietê river coutinho 2007 upstream from the reservoir s inlet and 4 constructed wetlands paerl and barnard 2020 could be efficient methods to improve the inflow water quality non point sources of po4 loads come from fertilizers pesticides deforestation and improper soil management diffuse pollution in both agricultural and urban areas and solid waste improperly disposed ana 2012 on land strategies to reduce diffuse load should include 5 controls on fertilizer usage in crops and adoption of better agriculture practices marttila et al 2020 6 efforts to implement reforestation and afforestation can also help to reduce the external po4 load since the loss of forest cover usually increases land erosion and sediment transport ilec 2005 in view of the lack of riparian vegetation in the bb reservoir s surroundings 7 the implementation of vegetated buffers composed by trees shrubs and grasses alongside the water body and its tributaries could remediate direct non point source pollution zhang et al 2010 8 land use planning and soil conservation practices can be effective in minimizing soil loss from poor land management in agricultural areas such as overgrazing fallow cultivation gully erosion and unstabilized streambanks ilec 2005 additionally 9 policy development and decision making for in catchment management should be based on best management practices and legislation designed to mitigate nutrient loads qiu et al 2018 finally 10 the financial compensation to landowners that provide ecosystem services from their land use through payment for ecosystem services may be an innovative sustainable way to reduce diffuse po4 sources into the reservoir mueller et al 2019 4 1 2 reducing internal po4 load by inactivation the introduction of compounds is used to adsorb po4 and form a stable complex that precipitates and remains permanently bound in the sediments ultimately being unavailable for phytoplankton uptake indeed in the present study the higher sedimentation of po4 completely removed any internal load from sediment to water column and the reservoir acted as a sink for po4 as a result tp concentration within the reservoir strongly reduced to 22 in comparison to the base scenario in response chl a concentration considerably reduced to 58 of its initial value revealing an effective bottom up regulation of phytoplankton through tp the most frequently used chemical agents have been aluminum salts iron lanthanium and calcium gibbs et al 2011 lürling et al 2016 søndergaard et al 2003 when used appropriately these materials have proved effective and produced rapid initial response to the treatment huser et al 2016a moreover these geoengineering materials were found to be ecosafe because they did not promote cyanobacterial cell lysis and did not release the intra and extracellular toxins in the water lucena silva et al 2019 the side effect of this method is the intrinsically po4 accumulation in the sediment as bb is a polymictic reservoir frequent mixing events may induce resuspension of the sediment p pool thus associated methods are required such as capping sediments to create a physical barrier between the sediment water interface hamilton et al 2016 or dredging bed sediments cao et al 2007 although dredging is costly and it can adversely affect benthic organisms and pose difficulties for disposing dredged sediments this method is most feasible for reservoirs in high use urban areas abell et al 2020 as is the case of the bb reservoir a key point to note is that none internal po4 inactivation method was found to be capable of removing a rate as high as 3 0 mmol m 2 d 1 285 mg m 2 d 1 for instance chemical treatments based on phosphorus inactivation succeeded to achieve sedimentation fluxes around 27 mg m 2 d 1 for the lake rotorua new zealand gibbs et al 2011 1 6 mg m 2 d 1 in six swedish lakes agstam norlin et al 2021 and 5 12 and 10 24 mg m 2 d 1 in two polish lakes kowalczewska madura et al 2017 2018 this implies that scenario s2 is not technically feasible outside of the modelling scenario as the phosphorus legacy within a water body originates from the external po4 load the efficiency of po4 inactivation is only sustainable with a concomitant control of the external po4 load or its association with other combined restoration methods barçante et al 2020 bormans et al 2016 huser et al 2016b when inactivation agents are applied in association with other restoration methods for managing internal phosphorus loads such as in scenario s7 80 mg m 2 d 1 higher sedimentation fluxes might be achieved e g 27 5 96 8 mg m 2 d 1 in lake vesijärvi finland niemistö et al 2016 4 1 3 reducing phytoplankton biomass by algicides algicides in particular copper sulfate hydrogen peroxide and potassium permanganate have been widely used to control phytoplankton biomass abell et al 2020 in the present study increasing phytoplankton mortality proved to be an efficient technique able to reduce 87 of chl a concentration in the water surface however considering the potential side effects of algicides on non target organisms such as zooplankton mollusks and fish due to excessive release of cyanotoxins water managers and stakeholders are usually reluctant to use chemical control stroom and kardinaal 2016 more recently new compounds for directed suppression of uniquely cyanobacteria which are so called as cyanocide show better specificity for cyanobacteria and are biodegradable or transform into non toxic products after applications demonstrating good prospects for sustainability matthijs et al 2016 as both algicides or cyanocides treat only a symptom of eutrophication but not its root cause resulting in a temporary effectiveness when they are the unique restoration method moss 2007 they must be applied in parallel with the reduction of external nutrient loads 4 1 4 reducing phytoplankton biomass by sedimentation the application of flocculants are intended to aggregate algal biomass and sink them with a ballast to the bottom lürling et al 2016 in the present study simulations of increasing the sedimentation rate of the phytoplankton achieved a high removal rate of 87 removal efficiencies of 60 90 were found for microcystis aeruginosa in freshwater li and pan 2013 traditional flocculants did not used to be environmental friendly or cost effective zou et al 2006 fortunately in recent years efforts have been made to develop flocculants based on natural and nontoxic clays such as montmorillonite kaolinite and phosphatic pan et al 2006 or on the soil particles from a bank near the water body modified by adding a small amount of biodegradable natural polymers or proteins such as chitosan pan et al 2011 therefore representing a lower risk to human and environmental health for instance flocculants were found to not affect metal residuals thus not threatening the aquatic ecosystem yuan et al 2016 hence reducing phytoplankton biomass by sedimentation can be a welcome technique combined with nutrient control methods for eutrophication management 4 1 5 hypolimnetic withdrawal withdrawal of nutrient rich water from the hypolimnion is a low cost technique often used in reservoirs discharging water for hydropower generation that frequently leads to a decrease in phosphorus and chlorophyll a concentrations in the epilimnion increases water transparency and decreases phosphorus concentration as well as anoxia in the hypolimnion jilbert et al 2020 however in the present study alterations on tp and chl a concentrations were smaller than 1 relative to the base scenario the main cause of the inefficiency of this method is attributed to the polymictic behaviour in the bb reservoir the frequent mixing events homogenise the water column thus nutrient concentration is quite vertically uniform for this reason this method is best suited for deep water bodies that exhibit stable stratification most importantly the hypolimentic withdrawal in the bb reservoir is not recommended because the withdrawal of nutrient rich waters will be the input for the ba reservoir which is the next one in the cascade system 4 1 6 hypolimnetic aeration and oxygenation hypolimnetic aeration can be achieved by adding oxygen to bottom waters using mechanical agitation direct injection of pure oxygen and direct injection of air bormans et al 2016 to promote oxic conditions at the sediment water interface aiming at suppressing the sediment release previous studies reported that the hypolimnetic aeration promoted sufficient do at the bottom but no effect on p reduction and phytoplankton biomass was achieved suggesting that aeration induced the mineralisation of organic matter and the phosphorus recycling niemistö et al 2016 taipale et al 2020 similarly the simulated scenario of hypolimentic aeration did not affect tp and chl a concentrations within the reservoir despite the increase of do concentration at the bottom layers as the parameters of the glm aed model are constant over the simulation period the sedimentation flux for do f s e d o 2 could not be increased only during specific hypoxic events thus the mean do at the bottom was quite high 10 mg l 1 but during some days its concentration was below the hypoxic threshold 2 mg l 1 this is a limitation of the simulated scenario that impairs a reliable assessment of the effects of hypolimentic aeration on tp and chl a concentrations which merits further investigations in future studies 4 2 managing highly degraded reservoirs along a cascade system the current hypereutrophic condition in bb and ba reservoirs prevents any use of these water bodies for water supply or recreational purposes and impairs ecosystem services they may provide in addition ib and pr reservoirs are currently under eutrophication and a progressive downstream degradation is forecasted reaching na and ti reservoirs barbosa et al 1999 hence it is urgent to implement restoration actions in order to maintain tp and chl a concentrations below critical thresholds and mitigate the severe degradation in reservoirs at the basin catchment scale the present study provides evidence that efforts to treat the root cause i e the external po4 load through the tietê river must be a priority to eliminate issues of water quality impairment not only in the uppermost reservoir but also in the downstream ones along the cascade system more than three decades have passed since the recognition of environmental degradation in the bb reservoir calijuri 1988 matsumura tundisi and tundisi 2005 the current trophic state is difficult to reverse due to established land use activities and high content of nutrients within the water body mueller et al 2015 indeed the accomplishment of the required 95 reduction of external po4 load into the bb reservoir if this were the only restoration method would demand enormous efforts in terms of planning and management infrastructure resources and financial investment similarly a reduction in the external nitrogen load by 70 was required to meet the water quality standards in a meso eutrophic reservoir in china chou et al 2021 when a water body receives extreme phosphorus inputs for an extended period of time its recovery may become irreversible i e it cannot be restored by input controls alone carpenter et al 1999 indeed the legacy of the internal phosphorus content may be very persistent due to its accumulation and subsequent release resulting in biogeochemical lags that delay improvements in water quality following the reduction of external po4 load abell et al 2020 water quality can therefore remain poor for years even after external loads have been remarkably reduced for example time recovery can extend from 2 to 4 years hanson et al 2017 to 10 15 years where there is a highly enriched bottom sediment jeppesen et al 2005 for this reason the inactivation of po4 from the water column can be a valuable method in parallel to the reduction of external po4 load into the bb reservoir comprising a combination of in lake and on land treatments to reinforce the reservoir s recovery besides additional interventions to treat eutrophication symptoms including the reduction of phytoplankton biomass by both algicides and sedimentation are recommended since they proved to be efficient methods to decrease tp and chl a concentrations within the bb reservoir it is important to emphasize that neither on land management nor in lake controls alone are capable of completely mitigating the eutrophication at the basin catchment scale but rather they are useful complimentary strategies to recover water quality long term effects of in lake treatments can however be difficult to achieve and in many cases lake restoration may need to be conducted on a regular basis rather than a once and for all solution søndergaard et al 2007 as part of a management plan research and educational programs are always helpful to foster citizens engagement with environmental protection finally long term monitoring campaigns at higher spatial and temporal resolution to obtain data records at a higher frequency are highly recommended 4 3 limitations while the present study applied the standard source code of the glm aed model to simulate six restoration methods future studies could implement other management scenarios in face of the model s open source adapting the model code can be useful for simulating the dredging of sediments which is envisaged as a required method in the bb reservoir especially following the inactivation of po4 by chemical agents and the sedimentation of phytoplankton by flocculants moreover the physical removal of surface phytoplankton scum by superficial skimming also requires further investigation as the model does not simulate high levels of biodiversity such as macrophytes and fish biomanipulation methods involving the introduction of species that affect the food web in a beneficial way could not be included in the present study besides the limitation of the model the study sites lack a detailed knowledge of the aquatic ecology of the reservoirs and the long term presence of ecological monitoring finally other hydrologic restoration strategies such as water level alterations were not implemented because they are incompatible with the reservoirs operation 4 4 restoration challenges in a changing climate increasing temperature in a future climate will likely act to negatively impact lake water quality me et al 2018 leading to an intensified impact in high nutrient reservoirs farrell et al 2020 previous studies chang et al 2015 rolighed et al 2016 ficker et al 2017 suggest that in lake phosphorus availability is expected to be enhanced by higher mineralisation rates and release from bottom sediments triggered by higher water temperatures in addition more frequent large storm events arising from climate change will likely result in increased exports of both dissolved and particulate phosphorus from agricultural lands in the catchment dolph et al 2019 considering the ongoing significant warming in the bb reservoir since 1993 with heating rates as high as 1 02 c per decade on the surface soares et al 2021 it is likely that more rigorous mitigation efforts may be needed to accomplish an even higher reduction of external nutrient load beyond current restoration targets to counteract the deterioration bucak et al 2018 in face of complex interactions and many controlling factors of eutrophication within lakes and reservoirs a dynamic coupled atmospheric land lake modelling approach has the potential to provide more realistic strategies for reducing po4 load from the catchment and move toward a holistic prediction of restoration management scenarios sharma et al 2018 5 conclusions the glm aed model was a valuable tool to assess the response of a reservoirs cascade system to different restoration methods over the 2009 2016 period whereas many studies evaluated restoration methods to a single water body as the authors are aware this is the first study evaluating the propagation of water quality improvements taking into account the feedback from one water body to the next in summary the major findings of the present study were 1 the reduction of both external and internal po4 loads is highly recommended as they treat the root cause of hypereutrophy in the bb reservoir besides the adopted model approach revealed the bottom up control of cyanobacteria and the propagation of improvements in all downstream reservoirs along the cascade system 2 the reduction of phytoplankton biomass proved to be a successful method to improve the trophic state in the bb reservoir however it did not support positive effects along the cascade system 3 no effects were promoted by hypolimnetic withdrawal or hypolimnetic aeration due to the polymictic behaviour in the bb reservoir and 4 the required 95 reduction in the external po 4 load when this method is applied alone would demand huge financial investment and commitment and is almost practically impossible to achieve hence the effective restoration at a basin catchment scale must comprise a combination of on land and in lake restoration techniques to make the recovery more feasible in highly degraded reservoirs the present study provides a methodology to investigate restoration methods that result in positive effects not only in the reservoir itself but also promoting an overall improvement in water quality at a basin catchment scale a restoration program of the aquatic ecosystems in the tietê river s cascade system is still absent even after thirty years since the recognition of eutrophication in the bb reservoir projecting a downstream degradation the presented findings have important implications for the studied system but can also be applied for other situations where lakes and reservoirs are located in cascade systems especially in highly anthropogenic impacted catchments declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national council for scientific and technological development cnpq appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105308 
25637,understanding the sustainability of current groundwater extractions is critical in the face of changing climate and anthropogenic conditions but this proves challenging in areas with complex and not well understood hydrogeology a combination of unsupervised self organizing map som and supervised long short term memory lstm models is demonstrated here to effectively abstract prevalent patterns from a diverse set of groundwater monitoring time series in the dry and hydrogeologically complicated namoi region enabling predictions of water levels based on climate and anthropogenic conditions to be made using a set of regional deep learning based neural networks by drawing on shared pattern information from across the namoi system the som reduces the complexity of the multiple time series shares information between sparse time series which could not be modelled with the lstm individually adds a spatial aspect to the lstm analysis and provides a valuable visual analysis that enhances communication and decision making keywords hydrology multiple time series lstm visualisation clustering machine learning water resources som 1 introduction the recurrent extraction of groundwater from any region requires careful consideration and management and this is especially true for regions already experiencing hydrological stress from a changing climate and increasing anthropological influences understanding patterns of historic groundwater levels and responses to external pressures in these areas is necessary in order to ensure that groundwater management decisions will lead to a sustainable future the namoi river valley to the west of the great dividing range of eastern australia is one such region complex hydrogeological relationships exist here due to a naturally dry climate combined with hydrologically intense agricultural requirements the namoi system has been steadily drawn upon for decades to provide significant volumes of groundwater for agricultural use with amongst the highest levels of groundwater extraction in the murray darling basin one of australia s largest agricultural regions csiro 2011 rassam et al 2013 welsh et al 2014 rainfall in much of the area is overshadowed by potential evapotranspiration resulting in little rainfall recharge to replenish the aquifers substantial interest exists therefore in examining the response of local groundwater levels to climate and pumping with an understanding that current rates of extraction in this already dry region may not be sustainable under a changing climate although groundwater monitoring and modelling in this area is critical in order to understand patterns of water level fluctuations and to predict likely responses to future conditions the tasks of monitoring and modelling are not straightforward in this region for a number of reasons firstly available groundwater monitoring data and extraction records contain substantial gaps though a comprehensive monitoring network spans the region with groundwater levels recorded at hundreds of wells as with any field data collected manually the time series from these wells are characterised by differing record lengths and sporadic measurements in the namoi region gaps of up to 2 or 3 months intersperse the water level measurements at each location though the network has good spatial coverage the irregular temporal resolution suggests that peaks and troughs of aquifer levels may be missed from the records furthermore data on groundwater extraction volumes is available only in annual sums limiting the ability to determine short term groundwater responses to local pumping secondly a complete understanding of the subsurface hydrogeological system is not available though not comprehensively defined it is known to consist of multiple semi connected aquifers and the response of groundwater levels in these aquifers to the changing external influences is complex a straightforward relationship between rainfall and groundwater levels does not exist as might be found in less stressed systems rainfall evapotranspiration surface groundwater interactions and anthropogenic pressures through pumping and dam releases each affect the system in nonlinear ways added to this the namoi groundwater levels do not follow clear spatiotemporal patterns due to the distribution of the multiple aquifers subsurface discontinuities variations in hydraulic conductivity proximity to surface water bodies and the proliferation of pumping wells these factors make traditional physically based models difficult to employ without requiring numerous assumptions or extensive time consuming and expensive supplementary subsurface data collection to be made though the sustainable management of this groundwater resource requires an understanding of the spatiotemporal water level patterns and responses to external stresses to enable informed decision making about groundwater extractions the limited understanding of the subsurface conditions and lack of detailed water level data and extraction volumes leads to uncertainty about how factors such as rainfall and pumping may be influencing the water levels in this area acknowledging this difficulty in understanding the complicated subsurface interactions in the namoi region a method has been sought to simplify and represent this complexity regardless of the limitations of the data a benefit of groundwater monitoring data from a spatial network is that whilst the individual time series may be sporadic there exists a set of many time series covering the spatial area the namoi network consists of a rich set of time series each of which contains pattern information that may relate to patterns elsewhere in the monitoring network by combining these multiple time series in a data driven analysis the opportunity for understanding and predicting the predominant regional groundwater patterns exists without requiring a complete knowledge of the physical hydrogeological system neural network modelling of groundwater time series traditionally involves individual wells and does not always account for temporal correlations in the data as individual groundwater time series usually do not provide large data sets innovative methods such as the long shortterm memory algorithm lstm hochreiter and schmidhuber 1997 a modern deep learning algorithm specifically for time series are often inaccessible for their analysis therefore there is room for advancement of the application of machine learning methods to form a spatial analysis of multiple groundwater time series fortunately the regional namoi monitoring network consists of multiple wells with relatively concurrent time series recorded over many decades a fact that can be exploited following contemporary machine learning developments current research in the field of machine learning is supporting the merging of many simultaneous time series building models incorporating information from groups of time series to produce predictions on individual time series this enables the sharing of pattern information between the time series whilst also increasing the size of the dataset and improving prediction performance bandara et al 2020 montero manso and hyndman 2020 salinas et al 2020 by training a single or global model on a data set representing all of the time series combined the essential theory is that the time series result from similar but not identical processes and merging them allows information to be revealed that may be common across the system rather than assuming each time series comes from a different data generating process long memory patterns and complex relationships can be learned by these global models and this cross system information is then drawn upon to make predictions on the individual time series a partitioned model follows the same theory as a global model but is trained on a subset of the time series rather than the entire set 1 1 study description in this study a workflow blending unsupervised learning and deep learning shares information across multiple time series in the region enabling an understanding of regional groundwater patterns and leading to efficient data driven predictions no hydrogeological input or assumptions are required and the sporadic nature of the time series is circumvented prominent temporal patterns that are common amongst subsets of the time series are discovered and this shared information is drawn upon to facilitate predictions at each individual measurement location the first step of this workflow involves making sense of the substantial spatiotemporal variation in the groundwater level measurements after this the relationships between groundwater levels climate and anthropogenic influences are modelled using the self organizing map som kohonen 1990 an unsupervised learning method for data reduction and visualisation the main temporal patterns amongst the time series are extracted clusters of monitoring wells with similar concurrent time series patterns are determined irrespective of physical proximity indicating groups of wells that have historically responded in similar ways to the climate and anthropogenic conditions of the time visualisation of the som results provides an easily accessible and important analytic tool to aid in understanding the varied spatiotemporal groundwater patterns in the region the identified prevalent patterns incorporating knowledge from across each subgroup of similar time series are then fed into a set of lstms for supervised modelling based on regional climate and extraction data the set of lstms one for each main temporal pattern are able to produce predictions of groundwater level responses to climate and extraction conditions for the subset of individual time series matching each pattern predictions can then be made with the same lstm for multiple individual groundwater wells in various aquifers in the namoi region regardless of spatial proximity or aquifer as long as it has been determined with the som that the time series respond similarly to local climate and pumping conditions analysis of the complex namoi groundwater system is enabled through the harnessing of information from across the multiple groundwater level time series in the region summarizing the patterns and structures that are common amongst them and determining the relationships that exist between the extracted predominant groundwater patterns and external factors such as climate and pumping the novelty of this study arises from the merging of information from multiple regional time series allowing a blended method of unsupervised and supervised modelling to be used this leads to a thorough exploratory spatiotemporal investigation of groundwater levels in the region followed by predictions of groundwater levels at individual locations the workflow specifically provides visual analytics for understanding and communication of the complex local groundwater patterns and facilitation of a contemporary deep learning method for time series analysis to perform predictions on individual time series that otherwise would not support this algorithm delivering predictions on the groundwater trends of this varied and complex system the method also provides a visual and intuitive representation of the spatial and temporal variations of regional groundwater levels the resulting understanding of the historic patterns combined with the set of deep learning groundwater level predictions lead to an awareness of the regional patterns that can be drawn upon to support groundwater management decisions 2 related work neural network applications for groundwater analyses have continuously progressed from the use of static neural networks such as multi layer perceptrons mlp eg daliakopoulos et al 2005 to time series based recurrent neural networks rnn eg bowes et al 2019 and most recently the deep learning based long short term memory network lstm eg lee et al 2020 kratzert et al 2018 bowes et al 2019 in which the model determines which information from the past is important to retain over time and which can be forgotten through comparisons on individual groundwater time series studies have shown the lstm to be more effective for predictions than other types of neural networks zhang et al 2018 huang et al 2019 jeong and park 2019 reasons for this are that the mlp which is not designed for temporal data is able to cope with irregularly spaced measurements but is not able to explicitly capture autocorrelation structures and the rnn encounters error propagation issues when applied to longer time series the lstm has gained popularity in recent years in hydrologic modelling due to its ability to make accurate predictions on time series by efficiently learning intervariable relationships and nonlinear temporal patterns there are many reasons why neural networks in general are finding successful applications in the hydrological sciences goodfellow et al 2016 describe how neural networks can easily handle issues such as nonstationarity collinearity and correlations daliakopoulos et al 2005 showed that for groundwater time series with shifts and trends neural networks are able to detect the trends and make predictions even when the prediction data lies beyond the range of the training set shen 2018 describes how deep networks are able to model highly complex functions and spatiotemporal dependencies from large hydrological data sets it has been found that neural networks capture the complex nonlinear behaviour of groundwater and hydrological time series better than traditional statistical methods such as arima autoregressive integrated moving average model and multiple linear regression rajaee et al 2019 zounemat kermani et al 2021 neural networks have also proven successful when compared to physically based models mohanty et al 2013 yin et al 2021 lee et al 2019 describe the benefits of neural networks for analysis of groundwater systems with highly variable anthropogenic influences as they can model complex nonlinear systems with less data requirements than physically based models furthermore nearing et al 2021 highlight how neural networks have the potential to extract more information and insights from expanding hydrological datasets than can be currently accessed with traditional methods and suggest that the field of hydrology would benefit from keeping up with developments in machine learning neural networks have already proven effective in some australian aquifer analyses for example huang et al 2019 predicted a time series of regional annual groundwater recharge in the australian states of south australia and victoria based on an average of multiple wells using both an mlp and lstm finding that the lstm produced better prediction results yu et al 2020 used deep learning models to emulate complex process based groundwater flow and contaminant transport models in south australia and yin et al 2021 investigated the use of lstms with remote sensing input data in victoria with developments coming steadily out of the field of machine learning there is always the potential to ask which of these can be adapted to benefit applications in the field of hydrology one such recent development in machine learning research is the technique of combining multiple time series to form global models allowing patterns that are common across the time series to be determined and then using these models to produce predictions on individual time series montero manso and hyndman 2020 have described how neural network models trained on a group of time series that may or may not be generated by related processes outperform traditional local time series models such as arima and ets error trend seasonality model on the same data sets bandara et al 2020 use an lstm on groups of time series that have been clustered based on the similarity of time series features where the input is the past values of the time series with no exogenous predictors and show that when applied to sets of time series that have been identified to share similar characteristics the lstm outperforms state of the art univariate forecasting methods where individual time series models may suffer from overfitting due to smaller sample sizes the global models will not have this issue and therefore are capable of greater generalisation outside of the data on which they are trained montero manso and hyndman 2020 an extension of autoregressive recurrent neural networks to probabilistic forecasting of multiple time series has been developed by salinas et al 2020 known as the deepar algorithm which is currently proving successful in sales time series forecasting groundwater research is just beginning to see authors using the lstm on groups of time series in innovative ways overall the majority of past applications using lstms to predict groundwater levels have focussed on time series from individual wells eg zhang et al 2018 jeong and park 2019 for studies involving more than one well it is common practice to create a separate neural network for each well eg lee et al 2019 bowes et al 2019 and many studies then connect these results with kriging rajaee et al 2019 however recent interest is growing in incorporating available information from multiple wells in a region vu et al 2020 used lstms to infill and extend groundwater level time series from a group of piezometers in france determining that using multiple highly correlated time series for model training led to better prediction accuracy compared with using the time series from a single well kratzert et al 2018 created a regional lstm model using the combined information from over 240 catchments and then fine tuned the overall model individually by catchment it was found that the individual models which had been initially trained on the overall dataset performed better than models trained solely by individual catchment for a comprehensive review of the intersection of hydrology and contemporary deep learning research see shen 2018 and shen et al 2018 3 study area 3 1 location and hydrologic characteristics the study region comprises the area surrounding the namoi river in northern central west nsw australia see fig 1 the upper and lower namoi reaches refer to the areas southeast of and northwest of narrabri respectively the upper namoi covers approximately 3800 km2 between quirindi and narrabri and the lower namoi encompasses approximately 7600 km2 between narrabri and walgett welsh et al 2014 the topography is dominated by highlands in the south and east and a floodplain in the west with the lowest elevation occurring near walgett in the far northwest the main flow of surface water into the region occurs from the east and southeast via the namoi and peel rivers the namoi river joins with the peel river downstream of keepit dam near tamworth and converges with the mooki river near gunnedah before flowing northwesterly through narrabri and walgett groundwater in the region generally flows from the south and east towards the northwest following the flowpath of the river travelling northward in the upper namoi subregion groundwater flows through a bedrock constriction north of narrabri and into the lower namoi subregion in which it takes on a more westerly course the groundwater monitoring wells generally track this line of flow as shown on fig 1 the far north and western portions of the namoi basin comprise part of australia s great artesian basin system 3 2 anthropogenic and climate influences the main water sources for human use in the namoi region are surface water from the namoi river and its tributaries shallow alluvial groundwater and deep groundwater the rivers and creeks are highly regulated by dams and weirs to meet the water requirements of the population with surface extractions occurring at many points along the waterways as the groundwater system is closely linked to the surface water system these surface extractions significantly affect groundwater levels kelly et al 2013 groundwater extractions are also high with large volumes of groundwater extracted from the deep aquifers for use in agriculture having been significantly influenced by the millennium drought that affected southeast australia from 1997 to 2009 the namoi region was also one of the regions most affected by the 2017 2019 drought the hottest and driest period ever recorded in the murray darling basin by december 2018 keepit dam which regulates the namoi river upstream of the namoi groundwater region was down to 5 of it s full capacity surface area bluedotobservatory 2021 and remained at this level until february 2020 3 2 1 groundwater system and recharge mechanisms the namoi aquifer system has two layers shallow aquifers at approximately 30 40 m in depth and deep aquifers at approximately 40 100 m barrett 2012 these aquifers are separated in some areas by aquitards and connected in other areas though the extent of vertical and horizontal connectivity and inter aquifer water flux is unknown welsh et al 2014 there is also limited understanding of fluxes between surface water and the aquifers kelly et al 2007 hydraulic conductivities are highly variable in this region with the variations being largely undefined though generally increasing with depth lupton et al 2019 the main groundwater recharge mechanism is leakage from the namoi river and other surface water bodies to a lesser extent recharge comes from rainfall irrigation and lateral through flow between aquifers barrett 2012 crosbie 2018 interaction between the surface water and groundwater is facilitated by alluvial deposits along the rivers having a higher conductivity than the underlying rocks holland et al 2019 this connectivity means that the highly regulated river flows influence the groundwater levels through river recharge particularly during dry periods and often maintain fairly consistent groundwater levels csiro 2011 on the other hand the finding that increased groundwater usage in the region corresponds almost entirely to induced leakage from surface water bodies csiro 2011 indicates this connectivity may be causing the groundwater system to appear more resilient to extractions than it actually is amanambu et al 2020 the importance of accounting for these surface and groundwater interactions for modelling in the namoi region was highlighted by rassam et al 2013 in the lower namoi region between narrabri and walgett water is lost to groundwater from pian creek and the namoi river whereas in the upper namoi between boggabri and narrabri the water flux is reversed and the namoi river gains water from the groundwater system barrett 2012 csiro 2011 holland et al 2019 rassam et al 2013 predict the boggabri narrabri reach may change to become predominantly losing water to groundwater if extended drought conditions occur in the future and pumping continues to increase heavy pumping can reverse the natural vertical hydraulic gradients causing a weakening in the upward potential in regions that primarily have groundwater flowing upwards thereby reducing surface water availability the response of groundwater levels to precipitation in this catchment can vary from well to well within the same aquifer due to soil permeability and distance from the recharge area green et al 2011 around narrabri in the centre of the region the potential evaporation is almost 8 fold the amount of rainfall csiro 2011 limiting recharge from rainfall events in the west of the region near walgett timms et al 2012 found there is no significant response of groundwater levels to large rainfall events whereas in the upper namoi groundwater levels show a rapid response to rainfall irrigation in the namoi region returns great volumes of water that have been extracted from the deep aquifers for use in agriculture back into the shallow aquifers this significant flow of water between deep and shallow aquifers is unmeasured a number of faults in the southwest of the region create subsurface hydraulic disconnections and significantly affect the flow of groundwater though the effect is not well understood welsh et al 2014 3 3 complexity of intervariable relationships though groundwater recharge is directly affected by rainfall and evapotranspiration these processes also indirectly affect groundwater withdrawals regulated surface flows and irrigation recharge green et al 2011 meixner et al 2016 whilst dam outflows and therefore surface flows may be increased during periods of low rainfall for water use requirements they may also increase during periods of high rainfall when dam levels are high making the relationship between rainfall and surface water highly nonlinear recharge is a threshold process and soil moisture conditions govern the contribution of rain towards groundwater recharge rain after a dry period will first go towards increasing soil moisture rather than percolating into groundwater and therefore declining precipitation trends may lead to a sharper decline in longterm groundwater recharge meixner et al 2016 on the other hand peaks of extreme precipitation will not be absorbed by already saturated soil and further increases in precipitation will not lead to increased recharge during dry conditions of low rainfall and high evapotranspiration the groundwater level becomes especially sensitive to extraction rates rassam et al 2013 confounding the temporal relationships brought about by periods of drought and changes in pumping regimes a water sharing plan setting environmental flow requirements and extraction limits went into effect in november 2006 barrett 2012 3 4 previous studies recent modelling in the namoi region has mostly been undertaken as part of the australian government s bioregional assessments for proposed coal seam gas and coal mine works eg welsh et al 2014 janardhanan et al 2018 lupton et al 2019 and holland et al 2019 prior to this rassam et al 2013 performed numerical modelling to investigate interactions between surface water and groundwater in the upper namoi region and the influence of groundwater pumping on surface water flows kelly et al 2013 examined the impact of groundwater withdrawals in the namoi region using time series from 458 wells this study investigated multi decadal changes in recovered water levels after each pumping season the influence of streamflow on recharge and compared groundwater levels to groundwater extractions between 1988 and 2008 the largest decline in recovered groundwater level at an individual well was found to be 14 5 m and the largest increase was 5 5 m with the modal 20 year drawdown in the region being 4 m welsh et al 2014 provide a thorough description of the area including topology hydrogeology climate soil characteristics land cover and water use for more information on the hydrogeology the history of groundwater extractions in the namoi region and the complexities of the recharge mechanisms see kelly et al 2013 4 data hydrologic and climatologic time series used in this study include groundwater levels rainfall evapotranspiration river flows and groundwater extraction volumes the study dates are january 1974 december 2018 4 1 groundwater level data groundwater level data from 165 monitoring wells in the upper and lower namoi alluviums are used in this study this dataset has been provided by the nsw department of planning industry and environment dpie and the data is publicly available for download from the waternsw website web2 fig 2 shows a sample of the groundwater level time series from the upper and lower namoi regions it can be seen that the temporal patterns are similar between some wells and differ greatly between others a glance at these time series quickly reveals strongly changing groundwater level patterns in some wells particularly in recent years these plots also highlight the sporadic measurement frequency and the differing start and end dates of the time series when monitoring sites have been commissioned and decommissioned the 165 time series come from wells at 70 different sites or monitoring locations each site has up to three wells accessing the shallow and deep aquifers at different levels below the surface the upper namoi data comes from 110 wells at 47 sites 47 are shallow and 63 are deep and the lower namoi data comes from 55 wells at 23 sites 18 shallow 37 deep the shallow aquifers are recharged quickly by rainfall and river leakage and the groundwater levels often closely follow precipitation and surface water levels the deeper aquifers take longer to recharge with recharge mechanisms that are difficult to determine whilst losing significant amounts of water to pumping the time series from wells accessing the deep aquifers reflect these complex recharge discharge mechanisms a challenge with these time series is the non constant measurement frequency when measurements started in the late 1960 s observations were performed manually and repeated approximately every 6 weeks by the late 2000 s a limited selection of wells had been installed with automatic telemeters recording groundwater levels on an hourly basis in this study the number of wells with telemetered daily data is small 15 out of the 165 wells all of which are in the upper namoi region the number of measurements at each well over the 45 year study period 1974 2018 range from 17 to 4113 with a median of 253 measurements per well a sample time series for an individual well is shown in fig 3 along with indications of external conditions it can be seen that the water level was relatively steady in the 1970 s and early 80 s and then began to decrease knowing that 1985 1997 was an era of high pumping one might assume pumping to be the cause of the onset of declining water levels during this time but the declining water level continues at a similar rate through the millennium drought of 1997 2009 when climate must be an influencing factor as well in the 2010 s the stabilising of water levels and clearly defined annual fluctuations may be a result of the rollout of the water sharing plan 2006 the end of the drought reductions in pumping or a combination of these influences it is clear from this figure that various external forces may lead to similar groundwater level responses 4 2 climate data the climate in the namoi region ranges from temperate in the southeast around quirindi to subtropical around narrabri to a grasslands biome in the northwest around walgett average annual rainfall varies from greater than 1100 mm year in the southeast to less than 500 mm year in the west welsh et al 2014 average annual actual evapotranspiration is higher in the east and lower in the west varying with land use and aquifer hydraulic conductivity rainfall and evapotranspiration measurements were downloaded at daily resolution from silo web1 silo datasets consist of bureau of meteorology bom data that have been enhanced by the infilling of missing values data from five bom climate measurement stations are used in this study walgett council depot station 52026 narrabri west post office station 53030 gunnedah resource centre station 55024 tamworth 55054 and quirindi post office station 55049 locations are indicated on fig 1 evapotranspiration data is an estimate of the loss of water in the rainfall groundwater system through the mechanisms of evaporation and transpiration the data used here comes from the silo evapotranspiration variable penman monteith reference evapotranspiration fao56 which is a measure of the potential evapotranspiration that would occur if unlimited soil water were available rainfall and evapotranspiration data for a sample year are shown in fig 4 a and c it can be seen that the daily rainfall differs quite noticeably between these climate stations whereas the evapotranspiration measurements follow more similar patterns 4 3 surface flow data river flow data mean daily discharge rate 1974 2018 were downloaded from the waternsw website web2 for the following streamflow gauges on the namoi river goangra station 419026 upstream of walgett mollee station 419039 downstream of mollee weir between narrabri and weewaa downstream of keepit dam station 419007 the peel river at carroll gap station 419006 and the mooki river at breeza station 419027 the station locations are shown on fig 1 fig 4b showing river dischage data for a sample year suggests that patterns of surface flows are complicated and reflect a combination of natural phenomena and human interventions it can be seen that in the summer months of jan mar the river level at 419039 downstream of the dam follows the dam releases relatively closely whereas the other river levels are unrelated however during the big rains at the beginning of april which we can see in fig 4a occur mostly in the west of the region around walgett release from the dam effectively closes off and there is a spike in streamflow at 419026 in the west the high rains at the end of the year on the other hand fall more evenly over the entire region and so while there is again no outflow from the dam during this period flow increases in all reaches as they naturally follow the rainfall patterns 4 4 extraction data groundwater extraction data were provided by dpie in the form of annual extraction volumes ml year at locations specified by latitude and longitude for 59 extraction wells 42 in the upper namoi region and 17 in the lower namoi region fig 4d shows the recorded annual extraction data for this selection of pumping wells the provided extraction records begin in 1985 for lower namoi and 1986 for upper namoi though pumping began in the namoi catchment in 1966 kelly et al 2013 for this analysis we have assumed zero annual extractions to have occurred at all stations prior to 1985 due to a lack of information however this is a large approximation to use in the modelling as it overlooks many years of pumping from fig 4d there appears to have been a significant reduction in pumping starting in the late 1990 s the extraction wells included in this study are not the full set in the region other wells in the region may be influencing groundwater levels significantly though we do not have data for them the extraction wells included in this study were provided due to their proximity to monitoring wells therefore the locations of the monitoring and extraction wells are closely matched according to welsh et al 2014 there are in fact more than 18 000 licensed extraction wells in the namoi river basin another challenge with the extraction data is that it is available only at an annual resolution making it difficult to pair this data with the daily data available for other variables to integrate the annual extraction data into the modelling monthly extraction levels have been set as proportional to the annual levels and attributed evenly throughout the year 4 5 software and data availability analyses for this study were performed in r version 3 6 3 r core team 2013 with packages keras for lstm modelling chollet et al 2017 and kohonen for self organizing map modelling wehrens et al 2007 groundwater level data and river discharge data are publicly available for download from waternsw web2 rainfall and evapotranspiration measurements are publicly available for download from silo web1 groundwater extraction data were provided by dpie in the form of annual extraction volumes ml year 5 methods to analyse this intermittent and varied set of groundwater time series and the concurrent time series for rainfall evapotranspiration surface water and extractions a combination of unsupervised and supervised learning is used unsupervised learning is useful for finding relationships between a set of given data items to determine existing patterns without knowing in advance what to look for it does not require both predictor and response variables lecun et al 2015 supervised learning on the other hand is the process of matching predictor variables with measured outcomes in order to learn input output relationships a supervised model is trained on a set of data for which the outcomes are known and the trained model is then used to predict outcomes for a set of previously unseen conditions a data reduction step is first used to make sense of the spatiotemporal characteristics of the groundwater level data by extracting patterns and determining similarities amongst the time series the individual time series become apportioned into meaningful groups in which the responses to external forces are related for the members of each group only after the data is reduced to this manageable set of patterns can the relationships between these patterns and the external factors be analysed predictive modelling is then performed on a representative time series from each group that best characterises the temporal patterns of the group s members in order to determine how each pattern relates to external conditions this two stage process is summarised as follows 1 unsupervised clustering is conducted with the self organizing map algorithm som relationships between the individual well time series are explored and the wells are separated into clusters in which there is evidence of similar temporal behaviour this stage only uses groundwater level data 2 a supervised deep learning network specifically for time series analysis the long shortterm memory network lstm is applied to each cluster the nonlinear relationships between the groundwater levels and the influencing factors of rainfall surface flow evapotranspiration and extractions are modelled 5 1 unsupervised learning for clustering 5 1 1 som background the self organizing map som kohonen 1990 is an unsupervised learning algorithm from the family of neural networks that is used for pattern extraction clustering dimension reduction and data visualisation with the som prevalent patterns in the data set are identified and each data item is allocated to its best match amongst these patterns these clusters of similar items are then arranged in a manner that summarises the patterns and clusters in the data set the som is resilient to high levels of missing data and is therefore a popular choice for analysing environmental data which is commonly afflicted by technical issues and the difficulty of obtaining regular measurements in the field the som network is trained through an iterative process of fitting a grid of connected nodes over a high dimensional data cloud comparing the individual data items to the map nodes and repeatedly updating the location of the nodes nearer to the data items until the best representation of the data distribution by the map is found before training begins a map consisting of m nodes connected in a rectangular grid mesh is created with a vector m j where j 1 m associated with each node this vector is of the same dimension d as the input data and represents the location of the map node in data space the component values of these map vectors are scalar weights that are adjusted through network training the map is initialised over the data set usually with the edges of the map aligned with the first two principal components of the data in the first step of the iterative training each input item x i is compared to all map units m j by a usually euclidean distance measure the closest map node is found and is given the index c where x i m c min j x i m j kohonen 1990 during each training iteration the input data become allocated into subsets consisting of data items sharing the same nearest map node m c the locations of the map nodes are then adjusted closer to the data items in their subsets a neighbourhood region is specified around each map node with the application of a neighbourhood kernel that defines the region of influence of data items matched to that node the location of all map nodes within the neighbourhood are updated to become closer to that data item inclusion of the neighbours in the updating process maintains the smoothness of the map the radius of the neighbourhood kernel decreases with each training iteration to include fewer neighbouring nodes the map is then presented in low dimensional space with each data item attributed to a node of the map forming clusters the set of clusters is organised on the output map with similar patterns closer to each other and dissimilar ones further apart for more details of the som see kohonen 2013 and for applications to water resources see clark et al 2020 5 1 2 experimental setup som in this study the som is trained on monthly average groundwater levels from the individual wells between january 1974 and december 2018 giving time series of 540 months the matrix structure of input for the model takes the form where each time series is a data item and each month of the study period is a variable there are 165 wells included in the som analysis all of which have measurements for at least 164 months 30 of the study period due to the som algorithm s resilience to high levels of missing data wells have been included that have up to 70 missing data during each iteration of som training the time series are compared with the prevalent patterns represented by the map nodes where a well is missing data for a certain month that month is not included in the comparison for that well only though many wells have recorded data beginning only in the mid 1980 s these wells can still therefore be included in the modelling with wells that have data back to the 1970 s in order to allow comparisons between wells that are at different elevations and accessing aquifers with unknown spatial extents and volumes water level measurements are scaled into a uniform range each well time series is scaled to the range 0 1 with the lowest measurement in each time series becoming 0 and the highest becoming 1 as only water levels and not volumes are of concern in this study scaling provides no loss of information the absolute water levels themselves could not be directly compared without knowledge of the horizontal extent of the aquifers and local hydraulic conditions the som is set up with 16 nodes in a 4x4 hexagonal grid the map size is determined by trial and error to extract a manageable number of patterns that are sufficiently distinct from each other the weights are randomly initialised the som is run with training length 400 a learning rate of 0 05 reducing to 0 01 and a neighbourhood radius of 2 3 of the map size decreasing to zero over the training epochs because the algorithm is unsupervised only the well water level data is used at this point without inclusion of climate and extraction data the resulting clusters represent wells that have similar temporal responses to the regional environmental and anthropogenic conditions even though these have not yet been specified for example wells that are geographically close to each other could possibly respond differently to rainfall or nearby extractions due to local variations in hydraulic conductivity the presence of faults or the depth of access to the aquifer and these wells would therefore be allocated to different groups this results in the identification of clusters or subsets of time series that have similar response behaviour to environmental forcings enhancing the information available from individual time series a representative time series is attributed to each cluster best characterising the main time series patterns of the member wells 5 2 supervised learning for prediction 5 2 1 lstm background the lstm hochreiter and schmidhuber 1997 a deep learning algorithm specifically for time series analysis is an updated form of the recurrent neural network that allows for much longer time series to be analysed the lstm looks back over a time series for a specified amount of time cycling sequentially through the observations and retaining important information through time memory and cell gates enable the network to choose which information is important to retain and which information can be forgotten external forcing data can be incorporated and multi scale temporal dependencies can be determined the lstm is quickly gaining popularity in hydrologic analyses due to its efficiency in producing accurate predictions through the learning of short and long term temporal patterns and complex intervariable relationships and it is therefore highly suitable for use in this time series analysis involving long term complicated interactions with exogenous predictors the lstm algorithm however does not perform well with such high proportions of missing data as are found in this data set the irregular temporal spacing of the groundwater level measurements leads to the appearance of missing data since a measurement is not recorded for each time step when this data is set in a matrix alongside the regularly recorded predictor data there are many time steps missing between the water level measurements the current best practice for this issue with lstms is to either infill the missing values or delete the rows that contain missing values however this also deletes the predictor variables for those days and these are needed to predict water levels at future times gathering these time series into groups and pooling the measurement information to provide fuller time series allows the use of the lstm on this data the irregular measurement intervals for data collected from a single well also become an obstacle when combining data from multiple wells each of which are measured at different times and frequencies hence the use of the som which is unaffected by missing data to prepare input for the lstms 5 2 2 experimental setup lstm a separate lstm is created for each cluster of similar time series as determined by the som the variables used for prediction are monthly averages of rainfall and evapotranspiration from the climate stations river flows and dam outflows available extraction data from irrigation wells in the upper and lower namoi regions and a variable to indicate month of the year the representative time series from the clusters provide non missing response variables for the lstms the lstm models produce separate predictions for each cluster based on the environmental and pumping forcings during training the lstm algorithm looks back over the data for a specified amount of time steps cycling sequentially through the observations and retaining important information through time the lstms have been run with a variety of possible look back lengths 3 6 8 10 and 12 months and the model providing the best over all match of model output with each cluster s representative time series based on mean squared error mse is chosen the first 80 of data is used for training the lstms the next 10 for validation and the final 10 is reserved for testing from the monthly data set 1974 2018 this equates to approximately 36 years for training 4 5 years for validation and 4 5 years for testing a 2 layer network is used with 50 nodes on the first hidden layer and 25 nodes on the second batch size or the number of data items shown to the model at each time between model updates is 32 the lstm is run with adam optimization to reduce overfitting a weight decay parameter lambda 0 00001 is used during training to regularise the weight estimates by emphasizing a preference for smaller weights as described in goodfellow et al 2016 each model is run for up to 500 epochs and is stopped early if the prediction on the validation set fails to improve over 20 consecutive epochs 6 results 6 1 clustering and visualisation of temporal patterns the som has been used to identify the temporal water level patterns that occur most often amongst the time series the subset of wells that best match each of these patterns has been determined producing groups of wells that share similar water level dynamics across the time period of the study som model setup and training is described in section 5 fig 5 shows the som results in the form of an output map sixteen grey patterns of monthly water levels can be seen which comprise the set of representative time series one for each of the identified clusters of wells these represent the sixteen most prevalent temporal patterns determined to exist in the data the patterns are ordered on the map to indicate the level of similarity between the clusters with more similar patterns near to each other and dissimilarity increasing with map distance coloured smoothers have been added to indicate the overall temporal pattern of each cluster it can be seen that the purple and dark blue patterns in the upper left indicate water levels decreasing over time the green patterns in the middle descend but then start to even out or slightly increase the yellowish green in the lower right has relatively constant water levels and the yellow pattern in the lower left indicates water levels that have been predominantly increasing over time each individual well time series has been matched to the pattern that it fits best assuming a horizontal numbering system starting with node or cluster 1 in the top left a closer look can be taken at the time series that match each node in fig 6 on the right hand side we can see the list of wells and their recorded data for a selection of the som clusters at node 1 there is a group of 9 wells with water levels that are decreasing steadily over time water levels in node 12 are also generally decreasing for this group of 11 wells and annual drawdowns are significantly increasing in depth around the middle of the study period at node 13 there are 10 wells with generally increasing water levels and similar multi year fluctuations some attributes of the predominant groundwater level patterns in the region can be inferred from the coloured smoother lines except for node 13 all of the nodes had declining trends during the period 1974 2000 with a variety of concavities the nodes in the very top right continue to decline at the same or greater rate until 2018 others have a less steep decline or an upward trend after the mid 2000s interestingly when other nodes start to increase around this time the upward trend in water levels in node 13 slows down the nodes with greenish smoothers in the lower centre seem to have the must noticeable recent increases in water level nodes 3 and 4 show the least response to events of the mid 2000 s which include the roll out of the water sharing plan 6 2 spatiotemporal visualisation after clustering is complete the wells can be visualised in a type of geographical temporal space including the clustering information as colour fig 7 shows water level time series for the deep aquifer wells arranged on map coordinates and represented as columns in a data vase plot the base of the columns represent january 1974 and the tops december 2018 with the width of the column at any time corresponding to the average monthly water level in that well at that time column widths change as water levels rise and fall over time with narrower points in the columns indicating months when water levels were low the columns are coloured corresponding to the pattern that each well is associated with in fig 5 from this view it can be seen that physical proximity has little bearing on the individual water level patterns measured in each well fig 8 shows the data vase plots for wells in the deep aquifer of the upper namoi region only it can be seen how the well time series as represented by the columns are related to the som patterns from which they take their colour for example the yellow data vase circled on the left starts narrow at the bottom and steadily expands corresponding to the yellow trend line in node 13 showing a water level that steadily increases from its 1974 level by contrast the purple data vase on the right starts wide and steadily narrows corresponding to the monotonically decreasing water level indicated by the trendline in node 1 the green data vase near the centre represents water levels that initially decrease and then start to rise again visualisation of the cluster membership of each well is further extended onto a geographic map of the namoi valley in fig 9 this figure shows the location and cluster membership of the deep aquifer wells in both the upper and lower namoi regions note that the columns in fig 8 represent only the upper namoi wells located between quirindi and narrabri on this map and the remainder of the wells between narrabri and walgett belong to the lower namoi region the legend provides a reminder of the general temporal groundwater level pattern for each cluster as well as a visual insight into the historic patterns of groundwater levels in the region the som provides the pattern information that will be used in the next step of supervised modelling and prediction models created with the representative time series from each node the grey dots in fig 5 will be used to simulate the processes for each group of wells as these representative time series consist of evenly spaced observations from the som output it is now possible to analyse them in a supervised setting with the lstm algorithm which could not be used on the individual time series due to the nature of the sporadically measured time series 6 3 lstm prediction for subsets of time series predictors of rainfall evapotranspiration surface flow and extractions are now added into the analysis to investigate predictor response relationships of the groundwater levels to external conditions the representative time series of each cluster representing the general temporal patterns of the wells in that group becomes the response variable to this set of predictors a separate lstm is created for each of the 16 clusters predicting groundwater levels for each cluster in response to the set of external predictors model setup and training is described in section5 following a working example of one cluster 15 the upper panel of fig 10 indicates the representative time series for node 15 in grey on the som map fig 10a shows this time series overlaid with water level measurement data from the individual wells associated to this node with measurements coloured by well on fig 10b the lstm prediction is added in red for this cluster the lstm with the lowest error mse 0 023 used 10 months of previous rainfall evapotranspiration surface flow and extraction data to predict the groundwater levels ie lookback length 10 the lstm predictions for each of the 16 clusters with the lookback length producing the lowest error are given in the appendix after training the lstms on the representative time series of the clusters the predictions can be compared to the measurements from the individual wells in fig 11 it can be seen how the lstm prediction again shown for node 15 generally tracks the infrequent measurements of cluster 15 wells for example in fig 11a measurement points for a single well well gw030421 2 are overlaid as blue dots this well is an un telemetered station in the upper namoi region well gw036377 2 in the lower namoi region is also a member of cluster 15 and in fig 11b we see that the node 15 lstm cluster prediction also generally follows the data points green dots for this well even though the measured data here are quite different to the measurements from well gw030421 2 though the wells in fig 11 are located in different aquifers and even in different parts of the namoi region the same lstm prediction can be applied to both since these wells share similar temporal patterns as identified by the som the method used here has led to the creation of a set of 16 general models that can efficiently predict time series in different wells throughout the region once it has been established that the groundwater levels at each well respond similarly to the climate and pumping conditions of the area it has reduced the complexity of the original 165 time series into 16 specific patterns that can then be modelled with the lstm algorithm 7 discussion it is of particular interest to draw new developments in machine learning towards the study of australia s groundwater systems neural networks recently in the form of deep learning algorithms are becoming increasingly popular globally in groundwater research where efficient accurate hydrological predictions are of more importance than understanding the physical processes underlying the data or when detailed system knowledge and data requirements for traditional mathematical models are too costly understanding of the physical groundwater system in the namoi region is still incomplete despite the large number of investigations that have been undertaken welsh et al 2014 kelly et al 2014 this is not a regional phenomenon csiro 2011 states the full potential of groundwater in australia as a whole is unknown as groundwater systems are generally poorly understood and the complex interactions are difficult to detect with such uncertainty pervading the groundwater knowledge base machine learning methods provide a means to explore groundwater patterns and relationships and to deliver predictions without requiring too many assumptions about the subsurface system the workflow here expands knowledge of regional groundwater patterns without a comprehensive understanding of the underlying hydrogeology of the namoi region and with relatively sparse measurements at each well through the building of models that represent clusters of temporally related time series the lstm algorithm which prefers larger fuller data sets than are available in this case was able to be effectively employed there were two main keys to this analysis clustering the wells based on their historic time series rather than their proximity was the first one as hydraulic connectivity characteristics and subsurface discontinuities can produce poor correlations between nearby wells a fact also noted by vu et al 2020 making traditional spatial modelling techniques inapplicable the second key was incorporating the idea of pooling multiple time series into global or partitioned neural network models to create fuller data sets and share regional pattern information the best set of predictors for determining groundwater levels in any region remains unknown and each study in the literature reports a different set of predictor variables as neural networks perform feature engineering as part of the training process it is common practise to input a large number of predictor variables and let the model determine the importance of each and the relationships between them huang et al 2019 found that including numerous predictors that had low correlation with the groundwater levels had little influence on lstm prediction performance this technique has been used here to some extent inputting rainfall and evaporation data from all of the local climate stations surface flow measurements from a selection of gauges distributed throughout the region as well as available extraction data at a representative selection of extraction wells however as the entire set of pumping information from all wells in the region was not available it is possible that individual wells may be responding to local extractions that are not captured in this predictor set model hyperparameters for the lstms such as network size and batchsize have been chosen based on an improvement in the set of model representations for all clusters using the prediction mse averaged over the clusters however the lookback length has been defined specifically for each cluster the reason that lookback length has been given closer consideration is to improve the efficiency of the models by allowing each to use the largest possible length of data for training the amount of lagged input data or lookback length to include in a recurrent network is an open question and is difficult to specify for a given region hocking and kelly 2016 studied wells in a deep aquifer in queensland australia and found the response time of groundwater levels to rainfall ranged from about 6 months to 48 years in some areas the groundwater response time could be in the order of centuries or millennia csiro 2011 to strike a balance between ensuring all portions of an annual cycle of rainfall and extractions could be included and trying to maintain the most possible data for use in training up to 12 months of lookback has been allowed for in each model a sensitivity analysis indicates that some of the cluster predictions may be improved if the annual extractions are assumed to occur in the summer months only which may reflect the reality of more pumping activity during the dry months this did not improve all cluster predictions though and for the sake of uniformity and because there is no real information on the monthly distribution of extractions the annual extraction data has been allocated evenly throughout the year in these models some clusters also performed better without the month of year variable which has been included to accentuate seasonality though most performed best when it is included this method has been effective in broadening our understanding of the regional namoi groundwater patterns though it encounters a couple of limitations that are specific to this application these limitations are highlighted here in order to draw attention to the important message that as always the modelling must be viewed in light of the data that goes into it and that it is important in the namoi region that higher resolution extraction data is collected in the future until this is available the existing data must be used the first limitation specific to this application is due to the lstm data split coinciding with natural changes in this set of water level time series neural networks require the data set to be split into training validation and testing subsets and for time series applications it makes sense that these sets should be comprised of blocks of sequential time points in the case of the namoi basin data many of the wells display strong temporal trends where the patterns in recent years are quite different than those seen in the 1970s and 80s in fig 5 it was noted that a lessening or reversal of the downward trend was often seen between 2005 and 2010 which is where the training data ends and the validation data begins in this case when the earlier years are used to train the model it becomes challenging for the model to produce good predictions for later years since the conditions no longer resemble those at the beginning this is why the predictions for some of the clusters in the appendix are seen to be underestimating water levels in the latter years the second and largest limitation with regards to the namoi data is the uncertainty and resolution of the recorded extraction data extractions are recorded as annual lump sums not providing enough information to relate shorter duration changes in groundwater levels to specific extraction events they are conspicuously coarse when considered next to the plethora of publicly available daily data on climate conditions the extraction data begins in 1985 though pumping started in the namoi region in 1966 meaning that roughly the first half of the training data in this study is incorrectly training the model on groundwater responses to conditions without pumping when pumping was in fact occurring additionally looking at the extraction plot in fig 4 it is unknown if the large reduction in extraction volumes evident at all wells around 1997 is a real result of restricted extractions or an artifact of a change in reporting structure csiro 2011 note that extractions in australia are rarely metered and it is estimated that unlicensed pumping accounts for a further 20 of extracted volumes in this study it has been assumed that the relative magnitude of the unmeasured extractions fluctuates similarly with the measured data though the locations of unmeasured extractions are of course unknown the annual resolution of the extraction data the assumption of no extractions before the mid 1980 s and the potentially large portion of unmeasured extractions make the extraction data a significant limitation to this study flagging the opportunity for producing better predictions by improving the reporting of regional extractions in the future challenges with predicting future groundwater levels are encountered regardless of the method used the relationships between the system components do not necessarily hold constant over time or space changing climate growing populations land use change and updated farming and irrigation practices will vary the amount and timing of groundwater extractions meixner et al 2016 changes in precipitation patterns may affect the rate of groundwater recharge differently depending on local land use and soil characteristics green et al 2011 the effects that these shifting conditions have on the system make predictions of future groundwater levels challenging for any model trained on past conditions 8 conclusion a method has been developed for data driven temporal and visual analysis of multiple groundwater level monitoring data sets in a hydrologically stressed region of australia where the complex and not comprehensively defined hydrogeological processes make traditional spatiotemporal or physically based models difficult to apply the combination of unsupervised and supervised learning used in this study allows for predictions to be made on patterns that are abstracted from the set of time series without requiring prior assumptions about the physical system or the temporal pattern structure though the individual groundwater monitoring time series in the namoi basin were found to be too sporadic to effectively model with the lstm algorithm separately by sharing information between select multiple time series with similar historic temporal patterns partitioned lstms were shown to successfully represent the prevalent patterns in the data set and could be used to make predictions on the individual time series this method of combining the sporadic time series from multiple bores to facilitate the use of data driven time series models may prove useful in any region of the world where groundwater management is needed but detailed hydrogeologic knowledge is sparse the workflow described here expands the potential application of the lstm deep recurrent neural network algorithm on environmental monitoring data sets from the current common use on individual time series to sets of related time series tracking current advances in the machine learning field for multiple time series analysis with neural networks and also provides a visual analysis with the som as the sets are created these two aspects of the study augment the lstm application into the spatiotemporal realm by carefully merging related information from multiple time series with the som before modelling each subset with the lstm 1 the complexity of the set of diverse time series is reduced into a small set of specific patterns 2 issues of intermittent environmental monitoring measurements and small datasets are overcome and 3 the sharing of pattern information across the system is enhanced visual analytics an important tool to support water practitioners in the decision making process is an integral part of the som use in this workflow allowing an exploration and comparison of the spatial and temporal variations in the historic groundwater dynamics of the region this process facilitates the use of advanced machine learning methods on data that otherwise would not support the use of these models due to the nature of the individual time series expands knowledge of the namoi hydrogeologic system through visual analytics and introduces a spatiotemporal aspect to the lstm analysis the understanding of the historic spatial and temporal patterns provided through visualisations combined with the set of deep learning groundwater level predictions provide an awareness of regional patterns that can be drawn upon to support groundwater management decisions many gaps still exist in the understanding of australia s hydrogeological systems making data driven models a good alternative to physically based models for providing inexpensive predictions without requiring extensive subsurface investigations and this study highlights that the benefits of turning to neural networks in groundwater analyses have the potential to continually expand if we persist in actively adopting ideas as they emerge in the machine learning literature adapting them as necessary to fit the characteristics specific to environmental data future work may include exploring various granularities of partitioning the set of time series before applying the lstm comparing the predictions from smaller subsets up to a single lstm on the entire set to determine if there is an optimal partitioning in terms of generalisation ability and prediction accuracy declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements dr stephanie clark is supported by the australian research council through the australian centre of excellence in mathematical and statistical frontiers acems ce140100049 the author is grateful to professor louise ryan for providing statistical advice and comments on the manuscript and to the nsw department of planning industry and environment dpie for introducing this interesting problem and partially supporting this work appendix lstm predictions for all clusters 
25637,understanding the sustainability of current groundwater extractions is critical in the face of changing climate and anthropogenic conditions but this proves challenging in areas with complex and not well understood hydrogeology a combination of unsupervised self organizing map som and supervised long short term memory lstm models is demonstrated here to effectively abstract prevalent patterns from a diverse set of groundwater monitoring time series in the dry and hydrogeologically complicated namoi region enabling predictions of water levels based on climate and anthropogenic conditions to be made using a set of regional deep learning based neural networks by drawing on shared pattern information from across the namoi system the som reduces the complexity of the multiple time series shares information between sparse time series which could not be modelled with the lstm individually adds a spatial aspect to the lstm analysis and provides a valuable visual analysis that enhances communication and decision making keywords hydrology multiple time series lstm visualisation clustering machine learning water resources som 1 introduction the recurrent extraction of groundwater from any region requires careful consideration and management and this is especially true for regions already experiencing hydrological stress from a changing climate and increasing anthropological influences understanding patterns of historic groundwater levels and responses to external pressures in these areas is necessary in order to ensure that groundwater management decisions will lead to a sustainable future the namoi river valley to the west of the great dividing range of eastern australia is one such region complex hydrogeological relationships exist here due to a naturally dry climate combined with hydrologically intense agricultural requirements the namoi system has been steadily drawn upon for decades to provide significant volumes of groundwater for agricultural use with amongst the highest levels of groundwater extraction in the murray darling basin one of australia s largest agricultural regions csiro 2011 rassam et al 2013 welsh et al 2014 rainfall in much of the area is overshadowed by potential evapotranspiration resulting in little rainfall recharge to replenish the aquifers substantial interest exists therefore in examining the response of local groundwater levels to climate and pumping with an understanding that current rates of extraction in this already dry region may not be sustainable under a changing climate although groundwater monitoring and modelling in this area is critical in order to understand patterns of water level fluctuations and to predict likely responses to future conditions the tasks of monitoring and modelling are not straightforward in this region for a number of reasons firstly available groundwater monitoring data and extraction records contain substantial gaps though a comprehensive monitoring network spans the region with groundwater levels recorded at hundreds of wells as with any field data collected manually the time series from these wells are characterised by differing record lengths and sporadic measurements in the namoi region gaps of up to 2 or 3 months intersperse the water level measurements at each location though the network has good spatial coverage the irregular temporal resolution suggests that peaks and troughs of aquifer levels may be missed from the records furthermore data on groundwater extraction volumes is available only in annual sums limiting the ability to determine short term groundwater responses to local pumping secondly a complete understanding of the subsurface hydrogeological system is not available though not comprehensively defined it is known to consist of multiple semi connected aquifers and the response of groundwater levels in these aquifers to the changing external influences is complex a straightforward relationship between rainfall and groundwater levels does not exist as might be found in less stressed systems rainfall evapotranspiration surface groundwater interactions and anthropogenic pressures through pumping and dam releases each affect the system in nonlinear ways added to this the namoi groundwater levels do not follow clear spatiotemporal patterns due to the distribution of the multiple aquifers subsurface discontinuities variations in hydraulic conductivity proximity to surface water bodies and the proliferation of pumping wells these factors make traditional physically based models difficult to employ without requiring numerous assumptions or extensive time consuming and expensive supplementary subsurface data collection to be made though the sustainable management of this groundwater resource requires an understanding of the spatiotemporal water level patterns and responses to external stresses to enable informed decision making about groundwater extractions the limited understanding of the subsurface conditions and lack of detailed water level data and extraction volumes leads to uncertainty about how factors such as rainfall and pumping may be influencing the water levels in this area acknowledging this difficulty in understanding the complicated subsurface interactions in the namoi region a method has been sought to simplify and represent this complexity regardless of the limitations of the data a benefit of groundwater monitoring data from a spatial network is that whilst the individual time series may be sporadic there exists a set of many time series covering the spatial area the namoi network consists of a rich set of time series each of which contains pattern information that may relate to patterns elsewhere in the monitoring network by combining these multiple time series in a data driven analysis the opportunity for understanding and predicting the predominant regional groundwater patterns exists without requiring a complete knowledge of the physical hydrogeological system neural network modelling of groundwater time series traditionally involves individual wells and does not always account for temporal correlations in the data as individual groundwater time series usually do not provide large data sets innovative methods such as the long shortterm memory algorithm lstm hochreiter and schmidhuber 1997 a modern deep learning algorithm specifically for time series are often inaccessible for their analysis therefore there is room for advancement of the application of machine learning methods to form a spatial analysis of multiple groundwater time series fortunately the regional namoi monitoring network consists of multiple wells with relatively concurrent time series recorded over many decades a fact that can be exploited following contemporary machine learning developments current research in the field of machine learning is supporting the merging of many simultaneous time series building models incorporating information from groups of time series to produce predictions on individual time series this enables the sharing of pattern information between the time series whilst also increasing the size of the dataset and improving prediction performance bandara et al 2020 montero manso and hyndman 2020 salinas et al 2020 by training a single or global model on a data set representing all of the time series combined the essential theory is that the time series result from similar but not identical processes and merging them allows information to be revealed that may be common across the system rather than assuming each time series comes from a different data generating process long memory patterns and complex relationships can be learned by these global models and this cross system information is then drawn upon to make predictions on the individual time series a partitioned model follows the same theory as a global model but is trained on a subset of the time series rather than the entire set 1 1 study description in this study a workflow blending unsupervised learning and deep learning shares information across multiple time series in the region enabling an understanding of regional groundwater patterns and leading to efficient data driven predictions no hydrogeological input or assumptions are required and the sporadic nature of the time series is circumvented prominent temporal patterns that are common amongst subsets of the time series are discovered and this shared information is drawn upon to facilitate predictions at each individual measurement location the first step of this workflow involves making sense of the substantial spatiotemporal variation in the groundwater level measurements after this the relationships between groundwater levels climate and anthropogenic influences are modelled using the self organizing map som kohonen 1990 an unsupervised learning method for data reduction and visualisation the main temporal patterns amongst the time series are extracted clusters of monitoring wells with similar concurrent time series patterns are determined irrespective of physical proximity indicating groups of wells that have historically responded in similar ways to the climate and anthropogenic conditions of the time visualisation of the som results provides an easily accessible and important analytic tool to aid in understanding the varied spatiotemporal groundwater patterns in the region the identified prevalent patterns incorporating knowledge from across each subgroup of similar time series are then fed into a set of lstms for supervised modelling based on regional climate and extraction data the set of lstms one for each main temporal pattern are able to produce predictions of groundwater level responses to climate and extraction conditions for the subset of individual time series matching each pattern predictions can then be made with the same lstm for multiple individual groundwater wells in various aquifers in the namoi region regardless of spatial proximity or aquifer as long as it has been determined with the som that the time series respond similarly to local climate and pumping conditions analysis of the complex namoi groundwater system is enabled through the harnessing of information from across the multiple groundwater level time series in the region summarizing the patterns and structures that are common amongst them and determining the relationships that exist between the extracted predominant groundwater patterns and external factors such as climate and pumping the novelty of this study arises from the merging of information from multiple regional time series allowing a blended method of unsupervised and supervised modelling to be used this leads to a thorough exploratory spatiotemporal investigation of groundwater levels in the region followed by predictions of groundwater levels at individual locations the workflow specifically provides visual analytics for understanding and communication of the complex local groundwater patterns and facilitation of a contemporary deep learning method for time series analysis to perform predictions on individual time series that otherwise would not support this algorithm delivering predictions on the groundwater trends of this varied and complex system the method also provides a visual and intuitive representation of the spatial and temporal variations of regional groundwater levels the resulting understanding of the historic patterns combined with the set of deep learning groundwater level predictions lead to an awareness of the regional patterns that can be drawn upon to support groundwater management decisions 2 related work neural network applications for groundwater analyses have continuously progressed from the use of static neural networks such as multi layer perceptrons mlp eg daliakopoulos et al 2005 to time series based recurrent neural networks rnn eg bowes et al 2019 and most recently the deep learning based long short term memory network lstm eg lee et al 2020 kratzert et al 2018 bowes et al 2019 in which the model determines which information from the past is important to retain over time and which can be forgotten through comparisons on individual groundwater time series studies have shown the lstm to be more effective for predictions than other types of neural networks zhang et al 2018 huang et al 2019 jeong and park 2019 reasons for this are that the mlp which is not designed for temporal data is able to cope with irregularly spaced measurements but is not able to explicitly capture autocorrelation structures and the rnn encounters error propagation issues when applied to longer time series the lstm has gained popularity in recent years in hydrologic modelling due to its ability to make accurate predictions on time series by efficiently learning intervariable relationships and nonlinear temporal patterns there are many reasons why neural networks in general are finding successful applications in the hydrological sciences goodfellow et al 2016 describe how neural networks can easily handle issues such as nonstationarity collinearity and correlations daliakopoulos et al 2005 showed that for groundwater time series with shifts and trends neural networks are able to detect the trends and make predictions even when the prediction data lies beyond the range of the training set shen 2018 describes how deep networks are able to model highly complex functions and spatiotemporal dependencies from large hydrological data sets it has been found that neural networks capture the complex nonlinear behaviour of groundwater and hydrological time series better than traditional statistical methods such as arima autoregressive integrated moving average model and multiple linear regression rajaee et al 2019 zounemat kermani et al 2021 neural networks have also proven successful when compared to physically based models mohanty et al 2013 yin et al 2021 lee et al 2019 describe the benefits of neural networks for analysis of groundwater systems with highly variable anthropogenic influences as they can model complex nonlinear systems with less data requirements than physically based models furthermore nearing et al 2021 highlight how neural networks have the potential to extract more information and insights from expanding hydrological datasets than can be currently accessed with traditional methods and suggest that the field of hydrology would benefit from keeping up with developments in machine learning neural networks have already proven effective in some australian aquifer analyses for example huang et al 2019 predicted a time series of regional annual groundwater recharge in the australian states of south australia and victoria based on an average of multiple wells using both an mlp and lstm finding that the lstm produced better prediction results yu et al 2020 used deep learning models to emulate complex process based groundwater flow and contaminant transport models in south australia and yin et al 2021 investigated the use of lstms with remote sensing input data in victoria with developments coming steadily out of the field of machine learning there is always the potential to ask which of these can be adapted to benefit applications in the field of hydrology one such recent development in machine learning research is the technique of combining multiple time series to form global models allowing patterns that are common across the time series to be determined and then using these models to produce predictions on individual time series montero manso and hyndman 2020 have described how neural network models trained on a group of time series that may or may not be generated by related processes outperform traditional local time series models such as arima and ets error trend seasonality model on the same data sets bandara et al 2020 use an lstm on groups of time series that have been clustered based on the similarity of time series features where the input is the past values of the time series with no exogenous predictors and show that when applied to sets of time series that have been identified to share similar characteristics the lstm outperforms state of the art univariate forecasting methods where individual time series models may suffer from overfitting due to smaller sample sizes the global models will not have this issue and therefore are capable of greater generalisation outside of the data on which they are trained montero manso and hyndman 2020 an extension of autoregressive recurrent neural networks to probabilistic forecasting of multiple time series has been developed by salinas et al 2020 known as the deepar algorithm which is currently proving successful in sales time series forecasting groundwater research is just beginning to see authors using the lstm on groups of time series in innovative ways overall the majority of past applications using lstms to predict groundwater levels have focussed on time series from individual wells eg zhang et al 2018 jeong and park 2019 for studies involving more than one well it is common practice to create a separate neural network for each well eg lee et al 2019 bowes et al 2019 and many studies then connect these results with kriging rajaee et al 2019 however recent interest is growing in incorporating available information from multiple wells in a region vu et al 2020 used lstms to infill and extend groundwater level time series from a group of piezometers in france determining that using multiple highly correlated time series for model training led to better prediction accuracy compared with using the time series from a single well kratzert et al 2018 created a regional lstm model using the combined information from over 240 catchments and then fine tuned the overall model individually by catchment it was found that the individual models which had been initially trained on the overall dataset performed better than models trained solely by individual catchment for a comprehensive review of the intersection of hydrology and contemporary deep learning research see shen 2018 and shen et al 2018 3 study area 3 1 location and hydrologic characteristics the study region comprises the area surrounding the namoi river in northern central west nsw australia see fig 1 the upper and lower namoi reaches refer to the areas southeast of and northwest of narrabri respectively the upper namoi covers approximately 3800 km2 between quirindi and narrabri and the lower namoi encompasses approximately 7600 km2 between narrabri and walgett welsh et al 2014 the topography is dominated by highlands in the south and east and a floodplain in the west with the lowest elevation occurring near walgett in the far northwest the main flow of surface water into the region occurs from the east and southeast via the namoi and peel rivers the namoi river joins with the peel river downstream of keepit dam near tamworth and converges with the mooki river near gunnedah before flowing northwesterly through narrabri and walgett groundwater in the region generally flows from the south and east towards the northwest following the flowpath of the river travelling northward in the upper namoi subregion groundwater flows through a bedrock constriction north of narrabri and into the lower namoi subregion in which it takes on a more westerly course the groundwater monitoring wells generally track this line of flow as shown on fig 1 the far north and western portions of the namoi basin comprise part of australia s great artesian basin system 3 2 anthropogenic and climate influences the main water sources for human use in the namoi region are surface water from the namoi river and its tributaries shallow alluvial groundwater and deep groundwater the rivers and creeks are highly regulated by dams and weirs to meet the water requirements of the population with surface extractions occurring at many points along the waterways as the groundwater system is closely linked to the surface water system these surface extractions significantly affect groundwater levels kelly et al 2013 groundwater extractions are also high with large volumes of groundwater extracted from the deep aquifers for use in agriculture having been significantly influenced by the millennium drought that affected southeast australia from 1997 to 2009 the namoi region was also one of the regions most affected by the 2017 2019 drought the hottest and driest period ever recorded in the murray darling basin by december 2018 keepit dam which regulates the namoi river upstream of the namoi groundwater region was down to 5 of it s full capacity surface area bluedotobservatory 2021 and remained at this level until february 2020 3 2 1 groundwater system and recharge mechanisms the namoi aquifer system has two layers shallow aquifers at approximately 30 40 m in depth and deep aquifers at approximately 40 100 m barrett 2012 these aquifers are separated in some areas by aquitards and connected in other areas though the extent of vertical and horizontal connectivity and inter aquifer water flux is unknown welsh et al 2014 there is also limited understanding of fluxes between surface water and the aquifers kelly et al 2007 hydraulic conductivities are highly variable in this region with the variations being largely undefined though generally increasing with depth lupton et al 2019 the main groundwater recharge mechanism is leakage from the namoi river and other surface water bodies to a lesser extent recharge comes from rainfall irrigation and lateral through flow between aquifers barrett 2012 crosbie 2018 interaction between the surface water and groundwater is facilitated by alluvial deposits along the rivers having a higher conductivity than the underlying rocks holland et al 2019 this connectivity means that the highly regulated river flows influence the groundwater levels through river recharge particularly during dry periods and often maintain fairly consistent groundwater levels csiro 2011 on the other hand the finding that increased groundwater usage in the region corresponds almost entirely to induced leakage from surface water bodies csiro 2011 indicates this connectivity may be causing the groundwater system to appear more resilient to extractions than it actually is amanambu et al 2020 the importance of accounting for these surface and groundwater interactions for modelling in the namoi region was highlighted by rassam et al 2013 in the lower namoi region between narrabri and walgett water is lost to groundwater from pian creek and the namoi river whereas in the upper namoi between boggabri and narrabri the water flux is reversed and the namoi river gains water from the groundwater system barrett 2012 csiro 2011 holland et al 2019 rassam et al 2013 predict the boggabri narrabri reach may change to become predominantly losing water to groundwater if extended drought conditions occur in the future and pumping continues to increase heavy pumping can reverse the natural vertical hydraulic gradients causing a weakening in the upward potential in regions that primarily have groundwater flowing upwards thereby reducing surface water availability the response of groundwater levels to precipitation in this catchment can vary from well to well within the same aquifer due to soil permeability and distance from the recharge area green et al 2011 around narrabri in the centre of the region the potential evaporation is almost 8 fold the amount of rainfall csiro 2011 limiting recharge from rainfall events in the west of the region near walgett timms et al 2012 found there is no significant response of groundwater levels to large rainfall events whereas in the upper namoi groundwater levels show a rapid response to rainfall irrigation in the namoi region returns great volumes of water that have been extracted from the deep aquifers for use in agriculture back into the shallow aquifers this significant flow of water between deep and shallow aquifers is unmeasured a number of faults in the southwest of the region create subsurface hydraulic disconnections and significantly affect the flow of groundwater though the effect is not well understood welsh et al 2014 3 3 complexity of intervariable relationships though groundwater recharge is directly affected by rainfall and evapotranspiration these processes also indirectly affect groundwater withdrawals regulated surface flows and irrigation recharge green et al 2011 meixner et al 2016 whilst dam outflows and therefore surface flows may be increased during periods of low rainfall for water use requirements they may also increase during periods of high rainfall when dam levels are high making the relationship between rainfall and surface water highly nonlinear recharge is a threshold process and soil moisture conditions govern the contribution of rain towards groundwater recharge rain after a dry period will first go towards increasing soil moisture rather than percolating into groundwater and therefore declining precipitation trends may lead to a sharper decline in longterm groundwater recharge meixner et al 2016 on the other hand peaks of extreme precipitation will not be absorbed by already saturated soil and further increases in precipitation will not lead to increased recharge during dry conditions of low rainfall and high evapotranspiration the groundwater level becomes especially sensitive to extraction rates rassam et al 2013 confounding the temporal relationships brought about by periods of drought and changes in pumping regimes a water sharing plan setting environmental flow requirements and extraction limits went into effect in november 2006 barrett 2012 3 4 previous studies recent modelling in the namoi region has mostly been undertaken as part of the australian government s bioregional assessments for proposed coal seam gas and coal mine works eg welsh et al 2014 janardhanan et al 2018 lupton et al 2019 and holland et al 2019 prior to this rassam et al 2013 performed numerical modelling to investigate interactions between surface water and groundwater in the upper namoi region and the influence of groundwater pumping on surface water flows kelly et al 2013 examined the impact of groundwater withdrawals in the namoi region using time series from 458 wells this study investigated multi decadal changes in recovered water levels after each pumping season the influence of streamflow on recharge and compared groundwater levels to groundwater extractions between 1988 and 2008 the largest decline in recovered groundwater level at an individual well was found to be 14 5 m and the largest increase was 5 5 m with the modal 20 year drawdown in the region being 4 m welsh et al 2014 provide a thorough description of the area including topology hydrogeology climate soil characteristics land cover and water use for more information on the hydrogeology the history of groundwater extractions in the namoi region and the complexities of the recharge mechanisms see kelly et al 2013 4 data hydrologic and climatologic time series used in this study include groundwater levels rainfall evapotranspiration river flows and groundwater extraction volumes the study dates are january 1974 december 2018 4 1 groundwater level data groundwater level data from 165 monitoring wells in the upper and lower namoi alluviums are used in this study this dataset has been provided by the nsw department of planning industry and environment dpie and the data is publicly available for download from the waternsw website web2 fig 2 shows a sample of the groundwater level time series from the upper and lower namoi regions it can be seen that the temporal patterns are similar between some wells and differ greatly between others a glance at these time series quickly reveals strongly changing groundwater level patterns in some wells particularly in recent years these plots also highlight the sporadic measurement frequency and the differing start and end dates of the time series when monitoring sites have been commissioned and decommissioned the 165 time series come from wells at 70 different sites or monitoring locations each site has up to three wells accessing the shallow and deep aquifers at different levels below the surface the upper namoi data comes from 110 wells at 47 sites 47 are shallow and 63 are deep and the lower namoi data comes from 55 wells at 23 sites 18 shallow 37 deep the shallow aquifers are recharged quickly by rainfall and river leakage and the groundwater levels often closely follow precipitation and surface water levels the deeper aquifers take longer to recharge with recharge mechanisms that are difficult to determine whilst losing significant amounts of water to pumping the time series from wells accessing the deep aquifers reflect these complex recharge discharge mechanisms a challenge with these time series is the non constant measurement frequency when measurements started in the late 1960 s observations were performed manually and repeated approximately every 6 weeks by the late 2000 s a limited selection of wells had been installed with automatic telemeters recording groundwater levels on an hourly basis in this study the number of wells with telemetered daily data is small 15 out of the 165 wells all of which are in the upper namoi region the number of measurements at each well over the 45 year study period 1974 2018 range from 17 to 4113 with a median of 253 measurements per well a sample time series for an individual well is shown in fig 3 along with indications of external conditions it can be seen that the water level was relatively steady in the 1970 s and early 80 s and then began to decrease knowing that 1985 1997 was an era of high pumping one might assume pumping to be the cause of the onset of declining water levels during this time but the declining water level continues at a similar rate through the millennium drought of 1997 2009 when climate must be an influencing factor as well in the 2010 s the stabilising of water levels and clearly defined annual fluctuations may be a result of the rollout of the water sharing plan 2006 the end of the drought reductions in pumping or a combination of these influences it is clear from this figure that various external forces may lead to similar groundwater level responses 4 2 climate data the climate in the namoi region ranges from temperate in the southeast around quirindi to subtropical around narrabri to a grasslands biome in the northwest around walgett average annual rainfall varies from greater than 1100 mm year in the southeast to less than 500 mm year in the west welsh et al 2014 average annual actual evapotranspiration is higher in the east and lower in the west varying with land use and aquifer hydraulic conductivity rainfall and evapotranspiration measurements were downloaded at daily resolution from silo web1 silo datasets consist of bureau of meteorology bom data that have been enhanced by the infilling of missing values data from five bom climate measurement stations are used in this study walgett council depot station 52026 narrabri west post office station 53030 gunnedah resource centre station 55024 tamworth 55054 and quirindi post office station 55049 locations are indicated on fig 1 evapotranspiration data is an estimate of the loss of water in the rainfall groundwater system through the mechanisms of evaporation and transpiration the data used here comes from the silo evapotranspiration variable penman monteith reference evapotranspiration fao56 which is a measure of the potential evapotranspiration that would occur if unlimited soil water were available rainfall and evapotranspiration data for a sample year are shown in fig 4 a and c it can be seen that the daily rainfall differs quite noticeably between these climate stations whereas the evapotranspiration measurements follow more similar patterns 4 3 surface flow data river flow data mean daily discharge rate 1974 2018 were downloaded from the waternsw website web2 for the following streamflow gauges on the namoi river goangra station 419026 upstream of walgett mollee station 419039 downstream of mollee weir between narrabri and weewaa downstream of keepit dam station 419007 the peel river at carroll gap station 419006 and the mooki river at breeza station 419027 the station locations are shown on fig 1 fig 4b showing river dischage data for a sample year suggests that patterns of surface flows are complicated and reflect a combination of natural phenomena and human interventions it can be seen that in the summer months of jan mar the river level at 419039 downstream of the dam follows the dam releases relatively closely whereas the other river levels are unrelated however during the big rains at the beginning of april which we can see in fig 4a occur mostly in the west of the region around walgett release from the dam effectively closes off and there is a spike in streamflow at 419026 in the west the high rains at the end of the year on the other hand fall more evenly over the entire region and so while there is again no outflow from the dam during this period flow increases in all reaches as they naturally follow the rainfall patterns 4 4 extraction data groundwater extraction data were provided by dpie in the form of annual extraction volumes ml year at locations specified by latitude and longitude for 59 extraction wells 42 in the upper namoi region and 17 in the lower namoi region fig 4d shows the recorded annual extraction data for this selection of pumping wells the provided extraction records begin in 1985 for lower namoi and 1986 for upper namoi though pumping began in the namoi catchment in 1966 kelly et al 2013 for this analysis we have assumed zero annual extractions to have occurred at all stations prior to 1985 due to a lack of information however this is a large approximation to use in the modelling as it overlooks many years of pumping from fig 4d there appears to have been a significant reduction in pumping starting in the late 1990 s the extraction wells included in this study are not the full set in the region other wells in the region may be influencing groundwater levels significantly though we do not have data for them the extraction wells included in this study were provided due to their proximity to monitoring wells therefore the locations of the monitoring and extraction wells are closely matched according to welsh et al 2014 there are in fact more than 18 000 licensed extraction wells in the namoi river basin another challenge with the extraction data is that it is available only at an annual resolution making it difficult to pair this data with the daily data available for other variables to integrate the annual extraction data into the modelling monthly extraction levels have been set as proportional to the annual levels and attributed evenly throughout the year 4 5 software and data availability analyses for this study were performed in r version 3 6 3 r core team 2013 with packages keras for lstm modelling chollet et al 2017 and kohonen for self organizing map modelling wehrens et al 2007 groundwater level data and river discharge data are publicly available for download from waternsw web2 rainfall and evapotranspiration measurements are publicly available for download from silo web1 groundwater extraction data were provided by dpie in the form of annual extraction volumes ml year 5 methods to analyse this intermittent and varied set of groundwater time series and the concurrent time series for rainfall evapotranspiration surface water and extractions a combination of unsupervised and supervised learning is used unsupervised learning is useful for finding relationships between a set of given data items to determine existing patterns without knowing in advance what to look for it does not require both predictor and response variables lecun et al 2015 supervised learning on the other hand is the process of matching predictor variables with measured outcomes in order to learn input output relationships a supervised model is trained on a set of data for which the outcomes are known and the trained model is then used to predict outcomes for a set of previously unseen conditions a data reduction step is first used to make sense of the spatiotemporal characteristics of the groundwater level data by extracting patterns and determining similarities amongst the time series the individual time series become apportioned into meaningful groups in which the responses to external forces are related for the members of each group only after the data is reduced to this manageable set of patterns can the relationships between these patterns and the external factors be analysed predictive modelling is then performed on a representative time series from each group that best characterises the temporal patterns of the group s members in order to determine how each pattern relates to external conditions this two stage process is summarised as follows 1 unsupervised clustering is conducted with the self organizing map algorithm som relationships between the individual well time series are explored and the wells are separated into clusters in which there is evidence of similar temporal behaviour this stage only uses groundwater level data 2 a supervised deep learning network specifically for time series analysis the long shortterm memory network lstm is applied to each cluster the nonlinear relationships between the groundwater levels and the influencing factors of rainfall surface flow evapotranspiration and extractions are modelled 5 1 unsupervised learning for clustering 5 1 1 som background the self organizing map som kohonen 1990 is an unsupervised learning algorithm from the family of neural networks that is used for pattern extraction clustering dimension reduction and data visualisation with the som prevalent patterns in the data set are identified and each data item is allocated to its best match amongst these patterns these clusters of similar items are then arranged in a manner that summarises the patterns and clusters in the data set the som is resilient to high levels of missing data and is therefore a popular choice for analysing environmental data which is commonly afflicted by technical issues and the difficulty of obtaining regular measurements in the field the som network is trained through an iterative process of fitting a grid of connected nodes over a high dimensional data cloud comparing the individual data items to the map nodes and repeatedly updating the location of the nodes nearer to the data items until the best representation of the data distribution by the map is found before training begins a map consisting of m nodes connected in a rectangular grid mesh is created with a vector m j where j 1 m associated with each node this vector is of the same dimension d as the input data and represents the location of the map node in data space the component values of these map vectors are scalar weights that are adjusted through network training the map is initialised over the data set usually with the edges of the map aligned with the first two principal components of the data in the first step of the iterative training each input item x i is compared to all map units m j by a usually euclidean distance measure the closest map node is found and is given the index c where x i m c min j x i m j kohonen 1990 during each training iteration the input data become allocated into subsets consisting of data items sharing the same nearest map node m c the locations of the map nodes are then adjusted closer to the data items in their subsets a neighbourhood region is specified around each map node with the application of a neighbourhood kernel that defines the region of influence of data items matched to that node the location of all map nodes within the neighbourhood are updated to become closer to that data item inclusion of the neighbours in the updating process maintains the smoothness of the map the radius of the neighbourhood kernel decreases with each training iteration to include fewer neighbouring nodes the map is then presented in low dimensional space with each data item attributed to a node of the map forming clusters the set of clusters is organised on the output map with similar patterns closer to each other and dissimilar ones further apart for more details of the som see kohonen 2013 and for applications to water resources see clark et al 2020 5 1 2 experimental setup som in this study the som is trained on monthly average groundwater levels from the individual wells between january 1974 and december 2018 giving time series of 540 months the matrix structure of input for the model takes the form where each time series is a data item and each month of the study period is a variable there are 165 wells included in the som analysis all of which have measurements for at least 164 months 30 of the study period due to the som algorithm s resilience to high levels of missing data wells have been included that have up to 70 missing data during each iteration of som training the time series are compared with the prevalent patterns represented by the map nodes where a well is missing data for a certain month that month is not included in the comparison for that well only though many wells have recorded data beginning only in the mid 1980 s these wells can still therefore be included in the modelling with wells that have data back to the 1970 s in order to allow comparisons between wells that are at different elevations and accessing aquifers with unknown spatial extents and volumes water level measurements are scaled into a uniform range each well time series is scaled to the range 0 1 with the lowest measurement in each time series becoming 0 and the highest becoming 1 as only water levels and not volumes are of concern in this study scaling provides no loss of information the absolute water levels themselves could not be directly compared without knowledge of the horizontal extent of the aquifers and local hydraulic conditions the som is set up with 16 nodes in a 4x4 hexagonal grid the map size is determined by trial and error to extract a manageable number of patterns that are sufficiently distinct from each other the weights are randomly initialised the som is run with training length 400 a learning rate of 0 05 reducing to 0 01 and a neighbourhood radius of 2 3 of the map size decreasing to zero over the training epochs because the algorithm is unsupervised only the well water level data is used at this point without inclusion of climate and extraction data the resulting clusters represent wells that have similar temporal responses to the regional environmental and anthropogenic conditions even though these have not yet been specified for example wells that are geographically close to each other could possibly respond differently to rainfall or nearby extractions due to local variations in hydraulic conductivity the presence of faults or the depth of access to the aquifer and these wells would therefore be allocated to different groups this results in the identification of clusters or subsets of time series that have similar response behaviour to environmental forcings enhancing the information available from individual time series a representative time series is attributed to each cluster best characterising the main time series patterns of the member wells 5 2 supervised learning for prediction 5 2 1 lstm background the lstm hochreiter and schmidhuber 1997 a deep learning algorithm specifically for time series analysis is an updated form of the recurrent neural network that allows for much longer time series to be analysed the lstm looks back over a time series for a specified amount of time cycling sequentially through the observations and retaining important information through time memory and cell gates enable the network to choose which information is important to retain and which information can be forgotten external forcing data can be incorporated and multi scale temporal dependencies can be determined the lstm is quickly gaining popularity in hydrologic analyses due to its efficiency in producing accurate predictions through the learning of short and long term temporal patterns and complex intervariable relationships and it is therefore highly suitable for use in this time series analysis involving long term complicated interactions with exogenous predictors the lstm algorithm however does not perform well with such high proportions of missing data as are found in this data set the irregular temporal spacing of the groundwater level measurements leads to the appearance of missing data since a measurement is not recorded for each time step when this data is set in a matrix alongside the regularly recorded predictor data there are many time steps missing between the water level measurements the current best practice for this issue with lstms is to either infill the missing values or delete the rows that contain missing values however this also deletes the predictor variables for those days and these are needed to predict water levels at future times gathering these time series into groups and pooling the measurement information to provide fuller time series allows the use of the lstm on this data the irregular measurement intervals for data collected from a single well also become an obstacle when combining data from multiple wells each of which are measured at different times and frequencies hence the use of the som which is unaffected by missing data to prepare input for the lstms 5 2 2 experimental setup lstm a separate lstm is created for each cluster of similar time series as determined by the som the variables used for prediction are monthly averages of rainfall and evapotranspiration from the climate stations river flows and dam outflows available extraction data from irrigation wells in the upper and lower namoi regions and a variable to indicate month of the year the representative time series from the clusters provide non missing response variables for the lstms the lstm models produce separate predictions for each cluster based on the environmental and pumping forcings during training the lstm algorithm looks back over the data for a specified amount of time steps cycling sequentially through the observations and retaining important information through time the lstms have been run with a variety of possible look back lengths 3 6 8 10 and 12 months and the model providing the best over all match of model output with each cluster s representative time series based on mean squared error mse is chosen the first 80 of data is used for training the lstms the next 10 for validation and the final 10 is reserved for testing from the monthly data set 1974 2018 this equates to approximately 36 years for training 4 5 years for validation and 4 5 years for testing a 2 layer network is used with 50 nodes on the first hidden layer and 25 nodes on the second batch size or the number of data items shown to the model at each time between model updates is 32 the lstm is run with adam optimization to reduce overfitting a weight decay parameter lambda 0 00001 is used during training to regularise the weight estimates by emphasizing a preference for smaller weights as described in goodfellow et al 2016 each model is run for up to 500 epochs and is stopped early if the prediction on the validation set fails to improve over 20 consecutive epochs 6 results 6 1 clustering and visualisation of temporal patterns the som has been used to identify the temporal water level patterns that occur most often amongst the time series the subset of wells that best match each of these patterns has been determined producing groups of wells that share similar water level dynamics across the time period of the study som model setup and training is described in section 5 fig 5 shows the som results in the form of an output map sixteen grey patterns of monthly water levels can be seen which comprise the set of representative time series one for each of the identified clusters of wells these represent the sixteen most prevalent temporal patterns determined to exist in the data the patterns are ordered on the map to indicate the level of similarity between the clusters with more similar patterns near to each other and dissimilarity increasing with map distance coloured smoothers have been added to indicate the overall temporal pattern of each cluster it can be seen that the purple and dark blue patterns in the upper left indicate water levels decreasing over time the green patterns in the middle descend but then start to even out or slightly increase the yellowish green in the lower right has relatively constant water levels and the yellow pattern in the lower left indicates water levels that have been predominantly increasing over time each individual well time series has been matched to the pattern that it fits best assuming a horizontal numbering system starting with node or cluster 1 in the top left a closer look can be taken at the time series that match each node in fig 6 on the right hand side we can see the list of wells and their recorded data for a selection of the som clusters at node 1 there is a group of 9 wells with water levels that are decreasing steadily over time water levels in node 12 are also generally decreasing for this group of 11 wells and annual drawdowns are significantly increasing in depth around the middle of the study period at node 13 there are 10 wells with generally increasing water levels and similar multi year fluctuations some attributes of the predominant groundwater level patterns in the region can be inferred from the coloured smoother lines except for node 13 all of the nodes had declining trends during the period 1974 2000 with a variety of concavities the nodes in the very top right continue to decline at the same or greater rate until 2018 others have a less steep decline or an upward trend after the mid 2000s interestingly when other nodes start to increase around this time the upward trend in water levels in node 13 slows down the nodes with greenish smoothers in the lower centre seem to have the must noticeable recent increases in water level nodes 3 and 4 show the least response to events of the mid 2000 s which include the roll out of the water sharing plan 6 2 spatiotemporal visualisation after clustering is complete the wells can be visualised in a type of geographical temporal space including the clustering information as colour fig 7 shows water level time series for the deep aquifer wells arranged on map coordinates and represented as columns in a data vase plot the base of the columns represent january 1974 and the tops december 2018 with the width of the column at any time corresponding to the average monthly water level in that well at that time column widths change as water levels rise and fall over time with narrower points in the columns indicating months when water levels were low the columns are coloured corresponding to the pattern that each well is associated with in fig 5 from this view it can be seen that physical proximity has little bearing on the individual water level patterns measured in each well fig 8 shows the data vase plots for wells in the deep aquifer of the upper namoi region only it can be seen how the well time series as represented by the columns are related to the som patterns from which they take their colour for example the yellow data vase circled on the left starts narrow at the bottom and steadily expands corresponding to the yellow trend line in node 13 showing a water level that steadily increases from its 1974 level by contrast the purple data vase on the right starts wide and steadily narrows corresponding to the monotonically decreasing water level indicated by the trendline in node 1 the green data vase near the centre represents water levels that initially decrease and then start to rise again visualisation of the cluster membership of each well is further extended onto a geographic map of the namoi valley in fig 9 this figure shows the location and cluster membership of the deep aquifer wells in both the upper and lower namoi regions note that the columns in fig 8 represent only the upper namoi wells located between quirindi and narrabri on this map and the remainder of the wells between narrabri and walgett belong to the lower namoi region the legend provides a reminder of the general temporal groundwater level pattern for each cluster as well as a visual insight into the historic patterns of groundwater levels in the region the som provides the pattern information that will be used in the next step of supervised modelling and prediction models created with the representative time series from each node the grey dots in fig 5 will be used to simulate the processes for each group of wells as these representative time series consist of evenly spaced observations from the som output it is now possible to analyse them in a supervised setting with the lstm algorithm which could not be used on the individual time series due to the nature of the sporadically measured time series 6 3 lstm prediction for subsets of time series predictors of rainfall evapotranspiration surface flow and extractions are now added into the analysis to investigate predictor response relationships of the groundwater levels to external conditions the representative time series of each cluster representing the general temporal patterns of the wells in that group becomes the response variable to this set of predictors a separate lstm is created for each of the 16 clusters predicting groundwater levels for each cluster in response to the set of external predictors model setup and training is described in section5 following a working example of one cluster 15 the upper panel of fig 10 indicates the representative time series for node 15 in grey on the som map fig 10a shows this time series overlaid with water level measurement data from the individual wells associated to this node with measurements coloured by well on fig 10b the lstm prediction is added in red for this cluster the lstm with the lowest error mse 0 023 used 10 months of previous rainfall evapotranspiration surface flow and extraction data to predict the groundwater levels ie lookback length 10 the lstm predictions for each of the 16 clusters with the lookback length producing the lowest error are given in the appendix after training the lstms on the representative time series of the clusters the predictions can be compared to the measurements from the individual wells in fig 11 it can be seen how the lstm prediction again shown for node 15 generally tracks the infrequent measurements of cluster 15 wells for example in fig 11a measurement points for a single well well gw030421 2 are overlaid as blue dots this well is an un telemetered station in the upper namoi region well gw036377 2 in the lower namoi region is also a member of cluster 15 and in fig 11b we see that the node 15 lstm cluster prediction also generally follows the data points green dots for this well even though the measured data here are quite different to the measurements from well gw030421 2 though the wells in fig 11 are located in different aquifers and even in different parts of the namoi region the same lstm prediction can be applied to both since these wells share similar temporal patterns as identified by the som the method used here has led to the creation of a set of 16 general models that can efficiently predict time series in different wells throughout the region once it has been established that the groundwater levels at each well respond similarly to the climate and pumping conditions of the area it has reduced the complexity of the original 165 time series into 16 specific patterns that can then be modelled with the lstm algorithm 7 discussion it is of particular interest to draw new developments in machine learning towards the study of australia s groundwater systems neural networks recently in the form of deep learning algorithms are becoming increasingly popular globally in groundwater research where efficient accurate hydrological predictions are of more importance than understanding the physical processes underlying the data or when detailed system knowledge and data requirements for traditional mathematical models are too costly understanding of the physical groundwater system in the namoi region is still incomplete despite the large number of investigations that have been undertaken welsh et al 2014 kelly et al 2014 this is not a regional phenomenon csiro 2011 states the full potential of groundwater in australia as a whole is unknown as groundwater systems are generally poorly understood and the complex interactions are difficult to detect with such uncertainty pervading the groundwater knowledge base machine learning methods provide a means to explore groundwater patterns and relationships and to deliver predictions without requiring too many assumptions about the subsurface system the workflow here expands knowledge of regional groundwater patterns without a comprehensive understanding of the underlying hydrogeology of the namoi region and with relatively sparse measurements at each well through the building of models that represent clusters of temporally related time series the lstm algorithm which prefers larger fuller data sets than are available in this case was able to be effectively employed there were two main keys to this analysis clustering the wells based on their historic time series rather than their proximity was the first one as hydraulic connectivity characteristics and subsurface discontinuities can produce poor correlations between nearby wells a fact also noted by vu et al 2020 making traditional spatial modelling techniques inapplicable the second key was incorporating the idea of pooling multiple time series into global or partitioned neural network models to create fuller data sets and share regional pattern information the best set of predictors for determining groundwater levels in any region remains unknown and each study in the literature reports a different set of predictor variables as neural networks perform feature engineering as part of the training process it is common practise to input a large number of predictor variables and let the model determine the importance of each and the relationships between them huang et al 2019 found that including numerous predictors that had low correlation with the groundwater levels had little influence on lstm prediction performance this technique has been used here to some extent inputting rainfall and evaporation data from all of the local climate stations surface flow measurements from a selection of gauges distributed throughout the region as well as available extraction data at a representative selection of extraction wells however as the entire set of pumping information from all wells in the region was not available it is possible that individual wells may be responding to local extractions that are not captured in this predictor set model hyperparameters for the lstms such as network size and batchsize have been chosen based on an improvement in the set of model representations for all clusters using the prediction mse averaged over the clusters however the lookback length has been defined specifically for each cluster the reason that lookback length has been given closer consideration is to improve the efficiency of the models by allowing each to use the largest possible length of data for training the amount of lagged input data or lookback length to include in a recurrent network is an open question and is difficult to specify for a given region hocking and kelly 2016 studied wells in a deep aquifer in queensland australia and found the response time of groundwater levels to rainfall ranged from about 6 months to 48 years in some areas the groundwater response time could be in the order of centuries or millennia csiro 2011 to strike a balance between ensuring all portions of an annual cycle of rainfall and extractions could be included and trying to maintain the most possible data for use in training up to 12 months of lookback has been allowed for in each model a sensitivity analysis indicates that some of the cluster predictions may be improved if the annual extractions are assumed to occur in the summer months only which may reflect the reality of more pumping activity during the dry months this did not improve all cluster predictions though and for the sake of uniformity and because there is no real information on the monthly distribution of extractions the annual extraction data has been allocated evenly throughout the year in these models some clusters also performed better without the month of year variable which has been included to accentuate seasonality though most performed best when it is included this method has been effective in broadening our understanding of the regional namoi groundwater patterns though it encounters a couple of limitations that are specific to this application these limitations are highlighted here in order to draw attention to the important message that as always the modelling must be viewed in light of the data that goes into it and that it is important in the namoi region that higher resolution extraction data is collected in the future until this is available the existing data must be used the first limitation specific to this application is due to the lstm data split coinciding with natural changes in this set of water level time series neural networks require the data set to be split into training validation and testing subsets and for time series applications it makes sense that these sets should be comprised of blocks of sequential time points in the case of the namoi basin data many of the wells display strong temporal trends where the patterns in recent years are quite different than those seen in the 1970s and 80s in fig 5 it was noted that a lessening or reversal of the downward trend was often seen between 2005 and 2010 which is where the training data ends and the validation data begins in this case when the earlier years are used to train the model it becomes challenging for the model to produce good predictions for later years since the conditions no longer resemble those at the beginning this is why the predictions for some of the clusters in the appendix are seen to be underestimating water levels in the latter years the second and largest limitation with regards to the namoi data is the uncertainty and resolution of the recorded extraction data extractions are recorded as annual lump sums not providing enough information to relate shorter duration changes in groundwater levels to specific extraction events they are conspicuously coarse when considered next to the plethora of publicly available daily data on climate conditions the extraction data begins in 1985 though pumping started in the namoi region in 1966 meaning that roughly the first half of the training data in this study is incorrectly training the model on groundwater responses to conditions without pumping when pumping was in fact occurring additionally looking at the extraction plot in fig 4 it is unknown if the large reduction in extraction volumes evident at all wells around 1997 is a real result of restricted extractions or an artifact of a change in reporting structure csiro 2011 note that extractions in australia are rarely metered and it is estimated that unlicensed pumping accounts for a further 20 of extracted volumes in this study it has been assumed that the relative magnitude of the unmeasured extractions fluctuates similarly with the measured data though the locations of unmeasured extractions are of course unknown the annual resolution of the extraction data the assumption of no extractions before the mid 1980 s and the potentially large portion of unmeasured extractions make the extraction data a significant limitation to this study flagging the opportunity for producing better predictions by improving the reporting of regional extractions in the future challenges with predicting future groundwater levels are encountered regardless of the method used the relationships between the system components do not necessarily hold constant over time or space changing climate growing populations land use change and updated farming and irrigation practices will vary the amount and timing of groundwater extractions meixner et al 2016 changes in precipitation patterns may affect the rate of groundwater recharge differently depending on local land use and soil characteristics green et al 2011 the effects that these shifting conditions have on the system make predictions of future groundwater levels challenging for any model trained on past conditions 8 conclusion a method has been developed for data driven temporal and visual analysis of multiple groundwater level monitoring data sets in a hydrologically stressed region of australia where the complex and not comprehensively defined hydrogeological processes make traditional spatiotemporal or physically based models difficult to apply the combination of unsupervised and supervised learning used in this study allows for predictions to be made on patterns that are abstracted from the set of time series without requiring prior assumptions about the physical system or the temporal pattern structure though the individual groundwater monitoring time series in the namoi basin were found to be too sporadic to effectively model with the lstm algorithm separately by sharing information between select multiple time series with similar historic temporal patterns partitioned lstms were shown to successfully represent the prevalent patterns in the data set and could be used to make predictions on the individual time series this method of combining the sporadic time series from multiple bores to facilitate the use of data driven time series models may prove useful in any region of the world where groundwater management is needed but detailed hydrogeologic knowledge is sparse the workflow described here expands the potential application of the lstm deep recurrent neural network algorithm on environmental monitoring data sets from the current common use on individual time series to sets of related time series tracking current advances in the machine learning field for multiple time series analysis with neural networks and also provides a visual analysis with the som as the sets are created these two aspects of the study augment the lstm application into the spatiotemporal realm by carefully merging related information from multiple time series with the som before modelling each subset with the lstm 1 the complexity of the set of diverse time series is reduced into a small set of specific patterns 2 issues of intermittent environmental monitoring measurements and small datasets are overcome and 3 the sharing of pattern information across the system is enhanced visual analytics an important tool to support water practitioners in the decision making process is an integral part of the som use in this workflow allowing an exploration and comparison of the spatial and temporal variations in the historic groundwater dynamics of the region this process facilitates the use of advanced machine learning methods on data that otherwise would not support the use of these models due to the nature of the individual time series expands knowledge of the namoi hydrogeologic system through visual analytics and introduces a spatiotemporal aspect to the lstm analysis the understanding of the historic spatial and temporal patterns provided through visualisations combined with the set of deep learning groundwater level predictions provide an awareness of regional patterns that can be drawn upon to support groundwater management decisions many gaps still exist in the understanding of australia s hydrogeological systems making data driven models a good alternative to physically based models for providing inexpensive predictions without requiring extensive subsurface investigations and this study highlights that the benefits of turning to neural networks in groundwater analyses have the potential to continually expand if we persist in actively adopting ideas as they emerge in the machine learning literature adapting them as necessary to fit the characteristics specific to environmental data future work may include exploring various granularities of partitioning the set of time series before applying the lstm comparing the predictions from smaller subsets up to a single lstm on the entire set to determine if there is an optimal partitioning in terms of generalisation ability and prediction accuracy declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements dr stephanie clark is supported by the australian research council through the australian centre of excellence in mathematical and statistical frontiers acems ce140100049 the author is grateful to professor louise ryan for providing statistical advice and comments on the manuscript and to the nsw department of planning industry and environment dpie for introducing this interesting problem and partially supporting this work appendix lstm predictions for all clusters 
25638,the calibration of integrated groundwater surface water models is often associated with high dimensionality and stagnation around local optimum solutions since these models are computationally demanding and also non linear finding their global optimum solution requires efficient optimization techniques here we introduce the multi memory particle swarm optimization mmpso algorithm the swarm cognitive capacity is enhanced to minimize the number of local optimums and calibrate the model based on sub objective functions we used the mmpso to simultaneously calibrate groundwater head streamflow baseflow and nitrate loads in the swat modflow rt3d model with 78 sensitive parameters the results demonstrate that enhancing the cognitive capacity led to a marked improvement in discovering the global optimum solution furthermore we evaluated the calibrated model s performance to quantify groundwater nitrate loads to streams and characterize the shallow surficial aquifer under intensive fertilizer land use the results show the effectiveness of the mmpso algorithm for calibrating complex hydrogeochemical models for large scale applications keywords groundwater nitrate swat modflow rt3d high dimensionality particle swarm optimization great barrier reef 1 introduction nitrate no3 is a major cause of water quality impairment with a diverse range of ecological and toxicological consequences camargo and alonso 2006 anthropogenic changes to the catchments such as urbanization and expanding agricultural lands along with excessive use of fertilizer have increased no3 concentration in groundwater gw and surface water sw around the world kroon et al 2016 zhang et al 1996 increased no3 levels in the aquatic ecosystem frequently cause hypoxia and eutrophication wreaking havoc by depleting oxygen and forming dead zones rabalais et al 2002 elevated no3 concentrations in reservoirs that supply drinking water contribute to cyanobacteria blooms posing serious health risks to human populations herrero et al 2001 moridi 2019 reducing no3 contamination in gw and sw requires effective managerial decisions that often rely on simulation models for strategic planning melland et al 2018 singh 2014 when gw and sw components are closely interconnected an integrated gw sw model incorporated with a no3 fate and transport model is the key to quantify the spatiotemporal sources of no3 and successfully assess the potential impact of management practices almasri 2007 conant et al 2019 in the last two decades extensive efforts have been dedicated to developing various integrated gw sw model types to simulate catchment systems craswell 2021 sarma and singh 2021 meanwhile fully integrated models that simultaneously solve the governing gw sw equations such as parflow kollet and maxwell 2006 and hydrogeosphere therrien et al 2010 are data intensive hence prone to over parameterization and also often lack detailed agricultural practices and nutrient cycling barthel and banzhaf 2016 alternatively partly integrated gw sw models two or several individual models exchanging their results are used to simulate nutrient cycling at large scale catchments with relatively fewer input data requirements conan et al 2003 narula and gosain 2013 for instance modflow a fully distributed physically based gw model has been integrated with semi distributed sw models including hspf modflow geurink et al 2007 and several versions of swat modflow bailey et al 2016 kim et al 2008 sophocleous 2002 the application scope of swat modflow is broader in the agricultural dominated catchment as the swat model can monitor different pools of nitrogen through a comprehensive agro biophysical module fu et al 2019 neitsch et al 2011 wang and chen 2021 in addition in the latest stage the swat modflow model has been amended to simulate gw no3 fate and transport as well as no3 load exchange between gw and sw systems wei et al 2019 using the rt3d model for groundwater reactive transport and groundwater surface water solute mass exchange in previous studies fitting the hydrogeochemical parameters of the swat modflow model was often carried out by independently calibrating swat and modflow with or without a final calibration for the integrated model molina navarro et al 2019 mosase et al 2019 tigabu et al 2020 wei et al 2019 yifru et al 2020 on the one hand independently calibrating swat and modflow does not lead to a calibrated swat modflow model acero et al 2019 for example swat contains a simplistic gw algorithm that eliminates gw lateral flow and only considers storage for shallow and deep aquifers with hydrologic response units hrus therefore when a swat model is calibrated for streamflow the summation of gw return flow lateral flow and surface runoff the swat gw component does not generate a spatiotemporally high resolution gw return flow as a fully distributed model such as modflow does therefore when modflow replaces the swat gw component the new gw return flow changes the streamflow calibration performance necessitating a new model calibration likewise when swat replaces the recharge and river stage in modflow with spatiotemporally higher resolution values the modflow gw hydraulic properties must be recalibrated on the other hand the solution space the number of possible combinations of parameters of the integrated model is so vast that a manual calibration can hardly ever achieve the global optimum solution therefore an automatic approach is required to calibrate the integrated model in the gw modeling discipline gradient based calibration methods such as gauss marquart levenberg 1944 are the backbone of inverse modeling and historically have been used for calibrating gw models with the assumption of model linearity the gradient based methods evaluate the model performance for initial solutions and calculate the jacobean matrix followed by a few forward runs toward maximizing minimizing the objective function until a satisfactory model s performance can be achieved anderson et al 2015 the gradient based methods are sufficient for linear problems or the steady state gw model specifically for estimating gw hydraulic properties with regularization approaches doherty and hunt 2010 however the solution space for calibrating a gw sw model that simulates geochemical processes in the transient state is extremely multi modal and noisy this is mainly due to the high dimensionality of solution space the interaction among models parameters and several calibration targets therefore gradient based methods stagnate around a local optimum without a mechanism to escape the trap anderson et al 2015 keating et al 2010 mugunthan et al 2005 in contrast global based methods such as evolutionary algorithms do not rely on local derivatives to explore the objective function surface thereby offering a more robust approach in optimizing noisy multi modal problems rios and sahinidis 2013 for instance lyons et al 2020 compared the results from the pest software a commonly used gradient based calibration method with several metaheuristic global based optimizers for calibrating steady state gw heads they showed that the average error function with pest was an order of magnitude larger than any of the global based optimizers indeed in earlier studies the limits of computing power impeded the use of global based optimizers in calibrating hydrogeochemical models mugunthan et al 2005 however with the increase in the availability of high performance computers hpc and cloud computing services global based optimizers can be examined improved and applied to real world problems hayley 2017 metaheuristics are a branch of global based optimizers that take advantage of synthetic methods such as management of populations replication and variability to systematically identify the global optimum within a solution space sloss and gustafson 2020 the implementation of the metaheuristic search concepts has also been emerged in various forms to solve complex non linear optimization problems in water resources management hatamkhani and moridi 2019 janga reddy and nagesh kumar 2021 specifically the particle swarm optimization algorithm pso has been widely used in various hydrological modeling applications hatamkhani et al 2020 jahandideh tehrani et al 2020 however as the dimensionality of the solution space increases so does the number of local optimums in this condition metaheuristics in general and pso in particular rapidly lose their efficiency to discover the global optimum solution chen et al 2015 different methods were introduced to overcome the curse of dimensionality for example previous studies handled this problem by improving the searching techniques to avoid local exploitation jia et al 2011 slowing down the convergence e g li et al 2015 or reducing the range and number of parameters through sensitivity analysis song et al 2015 however each of these techniques can be ineffective when the model is highly non linear for example identifying sensitive parameters through applying linear regression or one at a time sensitivity analysis in a highly non linear model can be misleading saltelli et al 2019 saltelli and annoni 2010 thus a variance based sensitivity analysis should be employed which requires an exhausting number of model evaluations that cannot be carried out for a computationally demanding model such as swat modflow rt3d e g nossent et al 2011 nevertheless a calibrated gw sw model should be reliable in reproducing several outputs e g gw head streamflow and constituent load in streams meanwhile in a single objective optimization such as conventional pso an error function for measuring the performance of each model output should be included typically as the sum of all errors therefore the ambiguity in the sources of errors increases the number of local optimums in the landscape of the single objective function knowles et al 2001 under these circumstances decomposing the single objective function and employing multi objective approaches can to a certain extent reduce the local optimums efstratiadis and koutsoyiannis 2010 her and seong 2018 lu et al 2009 yazdi and moridi 2018 however in multi objective optimizations the probability of discovering non dominated solutions falls exponentially as the number of objectives rises ishibuchi et al 2006 as a result it is common to see a large number of model evaluations required for multi objective optimization to find the global pareto optimal front herman et al 2020 kamali et al 2013 therefore still more advanced and effective techniques are essential to limit the number of local optimums and overcome the curse of dimensionality here we introduce a new particle swarm optimization pso algorithm in which the swarm cognitive capacity is enhanced to constrain the number of local optimums in the calibration of gw sw models with high dimensionality the proposed algorithm multi memory pso mmpso is novel because in contrast to a single objective pso the learning strategy of the mmpso s particles relies on the prior information about the solution space and the attribution of parameters groups to the decomposed version of the single objective function or sub objective functions thereby particles can learn from several sub objective functions and optimize the gw sw models based on a catchment s geological sections as a result the dimensionality and the number of local optimums can be decreased resulting in an efficient searching approach to discover the global optimum solution in summary this research aims to develop an optimization approach that can handle the high dimensionality of a non linear gw sw model in a comparatively limited number of simulations to address this goal first we applied the swat modflow rt3d model to a tropical catchment that discharges to the great barrier reef australia with interconnected gw and sw systems then the following objectives were evaluated i the performance of the mmpso algorithm against the original pso in calibrating the model and achieving the global best while addressing the shortcomings of the pso algorithm and ii the reliability of the calibrated swat modflow rt3d model in identifying the source fate and transport of no3 within the study area and between gw and sw systems the algorithm developed herein is the first comprehensive calibration method for the swat modflow rt3d model 2 materials and methods 2 1 study area north johnstone catchment the great barrier reef gbr is the world s largest coral ecosystem extending over 2000 km from southeast to northeast australia the reef is damaged by a cumulative impact of climate change and non point source pollution from agricultural activities in the coastal catchments gbrmpa 2014 waterhouse et al 2017 evidence shows that the increase in the eutrophication extent and occurrences the duration of algal bloom and the outbreak of coral eating crown of thorn starfish cots are associated with the increased level of no3 concentration in streams draining to the gbr lagoon brodie et al 2005 fabricius et al 2010 this situation is alarming in the wet tropics region of the gbr as the catchments proportionally discharge the highest amount of no3 to the initiation zone of cots posing the greatest threat to the health of the reef the north johnstone river catchment 1000 km2 is in the wet tropics region northeast of queensland australia fig 1 the catchment has wet tropical climate conditions during austral summer december to april the weather is hot and humid with intensive rainfall and during the austral winter may to november the weather is temperate dry the rainfall gradient is remarkable across the catchment receiving more than 3 5 m annual rainfall in the low lying coastal zone in the east to less than 2 m in elevated areas in the west rafiei et al 2020 previous assessment of the likelihood of exposure of coral reefs to no3 indicates that the catchment is among the highest no3 contributors across the gbr waterhouse et al 2017 the hydrogeology of the north johnstone catchment consists of a deep soil profile and shallow fluctuating gw which can reach the soil surface at the lower aspects of the undulating topography hair 1990 the catchment has three geological sections the lower section coastal zone consists of unconsolidated surficial sediments and partially basalt aquifer systems the dominant land uses in the lower section are sugarcane banana grazing pasture and urban the middle section is covered by rainforest clad and formed weathered granitic mountains furthermore the upper section has a basalt gw aquifer system locsey 2004 hosting one rural town malanda and the dominant land use is grazing pasture with modified or native vegetative cover the gw layers of the catchment are highly stratified consist of thin layers of fractured rock with spatial variability in hydraulic conductivity and anisotropic hydraulic properties cook 2003 2 2 nutrient transport modelling 2 2 1 overview of swat modflow rt3d theory for this study we used a coupled swat modflow modeling code provided by bailey et al 2016 modified by wei et al 2019 to include the gw reactive transport in 3 dimensions rt3d model in the integrated model swat passes recharge from soils river stage from sub catchment streams no3 leaching from soils and no3 concentration in sub catchment streams from hrus and sub catchment streams to modflow grid cells for each daily step when modflow finishes solving the gw governing flow equation rt3d is called as a subroutine to simulate the no3 mass balance for each grid cell which includes no3 mass exchange between the aquifer and streams no3 mass passed from the aquifer to the streams is routed through the catchment stream network using swat routines wei et al 2019 the entire linking procedure including the technical aspect is described by bailey and park 2019 2 2 2 swat model for north johnstone catchment we established a swat model for the north johnstone catchment with 91 sub catchments and 1295 hrus further details of the land use map topsoil layer dataset are provided in fig s1 in the supplementary material three streamflow monitoring stations fig 1 are i tung oil station located at the end of the north johnstone river receiving runoff from 90 of the catchment ii the glen allyn station located at the upper section of the catchment receiving runoff from 16 of the catchment mainly from pasture areas and iii fisher creek station located at the end of a tributary channel in the lower section receiving runoff from one sub catchment equal to 1 5 of the catchment the summary of data used for establishing the swat model climate data dem map topsoil layers land use map watercourses and the sources of observational data for the calibration and model performance evaluation including daily streamflow and hydrograph separation filtering technique for baseflow daily gw head elevation and no3 loads in the stream is provided in table s1 in the supplementary material the details of planting harvesting evapotranspiration calibration and the parameterization of leaf area index of rainforests pasture plants sugarcane and banana for the swat model of the north johnstone catchment are described by rafiei et al 2020 further details of standard management practices and fertilizer usage in pasture and farmlands are described in section s1 2 2 3 modflow model for north johnstone catchment we established the gw model using usgs modflow nwt v 1 2 0 niswonger et al 2011 the model domain was discretized using 36 873 cells 244 columns and 154 rows with 250 250 m grid cell size resulting in 16 482 active cells within the catchment boundaries a 25 m dem map was used to represent the surface elevation data from 1443 boreholes across the region were employed to estimate the elevation of the aquifer base fig s2 the total estimated depth was discretized into three convertible hydro stratigraphic layers the thickness of the first layer was set equal to 33 of the total depth the second layer thickness equal to 22 of the total depth and the third layer equal to 45 of the total depth with the modflow upstream weighting upw package we divided the model active domain into three geological zones fig 1 we included the recharge and the river stress packages into the modflow model with the former set active to allow the passing of recharge from the swat hrus to the modflow grid cells and the latter set active to allow groundwater surface water exchange between modflow grid cells and swat sub catchment streams 2 2 4 swat modflow rt3d model input parameters and settings for the gw model important hydraulic properties include vertical hydraulic conductivity vhc horizontal hydraulic conductivity hhc horizontal anisotropy han specific yield sy and specific storage ss for each layer of the three geological sections one parameter corresponding to each hydraulic property was considered for the calibration resulting in 45 parameters the initial ranges of gw hydraulic parameters were obtained from the literature anderson et al 2015 batu 1998 river conductance rc and river bottom elevation rb are also critical hydraulic properties that control gw discharge to sw and influence gw head across the catchment typically we estimate rc by multiplying the river hydraulic conductivity to the area divided by the thickness of the river bed thereby for each of the three geological sections we considered one parameter for river bed hydraulic conductivity and one for river bed thickness the initial values for river bed thickness the river width and length were estimated by swat and used to estimate river cell conductance within modflow in the land phase of the swat model often the most critical variable that controls recharge to gw is the runoff curve number cn2 williams and laseur 1976 therefore we considered one cn2 parameter for each dominant land use type in the catchment grazing pasture rainforest and farmlands another critical parameter that controls recharge timing is the gw delay parameter that we included in the calibration regarding no3 cycling in soil the parameters considered for calibration are the denitrification exponential rate coefficient cdn the denitrification threshold water content sdnco and the no3 percolation coefficient nperc moreover a critical soil property that controls organic nitrogen mineralization is carbon content cc therefore we considered one cc parameter for each dominant land use in the calibration in the routing phase of the swat model sensitive parameters considered for calibration are the groundwater recession factor alpha bf manning s roughness of main and tributary channels and the hydraulic conductivity of main and tributary channels the rt3d model controls no3 fate and transport by the following parameters aquifer longitudinal dispersivity ld the horizontal and vertical anisotropy ratio of ld porosity of the gw layers bulk density of the gw layers and gw kinetic denitrification rate overall we included 78 parameters for the swat modflow rt3d model calibration the list of all parameters including their initial range is provided in table s2 we considered a three year warm up period 2009 2011 for the swat modflow rt3d model to set the model in a dynamic equilibrium cycle next the first three years 2012 2014 of monitoring data were used for calibrating the model and the last three years 2015 2017 were considered for model validation these periods were set for the model calibration validation and performance evaluation since i daily gw head monitoring for the catchment was initiated in 2010 but consistent data for the three gw stations are available only from 2012 ii the no3 monitoring station used to be in the tung oil station however since 2012 the monitoring station was moved to the goondi station to observe the no3 discharge from fertilizer intensive land use and iii in stream no3 concentration are available up to the first quarter of 2017 2 3 calibration mmpso optimization 2 3 1 particle swarm optimization pso algorithm the particle swarm optimization pso kennedy and eberhart 1995 is a stochastic optimization technique with roots in artificial life and social psychology pso is a swarm of particles that moves toward the best solution in an iterative manner in every iteration particles update the parameter position vector with two sociometric principles i the global best conceptually connects all particles so that the best performance of any particle influences the performance of the entire population and ii the local best creates a neighborhood for each particle to compare itself with the swarm global best thereby particles based on their current fitness their local best and the swarm global best update their velocity and position vectors with the following imitation function 1 v i t 1 ω v i t c 1 r 1 l i t x i t c 2 r 2 g t x i t x i t 1 x i t v i t 1 where t is the iteration number i denotes the particle number x and v are d dimensional position and velocity vectors l and g are the d dimensional local best and the global best position vectors c 1 and c 2 are learning factors originally c 1 c 2 2 respectively associated with the self belief and social belief components r 1 and r 2 are two random numbers within the range 0 1 and ω is the inertia weight with a range between 0 6 and 1 5 2 3 2 improvement strategies for pso the original pso algorithm has a fast converging behavior and in the absence of additional mechanisms particles stagnate around a local optimum solution therefore the swarm prematurely converges especially in complex large dimensional optimization problems with multi modal objective functions wang et al 2018 here we present steps to enhance the original pso algorithm and propose improvement strategies to address high dimensionality in calibrating gw sw models such as the swat modflow rt3d model used in this study sub swarm strategy to improve particle diversity to maintain particles solution diversity we adopted a multi swarm approach proposed by tanweer et al 2016 that in every iteration the particles are divided based on the euclidian distance and fitness difference into three groups called mentor independent and mentee each group has a specific learning strategy particles in the mentor group the best particles in terms of fitness have a more exploitative learning strategy with more weight on the self belief component of the original pso thereby velocity and position update functions of the mentor group are given by 2 v i t 1 ω v i t c 1 r 1 l i t x i t β 2 c 2 r 2 g t x i t x i t 1 x i t v i t 1 where β 2 is the self belief searching weight and equal to 0 5 the update strategy in the independent group has strong self belief and partial social belief given by 3 v i t 1 ω v i t c 1 r 1 l i t x i t c 2 r 2 p i t g t x i t x i t 1 x i t v i t 1 where p is a d dimensional self perception vector and denotes the element wise multiplication the p elements with the probability of 50 are either 0 or 1 particles in the mentee group having the least fitness possess explorative behavior by supdating their velocity and position vectors either with one of the mentor group members or rely on their self belief given by 4 v i t 1 ω v i t c 1 r 1 c s e l i t x i t c 2 r 2 s m e m t x i t x i t 1 x i t v i t 1 where m is a randomly selected local best position vector from the mentor group members and s m e and c s e are introduced to perform velocity update based on social belief or self belief therefore with a 50 probability the c s e and s m e are respectively either 0 and 1 or 1 and 0 enclosing searching space we adopted the damping boundary condition proposed by huang and mohan 2005 to enclose the searching space when a particle passes a boundary in any dimension the damping wall absorbs a proportion of the velocity and reverses the direction inertia weight strategy to avoid local optimum traps we adopted two different inertia weight strategies for the particles groups to avoid premature convergence we implemented a random inertia weight strategy eberhart and shi 2001 for the mentor and mentee groups to help the particles escape the local optimal traps for the independent group we adopted a ranking based inertia weight approach panigrahi et al 2008 to define the searching range of particles based on their relative position to the global best the more a particle is close to the global best the lower the inertia weight value is assigned to the particle proposed improvement to the velocity and position update equations of pso for calibrating gw sw models a gw sw model calibration aims to maximize the model performance for simulating several components including streamflow baseflow gw head and constituent loads and concentrations in streams in the conventional pso algorithm particles solely update their velocity and position vector with the best solution found for the overall performance of the components thereby given the presence of numerous local optimums and high dimensionality the swarm moves toward an undesirable solution space by maximizing the performance of several components at the expense of minimizing the others we can partially resolve this issue by finding an optimal weight for each component in forming the single objective function however if the calibration includes many parameters which is the case for a gw sw model the ambiguity in the sources of errors with using a single objective function adds to the number local optimum solutions to overcome this problem we propose the mmpso in which particles memorize the position vectors corresponding to n local sub objectives in the model application to the study region of the north johnstone river catchment we define the sub objectives by grouping components with similar response behavior based on the catchment s geological sections for this purpose we need to provide the algorithm with prior information about the attribution of each parameter to their sensitive sub objective function given the concept mmpso partially decomposes a calibration problem into several sub problems by dividing the position vector of particles into several sub groups in this condition the swarm attraction to the undesirable solution space becomes constrained and particles can move partially toward optimizing sub objective functions to implement the concept in the algorithm we modified the self belief behavior of the imitation function of equation 3 the independent group according to equation 5 we applied the modification only to the independent group to keep the exploitative and explorative behaviors of the mentor and mentee groups while improving the cognitive capacity of the independent group 5 v i t 1 ω v i t c 1 r 1 l i g t x i g t β 2 c 2 r 2 g t x i t x i t 1 x i t v i t 1 where g denotes the index of sub groups in a d dimensional position vector fig 2 conceptually illustrates how a particle in the independent group of mmpso estimates its future position the dashed circle in comparison to a particle in pso both based on their current position the green circle and previously experienced positions blue circles we excluded the impact of the swarm s global best the social belief on determining the future position in this comparison to emphasize the difference between the self belief behavior in pso and mmpso the particle in its current position experienced three other positions in the solution space of the total objective function which can be decomposed into two sub objective functions fig 2 a i fig 2 a ii the particle in the mmpso estimates its future position using the resultant velocity vectors toward the fittest experienced positions in the solution space of sub objective functions fig 2 a iii whereas the particle in the pso chooses its future position based on the fittest experienced position in the solution space of the total objective function fig 2 b i that is far from the global optimum solution fig 3 illustrates the flowchart of the mmpso algorithm the calibration starts by initializing mmpso parameters including the range of inertia weight number of particles maximum number of iterations termination criteria model parameters parameters range and the number of initial executions with latin hypercube sampling lhs next the algorithm runs the particles in parallel it updates velocity and position vectors after each iteration until it meets the maximum number of iterations or other termination criteria moreover a maximum model simulation run time was also defined for the algorithm to avoid embarrassingly parallel workload by terminating the simulation in the event that the modflow solver engine does not converge to a solution of groundwater head 2 3 3 calibration function and model performance evaluation criteria a calibration function comprising a summation of the error terms normalized by a baseline condition such as the average of observations is often used for calibrating hydrological models examples of benchmark calibration functions are nash sutcliffe efficiency nse percent bias pbias mean average error mae mean square error mse coefficient of determination r 2 and root mean square error rmse althoff and rodrigues 2021 moriasi et al 2007 however depending on the error exponent value and normalization formula any individual function leads the optimization algorithm to emphasize different response modes in the calibration hernandez suarez et al 2021 moriasi et al 2015 for instance in catchments with high variance in streamflow using the nse function leads to having significant volume balance errors gupta et al 2009 in addition by using the average error functions e g mae or mse or rmse negligible improvement occurs when the mean of simulations is near the mean of the observations causing numerous local optimum solutions to tip the balance here we used a maximization function based on a combination of r 2 and mse with scaling factors given by equation 6 6 o i s t r 2 s α m s e s o f j i 1 n o i t o f j 1 m s o f j where s t and s α are scaling factors o i is the objective function of ith component s o f is the sub objective function j denotes the sub objective function s number n is the number of components o i in a sub objective function and m is the number of sub objectives t o f is the total objective function which is the summation of all sub objectives the range of the function o is between and s t and the perfect match between the observations and simulations is equal to s t the scaling factors s t and s α are problem specific that need to be adjusted based on the magnitude of the standard deviation of mse of a component to evaluate the daily and monthly model s performance in simulating no3 loads and streamflow baseflow we used the recommendations defined by moriasi et al 2015 table s3 regarding the model s performance in simulating gw head elevation no established guidelines specify the acceptable magnitude of the average error functions anderson et al 2015 merz 2012 however based on the observations from previous studies with swat modflow that reported statistical indexes for gw model performance acero et al 2019 acero triana et al 2020 guevara ochoa et al 2020 qi et al 2019 we defined nse as more than 0 3 and mse less than 1 m square error as the bottom line forsaccepting rejecting model performance table s3 2 3 4 grouping the parameters and forming the sub objective functions based on our knowledge of the catchment we define the sub objective functions and parameters groups as follows 1 the first sub objective function considered three components related to streamflow at tung oil fisher creek and glen allyn stations fig 1 next the parameters including cn2 of forests farmlands and pasture plus the alpha bf the manning s roughness and hydraulic conductivity of tributary and main channels were grouped for this sub objective function 2 the second sub objective function comprised two components related to gw head elevation at millaa millaa and glen allyn stations plus one component related to the baseflow at the glen allyn station all in the upper section of the catchment the modflow river parameters and gw hydraulic properties of the upper section of the catchment were grouped for this sub objective function 3 the third sub objective function contained one component related to gw head elevation at goondi station and two components related to baseflow at fisher creek and tung oil stations all in the lower section of the catchment the modflow river parameters and gw hydraulic properties of the middle and lower sections of the catchment were grouped for this sub objective function 4 the fourth sub objective function selected one component related to no3 loads at tung oil station the parameters including the organic carbon content of the topsoil layers of the forests pasture and farmlands plus the cdn sdnco and nperco the porosity of the gw layers the ld of the three layers the horizontal ratio of ld and vertical ratio of ld and the bulk density and denitrification kinetic rate were grouped for this sub objective function 2 3 5 gw initial head and penalty function as the initial head of gw is unknown and insufficient spatial gw head observations are available across the case study a technique for estimating the initial head is included in the algorithm and described in the supplementary material section s2 additionally due to the insufficient number of observation wells especially for the middle section of the catchment the accuracy of gw heads in some regions is unknown this is a common problem for gw models applied to large scale systems with a scarcity of gw data acero et al 2019 to avoid solutions that result in unrealistic gw heads we defined an exponential penalty function further details of the penalty function are described in the supplementary material section s3 2 4 parameter uncertainty analysis mmpso starts the optimization from the given initial ranges of parameters the algorithm eventually converges to smaller search space by estimating the gaussian kernel density of parameters and then limiting parameters ranges to their respective 95 percentile of the density distribution we can find the parameter space s subsequent domain toward each parameter s final range we then use the estimated final range for conducting the parameter uncertainty analysis lhs is the standard method for preparing the input parameters for parameter uncertainty analysis after carrying out 10 000 simulations with lhs two indexes p factor and r factor were used to measure and quantify the uncertainty and errors resulting from the model abbaspour et al 2004 it should be noted that 10 000 simulations were enough as we observed that the regression to the mean happened and the model output variance could be said to be converged p factor is the proportion of observations falling within the 95th percentile of simulations and the 1 p factor can be referred to as the model error r factor is the thickness of the 95th percentile of the simulations calculated by equation 7 7 r f a c t o r i 1 n s i m 97 5 i s i m 2 5 i n σ o b s where s i m 97 5 i and s i m 2 5 i are the upper and lower bands of 95 percentile of simulations n is the number of time steps and σ o b s is the standard deviation of observations for flow and no3 loads a p factor close to 1 and r factor below 1 5 indicates an acceptable performance of the parameter uncertainty in the model abbaspour et al 2007 for gw head a desirable p factor is 1 2 5 allocated computational resources and optimization termination criteria the calibration was undertaken using an hpc cluster with the rhel 8 2 operating system and 100 1 tflops performance the cluster had 24 compute nodes each having 1 tb ram and 2 64 cpu cores amd epyc 7452 with a clock speed of 3 3 ghz we used one node and allocated 64 processors 400 gb ram and 1 tb storage for calibrating the model with 45 parallel workloads in pso mmpso the average calibration time for 200 iterations with 45 parallel workloads in the hpc was 70 h termination criteria are defined to halt the optimization based on 1 the maximum number of iteration or 2 the amount of advancement in the swarm s global optimum solution in regarding the first criterion the optimization stops after 200 iterations concerning the second criterion the process halts when no advancement in results is observed after 50 iterations 3 results and discussion 3 1 comparing mmpso performance with the original pso fig 4 shows the global and local convergence of 45 particles in mmpso and pso within 200 iterations with the first five iterations based on lhs we carried out the calibration three times with each algorithm and selected the best performances for relevant comparison as shown in fig 4b both algorithms had close progress within the first 25 iterations after that pso particles stagnated around a local optimum and could not improve the global best within the last 50 iterations on the other hand the mmpso particles constantly improved the global best until the maximum number of iterations was met more importantly the mmpso swarm escaped local optimum traps specifically at the 50th and the 100th iterations eventually while pso particles converged to one local optimum solution the mmpso maintained the diversity of solutions throughout the calibration this aspect of the mmpso is valuable because we can use the final local best solutions as the input for a subsequent optimization run with or without different weights on the sub objective functions to achieve the best performance for all the simulation components as explained before the mmpso particles use sub objective functions to constrain the swarm attraction toward undesirable solution space however the extent to which the algorithm can quickly find the attraction area around the global optimum solution is influenced by the scaling factors in the calibration function given by equation 6 although finding the best scaling factors s α and s t is a problem specific issue a general rule can be applied to normalize the impact of each component on the variance of the summation of components for example through an uncertainty analysis we quantified that the mean and standard deviation of the mse for streamflow at tung oil station was respectively 55 times and 100 times larger than the same error index for streamflow at glen allyn station therefore the s α of the tung oil streamflow calibration function was set at 0 05 to normalize the impact of this component on the variance of the total objective function likewise the mean and standard deviation of the mse for the gw head at millaa millaa station was 20 times and 35 times larger than the gw head in the glen allyn station however as discussed gw head calibration functions were better normalized with weighting s t than s α hence we considered s t values for glen allyn and millaa millaa gw head elevations 100 and 25 nevertheless the highest value found for the total objective function satisfying the model performance criteria for all simulation components was 80 of which the mmpso reached 53 in the first run with 200 iterations 3 2 swat modflow rt3d performance and evaluation criteria table 1 summarizes the daily and monthly performance of the swat modflow rt3d model based on statistical indexes fig 5 shows the model s calibration and validation periods performance for simulating gw head elevation at goondi station and streamflow at tung oil station the rest of the hydrographs for other stations are provided in figs s4 s5 s6 and s7 the daily and monthly model s streamflow performance is very good for all stations except a satisfactory performance for the daily streamflow simulation at fisher creek fig 5 s4 and s5 compared to other north johnstone catchment studies that used the swat model rafiei et al 2020 zhang et al 2020 the swat modflow considerably improved streamflow simulation performance the pbias for tung oil station is improved from 8 5 to 2 71 the pbias for glen allyn station is improved from 21 8 to 3 3 and the pbias for fisher creek improved significantly from 42 2 to 1 70 regarding the model s performance for simulating baseflow statistical indexes showed a very good performance for fisher creek a good performance for the tung oil station and a satisfactory performance for glen allyn however the baseflow in glen allyn station on both daily and monthly showed an overestimation in the low flow period for instance while the recorded baseflow at glen allyn station goes down from a maximum of 14 m3 day in the wet season to 0 5 m3 day in the dry season the modflow model generated a constant value of 2 m3 day for the low flow period this overestimation was systematic with a p factor of 0 57 which is the lowest p factor among all other components however no systematic error was found for baseflow at the fisher creek as the p factor is 1 and the simulation model reproduced both peaks at storm events and low flow rates at dry period one possible reason for the overestimation of baseflow in low flow periods was reported by werner et al 2006 in a tropical catchment of gbr similar to this study werner et al 2006 used a fully integrated gw sw model for simulating baseflow and gw head they concluded that the riparian vegetation water use could cause the overestimation due to the high amount of water consumption of up to 0 5 ml day among three gw head observation stations goondi station reached an nse of 0 75 millaa millaa 0 65 and glen alyn 0 58 plus the mse values for all gw stations were below 60 cm square error thus the model well reproduces the response of the gw system to external stresses fig 5 s6 and s7 plus the model simulated the seasonal and interannual trends of the gw heads with acceptable errors liu et al 2020 used a gradient based approach pest to calibrate swat modflow the results of calibration range from 0 42 0 84 for r 2 and 2 35 and 3 66 for pbias meanwhile in our case the r 2 for glen allyn station is 0 72 and pbias is 0 031 r 2 for goondi station is 0 80 and pbias is 7 3 r 2 for millaa millaa station is 0 80 and pbias is 0 021 moreover the p factor for all gw stations is 1 and the r factor ranges from 4 56 to 16 96 the nse for no3 loads at the goondi station for the three year calibration period was 0 59 with pbias of 0 4 for the validation period the nse was 0 28 with pbias of 11 thus in terms of statistical performance the model s ability to simulate no3 loads in the streams is very good comparing results with a study carried out by swat modflow rt3d in an irrigated semi arid watershed wei and bailey 2021 achieved an r 2 value of 0 65 and nse value of 0 51 for no3 loads in the stream for the calibration results however it appears that the model prediction ability for higher values is more robust than smaller ones in the range of 10 kg day to 1000 kg day fig 6 wei and bailey 2021 also reported a similar observation regarding the overestimation of no3 loads in the low flow period however we should emphasize that various epistemic sources of uncertainty often influence the calibration of any hydrological model for no3 loads therefore p factor and r factor should be included in the model evaluation as robust indices for assessing the reliability of the simulation results abbaspour et al 2007 the r factor and p factor fig 7 for no3 loads are respectively 0 86 and 0 76 both illustrating an excellent level of uncertainty and indicating the simulations capture the majority of observed no3 loads p factor 0 75 with a narrow envelope r factor 1 3 3 sources fate and transport of no3 in the north johnstone river catchment the modeling results show that the catchment average of no3 contribution from surface runoff was 1 80 kg ha year lateral flow contributed 0 37 kg ha year gw aquifers contributed 1 16 kg ha year and 0 14 kg ha year seeped from the catchment s stream network to gw aquifers predictive uncertainty analysis of no3 loads from gw and sw and their exchange for the catchment is illustrated in fig 8 the range of uncertainty regarding the surface no3 contribution to the stream is higher than the no3 loads from gw and the lateral flow the higher uncertainty range in no3 loads from sw runoff indirectly implies the higher availability of no3 loads in the topsoil layer and the faster mechanism for no3 removal from surface runoff to streams than the removal and transport mechanisms in the gw systems fig 9 shows the spatial pattern of the long term average of gw head elevation gw recharge and gw no3 concentration across the catchment for the model evaluation period gw heads follow the topographic elevation with no unrealistic head fig 9a the highest gw no3 concentrations occur under sugarcane and banana intensive areas in the low lying coastal zones with the annual no3 concentration ranging from 0 9 to 2 7 mg l fig 8c fig 9d shows the daily simulated gw no3 concentration for the goondi station located in fertilizer intensive sub catchment the gw no3 concentration increases to 2 25 mg l in the wet season and drops to 0 5 mg l by the end of the dry period a similar dynamic in gw no3 concentration with a variation from 1 7 mg l in the wet season to 0 023 mg l in the dry season has been reported for sugarcane intensive areas in the region rasiah and armour 2013 3 4 the hydrogeochemical characteristic of the shallow aquifer in the agriculturally dominated area as illustrated in fig 9 and discussed above the intensive fertilizer application area in the lower section shows a higher gw no3 concentration than the rest of the catchment the results also show that the gw no3 concentration does not increase over a long term period fig 9d similar to our finding armour et al 2004 reported a zero net accumulation of gw no3 concentration over the last 40 years however whether this zero net no3 accumulation results from gw transmisivity or a fast biodegradation process requires a closer look into the shallow aquifer characteristics the surface elevation of the goondi station in the lower section is 4 2 m above sea level and the gw head fluctuates between the elevation of 1 2 m and 8 36 m hence the aquifer condition in the rainy summer is confined while in the dry winter is unconfined the specific storage for the confined period is estimated at 5 5 10 5 1 m and the specific yield is 6 5 10 3 the relatively higher specific storage and low specific yield imply that the gw in the confined condition can retain and release a more significant water volume in the rainy season than the dry season additionally the shallow aquifer s horizontal and vertical hydraulic conductivities were estimated respectively at 17 5 m day and 0 016 m day exhibiting a vertical anisotropy ratio of 0 001 based on these numbers and the 12 m thickness of the gw layer the transmissivity of the aquifer is 210 m2 day and the vertical hydraulic resistance of the aquifer is 750 days also the lag time between the rainfall event and the increase in the gw table gw delay variable is estimated at four days therefore the relatively higher specific storage low gw delay high vertical resistance and fast transmissivity create a condition in which the no3 transport cycle is relatively fast between sw and gw this is more pronounced in the rainy seasons when the recharge is intense and the accumulated no3 near the soil surface can percolate to the gw and flush out to the main channel our finding is consistent with rasiah and armour 2013 they showed that the solute transport from gw to streams is relatively fast due to the high recession water table and lateral flow transmissivity however rasiah and armour 2013 emphasized that although the hazard associated with the gw no3 concentration level might be high the risk depends on several unresolved issues such as distinguishing the transmissivity and biodegradation processes that determine the residence time of no3 in the gw from our modeling results we estimate that the denitrification rate is 0 04 day 1 which corresponds to a half life of 17 6 days therefore the short half life of no3 plus a low value for specific yield can suggest that a suitable condition for denitrification in the dry season is available in the shallow aquifer however the spatial variability in the gw no3 contribution to sw fig 10 a shows heterogeneity in gw no3 response to the stream across the catchment the average annual gw no3 loads from most sub catchments fall between the 90 percentile average annual distribution range 5 69 to 3 16 kg ha year with minus values indicating no3 that seeped from streams to aquifers however in the lower section the sub catchments with intensive fertilizer application contribute between 3 16 and 9 62 kgno3 ha year to streams this variation in gw no3 loads depends on the area allocated to sugarcane and banana productions plus the extent of the land and river connectivity to the gw system therefore extracting the sub catchment with the highest annual gw no3 loads to the stream fig 10b which also encompasses the main channel better reveals the shallow aquifer s characteristic the interaction of gw sw and the impact of fertilizer intensive land use at the vicinity of the river on total no3 loading to the reef the extracted sub catchment average annual gw no3 load is 9 62 kg no3 ha year eight times higher than the catchment s average annual gw no3 loads the daily no3 load from the sub catchment ranges from 9 8 kg day in the low flow period to 57 kg day in storm events the mean and standard deviation of gw no3 loads from the sub catchment are 20 9 kg day and 7 6 kg day more importantly the gw flow and gw no3 loads have a correlation of 0 5 indicating a similar dynamic between the gw flow and gw no3 loads to stream therefore it emphasizes that the leading mechanism for no3 removal in confined conditions is the aquifer s transmissivity rather than biodegradation it is well known that no3 leaching to gw mainly occurs due to excess fertilizer application rasiah et al 2003 numerous studies for the region have proposed mitigation measures such as improving the efficiency of fertilizer applications based on soil characteristics crop rotation and trash blanket fraser et al 2017 schroeder and bureau of sugar experiment stations qld 2007 webster et al 2012 however these measures have not been widely adopted by farmers various social and economic factors such as the fear of future financial insecurity the power of mills over growers the lack of incentives and farmers concerns over equity issues explain the slow pace of adopting these practices benn et al 2010 in addition farmers do not want to take land out of production giri et al 2016 therefore using mitigation strategies that do not take lands out of production can improve overall adoption of best management practices for example supplementary management practices that use in situ biological remediation for increasing denitrification in the topsoil layer in the dry season to reduce the chance of no3 leaching or ex situ engineered remediation systems for capturing runoff from streams and filtering out no3 during the flushing events should be investigated through whole system gw sw analysis wallace and waltham 2021 4 conclusions calibrating models is a crucial step in predicting the system response to external stresses however with the growing complexity of gw sw models new calibration approaches for reducing dimensionality and local optimum solutions are essential global based optimization techniques are practical tools for searching the solution space but similar to gradient based methods both stagnate around local optimum traps when the model is non linear and associated with high dimensionality here we demonstrated a novel approach that can break a solution space of a large scale gw sw model into several geological sections to overcome the dimensionality and reduce local optimums therefore by implementing the concept in pso and accompanying the algorithm with the sub swarms concept the new algorithm mmpso showed a marked improvement in finding the global best solution the swat modflow rt3d model provides a robust approach for quantifying and identifying no3 sources and simulating gw sw interaction at a catchment scale the modeling results using mmpso indicated a considerable improvement in the streamflow prediction compared to previous swat modeling attempts that used surrogate parameters for the gw system the reliability of the model performance was also cross validated with other studies furthermore the model can account for agricultural effects on gw quality including the physical and biophysical processes involving no3 removal in the gw system accordingly the model can provide physical details about the critical aquifer characteristics required for planning and managing the interconnected gw sw system on a large scale regarding nutrient water quality particularly in relation to no3 loading to the sensitive great barrier reef ecosystem our assessment of the shallow aquifer of the region shows that the surficial gw system under the fertilizer intensive land use contributes up to eight times higher no3 loads to streams than the catchment average in particular we found a similar dynamic between the gw flow and no3 loads with a correlation coefficient being 0 5 furthermore our results showed that due to the relatively high specific storage high transmissivity and strong vertical flow resistance in gw the exchange of no3 and flow between the gw and sw is relatively fast this finding is significant in the rainy season and shows that the gw aquifer tends to flush out percolated no3 although the vertical and horizontal heterogeneity of the gw aquifer properties in the region is quite considerable our results provided an insight into the influential role of gw in planning management practices that need to be considered in further studies for the region here we focused on developing a calibration method using the pso as the basis for searching the solution space however the concept for dividing the solution space can be applied to other vector based evolutionary algorithms therefore future work can investigate whether accompanying this concept with similar searching tools such as artificial bee colony or gray wolf optimization algorithms can further speed up the model s calibration with fewer iterations 5 software and data availability we implemented the algorithm with python version 3 8 3 the code consists of one main body and 55 python functions for writing different inputs of the swat modflow rt3d model reading outputs plotting advanced figures checking unrealistic heads adjusting initial gw heads and conducting uncertainty analysis on the model output also as the particles are independent in each iteration we implemented parallel processing which can significantly speed up the calibration process depending on the available computational capacity the algorithm at this stage can be used for calibrating both swat and modflow independently or simultaneously the algorithm developed herein is the first comprehensive calibration method for the swat modflow rt3d model it should also be noted that the swat modflow rt3d is only available for windows operation systems however we recompiled the source code for the linux operating systems of high performance computers which is available in the package at https github com vahidr32 swat modflow rt3d calibration code with mmpso approach git declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the first author gratefully acknowledges the university of southern queensland usq for providing the fee and stipend scholarship for conducting his ph d research this research was undertaken using the university of southern queensland usq fawkes hpc we wish to thank mr torben marcussen of the usq centre for applied climate science for his technical assistance in recompiling the swat modflow rt3d source code for linux operating system we also thank dr francis gacenga from the usq office of research for facilitating our access to the usq high performance computing systems we thank the state of queensland department of environment and science for providing no3 monitoring data appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105312 
25638,the calibration of integrated groundwater surface water models is often associated with high dimensionality and stagnation around local optimum solutions since these models are computationally demanding and also non linear finding their global optimum solution requires efficient optimization techniques here we introduce the multi memory particle swarm optimization mmpso algorithm the swarm cognitive capacity is enhanced to minimize the number of local optimums and calibrate the model based on sub objective functions we used the mmpso to simultaneously calibrate groundwater head streamflow baseflow and nitrate loads in the swat modflow rt3d model with 78 sensitive parameters the results demonstrate that enhancing the cognitive capacity led to a marked improvement in discovering the global optimum solution furthermore we evaluated the calibrated model s performance to quantify groundwater nitrate loads to streams and characterize the shallow surficial aquifer under intensive fertilizer land use the results show the effectiveness of the mmpso algorithm for calibrating complex hydrogeochemical models for large scale applications keywords groundwater nitrate swat modflow rt3d high dimensionality particle swarm optimization great barrier reef 1 introduction nitrate no3 is a major cause of water quality impairment with a diverse range of ecological and toxicological consequences camargo and alonso 2006 anthropogenic changes to the catchments such as urbanization and expanding agricultural lands along with excessive use of fertilizer have increased no3 concentration in groundwater gw and surface water sw around the world kroon et al 2016 zhang et al 1996 increased no3 levels in the aquatic ecosystem frequently cause hypoxia and eutrophication wreaking havoc by depleting oxygen and forming dead zones rabalais et al 2002 elevated no3 concentrations in reservoirs that supply drinking water contribute to cyanobacteria blooms posing serious health risks to human populations herrero et al 2001 moridi 2019 reducing no3 contamination in gw and sw requires effective managerial decisions that often rely on simulation models for strategic planning melland et al 2018 singh 2014 when gw and sw components are closely interconnected an integrated gw sw model incorporated with a no3 fate and transport model is the key to quantify the spatiotemporal sources of no3 and successfully assess the potential impact of management practices almasri 2007 conant et al 2019 in the last two decades extensive efforts have been dedicated to developing various integrated gw sw model types to simulate catchment systems craswell 2021 sarma and singh 2021 meanwhile fully integrated models that simultaneously solve the governing gw sw equations such as parflow kollet and maxwell 2006 and hydrogeosphere therrien et al 2010 are data intensive hence prone to over parameterization and also often lack detailed agricultural practices and nutrient cycling barthel and banzhaf 2016 alternatively partly integrated gw sw models two or several individual models exchanging their results are used to simulate nutrient cycling at large scale catchments with relatively fewer input data requirements conan et al 2003 narula and gosain 2013 for instance modflow a fully distributed physically based gw model has been integrated with semi distributed sw models including hspf modflow geurink et al 2007 and several versions of swat modflow bailey et al 2016 kim et al 2008 sophocleous 2002 the application scope of swat modflow is broader in the agricultural dominated catchment as the swat model can monitor different pools of nitrogen through a comprehensive agro biophysical module fu et al 2019 neitsch et al 2011 wang and chen 2021 in addition in the latest stage the swat modflow model has been amended to simulate gw no3 fate and transport as well as no3 load exchange between gw and sw systems wei et al 2019 using the rt3d model for groundwater reactive transport and groundwater surface water solute mass exchange in previous studies fitting the hydrogeochemical parameters of the swat modflow model was often carried out by independently calibrating swat and modflow with or without a final calibration for the integrated model molina navarro et al 2019 mosase et al 2019 tigabu et al 2020 wei et al 2019 yifru et al 2020 on the one hand independently calibrating swat and modflow does not lead to a calibrated swat modflow model acero et al 2019 for example swat contains a simplistic gw algorithm that eliminates gw lateral flow and only considers storage for shallow and deep aquifers with hydrologic response units hrus therefore when a swat model is calibrated for streamflow the summation of gw return flow lateral flow and surface runoff the swat gw component does not generate a spatiotemporally high resolution gw return flow as a fully distributed model such as modflow does therefore when modflow replaces the swat gw component the new gw return flow changes the streamflow calibration performance necessitating a new model calibration likewise when swat replaces the recharge and river stage in modflow with spatiotemporally higher resolution values the modflow gw hydraulic properties must be recalibrated on the other hand the solution space the number of possible combinations of parameters of the integrated model is so vast that a manual calibration can hardly ever achieve the global optimum solution therefore an automatic approach is required to calibrate the integrated model in the gw modeling discipline gradient based calibration methods such as gauss marquart levenberg 1944 are the backbone of inverse modeling and historically have been used for calibrating gw models with the assumption of model linearity the gradient based methods evaluate the model performance for initial solutions and calculate the jacobean matrix followed by a few forward runs toward maximizing minimizing the objective function until a satisfactory model s performance can be achieved anderson et al 2015 the gradient based methods are sufficient for linear problems or the steady state gw model specifically for estimating gw hydraulic properties with regularization approaches doherty and hunt 2010 however the solution space for calibrating a gw sw model that simulates geochemical processes in the transient state is extremely multi modal and noisy this is mainly due to the high dimensionality of solution space the interaction among models parameters and several calibration targets therefore gradient based methods stagnate around a local optimum without a mechanism to escape the trap anderson et al 2015 keating et al 2010 mugunthan et al 2005 in contrast global based methods such as evolutionary algorithms do not rely on local derivatives to explore the objective function surface thereby offering a more robust approach in optimizing noisy multi modal problems rios and sahinidis 2013 for instance lyons et al 2020 compared the results from the pest software a commonly used gradient based calibration method with several metaheuristic global based optimizers for calibrating steady state gw heads they showed that the average error function with pest was an order of magnitude larger than any of the global based optimizers indeed in earlier studies the limits of computing power impeded the use of global based optimizers in calibrating hydrogeochemical models mugunthan et al 2005 however with the increase in the availability of high performance computers hpc and cloud computing services global based optimizers can be examined improved and applied to real world problems hayley 2017 metaheuristics are a branch of global based optimizers that take advantage of synthetic methods such as management of populations replication and variability to systematically identify the global optimum within a solution space sloss and gustafson 2020 the implementation of the metaheuristic search concepts has also been emerged in various forms to solve complex non linear optimization problems in water resources management hatamkhani and moridi 2019 janga reddy and nagesh kumar 2021 specifically the particle swarm optimization algorithm pso has been widely used in various hydrological modeling applications hatamkhani et al 2020 jahandideh tehrani et al 2020 however as the dimensionality of the solution space increases so does the number of local optimums in this condition metaheuristics in general and pso in particular rapidly lose their efficiency to discover the global optimum solution chen et al 2015 different methods were introduced to overcome the curse of dimensionality for example previous studies handled this problem by improving the searching techniques to avoid local exploitation jia et al 2011 slowing down the convergence e g li et al 2015 or reducing the range and number of parameters through sensitivity analysis song et al 2015 however each of these techniques can be ineffective when the model is highly non linear for example identifying sensitive parameters through applying linear regression or one at a time sensitivity analysis in a highly non linear model can be misleading saltelli et al 2019 saltelli and annoni 2010 thus a variance based sensitivity analysis should be employed which requires an exhausting number of model evaluations that cannot be carried out for a computationally demanding model such as swat modflow rt3d e g nossent et al 2011 nevertheless a calibrated gw sw model should be reliable in reproducing several outputs e g gw head streamflow and constituent load in streams meanwhile in a single objective optimization such as conventional pso an error function for measuring the performance of each model output should be included typically as the sum of all errors therefore the ambiguity in the sources of errors increases the number of local optimums in the landscape of the single objective function knowles et al 2001 under these circumstances decomposing the single objective function and employing multi objective approaches can to a certain extent reduce the local optimums efstratiadis and koutsoyiannis 2010 her and seong 2018 lu et al 2009 yazdi and moridi 2018 however in multi objective optimizations the probability of discovering non dominated solutions falls exponentially as the number of objectives rises ishibuchi et al 2006 as a result it is common to see a large number of model evaluations required for multi objective optimization to find the global pareto optimal front herman et al 2020 kamali et al 2013 therefore still more advanced and effective techniques are essential to limit the number of local optimums and overcome the curse of dimensionality here we introduce a new particle swarm optimization pso algorithm in which the swarm cognitive capacity is enhanced to constrain the number of local optimums in the calibration of gw sw models with high dimensionality the proposed algorithm multi memory pso mmpso is novel because in contrast to a single objective pso the learning strategy of the mmpso s particles relies on the prior information about the solution space and the attribution of parameters groups to the decomposed version of the single objective function or sub objective functions thereby particles can learn from several sub objective functions and optimize the gw sw models based on a catchment s geological sections as a result the dimensionality and the number of local optimums can be decreased resulting in an efficient searching approach to discover the global optimum solution in summary this research aims to develop an optimization approach that can handle the high dimensionality of a non linear gw sw model in a comparatively limited number of simulations to address this goal first we applied the swat modflow rt3d model to a tropical catchment that discharges to the great barrier reef australia with interconnected gw and sw systems then the following objectives were evaluated i the performance of the mmpso algorithm against the original pso in calibrating the model and achieving the global best while addressing the shortcomings of the pso algorithm and ii the reliability of the calibrated swat modflow rt3d model in identifying the source fate and transport of no3 within the study area and between gw and sw systems the algorithm developed herein is the first comprehensive calibration method for the swat modflow rt3d model 2 materials and methods 2 1 study area north johnstone catchment the great barrier reef gbr is the world s largest coral ecosystem extending over 2000 km from southeast to northeast australia the reef is damaged by a cumulative impact of climate change and non point source pollution from agricultural activities in the coastal catchments gbrmpa 2014 waterhouse et al 2017 evidence shows that the increase in the eutrophication extent and occurrences the duration of algal bloom and the outbreak of coral eating crown of thorn starfish cots are associated with the increased level of no3 concentration in streams draining to the gbr lagoon brodie et al 2005 fabricius et al 2010 this situation is alarming in the wet tropics region of the gbr as the catchments proportionally discharge the highest amount of no3 to the initiation zone of cots posing the greatest threat to the health of the reef the north johnstone river catchment 1000 km2 is in the wet tropics region northeast of queensland australia fig 1 the catchment has wet tropical climate conditions during austral summer december to april the weather is hot and humid with intensive rainfall and during the austral winter may to november the weather is temperate dry the rainfall gradient is remarkable across the catchment receiving more than 3 5 m annual rainfall in the low lying coastal zone in the east to less than 2 m in elevated areas in the west rafiei et al 2020 previous assessment of the likelihood of exposure of coral reefs to no3 indicates that the catchment is among the highest no3 contributors across the gbr waterhouse et al 2017 the hydrogeology of the north johnstone catchment consists of a deep soil profile and shallow fluctuating gw which can reach the soil surface at the lower aspects of the undulating topography hair 1990 the catchment has three geological sections the lower section coastal zone consists of unconsolidated surficial sediments and partially basalt aquifer systems the dominant land uses in the lower section are sugarcane banana grazing pasture and urban the middle section is covered by rainforest clad and formed weathered granitic mountains furthermore the upper section has a basalt gw aquifer system locsey 2004 hosting one rural town malanda and the dominant land use is grazing pasture with modified or native vegetative cover the gw layers of the catchment are highly stratified consist of thin layers of fractured rock with spatial variability in hydraulic conductivity and anisotropic hydraulic properties cook 2003 2 2 nutrient transport modelling 2 2 1 overview of swat modflow rt3d theory for this study we used a coupled swat modflow modeling code provided by bailey et al 2016 modified by wei et al 2019 to include the gw reactive transport in 3 dimensions rt3d model in the integrated model swat passes recharge from soils river stage from sub catchment streams no3 leaching from soils and no3 concentration in sub catchment streams from hrus and sub catchment streams to modflow grid cells for each daily step when modflow finishes solving the gw governing flow equation rt3d is called as a subroutine to simulate the no3 mass balance for each grid cell which includes no3 mass exchange between the aquifer and streams no3 mass passed from the aquifer to the streams is routed through the catchment stream network using swat routines wei et al 2019 the entire linking procedure including the technical aspect is described by bailey and park 2019 2 2 2 swat model for north johnstone catchment we established a swat model for the north johnstone catchment with 91 sub catchments and 1295 hrus further details of the land use map topsoil layer dataset are provided in fig s1 in the supplementary material three streamflow monitoring stations fig 1 are i tung oil station located at the end of the north johnstone river receiving runoff from 90 of the catchment ii the glen allyn station located at the upper section of the catchment receiving runoff from 16 of the catchment mainly from pasture areas and iii fisher creek station located at the end of a tributary channel in the lower section receiving runoff from one sub catchment equal to 1 5 of the catchment the summary of data used for establishing the swat model climate data dem map topsoil layers land use map watercourses and the sources of observational data for the calibration and model performance evaluation including daily streamflow and hydrograph separation filtering technique for baseflow daily gw head elevation and no3 loads in the stream is provided in table s1 in the supplementary material the details of planting harvesting evapotranspiration calibration and the parameterization of leaf area index of rainforests pasture plants sugarcane and banana for the swat model of the north johnstone catchment are described by rafiei et al 2020 further details of standard management practices and fertilizer usage in pasture and farmlands are described in section s1 2 2 3 modflow model for north johnstone catchment we established the gw model using usgs modflow nwt v 1 2 0 niswonger et al 2011 the model domain was discretized using 36 873 cells 244 columns and 154 rows with 250 250 m grid cell size resulting in 16 482 active cells within the catchment boundaries a 25 m dem map was used to represent the surface elevation data from 1443 boreholes across the region were employed to estimate the elevation of the aquifer base fig s2 the total estimated depth was discretized into three convertible hydro stratigraphic layers the thickness of the first layer was set equal to 33 of the total depth the second layer thickness equal to 22 of the total depth and the third layer equal to 45 of the total depth with the modflow upstream weighting upw package we divided the model active domain into three geological zones fig 1 we included the recharge and the river stress packages into the modflow model with the former set active to allow the passing of recharge from the swat hrus to the modflow grid cells and the latter set active to allow groundwater surface water exchange between modflow grid cells and swat sub catchment streams 2 2 4 swat modflow rt3d model input parameters and settings for the gw model important hydraulic properties include vertical hydraulic conductivity vhc horizontal hydraulic conductivity hhc horizontal anisotropy han specific yield sy and specific storage ss for each layer of the three geological sections one parameter corresponding to each hydraulic property was considered for the calibration resulting in 45 parameters the initial ranges of gw hydraulic parameters were obtained from the literature anderson et al 2015 batu 1998 river conductance rc and river bottom elevation rb are also critical hydraulic properties that control gw discharge to sw and influence gw head across the catchment typically we estimate rc by multiplying the river hydraulic conductivity to the area divided by the thickness of the river bed thereby for each of the three geological sections we considered one parameter for river bed hydraulic conductivity and one for river bed thickness the initial values for river bed thickness the river width and length were estimated by swat and used to estimate river cell conductance within modflow in the land phase of the swat model often the most critical variable that controls recharge to gw is the runoff curve number cn2 williams and laseur 1976 therefore we considered one cn2 parameter for each dominant land use type in the catchment grazing pasture rainforest and farmlands another critical parameter that controls recharge timing is the gw delay parameter that we included in the calibration regarding no3 cycling in soil the parameters considered for calibration are the denitrification exponential rate coefficient cdn the denitrification threshold water content sdnco and the no3 percolation coefficient nperc moreover a critical soil property that controls organic nitrogen mineralization is carbon content cc therefore we considered one cc parameter for each dominant land use in the calibration in the routing phase of the swat model sensitive parameters considered for calibration are the groundwater recession factor alpha bf manning s roughness of main and tributary channels and the hydraulic conductivity of main and tributary channels the rt3d model controls no3 fate and transport by the following parameters aquifer longitudinal dispersivity ld the horizontal and vertical anisotropy ratio of ld porosity of the gw layers bulk density of the gw layers and gw kinetic denitrification rate overall we included 78 parameters for the swat modflow rt3d model calibration the list of all parameters including their initial range is provided in table s2 we considered a three year warm up period 2009 2011 for the swat modflow rt3d model to set the model in a dynamic equilibrium cycle next the first three years 2012 2014 of monitoring data were used for calibrating the model and the last three years 2015 2017 were considered for model validation these periods were set for the model calibration validation and performance evaluation since i daily gw head monitoring for the catchment was initiated in 2010 but consistent data for the three gw stations are available only from 2012 ii the no3 monitoring station used to be in the tung oil station however since 2012 the monitoring station was moved to the goondi station to observe the no3 discharge from fertilizer intensive land use and iii in stream no3 concentration are available up to the first quarter of 2017 2 3 calibration mmpso optimization 2 3 1 particle swarm optimization pso algorithm the particle swarm optimization pso kennedy and eberhart 1995 is a stochastic optimization technique with roots in artificial life and social psychology pso is a swarm of particles that moves toward the best solution in an iterative manner in every iteration particles update the parameter position vector with two sociometric principles i the global best conceptually connects all particles so that the best performance of any particle influences the performance of the entire population and ii the local best creates a neighborhood for each particle to compare itself with the swarm global best thereby particles based on their current fitness their local best and the swarm global best update their velocity and position vectors with the following imitation function 1 v i t 1 ω v i t c 1 r 1 l i t x i t c 2 r 2 g t x i t x i t 1 x i t v i t 1 where t is the iteration number i denotes the particle number x and v are d dimensional position and velocity vectors l and g are the d dimensional local best and the global best position vectors c 1 and c 2 are learning factors originally c 1 c 2 2 respectively associated with the self belief and social belief components r 1 and r 2 are two random numbers within the range 0 1 and ω is the inertia weight with a range between 0 6 and 1 5 2 3 2 improvement strategies for pso the original pso algorithm has a fast converging behavior and in the absence of additional mechanisms particles stagnate around a local optimum solution therefore the swarm prematurely converges especially in complex large dimensional optimization problems with multi modal objective functions wang et al 2018 here we present steps to enhance the original pso algorithm and propose improvement strategies to address high dimensionality in calibrating gw sw models such as the swat modflow rt3d model used in this study sub swarm strategy to improve particle diversity to maintain particles solution diversity we adopted a multi swarm approach proposed by tanweer et al 2016 that in every iteration the particles are divided based on the euclidian distance and fitness difference into three groups called mentor independent and mentee each group has a specific learning strategy particles in the mentor group the best particles in terms of fitness have a more exploitative learning strategy with more weight on the self belief component of the original pso thereby velocity and position update functions of the mentor group are given by 2 v i t 1 ω v i t c 1 r 1 l i t x i t β 2 c 2 r 2 g t x i t x i t 1 x i t v i t 1 where β 2 is the self belief searching weight and equal to 0 5 the update strategy in the independent group has strong self belief and partial social belief given by 3 v i t 1 ω v i t c 1 r 1 l i t x i t c 2 r 2 p i t g t x i t x i t 1 x i t v i t 1 where p is a d dimensional self perception vector and denotes the element wise multiplication the p elements with the probability of 50 are either 0 or 1 particles in the mentee group having the least fitness possess explorative behavior by supdating their velocity and position vectors either with one of the mentor group members or rely on their self belief given by 4 v i t 1 ω v i t c 1 r 1 c s e l i t x i t c 2 r 2 s m e m t x i t x i t 1 x i t v i t 1 where m is a randomly selected local best position vector from the mentor group members and s m e and c s e are introduced to perform velocity update based on social belief or self belief therefore with a 50 probability the c s e and s m e are respectively either 0 and 1 or 1 and 0 enclosing searching space we adopted the damping boundary condition proposed by huang and mohan 2005 to enclose the searching space when a particle passes a boundary in any dimension the damping wall absorbs a proportion of the velocity and reverses the direction inertia weight strategy to avoid local optimum traps we adopted two different inertia weight strategies for the particles groups to avoid premature convergence we implemented a random inertia weight strategy eberhart and shi 2001 for the mentor and mentee groups to help the particles escape the local optimal traps for the independent group we adopted a ranking based inertia weight approach panigrahi et al 2008 to define the searching range of particles based on their relative position to the global best the more a particle is close to the global best the lower the inertia weight value is assigned to the particle proposed improvement to the velocity and position update equations of pso for calibrating gw sw models a gw sw model calibration aims to maximize the model performance for simulating several components including streamflow baseflow gw head and constituent loads and concentrations in streams in the conventional pso algorithm particles solely update their velocity and position vector with the best solution found for the overall performance of the components thereby given the presence of numerous local optimums and high dimensionality the swarm moves toward an undesirable solution space by maximizing the performance of several components at the expense of minimizing the others we can partially resolve this issue by finding an optimal weight for each component in forming the single objective function however if the calibration includes many parameters which is the case for a gw sw model the ambiguity in the sources of errors with using a single objective function adds to the number local optimum solutions to overcome this problem we propose the mmpso in which particles memorize the position vectors corresponding to n local sub objectives in the model application to the study region of the north johnstone river catchment we define the sub objectives by grouping components with similar response behavior based on the catchment s geological sections for this purpose we need to provide the algorithm with prior information about the attribution of each parameter to their sensitive sub objective function given the concept mmpso partially decomposes a calibration problem into several sub problems by dividing the position vector of particles into several sub groups in this condition the swarm attraction to the undesirable solution space becomes constrained and particles can move partially toward optimizing sub objective functions to implement the concept in the algorithm we modified the self belief behavior of the imitation function of equation 3 the independent group according to equation 5 we applied the modification only to the independent group to keep the exploitative and explorative behaviors of the mentor and mentee groups while improving the cognitive capacity of the independent group 5 v i t 1 ω v i t c 1 r 1 l i g t x i g t β 2 c 2 r 2 g t x i t x i t 1 x i t v i t 1 where g denotes the index of sub groups in a d dimensional position vector fig 2 conceptually illustrates how a particle in the independent group of mmpso estimates its future position the dashed circle in comparison to a particle in pso both based on their current position the green circle and previously experienced positions blue circles we excluded the impact of the swarm s global best the social belief on determining the future position in this comparison to emphasize the difference between the self belief behavior in pso and mmpso the particle in its current position experienced three other positions in the solution space of the total objective function which can be decomposed into two sub objective functions fig 2 a i fig 2 a ii the particle in the mmpso estimates its future position using the resultant velocity vectors toward the fittest experienced positions in the solution space of sub objective functions fig 2 a iii whereas the particle in the pso chooses its future position based on the fittest experienced position in the solution space of the total objective function fig 2 b i that is far from the global optimum solution fig 3 illustrates the flowchart of the mmpso algorithm the calibration starts by initializing mmpso parameters including the range of inertia weight number of particles maximum number of iterations termination criteria model parameters parameters range and the number of initial executions with latin hypercube sampling lhs next the algorithm runs the particles in parallel it updates velocity and position vectors after each iteration until it meets the maximum number of iterations or other termination criteria moreover a maximum model simulation run time was also defined for the algorithm to avoid embarrassingly parallel workload by terminating the simulation in the event that the modflow solver engine does not converge to a solution of groundwater head 2 3 3 calibration function and model performance evaluation criteria a calibration function comprising a summation of the error terms normalized by a baseline condition such as the average of observations is often used for calibrating hydrological models examples of benchmark calibration functions are nash sutcliffe efficiency nse percent bias pbias mean average error mae mean square error mse coefficient of determination r 2 and root mean square error rmse althoff and rodrigues 2021 moriasi et al 2007 however depending on the error exponent value and normalization formula any individual function leads the optimization algorithm to emphasize different response modes in the calibration hernandez suarez et al 2021 moriasi et al 2015 for instance in catchments with high variance in streamflow using the nse function leads to having significant volume balance errors gupta et al 2009 in addition by using the average error functions e g mae or mse or rmse negligible improvement occurs when the mean of simulations is near the mean of the observations causing numerous local optimum solutions to tip the balance here we used a maximization function based on a combination of r 2 and mse with scaling factors given by equation 6 6 o i s t r 2 s α m s e s o f j i 1 n o i t o f j 1 m s o f j where s t and s α are scaling factors o i is the objective function of ith component s o f is the sub objective function j denotes the sub objective function s number n is the number of components o i in a sub objective function and m is the number of sub objectives t o f is the total objective function which is the summation of all sub objectives the range of the function o is between and s t and the perfect match between the observations and simulations is equal to s t the scaling factors s t and s α are problem specific that need to be adjusted based on the magnitude of the standard deviation of mse of a component to evaluate the daily and monthly model s performance in simulating no3 loads and streamflow baseflow we used the recommendations defined by moriasi et al 2015 table s3 regarding the model s performance in simulating gw head elevation no established guidelines specify the acceptable magnitude of the average error functions anderson et al 2015 merz 2012 however based on the observations from previous studies with swat modflow that reported statistical indexes for gw model performance acero et al 2019 acero triana et al 2020 guevara ochoa et al 2020 qi et al 2019 we defined nse as more than 0 3 and mse less than 1 m square error as the bottom line forsaccepting rejecting model performance table s3 2 3 4 grouping the parameters and forming the sub objective functions based on our knowledge of the catchment we define the sub objective functions and parameters groups as follows 1 the first sub objective function considered three components related to streamflow at tung oil fisher creek and glen allyn stations fig 1 next the parameters including cn2 of forests farmlands and pasture plus the alpha bf the manning s roughness and hydraulic conductivity of tributary and main channels were grouped for this sub objective function 2 the second sub objective function comprised two components related to gw head elevation at millaa millaa and glen allyn stations plus one component related to the baseflow at the glen allyn station all in the upper section of the catchment the modflow river parameters and gw hydraulic properties of the upper section of the catchment were grouped for this sub objective function 3 the third sub objective function contained one component related to gw head elevation at goondi station and two components related to baseflow at fisher creek and tung oil stations all in the lower section of the catchment the modflow river parameters and gw hydraulic properties of the middle and lower sections of the catchment were grouped for this sub objective function 4 the fourth sub objective function selected one component related to no3 loads at tung oil station the parameters including the organic carbon content of the topsoil layers of the forests pasture and farmlands plus the cdn sdnco and nperco the porosity of the gw layers the ld of the three layers the horizontal ratio of ld and vertical ratio of ld and the bulk density and denitrification kinetic rate were grouped for this sub objective function 2 3 5 gw initial head and penalty function as the initial head of gw is unknown and insufficient spatial gw head observations are available across the case study a technique for estimating the initial head is included in the algorithm and described in the supplementary material section s2 additionally due to the insufficient number of observation wells especially for the middle section of the catchment the accuracy of gw heads in some regions is unknown this is a common problem for gw models applied to large scale systems with a scarcity of gw data acero et al 2019 to avoid solutions that result in unrealistic gw heads we defined an exponential penalty function further details of the penalty function are described in the supplementary material section s3 2 4 parameter uncertainty analysis mmpso starts the optimization from the given initial ranges of parameters the algorithm eventually converges to smaller search space by estimating the gaussian kernel density of parameters and then limiting parameters ranges to their respective 95 percentile of the density distribution we can find the parameter space s subsequent domain toward each parameter s final range we then use the estimated final range for conducting the parameter uncertainty analysis lhs is the standard method for preparing the input parameters for parameter uncertainty analysis after carrying out 10 000 simulations with lhs two indexes p factor and r factor were used to measure and quantify the uncertainty and errors resulting from the model abbaspour et al 2004 it should be noted that 10 000 simulations were enough as we observed that the regression to the mean happened and the model output variance could be said to be converged p factor is the proportion of observations falling within the 95th percentile of simulations and the 1 p factor can be referred to as the model error r factor is the thickness of the 95th percentile of the simulations calculated by equation 7 7 r f a c t o r i 1 n s i m 97 5 i s i m 2 5 i n σ o b s where s i m 97 5 i and s i m 2 5 i are the upper and lower bands of 95 percentile of simulations n is the number of time steps and σ o b s is the standard deviation of observations for flow and no3 loads a p factor close to 1 and r factor below 1 5 indicates an acceptable performance of the parameter uncertainty in the model abbaspour et al 2007 for gw head a desirable p factor is 1 2 5 allocated computational resources and optimization termination criteria the calibration was undertaken using an hpc cluster with the rhel 8 2 operating system and 100 1 tflops performance the cluster had 24 compute nodes each having 1 tb ram and 2 64 cpu cores amd epyc 7452 with a clock speed of 3 3 ghz we used one node and allocated 64 processors 400 gb ram and 1 tb storage for calibrating the model with 45 parallel workloads in pso mmpso the average calibration time for 200 iterations with 45 parallel workloads in the hpc was 70 h termination criteria are defined to halt the optimization based on 1 the maximum number of iteration or 2 the amount of advancement in the swarm s global optimum solution in regarding the first criterion the optimization stops after 200 iterations concerning the second criterion the process halts when no advancement in results is observed after 50 iterations 3 results and discussion 3 1 comparing mmpso performance with the original pso fig 4 shows the global and local convergence of 45 particles in mmpso and pso within 200 iterations with the first five iterations based on lhs we carried out the calibration three times with each algorithm and selected the best performances for relevant comparison as shown in fig 4b both algorithms had close progress within the first 25 iterations after that pso particles stagnated around a local optimum and could not improve the global best within the last 50 iterations on the other hand the mmpso particles constantly improved the global best until the maximum number of iterations was met more importantly the mmpso swarm escaped local optimum traps specifically at the 50th and the 100th iterations eventually while pso particles converged to one local optimum solution the mmpso maintained the diversity of solutions throughout the calibration this aspect of the mmpso is valuable because we can use the final local best solutions as the input for a subsequent optimization run with or without different weights on the sub objective functions to achieve the best performance for all the simulation components as explained before the mmpso particles use sub objective functions to constrain the swarm attraction toward undesirable solution space however the extent to which the algorithm can quickly find the attraction area around the global optimum solution is influenced by the scaling factors in the calibration function given by equation 6 although finding the best scaling factors s α and s t is a problem specific issue a general rule can be applied to normalize the impact of each component on the variance of the summation of components for example through an uncertainty analysis we quantified that the mean and standard deviation of the mse for streamflow at tung oil station was respectively 55 times and 100 times larger than the same error index for streamflow at glen allyn station therefore the s α of the tung oil streamflow calibration function was set at 0 05 to normalize the impact of this component on the variance of the total objective function likewise the mean and standard deviation of the mse for the gw head at millaa millaa station was 20 times and 35 times larger than the gw head in the glen allyn station however as discussed gw head calibration functions were better normalized with weighting s t than s α hence we considered s t values for glen allyn and millaa millaa gw head elevations 100 and 25 nevertheless the highest value found for the total objective function satisfying the model performance criteria for all simulation components was 80 of which the mmpso reached 53 in the first run with 200 iterations 3 2 swat modflow rt3d performance and evaluation criteria table 1 summarizes the daily and monthly performance of the swat modflow rt3d model based on statistical indexes fig 5 shows the model s calibration and validation periods performance for simulating gw head elevation at goondi station and streamflow at tung oil station the rest of the hydrographs for other stations are provided in figs s4 s5 s6 and s7 the daily and monthly model s streamflow performance is very good for all stations except a satisfactory performance for the daily streamflow simulation at fisher creek fig 5 s4 and s5 compared to other north johnstone catchment studies that used the swat model rafiei et al 2020 zhang et al 2020 the swat modflow considerably improved streamflow simulation performance the pbias for tung oil station is improved from 8 5 to 2 71 the pbias for glen allyn station is improved from 21 8 to 3 3 and the pbias for fisher creek improved significantly from 42 2 to 1 70 regarding the model s performance for simulating baseflow statistical indexes showed a very good performance for fisher creek a good performance for the tung oil station and a satisfactory performance for glen allyn however the baseflow in glen allyn station on both daily and monthly showed an overestimation in the low flow period for instance while the recorded baseflow at glen allyn station goes down from a maximum of 14 m3 day in the wet season to 0 5 m3 day in the dry season the modflow model generated a constant value of 2 m3 day for the low flow period this overestimation was systematic with a p factor of 0 57 which is the lowest p factor among all other components however no systematic error was found for baseflow at the fisher creek as the p factor is 1 and the simulation model reproduced both peaks at storm events and low flow rates at dry period one possible reason for the overestimation of baseflow in low flow periods was reported by werner et al 2006 in a tropical catchment of gbr similar to this study werner et al 2006 used a fully integrated gw sw model for simulating baseflow and gw head they concluded that the riparian vegetation water use could cause the overestimation due to the high amount of water consumption of up to 0 5 ml day among three gw head observation stations goondi station reached an nse of 0 75 millaa millaa 0 65 and glen alyn 0 58 plus the mse values for all gw stations were below 60 cm square error thus the model well reproduces the response of the gw system to external stresses fig 5 s6 and s7 plus the model simulated the seasonal and interannual trends of the gw heads with acceptable errors liu et al 2020 used a gradient based approach pest to calibrate swat modflow the results of calibration range from 0 42 0 84 for r 2 and 2 35 and 3 66 for pbias meanwhile in our case the r 2 for glen allyn station is 0 72 and pbias is 0 031 r 2 for goondi station is 0 80 and pbias is 7 3 r 2 for millaa millaa station is 0 80 and pbias is 0 021 moreover the p factor for all gw stations is 1 and the r factor ranges from 4 56 to 16 96 the nse for no3 loads at the goondi station for the three year calibration period was 0 59 with pbias of 0 4 for the validation period the nse was 0 28 with pbias of 11 thus in terms of statistical performance the model s ability to simulate no3 loads in the streams is very good comparing results with a study carried out by swat modflow rt3d in an irrigated semi arid watershed wei and bailey 2021 achieved an r 2 value of 0 65 and nse value of 0 51 for no3 loads in the stream for the calibration results however it appears that the model prediction ability for higher values is more robust than smaller ones in the range of 10 kg day to 1000 kg day fig 6 wei and bailey 2021 also reported a similar observation regarding the overestimation of no3 loads in the low flow period however we should emphasize that various epistemic sources of uncertainty often influence the calibration of any hydrological model for no3 loads therefore p factor and r factor should be included in the model evaluation as robust indices for assessing the reliability of the simulation results abbaspour et al 2007 the r factor and p factor fig 7 for no3 loads are respectively 0 86 and 0 76 both illustrating an excellent level of uncertainty and indicating the simulations capture the majority of observed no3 loads p factor 0 75 with a narrow envelope r factor 1 3 3 sources fate and transport of no3 in the north johnstone river catchment the modeling results show that the catchment average of no3 contribution from surface runoff was 1 80 kg ha year lateral flow contributed 0 37 kg ha year gw aquifers contributed 1 16 kg ha year and 0 14 kg ha year seeped from the catchment s stream network to gw aquifers predictive uncertainty analysis of no3 loads from gw and sw and their exchange for the catchment is illustrated in fig 8 the range of uncertainty regarding the surface no3 contribution to the stream is higher than the no3 loads from gw and the lateral flow the higher uncertainty range in no3 loads from sw runoff indirectly implies the higher availability of no3 loads in the topsoil layer and the faster mechanism for no3 removal from surface runoff to streams than the removal and transport mechanisms in the gw systems fig 9 shows the spatial pattern of the long term average of gw head elevation gw recharge and gw no3 concentration across the catchment for the model evaluation period gw heads follow the topographic elevation with no unrealistic head fig 9a the highest gw no3 concentrations occur under sugarcane and banana intensive areas in the low lying coastal zones with the annual no3 concentration ranging from 0 9 to 2 7 mg l fig 8c fig 9d shows the daily simulated gw no3 concentration for the goondi station located in fertilizer intensive sub catchment the gw no3 concentration increases to 2 25 mg l in the wet season and drops to 0 5 mg l by the end of the dry period a similar dynamic in gw no3 concentration with a variation from 1 7 mg l in the wet season to 0 023 mg l in the dry season has been reported for sugarcane intensive areas in the region rasiah and armour 2013 3 4 the hydrogeochemical characteristic of the shallow aquifer in the agriculturally dominated area as illustrated in fig 9 and discussed above the intensive fertilizer application area in the lower section shows a higher gw no3 concentration than the rest of the catchment the results also show that the gw no3 concentration does not increase over a long term period fig 9d similar to our finding armour et al 2004 reported a zero net accumulation of gw no3 concentration over the last 40 years however whether this zero net no3 accumulation results from gw transmisivity or a fast biodegradation process requires a closer look into the shallow aquifer characteristics the surface elevation of the goondi station in the lower section is 4 2 m above sea level and the gw head fluctuates between the elevation of 1 2 m and 8 36 m hence the aquifer condition in the rainy summer is confined while in the dry winter is unconfined the specific storage for the confined period is estimated at 5 5 10 5 1 m and the specific yield is 6 5 10 3 the relatively higher specific storage and low specific yield imply that the gw in the confined condition can retain and release a more significant water volume in the rainy season than the dry season additionally the shallow aquifer s horizontal and vertical hydraulic conductivities were estimated respectively at 17 5 m day and 0 016 m day exhibiting a vertical anisotropy ratio of 0 001 based on these numbers and the 12 m thickness of the gw layer the transmissivity of the aquifer is 210 m2 day and the vertical hydraulic resistance of the aquifer is 750 days also the lag time between the rainfall event and the increase in the gw table gw delay variable is estimated at four days therefore the relatively higher specific storage low gw delay high vertical resistance and fast transmissivity create a condition in which the no3 transport cycle is relatively fast between sw and gw this is more pronounced in the rainy seasons when the recharge is intense and the accumulated no3 near the soil surface can percolate to the gw and flush out to the main channel our finding is consistent with rasiah and armour 2013 they showed that the solute transport from gw to streams is relatively fast due to the high recession water table and lateral flow transmissivity however rasiah and armour 2013 emphasized that although the hazard associated with the gw no3 concentration level might be high the risk depends on several unresolved issues such as distinguishing the transmissivity and biodegradation processes that determine the residence time of no3 in the gw from our modeling results we estimate that the denitrification rate is 0 04 day 1 which corresponds to a half life of 17 6 days therefore the short half life of no3 plus a low value for specific yield can suggest that a suitable condition for denitrification in the dry season is available in the shallow aquifer however the spatial variability in the gw no3 contribution to sw fig 10 a shows heterogeneity in gw no3 response to the stream across the catchment the average annual gw no3 loads from most sub catchments fall between the 90 percentile average annual distribution range 5 69 to 3 16 kg ha year with minus values indicating no3 that seeped from streams to aquifers however in the lower section the sub catchments with intensive fertilizer application contribute between 3 16 and 9 62 kgno3 ha year to streams this variation in gw no3 loads depends on the area allocated to sugarcane and banana productions plus the extent of the land and river connectivity to the gw system therefore extracting the sub catchment with the highest annual gw no3 loads to the stream fig 10b which also encompasses the main channel better reveals the shallow aquifer s characteristic the interaction of gw sw and the impact of fertilizer intensive land use at the vicinity of the river on total no3 loading to the reef the extracted sub catchment average annual gw no3 load is 9 62 kg no3 ha year eight times higher than the catchment s average annual gw no3 loads the daily no3 load from the sub catchment ranges from 9 8 kg day in the low flow period to 57 kg day in storm events the mean and standard deviation of gw no3 loads from the sub catchment are 20 9 kg day and 7 6 kg day more importantly the gw flow and gw no3 loads have a correlation of 0 5 indicating a similar dynamic between the gw flow and gw no3 loads to stream therefore it emphasizes that the leading mechanism for no3 removal in confined conditions is the aquifer s transmissivity rather than biodegradation it is well known that no3 leaching to gw mainly occurs due to excess fertilizer application rasiah et al 2003 numerous studies for the region have proposed mitigation measures such as improving the efficiency of fertilizer applications based on soil characteristics crop rotation and trash blanket fraser et al 2017 schroeder and bureau of sugar experiment stations qld 2007 webster et al 2012 however these measures have not been widely adopted by farmers various social and economic factors such as the fear of future financial insecurity the power of mills over growers the lack of incentives and farmers concerns over equity issues explain the slow pace of adopting these practices benn et al 2010 in addition farmers do not want to take land out of production giri et al 2016 therefore using mitigation strategies that do not take lands out of production can improve overall adoption of best management practices for example supplementary management practices that use in situ biological remediation for increasing denitrification in the topsoil layer in the dry season to reduce the chance of no3 leaching or ex situ engineered remediation systems for capturing runoff from streams and filtering out no3 during the flushing events should be investigated through whole system gw sw analysis wallace and waltham 2021 4 conclusions calibrating models is a crucial step in predicting the system response to external stresses however with the growing complexity of gw sw models new calibration approaches for reducing dimensionality and local optimum solutions are essential global based optimization techniques are practical tools for searching the solution space but similar to gradient based methods both stagnate around local optimum traps when the model is non linear and associated with high dimensionality here we demonstrated a novel approach that can break a solution space of a large scale gw sw model into several geological sections to overcome the dimensionality and reduce local optimums therefore by implementing the concept in pso and accompanying the algorithm with the sub swarms concept the new algorithm mmpso showed a marked improvement in finding the global best solution the swat modflow rt3d model provides a robust approach for quantifying and identifying no3 sources and simulating gw sw interaction at a catchment scale the modeling results using mmpso indicated a considerable improvement in the streamflow prediction compared to previous swat modeling attempts that used surrogate parameters for the gw system the reliability of the model performance was also cross validated with other studies furthermore the model can account for agricultural effects on gw quality including the physical and biophysical processes involving no3 removal in the gw system accordingly the model can provide physical details about the critical aquifer characteristics required for planning and managing the interconnected gw sw system on a large scale regarding nutrient water quality particularly in relation to no3 loading to the sensitive great barrier reef ecosystem our assessment of the shallow aquifer of the region shows that the surficial gw system under the fertilizer intensive land use contributes up to eight times higher no3 loads to streams than the catchment average in particular we found a similar dynamic between the gw flow and no3 loads with a correlation coefficient being 0 5 furthermore our results showed that due to the relatively high specific storage high transmissivity and strong vertical flow resistance in gw the exchange of no3 and flow between the gw and sw is relatively fast this finding is significant in the rainy season and shows that the gw aquifer tends to flush out percolated no3 although the vertical and horizontal heterogeneity of the gw aquifer properties in the region is quite considerable our results provided an insight into the influential role of gw in planning management practices that need to be considered in further studies for the region here we focused on developing a calibration method using the pso as the basis for searching the solution space however the concept for dividing the solution space can be applied to other vector based evolutionary algorithms therefore future work can investigate whether accompanying this concept with similar searching tools such as artificial bee colony or gray wolf optimization algorithms can further speed up the model s calibration with fewer iterations 5 software and data availability we implemented the algorithm with python version 3 8 3 the code consists of one main body and 55 python functions for writing different inputs of the swat modflow rt3d model reading outputs plotting advanced figures checking unrealistic heads adjusting initial gw heads and conducting uncertainty analysis on the model output also as the particles are independent in each iteration we implemented parallel processing which can significantly speed up the calibration process depending on the available computational capacity the algorithm at this stage can be used for calibrating both swat and modflow independently or simultaneously the algorithm developed herein is the first comprehensive calibration method for the swat modflow rt3d model it should also be noted that the swat modflow rt3d is only available for windows operation systems however we recompiled the source code for the linux operating systems of high performance computers which is available in the package at https github com vahidr32 swat modflow rt3d calibration code with mmpso approach git declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the first author gratefully acknowledges the university of southern queensland usq for providing the fee and stipend scholarship for conducting his ph d research this research was undertaken using the university of southern queensland usq fawkes hpc we wish to thank mr torben marcussen of the usq centre for applied climate science for his technical assistance in recompiling the swat modflow rt3d source code for linux operating system we also thank dr francis gacenga from the usq office of research for facilitating our access to the usq high performance computing systems we thank the state of queensland department of environment and science for providing no3 monitoring data appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105312 
25639,this work introduces sentinel 1 based inland water dynamics mapping system sims an open source web application developed to enable automated mapping of inland water dynamics using sentinel 1 radar imagery sims relies on a novel framework built using python and google earth engine the underlying algorithm involves a simple binary thresholding technique and an outlier removal method tailored to perform efficiently across complicated flow regimes results can be downloaded as numerical data or as time series of shapefiles representing the variation of inland water extents exported geospatial datasets aid the pre launch study of future surface water and ocean topography swot mission which is expected to deliver hydrological measurements at unprecedented spatial resolutions classification metrics are evaluated at 20 validation sites across the globe using sentinel 2 based modified normalized difference water index mndwi images as reference results indicated high overall accuracy ranging from 84 16 to 99 47 for lakes and 87 23 98 96 for rivers keywords sentinel 1 swot inland water dynamics web application python google earth engine software availability name of the web application sims developer manu k soman year of first official release 2021 program language python hardware requirements pc minimum system requirement web browsing capability availability https sims toolkit herokuapp com github repository https github com manuks481 sims webapp git 1 introduction inland waters are one of the essential natural resources affecting sustainability of terrestrial life on earth brönmark and hansson 2002 monitoring changes in inland water are of paramount importance considering their direct interaction with the ocean and atmosphere through horizontal and vertical mass fluxes papa et al 2008 accurate quantification of variations in inland water extents can provide salient information on relevant hydrological variables like runoff precipitation evaporation and infiltration the spatial and temporal dynamics of inland waters play a vital role in understanding the hydrological cycle bullock and acreman 2003 land atmosphere energy balance krinner 2003 and surface groundwater dynamics winter 1999 the dynamics of inland waters particularly rivers have huge impacts on regional floods and droughts and remain crucial to an efficient inland waterbody management system in addition to natural processes surface water extents information can also serve as a direct indicator of anthropogenic activities that alter natural dynamics making it important to scientists and policymakers equally alike with increasing variability in regional climate surface water observations at high spatial and temporal resolution are critical in capturing the short term variabilities especially in the case of highly braided river channels conventional in situ monitoring of surface water are limited by poor spatial coverage inconsistent temporal frequency making many regions data scarce remote sensing offers an upper hand to overcome most of these limitations using satellite based earth observation data which provide synoptic view of earth at unprecedented spatiotemporal resolutions however the advances in remote sensing technology have led to a rapid growth in the amount of data acquired by satellite sensors resulting in severe demands of high storage requirements long term or planetary scale analysis using satellite imagery would essentially require systems capable of handling big data and computationally intensive data processing developments in high performance cloud computing platforms like google earth engine gee has made a huge breakthrough by providing open access to petabytes of satellite imagery with on the fly processing capabilities powered by google s cloud infrastructure gorelick et al 2017 this has led to seamless data access from space agencies enabling effortless implementation of computationally intensive analysis at regional global scales examples include the landsat collection 1972 to present from national aeronautics and space administration nasa and sentinel datasets 2014 to present from the european space agency esa additionally gee also provides javascript and python application programming interfaces api offering vast possibilities for developers to create gee based customized web applications several studies have utilized the potential of gee to develop a variety of applications tools and datasets related to surface water monitoring pekel et al 2016 presented the global surface water explorer a gee based web mapping tool that uses more than three million landsat images over the past 3 7 decades to map the long term changes in surface water extents at a global scale a similar tool was developed recently by pickens et al 2020 for providing global scale inter annual and intra annual inland water dynamics using landsat imagery from 1999 to 2018 applications that facilitate customized surface water mapping based on a user defined area of interest are also available currently a latest product in this sector is the gee application developed by rad et al 2021 which uses landsat imagery from 1984 present to generate 16 day time series of water spread area information an example of open source surface water dataset is the water bodies fraction product derived over india using resourcesat 1 satellite by the national remote sensing centre nrsc indian space research organisation isro subramaniam et al 2011 global surface water datasets of high temporal resolutions were also developed recently using moderate resolution imaging spectroradiometer modis satellite to capture inland water body dynamics at daily timescales klein et al 2017 ji et al 2018 however the scope of these products remains confined to large scale water bodies owing to coarse spatial resolution of modis imagery 250 m 500 m in spite of the availability from multiple global and regional surface water products capturing surface water dynamics using optical sensors remains extremely challenging considering their inability to penetrate clouds this results in large underestimation of surface water extents especially in the case of short duration events over dynamic water bodies like rivers hence there is a compelling need to develop a consistent inland water monitoring framework capable of capturing even the short term temporal dynamics of narrow water bodies microwave remote sensing has a huge impact on surface water monitoring considering their unique capabilities over other spectral regions microwave signals emitted by satellites possess exceptional cloud penetration capabilities reduced sensitivity to atmospheric aerosol contamination and are independent of solar illumination effects thereby providing consistent observations of the earth s surface independent of weather conditions and time of day with the availability of active microwave sensors like synthetic aperture radar sar satellites are capable of delivering earth observation data at very high spatial resolutions crucial for regional scale studies long et al 2014 existing literature demonstrate a number of methods that exploit the scattering mechanism of sar sensors to map surface water extents some of the commonly adopted methods include simple pixel based thresholding martinis et al 2015 tsai et al 2020 nair and indu 2020 thresholding on multi temporal sar backscatter metrics santoro and wegmüller 2014 santoro wegmüller lamarche et al 2015 santoro wegmüller wiesmann et al 2015 backscatter and incidence angle based probability distribution methods using long term sar training dataset westerhoff et al 2013 statistical morphological and machine learning integrated approaches shen et al 2019 etc researchers have also explored the potential of sar sensors in extracting temporal dynamics of surface water extents using thresholding based methods brisco et al 2009 bolanos et al 2016 cazals et al 2016 schlaffer et al 2018 machine learning techniques wang 2004 reschke et al 2012 pham duc et al 2017 water land edge detection techniques ding and li 2011 etc among the available sar based surface water products only a few are made publicly available like the water bodies information system wbis nrsc 2019 and the global inundation extent from multi satellites giems aires et al 2017 wbis is a web based geographic information system gis portal hosted by national remote sensing centre nrsc isro to provide downloadable temporal information on water surface area of a predefined database of lakes and reservoirs in india giems on the other hand provides global scale surface water extents information at a high spatial resolution of 90 m and at a monthly time scale from 1993 to 2007 apart from sensor specific algorithms there also exists a number of studies demonstrating the potential of multi sensor fusion techniques for surface water delineation ahmad et al 2020 druce et al 2021 irwin et al 2017 rao et al 2019 they follow a synergistic combination approach that can benefit from individual sensors strengths while mitigating their weaknesses however the computational demands of such methods are much higher than single sensor based approaches to date there exists a lack of efficient open source platforms to analyse highly dynamic narrow water bodies like rivers though sar based methods applied to specific regions are available pham duc et al 2017 tsai et al 2020 to the best of author s knowledge no tools have been developed by now with the capability to export temporal information of inland water extents as shapefiles shp for further research in geospatial applications this is highly relevant especially in the context of the upcoming surface water and ocean topography swot mission which is a joint mission between nasa centre national d etudes spatiales cnes canadian space agency and the united kingdom space agency with the latest wide swath altimetry technology onboard swot is expected to deliver point cloud observations of water surface elevations wse at unprecedented spatial resolutions capable of observing water bodies larger than 250 m 250 m and rivers as narrow as 100 m biancamaria et al 2016 combining synthetic swot measurements with geospatial information on inland water dynamics would immensely aid the pre launch study of swot mission keeping these points in mind the present study introduces an open source web application called sentinel 1 based inland water dynamics mapping system sims that facilitates automated extraction of temporal dynamics of surface water extents particularly rivers lakes and reservoirs the sims toolkit is built entirely using python and gee and is capable of generating on demand regional products based on a user defined area of interest and time period the processing method relies on a simple thresholding technique using the freely available analysis ready sentinel 1 sar dataset hosted in gee powered by the consistent observation strategy and high spatial resolution of sentinel 1 the sims toolkit can measure all inland water bodies larger than 400 sq m at sub monthly timescales potential enough for regional scale research applications the remaining contents of the paper are organized as follows section 2 discusses the data utilized in the sims toolkit section 3 presents the implemented methodology framework section 4 gives a brief overview of the application environment and user interface of sims tool section 5 gives a practical guidance to the toolkit with illustrated examples on various challenging situations section 6 discusses the reliability of results generated by sims toolkit and the relevant stakeholders section 7 gives the conclusion and future scope of the work 2 data the sims toolkit utilizes sentinel 1 satellite datasets which are available in gee sar imagery collection the sentinel 1 mission comprises a constellation of two radar satellites sentinel 1a and sentinel 1b launched by esa in april 2014 and april 2016 respectively each of these two satellites have a temporal resolution of 12 days whereas a 6 day repeat frequency can be achieved near the equator with both datasets microwave signals are emitted by sar sensors at off nadir angles towards the earth s surface the transmitted energy gets reflected off various ground targets a fraction of which is collected by the receiver the collected data is stored in the form of a two dimensional image wherein each pixel represents the return echoes from the corresponding ground location the intensity of backscatter signal depends on dielectric and geometric properties of the target ground targets like water with its smooth surface and high dielectric constant follows a specular reflective nature resulting in the reflection of transmitted energy away from the sensor which consequently leads to very low backscatter received at the sensor devries et al 2020 this property of radar signals is utilized in delineating water bodies from the surrounding rough terrains however the method is prone to misclassification errors of omission in presence of inundated vegetations rough or wavy water surfaces during windy conditions and ice cover white et al 2015 moreover the side looking geometry of sar sensors is subject to geometrical distortions like layover and shadow effects that can result in omission and commission error of water pixels respectively mason et al 2010 sentinel 1 carries a single c band imager which operates at a central frequency of 5 405 ghz with four acquisition modes stripmap sm interferometric wide swath iw extra wide swath ew and wave mode wv torres et al 2012 each of these modes possesses different acquisition strategies swath widths and spatial resolutions among the available modes iw mode is the default operational mode over land acquired at incidence angles between 31 and 46 images captured in iw mode have a wide swath of 250 km and a very high spatial resolution of 5 m 20 m making it one of the best choices for land cover studies huang et al 2018 moreover with a pixel spacing of 10 m sentinel 1 iw mode can detect all surface water bodies having an area larger than 20 m 20 m products under the sentinel 1 iw mode category are available as single or dual polarized sar data the polarizations that are particularly relevant in the context of presented work are the co polarized vertically transmitted and received vv data and the cross polarized vertically transmitted and horizontally received vh data both vv and vh polarizations have distinct scattering mechanisms over open water surfaces allowing potential delineation of water bodies from the surrounding land surfaces even though the scattering principle of vv and vh polarization are comparable there exists significant variabilities in their backscattered energy owing to difference in the backscattered polarizations for vh polarization underestimation of the expected surface water extent was found to be comparatively less due to its lower sensitivity to snow cover and high surface water roughness wan et al 2019 in spite of the advantages that vh polarization offers there exists a major drawback limiting its application in most areas vh polarization has larger backscatter variability which results in potential misclassification of pixels between open water and land twele et al 2016 such situations are particularly evident in highly braided dynamic river channels agricultural areas and densely vegetated wetland areas where lower sensitivity of vh polarization can lead to large overestimation of water similar situations can also occur over man made objects like building tops roads etc wan et al 2019 unlike vh polarization vv polarization has very low probabilities of misclassification due to its narrow backscatter variability since the error contribution due to underestimation is comparatively much lower than the error induced by misclassification vv polarization was selected for water classification in the developed sims web application we use the level 1 ground range detected grd sentinel 1 vv polarized sar data iw mode which is available ready to use in gee after radiometric calibration and terrain correction fig 1 shows a sample sentinel 1 vv polarization image as visualized through the interface of gee the image is captured over the indira sagar reservoir in madhya pradesh india on 6th jan 2021 the polygon drawn over the image represents an area of interest aoi used for visualizing the backscatter variability of vv polarization through gee see fig 2 the histogram of vv polarization backscatter coefficient σ exhibit a bimodal distribution with a clear demarcation between water and non water features allowing potential classification of water by binary thresholding liang and liu 2020 in this technique a pixel is labelled as water if the magnitude of vv polarization backscatter is lower than a predefined threshold value 3 methods the sims tool is built using a comprehensive framework supported by python and gee allowing users to generate information regarding the temporal variation of surface water extents specifically inland water bodies involving lakes reservoirs and rivers the workflow of computational processes which drives the application is presented in fig 3 the application primarily requires two user inputs a user defined aoi and a time period of analysis in addition the tool also allows user to select the number of polygons to be used for defining maximum extent water mask for the initial run it is recommended to set this field to its default value 1 which can be modified later as per the requirements of study area a detailed illustration regarding this option is provided under section 5 the computational process starts with the extraction of sentinel 1 vv polarization backscatter images from gee corresponding to the user defined aoi and time period images captured on the same day are mosaicked thereby allowing the user to process larger water bodies spread across multiple sentinel 1 images in order to minimize computational load the mosaicked collection of images are clipped to the aoi and only those images which cover the entire aoi are used for further processing the reduced image collection are then subjected to a noise filtering algorithm called speckle filtering to remove the granular noises in raw sar image dasari et al 2016 the filtered images are then classified for water using a binary thresholding technique as discussed in section 2 with the motive of automating the classification process through an optimal data driven approach otsu s thresholding technique was selected otsu 1979 the algorithm assumes a bimodal pixel distribution and calculates a threshold value by minimizing intra class variance or maximizing inter class variance using the estimated thresholds for each image binary thresholding is implemented iteratively to generate a time series of water mask rasters which are then subjected to a newly designed outlier removal technique before exporting final results removal of outliers is the most challenging part of this algorithm especially in the case of rivers the process requires a method that can identify water pixels uncorrelated with river flow or pixels which are not part of the expected maximum extent in the case of lakes and reservoirs the requirement was satisfied using a novel approach that involves an automated delineation of the zone in which surface water extent was calculated this zone is referred to as the maximum extent water mask and represents the maximum possible extent of selected river lake reservoir within the specified time period the maximum extent water mask is generated by a two step process applied to the time series of water mask rasters i mosaicking and ii vectorizing during the mosaicking process each pixel in the merged composite considers the maximum pixel value from the time series data the resulting composite is then converted to shapefile and filtered based on the number of largest polygons by default this value is set as 1 i e the maximum extent water mask is defined using only the largest polygon in the shapefile in the next step the time series of water mask rasters are filtered to remove water pixels that fall outside the maximum extent water mask see fig 4 the resulting time series of water mask rasters are vectorized to generate the final time series of surface water extent shapefiles which can be exported for further research 4 sims web application 4 1 application environment the application is entirely built using the earth engine application programming interface api for python thereby leveraging the potential of gee to a much greater extent by utilizing python functions and libraries in addition to some of the basic python modules this application utilizes the geemap package which is a recently developed python package for interactive mapping using gee wu 2020 moreover the python script is run using the jupyter notebook integrated development environment ide which offers a wide range of interactive widgets for enhanced user interaction with the aim of reaching a wider audience this work is shared as an open source web application which can be accessed by users even if they don t have a private gee account or a system with python installed this was implemented with the help of voila package in python which allows one to directly transform jupyter notebooks into customizable interactive dashboards that can be shared publicly as stand alone web applications the application is deployed online through the heroku platform which offers developers the easiest option for hosting and running jupyter notebook based web applications 4 2 user interface the sims web application is designed to have a simple and intuitive user interface fig 5 with comprehensive guidance allowing even novice users to master the tool with ease the home page of the application consists of two panels an input section and an interactive map layer the input section consists of a list of interactive widgets the functions of which are listed in table 1 the interactive map layer on the right panel is the primary component of this web application the map layer allows a user to define their required study area with the available list of interactive drawing tools the map also helps the user in visualizing the process by products like the mosaicked water mask raster and the maximum extent water mask shapefile additionally the map layer is also equipped with an output window that pops up in the bottom right corner once the processing is started the output window displays various information like the processing updates download links download progress errors etc once the processing is completed the time series plot of water surface area can be visualized through the view time series plot tab 5 practical guidance the sims tool is developed to extract the temporal variation of water surface area for inland waters particularly rivers lakes and reservoirs mainly two things have to be taken care of before initiating the computation a defining aoi and b setting the number of polygons to be used for generating the maximum extent water mask generally defining an aoi can be easily implemented by drawing a polygon around the required study area the only point to be noted here is that the final defined aoi should have mainly two classes of features water and a non water feature this ensures best results while applying otsu s thresholding technique for extracting water pixels if the defined aoi is too large to be covered by sentinel 1 single day mosaics the output window displays an error message prompting the user to redefine the aoi into sub sections and process separately the application also provides options for modifying and visualizing the aoi by applying a buffer value using the buffer option provided in the left panel this feature is particularly useful in the case of processing single channel rivers wherein a polyline feature can be easily drawn along the river centerline and buffered to get the required aoi delineating the maximum extent water mask is another process that requires special attention for lakes and reservoirs the expected results can be easily achieved in most cases with the default value 1 of number of polygons this is because maximum extent water mask of still water bodies can be easily mapped using a single continuous polygon on the other hand mapping the maximum extent of rivers using a single polygon is practically impossible due to the presence of constructions along the river channel like bridges or due to exposed river beds during dry seasons the situation is even more challenging in the case of highly braided and dynamic river channels however it is to be noted that the case of exposed river beds will not be a concern if the selected time period of analysis extends over multiple seasons as the algorithm eventually mosaics entire images within the time frame for generating maximum extent mask as discussed in section 3 the maximum extent shapefile is generated based on the largest polygon from vectorized mosaicked water mask by default for rivers this process configuration needs to be manually altered after the initial processing based on requirements of selected study area a graphical illustration is shown in fig 6 for setting the number of polygons to be used for generating maximum extent water mask over a small stretch of mahanadi river in chhattisgarh india for the year 2020 the aoi generated by buffering a polyline and the resulting maximum extent water mask shapefile are also indicated after the initial processing default value of number of polygons field was changed to five considering the number of bridges along channel by selecting five the process considers the first five largest polygons from the vectorized mosaicked water mask to generate maximum extent mask in some cases this can lead to an output containing water pixels within the aoi which are not actually part of the selected water body this usually occurs in the case of water bodies surrounded by waterlogged lands for mitigating such situations the aoi can be redefined by avoiding possible waterlogged areas in surroundings the processing can be repeated until the defined aoi and selected number of polygons are sufficient enough to generate maximum extent mask covering the required length and width of river 6 results and discussion 6 1 mapping temporal variation of reservoir extents the developed sims web application was successfully tested over a few randomly selected rivers and reservoirs in india to generate time series of surface water extents based on user defined aoi and time period as an illustration results are presented over the indira sagar reservoir located in the narmada river basin in madhya pradesh india for the period from 01 jan 2020 to 31 dec 2020 with an average catchment area of about 61 642 sq km indira sagar is the largest reservoir in the country department of water resource 2018 using the sims application an aoi was defined around the reservoir using a polygon to initiate the processing see supplementary materials fig s1 the maximum extent water mask shapefile generated as a by product of processing is shown in fig 7 the result gives an overall picture of the maximum possible water surface area that the reservoir would have attained in given time period the process of mapping temporal variation of reservoir extents for year 2020 resulted in a total of 28 shapefiles fig 8 shows a few sample surface water extent shapefiles generated using the sims tool corresponding to the dates of 06 jan 2020 05 apr 2020 01 sep 2020 and 01 dec 2020 respectively fig 9 shows the entire time series of water surface area generated for the reservoir as visualized through the interface of web application results indicate the tool s effectiveness in mapping the highly dynamic seasonal variations of water surface area and its interannual changes however the temporal availability of sentinel 1 satellite imagery which ranges between 6 and 12 days resulted in sudden jumps in the time series curve 6 2 accuracy assessment the accuracy of sims toolkit is tested extensively across 20 validation sites 10 lakes reservoirs and 10 rivers selected from different parts of the world see fig 10 site selection is done ensuring the inclusion of diverse terrain characteristics that can pose challenging situations for sar based surface water mapping this includes desert terrains flat terrains meandering and highly braided river channels thickly vegetated areas hilly terrains steep mountainous areas urban areas and coastal areas for accuracy assessment the time series of water mask rasters spatial resolution 20 m approx generated by sims just before the process of conversion to shapefile is manually exported for each validation site for the year 2020 reference datasets for these locations are prepared from sentinel 2 using modified normalized difference water index or mndwi xu 2007 mndwi is an extended version of normalized difference water index ndwi introduced by gao 1996 with improved capability to enhance water bodies against impervious surfaces recent studies endorse mndwi as a powerful feature for waterbody delineation from optical imagery schmitt 2020 du et al 2016 jiang et al 2021 the equation for mndwi is derived using top of atmosphere toa reflectance values from the green band and short wave infrared swir band of the electromagnetic spectrum as shown below 1 m n d w i g r e e n s w i r g r e e n s w i r the green band band 3 of sentinel 2 has a spatial resolution of 10 m whereas the swir band band 11 is available at 20 m demanding the rescaling of resolution to initiate the computation in order to ensure compatibility with sims output green band is upscaled to 20 m resolution thereby generating mndwi images at 20 m finally the water mask from sentinel 2 is derived by applying otsu s binary thresholding on mndwi image and the resulting outputs are clipped to the maximum extent water mask derived from sims for ensuring spatial consistency to ensure the reliability of assessment reference sentinel 2 images were filtered based on the temporal availability of sims output and cloud cover less than 10 the percentage of cloud cover was manually estimated corresponding to the aoi using the sentinel 2 cloud probability layer available in gee based on the above criterion a pair of images one from sims and the other from sentinel 2 is selected per validation site for the year 2020 confusion matrix is calculated between each pair of images for all 20 sites and the corresponding accuracy assessments are performed omission and commission errors of classification are reported for both water and non water pixels additionally classification metrics such as precision recall f1 score kappa and overall accuracy are also evaluated the definitions and equations of each of these parameters are explained in appendix a assessment of lakes showed high overall accuracies in all cases ranging from 84 16 to 99 47 see table 2 results over the powell lake in united states showed the lowest accuracy 84 16 as expected owing to the surrounding canyons with steep vertical terrain sar imagery at this location is prone to high layover and shadows effects thus resulting in poor classification outputs with very high omission and commission errors of water pixels and very low classification metrics the powell lake also records the lowest kappa coefficient indicating that the obtained results are more of a random chance high omission errors of water and the consequent low recall due to layover effect is also evident near mountainous terrains such as the pangong tso lake in india china border and the plitvice lake in croatia goygol lake in azerbaijan is another example of a lake near hilly terrain affected by shadows effects of sar imagery resulting in high commission errors of water and low precision remaining locations displayed remarkable outputs with low errors of classification and high accuracy compared to the outputs over lakes the performance of sims on river channels showed slightly degraded results even though the overall accuracy remained in a range similar to that of lakes 87 23 98 96 see table 3 among the selected study reaches markham zambezi and tanana rivers exhibited the weakest performance the highly braided patterns of these channels resulted in high omission errors of classification and thus consequently lead to poor classification metrics misclassification errors are also dominant over the yamuna river in india and yenisei river in russia with its steep terrains which causes layover and shadow effects in the sar imagery resulting in poor precision recall f1 score and kappa reliable outputs with high accuracy are obtained for all other regions except the presence of omission errors in few cases due to varying terrain characteristics sims toolkit is also tested for temporal consistency across different seasons see table 4 collection of image pairs are extracted based on concurrent availability from both sources sims and sentinel 2 and cloud cover as done earlier for accuracy assessment the obtained collection is further filtered based on their availability in dry and wet seasons images representing the two seasons are chosen based on the smallest for dry season and largest for wet season available water surface area estimated by sims due to the presence of cloud cover especially during wet seasons only four stations are identified to have datasets sufficient for seasonal analysis the overall accuracy of classification is obtained in the range 87 19 96 69 for dry season and 81 96 99 75 for wet season omission error of classification and low classification metrics are evident in all instances for dry season outputs for the wet season are found to be comparatively better than that of the corresponding dry season except for the powell lake which is highly affected by layover and shadow effects a spatial plot of the water masks delineated using sims for dry and wet seasons across four locations is shown in fig 11 6 3 limitations it is to be noted that the presented method might not be suitable for water bodies which remain completely dry for some parts of the year as it adversely affects the outcome of otsu s binary thresholding technique which completely relies on the bimodal pixel distribution of water and non water the situation can be handled to a certain extent by avoiding complete dry seasons from the processing periods of such water bodies layover and shadow effects are other major issues which limits the applicability of the sims toolkit particularly in mountainous regions however the outputs for such locations can be improved by redefining the aoi by minimizing its extent avoiding areas expected to have high shadow effects other issues of sims are technical restrictions rather than limitations imposed by google for earth engine users to ensure the flawless availability of its services to all users gee have a per user quota on the amount of data that can processed by an individual server the restriction is particularly apparent in the case of cpu intensive processes like raster to vector conversion which is implemented in the developed toolkit due to this reason sims have an areal limitation on the processes that can be executed at a time on the cloud server as per the validation tests water surface extents covering an area up to 800 sq km approximately can be processed successfully without any memory outages delineation of larger water bodies can still be achieved using sims by dividing the aoi into sub sections that can be processed individually in addition to the above mentioned restrictions gee terminates processes irrespective of their intensity when the duration of requests exceeds 270 s parallel requests per user exceeds 40 and when the number of cpu intensive parallel processes exceeds 25 gorelick et al 2017 6 4 relevant stakeholders the sims tool is highly beneficial to a wide range of stakeholders especially in the field of hydrometeorology the generated maximum extent water mask shapefile is useful for various applications like geospatial analysis using gis software applications and programming languages visualization of any chosen water body shapefile based extraction of remote sensing data for a selected region surface forcing for hydrological models hydrodynamic models etc giustarini et al 2011 additionally the temporal information of surface water extents which can be exported from the sims tool as tabular data csv or as time series of shapefiles shp can be effectively utilized for studies involving temporal analysis of inland water bodies the time series data can be visualized as 2 d plots or as time series of surface water extent maps as per user requirements using the time series of shapefiles is found to be of great advantage especially in regions of high surface water dynamics rather than using a single shapefile in the above mentioned applications utilizing the temporal collection of shapefiles shall allow researchers to capture the realistic dynamic nature of the water body thereby providing a vital understanding of the actual scenario combining the derived temporal information with complementary datasets like satellite altimetry which measures water level opens up huge possibilities of inland water monitoring such as estimation of surface water volume dynamics river discharge dynamics etc frappart et al 2005 ahmad and kim 2019 with the futuristic swot mission potential of altimetry would improve dramatically considering its capability to observe smaller and narrower inland water bodies to aid the scientific communities across the world in getting prepared for the swot mission cnes developed the large scale swot hydrology simulator capable of generating realistic proxy swot water surface elevations wse incorporating the expected swot measurement error sources elmer et al 2020 the open source simulator allows researchers to assess the swot mission impacts in land hydrology and explore potential future swot applications prior to launch the developed sims tool can greatly improve the simulations of the swot simulator which is primarily based on a georeferenced input shapefile that defines the surface water boundary the simulator is also equipped with the capability to generate time series of proxy swot wse based on time series of surface water extent shapefiles thereby improving the realistic performance of the simulator this can be achieved with ease using the sims web application allowing users to attain a better understanding on how the swot mission will be observing the dynamic surface water bodies of the planet similar analysis can also be performed for other future land hydrology missions using their synthetic datasets 7 conclusion this work introduces sims a newly developed open source web application based on python and gee for mapping the temporal variation of surface water extents specifically lakes reservoirs and rivers the presented work describes background processes and methods incorporated in developing the application a detailed illustration of the user interface of web application along with solutions for various practical situations is also discussed in this paper accuracy assessment at multiple validation sites showed the great potential of sims in mapping lakes and rivers across varying geographic locations climatic conditions terrain characteristics and flow patterns analysis using generated outputs representing dry and wet seasons indicated the temporal consistency of sims the generalized and simplified methodology implemented in the tool offers the research community a global platform for exploring the temporal variation of rivers lakes and reservoirs the tool s capability to implement a faster output export framework using a compression algorithm in python makes it unique among existing gee based web applications exported outputs can largely support the pre launch study of future land hydrology missions capable of delivering high quantum of information on inland waters like the nasa s swot mission future updates of the tool will be oriented towards fixing any bugs and flaws in the system implementing new features based on user suggestions collected through a properly managed user feedback system and improving the server capacity thereby ensuring a robust system capable of efficiently handling multiple user requests the developed toolkit has large scopes of improvement especially in terms of accuracy and resolution results generated by the tool may be improved by implementing more complex water classification techniques involving statistical analysis machine learning etc however implementing complex algorithms on a time series of satellite imagery especially sar imagery which involves large files is computationally very demanding in the case of resolution surface water products generated by sims tool are limited by the geographical and temporal discontinuities in the sentinel 1 data archive with access to more open source repositories of radar imagery of similar resolutions from multiple satellite missions in the near future the developed application can be upgraded to achieve surface water extents information at very high spatial and temporal resolution combining the recent advances in high performance computing solutions with petabytes of multi satellite datasets would help us edge closer to achieving the target of real time monitoring of inland water bodies declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to acknowledge the support by dst cnrs project through ifc 4126 dst cnrs 2018 19 1 1726 and the dst centre of excellence in climate studies iit bombay under project dst ccp coe 140 2018 g authors are grateful to be part of the nasa swot early adopter projects from iit bombay we thank the european space agency for providing open access to sentinel 1 radar imagery and google earth engine for providing the cloud computing facilities we also express our sincere gratitude to the heroku cloud platform for hosting the first version of the developed sims web application appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105305 appendix b terminologies related to accuracy assessment overall accuracy oa it is the proportion of correctly classified pixels out of the total number of pixels n o a t p t n n w h e r e n t p t n f p f n here tp true positives water classified as water tn true negatives non water classified as non water fp false positives non water classified as water fn false negative water classified as non water precision precision of a class is the fraction of correctly classified pixels out of the total number of classifications for that class p r e c i s i o n p t p t p f p recall recall of a class is the fraction of correctly classified pixels out of the total number of actual pixels representing that class r e c a l l r t p t p f n f1 score it is the harmonic mean of precision p and recall r f 1 s c o r e 2 p r p r kappa it is a measure of how the obtained overall accuracy oa of classification compares to random chance or expected accuracy k a p p a o a p e 1 p e here pe represents the expected accuracy which is given by the following equation p e t p f p n t p f n n f n t n n f p t n n 
25639,this work introduces sentinel 1 based inland water dynamics mapping system sims an open source web application developed to enable automated mapping of inland water dynamics using sentinel 1 radar imagery sims relies on a novel framework built using python and google earth engine the underlying algorithm involves a simple binary thresholding technique and an outlier removal method tailored to perform efficiently across complicated flow regimes results can be downloaded as numerical data or as time series of shapefiles representing the variation of inland water extents exported geospatial datasets aid the pre launch study of future surface water and ocean topography swot mission which is expected to deliver hydrological measurements at unprecedented spatial resolutions classification metrics are evaluated at 20 validation sites across the globe using sentinel 2 based modified normalized difference water index mndwi images as reference results indicated high overall accuracy ranging from 84 16 to 99 47 for lakes and 87 23 98 96 for rivers keywords sentinel 1 swot inland water dynamics web application python google earth engine software availability name of the web application sims developer manu k soman year of first official release 2021 program language python hardware requirements pc minimum system requirement web browsing capability availability https sims toolkit herokuapp com github repository https github com manuks481 sims webapp git 1 introduction inland waters are one of the essential natural resources affecting sustainability of terrestrial life on earth brönmark and hansson 2002 monitoring changes in inland water are of paramount importance considering their direct interaction with the ocean and atmosphere through horizontal and vertical mass fluxes papa et al 2008 accurate quantification of variations in inland water extents can provide salient information on relevant hydrological variables like runoff precipitation evaporation and infiltration the spatial and temporal dynamics of inland waters play a vital role in understanding the hydrological cycle bullock and acreman 2003 land atmosphere energy balance krinner 2003 and surface groundwater dynamics winter 1999 the dynamics of inland waters particularly rivers have huge impacts on regional floods and droughts and remain crucial to an efficient inland waterbody management system in addition to natural processes surface water extents information can also serve as a direct indicator of anthropogenic activities that alter natural dynamics making it important to scientists and policymakers equally alike with increasing variability in regional climate surface water observations at high spatial and temporal resolution are critical in capturing the short term variabilities especially in the case of highly braided river channels conventional in situ monitoring of surface water are limited by poor spatial coverage inconsistent temporal frequency making many regions data scarce remote sensing offers an upper hand to overcome most of these limitations using satellite based earth observation data which provide synoptic view of earth at unprecedented spatiotemporal resolutions however the advances in remote sensing technology have led to a rapid growth in the amount of data acquired by satellite sensors resulting in severe demands of high storage requirements long term or planetary scale analysis using satellite imagery would essentially require systems capable of handling big data and computationally intensive data processing developments in high performance cloud computing platforms like google earth engine gee has made a huge breakthrough by providing open access to petabytes of satellite imagery with on the fly processing capabilities powered by google s cloud infrastructure gorelick et al 2017 this has led to seamless data access from space agencies enabling effortless implementation of computationally intensive analysis at regional global scales examples include the landsat collection 1972 to present from national aeronautics and space administration nasa and sentinel datasets 2014 to present from the european space agency esa additionally gee also provides javascript and python application programming interfaces api offering vast possibilities for developers to create gee based customized web applications several studies have utilized the potential of gee to develop a variety of applications tools and datasets related to surface water monitoring pekel et al 2016 presented the global surface water explorer a gee based web mapping tool that uses more than three million landsat images over the past 3 7 decades to map the long term changes in surface water extents at a global scale a similar tool was developed recently by pickens et al 2020 for providing global scale inter annual and intra annual inland water dynamics using landsat imagery from 1999 to 2018 applications that facilitate customized surface water mapping based on a user defined area of interest are also available currently a latest product in this sector is the gee application developed by rad et al 2021 which uses landsat imagery from 1984 present to generate 16 day time series of water spread area information an example of open source surface water dataset is the water bodies fraction product derived over india using resourcesat 1 satellite by the national remote sensing centre nrsc indian space research organisation isro subramaniam et al 2011 global surface water datasets of high temporal resolutions were also developed recently using moderate resolution imaging spectroradiometer modis satellite to capture inland water body dynamics at daily timescales klein et al 2017 ji et al 2018 however the scope of these products remains confined to large scale water bodies owing to coarse spatial resolution of modis imagery 250 m 500 m in spite of the availability from multiple global and regional surface water products capturing surface water dynamics using optical sensors remains extremely challenging considering their inability to penetrate clouds this results in large underestimation of surface water extents especially in the case of short duration events over dynamic water bodies like rivers hence there is a compelling need to develop a consistent inland water monitoring framework capable of capturing even the short term temporal dynamics of narrow water bodies microwave remote sensing has a huge impact on surface water monitoring considering their unique capabilities over other spectral regions microwave signals emitted by satellites possess exceptional cloud penetration capabilities reduced sensitivity to atmospheric aerosol contamination and are independent of solar illumination effects thereby providing consistent observations of the earth s surface independent of weather conditions and time of day with the availability of active microwave sensors like synthetic aperture radar sar satellites are capable of delivering earth observation data at very high spatial resolutions crucial for regional scale studies long et al 2014 existing literature demonstrate a number of methods that exploit the scattering mechanism of sar sensors to map surface water extents some of the commonly adopted methods include simple pixel based thresholding martinis et al 2015 tsai et al 2020 nair and indu 2020 thresholding on multi temporal sar backscatter metrics santoro and wegmüller 2014 santoro wegmüller lamarche et al 2015 santoro wegmüller wiesmann et al 2015 backscatter and incidence angle based probability distribution methods using long term sar training dataset westerhoff et al 2013 statistical morphological and machine learning integrated approaches shen et al 2019 etc researchers have also explored the potential of sar sensors in extracting temporal dynamics of surface water extents using thresholding based methods brisco et al 2009 bolanos et al 2016 cazals et al 2016 schlaffer et al 2018 machine learning techniques wang 2004 reschke et al 2012 pham duc et al 2017 water land edge detection techniques ding and li 2011 etc among the available sar based surface water products only a few are made publicly available like the water bodies information system wbis nrsc 2019 and the global inundation extent from multi satellites giems aires et al 2017 wbis is a web based geographic information system gis portal hosted by national remote sensing centre nrsc isro to provide downloadable temporal information on water surface area of a predefined database of lakes and reservoirs in india giems on the other hand provides global scale surface water extents information at a high spatial resolution of 90 m and at a monthly time scale from 1993 to 2007 apart from sensor specific algorithms there also exists a number of studies demonstrating the potential of multi sensor fusion techniques for surface water delineation ahmad et al 2020 druce et al 2021 irwin et al 2017 rao et al 2019 they follow a synergistic combination approach that can benefit from individual sensors strengths while mitigating their weaknesses however the computational demands of such methods are much higher than single sensor based approaches to date there exists a lack of efficient open source platforms to analyse highly dynamic narrow water bodies like rivers though sar based methods applied to specific regions are available pham duc et al 2017 tsai et al 2020 to the best of author s knowledge no tools have been developed by now with the capability to export temporal information of inland water extents as shapefiles shp for further research in geospatial applications this is highly relevant especially in the context of the upcoming surface water and ocean topography swot mission which is a joint mission between nasa centre national d etudes spatiales cnes canadian space agency and the united kingdom space agency with the latest wide swath altimetry technology onboard swot is expected to deliver point cloud observations of water surface elevations wse at unprecedented spatial resolutions capable of observing water bodies larger than 250 m 250 m and rivers as narrow as 100 m biancamaria et al 2016 combining synthetic swot measurements with geospatial information on inland water dynamics would immensely aid the pre launch study of swot mission keeping these points in mind the present study introduces an open source web application called sentinel 1 based inland water dynamics mapping system sims that facilitates automated extraction of temporal dynamics of surface water extents particularly rivers lakes and reservoirs the sims toolkit is built entirely using python and gee and is capable of generating on demand regional products based on a user defined area of interest and time period the processing method relies on a simple thresholding technique using the freely available analysis ready sentinel 1 sar dataset hosted in gee powered by the consistent observation strategy and high spatial resolution of sentinel 1 the sims toolkit can measure all inland water bodies larger than 400 sq m at sub monthly timescales potential enough for regional scale research applications the remaining contents of the paper are organized as follows section 2 discusses the data utilized in the sims toolkit section 3 presents the implemented methodology framework section 4 gives a brief overview of the application environment and user interface of sims tool section 5 gives a practical guidance to the toolkit with illustrated examples on various challenging situations section 6 discusses the reliability of results generated by sims toolkit and the relevant stakeholders section 7 gives the conclusion and future scope of the work 2 data the sims toolkit utilizes sentinel 1 satellite datasets which are available in gee sar imagery collection the sentinel 1 mission comprises a constellation of two radar satellites sentinel 1a and sentinel 1b launched by esa in april 2014 and april 2016 respectively each of these two satellites have a temporal resolution of 12 days whereas a 6 day repeat frequency can be achieved near the equator with both datasets microwave signals are emitted by sar sensors at off nadir angles towards the earth s surface the transmitted energy gets reflected off various ground targets a fraction of which is collected by the receiver the collected data is stored in the form of a two dimensional image wherein each pixel represents the return echoes from the corresponding ground location the intensity of backscatter signal depends on dielectric and geometric properties of the target ground targets like water with its smooth surface and high dielectric constant follows a specular reflective nature resulting in the reflection of transmitted energy away from the sensor which consequently leads to very low backscatter received at the sensor devries et al 2020 this property of radar signals is utilized in delineating water bodies from the surrounding rough terrains however the method is prone to misclassification errors of omission in presence of inundated vegetations rough or wavy water surfaces during windy conditions and ice cover white et al 2015 moreover the side looking geometry of sar sensors is subject to geometrical distortions like layover and shadow effects that can result in omission and commission error of water pixels respectively mason et al 2010 sentinel 1 carries a single c band imager which operates at a central frequency of 5 405 ghz with four acquisition modes stripmap sm interferometric wide swath iw extra wide swath ew and wave mode wv torres et al 2012 each of these modes possesses different acquisition strategies swath widths and spatial resolutions among the available modes iw mode is the default operational mode over land acquired at incidence angles between 31 and 46 images captured in iw mode have a wide swath of 250 km and a very high spatial resolution of 5 m 20 m making it one of the best choices for land cover studies huang et al 2018 moreover with a pixel spacing of 10 m sentinel 1 iw mode can detect all surface water bodies having an area larger than 20 m 20 m products under the sentinel 1 iw mode category are available as single or dual polarized sar data the polarizations that are particularly relevant in the context of presented work are the co polarized vertically transmitted and received vv data and the cross polarized vertically transmitted and horizontally received vh data both vv and vh polarizations have distinct scattering mechanisms over open water surfaces allowing potential delineation of water bodies from the surrounding land surfaces even though the scattering principle of vv and vh polarization are comparable there exists significant variabilities in their backscattered energy owing to difference in the backscattered polarizations for vh polarization underestimation of the expected surface water extent was found to be comparatively less due to its lower sensitivity to snow cover and high surface water roughness wan et al 2019 in spite of the advantages that vh polarization offers there exists a major drawback limiting its application in most areas vh polarization has larger backscatter variability which results in potential misclassification of pixels between open water and land twele et al 2016 such situations are particularly evident in highly braided dynamic river channels agricultural areas and densely vegetated wetland areas where lower sensitivity of vh polarization can lead to large overestimation of water similar situations can also occur over man made objects like building tops roads etc wan et al 2019 unlike vh polarization vv polarization has very low probabilities of misclassification due to its narrow backscatter variability since the error contribution due to underestimation is comparatively much lower than the error induced by misclassification vv polarization was selected for water classification in the developed sims web application we use the level 1 ground range detected grd sentinel 1 vv polarized sar data iw mode which is available ready to use in gee after radiometric calibration and terrain correction fig 1 shows a sample sentinel 1 vv polarization image as visualized through the interface of gee the image is captured over the indira sagar reservoir in madhya pradesh india on 6th jan 2021 the polygon drawn over the image represents an area of interest aoi used for visualizing the backscatter variability of vv polarization through gee see fig 2 the histogram of vv polarization backscatter coefficient σ exhibit a bimodal distribution with a clear demarcation between water and non water features allowing potential classification of water by binary thresholding liang and liu 2020 in this technique a pixel is labelled as water if the magnitude of vv polarization backscatter is lower than a predefined threshold value 3 methods the sims tool is built using a comprehensive framework supported by python and gee allowing users to generate information regarding the temporal variation of surface water extents specifically inland water bodies involving lakes reservoirs and rivers the workflow of computational processes which drives the application is presented in fig 3 the application primarily requires two user inputs a user defined aoi and a time period of analysis in addition the tool also allows user to select the number of polygons to be used for defining maximum extent water mask for the initial run it is recommended to set this field to its default value 1 which can be modified later as per the requirements of study area a detailed illustration regarding this option is provided under section 5 the computational process starts with the extraction of sentinel 1 vv polarization backscatter images from gee corresponding to the user defined aoi and time period images captured on the same day are mosaicked thereby allowing the user to process larger water bodies spread across multiple sentinel 1 images in order to minimize computational load the mosaicked collection of images are clipped to the aoi and only those images which cover the entire aoi are used for further processing the reduced image collection are then subjected to a noise filtering algorithm called speckle filtering to remove the granular noises in raw sar image dasari et al 2016 the filtered images are then classified for water using a binary thresholding technique as discussed in section 2 with the motive of automating the classification process through an optimal data driven approach otsu s thresholding technique was selected otsu 1979 the algorithm assumes a bimodal pixel distribution and calculates a threshold value by minimizing intra class variance or maximizing inter class variance using the estimated thresholds for each image binary thresholding is implemented iteratively to generate a time series of water mask rasters which are then subjected to a newly designed outlier removal technique before exporting final results removal of outliers is the most challenging part of this algorithm especially in the case of rivers the process requires a method that can identify water pixels uncorrelated with river flow or pixels which are not part of the expected maximum extent in the case of lakes and reservoirs the requirement was satisfied using a novel approach that involves an automated delineation of the zone in which surface water extent was calculated this zone is referred to as the maximum extent water mask and represents the maximum possible extent of selected river lake reservoir within the specified time period the maximum extent water mask is generated by a two step process applied to the time series of water mask rasters i mosaicking and ii vectorizing during the mosaicking process each pixel in the merged composite considers the maximum pixel value from the time series data the resulting composite is then converted to shapefile and filtered based on the number of largest polygons by default this value is set as 1 i e the maximum extent water mask is defined using only the largest polygon in the shapefile in the next step the time series of water mask rasters are filtered to remove water pixels that fall outside the maximum extent water mask see fig 4 the resulting time series of water mask rasters are vectorized to generate the final time series of surface water extent shapefiles which can be exported for further research 4 sims web application 4 1 application environment the application is entirely built using the earth engine application programming interface api for python thereby leveraging the potential of gee to a much greater extent by utilizing python functions and libraries in addition to some of the basic python modules this application utilizes the geemap package which is a recently developed python package for interactive mapping using gee wu 2020 moreover the python script is run using the jupyter notebook integrated development environment ide which offers a wide range of interactive widgets for enhanced user interaction with the aim of reaching a wider audience this work is shared as an open source web application which can be accessed by users even if they don t have a private gee account or a system with python installed this was implemented with the help of voila package in python which allows one to directly transform jupyter notebooks into customizable interactive dashboards that can be shared publicly as stand alone web applications the application is deployed online through the heroku platform which offers developers the easiest option for hosting and running jupyter notebook based web applications 4 2 user interface the sims web application is designed to have a simple and intuitive user interface fig 5 with comprehensive guidance allowing even novice users to master the tool with ease the home page of the application consists of two panels an input section and an interactive map layer the input section consists of a list of interactive widgets the functions of which are listed in table 1 the interactive map layer on the right panel is the primary component of this web application the map layer allows a user to define their required study area with the available list of interactive drawing tools the map also helps the user in visualizing the process by products like the mosaicked water mask raster and the maximum extent water mask shapefile additionally the map layer is also equipped with an output window that pops up in the bottom right corner once the processing is started the output window displays various information like the processing updates download links download progress errors etc once the processing is completed the time series plot of water surface area can be visualized through the view time series plot tab 5 practical guidance the sims tool is developed to extract the temporal variation of water surface area for inland waters particularly rivers lakes and reservoirs mainly two things have to be taken care of before initiating the computation a defining aoi and b setting the number of polygons to be used for generating the maximum extent water mask generally defining an aoi can be easily implemented by drawing a polygon around the required study area the only point to be noted here is that the final defined aoi should have mainly two classes of features water and a non water feature this ensures best results while applying otsu s thresholding technique for extracting water pixels if the defined aoi is too large to be covered by sentinel 1 single day mosaics the output window displays an error message prompting the user to redefine the aoi into sub sections and process separately the application also provides options for modifying and visualizing the aoi by applying a buffer value using the buffer option provided in the left panel this feature is particularly useful in the case of processing single channel rivers wherein a polyline feature can be easily drawn along the river centerline and buffered to get the required aoi delineating the maximum extent water mask is another process that requires special attention for lakes and reservoirs the expected results can be easily achieved in most cases with the default value 1 of number of polygons this is because maximum extent water mask of still water bodies can be easily mapped using a single continuous polygon on the other hand mapping the maximum extent of rivers using a single polygon is practically impossible due to the presence of constructions along the river channel like bridges or due to exposed river beds during dry seasons the situation is even more challenging in the case of highly braided and dynamic river channels however it is to be noted that the case of exposed river beds will not be a concern if the selected time period of analysis extends over multiple seasons as the algorithm eventually mosaics entire images within the time frame for generating maximum extent mask as discussed in section 3 the maximum extent shapefile is generated based on the largest polygon from vectorized mosaicked water mask by default for rivers this process configuration needs to be manually altered after the initial processing based on requirements of selected study area a graphical illustration is shown in fig 6 for setting the number of polygons to be used for generating maximum extent water mask over a small stretch of mahanadi river in chhattisgarh india for the year 2020 the aoi generated by buffering a polyline and the resulting maximum extent water mask shapefile are also indicated after the initial processing default value of number of polygons field was changed to five considering the number of bridges along channel by selecting five the process considers the first five largest polygons from the vectorized mosaicked water mask to generate maximum extent mask in some cases this can lead to an output containing water pixels within the aoi which are not actually part of the selected water body this usually occurs in the case of water bodies surrounded by waterlogged lands for mitigating such situations the aoi can be redefined by avoiding possible waterlogged areas in surroundings the processing can be repeated until the defined aoi and selected number of polygons are sufficient enough to generate maximum extent mask covering the required length and width of river 6 results and discussion 6 1 mapping temporal variation of reservoir extents the developed sims web application was successfully tested over a few randomly selected rivers and reservoirs in india to generate time series of surface water extents based on user defined aoi and time period as an illustration results are presented over the indira sagar reservoir located in the narmada river basin in madhya pradesh india for the period from 01 jan 2020 to 31 dec 2020 with an average catchment area of about 61 642 sq km indira sagar is the largest reservoir in the country department of water resource 2018 using the sims application an aoi was defined around the reservoir using a polygon to initiate the processing see supplementary materials fig s1 the maximum extent water mask shapefile generated as a by product of processing is shown in fig 7 the result gives an overall picture of the maximum possible water surface area that the reservoir would have attained in given time period the process of mapping temporal variation of reservoir extents for year 2020 resulted in a total of 28 shapefiles fig 8 shows a few sample surface water extent shapefiles generated using the sims tool corresponding to the dates of 06 jan 2020 05 apr 2020 01 sep 2020 and 01 dec 2020 respectively fig 9 shows the entire time series of water surface area generated for the reservoir as visualized through the interface of web application results indicate the tool s effectiveness in mapping the highly dynamic seasonal variations of water surface area and its interannual changes however the temporal availability of sentinel 1 satellite imagery which ranges between 6 and 12 days resulted in sudden jumps in the time series curve 6 2 accuracy assessment the accuracy of sims toolkit is tested extensively across 20 validation sites 10 lakes reservoirs and 10 rivers selected from different parts of the world see fig 10 site selection is done ensuring the inclusion of diverse terrain characteristics that can pose challenging situations for sar based surface water mapping this includes desert terrains flat terrains meandering and highly braided river channels thickly vegetated areas hilly terrains steep mountainous areas urban areas and coastal areas for accuracy assessment the time series of water mask rasters spatial resolution 20 m approx generated by sims just before the process of conversion to shapefile is manually exported for each validation site for the year 2020 reference datasets for these locations are prepared from sentinel 2 using modified normalized difference water index or mndwi xu 2007 mndwi is an extended version of normalized difference water index ndwi introduced by gao 1996 with improved capability to enhance water bodies against impervious surfaces recent studies endorse mndwi as a powerful feature for waterbody delineation from optical imagery schmitt 2020 du et al 2016 jiang et al 2021 the equation for mndwi is derived using top of atmosphere toa reflectance values from the green band and short wave infrared swir band of the electromagnetic spectrum as shown below 1 m n d w i g r e e n s w i r g r e e n s w i r the green band band 3 of sentinel 2 has a spatial resolution of 10 m whereas the swir band band 11 is available at 20 m demanding the rescaling of resolution to initiate the computation in order to ensure compatibility with sims output green band is upscaled to 20 m resolution thereby generating mndwi images at 20 m finally the water mask from sentinel 2 is derived by applying otsu s binary thresholding on mndwi image and the resulting outputs are clipped to the maximum extent water mask derived from sims for ensuring spatial consistency to ensure the reliability of assessment reference sentinel 2 images were filtered based on the temporal availability of sims output and cloud cover less than 10 the percentage of cloud cover was manually estimated corresponding to the aoi using the sentinel 2 cloud probability layer available in gee based on the above criterion a pair of images one from sims and the other from sentinel 2 is selected per validation site for the year 2020 confusion matrix is calculated between each pair of images for all 20 sites and the corresponding accuracy assessments are performed omission and commission errors of classification are reported for both water and non water pixels additionally classification metrics such as precision recall f1 score kappa and overall accuracy are also evaluated the definitions and equations of each of these parameters are explained in appendix a assessment of lakes showed high overall accuracies in all cases ranging from 84 16 to 99 47 see table 2 results over the powell lake in united states showed the lowest accuracy 84 16 as expected owing to the surrounding canyons with steep vertical terrain sar imagery at this location is prone to high layover and shadows effects thus resulting in poor classification outputs with very high omission and commission errors of water pixels and very low classification metrics the powell lake also records the lowest kappa coefficient indicating that the obtained results are more of a random chance high omission errors of water and the consequent low recall due to layover effect is also evident near mountainous terrains such as the pangong tso lake in india china border and the plitvice lake in croatia goygol lake in azerbaijan is another example of a lake near hilly terrain affected by shadows effects of sar imagery resulting in high commission errors of water and low precision remaining locations displayed remarkable outputs with low errors of classification and high accuracy compared to the outputs over lakes the performance of sims on river channels showed slightly degraded results even though the overall accuracy remained in a range similar to that of lakes 87 23 98 96 see table 3 among the selected study reaches markham zambezi and tanana rivers exhibited the weakest performance the highly braided patterns of these channels resulted in high omission errors of classification and thus consequently lead to poor classification metrics misclassification errors are also dominant over the yamuna river in india and yenisei river in russia with its steep terrains which causes layover and shadow effects in the sar imagery resulting in poor precision recall f1 score and kappa reliable outputs with high accuracy are obtained for all other regions except the presence of omission errors in few cases due to varying terrain characteristics sims toolkit is also tested for temporal consistency across different seasons see table 4 collection of image pairs are extracted based on concurrent availability from both sources sims and sentinel 2 and cloud cover as done earlier for accuracy assessment the obtained collection is further filtered based on their availability in dry and wet seasons images representing the two seasons are chosen based on the smallest for dry season and largest for wet season available water surface area estimated by sims due to the presence of cloud cover especially during wet seasons only four stations are identified to have datasets sufficient for seasonal analysis the overall accuracy of classification is obtained in the range 87 19 96 69 for dry season and 81 96 99 75 for wet season omission error of classification and low classification metrics are evident in all instances for dry season outputs for the wet season are found to be comparatively better than that of the corresponding dry season except for the powell lake which is highly affected by layover and shadow effects a spatial plot of the water masks delineated using sims for dry and wet seasons across four locations is shown in fig 11 6 3 limitations it is to be noted that the presented method might not be suitable for water bodies which remain completely dry for some parts of the year as it adversely affects the outcome of otsu s binary thresholding technique which completely relies on the bimodal pixel distribution of water and non water the situation can be handled to a certain extent by avoiding complete dry seasons from the processing periods of such water bodies layover and shadow effects are other major issues which limits the applicability of the sims toolkit particularly in mountainous regions however the outputs for such locations can be improved by redefining the aoi by minimizing its extent avoiding areas expected to have high shadow effects other issues of sims are technical restrictions rather than limitations imposed by google for earth engine users to ensure the flawless availability of its services to all users gee have a per user quota on the amount of data that can processed by an individual server the restriction is particularly apparent in the case of cpu intensive processes like raster to vector conversion which is implemented in the developed toolkit due to this reason sims have an areal limitation on the processes that can be executed at a time on the cloud server as per the validation tests water surface extents covering an area up to 800 sq km approximately can be processed successfully without any memory outages delineation of larger water bodies can still be achieved using sims by dividing the aoi into sub sections that can be processed individually in addition to the above mentioned restrictions gee terminates processes irrespective of their intensity when the duration of requests exceeds 270 s parallel requests per user exceeds 40 and when the number of cpu intensive parallel processes exceeds 25 gorelick et al 2017 6 4 relevant stakeholders the sims tool is highly beneficial to a wide range of stakeholders especially in the field of hydrometeorology the generated maximum extent water mask shapefile is useful for various applications like geospatial analysis using gis software applications and programming languages visualization of any chosen water body shapefile based extraction of remote sensing data for a selected region surface forcing for hydrological models hydrodynamic models etc giustarini et al 2011 additionally the temporal information of surface water extents which can be exported from the sims tool as tabular data csv or as time series of shapefiles shp can be effectively utilized for studies involving temporal analysis of inland water bodies the time series data can be visualized as 2 d plots or as time series of surface water extent maps as per user requirements using the time series of shapefiles is found to be of great advantage especially in regions of high surface water dynamics rather than using a single shapefile in the above mentioned applications utilizing the temporal collection of shapefiles shall allow researchers to capture the realistic dynamic nature of the water body thereby providing a vital understanding of the actual scenario combining the derived temporal information with complementary datasets like satellite altimetry which measures water level opens up huge possibilities of inland water monitoring such as estimation of surface water volume dynamics river discharge dynamics etc frappart et al 2005 ahmad and kim 2019 with the futuristic swot mission potential of altimetry would improve dramatically considering its capability to observe smaller and narrower inland water bodies to aid the scientific communities across the world in getting prepared for the swot mission cnes developed the large scale swot hydrology simulator capable of generating realistic proxy swot water surface elevations wse incorporating the expected swot measurement error sources elmer et al 2020 the open source simulator allows researchers to assess the swot mission impacts in land hydrology and explore potential future swot applications prior to launch the developed sims tool can greatly improve the simulations of the swot simulator which is primarily based on a georeferenced input shapefile that defines the surface water boundary the simulator is also equipped with the capability to generate time series of proxy swot wse based on time series of surface water extent shapefiles thereby improving the realistic performance of the simulator this can be achieved with ease using the sims web application allowing users to attain a better understanding on how the swot mission will be observing the dynamic surface water bodies of the planet similar analysis can also be performed for other future land hydrology missions using their synthetic datasets 7 conclusion this work introduces sims a newly developed open source web application based on python and gee for mapping the temporal variation of surface water extents specifically lakes reservoirs and rivers the presented work describes background processes and methods incorporated in developing the application a detailed illustration of the user interface of web application along with solutions for various practical situations is also discussed in this paper accuracy assessment at multiple validation sites showed the great potential of sims in mapping lakes and rivers across varying geographic locations climatic conditions terrain characteristics and flow patterns analysis using generated outputs representing dry and wet seasons indicated the temporal consistency of sims the generalized and simplified methodology implemented in the tool offers the research community a global platform for exploring the temporal variation of rivers lakes and reservoirs the tool s capability to implement a faster output export framework using a compression algorithm in python makes it unique among existing gee based web applications exported outputs can largely support the pre launch study of future land hydrology missions capable of delivering high quantum of information on inland waters like the nasa s swot mission future updates of the tool will be oriented towards fixing any bugs and flaws in the system implementing new features based on user suggestions collected through a properly managed user feedback system and improving the server capacity thereby ensuring a robust system capable of efficiently handling multiple user requests the developed toolkit has large scopes of improvement especially in terms of accuracy and resolution results generated by the tool may be improved by implementing more complex water classification techniques involving statistical analysis machine learning etc however implementing complex algorithms on a time series of satellite imagery especially sar imagery which involves large files is computationally very demanding in the case of resolution surface water products generated by sims tool are limited by the geographical and temporal discontinuities in the sentinel 1 data archive with access to more open source repositories of radar imagery of similar resolutions from multiple satellite missions in the near future the developed application can be upgraded to achieve surface water extents information at very high spatial and temporal resolution combining the recent advances in high performance computing solutions with petabytes of multi satellite datasets would help us edge closer to achieving the target of real time monitoring of inland water bodies declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to acknowledge the support by dst cnrs project through ifc 4126 dst cnrs 2018 19 1 1726 and the dst centre of excellence in climate studies iit bombay under project dst ccp coe 140 2018 g authors are grateful to be part of the nasa swot early adopter projects from iit bombay we thank the european space agency for providing open access to sentinel 1 radar imagery and google earth engine for providing the cloud computing facilities we also express our sincere gratitude to the heroku cloud platform for hosting the first version of the developed sims web application appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105305 appendix b terminologies related to accuracy assessment overall accuracy oa it is the proportion of correctly classified pixels out of the total number of pixels n o a t p t n n w h e r e n t p t n f p f n here tp true positives water classified as water tn true negatives non water classified as non water fp false positives non water classified as water fn false negative water classified as non water precision precision of a class is the fraction of correctly classified pixels out of the total number of classifications for that class p r e c i s i o n p t p t p f p recall recall of a class is the fraction of correctly classified pixels out of the total number of actual pixels representing that class r e c a l l r t p t p f n f1 score it is the harmonic mean of precision p and recall r f 1 s c o r e 2 p r p r kappa it is a measure of how the obtained overall accuracy oa of classification compares to random chance or expected accuracy k a p p a o a p e 1 p e here pe represents the expected accuracy which is given by the following equation p e t p f p n t p f n n f n t n n f p t n n 
