index,text
2110,hydrological models such as the stormwater management model swmm are essential tools for managing water resources model performance typically relies on calibration to historic rainfall runoff events however traditional calibration techniques suffer many issues such as ad hoc event selection ignoring model parameter uncertainty and poor validation techniques we introduce a novel ensemble framework that relies on data driven event selection of calibration and validation events to achieve robust model generalisation the proposed framework is applied to swmm models for two urbanised catchments in southern ontario canada the framework uses unsupervised machine learning to cluster rainfall runoff events events in different clusters have diverse characteristics sampling events from each cluster ensures a diverse set of events for calibration validation events can be sampled in the same manner which ensures similarity between calibration and validation data we study the effects that the calibration event cluster has on model sensitivity and generalisation only minor differences in model parameter sensitivity were observed between different clusters however the cluster s used for calibration were found to be very important for model generalisation next we generate ensemble predictions which use multiple swmm models each calibrated to different events ensemble performance is compared to the single model baseline and across increasing numbers of ensemble members results demonstrate improvements in generalisation and decrease in prediction variance across increasing ensemble size finally we compare several different techniques for ensemble combination which increase in complexity from simple averaging to ann based stacking augmented with exogenous input features the ann based stacking performs the best according to two out of three evaluation criteria simple averaging while inferior in performance to stacking consistently outperforms the single model baseline the novel framework proposed in this work provides a data driven adaptable alternative to conventional calibration frameworks that have been proven to improve model performance graphical abstract keywords swmm data selection unsupervised clustering homogeneous ensembles hybrid modelling stacking ensemble diversity data availability we cannot share data but it is available online the code used has been made publicly available and is linked in the manuscript 1 introduction physics based hydrological models simulate dynamic rainfall runoff processes these rainfall runoff models typically use rainfall observations to predict flow at the outlet of a catchment such models have a wide range of applications such as flood early warning systems and stormwater infrastructure design for any model application it is important that predictions are accurate under a wide range of hydrological conditions stormwater management models swmm a popular semi distributed rainfall runoff modelling platform rely on robust calibration techniques to fine tune uncertain model parameters and ensure accurate performance under different conditions the efficacy of calibration can be attributed to at least three factors improved model parameterisation the method of searching for an optimum parameter set and the selection of calibration and validation data beven 2012 james 2005 recent research has focused primarily on advancing the former two factors while the selection of calibration and validation datasets is often overlooked in modelling studies niazi et al 2017 robust validation is essential to verify the generalisation of the calibrated model an often overlooked requirement of validation is that the calibration and validation datasets must be statistically similar zheng et al 2018 bowden et al 2002 zheng et al 2022 while this can be easily achieved through resampling methods toth 2009 anctil and lauzon 2004 many physics based models such as swmm require time continuous data zheng et al 2022 making it difficult to apply such methods there are two common formats for time continuous datasets using a long period of data or partitioning data into time continuous segments these formats are commonly referred to as continuous and event based calibrations respectively hossain et al 2019 a review of swmm calibration studies between 1987 and 2014 found 16 instances of continuous calibration 20 single event 52 multi event and 25 unspecified niazi et al 2017 the advantages and disadvantages of each approach are well documented in existing studies shamsi and koran 2017 hossain et al 2019 niazi et al 2017 for example model initial conditions only need to be calculated a single time for a continuous model run whereas in an event based format they need to be calculated for each individual event continuous modelling runs are also simpler than event based to configure shamsi and koran 2017 however implementing event based calibration routines is becoming increasingly easy to automate this is thanks to advances in modelling platforms and the development of wrappers available in multiple programming languages which allow for multiple events hot start files and model validation to be done programmatically leutnant et al 2019 mcdonnell et al 2020 event based calibration frameworks have several advantages firstly research has shown that thoughtful selection of a few informative events can outperform continuous or randomly selected events singh and bárdossy 2012 hossain et al 2019 that being said it is possible to adapt weighting schemes to continuous data to achieve similar improvements by increasing the weight allocated to informative events secondly event based calibration routines also simplify the curation of calibration and validation datasets that are both statistically similar and hydrologically diverse which is difficult two achieve with two continuous segments of data the challenge with event based calibration becomes selecting the best events out of those discretised from a continuous record recent studies have demonstrated a wide range of approaches to event selection which typically involve ranking events based on characteristics such as the return period mean intensity or total rainfall blackler and guo 2014 distinguish early spring spring summer and intense summer rainfall events their study noted that long low intensity events achieved stronger calibration performance compared to short intense events broekhuizen et al 2020 evaluate a multi event calibration scheme in which events are selected from a set of discretised events based on one of rainfall rainfall intensity mean flow total flow relative to total rainfall or rainfall duration in their calibration scheme events that fall above and below a runoff threshold are used in a two stage calibration technique consisting of first calibrating to one type of event then another their approach was found to outperform a single stage multi event approach similarly talei and chua 2012 select events based on lag time and hydrograph shape jean et al 2018 select events with the greatest total precipitation depth and mean precipitation intensity their study found that selecting events based solely on total precipitation resulted in an underestimation of extreme flow frequency and only by using a multi criteria approach to event selection which included mean intensity did the selected events produce satisfactory calibration performance singh and bárdossy 2012 demonstrate a method for identifying critical hydrological events using a statistical depth function models calibrated to critical events are found to perform comparably to models calibrated to the entire record and better than models calibrated to random events while this method is an improvement over simple ad hoc methods their approach only uses a single criterion either antecedent precipitation or discharge recently zheng et al 2022 proposed a novel framework for achieving statistical similarity between the calibration and validation datasets in which a model is run on a continuous stretch of data and the model output is deterministically sampled for calibration and validation which circumvents the need for time continuous datasets however sampling time discontinuous sets of calibration and evaluation data risks artificially high model performance compared to evaluations on time continuous data in cases where flow is highly auto correlated padiyedath gopalan et al 2019 veloz 2009 a common issue with the approaches reviewed above is that they tend to neglect the hydrological diversity of rainfall runoff events awol et al 2018 consider a rainfall event with 20 mm of total rainfall this event may be short and intense long and mild occur in the spring or the fall occur with dry or wet antecedent conditions current practises overwhelmingly rely on a single criterion resulting in calibrated models that are not guaranteed to perform well on unseen events which may have very different characteristics thus there is an opportunity for improving calibration frameworks by explicitly identifying hydrologically diverse events which will have a favourable impact on model generalisation we propose that calibration and validation events be identified using unsupervised clustering which is a simple yet proven method for data partitioning clustering techniques have been widely used in research to classify individual observations for the dual purpose of ensuring that all flow regimes are equally represented i e an equal number of low and high flows and ensuring similar statistical properties between the calibration and validation data sets bowden et al 2002 anctil and lauzon 2004 toth 2009 used a self organising map som to classify streamflow and rainfall data with several lagged copies of each evaluating the effect of varying the number of clusters has on overall model performance the study also links the som based classifications to physical hydrological phenomena e g a given class may correspond to the rising limb of the hydrograph bowden et al 2002 compared genetic algorithm ga based and som based data splitting methods finding that they both outperformed traditional approach in which data is split arbitrarily without any consideration for the statistical properties of each split similarly anctil and lauzon 2004 use an som to create subsets of data with statistically similar properties and draw an even number of samples from each cluster to form their training dataset all the examples above were conducted using machine learning ml models however as far as our knowledge extends no works have evaluated such methods on physics based models such as swmm in order to use these methods for physics based models they must be modified to accommodate time continuous segments of data which is a typical requirement for physics based models guo et al 2020 we propose a novel adaptation of clustering methods for time continuous data which will allow us to identify diverse rainfall events for calibration as well as statistically similar events for validation even with an improved method for identifying calibration events event selection is inherently uncertain which manifests as uncertain calibration results typically studies that calibrate models to multiple events fail to account for this uncertainty by aggregating multiple events into a single timeseries krebs et al 2013 awol et al 2018 or optimising the mean performance on multiple events broekhuizen et al 2020 arriero shinma and ribeiro reis 2014 we propose creating swmm ensembles as a way to handle calibration parameter uncertainty an ensemble approach preserves the equally valid model parameter sets generated by calibration to different events because predictions are aggregated as opposed to parameter estimates a multi model approach is motivated by ensemble theory which has proven both theoretically and empirically that predictions produced by ensembles consistently outperform single models brown et al 2005 the success of an ensemble is attributable to the degree of disagreement between the ensemble members which is referred to as diversity diversity can be quantified as the covariance between the error distributions of ensemble members brown et al 2005 the benefits of diversity can be explained with the bias variance covariance decomposition of mean squared error mse since the covariance can be negative greater covariance between models can reduce overall mse one way to create diversity among ensemble members is by varying the data used to calibrate each member brown et al 2005 for event based swmm calibration we suggest a novel ensemble approach in which each model in an ensemble of swmm models is calibrated to a different event creating diversity between members hence reducing overall error and improving model performance the predictions of the ensemble member are combined to form discrete predictions which has been shown to improve model generalisation for physics based models shamseldin et al 1997 beven 2012 to support our proposed use of swmm ensembles the following paragraphs provide a brief review of comparable ensemble approaches in literature and present ensemble taxonomy that is used throughout the manuscript ensembles can consist of model of different types or models of the same type referred to as heterogeneous and homogeneous respectively zahmatkesh et al 2015 heterogeneous ensembles have been widely studied and are often found to outperform any single standalone model kumar et al 2015 kauffeldt et al 2016 their success can be attributed to the diversity created by varying assumptions and structures of different modelling platforms in contrast homogeneous ensembles differ in that they all having the same model structure but different parameter values homogeneous ensembles have received comparatively less attention in research physics based hydrological model parameters are highly uncertain which translates to uncertain predictions within a homogeneous ensemble framework multiple different and equally valid model parameter sets are capable of high degrees of diversity and diverse parameter sets contribute to high ensemble accuracy brown et al 2005 examples of homogeneous ensembles of physics based hydrological models are relatively uncommon in literature compared to examples of standalone models or heterogeneous ensembles nevertheless research on homogeneous ensembles has shown promising improvements to performance seibert and beven 2009 create physics based ensembles in which each member is trained to randomly sampled data the ensemble approach is found to outperform the single model similarly liu et al 2014 use rainfall runoff models as members for the adaboost ensemble algorithm freund and schapire 1995 noting considerable improvements in performance regardless of what type of models are used as ensemble members literature has shown that ensemble generalisation is dependent on the specific combination technique used most studies that compare combination techniques do so using ml models as the ensemble base learners anctil and lauzon 2004 abrahart and see 2002 tyralis et al 2021 alobaidi et al 2019 there is a need to understand whether the improvements in performance achieved by combination techniques can be extended to homogeneous ensembles of physics based models combining predictions obtained from different parameter sets may be seen as counter intuitive especially when parameters are assumed to be time invariant which are expected to have a single correct value however significant work in hydrology has demonstrated that there is no single optimum parameter sets instead there may be numerous realistic parameter sets that are equally suitable for a given model awol et al 2018 mediero et al 2011 beven 2012 xu et al 2019 combination strategies range from simple averaging to more complex methods such as stacking in which a statistical model used as the combiner breiman 1996 several studies that compare combination strategies have found that simple averaging is hard to beat in practice but can be improved upon using methods such as stacking using a model to combine predictions if configured correctly tyralis et al 2021 kumar et al 2015 the review above highlights the need for a data driven framework for model calibration that ensures calibration and validation datasets are time continuous statistically similar and each contain diverse hydrological conditions our proposed framework features an innovative event clustering technique that we use to identify a set of calibration events we use a novel ensemble algorithm in which ensemble members are independently calibrated to different events to exploit the effects that ensemble diversity have on generalisation the final step of our framework is to combine predictions which done using four approaches two of which have not yet been evaluated for such ensembles to develop and evaluate our proposed framework we set the following objectives i to develop a multi criteria clustering approach to select hydrologically diverse time continuous events for calibrating urban rainfall runoff model this component builds on clustering methods used in ml research and investigates their efficacy on traditional physics based models i e swmm and explicitly measures the effect of event selection on model performance ii to fully realise the benefit of a diverse set of calibration events we propose an alternative approach to traditional multi event calibration predictions are made using homogeneous ensembles of multiple swmm models each calibrated to a different event in order to create diversity between members and hence improving model generalisation and performance iii study the effects that each cluster have on model behaviour using a traditional sensitivity analysis and by evaluating the performance of non diverse ensemble that is ensembles that only models calibrated events belonging to one cluster iv to investigate effects that ensemble size and combination techniques have on generalisation while these approaches have been used in ml applications they have received very little attention for homogeneous physics based models our study of ensemble combination must feature techniques that are ranging in complexity the proposed framework is applied to two case studies in southern ontario canada and is compared to baseline results from a single event swmm model using multiple performance criteria 2 methods the methods are organised into three sections that describe the swmm models the data driven framework and validation techniques the swmm model description includes the standard methods used for event discretisation calibration and sensitivity analysis the ensemble section outlines our novel framework for event selection and ensemble prediction lastly we describe a robust validation framework to verify the proposed methods 2 1 swmm model setup 2 1 1 study area and model creation two catchments located within the etobicoke creek and don river watersheds in the greater toronto area in southern ontario canada were selected for this study these catchments were selected based primarily on their flood vulnerability and the heavily urbanised and rapidly changing landcover as identified by the toronto and region conservation authority trca an advantage of these specific catchments is the availability of high resolution forcing and spatial data openly provided by the trca the catchments under study have outlets at spring creek south scs and taylor creek south tcs which are in the etobicoke creek and don river watersheds respectively table 1 provides catchment properties both catchments can be characterised as urbanised based on impervious landcover they are close to one another geographically have a similar size and their models contain a similar number of subcatchments because of their similarity they can be used to verify the proposed framework on one another the swmm models used in this study were created from scratch using openly available spatial and temporal datasets fig 1 shows the conduits subcatchments raingauges and outfalls of each model models were constructed beginning with a user specified streamflow gauge which was used the outfall in swmm a 2 metre resolution digital terrain model dtm government of canada 2022 was used to calculate flow accumulation pathways and catchment boundaries using a traditional delineation approach procedure in arcgis pro o callaghan and mark 1984 morris and heerdegen 1988 stream burning was performed based on mapped hydrological features maintained by the trca 2020 which is an enforcement technique that improves the accuracy of the spatial analysis by subtracting known flowpaths from the dtm surface prior to calculating dtm derived flowpaths and catchments to encourage agreement between derived and observed flowpaths lindsay 2016 flow accumulation pathways were further pruned to better match the existing watercourses the catchments delineated for the scs and tcs gauges were each discretised into subcatchments based on the nodes of the dendritic network of flowpaths streams were assumed to have a simple rectangular geometry stream widths were estimated using methods described in mulvihill et al 2009 in which empirical regression equations are used to relate drainage area to stream geometry these equations were found to be relatively accurate and were developed using streamflow data from the southeast coast of lake ontario geographically near the catchments herein most channel and subcatchment parameters were calculated using spatial datasets including soil agriculture and agri food canada 2022 dtm government of canada 2022 and land cover province of ontario and ministry of natural resources and forestry 2022 raingauges obtained from the trca 2020 were assigned to subcatchments based on the minimum euclidian distance between the gauge locations and subcatchment centroids which resulted in two unique gauges for each catchment listed in table 1 the process above was used to generate shapefiles representing outfalls conduits junctions subcatchments and raingauges which were exported to matlab to create swmm models rainfall data and observed flow data was processed in matlab and converted to binary model files using swmm events containing flags for snow and ice conditions in the records obtained from environment canada 2022 were removed from the selection these events were not included because cold weather processes e g snow accumulation were not parameterised in the models snow events were omitted for several reasons snow ploughing and storage is complex in urban areas and the data is unavailable sensors often become obstructed during winter months and cold weather events do not always produce runoff aquafor beech 2016 despite the omission of snow in this study our proposed methods could be used with models in which snow processes are represented a warm up period of 24 hours was generated for each event under study to accommodate varying initial conditions for each event based simulation we developed a wrapper for swmm in matlab which allowed us to run simulations and edit model parameters from the matlab environment several considerations were taken to improve the computational efficiency of the analyses conducted the geometry of subcatchments and conduits are simplified vertices removed in order to minimise file write times during calibration binary rainfall and warmup files were generated for each event under evaluation to reduce simulation runtimes a complete list of routines is provided in appendix a and fig a 1 illustrates how matlab was used to interact with swmm the complete swmm wrapper is available on github all computations were conducted on a workstation with the following specifications cpu amd ryzen 3700x ram 32 gb ddr4 gpu nvidia geforce gtx 1660 software versions are python 3 7 9 within arcgis pro 2 7 0 matlab 2021a and swmm 5 1 14 threads were used for the simulations 2 1 2 rainfall event discretisation rainfall and stage data were collected at point source gauges at a 15 minute resolution for a period beginning in may 2002 and june 2006 for scs and tcs respectively and ending in may 2021 the mean aerial weighted rainfall was used to perform the rainfall event discretisation and selection for each catchment isolating data used to calibrate and validate the swmm model is a two step process event discretisation and selection event discretisation is described in the paragraph below while selection is included in section 2 2 1 in the context of the ensemble framework event discretisation is the process of identifying rainfall runoff events from a continuous record the most common and simplest procedure for discretisation uses a minimum inter event time mit during which there is negligible rainfall to identify the start and end points of events nojumuddin et al 2018 while sophisticated discretisation approaches have been developed in previous research thiesen et al 2019 the mit based approach was chosen due to its widespread use in research nojumuddin et al 2018 jean et al 2018 behera et al 2010 and applied settings aquafor beech 2016 the us epa and ontario ministry of the environment conservation and parks recommend an mit of 12 h aquafor beech 2016 however it is also important to consider catchment characteristics and runoff response while selecting an mit value joo et al 2013 the hydrographs of the target stream gauges in each catchment have long receding limbs therefore a longer mit of 24 hours was selected to ensure that the entire event hydrograph is captured in the simulation a long mit permits enough time for the receding limb of the event hydrograph to approach its baseflow value at the beginning of the event uninterrupted by new rainfall events consequently rainfall events are larger in magnitude and duration compared to events discretised using a shorter mit a buffer time of 24 h was appended to the end of each rainfall event to ensure that the runoff response is fully captured lastly events with a total rainfall of less than 5 mm were excluded from the analysis as events of this size may not produce any runoff in urban catchments such as those used in this study aquafor beech 2016 2 1 3 sensitivity analysis the sensitivity of rainfall runoff model parameters is often analysed to develop a sense of model behaviour and fine tune calibration swathi et al 2019 perin et al 2020 these analyses are used to distinguish sensitive and insensitive parameters as to select only the most sensitive parameters for calibration existing research has shown that there is no globally sensitive set of parameters for hydrological models and that parameter sensitivity should be calculated on a case by case basis knighton et al 2016 however with the emergence of automated calibration techniques the usefulness of removing insensitive parameters from calibration routines should be questioned the sensitivity analysis presented in this study has a dual purpose foremost we wanted to assess difference in parameter sensitivity between events in different clusters additionally we wanted to test whether removing insensitive parameters offers any improvements to model calibration in terms of computational time or performance the sensitivity analysis in this research was conducted for each individual event the sensitivity analysis was conducted using a one at a time approach which has been widely used in rainfall runoff modelling shin and choi 2018 xu et al 2019 shahed behrouz et al 2020 campolongo et al 2007 instead of analysing the sensitivity of individual parameters i e on a subcatchment basis sensitivity is analysed for groups of individual parameters across the entire catchment this drastically reduces computational costs at the expense of information on the sensitivity of individual parameter values while still being generally effective in identifying sensitive parameters barco et al 2008 shahed behrouz et al 2020 campolongo et al 2007 total volumetric flow and peak flow were used as model response variables for the sensitivity analysis which are given by the following respective equations 1 q ˆ v q ˆ δ t 2 q ˆ p max q ˆ where q ˆ v q ˆ δ t q ˆ p are the predicted total flow volume predicted flow timeseries timestep and predicted peak flow the timeseries predicted by swmm q ˆ are formulated as a function of a parameter set x and observed rainfall p 3 q ˆ f x p each initial parameter x 0 within a given group is varied by α 4 i α f x 0 1 α p f x 0 p α where i α is the sensitivity of some parameter x with an initial value x 0 that is modified by a fraction α when subject to a precipitation event p the calibration parameter names sections units relative uncertainty and upper and lower constrains used in this research are listed in table 2 where a physical constraint on a parameter exists e g the upper limit of percent impervious landcover we truncated parameter values to meet the constraint and recalculated parameter sensitivity based on the subcatchment area weighted mean ten values for α were considered which increase linearly from the lower bound of parameter uncertainty to the upper bound for example the percent imperviousness which has a relative uncertainty of 0 2 is evaluated for α values of 0 04 0 08 0 12 0 16 and 0 20 the overall sensitivity i of the model to a given rainfall event p was taken as the absolute mean across a total of 10 denoted as m values of α considered 5 i 1 m j 1 m i α j following the sensitivity analysis we conduct calibrations using different configurations of parameters to test whether removing insensitive parameters is useful the study of calibration configurations was conducted on one event from each cluster for each catchment the configurations used in this study are as follows i baseline uncertainty calibration ii double uncertainty calibration iii sensitive parameter calibration iv insensitive parameter calibration we refer to calibration using expert knowledge informed uncertainty as baseline uncertainty the double uncertainty configuration uses the expert based relative uncertainty multiplied by a factor of 2 which is used to assess whether further improvements to model accuracy can be achieved by expanding the parameter search beyond expert judgement lastly the sensitive parameter and insensitive parameter use the five most sensitive and insensitive parameters respectively as determined by the sensitivity analysis 2 1 4 model calibration as mentioned above swmm predictions are a function of a calibration parameter set and rainfall event event based calibration is given by the following general expression 6 x argmax g q f x p where g is the objective function given in eq 7 below f is the swmm model with parameter set x bound by uncertainty and physical constraints forcing rainfall data p and observed flow q the kling gupta efficiency kge was used as the objective function in this work gupta et al 2009 7 kge 1 r 1 2 α 1 2 β 1 2 where 8 r cov q q ˆ σ q σ q ˆ 9 β α σ q σ q ˆ 10 β μ q ˆ μ q where σ and μ denote the standard deviation and mean statistics respectively for flow q and predicted flow q ˆ a wide variety of optimisation algorithms have been applied for swmm calibration niazi et al 2017 we used a standard ga for because of its popularity competitive performance when compared against other common optimisation algorithms and because the optimisation algorithm itself is not a focus of our research jeon et al 2014 niazi et al 2017 the ga is an evolutionary algorithm that searches for a global minimum by iteratively breeding new populations of parameter estimates each new population is created using crossover and mutation which are applied to the best performing populations in each generation important hyperparameters for the ga include population size mutation rate crossover fraction to which we assigned values of 40 0 01 default and 0 8 default respectively the ga terminates when it meets one of several stopping criteria which included maximum number of generations function tolerance and maximum stall generations for which we used values of 100 1e 4 and 5 respectively when the ga does not improve the objective function by the tolerance for five consecutive generations the algorithm terminates ga hyperparameter sensitivity was assessed using trial and error increasing the population size beyond 40 had little effect on the optimisation and the algorithm typically terminated due to the objective function levelling out at approximately 40 generations well before the maximum number the ga was implemented using the native ga algorithm in matlab which is included in the optimisation toolbox matlab 2021 2 2 swmm ensembles typically swmm predictions are generated using a single model which is calibrated to one or multiple events in this study we propose a data driven ensemble framework for swmm that uses models that are independently calibrated to individual events as base learners the novel framework is depicted in fig 2 which begins with discretising events from a continuous record next diverse events are identified using our novel clustering method described in section 2 2 1 a set of events are sampled based on their cluster to individually calibrated swmm models which form ensembles finally ensemble predictions are combined using one of four combination methods described in section 2 2 2 two of which are innovative in that they can utilise real time hydrometric data to improve ensemble accuracy our proposed framework will provide a data driven solution to calibration event selection preserve multiple model parameter sets and the ensemble is expected to improve generalisation 2 2 1 identification of diverse hydrological events using unsupervised clustering clustering is proposed as a way to meet our first objective of identifying diverse time continuous events for model calibration and validation we apply clustering to characteristics derived from a set of rainfall runoff events while event selection is typically conducted using only rainfall based event characteristics broekhuizen et al 2020 szela g et al 2022 sun et al 2014 we simultaneously considered both rainfall and flow characteristics toth 2009 which encourages hydrologically diverse events our novel approach uses clusters events based on event characteristics including total precipitation p peak intensity i p mean intensity i μ duration d date peak flow q p flow volume q hydrograph centroid coordinates q c t and q c y and hyetograph centroid coordinates p c t and p c y the selection of these specific features as the criteria with which to distinguish diverse rainfall runoff events is supported in existing studies on event selection barco et al 2008 hossain et al 2019 blackler and guo 2014 additionally the event date day of year was also used as the time of year is important to consider in distinguishing between different hydrological events hossain et al 2019 barco et al 2008 blackler and guo 2014 including the date among the event statistics enables the clustering algorithm to distinguish between annual seasons as events of similar magnitudes occurring at different times of the year may have different dominant hydrological processes the day of year of each event is converted to radians then the sine and cosine are taken for the features which is a way to pre process dates that preserves the cyclical nature of the days of the year abrahart et al 2001 we used an som to cluster rainfall runoff events which is an unsupervised neural network based classification technique several studies have demonstrated the use of soms for hydrological timeseries clustering as a pre processing technique for ml models toth 2009 anctil and lauzon 2004 typically examples of clustering based training data selection will select an even number of samples from each cluster discouraging model bias towards particular flow conditions in our framework this is achieved by selecting the same number of events from each cluster maximising the number of clusters is preferable as it would increase the diversity of represented flow conditions and in turn the diversity of the calibrated ensemble members however a disadvantage of more clusters is that it may result in clusters that only contain one or two events thereby if we want to draw a balanced number of events from each cluster we are constrained by the number of events in the smallest cluster consequently we use only two clusters in our study using two clusters results in an ample number of events in cluster enabling us to study the effects of model performance across an increasing ensemble size and complete our third objective something that would not be possible with a greater number of clusters our proposed event selection scheme is as follows i cluster events into k clusters in which k is constrained by the number of events in the smallest cluster n ii select n events from each cluster prioritising events nearest the cluster centroids iii calibrate individual swmm models to each event k n events if using an even number from each cluster iv generate discrete predictions by combining predictions from all swmm models our second objective is to exploit the diversity created by clustering events by creating a homogeneous ensemble of swmm models to assess differences in performance between ensembles that use events from different clusters we evaluated events in both clusters using 1 only models calibrated to cluster 1 events 2 only models calibrated to cluster 2 events and 3 using models calibrated to an equal number of events in each cluster ensemble predictions that use events from a single cluster are denoted as ec x where x is the numeric cluster label and ensembles that use a balanced number of events from each cluster are denoted ecb this will allow us to confirm whether models calibrated to a given type of event will perform best on the same type of event while also quantify the effects of including a balanced amount of information on each event cluster these configurations were also studied across an increasing ensemble size in order to better understand how many individual models are required for satisfactory performance 2 2 2 combination methods to create an ensemble a set of m models are combined to form a single prediction according to eq 11 below 11 q ˆ h q 1 ˆ q 2 ˆ q ˆ m where h is the combiner function that combines predictions q ˆ for models calibrated to events 1 to m our third objective is to investigate the performance of different ensemble combination techniques we evaluate four common combination techniques two weighted approaches uniform and non uniform weighting and two stacking approaches multiple linear regression mlr and artificial neural network ann based stacking shamseldin et al 1997 tyralis et al 2021 the stacking combiners have the option to leverage real time hydrometric data to further improve prediction accuracy weighted combination is among the most popular techniques for aggregating or combining ensemble predictions sharkey 1996 uniform weighting is the most common weighting scheme and has been described as hard to beat in practice tyralis et al 2021 there are methods for tuning the ensemble combination weights which are capable of outperforming uniform weighting schemes tyralis et al 2021 in this research we evaluate both uniform and non uniform weighting schemes for the weighted scheme the weight allocated to each ensemble member is calculated as the mean cross validation performance on the events used to calibrate the other ensemble members in a weight vector of length m the weight of an individual model is given by eq 12 12 w m 1 m 1 i 1 i m m g q q ˆ i the weight vector is then normalised such that its sum is equal to one 13 w n o r m w w the remaining two combination methods use stacking which is a combination technique in which a model is trained to combine other models commonly referred to as a meta learner originally stacking was proposed using multiple linear regression mlr breiman 1996 however a wide variety of different models can be used as the meta learner more complex models such as anns can map non linear relationships between input data swmm predictions and target data observed flows providing greater compensation for potential deficiencies of the swmm models sharkey 1996 however a more complex meta learner introduces the risk of overfitting hence poor generalisation to determine whether increased complexity of the meta learner is warranted this work evaluates both a linear model and ann the input datasets used to train the stacking meta learners are constructed by first concatenating the predictions obtained for each event from each swmm model one advantage of the stacking approach is the ability to supplement the meta learner with historic and exogenous data bento et al 2021 the predictions of each swmm model in the ensemble are used as the input feature set next we augment the input feature set using flow lagged by a forecast lead time of 12 hours and aerial mean precipitation data five lagged recurrences of each flow and precipitation are used in the feature set lag times are determined based on maximising the cross correlation function between each of the exogenous input features and the observed flow tiwari and chatterjee 2010 the configuration of the linear model is trivial but some consideration is required for the configuring the ann best practises are employed to encourage strong ensemble generalisation specifically we use stop training and bagging which have both been shown to improve ann generalisation anctil and lauzon 2004 due to being highly flexible models anns are prone to overfitting stop training involves withholding a subset of ann training data from the calibration procedure to use as a calibration termination criterion during training if the performance of the withheld data does not improve across multiple ann parameter adjustments training is terminated the number of consecutive parameter adjustments with no improvements until training termination is referred to as the patience for our anns we withheld 50 of the training data for stop training and used a patience value of 6 the stop training data is allocated using block splitting the training data is divided into 10 time continuous blocks and alternatingly assigned for training and stop training block splitting in contrast to random sampling preserves the time dependency structure contained within the flow data li et al 2010 bagging is a widespread ensemble technique in which the training data for each ensemble member is resampled from the original training set with replacement and the average model predictions are used bagging is successful due to the diversity obtained from the varying training data for each ensemble member which is the same mechanism that motivated our proposed ensemble framework grid search optimisation was used to evaluate ensemble sizes of 2 n for n values of 1 to 7 ensembles were evaluated based on 50 randomly selected validation data consistent with previous studies shu and ouarda 2007 zaier et al 2010 increases in ensemble size were found to improve generalisation performance typically stabilised at an ensemble size of 32 the largest size of 128 was used as it ensures sufficient resampling and only has a marginal impact on computation time grid search optimisation was also used to determine the ann model architecture which consists of a single layer of 8 hidden neurons the levenberg marquardt backpropagation algorithm is used to train the individual anns a robust validation procedure described in the upcoming section further helps to ensure that the stacking models are parameterised properly 2 3 validation techniques while comparing different calibration procedures the objective function kge described in eq 7 is used which ranges from an optimum value of 1 to while there is no inherent reference point for kge values predictions that are more accurate than the historic observed mean produce a kge greater than 0 41 and are considered acceptable whereas kge values less than 0 41 are considered unacceptable knoben et al 2019 for the comparison of ensemble combination techniques additional performance metrics are used including the peak flow error pfe which is the difference in the maximum observed and maximum simulated flows and the mean volume error mve which is the difference in observed and simulated total flow volume during the event the latter two are defined as follows 14 pfe max q max q ˆ max q 15 mv e q q ˆ q where q and q ˆ are the same as described earlier in physics based hydrological model calibration literature validation is often performed on a single event or altogether absent niazi et al 2017 cristina et al 2017 this is problematic especially for applications such as flood forecasting since a physics based model calibrated to a particular event s is not guaranteed to maintain its accuracy on other events especially events with flow conditions that are dissimilar to those contained in the calibration data beven 2012 since multiple swmm models are being calibrated in this study each model is evaluated on each event excluding the event used for calibration for example if there are 10 discretised events each event will be evaluated using the 9 remaining models and thus have 9 performance scores for ensemble predictions which use predictions from multiple swmm models it is necessary to consider different combinations of models that can be used to generate predictions for each validation event as different combinations of predictors will produce different ensemble predictions for example consider a set of 10 events which we want to evaluate using ensemble predictions that contain 4 members for each event there are 9 models available with which to produce ensemble predictions resulting in 126 unique combinations of models that can generate predictions given by 9c4 ideally we would evaluate every single unique combination of predictors however this becomes very computationally expensive for methods such as stacking where a unique meta learner is trained to each unique combination another problem that arises is that trying every possible combination does not scale well with increasing numbers of available models in cases with more than 100 unique combinations we randomly sample 100 combinations with which to make predictions since different subsets of models do not perform the same using resampled subsets quantifies the associated variability in performance 3 results this section presents the results of the event selection sensitivity analysis calibration and ensemble predictions 3 1 event discretisation and selection the outcome of the som based unsupervised clustering approach is illustrated in fig 3 for scs and 4 for tcs in which clusters are distinguished by colour differentiating characteristics can be identified from the bottom most rows and from the histograms along the diagonals in the scatter plot matrices for both catchments events are segregated based primarily on total flow and precipitation cluster 1 events green tend to be small and frequent while events in cluster 2 purple tend to be large and infrequent additionally events in cluster 1 tend to have a shorter duration and lower mean intensity compared to those in cluster 2 the day of year can be read from the sine and cosine components which form a ring as shown in figs 3 and 4 when plotted against one another the midpoint along the sine axes and upper limit of the cosine axes correspond to january 1 and the day of year increases in the clockwise direction with one rotation corresponding to a year there is no clear discrimination based on event date though cluster 2 events tend to occur mostly during summer to late fall the event date is expected to have a larger influence on the clustering outcome as the amount of available data and the number of clusters increases since the numeric cluster id is arbitrarily assigned by the unsupervised learning algorithm events are reclassified based on the ascending rank of the total flow of each cluster centroid to achieve a consistent numeric notation between catchments cluster properties are summarised in table b 1 and two representative events from each cluster are illustrated in fig b 1 a set of events for the analyses presented in the following sections is generated by sampling 10 events from each cluster events are selected based on minimising their euclidian distance between each event and the corresponding cluster centroid ensuring events are representative of their cluster encourages dissimilarity between events in different clusters otherwise there is a risk selecting events that are near the cluster boundary and thus not diverse the analyses presented in the following sections are conducted using strictly the subsets of 20 events 10 from each cluster for each catchment the properties of these sampled events are provided in tables b 2 and b 3 for the scs and tcs subcatchments respectively 3 2 sensitivity analysis the following one at a time sensitivity analysis was conducted to determine whether there are significant differences in parameter sensitivity between cluster 1 and 2 events parameter sensitivities for events in clusters 1 and 2 are plotted against one another in fig 5 each parameter has a unique colour symbol combination and the uncertainty lines indicate the full range of total flow left and peak flow right sensitivities across the 10 events in each cluster the sensitivity analysis results are in complete agreement for both catchments the subcatchment imperviousness and width are two most sensitive parameters for peak flow and volume peak flow is also sensitive to changes in the overland flow manning s n for impervious surfaces and subcatchment slope this result indicates that runoff from impervious surfaces is the dominant process contributing to the runoff response of both catchments the model sensitivity to subcatchment slope width and manning s n are likely disproportionately high due to the lack of a modelled minor stormwater system the parameters of which would likely also impact peak flow notably the antecedent moisture content imd parameter which is widely considered to be a very important parameter for rainfall runoff model performance tramblay et al 2010 is insensitive to both event clusters and catchments the position of parameter sensitivity values relative to the 1 1 line illustrates whether it is more sensitive to clusters 1 or 2 parameters below the 1 1 line are more sensitive to cluster 1 events and parameters above the line are more sensitive to cluster 2 events there are no drastic differences in parameter sensitivity between the two clusters parameter sensitivities are centred about the 1 1 line indicating sensitivity to types of events though parameters are all marginally more sensitive to cluster 1 events sensitivities are also more variable to different cluster 1 events illustrated by the uncertainty lines typically being broader than they are tall the high sensitivity of the percent impervious parameter is consistent with recent research by awol et al 2018 for a swmm model in a nearby catchment with similar land cover and geography sensitivity analyses often serve to identify insensitive parameters in order to remove them from ga based model calibration however our results illustrate that this does not yield any improvements in terms of calibration time or performance fig 6 illustrates the maximisation of kge plotted against time recorded at each new ga generation for the baseline uncertainty calibration expert knowledge based and for the three other configurations double uncertainty sensitive parameter and insensitive parameter calibration the baseline uncertainty double uncertainty and sensitive parameter calibration configurations which are described in section 2 1 3 are effectively identical for both events and catchments these results demonstrate how eliminating insensitive parameters from calibration which is commonly done hossain et al 2019 awol et al 2018 shahed behrouz et al 2020 niazi et al 2017 does not impact the ga optimisation in terms of kge obtained or calibration duration the case with double uncertainty bounds confirms that the expert knowledge based uncertainty bounds are well defined and the ga cannot achieve a much better solution beyond the initially imposed expert knowledge based constraints the insensitive parameter calibration validates the outcome of the sensitivity analysis as the ga was unable to produce any noteworthy improvements 3 3 single event calibration outcome the outcome of all the single event calibrations and cross validation is shown in fig 7 the heatmaps show the performance of all 20 models each calibrated to a single event on every event within the set the colours show the kge of each combination blue to red indicate good to poor performance the diagonal of the matrix indicates the kge achieved during calibration in other words the event used for calibration and validation is the same strong cross validation of a model calibrated to a given event is indicated by a row dominated by blue colours indicating a high kge when cross validated on other events from the lower right and upper left quadrants of these figures models calibrated to cluster 2 events tend to perform better on events in their own cluster compared to the performance of events calibrated on cluster 1 events the models calibrated to cluster 2 events also exhibit better validation across clusters illustrated by the kge values in the upper right quadrant which are similar to those obtained on their respective cluster however the opposite it not true as shown in the lower left quadrants models calibrated to cluster 1 events do not perform as well as they do on events in their respective cluster as expected the highest kge on any given event is achieved during calibration along the diagonal though there are some exceptions the calibration kge for events 6 scs and 4 tcs are surpassed by models calibrated to different events indicating that a more optimum parameter set may exist than that returned from the ga optimisation however the difference in performance is marginal and given that none of the other calibrated models achieve satisfactory performance on those events this suggests that unsatisfactory performance may not be due to the optimisation algorithm itself but rather that a better solution does not exist within the optimisation search space colour trends in the vertical direction indicate how well different models perform on a given event for example squares in the vertical direction show that none of the calibrated models achieved acceptable performance on the event as is the case for event 6 scs and 20 tcs likewise dominant red colouring along the horizontal direction such as for events 3 scs and 9 tcs indicate that models calibrated to those events do not perform well on any other events there are some cases such as events 3 scs and 3 tcs where the model achieves a good kge value during calibration but fails to generalise to most other events within the set meanwhile many other models achieved satisfactory performance across the set of events indicating that the model parameterisation and uncertainty are not at fault instead poor cross validation may be due to the ga overfitting the swmm model these results demonstrate the poor cross validation performance of single event swmm models as well as the high variability in performance across events especially across different clusters the poor cross validation performance highlights the opportunity for ensemble techniques to improve generalisation ensembles are formed by combining the predictions obtained from models that are each calibrated to different events which is discussed in the following section 3 4 comparison of ensemble member configurations here we present a comparison in performance between the single model and uniformly combined ensemble predictions the purpose of this analysis is to evaluate whether we can improve swmm generalisation using simple ensembles and to determine what role that the type of events as determined using clustering have on generalisation specifically we consider uniformly weighted ensembles using only models calibrated to events belonging to a single cluster using models calibrated on events from both clusters and varying numbers of ensemble members as a reminder the notations ec x and ecb are used for ensemble predictions based on models calibrated to a specific cluster and an equal number of events from each cluster respectively fig 8 illustrates the changes in performance of the ec1 ec2 and ecb relative to the mean single model performance the mean single model performance is calculated by evaluating a given event using all remaining events subplots are ordered by cluster and the colour coded event id is indicated in the bottom right corner of each subplot single cluster ensembles ec1 and ec2 tend perform best when evaluated on events in their respective cluster with only a few exceptions such as events 3 18 17 scs and 5 tcs ensembles consistently outperform the mean single model predictions except for single cluster events on their validation events in the opposite cluster e g ec1 evaluated on cluster 2 events which usually results in a decrease in performance the performance of the ecb ensembles is consistently between the ec1 and ec2 configurations there are several cases where the ecb ensembles match the performance of the better single cluster ensembles such as for events 11 12 scs and 1 5 15 tcd finally there is a lone instance where the ecb ensembles outperforms the others on event 10 tcs the mean kge of all ensembles tends to remain constant or increase as with an increasing number of predictors the kge of some configurations increases by as much as 0 1 to 0 2 between ensembles with the fewest and most predictors such as for event 1 4 scs and 7 10 17 tcs the shaded area in fig 8 shows the spread in performance of different combinations of calibration events to better visualise the effects that event combination has on model performance the variance of performance is calculated for each ensemble size and illustrated in fig 9 while the variance in performance ranges by an order of magnitude between events the variance of all 3 configurations consistently decreases as the number of models increases the variance of the ensemble models approaches zero as the number of predictors approaches the number of models available in the set of sampled events comparably if a model were trained on every event on record there would be no need for event selection these plots demonstrate how the variance in performance exponentially decays as information from more events linearly increases for calibration this result highlights the high degree of uncertainty when making predictions based on a single event with exponential improvements in prediction consistency as the calibration event set grows the ec1 predictions typically have the highest variance for the scs catchment whereas the ec2 predictions have the highest variance for tcs this result suggests that the variability in model performance owed to event selection is unique to individual catchments despite both catchments in this study being similar in size location and land use most importantly fig 9 illustrates that including information from several events for predictions is essential for achieving stable performance for example selecting a subset of two events for calibration produces highly variable performance when the events are sampled from a set of events that have similar characteristics as determined by the som according to this figure stable performance is only achieved with ensembles of models calibrated to 6 different events or 12 6 from each cluster for the ecb configuration 3 5 evaluation of combination techniques next we present a comparison of different methods of combining the predictions of ensemble members the following analyses include only ecb configurations in order to not bias performance towards any given event class results are illustrated in fig 10 which compares the performance for each combination technique based on three criteria kge mve and pfe for reference the calibration and single model performances are also shown the mean performance rank and variance are also summarised in tables 3 and 4 given the variability of performance between different events configurations are ranked for each event and the mean rank is reported the ranks of pfe and mve are calculated based on the absolute value of error the variance is also reported while the uniformly weighted ensemble has almost no variance the other combination methods can introduce variability the best combination technique have the highest rank and lowest variance the calibration performance while included in the rank analysis is only provided for reference and cannot be used in practice out of the four combination techniques and three performance criteria ann based stacking produces the best overall results achieving the highest rank in 3 out of 6 cases 3 metrics for 2 catchments in fact ann based stacking exhibits comparable or better performance than the calibration model on events 17 6 7 16 18 scs 11 19 tcs demonstrating very strong generalisation the non uniformly weighted combination also does notably well achieving the highest pfe rank for both catchments 4 discussion the clustering approach presented in this research provides a means of achieving diverse time continuous and statistically similar calibration and validation datasets we consider this to be a substantial improvement over traditional approaches to event selection which overwhelmingly rely on subjective methods and or single criteria our clustering method can be easily adapted to use different clustering algorithms or event characteristics for example expanding the clustering criteria to include features such as temperature may be useful in cold climates which would encourage the distinction between cold weather and warm weather events which typically involve different hydrological processes to demonstrate the motivation for our proposed framework we first illustrated the poor cross validation performance of models calibrated to single events while models tend to validate well on events with similar characteristics in the same cluster they perform poorly on events in the other cluster this also showed how calibration to different events produces different optimised parameter sets we introduced homogeneous ensembles as a technique to utilise the parameter sets obtained from calibrating a swmm model to different events ensembles consisting of models calibrated to events in a given cluster perform well when validated on events in the same cluster and poorly across clusters ensembles calibrated to a balanced number of events in each cluster perform somewhere in between but typically much better than the mean single model the single cluster ensembles demonstrate the benefits and disadvantages of non diverse calibration events this finding can be applied to achieve balanced performance on different events or performance improvements on specific flow conditions alternatively this ensemble framework can be expanded to a modular format in which ensemble members are selected as predictors based on anticipated flow conditions for example if a large event is anticipated predictions could be made using only the models calibrated to similar events we also show how the increasing the ensemble size generates minor improvements in performance as well as a reduction in performance variance the performance of ensembles with three or fewer models tends to have high variance which decreases as more and more events are included we recommend maximising the number of events for calibration reserving statistically similar events for validation and caution against using less than 4 events as model performance may be very sensitive to the events used the improvements produced by our proposed method are consistent with previous studies that implicitly identify diverse events jean et al 2018 singh and bárdossy 2012 however the methods proposed in previous studies do not guarantee that selected events are hydrologically diverse and therefore are not guaranteed to improve model generalisation in contrast using clustering ensures a diverse set of calibration events lastly we evaluate four ensemble combination techniques in order to determine whether they can be used to generate further improvements in model performance using both the single model and calibration performance as baselines the performance of combiners is consistent between both the scs and tcs catchments the ann based stacking method which allows for the addition of exogenous data at the combination stage is the best combiner on average across all catchments and performance criteria the effects of exogenous input variables in model combiners are consistent with a recent power load forecast study by bento et al 2021 which found that models with exogenous inputs outperform those without and ensembles with exogenous inputs outperform standalone counterparts the weighted combination achieves the highest mean pfe rank while the stacked models tend to over predict peak flows the stacked ensembles also tend to exhibit lower or positive volume error compared to the other combination techniques we attribute this to the fact that they are not constrained to mass conservation laws unlike the convex combined models the strong performance of the non uniformly weighted ensembles is consistent with previous works tyralis et al 2021 found that a convex weighted combination of machine learning models outperformed single model and uniformly weighted model performance similarly kumar et al 2015 found that a similar method constrained multiple linear regression performed the best out of six different combination strategies based on these results unconstrained combination techniques such as stacking are well suited to overcome certain physics based model behaviour such as total volume underestimation however our results showed that this resulted in slight overestimation of peak flow magnitudes of course part of the success of the stacking based methods is due to its use of exogenous sensor data for prediction which is not always available in real time the stacked combiner can be configured with or without exogenous data however we expect to see a slight decrease in performance without this data the uniformly weighted and non uniformly weighted combinations exhibit almost no variance associated with event selection whereas the stacking methods introduce some variance in performance it remains much lower than the variance in performance between models calibrated to different single events the stacking variability is owed to the calibration of the combiner i e mlr or ann these results highlight how a simple uniform combiner can produce considerable improvements over the single model scenario while eliminating the uncertainty associated with single event selection stacked combinations create further improvements which we attribute to their ability incorporate real time data and overcome volume balance errors the main limitation of this work presented above is that the methods were only applied to two low complexity swmm models more complex swmm models may produce even greater variability in performance between different events due to having higher degrees of freedom therefore future studies should consider swmm models with varying degrees of complexity similarly a large scale study should include catchments that represent a broad range of hydrological conditions which would be used to further test the proposed methods another limitation of this work is the use of two event clusters this study used two clusters to ensure that enough events are available for the validation scheme increasing the number of clusters will improve the diversity of the calibration event set further and is expected to produce further improvements to model generalisation the factor limiting the number of clusters is the amount of available historic data more data increases the likelihood of multiple occurrences of infrequent events resulting in larger cluster sizes 5 conclusion the primary objective of this paper was to develop an improved method for calibrating urban rainfall runoff models in such a way that preserves time continuity identifies statistically similar calibration and validation datasets and achieves strong generalisation we accomplish these objectives using a novel ensemble framework that relies on unsupervised clustering to identify calibration and validation events within our ensemble models are distinguished by the events to which they are calibrated creating diversity and improving generalisation the main findings of our paper are summarised as follows first we conduct a sensitivity analysis which indicates that there is little difference in parameter sensitivities between event clusters we used the 5 most sensitive parameters to demonstrate how filtering insensitive parameters has no effect on ga based model calibration a systematic cross validation analysis revealed that single models generalise poorly especially on dissimilar events as indicated by the clustering results ensembles were created using events from a single cluster which were found to cross validate well on similar events but poorly across clusters meanwhile ensembles with an even number of events in each cluster are a compromise in performance between the two single cluster ensembles while still outperforming the mean performance of the non ensemble models increasing the number of models in each ensemble was shown to improve performance and reduce variance associated with the random selection of ensemble members several different ensemble combination techniques were compared including uniform weighted mlr based stacking and ann based stacking out of four methods ann based stacking was found to produce the strongest performance across kge and mve while weighted combination produced the best pfe all swmm ensemble techniques outperform the mean single model performance in every metric and catchment except one demonstrating the value of the proposed methods credit authorship contribution statement everett snieder conceptualization methodology software validation formal analysis data curation writing original draft visualization usman t khan conceptualization methodology validation resources writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper funding this work was supported by the natural sciences and engineering research council of canada rgpin 2017 05661 and graduate student support for es provided by york university and through an nserc pgs d scholarship appendix a matlab interface a hierarchical list of functions programmed for this study is included below these are based around creating a swmm class object in matlab with class functions to import swmm models within matlab through shapefiles or existing inp files run simulations modify simulation and model parameters create binary rff and hsf files another class event data is effectively a collection of hydrological timeseries that are discretised from a continuous record this class is often an input to the swmm class functions and has respective class functions for calculating event characteristics and clustering which are used to generate the swmm ensembles the complete swmm wrapper presented in this work is available on github https github com everettsp swmm m appendix b hydrological events see fig b 1 and tables b 1 b 3 
2110,hydrological models such as the stormwater management model swmm are essential tools for managing water resources model performance typically relies on calibration to historic rainfall runoff events however traditional calibration techniques suffer many issues such as ad hoc event selection ignoring model parameter uncertainty and poor validation techniques we introduce a novel ensemble framework that relies on data driven event selection of calibration and validation events to achieve robust model generalisation the proposed framework is applied to swmm models for two urbanised catchments in southern ontario canada the framework uses unsupervised machine learning to cluster rainfall runoff events events in different clusters have diverse characteristics sampling events from each cluster ensures a diverse set of events for calibration validation events can be sampled in the same manner which ensures similarity between calibration and validation data we study the effects that the calibration event cluster has on model sensitivity and generalisation only minor differences in model parameter sensitivity were observed between different clusters however the cluster s used for calibration were found to be very important for model generalisation next we generate ensemble predictions which use multiple swmm models each calibrated to different events ensemble performance is compared to the single model baseline and across increasing numbers of ensemble members results demonstrate improvements in generalisation and decrease in prediction variance across increasing ensemble size finally we compare several different techniques for ensemble combination which increase in complexity from simple averaging to ann based stacking augmented with exogenous input features the ann based stacking performs the best according to two out of three evaluation criteria simple averaging while inferior in performance to stacking consistently outperforms the single model baseline the novel framework proposed in this work provides a data driven adaptable alternative to conventional calibration frameworks that have been proven to improve model performance graphical abstract keywords swmm data selection unsupervised clustering homogeneous ensembles hybrid modelling stacking ensemble diversity data availability we cannot share data but it is available online the code used has been made publicly available and is linked in the manuscript 1 introduction physics based hydrological models simulate dynamic rainfall runoff processes these rainfall runoff models typically use rainfall observations to predict flow at the outlet of a catchment such models have a wide range of applications such as flood early warning systems and stormwater infrastructure design for any model application it is important that predictions are accurate under a wide range of hydrological conditions stormwater management models swmm a popular semi distributed rainfall runoff modelling platform rely on robust calibration techniques to fine tune uncertain model parameters and ensure accurate performance under different conditions the efficacy of calibration can be attributed to at least three factors improved model parameterisation the method of searching for an optimum parameter set and the selection of calibration and validation data beven 2012 james 2005 recent research has focused primarily on advancing the former two factors while the selection of calibration and validation datasets is often overlooked in modelling studies niazi et al 2017 robust validation is essential to verify the generalisation of the calibrated model an often overlooked requirement of validation is that the calibration and validation datasets must be statistically similar zheng et al 2018 bowden et al 2002 zheng et al 2022 while this can be easily achieved through resampling methods toth 2009 anctil and lauzon 2004 many physics based models such as swmm require time continuous data zheng et al 2022 making it difficult to apply such methods there are two common formats for time continuous datasets using a long period of data or partitioning data into time continuous segments these formats are commonly referred to as continuous and event based calibrations respectively hossain et al 2019 a review of swmm calibration studies between 1987 and 2014 found 16 instances of continuous calibration 20 single event 52 multi event and 25 unspecified niazi et al 2017 the advantages and disadvantages of each approach are well documented in existing studies shamsi and koran 2017 hossain et al 2019 niazi et al 2017 for example model initial conditions only need to be calculated a single time for a continuous model run whereas in an event based format they need to be calculated for each individual event continuous modelling runs are also simpler than event based to configure shamsi and koran 2017 however implementing event based calibration routines is becoming increasingly easy to automate this is thanks to advances in modelling platforms and the development of wrappers available in multiple programming languages which allow for multiple events hot start files and model validation to be done programmatically leutnant et al 2019 mcdonnell et al 2020 event based calibration frameworks have several advantages firstly research has shown that thoughtful selection of a few informative events can outperform continuous or randomly selected events singh and bárdossy 2012 hossain et al 2019 that being said it is possible to adapt weighting schemes to continuous data to achieve similar improvements by increasing the weight allocated to informative events secondly event based calibration routines also simplify the curation of calibration and validation datasets that are both statistically similar and hydrologically diverse which is difficult two achieve with two continuous segments of data the challenge with event based calibration becomes selecting the best events out of those discretised from a continuous record recent studies have demonstrated a wide range of approaches to event selection which typically involve ranking events based on characteristics such as the return period mean intensity or total rainfall blackler and guo 2014 distinguish early spring spring summer and intense summer rainfall events their study noted that long low intensity events achieved stronger calibration performance compared to short intense events broekhuizen et al 2020 evaluate a multi event calibration scheme in which events are selected from a set of discretised events based on one of rainfall rainfall intensity mean flow total flow relative to total rainfall or rainfall duration in their calibration scheme events that fall above and below a runoff threshold are used in a two stage calibration technique consisting of first calibrating to one type of event then another their approach was found to outperform a single stage multi event approach similarly talei and chua 2012 select events based on lag time and hydrograph shape jean et al 2018 select events with the greatest total precipitation depth and mean precipitation intensity their study found that selecting events based solely on total precipitation resulted in an underestimation of extreme flow frequency and only by using a multi criteria approach to event selection which included mean intensity did the selected events produce satisfactory calibration performance singh and bárdossy 2012 demonstrate a method for identifying critical hydrological events using a statistical depth function models calibrated to critical events are found to perform comparably to models calibrated to the entire record and better than models calibrated to random events while this method is an improvement over simple ad hoc methods their approach only uses a single criterion either antecedent precipitation or discharge recently zheng et al 2022 proposed a novel framework for achieving statistical similarity between the calibration and validation datasets in which a model is run on a continuous stretch of data and the model output is deterministically sampled for calibration and validation which circumvents the need for time continuous datasets however sampling time discontinuous sets of calibration and evaluation data risks artificially high model performance compared to evaluations on time continuous data in cases where flow is highly auto correlated padiyedath gopalan et al 2019 veloz 2009 a common issue with the approaches reviewed above is that they tend to neglect the hydrological diversity of rainfall runoff events awol et al 2018 consider a rainfall event with 20 mm of total rainfall this event may be short and intense long and mild occur in the spring or the fall occur with dry or wet antecedent conditions current practises overwhelmingly rely on a single criterion resulting in calibrated models that are not guaranteed to perform well on unseen events which may have very different characteristics thus there is an opportunity for improving calibration frameworks by explicitly identifying hydrologically diverse events which will have a favourable impact on model generalisation we propose that calibration and validation events be identified using unsupervised clustering which is a simple yet proven method for data partitioning clustering techniques have been widely used in research to classify individual observations for the dual purpose of ensuring that all flow regimes are equally represented i e an equal number of low and high flows and ensuring similar statistical properties between the calibration and validation data sets bowden et al 2002 anctil and lauzon 2004 toth 2009 used a self organising map som to classify streamflow and rainfall data with several lagged copies of each evaluating the effect of varying the number of clusters has on overall model performance the study also links the som based classifications to physical hydrological phenomena e g a given class may correspond to the rising limb of the hydrograph bowden et al 2002 compared genetic algorithm ga based and som based data splitting methods finding that they both outperformed traditional approach in which data is split arbitrarily without any consideration for the statistical properties of each split similarly anctil and lauzon 2004 use an som to create subsets of data with statistically similar properties and draw an even number of samples from each cluster to form their training dataset all the examples above were conducted using machine learning ml models however as far as our knowledge extends no works have evaluated such methods on physics based models such as swmm in order to use these methods for physics based models they must be modified to accommodate time continuous segments of data which is a typical requirement for physics based models guo et al 2020 we propose a novel adaptation of clustering methods for time continuous data which will allow us to identify diverse rainfall events for calibration as well as statistically similar events for validation even with an improved method for identifying calibration events event selection is inherently uncertain which manifests as uncertain calibration results typically studies that calibrate models to multiple events fail to account for this uncertainty by aggregating multiple events into a single timeseries krebs et al 2013 awol et al 2018 or optimising the mean performance on multiple events broekhuizen et al 2020 arriero shinma and ribeiro reis 2014 we propose creating swmm ensembles as a way to handle calibration parameter uncertainty an ensemble approach preserves the equally valid model parameter sets generated by calibration to different events because predictions are aggregated as opposed to parameter estimates a multi model approach is motivated by ensemble theory which has proven both theoretically and empirically that predictions produced by ensembles consistently outperform single models brown et al 2005 the success of an ensemble is attributable to the degree of disagreement between the ensemble members which is referred to as diversity diversity can be quantified as the covariance between the error distributions of ensemble members brown et al 2005 the benefits of diversity can be explained with the bias variance covariance decomposition of mean squared error mse since the covariance can be negative greater covariance between models can reduce overall mse one way to create diversity among ensemble members is by varying the data used to calibrate each member brown et al 2005 for event based swmm calibration we suggest a novel ensemble approach in which each model in an ensemble of swmm models is calibrated to a different event creating diversity between members hence reducing overall error and improving model performance the predictions of the ensemble member are combined to form discrete predictions which has been shown to improve model generalisation for physics based models shamseldin et al 1997 beven 2012 to support our proposed use of swmm ensembles the following paragraphs provide a brief review of comparable ensemble approaches in literature and present ensemble taxonomy that is used throughout the manuscript ensembles can consist of model of different types or models of the same type referred to as heterogeneous and homogeneous respectively zahmatkesh et al 2015 heterogeneous ensembles have been widely studied and are often found to outperform any single standalone model kumar et al 2015 kauffeldt et al 2016 their success can be attributed to the diversity created by varying assumptions and structures of different modelling platforms in contrast homogeneous ensembles differ in that they all having the same model structure but different parameter values homogeneous ensembles have received comparatively less attention in research physics based hydrological model parameters are highly uncertain which translates to uncertain predictions within a homogeneous ensemble framework multiple different and equally valid model parameter sets are capable of high degrees of diversity and diverse parameter sets contribute to high ensemble accuracy brown et al 2005 examples of homogeneous ensembles of physics based hydrological models are relatively uncommon in literature compared to examples of standalone models or heterogeneous ensembles nevertheless research on homogeneous ensembles has shown promising improvements to performance seibert and beven 2009 create physics based ensembles in which each member is trained to randomly sampled data the ensemble approach is found to outperform the single model similarly liu et al 2014 use rainfall runoff models as members for the adaboost ensemble algorithm freund and schapire 1995 noting considerable improvements in performance regardless of what type of models are used as ensemble members literature has shown that ensemble generalisation is dependent on the specific combination technique used most studies that compare combination techniques do so using ml models as the ensemble base learners anctil and lauzon 2004 abrahart and see 2002 tyralis et al 2021 alobaidi et al 2019 there is a need to understand whether the improvements in performance achieved by combination techniques can be extended to homogeneous ensembles of physics based models combining predictions obtained from different parameter sets may be seen as counter intuitive especially when parameters are assumed to be time invariant which are expected to have a single correct value however significant work in hydrology has demonstrated that there is no single optimum parameter sets instead there may be numerous realistic parameter sets that are equally suitable for a given model awol et al 2018 mediero et al 2011 beven 2012 xu et al 2019 combination strategies range from simple averaging to more complex methods such as stacking in which a statistical model used as the combiner breiman 1996 several studies that compare combination strategies have found that simple averaging is hard to beat in practice but can be improved upon using methods such as stacking using a model to combine predictions if configured correctly tyralis et al 2021 kumar et al 2015 the review above highlights the need for a data driven framework for model calibration that ensures calibration and validation datasets are time continuous statistically similar and each contain diverse hydrological conditions our proposed framework features an innovative event clustering technique that we use to identify a set of calibration events we use a novel ensemble algorithm in which ensemble members are independently calibrated to different events to exploit the effects that ensemble diversity have on generalisation the final step of our framework is to combine predictions which done using four approaches two of which have not yet been evaluated for such ensembles to develop and evaluate our proposed framework we set the following objectives i to develop a multi criteria clustering approach to select hydrologically diverse time continuous events for calibrating urban rainfall runoff model this component builds on clustering methods used in ml research and investigates their efficacy on traditional physics based models i e swmm and explicitly measures the effect of event selection on model performance ii to fully realise the benefit of a diverse set of calibration events we propose an alternative approach to traditional multi event calibration predictions are made using homogeneous ensembles of multiple swmm models each calibrated to a different event in order to create diversity between members and hence improving model generalisation and performance iii study the effects that each cluster have on model behaviour using a traditional sensitivity analysis and by evaluating the performance of non diverse ensemble that is ensembles that only models calibrated events belonging to one cluster iv to investigate effects that ensemble size and combination techniques have on generalisation while these approaches have been used in ml applications they have received very little attention for homogeneous physics based models our study of ensemble combination must feature techniques that are ranging in complexity the proposed framework is applied to two case studies in southern ontario canada and is compared to baseline results from a single event swmm model using multiple performance criteria 2 methods the methods are organised into three sections that describe the swmm models the data driven framework and validation techniques the swmm model description includes the standard methods used for event discretisation calibration and sensitivity analysis the ensemble section outlines our novel framework for event selection and ensemble prediction lastly we describe a robust validation framework to verify the proposed methods 2 1 swmm model setup 2 1 1 study area and model creation two catchments located within the etobicoke creek and don river watersheds in the greater toronto area in southern ontario canada were selected for this study these catchments were selected based primarily on their flood vulnerability and the heavily urbanised and rapidly changing landcover as identified by the toronto and region conservation authority trca an advantage of these specific catchments is the availability of high resolution forcing and spatial data openly provided by the trca the catchments under study have outlets at spring creek south scs and taylor creek south tcs which are in the etobicoke creek and don river watersheds respectively table 1 provides catchment properties both catchments can be characterised as urbanised based on impervious landcover they are close to one another geographically have a similar size and their models contain a similar number of subcatchments because of their similarity they can be used to verify the proposed framework on one another the swmm models used in this study were created from scratch using openly available spatial and temporal datasets fig 1 shows the conduits subcatchments raingauges and outfalls of each model models were constructed beginning with a user specified streamflow gauge which was used the outfall in swmm a 2 metre resolution digital terrain model dtm government of canada 2022 was used to calculate flow accumulation pathways and catchment boundaries using a traditional delineation approach procedure in arcgis pro o callaghan and mark 1984 morris and heerdegen 1988 stream burning was performed based on mapped hydrological features maintained by the trca 2020 which is an enforcement technique that improves the accuracy of the spatial analysis by subtracting known flowpaths from the dtm surface prior to calculating dtm derived flowpaths and catchments to encourage agreement between derived and observed flowpaths lindsay 2016 flow accumulation pathways were further pruned to better match the existing watercourses the catchments delineated for the scs and tcs gauges were each discretised into subcatchments based on the nodes of the dendritic network of flowpaths streams were assumed to have a simple rectangular geometry stream widths were estimated using methods described in mulvihill et al 2009 in which empirical regression equations are used to relate drainage area to stream geometry these equations were found to be relatively accurate and were developed using streamflow data from the southeast coast of lake ontario geographically near the catchments herein most channel and subcatchment parameters were calculated using spatial datasets including soil agriculture and agri food canada 2022 dtm government of canada 2022 and land cover province of ontario and ministry of natural resources and forestry 2022 raingauges obtained from the trca 2020 were assigned to subcatchments based on the minimum euclidian distance between the gauge locations and subcatchment centroids which resulted in two unique gauges for each catchment listed in table 1 the process above was used to generate shapefiles representing outfalls conduits junctions subcatchments and raingauges which were exported to matlab to create swmm models rainfall data and observed flow data was processed in matlab and converted to binary model files using swmm events containing flags for snow and ice conditions in the records obtained from environment canada 2022 were removed from the selection these events were not included because cold weather processes e g snow accumulation were not parameterised in the models snow events were omitted for several reasons snow ploughing and storage is complex in urban areas and the data is unavailable sensors often become obstructed during winter months and cold weather events do not always produce runoff aquafor beech 2016 despite the omission of snow in this study our proposed methods could be used with models in which snow processes are represented a warm up period of 24 hours was generated for each event under study to accommodate varying initial conditions for each event based simulation we developed a wrapper for swmm in matlab which allowed us to run simulations and edit model parameters from the matlab environment several considerations were taken to improve the computational efficiency of the analyses conducted the geometry of subcatchments and conduits are simplified vertices removed in order to minimise file write times during calibration binary rainfall and warmup files were generated for each event under evaluation to reduce simulation runtimes a complete list of routines is provided in appendix a and fig a 1 illustrates how matlab was used to interact with swmm the complete swmm wrapper is available on github all computations were conducted on a workstation with the following specifications cpu amd ryzen 3700x ram 32 gb ddr4 gpu nvidia geforce gtx 1660 software versions are python 3 7 9 within arcgis pro 2 7 0 matlab 2021a and swmm 5 1 14 threads were used for the simulations 2 1 2 rainfall event discretisation rainfall and stage data were collected at point source gauges at a 15 minute resolution for a period beginning in may 2002 and june 2006 for scs and tcs respectively and ending in may 2021 the mean aerial weighted rainfall was used to perform the rainfall event discretisation and selection for each catchment isolating data used to calibrate and validate the swmm model is a two step process event discretisation and selection event discretisation is described in the paragraph below while selection is included in section 2 2 1 in the context of the ensemble framework event discretisation is the process of identifying rainfall runoff events from a continuous record the most common and simplest procedure for discretisation uses a minimum inter event time mit during which there is negligible rainfall to identify the start and end points of events nojumuddin et al 2018 while sophisticated discretisation approaches have been developed in previous research thiesen et al 2019 the mit based approach was chosen due to its widespread use in research nojumuddin et al 2018 jean et al 2018 behera et al 2010 and applied settings aquafor beech 2016 the us epa and ontario ministry of the environment conservation and parks recommend an mit of 12 h aquafor beech 2016 however it is also important to consider catchment characteristics and runoff response while selecting an mit value joo et al 2013 the hydrographs of the target stream gauges in each catchment have long receding limbs therefore a longer mit of 24 hours was selected to ensure that the entire event hydrograph is captured in the simulation a long mit permits enough time for the receding limb of the event hydrograph to approach its baseflow value at the beginning of the event uninterrupted by new rainfall events consequently rainfall events are larger in magnitude and duration compared to events discretised using a shorter mit a buffer time of 24 h was appended to the end of each rainfall event to ensure that the runoff response is fully captured lastly events with a total rainfall of less than 5 mm were excluded from the analysis as events of this size may not produce any runoff in urban catchments such as those used in this study aquafor beech 2016 2 1 3 sensitivity analysis the sensitivity of rainfall runoff model parameters is often analysed to develop a sense of model behaviour and fine tune calibration swathi et al 2019 perin et al 2020 these analyses are used to distinguish sensitive and insensitive parameters as to select only the most sensitive parameters for calibration existing research has shown that there is no globally sensitive set of parameters for hydrological models and that parameter sensitivity should be calculated on a case by case basis knighton et al 2016 however with the emergence of automated calibration techniques the usefulness of removing insensitive parameters from calibration routines should be questioned the sensitivity analysis presented in this study has a dual purpose foremost we wanted to assess difference in parameter sensitivity between events in different clusters additionally we wanted to test whether removing insensitive parameters offers any improvements to model calibration in terms of computational time or performance the sensitivity analysis in this research was conducted for each individual event the sensitivity analysis was conducted using a one at a time approach which has been widely used in rainfall runoff modelling shin and choi 2018 xu et al 2019 shahed behrouz et al 2020 campolongo et al 2007 instead of analysing the sensitivity of individual parameters i e on a subcatchment basis sensitivity is analysed for groups of individual parameters across the entire catchment this drastically reduces computational costs at the expense of information on the sensitivity of individual parameter values while still being generally effective in identifying sensitive parameters barco et al 2008 shahed behrouz et al 2020 campolongo et al 2007 total volumetric flow and peak flow were used as model response variables for the sensitivity analysis which are given by the following respective equations 1 q ˆ v q ˆ δ t 2 q ˆ p max q ˆ where q ˆ v q ˆ δ t q ˆ p are the predicted total flow volume predicted flow timeseries timestep and predicted peak flow the timeseries predicted by swmm q ˆ are formulated as a function of a parameter set x and observed rainfall p 3 q ˆ f x p each initial parameter x 0 within a given group is varied by α 4 i α f x 0 1 α p f x 0 p α where i α is the sensitivity of some parameter x with an initial value x 0 that is modified by a fraction α when subject to a precipitation event p the calibration parameter names sections units relative uncertainty and upper and lower constrains used in this research are listed in table 2 where a physical constraint on a parameter exists e g the upper limit of percent impervious landcover we truncated parameter values to meet the constraint and recalculated parameter sensitivity based on the subcatchment area weighted mean ten values for α were considered which increase linearly from the lower bound of parameter uncertainty to the upper bound for example the percent imperviousness which has a relative uncertainty of 0 2 is evaluated for α values of 0 04 0 08 0 12 0 16 and 0 20 the overall sensitivity i of the model to a given rainfall event p was taken as the absolute mean across a total of 10 denoted as m values of α considered 5 i 1 m j 1 m i α j following the sensitivity analysis we conduct calibrations using different configurations of parameters to test whether removing insensitive parameters is useful the study of calibration configurations was conducted on one event from each cluster for each catchment the configurations used in this study are as follows i baseline uncertainty calibration ii double uncertainty calibration iii sensitive parameter calibration iv insensitive parameter calibration we refer to calibration using expert knowledge informed uncertainty as baseline uncertainty the double uncertainty configuration uses the expert based relative uncertainty multiplied by a factor of 2 which is used to assess whether further improvements to model accuracy can be achieved by expanding the parameter search beyond expert judgement lastly the sensitive parameter and insensitive parameter use the five most sensitive and insensitive parameters respectively as determined by the sensitivity analysis 2 1 4 model calibration as mentioned above swmm predictions are a function of a calibration parameter set and rainfall event event based calibration is given by the following general expression 6 x argmax g q f x p where g is the objective function given in eq 7 below f is the swmm model with parameter set x bound by uncertainty and physical constraints forcing rainfall data p and observed flow q the kling gupta efficiency kge was used as the objective function in this work gupta et al 2009 7 kge 1 r 1 2 α 1 2 β 1 2 where 8 r cov q q ˆ σ q σ q ˆ 9 β α σ q σ q ˆ 10 β μ q ˆ μ q where σ and μ denote the standard deviation and mean statistics respectively for flow q and predicted flow q ˆ a wide variety of optimisation algorithms have been applied for swmm calibration niazi et al 2017 we used a standard ga for because of its popularity competitive performance when compared against other common optimisation algorithms and because the optimisation algorithm itself is not a focus of our research jeon et al 2014 niazi et al 2017 the ga is an evolutionary algorithm that searches for a global minimum by iteratively breeding new populations of parameter estimates each new population is created using crossover and mutation which are applied to the best performing populations in each generation important hyperparameters for the ga include population size mutation rate crossover fraction to which we assigned values of 40 0 01 default and 0 8 default respectively the ga terminates when it meets one of several stopping criteria which included maximum number of generations function tolerance and maximum stall generations for which we used values of 100 1e 4 and 5 respectively when the ga does not improve the objective function by the tolerance for five consecutive generations the algorithm terminates ga hyperparameter sensitivity was assessed using trial and error increasing the population size beyond 40 had little effect on the optimisation and the algorithm typically terminated due to the objective function levelling out at approximately 40 generations well before the maximum number the ga was implemented using the native ga algorithm in matlab which is included in the optimisation toolbox matlab 2021 2 2 swmm ensembles typically swmm predictions are generated using a single model which is calibrated to one or multiple events in this study we propose a data driven ensemble framework for swmm that uses models that are independently calibrated to individual events as base learners the novel framework is depicted in fig 2 which begins with discretising events from a continuous record next diverse events are identified using our novel clustering method described in section 2 2 1 a set of events are sampled based on their cluster to individually calibrated swmm models which form ensembles finally ensemble predictions are combined using one of four combination methods described in section 2 2 2 two of which are innovative in that they can utilise real time hydrometric data to improve ensemble accuracy our proposed framework will provide a data driven solution to calibration event selection preserve multiple model parameter sets and the ensemble is expected to improve generalisation 2 2 1 identification of diverse hydrological events using unsupervised clustering clustering is proposed as a way to meet our first objective of identifying diverse time continuous events for model calibration and validation we apply clustering to characteristics derived from a set of rainfall runoff events while event selection is typically conducted using only rainfall based event characteristics broekhuizen et al 2020 szela g et al 2022 sun et al 2014 we simultaneously considered both rainfall and flow characteristics toth 2009 which encourages hydrologically diverse events our novel approach uses clusters events based on event characteristics including total precipitation p peak intensity i p mean intensity i μ duration d date peak flow q p flow volume q hydrograph centroid coordinates q c t and q c y and hyetograph centroid coordinates p c t and p c y the selection of these specific features as the criteria with which to distinguish diverse rainfall runoff events is supported in existing studies on event selection barco et al 2008 hossain et al 2019 blackler and guo 2014 additionally the event date day of year was also used as the time of year is important to consider in distinguishing between different hydrological events hossain et al 2019 barco et al 2008 blackler and guo 2014 including the date among the event statistics enables the clustering algorithm to distinguish between annual seasons as events of similar magnitudes occurring at different times of the year may have different dominant hydrological processes the day of year of each event is converted to radians then the sine and cosine are taken for the features which is a way to pre process dates that preserves the cyclical nature of the days of the year abrahart et al 2001 we used an som to cluster rainfall runoff events which is an unsupervised neural network based classification technique several studies have demonstrated the use of soms for hydrological timeseries clustering as a pre processing technique for ml models toth 2009 anctil and lauzon 2004 typically examples of clustering based training data selection will select an even number of samples from each cluster discouraging model bias towards particular flow conditions in our framework this is achieved by selecting the same number of events from each cluster maximising the number of clusters is preferable as it would increase the diversity of represented flow conditions and in turn the diversity of the calibrated ensemble members however a disadvantage of more clusters is that it may result in clusters that only contain one or two events thereby if we want to draw a balanced number of events from each cluster we are constrained by the number of events in the smallest cluster consequently we use only two clusters in our study using two clusters results in an ample number of events in cluster enabling us to study the effects of model performance across an increasing ensemble size and complete our third objective something that would not be possible with a greater number of clusters our proposed event selection scheme is as follows i cluster events into k clusters in which k is constrained by the number of events in the smallest cluster n ii select n events from each cluster prioritising events nearest the cluster centroids iii calibrate individual swmm models to each event k n events if using an even number from each cluster iv generate discrete predictions by combining predictions from all swmm models our second objective is to exploit the diversity created by clustering events by creating a homogeneous ensemble of swmm models to assess differences in performance between ensembles that use events from different clusters we evaluated events in both clusters using 1 only models calibrated to cluster 1 events 2 only models calibrated to cluster 2 events and 3 using models calibrated to an equal number of events in each cluster ensemble predictions that use events from a single cluster are denoted as ec x where x is the numeric cluster label and ensembles that use a balanced number of events from each cluster are denoted ecb this will allow us to confirm whether models calibrated to a given type of event will perform best on the same type of event while also quantify the effects of including a balanced amount of information on each event cluster these configurations were also studied across an increasing ensemble size in order to better understand how many individual models are required for satisfactory performance 2 2 2 combination methods to create an ensemble a set of m models are combined to form a single prediction according to eq 11 below 11 q ˆ h q 1 ˆ q 2 ˆ q ˆ m where h is the combiner function that combines predictions q ˆ for models calibrated to events 1 to m our third objective is to investigate the performance of different ensemble combination techniques we evaluate four common combination techniques two weighted approaches uniform and non uniform weighting and two stacking approaches multiple linear regression mlr and artificial neural network ann based stacking shamseldin et al 1997 tyralis et al 2021 the stacking combiners have the option to leverage real time hydrometric data to further improve prediction accuracy weighted combination is among the most popular techniques for aggregating or combining ensemble predictions sharkey 1996 uniform weighting is the most common weighting scheme and has been described as hard to beat in practice tyralis et al 2021 there are methods for tuning the ensemble combination weights which are capable of outperforming uniform weighting schemes tyralis et al 2021 in this research we evaluate both uniform and non uniform weighting schemes for the weighted scheme the weight allocated to each ensemble member is calculated as the mean cross validation performance on the events used to calibrate the other ensemble members in a weight vector of length m the weight of an individual model is given by eq 12 12 w m 1 m 1 i 1 i m m g q q ˆ i the weight vector is then normalised such that its sum is equal to one 13 w n o r m w w the remaining two combination methods use stacking which is a combination technique in which a model is trained to combine other models commonly referred to as a meta learner originally stacking was proposed using multiple linear regression mlr breiman 1996 however a wide variety of different models can be used as the meta learner more complex models such as anns can map non linear relationships between input data swmm predictions and target data observed flows providing greater compensation for potential deficiencies of the swmm models sharkey 1996 however a more complex meta learner introduces the risk of overfitting hence poor generalisation to determine whether increased complexity of the meta learner is warranted this work evaluates both a linear model and ann the input datasets used to train the stacking meta learners are constructed by first concatenating the predictions obtained for each event from each swmm model one advantage of the stacking approach is the ability to supplement the meta learner with historic and exogenous data bento et al 2021 the predictions of each swmm model in the ensemble are used as the input feature set next we augment the input feature set using flow lagged by a forecast lead time of 12 hours and aerial mean precipitation data five lagged recurrences of each flow and precipitation are used in the feature set lag times are determined based on maximising the cross correlation function between each of the exogenous input features and the observed flow tiwari and chatterjee 2010 the configuration of the linear model is trivial but some consideration is required for the configuring the ann best practises are employed to encourage strong ensemble generalisation specifically we use stop training and bagging which have both been shown to improve ann generalisation anctil and lauzon 2004 due to being highly flexible models anns are prone to overfitting stop training involves withholding a subset of ann training data from the calibration procedure to use as a calibration termination criterion during training if the performance of the withheld data does not improve across multiple ann parameter adjustments training is terminated the number of consecutive parameter adjustments with no improvements until training termination is referred to as the patience for our anns we withheld 50 of the training data for stop training and used a patience value of 6 the stop training data is allocated using block splitting the training data is divided into 10 time continuous blocks and alternatingly assigned for training and stop training block splitting in contrast to random sampling preserves the time dependency structure contained within the flow data li et al 2010 bagging is a widespread ensemble technique in which the training data for each ensemble member is resampled from the original training set with replacement and the average model predictions are used bagging is successful due to the diversity obtained from the varying training data for each ensemble member which is the same mechanism that motivated our proposed ensemble framework grid search optimisation was used to evaluate ensemble sizes of 2 n for n values of 1 to 7 ensembles were evaluated based on 50 randomly selected validation data consistent with previous studies shu and ouarda 2007 zaier et al 2010 increases in ensemble size were found to improve generalisation performance typically stabilised at an ensemble size of 32 the largest size of 128 was used as it ensures sufficient resampling and only has a marginal impact on computation time grid search optimisation was also used to determine the ann model architecture which consists of a single layer of 8 hidden neurons the levenberg marquardt backpropagation algorithm is used to train the individual anns a robust validation procedure described in the upcoming section further helps to ensure that the stacking models are parameterised properly 2 3 validation techniques while comparing different calibration procedures the objective function kge described in eq 7 is used which ranges from an optimum value of 1 to while there is no inherent reference point for kge values predictions that are more accurate than the historic observed mean produce a kge greater than 0 41 and are considered acceptable whereas kge values less than 0 41 are considered unacceptable knoben et al 2019 for the comparison of ensemble combination techniques additional performance metrics are used including the peak flow error pfe which is the difference in the maximum observed and maximum simulated flows and the mean volume error mve which is the difference in observed and simulated total flow volume during the event the latter two are defined as follows 14 pfe max q max q ˆ max q 15 mv e q q ˆ q where q and q ˆ are the same as described earlier in physics based hydrological model calibration literature validation is often performed on a single event or altogether absent niazi et al 2017 cristina et al 2017 this is problematic especially for applications such as flood forecasting since a physics based model calibrated to a particular event s is not guaranteed to maintain its accuracy on other events especially events with flow conditions that are dissimilar to those contained in the calibration data beven 2012 since multiple swmm models are being calibrated in this study each model is evaluated on each event excluding the event used for calibration for example if there are 10 discretised events each event will be evaluated using the 9 remaining models and thus have 9 performance scores for ensemble predictions which use predictions from multiple swmm models it is necessary to consider different combinations of models that can be used to generate predictions for each validation event as different combinations of predictors will produce different ensemble predictions for example consider a set of 10 events which we want to evaluate using ensemble predictions that contain 4 members for each event there are 9 models available with which to produce ensemble predictions resulting in 126 unique combinations of models that can generate predictions given by 9c4 ideally we would evaluate every single unique combination of predictors however this becomes very computationally expensive for methods such as stacking where a unique meta learner is trained to each unique combination another problem that arises is that trying every possible combination does not scale well with increasing numbers of available models in cases with more than 100 unique combinations we randomly sample 100 combinations with which to make predictions since different subsets of models do not perform the same using resampled subsets quantifies the associated variability in performance 3 results this section presents the results of the event selection sensitivity analysis calibration and ensemble predictions 3 1 event discretisation and selection the outcome of the som based unsupervised clustering approach is illustrated in fig 3 for scs and 4 for tcs in which clusters are distinguished by colour differentiating characteristics can be identified from the bottom most rows and from the histograms along the diagonals in the scatter plot matrices for both catchments events are segregated based primarily on total flow and precipitation cluster 1 events green tend to be small and frequent while events in cluster 2 purple tend to be large and infrequent additionally events in cluster 1 tend to have a shorter duration and lower mean intensity compared to those in cluster 2 the day of year can be read from the sine and cosine components which form a ring as shown in figs 3 and 4 when plotted against one another the midpoint along the sine axes and upper limit of the cosine axes correspond to january 1 and the day of year increases in the clockwise direction with one rotation corresponding to a year there is no clear discrimination based on event date though cluster 2 events tend to occur mostly during summer to late fall the event date is expected to have a larger influence on the clustering outcome as the amount of available data and the number of clusters increases since the numeric cluster id is arbitrarily assigned by the unsupervised learning algorithm events are reclassified based on the ascending rank of the total flow of each cluster centroid to achieve a consistent numeric notation between catchments cluster properties are summarised in table b 1 and two representative events from each cluster are illustrated in fig b 1 a set of events for the analyses presented in the following sections is generated by sampling 10 events from each cluster events are selected based on minimising their euclidian distance between each event and the corresponding cluster centroid ensuring events are representative of their cluster encourages dissimilarity between events in different clusters otherwise there is a risk selecting events that are near the cluster boundary and thus not diverse the analyses presented in the following sections are conducted using strictly the subsets of 20 events 10 from each cluster for each catchment the properties of these sampled events are provided in tables b 2 and b 3 for the scs and tcs subcatchments respectively 3 2 sensitivity analysis the following one at a time sensitivity analysis was conducted to determine whether there are significant differences in parameter sensitivity between cluster 1 and 2 events parameter sensitivities for events in clusters 1 and 2 are plotted against one another in fig 5 each parameter has a unique colour symbol combination and the uncertainty lines indicate the full range of total flow left and peak flow right sensitivities across the 10 events in each cluster the sensitivity analysis results are in complete agreement for both catchments the subcatchment imperviousness and width are two most sensitive parameters for peak flow and volume peak flow is also sensitive to changes in the overland flow manning s n for impervious surfaces and subcatchment slope this result indicates that runoff from impervious surfaces is the dominant process contributing to the runoff response of both catchments the model sensitivity to subcatchment slope width and manning s n are likely disproportionately high due to the lack of a modelled minor stormwater system the parameters of which would likely also impact peak flow notably the antecedent moisture content imd parameter which is widely considered to be a very important parameter for rainfall runoff model performance tramblay et al 2010 is insensitive to both event clusters and catchments the position of parameter sensitivity values relative to the 1 1 line illustrates whether it is more sensitive to clusters 1 or 2 parameters below the 1 1 line are more sensitive to cluster 1 events and parameters above the line are more sensitive to cluster 2 events there are no drastic differences in parameter sensitivity between the two clusters parameter sensitivities are centred about the 1 1 line indicating sensitivity to types of events though parameters are all marginally more sensitive to cluster 1 events sensitivities are also more variable to different cluster 1 events illustrated by the uncertainty lines typically being broader than they are tall the high sensitivity of the percent impervious parameter is consistent with recent research by awol et al 2018 for a swmm model in a nearby catchment with similar land cover and geography sensitivity analyses often serve to identify insensitive parameters in order to remove them from ga based model calibration however our results illustrate that this does not yield any improvements in terms of calibration time or performance fig 6 illustrates the maximisation of kge plotted against time recorded at each new ga generation for the baseline uncertainty calibration expert knowledge based and for the three other configurations double uncertainty sensitive parameter and insensitive parameter calibration the baseline uncertainty double uncertainty and sensitive parameter calibration configurations which are described in section 2 1 3 are effectively identical for both events and catchments these results demonstrate how eliminating insensitive parameters from calibration which is commonly done hossain et al 2019 awol et al 2018 shahed behrouz et al 2020 niazi et al 2017 does not impact the ga optimisation in terms of kge obtained or calibration duration the case with double uncertainty bounds confirms that the expert knowledge based uncertainty bounds are well defined and the ga cannot achieve a much better solution beyond the initially imposed expert knowledge based constraints the insensitive parameter calibration validates the outcome of the sensitivity analysis as the ga was unable to produce any noteworthy improvements 3 3 single event calibration outcome the outcome of all the single event calibrations and cross validation is shown in fig 7 the heatmaps show the performance of all 20 models each calibrated to a single event on every event within the set the colours show the kge of each combination blue to red indicate good to poor performance the diagonal of the matrix indicates the kge achieved during calibration in other words the event used for calibration and validation is the same strong cross validation of a model calibrated to a given event is indicated by a row dominated by blue colours indicating a high kge when cross validated on other events from the lower right and upper left quadrants of these figures models calibrated to cluster 2 events tend to perform better on events in their own cluster compared to the performance of events calibrated on cluster 1 events the models calibrated to cluster 2 events also exhibit better validation across clusters illustrated by the kge values in the upper right quadrant which are similar to those obtained on their respective cluster however the opposite it not true as shown in the lower left quadrants models calibrated to cluster 1 events do not perform as well as they do on events in their respective cluster as expected the highest kge on any given event is achieved during calibration along the diagonal though there are some exceptions the calibration kge for events 6 scs and 4 tcs are surpassed by models calibrated to different events indicating that a more optimum parameter set may exist than that returned from the ga optimisation however the difference in performance is marginal and given that none of the other calibrated models achieve satisfactory performance on those events this suggests that unsatisfactory performance may not be due to the optimisation algorithm itself but rather that a better solution does not exist within the optimisation search space colour trends in the vertical direction indicate how well different models perform on a given event for example squares in the vertical direction show that none of the calibrated models achieved acceptable performance on the event as is the case for event 6 scs and 20 tcs likewise dominant red colouring along the horizontal direction such as for events 3 scs and 9 tcs indicate that models calibrated to those events do not perform well on any other events there are some cases such as events 3 scs and 3 tcs where the model achieves a good kge value during calibration but fails to generalise to most other events within the set meanwhile many other models achieved satisfactory performance across the set of events indicating that the model parameterisation and uncertainty are not at fault instead poor cross validation may be due to the ga overfitting the swmm model these results demonstrate the poor cross validation performance of single event swmm models as well as the high variability in performance across events especially across different clusters the poor cross validation performance highlights the opportunity for ensemble techniques to improve generalisation ensembles are formed by combining the predictions obtained from models that are each calibrated to different events which is discussed in the following section 3 4 comparison of ensemble member configurations here we present a comparison in performance between the single model and uniformly combined ensemble predictions the purpose of this analysis is to evaluate whether we can improve swmm generalisation using simple ensembles and to determine what role that the type of events as determined using clustering have on generalisation specifically we consider uniformly weighted ensembles using only models calibrated to events belonging to a single cluster using models calibrated on events from both clusters and varying numbers of ensemble members as a reminder the notations ec x and ecb are used for ensemble predictions based on models calibrated to a specific cluster and an equal number of events from each cluster respectively fig 8 illustrates the changes in performance of the ec1 ec2 and ecb relative to the mean single model performance the mean single model performance is calculated by evaluating a given event using all remaining events subplots are ordered by cluster and the colour coded event id is indicated in the bottom right corner of each subplot single cluster ensembles ec1 and ec2 tend perform best when evaluated on events in their respective cluster with only a few exceptions such as events 3 18 17 scs and 5 tcs ensembles consistently outperform the mean single model predictions except for single cluster events on their validation events in the opposite cluster e g ec1 evaluated on cluster 2 events which usually results in a decrease in performance the performance of the ecb ensembles is consistently between the ec1 and ec2 configurations there are several cases where the ecb ensembles match the performance of the better single cluster ensembles such as for events 11 12 scs and 1 5 15 tcd finally there is a lone instance where the ecb ensembles outperforms the others on event 10 tcs the mean kge of all ensembles tends to remain constant or increase as with an increasing number of predictors the kge of some configurations increases by as much as 0 1 to 0 2 between ensembles with the fewest and most predictors such as for event 1 4 scs and 7 10 17 tcs the shaded area in fig 8 shows the spread in performance of different combinations of calibration events to better visualise the effects that event combination has on model performance the variance of performance is calculated for each ensemble size and illustrated in fig 9 while the variance in performance ranges by an order of magnitude between events the variance of all 3 configurations consistently decreases as the number of models increases the variance of the ensemble models approaches zero as the number of predictors approaches the number of models available in the set of sampled events comparably if a model were trained on every event on record there would be no need for event selection these plots demonstrate how the variance in performance exponentially decays as information from more events linearly increases for calibration this result highlights the high degree of uncertainty when making predictions based on a single event with exponential improvements in prediction consistency as the calibration event set grows the ec1 predictions typically have the highest variance for the scs catchment whereas the ec2 predictions have the highest variance for tcs this result suggests that the variability in model performance owed to event selection is unique to individual catchments despite both catchments in this study being similar in size location and land use most importantly fig 9 illustrates that including information from several events for predictions is essential for achieving stable performance for example selecting a subset of two events for calibration produces highly variable performance when the events are sampled from a set of events that have similar characteristics as determined by the som according to this figure stable performance is only achieved with ensembles of models calibrated to 6 different events or 12 6 from each cluster for the ecb configuration 3 5 evaluation of combination techniques next we present a comparison of different methods of combining the predictions of ensemble members the following analyses include only ecb configurations in order to not bias performance towards any given event class results are illustrated in fig 10 which compares the performance for each combination technique based on three criteria kge mve and pfe for reference the calibration and single model performances are also shown the mean performance rank and variance are also summarised in tables 3 and 4 given the variability of performance between different events configurations are ranked for each event and the mean rank is reported the ranks of pfe and mve are calculated based on the absolute value of error the variance is also reported while the uniformly weighted ensemble has almost no variance the other combination methods can introduce variability the best combination technique have the highest rank and lowest variance the calibration performance while included in the rank analysis is only provided for reference and cannot be used in practice out of the four combination techniques and three performance criteria ann based stacking produces the best overall results achieving the highest rank in 3 out of 6 cases 3 metrics for 2 catchments in fact ann based stacking exhibits comparable or better performance than the calibration model on events 17 6 7 16 18 scs 11 19 tcs demonstrating very strong generalisation the non uniformly weighted combination also does notably well achieving the highest pfe rank for both catchments 4 discussion the clustering approach presented in this research provides a means of achieving diverse time continuous and statistically similar calibration and validation datasets we consider this to be a substantial improvement over traditional approaches to event selection which overwhelmingly rely on subjective methods and or single criteria our clustering method can be easily adapted to use different clustering algorithms or event characteristics for example expanding the clustering criteria to include features such as temperature may be useful in cold climates which would encourage the distinction between cold weather and warm weather events which typically involve different hydrological processes to demonstrate the motivation for our proposed framework we first illustrated the poor cross validation performance of models calibrated to single events while models tend to validate well on events with similar characteristics in the same cluster they perform poorly on events in the other cluster this also showed how calibration to different events produces different optimised parameter sets we introduced homogeneous ensembles as a technique to utilise the parameter sets obtained from calibrating a swmm model to different events ensembles consisting of models calibrated to events in a given cluster perform well when validated on events in the same cluster and poorly across clusters ensembles calibrated to a balanced number of events in each cluster perform somewhere in between but typically much better than the mean single model the single cluster ensembles demonstrate the benefits and disadvantages of non diverse calibration events this finding can be applied to achieve balanced performance on different events or performance improvements on specific flow conditions alternatively this ensemble framework can be expanded to a modular format in which ensemble members are selected as predictors based on anticipated flow conditions for example if a large event is anticipated predictions could be made using only the models calibrated to similar events we also show how the increasing the ensemble size generates minor improvements in performance as well as a reduction in performance variance the performance of ensembles with three or fewer models tends to have high variance which decreases as more and more events are included we recommend maximising the number of events for calibration reserving statistically similar events for validation and caution against using less than 4 events as model performance may be very sensitive to the events used the improvements produced by our proposed method are consistent with previous studies that implicitly identify diverse events jean et al 2018 singh and bárdossy 2012 however the methods proposed in previous studies do not guarantee that selected events are hydrologically diverse and therefore are not guaranteed to improve model generalisation in contrast using clustering ensures a diverse set of calibration events lastly we evaluate four ensemble combination techniques in order to determine whether they can be used to generate further improvements in model performance using both the single model and calibration performance as baselines the performance of combiners is consistent between both the scs and tcs catchments the ann based stacking method which allows for the addition of exogenous data at the combination stage is the best combiner on average across all catchments and performance criteria the effects of exogenous input variables in model combiners are consistent with a recent power load forecast study by bento et al 2021 which found that models with exogenous inputs outperform those without and ensembles with exogenous inputs outperform standalone counterparts the weighted combination achieves the highest mean pfe rank while the stacked models tend to over predict peak flows the stacked ensembles also tend to exhibit lower or positive volume error compared to the other combination techniques we attribute this to the fact that they are not constrained to mass conservation laws unlike the convex combined models the strong performance of the non uniformly weighted ensembles is consistent with previous works tyralis et al 2021 found that a convex weighted combination of machine learning models outperformed single model and uniformly weighted model performance similarly kumar et al 2015 found that a similar method constrained multiple linear regression performed the best out of six different combination strategies based on these results unconstrained combination techniques such as stacking are well suited to overcome certain physics based model behaviour such as total volume underestimation however our results showed that this resulted in slight overestimation of peak flow magnitudes of course part of the success of the stacking based methods is due to its use of exogenous sensor data for prediction which is not always available in real time the stacked combiner can be configured with or without exogenous data however we expect to see a slight decrease in performance without this data the uniformly weighted and non uniformly weighted combinations exhibit almost no variance associated with event selection whereas the stacking methods introduce some variance in performance it remains much lower than the variance in performance between models calibrated to different single events the stacking variability is owed to the calibration of the combiner i e mlr or ann these results highlight how a simple uniform combiner can produce considerable improvements over the single model scenario while eliminating the uncertainty associated with single event selection stacked combinations create further improvements which we attribute to their ability incorporate real time data and overcome volume balance errors the main limitation of this work presented above is that the methods were only applied to two low complexity swmm models more complex swmm models may produce even greater variability in performance between different events due to having higher degrees of freedom therefore future studies should consider swmm models with varying degrees of complexity similarly a large scale study should include catchments that represent a broad range of hydrological conditions which would be used to further test the proposed methods another limitation of this work is the use of two event clusters this study used two clusters to ensure that enough events are available for the validation scheme increasing the number of clusters will improve the diversity of the calibration event set further and is expected to produce further improvements to model generalisation the factor limiting the number of clusters is the amount of available historic data more data increases the likelihood of multiple occurrences of infrequent events resulting in larger cluster sizes 5 conclusion the primary objective of this paper was to develop an improved method for calibrating urban rainfall runoff models in such a way that preserves time continuity identifies statistically similar calibration and validation datasets and achieves strong generalisation we accomplish these objectives using a novel ensemble framework that relies on unsupervised clustering to identify calibration and validation events within our ensemble models are distinguished by the events to which they are calibrated creating diversity and improving generalisation the main findings of our paper are summarised as follows first we conduct a sensitivity analysis which indicates that there is little difference in parameter sensitivities between event clusters we used the 5 most sensitive parameters to demonstrate how filtering insensitive parameters has no effect on ga based model calibration a systematic cross validation analysis revealed that single models generalise poorly especially on dissimilar events as indicated by the clustering results ensembles were created using events from a single cluster which were found to cross validate well on similar events but poorly across clusters meanwhile ensembles with an even number of events in each cluster are a compromise in performance between the two single cluster ensembles while still outperforming the mean performance of the non ensemble models increasing the number of models in each ensemble was shown to improve performance and reduce variance associated with the random selection of ensemble members several different ensemble combination techniques were compared including uniform weighted mlr based stacking and ann based stacking out of four methods ann based stacking was found to produce the strongest performance across kge and mve while weighted combination produced the best pfe all swmm ensemble techniques outperform the mean single model performance in every metric and catchment except one demonstrating the value of the proposed methods credit authorship contribution statement everett snieder conceptualization methodology software validation formal analysis data curation writing original draft visualization usman t khan conceptualization methodology validation resources writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper funding this work was supported by the natural sciences and engineering research council of canada rgpin 2017 05661 and graduate student support for es provided by york university and through an nserc pgs d scholarship appendix a matlab interface a hierarchical list of functions programmed for this study is included below these are based around creating a swmm class object in matlab with class functions to import swmm models within matlab through shapefiles or existing inp files run simulations modify simulation and model parameters create binary rff and hsf files another class event data is effectively a collection of hydrological timeseries that are discretised from a continuous record this class is often an input to the swmm class functions and has respective class functions for calculating event characteristics and clustering which are used to generate the swmm ensembles the complete swmm wrapper presented in this work is available on github https github com everettsp swmm m appendix b hydrological events see fig b 1 and tables b 1 b 3 
2111,river ice monitoring is vital for water resources hydrological research and operational management of flood risk from ice jams remote sensing offers an efficient way to monitor river ice however limited by the temporal and spatial resolutions of imagery research regarding river ice phenology and processes on the tibetan plateau are lacking this study provides an innovative monitoring approach to the river ice phenology on the tibetan plateau using imagery from the sentinel 2 and landsat 8 satellites in regions where the satellite orbits overlap during the cold season we selected representative river reaches in different basins and climate zones in the overlapping orbit regions to reveal the river ice phenology and process on the tibetan plateau the results showed that the overlapping orbit imagery significantly improved the temporal resolution of river ice monitoring and detailed information on river ice phenology and processes could be obtained the ice cover durations in different river reaches on the tibetan plateau varied ranging from 55 to 277 days the ice cover period tended to be longer in the river reaches with high latitudes and elevations in addition the river ice processes in reaches with flow cutoff were different from those in reaches with no flow cutoff in winter the ice period in cutoff flow river reaches was longer than that in non cutoff flow river reaches in a typical braided channel on the plateau water usually froze in a small channel with low velocity and the resulting ice gradually spreads to other small channels this research is the first to investigate the river ice phenology and processes on the tibetan plateau and the relevant results provide a reference for river ice studies on this plateau keywords river ice phenology freezing and melting remote sensing tibetan plateau data availability no data was used for the research described in the article 1 introduction river freezing is a common phenomenon in cold regions and it significantly influences the river runoff processes prowse and beltaos 2002 tedesco et al 2015 therefore the river ice freezing and melting period and processes are essential to studying the regional water cycle and the utilization of water resources beltaos and prowse 2009 in addition river ice patterns are also changing as the climate warms lesack et al 2014 rokaya et al 2019 yang et al 2020b for example in the arctic region some large russian rivers such as the ob yenisey and lena rivers showed a tendency toward earlier ice cover breakup by 4 to 5 days from 1955 to 2012 prowse et al 2007 shiklomanov and lammers 2014 and the ice cover duration has decreased by 3 to 25 days from 1980 to 2014 vuglinsky and valatin 2018 moreover most rivers in canada have shown a trend toward earlier breakup dates chen and she 2020 de rham et al 2008 lacroix et al 2005 in particular as the water tower of asia the tibetan plateau is the birthplace of several famous asian rivers such as the yangtze ganges and mekong rivers huang et al 2008 the extensive river ice on this plateau has a significant effect on the hydrological process and water resources utilization of the rivers immerzeel et al 2010 in the cold season rivers on the tibetan plateau are prone to freeze and form river ice which accumulates to form solid reservoirs and then melts in spring which has a significant regulating effect on runoff li et al 2019a this finding is particularly important for the surrounding arid regions where water resources are heavily dependent on snow and ice melt in high mountains li et al 2019b delayed freezing and early melting of rivers can directly affect the scientific and rational use of water resources downstream however the scarcity of river ice observation data in this region makes studying the river ice phenology and processes challenging because of the lack of river ice observational data as well as restrictions due to the temporal and spatial resolutions of remote sensing images it is impossible to accurately investigate the river ice phenology of the tibetan plateau previously high temporal resolution satellite images such as those from the moderate resolution imaging spectroradiometer modis and advanced very high resolution radiometer avhrr have been used to study the phenology and processes of river ice these sensors can provide two images per day among the earliest studies mcginnis and schneider 1978 first investigated the breakup at the ottawa river in canada using early satellite images later pavelsky and smith 2004 investigated the river ice melt timing in the arctic regions by manual interpretation of the images from modis and avhrr sensors chaouch et al 2014 introduced an automatic algorithm for investigating the river ice extent on the susquehanna river using modis data similarly cooley and pavelsky 2016 detected river ice spatial and temporal breakup features using modis satellite imagery at large scales in arctic regions muhammad et al 2016 monitored ice breakup based on modis imagery at the mackenzie river and determined the average river breakup date and melt duration days between 2001 and 2013 zhang et al 2017 used modis images to monitor ice jam processes and parameterized ice jam modeling notably the crest river ice observing system crios produces ice cover maps using modis and viirs overpass images at some locations including the susquehanna river kraatz et al 2017 recently beaton et al 2019 introduced an automated method to investigate river ice breakup dates using modis based on the google earth engine chu and lindenschmidt 2019 researched the effects of river geomorphology on river ice freeze up and breakup rates based on modis imagery 2000 2015 indeed the avhrr and modis images have provided powerful tools for the study of river ice but the studied rivers are primarily large low elevation rivers in the arctic and north american regions these sensors have relatively low spatial resolutions and cannot be applied to moderate and small rivers on the tibetan plateau for nearly three decades researchers have tried to use satellite images with higher spatial resolutions to reveal the phenology and processes of river ice in some rivers the landsat radarsat 2 sentinel 1 alos 1 palsar satellite and other satellite imagers have been used to obtain river ice information for example gatto 1990 monitored river ice with landsat images in the northern united states providing a reliable means for investigating past conditions and changes in river ice later wang et al 2014 obtained the river ice hazard dynamics of the yellow river using images obtained from an unmanned aerial vehicle uav sakai et al 2015 used landsat tm etm imagery to investigate the temporal and spatial range of spring breakup floods in siberia s lena river chu et al 2015 detected the change in the ice cover regularity in the slave river in canada based on radarsat 2 imagery lindenschmidt 2018 researched the coherence of radarsat 2 sentinel 1 and alos 1 palsar data for monitoring spatio temporal spatiotemporal variations in river ice covers lindenschmidt and li 2018 also monitored the freeze up process using the freeman durden decomposition of quad pol radarsat 2 imagery zhang et al 2021 presented an asynchronous river ice distribution extraction and change detection method based on multitemporal synthetic aperture radar sar images and multispectral images of the yellow river however the temporal resolution of these images limits detailed river ice monitoring in addition river ice observations have been combined with river ice models to predict river ice breakup for example nafziger et al 2019 presented detailed analyses of river ice development and consolidation events based on field observations sun 2018 predicted river ice breakup timing by stacking multitype model trees in the athabasca river canada sun and trevor 2018 used stacking ensemble learning to predict river ice breakup time we also believe that by combining remote sensing information and river ice modeling a comprehensive understanding of river ice processes will be gained and the risk of ice jam flooding in the united states canada and elsewhere can be reduced in the future however previous studies have mainly focused on the arctic circle and north american regions and have seldom involved river ice distributed in plateau regions as a result the regularity of river ice phenology and processes on the tibetan plateau are unclear only a handful of studies have researched river ice using remote sensing in this region for example li et al 2020b used landsat images to monitor the temporal and spatial distribution features and patterns of river ice at the basin scale in this plateau brombierstaeudl et al 2021 revealed the distribution and correlation of aufeis icing with topographical parameters using landsat images in the upper indus basin in addition li et al 2021 proposed a special river ice extraction algorithm for sentinel 2 and landsat images over the tibetan plateau because they were restricted by the spatial and temporal resolutions of the remote sensing imagery previous studies did not involve research on river ice phenology and processes on the tibetan plateau the tibetan plateau has a unique topography and climate and braided river systems are common the patterns of river freezing and melting are unclear which limits the study of the hydrological effect of river ice on this plateau to reveal the river ice phenology and process on the tibetan plateau we selected imagery of the orbital overlap region of sentinel 2 and landsat 8 satellites which have high spatial and temporal resolutions combining the imagery with the relative difference river ice rdri algorithm we investigated the complete river ice processes in different river reaches in addition we investigated the regularity of river ice development ice appearance days ice disappearance days and total ice cover durations in different river basins and climatic zones on the tibetan plateau this research offers support and references for understanding river ice processes and their hydrological impact on the tibetan plateau 2 study area and data 2 1 study area the tibetan plateau is a typical cold high elevation region with a mean elevation of approximately 4000 m and an area of 2 57 106 km2 this plateau is also known as the asian water tower the source of several well known rivers and it provides water to 1 6 billion people in downstream regions immerzeel et al 2010 this plateau has glacier masses snow and river ice its unique environment in terms of topography and climate on the tibetan plateau has also created unique braided river channels in this study representative river reaches in different basins and climatic zones were selected using specific criteria to monitor the river ice this study involves eight major basins the tarim basin qaidam basin hexi basin yangtze basin yellow basin inner basin brahmaputra basin and mekong basin there are differences in topography and channel characteristics in these basins usually the representative river reaches are located on the mainstream of the largest river in each basin in addition this plateau involves seven main climatic zones zheng et al 2013 there are obvious differences in the climatic characteristics of these climatic zones the climate regionalization scheme in china was based on the classification criteria which include a temperature zone arid humid region and climatic subregion the variables were used as the 30 year mean values according to the daily meteorological data from 658 stations from 1981 to 2010 zheng et al 2013 additionally the river reaches in the regions with overlapping satellite orbits were selected and the information on the selected river reaches basins and climate zones are shown in fig 1 and table 1 2 2 satellite images this study mainly used sentinel 2 imagery supplemented with landsat 8 imagery from 2019 to 2022 sentinel 2 includes two satellites sentinel 2a and sentinel 2b the two satellites were launched on june 23 2015 and march 07 2017 there are two high resolution multispectral imaging satellites used for land monitoring the sentinel 2 satellite is equipped with the multispectral imager msi and contains 13 bands with terrestrial spatial resolutions of 10 m 20 m and 60 m table 1 the sentinel 2 revisit period is ten days for a single satellite which increases to five days when the two satellites are operating simultaneously the landsat 8 satellite was launched on february 11 2013 and its revisit period is 16 days the band settings of landsat 8 are shown in table 1 the sentinel 2 data have much higher temporal and spatial resolutions than the landsat 8 data the sentinel 2a and 2b binaries can provide an image every 2 5 days in the overlap region and landsat 8 can provide an effective image every eight days in the overlap region theoretically the combined orbit of the two satellites can provide an image every two days 1 91 in conclusion combining these two satellites with their spatial and temporal resolutions can meet the requirements to reveal river ice processes and river ice phenology to eliminate images with cloud interference we visually checked the images individually to ensure that only those without cloud interference in the selected river reaches would be used thus river ice monitoring images with cloud interference in each river reach were minimized the selected river reach locations and the selected sentinel 2 images 2019 2020 representative year for each river reach are shown in table 2 2 3 meteorological and other data the climatic regionalization of the tibetan plateau is derived from the climatic regionalization of china 1981 2010 zheng et al 2013 the boundary data of the basins and plateau were acquired from the tibetan plateau science data center http tibet geodata cn the orbit coverage data of sentinel 2 were downloaded from the european space agency s website https sentinel esa int and the orbit coverage data of landsat 8 were obtained from the website https earthexplorer usgs gov in this paper we selected the daily temperature data of era5 and used the mean air temperature data for 2 m above the ground at each selected river reach era5 is the latest generation of the ecmwf reanalysis product and is publicly available https cds climate copernicus eu in addition the spatial resolution of the digital elevation model dem data for the tibetan plateau is 90 m 3 methods the river ice types in this study area include shore ice stable ice sheets and floating ice but stable ice sheets and shore ice are the dominant types the cutoff flow river reach mainly has stable ice sheets in the cold season and the non cutoff flow river reach mainly has shore ice because the river flow is small or cutoff during cold seasons in this region it hardly forms a large range of floating ice the primary process of this study includes the following three steps first we acquired the orbital coverage overlaps of the two satellites and identified the typical river reaches second the distribution extent of river ice in the typical river reaches was extracted using the rdri algorithm third the river ice phenology and processes were analyzed based on the obtained river ice extent the detailed workflow is shown in fig 2 3 1 selection of the typical river reaches using the sentinel 2 and landsat 8 satellite orbit coverage information the regions with overlapping orbit coverage are obtained typical river ice reaches were selected within these overlapping regions the typical river reaches refer to the representative river reaches with river ice developing among many river types in each climatic zone on the tibetan plateau first we visually determined the river reaches with river ice development in different basins and climatic zones and ensured that these river reaches overlapped with the orbit coverages of the two satellites visual river reach selection refers to the use of cloud free winter images of the orbit overlap area of the two satellites to directly search for river ice development in river reaches via visual inspection with human eyes the identified river reaches are used as candidate river reaches the determination of candidate river reaches was also influenced by climate zoning data and watershed boundaries second from the candidate river reaches we used manual inspection to select representative river reaches with different channel morphologies and fully observed river ice periods a complete river ice period is from summer to the following summer the determination of representative river reaches should consider the representativeness of the candidate river reaches and have a sufficient number of available images finally the representative river reaches determined within the existing observation range can be used as the typical river reaches in this study area we revealed the river ice phenology and development process using the images and river ice determination methods in the typical river reaches on the tibetan plateau 3 2 river ice extent determination method the rdri algorithm was used to extract the river ice which was combined with the river ice extent obtained from each river reach to study its phenology and development process 3 2 1 the rdri algorithm the rdri algorithm is defined as the ratio of the reflectance of the red and near infrared nir bands to the sum of the reflectance of the near infrared and infrared bands this algorithm is suitable for river ice extraction in the tibetan plateau li et al 2021 the formula is expressed as follows 1 rdri r red r nir r nir r swir where rred rnir and rswir represent the reflectivity values of the red nir and swir bands respectively the suitable threshold of the rdri algorithm in the tibetan plateau is 0 13 in addition the conditions of rred rnir 0 068 and rnir 0 10 are used to eliminate shadows and water interference the rdri algorithm mainly used the reflectance values in the red nir and swir bands to calculate the rdri values to extract the ice extent of the river in comparison there are differences in the band sequence settings of different sensors for msi sensor data band 4 red band 8 nir and band 11 swir1 were selected to calculate the rdri values for oli data band 4 red band 5 nir and band 6 swir1 were selected to calculate the rdri values 3 3 analysis of river ice phenology and processes 3 3 1 average of the multiple year river ice period the images of three complete river ice periods 2019 2020 2020 2021 and 2021 2022 were used to analyze the average river ice phenology river ice phenology can be expressed using the appearance dates disappearance dates duration accumulation period and melt period in each river reach the ice appearance date is the time when river ice appears in the selected river reaches the ice disappearance date of river ice is the time when river ice disappears in the selected river reaches in the selected typical river reaches the river ice extent extracted using the rdri algorithm is larger than one pixel then the day is determined to belong to the river ice period for the selected typical river reach the river ice duration is the number of days from the time when river ice appears to the time when it disappears in the selected river reach the river ice accumulation period is from the river ice appearance date to the date when the river ice extent reaches its maximum value in the selected river reach finally the river ice melting period extends from the date when the river ice extent reaches its maximum value to the river ice disappearance date in the selected river reach if the maximum value of the river ice extent remains constant for several weeks or even longer the median time of the period is considered to be the time when the maximum value occurs considering the high temporal resolution of the images in the satellite orbit overlap regions the reliability of the obtained results is within an acceptable range despite the influence of cloud interference and other factors 3 3 2 phenology and process in a representative river ice period the images of a complete ice period in 2019 2020 were selected in those selected river reaches the entire river ice process can be observed using multistage remote sensing images then the pattern of river ice growth and melting can be assessed only one year s worth of data is chosen to better match the remote sensing images with the river ice area data and occurrence frequency maps in the current year these selected river ice freezing and melting patterns are stable without significant changes over 2019 2022 hence the river ice processes from 2019 to 2020 can represent the freezing and melting patterns of river ice in other years due to the limitation of illustration space we select some representative images to show the process of river ice accumulation to melting directly more information on the extent of river ice obtained from other images is presented in the bar chart below for example we can determine when and where river ice began to freeze in each channel whether the river ice starts growing from the edge of the channel to the middle of the channel and the extent of fluctuation in the increase or decrease in the river ice period furthermore we compared the days of the river ice growth process and melting process then we compared the growth rate and the melting rate of river ice at each river reach 4 results 4 1 river ice phenology in multiple years 2019 2022 we used 2019 2022 images to obtain the average river ice period of the selected river reaches fig 3 the average river ice period is the average of the complete river ice period using points in time per year the results indicated that the ice period is usually longer in the higher latitude river reaches and the ice period duration is also influenced by other factors such as channel morphology the c and e river reaches had the longest ice periods and reached 268 days and the g river reach had the shortest ice period at 61 days the average ice period of these river reaches was 181 days because river ice freezing depends on temperature we researched the connection between the river ice period and latitude and elevation the river reaches with high elevations tend to have longer periods because higher elevations are associated with lower temperatures therefore the correlation analysis results showed that the ice period length in the selected reaches had a weak but not significant correlation with elevation these results also suggested that the river ice period was correlated with latitude and elevation however although high latitudes and elevations can provide low temperature conditions they were not the decisive factor because river freezing was also influenced by other factors such as flow velocity and channel shape according to the monitoring results of the above eight representative river reaches there were obvious discrepancies in river ice periods in different areas of the tibetan plateau for example in some high elevation river reaches d e a and c and high latitude river reaches b river ice usually appeared earlier and disappeared later so there were longer ice periods the river ice was usually present in these reaches and the extent of river ice was large therefore the ice period in the cutoff flow river reaches on the tibetan plateau was usually long often starting in october and ending in june or july of the following year the maximum length of the ice period was approximately nine months in contrast river ice appeared later and disappeared earlier in some low elevation reaches h and g and low latitude reaches f as a result the river ice period was relatively short and the extent of the river ice was smaller furthermore these river reaches often correspond to the main channel of large rivers which flow continuously in the cold season therefore the ice period of the mainstream reaches with continuous flow on the tibetan plateau was relatively short the length of this period was approximately 2 3 months usually starting in december and ending in march of the next year there are significant differences in the length of the ice period for tibetan plateau rivers which are affected by the climate topography and river channel characteristics similarly the ice period of 58 lakes on the tibetan plateau from 2000 to 2017 also differed and the average period was 157 78 days cai et al 2019 at present there are no other studies on river ice phenology on the tibetan plateau for comparison 4 2 phenology and process in a complete river ice period 4 2 1 tarim river basin a river reach river reach a is located on the yarkan river in the tarim river basin it is located in the plateau subfrigid arid zone which is a typical high elevation river channel with a cutoff flow in winter this river reach has a large curvature and a wide and shallow river valley its two banks are mountainous the water level does not decrease significantly and the river flow nearly ceases during the ice period we selected 21 representative images to show the process of river ice accumulation to melting directly more information on the extent of the river ice obtained from 51 images was presented in the bar chart below according to the principles of determination introduced in the methods section the results show that during the 2019 2020 ice period in the river reach a river ice first appeared on october 20 2019 and disappeared on june 29 2020 with a total period of 253 days fig 4 the maximum extent of river ice in this river reach appeared on february 9 2020 with a total of 2 5323 km2 the length of this river reach was 7071 m and the maximum width of the river ice was 867 m the river ice type was mainly stable ice sheets the river ice accumulation period lasted 112 days from october 20 2019 to february 9 2020 and the river ice extent gradually increased the river ice melting period lasted 141 days from february 9 2020 to june 29 2020 when river ice slowly began to melt in the thinner river ice areas a comparison between the area of river ice and the mean air temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature in this river reach river ice tended to concentrate in the central area of the channel the occurrence frequency of river ice was low at the edges of the main channel fig 4 the main reason for this phenomenon is that in winter portions of the river become separated and the central area of the channel is more likely to form thicker ice 4 2 2 qaidam river basin b river reach the b river reach is located on the geermu river in the qaidam river basin it is located in the plateau temperate arid zone with broad and flat terrain and features a braided channel with a partial discontinuous flow in winter this river reach is relatively straight and the terrain on both banks is flat the water level drop is small and the riverbed is alternately shallow and deep troughs we selected 20 representative images that directly show the process of river ice accumulation to melting more information on the extent of river ice obtained from 38 images was presented in the bar chart at the bottom during the 2019 2020 ice period in the b river reach river ice first appeared on october 27 2019 and disappeared on april 16 2020 the river ice period lasted 172 days fig 5 the maximum extent of river ice in this river reach appeared on february 11 2020 with a total of 3 3846 km2 the length of this river reach was 3225 m and the maximum width of the river ice was 1413 m the river ice type was mainly stable ice sheets the river ice area showed some fluctuation during the entire river ice period which may be related to fluctuations in temperature and snowfall a comparison between the area of river ice and the mean air temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature usually low temperatures and snowfall promote the accumulation of river ice while high temperatures lead to river ice melting the river ice accumulation period was 107 days from october 27 2019 to february 11 2020 and the river ice extent gradually increased the river ice melting period lasted 65 days from february 11 2020 to april 16 2020 generally river ice began to melt rapidly in the thinner river ice areas the river ice duration of the melting period was significantly shorter than that of the accumulation period river ice in this reach was located in the area of the deep channel but the occurrence frequency of river ice in the central area of the main channel was not necessarily high which was characteristic of the river ice distribution in braided channels fig 5 4 2 3 hexi river basin c river reach the c river reach is located on the shule river in the hexi river basin it is located in the plateau temperate semiarid zone with wide valley terrain and featured a braided channel with a partial discontinuous flow in winter the river reach is straight the terrain on both sides is flat with meadow the water level difference is minimal and the depth is shallow the river width is relatively large and the distribution of river ice is relatively widespread we selected 25 representative images that show the process of river ice accumulation to melting directly more information on the extent of river ice obtained from 64 images was presented in the bar chart below the results showed that in the 2019 2020 ice period river ice first appeared in the c river reach on october 13 2019 and disappeared on july 13 2020 with a river ice period of 284 days fig 6 the maximum extent of river ice appeared on march 4 2020 and reached a total of 10 2204 km2 the length of this river reach was 7018 m and the maximum width of the river ice was 1853 m the river ice type was mainly stable ice sheets the river ice area presented a stable growth trend during the entire accumulation period of river ice there were obvious fluctuations during the melting period which may be related to fluctuations in temperature and snowfall usually low temperatures and snowfall promote the accumulation of river ice while high temperatures lead to river ice melting the river ice accumulation period lasted 143 days from october 13 2019 to march 4 2020 and the river ice extent gradually increased in contrast the river ice melting period lasted 131 days from march 4 2020 to july 13 2020 when river ice began to melt rapidly in areas with thinner river ice the melting period duration of the river ice was slightly shorter than that of the accumulation period the thinner river ice areas may melt faster while the thicker river ice areas may melt more slowly a comparison between the area of river ice and the mean air temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature the occurrence frequency map of river ice showed that river ice tended to appear in the deep area in this river reach the occurrence frequency in the central area of the main channel was not necessarily high which was the distribution characteristic of river ice in braided channels fig 6 4 2 4 inner river basin d river reach the d river reach is located on the jiangai river in the inner river basin it is located in the plateau subfrigid semiarid zone the d river reach is a typical high elevation channel with flat terrain and features no flow in winter this reach of the river is curved and the valley is relatively narrow the terrain on both sides is flat grassland we selected 20 representative images that show the process of river ice accumulation to melting directly more information on the extent of river ice obtained from 49 images was presented in the bar chart below the results showed that in the 2019 2020 ice period river ice first appeared in river reach d on october 13 2019 and disappeared on june 29 2020 and the river ice period lasted 260 days fig 7 the maximum extent of river ice in this reach appeared on march 21 2020 with a total of 4 9255 km2 the length of this river reach was 8093 m and the maximum width of the river ice was 885 m the river ice type was mainly stable ice sheets the river ice accumulation period lasted 160 days from october 13 2019 to march 21 2020 and the river ice extent gradually increased the river ice melting period lasted 100 days from march 21 2020 to june 29 2020 when river ice gradually began to melt in the thinner river ice area the accumulation period of river ice was longer than the melting period in this reach and the fluctuation in river ice extent was obvious the thinner river ice melted faster while the thicker river ice melted more slowly a comparison between the area of river ice and the mean air temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature in this reach river ice tended to appear in the central area of the channel while the occurrence frequency of river ice was low at the edge of the main channel fig 7 4 2 5 yangtze river basin e river reach the e river reach is located on the yangtze river it is located in the plateau subfrigid semiarid zone the e river reach is a typical high elevation braided channel with a discontinuous flow in winter this river reach is wide and shallow and the terrain on both sides of the river is flat with sparse meadow the river reach has a small curvature a small water level drop and a dense interlacing of small channels we selected 20 representative images that show the process of river ice accumulation to melting directly more information on the river ice extent obtained from 50 images was presented in the bar chart below the results showed that during the 2019 2020 ice period river ice first appeared in the e river reach on october 17 2019 and disappeared on july 17 2020 with a river ice period of 274 days fig 8 in this river reach the maximum extent of river ice appeared on march 27 2020 with a total of 4 4899 km2 the length of this river reach was 5071 m and the maximum width of the river ice was 1557 m the river ice type was mainly stable ice sheets the river ice accumulation period lasted 162 days from october 17 2019 to march 27 2020 and the river ice extent gradually increased the river ice melting period lasted 112 days from march 27 2020 to july 17 2020 when river ice gradually began to melt in areas with thinner river ice the thinner river ice melted faster while the thicker river ice melted more slowly thus the river ice initially appeared in a discrete state with the gradual accumulation of river ice into a single entity the river ice disintegrated into a discrete state as the temperature rose and then gradually melted a comparison between the area of river ice and the mean air temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature in this reach river ice tended to appear in the central area of the channel while the occurrence frequency of river ice was low at the edges of the main channel fig 8 4 2 6 yellow river basin f river reach the f river reach is located on the yellow river it is located in the plateau subfrigid subhumid zone with canyon terrain it is the main channel of a large river and has continuous flow year round with a high flow rate this river reach is at a river bend in a deep valley area with a small water level drop the length of this river reach is 3402 m and the width of the river channel is 219 m the river ice type is mainly shore ice we selected ten representative images that show the process of river ice accumulation to melting directly more information on the extent of river ice obtained from 24 images was presented in the bar chart below the results showed that during the 2019 2020 ice period river ice first appeared in the f river reach on december 4 2019 and disappeared on february 29 2020 the river ice period was relatively short 85 days and only a small amount of river ice developed at the riverbank edge fig 9 the maximum extent of river ice in this reach was 0 0253 km2 on december 29 2020 the river ice accumulation period was 25 days from december 4 2019 to december 29 2020 river ice gradually appeared at the riverbank edge and its extent gradually increased the river ice melting period lasted 60 days from december 29 2020 to february 29 2020 the river ice at the riverbank edge gradually began to melt a comparison between the area of river ice and the mean temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature in general such channels do not easily freeze because of large discharge and fast velocity and river ice appears only in slow flow areas along the margins 4 2 7 brahmaputra river basin g river reach the g river reach is located on the brahmaputra river in the brahmaputra river basin and is located in the plateau temperate semiarid zone it is the most typical braided channel on the plateau with numerous and dense channels and river ice appeared only in some channels with a slow flow in winter the length of this river reach is 13510 m and the width of the main river channel is 2654 m the river ice type was mainly stable ice sheets and shore ice this river reach is relatively straight broad and shallow and is located in a high mountain valley there is a small drop in water level but sufficient flow we selected 14 representative images that show the process of river ice accumulation to melting directly more information on the extent of river ice obtained from 21 images was presented in the bar chart below the results showed that in the 2019 2020 ice period river ice first appeared in the g river reach on december 11 2019 and disappeared on february 14 2020 with a river ice period of 65 days fig 10 the maximum extent of river ice in this reach appeared on december 31 2020 with a total area of 0 2697 km2 the river ice accumulation period lasted for 20 days from december 11 2019 to december 31 2020 and the river ice extent gradually increased the river ice melting period lasted 45 days from december 31 2020 to february 14 2020 with the river ice gradually melting the accumulation duration of river ice was shorter than the melting duration a comparison between the area of river ice and the mean temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature in comparison river ice was poorly developed in this reach 4 2 8 mekong river basin h river reach the h river reach is located on the mekong river in the mekong river basin and is located in the plateau temperate semihumid zone it is also a typical braided channel on the plateau with continuous flow in winter and river ice forms only in distributary channels with low velocities the length of this river reach is 4205 m and the width of the main river channel is 147 m the river ice type is mainly stable ice sheets and shore ice this river reach is relatively curved and shallow and is located in a wide valley of high mountains the river channel is scattered but the flow is relatively abundant the type of river ice studied in this section is ice sheets we selected ten representative images that show the process of river ice accumulation to melting directly more information on the extent of river ice obtained from 23 images was presented in the bar chart below in the 2019 to 2020 ice period river ice first appeared in the h river reach on december 5 2019 and disappeared on march 5 2020 with a river ice period of 91 days fig 11 the maximum extent of river ice in this river reach appeared on december 30 2020 reaching 0 0794 km2 the river ice accumulation period was 25 days from december 5 2019 to december 30 2019 and the river ice appeared and expanded gradually the river ice melting period was 66 days from december 30 2019 to march 5 2020 when river ice slowly began to melt in areas with thinner river ice thus the melting period of river ice was shorter than the accumulation period a comparison between the area of river ice and the mean temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature river ice did not develop in this reach and the river ice occurrence frequency map showed that river ice occurred only in some channels with low velocities 4 2 9 accumulation period and melting period in the above river reaches the melting period was shorter than the accumulation period in some reaches whereas the melting period was longer than the accumulation period in other river reaches in the a f g and h river reaches the river ice accumulation period 112 days 25 days 20 days and 25 days respectively was shorter than the river ice melting period 141 days 60 days 45 days and 66 days respectively in the b c d and e river reaches the river ice accumulation period 107 days 143 days 160 days and 162 days respectively was longer than the river ice melting period 65 days 131 days 100 days and 112 days respectively among them the f g and h river reaches were non cutoff flow river reaches and the accumulation period of river ice in these reaches tended to be shorter moreover the ice period in these reaches was shorter the river ice was thinner the temperature in the river ice melting period was still relatively low and the river ice melting was slow the melting period of river ice was usually shorter than the accumulation period in the b c d and e river reaches the river ice increases in months with lower temperatures and the river ice rapidly melts when the temperature increases significantly among the above river reaches the a river reach was an exception which may be related to the formation of highly thick ice in local areas which prolonged the melting period of this river reach li et al 2020a in this river reach the channel width of the river was relatively narrow and curved and thicker ice usually formed 5 discussion 5 1 advantages of overlapping orbit imagery the use of medium and high spatial resolution satellite images with orbital overlap has significant advantages in monitoring river ice in the plateau region first the high spatial resolution of the remote sensing images makes it possible to extract the river ice extent of small rivers on the plateau notably the number of small rivers is significantly greater than that of large rivers in this plateau region second the images in the overlapping area also have a high temporal resolution providing large amounts of information for river ice phenology monitoring which supports the study of plateau river ice the combination of the two sentinel 2 satellites and the landsat 8 satellite can provide an image every two days 1 91 in addition plateau rivers have unique characteristics such as various river channel types complex terrain and complex river ice forms previous studies on river ice phenology have mainly focused on large rivers using modis and other low spatial resolution data cooley and pavelsky 2016 muhammad et al 2016 pavelsky and smith 2004 these data tend to have high temporal resolutions and can obtain abundant information on river ice processes the high spatial resolution overlap images significantly expand the range of river ice that can be monitored remotely this research first determined the river ice phenology and process on the tibetan plateau using remote sensing this study provides new findings on river ice on this plateau 5 2 river ice phenology on the tibetan plateau 5 2 1 river ice period the ice duration periods in different river reaches of the tibetan plateau have apparent differences ranging from 55 to 277 days the monitoring results of the selected river reaches in 2019 2020 show that the river ice basically presents gradual accumulation and then gradual melting and the river ice area does not remain stable for a long period of time the influence of temperature on the length of the river ice period was relatively clear in the selected river reaches the river ice period in high latitude and high elevation areas was relatively long because the temperature is usually low in these areas however these two factors were not significantly correlated with the river period length because the formation of river ice was also impacted by other factors such as the speed of the river and the shape of the channel prowse et al 2007 similarly there are also spatial differences in ice duration in other regions outside of the tibetan plateau for example the yellow river in inner mongolia generally starts to freeze in mid to late november and thaw in mid to late march of the following year li et al 2016 the number of frozen days is generally approximately 100 days and the longest is more than 130 days ice started to form on the urumqi river in mid november to early december and started to melt in mid april to late may in 1985 1992 zhang 1992 in the songhua river basin from 2010 to 2015 the average appearance date of river ice was november 7 and the average disappearance date was april 15 yang et al 2020a in addition the river ice duration has decreased in the arctic region vuglinsky and valatin 2018 moreover there are still differences in ice periods in this region because of the influences of latitude and other factors pavelsky and smith 2004 prowse et al 2007 previous studies of river ice primarily focused on the date when rivers began to form and breakup because these aspects are correlated to navigation flooding and climate warming prowse et al 2007 shiklomanov and lammers 2014 on the tibetan plateau where there are few people and climate changes are significant researchers have focused on the effect of river ice on the cryosphere and its response to climate therefore research on the river ice accumulation and melting periods is significant for river ice hydrology and cold region hydrologic models li et al 2020b however insufficient remote sensing data still limit the study of the changes in river ice accumulation and melting periods on the tibetan plateau 5 2 2 river ice processes the river ice process has unique patterns and the flows of some rivers are cut off in winter during the accumulation period the river ice usually starts to freeze in the center of the channel and gradually extends to the edge of the river channel during the melting period river ice usually starts to melt from the margins of the channel and gradually expands to the center of the river channel figs 2 3 4 this phenomenon is due to the low flow of rivers on the tibetan plateau in winter and flow occurs only in the center of the river li et al 2020b the river water flow is obstructed when the river ice forms the river water gradually flows to the edge of the river channel and then freezes on the margins of the river and forms river ice it is difficult to freeze the water in the river reaches with fast flows the river reaches with no ice period often have high discharge and are usually located in the mainstream of the river or in narrow channels with canyon terrain however the river freezing process of channels with continuous flow in winter is opposite to that of channels with discontinuous flow river ice forms from the river edges to the center during the accumulation period and melts from the center to the edges during the melting period fig 7 this phenomenon is related to the high discharge and fast velocity in the central river channel therefore the process of river ice formation is affected by the channel type better characterization of river ice processes on the tibetan plateau needs to be combined with hydrological models since remote sensing data are only instantaneous observations li et al 2020b lindenschmidt 2017 in particular river ice models and more frequent observations are needed to monitor and study river ice jams shen 2010 identifying the influence of river ice processes on river runoff processes in the tibetan plateau is crucial to the scientific use of water resources in the arid zone downstream of rivers in this region 5 3 applications limitations and challenges the high spatial and temporal resolution of remote sensing imagery can directly show river ice accumulation and melting processes on the tibetan plateau in addition this imagery can be used to determine the river ice phenology in regions with overlapping imagery this research obtained features of the river ice phenology and processes in different types of river channels on the tibetan plateau it is a common phenomenon that river ice increases in months with lower temperatures and rapidly melts when the temperature increases significantly this study is the first to reveal the specific time of the appearance and disappearance of river ice using remote sensing in some river reaches on the tibetan plateau in addition this study displayed the whole process of river ice development and determined the differences in river ice periods and patterns in different river reaches this study enhances the understanding of the river ice processes and supports the progress of hydrological models clarifying the river ice impact on the river discharge process is vital for future research on downstream water resource utilization although this study focuses on river ice on the tibetan plateau its research methods are applicable to north america the arctic circle and other regions and can significantly enhance the monitoring of river ice in some small and medium sized rivers the restrictions of this research are related to imagery temporal resolutions cloud disturbances and snow disturbances specifically the temporal resolution of the images used can introduce some errors which may influence the identification of the accumulation and melting periods cloud disturbances which are a source of error also influence the use of optical images li et al 2020b in this study the dates of river ice appearance maximum extent and disappearance were all inferred from the satellite images obtained and there may be some errors with the actual dates due to these remote sensing data coverage limitations it is impossible to monitor the entire river ice process in the whole basin the short operation time of sentinel 2 limited the acquisition of long time series images which limited the study of multi year river ice phenology in addition we extracted the river ice distribution extent using the rdri algorithm which can distinguish between river ice and snow river ice may be missed because of thick snow cover when using the rdri algorithm this occurrence frequency influences the river ice period investigation hence we did not choose the river reach at higher elevations that are covered with snow all year round and we did not use images with significant snow cover in this study this study revealed the river ice processes and phenology on the tibetan plateau by selecting typical river reaches which were not necessarily representative of the river ice processes at a large scale or watershed scale furthermore due to the limited availability of river discharge data the relationship between river discharge and river ice processes could not be analyzed we have added the temperature information of the river reach but the era5 has a resolution of 30 km hence an accurate description of the temperature of the valley in the plateau region may be insufficient as the weather in the plateau valley area is complicated and changeable in addition the ice period duration of the whole river may be different and the ice period durations of different river reaches may also vary as they are influenced by local environmental factors flow hydraulics and bed morphology however due to the lack of observational data on river morphology hydraulics and other factors it is impossible to perform a quantitative analysis of multi factor influencing on the ice period to further study river ice processes we need to enhance ground observations of river ice in the future for example unattended observation cameras could be established in some typical river sections to observe the whole process of river ice in real time river ice observation data are relatively abundant in northeastern china yang et al 2020a investigated the temporal and spatial changes in river ice thickness and phenology at the songhua river based on the 156 hydrological station records unfortunately the scarcity of river ice observations on the tibetan plateau hinders related research in addition we need to study the river ice model suitable for the tibetan plateau to better understand better the hydrological process and function of river ice li et al 2020a more attention and technical means are needed to study the river ice of this plateau including the use of drone monitoring and wireless cameras 6 conclusions this research was the first to determine river ice phenology and river ice processes on the tibetan plateau in detail there are apparent differences in the river ice periods on the tibetan plateau the overlapping orbit imagery of the sentinel 2 and landsat 8 satellites provide a sufficiently high temporal resolution to significantly improve research on river ice phenology generally the river reaches with longer ice periods tend to have flows that cut off during the ice period while river reaches with shorter ice periods do not the ice period for river reaches with long ice periods starts in october and ends in june or july of the following year for the river reaches with a short river ice period the river ice period begins in december and ends in february or march of the following year furthermore the melting period of river ice is usually shorter than the accumulation period for rivers in high elevation and high latitude regions the length of the river ice duration is also affected by river velocity and channel shape moreover the river ice process in reaches with a flow cutoff differs from that in reaches with no flow cutoff in river reaches where the flow cuts off in winter the river ice usually freezes from the middle of the channel and then the melting advances from the edge to the middle in contrast in large rivers in which the flow does not cut off in winter the freezing of river ice usually starts from the riverbank and gradually advances to the center of the river melting begins from the center and gradually migrates to the riverbank in a typical braided river reach on the plateau the water usually freezes in a small channel with low velocity and then the ice spreads to other small channels this study is the first to provide information on the phenology and process of river ice using remote sensing imagery on the tibetan plateau which supports river ice research on this plateau and other regions credit authorship contribution statement haojie li writing original draft methodology software data curation writing review editing hongyi li conceptualization supervision writing review editing jian wang conceptualization supervision xiaohua hao conceptualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the national natural science foundation of china grant no 42261027 and 42171391 the gansu provincial natural science foundation grant no 22jr5ra142 and the open foundation from national cryosphere desert data center grant no 2021kf10 supported this research 
2111,river ice monitoring is vital for water resources hydrological research and operational management of flood risk from ice jams remote sensing offers an efficient way to monitor river ice however limited by the temporal and spatial resolutions of imagery research regarding river ice phenology and processes on the tibetan plateau are lacking this study provides an innovative monitoring approach to the river ice phenology on the tibetan plateau using imagery from the sentinel 2 and landsat 8 satellites in regions where the satellite orbits overlap during the cold season we selected representative river reaches in different basins and climate zones in the overlapping orbit regions to reveal the river ice phenology and process on the tibetan plateau the results showed that the overlapping orbit imagery significantly improved the temporal resolution of river ice monitoring and detailed information on river ice phenology and processes could be obtained the ice cover durations in different river reaches on the tibetan plateau varied ranging from 55 to 277 days the ice cover period tended to be longer in the river reaches with high latitudes and elevations in addition the river ice processes in reaches with flow cutoff were different from those in reaches with no flow cutoff in winter the ice period in cutoff flow river reaches was longer than that in non cutoff flow river reaches in a typical braided channel on the plateau water usually froze in a small channel with low velocity and the resulting ice gradually spreads to other small channels this research is the first to investigate the river ice phenology and processes on the tibetan plateau and the relevant results provide a reference for river ice studies on this plateau keywords river ice phenology freezing and melting remote sensing tibetan plateau data availability no data was used for the research described in the article 1 introduction river freezing is a common phenomenon in cold regions and it significantly influences the river runoff processes prowse and beltaos 2002 tedesco et al 2015 therefore the river ice freezing and melting period and processes are essential to studying the regional water cycle and the utilization of water resources beltaos and prowse 2009 in addition river ice patterns are also changing as the climate warms lesack et al 2014 rokaya et al 2019 yang et al 2020b for example in the arctic region some large russian rivers such as the ob yenisey and lena rivers showed a tendency toward earlier ice cover breakup by 4 to 5 days from 1955 to 2012 prowse et al 2007 shiklomanov and lammers 2014 and the ice cover duration has decreased by 3 to 25 days from 1980 to 2014 vuglinsky and valatin 2018 moreover most rivers in canada have shown a trend toward earlier breakup dates chen and she 2020 de rham et al 2008 lacroix et al 2005 in particular as the water tower of asia the tibetan plateau is the birthplace of several famous asian rivers such as the yangtze ganges and mekong rivers huang et al 2008 the extensive river ice on this plateau has a significant effect on the hydrological process and water resources utilization of the rivers immerzeel et al 2010 in the cold season rivers on the tibetan plateau are prone to freeze and form river ice which accumulates to form solid reservoirs and then melts in spring which has a significant regulating effect on runoff li et al 2019a this finding is particularly important for the surrounding arid regions where water resources are heavily dependent on snow and ice melt in high mountains li et al 2019b delayed freezing and early melting of rivers can directly affect the scientific and rational use of water resources downstream however the scarcity of river ice observation data in this region makes studying the river ice phenology and processes challenging because of the lack of river ice observational data as well as restrictions due to the temporal and spatial resolutions of remote sensing images it is impossible to accurately investigate the river ice phenology of the tibetan plateau previously high temporal resolution satellite images such as those from the moderate resolution imaging spectroradiometer modis and advanced very high resolution radiometer avhrr have been used to study the phenology and processes of river ice these sensors can provide two images per day among the earliest studies mcginnis and schneider 1978 first investigated the breakup at the ottawa river in canada using early satellite images later pavelsky and smith 2004 investigated the river ice melt timing in the arctic regions by manual interpretation of the images from modis and avhrr sensors chaouch et al 2014 introduced an automatic algorithm for investigating the river ice extent on the susquehanna river using modis data similarly cooley and pavelsky 2016 detected river ice spatial and temporal breakup features using modis satellite imagery at large scales in arctic regions muhammad et al 2016 monitored ice breakup based on modis imagery at the mackenzie river and determined the average river breakup date and melt duration days between 2001 and 2013 zhang et al 2017 used modis images to monitor ice jam processes and parameterized ice jam modeling notably the crest river ice observing system crios produces ice cover maps using modis and viirs overpass images at some locations including the susquehanna river kraatz et al 2017 recently beaton et al 2019 introduced an automated method to investigate river ice breakup dates using modis based on the google earth engine chu and lindenschmidt 2019 researched the effects of river geomorphology on river ice freeze up and breakup rates based on modis imagery 2000 2015 indeed the avhrr and modis images have provided powerful tools for the study of river ice but the studied rivers are primarily large low elevation rivers in the arctic and north american regions these sensors have relatively low spatial resolutions and cannot be applied to moderate and small rivers on the tibetan plateau for nearly three decades researchers have tried to use satellite images with higher spatial resolutions to reveal the phenology and processes of river ice in some rivers the landsat radarsat 2 sentinel 1 alos 1 palsar satellite and other satellite imagers have been used to obtain river ice information for example gatto 1990 monitored river ice with landsat images in the northern united states providing a reliable means for investigating past conditions and changes in river ice later wang et al 2014 obtained the river ice hazard dynamics of the yellow river using images obtained from an unmanned aerial vehicle uav sakai et al 2015 used landsat tm etm imagery to investigate the temporal and spatial range of spring breakup floods in siberia s lena river chu et al 2015 detected the change in the ice cover regularity in the slave river in canada based on radarsat 2 imagery lindenschmidt 2018 researched the coherence of radarsat 2 sentinel 1 and alos 1 palsar data for monitoring spatio temporal spatiotemporal variations in river ice covers lindenschmidt and li 2018 also monitored the freeze up process using the freeman durden decomposition of quad pol radarsat 2 imagery zhang et al 2021 presented an asynchronous river ice distribution extraction and change detection method based on multitemporal synthetic aperture radar sar images and multispectral images of the yellow river however the temporal resolution of these images limits detailed river ice monitoring in addition river ice observations have been combined with river ice models to predict river ice breakup for example nafziger et al 2019 presented detailed analyses of river ice development and consolidation events based on field observations sun 2018 predicted river ice breakup timing by stacking multitype model trees in the athabasca river canada sun and trevor 2018 used stacking ensemble learning to predict river ice breakup time we also believe that by combining remote sensing information and river ice modeling a comprehensive understanding of river ice processes will be gained and the risk of ice jam flooding in the united states canada and elsewhere can be reduced in the future however previous studies have mainly focused on the arctic circle and north american regions and have seldom involved river ice distributed in plateau regions as a result the regularity of river ice phenology and processes on the tibetan plateau are unclear only a handful of studies have researched river ice using remote sensing in this region for example li et al 2020b used landsat images to monitor the temporal and spatial distribution features and patterns of river ice at the basin scale in this plateau brombierstaeudl et al 2021 revealed the distribution and correlation of aufeis icing with topographical parameters using landsat images in the upper indus basin in addition li et al 2021 proposed a special river ice extraction algorithm for sentinel 2 and landsat images over the tibetan plateau because they were restricted by the spatial and temporal resolutions of the remote sensing imagery previous studies did not involve research on river ice phenology and processes on the tibetan plateau the tibetan plateau has a unique topography and climate and braided river systems are common the patterns of river freezing and melting are unclear which limits the study of the hydrological effect of river ice on this plateau to reveal the river ice phenology and process on the tibetan plateau we selected imagery of the orbital overlap region of sentinel 2 and landsat 8 satellites which have high spatial and temporal resolutions combining the imagery with the relative difference river ice rdri algorithm we investigated the complete river ice processes in different river reaches in addition we investigated the regularity of river ice development ice appearance days ice disappearance days and total ice cover durations in different river basins and climatic zones on the tibetan plateau this research offers support and references for understanding river ice processes and their hydrological impact on the tibetan plateau 2 study area and data 2 1 study area the tibetan plateau is a typical cold high elevation region with a mean elevation of approximately 4000 m and an area of 2 57 106 km2 this plateau is also known as the asian water tower the source of several well known rivers and it provides water to 1 6 billion people in downstream regions immerzeel et al 2010 this plateau has glacier masses snow and river ice its unique environment in terms of topography and climate on the tibetan plateau has also created unique braided river channels in this study representative river reaches in different basins and climatic zones were selected using specific criteria to monitor the river ice this study involves eight major basins the tarim basin qaidam basin hexi basin yangtze basin yellow basin inner basin brahmaputra basin and mekong basin there are differences in topography and channel characteristics in these basins usually the representative river reaches are located on the mainstream of the largest river in each basin in addition this plateau involves seven main climatic zones zheng et al 2013 there are obvious differences in the climatic characteristics of these climatic zones the climate regionalization scheme in china was based on the classification criteria which include a temperature zone arid humid region and climatic subregion the variables were used as the 30 year mean values according to the daily meteorological data from 658 stations from 1981 to 2010 zheng et al 2013 additionally the river reaches in the regions with overlapping satellite orbits were selected and the information on the selected river reaches basins and climate zones are shown in fig 1 and table 1 2 2 satellite images this study mainly used sentinel 2 imagery supplemented with landsat 8 imagery from 2019 to 2022 sentinel 2 includes two satellites sentinel 2a and sentinel 2b the two satellites were launched on june 23 2015 and march 07 2017 there are two high resolution multispectral imaging satellites used for land monitoring the sentinel 2 satellite is equipped with the multispectral imager msi and contains 13 bands with terrestrial spatial resolutions of 10 m 20 m and 60 m table 1 the sentinel 2 revisit period is ten days for a single satellite which increases to five days when the two satellites are operating simultaneously the landsat 8 satellite was launched on february 11 2013 and its revisit period is 16 days the band settings of landsat 8 are shown in table 1 the sentinel 2 data have much higher temporal and spatial resolutions than the landsat 8 data the sentinel 2a and 2b binaries can provide an image every 2 5 days in the overlap region and landsat 8 can provide an effective image every eight days in the overlap region theoretically the combined orbit of the two satellites can provide an image every two days 1 91 in conclusion combining these two satellites with their spatial and temporal resolutions can meet the requirements to reveal river ice processes and river ice phenology to eliminate images with cloud interference we visually checked the images individually to ensure that only those without cloud interference in the selected river reaches would be used thus river ice monitoring images with cloud interference in each river reach were minimized the selected river reach locations and the selected sentinel 2 images 2019 2020 representative year for each river reach are shown in table 2 2 3 meteorological and other data the climatic regionalization of the tibetan plateau is derived from the climatic regionalization of china 1981 2010 zheng et al 2013 the boundary data of the basins and plateau were acquired from the tibetan plateau science data center http tibet geodata cn the orbit coverage data of sentinel 2 were downloaded from the european space agency s website https sentinel esa int and the orbit coverage data of landsat 8 were obtained from the website https earthexplorer usgs gov in this paper we selected the daily temperature data of era5 and used the mean air temperature data for 2 m above the ground at each selected river reach era5 is the latest generation of the ecmwf reanalysis product and is publicly available https cds climate copernicus eu in addition the spatial resolution of the digital elevation model dem data for the tibetan plateau is 90 m 3 methods the river ice types in this study area include shore ice stable ice sheets and floating ice but stable ice sheets and shore ice are the dominant types the cutoff flow river reach mainly has stable ice sheets in the cold season and the non cutoff flow river reach mainly has shore ice because the river flow is small or cutoff during cold seasons in this region it hardly forms a large range of floating ice the primary process of this study includes the following three steps first we acquired the orbital coverage overlaps of the two satellites and identified the typical river reaches second the distribution extent of river ice in the typical river reaches was extracted using the rdri algorithm third the river ice phenology and processes were analyzed based on the obtained river ice extent the detailed workflow is shown in fig 2 3 1 selection of the typical river reaches using the sentinel 2 and landsat 8 satellite orbit coverage information the regions with overlapping orbit coverage are obtained typical river ice reaches were selected within these overlapping regions the typical river reaches refer to the representative river reaches with river ice developing among many river types in each climatic zone on the tibetan plateau first we visually determined the river reaches with river ice development in different basins and climatic zones and ensured that these river reaches overlapped with the orbit coverages of the two satellites visual river reach selection refers to the use of cloud free winter images of the orbit overlap area of the two satellites to directly search for river ice development in river reaches via visual inspection with human eyes the identified river reaches are used as candidate river reaches the determination of candidate river reaches was also influenced by climate zoning data and watershed boundaries second from the candidate river reaches we used manual inspection to select representative river reaches with different channel morphologies and fully observed river ice periods a complete river ice period is from summer to the following summer the determination of representative river reaches should consider the representativeness of the candidate river reaches and have a sufficient number of available images finally the representative river reaches determined within the existing observation range can be used as the typical river reaches in this study area we revealed the river ice phenology and development process using the images and river ice determination methods in the typical river reaches on the tibetan plateau 3 2 river ice extent determination method the rdri algorithm was used to extract the river ice which was combined with the river ice extent obtained from each river reach to study its phenology and development process 3 2 1 the rdri algorithm the rdri algorithm is defined as the ratio of the reflectance of the red and near infrared nir bands to the sum of the reflectance of the near infrared and infrared bands this algorithm is suitable for river ice extraction in the tibetan plateau li et al 2021 the formula is expressed as follows 1 rdri r red r nir r nir r swir where rred rnir and rswir represent the reflectivity values of the red nir and swir bands respectively the suitable threshold of the rdri algorithm in the tibetan plateau is 0 13 in addition the conditions of rred rnir 0 068 and rnir 0 10 are used to eliminate shadows and water interference the rdri algorithm mainly used the reflectance values in the red nir and swir bands to calculate the rdri values to extract the ice extent of the river in comparison there are differences in the band sequence settings of different sensors for msi sensor data band 4 red band 8 nir and band 11 swir1 were selected to calculate the rdri values for oli data band 4 red band 5 nir and band 6 swir1 were selected to calculate the rdri values 3 3 analysis of river ice phenology and processes 3 3 1 average of the multiple year river ice period the images of three complete river ice periods 2019 2020 2020 2021 and 2021 2022 were used to analyze the average river ice phenology river ice phenology can be expressed using the appearance dates disappearance dates duration accumulation period and melt period in each river reach the ice appearance date is the time when river ice appears in the selected river reaches the ice disappearance date of river ice is the time when river ice disappears in the selected river reaches in the selected typical river reaches the river ice extent extracted using the rdri algorithm is larger than one pixel then the day is determined to belong to the river ice period for the selected typical river reach the river ice duration is the number of days from the time when river ice appears to the time when it disappears in the selected river reach the river ice accumulation period is from the river ice appearance date to the date when the river ice extent reaches its maximum value in the selected river reach finally the river ice melting period extends from the date when the river ice extent reaches its maximum value to the river ice disappearance date in the selected river reach if the maximum value of the river ice extent remains constant for several weeks or even longer the median time of the period is considered to be the time when the maximum value occurs considering the high temporal resolution of the images in the satellite orbit overlap regions the reliability of the obtained results is within an acceptable range despite the influence of cloud interference and other factors 3 3 2 phenology and process in a representative river ice period the images of a complete ice period in 2019 2020 were selected in those selected river reaches the entire river ice process can be observed using multistage remote sensing images then the pattern of river ice growth and melting can be assessed only one year s worth of data is chosen to better match the remote sensing images with the river ice area data and occurrence frequency maps in the current year these selected river ice freezing and melting patterns are stable without significant changes over 2019 2022 hence the river ice processes from 2019 to 2020 can represent the freezing and melting patterns of river ice in other years due to the limitation of illustration space we select some representative images to show the process of river ice accumulation to melting directly more information on the extent of river ice obtained from other images is presented in the bar chart below for example we can determine when and where river ice began to freeze in each channel whether the river ice starts growing from the edge of the channel to the middle of the channel and the extent of fluctuation in the increase or decrease in the river ice period furthermore we compared the days of the river ice growth process and melting process then we compared the growth rate and the melting rate of river ice at each river reach 4 results 4 1 river ice phenology in multiple years 2019 2022 we used 2019 2022 images to obtain the average river ice period of the selected river reaches fig 3 the average river ice period is the average of the complete river ice period using points in time per year the results indicated that the ice period is usually longer in the higher latitude river reaches and the ice period duration is also influenced by other factors such as channel morphology the c and e river reaches had the longest ice periods and reached 268 days and the g river reach had the shortest ice period at 61 days the average ice period of these river reaches was 181 days because river ice freezing depends on temperature we researched the connection between the river ice period and latitude and elevation the river reaches with high elevations tend to have longer periods because higher elevations are associated with lower temperatures therefore the correlation analysis results showed that the ice period length in the selected reaches had a weak but not significant correlation with elevation these results also suggested that the river ice period was correlated with latitude and elevation however although high latitudes and elevations can provide low temperature conditions they were not the decisive factor because river freezing was also influenced by other factors such as flow velocity and channel shape according to the monitoring results of the above eight representative river reaches there were obvious discrepancies in river ice periods in different areas of the tibetan plateau for example in some high elevation river reaches d e a and c and high latitude river reaches b river ice usually appeared earlier and disappeared later so there were longer ice periods the river ice was usually present in these reaches and the extent of river ice was large therefore the ice period in the cutoff flow river reaches on the tibetan plateau was usually long often starting in october and ending in june or july of the following year the maximum length of the ice period was approximately nine months in contrast river ice appeared later and disappeared earlier in some low elevation reaches h and g and low latitude reaches f as a result the river ice period was relatively short and the extent of the river ice was smaller furthermore these river reaches often correspond to the main channel of large rivers which flow continuously in the cold season therefore the ice period of the mainstream reaches with continuous flow on the tibetan plateau was relatively short the length of this period was approximately 2 3 months usually starting in december and ending in march of the next year there are significant differences in the length of the ice period for tibetan plateau rivers which are affected by the climate topography and river channel characteristics similarly the ice period of 58 lakes on the tibetan plateau from 2000 to 2017 also differed and the average period was 157 78 days cai et al 2019 at present there are no other studies on river ice phenology on the tibetan plateau for comparison 4 2 phenology and process in a complete river ice period 4 2 1 tarim river basin a river reach river reach a is located on the yarkan river in the tarim river basin it is located in the plateau subfrigid arid zone which is a typical high elevation river channel with a cutoff flow in winter this river reach has a large curvature and a wide and shallow river valley its two banks are mountainous the water level does not decrease significantly and the river flow nearly ceases during the ice period we selected 21 representative images to show the process of river ice accumulation to melting directly more information on the extent of the river ice obtained from 51 images was presented in the bar chart below according to the principles of determination introduced in the methods section the results show that during the 2019 2020 ice period in the river reach a river ice first appeared on october 20 2019 and disappeared on june 29 2020 with a total period of 253 days fig 4 the maximum extent of river ice in this river reach appeared on february 9 2020 with a total of 2 5323 km2 the length of this river reach was 7071 m and the maximum width of the river ice was 867 m the river ice type was mainly stable ice sheets the river ice accumulation period lasted 112 days from october 20 2019 to february 9 2020 and the river ice extent gradually increased the river ice melting period lasted 141 days from february 9 2020 to june 29 2020 when river ice slowly began to melt in the thinner river ice areas a comparison between the area of river ice and the mean air temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature in this river reach river ice tended to concentrate in the central area of the channel the occurrence frequency of river ice was low at the edges of the main channel fig 4 the main reason for this phenomenon is that in winter portions of the river become separated and the central area of the channel is more likely to form thicker ice 4 2 2 qaidam river basin b river reach the b river reach is located on the geermu river in the qaidam river basin it is located in the plateau temperate arid zone with broad and flat terrain and features a braided channel with a partial discontinuous flow in winter this river reach is relatively straight and the terrain on both banks is flat the water level drop is small and the riverbed is alternately shallow and deep troughs we selected 20 representative images that directly show the process of river ice accumulation to melting more information on the extent of river ice obtained from 38 images was presented in the bar chart at the bottom during the 2019 2020 ice period in the b river reach river ice first appeared on october 27 2019 and disappeared on april 16 2020 the river ice period lasted 172 days fig 5 the maximum extent of river ice in this river reach appeared on february 11 2020 with a total of 3 3846 km2 the length of this river reach was 3225 m and the maximum width of the river ice was 1413 m the river ice type was mainly stable ice sheets the river ice area showed some fluctuation during the entire river ice period which may be related to fluctuations in temperature and snowfall a comparison between the area of river ice and the mean air temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature usually low temperatures and snowfall promote the accumulation of river ice while high temperatures lead to river ice melting the river ice accumulation period was 107 days from october 27 2019 to february 11 2020 and the river ice extent gradually increased the river ice melting period lasted 65 days from february 11 2020 to april 16 2020 generally river ice began to melt rapidly in the thinner river ice areas the river ice duration of the melting period was significantly shorter than that of the accumulation period river ice in this reach was located in the area of the deep channel but the occurrence frequency of river ice in the central area of the main channel was not necessarily high which was characteristic of the river ice distribution in braided channels fig 5 4 2 3 hexi river basin c river reach the c river reach is located on the shule river in the hexi river basin it is located in the plateau temperate semiarid zone with wide valley terrain and featured a braided channel with a partial discontinuous flow in winter the river reach is straight the terrain on both sides is flat with meadow the water level difference is minimal and the depth is shallow the river width is relatively large and the distribution of river ice is relatively widespread we selected 25 representative images that show the process of river ice accumulation to melting directly more information on the extent of river ice obtained from 64 images was presented in the bar chart below the results showed that in the 2019 2020 ice period river ice first appeared in the c river reach on october 13 2019 and disappeared on july 13 2020 with a river ice period of 284 days fig 6 the maximum extent of river ice appeared on march 4 2020 and reached a total of 10 2204 km2 the length of this river reach was 7018 m and the maximum width of the river ice was 1853 m the river ice type was mainly stable ice sheets the river ice area presented a stable growth trend during the entire accumulation period of river ice there were obvious fluctuations during the melting period which may be related to fluctuations in temperature and snowfall usually low temperatures and snowfall promote the accumulation of river ice while high temperatures lead to river ice melting the river ice accumulation period lasted 143 days from october 13 2019 to march 4 2020 and the river ice extent gradually increased in contrast the river ice melting period lasted 131 days from march 4 2020 to july 13 2020 when river ice began to melt rapidly in areas with thinner river ice the melting period duration of the river ice was slightly shorter than that of the accumulation period the thinner river ice areas may melt faster while the thicker river ice areas may melt more slowly a comparison between the area of river ice and the mean air temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature the occurrence frequency map of river ice showed that river ice tended to appear in the deep area in this river reach the occurrence frequency in the central area of the main channel was not necessarily high which was the distribution characteristic of river ice in braided channels fig 6 4 2 4 inner river basin d river reach the d river reach is located on the jiangai river in the inner river basin it is located in the plateau subfrigid semiarid zone the d river reach is a typical high elevation channel with flat terrain and features no flow in winter this reach of the river is curved and the valley is relatively narrow the terrain on both sides is flat grassland we selected 20 representative images that show the process of river ice accumulation to melting directly more information on the extent of river ice obtained from 49 images was presented in the bar chart below the results showed that in the 2019 2020 ice period river ice first appeared in river reach d on october 13 2019 and disappeared on june 29 2020 and the river ice period lasted 260 days fig 7 the maximum extent of river ice in this reach appeared on march 21 2020 with a total of 4 9255 km2 the length of this river reach was 8093 m and the maximum width of the river ice was 885 m the river ice type was mainly stable ice sheets the river ice accumulation period lasted 160 days from october 13 2019 to march 21 2020 and the river ice extent gradually increased the river ice melting period lasted 100 days from march 21 2020 to june 29 2020 when river ice gradually began to melt in the thinner river ice area the accumulation period of river ice was longer than the melting period in this reach and the fluctuation in river ice extent was obvious the thinner river ice melted faster while the thicker river ice melted more slowly a comparison between the area of river ice and the mean air temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature in this reach river ice tended to appear in the central area of the channel while the occurrence frequency of river ice was low at the edge of the main channel fig 7 4 2 5 yangtze river basin e river reach the e river reach is located on the yangtze river it is located in the plateau subfrigid semiarid zone the e river reach is a typical high elevation braided channel with a discontinuous flow in winter this river reach is wide and shallow and the terrain on both sides of the river is flat with sparse meadow the river reach has a small curvature a small water level drop and a dense interlacing of small channels we selected 20 representative images that show the process of river ice accumulation to melting directly more information on the river ice extent obtained from 50 images was presented in the bar chart below the results showed that during the 2019 2020 ice period river ice first appeared in the e river reach on october 17 2019 and disappeared on july 17 2020 with a river ice period of 274 days fig 8 in this river reach the maximum extent of river ice appeared on march 27 2020 with a total of 4 4899 km2 the length of this river reach was 5071 m and the maximum width of the river ice was 1557 m the river ice type was mainly stable ice sheets the river ice accumulation period lasted 162 days from october 17 2019 to march 27 2020 and the river ice extent gradually increased the river ice melting period lasted 112 days from march 27 2020 to july 17 2020 when river ice gradually began to melt in areas with thinner river ice the thinner river ice melted faster while the thicker river ice melted more slowly thus the river ice initially appeared in a discrete state with the gradual accumulation of river ice into a single entity the river ice disintegrated into a discrete state as the temperature rose and then gradually melted a comparison between the area of river ice and the mean air temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature in this reach river ice tended to appear in the central area of the channel while the occurrence frequency of river ice was low at the edges of the main channel fig 8 4 2 6 yellow river basin f river reach the f river reach is located on the yellow river it is located in the plateau subfrigid subhumid zone with canyon terrain it is the main channel of a large river and has continuous flow year round with a high flow rate this river reach is at a river bend in a deep valley area with a small water level drop the length of this river reach is 3402 m and the width of the river channel is 219 m the river ice type is mainly shore ice we selected ten representative images that show the process of river ice accumulation to melting directly more information on the extent of river ice obtained from 24 images was presented in the bar chart below the results showed that during the 2019 2020 ice period river ice first appeared in the f river reach on december 4 2019 and disappeared on february 29 2020 the river ice period was relatively short 85 days and only a small amount of river ice developed at the riverbank edge fig 9 the maximum extent of river ice in this reach was 0 0253 km2 on december 29 2020 the river ice accumulation period was 25 days from december 4 2019 to december 29 2020 river ice gradually appeared at the riverbank edge and its extent gradually increased the river ice melting period lasted 60 days from december 29 2020 to february 29 2020 the river ice at the riverbank edge gradually began to melt a comparison between the area of river ice and the mean temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature in general such channels do not easily freeze because of large discharge and fast velocity and river ice appears only in slow flow areas along the margins 4 2 7 brahmaputra river basin g river reach the g river reach is located on the brahmaputra river in the brahmaputra river basin and is located in the plateau temperate semiarid zone it is the most typical braided channel on the plateau with numerous and dense channels and river ice appeared only in some channels with a slow flow in winter the length of this river reach is 13510 m and the width of the main river channel is 2654 m the river ice type was mainly stable ice sheets and shore ice this river reach is relatively straight broad and shallow and is located in a high mountain valley there is a small drop in water level but sufficient flow we selected 14 representative images that show the process of river ice accumulation to melting directly more information on the extent of river ice obtained from 21 images was presented in the bar chart below the results showed that in the 2019 2020 ice period river ice first appeared in the g river reach on december 11 2019 and disappeared on february 14 2020 with a river ice period of 65 days fig 10 the maximum extent of river ice in this reach appeared on december 31 2020 with a total area of 0 2697 km2 the river ice accumulation period lasted for 20 days from december 11 2019 to december 31 2020 and the river ice extent gradually increased the river ice melting period lasted 45 days from december 31 2020 to february 14 2020 with the river ice gradually melting the accumulation duration of river ice was shorter than the melting duration a comparison between the area of river ice and the mean temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature in comparison river ice was poorly developed in this reach 4 2 8 mekong river basin h river reach the h river reach is located on the mekong river in the mekong river basin and is located in the plateau temperate semihumid zone it is also a typical braided channel on the plateau with continuous flow in winter and river ice forms only in distributary channels with low velocities the length of this river reach is 4205 m and the width of the main river channel is 147 m the river ice type is mainly stable ice sheets and shore ice this river reach is relatively curved and shallow and is located in a wide valley of high mountains the river channel is scattered but the flow is relatively abundant the type of river ice studied in this section is ice sheets we selected ten representative images that show the process of river ice accumulation to melting directly more information on the extent of river ice obtained from 23 images was presented in the bar chart below in the 2019 to 2020 ice period river ice first appeared in the h river reach on december 5 2019 and disappeared on march 5 2020 with a river ice period of 91 days fig 11 the maximum extent of river ice in this river reach appeared on december 30 2020 reaching 0 0794 km2 the river ice accumulation period was 25 days from december 5 2019 to december 30 2019 and the river ice appeared and expanded gradually the river ice melting period was 66 days from december 30 2019 to march 5 2020 when river ice slowly began to melt in areas with thinner river ice thus the melting period of river ice was shorter than the accumulation period a comparison between the area of river ice and the mean temperature shows that the river ice appeared as the temperature decreased and then gradually melted as the temperature increased however there was no significant correlation between the river ice area and the mean air temperature river ice did not develop in this reach and the river ice occurrence frequency map showed that river ice occurred only in some channels with low velocities 4 2 9 accumulation period and melting period in the above river reaches the melting period was shorter than the accumulation period in some reaches whereas the melting period was longer than the accumulation period in other river reaches in the a f g and h river reaches the river ice accumulation period 112 days 25 days 20 days and 25 days respectively was shorter than the river ice melting period 141 days 60 days 45 days and 66 days respectively in the b c d and e river reaches the river ice accumulation period 107 days 143 days 160 days and 162 days respectively was longer than the river ice melting period 65 days 131 days 100 days and 112 days respectively among them the f g and h river reaches were non cutoff flow river reaches and the accumulation period of river ice in these reaches tended to be shorter moreover the ice period in these reaches was shorter the river ice was thinner the temperature in the river ice melting period was still relatively low and the river ice melting was slow the melting period of river ice was usually shorter than the accumulation period in the b c d and e river reaches the river ice increases in months with lower temperatures and the river ice rapidly melts when the temperature increases significantly among the above river reaches the a river reach was an exception which may be related to the formation of highly thick ice in local areas which prolonged the melting period of this river reach li et al 2020a in this river reach the channel width of the river was relatively narrow and curved and thicker ice usually formed 5 discussion 5 1 advantages of overlapping orbit imagery the use of medium and high spatial resolution satellite images with orbital overlap has significant advantages in monitoring river ice in the plateau region first the high spatial resolution of the remote sensing images makes it possible to extract the river ice extent of small rivers on the plateau notably the number of small rivers is significantly greater than that of large rivers in this plateau region second the images in the overlapping area also have a high temporal resolution providing large amounts of information for river ice phenology monitoring which supports the study of plateau river ice the combination of the two sentinel 2 satellites and the landsat 8 satellite can provide an image every two days 1 91 in addition plateau rivers have unique characteristics such as various river channel types complex terrain and complex river ice forms previous studies on river ice phenology have mainly focused on large rivers using modis and other low spatial resolution data cooley and pavelsky 2016 muhammad et al 2016 pavelsky and smith 2004 these data tend to have high temporal resolutions and can obtain abundant information on river ice processes the high spatial resolution overlap images significantly expand the range of river ice that can be monitored remotely this research first determined the river ice phenology and process on the tibetan plateau using remote sensing this study provides new findings on river ice on this plateau 5 2 river ice phenology on the tibetan plateau 5 2 1 river ice period the ice duration periods in different river reaches of the tibetan plateau have apparent differences ranging from 55 to 277 days the monitoring results of the selected river reaches in 2019 2020 show that the river ice basically presents gradual accumulation and then gradual melting and the river ice area does not remain stable for a long period of time the influence of temperature on the length of the river ice period was relatively clear in the selected river reaches the river ice period in high latitude and high elevation areas was relatively long because the temperature is usually low in these areas however these two factors were not significantly correlated with the river period length because the formation of river ice was also impacted by other factors such as the speed of the river and the shape of the channel prowse et al 2007 similarly there are also spatial differences in ice duration in other regions outside of the tibetan plateau for example the yellow river in inner mongolia generally starts to freeze in mid to late november and thaw in mid to late march of the following year li et al 2016 the number of frozen days is generally approximately 100 days and the longest is more than 130 days ice started to form on the urumqi river in mid november to early december and started to melt in mid april to late may in 1985 1992 zhang 1992 in the songhua river basin from 2010 to 2015 the average appearance date of river ice was november 7 and the average disappearance date was april 15 yang et al 2020a in addition the river ice duration has decreased in the arctic region vuglinsky and valatin 2018 moreover there are still differences in ice periods in this region because of the influences of latitude and other factors pavelsky and smith 2004 prowse et al 2007 previous studies of river ice primarily focused on the date when rivers began to form and breakup because these aspects are correlated to navigation flooding and climate warming prowse et al 2007 shiklomanov and lammers 2014 on the tibetan plateau where there are few people and climate changes are significant researchers have focused on the effect of river ice on the cryosphere and its response to climate therefore research on the river ice accumulation and melting periods is significant for river ice hydrology and cold region hydrologic models li et al 2020b however insufficient remote sensing data still limit the study of the changes in river ice accumulation and melting periods on the tibetan plateau 5 2 2 river ice processes the river ice process has unique patterns and the flows of some rivers are cut off in winter during the accumulation period the river ice usually starts to freeze in the center of the channel and gradually extends to the edge of the river channel during the melting period river ice usually starts to melt from the margins of the channel and gradually expands to the center of the river channel figs 2 3 4 this phenomenon is due to the low flow of rivers on the tibetan plateau in winter and flow occurs only in the center of the river li et al 2020b the river water flow is obstructed when the river ice forms the river water gradually flows to the edge of the river channel and then freezes on the margins of the river and forms river ice it is difficult to freeze the water in the river reaches with fast flows the river reaches with no ice period often have high discharge and are usually located in the mainstream of the river or in narrow channels with canyon terrain however the river freezing process of channels with continuous flow in winter is opposite to that of channels with discontinuous flow river ice forms from the river edges to the center during the accumulation period and melts from the center to the edges during the melting period fig 7 this phenomenon is related to the high discharge and fast velocity in the central river channel therefore the process of river ice formation is affected by the channel type better characterization of river ice processes on the tibetan plateau needs to be combined with hydrological models since remote sensing data are only instantaneous observations li et al 2020b lindenschmidt 2017 in particular river ice models and more frequent observations are needed to monitor and study river ice jams shen 2010 identifying the influence of river ice processes on river runoff processes in the tibetan plateau is crucial to the scientific use of water resources in the arid zone downstream of rivers in this region 5 3 applications limitations and challenges the high spatial and temporal resolution of remote sensing imagery can directly show river ice accumulation and melting processes on the tibetan plateau in addition this imagery can be used to determine the river ice phenology in regions with overlapping imagery this research obtained features of the river ice phenology and processes in different types of river channels on the tibetan plateau it is a common phenomenon that river ice increases in months with lower temperatures and rapidly melts when the temperature increases significantly this study is the first to reveal the specific time of the appearance and disappearance of river ice using remote sensing in some river reaches on the tibetan plateau in addition this study displayed the whole process of river ice development and determined the differences in river ice periods and patterns in different river reaches this study enhances the understanding of the river ice processes and supports the progress of hydrological models clarifying the river ice impact on the river discharge process is vital for future research on downstream water resource utilization although this study focuses on river ice on the tibetan plateau its research methods are applicable to north america the arctic circle and other regions and can significantly enhance the monitoring of river ice in some small and medium sized rivers the restrictions of this research are related to imagery temporal resolutions cloud disturbances and snow disturbances specifically the temporal resolution of the images used can introduce some errors which may influence the identification of the accumulation and melting periods cloud disturbances which are a source of error also influence the use of optical images li et al 2020b in this study the dates of river ice appearance maximum extent and disappearance were all inferred from the satellite images obtained and there may be some errors with the actual dates due to these remote sensing data coverage limitations it is impossible to monitor the entire river ice process in the whole basin the short operation time of sentinel 2 limited the acquisition of long time series images which limited the study of multi year river ice phenology in addition we extracted the river ice distribution extent using the rdri algorithm which can distinguish between river ice and snow river ice may be missed because of thick snow cover when using the rdri algorithm this occurrence frequency influences the river ice period investigation hence we did not choose the river reach at higher elevations that are covered with snow all year round and we did not use images with significant snow cover in this study this study revealed the river ice processes and phenology on the tibetan plateau by selecting typical river reaches which were not necessarily representative of the river ice processes at a large scale or watershed scale furthermore due to the limited availability of river discharge data the relationship between river discharge and river ice processes could not be analyzed we have added the temperature information of the river reach but the era5 has a resolution of 30 km hence an accurate description of the temperature of the valley in the plateau region may be insufficient as the weather in the plateau valley area is complicated and changeable in addition the ice period duration of the whole river may be different and the ice period durations of different river reaches may also vary as they are influenced by local environmental factors flow hydraulics and bed morphology however due to the lack of observational data on river morphology hydraulics and other factors it is impossible to perform a quantitative analysis of multi factor influencing on the ice period to further study river ice processes we need to enhance ground observations of river ice in the future for example unattended observation cameras could be established in some typical river sections to observe the whole process of river ice in real time river ice observation data are relatively abundant in northeastern china yang et al 2020a investigated the temporal and spatial changes in river ice thickness and phenology at the songhua river based on the 156 hydrological station records unfortunately the scarcity of river ice observations on the tibetan plateau hinders related research in addition we need to study the river ice model suitable for the tibetan plateau to better understand better the hydrological process and function of river ice li et al 2020a more attention and technical means are needed to study the river ice of this plateau including the use of drone monitoring and wireless cameras 6 conclusions this research was the first to determine river ice phenology and river ice processes on the tibetan plateau in detail there are apparent differences in the river ice periods on the tibetan plateau the overlapping orbit imagery of the sentinel 2 and landsat 8 satellites provide a sufficiently high temporal resolution to significantly improve research on river ice phenology generally the river reaches with longer ice periods tend to have flows that cut off during the ice period while river reaches with shorter ice periods do not the ice period for river reaches with long ice periods starts in october and ends in june or july of the following year for the river reaches with a short river ice period the river ice period begins in december and ends in february or march of the following year furthermore the melting period of river ice is usually shorter than the accumulation period for rivers in high elevation and high latitude regions the length of the river ice duration is also affected by river velocity and channel shape moreover the river ice process in reaches with a flow cutoff differs from that in reaches with no flow cutoff in river reaches where the flow cuts off in winter the river ice usually freezes from the middle of the channel and then the melting advances from the edge to the middle in contrast in large rivers in which the flow does not cut off in winter the freezing of river ice usually starts from the riverbank and gradually advances to the center of the river melting begins from the center and gradually migrates to the riverbank in a typical braided river reach on the plateau the water usually freezes in a small channel with low velocity and then the ice spreads to other small channels this study is the first to provide information on the phenology and process of river ice using remote sensing imagery on the tibetan plateau which supports river ice research on this plateau and other regions credit authorship contribution statement haojie li writing original draft methodology software data curation writing review editing hongyi li conceptualization supervision writing review editing jian wang conceptualization supervision xiaohua hao conceptualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the national natural science foundation of china grant no 42261027 and 42171391 the gansu provincial natural science foundation grant no 22jr5ra142 and the open foundation from national cryosphere desert data center grant no 2021kf10 supported this research 
2112,groundwater contamination is a major problem and it can be contaminated by natural or manmade activities contaminant sources cannot be identified promptly after a contamination event due to slow groundwater movement in aquifers to limit the further spread of the plume and to take appropriate remedial measures it is essential to determine the release rates associated with source locations as soon as a contaminant is detected in one of the observation wells in the aquifer conventional techniques for contaminant source identification such as the simulation optimization so uses a simulation model which is based on estimated or measured hydrogeological parameters for replicating the aquifer response to contamination at source locations however the associated intrinsic uncertainty in the parameters can affect the estimated release histories at the source locations to assess confidence in the results it is important to consider stochasticity in the hydrogeological parameters for contaminant release history estimation requiring numerous runs of the so model for corresponding breakthrough curves the present study proposes a novel surrogate simulation optimization sso framework which utilizes an encoder decoder long short term memory ed lstm based surrogate model along with multiverse optimization mvo for contaminant source identification the comparison of ed lstm with other surrogate models shows its better accuracy and significantly low computational time requirement compared to the simulation model to enhance the computational efficiency further the sso model is embedded in a parallel workflow for the quantification of uncertainty associated with the inverse modelling the study shows that the proposed workflow can be efficiently used for uncertainty quantification in contaminant source identification due to stochastic parameters with a reduced computational cost keywords contaminant source identification uncertainty quantification surrogate modelling encoder decoder model long short term memory lstm parallel computing data availability data will be made available on request 1 introduction contamination in groundwater occurs due to sources present underneath the ground level or above it through deliberate or accidental spills batu 2005 if contaminants present are hazardous they may pose a widespread risk to the groundwater systems therefore information regarding the release of contamination from the source location s is essential to containing the contamination plume through remediation strategies however the time interval between the detection of contamination in the observation points of the aquifer and its release at the source location s can be high due to the sluggish transport process this can cause an absence of source information in practical cases which can lead to reduced efficiency in aquifer remediation or high remediation costs ayvaz 2010 retrieval of release histories at source locations is achieved using various approaches out of which simulation optimization so is widely implemented borah and bhattacharjya 2016 gurarslan and karahan 2015 jha and datta 2013 singh et al 2018 singh and datta 2004 singh and datta 2006 the so approach uses an optimization model which utilizes a simulation model to replicate the hydrogeological response of the aquifer for different solution candidates however simulation models require parameterization of flow and transport equations the estimation of which is challenging due to the spatial heterogeneity of soil hydraulic properties and scarcity of data goyal et al 2023 due to this the study area is often discretized into several zones having different hydrogeological characteristics in the simulation model huang and yeh 2016 this leads to parametric uncertainty due to model simplifications ye et al 2010 under such conditions the identified contamination release rates at the source location using inverse modelling also become uncertain cao et al 2019 studied the impact of uncertainty due to different zonation structures in the model on contaminant source identification using modflow harbaugh 2005 and a sampling algorithm named polychord srivastava and singh 2015 developed an artificial neural networks ann based inverse model to evaluate uncertainty in source identification due to uncertainties in the parametrization of flow transport and boundary conditions by utilizing breakthrough curves as inputs and aquifer parameters as outputs however this approach may not be suitable for complex problems due to the non uniqueness of breakthrough curves which are dependent on hydrogeological parameters sun 2013 moreover the direct implementation of the simulation model in the so approach is computationally expensive due to the requirement of solving the partial differential equations representing the groundwater flow and transport process therefore recently several surrogate modelling strategies are being developed for the reduction of computational cost in the contaminant source identification problem for the inverse modelling problem in consideration the surrogate model is required to approximate the concentration profiles at the observation wells using the release intensities at the source locations the surrogate modelling approaches in the literature are generally based on linearization through a response matrix gorelick et al 1983 singh et al 2018 machine learning zhao et al 2020 and kriging based hou and lu 2018 zhao et al 2016 although these models reduce the computational cost significantly most of them use a vector representation of inputs and outputs this approach doesn t facilitate the training process using the existent temporal dependency anshuman and eldho 2022a recently deep learning based approaches based on convolutional neural networks cnns and long short term memory networks lstm have been used for contaminant source identification mo et al 2019 zhou and tartakovsky 2021 subsurface characterization mo et al 2020 zhang et al 2020 reconstruction of missing data in groundwater vu et al 2021 and groundwater level prediction wunsch et al 2021 cnns are particularly designed for analysing image data and it applied for image to image regression by considering source information and contaminant movement in different timesteps in input and output respectively mo et al 2019 zhou and tartakovsky 2021 on the other hand lstm is a type of recurrent neural network rnn which is popularly used to learn time series data in this the input data is provided to the neural network sequentially compared to conventional rnns lstms handle the issue of exploding and vanishing gradients better hochreiter and schmidhuber 1997 nevertheless a single lstm network is suitable for output consisting of fewer time steps in the current problem the surrogate model is required to transform the release rates at source sites into concentration measurements at observation wells generally in release history estimation problems the entire contaminant release period is divided into stress periods during which release rates are assumed to be constant therefore there can be a high difference in the number of time steps of input and output data for the current problem considering the presence of time series data at both inputs and outputs sequence to sequence seq2seq learning using encoder decoder lstm ed lstm kao et al 2020 xiang et al 2020 is better suited to the current study ed lstm which utilizes two lstm networks to transform the input time series data to the output the first lstm encodes the release history information into hidden states which are deciphered by the second lstm the present study aims to quantify the uncertainty in release history estimation due to uncertainty in hydrogeological parameters as optimization plays a crucial role due to the highly complex search space caused by the ill posedness of the problem zhao et al 2020 a recently proposed stochastic population based heuristic optimization algorithm named multiverse optimization mvo mirjalili et al 2016 is used for analysis owing to its good accuracy anshuman and eldho 2022a based on this a novel surrogate simulation optimization sso framework using ed lstm and mvo is proposed in a parallelized workflow for uncertainty quantification of estimated release histories at different source locations for the problem considered the release rates are obtained for the multiple breakthrough curves which are subject to stochastic hydrogeological parameters hence the parallel workflow further improves computational efficiency by simultaneously undertaking several optimization jobs the ed lstm mvo sso model is applied to a highly heterogeneous aquifer in a case study further the sso model is applied to a field type aquifer with seasonally varying groundwater flow caused by different water fluxes in a parallel workflow 2 methodology 2 1 governing equations the flow and transport phenomena in groundwater are governed by a set of partial differential equations pdes which represent the governing equations along with the applicable dirichlet or neumann boundary conditions the governing equations for unsteady state groundwater flow in an unconfined aquifer and contaminant transport in an ith dimensional problem domain are used to estimate the state variables hydraulic head h and contaminant concentration c in the problem domain these are given by 1 s y h t x i κ x i h h x i q 2 c t x i d x i x j c x j x i v x i c λ c q c here x i represents the direction in ith dimension the terms κ x i s y q d x i x j v x i λ and qc are hydraulic conductivity specific yield source sink dispersion coefficient darcy s velocity first order decay rate and sink term related to contaminant release respectively in the coupled flow and transport model the v x i is estimated using eq 3 and d x i x j is estimated using longitudinal and transverse dispersivity terms i e α l and α t as shown in eq 4 3 v x i κ x i η e h x i 4 d x i x j α l v x i α t v x j α l 2 α t 2 2 2 simulation model the meshless radial point collocation method rpcm model is used for the numerical simulation by solving eqs 1 and 2 respectively the solutions to these equations using rpcm are explained in anshuman and eldho 2020 the rpcm model is verified against various analytical semi analytical solutions and popularly used models such as modflow mt3dms and rt3d anshuman and eldho 2020 anshuman and eldho 2022b in the current inverse modelling problem the contaminant release history qc is required to be estimated using the breakthrough curves at the observation wells hence the coupled flow and transport model f can be represented as in eq 5 5 c obs f θ k θ t q q c here c obs are breakthrough curves at the observation wells the terms θ k κ x i s y and θ t α l α t v x i λ are model parameters for groundwater flow and transport respectively for the current problem all parameters except qc are either known or estimated using observations or inverse modelling the estimated parameters related to groundwater flow and transport are referred to as reference parameters i e θ in uncertainty quantification 2 3 encoder decoder long short term memory networks ed lstm encoder decoder long short term memory networks ed lstm is a type of neural network architecture which is used for sequence to sequence seq2seq learning in this architecture two long short term memory networks lstm are employed as an encoder and a decoder respectively lstm is a recurrent neural network rnn which is designed to learn the temporal dependency in the data by effectively handling the vanishing and exploding gradients issues that occur in primitive rnns the key components of lstm comprise three gates namely the input gate output gate and forget gate for a timestep t the input output and forget gates are represented as seen in eqs 6 8 6 g i t σ w 1 i i t w 2 i h t 1 b i 7 g o t σ w 1 o i t w 2 o h t 1 b o 8 g f t σ w 1 f i t w 2 f h t 1 b f here g i t g o t and g f t are sigmoid activations of weighted inputs i and hidden states h along with respective biases for input output and forget gates i e b i b o and b f the subscripts 1 and 2 represent the weights w corresponding to inputs i and hidden states h respectively similarly the subscripts i o and f stand for input output and forget gates respectively the hidden state at each time step is evaluated using the cell state ct as shown in eq 9 which is a function of the cell state at the previous time step c t and antecedent c t see eqs 10 and 11 9 h t o t θ tanh c t 10 c t f t θ c t 1 i t θ c t 11 c t t a n h w 1 c i t w 2 c h t 1 b c for the development of a surrogate model for contaminant source identification in groundwater the relationship between the multivariate sequences of input and output data which represent contamination release rates at the possible source locations and measurements at observation wells respectively is required to be learnt the sequences corresponding to input and output data are of lengths n st and n ot respectively where n st represents the number of stress periods and n ot represents the number of observation timesteps in seq2seq learning using encoder decoder lstm ed lstm the encoder lstm transforms the input data into vectors of hidden state h n st and cell state c n st as shown in fig 1 these vectors are subsequently used to initiate the decoder lstm which outputs a decoded hidden state h n ot and cell state c n ot the decoded hidden state h n ot is then converted to the output i e breakthrough curves at the observation points using the fully connected layer as shown in fig 1 it may be noted that a proxy layer consisting of a zero vector is provided as input for the decoder lstm which essentially denotes that the output sequence is generated using the encoded hidden states from the encoder only in most of the studies related to contaminant source identification the number of stress periods considered which represent the time period with constant release intensity from the source locations is lesser than the number of timesteps of breakthrough curves therefore learning the temporal dependency is important for developing an accurate surrogate model which is achieved through ed lstm in the current study in contrast the surrogate models based on support vector regression svr feed forward neural networks ffnn kriging etc proposed in previous studies use vectorized inputs and outputs which doesn t facilitate learning the sequential information 2 4 multiverse optimizer optimization algorithms are of prime importance in an sso framework in a stochastic population based algorithm the feasible solutions are explored in a multidimensional search space which may have more than one local optima the algorithm tries to arrive at the global optimum solution by improving the candidate solution at every iteration multiverse optimization mvo is a recently proposed algorithm which is loosely based on the multiverse theory in physics mirjalili et al 2016 the candidates for solutions to the decision variables are referred to as universes in mvo through white holes black holes and wormholes these universes exchange elements any object within a black hole s gravitational field can be devoured by it contrary to that white holes eject huge amounts of matter into space eardley 1974 wormholes are theorized to connect different areas of space time as well as the multiverse morris and thorne 1988 in mvo a white hole is present in the best universe while black holes are present in all other universes mirjalili et al 2016 through a roulette wheel mechanism elements from a white hole universe are exchanged with those from other universes each universe in the multiverse has a proportional inflation rate determined by its objective function as a result of each iteration the universe with the best inflation rate is selected as the best solution using the principles detailed in mirjalili et al 2016 the search space in the universe is explored and exploited by using white holes black holes and wormholes eq 12 explains how local changes in universes are represented mathematically by wormholes 12 x i j x best j t d r u b j l b j r 4 l b j i f r 3 0 5 x best j t d r u b j l b j r 4 l b j o t h e r w i s e x i j o t h e r w i s e i f r 2 w e p where x best j u b j and l b j represent the jth variable of the best universe upper bound and lower bounds of the jth variable respectively the terms r 2 r 3 and r 4 denote random numbers in 0 1 tdr and wep represent the travelling distance rate and wormhole existence probability respectively which depend on iteration number t and maximum iteration number t max as provided in eqs 13 and 14 the maximum and minimum values of wep are set as 1 and 0 2 mirjalili et al 2016 13 tdr 1 t t max 1 6 14 we p t wep min t wep max w e p min t max 2 5 objective function using aquifer hydrogeology and contaminant observations at observation points the surrogate simulation optimization sso model estimates the contaminant release history at the source locations this inverse modelling problem is solved by optimizing the release history data in a manner that minimizes the difference between the observed and simulated breakthrough curves at the observation wells mathematically the objective function for the problem can be represented by eqs 15 and 16 15 min 1 n obs i 1 n obs j 1 n st c ij obs c ij sim 2 16 s u b j e c t t o q l q c n q u n 1 n s c sim f q c in eqs 15 and 16 observed and ed lstm simulated concentrations at the observation points are denoted by c obs and c sim respectively the number of observation wells and stress periods are specified by n obs and n st respectively the concentrations at the observation points csim are obtained using contamination strength qc at the n s source points simulated by the surrogate model f at the observation points 2 6 uncertainty quantification using sso in a parallel workflow in uncertainty quantification the sso model is required to be run multiple times based on the number of realizations of the breakthrough curves at the observation wells these realizations are obtained through monte carlo simulations using stochastic hydrogeological parameters through the simulation model for further enhancement of the computational efficiency the sso model is run in a parallel workflow as shown in fig 2 which allocates each processor an optimization job as explained in section 2 4 it may be noted that the number of such jobs is dependent on the number of realizations considered these jobs are provided to a process pool first which then allocates them to a pool of workers each worker performs an optimization job and returns the results to a designated storage location each job is accomplished asynchronously i e the workers don t block the other workers which are working in parallel till all the results are obtained instead each worker immediately returns a retrievable object which is stored in memory after the completion of its job and starts the subsequent job from the process pool with the available processor it may be noted that a sync manager is also provided to the process pool which assists in maintaining the order of the results obtained which may be otherwise affected due to the use of asynchronous computation 3 problem statement and numerical simulation 3 1 case study 1 here a highly heterogeneous aquifer is considered for demonstrating the efficacy of the ed lstm surrogate model this unconfined aquifer of 600 m 300 m with dirichlet boundary conditions at the west and east boundaries with head values of 10 m and 7 m respectively the north and south boundaries apply to no flow boundary conditions the heterogeneous hydraulic conductivity field of the aquifer as shown in fig 3 a is generated using gaussian inversion as per anshuman and eldho 2022b the longitudinal α l and transverse α t dispersivities are 10 m and 1 m respectively as shown in the fig 3 there are 3 potential sources of contamination in aquifer i e s1 s2 and s3 through which contaminant enters the groundwater the contaminant is represented as total dissolved solids tds which are measured at four observation wells i e ob1 ob2 ob3 and ob4 to simulate the flow and transport in the aquifer the rpcm model as presented in section 2 2 is run for 8 years simulation period with a timestep of 10 days utilizing a nodal distribution as shown in fig 3b the contamination period is divided into 3 stress periods of one year each the breakthrough curves at the observation wells as seen in fig 4 d are obtained using release histories at the sources presented in table 1 the concentration contours after 8 years simulation period are presented in fig 4c the developed rpcm simulation model is used for the generation of samples to facilitate training of the ed lstm surrogate model the trained ed lstm model is further used as a surrogate model in the sso framework to estimate the release histories at the source locations 3 2 case study 2 for quantification of uncertainty in release history estimation due to hydrogeological uncertainty a heterogeneous unconfined aquifer see fig 5 a similar to a field type aquifer majumder and eldho 2017 is considered here as seen in fig 5a there is a river that follows along the west boundary which enforces the dirichlet boundary condition the southern boundary is no flux boundary whereas a small flux enters through the eastern boundary the aquifer is also recharged by a pond which is estimated as 6 5 10 3 m d as shown in fig 5a further groundwater is extracted from the aquifer from two pumping locations for the usage of the population hence the water balance of the aquifer is mainly influenced by the recharge rate from the pond extraction rates of pumping and flux from the eastern boundary and water level of the river the total aquifer area of 29 13 km2 is divided into three distinct zones the reference zonal hydrogeological parameters θ are presented in table 2 the head variation throughout the aquifer is obtained by the rpcm model for 15 years with a time step of 10 days steady state head distribution is assumed as the initial condition for the flow problem majumder and eldho 2017 the details of rpcm model parameters used for simulation are described in anshuman and eldho 2022 for steady state simulation the recharge from the pond and incoming flux from the east boundary and river head are taken as 0 015 m d 0 012 m d and 720 m respectively to simulate the transient head variation in the aquifer these entities are varied as shown in fig 6 it may be noted that these monthly values are considered to be the same for the entire simulation period as seen in fig 6 the aquifer is recharged between may october due to the precipitation occurring in the form of rainfall resulting in recharge through the pond and incoming flux through the eastern boundary extraction rates from the pumps gradually decrease with the commencement of the rainy season when water demand is compensated from river discharge and it gradually increases afterwards the head contours at different time steps are presented in fig 7 there are four contamination sources s1 s2 s3 and s4 in the aquifer as shown in fig 5b which injects tritium half life 12 32 years into the aquifer for 4 years a total of 5 stress periods each of 1 year are considered for the case study the source strengths in different source periods are given in table 3 which are required to be estimated hence the total number of unknowns to be estimated is 20 4 source locations 5 stress periods for this case study the uncertainties in estimated release histories at the source location are evaluated for stochastic hydrogeological parameters as mentioned in section 2 6 this is performed by running the sso model using realizations of breakthrough curves obtained through monte carlo simulations using stochastic flow and transport parameters i e θ k and θ t in this study 100 realizations are obtained for each of the 3 cases in the first and second cases parameters θ k and θ t are considered to be stochastic respectively all parameters θ θ k θ t are considered to be stochastic in the third case these parameters are drawn from uniform normal sampling using mean values are corresponding reference parameters θ and the standard deviation is given by 17 θ n θ σ θ here θ and n are the estimated stochastic parameters and normal distribution respectively the standard deviation σ θ is considered 0 05 θ the distributions of these parameters are shown in fig 8 the realizations for the observed concentrations c obs for different cases are presented in fig 9 these realizations are used in the computation of the objective function as described in section 2 5 it may be noted that the breakthrough curves can also be affected due to uncertainty in the groundwater fluxes which influence the water balance however in the current study only the impact of uncertainty of hydrogeological parameters is considered for analysis 3 3 model development steps the steps involved in the development of the surrogate simulation optimization model are given as follows 1 data pre processing the input and output data for ed lstm training comprise contamination strengths at the source and observed contaminant data at the observation points respectively at different time steps as simulated by the simulation model the contamination strengths are generated using uniform random sampling out of the 2000 samples generated 75 are considered training samples whereas 25 are considered testing samples for both case studies 1 and 2 the time required for sample generation is 2 56 h and 3 38 h for case studies 1 and 2 respectively these data are normalized using max min normalization the input and output data are arranged in the form of tensors of shape n samples n st n s and n samples n ot n obs here n samples n st n s n ot and n obs are the number of generated samples stress periods sources observation timesteps and observation points respectively it may be noted that during sample generation the aquifer hydrogeological data are set to reference parameters θ as provided in table 2 for case study 2 2 ed lstm model development pytorch paszke et al 2019 is used for developing the ed lstm model the input data is encoded by the encoder lstm to h n st and c n st as mentioned in section 2 2 the decoder lstm utilizes the hidden states h n st as the initial hidden state and takes a proxy matrix containing zero values of similar shape as input data the hidden state after the last timestep in the decoder lstm i e h n ot is further passed through a dense layer with linear activation to provide output it may be noted that since this output is normalized it is required to be scaled up using the inverse of the max min transformation used in the previous step to provide the final output 3 training gradient descent is used to train the ed lstm model based on the adaptive moment estimation algorithm kingma and ba 2014 the trainable model parameters weights and biases are optimized to minimize mean squared errors mse between the training data and predicted data the training of the ed lstm model is accomplished with 2000 epochs in approximately 0 44 h and 0 4 h for case studies 1 and 2 respectively a graphical processing unit gpu is used during the training of the ed lstm model to reduce the computational effort for this the developed ed lstm model and samples are mapped to the gpu 4 ed lstm mvo sso model development the trained ed lstm model is further used for prediction for which the input data is required to be normalized and arranged in 1 n st n s form the model is embedded within the mvo algorithm for the development of the sso model mvo initiates the population within the upper and lower bounds predictions of concentrations at observation wells are based on the normalized population which represents the release histories at source locations iteratively these predictions are used to minimize the objective function at each iteration the best solution is updated the release histories are obtained from the ed lstm mvo model after satisfying the stopping criteria it may be noted that for case study 1 the release history estimation problem is deterministic using the hydrogeological parameters listed in section 3 1 therefore the subsequent steps apply to uncertainty quantification which is done for case study 2 5 generation of realizations of breakthrough curves for quantification of uncertainty the sso model is run considering the stochastic distribution of hydrogeological parameters as shown in fig 8 to evaluate respective impacts on the uncertainty three sets of breakthrough curves are generated as mentioned in section 3 2 the first and second sets are obtained using stochastic flow and transport parameters respectively while in the third set both flow and transport parameters are considered stochastic 6 uncertainty quantification the ed lstm mvo model developed is used for the estimation of release rates for different breakthrough curve realizations in a non parallel or series workflow these realizations are considered sequentially for the inverse modelling using the sso model using the parallel workflow described in section 2 5 more than one optimization job is performed in a multi processor system it may be noted that the parallel processing unit necessitates the ed lstm model and inputs to be mapped to the cpu hence the gpu mapped ed lstm model and inputs are converted to cpu arrays using pytorch paszke et al 2019 the optimization jobs are handled by the processing pool using workers who undertake the jobs asynchronously as mentioned in section 2 5 the computations are performed on a system with an intel i7 6700 processor consisting of 8 cores at 3 4 ghz and 16 gb ram the multiprocessing module from python 3 7 9 is used for parallel processing the retrievable outputs i e release histories are compiled by the sync manager and provided after the completion of stopping criteria for all optimization jobs corresponding to the breakthrough curves the methodology for uncertainty quantification is provided in fig 10 4 result and discussion 4 1 ed lstm model training and performance comparison for training of the ed lstm model the sample data is generated using simulation model outputs obtained considering randomly generated input data for contamination release at source locations it may be noted that the reference hydrogeological parameters θ are used in the simulation model for a generation of the sample data which is arranged in three dimensional arrays of input and output data as mentioned in section 3 3 the ed lstm model for both case studies was trained for 5000 epochs the mse for training and testing after training were 2 2 10 7 and 3 1 10 7 for case study 1 respectively similarly these values are 1 3 10 7 and 2 1 10 7 for case study 2 respectively the performance of the ed lstm model is compared with different surrogate models such as extreme machine learning eml zhao et al 2020 multilayer perceptron mlp singh and datta 2004 and support vector regression svr pan et al 2021 xing et al 2019 mlp is a feed forward neural network which has weights and biases associated with neurons the network is required to be trained using backpropagation in contrast eml is a feed forward neural network with a single layer which doesn t require backpropagation for training huang et al 2011 the svr is a regression model which fits a hyperplane to the training dataset with some acceptable error these models have been successfully applied to various surrogate modelling problems in groundwater however unlike ed lstm the sample data are represented in vectorized forms in these models i e n samples n st n s in input and n samples n ot n obs in output these surrogate models are trained and their accuracies are assessed with the same training and testing datasets that are used for ed lstm the performance indicators used are mean absolute error mae root mean squared error rmse and r2 these indicators are evaluated using the trained models for training and testing datasets the mean values of these errors computed for all samples are presented in fig 11 as observed the ed lstm model provides the least rmse and mae for both case studies compared to that of other surrogate models the r2 values corresponding to ed lstm are higher compared to that of other surrogate models as shown in table 4 the performance indicators obtained by eml indicate good accuracy of the model whereas those obtained by mlp and svr suggest their poor performances it may be noted that the simulation times using the rpcm simulation model are 9 s and 6 1 s seconds for case studies 1 and 2 respectively as shown in table 5 which signify a considerable improvement in computational efficiency due to the use of the surrogate models 4 2 estimation of release histories using ed lstm mvo the trained ed lstm surrogate model for case study 1 is linked with the mvo algorithm for the estimation of release histories at the source location the population size and maximum iteration number in the mvo algorithm are set as 25 and 500 respectively it may be noted that due to the use of the surrogate model the computational time for simulation is drastically reduced which allows for a high number of iterations when linked with mvo the time required for inverse modelling was 126 s the results obtained are presented in fig 12 as seen in the figure the ed lstm mvo model estimates the release histories with good accuracy the error indices mae rmse and r2 evaluated against actual release histories from table 1 are 0 35 mg d 0 54 mg d and 0 94 respectively hence the ed lstm mvo model can be considered to be effective for contaminant source identification for highly heterogeneous aquifers the sso model is further used for uncertainty quantification for case study 2 in the subsequent subsection 4 3 uncertainty quantification considering the performance of the ed lstm surrogate model it is used for uncertainty quantification using the sso framework by linking it to the mvo model as discussed in section 2 6 the developed sso model is provided to the process pool for estimating the release rates for each realization of breakthrough curves the process pool appoints the pool workers to undertake the optimization jobs in parallel these jobs which run asynchronously return retrievable objects as soon as the job is completed the objects are transformed to desired results i e release rates and stored by the sync manager the ed lstm mvo is run for each realization for 500 iterations using 25 candidate solutions hence the ed lstm model is run 1 25 106 times the total computational time involved for 100 runs of the sso model in the parallel framework is approximately 0 76 h as mentioned in section 3 2 the uncertainty is quantified for three cases namely a stochasticity in flow parameters b stochasticity in transport parameters and c stochasticity in both flow and transport parameters the convergence curves and best objective function values for the 3 cases considered in this study are provided in fig 13 it is observed that for most realizations the mvo algorithm has obtained the best objective function values close to zero for all three cases however for some realizations it is higher this indicates that the breakthrough curves obtained through the combinations of release rates obtained can t exactly match the observed breakthrough curves which are obtained using reference parameters θ as presented in table 2 nevertheless maximum values of the best objective functions are 3 2 10 3 6 10 4 and 3 2 10 3 for cases a b and c respectively which denotes satisfactory convergence in mvo interestingly the convergence curves for case b shows lower variation compared to that of cases a and b also the objective function values obtained by the sso model for case b are lower this indicates that the uncertainty associated with only transport parameters may have a lower impact to the optimization problem compared to that of other cases moreover due to stochasticity considered in hydrogeological parameters minimizing the objective function becomes complex as the c obs in the objective function are obtained using reference parameters to evaluate the uncertainty in the prediction of source release intensities due to stochasticity in hydrogeological variables 95 ppu percentage prediction uncertainty plots for different source locations are presented in fig 14 it is computed at upper and lower percentile levels by allowing 95 of good simulations further the following indices are proposed to quantify the associated uncertainty 18 p f a c t o r n c ppu n 19 r f a c t o r 1 n t i 1 n y t u p y t l p σ obs here n c ppu is the number of estimated release rates captured by a particular ppu band for a total of n estimates the terms y t u p and y t l p are the estimated values of release intensities at stress period t for upper quantile up and lower quantile lp respectively hence higher values of the p factor indicate better model performance whereas the lower value of the r factor indicates lower uncertainty in the result the values of p factor and r factor are presented in fig 15 it is observed that the estimated release intensities at source location 2 are less uncertain due to low values of r factor however the p factor obtained is low for the location which indicates that lesser values of release histories are captured by the ppu bands the spread of contaminant release rates for source location 2 is low which indicates that the release rate estimation at this location is relatively less sensitive to the aquifer parameters the high values of the r factor for source location 3 indicate higher uncertainty associated with the estimation of release history it may be observed that the spread of estimated release rates is high for the source locations 3 and 4 at all stress periods which indicates that the uncertainty associated with the estimation of release rate at the corresponding source location is high the widths of the 95 ppu curves at different source locations are observed to be lower for case b compared to other cases which is also reflected by lower r factor values in fig 15 this indicates that uncertainty in contaminant source identification due to uncertainty in transport parameters is lower compared to the case when uncertainty in flow parameters are considered it may be noted that the computational time involved in the uncertainty estimation is reduced to a great extent due to the use of the surrogate model further solving the problem using the sso model in the parallel workflow using 8cores consumed 2443 s 2721 s and 2615 s for cases a b and c respectively on the other hand the computational times taken by the sso model for running in a serial workflow are 6954 s 6511 s and 6125 s respectively hence the parallel workflow assists in reducing the computational cost by approximately 2 5 times on average it may be noted that the results can vary for a system with different computational specifications moreover the computational time required may not reduce proportionately as the increase in the number of cores because the power consumed by the system gets distributed between the processors the computational efficiency may be further enhanced by using distributed parallel computing where the optimization jobs can be assigned to multiple systems 5 conclusions in this study a novel parallel workflow is proposed for the quantification of uncertainty associated with contaminant release history estimation in groundwater the framework performs several optimization tasks in parallel which is to minimize the difference between simulated and observed breakthrough curves at the observation wells ed lstm model is proposed to be used as the simulation model using which breakthrough curves at the observation wells are obtained for certain combinations of release rates at the source location the developed model has been applied to two case studies to show its effectiveness the use of the ed lstm model reduces the computational cost significantly i e approximately at least 900 times compared to the simulation model the ed lstm model is observed to be more accurate for reproducing the breakthrough curves at the observation points when compared with other surrogate models it is because the ed lstm model learns the sequential dependence in the input and output data whereas these data were vectorized in the other surrogate models mvo is proposed to be used as the optimization algorithm for the capability to search global optimum in a complex multidimensional search domain owing to its balance between exploration and exploitation search phases the performance of ed lstm mvo suggests that the sso model is effective in identifying the release histories for highly heterogeneous aquifers for uncertainty quantification the parallel workflow assigns a process pool to handle the optimization jobs based on the realizations of breakthrough curves simultaneously and stores the results obtained in the computer memory which are retrieved later due to the use of the parallel workflow the computational time was further reduced by 2 5 times on average in the 3 cases considered for release history estimation compared to that of the serial processing the result of the current study shows that the uncertainty associated with release history estimation is lesser at the source location 2 compared to other locations using the metrics p factor and r factor which indicates that the location is less sensitive to estimated values of the hydrogeological parameters moreover the uncertainty in contaminant source identification due to uncertainty in transport parameters is observed to be lower however for most the actual release rates using reference parameters are well within the 95ppu range of the estimated release rates this workflow can be effectively used for quantifying the uncertainty associated with contaminant release history estimation and assessing the confidence linked with the estimated hydrogeological parameters declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author of the paper is grateful to the indian institute of technology bombay for providing funding for the research the authors also thank the reviewers for their constructive comments which helped in enhancing the quality of the manuscript 
2112,groundwater contamination is a major problem and it can be contaminated by natural or manmade activities contaminant sources cannot be identified promptly after a contamination event due to slow groundwater movement in aquifers to limit the further spread of the plume and to take appropriate remedial measures it is essential to determine the release rates associated with source locations as soon as a contaminant is detected in one of the observation wells in the aquifer conventional techniques for contaminant source identification such as the simulation optimization so uses a simulation model which is based on estimated or measured hydrogeological parameters for replicating the aquifer response to contamination at source locations however the associated intrinsic uncertainty in the parameters can affect the estimated release histories at the source locations to assess confidence in the results it is important to consider stochasticity in the hydrogeological parameters for contaminant release history estimation requiring numerous runs of the so model for corresponding breakthrough curves the present study proposes a novel surrogate simulation optimization sso framework which utilizes an encoder decoder long short term memory ed lstm based surrogate model along with multiverse optimization mvo for contaminant source identification the comparison of ed lstm with other surrogate models shows its better accuracy and significantly low computational time requirement compared to the simulation model to enhance the computational efficiency further the sso model is embedded in a parallel workflow for the quantification of uncertainty associated with the inverse modelling the study shows that the proposed workflow can be efficiently used for uncertainty quantification in contaminant source identification due to stochastic parameters with a reduced computational cost keywords contaminant source identification uncertainty quantification surrogate modelling encoder decoder model long short term memory lstm parallel computing data availability data will be made available on request 1 introduction contamination in groundwater occurs due to sources present underneath the ground level or above it through deliberate or accidental spills batu 2005 if contaminants present are hazardous they may pose a widespread risk to the groundwater systems therefore information regarding the release of contamination from the source location s is essential to containing the contamination plume through remediation strategies however the time interval between the detection of contamination in the observation points of the aquifer and its release at the source location s can be high due to the sluggish transport process this can cause an absence of source information in practical cases which can lead to reduced efficiency in aquifer remediation or high remediation costs ayvaz 2010 retrieval of release histories at source locations is achieved using various approaches out of which simulation optimization so is widely implemented borah and bhattacharjya 2016 gurarslan and karahan 2015 jha and datta 2013 singh et al 2018 singh and datta 2004 singh and datta 2006 the so approach uses an optimization model which utilizes a simulation model to replicate the hydrogeological response of the aquifer for different solution candidates however simulation models require parameterization of flow and transport equations the estimation of which is challenging due to the spatial heterogeneity of soil hydraulic properties and scarcity of data goyal et al 2023 due to this the study area is often discretized into several zones having different hydrogeological characteristics in the simulation model huang and yeh 2016 this leads to parametric uncertainty due to model simplifications ye et al 2010 under such conditions the identified contamination release rates at the source location using inverse modelling also become uncertain cao et al 2019 studied the impact of uncertainty due to different zonation structures in the model on contaminant source identification using modflow harbaugh 2005 and a sampling algorithm named polychord srivastava and singh 2015 developed an artificial neural networks ann based inverse model to evaluate uncertainty in source identification due to uncertainties in the parametrization of flow transport and boundary conditions by utilizing breakthrough curves as inputs and aquifer parameters as outputs however this approach may not be suitable for complex problems due to the non uniqueness of breakthrough curves which are dependent on hydrogeological parameters sun 2013 moreover the direct implementation of the simulation model in the so approach is computationally expensive due to the requirement of solving the partial differential equations representing the groundwater flow and transport process therefore recently several surrogate modelling strategies are being developed for the reduction of computational cost in the contaminant source identification problem for the inverse modelling problem in consideration the surrogate model is required to approximate the concentration profiles at the observation wells using the release intensities at the source locations the surrogate modelling approaches in the literature are generally based on linearization through a response matrix gorelick et al 1983 singh et al 2018 machine learning zhao et al 2020 and kriging based hou and lu 2018 zhao et al 2016 although these models reduce the computational cost significantly most of them use a vector representation of inputs and outputs this approach doesn t facilitate the training process using the existent temporal dependency anshuman and eldho 2022a recently deep learning based approaches based on convolutional neural networks cnns and long short term memory networks lstm have been used for contaminant source identification mo et al 2019 zhou and tartakovsky 2021 subsurface characterization mo et al 2020 zhang et al 2020 reconstruction of missing data in groundwater vu et al 2021 and groundwater level prediction wunsch et al 2021 cnns are particularly designed for analysing image data and it applied for image to image regression by considering source information and contaminant movement in different timesteps in input and output respectively mo et al 2019 zhou and tartakovsky 2021 on the other hand lstm is a type of recurrent neural network rnn which is popularly used to learn time series data in this the input data is provided to the neural network sequentially compared to conventional rnns lstms handle the issue of exploding and vanishing gradients better hochreiter and schmidhuber 1997 nevertheless a single lstm network is suitable for output consisting of fewer time steps in the current problem the surrogate model is required to transform the release rates at source sites into concentration measurements at observation wells generally in release history estimation problems the entire contaminant release period is divided into stress periods during which release rates are assumed to be constant therefore there can be a high difference in the number of time steps of input and output data for the current problem considering the presence of time series data at both inputs and outputs sequence to sequence seq2seq learning using encoder decoder lstm ed lstm kao et al 2020 xiang et al 2020 is better suited to the current study ed lstm which utilizes two lstm networks to transform the input time series data to the output the first lstm encodes the release history information into hidden states which are deciphered by the second lstm the present study aims to quantify the uncertainty in release history estimation due to uncertainty in hydrogeological parameters as optimization plays a crucial role due to the highly complex search space caused by the ill posedness of the problem zhao et al 2020 a recently proposed stochastic population based heuristic optimization algorithm named multiverse optimization mvo mirjalili et al 2016 is used for analysis owing to its good accuracy anshuman and eldho 2022a based on this a novel surrogate simulation optimization sso framework using ed lstm and mvo is proposed in a parallelized workflow for uncertainty quantification of estimated release histories at different source locations for the problem considered the release rates are obtained for the multiple breakthrough curves which are subject to stochastic hydrogeological parameters hence the parallel workflow further improves computational efficiency by simultaneously undertaking several optimization jobs the ed lstm mvo sso model is applied to a highly heterogeneous aquifer in a case study further the sso model is applied to a field type aquifer with seasonally varying groundwater flow caused by different water fluxes in a parallel workflow 2 methodology 2 1 governing equations the flow and transport phenomena in groundwater are governed by a set of partial differential equations pdes which represent the governing equations along with the applicable dirichlet or neumann boundary conditions the governing equations for unsteady state groundwater flow in an unconfined aquifer and contaminant transport in an ith dimensional problem domain are used to estimate the state variables hydraulic head h and contaminant concentration c in the problem domain these are given by 1 s y h t x i κ x i h h x i q 2 c t x i d x i x j c x j x i v x i c λ c q c here x i represents the direction in ith dimension the terms κ x i s y q d x i x j v x i λ and qc are hydraulic conductivity specific yield source sink dispersion coefficient darcy s velocity first order decay rate and sink term related to contaminant release respectively in the coupled flow and transport model the v x i is estimated using eq 3 and d x i x j is estimated using longitudinal and transverse dispersivity terms i e α l and α t as shown in eq 4 3 v x i κ x i η e h x i 4 d x i x j α l v x i α t v x j α l 2 α t 2 2 2 simulation model the meshless radial point collocation method rpcm model is used for the numerical simulation by solving eqs 1 and 2 respectively the solutions to these equations using rpcm are explained in anshuman and eldho 2020 the rpcm model is verified against various analytical semi analytical solutions and popularly used models such as modflow mt3dms and rt3d anshuman and eldho 2020 anshuman and eldho 2022b in the current inverse modelling problem the contaminant release history qc is required to be estimated using the breakthrough curves at the observation wells hence the coupled flow and transport model f can be represented as in eq 5 5 c obs f θ k θ t q q c here c obs are breakthrough curves at the observation wells the terms θ k κ x i s y and θ t α l α t v x i λ are model parameters for groundwater flow and transport respectively for the current problem all parameters except qc are either known or estimated using observations or inverse modelling the estimated parameters related to groundwater flow and transport are referred to as reference parameters i e θ in uncertainty quantification 2 3 encoder decoder long short term memory networks ed lstm encoder decoder long short term memory networks ed lstm is a type of neural network architecture which is used for sequence to sequence seq2seq learning in this architecture two long short term memory networks lstm are employed as an encoder and a decoder respectively lstm is a recurrent neural network rnn which is designed to learn the temporal dependency in the data by effectively handling the vanishing and exploding gradients issues that occur in primitive rnns the key components of lstm comprise three gates namely the input gate output gate and forget gate for a timestep t the input output and forget gates are represented as seen in eqs 6 8 6 g i t σ w 1 i i t w 2 i h t 1 b i 7 g o t σ w 1 o i t w 2 o h t 1 b o 8 g f t σ w 1 f i t w 2 f h t 1 b f here g i t g o t and g f t are sigmoid activations of weighted inputs i and hidden states h along with respective biases for input output and forget gates i e b i b o and b f the subscripts 1 and 2 represent the weights w corresponding to inputs i and hidden states h respectively similarly the subscripts i o and f stand for input output and forget gates respectively the hidden state at each time step is evaluated using the cell state ct as shown in eq 9 which is a function of the cell state at the previous time step c t and antecedent c t see eqs 10 and 11 9 h t o t θ tanh c t 10 c t f t θ c t 1 i t θ c t 11 c t t a n h w 1 c i t w 2 c h t 1 b c for the development of a surrogate model for contaminant source identification in groundwater the relationship between the multivariate sequences of input and output data which represent contamination release rates at the possible source locations and measurements at observation wells respectively is required to be learnt the sequences corresponding to input and output data are of lengths n st and n ot respectively where n st represents the number of stress periods and n ot represents the number of observation timesteps in seq2seq learning using encoder decoder lstm ed lstm the encoder lstm transforms the input data into vectors of hidden state h n st and cell state c n st as shown in fig 1 these vectors are subsequently used to initiate the decoder lstm which outputs a decoded hidden state h n ot and cell state c n ot the decoded hidden state h n ot is then converted to the output i e breakthrough curves at the observation points using the fully connected layer as shown in fig 1 it may be noted that a proxy layer consisting of a zero vector is provided as input for the decoder lstm which essentially denotes that the output sequence is generated using the encoded hidden states from the encoder only in most of the studies related to contaminant source identification the number of stress periods considered which represent the time period with constant release intensity from the source locations is lesser than the number of timesteps of breakthrough curves therefore learning the temporal dependency is important for developing an accurate surrogate model which is achieved through ed lstm in the current study in contrast the surrogate models based on support vector regression svr feed forward neural networks ffnn kriging etc proposed in previous studies use vectorized inputs and outputs which doesn t facilitate learning the sequential information 2 4 multiverse optimizer optimization algorithms are of prime importance in an sso framework in a stochastic population based algorithm the feasible solutions are explored in a multidimensional search space which may have more than one local optima the algorithm tries to arrive at the global optimum solution by improving the candidate solution at every iteration multiverse optimization mvo is a recently proposed algorithm which is loosely based on the multiverse theory in physics mirjalili et al 2016 the candidates for solutions to the decision variables are referred to as universes in mvo through white holes black holes and wormholes these universes exchange elements any object within a black hole s gravitational field can be devoured by it contrary to that white holes eject huge amounts of matter into space eardley 1974 wormholes are theorized to connect different areas of space time as well as the multiverse morris and thorne 1988 in mvo a white hole is present in the best universe while black holes are present in all other universes mirjalili et al 2016 through a roulette wheel mechanism elements from a white hole universe are exchanged with those from other universes each universe in the multiverse has a proportional inflation rate determined by its objective function as a result of each iteration the universe with the best inflation rate is selected as the best solution using the principles detailed in mirjalili et al 2016 the search space in the universe is explored and exploited by using white holes black holes and wormholes eq 12 explains how local changes in universes are represented mathematically by wormholes 12 x i j x best j t d r u b j l b j r 4 l b j i f r 3 0 5 x best j t d r u b j l b j r 4 l b j o t h e r w i s e x i j o t h e r w i s e i f r 2 w e p where x best j u b j and l b j represent the jth variable of the best universe upper bound and lower bounds of the jth variable respectively the terms r 2 r 3 and r 4 denote random numbers in 0 1 tdr and wep represent the travelling distance rate and wormhole existence probability respectively which depend on iteration number t and maximum iteration number t max as provided in eqs 13 and 14 the maximum and minimum values of wep are set as 1 and 0 2 mirjalili et al 2016 13 tdr 1 t t max 1 6 14 we p t wep min t wep max w e p min t max 2 5 objective function using aquifer hydrogeology and contaminant observations at observation points the surrogate simulation optimization sso model estimates the contaminant release history at the source locations this inverse modelling problem is solved by optimizing the release history data in a manner that minimizes the difference between the observed and simulated breakthrough curves at the observation wells mathematically the objective function for the problem can be represented by eqs 15 and 16 15 min 1 n obs i 1 n obs j 1 n st c ij obs c ij sim 2 16 s u b j e c t t o q l q c n q u n 1 n s c sim f q c in eqs 15 and 16 observed and ed lstm simulated concentrations at the observation points are denoted by c obs and c sim respectively the number of observation wells and stress periods are specified by n obs and n st respectively the concentrations at the observation points csim are obtained using contamination strength qc at the n s source points simulated by the surrogate model f at the observation points 2 6 uncertainty quantification using sso in a parallel workflow in uncertainty quantification the sso model is required to be run multiple times based on the number of realizations of the breakthrough curves at the observation wells these realizations are obtained through monte carlo simulations using stochastic hydrogeological parameters through the simulation model for further enhancement of the computational efficiency the sso model is run in a parallel workflow as shown in fig 2 which allocates each processor an optimization job as explained in section 2 4 it may be noted that the number of such jobs is dependent on the number of realizations considered these jobs are provided to a process pool first which then allocates them to a pool of workers each worker performs an optimization job and returns the results to a designated storage location each job is accomplished asynchronously i e the workers don t block the other workers which are working in parallel till all the results are obtained instead each worker immediately returns a retrievable object which is stored in memory after the completion of its job and starts the subsequent job from the process pool with the available processor it may be noted that a sync manager is also provided to the process pool which assists in maintaining the order of the results obtained which may be otherwise affected due to the use of asynchronous computation 3 problem statement and numerical simulation 3 1 case study 1 here a highly heterogeneous aquifer is considered for demonstrating the efficacy of the ed lstm surrogate model this unconfined aquifer of 600 m 300 m with dirichlet boundary conditions at the west and east boundaries with head values of 10 m and 7 m respectively the north and south boundaries apply to no flow boundary conditions the heterogeneous hydraulic conductivity field of the aquifer as shown in fig 3 a is generated using gaussian inversion as per anshuman and eldho 2022b the longitudinal α l and transverse α t dispersivities are 10 m and 1 m respectively as shown in the fig 3 there are 3 potential sources of contamination in aquifer i e s1 s2 and s3 through which contaminant enters the groundwater the contaminant is represented as total dissolved solids tds which are measured at four observation wells i e ob1 ob2 ob3 and ob4 to simulate the flow and transport in the aquifer the rpcm model as presented in section 2 2 is run for 8 years simulation period with a timestep of 10 days utilizing a nodal distribution as shown in fig 3b the contamination period is divided into 3 stress periods of one year each the breakthrough curves at the observation wells as seen in fig 4 d are obtained using release histories at the sources presented in table 1 the concentration contours after 8 years simulation period are presented in fig 4c the developed rpcm simulation model is used for the generation of samples to facilitate training of the ed lstm surrogate model the trained ed lstm model is further used as a surrogate model in the sso framework to estimate the release histories at the source locations 3 2 case study 2 for quantification of uncertainty in release history estimation due to hydrogeological uncertainty a heterogeneous unconfined aquifer see fig 5 a similar to a field type aquifer majumder and eldho 2017 is considered here as seen in fig 5a there is a river that follows along the west boundary which enforces the dirichlet boundary condition the southern boundary is no flux boundary whereas a small flux enters through the eastern boundary the aquifer is also recharged by a pond which is estimated as 6 5 10 3 m d as shown in fig 5a further groundwater is extracted from the aquifer from two pumping locations for the usage of the population hence the water balance of the aquifer is mainly influenced by the recharge rate from the pond extraction rates of pumping and flux from the eastern boundary and water level of the river the total aquifer area of 29 13 km2 is divided into three distinct zones the reference zonal hydrogeological parameters θ are presented in table 2 the head variation throughout the aquifer is obtained by the rpcm model for 15 years with a time step of 10 days steady state head distribution is assumed as the initial condition for the flow problem majumder and eldho 2017 the details of rpcm model parameters used for simulation are described in anshuman and eldho 2022 for steady state simulation the recharge from the pond and incoming flux from the east boundary and river head are taken as 0 015 m d 0 012 m d and 720 m respectively to simulate the transient head variation in the aquifer these entities are varied as shown in fig 6 it may be noted that these monthly values are considered to be the same for the entire simulation period as seen in fig 6 the aquifer is recharged between may october due to the precipitation occurring in the form of rainfall resulting in recharge through the pond and incoming flux through the eastern boundary extraction rates from the pumps gradually decrease with the commencement of the rainy season when water demand is compensated from river discharge and it gradually increases afterwards the head contours at different time steps are presented in fig 7 there are four contamination sources s1 s2 s3 and s4 in the aquifer as shown in fig 5b which injects tritium half life 12 32 years into the aquifer for 4 years a total of 5 stress periods each of 1 year are considered for the case study the source strengths in different source periods are given in table 3 which are required to be estimated hence the total number of unknowns to be estimated is 20 4 source locations 5 stress periods for this case study the uncertainties in estimated release histories at the source location are evaluated for stochastic hydrogeological parameters as mentioned in section 2 6 this is performed by running the sso model using realizations of breakthrough curves obtained through monte carlo simulations using stochastic flow and transport parameters i e θ k and θ t in this study 100 realizations are obtained for each of the 3 cases in the first and second cases parameters θ k and θ t are considered to be stochastic respectively all parameters θ θ k θ t are considered to be stochastic in the third case these parameters are drawn from uniform normal sampling using mean values are corresponding reference parameters θ and the standard deviation is given by 17 θ n θ σ θ here θ and n are the estimated stochastic parameters and normal distribution respectively the standard deviation σ θ is considered 0 05 θ the distributions of these parameters are shown in fig 8 the realizations for the observed concentrations c obs for different cases are presented in fig 9 these realizations are used in the computation of the objective function as described in section 2 5 it may be noted that the breakthrough curves can also be affected due to uncertainty in the groundwater fluxes which influence the water balance however in the current study only the impact of uncertainty of hydrogeological parameters is considered for analysis 3 3 model development steps the steps involved in the development of the surrogate simulation optimization model are given as follows 1 data pre processing the input and output data for ed lstm training comprise contamination strengths at the source and observed contaminant data at the observation points respectively at different time steps as simulated by the simulation model the contamination strengths are generated using uniform random sampling out of the 2000 samples generated 75 are considered training samples whereas 25 are considered testing samples for both case studies 1 and 2 the time required for sample generation is 2 56 h and 3 38 h for case studies 1 and 2 respectively these data are normalized using max min normalization the input and output data are arranged in the form of tensors of shape n samples n st n s and n samples n ot n obs here n samples n st n s n ot and n obs are the number of generated samples stress periods sources observation timesteps and observation points respectively it may be noted that during sample generation the aquifer hydrogeological data are set to reference parameters θ as provided in table 2 for case study 2 2 ed lstm model development pytorch paszke et al 2019 is used for developing the ed lstm model the input data is encoded by the encoder lstm to h n st and c n st as mentioned in section 2 2 the decoder lstm utilizes the hidden states h n st as the initial hidden state and takes a proxy matrix containing zero values of similar shape as input data the hidden state after the last timestep in the decoder lstm i e h n ot is further passed through a dense layer with linear activation to provide output it may be noted that since this output is normalized it is required to be scaled up using the inverse of the max min transformation used in the previous step to provide the final output 3 training gradient descent is used to train the ed lstm model based on the adaptive moment estimation algorithm kingma and ba 2014 the trainable model parameters weights and biases are optimized to minimize mean squared errors mse between the training data and predicted data the training of the ed lstm model is accomplished with 2000 epochs in approximately 0 44 h and 0 4 h for case studies 1 and 2 respectively a graphical processing unit gpu is used during the training of the ed lstm model to reduce the computational effort for this the developed ed lstm model and samples are mapped to the gpu 4 ed lstm mvo sso model development the trained ed lstm model is further used for prediction for which the input data is required to be normalized and arranged in 1 n st n s form the model is embedded within the mvo algorithm for the development of the sso model mvo initiates the population within the upper and lower bounds predictions of concentrations at observation wells are based on the normalized population which represents the release histories at source locations iteratively these predictions are used to minimize the objective function at each iteration the best solution is updated the release histories are obtained from the ed lstm mvo model after satisfying the stopping criteria it may be noted that for case study 1 the release history estimation problem is deterministic using the hydrogeological parameters listed in section 3 1 therefore the subsequent steps apply to uncertainty quantification which is done for case study 2 5 generation of realizations of breakthrough curves for quantification of uncertainty the sso model is run considering the stochastic distribution of hydrogeological parameters as shown in fig 8 to evaluate respective impacts on the uncertainty three sets of breakthrough curves are generated as mentioned in section 3 2 the first and second sets are obtained using stochastic flow and transport parameters respectively while in the third set both flow and transport parameters are considered stochastic 6 uncertainty quantification the ed lstm mvo model developed is used for the estimation of release rates for different breakthrough curve realizations in a non parallel or series workflow these realizations are considered sequentially for the inverse modelling using the sso model using the parallel workflow described in section 2 5 more than one optimization job is performed in a multi processor system it may be noted that the parallel processing unit necessitates the ed lstm model and inputs to be mapped to the cpu hence the gpu mapped ed lstm model and inputs are converted to cpu arrays using pytorch paszke et al 2019 the optimization jobs are handled by the processing pool using workers who undertake the jobs asynchronously as mentioned in section 2 5 the computations are performed on a system with an intel i7 6700 processor consisting of 8 cores at 3 4 ghz and 16 gb ram the multiprocessing module from python 3 7 9 is used for parallel processing the retrievable outputs i e release histories are compiled by the sync manager and provided after the completion of stopping criteria for all optimization jobs corresponding to the breakthrough curves the methodology for uncertainty quantification is provided in fig 10 4 result and discussion 4 1 ed lstm model training and performance comparison for training of the ed lstm model the sample data is generated using simulation model outputs obtained considering randomly generated input data for contamination release at source locations it may be noted that the reference hydrogeological parameters θ are used in the simulation model for a generation of the sample data which is arranged in three dimensional arrays of input and output data as mentioned in section 3 3 the ed lstm model for both case studies was trained for 5000 epochs the mse for training and testing after training were 2 2 10 7 and 3 1 10 7 for case study 1 respectively similarly these values are 1 3 10 7 and 2 1 10 7 for case study 2 respectively the performance of the ed lstm model is compared with different surrogate models such as extreme machine learning eml zhao et al 2020 multilayer perceptron mlp singh and datta 2004 and support vector regression svr pan et al 2021 xing et al 2019 mlp is a feed forward neural network which has weights and biases associated with neurons the network is required to be trained using backpropagation in contrast eml is a feed forward neural network with a single layer which doesn t require backpropagation for training huang et al 2011 the svr is a regression model which fits a hyperplane to the training dataset with some acceptable error these models have been successfully applied to various surrogate modelling problems in groundwater however unlike ed lstm the sample data are represented in vectorized forms in these models i e n samples n st n s in input and n samples n ot n obs in output these surrogate models are trained and their accuracies are assessed with the same training and testing datasets that are used for ed lstm the performance indicators used are mean absolute error mae root mean squared error rmse and r2 these indicators are evaluated using the trained models for training and testing datasets the mean values of these errors computed for all samples are presented in fig 11 as observed the ed lstm model provides the least rmse and mae for both case studies compared to that of other surrogate models the r2 values corresponding to ed lstm are higher compared to that of other surrogate models as shown in table 4 the performance indicators obtained by eml indicate good accuracy of the model whereas those obtained by mlp and svr suggest their poor performances it may be noted that the simulation times using the rpcm simulation model are 9 s and 6 1 s seconds for case studies 1 and 2 respectively as shown in table 5 which signify a considerable improvement in computational efficiency due to the use of the surrogate models 4 2 estimation of release histories using ed lstm mvo the trained ed lstm surrogate model for case study 1 is linked with the mvo algorithm for the estimation of release histories at the source location the population size and maximum iteration number in the mvo algorithm are set as 25 and 500 respectively it may be noted that due to the use of the surrogate model the computational time for simulation is drastically reduced which allows for a high number of iterations when linked with mvo the time required for inverse modelling was 126 s the results obtained are presented in fig 12 as seen in the figure the ed lstm mvo model estimates the release histories with good accuracy the error indices mae rmse and r2 evaluated against actual release histories from table 1 are 0 35 mg d 0 54 mg d and 0 94 respectively hence the ed lstm mvo model can be considered to be effective for contaminant source identification for highly heterogeneous aquifers the sso model is further used for uncertainty quantification for case study 2 in the subsequent subsection 4 3 uncertainty quantification considering the performance of the ed lstm surrogate model it is used for uncertainty quantification using the sso framework by linking it to the mvo model as discussed in section 2 6 the developed sso model is provided to the process pool for estimating the release rates for each realization of breakthrough curves the process pool appoints the pool workers to undertake the optimization jobs in parallel these jobs which run asynchronously return retrievable objects as soon as the job is completed the objects are transformed to desired results i e release rates and stored by the sync manager the ed lstm mvo is run for each realization for 500 iterations using 25 candidate solutions hence the ed lstm model is run 1 25 106 times the total computational time involved for 100 runs of the sso model in the parallel framework is approximately 0 76 h as mentioned in section 3 2 the uncertainty is quantified for three cases namely a stochasticity in flow parameters b stochasticity in transport parameters and c stochasticity in both flow and transport parameters the convergence curves and best objective function values for the 3 cases considered in this study are provided in fig 13 it is observed that for most realizations the mvo algorithm has obtained the best objective function values close to zero for all three cases however for some realizations it is higher this indicates that the breakthrough curves obtained through the combinations of release rates obtained can t exactly match the observed breakthrough curves which are obtained using reference parameters θ as presented in table 2 nevertheless maximum values of the best objective functions are 3 2 10 3 6 10 4 and 3 2 10 3 for cases a b and c respectively which denotes satisfactory convergence in mvo interestingly the convergence curves for case b shows lower variation compared to that of cases a and b also the objective function values obtained by the sso model for case b are lower this indicates that the uncertainty associated with only transport parameters may have a lower impact to the optimization problem compared to that of other cases moreover due to stochasticity considered in hydrogeological parameters minimizing the objective function becomes complex as the c obs in the objective function are obtained using reference parameters to evaluate the uncertainty in the prediction of source release intensities due to stochasticity in hydrogeological variables 95 ppu percentage prediction uncertainty plots for different source locations are presented in fig 14 it is computed at upper and lower percentile levels by allowing 95 of good simulations further the following indices are proposed to quantify the associated uncertainty 18 p f a c t o r n c ppu n 19 r f a c t o r 1 n t i 1 n y t u p y t l p σ obs here n c ppu is the number of estimated release rates captured by a particular ppu band for a total of n estimates the terms y t u p and y t l p are the estimated values of release intensities at stress period t for upper quantile up and lower quantile lp respectively hence higher values of the p factor indicate better model performance whereas the lower value of the r factor indicates lower uncertainty in the result the values of p factor and r factor are presented in fig 15 it is observed that the estimated release intensities at source location 2 are less uncertain due to low values of r factor however the p factor obtained is low for the location which indicates that lesser values of release histories are captured by the ppu bands the spread of contaminant release rates for source location 2 is low which indicates that the release rate estimation at this location is relatively less sensitive to the aquifer parameters the high values of the r factor for source location 3 indicate higher uncertainty associated with the estimation of release history it may be observed that the spread of estimated release rates is high for the source locations 3 and 4 at all stress periods which indicates that the uncertainty associated with the estimation of release rate at the corresponding source location is high the widths of the 95 ppu curves at different source locations are observed to be lower for case b compared to other cases which is also reflected by lower r factor values in fig 15 this indicates that uncertainty in contaminant source identification due to uncertainty in transport parameters is lower compared to the case when uncertainty in flow parameters are considered it may be noted that the computational time involved in the uncertainty estimation is reduced to a great extent due to the use of the surrogate model further solving the problem using the sso model in the parallel workflow using 8cores consumed 2443 s 2721 s and 2615 s for cases a b and c respectively on the other hand the computational times taken by the sso model for running in a serial workflow are 6954 s 6511 s and 6125 s respectively hence the parallel workflow assists in reducing the computational cost by approximately 2 5 times on average it may be noted that the results can vary for a system with different computational specifications moreover the computational time required may not reduce proportionately as the increase in the number of cores because the power consumed by the system gets distributed between the processors the computational efficiency may be further enhanced by using distributed parallel computing where the optimization jobs can be assigned to multiple systems 5 conclusions in this study a novel parallel workflow is proposed for the quantification of uncertainty associated with contaminant release history estimation in groundwater the framework performs several optimization tasks in parallel which is to minimize the difference between simulated and observed breakthrough curves at the observation wells ed lstm model is proposed to be used as the simulation model using which breakthrough curves at the observation wells are obtained for certain combinations of release rates at the source location the developed model has been applied to two case studies to show its effectiveness the use of the ed lstm model reduces the computational cost significantly i e approximately at least 900 times compared to the simulation model the ed lstm model is observed to be more accurate for reproducing the breakthrough curves at the observation points when compared with other surrogate models it is because the ed lstm model learns the sequential dependence in the input and output data whereas these data were vectorized in the other surrogate models mvo is proposed to be used as the optimization algorithm for the capability to search global optimum in a complex multidimensional search domain owing to its balance between exploration and exploitation search phases the performance of ed lstm mvo suggests that the sso model is effective in identifying the release histories for highly heterogeneous aquifers for uncertainty quantification the parallel workflow assigns a process pool to handle the optimization jobs based on the realizations of breakthrough curves simultaneously and stores the results obtained in the computer memory which are retrieved later due to the use of the parallel workflow the computational time was further reduced by 2 5 times on average in the 3 cases considered for release history estimation compared to that of the serial processing the result of the current study shows that the uncertainty associated with release history estimation is lesser at the source location 2 compared to other locations using the metrics p factor and r factor which indicates that the location is less sensitive to estimated values of the hydrogeological parameters moreover the uncertainty in contaminant source identification due to uncertainty in transport parameters is observed to be lower however for most the actual release rates using reference parameters are well within the 95ppu range of the estimated release rates this workflow can be effectively used for quantifying the uncertainty associated with contaminant release history estimation and assessing the confidence linked with the estimated hydrogeological parameters declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author of the paper is grateful to the indian institute of technology bombay for providing funding for the research the authors also thank the reviewers for their constructive comments which helped in enhancing the quality of the manuscript 
2113,this study proposes a semi analytical solution to a one dimensional advection dispersion equation considering reaction and source terms to predict and describe pollutant transport in various river networks using the laplace transform approach moreover the proposed semi analytical solution is expanded for variable coefficients of the transport equation by increasing the number of middle nodes and associated intervals the presented method solves the mass transport equation by considering advection and dispersion phenomena for one branch of the river network the final mass balance equation is thus obtained in different types of river networks for each node regarding the connection matrix the matrices of the characteristics of flow pollutant and network geometry are first determined as the model inputs then by considering the diffusion and final mass conservation laplace transform of mass balance equation equations for each node in the arbitrary river network the mass balance and diffusion matrices are calculated in terms of the laplace variable s thus a complex system of nonlinear algebraic equations is produced in terms of s which can be solved using inverse laplace algorithms to determine the concentration value at every node the present study introduces four practical scenarios of pollutant transport in river networks in order to evaluate the proposed semi analytical solution the first is a branch type river network with constant coefficients the second case is a loop type river network with variable coefficients the third case simultaneously considers a point pollutant source and a distributed pollutant source in a branch type river network the fourth case is a branch type river network under the dispersion dominant phenomenon with a point source results show that the proposed semi analytical solution is adequately capable of modeling pollutant transport and indicating its critical features in complex states of various river networks moreover exploring the literature shows that no analytical solution has been introduced for river networks before undertaking the present study keywords semi analytical solution advection dispersion equation river network point and distributed source terms laplace transform method data availability no data was used for the research described in the article 1 introduction river networks mainly consist of different river branches and fixed connection nodes based on the ground topography dietrich et al 1993 garbin et al 2019 mark 1988 montgomery and foufoula georgiou 1993 tarboton et al 1991 these networks are defined as a non annular directed graph heckmann et al 2015 peckham gupta 1999 and there are upstream and downstream nodes between each connection of river branches lindsay et al 2019 the environmental performance of river networks can be considerably weakened by inappropriate hydraulic conditions challenging all living aquatic organisms such as fish campbell et al 2015 garbin et al 2019 lazzaro et al 2017 sarremejane et al 2017 therefore the pollution issue in a river network has extremely harmful effects on humans the environment and primarily freshwater fish master et al 1998 matthews 2012 rodriguez iturbe et al 2009 additionally it paves the way for spreading dangerous diseases through the water codeço 2001 pascual et al 2002 rinaldo et al 2018 rodriguez iturbe et al 2009 removing pollution from a river network imposes much higher costs than a single branch hence a mathematical model can be crucial in predicting and controlling pollution in a river network the pollutant transport modeling in a river network is conducted using the mass transport equation particularly the advection dispersion equation ade the ade is a linear differential equation with parabolic partial derivatives concerning space and time the mentioned equation is derived from fick s law which gives the spatial and temporal distribution function of pollutant concentration chapra 2008 fischer et al 1979 mass transport for a pollutant depends on factors such as flow patterns in the system and the extent of pollutant dispersion this variable can be determined through direct calculation numerical or analytical solution of ade and employing ade coefficients for a general process taylor krishna 1993 welty et al 2020 for a river network it is unfeasible to use two and three dimensional models of the advection dispersion reaction equation adre due to the long computation time and lack of sufficient data for validation therefore a 1 d model is recommended for predicting the pollutant concentration in a river network launay et al 2015 leibundgut et al 2009 however research has proved that it is difficult to determine an analytical solution for ade considering source and reaction terms kim 2020 moranda et al 2018 parhizi et al 2022 nowadays analytical solutions are applied in different scientific and engineering fields including mass transport heat transfer pollutant dispersion in aquatic atmospheric air and soil environments amiri et al 2021 javandel et al 1984 jury et al 1983 leij et al 1991 mazaheri et al 2013 pérez guerrero et al 2009a quezada et al 2004 van genuchten 1981 there are several benefits to the application of analytical solutions in solving pollutant transport problems such as the possibility of scenario modeling and pollution analysis for better management accurate sensitivity analysis of mass transport parameters or different pollutant transport processes and extrapolation over long times and distances the mentioned above are not possibly be examined by numerical solutions mazaheri et al 2013 pérez guerrero et al 2009a moreover other limitations of numerical solutions in pollutant transport modeling include the stability conditions difficulties in selecting proper spatial and time steps high time consumption and high computation costs amiri et al 2021 mazaheri et al 2013 moreover the analytical solution delivers more accuracy for mass transport calculations and can be used as a tool for screening and verifying numerical solutions amiri et al 2021 basha el habel 1993 mazaheri et al 2013 pérez guerrero et al 2009a yates 1990 zoppou knight 1999 analytical methods such as the fourier transform green s function generalized integral transform technique gitt laplace transform and hankel transformation are most commonly used for solving ade chen et al 2011 leij et al 1991 leij et al 1993 massabó et al 2006 park zhan 2001 xu meakin 2013 green s function is a practical method for solving ade of one two and three dimensional states in finite semi finite and infinite domains leij van genuchten 2000 gitt is based on eigenfunctions and applied to solving partial differential equations with complicated boundary conditions and solution domains cotta 2020 cotta et al 2016 leij et al 1993 the laplace transform is a robust analytical method for solving pollutant transport problems with various dirichlet newman and robin boundary conditions this method can be employed for problems with multiple pollutant sources besides considering the exponential dependency at the initial time clement 2001 srinivasan clement 2008a srinivasan clement 2008b based on previously conducted studies a multitude of analytical solutions have been presented for the 1 d pollutant transport equation in porous media kumar yadav 2015 pérez guerrero et al 2013 selvadurai 2004 su et al 2005 van genuchten alves 1982 groundwater jaiswal et al 2022 sanskrityayn et al 2018b and limitedly in rivers adrian et al 1994 fischer et al 1979 genuchten et al 2013 shukla 2002 zoppou knight 1999 first the analytical solution of the 1 d pollutant transport equation is derived from its simplest form involving temporal advection and dispersion terms with constant coefficients leij van genuchten 1995 to this end yang et al 2019 developed the ade with constant coefficients and converted it to the conformable advection dispersion equation cade for a more accurate and actual prediction of solute transport the variable coefficients have received more attention than the constant coefficients in the ade for this purpose dimensionless numbers especially the peclet number are extensively used to convert the variable coefficients to constant coefficients bharati et al 2017 bharati et al 2018 bharati et al 2019 singh et al 2009 in the definition of variable coefficients for velocity and dispersion in some cases the dispersion coefficient is considered proportional to the squared velocity kumar et al 2009 kumar et al 2010 yadav roy 2022 later scholars added the reaction term to the analytical solution of the 1 d solute transport equation and solved adre with constant coefficients chen liu 2011 simpson ellery 2014 williams tomasko 2008 pérez guerrero et al 2009b 2010 showed the effect of multi species pollutant transport with consecutive first order reactions in a homogenous porous medium for this purpose they considered two boundary conditions of the third type with constant value and function of time mazaheri et al 2013 used the superposition principle to examine the effect of the reaction decay coefficient in a river with several pulsating point pollutant sources some other analytical solutions for 1 d adre are obtained using variable coefficients yates 1992 zamani bombardelli 2014 in this case variable coefficients are used to accurately describe multi species solute transport with consecutive first order reactions for a saturated aquifer suk 2016 you zhan 2013 developed the adre with variable coefficients for a double layer porous medium analytically under more complicated conditions in some cases the reaction term is neglected in the analytical solution of the 1 d pollutant transport equation by considering the source term instead the solution of the advection dispersion source equation adse with variable coefficients is derived analytically sanskrityayn et al 2021 in this regard sanskrityayn et al 2017 demonstrated the effect of the source term in groundwater and river environments by two forms of instant and continuous point injection in an infinite domain they extended their solutions for variable velocity and dispersion coefficients with spatial and temporal dependencies when the spatial and temporal dependencies of velocity are non degenerate the solutes transport faster in d v 2 compared to d v for both continuous and instant point sources sanskrityayn et al 2018a finally the complete form of the pollutant transport equation was analytically solved by considering advection dispersion reaction and source terms with constant coefficients chen et al 2017 and variable coefficients amiri et al 2021 basha el habel 1993 most studies are conducted in porous media groundwater and river environments and the number of studies on river networks is limited most investigations related to mathematical pollution modeling with a direct solution of ade have been performed for a river network by numerically solving the pollutant transport equation according to our knowledge there has been no comprehensive analytical solution for this equation s application in river networks thus far however according to our knowledge there has been no comprehensive analytical solution for this equation s application in river networks thus far however there are network oriented analytical solutions for biological problems ramirez 2012 or pollution transport problems with simple assumptions and simulations fardadi shilsar et al 2022a fardadi shilsar et al 2022b in river networks biomedical problems zimmerman tartakovsky 2020 and nutrient transport in mycelium fungal networks heaton et al 2012 as well as physical problems koplik et al 1988 koplik et al 1988 studied the transport of a neutral tracker in a random network of pipes in a porous medium using the mass transport equation they solved the mass transport equation analytically by considering the constant boundary conditions at nodes and disregarding the initial conditions ramirez 2012 modeled the population of living organisms in a branch type river network utilizing the mass transport equation temporally and spatially they used proper boundary conditions at output nodes and the network upstream heaton et al 2012 solved the mass transport equation by incorporating amino acids as the input nutrient in a mycelium fungal network and examined how nutrients move from an inlet boundary toward all branches and nervures using the radio tracking test zimmerman tartakovsky 2020 presented an analytical solution for the solute transport equation in vessels as a bifurcated fractal network first they derived their solution for individual vessels they then extended their solution to a bifurcating fractal tree model by linking the solutions of the single vessel to each other furthermore some researchers utilized non analytical approaches for modeling pollutant transport in the river network zhang et al 2008 proposed a hydrodynamic and qualitative model based on the river connection type using the finite difference method for the colombia river network in the united states kilic aral 2009 presented a new method based on the fugacity instability approach and numerical discretization of the pollutant transport equation they presented concentration results as spatial profiles and time series for the altamaha river deng 2019 investigated the relationship between the water quality and network connection structure with gray relational analysis gra and examined spatial concentration pattern maps with gis software for the jiang su plain diamantini et al 2019 employed the lagrange approach for a river branch they then extended it to the entire river network to evaluate the concentration of five irremovable pollutant sources in water treatment facilities of the adige river network the mentioned studies use numerical and statistical approaches to modeling river network pollution due to the complicated nature of river networks no analytical solution has yet been proposed for the 1 d ade by considering the source and reaction terms to calculate the spatial and temporal distributions of pollutants furthermore most analytical solutions have been presented for only one river branch as opposed to entire river networks however other studies have attempted to solve the mass transport equation in botanical networks heaton et al 2012 a porous media network koplik et al 1988 a porous media biomedical network zimmerman tartakovsky 2020 and a river network ramirez 2012 the present study has several advantages over the four as follows 1 in these studies the source term has not been considered in the mass transport equation one strength of this study is the addition of various source terms point and distributed to the mass transport equation additionally ramirez 2012 and zimmerman tartakovsky 2020 considered no reaction term in the mass transport equation and solved the simplest form 2 in the discussed works only branch type networks have been modeled while the present study models the loop type network in addition to the branch type for the loop type modeling is much more complicated for example zimmerman tartakovsky 2020 only modeled branch type networks as bifurcating networks in discussing solute transport in vessels 3 in the four studies the analytical solution of the transport equation and its simulation have been presented with constant coefficients in contrast this study analytically solves and expands the mass transport equation and simulates it not only with constant coefficients but also the variable ones 4 in studies by koplik et al 1988 heaton et al 2012 and zimmerman tartakovsky 2020 only one inlet and multiple outlet boundaries were considered for the network heaton et al 2012 examined the solute transport from the inlet boundary in nervures while this study assumes that pollutants enter from several inlet boundaries and exit from a single outlet the present study aims to derive a complete semi analytical solution for the one dimensional advection dispersion equation by considering the reaction and source terms in different river networks to this end this study utilizes the laplace transform method under the initial condition and dirichlet boundary conditions at inlets and outlets for solving the governing equation then the semi analytical solution is compared to the numerical solution for validation in the following to demonstrate the application of the semi analytical solution pollutant transport modeling is performed for four test cases including branch type combined branch and loop type and branch type river networks in the presence of source terms and under the dispersion dominant phenomenon 2 theoretical principle and methods 2 1 mathematical model due to its simplicity the laplace transform is one of the oldest and most prevalent analytical methods for solving partial differential equations this robust and suitable tool is closely related to the complex fourier transform therefore the fourier transform can be used to define laplace transform myint u debnath 2007 some strengths of this method are as follows a it directly solves problems meaning that it can easily be applied to initial value problems b it solves nonhomogeneous ordinary differential equations without having to first convert them into homogeneous differential equations and c the most critical benefit is related to heaviside and dirac delta functions which simplify the use of this method in the presence of complicated source terms kreyszig 2009 advection and dispersion are critical processes in mass transport gulliver 2007 for modeling purposes in this study input pollutant sources are assumed to move under the main mechanisms described above and are dispersed all around the network fig 1 shows a schematic of the branch type river network and the characteristics of one branch s inlet and outlet as can be seen node i is the inlet node upstream of the river branch j is the outlet node downstream of the river branch l ij is the length of one branch in the network k ij is the reaction decay coefficient v ij is the mean flow velocity in branch ij so that v ij v ij φ ij x t is the input source term in branch ij a ij is the flow cross section area and d ij is the dispersion coefficient along the x axis the one dimensional ade considering the source and reaction terms for one branch of a river network in the domain of 0 x l ij is defined as follows 1 c ij x t t d ij 2 c ij x t x 2 v ij c ij x t x k ij c ij x t φ ij x t in eq 1 c i j c ij x t m l 3 is the pollutant concentration function at location x and time t d ij l 2 t 1 is the longitudinal dispersion coefficient along the x axis v ij l t 1 is the flow velocity k ij is the reaction decay coefficient its dimension is a function of the degree of reaction and φ ij x t m l 3 t 1 is the source term in each branch ij in the mathematical form the initial condition at t 0 upstream boundary condition at x 0 and downstream boundary conditions at x l ij are expressed as follows 2 c ij x 0 f ij x 3 c ij 0 t c i t c ij l ij t c j t in eqs 2 and 3 f ij x is the pollutant concentration function for the initial condition c i t and c j t are time functions of dirichlet type boundary conditions for pollutant concentration upstream and downstream of the branch ij in the river network it should be noted that the upstream boundary condition can be considered as the third type robin type instead of the first type dirichlet type this case affects obtaining the constants of the ode after taking laplace of the ade and causes more complicated equations for them according to fick s law the mass balance equation resulting from the sum of loadings due to advection and dispersion processes and based on physical principles is expressed as follows from node i for some inlet branches 4 w i t j q ij c ij x t a ij d ij c ij x t x x 0 where q ij is the flow discharge of each branch and w i t is the net pollutant flow out of node i if node i is not an inlet node i e boundary points from which the pollution pattern enters the network the input source value to node i is equal to the value of remaining sources from node i therefore w i t 0 meaning that the mass balance is zero at nodes with unknown values it should be noted that the mass balance for nodes with known values is defined as w i t 0 moreover the mass balance equation assumes that mass transport mechanisms only include advection and dispersion this approach to expressing mass balance equations has been seen in other research works heaton et al 2012 koplik et al 1988 to solve ade in the presence of reaction and source terms eq 1 for 0 x l ij the laplace transform of eqs 1 and 3 respectively the main equation and its boundary conditions are taken with respect to the time variable t for this purpose 5 s c ij x s c ij x 0 k ij c ij x s v ij d c ij x s dx d ij d 2 c ij x s d x 2 φ ij x s 0 6 c ij 0 s c i s c ij l ij s c j s in eqs 5 and 6 c ij represents the dependent variable of eq 1 in the laplace domain and symbol s is the laplace variable from the initial condition of c ij x 0 f ij x and by assuming φ ij x s f ij x ψ ij x s eq 5 can be rewritten as follows 7 s k ij c ij v ij d c ij dx d ij d 2 c ij d x 2 ψ ij x s after taking the laplace transform of the main equation and related boundary conditions eqs 1 and 3 the laplace transform of eq 4 expressing the net pollutant flow out of node i mass balance is determined therefore 8 w i s j q ij c ij x s a ij d ij d c ij x s dx x 0 where w i s is the laplace transform of w i t representing the function of pollutant flux coming out of node i for the analytical solution of eq 1 in one branch of the river network taking the laplace transform of this equation gives eq 7 which is a nonhomogeneous ode with two general and particular solutions the general solution to eq 7 is obtained by assuming ψ ij x s 0 in the homogeneous state and finding its roots for s 0 the particular solution is determined using the variation of parameters technique lagrange approach the general solution to the nonhomogeneous equation eq 7 is given by 9 c ij x s b 1 e v ij a ij s 2 d ij x b 2 e v ij a ij s 2 d ij x g x s ψ ij y s in which 10 α ij s δ v ij 2 4 d ij s k ij in eq 9 b 1 and b 2 are the constant coefficients in the general solution to eq 7 furthermore g x s ψ ij y s is the particular solution of eq 7 by considering two dimensionless ratios of θ ij v ij l ij 2 d ij and ξ ij s α ij s l ij 2 d ij heaton et al 2012 the particular solution for each branch ij is expressed as follows 11 g x s ψ ij y s e θ ij ξ ij s x l ij a ij s 0 x e ξ ij s θ ij y l ij ψ ij y s d y e θ ij ξ ij s x l ij a ij s 0 x e ξ ij s θ ij y l ij ψ ij y s d y by considering φ ij x s f ij x ψ ij x s and the separability property of the integral of summing two functions eq 11 can be rewritten as eq 12 12 g x s q ij y s f ij y e θ ij ξ ij s x l ij a ij s 0 x e ξ ij s θ ij y l ij φ ij y s d y e θ ij ξ ij s x l ij a ij s 0 x e ξ ij s θ ij y l ij φ ij y s d y i e θ ij ξ ij s x l ij a ij s 0 x e ξ ij s θ ij y l ij f ij y d y e θ ij ξ ij s x l ij a ij s 0 x e ξ ij s θ ij y l ij f ij y d y i i where the first part is related to the effect of the source term and the second one to the effect of the initial condition using eq 6 laplace transform of boundary conditions at x 0 and x l ij and some algebraic operations gives constant coefficient b 1 and b 2 as 13 b 1 c j s e θ ij c i s e ξ ij s e ξ ij s e ξ ij s η ij s a ij s and similarly 14 b 2 c i s e ξ ij s c j s e θ ij e ξ ij s e ξ ij s η ij s a ij s in which 15 η ij s a ij s e θ ij g l ij s φ ij y s f ij y e ξ ij s e ξ ij s by substituting eqs 13 and 14 into eq 9 the pollutant concentration function c ij x s for a branch of the river network is defined as 16 c ij x s c j s e θ ij c i s e ξ ij s e ξ ij s e ξ ij s η ij s a ij s e θ ij ξ ij s x l ij c i s e ξ ij s c j s e θ ij e ξ ij s e ξ ij s η ij s a ij s e θ ij ξ ij s x l ij g x s φ ij y s f ij y where c ij x s is the pollutant concentration function in terms of the position variable and s is the laplace variable for a river branch after analytically solving ade in the presence of reaction and source terms for a branch the mass balance equation is applied to extend the obtained solution to the entire river network this equation is based on physical principles and includes advection and dispersion loadings for this purpose regarding eq 8 laplace transform of mass balance equation and continuous variations of the concentration at each branch of the river network the mass balance for calculating concentration can be derived for each connection node in the river network this can be done by substituting the pollutant concentration function of a single branch eq 16 into eq 8 therefore by considering eq 16 and applying the required changes to substitute it into eq 8 the following equations are obtained 17 d ij d c ij x s dx x 0 v ij a ij s 2 c j s e θ ij c i s e ξ ij s e ξ ij s e ξ ij s v ij a ij s 2 c i s e ξ ij s c j s e θ ij e ξ ij s e ξ ij s η ij s v ij c ij 0 s v ij c j s e θ ij c i s e ξ ij s e ξ ij s e ξ ij s v ij c i s e ξ ij s c j s e θ ij e ξ ij s e ξ ij s by substituting eq 17 into eq 8 the equation for net pollutant flow out of node i mass balance in the river network is obtained as follows 18 w i s j a ij η ij s j a ij c i s v ij 2 e ξ ij s e ξ ij s e ξ ij s e ξ ij s α ij s 2 c j s α ij s e θ ij e ξ ij s e ξ ij s the final form of this equation is rewritten as 19 γ i s j a ij c i s v ij 2 e ξ ij s e ξ ij s e ξ ij s e ξ ij s α ij s 2 a ij c j s α ij s e θ ij e ξ ij s e ξ ij s eq 19 demonstrates the general form of calculated mass balance along with the effects of advection and dispersion for each node in different river networks in terms of s for a specific river network by writing eq 19 for each node some linear relationships in terms of s and unknowns c 1 s c 2 s c n 1 s c n s where n is the number of nodes arise which can be expressed as a system of nonlinear algebraic equations heaton et al 2012 therefore it can be said that 20 r s c s γ s in which 21 γ i s w i s j a ij η ij s 22 r ij s k a ik v ik 2 e ξ ik s e ξ ik s e ξ ik s e ξ ik s α ik s 2 i j a ij α ij s e θ ij e ξ ij s e ξ ij s o t h e r w i s e in eq 20 c s r s and γ s are matrices for the concentration of unknown nodes diffusion and the output pollutant flux considering the effect of source term and initial conditions respectively all are expressed in terms of laplace variable s based on eq 20 indicating a system of equations c s and γ s are single column vectors while r s is an n n sparse matrix in which the diagonal elements are all positive and are calculated by the upper formula in eq 22 moreover if there is no connection between i and j its entries will be zero and if there is its entries will be negative and calculated by the lower formula in eq 22 in eq 21 the term j a ij η ij s affects the source term and initial condition of the river network the mentioned term as an integral formula enters the calculation steps by solving the nonhomogeneous ode eq 7 and through its particular solution if the effects of source term and initial condition are neglected we have γ i s w i s by directly calculating matrices γ s and r s c s can be derived through numerical solution methods for the system of nonlinear algebraic equations finally the numerical inverse laplace transforms can be applied to find values of c 1 t c 2 t c n 1 t and c n t different algorithms are presented for the numerical inverse laplace transforms abate et al 1996 abate et al 2000 abate whitt 2006 kuhlman 2013 wang zhan 2015 this study uses concentrated matrix exponential cme distributions due to their higher accuracy and lower computation time than other methods the cme functions are detailed in horváth et al 2020 the semi analytical solution obtained for the river network with constant coefficients is applied for modeling the pollutant transport with variable coefficients the river length is divided into small intervals to increase the number of nodes in the river network the method of dividing the domain length into smaller intervals and considering individual values of velocity dispersion coefficient reaction decay coefficient and flow cross section area for each interval has also been used for porous media carr 2020 liu et al 1998 therefore every interval across the river network will possess different values of said variables finally the values mentioned above and the connection matrix of intervals are put into the model as inputs after calculating the diffusion matrix and solving the system of equations the concentration of each node is determined 2 2 river network analytical modeling in order to simulate a river network using the existing semi analytical method a set of data is required as input this data includes the branch connection flow velocity dispersion coefficient reaction decay coefficient river length and flow cross section area matrices as well as pollutant concentration patterns entering from boundaries the connection matrix as the most critical input data is an n n matrix in which entries are 0 or 1 in other words if there is a connection between nodes the value of the entry related to the two nodes will be 1 and if there is no connection the related entry will be 0 it is worth mentioning that all other input matrices are filled and valued according to the connection matrix fig 2 shows the general flowchart of the river network modeling 2 3 verification this study uses a numerical solution to verify the proposed semi analytical solution the numerical solution is presented through the finite difference method of a semi implicit type in the time and a central pattern in the space to mitigate numerical dispersion the finite difference scheme is calculated considering the mass balance equation input and output mass flux to a control volume around grid node i in the considered control volume box two input and output boundaries control levels are named i 1 2 and i 1 2 respectively therefore the main equations of mass balance and pollutant transport are discretized as follows 23 δ v i n 1 2 c i n 1 c i n δ t f i 1 2 n 1 2 f i 1 2 n 1 2 q n 1 2 φ q n 1 2 δ v i n 1 2 k c i n 24 f i 1 2 n 1 2 q i 1 2 n 1 2 c i 1 2 ad i 1 2 n 1 2 c i 1 n 1 2 c i n 1 2 δ x f i 1 2 n 1 2 q i 1 2 n 1 2 c i 1 2 ad i 1 2 n 1 2 c i n 1 2 c i 1 n 1 2 δ x in eq 23 c is the pollution concentration δ v is the control volume f is the transport mass flux q is the lateral discharge of the incoming pollution flow φ q is the source term k is the reaction decay coefficient and n is the time level in eq 24 q is the flow discharge a is the flow cross section area d is the dispersion coefficient and c is the interpolated concentration substituting and rewriting the above eqs for all discrete nodes of a branch a general form for the finite difference equation is obtained for three nodes in the network and each time level which is as follows 25 λ i c i 1 n 1 β i c i n 1 γ i c i 1 n 1 τ i by forming the discretized equations for all branches and generalizing them using the mass balance equation a system of linear algebraic equations is formed for the entire river network after applying the branches inlet and outlet boundary conditions and the mass conservation equation at the connection points of the network the concentration value at all unknown nodes in the river network is obtained by solving the algebraic equations 3 results and discussion this section examines the proposed semi analytical solution with four practical examples table 1 introduces test cases their general characteristics and their design goal for validating their analytical solution of the ade many researchers have used other analytical solutions carr 2020 jaiswal et al 2022 mazaheri et al 2013 sanskrityayn et al 2017 shukla 2002 suk 2016 yates 1990 in the absence of analytical solutions the field and experimental data amiri et al 2021 yang et al 2019 and numerical methods have been used carr 2020 chen et al 2008 chen liu 2011 jaiswal et al 2022 sanskrityayn et al 2017 suk 2016 yadav roy 2022 since there is no single analytical solution for the adre governing a river network in the literature numerical solutions are employed to verify and validate the proposed semi analytical solution vice versa analytical solutions can be used to validate numerical solutions and predict pollutant concentration patterns genuchten et al 2013 park zhan 2001 pérez guerrero et al 2009b pérez guerrero et al 2010 the details of the numerical solution to validate the proposed semi analytical solution are given in section 2 3 in the following the statistical error metrics such as coefficient of determination r 2 mean absolute error mae and root mean square error rmse are employed to compare the semi analytical and numerical solutions in test cases 1 2 and 3 the obtained results will be further discussed 3 1 first test case modeling an arbitrary branch type river network with constant coefficients in the first example the applicability and efficiency of the proposed semi analytical solution are evaluated by considering a branch type river network as shown in fig 3 three aspects follow this evaluation 1 simulating the branch type river network fig 3 for variable pollution patterns at boundary conditions and comparing results with the numerical solution 2 examining and comparing the effect of source and branch in the main branch of the river network for two cases firstly the pollution resulting from sub branches enters the main branch in the form of some sources meaning that there are sources instead of branches secondly the sub branches are connected to the main branch meaning the network itself 3 the third evaluation models the effect of the dispersion mechanism originating from the main branch on the sub branches for this purpose the input concentration from the upstream boundaries of sub branches is insignificant and pollutants only enter from the upstream boundary of the main branch in the first step each node was defined and its flow direction was specified the slope is presumed to be 0 0001 for all network branches flow geometric and pollutant characteristics in the intended network are presented in table 2 and their values are given to the model as matrices with specified entries then simulations are performed with variable pollution patterns at boundary conditions to achieve the three goals of this test case the first evaluation models a branch type river network with constant coefficients and complicated pollution patterns entering from boundaries the total modeling time is assumed to be 12 h and the inlet concentrations at nodes 1 2 and 3 are according to figs 4 6 respectively moreover the second scenario modeling results at dimensionless times of 0 42 and 0 6 for 356 1456 and 2456 paths are demonstrated in fig 7 as shown in fig 7 the ingoing pollutants enter the branch type network from boundaries 1 2 and 3 with time dependent irregular patterns as the pollution spreading is not constant and continuous it leaves the domain as time passes in path 356 the pollution enters the path with a time dependent irregular triangular pattern and two concentration peaks at time 0 42 the concentration decreases due to the delay of the second peak of branch 35 and the concentration resulting from branch 45 in chainage 0 5 as time passes at time 0 6 the concentration increases because of the resultant positive concentration of branch 45 and the ingoing second concentration peak of branch 35 the pollution then goes out of the system gradually in path 1456 the pollution enters the intended path with a time dependent irregular triangular pattern as two concentration peaks from the upstream boundary of node 1 at time 0 42 the concentration decreases in chainages 0 4 and 0 66 due to the delay of concentration input from the sub branch 24 as time passes at time 0 6 the concentration increases because of the resultant positive concentration resulting from branches 24 and 35 and finally leaves the network for path 2456 the pollution first enters from boundary 2 with a time dependent irregular triangular pattern and a single concentration peak over time the concentration increases ahead of the path under the resultant positive concentration originating from branches 14 and 35 in chainages 0 3 and 0 6 finally the pollutant leaves the network some advantages of this method over ones based on numerical discretization i g kilic aral 2009 zhang et al 2008 are the lack of limitations due to the stability condition and selection of proper spatial and time steps and no numerical dispersion errors therefore analytical methods are accurate and can be used as a tool to validate the numerical solutions of the pollutant transport equation pérez guerrero et al 2009b pérez guerrero et al 2010 as shown in fig 7 several factors cause the resultant pollutant concentration due to positive loading to be positive or negative such factors include flow cross section area and flow discharge of each branch this causes the decreasing or increasing variation of concentration at connection nodes as shown in fig 7 there is good agreement between the numerical and semi analytical solutions which is evident based on statistical error metrics calculated for both solutions in table 3 based on fig 3 there is little difference between the analytical and numerical results in path 1456 at time 0 42 and chainage 0 3 and path 356 at time 0 6 and chainage 0 4 any discrepancies are caused by common numerical errors due to numerical dispersion rounding off and truncating taylor expansion terms as mentioned above these differences can be neglected against statistical errors calculated in table 3 moreover based on the mass balance equation eq 4 a tiny error appears in mass balance calculations resulting from the use of numerical inverse laplace transforms which can be disregarded for example values of rmse and mae for the mass balance calculations in the river network fig 3 are 0 0197 and 0 0132 kg s for node 4 and 0 0157 and 0 0105 kg s for node 5 respectively in the second evaluation the effect of the source and branch in main river 1456 is examined for a time dependent pollution pattern typically the advection phenomenon is dominant for pollutant transport in rivers but the dispersion is also influential chapra 2008 nevertheless it has been proved that pollutants are mainly transported by dispersion mechanisms in massive rivers with low flow velocity ji 2017 if the time dependent pollution pattern is the constant input the role of the dispersion coefficient is mostly insignificant however if the pollutant concentration variation is the input variable errors due to neglecting the dispersion coefficient will depend on the intensity of the pollution pattern function gandolfi et al 2001 therefore in the branch type river network of fig 3 sub branches enter river 1456 at distances of 5 and 8 km as point source terms instead of connecting to the main river 1456 this case is compared with the initial state of the river network in path 1456 considering the point source term in governing equations is expressed as follows 26 φ ij x t δ ij x x i g ij t where δ x x i is dirac s delta function at point x i and g t is the time function of pollutant concentration due to the point source term taking laplace transform of both sides in eq 26 gives 27 φ ij x t δ ij x x i g ij s by substituting eq 27 as φ ij y s into eq 12 and calculating η ij s from eq 15 the pollution due to the point source term is modeled by eqs 19 22 for the second simulation the total time of simulation is assumed to be the same 12 h and the input concentration pattern in node 1 is according to fig 4 based on the pollution patterns in figs 5 and 6 pollutants enter the main river as point sources from nodes 2 and 3 the analytical simulation results are presented in fig 8 in this figure we examine the effect of the source and branch in the main river 1456 at two dimensionless times of 0 4 and 0 5 as well as time dependent pollution patterns at boundary conditions table 4 demonstrates calculated error indices for two cases of source and branch in main river 1456 table 4 demonstrates calculated error indices for two cases of source and branch in main river 1456 as illustrated in fig 8 the concentration variation is meaningfully different between the branch and source cases in the main river 1456 at time 0 4 in chainages 0 4 and 0 7 and at time 0 5 in chainages 0 7 to 1 albeit this discrepancy is lower in the input source of node 4 in chainage 0 4 than in the input source of node 5 because of the lower pollutant concentration in this source the concentration difference between the source and branch cases results from the dispersion phenomenon in the system this is because when the sub branches enter the main river 1456 as sources there is no dispersion mechanism and intended pollutant sources enter the system with only an advection mechanism however when sub branches are connected to the main river 1456 as branches the dispersion mechanism will be effective besides advection all mentioned above is the main reason for the discrepancy between spatial profiles of the branch and source cases the effect of the dispersion process in the sub branches is examined in the third evaluation therefore suppose that pollution contributed by sub branches boundaries 2 and 3 is zero and the only pollution source enters from the boundary of node 1 with the same pattern as fig 4 in this situation pollutants entering sub branches 24 and 35 from the main branch 1456 are examined fig 9 indicates the results for sub branch 24 at times 0 41 0 51 and 0 625 and sub branch 35 at times 0 49 0 6 and 0 67 as seen in fig 9 the variation trend of backflow concentration in branches 24 and 35 conforms to the input pollution pattern in node 1 as the input pollutant concentration pattern in node 1 has two peaks the concentration in sub branches 24 and 35 increases at times 0 41 and 0 51 and decreases at 0 65 then as time passes the concentration in these branches becomes zero according to the pollutant concentration pattern in the main river node 1 it should be noted that if the input pollution pattern of main branch 1456 is constant the backflow concentration in sub branches will not become zero over time since the dispersion coefficient of sub branch 35 25 m2 s is higher than sub branch 24 17 m2 s according to fig 9 the backflow concentration in branch 35 will be higher than in branch 24 the pattern magnitude and continuity of concentration in the main river as well as the dispersion coefficients of sub branches are essential factors of pollutant backflow from the main branch 1456 to sub branches 24 and 35 the higher these three factors the larger the pollutant amount transported from main river 1456 to sub branches 24 and 35 3 2 second test case modeling an arbitrary loop type river network with variable coefficients the second example demonstrates the use of the semi analytical method in a desired combined branch and loop type river network fig 10 with variable coefficients fig 10 illustrates the connection of four rivers 1 2 3 and 4 and the formation of the desired combined river network as shown in fig 10 rivers 1 2 3 and 4 consisting of paths 2 7 10 13 15 1 7 3 8 10 and 8 13 are divided into six 2 km three 1 km three 2 km and three 1 km intervals respectively node names and flow directions are specified in this network the variations of flow velocity flow cross section area and dispersion coefficient are presented in figs 11 13 respectively by dividing the length of rivers 1 to 4 into smaller intervals and averaging the velocity dispersion coefficient and flow cross section area figs 11 13 the characteristics of flow velocity geometry length slope and flow cross section area and pollutant dispersion coefficient are presented for each interval in table 5 for this modeling fig 10 the total simulation time is 12 h and figs 14 16 are used for the input pollutant concentration in nodes 1 2 and 3 respectively the analytical simulation results at two dimensionless times 0 42 and 0 7 for four assumed paths 1 7 10 13 15 2 7 10 13 15 3 8 10 13 15 and 3 8 13 15 are presented in fig 17 based on fig 17 the pollutants with irregular triangular patterns varying in time enter the combined branch type and loop type network from boundaries 1 2 and 3 since the pollution pattern is not constant and continuous pollutants leave the network over time as seen in fig 17 in path 1 7 10 13 15 the pollution with the mentioned pattern and two concentration peaks enters the path in chainage 0 3 the concentration decreases at time 0 42 due to the negative concentration wave from branch 2 7 as time passes when the second peak of pollutant concentration reaches node 1 the resultant concentration along the path increases at time 0 7 in chainage 0 3 and the pollution finally leaves the network in path 2 7 10 13 15 the pollutant with the mentioned pattern and one concentration peak enters the path the concentration increases at time 0 7 due to the amplifying concentration waves from branches 1 7 8 10 and 8 13 and leaves the network finally in path 3 8 10 13 15 the pollution with a similar pattern and two concentration peaks enters the path from node 3 as the resultant concentrations of branches 8 10 and 8 13 are the same the initial pattern enters branch 8 10 the concentration decreases in branch 10 13 due to the negative wave from branch 7 10 however immediately after the second concentration peak comes into the network from node 3 the resultant concentration of branches 10 13 and 13 15 is amplified near chainage 0 4 at time 0 7 and then leaves the network over time for path 3 8 13 15 the variation trend is similar to path 3 8 10 13 15 as shown in fig 17 an insignificant difference is observed between the numerical and semi analytical solutions profiles at chainages 0 2 0 3 and 0 4 0 6 in path 2 7 10 13 15 and at chainages 0 3 0 4 in path 3 8 13 15 resulting from the common numerical errors especially numerical dispersion on the other hand another factor causing this discrepancy between the two spatial profiles is the mass error from each branch this error in each path increases cumulatively by the mass errors of sub branches up to the outlet boundary however it can be said that the spatial profile obtained from the numerical simulation agrees with the semi analytical solution assuming variable coefficients for the pollutant transport equation this is evident from the statistical comparison of the semi analytical and numerical solutions for times 0 42 and 0 7 in table 6 therefore regarding this good agreement between the two numerical and semi analytical solutions in fig 17 it is obvious that the number of intervals and increased number of nodes are acceptable for modeling the pollutant transport with input pollution patterns from boundaries it is worth mentioning that an increasing number of intervals and middle nodes make results approach reality as much as possible 3 3 third test case modeling an arbitrary branch type river network considering point and distributed source terms with constant coefficients in the third example another application of the semi analytical solution is examined for modeling the presence of point and distributed pollutant sources simultaneously in the river network in this section according to fig 18 a branch type river network is considered for modeling in which node names and flow directions have been specified as shown in fig 18 this network has the main river path 134 and a sub branch path 23 connected to it all flow geometric and pollutant characteristics of this river network are demonstrated in table 7 these values must be given to the model as inputs in the form of matrices with given entries in all branches of the river network the slope is assumed to be 0 0001 according to fig 18 an active distributed pollutant source non point of length 200 m and distributed flow discharge of 10 m3 s m enter the network through the interval of 4 4 2 km in branch 13 moreover there is a point pollutant source in the sub branch with a flow discharge of 5 m3 s entering the river network in chainage 3 km from the upstream boundary of path 23 for modeling the river network of fig 18 the simulation time is assumed to be 12 h and the input pollutant concentration pattern in nodes 1 and 2 is illustrated in figs 19 and 20 respectively moreover the evacuated pollutant concentration pattern for distributed and point pollution sources is presented in figs 21 and 22 after simulation the spatial profiles of dimensionless concentration at two times 0 486 and 0 59 for two paths 134 and 234 are illustrated in fig 23 table 8 demonstrates the statistical comparison of the numerical and semi analytical solutions for the river network of fig 18 by presenting the error indices for both solutions as demonstrated in fig 23 since the pollution patterns considered for modeling are irregular and time dependent the pollution leaves the network over time in path 134 the pollution enters the path with a time dependent complicated concentration pattern initially a distributed pollution pattern through the source term with a flow discharge of 10 m3 s m and an incoming pollution pattern of sub branch branch 23 enter the system at chainages 0 4 0 42 and 0 6 respectively these sources initially increase the pollutant concentration in the path as time passes concentration decreases at two dimensionless times 0 486 and 0 59 in chainages 0 4 0 6 due to the resultant negative concentration of distributed source term and input pollution pattern of boundary 1 the concentration increases from chainage 0 6 onward because of input loading in sub branch 23 since the pollution pattern is time dependent the pollution leaves the network from the outlet boundary at the end for path 234 pollutants enter the path with the same pattern as mentioned above initially the pollutant concentration increases because of loadings originating from the point source term with flow discharge 5 m3 s and pollution pattern of sub branch 13 at chainages 0 375 and 0 5 respectively however as time passes the concentration decreases at time 0 486 and chainages 0 375 0 5 because of the resultant negative concentration due to the point source term and input pollution pattern of node 2 this descending trend continues from chainage 0 5 onward under the effect of a negative concentration wave from branch 13 after a while under the effect of a positive concentration wave at dimensionless time 0 59 and chainages 0 375 0 5 the pollutant concentration increases it then decreases due to the resultant negative concentration from branch 13 at last the concentration pattern leaves the system according to fig 23 the effects of point and distributed pollutant source terms can be seen at chainage 0 4 in path 134 and chainage 0 375 in path 234 at chainages 0 4 to 0 6 in path 134 there is somewhat of a negligible difference between the spatial profile of numerical and semi analytical solutions the reason for this is common numerical errors especially numerical dispersion another important reason for this difference is the mass error due to distributed source term resulting from the distributed input flow rate based on eq 4 due to the distributed flow discharge of 10 m3 s for 200 m length the mass error increases cumulatively and affects chainages from 0 42 onward however at chainage 0 375 in path 234 the difference in the spatial concentration between the numerical and semi analytical solutions is negligible finally it can be seen from eq 4 that the input loading resulting from the point pollutant source term causes lower mass error than the distributed pollutant source term due to the distributed input flow discharge however it can be noted that at each of the intended dimensionless times the spatial concentration profiles of the numerical and semi analytical solutions are almost the same for both paths 134 and 234 indicating the desirable performance and high potential of the proposed semi analytical solution moreover the conformance between the numerical and semi analytical solutions is evident based on statistical errors calculated in table 8 it is worth noting that ascending or descending trends of pollutant concentration at junction nodes of branches result from positive loading product of discharge in concentration from the sub branches in other words if the loading causes a resultant positive concentration the concentration increases and if it causes a negative resultant it decreases concentration at junction nodes 3 4 fourth test case modeling an arbitrary branch type river network under a dispersion dominant state considering a point source term the fourth example shows the application of the proposed semi analytical solution in modeling a branch type river network under dispersion dominant state by considering a point source of pollution downstream of a river network as seen in fig 2 the desired river network has a main path of 134 and a sub branch of 23 lengths of the branches flow cross section area and dispersion coefficient characteristics of this river network are demonstrated in table 9 according to fig 24 a point pollutant source at a distance of 40 m from node 3 sub branch connection to the main path enters branch 34 with a pollution pattern as shown in fig 14 and a flow discharge of 2 m3 s due to considering the dispersion dominant state in the entire network the velocity in all branches is negligible and equal to zero moreover from the upstream boundaries nodes 1 and 2 no pollutant concentration enters the network and only pollutant transport is done through the point source term with the dispersion mechanism in the river network the reason is considering the pollution transport conditions under the dispersion mechanism in the entire river network also the total simulation time is 12 h after the simulation the spatial profiles of the dimensionless concentration at two times 0 37 and 0 579 for two paths 134 and 234 are shown in fig 25 according to fig 25 in the situation where the dispersion phenomenon is more dominant than the advection phenomenon due to the effect of the dispersion mechanism the concentration of pollution in the river network moves both downstream and upstream as seen in fig 25 the pollutant concentration moves upstream in dimensionless time 0 579 more than time 0 37 moreover in this simulation the dispersion coefficient of the upstream branches is also influential since the dispersion coefficient of branch 23 25 m2 s is higher than sub branch 13 18 m2 s according to fig 25 in both dimensionless times the backflow concentration in branch 23 is higher than sub branch 13 therefore the higher the dispersion coefficient is considered in a river network the higher the backflow concentration is in the absence of the advection phenomenon 4 conclusion this study presented a semi analytical solution of the one dimensional advection dispersion equation considering source and reaction terms in various river networks in addition to modeling different river networks with constant coefficients velocity flow cross section area and dispersion the proposed method can simulate various river networks with variable coefficients it includes branch type and loop type networks moreover networks with variable coefficients can be simulated by increasing the number of middle nodes and dividing the length of the branch into smaller intervals among other applications of this semi analytical solution is pollution modeling in river networks in the presence of point and distributed pollutant source terms in this study it is concluded that 1 the proposed semi analytical method is adequate in simulating different river networks with complicated patterns for boundary conditions and source terms 2 the effect of the dispersion coefficient in a branch type river network is entirely evident when the sub branches enter the main river as pollutant source terms not connected to it as a branch and it is different from the state of a river network the concentration difference between the two cases results from the lack of dispersion mechanism in the case of assuming branches as sources another effect of the dispersion coefficient is the concentration backflow from the main river to its sub branches where the pollutant concentration is assumed insignificant 3 the loop type river network modeling has more complexities and difficulties than a branch type one so the proposed semi analytical method can resolve these issues 4 for modeling the pollutant transport with variable coefficients the higher the number of intervals and middle nodes the higher the accuracy and capability of the semi analytical method in simulating pollution 5 the proposed semi analytical method can be used for modeling the simultaneous presence of point and distributed pollutant sources in a river network 6 the proposed semi analytical method can be used to model the dispersion dominant phenomenon in the absence the advection phenomenon in river networks this method extracts the semi analytical solution of ade considering source and reaction terms based on the laplace transform besides excellent performance the laplace transform technique can solve partial differential equations including ade with source and reaction terms in a river network the most critical advantage of this technique is that it is more convenient than other analytical methods furthermore it needs no homogenous boundary conditions as opposed to other techniques such as the generalized and classical integral transform techniques amiri et al 2021 cotta 2020 cotta et al 2016 pérez guerrero et al 2009b pérez guerrero et al 2010 in addition to these advantages this method has some limitations as well said limitations are related to the inverse laplace transform as it is analytically impossible to obtain the inverse laplace transform of complex functions derived in terms of the laplace variable s hence numerical algorithms for inverse laplace transform must be applied that deliver high accuracy besides low computation time in this study concentrated matrix exponential functions horváth et al 2020 have resolved this problem the computational cost of the semi analytical method proposed for the river network is lower than the numerical methods however for more complicated and more extensive river networks the dimensions of input matrices including velocity and dispersion coefficient become larger as a result the system of governing equations will have more nonlinear algebraic equations causing the computational cost and time to increase compared to numerical methods this study demonstrated that the proposed semi analytical solution is in good agreement with numerical solutions evident from statistical error indices coefficient of determination root mean square error and mean absolute error calculated for both solutions therefore regarding the common errors in numerical solutions the proposed semi analytical method can be used to validate other numerical and analytical solutions in river networks because of its high accuracy and desirable performance for pollutant transport simulation in river networks declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129287 appendix a supplementary data the following are the supplementary data to this article supplementary video 1 supplementary video 2 supplementary video 3 supplementary video 4 supplementary video 5 supplementary video 6 supplementary video 7 supplementary video 8 supplementary video 9 supplementary video 10 supplementary video 11 supplementary video 12 
2113,this study proposes a semi analytical solution to a one dimensional advection dispersion equation considering reaction and source terms to predict and describe pollutant transport in various river networks using the laplace transform approach moreover the proposed semi analytical solution is expanded for variable coefficients of the transport equation by increasing the number of middle nodes and associated intervals the presented method solves the mass transport equation by considering advection and dispersion phenomena for one branch of the river network the final mass balance equation is thus obtained in different types of river networks for each node regarding the connection matrix the matrices of the characteristics of flow pollutant and network geometry are first determined as the model inputs then by considering the diffusion and final mass conservation laplace transform of mass balance equation equations for each node in the arbitrary river network the mass balance and diffusion matrices are calculated in terms of the laplace variable s thus a complex system of nonlinear algebraic equations is produced in terms of s which can be solved using inverse laplace algorithms to determine the concentration value at every node the present study introduces four practical scenarios of pollutant transport in river networks in order to evaluate the proposed semi analytical solution the first is a branch type river network with constant coefficients the second case is a loop type river network with variable coefficients the third case simultaneously considers a point pollutant source and a distributed pollutant source in a branch type river network the fourth case is a branch type river network under the dispersion dominant phenomenon with a point source results show that the proposed semi analytical solution is adequately capable of modeling pollutant transport and indicating its critical features in complex states of various river networks moreover exploring the literature shows that no analytical solution has been introduced for river networks before undertaking the present study keywords semi analytical solution advection dispersion equation river network point and distributed source terms laplace transform method data availability no data was used for the research described in the article 1 introduction river networks mainly consist of different river branches and fixed connection nodes based on the ground topography dietrich et al 1993 garbin et al 2019 mark 1988 montgomery and foufoula georgiou 1993 tarboton et al 1991 these networks are defined as a non annular directed graph heckmann et al 2015 peckham gupta 1999 and there are upstream and downstream nodes between each connection of river branches lindsay et al 2019 the environmental performance of river networks can be considerably weakened by inappropriate hydraulic conditions challenging all living aquatic organisms such as fish campbell et al 2015 garbin et al 2019 lazzaro et al 2017 sarremejane et al 2017 therefore the pollution issue in a river network has extremely harmful effects on humans the environment and primarily freshwater fish master et al 1998 matthews 2012 rodriguez iturbe et al 2009 additionally it paves the way for spreading dangerous diseases through the water codeço 2001 pascual et al 2002 rinaldo et al 2018 rodriguez iturbe et al 2009 removing pollution from a river network imposes much higher costs than a single branch hence a mathematical model can be crucial in predicting and controlling pollution in a river network the pollutant transport modeling in a river network is conducted using the mass transport equation particularly the advection dispersion equation ade the ade is a linear differential equation with parabolic partial derivatives concerning space and time the mentioned equation is derived from fick s law which gives the spatial and temporal distribution function of pollutant concentration chapra 2008 fischer et al 1979 mass transport for a pollutant depends on factors such as flow patterns in the system and the extent of pollutant dispersion this variable can be determined through direct calculation numerical or analytical solution of ade and employing ade coefficients for a general process taylor krishna 1993 welty et al 2020 for a river network it is unfeasible to use two and three dimensional models of the advection dispersion reaction equation adre due to the long computation time and lack of sufficient data for validation therefore a 1 d model is recommended for predicting the pollutant concentration in a river network launay et al 2015 leibundgut et al 2009 however research has proved that it is difficult to determine an analytical solution for ade considering source and reaction terms kim 2020 moranda et al 2018 parhizi et al 2022 nowadays analytical solutions are applied in different scientific and engineering fields including mass transport heat transfer pollutant dispersion in aquatic atmospheric air and soil environments amiri et al 2021 javandel et al 1984 jury et al 1983 leij et al 1991 mazaheri et al 2013 pérez guerrero et al 2009a quezada et al 2004 van genuchten 1981 there are several benefits to the application of analytical solutions in solving pollutant transport problems such as the possibility of scenario modeling and pollution analysis for better management accurate sensitivity analysis of mass transport parameters or different pollutant transport processes and extrapolation over long times and distances the mentioned above are not possibly be examined by numerical solutions mazaheri et al 2013 pérez guerrero et al 2009a moreover other limitations of numerical solutions in pollutant transport modeling include the stability conditions difficulties in selecting proper spatial and time steps high time consumption and high computation costs amiri et al 2021 mazaheri et al 2013 moreover the analytical solution delivers more accuracy for mass transport calculations and can be used as a tool for screening and verifying numerical solutions amiri et al 2021 basha el habel 1993 mazaheri et al 2013 pérez guerrero et al 2009a yates 1990 zoppou knight 1999 analytical methods such as the fourier transform green s function generalized integral transform technique gitt laplace transform and hankel transformation are most commonly used for solving ade chen et al 2011 leij et al 1991 leij et al 1993 massabó et al 2006 park zhan 2001 xu meakin 2013 green s function is a practical method for solving ade of one two and three dimensional states in finite semi finite and infinite domains leij van genuchten 2000 gitt is based on eigenfunctions and applied to solving partial differential equations with complicated boundary conditions and solution domains cotta 2020 cotta et al 2016 leij et al 1993 the laplace transform is a robust analytical method for solving pollutant transport problems with various dirichlet newman and robin boundary conditions this method can be employed for problems with multiple pollutant sources besides considering the exponential dependency at the initial time clement 2001 srinivasan clement 2008a srinivasan clement 2008b based on previously conducted studies a multitude of analytical solutions have been presented for the 1 d pollutant transport equation in porous media kumar yadav 2015 pérez guerrero et al 2013 selvadurai 2004 su et al 2005 van genuchten alves 1982 groundwater jaiswal et al 2022 sanskrityayn et al 2018b and limitedly in rivers adrian et al 1994 fischer et al 1979 genuchten et al 2013 shukla 2002 zoppou knight 1999 first the analytical solution of the 1 d pollutant transport equation is derived from its simplest form involving temporal advection and dispersion terms with constant coefficients leij van genuchten 1995 to this end yang et al 2019 developed the ade with constant coefficients and converted it to the conformable advection dispersion equation cade for a more accurate and actual prediction of solute transport the variable coefficients have received more attention than the constant coefficients in the ade for this purpose dimensionless numbers especially the peclet number are extensively used to convert the variable coefficients to constant coefficients bharati et al 2017 bharati et al 2018 bharati et al 2019 singh et al 2009 in the definition of variable coefficients for velocity and dispersion in some cases the dispersion coefficient is considered proportional to the squared velocity kumar et al 2009 kumar et al 2010 yadav roy 2022 later scholars added the reaction term to the analytical solution of the 1 d solute transport equation and solved adre with constant coefficients chen liu 2011 simpson ellery 2014 williams tomasko 2008 pérez guerrero et al 2009b 2010 showed the effect of multi species pollutant transport with consecutive first order reactions in a homogenous porous medium for this purpose they considered two boundary conditions of the third type with constant value and function of time mazaheri et al 2013 used the superposition principle to examine the effect of the reaction decay coefficient in a river with several pulsating point pollutant sources some other analytical solutions for 1 d adre are obtained using variable coefficients yates 1992 zamani bombardelli 2014 in this case variable coefficients are used to accurately describe multi species solute transport with consecutive first order reactions for a saturated aquifer suk 2016 you zhan 2013 developed the adre with variable coefficients for a double layer porous medium analytically under more complicated conditions in some cases the reaction term is neglected in the analytical solution of the 1 d pollutant transport equation by considering the source term instead the solution of the advection dispersion source equation adse with variable coefficients is derived analytically sanskrityayn et al 2021 in this regard sanskrityayn et al 2017 demonstrated the effect of the source term in groundwater and river environments by two forms of instant and continuous point injection in an infinite domain they extended their solutions for variable velocity and dispersion coefficients with spatial and temporal dependencies when the spatial and temporal dependencies of velocity are non degenerate the solutes transport faster in d v 2 compared to d v for both continuous and instant point sources sanskrityayn et al 2018a finally the complete form of the pollutant transport equation was analytically solved by considering advection dispersion reaction and source terms with constant coefficients chen et al 2017 and variable coefficients amiri et al 2021 basha el habel 1993 most studies are conducted in porous media groundwater and river environments and the number of studies on river networks is limited most investigations related to mathematical pollution modeling with a direct solution of ade have been performed for a river network by numerically solving the pollutant transport equation according to our knowledge there has been no comprehensive analytical solution for this equation s application in river networks thus far however according to our knowledge there has been no comprehensive analytical solution for this equation s application in river networks thus far however there are network oriented analytical solutions for biological problems ramirez 2012 or pollution transport problems with simple assumptions and simulations fardadi shilsar et al 2022a fardadi shilsar et al 2022b in river networks biomedical problems zimmerman tartakovsky 2020 and nutrient transport in mycelium fungal networks heaton et al 2012 as well as physical problems koplik et al 1988 koplik et al 1988 studied the transport of a neutral tracker in a random network of pipes in a porous medium using the mass transport equation they solved the mass transport equation analytically by considering the constant boundary conditions at nodes and disregarding the initial conditions ramirez 2012 modeled the population of living organisms in a branch type river network utilizing the mass transport equation temporally and spatially they used proper boundary conditions at output nodes and the network upstream heaton et al 2012 solved the mass transport equation by incorporating amino acids as the input nutrient in a mycelium fungal network and examined how nutrients move from an inlet boundary toward all branches and nervures using the radio tracking test zimmerman tartakovsky 2020 presented an analytical solution for the solute transport equation in vessels as a bifurcated fractal network first they derived their solution for individual vessels they then extended their solution to a bifurcating fractal tree model by linking the solutions of the single vessel to each other furthermore some researchers utilized non analytical approaches for modeling pollutant transport in the river network zhang et al 2008 proposed a hydrodynamic and qualitative model based on the river connection type using the finite difference method for the colombia river network in the united states kilic aral 2009 presented a new method based on the fugacity instability approach and numerical discretization of the pollutant transport equation they presented concentration results as spatial profiles and time series for the altamaha river deng 2019 investigated the relationship between the water quality and network connection structure with gray relational analysis gra and examined spatial concentration pattern maps with gis software for the jiang su plain diamantini et al 2019 employed the lagrange approach for a river branch they then extended it to the entire river network to evaluate the concentration of five irremovable pollutant sources in water treatment facilities of the adige river network the mentioned studies use numerical and statistical approaches to modeling river network pollution due to the complicated nature of river networks no analytical solution has yet been proposed for the 1 d ade by considering the source and reaction terms to calculate the spatial and temporal distributions of pollutants furthermore most analytical solutions have been presented for only one river branch as opposed to entire river networks however other studies have attempted to solve the mass transport equation in botanical networks heaton et al 2012 a porous media network koplik et al 1988 a porous media biomedical network zimmerman tartakovsky 2020 and a river network ramirez 2012 the present study has several advantages over the four as follows 1 in these studies the source term has not been considered in the mass transport equation one strength of this study is the addition of various source terms point and distributed to the mass transport equation additionally ramirez 2012 and zimmerman tartakovsky 2020 considered no reaction term in the mass transport equation and solved the simplest form 2 in the discussed works only branch type networks have been modeled while the present study models the loop type network in addition to the branch type for the loop type modeling is much more complicated for example zimmerman tartakovsky 2020 only modeled branch type networks as bifurcating networks in discussing solute transport in vessels 3 in the four studies the analytical solution of the transport equation and its simulation have been presented with constant coefficients in contrast this study analytically solves and expands the mass transport equation and simulates it not only with constant coefficients but also the variable ones 4 in studies by koplik et al 1988 heaton et al 2012 and zimmerman tartakovsky 2020 only one inlet and multiple outlet boundaries were considered for the network heaton et al 2012 examined the solute transport from the inlet boundary in nervures while this study assumes that pollutants enter from several inlet boundaries and exit from a single outlet the present study aims to derive a complete semi analytical solution for the one dimensional advection dispersion equation by considering the reaction and source terms in different river networks to this end this study utilizes the laplace transform method under the initial condition and dirichlet boundary conditions at inlets and outlets for solving the governing equation then the semi analytical solution is compared to the numerical solution for validation in the following to demonstrate the application of the semi analytical solution pollutant transport modeling is performed for four test cases including branch type combined branch and loop type and branch type river networks in the presence of source terms and under the dispersion dominant phenomenon 2 theoretical principle and methods 2 1 mathematical model due to its simplicity the laplace transform is one of the oldest and most prevalent analytical methods for solving partial differential equations this robust and suitable tool is closely related to the complex fourier transform therefore the fourier transform can be used to define laplace transform myint u debnath 2007 some strengths of this method are as follows a it directly solves problems meaning that it can easily be applied to initial value problems b it solves nonhomogeneous ordinary differential equations without having to first convert them into homogeneous differential equations and c the most critical benefit is related to heaviside and dirac delta functions which simplify the use of this method in the presence of complicated source terms kreyszig 2009 advection and dispersion are critical processes in mass transport gulliver 2007 for modeling purposes in this study input pollutant sources are assumed to move under the main mechanisms described above and are dispersed all around the network fig 1 shows a schematic of the branch type river network and the characteristics of one branch s inlet and outlet as can be seen node i is the inlet node upstream of the river branch j is the outlet node downstream of the river branch l ij is the length of one branch in the network k ij is the reaction decay coefficient v ij is the mean flow velocity in branch ij so that v ij v ij φ ij x t is the input source term in branch ij a ij is the flow cross section area and d ij is the dispersion coefficient along the x axis the one dimensional ade considering the source and reaction terms for one branch of a river network in the domain of 0 x l ij is defined as follows 1 c ij x t t d ij 2 c ij x t x 2 v ij c ij x t x k ij c ij x t φ ij x t in eq 1 c i j c ij x t m l 3 is the pollutant concentration function at location x and time t d ij l 2 t 1 is the longitudinal dispersion coefficient along the x axis v ij l t 1 is the flow velocity k ij is the reaction decay coefficient its dimension is a function of the degree of reaction and φ ij x t m l 3 t 1 is the source term in each branch ij in the mathematical form the initial condition at t 0 upstream boundary condition at x 0 and downstream boundary conditions at x l ij are expressed as follows 2 c ij x 0 f ij x 3 c ij 0 t c i t c ij l ij t c j t in eqs 2 and 3 f ij x is the pollutant concentration function for the initial condition c i t and c j t are time functions of dirichlet type boundary conditions for pollutant concentration upstream and downstream of the branch ij in the river network it should be noted that the upstream boundary condition can be considered as the third type robin type instead of the first type dirichlet type this case affects obtaining the constants of the ode after taking laplace of the ade and causes more complicated equations for them according to fick s law the mass balance equation resulting from the sum of loadings due to advection and dispersion processes and based on physical principles is expressed as follows from node i for some inlet branches 4 w i t j q ij c ij x t a ij d ij c ij x t x x 0 where q ij is the flow discharge of each branch and w i t is the net pollutant flow out of node i if node i is not an inlet node i e boundary points from which the pollution pattern enters the network the input source value to node i is equal to the value of remaining sources from node i therefore w i t 0 meaning that the mass balance is zero at nodes with unknown values it should be noted that the mass balance for nodes with known values is defined as w i t 0 moreover the mass balance equation assumes that mass transport mechanisms only include advection and dispersion this approach to expressing mass balance equations has been seen in other research works heaton et al 2012 koplik et al 1988 to solve ade in the presence of reaction and source terms eq 1 for 0 x l ij the laplace transform of eqs 1 and 3 respectively the main equation and its boundary conditions are taken with respect to the time variable t for this purpose 5 s c ij x s c ij x 0 k ij c ij x s v ij d c ij x s dx d ij d 2 c ij x s d x 2 φ ij x s 0 6 c ij 0 s c i s c ij l ij s c j s in eqs 5 and 6 c ij represents the dependent variable of eq 1 in the laplace domain and symbol s is the laplace variable from the initial condition of c ij x 0 f ij x and by assuming φ ij x s f ij x ψ ij x s eq 5 can be rewritten as follows 7 s k ij c ij v ij d c ij dx d ij d 2 c ij d x 2 ψ ij x s after taking the laplace transform of the main equation and related boundary conditions eqs 1 and 3 the laplace transform of eq 4 expressing the net pollutant flow out of node i mass balance is determined therefore 8 w i s j q ij c ij x s a ij d ij d c ij x s dx x 0 where w i s is the laplace transform of w i t representing the function of pollutant flux coming out of node i for the analytical solution of eq 1 in one branch of the river network taking the laplace transform of this equation gives eq 7 which is a nonhomogeneous ode with two general and particular solutions the general solution to eq 7 is obtained by assuming ψ ij x s 0 in the homogeneous state and finding its roots for s 0 the particular solution is determined using the variation of parameters technique lagrange approach the general solution to the nonhomogeneous equation eq 7 is given by 9 c ij x s b 1 e v ij a ij s 2 d ij x b 2 e v ij a ij s 2 d ij x g x s ψ ij y s in which 10 α ij s δ v ij 2 4 d ij s k ij in eq 9 b 1 and b 2 are the constant coefficients in the general solution to eq 7 furthermore g x s ψ ij y s is the particular solution of eq 7 by considering two dimensionless ratios of θ ij v ij l ij 2 d ij and ξ ij s α ij s l ij 2 d ij heaton et al 2012 the particular solution for each branch ij is expressed as follows 11 g x s ψ ij y s e θ ij ξ ij s x l ij a ij s 0 x e ξ ij s θ ij y l ij ψ ij y s d y e θ ij ξ ij s x l ij a ij s 0 x e ξ ij s θ ij y l ij ψ ij y s d y by considering φ ij x s f ij x ψ ij x s and the separability property of the integral of summing two functions eq 11 can be rewritten as eq 12 12 g x s q ij y s f ij y e θ ij ξ ij s x l ij a ij s 0 x e ξ ij s θ ij y l ij φ ij y s d y e θ ij ξ ij s x l ij a ij s 0 x e ξ ij s θ ij y l ij φ ij y s d y i e θ ij ξ ij s x l ij a ij s 0 x e ξ ij s θ ij y l ij f ij y d y e θ ij ξ ij s x l ij a ij s 0 x e ξ ij s θ ij y l ij f ij y d y i i where the first part is related to the effect of the source term and the second one to the effect of the initial condition using eq 6 laplace transform of boundary conditions at x 0 and x l ij and some algebraic operations gives constant coefficient b 1 and b 2 as 13 b 1 c j s e θ ij c i s e ξ ij s e ξ ij s e ξ ij s η ij s a ij s and similarly 14 b 2 c i s e ξ ij s c j s e θ ij e ξ ij s e ξ ij s η ij s a ij s in which 15 η ij s a ij s e θ ij g l ij s φ ij y s f ij y e ξ ij s e ξ ij s by substituting eqs 13 and 14 into eq 9 the pollutant concentration function c ij x s for a branch of the river network is defined as 16 c ij x s c j s e θ ij c i s e ξ ij s e ξ ij s e ξ ij s η ij s a ij s e θ ij ξ ij s x l ij c i s e ξ ij s c j s e θ ij e ξ ij s e ξ ij s η ij s a ij s e θ ij ξ ij s x l ij g x s φ ij y s f ij y where c ij x s is the pollutant concentration function in terms of the position variable and s is the laplace variable for a river branch after analytically solving ade in the presence of reaction and source terms for a branch the mass balance equation is applied to extend the obtained solution to the entire river network this equation is based on physical principles and includes advection and dispersion loadings for this purpose regarding eq 8 laplace transform of mass balance equation and continuous variations of the concentration at each branch of the river network the mass balance for calculating concentration can be derived for each connection node in the river network this can be done by substituting the pollutant concentration function of a single branch eq 16 into eq 8 therefore by considering eq 16 and applying the required changes to substitute it into eq 8 the following equations are obtained 17 d ij d c ij x s dx x 0 v ij a ij s 2 c j s e θ ij c i s e ξ ij s e ξ ij s e ξ ij s v ij a ij s 2 c i s e ξ ij s c j s e θ ij e ξ ij s e ξ ij s η ij s v ij c ij 0 s v ij c j s e θ ij c i s e ξ ij s e ξ ij s e ξ ij s v ij c i s e ξ ij s c j s e θ ij e ξ ij s e ξ ij s by substituting eq 17 into eq 8 the equation for net pollutant flow out of node i mass balance in the river network is obtained as follows 18 w i s j a ij η ij s j a ij c i s v ij 2 e ξ ij s e ξ ij s e ξ ij s e ξ ij s α ij s 2 c j s α ij s e θ ij e ξ ij s e ξ ij s the final form of this equation is rewritten as 19 γ i s j a ij c i s v ij 2 e ξ ij s e ξ ij s e ξ ij s e ξ ij s α ij s 2 a ij c j s α ij s e θ ij e ξ ij s e ξ ij s eq 19 demonstrates the general form of calculated mass balance along with the effects of advection and dispersion for each node in different river networks in terms of s for a specific river network by writing eq 19 for each node some linear relationships in terms of s and unknowns c 1 s c 2 s c n 1 s c n s where n is the number of nodes arise which can be expressed as a system of nonlinear algebraic equations heaton et al 2012 therefore it can be said that 20 r s c s γ s in which 21 γ i s w i s j a ij η ij s 22 r ij s k a ik v ik 2 e ξ ik s e ξ ik s e ξ ik s e ξ ik s α ik s 2 i j a ij α ij s e θ ij e ξ ij s e ξ ij s o t h e r w i s e in eq 20 c s r s and γ s are matrices for the concentration of unknown nodes diffusion and the output pollutant flux considering the effect of source term and initial conditions respectively all are expressed in terms of laplace variable s based on eq 20 indicating a system of equations c s and γ s are single column vectors while r s is an n n sparse matrix in which the diagonal elements are all positive and are calculated by the upper formula in eq 22 moreover if there is no connection between i and j its entries will be zero and if there is its entries will be negative and calculated by the lower formula in eq 22 in eq 21 the term j a ij η ij s affects the source term and initial condition of the river network the mentioned term as an integral formula enters the calculation steps by solving the nonhomogeneous ode eq 7 and through its particular solution if the effects of source term and initial condition are neglected we have γ i s w i s by directly calculating matrices γ s and r s c s can be derived through numerical solution methods for the system of nonlinear algebraic equations finally the numerical inverse laplace transforms can be applied to find values of c 1 t c 2 t c n 1 t and c n t different algorithms are presented for the numerical inverse laplace transforms abate et al 1996 abate et al 2000 abate whitt 2006 kuhlman 2013 wang zhan 2015 this study uses concentrated matrix exponential cme distributions due to their higher accuracy and lower computation time than other methods the cme functions are detailed in horváth et al 2020 the semi analytical solution obtained for the river network with constant coefficients is applied for modeling the pollutant transport with variable coefficients the river length is divided into small intervals to increase the number of nodes in the river network the method of dividing the domain length into smaller intervals and considering individual values of velocity dispersion coefficient reaction decay coefficient and flow cross section area for each interval has also been used for porous media carr 2020 liu et al 1998 therefore every interval across the river network will possess different values of said variables finally the values mentioned above and the connection matrix of intervals are put into the model as inputs after calculating the diffusion matrix and solving the system of equations the concentration of each node is determined 2 2 river network analytical modeling in order to simulate a river network using the existing semi analytical method a set of data is required as input this data includes the branch connection flow velocity dispersion coefficient reaction decay coefficient river length and flow cross section area matrices as well as pollutant concentration patterns entering from boundaries the connection matrix as the most critical input data is an n n matrix in which entries are 0 or 1 in other words if there is a connection between nodes the value of the entry related to the two nodes will be 1 and if there is no connection the related entry will be 0 it is worth mentioning that all other input matrices are filled and valued according to the connection matrix fig 2 shows the general flowchart of the river network modeling 2 3 verification this study uses a numerical solution to verify the proposed semi analytical solution the numerical solution is presented through the finite difference method of a semi implicit type in the time and a central pattern in the space to mitigate numerical dispersion the finite difference scheme is calculated considering the mass balance equation input and output mass flux to a control volume around grid node i in the considered control volume box two input and output boundaries control levels are named i 1 2 and i 1 2 respectively therefore the main equations of mass balance and pollutant transport are discretized as follows 23 δ v i n 1 2 c i n 1 c i n δ t f i 1 2 n 1 2 f i 1 2 n 1 2 q n 1 2 φ q n 1 2 δ v i n 1 2 k c i n 24 f i 1 2 n 1 2 q i 1 2 n 1 2 c i 1 2 ad i 1 2 n 1 2 c i 1 n 1 2 c i n 1 2 δ x f i 1 2 n 1 2 q i 1 2 n 1 2 c i 1 2 ad i 1 2 n 1 2 c i n 1 2 c i 1 n 1 2 δ x in eq 23 c is the pollution concentration δ v is the control volume f is the transport mass flux q is the lateral discharge of the incoming pollution flow φ q is the source term k is the reaction decay coefficient and n is the time level in eq 24 q is the flow discharge a is the flow cross section area d is the dispersion coefficient and c is the interpolated concentration substituting and rewriting the above eqs for all discrete nodes of a branch a general form for the finite difference equation is obtained for three nodes in the network and each time level which is as follows 25 λ i c i 1 n 1 β i c i n 1 γ i c i 1 n 1 τ i by forming the discretized equations for all branches and generalizing them using the mass balance equation a system of linear algebraic equations is formed for the entire river network after applying the branches inlet and outlet boundary conditions and the mass conservation equation at the connection points of the network the concentration value at all unknown nodes in the river network is obtained by solving the algebraic equations 3 results and discussion this section examines the proposed semi analytical solution with four practical examples table 1 introduces test cases their general characteristics and their design goal for validating their analytical solution of the ade many researchers have used other analytical solutions carr 2020 jaiswal et al 2022 mazaheri et al 2013 sanskrityayn et al 2017 shukla 2002 suk 2016 yates 1990 in the absence of analytical solutions the field and experimental data amiri et al 2021 yang et al 2019 and numerical methods have been used carr 2020 chen et al 2008 chen liu 2011 jaiswal et al 2022 sanskrityayn et al 2017 suk 2016 yadav roy 2022 since there is no single analytical solution for the adre governing a river network in the literature numerical solutions are employed to verify and validate the proposed semi analytical solution vice versa analytical solutions can be used to validate numerical solutions and predict pollutant concentration patterns genuchten et al 2013 park zhan 2001 pérez guerrero et al 2009b pérez guerrero et al 2010 the details of the numerical solution to validate the proposed semi analytical solution are given in section 2 3 in the following the statistical error metrics such as coefficient of determination r 2 mean absolute error mae and root mean square error rmse are employed to compare the semi analytical and numerical solutions in test cases 1 2 and 3 the obtained results will be further discussed 3 1 first test case modeling an arbitrary branch type river network with constant coefficients in the first example the applicability and efficiency of the proposed semi analytical solution are evaluated by considering a branch type river network as shown in fig 3 three aspects follow this evaluation 1 simulating the branch type river network fig 3 for variable pollution patterns at boundary conditions and comparing results with the numerical solution 2 examining and comparing the effect of source and branch in the main branch of the river network for two cases firstly the pollution resulting from sub branches enters the main branch in the form of some sources meaning that there are sources instead of branches secondly the sub branches are connected to the main branch meaning the network itself 3 the third evaluation models the effect of the dispersion mechanism originating from the main branch on the sub branches for this purpose the input concentration from the upstream boundaries of sub branches is insignificant and pollutants only enter from the upstream boundary of the main branch in the first step each node was defined and its flow direction was specified the slope is presumed to be 0 0001 for all network branches flow geometric and pollutant characteristics in the intended network are presented in table 2 and their values are given to the model as matrices with specified entries then simulations are performed with variable pollution patterns at boundary conditions to achieve the three goals of this test case the first evaluation models a branch type river network with constant coefficients and complicated pollution patterns entering from boundaries the total modeling time is assumed to be 12 h and the inlet concentrations at nodes 1 2 and 3 are according to figs 4 6 respectively moreover the second scenario modeling results at dimensionless times of 0 42 and 0 6 for 356 1456 and 2456 paths are demonstrated in fig 7 as shown in fig 7 the ingoing pollutants enter the branch type network from boundaries 1 2 and 3 with time dependent irregular patterns as the pollution spreading is not constant and continuous it leaves the domain as time passes in path 356 the pollution enters the path with a time dependent irregular triangular pattern and two concentration peaks at time 0 42 the concentration decreases due to the delay of the second peak of branch 35 and the concentration resulting from branch 45 in chainage 0 5 as time passes at time 0 6 the concentration increases because of the resultant positive concentration of branch 45 and the ingoing second concentration peak of branch 35 the pollution then goes out of the system gradually in path 1456 the pollution enters the intended path with a time dependent irregular triangular pattern as two concentration peaks from the upstream boundary of node 1 at time 0 42 the concentration decreases in chainages 0 4 and 0 66 due to the delay of concentration input from the sub branch 24 as time passes at time 0 6 the concentration increases because of the resultant positive concentration resulting from branches 24 and 35 and finally leaves the network for path 2456 the pollution first enters from boundary 2 with a time dependent irregular triangular pattern and a single concentration peak over time the concentration increases ahead of the path under the resultant positive concentration originating from branches 14 and 35 in chainages 0 3 and 0 6 finally the pollutant leaves the network some advantages of this method over ones based on numerical discretization i g kilic aral 2009 zhang et al 2008 are the lack of limitations due to the stability condition and selection of proper spatial and time steps and no numerical dispersion errors therefore analytical methods are accurate and can be used as a tool to validate the numerical solutions of the pollutant transport equation pérez guerrero et al 2009b pérez guerrero et al 2010 as shown in fig 7 several factors cause the resultant pollutant concentration due to positive loading to be positive or negative such factors include flow cross section area and flow discharge of each branch this causes the decreasing or increasing variation of concentration at connection nodes as shown in fig 7 there is good agreement between the numerical and semi analytical solutions which is evident based on statistical error metrics calculated for both solutions in table 3 based on fig 3 there is little difference between the analytical and numerical results in path 1456 at time 0 42 and chainage 0 3 and path 356 at time 0 6 and chainage 0 4 any discrepancies are caused by common numerical errors due to numerical dispersion rounding off and truncating taylor expansion terms as mentioned above these differences can be neglected against statistical errors calculated in table 3 moreover based on the mass balance equation eq 4 a tiny error appears in mass balance calculations resulting from the use of numerical inverse laplace transforms which can be disregarded for example values of rmse and mae for the mass balance calculations in the river network fig 3 are 0 0197 and 0 0132 kg s for node 4 and 0 0157 and 0 0105 kg s for node 5 respectively in the second evaluation the effect of the source and branch in main river 1456 is examined for a time dependent pollution pattern typically the advection phenomenon is dominant for pollutant transport in rivers but the dispersion is also influential chapra 2008 nevertheless it has been proved that pollutants are mainly transported by dispersion mechanisms in massive rivers with low flow velocity ji 2017 if the time dependent pollution pattern is the constant input the role of the dispersion coefficient is mostly insignificant however if the pollutant concentration variation is the input variable errors due to neglecting the dispersion coefficient will depend on the intensity of the pollution pattern function gandolfi et al 2001 therefore in the branch type river network of fig 3 sub branches enter river 1456 at distances of 5 and 8 km as point source terms instead of connecting to the main river 1456 this case is compared with the initial state of the river network in path 1456 considering the point source term in governing equations is expressed as follows 26 φ ij x t δ ij x x i g ij t where δ x x i is dirac s delta function at point x i and g t is the time function of pollutant concentration due to the point source term taking laplace transform of both sides in eq 26 gives 27 φ ij x t δ ij x x i g ij s by substituting eq 27 as φ ij y s into eq 12 and calculating η ij s from eq 15 the pollution due to the point source term is modeled by eqs 19 22 for the second simulation the total time of simulation is assumed to be the same 12 h and the input concentration pattern in node 1 is according to fig 4 based on the pollution patterns in figs 5 and 6 pollutants enter the main river as point sources from nodes 2 and 3 the analytical simulation results are presented in fig 8 in this figure we examine the effect of the source and branch in the main river 1456 at two dimensionless times of 0 4 and 0 5 as well as time dependent pollution patterns at boundary conditions table 4 demonstrates calculated error indices for two cases of source and branch in main river 1456 table 4 demonstrates calculated error indices for two cases of source and branch in main river 1456 as illustrated in fig 8 the concentration variation is meaningfully different between the branch and source cases in the main river 1456 at time 0 4 in chainages 0 4 and 0 7 and at time 0 5 in chainages 0 7 to 1 albeit this discrepancy is lower in the input source of node 4 in chainage 0 4 than in the input source of node 5 because of the lower pollutant concentration in this source the concentration difference between the source and branch cases results from the dispersion phenomenon in the system this is because when the sub branches enter the main river 1456 as sources there is no dispersion mechanism and intended pollutant sources enter the system with only an advection mechanism however when sub branches are connected to the main river 1456 as branches the dispersion mechanism will be effective besides advection all mentioned above is the main reason for the discrepancy between spatial profiles of the branch and source cases the effect of the dispersion process in the sub branches is examined in the third evaluation therefore suppose that pollution contributed by sub branches boundaries 2 and 3 is zero and the only pollution source enters from the boundary of node 1 with the same pattern as fig 4 in this situation pollutants entering sub branches 24 and 35 from the main branch 1456 are examined fig 9 indicates the results for sub branch 24 at times 0 41 0 51 and 0 625 and sub branch 35 at times 0 49 0 6 and 0 67 as seen in fig 9 the variation trend of backflow concentration in branches 24 and 35 conforms to the input pollution pattern in node 1 as the input pollutant concentration pattern in node 1 has two peaks the concentration in sub branches 24 and 35 increases at times 0 41 and 0 51 and decreases at 0 65 then as time passes the concentration in these branches becomes zero according to the pollutant concentration pattern in the main river node 1 it should be noted that if the input pollution pattern of main branch 1456 is constant the backflow concentration in sub branches will not become zero over time since the dispersion coefficient of sub branch 35 25 m2 s is higher than sub branch 24 17 m2 s according to fig 9 the backflow concentration in branch 35 will be higher than in branch 24 the pattern magnitude and continuity of concentration in the main river as well as the dispersion coefficients of sub branches are essential factors of pollutant backflow from the main branch 1456 to sub branches 24 and 35 the higher these three factors the larger the pollutant amount transported from main river 1456 to sub branches 24 and 35 3 2 second test case modeling an arbitrary loop type river network with variable coefficients the second example demonstrates the use of the semi analytical method in a desired combined branch and loop type river network fig 10 with variable coefficients fig 10 illustrates the connection of four rivers 1 2 3 and 4 and the formation of the desired combined river network as shown in fig 10 rivers 1 2 3 and 4 consisting of paths 2 7 10 13 15 1 7 3 8 10 and 8 13 are divided into six 2 km three 1 km three 2 km and three 1 km intervals respectively node names and flow directions are specified in this network the variations of flow velocity flow cross section area and dispersion coefficient are presented in figs 11 13 respectively by dividing the length of rivers 1 to 4 into smaller intervals and averaging the velocity dispersion coefficient and flow cross section area figs 11 13 the characteristics of flow velocity geometry length slope and flow cross section area and pollutant dispersion coefficient are presented for each interval in table 5 for this modeling fig 10 the total simulation time is 12 h and figs 14 16 are used for the input pollutant concentration in nodes 1 2 and 3 respectively the analytical simulation results at two dimensionless times 0 42 and 0 7 for four assumed paths 1 7 10 13 15 2 7 10 13 15 3 8 10 13 15 and 3 8 13 15 are presented in fig 17 based on fig 17 the pollutants with irregular triangular patterns varying in time enter the combined branch type and loop type network from boundaries 1 2 and 3 since the pollution pattern is not constant and continuous pollutants leave the network over time as seen in fig 17 in path 1 7 10 13 15 the pollution with the mentioned pattern and two concentration peaks enters the path in chainage 0 3 the concentration decreases at time 0 42 due to the negative concentration wave from branch 2 7 as time passes when the second peak of pollutant concentration reaches node 1 the resultant concentration along the path increases at time 0 7 in chainage 0 3 and the pollution finally leaves the network in path 2 7 10 13 15 the pollutant with the mentioned pattern and one concentration peak enters the path the concentration increases at time 0 7 due to the amplifying concentration waves from branches 1 7 8 10 and 8 13 and leaves the network finally in path 3 8 10 13 15 the pollution with a similar pattern and two concentration peaks enters the path from node 3 as the resultant concentrations of branches 8 10 and 8 13 are the same the initial pattern enters branch 8 10 the concentration decreases in branch 10 13 due to the negative wave from branch 7 10 however immediately after the second concentration peak comes into the network from node 3 the resultant concentration of branches 10 13 and 13 15 is amplified near chainage 0 4 at time 0 7 and then leaves the network over time for path 3 8 13 15 the variation trend is similar to path 3 8 10 13 15 as shown in fig 17 an insignificant difference is observed between the numerical and semi analytical solutions profiles at chainages 0 2 0 3 and 0 4 0 6 in path 2 7 10 13 15 and at chainages 0 3 0 4 in path 3 8 13 15 resulting from the common numerical errors especially numerical dispersion on the other hand another factor causing this discrepancy between the two spatial profiles is the mass error from each branch this error in each path increases cumulatively by the mass errors of sub branches up to the outlet boundary however it can be said that the spatial profile obtained from the numerical simulation agrees with the semi analytical solution assuming variable coefficients for the pollutant transport equation this is evident from the statistical comparison of the semi analytical and numerical solutions for times 0 42 and 0 7 in table 6 therefore regarding this good agreement between the two numerical and semi analytical solutions in fig 17 it is obvious that the number of intervals and increased number of nodes are acceptable for modeling the pollutant transport with input pollution patterns from boundaries it is worth mentioning that an increasing number of intervals and middle nodes make results approach reality as much as possible 3 3 third test case modeling an arbitrary branch type river network considering point and distributed source terms with constant coefficients in the third example another application of the semi analytical solution is examined for modeling the presence of point and distributed pollutant sources simultaneously in the river network in this section according to fig 18 a branch type river network is considered for modeling in which node names and flow directions have been specified as shown in fig 18 this network has the main river path 134 and a sub branch path 23 connected to it all flow geometric and pollutant characteristics of this river network are demonstrated in table 7 these values must be given to the model as inputs in the form of matrices with given entries in all branches of the river network the slope is assumed to be 0 0001 according to fig 18 an active distributed pollutant source non point of length 200 m and distributed flow discharge of 10 m3 s m enter the network through the interval of 4 4 2 km in branch 13 moreover there is a point pollutant source in the sub branch with a flow discharge of 5 m3 s entering the river network in chainage 3 km from the upstream boundary of path 23 for modeling the river network of fig 18 the simulation time is assumed to be 12 h and the input pollutant concentration pattern in nodes 1 and 2 is illustrated in figs 19 and 20 respectively moreover the evacuated pollutant concentration pattern for distributed and point pollution sources is presented in figs 21 and 22 after simulation the spatial profiles of dimensionless concentration at two times 0 486 and 0 59 for two paths 134 and 234 are illustrated in fig 23 table 8 demonstrates the statistical comparison of the numerical and semi analytical solutions for the river network of fig 18 by presenting the error indices for both solutions as demonstrated in fig 23 since the pollution patterns considered for modeling are irregular and time dependent the pollution leaves the network over time in path 134 the pollution enters the path with a time dependent complicated concentration pattern initially a distributed pollution pattern through the source term with a flow discharge of 10 m3 s m and an incoming pollution pattern of sub branch branch 23 enter the system at chainages 0 4 0 42 and 0 6 respectively these sources initially increase the pollutant concentration in the path as time passes concentration decreases at two dimensionless times 0 486 and 0 59 in chainages 0 4 0 6 due to the resultant negative concentration of distributed source term and input pollution pattern of boundary 1 the concentration increases from chainage 0 6 onward because of input loading in sub branch 23 since the pollution pattern is time dependent the pollution leaves the network from the outlet boundary at the end for path 234 pollutants enter the path with the same pattern as mentioned above initially the pollutant concentration increases because of loadings originating from the point source term with flow discharge 5 m3 s and pollution pattern of sub branch 13 at chainages 0 375 and 0 5 respectively however as time passes the concentration decreases at time 0 486 and chainages 0 375 0 5 because of the resultant negative concentration due to the point source term and input pollution pattern of node 2 this descending trend continues from chainage 0 5 onward under the effect of a negative concentration wave from branch 13 after a while under the effect of a positive concentration wave at dimensionless time 0 59 and chainages 0 375 0 5 the pollutant concentration increases it then decreases due to the resultant negative concentration from branch 13 at last the concentration pattern leaves the system according to fig 23 the effects of point and distributed pollutant source terms can be seen at chainage 0 4 in path 134 and chainage 0 375 in path 234 at chainages 0 4 to 0 6 in path 134 there is somewhat of a negligible difference between the spatial profile of numerical and semi analytical solutions the reason for this is common numerical errors especially numerical dispersion another important reason for this difference is the mass error due to distributed source term resulting from the distributed input flow rate based on eq 4 due to the distributed flow discharge of 10 m3 s for 200 m length the mass error increases cumulatively and affects chainages from 0 42 onward however at chainage 0 375 in path 234 the difference in the spatial concentration between the numerical and semi analytical solutions is negligible finally it can be seen from eq 4 that the input loading resulting from the point pollutant source term causes lower mass error than the distributed pollutant source term due to the distributed input flow discharge however it can be noted that at each of the intended dimensionless times the spatial concentration profiles of the numerical and semi analytical solutions are almost the same for both paths 134 and 234 indicating the desirable performance and high potential of the proposed semi analytical solution moreover the conformance between the numerical and semi analytical solutions is evident based on statistical errors calculated in table 8 it is worth noting that ascending or descending trends of pollutant concentration at junction nodes of branches result from positive loading product of discharge in concentration from the sub branches in other words if the loading causes a resultant positive concentration the concentration increases and if it causes a negative resultant it decreases concentration at junction nodes 3 4 fourth test case modeling an arbitrary branch type river network under a dispersion dominant state considering a point source term the fourth example shows the application of the proposed semi analytical solution in modeling a branch type river network under dispersion dominant state by considering a point source of pollution downstream of a river network as seen in fig 2 the desired river network has a main path of 134 and a sub branch of 23 lengths of the branches flow cross section area and dispersion coefficient characteristics of this river network are demonstrated in table 9 according to fig 24 a point pollutant source at a distance of 40 m from node 3 sub branch connection to the main path enters branch 34 with a pollution pattern as shown in fig 14 and a flow discharge of 2 m3 s due to considering the dispersion dominant state in the entire network the velocity in all branches is negligible and equal to zero moreover from the upstream boundaries nodes 1 and 2 no pollutant concentration enters the network and only pollutant transport is done through the point source term with the dispersion mechanism in the river network the reason is considering the pollution transport conditions under the dispersion mechanism in the entire river network also the total simulation time is 12 h after the simulation the spatial profiles of the dimensionless concentration at two times 0 37 and 0 579 for two paths 134 and 234 are shown in fig 25 according to fig 25 in the situation where the dispersion phenomenon is more dominant than the advection phenomenon due to the effect of the dispersion mechanism the concentration of pollution in the river network moves both downstream and upstream as seen in fig 25 the pollutant concentration moves upstream in dimensionless time 0 579 more than time 0 37 moreover in this simulation the dispersion coefficient of the upstream branches is also influential since the dispersion coefficient of branch 23 25 m2 s is higher than sub branch 13 18 m2 s according to fig 25 in both dimensionless times the backflow concentration in branch 23 is higher than sub branch 13 therefore the higher the dispersion coefficient is considered in a river network the higher the backflow concentration is in the absence of the advection phenomenon 4 conclusion this study presented a semi analytical solution of the one dimensional advection dispersion equation considering source and reaction terms in various river networks in addition to modeling different river networks with constant coefficients velocity flow cross section area and dispersion the proposed method can simulate various river networks with variable coefficients it includes branch type and loop type networks moreover networks with variable coefficients can be simulated by increasing the number of middle nodes and dividing the length of the branch into smaller intervals among other applications of this semi analytical solution is pollution modeling in river networks in the presence of point and distributed pollutant source terms in this study it is concluded that 1 the proposed semi analytical method is adequate in simulating different river networks with complicated patterns for boundary conditions and source terms 2 the effect of the dispersion coefficient in a branch type river network is entirely evident when the sub branches enter the main river as pollutant source terms not connected to it as a branch and it is different from the state of a river network the concentration difference between the two cases results from the lack of dispersion mechanism in the case of assuming branches as sources another effect of the dispersion coefficient is the concentration backflow from the main river to its sub branches where the pollutant concentration is assumed insignificant 3 the loop type river network modeling has more complexities and difficulties than a branch type one so the proposed semi analytical method can resolve these issues 4 for modeling the pollutant transport with variable coefficients the higher the number of intervals and middle nodes the higher the accuracy and capability of the semi analytical method in simulating pollution 5 the proposed semi analytical method can be used for modeling the simultaneous presence of point and distributed pollutant sources in a river network 6 the proposed semi analytical method can be used to model the dispersion dominant phenomenon in the absence the advection phenomenon in river networks this method extracts the semi analytical solution of ade considering source and reaction terms based on the laplace transform besides excellent performance the laplace transform technique can solve partial differential equations including ade with source and reaction terms in a river network the most critical advantage of this technique is that it is more convenient than other analytical methods furthermore it needs no homogenous boundary conditions as opposed to other techniques such as the generalized and classical integral transform techniques amiri et al 2021 cotta 2020 cotta et al 2016 pérez guerrero et al 2009b pérez guerrero et al 2010 in addition to these advantages this method has some limitations as well said limitations are related to the inverse laplace transform as it is analytically impossible to obtain the inverse laplace transform of complex functions derived in terms of the laplace variable s hence numerical algorithms for inverse laplace transform must be applied that deliver high accuracy besides low computation time in this study concentrated matrix exponential functions horváth et al 2020 have resolved this problem the computational cost of the semi analytical method proposed for the river network is lower than the numerical methods however for more complicated and more extensive river networks the dimensions of input matrices including velocity and dispersion coefficient become larger as a result the system of governing equations will have more nonlinear algebraic equations causing the computational cost and time to increase compared to numerical methods this study demonstrated that the proposed semi analytical solution is in good agreement with numerical solutions evident from statistical error indices coefficient of determination root mean square error and mean absolute error calculated for both solutions therefore regarding the common errors in numerical solutions the proposed semi analytical method can be used to validate other numerical and analytical solutions in river networks because of its high accuracy and desirable performance for pollutant transport simulation in river networks declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129287 appendix a supplementary data the following are the supplementary data to this article supplementary video 1 supplementary video 2 supplementary video 3 supplementary video 4 supplementary video 5 supplementary video 6 supplementary video 7 supplementary video 8 supplementary video 9 supplementary video 10 supplementary video 11 supplementary video 12 
2114,land water and air are the most essential resources blessed by nature to humankind conserved and maintained with steadfast efforts this study applies the modified universal soil loss equation musle to identify erosion prone sub basins and a non linear optimization algorithm to determine the optimal area combination of ecological management practices emps control sediment yield within permissible limits at a minimum cost the model is practiced for critical sub basins in the genale watershed to assess the effectiveness of five emps individually and as a combination in controlling sediment yields and peak flow a relative assessment revealed that terracing as an individual 61 8 and emps combinations 78 5 are better in reducing sediment yield at the sub basin scale considering the environmental and economic viewpoint the total cost of emps for five critical sub basins applied to reduce sediment yield is 46 101 million usd united states dollar or 1 844 billion ethiopian birr emps are environment friendly and cost effective to reduce sediment yield keywords critical sub basins soil erosion musle emps space availability cost optimization sediment yield and peak flow data availability data will be made available on request 1 introduction accelerated erosion and increased surface runoff due to lack of proper management of watersheds have raised global concern the loss of soil by water action is one of the fundamental factors adversely affecting reservoir capacity deteriorates surface water quality reduces agricultural land productivity and the sustainable use of surface water resources kefi and yoshino 2011 mtibaa et al 2018 song et al 2018 noori et al 2018 excessive precipitation inadequate vegetation cover topography and intensive agriculture practices are the leading causes of watershed degradation and call for management practices pimentel and burgess 2013 farzin and valikhan anaraki 2021 the challenge is amplified in developing countries where agricultural practices and urbanization are rapid and unplanned patowary et al 2019 vijith and dodge wan 2020 thus the modelers and planners need to critically look into the sub catchment level issues to help developing policies plans for sustainable management land use land cover lulc management practices play an imperative role in the planning and managing of the watershed uniyal et al 2020 advocated that identification of critical erosion prone areas and selection of best management practices for watershed management is necessary to stop further degradation and reduce sediment yields in recent years applying the modified universal soil loss equation musle available in the soil and water assessment tool swat model for simulating impacts of management practices on sediment yield water yield and nps pollution has attracted researchers attention arnold et al 1998 bieger et al 2015 epelde et al 2015 ma et al 2020 winchell et al 2015 liu et al 2021 tan et al 2022 swat is widely accepted because of its powerful algorithms for simulation of the hydrologic systems as well as its comprehensive database on agricultural management practices arabi et al 2008 musle provides an option for incorporating management practices at a catchment level for both structural and non structural agricultural management practices neitsch et al 2011 wu and chen 2012 table 1 from the beginning of the 21st century assessing catchment water yield and implications of different management practices at watershed levels is becoming a practical approach before suggesting solutions toward watersheds degradation negewo and sarma 2021b nature based solutions include soil and landscape approaches in which soil solutions include distinct practices like inter cropping and mulching on the agricultural fields to improve the soil s health functions whereas landscape approaches deal with the change of land use land cover lulc like conversion of agricultural fields to wetlands uniyal et al 2020 mtibaa et al 2018 hunink et al 2013 in the option of best management practices bmp in swat structural management practices include streambank stabilization grassed waterways contour farming terracing stone bunding and filter strips and non structural agronomic management practices include bio retention forest contour farming crop rotation and tillage practice tuppad et al 2010 briak et al 2019 strauch et al 2013 evaluated performance of terracing retention basins and crop rotation towards maintaining sustainability of an intensively agricultural watershed and established that they could significantly reduce the sediment load by 40 without affecting the catchment s water yield however applicability to a particular watershed should be evaluated via watershed modeling as each watershed has its characteristic behavior wang et al 2019 lópez ballesteros et al 2019 therefore nowadays watersheds modeling is an essential research tool for planning designing operating and managing watersheds at the sub basins level these can integrate information over large spatiotemporal scales and simulate various watershed processes over a long time such as surface runoff soil erosion transport of nutrients and nps pollutants negewo and sarma 2021c wang et al 2019 wu and chen 2013 with the help of a physically based semi distributed watershed model critical sub basin areas can be identified to effectively apply management practices to prevent or reduce soil erosion and to improve water quality aspects negewo and sarma 2021a the musle model has the advantage over other watershed models in incorporating site specific conditions basin characteristics and different extent of agricultural management practices and onsite practices mtibaa et al 2018 ecological management practices emps assign nature based solutions described as eco friendly sustainable management practices used for preserving and enhancing land uses naturally and limits sediment yield and peak surface runoff to its natural condition in a sustainable and economically viable manner selection of an optimal combination of emps need to be done with due consideration to constraints like space availability financial constraint and land ownership singh et al 2020 sarma et al 2015 dolowitz et al 2018 sediment yield from a watershed can be managed more efficiently by incorporating nature based solutions for sustainable pollution free and economically viable land use planning and management an optimal combination of emps resolved by employing the hydrological model and inspecting the performance of different emps combinations through a simulation optimization model can sustainably reduce sediment risks and maintain ecological benefits however for non developed countries the major challenge is to identify most critical area so that maximum benefit can be obtained by implementing emps in minimum area at affordable cost unplanned urbanization and unorganized agricultural practices in developing countries results in a very high degree of surface plug and erosion of soil non availability of detail land use data in an organized way makes model application difficult in the current study an optimization problem is formulated to minimize cost subject to the non linear constraint of sediment yield linear constraints of peak discharge and area suitability the application of sustainable land use allocation and management for ecological and economic benefits requires extensive use of different optimization techniques sarma et al 2015 and patowary et al 2019 launched a linear programming model optemp ls for single ownership on a steep area to resolve the optimal combination of emps to minimize cost within the constraint of annual sediment yield and peak flow rate another study singh et al 2020 used a non linear programming optimization technique to derive optimal emp combination to reduce flood risk in a semi urban watershed mtibaa et al in 2018 focused on evaluating and identifying the environmental suitability and cost effectiveness of various management practices scenarios regarding sediment yield reduction at the sub basin or hydrological response units hrus level the hrus is the smallest spatial unit of the model and the standard hrus definition approach lumps all similar land uses soils and slopes within a sub basin based upon user defined thresholds application of optem ls model and the semi distributed swat model in tandem has helped identifying optimal combination of emps along with their spatial distribution to help field implementation at minimum cost and without ambiguity a study negewo and sarma 2021a carried out using sediment yield data from 1990 to 2013 revealed that many sub basins of the genale watershed are experiencing high sediment yield indicating watershed degradation and therefore needs management measures to maintain ecological balance performance of ecological management practice emp which aims at maintaining ecological balance at optimal cost using ecofriendly measures is therefore evaluated in the present study the selection of an optimal combination of emps needs to be done with due consideration to constraints like technological institutional space availability financial and land ownership singh et al 2020 sarma et al 2015 dolowitz et al 2018 for preventing or reducing the amount of excess sediment generated from nonpoint sources to a level which can be regarded as near natural the study has new insights in terms of providing a methodology to identify optimal combination of emps and evaluating their performances through swat model these analyses serve as a powerful tool for the policy and decision makers to formulate effective management measures for safeguarding vulnerable sub basins hrus against the impacts of degradation soil erosion at minimum cost accordingly the selected potential emps applied to the site based on the unique soil types land use cover and slope types of lumped hrus created within the critical sub basins and these optimal combinations therefore differs from sub basin to sub basin the present study utilizes the swat model to compute sediment and water yield at sub basin and hrus level and then uses an optimization model to decide the optimal combination of emps to be implemented for restricting sediment and water yield at outlet of the basin within permissible limit at minimum possible cost it provides essential information to help decision makers reduce sediment yield peak discharge at an affordable cost and give feasible emps combinations for future soil and water conservation strategies in the genale catchment as the watershed is exposed to excessive soil erosion and progressively degrading due to high precipitation land use and runoff in the critical region 2 materials and methodology the proposed concept of utilizing both sub basin as well as hrus level analyses to identify effectively treatable areas to reduce sediment yield at optimal cost is elaborated in this section through its application in the genale catchment of ethiopia 2 1 description of the study area the genale catchment is geographically located between 4 08 to 7 02 north and 39 00 to 42 00 east in the southern part of ethiopia the catchment gets its first maximum rainfall during spring march to may and secondary maximum rainfall during autumn september to november the annual average precipitation experienced in the area is about 810 mm and the distribution of rainfall in a catchment ranges from 300 to 1305 mm per year the monthly temperature varies from 14 5 c to 24 6 c with an average of 19 5 c the maximum and minimum elevation variation in the area is 4280 and 176 m respectively in the genale watershed 54 942 km2 a total of 25 sub basins were created negewo and sarma 2021b the climate data required for this study has been collected from national meteorological agency of ethiopia which covered from 1987 to 2013 period for different stations the streamflow and sediment data were taken from the ministry of water irrigation and electricity mowie the streamflow and sediment data of genale river was recorded at the halwen gauging station from 1990 to 2013 which is about 25 km upstream of the outlet fig 1 it was then transferred to the outlet as calibration was done at the outlet location fig 1 shows the map indicating the location of the study area with the digital elevation model dem extracted from the ethiopia map for this study the dem was downloaded from usgs earth explorer https earthexplorer usgs gov srtm shuttle radar topography mission 90 m used for catchment delineation sub basin creation and slope classification the slope consists of five classes of which 5 20 was dominating the study area the lulc data collected from the gis department of the ethiopian ministry of water irrigation and electricity mowie for the year 2013 is used for musle swat input the dominant lulc is range brush rngb covering about 71 of the study area the soil map was downloaded from the world digital soil map of the food and agricultural organization fao https www fao org geonetwork srv en metadata scale of 1 5000000 for 2007 the dominant soil type in the study watershed is rc19 bc 204 calcaric regosols and it covers about 40 of the study area fig 2 the application of land use based solutions for controlling watershed sediment yield at the sub basin scale requires dealing with different challenges like the availability of space area and suitability of emps based on the rates of sediment yield estimated over 24 years 1990 2013 using modified universal soil loss equation musle of soil and water assessment tool swat model the most erosion prone sub basins in the genale watershed was identified for the planning management based on the annual average sediment yield obtained from the model at respective outlets of sub basins critical areas were located and base values for the performance evaluation of selected emps were decided to minimize the cost of emp implementation using combinations of emps as an optimized variable a non linear programming method of matlab optimization toolbox was used emps application cost differs based on constraints like targeted peak runoff sediment yield and area availability for different emps the musle in swat discretized genale watershed ethiopia to generate streamflow predict sediment yield identifying erosion critical area and estimate optimal cost and space availability for emps combinations fig 3 the current swat model evaluates surface erosion and sediment yield due to runoff for each hrus using the equation 1 musle willams 1975 1 q sed 11 8 q peak q surface a hru 0 56 k usle c usle p usle l s usle c f r g where qsed sediment yield ton ha day from specific hru qsurface surface runoff mm of water ha day ahru area of hrus in ha qpeak peak discharge m3 s kusle soil erodibility factor cusle cover and management practice factor pusle conservation support practice factors lsusle topographic factor cfrg coarse fragment factor soil erodibility factor k mg h mj 1 mm 1 is the soil resistance to erosion and susceptible to different soil properties transportability of sediment yield and runoff rate for specific rainfall input the k factor can be estimated based on the values of soil parameters texture organic matter om structural and permeability class wischmeier and smith 1978 2 k factor 27 661 m 1 14 12 o m 0 0043 s 2 0 0033 p 3 3 m 100 c h a c is of clay 0 002 mm h is of silt 0 002 0 05 mm a is of very fine sand 0 05 0 1 mm om is the organic matter content 3 6 s structure size code which are 1 very structured or particulate 2 is fairly structured 3 is slightly structured 4 is solid the soil in the study basin is found to be in the category of slightly structured therefore s 3 p class of permeability code in which 1 is rapid 2 is moderate to rapid 3 is moderate 4 is moderate to slow 5 is slow 6 is very slow hence p 4 therefore the k factor for the genale watershed was found based on the fao digital soil database https www fao org land water land land governance land resources planning toolbox category details en c 1026564 hence the soil structure is slightly structured and moderate to slow drain topographic factor ls the combined effects of slope length and slope gradient represent the ratio of soil loss per unit area on a field to the corresponding loss from 22 13 m length on the same soil type of a uniform with 9 slope wischmeier and smith 1978 it can be determined using remote sensing and gis techniques the srtm dem grid size used in the genale study area was 90 m 90 m the evaluated value of ls used 90 m i e z 90 m 4 ls z 22 13 y 0 0654 0 0456 b 0 00654 b where ls slope steepness length factor z is the slope length m b is slope gradient steepness y is the dimensionless exponential ranges from 0 2 for slope 1 to 0 5 for slope 10 cover and management factor c the erosion capacity of surface runoff can be affected by vegetation cover by changing the hydrodynamic characteristics of surface runoff gelagay and minale 2016 singh et al 2020 the cover management factor for an area classified as water body was taken as 0 agricultural agrl 0 25 range brushland rngb 0 014 represents cover and management factors used in the erosion critical study area duraes et al 2016 conservation support practice p factor the ratio of soil loss with a particular support practice to the corresponding loss from an agricultural area up and down the slope it has to be taken as 1 assuming there are no support practices within the watershed course fragment factor cfrg this can be estimated using equation 5 5 cfrg e x p 0 053 r o c k whereas rock is the percentage of the soil layer in the uppermost and it is evaluated by applying the empirical formula poesen et al 1998 which computes rock fractions based on the sub basins slope in this study 20 of the uppermost soil layer is assumed to be a rock therefore cfrg exp 0 053 rock exp 0 053 0 2 0 98 2 2 estimation of surface runoff qsurface surface runoff is computed by the daily runoff model using the soil conservation service scs curve number cn method this technique is extensively used to predict watershed discharge from a given rainfall event mainly based on soil properties slopes land use and hydrologic moisture condition arnold 1998 momm et al 2017 6 q surface p 0 2 s 2 p 0 8 s p 0 2 s the retention parameter s and prediction of lateral flow by the swat model is expressed as 7 s 254 100 cn 1 where p daily rainfall s potential retention mm day 2 3 performance criterion of the swat model for statistical analysis assessment in this work the goodness of fit was evaluated based on statistical criteria suggested by previous studies moriasi et al 2007 anaraki et al 2021 nse nash sutcliffe coefficient of efficiency r2 correlation coefficient percent bias pbias coefficient of determination r2 8 r 2 i 1 n q si q sm q oi q om 2 i 1 n q si q sm 2 i 1 n q oi q om 2 where q si is the simulated value q oi is the measured value q om is the average observed value and q sm the average simulated value nash sutcliffe efficiency nse 9 nse 1 i 1 n q oi q si 2 i 1 n q oi q om 2 where q oi is the observed q si is the simulated and q om the observed average values of discharge 10 pbias 100 i 1 n q oi q si i 1 n q oi where q oi is the observed discharge value and q si the simulated discharge value 2 4 determination of maximum and minimum peak discharge of watershed to continue the life of aquatic ecology and its functions a sustainable and presence of water flow in the channel is very important the peak discharge generated by a watershed at its outlet for a natural condition before human intervention i e with a natural vegetative cover can be used as an index of a healthy watershed in such situations the watershed does not suffer accelerated erosion due to anthropogenic activities this condition will provide all required elements for aquatic ecological functions and hence it is not desired to reduce the flow beyond this discharge and therefore considered the minimum limit of peak flow from the perspective of sediment management the minimum and maximum limit of allowable peak discharge do not create a sheet rill floodplain erosion and the watershed s natural drainage activity is not affected jia et al 2011 based on the above to keep the ecosystem healthy with the natural flow condition the peak discharge value obtained with the actual cover condition using rational formula was considered the lower limit of peak discharge qmin if the watershed area a is in km2 the intensity of rainfall i is in mm hr and rc is the runoff coefficient then chin 2019 gives the runoff rate 11 q peak rcia 3 6 the intensity of rainfall used in the equation above should be corresponding to a duration equal to the time of concentration and desired return period this requires an estimate of concentration time which can be computed by using different empirical formulas we have used the widely used empirical equation given by kirpich 1940 for calculating time of concentration and hence for calculating peak discharge for baseline condition as well as for different emp combinations absolute value of peak discharge though may vary with use of different formulas will not influence the result of optimal emp combination significantly as optimal combination is decided based on its comparison with baseline condition and thus is a relative study 12 t c 0 01947 l 0 77 δ s 0 385 where tc is a time of concentration in min l is the maximum length of water travel along the watercourse in m and δ s is the slope expressed as the ratio of elevation difference between the outlet and remotest point in the catchment sub basin to the length once the concentration time has been determined the rainfall intensity can be determined using the intensity durationfrequency relation applicable to the catchment area a generalized form is given in equation 13 al islam and hasan 2020 13 i k t x t c a n t is the return period in years and k x a and n are regression constants for a given geographical location i average e rainfall intensity cm hr and tc duration of rainfall hr corresponding to the time of concentration the soil conservation return period is generally considered ten years otim et al 2019 mati 2012 for culverts 25 years and bridges 50 100 years al islam and hasan 2020 the range of runoff coefficients rc for different types of the land surface was obtained as forest 0 05 0 25 agriculture 0 1 0 4 scrub brush lands 0 02 0 45 and terracing 0 1 0 2 table 2 2 4 1 estimation of carrying capacity of the channel reach the maximum permissible peak discharge qmax was evaluated based on the principle that the peak flow generated from a well managed sub basin for a design rainfall intensity should not cause flooding at immediate downstream sarma et al 2015 li et al 1976 qmax was calculated by computing the flow carrying capacity of a most efficient channel section that can be conveniently installed at the outlet of each prioritized sub basins fig 4 and fig 5 to carry away the flow safely it follows the regime approaches for natural alluvial channels since it is a mobile boundary unlined channel for the unlined channel in the alluvium channel the allowable velocity and the discharge should be checked for the stability of the channel to avoid scouring or silting the safe carrying capacity of a trapezoidal unlined natural channel carrying sediment particles was estimated using manning s equation which was used as the upper bound of maximum allowable discharge emps were planned so that the peak discharge generated by the design storm remained within this limiting value in fact the prismatic channel section was considered to calculate the carrying capacity of the channel at outlet of the basin sub basin where peak discharge is calculated the dimension of the short prismatic reach at the outlet was determined approximately based on the available width of the natural channel as observed in satellite data and then considering the channel to be of hydraulically efficient section fig 5 fig 5 is helpful in calculating each critical reach s carrying capacity to provide a safe and non flooding channel for the available longitudinal slope of different ranges based on the sub basins number widths a trapezoidal natural channel s safe carrying capacity was estimated and used as the upper bound of allowable peak discharge 2 5 selection of potential ecological management practices emps the potential emps were selected based on existing agricultural practices socio economic aspects locally available environmentally sustainable materials native species space availability and geography of the study area to suggest the relevant emps for the study area the effects of these emps on sediment yield at the sub basins level were evaluated for the watershed after checking the percentage of vulnerable land use regions present in the basin locations for emp application were decided as economically it may not be possible to cover all areas by emps within the watershed at a time accordingly the selected potential emps applied to the site based on the unique soil types land use cover and slope types of lumped hrus created within the critical sub basins are different from sub basin to sub basin after checking the hrus report analysis the percentage of area to be covered by different emps is as follows for critical sub 6 7 contour forming 9 grassed waterway 6 terracing 4 streambank stabilization and 8 filter strips likewise for sub 7 9 contour forming 11 grassed waterway 5 terracing 3 streambank stabilization 10 filter strips etc these five emps were considered based on land suitability and ease of implementation the effectiveness of emps scenarios was estimated by comparing each one with the baseline scenario to obtain a percentage of sediment reduction using equation 14 uniyal et al 2020 14 e f f e c t i v e n e s s se d yld b a s e l i n e s e d y l d e m p s se d y l d b a s e l i n e 100 2 6 simulation of emps the simulated emps included terracing grassed waterway filter strips streambank stabilization and contour farming for the selected critical sub basins a brief description of each emp representation in the arc swat before pre emp and after post emp condition is shown in table 3 the model parameters and their values updated modified the calibrated values and represent in post emp conditions given as in table 3 in the swat model simulation the representation of emps combination is also considered and applied to the selected critical sub basins to explore the reduction of sediment yield 2 7 optimization and cost analysis for different emps scenarios for optimum allocation of emps in agricultural and brushland sub basin areas hydrological models scs curve number cn rational method and musle method estimated runoff peak discharge and sediment yield respectively and their limiting values were put as constraints affordability in terms of cost is a significant issue in implementing suitable emps for controlling soil erosion under resources constraint conditions farmers use management practices like conservation tillage terracing filter strip forest buffer strip and bio retention at minimal construction and maintenance costs without explicitly considering their impacts on the natural flow sediment regime we assessed the effectiveness of combining different management practices following the concept of emps and depending on the slope angle and baseline land use cover of the target area the nonlinear programming nlp is the process of solving an optimization problem where some of the constraints or the objective function are nonlinear nlp one in which the objective or at least one of the constraints is a smooth nonlinear function of the decision variables objective function the objective function equation 15 was designed to minimize the total cost of emps construction cost annual cost of operation and maintenance in the study area to control the yearly sediment yield and peak discharge within the permissible limits 15 minimize z i 1 m c c i c m i a i where i 1 2 3 m are the number of emps considered for application to the case study area cci and cmi are the construction cost and the maintenance cost of ith emps respectively usd ha ai is the area under the ith emp and variable need to be optimized in the equation ha the unit costs related to filter strips grassed waterway streambank stabilization contour farming and terracing used in this study were obtained from works of literature cuttle et al 2007 arabi et al 2006 wang et al 2019 lópez ballesteros et al 2019 costs per unit area usd ha of the emps are evaluated based on the study area s current market rate the costs of emps included the actual construction costs and maintenance costs that are paid jointly by the government stakeholders and community residents it is worth mentioning that although the actual cost of emps may differ from one region to another the optimal combination of emps will not vary as long as the ratio of the unit cost of different emps remains the same in the other areas constraints sediment yield constraints the annual average sediment yield from the catchment after installation of emps should be greater or equal to the desired minimum sediment yield and less than or equal to the upper allowable sediment yield limit in this study the restriction of sediment yield is addressed using the modified universal soil loss equation musle in swat model 16 s m i n 11 8 k l s p c f r g i 1 n c i q pi q si a i 0 56 c j j 1 m a j i 1 n a i q pj q sj 0 56 c r q pr q sr a r 0 56 s m a x where smin is the minimum annual mean sediment yield expected from each sub basin smax is the maximum yearly mean sediment yield allowed from the sub basins a i is the area of the ith emp in sub basin ha a j is the area of the jth land cover with no emp ha c i cover management factor for the ith emp in the sub basin c j cover management factor for the jth land cover with no emp in the sub basin c r cover management factor for residential in the sub basin q pr discharge for residential q sr surface runoff for residential and a r area of residential in sub basins ha the lower limit of annual sediment yield has been set to some considerable requirements downstream from the environmental viewpoint in contrast the upper limit of the annual average sediment yield was obtained from musle based on the soil erosion class using a hypothetical land cover condition i e in a perfectly natural condition before any human intervention pre agricultural pre urbanized sediment in the watershed has some vital roles like releasing minerals nutrients and adsorbing pollutants from surface water which help maintain and continue the watershed ecosystem a certain minimum amount of sediment yield from the watershed is required to functioning the services contrarily too much sediment yield causes different problems such as clogging of drains removing fertile soil and reducing the river dam s carrying capacity to avoid such troubles allowable sediment yield must be kept within a natural permissible limit the minimum restriction of annual sediment yield should be chosen in the watershed not to be affected by water chemistry at the downstream water body for the growth and survival of the aquatic ecosystems in a water body there should always be some need for dissolved ions the reason is jain and ram 1997 rainwater has a relatively low ionic concentration while soil and sediment yield generally contribute to the required additional ionic load through the process of leaching there are no guidelines recommended from the literature about the required minimum sediment yield downstream but it is important for maintaining and dissolving ions in water for the downstream aquatic ecosystems accordingly 5 of the allowable maximum sediment yield was considered the required minimum sediment limits smin in water to sustainably continue the aquatic ecosystems sarma et al 2015 hence smin 5 of smax and smax snatural table 4 peak discharge constraint the watershed peak discharge should remain within the maximum and minimum acceptable limits after applying emps if there are no other acceptable criteria the minimum limit amount of peak discharge was set as the peak discharge value from the watershed area with the natural land cover condition by using the rational formula however the upper bound was developed by considering the maximum flow carrying capacity of the downstream stream reach conveniently installed at the outlet of each critical sub basins to remove the discharge safely 17 q m i n 0 2778 i 1 n r c i i i a i j 1 m a j i 1 n a i r c j i j rc r a r q m a x where qmin is the lower limit of peak runoff expected from the watershed m3 s for environmental requirements point of view qmax is the maximum allowable peak discharge from the watershed m3 s a i area of the ith emp in sub basin ha a j area of the jth land cover with no emp ha rc i runoff coefficient for the ith emp in the sub basin rc j runoff coefficient for the jth land cover with no emp in the sub basin rc r runoff coefficient for residential a r area of residential in sub basin ha emps area suitability constraint the application area of an emp in the watershed should not exceed the available suitable size in that watershed for that emp that means an emp is allowed only when an appropriate area available for the emp in that watershed is greater than or equal to a minimum feasible area required to implement that particular emp 18 0 a i a i m a x 19 a i a j a tot where ai is the area under the ith emp ai max is the area available for ith emp a j is the area under jth land use cover after applying emps and atot is the total area after emps application 3 results and discussions the important streamflow and sediment concentration data range for uncertainty analysis parameterization calibration validation used in this study were from 1990 2013 the model was created with dem land use soil type and slope for the genale catchment which formed 25 sub basins 464 hrus with a watershed area of 54 942 km2 3 1 uncertainty analysis for streamflow and sediment analysis of sensitivity helps to determine the relative ranking of parameters depending on how it affects the output variance due to input variability this is reducing uncertainty and provides parameter estimation guidance for the calibration step of the model sensitivity analyses were conducted based on the global sensitivity produced by the sequential uncertainty fitting version 2 sufi 2 algorithm in swat cup the swat model was calibrated and validated monthly basis for both sediment load and streamflow at the catchment outlet different trials of seven iterations with 500 number of simulations were used in the sufi 2 program in any iteration the parameter s value ranges closer to the acceptable region were transferred to the next iteration which provided better results in the next iteration as the upper and lower bound ranges of parameters become smaller the 95 prediction uncertainty distribution envelope gets smaller implying that the targeted objective function gets better in the subsequent iterations initially 20 numbers of parameters were selected for uncertainty analysis and then based on the values of t stat and p value ten 10 parameters revealed a worthwhile effect on streamflow and eight 8 parameters for sediment load in the calibration and sensitivity procedures the final value of each model parameter that revealed optimal model efficiency during calibration was used for model validation without further adjustment for sediment eight parameters show very sensitivity to the model table 5 after so many iterations based on the p value and t stat values ten parameters revealed to be sensitive to streamflow and eight parameters are sensitive to sediment load therefore a sensitivity was conducted to optimize the unknown variables and the most sensitive parameters which were found to have the most considerable effect on the streamflow and sediment load in the model result were identified table 5 in the calibration and uncertainty procedures the final value of each model parameter that revealed optimal model efficiency during calibration was used for model validation without further modification the simulation of the model was carried out for twenty seven 27 years of recorded data from 1987 to 2013 of which the first three years data were used as a warm up period and the sensitivity analysis of hydrologic parameters was done on a monthly basis analysis of sediment load and streamflow sensitivity was carried out for calibration period 1990 to 2005 and validation period 2006 to 2013 based on the p value and t stat results obtained from sensitivity analysis the ranks of parameters were assigned the predicted streamflow was the most sensitive for the initial scs curve number ii cn2 and the soil layer s available water capacity sol awc sol on another hand the simulated sediment was sensitive to the linear re entrainment parameter for channel sediment routing spcon bsn soil layer s available water capacity and curve number table 5 from table 6 based on different literature during sensitivity uncertainty analysis the fitted value of the parameters might be slightly out of upper and lower boundaries taking from nearby relative sensitivity default value by compromising biru kumar 2018 3 2 model calibration and validation calibrated validated parameters and the fitted values are the modeler s critical annotation from the calibration action used for the required objectives calibration of streamflow and sediment load was executed with several iterations of 500 simulations number each was carried out for the calibration period of 1990 2005 monthly model validation is needed to prove whether the calibrated parameters are also work for other data of different years within the catchment validation period 2006 2013 results showed a satisfactory performance for streamflow and sediment load figs 6 and 7 table 6 shows the actual ranges of performance criteria for the swat model the visual comparison of the model performance during the calibration and validation period for stream discharge and sediment load were responded well to the respective rainfall in the given span uncertainty measure of swat cup sufi 2 indicated that p factor of 0 51 and r factor of 0 78 for calibration and p factor of 0 50 and r factor of 0 86 for validation table 6 p factor and r factor are the two indices calculated to evaluate the model uncertainty thus the p factor of 1 and r factor of zero indicates that the simulation precisely conforms to the observed data without sources of uncertainty which is not possible in the reality of hydrological modeling in this study p factor for calibration and validation is 0 51 and 0 50 respectively which means about 51 of calibration and 50 of validation of the observed flow were bracketed by 95ppu band as indicated the model s simulated and observed streamflow and sediment load agreed showed a satisfactory performance during the calibration and validation action figs 6 and 7 3 3 identification of critical sub basins in the study area the average annual sediment yields of 24 years 1990 to 2013 from the musle simulation for each sub basin in the study area are used to identify the critical erosion reach based on erosion hazards along with soil erosion class change fig 8 based on the soil erosion class stated in fig 8 out of 25 sub basins five sub basins sub 6 7 8 10 and 12 covering 22 47 area of the watershed placed under critical sub basins which requires urgent action by stakeholders and watershed decision maker the accounted percentage of area is placed in upper tolerance limit of soil erosion class of 12 35 ton ha yr which need immediate action for management practices the effect of each emp scenario under changing sub basin wise soil erosion class is illustrated fig 8 moreover using streambank stabilization and grassed waterway shows the same improvement in the soil erosion classes except in sub 8 and 19 hence sub 6 changed from very high to high sub 12 changed from very high to moderate sub 10 from high to moderate and sub 7 from moderate to low under two scenarios streambank stabilization and grassed waterway in contour farming sub basins 6 8 and 12 changed from very high to moderate sub 10 from high to low and sub 7 from moderate to low in the case of filter strips terracing scenarios sub basin 6 was improved from very high to moderate sub 8 and sub 12 from very high to low sub 7 from moderate to low and sub 10 from high to low finally in the case of emps combinations sub 6 and 8 changed from very high to low sub 12 from very high to very low sub 10 from high to very low and sub 7 changed from moderate to very low class the musle model analysis revealed that terracing was the best solution in steep slope areas because it prevents soil particle detachment and lowered soil loss these all five of emps were appropriately combined by percentage of hrus area at a time based on land suitability and ease of implementation 3 4 impacts of emps on sediment yield reduction at sub basins scale the results from the simulation of 5 individual emps table 7 indicate that all the individual emps are used to reduce average annual sediment yields of 1990 2013 at the sub basins scale at the sub catchment level the maximum reduction in the sediment yield was attained by emps combinations 78 5 followed by terracing 61 8 and filter strips 54 3 table 7 the increase in channel roughness and channel cover causes a reduction in the surface runoff and channel erodibility which reduces sediment transport in the reach and sub basins degradation from the results it can be concluded that a reduction in sediment yield at the sub basin level is due to the application of emps fig 8 shows that the interventions at the upper sub basins have a positive impact on the erosion in the lower sub basins i e the sub basins 2 19 23 and 24 which were in erosion class of low have improved to very low we can understand that application of emps impacts even some sub basins which are in the category of soil erosion class low to very low which shows improvement of soil erosion as implied in all soil erosion classes sub basins wise over the watershed as shown in table 7 the simulated average annual sediment yields from each sub basin under different scenarios range 0 to 31 13 ton ha yr for the baseline scenario 0 to 18 01 ton ha yr under streambank stabilization 0 to 16 45 ton ha yr under grassed waterway 0 to 15 01 ton ha yr under contour farming use 0 to 13 70 ton ha yr under filter strip use 0 to 10 54 ton ha yr in terracing and 0 to 6 22 ton ha yr under emps combinations it is also clear that in the case of terracing it is possible to curb the soil loss from each sub basin within its permissible upper limit of soil loss i e 14 94 ton ha yr the implementation of different emps could result in up to 78 5 reduction in the average annual sediment yields for emps combinations 61 8 for terracing 54 3 for filter strips 48 8 for the contour farming 41 3 for grassed waterway and 37 3 for streambank stabilization at the sub basins level table 7 in this finding it is vital to implement appropriate emps combinations and an adequate number of natures based emps to minimize soil erosion to a reasonable extent based on the results in fig 9 it can be understood that the implementation of terracing is most desirable for the study area to sustainably and efficiently manage the critical sub basins at the individual level the suggested emps could be implemented phase wise according to the socio economic human resources and site specific conditions to provide sustainable watershed management from a practical viewpoint emps combination offers an economical solution in selecting nature based management practices to tackle soil erosion problems and high runoff generation from agricultural brush land and sloppy watersheds containing considerable plots 3 5 optimal combination of emps areas and cost effectiveness analysis cost is a critical factor in applying emps and we need to optimize the cost of emps for implementation in the study area the optimal cost of different emps for achieving these desirable limits of sediment yield was based on the optimal available space and it was obtained by using matlab programming the total cost for the five critical sub basins is found to be 1 844 billion ethiopian birrs us 46 101 million table 8 which was composed of terracing contour farming filter strips grassed waterway and streambank stabilization sub basin wise the combination of optimal emp satisfies the constraints of discharge sediment and available emp areas while minimizing cost after applying emp technology the annual sediment yield from each sub basin became almost in a natural condition the total critical sub basins cost for emps implementation is depicted in table 8 based on hrus report analysis in swat for each critical sub basins the percentage of area to be covered by different emps is different for example the total area of critical sub 6 is 231 530 ha out of this area 5715 ha is covered by terracing 2078 ha by contour farming 13683 ha by filter strips 20838 ha by grassed waterway and 11310 ha by streambank stabilization after emps area combination it is the same for the rest four critical sub basins table 8 the application of emps is limited due to area availability and budget constraints but provides nature based solutions in a sustainable and economically viable manner for reducing soil erosion and peak discharge the space availability and the cost for emps application are directly proportional to each other in critical sub basins fig 10 the space availability for terracing is very high except in sub 6 and the implementation cost is also high nevertheless for sub 8 the optimal cost is minimal as the respective area availability is small fig 10 this shows that the optimal cost is dependent on the availability of space from fig 10 as the optimal cost of sediment yield reduction depends on area availability constraint it did not directly reflect sediment yield change in the basins moreover sub 6 with high sediment yield manifests high demand of cost while sub 8 still with high sediment yield reflects the small value of emps cost and it is because of implementation cost is highly dependent on the optimal area available within the critical sub basins fig 10 4 discussions the case study in genale watershed demonstrates the convenience of the optimal combination of emps for soil and water conservation practice at sub basins and hrus scale under limited time space financial resources and labor as it may not be possible to cover all areas by emps within the watershed at a time this study has potential scientific merit in the context of evaluating and utilizing sub basins hrus level study in identifying most critical erosion prone area within a prioritized sub basin to minimize the implementation cost of soil and water conservation practices for improving water resources status and supporting decision makers in adopting an optimal and sustainable management strategy in the genale catchment ethiopia analysis at the sub basins hrus scale response has given significant insight into the locations needing management practice within the catchment on a priority basis to take measures locally the study is unique in analyzing the comparative cost effectiveness of terracing filter strips grassed waterway streambank stabilization and contour farming combination in addition to space availability for each option in the context of study areas and the cost estimate is thus appropriate inclusion of cost estimation by considering hrus level therefore provides new and important insights and can prove helpful for future decision making within affordable cost in the previous study owner s choice plays an important role in deciding the most optimal emp combination and the total cost increases with consideration of the owner s choice constraint after implementation of emp combination the annual sediment yield from the watershed became almost natural sarma et al 2015 patowary et al 2019 the current study revealed maximum reduction of sediment yield 61 8 was obtained after the implementation of terracing at individual level and 78 5 for implementation of emps combinations our findings can be compared to statistics carried out in other watersheds on the globe and similar situations are found these scenarios are within the percentage reduction of sediment yield as obtained by a different research scholars such as 71 reduction by the implementation of contour farming lópez ballesteros et al 2019 vegetative contour strips and soil bund were significant in reducing sediment yield below the tolerable soil loss which is equivalent to 63 9 and 64 8 reduction respectively dibaba et al 2021 under nepal parajuli 2022 the combination of bmps reduced the sediment yield up to 50 another study conducted by the sun et al 2019 also proved that the application of grassed waterways reduced the average sediment yield by 53 the study by nadew et al 2018 found that applying terracing in the guder watershed blue nile basin reduced the average annual sediment yield by 53 from the baseline scenario at selected sub basin areas the study by kefay et al 2022 stated implementing terraces in the selected critical sub basins reduced the mean annual sediment yield rate by 47 05 up to 37 2 reduction with the recharge structure the current study was anticipated to develop a scientific approach to choose the most effective emps combinations for reducing sediment yield with due emphasis on economic feasibility a cost analysis was used to evaluate the cost effectiveness of emps combinations however the economic cost has been a significant element for screening the application of emps despite its high implementation cost terracing technology occupied high space availability effectively reduces sediment yield in sub basins the non linear optimization program is computationally more intensive it gives a more realistic scenario of the total cost effective of a watershed management practice through emps combinations for the agricultural and brush land area of the sub basin actions are needed to raise awareness of the watershed soil degradation problem and remove the barriers limiting the adoption of emps combinations analysis till hrus scale brings more clarity in the erosion aspects and helps narrowing down to the critical areas and it becomes easier to address the challenges with low human resources low cost and within a short time where impacts were significant a major limitation of this study was the unavailability of the recent and up to date sediment data it spikes up down broken and not continuous for the validation of the sediment yield modeling results using swat musle one of the other limitations of this study is difficulty in fixing constraints and space area availability during cost optimization for emps implementation the quality of work could have been improved if the recent data had been available it is also recommended to consider temporal variation in land use cover to develop a more realistic scenario for the evaluation of emps 5 conclusions this article deals with the reduction of sediment yield through application of feasible emps combination appraisal of the space availability and cost effectiveness of five potential emps namely contour farming grassed waterway terracing streambank stabilization and filter strips combination in reducing the sediment yields at sub basin scales in the genale watershed using the hydrological model swat musle and an optimization programming developed using matlab the identification of critical sub basins based on the upper tolerance limit of sediment rate loss 12 35 ton ha yr revealed that 5 sub basins sub 6 7 8 10 and 12 covering 22 47 of the study area are under erosion critical condition from the scenarios analysis the implementation of emp under the terracing scenario as an individual and emps combination is the most effective in the study area to control sub basin degradation under financial constraints the resulted optimization model minimizes the overall implementation and maintenance cost of emps for five prioritized critical sub basins satisfying the constraints like allowable sediment yield allowable peak discharge and maximum emp area availability from the results it is seen that some sub basins with high sediment yield manifests high demand of cost while others with high sediment yield reflects relatively small value of emps cost this is because of the fact that the implementation cost is highly dependent on the type of the degraded areas that need treatment within the critical sub basins and suitability of emp combination for those degraded area the total optimal cost for the selected five critical sub basins is found to be 1 844 billion ethiopian birrs us 46 101 million which was composed of terracing contour farming filter strips grassed waterway and streambank stabilization area combinations inclusion of cost estimation by considering hrus level therefore provides new and important insights and can prove helpful for future decision making within affordable cost the current study was anticipated to develop a scientific approach to choose the most effective emps combinations for reducing sediment yield with due emphasis on economic feasibility from the analysis we suggest that local authorities adopt terracing practice as a control measure if single emp is applied individually however if the combination of emps is applied it performs much better than any single emp choosing economically attractive and socially acceptable emps through community participation is also an important key towards successful implementation of emps in the affected areas declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
2114,land water and air are the most essential resources blessed by nature to humankind conserved and maintained with steadfast efforts this study applies the modified universal soil loss equation musle to identify erosion prone sub basins and a non linear optimization algorithm to determine the optimal area combination of ecological management practices emps control sediment yield within permissible limits at a minimum cost the model is practiced for critical sub basins in the genale watershed to assess the effectiveness of five emps individually and as a combination in controlling sediment yields and peak flow a relative assessment revealed that terracing as an individual 61 8 and emps combinations 78 5 are better in reducing sediment yield at the sub basin scale considering the environmental and economic viewpoint the total cost of emps for five critical sub basins applied to reduce sediment yield is 46 101 million usd united states dollar or 1 844 billion ethiopian birr emps are environment friendly and cost effective to reduce sediment yield keywords critical sub basins soil erosion musle emps space availability cost optimization sediment yield and peak flow data availability data will be made available on request 1 introduction accelerated erosion and increased surface runoff due to lack of proper management of watersheds have raised global concern the loss of soil by water action is one of the fundamental factors adversely affecting reservoir capacity deteriorates surface water quality reduces agricultural land productivity and the sustainable use of surface water resources kefi and yoshino 2011 mtibaa et al 2018 song et al 2018 noori et al 2018 excessive precipitation inadequate vegetation cover topography and intensive agriculture practices are the leading causes of watershed degradation and call for management practices pimentel and burgess 2013 farzin and valikhan anaraki 2021 the challenge is amplified in developing countries where agricultural practices and urbanization are rapid and unplanned patowary et al 2019 vijith and dodge wan 2020 thus the modelers and planners need to critically look into the sub catchment level issues to help developing policies plans for sustainable management land use land cover lulc management practices play an imperative role in the planning and managing of the watershed uniyal et al 2020 advocated that identification of critical erosion prone areas and selection of best management practices for watershed management is necessary to stop further degradation and reduce sediment yields in recent years applying the modified universal soil loss equation musle available in the soil and water assessment tool swat model for simulating impacts of management practices on sediment yield water yield and nps pollution has attracted researchers attention arnold et al 1998 bieger et al 2015 epelde et al 2015 ma et al 2020 winchell et al 2015 liu et al 2021 tan et al 2022 swat is widely accepted because of its powerful algorithms for simulation of the hydrologic systems as well as its comprehensive database on agricultural management practices arabi et al 2008 musle provides an option for incorporating management practices at a catchment level for both structural and non structural agricultural management practices neitsch et al 2011 wu and chen 2012 table 1 from the beginning of the 21st century assessing catchment water yield and implications of different management practices at watershed levels is becoming a practical approach before suggesting solutions toward watersheds degradation negewo and sarma 2021b nature based solutions include soil and landscape approaches in which soil solutions include distinct practices like inter cropping and mulching on the agricultural fields to improve the soil s health functions whereas landscape approaches deal with the change of land use land cover lulc like conversion of agricultural fields to wetlands uniyal et al 2020 mtibaa et al 2018 hunink et al 2013 in the option of best management practices bmp in swat structural management practices include streambank stabilization grassed waterways contour farming terracing stone bunding and filter strips and non structural agronomic management practices include bio retention forest contour farming crop rotation and tillage practice tuppad et al 2010 briak et al 2019 strauch et al 2013 evaluated performance of terracing retention basins and crop rotation towards maintaining sustainability of an intensively agricultural watershed and established that they could significantly reduce the sediment load by 40 without affecting the catchment s water yield however applicability to a particular watershed should be evaluated via watershed modeling as each watershed has its characteristic behavior wang et al 2019 lópez ballesteros et al 2019 therefore nowadays watersheds modeling is an essential research tool for planning designing operating and managing watersheds at the sub basins level these can integrate information over large spatiotemporal scales and simulate various watershed processes over a long time such as surface runoff soil erosion transport of nutrients and nps pollutants negewo and sarma 2021c wang et al 2019 wu and chen 2013 with the help of a physically based semi distributed watershed model critical sub basin areas can be identified to effectively apply management practices to prevent or reduce soil erosion and to improve water quality aspects negewo and sarma 2021a the musle model has the advantage over other watershed models in incorporating site specific conditions basin characteristics and different extent of agricultural management practices and onsite practices mtibaa et al 2018 ecological management practices emps assign nature based solutions described as eco friendly sustainable management practices used for preserving and enhancing land uses naturally and limits sediment yield and peak surface runoff to its natural condition in a sustainable and economically viable manner selection of an optimal combination of emps need to be done with due consideration to constraints like space availability financial constraint and land ownership singh et al 2020 sarma et al 2015 dolowitz et al 2018 sediment yield from a watershed can be managed more efficiently by incorporating nature based solutions for sustainable pollution free and economically viable land use planning and management an optimal combination of emps resolved by employing the hydrological model and inspecting the performance of different emps combinations through a simulation optimization model can sustainably reduce sediment risks and maintain ecological benefits however for non developed countries the major challenge is to identify most critical area so that maximum benefit can be obtained by implementing emps in minimum area at affordable cost unplanned urbanization and unorganized agricultural practices in developing countries results in a very high degree of surface plug and erosion of soil non availability of detail land use data in an organized way makes model application difficult in the current study an optimization problem is formulated to minimize cost subject to the non linear constraint of sediment yield linear constraints of peak discharge and area suitability the application of sustainable land use allocation and management for ecological and economic benefits requires extensive use of different optimization techniques sarma et al 2015 and patowary et al 2019 launched a linear programming model optemp ls for single ownership on a steep area to resolve the optimal combination of emps to minimize cost within the constraint of annual sediment yield and peak flow rate another study singh et al 2020 used a non linear programming optimization technique to derive optimal emp combination to reduce flood risk in a semi urban watershed mtibaa et al in 2018 focused on evaluating and identifying the environmental suitability and cost effectiveness of various management practices scenarios regarding sediment yield reduction at the sub basin or hydrological response units hrus level the hrus is the smallest spatial unit of the model and the standard hrus definition approach lumps all similar land uses soils and slopes within a sub basin based upon user defined thresholds application of optem ls model and the semi distributed swat model in tandem has helped identifying optimal combination of emps along with their spatial distribution to help field implementation at minimum cost and without ambiguity a study negewo and sarma 2021a carried out using sediment yield data from 1990 to 2013 revealed that many sub basins of the genale watershed are experiencing high sediment yield indicating watershed degradation and therefore needs management measures to maintain ecological balance performance of ecological management practice emp which aims at maintaining ecological balance at optimal cost using ecofriendly measures is therefore evaluated in the present study the selection of an optimal combination of emps needs to be done with due consideration to constraints like technological institutional space availability financial and land ownership singh et al 2020 sarma et al 2015 dolowitz et al 2018 for preventing or reducing the amount of excess sediment generated from nonpoint sources to a level which can be regarded as near natural the study has new insights in terms of providing a methodology to identify optimal combination of emps and evaluating their performances through swat model these analyses serve as a powerful tool for the policy and decision makers to formulate effective management measures for safeguarding vulnerable sub basins hrus against the impacts of degradation soil erosion at minimum cost accordingly the selected potential emps applied to the site based on the unique soil types land use cover and slope types of lumped hrus created within the critical sub basins and these optimal combinations therefore differs from sub basin to sub basin the present study utilizes the swat model to compute sediment and water yield at sub basin and hrus level and then uses an optimization model to decide the optimal combination of emps to be implemented for restricting sediment and water yield at outlet of the basin within permissible limit at minimum possible cost it provides essential information to help decision makers reduce sediment yield peak discharge at an affordable cost and give feasible emps combinations for future soil and water conservation strategies in the genale catchment as the watershed is exposed to excessive soil erosion and progressively degrading due to high precipitation land use and runoff in the critical region 2 materials and methodology the proposed concept of utilizing both sub basin as well as hrus level analyses to identify effectively treatable areas to reduce sediment yield at optimal cost is elaborated in this section through its application in the genale catchment of ethiopia 2 1 description of the study area the genale catchment is geographically located between 4 08 to 7 02 north and 39 00 to 42 00 east in the southern part of ethiopia the catchment gets its first maximum rainfall during spring march to may and secondary maximum rainfall during autumn september to november the annual average precipitation experienced in the area is about 810 mm and the distribution of rainfall in a catchment ranges from 300 to 1305 mm per year the monthly temperature varies from 14 5 c to 24 6 c with an average of 19 5 c the maximum and minimum elevation variation in the area is 4280 and 176 m respectively in the genale watershed 54 942 km2 a total of 25 sub basins were created negewo and sarma 2021b the climate data required for this study has been collected from national meteorological agency of ethiopia which covered from 1987 to 2013 period for different stations the streamflow and sediment data were taken from the ministry of water irrigation and electricity mowie the streamflow and sediment data of genale river was recorded at the halwen gauging station from 1990 to 2013 which is about 25 km upstream of the outlet fig 1 it was then transferred to the outlet as calibration was done at the outlet location fig 1 shows the map indicating the location of the study area with the digital elevation model dem extracted from the ethiopia map for this study the dem was downloaded from usgs earth explorer https earthexplorer usgs gov srtm shuttle radar topography mission 90 m used for catchment delineation sub basin creation and slope classification the slope consists of five classes of which 5 20 was dominating the study area the lulc data collected from the gis department of the ethiopian ministry of water irrigation and electricity mowie for the year 2013 is used for musle swat input the dominant lulc is range brush rngb covering about 71 of the study area the soil map was downloaded from the world digital soil map of the food and agricultural organization fao https www fao org geonetwork srv en metadata scale of 1 5000000 for 2007 the dominant soil type in the study watershed is rc19 bc 204 calcaric regosols and it covers about 40 of the study area fig 2 the application of land use based solutions for controlling watershed sediment yield at the sub basin scale requires dealing with different challenges like the availability of space area and suitability of emps based on the rates of sediment yield estimated over 24 years 1990 2013 using modified universal soil loss equation musle of soil and water assessment tool swat model the most erosion prone sub basins in the genale watershed was identified for the planning management based on the annual average sediment yield obtained from the model at respective outlets of sub basins critical areas were located and base values for the performance evaluation of selected emps were decided to minimize the cost of emp implementation using combinations of emps as an optimized variable a non linear programming method of matlab optimization toolbox was used emps application cost differs based on constraints like targeted peak runoff sediment yield and area availability for different emps the musle in swat discretized genale watershed ethiopia to generate streamflow predict sediment yield identifying erosion critical area and estimate optimal cost and space availability for emps combinations fig 3 the current swat model evaluates surface erosion and sediment yield due to runoff for each hrus using the equation 1 musle willams 1975 1 q sed 11 8 q peak q surface a hru 0 56 k usle c usle p usle l s usle c f r g where qsed sediment yield ton ha day from specific hru qsurface surface runoff mm of water ha day ahru area of hrus in ha qpeak peak discharge m3 s kusle soil erodibility factor cusle cover and management practice factor pusle conservation support practice factors lsusle topographic factor cfrg coarse fragment factor soil erodibility factor k mg h mj 1 mm 1 is the soil resistance to erosion and susceptible to different soil properties transportability of sediment yield and runoff rate for specific rainfall input the k factor can be estimated based on the values of soil parameters texture organic matter om structural and permeability class wischmeier and smith 1978 2 k factor 27 661 m 1 14 12 o m 0 0043 s 2 0 0033 p 3 3 m 100 c h a c is of clay 0 002 mm h is of silt 0 002 0 05 mm a is of very fine sand 0 05 0 1 mm om is the organic matter content 3 6 s structure size code which are 1 very structured or particulate 2 is fairly structured 3 is slightly structured 4 is solid the soil in the study basin is found to be in the category of slightly structured therefore s 3 p class of permeability code in which 1 is rapid 2 is moderate to rapid 3 is moderate 4 is moderate to slow 5 is slow 6 is very slow hence p 4 therefore the k factor for the genale watershed was found based on the fao digital soil database https www fao org land water land land governance land resources planning toolbox category details en c 1026564 hence the soil structure is slightly structured and moderate to slow drain topographic factor ls the combined effects of slope length and slope gradient represent the ratio of soil loss per unit area on a field to the corresponding loss from 22 13 m length on the same soil type of a uniform with 9 slope wischmeier and smith 1978 it can be determined using remote sensing and gis techniques the srtm dem grid size used in the genale study area was 90 m 90 m the evaluated value of ls used 90 m i e z 90 m 4 ls z 22 13 y 0 0654 0 0456 b 0 00654 b where ls slope steepness length factor z is the slope length m b is slope gradient steepness y is the dimensionless exponential ranges from 0 2 for slope 1 to 0 5 for slope 10 cover and management factor c the erosion capacity of surface runoff can be affected by vegetation cover by changing the hydrodynamic characteristics of surface runoff gelagay and minale 2016 singh et al 2020 the cover management factor for an area classified as water body was taken as 0 agricultural agrl 0 25 range brushland rngb 0 014 represents cover and management factors used in the erosion critical study area duraes et al 2016 conservation support practice p factor the ratio of soil loss with a particular support practice to the corresponding loss from an agricultural area up and down the slope it has to be taken as 1 assuming there are no support practices within the watershed course fragment factor cfrg this can be estimated using equation 5 5 cfrg e x p 0 053 r o c k whereas rock is the percentage of the soil layer in the uppermost and it is evaluated by applying the empirical formula poesen et al 1998 which computes rock fractions based on the sub basins slope in this study 20 of the uppermost soil layer is assumed to be a rock therefore cfrg exp 0 053 rock exp 0 053 0 2 0 98 2 2 estimation of surface runoff qsurface surface runoff is computed by the daily runoff model using the soil conservation service scs curve number cn method this technique is extensively used to predict watershed discharge from a given rainfall event mainly based on soil properties slopes land use and hydrologic moisture condition arnold 1998 momm et al 2017 6 q surface p 0 2 s 2 p 0 8 s p 0 2 s the retention parameter s and prediction of lateral flow by the swat model is expressed as 7 s 254 100 cn 1 where p daily rainfall s potential retention mm day 2 3 performance criterion of the swat model for statistical analysis assessment in this work the goodness of fit was evaluated based on statistical criteria suggested by previous studies moriasi et al 2007 anaraki et al 2021 nse nash sutcliffe coefficient of efficiency r2 correlation coefficient percent bias pbias coefficient of determination r2 8 r 2 i 1 n q si q sm q oi q om 2 i 1 n q si q sm 2 i 1 n q oi q om 2 where q si is the simulated value q oi is the measured value q om is the average observed value and q sm the average simulated value nash sutcliffe efficiency nse 9 nse 1 i 1 n q oi q si 2 i 1 n q oi q om 2 where q oi is the observed q si is the simulated and q om the observed average values of discharge 10 pbias 100 i 1 n q oi q si i 1 n q oi where q oi is the observed discharge value and q si the simulated discharge value 2 4 determination of maximum and minimum peak discharge of watershed to continue the life of aquatic ecology and its functions a sustainable and presence of water flow in the channel is very important the peak discharge generated by a watershed at its outlet for a natural condition before human intervention i e with a natural vegetative cover can be used as an index of a healthy watershed in such situations the watershed does not suffer accelerated erosion due to anthropogenic activities this condition will provide all required elements for aquatic ecological functions and hence it is not desired to reduce the flow beyond this discharge and therefore considered the minimum limit of peak flow from the perspective of sediment management the minimum and maximum limit of allowable peak discharge do not create a sheet rill floodplain erosion and the watershed s natural drainage activity is not affected jia et al 2011 based on the above to keep the ecosystem healthy with the natural flow condition the peak discharge value obtained with the actual cover condition using rational formula was considered the lower limit of peak discharge qmin if the watershed area a is in km2 the intensity of rainfall i is in mm hr and rc is the runoff coefficient then chin 2019 gives the runoff rate 11 q peak rcia 3 6 the intensity of rainfall used in the equation above should be corresponding to a duration equal to the time of concentration and desired return period this requires an estimate of concentration time which can be computed by using different empirical formulas we have used the widely used empirical equation given by kirpich 1940 for calculating time of concentration and hence for calculating peak discharge for baseline condition as well as for different emp combinations absolute value of peak discharge though may vary with use of different formulas will not influence the result of optimal emp combination significantly as optimal combination is decided based on its comparison with baseline condition and thus is a relative study 12 t c 0 01947 l 0 77 δ s 0 385 where tc is a time of concentration in min l is the maximum length of water travel along the watercourse in m and δ s is the slope expressed as the ratio of elevation difference between the outlet and remotest point in the catchment sub basin to the length once the concentration time has been determined the rainfall intensity can be determined using the intensity durationfrequency relation applicable to the catchment area a generalized form is given in equation 13 al islam and hasan 2020 13 i k t x t c a n t is the return period in years and k x a and n are regression constants for a given geographical location i average e rainfall intensity cm hr and tc duration of rainfall hr corresponding to the time of concentration the soil conservation return period is generally considered ten years otim et al 2019 mati 2012 for culverts 25 years and bridges 50 100 years al islam and hasan 2020 the range of runoff coefficients rc for different types of the land surface was obtained as forest 0 05 0 25 agriculture 0 1 0 4 scrub brush lands 0 02 0 45 and terracing 0 1 0 2 table 2 2 4 1 estimation of carrying capacity of the channel reach the maximum permissible peak discharge qmax was evaluated based on the principle that the peak flow generated from a well managed sub basin for a design rainfall intensity should not cause flooding at immediate downstream sarma et al 2015 li et al 1976 qmax was calculated by computing the flow carrying capacity of a most efficient channel section that can be conveniently installed at the outlet of each prioritized sub basins fig 4 and fig 5 to carry away the flow safely it follows the regime approaches for natural alluvial channels since it is a mobile boundary unlined channel for the unlined channel in the alluvium channel the allowable velocity and the discharge should be checked for the stability of the channel to avoid scouring or silting the safe carrying capacity of a trapezoidal unlined natural channel carrying sediment particles was estimated using manning s equation which was used as the upper bound of maximum allowable discharge emps were planned so that the peak discharge generated by the design storm remained within this limiting value in fact the prismatic channel section was considered to calculate the carrying capacity of the channel at outlet of the basin sub basin where peak discharge is calculated the dimension of the short prismatic reach at the outlet was determined approximately based on the available width of the natural channel as observed in satellite data and then considering the channel to be of hydraulically efficient section fig 5 fig 5 is helpful in calculating each critical reach s carrying capacity to provide a safe and non flooding channel for the available longitudinal slope of different ranges based on the sub basins number widths a trapezoidal natural channel s safe carrying capacity was estimated and used as the upper bound of allowable peak discharge 2 5 selection of potential ecological management practices emps the potential emps were selected based on existing agricultural practices socio economic aspects locally available environmentally sustainable materials native species space availability and geography of the study area to suggest the relevant emps for the study area the effects of these emps on sediment yield at the sub basins level were evaluated for the watershed after checking the percentage of vulnerable land use regions present in the basin locations for emp application were decided as economically it may not be possible to cover all areas by emps within the watershed at a time accordingly the selected potential emps applied to the site based on the unique soil types land use cover and slope types of lumped hrus created within the critical sub basins are different from sub basin to sub basin after checking the hrus report analysis the percentage of area to be covered by different emps is as follows for critical sub 6 7 contour forming 9 grassed waterway 6 terracing 4 streambank stabilization and 8 filter strips likewise for sub 7 9 contour forming 11 grassed waterway 5 terracing 3 streambank stabilization 10 filter strips etc these five emps were considered based on land suitability and ease of implementation the effectiveness of emps scenarios was estimated by comparing each one with the baseline scenario to obtain a percentage of sediment reduction using equation 14 uniyal et al 2020 14 e f f e c t i v e n e s s se d yld b a s e l i n e s e d y l d e m p s se d y l d b a s e l i n e 100 2 6 simulation of emps the simulated emps included terracing grassed waterway filter strips streambank stabilization and contour farming for the selected critical sub basins a brief description of each emp representation in the arc swat before pre emp and after post emp condition is shown in table 3 the model parameters and their values updated modified the calibrated values and represent in post emp conditions given as in table 3 in the swat model simulation the representation of emps combination is also considered and applied to the selected critical sub basins to explore the reduction of sediment yield 2 7 optimization and cost analysis for different emps scenarios for optimum allocation of emps in agricultural and brushland sub basin areas hydrological models scs curve number cn rational method and musle method estimated runoff peak discharge and sediment yield respectively and their limiting values were put as constraints affordability in terms of cost is a significant issue in implementing suitable emps for controlling soil erosion under resources constraint conditions farmers use management practices like conservation tillage terracing filter strip forest buffer strip and bio retention at minimal construction and maintenance costs without explicitly considering their impacts on the natural flow sediment regime we assessed the effectiveness of combining different management practices following the concept of emps and depending on the slope angle and baseline land use cover of the target area the nonlinear programming nlp is the process of solving an optimization problem where some of the constraints or the objective function are nonlinear nlp one in which the objective or at least one of the constraints is a smooth nonlinear function of the decision variables objective function the objective function equation 15 was designed to minimize the total cost of emps construction cost annual cost of operation and maintenance in the study area to control the yearly sediment yield and peak discharge within the permissible limits 15 minimize z i 1 m c c i c m i a i where i 1 2 3 m are the number of emps considered for application to the case study area cci and cmi are the construction cost and the maintenance cost of ith emps respectively usd ha ai is the area under the ith emp and variable need to be optimized in the equation ha the unit costs related to filter strips grassed waterway streambank stabilization contour farming and terracing used in this study were obtained from works of literature cuttle et al 2007 arabi et al 2006 wang et al 2019 lópez ballesteros et al 2019 costs per unit area usd ha of the emps are evaluated based on the study area s current market rate the costs of emps included the actual construction costs and maintenance costs that are paid jointly by the government stakeholders and community residents it is worth mentioning that although the actual cost of emps may differ from one region to another the optimal combination of emps will not vary as long as the ratio of the unit cost of different emps remains the same in the other areas constraints sediment yield constraints the annual average sediment yield from the catchment after installation of emps should be greater or equal to the desired minimum sediment yield and less than or equal to the upper allowable sediment yield limit in this study the restriction of sediment yield is addressed using the modified universal soil loss equation musle in swat model 16 s m i n 11 8 k l s p c f r g i 1 n c i q pi q si a i 0 56 c j j 1 m a j i 1 n a i q pj q sj 0 56 c r q pr q sr a r 0 56 s m a x where smin is the minimum annual mean sediment yield expected from each sub basin smax is the maximum yearly mean sediment yield allowed from the sub basins a i is the area of the ith emp in sub basin ha a j is the area of the jth land cover with no emp ha c i cover management factor for the ith emp in the sub basin c j cover management factor for the jth land cover with no emp in the sub basin c r cover management factor for residential in the sub basin q pr discharge for residential q sr surface runoff for residential and a r area of residential in sub basins ha the lower limit of annual sediment yield has been set to some considerable requirements downstream from the environmental viewpoint in contrast the upper limit of the annual average sediment yield was obtained from musle based on the soil erosion class using a hypothetical land cover condition i e in a perfectly natural condition before any human intervention pre agricultural pre urbanized sediment in the watershed has some vital roles like releasing minerals nutrients and adsorbing pollutants from surface water which help maintain and continue the watershed ecosystem a certain minimum amount of sediment yield from the watershed is required to functioning the services contrarily too much sediment yield causes different problems such as clogging of drains removing fertile soil and reducing the river dam s carrying capacity to avoid such troubles allowable sediment yield must be kept within a natural permissible limit the minimum restriction of annual sediment yield should be chosen in the watershed not to be affected by water chemistry at the downstream water body for the growth and survival of the aquatic ecosystems in a water body there should always be some need for dissolved ions the reason is jain and ram 1997 rainwater has a relatively low ionic concentration while soil and sediment yield generally contribute to the required additional ionic load through the process of leaching there are no guidelines recommended from the literature about the required minimum sediment yield downstream but it is important for maintaining and dissolving ions in water for the downstream aquatic ecosystems accordingly 5 of the allowable maximum sediment yield was considered the required minimum sediment limits smin in water to sustainably continue the aquatic ecosystems sarma et al 2015 hence smin 5 of smax and smax snatural table 4 peak discharge constraint the watershed peak discharge should remain within the maximum and minimum acceptable limits after applying emps if there are no other acceptable criteria the minimum limit amount of peak discharge was set as the peak discharge value from the watershed area with the natural land cover condition by using the rational formula however the upper bound was developed by considering the maximum flow carrying capacity of the downstream stream reach conveniently installed at the outlet of each critical sub basins to remove the discharge safely 17 q m i n 0 2778 i 1 n r c i i i a i j 1 m a j i 1 n a i r c j i j rc r a r q m a x where qmin is the lower limit of peak runoff expected from the watershed m3 s for environmental requirements point of view qmax is the maximum allowable peak discharge from the watershed m3 s a i area of the ith emp in sub basin ha a j area of the jth land cover with no emp ha rc i runoff coefficient for the ith emp in the sub basin rc j runoff coefficient for the jth land cover with no emp in the sub basin rc r runoff coefficient for residential a r area of residential in sub basin ha emps area suitability constraint the application area of an emp in the watershed should not exceed the available suitable size in that watershed for that emp that means an emp is allowed only when an appropriate area available for the emp in that watershed is greater than or equal to a minimum feasible area required to implement that particular emp 18 0 a i a i m a x 19 a i a j a tot where ai is the area under the ith emp ai max is the area available for ith emp a j is the area under jth land use cover after applying emps and atot is the total area after emps application 3 results and discussions the important streamflow and sediment concentration data range for uncertainty analysis parameterization calibration validation used in this study were from 1990 2013 the model was created with dem land use soil type and slope for the genale catchment which formed 25 sub basins 464 hrus with a watershed area of 54 942 km2 3 1 uncertainty analysis for streamflow and sediment analysis of sensitivity helps to determine the relative ranking of parameters depending on how it affects the output variance due to input variability this is reducing uncertainty and provides parameter estimation guidance for the calibration step of the model sensitivity analyses were conducted based on the global sensitivity produced by the sequential uncertainty fitting version 2 sufi 2 algorithm in swat cup the swat model was calibrated and validated monthly basis for both sediment load and streamflow at the catchment outlet different trials of seven iterations with 500 number of simulations were used in the sufi 2 program in any iteration the parameter s value ranges closer to the acceptable region were transferred to the next iteration which provided better results in the next iteration as the upper and lower bound ranges of parameters become smaller the 95 prediction uncertainty distribution envelope gets smaller implying that the targeted objective function gets better in the subsequent iterations initially 20 numbers of parameters were selected for uncertainty analysis and then based on the values of t stat and p value ten 10 parameters revealed a worthwhile effect on streamflow and eight 8 parameters for sediment load in the calibration and sensitivity procedures the final value of each model parameter that revealed optimal model efficiency during calibration was used for model validation without further adjustment for sediment eight parameters show very sensitivity to the model table 5 after so many iterations based on the p value and t stat values ten parameters revealed to be sensitive to streamflow and eight parameters are sensitive to sediment load therefore a sensitivity was conducted to optimize the unknown variables and the most sensitive parameters which were found to have the most considerable effect on the streamflow and sediment load in the model result were identified table 5 in the calibration and uncertainty procedures the final value of each model parameter that revealed optimal model efficiency during calibration was used for model validation without further modification the simulation of the model was carried out for twenty seven 27 years of recorded data from 1987 to 2013 of which the first three years data were used as a warm up period and the sensitivity analysis of hydrologic parameters was done on a monthly basis analysis of sediment load and streamflow sensitivity was carried out for calibration period 1990 to 2005 and validation period 2006 to 2013 based on the p value and t stat results obtained from sensitivity analysis the ranks of parameters were assigned the predicted streamflow was the most sensitive for the initial scs curve number ii cn2 and the soil layer s available water capacity sol awc sol on another hand the simulated sediment was sensitive to the linear re entrainment parameter for channel sediment routing spcon bsn soil layer s available water capacity and curve number table 5 from table 6 based on different literature during sensitivity uncertainty analysis the fitted value of the parameters might be slightly out of upper and lower boundaries taking from nearby relative sensitivity default value by compromising biru kumar 2018 3 2 model calibration and validation calibrated validated parameters and the fitted values are the modeler s critical annotation from the calibration action used for the required objectives calibration of streamflow and sediment load was executed with several iterations of 500 simulations number each was carried out for the calibration period of 1990 2005 monthly model validation is needed to prove whether the calibrated parameters are also work for other data of different years within the catchment validation period 2006 2013 results showed a satisfactory performance for streamflow and sediment load figs 6 and 7 table 6 shows the actual ranges of performance criteria for the swat model the visual comparison of the model performance during the calibration and validation period for stream discharge and sediment load were responded well to the respective rainfall in the given span uncertainty measure of swat cup sufi 2 indicated that p factor of 0 51 and r factor of 0 78 for calibration and p factor of 0 50 and r factor of 0 86 for validation table 6 p factor and r factor are the two indices calculated to evaluate the model uncertainty thus the p factor of 1 and r factor of zero indicates that the simulation precisely conforms to the observed data without sources of uncertainty which is not possible in the reality of hydrological modeling in this study p factor for calibration and validation is 0 51 and 0 50 respectively which means about 51 of calibration and 50 of validation of the observed flow were bracketed by 95ppu band as indicated the model s simulated and observed streamflow and sediment load agreed showed a satisfactory performance during the calibration and validation action figs 6 and 7 3 3 identification of critical sub basins in the study area the average annual sediment yields of 24 years 1990 to 2013 from the musle simulation for each sub basin in the study area are used to identify the critical erosion reach based on erosion hazards along with soil erosion class change fig 8 based on the soil erosion class stated in fig 8 out of 25 sub basins five sub basins sub 6 7 8 10 and 12 covering 22 47 area of the watershed placed under critical sub basins which requires urgent action by stakeholders and watershed decision maker the accounted percentage of area is placed in upper tolerance limit of soil erosion class of 12 35 ton ha yr which need immediate action for management practices the effect of each emp scenario under changing sub basin wise soil erosion class is illustrated fig 8 moreover using streambank stabilization and grassed waterway shows the same improvement in the soil erosion classes except in sub 8 and 19 hence sub 6 changed from very high to high sub 12 changed from very high to moderate sub 10 from high to moderate and sub 7 from moderate to low under two scenarios streambank stabilization and grassed waterway in contour farming sub basins 6 8 and 12 changed from very high to moderate sub 10 from high to low and sub 7 from moderate to low in the case of filter strips terracing scenarios sub basin 6 was improved from very high to moderate sub 8 and sub 12 from very high to low sub 7 from moderate to low and sub 10 from high to low finally in the case of emps combinations sub 6 and 8 changed from very high to low sub 12 from very high to very low sub 10 from high to very low and sub 7 changed from moderate to very low class the musle model analysis revealed that terracing was the best solution in steep slope areas because it prevents soil particle detachment and lowered soil loss these all five of emps were appropriately combined by percentage of hrus area at a time based on land suitability and ease of implementation 3 4 impacts of emps on sediment yield reduction at sub basins scale the results from the simulation of 5 individual emps table 7 indicate that all the individual emps are used to reduce average annual sediment yields of 1990 2013 at the sub basins scale at the sub catchment level the maximum reduction in the sediment yield was attained by emps combinations 78 5 followed by terracing 61 8 and filter strips 54 3 table 7 the increase in channel roughness and channel cover causes a reduction in the surface runoff and channel erodibility which reduces sediment transport in the reach and sub basins degradation from the results it can be concluded that a reduction in sediment yield at the sub basin level is due to the application of emps fig 8 shows that the interventions at the upper sub basins have a positive impact on the erosion in the lower sub basins i e the sub basins 2 19 23 and 24 which were in erosion class of low have improved to very low we can understand that application of emps impacts even some sub basins which are in the category of soil erosion class low to very low which shows improvement of soil erosion as implied in all soil erosion classes sub basins wise over the watershed as shown in table 7 the simulated average annual sediment yields from each sub basin under different scenarios range 0 to 31 13 ton ha yr for the baseline scenario 0 to 18 01 ton ha yr under streambank stabilization 0 to 16 45 ton ha yr under grassed waterway 0 to 15 01 ton ha yr under contour farming use 0 to 13 70 ton ha yr under filter strip use 0 to 10 54 ton ha yr in terracing and 0 to 6 22 ton ha yr under emps combinations it is also clear that in the case of terracing it is possible to curb the soil loss from each sub basin within its permissible upper limit of soil loss i e 14 94 ton ha yr the implementation of different emps could result in up to 78 5 reduction in the average annual sediment yields for emps combinations 61 8 for terracing 54 3 for filter strips 48 8 for the contour farming 41 3 for grassed waterway and 37 3 for streambank stabilization at the sub basins level table 7 in this finding it is vital to implement appropriate emps combinations and an adequate number of natures based emps to minimize soil erosion to a reasonable extent based on the results in fig 9 it can be understood that the implementation of terracing is most desirable for the study area to sustainably and efficiently manage the critical sub basins at the individual level the suggested emps could be implemented phase wise according to the socio economic human resources and site specific conditions to provide sustainable watershed management from a practical viewpoint emps combination offers an economical solution in selecting nature based management practices to tackle soil erosion problems and high runoff generation from agricultural brush land and sloppy watersheds containing considerable plots 3 5 optimal combination of emps areas and cost effectiveness analysis cost is a critical factor in applying emps and we need to optimize the cost of emps for implementation in the study area the optimal cost of different emps for achieving these desirable limits of sediment yield was based on the optimal available space and it was obtained by using matlab programming the total cost for the five critical sub basins is found to be 1 844 billion ethiopian birrs us 46 101 million table 8 which was composed of terracing contour farming filter strips grassed waterway and streambank stabilization sub basin wise the combination of optimal emp satisfies the constraints of discharge sediment and available emp areas while minimizing cost after applying emp technology the annual sediment yield from each sub basin became almost in a natural condition the total critical sub basins cost for emps implementation is depicted in table 8 based on hrus report analysis in swat for each critical sub basins the percentage of area to be covered by different emps is different for example the total area of critical sub 6 is 231 530 ha out of this area 5715 ha is covered by terracing 2078 ha by contour farming 13683 ha by filter strips 20838 ha by grassed waterway and 11310 ha by streambank stabilization after emps area combination it is the same for the rest four critical sub basins table 8 the application of emps is limited due to area availability and budget constraints but provides nature based solutions in a sustainable and economically viable manner for reducing soil erosion and peak discharge the space availability and the cost for emps application are directly proportional to each other in critical sub basins fig 10 the space availability for terracing is very high except in sub 6 and the implementation cost is also high nevertheless for sub 8 the optimal cost is minimal as the respective area availability is small fig 10 this shows that the optimal cost is dependent on the availability of space from fig 10 as the optimal cost of sediment yield reduction depends on area availability constraint it did not directly reflect sediment yield change in the basins moreover sub 6 with high sediment yield manifests high demand of cost while sub 8 still with high sediment yield reflects the small value of emps cost and it is because of implementation cost is highly dependent on the optimal area available within the critical sub basins fig 10 4 discussions the case study in genale watershed demonstrates the convenience of the optimal combination of emps for soil and water conservation practice at sub basins and hrus scale under limited time space financial resources and labor as it may not be possible to cover all areas by emps within the watershed at a time this study has potential scientific merit in the context of evaluating and utilizing sub basins hrus level study in identifying most critical erosion prone area within a prioritized sub basin to minimize the implementation cost of soil and water conservation practices for improving water resources status and supporting decision makers in adopting an optimal and sustainable management strategy in the genale catchment ethiopia analysis at the sub basins hrus scale response has given significant insight into the locations needing management practice within the catchment on a priority basis to take measures locally the study is unique in analyzing the comparative cost effectiveness of terracing filter strips grassed waterway streambank stabilization and contour farming combination in addition to space availability for each option in the context of study areas and the cost estimate is thus appropriate inclusion of cost estimation by considering hrus level therefore provides new and important insights and can prove helpful for future decision making within affordable cost in the previous study owner s choice plays an important role in deciding the most optimal emp combination and the total cost increases with consideration of the owner s choice constraint after implementation of emp combination the annual sediment yield from the watershed became almost natural sarma et al 2015 patowary et al 2019 the current study revealed maximum reduction of sediment yield 61 8 was obtained after the implementation of terracing at individual level and 78 5 for implementation of emps combinations our findings can be compared to statistics carried out in other watersheds on the globe and similar situations are found these scenarios are within the percentage reduction of sediment yield as obtained by a different research scholars such as 71 reduction by the implementation of contour farming lópez ballesteros et al 2019 vegetative contour strips and soil bund were significant in reducing sediment yield below the tolerable soil loss which is equivalent to 63 9 and 64 8 reduction respectively dibaba et al 2021 under nepal parajuli 2022 the combination of bmps reduced the sediment yield up to 50 another study conducted by the sun et al 2019 also proved that the application of grassed waterways reduced the average sediment yield by 53 the study by nadew et al 2018 found that applying terracing in the guder watershed blue nile basin reduced the average annual sediment yield by 53 from the baseline scenario at selected sub basin areas the study by kefay et al 2022 stated implementing terraces in the selected critical sub basins reduced the mean annual sediment yield rate by 47 05 up to 37 2 reduction with the recharge structure the current study was anticipated to develop a scientific approach to choose the most effective emps combinations for reducing sediment yield with due emphasis on economic feasibility a cost analysis was used to evaluate the cost effectiveness of emps combinations however the economic cost has been a significant element for screening the application of emps despite its high implementation cost terracing technology occupied high space availability effectively reduces sediment yield in sub basins the non linear optimization program is computationally more intensive it gives a more realistic scenario of the total cost effective of a watershed management practice through emps combinations for the agricultural and brush land area of the sub basin actions are needed to raise awareness of the watershed soil degradation problem and remove the barriers limiting the adoption of emps combinations analysis till hrus scale brings more clarity in the erosion aspects and helps narrowing down to the critical areas and it becomes easier to address the challenges with low human resources low cost and within a short time where impacts were significant a major limitation of this study was the unavailability of the recent and up to date sediment data it spikes up down broken and not continuous for the validation of the sediment yield modeling results using swat musle one of the other limitations of this study is difficulty in fixing constraints and space area availability during cost optimization for emps implementation the quality of work could have been improved if the recent data had been available it is also recommended to consider temporal variation in land use cover to develop a more realistic scenario for the evaluation of emps 5 conclusions this article deals with the reduction of sediment yield through application of feasible emps combination appraisal of the space availability and cost effectiveness of five potential emps namely contour farming grassed waterway terracing streambank stabilization and filter strips combination in reducing the sediment yields at sub basin scales in the genale watershed using the hydrological model swat musle and an optimization programming developed using matlab the identification of critical sub basins based on the upper tolerance limit of sediment rate loss 12 35 ton ha yr revealed that 5 sub basins sub 6 7 8 10 and 12 covering 22 47 of the study area are under erosion critical condition from the scenarios analysis the implementation of emp under the terracing scenario as an individual and emps combination is the most effective in the study area to control sub basin degradation under financial constraints the resulted optimization model minimizes the overall implementation and maintenance cost of emps for five prioritized critical sub basins satisfying the constraints like allowable sediment yield allowable peak discharge and maximum emp area availability from the results it is seen that some sub basins with high sediment yield manifests high demand of cost while others with high sediment yield reflects relatively small value of emps cost this is because of the fact that the implementation cost is highly dependent on the type of the degraded areas that need treatment within the critical sub basins and suitability of emp combination for those degraded area the total optimal cost for the selected five critical sub basins is found to be 1 844 billion ethiopian birrs us 46 101 million which was composed of terracing contour farming filter strips grassed waterway and streambank stabilization area combinations inclusion of cost estimation by considering hrus level therefore provides new and important insights and can prove helpful for future decision making within affordable cost the current study was anticipated to develop a scientific approach to choose the most effective emps combinations for reducing sediment yield with due emphasis on economic feasibility from the analysis we suggest that local authorities adopt terracing practice as a control measure if single emp is applied individually however if the combination of emps is applied it performs much better than any single emp choosing economically attractive and socially acceptable emps through community participation is also an important key towards successful implementation of emps in the affected areas declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
