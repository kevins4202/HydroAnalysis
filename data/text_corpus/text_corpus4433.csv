index,text
22165,a novel data driven sideslip observer based adaptive sliding mode path follo wing control dso aspc scheme is proposed for underactuated marine vessels in the presence of large and time varying sideslip main contributions are as follows 1 a data driven sideslip observer dso by estimating both lumped unknown dynamics induced by sideslip angle and the discretization error is innovatively proposed and thereby contributing to high accuracy estimation of large sideslip angle which is allowed to be time varying 2 a dso based line of sight dlos guidance law is further devised to guide the heading angle and compensate the sideslip 3 by virtue of the estimated surge speed and heading guidance data driven velocity controllers are designed by sliding mode technique in addition that theoretical analysis is provided to guarantee asymptotic stability of the overall path following closed loop system simulation studies are finally conducted to demonstrate the efficiency and superiority of the proposed dso aspc approach keywords data driven sideslip observer underactuated marine vessels path following control adaptive sliding mode control 1 introduction during the past decades the motion control of underactuated marine vessels umvs got conspicuous attention because of their wide applications in various control tasks including trajectory tracking control luo et al 2013 wang et al 2019a dynamic property prediction sutulo and guedes soares 2019 formation control hinostroza et al 2019 qin et al 2019a sun et al 2019 visual based control wang and he 2019 fault tolerant control wang and deng 2019 qin et al 2019b path following control wang et al 2019b et al on the other hand with the wide development of intelligent vessels and complicated requirements of modern task the umvs are suffering from various uncertainties and external disturbances thereby leading to inevitable difficulties for control engineers e g unmeasurable and time varying large sideslip actually for an underactuated surface vehicle only surge and yaw dynamics can be directly actuated by propeller and rudder respectively while the sway dynamics would be indirectly driven by the surge and yaw sutulo and guedes soares 2005 in this context there always exists the sideslip angle between the surge and sway which cannot be measured directly by a sensor hence it is highly desirable to estimate the sideslip angle which is actually time varying in a large range in addition the digital controller design has also been widely applied in various fields due to rapid development of computer techniques wang and zhang 2018 ren et al 2018 in this respect it is still a challenging and meaningful task to devise an efficient sideslip observer based robust digital controller for such unknown umvs with time varying large sideslip xu and guedes soares 2018 path following control is one of the most efficient control approaches in dealing with the foregoing umvs wang et al 2019c the key point of the path following control is the design of the guidance and control system wang and ahn 2019 in light of the path information the guidance system could produce the target heading angle and surge speed for the control system wang and pan 2019 wang and karimi 2019 in this respect by devising a guidance law and the corresponding surge yaw velocity controllers the umvs could be regulated to follow a predefined path in fossen et al 2003 pettersen and lefeber 2001 a line of sight los guidance system was innovatively proposed to deal with the straight line tracking problem a new approach concerning the calculation of a dynamic line of sight vector norm was then presented by moreira and guedes soares moreira et al 2007 to improve the speed of the convergence of the vehicle to the desired path then considering the effect of sideslip induced by wave current and wind an integral los ilos guidance law was proposed to guarantee the path following performance intact to these external disturbances caharija et al 2016 for the unknown constant sideslip an adaptive los alos guidance strategy with adaptive sideslip compensation was addressed in fossen et al 2014 furthermore for the unknown time varying sideslip various sideslip observers were proposed to compensate the sideslip and ensure the robust following of a reference path fossen and lekkas 2015 miao et al 2017 however these methods have not considered the large sideslip case in addition the scenario when the surge speed is unmeasurable is also not addressed apart from the guidance system the control system regarding the surge and yaw velocities has also received considerable attentions wang and pan 2019 wang et al 2019d generally researchers are primarily focus on two kinds of control strategies i e model based and approximation based schemes wang et al 2016a 2018 on one hand the model based schemes including backstepping control zheng and feroskhan 2017 adaptive control annamalai et al 2015 and sliding mode control smc ashrafiuon et al 2008 perera and guedes soares 2012 have been deployed via the obtained mathematical model on the other hand based on the model information of system order the approximation based approaches have also been developed by utilizing the neural network technique wang et al 2014 2015 2016b nevertheless the model information of the umv is usually hardly be obtained due to the various uncertainties and external disturbances in practice fortunately data driven control ddc techniques have exhibited notorious ability in dealing with unknown nonlinear systems and have received conspicuous applications in various fields including industrial processes wang and shang 2008 mechanical systems li et al 2017 vehicle systems xu et al 2017 et al the conventional ddc scheme i e model free adaptive control mfac was originally proposed by hou 1994 as demonstrated in hou 1994 this method could produce the control law only depend on the process data thereby contributing to data driven and model free the mfac approaches for siso and mimo systems were addressed in hou and jin 2011a and hou and jin 2011b respectively then the mfac control law under the effect of disturbances was considered in bu et al 2012 furthermore the robust data driven controller design was also investigated in wang and hou 2008 weng and gao 2017a recently it is worth mentioning that a data driven adaptive tracking controller was proposed in weng et al 2018 to achieve tracking control for a fully actuated surface vessel however it cannot guarantee the robustness theoretically in this context the tracking performance under this strategy may be affected or even degraded when attempting to solve the path following problem of unknown umvs in this study based on the foregoing observations this study aims at designing a novel data driven sideslip observer based adaptive sliding mode path following control dso aspc law for the unknown umvs with time varying large sideslip and disturbances the key point of this study can be summarized as follows i by devising an efficient data driven sideslip observer dso the sideslip angle could be estimated accurately thereby contributing to a reliable and robust dso based los dlos guidance scheme it is worth mentioning that the proposed dso is simple and the surge speed of the umv permits to be unmeasurable whereby the convergence could be ensured theoretically furthermore different from the previous los guidance method the unknown sideslip angle allows to be varied in a large scope ii within the velocity control system a data driven smc approach is developed to deal with the model unavailable issues in umvs it is interestingly noticed that the proposed control scheme is completely model free i e none of the model information is utilized iii both robustness and stability could be guaranteed theoretically thereby contributing to strong adaptability to the variations induced by uncertainties and disturbances in umvs the rest of this paper is organized as section 2 gives the system description and some necessary assumptions the dlos guidance scheme and the data driven velocity controllers are proposed in sections 3 and 4 respectively section 5 is devoted to analyzing the stability of the overall closed loop system and simulation studies regarding an umv are provided in section 6 section 7 provides some conclusions 2 problem formulation 2 1 system description according to skjetne et al 2005 wang and er 2015 the dynamics of the umv in the horizontal plane can be represented by 1a η n ϕ υ 1b m t υ τ c υ υ d υ υ g η d where η x y ϕ t and τ τ u 0 τ r t denote the plant s output and control input respectively n ϕ denotes the commonly used rotation matrix υ u v r t denotes the velocity variable vector in the body fixed frame i e the surge sway and yaw velocities and d d u d v d r t denotes the total disturbances induced by internal uncertainties unknown dynamics and external disturbances remark 1 note that the surge speed is unmeasurable in this study in addition the model information is also unavailable i e the variables including c υ d υ and m t are totally treated as unknown nonlinearities since they are very hard to obtain in practice 2 2 path following error dynamics by defining a variable θ a desired θ dependent path could be constructed in fig 1 thus for a fixed point x d θ y d θ in the desired path the path tangential angle α d θ could be obtained via α d θ atan 2 y d θ x d θ with y d θ y d θ θ and x d θ x d θ θ in this respect a new path dependent reference frame prf can be established via clockwise rotating the earth fixed frame with angle α d θ then let x e and y e denote the path following errors under the prf frame i e the tracking errors along the x d and y d directions respectively we have 2 x e y e cos α d θ sin α d θ sin α d θ cos α d θ x x d θ y y d θ combining 1 with 2 we can obtain the dynamics of x e and y e as follows wang et al 2019e 3 x e u cos ϕ α d θ β α d θ y e θ x d θ 2 y d θ 2 y e u sin ϕ α d θ β α d θ x e where u u 2 v 2 denotes the course speed i e the practical velocity of the umv 1 β atan 2 v u denotes the sideslip angle due to the effect of sway velocity v since the umv consistently suffers from various external disturbances the dynamics in the sway velocity may be excited thereby resulting in an undesirable time varying and even large sideslip angle β when tracking along a reference curved path thus under the effect of time varying large sideslip angle β this study aims at designing a dlos guidance law and a corresponding model free adaptive smc law such that the asymptotic following of a given path x d θ y d θ could be achieved i e 4 x e k 0 y e k 0 where x e k and y e k are the sampling values of x e and y e respectively at instant k t s and t s is a predesigned sampling time remark 2 different from the existing achievements focusing on the constant or small scaled sideslip angle fossen and lekkas 2015 miao et al 2017 a time varying large sideslip angle is considered in this study thereby contributing to a more applicable control strategy for the umv s path following problem 3 dlos guidance law design in this section we will focus on the dlos guidance law design for the purpose of clarity the diagram of the proposed discrete time sideslip observer based model free sliding mode path following control scheme is given in fig 2 as exhibited in fig 2 main contributions of this section include i the dso design ii the guidance law design iii the corresponding stability analysis under the developed guidance law 3 1 dso design to achieve the above control objective an equivalent discrete form of tracking error dynamics 3 based on first order euler technique is achieved as follows 5 x e k 1 x e k t s u k cos ϕ k α d θ k β k α d θ k y e k u t a r k o x e k y e k 1 y e k t s u k sin ϕ k α d θ k β k α d θ k x e k o y e k where u k ϕ k α d θ k α d θ k denote the sampling values of u ϕ α d θ α d θ respectively at instant k t s o x e k and o y e k denote the discretization errors u t a r k denotes the virtual target velocity with u t a r k δ θ k x d θ k 2 y d θ k 2 and δ θ k θ k θ k 1 by defining g k u k sin ϕ k α d θ k β k the dynamic of the cross track error becomes 6 y e k 1 y e k t s g k t s α d θ k x e k o y e k let o ˆ y e k denote the estimation value of o y e k then we can design the data driven observer for 6 as follows 7 y ˆ e k 1 y ˆ e k t s g ˆ k t s α d θ k x e k o ˆ y e k with g ˆ k denotes the estimation value of g k to obtain g ˆ k in 7 we select the following criterion index function hou and jin 2011b for g ˆ k such that 8 j g ˆ k δ y e k t s g ˆ k t s α d θ k 1 x e k 1 o ˆ y e k 1 2 μ 1 g ˆ k g ˆ k 1 2 where μ 1 denotes a positive weight coefficient letting j g ˆ k g ˆ k 0 yields 9 g ˆ k g ˆ k 1 ρ 1 t s μ 1 t s 2 δ y e k t s g ˆ k 1 t s α d θ k 1 x e k 1 o ˆ y e k 1 10 g ˆ k g ˆ 1 i f g ˆ k ε 1 o r sgn g ˆ k sgn g ˆ 1 where ρ 1 0 1 denotes a step size constant ε 1 denotes a small positive constant then inspired by disturbance observer strategy zhao et al 2019a zhao et al 2019b weng and gao 2017b we can design the corresponding data driven adaptive law for o ˆ y e k as follows 11 o ˆ y e k o ˆ y e k 1 κ 1 y e k y ˆ e k with κ 1 as a step size coefficient finally the sideslip angle β k can be estimated by 12 β ˆ k arcsin g ˆ k u k ϕ k α d θ k remark 3 as the surge velocity is disturbed by various uncertainties and disturbances and kept positive the nonsingularity issue for estimating β k could be ensured moreover inspired by weng and gao 2017b we can obtain that g ˆ k and o ˆ y e k is bounded thereby indicating that β ˆ k is also bounded 3 2 guidance law design based on the established data driven sideslip observer 12 we can design the guidance law as follows 13 ϕ d k α d θ k β ˆ k arctan y e k ξ where ξ denotes the look ahead distance then in view of 5 and 13 we have 14 y e k 1 1 t s u k ξ 2 y e k 2 y e k t s g k t s α d θ k x e k o y e k with g k g ˆ k g k furthermore to stabilize x e k the virtual target velocity u t a r k is designed as 15 u t a r k t s u k cos ϕ d k α d θ k β ˆ k α d θ k y e k κ 2 x e k which combining 5 with 14 yields 16 θ k θ k 1 t s u k cos ϕ d k α d θ k β ˆ k α d θ k y e k κ 2 x e k x d θ k 2 y d θ k 2 where κ 2 is a positive constant then it follows from 5 and 15 that 17 x e k 1 1 t s κ 2 x e k o x e k consequently the following lemma can be obtained for 14 and 17 lemma 1 for the umv 1 with data driven sideslip observer g ˆ k designed by 12 guidance law ϕ d k designed by 13 virtual target velocity u t a r k designed by 15 and κ 2 selected as κ 2 α d θ k if appropriate surge controller and heading controller are developed such that u k and ϕ k could track the reference values i e the reference surge velocity u d k and the reference yaw angle ϕ d k then the convergence of the path following errors i e x e k y e k could be guaranteed proof define the lyapunov function as 18 v 1 k y e k x e k then in view of 14 and 17 we have 19 δ v 1 k y e k 1 x e k 1 y e k x e k t s u k ξ 2 y e k 2 y e k t s κ 2 t s α d θ k x e k t s g k o a l l k with o a l l k o y e k o x e k and g k o a l l k are bounded by defining h min t s u k ξ 2 y e k 2 t s κ 2 t s α d θ k we have 20 δ v 1 k h 1 θ e k h θ e k t s g k o a l l k where e k x e k y e k t since e k t s g k o a l l k h θ indicates 21 δ v 1 k h 1 θ e k thus x e k and y e k will finally converge to a bounded region hence lemma 1 is achieved remark 4 it is worth mentioning that the existence of large and time varying sideslip angle is considered in this study under which the conditions sin β β and cos β 1 are no longer hold thus the developed observer based guidance law could be applied to a more complex path following issue for surface vessels 4 velocity controller design to obtain the model free adaptive sliding mode path following controller the equivalent discrete form of surge and heading dynamics is given as 22 u k 1 u k f u u k v k r k d u k t s τ u k m 11 k o u k ϕ k 1 ϕ k t s r k o ϕ k r k 1 r k f r u k v k r k d r k t s τ r k m 33 k o r k where f u u k v k r k d u and f r u k v k r k d u denote the unknown lumped dynamics including unmodeled dynamics uncertainties and external disturbances and o u k and o r k denote the discretization errors in what follows a common assumption regarding the above surge and yaw dynamics is presented as follows assumption 1 the surge and yaw dynamics satisfy lipschitz conditions i e δ u k 1 γ 1 τ u k and δ r k 1 γ 2 τ r k where δ u k 1 u k 1 u k δ r k 1 r k 1 r k and γ 1 γ 2 are positive constants remark 5 according to hou and jin 2011a it is noticed that assumption 1 is a common description for practical systems such as markovian jump systems qi et al 2018 planar nonlinear systems wang et al 2017 vehicle systems xu et al 2017 et al 4 1 surge controller design in light of 22 the surge dynamic can be written as 23 u k 1 u k φ u k τ u k where φ u k t s m 11 k f u u k v k r k d u k o u k τ u k let φ ˆ u k denote the estimation value of φ u k then an index function for φ ˆ u k can be designed as 24 j φ ˆ u k u ˆ k u ˆ k 1 φ ˆ u k τ u k 1 2 μ 2 φ ˆ u k φ ˆ u k 1 2 where μ 2 is a weight coefficient and u ˆ k u k cos β ˆ k by solving j φ ˆ u k φ ˆ u k 0 we can obtain 25 φ ˆ u k φ ˆ u k 1 ρ 2 τ u k 1 μ 2 τ u k 1 2 δ u ˆ k φ ˆ u k 1 τ u k 1 26 φ ˆ u k φ ˆ u 1 i f φ ˆ u k ε 2 o r sgn φ ˆ u k sgn φ ˆ u 1 where ρ 2 0 1 is a step size constant ε 2 is a small positive constant consider the sequel sliding mode surface 27 s u k 1 e u k 1 c u e u k where e u k 1 u k 1 u d k c u 0 1 is a positive constant in light of the adaptive laws 25 26 and solving s u k 1 0 we can obtain the equivalent control law as 28 τ u e q k u d k u ˆ k c u e u k φ ˆ u k σ u where σ u is a positive constant then a high order discontinuous control law can be further designed as 29 τ u d i s k φ ˆ u k 1 σ u τ u d i s k 1 ρ u sgn s u k φ ˆ u k σ u where ρ u is a gain constant consequently we can derive the surge controller as 30 τ u k τ u e q k τ u d i s k 4 2 yaw controller design let z ϕ 1 k ϕ k ϕ d k 2 then it follows from 22 that 31 z ϕ 1 k 1 ϕ k t s r k o ϕ k ϕ d k 1 to derive the yaw control law τ r k a virtual control law for heading dynamic of 22 can be designed as 32 β k ϕ d k 1 ϕ k κ 3 z ϕ 1 k t s by defining the virtual tracking error as z ϕ 2 k r k β k we have 33 z ϕ 1 k 1 κ 3 z ϕ 1 k t s z ϕ 2 k o ϕ k thus the control task is transformed into stabilizing z ϕ 2 k in this respect similar as that in section 4 1 we can design the yaw controller as 34 τ r k τ r e q k τ r d i s k with τ r e q k designed as 35 τ r e q k β k 1 r k c r z ϕ 2 k φ ˆ r k σ r and τ r d i s k designed as 36 τ r d i s k φ ˆ r k 1 σ r τ r d i s k 1 ρ r sgn s r k φ ˆ r k σ r where 37 φ ˆ r k φ ˆ r k 1 ρ 3 τ r k 1 μ 3 τ r k 1 2 δ r k φ ˆ r k 1 τ r k 1 38 φ ˆ r k φ ˆ r 1 i f φ ˆ r k ε 3 o r sgn φ ˆ r k sgn φ ˆ r 1 and s r k 1 z ϕ 2 k 1 c r z ϕ 2 k c r 0 1 is a positive constant ρ 3 0 1 is a step size constant ε 3 is a small positive constant σ r is a positive constant ρ r is a gain constant 5 stability analysis before proceeding the surge dynamic 23 is rewritten as 39 u k 1 u ˆ k φ ˆ u k σ u τ u k ε u k with ε u k φ u k φ ˆ u k σ u τ u k u k u ˆ k inspired by hou and jin 2011b and the above analysis it is noticed that ε u k is bounded in this respect there exists a positive constant ε 1 such that 40 max i 2 k ε u i ε u i 1 ε 1 similarly we can have the following result 41 max i 2 k ε r i ε r i 1 ε 2 with ε 2 as a positive constant consequently we can have the following theorem theorem 1 consider the umv 1 with data driven sideslip angle observer 12 guidance law 13 the virtual target velocity 15 and velocity controllers in 30 and 34 if parameters ρ u and ρ r satisfy 42 ρ u ε 1 43 ρ r ε 2 then the umv can asymptotically follow the desired path proof in what follows we divide two steps to analyze theorem 1 step 1 proofing the boundedness of e u k and z ϕ 1 k consider the sequel lyapunov function 44 v 2 k s u k in view of 30 and 39 we have 45 s u k 1 φ ˆ u k 1 σ u τ u d i s k ρ u sgn s u k ε u k which further indicates 46 s u k φ ˆ u k 1 σ u τ u d i s k ε u k 1 by defining δ v 2 k v 2 k 1 v 2 k we have 47 δ v 2 k s u k ε u k ε u k 1 ρ u sgn s u k s u k finally in light of 40 42 and the proof in mihoub et al 2011 δ v 2 k 0 for s u k ε 1 ρ u consequently s u k will finally converge to a neighborhood of the origin thereby indicating the boundedness of e u k similarly it is noticed that z ϕ 2 k is also bounded which in view of 33 further indicates the boundedness of z ϕ 1 k step 2 proofing the boundedness of the path following errors i e x e k and y e k in view of step 1 there exist tracking errors in the velocity control loop in this context the path following error dynamics under control laws 30 and 34 can be further written as 48 x e k 1 x e k t s u d k cos ϕ d k α d θ k α d θ k y e k u d k sin ϕ d k α d θ k tan β ˆ k u d k x e k y e k 1 y e k t s u d k sin ϕ d k α d θ k α d θ k x e k u d k sin ϕ d k α d θ k tan β ˆ k y e k where ε x e k t s u e k cos ϕ k α d θ k β k cos β k u d k cos ϕ e k 1 cos ϕ d k α d θ k u d k sin ϕ e k sin ϕ d k α d θ k β k cos β k u d k sin ϕ d k α d θ k tan β ˆ k cos ϕ e k tan β k o x e k ε y e k t s u e k sin ϕ k α d θ k β k cos β k u d k cos ϕ e k 1 sin ϕ d k α d θ k u d k sin ϕ e k cos ϕ d k α d θ k β k cos β k u d k cos ϕ d k α d θ k cos ϕ e k tan β k tan β ˆ k o y e k and u e k u k u d k ϕ e k ϕ k ϕ d k in view of step 1 u e k and ϕ e k will finally converge to the origin thereby indicating the boundedness of ε x e k and ε y e k consequently combining with lemma 1 we can conclude that x e k and y e k also have the upper bounds therefore theorem 1 is reasonable 6 simulation studies in the following section the simulation studies regarding the proposed dso aspc approach and the relative method are conducted in addition the cybership ii skjetne et al 2005 is chosen as the data generator and the dynamics are described as that in 1 with the disturbances governed by 49 d k 1 2 0 1 u k 3 0 5 0 1 u k 2 0 1 r k 3 0 2 sin v k then the umv 1 are initialized by choosing t s 0 01 s υ 1 0 2 0 0 t and η 1 5 0 0 t the reference path is selected as 50 x d θ k 20 sin 0 05 θ k θ k y d θ k θ k with θ k updated by 51 θ k θ k 1 u t a r k x d θ k 2 y d θ k 2 where u t a r k is designed as that in 15 in addition the reference surge velocity and heading angle are designed as 52 u d k 2 0 5 sin k π 2000 ϕ d k α d θ k β ˆ k arctan y e k ξ with ξ to be determined in the sequel in dso aspc scheme parameters ρ 1 κ 1 μ 1 ε 1 κ 2 and ξ need to be determined for guidance subsystem specifically ρ 1 and κ 1 are selected as step size factors μ 1 is selected as positive constant and ε 1 is selected as a relatively small constant in view of 9 11 it is noticed that ρ 1 κ 1 and μ 1 determine the updating speed of g ˆ k and o ˆ y e k furthermore κ 2 should be selected in the region α d θ k according to 17 κ 2 greatly affects the convergence speed of x e k in addition ξ is selected as a positive constant whereby equation 14 indicates ξ is related to the convergence speed of y e k in the velocity control subsystem parameters ρ 2 ρ 3 μ 2 μ 3 ε 2 ε 3 c u c r κ 3 σ u σ r ρ u and ρ r need to be selected in particular ρ 2 and ρ 3 are selected as step size factors μ 2 and μ 3 are selected as positive constants and ε 2 and ε 3 are selected as relatively small constants according to 25 26 37 and 38 ρ 2 ρ 3 μ 2 and μ 3 greatly affect the updating speed of φ ˆ r k and φ ˆ u k furthermore c u c r and κ are selected as step size factors and c u c r and κ 3 determine the final convergence speed of e u k e u k and z ϕ 1 k respectively in addition σ u and σ r are selected as positive constants and the selection of ρ u and ρ r is subjected to 42 and 43 respectively the relatively big σ u and σ r or small ρ u and ρ r will generate relatively small control laws thereby leading to insufficient control efforts on the contrary the relatively small σ u and σ r or big ρ u and ρ r will generate relatively large control laws thereby causing undesirable chattering consequently applying the aforementioned parameter tuning guidelines the controller parameters of dso aspc are selected as μ 1 0 005 ρ 1 0 8 ε 1 0 001 κ 1 0 9 κ 2 0 6 μ 2 0 1 ρ 2 0 8 φ u 1 0 001 ε 2 0 001 c u 150 ρ u 5 σ u 3300 κ 3 0 1 μ 3 0 1 ρ 3 0 8 φ r 1 0 001 ε 3 0 001 c r 300 ρ r 5 σ r 4000 and ξ 1 8 6 1 validation of the dlos guidance law to effectively evaluate the efficacy of the proposed dlos guidance law the dso aspc scheme without dlos guidance law dso aspc dso is also selected for comparison analysis the simulation results including the path following errors path following performance sideslip angle estimation surge speed and heading angle tracking performances are exhibited in figs 3 8 furthermore to clearly illustrate the comparison curves the quantitative comparison results of path following performance including the integral of the absolute error iae and the integral of the time multiplied by the absolute value of the error itae are also provided in the sequel whereby iae1 and itae1 denote the corresponding performance indices regarding the path following errors and iae2 and itae2 denote the corresponding performance indices regarding the surge speed and heading angle tracking errors from figs 3 and 4 and table 1 it is noticed that the sideslip angle has a great effect on the path following performance in the dso aspc dso control system although the surge controller and heading controller could effectively accomplish the control task i e tracking the desired surge speed and heading angle see fig 6 there still exist fluctuations in the cross track error due to the effects of unknown sideslip angle on the contrary by virtue of the developed dso in dso aspc control system the unknown sideslip angle could be estimated accurately see fig 5 thereby contributing to a convergent tracking performance see figs 3 and 4 and table 1 6 2 validation of the aspc scheme in this subsection we will further evaluate the effectiveness of the proposed aspc scheme in this context the dso based pid dso pid scheme is chosen for comparison similarly we can obtain the corresponding simulation curves exhibited in figs 9 13 and table 2 as shown in figs 11 and 12 and table 2 the proposed aspc scheme shows better tracking performance due to the adoption of the data driven scheme and adaptive strategy on the contrary these nonlinearities uncertainties and disturbances result in large tracking errors in the dso pid control system then this large heading angle tracking error further lead to the fluctuations in the path following errors see figs 9 and 10 and table 2 7 conclusions this paper has investigated the data driven robust path following control problem of unknown umvs with uncertainties disturbances and time varying large sideslip by developing a data based sideslip observer a novel dlos guidance law has been proposed to facilitate the guidance system design furthermore the data driven smc scheme has also been developed to regulate the dynamics of the umvs it has been shown that the umv could follow a reference path by applying the proposed dlos guidance law regardless of the existence of time varying large sideslip in addition the uncertainties and disturbances have been attenuated effectively via the developed data driven smc method finally it has been shown in simulation studies that the developed guidance law and controller could efficiently regulate the system s dynamics and follow a predefined path credit author statement yongpeng weng data curation writing original draft preparation conceptualization methodology software visualization validation ning wang supervision conceptualization writing reviewing and editing visualization funding acquisition c guedes soares supervision writing reviewing and editing declaration of competing interest none acknowledgment this work was supported by the national natural science foundation of china of p r china under grants 51009017 51379002 and 61803063 the fund for dalian distinguished young scholars under grant 2016rj10 the fund for liaoning innovative talents in colleges and universities under grant lr2017024 the fundamental research funds for the central universities under grants 3132019344 3132019108 and 3132018126 and the stable supporting fund of science and technology on underwater vehicle laboratory sxjqr2018wdkt03 
22165,a novel data driven sideslip observer based adaptive sliding mode path follo wing control dso aspc scheme is proposed for underactuated marine vessels in the presence of large and time varying sideslip main contributions are as follows 1 a data driven sideslip observer dso by estimating both lumped unknown dynamics induced by sideslip angle and the discretization error is innovatively proposed and thereby contributing to high accuracy estimation of large sideslip angle which is allowed to be time varying 2 a dso based line of sight dlos guidance law is further devised to guide the heading angle and compensate the sideslip 3 by virtue of the estimated surge speed and heading guidance data driven velocity controllers are designed by sliding mode technique in addition that theoretical analysis is provided to guarantee asymptotic stability of the overall path following closed loop system simulation studies are finally conducted to demonstrate the efficiency and superiority of the proposed dso aspc approach keywords data driven sideslip observer underactuated marine vessels path following control adaptive sliding mode control 1 introduction during the past decades the motion control of underactuated marine vessels umvs got conspicuous attention because of their wide applications in various control tasks including trajectory tracking control luo et al 2013 wang et al 2019a dynamic property prediction sutulo and guedes soares 2019 formation control hinostroza et al 2019 qin et al 2019a sun et al 2019 visual based control wang and he 2019 fault tolerant control wang and deng 2019 qin et al 2019b path following control wang et al 2019b et al on the other hand with the wide development of intelligent vessels and complicated requirements of modern task the umvs are suffering from various uncertainties and external disturbances thereby leading to inevitable difficulties for control engineers e g unmeasurable and time varying large sideslip actually for an underactuated surface vehicle only surge and yaw dynamics can be directly actuated by propeller and rudder respectively while the sway dynamics would be indirectly driven by the surge and yaw sutulo and guedes soares 2005 in this context there always exists the sideslip angle between the surge and sway which cannot be measured directly by a sensor hence it is highly desirable to estimate the sideslip angle which is actually time varying in a large range in addition the digital controller design has also been widely applied in various fields due to rapid development of computer techniques wang and zhang 2018 ren et al 2018 in this respect it is still a challenging and meaningful task to devise an efficient sideslip observer based robust digital controller for such unknown umvs with time varying large sideslip xu and guedes soares 2018 path following control is one of the most efficient control approaches in dealing with the foregoing umvs wang et al 2019c the key point of the path following control is the design of the guidance and control system wang and ahn 2019 in light of the path information the guidance system could produce the target heading angle and surge speed for the control system wang and pan 2019 wang and karimi 2019 in this respect by devising a guidance law and the corresponding surge yaw velocity controllers the umvs could be regulated to follow a predefined path in fossen et al 2003 pettersen and lefeber 2001 a line of sight los guidance system was innovatively proposed to deal with the straight line tracking problem a new approach concerning the calculation of a dynamic line of sight vector norm was then presented by moreira and guedes soares moreira et al 2007 to improve the speed of the convergence of the vehicle to the desired path then considering the effect of sideslip induced by wave current and wind an integral los ilos guidance law was proposed to guarantee the path following performance intact to these external disturbances caharija et al 2016 for the unknown constant sideslip an adaptive los alos guidance strategy with adaptive sideslip compensation was addressed in fossen et al 2014 furthermore for the unknown time varying sideslip various sideslip observers were proposed to compensate the sideslip and ensure the robust following of a reference path fossen and lekkas 2015 miao et al 2017 however these methods have not considered the large sideslip case in addition the scenario when the surge speed is unmeasurable is also not addressed apart from the guidance system the control system regarding the surge and yaw velocities has also received considerable attentions wang and pan 2019 wang et al 2019d generally researchers are primarily focus on two kinds of control strategies i e model based and approximation based schemes wang et al 2016a 2018 on one hand the model based schemes including backstepping control zheng and feroskhan 2017 adaptive control annamalai et al 2015 and sliding mode control smc ashrafiuon et al 2008 perera and guedes soares 2012 have been deployed via the obtained mathematical model on the other hand based on the model information of system order the approximation based approaches have also been developed by utilizing the neural network technique wang et al 2014 2015 2016b nevertheless the model information of the umv is usually hardly be obtained due to the various uncertainties and external disturbances in practice fortunately data driven control ddc techniques have exhibited notorious ability in dealing with unknown nonlinear systems and have received conspicuous applications in various fields including industrial processes wang and shang 2008 mechanical systems li et al 2017 vehicle systems xu et al 2017 et al the conventional ddc scheme i e model free adaptive control mfac was originally proposed by hou 1994 as demonstrated in hou 1994 this method could produce the control law only depend on the process data thereby contributing to data driven and model free the mfac approaches for siso and mimo systems were addressed in hou and jin 2011a and hou and jin 2011b respectively then the mfac control law under the effect of disturbances was considered in bu et al 2012 furthermore the robust data driven controller design was also investigated in wang and hou 2008 weng and gao 2017a recently it is worth mentioning that a data driven adaptive tracking controller was proposed in weng et al 2018 to achieve tracking control for a fully actuated surface vessel however it cannot guarantee the robustness theoretically in this context the tracking performance under this strategy may be affected or even degraded when attempting to solve the path following problem of unknown umvs in this study based on the foregoing observations this study aims at designing a novel data driven sideslip observer based adaptive sliding mode path following control dso aspc law for the unknown umvs with time varying large sideslip and disturbances the key point of this study can be summarized as follows i by devising an efficient data driven sideslip observer dso the sideslip angle could be estimated accurately thereby contributing to a reliable and robust dso based los dlos guidance scheme it is worth mentioning that the proposed dso is simple and the surge speed of the umv permits to be unmeasurable whereby the convergence could be ensured theoretically furthermore different from the previous los guidance method the unknown sideslip angle allows to be varied in a large scope ii within the velocity control system a data driven smc approach is developed to deal with the model unavailable issues in umvs it is interestingly noticed that the proposed control scheme is completely model free i e none of the model information is utilized iii both robustness and stability could be guaranteed theoretically thereby contributing to strong adaptability to the variations induced by uncertainties and disturbances in umvs the rest of this paper is organized as section 2 gives the system description and some necessary assumptions the dlos guidance scheme and the data driven velocity controllers are proposed in sections 3 and 4 respectively section 5 is devoted to analyzing the stability of the overall closed loop system and simulation studies regarding an umv are provided in section 6 section 7 provides some conclusions 2 problem formulation 2 1 system description according to skjetne et al 2005 wang and er 2015 the dynamics of the umv in the horizontal plane can be represented by 1a η n ϕ υ 1b m t υ τ c υ υ d υ υ g η d where η x y ϕ t and τ τ u 0 τ r t denote the plant s output and control input respectively n ϕ denotes the commonly used rotation matrix υ u v r t denotes the velocity variable vector in the body fixed frame i e the surge sway and yaw velocities and d d u d v d r t denotes the total disturbances induced by internal uncertainties unknown dynamics and external disturbances remark 1 note that the surge speed is unmeasurable in this study in addition the model information is also unavailable i e the variables including c υ d υ and m t are totally treated as unknown nonlinearities since they are very hard to obtain in practice 2 2 path following error dynamics by defining a variable θ a desired θ dependent path could be constructed in fig 1 thus for a fixed point x d θ y d θ in the desired path the path tangential angle α d θ could be obtained via α d θ atan 2 y d θ x d θ with y d θ y d θ θ and x d θ x d θ θ in this respect a new path dependent reference frame prf can be established via clockwise rotating the earth fixed frame with angle α d θ then let x e and y e denote the path following errors under the prf frame i e the tracking errors along the x d and y d directions respectively we have 2 x e y e cos α d θ sin α d θ sin α d θ cos α d θ x x d θ y y d θ combining 1 with 2 we can obtain the dynamics of x e and y e as follows wang et al 2019e 3 x e u cos ϕ α d θ β α d θ y e θ x d θ 2 y d θ 2 y e u sin ϕ α d θ β α d θ x e where u u 2 v 2 denotes the course speed i e the practical velocity of the umv 1 β atan 2 v u denotes the sideslip angle due to the effect of sway velocity v since the umv consistently suffers from various external disturbances the dynamics in the sway velocity may be excited thereby resulting in an undesirable time varying and even large sideslip angle β when tracking along a reference curved path thus under the effect of time varying large sideslip angle β this study aims at designing a dlos guidance law and a corresponding model free adaptive smc law such that the asymptotic following of a given path x d θ y d θ could be achieved i e 4 x e k 0 y e k 0 where x e k and y e k are the sampling values of x e and y e respectively at instant k t s and t s is a predesigned sampling time remark 2 different from the existing achievements focusing on the constant or small scaled sideslip angle fossen and lekkas 2015 miao et al 2017 a time varying large sideslip angle is considered in this study thereby contributing to a more applicable control strategy for the umv s path following problem 3 dlos guidance law design in this section we will focus on the dlos guidance law design for the purpose of clarity the diagram of the proposed discrete time sideslip observer based model free sliding mode path following control scheme is given in fig 2 as exhibited in fig 2 main contributions of this section include i the dso design ii the guidance law design iii the corresponding stability analysis under the developed guidance law 3 1 dso design to achieve the above control objective an equivalent discrete form of tracking error dynamics 3 based on first order euler technique is achieved as follows 5 x e k 1 x e k t s u k cos ϕ k α d θ k β k α d θ k y e k u t a r k o x e k y e k 1 y e k t s u k sin ϕ k α d θ k β k α d θ k x e k o y e k where u k ϕ k α d θ k α d θ k denote the sampling values of u ϕ α d θ α d θ respectively at instant k t s o x e k and o y e k denote the discretization errors u t a r k denotes the virtual target velocity with u t a r k δ θ k x d θ k 2 y d θ k 2 and δ θ k θ k θ k 1 by defining g k u k sin ϕ k α d θ k β k the dynamic of the cross track error becomes 6 y e k 1 y e k t s g k t s α d θ k x e k o y e k let o ˆ y e k denote the estimation value of o y e k then we can design the data driven observer for 6 as follows 7 y ˆ e k 1 y ˆ e k t s g ˆ k t s α d θ k x e k o ˆ y e k with g ˆ k denotes the estimation value of g k to obtain g ˆ k in 7 we select the following criterion index function hou and jin 2011b for g ˆ k such that 8 j g ˆ k δ y e k t s g ˆ k t s α d θ k 1 x e k 1 o ˆ y e k 1 2 μ 1 g ˆ k g ˆ k 1 2 where μ 1 denotes a positive weight coefficient letting j g ˆ k g ˆ k 0 yields 9 g ˆ k g ˆ k 1 ρ 1 t s μ 1 t s 2 δ y e k t s g ˆ k 1 t s α d θ k 1 x e k 1 o ˆ y e k 1 10 g ˆ k g ˆ 1 i f g ˆ k ε 1 o r sgn g ˆ k sgn g ˆ 1 where ρ 1 0 1 denotes a step size constant ε 1 denotes a small positive constant then inspired by disturbance observer strategy zhao et al 2019a zhao et al 2019b weng and gao 2017b we can design the corresponding data driven adaptive law for o ˆ y e k as follows 11 o ˆ y e k o ˆ y e k 1 κ 1 y e k y ˆ e k with κ 1 as a step size coefficient finally the sideslip angle β k can be estimated by 12 β ˆ k arcsin g ˆ k u k ϕ k α d θ k remark 3 as the surge velocity is disturbed by various uncertainties and disturbances and kept positive the nonsingularity issue for estimating β k could be ensured moreover inspired by weng and gao 2017b we can obtain that g ˆ k and o ˆ y e k is bounded thereby indicating that β ˆ k is also bounded 3 2 guidance law design based on the established data driven sideslip observer 12 we can design the guidance law as follows 13 ϕ d k α d θ k β ˆ k arctan y e k ξ where ξ denotes the look ahead distance then in view of 5 and 13 we have 14 y e k 1 1 t s u k ξ 2 y e k 2 y e k t s g k t s α d θ k x e k o y e k with g k g ˆ k g k furthermore to stabilize x e k the virtual target velocity u t a r k is designed as 15 u t a r k t s u k cos ϕ d k α d θ k β ˆ k α d θ k y e k κ 2 x e k which combining 5 with 14 yields 16 θ k θ k 1 t s u k cos ϕ d k α d θ k β ˆ k α d θ k y e k κ 2 x e k x d θ k 2 y d θ k 2 where κ 2 is a positive constant then it follows from 5 and 15 that 17 x e k 1 1 t s κ 2 x e k o x e k consequently the following lemma can be obtained for 14 and 17 lemma 1 for the umv 1 with data driven sideslip observer g ˆ k designed by 12 guidance law ϕ d k designed by 13 virtual target velocity u t a r k designed by 15 and κ 2 selected as κ 2 α d θ k if appropriate surge controller and heading controller are developed such that u k and ϕ k could track the reference values i e the reference surge velocity u d k and the reference yaw angle ϕ d k then the convergence of the path following errors i e x e k y e k could be guaranteed proof define the lyapunov function as 18 v 1 k y e k x e k then in view of 14 and 17 we have 19 δ v 1 k y e k 1 x e k 1 y e k x e k t s u k ξ 2 y e k 2 y e k t s κ 2 t s α d θ k x e k t s g k o a l l k with o a l l k o y e k o x e k and g k o a l l k are bounded by defining h min t s u k ξ 2 y e k 2 t s κ 2 t s α d θ k we have 20 δ v 1 k h 1 θ e k h θ e k t s g k o a l l k where e k x e k y e k t since e k t s g k o a l l k h θ indicates 21 δ v 1 k h 1 θ e k thus x e k and y e k will finally converge to a bounded region hence lemma 1 is achieved remark 4 it is worth mentioning that the existence of large and time varying sideslip angle is considered in this study under which the conditions sin β β and cos β 1 are no longer hold thus the developed observer based guidance law could be applied to a more complex path following issue for surface vessels 4 velocity controller design to obtain the model free adaptive sliding mode path following controller the equivalent discrete form of surge and heading dynamics is given as 22 u k 1 u k f u u k v k r k d u k t s τ u k m 11 k o u k ϕ k 1 ϕ k t s r k o ϕ k r k 1 r k f r u k v k r k d r k t s τ r k m 33 k o r k where f u u k v k r k d u and f r u k v k r k d u denote the unknown lumped dynamics including unmodeled dynamics uncertainties and external disturbances and o u k and o r k denote the discretization errors in what follows a common assumption regarding the above surge and yaw dynamics is presented as follows assumption 1 the surge and yaw dynamics satisfy lipschitz conditions i e δ u k 1 γ 1 τ u k and δ r k 1 γ 2 τ r k where δ u k 1 u k 1 u k δ r k 1 r k 1 r k and γ 1 γ 2 are positive constants remark 5 according to hou and jin 2011a it is noticed that assumption 1 is a common description for practical systems such as markovian jump systems qi et al 2018 planar nonlinear systems wang et al 2017 vehicle systems xu et al 2017 et al 4 1 surge controller design in light of 22 the surge dynamic can be written as 23 u k 1 u k φ u k τ u k where φ u k t s m 11 k f u u k v k r k d u k o u k τ u k let φ ˆ u k denote the estimation value of φ u k then an index function for φ ˆ u k can be designed as 24 j φ ˆ u k u ˆ k u ˆ k 1 φ ˆ u k τ u k 1 2 μ 2 φ ˆ u k φ ˆ u k 1 2 where μ 2 is a weight coefficient and u ˆ k u k cos β ˆ k by solving j φ ˆ u k φ ˆ u k 0 we can obtain 25 φ ˆ u k φ ˆ u k 1 ρ 2 τ u k 1 μ 2 τ u k 1 2 δ u ˆ k φ ˆ u k 1 τ u k 1 26 φ ˆ u k φ ˆ u 1 i f φ ˆ u k ε 2 o r sgn φ ˆ u k sgn φ ˆ u 1 where ρ 2 0 1 is a step size constant ε 2 is a small positive constant consider the sequel sliding mode surface 27 s u k 1 e u k 1 c u e u k where e u k 1 u k 1 u d k c u 0 1 is a positive constant in light of the adaptive laws 25 26 and solving s u k 1 0 we can obtain the equivalent control law as 28 τ u e q k u d k u ˆ k c u e u k φ ˆ u k σ u where σ u is a positive constant then a high order discontinuous control law can be further designed as 29 τ u d i s k φ ˆ u k 1 σ u τ u d i s k 1 ρ u sgn s u k φ ˆ u k σ u where ρ u is a gain constant consequently we can derive the surge controller as 30 τ u k τ u e q k τ u d i s k 4 2 yaw controller design let z ϕ 1 k ϕ k ϕ d k 2 then it follows from 22 that 31 z ϕ 1 k 1 ϕ k t s r k o ϕ k ϕ d k 1 to derive the yaw control law τ r k a virtual control law for heading dynamic of 22 can be designed as 32 β k ϕ d k 1 ϕ k κ 3 z ϕ 1 k t s by defining the virtual tracking error as z ϕ 2 k r k β k we have 33 z ϕ 1 k 1 κ 3 z ϕ 1 k t s z ϕ 2 k o ϕ k thus the control task is transformed into stabilizing z ϕ 2 k in this respect similar as that in section 4 1 we can design the yaw controller as 34 τ r k τ r e q k τ r d i s k with τ r e q k designed as 35 τ r e q k β k 1 r k c r z ϕ 2 k φ ˆ r k σ r and τ r d i s k designed as 36 τ r d i s k φ ˆ r k 1 σ r τ r d i s k 1 ρ r sgn s r k φ ˆ r k σ r where 37 φ ˆ r k φ ˆ r k 1 ρ 3 τ r k 1 μ 3 τ r k 1 2 δ r k φ ˆ r k 1 τ r k 1 38 φ ˆ r k φ ˆ r 1 i f φ ˆ r k ε 3 o r sgn φ ˆ r k sgn φ ˆ r 1 and s r k 1 z ϕ 2 k 1 c r z ϕ 2 k c r 0 1 is a positive constant ρ 3 0 1 is a step size constant ε 3 is a small positive constant σ r is a positive constant ρ r is a gain constant 5 stability analysis before proceeding the surge dynamic 23 is rewritten as 39 u k 1 u ˆ k φ ˆ u k σ u τ u k ε u k with ε u k φ u k φ ˆ u k σ u τ u k u k u ˆ k inspired by hou and jin 2011b and the above analysis it is noticed that ε u k is bounded in this respect there exists a positive constant ε 1 such that 40 max i 2 k ε u i ε u i 1 ε 1 similarly we can have the following result 41 max i 2 k ε r i ε r i 1 ε 2 with ε 2 as a positive constant consequently we can have the following theorem theorem 1 consider the umv 1 with data driven sideslip angle observer 12 guidance law 13 the virtual target velocity 15 and velocity controllers in 30 and 34 if parameters ρ u and ρ r satisfy 42 ρ u ε 1 43 ρ r ε 2 then the umv can asymptotically follow the desired path proof in what follows we divide two steps to analyze theorem 1 step 1 proofing the boundedness of e u k and z ϕ 1 k consider the sequel lyapunov function 44 v 2 k s u k in view of 30 and 39 we have 45 s u k 1 φ ˆ u k 1 σ u τ u d i s k ρ u sgn s u k ε u k which further indicates 46 s u k φ ˆ u k 1 σ u τ u d i s k ε u k 1 by defining δ v 2 k v 2 k 1 v 2 k we have 47 δ v 2 k s u k ε u k ε u k 1 ρ u sgn s u k s u k finally in light of 40 42 and the proof in mihoub et al 2011 δ v 2 k 0 for s u k ε 1 ρ u consequently s u k will finally converge to a neighborhood of the origin thereby indicating the boundedness of e u k similarly it is noticed that z ϕ 2 k is also bounded which in view of 33 further indicates the boundedness of z ϕ 1 k step 2 proofing the boundedness of the path following errors i e x e k and y e k in view of step 1 there exist tracking errors in the velocity control loop in this context the path following error dynamics under control laws 30 and 34 can be further written as 48 x e k 1 x e k t s u d k cos ϕ d k α d θ k α d θ k y e k u d k sin ϕ d k α d θ k tan β ˆ k u d k x e k y e k 1 y e k t s u d k sin ϕ d k α d θ k α d θ k x e k u d k sin ϕ d k α d θ k tan β ˆ k y e k where ε x e k t s u e k cos ϕ k α d θ k β k cos β k u d k cos ϕ e k 1 cos ϕ d k α d θ k u d k sin ϕ e k sin ϕ d k α d θ k β k cos β k u d k sin ϕ d k α d θ k tan β ˆ k cos ϕ e k tan β k o x e k ε y e k t s u e k sin ϕ k α d θ k β k cos β k u d k cos ϕ e k 1 sin ϕ d k α d θ k u d k sin ϕ e k cos ϕ d k α d θ k β k cos β k u d k cos ϕ d k α d θ k cos ϕ e k tan β k tan β ˆ k o y e k and u e k u k u d k ϕ e k ϕ k ϕ d k in view of step 1 u e k and ϕ e k will finally converge to the origin thereby indicating the boundedness of ε x e k and ε y e k consequently combining with lemma 1 we can conclude that x e k and y e k also have the upper bounds therefore theorem 1 is reasonable 6 simulation studies in the following section the simulation studies regarding the proposed dso aspc approach and the relative method are conducted in addition the cybership ii skjetne et al 2005 is chosen as the data generator and the dynamics are described as that in 1 with the disturbances governed by 49 d k 1 2 0 1 u k 3 0 5 0 1 u k 2 0 1 r k 3 0 2 sin v k then the umv 1 are initialized by choosing t s 0 01 s υ 1 0 2 0 0 t and η 1 5 0 0 t the reference path is selected as 50 x d θ k 20 sin 0 05 θ k θ k y d θ k θ k with θ k updated by 51 θ k θ k 1 u t a r k x d θ k 2 y d θ k 2 where u t a r k is designed as that in 15 in addition the reference surge velocity and heading angle are designed as 52 u d k 2 0 5 sin k π 2000 ϕ d k α d θ k β ˆ k arctan y e k ξ with ξ to be determined in the sequel in dso aspc scheme parameters ρ 1 κ 1 μ 1 ε 1 κ 2 and ξ need to be determined for guidance subsystem specifically ρ 1 and κ 1 are selected as step size factors μ 1 is selected as positive constant and ε 1 is selected as a relatively small constant in view of 9 11 it is noticed that ρ 1 κ 1 and μ 1 determine the updating speed of g ˆ k and o ˆ y e k furthermore κ 2 should be selected in the region α d θ k according to 17 κ 2 greatly affects the convergence speed of x e k in addition ξ is selected as a positive constant whereby equation 14 indicates ξ is related to the convergence speed of y e k in the velocity control subsystem parameters ρ 2 ρ 3 μ 2 μ 3 ε 2 ε 3 c u c r κ 3 σ u σ r ρ u and ρ r need to be selected in particular ρ 2 and ρ 3 are selected as step size factors μ 2 and μ 3 are selected as positive constants and ε 2 and ε 3 are selected as relatively small constants according to 25 26 37 and 38 ρ 2 ρ 3 μ 2 and μ 3 greatly affect the updating speed of φ ˆ r k and φ ˆ u k furthermore c u c r and κ are selected as step size factors and c u c r and κ 3 determine the final convergence speed of e u k e u k and z ϕ 1 k respectively in addition σ u and σ r are selected as positive constants and the selection of ρ u and ρ r is subjected to 42 and 43 respectively the relatively big σ u and σ r or small ρ u and ρ r will generate relatively small control laws thereby leading to insufficient control efforts on the contrary the relatively small σ u and σ r or big ρ u and ρ r will generate relatively large control laws thereby causing undesirable chattering consequently applying the aforementioned parameter tuning guidelines the controller parameters of dso aspc are selected as μ 1 0 005 ρ 1 0 8 ε 1 0 001 κ 1 0 9 κ 2 0 6 μ 2 0 1 ρ 2 0 8 φ u 1 0 001 ε 2 0 001 c u 150 ρ u 5 σ u 3300 κ 3 0 1 μ 3 0 1 ρ 3 0 8 φ r 1 0 001 ε 3 0 001 c r 300 ρ r 5 σ r 4000 and ξ 1 8 6 1 validation of the dlos guidance law to effectively evaluate the efficacy of the proposed dlos guidance law the dso aspc scheme without dlos guidance law dso aspc dso is also selected for comparison analysis the simulation results including the path following errors path following performance sideslip angle estimation surge speed and heading angle tracking performances are exhibited in figs 3 8 furthermore to clearly illustrate the comparison curves the quantitative comparison results of path following performance including the integral of the absolute error iae and the integral of the time multiplied by the absolute value of the error itae are also provided in the sequel whereby iae1 and itae1 denote the corresponding performance indices regarding the path following errors and iae2 and itae2 denote the corresponding performance indices regarding the surge speed and heading angle tracking errors from figs 3 and 4 and table 1 it is noticed that the sideslip angle has a great effect on the path following performance in the dso aspc dso control system although the surge controller and heading controller could effectively accomplish the control task i e tracking the desired surge speed and heading angle see fig 6 there still exist fluctuations in the cross track error due to the effects of unknown sideslip angle on the contrary by virtue of the developed dso in dso aspc control system the unknown sideslip angle could be estimated accurately see fig 5 thereby contributing to a convergent tracking performance see figs 3 and 4 and table 1 6 2 validation of the aspc scheme in this subsection we will further evaluate the effectiveness of the proposed aspc scheme in this context the dso based pid dso pid scheme is chosen for comparison similarly we can obtain the corresponding simulation curves exhibited in figs 9 13 and table 2 as shown in figs 11 and 12 and table 2 the proposed aspc scheme shows better tracking performance due to the adoption of the data driven scheme and adaptive strategy on the contrary these nonlinearities uncertainties and disturbances result in large tracking errors in the dso pid control system then this large heading angle tracking error further lead to the fluctuations in the path following errors see figs 9 and 10 and table 2 7 conclusions this paper has investigated the data driven robust path following control problem of unknown umvs with uncertainties disturbances and time varying large sideslip by developing a data based sideslip observer a novel dlos guidance law has been proposed to facilitate the guidance system design furthermore the data driven smc scheme has also been developed to regulate the dynamics of the umvs it has been shown that the umv could follow a reference path by applying the proposed dlos guidance law regardless of the existence of time varying large sideslip in addition the uncertainties and disturbances have been attenuated effectively via the developed data driven smc method finally it has been shown in simulation studies that the developed guidance law and controller could efficiently regulate the system s dynamics and follow a predefined path credit author statement yongpeng weng data curation writing original draft preparation conceptualization methodology software visualization validation ning wang supervision conceptualization writing reviewing and editing visualization funding acquisition c guedes soares supervision writing reviewing and editing declaration of competing interest none acknowledgment this work was supported by the national natural science foundation of china of p r china under grants 51009017 51379002 and 61803063 the fund for dalian distinguished young scholars under grant 2016rj10 the fund for liaoning innovative talents in colleges and universities under grant lr2017024 the fundamental research funds for the central universities under grants 3132019344 3132019108 and 3132018126 and the stable supporting fund of science and technology on underwater vehicle laboratory sxjqr2018wdkt03 
22166,a tri modal or multi modal process is one of the main loads in marine and offshore engineering these resulting fatigue problems should be focused some available tri modal spectral methods for estimating fatigue damage are first reviewed and then a new tri modal spectral model is developed based on a generalization of the principle proposed by han and ma in order to validate the accuracy of these methods a parametric triangular tri modal spectrum is constructed and time domain solution based on rainflow counting is considered as a reference the results show that the new developed method provides quite good fatigue damage evaluation compared with rfc solution then the developed tri modal model is generalized to multi modal processes and general wideband processes the generalized principle is to divide a wideband spectrum into several narrowband segments different dividing principles are investigated it is demonstrated that adopting equal frequency band principle can give good fatigue damage estimation keywords fatigue damage tri modal spectrum multi modal spectrum general wideband process 1 introduction a tri modal or multi modal process is one of the main loads in marine and offshore engineering park and song 2015 for example a riser system could be subjected to the wave frequency response induced by first order wave effects direct wave loads and associated floater motions and the low frequency response excited by second order floater motions at the same time the riser system could experience the high frequency response due to vortex induced vibrations viv dnv rp f204 2010 wang and ji 2018 thus the power spectral density of the stress response for riser systems may show at least three peaks under three combined loadings fatigue behavior under tri modal processes becomes complex because of interaction of different frequency components several studies have been performed to deal with these problems time domain rainflow counting rfc method has been considered to be the most accurate damage prediction method however highly computational efforts lead to difficulty to be used in real engineering for designers on the contrary frequency domain method is effective and time saving at present many frequency domain methods have been proposed for estimating fatigue damage due to wide banded gaussian processes these general wide band spectral methods include wirsching and light method wirsching and light 1980 dirlik method dirlik 1985 single moment method lutes and larsen 1990 zhao and baker method zhao and baker 1992 and benasciutti tovo method benasciutti and tovo 2006 it has been proven that dirlik method benasciutti tovo method and park method give quite good fatigue damage estimation tri modal processes are special wide band processes therefore in principle the general wide band spectral methods previously mentioned can also predict fatigue damage under tri modal processes in addition some special methods for tri modal processes have been developed such as gao moan method gao and moan 2008 and park method park and choung 2014 park and song 2015 gao and moan developed a procedure for evaluating tri modal fatigue damage by generalizing the formula proposed by jiao and moan for predicting bimodal fatigue damage the new tri modal formula predicts the fatigue damage quite close to that obtained by the rainflow counting method when the bandwidth is less than 0 85 for a greater bandwidth it may overestimate the fatigue damage the main drawback of gao moan method is that the calculation process is relatively complicated which includes a triple integration that needs to be solved with hermite numerical integration method park park and song 2015 improved and upgraded the ideal tri modal spectrum and made it close to actual tri modal spectrum subsequently by using new tri modal spectrum park model is adopted to calculate the tri modal fatigue damage which is demonstrated to give quite accurate fatigue damage estimations the aim of this paper is to study fatigue assessment method under tri modal random processes a new tri modal model for estimation of fatigue damage is developed based on a generalization of the formula proposed by han and ma 2016 in addition the new formula is generalized to predicting fatigue damage under multi modal processes and general wideband processes the accuracy of the new formula is checked with time domain rainflow counting solution 2 basic fatigue analysis theory for random process 2 1 analysis of random process assuming that x t is a stationary gaussian random process and s x ω is the corresponding power spectral density function then a set of spectral moments can be defined as follows 1 λ i 0 ω i s x ω d ω where ω is the circular frequency subscript i can usually take a real value depending on the circumstances which corresponds to the i th order spectral moment bandwidth is also an important parameter that characterizes a random process a group of bandwidth parameters is defined as follows 2 α i λ i λ 0 λ 2 i the most commonly used bandwidth parameters are given as 3 α 1 λ 1 λ 0 λ 2 α 2 λ 2 λ 0 λ 4 where α 1 is the vanmarcker s bandwidth parameter which determines the rate of change of the amplitude of a random process α 2 is the irregularity factor representing the ratio between ν 0 and ν p and the range of the bandwidth parameters is 0 α 1 1 0 α 2 1 two spectral parameters relating to α 1 and α 2 are defined as follows vanmarcke 1972 wirsching and light 1980 4 δ 1 α 1 2 1 λ 1 2 λ 0 λ 2 ε 1 α 2 2 1 λ 2 2 λ 0 λ 4 where δ is vanmarcke s spectral parameter with 0 δ 1 and ε is wirsching s spectral width parameter with 0 ε 1 other typical parameters are the mean zero up crossing frequency ν 0 and the peak occurrences frequency ν p which depend on spectral moments in frequency domain and can be determined 5 ν 0 1 2 π λ 2 λ 0 ν p 1 2 π λ 4 λ 2 2 2 fatigue analysis in general fatigue analysis is based on an s n curve defined by the form 6 n k s m where s represents the stress level assumed herein to be the stress amplitude n is the number of cycles to fatigue failure and k and m are the fatigue strength coefficient and fatigue strength exponent respectively fatigue damage can then be calculated according to rainflow counting theorem astm 2005 and a linear accumulation rule after palmgren and miner 1945 7 d n i n i 1 k n i s i m n k s m where n i is the number of cycles in the stress amplitude s i resulting from rainflow counting n i is the number of cycles corresponding to fatigue failure at the same stress amplitude based on the s n curve n represents the total number of cycles in the duration and s m is the mathematical expectation of s m when the stress amplitude is a continuous function and its probability density function pdf is f s s s m can be denoted as follows 8 s m 0 s m f s s d s fatigue damage can be then calculated according to eq 9 9 d n k s m ν 0 t k 0 s m f s s d s for a narrowband stress process the stress amplitude obeys rayleigh distribution as follows 10 f s s s λ 0 exp s 2 2 λ 0 according to eqs 2 3 5 and 10 a close form solution of fatigue damage bendat 1964 in the duration t can be written as 11 d n b ν 0 t k 2 λ 0 m γ m 2 1 for a wideband stress process the stress amplitude does not have an analytical distribution however fatigue damage can be calculated by a narrow band approximation multiplied by a bandwidth correction factor wirsching and light 1980 12 d w b ρ d n b it is reported that ρ falls in the range of 0 1 rychlik 1993 3 fatigue assessment methods under three random loads 3 1 rule s method 3 1 1 direct summation method it is standard industry practice to sum up viv fatigue damage with the combined wave frequency wf and low frequency lf induced fatigue damage dnv rp f204 2010 13 d t o t a l d l d h where the combined wf lf process can be regarded as a low frequency corresponding fatigue damage d l can be calculated through some bimodal methods or combination of fatigue damage methods the viv process can be considered as a high frequency the corresponding fatigue damage d h can be obtained with time domain fatigue analysis 3 1 2 simplified dnv method dnv rp c204 gives a simplified method for combining the viv fatigue damage with the wf lf damage dnv rp f204 2010 this simplified dnv formula is as follows 14 d t o t a l d h 1 ν h ν l ν h d l ν l 1 m d h ν h 1 m m where ν h is the mean zero up crossing frequency corresponding to viv response process ν l is the mean zero up crossing frequency corresponding to the combined wf lf process d l and d h are defined as the same with that in eq 13 3 2 general fatigue assessment methods for a tri modal stress process a tri modal stress spectrum is generally a wideband process therefore some general wideband spectral methods such as dirlik method benasciutti tovo method and park method can be used to estimate fatigue damage dirlik 1985 benasciutti and tovo 2006 park and choung 2014 3 2 1 dirlik dk method dirlik method is a semi empirical formula for approximately charactering the pdf of rainflow amplitude which is currently considered as a quite accurate approach dirlik 1985 this formula is composed of an exponential distribution a rayleigh distribution and a standard rayleigh distribution as follow 15 p d i r l i k s 1 λ 0 1 2 g 1 q exp z q g 2 z γ 2 exp z 2 2 γ 2 g 3 z exp z 2 2 where 16 z s λ 0 is a standardized amplitude and 17 x m α 1 α 2 q 1 25 α 2 g 3 g 2 γ g 1 γ α 2 x m g 1 2 1 α 2 g 1 g 1 2 18 g 1 2 x m α 2 2 1 α 2 2 g 2 1 α 2 g 1 g 1 2 1 γ g 3 1 g 1 g 2 six variables x m g 1 g 2 g 3 γ q are functions of α 1 and α 2 which consist of λ 0 λ 1 λ 2 and λ 4 therefore the rainflow amplitude pdf only depends on just four moments fatigue damage based on dirlik model can be given in a closed form form of eq 19 19 d d i r l i k ν p t k λ 0 m 2 g 1 q m 1 π γ m 1 2 g 2 γ m γ 1 m 2 g 3 γ 1 m 2 3 2 2 benasciutti and tovo bt method bt model is put forward based on this idea for a stationary gaussian process the rainflow fatigue damage always has a lower and upper bound as given in the following relation 20 d r c d r f c d n b d r f c can thus be expressed as a weighted linear combination 21 d r f c b d n b 1 b d r c where d n b is the upper bound damage coinciding with the damage obtained from the famous narrow band approximation d r c is the lower bound damage from the range counting astm 2005 which has no exact analytical expression thus an approximation is adopted benasciutti and tovo 2006 22 d r c ν 0 α 2 t k 2 λ 0 m α 2 m γ 1 m 2 α 2 m 1 d n b eq 21 reduces to 23 d r f c b 1 b α 2 m 1 d n b ρ b t d n b subsequently a bandwidth correction factor can be obtained 24 ρ b t b 1 b α 2 m 1 where an approximate formula of the weighted factor b is given by 25 b α 1 α 2 1 112 1 α 1 α 2 α 1 α 2 exp 2 11 α 2 α 1 α 2 α 2 1 2 3 2 3 park model analogous with dirlik model park proposed a new rfc probability density function which includes three items a half gaussian distribution a rayleigh distribution and a standard rayleigh distribution park and choung 2014 as given by 26 p p a r k z c g 2 2 π σ g exp z 2 2 σ g 2 c r 1 z σ r 1 2 exp z 2 2 σ r 1 2 c r 2 z exp z 2 2 related variables are defined in eq 27 eq 29 27 σ r 1 α 2 c g 1 c r 1 c r 2 σ g 2 π c g m r r 1 c r 1 σ r 1 c r 2 28 m r r 1 α 2 m r r 2 α 0 95 α 1 97 m r r 3 α 0 54 α 0 93 α 1 95 29 c r 1 m r r 2 m r r 3 σ r 1 2 1 σ r 1 c r 2 m r r 3 σ r 1 m r r 2 1 σ r 1 based on park model an analytical solution of the fatigue damage in the duration t can then be calculated as 30 d p a r k ν p t k 2 λ 0 m c g π σ g m γ m 1 2 c r 1 σ r 1 m γ m 2 1 c r 2 γ m 2 1 3 3 specialized tri modal method gao and moan gm method an ideal tri modal process y t can be defined as the sum of three narrow band random processes with well separated central frequencies namely by 31 y t x l t x m t x h t in which x l t x m t and x h t correspond to the low frequency lf process the intermediate frequency mf process and the high frequency hf process respectively tri modal fatigue damage can be estimated from three equivalent processes gao and moan 2008 as 32 d y d h d p d q where d h is the fatigue damage from hf process which can be denoted as 33 d h ν 0 h t k 2 λ 0 h m γ 1 m 2 d p is the fatigue damage produced by mf process and hf envelope process which can be calculated with the following formula 34 d p ν 0 p t k 2 m γ m 2 1 λ 0 m m 2 2 1 λ 0 h λ 0 m π λ 0 m λ 0 h m γ m 2 1 2 γ m 2 1 d q is the fatigue damage induced by a combined process q t which is composed of a lf process mf envelope process and hf envelope process it is given by 35 q t r h t r m t x l t gao and moan think the distribution r q t of q t does not have a close form solution but it can be obtained through a semi analytical form as follows 36 f r h x 1 f h x 1 x 1 λ 0 h exp x 1 2 2 λ 0 h 37 f r p x 3 f h m x 2 2 i 1 n a j z j f h x 2 2 λ 0 m z j 38 f r q x 3 f h m l x 3 2 j 1 n a j z j f h m x 3 2 λ 0 l z j where z i and z j are the identical abscissas zeros of the nth order hermite polynomial a i and a j are the identical weight factors according to the above study d q can be calculated as 39 d q ν 0 q t k s q m where s q m is an mth equivalent stress range and can be semi analytically obtained when m is an integer as an example it is shown in eq 40 with m 3 40 s q m j 1 n 2 a j z j i 1 n 2 a i z i 8 b i j 3 12 2 π λ 0 h b i j 2 48 λ 0 h b i j 12 2 π λ 0 h 3 2 in which b i j 2 λ 0 l z j 2 λ 0 h z i ν 0 q can be calculated as the following equation 41 ν 0 q λ 2 h δ h 2 λ 2 m δ m 2 λ 2 l 2 λ 0 l λ 0 h λ 0 m λ 0 l π λ 0 h λ 0 m 2 λ 0 h λ 0 m arctan λ 0 h λ 0 m λ 0 l λ 0 h λ 0 m λ 0 l 4 π λ 0 h λ 0 m λ 0 l 3 it can be seen that fatigue damage d q given by gao and moan should be calculated with a numerical integration which is obviously not convenient in engineering practice in order to obtain an analytical solution of d q a further investigation should been carried out in fact the distribution r q t can be written by a triple convolution integral as follow 42 d q ν 0 q t k 0 f r l r l 0 f r m r m 0 r l r m r h m f r h r h d r h d r m d r l low 2010 calculated the fatigue damage which is written as a double integration by selecting m as a positive integer the double integration can be expanded as a finite binomial series based on this eq 42 can be carried out successively to yield as shown 43 d q ν 0 q t k 0 f r l r l 0 f r m r m 0 r l r m r h m f r h r h d r h d r m d r l ν 0 q t k k 0 m m k j 0 k k j 2 λ 0 l j γ 1 j 2 2 λ 0 m k j γ 1 k j 2 2 λ 0 h m k γ 1 m k 2 the above expression gives the same result as eq 39 but does not require numerical integration for non integer m the resulting binomial expansion has an infinite number of terms but the series may be suitably truncated 4 derivation of tri modal formula 4 1 the combined formula under bimodal random loading idealized regular waves can be seen as the limit of the narrow band random processes from a convenient point of view the combined response due to two independent narrow band random processes can be reduced to the sum of two sine waves in the time domain based on this idea a practical formula of the fatigue damage subjected to two gaussian narrowband random processes with a well separated frequency has been well established by han and ma 2016 namely by 44 d d l 2 m d h 2 m m 2 in which d l is the fatigue damage induced by a low frequency gaussian component d h is the fatigue damage induced by a high frequency gaussian component in the study han and ma 2016 the low frequency gaussian component and high frequency gaussian component are assumed as two well separated narrowband random processes in order to extend the application range of eq 44 ma and han 2018 have carried out a further research to generalize eq 44 to non narrowband and frequency overlapped cases eq 44 has been validated and performs very well for predicting fatigue damage under two gaussian random processes 4 2 the combined formula under tri modal random loading let us consider a random process x t which is composed of a lf process x l t a mf process x m t and a hf process x h t the combined process y t is 45 x t x l t x m t x h t where x l t x m t and x h t represent the components with low intermediate and high frequencies ν 0 l ν 0 m ν 0 h and variances λ 0 l λ 0 m λ 0 h respectively these three random processes are assumed to be stationary gaussian and mutually independent because of mutual interaction of x l t x m t and x h t the total fatigue damage is not just the sum of fatigue damage of three components in order to consider this effect a method similar with dnv formula which considers to combine the viv fatigue damage with the wf lf damage are proposed fatigue damage due to combination of x l t and x m t is first calculated according to eq 44 namely by 46 d l m d l 2 m d m 2 m m 2 after that the combined process of the lf process and the mf process is assumed as a new random process which produces fatigue damage d l m then the total fatigue damage can be obtained through combining lf mf induced fatigue damage d l m with hf induced fatigue damage d h 47 d x d l m 2 m d h 2 m m 2 d l 2 m d m 2 m d h 2 m m 2 when x l t x m t and x h t are three narrowband components respectively corresponding fatigue damage d l d m and d h can be computed by an analytical solution based on the rayleigh distribution as shown in eq 48 eq 50 48 d l ν 0 l t k 2 λ 0 l m γ 1 m 2 49 d m ν 0 m t k 2 λ 0 m m γ 1 m 2 50 d h ν 0 h t k 2 λ 0 h m γ 1 m 2 the fatigue damage due to x t based on the narrowband assumption is 51 d x n b ν 0 t k 2 λ 0 l λ 0 m λ 0 h m γ 1 m 2 the damage correction factor for y t can be obtained as follows 52 ρ x d x d x n b ν 0 h 2 m λ 0 h ν 0 m 2 m λ 0 m ν 0 l 2 m λ 0 l m 2 ν 0 λ 0 h λ 0 m λ 0 l m 2 the advantage of eq 47 is its practicability and convenience for the following cases i e the contributions to fatigue damage can be caused by different constituent dynamic processes and it may be practical to calculate the fatigue damage for each of these processes separately eq 52 is based on information of the individual zero order moment and mean zero up crossing frequency which is convenient for calculating the combined fatigue damage subjected to tri modal processes with three narrowband gaussian components 5 numerical simulation this paper reviews some existing tri modal spectral fatigue damage estimation models and proposes a new tri modal spectral model the accuracy and application range should be validated numerical simulations are popular and commonly used in theory real tri modal spectra should be adopted to predict fatigue damage however real tri modal spectra may have many complex shapes which leads to difficulty in carrying out a large scale numerical simulations in order to obtain comprehensive and integrated tri modal spectral parameters it is necessary to construct ideally parameterized tri modal spectra with simple spectral shapes and explicit curve equations which makes it convenient to conduct numerical simulations 5 1 construction of ideal triangular tri modal spectrum wirsching and light 1980 proposed the concept of ideal rectangular bimodal spectra lutes and larsen 1990 validated the accuracy of bimodal methods based on ideal rectangular spectra benasciutti and tovo 2006 introduced five different bimodal spectra to calculate fatigue damage under broadband random processes han and ma 2016 2018 established parameterized rectangular bimodal spectra park and choung 2014 developed a rectangular ideal tri modal spectrum by upgrading the ideal bi modal spectrum proposed by lutes and larsen 1990 based on the above study this paper constructs parameterized triangular ideal tri modal spectrum the schematic view of the ideal tri modal spectra can be seen in fig 1 the ideal tri modal spectrum includes three components i e the low frequency lf component the medium frequency mf component the high frequency hf component compared with ideal bimodal spectrum ideal tri modal spectrum contains more parameters and these parameters and variables are defined as 53 c l ω b ω a c m ω d ω c c h ω f ω e c l c m and c h determine the bandwidth of each component 54 r m l ν 0 m ν 0 l ω c ω a 7 c m 2 10 c m 7 7 c l 2 10 c l 7 55 r h m ν 0 h ν 0 m ω e ω c 7 c h 2 10 c h 7 7 c m 2 10 c m 7 r m l denotes the ratio of the average zero up crossing frequency of mf process and lf process r h m represents the ratio of the average zero up crossing frequency of hf process and mf process 56 b m l a m a l s ω m ω d ω c s ω l ω b ω a s ω m s ω l c m 1 c l 1 ω c ω a 57 b h m a h a m s ω h ω f ω e s ω m ω d ω c s ω h s ω m c h 1 c m 1 ω e ω c b m l is the ratio of the zero order spectral moment of mf process and lf process b h m is the ratio of the zero order spectral moment of hf process and mf process a l a m and a h are the area of lf mf hf process respectively the zero order spectral moment is equal to the area of each component for simplicity it is assumed that the sum of a l a m and a h is equal to unity i e a l a m a h 1 if ω a c l c m c h r m l r h m b m l and b h m are given a unique tri modal spectrum can be determined 5 2 numerical simulation procedure in order to validate the accuracy of tri modal methods rfc fatigue damage should be obtained as a reference rfc solution is calculated through numerical technique proposed in the literature han and ma 2016 parameters of ideal tri modal spectra for numerical simulations are set in table 1 ω a does not affect simulated fatigue damage results han and ma 2016 thus ω a is set to 2 rad s for simplifying the study it is assumed that lf mf and hf process are separated and narrowband thus c l c m and c h are equal to 1 2 corresponding wirsching bandwidth parameter is 0 07 i e ε l ε m ε h 0 07 selection of r m l r h m b m l and b h m can refer to gao and moan s research gao and moan 2008 as shown in table 1 in total there are 5 5 6 6 900 cases 5 3 numerical validation results of tri modal fatigue damage methods the results for comparison of tri modal fatigue damage methods and rfc solution are shown in figs 2 4 most marine structures are composed of metal materials especially for welded steel structures fatigue strength exponent m of s n curve is from 3 to 5 lutes and corazao 1984 in this paper m 3 and m 5 are selected to predict fatigue damage in figs 2 4 the abscissa of the data points is the wirsching bandwidth factor the ordinate is the ratio of fatigue damage as computed by tri modal methods and fatigue damage as estimated by time domain rfc method i e d d r f c thus perfect agreement between a tri modal spectral method and rfc solution is indicated by data lying on a line with d d r f c 1 any deviations of the data from this line indicate inaccuracies in the tri modal spectral methods fig 2 shows ratio of fatigue damage obtained by different tri modal methods for the spectral width parameter of 0 2 0 7 for m 3 in fig 2 a the proposed method shows behavior consistent with that observed from benasciutti and tovo bt method and dirlik dk method they provide very accurate fatigue damage estimations with a maximum relative error of 5 park method also gives quite accurate fatigue damage and always overestimates fatigue damage and the maximum error is about 9 gao and moan gm method gives accurate estimations in most cases but in a few cases the error reaches about 40 for m 5 in fig 2 b the proposed method and park method tend to overestimate fatigue damage with a maximum error of positive 20 while bt method and dk method always underestimate fatigue damage with a maximum error of negative 20 gm method shows an underestimation by a maximum error of negative 30 the very conservative simplified dnv results and the very underestimated direct summation method results are not shown fig 3 exhibits ratio of fatigue damage obtained by different tri modal methods for the spectral width parameter of 0 7 0 85 for m 3 in fig 3 a the proposed method bt method and dk method still work well with a maximum error of negative 10 park method also gives good fatigue damage results with a maximum error of positive 15 for m 5 in fig 3 b errors of fatigue damage from all the tri modal methods mentioned in this paper increase obviously the proposed method provides overestimated fatigue damage results by positive 20 bt method and dk method give underestimated fatigue damage results by negative 20 fig 4 displays ratio of fatigue damage obtained by different tri modal methods for the spectral width parameter of 0 85 1 for m 3 in fig 4 a the proposed method and dk method underestimate fatigue damage with a maximum error of negative 20 while the bt method and park method overestimate the fatigue damage by 20 and 30 respectively for m 5 in fig 4 a all the errors become greater however spectra with the spectral width parameter quite close to 1 might be unrealistic in real engineering and at least the wave or wind induced response spectra in the study by gao and moan 2008 have a maximum spectral width parameter of only 0 81 in a word the accuracy of the proposed method with the tri modal spectral formulation is practically acceptable for the spectral width parameters not greater than 0 85 and more importantly considering the early stage of the structural design the iterative feasibility checks and parameter studies need to be conducted hence the reduced computational efforts is probably the major aspect to be addressed for this reason simplified and faster methods should be established the proposed method in this paper seems very simple easy to be applied and executed very practical to evaluate the combined fatigue damage of marine engineering structures under three or multi modal random gaussian processes 6 generalization of the proposed method to multi modal processes and general wideband processes referring to gao moan s study gao and moan 2008 this paper attempts to generalize the proposed tri modal method to multi modal processes and general wideband processes 6 1 generalization of the proposed method to multi modal processes a power spectral density function may have three or more peaks in general a stress process which contains more than three peaks is called a multi modal process the schematic view of a typical multi modal spectrum can be seen in fig 5 for a gaussian random process which is composed of multiple components supposing that the number of components is n d 1 d 2 d 3 d n are the fatigue damage induced by multiple random components respectively the total fatigue damage can be calculated based on the formula by han and ma 2016 the detailed derivation can be seen as 58 d 1 2 d 1 2 m d 2 2 m m 2 d 1 2 3 d 1 2 2 m d 2 2 m m 2 d 1 2 m d 2 2 m d 3 2 m m 2 d 1 2 3 n d 1 2 3 n 1 2 m d n 2 m m 2 d 1 2 m d 2 2 m d n 2 m m 2 after that a generalized formula of the total fatigue damage can be seen 59 d m u l t i i 1 n d i 2 m m 2 if every gaussian random component is a narrowband process fatigue damage can be then calculated as 60 d i ν 0 i t k 2 λ 0 i m γ m 2 1 a damage correction factor based on a multi modal spectral process can be obtained 61 ρ m u l t i i 1 n d i 2 m m 2 d n b i 1 n ν 0 i 2 m λ 0 i ν 0 2 m λ 0 i m 2 in which λ 0 i and ν 0 i represent the zero order spectral moment and the average up crossing zero frequency of the ith random process respectively d n b is given as 62 d n b ν 0 t k 2 i 1 n λ 0 i m γ m 2 1 according to the above derivation once the average up crossing zero frequency and the zero order spectral are given fatigue damage for multi modal random processes can be estimated 6 2 generalization of the proposed method to general wideband processes a power spectral density function may is a continuous spectrum as seen in fig 6 when this spectrum is a narrowband process it obeys a rayleigh distribution fatigue damage can be calculated through an analytical solution when this spectrum is a wideband process fatigue damage obtained from narrowband assumption may be too conservative especially when the bandwidth parameter is close to one however a wideband spectrum can be divided into several segments through spectral decomposition as seen in fig 7 and every part can be considered as a narrowband process the total fatigue damage can be predicted considering mutual interaction of each narrowband component in spectral decomposition there are various discretization principles which can be used for dividing into a wideband spectrum some common principles are as follows 1 equal frequency band principle the spectrum is divided into several segments this implies every segment have the same frequency band a simple schematic view can be seen in fig 8 2 equal zero order moment principle it means that every segment has the same area or spectral energy a schematic view is shown in fig 9 3 equal damage principle i e every segment induced damage is equal 4 equal bandwidth principle i e every segment has the same spectral bandwidth in four principles equal frequency band principle and equal zero order moment principle is the simplest and have some advantages for dividing the wideband spectrum into several segments for equal damage principle and equal bandwidth principle high order spectral moment should be calculated which will take high computational efforts and be time consuming in addition the discretization principle depends on different spectral methods i e for gao moan method it is demonstrated that equal zero order moment principle is suitable gao and moan 2008 6 3 numerical validation of different dividing principles from the viewpoint of cost effectiveness this paper will focus on studying equal frequency band principle and equal zero order moment principle a weibull distribution function similar with the spectral shape in fig 6 is adopted to carry out this study after that the number of equal segment should be determined this paper considers to divide this spectrum into 3 10 segments which can be seen in table 2 in order to estimate the effect of bandwidth some wideband spectra with different bandwidth parameters are selected to carry out numerical simulations wirsching s bandwidth parameter ε is set to 0 6 0 65 0 7 0 75 0 8 and 0 85 further study might be necessary to check both the accuracy and the efficiency of these two principles the results are as follow the damage correction factor based on equal zero order moment principle and equal frequency band principle is shown in fig 10 the red line represents results obtained from rfc time domain simulations the black line denotes results computed by equal zero order moment principle the cyan line stands for results calculated by equal frequency band principle for all studied wideband spectra the damage correction factor based on the equal zero order moment principle decreases with the increasing of number of equal segments the results are very close to that obtained from rfc solution when the number of equal segments is 3 4 and 5 especially when the number is equal to 4 the best agreement between the proposed method and rfc solution can be observed the damage correction factor based on the equal frequency band principle shows the same tendency with that from the equal zero order moment principle i e the damage correction factor decreases with the increasing of number of equal segments as well when the number of equal segments is 3 4 and 5 the results is quite close to rfc solution in general the damage correction factor from equal frequency band principle is closer to rfc solution by comparing with that of equal zero order moment principle therefore it is recommended to divide a continuous wideband spectrum into several segments by using equal frequency band principle when a wideband spectrum could be divided into several segments the bandwidth parameter of a part of the spectrum is obviously less than that of the entire one then the narrow band assumption might be reasonable for each segment therefore based on a given wideband spectrum we try to divide a continuous wideband spectrum into 3 4 or 5 segments by using equal frequency band principle fatigue damage due to each segment can be calculated according to eq 59 the total fatigue damage can be then estimated by a narrowband approximation multiplied by a bandwidth correction factor according to eq 12 7 case study it is necessary to conduct a further study to check the accuracy of tri modal spectral methods by considering a more realistic tri modal spectrum it can be seen in fig 11 which is studied by olagnon and guédé 2008 the first peak is associated to low frequency resonant system response which is modeled with a triangular spectrum the second peak process is induced by a swell with a wave height 2 83 m and a period 15s which is similar to a triangular spectrum corresponding to a mf response the third peak response is a jonswap spectrum with a wave height 2 83 m and a period 5s corresponding to a hf response each of the bandwidth parameters corresponding to three peak response is ε l 0 16 ε m 0 16 and ε h 0 57 respectively lf and mf response can be treated as a narrowband process and hf response can be considered as a wideband process the total bandwidth parameter is ε 0 69 and is also a wideband process error of fatigue damage from tri modal spectral methods and rfc method is calculated as seen in table 3 it shows that simplified dnv method always overestimates fatigue damage with a highly conservative error of 137 7 for m 5 bt method dk method and park method provide quite good fatigue damage estimation corresponding errors never exceed 3 gm method also gives accurate fatigue damage results with an error of positive 5 02 for m 3 and negative 9 68 for m 5 the proposed method tends to overestimate fatigue damage by as much as 12 12 for m 3 and 20 24 for m 5 overall this error falls in an acceptable range more importantly the proposed method is simple and is very convenient for predicting fatigue damage under tri modal spectra 8 conclusion fatigue assessment methods including rule s method dk method bt method park method and gao moan method under three or multi random gaussian loads are investigated a new tri modal spectral model based on the previous author s study is proposed the new model is generalized to multi modal process and wideband processes the accuracy of tri modal models have been validated with rainflow counting results some conclusions are drawn as follow 1 the proposed method provides quite good fatigue damage estimation compared with rfc results when the spectral width parameter is less than 0 85 for all the tri modal psd studied 2 bt method park method gives accurate fatigue damage prediction for all tri modal psds considered herein 3 the proposed tri modal spectral model is generalized to multi modal processes and general wideband processes and it is recommended to divide a continuous wideband spectrum into 3 4 and 5 segments by using equal frequency band principle declaration of competing interest the authors claim that the work described is original research that has not been published previously and not under consideration for publication elsewhere acknowledgement this work was supported by the natural science foundation of jiangsu province grant no bk20190962 and the natural science foundation of the jiangsu higher education institutions of china grant no 19kjb580009 and the state key laboratory of ocean engineering shanghai jiao tong university grant no 1807 
22166,a tri modal or multi modal process is one of the main loads in marine and offshore engineering these resulting fatigue problems should be focused some available tri modal spectral methods for estimating fatigue damage are first reviewed and then a new tri modal spectral model is developed based on a generalization of the principle proposed by han and ma in order to validate the accuracy of these methods a parametric triangular tri modal spectrum is constructed and time domain solution based on rainflow counting is considered as a reference the results show that the new developed method provides quite good fatigue damage evaluation compared with rfc solution then the developed tri modal model is generalized to multi modal processes and general wideband processes the generalized principle is to divide a wideband spectrum into several narrowband segments different dividing principles are investigated it is demonstrated that adopting equal frequency band principle can give good fatigue damage estimation keywords fatigue damage tri modal spectrum multi modal spectrum general wideband process 1 introduction a tri modal or multi modal process is one of the main loads in marine and offshore engineering park and song 2015 for example a riser system could be subjected to the wave frequency response induced by first order wave effects direct wave loads and associated floater motions and the low frequency response excited by second order floater motions at the same time the riser system could experience the high frequency response due to vortex induced vibrations viv dnv rp f204 2010 wang and ji 2018 thus the power spectral density of the stress response for riser systems may show at least three peaks under three combined loadings fatigue behavior under tri modal processes becomes complex because of interaction of different frequency components several studies have been performed to deal with these problems time domain rainflow counting rfc method has been considered to be the most accurate damage prediction method however highly computational efforts lead to difficulty to be used in real engineering for designers on the contrary frequency domain method is effective and time saving at present many frequency domain methods have been proposed for estimating fatigue damage due to wide banded gaussian processes these general wide band spectral methods include wirsching and light method wirsching and light 1980 dirlik method dirlik 1985 single moment method lutes and larsen 1990 zhao and baker method zhao and baker 1992 and benasciutti tovo method benasciutti and tovo 2006 it has been proven that dirlik method benasciutti tovo method and park method give quite good fatigue damage estimation tri modal processes are special wide band processes therefore in principle the general wide band spectral methods previously mentioned can also predict fatigue damage under tri modal processes in addition some special methods for tri modal processes have been developed such as gao moan method gao and moan 2008 and park method park and choung 2014 park and song 2015 gao and moan developed a procedure for evaluating tri modal fatigue damage by generalizing the formula proposed by jiao and moan for predicting bimodal fatigue damage the new tri modal formula predicts the fatigue damage quite close to that obtained by the rainflow counting method when the bandwidth is less than 0 85 for a greater bandwidth it may overestimate the fatigue damage the main drawback of gao moan method is that the calculation process is relatively complicated which includes a triple integration that needs to be solved with hermite numerical integration method park park and song 2015 improved and upgraded the ideal tri modal spectrum and made it close to actual tri modal spectrum subsequently by using new tri modal spectrum park model is adopted to calculate the tri modal fatigue damage which is demonstrated to give quite accurate fatigue damage estimations the aim of this paper is to study fatigue assessment method under tri modal random processes a new tri modal model for estimation of fatigue damage is developed based on a generalization of the formula proposed by han and ma 2016 in addition the new formula is generalized to predicting fatigue damage under multi modal processes and general wideband processes the accuracy of the new formula is checked with time domain rainflow counting solution 2 basic fatigue analysis theory for random process 2 1 analysis of random process assuming that x t is a stationary gaussian random process and s x ω is the corresponding power spectral density function then a set of spectral moments can be defined as follows 1 λ i 0 ω i s x ω d ω where ω is the circular frequency subscript i can usually take a real value depending on the circumstances which corresponds to the i th order spectral moment bandwidth is also an important parameter that characterizes a random process a group of bandwidth parameters is defined as follows 2 α i λ i λ 0 λ 2 i the most commonly used bandwidth parameters are given as 3 α 1 λ 1 λ 0 λ 2 α 2 λ 2 λ 0 λ 4 where α 1 is the vanmarcker s bandwidth parameter which determines the rate of change of the amplitude of a random process α 2 is the irregularity factor representing the ratio between ν 0 and ν p and the range of the bandwidth parameters is 0 α 1 1 0 α 2 1 two spectral parameters relating to α 1 and α 2 are defined as follows vanmarcke 1972 wirsching and light 1980 4 δ 1 α 1 2 1 λ 1 2 λ 0 λ 2 ε 1 α 2 2 1 λ 2 2 λ 0 λ 4 where δ is vanmarcke s spectral parameter with 0 δ 1 and ε is wirsching s spectral width parameter with 0 ε 1 other typical parameters are the mean zero up crossing frequency ν 0 and the peak occurrences frequency ν p which depend on spectral moments in frequency domain and can be determined 5 ν 0 1 2 π λ 2 λ 0 ν p 1 2 π λ 4 λ 2 2 2 fatigue analysis in general fatigue analysis is based on an s n curve defined by the form 6 n k s m where s represents the stress level assumed herein to be the stress amplitude n is the number of cycles to fatigue failure and k and m are the fatigue strength coefficient and fatigue strength exponent respectively fatigue damage can then be calculated according to rainflow counting theorem astm 2005 and a linear accumulation rule after palmgren and miner 1945 7 d n i n i 1 k n i s i m n k s m where n i is the number of cycles in the stress amplitude s i resulting from rainflow counting n i is the number of cycles corresponding to fatigue failure at the same stress amplitude based on the s n curve n represents the total number of cycles in the duration and s m is the mathematical expectation of s m when the stress amplitude is a continuous function and its probability density function pdf is f s s s m can be denoted as follows 8 s m 0 s m f s s d s fatigue damage can be then calculated according to eq 9 9 d n k s m ν 0 t k 0 s m f s s d s for a narrowband stress process the stress amplitude obeys rayleigh distribution as follows 10 f s s s λ 0 exp s 2 2 λ 0 according to eqs 2 3 5 and 10 a close form solution of fatigue damage bendat 1964 in the duration t can be written as 11 d n b ν 0 t k 2 λ 0 m γ m 2 1 for a wideband stress process the stress amplitude does not have an analytical distribution however fatigue damage can be calculated by a narrow band approximation multiplied by a bandwidth correction factor wirsching and light 1980 12 d w b ρ d n b it is reported that ρ falls in the range of 0 1 rychlik 1993 3 fatigue assessment methods under three random loads 3 1 rule s method 3 1 1 direct summation method it is standard industry practice to sum up viv fatigue damage with the combined wave frequency wf and low frequency lf induced fatigue damage dnv rp f204 2010 13 d t o t a l d l d h where the combined wf lf process can be regarded as a low frequency corresponding fatigue damage d l can be calculated through some bimodal methods or combination of fatigue damage methods the viv process can be considered as a high frequency the corresponding fatigue damage d h can be obtained with time domain fatigue analysis 3 1 2 simplified dnv method dnv rp c204 gives a simplified method for combining the viv fatigue damage with the wf lf damage dnv rp f204 2010 this simplified dnv formula is as follows 14 d t o t a l d h 1 ν h ν l ν h d l ν l 1 m d h ν h 1 m m where ν h is the mean zero up crossing frequency corresponding to viv response process ν l is the mean zero up crossing frequency corresponding to the combined wf lf process d l and d h are defined as the same with that in eq 13 3 2 general fatigue assessment methods for a tri modal stress process a tri modal stress spectrum is generally a wideband process therefore some general wideband spectral methods such as dirlik method benasciutti tovo method and park method can be used to estimate fatigue damage dirlik 1985 benasciutti and tovo 2006 park and choung 2014 3 2 1 dirlik dk method dirlik method is a semi empirical formula for approximately charactering the pdf of rainflow amplitude which is currently considered as a quite accurate approach dirlik 1985 this formula is composed of an exponential distribution a rayleigh distribution and a standard rayleigh distribution as follow 15 p d i r l i k s 1 λ 0 1 2 g 1 q exp z q g 2 z γ 2 exp z 2 2 γ 2 g 3 z exp z 2 2 where 16 z s λ 0 is a standardized amplitude and 17 x m α 1 α 2 q 1 25 α 2 g 3 g 2 γ g 1 γ α 2 x m g 1 2 1 α 2 g 1 g 1 2 18 g 1 2 x m α 2 2 1 α 2 2 g 2 1 α 2 g 1 g 1 2 1 γ g 3 1 g 1 g 2 six variables x m g 1 g 2 g 3 γ q are functions of α 1 and α 2 which consist of λ 0 λ 1 λ 2 and λ 4 therefore the rainflow amplitude pdf only depends on just four moments fatigue damage based on dirlik model can be given in a closed form form of eq 19 19 d d i r l i k ν p t k λ 0 m 2 g 1 q m 1 π γ m 1 2 g 2 γ m γ 1 m 2 g 3 γ 1 m 2 3 2 2 benasciutti and tovo bt method bt model is put forward based on this idea for a stationary gaussian process the rainflow fatigue damage always has a lower and upper bound as given in the following relation 20 d r c d r f c d n b d r f c can thus be expressed as a weighted linear combination 21 d r f c b d n b 1 b d r c where d n b is the upper bound damage coinciding with the damage obtained from the famous narrow band approximation d r c is the lower bound damage from the range counting astm 2005 which has no exact analytical expression thus an approximation is adopted benasciutti and tovo 2006 22 d r c ν 0 α 2 t k 2 λ 0 m α 2 m γ 1 m 2 α 2 m 1 d n b eq 21 reduces to 23 d r f c b 1 b α 2 m 1 d n b ρ b t d n b subsequently a bandwidth correction factor can be obtained 24 ρ b t b 1 b α 2 m 1 where an approximate formula of the weighted factor b is given by 25 b α 1 α 2 1 112 1 α 1 α 2 α 1 α 2 exp 2 11 α 2 α 1 α 2 α 2 1 2 3 2 3 park model analogous with dirlik model park proposed a new rfc probability density function which includes three items a half gaussian distribution a rayleigh distribution and a standard rayleigh distribution park and choung 2014 as given by 26 p p a r k z c g 2 2 π σ g exp z 2 2 σ g 2 c r 1 z σ r 1 2 exp z 2 2 σ r 1 2 c r 2 z exp z 2 2 related variables are defined in eq 27 eq 29 27 σ r 1 α 2 c g 1 c r 1 c r 2 σ g 2 π c g m r r 1 c r 1 σ r 1 c r 2 28 m r r 1 α 2 m r r 2 α 0 95 α 1 97 m r r 3 α 0 54 α 0 93 α 1 95 29 c r 1 m r r 2 m r r 3 σ r 1 2 1 σ r 1 c r 2 m r r 3 σ r 1 m r r 2 1 σ r 1 based on park model an analytical solution of the fatigue damage in the duration t can then be calculated as 30 d p a r k ν p t k 2 λ 0 m c g π σ g m γ m 1 2 c r 1 σ r 1 m γ m 2 1 c r 2 γ m 2 1 3 3 specialized tri modal method gao and moan gm method an ideal tri modal process y t can be defined as the sum of three narrow band random processes with well separated central frequencies namely by 31 y t x l t x m t x h t in which x l t x m t and x h t correspond to the low frequency lf process the intermediate frequency mf process and the high frequency hf process respectively tri modal fatigue damage can be estimated from three equivalent processes gao and moan 2008 as 32 d y d h d p d q where d h is the fatigue damage from hf process which can be denoted as 33 d h ν 0 h t k 2 λ 0 h m γ 1 m 2 d p is the fatigue damage produced by mf process and hf envelope process which can be calculated with the following formula 34 d p ν 0 p t k 2 m γ m 2 1 λ 0 m m 2 2 1 λ 0 h λ 0 m π λ 0 m λ 0 h m γ m 2 1 2 γ m 2 1 d q is the fatigue damage induced by a combined process q t which is composed of a lf process mf envelope process and hf envelope process it is given by 35 q t r h t r m t x l t gao and moan think the distribution r q t of q t does not have a close form solution but it can be obtained through a semi analytical form as follows 36 f r h x 1 f h x 1 x 1 λ 0 h exp x 1 2 2 λ 0 h 37 f r p x 3 f h m x 2 2 i 1 n a j z j f h x 2 2 λ 0 m z j 38 f r q x 3 f h m l x 3 2 j 1 n a j z j f h m x 3 2 λ 0 l z j where z i and z j are the identical abscissas zeros of the nth order hermite polynomial a i and a j are the identical weight factors according to the above study d q can be calculated as 39 d q ν 0 q t k s q m where s q m is an mth equivalent stress range and can be semi analytically obtained when m is an integer as an example it is shown in eq 40 with m 3 40 s q m j 1 n 2 a j z j i 1 n 2 a i z i 8 b i j 3 12 2 π λ 0 h b i j 2 48 λ 0 h b i j 12 2 π λ 0 h 3 2 in which b i j 2 λ 0 l z j 2 λ 0 h z i ν 0 q can be calculated as the following equation 41 ν 0 q λ 2 h δ h 2 λ 2 m δ m 2 λ 2 l 2 λ 0 l λ 0 h λ 0 m λ 0 l π λ 0 h λ 0 m 2 λ 0 h λ 0 m arctan λ 0 h λ 0 m λ 0 l λ 0 h λ 0 m λ 0 l 4 π λ 0 h λ 0 m λ 0 l 3 it can be seen that fatigue damage d q given by gao and moan should be calculated with a numerical integration which is obviously not convenient in engineering practice in order to obtain an analytical solution of d q a further investigation should been carried out in fact the distribution r q t can be written by a triple convolution integral as follow 42 d q ν 0 q t k 0 f r l r l 0 f r m r m 0 r l r m r h m f r h r h d r h d r m d r l low 2010 calculated the fatigue damage which is written as a double integration by selecting m as a positive integer the double integration can be expanded as a finite binomial series based on this eq 42 can be carried out successively to yield as shown 43 d q ν 0 q t k 0 f r l r l 0 f r m r m 0 r l r m r h m f r h r h d r h d r m d r l ν 0 q t k k 0 m m k j 0 k k j 2 λ 0 l j γ 1 j 2 2 λ 0 m k j γ 1 k j 2 2 λ 0 h m k γ 1 m k 2 the above expression gives the same result as eq 39 but does not require numerical integration for non integer m the resulting binomial expansion has an infinite number of terms but the series may be suitably truncated 4 derivation of tri modal formula 4 1 the combined formula under bimodal random loading idealized regular waves can be seen as the limit of the narrow band random processes from a convenient point of view the combined response due to two independent narrow band random processes can be reduced to the sum of two sine waves in the time domain based on this idea a practical formula of the fatigue damage subjected to two gaussian narrowband random processes with a well separated frequency has been well established by han and ma 2016 namely by 44 d d l 2 m d h 2 m m 2 in which d l is the fatigue damage induced by a low frequency gaussian component d h is the fatigue damage induced by a high frequency gaussian component in the study han and ma 2016 the low frequency gaussian component and high frequency gaussian component are assumed as two well separated narrowband random processes in order to extend the application range of eq 44 ma and han 2018 have carried out a further research to generalize eq 44 to non narrowband and frequency overlapped cases eq 44 has been validated and performs very well for predicting fatigue damage under two gaussian random processes 4 2 the combined formula under tri modal random loading let us consider a random process x t which is composed of a lf process x l t a mf process x m t and a hf process x h t the combined process y t is 45 x t x l t x m t x h t where x l t x m t and x h t represent the components with low intermediate and high frequencies ν 0 l ν 0 m ν 0 h and variances λ 0 l λ 0 m λ 0 h respectively these three random processes are assumed to be stationary gaussian and mutually independent because of mutual interaction of x l t x m t and x h t the total fatigue damage is not just the sum of fatigue damage of three components in order to consider this effect a method similar with dnv formula which considers to combine the viv fatigue damage with the wf lf damage are proposed fatigue damage due to combination of x l t and x m t is first calculated according to eq 44 namely by 46 d l m d l 2 m d m 2 m m 2 after that the combined process of the lf process and the mf process is assumed as a new random process which produces fatigue damage d l m then the total fatigue damage can be obtained through combining lf mf induced fatigue damage d l m with hf induced fatigue damage d h 47 d x d l m 2 m d h 2 m m 2 d l 2 m d m 2 m d h 2 m m 2 when x l t x m t and x h t are three narrowband components respectively corresponding fatigue damage d l d m and d h can be computed by an analytical solution based on the rayleigh distribution as shown in eq 48 eq 50 48 d l ν 0 l t k 2 λ 0 l m γ 1 m 2 49 d m ν 0 m t k 2 λ 0 m m γ 1 m 2 50 d h ν 0 h t k 2 λ 0 h m γ 1 m 2 the fatigue damage due to x t based on the narrowband assumption is 51 d x n b ν 0 t k 2 λ 0 l λ 0 m λ 0 h m γ 1 m 2 the damage correction factor for y t can be obtained as follows 52 ρ x d x d x n b ν 0 h 2 m λ 0 h ν 0 m 2 m λ 0 m ν 0 l 2 m λ 0 l m 2 ν 0 λ 0 h λ 0 m λ 0 l m 2 the advantage of eq 47 is its practicability and convenience for the following cases i e the contributions to fatigue damage can be caused by different constituent dynamic processes and it may be practical to calculate the fatigue damage for each of these processes separately eq 52 is based on information of the individual zero order moment and mean zero up crossing frequency which is convenient for calculating the combined fatigue damage subjected to tri modal processes with three narrowband gaussian components 5 numerical simulation this paper reviews some existing tri modal spectral fatigue damage estimation models and proposes a new tri modal spectral model the accuracy and application range should be validated numerical simulations are popular and commonly used in theory real tri modal spectra should be adopted to predict fatigue damage however real tri modal spectra may have many complex shapes which leads to difficulty in carrying out a large scale numerical simulations in order to obtain comprehensive and integrated tri modal spectral parameters it is necessary to construct ideally parameterized tri modal spectra with simple spectral shapes and explicit curve equations which makes it convenient to conduct numerical simulations 5 1 construction of ideal triangular tri modal spectrum wirsching and light 1980 proposed the concept of ideal rectangular bimodal spectra lutes and larsen 1990 validated the accuracy of bimodal methods based on ideal rectangular spectra benasciutti and tovo 2006 introduced five different bimodal spectra to calculate fatigue damage under broadband random processes han and ma 2016 2018 established parameterized rectangular bimodal spectra park and choung 2014 developed a rectangular ideal tri modal spectrum by upgrading the ideal bi modal spectrum proposed by lutes and larsen 1990 based on the above study this paper constructs parameterized triangular ideal tri modal spectrum the schematic view of the ideal tri modal spectra can be seen in fig 1 the ideal tri modal spectrum includes three components i e the low frequency lf component the medium frequency mf component the high frequency hf component compared with ideal bimodal spectrum ideal tri modal spectrum contains more parameters and these parameters and variables are defined as 53 c l ω b ω a c m ω d ω c c h ω f ω e c l c m and c h determine the bandwidth of each component 54 r m l ν 0 m ν 0 l ω c ω a 7 c m 2 10 c m 7 7 c l 2 10 c l 7 55 r h m ν 0 h ν 0 m ω e ω c 7 c h 2 10 c h 7 7 c m 2 10 c m 7 r m l denotes the ratio of the average zero up crossing frequency of mf process and lf process r h m represents the ratio of the average zero up crossing frequency of hf process and mf process 56 b m l a m a l s ω m ω d ω c s ω l ω b ω a s ω m s ω l c m 1 c l 1 ω c ω a 57 b h m a h a m s ω h ω f ω e s ω m ω d ω c s ω h s ω m c h 1 c m 1 ω e ω c b m l is the ratio of the zero order spectral moment of mf process and lf process b h m is the ratio of the zero order spectral moment of hf process and mf process a l a m and a h are the area of lf mf hf process respectively the zero order spectral moment is equal to the area of each component for simplicity it is assumed that the sum of a l a m and a h is equal to unity i e a l a m a h 1 if ω a c l c m c h r m l r h m b m l and b h m are given a unique tri modal spectrum can be determined 5 2 numerical simulation procedure in order to validate the accuracy of tri modal methods rfc fatigue damage should be obtained as a reference rfc solution is calculated through numerical technique proposed in the literature han and ma 2016 parameters of ideal tri modal spectra for numerical simulations are set in table 1 ω a does not affect simulated fatigue damage results han and ma 2016 thus ω a is set to 2 rad s for simplifying the study it is assumed that lf mf and hf process are separated and narrowband thus c l c m and c h are equal to 1 2 corresponding wirsching bandwidth parameter is 0 07 i e ε l ε m ε h 0 07 selection of r m l r h m b m l and b h m can refer to gao and moan s research gao and moan 2008 as shown in table 1 in total there are 5 5 6 6 900 cases 5 3 numerical validation results of tri modal fatigue damage methods the results for comparison of tri modal fatigue damage methods and rfc solution are shown in figs 2 4 most marine structures are composed of metal materials especially for welded steel structures fatigue strength exponent m of s n curve is from 3 to 5 lutes and corazao 1984 in this paper m 3 and m 5 are selected to predict fatigue damage in figs 2 4 the abscissa of the data points is the wirsching bandwidth factor the ordinate is the ratio of fatigue damage as computed by tri modal methods and fatigue damage as estimated by time domain rfc method i e d d r f c thus perfect agreement between a tri modal spectral method and rfc solution is indicated by data lying on a line with d d r f c 1 any deviations of the data from this line indicate inaccuracies in the tri modal spectral methods fig 2 shows ratio of fatigue damage obtained by different tri modal methods for the spectral width parameter of 0 2 0 7 for m 3 in fig 2 a the proposed method shows behavior consistent with that observed from benasciutti and tovo bt method and dirlik dk method they provide very accurate fatigue damage estimations with a maximum relative error of 5 park method also gives quite accurate fatigue damage and always overestimates fatigue damage and the maximum error is about 9 gao and moan gm method gives accurate estimations in most cases but in a few cases the error reaches about 40 for m 5 in fig 2 b the proposed method and park method tend to overestimate fatigue damage with a maximum error of positive 20 while bt method and dk method always underestimate fatigue damage with a maximum error of negative 20 gm method shows an underestimation by a maximum error of negative 30 the very conservative simplified dnv results and the very underestimated direct summation method results are not shown fig 3 exhibits ratio of fatigue damage obtained by different tri modal methods for the spectral width parameter of 0 7 0 85 for m 3 in fig 3 a the proposed method bt method and dk method still work well with a maximum error of negative 10 park method also gives good fatigue damage results with a maximum error of positive 15 for m 5 in fig 3 b errors of fatigue damage from all the tri modal methods mentioned in this paper increase obviously the proposed method provides overestimated fatigue damage results by positive 20 bt method and dk method give underestimated fatigue damage results by negative 20 fig 4 displays ratio of fatigue damage obtained by different tri modal methods for the spectral width parameter of 0 85 1 for m 3 in fig 4 a the proposed method and dk method underestimate fatigue damage with a maximum error of negative 20 while the bt method and park method overestimate the fatigue damage by 20 and 30 respectively for m 5 in fig 4 a all the errors become greater however spectra with the spectral width parameter quite close to 1 might be unrealistic in real engineering and at least the wave or wind induced response spectra in the study by gao and moan 2008 have a maximum spectral width parameter of only 0 81 in a word the accuracy of the proposed method with the tri modal spectral formulation is practically acceptable for the spectral width parameters not greater than 0 85 and more importantly considering the early stage of the structural design the iterative feasibility checks and parameter studies need to be conducted hence the reduced computational efforts is probably the major aspect to be addressed for this reason simplified and faster methods should be established the proposed method in this paper seems very simple easy to be applied and executed very practical to evaluate the combined fatigue damage of marine engineering structures under three or multi modal random gaussian processes 6 generalization of the proposed method to multi modal processes and general wideband processes referring to gao moan s study gao and moan 2008 this paper attempts to generalize the proposed tri modal method to multi modal processes and general wideband processes 6 1 generalization of the proposed method to multi modal processes a power spectral density function may have three or more peaks in general a stress process which contains more than three peaks is called a multi modal process the schematic view of a typical multi modal spectrum can be seen in fig 5 for a gaussian random process which is composed of multiple components supposing that the number of components is n d 1 d 2 d 3 d n are the fatigue damage induced by multiple random components respectively the total fatigue damage can be calculated based on the formula by han and ma 2016 the detailed derivation can be seen as 58 d 1 2 d 1 2 m d 2 2 m m 2 d 1 2 3 d 1 2 2 m d 2 2 m m 2 d 1 2 m d 2 2 m d 3 2 m m 2 d 1 2 3 n d 1 2 3 n 1 2 m d n 2 m m 2 d 1 2 m d 2 2 m d n 2 m m 2 after that a generalized formula of the total fatigue damage can be seen 59 d m u l t i i 1 n d i 2 m m 2 if every gaussian random component is a narrowband process fatigue damage can be then calculated as 60 d i ν 0 i t k 2 λ 0 i m γ m 2 1 a damage correction factor based on a multi modal spectral process can be obtained 61 ρ m u l t i i 1 n d i 2 m m 2 d n b i 1 n ν 0 i 2 m λ 0 i ν 0 2 m λ 0 i m 2 in which λ 0 i and ν 0 i represent the zero order spectral moment and the average up crossing zero frequency of the ith random process respectively d n b is given as 62 d n b ν 0 t k 2 i 1 n λ 0 i m γ m 2 1 according to the above derivation once the average up crossing zero frequency and the zero order spectral are given fatigue damage for multi modal random processes can be estimated 6 2 generalization of the proposed method to general wideband processes a power spectral density function may is a continuous spectrum as seen in fig 6 when this spectrum is a narrowband process it obeys a rayleigh distribution fatigue damage can be calculated through an analytical solution when this spectrum is a wideband process fatigue damage obtained from narrowband assumption may be too conservative especially when the bandwidth parameter is close to one however a wideband spectrum can be divided into several segments through spectral decomposition as seen in fig 7 and every part can be considered as a narrowband process the total fatigue damage can be predicted considering mutual interaction of each narrowband component in spectral decomposition there are various discretization principles which can be used for dividing into a wideband spectrum some common principles are as follows 1 equal frequency band principle the spectrum is divided into several segments this implies every segment have the same frequency band a simple schematic view can be seen in fig 8 2 equal zero order moment principle it means that every segment has the same area or spectral energy a schematic view is shown in fig 9 3 equal damage principle i e every segment induced damage is equal 4 equal bandwidth principle i e every segment has the same spectral bandwidth in four principles equal frequency band principle and equal zero order moment principle is the simplest and have some advantages for dividing the wideband spectrum into several segments for equal damage principle and equal bandwidth principle high order spectral moment should be calculated which will take high computational efforts and be time consuming in addition the discretization principle depends on different spectral methods i e for gao moan method it is demonstrated that equal zero order moment principle is suitable gao and moan 2008 6 3 numerical validation of different dividing principles from the viewpoint of cost effectiveness this paper will focus on studying equal frequency band principle and equal zero order moment principle a weibull distribution function similar with the spectral shape in fig 6 is adopted to carry out this study after that the number of equal segment should be determined this paper considers to divide this spectrum into 3 10 segments which can be seen in table 2 in order to estimate the effect of bandwidth some wideband spectra with different bandwidth parameters are selected to carry out numerical simulations wirsching s bandwidth parameter ε is set to 0 6 0 65 0 7 0 75 0 8 and 0 85 further study might be necessary to check both the accuracy and the efficiency of these two principles the results are as follow the damage correction factor based on equal zero order moment principle and equal frequency band principle is shown in fig 10 the red line represents results obtained from rfc time domain simulations the black line denotes results computed by equal zero order moment principle the cyan line stands for results calculated by equal frequency band principle for all studied wideband spectra the damage correction factor based on the equal zero order moment principle decreases with the increasing of number of equal segments the results are very close to that obtained from rfc solution when the number of equal segments is 3 4 and 5 especially when the number is equal to 4 the best agreement between the proposed method and rfc solution can be observed the damage correction factor based on the equal frequency band principle shows the same tendency with that from the equal zero order moment principle i e the damage correction factor decreases with the increasing of number of equal segments as well when the number of equal segments is 3 4 and 5 the results is quite close to rfc solution in general the damage correction factor from equal frequency band principle is closer to rfc solution by comparing with that of equal zero order moment principle therefore it is recommended to divide a continuous wideband spectrum into several segments by using equal frequency band principle when a wideband spectrum could be divided into several segments the bandwidth parameter of a part of the spectrum is obviously less than that of the entire one then the narrow band assumption might be reasonable for each segment therefore based on a given wideband spectrum we try to divide a continuous wideband spectrum into 3 4 or 5 segments by using equal frequency band principle fatigue damage due to each segment can be calculated according to eq 59 the total fatigue damage can be then estimated by a narrowband approximation multiplied by a bandwidth correction factor according to eq 12 7 case study it is necessary to conduct a further study to check the accuracy of tri modal spectral methods by considering a more realistic tri modal spectrum it can be seen in fig 11 which is studied by olagnon and guédé 2008 the first peak is associated to low frequency resonant system response which is modeled with a triangular spectrum the second peak process is induced by a swell with a wave height 2 83 m and a period 15s which is similar to a triangular spectrum corresponding to a mf response the third peak response is a jonswap spectrum with a wave height 2 83 m and a period 5s corresponding to a hf response each of the bandwidth parameters corresponding to three peak response is ε l 0 16 ε m 0 16 and ε h 0 57 respectively lf and mf response can be treated as a narrowband process and hf response can be considered as a wideband process the total bandwidth parameter is ε 0 69 and is also a wideband process error of fatigue damage from tri modal spectral methods and rfc method is calculated as seen in table 3 it shows that simplified dnv method always overestimates fatigue damage with a highly conservative error of 137 7 for m 5 bt method dk method and park method provide quite good fatigue damage estimation corresponding errors never exceed 3 gm method also gives accurate fatigue damage results with an error of positive 5 02 for m 3 and negative 9 68 for m 5 the proposed method tends to overestimate fatigue damage by as much as 12 12 for m 3 and 20 24 for m 5 overall this error falls in an acceptable range more importantly the proposed method is simple and is very convenient for predicting fatigue damage under tri modal spectra 8 conclusion fatigue assessment methods including rule s method dk method bt method park method and gao moan method under three or multi random gaussian loads are investigated a new tri modal spectral model based on the previous author s study is proposed the new model is generalized to multi modal process and wideband processes the accuracy of tri modal models have been validated with rainflow counting results some conclusions are drawn as follow 1 the proposed method provides quite good fatigue damage estimation compared with rfc results when the spectral width parameter is less than 0 85 for all the tri modal psd studied 2 bt method park method gives accurate fatigue damage prediction for all tri modal psds considered herein 3 the proposed tri modal spectral model is generalized to multi modal processes and general wideband processes and it is recommended to divide a continuous wideband spectrum into 3 4 and 5 segments by using equal frequency band principle declaration of competing interest the authors claim that the work described is original research that has not been published previously and not under consideration for publication elsewhere acknowledgement this work was supported by the natural science foundation of jiangsu province grant no bk20190962 and the natural science foundation of the jiangsu higher education institutions of china grant no 19kjb580009 and the state key laboratory of ocean engineering shanghai jiao tong university grant no 1807 
22167,this paper presents the mathematical design and implementation of an actuator fault tolerant control system for an underwater robot having four rotatable thrusters where the rotatable action of the thrusters is unconventional to a conventional underwater robotic system initially the dynamic model of the robot is presented later a motion control scheme using a backstepping control technique is made to track a desired spatial trajectory two techniques of active fault tolerance control viz elimination of column method and weighted pseudo inverse method are implemented successfully for single actuator faults on an infinity shaped trajectory which is a critical aspect of this study as most of the previous literature reported only on set point control the methods mentioned above are extended to multiple thrusters failure but both of them could not handle more than a single thruster failure hence an attempt is made to accommodate two thrusters failure through the line of sight approach by considering the vehicle as under actuated the desired vehicle performance is achieved with this approach finally oceanic currents are modeled to simulate the effectiveness of the methods discussed in the paper to prove the performance capabilities of the control system and fault accommodation schemes under realistic conditions keywords rotatable thrusters actuator fault tolerance weighted pseudo inverse fault accommodation backstepping control underactuated control line of sight oceanic currents 1 introduction the surroundings are complicated and uncontrollable which affects the motion of the autonomous underwater vehicles auvs in the oceans let alone accomplish missions effectively the operation of an auv is highly uncertain with fair chances of losing the vehicle due to the partially observable dynamic and unstructured environment seto and bashir 2017 this uncertain dynamic underwater environment makes what are considered to be simple tasks on land like plugging of sockets or operations on valves very complicated and might take hours to complete using a remotely operated vehicle rov with manipulator system leading to operator fatigue also in many underwater tasks most manipulation activities demand centimeter or less precision but the accuracy of vehicle position achieved by most underwater sensors is less therefore it is difficult to effectively implement complicated motion control in real time especially in autonomous mode few advanced control research studies on auvs are reported by seto and bashir 2017 yoerger and slotine 1985 yang et al 1999 carreras et al 2005 zhao and yuh 2005 fuqiang et al 2013 capocci et al 2017 lapierre and jouvencel 2008 on the implementation of sophisticated robust control techniques on underwater vehicles that are capable of handling possible difficulties created during the operation due to the uncertain underwater terrain during the operation the failure of one or more subsystems such as thrusters of the auvs is one of the significant uncertainties auvs must be well equipped with efficient fault detection mechanism before their launch raanan et al 2016 to avoid the loss of vehicle during operation the probability of the vehicle loss can be reduced by mitigating the effects of the subsystem failures by continuous monitoring of their health given the risk reference of a particular mission dearden and ernits 2013 this manuscript does not discuss the details of health monitoring techniques but assumes that the failure is already known for the simulation purpose fault tolerance in thruster based auvs have been dealt with previously in several different ways it is a technique which contains three stages of execution fault identification fault isolation fault accommodation the first two parts of fault tolerance are focused on identifying potential causes of failure in an auv and eliminating them fault detection involves monitoring a system to detect the presence of failures and the capability to determine which particular subsystem is subject to failure is called fault isolation or diagnosis antonelli 2003 fault identification involves using a deterministic approach for the detection of faults it is used interchangeably with the term fault detection fault detection schemes are usually model based alekseev et al 1994 alessandri et al 1999 and in real time vehicles health monitoring tools such as principal component analysis pca and partial kernel principal component analysis pkpca are used for combined sensor based fault detection and isolation navi et al 2015 the third stage involves fault accommodation which is vehicle or system specific caccia et al 2001 it is based upon the geometry of the vehicle location and number of thrusters the extent of redundancy of the system and control architecture etc all these factors contribute to the development of an alternate course of action which usually involves manipulation in control strategy when the thrusters experience failure fault accommodation on the vehicle also depends on the extent of damage to the thrusters and if possible adjustment of the fault is also taken care by the robust motion control scheme of the vehicle by usually reconfiguring the control to carry out the desired task without compromising on accuracy as much as possible alekseev et al 1994 alessandri et al 1999 caccia et al 2001 in the recent literature a fault in thrusters was considered absolute while implementing system specific fault accommodation techniques which entirely discontinues the use of faulty thruster s and apply new ways of completing the assigned trajectory using remaining thrusters only this absolute fault is mostly achieved and works well with redundant thrusters based auvs and further progressed to six thruster auvs later based upon variation in the model of the vehicle such as six thruster based vehicles and four thruster based vehicles few model specific modifications of fault accommodation techniques were reported choi et al 2014 liu and zhu 2009 further advancements led to the improvement of this technique and the concept of partial failure was brought in where a faulty thruster s still functions but only to a certain extent based on the scale of damage liu and zhu 2009 this research paper focuses mainly on the absolute or complete failure of thrusters and contains the analysis of procedures explored and adopted for building a reliable fault tolerant system specific to an underwater robot with four rotatable thrusters initially the following two techniques for fault accommodation have been discussed in this paper elimination of column method weighted pseudo inverse method the limitation of both techniques is that they are applicable only in case of a redundant thruster system multiple mode fault tolerance technique such as multiple mode sliding controller is discussed in the literature lingli and fuller 2003 with dual stern rudder failures but the study was limited to only a planar case thus an attempt is made to accommodate multiple thruster failures considering the two forward rotatable thrusters faulty for a spatial trajectory tracking and the vehicle as under actuated 2 research rationale during the continuous operation the faults failures can disrupt the motion of the vehicle leading to situations where missions may need to be aborted blanke et al 2006 thus identifying and managing faults in auvs that use thrusters as propulsion systems has always been a significant concern wang et al 2007 therefore it is required to understand the characteristics of the auv in the presence of such failures beforehand for the successful operation of the vehicle using simulations which is the interest of the current research fault tolerance control ftc of auvs is one of the most fundamental strategies to ensure the safety of the vehicle two types of control strategies are reported in the literature viz active fault tolerance control and passive fault tolerance control yang et al 2008 in passive type fault tolerance control robust control techniques assure insensitivity to specific faults but the design of robust control scheme requires an accurate dynamic model of the auv which depends on the complexity of the vehicle dynamics karras et al 2019 and gives better estimates of the navigation state owing to control capability when the vehicle moves in complex paths allotta et al 2018 on the contrary the active approach forces the controller to compensate for the effect of actuators defects either by choosing one of the predefined control laws for different fault conditions or by combining a new control scheme based on the failure in the system lingli and fuller 2003 it has been observed that the active type fault tolerant systems are employed more often since they function in real time and are adaptive techniques on the active type domain are either based on the thruster dynamics matrix or multiple mode fault tolerance methods yang et al 2008 the current approach discussed in this paper uses active fault tolerance control in the past various mathematical methodologies have been derived and utilized for failure management of auvs where weighted pseudo inverse method is one such method for fault accommodation in auvs it assigns a weight which is typically a numerical value ranging from 0 to 1 to the thrust components vertical and horizontal of all thrusters in the thruster dynamics matrix kanti podder and sarkar 1999 this method derives its basics from the principle of thrust allocation by pseudo inverse technique first significant works in this direction were carried out by kanti podder and sarkar 1999 podder et al 2000 their methodology was based on the absolute failure of thrusters which was later improved to include continuous or partial failure liu and zhu 2009 the novelty of the present paper is to attempt a fault tolerance control in the rotatable thrusters vehicle for spatial trajectory tracking which is one of the first attempts in the literature as per the knowledge of the authors a schematic in fig 1 shows the control scheme implemented in this paper where a desired pose and velocities are commanded for the trajectory tracking task in the presence of ocean currents disturbances based on the desired and actual state variables the tracking errors are calculated and the control torque is generated by the backstepping controller which is then fed to fault detection unit sensors to identify for any faults in the thrusters for a no failure case the thrust inputs are obtained from the fully actuated thruster dynamics if a failure is detected then the faults are isolated from the system as a single thruster failure or a multiple thruster failure if a single thruster fails completely then the weighted pseudo inverse method or the elimination of column method is used for accommodating the fault s in case if two thrusters fail completely a new strategy is employed to accommodate the two thrusters fault i e the vehicle is considered as an under actuated system and a line of sight approach is implemented for trajectory tracking in both of these approaches a reduced thruster dynamics is used in comparison to a fully actuated case the rest of the paper discusses the analysis of procedures explored and adopted for building a reliable fault tolerant system specific to an underwater robot with four rotatable thrusters and is organized as follows the nomenclature used in this paper is presented in section 3 and the dynamic modeling of auv is shown in section 4 including hydrodynamics of the vehicle and thruster dynamics followed by the controller design and derivation of its stability criterion in section 5 which is based on the backstepping motion control scheme to solve the nonlinear problem the tuning of gain values is described in section 5 1 and the simulations for single thruster faults implementing the elimination of column method and weighted pseudo inverse method is shown in sections 5 2 and 5 3 respectively the accommodation of multiple thruster failures is detailed in section 5 4 the summary and the concluding remarks are presented in section 6 3 nomenclature nomen clature description representation η a vector representing generalized coordinates in earth fixed frame of reference η η 1 t η 2 t t η 1 position vector along the surge sway and heave directions η 1 x y z t η 2 orientation vector represented by euler angle coordinates commonly referred to as roll pitch and yaw η 2 ϕ θ ψ t η d desired position and orientation vector expressed in the earth fixed frame of reference η d η 1 d t η 2 d t t η time derivative of η expressed in earth frame of reference η j η ν η tracking error for control expressed in the earth fixed frame of reference η η d η ν linear and angular velocities of the body fixed frame with respect to earth fixed frame expressed in the body fixed frame ν ν 1 t ν 2 t t ν 1 translational component of ν ν 1 u v w t ν 2 rotational component of ν angular velocity ν 2 p q r t ν d desired body fixed linear and angular velocities ν d ν 1 d t ν 2 d t t ν c desired velocity expressed as a virtual control variable in the body fixed frame ν c j d 1 η η ν c body fixed oceanic current velocity vector v c u c v c w c 0 0 0 t v c resultant average current velocity v c v c 0 0 t ν error in velocity expressed in a body fixed frame of reference ν ν c ν ν u upper bound for the body fixed linear and angular velocities j η jacobian matrix which transforms velocity from the body fixed frame to the earth fixed frame j η 2 m 6 6 inertia tensor consisting of the rigid body and added mass terms m m r b m a c ν coriolis and centripetal matrix composed of the rigid body and added mass terms c ν c r b ν c a ν d ν hydrodynamic damping matrix of the rigid body a diagonal and positive definite matrix g η gravity and buoyancy vector denoting gravitation and buoyant forces and moments considered negligible τ generalized forces and moments on the vehicle expressed in the body fixed frame τ τ 1 t τ 2 t t τ 1 a vector representing forces along surge sway and heave directions in body fixed frame τ 1 f x f y f z t τ 2 a vector representing moments along the roll pitch and yaw directions in the body fixed frame τ 2 m x m y m z t f vector consisting of horizontal and vertical thrust force components of the four thrusters f f h t f v t t f h vector consisting of horizontal thrust force components of the four thrusters f h f 1 f 2 f 3 f 4 t f v vector consisting of vertical thrust force components of the four thrusters f v f 5 f 6 f 7 f 8 t b thruster dynamics matrix of 6x8 array maps the thrust force vector f to generalized forces moment vectors both expressed in the body fixed frame τ b f α i th angle made by the thrust force vector with the horizontal plane xy plane where i a b c d thrusters α i tan 1 f v i f h i v lyapunov candidate function for proving the stability of the system by the controller v η ν 1 2 η t η 1 2 ν t ν k i gain constants for backstepping control k 1 0 9 k 2 7 τ c control forces and moments applied on the vehicle expressed in the body fixed frame τ c f u n c η ν τ u upper bound for the body fixed forces and moments htdm horizontal thrust dynamics matrix truncated to 3x4 array b i j i 1 2 3 j 1 2 3 4 vtdm vertical thrust dynamics matrix truncated to 3x4 array b i j i 4 5 6 j 5 6 7 8 htdme resultant matrix after eliminating the horizontal component of faulty thruster s force from htdm htdme htdm 3x3 vtdme resultant matrix after eliminating the vertical component of faulty thruster s force from vtdm vtdme vtdm 3x3 y diagonal matrix containing weights of horizontal and vertical components of thrusters forces y diag s11 s12 s13 s14 s21 s22 s23 s24 here 0 sim 1 γ c angle of attack of the v c in earth fixed frame of reference β c side slip angle of the v c in earth fixed frame of reference 4 dynamic model 4 1 vehicle design the subject of this analysis is an underwater vehicle similar to the tturt jin et al 2018 2015 and odyssey iv eskesen et al 2009 with a rectangular hull four rotatable thrusters are attached to the four corners of the hull of the vehicle they are pivoted about the diagonal axis of the hull and can rotate independently making the vehicle efficient in attaining 6 degrees of freedom dof motion as shown in fig 2 the rotatable thrusters mechanism has a nonlinear coupled model because of the rotatable angles and necessitates an additional complex control design compared to a fixed thruster system hagan and menhaj 1994 thus taking inspiration from the nonlinearity a backstepping control algorithm for an underwater robot whose thrusters can be rotated independently is employed to track the desired trajectory in 3d space the current model is over actuated with eight inputs to achieve the required control output the thrusters provide four inputs in the form of thrust force and the other four inputs are supplied by the servomotors to tilt each thruster unlike in the model proposed in jin et al 2015 where two servomotors control the rotatable movement of the four thrusters the thrusters are placed at an angle of 45 to the x z plane as shown in fig 2 and different motions possible are depicted in fig 3 for a 6 degree of freedom vehicle represented in the body fixed frame the geometrical and physical parameters of the model are displayed in table 1 4 2 assumptions few general assumptions are considered to simplify the vehicle dynamic model the off diagonal elements of the inertia matrix are neglected as the shape of the vehicle is approximated to a cuboid with three planes of symmetry the vehicle is considered neutrally buoyant and the center of gravity coincides with the center of buoyancy the rotatable thruster angular momentum is negligible due to comparatively small inertia lift forces are neglected due to the slow speed of the vehicle the external disturbances on the robot under consideration are only due to oceanic currents and it is assumed that the flow is irrotational and varies very slowly with time i e almost constant the effects of damping due to the wave and tidal frequency are insignificant acceleration due to gravity is considered as constant 9 81 m s2 the tuned gain values are chosen to be the same for both the position vector η 1 and orientation vector η 2 4 3 preliminary definitions the underwater vehicle motion analysis requires to define two coordinate reference frames the body fixed frame or moving coordinate reference frame or vehicle frame attached to the center of gravity of the vehicle expressed relative to a fixed inertial frame on the surface of the earth fossen 1994 η r6 is the vector representing the generalized coordinates in the earth fixed frame ν r6 denotes the linear and angular velocity vectors in the body fixed frame η η 1 t η 2 t t η 1 x y z t η 2 ϕ θ ψ t ν ν 1 t ν 2 t t ν 1 u v w t ν 2 p q r t in the earth fixed frame of reference the position vector η 1 represents the position of the vehicle along surge sway and heave directions and η 2 denotes the euler angle coordinates commonly named as roll pitch and yaw antonelli et al 2008 η is the time derivative of η in the inertial frame and the linear and angular velocities of the vehicle frame ν is expressed in the vehicle frame with respect to the inertial frame 4 4 equations of motion of the vehicle the euler lagrangian formulation based mathematical modeling of the underwater vehicle is developed through d alembert s principle and the principle of virtual work generally the equations of motion of the marine robot are given with respect to the body fixed frame the whole model is governed by two equations as shown in 1 and 2 fossen 1994 general equations of motion of an underwater vehicle 1 m ν c ν ν d ν ν g η τ the kinematic equations of the vehicle in the inertial frame 2 η j η ν where m is the 6 6 mass matrix or inertia tensor of the vehicle which consists of the rigid body and added mass terms the coriolis and centrifugal matrix c ν is a 6 6 matrix and the hydrodynamic damping matrix d v is a 6 6 diagonal and positive definite matrix the restoring forces and moments due to buoyancy and gravity is a 6 1 vector represented by g η the generalized forces and moments on the vehicle expressed in the body fixed frame are represented by τ a jacobian matrix j η for a rigid body in space fossen 1994 expressed in 3 in terms of the euler angles is defined here to map the velocity expressed in the body fixed frame to the earth fixed frame where the number of degrees of freedom is equal to the number of rows and number of generalized coordinates to the number of columns respectively craig 2005 3 j η c ψ c θ s ψ c ϕ c ψ s θ s ϕ s ψ s ϕ c ψ s θ s ϕ 0 0 0 s ψ c θ c ψ c ϕ s ψ s θ s ϕ c ψ s ϕ s ψ s θ c ϕ 0 0 0 s θ c θ s ϕ c θ c ϕ 0 0 0 0 0 0 1 s ϕ t θ c ϕ t θ 0 0 0 0 c ϕ s ϕ 0 0 0 0 s ϕ c θ c ϕ c θ where cθ cosθ sθ sinθ tθ tanθ 4 4 1 mass matrix the distribution of the rigid body mass is defined by the mass matrix or the inertia tensor the mass matrix in 4 is given as a sum of a rigid body matrix m rb in 5 and an added mass matrix m a which is the contribution of inertia due to the added mass as seen in 6 since the inertia matrix is symmetric and positive definite it is always possible to find a frame in which the matrix attains a diagonal form under certain assumptions in terms of symmetry this frame is called the principle frame vervoort 2009 4 m m r b m a the second term ma is the inertia contribution due to added mass where the fluid surrounding the body is accelerated with the body so a force is necessary to achieve this acceleration while the fluid exerts a reaction force that is equal in magnitude and opposite in direction mohan and thondiyath 2011 thus the added mass matrix terms of the auv are dependent on the form of the vehicle where the off diagonal elements in the present case are neglected as it has three planes of symmetry and moves at a low velocity antonelli et al 2008 the hydrodynamic added mass matrix is simplified to a diagonal matrix as the center of gravity of the vehicle coincides with the origin of the body fixed frame 5 m r b m 0 0 0 m z g m y g 0 m 0 m z g 0 m x g 0 0 m m y g m x g 0 0 m z g m y g i x x i x y i x z m z g 0 m x g i y x i y y i y z m y g m x g 0 i z x i z y i z z 6 m a x u 0 0 0 0 0 0 y v 0 0 0 0 0 0 z w 0 0 0 0 0 0 k p 0 0 0 0 0 0 m q 0 0 0 0 0 0 n r the strip theory is used to numerically derive the added mass and inertia terms fossen 1994 newman 1977 dong 1978 triantafyllou and hover 2003 the shape of the vehicle is considered as a rectangular parallelepiped to derive the coefficients of rigid body inertia and added mass matrices resulting in a positive definite constant and velocity independent inertia matrix m m m t 0 ṁ 0 thus the estimated parameters are given in table 2 below 4 4 2 centripetal and coriolis matrix the centripetal and coriolis matrix c ν in 7 is also composed of a rigid body term c rb ν and added mass term c a ν symbolized by a matrix aij where i j denotes the coriolis terms and remaining terms give the centripetal forces the centripetal and coriolis matrix c ν can always be parameterized as a skew symmetrical matrix for a rigid body motion in an ideal fluid 7 c ν c r b ν c a ν the strip theory can as well be used to derive the coefficients of the hydrodynamic centripetal and coriolis matrix as shown in table 1 and table 2 the explicit expressions for c rb ν and c a ν are given in 8 and 9 and the details can be found in fossen 1994 8 c rb ν 0 0 0 0 0 0 0 0 0 m q y g r z g m p y g w m p z g v m q x g w m p x g r z g m q z g u m r x g v m r y g u m p x g q y g m q y g r z g m q x g w m r x g v m p y g w m p x g r z g m r y g u m p z g v m q z g u m p x g q y g 0 q i y z p i x z r i z z r i y z p i x y q i y y q i y z p i x z r i z z 0 r i x z q i x y p i x x r i y z p i x y q i y y r i x z q i x y p i x x 0 9 c a ν 0 0 0 0 z w w y v v 0 0 0 z w w 0 x u u 0 0 0 y v v x u u 0 0 z w w y v v 0 n r r m q q z w w 0 x u u n r r 0 k p p y v v x u u 0 m q q k p p 0 4 4 3 damping matrix the drag of the auv is a dissipative force owing to the viscosity of the fluid as the auv moves at low speed it is safe to assume that the vehicle performs an uncoupled motion thus the hydrodynamic damping terms can be approximated to a non coupled diagonal matrix composed of a drag force fossen 1994 using computational fluid dynamics cfd analysis the drag coefficients due to linear velocity can be found an analytical approach georgiades 2005 was used to estimate the drag coefficients due to the angular velocities considering only quadratic terms of the damping matrix d ν given in 10 the drag coefficients for the surge sway and heave directions are determined newman 1977 and shown in table 3 such that d ν 0 ν r 6 10 d ν x u 0 0 0 0 0 0 y v 0 0 0 0 0 0 z w 0 0 0 0 0 0 k p 0 0 0 0 0 0 m q 0 0 0 0 0 0 n r x u u u 0 0 0 0 0 0 y v v v 0 0 0 0 0 0 z w w w 0 0 0 0 0 0 k p p p 0 0 0 0 0 0 m q q q 0 0 0 0 0 0 n r r r 4 4 4 an expression for restoring effects in any fluidic environment the gravitational and buoyancy forces are the restoring forces and moments the expression for g η is shown in fossen 1994 as the vehicle is assumed to be neutrally buoyant and center of gravity coincides with the center of buoyancy g η is considered as negligible 4 4 5 thruster dynamics the thrusters being studied rotate about an axis in the horizontal plane which are at an angle 45 to the xz plane in the body fixed frame as shown in fig 4 the complicated rotatable thruster interaction with hull are neglected in the present simulation the thrust force vector f is mapped to generalized forces moment vector by matrix b both expressed in the body fixed frame as seen in 11 11 τ b f here f f 1 f 2 f 3 f 4 f 5 f 6 f 7 f 8 t is a vector consisting of eight thrust force components of the four thrusters a b c d where f 1 f 2 f 3 f 4 are the horizontal components and f 5 f 6 f 7 f 8 are the vertical components of the resultant thrust forces f a f b f c f d of the thrusters a b c and d respectively the relationship between force components and their corresponding resultant thrust forces are shown in table 4 the rotatable angles in 12 are the angles made by the thrust force vector with the horizontal plane xy plane thus the four rotatable angles can be expressed as 12 α a t a n 1 f 5 f 1 α b t a n 1 f 6 f 2 α c t a n 1 f 7 f 3 α d t a n 1 f 8 f 4 the horizontal components of all thrusters forces are at an angle of 45 with respect to x and y axis thus component of f 1 along x direction is f 1 cos π 4 and along y direction is f 1 sin π 4 with this notion the net force experienced by the vehicle along x y and z directions is given by the vector sum of the thrust forces and moments by all the thrusters along each respective direction the forces are then mapped to generalized forces by using the following b matrix shown in 13 13 b 1 2 1 2 1 2 1 2 0 0 0 0 1 2 1 2 1 2 1 2 0 0 0 0 0 0 0 0 1 1 1 1 0 0 0 0 a 2 a 2 a 2 a 2 0 0 0 0 l 2 l 2 l 2 l 2 l a 2 2 l a 2 2 l a 2 2 l a 2 2 0 0 0 0 5 design of the controller the design of a nonlinear controller for the auv to track a required trajectory is discussed here such that the control system has to stabilize the vehicle within a reasonable error the present control scheme is a recursive procedure that interlaces the choice of a lyapunov function with the design of feedback control called backstepping which is suitable for strict feedback systems raptis and valavanis 2010 the current model has two subsystems the inner loop which is a kinematic equation and the outer loop a dynamic equation a special case of integrator backstepping for a second order system can be written as x 1 f 1 x 1 f 2 x 1 x 2 x 2 f 1 x 1 x 2 f 2 x 1 x 2 u here x 1 is η x 2 is ν and u is the control input this system is viewed as a cascade connection of two components the first component is with ν as input and the second component is the integrator khalil 1996 as seen in 14 14 η j η ν inner loop ν m 1 τ n ν η outer loop where n ν η c ν ν d ν ν g η a state feedback control is to be designed to stabilize the origin η 0 ν 0 which can be achieved by applying lyapunov stability criteria the lyapunov candidate function v has to be chosen such that v should be positive definite and v should be negative definite we define η η d η ν ν c ν where η d is the desired position and orientation vector η is the tracking error ν c is the control velocity and ν denotes the error in velocity k 1 and k 2 are the control gains assuming the tracking error as a decreasing exponential function as seen in 15 the equation can be written in the form of an ordinary differential equation 15 η ae k 1 t η k 1 η 0 ν j 1 η η d k 1 η choosing control velocity satisfying ν 0 we have 16 and 17 16 ν c j d 1 η η ν c j d 1 η η d k 1 η 17 η j η j d 1 η η d k 1 η j η ν consider the following lyapunov candidate function which is positive definite v η ν 1 2 η t η 1 2 ν t ν where v η ν 0 η a n d ν 0 for global asymptotic stability v 0 therefore choosing control input τ c in 18 such that v is negative definite we have 18 τ c n η ν m j d 1 η η d k 1 η j d η η d k 1 η m k 2 ν j t η η hence the thrust force vector can be calculated as shown in 19 19 f b n η ν b m j d 1 η η d k 1 η j d η η d k 1 η b m k 2 ν j t η η where b is the pseudo inverse of the thrust force matrix b golub and kahan 1964 v η ν η t k 1 η ν t k 2 ν 0 v η ν 0 t η ν since k 1 and k 2 are always positive definite in this case the controller guarantees an asymptotically stable system choosing appropriate values for gain constants k 1 and k 2 is essential for assurance of stability and improvement of the performance the values for k 1 and k 2 are found by trial and error basis considering the rms values of the error of the position and orientation 5 1 gain tuning an infinity shaped trajectory composed of two sine curves is chosen as a reference path for gain tuning using trial and error method the trajectory is a complex combination of the surge sway and heave with an amplitude of 2 m where the initial point of one sine curve is the ending point of the other as shown in fig 5 the robot is assumed to start at the origin of the earth fixed frame the rms values of error in position and orientation is calculated for every set of values of k 1 and k 2 and is plotted with k 1 k 2 erms values along x y z directions respectively the required values for k 1 and k 2 are chosen for the least rms value of the tracking error where the range of k 1 and k 2 are varied from 0 to 20 fig 6 illustrates the surface and contour plots of erms for various ranges of k 1 and k 2 as obtained finally out of all the values the set of k 1 and k 2 values that gave the most accurate results for a general case without failure as well as for both the fault accommodation case in the presence of failure are selected for all the simulation purposes k 1 0 9 and k 2 7 is chosen these simulations are run for the following three different conditions trajectory tracking of fully actuated case without failure of any thruster trajectory tracking with single thruster failure accommodated using the elimination of column method and weighted pseudo inverse method trajectory tracking for two thruster failure by considering the vehicle as under actuated initially the above optimized gain constants are applied to the backstepping control scheme of the vehicle to track an infinity shaped trajectory without considering any faults the simulation results are presented with respect to the simulation time t s plotted along the x axis in fig 7 10 fig 7 shows that the actual trajectory of the vehicle matches precisely with the reference trajectory in real time applications the initial pose error of the vehicle is an active concern in the control of an auv after switching on the controller as most of the robots are deployed from floating platforms like ships thus there is a good chance of initial pose error during deployment the pose error tracking error shown in fig 8 is significant during the beginning of the motion but the time for eliminating initial tracking error is observed to be approximately 3 seconds exploiting the proposed backstepping controller for a given complex trajectory whereas the errors during the subsequent motion are negligible considering the complexity of the path this observation proves that the above control scheme works well when the tracking errors are high initially the thrust forces acting on the vehicle are shown in fig 9 which is below 30n the rotary angles of all the thrusters are limited to a maximum of 90 as seen in fig 10 considering the possibility of cable damage due to continuous rotation thus exploiting the backstepping control scheme these errors settle down within 3 seconds for tracking a given complex trajectory with the generated thrust forces in the subsequent sections the implementation of fault tolerance by considering different methodologies is discussed the application of fault makes the model mathematically complicated from the control point of view thus mathematically suitable techniques are required for fault accommodation both the methods discussed in this manuscript are chosen from their ease of understanding and flexibility 5 2 elimination of column method in the initial stages of research given the non linearity of the auv model and rotating thrusters phenomenon it is required to understand the complex mathematics of the dynamic model and interpret it physically so that a scheme could be thought of to alter its dynamic behavior after the failure it is to be inferred from the rotatable thrusters auv model that failure of rotary action of one of the thrusters of rotatable four thruster model is analogically similar to the failure of two thrusters in a redundant 8 thruster model thus a loss of redundancy is inevitable and only a unique way or combination of thrusts is possible unlike when all the thrusters are functional there are infinite ways to achieve a given motion due to the redundancy recall the thruster dynamics matrix b from 11 in section 4 4 5 τ b f where f is an 8x1 column vector composed of vertical and horizontal components of the thrust of each thruster and τ is the torque vector 6x1 column vector representing forces and moments on the auv in the body fixed frame thus for a 6x1 torque vector we have an 8x1 thrust vector when all thrusters are functional which is a case of infinitely many solutions for a particular position and orientation due to the redundancy for a given trajectory and control input τ c at every instance the thrust force of each thruster is calculated from 19 as shown previously by employing the pseudo inverse of the thruster dynamics matrix conventionally an nx1 thrust vector is used for calculating the thrust of n thrusters in this present vehicle each thruster is analogous to two thrusters due to the rotating capability now assuming that one of the thrusters fail physically i e thruster b fails it will become non operational which means that the horizontal and vertical components f 2 and f 6 of the force from thruster b are zero this is the basis for the elimination of column method where the motion control equations are split into two parts horizontal and vertical mode the horizontal mode is concerned with the control of motion along surge sway and yaw and the vertical mode with movement along heave pitch and roll based on this idea our thruster dynamics matrix b is split into two parts viz horizontal and vertical thruster dynamics matrix note that the first second and sixth row of matrix b corresponds to the horizontal mode and the remaining corresponds to vertical mode thus two bifurcated matrices of sizes 3x4 from b are arrived as horizontal thrust dynamics matrix htdm vertical thrust dynamics matrix vtdm htdm 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 l a 2 2 l a 2 2 l a 2 2 l a 2 2 vtdm 1 1 1 1 a 2 a 2 a 2 a 2 l 2 l 2 l 2 l 2 conversely matrix b is arrived by concatenating htdm and vtdm in proper order in typical operation thruster matrix b maps torque vector to the thrust forces from thruster both expressed in the body fixed frame in case one of the thrusters fails the column corresponding to the horizontal and vertical part of that thruster from both these matrices is eliminated thus if thruster b fails the second column from htdm and vtdm are removed respectively which gives us two 3x3 square and invertible matrices hence a 6x1 torque column vector is calculated by dividing it into two 3x1 column vectors one of which controls the horizontal mode of operation and the other vertical mode of operation thus the structure of horizontal and vertical subsystem becomes htdme and vtdme 3x3 matrices after eliminating the required columns as seen in 20 and 21 horizontal subsystem 20 f 1 f 3 f 4 htdme 1 f x f y m z vertical subsystem 21 f 5 f 7 f 8 vtdme 1 f z m x m y where f 1 f 2 f 3 f 4 are the horizontal components of the thrust forces of thrusters 1 2 3 4 and f 5 f 6 f 7 f 8 are the vertical components of the thrust forces of thrusters 1 2 3 4 respectively f x f y f z m x m y m z are the forces and moments along surge sway heave roll pitch and yaw directions respectively since this model is entirely independent of thrust force of thruster b the redundancy is lost we have a unique solution and hence a unique combination of thrust forces that can generate the desired force vector in the inertial frame of reference the fault of a single thruster is simulated with simulation time as 70 seconds the vehicle follows the trajectory with minimal errors similar to that of without thruster failure case as shown in fig 11 and the tracking errors are shown in fig 12 from fig 12 it can be inferred that the errors settle down after 5 seconds compared to 3 seconds when there are no faults but it can also be observed that there is a small oscillation in the yaw tracking error during the time frame of 15 22 seconds which can be attributed to the high rate of yaw requirement during the initial turning motion required after the straight path in the trajectory but the order of the errors is similar to that observed in the no fault condition thus these oscillations do not affect the vehicle performance adversely the simulation results from fig 13 and fig 14 show that thrust generated and rotary angles of the thruster a fa are found to be oscillating between positive and negative values rapidly to follow the trajectory these oscillations are observed at the initial turning motion where a high rate of yaw requirement is visible it can also be found that only thruster a is affected with these oscillations whereas the remaining thrusters c and d have a smoother and continuous thrust force and tilt angle generation for the given profile also the maximum thrust generated by the thruster c and d increased to nearly 90 n at the start compared to a 30 n initial thrust when there is no fault in the system this oscillation behavior of thruster a and more thrust from thruster c and d can be attributed to the fact that the thruster a c and d has to take care of the absence of thruster b during failure where the thruster a is more loaded compared to the other thrusters thus the elimination of column method satisfies the requirement of vehicle following the required trajectory however there is a caveat in using this technique it is applicable as long as the mathematical model has at least one solution for the given set of equations i e it is physically logical and mathematically convenient to interpret and apply to the present vehicle model only until the loss of one thruster in case two thrusters fail in our model we effectively lose four inputs in the thrust force vector f and our mathematical model becomes a system of equations with no solution due to fewer inputs in the form of a thrust force vector compared to the required outputs in the form of torque vector to follow the 3d complex trajectory hence a new method called the weighted pseudo inverse method is implemented in the model to resolve this issue and to achieve our objective 5 3 weighted pseudo inverse method elimination of column method performed well in terms of following the reference trajectory by exploiting the backstepping control with the loss of a single thruster but it is limited to single thruster failure thus a new methodology called weighted pseudo inverse method is implemented in the present vehicle model most modern autonomous vehicles were found to apply this method for fault accommodation in auvs unlike the elimination method this methodology assigns a weight which is typically a numerical value ranging from 0 to 1 to the thrust components vertical and horizontal to all thrusters in the thruster dynamics matrix based on the failure in the present case a failed thruster is assigned weight 0 and a fully functional thruster is assigned weight 1 also with this approach it is possible to simulate the failure of more than one thruster the weighted pseudo inverse technique is implemented by assuming the failure of a single thruster in the simulation after assigning weights to thrusters as mentioned earlier a weight matrix w of size 8x8 is formed consider y as the inverse of w a diagonal matrix which contains entries in diagonal elements either as 0 or 1 depending upon failure such that its first four diagonal entries correspond to the weights of horizontal components and the last four diagonal entries to weights of vertical elements of the four rotatable thrusters y 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 if thruster a fails the weights to horizontal and vertical thrust force components are assigned to be zero i e the first and fifth entry of y matrix now using y w 1 the pseudo inverse of the thruster dynamics matrix b shown in 19 of section 4 4 5 changes to 22 thus to calculate the thrust force vector f from the τ c vector we use x b y n xx t 22 f x t n 1 τ c initially the failure of thruster a is chosen to occur at an intermediate point of the total simulation time based on the given trajectory the results of the fault accommodation are shown in fig 15 e to fig 15 h where the trajectory tracking motion is consistent and does not get affected by the single thruster failure based on these results it can be observed that even after the failure of thruster a the thrust demands for the trajectory tracking were accommodated by the remaining healthy thrusters in the case of the elimination method and the present method the failure of one of the thrusters did not affect the performance of the vehicle as six inputs are still active by the remaining three thrusters from the plots of tilt angles and thrust forces it can be concluded that even after the failure of thruster a the fault accommodation intertwined with the backstepping controller could take care of the possible uncertainty this performance also shows that three rotatable thrusters are sufficient to track the required complex trajectory comfortably but four thrusters provide symmetricity to present vehicle considering its rectangular shape and also the redundancy helps to reduce the thruster loads during complex operations and chances of vehicle failure during emergency dives till now we have discussed the failure of the thruster in generating the required thrust force in the next section we would consider the rotational failure of thrusters i e the thruster is stuck at a particular angle of rotation about the diagonal axis of the vehicle 5 3 1 rotational failure of thrusters a different approach towards the failure of the thruster is introduced at this stage conventionally a thruster is considered as failed if there is an undesired thrust output produced by that thruster with rotatable thrusters however another source of failure is possible i e rotatable action may stop working or rotation is random which can be attributed to the failure of an internal servo motor due to any unknown reasons due to this failure two cases are possible 1 rotation of the thrusters is random the actual angle of rotation may not obey the required rotation rate or rotation angle in this case the incorrect angle generates a variation in the commanded thrust forces even though the thrust action works well the thruster is considered as failed we have treated this also as a thruster failure and have modified the matrix y to accommodate the rotational failure of the thruster due to the internal servo motor the simulation results for this case would be the same as the results shown in fig 15 e 15 h 2 rotation of the thrusters stops working consider if the thruster s stops rotating though it generates the required thrust due to this the thrust force from that particular thruster constantly points at a single direction same as that it was pointing at the time of failure this thrust vector pointing in one direction is entirely undesirable this problem can be considered as two sub cases to accommodate for the correction required if necessary a if the thrust forces of remaining thrusters apart from the failed thruster stay within the threshold force limits then the vehicle could still track the given trajectory with considerably high tracking errors as shown in fig 15 a 15 d where the action of the controller itself automatically takes it to care as the remaining functional thrusters take care of the trajectory tracking problem fault accommodation was not incorporated in this case as it is resolvable within the system by the backstepping controller where all the thrusters continue to work including the ones whose tilt action has failed without the need of fault accommodation as in this case the tracking errors are substantial this approach is not suitable for tracking control problems b in case the thrust forces of remaining thrusters need to be generated exceed the threshold set by the user maximum limit of the thruster the previous case fails to track the given trajectory at this stage to resolve the loss of rotation of failed thruster a fault accommodation is employed by treating the excessive thrust requirement as a source of failure after implementing the fault accommodation with the weights of the failed thruster taken as zero the model senses the failure categorizes the fault and enables fault accommodation at this point for the failed thruster weighted pseudo inverse technique is implemented for this case after observing its flexibility of use and accuracy with the above two cases this case is simulated with an onset of fault in the system at an intermediate time t t 2 where t time of simulation by stopping the rotatable action of thruster a unlike the previous case where no fault was accommodated fig 15 c the thrust generated fig 15 g by the remaining healthy thrusters could accommodate the fault with minimum tracking errors as shown in fig 15 f which are comparable to the tracking errors without any faults fig 8 based on the plots shown in fig 15 e 15 h it can be concluded that there is a clear advantage of proposed fault accommodation methods compared to no fault accommodated case as shown in fig 15 a 15 d 5 3 2 multiple thruster failures it is clear from the vehicle model that the thrust vectors of the rotatable thruster model as shown in fig 4 with f 1 f 2 f 3 and f 4 are analogically similar to that of four horizontal thrusters and f 5 f 6 f 7 and f 8 are identical to that of four vertical thrusters in a redundant eight thruster system thus in the case of the rotating thruster model failure of a single thruster leads to loss of two force inputs thus losing effectively two degrees of freedom redundancy similarly if more than one thruster fails each thruster failure contributes to the loss of two degrees of freedom depending upon the extent of failure this case is implemented to understand the model characteristics by choosing the failure of thruster a and d thus fa 0 and fd 0 so f 1 f 5 f 4 f 8 0 plugging these values in 11 we get 23 23 f x f 2 f 3 2 f y f 2 f 3 2 f z f 6 f 7 m x f 6 f 7 a 2 m y f 6 f 7 l 2 m z f 2 f 3 l a 2 2 the above equations can be re written as below in 24 which shows the coupling between two different degrees of freedom in each equation 24 m z c 1 f y m y c 2 f z where c 1 and c 2 are constants represented by the vehicle dimensions l and a it can be seen that the motion in heave and sway axes and pitch and yaw axes are compromised due to the coupling between sway yaw and heave pitch respectively weighted pseudo inverse technique is used to confirm this hypothesis and a fault in thruster a and d is simulated the failure is programmed to occur at an intermediate time t 25 seconds in this case with rotation angles α a and α d and thrust forces fa and fd set to zero it is observed from fig 16 fig 17 fig 18 and fig 19 that the trajectory tracking is highly inaccurate after the failure of two thrusters and the position errors also shoot up this inaccuracy confirms that it is not possible to control the vehicle motion in 3d space with the failure of more than one thruster in our current scheme while simulating two thrusters failure it is noted that the matrix y becomes singular or non invertible thereby confirming that even though the weighted pseudo inverse technique allows us to contemplate the failure of more than one thruster unlike the column elimination method it is however mathematically inconsistent with the concept of this method thus the weighted pseudo inverse technique certainly had an advantage over the elimination of column technique as we can simulate two thruster failures with it however these techniques could not accommodate the complete failure of multiple thrusters due to a lesser number of control inputs maximum four than the controllable states six on the other hand it has also been observed that partial failure of the thrusters cannot be accommodated using the elimination method but the weighted pseudo inverse helps to accommodate partial failures hence a brief discussion on the scope of implementing weighted pseudo inverse method for the partial failure of multiple thrusters is presented at this point to show the advantage of the latter method compared to the former during the simulations the partial failure of the thruster is implemented by adjusting the weights of two thrusters to 0 4 in the weight matrix i e the thrust generated by these two thrusters is 60 lower as compared to the earlier cases in this case the failure is chosen to occur on the front thrusters a and b after 10 s from the start of trajectory tracking the results for the case of partial failure of two thrusters are shown in fig 20 a to fig 20 d it can be observed from the results in fig 20 a that the tracking of the vehicle in an infinity trajectory is sufficiently smooth as seen in fig 7 fig 20 c shows that the reduction in thrust from the front thrusters is accommodated by an increase in thrust values by the other two aft thrusters simultaneously as compared to the no fault case seen in fig 9 the slight increase in tracking errors are observed in fig 20 b as compared to no faults case in fig 8 this can be attributed to the thrust readjustment by the aft thrusters in other words the insufficient inputs from the faulty thrusters a and b are reallocated to the healthy thrusters c and d this proves that the proposed method works well even with the partial failure of multiple thrusters nevertheless in the case of complete failure of multiple thrusters our focus is to solve the motion control problem by resolving the trajectory problem into multiple mode planar cases for the stabilization problem they are horizontal and vertical modes and switch between each mode based on the mission requirements another strategy is to accommodate the two thrusters fault and yet track the path with a minimum possible error this is done by considering the vehicle as underactuated i e by implementing a line of sight approach with only four control inputs as two of the degrees of freedom are already coupled the same has been dealt with in the next section a flowchart is shown in fig 21 which describes the fault accommodation strategy implemented in this manuscript 5 4 line of sight approach for an under actuated case due to the failure of two thrusters the present vehicle is converted to an under actuated system where the total number of control inputs is fewer than the required dof to be controlled as the backstepping controller in a fully actuated case is successfully implemented now the same is extended to the trajectory tracking case of the under actuated system it is assumed that the roll is passively stabilized due to the inherent damping of the vehicle as the vehicle being discussed is flat about the roll axis thus based on the preliminary definitions defined in section 4 3 and 4 4 the model is effectively reduced to an under actuated system as discussed below in the present case the two front rotatable thrusters are assumed to be failed i e fa 0 and fb 0 thus the two aft rotatable thrusters are considered as the control inputs for the tracking problems we adopt the similar backstepping design used for the fully actuated case earlier as this suits the cascaded nature of dynamics of the vehicle 5 4 1 reduced equations of motion of the vehicle η r5 is the reduced vector representing the generalized coordinates in the earth fixed frame ν r5 denotes the reduced linear and angular velocity vectors in the body fixed frame η η 1 t η 2 t t η 1 x y z t η 2 θ ψ t ν ν 1 t ν 2 t t ν 1 u v w t ν 2 q r t the jacobian matrix j η is a 5x5 matrix that maps the body fixed velocity to the earth fixed velocities as shown below j η c ψ c θ s ψ c ψ s θ 0 0 s ψ c θ c ψ s ψ s θ 0 0 s θ 0 c θ 0 0 0 0 0 1 0 0 0 0 0 1 c θ the equations of motion of the vehicle shown in 1 and 2 in section 4 4 reduces to 5x5 matrices where m the mass matrix c ν the coriolis and centrifugal matrix includes both rigid body and added mass components as shown in 25 26 27 and 28 and d v the hydrodynamic damping matrix as shown in 29 the 5x1 τ vector represents the body fixed generalized forces and moments 25 m r b m 0 0 m z g m y g 0 m 0 0 m x g 0 0 m m x g 0 m z g 0 m x g i y y i y z m y g m x g 0 i z y i z z 26 m a x u 0 0 0 0 0 y v 0 0 0 0 0 z w 0 0 0 0 0 m q 0 0 0 0 0 n r 27 c rb ν 0 0 0 0 0 0 0 0 0 m q x g w m r z g m q z g u m r x g v m r y g u m q y g m q x g w m r x g v m r z g m r y g u m q z g u m q y g 0 r i x z q i x y r i x z q i x y 0 28 c a ν 0 0 0 z w w y v v 0 0 0 0 x u u 0 0 0 x u u 0 z w w 0 x u u 0 0 y v v x u u 0 0 0 29 d ν x u 0 0 0 0 0 y v 0 0 0 0 0 z w 0 0 0 0 0 m q 0 0 0 0 0 n r x u u u 0 0 0 0 0 y v v v 0 0 0 0 0 z w w w 0 0 0 0 0 m q q q 0 0 0 0 0 n r r r the 6x8 thruster dynamics matrix shown in 13 of section 4 4 5 also reduces to 5x4 matrix as indicated below in 30 due to the failure of the two forward thrusters 30 b 1 2 1 2 0 0 1 2 1 2 0 0 0 0 1 1 0 0 l 2 l 2 l a 2 2 l a 2 2 0 0 thus the vector f f 3 f 4 f 7 f 8 t consists of only four thrust force components corresponding to the resultant thrust forces fc and fd of the thrusters c and d respectively 5 4 2 simulation of the under actuated model the trajectory planning scheme of the under actuated vehicle caharija et al 2012 yu et al 2016 filoktimon and papadopoulos 2005 repoulias and papadopoulos 2007 zhou et al 2018 dong et al 2015 maps an inertial trajectory of the 3 d space to controllable state variables such as the body fixed velocities and the orientations the reference trajectory generated by the desired inertial position and the corresponding velocities is considered to be a feasible state space trajectory that is consistent with the vehicle dynamics it is assumed that the trajectory to be tracked is defined as a time function of inertial positions expressed by η 1 d and differentiable up to the third order with respect to time the error dynamics of the vehicle are obtained using the reference trajectory and to this end we can use the backstepping controller designed for the fully actuated case with reduced order dynamics to force the tracking error in the neighborhood of zero by using a same time varying control law chosen earlier the reference trajectory chosen is a circle of radius 2 m in 3d space with its centre at 0 2 2 and the starting point of the robot is 0 0 0 in the earth fixed frame the circular trajectory is chosen to show the vehicle tracking capabilities with different types of trajectories the controllable state variables such as pitch and yaw can be derived using reference trajectory in earth fixed frames as shown in 31 31 θ d a tan 2 z d x d ψ d a tan 2 y d x d the following assumptions are made for the under actuated vehicle model it is to be noted that the states such as the desired roll and its time rate of change cannot be controlled thus the roll dynamics of the vehicle are neglected it is also assumed that the vehicle s velocity and control input are bounded i e ν ν u and τ c τ u the desired tracking velocities ν d and their time derivatives ν d are bounded for any time t 0 the pitch angle of the under actuated auv is below 90 the design of a nonlinear controller for a fully actuated vehicle model using backstepping is shown in section 5 for tracking the desired trajectory within a reasonable error the stability of the nonlinear system is proven using the lyapunov stability criteria the primary idea here is to exploit the same control scheme and its designed parameters and utilize it for reduced order tracking problem by removing the dynamics of a state which cannot be controlled due to limitations of the under actuated system numerical simulations are carried out to verify and illustrate the performance of the vehicle with only two rotatable thrusters the results of the simulation are shown in fig 22 25 fig 22 shows the tracking of the vehicle in a circular trajectory which shows a small deviation in the beginning but later the vehicle tracks the trajectory sufficiently smooth this slight instability in the motion of the vehicle is due to the time taken to reach the required orientations of the vehicle the vehicle takes around 5 8 s to stabilize after which it has a smooth trajectory this proves that the proposed control scheme proves well for the vehicle with failure in two thrusters the position errors shown in fig 23 are in the same order as compared with no faults case by exploiting the proposed backstepping controller the position errors are found to be well within the practical limits it can be observed from fig 24 that the initial tracking errors require higher thrust forces during the start of the trajectory tracking the initial thrust force extracted by each thruster reach up to 25n and later settles down within a range of less than 6n which is well within the practical limits the rotary angles of all the thrusters are limited to a maximum of 90 as seen in fig 25 it can be observed that the validity of the proposed concept is proven for handling multiple thruster failure by considering the vehicle as an under actuated system thus it can be concluded that by taking advantage of the backstepping control scheme which deals with the convergence of tracking errors and compensating the parametric inaccuracies tracking in a 3d space is made possible 5 5 disturbance modeling ocean currents in this section numerical simulations are performed to understand the effect of external disturbances such as underwater oceanic currents on the performance of the controller designed the oceanic currents are modeled in 3 d cartesian space using a resultant average current velocity v c by defining two orientation angles namely angle of attack γ c and sideslip angle β c in the earth fixed frame of reference as shown in fig 26 it is assumed that the oceanic currents flow is irrotational and varies very slowly with time i e almost constant the details of the oceanic currents modeling is found in fossen 1994 and the relative velocity v r between the vehicle and current velocity is given below in 32 32 v r v v c here v c u c v c w c 0 0 0 t is the oceanic current velocity vector expressed in the body fixed frame of reference varying slowly with time thus we can write v r as in 33 33 v c 0 v r v in the 3 d cartesian space considering the orientation angles of the oceanic currents the velocity vector in the earth fixed frame of reference v c e u c e v c e w c e 0 0 0 t is expressed in terms of v c as seen in 34 34 u c e c o s γ c c o s β c v c v c e s i n β c v c w c e s i n γ c c o s β c v c the body fixed components of the oceanic current velocity are given by 35 35 u c v c w c j 1 t η 2 u c e v c e w c e where j 1 t η 2 cos ψ cos θ sin ψ cos θ cos ψ sin θ sin ϕ sin ψ sin ϕ cos ϕ cos ψ sin ϕ sin ψ cos θ cos ψ cos θ sin ψ sin θ sin ϕ cos ψ sin ϕ cos ϕ sin θ sin ϕ sin θ cos θ sin ϕ cos θ cos ϕ thus the modified equations of motion of the vehicle are given by 36 36 m v c v r v r d v r v r g η τ using the modified equations of motion presented in 36 and the control law given in 18 the performance of the controller is confirmed for its ability to control the adverse effects of oceanic currents effectively the variation of parameters γ c β c and v c are governed by first order gauss markov processes where zero mean random white noise processes and constants are used in the formulation of these equations the procedure adopted can be found in fossen 1994 a single thruster failure is accommodated using the weighted pseudo inverse method for numerical simulation under the effect of oceanic currents the trajectory tracking results are superimposed with oceanic currents vector as shown in fig 27 fig 28 fig 29 and fig 30 shows the variation of pose error thrust forces and thrusters rotation angle in the presence of oceanic currents the maximum values of errors obtained in the absence of underwater currents are comparable to the values obtained in the presence of currents this proves that the proposed methods are capable of generating trajectory with the desired level of performance even in the presence of oceanic currents thus this study shows that the control scheme along with the fault tolerance methods gives desirable results in the presence of external disturbances it is also observed that the direct information of oceanic currents is not required in the controller as the control scheme considers the oceanic currents without the need for their measurements since the effects of the currents are directly replicated as the deviations in the position and orientations during the vehicle motion which can be acquired from the measurements of the navigation sensors thus the proposed method of fault accommodation performs well in the presence of ocean currents and the same methodology can be extended to the under actuated case of vehicle 6 summary and conclusion the proposed underwater robot model is nonlinear due to the presence of four rotatable thrusters the robot s dynamic model developed is based on the hydrodynamics of the eight input neutrally buoyant vehicle the control law is derived based on the backstepping control scheme and the system s stability is ensured by using the lyapunov stability theory the controller gain constants for a 3d complex trajectory have been tuned using rms values of tracking error where the simulation results proved useful in stabilizing the auv and attaining the tracking error to the neighborhood of zero by exploiting the backstepping control later the model is accommodated with the absolute or complete failure of a single thruster by using two different methods 1 elimination of column method and 2 weighted pseudo inverse method both techniques were implemented successfully for a single thruster failure however the former method had a mathematical inconsistency when applied for more than one thruster failure here the next method emerged as a potential solution for more than one thruster failure during the operation however the vehicle model could not track the required 3d trajectory due to the loss of additional inputs than that of the needed degrees of freedom but it was noted that the weighted pseudo inverse technique allows us to contemplate the failure of more than one thruster unlike the column elimination method the inaccuracy in tracking the path shows that absolute complete failure of multiple thrusters is out of scope for the rotatable thruster robot model for the case of trajectory tracking by using the elimination of column method and weighted pseudo inverse method however a brief discussion on the partial failure of multiple thrusters implementing weighted pseudo inverse method was given to showcase the advantage of the latter method compared to the former finally an attempt to solve the motion control problem of multiple thruster failures is made by accommodating two faulty thrusters and the underwater vehicle is considered as underactuated i e by implementing a line of sight approach with four control inputs and yet track the path with minimum possible error as two of the degrees of freedom are already coupled similarly the validity of the proposed fault accommodation model has been tested further by the inclusion of oceanic currents and its corresponding effect on vehicle motion by simulating a single faulty thruster using the weighted pseudo inverse method in both cases the performance of the vehicle is found to be satisfactory based on the different approach methodologies implemented in this study there is a requirement to quantify the amount of variation in the performance of the vehicle characteristics under the fault based on the extent of the damage one of such quantifiers is maneuverability study maneuverability is defined as the inverse of the power consumption of all the thrusters mounted on the vehicle normalized to the cube third power of the velocity pugi et al 2018 thus these studies on maneuverability will also be undertaken as a part of the future scope by implementing the fault in the vehicle and understand the maneuverability characteristics which would benefit in choosing the required fault accommodation technique apriori to the implementation in the actual prototype vehicle for improved robustness author contribution jagadeesh kadiyam conceptualization methodology software investigation writing original draft preparation writing review editing visualization anjali parashar software investigation writing original draft preparation writing review editing visualization santhakumar mohan conceptualization methodology software writing review editing supervision project administration funding acquisition devendra deshmukh writing review editing project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is partially funded by the department of higher education dhd india 1 36 2016 pn ii and by the international collaboration research program through the national research foundation of korea nrf funded by the ministry of science and ict nrf 2017k1a3a1a19071037 and the department of science and technology dst ministry of science and technology india int korea p 43 
22167,this paper presents the mathematical design and implementation of an actuator fault tolerant control system for an underwater robot having four rotatable thrusters where the rotatable action of the thrusters is unconventional to a conventional underwater robotic system initially the dynamic model of the robot is presented later a motion control scheme using a backstepping control technique is made to track a desired spatial trajectory two techniques of active fault tolerance control viz elimination of column method and weighted pseudo inverse method are implemented successfully for single actuator faults on an infinity shaped trajectory which is a critical aspect of this study as most of the previous literature reported only on set point control the methods mentioned above are extended to multiple thrusters failure but both of them could not handle more than a single thruster failure hence an attempt is made to accommodate two thrusters failure through the line of sight approach by considering the vehicle as under actuated the desired vehicle performance is achieved with this approach finally oceanic currents are modeled to simulate the effectiveness of the methods discussed in the paper to prove the performance capabilities of the control system and fault accommodation schemes under realistic conditions keywords rotatable thrusters actuator fault tolerance weighted pseudo inverse fault accommodation backstepping control underactuated control line of sight oceanic currents 1 introduction the surroundings are complicated and uncontrollable which affects the motion of the autonomous underwater vehicles auvs in the oceans let alone accomplish missions effectively the operation of an auv is highly uncertain with fair chances of losing the vehicle due to the partially observable dynamic and unstructured environment seto and bashir 2017 this uncertain dynamic underwater environment makes what are considered to be simple tasks on land like plugging of sockets or operations on valves very complicated and might take hours to complete using a remotely operated vehicle rov with manipulator system leading to operator fatigue also in many underwater tasks most manipulation activities demand centimeter or less precision but the accuracy of vehicle position achieved by most underwater sensors is less therefore it is difficult to effectively implement complicated motion control in real time especially in autonomous mode few advanced control research studies on auvs are reported by seto and bashir 2017 yoerger and slotine 1985 yang et al 1999 carreras et al 2005 zhao and yuh 2005 fuqiang et al 2013 capocci et al 2017 lapierre and jouvencel 2008 on the implementation of sophisticated robust control techniques on underwater vehicles that are capable of handling possible difficulties created during the operation due to the uncertain underwater terrain during the operation the failure of one or more subsystems such as thrusters of the auvs is one of the significant uncertainties auvs must be well equipped with efficient fault detection mechanism before their launch raanan et al 2016 to avoid the loss of vehicle during operation the probability of the vehicle loss can be reduced by mitigating the effects of the subsystem failures by continuous monitoring of their health given the risk reference of a particular mission dearden and ernits 2013 this manuscript does not discuss the details of health monitoring techniques but assumes that the failure is already known for the simulation purpose fault tolerance in thruster based auvs have been dealt with previously in several different ways it is a technique which contains three stages of execution fault identification fault isolation fault accommodation the first two parts of fault tolerance are focused on identifying potential causes of failure in an auv and eliminating them fault detection involves monitoring a system to detect the presence of failures and the capability to determine which particular subsystem is subject to failure is called fault isolation or diagnosis antonelli 2003 fault identification involves using a deterministic approach for the detection of faults it is used interchangeably with the term fault detection fault detection schemes are usually model based alekseev et al 1994 alessandri et al 1999 and in real time vehicles health monitoring tools such as principal component analysis pca and partial kernel principal component analysis pkpca are used for combined sensor based fault detection and isolation navi et al 2015 the third stage involves fault accommodation which is vehicle or system specific caccia et al 2001 it is based upon the geometry of the vehicle location and number of thrusters the extent of redundancy of the system and control architecture etc all these factors contribute to the development of an alternate course of action which usually involves manipulation in control strategy when the thrusters experience failure fault accommodation on the vehicle also depends on the extent of damage to the thrusters and if possible adjustment of the fault is also taken care by the robust motion control scheme of the vehicle by usually reconfiguring the control to carry out the desired task without compromising on accuracy as much as possible alekseev et al 1994 alessandri et al 1999 caccia et al 2001 in the recent literature a fault in thrusters was considered absolute while implementing system specific fault accommodation techniques which entirely discontinues the use of faulty thruster s and apply new ways of completing the assigned trajectory using remaining thrusters only this absolute fault is mostly achieved and works well with redundant thrusters based auvs and further progressed to six thruster auvs later based upon variation in the model of the vehicle such as six thruster based vehicles and four thruster based vehicles few model specific modifications of fault accommodation techniques were reported choi et al 2014 liu and zhu 2009 further advancements led to the improvement of this technique and the concept of partial failure was brought in where a faulty thruster s still functions but only to a certain extent based on the scale of damage liu and zhu 2009 this research paper focuses mainly on the absolute or complete failure of thrusters and contains the analysis of procedures explored and adopted for building a reliable fault tolerant system specific to an underwater robot with four rotatable thrusters initially the following two techniques for fault accommodation have been discussed in this paper elimination of column method weighted pseudo inverse method the limitation of both techniques is that they are applicable only in case of a redundant thruster system multiple mode fault tolerance technique such as multiple mode sliding controller is discussed in the literature lingli and fuller 2003 with dual stern rudder failures but the study was limited to only a planar case thus an attempt is made to accommodate multiple thruster failures considering the two forward rotatable thrusters faulty for a spatial trajectory tracking and the vehicle as under actuated 2 research rationale during the continuous operation the faults failures can disrupt the motion of the vehicle leading to situations where missions may need to be aborted blanke et al 2006 thus identifying and managing faults in auvs that use thrusters as propulsion systems has always been a significant concern wang et al 2007 therefore it is required to understand the characteristics of the auv in the presence of such failures beforehand for the successful operation of the vehicle using simulations which is the interest of the current research fault tolerance control ftc of auvs is one of the most fundamental strategies to ensure the safety of the vehicle two types of control strategies are reported in the literature viz active fault tolerance control and passive fault tolerance control yang et al 2008 in passive type fault tolerance control robust control techniques assure insensitivity to specific faults but the design of robust control scheme requires an accurate dynamic model of the auv which depends on the complexity of the vehicle dynamics karras et al 2019 and gives better estimates of the navigation state owing to control capability when the vehicle moves in complex paths allotta et al 2018 on the contrary the active approach forces the controller to compensate for the effect of actuators defects either by choosing one of the predefined control laws for different fault conditions or by combining a new control scheme based on the failure in the system lingli and fuller 2003 it has been observed that the active type fault tolerant systems are employed more often since they function in real time and are adaptive techniques on the active type domain are either based on the thruster dynamics matrix or multiple mode fault tolerance methods yang et al 2008 the current approach discussed in this paper uses active fault tolerance control in the past various mathematical methodologies have been derived and utilized for failure management of auvs where weighted pseudo inverse method is one such method for fault accommodation in auvs it assigns a weight which is typically a numerical value ranging from 0 to 1 to the thrust components vertical and horizontal of all thrusters in the thruster dynamics matrix kanti podder and sarkar 1999 this method derives its basics from the principle of thrust allocation by pseudo inverse technique first significant works in this direction were carried out by kanti podder and sarkar 1999 podder et al 2000 their methodology was based on the absolute failure of thrusters which was later improved to include continuous or partial failure liu and zhu 2009 the novelty of the present paper is to attempt a fault tolerance control in the rotatable thrusters vehicle for spatial trajectory tracking which is one of the first attempts in the literature as per the knowledge of the authors a schematic in fig 1 shows the control scheme implemented in this paper where a desired pose and velocities are commanded for the trajectory tracking task in the presence of ocean currents disturbances based on the desired and actual state variables the tracking errors are calculated and the control torque is generated by the backstepping controller which is then fed to fault detection unit sensors to identify for any faults in the thrusters for a no failure case the thrust inputs are obtained from the fully actuated thruster dynamics if a failure is detected then the faults are isolated from the system as a single thruster failure or a multiple thruster failure if a single thruster fails completely then the weighted pseudo inverse method or the elimination of column method is used for accommodating the fault s in case if two thrusters fail completely a new strategy is employed to accommodate the two thrusters fault i e the vehicle is considered as an under actuated system and a line of sight approach is implemented for trajectory tracking in both of these approaches a reduced thruster dynamics is used in comparison to a fully actuated case the rest of the paper discusses the analysis of procedures explored and adopted for building a reliable fault tolerant system specific to an underwater robot with four rotatable thrusters and is organized as follows the nomenclature used in this paper is presented in section 3 and the dynamic modeling of auv is shown in section 4 including hydrodynamics of the vehicle and thruster dynamics followed by the controller design and derivation of its stability criterion in section 5 which is based on the backstepping motion control scheme to solve the nonlinear problem the tuning of gain values is described in section 5 1 and the simulations for single thruster faults implementing the elimination of column method and weighted pseudo inverse method is shown in sections 5 2 and 5 3 respectively the accommodation of multiple thruster failures is detailed in section 5 4 the summary and the concluding remarks are presented in section 6 3 nomenclature nomen clature description representation η a vector representing generalized coordinates in earth fixed frame of reference η η 1 t η 2 t t η 1 position vector along the surge sway and heave directions η 1 x y z t η 2 orientation vector represented by euler angle coordinates commonly referred to as roll pitch and yaw η 2 ϕ θ ψ t η d desired position and orientation vector expressed in the earth fixed frame of reference η d η 1 d t η 2 d t t η time derivative of η expressed in earth frame of reference η j η ν η tracking error for control expressed in the earth fixed frame of reference η η d η ν linear and angular velocities of the body fixed frame with respect to earth fixed frame expressed in the body fixed frame ν ν 1 t ν 2 t t ν 1 translational component of ν ν 1 u v w t ν 2 rotational component of ν angular velocity ν 2 p q r t ν d desired body fixed linear and angular velocities ν d ν 1 d t ν 2 d t t ν c desired velocity expressed as a virtual control variable in the body fixed frame ν c j d 1 η η ν c body fixed oceanic current velocity vector v c u c v c w c 0 0 0 t v c resultant average current velocity v c v c 0 0 t ν error in velocity expressed in a body fixed frame of reference ν ν c ν ν u upper bound for the body fixed linear and angular velocities j η jacobian matrix which transforms velocity from the body fixed frame to the earth fixed frame j η 2 m 6 6 inertia tensor consisting of the rigid body and added mass terms m m r b m a c ν coriolis and centripetal matrix composed of the rigid body and added mass terms c ν c r b ν c a ν d ν hydrodynamic damping matrix of the rigid body a diagonal and positive definite matrix g η gravity and buoyancy vector denoting gravitation and buoyant forces and moments considered negligible τ generalized forces and moments on the vehicle expressed in the body fixed frame τ τ 1 t τ 2 t t τ 1 a vector representing forces along surge sway and heave directions in body fixed frame τ 1 f x f y f z t τ 2 a vector representing moments along the roll pitch and yaw directions in the body fixed frame τ 2 m x m y m z t f vector consisting of horizontal and vertical thrust force components of the four thrusters f f h t f v t t f h vector consisting of horizontal thrust force components of the four thrusters f h f 1 f 2 f 3 f 4 t f v vector consisting of vertical thrust force components of the four thrusters f v f 5 f 6 f 7 f 8 t b thruster dynamics matrix of 6x8 array maps the thrust force vector f to generalized forces moment vectors both expressed in the body fixed frame τ b f α i th angle made by the thrust force vector with the horizontal plane xy plane where i a b c d thrusters α i tan 1 f v i f h i v lyapunov candidate function for proving the stability of the system by the controller v η ν 1 2 η t η 1 2 ν t ν k i gain constants for backstepping control k 1 0 9 k 2 7 τ c control forces and moments applied on the vehicle expressed in the body fixed frame τ c f u n c η ν τ u upper bound for the body fixed forces and moments htdm horizontal thrust dynamics matrix truncated to 3x4 array b i j i 1 2 3 j 1 2 3 4 vtdm vertical thrust dynamics matrix truncated to 3x4 array b i j i 4 5 6 j 5 6 7 8 htdme resultant matrix after eliminating the horizontal component of faulty thruster s force from htdm htdme htdm 3x3 vtdme resultant matrix after eliminating the vertical component of faulty thruster s force from vtdm vtdme vtdm 3x3 y diagonal matrix containing weights of horizontal and vertical components of thrusters forces y diag s11 s12 s13 s14 s21 s22 s23 s24 here 0 sim 1 γ c angle of attack of the v c in earth fixed frame of reference β c side slip angle of the v c in earth fixed frame of reference 4 dynamic model 4 1 vehicle design the subject of this analysis is an underwater vehicle similar to the tturt jin et al 2018 2015 and odyssey iv eskesen et al 2009 with a rectangular hull four rotatable thrusters are attached to the four corners of the hull of the vehicle they are pivoted about the diagonal axis of the hull and can rotate independently making the vehicle efficient in attaining 6 degrees of freedom dof motion as shown in fig 2 the rotatable thrusters mechanism has a nonlinear coupled model because of the rotatable angles and necessitates an additional complex control design compared to a fixed thruster system hagan and menhaj 1994 thus taking inspiration from the nonlinearity a backstepping control algorithm for an underwater robot whose thrusters can be rotated independently is employed to track the desired trajectory in 3d space the current model is over actuated with eight inputs to achieve the required control output the thrusters provide four inputs in the form of thrust force and the other four inputs are supplied by the servomotors to tilt each thruster unlike in the model proposed in jin et al 2015 where two servomotors control the rotatable movement of the four thrusters the thrusters are placed at an angle of 45 to the x z plane as shown in fig 2 and different motions possible are depicted in fig 3 for a 6 degree of freedom vehicle represented in the body fixed frame the geometrical and physical parameters of the model are displayed in table 1 4 2 assumptions few general assumptions are considered to simplify the vehicle dynamic model the off diagonal elements of the inertia matrix are neglected as the shape of the vehicle is approximated to a cuboid with three planes of symmetry the vehicle is considered neutrally buoyant and the center of gravity coincides with the center of buoyancy the rotatable thruster angular momentum is negligible due to comparatively small inertia lift forces are neglected due to the slow speed of the vehicle the external disturbances on the robot under consideration are only due to oceanic currents and it is assumed that the flow is irrotational and varies very slowly with time i e almost constant the effects of damping due to the wave and tidal frequency are insignificant acceleration due to gravity is considered as constant 9 81 m s2 the tuned gain values are chosen to be the same for both the position vector η 1 and orientation vector η 2 4 3 preliminary definitions the underwater vehicle motion analysis requires to define two coordinate reference frames the body fixed frame or moving coordinate reference frame or vehicle frame attached to the center of gravity of the vehicle expressed relative to a fixed inertial frame on the surface of the earth fossen 1994 η r6 is the vector representing the generalized coordinates in the earth fixed frame ν r6 denotes the linear and angular velocity vectors in the body fixed frame η η 1 t η 2 t t η 1 x y z t η 2 ϕ θ ψ t ν ν 1 t ν 2 t t ν 1 u v w t ν 2 p q r t in the earth fixed frame of reference the position vector η 1 represents the position of the vehicle along surge sway and heave directions and η 2 denotes the euler angle coordinates commonly named as roll pitch and yaw antonelli et al 2008 η is the time derivative of η in the inertial frame and the linear and angular velocities of the vehicle frame ν is expressed in the vehicle frame with respect to the inertial frame 4 4 equations of motion of the vehicle the euler lagrangian formulation based mathematical modeling of the underwater vehicle is developed through d alembert s principle and the principle of virtual work generally the equations of motion of the marine robot are given with respect to the body fixed frame the whole model is governed by two equations as shown in 1 and 2 fossen 1994 general equations of motion of an underwater vehicle 1 m ν c ν ν d ν ν g η τ the kinematic equations of the vehicle in the inertial frame 2 η j η ν where m is the 6 6 mass matrix or inertia tensor of the vehicle which consists of the rigid body and added mass terms the coriolis and centrifugal matrix c ν is a 6 6 matrix and the hydrodynamic damping matrix d v is a 6 6 diagonal and positive definite matrix the restoring forces and moments due to buoyancy and gravity is a 6 1 vector represented by g η the generalized forces and moments on the vehicle expressed in the body fixed frame are represented by τ a jacobian matrix j η for a rigid body in space fossen 1994 expressed in 3 in terms of the euler angles is defined here to map the velocity expressed in the body fixed frame to the earth fixed frame where the number of degrees of freedom is equal to the number of rows and number of generalized coordinates to the number of columns respectively craig 2005 3 j η c ψ c θ s ψ c ϕ c ψ s θ s ϕ s ψ s ϕ c ψ s θ s ϕ 0 0 0 s ψ c θ c ψ c ϕ s ψ s θ s ϕ c ψ s ϕ s ψ s θ c ϕ 0 0 0 s θ c θ s ϕ c θ c ϕ 0 0 0 0 0 0 1 s ϕ t θ c ϕ t θ 0 0 0 0 c ϕ s ϕ 0 0 0 0 s ϕ c θ c ϕ c θ where cθ cosθ sθ sinθ tθ tanθ 4 4 1 mass matrix the distribution of the rigid body mass is defined by the mass matrix or the inertia tensor the mass matrix in 4 is given as a sum of a rigid body matrix m rb in 5 and an added mass matrix m a which is the contribution of inertia due to the added mass as seen in 6 since the inertia matrix is symmetric and positive definite it is always possible to find a frame in which the matrix attains a diagonal form under certain assumptions in terms of symmetry this frame is called the principle frame vervoort 2009 4 m m r b m a the second term ma is the inertia contribution due to added mass where the fluid surrounding the body is accelerated with the body so a force is necessary to achieve this acceleration while the fluid exerts a reaction force that is equal in magnitude and opposite in direction mohan and thondiyath 2011 thus the added mass matrix terms of the auv are dependent on the form of the vehicle where the off diagonal elements in the present case are neglected as it has three planes of symmetry and moves at a low velocity antonelli et al 2008 the hydrodynamic added mass matrix is simplified to a diagonal matrix as the center of gravity of the vehicle coincides with the origin of the body fixed frame 5 m r b m 0 0 0 m z g m y g 0 m 0 m z g 0 m x g 0 0 m m y g m x g 0 0 m z g m y g i x x i x y i x z m z g 0 m x g i y x i y y i y z m y g m x g 0 i z x i z y i z z 6 m a x u 0 0 0 0 0 0 y v 0 0 0 0 0 0 z w 0 0 0 0 0 0 k p 0 0 0 0 0 0 m q 0 0 0 0 0 0 n r the strip theory is used to numerically derive the added mass and inertia terms fossen 1994 newman 1977 dong 1978 triantafyllou and hover 2003 the shape of the vehicle is considered as a rectangular parallelepiped to derive the coefficients of rigid body inertia and added mass matrices resulting in a positive definite constant and velocity independent inertia matrix m m m t 0 ṁ 0 thus the estimated parameters are given in table 2 below 4 4 2 centripetal and coriolis matrix the centripetal and coriolis matrix c ν in 7 is also composed of a rigid body term c rb ν and added mass term c a ν symbolized by a matrix aij where i j denotes the coriolis terms and remaining terms give the centripetal forces the centripetal and coriolis matrix c ν can always be parameterized as a skew symmetrical matrix for a rigid body motion in an ideal fluid 7 c ν c r b ν c a ν the strip theory can as well be used to derive the coefficients of the hydrodynamic centripetal and coriolis matrix as shown in table 1 and table 2 the explicit expressions for c rb ν and c a ν are given in 8 and 9 and the details can be found in fossen 1994 8 c rb ν 0 0 0 0 0 0 0 0 0 m q y g r z g m p y g w m p z g v m q x g w m p x g r z g m q z g u m r x g v m r y g u m p x g q y g m q y g r z g m q x g w m r x g v m p y g w m p x g r z g m r y g u m p z g v m q z g u m p x g q y g 0 q i y z p i x z r i z z r i y z p i x y q i y y q i y z p i x z r i z z 0 r i x z q i x y p i x x r i y z p i x y q i y y r i x z q i x y p i x x 0 9 c a ν 0 0 0 0 z w w y v v 0 0 0 z w w 0 x u u 0 0 0 y v v x u u 0 0 z w w y v v 0 n r r m q q z w w 0 x u u n r r 0 k p p y v v x u u 0 m q q k p p 0 4 4 3 damping matrix the drag of the auv is a dissipative force owing to the viscosity of the fluid as the auv moves at low speed it is safe to assume that the vehicle performs an uncoupled motion thus the hydrodynamic damping terms can be approximated to a non coupled diagonal matrix composed of a drag force fossen 1994 using computational fluid dynamics cfd analysis the drag coefficients due to linear velocity can be found an analytical approach georgiades 2005 was used to estimate the drag coefficients due to the angular velocities considering only quadratic terms of the damping matrix d ν given in 10 the drag coefficients for the surge sway and heave directions are determined newman 1977 and shown in table 3 such that d ν 0 ν r 6 10 d ν x u 0 0 0 0 0 0 y v 0 0 0 0 0 0 z w 0 0 0 0 0 0 k p 0 0 0 0 0 0 m q 0 0 0 0 0 0 n r x u u u 0 0 0 0 0 0 y v v v 0 0 0 0 0 0 z w w w 0 0 0 0 0 0 k p p p 0 0 0 0 0 0 m q q q 0 0 0 0 0 0 n r r r 4 4 4 an expression for restoring effects in any fluidic environment the gravitational and buoyancy forces are the restoring forces and moments the expression for g η is shown in fossen 1994 as the vehicle is assumed to be neutrally buoyant and center of gravity coincides with the center of buoyancy g η is considered as negligible 4 4 5 thruster dynamics the thrusters being studied rotate about an axis in the horizontal plane which are at an angle 45 to the xz plane in the body fixed frame as shown in fig 4 the complicated rotatable thruster interaction with hull are neglected in the present simulation the thrust force vector f is mapped to generalized forces moment vector by matrix b both expressed in the body fixed frame as seen in 11 11 τ b f here f f 1 f 2 f 3 f 4 f 5 f 6 f 7 f 8 t is a vector consisting of eight thrust force components of the four thrusters a b c d where f 1 f 2 f 3 f 4 are the horizontal components and f 5 f 6 f 7 f 8 are the vertical components of the resultant thrust forces f a f b f c f d of the thrusters a b c and d respectively the relationship between force components and their corresponding resultant thrust forces are shown in table 4 the rotatable angles in 12 are the angles made by the thrust force vector with the horizontal plane xy plane thus the four rotatable angles can be expressed as 12 α a t a n 1 f 5 f 1 α b t a n 1 f 6 f 2 α c t a n 1 f 7 f 3 α d t a n 1 f 8 f 4 the horizontal components of all thrusters forces are at an angle of 45 with respect to x and y axis thus component of f 1 along x direction is f 1 cos π 4 and along y direction is f 1 sin π 4 with this notion the net force experienced by the vehicle along x y and z directions is given by the vector sum of the thrust forces and moments by all the thrusters along each respective direction the forces are then mapped to generalized forces by using the following b matrix shown in 13 13 b 1 2 1 2 1 2 1 2 0 0 0 0 1 2 1 2 1 2 1 2 0 0 0 0 0 0 0 0 1 1 1 1 0 0 0 0 a 2 a 2 a 2 a 2 0 0 0 0 l 2 l 2 l 2 l 2 l a 2 2 l a 2 2 l a 2 2 l a 2 2 0 0 0 0 5 design of the controller the design of a nonlinear controller for the auv to track a required trajectory is discussed here such that the control system has to stabilize the vehicle within a reasonable error the present control scheme is a recursive procedure that interlaces the choice of a lyapunov function with the design of feedback control called backstepping which is suitable for strict feedback systems raptis and valavanis 2010 the current model has two subsystems the inner loop which is a kinematic equation and the outer loop a dynamic equation a special case of integrator backstepping for a second order system can be written as x 1 f 1 x 1 f 2 x 1 x 2 x 2 f 1 x 1 x 2 f 2 x 1 x 2 u here x 1 is η x 2 is ν and u is the control input this system is viewed as a cascade connection of two components the first component is with ν as input and the second component is the integrator khalil 1996 as seen in 14 14 η j η ν inner loop ν m 1 τ n ν η outer loop where n ν η c ν ν d ν ν g η a state feedback control is to be designed to stabilize the origin η 0 ν 0 which can be achieved by applying lyapunov stability criteria the lyapunov candidate function v has to be chosen such that v should be positive definite and v should be negative definite we define η η d η ν ν c ν where η d is the desired position and orientation vector η is the tracking error ν c is the control velocity and ν denotes the error in velocity k 1 and k 2 are the control gains assuming the tracking error as a decreasing exponential function as seen in 15 the equation can be written in the form of an ordinary differential equation 15 η ae k 1 t η k 1 η 0 ν j 1 η η d k 1 η choosing control velocity satisfying ν 0 we have 16 and 17 16 ν c j d 1 η η ν c j d 1 η η d k 1 η 17 η j η j d 1 η η d k 1 η j η ν consider the following lyapunov candidate function which is positive definite v η ν 1 2 η t η 1 2 ν t ν where v η ν 0 η a n d ν 0 for global asymptotic stability v 0 therefore choosing control input τ c in 18 such that v is negative definite we have 18 τ c n η ν m j d 1 η η d k 1 η j d η η d k 1 η m k 2 ν j t η η hence the thrust force vector can be calculated as shown in 19 19 f b n η ν b m j d 1 η η d k 1 η j d η η d k 1 η b m k 2 ν j t η η where b is the pseudo inverse of the thrust force matrix b golub and kahan 1964 v η ν η t k 1 η ν t k 2 ν 0 v η ν 0 t η ν since k 1 and k 2 are always positive definite in this case the controller guarantees an asymptotically stable system choosing appropriate values for gain constants k 1 and k 2 is essential for assurance of stability and improvement of the performance the values for k 1 and k 2 are found by trial and error basis considering the rms values of the error of the position and orientation 5 1 gain tuning an infinity shaped trajectory composed of two sine curves is chosen as a reference path for gain tuning using trial and error method the trajectory is a complex combination of the surge sway and heave with an amplitude of 2 m where the initial point of one sine curve is the ending point of the other as shown in fig 5 the robot is assumed to start at the origin of the earth fixed frame the rms values of error in position and orientation is calculated for every set of values of k 1 and k 2 and is plotted with k 1 k 2 erms values along x y z directions respectively the required values for k 1 and k 2 are chosen for the least rms value of the tracking error where the range of k 1 and k 2 are varied from 0 to 20 fig 6 illustrates the surface and contour plots of erms for various ranges of k 1 and k 2 as obtained finally out of all the values the set of k 1 and k 2 values that gave the most accurate results for a general case without failure as well as for both the fault accommodation case in the presence of failure are selected for all the simulation purposes k 1 0 9 and k 2 7 is chosen these simulations are run for the following three different conditions trajectory tracking of fully actuated case without failure of any thruster trajectory tracking with single thruster failure accommodated using the elimination of column method and weighted pseudo inverse method trajectory tracking for two thruster failure by considering the vehicle as under actuated initially the above optimized gain constants are applied to the backstepping control scheme of the vehicle to track an infinity shaped trajectory without considering any faults the simulation results are presented with respect to the simulation time t s plotted along the x axis in fig 7 10 fig 7 shows that the actual trajectory of the vehicle matches precisely with the reference trajectory in real time applications the initial pose error of the vehicle is an active concern in the control of an auv after switching on the controller as most of the robots are deployed from floating platforms like ships thus there is a good chance of initial pose error during deployment the pose error tracking error shown in fig 8 is significant during the beginning of the motion but the time for eliminating initial tracking error is observed to be approximately 3 seconds exploiting the proposed backstepping controller for a given complex trajectory whereas the errors during the subsequent motion are negligible considering the complexity of the path this observation proves that the above control scheme works well when the tracking errors are high initially the thrust forces acting on the vehicle are shown in fig 9 which is below 30n the rotary angles of all the thrusters are limited to a maximum of 90 as seen in fig 10 considering the possibility of cable damage due to continuous rotation thus exploiting the backstepping control scheme these errors settle down within 3 seconds for tracking a given complex trajectory with the generated thrust forces in the subsequent sections the implementation of fault tolerance by considering different methodologies is discussed the application of fault makes the model mathematically complicated from the control point of view thus mathematically suitable techniques are required for fault accommodation both the methods discussed in this manuscript are chosen from their ease of understanding and flexibility 5 2 elimination of column method in the initial stages of research given the non linearity of the auv model and rotating thrusters phenomenon it is required to understand the complex mathematics of the dynamic model and interpret it physically so that a scheme could be thought of to alter its dynamic behavior after the failure it is to be inferred from the rotatable thrusters auv model that failure of rotary action of one of the thrusters of rotatable four thruster model is analogically similar to the failure of two thrusters in a redundant 8 thruster model thus a loss of redundancy is inevitable and only a unique way or combination of thrusts is possible unlike when all the thrusters are functional there are infinite ways to achieve a given motion due to the redundancy recall the thruster dynamics matrix b from 11 in section 4 4 5 τ b f where f is an 8x1 column vector composed of vertical and horizontal components of the thrust of each thruster and τ is the torque vector 6x1 column vector representing forces and moments on the auv in the body fixed frame thus for a 6x1 torque vector we have an 8x1 thrust vector when all thrusters are functional which is a case of infinitely many solutions for a particular position and orientation due to the redundancy for a given trajectory and control input τ c at every instance the thrust force of each thruster is calculated from 19 as shown previously by employing the pseudo inverse of the thruster dynamics matrix conventionally an nx1 thrust vector is used for calculating the thrust of n thrusters in this present vehicle each thruster is analogous to two thrusters due to the rotating capability now assuming that one of the thrusters fail physically i e thruster b fails it will become non operational which means that the horizontal and vertical components f 2 and f 6 of the force from thruster b are zero this is the basis for the elimination of column method where the motion control equations are split into two parts horizontal and vertical mode the horizontal mode is concerned with the control of motion along surge sway and yaw and the vertical mode with movement along heave pitch and roll based on this idea our thruster dynamics matrix b is split into two parts viz horizontal and vertical thruster dynamics matrix note that the first second and sixth row of matrix b corresponds to the horizontal mode and the remaining corresponds to vertical mode thus two bifurcated matrices of sizes 3x4 from b are arrived as horizontal thrust dynamics matrix htdm vertical thrust dynamics matrix vtdm htdm 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 l a 2 2 l a 2 2 l a 2 2 l a 2 2 vtdm 1 1 1 1 a 2 a 2 a 2 a 2 l 2 l 2 l 2 l 2 conversely matrix b is arrived by concatenating htdm and vtdm in proper order in typical operation thruster matrix b maps torque vector to the thrust forces from thruster both expressed in the body fixed frame in case one of the thrusters fails the column corresponding to the horizontal and vertical part of that thruster from both these matrices is eliminated thus if thruster b fails the second column from htdm and vtdm are removed respectively which gives us two 3x3 square and invertible matrices hence a 6x1 torque column vector is calculated by dividing it into two 3x1 column vectors one of which controls the horizontal mode of operation and the other vertical mode of operation thus the structure of horizontal and vertical subsystem becomes htdme and vtdme 3x3 matrices after eliminating the required columns as seen in 20 and 21 horizontal subsystem 20 f 1 f 3 f 4 htdme 1 f x f y m z vertical subsystem 21 f 5 f 7 f 8 vtdme 1 f z m x m y where f 1 f 2 f 3 f 4 are the horizontal components of the thrust forces of thrusters 1 2 3 4 and f 5 f 6 f 7 f 8 are the vertical components of the thrust forces of thrusters 1 2 3 4 respectively f x f y f z m x m y m z are the forces and moments along surge sway heave roll pitch and yaw directions respectively since this model is entirely independent of thrust force of thruster b the redundancy is lost we have a unique solution and hence a unique combination of thrust forces that can generate the desired force vector in the inertial frame of reference the fault of a single thruster is simulated with simulation time as 70 seconds the vehicle follows the trajectory with minimal errors similar to that of without thruster failure case as shown in fig 11 and the tracking errors are shown in fig 12 from fig 12 it can be inferred that the errors settle down after 5 seconds compared to 3 seconds when there are no faults but it can also be observed that there is a small oscillation in the yaw tracking error during the time frame of 15 22 seconds which can be attributed to the high rate of yaw requirement during the initial turning motion required after the straight path in the trajectory but the order of the errors is similar to that observed in the no fault condition thus these oscillations do not affect the vehicle performance adversely the simulation results from fig 13 and fig 14 show that thrust generated and rotary angles of the thruster a fa are found to be oscillating between positive and negative values rapidly to follow the trajectory these oscillations are observed at the initial turning motion where a high rate of yaw requirement is visible it can also be found that only thruster a is affected with these oscillations whereas the remaining thrusters c and d have a smoother and continuous thrust force and tilt angle generation for the given profile also the maximum thrust generated by the thruster c and d increased to nearly 90 n at the start compared to a 30 n initial thrust when there is no fault in the system this oscillation behavior of thruster a and more thrust from thruster c and d can be attributed to the fact that the thruster a c and d has to take care of the absence of thruster b during failure where the thruster a is more loaded compared to the other thrusters thus the elimination of column method satisfies the requirement of vehicle following the required trajectory however there is a caveat in using this technique it is applicable as long as the mathematical model has at least one solution for the given set of equations i e it is physically logical and mathematically convenient to interpret and apply to the present vehicle model only until the loss of one thruster in case two thrusters fail in our model we effectively lose four inputs in the thrust force vector f and our mathematical model becomes a system of equations with no solution due to fewer inputs in the form of a thrust force vector compared to the required outputs in the form of torque vector to follow the 3d complex trajectory hence a new method called the weighted pseudo inverse method is implemented in the model to resolve this issue and to achieve our objective 5 3 weighted pseudo inverse method elimination of column method performed well in terms of following the reference trajectory by exploiting the backstepping control with the loss of a single thruster but it is limited to single thruster failure thus a new methodology called weighted pseudo inverse method is implemented in the present vehicle model most modern autonomous vehicles were found to apply this method for fault accommodation in auvs unlike the elimination method this methodology assigns a weight which is typically a numerical value ranging from 0 to 1 to the thrust components vertical and horizontal to all thrusters in the thruster dynamics matrix based on the failure in the present case a failed thruster is assigned weight 0 and a fully functional thruster is assigned weight 1 also with this approach it is possible to simulate the failure of more than one thruster the weighted pseudo inverse technique is implemented by assuming the failure of a single thruster in the simulation after assigning weights to thrusters as mentioned earlier a weight matrix w of size 8x8 is formed consider y as the inverse of w a diagonal matrix which contains entries in diagonal elements either as 0 or 1 depending upon failure such that its first four diagonal entries correspond to the weights of horizontal components and the last four diagonal entries to weights of vertical elements of the four rotatable thrusters y 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 if thruster a fails the weights to horizontal and vertical thrust force components are assigned to be zero i e the first and fifth entry of y matrix now using y w 1 the pseudo inverse of the thruster dynamics matrix b shown in 19 of section 4 4 5 changes to 22 thus to calculate the thrust force vector f from the τ c vector we use x b y n xx t 22 f x t n 1 τ c initially the failure of thruster a is chosen to occur at an intermediate point of the total simulation time based on the given trajectory the results of the fault accommodation are shown in fig 15 e to fig 15 h where the trajectory tracking motion is consistent and does not get affected by the single thruster failure based on these results it can be observed that even after the failure of thruster a the thrust demands for the trajectory tracking were accommodated by the remaining healthy thrusters in the case of the elimination method and the present method the failure of one of the thrusters did not affect the performance of the vehicle as six inputs are still active by the remaining three thrusters from the plots of tilt angles and thrust forces it can be concluded that even after the failure of thruster a the fault accommodation intertwined with the backstepping controller could take care of the possible uncertainty this performance also shows that three rotatable thrusters are sufficient to track the required complex trajectory comfortably but four thrusters provide symmetricity to present vehicle considering its rectangular shape and also the redundancy helps to reduce the thruster loads during complex operations and chances of vehicle failure during emergency dives till now we have discussed the failure of the thruster in generating the required thrust force in the next section we would consider the rotational failure of thrusters i e the thruster is stuck at a particular angle of rotation about the diagonal axis of the vehicle 5 3 1 rotational failure of thrusters a different approach towards the failure of the thruster is introduced at this stage conventionally a thruster is considered as failed if there is an undesired thrust output produced by that thruster with rotatable thrusters however another source of failure is possible i e rotatable action may stop working or rotation is random which can be attributed to the failure of an internal servo motor due to any unknown reasons due to this failure two cases are possible 1 rotation of the thrusters is random the actual angle of rotation may not obey the required rotation rate or rotation angle in this case the incorrect angle generates a variation in the commanded thrust forces even though the thrust action works well the thruster is considered as failed we have treated this also as a thruster failure and have modified the matrix y to accommodate the rotational failure of the thruster due to the internal servo motor the simulation results for this case would be the same as the results shown in fig 15 e 15 h 2 rotation of the thrusters stops working consider if the thruster s stops rotating though it generates the required thrust due to this the thrust force from that particular thruster constantly points at a single direction same as that it was pointing at the time of failure this thrust vector pointing in one direction is entirely undesirable this problem can be considered as two sub cases to accommodate for the correction required if necessary a if the thrust forces of remaining thrusters apart from the failed thruster stay within the threshold force limits then the vehicle could still track the given trajectory with considerably high tracking errors as shown in fig 15 a 15 d where the action of the controller itself automatically takes it to care as the remaining functional thrusters take care of the trajectory tracking problem fault accommodation was not incorporated in this case as it is resolvable within the system by the backstepping controller where all the thrusters continue to work including the ones whose tilt action has failed without the need of fault accommodation as in this case the tracking errors are substantial this approach is not suitable for tracking control problems b in case the thrust forces of remaining thrusters need to be generated exceed the threshold set by the user maximum limit of the thruster the previous case fails to track the given trajectory at this stage to resolve the loss of rotation of failed thruster a fault accommodation is employed by treating the excessive thrust requirement as a source of failure after implementing the fault accommodation with the weights of the failed thruster taken as zero the model senses the failure categorizes the fault and enables fault accommodation at this point for the failed thruster weighted pseudo inverse technique is implemented for this case after observing its flexibility of use and accuracy with the above two cases this case is simulated with an onset of fault in the system at an intermediate time t t 2 where t time of simulation by stopping the rotatable action of thruster a unlike the previous case where no fault was accommodated fig 15 c the thrust generated fig 15 g by the remaining healthy thrusters could accommodate the fault with minimum tracking errors as shown in fig 15 f which are comparable to the tracking errors without any faults fig 8 based on the plots shown in fig 15 e 15 h it can be concluded that there is a clear advantage of proposed fault accommodation methods compared to no fault accommodated case as shown in fig 15 a 15 d 5 3 2 multiple thruster failures it is clear from the vehicle model that the thrust vectors of the rotatable thruster model as shown in fig 4 with f 1 f 2 f 3 and f 4 are analogically similar to that of four horizontal thrusters and f 5 f 6 f 7 and f 8 are identical to that of four vertical thrusters in a redundant eight thruster system thus in the case of the rotating thruster model failure of a single thruster leads to loss of two force inputs thus losing effectively two degrees of freedom redundancy similarly if more than one thruster fails each thruster failure contributes to the loss of two degrees of freedom depending upon the extent of failure this case is implemented to understand the model characteristics by choosing the failure of thruster a and d thus fa 0 and fd 0 so f 1 f 5 f 4 f 8 0 plugging these values in 11 we get 23 23 f x f 2 f 3 2 f y f 2 f 3 2 f z f 6 f 7 m x f 6 f 7 a 2 m y f 6 f 7 l 2 m z f 2 f 3 l a 2 2 the above equations can be re written as below in 24 which shows the coupling between two different degrees of freedom in each equation 24 m z c 1 f y m y c 2 f z where c 1 and c 2 are constants represented by the vehicle dimensions l and a it can be seen that the motion in heave and sway axes and pitch and yaw axes are compromised due to the coupling between sway yaw and heave pitch respectively weighted pseudo inverse technique is used to confirm this hypothesis and a fault in thruster a and d is simulated the failure is programmed to occur at an intermediate time t 25 seconds in this case with rotation angles α a and α d and thrust forces fa and fd set to zero it is observed from fig 16 fig 17 fig 18 and fig 19 that the trajectory tracking is highly inaccurate after the failure of two thrusters and the position errors also shoot up this inaccuracy confirms that it is not possible to control the vehicle motion in 3d space with the failure of more than one thruster in our current scheme while simulating two thrusters failure it is noted that the matrix y becomes singular or non invertible thereby confirming that even though the weighted pseudo inverse technique allows us to contemplate the failure of more than one thruster unlike the column elimination method it is however mathematically inconsistent with the concept of this method thus the weighted pseudo inverse technique certainly had an advantage over the elimination of column technique as we can simulate two thruster failures with it however these techniques could not accommodate the complete failure of multiple thrusters due to a lesser number of control inputs maximum four than the controllable states six on the other hand it has also been observed that partial failure of the thrusters cannot be accommodated using the elimination method but the weighted pseudo inverse helps to accommodate partial failures hence a brief discussion on the scope of implementing weighted pseudo inverse method for the partial failure of multiple thrusters is presented at this point to show the advantage of the latter method compared to the former during the simulations the partial failure of the thruster is implemented by adjusting the weights of two thrusters to 0 4 in the weight matrix i e the thrust generated by these two thrusters is 60 lower as compared to the earlier cases in this case the failure is chosen to occur on the front thrusters a and b after 10 s from the start of trajectory tracking the results for the case of partial failure of two thrusters are shown in fig 20 a to fig 20 d it can be observed from the results in fig 20 a that the tracking of the vehicle in an infinity trajectory is sufficiently smooth as seen in fig 7 fig 20 c shows that the reduction in thrust from the front thrusters is accommodated by an increase in thrust values by the other two aft thrusters simultaneously as compared to the no fault case seen in fig 9 the slight increase in tracking errors are observed in fig 20 b as compared to no faults case in fig 8 this can be attributed to the thrust readjustment by the aft thrusters in other words the insufficient inputs from the faulty thrusters a and b are reallocated to the healthy thrusters c and d this proves that the proposed method works well even with the partial failure of multiple thrusters nevertheless in the case of complete failure of multiple thrusters our focus is to solve the motion control problem by resolving the trajectory problem into multiple mode planar cases for the stabilization problem they are horizontal and vertical modes and switch between each mode based on the mission requirements another strategy is to accommodate the two thrusters fault and yet track the path with a minimum possible error this is done by considering the vehicle as underactuated i e by implementing a line of sight approach with only four control inputs as two of the degrees of freedom are already coupled the same has been dealt with in the next section a flowchart is shown in fig 21 which describes the fault accommodation strategy implemented in this manuscript 5 4 line of sight approach for an under actuated case due to the failure of two thrusters the present vehicle is converted to an under actuated system where the total number of control inputs is fewer than the required dof to be controlled as the backstepping controller in a fully actuated case is successfully implemented now the same is extended to the trajectory tracking case of the under actuated system it is assumed that the roll is passively stabilized due to the inherent damping of the vehicle as the vehicle being discussed is flat about the roll axis thus based on the preliminary definitions defined in section 4 3 and 4 4 the model is effectively reduced to an under actuated system as discussed below in the present case the two front rotatable thrusters are assumed to be failed i e fa 0 and fb 0 thus the two aft rotatable thrusters are considered as the control inputs for the tracking problems we adopt the similar backstepping design used for the fully actuated case earlier as this suits the cascaded nature of dynamics of the vehicle 5 4 1 reduced equations of motion of the vehicle η r5 is the reduced vector representing the generalized coordinates in the earth fixed frame ν r5 denotes the reduced linear and angular velocity vectors in the body fixed frame η η 1 t η 2 t t η 1 x y z t η 2 θ ψ t ν ν 1 t ν 2 t t ν 1 u v w t ν 2 q r t the jacobian matrix j η is a 5x5 matrix that maps the body fixed velocity to the earth fixed velocities as shown below j η c ψ c θ s ψ c ψ s θ 0 0 s ψ c θ c ψ s ψ s θ 0 0 s θ 0 c θ 0 0 0 0 0 1 0 0 0 0 0 1 c θ the equations of motion of the vehicle shown in 1 and 2 in section 4 4 reduces to 5x5 matrices where m the mass matrix c ν the coriolis and centrifugal matrix includes both rigid body and added mass components as shown in 25 26 27 and 28 and d v the hydrodynamic damping matrix as shown in 29 the 5x1 τ vector represents the body fixed generalized forces and moments 25 m r b m 0 0 m z g m y g 0 m 0 0 m x g 0 0 m m x g 0 m z g 0 m x g i y y i y z m y g m x g 0 i z y i z z 26 m a x u 0 0 0 0 0 y v 0 0 0 0 0 z w 0 0 0 0 0 m q 0 0 0 0 0 n r 27 c rb ν 0 0 0 0 0 0 0 0 0 m q x g w m r z g m q z g u m r x g v m r y g u m q y g m q x g w m r x g v m r z g m r y g u m q z g u m q y g 0 r i x z q i x y r i x z q i x y 0 28 c a ν 0 0 0 z w w y v v 0 0 0 0 x u u 0 0 0 x u u 0 z w w 0 x u u 0 0 y v v x u u 0 0 0 29 d ν x u 0 0 0 0 0 y v 0 0 0 0 0 z w 0 0 0 0 0 m q 0 0 0 0 0 n r x u u u 0 0 0 0 0 y v v v 0 0 0 0 0 z w w w 0 0 0 0 0 m q q q 0 0 0 0 0 n r r r the 6x8 thruster dynamics matrix shown in 13 of section 4 4 5 also reduces to 5x4 matrix as indicated below in 30 due to the failure of the two forward thrusters 30 b 1 2 1 2 0 0 1 2 1 2 0 0 0 0 1 1 0 0 l 2 l 2 l a 2 2 l a 2 2 0 0 thus the vector f f 3 f 4 f 7 f 8 t consists of only four thrust force components corresponding to the resultant thrust forces fc and fd of the thrusters c and d respectively 5 4 2 simulation of the under actuated model the trajectory planning scheme of the under actuated vehicle caharija et al 2012 yu et al 2016 filoktimon and papadopoulos 2005 repoulias and papadopoulos 2007 zhou et al 2018 dong et al 2015 maps an inertial trajectory of the 3 d space to controllable state variables such as the body fixed velocities and the orientations the reference trajectory generated by the desired inertial position and the corresponding velocities is considered to be a feasible state space trajectory that is consistent with the vehicle dynamics it is assumed that the trajectory to be tracked is defined as a time function of inertial positions expressed by η 1 d and differentiable up to the third order with respect to time the error dynamics of the vehicle are obtained using the reference trajectory and to this end we can use the backstepping controller designed for the fully actuated case with reduced order dynamics to force the tracking error in the neighborhood of zero by using a same time varying control law chosen earlier the reference trajectory chosen is a circle of radius 2 m in 3d space with its centre at 0 2 2 and the starting point of the robot is 0 0 0 in the earth fixed frame the circular trajectory is chosen to show the vehicle tracking capabilities with different types of trajectories the controllable state variables such as pitch and yaw can be derived using reference trajectory in earth fixed frames as shown in 31 31 θ d a tan 2 z d x d ψ d a tan 2 y d x d the following assumptions are made for the under actuated vehicle model it is to be noted that the states such as the desired roll and its time rate of change cannot be controlled thus the roll dynamics of the vehicle are neglected it is also assumed that the vehicle s velocity and control input are bounded i e ν ν u and τ c τ u the desired tracking velocities ν d and their time derivatives ν d are bounded for any time t 0 the pitch angle of the under actuated auv is below 90 the design of a nonlinear controller for a fully actuated vehicle model using backstepping is shown in section 5 for tracking the desired trajectory within a reasonable error the stability of the nonlinear system is proven using the lyapunov stability criteria the primary idea here is to exploit the same control scheme and its designed parameters and utilize it for reduced order tracking problem by removing the dynamics of a state which cannot be controlled due to limitations of the under actuated system numerical simulations are carried out to verify and illustrate the performance of the vehicle with only two rotatable thrusters the results of the simulation are shown in fig 22 25 fig 22 shows the tracking of the vehicle in a circular trajectory which shows a small deviation in the beginning but later the vehicle tracks the trajectory sufficiently smooth this slight instability in the motion of the vehicle is due to the time taken to reach the required orientations of the vehicle the vehicle takes around 5 8 s to stabilize after which it has a smooth trajectory this proves that the proposed control scheme proves well for the vehicle with failure in two thrusters the position errors shown in fig 23 are in the same order as compared with no faults case by exploiting the proposed backstepping controller the position errors are found to be well within the practical limits it can be observed from fig 24 that the initial tracking errors require higher thrust forces during the start of the trajectory tracking the initial thrust force extracted by each thruster reach up to 25n and later settles down within a range of less than 6n which is well within the practical limits the rotary angles of all the thrusters are limited to a maximum of 90 as seen in fig 25 it can be observed that the validity of the proposed concept is proven for handling multiple thruster failure by considering the vehicle as an under actuated system thus it can be concluded that by taking advantage of the backstepping control scheme which deals with the convergence of tracking errors and compensating the parametric inaccuracies tracking in a 3d space is made possible 5 5 disturbance modeling ocean currents in this section numerical simulations are performed to understand the effect of external disturbances such as underwater oceanic currents on the performance of the controller designed the oceanic currents are modeled in 3 d cartesian space using a resultant average current velocity v c by defining two orientation angles namely angle of attack γ c and sideslip angle β c in the earth fixed frame of reference as shown in fig 26 it is assumed that the oceanic currents flow is irrotational and varies very slowly with time i e almost constant the details of the oceanic currents modeling is found in fossen 1994 and the relative velocity v r between the vehicle and current velocity is given below in 32 32 v r v v c here v c u c v c w c 0 0 0 t is the oceanic current velocity vector expressed in the body fixed frame of reference varying slowly with time thus we can write v r as in 33 33 v c 0 v r v in the 3 d cartesian space considering the orientation angles of the oceanic currents the velocity vector in the earth fixed frame of reference v c e u c e v c e w c e 0 0 0 t is expressed in terms of v c as seen in 34 34 u c e c o s γ c c o s β c v c v c e s i n β c v c w c e s i n γ c c o s β c v c the body fixed components of the oceanic current velocity are given by 35 35 u c v c w c j 1 t η 2 u c e v c e w c e where j 1 t η 2 cos ψ cos θ sin ψ cos θ cos ψ sin θ sin ϕ sin ψ sin ϕ cos ϕ cos ψ sin ϕ sin ψ cos θ cos ψ cos θ sin ψ sin θ sin ϕ cos ψ sin ϕ cos ϕ sin θ sin ϕ sin θ cos θ sin ϕ cos θ cos ϕ thus the modified equations of motion of the vehicle are given by 36 36 m v c v r v r d v r v r g η τ using the modified equations of motion presented in 36 and the control law given in 18 the performance of the controller is confirmed for its ability to control the adverse effects of oceanic currents effectively the variation of parameters γ c β c and v c are governed by first order gauss markov processes where zero mean random white noise processes and constants are used in the formulation of these equations the procedure adopted can be found in fossen 1994 a single thruster failure is accommodated using the weighted pseudo inverse method for numerical simulation under the effect of oceanic currents the trajectory tracking results are superimposed with oceanic currents vector as shown in fig 27 fig 28 fig 29 and fig 30 shows the variation of pose error thrust forces and thrusters rotation angle in the presence of oceanic currents the maximum values of errors obtained in the absence of underwater currents are comparable to the values obtained in the presence of currents this proves that the proposed methods are capable of generating trajectory with the desired level of performance even in the presence of oceanic currents thus this study shows that the control scheme along with the fault tolerance methods gives desirable results in the presence of external disturbances it is also observed that the direct information of oceanic currents is not required in the controller as the control scheme considers the oceanic currents without the need for their measurements since the effects of the currents are directly replicated as the deviations in the position and orientations during the vehicle motion which can be acquired from the measurements of the navigation sensors thus the proposed method of fault accommodation performs well in the presence of ocean currents and the same methodology can be extended to the under actuated case of vehicle 6 summary and conclusion the proposed underwater robot model is nonlinear due to the presence of four rotatable thrusters the robot s dynamic model developed is based on the hydrodynamics of the eight input neutrally buoyant vehicle the control law is derived based on the backstepping control scheme and the system s stability is ensured by using the lyapunov stability theory the controller gain constants for a 3d complex trajectory have been tuned using rms values of tracking error where the simulation results proved useful in stabilizing the auv and attaining the tracking error to the neighborhood of zero by exploiting the backstepping control later the model is accommodated with the absolute or complete failure of a single thruster by using two different methods 1 elimination of column method and 2 weighted pseudo inverse method both techniques were implemented successfully for a single thruster failure however the former method had a mathematical inconsistency when applied for more than one thruster failure here the next method emerged as a potential solution for more than one thruster failure during the operation however the vehicle model could not track the required 3d trajectory due to the loss of additional inputs than that of the needed degrees of freedom but it was noted that the weighted pseudo inverse technique allows us to contemplate the failure of more than one thruster unlike the column elimination method the inaccuracy in tracking the path shows that absolute complete failure of multiple thrusters is out of scope for the rotatable thruster robot model for the case of trajectory tracking by using the elimination of column method and weighted pseudo inverse method however a brief discussion on the partial failure of multiple thrusters implementing weighted pseudo inverse method was given to showcase the advantage of the latter method compared to the former finally an attempt to solve the motion control problem of multiple thruster failures is made by accommodating two faulty thrusters and the underwater vehicle is considered as underactuated i e by implementing a line of sight approach with four control inputs and yet track the path with minimum possible error as two of the degrees of freedom are already coupled similarly the validity of the proposed fault accommodation model has been tested further by the inclusion of oceanic currents and its corresponding effect on vehicle motion by simulating a single faulty thruster using the weighted pseudo inverse method in both cases the performance of the vehicle is found to be satisfactory based on the different approach methodologies implemented in this study there is a requirement to quantify the amount of variation in the performance of the vehicle characteristics under the fault based on the extent of the damage one of such quantifiers is maneuverability study maneuverability is defined as the inverse of the power consumption of all the thrusters mounted on the vehicle normalized to the cube third power of the velocity pugi et al 2018 thus these studies on maneuverability will also be undertaken as a part of the future scope by implementing the fault in the vehicle and understand the maneuverability characteristics which would benefit in choosing the required fault accommodation technique apriori to the implementation in the actual prototype vehicle for improved robustness author contribution jagadeesh kadiyam conceptualization methodology software investigation writing original draft preparation writing review editing visualization anjali parashar software investigation writing original draft preparation writing review editing visualization santhakumar mohan conceptualization methodology software writing review editing supervision project administration funding acquisition devendra deshmukh writing review editing project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is partially funded by the department of higher education dhd india 1 36 2016 pn ii and by the international collaboration research program through the national research foundation of korea nrf funded by the ministry of science and ict nrf 2017k1a3a1a19071037 and the department of science and technology dst ministry of science and technology india int korea p 43 
22168,opening holes especially circular hole in artificial reef block is a conventional choice in design of artificial reef however there is less scientific study about how to select the hole diameter in this article the performance of the rotary shaped artificial reefs with different size of circle holes was investigated using cfd method and the orthogonal experiment design the reef having the best performance was identified the results indicate that the design of interlaced hole diameter can significantly promote the flow field scope especially the height of upwelling in comparison with that with the uniform hole diameter there is no obvious relationship between the cut opening ratio and flow field effect for the rotary shaped reef this work supplies a scientific evidence for how to select the hole diameter for an artificial reef keywords artificial reef numerical simulation reef design flow field cut opening ratio 1 introduction artificial reef is a marine engineering structure for improvement and restoration of ecological environment in natural water which is defined by its physical material and its function such as habitat protection genzano et al 2011 farinas franco et al 2013 farinas franco and roberts 2014 walles et al 2016 proliferation of marine animals perkol finkel et al 2006 gallaway et al 2009 dance et al 2011 and submarine tourism edney and spennemann 2015 schuett et al 2016 belhassen et al 2017 tynyakov et al 2017 the most prominent function of artificial reefs is to enhance stock under two expectations first the attraction of reef structure to mobile organisms is anticipated by interests seeking to increase catch or its efficiency almost immediately after artificial reef deployment second there is an expectation that artificial reef will ecologically resemble local natural environments over the long term as assemblages including sessile organisms associate with its surface structure and surrounding water column and eventually increase biomass at the site seaman 2000 the research on reef structure and environment falcão et al 2009 fujii t 2015 gatts et al 2015 ecology bilkovic and mitchell 2013 zalmon et al 2014 yu et al 2015 and hydrodynamics effects srisuwan and rattanamanee 2015 jiang et al 2016 have been carried out extensively which help us evaluate and forecast the effect of artificial reef after its deposition through these studies it can be found that there is a link between the reef and its ecological effect the change of flow field caused by the structure of artificial reef can promote the exchange and mixing of water between different layers which will affect the attachment of biomass and aggregation of fish these researches indicate that the structure of artificial reef has a significant influence on its stock enhancement function nowadays there are thousands of kinds of artificial reefs with different shapes or structures that have been deposited around the world such as cube reefs liu et al 2012 jiang et al 2013 hemisphere reefs sherman et al 2002 gatts et al 2015 star reefs liu et al 2013 and derelict vessels morgan et al 2009 kirkbride smith et al 2013 the different shapes of these reefs were usually considered to share some common features for example larger surface area can supply enough chance for sea alga to attach which promotes the formation of seaweed bed complicated structure can contribute to the formation of turbulent flow which have a distinct effect on its performance of fish aggregation jiang et al 2016 liu and su 2013 in general opening holes in artificial reef block is a conventional choice in design of artificial reef which produces multivariate flow field and supplies a convenient way for fish to assemble sherman et al 2002 falcão et al 2009 jiang et al 2014 liu and su 2013 gatts et al 2015 even the divers are convenient to pass through to visit or study the biology community around the reefs sherman et al 2002 srisuwan and rattanamanee 2015 the shapes of the hole on artificial reef are usually circular falcão et al 2009 jiang et al 2014 square liu and su 2013 kim et al 2016 or polygonous kim et al 2014 ponti et al 2015 and lots of new structures were evolved and applied into practice but it is found that the shapes of hole have less effect on the maximum upwelling velocity and the volume weighted average velocity wang et al 2018 moreover it is known that the area of circle is the largest among other forms under the condition of the same perimeter and it has been noted that the diameter of the hole is closely related to fish aggregation and current vortices perkol finkel et al 2006 gallaway et al 2009 dance et al 2011 genzano et al 2011 farinas franco et al 2013 liu and su 2013 farinas franco and roberts 2014 so it may be the reasons why the circle hole has been widely adopted in reefs however there are few specific researches that support this point and even the practitioners still do not know how to determine the hole diameters of artificial reefs like other reef structures the rotary shaped reef is also widely deposited along the coastline of china the reef is composed of eight pieces of rectangular blades forming a rotary shaped structure which is characterized by many holes fig 1 it is known that the difference in reef structure will affect the interaction between the reef and current lindquist and pietrafesa 1989 jiang et al 2013 kim et al 2014 therefore it is obvious that the diameter of these holes does influence the hydrodynamic performance of the rotary shaped reef even for the same reef the change in local structure will also cause the distinct diversity of flow field jiang et al 2016 so should a smaller or bigger diameter for all the holes be chosen or an interlaced combination there seems to be no effective way to solve the problem in the previous researches therefore if we want to find out the influence mechanism of the circular hole on the flow field scope of artificial reef the rotary shaped reef should be a good research object the orthogonal design method helps improve the structural optimization of artificial reef because it can identify an optimal combination which produces the largest scope of flow field jiang et al 2016 however if the orthogonal experiments are conducted in the flume tank it will definitely require a large amount of work computational fluid dynamics cfd method has been effectively applied in many engineering field such as airplane submarine automobiles etc it has been also validated in simulation of the hydrodynamics of artificial reefs jiang et al 2016 liu et al 2013 liu and su 2013 in this article the hydrodynamics of the rotary shaped reefs with sixteen holes was investigated using cfd and the effect of hole diameter on flow field scope was analyzed based on the orthogonal design method it should be noted that this study mainly focuses on hydrodynamic effect of hole diameters of a rotary shaped reef on flow field and other significant engineering issues such as stability settlement sliding and overturning of the artificial reef were not considered for the optimization this work will provide a scientific basis for the structure design of artificial reef 2 material and methods 2 1 target artificial reef the main body of the rotary shaped reef consists of eight rectangular blades and a bottom plate which forms a semi open structure fig 1 the blades are 2 8 m in height 1 4 m in width and 0 2 m in thickness two circle holes with equal diameter are evenly distributed in each blade four square holes with 1 2 m in length are symmetrically distributed in the bottom plate so that the reef can sink steadily 2 2 theoretical background and method the orthogonality is important in experiment design because it can say something about independence experimental analysis of an orthogonal design is usually straightforward because each main effect and interaction independently can be estimated and the core of orthogonal design is an orthogonal array composed of various factors and levels the critical advantage of orthogonal design relative to typical controlled trials is that it allows the researcher to test the effectiveness of many interventions simultaneously in a single experiment and possibly identify some of their interactions with far fewer experimental units than it would take to exhaust all possible intervention combinations this feature makes it particularly valuable for testing the best way to implement complex interventions with many facets this design yields useful results even if the difference between the two variants of any intervention is not statistically significant zurovac and brown 2012 it is obvious that there are many combinations of hole diameter for the rotary shaped reef which can produce different disturbance effect on inflow eight factors were selected for orthogonal design in this article and each factor has four levels so an l 32 49 orthogonal table was built for the numerical simulations shown in table 1 all reefs have the different size of holes except no 1 reef the design of different hole diameters is called interlaced hole diameters in this article in addition cut opening ratio or was introduced in this article which were used to analyze the effect of hole diameter on the flow field or was defined as the ratio of the projected area of the hole to the whole projected area of the reef surface in the direction perpendicular to the flow which was thought to have a significant impact on the flow field wang et al 2018 in general the reefs with symmetrical structure such as the cubic reef have the same area on each surface and the same or wang et al 2018 but the rotary shaped reef is very different from the cubic reef in structure and the area of blade a and b 1 4 2 8 3 92 m2 is smaller than that of blade c and d 1 6 2 8 4 48 m2 if the same or is set for each blade it means that the hole diameter on blade a and b is different from that on blade c and d if the same hole diameter is set for each blade or on blade a and b will be different from that on blade c and d the purpose of this article is to explore the principle for selecting the hole diameter on each blade and the holes on each blade were set as different diameters according to the orthogonal design so the or in this article is defined as the sum of all blades to represent the hole opening state of the reef body table ss1 and 3 there is no common way to describe the flow field scope of artificial reef the height of upwelling h up and the width of wake region in the central plane in the y direction w y have been typically adopted to describe and compare the flow field scope of artificial reefs jiang et al 2013 2016 kim et al 2014 2016 the position where the flow velocity is over 1 05 times that of the inflow is defined as the scope of h up in the vertical direction of z 0 m and w y in the horizontal direction of y 1 5 m the two indexes were used to analyze the effect of different holes on the flow field scope in this study numerical simulations was conducted for all the reefs in table 1 and the h up and w y were calculated for each reef there is no model whose hole diameter is 0 4 m in table 1 but the design of a reef with a larger hole diameter is often a routine choice in the actual production therefore in order to test the effect of hole diameter acted on flow field scope a rotary shaped reef with uniform hole diameter of 0 4 m has been established which is defined as the control group the numerical results of this model were adopted to analyze the effect of interlaced hole diameter on flow field scope and to find a rotary shaped reef with the optimal combination of hole diameter the upwelling flux q were investigated for each rotary shaped reefs including the optimal reef and the control group to further analyze the effect of interlaced hole diameters on flow field the q is calculated by eq 1 1 q s up v where s up is the area of upwelling region v is the velocity in y direction six transverse planes along the y axis y 3 4 5 6 7 and 8 m were selected to describe and analyze the variation of q above the rotary shaped reef in these transverse planes if the velocity v increases by more than 5 relative to the inflow velocity v 0 025 m s the areas can be considered to be influenced by upwelling 2 3 numerical simulation the flow was assumed to be incompressible in this work the continuity equation and the reynolds averaged navier stokes equations in cartesian coordinates are show as follows 2 u i x i 0 3 u i t u j u i x j p x i x j μ u i x j u i u j where p is averaged pressure u i is the averaged velocity component for x y z μ is the viscosity u i u j is the reynolds stress and i j 1 2 3 x y z ansys fluent software ansys inc 2016 was adopted to simulate flow field of artificial reef which utilizes the finite volume method to solve the governing equations the rng k ε turbulence model is adapted to solve the turbulence closure which can enable the effects of swirl or rotation to be studied by modifying the turbulent viscosity appropriately pope 2000 gambit was used to construct the models and a computational domain with 64 m 24 m 48 m another cuboid domain with 30 m 12 m 24 m was added between the reef and computational domain to encrypt the local grids around the reef which is useful in improving the computational accuracy and reducing the computational load the reef model was set at 19 5 m downstream of the inflow entrance whose bottom center was designed as the coordination origin fig 2 more than 3 million unstructured grids were generated for each numerical case in the computational domain the front side was assigned as velocity inlet and its initial velocity was specified to be 0 5 m s as a uniform value which is a common flow velocity in shandong province of china the back side was assigned as the fluid outlet where pressure was uniform and all variables had a gradient of zero the bottom side and the surfaces of reef model were assumed to be smooth wall the other sides were assigned as the symmetric boundaries the quadratic upwind interpolation quick approximation was selected for spatial discretization the equations were iterated to the steady state by means of simplec for the velocity pressure correction convergence was assumed as the residuals fell below 10 5 2 4 statistical method analysis of variance anova is a collection of statistical models and their associated procedures such as variation among and between groups used to analyze the differences among group means in the analysis of variance setting the observed variance in a particular variable is partitioned into components attributable to different sources of variation and provides a statistical test of whether or not the means of several groups are equal analysis of variance is useful for comparing testing three or more means groups or variables for statistical significance which is suited to a wide range of practical problems spss statistics is the world s leading statistical software used to solve research problems by means of ad hoc analysis hypothesis testing geospatial analysis and predictive analytics researchers use spss statistics to understand data analyze trends forecast and plan to validate assumptions and drive accurate conclusions in this article spss for window 20 0 statistical packages were used to analyze the data on flow field scope with single variable and multi factor analysis of variance followed by the bonferroni test for multiple comparisons the p value reflects the probability of an event occurring if the p value is less than 0 05 the effect of hole diameter on flow field scope is considered to be significant the factor levels with significant difference p 0 05 are analyzed according to bonferroni test for multiple comparisons while the best influential levels of other factors without significant influence p 0 05 were analyzed by statistical means 3 results and discussion 3 1 optimization of structure the values of h up and w y are shown in table 2 the no 16 reef model produces the maximum h up 7 957 m among the thirty two models the h up of other models ranges from 7 238 to 7 914 m the no 26 reef model has the largest w y 7 169 m the w y of other models ranges from 6 504 to 7 168 m both h up 6 971 m and w y 6 237 m of control group are respectively lower than those of the 32 models therefore these results obviously reflect that the design of an interlaced hole diameter has a positive function at disturbing flow field of the rotary shaped reef anova indicates that the factors of a1 b1 c2 d1 and d2 have very significant influence on h up p 0 000 0 01 a1 b1 c1 c2 d1 and d2 have very significant influence on w y p 0 001 0 01 and a2 also has a significant influence on w y p 0 016 0 05 in order to test the factors and levels with significant influence on the flow field effect of the rotary shaped reef two new reef models named as no 33 and no 34 were designed according to the statistical results table 3 they were set with the most significant factors and levels on h up and w y whose details are shown in table 3 the flow field effects of the two reefs were analyzed under the same conditions and their h up and w y were obtained in table 3 the results reflect that the flow field scopes of the no 33 and no 34 rotary shaped reefs are greatly improved compared with the control group the h up 8 185 m and w y 7 295 m of no 33 model are obviously higher than the thirty two models in orthogonal experiment the w y of no 34 is slightly below the no 26 model but its h up exceeds the no 16 model it is obvious that the design of interlaced hole diameters has significantly improved the flow field scope of the rotary shaped reef 3 2 effect of interlaced hole diameter on hydrodynamic performance 3 2 1 upwelling flux the concept of upwelling flux q was introduced in this article to further analyze the effect of interlaced hole diameters on the flow field scope of the rotary shaped reef as shown in fig 3 a the q of the no 33 reef is greater than that of the control group it is also higher than that of the no 34 reef on all transverse planes except the plane at y 3 m h up of the no 33 reef exceeds 8 m 3 2 2 flow field the reef model with uniform hole diameters on each blade such as the no 1 reef model r 0 1 m produces the moderate flow field scope among the 32 reef models while the control group with the same hole diameters of 0 4 m causes the smallest scope it seems that the uniform hole diameter is not a good choice in design of the reef fig 4 shows that the blades a1 c1 and a2 are the main barriers to the inflow which force the inflow upward and boost the upwelling in addition the inflow must pass through the holes in blade c1 before it arrives at blade a2 thus smaller holes in blade c1 play a role in accelerating inflow to blade a2 this may be one of the reasons why the upwelling caused by the no 33 reef was the highest while the largest hole diameter in the control group greatly facilitate the passage of current and produced the lowest upwelling therefore interlaced hole diameter has a significant effect on the interweaving and promoting inflow which further expands the scope of flow field of the semi open structure of the rotary shaped reef when people design a new artificial reef they prefer to open holes in the block of a reef because a block with higher porosity is usually believed to be able to slow down the inflow velocity behind the reefs and form an extensive wake region effectively however it is a challenge to optimize the performance of the reef by changing the combination of the hole size eight factors were set in the orthogonal experiment to test the effect of hole diameter for the rotary shape reef with two holes in each blade it is difficult to analyze the interaction between factors the diagram of velocity vector distribution helps us to identify the combination of the hole diameter that can enhance the flow field effect such as h up in order to show the flow field effect of unit artificial reef the conception of h upa and w ya were adopted liu et al 2012 which are calculated by eqs 4 and 5 4 h upa h up h 5 w ya w y h where h is the height of the reef the rotary shaped reef as a semi open structure is generally considered to have no prominent flow field effect but in fact the flow field scope of rotary shaped reef is much wide than the frame reef table 4 it indicates that the rotary shaped reef also has superior flow field performance 3 2 3 drag coefficient the rotary shaped reef is a semi open structure which is different from the conventional shapes such as cubes and hemispheres a numerical analysis of the drag coefficient c x was performed with the reynolds number r e ranging from 0 3 106 to 3 6 106 fig 5 shows that c x varies little with the mean of 1 313 when the r e ranges from 0 6 106 to 3 0 106 it indicates that the self modeling region of the rotary shaped reef is in this range in addition the drag coefficient reach 1 531 when r e is less than 0 6 106 it seems that laminar flow has begun to transform to turbulent regimes in this range when r e is greater than 3 3 106 the c x drops to 1 234 it means that the trail width of flow field stars to decrease 3 3 effect of cut opening ratio on hydrodynamic performance as shown in tables 1 and 3 or of the rotary shaped reefs in this article ranges from 0 12 to 1 92 the highest or is 1 92 for the control group but h up and w y are the lowest the no 4 reef has the second largest or 1 68 whose flow field is significantly better than that of the control group and is at medium level among all the reefs the no 1 reef has the smallest or 0 12 whose h up is also at medium level but its w y is at lower level among all the reefs the h up and w y of no 33 reef are the largest but its or is 0 57 therefore there is no obvious relationship between or and flow field effect for the rotary shaped reef wang et al 2018 found that a reasonable arrangement of or can enhance the field of upwelling of the cubic reef however the rotary shaped reef is a semi open structure with irregular multiple inflow surface and the area of the inner and outer blades is different the irregularity of reef structure will be increased if or of each blade is taken as the influencing factor which will be unrealistic for construction in practice so the hole diameter was selected as the influencing factor which is conducive to unified structural parameters of reef models and the purpose of this article is to provide a scientific basis for the selection of hole diameter therefore these results further prove that the structure has a significant effect on flow field effect of artificial reef sherman et al 2002 falcão et al 2009 jiang et al 2016 liu and su 2013 gatts et al 2015 in addition the results show that the reefs with the same or have basically the same flow field such as the no 19 and no 21 the no 7 and no 22 the no 25 and no 8 the no 12 and no 15 but the flow field of no 16 is better than the no 30 this may be related to the location and diameter of hole the levels of most factors of no 16 reef are the same as those of the no 33 reef such as b1 c1 c2 d1 and d2 the results of orthogonal experimental design show that the factors of b1 c2 d1 and d2 have very significant influence on the h up therefore it is these factors that make the flow field effect of no 16 reef prominent among the 32 reefs in table 1 4 conclusion the structure of artificial reef has a significant influence on its flow field effect which will also affect its ecological function such as the aggregation of fish the attachment of algae etc and opening holes in reef block is a very common structure design for artificial reef but there has been a lack of scientific basis for choosing the hole diameter in this article the flow field scopes of rotary shaped reef with different hole sizes in eight blades were investigated using cfd method the effects of hole diameter on flow field scope and the most appropriate combination of the hole diameter were identified using the orthogonal experimental design the result indicate that the structure design of interlaced hole diameter can significantly promote the flow field scope especially the h up and the h up of the no 33 reef is 1 17 times as large as the control group cut opening ratio or was introduced to analyze the effect of hole diameter on the flow field but there is no obvious relationship between or and flow field effect for the rotary shaped reef the control group with the largest hole diameter and or has the smallest flow field scope among the eight factors a1 b1 c2 d1 and d2 have very significant influence on h up p 0 000 0 01 a1 b1 c1 c2 d1 and d2 have very significant influence on w y p 0 001 0 01 and a2 has a significant influence on w y p 0 016 0 05 the reef structure of interlaced hole diameter fundamentally changes the velocity and direction of the flow passing through the reef and play a decisive role in enhancing the flow field scope for the rotary shaped reef the design of interlaced hole diameter is more conducive to the acceleration of flow which can force the current to lash against the blades and boost the formation of upwelling it suggested a smaller hole diameter on the surfaces perpendicular to the inflow and a larger hole diameter on the planes parallel to the inflow acknowledgment this research was supported by the national natural science foundation of china 41771544 and 31272703 and major research project of shandong province 2016gsf115029 and 2017ghy15110 the numerical calculations in this article were performed on the supercomputing system in the supercomputing center shandong university weihai 
22168,opening holes especially circular hole in artificial reef block is a conventional choice in design of artificial reef however there is less scientific study about how to select the hole diameter in this article the performance of the rotary shaped artificial reefs with different size of circle holes was investigated using cfd method and the orthogonal experiment design the reef having the best performance was identified the results indicate that the design of interlaced hole diameter can significantly promote the flow field scope especially the height of upwelling in comparison with that with the uniform hole diameter there is no obvious relationship between the cut opening ratio and flow field effect for the rotary shaped reef this work supplies a scientific evidence for how to select the hole diameter for an artificial reef keywords artificial reef numerical simulation reef design flow field cut opening ratio 1 introduction artificial reef is a marine engineering structure for improvement and restoration of ecological environment in natural water which is defined by its physical material and its function such as habitat protection genzano et al 2011 farinas franco et al 2013 farinas franco and roberts 2014 walles et al 2016 proliferation of marine animals perkol finkel et al 2006 gallaway et al 2009 dance et al 2011 and submarine tourism edney and spennemann 2015 schuett et al 2016 belhassen et al 2017 tynyakov et al 2017 the most prominent function of artificial reefs is to enhance stock under two expectations first the attraction of reef structure to mobile organisms is anticipated by interests seeking to increase catch or its efficiency almost immediately after artificial reef deployment second there is an expectation that artificial reef will ecologically resemble local natural environments over the long term as assemblages including sessile organisms associate with its surface structure and surrounding water column and eventually increase biomass at the site seaman 2000 the research on reef structure and environment falcão et al 2009 fujii t 2015 gatts et al 2015 ecology bilkovic and mitchell 2013 zalmon et al 2014 yu et al 2015 and hydrodynamics effects srisuwan and rattanamanee 2015 jiang et al 2016 have been carried out extensively which help us evaluate and forecast the effect of artificial reef after its deposition through these studies it can be found that there is a link between the reef and its ecological effect the change of flow field caused by the structure of artificial reef can promote the exchange and mixing of water between different layers which will affect the attachment of biomass and aggregation of fish these researches indicate that the structure of artificial reef has a significant influence on its stock enhancement function nowadays there are thousands of kinds of artificial reefs with different shapes or structures that have been deposited around the world such as cube reefs liu et al 2012 jiang et al 2013 hemisphere reefs sherman et al 2002 gatts et al 2015 star reefs liu et al 2013 and derelict vessels morgan et al 2009 kirkbride smith et al 2013 the different shapes of these reefs were usually considered to share some common features for example larger surface area can supply enough chance for sea alga to attach which promotes the formation of seaweed bed complicated structure can contribute to the formation of turbulent flow which have a distinct effect on its performance of fish aggregation jiang et al 2016 liu and su 2013 in general opening holes in artificial reef block is a conventional choice in design of artificial reef which produces multivariate flow field and supplies a convenient way for fish to assemble sherman et al 2002 falcão et al 2009 jiang et al 2014 liu and su 2013 gatts et al 2015 even the divers are convenient to pass through to visit or study the biology community around the reefs sherman et al 2002 srisuwan and rattanamanee 2015 the shapes of the hole on artificial reef are usually circular falcão et al 2009 jiang et al 2014 square liu and su 2013 kim et al 2016 or polygonous kim et al 2014 ponti et al 2015 and lots of new structures were evolved and applied into practice but it is found that the shapes of hole have less effect on the maximum upwelling velocity and the volume weighted average velocity wang et al 2018 moreover it is known that the area of circle is the largest among other forms under the condition of the same perimeter and it has been noted that the diameter of the hole is closely related to fish aggregation and current vortices perkol finkel et al 2006 gallaway et al 2009 dance et al 2011 genzano et al 2011 farinas franco et al 2013 liu and su 2013 farinas franco and roberts 2014 so it may be the reasons why the circle hole has been widely adopted in reefs however there are few specific researches that support this point and even the practitioners still do not know how to determine the hole diameters of artificial reefs like other reef structures the rotary shaped reef is also widely deposited along the coastline of china the reef is composed of eight pieces of rectangular blades forming a rotary shaped structure which is characterized by many holes fig 1 it is known that the difference in reef structure will affect the interaction between the reef and current lindquist and pietrafesa 1989 jiang et al 2013 kim et al 2014 therefore it is obvious that the diameter of these holes does influence the hydrodynamic performance of the rotary shaped reef even for the same reef the change in local structure will also cause the distinct diversity of flow field jiang et al 2016 so should a smaller or bigger diameter for all the holes be chosen or an interlaced combination there seems to be no effective way to solve the problem in the previous researches therefore if we want to find out the influence mechanism of the circular hole on the flow field scope of artificial reef the rotary shaped reef should be a good research object the orthogonal design method helps improve the structural optimization of artificial reef because it can identify an optimal combination which produces the largest scope of flow field jiang et al 2016 however if the orthogonal experiments are conducted in the flume tank it will definitely require a large amount of work computational fluid dynamics cfd method has been effectively applied in many engineering field such as airplane submarine automobiles etc it has been also validated in simulation of the hydrodynamics of artificial reefs jiang et al 2016 liu et al 2013 liu and su 2013 in this article the hydrodynamics of the rotary shaped reefs with sixteen holes was investigated using cfd and the effect of hole diameter on flow field scope was analyzed based on the orthogonal design method it should be noted that this study mainly focuses on hydrodynamic effect of hole diameters of a rotary shaped reef on flow field and other significant engineering issues such as stability settlement sliding and overturning of the artificial reef were not considered for the optimization this work will provide a scientific basis for the structure design of artificial reef 2 material and methods 2 1 target artificial reef the main body of the rotary shaped reef consists of eight rectangular blades and a bottom plate which forms a semi open structure fig 1 the blades are 2 8 m in height 1 4 m in width and 0 2 m in thickness two circle holes with equal diameter are evenly distributed in each blade four square holes with 1 2 m in length are symmetrically distributed in the bottom plate so that the reef can sink steadily 2 2 theoretical background and method the orthogonality is important in experiment design because it can say something about independence experimental analysis of an orthogonal design is usually straightforward because each main effect and interaction independently can be estimated and the core of orthogonal design is an orthogonal array composed of various factors and levels the critical advantage of orthogonal design relative to typical controlled trials is that it allows the researcher to test the effectiveness of many interventions simultaneously in a single experiment and possibly identify some of their interactions with far fewer experimental units than it would take to exhaust all possible intervention combinations this feature makes it particularly valuable for testing the best way to implement complex interventions with many facets this design yields useful results even if the difference between the two variants of any intervention is not statistically significant zurovac and brown 2012 it is obvious that there are many combinations of hole diameter for the rotary shaped reef which can produce different disturbance effect on inflow eight factors were selected for orthogonal design in this article and each factor has four levels so an l 32 49 orthogonal table was built for the numerical simulations shown in table 1 all reefs have the different size of holes except no 1 reef the design of different hole diameters is called interlaced hole diameters in this article in addition cut opening ratio or was introduced in this article which were used to analyze the effect of hole diameter on the flow field or was defined as the ratio of the projected area of the hole to the whole projected area of the reef surface in the direction perpendicular to the flow which was thought to have a significant impact on the flow field wang et al 2018 in general the reefs with symmetrical structure such as the cubic reef have the same area on each surface and the same or wang et al 2018 but the rotary shaped reef is very different from the cubic reef in structure and the area of blade a and b 1 4 2 8 3 92 m2 is smaller than that of blade c and d 1 6 2 8 4 48 m2 if the same or is set for each blade it means that the hole diameter on blade a and b is different from that on blade c and d if the same hole diameter is set for each blade or on blade a and b will be different from that on blade c and d the purpose of this article is to explore the principle for selecting the hole diameter on each blade and the holes on each blade were set as different diameters according to the orthogonal design so the or in this article is defined as the sum of all blades to represent the hole opening state of the reef body table ss1 and 3 there is no common way to describe the flow field scope of artificial reef the height of upwelling h up and the width of wake region in the central plane in the y direction w y have been typically adopted to describe and compare the flow field scope of artificial reefs jiang et al 2013 2016 kim et al 2014 2016 the position where the flow velocity is over 1 05 times that of the inflow is defined as the scope of h up in the vertical direction of z 0 m and w y in the horizontal direction of y 1 5 m the two indexes were used to analyze the effect of different holes on the flow field scope in this study numerical simulations was conducted for all the reefs in table 1 and the h up and w y were calculated for each reef there is no model whose hole diameter is 0 4 m in table 1 but the design of a reef with a larger hole diameter is often a routine choice in the actual production therefore in order to test the effect of hole diameter acted on flow field scope a rotary shaped reef with uniform hole diameter of 0 4 m has been established which is defined as the control group the numerical results of this model were adopted to analyze the effect of interlaced hole diameter on flow field scope and to find a rotary shaped reef with the optimal combination of hole diameter the upwelling flux q were investigated for each rotary shaped reefs including the optimal reef and the control group to further analyze the effect of interlaced hole diameters on flow field the q is calculated by eq 1 1 q s up v where s up is the area of upwelling region v is the velocity in y direction six transverse planes along the y axis y 3 4 5 6 7 and 8 m were selected to describe and analyze the variation of q above the rotary shaped reef in these transverse planes if the velocity v increases by more than 5 relative to the inflow velocity v 0 025 m s the areas can be considered to be influenced by upwelling 2 3 numerical simulation the flow was assumed to be incompressible in this work the continuity equation and the reynolds averaged navier stokes equations in cartesian coordinates are show as follows 2 u i x i 0 3 u i t u j u i x j p x i x j μ u i x j u i u j where p is averaged pressure u i is the averaged velocity component for x y z μ is the viscosity u i u j is the reynolds stress and i j 1 2 3 x y z ansys fluent software ansys inc 2016 was adopted to simulate flow field of artificial reef which utilizes the finite volume method to solve the governing equations the rng k ε turbulence model is adapted to solve the turbulence closure which can enable the effects of swirl or rotation to be studied by modifying the turbulent viscosity appropriately pope 2000 gambit was used to construct the models and a computational domain with 64 m 24 m 48 m another cuboid domain with 30 m 12 m 24 m was added between the reef and computational domain to encrypt the local grids around the reef which is useful in improving the computational accuracy and reducing the computational load the reef model was set at 19 5 m downstream of the inflow entrance whose bottom center was designed as the coordination origin fig 2 more than 3 million unstructured grids were generated for each numerical case in the computational domain the front side was assigned as velocity inlet and its initial velocity was specified to be 0 5 m s as a uniform value which is a common flow velocity in shandong province of china the back side was assigned as the fluid outlet where pressure was uniform and all variables had a gradient of zero the bottom side and the surfaces of reef model were assumed to be smooth wall the other sides were assigned as the symmetric boundaries the quadratic upwind interpolation quick approximation was selected for spatial discretization the equations were iterated to the steady state by means of simplec for the velocity pressure correction convergence was assumed as the residuals fell below 10 5 2 4 statistical method analysis of variance anova is a collection of statistical models and their associated procedures such as variation among and between groups used to analyze the differences among group means in the analysis of variance setting the observed variance in a particular variable is partitioned into components attributable to different sources of variation and provides a statistical test of whether or not the means of several groups are equal analysis of variance is useful for comparing testing three or more means groups or variables for statistical significance which is suited to a wide range of practical problems spss statistics is the world s leading statistical software used to solve research problems by means of ad hoc analysis hypothesis testing geospatial analysis and predictive analytics researchers use spss statistics to understand data analyze trends forecast and plan to validate assumptions and drive accurate conclusions in this article spss for window 20 0 statistical packages were used to analyze the data on flow field scope with single variable and multi factor analysis of variance followed by the bonferroni test for multiple comparisons the p value reflects the probability of an event occurring if the p value is less than 0 05 the effect of hole diameter on flow field scope is considered to be significant the factor levels with significant difference p 0 05 are analyzed according to bonferroni test for multiple comparisons while the best influential levels of other factors without significant influence p 0 05 were analyzed by statistical means 3 results and discussion 3 1 optimization of structure the values of h up and w y are shown in table 2 the no 16 reef model produces the maximum h up 7 957 m among the thirty two models the h up of other models ranges from 7 238 to 7 914 m the no 26 reef model has the largest w y 7 169 m the w y of other models ranges from 6 504 to 7 168 m both h up 6 971 m and w y 6 237 m of control group are respectively lower than those of the 32 models therefore these results obviously reflect that the design of an interlaced hole diameter has a positive function at disturbing flow field of the rotary shaped reef anova indicates that the factors of a1 b1 c2 d1 and d2 have very significant influence on h up p 0 000 0 01 a1 b1 c1 c2 d1 and d2 have very significant influence on w y p 0 001 0 01 and a2 also has a significant influence on w y p 0 016 0 05 in order to test the factors and levels with significant influence on the flow field effect of the rotary shaped reef two new reef models named as no 33 and no 34 were designed according to the statistical results table 3 they were set with the most significant factors and levels on h up and w y whose details are shown in table 3 the flow field effects of the two reefs were analyzed under the same conditions and their h up and w y were obtained in table 3 the results reflect that the flow field scopes of the no 33 and no 34 rotary shaped reefs are greatly improved compared with the control group the h up 8 185 m and w y 7 295 m of no 33 model are obviously higher than the thirty two models in orthogonal experiment the w y of no 34 is slightly below the no 26 model but its h up exceeds the no 16 model it is obvious that the design of interlaced hole diameters has significantly improved the flow field scope of the rotary shaped reef 3 2 effect of interlaced hole diameter on hydrodynamic performance 3 2 1 upwelling flux the concept of upwelling flux q was introduced in this article to further analyze the effect of interlaced hole diameters on the flow field scope of the rotary shaped reef as shown in fig 3 a the q of the no 33 reef is greater than that of the control group it is also higher than that of the no 34 reef on all transverse planes except the plane at y 3 m h up of the no 33 reef exceeds 8 m 3 2 2 flow field the reef model with uniform hole diameters on each blade such as the no 1 reef model r 0 1 m produces the moderate flow field scope among the 32 reef models while the control group with the same hole diameters of 0 4 m causes the smallest scope it seems that the uniform hole diameter is not a good choice in design of the reef fig 4 shows that the blades a1 c1 and a2 are the main barriers to the inflow which force the inflow upward and boost the upwelling in addition the inflow must pass through the holes in blade c1 before it arrives at blade a2 thus smaller holes in blade c1 play a role in accelerating inflow to blade a2 this may be one of the reasons why the upwelling caused by the no 33 reef was the highest while the largest hole diameter in the control group greatly facilitate the passage of current and produced the lowest upwelling therefore interlaced hole diameter has a significant effect on the interweaving and promoting inflow which further expands the scope of flow field of the semi open structure of the rotary shaped reef when people design a new artificial reef they prefer to open holes in the block of a reef because a block with higher porosity is usually believed to be able to slow down the inflow velocity behind the reefs and form an extensive wake region effectively however it is a challenge to optimize the performance of the reef by changing the combination of the hole size eight factors were set in the orthogonal experiment to test the effect of hole diameter for the rotary shape reef with two holes in each blade it is difficult to analyze the interaction between factors the diagram of velocity vector distribution helps us to identify the combination of the hole diameter that can enhance the flow field effect such as h up in order to show the flow field effect of unit artificial reef the conception of h upa and w ya were adopted liu et al 2012 which are calculated by eqs 4 and 5 4 h upa h up h 5 w ya w y h where h is the height of the reef the rotary shaped reef as a semi open structure is generally considered to have no prominent flow field effect but in fact the flow field scope of rotary shaped reef is much wide than the frame reef table 4 it indicates that the rotary shaped reef also has superior flow field performance 3 2 3 drag coefficient the rotary shaped reef is a semi open structure which is different from the conventional shapes such as cubes and hemispheres a numerical analysis of the drag coefficient c x was performed with the reynolds number r e ranging from 0 3 106 to 3 6 106 fig 5 shows that c x varies little with the mean of 1 313 when the r e ranges from 0 6 106 to 3 0 106 it indicates that the self modeling region of the rotary shaped reef is in this range in addition the drag coefficient reach 1 531 when r e is less than 0 6 106 it seems that laminar flow has begun to transform to turbulent regimes in this range when r e is greater than 3 3 106 the c x drops to 1 234 it means that the trail width of flow field stars to decrease 3 3 effect of cut opening ratio on hydrodynamic performance as shown in tables 1 and 3 or of the rotary shaped reefs in this article ranges from 0 12 to 1 92 the highest or is 1 92 for the control group but h up and w y are the lowest the no 4 reef has the second largest or 1 68 whose flow field is significantly better than that of the control group and is at medium level among all the reefs the no 1 reef has the smallest or 0 12 whose h up is also at medium level but its w y is at lower level among all the reefs the h up and w y of no 33 reef are the largest but its or is 0 57 therefore there is no obvious relationship between or and flow field effect for the rotary shaped reef wang et al 2018 found that a reasonable arrangement of or can enhance the field of upwelling of the cubic reef however the rotary shaped reef is a semi open structure with irregular multiple inflow surface and the area of the inner and outer blades is different the irregularity of reef structure will be increased if or of each blade is taken as the influencing factor which will be unrealistic for construction in practice so the hole diameter was selected as the influencing factor which is conducive to unified structural parameters of reef models and the purpose of this article is to provide a scientific basis for the selection of hole diameter therefore these results further prove that the structure has a significant effect on flow field effect of artificial reef sherman et al 2002 falcão et al 2009 jiang et al 2016 liu and su 2013 gatts et al 2015 in addition the results show that the reefs with the same or have basically the same flow field such as the no 19 and no 21 the no 7 and no 22 the no 25 and no 8 the no 12 and no 15 but the flow field of no 16 is better than the no 30 this may be related to the location and diameter of hole the levels of most factors of no 16 reef are the same as those of the no 33 reef such as b1 c1 c2 d1 and d2 the results of orthogonal experimental design show that the factors of b1 c2 d1 and d2 have very significant influence on the h up therefore it is these factors that make the flow field effect of no 16 reef prominent among the 32 reefs in table 1 4 conclusion the structure of artificial reef has a significant influence on its flow field effect which will also affect its ecological function such as the aggregation of fish the attachment of algae etc and opening holes in reef block is a very common structure design for artificial reef but there has been a lack of scientific basis for choosing the hole diameter in this article the flow field scopes of rotary shaped reef with different hole sizes in eight blades were investigated using cfd method the effects of hole diameter on flow field scope and the most appropriate combination of the hole diameter were identified using the orthogonal experimental design the result indicate that the structure design of interlaced hole diameter can significantly promote the flow field scope especially the h up and the h up of the no 33 reef is 1 17 times as large as the control group cut opening ratio or was introduced to analyze the effect of hole diameter on the flow field but there is no obvious relationship between or and flow field effect for the rotary shaped reef the control group with the largest hole diameter and or has the smallest flow field scope among the eight factors a1 b1 c2 d1 and d2 have very significant influence on h up p 0 000 0 01 a1 b1 c1 c2 d1 and d2 have very significant influence on w y p 0 001 0 01 and a2 has a significant influence on w y p 0 016 0 05 the reef structure of interlaced hole diameter fundamentally changes the velocity and direction of the flow passing through the reef and play a decisive role in enhancing the flow field scope for the rotary shaped reef the design of interlaced hole diameter is more conducive to the acceleration of flow which can force the current to lash against the blades and boost the formation of upwelling it suggested a smaller hole diameter on the surfaces perpendicular to the inflow and a larger hole diameter on the planes parallel to the inflow acknowledgment this research was supported by the national natural science foundation of china 41771544 and 31272703 and major research project of shandong province 2016gsf115029 and 2017ghy15110 the numerical calculations in this article were performed on the supercomputing system in the supercomputing center shandong university weihai 
22169,during operations river and tidal hydrokinetic turbines encounter changes in flow direction that decrease their performance evaluating hydrokinetic turbines in yaw conditions contributes to estimating turbine performance power stability and power delivered to the grid water tunnel tests using a 19 8 cm diameter horizontal axis model turbine in yaw operation show the performance reduction using three designs no shroud a convergent divergent shroud and a diffuser shroud experimental results obtained at three reynolds numbers of 1 38 105 1 77 105 and 2 17 105 show that the output power decreases in off axis flows for all designs investigated the reduction is initially negligible up to a 10 yaw angle but then increases with increasing the yaw angle the convergent divergent shroud experiences significantly less performance loss compared to the other two designs the maximum performance loss of the convergent divergent shroud design is 6 on average for the reynolds numbers investigated based on the experimental results and in analogy to the linear momentum theory cosine cubed rule we propose new cosine relations for shrouded turbines in yaw operations depending on the shroud s geometry the maximum power of a shrouded turbine decreases either with the cosine or the cosine squared of the yaw angle keywords hydrokinetic turbine shroud yaw angle performance reduction cosine relation 1 introduction a wind turbine rotor in a turbulent atmospheric boundary layer is almost always in yawed flow conditions smulders et al 1981 rapid variations occur in wind direction and velocity causing wind turbine controls to lag thus for a wind turbine yaw operations are more usual than inline operations van bussel 1994 it is common for a wind turbine to operate at yaw angles as large as 30 for several minutes hansen and butterfield 1993 furthermore a wind turbine that encounters relatively high rates of yaw misalignment experiences fatigue loads induced by gyroscopic moments that could lead to failure lynette 1988 concluded that turbine damages caused by yaw misalignment is the second cause of wind turbine downtime as yaw operation results in a skewed wake modifies induced velocity patterns and produces cyclic changes in the blade angle of attack this situation leads to dynamic stall and variable loading on the rotor blade resulting in a loss of yaw stability leading to excessive induced loads on the rotor and turbine structure hansen 1992 similarly a hydrokinetic turbine encounters changes in flow direction of rivers and oceans affecting the performance like for wind turbines evaluating hydrokinetic turbines in yawed flow conditions is important to predict performance and power stability in off axis flows moreover long term flow direction variations attributed to surface ice for example have been reported when testing hydrokinetic turbines on the winnipeg river birjandi et al 2015 field observations from a site off the welsh coast indicate the majority of currents tend to fall within 20 of the principal flow direction for economically viable velocities frost et al 2017 the effect of yaw angle thus plays an important role in designing yaw control mechanisms for shroud designs to optimize the performance of hydrokinetic turbines boorsma 2012 this role is more pronounced for a floating turbine where a yaw control mechanism is more complicated than for a fixed turbine krogstad and adaramola 2012 understanding the effect of yaw angle on the performance of hydrokinetic turbines is necessary for designing turbines operating in river and ocean environments a comprehensive literature review on the effect of yaw angle on the performance of kinetic turbines shahsavarifard 2015 reports diverse effects similar to wind applications that review concludes there is no conclusive study that identifies the effect of yaw angle on the performance of hydrokinetic turbines yaw angle also plays an important role in the performance of wind turbine farms and hydrokinetic turbine arrays deflection of wake of the first row turbines in a farm could benefit the operation of downstream turbines and increase the farm overall power output adaramola and krogstad 2011 mckay et al 2013 performance evaluation in yaw operations has been part of on going wind turbines research smulders et al 1981 measured power and thrust force of a 20 cm diameter two bladed horizontal axis wind turbine in off axis operations in an open 50 cm by 50 cm wind tunnel they found for yaw angles as high as 45 the optimum tip speed ratio does not change while the power coefficient decreases significantly they observed that performance coefficient shows cosine cubed dependence to the yaw angle as predicted by the linear momentum theory burton et al 2001 the cosine cubed dependence of the performance to the yaw angle was also observed by schumack 1979 in experiments on a different turbine design anderson et al 1982 performed wind tunnel and field experiments on a 3 m diameter two bladed horizontal axis wind turbine with blades having a naca 4412 airfoil profile the turbine had a 12 blockage ratio which was corrected using the glauert 1947 relation as this correction is shown to be adequately accurate for small blockage ratios willmer 1979 they observed that power coefficient in yaw operation decreases with the cosine cubed of the yaw angle which was in agreement with the linear momentum theory grumman aerospace corporation conducted extensive research on diffuser augmented wind turbines foreman et al 1983 foreman and gilbert 1983 they performed experiments using a baseline diffuser and a two bladed 45 7 cm diameter turbine to assess the performance of diffuser augmented wind turbines in yawed flow conditions the baseline diffuser was a straight wall diffuser with a 60 included angle and had an exit area ratio of 2 78 and a length to diameter ratio of 0 5 they found the unshrouded wind turbine insensitive to yaw angles less than 30 but observed a sudden 80 increase in the turbine power at 30 yaw angle for the diffuser augmented wind turbine they observed negligible changes in the power up to 30 yaw angle followed by an abrupt reduction at 40 they believed their tests are inconclusive because the reason for the yaw insensitivity could not be explained grant et al 1997 conducted experiments on a 90 cm diameter horizontal axis wind turbine in an open jet wind tunnel two bladed and three bladed configurations of the turbine were tested power coefficients and wake of the turbine were examined using 0 to 30 yaw angles ratio of the maximum power coefficients in off axis flows to the maximum power coefficient without yaw were compared to experimental data of clayton and filby 1982 power coefficients in yaw operations from the two datasets closely follow the pattern of cosine cubed of the yaw angle the national renewable energy laboratory nrel conducted field measurements and wind tunnel experiments on a 10 m diameter two bladed horizontal axis wind turbine using s809 airfoil profile since 1987 a comprehensive set of wind tunnel experiments were performed on an instrumented wind turbine in the 24 4 m by 36 6 m nasa wind tunnel hand et al 2001 the experiments provided accurate quantitative aerodynamic and structural measurements on a wind turbine which geometrically and dynamically represents a full scale wind turbine power thrust pressure structural moments and loads are reported for yawed conditions results show the decreasing trend predicted by the linear momentum theory the maximum power coefficient decreases with the cosine cubed of the yaw angle while the thrust at the maximum power decreases with the cosine squared of the yaw angle maeda et al 2008 performed wind tunnel experiments and measured power and pressure distribution of a 2 4 m diameter horizontal axis wind turbine in yaw operations they present power and torque curves for a range of tip speed ratios and yaw angles in two directions identical performance coefficients were obtained for the two directions of yawing in the horizontal plane their results show that the ratio of power coefficients in yaw operations to the inline operation decreases with the cosine cubed of the yaw angle they report a small difference between experimental data and theory prediction at larger yaw angles adaramola and krogstad 2011 experimentally investigated the effect of a wind turbine wake on the performance of a downstream turbine in a wind turbine farm two 90 cm diameter three bladed horizontal axis wind turbines were used in wind tunnel experiments power and thrust curves of a single turbine obtained for a range of yaw angles were also published krogstad and adaramola 2012 in agreement with the linear momentum theory the measured power decreases with the cosine cubed of the yaw angle they measured the performance of a downstream turbine when placed at different distances from an upstream turbine operating in yaw conditions they observed that performance of the downstream turbine improves when the upstream turbine is yawed and is away from the optimum performance authors concluded that operating an upstream turbine at an appropriate yaw angle results in an increase in overall efficiency of a wind farm and consequently reduces the space requirement for the wind farm dou et al 2019 proposed a wake model to predict the turbine wake velocity distribution for given yaw angles the model was validated through wake measurements in yaw operation of previous experiments on a 20 cm diameter two bladed wind turbine in a wind tunnel and a three bladed 15 cm diameter hydrokinetic turbine in an open channel flow experiments showed the yaw operation of turbines not only results in reduction of the power and thrust but also deflects the downstream wake of the turbine the paper proposed an empirical function to calculate the skew factor in the yawed wake model with skew distribution authors expect the proposed wake model to improve the control and optimization strategies for wind farms and hydrokinetic power plants noura et al 2012 examined a 50 cm diameter three bladed horizontal axis wind turbine in a wind tunnel in agreement with previous studies and the linear momentum theory they also observed that the reduction of power in yawed flows is proportional to the cosine cubed of the yaw angle similarly tsalicoglou et al 2012 studied the effect of flow inclination on the performance of a wind turbine they conducted performance and flow field measurements on a 30 cm diameter three bladed turbine in a towing tank performance coefficients of the turbine at yaw angles up to 40 were measured and observed to decrease with the cosine cubed of the yaw angle smaller performance reduction was found in yawed flows with higher turbulence intensities they considered surface and blockage effects negligible based on a previous study barber et al 2011 barber et al 2011 stated the 7 1 blockage ratio in the experiments was less than the 7 5 limit introduced by barlow et al 1999 below which blockage correction is not required park et al 2016 performed computational fluid dynamics simulations on an 8 m diameter three bladed baseline turbine with naca 633 418 foil section to predict performance of a horizontal axis tidal stream turbine in off design conditions the cfd analyses considered effects of blade deformation and yawed inflow conditions the yawed flow simulations were validated using results of a towing tank experiment the performance of a baseline turbine were calculated at 0 5 and 10 yawed inflow conditions for the design tip speed ratio the influence of yawed inflow conditions on the turbine performance was found to be important for accurate power predictions in the design stages frost et al 2017 using computational fluid dynamics investigated the effects of misaligned flows on the performance of a tidal stream turbine the paper utilizes velocity data collected from a site off the welsh coast and compare the results to the performance parameters of a 10 m diameter horizontal axis tidal stream turbine the cfd modelling suggests a reduction in the turbine performance parameters as the yaw angle increases at 10 yaw angle a 7 drop was noted in the peak power compared to the inline flow dai et al 2018 investigated aerodynamic behaviour of wind turbines in yaw operation based on scada data they found that below the rated wind speed the output power decreases as the yaw angle increases close to and above the rated speed the effect of yaw on output power becomes weaker because of stronger pitch control effects authors believe that although much research on wind turbine yaw operation have been performed some issues due to the complexity of yaw operation need further investigations to address the uncertainty in the impact of yaw operations on hydrokinetic turbines we report on an experimental study of the effect of yaw angle on the performance of two shrouded horizontal axis hydrokinetic turbines the results are then compared with the equivalent unshrouded turbines as well as to the linear momentum theory results 2 test facility experiments were performed in a recirculating water tunnel facility at the university of manitoba the tunnel consists of a vertical flow loop configuration with a 61 cm wide by 183 cm long test section which allows a maximum 60 cm of water height in the test section a propeller pump circulates water in the tunnel and provides a maximum water velocity of 1 1 m s at the test section at full water height an upstream honeycomb breaks down vortices generated in the pump and reduces flow turbulence intensity at the test section to less than 3 at the maximum speed the test rig consists of a baseplate that sits on the two sides of the water tunnel upper rim and keeps the model turbine submerged at the center of the flow cross section it also secures the required instrumentation out of water the model turbine consists of a rotor blade secured to the turbine horizontal shaft a torque meter and a dc gear motor the turbine shaft aligns the rotor blade perpendicular to the flow direction one radius upstream of the support structure a connector piece around the turbine shaft enables replacing the shrouds the turbine shaft and connector piece are designed to axially place the rotor blade at the smallest cross sectional area of each shroud i e inlet of the diffuser and throat of the shroud the rotor blade is a 19 8 cm diameter three bladed h0127 wind turbine blade of kidwind project inc with a solidity of 0 13 geometric characteristics of a rotor blade and detail description of the model turbine and the test rig can be found in shahsavarifard et al 2015 a cad design of the test rig and model turbine with the diffuser installed is depicted in fig 1 two shroud designs were optimized and fabricated to study and compare effect of shrouds on the performance of the model turbine in inline and off axis operations one design is a convergent divergent duct manufactured in a rapid prototyping machine and is referred to as the shroud the other design is a straight wall duct machined out of an acrylic block and is referred to as the diffuser area ratio and half angle for the shroud and the diffuser were selected based on the studies available in the literature reviewed in shahsavarifard 2015 shahsavarifard et al 2015 schematic profiles and pictures of the shroud and the diffuser are depicted in fig 2 3 instrumentation a torque transducer and a load cell measure torque and thrust of the turbine rotor for the power curve range a generator and variable resistance configuration is often used to extract power from a turbine in water tunnel experiments limiting power capture at low tip speed ratios to obtain the performance curve for the entire span a dc motor is employed shahsavarifard et al 2015 the motor in this method drives the turbine at a constant speed with the torque transducer placed between the motor and the turbine as shown in fig 1 this arrangement enables measuring the rotor torque at any tip speed ratios the digital wave rotary torque transducer measures torque on the turbine shaft at a sampling rate of 200 hz to a maximum value of 5 n m the torque transducer has a rotational speed sensor that enables direct measurement of turbine power the miniature universal strain gauge load cell capable of measuring forces up to 100 n enables measurement of thrust force on the turbine rotor as shown in fig 3 in addition to torque and thrust measurements an acoustic doppler velocimetry adv probe measures the undisturbed flow velocity at the inlet of the water tunnel test section at a sampling rate of 200 hz 4 test procedure and data analysis measurements begin with the unshrouded model turbine at 0 7 0 9 and 1 1 m s water velocities flow velocities correspond to reynolds numbers of 1 38 105 1 77 105 and 2 17 105 based on the rotor diameter and the undisturbed water velocity turbulence intensity of flow calculated from adv measurements ranges from 2 06 to 2 89 the torque exerted by the water stream onto the turbine rotor is measured at each reynolds number drag force on the turbine structure is measured at each test velocity the thrust force on the turbine rotor at each tip speed ratio is then calculated by subtracting this drag force from the thrust acting on the turbine and structure test procedure is repeated for the model turbine with the shroud and then for the model turbine with the diffuser for the off axis flow experiments the model turbine is rotated about the vertical axis passing through the apex of the rotor s hub for the range of yaw angles from 5 to 25 in 5 increments yaw angle is the angle between the turbine axis and flow direction rotating the turbine about the specific axis discussed keeps the turbine at the center of the tunnel test section fig 4 shows the model turbine in a yaw experiment and the angle signs generated on a full scale drawing of the tunnel and marked on the tunnel rims for a given flow speed and rotor angular velocity measured torque and thrust are averaged and corrected for zero offset then tip speed ratio power and thrust coefficients are respectively calculated as follows 1 t s r r ω v 2 c p q ω 1 2 ρ a v 3 3 c t t 1 2 ρ a v 2 angular velocity of the turbine shaft is ω v is the flow velocity r is the radius and a the swept area torque and thrust of the model turbine are represented by q and t respectively these coefficients are calculated based on the rotor swept area and the undisturbed water velocity power and thrust coefficients as well as tip speed ratio are corrected for free surface proximity and blockage effects details of which are available in shahsavarifard et al 2015 as an example a typical thrust coefficient of 0 40 for the unshrouded model turbine at water velocity of 0 7 m s and 15 yaw angle results in 1 2 reduction in the tip speed ratio 2 3 reduction in the thrust coefficient and 3 4 reduction in the power coefficient accuracy of the torque transducer and the load cell in experiments are 0 25 of the full scale the adv measures flow velocity with an accuracy of 0 5 of the measured velocity 1 mm s accuracy in length measurements is 0 02 mm the expanded uncertainty for the power and thrust coefficients are calculated based on type a and type b standard uncertainty evaluations in accordance with jcgm 2008 the uncertainty of measurements for typical values of cp 0 55 and ct 0 80 for the model turbine with the shroud at water velocity of 1 1 m s and 5 yaw angle are as follows the power and thrust coefficients are cp 0 55 0 03 and ct 0 80 0 02 and the reported expanded uncertainty is based on the standard uncertainty multiplied by a coverage factor of 2 providing a level of confidence of approximately 95 for the purpose of clarity error bars are only added to selected figures 5 results and discussion experimental power and thrust coefficients for the shrouded and unshrouded model turbine in yaw operations are presented coefficients obtained in water tunnel experiments are calculated based on the blade swept area and are corrected for free surface proximity and blockage effects experiments were performed for the two possible directions of yaw rotation in the horizontal plane performance curves of the shrouded and unshrouded model turbine showed no sensitivity to the sign of the yaw angle results are for the unshrouded turbine turbine with the shroud and turbine with the diffuser the three configurations are respectively referred to as blade shroud and diffuser in the diagrams the experimental data for the shrouded and unshrouded model turbine in yaw operations is available in shahsavarifard and bibeau 2014 5 1 power coefficients fig 5 shows power coefficients of the shrouded and unshrouded model turbine for yaw angles of 0 to 25 performance coefficients are for 1 1 m s water velocity obtained in 5 increments and shown against the tip speed ratio power curves for 0 7 and 0 9 m s water velocities have similar shapes and can be found in shahsavarifard 2015 maximum power coefficients for the three configurations of the model turbine at 1 1 m s water velocity are summarized in table 1 it is apparent from the experimental results that the turbine performance decreases as the yaw angle increases reduction in the performance of the model turbine with respect to the inline operation is insignificant for yaw angles up to 10 the amount of power reduction gradually increases up to 25 yaw angle where the maximum reduction occurs maximum performance reduction for the unshrouded turbine the blade compared to zero yaw operation is 22 maximum reduction in the performance of the model turbine with the shroud and with the diffuser is 5 and 21 respectively compared to the inline performances the experimental results show that the shroud effectively reduces the influence of yaw angle on the turbine performance the diffuser has virtually no influence on reducing the effect of yaw angle on the performance fig 6 shows the relative decrease in the maximum performance of the shrouded and unshrouded model turbine at 25 yaw angle compared to the inline performance at the three water velocities the power decrease for the blade and the turbine with the diffuser are almost the same at a maximum of 3 difference this means the diffuser that has the most increasing effect on the inline performance of the model turbine shahsavarifard et al 2015 is unable to keep its high performance in yaw operations instead the model turbine with the shroud has the least performance loss in yaw operations the shroud effectively moderates the effect of yaw angle on the turbine performance maximum reduction in the performance of the model turbine with the shroud is 6 on average at the three reynolds numbers examined the model turbine with the shroud experiences negligible performance loss in yaw operations compared to the unshrouded turbine performance loss of the turbine with the shroud in yaw operations is on average 17 less than the power reduction of the unshrouded turbine the power curve shapes for the model turbine in yaw angle is similar to the performance curves in inline operations performance coefficients of the shrouded and unshrouded model turbine start from zero and increase with the tip speed ratio to achieve a maximum at a tip speed ratio of approximately four further increase in the tip speed ratio results in a descending power curve to zero at a tip speed ratio of approximately seven similar to the inline flow three regimes of operation are distinguished in the performance curves low tip speed ratio optimum tip speed ratio and high tip speed ratio regimes performance of the unshrouded turbine the blade and the model turbine with the diffuser is observed to decrease with increasing the yaw angle however performance curve of the model turbine with the shroud remains nearly unchanged with changes in the yaw angle at the three water velocities examined at 25 yaw angle performance curve for the model turbine with the diffuser falls close to the power curve with the shroud at the optimum power difference between the two curves is less than 10 at three water velocities investigated results show the inability of the diffuser in keeping the turbine power curve unchanged in yaw operations it is observed from fig 5 that the low tip speed ratio portions of the curves for the three turbine configurations overlap at each yaw angle this means the shroud and the diffuser are unable to enhance the turbine performance in the low tip speed ratio portion of the performance curve performance reduction in yaw operations has two main reasons first changes occur in the aerodynamic behavior of blades due to variations of the angles of attack and second the reduced projected swept area pedersen 2004 at the low tip speed ratio portion blades are in a deep stall mode schreck et al 2001 stall and not the yaw effect is the dominant phenomenon and a shroud is unable to push the blades out of stall phillips 2003 regardless of the operating yaw angle blades at low tip speed ratios are stalled due to high angles of attack in this situation a shroud is unable to make enough changes in the angles of attack required to alter the stall state increasing tip speed ratio reduces angles of attack and allows the blades to leave the stall in this situation stall may no longer be dominant and the yaw angle effect becomes the determinant factor from this point on the influence of yaw angle on reducing power coefficients of the shrouded and unshrouded turbine is observed at the optimum tip speed ratio blades operate at the highest lift to drag ratio and the turbine generates its maximum power at the high tip speed ratio portion of the curves low angles of attack and the consequent high drag may be responsible for the lower output power this is where a shroud is able to increase the angles of attack reduce the drag and enhance the turbine performance in inline operations in yaw operations however changes in aerodynamic characteristics of blades and reduction in the projected swept area due to increase in the yaw angles will reduce the lift force on the blades and hence the turbine power the shroud having a well designed inlet is able to moderate these effects and keep the power curve nearly unchanged the diffuser having no inlet fails to keep the performance unchanged and therefore the power curve of the model turbine with the diffuser falls close to the curve of the turbine with the shroud examination of the performance curves reveals another fact about yaw operations of a horizontal axis turbine runaway point of the unshrouded turbine occurs at a lower tip speed ratio than in the inline operation in other words not only the turbine performance decreases but also the operating tip speed ratio range of the turbine decreases in yaw operations this behaviour has been experimentally observed and reported for an unshrouded turbine krogstad and adaramola 2012 to investigate this characteristic in detail performance curves of the shrouded and unshrouded model turbine are shown in figs 7 9 where performance curves of the three turbine configurations are shown separately for the range of tip speed ratios at 1 1 m s water velocity similar curves for 0 7 and 0 9 m s water velocities can be found in shahsavarifard 2015 a common aspect in these figures is that the low tip speed ratio portion of the curves shows no sensitivity to the yaw angle irrespective of the turbine configuration this has been reported in the literature for an unshrouded turbine noura et al 2012 fig 7 shows the performance curves of the unshrouded turbine in yaw operations in which three features are observed first the overlap of the low tip speed ratio portion of the curves explained previously second the reduction in the maximum power coefficient of the turbine in yawed flows is apparent changes in the blades angles of attack due to the yaw angle makes the rotor blade operate away from the optimum tip speed ratio and subsequently the optimum angle of attack maeda et al 2008 the larger the yaw angle is the farther the blades are from the optimum angle of attack and the less power the turbine generates third as the yaw angle increases the runaway point moves to the left and to a lower tip speed ratio this results in a narrower operating range of the turbine further reduction in the angles of attack causes an increase in the drag force on the blades and results in a runaway point at a smaller tip speed ratio tsalicoglou et al 2012 reduction of the projected swept area in yaw operations is also a determinant factor for the optimum and high tip speed ratio portions of the curves pedersen 2004 as yaw angle increases the projected area decreases and this adds to the effect of the reduced angles of attack and decreases the output power further operating a hydrokinetic turbine in yaw conditions not only reduces its performance but also narrows its operating range this process intensifies as yaw angle increases the reason for the performance loss with increasing yaw angle is that it changes the effective flow velocity component and angles of attack on the blades altering the aerodynamic characteristics of blades this results in a reduced lift force on the blades and consequently a reduced power of the turbine burton et al 2001 in addition the projected swept area of a turbine in a yawed position is reduced compared to the inline flow therefore the effective inlet area to the rotor blade facing the incoming flow is also reduced for the turbine grant et al 1997 maeda et al 2008 these are the two main causes for performance reduction of a turbine in yaw operations a shroud capable of eliminating these effects is able to conserve the turbine performance in yaw operations fig 8 displays performance curves of the model turbine with the shroud in yaw operations the overlap of the low tip speed ratio portion of the curves due to stall is repeated here in contrast to the unshrouded turbine the rest of power curves for the turbine with the shroud overlap as well it is observed that the shroud keeps the optimum and high tip speed ratio portions of the curves nearly unchanged the maximum performance of the turbine in the inline operation is preserved in yaw operations with the shroud maximum reduction in performance of the turbine with the shroud compared to the inline operation is 8 occurring at 0 7 m s water velocity maximum reduction in 0 9 and 1 1 m s water velocities is 6 and 5 respectively in addition to conserving the maximum performance the shroud keeps the working range of the turbine nearly unchanged i e power curves in yaw operations have the same runaway points the shroud inlet is responsible for the invariant performance curves well designed inlet of the shroud is capable of compensating the effect of yawed inflow in reducing the angles of attack and projected swept area an inlet contraction also reduces the inflow asymmetry which is responsible for degrading the pressure recovery of a diffuser klein 1981 fig 9 shows performance curves of the model turbine with the diffuser in yaw operations the overlap of the low tip speed ratio portion of the curves due to stall seen for the unshrouded turbine and the turbine with the shroud is also repeated here the optimum tip speed ratio portion of the curves descends with increasing the yaw angle the diffuser is not able to prevent reduction of the turbine performance at the optimum portion of the curves however the diffuser reduces the effect of yaw angle on the high tip speed ratio portion of each curve resulting in the overlap of the curves in fig 9 the runaway point of the turbine with the diffuser also stays unchanged the diffuser is able to keep the operating range of the turbine fixed in yaw operations examination of figs 8 and 9 reveals different functions of the shroud and the diffuser on the turbine performance in yaw operations the shroud having a convergent divergent section keeps the optimum and high tip speed ratio portions of the power curves unchanged the diffuser having a divergent section keeps the high tip speed ratio part of the curves invariant it is concluded that the convergent section of a shroud and the inlet affects the optimum tip speed ratio portion of the performance curve in yaw operations the divergent section and exit are responsible for influencing the high tip speed ratio portion of the power curve and the runaway point the conclusion is expected to be true for optimally designed shrouds with carefully selected convergence and divergence angles 5 2 thrust coefficients fig 10 shows thrust coefficients of the shrouded and unshrouded model turbine in yaw operations at 1 1 m s water velocity it is observed that thrust coefficients decrease in yaw operations the reduction is small for yaw angles up to 10 but increases as the yaw angle increases skewness of the turbine wake as well as the reduction in the projected rotor area and the effective flow velocity result in the decrease of thrust coefficients krogstad and adaramola 2012 thrust force on a turbine rotor is directly transferred to the turbine structure and affects the design of the structure and anchoring system burton et al 2001 it is quite important to have estimations of the thrust force on a turbine as underestimating this force can result in failure in large scale deployments shahsavarifard et al 2014a 2014b thrust coefficient curves in yaw operations have similar shapes to the inline curves the curves demonstrate a consistent increasing trend where thrust force starts from a zero tip speed ratio when the turbine is stopped this is because the turbine has the least frontal area when the rotor blade is at rest and therefore has the minimum thrust force trust force then continuously increases as the tip speed ratio increases tong 2010 5 3 comparison to linear momentum theory 5 3 1 wind turbines experimental data the linear momentum theory uses simplified assumptions to predict the performance of an unshrouded turbine assumptions include inviscid fluid steady homogeneous and incompressible flow infinite number of blades for the turbine rotor and non rotating wake behind the turbine rotor this can be extended to a yawed turbine where the theory results in cosine functions of the yaw angle for the power and thrust of a turbine burton et al 2001 maximum power of an unshrouded kinetic turbine and its thrust at the maximum power are theoretically expected to decrease with cosine cubed and cosine squared of the yaw angle respectively the momentum theory uses ideal assumptions some of which are not applicable to a turbine in yaw operations burton et al 2001 therefore experimental verification is needed if theoretical results are to be used with confidence in assessing the performance of a yawed turbine or as control parameters in optimizing the output power of a wind turbine farm figs 11 and 12 compare experimental power and thrust of unshrouded wind turbines in yaw operations available in the literature with the cosine cubed and cosine squared rules of the linear momentum theory fig 11 shows the ratio of the maximum power in yaw angles to the maximum inline power a close agreement is seen between the experimental data and the line representing the cosine cubed of the yaw angle a maximum discrepancy of 10 is seen between experimental results of anderson et al 1982 at 30 yaw angle and the cosine cubed rule difference between the experimental and theoretical results is less than 10 for the other studies fig 12 shows the ratio of thrust at the maximum power in yaw angles to the thrust at the maximum power in inline operation a close agreement is also seen between the experimental data and the cosine squared line a maximum discrepancy occurs at 30 yaw angle for experimental results of national renewable energy laboratory hand et al 2001 the maximum difference is 5 and the discrepancy between the experimental and theoretical results is less than 5 for the other studies it is therefore concluded that the cosine cubed and cosine squared rules of the linear momentum theory are in close agreement with experimental results 5 3 2 the unshrouded model turbine it is so far shown that the linear momentum theory accurately predicts the decreasing behaviour of the power and thrust coefficients of an unshrouded kinetic turbine in yaw operations it is of interest to have such basic relations to predict performance reduction of a shrouded hydrokinetic turbine in yaw operations no such relations are available in the literature for shrouded turbines while having that relationship can benefit the marine renewable energy industry first the measured power and thrust coefficients of the unshrouded model turbine are compared to the linear momentum theory fig 13 depicts the ratio of the maximum power of the blade at yaw angles to the maximum inline power it is observed that the experimental data follows the cosine cubed of the yaw angle line the maximum difference between the experimental data and cosine cubed line is 4 1 occurring at a 25 yaw angle fig 14 shows the thrust ratio of the maximum power at yaw angles to the thrust at the maximum power without yaw the experimental data closely follows the cosine squared of yaw angle line with a maximum difference of 4 0 occurring at a 25 yaw angle therefore results of this study further confirm the results from previous experimental studies in the literature for unshrouded turbines i e the linear momentum theory can precisely predict the decreasing behaviour of the power and thrust coefficients of a hydrokinetic turbine in yaw operations the rules of cosine cubed and cosine squared of the yaw angle are adequately precise to predict the loss in the performance of hydrokinetic turbines in yaw operations 5 3 3 the model turbine with the shroud reduction in the power and thrust of the model turbine with the shroud is now examined fig 15 shows the ratio of the maximum power of the model turbine with the shroud at yaw angles to the maximum inline power lines of cosine and cosine cubed of the yaw angle are also shown it is observed that the experimental data closely follows the cosine of the yaw angle line maximum difference between the experimental data and the cosine line is 3 5 occurring at 25 yaw angle results show that the shroud effectively reduces the turbine power reduction from cosine cubed to cosine of the yaw angle fig 16 shows the ratio of the thrust at the maximum power at yaw angles to the thrust at the maximum power in inline operation the cosine and cosine squared lines of the yaw angle are also graphed the experimental data is observed to follow the cosine of the yaw angle line maximum discrepancy between the experimental data and the cosine line is 1 5 occurring at a 25 yaw angle the shroud decreases the reduction in the thrust of the model turbine from cosine squared to cosine of the yaw angle it is therefore concluded that the shroud effectively reduces the sensitivity of the model turbine performance to changes in the yaw angle based on the cosine rule experimentally observed the turbine with the shroud in a 45 yawed flow generates 29 less power than in an inline flow the unshrouded turbine based on the cosine cubed rule would produce 65 less power in the same flow 5 3 4 the model turbine with the diffuser reduction in the power and thrust coefficients of the model turbine with the diffuser is now examined fig 17 shows the ratio of the maximum power of the model turbine with the diffuser at yaw angles to the maximum inline power lines of cosine cosine squared and cosine cubed of the yaw angle are also shown it is observed that the experimental data is well predicted by the line of cosine squared of the yaw angle maximum difference between the experimental data and the cosine squared line is 5 3 at 25 yaw angle it is seen that the diffuser reduces the turbine power reduction from cosine cubed to cosine squared of the yaw angle fig 18 shows the ratio of the thrust at the maximum power at yaw angles to the thrust at the maximum power in zero yaw lines of cosine and cosine squared of the yaw angle are also graphed the experimental data is observed to narrowly follow the cosine of the yaw angle line maximum discrepancy between the experimental data and cosine line is 2 1 at 25 yaw angle the diffuser decreases the reduction in the thrust of the model turbine from cosine squared to cosine of the yaw angle the diffuser compared to the shroud is less effective in reducing the sensitivity of the model turbine power to the yaw angle based on the cosine squared rule the turbine with the diffuser in a 45 yawed flow generates 50 less power than in an inline flow the unshrouded turbine and the turbine with the shroud would produce 65 and 29 less power in the same flow 5 4 verification of the cosine rules for shrouded turbines the cosine rules for shrouded turbines obtained from the experimental results have not been reported in the literature experimental studies available in the literature on shrouded turbines have excessive tunnel blockage resulting in elevated power coefficients in yaw operations phillips 2003 this renders the results of such studies less reliable the only reliable study for verification is the experimental study by phillips et al 1999 performed on a diffuser augmented wind turbine in a wind tunnel the shroud used in their experiment is a duct comparable to the shroud of the present study with an optimized airfoil shaped converging diverging cross section fig 19 shows the ratio of the maximum power of this diffuser augmented wind turbine at yaw angles to the maximum inline power the experimental data is observed to be in a close agreement with the cosine of the yaw angle line maximum discrepancy between the experimental data and cosine line is 5 7 at 30 yaw angle this verifies the cosine rules proposed in the current study for the shrouded model turbine as the shrouds used in the two studies are similar having convergent divergent cross sections it is therefore concluded that the cosine rules introduced in this study remain valid for similar optimally designed shrouded turbines in the range of the yaw angles investigated 5 5 velocity at the rotor plane power of an ideal hydrokinetic turbine in theoretical studies is calculated by multiplying thrust of the turbine and flow velocity at the rotor disk burton et al 2001 having the cosine rules for power and thrust of the model turbine in yaw operations allows for deducing changes in the flow velocity at the rotor plane table 2 summarizes the cosine rules for shrouded and unshrouded turbines in yaw operations for the blade it is clear from the momentum theory that power and thrust are proportional to cosine cubed and cosine squared of the yaw angle flow velocity at the rotor plane is deduced to be proportional to cosine of the yaw angle this is obvious as the momentum theory starts deriving the yaw performance of a turbine by using the normal component of the flow velocity to the rotor disk i e the cosine component power and thrust of the model turbine with the diffuser are proportional to cosine squared and cosine of the yaw angle respectively flow velocity at the rotor plane is therefore proportional to cosine of the yaw angle same as unshrouded turbines the effect of the diffuser on the power of the model turbine is therefore due to the influence it has on the thrust force and not on the velocity power and thrust of the model turbine with the shroud are proportional to cosine of the yaw angle flow velocity at the rotor plane hence remains unchanged compared to the inline flow operation comparing the shroud and the diffuser shows that the additional effect of the shroud on the power is due to the influence it has on the flow velocity at the rotor plane advantage of the shroud over the diffuser is the ability of its inlet in eliminating the effect of yaw angle on the flow velocity at the rotor plane the inlet of the shroud with its optimum convergent design bends the flow streamlines and keeps them normal to the rotor plane therefore velocity vectors and not just the cosine components of the velocity remain normal to the rotor plane same as the inline flow this characteristic of the shroud is expected to be a function of the yaw angle and is anticipated to alter in higher angles as the inlet angle is close to the maximum yaw angle investigated in the experiments table 2 is useful to help decide for a given application the role of a shroud and how it will be used to enhance the economics of a marine turbine 6 conclusions a 19 8 cm diameter horizontal axis hydrokinetic turbine and two shrouds were designed fabricated and experimentally tested in the water tunnel facility at the university of manitoba tests aimed to study the effect of shroud on the performance of a hydrokinetic turbine in off axis flow conditions consistent power and thrust coefficient curves for the shrouded and unshrouded turbines were obtained for the range of the performance curve free surface proximity and blockage effects were corrected using a one dimensional actuator disk model it is experimentally observed that the output power of a hydrokinetic turbine decreases in off axis operations compared to the inline operations the reduction is negligible up to 10 yaw angle but increases as the yaw angle increases in addition to reducing the power off axis operations also reduce the operating range of a turbine the model turbine with the shroud the design with the inlet experiences negligible performance loss in yaw operations compared to the unshrouded turbine the maximum reduction in performance of the model turbine with the shroud is 6 on average at the three reynolds numbers examined which is 17 less than the power reduction of the unshrouded turbine additionally the shroud keeps the operating range of the turbine unchanged cosine rules of the linear momentum theory for reduction in power and thrust of a yawed unshrouded turbine are validated using experimental results no such relations are available in the literature for shrouded turbines based on the experimental results of this study and in analogy to the linear momentum theory cosine relations are proposed for a shrouded turbine maximum power of the model turbine with the shroud and thrust at the maximum power are experimentally observed to decrease with cosine of the yaw angle for the model turbine with the diffuser maximum power and thrust at the maximum power are observed to decrease with cosine squared and cosine of the yaw angle respectively based on the cosine rules found in this study the turbine with the shroud in a 45 yawed flow generates 29 less power than in an inline flow the turbine with the diffuser produces 50 less power and the unshrouded turbine based on the cosine cubed rule of the momentum theory generates 65 less power in the same flow the well designed inlet of the shroud is capable of compensating the effect of yawed inflow that results in the better performance of the shroud over the diffuser this characteristic of the shroud is expected to be a function of the yaw angle and is anticipated to alter in higher yaw angles as the inlet angle of the shroud is close to the maximum yaw angle investigated more experiments are needed to validate extended range of applicability for the proposed relations author contribution section mohammad shahsavarifard investigation methodology formal analysis validation writing original draft eric louis bibeau conceptualization supervision writing review editing funding acquisition resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement support for this research is provided by the nserc manitoba hydro chair in industrial alternative energy authors would like to acknowledge the assistance of ali shahsavarifard as well as the support of tom molinski and jeff blais from manitoba hydro 
22169,during operations river and tidal hydrokinetic turbines encounter changes in flow direction that decrease their performance evaluating hydrokinetic turbines in yaw conditions contributes to estimating turbine performance power stability and power delivered to the grid water tunnel tests using a 19 8 cm diameter horizontal axis model turbine in yaw operation show the performance reduction using three designs no shroud a convergent divergent shroud and a diffuser shroud experimental results obtained at three reynolds numbers of 1 38 105 1 77 105 and 2 17 105 show that the output power decreases in off axis flows for all designs investigated the reduction is initially negligible up to a 10 yaw angle but then increases with increasing the yaw angle the convergent divergent shroud experiences significantly less performance loss compared to the other two designs the maximum performance loss of the convergent divergent shroud design is 6 on average for the reynolds numbers investigated based on the experimental results and in analogy to the linear momentum theory cosine cubed rule we propose new cosine relations for shrouded turbines in yaw operations depending on the shroud s geometry the maximum power of a shrouded turbine decreases either with the cosine or the cosine squared of the yaw angle keywords hydrokinetic turbine shroud yaw angle performance reduction cosine relation 1 introduction a wind turbine rotor in a turbulent atmospheric boundary layer is almost always in yawed flow conditions smulders et al 1981 rapid variations occur in wind direction and velocity causing wind turbine controls to lag thus for a wind turbine yaw operations are more usual than inline operations van bussel 1994 it is common for a wind turbine to operate at yaw angles as large as 30 for several minutes hansen and butterfield 1993 furthermore a wind turbine that encounters relatively high rates of yaw misalignment experiences fatigue loads induced by gyroscopic moments that could lead to failure lynette 1988 concluded that turbine damages caused by yaw misalignment is the second cause of wind turbine downtime as yaw operation results in a skewed wake modifies induced velocity patterns and produces cyclic changes in the blade angle of attack this situation leads to dynamic stall and variable loading on the rotor blade resulting in a loss of yaw stability leading to excessive induced loads on the rotor and turbine structure hansen 1992 similarly a hydrokinetic turbine encounters changes in flow direction of rivers and oceans affecting the performance like for wind turbines evaluating hydrokinetic turbines in yawed flow conditions is important to predict performance and power stability in off axis flows moreover long term flow direction variations attributed to surface ice for example have been reported when testing hydrokinetic turbines on the winnipeg river birjandi et al 2015 field observations from a site off the welsh coast indicate the majority of currents tend to fall within 20 of the principal flow direction for economically viable velocities frost et al 2017 the effect of yaw angle thus plays an important role in designing yaw control mechanisms for shroud designs to optimize the performance of hydrokinetic turbines boorsma 2012 this role is more pronounced for a floating turbine where a yaw control mechanism is more complicated than for a fixed turbine krogstad and adaramola 2012 understanding the effect of yaw angle on the performance of hydrokinetic turbines is necessary for designing turbines operating in river and ocean environments a comprehensive literature review on the effect of yaw angle on the performance of kinetic turbines shahsavarifard 2015 reports diverse effects similar to wind applications that review concludes there is no conclusive study that identifies the effect of yaw angle on the performance of hydrokinetic turbines yaw angle also plays an important role in the performance of wind turbine farms and hydrokinetic turbine arrays deflection of wake of the first row turbines in a farm could benefit the operation of downstream turbines and increase the farm overall power output adaramola and krogstad 2011 mckay et al 2013 performance evaluation in yaw operations has been part of on going wind turbines research smulders et al 1981 measured power and thrust force of a 20 cm diameter two bladed horizontal axis wind turbine in off axis operations in an open 50 cm by 50 cm wind tunnel they found for yaw angles as high as 45 the optimum tip speed ratio does not change while the power coefficient decreases significantly they observed that performance coefficient shows cosine cubed dependence to the yaw angle as predicted by the linear momentum theory burton et al 2001 the cosine cubed dependence of the performance to the yaw angle was also observed by schumack 1979 in experiments on a different turbine design anderson et al 1982 performed wind tunnel and field experiments on a 3 m diameter two bladed horizontal axis wind turbine with blades having a naca 4412 airfoil profile the turbine had a 12 blockage ratio which was corrected using the glauert 1947 relation as this correction is shown to be adequately accurate for small blockage ratios willmer 1979 they observed that power coefficient in yaw operation decreases with the cosine cubed of the yaw angle which was in agreement with the linear momentum theory grumman aerospace corporation conducted extensive research on diffuser augmented wind turbines foreman et al 1983 foreman and gilbert 1983 they performed experiments using a baseline diffuser and a two bladed 45 7 cm diameter turbine to assess the performance of diffuser augmented wind turbines in yawed flow conditions the baseline diffuser was a straight wall diffuser with a 60 included angle and had an exit area ratio of 2 78 and a length to diameter ratio of 0 5 they found the unshrouded wind turbine insensitive to yaw angles less than 30 but observed a sudden 80 increase in the turbine power at 30 yaw angle for the diffuser augmented wind turbine they observed negligible changes in the power up to 30 yaw angle followed by an abrupt reduction at 40 they believed their tests are inconclusive because the reason for the yaw insensitivity could not be explained grant et al 1997 conducted experiments on a 90 cm diameter horizontal axis wind turbine in an open jet wind tunnel two bladed and three bladed configurations of the turbine were tested power coefficients and wake of the turbine were examined using 0 to 30 yaw angles ratio of the maximum power coefficients in off axis flows to the maximum power coefficient without yaw were compared to experimental data of clayton and filby 1982 power coefficients in yaw operations from the two datasets closely follow the pattern of cosine cubed of the yaw angle the national renewable energy laboratory nrel conducted field measurements and wind tunnel experiments on a 10 m diameter two bladed horizontal axis wind turbine using s809 airfoil profile since 1987 a comprehensive set of wind tunnel experiments were performed on an instrumented wind turbine in the 24 4 m by 36 6 m nasa wind tunnel hand et al 2001 the experiments provided accurate quantitative aerodynamic and structural measurements on a wind turbine which geometrically and dynamically represents a full scale wind turbine power thrust pressure structural moments and loads are reported for yawed conditions results show the decreasing trend predicted by the linear momentum theory the maximum power coefficient decreases with the cosine cubed of the yaw angle while the thrust at the maximum power decreases with the cosine squared of the yaw angle maeda et al 2008 performed wind tunnel experiments and measured power and pressure distribution of a 2 4 m diameter horizontal axis wind turbine in yaw operations they present power and torque curves for a range of tip speed ratios and yaw angles in two directions identical performance coefficients were obtained for the two directions of yawing in the horizontal plane their results show that the ratio of power coefficients in yaw operations to the inline operation decreases with the cosine cubed of the yaw angle they report a small difference between experimental data and theory prediction at larger yaw angles adaramola and krogstad 2011 experimentally investigated the effect of a wind turbine wake on the performance of a downstream turbine in a wind turbine farm two 90 cm diameter three bladed horizontal axis wind turbines were used in wind tunnel experiments power and thrust curves of a single turbine obtained for a range of yaw angles were also published krogstad and adaramola 2012 in agreement with the linear momentum theory the measured power decreases with the cosine cubed of the yaw angle they measured the performance of a downstream turbine when placed at different distances from an upstream turbine operating in yaw conditions they observed that performance of the downstream turbine improves when the upstream turbine is yawed and is away from the optimum performance authors concluded that operating an upstream turbine at an appropriate yaw angle results in an increase in overall efficiency of a wind farm and consequently reduces the space requirement for the wind farm dou et al 2019 proposed a wake model to predict the turbine wake velocity distribution for given yaw angles the model was validated through wake measurements in yaw operation of previous experiments on a 20 cm diameter two bladed wind turbine in a wind tunnel and a three bladed 15 cm diameter hydrokinetic turbine in an open channel flow experiments showed the yaw operation of turbines not only results in reduction of the power and thrust but also deflects the downstream wake of the turbine the paper proposed an empirical function to calculate the skew factor in the yawed wake model with skew distribution authors expect the proposed wake model to improve the control and optimization strategies for wind farms and hydrokinetic power plants noura et al 2012 examined a 50 cm diameter three bladed horizontal axis wind turbine in a wind tunnel in agreement with previous studies and the linear momentum theory they also observed that the reduction of power in yawed flows is proportional to the cosine cubed of the yaw angle similarly tsalicoglou et al 2012 studied the effect of flow inclination on the performance of a wind turbine they conducted performance and flow field measurements on a 30 cm diameter three bladed turbine in a towing tank performance coefficients of the turbine at yaw angles up to 40 were measured and observed to decrease with the cosine cubed of the yaw angle smaller performance reduction was found in yawed flows with higher turbulence intensities they considered surface and blockage effects negligible based on a previous study barber et al 2011 barber et al 2011 stated the 7 1 blockage ratio in the experiments was less than the 7 5 limit introduced by barlow et al 1999 below which blockage correction is not required park et al 2016 performed computational fluid dynamics simulations on an 8 m diameter three bladed baseline turbine with naca 633 418 foil section to predict performance of a horizontal axis tidal stream turbine in off design conditions the cfd analyses considered effects of blade deformation and yawed inflow conditions the yawed flow simulations were validated using results of a towing tank experiment the performance of a baseline turbine were calculated at 0 5 and 10 yawed inflow conditions for the design tip speed ratio the influence of yawed inflow conditions on the turbine performance was found to be important for accurate power predictions in the design stages frost et al 2017 using computational fluid dynamics investigated the effects of misaligned flows on the performance of a tidal stream turbine the paper utilizes velocity data collected from a site off the welsh coast and compare the results to the performance parameters of a 10 m diameter horizontal axis tidal stream turbine the cfd modelling suggests a reduction in the turbine performance parameters as the yaw angle increases at 10 yaw angle a 7 drop was noted in the peak power compared to the inline flow dai et al 2018 investigated aerodynamic behaviour of wind turbines in yaw operation based on scada data they found that below the rated wind speed the output power decreases as the yaw angle increases close to and above the rated speed the effect of yaw on output power becomes weaker because of stronger pitch control effects authors believe that although much research on wind turbine yaw operation have been performed some issues due to the complexity of yaw operation need further investigations to address the uncertainty in the impact of yaw operations on hydrokinetic turbines we report on an experimental study of the effect of yaw angle on the performance of two shrouded horizontal axis hydrokinetic turbines the results are then compared with the equivalent unshrouded turbines as well as to the linear momentum theory results 2 test facility experiments were performed in a recirculating water tunnel facility at the university of manitoba the tunnel consists of a vertical flow loop configuration with a 61 cm wide by 183 cm long test section which allows a maximum 60 cm of water height in the test section a propeller pump circulates water in the tunnel and provides a maximum water velocity of 1 1 m s at the test section at full water height an upstream honeycomb breaks down vortices generated in the pump and reduces flow turbulence intensity at the test section to less than 3 at the maximum speed the test rig consists of a baseplate that sits on the two sides of the water tunnel upper rim and keeps the model turbine submerged at the center of the flow cross section it also secures the required instrumentation out of water the model turbine consists of a rotor blade secured to the turbine horizontal shaft a torque meter and a dc gear motor the turbine shaft aligns the rotor blade perpendicular to the flow direction one radius upstream of the support structure a connector piece around the turbine shaft enables replacing the shrouds the turbine shaft and connector piece are designed to axially place the rotor blade at the smallest cross sectional area of each shroud i e inlet of the diffuser and throat of the shroud the rotor blade is a 19 8 cm diameter three bladed h0127 wind turbine blade of kidwind project inc with a solidity of 0 13 geometric characteristics of a rotor blade and detail description of the model turbine and the test rig can be found in shahsavarifard et al 2015 a cad design of the test rig and model turbine with the diffuser installed is depicted in fig 1 two shroud designs were optimized and fabricated to study and compare effect of shrouds on the performance of the model turbine in inline and off axis operations one design is a convergent divergent duct manufactured in a rapid prototyping machine and is referred to as the shroud the other design is a straight wall duct machined out of an acrylic block and is referred to as the diffuser area ratio and half angle for the shroud and the diffuser were selected based on the studies available in the literature reviewed in shahsavarifard 2015 shahsavarifard et al 2015 schematic profiles and pictures of the shroud and the diffuser are depicted in fig 2 3 instrumentation a torque transducer and a load cell measure torque and thrust of the turbine rotor for the power curve range a generator and variable resistance configuration is often used to extract power from a turbine in water tunnel experiments limiting power capture at low tip speed ratios to obtain the performance curve for the entire span a dc motor is employed shahsavarifard et al 2015 the motor in this method drives the turbine at a constant speed with the torque transducer placed between the motor and the turbine as shown in fig 1 this arrangement enables measuring the rotor torque at any tip speed ratios the digital wave rotary torque transducer measures torque on the turbine shaft at a sampling rate of 200 hz to a maximum value of 5 n m the torque transducer has a rotational speed sensor that enables direct measurement of turbine power the miniature universal strain gauge load cell capable of measuring forces up to 100 n enables measurement of thrust force on the turbine rotor as shown in fig 3 in addition to torque and thrust measurements an acoustic doppler velocimetry adv probe measures the undisturbed flow velocity at the inlet of the water tunnel test section at a sampling rate of 200 hz 4 test procedure and data analysis measurements begin with the unshrouded model turbine at 0 7 0 9 and 1 1 m s water velocities flow velocities correspond to reynolds numbers of 1 38 105 1 77 105 and 2 17 105 based on the rotor diameter and the undisturbed water velocity turbulence intensity of flow calculated from adv measurements ranges from 2 06 to 2 89 the torque exerted by the water stream onto the turbine rotor is measured at each reynolds number drag force on the turbine structure is measured at each test velocity the thrust force on the turbine rotor at each tip speed ratio is then calculated by subtracting this drag force from the thrust acting on the turbine and structure test procedure is repeated for the model turbine with the shroud and then for the model turbine with the diffuser for the off axis flow experiments the model turbine is rotated about the vertical axis passing through the apex of the rotor s hub for the range of yaw angles from 5 to 25 in 5 increments yaw angle is the angle between the turbine axis and flow direction rotating the turbine about the specific axis discussed keeps the turbine at the center of the tunnel test section fig 4 shows the model turbine in a yaw experiment and the angle signs generated on a full scale drawing of the tunnel and marked on the tunnel rims for a given flow speed and rotor angular velocity measured torque and thrust are averaged and corrected for zero offset then tip speed ratio power and thrust coefficients are respectively calculated as follows 1 t s r r ω v 2 c p q ω 1 2 ρ a v 3 3 c t t 1 2 ρ a v 2 angular velocity of the turbine shaft is ω v is the flow velocity r is the radius and a the swept area torque and thrust of the model turbine are represented by q and t respectively these coefficients are calculated based on the rotor swept area and the undisturbed water velocity power and thrust coefficients as well as tip speed ratio are corrected for free surface proximity and blockage effects details of which are available in shahsavarifard et al 2015 as an example a typical thrust coefficient of 0 40 for the unshrouded model turbine at water velocity of 0 7 m s and 15 yaw angle results in 1 2 reduction in the tip speed ratio 2 3 reduction in the thrust coefficient and 3 4 reduction in the power coefficient accuracy of the torque transducer and the load cell in experiments are 0 25 of the full scale the adv measures flow velocity with an accuracy of 0 5 of the measured velocity 1 mm s accuracy in length measurements is 0 02 mm the expanded uncertainty for the power and thrust coefficients are calculated based on type a and type b standard uncertainty evaluations in accordance with jcgm 2008 the uncertainty of measurements for typical values of cp 0 55 and ct 0 80 for the model turbine with the shroud at water velocity of 1 1 m s and 5 yaw angle are as follows the power and thrust coefficients are cp 0 55 0 03 and ct 0 80 0 02 and the reported expanded uncertainty is based on the standard uncertainty multiplied by a coverage factor of 2 providing a level of confidence of approximately 95 for the purpose of clarity error bars are only added to selected figures 5 results and discussion experimental power and thrust coefficients for the shrouded and unshrouded model turbine in yaw operations are presented coefficients obtained in water tunnel experiments are calculated based on the blade swept area and are corrected for free surface proximity and blockage effects experiments were performed for the two possible directions of yaw rotation in the horizontal plane performance curves of the shrouded and unshrouded model turbine showed no sensitivity to the sign of the yaw angle results are for the unshrouded turbine turbine with the shroud and turbine with the diffuser the three configurations are respectively referred to as blade shroud and diffuser in the diagrams the experimental data for the shrouded and unshrouded model turbine in yaw operations is available in shahsavarifard and bibeau 2014 5 1 power coefficients fig 5 shows power coefficients of the shrouded and unshrouded model turbine for yaw angles of 0 to 25 performance coefficients are for 1 1 m s water velocity obtained in 5 increments and shown against the tip speed ratio power curves for 0 7 and 0 9 m s water velocities have similar shapes and can be found in shahsavarifard 2015 maximum power coefficients for the three configurations of the model turbine at 1 1 m s water velocity are summarized in table 1 it is apparent from the experimental results that the turbine performance decreases as the yaw angle increases reduction in the performance of the model turbine with respect to the inline operation is insignificant for yaw angles up to 10 the amount of power reduction gradually increases up to 25 yaw angle where the maximum reduction occurs maximum performance reduction for the unshrouded turbine the blade compared to zero yaw operation is 22 maximum reduction in the performance of the model turbine with the shroud and with the diffuser is 5 and 21 respectively compared to the inline performances the experimental results show that the shroud effectively reduces the influence of yaw angle on the turbine performance the diffuser has virtually no influence on reducing the effect of yaw angle on the performance fig 6 shows the relative decrease in the maximum performance of the shrouded and unshrouded model turbine at 25 yaw angle compared to the inline performance at the three water velocities the power decrease for the blade and the turbine with the diffuser are almost the same at a maximum of 3 difference this means the diffuser that has the most increasing effect on the inline performance of the model turbine shahsavarifard et al 2015 is unable to keep its high performance in yaw operations instead the model turbine with the shroud has the least performance loss in yaw operations the shroud effectively moderates the effect of yaw angle on the turbine performance maximum reduction in the performance of the model turbine with the shroud is 6 on average at the three reynolds numbers examined the model turbine with the shroud experiences negligible performance loss in yaw operations compared to the unshrouded turbine performance loss of the turbine with the shroud in yaw operations is on average 17 less than the power reduction of the unshrouded turbine the power curve shapes for the model turbine in yaw angle is similar to the performance curves in inline operations performance coefficients of the shrouded and unshrouded model turbine start from zero and increase with the tip speed ratio to achieve a maximum at a tip speed ratio of approximately four further increase in the tip speed ratio results in a descending power curve to zero at a tip speed ratio of approximately seven similar to the inline flow three regimes of operation are distinguished in the performance curves low tip speed ratio optimum tip speed ratio and high tip speed ratio regimes performance of the unshrouded turbine the blade and the model turbine with the diffuser is observed to decrease with increasing the yaw angle however performance curve of the model turbine with the shroud remains nearly unchanged with changes in the yaw angle at the three water velocities examined at 25 yaw angle performance curve for the model turbine with the diffuser falls close to the power curve with the shroud at the optimum power difference between the two curves is less than 10 at three water velocities investigated results show the inability of the diffuser in keeping the turbine power curve unchanged in yaw operations it is observed from fig 5 that the low tip speed ratio portions of the curves for the three turbine configurations overlap at each yaw angle this means the shroud and the diffuser are unable to enhance the turbine performance in the low tip speed ratio portion of the performance curve performance reduction in yaw operations has two main reasons first changes occur in the aerodynamic behavior of blades due to variations of the angles of attack and second the reduced projected swept area pedersen 2004 at the low tip speed ratio portion blades are in a deep stall mode schreck et al 2001 stall and not the yaw effect is the dominant phenomenon and a shroud is unable to push the blades out of stall phillips 2003 regardless of the operating yaw angle blades at low tip speed ratios are stalled due to high angles of attack in this situation a shroud is unable to make enough changes in the angles of attack required to alter the stall state increasing tip speed ratio reduces angles of attack and allows the blades to leave the stall in this situation stall may no longer be dominant and the yaw angle effect becomes the determinant factor from this point on the influence of yaw angle on reducing power coefficients of the shrouded and unshrouded turbine is observed at the optimum tip speed ratio blades operate at the highest lift to drag ratio and the turbine generates its maximum power at the high tip speed ratio portion of the curves low angles of attack and the consequent high drag may be responsible for the lower output power this is where a shroud is able to increase the angles of attack reduce the drag and enhance the turbine performance in inline operations in yaw operations however changes in aerodynamic characteristics of blades and reduction in the projected swept area due to increase in the yaw angles will reduce the lift force on the blades and hence the turbine power the shroud having a well designed inlet is able to moderate these effects and keep the power curve nearly unchanged the diffuser having no inlet fails to keep the performance unchanged and therefore the power curve of the model turbine with the diffuser falls close to the curve of the turbine with the shroud examination of the performance curves reveals another fact about yaw operations of a horizontal axis turbine runaway point of the unshrouded turbine occurs at a lower tip speed ratio than in the inline operation in other words not only the turbine performance decreases but also the operating tip speed ratio range of the turbine decreases in yaw operations this behaviour has been experimentally observed and reported for an unshrouded turbine krogstad and adaramola 2012 to investigate this characteristic in detail performance curves of the shrouded and unshrouded model turbine are shown in figs 7 9 where performance curves of the three turbine configurations are shown separately for the range of tip speed ratios at 1 1 m s water velocity similar curves for 0 7 and 0 9 m s water velocities can be found in shahsavarifard 2015 a common aspect in these figures is that the low tip speed ratio portion of the curves shows no sensitivity to the yaw angle irrespective of the turbine configuration this has been reported in the literature for an unshrouded turbine noura et al 2012 fig 7 shows the performance curves of the unshrouded turbine in yaw operations in which three features are observed first the overlap of the low tip speed ratio portion of the curves explained previously second the reduction in the maximum power coefficient of the turbine in yawed flows is apparent changes in the blades angles of attack due to the yaw angle makes the rotor blade operate away from the optimum tip speed ratio and subsequently the optimum angle of attack maeda et al 2008 the larger the yaw angle is the farther the blades are from the optimum angle of attack and the less power the turbine generates third as the yaw angle increases the runaway point moves to the left and to a lower tip speed ratio this results in a narrower operating range of the turbine further reduction in the angles of attack causes an increase in the drag force on the blades and results in a runaway point at a smaller tip speed ratio tsalicoglou et al 2012 reduction of the projected swept area in yaw operations is also a determinant factor for the optimum and high tip speed ratio portions of the curves pedersen 2004 as yaw angle increases the projected area decreases and this adds to the effect of the reduced angles of attack and decreases the output power further operating a hydrokinetic turbine in yaw conditions not only reduces its performance but also narrows its operating range this process intensifies as yaw angle increases the reason for the performance loss with increasing yaw angle is that it changes the effective flow velocity component and angles of attack on the blades altering the aerodynamic characteristics of blades this results in a reduced lift force on the blades and consequently a reduced power of the turbine burton et al 2001 in addition the projected swept area of a turbine in a yawed position is reduced compared to the inline flow therefore the effective inlet area to the rotor blade facing the incoming flow is also reduced for the turbine grant et al 1997 maeda et al 2008 these are the two main causes for performance reduction of a turbine in yaw operations a shroud capable of eliminating these effects is able to conserve the turbine performance in yaw operations fig 8 displays performance curves of the model turbine with the shroud in yaw operations the overlap of the low tip speed ratio portion of the curves due to stall is repeated here in contrast to the unshrouded turbine the rest of power curves for the turbine with the shroud overlap as well it is observed that the shroud keeps the optimum and high tip speed ratio portions of the curves nearly unchanged the maximum performance of the turbine in the inline operation is preserved in yaw operations with the shroud maximum reduction in performance of the turbine with the shroud compared to the inline operation is 8 occurring at 0 7 m s water velocity maximum reduction in 0 9 and 1 1 m s water velocities is 6 and 5 respectively in addition to conserving the maximum performance the shroud keeps the working range of the turbine nearly unchanged i e power curves in yaw operations have the same runaway points the shroud inlet is responsible for the invariant performance curves well designed inlet of the shroud is capable of compensating the effect of yawed inflow in reducing the angles of attack and projected swept area an inlet contraction also reduces the inflow asymmetry which is responsible for degrading the pressure recovery of a diffuser klein 1981 fig 9 shows performance curves of the model turbine with the diffuser in yaw operations the overlap of the low tip speed ratio portion of the curves due to stall seen for the unshrouded turbine and the turbine with the shroud is also repeated here the optimum tip speed ratio portion of the curves descends with increasing the yaw angle the diffuser is not able to prevent reduction of the turbine performance at the optimum portion of the curves however the diffuser reduces the effect of yaw angle on the high tip speed ratio portion of each curve resulting in the overlap of the curves in fig 9 the runaway point of the turbine with the diffuser also stays unchanged the diffuser is able to keep the operating range of the turbine fixed in yaw operations examination of figs 8 and 9 reveals different functions of the shroud and the diffuser on the turbine performance in yaw operations the shroud having a convergent divergent section keeps the optimum and high tip speed ratio portions of the power curves unchanged the diffuser having a divergent section keeps the high tip speed ratio part of the curves invariant it is concluded that the convergent section of a shroud and the inlet affects the optimum tip speed ratio portion of the performance curve in yaw operations the divergent section and exit are responsible for influencing the high tip speed ratio portion of the power curve and the runaway point the conclusion is expected to be true for optimally designed shrouds with carefully selected convergence and divergence angles 5 2 thrust coefficients fig 10 shows thrust coefficients of the shrouded and unshrouded model turbine in yaw operations at 1 1 m s water velocity it is observed that thrust coefficients decrease in yaw operations the reduction is small for yaw angles up to 10 but increases as the yaw angle increases skewness of the turbine wake as well as the reduction in the projected rotor area and the effective flow velocity result in the decrease of thrust coefficients krogstad and adaramola 2012 thrust force on a turbine rotor is directly transferred to the turbine structure and affects the design of the structure and anchoring system burton et al 2001 it is quite important to have estimations of the thrust force on a turbine as underestimating this force can result in failure in large scale deployments shahsavarifard et al 2014a 2014b thrust coefficient curves in yaw operations have similar shapes to the inline curves the curves demonstrate a consistent increasing trend where thrust force starts from a zero tip speed ratio when the turbine is stopped this is because the turbine has the least frontal area when the rotor blade is at rest and therefore has the minimum thrust force trust force then continuously increases as the tip speed ratio increases tong 2010 5 3 comparison to linear momentum theory 5 3 1 wind turbines experimental data the linear momentum theory uses simplified assumptions to predict the performance of an unshrouded turbine assumptions include inviscid fluid steady homogeneous and incompressible flow infinite number of blades for the turbine rotor and non rotating wake behind the turbine rotor this can be extended to a yawed turbine where the theory results in cosine functions of the yaw angle for the power and thrust of a turbine burton et al 2001 maximum power of an unshrouded kinetic turbine and its thrust at the maximum power are theoretically expected to decrease with cosine cubed and cosine squared of the yaw angle respectively the momentum theory uses ideal assumptions some of which are not applicable to a turbine in yaw operations burton et al 2001 therefore experimental verification is needed if theoretical results are to be used with confidence in assessing the performance of a yawed turbine or as control parameters in optimizing the output power of a wind turbine farm figs 11 and 12 compare experimental power and thrust of unshrouded wind turbines in yaw operations available in the literature with the cosine cubed and cosine squared rules of the linear momentum theory fig 11 shows the ratio of the maximum power in yaw angles to the maximum inline power a close agreement is seen between the experimental data and the line representing the cosine cubed of the yaw angle a maximum discrepancy of 10 is seen between experimental results of anderson et al 1982 at 30 yaw angle and the cosine cubed rule difference between the experimental and theoretical results is less than 10 for the other studies fig 12 shows the ratio of thrust at the maximum power in yaw angles to the thrust at the maximum power in inline operation a close agreement is also seen between the experimental data and the cosine squared line a maximum discrepancy occurs at 30 yaw angle for experimental results of national renewable energy laboratory hand et al 2001 the maximum difference is 5 and the discrepancy between the experimental and theoretical results is less than 5 for the other studies it is therefore concluded that the cosine cubed and cosine squared rules of the linear momentum theory are in close agreement with experimental results 5 3 2 the unshrouded model turbine it is so far shown that the linear momentum theory accurately predicts the decreasing behaviour of the power and thrust coefficients of an unshrouded kinetic turbine in yaw operations it is of interest to have such basic relations to predict performance reduction of a shrouded hydrokinetic turbine in yaw operations no such relations are available in the literature for shrouded turbines while having that relationship can benefit the marine renewable energy industry first the measured power and thrust coefficients of the unshrouded model turbine are compared to the linear momentum theory fig 13 depicts the ratio of the maximum power of the blade at yaw angles to the maximum inline power it is observed that the experimental data follows the cosine cubed of the yaw angle line the maximum difference between the experimental data and cosine cubed line is 4 1 occurring at a 25 yaw angle fig 14 shows the thrust ratio of the maximum power at yaw angles to the thrust at the maximum power without yaw the experimental data closely follows the cosine squared of yaw angle line with a maximum difference of 4 0 occurring at a 25 yaw angle therefore results of this study further confirm the results from previous experimental studies in the literature for unshrouded turbines i e the linear momentum theory can precisely predict the decreasing behaviour of the power and thrust coefficients of a hydrokinetic turbine in yaw operations the rules of cosine cubed and cosine squared of the yaw angle are adequately precise to predict the loss in the performance of hydrokinetic turbines in yaw operations 5 3 3 the model turbine with the shroud reduction in the power and thrust of the model turbine with the shroud is now examined fig 15 shows the ratio of the maximum power of the model turbine with the shroud at yaw angles to the maximum inline power lines of cosine and cosine cubed of the yaw angle are also shown it is observed that the experimental data closely follows the cosine of the yaw angle line maximum difference between the experimental data and the cosine line is 3 5 occurring at 25 yaw angle results show that the shroud effectively reduces the turbine power reduction from cosine cubed to cosine of the yaw angle fig 16 shows the ratio of the thrust at the maximum power at yaw angles to the thrust at the maximum power in inline operation the cosine and cosine squared lines of the yaw angle are also graphed the experimental data is observed to follow the cosine of the yaw angle line maximum discrepancy between the experimental data and the cosine line is 1 5 occurring at a 25 yaw angle the shroud decreases the reduction in the thrust of the model turbine from cosine squared to cosine of the yaw angle it is therefore concluded that the shroud effectively reduces the sensitivity of the model turbine performance to changes in the yaw angle based on the cosine rule experimentally observed the turbine with the shroud in a 45 yawed flow generates 29 less power than in an inline flow the unshrouded turbine based on the cosine cubed rule would produce 65 less power in the same flow 5 3 4 the model turbine with the diffuser reduction in the power and thrust coefficients of the model turbine with the diffuser is now examined fig 17 shows the ratio of the maximum power of the model turbine with the diffuser at yaw angles to the maximum inline power lines of cosine cosine squared and cosine cubed of the yaw angle are also shown it is observed that the experimental data is well predicted by the line of cosine squared of the yaw angle maximum difference between the experimental data and the cosine squared line is 5 3 at 25 yaw angle it is seen that the diffuser reduces the turbine power reduction from cosine cubed to cosine squared of the yaw angle fig 18 shows the ratio of the thrust at the maximum power at yaw angles to the thrust at the maximum power in zero yaw lines of cosine and cosine squared of the yaw angle are also graphed the experimental data is observed to narrowly follow the cosine of the yaw angle line maximum discrepancy between the experimental data and cosine line is 2 1 at 25 yaw angle the diffuser decreases the reduction in the thrust of the model turbine from cosine squared to cosine of the yaw angle the diffuser compared to the shroud is less effective in reducing the sensitivity of the model turbine power to the yaw angle based on the cosine squared rule the turbine with the diffuser in a 45 yawed flow generates 50 less power than in an inline flow the unshrouded turbine and the turbine with the shroud would produce 65 and 29 less power in the same flow 5 4 verification of the cosine rules for shrouded turbines the cosine rules for shrouded turbines obtained from the experimental results have not been reported in the literature experimental studies available in the literature on shrouded turbines have excessive tunnel blockage resulting in elevated power coefficients in yaw operations phillips 2003 this renders the results of such studies less reliable the only reliable study for verification is the experimental study by phillips et al 1999 performed on a diffuser augmented wind turbine in a wind tunnel the shroud used in their experiment is a duct comparable to the shroud of the present study with an optimized airfoil shaped converging diverging cross section fig 19 shows the ratio of the maximum power of this diffuser augmented wind turbine at yaw angles to the maximum inline power the experimental data is observed to be in a close agreement with the cosine of the yaw angle line maximum discrepancy between the experimental data and cosine line is 5 7 at 30 yaw angle this verifies the cosine rules proposed in the current study for the shrouded model turbine as the shrouds used in the two studies are similar having convergent divergent cross sections it is therefore concluded that the cosine rules introduced in this study remain valid for similar optimally designed shrouded turbines in the range of the yaw angles investigated 5 5 velocity at the rotor plane power of an ideal hydrokinetic turbine in theoretical studies is calculated by multiplying thrust of the turbine and flow velocity at the rotor disk burton et al 2001 having the cosine rules for power and thrust of the model turbine in yaw operations allows for deducing changes in the flow velocity at the rotor plane table 2 summarizes the cosine rules for shrouded and unshrouded turbines in yaw operations for the blade it is clear from the momentum theory that power and thrust are proportional to cosine cubed and cosine squared of the yaw angle flow velocity at the rotor plane is deduced to be proportional to cosine of the yaw angle this is obvious as the momentum theory starts deriving the yaw performance of a turbine by using the normal component of the flow velocity to the rotor disk i e the cosine component power and thrust of the model turbine with the diffuser are proportional to cosine squared and cosine of the yaw angle respectively flow velocity at the rotor plane is therefore proportional to cosine of the yaw angle same as unshrouded turbines the effect of the diffuser on the power of the model turbine is therefore due to the influence it has on the thrust force and not on the velocity power and thrust of the model turbine with the shroud are proportional to cosine of the yaw angle flow velocity at the rotor plane hence remains unchanged compared to the inline flow operation comparing the shroud and the diffuser shows that the additional effect of the shroud on the power is due to the influence it has on the flow velocity at the rotor plane advantage of the shroud over the diffuser is the ability of its inlet in eliminating the effect of yaw angle on the flow velocity at the rotor plane the inlet of the shroud with its optimum convergent design bends the flow streamlines and keeps them normal to the rotor plane therefore velocity vectors and not just the cosine components of the velocity remain normal to the rotor plane same as the inline flow this characteristic of the shroud is expected to be a function of the yaw angle and is anticipated to alter in higher angles as the inlet angle is close to the maximum yaw angle investigated in the experiments table 2 is useful to help decide for a given application the role of a shroud and how it will be used to enhance the economics of a marine turbine 6 conclusions a 19 8 cm diameter horizontal axis hydrokinetic turbine and two shrouds were designed fabricated and experimentally tested in the water tunnel facility at the university of manitoba tests aimed to study the effect of shroud on the performance of a hydrokinetic turbine in off axis flow conditions consistent power and thrust coefficient curves for the shrouded and unshrouded turbines were obtained for the range of the performance curve free surface proximity and blockage effects were corrected using a one dimensional actuator disk model it is experimentally observed that the output power of a hydrokinetic turbine decreases in off axis operations compared to the inline operations the reduction is negligible up to 10 yaw angle but increases as the yaw angle increases in addition to reducing the power off axis operations also reduce the operating range of a turbine the model turbine with the shroud the design with the inlet experiences negligible performance loss in yaw operations compared to the unshrouded turbine the maximum reduction in performance of the model turbine with the shroud is 6 on average at the three reynolds numbers examined which is 17 less than the power reduction of the unshrouded turbine additionally the shroud keeps the operating range of the turbine unchanged cosine rules of the linear momentum theory for reduction in power and thrust of a yawed unshrouded turbine are validated using experimental results no such relations are available in the literature for shrouded turbines based on the experimental results of this study and in analogy to the linear momentum theory cosine relations are proposed for a shrouded turbine maximum power of the model turbine with the shroud and thrust at the maximum power are experimentally observed to decrease with cosine of the yaw angle for the model turbine with the diffuser maximum power and thrust at the maximum power are observed to decrease with cosine squared and cosine of the yaw angle respectively based on the cosine rules found in this study the turbine with the shroud in a 45 yawed flow generates 29 less power than in an inline flow the turbine with the diffuser produces 50 less power and the unshrouded turbine based on the cosine cubed rule of the momentum theory generates 65 less power in the same flow the well designed inlet of the shroud is capable of compensating the effect of yawed inflow that results in the better performance of the shroud over the diffuser this characteristic of the shroud is expected to be a function of the yaw angle and is anticipated to alter in higher yaw angles as the inlet angle of the shroud is close to the maximum yaw angle investigated more experiments are needed to validate extended range of applicability for the proposed relations author contribution section mohammad shahsavarifard investigation methodology formal analysis validation writing original draft eric louis bibeau conceptualization supervision writing review editing funding acquisition resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement support for this research is provided by the nserc manitoba hydro chair in industrial alternative energy authors would like to acknowledge the assistance of ali shahsavarifard as well as the support of tom molinski and jeff blais from manitoba hydro 
