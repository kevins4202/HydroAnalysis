index,text
24400,soil organic carbon soc plays a crucial role in physical chemical and biological soil properties and maintains the sustainability of cropping systems however soc stocks in croplands decline due to lower carbon inputs and faster decomposition rates therefore sustainable soil management ssm practices are crucial to replenish the carbon inputs mapping carbon c stocks and sequestration potential allows determination of soc stock level and identifies potential areas for improvement in lesotho the quantile random forest model determined soc stock spatial distribution for top 0 to 30 cm soil data from 161 profiles and environmental covariates were used to predict soc concentration bulk density and coarse fragments which together with soil depth helped determine soc stock density averaging 64 76 25 59 mg c ha 1 the soc stock was used as an input in soc potential determination then soc sequestration potential was determined using soil management and climate layers as inputs in the rothamsted carbon model rothc for three ssm practices and business as usual bau for bau ssm1 ssm2 and ssm3 0 5 10 and 20 carbon inputs were added respectively the attainable soc stocks after 20 years were 67 02 67 76 68 49 and 69 65 mg c ha 1 with uncertainty of 22 69 and 26 13 for bau and respective ssm scenarios despite the projections showing annual mean gain of soc stocks for bau of 0 11 mg c ha 1 per year there are losses in other regions thus as shown that in ssm the losses are reduced while the gains increase their use is advised the establishment of research areas which can be used for monitoring soc stock levels and research on ssm are a major priority keywords sequestration carbon stock lesotho rothc cropland digital soil mapping data availability data will be made available on request 1 introduction the soc is held in the soil in the form of organic matter and stored as humus which is a stable form of organic carbon cantab 2009 which has a residence time of hundreds to thousands of years the soc content in croplands is important in soil fertility and food security moreover it mitigates climate change as a major sequester of carbon zhao et al 2018 the source of soc is the organic material which contains 58 percent of organic c brady and weil nc 2017 soil organic carbon plays a crucial role in maintaining sustainability of cropping systems by improving soil structural stability promoting aggregate formation for good aeration high water infiltration and water holding capacity as well as soil chemical and biological properties to support plant growth soil with high soc has high retention capacities which retain nutrients against leaching losses pluske et al 2015 however soc is dynamic and the soil can be a sink or source of atmospheric c through accelerated soc mineralization depending on the land use types and management practices phuntsho 2016 the amount of organic c stored per unit area of land surface referred to as soc stock is rapidly decreasing in croplands schillaci and braun 2015 dignac et al 2017 brady and weil nc 2017 globally croplands store more than 140 pg c in the top 30 cm of soil zomer et al 2017 the rapid decrease in c stocks in cultivated soils can be explained by the generally lower c inputs and faster mineralization rates due to more intense tillage which further mixes deeper soil horizons and partly destroys the aggregation schillaci and braun 2015 dignac et al 2017 the balance between c gains and losses is mainly from crop residues decomposition by microorganisms álvaro fuentes et al 2012 the croplands are estimated to have lost between 50 and 78 pg of c globally due to tillage crews and rumsey 2017 this amount also represents the attainable c that can theoretically be achieved with changes in management under a given vegetation type and climate conditions ingram and fernandes 2001 zomer et al 2017 morais et al 2019 the attainable amount is calculated using climate variables soil conditions as well as current crop yields sommer and bossio 2014 kwon et al 2017 fao 2020 any management which increases c input will tend to increase the attainable level to nearer the potential level ingram and fernandes 2001 conservation practices like cover crops reduced and no till adoption and residue management chambers et al 2016 can increase soc stocks sequestration rates due to management practices in croplands and grasslands are usually in the range of 0 2 0 8 mg c ha 1 year 1 fao 2020 these management practices normally referred to ssms according to fao nc 2017 are defined as integral part of sustainable land management as well as a basis for addressing poverty eradication agricultural and rural development promoting food security and improving nutrition therefore ssm is a valuable tool for climate change adaptation and a pathway for safeguarding key ecosystem services and biodiversity and the adoption generates multiple socioeconomic benefits various means of reporting for changes in soil c stocks have been proposed and used over time using geostatistics mishra et al 2009 thompson et al 2012 dorji et al 2014 omuto and vargas 2015 yigini and panagos 2016 digital soil mapping dsm is a geostastistical tool that creates spatial soil information systems lagacherie and mcbratney 2006 it uses statistical tools to quantify the spatial relationship between soil property values to its environmental covariates hounkpatin et al 2018 identified the factors that affect soc stocks used as covariates to include climatic and topographic elements land use and physical soil characteristics the major advantages of the dsm are that it is objective systematic repeatable updatable and represents an optimal expression of statistically validated understanding of soil environmental relationships in terms of the currently available data hengl and macmillan 2019 various approaches exist in literature kriging regressional kriging and machine learning algorithms for soil mapping based on regression including random forest rf gradient boosting machine gbm cubist generalized boosted regression models support vector machines and the extreme gradient boosting among others hengl and macmillan 2019 recent developments on geostatistical models estimate soc turnover and the most used models are the introductory carbon balance method icbm rothc morais et al 2019 century carbon and nitrogen dynamics candy and c tool farina et al 2013 borrelli et al 2016 põllumuldade et al 2016 poeplau et al 2017 morais et al 2019 however rothc is preferred because of its readily available data requirements farina et al 2013 the rothc model was developed for non waterlogged soils in arable soils and later expanded to grasslands and forests morais et al 2019 it estimates soc sequestration using soil characteristics clay content land cover land use and vegetation cover and climate precipitation evapotranspiration and temperature gottschalk et al 2012 mapping soil carbon is useful to provide a baseline c level and assist resources management and monitoring kõlli et al 2009 hong et al 2020 identification of areas and systems that have a greater potential to increase soc stocks in the croplands is essential lesotho intends to increase her soc stock by 1 in 2030 according to the ministry of forestry range and soil conservation mfrsc nc 2017 the aims of this study are i to determine the soc stocks levels in the croplands of lesotho and ii to identify potential areas for improvement 2 materials and methods 2 1 study area lesotho lies 29 36 36 south of equator and 28 14 1 east of greenwich prime meridian the country is divided into four agro ecological zones aez characterized by different elevations fig 1 and have distinct agro climate the four aez are lowlands foothills senqu river valley and mountain zones the climate of the country is temperate with cool to cold winters and hot wet summers with mean annual rainfall of 788 mm and varies from less than 300 mm in the western lowlands to 1600 mm in the north eastern highlands lms 2021 temperatures are highly variable on diurnal monthly and annual time scales normal monthly winter minimum temperatures range from 6 3 c in the highlands to 5 1 c in the lowlands however extremes of monthly mean winter minimum temperatures of 10 7 c can be reached and daily winter minimum temperatures can drop as low as 21 c sub zero daily minimum temperatures can be reached even in summer both in the lowlands and in the highlands mean annual temperature range from 15 2 c in the lowlands to 7 c in the highlands january records the highest mean maximum temperatures throughout the country ranging from 20 c in high altitudes to 32 c in the lowlands on the other hand mean minimum temperatures of around 0 c are common in june the coldest month with the lowlands recording the monthly mean temperatures ranging from 3 c to 1 c in the lowlands and ranging from 8 5 c to 6 c in the highlands 2 2 data source 2 2 1 soil data the soil data for the study was taken from the lesis national soil survey 2018 lesis 2018 the survey points included 161 profiles generated randomly from the baseline soil map office of soil survey 1979 and landform map directorate of overseas surveyors 1969 using r software omuto 2016 a total of 516 soil samples were collected at four standard depths 0 20 20 40 40 60 and 60 80 cm from 161 profiles the used information from the database included profile depth soc concentration coarse fragments content and soil bulk density the properties were determined using standard laboratory procedure soc concentration by dry combustion using leco analyser cn 628 at 1050 c santi et al 2006 bulk density by core method blake and hartge 1986 and coarse fragments by sieving and weighing particle diameter larger than 2 mm to allow comparison with other studies since a fixed target depth of 30 cm is required for gsoc fao 2018 data were converted to a standardized top 0 to 30 cm depth using equal area splines carvalho et al 2019 the vertical distribution of soc concentration coarse fragments and bulk density in the soil profiles was modeled with mass preserving equal area quadratic splines and a weighted average value of the properties was derived for 0 to 30 cm soil depth soc stock of the top 0 30 cm soil depth was calculated according to equation 1 1 s o c s t o c k s o c c o n c e n t r a t i o n b u l k d e n s i t y d e p t h c o a r s e f r a g m e n t s where soc stock mg c ha 1 soc concentration soil bulk density g cm 3 coarse fragments and depth the given soil layer thickness m 2 2 2 environmental covariates to fulfill all aspects of the scorpan model a list of environmental covariates was generated table 1 that were input data for soil prediction to represent soil and the related environmental factors in a spatial context and express these relationships quantitatively mcbratney et al 2003 proposed the scorpan model where soil as either soil classes or soil attributes at a point in space and time is an empirical quantitative function of seven environmental covariates soil s climate c organisms o relief r parent material p age a and spatial location n the meteorological data mean annual rainfall minimum and maximum temperatures from 1980 to 2015 were obtained from lesotho meteorological services lms 2018 and was interpolated to a 100 m resolution across the study area the land cover data was obtained from land cover atlas lesotho nc fao 2017 from which the cropland area was extracted soil map units was taken from the major soil subgroup world resource base wrb from the 1 250 000 soil map lesis 2018 the digital elevation model dem was downloaded from shuttle radar topography mission strm elevation data portal http earthexplorer usgs gov available on july 24 2019 and analysed using the system for automated geoscientific analysis saga for terrain attributes except for the normalized difference vegetation indices ndvi which were obtained from both moderate resolution imaging spectroradiometer modis and landsat operational land imager oli and re sampled to the 90 m resolution grid all other indices were derived from the latter the topographic vegetation and climatic data limits together with spectral bands and remote sensing attributes are shown in table 1 2 3 geospatial data analysis 2 3 1 soil organic carbon stock soil organic carbon stock was determined using soil data and environmental covariates descriptive statistics were computed for soc concentration bulk density and coarse fragments for the 0 30 cm soil depth these included minimum maximum mean range and uncertainty at 95 environmental datasets were harmonized by removing the na values and carrying out normality tests the asymmetrical data was normalized using either square root or logarithm transformation principal component analysis was used to remove collinearity between remote sensing indices and to select model predictors perez 2017 upreti 2017 the regmodel suite function in r software was used to assess different models and select the best regression method 2 3 2 machine learning methods and geostatistical approach ten machine learning approaches were tested 1 linear model glm nelder 1977 random forest rf breiman 2001 support vector machine svm vapnik 2000 boosting generalized linear model bglm classification and regression tree with bagging bcart breiman 1996 cubist quinlan et al 1993 classification and regression tree cart breiman et al 1984 ranger random forest ranger wright and ziegler 2017 quantile regression forest qrf vaysse and lagacherie 2017 and quantitative neural network qnr bagheri bodaghabadi et al 2015 cubist rf qrf ranger cart and bcart are decision tree algorithms that differ based on their ways of dealing with variance reduction padarian et al 2020 rf and cubist are widely used for dsm purposes and are well described in the literature grey et al 2016 pouladi et al 2019 shahbazi et al 2019a while qrf is an improvement on rf vaysse and lagacherie 2017 and can provide more accurate and more interpretable predicted patterns of uncertainty for each node and each tree rf keeps only the mean of the observations that fall into this node and neglects all other information whereas qrf considers the spread of the response variable from which prediction intervals are constructed the ranger was developed as an independent platform and modular framework for the analysis of high dimensional data with rf wright and ziegler 2017 the classification and regression trees cart breiman et al 1984 identifies optimum break points within predictor variables separating them in groups inside which the values of the dependent variable are as homogeneous as possible bcart is an algorithm that reduces the variation of a mathematical learning method as a general procedure keskin et al 2019 the svm differs from decision tree methods because it uses kernel functions converting their linear non separable issues into separable ones bishop 2006 franklin 2005 anns are flexible computational networks that can be used to describe complex non linear relationships between related variables ripley 1996 the qnn is a type of artificicial nueral network are flexible computational networks that can be used to describe complex non linear relationships between related variables which is also a group of functions for fitting algorithms that makes no assumptions about the distribution of errors bagheri bodaghabadi et al 2015 the linear and bglm are the linear regression methods which aim to explain the spatial distribution of a quantitative soil variable dependent variable by means of a linear combination of predictors through the form of a regression equation patriche and ca 2006 the model evaluation parameters included mean error me root mean squared error rmse r squared r2 and nash sutcliffe model efficiency coefficient nse the me measures bias in the predictions positive or negative the rmse indicates the magnitude of error made on average while the r2 quantifies the fraction of the variation in the data that is explained by the prediction model the r2 ranges from 0 to 1 where 1 implies that all data is explained 100 explained nse is used to assess predictive power of the model and like r2 its maximum value is 1 omuto and viatkin 2020 high r2 and low rmse values indicate a good model prediction performance hong et al 2020 the models were trained using 85 of points data for calibration with 15 reserved for validation after an analysis was done using various proportions to see the change in variance and settled for this one which gave the least variance the selected models were used to develop soc concentration bulk density and coarse fragments maps at 250 m resolution the soc stock map for the whole country was generated from eq 1 distribution of soc in different agro ecological zones was analyzed using zonal statistics in qgis 2 3 3 soil organic carbon sequestration the rothc version 26 3 rothc morais et al 2019 was used to estimate soc sequestration gottschalk et al 2012 to produce a spatially explicit version of the rothc model that can generate soc sequestration maps a spatialized version developed by the gsp secretariat using an open source r environment based on the soilr fao 2020 was used the uncertainties were calculated based on the global soil organic carbon sequestration potential map gsocseq procedures fao 2020 the model works in two modes forward and reverse the forward mode determines the decomposition process of a known c input inert organic matter easily decomposable plant material resistant plant material microbial biomass and humified organic matter and the reverse mode calculates the potential annual input morais et al 2019 fao 2020 it predicts attainable soc fao 2020 described the three phases spin up warm up and forward in gsoc 1 5 where a condition and partition of the different pools and estimated attainable soc using four scenarios was estimated the soc stocks were simulated for business as usual bau and three adopted soil sustainable management ssm practices over a period of 2020 2040 twenty years was chosen because it is the retention period of sequestered c in the soil recommended by ippc chenu et al 2019 the spin up phase initialization with equilibrium runs approach is based on studies by smith et al 2007 and gottschalk et al 2012 in large scale studies where the standard procedure is to have a spin up period to initialize the model so the soil carbon pools are in approximate equilibrium with the initial conditions regarding soil and climate variables vegetation and land management the data set series used for climate data are 1981 2000 land cover 2000 2015 and soc stock 2018 this phase whose length simulation period needed to approach a steady state pool distribution can usually vary between 100 s to 1000s years fao 2019 is followed by warm up phase because the initial soc was generated from individual soc measurements taken over different periods a temporal harmonization of soc stocks was performed as a second initialization step to minimize differences in current soc stocks at year 0 i e initial soc stocks at year 2020 and account for climatic variations in the 2000 2020 period since there are varying opinions about climatic futuristics prediction model the 2000 2018 time series data was used for the forward phase of the model for the estimation of attainable soc input data is given in table 2 climate data used to initiate the roth c model for lesotho was obtained from lms 2018 and included long term 1981 2018 average monthly rainfall mm open pan evaporation mm and temperature c and was interpolated to a 1 km resolution using worldclim data fick and hijmans 2017 however even though this data does not consider the future predictions which due to prevailing climate change are mostly to change it does allow achievement of the this study s objectives other site dependent variables included plant residue inputs modis derived net primary production npp 2000 2018 calculated using the miami model bernardi 2006 and clay content lesis 2018 cropland cover was obtained from land cover atlas lesotho nc fao 2017 and historic land cover 2000 2015 was sourced from european space agency esa climate change initiative land cover esa 2017 a very wide range of management practices are currently being implemented and can potentially be introduced into the world s agricultural systems depending on climatic soil socio cultural and economic conditions the attainable soc was simulated based on procedure by gottschalk et al 2012 and four conditions were set the bau where the inputs incorporated to soil were similar to the ongoing practices the low medium and high increase in c inputs estimated in the reverse mode for the ssm practices consisted the addition of 5 ssm1 10 ssm2 and 20 ssm3 to carbon inputs respectively the scenarios were selected based on socioeconomic situation of lesotho a developing country where maximum of 20 of soc addition is considered feasible batjes 2019 the potential maps were at 1 km resolution fig 2 3 results 3 1 harmonized data the soil data statistical summary of the top 0 30 cm depth is given in table 3 the soc concentration ranged from 0 28 to 8 02 with mean of 3 40 the average bulk density was 1 39 g cm 3 and showed low variability standard deviation of 0 17 g cm 3 and had a range of 0 94 g cm 3 the coarse fragments have a huge range where there were soils containing as little as 1 43 whereas there were those with 87 91 remote sensing indices that influence soc stock were analyzed by principal component analysis the scree plot fig 3 indicated the contribution of each principal component pc and showed that pc1 and pc2 explained 90 6 of the variation five pcs were selected that explain 99 6 variation table 4 3 2 soil organic carbon stock model evaluation table 5 provides statistical performance of different geostastical models for mapping soils overall the tree based models quantile regression forest qrf cubist and random forest rf performed better than all other models in different soil parameters with the lowest me and rmse and highest r2 and nse most studies have observed that the tree based models perform better than continuous parametric models such as support vector machine svm or simple linear regression model rudiyanto et al 2018 szatmári et al 2019 however qrf was selected with highest r2 of 0 988 0 946 and 0 932 for soc concentration soil bulk density and coarse fragments respectively the qrf model was used to estimate soc concentration bulk density and coarse fragments of the croplands area in lesotho the soc concentration mean was 3 40 with uncertainty of 0 3 and while the bulk density mean was 1 39 g cm 3 and 0 33 g cm 3 uncertainty the coarse fragments showed a mean of 45 96 with the highest uncertainty of 5 the assessment of the predicted map accuracy using randomly selected 85 of the data to build the model and 15 for validation showed bias of 0 11 0 00 and 0 62 for soc concentration bulk density and coarse fragments respectively table 7 this means there was underestimation of about 0 11 for soc concentration whereas coarse fragments were overestimated by 0 61 the coarse fragments map was the most accurate map with 91 of the variation explained and rmse of 0 70 followed by soc concentration and bulk density with 88 6 and 83 6 respectively the map with highest predictive power of the model was bulk density with nse of almost 1 0 997331 3 3 soil organic carbon stock mapping the croplands soc stocks ranged from 18 24 to 164 43 in the top 0 30 cm soil depth fig 4 with mean of 64 76 25 59 mg c ha 1 table 8 the obtained cropland soc stock is higher than the mean 61 2 mg c ha 1 reported by mfrsc nc 2017 in the country s c neutrality target the difference might be brought by the fact that the soc is estimated by intergovernmental panel on climate change ipcc good practice guidance for lulucf ipcc 2003 which differs from the method herein used globally cropland store about 10 of the total global soc pool with mean soc stock density of 81 61 mg c ha 1 in the top 30 cm of soil zomer et al 2017 while the east and southern africa average soc stock density is 53 mg c ha 1 mayer et al 2019 obtained a soc stocks of 71 7 3 47 mg c ha 1 in top 0 30 cm of agricultural soils in bavaria germany with similar temperate climate as lesotho soc stocks varied significantly across the agro ecological zones table 8 the higher soc stock is found in the mountain zone with altitude of 2400 m above sea level this region receive more rainfall as well as having low temperatures thus have high biomass accumulation low mineralization and therefore higher organic c content rantoa 2009 mapeshoane 2013 zhu et al 2019 the high stocks result from high rainfall and low temperatures which leads to a low decomposition rate and a thick organic layer reflects the greater influence of dense themeda triandra and festuca caprina climax vegetation schmitz and rooyani 1987 mapeshoane 2013 attributed the aboveground or root litter and exudates as responsible for higher accumulations of soc in the topsoil the lowlands zone have the lowest soc stocks this zone receives lower precipitation of about 400 mm per annum lms 2018 compared to 1000 mm per annum received in the mountain zones low precipitation results in low primary plant productivity and low inputs of c in the soil furthermore intensive tillage practices in the lowlands compared to minimal practices in the mountains contributes to high mineralization rates and high compaction and high bulk density zhang and schaap 2019 the foothills soc stocks range third only higher than the lowlands and lower than the senqu river valley despite receiving more rainfall than the latter and experiencing lower temperatures the difference but be borne by the fact that this region is more susceptible to the soil erosion because of its relief forms higher animal intensity where all crops leftovers are grazed by the animals after the lowlands the foothills experience more intensive tillage compared to the senqu river valley on the other hand the senqu river valley has a flatter terrain than the foothills and less intense tillage and therefore its soils are less prone to erosion and hence higher soc stocks than the other two aezs bar the mountains 3 4 model performance evaluation the linear regression of soc stocks obtained with the rothc model lesis 2018 data vs old samples data the fao soc stocks gsocmap1 5 0 fig 5 was highly significant with a 0 99 r2 the regression line was below the 1 1 line at lower soc stocks 50 mg c ha 1 indicating that rothc tended to overestimate soc stocks for these conditions on the contrary rothc tended to underestimate results at higher soc stocks similar results are reported by studdert et al 2011 in the study of the use of rothc to simulate changes of organic carbon stock in the arable layer of a mollisol of the southeastern pampas under continuous cropping in argentina 3 5 attainable soc stock the attainable soc stock is the one which can be achieved with changes in management and determines the potential areas for improvement the soc sequestration for the four scenarios attainable after 20 years is shown in table 9 the soc stock ranged from 18 40 to 165 53 mg c ha 1 under business as usual scenario bau 18 57 to 167 61 mg c ha 1 under 5 additions 18 75 to 169 69 mg c ha 1 under 10 additions and 19 09 to 173 82 mg c ha 1 if 20 additions are made annually the mean of soc sequestration under bau is 67 02 mg c ha 1 with the uncertainty of 22 69 while under sustainable management practices the soc sequestration means are 67 76 68 49 and 69 65 mg c ha 1 with the uncertainty of 26 13 the projections show that if management remains the same there will be an annual mean gain of 0 11 mg c ha 1 soc stocks table 9 nonetheless there are areas expected to have a decline of up to 1 08 mg c ha 1 of soc stock if the status quo remains however if ssm practices are adopted the three scenarios show the decline reduced to 0 99 0 91 or even 0 73 mg c ha 1 soc stock for ssm1 ssm2 and ssm3 respectively globally gottschalk et al 2012 in their study on how will organic c stocks in mineral soils evolve under future climate found that there is an overall global increase in soc stocks by 2100 under all scenarios but with a different extent of increase among the climate model and emissions scenarios they attribute the change to a warming climate under which there are increases both in c inputs to the soil due to higher npp and in soc losses due to increased decomposition if soil moisture is not the limiting factor similarly morais et al 2019 found that regardless of land use class in their study on detailed global modeling of soc in cropland grassland and forest soils high latitude regions display higher attainable soc stocks batjes 2019 reckons that in most cases measured c sequestration rates are less than 0 5 to 1 mg c ha 1 yr 1 for 20 years or plus chambers et al 2016 reported united states of america s annual sequestration as 0 3 to 0 5 mg c ha 1 for the croplands various agricultural practices that can increase carbon inputs have been reviewed dignac et al 2017 mfrsc 2019 measured rates of c sequestration by the adoption of best management practices for principal biomes are also available stockmann et al 2013 the spatial distributions of asr for all scenarios are shown in fig 6 while the agro ecological zones mean annual rates in the croplands are shown in fig 7 for all scenarios there is a similar pattern where there are higher sequestration rates in the lowlands foothills mountains and senqu river valley fig 7 in that order respectively meanwhile the foothills the mountains and senqu river valley are the aezs with areas showing more soc stocks losses fig 6 while in the lowlands the loss is concentrated along the mohokare river banks the soc stock loss in the other zones may be due to climate change and low crop yields wiesmeier et al 2016 verschuur et al 2021 observed that drought brought by abnormally low precipitations and high temperatures in recent years had negative influence on the maize yields in lesotho and south africa the situation would imply low biomass production while tillage is increasing the decomposition rate furthermore the rate of sequestration under sustainable management practice is higher in the lowlands than in other zones lowlands seemed to respond better to improved practices than all the other zones the gains observed in the lowlands are associated with the clay content lesis 2018 churchman et al 2020 indicated that clay content enhances soc sequestration zhong et al 2018 also observed a positive relationship between soc stocks and clay content under different climatic conditions in the topsoil layers of 0 20 cm the relative sequestration rates rsr which is the change in soc stocks over time relative to the business as usual scenario show the mean of 0 04 0 07 and 0 15 mg c ha 1 year 1 for ssm1 ssm2 and ssm3 practices respectively table 10 the relative change between the management scenarios and bau indicate the presence of a greater amount of soc under the improved management practice and sanderman and baldock 2010 attribute this to the conventional practice losing soc while the improved management practice lose soc at a smaller or insignificant rate these rates are similar to the expected rates according to simulation developed by fao 2020 4 conclusions monitoring and modeling spatial distribution of soc as input for decision making processes and global c cycle s studies and guiding is important the use of dsm using the qrf model for prediction of soc stock has enabled the spatial distribution determination of the soc stock for the top 0 to 30 cm and production of a croplands topsoil map of lesotho the average soc stock density 64 76 mg c ha 1 resembles those in regions having similar climatic conditions even though it is lower than the global mean of 81 61 mg c ha 1 the highest soc stock density is in the mountains while the lowlands contain the lowest density lowlands showed a higher potential for improvement since the lowlands soils showed a positive high response to sustainable management practices and they can assist in attaining carbon target soc stocks the lowlands are used for crop production thus provide a good benchmark for neutrality support actions however the attainable soc rates showed that soils are losing the soil carbon when they are used for cropping the lands are fragile such that any tillage operations reduce carbon storage moreover substantial amounts of carbon input should be added to the soil for such environments to store carbon the use of such lands for perennial fodder crops production may benefit the soil from high additions of organic matter by both grassroots exudates and above ground additions 5 recommendations this study used the existing climate data not the ipcc emissions scenarios and therefore the results though valid needs to be validated using some or all ipcc emissions scenarios however to achieve this nationally tailored solutions for both experiments and modeling are urgently needed to facilitate the identification of potential hotspots and coldspots of soc climate interaction such as those by jungkunst et al 2022 the authors suggest establishing coordinated experiments across all holdridge life zones to bridge scaling problems of climate impact on soc funding the study was funded by the author availability of data and material available code availability r code was developed using the r software free source authorship statement all persons who meet authorship criteria are listed as authors and all authors certify that they have participated sufficiently in the work to take public responsibility for the content including participation in the concept design analysis writing or revision of the manuscript furthermore each author certifies that this material or similar material has not been and will not be submitted to or published in any other publication before its appearance in the hong kong journal of occupational therapy authorship contributions please indicate the specific contributions made by each author list the authors initials followed by their surnames e g y l cheung the name of each author must appear at least once in each of the three categories below category 1 conception and design of study s j ramakhanna c t omuto and b e mapeshoane acquisition of data s j ramakhanna analysis and or interpretation of data s j ramakhanna and c t omuto category 2 drafting the manuscript s j ramakhanna revising the manuscript critically for important intellectual content c t omuto and b e mapeshoane category 3 approval of the version of the manuscript to be published the names of all authors must be listed s j ramakhanna b e mapeshoane and c t omuto declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements all persons who have made substantial contributions to the work reported in the manuscript e g technical help writing and editing assistance general support but who do not meet the criteria for authorship are named in the acknowledgements and have given us their written permission to be named if we have not included an acknowledgements then that indicates that we have not received substantial contributions from non authors supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 110052 appendix supplementary materials image application 1 image application 2 image application 3 image application 4 image application 5 image application 6 image application 7 
24400,soil organic carbon soc plays a crucial role in physical chemical and biological soil properties and maintains the sustainability of cropping systems however soc stocks in croplands decline due to lower carbon inputs and faster decomposition rates therefore sustainable soil management ssm practices are crucial to replenish the carbon inputs mapping carbon c stocks and sequestration potential allows determination of soc stock level and identifies potential areas for improvement in lesotho the quantile random forest model determined soc stock spatial distribution for top 0 to 30 cm soil data from 161 profiles and environmental covariates were used to predict soc concentration bulk density and coarse fragments which together with soil depth helped determine soc stock density averaging 64 76 25 59 mg c ha 1 the soc stock was used as an input in soc potential determination then soc sequestration potential was determined using soil management and climate layers as inputs in the rothamsted carbon model rothc for three ssm practices and business as usual bau for bau ssm1 ssm2 and ssm3 0 5 10 and 20 carbon inputs were added respectively the attainable soc stocks after 20 years were 67 02 67 76 68 49 and 69 65 mg c ha 1 with uncertainty of 22 69 and 26 13 for bau and respective ssm scenarios despite the projections showing annual mean gain of soc stocks for bau of 0 11 mg c ha 1 per year there are losses in other regions thus as shown that in ssm the losses are reduced while the gains increase their use is advised the establishment of research areas which can be used for monitoring soc stock levels and research on ssm are a major priority keywords sequestration carbon stock lesotho rothc cropland digital soil mapping data availability data will be made available on request 1 introduction the soc is held in the soil in the form of organic matter and stored as humus which is a stable form of organic carbon cantab 2009 which has a residence time of hundreds to thousands of years the soc content in croplands is important in soil fertility and food security moreover it mitigates climate change as a major sequester of carbon zhao et al 2018 the source of soc is the organic material which contains 58 percent of organic c brady and weil nc 2017 soil organic carbon plays a crucial role in maintaining sustainability of cropping systems by improving soil structural stability promoting aggregate formation for good aeration high water infiltration and water holding capacity as well as soil chemical and biological properties to support plant growth soil with high soc has high retention capacities which retain nutrients against leaching losses pluske et al 2015 however soc is dynamic and the soil can be a sink or source of atmospheric c through accelerated soc mineralization depending on the land use types and management practices phuntsho 2016 the amount of organic c stored per unit area of land surface referred to as soc stock is rapidly decreasing in croplands schillaci and braun 2015 dignac et al 2017 brady and weil nc 2017 globally croplands store more than 140 pg c in the top 30 cm of soil zomer et al 2017 the rapid decrease in c stocks in cultivated soils can be explained by the generally lower c inputs and faster mineralization rates due to more intense tillage which further mixes deeper soil horizons and partly destroys the aggregation schillaci and braun 2015 dignac et al 2017 the balance between c gains and losses is mainly from crop residues decomposition by microorganisms álvaro fuentes et al 2012 the croplands are estimated to have lost between 50 and 78 pg of c globally due to tillage crews and rumsey 2017 this amount also represents the attainable c that can theoretically be achieved with changes in management under a given vegetation type and climate conditions ingram and fernandes 2001 zomer et al 2017 morais et al 2019 the attainable amount is calculated using climate variables soil conditions as well as current crop yields sommer and bossio 2014 kwon et al 2017 fao 2020 any management which increases c input will tend to increase the attainable level to nearer the potential level ingram and fernandes 2001 conservation practices like cover crops reduced and no till adoption and residue management chambers et al 2016 can increase soc stocks sequestration rates due to management practices in croplands and grasslands are usually in the range of 0 2 0 8 mg c ha 1 year 1 fao 2020 these management practices normally referred to ssms according to fao nc 2017 are defined as integral part of sustainable land management as well as a basis for addressing poverty eradication agricultural and rural development promoting food security and improving nutrition therefore ssm is a valuable tool for climate change adaptation and a pathway for safeguarding key ecosystem services and biodiversity and the adoption generates multiple socioeconomic benefits various means of reporting for changes in soil c stocks have been proposed and used over time using geostatistics mishra et al 2009 thompson et al 2012 dorji et al 2014 omuto and vargas 2015 yigini and panagos 2016 digital soil mapping dsm is a geostastistical tool that creates spatial soil information systems lagacherie and mcbratney 2006 it uses statistical tools to quantify the spatial relationship between soil property values to its environmental covariates hounkpatin et al 2018 identified the factors that affect soc stocks used as covariates to include climatic and topographic elements land use and physical soil characteristics the major advantages of the dsm are that it is objective systematic repeatable updatable and represents an optimal expression of statistically validated understanding of soil environmental relationships in terms of the currently available data hengl and macmillan 2019 various approaches exist in literature kriging regressional kriging and machine learning algorithms for soil mapping based on regression including random forest rf gradient boosting machine gbm cubist generalized boosted regression models support vector machines and the extreme gradient boosting among others hengl and macmillan 2019 recent developments on geostatistical models estimate soc turnover and the most used models are the introductory carbon balance method icbm rothc morais et al 2019 century carbon and nitrogen dynamics candy and c tool farina et al 2013 borrelli et al 2016 põllumuldade et al 2016 poeplau et al 2017 morais et al 2019 however rothc is preferred because of its readily available data requirements farina et al 2013 the rothc model was developed for non waterlogged soils in arable soils and later expanded to grasslands and forests morais et al 2019 it estimates soc sequestration using soil characteristics clay content land cover land use and vegetation cover and climate precipitation evapotranspiration and temperature gottschalk et al 2012 mapping soil carbon is useful to provide a baseline c level and assist resources management and monitoring kõlli et al 2009 hong et al 2020 identification of areas and systems that have a greater potential to increase soc stocks in the croplands is essential lesotho intends to increase her soc stock by 1 in 2030 according to the ministry of forestry range and soil conservation mfrsc nc 2017 the aims of this study are i to determine the soc stocks levels in the croplands of lesotho and ii to identify potential areas for improvement 2 materials and methods 2 1 study area lesotho lies 29 36 36 south of equator and 28 14 1 east of greenwich prime meridian the country is divided into four agro ecological zones aez characterized by different elevations fig 1 and have distinct agro climate the four aez are lowlands foothills senqu river valley and mountain zones the climate of the country is temperate with cool to cold winters and hot wet summers with mean annual rainfall of 788 mm and varies from less than 300 mm in the western lowlands to 1600 mm in the north eastern highlands lms 2021 temperatures are highly variable on diurnal monthly and annual time scales normal monthly winter minimum temperatures range from 6 3 c in the highlands to 5 1 c in the lowlands however extremes of monthly mean winter minimum temperatures of 10 7 c can be reached and daily winter minimum temperatures can drop as low as 21 c sub zero daily minimum temperatures can be reached even in summer both in the lowlands and in the highlands mean annual temperature range from 15 2 c in the lowlands to 7 c in the highlands january records the highest mean maximum temperatures throughout the country ranging from 20 c in high altitudes to 32 c in the lowlands on the other hand mean minimum temperatures of around 0 c are common in june the coldest month with the lowlands recording the monthly mean temperatures ranging from 3 c to 1 c in the lowlands and ranging from 8 5 c to 6 c in the highlands 2 2 data source 2 2 1 soil data the soil data for the study was taken from the lesis national soil survey 2018 lesis 2018 the survey points included 161 profiles generated randomly from the baseline soil map office of soil survey 1979 and landform map directorate of overseas surveyors 1969 using r software omuto 2016 a total of 516 soil samples were collected at four standard depths 0 20 20 40 40 60 and 60 80 cm from 161 profiles the used information from the database included profile depth soc concentration coarse fragments content and soil bulk density the properties were determined using standard laboratory procedure soc concentration by dry combustion using leco analyser cn 628 at 1050 c santi et al 2006 bulk density by core method blake and hartge 1986 and coarse fragments by sieving and weighing particle diameter larger than 2 mm to allow comparison with other studies since a fixed target depth of 30 cm is required for gsoc fao 2018 data were converted to a standardized top 0 to 30 cm depth using equal area splines carvalho et al 2019 the vertical distribution of soc concentration coarse fragments and bulk density in the soil profiles was modeled with mass preserving equal area quadratic splines and a weighted average value of the properties was derived for 0 to 30 cm soil depth soc stock of the top 0 30 cm soil depth was calculated according to equation 1 1 s o c s t o c k s o c c o n c e n t r a t i o n b u l k d e n s i t y d e p t h c o a r s e f r a g m e n t s where soc stock mg c ha 1 soc concentration soil bulk density g cm 3 coarse fragments and depth the given soil layer thickness m 2 2 2 environmental covariates to fulfill all aspects of the scorpan model a list of environmental covariates was generated table 1 that were input data for soil prediction to represent soil and the related environmental factors in a spatial context and express these relationships quantitatively mcbratney et al 2003 proposed the scorpan model where soil as either soil classes or soil attributes at a point in space and time is an empirical quantitative function of seven environmental covariates soil s climate c organisms o relief r parent material p age a and spatial location n the meteorological data mean annual rainfall minimum and maximum temperatures from 1980 to 2015 were obtained from lesotho meteorological services lms 2018 and was interpolated to a 100 m resolution across the study area the land cover data was obtained from land cover atlas lesotho nc fao 2017 from which the cropland area was extracted soil map units was taken from the major soil subgroup world resource base wrb from the 1 250 000 soil map lesis 2018 the digital elevation model dem was downloaded from shuttle radar topography mission strm elevation data portal http earthexplorer usgs gov available on july 24 2019 and analysed using the system for automated geoscientific analysis saga for terrain attributes except for the normalized difference vegetation indices ndvi which were obtained from both moderate resolution imaging spectroradiometer modis and landsat operational land imager oli and re sampled to the 90 m resolution grid all other indices were derived from the latter the topographic vegetation and climatic data limits together with spectral bands and remote sensing attributes are shown in table 1 2 3 geospatial data analysis 2 3 1 soil organic carbon stock soil organic carbon stock was determined using soil data and environmental covariates descriptive statistics were computed for soc concentration bulk density and coarse fragments for the 0 30 cm soil depth these included minimum maximum mean range and uncertainty at 95 environmental datasets were harmonized by removing the na values and carrying out normality tests the asymmetrical data was normalized using either square root or logarithm transformation principal component analysis was used to remove collinearity between remote sensing indices and to select model predictors perez 2017 upreti 2017 the regmodel suite function in r software was used to assess different models and select the best regression method 2 3 2 machine learning methods and geostatistical approach ten machine learning approaches were tested 1 linear model glm nelder 1977 random forest rf breiman 2001 support vector machine svm vapnik 2000 boosting generalized linear model bglm classification and regression tree with bagging bcart breiman 1996 cubist quinlan et al 1993 classification and regression tree cart breiman et al 1984 ranger random forest ranger wright and ziegler 2017 quantile regression forest qrf vaysse and lagacherie 2017 and quantitative neural network qnr bagheri bodaghabadi et al 2015 cubist rf qrf ranger cart and bcart are decision tree algorithms that differ based on their ways of dealing with variance reduction padarian et al 2020 rf and cubist are widely used for dsm purposes and are well described in the literature grey et al 2016 pouladi et al 2019 shahbazi et al 2019a while qrf is an improvement on rf vaysse and lagacherie 2017 and can provide more accurate and more interpretable predicted patterns of uncertainty for each node and each tree rf keeps only the mean of the observations that fall into this node and neglects all other information whereas qrf considers the spread of the response variable from which prediction intervals are constructed the ranger was developed as an independent platform and modular framework for the analysis of high dimensional data with rf wright and ziegler 2017 the classification and regression trees cart breiman et al 1984 identifies optimum break points within predictor variables separating them in groups inside which the values of the dependent variable are as homogeneous as possible bcart is an algorithm that reduces the variation of a mathematical learning method as a general procedure keskin et al 2019 the svm differs from decision tree methods because it uses kernel functions converting their linear non separable issues into separable ones bishop 2006 franklin 2005 anns are flexible computational networks that can be used to describe complex non linear relationships between related variables ripley 1996 the qnn is a type of artificicial nueral network are flexible computational networks that can be used to describe complex non linear relationships between related variables which is also a group of functions for fitting algorithms that makes no assumptions about the distribution of errors bagheri bodaghabadi et al 2015 the linear and bglm are the linear regression methods which aim to explain the spatial distribution of a quantitative soil variable dependent variable by means of a linear combination of predictors through the form of a regression equation patriche and ca 2006 the model evaluation parameters included mean error me root mean squared error rmse r squared r2 and nash sutcliffe model efficiency coefficient nse the me measures bias in the predictions positive or negative the rmse indicates the magnitude of error made on average while the r2 quantifies the fraction of the variation in the data that is explained by the prediction model the r2 ranges from 0 to 1 where 1 implies that all data is explained 100 explained nse is used to assess predictive power of the model and like r2 its maximum value is 1 omuto and viatkin 2020 high r2 and low rmse values indicate a good model prediction performance hong et al 2020 the models were trained using 85 of points data for calibration with 15 reserved for validation after an analysis was done using various proportions to see the change in variance and settled for this one which gave the least variance the selected models were used to develop soc concentration bulk density and coarse fragments maps at 250 m resolution the soc stock map for the whole country was generated from eq 1 distribution of soc in different agro ecological zones was analyzed using zonal statistics in qgis 2 3 3 soil organic carbon sequestration the rothc version 26 3 rothc morais et al 2019 was used to estimate soc sequestration gottschalk et al 2012 to produce a spatially explicit version of the rothc model that can generate soc sequestration maps a spatialized version developed by the gsp secretariat using an open source r environment based on the soilr fao 2020 was used the uncertainties were calculated based on the global soil organic carbon sequestration potential map gsocseq procedures fao 2020 the model works in two modes forward and reverse the forward mode determines the decomposition process of a known c input inert organic matter easily decomposable plant material resistant plant material microbial biomass and humified organic matter and the reverse mode calculates the potential annual input morais et al 2019 fao 2020 it predicts attainable soc fao 2020 described the three phases spin up warm up and forward in gsoc 1 5 where a condition and partition of the different pools and estimated attainable soc using four scenarios was estimated the soc stocks were simulated for business as usual bau and three adopted soil sustainable management ssm practices over a period of 2020 2040 twenty years was chosen because it is the retention period of sequestered c in the soil recommended by ippc chenu et al 2019 the spin up phase initialization with equilibrium runs approach is based on studies by smith et al 2007 and gottschalk et al 2012 in large scale studies where the standard procedure is to have a spin up period to initialize the model so the soil carbon pools are in approximate equilibrium with the initial conditions regarding soil and climate variables vegetation and land management the data set series used for climate data are 1981 2000 land cover 2000 2015 and soc stock 2018 this phase whose length simulation period needed to approach a steady state pool distribution can usually vary between 100 s to 1000s years fao 2019 is followed by warm up phase because the initial soc was generated from individual soc measurements taken over different periods a temporal harmonization of soc stocks was performed as a second initialization step to minimize differences in current soc stocks at year 0 i e initial soc stocks at year 2020 and account for climatic variations in the 2000 2020 period since there are varying opinions about climatic futuristics prediction model the 2000 2018 time series data was used for the forward phase of the model for the estimation of attainable soc input data is given in table 2 climate data used to initiate the roth c model for lesotho was obtained from lms 2018 and included long term 1981 2018 average monthly rainfall mm open pan evaporation mm and temperature c and was interpolated to a 1 km resolution using worldclim data fick and hijmans 2017 however even though this data does not consider the future predictions which due to prevailing climate change are mostly to change it does allow achievement of the this study s objectives other site dependent variables included plant residue inputs modis derived net primary production npp 2000 2018 calculated using the miami model bernardi 2006 and clay content lesis 2018 cropland cover was obtained from land cover atlas lesotho nc fao 2017 and historic land cover 2000 2015 was sourced from european space agency esa climate change initiative land cover esa 2017 a very wide range of management practices are currently being implemented and can potentially be introduced into the world s agricultural systems depending on climatic soil socio cultural and economic conditions the attainable soc was simulated based on procedure by gottschalk et al 2012 and four conditions were set the bau where the inputs incorporated to soil were similar to the ongoing practices the low medium and high increase in c inputs estimated in the reverse mode for the ssm practices consisted the addition of 5 ssm1 10 ssm2 and 20 ssm3 to carbon inputs respectively the scenarios were selected based on socioeconomic situation of lesotho a developing country where maximum of 20 of soc addition is considered feasible batjes 2019 the potential maps were at 1 km resolution fig 2 3 results 3 1 harmonized data the soil data statistical summary of the top 0 30 cm depth is given in table 3 the soc concentration ranged from 0 28 to 8 02 with mean of 3 40 the average bulk density was 1 39 g cm 3 and showed low variability standard deviation of 0 17 g cm 3 and had a range of 0 94 g cm 3 the coarse fragments have a huge range where there were soils containing as little as 1 43 whereas there were those with 87 91 remote sensing indices that influence soc stock were analyzed by principal component analysis the scree plot fig 3 indicated the contribution of each principal component pc and showed that pc1 and pc2 explained 90 6 of the variation five pcs were selected that explain 99 6 variation table 4 3 2 soil organic carbon stock model evaluation table 5 provides statistical performance of different geostastical models for mapping soils overall the tree based models quantile regression forest qrf cubist and random forest rf performed better than all other models in different soil parameters with the lowest me and rmse and highest r2 and nse most studies have observed that the tree based models perform better than continuous parametric models such as support vector machine svm or simple linear regression model rudiyanto et al 2018 szatmári et al 2019 however qrf was selected with highest r2 of 0 988 0 946 and 0 932 for soc concentration soil bulk density and coarse fragments respectively the qrf model was used to estimate soc concentration bulk density and coarse fragments of the croplands area in lesotho the soc concentration mean was 3 40 with uncertainty of 0 3 and while the bulk density mean was 1 39 g cm 3 and 0 33 g cm 3 uncertainty the coarse fragments showed a mean of 45 96 with the highest uncertainty of 5 the assessment of the predicted map accuracy using randomly selected 85 of the data to build the model and 15 for validation showed bias of 0 11 0 00 and 0 62 for soc concentration bulk density and coarse fragments respectively table 7 this means there was underestimation of about 0 11 for soc concentration whereas coarse fragments were overestimated by 0 61 the coarse fragments map was the most accurate map with 91 of the variation explained and rmse of 0 70 followed by soc concentration and bulk density with 88 6 and 83 6 respectively the map with highest predictive power of the model was bulk density with nse of almost 1 0 997331 3 3 soil organic carbon stock mapping the croplands soc stocks ranged from 18 24 to 164 43 in the top 0 30 cm soil depth fig 4 with mean of 64 76 25 59 mg c ha 1 table 8 the obtained cropland soc stock is higher than the mean 61 2 mg c ha 1 reported by mfrsc nc 2017 in the country s c neutrality target the difference might be brought by the fact that the soc is estimated by intergovernmental panel on climate change ipcc good practice guidance for lulucf ipcc 2003 which differs from the method herein used globally cropland store about 10 of the total global soc pool with mean soc stock density of 81 61 mg c ha 1 in the top 30 cm of soil zomer et al 2017 while the east and southern africa average soc stock density is 53 mg c ha 1 mayer et al 2019 obtained a soc stocks of 71 7 3 47 mg c ha 1 in top 0 30 cm of agricultural soils in bavaria germany with similar temperate climate as lesotho soc stocks varied significantly across the agro ecological zones table 8 the higher soc stock is found in the mountain zone with altitude of 2400 m above sea level this region receive more rainfall as well as having low temperatures thus have high biomass accumulation low mineralization and therefore higher organic c content rantoa 2009 mapeshoane 2013 zhu et al 2019 the high stocks result from high rainfall and low temperatures which leads to a low decomposition rate and a thick organic layer reflects the greater influence of dense themeda triandra and festuca caprina climax vegetation schmitz and rooyani 1987 mapeshoane 2013 attributed the aboveground or root litter and exudates as responsible for higher accumulations of soc in the topsoil the lowlands zone have the lowest soc stocks this zone receives lower precipitation of about 400 mm per annum lms 2018 compared to 1000 mm per annum received in the mountain zones low precipitation results in low primary plant productivity and low inputs of c in the soil furthermore intensive tillage practices in the lowlands compared to minimal practices in the mountains contributes to high mineralization rates and high compaction and high bulk density zhang and schaap 2019 the foothills soc stocks range third only higher than the lowlands and lower than the senqu river valley despite receiving more rainfall than the latter and experiencing lower temperatures the difference but be borne by the fact that this region is more susceptible to the soil erosion because of its relief forms higher animal intensity where all crops leftovers are grazed by the animals after the lowlands the foothills experience more intensive tillage compared to the senqu river valley on the other hand the senqu river valley has a flatter terrain than the foothills and less intense tillage and therefore its soils are less prone to erosion and hence higher soc stocks than the other two aezs bar the mountains 3 4 model performance evaluation the linear regression of soc stocks obtained with the rothc model lesis 2018 data vs old samples data the fao soc stocks gsocmap1 5 0 fig 5 was highly significant with a 0 99 r2 the regression line was below the 1 1 line at lower soc stocks 50 mg c ha 1 indicating that rothc tended to overestimate soc stocks for these conditions on the contrary rothc tended to underestimate results at higher soc stocks similar results are reported by studdert et al 2011 in the study of the use of rothc to simulate changes of organic carbon stock in the arable layer of a mollisol of the southeastern pampas under continuous cropping in argentina 3 5 attainable soc stock the attainable soc stock is the one which can be achieved with changes in management and determines the potential areas for improvement the soc sequestration for the four scenarios attainable after 20 years is shown in table 9 the soc stock ranged from 18 40 to 165 53 mg c ha 1 under business as usual scenario bau 18 57 to 167 61 mg c ha 1 under 5 additions 18 75 to 169 69 mg c ha 1 under 10 additions and 19 09 to 173 82 mg c ha 1 if 20 additions are made annually the mean of soc sequestration under bau is 67 02 mg c ha 1 with the uncertainty of 22 69 while under sustainable management practices the soc sequestration means are 67 76 68 49 and 69 65 mg c ha 1 with the uncertainty of 26 13 the projections show that if management remains the same there will be an annual mean gain of 0 11 mg c ha 1 soc stocks table 9 nonetheless there are areas expected to have a decline of up to 1 08 mg c ha 1 of soc stock if the status quo remains however if ssm practices are adopted the three scenarios show the decline reduced to 0 99 0 91 or even 0 73 mg c ha 1 soc stock for ssm1 ssm2 and ssm3 respectively globally gottschalk et al 2012 in their study on how will organic c stocks in mineral soils evolve under future climate found that there is an overall global increase in soc stocks by 2100 under all scenarios but with a different extent of increase among the climate model and emissions scenarios they attribute the change to a warming climate under which there are increases both in c inputs to the soil due to higher npp and in soc losses due to increased decomposition if soil moisture is not the limiting factor similarly morais et al 2019 found that regardless of land use class in their study on detailed global modeling of soc in cropland grassland and forest soils high latitude regions display higher attainable soc stocks batjes 2019 reckons that in most cases measured c sequestration rates are less than 0 5 to 1 mg c ha 1 yr 1 for 20 years or plus chambers et al 2016 reported united states of america s annual sequestration as 0 3 to 0 5 mg c ha 1 for the croplands various agricultural practices that can increase carbon inputs have been reviewed dignac et al 2017 mfrsc 2019 measured rates of c sequestration by the adoption of best management practices for principal biomes are also available stockmann et al 2013 the spatial distributions of asr for all scenarios are shown in fig 6 while the agro ecological zones mean annual rates in the croplands are shown in fig 7 for all scenarios there is a similar pattern where there are higher sequestration rates in the lowlands foothills mountains and senqu river valley fig 7 in that order respectively meanwhile the foothills the mountains and senqu river valley are the aezs with areas showing more soc stocks losses fig 6 while in the lowlands the loss is concentrated along the mohokare river banks the soc stock loss in the other zones may be due to climate change and low crop yields wiesmeier et al 2016 verschuur et al 2021 observed that drought brought by abnormally low precipitations and high temperatures in recent years had negative influence on the maize yields in lesotho and south africa the situation would imply low biomass production while tillage is increasing the decomposition rate furthermore the rate of sequestration under sustainable management practice is higher in the lowlands than in other zones lowlands seemed to respond better to improved practices than all the other zones the gains observed in the lowlands are associated with the clay content lesis 2018 churchman et al 2020 indicated that clay content enhances soc sequestration zhong et al 2018 also observed a positive relationship between soc stocks and clay content under different climatic conditions in the topsoil layers of 0 20 cm the relative sequestration rates rsr which is the change in soc stocks over time relative to the business as usual scenario show the mean of 0 04 0 07 and 0 15 mg c ha 1 year 1 for ssm1 ssm2 and ssm3 practices respectively table 10 the relative change between the management scenarios and bau indicate the presence of a greater amount of soc under the improved management practice and sanderman and baldock 2010 attribute this to the conventional practice losing soc while the improved management practice lose soc at a smaller or insignificant rate these rates are similar to the expected rates according to simulation developed by fao 2020 4 conclusions monitoring and modeling spatial distribution of soc as input for decision making processes and global c cycle s studies and guiding is important the use of dsm using the qrf model for prediction of soc stock has enabled the spatial distribution determination of the soc stock for the top 0 to 30 cm and production of a croplands topsoil map of lesotho the average soc stock density 64 76 mg c ha 1 resembles those in regions having similar climatic conditions even though it is lower than the global mean of 81 61 mg c ha 1 the highest soc stock density is in the mountains while the lowlands contain the lowest density lowlands showed a higher potential for improvement since the lowlands soils showed a positive high response to sustainable management practices and they can assist in attaining carbon target soc stocks the lowlands are used for crop production thus provide a good benchmark for neutrality support actions however the attainable soc rates showed that soils are losing the soil carbon when they are used for cropping the lands are fragile such that any tillage operations reduce carbon storage moreover substantial amounts of carbon input should be added to the soil for such environments to store carbon the use of such lands for perennial fodder crops production may benefit the soil from high additions of organic matter by both grassroots exudates and above ground additions 5 recommendations this study used the existing climate data not the ipcc emissions scenarios and therefore the results though valid needs to be validated using some or all ipcc emissions scenarios however to achieve this nationally tailored solutions for both experiments and modeling are urgently needed to facilitate the identification of potential hotspots and coldspots of soc climate interaction such as those by jungkunst et al 2022 the authors suggest establishing coordinated experiments across all holdridge life zones to bridge scaling problems of climate impact on soc funding the study was funded by the author availability of data and material available code availability r code was developed using the r software free source authorship statement all persons who meet authorship criteria are listed as authors and all authors certify that they have participated sufficiently in the work to take public responsibility for the content including participation in the concept design analysis writing or revision of the manuscript furthermore each author certifies that this material or similar material has not been and will not be submitted to or published in any other publication before its appearance in the hong kong journal of occupational therapy authorship contributions please indicate the specific contributions made by each author list the authors initials followed by their surnames e g y l cheung the name of each author must appear at least once in each of the three categories below category 1 conception and design of study s j ramakhanna c t omuto and b e mapeshoane acquisition of data s j ramakhanna analysis and or interpretation of data s j ramakhanna and c t omuto category 2 drafting the manuscript s j ramakhanna revising the manuscript critically for important intellectual content c t omuto and b e mapeshoane category 3 approval of the version of the manuscript to be published the names of all authors must be listed s j ramakhanna b e mapeshoane and c t omuto declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements all persons who have made substantial contributions to the work reported in the manuscript e g technical help writing and editing assistance general support but who do not meet the criteria for authorship are named in the acknowledgements and have given us their written permission to be named if we have not included an acknowledgements then that indicates that we have not received substantial contributions from non authors supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 110052 appendix supplementary materials image application 1 image application 2 image application 3 image application 4 image application 5 image application 6 image application 7 
24401,migratory species make use of different habitats and pathways at different life stages and in different seasons ecological management strategies proposed for migratory species should acknowledge the importance of each component of the migratory cycle metapopulation approaches used to assess the quality of habitats do not capture key features of migratory populations in recent years contribution metrics roughly the annual contribution to a population from a single individual that are suitable for migratory species and quantify the quality of habitats and pathways have been developed however existing contribution metrics are either not suitable for use on species that experience complex life histories or movement strategies or are only able to differentiate between pathways taken during the first season of the annual cycle here we develop a modelling framework to calculate contribution metrics that quantify the contribution of individuals migrating along specific pathways over any number of seasons in the annual cycle our framework yields easily computable formulae even for population models with complex migratory patterns we illustrate our framework using hypothetical examples as well as a model inspired by the monarch butterfly and highlight ecological insights that could not have been found using existing contribution metrics we envisage our framework being used to identify the most important or vulnerable components of the migratory cycle such that appropriate conservation strategies may be applied keywords contribution metric matrix population modelling migration spatially structured population theoretical ecology data availability data will be made available on request 1 introduction wildlife populations may make use of different habitats at different life stages and in different seasons the dynamics of a population over an entire year depend on contributions from each component of the cycle contribution metrics which are derived from a population model can be used to quantify the importance of each component existing contribution metrics quantify the contribution of individuals migrating along a specific pathway in the first season of the annual cycle or individuals in a specific habitat in the first season of the annual cycle here we introduce two new metrics that quantify the contribution of individuals migrating along specific pathways over several seasons of the annual cycle pathways that include every season describe full migratory routes so our metrics provide greater insight into how different migratory pathways contribute to the dynamics of the total population migration is a behavioural adaptation that has evolved to cope with seasonal changes to environments however many migratory species are suffering serious declines due to environmental and climate change huntley et al 2006 robinson et al 2009 wilcove and wikelski 2008 the conservation of migratory species requires adequate protection across its entire range and careful consideration of factors such as habitat connectivity and migratory bottlenecks runge et al 2014 weber et al 1999 the challenge of providing this protection has resulted in iucn international union for conservation of nature targets being met less successfully for migratory species than for sedentary species runge et al 2015 the conservation of migratory species is important at the ecosystem scale the life histories of some species are based around the predictable seasonal movements of migrants bauer and hoye 2014 migrants also provide a large scale linking of ecosystems transporting nutrients energy and other organisms bauer and hoye 2014 wilcove and wikelski 2008 the decline of a migratory population can have significant ecological impacts at the level of the population community and ecosystem shuter et al 2011 the study of migratory species is usually done on the level of the individual its choices and their consequences bowlin et al 2010 contribution metrics allow for migratory species to be studied at the population level the first contribution metric was developed by runge et al 2006 using theory from matrix population models which dates back to the 1940s lefkovitch 1965 leslie 1945 1948 see more recently caswell 2001 however this metric did not account for crucial elements of migratory models such as seasonality differences between breeding and non breeding habitats and regular movements between habitats taylor and hall 2012 wiederholt et al 2018 wiederholt et al 2018 adapted runge et al s metric such that the contribution of an individual to a migratory population can be calculated across a two season annual cycle this metric was then generalised further by sample et al 2019 in order to calculate the contribution of an individual migrating along a specific pathway in the first season of the annual cycle and to calculate the contribution of individuals that are in a specific habitat in the first season of the annual cycle inspired by the line of inquiry across runge et al 2006 sample et al 2019 wiederholt et al 2018 the purpose of the present paper is to further generalise contribution metrics in order to calculate the contribution of an individual migrating along specific pathways over any number of seasons in an annual cycle indeed we propose two new so called pathway contribution metrics for a class of discrete migratory matrix population projection models which are stratified according to stage and habitat this generalisation allows us to quantify the contribution of full migratory routes or any sections of the migratory route that may be of interest perhaps due to migratory bottlenecks buler and moore 2011 runge et al 2014 our method can be used to calculate contribution metrics for migratory models with any number of seasons habitats or stages furthermore in certain cases we provide formulae to link our pathway metrics to the habitat metrics in sample et al 2019 and to the asymptotic growth rate of the population the paper is organised as follows in section 2 we gather notation describe the underlying model and present our new pathway contribution metrics the main technical ingredients are linear algebra matrix methods in section 3 we illustrate the utility of the metrics by applying them to existing models from the literature in section 4 we interpret our results and provide summarising remarks we provide an appendix containing some technical details and supporting information for the examples 2 materials and methods here we give a detailed account of the construction analysis and interpretation of our pathway contribution metrics we begin by introducing the underlying dynamic migratory population model which we term the annual cycle model we then set out how to calculate pathway contribution metrics from this model and how to average across several stages and habitats we also elucidate the connection between the new pathway contribution metrics the existing habitat contribution metrics and the asymptotic growth rate 2 1 mathematical notation here we introduce frequently used operations we use operations involving kronecker products to construct block matrices with particular structures we use e n i j to denote a n n zero matrix with a one in the i j th entry see table 2 1 let b i r m m for all i 1 n and let b x y i denote the x y th entry of b i we use the operation a i 1 n e n i i b i to construct a block diagonal matrix a r m n m n with n 2 blocks each of size m m where the i i th block is given by b i we use the operation c i 1 n b i e n i i to construct a block matrix c r m n m n with m 2 blocks each of size n n each block is a diagonal matrix and in particular b x y i is the i i th entry of the x y th block of c we use to denote hadamard division of vectors written z y x for vectors x and y and where z j 0 x j 0 y j x j otherwise here x j and y j denote the j th entries of x and y respectively we note that for nonnegative matrices a r p m and vectors x r m we have 1 p t a x j 1 p a x j a x 1 where 1 denotes the usual 1 norm on real euclidean space multiplying a nonnegative matrix on the left by 1 t returns a row vector composed of the column sums of the matrix finally for compatibly sized vectors x and y we let row x y x y denote the row operation which simply arranges two vectors into one row we use this operation for wholly presentational reasons when writing the right hand side of the above is not practicable further mathematical notation is listed in table 2 1 2 2 the annual cycle model here we discuss the underlying migratory population model which is the essential foundation for the various contribution metrics constructed in section 2 3 all mathematical notation used is recorded in tables 2 1 and 2 2 the so called annual cycle model borrows theory from matrix population models and source sink models see for example caswell 2001 cushing 1998 and pulliam 1988 respectively so that matrix entries contain information based on demographic rates and movement rates the latter between discrete habitats or patches the model may be visualised as a network where nodes represent habitats and edges represent migration pathways as is done in sample et al 2018 and taylor and hall 2012 the annual cycle model is particularly inspired by the models appearing in hunter and caswell 2005 and sample et al 2019 a key novel feature of the present model is the introduction of the so called seasonal survival matrices see 2 7 as shall be explained in due course these matrices can be used to highlight pathways of interest and allow managers to gain more insight into the important factors across the whole annual cycle we provide details of the annual cycle model which stratifies the population of interest by stage structure and spatial location or habitat we assume there are c stages and n habitats we define an annual cycle matrix a that projects a population over an annual cycle from a fixed anniversary season the annual cycle matrix contains the demographic update information associated with habitats as well as the migration update information associated with migration pathways thus the underlying discrete time annual cycle model is given by 2 1 x t 1 a x t t 0 1 2 x 0 x 0 where a r c n c n is the annual cycle matrix and x t r c n is the structured population at annual time step t recorded during the anniversary season the vector x 0 models the initial population distribution the asymptotic growth rate λ of the population is well known to be given by the dominant eigenvalue of a equal to the spectral radius of a the quantity λ describes the asymptotic behaviour of nonzero solutions of 2 1 the spatial structure encoded in a and x t can be decomposed into n 2 blocks and n subvectors respectively by writing here a i j r c c is the population projection matrix for the subpopulation that starts the annual cycle in habitat j and is in habitat i at the end of the annual cycle and x j t r c represents the stage distribution within habitat j at the start of the annual cycle and at time step t each x j t is a vector of the form x j t x j 1 t x j c t where x j i t denotes the number of individuals in stage i and habitat j at the start of the annual cycle the life rates experienced by a migratory population depend on the season hence the annual cycle is decomposed into s seasons each of which is assigned a label k 1 s such that the anniversary season is season 1 and consecutive seasons are assigned consecutive numbers the term season is used somewhat loosely and is essentially a division of the annual cycle into smaller units of time thus the annual cycle matrix a is in fact constructed by taking the product of s seasonal matrices a k r c n c n via left multiplication that is 2 2 a k 1 s a k a s a 2 a 1 the biological interpretation of each element of the seasonal matrices is hard to infer owing to the demographic and migration information being entangled we define d j k r c c to be the demographic projection matrix associated with habitat j in season k and let d x y denote the x y th entry of d j k each d x y term is assumed to be linear and constant in time and quantifies the survival growth or fecundity of stage y in other words d x y represents the number of individuals in stage x generated from an individual in stage y and habitat j during season k furthermore we define m k i r n n to be the migration projection matrix associated with stage i in season k and let m x y denote the x y th entry of m k i each m x y term represents the probability that an individual in stage i migrates from habitat y to x and survives during season k inspired by sample et al 2019 we use kronecker products to construct two block matrices one of these matrices d k r c n c n contains the demographic update information for the total population in season k whilst the other m k r c n c n contains the migration update information for the total population in season k we define d k and m k by 2 3 d k j 1 n e n j j d j k and m k i 1 c m k i e c i i where recall e n i i is a n n matrix of zeros apart from a one in the i i th entry the construction of d k results in a block diagonal matrix where the j j th block is given by d j k whilst the construction of m k results in a block matrix where each block is a diagonal matrix and m x y of m k i is the i i th term of the x y th block of m k see section 2 1 when constructing the seasonal matrices a k r c n c n we assume that within a season migration is followed by demography hence 2 4 a k d k m k k 1 s the upshot of the above construction is that the seasonal matrices can also be decomposed into n 2 blocks namely where a k i j r c c is the population projection matrix for the subpopulation that moves from habitat j to habitat i during season k the migration update information contains information about the proportion of individuals migrating and the survival probability associated with the migration we impose additional structure on the entries m x y of the migratory matrices m k i specifically we assume that m x y p x y s x y for all x y where p x y represents the probability that an individual in stage i migrates from habitat y to x in season k and s x y represents the migratory survival probability for an individual in stage i that migrates from habitat y to x in season k then letting p k i r n n and s k i r n n have respective components p x y and s x y it follows that p k i and s k i contain the proportion of stage i individuals that migrate in season k and the survival probability of stage i individuals during migration in season k respectively moreover defining 2 5 p k i 1 c p k i e c i i and s k i 1 c s k i e c i i a routine calculation shows that m k s k and p k are related by 2 6 m k p k s k for all k we define seasonal survival matrices a ˆ k r c n c n by 2 7 a ˆ k d k s k k 1 s these matrices encode the migratory survival and demographic rates but unlike a k do not include the probability that migration along a pathway occurs hence each block a ˆ k x y r c c may be interpreted as the population projection matrix if the whole population migrates from habitat y to habitat x during season k it is shown in appendix a that for every k 2 8 a k x y a ˆ k x y p k x y here a x y represents the x y th block of a we conclude the subsection by providing further commentary on features of the annual cycle model first we note that the above annual cycle model is equivalent to that in sample et al 2019 up to the use of transposes and that our construction results in the sub blocks of the vectors and matrices being arranged by habitat it is also possible to construct the seasonal matrices using the vec permutation approach as is done in hunter and caswell 2005 the seasonal survival matrices a ˆ k in 2 7 are a novel feature of the present work the model may also be constructed for the setting where demography is assumed to be followed by migration during each season meaning 2 4 is replaced by a k m k d k and 2 7 is replaced by a ˆ k s k d k for every k this would change the results both qualitatively and quantitatively but the construction of the contribution metrics in section 2 3 remains the same second the choice of which season is taken as the anniversary season determines the order in which the seasonal matrices are multiplied and is a choice for the modeller cyclic permutations of the seasonal matrices do not alter the dominant eigenvalue λ of the annual cycle matrix a as the nonzero eigenvalues of products of matrices are equal see horn and johnson 1990 theorem 1 3 22 or caswell 2001 p 350 in other words the asymptotic growth rate of the population λ is independent of the choice of anniversary season as one would expect however cyclic permutations of the seasonal matrices may alter the corresponding eigenvectors indeed since a is componentwise nonnegative it has a right eigenvector corresponding to λ which may be chosen to be componentwise nonnegative see for example berman and plemmons 1994 theorem 1 1 p 26 this eigenvector is often called the stable stage structure of a under reasonable ecological assumptions such as a being irreducible then λ is a simple eigenvalue by the perron frobenius theorem berman and plemmons 1994 theorem 1 4 p 27 and the stable stage structure is unique up to multiplication by a constant we comment that the stable stage structure will in general depend on the choice of anniversary season but the stable stage structure does not play a large role in the present work finally we comment on incorporating inter annual variations into the annual cycle model one generalisation of the annual cycle model described here is to allow the seasonal vital rates to depend on the year t resulting in each seasonal matrix a k and therefore a also depending on t alternatively if a population experiences inter annual variations which are periodic over multiple years then the annual cycle matrix a could be expanded to span the required number of years this again produces a time invariant model of the form 2 1 at the cost of losing track of annual variations in the population however in the present work we are most interested in transient dynamics via pathway contribution metrics that are calculated over one annual cycle thus for simplicity we do not include notation that keeps record of the year 2 3 pathway contribution metrics here we introduce two new pathway contribution metrics for the annual cycle model presented in section 2 2 our metrics generalise those introduced in sample et al 2019 and wiederholt et al 2018 the connection between our new metrics and these is discussed in appendix b and example 3 1 a summary of notation introduced is recorded in tables 2 3 and 2 4 pathway contribution metrics calculate the per capita contribution to the total population of an individual that has travelled along a specific migratory route during the annual cycle in words a pathway is the migration an individual takes between one habitat and another or itself during a season a migratory route consists of all pathways that an individual migrates along in an annual cycle to describe migratory routes mathematically we define a vector p r s 1 such that the migratory route is given by p 1 p 2 p 3 p s p s 1 here p k 0 1 n denotes the habitat in which the subpopulation starts in season k and ends in season k 1 if p k 0 then the habitat is unspecified in this case the migratory route includes all habitats at the start of season k the pathway that an individual of interest migrates along during season k is specified by p k and p k 1 define ϕ 0 1 s to be the number of seasons for which a pathway is specified and let φ r ϕ store the labels of these seasons arrows are used to indicate the migration within a season with a specified pathway k φ whilst crossed arrows are used to indicate seasons for which a pathway is not specified k φ if k φ set p k j 1 n and p k 1 l 1 n to track the subpopulation that travels from habitat j to habitat l during season k setting p k p k 1 j 0 tracks the subpopulation that remains resident in habitat j during season k if p k p k 1 0 then all subpopulations are tracked in season k to calculate pathway contribution metrics similarly to sample et al 2019 eq 8 we take the one norm of a product of s matrices however when a pathway is specified in season k we use a function of a k so that only the focal subpopulation is tracked our construction focuses solely on the proportion of the subpopulation that migrates on the given pathway we introduce 2 9 a k a ˆ k e n p k 1 p k j c k φ a k otherwise where a ˆ k e n p k 1 p k j c is a c n c n matrix which by construction has the p k 1 p k th block equal to the p k 1 p k th block of a ˆ k and all other blocks are equal to zero in other words a ˆ k e n p k 1 p k j c only stores the seasonal survival matrix for the subpopulation travelling along the pathway specified in season k the population is projected over the annual cycle from season 1 by taking the product of all a k via left multiplication therefore the annual population projection matrix in the annual cycle model for migratory route p is equal to 2 10 k 1 s a k a s a 2 a 1 in words if a particular pathway from habitat l to j is being tracked during a season k 1 s then the k th term in the product is given by a ˆ k e n j l j c otherwise if no particular pathway is specified during season k the k th term is given by the seasonal matrix a k consecutive seasons with specified pathways must be defined such that a ˆ k 1 e n m l j c a ˆ k e n j h j c j l here m l j h 1 n denote habitats and the pathway from habitat h to j is tracked during season k whilst the pathway from l to m is tracked during the following season k 1 to be a valid migratory route j and l must correspond to the same habitat that is j l otherwise the matrix product is zero as it contains an impossible migratory route furthermore if k φ but k 1 φ and k 1 φ then p k and p k 1 will be nonzero despite season k not being labelled as a season with a specified pathway in this situation where k is not a season with a specified pathway the p k 1 p k th block of a k is picked up in 2 10 alternatively if k is a season with a specified pathway then the p k 1 p k th block of a ˆ k is picked up in 2 10 later we provide an illustrative example to highlight this point see example 2 3 we are now in position to define two types of pathway contribution metric first for a given migratory route p we define c p by 2 11 c p 1 c n t k 1 s a k 1 c n t a s a 2 a 1 c 1 1 p c 1 c p c n 1 p c n c p here c j i p is the per capita contribution of an individual that starts the annual cycle in stage i and habitat j and migrates along p to the subpopulation that migrates along p we call c p the subpopulation pathway contribution metrics the second pathway contribution metric c p is defined by 2 12 c p 1 c n t k 1 s a k p k 1 c n t a s p s a 2 p 2 a 1 p 1 c 1 1 p c 1 c p c n 1 p c n c p here c j i p is the per capita contribution of an individual that starts the annual cycle in stage i and habitat j and travels along the migratory route p to the total population we call c p the metapopulation pathway contribution metrics also p k is given by p k i n p k p k 1 p k k φ i c n otherwise where i n p k p k 1 p k is a c n c n matrix with the p k 1 p k th block of p k along the diagonal therefore due to the construction of a k and p k and recalling the relationship 2 8 gives a k p k a k e n p k 1 p k j c k φ a k otherwise the key difference between the subpopulation pathway contribution metrics and metapopulation pathway contribution metrics is that c p does not account for the proportion of the population migrating along p whereas c p does account for the proportion of the population migrating along p consequently c p c p componentwise inequality due to the construction of c p as in each season where there is a choice of pathway the fraction of the total population that migrates along p in general becomes smaller we define a full migratory route to be a migratory route where every season in the annual cycle has a specified pathway that is a k a ˆ k e n p k 1 p k j c for all k conversely if no seasons have specified pathways that is p 0 0 0 0 0 then the resulting pathway contribution metric is 2 13 c p 0 1 t a s i c n a k i c n a 2 i c n a 1 i c n 1 t a s a k a 2 a 1 c p 0 1 t a so c p 0 contains the habitat contribution metrics defined in sample et al 2019 which in the present framework we recover as a special case of a pathway contribution metric we denote the habitat contribution metrics by c and denote each entry by c j i and name these the state contribution metrics the state contribution metric c j i can be thought of as the number of individuals across the total population that are generated over an annual cycle by an individual that is initially in stage i and habitat j a summary of the contribution metrics introduced is contained in table 2 4 2 4 illustrative examples our formulation of pathway contribution metrics in 2 9 2 12 is general and allows pathways to be specified in any season to draw out the key ideas from the mathematical notation in this section we present some illustrative numerical and general examples example 2 1 consider an annual cycle model with two seasons two habitats and two stages s 2 n 2 c 2 we use the hypothetical metapopulation in sample et al 2019 section 3 1 it represents partial migration between a higher quality habitat habitat 1 and a lower quality habitat habitat 2 there is a resident population in both habitats and migration can occur between habitats in both seasons the demographic rates used are the same as those from sample et al 2019 section 3 1 and we set the breeding season to be the anniversary season hence we obtain d 1 f b and d 2 f n where f b and f n are as they appear in sample et al 2019 p 5 migration matrices are defined for each stage in each season we have altered the migration matrices defined in sample et al 2019 such that now there is mortality associated with migration the migration matrices are the same for all stage and season combinations and are given by 2 14a p 1 1 p 1 2 p 2 1 p 2 2 0 6 0 4 0 4 0 6 s 1 1 s 1 2 s 2 1 s 2 2 1 0 8 0 8 1 and so m 1 1 m 1 2 m 2 1 m 2 2 0 6 0 32 0 32 0 6 recall that p k i r n n contains the proportion of stage i individuals that migrate in season k s k i r n n contains the survival probability of stage i individuals during migration in season k m k i r n n contains the probability that an individual in stage i migrates along a pathway in season k and survives see table 2 2 mortality associated with migration is captured via the column sums of the m k i all being less than one the seasonal matrices are constructed using 2 4 and are given by a 1 0 0 3999 0 0 2133 0 4800 0 5400 0 2560 0 2880 0 0 1860 0 0 3488 0 1920 0 2240 0 3600 0 4200 a 2 0 4800 0 0 2560 0 0 0 5400 0 0 2880 0 1920 0 0 3600 0 0 0 2240 0 0 4200 further the seasonal survival matrices are constructed using 2 7 and are given by a ˆ 1 0 0 6650 0 0 5332 0 8000 0 9000 0 6400 0 7200 0 0 4650 0 0 5813 0 4800 0 5600 0 6000 0 7000 a ˆ 2 0 8000 0 0 6400 0 0 0 9000 0 0 7200 0 4800 0 0 6000 0 0 0 5600 0 0 7000 and consequently by 2 2 the annual cycle matrix is a 0 0 2396 0 0 1917 0 3145 0 3561 0 2419 0 2765 0 0 1437 0 0 1665 0 1882 0 2150 0 2085 0 2409 thus summing the columns of a the habitat contribution metrics see 2 13 are equal to 2 14b c p 0 1 t a 0 5027 0 9545 0 4505 0 8756 by inspecting the above vector we see that individuals that start season 1 in habitat 1 contribute more to the total population than individuals that start in habitat 2 furthermore in both habitats individuals that are adults in season 1 contribute more to the total population than individuals that are juveniles in season 1 adults that start season 1 in habitat 1 are the population state that contribute the most to the total population moreover we see that over the course of a year none of the population states are replacing themselves as the habitat contribution metrics are all less than one and so this population is a sink and is decreasing in the short term the habitat contribution metrics are related to the asymptotic growth rate λ via 2 21 and from this equation it follows in this case that λ 1 thus the population is declining long term too as we would expect we now specify a pathway in both seasons ϕ 2 φ 1 2 hence all the distinct migratory routes are p 1 1 1 1 p 2 1 1 2 p 3 1 2 1 p 4 1 2 2 p 5 2 1 1 p 6 2 1 2 p 7 2 2 1 2 14c p 8 2 2 2 here p 1 and p 8 are the migratory routes of resident populations p 2 and p 7 are resident in season 1 and migrate in season 2 p 3 and p 6 migrate in both seasons p 4 and p 5 migrate in season 1 and are resident in season 2 for all distinct migratory routes we calculate subpopulation pathway contribution metrics using 2 11 2 14d c p 1 1 t a ˆ 2 e 2 11 j 2 a ˆ 1 e 2 11 j 2 0 7200 1 3432 0 0 c p 2 1 t a ˆ 2 e 2 21 j 2 a ˆ 1 e 2 11 j 2 0 4480 0 8239 0 0 c p 3 1 t a ˆ 2 e 2 12 j 2 a ˆ 1 e 2 21 j 2 0 3456 0 7008 0 0 c p 4 1 t a ˆ 2 e 2 22 j 2 a ˆ 1 e 2 21 j 2 0 3360 0 6710 0 0 c p 5 1 t a ˆ 2 e 2 11 j 2 a ˆ 1 e 2 12 j 2 0 0 0 5760 1 0746 c p 6 1 t a ˆ 2 e 2 21 j 2 a ˆ 1 e 2 12 j 2 0 0 0 3584 0 6591 c p 7 1 t a ˆ 2 e 2 12 j 2 a ˆ 1 e 2 22 j 2 0 0 0 4320 0 8760 c p 8 1 t a ˆ 2 e 2 22 j 2 a ˆ 1 e 2 22 j 2 0 0 0 4200 0 8388 all the distinct migratory routes in 2 14c have a pathway specified in season 1 resulting in the vectors c p i only being populated in the sub vector associated with the initial habitat the pathway contribution metrics indicate that p 1 and p 5 are the highest quality migratory routes in fact the adults in the subpopulations that use these routes are replacing themselves as the contribution metrics are greater than one despite all the habitat contribution metrics being less than one therefore managers could increase the total proportion of the population that takes these routes to increase the total population size example 2 2 here we provide a general example to consider an annual cycle model with four seasons and two habitats s 4 n 2 assume that only the second season has a specified pathway leading to ϕ 1 and φ 2 which tracks the subpopulation that travels from habitat 1 to 2 that is p 0 1 2 0 0 using 2 11 the per capita subpopulation pathway contribution metrics are given by c p 1 2 c t a 4 a 3 a ˆ 2 e 2 21 j c a 1 1 c n t a 4 a 3 0 0 a ˆ 2 21 0 a 1 routine blockwise matrix multiplication gives 2 15 c p row j 1 2 1 c t a 4 j 1 a 3 12 a 4 j 2 a 3 22 a ˆ 2 21 a 1 11 j 1 2 1 c t a 4 j 1 a 3 12 a 4 j 2 a 3 22 a ˆ 2 21 a 1 12 using 2 12 the per capita metapopulation pathway contribution metrics are given by c p 1 2 c t a 4 i 2 c a 3 i 2 c a ˆ 2 e 2 21 j c i 2 c p 2 21 a 1 i 2 c 1 2 c t a 4 a 3 0 0 a ˆ 2 21 0 p 2 21 0 0 p 2 21 a 1 similarly 2 16 c p row j 1 2 1 c t a 4 j 1 a 3 12 a 4 j 2 a 3 22 a 2 21 a 1 11 j 1 2 1 c t a 4 j 1 a 3 12 a 4 j 2 a 3 22 a 2 21 a 1 12 both 2 15 and 2 16 quantify how much an individual travelling from habitat 1 to habitat 2 in season 2 contributes to the overall population notice that the difference between 2 15 and 2 16 is that a ˆ 2 21 appears in the former whilst a 2 21 appears in the latter so in 2 15 only the demography and migratory survival of individuals travelling from habitat 1 to 2 is recorded during season 2 but in 2 16 the proportion of the population that travel from habitat 1 to habitat 2 during season 2 and survive is recorded example 2 3 here we provide an illustrative example to highlight the subtle distinction between models in which seasons k 1 and k 1 each have a specified pathway but season k does not and models in which seasons k 1 k and k 1 all have a specified pathway still considering a general annual cycle model with four seasons and two habitats s 4 n 2 we specify two migratory routes denoted by p 1 and p 2 the first migratory route p 1 specifies pathways in seasons 2 and 4 leading to ϕ 1 2 and φ 1 2 4 in particular during season 2 the pathway from habitat 1 to habitat 2 is specified and in season 4 the pathway from habitat 1 to itself is specified individuals remain resident in habitat 1 during season 4 so p 1 0 1 2 1 1 the second migratory route p 2 specifies pathways in seasons 2 3 and 4 leading to ϕ 2 3 and φ 2 2 3 4 in particular during seasons 2 and 4 the pathways that are specified in p 1 are specified again in season 3 the pathway from habitat 2 to habitat 1 is specified so p 2 0 1 2 1 1 hence for p 2 the proportion of individuals travelling from habitat 2 to habitat 1 during the third season is recorded in the calculation of the pathway contribution metrics but for p 1 the proportion of individuals travelling from habitat 2 to habitat 1 during the third season is not recorded the pathway contribution metrics are computed by standard blockwise matrix multiplication for p 1 2 17 c p 1 1 2 c t a ˆ 4 e 2 11 j c a 3 a ˆ 2 e 2 21 j c a 1 1 2 c t a ˆ 4 11 0 0 0 a 3 0 0 a ˆ 2 21 0 a 1 1 c t a ˆ 4 11 a 3 12 a ˆ 2 21 a 1 11 1 c t a ˆ 4 11 a 3 12 a ˆ 2 21 a 1 12 and c p 1 1 2 c t a ˆ 4 e 2 11 j c i 2 c p 4 11 a 3 i 2 c a ˆ 2 e 2 21 j c i 2 c p 2 21 a 1 i 2 c 1 2 c t a ˆ 4 11 0 0 0 p 4 11 0 0 p 4 11 a 3 0 0 a ˆ 2 21 0 p 2 21 0 0 p 2 21 a 1 1 2 c t a 4 11 a 3 12 a 2 21 a 1 11 a 4 11 a 3 12 a 2 21 a 1 12 0 0 1 c t a 4 11 a 3 12 a 2 21 a 1 11 1 c t a 4 11 a 3 12 a 2 21 a 1 12 for p 2 2 18 c p 2 1 2 c t a ˆ 4 e 2 11 j c a ˆ 3 e 2 12 j c a ˆ 2 e 2 21 j c a 1 1 2 c t a ˆ 4 11 0 0 0 0 a ˆ 3 12 0 0 0 0 a ˆ 2 21 0 a 1 1 2 c t a ˆ 4 11 a ˆ 3 12 a ˆ 2 21 a 1 11 a ˆ 4 11 a ˆ 3 12 a ˆ 2 21 a 1 12 0 0 1 c t a ˆ 4 11 a ˆ 3 12 a ˆ 2 21 a 1 11 1 c t a ˆ 4 11 a ˆ 3 12 a ˆ 2 21 a 1 12 notice that c p 1 c p 2 as in 2 18 we have a ˆ 3 12 rather than a 3 12 which appears in 2 17 however c p 1 c p 2 as the proportion of individuals migrating during season 3 is already included in the calculation of c p i in other words since c p already accounts for the size of the subpopulation travelling along pathways all elements in the products in 2 10 are blocks of the seasonal matrices a k regardless of whether or not the season has a specified pathway that is c p 2 c p 1 1 c t a 4 11 a 3 12 a 2 21 a 1 11 1 c t a 4 11 a 3 12 a 2 21 a 1 12 2 5 relating habitat and pathway contribution metrics here we take inspiration from wiederholt et al 2018 and demonstrate how the habitat contribution metrics c may be expressed in terms of a linear combination of pathway contribution metrics for each combination of seasons that have specified pathways φ a number of distinct migratory routes can be specified assuming that pathways between all habitats may be taken in every season the number of distinct migratory routes γ for a specified φ is given by γ n ϕ a where a is the number of entries in φ for which φ i 1 φ owing to the choice of pathway in consecutive seasons relying on each other recall that ϕ is the number of seasons for which a pathway is specified for example for a model with four seasons two habitats and φ 1 3 4 we see that ϕ 3 and a 2 as 2 and 5 are not in φ therefore there are γ 2 5 32 distinct migratory routes for i 1 γ let p i store the i th distinct migratory route then for each distinct migratory route c p i corresponds to a distinct subpopulation and the habitat contribution metrics c correspond to the total population therefore c is given by 2 19 c i 1 γ c p i that is summing the contributions of individuals from each distinct subpopulation gives the per capita contributions structured by the initial habitat for example the contribution of an individual that starts the annual cycle in stage 1 and habitat 1 c 1 1 can be obtained by summing the c 1 1 p i metrics across all possible migratory routes the habitat contribution metrics are equal to the sum of all possible metapopulation pathway contribution metrics consequently the metapopulation pathway contribution metrics provide another layer of granularity compared to habitat contribution metrics and can thus highlight the importance of a given migratory route we comment that in reality migrants may not use all pathways in every season hence not all distinct migratory routes p i are biologically valid however if p i is not a valid migratory route c p i will be zero thus 2 19 is still true for complex models using all distinct migratory routes including invalid migratory routes results in large γ in this situation only the contribution metrics corresponding to the distinct migratory routes that are biologically valid need to be calculated for use in 2 19 in special cases a linear combination of the c p i metrics can be used to derive c we define p ˆ i r c n c n by p ˆ i τ 1 ϕ i n p φ τ p i φ τ 1 p i φ τ that is along the diagonal p ˆ i stores the proportion of individuals that migrate along p i notice that p ˆ i τ 1 ϕ p φ τ k 1 s p k then when either only the first season has a specified pathway or when p k i is the same for all i 1 c we have that p i ˆ α i c n where α r in particular the habitat contribution metrics c are given by 2 20 c i 1 γ c p i p ˆ i where c p i is defined as in 2 11 hence 2 20 is a multi state version of wiederholt et al 2018 eq 5 we now provide an illustrative example where the pathway contribution metrics may be obtained from c p i example 2 4 here we use the same model as in example 2 1 and show that the habitat contribution metrics can be recovered from the pathway contribution metrics the migration matrices containing the migratory proportions are the same for all season and stage combinations see 2 14a therefore for every distinct migratory route p i we know that p ˆ i α i c n in particular for p 1 and p 8 p ˆ i 0 36 i 4 for p 2 p 4 p 5 and p 7 p ˆ i 0 24 i 4 for p 3 and p 6 p ˆ i 0 16 i 4 hence we input the subpopulation pathway metrics for all distinct migratory routes see 2 14d into 2 20 and obtain c 0 5027 0 9545 0 4505 0 8756 the above vector is equal to that in 2 14b thus the habitat contribution metrics have been recovered 2 6 relating contribution metrics to asymptotic growth the contribution metrics developed in runge et al 2006 and wiederholt et al 2018 and the habitat contribution metrics in sample et al 2019 can all be related to the asymptotic growth rate of the population here we show that summing over the metapopulation pathway contribution metrics weighted by the stable stage structure of the population gives the asymptotic growth rate of the population let λ be the dominant eigenvalue of a and w be the corresponding right eigenvector scaled such that the entries of w are nonnegative and sum to one in other words w is the standardised stable stage structure of the annual cycle population model in the case that a is irreducible the eigenvalue λ is a simple eigenvalue of a by the perron frobenius theorem and so the above conditions determine w uniquely hence a w λ w and so 2 21 c w 1 c n t a w 1 c n t λ w λ w 1 λ substituting 2 19 for c gives 2 22 i 1 γ c p i w j i 1 γ c p i j w j λ thus the sum of the metapopulation pathway contribution metrics c p weighted by the stable stage structure equals the overall asymptotic growth rate of the total population recall that c p i contains the per capita contribution for each initial population state of the distinct subpopulation that travels along the distinct migratory route p i during the annual cycle furthermore the summation of the metapopulation pathway contribution metrics for all distinct subpopulations gives the per capita contribution of each initial state of the total population recall that the state contribution metrics c j i the entries in c can be thought of as the number of individuals across the total population that are generated over an annual cycle by an individual that is initially in stage i and habitat j hence it is intuitive that the average of the state contribution metrics weighted by the stable stage distribution is the total population generated in the next annual time step and in this particular case equals the asymptotic growth rate of the population furthermore in the special cases where 2 20 holds we have 2 23 i 1 γ c p i p ˆ i w j i 1 γ c p i p ˆ i j w j λ again the above equality is intuitive once we know that the c p i metrics can be used to calculate c eq 2 22 or 2 23 can be used to provide insight into the trade offs between asymptotic and transient dynamics captured presently by c p i or c p i and λ respectively for example if a particular contribution metric increases by some change or perturbation to a then for a fixed λ the corresponding component of w must decrease all else remaining the same in order to maintain equality in 2 22 or 2 23 2 7 averaging contribution metrics here we provide easy to compute matrix formulae to calculate the average contribution to the total population of an initial habitat or stage for a subpopulation that follows a particular migratory route the first metric we define averages the metapopulation pathway contribution metrics c p over stage to assess the quality of a habitat regardless of stage the second metric we define averages c p over habitat to assess the contribution of an initial stage 2 7 1 averaging over stage the contribution metrics stored in c p can be averaged over stage to assess the quality of habitats there is an averaged contribution metric associated with each habitat j 1 n denoted by c j p each c j p is the average contribution of an individual that starts the annual cycle in habitat j and migrates along p the calculation of c j p requires knowledge of the population structure at the start of the annual cycle x we provide a matrix formulation that simultaneously calculates all c j p metrics given by 2 24 h p j 1 n e n j j 1 c t x c p t j 1 n e n j j j c x 1 c t 1 c t x c p t j c j c x c 1 p c n p r n the mathematical notation is detailed in section 2 1 and recall that denotes hadamard division the definition of means that the averaged contribution of an empty habitat is zero the vector h p is structured by the habitat in which a subpopulation starts the annual cycle for clarity note that h p is a column vector whilst the pathway contribution metrics presented so far are row vectors we have chosen to present our formula using vectors and matrices to encode more information in one calculation that is easy to implement numerically however setting x j 1 c t x j which is the number of individuals in habitat j at the start of the annual cycle routine calculations starting from 2 24 show that 2 25 c j p i 1 c x j i c j i p x j whenever x j is nonzero hence each block of our formula computes sample et al 2019 eq 9 for a different initial habitat we provide a derivation of the above calculation in appendix c 1 the size of c j indicates whether habitat j is a source or a sink for the focal subpopulation if c j p 1 then habitat j is said to be a source for the subpopulation that follows the migratory route defined by p alternatively if c j p 1 then habitat j is said to be a sink for the subpopulation that follows the migratory route defined by p we note that the averaged contribution metrics depend on the initial population structure here denoted x and not just the annual cycle matrix thus the year that the population is measured will influence the value of the averaged contribution metrics 2 7 2 averaging over habitat similarly the contribution metrics stored in c p can be averaged over habitat to assess the contribution of stages there is an averaged contribution metric associated with each stage i 1 c denoted by c i p each c i p is the average contribution of an individual that starts the annual cycle in stage i and migrates along p the calculation of c i p requires knowledge of the population structure at the start of the annual cycle x we provide a matrix formulation that simultaneously calculates all c i p metrics given by 2 26 s p i 1 c 1 n t e c i i x c p t i 1 c j n e c i i x i c i c x c p t i c i c i c i c x c 1 p c c p recall from section 2 1 that i c denotes the c c identity matrix it can be shown by a simplification of 2 26 see appendix c 2 that 2 27 c i p j 1 n x j i c j i x i whenever x i is nonzero here x i j 1 n x j i is the total number of individuals in stage i at the start of the annual cycle since c j i contains information about the proportion of individuals migrating each block of our formula computes sample et al 2019 eq 12 for a different starting stage thus each c i p is the per capita contribution of the subpopulation that travels the migratory route defined by p and starts the annual cycle in stage i again we note that these averaged contribution metrics depend on the initial population structure not just the annual cycle matrix the effect of the population structure x on h p and s p will be explored further in smith 2023 3 case studies here we calculate our contribution metrics for a range of annual cycle models first we demonstrate how our framework generalises that in wiederholt et al 2018 by extending their scalar population model into a matrix population model next we use an annual cycle model for a north american migratory monarch butterfly population with multiple stages habitats and seasons to explore the range of contribution metrics that can be calculated using our framework these metrics include full migratory routes which previous frameworks could not capture finally we provide an example that details how contribution metrics can be used to design a simple optimal single time step control solution for the conservation of a population example 3 1 we illustrate the connection between our subpopulation pathway contribution metric and the one defined in wiederholt et al 2018 which considers annual cycle models with two seasons and two stages representing juvenile and adult individuals borrowing the notation of wiederholt et al 2018 habitats are defined to be either the origin o intermediate i or destination d the population travels from o to i during season 1 and from i to d during season 2 the adult survival probability a o i d and per capita juvenile recruitment j o i d for a focal migratory route during the annual cycle where the breeding season is the anniversary season are given by 3 1 a o i d s o i b a s i b a s i d n a s d n a and j o i d s o i b a s i b a r i b s i d n j s d n j where superscripts a and j refer to the adult and juvenile stages respectively subscripts b and n refer to the breeding and non breeding seasons respectively brackets indicate the split of seasons note that wiederholt et al use s j l k i to represent an individual in stage i migrating from habitat j to habitat l in season k we have adjusted equations 1 and 2 in wiederholt et al 2018 so that in 3 1 migration happens first for further information see appendix d then the per capita contribution of a pathway c o i d is defined to be 3 2 c o i d a o i d j o i d s o i b a s i b a s i d n a s d n a s o i b a s i b a r i b s i d n j s d n j now we translate the notation of wiederholt et al 2018 into our notation hence we consider a model with two seasons two stages and three habitats s 2 c 2 n 3 we set the breeding and non breeding seasons to be season 1 and season 2 respectively juveniles and adults are set to be stage 1 and stage 2 respectively for the ease of comparison we keep the habitat labels o i and d both seasons have a specified pathway hence ϕ 2 and φ 1 2 we specify the migratory route to be p o i d the demographic matrices associated with habitats o i and d in season 1 breeding and season 2 non breeding are d o 1 0 s o 1 2 r o 1 s o 1 1 s o 1 2 d o 2 s o 2 1 0 0 s o 2 2 d i 1 0 s i 1 2 r i 1 s i 1 1 s i 1 2 d i 2 s i 2 1 0 0 s i 2 2 d d 1 0 s d 1 2 r d 1 s d 1 1 s d 1 2 d d 2 s d 2 1 0 0 s d 2 2 therefore from 2 3 we obtain d 1 0 s o 1 2 r o 1 0 0 0 0 s o 1 1 s o 1 2 0 0 0 0 0 0 0 s i 1 2 r i 1 0 0 0 0 s i 1 1 s i 1 2 0 0 0 0 0 0 0 s d 1 2 r d 1 0 0 0 0 s d 1 1 s d 1 2 and d 2 s o 2 1 0 0 0 0 0 0 s o 2 2 0 0 0 0 0 0 s i 2 1 0 0 0 0 0 0 s i 2 2 0 0 0 0 0 0 s d 2 1 0 0 0 0 0 0 s d 2 2 furthermore the matrices storing the probability of surviving migration s k i for stage 1 juveniles and stage 2 adults are s 1 1 s o o 1 1 s o i 1 1 s o d 1 1 s i o 1 1 s i i 1 1 s i d 1 1 s d o 1 1 s d i 1 1 s d d 1 1 s 2 1 s o o 2 1 s o i 2 1 s o d 2 1 s i o 2 1 s i i 2 1 s i d 2 1 s d o 2 1 s d i 2 1 s d d 2 1 s 1 2 s o o 1 2 s o i 1 2 s o d 1 2 s i o 1 2 s i i 1 2 s i d 1 2 s d o 1 2 s d i 1 2 s d d 1 2 s 2 2 s o o 2 2 s o i 2 2 s o d 2 2 s i o 2 2 s i i 2 2 s i d 2 2 s d o 2 2 s d i 2 2 s d d 2 2 substituting into eq 2 5 gives s 1 s o o 1 1 0 s o i 1 1 0 s o d 1 1 0 0 s o o 1 2 0 s o i 1 2 0 s o d 1 2 s i o 1 1 0 s i i 1 1 0 s i d 1 1 0 0 s i o 1 2 0 s i i 1 2 0 s i d 1 2 s d o 1 1 0 s d i 1 1 0 s d d 1 1 0 0 s d o 1 2 0 s d i 1 2 0 s d d 1 2 and s 2 s o o 2 1 0 s o i 2 1 0 s o d 2 1 0 0 s o o 2 2 0 s o i 2 2 0 s o d 2 2 s i o 2 1 0 s i i 2 1 0 s i d 2 1 0 0 s i o 2 2 0 s i i 2 2 0 s i d 2 2 s d o 2 1 0 s d i 2 1 0 s d d 2 1 0 0 s d o 2 2 0 s d i 2 2 0 s d d 2 2 recall that in our notation s j l k i is the probability that an individual in stage i survives travelling from habitat l to habitat j during season k the seasonal survival matrices where migration happens first a ˆ k d k s k see 2 7 are a ˆ 1 0 s o 1 2 r o 1 s o o 1 2 0 s o 1 2 r o 1 s o i 1 2 0 s o 1 2 r o 1 s o d 1 2 s o 1 1 s o o 1 1 s o 1 2 s o o 1 2 s o 1 1 s o i 1 1 s o 1 2 s o i 1 2 s o 1 1 s o d 1 1 s o 1 2 s o d 1 2 0 s i 1 2 r i 1 s i o 1 2 0 s i 1 2 r i 1 s i i 1 2 0 s i 1 2 r i 1 s i d 1 2 s i 1 1 s i o 1 1 s i 1 2 s i o 1 2 s i 1 1 s i i 1 1 s i 1 2 s i i 1 2 s i 1 1 s i d 1 1 s i 1 2 s i d 1 2 0 s d 1 2 r d 1 s d o 1 2 0 s d 1 2 r d 1 s d i 1 2 0 s d 1 2 r d 1 s d d 1 2 s d 1 1 s d o 1 1 s d 1 2 s d o 1 2 s d 1 1 s d i 1 1 s d 1 2 s d i 1 2 s d 1 1 s d d 1 1 s d 1 2 s d d 1 2 a ˆ 2 s o 2 1 s o o 2 1 0 s o 2 1 s o i 2 1 0 s o 2 1 s o d 2 1 0 0 s o 2 2 s o o 2 2 0 s o 2 2 s o i 2 2 0 s o 2 2 s o d 2 2 s i 2 1 s i o 2 1 0 s i 2 1 s i i 2 1 0 s i 2 1 s i d 2 1 0 0 s i 2 2 s i o 2 2 0 s i 2 2 s i i 2 2 0 s i 2 2 s i d 2 2 s d 2 1 s d o 2 1 0 s d 2 1 s d i 2 1 0 s d 2 1 s d d 2 1 0 0 s d 2 2 s d o 2 2 0 s d 2 2 s d i 2 2 0 s d 2 2 s d d 2 2 then by 2 11 the subpopulation pathway contribution metric c p where the breeding season is the anniversary season is given by c p 1 t a ˆ 2 e 3 d i j 2 a ˆ 1 e 3 i o j 2 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 s d 2 1 s d i 2 1 0 0 0 0 0 0 s d 2 2 s d i 2 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 s i 1 2 r i 1 s i o 1 2 0 0 0 0 s i 1 1 s i o 1 1 s i 1 2 s i o 1 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 s d 2 1 s d i 2 1 s d 2 2 s d i 2 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 s i 1 2 r i 1 s i o 1 2 0 0 0 0 s i 1 1 s i o 1 1 s i 1 2 s i o 1 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 s d 2 2 s d i 2 2 s i 1 1 s i o 1 1 s d 2 1 s d i 2 1 s i 1 2 r i 1 s i o 1 2 s d 2 2 s d i 2 2 s i 1 2 s i o 1 2 0 0 0 0 to more readily compare the above equation to 3 2 we reset the labels above for season 1 and season 2 to b and n respectively we also reset the labels for stage 1 and stage 2 to j and a respectively hence c p s d n a s d i n a s i b j s i o b j s d n j s d i n j s i b a r i b s i o b a s d n a s d i n a s i b a s i o b a 0 0 0 0 accounting for the difference between s j l k i in our notation and that in wiederholt et al 2018 we see that the second entry equals c o i d the first entry calculates the contribution of juveniles that transition into adults over the annual cycle the final four entries are zero as the migratory route p has a specified pathway during the first season all individuals in the focal subpopulation start the annual cycle in habitat o and so the contribution of habitats i and d is zero thus our subpopulation pathway contribution metric generalises that developed in wiederholt et al 2018 example 3 2 we consider a population model for the monarch butterfly danaus plexippus in eastern north america the population size of migratory monarch butterflies in eastern north america is estimated to have declined from 300 900 million in the 1990s to 33 200 million in recent years vidal and rendón salinas 2014 leading to the eastern monarch migration being classified as an endangered phenomenon advani 2015 brower et al 2012 a number of studies have assessed the population viability of the monarch butterfly including advani 2015 flockhart et al 2015 calculation of the contribution metrics associated with the monarch butterfly population in eastern north america can provide further insight into how best to conserve this iconic species we use a model inspired by those in flockhart et al 2015 and sample et al 2018 our model is for the female population and contains five stages c 5 four habitats n 4 and twelve seasons s 12 the life stages are immature individuals including eggs larval and pupal development until eclosion 1 eclosed butterflies in their first month of life and in reproductive diapause 2 eclosed butterflies in their second month of life or older and in reproductive diapause 3 eclosed butterflies in their first month of life and in breeding condition 4 and eclosed butterflies in their second month of life or older and in breeding condition 5 monarch butterflies complete a long distance migration over one year between mexico m southern us s central us c and northern us n fig 3 1 depicts the life cycle of female monarch butterflies in region j m s c n where nodes represent stages and edges represent transitions between stages the data used to calculate the demographic rates we use are recorded in the tables in appendix e 1 mexico is a wintering region whilst the other three regions are breeding regions the survival rates of migration are given in fig 3 2 for each season fig 3 3 depicts the proportion of the population travelling along each pathway the corresponding matrices s k i and p k i are recorded in appendix e 2 recall that these matrices are used to construct s and p which are used to calculate the m matrices via 2 6 we take ϕ 1 and set φ to be each season in turn since all the population starts the annual cycle in mexico only the first block of c p i and c p i are populated hence we only record these values in table 3 1 when the c p i metrics are averaged over stage only c m p i is nonzero and is equal to the nonzero values in the corresponding c p i similarly when averaging over stage only c 2 p i and c 3 p i are nonzero and are both equal to the nonzero values in the corresponding c p i based on the contribution metrics the pathway between the south s and central c regions in june season 6 contributes the most the pathway between central c and north n in june contributes the least therefore to increase the total population size the quality of the route between c and n could be improved alternatively managers could increase the proportion of monarch butterflies that travel between s and c in june migratory insect pests have been subject to this type of management pedgley 1993 however this type of management may not be possible as many migratory insects have weak control over their flightpaths partly due to their migrations being multi generational gao et al 2020 management actions that change the migratory route of individuals have been observed in birds hartup et al 2004 ungulates jones et al 2014 and marine migrants perry et al 2013 example 3 3 we continue our study of the annual cycle model for the monarch butterfly considered in example 3 2 namely we assess the contribution of various full migratory routes we set ϕ 12 and φ 1 2 12 in other words all seasons of the annual cycle have a specified pathway we calculate the pathway contribution metrics for the following full migratory routes 3 3 p 1 m m m m s c n c n c m m m p 2 m m m m s s c c c c s m m p 3 m m m m s s c c c s s m m p 4 m m m m s c n n n c c m m p 5 m m m m s s n n n s s m m here p 1 is the full migratory route where for all seasons k 1 2 12 the specified pathway is the pathway with the lowest contribution in season k see table 3 1 on the other hand p 2 is the full migratory route where the pathway specified in season k is the pathway with the highest contribution metric as in example 3 2 all the population starts the annual cycle in mexico m so only the first block of c p i and c p i are populated hence we only record these values in table 3 2 furthermore when averaging over stage and habitat only c m p i c 2 p i and c 3 p i are nonzero and are equal to the nonzero values in the corresponding c p i table 3 2 shows that the subpopulation travelling along p 1 does not contribute to the total population further investigation shows that during october season 10 the subpopulation does not contain any individuals in habitat c that are in stage 2 or stage 3 hence no individuals use the pathway from c m during october as only individuals in stage 2 and 3 use this pathway see fig 3 3 therefore p 1 is not a viable migratory route over all the migratory routes considered presently we see that individuals travelling along p 2 contribute the most to the total population as expected to increase the total population managers can increase the proportion of monarch butterflies that use p 2 example 3 4 here we demonstrate how the habitat contribution metrics and their maximum values can play a role in predicting the effect of management actions for populations modelled by 2 1 specifically suppose that at the start of year t members of the population are added via some reintroduction scheme structured over stage and habitat according to the vector u r c n updating the annual cycle model 2 1 appropriately the population after one year is then given by x t 1 a x t u in particular invoking 2 13 we compute that 3 4 x t 1 1 1 c n t x t 1 1 c n t a x t u c x t c u where recall c c p 0 denotes the row vector of habitat contribution metrics consequently it follows from 3 4 that the increase in the size of the population over one year caused by u is given by c u therefore for fixed x t the size of the population after one year x t 1 1 is maximised by maximising c u evidently c u increases as u 1 increases but for fixed u u 1 we see that the maximum of c u is equal to h u where h is the largest component of c and the corresponding u is equal to u e n j in words the maximum increase in population is achieved by adding all individuals to the stage and habitat which contributes the most this choice of management action may not be ecologically practicable but the above analysis indicates both the theoretical maximum obtainable and the effect on x t 1 1 of other reintroduction schemes we comment that adding individuals during a year say in some other season p can be accommodated by rewriting the annual cycle model 2 1 and 2 2 so that the anniversary season is p 4 discussion we have provided vectorised formulae for two novel pathway contribution metrics to calculate the importance of an individual that travels along specific pathways over any number of prescribed seasons in an annual cycle recall the working context that a migratory population is represented by a general so called annual cycle model a matrix structured population model with discrete temporal and spatial structure the underlying model and subsequent metrics are presented in sections 2 2 and 2 3 respectively and can be applied widely our formulae generalise previous frameworks for calculating contribution metrics sample et al 2019 wiederholt et al 2018 and familiar habitat contribution metrics are recovered as a special case our approach allows the contribution of any particular part s of the migratory network to be calculated including from individuals undertaking a full annual migratory route as well as for models which capture multiple life stages that is stage structured population models the conjunction of these features is a novel aspect of our work using linear algebra methods we have constructed the contribution metrics such that a pathway of interest can be specified in any season this allows population managers to focus on particular parts of the migratory network and assess their contributions to the total population hence it is possible to make a detailed analysis of populations with numerous distinct life histories this provides managers with insights into the role differential migration plays in migratory connectivity and helps to inform conservation actions briedis and bauer 2018 furthermore our approach can be used to compare within the same annual cycle the contributions of the same pathway taken in different seasons i e breeding or non breeding previously this calculation would require a permutation of the annual cycle model pathway contributions could only be calculated for the anniversary season since contribution metrics are transient indices they are altered by permutations of the annual cycle model hence previous pathway contribution metrics are highly dependent on the anniversary season it was complicated to compare the contribution of the same pathway used in different seasons with our metrics the contribution of a pathway can be calculated for all seasons of the annual cycle without permuting the annual cycle model additionally our metrics allow managers to see which subpopulations contribute the most to the overall population and distinguish the different contribution rates between life stages in these subpopulations we have also provided easy to use vectorised formulae to average the pathway contribution metrics over habitats and over stages so that the contribution of all individuals starting in the same stage or habitat can be quantified these averaged contribution metrics appear in section 2 7 and are studied in more depth in smith 2023 with reference to our case studies from section 3 for example in the monarch butterfly study see example 3 2 we see that the contribution of an individual that starts the annual cycle in mexico m and stage 2 and migrates from southern us s to central us c in may season 5 is 1 01 essentially every individual only replaces itself whereas an individual that starts the annual cycle in mexico and stage 2 and migrates from the southern us to central us in june season 6 has a contribution of 13 07 evidently the pathway from southern us to central us has a much higher contribution in june than it does in may then considering full migratory routes in example 3 3 the contribution metrics for five distinct migratory routes are calculated for the monarch butterfly model from example 3 2 we see that the contribution of an individual in a subpopulation to the total population c p i can range from 0 to 3 43 table 3 2 furthermore changing the pathway taken in just one season can significantly alter the contribution of an individual p 2 and p 3 only differ by the pathway taken during season 10 see 3 3 however c p 2 3 43 and c p 3 1 67 table 3 2 in other words an individual following p 2 is expected to contribute approximately twice as much to the total population as an individual that follows p 3 despite using the same pathways for eleven out of twelve seasons of the annual cycle arguably obtaining these insights would not have been possible with previous metrics we comment that all the contribution metrics considered are quantities which capture transient behaviour of a population there has now for some time been a recognition in the academic literature of the importance of transient dynamics in ecological modelling see for instance hastings 2004 hastings et al 2018 and stott et al 2011 the pathway contribution metrics we have constructed can be considered simultaneously with the habitat contribution metrics and the asymptotic growth rate as is done in section 2 6 in particular there is a connection between transient and asymptotic growth or decline this connection provides insight into the trade offs between asymptotic and transient dynamics increasing the asymptotic growth of the population may not result in short term growth and vice versa insight of these trade offs allows managers to choose conservation strategies that benefit the population in both the short and long term by way of limitations one drawback of our pathway contribution metrics is that by construction they keep track of where individuals are in space but not their stage as a result the stage that an individual is in whilst using a migratory pathway is only recorded for the first season of the annual cycle therefore the pathway contribution metrics do not quantify the importance of the stage in which an individual uses a migratory pathway instead the importance of the initial stage of an individual and the pathways it then uses is quantified hence our metrics do not tell managers which stage of the population to focus conservation actions on for specific pathways of the migratory route additionally our framework is very much geared towards the density independent linear models considered indeed establishing a comparable notion of pathway contribution metrics for full migratory routes for general density dependent nonlinear models seems challenging furthermore the annual cycle model is discrete in nature and so managers are required to make a number of choices when defining the model including how many stage classes to divide the population into matrix models have been criticised for dividing populations into discrete stages despite being classified by continuous traits ellner and rees 2006 these discretization choices determine the dimension of the matrix which then impacts the outputs of the model and introduces discretization errors much research has been devoted to understanding the effect of these choices on matrix models including for example picard and liang 2014 salguero gomez and plotkin 2010 and numerous algorithms that collapse population matrix dimensions whilst maintaining the intrinsic characteristics of the population have been proposed for non spatial population matrices bienvenu et al 2017 hooley 2000 picard et al 2010 however to the best of our knowledge we are unaware of similar algorithms for use on the spatial models considered here consequently at this time we are not able to systematically study the effects of the choice of number of model stages on pathway contribution metrics we suggest that the development of such algorithms is a fruitful future line of enquiry to evaluate and quantify discretization errors looking ahead recent work has considered how existing contribution metrics are affected by perturbations see sample et al 2020 an upcoming work is to provide a modelling framework for perturbations of the contribution metrics considered here smith et al 2022 this could be used to assess the robustness of the population to changes in demographic and migration rates which can further inform how to apply conservation measures another area for future research is to examine how migratory strategies influence the value of contribution metrics we envisage that this could be studied by specifying a number of annual cycle models with structure corresponding to different migratory strategies i e full migrants or partial migrants and carrying out a meta analysis to see if there are significant relationships between the migratory strategy and the corresponding contribution metrics in closing we have provided easy to use formulae for constructing and averaging contribution metrics across stages and across habitats in seasonal systems with complex migratory patterns our formula are all vectorised which allows the metrics to be easily calculated from the population projection matrices these matrices are constructed similarly to standard matrix population models and are based on demographic rates migratory proportions and migratory survival rates these results provide another and novel tool for developing improved ecological management strategies credit authorship contribution statement phoebe smith conceptualization methodology software writing original draft writing review editing visualization chris guiver conceptualization methodology writing original draft writing review editing ben adams conceptualization writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix the appendix is divided into five sections the first contains a mathematical derivation of the equality 2 8 the second compares our per capita subpopulation pathway contribution metrics with the pathway contribution metrics in sample et al 2019 the third contains mathematical derivations of the averaged contribution metrics the fourth and fifth contain further material for examples 3 1 and 3 2 respectively not given in the main text appendix a further material for section 2 2 we provide a derivation of the equality 2 8 recorded as the following result lemma a 1 for every k 1 2 s the matrices a k and a ˆ k given by 2 4 and 2 7 respectively satisfy a k x y a ˆ k x y p k x y where p k is as in 2 5 and a x y represents the x y th block of a in words the above lemma states that the x y th block of the seasonal matrix a k is equal to the matrix product of the x y th block of the seasonal survival matrix a ˆ k and the x y th block of the block matrix p k which contains the habitat movement probabilities p k i proof of lemma a 1 fix k 1 s recall the definitions of a k and a ˆ k in eqs 2 4 and 2 7 respectively namely a k d k m k and a ˆ k d k s k furthermore recall that the block matrices p k s k and m k are constructed via p k i 1 c p k i e c i i s k i 1 c s k i e c i i m k i 1 c m k i e c i i we note that the construction of these block matrices results in each c c block being a diagonal matrix in particular the i i th entry of the x y th block of p k s k and m k is given by the x y th entry of p k i s k i and m k i respectively in other words the x y th block of p k s k and m k are given by p k x y diag i p k i x y s k x y diag i s k i x y m k x y diag i m k i x y respectively we also recall from 2 6 that m k p k s k where is the hadamard product collectively the above gives diag i m k i x y p k x y diag i p k i s k i x y diag i p x y i s x y i and so m k x y s k x y p k x y we recall that the block matrix d k is constructed via d k j 1 n e n j d j k d 1 k 0 0 0 d 2 k 0 0 0 d n k hence d k is a block diagonal matrix owing to this special structure of d k we observe that a k x y d k m k x y i d k x i m k i y d k x x m k x y therefore a k x y d x k m k x y d x k s k x y p k x y i d k x i s k i y p k x y a ˆ k x y p k x y as required appendix b a comparison with the pathway contribution metrics of sample et al 2019 here we present a hypothetical annual cycle model to illustrate the connection between our subpopulation pathway metric c p and the contribution metrics defined in sample et al 2019 there the authors define a pathway contribution metric as the annual per capita contribution of an individual of class x starting at node r and travelling to node d at time t is b 1 c r d t x 1 n c t p r d t x a t t e n r d h c x τ t 1 t s 1 a τ t 1 n c where is the hadamard entrywise product p r d t x is the proportion of individuals of class x at node r that will travel to node d at time t contained in movement matrix q t x of eq 5 and h c x is a c c zero matrix with ones in column x recall that e n r d is an n n zero matrix with a 1 at position r d sample et al 2019 page 4 we aim to translate b 1 into our notation first we note that for simplicity we assume that seasons are indexed such that the anniversary season is always season 1 hence t 1 furthermore we note that the demographic d j k and migration m k i matrices we define are the transpose of those defined in sample et al 2019 eq 3 and eq 5 however our construction of d k and m k results in these matrices being equal to the equivalent matrices in sample et al 2019 eq 2 and eq 4 as a result when the seasonal matrices a k are given by the same product of d k and m k the annual cycle matrices a ˆ 1 in sample et al 2019 eq 6 and a in our notation are consistent with each other we believe that there is a typo in the order of the subscripts r and d in our notation we would use the subscript d r to denote the pathway from habitat r to habitat d that is we would denote this pathway contribution as c d r t x owing to the columns of the matrices denoting where the individual started whilst the rows indicate where the individual ended up for the same reasons we change the order of the subscripts on p and e furthermore we believe that h c x in b 1 should be replaced with r c x a c c zero matrix with ones in row x making the discussed changes to notation gives c d r 1 x 1 n c t p d r 1 x a 1 t e n d r r c x τ 2 s a τ t 1 n c and taking transposes gives b 2 c d r 1 x 1 n c t p d r 1 x τ 2 s a τ a 1 e n r d h c x 1 n c here a 1 e n r d h c x is a c n c n matrix where the x th column of the r d th block is equal to the x th column of the r d th block of a 1 and all other entries are zero in other words a 1 e n r d h c x is the projection matrix for the first season that projects individuals that start in stage class x and habitat r and travel to habitat d hence c d r 1 x is the contribution of individuals that start the annual cycle in stage x and habitat r and travel from habitat r to habitat d during season 1 if the total population were to travel from r to d during the first season adjusting b 2 to our usual notation we obtain c r i p 1 c n t p d r 1 i τ 2 s a τ a 1 e n r d h c x 1 c n where p r d 0 0 note that this is still only tracking the x th stage that travel along p 1 we use 2 11 to calculate the contribution of all stages along p 1 and obtain b 3 where only the r th 1 c vector of c p is non zero as we are only tracking individuals that start the annual cycle in habitat r furthermore a ˆ 1 is a 1 where each element a i j x has been divided by p i j x see appendix a for proof we provide an example to help visualise the difference between b 1 and b 3 and that to the best of our knowledge the formula b 1 as presented above does not quite compute what the authors of sample et al 2019 claim for which purpose consider an annual cycle model with c 2 n 2 and s 1 let the demographic matrices associated with habitat 1 and 2 be given by d 1 0 0 1 0 and d 2 0 1 0 0 respectively furthermore stages 1 and 2 migrate in the same way such that m 1 m 2 p 1 p 2 s 1 s 2 0 0 1 0 that is all individuals migrate from habitat 1 to habitat 2 and all survive then the seasonal survival matrix a ˆ and the seasonal matrix a are given by a a ˆ a 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 thus over the course of the year which equals a single season the population projection is b 4 x t 1 a x t 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 x 1 1 t x 1 2 t x 2 1 t x 2 2 t 0 0 x 1 2 t 0 where x j i denotes the population size in stage i and habitat j hence the only state that contributes during time t is x 2 t individuals starting season t in stage 2 and habitat 1 we calculate the contribution of individuals starting the season in stage 2 and habitat 1 that migrate to habitat 2 therefore we set r 1 d 2 and i 2 using a t t e n r d h c x from b 1 the formula in sample et al 2019 we obtain a t e n r d h c i 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 t 0 1 0 0 0 1 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 hence we will obtain c 12 2 0 and so this formula calculates that individuals starting the season in stage 2 and habitat 1 that migrate to habitat 2 do not contribute to the next cycle or season which we can see is false by b 4 now using our method we obtain a ˆ e n d r j c 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 1 1 1 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 1 1 0 0 e 4 32 0 hence c 1 2 p 1 thus individuals that start the season in stage 2 and habitat 1 and migrate to habitat 2 replace themselves over the annual cycle as expected from b 4 appendix c averaged contribution metrics we provide further details not given in section 2 7 namely we derive the scalar averaged contribution metrics from the vectorised formulations we do this for the two forms of averaged contribution metrics separately c 1 contribution metrics averaged over stage here we give the derivation of 2 25 from 2 24 writing out the various matrices and vectors in 2 24 we see that which setting x j i 1 c x j i is the desired expression 2 25 c 2 contribution metrics averaged over habitat here we give the derivation of 2 27 from 2 26 writing out the various matrices and vectors in 2 26 we see that which setting x i j n c x j i is the desired expression 2 27 appendix d further material for example 3 1 we provide additional details for example 3 1 not given in the main text namely we convert the annual cycle model of wiederholt et al in wiederholt et al 2018 so that migration takes place before demography for which purpose the authors of wiederholt et al 2018 split the annual cycle into four seasons breeding breeding to non breeding transition non breeding and non breeding to breeding transition habitats are referred to as seasonally occupied during the origin o intermediate i or destination d time periods equations are provided for the adult survival probability a o i d and per capita juvenile recruitment j o i d for a focal migratory route o i d during their annual cycle d 1 a o i d s o a s o i a s i a s i d a where s o a is the adult survival probability of an individual using habitat o and s o i a is the survival probability of adults transitioning between habitats o and i in d 1 demography is happening before migration throughout the paper we have assumed that migration happens first although we note that the model can be structured such that demography happens first hence here we provide an equation for the adult survival probability a o i d when migration happens before demography that is a o i d s o i a s i a s i d a s d a here we have used brackets to indicate the split of seasons noting that in our framework this model would be defined as a two season model in other words the breeding season and the breeding to non breeding transition are combined to be one season similarly the non breeding season and the non breeding to breeding transition are combined to be one season we do similar rearrangements for the per capita juvenile recruitment j o i d equations we note that the calculation of juvenile survival depends on which season is considered for the anniversary date in the annual cycle wiederholt et al 2018 and consider when anniversary season is the breeding season first in this case wiederholt et al define j o i d s o a r o s o i j s i j s i d j where r o is the number of juveniles produced per adult that survives in habitat o and s o i j is the juvenile survival probability between habitat o and i defining the model such that migration happens first gives j o i d s o i a s i a r i s i d j s d j secondly when the non breeding season is the anniversary season wiederholt et al define the per capita recruitment of juveniles by j o i d s o a s o i a s i a r i s i d j defining the model such that migration happens first gives j o i d s o i a s i a s i d a s d a r d finally the pathway contribution is given by c o i d a o i d j o i d where the order in which migration and demography are defined must be consistent for a o i d and j o i d appendix e further material for examples 3 2 and 3 3 we provide further details not given in the main text e 1 demographic rates see tables e 1 e 3 e 2 migration rates see tables e 4 and e 5 
24401,migratory species make use of different habitats and pathways at different life stages and in different seasons ecological management strategies proposed for migratory species should acknowledge the importance of each component of the migratory cycle metapopulation approaches used to assess the quality of habitats do not capture key features of migratory populations in recent years contribution metrics roughly the annual contribution to a population from a single individual that are suitable for migratory species and quantify the quality of habitats and pathways have been developed however existing contribution metrics are either not suitable for use on species that experience complex life histories or movement strategies or are only able to differentiate between pathways taken during the first season of the annual cycle here we develop a modelling framework to calculate contribution metrics that quantify the contribution of individuals migrating along specific pathways over any number of seasons in the annual cycle our framework yields easily computable formulae even for population models with complex migratory patterns we illustrate our framework using hypothetical examples as well as a model inspired by the monarch butterfly and highlight ecological insights that could not have been found using existing contribution metrics we envisage our framework being used to identify the most important or vulnerable components of the migratory cycle such that appropriate conservation strategies may be applied keywords contribution metric matrix population modelling migration spatially structured population theoretical ecology data availability data will be made available on request 1 introduction wildlife populations may make use of different habitats at different life stages and in different seasons the dynamics of a population over an entire year depend on contributions from each component of the cycle contribution metrics which are derived from a population model can be used to quantify the importance of each component existing contribution metrics quantify the contribution of individuals migrating along a specific pathway in the first season of the annual cycle or individuals in a specific habitat in the first season of the annual cycle here we introduce two new metrics that quantify the contribution of individuals migrating along specific pathways over several seasons of the annual cycle pathways that include every season describe full migratory routes so our metrics provide greater insight into how different migratory pathways contribute to the dynamics of the total population migration is a behavioural adaptation that has evolved to cope with seasonal changes to environments however many migratory species are suffering serious declines due to environmental and climate change huntley et al 2006 robinson et al 2009 wilcove and wikelski 2008 the conservation of migratory species requires adequate protection across its entire range and careful consideration of factors such as habitat connectivity and migratory bottlenecks runge et al 2014 weber et al 1999 the challenge of providing this protection has resulted in iucn international union for conservation of nature targets being met less successfully for migratory species than for sedentary species runge et al 2015 the conservation of migratory species is important at the ecosystem scale the life histories of some species are based around the predictable seasonal movements of migrants bauer and hoye 2014 migrants also provide a large scale linking of ecosystems transporting nutrients energy and other organisms bauer and hoye 2014 wilcove and wikelski 2008 the decline of a migratory population can have significant ecological impacts at the level of the population community and ecosystem shuter et al 2011 the study of migratory species is usually done on the level of the individual its choices and their consequences bowlin et al 2010 contribution metrics allow for migratory species to be studied at the population level the first contribution metric was developed by runge et al 2006 using theory from matrix population models which dates back to the 1940s lefkovitch 1965 leslie 1945 1948 see more recently caswell 2001 however this metric did not account for crucial elements of migratory models such as seasonality differences between breeding and non breeding habitats and regular movements between habitats taylor and hall 2012 wiederholt et al 2018 wiederholt et al 2018 adapted runge et al s metric such that the contribution of an individual to a migratory population can be calculated across a two season annual cycle this metric was then generalised further by sample et al 2019 in order to calculate the contribution of an individual migrating along a specific pathway in the first season of the annual cycle and to calculate the contribution of individuals that are in a specific habitat in the first season of the annual cycle inspired by the line of inquiry across runge et al 2006 sample et al 2019 wiederholt et al 2018 the purpose of the present paper is to further generalise contribution metrics in order to calculate the contribution of an individual migrating along specific pathways over any number of seasons in an annual cycle indeed we propose two new so called pathway contribution metrics for a class of discrete migratory matrix population projection models which are stratified according to stage and habitat this generalisation allows us to quantify the contribution of full migratory routes or any sections of the migratory route that may be of interest perhaps due to migratory bottlenecks buler and moore 2011 runge et al 2014 our method can be used to calculate contribution metrics for migratory models with any number of seasons habitats or stages furthermore in certain cases we provide formulae to link our pathway metrics to the habitat metrics in sample et al 2019 and to the asymptotic growth rate of the population the paper is organised as follows in section 2 we gather notation describe the underlying model and present our new pathway contribution metrics the main technical ingredients are linear algebra matrix methods in section 3 we illustrate the utility of the metrics by applying them to existing models from the literature in section 4 we interpret our results and provide summarising remarks we provide an appendix containing some technical details and supporting information for the examples 2 materials and methods here we give a detailed account of the construction analysis and interpretation of our pathway contribution metrics we begin by introducing the underlying dynamic migratory population model which we term the annual cycle model we then set out how to calculate pathway contribution metrics from this model and how to average across several stages and habitats we also elucidate the connection between the new pathway contribution metrics the existing habitat contribution metrics and the asymptotic growth rate 2 1 mathematical notation here we introduce frequently used operations we use operations involving kronecker products to construct block matrices with particular structures we use e n i j to denote a n n zero matrix with a one in the i j th entry see table 2 1 let b i r m m for all i 1 n and let b x y i denote the x y th entry of b i we use the operation a i 1 n e n i i b i to construct a block diagonal matrix a r m n m n with n 2 blocks each of size m m where the i i th block is given by b i we use the operation c i 1 n b i e n i i to construct a block matrix c r m n m n with m 2 blocks each of size n n each block is a diagonal matrix and in particular b x y i is the i i th entry of the x y th block of c we use to denote hadamard division of vectors written z y x for vectors x and y and where z j 0 x j 0 y j x j otherwise here x j and y j denote the j th entries of x and y respectively we note that for nonnegative matrices a r p m and vectors x r m we have 1 p t a x j 1 p a x j a x 1 where 1 denotes the usual 1 norm on real euclidean space multiplying a nonnegative matrix on the left by 1 t returns a row vector composed of the column sums of the matrix finally for compatibly sized vectors x and y we let row x y x y denote the row operation which simply arranges two vectors into one row we use this operation for wholly presentational reasons when writing the right hand side of the above is not practicable further mathematical notation is listed in table 2 1 2 2 the annual cycle model here we discuss the underlying migratory population model which is the essential foundation for the various contribution metrics constructed in section 2 3 all mathematical notation used is recorded in tables 2 1 and 2 2 the so called annual cycle model borrows theory from matrix population models and source sink models see for example caswell 2001 cushing 1998 and pulliam 1988 respectively so that matrix entries contain information based on demographic rates and movement rates the latter between discrete habitats or patches the model may be visualised as a network where nodes represent habitats and edges represent migration pathways as is done in sample et al 2018 and taylor and hall 2012 the annual cycle model is particularly inspired by the models appearing in hunter and caswell 2005 and sample et al 2019 a key novel feature of the present model is the introduction of the so called seasonal survival matrices see 2 7 as shall be explained in due course these matrices can be used to highlight pathways of interest and allow managers to gain more insight into the important factors across the whole annual cycle we provide details of the annual cycle model which stratifies the population of interest by stage structure and spatial location or habitat we assume there are c stages and n habitats we define an annual cycle matrix a that projects a population over an annual cycle from a fixed anniversary season the annual cycle matrix contains the demographic update information associated with habitats as well as the migration update information associated with migration pathways thus the underlying discrete time annual cycle model is given by 2 1 x t 1 a x t t 0 1 2 x 0 x 0 where a r c n c n is the annual cycle matrix and x t r c n is the structured population at annual time step t recorded during the anniversary season the vector x 0 models the initial population distribution the asymptotic growth rate λ of the population is well known to be given by the dominant eigenvalue of a equal to the spectral radius of a the quantity λ describes the asymptotic behaviour of nonzero solutions of 2 1 the spatial structure encoded in a and x t can be decomposed into n 2 blocks and n subvectors respectively by writing here a i j r c c is the population projection matrix for the subpopulation that starts the annual cycle in habitat j and is in habitat i at the end of the annual cycle and x j t r c represents the stage distribution within habitat j at the start of the annual cycle and at time step t each x j t is a vector of the form x j t x j 1 t x j c t where x j i t denotes the number of individuals in stage i and habitat j at the start of the annual cycle the life rates experienced by a migratory population depend on the season hence the annual cycle is decomposed into s seasons each of which is assigned a label k 1 s such that the anniversary season is season 1 and consecutive seasons are assigned consecutive numbers the term season is used somewhat loosely and is essentially a division of the annual cycle into smaller units of time thus the annual cycle matrix a is in fact constructed by taking the product of s seasonal matrices a k r c n c n via left multiplication that is 2 2 a k 1 s a k a s a 2 a 1 the biological interpretation of each element of the seasonal matrices is hard to infer owing to the demographic and migration information being entangled we define d j k r c c to be the demographic projection matrix associated with habitat j in season k and let d x y denote the x y th entry of d j k each d x y term is assumed to be linear and constant in time and quantifies the survival growth or fecundity of stage y in other words d x y represents the number of individuals in stage x generated from an individual in stage y and habitat j during season k furthermore we define m k i r n n to be the migration projection matrix associated with stage i in season k and let m x y denote the x y th entry of m k i each m x y term represents the probability that an individual in stage i migrates from habitat y to x and survives during season k inspired by sample et al 2019 we use kronecker products to construct two block matrices one of these matrices d k r c n c n contains the demographic update information for the total population in season k whilst the other m k r c n c n contains the migration update information for the total population in season k we define d k and m k by 2 3 d k j 1 n e n j j d j k and m k i 1 c m k i e c i i where recall e n i i is a n n matrix of zeros apart from a one in the i i th entry the construction of d k results in a block diagonal matrix where the j j th block is given by d j k whilst the construction of m k results in a block matrix where each block is a diagonal matrix and m x y of m k i is the i i th term of the x y th block of m k see section 2 1 when constructing the seasonal matrices a k r c n c n we assume that within a season migration is followed by demography hence 2 4 a k d k m k k 1 s the upshot of the above construction is that the seasonal matrices can also be decomposed into n 2 blocks namely where a k i j r c c is the population projection matrix for the subpopulation that moves from habitat j to habitat i during season k the migration update information contains information about the proportion of individuals migrating and the survival probability associated with the migration we impose additional structure on the entries m x y of the migratory matrices m k i specifically we assume that m x y p x y s x y for all x y where p x y represents the probability that an individual in stage i migrates from habitat y to x in season k and s x y represents the migratory survival probability for an individual in stage i that migrates from habitat y to x in season k then letting p k i r n n and s k i r n n have respective components p x y and s x y it follows that p k i and s k i contain the proportion of stage i individuals that migrate in season k and the survival probability of stage i individuals during migration in season k respectively moreover defining 2 5 p k i 1 c p k i e c i i and s k i 1 c s k i e c i i a routine calculation shows that m k s k and p k are related by 2 6 m k p k s k for all k we define seasonal survival matrices a ˆ k r c n c n by 2 7 a ˆ k d k s k k 1 s these matrices encode the migratory survival and demographic rates but unlike a k do not include the probability that migration along a pathway occurs hence each block a ˆ k x y r c c may be interpreted as the population projection matrix if the whole population migrates from habitat y to habitat x during season k it is shown in appendix a that for every k 2 8 a k x y a ˆ k x y p k x y here a x y represents the x y th block of a we conclude the subsection by providing further commentary on features of the annual cycle model first we note that the above annual cycle model is equivalent to that in sample et al 2019 up to the use of transposes and that our construction results in the sub blocks of the vectors and matrices being arranged by habitat it is also possible to construct the seasonal matrices using the vec permutation approach as is done in hunter and caswell 2005 the seasonal survival matrices a ˆ k in 2 7 are a novel feature of the present work the model may also be constructed for the setting where demography is assumed to be followed by migration during each season meaning 2 4 is replaced by a k m k d k and 2 7 is replaced by a ˆ k s k d k for every k this would change the results both qualitatively and quantitatively but the construction of the contribution metrics in section 2 3 remains the same second the choice of which season is taken as the anniversary season determines the order in which the seasonal matrices are multiplied and is a choice for the modeller cyclic permutations of the seasonal matrices do not alter the dominant eigenvalue λ of the annual cycle matrix a as the nonzero eigenvalues of products of matrices are equal see horn and johnson 1990 theorem 1 3 22 or caswell 2001 p 350 in other words the asymptotic growth rate of the population λ is independent of the choice of anniversary season as one would expect however cyclic permutations of the seasonal matrices may alter the corresponding eigenvectors indeed since a is componentwise nonnegative it has a right eigenvector corresponding to λ which may be chosen to be componentwise nonnegative see for example berman and plemmons 1994 theorem 1 1 p 26 this eigenvector is often called the stable stage structure of a under reasonable ecological assumptions such as a being irreducible then λ is a simple eigenvalue by the perron frobenius theorem berman and plemmons 1994 theorem 1 4 p 27 and the stable stage structure is unique up to multiplication by a constant we comment that the stable stage structure will in general depend on the choice of anniversary season but the stable stage structure does not play a large role in the present work finally we comment on incorporating inter annual variations into the annual cycle model one generalisation of the annual cycle model described here is to allow the seasonal vital rates to depend on the year t resulting in each seasonal matrix a k and therefore a also depending on t alternatively if a population experiences inter annual variations which are periodic over multiple years then the annual cycle matrix a could be expanded to span the required number of years this again produces a time invariant model of the form 2 1 at the cost of losing track of annual variations in the population however in the present work we are most interested in transient dynamics via pathway contribution metrics that are calculated over one annual cycle thus for simplicity we do not include notation that keeps record of the year 2 3 pathway contribution metrics here we introduce two new pathway contribution metrics for the annual cycle model presented in section 2 2 our metrics generalise those introduced in sample et al 2019 and wiederholt et al 2018 the connection between our new metrics and these is discussed in appendix b and example 3 1 a summary of notation introduced is recorded in tables 2 3 and 2 4 pathway contribution metrics calculate the per capita contribution to the total population of an individual that has travelled along a specific migratory route during the annual cycle in words a pathway is the migration an individual takes between one habitat and another or itself during a season a migratory route consists of all pathways that an individual migrates along in an annual cycle to describe migratory routes mathematically we define a vector p r s 1 such that the migratory route is given by p 1 p 2 p 3 p s p s 1 here p k 0 1 n denotes the habitat in which the subpopulation starts in season k and ends in season k 1 if p k 0 then the habitat is unspecified in this case the migratory route includes all habitats at the start of season k the pathway that an individual of interest migrates along during season k is specified by p k and p k 1 define ϕ 0 1 s to be the number of seasons for which a pathway is specified and let φ r ϕ store the labels of these seasons arrows are used to indicate the migration within a season with a specified pathway k φ whilst crossed arrows are used to indicate seasons for which a pathway is not specified k φ if k φ set p k j 1 n and p k 1 l 1 n to track the subpopulation that travels from habitat j to habitat l during season k setting p k p k 1 j 0 tracks the subpopulation that remains resident in habitat j during season k if p k p k 1 0 then all subpopulations are tracked in season k to calculate pathway contribution metrics similarly to sample et al 2019 eq 8 we take the one norm of a product of s matrices however when a pathway is specified in season k we use a function of a k so that only the focal subpopulation is tracked our construction focuses solely on the proportion of the subpopulation that migrates on the given pathway we introduce 2 9 a k a ˆ k e n p k 1 p k j c k φ a k otherwise where a ˆ k e n p k 1 p k j c is a c n c n matrix which by construction has the p k 1 p k th block equal to the p k 1 p k th block of a ˆ k and all other blocks are equal to zero in other words a ˆ k e n p k 1 p k j c only stores the seasonal survival matrix for the subpopulation travelling along the pathway specified in season k the population is projected over the annual cycle from season 1 by taking the product of all a k via left multiplication therefore the annual population projection matrix in the annual cycle model for migratory route p is equal to 2 10 k 1 s a k a s a 2 a 1 in words if a particular pathway from habitat l to j is being tracked during a season k 1 s then the k th term in the product is given by a ˆ k e n j l j c otherwise if no particular pathway is specified during season k the k th term is given by the seasonal matrix a k consecutive seasons with specified pathways must be defined such that a ˆ k 1 e n m l j c a ˆ k e n j h j c j l here m l j h 1 n denote habitats and the pathway from habitat h to j is tracked during season k whilst the pathway from l to m is tracked during the following season k 1 to be a valid migratory route j and l must correspond to the same habitat that is j l otherwise the matrix product is zero as it contains an impossible migratory route furthermore if k φ but k 1 φ and k 1 φ then p k and p k 1 will be nonzero despite season k not being labelled as a season with a specified pathway in this situation where k is not a season with a specified pathway the p k 1 p k th block of a k is picked up in 2 10 alternatively if k is a season with a specified pathway then the p k 1 p k th block of a ˆ k is picked up in 2 10 later we provide an illustrative example to highlight this point see example 2 3 we are now in position to define two types of pathway contribution metric first for a given migratory route p we define c p by 2 11 c p 1 c n t k 1 s a k 1 c n t a s a 2 a 1 c 1 1 p c 1 c p c n 1 p c n c p here c j i p is the per capita contribution of an individual that starts the annual cycle in stage i and habitat j and migrates along p to the subpopulation that migrates along p we call c p the subpopulation pathway contribution metrics the second pathway contribution metric c p is defined by 2 12 c p 1 c n t k 1 s a k p k 1 c n t a s p s a 2 p 2 a 1 p 1 c 1 1 p c 1 c p c n 1 p c n c p here c j i p is the per capita contribution of an individual that starts the annual cycle in stage i and habitat j and travels along the migratory route p to the total population we call c p the metapopulation pathway contribution metrics also p k is given by p k i n p k p k 1 p k k φ i c n otherwise where i n p k p k 1 p k is a c n c n matrix with the p k 1 p k th block of p k along the diagonal therefore due to the construction of a k and p k and recalling the relationship 2 8 gives a k p k a k e n p k 1 p k j c k φ a k otherwise the key difference between the subpopulation pathway contribution metrics and metapopulation pathway contribution metrics is that c p does not account for the proportion of the population migrating along p whereas c p does account for the proportion of the population migrating along p consequently c p c p componentwise inequality due to the construction of c p as in each season where there is a choice of pathway the fraction of the total population that migrates along p in general becomes smaller we define a full migratory route to be a migratory route where every season in the annual cycle has a specified pathway that is a k a ˆ k e n p k 1 p k j c for all k conversely if no seasons have specified pathways that is p 0 0 0 0 0 then the resulting pathway contribution metric is 2 13 c p 0 1 t a s i c n a k i c n a 2 i c n a 1 i c n 1 t a s a k a 2 a 1 c p 0 1 t a so c p 0 contains the habitat contribution metrics defined in sample et al 2019 which in the present framework we recover as a special case of a pathway contribution metric we denote the habitat contribution metrics by c and denote each entry by c j i and name these the state contribution metrics the state contribution metric c j i can be thought of as the number of individuals across the total population that are generated over an annual cycle by an individual that is initially in stage i and habitat j a summary of the contribution metrics introduced is contained in table 2 4 2 4 illustrative examples our formulation of pathway contribution metrics in 2 9 2 12 is general and allows pathways to be specified in any season to draw out the key ideas from the mathematical notation in this section we present some illustrative numerical and general examples example 2 1 consider an annual cycle model with two seasons two habitats and two stages s 2 n 2 c 2 we use the hypothetical metapopulation in sample et al 2019 section 3 1 it represents partial migration between a higher quality habitat habitat 1 and a lower quality habitat habitat 2 there is a resident population in both habitats and migration can occur between habitats in both seasons the demographic rates used are the same as those from sample et al 2019 section 3 1 and we set the breeding season to be the anniversary season hence we obtain d 1 f b and d 2 f n where f b and f n are as they appear in sample et al 2019 p 5 migration matrices are defined for each stage in each season we have altered the migration matrices defined in sample et al 2019 such that now there is mortality associated with migration the migration matrices are the same for all stage and season combinations and are given by 2 14a p 1 1 p 1 2 p 2 1 p 2 2 0 6 0 4 0 4 0 6 s 1 1 s 1 2 s 2 1 s 2 2 1 0 8 0 8 1 and so m 1 1 m 1 2 m 2 1 m 2 2 0 6 0 32 0 32 0 6 recall that p k i r n n contains the proportion of stage i individuals that migrate in season k s k i r n n contains the survival probability of stage i individuals during migration in season k m k i r n n contains the probability that an individual in stage i migrates along a pathway in season k and survives see table 2 2 mortality associated with migration is captured via the column sums of the m k i all being less than one the seasonal matrices are constructed using 2 4 and are given by a 1 0 0 3999 0 0 2133 0 4800 0 5400 0 2560 0 2880 0 0 1860 0 0 3488 0 1920 0 2240 0 3600 0 4200 a 2 0 4800 0 0 2560 0 0 0 5400 0 0 2880 0 1920 0 0 3600 0 0 0 2240 0 0 4200 further the seasonal survival matrices are constructed using 2 7 and are given by a ˆ 1 0 0 6650 0 0 5332 0 8000 0 9000 0 6400 0 7200 0 0 4650 0 0 5813 0 4800 0 5600 0 6000 0 7000 a ˆ 2 0 8000 0 0 6400 0 0 0 9000 0 0 7200 0 4800 0 0 6000 0 0 0 5600 0 0 7000 and consequently by 2 2 the annual cycle matrix is a 0 0 2396 0 0 1917 0 3145 0 3561 0 2419 0 2765 0 0 1437 0 0 1665 0 1882 0 2150 0 2085 0 2409 thus summing the columns of a the habitat contribution metrics see 2 13 are equal to 2 14b c p 0 1 t a 0 5027 0 9545 0 4505 0 8756 by inspecting the above vector we see that individuals that start season 1 in habitat 1 contribute more to the total population than individuals that start in habitat 2 furthermore in both habitats individuals that are adults in season 1 contribute more to the total population than individuals that are juveniles in season 1 adults that start season 1 in habitat 1 are the population state that contribute the most to the total population moreover we see that over the course of a year none of the population states are replacing themselves as the habitat contribution metrics are all less than one and so this population is a sink and is decreasing in the short term the habitat contribution metrics are related to the asymptotic growth rate λ via 2 21 and from this equation it follows in this case that λ 1 thus the population is declining long term too as we would expect we now specify a pathway in both seasons ϕ 2 φ 1 2 hence all the distinct migratory routes are p 1 1 1 1 p 2 1 1 2 p 3 1 2 1 p 4 1 2 2 p 5 2 1 1 p 6 2 1 2 p 7 2 2 1 2 14c p 8 2 2 2 here p 1 and p 8 are the migratory routes of resident populations p 2 and p 7 are resident in season 1 and migrate in season 2 p 3 and p 6 migrate in both seasons p 4 and p 5 migrate in season 1 and are resident in season 2 for all distinct migratory routes we calculate subpopulation pathway contribution metrics using 2 11 2 14d c p 1 1 t a ˆ 2 e 2 11 j 2 a ˆ 1 e 2 11 j 2 0 7200 1 3432 0 0 c p 2 1 t a ˆ 2 e 2 21 j 2 a ˆ 1 e 2 11 j 2 0 4480 0 8239 0 0 c p 3 1 t a ˆ 2 e 2 12 j 2 a ˆ 1 e 2 21 j 2 0 3456 0 7008 0 0 c p 4 1 t a ˆ 2 e 2 22 j 2 a ˆ 1 e 2 21 j 2 0 3360 0 6710 0 0 c p 5 1 t a ˆ 2 e 2 11 j 2 a ˆ 1 e 2 12 j 2 0 0 0 5760 1 0746 c p 6 1 t a ˆ 2 e 2 21 j 2 a ˆ 1 e 2 12 j 2 0 0 0 3584 0 6591 c p 7 1 t a ˆ 2 e 2 12 j 2 a ˆ 1 e 2 22 j 2 0 0 0 4320 0 8760 c p 8 1 t a ˆ 2 e 2 22 j 2 a ˆ 1 e 2 22 j 2 0 0 0 4200 0 8388 all the distinct migratory routes in 2 14c have a pathway specified in season 1 resulting in the vectors c p i only being populated in the sub vector associated with the initial habitat the pathway contribution metrics indicate that p 1 and p 5 are the highest quality migratory routes in fact the adults in the subpopulations that use these routes are replacing themselves as the contribution metrics are greater than one despite all the habitat contribution metrics being less than one therefore managers could increase the total proportion of the population that takes these routes to increase the total population size example 2 2 here we provide a general example to consider an annual cycle model with four seasons and two habitats s 4 n 2 assume that only the second season has a specified pathway leading to ϕ 1 and φ 2 which tracks the subpopulation that travels from habitat 1 to 2 that is p 0 1 2 0 0 using 2 11 the per capita subpopulation pathway contribution metrics are given by c p 1 2 c t a 4 a 3 a ˆ 2 e 2 21 j c a 1 1 c n t a 4 a 3 0 0 a ˆ 2 21 0 a 1 routine blockwise matrix multiplication gives 2 15 c p row j 1 2 1 c t a 4 j 1 a 3 12 a 4 j 2 a 3 22 a ˆ 2 21 a 1 11 j 1 2 1 c t a 4 j 1 a 3 12 a 4 j 2 a 3 22 a ˆ 2 21 a 1 12 using 2 12 the per capita metapopulation pathway contribution metrics are given by c p 1 2 c t a 4 i 2 c a 3 i 2 c a ˆ 2 e 2 21 j c i 2 c p 2 21 a 1 i 2 c 1 2 c t a 4 a 3 0 0 a ˆ 2 21 0 p 2 21 0 0 p 2 21 a 1 similarly 2 16 c p row j 1 2 1 c t a 4 j 1 a 3 12 a 4 j 2 a 3 22 a 2 21 a 1 11 j 1 2 1 c t a 4 j 1 a 3 12 a 4 j 2 a 3 22 a 2 21 a 1 12 both 2 15 and 2 16 quantify how much an individual travelling from habitat 1 to habitat 2 in season 2 contributes to the overall population notice that the difference between 2 15 and 2 16 is that a ˆ 2 21 appears in the former whilst a 2 21 appears in the latter so in 2 15 only the demography and migratory survival of individuals travelling from habitat 1 to 2 is recorded during season 2 but in 2 16 the proportion of the population that travel from habitat 1 to habitat 2 during season 2 and survive is recorded example 2 3 here we provide an illustrative example to highlight the subtle distinction between models in which seasons k 1 and k 1 each have a specified pathway but season k does not and models in which seasons k 1 k and k 1 all have a specified pathway still considering a general annual cycle model with four seasons and two habitats s 4 n 2 we specify two migratory routes denoted by p 1 and p 2 the first migratory route p 1 specifies pathways in seasons 2 and 4 leading to ϕ 1 2 and φ 1 2 4 in particular during season 2 the pathway from habitat 1 to habitat 2 is specified and in season 4 the pathway from habitat 1 to itself is specified individuals remain resident in habitat 1 during season 4 so p 1 0 1 2 1 1 the second migratory route p 2 specifies pathways in seasons 2 3 and 4 leading to ϕ 2 3 and φ 2 2 3 4 in particular during seasons 2 and 4 the pathways that are specified in p 1 are specified again in season 3 the pathway from habitat 2 to habitat 1 is specified so p 2 0 1 2 1 1 hence for p 2 the proportion of individuals travelling from habitat 2 to habitat 1 during the third season is recorded in the calculation of the pathway contribution metrics but for p 1 the proportion of individuals travelling from habitat 2 to habitat 1 during the third season is not recorded the pathway contribution metrics are computed by standard blockwise matrix multiplication for p 1 2 17 c p 1 1 2 c t a ˆ 4 e 2 11 j c a 3 a ˆ 2 e 2 21 j c a 1 1 2 c t a ˆ 4 11 0 0 0 a 3 0 0 a ˆ 2 21 0 a 1 1 c t a ˆ 4 11 a 3 12 a ˆ 2 21 a 1 11 1 c t a ˆ 4 11 a 3 12 a ˆ 2 21 a 1 12 and c p 1 1 2 c t a ˆ 4 e 2 11 j c i 2 c p 4 11 a 3 i 2 c a ˆ 2 e 2 21 j c i 2 c p 2 21 a 1 i 2 c 1 2 c t a ˆ 4 11 0 0 0 p 4 11 0 0 p 4 11 a 3 0 0 a ˆ 2 21 0 p 2 21 0 0 p 2 21 a 1 1 2 c t a 4 11 a 3 12 a 2 21 a 1 11 a 4 11 a 3 12 a 2 21 a 1 12 0 0 1 c t a 4 11 a 3 12 a 2 21 a 1 11 1 c t a 4 11 a 3 12 a 2 21 a 1 12 for p 2 2 18 c p 2 1 2 c t a ˆ 4 e 2 11 j c a ˆ 3 e 2 12 j c a ˆ 2 e 2 21 j c a 1 1 2 c t a ˆ 4 11 0 0 0 0 a ˆ 3 12 0 0 0 0 a ˆ 2 21 0 a 1 1 2 c t a ˆ 4 11 a ˆ 3 12 a ˆ 2 21 a 1 11 a ˆ 4 11 a ˆ 3 12 a ˆ 2 21 a 1 12 0 0 1 c t a ˆ 4 11 a ˆ 3 12 a ˆ 2 21 a 1 11 1 c t a ˆ 4 11 a ˆ 3 12 a ˆ 2 21 a 1 12 notice that c p 1 c p 2 as in 2 18 we have a ˆ 3 12 rather than a 3 12 which appears in 2 17 however c p 1 c p 2 as the proportion of individuals migrating during season 3 is already included in the calculation of c p i in other words since c p already accounts for the size of the subpopulation travelling along pathways all elements in the products in 2 10 are blocks of the seasonal matrices a k regardless of whether or not the season has a specified pathway that is c p 2 c p 1 1 c t a 4 11 a 3 12 a 2 21 a 1 11 1 c t a 4 11 a 3 12 a 2 21 a 1 12 2 5 relating habitat and pathway contribution metrics here we take inspiration from wiederholt et al 2018 and demonstrate how the habitat contribution metrics c may be expressed in terms of a linear combination of pathway contribution metrics for each combination of seasons that have specified pathways φ a number of distinct migratory routes can be specified assuming that pathways between all habitats may be taken in every season the number of distinct migratory routes γ for a specified φ is given by γ n ϕ a where a is the number of entries in φ for which φ i 1 φ owing to the choice of pathway in consecutive seasons relying on each other recall that ϕ is the number of seasons for which a pathway is specified for example for a model with four seasons two habitats and φ 1 3 4 we see that ϕ 3 and a 2 as 2 and 5 are not in φ therefore there are γ 2 5 32 distinct migratory routes for i 1 γ let p i store the i th distinct migratory route then for each distinct migratory route c p i corresponds to a distinct subpopulation and the habitat contribution metrics c correspond to the total population therefore c is given by 2 19 c i 1 γ c p i that is summing the contributions of individuals from each distinct subpopulation gives the per capita contributions structured by the initial habitat for example the contribution of an individual that starts the annual cycle in stage 1 and habitat 1 c 1 1 can be obtained by summing the c 1 1 p i metrics across all possible migratory routes the habitat contribution metrics are equal to the sum of all possible metapopulation pathway contribution metrics consequently the metapopulation pathway contribution metrics provide another layer of granularity compared to habitat contribution metrics and can thus highlight the importance of a given migratory route we comment that in reality migrants may not use all pathways in every season hence not all distinct migratory routes p i are biologically valid however if p i is not a valid migratory route c p i will be zero thus 2 19 is still true for complex models using all distinct migratory routes including invalid migratory routes results in large γ in this situation only the contribution metrics corresponding to the distinct migratory routes that are biologically valid need to be calculated for use in 2 19 in special cases a linear combination of the c p i metrics can be used to derive c we define p ˆ i r c n c n by p ˆ i τ 1 ϕ i n p φ τ p i φ τ 1 p i φ τ that is along the diagonal p ˆ i stores the proportion of individuals that migrate along p i notice that p ˆ i τ 1 ϕ p φ τ k 1 s p k then when either only the first season has a specified pathway or when p k i is the same for all i 1 c we have that p i ˆ α i c n where α r in particular the habitat contribution metrics c are given by 2 20 c i 1 γ c p i p ˆ i where c p i is defined as in 2 11 hence 2 20 is a multi state version of wiederholt et al 2018 eq 5 we now provide an illustrative example where the pathway contribution metrics may be obtained from c p i example 2 4 here we use the same model as in example 2 1 and show that the habitat contribution metrics can be recovered from the pathway contribution metrics the migration matrices containing the migratory proportions are the same for all season and stage combinations see 2 14a therefore for every distinct migratory route p i we know that p ˆ i α i c n in particular for p 1 and p 8 p ˆ i 0 36 i 4 for p 2 p 4 p 5 and p 7 p ˆ i 0 24 i 4 for p 3 and p 6 p ˆ i 0 16 i 4 hence we input the subpopulation pathway metrics for all distinct migratory routes see 2 14d into 2 20 and obtain c 0 5027 0 9545 0 4505 0 8756 the above vector is equal to that in 2 14b thus the habitat contribution metrics have been recovered 2 6 relating contribution metrics to asymptotic growth the contribution metrics developed in runge et al 2006 and wiederholt et al 2018 and the habitat contribution metrics in sample et al 2019 can all be related to the asymptotic growth rate of the population here we show that summing over the metapopulation pathway contribution metrics weighted by the stable stage structure of the population gives the asymptotic growth rate of the population let λ be the dominant eigenvalue of a and w be the corresponding right eigenvector scaled such that the entries of w are nonnegative and sum to one in other words w is the standardised stable stage structure of the annual cycle population model in the case that a is irreducible the eigenvalue λ is a simple eigenvalue of a by the perron frobenius theorem and so the above conditions determine w uniquely hence a w λ w and so 2 21 c w 1 c n t a w 1 c n t λ w λ w 1 λ substituting 2 19 for c gives 2 22 i 1 γ c p i w j i 1 γ c p i j w j λ thus the sum of the metapopulation pathway contribution metrics c p weighted by the stable stage structure equals the overall asymptotic growth rate of the total population recall that c p i contains the per capita contribution for each initial population state of the distinct subpopulation that travels along the distinct migratory route p i during the annual cycle furthermore the summation of the metapopulation pathway contribution metrics for all distinct subpopulations gives the per capita contribution of each initial state of the total population recall that the state contribution metrics c j i the entries in c can be thought of as the number of individuals across the total population that are generated over an annual cycle by an individual that is initially in stage i and habitat j hence it is intuitive that the average of the state contribution metrics weighted by the stable stage distribution is the total population generated in the next annual time step and in this particular case equals the asymptotic growth rate of the population furthermore in the special cases where 2 20 holds we have 2 23 i 1 γ c p i p ˆ i w j i 1 γ c p i p ˆ i j w j λ again the above equality is intuitive once we know that the c p i metrics can be used to calculate c eq 2 22 or 2 23 can be used to provide insight into the trade offs between asymptotic and transient dynamics captured presently by c p i or c p i and λ respectively for example if a particular contribution metric increases by some change or perturbation to a then for a fixed λ the corresponding component of w must decrease all else remaining the same in order to maintain equality in 2 22 or 2 23 2 7 averaging contribution metrics here we provide easy to compute matrix formulae to calculate the average contribution to the total population of an initial habitat or stage for a subpopulation that follows a particular migratory route the first metric we define averages the metapopulation pathway contribution metrics c p over stage to assess the quality of a habitat regardless of stage the second metric we define averages c p over habitat to assess the contribution of an initial stage 2 7 1 averaging over stage the contribution metrics stored in c p can be averaged over stage to assess the quality of habitats there is an averaged contribution metric associated with each habitat j 1 n denoted by c j p each c j p is the average contribution of an individual that starts the annual cycle in habitat j and migrates along p the calculation of c j p requires knowledge of the population structure at the start of the annual cycle x we provide a matrix formulation that simultaneously calculates all c j p metrics given by 2 24 h p j 1 n e n j j 1 c t x c p t j 1 n e n j j j c x 1 c t 1 c t x c p t j c j c x c 1 p c n p r n the mathematical notation is detailed in section 2 1 and recall that denotes hadamard division the definition of means that the averaged contribution of an empty habitat is zero the vector h p is structured by the habitat in which a subpopulation starts the annual cycle for clarity note that h p is a column vector whilst the pathway contribution metrics presented so far are row vectors we have chosen to present our formula using vectors and matrices to encode more information in one calculation that is easy to implement numerically however setting x j 1 c t x j which is the number of individuals in habitat j at the start of the annual cycle routine calculations starting from 2 24 show that 2 25 c j p i 1 c x j i c j i p x j whenever x j is nonzero hence each block of our formula computes sample et al 2019 eq 9 for a different initial habitat we provide a derivation of the above calculation in appendix c 1 the size of c j indicates whether habitat j is a source or a sink for the focal subpopulation if c j p 1 then habitat j is said to be a source for the subpopulation that follows the migratory route defined by p alternatively if c j p 1 then habitat j is said to be a sink for the subpopulation that follows the migratory route defined by p we note that the averaged contribution metrics depend on the initial population structure here denoted x and not just the annual cycle matrix thus the year that the population is measured will influence the value of the averaged contribution metrics 2 7 2 averaging over habitat similarly the contribution metrics stored in c p can be averaged over habitat to assess the contribution of stages there is an averaged contribution metric associated with each stage i 1 c denoted by c i p each c i p is the average contribution of an individual that starts the annual cycle in stage i and migrates along p the calculation of c i p requires knowledge of the population structure at the start of the annual cycle x we provide a matrix formulation that simultaneously calculates all c i p metrics given by 2 26 s p i 1 c 1 n t e c i i x c p t i 1 c j n e c i i x i c i c x c p t i c i c i c i c x c 1 p c c p recall from section 2 1 that i c denotes the c c identity matrix it can be shown by a simplification of 2 26 see appendix c 2 that 2 27 c i p j 1 n x j i c j i x i whenever x i is nonzero here x i j 1 n x j i is the total number of individuals in stage i at the start of the annual cycle since c j i contains information about the proportion of individuals migrating each block of our formula computes sample et al 2019 eq 12 for a different starting stage thus each c i p is the per capita contribution of the subpopulation that travels the migratory route defined by p and starts the annual cycle in stage i again we note that these averaged contribution metrics depend on the initial population structure not just the annual cycle matrix the effect of the population structure x on h p and s p will be explored further in smith 2023 3 case studies here we calculate our contribution metrics for a range of annual cycle models first we demonstrate how our framework generalises that in wiederholt et al 2018 by extending their scalar population model into a matrix population model next we use an annual cycle model for a north american migratory monarch butterfly population with multiple stages habitats and seasons to explore the range of contribution metrics that can be calculated using our framework these metrics include full migratory routes which previous frameworks could not capture finally we provide an example that details how contribution metrics can be used to design a simple optimal single time step control solution for the conservation of a population example 3 1 we illustrate the connection between our subpopulation pathway contribution metric and the one defined in wiederholt et al 2018 which considers annual cycle models with two seasons and two stages representing juvenile and adult individuals borrowing the notation of wiederholt et al 2018 habitats are defined to be either the origin o intermediate i or destination d the population travels from o to i during season 1 and from i to d during season 2 the adult survival probability a o i d and per capita juvenile recruitment j o i d for a focal migratory route during the annual cycle where the breeding season is the anniversary season are given by 3 1 a o i d s o i b a s i b a s i d n a s d n a and j o i d s o i b a s i b a r i b s i d n j s d n j where superscripts a and j refer to the adult and juvenile stages respectively subscripts b and n refer to the breeding and non breeding seasons respectively brackets indicate the split of seasons note that wiederholt et al use s j l k i to represent an individual in stage i migrating from habitat j to habitat l in season k we have adjusted equations 1 and 2 in wiederholt et al 2018 so that in 3 1 migration happens first for further information see appendix d then the per capita contribution of a pathway c o i d is defined to be 3 2 c o i d a o i d j o i d s o i b a s i b a s i d n a s d n a s o i b a s i b a r i b s i d n j s d n j now we translate the notation of wiederholt et al 2018 into our notation hence we consider a model with two seasons two stages and three habitats s 2 c 2 n 3 we set the breeding and non breeding seasons to be season 1 and season 2 respectively juveniles and adults are set to be stage 1 and stage 2 respectively for the ease of comparison we keep the habitat labels o i and d both seasons have a specified pathway hence ϕ 2 and φ 1 2 we specify the migratory route to be p o i d the demographic matrices associated with habitats o i and d in season 1 breeding and season 2 non breeding are d o 1 0 s o 1 2 r o 1 s o 1 1 s o 1 2 d o 2 s o 2 1 0 0 s o 2 2 d i 1 0 s i 1 2 r i 1 s i 1 1 s i 1 2 d i 2 s i 2 1 0 0 s i 2 2 d d 1 0 s d 1 2 r d 1 s d 1 1 s d 1 2 d d 2 s d 2 1 0 0 s d 2 2 therefore from 2 3 we obtain d 1 0 s o 1 2 r o 1 0 0 0 0 s o 1 1 s o 1 2 0 0 0 0 0 0 0 s i 1 2 r i 1 0 0 0 0 s i 1 1 s i 1 2 0 0 0 0 0 0 0 s d 1 2 r d 1 0 0 0 0 s d 1 1 s d 1 2 and d 2 s o 2 1 0 0 0 0 0 0 s o 2 2 0 0 0 0 0 0 s i 2 1 0 0 0 0 0 0 s i 2 2 0 0 0 0 0 0 s d 2 1 0 0 0 0 0 0 s d 2 2 furthermore the matrices storing the probability of surviving migration s k i for stage 1 juveniles and stage 2 adults are s 1 1 s o o 1 1 s o i 1 1 s o d 1 1 s i o 1 1 s i i 1 1 s i d 1 1 s d o 1 1 s d i 1 1 s d d 1 1 s 2 1 s o o 2 1 s o i 2 1 s o d 2 1 s i o 2 1 s i i 2 1 s i d 2 1 s d o 2 1 s d i 2 1 s d d 2 1 s 1 2 s o o 1 2 s o i 1 2 s o d 1 2 s i o 1 2 s i i 1 2 s i d 1 2 s d o 1 2 s d i 1 2 s d d 1 2 s 2 2 s o o 2 2 s o i 2 2 s o d 2 2 s i o 2 2 s i i 2 2 s i d 2 2 s d o 2 2 s d i 2 2 s d d 2 2 substituting into eq 2 5 gives s 1 s o o 1 1 0 s o i 1 1 0 s o d 1 1 0 0 s o o 1 2 0 s o i 1 2 0 s o d 1 2 s i o 1 1 0 s i i 1 1 0 s i d 1 1 0 0 s i o 1 2 0 s i i 1 2 0 s i d 1 2 s d o 1 1 0 s d i 1 1 0 s d d 1 1 0 0 s d o 1 2 0 s d i 1 2 0 s d d 1 2 and s 2 s o o 2 1 0 s o i 2 1 0 s o d 2 1 0 0 s o o 2 2 0 s o i 2 2 0 s o d 2 2 s i o 2 1 0 s i i 2 1 0 s i d 2 1 0 0 s i o 2 2 0 s i i 2 2 0 s i d 2 2 s d o 2 1 0 s d i 2 1 0 s d d 2 1 0 0 s d o 2 2 0 s d i 2 2 0 s d d 2 2 recall that in our notation s j l k i is the probability that an individual in stage i survives travelling from habitat l to habitat j during season k the seasonal survival matrices where migration happens first a ˆ k d k s k see 2 7 are a ˆ 1 0 s o 1 2 r o 1 s o o 1 2 0 s o 1 2 r o 1 s o i 1 2 0 s o 1 2 r o 1 s o d 1 2 s o 1 1 s o o 1 1 s o 1 2 s o o 1 2 s o 1 1 s o i 1 1 s o 1 2 s o i 1 2 s o 1 1 s o d 1 1 s o 1 2 s o d 1 2 0 s i 1 2 r i 1 s i o 1 2 0 s i 1 2 r i 1 s i i 1 2 0 s i 1 2 r i 1 s i d 1 2 s i 1 1 s i o 1 1 s i 1 2 s i o 1 2 s i 1 1 s i i 1 1 s i 1 2 s i i 1 2 s i 1 1 s i d 1 1 s i 1 2 s i d 1 2 0 s d 1 2 r d 1 s d o 1 2 0 s d 1 2 r d 1 s d i 1 2 0 s d 1 2 r d 1 s d d 1 2 s d 1 1 s d o 1 1 s d 1 2 s d o 1 2 s d 1 1 s d i 1 1 s d 1 2 s d i 1 2 s d 1 1 s d d 1 1 s d 1 2 s d d 1 2 a ˆ 2 s o 2 1 s o o 2 1 0 s o 2 1 s o i 2 1 0 s o 2 1 s o d 2 1 0 0 s o 2 2 s o o 2 2 0 s o 2 2 s o i 2 2 0 s o 2 2 s o d 2 2 s i 2 1 s i o 2 1 0 s i 2 1 s i i 2 1 0 s i 2 1 s i d 2 1 0 0 s i 2 2 s i o 2 2 0 s i 2 2 s i i 2 2 0 s i 2 2 s i d 2 2 s d 2 1 s d o 2 1 0 s d 2 1 s d i 2 1 0 s d 2 1 s d d 2 1 0 0 s d 2 2 s d o 2 2 0 s d 2 2 s d i 2 2 0 s d 2 2 s d d 2 2 then by 2 11 the subpopulation pathway contribution metric c p where the breeding season is the anniversary season is given by c p 1 t a ˆ 2 e 3 d i j 2 a ˆ 1 e 3 i o j 2 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 s d 2 1 s d i 2 1 0 0 0 0 0 0 s d 2 2 s d i 2 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 s i 1 2 r i 1 s i o 1 2 0 0 0 0 s i 1 1 s i o 1 1 s i 1 2 s i o 1 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 s d 2 1 s d i 2 1 s d 2 2 s d i 2 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 s i 1 2 r i 1 s i o 1 2 0 0 0 0 s i 1 1 s i o 1 1 s i 1 2 s i o 1 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 s d 2 2 s d i 2 2 s i 1 1 s i o 1 1 s d 2 1 s d i 2 1 s i 1 2 r i 1 s i o 1 2 s d 2 2 s d i 2 2 s i 1 2 s i o 1 2 0 0 0 0 to more readily compare the above equation to 3 2 we reset the labels above for season 1 and season 2 to b and n respectively we also reset the labels for stage 1 and stage 2 to j and a respectively hence c p s d n a s d i n a s i b j s i o b j s d n j s d i n j s i b a r i b s i o b a s d n a s d i n a s i b a s i o b a 0 0 0 0 accounting for the difference between s j l k i in our notation and that in wiederholt et al 2018 we see that the second entry equals c o i d the first entry calculates the contribution of juveniles that transition into adults over the annual cycle the final four entries are zero as the migratory route p has a specified pathway during the first season all individuals in the focal subpopulation start the annual cycle in habitat o and so the contribution of habitats i and d is zero thus our subpopulation pathway contribution metric generalises that developed in wiederholt et al 2018 example 3 2 we consider a population model for the monarch butterfly danaus plexippus in eastern north america the population size of migratory monarch butterflies in eastern north america is estimated to have declined from 300 900 million in the 1990s to 33 200 million in recent years vidal and rendón salinas 2014 leading to the eastern monarch migration being classified as an endangered phenomenon advani 2015 brower et al 2012 a number of studies have assessed the population viability of the monarch butterfly including advani 2015 flockhart et al 2015 calculation of the contribution metrics associated with the monarch butterfly population in eastern north america can provide further insight into how best to conserve this iconic species we use a model inspired by those in flockhart et al 2015 and sample et al 2018 our model is for the female population and contains five stages c 5 four habitats n 4 and twelve seasons s 12 the life stages are immature individuals including eggs larval and pupal development until eclosion 1 eclosed butterflies in their first month of life and in reproductive diapause 2 eclosed butterflies in their second month of life or older and in reproductive diapause 3 eclosed butterflies in their first month of life and in breeding condition 4 and eclosed butterflies in their second month of life or older and in breeding condition 5 monarch butterflies complete a long distance migration over one year between mexico m southern us s central us c and northern us n fig 3 1 depicts the life cycle of female monarch butterflies in region j m s c n where nodes represent stages and edges represent transitions between stages the data used to calculate the demographic rates we use are recorded in the tables in appendix e 1 mexico is a wintering region whilst the other three regions are breeding regions the survival rates of migration are given in fig 3 2 for each season fig 3 3 depicts the proportion of the population travelling along each pathway the corresponding matrices s k i and p k i are recorded in appendix e 2 recall that these matrices are used to construct s and p which are used to calculate the m matrices via 2 6 we take ϕ 1 and set φ to be each season in turn since all the population starts the annual cycle in mexico only the first block of c p i and c p i are populated hence we only record these values in table 3 1 when the c p i metrics are averaged over stage only c m p i is nonzero and is equal to the nonzero values in the corresponding c p i similarly when averaging over stage only c 2 p i and c 3 p i are nonzero and are both equal to the nonzero values in the corresponding c p i based on the contribution metrics the pathway between the south s and central c regions in june season 6 contributes the most the pathway between central c and north n in june contributes the least therefore to increase the total population size the quality of the route between c and n could be improved alternatively managers could increase the proportion of monarch butterflies that travel between s and c in june migratory insect pests have been subject to this type of management pedgley 1993 however this type of management may not be possible as many migratory insects have weak control over their flightpaths partly due to their migrations being multi generational gao et al 2020 management actions that change the migratory route of individuals have been observed in birds hartup et al 2004 ungulates jones et al 2014 and marine migrants perry et al 2013 example 3 3 we continue our study of the annual cycle model for the monarch butterfly considered in example 3 2 namely we assess the contribution of various full migratory routes we set ϕ 12 and φ 1 2 12 in other words all seasons of the annual cycle have a specified pathway we calculate the pathway contribution metrics for the following full migratory routes 3 3 p 1 m m m m s c n c n c m m m p 2 m m m m s s c c c c s m m p 3 m m m m s s c c c s s m m p 4 m m m m s c n n n c c m m p 5 m m m m s s n n n s s m m here p 1 is the full migratory route where for all seasons k 1 2 12 the specified pathway is the pathway with the lowest contribution in season k see table 3 1 on the other hand p 2 is the full migratory route where the pathway specified in season k is the pathway with the highest contribution metric as in example 3 2 all the population starts the annual cycle in mexico m so only the first block of c p i and c p i are populated hence we only record these values in table 3 2 furthermore when averaging over stage and habitat only c m p i c 2 p i and c 3 p i are nonzero and are equal to the nonzero values in the corresponding c p i table 3 2 shows that the subpopulation travelling along p 1 does not contribute to the total population further investigation shows that during october season 10 the subpopulation does not contain any individuals in habitat c that are in stage 2 or stage 3 hence no individuals use the pathway from c m during october as only individuals in stage 2 and 3 use this pathway see fig 3 3 therefore p 1 is not a viable migratory route over all the migratory routes considered presently we see that individuals travelling along p 2 contribute the most to the total population as expected to increase the total population managers can increase the proportion of monarch butterflies that use p 2 example 3 4 here we demonstrate how the habitat contribution metrics and their maximum values can play a role in predicting the effect of management actions for populations modelled by 2 1 specifically suppose that at the start of year t members of the population are added via some reintroduction scheme structured over stage and habitat according to the vector u r c n updating the annual cycle model 2 1 appropriately the population after one year is then given by x t 1 a x t u in particular invoking 2 13 we compute that 3 4 x t 1 1 1 c n t x t 1 1 c n t a x t u c x t c u where recall c c p 0 denotes the row vector of habitat contribution metrics consequently it follows from 3 4 that the increase in the size of the population over one year caused by u is given by c u therefore for fixed x t the size of the population after one year x t 1 1 is maximised by maximising c u evidently c u increases as u 1 increases but for fixed u u 1 we see that the maximum of c u is equal to h u where h is the largest component of c and the corresponding u is equal to u e n j in words the maximum increase in population is achieved by adding all individuals to the stage and habitat which contributes the most this choice of management action may not be ecologically practicable but the above analysis indicates both the theoretical maximum obtainable and the effect on x t 1 1 of other reintroduction schemes we comment that adding individuals during a year say in some other season p can be accommodated by rewriting the annual cycle model 2 1 and 2 2 so that the anniversary season is p 4 discussion we have provided vectorised formulae for two novel pathway contribution metrics to calculate the importance of an individual that travels along specific pathways over any number of prescribed seasons in an annual cycle recall the working context that a migratory population is represented by a general so called annual cycle model a matrix structured population model with discrete temporal and spatial structure the underlying model and subsequent metrics are presented in sections 2 2 and 2 3 respectively and can be applied widely our formulae generalise previous frameworks for calculating contribution metrics sample et al 2019 wiederholt et al 2018 and familiar habitat contribution metrics are recovered as a special case our approach allows the contribution of any particular part s of the migratory network to be calculated including from individuals undertaking a full annual migratory route as well as for models which capture multiple life stages that is stage structured population models the conjunction of these features is a novel aspect of our work using linear algebra methods we have constructed the contribution metrics such that a pathway of interest can be specified in any season this allows population managers to focus on particular parts of the migratory network and assess their contributions to the total population hence it is possible to make a detailed analysis of populations with numerous distinct life histories this provides managers with insights into the role differential migration plays in migratory connectivity and helps to inform conservation actions briedis and bauer 2018 furthermore our approach can be used to compare within the same annual cycle the contributions of the same pathway taken in different seasons i e breeding or non breeding previously this calculation would require a permutation of the annual cycle model pathway contributions could only be calculated for the anniversary season since contribution metrics are transient indices they are altered by permutations of the annual cycle model hence previous pathway contribution metrics are highly dependent on the anniversary season it was complicated to compare the contribution of the same pathway used in different seasons with our metrics the contribution of a pathway can be calculated for all seasons of the annual cycle without permuting the annual cycle model additionally our metrics allow managers to see which subpopulations contribute the most to the overall population and distinguish the different contribution rates between life stages in these subpopulations we have also provided easy to use vectorised formulae to average the pathway contribution metrics over habitats and over stages so that the contribution of all individuals starting in the same stage or habitat can be quantified these averaged contribution metrics appear in section 2 7 and are studied in more depth in smith 2023 with reference to our case studies from section 3 for example in the monarch butterfly study see example 3 2 we see that the contribution of an individual that starts the annual cycle in mexico m and stage 2 and migrates from southern us s to central us c in may season 5 is 1 01 essentially every individual only replaces itself whereas an individual that starts the annual cycle in mexico and stage 2 and migrates from the southern us to central us in june season 6 has a contribution of 13 07 evidently the pathway from southern us to central us has a much higher contribution in june than it does in may then considering full migratory routes in example 3 3 the contribution metrics for five distinct migratory routes are calculated for the monarch butterfly model from example 3 2 we see that the contribution of an individual in a subpopulation to the total population c p i can range from 0 to 3 43 table 3 2 furthermore changing the pathway taken in just one season can significantly alter the contribution of an individual p 2 and p 3 only differ by the pathway taken during season 10 see 3 3 however c p 2 3 43 and c p 3 1 67 table 3 2 in other words an individual following p 2 is expected to contribute approximately twice as much to the total population as an individual that follows p 3 despite using the same pathways for eleven out of twelve seasons of the annual cycle arguably obtaining these insights would not have been possible with previous metrics we comment that all the contribution metrics considered are quantities which capture transient behaviour of a population there has now for some time been a recognition in the academic literature of the importance of transient dynamics in ecological modelling see for instance hastings 2004 hastings et al 2018 and stott et al 2011 the pathway contribution metrics we have constructed can be considered simultaneously with the habitat contribution metrics and the asymptotic growth rate as is done in section 2 6 in particular there is a connection between transient and asymptotic growth or decline this connection provides insight into the trade offs between asymptotic and transient dynamics increasing the asymptotic growth of the population may not result in short term growth and vice versa insight of these trade offs allows managers to choose conservation strategies that benefit the population in both the short and long term by way of limitations one drawback of our pathway contribution metrics is that by construction they keep track of where individuals are in space but not their stage as a result the stage that an individual is in whilst using a migratory pathway is only recorded for the first season of the annual cycle therefore the pathway contribution metrics do not quantify the importance of the stage in which an individual uses a migratory pathway instead the importance of the initial stage of an individual and the pathways it then uses is quantified hence our metrics do not tell managers which stage of the population to focus conservation actions on for specific pathways of the migratory route additionally our framework is very much geared towards the density independent linear models considered indeed establishing a comparable notion of pathway contribution metrics for full migratory routes for general density dependent nonlinear models seems challenging furthermore the annual cycle model is discrete in nature and so managers are required to make a number of choices when defining the model including how many stage classes to divide the population into matrix models have been criticised for dividing populations into discrete stages despite being classified by continuous traits ellner and rees 2006 these discretization choices determine the dimension of the matrix which then impacts the outputs of the model and introduces discretization errors much research has been devoted to understanding the effect of these choices on matrix models including for example picard and liang 2014 salguero gomez and plotkin 2010 and numerous algorithms that collapse population matrix dimensions whilst maintaining the intrinsic characteristics of the population have been proposed for non spatial population matrices bienvenu et al 2017 hooley 2000 picard et al 2010 however to the best of our knowledge we are unaware of similar algorithms for use on the spatial models considered here consequently at this time we are not able to systematically study the effects of the choice of number of model stages on pathway contribution metrics we suggest that the development of such algorithms is a fruitful future line of enquiry to evaluate and quantify discretization errors looking ahead recent work has considered how existing contribution metrics are affected by perturbations see sample et al 2020 an upcoming work is to provide a modelling framework for perturbations of the contribution metrics considered here smith et al 2022 this could be used to assess the robustness of the population to changes in demographic and migration rates which can further inform how to apply conservation measures another area for future research is to examine how migratory strategies influence the value of contribution metrics we envisage that this could be studied by specifying a number of annual cycle models with structure corresponding to different migratory strategies i e full migrants or partial migrants and carrying out a meta analysis to see if there are significant relationships between the migratory strategy and the corresponding contribution metrics in closing we have provided easy to use formulae for constructing and averaging contribution metrics across stages and across habitats in seasonal systems with complex migratory patterns our formula are all vectorised which allows the metrics to be easily calculated from the population projection matrices these matrices are constructed similarly to standard matrix population models and are based on demographic rates migratory proportions and migratory survival rates these results provide another and novel tool for developing improved ecological management strategies credit authorship contribution statement phoebe smith conceptualization methodology software writing original draft writing review editing visualization chris guiver conceptualization methodology writing original draft writing review editing ben adams conceptualization writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix the appendix is divided into five sections the first contains a mathematical derivation of the equality 2 8 the second compares our per capita subpopulation pathway contribution metrics with the pathway contribution metrics in sample et al 2019 the third contains mathematical derivations of the averaged contribution metrics the fourth and fifth contain further material for examples 3 1 and 3 2 respectively not given in the main text appendix a further material for section 2 2 we provide a derivation of the equality 2 8 recorded as the following result lemma a 1 for every k 1 2 s the matrices a k and a ˆ k given by 2 4 and 2 7 respectively satisfy a k x y a ˆ k x y p k x y where p k is as in 2 5 and a x y represents the x y th block of a in words the above lemma states that the x y th block of the seasonal matrix a k is equal to the matrix product of the x y th block of the seasonal survival matrix a ˆ k and the x y th block of the block matrix p k which contains the habitat movement probabilities p k i proof of lemma a 1 fix k 1 s recall the definitions of a k and a ˆ k in eqs 2 4 and 2 7 respectively namely a k d k m k and a ˆ k d k s k furthermore recall that the block matrices p k s k and m k are constructed via p k i 1 c p k i e c i i s k i 1 c s k i e c i i m k i 1 c m k i e c i i we note that the construction of these block matrices results in each c c block being a diagonal matrix in particular the i i th entry of the x y th block of p k s k and m k is given by the x y th entry of p k i s k i and m k i respectively in other words the x y th block of p k s k and m k are given by p k x y diag i p k i x y s k x y diag i s k i x y m k x y diag i m k i x y respectively we also recall from 2 6 that m k p k s k where is the hadamard product collectively the above gives diag i m k i x y p k x y diag i p k i s k i x y diag i p x y i s x y i and so m k x y s k x y p k x y we recall that the block matrix d k is constructed via d k j 1 n e n j d j k d 1 k 0 0 0 d 2 k 0 0 0 d n k hence d k is a block diagonal matrix owing to this special structure of d k we observe that a k x y d k m k x y i d k x i m k i y d k x x m k x y therefore a k x y d x k m k x y d x k s k x y p k x y i d k x i s k i y p k x y a ˆ k x y p k x y as required appendix b a comparison with the pathway contribution metrics of sample et al 2019 here we present a hypothetical annual cycle model to illustrate the connection between our subpopulation pathway metric c p and the contribution metrics defined in sample et al 2019 there the authors define a pathway contribution metric as the annual per capita contribution of an individual of class x starting at node r and travelling to node d at time t is b 1 c r d t x 1 n c t p r d t x a t t e n r d h c x τ t 1 t s 1 a τ t 1 n c where is the hadamard entrywise product p r d t x is the proportion of individuals of class x at node r that will travel to node d at time t contained in movement matrix q t x of eq 5 and h c x is a c c zero matrix with ones in column x recall that e n r d is an n n zero matrix with a 1 at position r d sample et al 2019 page 4 we aim to translate b 1 into our notation first we note that for simplicity we assume that seasons are indexed such that the anniversary season is always season 1 hence t 1 furthermore we note that the demographic d j k and migration m k i matrices we define are the transpose of those defined in sample et al 2019 eq 3 and eq 5 however our construction of d k and m k results in these matrices being equal to the equivalent matrices in sample et al 2019 eq 2 and eq 4 as a result when the seasonal matrices a k are given by the same product of d k and m k the annual cycle matrices a ˆ 1 in sample et al 2019 eq 6 and a in our notation are consistent with each other we believe that there is a typo in the order of the subscripts r and d in our notation we would use the subscript d r to denote the pathway from habitat r to habitat d that is we would denote this pathway contribution as c d r t x owing to the columns of the matrices denoting where the individual started whilst the rows indicate where the individual ended up for the same reasons we change the order of the subscripts on p and e furthermore we believe that h c x in b 1 should be replaced with r c x a c c zero matrix with ones in row x making the discussed changes to notation gives c d r 1 x 1 n c t p d r 1 x a 1 t e n d r r c x τ 2 s a τ t 1 n c and taking transposes gives b 2 c d r 1 x 1 n c t p d r 1 x τ 2 s a τ a 1 e n r d h c x 1 n c here a 1 e n r d h c x is a c n c n matrix where the x th column of the r d th block is equal to the x th column of the r d th block of a 1 and all other entries are zero in other words a 1 e n r d h c x is the projection matrix for the first season that projects individuals that start in stage class x and habitat r and travel to habitat d hence c d r 1 x is the contribution of individuals that start the annual cycle in stage x and habitat r and travel from habitat r to habitat d during season 1 if the total population were to travel from r to d during the first season adjusting b 2 to our usual notation we obtain c r i p 1 c n t p d r 1 i τ 2 s a τ a 1 e n r d h c x 1 c n where p r d 0 0 note that this is still only tracking the x th stage that travel along p 1 we use 2 11 to calculate the contribution of all stages along p 1 and obtain b 3 where only the r th 1 c vector of c p is non zero as we are only tracking individuals that start the annual cycle in habitat r furthermore a ˆ 1 is a 1 where each element a i j x has been divided by p i j x see appendix a for proof we provide an example to help visualise the difference between b 1 and b 3 and that to the best of our knowledge the formula b 1 as presented above does not quite compute what the authors of sample et al 2019 claim for which purpose consider an annual cycle model with c 2 n 2 and s 1 let the demographic matrices associated with habitat 1 and 2 be given by d 1 0 0 1 0 and d 2 0 1 0 0 respectively furthermore stages 1 and 2 migrate in the same way such that m 1 m 2 p 1 p 2 s 1 s 2 0 0 1 0 that is all individuals migrate from habitat 1 to habitat 2 and all survive then the seasonal survival matrix a ˆ and the seasonal matrix a are given by a a ˆ a 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 thus over the course of the year which equals a single season the population projection is b 4 x t 1 a x t 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 x 1 1 t x 1 2 t x 2 1 t x 2 2 t 0 0 x 1 2 t 0 where x j i denotes the population size in stage i and habitat j hence the only state that contributes during time t is x 2 t individuals starting season t in stage 2 and habitat 1 we calculate the contribution of individuals starting the season in stage 2 and habitat 1 that migrate to habitat 2 therefore we set r 1 d 2 and i 2 using a t t e n r d h c x from b 1 the formula in sample et al 2019 we obtain a t e n r d h c i 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 t 0 1 0 0 0 1 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 hence we will obtain c 12 2 0 and so this formula calculates that individuals starting the season in stage 2 and habitat 1 that migrate to habitat 2 do not contribute to the next cycle or season which we can see is false by b 4 now using our method we obtain a ˆ e n d r j c 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 1 1 1 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 1 1 0 0 e 4 32 0 hence c 1 2 p 1 thus individuals that start the season in stage 2 and habitat 1 and migrate to habitat 2 replace themselves over the annual cycle as expected from b 4 appendix c averaged contribution metrics we provide further details not given in section 2 7 namely we derive the scalar averaged contribution metrics from the vectorised formulations we do this for the two forms of averaged contribution metrics separately c 1 contribution metrics averaged over stage here we give the derivation of 2 25 from 2 24 writing out the various matrices and vectors in 2 24 we see that which setting x j i 1 c x j i is the desired expression 2 25 c 2 contribution metrics averaged over habitat here we give the derivation of 2 27 from 2 26 writing out the various matrices and vectors in 2 26 we see that which setting x i j n c x j i is the desired expression 2 27 appendix d further material for example 3 1 we provide additional details for example 3 1 not given in the main text namely we convert the annual cycle model of wiederholt et al in wiederholt et al 2018 so that migration takes place before demography for which purpose the authors of wiederholt et al 2018 split the annual cycle into four seasons breeding breeding to non breeding transition non breeding and non breeding to breeding transition habitats are referred to as seasonally occupied during the origin o intermediate i or destination d time periods equations are provided for the adult survival probability a o i d and per capita juvenile recruitment j o i d for a focal migratory route o i d during their annual cycle d 1 a o i d s o a s o i a s i a s i d a where s o a is the adult survival probability of an individual using habitat o and s o i a is the survival probability of adults transitioning between habitats o and i in d 1 demography is happening before migration throughout the paper we have assumed that migration happens first although we note that the model can be structured such that demography happens first hence here we provide an equation for the adult survival probability a o i d when migration happens before demography that is a o i d s o i a s i a s i d a s d a here we have used brackets to indicate the split of seasons noting that in our framework this model would be defined as a two season model in other words the breeding season and the breeding to non breeding transition are combined to be one season similarly the non breeding season and the non breeding to breeding transition are combined to be one season we do similar rearrangements for the per capita juvenile recruitment j o i d equations we note that the calculation of juvenile survival depends on which season is considered for the anniversary date in the annual cycle wiederholt et al 2018 and consider when anniversary season is the breeding season first in this case wiederholt et al define j o i d s o a r o s o i j s i j s i d j where r o is the number of juveniles produced per adult that survives in habitat o and s o i j is the juvenile survival probability between habitat o and i defining the model such that migration happens first gives j o i d s o i a s i a r i s i d j s d j secondly when the non breeding season is the anniversary season wiederholt et al define the per capita recruitment of juveniles by j o i d s o a s o i a s i a r i s i d j defining the model such that migration happens first gives j o i d s o i a s i a s i d a s d a r d finally the pathway contribution is given by c o i d a o i d j o i d where the order in which migration and demography are defined must be consistent for a o i d and j o i d appendix e further material for examples 3 2 and 3 3 we provide further details not given in the main text e 1 demographic rates see tables e 1 e 3 e 2 migration rates see tables e 4 and e 5 
24402,long term and wide ranging citizen science programs provide a unique opportunity to monitor wildlife populations and trends through time while encouraging stakeholder participation engagement and trust hunter observations is such a program that in sweden is used on a regular basis to monitor population trends of moose however hunter observations are not reliable to determine the actual population size we developed a mechanistic moose population model that integrated citizen science data and used it at various geographical scales to estimate moose population size between 2012 and 2020 a sensitivity analysis specifically performed for recruitment adult sex ratio and calf sex ratio showed that the simulated population size was most sensitive for variation in recruitment according to the results sweden had a total moose population of 311 000 4 individuals pre hunt and 228 000 4 post hunt in 2020 the post hunt moose abundance has decreased nationwide with 15 from 0 72 to 0 61 moose per km2 during the 2012 2020 period the present post hunt moose density was estimated at 0 39 0 78 0 84 and 0 54 per km2 for the regions northernmost northern central and southern sweden respectively the simulation model can be used for strategic and operative management at various geographical scales and is publicly available by integrating citizen data with a mechanistic population model a new low cost method of estimating population size and relevant population dynamics was established keywords alces alces moose management simulation model sensitivity analysis population model citizen data data availability data is publically avalibable links are included 1 introduction management of wildlife populations needs to be based on reliable monitoring to provide feedback on whether goals are being achieved several survey methods are available to estimate wildlife abundance and many of these are based on voluntarily collected data and citizen sciences kosmala et al 2016 citizen science programs provide a unique opportunity to monitor wildlife populations explore population dynamics and interactions over large spatiotemporal ranges while also encouraging stakeholder participation engagement and trust chase et al 2004 singh et al 2014 cretois et al 2020 tallian et al 2020 in scandinavia nationwide citizen science programs were launched in the mid 1980 s where hunter observations were collected to support management of moose alces alces in sweden and norway hunter observations of moose are collected during the start of the hunting season in the autumn and provide indices of moose density post summer recruitment rate reproduction minus summer calf mortality and adult sex ratio ericsson and wallin 1999 solberg and sæther 1999 both solberg and sæther 1999 and rönnegård et al 2008 showed that hunter observations can be used to estimate long term population trends however the accuracy of the index is determined by the effort in terms of number of observation hours it may thereby restrict the use to areas large enough to provide enough observation hours ericsson and wallin 1999 differences in observability of animal categories bulls cows cows with calves etc may influence the indices solberg and sæther 1999 furthermore comparing density index between hunting areas is limited by differences in the observability which in turn is related to hunting methods and type of dominating vegetation ericsson and wallin 1999 before comparing density between hunting areas the index therefore needs to be calibrated with another population estimate the density index is therefore more suitable for analysis of the temporal trend in population size however the determination of ratios between different categories of animals e g sex ratio females with calves lone females is less influenced by differences in observability between areas ericsson and wallin 1999 and can therefore be used for comparisons across areas since predictive population models and hunting quotas within management are based on absolute numbers the indices provided by hunter observations need to be linked to absolute numbers of moose månsson et al 2011 estimations of moose abundance can be conducted using aerial surveys pellet group counts or a combination of various sources rönnegård et al 2008 but these methods are associated with different practical caveats and high costs månsson et al 2011 to provide a long term proxy of the moose population harvest statistics have been used in norway and sweden cederlund and markgren 1987 østgård 1987 lavsund et al 2003 ueno et al 2014 population models are an important tool in ecology and wildlife management that can be used to explore dynamics and how management options are related to different factors previously dynamic models on moose have been used to simulate the response of the population given different hunting strategies sylvén 1995 kalén 2018 changed climate rempel 2011 and different carnivore densities crete at al 1981 jonzén et al 2013 but also to evaluate the costs and benefits of aerial surveys in management boyce et al 2012 the swedish moose populations began to increase rapidly in the 1960s and have since then been among the most dense productive and heavily harvested moose populations in the world lavsund et al 2003 with an estimated number of about 265 000 individuals in 2010 post harvest jensen et al 2020 moose management in sweden is signified by collaborative governance regimes and multi objective land use dressel et al 2020 moose provide both ecosystem disservices with economic costs in terms of forest damage and vehicle collisions and services in terms of meat recreation hunting and tourism gill 1992 lavsund et al 2003 boman et al 2011 bergquist et al 2019 in sweden dense moose populations cause cascading indirect effects on the forest ecosystem felton et al 2019 the return of carnivores such as wolves canis lupus and brown bear ursus arctos needs increased consideration in management plans as they prey on moose rodríguez recio et al 2022 the swedish wildlife management system is to a large extent centered around moose hunting is the main source of mortality taking around 25 of the pre hunt population solberg et al 2000 since 2012 moose is managed according to an adaptive co management system to improve the basis for balancing the number of animals to levels that are acceptable with regards to the extent of browsing damage and other societal interests moose management areas mmas in swedish älgförvaltningsområden represent the focal management unit within the system to initiate management at a larger ecosystem scale dressel et al 2018 boundaries of mmas intend to accommodate the migratory behavior of moose by encompassing at least one distinct moose population naturvårdsverket 2011 in this paper we integrate citizen data hunter observations into a mechanistic population model to simulate and estimate moose abundance at various spatial scales in sweden between 2012 and 2020 such a model has the potential to produce cost effective estimates of absolute population size useful for wildlife management in operational management a mechanistic model of population dynamics can be useful for examining the effects of alternative hunting quotas and hunting techniques kalen 2018 the incorporation of quantitative data and scientific information into a mechanistic model may reveal gaps in scientific understanding 2 methods 2 1 data in sweden different data is systematically collected for moose management purposes and officially used for local management within moose management areas mmas that also can be linked to counties and regions fig 1 this annually collected data is publicly available and includes harvest statistics hunter observations slaughter weight traffic related mortality and registered hunting area www älgdata se table 1 data is also available on density of large carnivores we incorporated annual data between 2012 and 2020 into a database which then was used to parameterize and validate a mechanistic population model 2 1 1 hunter observations of moose hunter observations are collected during the first week of the hunting season and are used as one of several tools to find the appropriate harvest quotas in the following year in mmas annually about five million of observational hours is spent by hunters in sweden during this time about 300 000 observations of moose are registered three variables were used as input parameters in the population model density index post summer recruitment rate calf cow ratio and adult sex ratio density index is a ratio between the number of observed moose and the number of hours spent by the hunters post summer recruitment rate is measured as the ratio between the number of observed calves and adult females a measure of recruitment after summer mortality the number of observed adult males divided by the number of observed adult females constitute the adult sex ratio data was obtained at mma level and thereafter aggregated to county region and national level fig 1 in this procedure data was weighted ω by the average of registered hunting area a and harvest statistics h between the years y 2012 and 2020 n 8 years eq 1 and 2 1 ω i a i y n h i y n 2 x y ω i x i y ω i where i is mma x is the variable to be weighted and x is the aggregate value by using weighted data we found that simulations of population size on the national scale produced consistent results as when the results were aggregated from either county or regional level thus the simulated population size on the national level was comparable also when summed from the regional or county level data of carnivores harvest and traffic related mortality was aggregated summed to regional and national level without weight 2 1 2 harvest statistics hunters pay an administrative cost to the county council for each harvested moose harvest statistics are therefore seen as accurate and include information about the number of harvested adult bulls females bull calves and female calves although not used in this study harvest statistics also include information about age number of antler pins and weight 2 1 3 traffic related mortality in sweden it is obliged by law to report vehicle collisions with ungulates and large carnivores to the police a contracted hunter visits the site of collision to track down an injured or dead animal seiler et al 2016 gps location time and species involved in the accidents are then reported by the hunter and police to a data base managed by the swedish national council for wildlife accidents nationella viltolycksrådet www viltolycka se data of moose vehicle collisions was obtained for the period 2012 2020 for each mma and was aggregated to county region and national level 2 1 4 large carnivores in sweden brown bears ursus arctos prey on moose calves during summer rauset et al 2012 while wolves canis lupus prey on juvenile and adult moose year round sand et al 2005 sand et al 2008 for each county we included population data on brown bears kindberg et al 2011 åsbrink et al 2021 and wolves liberg et al 2012 svensson et al 2021 obtained from official surveys for each county wabakken et al 2020 the population of brown bears is monitored by dna based scat surveys in combination with capture mark recapture models kindberg et al 2011 an estimate of abundance and trend for brown bears between 2012 and 2020 was compiled for each county by combining population estimates made from dna analysis with population trends derived from brown bear hunter observations effort corrected observations of bears by moose hunters during the moose hunt kindberg et al 2011 and www viltdata se the total number of wolf territories has been counted each year since 1999 in annual winter wolf monitoring surveys liberg et al 2012 wabakken et al 2018 wikenros et al 2020 here family groups and scent marking pairs are located confirmed by authorized county personnel and counted via snow tracking and dna analysis of scat by technicians employed by the swedish authorities for detailed description of monitoring methods see liberg et al 2012 locations of territories are registered using minimum convex polygons mcps using the outermost located scent marks of the dominant adults for each territory and was later assigned to different counties based on their geographical location data for the counties dalarna gävleborg västernorrland and jämtland was weighted with area to account for differences in administrative borders and mma administrative belongings the compiled dataset is found in appendix a 2 2 model structure the core of the computer model is an age and sex explicit structure i e age classes from 0 to 19 years modelled separately for males and females and with age dependent fecundity mortality is divided into four categories hunting traffic carnivores and other mortality citizen data on density index recruitment rate and adult sex ratio between the years 2012 and 2020 were employed in a fitting technique with parameter modifications to minimize differences between observed and simulated data for these variables as a result the simulation model was calibrated to reflect population development and demographic structure between these years immigration and emigration were assumed to be equal and therefore not explicitly accounted for fig 2 illustrates the structure of the computer model the computer model was programmed in embarcadero delphi version 10 4 and with a connected mysql database the computer model is available for download at www simthinc com 2 2 1 recruitment rate the total number of new born calves entering the population is a function of age specific fecundity f and number of cows n within each age class eq 3 the sex ratio of new born calves was based on harvest statistics of calves moe et al 2009 3 c a l v e s f a g e n a g e the age dependent relationship of fecundity fage was based on data from eriksson and wallin 2001 and broman 2002 fig 3 and fitted into a modified double weibull function eq 4 4 f a g e a 1 a g e 20 b e a g e c c e a g e d d where b c and d are constants b 3 4 c 2 5 d 15 parameter a was allowed to vary between 0 and 2 during the goal seeking algorithm see figs 5 and 6 fecundity is thereby altered uniformly over the age span to obtain the best fit between simulated and observed post summer recruitment rate 2 2 2 mortality mortality related to carnivores traffic and other causes is in the model updated twice a year right before the hunting season summer mortality and before calf birth in spring winter mortality the data available on traffic related mortality allows for a division between adults calves and sex the mortality of traffic for each category is distributed equally over the year i e 4 12 during summer and 8 12 during winter the number of moose killed by a wolf pack was set to 120 per year zimmermann et al 2014 in summer 90 is attributed to calves and the remaining 10 to adults without sex or age dependence sand et al 2008 in winter 80 is attributed to calves and the remaining 20 to adults sand et al 2005 for bears the number of killed calves was set to 6 per adult bear and year rauset et al 2012 mortality from bears is only applied to calves during summer other mortality refers to mortality not related to hunting traffic accidents or carnivores thus other mortality is related to starvation disease accidents etc the official data on other mortality is based only on observed carcasses and therefore incomplete in previous work where mortality is reported one must determine if hunting traffic or carnivore related mortality is included in the mortality rate we scrutinized reported mortality rates lorentsen et al 1991 saether et al 1996 stubsjøen et al 2000 swenson et al 2007 ericsson et al 2001 ericsson and wallin 2001 broman et al 2002 solberg et al 2003 gundersen 2003 rönnegård et al 2008 and from that concluded that other mortality for calves is within the range of 5 to 24 and that adult mortality range between 2 and 7 broman et al 2002 concluded that traffic is responsible for about half of the adult mortality in the model calf mortality is simulated with a specific mortality rate see table 2 whereas adult mortality rate is simulated as a function of age fig 4 the age specific function for mortality rate m in adults was slightly modified as compared to kalén 2018 where a baseline mortality is used in combination with an age dependent mortality this modification makes it possible to increase both base mortality and age dependent mortality with a single parameter while maintaining the maximum age eq 5 5 m τ 1 τ a g e a g e m a x 1 τ g 1000 τ h where τ is used to set the mortality rate agemax 19 is a constant that determines the maximum lifespan to achieve a sensible relationship between base mortality and age dependent mortality the constants g and h were set to 16 and 0 55 respectively although the maximum age in this way is equal for bulls and females the proportion of bulls that are older than 15 years during simulations of regulated populations is usually less than 1 whereas this proportion for females usually ranges between 5 and 10 2 2 3 hunting annual harvest statistics of bulls females bull calves and female calves were applied in the model to simulate hunting in all simulations a bayesian approach was used to draw an individual moose from the population where the probability of being selected for harvest is related to sex and age a more thorough description is given in kalén 2018 except during the initialisation hunting is thereby specific on individual level and introduces a stochasticity in the model the model updates the population sequentially after each individual harvest throughout the hunting season starting in autumn and continues until the harvest quota is reached the number of individuals remaining after the hunt constitutes the post hunt population in appendix e table e1 assumptions and data sources used for setting mortality is summarised 2 3 estimating population size step one the population size and recruitment rate in the first year of the simulation period 2012 2020 is initially determined by an automated goal seeking algorithm fig 5 the purpose of this step is to calibrate the population s demographic structure as well as estimate a starting point of population size this is accomplished by utilizing current data adult sex ratio recruitment rate mortality harvest etc this algorithm relies on the assumption that a population can be maintained at a steady state with a specific annual harvest the population size is set by a sub algorithm iteratively seeking a specific annual harvest that fulfills the target steady state population see appendix d data on adult sex ratio calf sex ratio and other mortality is used for parameterisation and held as constants throughout this step net recruitment rate is calculated when the population reach a steady state the goal seeking algorithm adjusts the steady state population size and reproduction coefficient a in eq 4 iteratively to find a predetermined value of harvest and net recruitment rate estimating abundance in step one ends when harvest and recruitment rate is equal to values specified a priori i e actual data derived from harvest statistics and hunter observations for example in uppsala county the harvest and recruitment rate were reported to be 0 21 moose per km2 and 0 72 calves per adult female in 2012 respectively as shown in fig 5 the algorithm starts with finding a population density at a steady state that meets the reported harvest of 0 21 moose per km2 when this is found the model continues to adjust the recruitment rate coefficient until the reported value of recruitment rate 0 72 is found also at a steady state however as soon as recruitment rate is altered it will affect the annual harvest needed to maintain the target population the model therefore seeks a new value of the population density that corresponds to the reported harvest when both annual harvest and recruitment rate equal the reported values the algorithm ends and the values of the population size and recruitment rate coefficient are used in step two 2 4 estimating population size step two the purpose of step one is to achieve an estimate of population size and demographic structure only to be used as start values in the second step where a fitting algorithm is performed with support of a time series of actual harvest statistics an aggregated time series between 2012 and 2020 for the variables specified in table 1 was used to parameterise the model for the twenty counties four regions and at national level for each area the simulated density and recruitment rate was validated by optimizing the fit of population index i e moose observations per hour post summer recruitment rate and adult sex ratio also included within the time series the trend of simulated density and recruitment rate will be matched with actual data by iteratively modifying parameters setting initial density and recruitment rate prior to applying harvest and mortality data between 2012 and 2020 fig 6 the fit of each factor j population development recruitment rate and sex ratio were evaluated with eq 6 6 r j 2 m i n 1 x i y i 2 x i x 2 2 where xi is the simulated value in year i yi the observed in year i the three r2 values were individually weighted before being integrated into an overall model fit i e density weight 6 and recruitment weight 4 were prioritised over sex ratio weight 1 solberg and sæther 1999 concluded that there was an 85 chance that a positive or negative change in population density was followed by an equal change in density index we therefore attributed this factor to the highest weight differences in recruitment rate have higher relative impact on population dynamics than the sex ratio which motivates a higher weight attributed to this factor compared to the adult sex ratio as each factor may vary independently during the fitting process an integrated r2 value was applied to optimize the overall fit of the three factors the algorithm ends when the integrated r2 fit does not improve within thirty iterations it is worth noting that the simulated trend of adult sex ratio is not influenced by any parameter but rather is the consequence of sex specific adult harvesting during the simulation period prior to calculating the fit the observed density index d was transformed to the same scale as simulated pre hunt density d eq 7 7 y i d i d i d i where yi is the transformed value of observed density index in year i this transformation will produce an identical mean for y and d 2 5 mortality scenarios to account for uncertainty in other mortality we ran simulations with three different levels of other mortality table 2 we used a lower mortality rate for calves in areas where carnivores are present to account for compensatory mortality 2 6 validation and sensitivity analysis the model was validated with independent population census in jönköping county estimated by group pellet count see appendix b prior to running the model with data for all counties regions and at the national level a sensitivity analysis of citizen data was performed at national level on recruitment rate adult sex ratio obtained from hunter observations and calf sex ratio obtained from harvest statistics population estimates were obtained after parameter values were decreased or increased separately by 10 prior to each run the average parameter data between 2012 and 2020 on the national scale for recruitment rate calf per cow was 0 62 adult sex ratio 1 1 in sweden the proportion of bulls in the adult population is used rather than the male female ratio r to convert to proportion p use p r 1 r m f 0 57 and calf sex ratio m f 1 06 for comparison the national targets for recruitment rate and adult sex ratio are set at 0 6 and 0 54 respectively naturvårdsverket 2018 3 results mean hunter observation aggregated for all sweden decreased from 0 053 observations per hour hunting effort in 2012 to 0 046 in 2020 this corresponds to a 13 overall decrease or a 1 8 annual decrease the simulated post hunt moose population in sweden decreased from 270 000 to 228 000 individuals between 2012 and 2020 which corresponds to a 15 decrease or a 2 annual decrease the 2020 pre hunt density was estimated to 0 83 per km2 which is a 14 drop from 0 97 per km2 in 2012 registered hunting area was in 2020 approximately 375 000 km2 the post hunt population density decreased from 0 72 per km2 in 2012 to 0 61 per km2 in 2020 the simulation model was able to iteratively converge to a good fit between pre hunt density r2 0 973 recruitment rate r2 0 989 adult sex ratio r2 0 996 and their counterparts as derived from the hunter observations fig 7 running the model with high and low levels of other mortality resulted in a deviation of about 4 of the final population estimate as compared to the base scenario see table 2 the sensitivity analysis showed that simulated population size was about twice as sensitive to deviations in recruitment rate as compared to the adult sex ratio calf sex ratio obtained from harvest statistics showed the lowest sensitivity of the tested parameters fig 8 in accordance with the population trend at the national level the simulated population development for the four sub regions also showed a decreasing trend the result obtained when simulated at a regional level was consistent with simulations at county level and later summed to the regional level fig 9 the estimated population in 2020 for each sub region simulated with different values of mortality other than related to hunting carnivores and traffic is presented in table 3 in appendix c simulation estimates for the twenty counties are listed 4 discussion in this study we demonstrate how to estimate the population size of moose at various geographical scales by combining citizen science data in terms of hunter observations with other sources of data in a mechanistic population model the model converged to a good fit in all variables used for parameterisation and validation i e moose density index recruitment rate and adult sex ratio according to model estimates the moose population in sweden was 311 000 4 individuals pre hunt and 228 000 4 post hunt in 2020 and that the population has decreased with 15 or 2 per annum since 2012 the total number of harvested individuals in 2020 was 82 827 which means that 27 of the summer population was harvested the population estimate is in line with earlier estimates jensen et al 2020 each of the four regions showed a decrease but with different magnitudes 21 16 7 and 20 for northernmost northern central and southern sweden respectively the objective in most mma during this period has been to lower the moose population to alleviate browsing damage on young scots pines pinus sylvestris consequences of browsing damage on pine are related to high economic losses for the forest industry bergquist et al 2018 a recent report concluded that the moose population decreased by 10 between 2014 and 2020 widemo et al 2022 the sensitivity analysis revealed that the model estimate was most sensitive for variation in recruitment rate calves per female followed by adult sex ratio and calf sex ratio inaccurate parameter data will therefore influence the population estimate but to various degrees for example if recruitment rate is underestimated the abundance will be overestimated and vice versa reproduction in moose have shown considerable variation among local populations and over time due to density dependent processes or climatic variation within scandinavia sand and cederlund 1996 sand et al 1997 solberg et al 2006 grøtan et al 2009 significant variation in moose population productivity has also been documented in north america ferguson 2002 likewise if the proportion of males is overestimated the simulated population size will also be overestimated the observational data on the sex ratio may be biased due to behavioural differences between adult males and females this can be particularly apparent in relation to when the first hunting week occurs in relation to the rut during which males are known to be more active than females cederlund and sand 1994 solberg et al 2010 found a consistent over estimation of the proportion of males in the hunter observations however based on the consistency between the simulated and observed sex ratio we did not find any indication of a systematic or consistent bias in the adult sex ratio the population estimate was least sensitive to calf sex ratio the low sensitivity in this variable indicates that it is possible to use a constant if annual estimation of calf sex ratio is missing based on harvest statistics at a national level the average sex ratio for calves m f was 1 06 between 2012 and 2020 i e 51 5 male calves we used hunter observations to both parameterise and validate the model validation with independent data at a national or regional scale is not possible as other sources of population estimates are unavailable the aim of our population model was to simulate net recruitment and mortality with relevant mechanistic causal relationships and with available parameter data to come as close as possible to the true net population growth validating not only with density index moose observations per hour hunting effort but also recruitment rate and adult sex ratio narrows down the plausible outcomes of the model as these will affect both growth and abundance prior to running the model on a national and regional scale we validated the model with data from jönköping county where high consistency in both estimated population size and trends were obtained appendix b in addition to being non randomly sampled in space and time the use of hunter observations in local management is limited by the uncertainty derived from low hunting effort the total number hours of observation while moose hunting areas a subdivision of mmas usually are the smallest operational unit where harvest quotas are set the recommended number of observational hours per year 5000 is often not achieved to produce reliable trends ericsson and kindberg 2011 therefore there is a limitation to when and where the model described here is applicable already at the mma level there are areas where observation data fluctuates more between years than what should be expected from actual changes in moose abundance this will introduce additional uncertainty into the model results according to findings during our analysis we suggest that hunter observations should be weighted with area and harvest statistics when aggregated to a higher level i e from mma to county and so forth when observations were weighted before being aggregated to a higher level the simulated results of the total moose population were essentially the same when summed to the national level from either county or regional level the theoretical argument for weighting hunter observations is that the number of moose observations is determined by the number of moose and the number of hunters contributing to the statistics area although correlated does not in itself contribute to moose observations and therefore needs to be accounted for when aggregating two areas of different size furthermore a productive area in terms of annual average moose harvest should have a higher influence on moose density index number of moose observed per hour when aggregated with a less productive area of equal size the reason being that the former is likely to have a denser moose population than the latter in our study a constant was used to set the number of moose killed by large carnivores during the simulations however wolf and bear impact on the local moose population in scandinavia may range from low to high depending on their density and the presence of alternative prey species wikenros et al 2015 2020 tallian et al 2021 indeed wolves and brown bears have shown to have a major limiting effect on moose populations in north america sometimes preventing further growth in the moose population boertje et al 2009 2010 in areas in scandinavia where the presence of other deer species is substantial the number of killed moose per wolf territory is likely to be reduced due to the observed ability for wolves to switch prey from moose to smaller deer where they are sufficiently abundant sand et al 2016 at present wolves are mainly concentrated in moose dominated areas but as the wolf population expands to the south other deer species become more abundant therefore we would need to include more detailed data on the rate and composition of prey species killed by wolves in this part of the country rodríguez recio et al 2022 as the estimate of population size is derived while applying actual harvest statistics our model may also be used in moose management to set harvest quotas to achieve a specified population density and sex composition an important objective in swedish moose management is to balance moose density with forest damage one way to alleviate browsing damage is by reducing the moose population regardless of its actual size it is in this perspective more relevant to manage the population trend than absolute numbers a specific feature of our model is that the simulated population trend is robust to changes in parameter assumptions such as for mortality that is although running the model with a different mortality the fitting algorithm will result in the same population trend not size this may be counterintuitive at first as the same harvest is applied during simulation however it is explained by the fact that both population density and recruitment rate are adjusted during the fitting algorithm and therefore able to adapt to various levels of mortality from a management perspective this is of benefit when analysing the effect of different harvest quotas on population development population trajectories based on hunter observations have uncertainties analysis of long term ecological studies have shown that trends that are identified in a short period broken window can be misleading bahlai et al 2021 the optimal time span to be used with hunter observational data to detect a consistent trend has not been tested it will to some extent be dependent on the number of observational hours used to obtain the data in our analysis we aggregated data to county level as the smallest unit the average number of observational hours spent annually between 2012 and 2020 at county level was 240 000 which is far above the recommendation of at least 5000 h on this level we propose that simulations should be done with a minimum of four years of data however to avoid too much influence from systematic bias and annual stochasticity e g erroneous data influence of weather immigration and emigration there is also an optimal upper limit for using trend data in our simulation model we propose that the best interval for trend data in our simulation model is between 5 and 8 years this would also be applicable to mmas a fundamental goal in population ecology is to understand how populations are regulated newton 1998 development of methods to improve the precision of population estimates has become increasingly important in wildlife management in collaborative governance regimes and multi objective land use dressel et al 2020 sepa 2018 citizen science data can contribute with cost effective data for use in operative management szabo et al 2013 previously citizen data has been used in non mechanistic integrated population models to estimate population development rönnegård et al 2008 using a mechanistic and dynamic systems approach where causal relationships are explicitly simulated has the benefit of being more straight forward as compared to the complexity of incorporating feedback mechanisms in matrix algebra davis and kessler 2016 in addition as several demographic entities are integrated into our model demographic structure average age adult sex ratio recruitment rate it allows for the possibility to explore various demographic processes within a population schaub and abadi 2011 a possible further development of the model is to integrate landscape features for exploring forest damage carrying capacity dynamics and alternative causes of actions in moose management apart from fostering understanding of such processes such a model has the potential to be a valuable tool in operative management to map population trends analyze harvest strategies and to set new management goals 5 conclusion citizen data has the potential to support management and conservation by covering vast spatial and temporal scales not economically feasible to cover by other means in our study we show one way of integrating citizen data in terms of hunter observation into a population model to estimate moose abundance at various scales as the simulation was performed by applying actual harvest statistics the model can also be used to forecast population development at a given sex and age differentiated harvest and recruitment rate funding this work was partially funded by a grant from the european union for rural development specifically målstyrd förvaltning av klövvilt grant number 28 422 credit authorship contribution statement christer kalén conceptualization methodology software validation formal analysis investigation resources data curation writing original draft writing review editing henrik andrén methodology formal analysis supervision writing review editing johan månsson methodology writing review editing håkan sand methodology resources supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper the authors declare the following financial interests personal relationships which may be considered as potential competing interests appendix a estimated population development of bears and wolf territories table a 1 and table a 2 appendix b model validation via pellet count the pellet group count method is an established method to estimate moose density and is commonly used in within the fennoscandian moose management neff 1968 wennberg digasper 2006 rönnegård et al 2008 in jönköping county a pellet group count is voluntarily carried out by hunters on an annual basis the county administration receives the data and produces an annual report the sampling method is based on permanent 1 1 km squares systematically distributed over the area i e a moose management unit or a moose license area each square has 20 five along each side permanent circular sample plots of 100 m2 in 2020 data on 75 565 plots were sampled within the county to register a single pellet group count a minimum of 20 pellets should be identified the density d measured as moose individuals per km2 is calculated with eq b 1 b 1 d 10000 p d p f where p is the total number of moose pellet groups found d is days since the plot was cleared from pellets in the autumn p is the total number of plots and f is a constant representing the number of droppings per moose and day the constant f defecation rate has a large influence on the final density and studies have found it to vary between 14 and 23 5 härkönen and heikkilä 1999 matala and uotila 2013 in jönköping s county two alternative values of defecation rate are officially used to estimate the density of moose 17 and 19 in diagram b 1 results from the moose pellet count is given with these two values of the constant together with result from estimating the density through the model described in the paper the simulated moose density corresponds well with the moose pellet group count census fig b 1 the simulated post hunt population was closer to the trend derived from pellet count however the negative slope of pre hunt simulation is more aligned to the slope of the trend of pellet counts one explanation for this is that the pellet count is not solely an estimate of post hunt density instead the trend derived from moose pellets may be a mixture between pre and post hunt density neff d j 1968 the pellet group count technique for big game trend census and distribution a review journal of wildlife management 32 3 pp 597 614 doi 10 2307 3 798 941 härkönen s heikkilä r 1999 use of pellet group counts in determining density and habitat use of moose alces alces in finland wildlife biology 5 4 233 239 doi 10 2981 wlb 1999 028 matala j uotila a 2013 diurnal defecation rate of moose in southwest finland alces a journal devoted to the biology and management of moose 49 155 161 rönnegård l sand h andrén h månsson j pehrson å 2008 evaluation of four methods used to estimate population density of moose alces alces wildl biol 14 358 371 wennberg digasper s 2006 already adaptive an investigation of the performance of swedish moose management organizations licentiate thesis luleå university of technology luleå sweden 133 pp appendix c result of model estimate of population development between 2012 and 2020 within 20 counties table c 1 and table c 2 appendix d description of population routine to estimate initial population during the model s initialization an estimated total population is calculated that meets the required parameters for adult sex ratio calf birth sex ratio net recruitment rate and male proportion in the harvest the population model used in step 2 is fairly similar to this one see article section 2 4 the primary distinction is that in the latter model the harvest of bulls females and calves is used rather than the population being a function of harvest hunting hunting is applied iteratively within a goal seeking algorithm that aims to meet a specified population density at steady state in other words a hunting pressure see chapter 4 change annually until the wanted steady state population is met the model runs 2000 annual cycles to ensure that a steady state density is reached the model is initialised with an arbitrary population in addition to setting wanted density the algorithm also adjusts adult sex ratio to a desired ratio the demographic structure of the population is determined by the adult sex ratio and a certain proportion of calves in the harvest hunting of adult females the hunted h females f in age class i is calculated using an expression where a coefficient h is allowed to vary iteratively between each annual cycle to find a stable population equilibrium that meets the wanted density 1 h f i h 1 γ a f i s f i where f is age specific fecundity and a is the parameter used in eq 4 original paper and γ 0 5 is a constant that scales the fecundity dependent hunting pressure in this way hunting is allocated more to females with a lower fecundity rate the theory behind this is that females that are followed by one or more calves have a lesser risk of being shot younger and older females thereby have a higher risk of being harvested setting of h is described further in section 4 this appendix the post hunt female winter population w is calculated by subtracting the harvested females from the pre hunt summer population 2 w f s f i h f i the pre hunt male population sm is calculated by subtracting the adult females from the total pre hunt population 3 s m s t s f the total post hunt adult population wt is estimated by using the wanted proportion of adult males p 4 w t w f 1 p the post hunt adult male population wm is then estimated by subtracting the adult females from the total adult population note that this is an estimated recursive value that later is corrected 5 w m w t w f male hunting hunting of males is calculated by summing the proportion of each age class multiplied by the difference between pre hunt male population and the estimated post hunt male population 6 h m i s m i s m w m s m the post hunt adult population is then calculated by subtracting the hunted individuals from the pre hunt population this is the corrected value of post hunt winter population of males 7 w m i s m i h m i births the number of born calves b is a calculated from age specific i fecundity f eq 4 in the main article and number of females w f in each cohort in winter 8 b f i w f a sex ratio divides the total number of births into females and males mortality mortality is calculated twice a year first in spring after the winter period winter mortality second before hunting period starts in the autumn summer mortality the number of dead adults in the model adult mortality is set for each sex however the mortality function is not only specific for each sex but also for each age class to implement the sex specific net mortality a correction factor needs to be calculated before applying sex and age specific adult mortality this is performed by the following two equations first mortality σ is calculated with age specific mortality m derived from a mortality function eq 5 in the main article 9 σ s m s i s s i 3 a correction factor k is then calculated for each sex s 10 k s m s s s i 3 σ s where m is the given total mortality rate for sex s is summer population and i is age class it is assumed that all adults have the same risk of being killed by carnivores or traffic incidents a ratio r is calculated to separate carnivore and traffic related mortality into the two sexes 11 r s s s i s i the total number of dead adults d in summer for a specific sex and age class can now be calculated 12 d s i k s m s i s s i 3 0 1 r s m w s s i 3 s s i r s m t s s i 3 s s i where m is the number of individuals killed by wolves w and traffic t note that bears b are assumed to only kill calves it is further assumed that 10 of the total wolf kills is on adults during summer and the rest is attributed to calves further the equation described here constitute mortality for four summer months i e 1 3 of the total annual mortality in winter it is assumed that 20 of wolf kills is attributed to adults calf mortality the number of dead calves d0 age class 0 in summer for each sex is calculated in a simpler fashion 13 d s 0 r s m s 0 b s 0 0 9 r s m w 3 r s m b 3 r s m t 3 where r is the proportion of the specific sex at birth e g female calves calves m is the summer calf mortality rate for sex s b is the number of births calculation of calf winter mortality is similar except for that 80 of the wolf kills is attributed to calves no calves is killed by bears b during winter and that winter mortality is 2 3 of the total annual mortality the mortality rate m related to other mortality can be set specifically for summer and winter to allow for difference in calf mortality during these two seasons automatic hunting device algorithm the automatic hunting device is an algorithm that seeks a target steady state population by iteratively applying a certain hunting pressure the fecundity constant a in eq 4 main article is held constant during this process during step 1 chapter 2 3 an overarching algorithm sets the value of a and the initial population by iteratively seeking a specific net recruitment rate and harvest rate the algorithm finds a level of a and initial population where harvest and recruitment rate calves per female after summer mortality corresponds to the actual data for that particular hunting area in this section the algorithm that finds a specific harvest that will keep the population at a specified wanted density is described algorithm 1 parameters are set a wanted density b wanted pre hunt proportion of bulls in the adult population c proportion of calves in total harvest d calf sex ratio e mortality not related to hunting 2 run the population iteratively for a number of times 2000 where hunting pressure is applied to the annual harvest the algorithm seeks the hunting pressure that results in the wanted steady state density to speed up this process the use of numerically solving differential equations is used 3 the algorithm ends when a steady state of wanted density is met numerically solving of differential equations determining hunting pressure is performed in each iteration by the use of two variables that are updated within this procedure the first variable p follows the population density the second variable is used to set the hunting pressure h heun s algorithm is used to numerically solve a first order differential equation heun s method is a little bit more advanced than the more common euler s method both of these methods use the idea of local linearity or linear approximation the difference between euler s method and heun s method is that the latter use a predictor and then a corrector to calculate the slope the slope is then the average of the predictor and the correction the method is in other word recursive and a bit more efficient that euler s method variable p a population density variable p is that follow the simulated population is used the slope of population density is a function of present density d derived from the population model and current value of p 14 d p d t d p variable p is then updated using the heun s algorithm not described here and timestep s 0 25 15 p t 1 p t d p d t s variable h the current population trend t is first calculated if the simulated population is below p the trend is negative 16 t d p p the deviance h from wanted density w is calculated where k1 is a constant setting sensitivity 0 01 17 h min 0 2 k 1 p w 3 finally the slope for the hunting pressure h is calculated by adding t and h 18 d h d t h t variable h is updated in the same way as for variable p 19 h t 1 h t d h d t s variable h is then used in eq 1 this appendix to set the annual hunting pressure on females appendix e parameters table e 1 broman e wallin k steén m cederlund g 2002 mass deaths of moose alces alces in southern sweden population level characterization wildl biol 8 219 228 ericsson g wallin k 2001 age specific moose alces alces mortality in a predator free environment evidence for senescence in females ecoscience 8 2 157 163 doi 10 1080 11 956 860 2001 11682641 ericsson g wallin k ball j p broberg m 2001 age related reproductive effort and senescence in free ranging moose alces alces ecology 82 1613 1620 gundersen h 2003 vehicle collisions and wolf predation challenges in the management of a migrating moose population in southeast norway dr scient thesis university of oslo lorentsen ø wiseth b einvik k pedersen p h 1991 elg i nord trøndelag resultater fra sand h wabakken p zimmermann b johansson o pedersen h liberg o 2008 summer kill rates and predation pattern in a wolf moose system can we rely on winter estimates oecologia 156 53 64 doi 10 1007 s00442 008 0969 2 saether b e andersen r hjeljord o heim m 1996 ecological correlates of regional variation in life history of the moose alces reply ecology 77 1493 doi 10 2307 2 265 546 sand h zimmermann b wabakken p andrén h pedersen h 2005 using gps technology and gis cluster analyses to estimate kill rates in wolf ungulate ecosystems wildlife society bulletin 33 914 925 doi 10 2307 3 785 028 solberg e j heim m arnemo j os ø 2003 does rectal palpation of pregnant moose cows affect pre and neonatal mortality of their calves alces 39 65 67 stubsjøen t saether b e solberg e j heim m rolandsen c 2000 moose alces alces survival in three populations in northern norway canadian journal of zoology 78 1822 1830 doi 10 1139 z00 132 swenson j e dahle b busk h opseth o johansen t söderberg a wallin k cederlund g 2007 predation on moose calves by european brown bears journal of wildlife management 71 1993 1997 rauset g r kindberg j swenson j 2012 modeling female brown bear kill rates on moose calves using global positioning satellite data the journal of wildlife management 76 1597 1606 doi 10 1002 jwmg 452 rönnegård l sand h andrén h månsson j pehrson å 2008 evaluation of four methods used to estimate population density of moose alces alces wildl biol 14 358 371 zimmermann b sand h wabakken p wikenros c eriksen a strømseth t holen f maartmann e ahlqvist p arnemo j milleret c liberg o pedersen h 2014 ulven som rovdyr på klauvvilt i skandinavia in ikkje berre ulv og bly glimt frå forskinga på evenstad publisher opplandske bokforlag editors torstein storaas kjell langda elgundersøkelsene 1987 1990 om vandringsmønster brunst kalvinger og dødelighet fylkesmannen i nord trøndelag report 1 in norwegian 
24402,long term and wide ranging citizen science programs provide a unique opportunity to monitor wildlife populations and trends through time while encouraging stakeholder participation engagement and trust hunter observations is such a program that in sweden is used on a regular basis to monitor population trends of moose however hunter observations are not reliable to determine the actual population size we developed a mechanistic moose population model that integrated citizen science data and used it at various geographical scales to estimate moose population size between 2012 and 2020 a sensitivity analysis specifically performed for recruitment adult sex ratio and calf sex ratio showed that the simulated population size was most sensitive for variation in recruitment according to the results sweden had a total moose population of 311 000 4 individuals pre hunt and 228 000 4 post hunt in 2020 the post hunt moose abundance has decreased nationwide with 15 from 0 72 to 0 61 moose per km2 during the 2012 2020 period the present post hunt moose density was estimated at 0 39 0 78 0 84 and 0 54 per km2 for the regions northernmost northern central and southern sweden respectively the simulation model can be used for strategic and operative management at various geographical scales and is publicly available by integrating citizen data with a mechanistic population model a new low cost method of estimating population size and relevant population dynamics was established keywords alces alces moose management simulation model sensitivity analysis population model citizen data data availability data is publically avalibable links are included 1 introduction management of wildlife populations needs to be based on reliable monitoring to provide feedback on whether goals are being achieved several survey methods are available to estimate wildlife abundance and many of these are based on voluntarily collected data and citizen sciences kosmala et al 2016 citizen science programs provide a unique opportunity to monitor wildlife populations explore population dynamics and interactions over large spatiotemporal ranges while also encouraging stakeholder participation engagement and trust chase et al 2004 singh et al 2014 cretois et al 2020 tallian et al 2020 in scandinavia nationwide citizen science programs were launched in the mid 1980 s where hunter observations were collected to support management of moose alces alces in sweden and norway hunter observations of moose are collected during the start of the hunting season in the autumn and provide indices of moose density post summer recruitment rate reproduction minus summer calf mortality and adult sex ratio ericsson and wallin 1999 solberg and sæther 1999 both solberg and sæther 1999 and rönnegård et al 2008 showed that hunter observations can be used to estimate long term population trends however the accuracy of the index is determined by the effort in terms of number of observation hours it may thereby restrict the use to areas large enough to provide enough observation hours ericsson and wallin 1999 differences in observability of animal categories bulls cows cows with calves etc may influence the indices solberg and sæther 1999 furthermore comparing density index between hunting areas is limited by differences in the observability which in turn is related to hunting methods and type of dominating vegetation ericsson and wallin 1999 before comparing density between hunting areas the index therefore needs to be calibrated with another population estimate the density index is therefore more suitable for analysis of the temporal trend in population size however the determination of ratios between different categories of animals e g sex ratio females with calves lone females is less influenced by differences in observability between areas ericsson and wallin 1999 and can therefore be used for comparisons across areas since predictive population models and hunting quotas within management are based on absolute numbers the indices provided by hunter observations need to be linked to absolute numbers of moose månsson et al 2011 estimations of moose abundance can be conducted using aerial surveys pellet group counts or a combination of various sources rönnegård et al 2008 but these methods are associated with different practical caveats and high costs månsson et al 2011 to provide a long term proxy of the moose population harvest statistics have been used in norway and sweden cederlund and markgren 1987 østgård 1987 lavsund et al 2003 ueno et al 2014 population models are an important tool in ecology and wildlife management that can be used to explore dynamics and how management options are related to different factors previously dynamic models on moose have been used to simulate the response of the population given different hunting strategies sylvén 1995 kalén 2018 changed climate rempel 2011 and different carnivore densities crete at al 1981 jonzén et al 2013 but also to evaluate the costs and benefits of aerial surveys in management boyce et al 2012 the swedish moose populations began to increase rapidly in the 1960s and have since then been among the most dense productive and heavily harvested moose populations in the world lavsund et al 2003 with an estimated number of about 265 000 individuals in 2010 post harvest jensen et al 2020 moose management in sweden is signified by collaborative governance regimes and multi objective land use dressel et al 2020 moose provide both ecosystem disservices with economic costs in terms of forest damage and vehicle collisions and services in terms of meat recreation hunting and tourism gill 1992 lavsund et al 2003 boman et al 2011 bergquist et al 2019 in sweden dense moose populations cause cascading indirect effects on the forest ecosystem felton et al 2019 the return of carnivores such as wolves canis lupus and brown bear ursus arctos needs increased consideration in management plans as they prey on moose rodríguez recio et al 2022 the swedish wildlife management system is to a large extent centered around moose hunting is the main source of mortality taking around 25 of the pre hunt population solberg et al 2000 since 2012 moose is managed according to an adaptive co management system to improve the basis for balancing the number of animals to levels that are acceptable with regards to the extent of browsing damage and other societal interests moose management areas mmas in swedish älgförvaltningsområden represent the focal management unit within the system to initiate management at a larger ecosystem scale dressel et al 2018 boundaries of mmas intend to accommodate the migratory behavior of moose by encompassing at least one distinct moose population naturvårdsverket 2011 in this paper we integrate citizen data hunter observations into a mechanistic population model to simulate and estimate moose abundance at various spatial scales in sweden between 2012 and 2020 such a model has the potential to produce cost effective estimates of absolute population size useful for wildlife management in operational management a mechanistic model of population dynamics can be useful for examining the effects of alternative hunting quotas and hunting techniques kalen 2018 the incorporation of quantitative data and scientific information into a mechanistic model may reveal gaps in scientific understanding 2 methods 2 1 data in sweden different data is systematically collected for moose management purposes and officially used for local management within moose management areas mmas that also can be linked to counties and regions fig 1 this annually collected data is publicly available and includes harvest statistics hunter observations slaughter weight traffic related mortality and registered hunting area www älgdata se table 1 data is also available on density of large carnivores we incorporated annual data between 2012 and 2020 into a database which then was used to parameterize and validate a mechanistic population model 2 1 1 hunter observations of moose hunter observations are collected during the first week of the hunting season and are used as one of several tools to find the appropriate harvest quotas in the following year in mmas annually about five million of observational hours is spent by hunters in sweden during this time about 300 000 observations of moose are registered three variables were used as input parameters in the population model density index post summer recruitment rate calf cow ratio and adult sex ratio density index is a ratio between the number of observed moose and the number of hours spent by the hunters post summer recruitment rate is measured as the ratio between the number of observed calves and adult females a measure of recruitment after summer mortality the number of observed adult males divided by the number of observed adult females constitute the adult sex ratio data was obtained at mma level and thereafter aggregated to county region and national level fig 1 in this procedure data was weighted ω by the average of registered hunting area a and harvest statistics h between the years y 2012 and 2020 n 8 years eq 1 and 2 1 ω i a i y n h i y n 2 x y ω i x i y ω i where i is mma x is the variable to be weighted and x is the aggregate value by using weighted data we found that simulations of population size on the national scale produced consistent results as when the results were aggregated from either county or regional level thus the simulated population size on the national level was comparable also when summed from the regional or county level data of carnivores harvest and traffic related mortality was aggregated summed to regional and national level without weight 2 1 2 harvest statistics hunters pay an administrative cost to the county council for each harvested moose harvest statistics are therefore seen as accurate and include information about the number of harvested adult bulls females bull calves and female calves although not used in this study harvest statistics also include information about age number of antler pins and weight 2 1 3 traffic related mortality in sweden it is obliged by law to report vehicle collisions with ungulates and large carnivores to the police a contracted hunter visits the site of collision to track down an injured or dead animal seiler et al 2016 gps location time and species involved in the accidents are then reported by the hunter and police to a data base managed by the swedish national council for wildlife accidents nationella viltolycksrådet www viltolycka se data of moose vehicle collisions was obtained for the period 2012 2020 for each mma and was aggregated to county region and national level 2 1 4 large carnivores in sweden brown bears ursus arctos prey on moose calves during summer rauset et al 2012 while wolves canis lupus prey on juvenile and adult moose year round sand et al 2005 sand et al 2008 for each county we included population data on brown bears kindberg et al 2011 åsbrink et al 2021 and wolves liberg et al 2012 svensson et al 2021 obtained from official surveys for each county wabakken et al 2020 the population of brown bears is monitored by dna based scat surveys in combination with capture mark recapture models kindberg et al 2011 an estimate of abundance and trend for brown bears between 2012 and 2020 was compiled for each county by combining population estimates made from dna analysis with population trends derived from brown bear hunter observations effort corrected observations of bears by moose hunters during the moose hunt kindberg et al 2011 and www viltdata se the total number of wolf territories has been counted each year since 1999 in annual winter wolf monitoring surveys liberg et al 2012 wabakken et al 2018 wikenros et al 2020 here family groups and scent marking pairs are located confirmed by authorized county personnel and counted via snow tracking and dna analysis of scat by technicians employed by the swedish authorities for detailed description of monitoring methods see liberg et al 2012 locations of territories are registered using minimum convex polygons mcps using the outermost located scent marks of the dominant adults for each territory and was later assigned to different counties based on their geographical location data for the counties dalarna gävleborg västernorrland and jämtland was weighted with area to account for differences in administrative borders and mma administrative belongings the compiled dataset is found in appendix a 2 2 model structure the core of the computer model is an age and sex explicit structure i e age classes from 0 to 19 years modelled separately for males and females and with age dependent fecundity mortality is divided into four categories hunting traffic carnivores and other mortality citizen data on density index recruitment rate and adult sex ratio between the years 2012 and 2020 were employed in a fitting technique with parameter modifications to minimize differences between observed and simulated data for these variables as a result the simulation model was calibrated to reflect population development and demographic structure between these years immigration and emigration were assumed to be equal and therefore not explicitly accounted for fig 2 illustrates the structure of the computer model the computer model was programmed in embarcadero delphi version 10 4 and with a connected mysql database the computer model is available for download at www simthinc com 2 2 1 recruitment rate the total number of new born calves entering the population is a function of age specific fecundity f and number of cows n within each age class eq 3 the sex ratio of new born calves was based on harvest statistics of calves moe et al 2009 3 c a l v e s f a g e n a g e the age dependent relationship of fecundity fage was based on data from eriksson and wallin 2001 and broman 2002 fig 3 and fitted into a modified double weibull function eq 4 4 f a g e a 1 a g e 20 b e a g e c c e a g e d d where b c and d are constants b 3 4 c 2 5 d 15 parameter a was allowed to vary between 0 and 2 during the goal seeking algorithm see figs 5 and 6 fecundity is thereby altered uniformly over the age span to obtain the best fit between simulated and observed post summer recruitment rate 2 2 2 mortality mortality related to carnivores traffic and other causes is in the model updated twice a year right before the hunting season summer mortality and before calf birth in spring winter mortality the data available on traffic related mortality allows for a division between adults calves and sex the mortality of traffic for each category is distributed equally over the year i e 4 12 during summer and 8 12 during winter the number of moose killed by a wolf pack was set to 120 per year zimmermann et al 2014 in summer 90 is attributed to calves and the remaining 10 to adults without sex or age dependence sand et al 2008 in winter 80 is attributed to calves and the remaining 20 to adults sand et al 2005 for bears the number of killed calves was set to 6 per adult bear and year rauset et al 2012 mortality from bears is only applied to calves during summer other mortality refers to mortality not related to hunting traffic accidents or carnivores thus other mortality is related to starvation disease accidents etc the official data on other mortality is based only on observed carcasses and therefore incomplete in previous work where mortality is reported one must determine if hunting traffic or carnivore related mortality is included in the mortality rate we scrutinized reported mortality rates lorentsen et al 1991 saether et al 1996 stubsjøen et al 2000 swenson et al 2007 ericsson et al 2001 ericsson and wallin 2001 broman et al 2002 solberg et al 2003 gundersen 2003 rönnegård et al 2008 and from that concluded that other mortality for calves is within the range of 5 to 24 and that adult mortality range between 2 and 7 broman et al 2002 concluded that traffic is responsible for about half of the adult mortality in the model calf mortality is simulated with a specific mortality rate see table 2 whereas adult mortality rate is simulated as a function of age fig 4 the age specific function for mortality rate m in adults was slightly modified as compared to kalén 2018 where a baseline mortality is used in combination with an age dependent mortality this modification makes it possible to increase both base mortality and age dependent mortality with a single parameter while maintaining the maximum age eq 5 5 m τ 1 τ a g e a g e m a x 1 τ g 1000 τ h where τ is used to set the mortality rate agemax 19 is a constant that determines the maximum lifespan to achieve a sensible relationship between base mortality and age dependent mortality the constants g and h were set to 16 and 0 55 respectively although the maximum age in this way is equal for bulls and females the proportion of bulls that are older than 15 years during simulations of regulated populations is usually less than 1 whereas this proportion for females usually ranges between 5 and 10 2 2 3 hunting annual harvest statistics of bulls females bull calves and female calves were applied in the model to simulate hunting in all simulations a bayesian approach was used to draw an individual moose from the population where the probability of being selected for harvest is related to sex and age a more thorough description is given in kalén 2018 except during the initialisation hunting is thereby specific on individual level and introduces a stochasticity in the model the model updates the population sequentially after each individual harvest throughout the hunting season starting in autumn and continues until the harvest quota is reached the number of individuals remaining after the hunt constitutes the post hunt population in appendix e table e1 assumptions and data sources used for setting mortality is summarised 2 3 estimating population size step one the population size and recruitment rate in the first year of the simulation period 2012 2020 is initially determined by an automated goal seeking algorithm fig 5 the purpose of this step is to calibrate the population s demographic structure as well as estimate a starting point of population size this is accomplished by utilizing current data adult sex ratio recruitment rate mortality harvest etc this algorithm relies on the assumption that a population can be maintained at a steady state with a specific annual harvest the population size is set by a sub algorithm iteratively seeking a specific annual harvest that fulfills the target steady state population see appendix d data on adult sex ratio calf sex ratio and other mortality is used for parameterisation and held as constants throughout this step net recruitment rate is calculated when the population reach a steady state the goal seeking algorithm adjusts the steady state population size and reproduction coefficient a in eq 4 iteratively to find a predetermined value of harvest and net recruitment rate estimating abundance in step one ends when harvest and recruitment rate is equal to values specified a priori i e actual data derived from harvest statistics and hunter observations for example in uppsala county the harvest and recruitment rate were reported to be 0 21 moose per km2 and 0 72 calves per adult female in 2012 respectively as shown in fig 5 the algorithm starts with finding a population density at a steady state that meets the reported harvest of 0 21 moose per km2 when this is found the model continues to adjust the recruitment rate coefficient until the reported value of recruitment rate 0 72 is found also at a steady state however as soon as recruitment rate is altered it will affect the annual harvest needed to maintain the target population the model therefore seeks a new value of the population density that corresponds to the reported harvest when both annual harvest and recruitment rate equal the reported values the algorithm ends and the values of the population size and recruitment rate coefficient are used in step two 2 4 estimating population size step two the purpose of step one is to achieve an estimate of population size and demographic structure only to be used as start values in the second step where a fitting algorithm is performed with support of a time series of actual harvest statistics an aggregated time series between 2012 and 2020 for the variables specified in table 1 was used to parameterise the model for the twenty counties four regions and at national level for each area the simulated density and recruitment rate was validated by optimizing the fit of population index i e moose observations per hour post summer recruitment rate and adult sex ratio also included within the time series the trend of simulated density and recruitment rate will be matched with actual data by iteratively modifying parameters setting initial density and recruitment rate prior to applying harvest and mortality data between 2012 and 2020 fig 6 the fit of each factor j population development recruitment rate and sex ratio were evaluated with eq 6 6 r j 2 m i n 1 x i y i 2 x i x 2 2 where xi is the simulated value in year i yi the observed in year i the three r2 values were individually weighted before being integrated into an overall model fit i e density weight 6 and recruitment weight 4 were prioritised over sex ratio weight 1 solberg and sæther 1999 concluded that there was an 85 chance that a positive or negative change in population density was followed by an equal change in density index we therefore attributed this factor to the highest weight differences in recruitment rate have higher relative impact on population dynamics than the sex ratio which motivates a higher weight attributed to this factor compared to the adult sex ratio as each factor may vary independently during the fitting process an integrated r2 value was applied to optimize the overall fit of the three factors the algorithm ends when the integrated r2 fit does not improve within thirty iterations it is worth noting that the simulated trend of adult sex ratio is not influenced by any parameter but rather is the consequence of sex specific adult harvesting during the simulation period prior to calculating the fit the observed density index d was transformed to the same scale as simulated pre hunt density d eq 7 7 y i d i d i d i where yi is the transformed value of observed density index in year i this transformation will produce an identical mean for y and d 2 5 mortality scenarios to account for uncertainty in other mortality we ran simulations with three different levels of other mortality table 2 we used a lower mortality rate for calves in areas where carnivores are present to account for compensatory mortality 2 6 validation and sensitivity analysis the model was validated with independent population census in jönköping county estimated by group pellet count see appendix b prior to running the model with data for all counties regions and at the national level a sensitivity analysis of citizen data was performed at national level on recruitment rate adult sex ratio obtained from hunter observations and calf sex ratio obtained from harvest statistics population estimates were obtained after parameter values were decreased or increased separately by 10 prior to each run the average parameter data between 2012 and 2020 on the national scale for recruitment rate calf per cow was 0 62 adult sex ratio 1 1 in sweden the proportion of bulls in the adult population is used rather than the male female ratio r to convert to proportion p use p r 1 r m f 0 57 and calf sex ratio m f 1 06 for comparison the national targets for recruitment rate and adult sex ratio are set at 0 6 and 0 54 respectively naturvårdsverket 2018 3 results mean hunter observation aggregated for all sweden decreased from 0 053 observations per hour hunting effort in 2012 to 0 046 in 2020 this corresponds to a 13 overall decrease or a 1 8 annual decrease the simulated post hunt moose population in sweden decreased from 270 000 to 228 000 individuals between 2012 and 2020 which corresponds to a 15 decrease or a 2 annual decrease the 2020 pre hunt density was estimated to 0 83 per km2 which is a 14 drop from 0 97 per km2 in 2012 registered hunting area was in 2020 approximately 375 000 km2 the post hunt population density decreased from 0 72 per km2 in 2012 to 0 61 per km2 in 2020 the simulation model was able to iteratively converge to a good fit between pre hunt density r2 0 973 recruitment rate r2 0 989 adult sex ratio r2 0 996 and their counterparts as derived from the hunter observations fig 7 running the model with high and low levels of other mortality resulted in a deviation of about 4 of the final population estimate as compared to the base scenario see table 2 the sensitivity analysis showed that simulated population size was about twice as sensitive to deviations in recruitment rate as compared to the adult sex ratio calf sex ratio obtained from harvest statistics showed the lowest sensitivity of the tested parameters fig 8 in accordance with the population trend at the national level the simulated population development for the four sub regions also showed a decreasing trend the result obtained when simulated at a regional level was consistent with simulations at county level and later summed to the regional level fig 9 the estimated population in 2020 for each sub region simulated with different values of mortality other than related to hunting carnivores and traffic is presented in table 3 in appendix c simulation estimates for the twenty counties are listed 4 discussion in this study we demonstrate how to estimate the population size of moose at various geographical scales by combining citizen science data in terms of hunter observations with other sources of data in a mechanistic population model the model converged to a good fit in all variables used for parameterisation and validation i e moose density index recruitment rate and adult sex ratio according to model estimates the moose population in sweden was 311 000 4 individuals pre hunt and 228 000 4 post hunt in 2020 and that the population has decreased with 15 or 2 per annum since 2012 the total number of harvested individuals in 2020 was 82 827 which means that 27 of the summer population was harvested the population estimate is in line with earlier estimates jensen et al 2020 each of the four regions showed a decrease but with different magnitudes 21 16 7 and 20 for northernmost northern central and southern sweden respectively the objective in most mma during this period has been to lower the moose population to alleviate browsing damage on young scots pines pinus sylvestris consequences of browsing damage on pine are related to high economic losses for the forest industry bergquist et al 2018 a recent report concluded that the moose population decreased by 10 between 2014 and 2020 widemo et al 2022 the sensitivity analysis revealed that the model estimate was most sensitive for variation in recruitment rate calves per female followed by adult sex ratio and calf sex ratio inaccurate parameter data will therefore influence the population estimate but to various degrees for example if recruitment rate is underestimated the abundance will be overestimated and vice versa reproduction in moose have shown considerable variation among local populations and over time due to density dependent processes or climatic variation within scandinavia sand and cederlund 1996 sand et al 1997 solberg et al 2006 grøtan et al 2009 significant variation in moose population productivity has also been documented in north america ferguson 2002 likewise if the proportion of males is overestimated the simulated population size will also be overestimated the observational data on the sex ratio may be biased due to behavioural differences between adult males and females this can be particularly apparent in relation to when the first hunting week occurs in relation to the rut during which males are known to be more active than females cederlund and sand 1994 solberg et al 2010 found a consistent over estimation of the proportion of males in the hunter observations however based on the consistency between the simulated and observed sex ratio we did not find any indication of a systematic or consistent bias in the adult sex ratio the population estimate was least sensitive to calf sex ratio the low sensitivity in this variable indicates that it is possible to use a constant if annual estimation of calf sex ratio is missing based on harvest statistics at a national level the average sex ratio for calves m f was 1 06 between 2012 and 2020 i e 51 5 male calves we used hunter observations to both parameterise and validate the model validation with independent data at a national or regional scale is not possible as other sources of population estimates are unavailable the aim of our population model was to simulate net recruitment and mortality with relevant mechanistic causal relationships and with available parameter data to come as close as possible to the true net population growth validating not only with density index moose observations per hour hunting effort but also recruitment rate and adult sex ratio narrows down the plausible outcomes of the model as these will affect both growth and abundance prior to running the model on a national and regional scale we validated the model with data from jönköping county where high consistency in both estimated population size and trends were obtained appendix b in addition to being non randomly sampled in space and time the use of hunter observations in local management is limited by the uncertainty derived from low hunting effort the total number hours of observation while moose hunting areas a subdivision of mmas usually are the smallest operational unit where harvest quotas are set the recommended number of observational hours per year 5000 is often not achieved to produce reliable trends ericsson and kindberg 2011 therefore there is a limitation to when and where the model described here is applicable already at the mma level there are areas where observation data fluctuates more between years than what should be expected from actual changes in moose abundance this will introduce additional uncertainty into the model results according to findings during our analysis we suggest that hunter observations should be weighted with area and harvest statistics when aggregated to a higher level i e from mma to county and so forth when observations were weighted before being aggregated to a higher level the simulated results of the total moose population were essentially the same when summed to the national level from either county or regional level the theoretical argument for weighting hunter observations is that the number of moose observations is determined by the number of moose and the number of hunters contributing to the statistics area although correlated does not in itself contribute to moose observations and therefore needs to be accounted for when aggregating two areas of different size furthermore a productive area in terms of annual average moose harvest should have a higher influence on moose density index number of moose observed per hour when aggregated with a less productive area of equal size the reason being that the former is likely to have a denser moose population than the latter in our study a constant was used to set the number of moose killed by large carnivores during the simulations however wolf and bear impact on the local moose population in scandinavia may range from low to high depending on their density and the presence of alternative prey species wikenros et al 2015 2020 tallian et al 2021 indeed wolves and brown bears have shown to have a major limiting effect on moose populations in north america sometimes preventing further growth in the moose population boertje et al 2009 2010 in areas in scandinavia where the presence of other deer species is substantial the number of killed moose per wolf territory is likely to be reduced due to the observed ability for wolves to switch prey from moose to smaller deer where they are sufficiently abundant sand et al 2016 at present wolves are mainly concentrated in moose dominated areas but as the wolf population expands to the south other deer species become more abundant therefore we would need to include more detailed data on the rate and composition of prey species killed by wolves in this part of the country rodríguez recio et al 2022 as the estimate of population size is derived while applying actual harvest statistics our model may also be used in moose management to set harvest quotas to achieve a specified population density and sex composition an important objective in swedish moose management is to balance moose density with forest damage one way to alleviate browsing damage is by reducing the moose population regardless of its actual size it is in this perspective more relevant to manage the population trend than absolute numbers a specific feature of our model is that the simulated population trend is robust to changes in parameter assumptions such as for mortality that is although running the model with a different mortality the fitting algorithm will result in the same population trend not size this may be counterintuitive at first as the same harvest is applied during simulation however it is explained by the fact that both population density and recruitment rate are adjusted during the fitting algorithm and therefore able to adapt to various levels of mortality from a management perspective this is of benefit when analysing the effect of different harvest quotas on population development population trajectories based on hunter observations have uncertainties analysis of long term ecological studies have shown that trends that are identified in a short period broken window can be misleading bahlai et al 2021 the optimal time span to be used with hunter observational data to detect a consistent trend has not been tested it will to some extent be dependent on the number of observational hours used to obtain the data in our analysis we aggregated data to county level as the smallest unit the average number of observational hours spent annually between 2012 and 2020 at county level was 240 000 which is far above the recommendation of at least 5000 h on this level we propose that simulations should be done with a minimum of four years of data however to avoid too much influence from systematic bias and annual stochasticity e g erroneous data influence of weather immigration and emigration there is also an optimal upper limit for using trend data in our simulation model we propose that the best interval for trend data in our simulation model is between 5 and 8 years this would also be applicable to mmas a fundamental goal in population ecology is to understand how populations are regulated newton 1998 development of methods to improve the precision of population estimates has become increasingly important in wildlife management in collaborative governance regimes and multi objective land use dressel et al 2020 sepa 2018 citizen science data can contribute with cost effective data for use in operative management szabo et al 2013 previously citizen data has been used in non mechanistic integrated population models to estimate population development rönnegård et al 2008 using a mechanistic and dynamic systems approach where causal relationships are explicitly simulated has the benefit of being more straight forward as compared to the complexity of incorporating feedback mechanisms in matrix algebra davis and kessler 2016 in addition as several demographic entities are integrated into our model demographic structure average age adult sex ratio recruitment rate it allows for the possibility to explore various demographic processes within a population schaub and abadi 2011 a possible further development of the model is to integrate landscape features for exploring forest damage carrying capacity dynamics and alternative causes of actions in moose management apart from fostering understanding of such processes such a model has the potential to be a valuable tool in operative management to map population trends analyze harvest strategies and to set new management goals 5 conclusion citizen data has the potential to support management and conservation by covering vast spatial and temporal scales not economically feasible to cover by other means in our study we show one way of integrating citizen data in terms of hunter observation into a population model to estimate moose abundance at various scales as the simulation was performed by applying actual harvest statistics the model can also be used to forecast population development at a given sex and age differentiated harvest and recruitment rate funding this work was partially funded by a grant from the european union for rural development specifically målstyrd förvaltning av klövvilt grant number 28 422 credit authorship contribution statement christer kalén conceptualization methodology software validation formal analysis investigation resources data curation writing original draft writing review editing henrik andrén methodology formal analysis supervision writing review editing johan månsson methodology writing review editing håkan sand methodology resources supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper the authors declare the following financial interests personal relationships which may be considered as potential competing interests appendix a estimated population development of bears and wolf territories table a 1 and table a 2 appendix b model validation via pellet count the pellet group count method is an established method to estimate moose density and is commonly used in within the fennoscandian moose management neff 1968 wennberg digasper 2006 rönnegård et al 2008 in jönköping county a pellet group count is voluntarily carried out by hunters on an annual basis the county administration receives the data and produces an annual report the sampling method is based on permanent 1 1 km squares systematically distributed over the area i e a moose management unit or a moose license area each square has 20 five along each side permanent circular sample plots of 100 m2 in 2020 data on 75 565 plots were sampled within the county to register a single pellet group count a minimum of 20 pellets should be identified the density d measured as moose individuals per km2 is calculated with eq b 1 b 1 d 10000 p d p f where p is the total number of moose pellet groups found d is days since the plot was cleared from pellets in the autumn p is the total number of plots and f is a constant representing the number of droppings per moose and day the constant f defecation rate has a large influence on the final density and studies have found it to vary between 14 and 23 5 härkönen and heikkilä 1999 matala and uotila 2013 in jönköping s county two alternative values of defecation rate are officially used to estimate the density of moose 17 and 19 in diagram b 1 results from the moose pellet count is given with these two values of the constant together with result from estimating the density through the model described in the paper the simulated moose density corresponds well with the moose pellet group count census fig b 1 the simulated post hunt population was closer to the trend derived from pellet count however the negative slope of pre hunt simulation is more aligned to the slope of the trend of pellet counts one explanation for this is that the pellet count is not solely an estimate of post hunt density instead the trend derived from moose pellets may be a mixture between pre and post hunt density neff d j 1968 the pellet group count technique for big game trend census and distribution a review journal of wildlife management 32 3 pp 597 614 doi 10 2307 3 798 941 härkönen s heikkilä r 1999 use of pellet group counts in determining density and habitat use of moose alces alces in finland wildlife biology 5 4 233 239 doi 10 2981 wlb 1999 028 matala j uotila a 2013 diurnal defecation rate of moose in southwest finland alces a journal devoted to the biology and management of moose 49 155 161 rönnegård l sand h andrén h månsson j pehrson å 2008 evaluation of four methods used to estimate population density of moose alces alces wildl biol 14 358 371 wennberg digasper s 2006 already adaptive an investigation of the performance of swedish moose management organizations licentiate thesis luleå university of technology luleå sweden 133 pp appendix c result of model estimate of population development between 2012 and 2020 within 20 counties table c 1 and table c 2 appendix d description of population routine to estimate initial population during the model s initialization an estimated total population is calculated that meets the required parameters for adult sex ratio calf birth sex ratio net recruitment rate and male proportion in the harvest the population model used in step 2 is fairly similar to this one see article section 2 4 the primary distinction is that in the latter model the harvest of bulls females and calves is used rather than the population being a function of harvest hunting hunting is applied iteratively within a goal seeking algorithm that aims to meet a specified population density at steady state in other words a hunting pressure see chapter 4 change annually until the wanted steady state population is met the model runs 2000 annual cycles to ensure that a steady state density is reached the model is initialised with an arbitrary population in addition to setting wanted density the algorithm also adjusts adult sex ratio to a desired ratio the demographic structure of the population is determined by the adult sex ratio and a certain proportion of calves in the harvest hunting of adult females the hunted h females f in age class i is calculated using an expression where a coefficient h is allowed to vary iteratively between each annual cycle to find a stable population equilibrium that meets the wanted density 1 h f i h 1 γ a f i s f i where f is age specific fecundity and a is the parameter used in eq 4 original paper and γ 0 5 is a constant that scales the fecundity dependent hunting pressure in this way hunting is allocated more to females with a lower fecundity rate the theory behind this is that females that are followed by one or more calves have a lesser risk of being shot younger and older females thereby have a higher risk of being harvested setting of h is described further in section 4 this appendix the post hunt female winter population w is calculated by subtracting the harvested females from the pre hunt summer population 2 w f s f i h f i the pre hunt male population sm is calculated by subtracting the adult females from the total pre hunt population 3 s m s t s f the total post hunt adult population wt is estimated by using the wanted proportion of adult males p 4 w t w f 1 p the post hunt adult male population wm is then estimated by subtracting the adult females from the total adult population note that this is an estimated recursive value that later is corrected 5 w m w t w f male hunting hunting of males is calculated by summing the proportion of each age class multiplied by the difference between pre hunt male population and the estimated post hunt male population 6 h m i s m i s m w m s m the post hunt adult population is then calculated by subtracting the hunted individuals from the pre hunt population this is the corrected value of post hunt winter population of males 7 w m i s m i h m i births the number of born calves b is a calculated from age specific i fecundity f eq 4 in the main article and number of females w f in each cohort in winter 8 b f i w f a sex ratio divides the total number of births into females and males mortality mortality is calculated twice a year first in spring after the winter period winter mortality second before hunting period starts in the autumn summer mortality the number of dead adults in the model adult mortality is set for each sex however the mortality function is not only specific for each sex but also for each age class to implement the sex specific net mortality a correction factor needs to be calculated before applying sex and age specific adult mortality this is performed by the following two equations first mortality σ is calculated with age specific mortality m derived from a mortality function eq 5 in the main article 9 σ s m s i s s i 3 a correction factor k is then calculated for each sex s 10 k s m s s s i 3 σ s where m is the given total mortality rate for sex s is summer population and i is age class it is assumed that all adults have the same risk of being killed by carnivores or traffic incidents a ratio r is calculated to separate carnivore and traffic related mortality into the two sexes 11 r s s s i s i the total number of dead adults d in summer for a specific sex and age class can now be calculated 12 d s i k s m s i s s i 3 0 1 r s m w s s i 3 s s i r s m t s s i 3 s s i where m is the number of individuals killed by wolves w and traffic t note that bears b are assumed to only kill calves it is further assumed that 10 of the total wolf kills is on adults during summer and the rest is attributed to calves further the equation described here constitute mortality for four summer months i e 1 3 of the total annual mortality in winter it is assumed that 20 of wolf kills is attributed to adults calf mortality the number of dead calves d0 age class 0 in summer for each sex is calculated in a simpler fashion 13 d s 0 r s m s 0 b s 0 0 9 r s m w 3 r s m b 3 r s m t 3 where r is the proportion of the specific sex at birth e g female calves calves m is the summer calf mortality rate for sex s b is the number of births calculation of calf winter mortality is similar except for that 80 of the wolf kills is attributed to calves no calves is killed by bears b during winter and that winter mortality is 2 3 of the total annual mortality the mortality rate m related to other mortality can be set specifically for summer and winter to allow for difference in calf mortality during these two seasons automatic hunting device algorithm the automatic hunting device is an algorithm that seeks a target steady state population by iteratively applying a certain hunting pressure the fecundity constant a in eq 4 main article is held constant during this process during step 1 chapter 2 3 an overarching algorithm sets the value of a and the initial population by iteratively seeking a specific net recruitment rate and harvest rate the algorithm finds a level of a and initial population where harvest and recruitment rate calves per female after summer mortality corresponds to the actual data for that particular hunting area in this section the algorithm that finds a specific harvest that will keep the population at a specified wanted density is described algorithm 1 parameters are set a wanted density b wanted pre hunt proportion of bulls in the adult population c proportion of calves in total harvest d calf sex ratio e mortality not related to hunting 2 run the population iteratively for a number of times 2000 where hunting pressure is applied to the annual harvest the algorithm seeks the hunting pressure that results in the wanted steady state density to speed up this process the use of numerically solving differential equations is used 3 the algorithm ends when a steady state of wanted density is met numerically solving of differential equations determining hunting pressure is performed in each iteration by the use of two variables that are updated within this procedure the first variable p follows the population density the second variable is used to set the hunting pressure h heun s algorithm is used to numerically solve a first order differential equation heun s method is a little bit more advanced than the more common euler s method both of these methods use the idea of local linearity or linear approximation the difference between euler s method and heun s method is that the latter use a predictor and then a corrector to calculate the slope the slope is then the average of the predictor and the correction the method is in other word recursive and a bit more efficient that euler s method variable p a population density variable p is that follow the simulated population is used the slope of population density is a function of present density d derived from the population model and current value of p 14 d p d t d p variable p is then updated using the heun s algorithm not described here and timestep s 0 25 15 p t 1 p t d p d t s variable h the current population trend t is first calculated if the simulated population is below p the trend is negative 16 t d p p the deviance h from wanted density w is calculated where k1 is a constant setting sensitivity 0 01 17 h min 0 2 k 1 p w 3 finally the slope for the hunting pressure h is calculated by adding t and h 18 d h d t h t variable h is updated in the same way as for variable p 19 h t 1 h t d h d t s variable h is then used in eq 1 this appendix to set the annual hunting pressure on females appendix e parameters table e 1 broman e wallin k steén m cederlund g 2002 mass deaths of moose alces alces in southern sweden population level characterization wildl biol 8 219 228 ericsson g wallin k 2001 age specific moose alces alces mortality in a predator free environment evidence for senescence in females ecoscience 8 2 157 163 doi 10 1080 11 956 860 2001 11682641 ericsson g wallin k ball j p broberg m 2001 age related reproductive effort and senescence in free ranging moose alces alces ecology 82 1613 1620 gundersen h 2003 vehicle collisions and wolf predation challenges in the management of a migrating moose population in southeast norway dr scient thesis university of oslo lorentsen ø wiseth b einvik k pedersen p h 1991 elg i nord trøndelag resultater fra sand h wabakken p zimmermann b johansson o pedersen h liberg o 2008 summer kill rates and predation pattern in a wolf moose system can we rely on winter estimates oecologia 156 53 64 doi 10 1007 s00442 008 0969 2 saether b e andersen r hjeljord o heim m 1996 ecological correlates of regional variation in life history of the moose alces reply ecology 77 1493 doi 10 2307 2 265 546 sand h zimmermann b wabakken p andrén h pedersen h 2005 using gps technology and gis cluster analyses to estimate kill rates in wolf ungulate ecosystems wildlife society bulletin 33 914 925 doi 10 2307 3 785 028 solberg e j heim m arnemo j os ø 2003 does rectal palpation of pregnant moose cows affect pre and neonatal mortality of their calves alces 39 65 67 stubsjøen t saether b e solberg e j heim m rolandsen c 2000 moose alces alces survival in three populations in northern norway canadian journal of zoology 78 1822 1830 doi 10 1139 z00 132 swenson j e dahle b busk h opseth o johansen t söderberg a wallin k cederlund g 2007 predation on moose calves by european brown bears journal of wildlife management 71 1993 1997 rauset g r kindberg j swenson j 2012 modeling female brown bear kill rates on moose calves using global positioning satellite data the journal of wildlife management 76 1597 1606 doi 10 1002 jwmg 452 rönnegård l sand h andrén h månsson j pehrson å 2008 evaluation of four methods used to estimate population density of moose alces alces wildl biol 14 358 371 zimmermann b sand h wabakken p wikenros c eriksen a strømseth t holen f maartmann e ahlqvist p arnemo j milleret c liberg o pedersen h 2014 ulven som rovdyr på klauvvilt i skandinavia in ikkje berre ulv og bly glimt frå forskinga på evenstad publisher opplandske bokforlag editors torstein storaas kjell langda elgundersøkelsene 1987 1990 om vandringsmønster brunst kalvinger og dødelighet fylkesmannen i nord trøndelag report 1 in norwegian 
24403,validation of agent based models is underappreciated in scientific studies even though this process is an important part of ensuring that a model is a reliable research tool here we propose modifications to a model validation framework and illustrate this framework with a case study of territorial behavior in species that defend territories larger territories provide obvious benefits such as increased access to food shelter and mates an additional potential benefit is that larger territories could provide protection from intergroup conflict considerations from geometry indicate that per capita risk of death from intergroup violence should decrease with increasing territory size insofar as conflict occurs mainly at the periphery we tested this inference using computer simulations and data from chimpanzees pan troglodytes and gray wolves canis lupus we designed an agent based model that allows territories to vary freely in size and shape we present a framework for model validation and apply it to our agent based model to substantiate its accuracy simulations from the validated model confirmed the predictions from geometry under a broad range of parameter values per capita mortality rate decreased in larger territories similarly using published data on rates of death from intercommunity aggression in 16 chimpanzee communities as well as new data from 38 wolf packs we found that per capita mortality rate correlated negatively with a measure of territory size these findings indicate that in species with lethal intergroup aggression one simple aspect of territory geometry size has strong effects on mortality several lines of evidence indicate that the per capita rates of mortality from warfare have decreased in many human societies over time one factor contributing to this decrease may be the increasing geographic extent of political entities keywords intergroup aggression agent based modeling territoriality mortality rate model validation data availability we have included all data used in the supplementary materials 1 introduction scientists seek understanding in part by developing and testing models to explain phenomena of interest as computers have become more powerful agent based computer models have become increasingly common grimm et al 2017 macal 2016 however as such models have become increasingly more complex in efforts to better predict and explain the natural world ensuring the validity of these models presents a major epistemological challenge augusiak et al 2014 david 2013 gräbner 2018 as a result of these challenges there remains a lack of standardization in the theoretical framework of model validation david 2013 gräbner 2018 gräbner 2018 argues that the diversity of approaches highlights a fundamental epistemological problem there is no easy or straightforward way to ensure that a model accurately matches reality george box s aphorism that all models are wrong but some are useful box 1976 reminds us that the goal is not to construct a perfect model but to make a model that is sufficiently similar to reality that it can be used to understand better the system that it represents to accomplish this aim model validation involves imposing a series of tests on the model in a parallel way to hypothesis testing procedures given a reasonably comprehensive suite of tests and the model passes all tests then the model is considered sufficiently validated the failure of any test calls the model s validity into question researchers have recently sought to make agent based models more transparent in their design and more trustworthy in the outputs they produce augusiak et al 2014 gräbner 2018 grimm and railsback 2005 this effort has resulted in new guidelines for ensuring that agent based models are both well documented grimm et al 2020 2014 and sufficiently validated augusiak et al 2014 gräbner 2018 a challenge remains that it can be unclear when or how to apply validation methods here we hope to contribute towards this effort by proposing modifications to a previous model validation framework augusiak et al 2014 and illustrate this modified framework with a case study to provide an example of this validation framework we focus on a hypothesis that is straightforward but which to our knowledge has not been tested previously specifically we investigated whether lethally aggressive and territorial species incur higher per capita mortality in smaller territories than in larger territories intergroup aggression plays a major role in the social behavior of many species huntingford 2013 in humans intergroup competition includes warfare which has profoundly influenced the evolution of cultural institutions turchin and gavrilets 2009 in species that defend territories larger territories can provide well recognized benefits such as increased access to food shelter and mates brown 1964 heg et al 2005 mosser and packer 2009 pusey et al 2005 williams et al 2004 wilson 2012 in species with lethal intergroup aggression such as humans homo sapiens allen and jones 2014 glowacki et al 2020 chimpanzees pan troglodytes watts et al 2006 wrangham 1999 wolves canis lupus mech and boitani 2010 ants e g azteca trigona adams 1990 iridomyrmex purpureus lieshout et al 2005 and others western gulls larus occidentalis ewald et al 1980 lions panthera leo mosser and packer 2009 spotted hyenas crocuta crocuta kruuk 1972 larger territories should provide an additional but under appreciated benefit reduced risk of mortality from intergroup aggression if we assume that territorial individuals generally stay within their territory then encounters with hostile individuals should occur mainly along the borders between neighboring territories in species with lethal intergroup aggression the rate of intergroup killing should depend on the rate at which intergroup encounters occur this encounter rate in turn partly depends on the size of the territory in a territory that is small relative to the daily travel distance for that species a random walk will frequently bring residents to territorial boundaries waser 1976 mitani and rodman 1979 if the territory is large however residents will encounter territorial boundaries less often deviations may occur from these basic assumptions wolves and chimpanzees sometimes make deep incursions into neighboring territories for example increasing the likelihood of intergroup encounters mech 1994 watts and mitani 2001 wrangham 1999 nevertheless if intergroup encounters occur mainly along the perimeter of territories individuals should encounter neighbors more often in smaller territories thus in species with intergroup killing individuals in smaller territories should experience a higher risk of being killed by their neighbors than individuals in larger territories additionally a corollary is that increased territory size should increase per capita fertility lower mortality rate from intergroup killing should result in greater longevity and thus greater total fertility for females insofar as increased fertility increases the number of individuals available to defend the group s territory this may result in positive feedback between territory size and fertility however these fertility benefits would likely vary among species depending on factors such as resource distribution reproductive strategies and dispersal patterns among others 1 1 case study in this study we investigated the relationship between territory size and both mortality risk and fertility benefit using an agent based model called lethalgeometry with individual agents programmed to mimic the behavior of territorial entities because they can include spatially explicit relationships among individuals agent based models have proven useful for investigations of territoriality mosser and packer 2009 tanemura and hasegawa 1980 including some netlogo models carter et al 2015 lemanski et al 2021 sells et al 2022 in our model the expected relationship between territory size and mortality risk is straightforward which enabled us to focus more thoroughly on model validation an underappreciated component of model development for many agent based and other computer based models augusiak et al 2014 as such we also documented our investigation of lethalgeometry to provide an example of our model validation framework which focuses on assumptions made and therefore potential errors introduced during the model development process we used three different approaches to examine the effects of geometry on per capita rates of intergroup mortality first we proposed an analytical model derived from geometry this model provides a conceptual framework using a mathematical perspective for the relationship between territory size and rates of mortality from intergroup aggression second we developed an agent based model from this conceptual model and examined findings from the simulation output third we tested predictions of lethalgeometry using data on lethal aggression in chimpanzees from long term study sites across africa wilson et al 2014 and data collected on gray wolves in yellowstone national park cassidy et al 2015 we did not examine the effect of territory size on killing rate for these populations until after constructing lethalgeometry these analyses therefore provide a strong source for validation 1 2 agent based modeling agent based models are used to represent living organisms and are built with behavioral code at the individual agent level to simulate interactions among a system of autonomous agents huston et al 1988 grimm 1999 macal 2016 the decision making algorithms of agents are designed to correspond directly with the inferred behavioral rules of their real world living counterparts the agent based model development process is often referred to as the modeling cycle which includes many variants augusiak et al 2014 david 2013 grimm and railsback 2005 landry et al 1983 and describes the procedure for synthesizing information from a real world system or target system to develop computer models used to gain understanding of that target system fig 1 depicts a version of the modeling cycle the process by which an agent based model is built from and designed to match a given target system the modeling cycle includes an iterative progression through the elements of this building process starting from the target system then proceeding to the conceptual model agent based model and simulation output the target system is a conception of a real world system that is made direct through concrete observations that are recorded as empirical data a conceptual model is developed by synthesizing these empirical data into a set of simplifying assumptions about the target system an agent based model uses algorithms and computer code to make explicit elements of the conceptual model finally the agent based model produces simulation output which can be compared to the target system both to reaffirm the model construction and to increase knowledge of the target system the modeling cycle repeats if the output and target system do not adequately match and revision of the model is required otherwise the simulation output can be synthesized into results that report something meaningful about the target system 1 3 model validation model validation is a crucial component of the model development process because it is a way to determine how accurate a model is model accuracy is generally understood to mean how well a model matches its target system the real system under study that the model is designed to represent doran and gilbert 1994 zeigler et al 2018 model validation consists of a series of correctness checks performed during model development augusiak et al 2014 david 2013 edmonds and meyer 2013 grimm et al 2014 grimm and railsback 2012 2005 just as quality assurance is used to test manufactured items these validation checks help determine the quality of the model and how well it produces predictable target system behavior augusiak et al 2014 in scientific research this process adds credibility to the model output and thus to the results of the hypothesis testing process despite the need for validated models the practice of model validation remains under represented within the scientific literature in studies of behavior and ecology augusiak et al 2014 grimm et al 2014 grimm and railsback 2005 therefore we highlight the importance of model validation to promote further attention to this important aspect of using computer simulation models in scientific research a computer model that produces dependable output is considered validated but determining this is not a straightforward matter since a model represents a set of hypotheses about a target system it can never be proven correct only falsified augusiak et al 2014 thus following box 1979 even the most exhaustive systematic and precise validation methods can never guarantee that a model is working without error david 2013 furthermore while the simulation output may appear to match the target system the internal mechanisms of the model may not appropriately correspond to those of the real world additionally to avoid confirmation bias model validation requires deciding a priori how a validated model should match its target system which suggests that the target system is already well understood to perform these comparative tests david 2013 however a model is created to gain insight into its target system which suggests that knowledge of the target system is incomplete ultimately while no target system is fully understood nor is any validation test absolute one nonetheless can be reasonably assured that a model is working as expected if 1 its mechanisms have been thoroughly scrutinized and 2 it consistently produces outputs that are quantitatively and qualitatively similar to empirical data collected from the target system bianchi et al 2007 kohler et al 2005 kohler and gumerman 2000 researchers can then apply validated models to test hypotheses about the target system david 2013 agent based models face additional challenges during the validation process because they simulate the complexity that emerges from small scale interactions between and within agents macal 2016 which often transcend the kinds of systems that can be understood through direct analytical methods such as finding the numerical solution to a set of differential equations thus there is no universally applied validation technique for agent based models that can be used to calculate a relative measurement of model accuracy as exists in other fields augusiak et al 2014 furthermore agent based models are built from the perspective of their agents and different choices in code design can manifest as larger changes in the emergent properties since models often deal with complex interactions if an emergent pattern flags an error in the model it can be difficult to determine the location in the code that is producing this error as models increase in complexity they become increasingly vulnerable to amplifying the error produced by these incorrect base assumptions gilbert and troitzsch 1999 to overcome these limitations modelers have proposed various frameworks for validation of agent based models grabner 2018 augusiak et al 2014 augusiak et al 2014 presented an evaludation framework that highlights the crucial role that validation should have during the model development process and assigned elements of model validation to locations on the modeling cycle grabner 2018 focused on an epistemological framework that involved a series of comparisons between modeled components and real world components and described how these elements are also comparable to the evaludation framework presented by augusiak et al 2014 when we first developed lethalgeometry we turned to these frameworks to guide us in the model validation process however we found incongruencies between some of the validation steps and where they are placed in the modeling cycle in particular these frameworks do not outline an explicit correspondence between validation step and area of the modeling cycle which makes it difficult to address which validation steps should be applied at which stages of model development these frameworks include validation steps that appear in multiple places or not anywhere on the modeling cycle in addition these validation frameworks can conflate references to the target system with those of the conceptual model in our view these are two distinct areas of the modeling cycle and are represented by distinct types of information the target system is represented by empirical data collected directly from the target system whereas the conceptual model is represented by qualitative inferences about the target system while this distinction may be subtle the type of information can profoundly impact which validation methods should be applied under this consideration the model output verification stage of the evaludation framework includes methods that are related to both the target system calibration and the conceptual model predicted vs observed even though only the latter is specified by the placement of this evaludation stage in the modeling cycle for these reasons it can be difficult to completely follow these frameworks and instead we have applied a modified validation procedure we sought to ensure a one to one correspondence between each validation check and area of the modeling cycle which permits an exhaustive consideration and scrutinizing of all aspects of the development process furthermore we reframed the process to explore the assumptions made in each stage of model development by focusing on one part of the modeling cycle and by specifying a question to answer for every validation step we were able to operationalize the validation process for lethalgeometry in a relatively straightforward and complete manner described in detail below 1 4 validation framework we present a general framework for model validation which builds on recent work appleget et al 2014 augusiak et al 2014 cooley and solano 2011 david 2013 gräbner 2018 to structure elements of the validation process with respect to elements of the model development process fig 1 this framework can be applied to all computer models e g agent based equation based that follow the modeling cycle during development the end goal of the modeling cycle process is to produce simulation results that are an accurate depiction of the original target system such that these data can be used for hypothesis testing therefore the construction of each element of the modeling cycle should seek to minimize the translation error from the previous element however the transition between each modeling cycle element likely results in decisions that introduce error our model validation framework involves performing a series of comparisons between each element of the modeling cycle process for a total of six comparisons with the aim of seeking out and reducing incongruencies between them the term consilience is used in science to denote when independent data converge on conclusions that are in agreement with each other wilson 1999 thus we use the term consilience check to refer to comparisons between two modeling cycle elements to verify that one representation is reasonably equivalent to another since these elements encompass all stages of the modeling cycle which presumably defines the boundaries of model building applying each of these checks represents a reasonably exhaustive approach fig 1 depicts these consilience checks as lines connecting each modeling cycle element to each other with some common validation methods that relate to each comparison while each of these comparisons strives to show that each element of the modeling cycle adequately represents one another defining adequacy presents an epistemological problem david 2013 this problem is unavoidable but can be minimized by applying one or multiple comparisons between each element each one adding another layer of validation to the model in question we summarize the six consilience checks below 1 compare the target system to the conceptual model and answer the question how does knowledge of the target system influence conceptual model design this includes a verbal or graphical model of the target system augusiak et al 2014 which ultimately influences the choices made in computer model design in many cases the conceptual model is cultivated through years of previous research on the target system and so a thorough discussion of this knowledge base should adequately fulfill this comparison 2 compare the target system to the computer model and answer the question how does knowledge of the target system influence the computer model implementation this step involves evaluating the empirical data from the target system both quantitative and qualitative and how this information impacts computer model design and parameter settings augusiak et al 2014 gräbner 2018 this information defines virtual equivalents from the target system such as the timestep and cell sizes attributes like body size or abilities like reproductive rate the odd overview design concepts and description protocol grimm et al 2020 2010 2006 is gaining traction as a template to communicate all of the salient details of an agent based model in a reproducible and transparent way and may be sufficient for covering these first two comparisons 3 compare the conceptual model to the computer model and answer the question how well does the computer model implementation match the conceptual model design this validation step is often referred to as verification augusiak et al 2014 bryson et al 2007 gräbner 2018 and involves checking the model code for programming errors this step focuses on the nuts and bolts of the model and whether the code matches the design plan made in the conceptual model typical verification techniques include visualization of the interface line by line code reviews static checks of the code subroutines in isolation and dynamic checks of the emergent properties while the simulation is running among others david 2013 edmonds and meyer 2013 grimm and railsback 2005 4 compare the conceptual model to the simulation output and answer the question how well does the conceptual model design predict model outputs this step involves making predictions from the conceptual model that are reproduced in the simulation output for example does changing a parameter setting alter the simulation behavior as anticipated by the conceptual model for this validation step modelers should confirm that these emergent patterns are produced as expected 5 compare the computer model to the simulation output and answer the question how complete is the range of known model outputs for a given set of inputs this step usually involves a sensitivity analysis to map model input parameters to simulation output cadero et al 2018 ginot et al 2006 saltelli et al 2007 this validation step can include sweeping across a range of parameters stress testing the model with extreme parameter values or testing the internal validity of the model by starting otherwise identical simulations with different random seeds among other tests that further map inputs and outputs 6 compare the simulation output to the target system and answer the question how well does the simulation output match the empirical data of the target system this validation step involves corroborating model behavior with empirical data that was not used in model development this step can be applied either retroactively or predictively depending on whether the empirical data was known respectively before or after the model was implemented david 2013 an additional benefit of predictive corroboration is that it is not possible for the empirical data to have introduced bias to the model design this validation step can take many forms edmonds and meyer 2013 gross and strand 2000 stonedahl 2010 but generally involves a visual or statistical analysis between the simulation output and empirical data in this paper we apply these six validation steps to our agent based model which is designed to explore the relationship between territory size and mortality rates of lethally aggressive agents because this agent based model and its simulation output are fairly basic they can provide a clear example of applying consilience checks as a series of validation techniques our aim is to alleviate difficulties in determining a sufficient level of model accuracy taking some of the guess work out of completing this process 2 methods 2 1 conceptual model for a conceptual model of intergroup aggression we used simplified conditions following waser s 1976 application of the ideal gas law to model animal encounters we assumed that individuals move randomly schreier and grove 2010 and thus intergroup interactions occur randomly barrett and lowen 1998 additionally we assumed that individuals live in groups with fission fusion dynamics i e members of a larger group travel in subgroups of varying size a grouping pattern shared by wolves chimpanzees humans and several other species with coalitionary killing wrangham 1999 following wrangham 1999 we assumed that intergroup killings occur when large subgroups happen to encounter isolated or greatly outnumbered members of neighboring groups enabling the attackers to kill at low risk to themselves thus we assumed intergroup killing is a stochastic process resulting from random encounters with killings occurring whenever encounters happen to coincide with an extreme numerical asymmetry between subgroups we assumed that these intergroup encounters tend to occur where territories overlap in the border or periphery areas of each territory barrett and lowen 1998 the core consists of all territory that is not periphery and is the more central and safe location kaufmann 1962 we therefore assumed that violent intergroup encounters are most likely to occur in the periphery which we defined as fixed width borders at the edges of each territory as the size of the territory increases the area of that periphery decreases in proportion to the area of the whole territory this relationship occurs because the boundary tends to increase linearly but the whole territory increases quadratically using square territories as an example fig 2 the area of a territory x units on a side is a x2 and the area of a boundary b units wide is b x2 x 2b 2 this makes the periphery area ratio b a 4 b x 1 b x since b is fixed and x is increasing this fraction representing danger decreases to zero in the ultimate limit fig 3 a shows a graphical representation illustrating the predicted reciprocal relationship between territory size and per capita mortality rate this relationship should also hold for non fixed territory shapes assuming that the territory shape approximates a convex polygon the periphery length should increase as a linear function of the reciprocal centroid distance whereas the territory area should increase quadratically thus we define the reciprocal centroid distance for convex polygon territories to be equivalent to the radius for circular territories which is equivalent to the periphery area ratio studies of ant colonies have proposed that territory defensibility can be considered as related to the radius of the territory regardless of its shape hölldobler and lumsden 1980 as the radius increases assuming that the population grows proportionately with territory size proportionately fewer individuals are required to defend the border and can instead be used for offense hölldobler and lumsden 1980 moffett 2010 in very small territories individuals are exposed to elevated mortality risk throughout their range in very large territories mortality rate declines asymptotically towards zero such that increasing territory size eventually has negligible further impact on mortality risk fig 3a we can also express this relationship as a positive correlation between per capita mortality rate and reciprocal centroid distance fig 3a right in larger territories individuals are less likely to die from lethal intergroup encounters and therefore live longer and as a result have more offspring in their lifespan these demographic processes potentially result in a virtuous cycle of benefits for larger territories lower mortality results in higher lifetime fertility which results over time in the production of more fighters improving the ability to expand territory 2 2 agent based model the conceptual model described above entails substantial simplifications including territories of uniform shape fig 2 and intergroup encounters that occur only in the periphery therefore an agent based model is useful because it supports individual agents that interact with each other locally but can also behave independently the result of these local behaviors can manifest in complex system level patterns and thus more directly model living systems we developed a basic agent based model file s1 using freely available software called netlogo wilensky 1999 here we describe this model using the odd protocol grimm et al 2020 2010 2006 2 2 1 purpose and patterns the purpose of the model is to examine the relationship between territory size and intergroup mortality risk under realistic assumptions furthermore the model investigates how fertility is affected by this relationship lethalgeometry makes no assumptions about territory size or shape nor the extent of the periphery compared to the core additionally it does not make assumptions about the details of how intergroup killing occurs nor does it restrict the location of intergroup encounters fig 4 2 2 2 entities state variables and scales this model contains three types of entities groups individuals and cells each group represents a collection of territorial individuals groups are characterized by a group color variable which is an arbitrarily assigned color used to visually distinguish group members from non group members individuals use the my group variable to track their group membership which is fixed from birth and assigned based on their mother s group membership individuals also have a numerical energy state variable which is applied in a similar manner to the wolf sheep predation model wilensky 1997 and used to complete certain actions and a deficit results in death most state variables are used for data tracking groups possess several state variables that collect information on the current state of their population and territory and individuals have several state variables that track their current life and fertility status table 1 the environment is composed of grid cells in lattice configuration arranged into a 100 100 rectangle it wraps both vertically and horizontally to avoid boundary effects mathematically forming a torus these cells have two state variables cell energy represents the amount of energy available for individual consumption and cell group represents the current group affiliation which is set as the group affiliation of the last individual to occupy that cell the color of the cell is periodically updated to match the group color of its currently affiliated group table 1 2 2 3 process overview and scheduling during each time step the following processes take place i agent deaths ii agent births iii cell updates iv agent movement v agent fighting vi agent reproduction and vii agent foraging 2 2 4 design concepts basic principles in the conceptual model of intergroup aggression we assumed that territories are explicitly delineated as periphery or core and that lethal intergroup aggression only occurs in the periphery for the agent based model we did not impose these restrictions but instead allowed them to emerge from the simulation agents in a simulation move randomly and their movements define the boundaries of their territory agents can also be aggressive towards other non group agents at any point within their territory emergence we expect territory sizes to fluctuate over time in response to individual reproduction random walking and lethal intergroup encounters in turn the individuals within these territories are expected to vary in their mortality and fertility rates according to food availability and frequency of aggression sensing agents can assess their environment to determine 1 if there are non group members within the same cell and 2 if there is food within the cell interaction the agents are programmed to move randomly about their environment search for and eat food to obtain energy reproduce if they can and act aggressively toward individuals of other groups during each simulation step agents analyze their environment and internal state to determine which actions to take the actions available to agents include moving fighting and giving birth submodels each action is associated with a predetermined energetic cost that is set by the user table 2 an agent enters into combat with one of the non group members it senses within its cell and its victim incurs an energy cost equal to the aggression cost parameter setting an agent also consumes any cell energy table 1 that exists at its current location leaving no energy for consumption by any other agents on the same cell stochasticity individuals and cells are handled in a random order for each process described below submodels additionally they move randomly as the simulation progresses collectives a group is represented by a collection of individuals and its territory is represented by a collection of cells the territorial nature of these individuals often results in a spatial distinctiveness for both the individuals and cells of each group and territory fig 4 observation the purpose of the model is to assess the relationship between territory size and per capita mortality and fertility rates thus lethalgeometry collects data related to these factors at the end of each simulation run file s2 2 2 5 initialization at the beginning of a simulation lethalgeometry builds cells for the environment and agent groups according to initial parameter settings table 2 a number of groups are created totaling number of groups and each containing a population size equal to initial group size each agent is given an initial energy equal to initial individual energy each cell receives a random initial cell energy level uniformly distributed from 0 to 100 2 2 6 input data the model does not use input data to represent time varying processes grimm et al 2010 2 2 7 submodels i agent deaths any agents that have incurred a subzero energy value during the previous timestep are considered dead and removed from the simulation ii agent births any agents that are marked to give birth are cloned these clones have settings identical to their asexual parent except in their energy the parent loses and the clone begins with energy equal to the birth cost table 2 iii update cells each environmental cell contains some variable amount of cell energy e g vegetation fruit prey which is consumed by agents and which regrows at a predetermined rate set by cell growth rate table 2 each cell is associated with at most one group referenced as cell group this affiliation is determined by the agent that last occupied that cell the full collection of cells associated with the same cell group represents the territory for that group during this procedure the cell color is updated to match the current group iv agent movement agents are random walking each simulation step an agent must move in a random direction by one unit cell length and incur an associated energy cost movement cost table 2 v agent fighting fighting takes place when agents from different groups occupy the same cell each agent randomly selects another non group agent to fight and the victim incurs an energy cost equal to aggression cost table 2 we did not make assumptions that killings occur only in cases of numerical asymmetry but in practice agents will be more likely to die when sharing cells with numerous rivals vi agent reproduction agents have a stored energy level and automatically reproduce if they exceed the predetermined lower threshold energy birth cost table 2 for simplicity the species is modeled as monoecious any individual can give birth vii agent foraging cells contain random amounts of food which is used by the agents for energy stored energy is essential for allowing the agent to stay alive and deploy various actions if an agent occupies a cell with a positive cell energy the agent eats the cell food transferring that energy into the agent s own energy stores 2 2 8 simulations for our agent based model simulations we used all combinations of the initial parameter settings listed in table 2 which total 10 000 simulations these parameter values are arbitrary and do not represent any specific values from the real world we systematically varied these parameters to test whether lethalgeometry produces consistent results independent of any particular settings specifically we allowed cell growth rate movement cost birth cost and aggression cost to vary across simulations between 0 and 10 including combinations of variables in which there is a ten fold difference in energy we ran these simulations for 1000 steps to allow enough time for a representative sample of territory sizes to emerge we set number of groups to 10 to promote enough intergroup aggression for each simulation we recorded the demography of each group still in existence at the end of 1000 steps recorded variables are listed in table 1 simulation data is stored in file s2 2 3 empirical data chimpanzees we analyzed a subset of a larger dataset on lethal aggression in chimpanzees from 18 different study communities in long term study sites across africa wilson et al 2014 we excluded two of these communities bossou and kyambura from analysis because they are isolated from other chimpanzee communities providing a sample size of n 16 communities file s3 for each community this study provided data on the number of individuals known inferred and suspected have been killed during intergroup attacks as well as data on the number of years of observation and each community s mean population size and territory size during the study period 2 4 empirical data wolves we used data for 42 wolf packs in yellowstone national park usa cassidy et al 2015 from 1995 to 2018 file s4 each year the yellowstone wolf project collected data on the number of wolves per pack and intraspecific deaths and estimated territory sizes based on radio collar data more detailed information on methods for data collection is described in cassidy et al 2015 2 5 statistical analyses we conducted statistical tests using r 4 0 2 and performed regressions using generalized linear mixed models glmms available in the lme4 r package file s5 bates et al 2007 as described in the conceptual model the reciprocal centroid distance of the territory is equivalent to the periphery area ratio and 1 r where r the radius of a circle with the same area as the group or community s home range 2 5 1 agent based model using simulation data from the agent based model we tested for the effects of geometry on mortality and fertility as the data represented counts of deaths and births we performed poisson glmms with 1 group death count as the dependent variable and 2 group birth count as the dependent variable and periphery area ratio as the independent variable in both cases to model the rates instead of the counts we used log group population size as an offset to obtain per capita mortality and fertility we adjusted for confounding effects of the initial parameter settings table 2 by using them as random effects in the poisson regressions 2 5 2 chimpanzees as the dependent variable we used the number of victims of intergroup killing per community cases were placed into one of three categories based on the quality of evidence observed intergroup killing was directly witnessed by observers inferred intergroup killing was determined to have taken place based on compelling evidence such as the discovery of a body with injuries typical of chimpanzee attack in an area and context consistent with intergroup aggression and suspected intergroup killing was thought to have taken place based on circumstantial evidence such as the sudden disappearance of a seemingly healthy adult male given that males unlike females do not disperse from their natal community we conducted two sets of analyses 1 those restricted to the cases with strongest evidence observed and inferred n 19 intergroup deaths and 2 all cases including suspected cases n 44 intergroup deaths to provide an upper bound of killings for each community to control for observation time and population size we calculated the number of chimp years per community defined as the mean number of individuals per community per year times the number of years that community was observed to test whether territory size predicted mortality from intergroup aggression we conducted poisson regressions with log chimp years as an offset previous analysis of the full dataset wilson et al 2014 revealed two variables associated with increased rates of lethal aggression males mean number of males 12 years old and density mean number of individuals per community home range km2 this previous analysis included all killings including within group killings and intergroup killings conducted by the study community in the present study we focused on the subset of cases in which a member of the study community was known or suspected to have been killed by members of another community to investigate whether territory size provides additional explanatory power beyond those variables already identified we used information theoretic model selection approach following the recommendations outlined in burnham and anderson 2002 we examined the set of models consisting of all combinations of these variables excluding interactions which allowed us to examine the relative importance of each of three independent variables males density and 1 r where r the radius of a circle with the same area as the community s home range each model consisted of a poisson regression with the total count of victims of intergroup aggression per community as the dependent variable and log chimp years as an offset we tested eight models including the null model models with each variable by itself the three possible combinations of two variables and the full model we corrected for overdispersion and small sample size using qaicc ranked models according to qaicc score lowest best and used results from all models to calculate model averaged estimates of parameters 2 5 3 wolves we performed poisson glmms with intraspecific death count as the dependent variable and 1 r as the independent variable we weighted the log likelihood with the number of locations used to estimate the territory sizes as territory size estimates obtained using more locations are likely more reliable using the weights argument in the glmer function in the lme4 r package bates et al 2007 this places more weight on the observations with more reliable territory size estimates we estimated death count in three ways 1 deaths of all individuals including estimates of litter deaths 2 deaths of individuals greater than 2 months old with any non zero litter deaths counted as one individual and 3 deaths of individuals greater than 2 months only excluding all litter deaths to model the mortality rates instead of the counts we used log average pack size as an offset to obtain per capita mortality we calculated the average pack size based on the april 1 census value and the december 31 census value of the previous year this average closely matches a winter estimate when most of the aggressive encounters occur we adjusted for the confounding effects of observation year and pack identity by using them as random effects in the poisson regressions and of the number of radio collars present in each pack by using it as a fixed effect in the regressions 3 results 3 1 simulation output consistent with predictions from the conceptual model in the agent based model per capita mortality rate was higher in smaller territories and lower in larger territories fig 3b analysis of lethalgeometry simulation output revealed a positive relationship between per capita mortality rate and periphery area ratio table 3 with 0s β 0 26 se 0 0058 95 ci 0 25 0 27 0s removed β 0 26 se 0 0058 95 ci 0 25 0 28 to further understand the demographic ramifications of these results we also analyzed the relationship between territory size and fertility rates our analysis showed a negative relationship between per capita birth rate and periphery area ratio table 3 with 0s β 0 039 se 0 0057 95 ci 0 050 0 027 0s removed β 0 040 se 0 0057 95 ci 0 051 0 029 these results indicate that per capita fertility rate was higher in larger territories and lower in smaller territories these results are robust across a range of parameters table 2 because territories in lethalgeometry were not constrained to be contiguous or of any particular size or shape the effect of territory size on mortality rates is robust to departures from assumptions of the conceptual model fig 3a 3 2 empirical data chimpanzees the results of the chimpanzee empirical data concurred with the simulation results per capita mortality in chimpanzees declined with increasing territory size as measured by the reciprocal centroid distance fig 3c considering the models with data restricted to observed and inferred cases the best four models were those that included 1 r which had a strong effect on intergroup mortality rate tables 4 s1 model averaged β 13 se 3 0 95 ci 7 1 19 of the other two variables the model averaged parameter for males was positive β 0 12 se 0 062 95 ci 0 059 0 23 while density had a negative association with mortality rate β 0 54 se 0 26 95 ci 1 0 0 18 as noted the 95 confidence intervals of all these parameters excluded zero this result is sensitive however to the inclusion of one community with an extremely high rate of intergroup mortality kahama excluding kahama the 95 confidence interval of the model averaged estimates for all three parameters males density and 1 r included zero the best model was the one that included only 1 r model weight 0 33 table s2 but this was only slightly better than the null model model weight 0 31 δqaicc 0 14 table s2 including the suspected cases the top 4 models were again those that included 1 r which remained strongly associated with intergroup mortality rate tables 4 s3 β 7 7 se 2 0 95 ci 4 0 12 the results remained consistent even after excluding kahama as the 95 confidence interval of the model averaged estimate of 1 r excluded zero table 4 β 1 5 se 2 1 95 ci 0 27 7 3 the best model was the null model model weight 0 36 table s4 but equivalent to the model with 1 r model weight 0 23 δqaicc 0 96 table s4 combined these results are consistent with the view that 1 r is positively associated with intergroup mortality rate 3 3 empirical data wolves the results of the wolf empirical data also corresponded with the simulation results per capita mortality in wolves declined with increasing territory size fig 3d analysis of the empirical data revealed a positive relationship between per capita mortality rate and inverse radius all individuals table 5 with 0s β 6 1 se 0 27 95 ci 5 6 6 6 0s removed β 8 5 se 0 54 95 ci 7 4 9 5 individuals 2 months and litters as 1 individual table 5 with 0s β 4 8 se 0 27 95 ci 4 3 5 3 0s removed β 6 0 se 0 61 95 ci 4 8 7 2 individuals 2 months excluding litter deaths table 5 with 0s β 4 3 se 0 27 95 ci 3 8 4 9 0s removed β 5 2 se 0 62 95 ci 4 0 6 4 4 discussion agent based models may have a reputation of being black boxes that can be manipulated to produce any result to support the hypothesis topping et al 2010 implementing a robust set of validation tests increases the likelihood that a model can advance scientific understanding rather than simply confirm researchers pre existing biases in this study we present a case study of model validation on lethalgeometry an agent based model designed to explore the relationship between territory size and mortality and fertility rate here we summarize the step by step validation process for lethalgeometry first we included a description of the conceptual model as given in section 2 1 which includes both a verbal and mathematical description of the logical assumptions these descriptions allow the conceptual model of lethalgeometry to undergo the peer review process for scrutiny by others second we described the model settings that are taken from real world measurements which is straightforward in lethalgeometry there are no parameters settings that are directly influenced by any target system for example we did not impose a particular birth rate based on data from chimpanzees or wolves instead we set parameters to arbitrary settings and ran simulations that swept across these parameters additionally the qualitative assumptions are as basic as possible we know that animals eat food for energy which they sometimes use to reproduce and which they also need to survive we also know that animals can be lethally aggressive and that aggressive acts can sometimes lead to death the rules in the model code follow these general principles third we focused on whether or not the model was built correctly lethalgeometry is a netlogo model with only 199 lines of code excluding the lines of code for data collection and validation the compactness of the code inherently made it easier to check for logical errors we performed multiple line by line checks of the code for such errors additionally we conducted a series of dynamic verification checks to determine if the emergent phenomena were operating within expected bounds file s6 furthermore we included the complete lethalgeometry code for others to examine verify and improve file s1 fourth we made predictions from the conceptual model that we expected to emerge in the agent based model simulation output reiterating our main findings we expected that the inverse relationship between territory size and mortality would hold for a range of parameter settings fig 3b which we found was statistically supported in section 3 1 fifth we ran multiple simulations using parameter settings that sweep across the parameter space we chose combinations of values that explore a range of relevant scenarios beyond what would be expected from chimpanzees and wolves alone thus we can be reasonably assured that our model can be more generally applied to a broad range of territorial species with intergroup killing sixth we performed retrodictive corroboration the chimpanzee data were known to the authors before model development began but had not yet been analyzed with respect to territory size fig 3c after we constructed the lethalgeometry we also investigated the geometrical effects of territory size in another species wolves to further corroborate our findings fig 3d both sets of empirical data supported our findings from lethalgeometry both visually and statistically mortality risk from intergroup aggression is inversely related to territory size while we can never be certain that lethalgeometry or any other agent based model is working without error box 1979 these consilience checks provide a way to find faults in a model and when no fault is found give more credence to the model s accuracy therefore we have confidence that the results from this study generalize to other systems and also that we can use lethalgeometry for further investigation in addition to tracking mortality we also tracked fertility and found a positive relationship between territory size and fertility while we have not yet attempted to test the fertility result empirically our validation process provides more confidence that under appropriate conditions the geometry of larger territories can result in increased total fertility as well as lower per capita mortality our validated model supports the hypothesis that in species with lethal intergroup aggression one basic aspect of territory geometry size has strong effects on mortality and may also impact reproduction in larger territories individuals are less likely to die from intergroup aggression and therefore live longer and as a result have higher lifetime reproductive success thus as territory size increases territory owners experience a virtuous cycle of benefits lower mortality risk which results in higher overall reproductive rate which in turn increases the fighting ability of the group which enables them to expand their territory conversely decreases in territory size result in negative feedback increasing mortality risk decreasing reproductive rate resulting in decreasing fighting ability frequently resulting in an irreversible spiral towards group extinction as a result of these positive and negative feedback processes during the course of running the model the number of groups generally decreased in number and if enough time were allowed one single group eventually dominated the entire environment when individuals are drawn randomly with identical average properties which groups expand and which contract is random independent of any specific differences in the individuals in the group this phenomenon is also observed in empirical animal studies in gombe national park the kasekela community of chimpanzees has greatly expanded at the expense of the neighboring mitumba and kalande communities and by 2012 occupied more than half the total park area wilson 2012 in the wolves at yellowstone national park larger packs have been observed to achieve higher fertility and expand their territory range at the expense of smaller packs smith and guernsey 2002 whether animals defend their home ranges as territories depends on whether territory defense is economical mitani and rodman 1979 found that primates were more likely to be described by observers as territorial when their daily travel distance exceeded the diameter of their home ranges in humans technological advances have greatly increased travel efficiency improved transportation technology likely contributes to a well recognized phenomenon over the course of human history the maximum size of group territories has increased enormously turchin and gavrilets 2009 hunter gatherer bands have home ranges that cover a median 175 km2 marlowe 2005 early states controlled much larger territories and the maximum territory size of empires increased dramatically at several key stages in history turchin and gavrilets 2009 during this time improvements in transportation included such innovations as boats sailing ships use of domesticated horses to pull wheeled vehicles and carry riders roads trains cars and air travel vast increases in the speed of communication once telegraph and other electronic media developed also made defending larger territories possible and economical headrick 2009 as territory size has increased people living within these larger territories have been increasingly able to reap the benefits of being far from the border areas where intergroup aggression is mostly likely to occur population size may also contribute to these benefits as larger communities appear less vulnerable to lethal aggression falk and hildebolt 2017 pinker 2011 presents evidence that per capita deaths from warfare have generally declined in recent centuries and millennia even taking into account the exceptional devastation of the world wars of the 20th century insofar as this is the case increases in the territorial size of states may help protect people from intergroup killing at least prior to the development of military aircraft and missiles the lethalgeometry model offers insight into the inverse relationship between territory size and both mortality risk and fertility benefit this model is generalized to apply to organisms that are both territorial and lethally aggressive including humans further investigation could provide insights into territorial expansion and the rise of states turchin and gavrilets 2009 however one tradeoff in a generalized model is that it does not include specific features of interest about a target system another direction could be to add species specific details that provide additional information about the impact of lethal aggression for that species b3get is an agent based model that offers the ability to explore territorial behavior while also incorporating species specific details into the behaviors of agents crouse 2021 crouse and colleagues 2019 used a previous model version to investigate how male baboon reproductive strategies vary with female group size they modeled male and female baboons with genotypes that coded for behaviors related to mating fighting and transferring between groups among others the latest version of b3get allows the user to dynamically track territory shapes and sizes in a similar way to lethalgeometry crouse 2021 using b3get it is possible to create virtual populations that include behaviors and attributes of real world species such as specifying mating preferences to be monogamous as in wolves or polygynandrous as in chimpanzees using species specific agents could provide additional information about the relationship between territory size and mortality risk and what other factors might be important an additional direction of this research would be to apply our model validation framework to other models including b3get b3get is built as a generalized model of animal behavior and so the target system includes many possible species the greater number of species creates a greater pool of conceptual models and empirical data enabling us to apply validation tests in multiple ways 5 conclusions the practice of agent based model validation has historically been underrepresented in the scientific literature in this paper we add to recent efforts in developing model validation frameworks our validation framework design aids modelers by making explicit comparisons among each element of the modeling cycle and focuses on the assumptions the modeler makes in transitioning from one element to another by refocusing attention on these specific goals we offer an improved way to operationalize the model validation process we used this framework to investigate lethalgeometry a basic model of lethally aggressive agents with dynamically changing territory boundaries shapes and sizes lethalgeometry provided three main advantages to the conceptual model alone first it tests whether the effect of territory size on intergroup mortality risk depends on the assumption that territories consist of simple convex polygons second it tests whether the predicted effect depends on the assumption that intergroup killings occur mainly in the periphery third it tests the hypothesis that reductions in intergroup mortality risk also result in increased fertility something for which we do not have sufficiently detailed empirical data to test by using both a mathematical conceptual model and empirical data from two lethally aggressive species chimpanzees and wolves we were able to analyze lethalgeometry from many different perspectives this validation provides confidence in our findings on the impact of territory size on group demography overall we found that territory size positively impacts fertility and negatively impacts mortality which may lead to a virtuous cycle of benefits in some species including humans credit authorship contribution statement kristin n crouse software validation writing original draft writing review editing visualization nisarg p desai writing review editing formal analysis kira a cassidy investigation data curation writing review editing erin e stahler investigation data curation writing review editing clarence l lehman conceptualization writing review editing michael l wilson conceptualization methodology investigation data curation writing original draft writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study analyzes previously published chimpanzee data collection of these data depended on funding from many different sources with the permission of authorities in many different countries but no new chimpanzee data were collected for this project the wolf data were collected as part of the long term monitoring of wolves in yellowstone national park this project is supported by the national park service yellowstone forever and many generous donors to wolf research in yellowstone national park the authors also appreciate the tireless efforts by many volunteer observation crews and the safe piloting of roger stradley from gallatin flying service mark packila of wildlife air llc bob hawkins from hawkins and powers inc and sky aviation inc and jim pope and crew from leading edge aviation llc we thank members of the university of minnesota behavior group the primate ecology lab at harvard university and nimbios workshop on evolution and warfare at the university of tennessee for helpful feedback on earlier presentations of these results and the institute for advanced study in toulouse iast for funding to m l w from the french national research agency anr under grant anr 17 eure 0010 investissements d avenir program supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 110063 appendix supplementary materials image application 1 image application 2 image application 3 image application 4 image application 5 image application 6 image application 7 
24403,validation of agent based models is underappreciated in scientific studies even though this process is an important part of ensuring that a model is a reliable research tool here we propose modifications to a model validation framework and illustrate this framework with a case study of territorial behavior in species that defend territories larger territories provide obvious benefits such as increased access to food shelter and mates an additional potential benefit is that larger territories could provide protection from intergroup conflict considerations from geometry indicate that per capita risk of death from intergroup violence should decrease with increasing territory size insofar as conflict occurs mainly at the periphery we tested this inference using computer simulations and data from chimpanzees pan troglodytes and gray wolves canis lupus we designed an agent based model that allows territories to vary freely in size and shape we present a framework for model validation and apply it to our agent based model to substantiate its accuracy simulations from the validated model confirmed the predictions from geometry under a broad range of parameter values per capita mortality rate decreased in larger territories similarly using published data on rates of death from intercommunity aggression in 16 chimpanzee communities as well as new data from 38 wolf packs we found that per capita mortality rate correlated negatively with a measure of territory size these findings indicate that in species with lethal intergroup aggression one simple aspect of territory geometry size has strong effects on mortality several lines of evidence indicate that the per capita rates of mortality from warfare have decreased in many human societies over time one factor contributing to this decrease may be the increasing geographic extent of political entities keywords intergroup aggression agent based modeling territoriality mortality rate model validation data availability we have included all data used in the supplementary materials 1 introduction scientists seek understanding in part by developing and testing models to explain phenomena of interest as computers have become more powerful agent based computer models have become increasingly common grimm et al 2017 macal 2016 however as such models have become increasingly more complex in efforts to better predict and explain the natural world ensuring the validity of these models presents a major epistemological challenge augusiak et al 2014 david 2013 gräbner 2018 as a result of these challenges there remains a lack of standardization in the theoretical framework of model validation david 2013 gräbner 2018 gräbner 2018 argues that the diversity of approaches highlights a fundamental epistemological problem there is no easy or straightforward way to ensure that a model accurately matches reality george box s aphorism that all models are wrong but some are useful box 1976 reminds us that the goal is not to construct a perfect model but to make a model that is sufficiently similar to reality that it can be used to understand better the system that it represents to accomplish this aim model validation involves imposing a series of tests on the model in a parallel way to hypothesis testing procedures given a reasonably comprehensive suite of tests and the model passes all tests then the model is considered sufficiently validated the failure of any test calls the model s validity into question researchers have recently sought to make agent based models more transparent in their design and more trustworthy in the outputs they produce augusiak et al 2014 gräbner 2018 grimm and railsback 2005 this effort has resulted in new guidelines for ensuring that agent based models are both well documented grimm et al 2020 2014 and sufficiently validated augusiak et al 2014 gräbner 2018 a challenge remains that it can be unclear when or how to apply validation methods here we hope to contribute towards this effort by proposing modifications to a previous model validation framework augusiak et al 2014 and illustrate this modified framework with a case study to provide an example of this validation framework we focus on a hypothesis that is straightforward but which to our knowledge has not been tested previously specifically we investigated whether lethally aggressive and territorial species incur higher per capita mortality in smaller territories than in larger territories intergroup aggression plays a major role in the social behavior of many species huntingford 2013 in humans intergroup competition includes warfare which has profoundly influenced the evolution of cultural institutions turchin and gavrilets 2009 in species that defend territories larger territories can provide well recognized benefits such as increased access to food shelter and mates brown 1964 heg et al 2005 mosser and packer 2009 pusey et al 2005 williams et al 2004 wilson 2012 in species with lethal intergroup aggression such as humans homo sapiens allen and jones 2014 glowacki et al 2020 chimpanzees pan troglodytes watts et al 2006 wrangham 1999 wolves canis lupus mech and boitani 2010 ants e g azteca trigona adams 1990 iridomyrmex purpureus lieshout et al 2005 and others western gulls larus occidentalis ewald et al 1980 lions panthera leo mosser and packer 2009 spotted hyenas crocuta crocuta kruuk 1972 larger territories should provide an additional but under appreciated benefit reduced risk of mortality from intergroup aggression if we assume that territorial individuals generally stay within their territory then encounters with hostile individuals should occur mainly along the borders between neighboring territories in species with lethal intergroup aggression the rate of intergroup killing should depend on the rate at which intergroup encounters occur this encounter rate in turn partly depends on the size of the territory in a territory that is small relative to the daily travel distance for that species a random walk will frequently bring residents to territorial boundaries waser 1976 mitani and rodman 1979 if the territory is large however residents will encounter territorial boundaries less often deviations may occur from these basic assumptions wolves and chimpanzees sometimes make deep incursions into neighboring territories for example increasing the likelihood of intergroup encounters mech 1994 watts and mitani 2001 wrangham 1999 nevertheless if intergroup encounters occur mainly along the perimeter of territories individuals should encounter neighbors more often in smaller territories thus in species with intergroup killing individuals in smaller territories should experience a higher risk of being killed by their neighbors than individuals in larger territories additionally a corollary is that increased territory size should increase per capita fertility lower mortality rate from intergroup killing should result in greater longevity and thus greater total fertility for females insofar as increased fertility increases the number of individuals available to defend the group s territory this may result in positive feedback between territory size and fertility however these fertility benefits would likely vary among species depending on factors such as resource distribution reproductive strategies and dispersal patterns among others 1 1 case study in this study we investigated the relationship between territory size and both mortality risk and fertility benefit using an agent based model called lethalgeometry with individual agents programmed to mimic the behavior of territorial entities because they can include spatially explicit relationships among individuals agent based models have proven useful for investigations of territoriality mosser and packer 2009 tanemura and hasegawa 1980 including some netlogo models carter et al 2015 lemanski et al 2021 sells et al 2022 in our model the expected relationship between territory size and mortality risk is straightforward which enabled us to focus more thoroughly on model validation an underappreciated component of model development for many agent based and other computer based models augusiak et al 2014 as such we also documented our investigation of lethalgeometry to provide an example of our model validation framework which focuses on assumptions made and therefore potential errors introduced during the model development process we used three different approaches to examine the effects of geometry on per capita rates of intergroup mortality first we proposed an analytical model derived from geometry this model provides a conceptual framework using a mathematical perspective for the relationship between territory size and rates of mortality from intergroup aggression second we developed an agent based model from this conceptual model and examined findings from the simulation output third we tested predictions of lethalgeometry using data on lethal aggression in chimpanzees from long term study sites across africa wilson et al 2014 and data collected on gray wolves in yellowstone national park cassidy et al 2015 we did not examine the effect of territory size on killing rate for these populations until after constructing lethalgeometry these analyses therefore provide a strong source for validation 1 2 agent based modeling agent based models are used to represent living organisms and are built with behavioral code at the individual agent level to simulate interactions among a system of autonomous agents huston et al 1988 grimm 1999 macal 2016 the decision making algorithms of agents are designed to correspond directly with the inferred behavioral rules of their real world living counterparts the agent based model development process is often referred to as the modeling cycle which includes many variants augusiak et al 2014 david 2013 grimm and railsback 2005 landry et al 1983 and describes the procedure for synthesizing information from a real world system or target system to develop computer models used to gain understanding of that target system fig 1 depicts a version of the modeling cycle the process by which an agent based model is built from and designed to match a given target system the modeling cycle includes an iterative progression through the elements of this building process starting from the target system then proceeding to the conceptual model agent based model and simulation output the target system is a conception of a real world system that is made direct through concrete observations that are recorded as empirical data a conceptual model is developed by synthesizing these empirical data into a set of simplifying assumptions about the target system an agent based model uses algorithms and computer code to make explicit elements of the conceptual model finally the agent based model produces simulation output which can be compared to the target system both to reaffirm the model construction and to increase knowledge of the target system the modeling cycle repeats if the output and target system do not adequately match and revision of the model is required otherwise the simulation output can be synthesized into results that report something meaningful about the target system 1 3 model validation model validation is a crucial component of the model development process because it is a way to determine how accurate a model is model accuracy is generally understood to mean how well a model matches its target system the real system under study that the model is designed to represent doran and gilbert 1994 zeigler et al 2018 model validation consists of a series of correctness checks performed during model development augusiak et al 2014 david 2013 edmonds and meyer 2013 grimm et al 2014 grimm and railsback 2012 2005 just as quality assurance is used to test manufactured items these validation checks help determine the quality of the model and how well it produces predictable target system behavior augusiak et al 2014 in scientific research this process adds credibility to the model output and thus to the results of the hypothesis testing process despite the need for validated models the practice of model validation remains under represented within the scientific literature in studies of behavior and ecology augusiak et al 2014 grimm et al 2014 grimm and railsback 2005 therefore we highlight the importance of model validation to promote further attention to this important aspect of using computer simulation models in scientific research a computer model that produces dependable output is considered validated but determining this is not a straightforward matter since a model represents a set of hypotheses about a target system it can never be proven correct only falsified augusiak et al 2014 thus following box 1979 even the most exhaustive systematic and precise validation methods can never guarantee that a model is working without error david 2013 furthermore while the simulation output may appear to match the target system the internal mechanisms of the model may not appropriately correspond to those of the real world additionally to avoid confirmation bias model validation requires deciding a priori how a validated model should match its target system which suggests that the target system is already well understood to perform these comparative tests david 2013 however a model is created to gain insight into its target system which suggests that knowledge of the target system is incomplete ultimately while no target system is fully understood nor is any validation test absolute one nonetheless can be reasonably assured that a model is working as expected if 1 its mechanisms have been thoroughly scrutinized and 2 it consistently produces outputs that are quantitatively and qualitatively similar to empirical data collected from the target system bianchi et al 2007 kohler et al 2005 kohler and gumerman 2000 researchers can then apply validated models to test hypotheses about the target system david 2013 agent based models face additional challenges during the validation process because they simulate the complexity that emerges from small scale interactions between and within agents macal 2016 which often transcend the kinds of systems that can be understood through direct analytical methods such as finding the numerical solution to a set of differential equations thus there is no universally applied validation technique for agent based models that can be used to calculate a relative measurement of model accuracy as exists in other fields augusiak et al 2014 furthermore agent based models are built from the perspective of their agents and different choices in code design can manifest as larger changes in the emergent properties since models often deal with complex interactions if an emergent pattern flags an error in the model it can be difficult to determine the location in the code that is producing this error as models increase in complexity they become increasingly vulnerable to amplifying the error produced by these incorrect base assumptions gilbert and troitzsch 1999 to overcome these limitations modelers have proposed various frameworks for validation of agent based models grabner 2018 augusiak et al 2014 augusiak et al 2014 presented an evaludation framework that highlights the crucial role that validation should have during the model development process and assigned elements of model validation to locations on the modeling cycle grabner 2018 focused on an epistemological framework that involved a series of comparisons between modeled components and real world components and described how these elements are also comparable to the evaludation framework presented by augusiak et al 2014 when we first developed lethalgeometry we turned to these frameworks to guide us in the model validation process however we found incongruencies between some of the validation steps and where they are placed in the modeling cycle in particular these frameworks do not outline an explicit correspondence between validation step and area of the modeling cycle which makes it difficult to address which validation steps should be applied at which stages of model development these frameworks include validation steps that appear in multiple places or not anywhere on the modeling cycle in addition these validation frameworks can conflate references to the target system with those of the conceptual model in our view these are two distinct areas of the modeling cycle and are represented by distinct types of information the target system is represented by empirical data collected directly from the target system whereas the conceptual model is represented by qualitative inferences about the target system while this distinction may be subtle the type of information can profoundly impact which validation methods should be applied under this consideration the model output verification stage of the evaludation framework includes methods that are related to both the target system calibration and the conceptual model predicted vs observed even though only the latter is specified by the placement of this evaludation stage in the modeling cycle for these reasons it can be difficult to completely follow these frameworks and instead we have applied a modified validation procedure we sought to ensure a one to one correspondence between each validation check and area of the modeling cycle which permits an exhaustive consideration and scrutinizing of all aspects of the development process furthermore we reframed the process to explore the assumptions made in each stage of model development by focusing on one part of the modeling cycle and by specifying a question to answer for every validation step we were able to operationalize the validation process for lethalgeometry in a relatively straightforward and complete manner described in detail below 1 4 validation framework we present a general framework for model validation which builds on recent work appleget et al 2014 augusiak et al 2014 cooley and solano 2011 david 2013 gräbner 2018 to structure elements of the validation process with respect to elements of the model development process fig 1 this framework can be applied to all computer models e g agent based equation based that follow the modeling cycle during development the end goal of the modeling cycle process is to produce simulation results that are an accurate depiction of the original target system such that these data can be used for hypothesis testing therefore the construction of each element of the modeling cycle should seek to minimize the translation error from the previous element however the transition between each modeling cycle element likely results in decisions that introduce error our model validation framework involves performing a series of comparisons between each element of the modeling cycle process for a total of six comparisons with the aim of seeking out and reducing incongruencies between them the term consilience is used in science to denote when independent data converge on conclusions that are in agreement with each other wilson 1999 thus we use the term consilience check to refer to comparisons between two modeling cycle elements to verify that one representation is reasonably equivalent to another since these elements encompass all stages of the modeling cycle which presumably defines the boundaries of model building applying each of these checks represents a reasonably exhaustive approach fig 1 depicts these consilience checks as lines connecting each modeling cycle element to each other with some common validation methods that relate to each comparison while each of these comparisons strives to show that each element of the modeling cycle adequately represents one another defining adequacy presents an epistemological problem david 2013 this problem is unavoidable but can be minimized by applying one or multiple comparisons between each element each one adding another layer of validation to the model in question we summarize the six consilience checks below 1 compare the target system to the conceptual model and answer the question how does knowledge of the target system influence conceptual model design this includes a verbal or graphical model of the target system augusiak et al 2014 which ultimately influences the choices made in computer model design in many cases the conceptual model is cultivated through years of previous research on the target system and so a thorough discussion of this knowledge base should adequately fulfill this comparison 2 compare the target system to the computer model and answer the question how does knowledge of the target system influence the computer model implementation this step involves evaluating the empirical data from the target system both quantitative and qualitative and how this information impacts computer model design and parameter settings augusiak et al 2014 gräbner 2018 this information defines virtual equivalents from the target system such as the timestep and cell sizes attributes like body size or abilities like reproductive rate the odd overview design concepts and description protocol grimm et al 2020 2010 2006 is gaining traction as a template to communicate all of the salient details of an agent based model in a reproducible and transparent way and may be sufficient for covering these first two comparisons 3 compare the conceptual model to the computer model and answer the question how well does the computer model implementation match the conceptual model design this validation step is often referred to as verification augusiak et al 2014 bryson et al 2007 gräbner 2018 and involves checking the model code for programming errors this step focuses on the nuts and bolts of the model and whether the code matches the design plan made in the conceptual model typical verification techniques include visualization of the interface line by line code reviews static checks of the code subroutines in isolation and dynamic checks of the emergent properties while the simulation is running among others david 2013 edmonds and meyer 2013 grimm and railsback 2005 4 compare the conceptual model to the simulation output and answer the question how well does the conceptual model design predict model outputs this step involves making predictions from the conceptual model that are reproduced in the simulation output for example does changing a parameter setting alter the simulation behavior as anticipated by the conceptual model for this validation step modelers should confirm that these emergent patterns are produced as expected 5 compare the computer model to the simulation output and answer the question how complete is the range of known model outputs for a given set of inputs this step usually involves a sensitivity analysis to map model input parameters to simulation output cadero et al 2018 ginot et al 2006 saltelli et al 2007 this validation step can include sweeping across a range of parameters stress testing the model with extreme parameter values or testing the internal validity of the model by starting otherwise identical simulations with different random seeds among other tests that further map inputs and outputs 6 compare the simulation output to the target system and answer the question how well does the simulation output match the empirical data of the target system this validation step involves corroborating model behavior with empirical data that was not used in model development this step can be applied either retroactively or predictively depending on whether the empirical data was known respectively before or after the model was implemented david 2013 an additional benefit of predictive corroboration is that it is not possible for the empirical data to have introduced bias to the model design this validation step can take many forms edmonds and meyer 2013 gross and strand 2000 stonedahl 2010 but generally involves a visual or statistical analysis between the simulation output and empirical data in this paper we apply these six validation steps to our agent based model which is designed to explore the relationship between territory size and mortality rates of lethally aggressive agents because this agent based model and its simulation output are fairly basic they can provide a clear example of applying consilience checks as a series of validation techniques our aim is to alleviate difficulties in determining a sufficient level of model accuracy taking some of the guess work out of completing this process 2 methods 2 1 conceptual model for a conceptual model of intergroup aggression we used simplified conditions following waser s 1976 application of the ideal gas law to model animal encounters we assumed that individuals move randomly schreier and grove 2010 and thus intergroup interactions occur randomly barrett and lowen 1998 additionally we assumed that individuals live in groups with fission fusion dynamics i e members of a larger group travel in subgroups of varying size a grouping pattern shared by wolves chimpanzees humans and several other species with coalitionary killing wrangham 1999 following wrangham 1999 we assumed that intergroup killings occur when large subgroups happen to encounter isolated or greatly outnumbered members of neighboring groups enabling the attackers to kill at low risk to themselves thus we assumed intergroup killing is a stochastic process resulting from random encounters with killings occurring whenever encounters happen to coincide with an extreme numerical asymmetry between subgroups we assumed that these intergroup encounters tend to occur where territories overlap in the border or periphery areas of each territory barrett and lowen 1998 the core consists of all territory that is not periphery and is the more central and safe location kaufmann 1962 we therefore assumed that violent intergroup encounters are most likely to occur in the periphery which we defined as fixed width borders at the edges of each territory as the size of the territory increases the area of that periphery decreases in proportion to the area of the whole territory this relationship occurs because the boundary tends to increase linearly but the whole territory increases quadratically using square territories as an example fig 2 the area of a territory x units on a side is a x2 and the area of a boundary b units wide is b x2 x 2b 2 this makes the periphery area ratio b a 4 b x 1 b x since b is fixed and x is increasing this fraction representing danger decreases to zero in the ultimate limit fig 3 a shows a graphical representation illustrating the predicted reciprocal relationship between territory size and per capita mortality rate this relationship should also hold for non fixed territory shapes assuming that the territory shape approximates a convex polygon the periphery length should increase as a linear function of the reciprocal centroid distance whereas the territory area should increase quadratically thus we define the reciprocal centroid distance for convex polygon territories to be equivalent to the radius for circular territories which is equivalent to the periphery area ratio studies of ant colonies have proposed that territory defensibility can be considered as related to the radius of the territory regardless of its shape hölldobler and lumsden 1980 as the radius increases assuming that the population grows proportionately with territory size proportionately fewer individuals are required to defend the border and can instead be used for offense hölldobler and lumsden 1980 moffett 2010 in very small territories individuals are exposed to elevated mortality risk throughout their range in very large territories mortality rate declines asymptotically towards zero such that increasing territory size eventually has negligible further impact on mortality risk fig 3a we can also express this relationship as a positive correlation between per capita mortality rate and reciprocal centroid distance fig 3a right in larger territories individuals are less likely to die from lethal intergroup encounters and therefore live longer and as a result have more offspring in their lifespan these demographic processes potentially result in a virtuous cycle of benefits for larger territories lower mortality results in higher lifetime fertility which results over time in the production of more fighters improving the ability to expand territory 2 2 agent based model the conceptual model described above entails substantial simplifications including territories of uniform shape fig 2 and intergroup encounters that occur only in the periphery therefore an agent based model is useful because it supports individual agents that interact with each other locally but can also behave independently the result of these local behaviors can manifest in complex system level patterns and thus more directly model living systems we developed a basic agent based model file s1 using freely available software called netlogo wilensky 1999 here we describe this model using the odd protocol grimm et al 2020 2010 2006 2 2 1 purpose and patterns the purpose of the model is to examine the relationship between territory size and intergroup mortality risk under realistic assumptions furthermore the model investigates how fertility is affected by this relationship lethalgeometry makes no assumptions about territory size or shape nor the extent of the periphery compared to the core additionally it does not make assumptions about the details of how intergroup killing occurs nor does it restrict the location of intergroup encounters fig 4 2 2 2 entities state variables and scales this model contains three types of entities groups individuals and cells each group represents a collection of territorial individuals groups are characterized by a group color variable which is an arbitrarily assigned color used to visually distinguish group members from non group members individuals use the my group variable to track their group membership which is fixed from birth and assigned based on their mother s group membership individuals also have a numerical energy state variable which is applied in a similar manner to the wolf sheep predation model wilensky 1997 and used to complete certain actions and a deficit results in death most state variables are used for data tracking groups possess several state variables that collect information on the current state of their population and territory and individuals have several state variables that track their current life and fertility status table 1 the environment is composed of grid cells in lattice configuration arranged into a 100 100 rectangle it wraps both vertically and horizontally to avoid boundary effects mathematically forming a torus these cells have two state variables cell energy represents the amount of energy available for individual consumption and cell group represents the current group affiliation which is set as the group affiliation of the last individual to occupy that cell the color of the cell is periodically updated to match the group color of its currently affiliated group table 1 2 2 3 process overview and scheduling during each time step the following processes take place i agent deaths ii agent births iii cell updates iv agent movement v agent fighting vi agent reproduction and vii agent foraging 2 2 4 design concepts basic principles in the conceptual model of intergroup aggression we assumed that territories are explicitly delineated as periphery or core and that lethal intergroup aggression only occurs in the periphery for the agent based model we did not impose these restrictions but instead allowed them to emerge from the simulation agents in a simulation move randomly and their movements define the boundaries of their territory agents can also be aggressive towards other non group agents at any point within their territory emergence we expect territory sizes to fluctuate over time in response to individual reproduction random walking and lethal intergroup encounters in turn the individuals within these territories are expected to vary in their mortality and fertility rates according to food availability and frequency of aggression sensing agents can assess their environment to determine 1 if there are non group members within the same cell and 2 if there is food within the cell interaction the agents are programmed to move randomly about their environment search for and eat food to obtain energy reproduce if they can and act aggressively toward individuals of other groups during each simulation step agents analyze their environment and internal state to determine which actions to take the actions available to agents include moving fighting and giving birth submodels each action is associated with a predetermined energetic cost that is set by the user table 2 an agent enters into combat with one of the non group members it senses within its cell and its victim incurs an energy cost equal to the aggression cost parameter setting an agent also consumes any cell energy table 1 that exists at its current location leaving no energy for consumption by any other agents on the same cell stochasticity individuals and cells are handled in a random order for each process described below submodels additionally they move randomly as the simulation progresses collectives a group is represented by a collection of individuals and its territory is represented by a collection of cells the territorial nature of these individuals often results in a spatial distinctiveness for both the individuals and cells of each group and territory fig 4 observation the purpose of the model is to assess the relationship between territory size and per capita mortality and fertility rates thus lethalgeometry collects data related to these factors at the end of each simulation run file s2 2 2 5 initialization at the beginning of a simulation lethalgeometry builds cells for the environment and agent groups according to initial parameter settings table 2 a number of groups are created totaling number of groups and each containing a population size equal to initial group size each agent is given an initial energy equal to initial individual energy each cell receives a random initial cell energy level uniformly distributed from 0 to 100 2 2 6 input data the model does not use input data to represent time varying processes grimm et al 2010 2 2 7 submodels i agent deaths any agents that have incurred a subzero energy value during the previous timestep are considered dead and removed from the simulation ii agent births any agents that are marked to give birth are cloned these clones have settings identical to their asexual parent except in their energy the parent loses and the clone begins with energy equal to the birth cost table 2 iii update cells each environmental cell contains some variable amount of cell energy e g vegetation fruit prey which is consumed by agents and which regrows at a predetermined rate set by cell growth rate table 2 each cell is associated with at most one group referenced as cell group this affiliation is determined by the agent that last occupied that cell the full collection of cells associated with the same cell group represents the territory for that group during this procedure the cell color is updated to match the current group iv agent movement agents are random walking each simulation step an agent must move in a random direction by one unit cell length and incur an associated energy cost movement cost table 2 v agent fighting fighting takes place when agents from different groups occupy the same cell each agent randomly selects another non group agent to fight and the victim incurs an energy cost equal to aggression cost table 2 we did not make assumptions that killings occur only in cases of numerical asymmetry but in practice agents will be more likely to die when sharing cells with numerous rivals vi agent reproduction agents have a stored energy level and automatically reproduce if they exceed the predetermined lower threshold energy birth cost table 2 for simplicity the species is modeled as monoecious any individual can give birth vii agent foraging cells contain random amounts of food which is used by the agents for energy stored energy is essential for allowing the agent to stay alive and deploy various actions if an agent occupies a cell with a positive cell energy the agent eats the cell food transferring that energy into the agent s own energy stores 2 2 8 simulations for our agent based model simulations we used all combinations of the initial parameter settings listed in table 2 which total 10 000 simulations these parameter values are arbitrary and do not represent any specific values from the real world we systematically varied these parameters to test whether lethalgeometry produces consistent results independent of any particular settings specifically we allowed cell growth rate movement cost birth cost and aggression cost to vary across simulations between 0 and 10 including combinations of variables in which there is a ten fold difference in energy we ran these simulations for 1000 steps to allow enough time for a representative sample of territory sizes to emerge we set number of groups to 10 to promote enough intergroup aggression for each simulation we recorded the demography of each group still in existence at the end of 1000 steps recorded variables are listed in table 1 simulation data is stored in file s2 2 3 empirical data chimpanzees we analyzed a subset of a larger dataset on lethal aggression in chimpanzees from 18 different study communities in long term study sites across africa wilson et al 2014 we excluded two of these communities bossou and kyambura from analysis because they are isolated from other chimpanzee communities providing a sample size of n 16 communities file s3 for each community this study provided data on the number of individuals known inferred and suspected have been killed during intergroup attacks as well as data on the number of years of observation and each community s mean population size and territory size during the study period 2 4 empirical data wolves we used data for 42 wolf packs in yellowstone national park usa cassidy et al 2015 from 1995 to 2018 file s4 each year the yellowstone wolf project collected data on the number of wolves per pack and intraspecific deaths and estimated territory sizes based on radio collar data more detailed information on methods for data collection is described in cassidy et al 2015 2 5 statistical analyses we conducted statistical tests using r 4 0 2 and performed regressions using generalized linear mixed models glmms available in the lme4 r package file s5 bates et al 2007 as described in the conceptual model the reciprocal centroid distance of the territory is equivalent to the periphery area ratio and 1 r where r the radius of a circle with the same area as the group or community s home range 2 5 1 agent based model using simulation data from the agent based model we tested for the effects of geometry on mortality and fertility as the data represented counts of deaths and births we performed poisson glmms with 1 group death count as the dependent variable and 2 group birth count as the dependent variable and periphery area ratio as the independent variable in both cases to model the rates instead of the counts we used log group population size as an offset to obtain per capita mortality and fertility we adjusted for confounding effects of the initial parameter settings table 2 by using them as random effects in the poisson regressions 2 5 2 chimpanzees as the dependent variable we used the number of victims of intergroup killing per community cases were placed into one of three categories based on the quality of evidence observed intergroup killing was directly witnessed by observers inferred intergroup killing was determined to have taken place based on compelling evidence such as the discovery of a body with injuries typical of chimpanzee attack in an area and context consistent with intergroup aggression and suspected intergroup killing was thought to have taken place based on circumstantial evidence such as the sudden disappearance of a seemingly healthy adult male given that males unlike females do not disperse from their natal community we conducted two sets of analyses 1 those restricted to the cases with strongest evidence observed and inferred n 19 intergroup deaths and 2 all cases including suspected cases n 44 intergroup deaths to provide an upper bound of killings for each community to control for observation time and population size we calculated the number of chimp years per community defined as the mean number of individuals per community per year times the number of years that community was observed to test whether territory size predicted mortality from intergroup aggression we conducted poisson regressions with log chimp years as an offset previous analysis of the full dataset wilson et al 2014 revealed two variables associated with increased rates of lethal aggression males mean number of males 12 years old and density mean number of individuals per community home range km2 this previous analysis included all killings including within group killings and intergroup killings conducted by the study community in the present study we focused on the subset of cases in which a member of the study community was known or suspected to have been killed by members of another community to investigate whether territory size provides additional explanatory power beyond those variables already identified we used information theoretic model selection approach following the recommendations outlined in burnham and anderson 2002 we examined the set of models consisting of all combinations of these variables excluding interactions which allowed us to examine the relative importance of each of three independent variables males density and 1 r where r the radius of a circle with the same area as the community s home range each model consisted of a poisson regression with the total count of victims of intergroup aggression per community as the dependent variable and log chimp years as an offset we tested eight models including the null model models with each variable by itself the three possible combinations of two variables and the full model we corrected for overdispersion and small sample size using qaicc ranked models according to qaicc score lowest best and used results from all models to calculate model averaged estimates of parameters 2 5 3 wolves we performed poisson glmms with intraspecific death count as the dependent variable and 1 r as the independent variable we weighted the log likelihood with the number of locations used to estimate the territory sizes as territory size estimates obtained using more locations are likely more reliable using the weights argument in the glmer function in the lme4 r package bates et al 2007 this places more weight on the observations with more reliable territory size estimates we estimated death count in three ways 1 deaths of all individuals including estimates of litter deaths 2 deaths of individuals greater than 2 months old with any non zero litter deaths counted as one individual and 3 deaths of individuals greater than 2 months only excluding all litter deaths to model the mortality rates instead of the counts we used log average pack size as an offset to obtain per capita mortality we calculated the average pack size based on the april 1 census value and the december 31 census value of the previous year this average closely matches a winter estimate when most of the aggressive encounters occur we adjusted for the confounding effects of observation year and pack identity by using them as random effects in the poisson regressions and of the number of radio collars present in each pack by using it as a fixed effect in the regressions 3 results 3 1 simulation output consistent with predictions from the conceptual model in the agent based model per capita mortality rate was higher in smaller territories and lower in larger territories fig 3b analysis of lethalgeometry simulation output revealed a positive relationship between per capita mortality rate and periphery area ratio table 3 with 0s β 0 26 se 0 0058 95 ci 0 25 0 27 0s removed β 0 26 se 0 0058 95 ci 0 25 0 28 to further understand the demographic ramifications of these results we also analyzed the relationship between territory size and fertility rates our analysis showed a negative relationship between per capita birth rate and periphery area ratio table 3 with 0s β 0 039 se 0 0057 95 ci 0 050 0 027 0s removed β 0 040 se 0 0057 95 ci 0 051 0 029 these results indicate that per capita fertility rate was higher in larger territories and lower in smaller territories these results are robust across a range of parameters table 2 because territories in lethalgeometry were not constrained to be contiguous or of any particular size or shape the effect of territory size on mortality rates is robust to departures from assumptions of the conceptual model fig 3a 3 2 empirical data chimpanzees the results of the chimpanzee empirical data concurred with the simulation results per capita mortality in chimpanzees declined with increasing territory size as measured by the reciprocal centroid distance fig 3c considering the models with data restricted to observed and inferred cases the best four models were those that included 1 r which had a strong effect on intergroup mortality rate tables 4 s1 model averaged β 13 se 3 0 95 ci 7 1 19 of the other two variables the model averaged parameter for males was positive β 0 12 se 0 062 95 ci 0 059 0 23 while density had a negative association with mortality rate β 0 54 se 0 26 95 ci 1 0 0 18 as noted the 95 confidence intervals of all these parameters excluded zero this result is sensitive however to the inclusion of one community with an extremely high rate of intergroup mortality kahama excluding kahama the 95 confidence interval of the model averaged estimates for all three parameters males density and 1 r included zero the best model was the one that included only 1 r model weight 0 33 table s2 but this was only slightly better than the null model model weight 0 31 δqaicc 0 14 table s2 including the suspected cases the top 4 models were again those that included 1 r which remained strongly associated with intergroup mortality rate tables 4 s3 β 7 7 se 2 0 95 ci 4 0 12 the results remained consistent even after excluding kahama as the 95 confidence interval of the model averaged estimate of 1 r excluded zero table 4 β 1 5 se 2 1 95 ci 0 27 7 3 the best model was the null model model weight 0 36 table s4 but equivalent to the model with 1 r model weight 0 23 δqaicc 0 96 table s4 combined these results are consistent with the view that 1 r is positively associated with intergroup mortality rate 3 3 empirical data wolves the results of the wolf empirical data also corresponded with the simulation results per capita mortality in wolves declined with increasing territory size fig 3d analysis of the empirical data revealed a positive relationship between per capita mortality rate and inverse radius all individuals table 5 with 0s β 6 1 se 0 27 95 ci 5 6 6 6 0s removed β 8 5 se 0 54 95 ci 7 4 9 5 individuals 2 months and litters as 1 individual table 5 with 0s β 4 8 se 0 27 95 ci 4 3 5 3 0s removed β 6 0 se 0 61 95 ci 4 8 7 2 individuals 2 months excluding litter deaths table 5 with 0s β 4 3 se 0 27 95 ci 3 8 4 9 0s removed β 5 2 se 0 62 95 ci 4 0 6 4 4 discussion agent based models may have a reputation of being black boxes that can be manipulated to produce any result to support the hypothesis topping et al 2010 implementing a robust set of validation tests increases the likelihood that a model can advance scientific understanding rather than simply confirm researchers pre existing biases in this study we present a case study of model validation on lethalgeometry an agent based model designed to explore the relationship between territory size and mortality and fertility rate here we summarize the step by step validation process for lethalgeometry first we included a description of the conceptual model as given in section 2 1 which includes both a verbal and mathematical description of the logical assumptions these descriptions allow the conceptual model of lethalgeometry to undergo the peer review process for scrutiny by others second we described the model settings that are taken from real world measurements which is straightforward in lethalgeometry there are no parameters settings that are directly influenced by any target system for example we did not impose a particular birth rate based on data from chimpanzees or wolves instead we set parameters to arbitrary settings and ran simulations that swept across these parameters additionally the qualitative assumptions are as basic as possible we know that animals eat food for energy which they sometimes use to reproduce and which they also need to survive we also know that animals can be lethally aggressive and that aggressive acts can sometimes lead to death the rules in the model code follow these general principles third we focused on whether or not the model was built correctly lethalgeometry is a netlogo model with only 199 lines of code excluding the lines of code for data collection and validation the compactness of the code inherently made it easier to check for logical errors we performed multiple line by line checks of the code for such errors additionally we conducted a series of dynamic verification checks to determine if the emergent phenomena were operating within expected bounds file s6 furthermore we included the complete lethalgeometry code for others to examine verify and improve file s1 fourth we made predictions from the conceptual model that we expected to emerge in the agent based model simulation output reiterating our main findings we expected that the inverse relationship between territory size and mortality would hold for a range of parameter settings fig 3b which we found was statistically supported in section 3 1 fifth we ran multiple simulations using parameter settings that sweep across the parameter space we chose combinations of values that explore a range of relevant scenarios beyond what would be expected from chimpanzees and wolves alone thus we can be reasonably assured that our model can be more generally applied to a broad range of territorial species with intergroup killing sixth we performed retrodictive corroboration the chimpanzee data were known to the authors before model development began but had not yet been analyzed with respect to territory size fig 3c after we constructed the lethalgeometry we also investigated the geometrical effects of territory size in another species wolves to further corroborate our findings fig 3d both sets of empirical data supported our findings from lethalgeometry both visually and statistically mortality risk from intergroup aggression is inversely related to territory size while we can never be certain that lethalgeometry or any other agent based model is working without error box 1979 these consilience checks provide a way to find faults in a model and when no fault is found give more credence to the model s accuracy therefore we have confidence that the results from this study generalize to other systems and also that we can use lethalgeometry for further investigation in addition to tracking mortality we also tracked fertility and found a positive relationship between territory size and fertility while we have not yet attempted to test the fertility result empirically our validation process provides more confidence that under appropriate conditions the geometry of larger territories can result in increased total fertility as well as lower per capita mortality our validated model supports the hypothesis that in species with lethal intergroup aggression one basic aspect of territory geometry size has strong effects on mortality and may also impact reproduction in larger territories individuals are less likely to die from intergroup aggression and therefore live longer and as a result have higher lifetime reproductive success thus as territory size increases territory owners experience a virtuous cycle of benefits lower mortality risk which results in higher overall reproductive rate which in turn increases the fighting ability of the group which enables them to expand their territory conversely decreases in territory size result in negative feedback increasing mortality risk decreasing reproductive rate resulting in decreasing fighting ability frequently resulting in an irreversible spiral towards group extinction as a result of these positive and negative feedback processes during the course of running the model the number of groups generally decreased in number and if enough time were allowed one single group eventually dominated the entire environment when individuals are drawn randomly with identical average properties which groups expand and which contract is random independent of any specific differences in the individuals in the group this phenomenon is also observed in empirical animal studies in gombe national park the kasekela community of chimpanzees has greatly expanded at the expense of the neighboring mitumba and kalande communities and by 2012 occupied more than half the total park area wilson 2012 in the wolves at yellowstone national park larger packs have been observed to achieve higher fertility and expand their territory range at the expense of smaller packs smith and guernsey 2002 whether animals defend their home ranges as territories depends on whether territory defense is economical mitani and rodman 1979 found that primates were more likely to be described by observers as territorial when their daily travel distance exceeded the diameter of their home ranges in humans technological advances have greatly increased travel efficiency improved transportation technology likely contributes to a well recognized phenomenon over the course of human history the maximum size of group territories has increased enormously turchin and gavrilets 2009 hunter gatherer bands have home ranges that cover a median 175 km2 marlowe 2005 early states controlled much larger territories and the maximum territory size of empires increased dramatically at several key stages in history turchin and gavrilets 2009 during this time improvements in transportation included such innovations as boats sailing ships use of domesticated horses to pull wheeled vehicles and carry riders roads trains cars and air travel vast increases in the speed of communication once telegraph and other electronic media developed also made defending larger territories possible and economical headrick 2009 as territory size has increased people living within these larger territories have been increasingly able to reap the benefits of being far from the border areas where intergroup aggression is mostly likely to occur population size may also contribute to these benefits as larger communities appear less vulnerable to lethal aggression falk and hildebolt 2017 pinker 2011 presents evidence that per capita deaths from warfare have generally declined in recent centuries and millennia even taking into account the exceptional devastation of the world wars of the 20th century insofar as this is the case increases in the territorial size of states may help protect people from intergroup killing at least prior to the development of military aircraft and missiles the lethalgeometry model offers insight into the inverse relationship between territory size and both mortality risk and fertility benefit this model is generalized to apply to organisms that are both territorial and lethally aggressive including humans further investigation could provide insights into territorial expansion and the rise of states turchin and gavrilets 2009 however one tradeoff in a generalized model is that it does not include specific features of interest about a target system another direction could be to add species specific details that provide additional information about the impact of lethal aggression for that species b3get is an agent based model that offers the ability to explore territorial behavior while also incorporating species specific details into the behaviors of agents crouse 2021 crouse and colleagues 2019 used a previous model version to investigate how male baboon reproductive strategies vary with female group size they modeled male and female baboons with genotypes that coded for behaviors related to mating fighting and transferring between groups among others the latest version of b3get allows the user to dynamically track territory shapes and sizes in a similar way to lethalgeometry crouse 2021 using b3get it is possible to create virtual populations that include behaviors and attributes of real world species such as specifying mating preferences to be monogamous as in wolves or polygynandrous as in chimpanzees using species specific agents could provide additional information about the relationship between territory size and mortality risk and what other factors might be important an additional direction of this research would be to apply our model validation framework to other models including b3get b3get is built as a generalized model of animal behavior and so the target system includes many possible species the greater number of species creates a greater pool of conceptual models and empirical data enabling us to apply validation tests in multiple ways 5 conclusions the practice of agent based model validation has historically been underrepresented in the scientific literature in this paper we add to recent efforts in developing model validation frameworks our validation framework design aids modelers by making explicit comparisons among each element of the modeling cycle and focuses on the assumptions the modeler makes in transitioning from one element to another by refocusing attention on these specific goals we offer an improved way to operationalize the model validation process we used this framework to investigate lethalgeometry a basic model of lethally aggressive agents with dynamically changing territory boundaries shapes and sizes lethalgeometry provided three main advantages to the conceptual model alone first it tests whether the effect of territory size on intergroup mortality risk depends on the assumption that territories consist of simple convex polygons second it tests whether the predicted effect depends on the assumption that intergroup killings occur mainly in the periphery third it tests the hypothesis that reductions in intergroup mortality risk also result in increased fertility something for which we do not have sufficiently detailed empirical data to test by using both a mathematical conceptual model and empirical data from two lethally aggressive species chimpanzees and wolves we were able to analyze lethalgeometry from many different perspectives this validation provides confidence in our findings on the impact of territory size on group demography overall we found that territory size positively impacts fertility and negatively impacts mortality which may lead to a virtuous cycle of benefits in some species including humans credit authorship contribution statement kristin n crouse software validation writing original draft writing review editing visualization nisarg p desai writing review editing formal analysis kira a cassidy investigation data curation writing review editing erin e stahler investigation data curation writing review editing clarence l lehman conceptualization writing review editing michael l wilson conceptualization methodology investigation data curation writing original draft writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study analyzes previously published chimpanzee data collection of these data depended on funding from many different sources with the permission of authorities in many different countries but no new chimpanzee data were collected for this project the wolf data were collected as part of the long term monitoring of wolves in yellowstone national park this project is supported by the national park service yellowstone forever and many generous donors to wolf research in yellowstone national park the authors also appreciate the tireless efforts by many volunteer observation crews and the safe piloting of roger stradley from gallatin flying service mark packila of wildlife air llc bob hawkins from hawkins and powers inc and sky aviation inc and jim pope and crew from leading edge aviation llc we thank members of the university of minnesota behavior group the primate ecology lab at harvard university and nimbios workshop on evolution and warfare at the university of tennessee for helpful feedback on earlier presentations of these results and the institute for advanced study in toulouse iast for funding to m l w from the french national research agency anr under grant anr 17 eure 0010 investissements d avenir program supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 110063 appendix supplementary materials image application 1 image application 2 image application 3 image application 4 image application 5 image application 6 image application 7 
24404,befana is a free and open source software tool for ecological network analysis and visualisation it is adapted to ecologists needs and allows them to study the topology and dynamics of ecological networks as well as to apply selected machine learning algorithms befana is implemented in python and structured as an ordered collection of interactive computational notebooks it relies on widely used open source libraries and aims to achieve simplicity interactivity and extensibility befana provides methods and implementations for data loading and pre processing network analysis and interactive visualisation modelling with experimental data and predictive modelling with machine learning we showcase befana through a concrete example of a detrital soil food web of one agricultural grassland and demonstrate all of its main components and functionalities keywords biodiversity ecology ecosystem food web graph theory soil ecology machine learning open source software data availability the data has been shared http dx doi org 10 5061 dryad t5347 1 introduction unsustainable use of natural resources have been compelling the scientific community to turn its interest to biodiversity loss in general and to negative cascading effects in particular several works concerning ecological networks have been published 1 1 443 papers recorded on web of science as of february 15th 2022 using the specific query ak ecological network and ab ecological network and ti ecological network not ak social but too few of them are mechanistic and predictive despite the plea by ings et al 2009 on the other hand online dataset collections and international research interest is rapidly growing especially for soil organisms van den hoogen et al 2020 phillips et al 2021 data on the ecological interactions in food webs are generally represented in four different ways i resource to consumer food web where the structural model is either static or dynamic with directed graphs flow for functional groups emphasising energy channels loops biomass and nutrient cycling hunt and wall 2002 fitter 2005 mulder et al 2005 ii allometric scaling size spectra where the resulting power law is often environmentally driven showing triangular plots for taxa trophic generality and vulnerability trophic heights assimilation efficiency addressing stoichiometric imbalances reuman and cohen 2004 mulder and elser 2009 iii topological networks with a static biopyramid for species trophospecies and or functional groups emphasising structural biodiversity size delimited pathways nested hierarchy and or parasitism cohen et al 2003 cohen et al 2009 hudson et al 2013 mulder et al 2005 and finally iv interaction networks for species trophospecies and or functional groups focusing on connectance complexity trophic transfer efficiency self damping distribution of trophic links and chain lengths magnitude of feeding relationships etc reuman and cohen 2004 kondoh et al 2010 bascompte and jordano 2007 this work presents befana a free and open source software tool suitable for ecological network analysis and visualisation for resource to consumer food webs and topological and interaction networks the aforementioned architectural types i iii and iv it allows the ecologist to study the topology of the network and its temporal dynamics identify indirect interactions and more ease of use interactivity and extensibility were the main guidelines when designing and developing befana as a result befana is implemented as a collection of interactive computational notebooks and relies on widely used open source libraries for network analysis data science and machine learning befana is available through a public web interface as well as a docker container and local installation 2 2 mybinder https mybinder org v2 gh martinmarzi befana head github https github com martinmarzi befana the rest of the paper showcases selected parts of befana through a case study of detrital soil food web analysis 2 software design and implementation 2 1 overview the design of befana fig 1 follows the latest advances in developing and sharing of scientific software it is based on the computational notebook paradigm and follows the batteries included philosophy by providing integration of libraries a user might need in ecological network analysis as such befana is an interactive software tool but also a solid base for creating custom applications and experiments in this and related domains befana is implemented in the python programming language which has become a de facto language of choice for scientific computing perez and granger 2007 in combination with jupyterlab an interactive development environment for computational notebooks i e jupyter notebooks and pandas mckinney 2010 a python library for data manipulation and analysis offering optimised data structures and functions it forms one of the best approaches to the dissemination of scientific programs experiments data manipulation and interactive computational notebooks befana is based on an open source software stack which helps to achieve the following three goals a ease of use b interactivity and c extensibility the libraries currently included in befana cover the following topics data input and output pre processing and manipulation charting web based graphical user interfaces network analysis and visualisation and machine learning it is an open collection as any other libraries can be applied in befana notebooks as long as they implement an interface to the python interpreter or are available as a web service or a command line tool even though it is common for computational notebooks to be run locally befana goes a step further and also provides a public web interface through mybinder org a free public service which provides a community led infrastructure deploying the binderhub technology project jupyter et al 2018 which allows sharing of interactive code local installation of befana is possible using docker or by creating a virtual python environment where befana can be started 2 2 software capabilities befana is a software tool for ecological network analysis and visualisation that allows to study the topology and dynamics of ecological networks as well as to apply selected machine learning algorithms its computational notebooks code interface and results including diagrams and graphics interweave and offer a uniquely rich user experience befana can be used to demonstrate some particular implementation to showcase an example to share charts with results or to provide network visualisations the software has been developed specifically for the purpose of soil food web analysis but can be easily adapted and extended for the analysis of other types of networks as well the logical organisation of its functionalities is as follows 2 2 1 data loading and pre processing befana supports several different input formats including csv excel access and hdf the data is parsed and loaded into a high performance data structure which supports advanced data selection and manipulation if the input data requires pre processing steps such as imputation filtering resampling computing values etc this is the right place to apply them 2 2 2 network construction the data from which a network is constructed can be provided in several different ways for example a the network can be loaded from a file in one of supported network description languages e g pajek gml json b it can be built in the python code by adding nodes and links manually c it can be constructed from a data structure such as the adjacency matrix or adjacency list 2 2 3 interactive network visualisation one of the strongest features of befana is its interactive visualisation of hierarchical networks in ecosystem network analysis visualisation is an essential tool for understanding the structure of the network the interrelations between nodes of interest and for hypothesis formation befana implements interactive visualisation of ecological networks and responds to user events such as zoom and drag a network can be visualised either inline in the notebook or in a new browser tab inline visualisation follows the computational notebook paradigm and displays a preview of the network and few customization options in a notebook cell while the advanced visualisation in a new tab offers a multitude of options such as colours shapes sizes fonts layouts and their optimization parameters etc befana s visualisation also enables modelling the relationship between network topology and network dynamics which has implications in understanding stability and resilience of trophic networks dale 2017 the graphical user interface implements network editing which allows for network modification and analysis cycles users can remove certain nodes or edges of a soil food web and then visualise the modified network to assess the extent to which the investigated ecosystem will become destabilised c l murall mccann and bauch 2012 for instance by functional biodiversity decline conti et al 2020 this loss of nodes will impact the subsequent calculations and will enable us to forecast various scenarios of biodiversity loss 2 2 4 network analysis befana offers network analysis methods that characterise the form of the ecological network and determine how the functioning of the network affects its structure dale 2017 while species interactions are central graph theory can also reveal higher level guild to guild interactions such as how topology of such networks also interacts with the functioning of the ecological system various centrality measures are implemented that give insight on the nodes edges topological position and role within the network the out in degree ratio van den brink and rusinowska 2021 can be calculated which assigns to every node in a directed graph its out degree divided by its in degree to avoid dividing by zero 1 is added to both the out as well as in degree of every node it can be used for ranking nodes in a directed graph this measure is similar to the well known copeland score for ranked voting but can give different results in certain situations compartment and motif analysis is available that can reveal common repeated structural elements e g transitive triangle motifs and how clearly separable such compartments are strongly connected components can be identified and in order to discover meaningful subgraphs clustering within the network can be performed the results of clustering node partitioning can also be used in befana s network visualisation see fig 2 an important advantage of using befana on ecological networks is its ability to identify the existence and strengths of indirect interactions that are derived from the existing trophic network befana implements the discovery and visualisation of two types of derived networks 1 with shared consumer and 2 with shared resource 2 2 5 network enrichment and modelling with experimental data befana allows the user to embed experimental or field data on the network structure which can provide insight on the dynamics of the studied ecosystem the network data structure allows for an unlimited number of attributes to be assigned to nodes and links attributes can also be used in computations provided by the networkx library where applicable simply by providing the name of the relevant attribute befana also implements quantitative comparison of ranked lists using the rank biased overlap rbo measure webber et al 2010 which measures the similarity of potentially infinite ranked lists it has one parameter p which determines how top weighted the rbo measure is the smaller p the more it is top weighted rbo is useful when comparing lists of elements nodes trophic groups edges etc ranked according to the value of a selected attribute such as biomass for example 2 2 6 predictive modelling with machine learning to employ network data in predictive and descriptive machine learning tasks e g classification link prediction clustering graph evolution the data nodes edges has to be represented as numerical vectors or node embeddings befana offers node2vec which is one of the recent machine learning algorithms that can learn a mapping from nodes to a dense feature space while maximising the likelihood of preserving network neighbourhoods of nodes grover and leskovec 2016 2 3 launching befana the easiest and recommended way to work with befana is to use the public binder link 3 3 mybinder https mybinder org v2 gh martinmarzi befana head local deployment using docker or a python virtual environment is recommended for advanced users moreover befana includes already computed results of the presented soil food web use case for each notebook all befana notebooks ensure that the required libraries are installed prior to executing any code 3 tool demonstration through soil food web analysis in this section we demonstrate the application of befana on a case of a soil food web data where we quantify and analyse the hierarchical characteristics of the trophic network at hand a hierarchical directed graph has been constructed representing the detrital soil food web using one regional metaweb of all possible literature based multitrophic links from a local pool of food webs mulder et al 2005 sechi et al 2015 the complete analysis consists of the following steps 3 1 loading the data the input data is loaded as a csv file with headers and a custom separator two csv files are loaded 1 an interaction network soil food web in the form of an adjacency matrix and 2 trophic levels of the trophic groups 3 2 network construction the network is constructed from the adjacency matrix of the metaweb encompassing three local plots hereafter called a b and c sechi et al 2015 and the hierarchical structure is obtained from the uploaded trophic levels no editing on the network has been performed 3 3 network visualisation and exploration next the constructed network is visualised as shown in fig 2 trophic levels define the layers of the network while the colouring of nodes provides a visualisation of their functional roles nodes represent trophic groups and their links to the resources for example plant roots are present at the bottom and provide food for plant feeding nematodes generalist mites omnivore nematodes and a number of other trophic groups in this way omnivores and top predators that consume from more than one node and or more than one trophic level are easily recognizable colouring can be done either at functional level e g according to an in degree clustering rule as presented in the network analysis section or at taxonomic level for instance different colours at the kingdom level the numbers prefixing node names are functional codes for trophic nodes the first digit provides information on the dominant feeding strategy while the second digit provides cladistic information 3 4 network analysis in the next step various network analysis methods are applied that help to characterise the soil food web and help determine how the functioning of the network affects its structure 3 4 1 network characteristics in the first stage of network analysis keystone trophic groups and connections that have a disproportionate effect on the network function are identified through the combination of various centrality measures that give insight on the nodes edges topological position and role within the network in a similar way to cheddar hudson et al 2013 each measure provides different insights on trophic node s properties or position in the ecological network next the out in degree ratio van den brink and rusinowska 2021 has been calculated and all nodes have been ranked interestingly in our soil food web structure one node from the second trophic level bacterivore nematodes is ranked the same as one of the primary resources fungi and higher than other second level nodes 3 4 2 compartment and motif analysis in the next stage the soil food web is analysed for common repeated structural elements and how clearly separable such compartments are pairs of nodes with reciprocal link are identified which also includes cannibalistic relationships for example our soil food web contains 9 reciprocal trophic interactions interspecific loops of which 5 are cannibalistic intraspecific loops mostly occurring at higher trophic levels all transitive triangle motifs are also discovered and an example is visualised in fig 3 transitivity depends on directional interactions and is related to the consistency of relationships amongst nodes dale 2017 thus transitive triangles hint on the stability of the trophic network as they demonstrate the presence of more stable combinations of trophic interactions where a trophic group has more than one resource our soil metaweb contains 122 triangles describing transitive relationships strongly connected components can give an indication about the energy flow within the network interestingly our soil food web contains exactly one strongly connected component spanning three nodes which is shown in fig 3 moreover this component embedding only groups from trophic level 4 also contains 8 out of 9 possible links which implies a very high resistance to biodiversity loss as such it contains a cycle spanning all three nodes two cycles spanning two nodes reciprocal links and three loops all three trophic groups are cannibalists one of the trophic groups is a generalist consumer while the other two are predators finally clustering within the network is performed for example in degree based node clustering into three clusters where indegree is either 0 1 or greater than 1 yields clusters as shown in fig 2 such clustering separates trophic groups with energy sources from outside of the network highly vulnerable trophic groups having only one source of energy and less vulnerable having more than one source of energy with the exception of substrate ingesting earthworms bacterivore enchytraeid and bacterivore amoebae all trophic groups on the first level are vulnerable in contrast to trophic groups on the second and third trophic level the average indegree is 8 2 3 4 3 derived networks in this step the discovery and visualisation of two types of derived networks is carried out 1 with shared consumer and 2 with shared resource in the analysed soil food web 1 was very connected with 83 of nodes linking to over 60 of all the nodes in 2 on the other hand centrality trends in the derived soil food network were clearer only three nodes had a degree centrality over 60 omnivore nematode generalist mite and omnivore mite 3 5 modelling with experimental data at this stage field data such as aggregated biomass mass and abundance are computed per trophic group and added to the network as node attributes this allows for easy computation of the total biomass for each of the trophic levels next rankings of trophic groups by abundance for each of the trophic levels are calculcated and plotted after that a ranked list of trophic groups by biomass values for all three plots is produced then this ranked list is compared using the rank biased overlap rbo measure regardless of the value of the top weightedness parameter p plot a is always the most similar to plot c the least similar are plots a and b if rbo is top weighted low p or plots b and c if the tails of the biomass value lists are also considered in the comparison high p the rbo based similarity of all three plots using different values of p is shown in fig 4 other trophic groups rank differently according to the plot and two are not even occurring in all plots as shown in fig 5 earthworms and the three main resources for the plant driven pathway the bacterial driven pathway and the fungal driven pathway exhibit the highest biomass values in each of the three plots of the investigated metaweb it is worth mentioning that all groups in common in all separate food webs share a very low coefficient of variation cv less than 25 in contrast to the group ranked as 21st that although occupying the same rank according to its biomass values shares a cv higher than 100 3 6 representation learning in the last stage of the analysis befana s representation learning functionality is applied on the derived network as described above the results demonstrate that the topological information is indeed encoded in node embeddings and the dimensionality reduction followed by the visualisation in 1d space gives a clearer indication of node similarity as can be seen in fig 6 four trophic groups grouped on the far left are the only nodes at trophic level 1 sharing fungi as resource bacterivores on the other hand are present and mostly grouped on the right side of the visualization 4 conclusion and future development the paper presentsed befana a free and open source software tool for ecological network visualisation and analysis it allows ecologists to apply graph theory and machine learning algorithms on ecological networks that can help quantifying and testing hypotheses about how a network s topology affects its dynamics and how the functioning of the network in turn affects its structure in the future work we plan to upgrade befana regularly with new features implementations and datasets a particular focus will be on machine learning methods optimised for ecological networks experimental data is important in ecological analysis and to make use of them machine learning algorithms need to incorporate node and or edge attributes while the hierarchical structure of our soil food web makes it unsuitable for representation learning methods we envision that node embeddings for other types of interaction networks could well be used to predict links when simulating ecological network disruptions data availability dryad data http dx doi org 10 5061 dryad t5347 credit authorship contribution statement martin marzidovšek conceptualization formal analysis software visualization writing original draft writing review editing vid podpečan conceptualization formal analysis software visualization supervision writing original draft writing review editing erminia conti data curation methodology resources validation writing original draft marko debeljak conceptualization formal analysis investigation project administration christian mulder conceptualization data curation investigation methodology resources supervision writing review editing declaration of competing interest nothing to declare the authors declare the following financial interests personal relationships which may be considered as potential competing interests martin marzidovsek reports financial support was provided by jozef stefan institute acknowledgements this work has been supported by cost action 18237 and project h2020 project embeddia 825153 we thank prof dr nada lavrač for her kind support 
24404,befana is a free and open source software tool for ecological network analysis and visualisation it is adapted to ecologists needs and allows them to study the topology and dynamics of ecological networks as well as to apply selected machine learning algorithms befana is implemented in python and structured as an ordered collection of interactive computational notebooks it relies on widely used open source libraries and aims to achieve simplicity interactivity and extensibility befana provides methods and implementations for data loading and pre processing network analysis and interactive visualisation modelling with experimental data and predictive modelling with machine learning we showcase befana through a concrete example of a detrital soil food web of one agricultural grassland and demonstrate all of its main components and functionalities keywords biodiversity ecology ecosystem food web graph theory soil ecology machine learning open source software data availability the data has been shared http dx doi org 10 5061 dryad t5347 1 introduction unsustainable use of natural resources have been compelling the scientific community to turn its interest to biodiversity loss in general and to negative cascading effects in particular several works concerning ecological networks have been published 1 1 443 papers recorded on web of science as of february 15th 2022 using the specific query ak ecological network and ab ecological network and ti ecological network not ak social but too few of them are mechanistic and predictive despite the plea by ings et al 2009 on the other hand online dataset collections and international research interest is rapidly growing especially for soil organisms van den hoogen et al 2020 phillips et al 2021 data on the ecological interactions in food webs are generally represented in four different ways i resource to consumer food web where the structural model is either static or dynamic with directed graphs flow for functional groups emphasising energy channels loops biomass and nutrient cycling hunt and wall 2002 fitter 2005 mulder et al 2005 ii allometric scaling size spectra where the resulting power law is often environmentally driven showing triangular plots for taxa trophic generality and vulnerability trophic heights assimilation efficiency addressing stoichiometric imbalances reuman and cohen 2004 mulder and elser 2009 iii topological networks with a static biopyramid for species trophospecies and or functional groups emphasising structural biodiversity size delimited pathways nested hierarchy and or parasitism cohen et al 2003 cohen et al 2009 hudson et al 2013 mulder et al 2005 and finally iv interaction networks for species trophospecies and or functional groups focusing on connectance complexity trophic transfer efficiency self damping distribution of trophic links and chain lengths magnitude of feeding relationships etc reuman and cohen 2004 kondoh et al 2010 bascompte and jordano 2007 this work presents befana a free and open source software tool suitable for ecological network analysis and visualisation for resource to consumer food webs and topological and interaction networks the aforementioned architectural types i iii and iv it allows the ecologist to study the topology of the network and its temporal dynamics identify indirect interactions and more ease of use interactivity and extensibility were the main guidelines when designing and developing befana as a result befana is implemented as a collection of interactive computational notebooks and relies on widely used open source libraries for network analysis data science and machine learning befana is available through a public web interface as well as a docker container and local installation 2 2 mybinder https mybinder org v2 gh martinmarzi befana head github https github com martinmarzi befana the rest of the paper showcases selected parts of befana through a case study of detrital soil food web analysis 2 software design and implementation 2 1 overview the design of befana fig 1 follows the latest advances in developing and sharing of scientific software it is based on the computational notebook paradigm and follows the batteries included philosophy by providing integration of libraries a user might need in ecological network analysis as such befana is an interactive software tool but also a solid base for creating custom applications and experiments in this and related domains befana is implemented in the python programming language which has become a de facto language of choice for scientific computing perez and granger 2007 in combination with jupyterlab an interactive development environment for computational notebooks i e jupyter notebooks and pandas mckinney 2010 a python library for data manipulation and analysis offering optimised data structures and functions it forms one of the best approaches to the dissemination of scientific programs experiments data manipulation and interactive computational notebooks befana is based on an open source software stack which helps to achieve the following three goals a ease of use b interactivity and c extensibility the libraries currently included in befana cover the following topics data input and output pre processing and manipulation charting web based graphical user interfaces network analysis and visualisation and machine learning it is an open collection as any other libraries can be applied in befana notebooks as long as they implement an interface to the python interpreter or are available as a web service or a command line tool even though it is common for computational notebooks to be run locally befana goes a step further and also provides a public web interface through mybinder org a free public service which provides a community led infrastructure deploying the binderhub technology project jupyter et al 2018 which allows sharing of interactive code local installation of befana is possible using docker or by creating a virtual python environment where befana can be started 2 2 software capabilities befana is a software tool for ecological network analysis and visualisation that allows to study the topology and dynamics of ecological networks as well as to apply selected machine learning algorithms its computational notebooks code interface and results including diagrams and graphics interweave and offer a uniquely rich user experience befana can be used to demonstrate some particular implementation to showcase an example to share charts with results or to provide network visualisations the software has been developed specifically for the purpose of soil food web analysis but can be easily adapted and extended for the analysis of other types of networks as well the logical organisation of its functionalities is as follows 2 2 1 data loading and pre processing befana supports several different input formats including csv excel access and hdf the data is parsed and loaded into a high performance data structure which supports advanced data selection and manipulation if the input data requires pre processing steps such as imputation filtering resampling computing values etc this is the right place to apply them 2 2 2 network construction the data from which a network is constructed can be provided in several different ways for example a the network can be loaded from a file in one of supported network description languages e g pajek gml json b it can be built in the python code by adding nodes and links manually c it can be constructed from a data structure such as the adjacency matrix or adjacency list 2 2 3 interactive network visualisation one of the strongest features of befana is its interactive visualisation of hierarchical networks in ecosystem network analysis visualisation is an essential tool for understanding the structure of the network the interrelations between nodes of interest and for hypothesis formation befana implements interactive visualisation of ecological networks and responds to user events such as zoom and drag a network can be visualised either inline in the notebook or in a new browser tab inline visualisation follows the computational notebook paradigm and displays a preview of the network and few customization options in a notebook cell while the advanced visualisation in a new tab offers a multitude of options such as colours shapes sizes fonts layouts and their optimization parameters etc befana s visualisation also enables modelling the relationship between network topology and network dynamics which has implications in understanding stability and resilience of trophic networks dale 2017 the graphical user interface implements network editing which allows for network modification and analysis cycles users can remove certain nodes or edges of a soil food web and then visualise the modified network to assess the extent to which the investigated ecosystem will become destabilised c l murall mccann and bauch 2012 for instance by functional biodiversity decline conti et al 2020 this loss of nodes will impact the subsequent calculations and will enable us to forecast various scenarios of biodiversity loss 2 2 4 network analysis befana offers network analysis methods that characterise the form of the ecological network and determine how the functioning of the network affects its structure dale 2017 while species interactions are central graph theory can also reveal higher level guild to guild interactions such as how topology of such networks also interacts with the functioning of the ecological system various centrality measures are implemented that give insight on the nodes edges topological position and role within the network the out in degree ratio van den brink and rusinowska 2021 can be calculated which assigns to every node in a directed graph its out degree divided by its in degree to avoid dividing by zero 1 is added to both the out as well as in degree of every node it can be used for ranking nodes in a directed graph this measure is similar to the well known copeland score for ranked voting but can give different results in certain situations compartment and motif analysis is available that can reveal common repeated structural elements e g transitive triangle motifs and how clearly separable such compartments are strongly connected components can be identified and in order to discover meaningful subgraphs clustering within the network can be performed the results of clustering node partitioning can also be used in befana s network visualisation see fig 2 an important advantage of using befana on ecological networks is its ability to identify the existence and strengths of indirect interactions that are derived from the existing trophic network befana implements the discovery and visualisation of two types of derived networks 1 with shared consumer and 2 with shared resource 2 2 5 network enrichment and modelling with experimental data befana allows the user to embed experimental or field data on the network structure which can provide insight on the dynamics of the studied ecosystem the network data structure allows for an unlimited number of attributes to be assigned to nodes and links attributes can also be used in computations provided by the networkx library where applicable simply by providing the name of the relevant attribute befana also implements quantitative comparison of ranked lists using the rank biased overlap rbo measure webber et al 2010 which measures the similarity of potentially infinite ranked lists it has one parameter p which determines how top weighted the rbo measure is the smaller p the more it is top weighted rbo is useful when comparing lists of elements nodes trophic groups edges etc ranked according to the value of a selected attribute such as biomass for example 2 2 6 predictive modelling with machine learning to employ network data in predictive and descriptive machine learning tasks e g classification link prediction clustering graph evolution the data nodes edges has to be represented as numerical vectors or node embeddings befana offers node2vec which is one of the recent machine learning algorithms that can learn a mapping from nodes to a dense feature space while maximising the likelihood of preserving network neighbourhoods of nodes grover and leskovec 2016 2 3 launching befana the easiest and recommended way to work with befana is to use the public binder link 3 3 mybinder https mybinder org v2 gh martinmarzi befana head local deployment using docker or a python virtual environment is recommended for advanced users moreover befana includes already computed results of the presented soil food web use case for each notebook all befana notebooks ensure that the required libraries are installed prior to executing any code 3 tool demonstration through soil food web analysis in this section we demonstrate the application of befana on a case of a soil food web data where we quantify and analyse the hierarchical characteristics of the trophic network at hand a hierarchical directed graph has been constructed representing the detrital soil food web using one regional metaweb of all possible literature based multitrophic links from a local pool of food webs mulder et al 2005 sechi et al 2015 the complete analysis consists of the following steps 3 1 loading the data the input data is loaded as a csv file with headers and a custom separator two csv files are loaded 1 an interaction network soil food web in the form of an adjacency matrix and 2 trophic levels of the trophic groups 3 2 network construction the network is constructed from the adjacency matrix of the metaweb encompassing three local plots hereafter called a b and c sechi et al 2015 and the hierarchical structure is obtained from the uploaded trophic levels no editing on the network has been performed 3 3 network visualisation and exploration next the constructed network is visualised as shown in fig 2 trophic levels define the layers of the network while the colouring of nodes provides a visualisation of their functional roles nodes represent trophic groups and their links to the resources for example plant roots are present at the bottom and provide food for plant feeding nematodes generalist mites omnivore nematodes and a number of other trophic groups in this way omnivores and top predators that consume from more than one node and or more than one trophic level are easily recognizable colouring can be done either at functional level e g according to an in degree clustering rule as presented in the network analysis section or at taxonomic level for instance different colours at the kingdom level the numbers prefixing node names are functional codes for trophic nodes the first digit provides information on the dominant feeding strategy while the second digit provides cladistic information 3 4 network analysis in the next step various network analysis methods are applied that help to characterise the soil food web and help determine how the functioning of the network affects its structure 3 4 1 network characteristics in the first stage of network analysis keystone trophic groups and connections that have a disproportionate effect on the network function are identified through the combination of various centrality measures that give insight on the nodes edges topological position and role within the network in a similar way to cheddar hudson et al 2013 each measure provides different insights on trophic node s properties or position in the ecological network next the out in degree ratio van den brink and rusinowska 2021 has been calculated and all nodes have been ranked interestingly in our soil food web structure one node from the second trophic level bacterivore nematodes is ranked the same as one of the primary resources fungi and higher than other second level nodes 3 4 2 compartment and motif analysis in the next stage the soil food web is analysed for common repeated structural elements and how clearly separable such compartments are pairs of nodes with reciprocal link are identified which also includes cannibalistic relationships for example our soil food web contains 9 reciprocal trophic interactions interspecific loops of which 5 are cannibalistic intraspecific loops mostly occurring at higher trophic levels all transitive triangle motifs are also discovered and an example is visualised in fig 3 transitivity depends on directional interactions and is related to the consistency of relationships amongst nodes dale 2017 thus transitive triangles hint on the stability of the trophic network as they demonstrate the presence of more stable combinations of trophic interactions where a trophic group has more than one resource our soil metaweb contains 122 triangles describing transitive relationships strongly connected components can give an indication about the energy flow within the network interestingly our soil food web contains exactly one strongly connected component spanning three nodes which is shown in fig 3 moreover this component embedding only groups from trophic level 4 also contains 8 out of 9 possible links which implies a very high resistance to biodiversity loss as such it contains a cycle spanning all three nodes two cycles spanning two nodes reciprocal links and three loops all three trophic groups are cannibalists one of the trophic groups is a generalist consumer while the other two are predators finally clustering within the network is performed for example in degree based node clustering into three clusters where indegree is either 0 1 or greater than 1 yields clusters as shown in fig 2 such clustering separates trophic groups with energy sources from outside of the network highly vulnerable trophic groups having only one source of energy and less vulnerable having more than one source of energy with the exception of substrate ingesting earthworms bacterivore enchytraeid and bacterivore amoebae all trophic groups on the first level are vulnerable in contrast to trophic groups on the second and third trophic level the average indegree is 8 2 3 4 3 derived networks in this step the discovery and visualisation of two types of derived networks is carried out 1 with shared consumer and 2 with shared resource in the analysed soil food web 1 was very connected with 83 of nodes linking to over 60 of all the nodes in 2 on the other hand centrality trends in the derived soil food network were clearer only three nodes had a degree centrality over 60 omnivore nematode generalist mite and omnivore mite 3 5 modelling with experimental data at this stage field data such as aggregated biomass mass and abundance are computed per trophic group and added to the network as node attributes this allows for easy computation of the total biomass for each of the trophic levels next rankings of trophic groups by abundance for each of the trophic levels are calculcated and plotted after that a ranked list of trophic groups by biomass values for all three plots is produced then this ranked list is compared using the rank biased overlap rbo measure regardless of the value of the top weightedness parameter p plot a is always the most similar to plot c the least similar are plots a and b if rbo is top weighted low p or plots b and c if the tails of the biomass value lists are also considered in the comparison high p the rbo based similarity of all three plots using different values of p is shown in fig 4 other trophic groups rank differently according to the plot and two are not even occurring in all plots as shown in fig 5 earthworms and the three main resources for the plant driven pathway the bacterial driven pathway and the fungal driven pathway exhibit the highest biomass values in each of the three plots of the investigated metaweb it is worth mentioning that all groups in common in all separate food webs share a very low coefficient of variation cv less than 25 in contrast to the group ranked as 21st that although occupying the same rank according to its biomass values shares a cv higher than 100 3 6 representation learning in the last stage of the analysis befana s representation learning functionality is applied on the derived network as described above the results demonstrate that the topological information is indeed encoded in node embeddings and the dimensionality reduction followed by the visualisation in 1d space gives a clearer indication of node similarity as can be seen in fig 6 four trophic groups grouped on the far left are the only nodes at trophic level 1 sharing fungi as resource bacterivores on the other hand are present and mostly grouped on the right side of the visualization 4 conclusion and future development the paper presentsed befana a free and open source software tool for ecological network visualisation and analysis it allows ecologists to apply graph theory and machine learning algorithms on ecological networks that can help quantifying and testing hypotheses about how a network s topology affects its dynamics and how the functioning of the network in turn affects its structure in the future work we plan to upgrade befana regularly with new features implementations and datasets a particular focus will be on machine learning methods optimised for ecological networks experimental data is important in ecological analysis and to make use of them machine learning algorithms need to incorporate node and or edge attributes while the hierarchical structure of our soil food web makes it unsuitable for representation learning methods we envision that node embeddings for other types of interaction networks could well be used to predict links when simulating ecological network disruptions data availability dryad data http dx doi org 10 5061 dryad t5347 credit authorship contribution statement martin marzidovšek conceptualization formal analysis software visualization writing original draft writing review editing vid podpečan conceptualization formal analysis software visualization supervision writing original draft writing review editing erminia conti data curation methodology resources validation writing original draft marko debeljak conceptualization formal analysis investigation project administration christian mulder conceptualization data curation investigation methodology resources supervision writing review editing declaration of competing interest nothing to declare the authors declare the following financial interests personal relationships which may be considered as potential competing interests martin marzidovsek reports financial support was provided by jozef stefan institute acknowledgements this work has been supported by cost action 18237 and project h2020 project embeddia 825153 we thank prof dr nada lavrač for her kind support 
