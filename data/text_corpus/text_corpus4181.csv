index,text
20905,standards for environmental impact safety and operational performance of ships are becoming increasingly strict in order to meet these standards the performance of new ship designs must be predicted with an increasing level of detail and confidence as present prediction methods lack realistic dynamic behaviour of the ship s propulsion plant there is a need for more advanced methods in this paper an open water test with hardware in the loop hil functionality is proposed hil open water tests combine software and hardware components to emulate realistic behaviour of the ship s propulsion plant in the towing tank it is known however that experiments in the towing tank are subject to viscous scale effects in addition to this shaft dynamics are distorted by a number of scale effects occurring inside the scale model propulsion system in this paper it is demonstrated with measurements that if corrections for these scale effects are applied the dynamic interaction between the propeller and simulated engine system can be accurately emulated in the ship model basin keywords hybrid testing hardware in the loop open water test scale model towing tank marine propulsion 1 introduction during the development of new industrial equipment the designer usually tests a prototype to ensure that it meets a range of requirements first and foremost the requirements on functionality by the end user are generally agreed upon by contract additionally there are regulatory demands on safety while environmental impact during operation too is more and more under scrutiny for large industrial installations however producing a full scale prototype solely for testing is in general prohibitively expensive ships are evident examples of such large installations taking a merchant ship as an example building a full scale prototype is not an option yet there are numerous requirements that need to be satisfied the future owner of a merchant ship for instance will often require that limits of acceptable performance such as ship speed bollard pull and fuel consumption are included in the sales contract at the same time classification societies impose safety requirements by setting standards to structure and machinery while regulatory bodies such as the international maritime organisation imo put limits on the ship s emissions the consequences of not meeting these requirements can be dire so designer and yard generally undertake considerable efforts to predict the performance of a new design moreover as requirements are becoming increasingly strict and hence more difficult to meet there is a need for more holistic prediction methods for operational ship performance than the methods currently available this is quite a challenge interaction between a ship and its environment is a highly complex subject while the systems found on board are becoming increasingly complex too hardware in the loop hil experiments potentially offer the possibility to reproduce complex dynamic behaviour of a full scale ship propulsion system without requiring a full scale prototype also referred to as hybrid tests hil combines physical models or prototypes and numerical simulations into a single test setup in other industries hil is a widespread method to test industrial machinery in the field of power engineering li et al 2006 used hil to evaluate a new control algorithm for wind turbines as another example roinila et al 2019 demonstrated how a hil setup can emulate electrical grids on board aircraft concentrating on the frequency response of power distribution systems hil has already been applied in the maritime field too skjetne and egeland 2006 conducted hil tests for certification of marine control systems while johansen et al 2005 used the same technique to conduct factory acceptance tests of such a system in a similar fashion altosole et al 2007 tested the propulsion control system of aircraft carrier cavour while martelli and figari 2017 described a similar approach concentrating on electrodynamics nounou et al 2018 conducted hil tests on a scale model of the propulsion system of a naval ship they emulated load and drive using two electric motors controlled by simulation models of the ship propeller and propulsion machinery more recently different applications of hil in the context of ship design have been reported including physical models of the ship s hull and environment ueland et al 2018 described a hybrid test in which simulated external forces were applied on a scale model barge in a basin with the aim of studying the forces from mooring lines and associated machinery other than mooring equipment one could also emulate propulsion machinery as was demonstrated by campora and figari 2003 and geertsma et al 2017 ship propulsion system dynamics can be adequately simulated by a numerical model so emulating realistic propulsion plant behaviour seems feasible noting this vrijdag 2016 gave an overview of the possibilities of a hil experiment combining a physical hull and environment and a simulated engine room based on the aforementioned publications huijgens et al 2018 proposed a hil experiment emulating the dynamic behaviour of the ship s propulsion system using a scale model propeller operating in a model basin this setup was introduced as a dynamic open water experiment and is further investigated here dynamic open water experiments are a further development of traditional open water experiments in traditional open water experiments a propeller is moved through undisturbed open water at a constant propeller shaft speed the procedure for such experiments is explained in ittc recommended procedu 2014a in the proposed dynamic open water experiment the electric propulsion motor of the open water setup is controlled by a simulation model of a ship propulsion system this allows to emulate the dynamic response of the ship propulsion system on disturbances at model scale schematic drawings of the full scale propulsion system considered in this paper and the corresponding experimental setup from here on referred to as the hil setup are given in figs 1 and 2 in the full scale ship drive torque is developed by a diesel engine and passed to the propeller through a gearbox fuel injection is governed by a pi shaft speed controller if fluctuations in propeller load torque cause the shaft speed to change the speed controller adjusts the fuel rack setting bringing the shaft speed back to its set value in the hil setup on the other hand drive torque is simulated by a numerical model of the diesel engine and gearbox running on a simulation computer note that this could be any other kind of driving machine the simulated drive torque is communicated to a motor drive which commutates the electric propulsion motor the electric motor in turn drives the scale model propeller the balance of propeller load torque friction torque and motor drive torque results in dynamic response of shaft speed shaft speed is measured and subsequently fed back to the simulation computer using the measured shaft speed and prime mover torque of the previous iteration the combined numerical models of the diesel engine gearbox and shaft speed governor simulate a new torque after which the loop is reiterated to reduce the complexity of the experimental setup ship motions are not considered in this paper although these motions can be reproduced using the setup shown in fig 2 similar ideas to include propulsion system dynamics in ship model scale experiments have been reported in literature experiments using a hil scale model with a controllable pitch propeller cpp in waves were for instance demonstrated by tanizawa et al 2013a 2013b they reported oscillating motor torque and speed due to interaction between the simulated engine and physical waves in a model basin with a shifted mean operating point due to scale effects on viscous skin friction thus as a next step kitagawa et al 2014 included a thrust fan for dynamic correction for viscous skin friction kitagawa et al 2015 subsequently introduced a correction on measured propeller torque to account for scale effects on wake fraction corresponding to the ittc performance prediction method recommended procedu 2014b they then proceeded to predict average engine torque and speed in a range of wave fields later kitagawa et al 2018 predicted dynamic behaviour of the diesel engine by showing time traces of torque speed and power they also expanded the diesel engine model by introducing a torque limiter in the governor an advanced correction taking into account scale effects also on rudder effectiveness was demonstrated by ueno and tsukada 2015 they introduced realtime corrections on propeller speed and auxiliary thrust resulting in an improved correspondence between model scale and full scale ship motions considering these publications one can conclude that methods to correct for viscous scale effects on static propeller and rudder performance have been extensively investigated in past literature apart from static distortions by viscous scale effects one can also expect dynamics distortions of propeller torque and thrust interactions between the propeller and appendages such as struts and rudders may trigger vortex shedding around the propeller in turn this causes fluctuations of propeller torque and thrust with a possible effect on shaft dynamics however different viscosity and vapour pressures between full scale and model scale situations may result in different vortex behaviour noting this krasilnikov et al 2015 compared cfd simulations and scale model experiments with podded propellers paying attention to scale effects on propeller pod interaction and resulting vortex behaviour they concluded that scale effects on factors which are a result of propeller pod interaction such as relative rotative efficiency η r and wake fraction w are very limited although krasilnikov et al indicate that these factors do not completely characterise the complex interaction between propeller and pod their limited variation with scale does indicate that such dynamic distortions are of a limited magnitude in addition bertram 1999 stated that scale effects on vortex shedding and flow separation are sufficiently small to allow accurate manoeuvrability experiments with scale model ships thus one can conclude that scale effects on dynamic propeller performance are very limited at least in the frequency range relevant for ships with displacement hulls considering this hydrodynamic scale effects are outside the scope of this paper and froude scaling is attained for reasons of clarity if one were to apply the hil techniques proposed here in manoeuvrability tests with free sailing models realtime corrections for skin friction rudder effectiveness as demonstrated by ueno and tsukada 2015 and ueno et al 2017 would need to be applied too dynamic scale effects on the other hand affect the dynamic behaviour of the propulsion system the mechanisms behind these scale effects have received only limited attention in past literature although they are relevant when considering the dynamic interaction between machinery and environment the aim of this paper is therefore to shed more light on this subject dynamic scale effects can occur on the load side and the drive side for example distortions of flow settling times around the propeller blades may cause dynamic distortions of propeller torque while different dynamic properties of the drive system may cause distortions of shaft dynamics however as dynamic distortions of hydrodynamic propeller torque and thrust are expected to be very limited this paper concentrates on dynamic scale effects on the drive side dynamic scale effects can be illustrated by comparing the shaft dynamics of the hil setup with the shaft dynamics of the full scale prototype which it represents the term shaft dynamics here refers to the dynamic behaviour of load and drive torque and the resulting angular acceleration and speed of the propulsion shaft however this comparison can become rather involved as one must apply scale factors for geometry and time to eliminate these scale factors the concept of ideal scale model is introduced the ideal scale model is a downscaled virtual prototype assuming that no scale effects occur comparing the dynamic behaviour of the ideal scale model to that of the practical scale model or hil scale model dynamic scale effects can be illustrated in a clear manner the mechanisms behind dynamic scale effects can be pinpointed by examining the differences between the propulsion systems of the ideal and practical scale models as appears from figs 1 and 2 the practical scale model contains components that are not present in the ideal scale model moreover components that are present in both the ideal and practical scale models may have different physical properties in specific three causes for dynamic scale effects can be distinguished 1 the electric drive only present in the scale model might introduce additional unwanted dynamics 2 different types and sizes of drive machinery and bearings may cause incorrectly scaled friction 3 the geometry of the drivetrain is not the same leading to an incorrectly scaled moment of inertia this paper aims to identify the components and mechanisms relevant for these three issues in section 2 mathematical descriptions are introduced to analyse the shaft dynamics of the ideal and practical scale models in the same section the expected scale effects are illustrated in the frequency domain these mathematical descriptions are subsequently used in section 3 to establish methods to correct for dynamic scale effects during hil experiments finally section 4 compares simulations and actual measurements from hil open water experiments demonstrating that the proposed corrections indeed allow to conduct hil open water experiments with correctly scaled shaft dynamics with that this paper introduces a scientifically substantiated tool for experimental research on the intersection of marine engineering and hydrodynamics all measurement data presented in this paper were published in a dedicated folder on the 4tu researchdata repository huijgens 2020 every figure containing measurement data is accompanied by a reference to the relevant data files data were recorded using the dspace controldesk and matlab software packages data files have the mat format mat in addition to these data files the repository contains matlab scripts that can assist with visualising the stored measurement data 2 mathematical description of scale models and scale effects in this paper a diesel mechanical propulsion system serves as the ideal scale model dynamic scale effects are illustrated and analysed by comparing the shaft dynamics of this ideal scale model to the shaft dynamics of the hil setup section 2 1 introduces non linear mathematical descriptions of these ideal and practical scale models these mathematical descriptions are subsequently linearised in section 2 2 these linearisations are used in section 2 3 to identify and illustrate dynamic scale effects during hil experiments later in section 3 the linear descriptions are used to derive solutions for dynamic scale effects as they will be demonstrated in section 4 2 1 non linear descriptions of the ideal and practical scale model 2 1 1 ideal scale model diesel mechanical propulsion system fig 3 shows the block diagram of the diesel mechanical propulsion system the diagram shows the eight items that constitute the non linear description of the ideal scale model 1 shaft speed governor fuel rack response on the measured engine speed error 2 diesel engine torque response on engine speed and fuel rack position 3 shaft speed sensor response 4 gearbox torque and speed conversion 5 friction torque inside the engine gearbox bearings and power take off pto 6 inertia of the complete drive train i tot id 7 hydrodynamic propeller load as a function of shaft speed and propeller advance speed 8 integration of the shaft acceleration the balance between the load and drive terms in this system divided by the total moment of inertia determines the dynamic response of the propeller shaft the corresponding equation for propulsion shaft dynamics is given in eq 1 1 i tot id t d ω t d t m d t m prop hydro t the inertia of the water entrained between the propeller blades is dynamic rendering the total inertia of the propulsion system i tot id time variant however the complex subject of added inertia is outside the scope of this paper from here on the moment of inertia of the propulsion plant is assumed to be constant eq 1 forms the link between the individual items listed before these items will be expressed in mathematical terms in this section parameters for the diesel mechanical propulsion system considered in this paper are given in table b 5 the environmental conditions are given in table b 6 the geometric scale factor λ equals 17 9 while time is scaled according to froude similarity the first item in the list was the shaft speed governor which controls the speed of the propulsion engine this is a pi governor as is common in modern merchant ships bondarenko and kashiwagi 2010 before giving a mathematical description of this controller some attention is paid to the input and output signals one could directly supply measured and set shaft speed expressed in rpm to the speed controller and define the output as a fuel rack setting in mm in practice however the input and output signals measured shaft speed n e and fuel rack setting f r are often scaled between minimum and nominal values for n e and between minimum and maximum values for f r this scaling to standardised shaft speed n e and standardised fuel rack setting f r is described by eqs 2 and 3 and illustrated by figs 4 and 5 as such governor settings for diesel engines are more or less standardised eq 4 shows how the pi controller calculates a standardised fuel rack command from measured and set standardised shaft speeds 2 n e 0 if n e n e min n e n e min n e nom n e min otherwise 3 f r f r min if f r 0 f r min f r f r max f r min if 0 f r 1 f r max otherwise f r t k p ω n e set t n e t k i ω 0 t n e set t n e t d t 4 k p ω n e error t k i ω 0 t n e error t d t eq 4 shows that the pi controller has a static gain term and a time dependent integration term when conducting scale model experiments time scaling must be taken into account for all time dependent phenomena including operations inside the shaft speed controller this means that while k p ω does not require scaling from full scale to model scale k i ω does eq 5 shows how shaft speed controller settings are scaled from full scale to model scale assuming froude time scaling 5a k p ω ms k p ω fs 5b k i ω ms k i ω fs λ 0 5 as the next item the diesel engine is represented by a fuel rack map which maps engine brake torque m b as a function of engine speed n e in rpm and fuel rack setting f r in mm such a fuel rack map is mathematically described by eq 6 and visualised by fig 6 the general shape of the fuel rack map and the negative value for g around the nominal engine operating point is in line with past publications schulten 2005 vrijdag and stapersma 2017 dynamic behaviour of the turbocharger is neglected which means that delays in available air for combustion are not taken into account in reality a considerable stepwise increase of injected fuel may cause the air to fuel ratio to drop to a level where not all fuel is burnt temporarily limiting engine torque in practice however this dynamic limit is usually accounted for by limiters in the speed governor vrijdag and stapersma 2017 here it is assumed that the settings of the speed governor result in a sufficiently smooth response of the fuel rack setting on disturbances rendering a model based on a fuel injection map sufficient to assess shaft dynamics it can be argued that the model used here is rather simple and that much more elaborate engine models are available as a key benefit however the model used here can be linearised relatively easily as will prove very useful in section 2 2 moreover improving existing prime mover simulation models is outside the scope of this paper no further attention is paid here to the validity of the diesel engine model 6 m b t f r t f r min f r max f r min g n e t n e nom n e nom n e min m b nom the third item is the shaft speed sensor here it is assumed that this component does not introduce any additional propulsion shaft dynamics therefore it is not separately included in the non linear description next the multiplication of drive torque and shaft speed in the gearbox is modelled drive torque m d equals the brake torque of the diesel engine m b multiplied by the gearbox box reduction ratio i gb this relation is expressed by eq 7 7 m d t m b t i gb shaft speed is converted by the same factor though in the opposite direction the fifth listed item is the friction torque inside the engine gearbox bearings and pto friction torque of the diesel mechanical propulsion system is a subject in the field of tribology which is outside the scope of this paper considering this friction inside engine gearbox and bearings is not considered as is the case for torque absorbed by pto machinery such as shaft generators another important parameter with respect to shaft dynamics is the moment of inertia of the drive train listed as item number six the total moment of inertia i tot id is the sum inertia of the diesel engine gearbox and shaft i mech id inertia of the propeller i prop id and inertia of the water entrained between the propeller blades i h 2 o values for i mech id and i prop id can be obtained from manufacturers on the other hand entrained mass and the resulting added inertia are a much more complicated hydrodynamic phenomenon considering its complex nature added inertia is not further considered in this section it will however be taken into account in section 4 propeller load torque is described by eq 8 in line with kuiper 1992 torque coefficient k q is a function of advance ratio j which in turn is a function of shaft speed ω s propeller advance speed v a and propeller diameter d as is shown in eq 9 the exact relation between k q and the mentioned variables depends on the propeller geometry here a wageningen c4 40 controllable pitch propeller with a design p d ratio of 1 0 and an actual p d setting of 1 3 is considered the coefficients for this propeller including k q were reported by dang et al 2013 note that this pitch is kept constant throughout the simulations and experiments described in this paper despite the choice for a controllable pitch geometry interaction between the hull and propeller is outside the scope of this paper which implies that the propeller operates in open water relative rotative efficiency η r of the propeller is therefore taken as 1 and not further included in the mathematical descriptions in general the interaction between the hull and propeller is not taken into account in open water experiments to study this interaction a scale model hull must be introduced the hydrodynamic interaction between hull and propeller is subject to scale effects too methods to correct for these effects have been demonstrated in past literature ueno and tsukada 2016 yet as this paper concentrates on scale effects on shaft dynamics rather than hydrodynamics disturbances of the inflow caused by the presence of the hull are not considered in detail here the wake fraction is assumed to be static at 0 25 as follows from the conditions given in table b 5 8 m prop hydro t ρ ω s t 2 π 2 d 5 k q j t 9 j t 2 π v a t d ω s t finally the balance between the combined load and drive torque components result in a shaft acceleration depending on the total moment of inertia of the drive the integral of this shaft acceleration equals the propeller shaft speed the fluctuations in load and drive torque and the resulting fluctuations in shaft acceleration and shaft speed are the variables of interest in this paper 2 1 2 practical scale model hil setup the aim during hil open water experiments is to emulate the shaft dynamics of the ideal scale model described in section 2 1 1 as was indicated earlier this can be problematic as the hil setup or practical scale model is physically different from the ideal scale model these differences can be pinpointed in the block diagram shown in fig 7 as a first difference the governor engine and gearbox are no longer physically present but included as simulations second an additional subsystem is introduced the closed electric loop this loop represents the electric propulsion drive which is to emulate the ideal propulsion system third friction moment of inertia and hydrodynamic propeller load are still physically present but may be different from the ideal scale model the first difference simulating rather than physically including the diesel mechanical propulsion system will not receive further attention here as was mentioned in section 2 1 1 validating the simulation model of the diesel mechanical propulsion system is outside the scope it is assumed that the non linear descriptions and resulting simulation models are accurate and that simulating rather than physically including components does not change dynamic behaviour the other two differences on the other hand may have considerable effects on propulsion shaft dynamics in previous sections dynamic behaviour of the electric propulsion drive was already mentioned as a possible source of dynamic distortions in addition changes in friction torque moment of inertia and hydrodynamic propeller load were mentioned to influence shaft dynamics too considering this the practical scale model is essentially a modified and expanded version of the ideal scale model a number of components are added while the physical properties of components also present in the ideal scale model may be different the components which are simulated in the practical scale model remain identical first the closed electric loop is described here starting with the electric motor permanent magnet synchronous machines pmsm are particularly suited for the hil setup s electric propulsion system because of their compactness and because their torque can be controlled relatively easily drive torque of these machines is proportional to winding current by torque constant k t which is referred to as the motor torque constant this relation is expressed by eq 10 10 m d t k t i t parameters for the electric drive considered in this paper are given in table b 7 the relation between voltage speed and current of the pmsm is described by eq 11 terminal voltage u has a maximum value u max 11 l d i t d t k e ω t r i t u t using the law of conservation of energy one could show that torque constant k t and back emf constant k e have practically equal values both variables will therefore be represented by k t from here on the aim of the dynamic open water experiment is to emulate drive torque of an ideal propulsion system this means that torque and therefore winding current of the electric motor must be precisely controlled to this end a pi controller for current is introduced the current controller regulates voltage based on the difference between measured current to the current set point eq 12 gives a mathematical description of this operation u t k p i i set t i m t k i i 0 t i set t i m t d t 12 k p i i error t k i i 0 t i error t d t r and l are the terminal resistance and inductance of the electric motor respectively often the current controller and sensor are integrated into the motor drive which also commutates the motor since motor drives contain proven off the shelf technology it is assumed that commutation and current measurement is done sufficiently fast to avoid dynamic distortions this means that the current sensor block shown in fig 7 is not separately described the physical components in the hil setup located on the right in fig 7 are governed by the same equations as in the ideal scale model however parameters in these equations such as moments of inertia and friction coefficients may have different values this too results in dynamic distortions as will be demonstrated in section 2 3 table b 8 gives the inertia components for the ideal and practical scale models the analysis in section 2 3 relies on linear descriptions of both the ideal and practical scale model which will be derived in section 2 2 2 2 linear descriptions of the ideal and practical scale model 2 2 1 linearised ideal scale model in order to facilitate the linearisation of the given mathematical descriptions a number of simplifications is introduced a first simplification is made to the prime mover model as was mentioned earlier this paper concentrates on dynamic distortions introduced by hardware components such as the additional electric loop rather than the accuracy of the diesel engine s simulation model therefore the prime mover is modelled as a static gain in the linear descriptions two assumptions are made to facilitate the linearisation of the given mathematical descriptions first the total moment of inertia of the shaft gearbox propeller and entrained water i tot id is assumed to be constant which means that changes in entrained water mass in the propeller are neglected here second it is assumed that the simulated gearbox does not introduce additional dynamic behaviour furthermore the gearbox ratio is static and does not introduce any additional dynamics this ratio is therefore eliminated from the linear descriptions this means that there is no longer distinction between propeller and engine speed and shaft speed can be referred to by ω without indices e or s before proceeding to the linear descriptions some attention is paid to notation stapersma and vrijdag 2017 proposed a linear model of torque of a controllable pitch propeller operating behind a ship in their linearisation they used operator δ to signify a small excursion from the equilibrium value for sinusoidal fluctuations this is the oscillation amplitude and superscript to indicate a normalised value this notation is assumed here too as an example eq 13 illustrates how ω relates to δ ω 13 δ ω δ ω ω 0 ω ω 0 ω 0 using this notation and the aforementioned simplifications the non linear descriptions given in section 2 1 1 are linearised the general non linear equation for shaft dynamics given in eq 1 can be linearised as shown in eq 14 14 τ ω d ω t d t δ m d t δ m prop hydro t linearisation implies that non linearities such as the fuel rack limits shown in fig 5 are neglected yet these non linearities are introduced in the hil experiment by the experimenter and are not the result of scale effects as the linear descriptions will be used to analyse scale effects in the frequency domain non linearities in the prime mover simulation model can be neglected in these descriptions linearising the shaft speed loop allows to introduce shaft speed time constant τ ω which was derived by stapersma and vrijdag 2017 τ ω is calculated as shown in eq 15 15 τ ω i ω 0 m d 0 for the time being the prime mover is modelled as a static gain in essence this means that the fuel rack map as explained in section 2 1 1 is not included in the linear description here and the output of the current controller function c ω equals drive torque m d this results in a simpler and more generic linear description as an important advantage this facilitates the mathematical analysis with the aim of finding corrections for scale effects propeller torque m prop hydro can be linearised too stapersma and vrijdag 2017 proposed a method to linearise the non linear propeller load torque as given in eq 8 to the form given in eq 16 16 δ m prop hydro t 2 b δ ω t b δ v a t this linearisation of propeller load torque will be used here too propeller derivative b expresses the change of normalised torque coefficient δ k q with changing normalised advance ratio δ j as is shown in eq 17 for a further elaboration on propeller derivatives reference is made to stapersma and vrijdag 2017 17 b d k q d j j 0 k q 0 the equation for linearised propelled load torque eq 16 can be substituted in the equation for linearised shaft dynamics eq 14 resulting in eq 18 18 τ ω d ω t d t δ m d t 2 b δ ω t b δ v a t after laplace transform and some reordering eq 18 can be written as shown in eq 19 19 δ ω s 1 2 b τ ω 2 b s 1 δ m d s b 2 b τ ω 2 b s 1 δ v a s in the non linear description in section 2 1 1 engine torque depends on the fuel rack position and on shaft speed in order to keep the linear description as simple and generic as possible this interaction will not be taken into account in this section it will however be included in the simulations and measurements reported in section 4 from eq 19 two normalised laplace transfer functions can be derived one for shaft speed response on drive torque and one for shaft speed response on advance speed both are given in eq 20 20a s 1 s δ ω 1 s δ m d s 1 2 b τ ω 2 b s 1 20b s 2 s δ ω 2 s δ v a s b 2 b τ ω 2 b s 1 next the shaft speed controller described in eq 4 is linearised as was indicated earlier the scaling of the input and output signals is not included in the linear model this means first of all that the behaviour of the linear model valid only for shaft speeds and fuel rack settings within their respective minimum and maximum values second controller settings k p i and k i i need to be scaled this scaling factor is the same for both settings and depends on the nominal values in the linear and non linear models in general the conversion factor for controller settings in different controllers and reference conditions depends on the equilibrium values of the process variables as shown in eq 21 x is the variable to be controlled while y is the output variable of the controller 21 k converted x 0 x 0 converted k y 0 converted y 0 the aim here is to convert shaft speed controller settings for the non linear ideal scale model to settings for a linear model based on the notation given in eq 13 consequently the variables x and y in eq 21 are engine speed and torque respectively in the specific case of the shaft speed controller described in section 2 1 1 engine speed and torque are scaled between minimum and maximum values these ranges must be taken into account in the conversion of controller settings as is shown in eq 22 22 k scaled x 0 x max x min x 0 converted k y max y min y 0 converted y 0 moreover deviations from the equilibrium are expressed in fractions of one in the linear description implying that equilibrium values x 0 converted and y 0 converted are equal to one taking this into account as well as the scaling ranges eq 23 shows how the speed controller settings can be converted for use in the linear descriptions 23 k ω n e 0 n e nom n e min k ω m b nom m b min m b 0 using these scaled settings the shaft speed controller described in eq 4 can be linearised the resulting laplace transfer function is given in eq 24 24 c ω s k p ω k i ω 1 s table b 9gives values for the parameters of the linearised ideal scale model corresponding to the conditions described in table b 5 fig 8 gives a visual representation of the linearised ideal scale model in which each block represents one of the laplace transfer functions derived in this section the corresponding laplace transfer function for response of shaft speed on set speed δ ω δ ω set is given in eq 25 δ ω s δ ω set s c ω s s 1 s 1 c ω s s 1 s 25 k p ω k i ω s 1 τ ω k i ω s 2 2 b k p ω k i ω s 1 the laplace transfer function given in eq 25 represents the response of shaft speed on speed setting of the ideal scale model it has one zero and two poles which determine how gain and phase evolve as the input frequency increases generally at very low frequencies the absolute gain equals 1 and the phase equals 0 as the propulsion system can easily follow the set point however as the frequency of the set speed fluctuations increases the gain asymptotically decreases to 0 and the phase to 90 as the propulsion system can no longer attain the set speed and starts to lag behind this effect will become apparent in section 2 3 as a next step section 2 2 2 derives the linear description of the practical scale model allowing a comparison of both scale models to be made in section 2 3 2 2 2 linearised practical scale model in section 2 1 2 it was shown that the practical scale model or hil setup is in fact a modified and expanded version of the ideal scale model introducing the mentioned additional components into the diagram shown in fig 8 one obtains the diagram shown in fig 9 fig 9 introduces three new transfer functions q u q ω and c i the first two describe the response of motor winding current on voltage and shaft speed respectively while the third represents the current controller first the response of motor current is linearised after reordering and normalising the relation between voltage speed and current of the pmsm given in eq 11 can be written as shown in eq 26 26 δ u t δ ω t 1 i 0 r ω 0 k t δ i t 1 k t ω 0 i 0 r l r d i t d t 1 k t ω 0 i 0 r laplace transform of eq 26 results in eq 27 27 δ u s 1 1 i 0 r ω 0 k t δ ω s l r s 1 1 k t ω 0 i 0 r δ i s rearranging eq 27 to isolate normalised current increment δ i yields eq 28 28 δ i s 1 k t ω 0 i 0 r l r s 1 δ u s k t ω 0 i 0 r l r s 1 δ ω s eq 28 shows that there are two input signals that cause response of current i and hence drive torque m d terminal voltage u and shaft speed ω these responses can be represented by two separate systems q u and q ω which are given in eq 29 29a q u s δ i s δ u s 1 k t ω 0 i 0 r l r s 1 u 0 i 0 r l r s 1 29b q ω s δ i s δ ω s k t ω 0 i 0 r l r s 1 current and voltage corresponding to the equilibrium point considered in this chapter are given in table b 10 with the relation between current voltage and speed now expressed as q u and q ω the description of the current controller given in eq 12 can be linearised recalling that the controller settings can be converted according to eq 21 eq 30 gives the laplace transfer function of the linearised current controller 30 c i s k p i k i i 1 s using the transfer functions derived in this section and the block diagram given in fig 9 the dynamic behaviour of δ ω δ ω set of the hil setup can be derived the resulting transfer function is shown in eq 31 31 δ ω s δ ω set s c ω s s 1 s c i s q u s 1 c i s q u s 1 c ω s c i s q u s q ω s s 1 s 1 c i s q u s the laplace transfer function given in eq 31 represents the response of shaft speed on speed setting of the practical scale model based on figs 8 and 9 one could think of additional relevant transfer functions a more detailed account on these transfer functions and their relation to eq 31 will be given by huijgens 2021 expected to be published early 2021 dynamic similarity is achieved until a given frequency if the gain and phase of eq 31 equals the gain and phase of eq 25 until that given frequency in other words the shape of the bode diagram must be the same however this is not at all self evident as the transfer functions for the ideal and practical scale models are not the same moreover the parameters in both transfer functions may be different the resulting scale effects on the dynamic response of torque and speed are the dynamic scale effects that form the subject of this paper in section 2 3 these scale effects will be analysed and demonstrated in the frequency domain 2 3 analysis of dynamic scale effects in the frequency domain by comparing the propulsion systems shown in figs 3 and 7 three causes for dynamic scale effects can be identified dynamic response of the electric drive incorrectly scaled friction torque and incorrectly scaled moment of inertia these three effects are illustrated using bode diagrams of linear simulations in sections 2 3 1 through 2 3 3 to conclude the analysis of dynamic scale effects section 2 3 4 introduces the criteria on shaft dynamics for accurate hil experiments these criteria will be used in section 4 to assess whether or not the considered hil setup and proposed solutions for dynamic scale effects result in accurate emulation of the actual ship s propulsion system 2 3 1 distortions of shaft dynamics by the electric drive a first difference between the ideal and practical scale model is the additional electric loop which converts simulated drive torque into physical drive torque to correctly emulate torque of the prime mover the torque command from the simulator must be converted into physical drive torque sufficiently fast the torque of the electric motor in the hil setup is proportional to the current in the motor windings so fast torque response can be achieved by controlling winding current to this end a current controller is introduced as is also shown in fig 7 in order to achieve precise current control the proportional and integral gains of the current controller k p i and k i i must be properly tuned the significance of these settings is explained in section 3 as a first indication of the importance of current controller tuning fig 10 shows the effect of choosing arbitrary controller settings fig 10 presents a bode diagram with shaft speed response on speed setting both for the ideal scale model and a practical scale model with electric propulsion system mechanical parameters for the practical scale model are given in table b 9 while the additional electric drive has the equilibrium values given in table b 10 at this point no guidance is available for tuning the electric drive of a dynamic open water setup as such both k p i and k i i are arbitrarily set to a value of 1 clearly this results in considerably distorted shaft dynamics indicating that proper settings are an absolute requirement for dynamic similarity considering this section 3 introduced tuning guidance for the current controller 2 3 2 scale effects on friction shaft dynamics also depend on the equilibrium torque of the propulsion drive to illustrate this a practical scale model is simulated which is nearly the same as the ideal scale model described by table b 9 the only difference in this case is that the equilibrium torque m d 0 is increased with 10 to 4 956 nm due to friction in the model drive as can be seen in fig 11 this too results in distorted shaft dynamics although to a limited extent compared to other scale effects in section 3 a method is proposed to compensate for model scale friction 2 3 3 scale effects on moment of inertia an incorrectly scaled moment of inertia of the propulsion systems may result in dynamic distortions too fig 12 illustrates this by comparing shaft speed response of the ideal scale model and a practical scale model which has a considerably smaller moment of inertia whereas the ideal moment of inertia i tot id equals 0 0297 kgm 2 practical inertia i tot p is 0 0029 kgm 2 or only 9 8 of the ideal value as will be shown later on the latter value corresponds to the actual hil setup considered in this paper apart from a different moment of inertia parameters and equilibrium values are the same again shaft dynamics appear to be distorted section 3 contains an elaboration on these distortions and proposes a method to compensate for incorrect moment of inertia 2 3 4 criteria for accurate emulation of shaft dynamics ideally the response of the propeller shaft on all input disturbances would be exactly equal for the ideal and practical scale model in practice scale effects introduce distortions of shaft dynamics and the aim in this paper is to derive methods to avoid or correct these distortions to assess the performance of the formulated solutions the response of shaft speed on speed setting for the ideal and practical scale models is compared this is primarily done using bode diagrams of the linear descriptions as these allow to assess dynamics over a wide range of frequencies using only simulation models bode diagrams also allow to mathematically formulate criteria for dynamic similarity here dynamic similarity of shaft dynamics is achieved if the gain of the practical scale does not differ from the ideal gain by more than 5 of the ideal dc gain and the phase does not differ more than 10 these criteria are expressed by eq 32 32a g id g p g id dc 0 05 32b ϕ id ϕ p 10 deg the frequency interval in which these criteria are met is from here on referred to as the similarity range for accurate hil experiments the similarity range should completely cover the relevant frequency range which is the frequency range in which interaction between the simulated system and external disturbances is expected in section 4 the relevant frequency range will be defined and the criteria stated here will be used to assess whether or not the proposed solutions for dynamic scale effects result in accurate hil open water experiments 3 corrections for dynamic scale effects ideally the shaft dynamics of the practical scale model should be exactly the same as for the ideal scale model this implies that the bode diagram for the practical scale model as shown in figs 10 through 12 should completely coincide with the bode diagram for the ideal scale model to obtain such dynamic similarity the dynamic scale effects must be corrected for sections 3 1 through 3 3 introduce tuning guidance for the electric drive and corrections for friction and inertia such that dynamic scale effects are reduced to a minimum 3 1 tuning of the electric drive the electric loop inside the hil setup is an additional subsystem with its own transfer function as such it introduces additional poles and zeros comparing eqs 31 and 25 one finds that the electric loop introduces one additional zero in the numerator of the transfer function and two additional zeros in the denominator zeros in the denominator will from here on be referred to as poles while zeros in the numerator will be referred to as zeros the poles and zeros corresponding to the electric loop will be referred to as electric poles and zeros while the poles and zeros corresponding to the ideal propulsion system will be referred to as mechanical poles and zeros as poles and zeros determine the dynamic behaviour of the system the locations of the additional electric poles and zeros should be chosen such that they have a negligible influence on shaft dynamics with this in mind it is recommended that one electric pole and the electric zero are made to coincide such that they cancel each other out furthermore it is recommended that the remaining electric pole is moved to a frequency sufficiently high such that it does not influence the dynamics caused by the mechanical poles and zeros specifically a frequency margin of at least two decades between the remaining electric pole and the mechanical pole with the highest frequency is recommended this approach is shown in a simplified manner in fig 13 these recommendations regarding pole and zero locations materialise in recommended settings for the pi current controller one could determine the poles and zeros for eqs 25 and 31 and substitute and isolate the current controller settings k p i and k i i doing so one would find that the aforementioned conditions regarding pole and zero locations are met if the current controller settings are chosen as shown in eqs 33 and 34 33 k p i 1 e 2 l i 0 2 b k p ω τ ω u 0 i 0 r u 0 34 k i i r l k p i in case the planned experiment includes multiple static operating points the minimum current controller settings are determined by the operating point that requires the largest value for k p i and thus k i i 3 2 friction compensation friction can be compensated by a priori identification of friction torque as a function of shaft speed for the experiments described in this paper friction was determined rather than torque as was shown in eq 10 current and motor torque are directly proportional in a pmsm friction current is measured at a range of speeds after which friction current i fr is estimated by fitting a function with the form shown in eq 35 35 i fr est c 0 j 1 3 c j ω e j fig 14 shows current measurements on a submerged shaft without propeller and streamlined fairings the speed of the shaft is varied between 50 and 1000 rpm in positive direction polynomial regression on these measurements results in a polynomial fit with an r 2 of 0 986 indicating that the fit adequately describes friction current the corresponding coefficients are given in table 1 based on these coefficients a real time correction for friction was introduced during the experiments described in this paper ensuring that friction torque inside the practical scale model did not affect shaft dynamics it is recommended that this identification is performed prior to every experimental run after the shaft has been rotated practically unloaded for at least 1 min this can be achieved by lifting the propeller out of the water or by dismounting the propeller in the course of the research project described in this paper the degree at which the friction curve is time variant was not studied in detail 3 3 inertia correction the ship and hil setup are powered by different kinds of propulsion systems whereas the real ship is powered by a diesel mechanical propulsion system the scale model has an electric drive these systems have entirely different geometries and therefore different moments of inertia thus in order to avoid distortions of shaft dynamics a correction for inertia is necessary this correction will receive more attention than the solutions for the other dynamic scale effects as it is considerably more involved paying attention to the different components of moment of inertia the shaft dynamics of the ideal scale model can be mathematically expressed as in eq 36 i d i prop and i h 2 o refer to the moments of inertia of the propulsion motor and shafting propeller and added mass respectively i d and i prop are determined by the geometry and material density of the drive and propeller which are constant i h 2 o on the other hand depends on the water entrained between the propeller blades which may change with advance speed propeller speed propeller pitch and number blades 36 i d id i prop id i h 2 o id d ω t d t m d t m fr id t m prop hydro t as the geometries and materials of the full scale and model scale propulsion systems are not the same this is not self evident in the practical scale model shaft dynamics are governed by eq 37 37 i d p i prop p i h 2 o p d ω t d t m d t m fr p t m prop hydro t note that the subscript has changed for the first two inertia terms with p denoting the practical scale model the inertia of the water entrained between the propeller blades or added inertia i h 2 o can be subject to distortions as well such distortions would be mainly the result of viscous scale effects on flow around the propeller blades however these effects are very limited compared to the other scale effects considered in this paper at the same time entrained moment of inertia constitutes a highly complex hydrodynamic subject and efforts to formulate a definitive estimation method for this parameter have so far remained inconclusive often the estimation methods proposed by among others lewis and auslaender lewis and auslaender 1965 burrill and robson burrill and robson 1962 and schwanecke 1963 are relied upon although their applicability on modern propellers is disputed krüger and abels 2017 in brief the subject of entrained inertia justifies a research project on its own considering the complexity of this subject and the limited magnitude of the associated scale effects no detailed attention is paid to entrained inertia their values are hence the same for the ideal and practical scale model allowing the indices id and p to be dropped for i h 2 o these differences in moment of inertia result in distortions of shaft dynamics as shown in fig 12 thus in order to conduct accurate hil open water experiments one must apply a correction for moment of inertia eq 38 gives a mathematical expression for the required correction of inertia starting from the differential equation for the practical scale model it is assumed that the dynamic behaviour of the electric drive and friction torque are corrected here which means that m fr p can be neglected 38 i d p i prop p i h 2 o i c d ω t d t m d t m prop hydro t i c is referred to as the inertia correction required to correct the practical scale model inertia to its ideal value to achieve dynamic similarity the left hand side of the differential equation for the corrected practical scale model given in eq 38 must be equal to the left hand side of the differential equation for the ideal scale model given in eq 36 this requirement is written out in eq 39 39 i d p i prop p i h 2 o i c d ω t d t i d id i prop id i h 2 o d ω t d t eq 39 can be developed into eq 40 isolating i c 40 i c i d id i prop id i d p i prop p i mech id i mech p i c can be positive or negative a positive value indicating that the practical moment of inertia is too small there are three different methods to put this mathematical correction into physical practice as a first option one could physically change the moment of inertia for example by means of a flywheel this flywheel would have a moment of inertia equal to i c however physical modifications of the setup are impractical for several reasons limited accessibility of components inside the open water setup as well as spatial constrains render the mounting and exchanging of flywheels rather labour intensive moreover there are no flywheels with negative inertia allowing only corrections in positive direction physical flywheels are therefore not considered here a second option is to emulate shaft speed instead of drive torque as was demonstrated by tanizawa et al 2013a in their setup shaft acceleration is calculated each simulation step based on measured propeller torque simulated drive torque and the inertia of the simulated ideal propulsion system the acceleration is then integrated resulting in a simulated shaft speed which is then communicated to the motor drive in the resulting closed shaft speed loop the moment of inertia of the practical scale model is implicitly corrected yet this approach has two important disadvantages emulating shaft speed requires an additional shaft speed loop which in turn also introduces another possible source of dynamic distortions more importantly however shaft speed emulation relies on propeller torque measured by a torque sensor such torque sensors are not designed to accurately measure torque at high frequencies limiting the accuracy of such sensors in dynamic model basin tests although these sensors are generally able to accurately measure fluctuations of torque in the frequency range of incoming waves and are thus suitable for present day open water experiments future hil experiments may concentrate on disturbances at higher frequencies such as dynamics caused by blade passing those frequencies may be near the eigen frequency of the shaft assembly with torque sensor causing distorted measurements at such frequencies without elaborating on this subject here it can be stated that shaft speed emulation is not the optimal solution for hil open water tests the third option is to emulate drive torque with an additional torque term which accounts for the error in inertia this correction term is referred to as the torque correction m d corr shown separately in eq 41 the correction term consists of shaft acceleration d ω d t and an inertia correction i c which could be considered a virtual flywheel 41 m d corr t i c d ω t d t fig 15 shows how the numerical inertia correction is applied in a hil open water experiment note that the diagram also includes the friction torque compensation furthermore the shaft speed calculation module is a separate software module which converts the time measured between encoder pulses into a calculated shaft speed for the experiments described in this paper a dspace ds4004 digital i o board connected to a ds1006 processor board was used the diagram shows that the measured shaft speed is processed in three steps to obtain torque correction m d corr 1 calculation of the discrete derivative discrete differentiation 2 filtering 3 multiplication with i c the first step is described by eq 42 in essence the discrete derivative equals the difference in measured shaft speed ω m between two time steps divided by the length of the time step δ t here the time step is the step size of the simulator 42 δ ω m δ t n ω m n ω m n 1 δ t this derivative equals the shaft acceleration which can be used to calculated the torque correction however the operation of discrete differentiation considerably increases the noise of the signal this noise may conceal the relevant physical dynamics and even lead to numerical errors in the simulation model the noise in the measured shaft speed signal and thus the calculated acceleration depends on the properties of the shaft speed sensor and the shaft speed calculation module shown in fig 15 two important properties in this respect are a precisely constant spacing of the encoder pulses and a high sample frequency of the shaft speed calculation module to limit measurement noise the calculated shaft acceleration is filtered by an infinite impulse response iir filter such a filter is simple to implement and requires only limited computational effort for a detailed elaboration on iir filters and other discrete filters reference is made to balmer 1998 eq 43 gives the difference equation of the iir filter applied on measured shaft speed ω m 43 ω m f n a 0 ω m n 1 a 0 ω m f n 1 here a 0 equals the filter coefficient determining the extent to which the signal is filtered heavy filtering or a low setting for a 0 results in a smooth signal however this also limits the frequency range in which the numerical inertia correction is accurate keeping this trade off in mind a value for a 0 must be chosen sufficiently low to reduce noise to an acceptable level yet sufficiently high to avoid unacceptable distortion of shaft dynamics by the filter in the next step a mathematical description is introduced to predict this effect of the iir filter on shaft dynamics as a final step the filtered discrete derivative of shaft speed is multiplied by the inertia correction factor i c while introduced to reduce dynamic distortions caused by the scale effect on moment of inertia these three operations introduce additional dynamic response to predict whether these additional dynamics remain within acceptable limits a linear description of the shaft dynamics including this numerical correction was derived the result of this derivation is given in eq 44 which describes the response of shaft speed on simulated drive torque including the numerical inertia correction in the discrete domain 44 δ ω δ m d sim z δ t δ t 1 a 0 z 1 i tot p 2 b δ t a 0 2 i tot p a 0 1 2 b δ t a 0 i c z 1 1 a 0 i tot p a 0 i c z 2 eq 44 is in fact the discrete equivalent of eq 20a introducing a discrete correction algorithm for moment of inertia eq 44 will be used in section 4 to predict the performance of the numerical inertia correction in a simulated environment 4 results and discussion the findings in this paper are validated by comparing simulations and measurements on the ideal and practical scale models as is visualised in fig 16 in section 2 non linear descriptions of the ideal and practical scale models were formulated and subsequently used to derive linear descriptions these non linear and linear descriptions were then used to identify and illustrate scale effects on dynamic shaft behaviour following this solutions for these scale effects were proposed in section 3 resulting in non linear and linear descriptions of the corrected practical scale model these stages are represented by dashed lines in the drawing to validate the mathematical descriptions non linear and linear simulations of the practical scale model are compared to hil measurements without numerical inertia correction this comparison is made in section 4 and is indicated by number 1 in fig 16 in section 4 the performance of the proposed corrections is verified by comparing simulations of the corrected scale model and ideal scale model to hil measurements with the proposed corrections applied this comparison is indicated by number 2 in fig 16 4 1 validation of mathematical descriptions as is indicated by step 1 in fig 16 the mathematical descriptions are validated by comparing simulations based on these descriptions with experimental measurements here only the linear descriptions will be evaluated as these follow from the non linear descriptions validation of the linear descriptions thus implies validation of the non linear descriptions the diagrams in figs 8 and 9 show two input signals shaft speed setting ω set and propeller advance speed v a on the output side two relevant signals can be pointed out shaft speed ω and simulated drive torque m d set the response of each output on each input predicted by the linear descriptions will be compared to the measured response first however the response in current i on current set point i set will be evaluated 4 1 1 closed current loop response a first set of experiments was conducted to investigate whether the response of current i on current set point i set corresponds with the mathematical descriptions derived in section 3 the original plan was to systematically vary the current controller settings allowing comparison of the observed trends in dynamics with predictions by simulations however this was not possible as the range of the current controller settings in the motor drive is limited by the manufacturer despite this limitation the response of current on set current was evaluated with simulations and measurements this showed a considerable difference between the mathematical description and the actual behaviour of the electric drive as is indicated by fig 17 a possible explanation for this difference could be that the mathematical description of the electric motor and control loop on which these simulations are based is incorrect however the descriptions derived in section 2 are in line with literature among others examples martinez alvarado et al 2014 reported the use of a bldc motor to power a small scale air thruster basing their mathematical descriptions on the same fundamental equations as those used in this paper although the extensiveness of the bldc models varies from source to source these differences in implementation cannot explain the substantial discrepancy between measured and simulated current response as a more likely hypothesis there may be an additional dynamic system in or around the hil setup unaccounted for in the mathematical description the following systems could be thought of in this respect 1 dynamics and discrete effects of subsystems inside and around the motor drive 2 dynamic response of the power supply the dynamic response of subsystems inside the motor drive and power supply could not in all cases be identified due to limited time material and accessibility an example of such a subsystem is the current sensor which may introduce a phase delay in the current control loop but is inaccessibly mounted inside the motor drive as another example components such as transformers and sliding contacts in the 380 v supply rail along the towing tank may introduce unknown dynamic behaviour the identification of the exact source of these unexpected dynamics is reserved for a future experimental campaign thus the tuning guidance derived in section 3 1 remains invalidated even though the underlying mathematical descriptions are in line with literature yet the results shown in fig 17 are very relevant as they demonstrate the importance of verifying the dynamic response of the electric drive prior to conducting hil experiments as can be seen the phase delay of the electric drive may become an issue already at frequencies two orders of magnitude lower than one would expect in any case the unexpected response of the considered electric drive is not as problematic as it may seem in section 4 1 2 it is shown that the mathematical descriptions of the shaft speed loop derived in section 2 still accurately represent the response of the hil setup 4 1 2 closed shaft speed loop response the hil experiments to validate the mathematical descriptions of shaft speed loop are conducted with the actual current controller settings given in table 2 and the friction compensation applied while the moment of inertia is not corrected this results in measurements that can be reproduced relatively easily in the linear descriptions introduced in section 2 2 the fuel rack map was not taken into account facilitating the mathematical analysis during the hil experiments however the fuel rack map was included thus for a correct comparison the fuel rack map must be introduced into the linear descriptions doing so for all inputs and outputs mentioned earlier one obtains the transfer function given in eqs 45 through 48 which also include engine derivative g 45 δ ω s δ ω set s c ω s s 1 s 1 c ω s g s 1 s 46 δ m d set s δ ω set s c ω s 1 c ω s g s 1 s 47 δ ω s δ v a s s 2 s 1 c ω s g s 1 s 48 δ m d set s δ v a s c ω s g s 2 s 1 c ω s g s 1 s to validate these linear descriptions their predicted response is compared with results from actual hil experiments these experiments are conducted both in calm water and waves which allows to individually evaluate the response of shaft speed ω and simulated drive torque m d set on shaft speed setting ω set and propeller advance speed v a first the response on speed setting is analysed followed by an analysis of the response on waves which can be modelled as sinusoidal fluctuations of advance speed values for δ ω δ ω set and δ m d set can be directly calculated from the measured shaft speed and set points for shaft speed and drive torque stored in the data repository huijgens 2020 in eq 13 it was shown how normalised values can be calculated for a given equilibrium point for δ v a however calculating these normalised values is a somewhat more involved as v a is not directly measured instead the data repository contains measured wave heights from which v a can be determined as shown in eq 49 49 a v a w ω p exp ω p 2 h g eq 49 merely expresses the amplitude of the advance velocities as such the trigonometric term containing time and frequency can be omitted the theory supporting eq 49 was explained by for instance molland molland 2008 wave heights were measured with a wave probe located close to the propeller the wave probe essentially consisted of two submerged electric wires with a known resistance by measuring the voltage potential across these wires the water level was determined recalling that the equilibrium advance speed equals the speed of the towing tank carriage δ v a can be calculated note that there is a 90 phase lag between the observed water level and δ v a to evaluate whether or not the response obtained during hil is accurate the relevant frequency range is important the relevant frequency range depends on the considered environment and thus the wave field therefore attention is paid to the considered wave spectrum first in this paper the wave spectrum described by pierson and moskowitz 1964 is assumed rather than reproducing entire wave spectra regular waves were generated with wave heights and modal frequencies corresponding to different wind speeds modal wave frequencies ω p of up to 5 rad s at model scale were considered above these frequencies the energy carried by the waves becomes negligible at an equilibrium propeller advance speed of 1 73 m s in head waves this results in a maximum wave encounter frequency ω e of 9 4 rad s this in turn means that practically all wave energy is carried at encounter frequencies below 12 7 rad s table 3 lists the properties of the regular waves during the hil experiments realistic significant wave heights and modal wave frequencies were chosen within the capabilities of the wave generator at the delft university of technology tu delft however before evaluating the response on waves the response on fluctuating shaft speed was analysed as this input can be controlled more easily during hil experiments considering the relevant frequency range following from this wave spectrum the speed setting is fluctuated with frequencies of 0 67 rad s 2 66 rad s and 10 63 rad s as a reference these frequencies correspond to 0 025 hz 0 1 hz and 0 4 hz at full scale as such both low frequencies and frequencies near the end of the relevant frequency range are covered figs 18 and 19 show linear simulations of the response on fluctuating shaft speed setting and hil measurements in which the speed setting was sinusoidally varied with an amplitude of 4 of the equilibrium setting comparing linear simulations with measurements one finds that the criteria given in eq 32 are met for all measured frequencies consequently the linear and non linear descriptions of the practical scale model without inertia correction are indeed valid at least for the response on shaft speed setting note that this validation applies to both the shaft speed loop of the practical scale model and the ideal scale model their transfer functions are the same with differences occurring only in the values parameters it can be argued that sinusoidal variations with such a limited amplitude as in figs 18 and 19 are not sufficient as a validation as they do not provide insight into the non linear behaviour of the shaft moreover as frequencies higher than 10 63 rad s are not considered the response on very small time scales remains invalidated with this in mind the response of engine speed on an 11 1 step change in engine speed setting was emulated the result is shown in fig 20 a delay of several milliseconds can be observed caused by the relatively slow response of the electric loop still it can be visually verified that measurements and non linear simulations are well aligned although this analysis is not as quantitative as the analysis of the bode diagrams it can be concluded that the mathematical descriptions are valid also for non linear phenomena in the propulsion system while dynamics on small time scales are accurately described too this leaves the linear descriptions for response on fluctuating v a to be validated due to the limited amount of time available in the towing tank this response was validated only with the numerical inertia correction applied as will be shown in section 4 2 4 2 validation of numerical inertia correction as was indicated in fig 16 the second validation step concentrates on the performance of the proposed corrections particular attention is paid here to the numerical inertia correction this is done for both the response on shaft speed setting and incoming waves the response of shaft speed and simulated drive torque on fluctuating shaft speed setting is plotted in figs 18 and 19 showing a good correspondence between measurements and linear predictions this indicates that the numerical inertia correction as described by eq 44 indeed results in accurate emulation of the shaft dynamics of the ideal scale model at least for the response on shaft speed setting the step response shown in fig 20 shows that this also holds for non linear behaviour and behaviour on small time scales second the performance of the hil setup with numerical inertia correction was validated in waves to this end measurements were conducted with the waves described in table 3 and compared to linear predictions of torque and speed response note that these linear descriptions were validated in section 4 1 2 the resulting measurements and linear simulations are shown in figs 21 and 22 compared to the frequencies of speed setting fluctuations these waves have a considerably smaller frequency spread this is the result of the limitations of the wave generator and the choice for realistic peak frequencies and significant wave heights at a fixed advance speed in head waves validation in a wider frequency range could be obtained by conducting experiments also in quartering waves and at higher equilibrium advance speeds such additional experiments are left for future measurement campaigns the figures show that for the considered wave encounter frequencies the predicted gains align very well with measurements for both speed and torque response for the phase however a considerable error can be observed these phase errors are practically the same for speed and torque and increase with frequency an almost certain explanation for this error is a flaw in the measurement setup the wave probe was located slightly behind the propeller causing wave peaks and thus advance speed peaks to be measured slightly later than their moment of arrival at the propeller this in turn resulted in a phase error in positive direction indeed all phase errors seem to correspond to a rearward offset of the wave probe of approximately 0 07 m as table 4 indicates thus these errors can be attributed to imprudent mounting of the wave probe rather than an inaccuracy in the numerical inertia correction algorithm in fact a certain forward offset of the wave probe relative to the propeller is recommended in future experiments as such an offset would minimise the interaction between the propeller and measurement probe moreover as measurements in this paper show the phase delay caused by such an offset can be accounted for relatively easily during post processing 5 conclusions and recommendations hardware in the loop has the potential to increase insight into the complex interactions between propulsion machinery and hydrodynamic phenomena around ship s hulls and propellers yet a detailed analysis of the requirements to hil setups for accurate emulation of propulsion machinery still lacks this paper aims to provide this analysis in three steps as the title implies first the challenges of hil experiments in the ship model basin were identified in section 2 second solutions to these challenges were formulated in section 3 finally the simulations and measurements in section 4 demonstrated that hil can indeed be used to accurately emulate ship propulsion dynamics in the ship model basin the simulations and measurements shown in section 4 allow to draw two conclusions first the linear and non linear mathematical descriptions for the shaft speed loop introduced in section 2 are valid descriptions of the speed controlled ship propulsion system thus linear and non linear simulations can be used to predict the dynamic response of such a system at model scale and full scale also at small time scales second the proposed corrections allow to accurately emulate the shaft dynamics of the ideal scale model fig 18 through 22 show that for both small sinusoidal fluctuations and large step changes in different kinds of input signals all output signals respond as predicted by the mathematical descriptions of the ideal scale model as these mathematical descriptions were validated in section 4 1 2 this proves that the hil experiments indeed accurately emulate the ideal scale model an important concept in this respect is the relevant frequency range or the range in which interaction between the simulated machinery and external disturbances is expected in this paper the upper limit of this range is set at 12 7 rad s based on the pierson moskowitz wave spectrum the measurements presented in section 4 indicate that the considered hil setup is indeed capable of achieving dynamic similarity up to this frequency yet the relevant frequency range is not a static given as it depends on the considered environment the ship s speed and the factor for time scaling for experiments at smaller geometric scales or in the cavitation tunnel dynamics at smaller time scales may be relevant moreover it was shown that the accuracy of the hil setup depends on the dynamic response of the electric drive as well as the properties of the installed sensors as such not every setup may be suitable to conduct any experiment in general the relevant frequency range should be determined and compared to the dynamic response of the hil setup before a hil measurement campaign thus it can be ensured that all relevant dynamic interactions are accurately emulated as a general conclusion it can be stated that accurate hil experiments in the ship model basin are possible the presented hil setup allows to investigate complex interactions between machinery and environment with an unprecedented level of detail including dynamic interactions that were traditionally neglected there are numerous complex phenomena that could be investigated this way such as the interaction between machinery and ventilating propellers or the performance of novel propulsion technologies in rough seas as such hil in the model basin has to potential to improve the understanding of complex phenomena in and around the ship and accelerate the development and acceptance of the ship propulsion systems of the future finally a general recommendation regarding hil in the ship model basin is formulated introducing hardware in the loop into traditional experiments in the ship model basin adds a new layer of information to such experiments at the same time hil requires relatively limited additional investment considering the increasing need for new technologies in the maritime industry and the uncertainties regarding the performance of these technologies in complex dynamic environments hil can likely accelerate technological development and uptake within the maritime industry it is therefore recommended to apply hil in all future model basin experiments with dynamic environments declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to thank the technical and scientific staff at the tu delft model basin and the engineers and scientists at marin involved in the development of the open water setup used for the described hil experiments appendix a nomenclature a amplitude a 0 iir filter coefficient b propeller torque derivative c polynomial regression constant d m propeller diameter e regression polynomial power f r fuel rack setting g gain g m s 2 gravity constant g fuel rack torque slope h m propeller hub immersion i kgm 2 moment of inertia i a current i gb gearbox reduction ratio j propeller advance ratio k e vs rad motor back emf constant k i s 1 normalised integrator gain k p normalised static gain k q propeller torque constant k t propeller thrust constant k t nm a motor torque constant l h inductance m nm torque n rpm shaft speed n step index p d propeller pitch diameter ratio r ω electric resistance s m 2 s rad spectral density of wave variance s rad s pole frequency t s time u 10 m s wind speed 10 m above the surface u v voltage v m s speed x arbitrary input y arbitrary output z rad s zero frequency z location in the z plane η efficiency ϕ deg phase angle λ geometric scale factor τ s time constant ν m 2 s kinematic viscosity ρ kg m 3 density ω rad s shaft speed ω rad s wave frequency subscripts 0 equilibrium 1 shaft speed component 2 advance speed component a advance b brake c correction d drive e encounter e engine est estimated f filtered fr friction fs full scale h2o entrained water hydro hydrodynamic load i current id ideal scale model l load m torque m measured max maximum mech propulsion motor and shaft ms model scale n pole index net drive minus load nom nominal prop propeller p practical scale model p wave peak set setting sim simulated r relative rotative s shaft s ship tot total v advance speed w wave ω shaft speed superscripts normalised standardised controller setting appendix b parameters and equilibrium values for ideal and practical scale models table b 5 main parameters and equilibrium values of the full scale fs and ideal model scale id ms propulsion systems geometric scale factor λ equals 17 9 time is scaled according to froude similarity the propeller is a wageningen c4 40 with a design p d ratio of 1 0 table b 5 symbol unit fs id ms nom eng power p b nom w 8336 103 343 5 eq eng power p b 0 w 6926 103 285 5 nom eng torque m b nom nm 159 2 103 1 551 eq eng torque m b 0 nm 132 3 103 1 289 nom eng speed n e nom rpm 500 2115 eq eng speed n e 0 rpm 500 2115 min eng speed n e min rpm 200 846 2 nom eng speed n e max rpm 500 2115 norm eq eng speed n e 0 1 1 governor static gain k p ω 1 1 governor int gain k i ω 0 5 2 12 min fr setting f r min mm 10 10 max fr setting f r max mm 40 40 eq fr setting f r 0 mm 34 93 34 93 norm eq fr setting f r 0 0 831 0 831 eng derivative g 0 25 0 25 gearbox reduction i gb 3 4965 3 4965 eq prop torque m prop hydro 0 nm 462 5 103 4 505 eq prop thrust t prop 0 n 572 8 103 99 87 eq prop speed n s 0 rpm 143 605 mech inertia i mech kgm 2 54 58 103 0 02970 prop p d ratio p d 1 3 1 3 prop diameter d m 4 199 0 2346 prop advance speed v a m s 7 33 1 73 ship speed v s m s 9 77 2 31 table b 6 parameters of the environment in which the full scale ship and ideal scale model are operating table b 6 symbol unit gravity constant g n kg 9 81 water density ρ h 2 o kg m 3 1000 water kinematic viscosity ν m 2 s 1 17e 6 table b 7 parameters of the electric drive powering the practical scale model detailed descriptions of the parameters and variables are given in section 2 1 table b 7 symbol unit value torque constant k t nm a 0 55 back emf constant k e vs rad 0 55 terminal resistance r ω 0 555 terminal inductance l h 3 6 10 3 max terminal voltage u max v 400 table b 8 moments of inertia of the ideal and practical scale model propulsion systems these values correspond to the downscaled diesel mechanical propulsion system and the actual hil setup used to emulate this propulsion system the moment of inertia of the hil setup is considerably smaller because of lighter propeller material a more compact propulsion motor and the absence of gear reduction added inertia i h 2 o is estimated according to burrill and robson 1962 table b 8 symbol unit ideal practical drive moment of inertia i d kgm 2 0 02780 0 00226 prop moment of inertia i prop kgm 2 0 00190 0 00064 mech moment of inertia i mech kgm 2 0 02970 0 00290 added inertia i h 2 o kgm 2 0 00368 0 00368 total moment of inertia i tot kgm 2 0 03338 0 00658 table b 9 parameters and equilibrium values of the linearised ideal scale model table b 9 symbol unit value eq drive torque m d 0 nm 4 505 eq shaft speed ω 0 rad s 63 36 moment of inertia i tot kgm 2 0 0297 prop derivative b 0 643 shaft time constant τ ω s 0 4177 norm governor static gain k p ω 2 01 norm governor integral gain k i ω s 1 4 25 table b 10 equilibrium values of the electric propulsion system in the conditions described by table b 9 table b 10 symbol unit value eq voltage u 0 v 39 40 eq current i 0 a 8 19 table b 11 comparison of equilibrium values obtained through non linear simulations and measurements in the towing tank these values result from closed loop experiments with a full scale equivalent engine speed setting of 500 rpm which corresponds to a model scale propeller speed of 605 rpm the measured equilibrium values are valid for all closed loop hil experiments in this paper unless mentioned otherwise table b 11 symbol unit simulated measured eq prop torque m prop hydro 0 nm 4 505 4 7 eq prop thrust t prop 0 n 99 87 102 4 eq winding current i 0 a 8 19 10 3 eq prop speed n s 0 rpm 605 605 prop advance speed v a m s 1 73 1 73 
20905,standards for environmental impact safety and operational performance of ships are becoming increasingly strict in order to meet these standards the performance of new ship designs must be predicted with an increasing level of detail and confidence as present prediction methods lack realistic dynamic behaviour of the ship s propulsion plant there is a need for more advanced methods in this paper an open water test with hardware in the loop hil functionality is proposed hil open water tests combine software and hardware components to emulate realistic behaviour of the ship s propulsion plant in the towing tank it is known however that experiments in the towing tank are subject to viscous scale effects in addition to this shaft dynamics are distorted by a number of scale effects occurring inside the scale model propulsion system in this paper it is demonstrated with measurements that if corrections for these scale effects are applied the dynamic interaction between the propeller and simulated engine system can be accurately emulated in the ship model basin keywords hybrid testing hardware in the loop open water test scale model towing tank marine propulsion 1 introduction during the development of new industrial equipment the designer usually tests a prototype to ensure that it meets a range of requirements first and foremost the requirements on functionality by the end user are generally agreed upon by contract additionally there are regulatory demands on safety while environmental impact during operation too is more and more under scrutiny for large industrial installations however producing a full scale prototype solely for testing is in general prohibitively expensive ships are evident examples of such large installations taking a merchant ship as an example building a full scale prototype is not an option yet there are numerous requirements that need to be satisfied the future owner of a merchant ship for instance will often require that limits of acceptable performance such as ship speed bollard pull and fuel consumption are included in the sales contract at the same time classification societies impose safety requirements by setting standards to structure and machinery while regulatory bodies such as the international maritime organisation imo put limits on the ship s emissions the consequences of not meeting these requirements can be dire so designer and yard generally undertake considerable efforts to predict the performance of a new design moreover as requirements are becoming increasingly strict and hence more difficult to meet there is a need for more holistic prediction methods for operational ship performance than the methods currently available this is quite a challenge interaction between a ship and its environment is a highly complex subject while the systems found on board are becoming increasingly complex too hardware in the loop hil experiments potentially offer the possibility to reproduce complex dynamic behaviour of a full scale ship propulsion system without requiring a full scale prototype also referred to as hybrid tests hil combines physical models or prototypes and numerical simulations into a single test setup in other industries hil is a widespread method to test industrial machinery in the field of power engineering li et al 2006 used hil to evaluate a new control algorithm for wind turbines as another example roinila et al 2019 demonstrated how a hil setup can emulate electrical grids on board aircraft concentrating on the frequency response of power distribution systems hil has already been applied in the maritime field too skjetne and egeland 2006 conducted hil tests for certification of marine control systems while johansen et al 2005 used the same technique to conduct factory acceptance tests of such a system in a similar fashion altosole et al 2007 tested the propulsion control system of aircraft carrier cavour while martelli and figari 2017 described a similar approach concentrating on electrodynamics nounou et al 2018 conducted hil tests on a scale model of the propulsion system of a naval ship they emulated load and drive using two electric motors controlled by simulation models of the ship propeller and propulsion machinery more recently different applications of hil in the context of ship design have been reported including physical models of the ship s hull and environment ueland et al 2018 described a hybrid test in which simulated external forces were applied on a scale model barge in a basin with the aim of studying the forces from mooring lines and associated machinery other than mooring equipment one could also emulate propulsion machinery as was demonstrated by campora and figari 2003 and geertsma et al 2017 ship propulsion system dynamics can be adequately simulated by a numerical model so emulating realistic propulsion plant behaviour seems feasible noting this vrijdag 2016 gave an overview of the possibilities of a hil experiment combining a physical hull and environment and a simulated engine room based on the aforementioned publications huijgens et al 2018 proposed a hil experiment emulating the dynamic behaviour of the ship s propulsion system using a scale model propeller operating in a model basin this setup was introduced as a dynamic open water experiment and is further investigated here dynamic open water experiments are a further development of traditional open water experiments in traditional open water experiments a propeller is moved through undisturbed open water at a constant propeller shaft speed the procedure for such experiments is explained in ittc recommended procedu 2014a in the proposed dynamic open water experiment the electric propulsion motor of the open water setup is controlled by a simulation model of a ship propulsion system this allows to emulate the dynamic response of the ship propulsion system on disturbances at model scale schematic drawings of the full scale propulsion system considered in this paper and the corresponding experimental setup from here on referred to as the hil setup are given in figs 1 and 2 in the full scale ship drive torque is developed by a diesel engine and passed to the propeller through a gearbox fuel injection is governed by a pi shaft speed controller if fluctuations in propeller load torque cause the shaft speed to change the speed controller adjusts the fuel rack setting bringing the shaft speed back to its set value in the hil setup on the other hand drive torque is simulated by a numerical model of the diesel engine and gearbox running on a simulation computer note that this could be any other kind of driving machine the simulated drive torque is communicated to a motor drive which commutates the electric propulsion motor the electric motor in turn drives the scale model propeller the balance of propeller load torque friction torque and motor drive torque results in dynamic response of shaft speed shaft speed is measured and subsequently fed back to the simulation computer using the measured shaft speed and prime mover torque of the previous iteration the combined numerical models of the diesel engine gearbox and shaft speed governor simulate a new torque after which the loop is reiterated to reduce the complexity of the experimental setup ship motions are not considered in this paper although these motions can be reproduced using the setup shown in fig 2 similar ideas to include propulsion system dynamics in ship model scale experiments have been reported in literature experiments using a hil scale model with a controllable pitch propeller cpp in waves were for instance demonstrated by tanizawa et al 2013a 2013b they reported oscillating motor torque and speed due to interaction between the simulated engine and physical waves in a model basin with a shifted mean operating point due to scale effects on viscous skin friction thus as a next step kitagawa et al 2014 included a thrust fan for dynamic correction for viscous skin friction kitagawa et al 2015 subsequently introduced a correction on measured propeller torque to account for scale effects on wake fraction corresponding to the ittc performance prediction method recommended procedu 2014b they then proceeded to predict average engine torque and speed in a range of wave fields later kitagawa et al 2018 predicted dynamic behaviour of the diesel engine by showing time traces of torque speed and power they also expanded the diesel engine model by introducing a torque limiter in the governor an advanced correction taking into account scale effects also on rudder effectiveness was demonstrated by ueno and tsukada 2015 they introduced realtime corrections on propeller speed and auxiliary thrust resulting in an improved correspondence between model scale and full scale ship motions considering these publications one can conclude that methods to correct for viscous scale effects on static propeller and rudder performance have been extensively investigated in past literature apart from static distortions by viscous scale effects one can also expect dynamics distortions of propeller torque and thrust interactions between the propeller and appendages such as struts and rudders may trigger vortex shedding around the propeller in turn this causes fluctuations of propeller torque and thrust with a possible effect on shaft dynamics however different viscosity and vapour pressures between full scale and model scale situations may result in different vortex behaviour noting this krasilnikov et al 2015 compared cfd simulations and scale model experiments with podded propellers paying attention to scale effects on propeller pod interaction and resulting vortex behaviour they concluded that scale effects on factors which are a result of propeller pod interaction such as relative rotative efficiency η r and wake fraction w are very limited although krasilnikov et al indicate that these factors do not completely characterise the complex interaction between propeller and pod their limited variation with scale does indicate that such dynamic distortions are of a limited magnitude in addition bertram 1999 stated that scale effects on vortex shedding and flow separation are sufficiently small to allow accurate manoeuvrability experiments with scale model ships thus one can conclude that scale effects on dynamic propeller performance are very limited at least in the frequency range relevant for ships with displacement hulls considering this hydrodynamic scale effects are outside the scope of this paper and froude scaling is attained for reasons of clarity if one were to apply the hil techniques proposed here in manoeuvrability tests with free sailing models realtime corrections for skin friction rudder effectiveness as demonstrated by ueno and tsukada 2015 and ueno et al 2017 would need to be applied too dynamic scale effects on the other hand affect the dynamic behaviour of the propulsion system the mechanisms behind these scale effects have received only limited attention in past literature although they are relevant when considering the dynamic interaction between machinery and environment the aim of this paper is therefore to shed more light on this subject dynamic scale effects can occur on the load side and the drive side for example distortions of flow settling times around the propeller blades may cause dynamic distortions of propeller torque while different dynamic properties of the drive system may cause distortions of shaft dynamics however as dynamic distortions of hydrodynamic propeller torque and thrust are expected to be very limited this paper concentrates on dynamic scale effects on the drive side dynamic scale effects can be illustrated by comparing the shaft dynamics of the hil setup with the shaft dynamics of the full scale prototype which it represents the term shaft dynamics here refers to the dynamic behaviour of load and drive torque and the resulting angular acceleration and speed of the propulsion shaft however this comparison can become rather involved as one must apply scale factors for geometry and time to eliminate these scale factors the concept of ideal scale model is introduced the ideal scale model is a downscaled virtual prototype assuming that no scale effects occur comparing the dynamic behaviour of the ideal scale model to that of the practical scale model or hil scale model dynamic scale effects can be illustrated in a clear manner the mechanisms behind dynamic scale effects can be pinpointed by examining the differences between the propulsion systems of the ideal and practical scale models as appears from figs 1 and 2 the practical scale model contains components that are not present in the ideal scale model moreover components that are present in both the ideal and practical scale models may have different physical properties in specific three causes for dynamic scale effects can be distinguished 1 the electric drive only present in the scale model might introduce additional unwanted dynamics 2 different types and sizes of drive machinery and bearings may cause incorrectly scaled friction 3 the geometry of the drivetrain is not the same leading to an incorrectly scaled moment of inertia this paper aims to identify the components and mechanisms relevant for these three issues in section 2 mathematical descriptions are introduced to analyse the shaft dynamics of the ideal and practical scale models in the same section the expected scale effects are illustrated in the frequency domain these mathematical descriptions are subsequently used in section 3 to establish methods to correct for dynamic scale effects during hil experiments finally section 4 compares simulations and actual measurements from hil open water experiments demonstrating that the proposed corrections indeed allow to conduct hil open water experiments with correctly scaled shaft dynamics with that this paper introduces a scientifically substantiated tool for experimental research on the intersection of marine engineering and hydrodynamics all measurement data presented in this paper were published in a dedicated folder on the 4tu researchdata repository huijgens 2020 every figure containing measurement data is accompanied by a reference to the relevant data files data were recorded using the dspace controldesk and matlab software packages data files have the mat format mat in addition to these data files the repository contains matlab scripts that can assist with visualising the stored measurement data 2 mathematical description of scale models and scale effects in this paper a diesel mechanical propulsion system serves as the ideal scale model dynamic scale effects are illustrated and analysed by comparing the shaft dynamics of this ideal scale model to the shaft dynamics of the hil setup section 2 1 introduces non linear mathematical descriptions of these ideal and practical scale models these mathematical descriptions are subsequently linearised in section 2 2 these linearisations are used in section 2 3 to identify and illustrate dynamic scale effects during hil experiments later in section 3 the linear descriptions are used to derive solutions for dynamic scale effects as they will be demonstrated in section 4 2 1 non linear descriptions of the ideal and practical scale model 2 1 1 ideal scale model diesel mechanical propulsion system fig 3 shows the block diagram of the diesel mechanical propulsion system the diagram shows the eight items that constitute the non linear description of the ideal scale model 1 shaft speed governor fuel rack response on the measured engine speed error 2 diesel engine torque response on engine speed and fuel rack position 3 shaft speed sensor response 4 gearbox torque and speed conversion 5 friction torque inside the engine gearbox bearings and power take off pto 6 inertia of the complete drive train i tot id 7 hydrodynamic propeller load as a function of shaft speed and propeller advance speed 8 integration of the shaft acceleration the balance between the load and drive terms in this system divided by the total moment of inertia determines the dynamic response of the propeller shaft the corresponding equation for propulsion shaft dynamics is given in eq 1 1 i tot id t d ω t d t m d t m prop hydro t the inertia of the water entrained between the propeller blades is dynamic rendering the total inertia of the propulsion system i tot id time variant however the complex subject of added inertia is outside the scope of this paper from here on the moment of inertia of the propulsion plant is assumed to be constant eq 1 forms the link between the individual items listed before these items will be expressed in mathematical terms in this section parameters for the diesel mechanical propulsion system considered in this paper are given in table b 5 the environmental conditions are given in table b 6 the geometric scale factor λ equals 17 9 while time is scaled according to froude similarity the first item in the list was the shaft speed governor which controls the speed of the propulsion engine this is a pi governor as is common in modern merchant ships bondarenko and kashiwagi 2010 before giving a mathematical description of this controller some attention is paid to the input and output signals one could directly supply measured and set shaft speed expressed in rpm to the speed controller and define the output as a fuel rack setting in mm in practice however the input and output signals measured shaft speed n e and fuel rack setting f r are often scaled between minimum and nominal values for n e and between minimum and maximum values for f r this scaling to standardised shaft speed n e and standardised fuel rack setting f r is described by eqs 2 and 3 and illustrated by figs 4 and 5 as such governor settings for diesel engines are more or less standardised eq 4 shows how the pi controller calculates a standardised fuel rack command from measured and set standardised shaft speeds 2 n e 0 if n e n e min n e n e min n e nom n e min otherwise 3 f r f r min if f r 0 f r min f r f r max f r min if 0 f r 1 f r max otherwise f r t k p ω n e set t n e t k i ω 0 t n e set t n e t d t 4 k p ω n e error t k i ω 0 t n e error t d t eq 4 shows that the pi controller has a static gain term and a time dependent integration term when conducting scale model experiments time scaling must be taken into account for all time dependent phenomena including operations inside the shaft speed controller this means that while k p ω does not require scaling from full scale to model scale k i ω does eq 5 shows how shaft speed controller settings are scaled from full scale to model scale assuming froude time scaling 5a k p ω ms k p ω fs 5b k i ω ms k i ω fs λ 0 5 as the next item the diesel engine is represented by a fuel rack map which maps engine brake torque m b as a function of engine speed n e in rpm and fuel rack setting f r in mm such a fuel rack map is mathematically described by eq 6 and visualised by fig 6 the general shape of the fuel rack map and the negative value for g around the nominal engine operating point is in line with past publications schulten 2005 vrijdag and stapersma 2017 dynamic behaviour of the turbocharger is neglected which means that delays in available air for combustion are not taken into account in reality a considerable stepwise increase of injected fuel may cause the air to fuel ratio to drop to a level where not all fuel is burnt temporarily limiting engine torque in practice however this dynamic limit is usually accounted for by limiters in the speed governor vrijdag and stapersma 2017 here it is assumed that the settings of the speed governor result in a sufficiently smooth response of the fuel rack setting on disturbances rendering a model based on a fuel injection map sufficient to assess shaft dynamics it can be argued that the model used here is rather simple and that much more elaborate engine models are available as a key benefit however the model used here can be linearised relatively easily as will prove very useful in section 2 2 moreover improving existing prime mover simulation models is outside the scope of this paper no further attention is paid here to the validity of the diesel engine model 6 m b t f r t f r min f r max f r min g n e t n e nom n e nom n e min m b nom the third item is the shaft speed sensor here it is assumed that this component does not introduce any additional propulsion shaft dynamics therefore it is not separately included in the non linear description next the multiplication of drive torque and shaft speed in the gearbox is modelled drive torque m d equals the brake torque of the diesel engine m b multiplied by the gearbox box reduction ratio i gb this relation is expressed by eq 7 7 m d t m b t i gb shaft speed is converted by the same factor though in the opposite direction the fifth listed item is the friction torque inside the engine gearbox bearings and pto friction torque of the diesel mechanical propulsion system is a subject in the field of tribology which is outside the scope of this paper considering this friction inside engine gearbox and bearings is not considered as is the case for torque absorbed by pto machinery such as shaft generators another important parameter with respect to shaft dynamics is the moment of inertia of the drive train listed as item number six the total moment of inertia i tot id is the sum inertia of the diesel engine gearbox and shaft i mech id inertia of the propeller i prop id and inertia of the water entrained between the propeller blades i h 2 o values for i mech id and i prop id can be obtained from manufacturers on the other hand entrained mass and the resulting added inertia are a much more complicated hydrodynamic phenomenon considering its complex nature added inertia is not further considered in this section it will however be taken into account in section 4 propeller load torque is described by eq 8 in line with kuiper 1992 torque coefficient k q is a function of advance ratio j which in turn is a function of shaft speed ω s propeller advance speed v a and propeller diameter d as is shown in eq 9 the exact relation between k q and the mentioned variables depends on the propeller geometry here a wageningen c4 40 controllable pitch propeller with a design p d ratio of 1 0 and an actual p d setting of 1 3 is considered the coefficients for this propeller including k q were reported by dang et al 2013 note that this pitch is kept constant throughout the simulations and experiments described in this paper despite the choice for a controllable pitch geometry interaction between the hull and propeller is outside the scope of this paper which implies that the propeller operates in open water relative rotative efficiency η r of the propeller is therefore taken as 1 and not further included in the mathematical descriptions in general the interaction between the hull and propeller is not taken into account in open water experiments to study this interaction a scale model hull must be introduced the hydrodynamic interaction between hull and propeller is subject to scale effects too methods to correct for these effects have been demonstrated in past literature ueno and tsukada 2016 yet as this paper concentrates on scale effects on shaft dynamics rather than hydrodynamics disturbances of the inflow caused by the presence of the hull are not considered in detail here the wake fraction is assumed to be static at 0 25 as follows from the conditions given in table b 5 8 m prop hydro t ρ ω s t 2 π 2 d 5 k q j t 9 j t 2 π v a t d ω s t finally the balance between the combined load and drive torque components result in a shaft acceleration depending on the total moment of inertia of the drive the integral of this shaft acceleration equals the propeller shaft speed the fluctuations in load and drive torque and the resulting fluctuations in shaft acceleration and shaft speed are the variables of interest in this paper 2 1 2 practical scale model hil setup the aim during hil open water experiments is to emulate the shaft dynamics of the ideal scale model described in section 2 1 1 as was indicated earlier this can be problematic as the hil setup or practical scale model is physically different from the ideal scale model these differences can be pinpointed in the block diagram shown in fig 7 as a first difference the governor engine and gearbox are no longer physically present but included as simulations second an additional subsystem is introduced the closed electric loop this loop represents the electric propulsion drive which is to emulate the ideal propulsion system third friction moment of inertia and hydrodynamic propeller load are still physically present but may be different from the ideal scale model the first difference simulating rather than physically including the diesel mechanical propulsion system will not receive further attention here as was mentioned in section 2 1 1 validating the simulation model of the diesel mechanical propulsion system is outside the scope it is assumed that the non linear descriptions and resulting simulation models are accurate and that simulating rather than physically including components does not change dynamic behaviour the other two differences on the other hand may have considerable effects on propulsion shaft dynamics in previous sections dynamic behaviour of the electric propulsion drive was already mentioned as a possible source of dynamic distortions in addition changes in friction torque moment of inertia and hydrodynamic propeller load were mentioned to influence shaft dynamics too considering this the practical scale model is essentially a modified and expanded version of the ideal scale model a number of components are added while the physical properties of components also present in the ideal scale model may be different the components which are simulated in the practical scale model remain identical first the closed electric loop is described here starting with the electric motor permanent magnet synchronous machines pmsm are particularly suited for the hil setup s electric propulsion system because of their compactness and because their torque can be controlled relatively easily drive torque of these machines is proportional to winding current by torque constant k t which is referred to as the motor torque constant this relation is expressed by eq 10 10 m d t k t i t parameters for the electric drive considered in this paper are given in table b 7 the relation between voltage speed and current of the pmsm is described by eq 11 terminal voltage u has a maximum value u max 11 l d i t d t k e ω t r i t u t using the law of conservation of energy one could show that torque constant k t and back emf constant k e have practically equal values both variables will therefore be represented by k t from here on the aim of the dynamic open water experiment is to emulate drive torque of an ideal propulsion system this means that torque and therefore winding current of the electric motor must be precisely controlled to this end a pi controller for current is introduced the current controller regulates voltage based on the difference between measured current to the current set point eq 12 gives a mathematical description of this operation u t k p i i set t i m t k i i 0 t i set t i m t d t 12 k p i i error t k i i 0 t i error t d t r and l are the terminal resistance and inductance of the electric motor respectively often the current controller and sensor are integrated into the motor drive which also commutates the motor since motor drives contain proven off the shelf technology it is assumed that commutation and current measurement is done sufficiently fast to avoid dynamic distortions this means that the current sensor block shown in fig 7 is not separately described the physical components in the hil setup located on the right in fig 7 are governed by the same equations as in the ideal scale model however parameters in these equations such as moments of inertia and friction coefficients may have different values this too results in dynamic distortions as will be demonstrated in section 2 3 table b 8 gives the inertia components for the ideal and practical scale models the analysis in section 2 3 relies on linear descriptions of both the ideal and practical scale model which will be derived in section 2 2 2 2 linear descriptions of the ideal and practical scale model 2 2 1 linearised ideal scale model in order to facilitate the linearisation of the given mathematical descriptions a number of simplifications is introduced a first simplification is made to the prime mover model as was mentioned earlier this paper concentrates on dynamic distortions introduced by hardware components such as the additional electric loop rather than the accuracy of the diesel engine s simulation model therefore the prime mover is modelled as a static gain in the linear descriptions two assumptions are made to facilitate the linearisation of the given mathematical descriptions first the total moment of inertia of the shaft gearbox propeller and entrained water i tot id is assumed to be constant which means that changes in entrained water mass in the propeller are neglected here second it is assumed that the simulated gearbox does not introduce additional dynamic behaviour furthermore the gearbox ratio is static and does not introduce any additional dynamics this ratio is therefore eliminated from the linear descriptions this means that there is no longer distinction between propeller and engine speed and shaft speed can be referred to by ω without indices e or s before proceeding to the linear descriptions some attention is paid to notation stapersma and vrijdag 2017 proposed a linear model of torque of a controllable pitch propeller operating behind a ship in their linearisation they used operator δ to signify a small excursion from the equilibrium value for sinusoidal fluctuations this is the oscillation amplitude and superscript to indicate a normalised value this notation is assumed here too as an example eq 13 illustrates how ω relates to δ ω 13 δ ω δ ω ω 0 ω ω 0 ω 0 using this notation and the aforementioned simplifications the non linear descriptions given in section 2 1 1 are linearised the general non linear equation for shaft dynamics given in eq 1 can be linearised as shown in eq 14 14 τ ω d ω t d t δ m d t δ m prop hydro t linearisation implies that non linearities such as the fuel rack limits shown in fig 5 are neglected yet these non linearities are introduced in the hil experiment by the experimenter and are not the result of scale effects as the linear descriptions will be used to analyse scale effects in the frequency domain non linearities in the prime mover simulation model can be neglected in these descriptions linearising the shaft speed loop allows to introduce shaft speed time constant τ ω which was derived by stapersma and vrijdag 2017 τ ω is calculated as shown in eq 15 15 τ ω i ω 0 m d 0 for the time being the prime mover is modelled as a static gain in essence this means that the fuel rack map as explained in section 2 1 1 is not included in the linear description here and the output of the current controller function c ω equals drive torque m d this results in a simpler and more generic linear description as an important advantage this facilitates the mathematical analysis with the aim of finding corrections for scale effects propeller torque m prop hydro can be linearised too stapersma and vrijdag 2017 proposed a method to linearise the non linear propeller load torque as given in eq 8 to the form given in eq 16 16 δ m prop hydro t 2 b δ ω t b δ v a t this linearisation of propeller load torque will be used here too propeller derivative b expresses the change of normalised torque coefficient δ k q with changing normalised advance ratio δ j as is shown in eq 17 for a further elaboration on propeller derivatives reference is made to stapersma and vrijdag 2017 17 b d k q d j j 0 k q 0 the equation for linearised propelled load torque eq 16 can be substituted in the equation for linearised shaft dynamics eq 14 resulting in eq 18 18 τ ω d ω t d t δ m d t 2 b δ ω t b δ v a t after laplace transform and some reordering eq 18 can be written as shown in eq 19 19 δ ω s 1 2 b τ ω 2 b s 1 δ m d s b 2 b τ ω 2 b s 1 δ v a s in the non linear description in section 2 1 1 engine torque depends on the fuel rack position and on shaft speed in order to keep the linear description as simple and generic as possible this interaction will not be taken into account in this section it will however be included in the simulations and measurements reported in section 4 from eq 19 two normalised laplace transfer functions can be derived one for shaft speed response on drive torque and one for shaft speed response on advance speed both are given in eq 20 20a s 1 s δ ω 1 s δ m d s 1 2 b τ ω 2 b s 1 20b s 2 s δ ω 2 s δ v a s b 2 b τ ω 2 b s 1 next the shaft speed controller described in eq 4 is linearised as was indicated earlier the scaling of the input and output signals is not included in the linear model this means first of all that the behaviour of the linear model valid only for shaft speeds and fuel rack settings within their respective minimum and maximum values second controller settings k p i and k i i need to be scaled this scaling factor is the same for both settings and depends on the nominal values in the linear and non linear models in general the conversion factor for controller settings in different controllers and reference conditions depends on the equilibrium values of the process variables as shown in eq 21 x is the variable to be controlled while y is the output variable of the controller 21 k converted x 0 x 0 converted k y 0 converted y 0 the aim here is to convert shaft speed controller settings for the non linear ideal scale model to settings for a linear model based on the notation given in eq 13 consequently the variables x and y in eq 21 are engine speed and torque respectively in the specific case of the shaft speed controller described in section 2 1 1 engine speed and torque are scaled between minimum and maximum values these ranges must be taken into account in the conversion of controller settings as is shown in eq 22 22 k scaled x 0 x max x min x 0 converted k y max y min y 0 converted y 0 moreover deviations from the equilibrium are expressed in fractions of one in the linear description implying that equilibrium values x 0 converted and y 0 converted are equal to one taking this into account as well as the scaling ranges eq 23 shows how the speed controller settings can be converted for use in the linear descriptions 23 k ω n e 0 n e nom n e min k ω m b nom m b min m b 0 using these scaled settings the shaft speed controller described in eq 4 can be linearised the resulting laplace transfer function is given in eq 24 24 c ω s k p ω k i ω 1 s table b 9gives values for the parameters of the linearised ideal scale model corresponding to the conditions described in table b 5 fig 8 gives a visual representation of the linearised ideal scale model in which each block represents one of the laplace transfer functions derived in this section the corresponding laplace transfer function for response of shaft speed on set speed δ ω δ ω set is given in eq 25 δ ω s δ ω set s c ω s s 1 s 1 c ω s s 1 s 25 k p ω k i ω s 1 τ ω k i ω s 2 2 b k p ω k i ω s 1 the laplace transfer function given in eq 25 represents the response of shaft speed on speed setting of the ideal scale model it has one zero and two poles which determine how gain and phase evolve as the input frequency increases generally at very low frequencies the absolute gain equals 1 and the phase equals 0 as the propulsion system can easily follow the set point however as the frequency of the set speed fluctuations increases the gain asymptotically decreases to 0 and the phase to 90 as the propulsion system can no longer attain the set speed and starts to lag behind this effect will become apparent in section 2 3 as a next step section 2 2 2 derives the linear description of the practical scale model allowing a comparison of both scale models to be made in section 2 3 2 2 2 linearised practical scale model in section 2 1 2 it was shown that the practical scale model or hil setup is in fact a modified and expanded version of the ideal scale model introducing the mentioned additional components into the diagram shown in fig 8 one obtains the diagram shown in fig 9 fig 9 introduces three new transfer functions q u q ω and c i the first two describe the response of motor winding current on voltage and shaft speed respectively while the third represents the current controller first the response of motor current is linearised after reordering and normalising the relation between voltage speed and current of the pmsm given in eq 11 can be written as shown in eq 26 26 δ u t δ ω t 1 i 0 r ω 0 k t δ i t 1 k t ω 0 i 0 r l r d i t d t 1 k t ω 0 i 0 r laplace transform of eq 26 results in eq 27 27 δ u s 1 1 i 0 r ω 0 k t δ ω s l r s 1 1 k t ω 0 i 0 r δ i s rearranging eq 27 to isolate normalised current increment δ i yields eq 28 28 δ i s 1 k t ω 0 i 0 r l r s 1 δ u s k t ω 0 i 0 r l r s 1 δ ω s eq 28 shows that there are two input signals that cause response of current i and hence drive torque m d terminal voltage u and shaft speed ω these responses can be represented by two separate systems q u and q ω which are given in eq 29 29a q u s δ i s δ u s 1 k t ω 0 i 0 r l r s 1 u 0 i 0 r l r s 1 29b q ω s δ i s δ ω s k t ω 0 i 0 r l r s 1 current and voltage corresponding to the equilibrium point considered in this chapter are given in table b 10 with the relation between current voltage and speed now expressed as q u and q ω the description of the current controller given in eq 12 can be linearised recalling that the controller settings can be converted according to eq 21 eq 30 gives the laplace transfer function of the linearised current controller 30 c i s k p i k i i 1 s using the transfer functions derived in this section and the block diagram given in fig 9 the dynamic behaviour of δ ω δ ω set of the hil setup can be derived the resulting transfer function is shown in eq 31 31 δ ω s δ ω set s c ω s s 1 s c i s q u s 1 c i s q u s 1 c ω s c i s q u s q ω s s 1 s 1 c i s q u s the laplace transfer function given in eq 31 represents the response of shaft speed on speed setting of the practical scale model based on figs 8 and 9 one could think of additional relevant transfer functions a more detailed account on these transfer functions and their relation to eq 31 will be given by huijgens 2021 expected to be published early 2021 dynamic similarity is achieved until a given frequency if the gain and phase of eq 31 equals the gain and phase of eq 25 until that given frequency in other words the shape of the bode diagram must be the same however this is not at all self evident as the transfer functions for the ideal and practical scale models are not the same moreover the parameters in both transfer functions may be different the resulting scale effects on the dynamic response of torque and speed are the dynamic scale effects that form the subject of this paper in section 2 3 these scale effects will be analysed and demonstrated in the frequency domain 2 3 analysis of dynamic scale effects in the frequency domain by comparing the propulsion systems shown in figs 3 and 7 three causes for dynamic scale effects can be identified dynamic response of the electric drive incorrectly scaled friction torque and incorrectly scaled moment of inertia these three effects are illustrated using bode diagrams of linear simulations in sections 2 3 1 through 2 3 3 to conclude the analysis of dynamic scale effects section 2 3 4 introduces the criteria on shaft dynamics for accurate hil experiments these criteria will be used in section 4 to assess whether or not the considered hil setup and proposed solutions for dynamic scale effects result in accurate emulation of the actual ship s propulsion system 2 3 1 distortions of shaft dynamics by the electric drive a first difference between the ideal and practical scale model is the additional electric loop which converts simulated drive torque into physical drive torque to correctly emulate torque of the prime mover the torque command from the simulator must be converted into physical drive torque sufficiently fast the torque of the electric motor in the hil setup is proportional to the current in the motor windings so fast torque response can be achieved by controlling winding current to this end a current controller is introduced as is also shown in fig 7 in order to achieve precise current control the proportional and integral gains of the current controller k p i and k i i must be properly tuned the significance of these settings is explained in section 3 as a first indication of the importance of current controller tuning fig 10 shows the effect of choosing arbitrary controller settings fig 10 presents a bode diagram with shaft speed response on speed setting both for the ideal scale model and a practical scale model with electric propulsion system mechanical parameters for the practical scale model are given in table b 9 while the additional electric drive has the equilibrium values given in table b 10 at this point no guidance is available for tuning the electric drive of a dynamic open water setup as such both k p i and k i i are arbitrarily set to a value of 1 clearly this results in considerably distorted shaft dynamics indicating that proper settings are an absolute requirement for dynamic similarity considering this section 3 introduced tuning guidance for the current controller 2 3 2 scale effects on friction shaft dynamics also depend on the equilibrium torque of the propulsion drive to illustrate this a practical scale model is simulated which is nearly the same as the ideal scale model described by table b 9 the only difference in this case is that the equilibrium torque m d 0 is increased with 10 to 4 956 nm due to friction in the model drive as can be seen in fig 11 this too results in distorted shaft dynamics although to a limited extent compared to other scale effects in section 3 a method is proposed to compensate for model scale friction 2 3 3 scale effects on moment of inertia an incorrectly scaled moment of inertia of the propulsion systems may result in dynamic distortions too fig 12 illustrates this by comparing shaft speed response of the ideal scale model and a practical scale model which has a considerably smaller moment of inertia whereas the ideal moment of inertia i tot id equals 0 0297 kgm 2 practical inertia i tot p is 0 0029 kgm 2 or only 9 8 of the ideal value as will be shown later on the latter value corresponds to the actual hil setup considered in this paper apart from a different moment of inertia parameters and equilibrium values are the same again shaft dynamics appear to be distorted section 3 contains an elaboration on these distortions and proposes a method to compensate for incorrect moment of inertia 2 3 4 criteria for accurate emulation of shaft dynamics ideally the response of the propeller shaft on all input disturbances would be exactly equal for the ideal and practical scale model in practice scale effects introduce distortions of shaft dynamics and the aim in this paper is to derive methods to avoid or correct these distortions to assess the performance of the formulated solutions the response of shaft speed on speed setting for the ideal and practical scale models is compared this is primarily done using bode diagrams of the linear descriptions as these allow to assess dynamics over a wide range of frequencies using only simulation models bode diagrams also allow to mathematically formulate criteria for dynamic similarity here dynamic similarity of shaft dynamics is achieved if the gain of the practical scale does not differ from the ideal gain by more than 5 of the ideal dc gain and the phase does not differ more than 10 these criteria are expressed by eq 32 32a g id g p g id dc 0 05 32b ϕ id ϕ p 10 deg the frequency interval in which these criteria are met is from here on referred to as the similarity range for accurate hil experiments the similarity range should completely cover the relevant frequency range which is the frequency range in which interaction between the simulated system and external disturbances is expected in section 4 the relevant frequency range will be defined and the criteria stated here will be used to assess whether or not the proposed solutions for dynamic scale effects result in accurate hil open water experiments 3 corrections for dynamic scale effects ideally the shaft dynamics of the practical scale model should be exactly the same as for the ideal scale model this implies that the bode diagram for the practical scale model as shown in figs 10 through 12 should completely coincide with the bode diagram for the ideal scale model to obtain such dynamic similarity the dynamic scale effects must be corrected for sections 3 1 through 3 3 introduce tuning guidance for the electric drive and corrections for friction and inertia such that dynamic scale effects are reduced to a minimum 3 1 tuning of the electric drive the electric loop inside the hil setup is an additional subsystem with its own transfer function as such it introduces additional poles and zeros comparing eqs 31 and 25 one finds that the electric loop introduces one additional zero in the numerator of the transfer function and two additional zeros in the denominator zeros in the denominator will from here on be referred to as poles while zeros in the numerator will be referred to as zeros the poles and zeros corresponding to the electric loop will be referred to as electric poles and zeros while the poles and zeros corresponding to the ideal propulsion system will be referred to as mechanical poles and zeros as poles and zeros determine the dynamic behaviour of the system the locations of the additional electric poles and zeros should be chosen such that they have a negligible influence on shaft dynamics with this in mind it is recommended that one electric pole and the electric zero are made to coincide such that they cancel each other out furthermore it is recommended that the remaining electric pole is moved to a frequency sufficiently high such that it does not influence the dynamics caused by the mechanical poles and zeros specifically a frequency margin of at least two decades between the remaining electric pole and the mechanical pole with the highest frequency is recommended this approach is shown in a simplified manner in fig 13 these recommendations regarding pole and zero locations materialise in recommended settings for the pi current controller one could determine the poles and zeros for eqs 25 and 31 and substitute and isolate the current controller settings k p i and k i i doing so one would find that the aforementioned conditions regarding pole and zero locations are met if the current controller settings are chosen as shown in eqs 33 and 34 33 k p i 1 e 2 l i 0 2 b k p ω τ ω u 0 i 0 r u 0 34 k i i r l k p i in case the planned experiment includes multiple static operating points the minimum current controller settings are determined by the operating point that requires the largest value for k p i and thus k i i 3 2 friction compensation friction can be compensated by a priori identification of friction torque as a function of shaft speed for the experiments described in this paper friction was determined rather than torque as was shown in eq 10 current and motor torque are directly proportional in a pmsm friction current is measured at a range of speeds after which friction current i fr is estimated by fitting a function with the form shown in eq 35 35 i fr est c 0 j 1 3 c j ω e j fig 14 shows current measurements on a submerged shaft without propeller and streamlined fairings the speed of the shaft is varied between 50 and 1000 rpm in positive direction polynomial regression on these measurements results in a polynomial fit with an r 2 of 0 986 indicating that the fit adequately describes friction current the corresponding coefficients are given in table 1 based on these coefficients a real time correction for friction was introduced during the experiments described in this paper ensuring that friction torque inside the practical scale model did not affect shaft dynamics it is recommended that this identification is performed prior to every experimental run after the shaft has been rotated practically unloaded for at least 1 min this can be achieved by lifting the propeller out of the water or by dismounting the propeller in the course of the research project described in this paper the degree at which the friction curve is time variant was not studied in detail 3 3 inertia correction the ship and hil setup are powered by different kinds of propulsion systems whereas the real ship is powered by a diesel mechanical propulsion system the scale model has an electric drive these systems have entirely different geometries and therefore different moments of inertia thus in order to avoid distortions of shaft dynamics a correction for inertia is necessary this correction will receive more attention than the solutions for the other dynamic scale effects as it is considerably more involved paying attention to the different components of moment of inertia the shaft dynamics of the ideal scale model can be mathematically expressed as in eq 36 i d i prop and i h 2 o refer to the moments of inertia of the propulsion motor and shafting propeller and added mass respectively i d and i prop are determined by the geometry and material density of the drive and propeller which are constant i h 2 o on the other hand depends on the water entrained between the propeller blades which may change with advance speed propeller speed propeller pitch and number blades 36 i d id i prop id i h 2 o id d ω t d t m d t m fr id t m prop hydro t as the geometries and materials of the full scale and model scale propulsion systems are not the same this is not self evident in the practical scale model shaft dynamics are governed by eq 37 37 i d p i prop p i h 2 o p d ω t d t m d t m fr p t m prop hydro t note that the subscript has changed for the first two inertia terms with p denoting the practical scale model the inertia of the water entrained between the propeller blades or added inertia i h 2 o can be subject to distortions as well such distortions would be mainly the result of viscous scale effects on flow around the propeller blades however these effects are very limited compared to the other scale effects considered in this paper at the same time entrained moment of inertia constitutes a highly complex hydrodynamic subject and efforts to formulate a definitive estimation method for this parameter have so far remained inconclusive often the estimation methods proposed by among others lewis and auslaender lewis and auslaender 1965 burrill and robson burrill and robson 1962 and schwanecke 1963 are relied upon although their applicability on modern propellers is disputed krüger and abels 2017 in brief the subject of entrained inertia justifies a research project on its own considering the complexity of this subject and the limited magnitude of the associated scale effects no detailed attention is paid to entrained inertia their values are hence the same for the ideal and practical scale model allowing the indices id and p to be dropped for i h 2 o these differences in moment of inertia result in distortions of shaft dynamics as shown in fig 12 thus in order to conduct accurate hil open water experiments one must apply a correction for moment of inertia eq 38 gives a mathematical expression for the required correction of inertia starting from the differential equation for the practical scale model it is assumed that the dynamic behaviour of the electric drive and friction torque are corrected here which means that m fr p can be neglected 38 i d p i prop p i h 2 o i c d ω t d t m d t m prop hydro t i c is referred to as the inertia correction required to correct the practical scale model inertia to its ideal value to achieve dynamic similarity the left hand side of the differential equation for the corrected practical scale model given in eq 38 must be equal to the left hand side of the differential equation for the ideal scale model given in eq 36 this requirement is written out in eq 39 39 i d p i prop p i h 2 o i c d ω t d t i d id i prop id i h 2 o d ω t d t eq 39 can be developed into eq 40 isolating i c 40 i c i d id i prop id i d p i prop p i mech id i mech p i c can be positive or negative a positive value indicating that the practical moment of inertia is too small there are three different methods to put this mathematical correction into physical practice as a first option one could physically change the moment of inertia for example by means of a flywheel this flywheel would have a moment of inertia equal to i c however physical modifications of the setup are impractical for several reasons limited accessibility of components inside the open water setup as well as spatial constrains render the mounting and exchanging of flywheels rather labour intensive moreover there are no flywheels with negative inertia allowing only corrections in positive direction physical flywheels are therefore not considered here a second option is to emulate shaft speed instead of drive torque as was demonstrated by tanizawa et al 2013a in their setup shaft acceleration is calculated each simulation step based on measured propeller torque simulated drive torque and the inertia of the simulated ideal propulsion system the acceleration is then integrated resulting in a simulated shaft speed which is then communicated to the motor drive in the resulting closed shaft speed loop the moment of inertia of the practical scale model is implicitly corrected yet this approach has two important disadvantages emulating shaft speed requires an additional shaft speed loop which in turn also introduces another possible source of dynamic distortions more importantly however shaft speed emulation relies on propeller torque measured by a torque sensor such torque sensors are not designed to accurately measure torque at high frequencies limiting the accuracy of such sensors in dynamic model basin tests although these sensors are generally able to accurately measure fluctuations of torque in the frequency range of incoming waves and are thus suitable for present day open water experiments future hil experiments may concentrate on disturbances at higher frequencies such as dynamics caused by blade passing those frequencies may be near the eigen frequency of the shaft assembly with torque sensor causing distorted measurements at such frequencies without elaborating on this subject here it can be stated that shaft speed emulation is not the optimal solution for hil open water tests the third option is to emulate drive torque with an additional torque term which accounts for the error in inertia this correction term is referred to as the torque correction m d corr shown separately in eq 41 the correction term consists of shaft acceleration d ω d t and an inertia correction i c which could be considered a virtual flywheel 41 m d corr t i c d ω t d t fig 15 shows how the numerical inertia correction is applied in a hil open water experiment note that the diagram also includes the friction torque compensation furthermore the shaft speed calculation module is a separate software module which converts the time measured between encoder pulses into a calculated shaft speed for the experiments described in this paper a dspace ds4004 digital i o board connected to a ds1006 processor board was used the diagram shows that the measured shaft speed is processed in three steps to obtain torque correction m d corr 1 calculation of the discrete derivative discrete differentiation 2 filtering 3 multiplication with i c the first step is described by eq 42 in essence the discrete derivative equals the difference in measured shaft speed ω m between two time steps divided by the length of the time step δ t here the time step is the step size of the simulator 42 δ ω m δ t n ω m n ω m n 1 δ t this derivative equals the shaft acceleration which can be used to calculated the torque correction however the operation of discrete differentiation considerably increases the noise of the signal this noise may conceal the relevant physical dynamics and even lead to numerical errors in the simulation model the noise in the measured shaft speed signal and thus the calculated acceleration depends on the properties of the shaft speed sensor and the shaft speed calculation module shown in fig 15 two important properties in this respect are a precisely constant spacing of the encoder pulses and a high sample frequency of the shaft speed calculation module to limit measurement noise the calculated shaft acceleration is filtered by an infinite impulse response iir filter such a filter is simple to implement and requires only limited computational effort for a detailed elaboration on iir filters and other discrete filters reference is made to balmer 1998 eq 43 gives the difference equation of the iir filter applied on measured shaft speed ω m 43 ω m f n a 0 ω m n 1 a 0 ω m f n 1 here a 0 equals the filter coefficient determining the extent to which the signal is filtered heavy filtering or a low setting for a 0 results in a smooth signal however this also limits the frequency range in which the numerical inertia correction is accurate keeping this trade off in mind a value for a 0 must be chosen sufficiently low to reduce noise to an acceptable level yet sufficiently high to avoid unacceptable distortion of shaft dynamics by the filter in the next step a mathematical description is introduced to predict this effect of the iir filter on shaft dynamics as a final step the filtered discrete derivative of shaft speed is multiplied by the inertia correction factor i c while introduced to reduce dynamic distortions caused by the scale effect on moment of inertia these three operations introduce additional dynamic response to predict whether these additional dynamics remain within acceptable limits a linear description of the shaft dynamics including this numerical correction was derived the result of this derivation is given in eq 44 which describes the response of shaft speed on simulated drive torque including the numerical inertia correction in the discrete domain 44 δ ω δ m d sim z δ t δ t 1 a 0 z 1 i tot p 2 b δ t a 0 2 i tot p a 0 1 2 b δ t a 0 i c z 1 1 a 0 i tot p a 0 i c z 2 eq 44 is in fact the discrete equivalent of eq 20a introducing a discrete correction algorithm for moment of inertia eq 44 will be used in section 4 to predict the performance of the numerical inertia correction in a simulated environment 4 results and discussion the findings in this paper are validated by comparing simulations and measurements on the ideal and practical scale models as is visualised in fig 16 in section 2 non linear descriptions of the ideal and practical scale models were formulated and subsequently used to derive linear descriptions these non linear and linear descriptions were then used to identify and illustrate scale effects on dynamic shaft behaviour following this solutions for these scale effects were proposed in section 3 resulting in non linear and linear descriptions of the corrected practical scale model these stages are represented by dashed lines in the drawing to validate the mathematical descriptions non linear and linear simulations of the practical scale model are compared to hil measurements without numerical inertia correction this comparison is made in section 4 and is indicated by number 1 in fig 16 in section 4 the performance of the proposed corrections is verified by comparing simulations of the corrected scale model and ideal scale model to hil measurements with the proposed corrections applied this comparison is indicated by number 2 in fig 16 4 1 validation of mathematical descriptions as is indicated by step 1 in fig 16 the mathematical descriptions are validated by comparing simulations based on these descriptions with experimental measurements here only the linear descriptions will be evaluated as these follow from the non linear descriptions validation of the linear descriptions thus implies validation of the non linear descriptions the diagrams in figs 8 and 9 show two input signals shaft speed setting ω set and propeller advance speed v a on the output side two relevant signals can be pointed out shaft speed ω and simulated drive torque m d set the response of each output on each input predicted by the linear descriptions will be compared to the measured response first however the response in current i on current set point i set will be evaluated 4 1 1 closed current loop response a first set of experiments was conducted to investigate whether the response of current i on current set point i set corresponds with the mathematical descriptions derived in section 3 the original plan was to systematically vary the current controller settings allowing comparison of the observed trends in dynamics with predictions by simulations however this was not possible as the range of the current controller settings in the motor drive is limited by the manufacturer despite this limitation the response of current on set current was evaluated with simulations and measurements this showed a considerable difference between the mathematical description and the actual behaviour of the electric drive as is indicated by fig 17 a possible explanation for this difference could be that the mathematical description of the electric motor and control loop on which these simulations are based is incorrect however the descriptions derived in section 2 are in line with literature among others examples martinez alvarado et al 2014 reported the use of a bldc motor to power a small scale air thruster basing their mathematical descriptions on the same fundamental equations as those used in this paper although the extensiveness of the bldc models varies from source to source these differences in implementation cannot explain the substantial discrepancy between measured and simulated current response as a more likely hypothesis there may be an additional dynamic system in or around the hil setup unaccounted for in the mathematical description the following systems could be thought of in this respect 1 dynamics and discrete effects of subsystems inside and around the motor drive 2 dynamic response of the power supply the dynamic response of subsystems inside the motor drive and power supply could not in all cases be identified due to limited time material and accessibility an example of such a subsystem is the current sensor which may introduce a phase delay in the current control loop but is inaccessibly mounted inside the motor drive as another example components such as transformers and sliding contacts in the 380 v supply rail along the towing tank may introduce unknown dynamic behaviour the identification of the exact source of these unexpected dynamics is reserved for a future experimental campaign thus the tuning guidance derived in section 3 1 remains invalidated even though the underlying mathematical descriptions are in line with literature yet the results shown in fig 17 are very relevant as they demonstrate the importance of verifying the dynamic response of the electric drive prior to conducting hil experiments as can be seen the phase delay of the electric drive may become an issue already at frequencies two orders of magnitude lower than one would expect in any case the unexpected response of the considered electric drive is not as problematic as it may seem in section 4 1 2 it is shown that the mathematical descriptions of the shaft speed loop derived in section 2 still accurately represent the response of the hil setup 4 1 2 closed shaft speed loop response the hil experiments to validate the mathematical descriptions of shaft speed loop are conducted with the actual current controller settings given in table 2 and the friction compensation applied while the moment of inertia is not corrected this results in measurements that can be reproduced relatively easily in the linear descriptions introduced in section 2 2 the fuel rack map was not taken into account facilitating the mathematical analysis during the hil experiments however the fuel rack map was included thus for a correct comparison the fuel rack map must be introduced into the linear descriptions doing so for all inputs and outputs mentioned earlier one obtains the transfer function given in eqs 45 through 48 which also include engine derivative g 45 δ ω s δ ω set s c ω s s 1 s 1 c ω s g s 1 s 46 δ m d set s δ ω set s c ω s 1 c ω s g s 1 s 47 δ ω s δ v a s s 2 s 1 c ω s g s 1 s 48 δ m d set s δ v a s c ω s g s 2 s 1 c ω s g s 1 s to validate these linear descriptions their predicted response is compared with results from actual hil experiments these experiments are conducted both in calm water and waves which allows to individually evaluate the response of shaft speed ω and simulated drive torque m d set on shaft speed setting ω set and propeller advance speed v a first the response on speed setting is analysed followed by an analysis of the response on waves which can be modelled as sinusoidal fluctuations of advance speed values for δ ω δ ω set and δ m d set can be directly calculated from the measured shaft speed and set points for shaft speed and drive torque stored in the data repository huijgens 2020 in eq 13 it was shown how normalised values can be calculated for a given equilibrium point for δ v a however calculating these normalised values is a somewhat more involved as v a is not directly measured instead the data repository contains measured wave heights from which v a can be determined as shown in eq 49 49 a v a w ω p exp ω p 2 h g eq 49 merely expresses the amplitude of the advance velocities as such the trigonometric term containing time and frequency can be omitted the theory supporting eq 49 was explained by for instance molland molland 2008 wave heights were measured with a wave probe located close to the propeller the wave probe essentially consisted of two submerged electric wires with a known resistance by measuring the voltage potential across these wires the water level was determined recalling that the equilibrium advance speed equals the speed of the towing tank carriage δ v a can be calculated note that there is a 90 phase lag between the observed water level and δ v a to evaluate whether or not the response obtained during hil is accurate the relevant frequency range is important the relevant frequency range depends on the considered environment and thus the wave field therefore attention is paid to the considered wave spectrum first in this paper the wave spectrum described by pierson and moskowitz 1964 is assumed rather than reproducing entire wave spectra regular waves were generated with wave heights and modal frequencies corresponding to different wind speeds modal wave frequencies ω p of up to 5 rad s at model scale were considered above these frequencies the energy carried by the waves becomes negligible at an equilibrium propeller advance speed of 1 73 m s in head waves this results in a maximum wave encounter frequency ω e of 9 4 rad s this in turn means that practically all wave energy is carried at encounter frequencies below 12 7 rad s table 3 lists the properties of the regular waves during the hil experiments realistic significant wave heights and modal wave frequencies were chosen within the capabilities of the wave generator at the delft university of technology tu delft however before evaluating the response on waves the response on fluctuating shaft speed was analysed as this input can be controlled more easily during hil experiments considering the relevant frequency range following from this wave spectrum the speed setting is fluctuated with frequencies of 0 67 rad s 2 66 rad s and 10 63 rad s as a reference these frequencies correspond to 0 025 hz 0 1 hz and 0 4 hz at full scale as such both low frequencies and frequencies near the end of the relevant frequency range are covered figs 18 and 19 show linear simulations of the response on fluctuating shaft speed setting and hil measurements in which the speed setting was sinusoidally varied with an amplitude of 4 of the equilibrium setting comparing linear simulations with measurements one finds that the criteria given in eq 32 are met for all measured frequencies consequently the linear and non linear descriptions of the practical scale model without inertia correction are indeed valid at least for the response on shaft speed setting note that this validation applies to both the shaft speed loop of the practical scale model and the ideal scale model their transfer functions are the same with differences occurring only in the values parameters it can be argued that sinusoidal variations with such a limited amplitude as in figs 18 and 19 are not sufficient as a validation as they do not provide insight into the non linear behaviour of the shaft moreover as frequencies higher than 10 63 rad s are not considered the response on very small time scales remains invalidated with this in mind the response of engine speed on an 11 1 step change in engine speed setting was emulated the result is shown in fig 20 a delay of several milliseconds can be observed caused by the relatively slow response of the electric loop still it can be visually verified that measurements and non linear simulations are well aligned although this analysis is not as quantitative as the analysis of the bode diagrams it can be concluded that the mathematical descriptions are valid also for non linear phenomena in the propulsion system while dynamics on small time scales are accurately described too this leaves the linear descriptions for response on fluctuating v a to be validated due to the limited amount of time available in the towing tank this response was validated only with the numerical inertia correction applied as will be shown in section 4 2 4 2 validation of numerical inertia correction as was indicated in fig 16 the second validation step concentrates on the performance of the proposed corrections particular attention is paid here to the numerical inertia correction this is done for both the response on shaft speed setting and incoming waves the response of shaft speed and simulated drive torque on fluctuating shaft speed setting is plotted in figs 18 and 19 showing a good correspondence between measurements and linear predictions this indicates that the numerical inertia correction as described by eq 44 indeed results in accurate emulation of the shaft dynamics of the ideal scale model at least for the response on shaft speed setting the step response shown in fig 20 shows that this also holds for non linear behaviour and behaviour on small time scales second the performance of the hil setup with numerical inertia correction was validated in waves to this end measurements were conducted with the waves described in table 3 and compared to linear predictions of torque and speed response note that these linear descriptions were validated in section 4 1 2 the resulting measurements and linear simulations are shown in figs 21 and 22 compared to the frequencies of speed setting fluctuations these waves have a considerably smaller frequency spread this is the result of the limitations of the wave generator and the choice for realistic peak frequencies and significant wave heights at a fixed advance speed in head waves validation in a wider frequency range could be obtained by conducting experiments also in quartering waves and at higher equilibrium advance speeds such additional experiments are left for future measurement campaigns the figures show that for the considered wave encounter frequencies the predicted gains align very well with measurements for both speed and torque response for the phase however a considerable error can be observed these phase errors are practically the same for speed and torque and increase with frequency an almost certain explanation for this error is a flaw in the measurement setup the wave probe was located slightly behind the propeller causing wave peaks and thus advance speed peaks to be measured slightly later than their moment of arrival at the propeller this in turn resulted in a phase error in positive direction indeed all phase errors seem to correspond to a rearward offset of the wave probe of approximately 0 07 m as table 4 indicates thus these errors can be attributed to imprudent mounting of the wave probe rather than an inaccuracy in the numerical inertia correction algorithm in fact a certain forward offset of the wave probe relative to the propeller is recommended in future experiments as such an offset would minimise the interaction between the propeller and measurement probe moreover as measurements in this paper show the phase delay caused by such an offset can be accounted for relatively easily during post processing 5 conclusions and recommendations hardware in the loop has the potential to increase insight into the complex interactions between propulsion machinery and hydrodynamic phenomena around ship s hulls and propellers yet a detailed analysis of the requirements to hil setups for accurate emulation of propulsion machinery still lacks this paper aims to provide this analysis in three steps as the title implies first the challenges of hil experiments in the ship model basin were identified in section 2 second solutions to these challenges were formulated in section 3 finally the simulations and measurements in section 4 demonstrated that hil can indeed be used to accurately emulate ship propulsion dynamics in the ship model basin the simulations and measurements shown in section 4 allow to draw two conclusions first the linear and non linear mathematical descriptions for the shaft speed loop introduced in section 2 are valid descriptions of the speed controlled ship propulsion system thus linear and non linear simulations can be used to predict the dynamic response of such a system at model scale and full scale also at small time scales second the proposed corrections allow to accurately emulate the shaft dynamics of the ideal scale model fig 18 through 22 show that for both small sinusoidal fluctuations and large step changes in different kinds of input signals all output signals respond as predicted by the mathematical descriptions of the ideal scale model as these mathematical descriptions were validated in section 4 1 2 this proves that the hil experiments indeed accurately emulate the ideal scale model an important concept in this respect is the relevant frequency range or the range in which interaction between the simulated machinery and external disturbances is expected in this paper the upper limit of this range is set at 12 7 rad s based on the pierson moskowitz wave spectrum the measurements presented in section 4 indicate that the considered hil setup is indeed capable of achieving dynamic similarity up to this frequency yet the relevant frequency range is not a static given as it depends on the considered environment the ship s speed and the factor for time scaling for experiments at smaller geometric scales or in the cavitation tunnel dynamics at smaller time scales may be relevant moreover it was shown that the accuracy of the hil setup depends on the dynamic response of the electric drive as well as the properties of the installed sensors as such not every setup may be suitable to conduct any experiment in general the relevant frequency range should be determined and compared to the dynamic response of the hil setup before a hil measurement campaign thus it can be ensured that all relevant dynamic interactions are accurately emulated as a general conclusion it can be stated that accurate hil experiments in the ship model basin are possible the presented hil setup allows to investigate complex interactions between machinery and environment with an unprecedented level of detail including dynamic interactions that were traditionally neglected there are numerous complex phenomena that could be investigated this way such as the interaction between machinery and ventilating propellers or the performance of novel propulsion technologies in rough seas as such hil in the model basin has to potential to improve the understanding of complex phenomena in and around the ship and accelerate the development and acceptance of the ship propulsion systems of the future finally a general recommendation regarding hil in the ship model basin is formulated introducing hardware in the loop into traditional experiments in the ship model basin adds a new layer of information to such experiments at the same time hil requires relatively limited additional investment considering the increasing need for new technologies in the maritime industry and the uncertainties regarding the performance of these technologies in complex dynamic environments hil can likely accelerate technological development and uptake within the maritime industry it is therefore recommended to apply hil in all future model basin experiments with dynamic environments declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to thank the technical and scientific staff at the tu delft model basin and the engineers and scientists at marin involved in the development of the open water setup used for the described hil experiments appendix a nomenclature a amplitude a 0 iir filter coefficient b propeller torque derivative c polynomial regression constant d m propeller diameter e regression polynomial power f r fuel rack setting g gain g m s 2 gravity constant g fuel rack torque slope h m propeller hub immersion i kgm 2 moment of inertia i a current i gb gearbox reduction ratio j propeller advance ratio k e vs rad motor back emf constant k i s 1 normalised integrator gain k p normalised static gain k q propeller torque constant k t propeller thrust constant k t nm a motor torque constant l h inductance m nm torque n rpm shaft speed n step index p d propeller pitch diameter ratio r ω electric resistance s m 2 s rad spectral density of wave variance s rad s pole frequency t s time u 10 m s wind speed 10 m above the surface u v voltage v m s speed x arbitrary input y arbitrary output z rad s zero frequency z location in the z plane η efficiency ϕ deg phase angle λ geometric scale factor τ s time constant ν m 2 s kinematic viscosity ρ kg m 3 density ω rad s shaft speed ω rad s wave frequency subscripts 0 equilibrium 1 shaft speed component 2 advance speed component a advance b brake c correction d drive e encounter e engine est estimated f filtered fr friction fs full scale h2o entrained water hydro hydrodynamic load i current id ideal scale model l load m torque m measured max maximum mech propulsion motor and shaft ms model scale n pole index net drive minus load nom nominal prop propeller p practical scale model p wave peak set setting sim simulated r relative rotative s shaft s ship tot total v advance speed w wave ω shaft speed superscripts normalised standardised controller setting appendix b parameters and equilibrium values for ideal and practical scale models table b 5 main parameters and equilibrium values of the full scale fs and ideal model scale id ms propulsion systems geometric scale factor λ equals 17 9 time is scaled according to froude similarity the propeller is a wageningen c4 40 with a design p d ratio of 1 0 table b 5 symbol unit fs id ms nom eng power p b nom w 8336 103 343 5 eq eng power p b 0 w 6926 103 285 5 nom eng torque m b nom nm 159 2 103 1 551 eq eng torque m b 0 nm 132 3 103 1 289 nom eng speed n e nom rpm 500 2115 eq eng speed n e 0 rpm 500 2115 min eng speed n e min rpm 200 846 2 nom eng speed n e max rpm 500 2115 norm eq eng speed n e 0 1 1 governor static gain k p ω 1 1 governor int gain k i ω 0 5 2 12 min fr setting f r min mm 10 10 max fr setting f r max mm 40 40 eq fr setting f r 0 mm 34 93 34 93 norm eq fr setting f r 0 0 831 0 831 eng derivative g 0 25 0 25 gearbox reduction i gb 3 4965 3 4965 eq prop torque m prop hydro 0 nm 462 5 103 4 505 eq prop thrust t prop 0 n 572 8 103 99 87 eq prop speed n s 0 rpm 143 605 mech inertia i mech kgm 2 54 58 103 0 02970 prop p d ratio p d 1 3 1 3 prop diameter d m 4 199 0 2346 prop advance speed v a m s 7 33 1 73 ship speed v s m s 9 77 2 31 table b 6 parameters of the environment in which the full scale ship and ideal scale model are operating table b 6 symbol unit gravity constant g n kg 9 81 water density ρ h 2 o kg m 3 1000 water kinematic viscosity ν m 2 s 1 17e 6 table b 7 parameters of the electric drive powering the practical scale model detailed descriptions of the parameters and variables are given in section 2 1 table b 7 symbol unit value torque constant k t nm a 0 55 back emf constant k e vs rad 0 55 terminal resistance r ω 0 555 terminal inductance l h 3 6 10 3 max terminal voltage u max v 400 table b 8 moments of inertia of the ideal and practical scale model propulsion systems these values correspond to the downscaled diesel mechanical propulsion system and the actual hil setup used to emulate this propulsion system the moment of inertia of the hil setup is considerably smaller because of lighter propeller material a more compact propulsion motor and the absence of gear reduction added inertia i h 2 o is estimated according to burrill and robson 1962 table b 8 symbol unit ideal practical drive moment of inertia i d kgm 2 0 02780 0 00226 prop moment of inertia i prop kgm 2 0 00190 0 00064 mech moment of inertia i mech kgm 2 0 02970 0 00290 added inertia i h 2 o kgm 2 0 00368 0 00368 total moment of inertia i tot kgm 2 0 03338 0 00658 table b 9 parameters and equilibrium values of the linearised ideal scale model table b 9 symbol unit value eq drive torque m d 0 nm 4 505 eq shaft speed ω 0 rad s 63 36 moment of inertia i tot kgm 2 0 0297 prop derivative b 0 643 shaft time constant τ ω s 0 4177 norm governor static gain k p ω 2 01 norm governor integral gain k i ω s 1 4 25 table b 10 equilibrium values of the electric propulsion system in the conditions described by table b 9 table b 10 symbol unit value eq voltage u 0 v 39 40 eq current i 0 a 8 19 table b 11 comparison of equilibrium values obtained through non linear simulations and measurements in the towing tank these values result from closed loop experiments with a full scale equivalent engine speed setting of 500 rpm which corresponds to a model scale propeller speed of 605 rpm the measured equilibrium values are valid for all closed loop hil experiments in this paper unless mentioned otherwise table b 11 symbol unit simulated measured eq prop torque m prop hydro 0 nm 4 505 4 7 eq prop thrust t prop 0 n 99 87 102 4 eq winding current i 0 a 8 19 10 3 eq prop speed n s 0 rpm 605 605 prop advance speed v a m s 1 73 1 73 
20906,there are two issues with cavitation modeling that need to be resolved 1 the lack of sound physical meaning for the vapor volume fraction vvf to set a threshold a priori for determining the range of cavitation extension 2 the outcome variability uncertainty on the model s predictability resulting from the uncertainties of the model s tunable parameters whose exact values are usually hard to obtain this paper uses as a tool the methodology of the cavitation occurrence probability cop which can be regarded as the resolution of the first issue to resolve the second issue and evaluate the outcome variability due to the tunable parameters of three popular cavitation models i e the full cavitation model fcm zwart gerber belamri z g b and schnerr sauer s s models rans simulations were performed for a cavitating propeller flow with these three cavitation models whose tunable parameters were varied to generate the vvf distributions and thrust data for comparisons with the experimental data the results show that the fcm model is capable of yielding the most accurate predictions of cavitation at its default setting and thrust at some other setting while the s s model is capable of yielding the most precise certain predictions of cavitation and thrust keywords cavitation model marine propeller tunable parameter outcome variability cavitation occurrence probability cop vapor volume fraction vvf 1 introduction it is well known that cavitation generated by a marine propeller usually has detrimental effects on the propeller s performance and structure and induces vibration of the ship hull and noise as a result cavitation has been regarded as the major issue needed to be resolved i e to be avoided as much as possible at the design stage of a marine propeller this task requires the numerical tools for designing a propeller or analyzing the performance of a propeller design for verification to be coupled with cavitation models which are expected to effectively characterize the occurrence of cavitation during the early stage of the development of cavitation modeling the fluid was assumed to be ideal i e inviscid and incompressible leading to the linearized potential theories e g the small perturbation theory developed by tulin 1964 and bem boundary element method based softwares for propeller analyses e g puf 3a and propcav of mit efforts were made then to model the termination of cavities resulting in several famous cavitation models e g re entrant jet model gilbarg and rock 1946 smooth wake model joukowsky 1890 as the computing power has been fast growing for the last couple of decades the cfd computational fluid dynamics has achieved satisfactory capability of solving viscous turbulent flows i e solving the reynolds averaged navier stokes equations with turbulence models as usually referred to as rans powerful commercial cfd packages were hence developed e g ansys fluent adopted by the present study star ccm etc to help users take care of technical numerical challenges such as multi physics and meshing for complex geometries and moving boundaries especially in industrial applications complex flow problems like the ones associated with marine propellers i e problems with complex 3d geometry rotating body multi dynamics fluid and thermal and multi phases liquid and vapor are often solved using one of these commercial cfd packages who usually provide sufficient choices of turbulence modeling and cavitation modeling with regards to the cavitation modeling for example ansys fluent has three built in cavitation models fcm z g b and s s details follow these three cavitation models all consider and model the mass transfer between liquid and vapor phases as a transport equation of the vapor volume fraction vvf as shown in chow et al 2017 the vvf its value ranges from 0 to 1 at a point of a cavitating flow field represents the probability of cavitation occurrence at that point this major class of cavitation model is so called transport equation based model as opposed to the other minor class called barotropic law model as well as the cavitation modeling the turbulence modeling is also a key to the accurate numerical prediction of cavitation likelihood and needs to be handled adequately since the flows associated with marine propellers are always highly turbulent and therefore cavitation and turbulence strongly interact with each other with that in mind the present paper focuses on the cavitation models adopted by ansys fluent and the issues arising from their applications to the flow simulations associated with marine propellers the three cavitation models used in the present paper are reviewed as follows 1 1 fcm model it was proposed by singhal et al 2002 and has been characterized as a full cavitation model fcm in that it considers almost all the processes and parameters involved in the occurrence of cavitation such as phase change bubble dynamics turbulence and non condensable gases ncg it has been successfully implemented in several numerical works on marine propellers for example kimura et al 2009 computed the vvf distributions for two five bladed propellers with uniform and non uniform inflows and compared the cavitation extension represented by the area where with hand drew cavitation sketches of the experimental observations zhu 2015 also computed the vvf distributions for four five bladed propellers with different skew angles and used the areas with large vvf values close to 1 to represent the cavitation performances and show their correlation with the skew angles liu 2015 incorporated a formula into the fcm model to account for the non linear variation of the bubble radius and performed numerical simulations for a hydrofoil and a propeller 1 2 z g b model it was proposed by zwart et al 2004 who constructed this model based on the rayleigh plesset equation with an assumption that all micro bubble nuclei in the liquid have the same diameter for example liu et al 2012 used this model with two modified coefficients to simulate cavitating flows around four five bladed skewed propellers and compared the computed cavitation extensions without mentioning the vvf threshold used with hand drew cavitation sketches of the experimental observations another example for the application of this model is the work done by peng et al 2016 who conducted numerical simulations for the formation and development of cloud cavity on twisted and straight hydrofoils and compared the cavitation extension represented by the area where vvf 0 1 with cavitation images acquired using high speed cameras morgut et al 2018 used three cavitation models including this z g b model and the fcm model to simulate the cavitating flows around a propeller and a kaplan turbine runner and compared the results with that of the corresponding experiments 1 3 s s model it was proposed by schnerr and sauer 2001 who also constructed this model based on the rayleigh plesset equation to the best knowledge of the authors it is the most popular cavitation model used to couple with the rans simulations for example gaggero et al 2012 designed a ducted propeller with a coupled lifting line panel method and compared the results of the cavitating flow around the propeller from the rans simulation and the experiment paik et al 2013 simulated the cavitating flow and obtained the hull pressure fluctuation for a propeller operating behind a ship hull under both design and ballast draught conditions gaggero et al 2014 studied the tip vortex cavitation and the tip leakage vortex cavitation generated by a propeller and a ducted propeller respectively liu et al 2016 simulated the tip vortex of a propeller under cavitating and non cavitating flow conditions and compared their results with that of an experiment lin et al 2016 investigated the effects of rotational speed and tip clearance on the performance of a pump jet propulsor wang et al 2017 and wang et al 2018 studied the performance of a cavitating propeller in a heaving motion due to ocean wave and in oscillations respectively as described above it is clearly evident that substantial efforts have been invested in simulating flows associated with marine propellers using the cavitation model coupled rans there are however two major issues remained to be resolved 1 the ranges of cavitation extension reported in previous literatures were determined by setting a vvf threshold which was selected a posteriori i e using comparison with known experimental result as a result this methodology suffers from 1 the huge data reduction from a distribution to a value of the vvf to represent cavitation and 2 the lack of sound physical meaning for the vvf to set a threshold a priori i e without any known experimental result for example the second workshop on cavitation and propeller performance at the fourth international symposium on marine propulsors smp 15 whose proceedings were edited by kinnas et al 2015 requested all the contributions of numerical results to present cavitation extension with two vvf thresholds 0 4 and 0 6 2 all the three cavitation models aforementioned have parameters to be set initially according to the onset conditions of cavitation in the bulk liquid e g mass fraction of non condensable gas the fcm model radius of micro gas bubbles the z g b model number density of micro gas bubbles the s s model saturated vapor pressure and surface tension functions of temperature etc however the exact values of these model parameters except the saturated vapor pressure are difficult and hence expensive and time consuming to obtain as a result default values provided by the model developers are very often used for the parameter setting before running numerical simulations for cavitating flows an issue arises whether the outcome variabilities uncertainties resulting from the uncertainties of the model parameter values are within acceptable ranges or not in order to settle the first issue the present paper uses the methodology of the cavitation occurrence probability cop proposed by chow et al 2017 where they showed the vvf resulting from numerical simulations is equivalent to the cop measured in experiments therefore the whole vvf distribution i e not a single vvf value as the threshold obtained a posteriori is used to represent the likelihood of cavitation occurrence predicted by numerical simulations and compare with the cop distribution measured in experiments for purposes of evaluating calibrating and validating cavitation models one may argue that surface variables other than the vvf could be used to compare with experimental results in order to circumvent this issue e g the pressure distribution of a surface as in congedo et al 2015 for a venturi duct and zhou et al 2018 for a 2d naca66 hydrofoil and a 3d hemispherical head form owing to its complex 3d geometrical and moving rotating nature however it is very difficult to measure the surface pressure of a marine propeller as opposed to the cases of simple and stationary geometries as shown in congedo et al 2015 and zhou et al 2018 therefore the vvf remains to be the most relevant variable in terms of measurability and direct relationship to cavitation for the present study with the cop methodology the present paper attempts to address the second issue by performing rans simulations for a cavitating propeller flow with varying the parameter values of the cavitation models around their default values and analyzing the variabilities of outcomes including the vvf distribution upon the propeller surface and the thrust generated by the propeller about the quantification of uncertainties variabilities associated with cavitation models and further calibration or optimization for model parameters for example congedo et al 2015 and zhou et al 2018 respectively used bayesian based and surrogate based sequential approximate optimization sao approaches these approaches require certain amount of sample points that may cause very time consuming and costly computations for a cavitating propeller flow owing to its complex nature therefore a simple methodology instead will be proposed and used as a measure of the variabilities the present paper is organized as follows section 2 describes the model propeller used in the present rans simulations as well as in a previous experiment section 3 details the modeling efforts of the three cavitation models and the turbulence modeling and numerics of the rans simulations section 4 first presents results regarding the cavitation model performances at default settings and then analyzes the effects caused by parameter variabilities finally section 5 concludes the present study 2 model propeller the propeller used in the present paper is the same as in chow et al 2017 as shown in fig 1 it has four blades whose sectional shape adopts the foil geometry developed by scherer and stairs 1994 its diameter aspect ratio and expanded area ratio ear are 0 25 m 1 00 and 1 00 respectively detailed geometrical ratios at different radii of this propeller are tabulated in table 1 chow et al 2017 used the cop methodology they proposed in an open water test for the present propeller and obtained the cop distribution over the suction side of the blade details follow they also obtained in that experiment the thrust coefficient kt torque coefficient kq and efficiency η o of the present propeller at its design point j 1 14 these experimental data will be used to compare against the numerical results of the rans simulations performed in the present paper 3 cavitation models and rans 3 1 cavitation models as introduced previously the cavitation models evaluated in the present paper are the fcm z g b and s s models proposed by singhal et al 2002 zwart et al 2004 and schnerr and sauer 2001 respectively treating the cavitating flow as an incompressible homogeneous single fluid mixture of liquid and vapor and assuming no slip difference between velocities of liquid and vapor phases the mass transport equation for the vapor phase can be expressed as 1 t α ρ v α ρ v v r e r c where α denotes the vvf ρ v and v the density of the vapor phase and the mixture velocity same as the velocities of liquid and vapor phases since no slip between phases is assumed respectively and r e and r c the mass source terms originated from the vapor bubbles growth evaporation and collapse condensation respectively equation 1 can be regarded as the transport equation of the vvf that will be solved with cavitation models where the mass source terms r e and r c are modeled since the flow is treated as a single fluid mixture of liquid and vapor the fluid properties e g the mixture density ρ can be defined as 2 ρ α ρ v 1 α ρ l where ρ l denotes the density of the liquid phase all the cavitation models investigated here use the same definition for the pressure threshold singhal et al 2002 p ˆ v as 3 p ˆ v p v 1 2 0 39 ρ k where p v and k denote the saturated vapor pressure and turbulent kinetic energy respectively the relation between the fluid pressure p and p ˆ v at certain location determines whether the evaporation process p p ˆ v or condensation process p p ˆ v the fluid at that location undergoes the modeling effort of these cavitation models mainly consists in r e and r c as described as follows fluent manual 2015 3 1 1 fcm model if p p ˆ v 4 r e f v a p max 1 0 k 1 f v f g ℑ ρ l ρ v 2 3 p ˆ v p ρ l r c 0 if p p ˆ v 5 r c f c o n d max 1 0 k f v ℑ ρ l ρ l 2 3 p p ˆ v ρ l r e 0 where f v a p 0 02 and f c o n d 0 01 are fixed the ncg fraction f g and surface tension ℑ are tunable 3 1 2 z g b model if p p ˆ v 6 r e f v a p 3 α n u c 1 α ρ v ℜ b 2 3 p ˆ v p ρ l r c 0 if p p ˆ v 7 r c f c o n d 3 α ρ v ℜ b 2 3 p p ˆ v ρ l r e 0 where the bubble diameter ℜ b nucleation site volume fraction α n u c evaporation coefficient f v a p and condensation coefficient f c o n d are all tunable 3 1 3 s s model if p p ˆ v 8 r e 3 ρ v ρ l ℜ b ρ α 1 α 2 3 p ˆ v p ρ l r c 0 if p p ˆ v 9 r c 3 ρ v ρ l ℜ b ρ α 1 α 2 3 p p ˆ v ρ l r e 0 and 10 ℜ b α 1 α 3 4 π 1 n b 1 3 where the bubble number density n b is tunable the default values of all the tunable parameters for these three cavitation models are listed in table 3 3 2 rans 3 2 1 turbulence modeling the shear stress transport sst k ω model developed by menter 1994 features an integration of better performances of the k ω model in the near wall region and the k ε model in the far field with a blending function as a result the sst k ω model is considered to be more accurate and reliable for broader flow applications than the standard k ω model leading to its adoption for the present study in ansys fluent the default only near wall treatment for ω based models is so called enhanced wall treatment ω equation ewt ω ansys fluent theory guide 2015 it adopts a methodology of blending the laminar linear and turbulent logarithmic parts of the law of the wall with a function not specified similar to the suggestion by kader 1981 this ewt ω formulation is claimed to be y independent and thus more advanced than that of the traditional wall function 3 2 2 rans settings and numerics as listed in table 4 the rans settings for the present study were adopted from chow et al 2017 their computational mesh of 1 4 million grids fig 2 a and its range fig 2 b were also adopted other details including the grid convergence test can be found in chow et al 2017 in the solver the first order upwind scheme was used for the convective terms while the second order central differencing scheme was used for the diffusion terms the mode of steady state calculation was adopted in accordance with the cop methodology applied to an open water test 4 results rans simulations were then performed with different cavitation models whose values of the tunable parameters were varied chow et al 2017 defined the cop as 11 c o p i j n 1 n c n i j n where i and j are the pixel coordinates of n cavitation images at the same phase angle of propeller and c n is the cavitation indicator of the nth image that c n 1 when the point i j is within a cavitation extension and c n 0 otherwise they also obtained the cop distribution of the present propeller in an open water test as shown in fig 3 a in the present paper the vvf distributions resulting from the rans simulations are correlated with this experimental cop distribution using the corr function defined as 12 c o r r a b 1 m 1 i 1 m a i μ a σ a b i μ b σ b where a v v f b c o p m is the total number of the grid points on the propeller surface μ is the mean value of the distribution and σ is the standard deviation of the distribution while the predicted thrust coefficients are compared with the experimental value table 2 4 1 performances of cavitation model at default settings we first repeated the numerical work done by chow et al 2017 to show the rans results simulated individually using the fcm z g b and s s models with their respective tunable parameters at default values as shown in fig 3 and table 5 the vvf distribution simulated using the fcm model exhibits the highest likelihood with the experimental cop distribution with which the corr value calculated using eq 12 is 0 69 higher than 0 60 of the z g b model and much higher than 0 14 of the s s model the differences in the likelihoods of the simulated vvfs with the experimental cop can be mainly attributed to the prediction accuracy of the cop peak location which as show in fig 3 a is very close to the trailing edge and the radius r r of 0 6 as shown in table 5 the fcm model also predicts the thrust of single blade 128 65 n closest to the experimental data 113 80 n whereas the z g b model 140 19 n farthest from it however the present three cavitation models all over predict the thrust by at least 13 4 2 effects of cavitation model parameter variability in order to evaluate the effects of cavitation model parameter variability of rans simulations for marine propeller flows the value of one of the tunable parameters associated with the three present cavitation models i e the non condensable gas fraction ncg of the fcm model the bubble diameter bd nucleation site volume fraction nsv evaporation coefficient ec and condensation coefficient cc of the z g b model and the bubble number density bnd of the s s model was varied between 1 100 and 1 50 of its default value i e test value default value 2 1 or 2 1 while the others of the same model remained at their default values as shown in tables 6 8 some simulation cases all with the z g b model however could not reach converged results with values of the tunable parameters varied that much therefore the tunable parameters tested of such cases were varied around their default values to smaller extents that converged results could be attained as shown in table 7 for example the nsv of the z g b model could be increased up to 0 00075 i e 1 50 of its default value 0 0005 to guarantee a converged result once the vvf distribution of a simulation case was obtained eq 12 was used to calculate its corr values with the cop contour fig 3 a and the vvf distribution with the same cavitation model using default value s for tunable parameter s 4 2 1 fcm model as shown in the second row of table 6 the case of the increasing ncg exhibits a little higher correlation than that of the decreasing ncg both of them however still show a little lower correlation than that of the default ncg i e the default value of the ncg yields the most accurate prediction for the occurrence likelihood of cavitation upon the propeller surface as shown in the third row of table 6 the variations of the ncg only cause corr drops of less than 0 1 i e the corr outcome of the fcm model is not sensitive to the variation of its only tunable parameter ncg fig 4 shows a visual agreement with the corr results just described above that the vvf distribution contours with the varied ncg of the fcm model closely resemble that with the default ncg as shown in fig 3 b however the thrust predicted in the case of the increasing ncg has an appreciable drop to the value of 117 14 n table 6 which is very close to the experimental value of 113 80 n table 5 in contrast the thrust predicted in the case of the decreasing ncg 135 08 n is much larger than the experimental value making it the worst case of both vvf and thrust predictions among the cases with the fcm model 4 2 2 z g b model as shown in the second row of table 7 the case of the decreasing bd exhibits the highest corr value throughout all cases with the z g b model whereas the increasing bd yields the lowest corr value which is only about 0 2 the other two cases showing similarly low corr values about 0 22 are the ones with the decreasing nsv or the decreasing ec nevertheless all other cases with the z g b model exhibit corr values around 0 6 i e the corr value of the case of default settings the similar trend can be observed in the third row of table 7 where the cases of the increasing bd the decreasing nsv and the decreasing ec show lower corr values below 0 68 with the case of default settings while the other cases exhibit significantly higher corr values above 0 86 the vvf distribution contours of these three outstanding cases as shown in fig 5 a increasing bd fig 6 b decreasing nsv and fig 7 b decreasing ec look almost the same featuring peak values and areas much smaller and their locations closer to the mid chore of the blade than that of the other cases with the z g b model including their counter parts i e figs 5 b 6 a and 7 a and the cases of the cc fig 8 all the cases with the z g b model over predict the thrust considerably table 7 i e all of them are above 130 n interestingly the largest thrust predicted pertains to the case of the default settings 140 19 n this result along with the other thrust predictions make it difficult to establish a reasonable correlation between the vvf and thrust predictions as opposed to the cases with the fcm model where the thrust predicted by its case of the default settings 128 65 n table 6 is the median 4 2 3 s s model for the s s model as shown in the second row of table 8 a mild improvement in the correlation with the cop contour from 0 14 to 0 44 is found in the case of the increasing bnd this mild rise of corr results from occurrences of several vvf high peaks from the mid chore to the location close to the trailing edge as shown in fig 9 a the case of the decreasing bnd shows very tiny change in the corr values table 8 as well as the vvf distribution fig 9 b the thrusts predicted by the cases with the s s model are very similar and like the cases with the z g b model over predicted considerably table 8 4 2 4 overall evaluation as shown in fig 10 the most accurate prediction of the vvf distribution i e the highest corr value 0 69 of the vvf distribution with the cop contour fig 3 a pertains to the case of the default settings with the fcm model the second most accurate corr value 0 67 which is very close to the most accurate one as listed above pertains to the case of the increasing ncg with the fcm model however as shown in fig 11 the most accurate prediction of the thrust i e the smallest relative error 2 93 of the thrust prediction to the experimental value pertaining to the case of the increasing ncg with the fcm model are much better than the second most accurate one 13 05 pertaining to the case of the default settings with the fcm model based on such results one might be prompted to use the fcm model with the setting of the increasing ncg in order to attain the most accurate predictability of simulations for cavitating propellers we also examine the variability rates of parameter on the corr value γ c o r r and the thrust γ t which are defined as 13 γ c o r r χ c o r r χ c o r r χ 0 log 2 χ χ 0 c o r r χ 1 log 2 χ χ 0 γ t χ t χ t χ 0 t χ 0 log 2 χ χ 0 where χ denote an increasing or decreasing parameter χ 0 the default value of a parameter corr the correlation values the third rows of tables 6 8 and t the thrust the forth rows of tables 6 8 the variability rate γ c o r r is always negative since c o r r χ is always less than 1 these variability rates can be interpreted as the relative variation of the result per unit variation by a factor of 2 from the default value to the new setting of a parameter serving as an indicator of how sensitive the result uncertainties are to the parameter uncertainties as shown in fig 12 it is clearly evident that the cases of the varied bd nsv and ec with the z g b model have much higher γ c o r r than that of the other three cases whereas the case of the varied bnd with the s s model has the minimal γ c o r r this result suggests that the z g b and the s s models have the most and the least uncertain outcomes of the cavitation distribution because of the uncertainties of their tunable parameters respectively as shown in fig 13 the case of the decreasing ncg with the fcm model has the highest positive and negative γ t values whereas the s s model has the lowest positive and negative γ t values it clearly suggests that the fcm and the s s models have the most and the least uncertain outcomes of the thrust because of the uncertainties of their tunable parameters respectively 5 conclusions rans simulations for a cavitating propeller flow with three popular cavitation models i e the fcm z g b and s s models were performed with their tunable parameters varied to generate the vvf distributions and thrust data for comparisons with the experimental data the vvf distributions were correlated with the experimental cop data measured by chow et al 2017 with the same propeller which generates highly unsteady cavitation that poses challenges on its modeling the thrusts predicted with these rans simulations were also compared with that measured in the same experiment by doing so the outcome variability on the model s predictability due to the tunable parameters can be evaluated the numerical work done by chow et al 2017 were first repeated to show that the fcm model predicts the most accurate vvf distribution and thrust in the group of these three cavitation models when their respective tunable parameters are all set at default values one four and one tunable parameters of the fcm z g b and s s models respectively were then individually varied between 200 and 50 of their default values the resulting corr values show that the fcm model at its default setting predicts the most accurate vvf distribution while the fcm model with the increasing ncg predicts the most accurate thrust and a vvf distribution with the second best highest corr the z g b model at its default settings predicts a vvf distribution with a corr very close to that of the cases of the fcm model whereas it yields the most over predicted thrust the s s model predicts vvf distributions with pretty low corrs mainly because of the shift of the predicted vvf peak from the trailing edge where the cop peaks toward the mid chord of the propeller blade in summary the fcm model is capable of yielding the most accurate vvf distribution and thrust as compared to the other two models the variability rates of parameter were defined and used as an indicator of sensitivity of the outcome variability uncertainty to the parameter uncertainty with regard to the vvf distribution the z g b and s s models yield respectively the most and least outcome variabilities with regard to the thrust the fcm and s s models yield respectively the most and least outcome variabilities in summary the s s model is capable of yielding the most precise certain vvf distribution and thrust as compared to the other two models declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper nomenclature α vapor volume fraction vvf α nuc nucleation site volume fraction ρ fluid mixture density ρ l liquid density ρ v vapor density ν l liquid viscosity σ cavitation number f v vaper mass fraction f g mass fraction of noncondensable gas fvap evapration coefficient fcond condensation coefficient j advance coefficient k tubulent kinetic energy m j i the mss transfer per unit volume from phase j to phase i m i j the mss transfer per unit volume from phase i to phase j n b bubble number per unit volume of liquid p local far field pressure p b bubble pressure ℜ b bubble radius r e mass source term associated with the growth of the vapor bubble r c mass source term associated with the collapse of the vapor bubble ℑ surface tension of bubble 
20906,there are two issues with cavitation modeling that need to be resolved 1 the lack of sound physical meaning for the vapor volume fraction vvf to set a threshold a priori for determining the range of cavitation extension 2 the outcome variability uncertainty on the model s predictability resulting from the uncertainties of the model s tunable parameters whose exact values are usually hard to obtain this paper uses as a tool the methodology of the cavitation occurrence probability cop which can be regarded as the resolution of the first issue to resolve the second issue and evaluate the outcome variability due to the tunable parameters of three popular cavitation models i e the full cavitation model fcm zwart gerber belamri z g b and schnerr sauer s s models rans simulations were performed for a cavitating propeller flow with these three cavitation models whose tunable parameters were varied to generate the vvf distributions and thrust data for comparisons with the experimental data the results show that the fcm model is capable of yielding the most accurate predictions of cavitation at its default setting and thrust at some other setting while the s s model is capable of yielding the most precise certain predictions of cavitation and thrust keywords cavitation model marine propeller tunable parameter outcome variability cavitation occurrence probability cop vapor volume fraction vvf 1 introduction it is well known that cavitation generated by a marine propeller usually has detrimental effects on the propeller s performance and structure and induces vibration of the ship hull and noise as a result cavitation has been regarded as the major issue needed to be resolved i e to be avoided as much as possible at the design stage of a marine propeller this task requires the numerical tools for designing a propeller or analyzing the performance of a propeller design for verification to be coupled with cavitation models which are expected to effectively characterize the occurrence of cavitation during the early stage of the development of cavitation modeling the fluid was assumed to be ideal i e inviscid and incompressible leading to the linearized potential theories e g the small perturbation theory developed by tulin 1964 and bem boundary element method based softwares for propeller analyses e g puf 3a and propcav of mit efforts were made then to model the termination of cavities resulting in several famous cavitation models e g re entrant jet model gilbarg and rock 1946 smooth wake model joukowsky 1890 as the computing power has been fast growing for the last couple of decades the cfd computational fluid dynamics has achieved satisfactory capability of solving viscous turbulent flows i e solving the reynolds averaged navier stokes equations with turbulence models as usually referred to as rans powerful commercial cfd packages were hence developed e g ansys fluent adopted by the present study star ccm etc to help users take care of technical numerical challenges such as multi physics and meshing for complex geometries and moving boundaries especially in industrial applications complex flow problems like the ones associated with marine propellers i e problems with complex 3d geometry rotating body multi dynamics fluid and thermal and multi phases liquid and vapor are often solved using one of these commercial cfd packages who usually provide sufficient choices of turbulence modeling and cavitation modeling with regards to the cavitation modeling for example ansys fluent has three built in cavitation models fcm z g b and s s details follow these three cavitation models all consider and model the mass transfer between liquid and vapor phases as a transport equation of the vapor volume fraction vvf as shown in chow et al 2017 the vvf its value ranges from 0 to 1 at a point of a cavitating flow field represents the probability of cavitation occurrence at that point this major class of cavitation model is so called transport equation based model as opposed to the other minor class called barotropic law model as well as the cavitation modeling the turbulence modeling is also a key to the accurate numerical prediction of cavitation likelihood and needs to be handled adequately since the flows associated with marine propellers are always highly turbulent and therefore cavitation and turbulence strongly interact with each other with that in mind the present paper focuses on the cavitation models adopted by ansys fluent and the issues arising from their applications to the flow simulations associated with marine propellers the three cavitation models used in the present paper are reviewed as follows 1 1 fcm model it was proposed by singhal et al 2002 and has been characterized as a full cavitation model fcm in that it considers almost all the processes and parameters involved in the occurrence of cavitation such as phase change bubble dynamics turbulence and non condensable gases ncg it has been successfully implemented in several numerical works on marine propellers for example kimura et al 2009 computed the vvf distributions for two five bladed propellers with uniform and non uniform inflows and compared the cavitation extension represented by the area where with hand drew cavitation sketches of the experimental observations zhu 2015 also computed the vvf distributions for four five bladed propellers with different skew angles and used the areas with large vvf values close to 1 to represent the cavitation performances and show their correlation with the skew angles liu 2015 incorporated a formula into the fcm model to account for the non linear variation of the bubble radius and performed numerical simulations for a hydrofoil and a propeller 1 2 z g b model it was proposed by zwart et al 2004 who constructed this model based on the rayleigh plesset equation with an assumption that all micro bubble nuclei in the liquid have the same diameter for example liu et al 2012 used this model with two modified coefficients to simulate cavitating flows around four five bladed skewed propellers and compared the computed cavitation extensions without mentioning the vvf threshold used with hand drew cavitation sketches of the experimental observations another example for the application of this model is the work done by peng et al 2016 who conducted numerical simulations for the formation and development of cloud cavity on twisted and straight hydrofoils and compared the cavitation extension represented by the area where vvf 0 1 with cavitation images acquired using high speed cameras morgut et al 2018 used three cavitation models including this z g b model and the fcm model to simulate the cavitating flows around a propeller and a kaplan turbine runner and compared the results with that of the corresponding experiments 1 3 s s model it was proposed by schnerr and sauer 2001 who also constructed this model based on the rayleigh plesset equation to the best knowledge of the authors it is the most popular cavitation model used to couple with the rans simulations for example gaggero et al 2012 designed a ducted propeller with a coupled lifting line panel method and compared the results of the cavitating flow around the propeller from the rans simulation and the experiment paik et al 2013 simulated the cavitating flow and obtained the hull pressure fluctuation for a propeller operating behind a ship hull under both design and ballast draught conditions gaggero et al 2014 studied the tip vortex cavitation and the tip leakage vortex cavitation generated by a propeller and a ducted propeller respectively liu et al 2016 simulated the tip vortex of a propeller under cavitating and non cavitating flow conditions and compared their results with that of an experiment lin et al 2016 investigated the effects of rotational speed and tip clearance on the performance of a pump jet propulsor wang et al 2017 and wang et al 2018 studied the performance of a cavitating propeller in a heaving motion due to ocean wave and in oscillations respectively as described above it is clearly evident that substantial efforts have been invested in simulating flows associated with marine propellers using the cavitation model coupled rans there are however two major issues remained to be resolved 1 the ranges of cavitation extension reported in previous literatures were determined by setting a vvf threshold which was selected a posteriori i e using comparison with known experimental result as a result this methodology suffers from 1 the huge data reduction from a distribution to a value of the vvf to represent cavitation and 2 the lack of sound physical meaning for the vvf to set a threshold a priori i e without any known experimental result for example the second workshop on cavitation and propeller performance at the fourth international symposium on marine propulsors smp 15 whose proceedings were edited by kinnas et al 2015 requested all the contributions of numerical results to present cavitation extension with two vvf thresholds 0 4 and 0 6 2 all the three cavitation models aforementioned have parameters to be set initially according to the onset conditions of cavitation in the bulk liquid e g mass fraction of non condensable gas the fcm model radius of micro gas bubbles the z g b model number density of micro gas bubbles the s s model saturated vapor pressure and surface tension functions of temperature etc however the exact values of these model parameters except the saturated vapor pressure are difficult and hence expensive and time consuming to obtain as a result default values provided by the model developers are very often used for the parameter setting before running numerical simulations for cavitating flows an issue arises whether the outcome variabilities uncertainties resulting from the uncertainties of the model parameter values are within acceptable ranges or not in order to settle the first issue the present paper uses the methodology of the cavitation occurrence probability cop proposed by chow et al 2017 where they showed the vvf resulting from numerical simulations is equivalent to the cop measured in experiments therefore the whole vvf distribution i e not a single vvf value as the threshold obtained a posteriori is used to represent the likelihood of cavitation occurrence predicted by numerical simulations and compare with the cop distribution measured in experiments for purposes of evaluating calibrating and validating cavitation models one may argue that surface variables other than the vvf could be used to compare with experimental results in order to circumvent this issue e g the pressure distribution of a surface as in congedo et al 2015 for a venturi duct and zhou et al 2018 for a 2d naca66 hydrofoil and a 3d hemispherical head form owing to its complex 3d geometrical and moving rotating nature however it is very difficult to measure the surface pressure of a marine propeller as opposed to the cases of simple and stationary geometries as shown in congedo et al 2015 and zhou et al 2018 therefore the vvf remains to be the most relevant variable in terms of measurability and direct relationship to cavitation for the present study with the cop methodology the present paper attempts to address the second issue by performing rans simulations for a cavitating propeller flow with varying the parameter values of the cavitation models around their default values and analyzing the variabilities of outcomes including the vvf distribution upon the propeller surface and the thrust generated by the propeller about the quantification of uncertainties variabilities associated with cavitation models and further calibration or optimization for model parameters for example congedo et al 2015 and zhou et al 2018 respectively used bayesian based and surrogate based sequential approximate optimization sao approaches these approaches require certain amount of sample points that may cause very time consuming and costly computations for a cavitating propeller flow owing to its complex nature therefore a simple methodology instead will be proposed and used as a measure of the variabilities the present paper is organized as follows section 2 describes the model propeller used in the present rans simulations as well as in a previous experiment section 3 details the modeling efforts of the three cavitation models and the turbulence modeling and numerics of the rans simulations section 4 first presents results regarding the cavitation model performances at default settings and then analyzes the effects caused by parameter variabilities finally section 5 concludes the present study 2 model propeller the propeller used in the present paper is the same as in chow et al 2017 as shown in fig 1 it has four blades whose sectional shape adopts the foil geometry developed by scherer and stairs 1994 its diameter aspect ratio and expanded area ratio ear are 0 25 m 1 00 and 1 00 respectively detailed geometrical ratios at different radii of this propeller are tabulated in table 1 chow et al 2017 used the cop methodology they proposed in an open water test for the present propeller and obtained the cop distribution over the suction side of the blade details follow they also obtained in that experiment the thrust coefficient kt torque coefficient kq and efficiency η o of the present propeller at its design point j 1 14 these experimental data will be used to compare against the numerical results of the rans simulations performed in the present paper 3 cavitation models and rans 3 1 cavitation models as introduced previously the cavitation models evaluated in the present paper are the fcm z g b and s s models proposed by singhal et al 2002 zwart et al 2004 and schnerr and sauer 2001 respectively treating the cavitating flow as an incompressible homogeneous single fluid mixture of liquid and vapor and assuming no slip difference between velocities of liquid and vapor phases the mass transport equation for the vapor phase can be expressed as 1 t α ρ v α ρ v v r e r c where α denotes the vvf ρ v and v the density of the vapor phase and the mixture velocity same as the velocities of liquid and vapor phases since no slip between phases is assumed respectively and r e and r c the mass source terms originated from the vapor bubbles growth evaporation and collapse condensation respectively equation 1 can be regarded as the transport equation of the vvf that will be solved with cavitation models where the mass source terms r e and r c are modeled since the flow is treated as a single fluid mixture of liquid and vapor the fluid properties e g the mixture density ρ can be defined as 2 ρ α ρ v 1 α ρ l where ρ l denotes the density of the liquid phase all the cavitation models investigated here use the same definition for the pressure threshold singhal et al 2002 p ˆ v as 3 p ˆ v p v 1 2 0 39 ρ k where p v and k denote the saturated vapor pressure and turbulent kinetic energy respectively the relation between the fluid pressure p and p ˆ v at certain location determines whether the evaporation process p p ˆ v or condensation process p p ˆ v the fluid at that location undergoes the modeling effort of these cavitation models mainly consists in r e and r c as described as follows fluent manual 2015 3 1 1 fcm model if p p ˆ v 4 r e f v a p max 1 0 k 1 f v f g ℑ ρ l ρ v 2 3 p ˆ v p ρ l r c 0 if p p ˆ v 5 r c f c o n d max 1 0 k f v ℑ ρ l ρ l 2 3 p p ˆ v ρ l r e 0 where f v a p 0 02 and f c o n d 0 01 are fixed the ncg fraction f g and surface tension ℑ are tunable 3 1 2 z g b model if p p ˆ v 6 r e f v a p 3 α n u c 1 α ρ v ℜ b 2 3 p ˆ v p ρ l r c 0 if p p ˆ v 7 r c f c o n d 3 α ρ v ℜ b 2 3 p p ˆ v ρ l r e 0 where the bubble diameter ℜ b nucleation site volume fraction α n u c evaporation coefficient f v a p and condensation coefficient f c o n d are all tunable 3 1 3 s s model if p p ˆ v 8 r e 3 ρ v ρ l ℜ b ρ α 1 α 2 3 p ˆ v p ρ l r c 0 if p p ˆ v 9 r c 3 ρ v ρ l ℜ b ρ α 1 α 2 3 p p ˆ v ρ l r e 0 and 10 ℜ b α 1 α 3 4 π 1 n b 1 3 where the bubble number density n b is tunable the default values of all the tunable parameters for these three cavitation models are listed in table 3 3 2 rans 3 2 1 turbulence modeling the shear stress transport sst k ω model developed by menter 1994 features an integration of better performances of the k ω model in the near wall region and the k ε model in the far field with a blending function as a result the sst k ω model is considered to be more accurate and reliable for broader flow applications than the standard k ω model leading to its adoption for the present study in ansys fluent the default only near wall treatment for ω based models is so called enhanced wall treatment ω equation ewt ω ansys fluent theory guide 2015 it adopts a methodology of blending the laminar linear and turbulent logarithmic parts of the law of the wall with a function not specified similar to the suggestion by kader 1981 this ewt ω formulation is claimed to be y independent and thus more advanced than that of the traditional wall function 3 2 2 rans settings and numerics as listed in table 4 the rans settings for the present study were adopted from chow et al 2017 their computational mesh of 1 4 million grids fig 2 a and its range fig 2 b were also adopted other details including the grid convergence test can be found in chow et al 2017 in the solver the first order upwind scheme was used for the convective terms while the second order central differencing scheme was used for the diffusion terms the mode of steady state calculation was adopted in accordance with the cop methodology applied to an open water test 4 results rans simulations were then performed with different cavitation models whose values of the tunable parameters were varied chow et al 2017 defined the cop as 11 c o p i j n 1 n c n i j n where i and j are the pixel coordinates of n cavitation images at the same phase angle of propeller and c n is the cavitation indicator of the nth image that c n 1 when the point i j is within a cavitation extension and c n 0 otherwise they also obtained the cop distribution of the present propeller in an open water test as shown in fig 3 a in the present paper the vvf distributions resulting from the rans simulations are correlated with this experimental cop distribution using the corr function defined as 12 c o r r a b 1 m 1 i 1 m a i μ a σ a b i μ b σ b where a v v f b c o p m is the total number of the grid points on the propeller surface μ is the mean value of the distribution and σ is the standard deviation of the distribution while the predicted thrust coefficients are compared with the experimental value table 2 4 1 performances of cavitation model at default settings we first repeated the numerical work done by chow et al 2017 to show the rans results simulated individually using the fcm z g b and s s models with their respective tunable parameters at default values as shown in fig 3 and table 5 the vvf distribution simulated using the fcm model exhibits the highest likelihood with the experimental cop distribution with which the corr value calculated using eq 12 is 0 69 higher than 0 60 of the z g b model and much higher than 0 14 of the s s model the differences in the likelihoods of the simulated vvfs with the experimental cop can be mainly attributed to the prediction accuracy of the cop peak location which as show in fig 3 a is very close to the trailing edge and the radius r r of 0 6 as shown in table 5 the fcm model also predicts the thrust of single blade 128 65 n closest to the experimental data 113 80 n whereas the z g b model 140 19 n farthest from it however the present three cavitation models all over predict the thrust by at least 13 4 2 effects of cavitation model parameter variability in order to evaluate the effects of cavitation model parameter variability of rans simulations for marine propeller flows the value of one of the tunable parameters associated with the three present cavitation models i e the non condensable gas fraction ncg of the fcm model the bubble diameter bd nucleation site volume fraction nsv evaporation coefficient ec and condensation coefficient cc of the z g b model and the bubble number density bnd of the s s model was varied between 1 100 and 1 50 of its default value i e test value default value 2 1 or 2 1 while the others of the same model remained at their default values as shown in tables 6 8 some simulation cases all with the z g b model however could not reach converged results with values of the tunable parameters varied that much therefore the tunable parameters tested of such cases were varied around their default values to smaller extents that converged results could be attained as shown in table 7 for example the nsv of the z g b model could be increased up to 0 00075 i e 1 50 of its default value 0 0005 to guarantee a converged result once the vvf distribution of a simulation case was obtained eq 12 was used to calculate its corr values with the cop contour fig 3 a and the vvf distribution with the same cavitation model using default value s for tunable parameter s 4 2 1 fcm model as shown in the second row of table 6 the case of the increasing ncg exhibits a little higher correlation than that of the decreasing ncg both of them however still show a little lower correlation than that of the default ncg i e the default value of the ncg yields the most accurate prediction for the occurrence likelihood of cavitation upon the propeller surface as shown in the third row of table 6 the variations of the ncg only cause corr drops of less than 0 1 i e the corr outcome of the fcm model is not sensitive to the variation of its only tunable parameter ncg fig 4 shows a visual agreement with the corr results just described above that the vvf distribution contours with the varied ncg of the fcm model closely resemble that with the default ncg as shown in fig 3 b however the thrust predicted in the case of the increasing ncg has an appreciable drop to the value of 117 14 n table 6 which is very close to the experimental value of 113 80 n table 5 in contrast the thrust predicted in the case of the decreasing ncg 135 08 n is much larger than the experimental value making it the worst case of both vvf and thrust predictions among the cases with the fcm model 4 2 2 z g b model as shown in the second row of table 7 the case of the decreasing bd exhibits the highest corr value throughout all cases with the z g b model whereas the increasing bd yields the lowest corr value which is only about 0 2 the other two cases showing similarly low corr values about 0 22 are the ones with the decreasing nsv or the decreasing ec nevertheless all other cases with the z g b model exhibit corr values around 0 6 i e the corr value of the case of default settings the similar trend can be observed in the third row of table 7 where the cases of the increasing bd the decreasing nsv and the decreasing ec show lower corr values below 0 68 with the case of default settings while the other cases exhibit significantly higher corr values above 0 86 the vvf distribution contours of these three outstanding cases as shown in fig 5 a increasing bd fig 6 b decreasing nsv and fig 7 b decreasing ec look almost the same featuring peak values and areas much smaller and their locations closer to the mid chore of the blade than that of the other cases with the z g b model including their counter parts i e figs 5 b 6 a and 7 a and the cases of the cc fig 8 all the cases with the z g b model over predict the thrust considerably table 7 i e all of them are above 130 n interestingly the largest thrust predicted pertains to the case of the default settings 140 19 n this result along with the other thrust predictions make it difficult to establish a reasonable correlation between the vvf and thrust predictions as opposed to the cases with the fcm model where the thrust predicted by its case of the default settings 128 65 n table 6 is the median 4 2 3 s s model for the s s model as shown in the second row of table 8 a mild improvement in the correlation with the cop contour from 0 14 to 0 44 is found in the case of the increasing bnd this mild rise of corr results from occurrences of several vvf high peaks from the mid chore to the location close to the trailing edge as shown in fig 9 a the case of the decreasing bnd shows very tiny change in the corr values table 8 as well as the vvf distribution fig 9 b the thrusts predicted by the cases with the s s model are very similar and like the cases with the z g b model over predicted considerably table 8 4 2 4 overall evaluation as shown in fig 10 the most accurate prediction of the vvf distribution i e the highest corr value 0 69 of the vvf distribution with the cop contour fig 3 a pertains to the case of the default settings with the fcm model the second most accurate corr value 0 67 which is very close to the most accurate one as listed above pertains to the case of the increasing ncg with the fcm model however as shown in fig 11 the most accurate prediction of the thrust i e the smallest relative error 2 93 of the thrust prediction to the experimental value pertaining to the case of the increasing ncg with the fcm model are much better than the second most accurate one 13 05 pertaining to the case of the default settings with the fcm model based on such results one might be prompted to use the fcm model with the setting of the increasing ncg in order to attain the most accurate predictability of simulations for cavitating propellers we also examine the variability rates of parameter on the corr value γ c o r r and the thrust γ t which are defined as 13 γ c o r r χ c o r r χ c o r r χ 0 log 2 χ χ 0 c o r r χ 1 log 2 χ χ 0 γ t χ t χ t χ 0 t χ 0 log 2 χ χ 0 where χ denote an increasing or decreasing parameter χ 0 the default value of a parameter corr the correlation values the third rows of tables 6 8 and t the thrust the forth rows of tables 6 8 the variability rate γ c o r r is always negative since c o r r χ is always less than 1 these variability rates can be interpreted as the relative variation of the result per unit variation by a factor of 2 from the default value to the new setting of a parameter serving as an indicator of how sensitive the result uncertainties are to the parameter uncertainties as shown in fig 12 it is clearly evident that the cases of the varied bd nsv and ec with the z g b model have much higher γ c o r r than that of the other three cases whereas the case of the varied bnd with the s s model has the minimal γ c o r r this result suggests that the z g b and the s s models have the most and the least uncertain outcomes of the cavitation distribution because of the uncertainties of their tunable parameters respectively as shown in fig 13 the case of the decreasing ncg with the fcm model has the highest positive and negative γ t values whereas the s s model has the lowest positive and negative γ t values it clearly suggests that the fcm and the s s models have the most and the least uncertain outcomes of the thrust because of the uncertainties of their tunable parameters respectively 5 conclusions rans simulations for a cavitating propeller flow with three popular cavitation models i e the fcm z g b and s s models were performed with their tunable parameters varied to generate the vvf distributions and thrust data for comparisons with the experimental data the vvf distributions were correlated with the experimental cop data measured by chow et al 2017 with the same propeller which generates highly unsteady cavitation that poses challenges on its modeling the thrusts predicted with these rans simulations were also compared with that measured in the same experiment by doing so the outcome variability on the model s predictability due to the tunable parameters can be evaluated the numerical work done by chow et al 2017 were first repeated to show that the fcm model predicts the most accurate vvf distribution and thrust in the group of these three cavitation models when their respective tunable parameters are all set at default values one four and one tunable parameters of the fcm z g b and s s models respectively were then individually varied between 200 and 50 of their default values the resulting corr values show that the fcm model at its default setting predicts the most accurate vvf distribution while the fcm model with the increasing ncg predicts the most accurate thrust and a vvf distribution with the second best highest corr the z g b model at its default settings predicts a vvf distribution with a corr very close to that of the cases of the fcm model whereas it yields the most over predicted thrust the s s model predicts vvf distributions with pretty low corrs mainly because of the shift of the predicted vvf peak from the trailing edge where the cop peaks toward the mid chord of the propeller blade in summary the fcm model is capable of yielding the most accurate vvf distribution and thrust as compared to the other two models the variability rates of parameter were defined and used as an indicator of sensitivity of the outcome variability uncertainty to the parameter uncertainty with regard to the vvf distribution the z g b and s s models yield respectively the most and least outcome variabilities with regard to the thrust the fcm and s s models yield respectively the most and least outcome variabilities in summary the s s model is capable of yielding the most precise certain vvf distribution and thrust as compared to the other two models declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper nomenclature α vapor volume fraction vvf α nuc nucleation site volume fraction ρ fluid mixture density ρ l liquid density ρ v vapor density ν l liquid viscosity σ cavitation number f v vaper mass fraction f g mass fraction of noncondensable gas fvap evapration coefficient fcond condensation coefficient j advance coefficient k tubulent kinetic energy m j i the mss transfer per unit volume from phase j to phase i m i j the mss transfer per unit volume from phase i to phase j n b bubble number per unit volume of liquid p local far field pressure p b bubble pressure ℜ b bubble radius r e mass source term associated with the growth of the vapor bubble r c mass source term associated with the collapse of the vapor bubble ℑ surface tension of bubble 
20907,the pitch ringing vibrations of a vertical cylinder were investigated using a three dimensional numerical model the volume of fluid vof method was used to simulate the wave surface and the shear stress transport sst k ω turbulence model was adopted to simulate the turbulence effect the influence of the grid resolution was analyzed to verify the employed scheme and the numerical simulation accuracy was validated by the experimental results the previously reported experimental wave series was reproduced and the inline forces acting on a fixed cylinder were calculated the added mass moment of inertia induced by the water and its influence on the pitch vibration frequency were studied and the spring stiffness of a cylinder system submerged in still water was determined under the action of focused and regular waves the vibrations of the vertical cylinder model with three natural frequencies were numerically simulated the ringing vibrations for focused wave cases are close to free vibrations and under the regular waves the dominant vibrations in higher natural frequencies cases are close to forced harmonic oscillations the presence of secondary load cycle slc is not a prerequisite for the occurrence of ringing vibrations keywords vertical cylinder ringing vibration secondary load cycle openfoam 1 introduction ringing as defined by chaplin et al 1997 has a severely non gaussian nature generates very high stress levels within a burst of only a few oscillations and occurs only during the passage of very steep waves thus ringing may pose a great threat to the safety and durability of marine structures the ringing response was observed on two oil production platforms natvig and teigen 1993 which has attracted extensive attention and researches grue and huseby 2002 chang et al 2019 cylindrical structures for example the foundations of wind turbines and the support structures for tension leg platforms tlps are the most common structural forms in ocean engineering these structures may experience ringing vibrations the early theoretical studies of higher harmonic wave forces are based on the third order perturbation theory as presented by faltinsen et al 1995 and molin 1995 some hydrodynamic criteria for the ringing loads were described in previous reports tromans et al 2006 bachynski and moan 2014 in addition the secondary load cycle slc as an additional load that appears near the negative peak instant is considered to have a close relationship with the ringing response rainey 2007 rainey and chaplin 2003 however these methods cannot predict the inline forces especially for the minimum forces at the slc stage rainey and chaplin 2003 paulsen et al 2014 bachynski and moan 2014 stated that the aforementioned approaches cannot capture the slc and they are inadequate for analyzing the ringing vibrations to examine the ringing responses of cylinders many previous studies were based on the analyses of the slc acting on fixed cylinders grue et al 2003 experimentally studied the slc under the actions of the long wave cases and found the froude number fr would affect the presence of the slc the slc appears when fr attains 0 35 and become stronger with the increase of fr chaplin et al 1997 experimentally studied the magnitude f c of the slc under different waves and the results showed that the wave steepness had a stronger influence than the fr and irregular pressure distributions were observed around the cylinder riise et al 2018 found that the keulgan carpenter number kc v max t d where v max is the maximum inline velocity of the water particle and t is the wave period was important for the presence of the slc and f c was found to be almost 12 of the peak to peak load hong et al 2015 found that the slc increased with increasing submerged depth antolloni et al 2020 experimentally studied the possible connection between the slc and wave induced vortex and the particle image velocimetry piv method was applied to measure the generated vortex the vortex obviously contributes to the slc under the actions of the long waves the piv measured vorticity emanates from the cylinder s boundary layer is stronger than the vorticity caused by wave breaking no vortical structures appeared in the long wave cases by means of openfoam paulsen et al 2014 simulated the interactions between the regular waves and cylinders the slip boundary condition boundary layer effects were not involved was used to generate some vortical structures the slc was considered to be induced by the upstream propagating flow and the downstream vortex ghadirian and bredmose 2020 numerically simulated the slc under the actions of focused waves and they obtained the slc is mainly induced by the suction pressure at the back of the cylinder boundary layer viscosity and boundary layer separation effects were not considered in their works kristiansen and faltinsen 2017 numerically simulated the vortical structures by using the 2 d les large eddy simulation model to study the effect on the free surface due to flow separation the velocity streamlines near the cylinder were also presented because the flow separation leads to vortex formations the local run up may be induced by the high pressure at the rear of the cylinder some empirical formulas were proposed in fan et al 2018 to quantify the magnitude duration period and occurrence time of slc by kd kh and h h m where h is water depth wang et al 2020 numerically studied the inﬂuences of the kc and fr on the slc the velocity streamlines show that the magnitude of slc has a close relationship with the vortex formation and both kc and fr have effects on the slc magnitude for the presence of slc the general trend of the fr range becomes narrower with increasing kc although the static analysis is simple and critical for studying vibration problems this method cannot accurately capture the mechanism of the ringing phenomenon experimental methods are important for investigating ringing vibrations chaplin et al 1997 first studied the ringing vibrations of a single degree of freedom elastic system and the maximum acceleration was observed when the frequency ratio the natural frequency to the wave frequency was about 3 5 grue and huseby 2002 experimentally studied the ringing motions by scale models of different marine structures in a wave tank and they pointed out that the occurrence of the ringing response was associated with the presence of the slc chaplin et al 1997 and grue and huseby 2002 believed that ringing vibrations were closely related to the slc compared with experimental methods cfd can not only accurately simulate the wave forces on the structure but also obtain the flow field information around the structure cfd may contribute to revealing the mechanism of ringing vibrations for both stationary and vibrating cylinders paulsen et al 2014 used numerical models to simulate the interactions and discussed the wave impacts and the higher harmonic forces jasak et al 2014 studied the harmonic wave loads on a cylinder with different incident waves however the turbulence effect was not considered in their studies han et al 2015 studied the in line vibration response of a flexibly mounted vertical cylinder in regular waves with different wave periods and they found that the simulated responses obtained using a laminar model were lower than the experimental results recently liu et al 2019 numerically simulated the inline force of the cylinder under non breaking and breaking waves and the shear stress transportation sst k ω turbulence model was adopted the numerical results agreed well with the experimental data and the slc was dependent not only on the froude number but also on the wave steepness the location change of separation point can significantly affect the structural stress characteristics the separation point would be more accurately simulated by including a turbulence model in the numerical simulation the sst k ω turbulence model can include transport effects into the formulation of the eddy viscosity which gives accurate predictions of the onset and flow separation under adverse pressure gradients in addition the dissipation rate of the vertical structures can be satisfactorily simulated to make the flow field more realistic therefore this turbulence model has been adopted by many researchers brown et al 2016 choi et al 2015 jose et al 2017 and it was also used in this study to the authors knowledge the numerical simulation considering the turbulence influence of the ringing vibrations of a pitch single degree of freedom cylinder induced by focused waves has not been documented therefore in the present work the ringing vibrations of a three dimensional cylinder were simulated using cfd in openfoam the relationship between the slc and ringing vibration was studied and the mechanism of the ringing vibration was further revealed first the focused wave series in the experiment of chaplin et al was reproduced and the inline forces acting on the fixed cylinder were calculated second referring to the experimental arrangement a pitch single degree of freedom cylinder model was built and the natural frequencies of the cylinder system with different spring stiffnesses were calibrated the ringing vibrations of the cylinder model with three natural frequencies under different focused waves were then simulated finally the mechanism of the ringing vibrations was discussed by comparing the vibrations induced by regular and focused waves the remainder of the paper is organized as follows the numerical methodology is introduced in section 2 in section 3 the mesh convergence analysis is presented the simulation accuracy is validated through comparisons with the experimental results the vortex formations during the slc stage are provided the relationships between vibration amplitude and added mass moment of the inertia added damping ratio are investigated under the actions of focused and regular waves the vibrations of the vertical cylinder models with three natural frequencies are studied in section 4 finally the conclusions of the paper are given in section 5 2 methodology the numerical model is based on the solution of the incompressible navier stokes equations and the pimple pressure implicit method for pressure linked equations computational algorithm weller et al 1998 is used for the solution of pressure velocity coupling the volume of fluid vof hirt and nichols 1981 scheme is adopted to simulate the two phase flow and the governing equations are solved by the open source cfd toolbox openfoam 3 0 x 2 1 governing equations considering the incompressible fluid in a eulerian frame the navier stokes governing equations can be presented as 1a u i x i 0 1b ρ u i t ρ u i u j x j p x i x j μ u i x j ρ u i u j where t and x i denote the time and ith cartesian coordinates u i and u i denote the time averaged and fluctuating flow velocity component respectively p denotes the time averaged pressure ρ and μ are the air density and dynamic viscosity ρ u i u j are the six unknown reynolds stresses which need to be modeled or solved using turbulence models to close the equation system 2 2 vof method the effective volume of fraction method is used to simulate the two phase flow and to capture the free surface and the volume ratio relation between two phases and transport equation can be presented as 2a q 1 2 α q 1 q 1 2 2b α q t u i α q 0 where α q is the volume fraction representing the volume fraction of a cell occupied by the qth fluid which can be evaluated as 3 α q α q 1 0 1 α q 0 w a t e r i n t e r f a c e a i r 2 3 numerical simulation methods in this paper the wavedymfoam solver bruinsma et al 2018 is used to study the vibrations of cylinder systems under incident waves this solver is a combination of two independent programs i e waves2foam and interdymfoam the waves2foam jacobsen et al 2012 jensen et al 2014 is a high precision wave generation scheme the multiphase interdymfoam of openfoam is a segregated fluid structure interaction solver and the computational mesh can dynamically deform with the movement of structure the solution process of the wavedymfoam solver is shown in fig 1 the generation and the elimination of waves in the waves2foam library are simulated by setting parameters of relaxation zone the relaxation algorithm is formulated as 4 φ c φ c o m p u t e d 1 c φ t arg e t where φ is either u or α and the weighting factor c is defined as 5 c x 1 exp x 3 5 1 exp 1 1 where x 0 1 is a local coordinate the length of the relaxation zones is normally set to be one to two times of wave length to improve the stability of wavedymfoam solver the under relaxation method is used in the six degree of freedom 6 dof loop which is formulated as 6 a i f a a i 1 f a a i 1 where a i and a i 1 are the under relaxed acceleration of the gravity center at the i and i 1 time step respectively a i is the acceleration of center of gravity and f a is the under relaxed factor and 0 5 is recommended by bruinsma et al 2018 the velocity equation and pressure equation are solved by the pbigg preconditioned bi conjugate gradient solver and gamg generalized geometric algebraic multi grid method respectively the water volume fraction is solved by the smoothsolver the detailed schemes and methods can be found in openfoam user guide and programmer s guide 3 numerical simulation procedure and validation 3 1 numerical simulation of focused waves chaplin et al 1997 experimentally investigated the ringing vibration and introduced their experiments in detail it is convenient for the researchers to carry out numerical simulations of the tests and compare with the experiment results to verify the correctness of the simulations and these tests could help us to study the relationship between slc and ringing vibrations therefore the focused waves for case745 case765 and case775 in the experiments of chaplin et al 1997 were numerically simulated the related parameters of the three waves are listed in table 1 where η max and h are the wave crest height and wave height k and ka are the wave number and wave steepness respectively where k is calculated by the trough to trough period kc and re are the keulgan carpenter and reynolds numbers respectively the still water depth was 0 525 m and the duration between troughs was close to 1 1 s as mentioned in the experiment the focused wave series was generated by the superposition of 34 simple harmonic wave components the frequencies of which ranged from 0 511 to 1 244 hz with a step of 0 0222 hz the equivalent amplitude and equivalent wave steepness were taken as two control parameters to determine the amplitude a i of each wave component rapp and melville 1990 chaplin and skyner 1990 the relationship between the target amplitude and frequency is presented in fig 2 and the amplitudes a i were averaged using the two calculation methods mentioned in the experiments of chaplin et al 1997 for the numerical simulations although the waves2foam solver provides code to simulate many different wave forms there is no existing program to generate the wave form described in the experiment thus the source code chaplin c and the header file chaplin h were recompiled to reproduce the target waves based on the experimental arrangement of chaplin et al 1997 the schematic diagram of the numerical wave tank is shown in fig 3 the wave generation zone working zone and absorbing zone lengths were 5 4 and 5 m respectively the wave focus point was in the middle of the working zone the 2 d numerical models are used to simulate the waves elevations and the mesh sizes were x l 90 in the horizontal directions where l is the wave length that calculated by the trough to trough period for the mesh density in the vertical direction refined mesh was adopted near the free surface to improve simulation accuracy as well as save calculating resources as shown in fig 3 the numbers of the grid along the a b b c and c d were 50 70 and 40 respectively the numerically simulated wave series of the focus point are shown in fig 4 and the experimental results are also offered for comparison it indicates that the numerical wave height and wave crest coincide well with those of the experimental results the difference turns to be more obvious after the wave crest which may be partly caused by the interactions among wave components similar phenomena were also observed for a freak wave gao et al 2015 3 2 numerical simulation of inline forces and moments on fixed vertical cylinder based on the experiments conducted by chaplin et al 1997 the vertical cylinder was located in the center of the working zone the cylinder diameter d was 100 mm the length l c was not provided by chaplin et al 1997 so l c was initially set to 800 mm based on the figure showing their experiment and its accuracy was further verified later in the analysis the cylinder was fixed and its bottom was 100 mm above from the floor the three dimensional mesh around the cylinder is shown in fig 5 where n c n l and n y are the numbers of cells around the cylinder body fitted cell layers and y axis respectively the maximum dimensionless wall distance y u y υ where u is the friction velocity y is the wall spacing and υ is the dynamic viscosity of the first layer grids was lower than 100 a grid refinement study of the 3 d numerical model was carried out and table 2 lists the grid parameters moreover to ensure the accuracy of the calculation the maximum courant number co max was less than 0 25 and the time step can be written as follows 7 δ t c o max v max δ s where v max is the maximum inline velocity of the water particle and s is the height of the first layer grid all cases in this study were computed with 68 cores using a workstation with 4 intel r xeon 6148 cpus for cases745 755 765 the results of the inline forces with different grid numbers are shown in fig 6 where time instant i corresponds to the maximum inline forces ii iv correspond to the start the peak and the end of the slc generally the results using the three meshes were fairly close especially for the medium and fine meshes thus the medium mesh was adopted due to its simulation accuracy and computation time the slc appeared for case765 and case775 whereas it was not observed for case745 thus the slc will not appear for cases with smaller wave steepness values similar phenomena were also observed by chaplin et al 1997 and grue and huseby 2002 the horizontal velocity streamlines at t iv are shown in fig 7 in which the velocity streamlines are in a horizontal plane perpendicular to the axis of the cylinder for z 0 425m for case765 and case775 two symmetric vortices were generated on the near wall surfaces of both sides of the cylinder during the slc stage in comparison the vortices in case745 were much smaller in fig 6 the corresponding magnitudes of the slc f c referring to the formula of chaplin et al 1997 of case745 case765 and case775 were 0 0 044 and 0 059 respectively thus the vortex size is one important factor affecting the magnitude of the slc for case745 and 765 the vorticity magnitude with different z axis coordinates are shown in figs 8 and 9 respectively where pos1 pos2 and pos3 are in a horizontal plane perpendicular to the axis of the cylinder for z 0 485m 0 425m and 0 365m respectively for the variation of vortical structures along the z axis the snapshots of the vorticity magnitude show that the vortices get smaller with the decrease in the z axis coordinates closer to the position of the wave tank bottom the decay is similar with the piv monitored results antolloni et al 2020 and numerical results wang et al 2020 the numerically simulated and experimental overturning moments are shown in fig 9 overall the two sets of histories match fairly well especially for the maximum moments therefore the estimated length of the cylinder that is 0 8 m was appropriate this is also verified by the numerical simulation accuracy some differences were evident during the slc stage which may have been caused by simulation deviations of the wave series and the unavoidable measurement inaccuracies of the moments in the experiment moreover the slc contained higher harmonic inline forces and it was difficult to simulate this stage accurately 3 3 numerical simulation of free vibrations of a vertical cylinder in still water the single degree of freedom sdof equation of a rigid cylinder in water can be written as follows 8 i i a θ c c a θ k θ m p where m p is the over turning moment i and i a are the model intrinsic and water induced added mass moments of inertia respectively c and c a are the mechanical and water induced added damping coefficients respectively k is the rotational stiffness and θ θ and θ are the pitch acceleration velocity and displacement respectively i a is closely related to the pitch amplitude which will be further demonstrated by the numerical simulation eq choi et al 2015 can be solved by the newmark β strategy as follows 9a θ 1 θ 0 1 γ h θ 0 γ h θ 1 9b θ 1 θ 0 h θ 0 0 5 β h 2 θ 0 β h 2 θ 1 where h is the time step γ 0 5 β 0 25 θ 0 θ 0 and θ 0 are the forward step pitch acceleration velocity and displacement respectively θ 1 θ 1 and θ 1 are the backward step pitch acceleration velocity and displacement respectively in the experiments of chaplin et al the vertical cylinder was constructed using an empty perspex pipe with a 3 mm wall thickness the structural damping ratio measured in air was 0 5 based on the figure presented by chaplin et al l c was measured to be about 0 8 m thus the mass and mass moment of inertia of the pipe were approximated as 0 877 kg and 0 187 kg m2 respectively however the experimental spring mass vibration amplitude and i a were not provided experiments were carried out with linear springs stiffnesses set to achieve the wet resonance frequencies measured in still water equal to 3 82 6 82 and 9 15 hz respectively as shown in fig 10 the simulated cylinder rotates at the bottom of the cylinder through the universal joint and its top tip was supported by two springs in the horizontal plane to allow motion only in the longitudinal direction the transverse vibrations were restricted therefore the cylinder could only vibrate with single degree of freedom under the wave action moreover the universal joint and the springs were simulated through the constraints and restraints code in the dynamicmeshdict program the experimental spring mass unavailable is not included in the numerical simulation which would generate larger responses compared with the experimental results it should be stated that the spring stiffness could not accurately predetermined to obtain the target wet frequency several iteration loops were required to make the appropriate spring stiffness accommodate the target wet frequency for a specific spring stiffness the model was excited with an initial small torsional angle θ 0 005 to produce free vibrations in the water based on the displacement histories the vibration frequency could be identified for some cases the relationships between f and k s 1 2 are shown in fig 11 a f varied almost linearly with k s 1 2 which indicated that i a small displacement was nearly independent of k s in the region of interest for a vibrated cylinder frequency f hz in water i a can be formulated as follows 10 i a k s l c 2 2 π 2 f 2 i for the examined cases i a is shown in fig 11 a with values in the 0 24 0 27 kg m2 range based on the relationship between k s and f after several loop attempts the spring stiffness corresponding to the 3 82 6 82 and 9 15 hz frequencies were calibrated to be 198 649 and 1154 n m respectively and the vibration time histories of the three target cases were shown in fig 11 b because the models were excited with an initial small torsional angle the instantaneous frequencies did not vary significantly with the torsion displacements to further study the relationship between the vibrational frequency and torsional amplitude of the sdof model the initial excitation of the large torsion angular θ 5 was applied in the numerical models with different ks values 198 649 and 1154 n m respectively the instantaneous frequency varied with the torsion displacement and their relationship curves are shown in fig 12 where the zero crossing method huang et al 2019 was used to calculated the instantaneous frequency the instantaneous frequency decreased with increasing vibration amplitude which indicated that i a increased with the amplitude the amplitude dependent i a and ξ a can be extracted from the time varying torsional displacement shown in fig 12 which are shown in fig 13 some observations are summarized as follows 1 the i a and ξ a increase with the vibration amplitude the ξ a approximately varies with the amplitude the i a is around 0 26 kg m2 when the amplitude is close to zero in the concerned amplitude region the i a approximately varies with the amplitude therefore it is an important issue to understand the influence of amplitude on i a and ξ a 2 for the three cases in still water the i a and ξ a values were respectively close thus i a and ξ a were almost independent of the vibration frequency in the experiment it is very normal to add an initial horizontal excitation of 40 mm or larger at the cylinder tip correspondingly the torsional angle exceeded 3 and the maximum i a could reach 0 305 kg m2 in the experiment it is unusual or difficult to use a very small amplitude e g 1 which can be accurately conducted in the numerical simulation therefore the experimental i a was inevitably larger than that of the numerical data and the experimental ks was consequently relatively larger in other words the experimental system is more rigid than that of the numerical one and correspondingly the vibrations will be lower than that of the numerical simulations from this viewpoint when i a 0 305 kg m2 the ks values were calculated to be 221 705 and 1269 n m unfortunately the experimental ks were not provided in the report by chaplin et al 1997 it is inappropriate to measure the natural frequency using a large initial horizontal excitation 4 numerical simulation and analysis of ringing vibrations 4 1 numerical simulation of ringing vibrations under the actions of waves in case745 and case775 the ringing responses of the vertical cylinder with three frequencies were numerically simulated using the aforementioned wavedymfoam solver in order to save the computation time and resources the cylinder kept fixed until the focused waves acted on it then the cylinder released the fixed constraints and became sdof system that was presented in fig 10 the horizontal acceleration a at the still water level are shown in fig 14 and the experimental results by chaplin et al 1997 are also provided for comparison the dominant frequency f t 0 5 2 5 s and the maximum acceleration a max are listed in table 3 some of the findings can be summarized as follows 1 frequency differences between the experimental and numerical results were evident this may have been caused by the different spring stiffnesses adopted in the experiment and numerical simulations it is normal to generate a larger initial displacement e g 3 in the experiment which is larger than the maximum displacement 1 5 of the ringing response in the numerical simulation the initial displacement was set as approximately 0 005 which was much lower than those of the ringing response and initial displacement in the experiment therefore the k s applied in the experiment was larger than that of the numerical simulation consequently the experimental and numerical ringing vibration frequencies were respectively higher and lower than the frequencies in still water 2 the frequency difference between the numerical and experimental ringing vibrations increased with the initial frequency the frequency deviation can be approximately expressed as follows 11 δ f k s 2 π 2 l c 2 i i a n u m 2 l c 2 i i a e x p where f is determined by k s and the deviation between i a n u m and i a e x p compared with the values of k s the term in parentheses was basically a constant in the three wave cases so f increased as k s increased bruinsma et al 2018 vibration amplitude differences between the experimental and numerical results were evident the numerically simulated amplitude in the 3 82 hz case was closer to the experimental results than the amplitudes of the 6 82 and 9 15 hz cases which can be ascribed to the different k s values of the two systems the spring stiffness deviations can be approximately expressed as follows 12 δ k s 2 π 2 f 2 l 2 i a e x p i a n u m where k s is determined by the target f and the deviation between and i a n u m and i a e x p and k s increases with increasing the target f therefore the k s for the low frequency numerical case are closer to the experimental data it is clear that the simulation accuracies of lower frequency cases are relatively better in addition l c was approximated from the figure presented by chaplin et al as it was not directly offered in the reference furthermore the spring mass unknown in the experiment was not considered in the numerical simulations therefore the value of i in the numerical simulation may have been lower than that of the experimental system to study the influence of i and the mechanical damping ratio ξ m on the ringing response the numerical model for case775 with a 6 82 hz frequency was taken as the reference case the parameters of the different cases are listed in table 4 h c is the height of the center of cylinder mass h s is the height of the anchorage point of the springs and ξ m represents the mechanical damping ratio the frequencies of all the cases were calibrated to be 6 82 hz by adjusting the spring stiffness k s 561 649 and 763 n m for case 775 1 case 775 2 and case 775 3 respectively for case775 1 case775 2 and case775 3 the simulated horizontal acceleration a values are shown in fig 15 a the cylinder i a had a remarkable influence on the vibration response and the maximum acceleration values of the three cases were 2 19 1 91 and 1 52 ms 2 respectively the ringing vibrations with different mechanical damping ratios sampling time t 0 5 2 5 s are shown in fig 15 b the total damping ratios were 1 60 1 73 and 1 87 respectively when the superposition assumption was adopted the additional damping ratios were 1 25 1 23 and 1 22 respectively this indicates that the additional damping ratio was almost independent of the mechanical damping ratio in the region of interest 4 2 analyses and discussions grue and huseby 2002 demonstrated that if the resonant frequency is approximately four times of the wave frequency slc contributes to the formation of the resonant body response chang et al 2019 stated that the frequency of the slc may be up to 13 times of the wave frequency in this study although the slc was not found in case745 ringing vibrations for the three frequency cases were observed the inline forces acting on the fixed and vibrated cylinder are simultaneously shown in fig 16 the inline forces for the vibrating cylinder showed more fluctuations especially for case765 and case775 the excitation forces acting on the vibrated cylinders contained two dominant frequency components which were approximately equal to wave frequency 0 91 hz and natural frequencies 3 82 6 82 and 9 15 hz respectively moreover the magnitudes of the higher order components were not only related to the wave conditions but they were also influenced by the stiffness of structure therefore it is not inappropriate to use the static force i e the slc to predict the occurrence possibility of ringing to further illustrate the free vibration behaviors of the ringing response the inline force differences f between the fixed and vibrated cylinders of case765 f 3 82 hz as well as the time varying displacements at the still water level are shown in fig 17 the same phase of oscillation with f indicates the free vibrations of the ringing response the initial displacement was first excited by the main peak of the total wave forces and subsequently the roll restoring moment became the main motivation for the ringing vibrations according to hunt et al 1988 the vortex structures in the flow field can be identified by the second invariant q of velocity gradient tensor u 13 q 1 2 ω 2 s 2 where s 1 2 u i x j u i x i and ω 1 2 u i x j u i x i are the symmetric and antisymmetric components of u respectively q represents the local balance between shear strain rate and vorticity magnitude and higher q means a higher vortex intensity this q criterion is known to be more appropriate than the vorticity criterion for extracting the vortex structures especially in the near wall region where the flow shear effect is prominent for case765 f 3 82 hz when the second invariant q 100 four typical instantaneous iso surfaces are shown in fig 18 and the corresponding four typical instants are marked in fig 17 with green points as shown in fig 18 the vortices mainly appeared in front of the structure when the cylinder attained the maximum positive displacement fig 18 b and the vortices mainly appeared behind the structure when the cylinder had maximum negative displacement fig 18 d the vortices were located on the side of the cylinder when the displacement of the structure was close to zero 4 3 the possibility of springing vibration under the action of regular wave in the aforementioned section we demonstrated that the ringing vibration could be observed even without the slc for the corresponding fixed cylinder which contradicts the conventional belief the ringing and springing vibrations usually occur in steep focused waves and mild regular waves states respectively srinivasan et al 2011 and the springing is defined as steady state resonant vibration of the marine structures kim et al 2009 in this section we further studied that for some regular stokes wave cases the springing vibrations do not occur even when the slc is evident the wave steepness ka values of cases745 765 and 775 0 208 0 299 and 0 345 respectively were selected as target parameters to generate 5th order stokes waves and the corresponding wave heights were 0 110 0 158 and 0 197 m respectively fixed and vibrated cases under the regular waves were also built to verify the relationship between the slc and springing vibrations and more details of the numerical cases are shown in table 5 the inline forces acting on the fixed and vibrated cylinder for the two regular wave cases are shown in fig 19 the slc was observed in cases 2 and 3 but not in case1 the inline forces for the vibrating cylinder also showed fluctuations under regular waves this indicated that those excitation forces acting on the vibrated systems also contained two dominant frequency components which were approximately equal to the wave frequency 0 91 hz and natural frequencies 3 82 6 82 and 9 15 hz respectively the flow fields at t iv in case1 case2 and case3 were obtained as shown in fig 20 the velocity streamlines were in a horizontal plane perpendicular to the axis of the cylinder for z 0 425 m similar to the analysis of the focused waves cases the vortices were more evident in steep waves thus regardless of the type of wave the slc was related to wave steepness ka and the downstream vortices were the main cause of the slc in addition compared with the vertical structures in focused waves fig 7 the downstream vortices in case2 and case765 were similar in size and they were much smaller than that in case3 and case775 the f c values in case1 case2 and case3 were 0 0 042 and 0 048 respectively according to the simulation results in fig 7 it found that the f c increased with the increase in the vortex size referring to the method described above the sdof cylinder models with three different spring stiffnesses in cases 1 2 and 3 were simulated under the actions of regular waves case1 case2 and case3 and focused waves case745 case765 and case775 the displacement records at the still water level for the three natural frequency cases are shown in fig 21 the vibrations in regular wave cases are different with the typical ringing vibrations in the focused wave cases based on the simulations the springing vibrations occur for the lower natural frequency cases 3 82 hz while in the higher natural frequencies cases the springing vibrations are not obvious the fft analysis was performed on the displacement histories to calculate the ratio r s n s w where s n represents the amplitude near the natural frequencies of 3 82 6 82 and 9 15 hz and s w is the amplitude at the wave frequency in relation to the trough to trough period of the wave the results are shown in fig 22 for the focused wave cases with ringing vibrations the r values were much larger than those of the regular wave cases without ringing vibrations this indicates that the ringing vibrations were mainly free vibrations and their magnitudes were predominantly affected by the peak of the total wave forces in addition the springing vibrations in the low natural frequency cases under the regular waves were different from the typical ringing vibrations in the focused wave cases and under the actions of regular waves the vibration form in higher natural frequency cases were close to sustained forced harmonic oscillations 5 concluding remarks the waves2foam and wavedymfoam solvers were used to numerically simulate the interactions between the waves focused and or regular and cylinders fixed and or vibrated the simulated wave series and over turning moment acting on the fixed cylinder were in good agreement with those of the experimental data the slc and ringing vibrations were monitored in numerical simulations the ringing vibration differences between the experimental and numerical simulations were analyzed to unveil the possible causes the characteristics of the inline forces were discussed in detail for both focused and regular waves with different wave steepness values and natural frequencies for the specific wave cases in this study the ringing vibrations could be observed even without the slc and springing vibrations did not occur even when the slc was evident therefore it is inappropriate to judge the occurrence of ringing and springing vibrations only by the presence of slc the ringing vibrations in focused wave cases are free vibrations and under regular waves the dominant vibrations in higher natural frequencies cases are close to forced harmonic oscillations the added mass moment of the inertia and added damping ratio increase with the amplitude which should be carefully considered and accurately quantified for the quasi static calculations of large amplitude ringing vibrations if a constant added mass moment of the inertia and added damping ratio that measured or simulated at a small amplitude are used the amplitude would be overestimated credit authorship contribution statement fuyou xu conceptualization supervision resources writing review editing visualization yuqi wang methodology software validation formal analysis data curation writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is supported by the national natural science foundation of china 51978130 
20907,the pitch ringing vibrations of a vertical cylinder were investigated using a three dimensional numerical model the volume of fluid vof method was used to simulate the wave surface and the shear stress transport sst k ω turbulence model was adopted to simulate the turbulence effect the influence of the grid resolution was analyzed to verify the employed scheme and the numerical simulation accuracy was validated by the experimental results the previously reported experimental wave series was reproduced and the inline forces acting on a fixed cylinder were calculated the added mass moment of inertia induced by the water and its influence on the pitch vibration frequency were studied and the spring stiffness of a cylinder system submerged in still water was determined under the action of focused and regular waves the vibrations of the vertical cylinder model with three natural frequencies were numerically simulated the ringing vibrations for focused wave cases are close to free vibrations and under the regular waves the dominant vibrations in higher natural frequencies cases are close to forced harmonic oscillations the presence of secondary load cycle slc is not a prerequisite for the occurrence of ringing vibrations keywords vertical cylinder ringing vibration secondary load cycle openfoam 1 introduction ringing as defined by chaplin et al 1997 has a severely non gaussian nature generates very high stress levels within a burst of only a few oscillations and occurs only during the passage of very steep waves thus ringing may pose a great threat to the safety and durability of marine structures the ringing response was observed on two oil production platforms natvig and teigen 1993 which has attracted extensive attention and researches grue and huseby 2002 chang et al 2019 cylindrical structures for example the foundations of wind turbines and the support structures for tension leg platforms tlps are the most common structural forms in ocean engineering these structures may experience ringing vibrations the early theoretical studies of higher harmonic wave forces are based on the third order perturbation theory as presented by faltinsen et al 1995 and molin 1995 some hydrodynamic criteria for the ringing loads were described in previous reports tromans et al 2006 bachynski and moan 2014 in addition the secondary load cycle slc as an additional load that appears near the negative peak instant is considered to have a close relationship with the ringing response rainey 2007 rainey and chaplin 2003 however these methods cannot predict the inline forces especially for the minimum forces at the slc stage rainey and chaplin 2003 paulsen et al 2014 bachynski and moan 2014 stated that the aforementioned approaches cannot capture the slc and they are inadequate for analyzing the ringing vibrations to examine the ringing responses of cylinders many previous studies were based on the analyses of the slc acting on fixed cylinders grue et al 2003 experimentally studied the slc under the actions of the long wave cases and found the froude number fr would affect the presence of the slc the slc appears when fr attains 0 35 and become stronger with the increase of fr chaplin et al 1997 experimentally studied the magnitude f c of the slc under different waves and the results showed that the wave steepness had a stronger influence than the fr and irregular pressure distributions were observed around the cylinder riise et al 2018 found that the keulgan carpenter number kc v max t d where v max is the maximum inline velocity of the water particle and t is the wave period was important for the presence of the slc and f c was found to be almost 12 of the peak to peak load hong et al 2015 found that the slc increased with increasing submerged depth antolloni et al 2020 experimentally studied the possible connection between the slc and wave induced vortex and the particle image velocimetry piv method was applied to measure the generated vortex the vortex obviously contributes to the slc under the actions of the long waves the piv measured vorticity emanates from the cylinder s boundary layer is stronger than the vorticity caused by wave breaking no vortical structures appeared in the long wave cases by means of openfoam paulsen et al 2014 simulated the interactions between the regular waves and cylinders the slip boundary condition boundary layer effects were not involved was used to generate some vortical structures the slc was considered to be induced by the upstream propagating flow and the downstream vortex ghadirian and bredmose 2020 numerically simulated the slc under the actions of focused waves and they obtained the slc is mainly induced by the suction pressure at the back of the cylinder boundary layer viscosity and boundary layer separation effects were not considered in their works kristiansen and faltinsen 2017 numerically simulated the vortical structures by using the 2 d les large eddy simulation model to study the effect on the free surface due to flow separation the velocity streamlines near the cylinder were also presented because the flow separation leads to vortex formations the local run up may be induced by the high pressure at the rear of the cylinder some empirical formulas were proposed in fan et al 2018 to quantify the magnitude duration period and occurrence time of slc by kd kh and h h m where h is water depth wang et al 2020 numerically studied the inﬂuences of the kc and fr on the slc the velocity streamlines show that the magnitude of slc has a close relationship with the vortex formation and both kc and fr have effects on the slc magnitude for the presence of slc the general trend of the fr range becomes narrower with increasing kc although the static analysis is simple and critical for studying vibration problems this method cannot accurately capture the mechanism of the ringing phenomenon experimental methods are important for investigating ringing vibrations chaplin et al 1997 first studied the ringing vibrations of a single degree of freedom elastic system and the maximum acceleration was observed when the frequency ratio the natural frequency to the wave frequency was about 3 5 grue and huseby 2002 experimentally studied the ringing motions by scale models of different marine structures in a wave tank and they pointed out that the occurrence of the ringing response was associated with the presence of the slc chaplin et al 1997 and grue and huseby 2002 believed that ringing vibrations were closely related to the slc compared with experimental methods cfd can not only accurately simulate the wave forces on the structure but also obtain the flow field information around the structure cfd may contribute to revealing the mechanism of ringing vibrations for both stationary and vibrating cylinders paulsen et al 2014 used numerical models to simulate the interactions and discussed the wave impacts and the higher harmonic forces jasak et al 2014 studied the harmonic wave loads on a cylinder with different incident waves however the turbulence effect was not considered in their studies han et al 2015 studied the in line vibration response of a flexibly mounted vertical cylinder in regular waves with different wave periods and they found that the simulated responses obtained using a laminar model were lower than the experimental results recently liu et al 2019 numerically simulated the inline force of the cylinder under non breaking and breaking waves and the shear stress transportation sst k ω turbulence model was adopted the numerical results agreed well with the experimental data and the slc was dependent not only on the froude number but also on the wave steepness the location change of separation point can significantly affect the structural stress characteristics the separation point would be more accurately simulated by including a turbulence model in the numerical simulation the sst k ω turbulence model can include transport effects into the formulation of the eddy viscosity which gives accurate predictions of the onset and flow separation under adverse pressure gradients in addition the dissipation rate of the vertical structures can be satisfactorily simulated to make the flow field more realistic therefore this turbulence model has been adopted by many researchers brown et al 2016 choi et al 2015 jose et al 2017 and it was also used in this study to the authors knowledge the numerical simulation considering the turbulence influence of the ringing vibrations of a pitch single degree of freedom cylinder induced by focused waves has not been documented therefore in the present work the ringing vibrations of a three dimensional cylinder were simulated using cfd in openfoam the relationship between the slc and ringing vibration was studied and the mechanism of the ringing vibration was further revealed first the focused wave series in the experiment of chaplin et al was reproduced and the inline forces acting on the fixed cylinder were calculated second referring to the experimental arrangement a pitch single degree of freedom cylinder model was built and the natural frequencies of the cylinder system with different spring stiffnesses were calibrated the ringing vibrations of the cylinder model with three natural frequencies under different focused waves were then simulated finally the mechanism of the ringing vibrations was discussed by comparing the vibrations induced by regular and focused waves the remainder of the paper is organized as follows the numerical methodology is introduced in section 2 in section 3 the mesh convergence analysis is presented the simulation accuracy is validated through comparisons with the experimental results the vortex formations during the slc stage are provided the relationships between vibration amplitude and added mass moment of the inertia added damping ratio are investigated under the actions of focused and regular waves the vibrations of the vertical cylinder models with three natural frequencies are studied in section 4 finally the conclusions of the paper are given in section 5 2 methodology the numerical model is based on the solution of the incompressible navier stokes equations and the pimple pressure implicit method for pressure linked equations computational algorithm weller et al 1998 is used for the solution of pressure velocity coupling the volume of fluid vof hirt and nichols 1981 scheme is adopted to simulate the two phase flow and the governing equations are solved by the open source cfd toolbox openfoam 3 0 x 2 1 governing equations considering the incompressible fluid in a eulerian frame the navier stokes governing equations can be presented as 1a u i x i 0 1b ρ u i t ρ u i u j x j p x i x j μ u i x j ρ u i u j where t and x i denote the time and ith cartesian coordinates u i and u i denote the time averaged and fluctuating flow velocity component respectively p denotes the time averaged pressure ρ and μ are the air density and dynamic viscosity ρ u i u j are the six unknown reynolds stresses which need to be modeled or solved using turbulence models to close the equation system 2 2 vof method the effective volume of fraction method is used to simulate the two phase flow and to capture the free surface and the volume ratio relation between two phases and transport equation can be presented as 2a q 1 2 α q 1 q 1 2 2b α q t u i α q 0 where α q is the volume fraction representing the volume fraction of a cell occupied by the qth fluid which can be evaluated as 3 α q α q 1 0 1 α q 0 w a t e r i n t e r f a c e a i r 2 3 numerical simulation methods in this paper the wavedymfoam solver bruinsma et al 2018 is used to study the vibrations of cylinder systems under incident waves this solver is a combination of two independent programs i e waves2foam and interdymfoam the waves2foam jacobsen et al 2012 jensen et al 2014 is a high precision wave generation scheme the multiphase interdymfoam of openfoam is a segregated fluid structure interaction solver and the computational mesh can dynamically deform with the movement of structure the solution process of the wavedymfoam solver is shown in fig 1 the generation and the elimination of waves in the waves2foam library are simulated by setting parameters of relaxation zone the relaxation algorithm is formulated as 4 φ c φ c o m p u t e d 1 c φ t arg e t where φ is either u or α and the weighting factor c is defined as 5 c x 1 exp x 3 5 1 exp 1 1 where x 0 1 is a local coordinate the length of the relaxation zones is normally set to be one to two times of wave length to improve the stability of wavedymfoam solver the under relaxation method is used in the six degree of freedom 6 dof loop which is formulated as 6 a i f a a i 1 f a a i 1 where a i and a i 1 are the under relaxed acceleration of the gravity center at the i and i 1 time step respectively a i is the acceleration of center of gravity and f a is the under relaxed factor and 0 5 is recommended by bruinsma et al 2018 the velocity equation and pressure equation are solved by the pbigg preconditioned bi conjugate gradient solver and gamg generalized geometric algebraic multi grid method respectively the water volume fraction is solved by the smoothsolver the detailed schemes and methods can be found in openfoam user guide and programmer s guide 3 numerical simulation procedure and validation 3 1 numerical simulation of focused waves chaplin et al 1997 experimentally investigated the ringing vibration and introduced their experiments in detail it is convenient for the researchers to carry out numerical simulations of the tests and compare with the experiment results to verify the correctness of the simulations and these tests could help us to study the relationship between slc and ringing vibrations therefore the focused waves for case745 case765 and case775 in the experiments of chaplin et al 1997 were numerically simulated the related parameters of the three waves are listed in table 1 where η max and h are the wave crest height and wave height k and ka are the wave number and wave steepness respectively where k is calculated by the trough to trough period kc and re are the keulgan carpenter and reynolds numbers respectively the still water depth was 0 525 m and the duration between troughs was close to 1 1 s as mentioned in the experiment the focused wave series was generated by the superposition of 34 simple harmonic wave components the frequencies of which ranged from 0 511 to 1 244 hz with a step of 0 0222 hz the equivalent amplitude and equivalent wave steepness were taken as two control parameters to determine the amplitude a i of each wave component rapp and melville 1990 chaplin and skyner 1990 the relationship between the target amplitude and frequency is presented in fig 2 and the amplitudes a i were averaged using the two calculation methods mentioned in the experiments of chaplin et al 1997 for the numerical simulations although the waves2foam solver provides code to simulate many different wave forms there is no existing program to generate the wave form described in the experiment thus the source code chaplin c and the header file chaplin h were recompiled to reproduce the target waves based on the experimental arrangement of chaplin et al 1997 the schematic diagram of the numerical wave tank is shown in fig 3 the wave generation zone working zone and absorbing zone lengths were 5 4 and 5 m respectively the wave focus point was in the middle of the working zone the 2 d numerical models are used to simulate the waves elevations and the mesh sizes were x l 90 in the horizontal directions where l is the wave length that calculated by the trough to trough period for the mesh density in the vertical direction refined mesh was adopted near the free surface to improve simulation accuracy as well as save calculating resources as shown in fig 3 the numbers of the grid along the a b b c and c d were 50 70 and 40 respectively the numerically simulated wave series of the focus point are shown in fig 4 and the experimental results are also offered for comparison it indicates that the numerical wave height and wave crest coincide well with those of the experimental results the difference turns to be more obvious after the wave crest which may be partly caused by the interactions among wave components similar phenomena were also observed for a freak wave gao et al 2015 3 2 numerical simulation of inline forces and moments on fixed vertical cylinder based on the experiments conducted by chaplin et al 1997 the vertical cylinder was located in the center of the working zone the cylinder diameter d was 100 mm the length l c was not provided by chaplin et al 1997 so l c was initially set to 800 mm based on the figure showing their experiment and its accuracy was further verified later in the analysis the cylinder was fixed and its bottom was 100 mm above from the floor the three dimensional mesh around the cylinder is shown in fig 5 where n c n l and n y are the numbers of cells around the cylinder body fitted cell layers and y axis respectively the maximum dimensionless wall distance y u y υ where u is the friction velocity y is the wall spacing and υ is the dynamic viscosity of the first layer grids was lower than 100 a grid refinement study of the 3 d numerical model was carried out and table 2 lists the grid parameters moreover to ensure the accuracy of the calculation the maximum courant number co max was less than 0 25 and the time step can be written as follows 7 δ t c o max v max δ s where v max is the maximum inline velocity of the water particle and s is the height of the first layer grid all cases in this study were computed with 68 cores using a workstation with 4 intel r xeon 6148 cpus for cases745 755 765 the results of the inline forces with different grid numbers are shown in fig 6 where time instant i corresponds to the maximum inline forces ii iv correspond to the start the peak and the end of the slc generally the results using the three meshes were fairly close especially for the medium and fine meshes thus the medium mesh was adopted due to its simulation accuracy and computation time the slc appeared for case765 and case775 whereas it was not observed for case745 thus the slc will not appear for cases with smaller wave steepness values similar phenomena were also observed by chaplin et al 1997 and grue and huseby 2002 the horizontal velocity streamlines at t iv are shown in fig 7 in which the velocity streamlines are in a horizontal plane perpendicular to the axis of the cylinder for z 0 425m for case765 and case775 two symmetric vortices were generated on the near wall surfaces of both sides of the cylinder during the slc stage in comparison the vortices in case745 were much smaller in fig 6 the corresponding magnitudes of the slc f c referring to the formula of chaplin et al 1997 of case745 case765 and case775 were 0 0 044 and 0 059 respectively thus the vortex size is one important factor affecting the magnitude of the slc for case745 and 765 the vorticity magnitude with different z axis coordinates are shown in figs 8 and 9 respectively where pos1 pos2 and pos3 are in a horizontal plane perpendicular to the axis of the cylinder for z 0 485m 0 425m and 0 365m respectively for the variation of vortical structures along the z axis the snapshots of the vorticity magnitude show that the vortices get smaller with the decrease in the z axis coordinates closer to the position of the wave tank bottom the decay is similar with the piv monitored results antolloni et al 2020 and numerical results wang et al 2020 the numerically simulated and experimental overturning moments are shown in fig 9 overall the two sets of histories match fairly well especially for the maximum moments therefore the estimated length of the cylinder that is 0 8 m was appropriate this is also verified by the numerical simulation accuracy some differences were evident during the slc stage which may have been caused by simulation deviations of the wave series and the unavoidable measurement inaccuracies of the moments in the experiment moreover the slc contained higher harmonic inline forces and it was difficult to simulate this stage accurately 3 3 numerical simulation of free vibrations of a vertical cylinder in still water the single degree of freedom sdof equation of a rigid cylinder in water can be written as follows 8 i i a θ c c a θ k θ m p where m p is the over turning moment i and i a are the model intrinsic and water induced added mass moments of inertia respectively c and c a are the mechanical and water induced added damping coefficients respectively k is the rotational stiffness and θ θ and θ are the pitch acceleration velocity and displacement respectively i a is closely related to the pitch amplitude which will be further demonstrated by the numerical simulation eq choi et al 2015 can be solved by the newmark β strategy as follows 9a θ 1 θ 0 1 γ h θ 0 γ h θ 1 9b θ 1 θ 0 h θ 0 0 5 β h 2 θ 0 β h 2 θ 1 where h is the time step γ 0 5 β 0 25 θ 0 θ 0 and θ 0 are the forward step pitch acceleration velocity and displacement respectively θ 1 θ 1 and θ 1 are the backward step pitch acceleration velocity and displacement respectively in the experiments of chaplin et al the vertical cylinder was constructed using an empty perspex pipe with a 3 mm wall thickness the structural damping ratio measured in air was 0 5 based on the figure presented by chaplin et al l c was measured to be about 0 8 m thus the mass and mass moment of inertia of the pipe were approximated as 0 877 kg and 0 187 kg m2 respectively however the experimental spring mass vibration amplitude and i a were not provided experiments were carried out with linear springs stiffnesses set to achieve the wet resonance frequencies measured in still water equal to 3 82 6 82 and 9 15 hz respectively as shown in fig 10 the simulated cylinder rotates at the bottom of the cylinder through the universal joint and its top tip was supported by two springs in the horizontal plane to allow motion only in the longitudinal direction the transverse vibrations were restricted therefore the cylinder could only vibrate with single degree of freedom under the wave action moreover the universal joint and the springs were simulated through the constraints and restraints code in the dynamicmeshdict program the experimental spring mass unavailable is not included in the numerical simulation which would generate larger responses compared with the experimental results it should be stated that the spring stiffness could not accurately predetermined to obtain the target wet frequency several iteration loops were required to make the appropriate spring stiffness accommodate the target wet frequency for a specific spring stiffness the model was excited with an initial small torsional angle θ 0 005 to produce free vibrations in the water based on the displacement histories the vibration frequency could be identified for some cases the relationships between f and k s 1 2 are shown in fig 11 a f varied almost linearly with k s 1 2 which indicated that i a small displacement was nearly independent of k s in the region of interest for a vibrated cylinder frequency f hz in water i a can be formulated as follows 10 i a k s l c 2 2 π 2 f 2 i for the examined cases i a is shown in fig 11 a with values in the 0 24 0 27 kg m2 range based on the relationship between k s and f after several loop attempts the spring stiffness corresponding to the 3 82 6 82 and 9 15 hz frequencies were calibrated to be 198 649 and 1154 n m respectively and the vibration time histories of the three target cases were shown in fig 11 b because the models were excited with an initial small torsional angle the instantaneous frequencies did not vary significantly with the torsion displacements to further study the relationship between the vibrational frequency and torsional amplitude of the sdof model the initial excitation of the large torsion angular θ 5 was applied in the numerical models with different ks values 198 649 and 1154 n m respectively the instantaneous frequency varied with the torsion displacement and their relationship curves are shown in fig 12 where the zero crossing method huang et al 2019 was used to calculated the instantaneous frequency the instantaneous frequency decreased with increasing vibration amplitude which indicated that i a increased with the amplitude the amplitude dependent i a and ξ a can be extracted from the time varying torsional displacement shown in fig 12 which are shown in fig 13 some observations are summarized as follows 1 the i a and ξ a increase with the vibration amplitude the ξ a approximately varies with the amplitude the i a is around 0 26 kg m2 when the amplitude is close to zero in the concerned amplitude region the i a approximately varies with the amplitude therefore it is an important issue to understand the influence of amplitude on i a and ξ a 2 for the three cases in still water the i a and ξ a values were respectively close thus i a and ξ a were almost independent of the vibration frequency in the experiment it is very normal to add an initial horizontal excitation of 40 mm or larger at the cylinder tip correspondingly the torsional angle exceeded 3 and the maximum i a could reach 0 305 kg m2 in the experiment it is unusual or difficult to use a very small amplitude e g 1 which can be accurately conducted in the numerical simulation therefore the experimental i a was inevitably larger than that of the numerical data and the experimental ks was consequently relatively larger in other words the experimental system is more rigid than that of the numerical one and correspondingly the vibrations will be lower than that of the numerical simulations from this viewpoint when i a 0 305 kg m2 the ks values were calculated to be 221 705 and 1269 n m unfortunately the experimental ks were not provided in the report by chaplin et al 1997 it is inappropriate to measure the natural frequency using a large initial horizontal excitation 4 numerical simulation and analysis of ringing vibrations 4 1 numerical simulation of ringing vibrations under the actions of waves in case745 and case775 the ringing responses of the vertical cylinder with three frequencies were numerically simulated using the aforementioned wavedymfoam solver in order to save the computation time and resources the cylinder kept fixed until the focused waves acted on it then the cylinder released the fixed constraints and became sdof system that was presented in fig 10 the horizontal acceleration a at the still water level are shown in fig 14 and the experimental results by chaplin et al 1997 are also provided for comparison the dominant frequency f t 0 5 2 5 s and the maximum acceleration a max are listed in table 3 some of the findings can be summarized as follows 1 frequency differences between the experimental and numerical results were evident this may have been caused by the different spring stiffnesses adopted in the experiment and numerical simulations it is normal to generate a larger initial displacement e g 3 in the experiment which is larger than the maximum displacement 1 5 of the ringing response in the numerical simulation the initial displacement was set as approximately 0 005 which was much lower than those of the ringing response and initial displacement in the experiment therefore the k s applied in the experiment was larger than that of the numerical simulation consequently the experimental and numerical ringing vibration frequencies were respectively higher and lower than the frequencies in still water 2 the frequency difference between the numerical and experimental ringing vibrations increased with the initial frequency the frequency deviation can be approximately expressed as follows 11 δ f k s 2 π 2 l c 2 i i a n u m 2 l c 2 i i a e x p where f is determined by k s and the deviation between i a n u m and i a e x p compared with the values of k s the term in parentheses was basically a constant in the three wave cases so f increased as k s increased bruinsma et al 2018 vibration amplitude differences between the experimental and numerical results were evident the numerically simulated amplitude in the 3 82 hz case was closer to the experimental results than the amplitudes of the 6 82 and 9 15 hz cases which can be ascribed to the different k s values of the two systems the spring stiffness deviations can be approximately expressed as follows 12 δ k s 2 π 2 f 2 l 2 i a e x p i a n u m where k s is determined by the target f and the deviation between and i a n u m and i a e x p and k s increases with increasing the target f therefore the k s for the low frequency numerical case are closer to the experimental data it is clear that the simulation accuracies of lower frequency cases are relatively better in addition l c was approximated from the figure presented by chaplin et al as it was not directly offered in the reference furthermore the spring mass unknown in the experiment was not considered in the numerical simulations therefore the value of i in the numerical simulation may have been lower than that of the experimental system to study the influence of i and the mechanical damping ratio ξ m on the ringing response the numerical model for case775 with a 6 82 hz frequency was taken as the reference case the parameters of the different cases are listed in table 4 h c is the height of the center of cylinder mass h s is the height of the anchorage point of the springs and ξ m represents the mechanical damping ratio the frequencies of all the cases were calibrated to be 6 82 hz by adjusting the spring stiffness k s 561 649 and 763 n m for case 775 1 case 775 2 and case 775 3 respectively for case775 1 case775 2 and case775 3 the simulated horizontal acceleration a values are shown in fig 15 a the cylinder i a had a remarkable influence on the vibration response and the maximum acceleration values of the three cases were 2 19 1 91 and 1 52 ms 2 respectively the ringing vibrations with different mechanical damping ratios sampling time t 0 5 2 5 s are shown in fig 15 b the total damping ratios were 1 60 1 73 and 1 87 respectively when the superposition assumption was adopted the additional damping ratios were 1 25 1 23 and 1 22 respectively this indicates that the additional damping ratio was almost independent of the mechanical damping ratio in the region of interest 4 2 analyses and discussions grue and huseby 2002 demonstrated that if the resonant frequency is approximately four times of the wave frequency slc contributes to the formation of the resonant body response chang et al 2019 stated that the frequency of the slc may be up to 13 times of the wave frequency in this study although the slc was not found in case745 ringing vibrations for the three frequency cases were observed the inline forces acting on the fixed and vibrated cylinder are simultaneously shown in fig 16 the inline forces for the vibrating cylinder showed more fluctuations especially for case765 and case775 the excitation forces acting on the vibrated cylinders contained two dominant frequency components which were approximately equal to wave frequency 0 91 hz and natural frequencies 3 82 6 82 and 9 15 hz respectively moreover the magnitudes of the higher order components were not only related to the wave conditions but they were also influenced by the stiffness of structure therefore it is not inappropriate to use the static force i e the slc to predict the occurrence possibility of ringing to further illustrate the free vibration behaviors of the ringing response the inline force differences f between the fixed and vibrated cylinders of case765 f 3 82 hz as well as the time varying displacements at the still water level are shown in fig 17 the same phase of oscillation with f indicates the free vibrations of the ringing response the initial displacement was first excited by the main peak of the total wave forces and subsequently the roll restoring moment became the main motivation for the ringing vibrations according to hunt et al 1988 the vortex structures in the flow field can be identified by the second invariant q of velocity gradient tensor u 13 q 1 2 ω 2 s 2 where s 1 2 u i x j u i x i and ω 1 2 u i x j u i x i are the symmetric and antisymmetric components of u respectively q represents the local balance between shear strain rate and vorticity magnitude and higher q means a higher vortex intensity this q criterion is known to be more appropriate than the vorticity criterion for extracting the vortex structures especially in the near wall region where the flow shear effect is prominent for case765 f 3 82 hz when the second invariant q 100 four typical instantaneous iso surfaces are shown in fig 18 and the corresponding four typical instants are marked in fig 17 with green points as shown in fig 18 the vortices mainly appeared in front of the structure when the cylinder attained the maximum positive displacement fig 18 b and the vortices mainly appeared behind the structure when the cylinder had maximum negative displacement fig 18 d the vortices were located on the side of the cylinder when the displacement of the structure was close to zero 4 3 the possibility of springing vibration under the action of regular wave in the aforementioned section we demonstrated that the ringing vibration could be observed even without the slc for the corresponding fixed cylinder which contradicts the conventional belief the ringing and springing vibrations usually occur in steep focused waves and mild regular waves states respectively srinivasan et al 2011 and the springing is defined as steady state resonant vibration of the marine structures kim et al 2009 in this section we further studied that for some regular stokes wave cases the springing vibrations do not occur even when the slc is evident the wave steepness ka values of cases745 765 and 775 0 208 0 299 and 0 345 respectively were selected as target parameters to generate 5th order stokes waves and the corresponding wave heights were 0 110 0 158 and 0 197 m respectively fixed and vibrated cases under the regular waves were also built to verify the relationship between the slc and springing vibrations and more details of the numerical cases are shown in table 5 the inline forces acting on the fixed and vibrated cylinder for the two regular wave cases are shown in fig 19 the slc was observed in cases 2 and 3 but not in case1 the inline forces for the vibrating cylinder also showed fluctuations under regular waves this indicated that those excitation forces acting on the vibrated systems also contained two dominant frequency components which were approximately equal to the wave frequency 0 91 hz and natural frequencies 3 82 6 82 and 9 15 hz respectively the flow fields at t iv in case1 case2 and case3 were obtained as shown in fig 20 the velocity streamlines were in a horizontal plane perpendicular to the axis of the cylinder for z 0 425 m similar to the analysis of the focused waves cases the vortices were more evident in steep waves thus regardless of the type of wave the slc was related to wave steepness ka and the downstream vortices were the main cause of the slc in addition compared with the vertical structures in focused waves fig 7 the downstream vortices in case2 and case765 were similar in size and they were much smaller than that in case3 and case775 the f c values in case1 case2 and case3 were 0 0 042 and 0 048 respectively according to the simulation results in fig 7 it found that the f c increased with the increase in the vortex size referring to the method described above the sdof cylinder models with three different spring stiffnesses in cases 1 2 and 3 were simulated under the actions of regular waves case1 case2 and case3 and focused waves case745 case765 and case775 the displacement records at the still water level for the three natural frequency cases are shown in fig 21 the vibrations in regular wave cases are different with the typical ringing vibrations in the focused wave cases based on the simulations the springing vibrations occur for the lower natural frequency cases 3 82 hz while in the higher natural frequencies cases the springing vibrations are not obvious the fft analysis was performed on the displacement histories to calculate the ratio r s n s w where s n represents the amplitude near the natural frequencies of 3 82 6 82 and 9 15 hz and s w is the amplitude at the wave frequency in relation to the trough to trough period of the wave the results are shown in fig 22 for the focused wave cases with ringing vibrations the r values were much larger than those of the regular wave cases without ringing vibrations this indicates that the ringing vibrations were mainly free vibrations and their magnitudes were predominantly affected by the peak of the total wave forces in addition the springing vibrations in the low natural frequency cases under the regular waves were different from the typical ringing vibrations in the focused wave cases and under the actions of regular waves the vibration form in higher natural frequency cases were close to sustained forced harmonic oscillations 5 concluding remarks the waves2foam and wavedymfoam solvers were used to numerically simulate the interactions between the waves focused and or regular and cylinders fixed and or vibrated the simulated wave series and over turning moment acting on the fixed cylinder were in good agreement with those of the experimental data the slc and ringing vibrations were monitored in numerical simulations the ringing vibration differences between the experimental and numerical simulations were analyzed to unveil the possible causes the characteristics of the inline forces were discussed in detail for both focused and regular waves with different wave steepness values and natural frequencies for the specific wave cases in this study the ringing vibrations could be observed even without the slc and springing vibrations did not occur even when the slc was evident therefore it is inappropriate to judge the occurrence of ringing and springing vibrations only by the presence of slc the ringing vibrations in focused wave cases are free vibrations and under regular waves the dominant vibrations in higher natural frequencies cases are close to forced harmonic oscillations the added mass moment of the inertia and added damping ratio increase with the amplitude which should be carefully considered and accurately quantified for the quasi static calculations of large amplitude ringing vibrations if a constant added mass moment of the inertia and added damping ratio that measured or simulated at a small amplitude are used the amplitude would be overestimated credit authorship contribution statement fuyou xu conceptualization supervision resources writing review editing visualization yuqi wang methodology software validation formal analysis data curation writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is supported by the national natural science foundation of china 51978130 
20908,planning and execution of marine operations requires proper estimation of vessel dynamic responses and their corresponding operational limits including considerations of fatigue damage current guidelines for marine operations are based on a design wave height without considering the wave energy distribution in frequency and direction this can be critical for ships operating in open seas where multimodal wave spectra may occur frequently this study provides criteria for heading selection with the aim of reducing fatigue damage of vessels under action of directional 2d bimodal and multimodal wave spectra in addition some consequences of using analytical 2d jonswap spectra are also addressed based on a hydrodynamic model of a vessel stresses at the midships section are computed using a spectral method for bimodal wave spectra and considering that all dynamic responses are acceptable fatigue damage can be reduced in about 50 when the vessel is heading to the least energetic wave component of 2d wave spectra moreover fatigue damage obtained from actual 2d bimodal spectra can be well represented by its corresponding jonswap counterpart computed from the spectral parameters of the largest wave component these findings can be used for vessel heading selection during planning and execution of marine operations keywords fatigue damage actual 2d bimodal wave spectra vessel responses heading selection vertical bending moments operability analysis 1 introduction to guarantee safety during execution of marine operations it is required that dynamic responses of structures remain below their corresponding operational limits with this aim and considering the fact that longer weather windows are normally desired a vessel heading selection is normally based on operability analysis at a specific location international standards such as det norske veritas 2011 international organization for standardization 2015 gl noble denton 2015 recommend selecting operational limits in terms of environmental parameters such as significant wave height hs wind speed and current speed plus some alpha factors to account for uncertainties in weather forecast and leading times this is to use forecasted information together with operational limits for making on board decisions however it is not specified how these limits should be established in the past operational limits for dynamic responses of vessels were set based on results from model tests and practical experience for heavy lift vessels recommendations of 6 deg for double significant roll and 2 deg for double significant pitch were proposed clauss et al 1990 however the origin of these limits is not clear later operational limits for dynamic responses were set based on systematic structural analyses of critical components of structures used in various marine operations clauss et al 1998 smith et al 1996 ringsberg et al 2017 in addition guachamin acero et al 2016 provided a generic methodology for systematic derivation of these limits in terms of hs peak period tp or other vessel dynamic responses and a more specific method based on weather window analysis for assessment of operability of marine operations in these analyses directional 2d wave spectra can be used e g 2d joint north sea wave project jonswap or 2d actual spectra based on this methodology operational limits should be established in a systematic manner based on an actual critical operation and corresponding response parameter for example an actual operational limit of a heavy lift vessel installing a topside module on a jacket foundation critical operation is the impact force between the mating pins and female receptacles actual response parameter however this force cannot be used to set an operational limit because it is not practical to be measured on board the vessel instead the operational limit is set for hs tp or a dynamic response such as roll or heave velocity of the crane tip equivalent response parameters that result in the same allowable impact forces because they can be measured on board and used to make a safe decision thus operational limits for dynamic responses will depend on the type of marine operation and will be different for every vessel for this reason a unique value cannot be established for weather unrestricted marine operations planned duration longer than 72 h such as those of floating production storage and offloading units fpsos drilling ships pipelaying vessels and maritime transportation vessels not only vessel dynamic responses should be considered as criteria for heading selection but also ultimate limit state stresses and fatigue damage this can be difficult especially when bimodal and multimodal wave spectra characterize an offshore site lately balli and ward 2020 have proposed an algorithm which uses wind sea and swell information for on board computation of fatigue damage and is used as a criterion for heading selection of fpsos waves are modeled using analytical spectra but other limiting criteria such as rigid body dynamic responses are not included a vast number of rules standards and recommended practices for structural design of offshore structures have been developed by international societies for fatigue assessment on ships and other offshore structures as an example classification notes no 30 7 dnv 2014 provides recommendations for fatigue design of ships for short term fatigue assessment considering a hydrodynamic model of a ship this guide recommends linear frequency domain calculations followed by spectral analyses waves can be represented by the analytical pierson moscowitz pm spectrum with spreading function coefficient n 2 based on north atlantic climatic conditions for long term analysis for computation of vertical bending moments vbms response amplitude operators rao s are normally used there is also a simplified calculation approach in which the basis of the recommended formulas is not completely clear kendrick and daley 2007 investigated the equation for design bending moments observing that it corresponds to a static equilibrium analysis of a ship placed on the crest of a wave plus some factors on the other hand it is noted that routing strategies or heading considerations are not addressed in these standards most of scientific literature provide methods for assessment of stresses and fatigue damage under action of unidirectional 1d and 2d unimodal wave spectra these can be based on measurements numerical results or a combination of both several frequency domain spectral methods have been proposed for assessment of fatigue damage to name a few larsen and lutes 1991 proposed spectral methods for fatigue assessment resulted from a gaussian process with narrow and wide banded stress spectra jiao and moan 1990 developed a method for assessment of fatigue damage which can be estimated for low and high frequency spectral components of stresses obtained from narrow banded gaussian processes other methods consider wide banded gaussian processes as stress spectra can be bimodal or trimodal benasciutti and tovo 2007 gao and moan 2008 for analysis of fatigue damage using time domain simulations the rainflow counting rfc method matsuishi and endo 1968 together with the miner s rule are normally used for instance using this method and full scale measurement of stresses taken in the hull girder of a container ship in various sailing routes nielsen et al 2011 computed fatigue damage unidirectional wave spectra were obtained from buoys and from an on board measurement system these results were compared to those obtained from computations using spectral methods finding good agreement moreover nielsen 2017 developed tools for on board wave estimation based on vessel dynamic responses the combination of simulations and measurements are the basis for the development of on board decision support systems regarding heading configurations and navigation speeds the results from li and ringsberg 2012 for a container vessel show significant differences for different configurations in their study they applied frequency domain and spectral methods to compute fatigue damage modeling waves as unimodal short crested using the pm spectrum they accounted for contributions from normal stresses due to horizontal bending moments and from warping effects however warping contribution to fatigue damage was found to be significant only for the bilge area but not for the deck thompson 2016 found a good correlation between measurements of stresses from various locations of the hull of a naval ship and those derived from unidirectional pm models nevertheless their results significantly improved by adding directional spreading further on thompson and ellis 2019 concluded that ignoring headings in navigation routes can lead to nonconservative results similar effects are also discussed by de gracia et al 2019 only a limited number of studies has been carried out considering more realistic ocean conditions accounting for 2d bimodal spectra for instance teixeira and soares 2009 performed computations of vertical bending moments using both unimodal and bimodal spectra based on 2d jonswap models obtaining larger values for the former their findings can be useful for ultimate limit state design of ships lately thompson 2020 found that 2d hindcast and reconstructed 2d analytical spectra can provide an accurate representation of stresses when compared with measurements nowadays wave model spectra can provide an accurate representation of an actual sea state in most of ocean locations cavaleri et al 2018 considering that the north atlantic ocean is generally characterized by multimodal wave conditions portilla yandún 2018 it is clear that further research is needed to better assess fatigue damage under more realistic navigation scenarios this papers aims at providing a better understanding of fatigue damage of a vessel exposed to realistic 2d bimodal wave conditions from the north atlantic ocean and considering different heading configurations this is necessary for including fatigue damage as a limiting criterion in analysis of marine operations for that we compute the vbms at midships of a vessel using a dynamic panel model for comparison corresponding 2d unimodal jonswap spectra are also used for the wave input this is because sometimes only wave spectral parameters or combined wave information are available bending moments are used to compute nominal normal stresses and thus fatigue damage using a spectral method this information combined with that of an operability analysis can be used to provide a vessel heading strategy for weather unrestricted and restricted marine operations aiming at reducing fatigue damage on floating vessels only nominal stresses are used and no forward speed of the vessel is included in the analyses 2 weather window analysis and heading selection marine operations are executed when there exist workable weather windows wowws fig 1 shows that for a specific heading 1 these windows can be identified after comparing dynamic responses of structures and their corresponding operational limits using wave hindcast for operability analyses or forecasts for execution of operations these limits must be higher than the dynamic responses dynamic responses for heading 1 and the duration of the woww must be larger than that of the planned operation dynamic responses can be any response parameter such as roll pitch crane tip heave wire tension etc including wave parameters such as hs and tp or any combination of them guachamin acero et al 2016 for the specific heading 1 fatigue damage can be estimated see lower panel in the figure for multimodal wave spectra and considering one or various response parameters heading 1 can provide the best operability based on a weather window analysis in turn fig 1 lower panel shows that an optimum heading can be selected in view of reducing fatigue damage for an optimized heading based on fatigue damage dynamic responses increase but remain below the corresponding operational limits see upper panel in the figure thus weather restricted and unrestricted marine operations can be optimized in terms of reducing fatigue damage through heading update during execution of operations this change of heading will provide the same wowws and thus operability while increasing the fatigue life of a floating marine structure or its structural components to do this it is necessary to know how much benefit a change in heading can provide while still keeping acceptable dynamic responses since there is a vast number of offshore locations where bimodal and multimodal wave spectra dominate it is necessary to know if a change in heading of the vessel e g heading into the largest smallest or an intermediate incoming wave can provide a significant reduction of fatigue damage if this is possible vessels such as fpsos can increase their fatigue lives without reducing the number of wowws especially during the summer season where dynamic responses for the best heading in view of responses can be much lower than their operational limits thus dynamic responses together with fatigue damage can be used as criteria to optimize or select the heading of a vessel 3 methodology this section provides a methodology to assess a heading selection strategy when including fatigue damage as a limiting criterion for that both 2d hindcast and parametric jonswap wave spectra are applied on a vessel section 3 1 provides details for wave modeling these wave actions are fed into a dynamic panel model of a vessel see sec 3 4 the equations of motion of the dynamic model are solved in the frequency domain for assessment of dynamic responses including bending moments at midships of the vessel resulting bending moments are converted into normal stresses and the fatigue damage is assessed for each analysis case considered in this study see sec 3 7 finally fatigue damage results are used to assess vessel heading strategies in bimodal and multimodal sea states see sec 4 2 3 3 1 representation of the sea environment an accurate knowledge of the actual environmental conditions is important for designing offshore structures and for operation s planning standards such as dnvgl 2017 provide general recommendations for numerical modeling of unimodal or bimodal wave conditions the north atlantic ocean is characterized by complex spectral conditions often involving bimodal or multimodal sea states portilla yandún 2018 therefore a more accurate description of the sea may be necessary since in general waves are not properly described by unimodal parametric spectra e g jonswap pm this is particularly important because offshore vessels are sensitive to wave heading and thus to the energy distribution within the spectrum guachamin acero and li 2018 as an example fig 2 shows that the wave energy distribution of an actual 2d spectrum is significantly different from its corresponding analytical jonswap spectrum 3 2 actual 2d wave spectra the wave spectrum contains complete information of the wave energy distribution in frequency and direction 2d therefore it is the basic variable for wave description being currently at the core of both state of the art numerical wave models and observations holthuijsen 2007 integral parameters such as significant wave height or mean wave period are derived from integration of the spectrum and therefore involve certain loss of the available information in the past due to the lack of spectral information the use of integral wave parameters was commonplace in engineering applications however this situation is starting to change as spectral data is becoming progressively more available particularly in the last two decades a large number of 2d spectral observations have become available from in situ and remote sensing devices noaa 2020 hasselmann et al 2012 in addition weather prediction centers have started to archive and release massive amounts of 2d spectral data with global coverage dee et al 2011 tolman et al 2013 these data sets open the possibility to carry out more detailed engineering analysis and particularly of offshore vessel responses that were previously possible only at limited extent in the present study we make use of wave model spectra from the european center from middle range weather forecasts ecmwf corresponding to the era interim archive see dee et al 2011 for details this archive contains 2d wave spectra with global coverage at 110 km resolution spanning the period from 1979 to 2015 37 years currently the performance of wave prediction models is very good cavaleri et al 2007 being the most challenging conditions those of the coastal zones and influenced by the orography cavaleri et al 2018 3 2 1 north atlantic 2d wave spectral conditions north atlantic wave conditions are generally the reference for establishing marine design standards indeed some of the largest waves on earth are to be found in this region however not only the magnitude of waves is relevant in design but also the spectral energy distribution presenting often bimodal or multimodal conditions which represent waves with different fronts that are very challenging for activities such as navigation and offshore operations in such multimodal conditions the typical wave characterization based on scatter diagrams of peak period and wave height results incomplete because the dataset might be composed of several populations each with different inherent characteristics according to their meteorological genesis an alternative approach for 2d spectral characterization is given by portilla yandún 2018 the method is based on spectral partitioning portilla et al 2009 and the further statistical characterization of these partitions for the offshore site selected in the north atlantic ocean coordinates 47 n 336 58 e fig 3 a shows the principal parameter obtained from this method which is the long term 37 years occurrence distribution of spectral partitions in frequency in hertz and direction the figure shows which wave systems occur at the site their recurrence and intensity the colorbar displays the number of partitions found in each spectral f theta bin this spectral parameter shows the spectral complexity of waves containing in this case 6 long term wave systems each with specific characteristics in terms of magnitude period direction seasonality among others see portilla et al 2009 for further details from the monthly hs mean see fig 3 b the seasonality of these wave systems can be appreciated particularly we observe that wave systems 1 and 2 govern the local wave climate through the year with larger magnitudes during the boreal winter january and february based on this information analysis such as vessel s fatigue damage see sec 3 5 and vessel s operability see sec 3 6 can be assessed under more realistic environmental wave scenarios for the vessel s response simulations once the relevant wave systems have been identified their individual integral parameters i e hs tp and wave component direction θ p are used to re construct an equivalent 2d jonswap unimodal spectrum by applying the partitioning method described by portilla et al 2009 see e g fig 2 3 3 the 2d jonswap spectrum following the recommendations from dnvgl 2017 the 2d jonswap spectrum is derived according to eq 1 where s j is the energy in the jonswap spectrum d θ is the directional spreading function hs is the significant wave height γ is the non dimensional shape parameter ω and ω p are the angular frequency of the waves and the spectral peak respectively and σ is the spectral width parameter 1 s j ω θ d θ 1 0 287 l n γ 5 16 h s 2 ω p 4 ω 5 e x p 5 4 ω ω p 4 γ e x p 0 5 ω ω p σ ω p 2 the directional spreading function can be expressed by equation 2 where γ is the gamma function θ can take values from 90 deg to 90 deg and n 3 for wind seas in this study θ p corresponds to both peak directions of the actual 2d spectra 2 d θ γ 1 n 2 π γ 1 2 n 2 c o s n θ θ p 3 4 numerical modeling of the vessel dynamic responses and bending stresses are computed by modeling the hydrodynamic behavior of a floating vessel exposed to the wave conditions previously described the main characteristics of the vessel are given in table 1 the modeling framework is developed in the state of the art code ansys aqwa century dynamics ansys inc 2009 the hydrodynamic model of the vessel is made of diffracting and non diffracting panels in the dynamic model the vessel is kept in position by means of 8 mooring lines connected to the seabed this is a necessary modeling artifice to avoid the ship changing its heading during a simulation and to allow an accurate computation of dynamic responses the maximum size of a diffracting panel is 2 m which is enough to achieve reliable results a schematic view of the vessel dynamic coupled model is shown in fig 4 3 4 1 the frequency domain method the dynamic responses of the model of the vessel fig 4 can be solved in the frequency domain with the weakly non linear equations of motion written in matrix form as follows 3 ω 2 m a ω i ω b ω x ω kx ω f e x t ω where m and a are the structural and the frequency dependent added mass matrices respectively b is the damping matrix x is the position vector k is the stiffness matrix and f e x t is the total external force vector including first and second order wave forces and mooring line forces normal stresses see sec 3 5 are computed based solely on vbm raos while second order effects are not included the solution of equation 3 allows to find response amplitude operators raos for different vessel responses fig 5 a shows examples of pitch raos where the natural period for head and quartering seas is 0 56 rad s in addition by defining a mass and inertia properties for the hull sections vbm raos and phase angles can be computed fig 5 b shows that vbms greatly depend on pitch contributions these vbm raos are used to compute normal stresses and thus fatigue damage at deck level at the midships section of the vessel see sec 3 5 3 5 assessment of fatigue damage vertical bending moments rao s and 2d wave spectra are used to compute response spectra and thus normal stresses complying with recommendations from iacs ur 1993 the midship section shown in fig 6 is used nominal normal stresses σ x at point a follow standard calculations σ x m y y c z z i y y where m y y is the vertical bending moment i y y is the second moment of the area about the y axis and c z z is the vertical distance from the centroid or neutral axis to point a see fig 6 the physical properties of the midship section shown in fig 6 are listed in table 2 for every sea state and considering a narrow banded process fatigue damage can be estimated from equation 4 larsen and lutes 1991 where d is the fatigue damage t is the duration of the sea state ω is the zero upcrossing frequency m 0 is the zeroth moment of the stress response spectrum k and m are material factors of a linear s n curve and γ is the gamma function the fatigue s n stress number of cycles curve no 3 for the base material and n 10 7 given in tables 2 1 from dnv 2014 is applied 4 d t ω k 2 2 m 0 m γ 1 m 2 3 6 operability analysis for the 2d wave spectra data set dynamic responses are computed and thus operability analyses are conducted operational limits for roll pitch heave and a heave displacement of the bow are considered this allows for a realistic and practical heading selection without considering fatigue damage for operability analysis the weather window analysis methodology proposed by guachamin acero et al 2016 is applied for every heading of the vessel covering the full circle cumulative fatigue damage over all 37 years of wave data is computed this allows for selecting the best heading based on fatigue damage criterion however it is necessary to optimize this heading in view of reducing vessel dynamic responses and fatigue damage since we would like to know if the vessel should head into the largest the smallest or between both wave components of a 2d bimodal spectrum this problem is addressed in sec 3 7 3 7 analysis cases for vessel heading strategy bimodal wave spectra are selected from the full wave data set see sec 3 2 1 simulations are carried out for several cases which combine wave conditions from both actual 2d bimodal and 2d jonswap unimodal spectra and different headings of the vessel as shown in fig 7 five basic heading configurations of the vessel are considered heading configurations hind head 1 and hind head 2 correspond to the vessel heading into the largest and smallest wave components of the actual 2d spectrum respectively heading condition hind head 3 considers the vessel heading between the two wave components configurations for jon head 1 and jon head 2 correspond to the vessel heading into the mean direction of the jonswap spectrum with the largest and smallest spectral peaks of the actual 2d spectra respectively table 3 summarizes various analysis cases c 1 c 7 based on wave spectra data set defined in sec 3 2 1 and heading configurations shown in fig 7 it is noted that in the jonswap cases a wave spreading angle of 180 deg is used to model short crested seas while a wave spreading angle of 30 deg is used to model long crested seas 4 results 4 1 heading selection based on operability analysis and fatigue damage based on the numerical model described in sec 3 4 and 2d hindcast spectra from the wave data set see sec 3 2 1 operability of the vessel is computed using various limiting criteria such as roll pitch heave and heave motion of the bow for all possible headings of the vessel see fig 8 it is shown that the roll limit suggest 300 and 120 deg as the best heading see fig 8 a heave motion of the center of gravity and the bow suggest that 330 and 150 deg are the best headings see fig 8 c d moreover when considering pitch as a limiting criterion 0 and 180 deg are the best headings see fig 8 b based on this information a heading of 330 or 150 deg is the best choice for manoeuvring note that 0 deg means the vessel heading to the true north consideration of fatigue damage as a limiting criterion can help selecting a heading on board a vessel based on equation 4 fig 9 a shows the cumulated fatigue damage for all 2d multimodal spectra which has also been split for winter and summer seasons a total number of 11518 records of 2d bimodal wave spectra have been used whose corresponding fatigue damage are displayed for all headings of the vessel it is clearly observed that 2d bimodal wave spectra can provide quite a good representation of fatigue damage for 2d multimodal wave spectra moreover fig 9 b shows that 2d jonswap spectra modeled with wave parameters of the largest wave component of the corresponding 2d bimodal spectra can still provide a reasonable good representation of fatigue damage based on this information it is evident that the best strategy is to head the vessel to approximately 330 deg however once the vessel is at the offshore site it must be possible to optimize the heading of the vessel in view of reducing fatigue damage based on information regarding 2d wave spectral parameters which are generally available 4 2 assessment of responses for the wave spectra data set for the analyses conducted in this section all 2d bimodal spectra are arranged such that they will always come from the true north this means that spectral peaks will be aligned with the north according to table 3 likewise waves corresponding to 2d jonswap spectra will always arrive from the north it is then possible to analyze differences in fatigue damage obtained from 2d actual and jonswap spectra this section provides details of these comparisons and other associated parameters 4 2 1 bending moments and normal stresses fig 10 a shows an example of a 2d hindcast bimodal wave spectrum and fig 10 b shows response spectra of normal stresses at point a from fig 6 for various analysis cases of table 3 it is observed that when the vessel heads into the least energetic wave component case c 2 the vbms are larger than for the case with the vessel heading into the largest wave component case c 1 this is because vbms do not only depend on the amount of energy of every wave component but also the peak period of the spectrum peak in this example the peak frequency of the least energetic peak is 0 56 rad s which is the same as the pitch natural period see fig 5 a for an intermediate heading case c 3 the stresses are much lower this intermediate heading could be selected in view of reducing fatigue damage provided that other dynamic responses remain below allowable or operational limits vertical bending moments are computed for each analysis case these are used to calculate normal stresses in the longitudinal direction of the vessel root mean squared rms values of stresses between different pairs of analysis cases are computed fig 11 a shows a comparison between cases c 1 and c 4 see case notations and descriptions in table 3 the coefficient of determination is r 2 0 97 and the linear trend shows the ability of the jonswap based model to represent results from the actual spectra in fig 11 b the same rms stresses are compared for corresponding cases c 2 and c 4 it is shown that the correlation is much lower r 2 0 64 the comparison for other cases is summarized in table 4 stresses for the case of the vessel heading through both wave components of the actual spectrum cannot be well represented with the jonswap model see comparison pairs see e g p 3 and p 6 it is observed that only stresses obtained from an actual spectrum with a vessel heading into the largest wave component can be represented by stresses obtained from a jonswap spectrum modeled with spectral parameters of that specific wave component see comparison pairs p 1 and p 7 4 2 2 zero crossing periods tz similarly we provide comparisons for zero crossing periods as this variable is related to the number of cycles experienced by the vessel tz is estimated from spectral analyses of stresses and is defined as 5 t z 2 π m 0 m 2 where m 0 and m 2 are the zeroth and second spectral moments of the normal stress spectra fig 12 shows the tz intercomparisson for cases c 1 vs c 4 and c 2 vs c 4 similarly as in the case of stresses see fig 11 a we observe here that tz values for the actual spectra correspond well with those derived from the jonswap model with θ p and tp corresponding to the largest wave component in contrast the former poorly correlates with the jonswap model using the θ p and tp parameters of the smallest component see fig 12 b comparisons among other pairs of cases are summarized in table 5 where similar results as those obtained for stresses table 4 can be observed with particularly good correspondence for pairs p 1 and p 7 it is noted that the r 2 coefficients are lower for cases where 2d jonswap spectra are modeled with spectral parameters of the least energetic peak of the corresponding 2d bimodal spectra in these conditions the jonswap model do not provide the same tz as the ones obtained from actual wave spectra 4 2 3 fatigue damage d similarly as in the previous sections fig 13 shows comparisons for cases c 1 vs c 4 and c 2 vs c 4 and table 6 includes the comparison for other pairs consistently here too pairs p 1 and p 7 show better correspondences for all analysis cases the normalized cumulative fatigue damage is shown in fig 14 for 0 deg heading it can be observed that the jonswap model with 180 deg spreading angle cases c 4 and c 5 provide the largest fatigue damage with slightly larger values than those for 2d bimodal spectra with the vessel heading to the largest peak component case c 1 moreover the shapes of these three fatigue damage curves are quite similar finally it is clear to see that fatigue damage for cases c 2 and c 3 are different from those obtained for the jonswap models curves for cases c 6 and c 7 are not shown for sake of clarity a summary of these results for 0 deg heading is shown in fig 15 the following observations can be made case c 7 results in the largest fatigue damage fatigue damage for cases c 4 and c 6 are lower 3 and 5 respectively than those for the corresponding cases c 5 and c 7 fatigue damage for cases c 2 and c 3 using the actual spectra are significantly lower about 40 of case c 4 fatigue damage for case c 1 is about 90 of its corresponding case c 4 fatigue damage for case c 2 is about 50 of its corresponding value for case c 1 4 3 assessment of roll responses using 2d bimodal spectra and heading selection for sake of completeness analysis cases c 1 to c 3 are used to compare roll responses of the vessel this is because roll or its associated responses can vary significantly when choosing a heading of the vessel based solely on fatigue damage as an example fig 16 shows that for case c 1 roll responses are the lowest this is opposite to fatigue damage see fig 15 from these figures it is noticed that for 330 deg heading or vessel heading 30 deg off from any heading for cases c 1 to c 3 almost all cases produce the same roll responses and fatigue damage this means that if the heading of the vessel is not carefully controlled a small deviation from the best heading will not benefit for obtaining the best responses and lowest fatigue damage for example consider the vessel heading to the smallest wave component of the 2d bimodal wave spectra case c 2 figs 14 and 15 show that fatigue damage is approximately 50 that of case c 1 additionally fig 16 shows that roll responses for case c 2 are approximately 33 larger than that of case c 1 thus in benign seas if roll responses remain below corresponding operational limits heading the vessel into the smallest wave component of a 2d bimodal spectra can reduce fatigue damage in about 50 to exemplify the results given above and their use in weather window analysis fig 17 a shows some time histories of roll double amplitude significant response the operational limit is assumed 8 deg as defined above note that the roll responses for the best heading 330 deg are similar but generally lower than the other cases all responses above 8 deg are not workable fig 17 b shows that fatigue damage for case analyses c 1 c 3 can be significantly lower than for the best heading thus provided that roll dynamic responses remain below the operational limit the heading of the vessel can be optimized to reduce fatigue damage this information can be very useful when executing marine operations using forecast 2d wave spectra time series especially during the summer season when seas and vessel dynamic responses are relatively low note that apart from roll any other vessel response can be considered 5 discussion when only combined spectral parameters i e hs tp θ are available 2d jonswap spectra have to be constructed results from tables 4 6 show that there is a good degree of correlation between estimates from actual 2d spectra with the vessel heading into the largest wave component and those from jonswap spectra modeled with corresponding spectral parameters this is because there is a good correlation between these parameters for cases c 1 and c 4 or c 1 and c 6 as most of wave energy is concentrated at the same peak frequency for each comparison pair according to fig 15 the fatigue damage for case c 1 is 10 lower than the corresponding value for case c 4 this difference is not considerable when 2d jonswap spectra are modeled using a 180 deg spreading angle thus jonswap spectra can provide a good representation of fatigue damage during the planning phase when full information of 2d bimodal spectra is not available operability analysis based on vessel dynamic responses within the corresponding operational limits can be used as criteria for selecting the best heading of a vessel e g 330 deg which can be obtained from figures such as fig 8 by applying spectral analysis using historical 2d multimodal hindcast spectra similar results for the fatigue criterion can also be obtained using only 2d bimodal spectra or 2d jonswap spectra modeled with spectral parameters of the most energetic wave component see fig 9 for operability analysis using dynamic responses fig 16 provides an example of roll responses calculated for all 37 years of 2d actual wave spectra from sec 3 2 1 similar plots can be evaluated on a monthly basis which can be used to select a preferred heading e g towards the largest wave component because it gives the best roll responses however other dynamic responses such as heave crane tip motion and pitch can be used for weather restricted and unrestricted marine operations once the heading of the vessel and the season or month for the marine operation are selected it is necessary to identify a suitable woww for which a weather forecast is needed the forecast can be available hours or days prior to execution of the marine operation the weather forecasts can be used to compute time series of dynamic responses such as the one shown in fig 17 a by comparing these dynamic responses with their corresponding systematically derived operational limits and by considering the duration of the operations suitable workable weather windows can be identified guachamin acero et al 2016 as an example fig 17 a shows a workable weather window between 4th and 16th of july where dynamic responses for the 330 deg heading that can be selected during the planning phase of the marine operation remain below the assumed operational limit however it should be possible to optimize this heading in view of reducing fatigue damage and keeping the same woww using hindcast wave records results for cases c 2 c 3 from fig 14 showed that fatigue damage can be reduced by directing the vessel towards the least energetic wave component or an intermediate heading between both wave directions in fact fatigue damage can be up to 50 lower than that obtained for the vessel heading to the most energetic wave component case c 1 see fig 15 thus a change of heading that produces the same woww and reduce fatigue damage can be considered based on fig 17 a one may choose a change of heading that produces the same woww and reduce fatigue damage e g to head the vessel into the most or the least energetic wave components cases c 1 and c 2 because fatigue damage is less than for the best heading 330 deg see fig 17 b and roll significant responses remain acceptable likewise similar plots can be used on board vessels for execution of any marine operation summarizing in practice weather restricted such as offshore heavy lifting and weather unrestricted marine operations such as maritime transportation sea keeping of offshore drilling ships and heading control of fpsos can be planned based on information such as that presented in figs 14 and 16 once at the offshore site the heading of the vessel can be optimized in view of reducing fatigue damage based on forecast wave data and information as that given in fig 17 although actual fatigue damage depends on many other factors than those considered in the method proposed our results provide valuable information of a percentage of reduction of the order of magnitude in the reduction of fatigue damage this magnitude can be significant for some headings and will be similar if corrected stresses are used instead in fact corrected stresses will provide actual fatigue damage of the structure during the marine operation moreover optimized headings can be selected only when dynamic responses remain below their operational limits so the fatigue damage criterion is complementary to other operational limiting criteria and should not aim to replace them this paper considers a case study of a section of a vessel where fatigue damage is dominated by vbms in fact other locations of a vessel may be selected for instance stresses in the connections of a topside module may not only require contributions from vertical and horizontal bending moments but also torsional moments and accelerations of the module due to rigid body motions of structures nevertheless the methodology proposed here provides the basis for analyzing other marine operations from a practical point of view fatigue damage on the hull girder of vessels for weather restricted and unrestricted marine operations can be well represented by the 2d jonswap model provided that once at site the vessel will head into the largest wave component unfortunately this is not always the case because one structure can interfere with another or due to another specific operational requirement of the operation moreover heading into the largest wave component will not necessarily result in lower dynamic responses or lower fatigue damage as it was shown in fig 10 b fatigue damage depends on the natural period of pitch and the peak period of the 2d wave spectral components heading strategies are different during normal operations and during extreme conditions a deeper assessment of fatigue damage should include these facts as well especially when structures are approaching the end of their service lives or when a life extension assessment is required nowadays monitoring and recording of ship s responses plus the availability of detailed records of environmental variables is becoming routine therefore such information together with numerical simulations can be used for assessing heading strategies providing insights on fatigue damage during planning and execution of operations structural integrity and vessel stability are aspects of utmost importance when executing offshore activities considering besides that wave spectra at sea can be in general multimodal better tools for safety assessment ought to be developed incorporating criteria for stability ultimate limit state design comfort fatigue among other considerations in order to help operators make quick and safe decisions despite the differences in fatigue damage for actual spectra and their corresponding jonswap models it is observed that recommendations given by standards lead in general to conservative results therefore they should be used in absence of more accurate or better assessment tools 6 summary conclusions and recommendations 6 1 summary and conclusions this paper introduces fatigue damage as a criterion for heading selection for vessels exposed to 2d bimodal and multimodal seas this criterion together with operability analyses can be used for selecting a heading of the vessel based on these limits the vessel can head to a specific peak or intermediate directions in order to reduce fatigue damage thus the heading of the vessel can be optimized for assessment of fatigue damage of a vessel under action of actual 2d bimodal and 2d jonswap unimodal spectra a set of wave spectra from the north atlantic ocean data was used these spectra are applied to a vessel which is modeled using a dynamic panel model bending moments are calculated at midships and used to compute fatigue damage this is done for several cases that involve different input spectra and headings configurations a comparison of normal stresses zero crossing periods and fatigue damage between various cases was conducted it was found that there is good correlation between the following cases responses computed by applying actual 2d spectra with the vessel heading into the largest wave component or peak direction and responses computed from 2d jonswap spectra modeled with spectral parameters using the same periods and directions of the corresponding component apart from these cases jonswap spectra does not properly represent cases with actual 2d spectra fatigue damage estimated from actual 2d spectra with the vessel heading into the largest wave component is approximately 90 of that obtained from its corresponding jonswap counterpart these differences can vary and will depend on spectral parameters of the wave spectra at the offshore site from records of actual 2d bimodal wave spectra in general it was found that the fatigue damage for the case of the vessel heading to the smallest wave component fatigue damage is about 50 of the corresponding one of the vessel heading to the largest component this may not be the case for every wave spectrum because dynamic responses depend on the peak period of the wave spectral components nowadays there is a large amount of data sets containing actual 2d wave spectra e g modeled or measured and considering the available computational capacity and efficiency of state of the art codes it is possible to conduct real time and on board simulations of operations without any need of simplifying actual 2d spectra the outcome of this research can be valuable for developing on board systems to help operators on making informed decisions especially for execution of marine operations with the aim of reducing fatigue damage this can also be important for ships reaching the end of their design service life or when the life extension of a vessel is required 6 2 recommendations and further work fatigue damage was assessed for specific heading configurations of a vessel and by applying 2d bimodal wave spectra from a specific offshore site to contrast results from this paper it is necessary to conduct analyses for other offshore locations that include other wave components which can arrive from different directions it is noted that wave spectra in the north atlantic ocean can be multimodal thus it is necessary to identify wave system components for predefined navigation routes these can be valuable for safety assessment including criteria such as ultimate limit state design fatigue and stability continuous development of decision making tools is necessary especially for ships operating in offshore sites with multimodal wave conditions this can help operators make more informed decisions and reduce associated risks numerical simulations including vessel forward speed and real time heading control should be performed these are other parameters essential in maritime transportation credit authorship contribution statement wilson guachamin acero writing original draft methodology writing paper structure methodology numerical models conducting numerical simulations jesús portilla yandún data curation writing review editing generating input wave data reviewing proof reading declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors thank support from project pigr 19 08 evaluación de parámetros oceánicos para la planificación de operaciones marinas en las costas del ecuador granted through the faculty of mechanical engineering of escuela politécnica nacional 
20908,planning and execution of marine operations requires proper estimation of vessel dynamic responses and their corresponding operational limits including considerations of fatigue damage current guidelines for marine operations are based on a design wave height without considering the wave energy distribution in frequency and direction this can be critical for ships operating in open seas where multimodal wave spectra may occur frequently this study provides criteria for heading selection with the aim of reducing fatigue damage of vessels under action of directional 2d bimodal and multimodal wave spectra in addition some consequences of using analytical 2d jonswap spectra are also addressed based on a hydrodynamic model of a vessel stresses at the midships section are computed using a spectral method for bimodal wave spectra and considering that all dynamic responses are acceptable fatigue damage can be reduced in about 50 when the vessel is heading to the least energetic wave component of 2d wave spectra moreover fatigue damage obtained from actual 2d bimodal spectra can be well represented by its corresponding jonswap counterpart computed from the spectral parameters of the largest wave component these findings can be used for vessel heading selection during planning and execution of marine operations keywords fatigue damage actual 2d bimodal wave spectra vessel responses heading selection vertical bending moments operability analysis 1 introduction to guarantee safety during execution of marine operations it is required that dynamic responses of structures remain below their corresponding operational limits with this aim and considering the fact that longer weather windows are normally desired a vessel heading selection is normally based on operability analysis at a specific location international standards such as det norske veritas 2011 international organization for standardization 2015 gl noble denton 2015 recommend selecting operational limits in terms of environmental parameters such as significant wave height hs wind speed and current speed plus some alpha factors to account for uncertainties in weather forecast and leading times this is to use forecasted information together with operational limits for making on board decisions however it is not specified how these limits should be established in the past operational limits for dynamic responses of vessels were set based on results from model tests and practical experience for heavy lift vessels recommendations of 6 deg for double significant roll and 2 deg for double significant pitch were proposed clauss et al 1990 however the origin of these limits is not clear later operational limits for dynamic responses were set based on systematic structural analyses of critical components of structures used in various marine operations clauss et al 1998 smith et al 1996 ringsberg et al 2017 in addition guachamin acero et al 2016 provided a generic methodology for systematic derivation of these limits in terms of hs peak period tp or other vessel dynamic responses and a more specific method based on weather window analysis for assessment of operability of marine operations in these analyses directional 2d wave spectra can be used e g 2d joint north sea wave project jonswap or 2d actual spectra based on this methodology operational limits should be established in a systematic manner based on an actual critical operation and corresponding response parameter for example an actual operational limit of a heavy lift vessel installing a topside module on a jacket foundation critical operation is the impact force between the mating pins and female receptacles actual response parameter however this force cannot be used to set an operational limit because it is not practical to be measured on board the vessel instead the operational limit is set for hs tp or a dynamic response such as roll or heave velocity of the crane tip equivalent response parameters that result in the same allowable impact forces because they can be measured on board and used to make a safe decision thus operational limits for dynamic responses will depend on the type of marine operation and will be different for every vessel for this reason a unique value cannot be established for weather unrestricted marine operations planned duration longer than 72 h such as those of floating production storage and offloading units fpsos drilling ships pipelaying vessels and maritime transportation vessels not only vessel dynamic responses should be considered as criteria for heading selection but also ultimate limit state stresses and fatigue damage this can be difficult especially when bimodal and multimodal wave spectra characterize an offshore site lately balli and ward 2020 have proposed an algorithm which uses wind sea and swell information for on board computation of fatigue damage and is used as a criterion for heading selection of fpsos waves are modeled using analytical spectra but other limiting criteria such as rigid body dynamic responses are not included a vast number of rules standards and recommended practices for structural design of offshore structures have been developed by international societies for fatigue assessment on ships and other offshore structures as an example classification notes no 30 7 dnv 2014 provides recommendations for fatigue design of ships for short term fatigue assessment considering a hydrodynamic model of a ship this guide recommends linear frequency domain calculations followed by spectral analyses waves can be represented by the analytical pierson moscowitz pm spectrum with spreading function coefficient n 2 based on north atlantic climatic conditions for long term analysis for computation of vertical bending moments vbms response amplitude operators rao s are normally used there is also a simplified calculation approach in which the basis of the recommended formulas is not completely clear kendrick and daley 2007 investigated the equation for design bending moments observing that it corresponds to a static equilibrium analysis of a ship placed on the crest of a wave plus some factors on the other hand it is noted that routing strategies or heading considerations are not addressed in these standards most of scientific literature provide methods for assessment of stresses and fatigue damage under action of unidirectional 1d and 2d unimodal wave spectra these can be based on measurements numerical results or a combination of both several frequency domain spectral methods have been proposed for assessment of fatigue damage to name a few larsen and lutes 1991 proposed spectral methods for fatigue assessment resulted from a gaussian process with narrow and wide banded stress spectra jiao and moan 1990 developed a method for assessment of fatigue damage which can be estimated for low and high frequency spectral components of stresses obtained from narrow banded gaussian processes other methods consider wide banded gaussian processes as stress spectra can be bimodal or trimodal benasciutti and tovo 2007 gao and moan 2008 for analysis of fatigue damage using time domain simulations the rainflow counting rfc method matsuishi and endo 1968 together with the miner s rule are normally used for instance using this method and full scale measurement of stresses taken in the hull girder of a container ship in various sailing routes nielsen et al 2011 computed fatigue damage unidirectional wave spectra were obtained from buoys and from an on board measurement system these results were compared to those obtained from computations using spectral methods finding good agreement moreover nielsen 2017 developed tools for on board wave estimation based on vessel dynamic responses the combination of simulations and measurements are the basis for the development of on board decision support systems regarding heading configurations and navigation speeds the results from li and ringsberg 2012 for a container vessel show significant differences for different configurations in their study they applied frequency domain and spectral methods to compute fatigue damage modeling waves as unimodal short crested using the pm spectrum they accounted for contributions from normal stresses due to horizontal bending moments and from warping effects however warping contribution to fatigue damage was found to be significant only for the bilge area but not for the deck thompson 2016 found a good correlation between measurements of stresses from various locations of the hull of a naval ship and those derived from unidirectional pm models nevertheless their results significantly improved by adding directional spreading further on thompson and ellis 2019 concluded that ignoring headings in navigation routes can lead to nonconservative results similar effects are also discussed by de gracia et al 2019 only a limited number of studies has been carried out considering more realistic ocean conditions accounting for 2d bimodal spectra for instance teixeira and soares 2009 performed computations of vertical bending moments using both unimodal and bimodal spectra based on 2d jonswap models obtaining larger values for the former their findings can be useful for ultimate limit state design of ships lately thompson 2020 found that 2d hindcast and reconstructed 2d analytical spectra can provide an accurate representation of stresses when compared with measurements nowadays wave model spectra can provide an accurate representation of an actual sea state in most of ocean locations cavaleri et al 2018 considering that the north atlantic ocean is generally characterized by multimodal wave conditions portilla yandún 2018 it is clear that further research is needed to better assess fatigue damage under more realistic navigation scenarios this papers aims at providing a better understanding of fatigue damage of a vessel exposed to realistic 2d bimodal wave conditions from the north atlantic ocean and considering different heading configurations this is necessary for including fatigue damage as a limiting criterion in analysis of marine operations for that we compute the vbms at midships of a vessel using a dynamic panel model for comparison corresponding 2d unimodal jonswap spectra are also used for the wave input this is because sometimes only wave spectral parameters or combined wave information are available bending moments are used to compute nominal normal stresses and thus fatigue damage using a spectral method this information combined with that of an operability analysis can be used to provide a vessel heading strategy for weather unrestricted and restricted marine operations aiming at reducing fatigue damage on floating vessels only nominal stresses are used and no forward speed of the vessel is included in the analyses 2 weather window analysis and heading selection marine operations are executed when there exist workable weather windows wowws fig 1 shows that for a specific heading 1 these windows can be identified after comparing dynamic responses of structures and their corresponding operational limits using wave hindcast for operability analyses or forecasts for execution of operations these limits must be higher than the dynamic responses dynamic responses for heading 1 and the duration of the woww must be larger than that of the planned operation dynamic responses can be any response parameter such as roll pitch crane tip heave wire tension etc including wave parameters such as hs and tp or any combination of them guachamin acero et al 2016 for the specific heading 1 fatigue damage can be estimated see lower panel in the figure for multimodal wave spectra and considering one or various response parameters heading 1 can provide the best operability based on a weather window analysis in turn fig 1 lower panel shows that an optimum heading can be selected in view of reducing fatigue damage for an optimized heading based on fatigue damage dynamic responses increase but remain below the corresponding operational limits see upper panel in the figure thus weather restricted and unrestricted marine operations can be optimized in terms of reducing fatigue damage through heading update during execution of operations this change of heading will provide the same wowws and thus operability while increasing the fatigue life of a floating marine structure or its structural components to do this it is necessary to know how much benefit a change in heading can provide while still keeping acceptable dynamic responses since there is a vast number of offshore locations where bimodal and multimodal wave spectra dominate it is necessary to know if a change in heading of the vessel e g heading into the largest smallest or an intermediate incoming wave can provide a significant reduction of fatigue damage if this is possible vessels such as fpsos can increase their fatigue lives without reducing the number of wowws especially during the summer season where dynamic responses for the best heading in view of responses can be much lower than their operational limits thus dynamic responses together with fatigue damage can be used as criteria to optimize or select the heading of a vessel 3 methodology this section provides a methodology to assess a heading selection strategy when including fatigue damage as a limiting criterion for that both 2d hindcast and parametric jonswap wave spectra are applied on a vessel section 3 1 provides details for wave modeling these wave actions are fed into a dynamic panel model of a vessel see sec 3 4 the equations of motion of the dynamic model are solved in the frequency domain for assessment of dynamic responses including bending moments at midships of the vessel resulting bending moments are converted into normal stresses and the fatigue damage is assessed for each analysis case considered in this study see sec 3 7 finally fatigue damage results are used to assess vessel heading strategies in bimodal and multimodal sea states see sec 4 2 3 3 1 representation of the sea environment an accurate knowledge of the actual environmental conditions is important for designing offshore structures and for operation s planning standards such as dnvgl 2017 provide general recommendations for numerical modeling of unimodal or bimodal wave conditions the north atlantic ocean is characterized by complex spectral conditions often involving bimodal or multimodal sea states portilla yandún 2018 therefore a more accurate description of the sea may be necessary since in general waves are not properly described by unimodal parametric spectra e g jonswap pm this is particularly important because offshore vessels are sensitive to wave heading and thus to the energy distribution within the spectrum guachamin acero and li 2018 as an example fig 2 shows that the wave energy distribution of an actual 2d spectrum is significantly different from its corresponding analytical jonswap spectrum 3 2 actual 2d wave spectra the wave spectrum contains complete information of the wave energy distribution in frequency and direction 2d therefore it is the basic variable for wave description being currently at the core of both state of the art numerical wave models and observations holthuijsen 2007 integral parameters such as significant wave height or mean wave period are derived from integration of the spectrum and therefore involve certain loss of the available information in the past due to the lack of spectral information the use of integral wave parameters was commonplace in engineering applications however this situation is starting to change as spectral data is becoming progressively more available particularly in the last two decades a large number of 2d spectral observations have become available from in situ and remote sensing devices noaa 2020 hasselmann et al 2012 in addition weather prediction centers have started to archive and release massive amounts of 2d spectral data with global coverage dee et al 2011 tolman et al 2013 these data sets open the possibility to carry out more detailed engineering analysis and particularly of offshore vessel responses that were previously possible only at limited extent in the present study we make use of wave model spectra from the european center from middle range weather forecasts ecmwf corresponding to the era interim archive see dee et al 2011 for details this archive contains 2d wave spectra with global coverage at 110 km resolution spanning the period from 1979 to 2015 37 years currently the performance of wave prediction models is very good cavaleri et al 2007 being the most challenging conditions those of the coastal zones and influenced by the orography cavaleri et al 2018 3 2 1 north atlantic 2d wave spectral conditions north atlantic wave conditions are generally the reference for establishing marine design standards indeed some of the largest waves on earth are to be found in this region however not only the magnitude of waves is relevant in design but also the spectral energy distribution presenting often bimodal or multimodal conditions which represent waves with different fronts that are very challenging for activities such as navigation and offshore operations in such multimodal conditions the typical wave characterization based on scatter diagrams of peak period and wave height results incomplete because the dataset might be composed of several populations each with different inherent characteristics according to their meteorological genesis an alternative approach for 2d spectral characterization is given by portilla yandún 2018 the method is based on spectral partitioning portilla et al 2009 and the further statistical characterization of these partitions for the offshore site selected in the north atlantic ocean coordinates 47 n 336 58 e fig 3 a shows the principal parameter obtained from this method which is the long term 37 years occurrence distribution of spectral partitions in frequency in hertz and direction the figure shows which wave systems occur at the site their recurrence and intensity the colorbar displays the number of partitions found in each spectral f theta bin this spectral parameter shows the spectral complexity of waves containing in this case 6 long term wave systems each with specific characteristics in terms of magnitude period direction seasonality among others see portilla et al 2009 for further details from the monthly hs mean see fig 3 b the seasonality of these wave systems can be appreciated particularly we observe that wave systems 1 and 2 govern the local wave climate through the year with larger magnitudes during the boreal winter january and february based on this information analysis such as vessel s fatigue damage see sec 3 5 and vessel s operability see sec 3 6 can be assessed under more realistic environmental wave scenarios for the vessel s response simulations once the relevant wave systems have been identified their individual integral parameters i e hs tp and wave component direction θ p are used to re construct an equivalent 2d jonswap unimodal spectrum by applying the partitioning method described by portilla et al 2009 see e g fig 2 3 3 the 2d jonswap spectrum following the recommendations from dnvgl 2017 the 2d jonswap spectrum is derived according to eq 1 where s j is the energy in the jonswap spectrum d θ is the directional spreading function hs is the significant wave height γ is the non dimensional shape parameter ω and ω p are the angular frequency of the waves and the spectral peak respectively and σ is the spectral width parameter 1 s j ω θ d θ 1 0 287 l n γ 5 16 h s 2 ω p 4 ω 5 e x p 5 4 ω ω p 4 γ e x p 0 5 ω ω p σ ω p 2 the directional spreading function can be expressed by equation 2 where γ is the gamma function θ can take values from 90 deg to 90 deg and n 3 for wind seas in this study θ p corresponds to both peak directions of the actual 2d spectra 2 d θ γ 1 n 2 π γ 1 2 n 2 c o s n θ θ p 3 4 numerical modeling of the vessel dynamic responses and bending stresses are computed by modeling the hydrodynamic behavior of a floating vessel exposed to the wave conditions previously described the main characteristics of the vessel are given in table 1 the modeling framework is developed in the state of the art code ansys aqwa century dynamics ansys inc 2009 the hydrodynamic model of the vessel is made of diffracting and non diffracting panels in the dynamic model the vessel is kept in position by means of 8 mooring lines connected to the seabed this is a necessary modeling artifice to avoid the ship changing its heading during a simulation and to allow an accurate computation of dynamic responses the maximum size of a diffracting panel is 2 m which is enough to achieve reliable results a schematic view of the vessel dynamic coupled model is shown in fig 4 3 4 1 the frequency domain method the dynamic responses of the model of the vessel fig 4 can be solved in the frequency domain with the weakly non linear equations of motion written in matrix form as follows 3 ω 2 m a ω i ω b ω x ω kx ω f e x t ω where m and a are the structural and the frequency dependent added mass matrices respectively b is the damping matrix x is the position vector k is the stiffness matrix and f e x t is the total external force vector including first and second order wave forces and mooring line forces normal stresses see sec 3 5 are computed based solely on vbm raos while second order effects are not included the solution of equation 3 allows to find response amplitude operators raos for different vessel responses fig 5 a shows examples of pitch raos where the natural period for head and quartering seas is 0 56 rad s in addition by defining a mass and inertia properties for the hull sections vbm raos and phase angles can be computed fig 5 b shows that vbms greatly depend on pitch contributions these vbm raos are used to compute normal stresses and thus fatigue damage at deck level at the midships section of the vessel see sec 3 5 3 5 assessment of fatigue damage vertical bending moments rao s and 2d wave spectra are used to compute response spectra and thus normal stresses complying with recommendations from iacs ur 1993 the midship section shown in fig 6 is used nominal normal stresses σ x at point a follow standard calculations σ x m y y c z z i y y where m y y is the vertical bending moment i y y is the second moment of the area about the y axis and c z z is the vertical distance from the centroid or neutral axis to point a see fig 6 the physical properties of the midship section shown in fig 6 are listed in table 2 for every sea state and considering a narrow banded process fatigue damage can be estimated from equation 4 larsen and lutes 1991 where d is the fatigue damage t is the duration of the sea state ω is the zero upcrossing frequency m 0 is the zeroth moment of the stress response spectrum k and m are material factors of a linear s n curve and γ is the gamma function the fatigue s n stress number of cycles curve no 3 for the base material and n 10 7 given in tables 2 1 from dnv 2014 is applied 4 d t ω k 2 2 m 0 m γ 1 m 2 3 6 operability analysis for the 2d wave spectra data set dynamic responses are computed and thus operability analyses are conducted operational limits for roll pitch heave and a heave displacement of the bow are considered this allows for a realistic and practical heading selection without considering fatigue damage for operability analysis the weather window analysis methodology proposed by guachamin acero et al 2016 is applied for every heading of the vessel covering the full circle cumulative fatigue damage over all 37 years of wave data is computed this allows for selecting the best heading based on fatigue damage criterion however it is necessary to optimize this heading in view of reducing vessel dynamic responses and fatigue damage since we would like to know if the vessel should head into the largest the smallest or between both wave components of a 2d bimodal spectrum this problem is addressed in sec 3 7 3 7 analysis cases for vessel heading strategy bimodal wave spectra are selected from the full wave data set see sec 3 2 1 simulations are carried out for several cases which combine wave conditions from both actual 2d bimodal and 2d jonswap unimodal spectra and different headings of the vessel as shown in fig 7 five basic heading configurations of the vessel are considered heading configurations hind head 1 and hind head 2 correspond to the vessel heading into the largest and smallest wave components of the actual 2d spectrum respectively heading condition hind head 3 considers the vessel heading between the two wave components configurations for jon head 1 and jon head 2 correspond to the vessel heading into the mean direction of the jonswap spectrum with the largest and smallest spectral peaks of the actual 2d spectra respectively table 3 summarizes various analysis cases c 1 c 7 based on wave spectra data set defined in sec 3 2 1 and heading configurations shown in fig 7 it is noted that in the jonswap cases a wave spreading angle of 180 deg is used to model short crested seas while a wave spreading angle of 30 deg is used to model long crested seas 4 results 4 1 heading selection based on operability analysis and fatigue damage based on the numerical model described in sec 3 4 and 2d hindcast spectra from the wave data set see sec 3 2 1 operability of the vessel is computed using various limiting criteria such as roll pitch heave and heave motion of the bow for all possible headings of the vessel see fig 8 it is shown that the roll limit suggest 300 and 120 deg as the best heading see fig 8 a heave motion of the center of gravity and the bow suggest that 330 and 150 deg are the best headings see fig 8 c d moreover when considering pitch as a limiting criterion 0 and 180 deg are the best headings see fig 8 b based on this information a heading of 330 or 150 deg is the best choice for manoeuvring note that 0 deg means the vessel heading to the true north consideration of fatigue damage as a limiting criterion can help selecting a heading on board a vessel based on equation 4 fig 9 a shows the cumulated fatigue damage for all 2d multimodal spectra which has also been split for winter and summer seasons a total number of 11518 records of 2d bimodal wave spectra have been used whose corresponding fatigue damage are displayed for all headings of the vessel it is clearly observed that 2d bimodal wave spectra can provide quite a good representation of fatigue damage for 2d multimodal wave spectra moreover fig 9 b shows that 2d jonswap spectra modeled with wave parameters of the largest wave component of the corresponding 2d bimodal spectra can still provide a reasonable good representation of fatigue damage based on this information it is evident that the best strategy is to head the vessel to approximately 330 deg however once the vessel is at the offshore site it must be possible to optimize the heading of the vessel in view of reducing fatigue damage based on information regarding 2d wave spectral parameters which are generally available 4 2 assessment of responses for the wave spectra data set for the analyses conducted in this section all 2d bimodal spectra are arranged such that they will always come from the true north this means that spectral peaks will be aligned with the north according to table 3 likewise waves corresponding to 2d jonswap spectra will always arrive from the north it is then possible to analyze differences in fatigue damage obtained from 2d actual and jonswap spectra this section provides details of these comparisons and other associated parameters 4 2 1 bending moments and normal stresses fig 10 a shows an example of a 2d hindcast bimodal wave spectrum and fig 10 b shows response spectra of normal stresses at point a from fig 6 for various analysis cases of table 3 it is observed that when the vessel heads into the least energetic wave component case c 2 the vbms are larger than for the case with the vessel heading into the largest wave component case c 1 this is because vbms do not only depend on the amount of energy of every wave component but also the peak period of the spectrum peak in this example the peak frequency of the least energetic peak is 0 56 rad s which is the same as the pitch natural period see fig 5 a for an intermediate heading case c 3 the stresses are much lower this intermediate heading could be selected in view of reducing fatigue damage provided that other dynamic responses remain below allowable or operational limits vertical bending moments are computed for each analysis case these are used to calculate normal stresses in the longitudinal direction of the vessel root mean squared rms values of stresses between different pairs of analysis cases are computed fig 11 a shows a comparison between cases c 1 and c 4 see case notations and descriptions in table 3 the coefficient of determination is r 2 0 97 and the linear trend shows the ability of the jonswap based model to represent results from the actual spectra in fig 11 b the same rms stresses are compared for corresponding cases c 2 and c 4 it is shown that the correlation is much lower r 2 0 64 the comparison for other cases is summarized in table 4 stresses for the case of the vessel heading through both wave components of the actual spectrum cannot be well represented with the jonswap model see comparison pairs see e g p 3 and p 6 it is observed that only stresses obtained from an actual spectrum with a vessel heading into the largest wave component can be represented by stresses obtained from a jonswap spectrum modeled with spectral parameters of that specific wave component see comparison pairs p 1 and p 7 4 2 2 zero crossing periods tz similarly we provide comparisons for zero crossing periods as this variable is related to the number of cycles experienced by the vessel tz is estimated from spectral analyses of stresses and is defined as 5 t z 2 π m 0 m 2 where m 0 and m 2 are the zeroth and second spectral moments of the normal stress spectra fig 12 shows the tz intercomparisson for cases c 1 vs c 4 and c 2 vs c 4 similarly as in the case of stresses see fig 11 a we observe here that tz values for the actual spectra correspond well with those derived from the jonswap model with θ p and tp corresponding to the largest wave component in contrast the former poorly correlates with the jonswap model using the θ p and tp parameters of the smallest component see fig 12 b comparisons among other pairs of cases are summarized in table 5 where similar results as those obtained for stresses table 4 can be observed with particularly good correspondence for pairs p 1 and p 7 it is noted that the r 2 coefficients are lower for cases where 2d jonswap spectra are modeled with spectral parameters of the least energetic peak of the corresponding 2d bimodal spectra in these conditions the jonswap model do not provide the same tz as the ones obtained from actual wave spectra 4 2 3 fatigue damage d similarly as in the previous sections fig 13 shows comparisons for cases c 1 vs c 4 and c 2 vs c 4 and table 6 includes the comparison for other pairs consistently here too pairs p 1 and p 7 show better correspondences for all analysis cases the normalized cumulative fatigue damage is shown in fig 14 for 0 deg heading it can be observed that the jonswap model with 180 deg spreading angle cases c 4 and c 5 provide the largest fatigue damage with slightly larger values than those for 2d bimodal spectra with the vessel heading to the largest peak component case c 1 moreover the shapes of these three fatigue damage curves are quite similar finally it is clear to see that fatigue damage for cases c 2 and c 3 are different from those obtained for the jonswap models curves for cases c 6 and c 7 are not shown for sake of clarity a summary of these results for 0 deg heading is shown in fig 15 the following observations can be made case c 7 results in the largest fatigue damage fatigue damage for cases c 4 and c 6 are lower 3 and 5 respectively than those for the corresponding cases c 5 and c 7 fatigue damage for cases c 2 and c 3 using the actual spectra are significantly lower about 40 of case c 4 fatigue damage for case c 1 is about 90 of its corresponding case c 4 fatigue damage for case c 2 is about 50 of its corresponding value for case c 1 4 3 assessment of roll responses using 2d bimodal spectra and heading selection for sake of completeness analysis cases c 1 to c 3 are used to compare roll responses of the vessel this is because roll or its associated responses can vary significantly when choosing a heading of the vessel based solely on fatigue damage as an example fig 16 shows that for case c 1 roll responses are the lowest this is opposite to fatigue damage see fig 15 from these figures it is noticed that for 330 deg heading or vessel heading 30 deg off from any heading for cases c 1 to c 3 almost all cases produce the same roll responses and fatigue damage this means that if the heading of the vessel is not carefully controlled a small deviation from the best heading will not benefit for obtaining the best responses and lowest fatigue damage for example consider the vessel heading to the smallest wave component of the 2d bimodal wave spectra case c 2 figs 14 and 15 show that fatigue damage is approximately 50 that of case c 1 additionally fig 16 shows that roll responses for case c 2 are approximately 33 larger than that of case c 1 thus in benign seas if roll responses remain below corresponding operational limits heading the vessel into the smallest wave component of a 2d bimodal spectra can reduce fatigue damage in about 50 to exemplify the results given above and their use in weather window analysis fig 17 a shows some time histories of roll double amplitude significant response the operational limit is assumed 8 deg as defined above note that the roll responses for the best heading 330 deg are similar but generally lower than the other cases all responses above 8 deg are not workable fig 17 b shows that fatigue damage for case analyses c 1 c 3 can be significantly lower than for the best heading thus provided that roll dynamic responses remain below the operational limit the heading of the vessel can be optimized to reduce fatigue damage this information can be very useful when executing marine operations using forecast 2d wave spectra time series especially during the summer season when seas and vessel dynamic responses are relatively low note that apart from roll any other vessel response can be considered 5 discussion when only combined spectral parameters i e hs tp θ are available 2d jonswap spectra have to be constructed results from tables 4 6 show that there is a good degree of correlation between estimates from actual 2d spectra with the vessel heading into the largest wave component and those from jonswap spectra modeled with corresponding spectral parameters this is because there is a good correlation between these parameters for cases c 1 and c 4 or c 1 and c 6 as most of wave energy is concentrated at the same peak frequency for each comparison pair according to fig 15 the fatigue damage for case c 1 is 10 lower than the corresponding value for case c 4 this difference is not considerable when 2d jonswap spectra are modeled using a 180 deg spreading angle thus jonswap spectra can provide a good representation of fatigue damage during the planning phase when full information of 2d bimodal spectra is not available operability analysis based on vessel dynamic responses within the corresponding operational limits can be used as criteria for selecting the best heading of a vessel e g 330 deg which can be obtained from figures such as fig 8 by applying spectral analysis using historical 2d multimodal hindcast spectra similar results for the fatigue criterion can also be obtained using only 2d bimodal spectra or 2d jonswap spectra modeled with spectral parameters of the most energetic wave component see fig 9 for operability analysis using dynamic responses fig 16 provides an example of roll responses calculated for all 37 years of 2d actual wave spectra from sec 3 2 1 similar plots can be evaluated on a monthly basis which can be used to select a preferred heading e g towards the largest wave component because it gives the best roll responses however other dynamic responses such as heave crane tip motion and pitch can be used for weather restricted and unrestricted marine operations once the heading of the vessel and the season or month for the marine operation are selected it is necessary to identify a suitable woww for which a weather forecast is needed the forecast can be available hours or days prior to execution of the marine operation the weather forecasts can be used to compute time series of dynamic responses such as the one shown in fig 17 a by comparing these dynamic responses with their corresponding systematically derived operational limits and by considering the duration of the operations suitable workable weather windows can be identified guachamin acero et al 2016 as an example fig 17 a shows a workable weather window between 4th and 16th of july where dynamic responses for the 330 deg heading that can be selected during the planning phase of the marine operation remain below the assumed operational limit however it should be possible to optimize this heading in view of reducing fatigue damage and keeping the same woww using hindcast wave records results for cases c 2 c 3 from fig 14 showed that fatigue damage can be reduced by directing the vessel towards the least energetic wave component or an intermediate heading between both wave directions in fact fatigue damage can be up to 50 lower than that obtained for the vessel heading to the most energetic wave component case c 1 see fig 15 thus a change of heading that produces the same woww and reduce fatigue damage can be considered based on fig 17 a one may choose a change of heading that produces the same woww and reduce fatigue damage e g to head the vessel into the most or the least energetic wave components cases c 1 and c 2 because fatigue damage is less than for the best heading 330 deg see fig 17 b and roll significant responses remain acceptable likewise similar plots can be used on board vessels for execution of any marine operation summarizing in practice weather restricted such as offshore heavy lifting and weather unrestricted marine operations such as maritime transportation sea keeping of offshore drilling ships and heading control of fpsos can be planned based on information such as that presented in figs 14 and 16 once at the offshore site the heading of the vessel can be optimized in view of reducing fatigue damage based on forecast wave data and information as that given in fig 17 although actual fatigue damage depends on many other factors than those considered in the method proposed our results provide valuable information of a percentage of reduction of the order of magnitude in the reduction of fatigue damage this magnitude can be significant for some headings and will be similar if corrected stresses are used instead in fact corrected stresses will provide actual fatigue damage of the structure during the marine operation moreover optimized headings can be selected only when dynamic responses remain below their operational limits so the fatigue damage criterion is complementary to other operational limiting criteria and should not aim to replace them this paper considers a case study of a section of a vessel where fatigue damage is dominated by vbms in fact other locations of a vessel may be selected for instance stresses in the connections of a topside module may not only require contributions from vertical and horizontal bending moments but also torsional moments and accelerations of the module due to rigid body motions of structures nevertheless the methodology proposed here provides the basis for analyzing other marine operations from a practical point of view fatigue damage on the hull girder of vessels for weather restricted and unrestricted marine operations can be well represented by the 2d jonswap model provided that once at site the vessel will head into the largest wave component unfortunately this is not always the case because one structure can interfere with another or due to another specific operational requirement of the operation moreover heading into the largest wave component will not necessarily result in lower dynamic responses or lower fatigue damage as it was shown in fig 10 b fatigue damage depends on the natural period of pitch and the peak period of the 2d wave spectral components heading strategies are different during normal operations and during extreme conditions a deeper assessment of fatigue damage should include these facts as well especially when structures are approaching the end of their service lives or when a life extension assessment is required nowadays monitoring and recording of ship s responses plus the availability of detailed records of environmental variables is becoming routine therefore such information together with numerical simulations can be used for assessing heading strategies providing insights on fatigue damage during planning and execution of operations structural integrity and vessel stability are aspects of utmost importance when executing offshore activities considering besides that wave spectra at sea can be in general multimodal better tools for safety assessment ought to be developed incorporating criteria for stability ultimate limit state design comfort fatigue among other considerations in order to help operators make quick and safe decisions despite the differences in fatigue damage for actual spectra and their corresponding jonswap models it is observed that recommendations given by standards lead in general to conservative results therefore they should be used in absence of more accurate or better assessment tools 6 summary conclusions and recommendations 6 1 summary and conclusions this paper introduces fatigue damage as a criterion for heading selection for vessels exposed to 2d bimodal and multimodal seas this criterion together with operability analyses can be used for selecting a heading of the vessel based on these limits the vessel can head to a specific peak or intermediate directions in order to reduce fatigue damage thus the heading of the vessel can be optimized for assessment of fatigue damage of a vessel under action of actual 2d bimodal and 2d jonswap unimodal spectra a set of wave spectra from the north atlantic ocean data was used these spectra are applied to a vessel which is modeled using a dynamic panel model bending moments are calculated at midships and used to compute fatigue damage this is done for several cases that involve different input spectra and headings configurations a comparison of normal stresses zero crossing periods and fatigue damage between various cases was conducted it was found that there is good correlation between the following cases responses computed by applying actual 2d spectra with the vessel heading into the largest wave component or peak direction and responses computed from 2d jonswap spectra modeled with spectral parameters using the same periods and directions of the corresponding component apart from these cases jonswap spectra does not properly represent cases with actual 2d spectra fatigue damage estimated from actual 2d spectra with the vessel heading into the largest wave component is approximately 90 of that obtained from its corresponding jonswap counterpart these differences can vary and will depend on spectral parameters of the wave spectra at the offshore site from records of actual 2d bimodal wave spectra in general it was found that the fatigue damage for the case of the vessel heading to the smallest wave component fatigue damage is about 50 of the corresponding one of the vessel heading to the largest component this may not be the case for every wave spectrum because dynamic responses depend on the peak period of the wave spectral components nowadays there is a large amount of data sets containing actual 2d wave spectra e g modeled or measured and considering the available computational capacity and efficiency of state of the art codes it is possible to conduct real time and on board simulations of operations without any need of simplifying actual 2d spectra the outcome of this research can be valuable for developing on board systems to help operators on making informed decisions especially for execution of marine operations with the aim of reducing fatigue damage this can also be important for ships reaching the end of their design service life or when the life extension of a vessel is required 6 2 recommendations and further work fatigue damage was assessed for specific heading configurations of a vessel and by applying 2d bimodal wave spectra from a specific offshore site to contrast results from this paper it is necessary to conduct analyses for other offshore locations that include other wave components which can arrive from different directions it is noted that wave spectra in the north atlantic ocean can be multimodal thus it is necessary to identify wave system components for predefined navigation routes these can be valuable for safety assessment including criteria such as ultimate limit state design fatigue and stability continuous development of decision making tools is necessary especially for ships operating in offshore sites with multimodal wave conditions this can help operators make more informed decisions and reduce associated risks numerical simulations including vessel forward speed and real time heading control should be performed these are other parameters essential in maritime transportation credit authorship contribution statement wilson guachamin acero writing original draft methodology writing paper structure methodology numerical models conducting numerical simulations jesús portilla yandún data curation writing review editing generating input wave data reviewing proof reading declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors thank support from project pigr 19 08 evaluación de parámetros oceánicos para la planificación de operaciones marinas en las costas del ecuador granted through the faculty of mechanical engineering of escuela politécnica nacional 
20909,to improve the safety and efficiency when ships pass through a lock a cooperative ship formation system csfs in the lock waterway is proposed an improved ship formation structure with the combination of leader follower and behaviour based structure is designed and the relevant control modes are described according to the process of ship formation passing through the lock millimetre wave mmw radars are introduced for the perception of ship states moreover speed control stop control and distance keeping control methods are proposed which are related to the distance keeping control mode speed control mode stop control mode stop finished mode and emergency stop mode finally a real csfs platform with three different engineering ships was implemented in the gezhouba lock waterway to verify the effectiveness of csfs and proposed control methods several experimental tests were carried out with the csfs platform the experiment results show that 1 the average tracking error of the distance keeping control is 2 43 m 2 the average speed control error of the leading ship is 0 08 m s 3 the leading ship can stop at around 2 0 m to the stop line and both the leading ship and the following ship can switch smoothly between the different control modes keywords lock waterway cooperative formation control leader follower structure speed control millimetre wave radar 1 introduction a ship lock is a facility used for raising and lowering ships and other watercraft between low level and high level waterway and connecting different water systems and improving waterway dimension and water flow condition which has been the key node of inland river navigation bugarski et al 2013 the ship lock consists of navigation wall lock chamber gates approach channels cill balance beam paddle winding gear etc wang and zou 2014 in consideration of the lock s and ship s safety a ship is required to keep low speed during passing through the lock it is known that ship navigation in the lock waterway is restricted and navigation risk e g collision becomes larger when the crew s driving level is declined the low navigation efficiency in the lock waterway can lead to the ship congestion with the waterway transportation increasing therefore the process for a ship passing through the lock is one of the bottlenecks to improve the navigation ability of inland waterway zhao et al 2020 pointed out that the traffic congestion at the three gorges dam had become a serious problem in recent years two major problems are summarized for ship passing through the lock as follows the efficiency is relatively low since two or more ships cannot move simultaneously with a close distance the bollard is often damaged because ship cannot stop at the precise stop line because of human operational mistakes in the lock chamber there are several measures that can be taken to solve the above problems the first one is to deploy the standardization type ships to improve the ship total tonnage of single lock but this will restrain the navigation of existing non standard ships the second one is to improve the traffic efficiency of the ship lock waterway with the traffic control methods based on the historical traffic data e g see backalic and bukurov 2011 and zhao et al 2020 the last one is to form a ship formation to make the formation move integrally a ship formation is fastened traditionally by the physical force e g mooring rope steel frame but the physical way could consume much time and the formation cannot change flexibly a self organizing formation can structure different types of ships without fastening physically which means that the formation can be built quickly and change flexibly cooperative ship formation systems csfss or cooperative multi vessel systems cmvss have gained extensive attention recently xie et al 2018a chen et al 2018 the csfs can be widely used in practical scenarios e g marine search rescue mission patrol marine reconnaissance commercial transportation xie et al 2018a many studies for the csfs focuses on proposing a new formation type or an improved control method with some general scenarios arrichiello et al 2006 li et al 2018 do 2011 fahimi 2007 huang et al 2019 building csfss is a useful way to solve the aforementioned problems in the ship lock waterway there exist two problems to realize the cooperative control of ship formation in the lock waterway one is that the lock navigation waterway is confined which leads to the manoeuvrability in the lock waterway is different from that in open waterway and the ship speed should be kept at the low level the other is that many formation control methods of ship formation lack of the real experimental tests to verify the effectiveness of csfss and cooperative control methods for most studies of formation control in consideration of experimental complexity and safety the effective works of the proposed methods have been conducted by simulation see sun et al 2018 park 2015 huang et al 2019 zheng et al 2018 chen et al 2018 wei et al 2010 and arrichiello et al 2006 cui et al 2018 has developed a simulation platform for assessing cooperative adaptive cruise control in comparison with other formation platforms e g car formation and plane formation the csfs platform has more difficulties that mainly exist in the under actuated defect for an individual ship and the unpredictability of the waterway a real experimental platform of csfc is necessary to validate the cooperative formation control methods and relative technologies perception of csfs is the basis of meeting the requirements of precious speed and distance keeping control xie et al 2018b in the past a ship did not have the requirement to transmit its navigation states to other ships and the shore centre however for the csfs the ship navigation states i e speed position rotation speed of main engines relative distance and speed for each other heading should be shared precisely in real time with the ships and shore centre an emergency switch way needs to be designed to guarantee the experimental safety in case of the failure of the csfs a model needs to be proposed to assess the performance of the csfs control including the safety reliability and efficiency from the literature five structures of ship formation are mainly taken into account i e leader follower structure behavioural based structure virtual structure graph theory structure and distributed model predictive control dmpc structure for the leader follower structure the formation is required to be a designed formation shape and tracks with a leader sun et al 2018 shojaei 2015 he et al 2018 for the behavioural based structure behavioural based systems integrate several goal oriented behaviours simultaneously which can conduct multiple tasks such as obstacle avoidance formation keeping at the same time balch and arkin 1998 lawton et al 2003 arrichiello et al 2006 for the virtual structure this structure regards the entire formation as a single virtual rigid structure which means individuals in the formation are similar to particles embedded in a rigid structure lewis and tan 1997 mehrjerdi et al 2011 qin et al 2017 for the graph theory structure a direct or un directed graph is usually employed to model the communication topology park and yoo 2018 huang et al 2019 for the dmpc structure the formation control problem is solved locally at the individual level with strong robustness even though the individual in the formation fails zheng et al 2018 chen et al 2018 wei et al 2010 zheng et al 2016 apart from the above classification method according to the types of sensed and controlled variables oh et al 2015 categorized the formation control as position based control displacement based control and distance based control the formation control of passing through the lock is more complicated than the formation control in the open waterway to design an appropriate formation structure in the lock waterway is important to improve the navigation efficiency and safety of ships based on the above requirements the main objectives of this article concentrates on the csfs structure and design the study of cooperative formation control methods implementation and experimental tests of csfs the rest of the article is organized as follows section 2 introduces the design and perception measures of csfs section 3 proposes speed control stop control and distance keeping control method for the leading ship and the following ships respectively in section 4 the csfs is implemented with three engineering ships in gezhouba lock waterway in section 5 several tests are done with the real csfs platform in gezhouba lock no 2 and no 3 and the results are analysed to assess the control performance finally section 6 concludes main works and outlooks future plans 2 perception of ship formation the perception of ship formation in the lock waterway has its restrictions which include lower global navigation satellite system gnss signal strength navigation wall and lock door interference close distance between ships etc hence the specific structure and perception measures for the ship formation for passing through the lock are introduced in this section 2 1 structure of ship formation passing through a lock the structure of ship formation refers to the form of the construction and the operation of ship formation it provides individual behaviour and preset trajectory reference for the formation controller as mentioned above the typical ship formation structure includes leader follower structure virtual structure behaviour based structure graph based structure etc the study on the formation control structure is relatively mature and each formation structure has an adaptive scenario the ship formation passing through the lock is relatively stable and the ship can obtain the real time feedback from the other ships meanwhile the process of pass through a lock for ships is relatively complicated which includes low speed navigation in the navigation wall entering the lock gate navigation in the lock chamber stopping at the lock chamber leaving the lock chamber etc to improve the formation safety and efficiency a leader follower structure combined with the behaviour based structure is designed in this article to ensure the safety of navigation the speed of ships passing through the lock is low and the ships should meet the navigation rule requirements an improved leader follower structure is proposed to organize the ship formation through the lock that is the ship formation is composed of one leading ship and several following ships as shown in fig 1 when a ship stops at the stop line in the lock chamber the headline of the ship cannot be allowed to cross the forbidden line the leading ship sets its speed according to the navigation rules of the lock waterway each following ship has its own target ship that could be the leading ship or another following ship which means a following ship may have two roles i e the following ship and the target ship the following ships dynamically adjust their speed according to the relative distance and relative speed to the leading ship the leading ship and the following ships have relevant different behaviours for instance the leading ship has the speed control behaviour stop control behaviour stop finished behaviour and emergency stop behaviour and the following ship has distance keeping behaviour stop finished behaviour and emergency stop behaviour hence the proposed formation structure is the combination of leader follower and behaviour based structure the detail of the formation control will be discussed in section 3 2 2 perception measure of ship formation in lock waterway the ship formation perception system is an important part of csfs the information by the perception system contains ship navigation environment status own ship s and other ships navigation status lock status monitoring orders etc the perception scheme illustrates the perception information flow and the perception measures which is shown in fig 2 1 environmental perception based on millimetre wave radar in consideration of relatively short ranging ability less than 300 m a millimeter wave mmw radar is scarcely utilized for ship environment perception considering that the ship formation in the lock waterway is tight the relative distance between a ship and its around ship is usually less than 100 m an mmw based perception measure is adopted in this article explicitly the environmental perception system consists of an mmw radar ars408 21 is used in this article mounted at the ship bow and three short distance mmw radar car28f is used in this article mounted at the ship stern port side and starboard side an mmw radar operates in the mmw frequency band 30 300 ghz the mmw radar has the advantages of both microwave and photoelectricity and has small size light weight and high spatial resolution yoneda et al 2018 compared with the solid state radar and laser radar the mmw radar has a more substantial penetration of fog smoke dust and others moreover the mmw radar has a unique advantage in the dynamic perception of ship navigation the mmw radar can obtain the precise distance between ships and the relative speed of ships in order to prevent the mmw radar from sweeping to both sides of the lock wall when the ship is in the lock chamber which will affect the ship distance data the effective sweep angle of the mmw radar is set to filter the data to eliminate the influence of the lock wall on the target measurement taking the front mmw radar of the ship passing through the lock as an example the radar scanning angle setting is shown in fig 3 as is shown in fig 3 φ is the effective sweep angle of mmw radar b is the width of the lock chamber c is a shorter distance between the ship and the lock wall d is the shortest allowed distance between adjacent ships in the longitudinal direction θ is the angle between the ship heading and the lock chamber direction to avoid the lock wall affects the distance measurement of d the sweep angle of the mmw radar needs to be set as follows in consideration of the ship heading deflection 1 d c sin φ 2 θ where the value of c can be measured by the port or starboard mmw radar according to the mmw radar ranging value the precise position coordinates of the ship in the lock chamber can be calculated as is shown in fig 4 abdc represents the front ship efhg represents the object ship and ijlk represents the rear ship assuming that the front and rear ship are both a rectangular target with a fixed size in general the distances from abdc to the left and right lock wall are a 1 and a 2 respectively the distances from efhg to abdc the left wall the right wall and ijlk are d 1 d 2 d 3 and d 4 respectively the distances from ijlk to the left and right lock wall are f 1 and f 2 respectively define the included angle of efhg to the forward direction of the lock chamber is ψ the positioning parameters are calculated as follows 2 a 1 b 1 w 2 cos ψ 1 d 1 sin ψ 3 b 1 d 2 cos ψ l 2 x 2 sin ψ b 2 d 3 cos ψ l 2 x 3 sin ψ b 3 b 1 l sin ψ b 4 b 2 l sin ψ 4 c 1 d 1 cos ψ w 2 sin ψ c 2 l cos ψ c 3 w 2 sin ψ d 4 cos ψ where w and l are the ship width and length of efhg to eliminate the interferences of the environmental objects such as water surface lock wall and so on several filtering measures are utilized specifically most of the lock wall and lock door interferences can be eliminated with the appropriate sweep angle setting on the basis of the differences between the ship object and the water surface the interference elimination of the water surface can be realized by setting the value range of the reflectivity and the area of radar cross section rcs 2 ship status perception the gyrocompass is used to obtain the ship s heading and attitude data differential gnss is utilized to obtain the accurate real time position speed and heading data of the ship ultra wide band uwb positioning system is a local positioning system which can keep the positioning ability even if gnss signal is weak or lost the data acquisition terminal is used to obtain the data of ship main engine and propeller speeds and integrate all the ship status data the onboard computer is used for the data processing data analysis algorithm realization and status displaying and saving the ship state perception hardware architecture is shown in fig 5 2 3 ship and shore interaction csfs consists of one shore based system and several ship onboard systems ship and shore interaction mainly realizes ship to shore communication shore based monitoring data storage human machine interaction ship to shore interaction data mainly include ship pose positioning data mmw radar data lock status data lock signal status data monitoring information data etc the information interaction is illustrated in fig 6 3 control methods for passing through the ship lock cooperatively navigation behaviours of a leading ship for passing through a lock correspond to four control modes i e speed control mode stop control mode stop finished mode and emergency stop control mode the control process of the leading ship is shown in fig 7 similarly navigation behaviours of a following ship for passing through a lock correspond to three control modes i e distance keeping control mode stop finished mode and emergency stop control mode the control process of the following ship is shown in fig 8 the mode switch procedure and longitude distance conversion for the leading ship and the following ship are illustrated as fig 9 from fig 9 it can be seen that the actual trajectory in the lock waterway is transferred to the longitude distance from the starting point in the coordination of longitude distance and speed axis the navigation behaviour is described as the behaviour state s x v x where s x is the longitude distance v x is the ship speed for instance the state s p 0 stands for the stop finished behaviour or mode 3 1 speed control method speed control refers to the automatic control of the longitudinal speed of the leading ship in accordance with the navigation rules of the lock waterway this article uses the fuzzy proportion integral differential pid method to realize the speed control of the ship the target speed is defined as v 0 take the telegraph order as the system input u t at time t 5 u t k p e t k i i 0 t e i k d e t e t 1 where k p k i and k d are the pid parameters e t is the control error and represented as e v t v 0 at time t in which v t is the measured speed of the ship and v 0 is the objective speed of the ship considering that the forward and reverse efficiency of ship propellers at the same rotation speed are different pid parameters should be set respectively to prevent manipulating the ship telegraph too frequently a fuzzy speed zone is proposed namely 6 u t 0 if v t v f v f k p e t k i i 0 t e i k d e t e t 1 else where v f 0 is the preset fuzzy speed 3 2 stopping control method accidents such as damage to the bollards of the lock chamber and collision of the lock gate or wall caused by the ship s mishandling often occur hence it is essential to realize automatic and precise stop control in the lock chamber when a leading ship in the formation passing through the lock stops at the designated stop position in the lock chamber the following ship will keep a safety distance from the leading ship and stop accordingly the navigation longitudinal distance for the whole stop procedure is defined as the stop distance denoted as d s stop distance is related to the ship manoeuvrability the ship speed and telegraph input to make the ship stop accurately in the lock chamber an appropriate target stop distance should be set as d 0 a ship stopping at the stop line means that the ship s speed keeps 0 and the ship s telegraph keeps neutral no power output for the propellers actually the process of stopping a ship can be described as the process of controlling the ship s motion state v t u t to 0 0 among the states u 0 is the ahead telegraph order u 0 is the astern telegraph order u 0 is the neutral telegraph order the target speed function f s during the ship stopping in the lock chamber is defined as 7 v 0 t f s d t d t d s 0 where d t is the distance between the ship and the stop line at time t and when the ship crosses the stop line we have d t 0 v 0 t is the ship s target speed d s 0 is the distance to judge the speed control mode or the stop control mode for a leading ship the stop distance interval is set to judge whether the stop procedure is finished or not namely 8 leading ship control mode speed control mode if d t d s 0 stop control mode if d t d s e d s 0 stop finished mode if d t d s e d s e emergency stop mode if d t d s e where d s e is the fuzzy distance of the stop finished mode and d s e d s 0 3 3 distance keeping control method each following ship i has its own target ship that could be another following ship or the leading ship the following ship keeps the relative distance and speed from the target ship according to the target ship s speed and distance the distance between the following ship i and the target ship is set as the control feedback i e the system output which is denoted as d i t at time t the telegraph is set as the control output i e the system input which is denoted as u i t at the time t the target keeping distance is set as the control objective which is denoted as d 0 a fuzzy pid method is used as the distance keeping control method for the following ship i 9 u i t k i p e i t k i i i 0 t e i i k i d e i t e i t 1 considering that the ship propeller forward and reverse efficiency at the same speed are different pid parameters i e k i p k i i and k i d should be set for the ahead and astern telegraph order respectively assuming that the relative velocity of the two ships is v i r t v i r t 0 indicates the relative distance of two ships is shrinking in order to maintain the stability of ship tracking the tracking target distance fuzzy area is set as d i 0 d if d i 0 d i f the fuzzy area u t is considered as 10 u t k i r v i r t if d i t d i 0 d i f d i 0 d i f k i p e t k i i i 0 t e i i k i d e i t e i t 1 else where d i f 0 is the fuzzy distance threshold value and k i r represents the control parameter the distance d i t and relative speed v i r t between the following ship i and the target ship are measured by mmw radars 4 system implementation 1 hardware implementation fig 10 shows the main devices of csfs the lcd screen is used for displaying the real time telegraph input of ships the control mode switch can change the control mode between automatic control mode and manual control mode to ensure ship navigation safety the high precision positioning system provides a precise position for the own ship and other ships mmw radars provide reliable relative distance and relative speed for the ships this system worked well during the test 2 software implementation the onboard software is developed for each ship to pass through the lock whose interface is shown as fig 11 the software mainly realizes the following functions 1 real time analysis filtering and fusion of multi source and heterogeneous data 2 real time display and storage of status data ship attitude and control status 3 configuration of various parameters such as ship type lock direction ship size piloting speed stop position forward reverse parameters etc 4 manual input of control instructions 5 cooperative control of ship formation 3 mmw radar measurement the mmw radar is used for the relative distance and speed measurement between the leading ship and the following ship fig 12 shows the measured results from the hanggong 07 bow mmw radar it can be seen from fig 12 that the measured values vary smoothly without an outlier which stands for the relative distance and speed between hanggong 07 and hanggong 201 5 csfs experimental tests to test the effectiveness of the designed csfs and the proposed formation control methods in the real lock waterway several tests in lock no 2 and no 3 of gezhouba lock china have been conducted the test sites and scenarios are shown in fig 13 chamber of lock no 2 is 280 m long and 34 m wide chamber of lock no 3 is 120 m long and 18 m wide several experimental tests including distance keeping control speed control and lock crossing control of the two ship formation were completed see table 1 for details the main parameters of the scenario and controller are set as table 2 5 1 distance keeping control test during the distance keeping control test haixun 12907 acts as a leading ship manual control and haixun 12911 acts as a following ship automatic control to verify the performance of haixun 12911 s distance keeping in the scenario of the change of relative speed between haixun 12907 and haixun 12911 the designed keeping distance is set at 20 0 m and the haixun 12907 the leading ship is manipulated at around 1 0 m s to denote the telegraph order clearly the telegraph order range is set to 100 100 where 100 and 100 stand for the full astern and the full ahead order respectively the test results are shown in fig 14 according to the experimental data the average tracking distance error is 2 43 m and the average relative speed is 0 33 m s from figs 14c and 14d it can be seen that the propeller rotation speed change is consistent with the telegraph input value the distance keeping control results show that the proposed distance keeping control method can meet the requirements of the ship formation control in the lock waterway 5 2 speed control test in the scenario of speed control test a leading ship i e hanggong 201 is controlled by the csfs the ship initial navigation speed is set as 0 8 m s the test results are shown in fig 15 from the experimental data the average speed control error is 0 08 m s from the speed control test results it can be seen that the ship actual speed approaches to the designed speed within a short time and keeps at the value around the designed speed by the use of the proposed speed control method 5 3 cooperative control test with two ship formations during the cooperative control test of the two ship formation the leading ship hanggong 201 is automatically controlled by csfs during the speed control and stop control mode the following ship hanggong 07 is also automatically controlled by csfs during the distance keeping control mode and stop control mode the data of cooperative control process are shown in fig 16 after entering the stop ship mode the speed slowly drops to 0 at this time the distance between the leading ship and the set stop line is 2 0 m after starting again the leading ship s speed steadily accelerates to 0 8 m s as shown in figs 16a and 16b the following ship hanggong 07 maintains at the speed below 1 5 m s during the upstream crossing of the lock and the longitudinal distance from the leading ship is kept at the set distance of about 30 m as shown in figs 16c and 16d because the leading ship and the following ship are not collinear in the following ship heading direction when mooring the mmw radar measurement output keeps 0 the csfs can realize ship speed control ship distance keeping control and ship stop control from the analysis of the test results 6 conclusion to improve the safety and efficiency when ships pass through the lock waterway a csfs is designed and implemented in gezhouba lock waterway mmw radars are utilized to measure the relative distance and the relative speed between ships cooperative formation control methods are proposed to control ships passing through the lock automatically the main conclusions are as follows 1 the ship formation structure based on the leading following and behaviour is designed the leading ship has speed control mode stop control mode stop finished mode and emergency stop mode the following ship has distance keeping control stop control mode and emergency stop mode 2 a ship status perception method based on mmw radar and ship shore interaction are proposed to achieve the acquisition of the ship s navigation states and formation states in the confined lock waterway environment 3 the cooperative speed control methods of ship formation i e distance keeping control speed control and stop control is proposed csfs and control methods have been tested several times in the waterway of gezhouba lock no 2 and no 3 the average tracking error of the distance keeping control for the following ship is 2 43 m and the average relative speed for the leading ship is 0 33 m s speed control error for the leading ship is 0 08 m s for the stop control the leading ship and the following can complete the accurate stop control in future research the distributed control idea can be considered to realize the cooperative control of multiple ships passing through the lock to improve the formation system s real time performance and robustness the cooperative formation control method can also be applied to multi stage lock formation scheduling and control to solve the optimal control among multiple formations and improve the navigation efficiency of ships in the whole lock waterway credit authorship contribution statement chenguang liu conceptualization methodology software validation editing junlin qi investigation conceptualization resources xiumin chu supervision funding acquisition validation mao zheng software validation writing reviewing wei he supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this article is supported by national key research and development program of china 2018yfb1600404 national natural science foundation of china 52001240 natural science foundation of hubei province china 2020cfb307 fundamental research funds for the central universities china 203144003 202444001 industry university cooperation project of fujian provincial department of science and technology china 2019h6018 
20909,to improve the safety and efficiency when ships pass through a lock a cooperative ship formation system csfs in the lock waterway is proposed an improved ship formation structure with the combination of leader follower and behaviour based structure is designed and the relevant control modes are described according to the process of ship formation passing through the lock millimetre wave mmw radars are introduced for the perception of ship states moreover speed control stop control and distance keeping control methods are proposed which are related to the distance keeping control mode speed control mode stop control mode stop finished mode and emergency stop mode finally a real csfs platform with three different engineering ships was implemented in the gezhouba lock waterway to verify the effectiveness of csfs and proposed control methods several experimental tests were carried out with the csfs platform the experiment results show that 1 the average tracking error of the distance keeping control is 2 43 m 2 the average speed control error of the leading ship is 0 08 m s 3 the leading ship can stop at around 2 0 m to the stop line and both the leading ship and the following ship can switch smoothly between the different control modes keywords lock waterway cooperative formation control leader follower structure speed control millimetre wave radar 1 introduction a ship lock is a facility used for raising and lowering ships and other watercraft between low level and high level waterway and connecting different water systems and improving waterway dimension and water flow condition which has been the key node of inland river navigation bugarski et al 2013 the ship lock consists of navigation wall lock chamber gates approach channels cill balance beam paddle winding gear etc wang and zou 2014 in consideration of the lock s and ship s safety a ship is required to keep low speed during passing through the lock it is known that ship navigation in the lock waterway is restricted and navigation risk e g collision becomes larger when the crew s driving level is declined the low navigation efficiency in the lock waterway can lead to the ship congestion with the waterway transportation increasing therefore the process for a ship passing through the lock is one of the bottlenecks to improve the navigation ability of inland waterway zhao et al 2020 pointed out that the traffic congestion at the three gorges dam had become a serious problem in recent years two major problems are summarized for ship passing through the lock as follows the efficiency is relatively low since two or more ships cannot move simultaneously with a close distance the bollard is often damaged because ship cannot stop at the precise stop line because of human operational mistakes in the lock chamber there are several measures that can be taken to solve the above problems the first one is to deploy the standardization type ships to improve the ship total tonnage of single lock but this will restrain the navigation of existing non standard ships the second one is to improve the traffic efficiency of the ship lock waterway with the traffic control methods based on the historical traffic data e g see backalic and bukurov 2011 and zhao et al 2020 the last one is to form a ship formation to make the formation move integrally a ship formation is fastened traditionally by the physical force e g mooring rope steel frame but the physical way could consume much time and the formation cannot change flexibly a self organizing formation can structure different types of ships without fastening physically which means that the formation can be built quickly and change flexibly cooperative ship formation systems csfss or cooperative multi vessel systems cmvss have gained extensive attention recently xie et al 2018a chen et al 2018 the csfs can be widely used in practical scenarios e g marine search rescue mission patrol marine reconnaissance commercial transportation xie et al 2018a many studies for the csfs focuses on proposing a new formation type or an improved control method with some general scenarios arrichiello et al 2006 li et al 2018 do 2011 fahimi 2007 huang et al 2019 building csfss is a useful way to solve the aforementioned problems in the ship lock waterway there exist two problems to realize the cooperative control of ship formation in the lock waterway one is that the lock navigation waterway is confined which leads to the manoeuvrability in the lock waterway is different from that in open waterway and the ship speed should be kept at the low level the other is that many formation control methods of ship formation lack of the real experimental tests to verify the effectiveness of csfss and cooperative control methods for most studies of formation control in consideration of experimental complexity and safety the effective works of the proposed methods have been conducted by simulation see sun et al 2018 park 2015 huang et al 2019 zheng et al 2018 chen et al 2018 wei et al 2010 and arrichiello et al 2006 cui et al 2018 has developed a simulation platform for assessing cooperative adaptive cruise control in comparison with other formation platforms e g car formation and plane formation the csfs platform has more difficulties that mainly exist in the under actuated defect for an individual ship and the unpredictability of the waterway a real experimental platform of csfc is necessary to validate the cooperative formation control methods and relative technologies perception of csfs is the basis of meeting the requirements of precious speed and distance keeping control xie et al 2018b in the past a ship did not have the requirement to transmit its navigation states to other ships and the shore centre however for the csfs the ship navigation states i e speed position rotation speed of main engines relative distance and speed for each other heading should be shared precisely in real time with the ships and shore centre an emergency switch way needs to be designed to guarantee the experimental safety in case of the failure of the csfs a model needs to be proposed to assess the performance of the csfs control including the safety reliability and efficiency from the literature five structures of ship formation are mainly taken into account i e leader follower structure behavioural based structure virtual structure graph theory structure and distributed model predictive control dmpc structure for the leader follower structure the formation is required to be a designed formation shape and tracks with a leader sun et al 2018 shojaei 2015 he et al 2018 for the behavioural based structure behavioural based systems integrate several goal oriented behaviours simultaneously which can conduct multiple tasks such as obstacle avoidance formation keeping at the same time balch and arkin 1998 lawton et al 2003 arrichiello et al 2006 for the virtual structure this structure regards the entire formation as a single virtual rigid structure which means individuals in the formation are similar to particles embedded in a rigid structure lewis and tan 1997 mehrjerdi et al 2011 qin et al 2017 for the graph theory structure a direct or un directed graph is usually employed to model the communication topology park and yoo 2018 huang et al 2019 for the dmpc structure the formation control problem is solved locally at the individual level with strong robustness even though the individual in the formation fails zheng et al 2018 chen et al 2018 wei et al 2010 zheng et al 2016 apart from the above classification method according to the types of sensed and controlled variables oh et al 2015 categorized the formation control as position based control displacement based control and distance based control the formation control of passing through the lock is more complicated than the formation control in the open waterway to design an appropriate formation structure in the lock waterway is important to improve the navigation efficiency and safety of ships based on the above requirements the main objectives of this article concentrates on the csfs structure and design the study of cooperative formation control methods implementation and experimental tests of csfs the rest of the article is organized as follows section 2 introduces the design and perception measures of csfs section 3 proposes speed control stop control and distance keeping control method for the leading ship and the following ships respectively in section 4 the csfs is implemented with three engineering ships in gezhouba lock waterway in section 5 several tests are done with the real csfs platform in gezhouba lock no 2 and no 3 and the results are analysed to assess the control performance finally section 6 concludes main works and outlooks future plans 2 perception of ship formation the perception of ship formation in the lock waterway has its restrictions which include lower global navigation satellite system gnss signal strength navigation wall and lock door interference close distance between ships etc hence the specific structure and perception measures for the ship formation for passing through the lock are introduced in this section 2 1 structure of ship formation passing through a lock the structure of ship formation refers to the form of the construction and the operation of ship formation it provides individual behaviour and preset trajectory reference for the formation controller as mentioned above the typical ship formation structure includes leader follower structure virtual structure behaviour based structure graph based structure etc the study on the formation control structure is relatively mature and each formation structure has an adaptive scenario the ship formation passing through the lock is relatively stable and the ship can obtain the real time feedback from the other ships meanwhile the process of pass through a lock for ships is relatively complicated which includes low speed navigation in the navigation wall entering the lock gate navigation in the lock chamber stopping at the lock chamber leaving the lock chamber etc to improve the formation safety and efficiency a leader follower structure combined with the behaviour based structure is designed in this article to ensure the safety of navigation the speed of ships passing through the lock is low and the ships should meet the navigation rule requirements an improved leader follower structure is proposed to organize the ship formation through the lock that is the ship formation is composed of one leading ship and several following ships as shown in fig 1 when a ship stops at the stop line in the lock chamber the headline of the ship cannot be allowed to cross the forbidden line the leading ship sets its speed according to the navigation rules of the lock waterway each following ship has its own target ship that could be the leading ship or another following ship which means a following ship may have two roles i e the following ship and the target ship the following ships dynamically adjust their speed according to the relative distance and relative speed to the leading ship the leading ship and the following ships have relevant different behaviours for instance the leading ship has the speed control behaviour stop control behaviour stop finished behaviour and emergency stop behaviour and the following ship has distance keeping behaviour stop finished behaviour and emergency stop behaviour hence the proposed formation structure is the combination of leader follower and behaviour based structure the detail of the formation control will be discussed in section 3 2 2 perception measure of ship formation in lock waterway the ship formation perception system is an important part of csfs the information by the perception system contains ship navigation environment status own ship s and other ships navigation status lock status monitoring orders etc the perception scheme illustrates the perception information flow and the perception measures which is shown in fig 2 1 environmental perception based on millimetre wave radar in consideration of relatively short ranging ability less than 300 m a millimeter wave mmw radar is scarcely utilized for ship environment perception considering that the ship formation in the lock waterway is tight the relative distance between a ship and its around ship is usually less than 100 m an mmw based perception measure is adopted in this article explicitly the environmental perception system consists of an mmw radar ars408 21 is used in this article mounted at the ship bow and three short distance mmw radar car28f is used in this article mounted at the ship stern port side and starboard side an mmw radar operates in the mmw frequency band 30 300 ghz the mmw radar has the advantages of both microwave and photoelectricity and has small size light weight and high spatial resolution yoneda et al 2018 compared with the solid state radar and laser radar the mmw radar has a more substantial penetration of fog smoke dust and others moreover the mmw radar has a unique advantage in the dynamic perception of ship navigation the mmw radar can obtain the precise distance between ships and the relative speed of ships in order to prevent the mmw radar from sweeping to both sides of the lock wall when the ship is in the lock chamber which will affect the ship distance data the effective sweep angle of the mmw radar is set to filter the data to eliminate the influence of the lock wall on the target measurement taking the front mmw radar of the ship passing through the lock as an example the radar scanning angle setting is shown in fig 3 as is shown in fig 3 φ is the effective sweep angle of mmw radar b is the width of the lock chamber c is a shorter distance between the ship and the lock wall d is the shortest allowed distance between adjacent ships in the longitudinal direction θ is the angle between the ship heading and the lock chamber direction to avoid the lock wall affects the distance measurement of d the sweep angle of the mmw radar needs to be set as follows in consideration of the ship heading deflection 1 d c sin φ 2 θ where the value of c can be measured by the port or starboard mmw radar according to the mmw radar ranging value the precise position coordinates of the ship in the lock chamber can be calculated as is shown in fig 4 abdc represents the front ship efhg represents the object ship and ijlk represents the rear ship assuming that the front and rear ship are both a rectangular target with a fixed size in general the distances from abdc to the left and right lock wall are a 1 and a 2 respectively the distances from efhg to abdc the left wall the right wall and ijlk are d 1 d 2 d 3 and d 4 respectively the distances from ijlk to the left and right lock wall are f 1 and f 2 respectively define the included angle of efhg to the forward direction of the lock chamber is ψ the positioning parameters are calculated as follows 2 a 1 b 1 w 2 cos ψ 1 d 1 sin ψ 3 b 1 d 2 cos ψ l 2 x 2 sin ψ b 2 d 3 cos ψ l 2 x 3 sin ψ b 3 b 1 l sin ψ b 4 b 2 l sin ψ 4 c 1 d 1 cos ψ w 2 sin ψ c 2 l cos ψ c 3 w 2 sin ψ d 4 cos ψ where w and l are the ship width and length of efhg to eliminate the interferences of the environmental objects such as water surface lock wall and so on several filtering measures are utilized specifically most of the lock wall and lock door interferences can be eliminated with the appropriate sweep angle setting on the basis of the differences between the ship object and the water surface the interference elimination of the water surface can be realized by setting the value range of the reflectivity and the area of radar cross section rcs 2 ship status perception the gyrocompass is used to obtain the ship s heading and attitude data differential gnss is utilized to obtain the accurate real time position speed and heading data of the ship ultra wide band uwb positioning system is a local positioning system which can keep the positioning ability even if gnss signal is weak or lost the data acquisition terminal is used to obtain the data of ship main engine and propeller speeds and integrate all the ship status data the onboard computer is used for the data processing data analysis algorithm realization and status displaying and saving the ship state perception hardware architecture is shown in fig 5 2 3 ship and shore interaction csfs consists of one shore based system and several ship onboard systems ship and shore interaction mainly realizes ship to shore communication shore based monitoring data storage human machine interaction ship to shore interaction data mainly include ship pose positioning data mmw radar data lock status data lock signal status data monitoring information data etc the information interaction is illustrated in fig 6 3 control methods for passing through the ship lock cooperatively navigation behaviours of a leading ship for passing through a lock correspond to four control modes i e speed control mode stop control mode stop finished mode and emergency stop control mode the control process of the leading ship is shown in fig 7 similarly navigation behaviours of a following ship for passing through a lock correspond to three control modes i e distance keeping control mode stop finished mode and emergency stop control mode the control process of the following ship is shown in fig 8 the mode switch procedure and longitude distance conversion for the leading ship and the following ship are illustrated as fig 9 from fig 9 it can be seen that the actual trajectory in the lock waterway is transferred to the longitude distance from the starting point in the coordination of longitude distance and speed axis the navigation behaviour is described as the behaviour state s x v x where s x is the longitude distance v x is the ship speed for instance the state s p 0 stands for the stop finished behaviour or mode 3 1 speed control method speed control refers to the automatic control of the longitudinal speed of the leading ship in accordance with the navigation rules of the lock waterway this article uses the fuzzy proportion integral differential pid method to realize the speed control of the ship the target speed is defined as v 0 take the telegraph order as the system input u t at time t 5 u t k p e t k i i 0 t e i k d e t e t 1 where k p k i and k d are the pid parameters e t is the control error and represented as e v t v 0 at time t in which v t is the measured speed of the ship and v 0 is the objective speed of the ship considering that the forward and reverse efficiency of ship propellers at the same rotation speed are different pid parameters should be set respectively to prevent manipulating the ship telegraph too frequently a fuzzy speed zone is proposed namely 6 u t 0 if v t v f v f k p e t k i i 0 t e i k d e t e t 1 else where v f 0 is the preset fuzzy speed 3 2 stopping control method accidents such as damage to the bollards of the lock chamber and collision of the lock gate or wall caused by the ship s mishandling often occur hence it is essential to realize automatic and precise stop control in the lock chamber when a leading ship in the formation passing through the lock stops at the designated stop position in the lock chamber the following ship will keep a safety distance from the leading ship and stop accordingly the navigation longitudinal distance for the whole stop procedure is defined as the stop distance denoted as d s stop distance is related to the ship manoeuvrability the ship speed and telegraph input to make the ship stop accurately in the lock chamber an appropriate target stop distance should be set as d 0 a ship stopping at the stop line means that the ship s speed keeps 0 and the ship s telegraph keeps neutral no power output for the propellers actually the process of stopping a ship can be described as the process of controlling the ship s motion state v t u t to 0 0 among the states u 0 is the ahead telegraph order u 0 is the astern telegraph order u 0 is the neutral telegraph order the target speed function f s during the ship stopping in the lock chamber is defined as 7 v 0 t f s d t d t d s 0 where d t is the distance between the ship and the stop line at time t and when the ship crosses the stop line we have d t 0 v 0 t is the ship s target speed d s 0 is the distance to judge the speed control mode or the stop control mode for a leading ship the stop distance interval is set to judge whether the stop procedure is finished or not namely 8 leading ship control mode speed control mode if d t d s 0 stop control mode if d t d s e d s 0 stop finished mode if d t d s e d s e emergency stop mode if d t d s e where d s e is the fuzzy distance of the stop finished mode and d s e d s 0 3 3 distance keeping control method each following ship i has its own target ship that could be another following ship or the leading ship the following ship keeps the relative distance and speed from the target ship according to the target ship s speed and distance the distance between the following ship i and the target ship is set as the control feedback i e the system output which is denoted as d i t at time t the telegraph is set as the control output i e the system input which is denoted as u i t at the time t the target keeping distance is set as the control objective which is denoted as d 0 a fuzzy pid method is used as the distance keeping control method for the following ship i 9 u i t k i p e i t k i i i 0 t e i i k i d e i t e i t 1 considering that the ship propeller forward and reverse efficiency at the same speed are different pid parameters i e k i p k i i and k i d should be set for the ahead and astern telegraph order respectively assuming that the relative velocity of the two ships is v i r t v i r t 0 indicates the relative distance of two ships is shrinking in order to maintain the stability of ship tracking the tracking target distance fuzzy area is set as d i 0 d if d i 0 d i f the fuzzy area u t is considered as 10 u t k i r v i r t if d i t d i 0 d i f d i 0 d i f k i p e t k i i i 0 t e i i k i d e i t e i t 1 else where d i f 0 is the fuzzy distance threshold value and k i r represents the control parameter the distance d i t and relative speed v i r t between the following ship i and the target ship are measured by mmw radars 4 system implementation 1 hardware implementation fig 10 shows the main devices of csfs the lcd screen is used for displaying the real time telegraph input of ships the control mode switch can change the control mode between automatic control mode and manual control mode to ensure ship navigation safety the high precision positioning system provides a precise position for the own ship and other ships mmw radars provide reliable relative distance and relative speed for the ships this system worked well during the test 2 software implementation the onboard software is developed for each ship to pass through the lock whose interface is shown as fig 11 the software mainly realizes the following functions 1 real time analysis filtering and fusion of multi source and heterogeneous data 2 real time display and storage of status data ship attitude and control status 3 configuration of various parameters such as ship type lock direction ship size piloting speed stop position forward reverse parameters etc 4 manual input of control instructions 5 cooperative control of ship formation 3 mmw radar measurement the mmw radar is used for the relative distance and speed measurement between the leading ship and the following ship fig 12 shows the measured results from the hanggong 07 bow mmw radar it can be seen from fig 12 that the measured values vary smoothly without an outlier which stands for the relative distance and speed between hanggong 07 and hanggong 201 5 csfs experimental tests to test the effectiveness of the designed csfs and the proposed formation control methods in the real lock waterway several tests in lock no 2 and no 3 of gezhouba lock china have been conducted the test sites and scenarios are shown in fig 13 chamber of lock no 2 is 280 m long and 34 m wide chamber of lock no 3 is 120 m long and 18 m wide several experimental tests including distance keeping control speed control and lock crossing control of the two ship formation were completed see table 1 for details the main parameters of the scenario and controller are set as table 2 5 1 distance keeping control test during the distance keeping control test haixun 12907 acts as a leading ship manual control and haixun 12911 acts as a following ship automatic control to verify the performance of haixun 12911 s distance keeping in the scenario of the change of relative speed between haixun 12907 and haixun 12911 the designed keeping distance is set at 20 0 m and the haixun 12907 the leading ship is manipulated at around 1 0 m s to denote the telegraph order clearly the telegraph order range is set to 100 100 where 100 and 100 stand for the full astern and the full ahead order respectively the test results are shown in fig 14 according to the experimental data the average tracking distance error is 2 43 m and the average relative speed is 0 33 m s from figs 14c and 14d it can be seen that the propeller rotation speed change is consistent with the telegraph input value the distance keeping control results show that the proposed distance keeping control method can meet the requirements of the ship formation control in the lock waterway 5 2 speed control test in the scenario of speed control test a leading ship i e hanggong 201 is controlled by the csfs the ship initial navigation speed is set as 0 8 m s the test results are shown in fig 15 from the experimental data the average speed control error is 0 08 m s from the speed control test results it can be seen that the ship actual speed approaches to the designed speed within a short time and keeps at the value around the designed speed by the use of the proposed speed control method 5 3 cooperative control test with two ship formations during the cooperative control test of the two ship formation the leading ship hanggong 201 is automatically controlled by csfs during the speed control and stop control mode the following ship hanggong 07 is also automatically controlled by csfs during the distance keeping control mode and stop control mode the data of cooperative control process are shown in fig 16 after entering the stop ship mode the speed slowly drops to 0 at this time the distance between the leading ship and the set stop line is 2 0 m after starting again the leading ship s speed steadily accelerates to 0 8 m s as shown in figs 16a and 16b the following ship hanggong 07 maintains at the speed below 1 5 m s during the upstream crossing of the lock and the longitudinal distance from the leading ship is kept at the set distance of about 30 m as shown in figs 16c and 16d because the leading ship and the following ship are not collinear in the following ship heading direction when mooring the mmw radar measurement output keeps 0 the csfs can realize ship speed control ship distance keeping control and ship stop control from the analysis of the test results 6 conclusion to improve the safety and efficiency when ships pass through the lock waterway a csfs is designed and implemented in gezhouba lock waterway mmw radars are utilized to measure the relative distance and the relative speed between ships cooperative formation control methods are proposed to control ships passing through the lock automatically the main conclusions are as follows 1 the ship formation structure based on the leading following and behaviour is designed the leading ship has speed control mode stop control mode stop finished mode and emergency stop mode the following ship has distance keeping control stop control mode and emergency stop mode 2 a ship status perception method based on mmw radar and ship shore interaction are proposed to achieve the acquisition of the ship s navigation states and formation states in the confined lock waterway environment 3 the cooperative speed control methods of ship formation i e distance keeping control speed control and stop control is proposed csfs and control methods have been tested several times in the waterway of gezhouba lock no 2 and no 3 the average tracking error of the distance keeping control for the following ship is 2 43 m and the average relative speed for the leading ship is 0 33 m s speed control error for the leading ship is 0 08 m s for the stop control the leading ship and the following can complete the accurate stop control in future research the distributed control idea can be considered to realize the cooperative control of multiple ships passing through the lock to improve the formation system s real time performance and robustness the cooperative formation control method can also be applied to multi stage lock formation scheduling and control to solve the optimal control among multiple formations and improve the navigation efficiency of ships in the whole lock waterway credit authorship contribution statement chenguang liu conceptualization methodology software validation editing junlin qi investigation conceptualization resources xiumin chu supervision funding acquisition validation mao zheng software validation writing reviewing wei he supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this article is supported by national key research and development program of china 2018yfb1600404 national natural science foundation of china 52001240 natural science foundation of hubei province china 2020cfb307 fundamental research funds for the central universities china 203144003 202444001 industry university cooperation project of fujian provincial department of science and technology china 2019h6018 
