index,text
20550,in this study the dynamic performance of a long curved river crossing pipeline with multiple floating bodies during immersion process is investigated in detail based on the pipeline theory six degree of freedom buoy theory winch theory and multi body coupling theory a numerical model of the immersion system with multiple floating bodies is established the numerical calculation method is observed to conform well with the field measurement results the dynamic performance of the immersion system is comprehensively investigated based on varying key parameters e g the deflation time of the airbags lowering speed of the suspension cables and airbag deflation methods the results from the numerical simulations indicate that the immersion process for the pipeline with the proposed construction method is safe stable and controllable the presented numerical calculations and results can provide valuable construction recommendations to avoid potential engineering risks and ensure the economic efficiency of this or future similar projects keywords long curved river crossing pipeline multiple floating bodies pipeline theory immersion system dynamic performance 1 introduction immersed tube construction methods ding et al 2006 zuo et al 2015 wang et al 2018 are used to immerse underwater structures such as immersed tube tunnels submarine pipelines and pipelines from the water surface to an underwater foundation trench the construction process of the immersed tubes is generally a challenging work and involves applying several key engineering technologies ingerslev et al 2005 neto 2016 wu et al 2016 song et al 2018 used in the immersed underwater structure such as floating transportation immersion and underwater localization of these the immersion process is one of the most critical procedures for the underwater structures this process significantly affects the safety and stability of the immersion construction the accuracy of underwater localization and the economic efficiency of the construction through theoretical analyses and numerical simulations researchers have explored the dynamic behavior of underwater structures during the immersion process chen et al 2009 utilized linear wave diffraction theory and the three dimensional source distribution method to establish a numerical model of the hong kong zhuhai macau immersion tunnel element during its immersion process wang et al 2014 utilized the basic principle of vibration mechanisms to establish a mechanical model of a riser during its immersion installation process in addition wang et al 2017 used the finite element method and orcaflex software to establish a numerical model of the immersion operation for a massive subsea structure furthermore wang et al 2018 utilized small deformation theory and the finite element method combined with orcaflex software to establish a numerical model for the immersion process of a subsea cluster manifold additionally experimental explorations of the dynamic behaviors of underwater structures during immersion process have been conducted as follows zhan et al 2001 conducted an experimental investigation of the hydrodynamics and stability of an immersed tube tunnel during its immersion process xiao et al 2010 performed mooring towing and immersion tests on immersed tunnel caissons across the yong river in the basin to investigate the motion characteristics and line tensions lu et al 2014 performed scale model tests to investigate the motion responses of the immersion tunnel element and the cable tension under the combined loads of the waves current and wind based on the similarity theory huang et al 2015 conducted an experimental study with scaled model tests to investigate the motion responses of an immersion tunnel element linked to floating pontoons under the effect of random waves song et al 2015 conducted scaled model tests to investigate the motion responses of an immersion tunnel element due to random waves during the immersion process permutations and combination studies have also been conducted through theoretical analyses numerical simulations model tests and field measurements cozijn et al 2009 conducted both model tests and numerical simulations to investigate the motion behavior of a tunnel pontoon system along with the cable tension of the mooring lines and hoist ropes at different stages of immersion process yang et al 2017 2018 performed numerical simulations and model tests to investigate the motion and coupled motion characteristics of a tunnel element suspended from a twin barge with and without random wave during the immersion process from the aforementioned studies it can be found that the dynamic performance of underwater structures in the immersion process has been explored thoroughly and the theories reported by these studies can significantly promote the engineering applications for the immersion construction of underwater structures however most previous studies focused on the immersion process of line type underwater engineering structures with regular shapes while quantitative investigations considering the influence of multiple floating bodies during the immersion process of the underwater structures are yet to be reported some special circumstances may occur in actual projects such as limitations of the topography of the underwater foundation trench on the riverbed or specific navigation and construction needs as a result it may be necessary to design a river crossing pipeline with an irregular curved crank shape however the force mechanism of a pipeline with an irregular curved crank shape will differ from that of a line type pipeline with a regular shape the irregular curved crank shape of the pipeline can easily cause differential loading distribution and local stress concentration in the pipeline and non uniform tension distribution between the cables during the immersion process further it is noteworthy that pipelines are usually equipped with a specific immersion system consisting of multiple floating bodies such as barges airbags and steel buoys to ensure the security of immersion construction similar immersion projects and corresponding studies have not been reported in the past these specific immersion systems with multiple floating bodies produce complex force mechanisms induced by the dynamic coupling between the floating structures and mooring cables the interconnected floating structures and the structure and fluid in other words safety control of a pipeline system with multiple floating bodies during the immersion process is important and challenging for scholars and engineers if the immersion process cannot be properly controlled engineering accidents may occur such as breakage of the suspension cables overturning of barges torsion failure of the pipeline rollover of the pipeline and unsuccessful underwater localization and installation of the pipeline in this study an immersion project for a pipeline with multiple floating bodies located in nanning china is considered the immersion process of the pipeline performed in this study involves the challenges of a large scale pipeline irregular curved crank shape multi body coupled system and complex construction process by employing pipeline theory winch theory and multi body coupling theory a numerical model of the immersion system with multiple floating bodies during the immersion process is established a comparison between numerical simulations and field measurement results is then presented to assess the efficacy of the proposed numerical model the dynamic performance of the immersion system during the immersion process is comprehensively investigated under varying key parameters the numerical calculations and results presented in this paper can provide valuable construction recommendations to avoid potential engineering risks and ensure the economic efficiency of similar projects in the future 2 overview of the project the river crossing pipeline considered in this study is designed to cross the yongjiang river in nanning china and is buried in an underwater foundation trench the river crossing pipeline is designed with an irregular curved crank shape because of riverbed conditions and navigation and construction needs as shown in fig 1 a the total length of the pipeline is 438 m comprising four welded prefabricated steel pipe segments with an external diameter of 2620 mm the total weight of the river crossing pipeline after water injection is more than 3020 t the external diameter and span of the pipeline are the largest and longest respectively in south china in recent years a specialized immersion system was designed for the immersion construction of this pipeline as shown in fig 1 b the immersion system comprises a pipeline 16 steel buoys 9 airbags 8 barges and 2 crawler cranes the airbags and steel buoys are connected to the pipeline by rubber straps and mooring ropes respectively while the barges and crawler cranes are connected to the pipeline body by crane arms and suspension cables respectively the pipeline and steel buoys are made of q235 steel the major parameters of the river crossing pipeline steel buoys and airbags are listed in table 1 airbag deflation is adopted as a construction technology to immerse the pipeline fig 1 c demonstrates the detailed immersion process for the pipeline the immersion process can be described as follows i before immersion of the pipeline the pipeline body floats on the river surface due to the support of the buoyancy of the steel buoys and airbags ii water injection and pressurization of the pipeline are implemented after which the pipeline body sinks to a certain depth and is suspended in the water iii the airbag valves are opened to release air resulting in deflation and disengagement of the airbags simultaneously the suspension cables are lowered and the entire loading of the pipeline body is transferred from the steel buoys and airbags to the steel buoys barges and crawler cranes iv after the completion of the airbag deflation process the attitude of the pipeline is adjusted by the barges and crawler cranes finally the pipeline is rotated 90 and immersed in the underwater foundation trench of the riverbed the construction site for the multi floating immersion system is shown in fig 2 a details of the connections between the pipeline and the steel buoys and airbags at the construction site can be seen in fig 2 b as stated above the immersion process for the pipeline involves problems related to the large scale pipeline irregular curved crank shape complex multi body coupled system and complex construction processes the dynamic behavior of the immersion system during the immersion process is very complicated and needs to be investigated thoroughly to avoid potential engineering risks and ensure economic efficiency 3 numerical model and basic theory 3 1 establishment of the numerical model in fig 3 a the coordinate systems of the numerical model are presented including the body fixed coordinate system s x y z and the global reference coordinate system g x y z the numerical model of the multi floating immersion system is established within the framework of the orcaflex program the aerial view diagram of the model is shown in fig 3 b the basic aerodynamic and hydrodynamic parameters of the project are listed in table 2 in the numerical model the pipeline and mooring ropes are simulated using line units based on the centralized mass method the airbags and steel buoys are simulated with six degree of freedom 6d buoy units the barges and crawler cranes are simulated using vessel and shape units respectively the crane arms and suspension cables on the barges and crawler cranes that are connected to the pipeline body are simulated using shape and winch units respectively the boundary conditions of the two ends of the immersion system are simulated using link units the following specific measures are introduced in the numerical simulation i four anchor cables connected at each end of the pipeline are anchored to fixed points to simulate the boundary conditions of the immersion system as shown in fig 3 c the two anchor cables simulated as link units are arranged in the x and y directions of the global coordinate system their typical tensile stiffness and length are 5 10 4 kn and 50 m respectively ii in the actual project each steel buoy and airbag is connected to the pipeline by several sets of mooring ropes for simplicity only one line unit is utilized to simulate the ropes connecting the steel buoys and airbags to the pipeline in the numerical simulation to simulate the actual engineering situation in which the steel buoy and airbag can rotate around the pipeline the connection bending stiffness and twisting stiffness of the line units are set as infinity in the numerical simulation iii because the sluice gate upstream in the river is closed during the actual immersion process the current velocity is minimal in addition waves in the river are negligible and the crawler cranes are fixed on land on the two sides of the river consequently the barges and crawler cranes are set as immobile structures in the numerical simulation iv in the numerical simulation the masses of the airbags are considered negligible and the airbags only provide a buoyancy for the pipeline and the airbag deflation process is simulated by applying a linear digressive force at the connection between the airbag and the pipeline and the initial force value is determined from the initial static equilibrium position of the immersion system and the immersion volume of the airbags the airbags are disengaged from the pipeline after completion of the airbag deflation using the element birth and death technique a diagram of the numerical simulation of the immersion system after the airbag deflation is illustrated in fig 3 d 3 2 pipeline theory in the pipeline immersion process the dynamic behavior of the pipeline exhibits various nonlinear features such as geometric configurations with irregular curved crank shapes dynamic coupling effects between the floating structures and mooring systems fluid structure coupling effects stochastic wind loads and boundary conditions thus establishing an effective and reasonable numerical simulation model for a pipeline with multiple floating bodies is important to investigate the dynamic responses of the pipeline during the immersion process using the concentrated mass method the pipeline is divided into a series of line segments as shown in fig 4 these are modeled using straight massless model segments with a node at each end and properties such as the mass weight buoyancy and drag force are concentrated at the nodes the model includes various springs and dampers to represent the structural properties of the pipeline the axial and torsional properties of the pipeline are simulated by the axial and torsional springs respectively and their dampers at the center of the line segment the bending properties of the pipeline are simulated using rotational springs and their dampers at both ends of the node orcina 2020 gong et al 2014 2016 amaechi et al 2019 in this study the numerical simulation program calculates the forces and moments on a mid node in five stages tension forces bending moments shear forces torsion moments and total load the details of the calculations can be found in refs orcina 2014 gong et al 2014 2016 amaechi et al 2019 3 3 6d buoy theory the airbags and steel buoys are simulated with 6d buoy units the buoy is treated as a rigid body with six degrees of freedom including three translational and three rotational degrees of freedom the equation of motion for the buoy includes contributions from the weight buoyancy and hydrodynamic loads comprising linear hydrodynamic damping and moments the hydrodynamic load on a cylinder is applied at the centroid of the dampened volume of the cylinder and is scaled based on the proportion of the cylinder that is damp 3 4 winch and shape theory the dynamic behavior of the suspension cables is simulated by setting the specified pay out value of the winch units at each time step based on the tensile rigidity of the winch units the tension of the suspension cables f s can be obtained as follows 1 f s l l 0 c d l d t d l 0 d t k l 0 where l is the total length of the winch suspension cable path l 0 is the unstretched length of the suspension cable paid out and k and c are the suspension cable stiffness and damping values respectively the crane arms in the barges and crawler cranes are simulated by shape units in the program of orcaflex shape units are geometric shapes and three types are available i e elastic solids shapes trapped shapes and drawing shapes they may be fixed or attached to other objects such as vessels or buoys drawing shapes are adopted in this numerical simulation and it can be used purely for visualization and have no influence on or interaction with the rest of the model 3 5 link theory link units are simple springs or spring damper connections linking two points in the model they pull the two points together or hold them apart with a force that depends on their relative positions and velocities link units have no mass or hydrodynamic loading and simply apply an equal and opposite force to the two points 3 6 aerodynamic and hydrodynamic load theory the fluctuating component of the wind velocity can be simulated using the wind spectrum and a coherence function to maintain the spatial statistical properties the npd wind spectrum used to generate the stochastic wind in this study is represented as follows shae et al 2018 2 s n p d f 320 u 0 10 2 z 10 0 45 1 f 0 468 3 561 where u 0 is the wind velocity at a height of 10 m z is the height above the river surface and f is the wind frequency the fluid current or air drag forces applied to the pipeline are calculated using the cross flow principle the formulations for the drag force components f x f y and f z in the local line directions can be expressed as follows 3 f x 1 2 p w ρ d n l l γ d x v x v n 4 f y 1 2 p w ρ d n l l γ d y v y v n 5 f z 1 2 p w ρ d a l l γ d z v z v n where f x f y and f z are the drag forces in the x y and z directions respectively γ d x γ d y and γ d z are the drag coefficients in the x y and z directions respectively v x v y v z and v n are the fluid velocity components in the x y z and normal directions respectively d n and d a are the normal drag lift diameter and axial drag lift diameter respectively l l is the length of the pipeline represented by the node ρ is the fluid density current or air and p w is the proportion of wetness or dryness of the pipe as appropriate 3 7 equations of motion for the immersion system to explore the dynamic behavior during immersion of the pipeline system with multiple floating bodies under internal and external loads it is necessary to consider the mass weight buoyancy stochastic wind and current loads on the pipeline steel buoys and airbags the equation of motion for the immersion system under such loads is calculated as follows 6 m p a c p v k p f p v t where m p a is the system inertia load c p v is the system damping load k p is the system stiffness load f p v t is the external load p v and a are the position velocity and acceleration vectors respectively and t is the simulation time the equation for the immersion system is solved using the implicit integration scheme in the time domain dynamic analysis the system geometry is re computed at every time step allowing the simulation to entirely consider the geometric nonlinearities the hydrodynamic response of the structure is affected by several factors such as the system damping system stiffness and external loads the fully coupled approach is employed in this study where the system equation of motion is solved simultaneously and full interactions among the suspension cables mooring ropes river crossing pipeline and floaters steel buoys and airbags are considered the fully coupled approach has the advantage of generating model files at each coupling iteration which can be more accurate particularly for complex models in addition the nonlinear effect of a geometric configuration with an irregular curved crank shape dynamic coupling between the floating structures and the mooring system fluid structure coupling effects stochastic external force excitations and boundary conditions can be included although it is time consuming gong et al 2014 4 comparison between the numerical simulation and field measurement results to assess the efficacy of the numerical model in this study field measurement results are utilized for comparison in typical construction cases the vertical displacements of the point hoists and the tensions of the suspension cables were measured at the construction site as shown in fig 5 fig 6 demonstrates that the final vertical displacement obtained in the numerical simulation conforms well with the field measurement data for each point hoist and the relative error between these two methods is between 0 60 and 3 33 in addition the curves calculated using the numerical simulation and those obtained from the field measurement data exhibit similar trends the maximum and minimum vertical displacements occur at hoist points 3 and 5 respectively fig 7 shows that the numerical simulation results comply with the field measurement data for both the maximum dynamic tensions of various suspension cables the differences are less than 30 moreover the overall trends of the curves obtained from the numerical simulations and measured results are similar in the two curves the largest and smallest maximum dynamic tensions occur in suspension cables 5 and 8 respectively however the numerical predictions are approximately larger than the field measurements especially at the middle position and tail end of the pipeline as shown in fig 8 a and b the final shape and posture of the immersion system are approximately equal in both the numerical simulation and actual construction in particular steel buoys 15 and 16 at the tail end of the pipeline are not completely submerged in the water and the immersion depths are approximately the same in the numerical simulation and actual construction during the final immersion stage in contrast the other steel buoys are completely submerged in the water this phenomenon corresponds with the heave motion statistics listed in table 3 which indicate that the minimum heave occurs at steel buoys 1 8 15 and 16 this implies that the tail end of the pipeline inclines upward in the final immersion stage and the steel buoys 15 and 16 at the tail end of the pipeline are not completely submerged in the water these differences between the numerical and measured results in figs 6 7 may be contributed by the reasons such as the simplifications and specific disposal measures for the connection between the steel buoys and airbags with the pipeline in numerical simulation the coordination and synchronism of lowing arrangements of suspension cables and deflation of all the airbags in the numerical simulation are very hard to realize in actual engineering and the measurement error of sensors in practical engineering overall the proposed numerical model and its results are acceptable and reasonable thus it is concluded that the proposed numerical calculations are capable of providing a sufficiently accurate analysis of the dynamic performance of a pipeline system with multiple floating bodies during the immersion process 5 numerical results and discussion 5 1 time domain analysis for a typical calculation case in the typical calculation case the lowering speed of the suspension cables and the deflation time of the airbags are defined as v l 0 017 m s and t d 90 s respectively the lowering time of the suspension cables and the deflation time of the airbags are in the range of 10 100 s and 0 90 s respectively the pre tension of suspension cables is defined as f sp 5 kn the internal pressure of the pipeline is p i 1100 kpa and the tensions of the suspension cable and mooring rope are defined as f s and f m respectively 5 1 1 time domain analysis of the suspension cables on the barges and crawler cranes the results in fig 9 a c indicate that the tension of almost all the suspension cables increase to 40 kn during 0 10 s and then decrease to 0 kn during 10 20 s subsequently the tensions increase again at 70 s and tend to be stable after 100 s it can be observed in fig 9 d that the maximum dynamic tensions for different suspension cables are distinctly different the tension values are larger in the middle position and smaller at the two ends of the pipeline the largest and smallest maximum dynamic tensions occur in suspension cables 5 and 9 respectively and the maximum dynamic tension in suspension cable 5 is approximately 180 kn notably almost all the suspension cable dynamic tension values are zero between 20 and 70 s in fig 9 a c this result may occur because the increased buoyancy due to the immersion of the steel buoys and their increased displacement are greater than the decrease in the buoyancy due to the deflation of the airbags as shown in fig 9 a c once the taut slack phenomenon occurs from 70 to 100 s high frequency components will arise at the tension of the suspension cables impact tension will appear and the dynamic tensions will be distinctly amplified lu et al 2011 this is dangerous for the safety and stability of the immersion system and special attention should be paid to this phenomenon 5 1 2 time domain analysis of the mooring ropes fig 10 a shows the pre tensions of mooring ropes 1 16 because of the influence of the initial equilibrium position of the immersion system the larger pre tension values of the mooring ropes exhibit at the middle of the pipeline and smaller values at the two ends of the pipeline this may imply that the middle of the pipeline is more submerged in the water thereby more steel buoys should be provided in the middle of the immersion system in water to provide more buoyancy the results in fig 10 b c indicate that the dynamic tensions of mooring ropes 1 15 increase slowly from 0 to 10 s increase sharply to approximately 380 kn from 10 to 90 s and fluctuate around 380 kn thereafter moreover the rate of increase in the dynamic tension of the mooring ropes changed dramatically at 10 s because the suspension cables do not start to lower until 10 s in particular it is worth noting that the steel buoys begin to completely submerge from 62 s except for mooring rope 16 moreover the dynamic tension of mooring rope 16 is only approximately 320 kn from 100 to 140 s this may be induced by the final posture of the pipeline which caused steel buoy 16 to be un fully submerged at the end of the process in the later stage of the immersion process the loadings of the immersion system are primarily borne by the steel buoys and suspension cables if the steel buoys are not completely submerged the tension of the suspension cables will increase and may even exceed the capacity of the barge therefore the phenomenon in which the steel buoys are not completely submerged in the later stage of the immersion process should be given sufficient attention 5 1 3 dynamic responses of the pipeline in fig 11 the amplitudes of the pipeline motion corresponding to the degrees of freedom are minimal except in the heave direction in fig 11 c the heave motion of the pipeline represents the pipeline immersion process in the vertical direction after completion of the airbag deflation the mid span of the pipeline moves approximately 1 5 m in the vertical direction the airbags deflate over 0 90 s after the completion of the airbag deflation the amplitudes of the pipeline motion in each degree of freedom increase significantly moreover the vibrational frequencies of the motion trajectories increase and the motion finally converges to a certain value these results may be caused by the occurrence of the taut slack phenomenon in the suspension cables near the end of the airbag deflation process in this case the process of transferring the burden loads from the airbags to the steel buoys and the suspension cables will be nonuniform overall these results illustrate that the immersion process of the pipeline with the proposed construction method is safe stable and controllable 5 1 4 dynamic responses of the steel buoys the dynamic response statistics for typical steel buoys 1 8 15 and 16 are presented in table 3 similar to the dynamic responses of the pipeline it can be observed that the amplitude of the motion of the steel buoys corresponding to the degrees of freedom is minimal except in the heave direction in table 3 the negative minimum values of the heave for each steel buoy can approximately represent the immersion depth of the steel buoy as shown in fig 11 c particularly for steel buoy 8 located near the mid span of the pipeline which approximately approaches the immersion depth of the pipeline these results imply that the steel buoys are tightly connected to the pipeline during the immersion process in addition the response statistics of the steel buoys in the heave direction suggest that steel buoys 15 and 16 at the tail end of the pipeline are not completely submerged in the water similar in fig 8 the buoyancy of the steel buoys increases with the submerged depth if the steel buoys are not completely submerged in the water a greater burden load will be transferred to the suspension cables during the immersion process 5 1 5 stress distribution along the length of the pipeline fig 12 a c show the maximum minimum and mean von mises stress bending stress and tensile stress of the pipeline along its length respectively the sum of the amplitudes of the bending moment stress and tensile stress is approximately equal to the amplitude of the von mises stress the stress in the pipeline primarily originates from the bending stress based on these figures the stress amplitude in the pipeline is within the range of safety it is noted that the stresses under various loads are not symmetric about the mid span point of the pipeline this can be attributed to the effect of the irregular structural shape of the pipeline and the non uniform distribution of the external loading excitations due to the multiple floating bodies in addition the maximum von mises stresses occur at a location of approximately 300 310 m on the pipeline which is majorly the result of stress concentration in the maximum bending position of the pipeline 5 2 sensitivity analysis of the key parameters 5 2 1 effect of the airbag deflation time in fig 13 a distinct differences for different deflation times can be observed the curves for deflation times of 50 s and 70 s almost coincide and the dynamic tension exhibits two peaks at suspension cables 3 and 6 for a deflation time of 30 s the dynamic tension reaches peaks at suspension cables 3 and 7 however only one peak at suspension cable 5 can be observed for a deflation time of 90 s moreover the dynamic tension amplitudes for deflation times of 30 s and 90 s are clearly larger than those for deflation times of 50 s and 70 s thus it can be concluded that varying the deflation time has a distinct effect on the maximum dynamic tension amplitude and distribution for different suspension cables the coefficient of variation cv is introduced to evaluate the uniformity of the dynamic tension in the suspension cables under various calculation conditions here cv σ m where σ is the standard deviation and m is the mean value in fig 13 a the cv values for the dynamic tensions of the suspension cables are corresponding to the deflation times of 90 s 70 s 50 s and 30 s are 0 60 0 53 0 41 and 0 64 respectively this indicates that the uniformity of the dynamic tension of the suspension cables is optimum for a deflation time of 30 s fig 13 b shows the comparison of the tension and stresses under various airbag deflation times for the four deflation times there is little difference in the maximum and mean dynamic tensions at different suspension cables in addition the minimum dynamic tension value still occurs at mooring rope 16 which implies that the tail end of the pipeline moves downward in the heave direction with the increase in the deflation time from 30 s to 90 s for all the mooring ropes the maximum dynamic tensions increase whereas the mean dynamic tensions decease these results are primarily induced by the downward amplitude of the tail end of the pipeline in the heave direction with increasing deflation time it can be observed in fig 13 c that for the four deflation times the stress curves form a rightward gibbous arch and the von mises stress reaches the maximum value at a location of approximately 300 310 m i e near the junction of pipelines 2 and 3 with varying deflation times the location of the maximum von mises stress remains approximately constant when the deflation time increases the amplitude of the maximum von mises stress increases slightly and the stress curve becomes rougher particularly in the left half of the pipeline which indicates that the high frequency dynamic tension is excited at longer deflation times this result occurs because the taut slack phenomenon of the suspension cables is more significant when the deflation time increases to 90 s i e the point at which the airbags disengage from the pipeline after the airbag deflation is complete 5 2 2 effect of the lowering speed of the suspension cables when the lowering speed increases the maximum value of the tension initially increases and then remains constant for almost all the suspension cables as shown in fig 14 a for v 0 031 m s and v 0 051 m s in addition the maximum dynamic tension distributions in suspension cables are influenced by the lowering speed of the suspension cables the maximum dynamic tension of the suspension cables appears in suspension cable 1 under suspension cable lowering speeds of v 0 022 m s v 0 031 m s and v 0 051 m s the maximum dynamic tension occurs in suspension cable 5 of v 0 017 m s it is worth noting that the maximum tension for suspension cables 3 6 exceeds the bearing capacity of the 20 t barges under suspension cable lowering speeds of v 0 022 m s v 0 031 m s and v 0 051 m s which is very dangerous for the immersion process and requires special attention this likely occurs because the lowering speed is a major factor affecting the taut slack phenomenon in the suspension cables moreover from the perspective of uniform maximum dynamic tension of the suspension cables a lowering speed of v 0 017 m s is most suitable in fig 14 b the maximum dynamic tension of almost all the mooring ropes increases linearly with increasing lowering speed in addition the mean dynamic tension of the mooring rope is slightly affected by the lowering speed as shown in fig 14 c the von mises stress reaches its maximum value at the location of approximately 300 310 m under various lowering speeds furthermore with increasing lowering speed the amplitude of the maximum von mises stress in the left half of the pipeline increases sharply and several peak values of the stress are observed in the left half of the pipeline this is probably induced by the maximum dynamic tension distribution 5 2 3 effect of airbag deflation methods three airbag deflation methods are selected to assess the effect on the dynamic performance of the pipeline during the immersion processes in deflation method 1 the nine airbags attached to the pipeline are deflated simultaneously in deflation method 2 the four airbags at the two ends of the pipeline are deflated first followed by the five airbags in the middle location in deflation method 3 the five airbags in the middle location are deflated first followed by the four airbags at the two ends of the pipeline in fig 15 a the maximum dynamic tension reaches a peak in suspension cables 3 7 under the three deflation methods the maximum dynamic tension is greatest in almost all the suspension cables under deflation method 2 in addition from the perspective of the uniformity of the maximum dynamic tension of the suspension cables deflation method 1 is most reasonable it can be observed in fig 15 b that the airbag deflation method has a negligible effect on the maximum dynamic tension but has a significant effect on the mean dynamic tension of the mooring ropes the mean dynamic tensions for different mooring ropes are clearly different under various deflation methods particularly for mooring ropes 6 12 located in the middle of the pipeline this indicates that deflation method can affect the mean dynamic tension distribution of the mooring ropes along the length of the pipeline it should be noted that the mean dynamic tensions of mooring ropes 3 13 in the middle of the pipeline increase with the deflation method in the order of 2 3 1 but exhibit an opposite trend for the mooring ropes at the two ends of the pipeline as shown in fig 15 c the overall tendencies of the curves under the three deflation methods are approximately similar moreover compared with the results of deflation methods 2 and 3 the location of the maximum von mises stress is shifted by approximately 30 m to the right part of the pipeline under deflation method 1 and the maximum von mises stress increases by approximately 8 mpa the aforementioned results indicate that the stress distribution and energy intensive region of the pipeline can be considerably affected by the airbag deflation method 5 2 4 effect of pre tension of the suspension cables in fig 16 a with increasing pre tension the tension of suspension cables 1 5 decreases approximately linearly the tension of suspension cables 6 7 is nearly unaffected and tension of suspension cables 8 10 increases approximately linearly the peak values of the maximum dynamic tension of the suspension cables still occur in suspension cables 4 6 for different pre tension cases in addition the larger the pre tension the better the uniformity of the suspension cables tends to be as shown in fig 16 b c the pre tension has little effect on the maximum and mean dynamic tensions of the mooring ropes or the maximum von mises stress distribution along the pipeline 5 2 5 effect of the boundary conditions at the two ends of the pipeline three typical boundary conditions are considered in this study at each end of the pipeline boundary conditions 1 2 and 3 are digressive and two one or none of the long anchor cables are arranged in the x direction of the global coordinate system while the other long anchor cables are arranged in the y direction i e the constraint effect decreases in boundary conditions 1 3 in fig 17 a the boundary conditions have a negligible effect on the maximum tension for approximately all the suspension cables the tension uniformity of the suspension cables under boundary condition 1 is better than that under boundary conditions 2 or 3 as shown in fig 17 b with different boundary conditions the maximum and mean dynamic tensions of the mooring ropes change in a small range of no more than 5 and only minimal differences occur at the tail end of the pipeline it can be observed in fig 17 c that the stress distribution along the pipeline is significantly affected by changes in the boundary conditions in particular compared with the results under boundary condition 1 the location of the maximum value of the von mises stress is shifted toward the mid span of the pipeline under boundary condition 3 while the location remains unchanged under boundary condition 2 furthermore with the reduction of the constraint effect from boundary conditions 1 to 3 the maximum von mises stress gradually decreases these results may occur because the stress concentration phenomenon gradually weakens with the reduction of the constraint effect from boundary conditions 1 to 3 while the stress distribution from classical pipeline theory becomes dominant i e the maximum stress value occurs approximately in the mid span of the pipeline 6 conclusions and suggestions for the project based on the systematic study on the dynamic performance of a long curved river crossing pipeline with multiple floating bodies during immersion process the following conclusions and suggestions can be made 1 a comparison between numerical simulation and field measurement results is presented with appropriate comparison thus it is concluded that the presented numerical results are acceptable and reasonable 2 the largest maximum dynamic tensions occur in suspension cables 4 6 thus it is recommended that the two 50 t barges with greater bearing capacities be removed from the two ends to the mid span location of the pipeline to avoid the taut slack phenomenon it is suggested that the dynamic tensions of all the suspension cables should be measured in real time to make timely and flexible adjustments in the construction process 3 based on analysis of the dynamic performance of the immersion system the immersion process for the pipeline with the proposed construction method is safe stable and controllable in the final immersion stage the tail end of the pipeline inclines upward and the two steel buoys at the tail end of the pipeline are not completely submerged in the water therefore lowering the height of each suspension cable is recommended for reasonable control according to the actual engineering situation 4 the maximum stress value occurs at a location of approximately 300 310 m along the pipeline which can be resulted from stress concentration at the maximum bending position of the pipeline this location is shifted toward the mid span of the pipeline by reducing the constraint effect of the boundary conditions it is suggested that more barges steel buoys and airbags be added in these regions and reasonable boundary conditions are recommended for the project 5 the sensitivity analysis of key parameters e g the airbag deflation time lowering speed of the suspension cables and airbag deflation methods is conducted via numerical simulations thereby providing valuable construction recommendations to avoid potential engineering risks and ensuring the economic efficiency of the project 6 the proposed construction method modeling theory and analytical method used in the present study for a long curved river crossing pipeline system with multiple floating bodies during immersion process can provide valuable references for the similar projects in the future credit authorship contribution statement zhiwen wu conceptualization resources visualization supervision project administration funding acquisition yangyang xiao software validation field measurement investigation data curation visualization huihuan ma conceptualization methodology formal analysis writing review editing visualization funding acquisition pengpeng ni conceptualization methodology resources supervision pingjun lin software validation formal analysis investigation data curation visualization hao wang formal analysis software field measurement investigation shuai yang software resources formal analysis methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study had been supported by the national natural science foundation of china grants no 51808136 the guangxi natural science foundation grant no 2018jjb160058 the guangxi science and technology base and talent special funds grant no 2019ac20264 and guangxi key laboratory of disaster prevention and mitigation and engineering safety china grant no 2020zdk002 
20550,in this study the dynamic performance of a long curved river crossing pipeline with multiple floating bodies during immersion process is investigated in detail based on the pipeline theory six degree of freedom buoy theory winch theory and multi body coupling theory a numerical model of the immersion system with multiple floating bodies is established the numerical calculation method is observed to conform well with the field measurement results the dynamic performance of the immersion system is comprehensively investigated based on varying key parameters e g the deflation time of the airbags lowering speed of the suspension cables and airbag deflation methods the results from the numerical simulations indicate that the immersion process for the pipeline with the proposed construction method is safe stable and controllable the presented numerical calculations and results can provide valuable construction recommendations to avoid potential engineering risks and ensure the economic efficiency of this or future similar projects keywords long curved river crossing pipeline multiple floating bodies pipeline theory immersion system dynamic performance 1 introduction immersed tube construction methods ding et al 2006 zuo et al 2015 wang et al 2018 are used to immerse underwater structures such as immersed tube tunnels submarine pipelines and pipelines from the water surface to an underwater foundation trench the construction process of the immersed tubes is generally a challenging work and involves applying several key engineering technologies ingerslev et al 2005 neto 2016 wu et al 2016 song et al 2018 used in the immersed underwater structure such as floating transportation immersion and underwater localization of these the immersion process is one of the most critical procedures for the underwater structures this process significantly affects the safety and stability of the immersion construction the accuracy of underwater localization and the economic efficiency of the construction through theoretical analyses and numerical simulations researchers have explored the dynamic behavior of underwater structures during the immersion process chen et al 2009 utilized linear wave diffraction theory and the three dimensional source distribution method to establish a numerical model of the hong kong zhuhai macau immersion tunnel element during its immersion process wang et al 2014 utilized the basic principle of vibration mechanisms to establish a mechanical model of a riser during its immersion installation process in addition wang et al 2017 used the finite element method and orcaflex software to establish a numerical model of the immersion operation for a massive subsea structure furthermore wang et al 2018 utilized small deformation theory and the finite element method combined with orcaflex software to establish a numerical model for the immersion process of a subsea cluster manifold additionally experimental explorations of the dynamic behaviors of underwater structures during immersion process have been conducted as follows zhan et al 2001 conducted an experimental investigation of the hydrodynamics and stability of an immersed tube tunnel during its immersion process xiao et al 2010 performed mooring towing and immersion tests on immersed tunnel caissons across the yong river in the basin to investigate the motion characteristics and line tensions lu et al 2014 performed scale model tests to investigate the motion responses of the immersion tunnel element and the cable tension under the combined loads of the waves current and wind based on the similarity theory huang et al 2015 conducted an experimental study with scaled model tests to investigate the motion responses of an immersion tunnel element linked to floating pontoons under the effect of random waves song et al 2015 conducted scaled model tests to investigate the motion responses of an immersion tunnel element due to random waves during the immersion process permutations and combination studies have also been conducted through theoretical analyses numerical simulations model tests and field measurements cozijn et al 2009 conducted both model tests and numerical simulations to investigate the motion behavior of a tunnel pontoon system along with the cable tension of the mooring lines and hoist ropes at different stages of immersion process yang et al 2017 2018 performed numerical simulations and model tests to investigate the motion and coupled motion characteristics of a tunnel element suspended from a twin barge with and without random wave during the immersion process from the aforementioned studies it can be found that the dynamic performance of underwater structures in the immersion process has been explored thoroughly and the theories reported by these studies can significantly promote the engineering applications for the immersion construction of underwater structures however most previous studies focused on the immersion process of line type underwater engineering structures with regular shapes while quantitative investigations considering the influence of multiple floating bodies during the immersion process of the underwater structures are yet to be reported some special circumstances may occur in actual projects such as limitations of the topography of the underwater foundation trench on the riverbed or specific navigation and construction needs as a result it may be necessary to design a river crossing pipeline with an irregular curved crank shape however the force mechanism of a pipeline with an irregular curved crank shape will differ from that of a line type pipeline with a regular shape the irregular curved crank shape of the pipeline can easily cause differential loading distribution and local stress concentration in the pipeline and non uniform tension distribution between the cables during the immersion process further it is noteworthy that pipelines are usually equipped with a specific immersion system consisting of multiple floating bodies such as barges airbags and steel buoys to ensure the security of immersion construction similar immersion projects and corresponding studies have not been reported in the past these specific immersion systems with multiple floating bodies produce complex force mechanisms induced by the dynamic coupling between the floating structures and mooring cables the interconnected floating structures and the structure and fluid in other words safety control of a pipeline system with multiple floating bodies during the immersion process is important and challenging for scholars and engineers if the immersion process cannot be properly controlled engineering accidents may occur such as breakage of the suspension cables overturning of barges torsion failure of the pipeline rollover of the pipeline and unsuccessful underwater localization and installation of the pipeline in this study an immersion project for a pipeline with multiple floating bodies located in nanning china is considered the immersion process of the pipeline performed in this study involves the challenges of a large scale pipeline irregular curved crank shape multi body coupled system and complex construction process by employing pipeline theory winch theory and multi body coupling theory a numerical model of the immersion system with multiple floating bodies during the immersion process is established a comparison between numerical simulations and field measurement results is then presented to assess the efficacy of the proposed numerical model the dynamic performance of the immersion system during the immersion process is comprehensively investigated under varying key parameters the numerical calculations and results presented in this paper can provide valuable construction recommendations to avoid potential engineering risks and ensure the economic efficiency of similar projects in the future 2 overview of the project the river crossing pipeline considered in this study is designed to cross the yongjiang river in nanning china and is buried in an underwater foundation trench the river crossing pipeline is designed with an irregular curved crank shape because of riverbed conditions and navigation and construction needs as shown in fig 1 a the total length of the pipeline is 438 m comprising four welded prefabricated steel pipe segments with an external diameter of 2620 mm the total weight of the river crossing pipeline after water injection is more than 3020 t the external diameter and span of the pipeline are the largest and longest respectively in south china in recent years a specialized immersion system was designed for the immersion construction of this pipeline as shown in fig 1 b the immersion system comprises a pipeline 16 steel buoys 9 airbags 8 barges and 2 crawler cranes the airbags and steel buoys are connected to the pipeline by rubber straps and mooring ropes respectively while the barges and crawler cranes are connected to the pipeline body by crane arms and suspension cables respectively the pipeline and steel buoys are made of q235 steel the major parameters of the river crossing pipeline steel buoys and airbags are listed in table 1 airbag deflation is adopted as a construction technology to immerse the pipeline fig 1 c demonstrates the detailed immersion process for the pipeline the immersion process can be described as follows i before immersion of the pipeline the pipeline body floats on the river surface due to the support of the buoyancy of the steel buoys and airbags ii water injection and pressurization of the pipeline are implemented after which the pipeline body sinks to a certain depth and is suspended in the water iii the airbag valves are opened to release air resulting in deflation and disengagement of the airbags simultaneously the suspension cables are lowered and the entire loading of the pipeline body is transferred from the steel buoys and airbags to the steel buoys barges and crawler cranes iv after the completion of the airbag deflation process the attitude of the pipeline is adjusted by the barges and crawler cranes finally the pipeline is rotated 90 and immersed in the underwater foundation trench of the riverbed the construction site for the multi floating immersion system is shown in fig 2 a details of the connections between the pipeline and the steel buoys and airbags at the construction site can be seen in fig 2 b as stated above the immersion process for the pipeline involves problems related to the large scale pipeline irregular curved crank shape complex multi body coupled system and complex construction processes the dynamic behavior of the immersion system during the immersion process is very complicated and needs to be investigated thoroughly to avoid potential engineering risks and ensure economic efficiency 3 numerical model and basic theory 3 1 establishment of the numerical model in fig 3 a the coordinate systems of the numerical model are presented including the body fixed coordinate system s x y z and the global reference coordinate system g x y z the numerical model of the multi floating immersion system is established within the framework of the orcaflex program the aerial view diagram of the model is shown in fig 3 b the basic aerodynamic and hydrodynamic parameters of the project are listed in table 2 in the numerical model the pipeline and mooring ropes are simulated using line units based on the centralized mass method the airbags and steel buoys are simulated with six degree of freedom 6d buoy units the barges and crawler cranes are simulated using vessel and shape units respectively the crane arms and suspension cables on the barges and crawler cranes that are connected to the pipeline body are simulated using shape and winch units respectively the boundary conditions of the two ends of the immersion system are simulated using link units the following specific measures are introduced in the numerical simulation i four anchor cables connected at each end of the pipeline are anchored to fixed points to simulate the boundary conditions of the immersion system as shown in fig 3 c the two anchor cables simulated as link units are arranged in the x and y directions of the global coordinate system their typical tensile stiffness and length are 5 10 4 kn and 50 m respectively ii in the actual project each steel buoy and airbag is connected to the pipeline by several sets of mooring ropes for simplicity only one line unit is utilized to simulate the ropes connecting the steel buoys and airbags to the pipeline in the numerical simulation to simulate the actual engineering situation in which the steel buoy and airbag can rotate around the pipeline the connection bending stiffness and twisting stiffness of the line units are set as infinity in the numerical simulation iii because the sluice gate upstream in the river is closed during the actual immersion process the current velocity is minimal in addition waves in the river are negligible and the crawler cranes are fixed on land on the two sides of the river consequently the barges and crawler cranes are set as immobile structures in the numerical simulation iv in the numerical simulation the masses of the airbags are considered negligible and the airbags only provide a buoyancy for the pipeline and the airbag deflation process is simulated by applying a linear digressive force at the connection between the airbag and the pipeline and the initial force value is determined from the initial static equilibrium position of the immersion system and the immersion volume of the airbags the airbags are disengaged from the pipeline after completion of the airbag deflation using the element birth and death technique a diagram of the numerical simulation of the immersion system after the airbag deflation is illustrated in fig 3 d 3 2 pipeline theory in the pipeline immersion process the dynamic behavior of the pipeline exhibits various nonlinear features such as geometric configurations with irregular curved crank shapes dynamic coupling effects between the floating structures and mooring systems fluid structure coupling effects stochastic wind loads and boundary conditions thus establishing an effective and reasonable numerical simulation model for a pipeline with multiple floating bodies is important to investigate the dynamic responses of the pipeline during the immersion process using the concentrated mass method the pipeline is divided into a series of line segments as shown in fig 4 these are modeled using straight massless model segments with a node at each end and properties such as the mass weight buoyancy and drag force are concentrated at the nodes the model includes various springs and dampers to represent the structural properties of the pipeline the axial and torsional properties of the pipeline are simulated by the axial and torsional springs respectively and their dampers at the center of the line segment the bending properties of the pipeline are simulated using rotational springs and their dampers at both ends of the node orcina 2020 gong et al 2014 2016 amaechi et al 2019 in this study the numerical simulation program calculates the forces and moments on a mid node in five stages tension forces bending moments shear forces torsion moments and total load the details of the calculations can be found in refs orcina 2014 gong et al 2014 2016 amaechi et al 2019 3 3 6d buoy theory the airbags and steel buoys are simulated with 6d buoy units the buoy is treated as a rigid body with six degrees of freedom including three translational and three rotational degrees of freedom the equation of motion for the buoy includes contributions from the weight buoyancy and hydrodynamic loads comprising linear hydrodynamic damping and moments the hydrodynamic load on a cylinder is applied at the centroid of the dampened volume of the cylinder and is scaled based on the proportion of the cylinder that is damp 3 4 winch and shape theory the dynamic behavior of the suspension cables is simulated by setting the specified pay out value of the winch units at each time step based on the tensile rigidity of the winch units the tension of the suspension cables f s can be obtained as follows 1 f s l l 0 c d l d t d l 0 d t k l 0 where l is the total length of the winch suspension cable path l 0 is the unstretched length of the suspension cable paid out and k and c are the suspension cable stiffness and damping values respectively the crane arms in the barges and crawler cranes are simulated by shape units in the program of orcaflex shape units are geometric shapes and three types are available i e elastic solids shapes trapped shapes and drawing shapes they may be fixed or attached to other objects such as vessels or buoys drawing shapes are adopted in this numerical simulation and it can be used purely for visualization and have no influence on or interaction with the rest of the model 3 5 link theory link units are simple springs or spring damper connections linking two points in the model they pull the two points together or hold them apart with a force that depends on their relative positions and velocities link units have no mass or hydrodynamic loading and simply apply an equal and opposite force to the two points 3 6 aerodynamic and hydrodynamic load theory the fluctuating component of the wind velocity can be simulated using the wind spectrum and a coherence function to maintain the spatial statistical properties the npd wind spectrum used to generate the stochastic wind in this study is represented as follows shae et al 2018 2 s n p d f 320 u 0 10 2 z 10 0 45 1 f 0 468 3 561 where u 0 is the wind velocity at a height of 10 m z is the height above the river surface and f is the wind frequency the fluid current or air drag forces applied to the pipeline are calculated using the cross flow principle the formulations for the drag force components f x f y and f z in the local line directions can be expressed as follows 3 f x 1 2 p w ρ d n l l γ d x v x v n 4 f y 1 2 p w ρ d n l l γ d y v y v n 5 f z 1 2 p w ρ d a l l γ d z v z v n where f x f y and f z are the drag forces in the x y and z directions respectively γ d x γ d y and γ d z are the drag coefficients in the x y and z directions respectively v x v y v z and v n are the fluid velocity components in the x y z and normal directions respectively d n and d a are the normal drag lift diameter and axial drag lift diameter respectively l l is the length of the pipeline represented by the node ρ is the fluid density current or air and p w is the proportion of wetness or dryness of the pipe as appropriate 3 7 equations of motion for the immersion system to explore the dynamic behavior during immersion of the pipeline system with multiple floating bodies under internal and external loads it is necessary to consider the mass weight buoyancy stochastic wind and current loads on the pipeline steel buoys and airbags the equation of motion for the immersion system under such loads is calculated as follows 6 m p a c p v k p f p v t where m p a is the system inertia load c p v is the system damping load k p is the system stiffness load f p v t is the external load p v and a are the position velocity and acceleration vectors respectively and t is the simulation time the equation for the immersion system is solved using the implicit integration scheme in the time domain dynamic analysis the system geometry is re computed at every time step allowing the simulation to entirely consider the geometric nonlinearities the hydrodynamic response of the structure is affected by several factors such as the system damping system stiffness and external loads the fully coupled approach is employed in this study where the system equation of motion is solved simultaneously and full interactions among the suspension cables mooring ropes river crossing pipeline and floaters steel buoys and airbags are considered the fully coupled approach has the advantage of generating model files at each coupling iteration which can be more accurate particularly for complex models in addition the nonlinear effect of a geometric configuration with an irregular curved crank shape dynamic coupling between the floating structures and the mooring system fluid structure coupling effects stochastic external force excitations and boundary conditions can be included although it is time consuming gong et al 2014 4 comparison between the numerical simulation and field measurement results to assess the efficacy of the numerical model in this study field measurement results are utilized for comparison in typical construction cases the vertical displacements of the point hoists and the tensions of the suspension cables were measured at the construction site as shown in fig 5 fig 6 demonstrates that the final vertical displacement obtained in the numerical simulation conforms well with the field measurement data for each point hoist and the relative error between these two methods is between 0 60 and 3 33 in addition the curves calculated using the numerical simulation and those obtained from the field measurement data exhibit similar trends the maximum and minimum vertical displacements occur at hoist points 3 and 5 respectively fig 7 shows that the numerical simulation results comply with the field measurement data for both the maximum dynamic tensions of various suspension cables the differences are less than 30 moreover the overall trends of the curves obtained from the numerical simulations and measured results are similar in the two curves the largest and smallest maximum dynamic tensions occur in suspension cables 5 and 8 respectively however the numerical predictions are approximately larger than the field measurements especially at the middle position and tail end of the pipeline as shown in fig 8 a and b the final shape and posture of the immersion system are approximately equal in both the numerical simulation and actual construction in particular steel buoys 15 and 16 at the tail end of the pipeline are not completely submerged in the water and the immersion depths are approximately the same in the numerical simulation and actual construction during the final immersion stage in contrast the other steel buoys are completely submerged in the water this phenomenon corresponds with the heave motion statistics listed in table 3 which indicate that the minimum heave occurs at steel buoys 1 8 15 and 16 this implies that the tail end of the pipeline inclines upward in the final immersion stage and the steel buoys 15 and 16 at the tail end of the pipeline are not completely submerged in the water these differences between the numerical and measured results in figs 6 7 may be contributed by the reasons such as the simplifications and specific disposal measures for the connection between the steel buoys and airbags with the pipeline in numerical simulation the coordination and synchronism of lowing arrangements of suspension cables and deflation of all the airbags in the numerical simulation are very hard to realize in actual engineering and the measurement error of sensors in practical engineering overall the proposed numerical model and its results are acceptable and reasonable thus it is concluded that the proposed numerical calculations are capable of providing a sufficiently accurate analysis of the dynamic performance of a pipeline system with multiple floating bodies during the immersion process 5 numerical results and discussion 5 1 time domain analysis for a typical calculation case in the typical calculation case the lowering speed of the suspension cables and the deflation time of the airbags are defined as v l 0 017 m s and t d 90 s respectively the lowering time of the suspension cables and the deflation time of the airbags are in the range of 10 100 s and 0 90 s respectively the pre tension of suspension cables is defined as f sp 5 kn the internal pressure of the pipeline is p i 1100 kpa and the tensions of the suspension cable and mooring rope are defined as f s and f m respectively 5 1 1 time domain analysis of the suspension cables on the barges and crawler cranes the results in fig 9 a c indicate that the tension of almost all the suspension cables increase to 40 kn during 0 10 s and then decrease to 0 kn during 10 20 s subsequently the tensions increase again at 70 s and tend to be stable after 100 s it can be observed in fig 9 d that the maximum dynamic tensions for different suspension cables are distinctly different the tension values are larger in the middle position and smaller at the two ends of the pipeline the largest and smallest maximum dynamic tensions occur in suspension cables 5 and 9 respectively and the maximum dynamic tension in suspension cable 5 is approximately 180 kn notably almost all the suspension cable dynamic tension values are zero between 20 and 70 s in fig 9 a c this result may occur because the increased buoyancy due to the immersion of the steel buoys and their increased displacement are greater than the decrease in the buoyancy due to the deflation of the airbags as shown in fig 9 a c once the taut slack phenomenon occurs from 70 to 100 s high frequency components will arise at the tension of the suspension cables impact tension will appear and the dynamic tensions will be distinctly amplified lu et al 2011 this is dangerous for the safety and stability of the immersion system and special attention should be paid to this phenomenon 5 1 2 time domain analysis of the mooring ropes fig 10 a shows the pre tensions of mooring ropes 1 16 because of the influence of the initial equilibrium position of the immersion system the larger pre tension values of the mooring ropes exhibit at the middle of the pipeline and smaller values at the two ends of the pipeline this may imply that the middle of the pipeline is more submerged in the water thereby more steel buoys should be provided in the middle of the immersion system in water to provide more buoyancy the results in fig 10 b c indicate that the dynamic tensions of mooring ropes 1 15 increase slowly from 0 to 10 s increase sharply to approximately 380 kn from 10 to 90 s and fluctuate around 380 kn thereafter moreover the rate of increase in the dynamic tension of the mooring ropes changed dramatically at 10 s because the suspension cables do not start to lower until 10 s in particular it is worth noting that the steel buoys begin to completely submerge from 62 s except for mooring rope 16 moreover the dynamic tension of mooring rope 16 is only approximately 320 kn from 100 to 140 s this may be induced by the final posture of the pipeline which caused steel buoy 16 to be un fully submerged at the end of the process in the later stage of the immersion process the loadings of the immersion system are primarily borne by the steel buoys and suspension cables if the steel buoys are not completely submerged the tension of the suspension cables will increase and may even exceed the capacity of the barge therefore the phenomenon in which the steel buoys are not completely submerged in the later stage of the immersion process should be given sufficient attention 5 1 3 dynamic responses of the pipeline in fig 11 the amplitudes of the pipeline motion corresponding to the degrees of freedom are minimal except in the heave direction in fig 11 c the heave motion of the pipeline represents the pipeline immersion process in the vertical direction after completion of the airbag deflation the mid span of the pipeline moves approximately 1 5 m in the vertical direction the airbags deflate over 0 90 s after the completion of the airbag deflation the amplitudes of the pipeline motion in each degree of freedom increase significantly moreover the vibrational frequencies of the motion trajectories increase and the motion finally converges to a certain value these results may be caused by the occurrence of the taut slack phenomenon in the suspension cables near the end of the airbag deflation process in this case the process of transferring the burden loads from the airbags to the steel buoys and the suspension cables will be nonuniform overall these results illustrate that the immersion process of the pipeline with the proposed construction method is safe stable and controllable 5 1 4 dynamic responses of the steel buoys the dynamic response statistics for typical steel buoys 1 8 15 and 16 are presented in table 3 similar to the dynamic responses of the pipeline it can be observed that the amplitude of the motion of the steel buoys corresponding to the degrees of freedom is minimal except in the heave direction in table 3 the negative minimum values of the heave for each steel buoy can approximately represent the immersion depth of the steel buoy as shown in fig 11 c particularly for steel buoy 8 located near the mid span of the pipeline which approximately approaches the immersion depth of the pipeline these results imply that the steel buoys are tightly connected to the pipeline during the immersion process in addition the response statistics of the steel buoys in the heave direction suggest that steel buoys 15 and 16 at the tail end of the pipeline are not completely submerged in the water similar in fig 8 the buoyancy of the steel buoys increases with the submerged depth if the steel buoys are not completely submerged in the water a greater burden load will be transferred to the suspension cables during the immersion process 5 1 5 stress distribution along the length of the pipeline fig 12 a c show the maximum minimum and mean von mises stress bending stress and tensile stress of the pipeline along its length respectively the sum of the amplitudes of the bending moment stress and tensile stress is approximately equal to the amplitude of the von mises stress the stress in the pipeline primarily originates from the bending stress based on these figures the stress amplitude in the pipeline is within the range of safety it is noted that the stresses under various loads are not symmetric about the mid span point of the pipeline this can be attributed to the effect of the irregular structural shape of the pipeline and the non uniform distribution of the external loading excitations due to the multiple floating bodies in addition the maximum von mises stresses occur at a location of approximately 300 310 m on the pipeline which is majorly the result of stress concentration in the maximum bending position of the pipeline 5 2 sensitivity analysis of the key parameters 5 2 1 effect of the airbag deflation time in fig 13 a distinct differences for different deflation times can be observed the curves for deflation times of 50 s and 70 s almost coincide and the dynamic tension exhibits two peaks at suspension cables 3 and 6 for a deflation time of 30 s the dynamic tension reaches peaks at suspension cables 3 and 7 however only one peak at suspension cable 5 can be observed for a deflation time of 90 s moreover the dynamic tension amplitudes for deflation times of 30 s and 90 s are clearly larger than those for deflation times of 50 s and 70 s thus it can be concluded that varying the deflation time has a distinct effect on the maximum dynamic tension amplitude and distribution for different suspension cables the coefficient of variation cv is introduced to evaluate the uniformity of the dynamic tension in the suspension cables under various calculation conditions here cv σ m where σ is the standard deviation and m is the mean value in fig 13 a the cv values for the dynamic tensions of the suspension cables are corresponding to the deflation times of 90 s 70 s 50 s and 30 s are 0 60 0 53 0 41 and 0 64 respectively this indicates that the uniformity of the dynamic tension of the suspension cables is optimum for a deflation time of 30 s fig 13 b shows the comparison of the tension and stresses under various airbag deflation times for the four deflation times there is little difference in the maximum and mean dynamic tensions at different suspension cables in addition the minimum dynamic tension value still occurs at mooring rope 16 which implies that the tail end of the pipeline moves downward in the heave direction with the increase in the deflation time from 30 s to 90 s for all the mooring ropes the maximum dynamic tensions increase whereas the mean dynamic tensions decease these results are primarily induced by the downward amplitude of the tail end of the pipeline in the heave direction with increasing deflation time it can be observed in fig 13 c that for the four deflation times the stress curves form a rightward gibbous arch and the von mises stress reaches the maximum value at a location of approximately 300 310 m i e near the junction of pipelines 2 and 3 with varying deflation times the location of the maximum von mises stress remains approximately constant when the deflation time increases the amplitude of the maximum von mises stress increases slightly and the stress curve becomes rougher particularly in the left half of the pipeline which indicates that the high frequency dynamic tension is excited at longer deflation times this result occurs because the taut slack phenomenon of the suspension cables is more significant when the deflation time increases to 90 s i e the point at which the airbags disengage from the pipeline after the airbag deflation is complete 5 2 2 effect of the lowering speed of the suspension cables when the lowering speed increases the maximum value of the tension initially increases and then remains constant for almost all the suspension cables as shown in fig 14 a for v 0 031 m s and v 0 051 m s in addition the maximum dynamic tension distributions in suspension cables are influenced by the lowering speed of the suspension cables the maximum dynamic tension of the suspension cables appears in suspension cable 1 under suspension cable lowering speeds of v 0 022 m s v 0 031 m s and v 0 051 m s the maximum dynamic tension occurs in suspension cable 5 of v 0 017 m s it is worth noting that the maximum tension for suspension cables 3 6 exceeds the bearing capacity of the 20 t barges under suspension cable lowering speeds of v 0 022 m s v 0 031 m s and v 0 051 m s which is very dangerous for the immersion process and requires special attention this likely occurs because the lowering speed is a major factor affecting the taut slack phenomenon in the suspension cables moreover from the perspective of uniform maximum dynamic tension of the suspension cables a lowering speed of v 0 017 m s is most suitable in fig 14 b the maximum dynamic tension of almost all the mooring ropes increases linearly with increasing lowering speed in addition the mean dynamic tension of the mooring rope is slightly affected by the lowering speed as shown in fig 14 c the von mises stress reaches its maximum value at the location of approximately 300 310 m under various lowering speeds furthermore with increasing lowering speed the amplitude of the maximum von mises stress in the left half of the pipeline increases sharply and several peak values of the stress are observed in the left half of the pipeline this is probably induced by the maximum dynamic tension distribution 5 2 3 effect of airbag deflation methods three airbag deflation methods are selected to assess the effect on the dynamic performance of the pipeline during the immersion processes in deflation method 1 the nine airbags attached to the pipeline are deflated simultaneously in deflation method 2 the four airbags at the two ends of the pipeline are deflated first followed by the five airbags in the middle location in deflation method 3 the five airbags in the middle location are deflated first followed by the four airbags at the two ends of the pipeline in fig 15 a the maximum dynamic tension reaches a peak in suspension cables 3 7 under the three deflation methods the maximum dynamic tension is greatest in almost all the suspension cables under deflation method 2 in addition from the perspective of the uniformity of the maximum dynamic tension of the suspension cables deflation method 1 is most reasonable it can be observed in fig 15 b that the airbag deflation method has a negligible effect on the maximum dynamic tension but has a significant effect on the mean dynamic tension of the mooring ropes the mean dynamic tensions for different mooring ropes are clearly different under various deflation methods particularly for mooring ropes 6 12 located in the middle of the pipeline this indicates that deflation method can affect the mean dynamic tension distribution of the mooring ropes along the length of the pipeline it should be noted that the mean dynamic tensions of mooring ropes 3 13 in the middle of the pipeline increase with the deflation method in the order of 2 3 1 but exhibit an opposite trend for the mooring ropes at the two ends of the pipeline as shown in fig 15 c the overall tendencies of the curves under the three deflation methods are approximately similar moreover compared with the results of deflation methods 2 and 3 the location of the maximum von mises stress is shifted by approximately 30 m to the right part of the pipeline under deflation method 1 and the maximum von mises stress increases by approximately 8 mpa the aforementioned results indicate that the stress distribution and energy intensive region of the pipeline can be considerably affected by the airbag deflation method 5 2 4 effect of pre tension of the suspension cables in fig 16 a with increasing pre tension the tension of suspension cables 1 5 decreases approximately linearly the tension of suspension cables 6 7 is nearly unaffected and tension of suspension cables 8 10 increases approximately linearly the peak values of the maximum dynamic tension of the suspension cables still occur in suspension cables 4 6 for different pre tension cases in addition the larger the pre tension the better the uniformity of the suspension cables tends to be as shown in fig 16 b c the pre tension has little effect on the maximum and mean dynamic tensions of the mooring ropes or the maximum von mises stress distribution along the pipeline 5 2 5 effect of the boundary conditions at the two ends of the pipeline three typical boundary conditions are considered in this study at each end of the pipeline boundary conditions 1 2 and 3 are digressive and two one or none of the long anchor cables are arranged in the x direction of the global coordinate system while the other long anchor cables are arranged in the y direction i e the constraint effect decreases in boundary conditions 1 3 in fig 17 a the boundary conditions have a negligible effect on the maximum tension for approximately all the suspension cables the tension uniformity of the suspension cables under boundary condition 1 is better than that under boundary conditions 2 or 3 as shown in fig 17 b with different boundary conditions the maximum and mean dynamic tensions of the mooring ropes change in a small range of no more than 5 and only minimal differences occur at the tail end of the pipeline it can be observed in fig 17 c that the stress distribution along the pipeline is significantly affected by changes in the boundary conditions in particular compared with the results under boundary condition 1 the location of the maximum value of the von mises stress is shifted toward the mid span of the pipeline under boundary condition 3 while the location remains unchanged under boundary condition 2 furthermore with the reduction of the constraint effect from boundary conditions 1 to 3 the maximum von mises stress gradually decreases these results may occur because the stress concentration phenomenon gradually weakens with the reduction of the constraint effect from boundary conditions 1 to 3 while the stress distribution from classical pipeline theory becomes dominant i e the maximum stress value occurs approximately in the mid span of the pipeline 6 conclusions and suggestions for the project based on the systematic study on the dynamic performance of a long curved river crossing pipeline with multiple floating bodies during immersion process the following conclusions and suggestions can be made 1 a comparison between numerical simulation and field measurement results is presented with appropriate comparison thus it is concluded that the presented numerical results are acceptable and reasonable 2 the largest maximum dynamic tensions occur in suspension cables 4 6 thus it is recommended that the two 50 t barges with greater bearing capacities be removed from the two ends to the mid span location of the pipeline to avoid the taut slack phenomenon it is suggested that the dynamic tensions of all the suspension cables should be measured in real time to make timely and flexible adjustments in the construction process 3 based on analysis of the dynamic performance of the immersion system the immersion process for the pipeline with the proposed construction method is safe stable and controllable in the final immersion stage the tail end of the pipeline inclines upward and the two steel buoys at the tail end of the pipeline are not completely submerged in the water therefore lowering the height of each suspension cable is recommended for reasonable control according to the actual engineering situation 4 the maximum stress value occurs at a location of approximately 300 310 m along the pipeline which can be resulted from stress concentration at the maximum bending position of the pipeline this location is shifted toward the mid span of the pipeline by reducing the constraint effect of the boundary conditions it is suggested that more barges steel buoys and airbags be added in these regions and reasonable boundary conditions are recommended for the project 5 the sensitivity analysis of key parameters e g the airbag deflation time lowering speed of the suspension cables and airbag deflation methods is conducted via numerical simulations thereby providing valuable construction recommendations to avoid potential engineering risks and ensuring the economic efficiency of the project 6 the proposed construction method modeling theory and analytical method used in the present study for a long curved river crossing pipeline system with multiple floating bodies during immersion process can provide valuable references for the similar projects in the future credit authorship contribution statement zhiwen wu conceptualization resources visualization supervision project administration funding acquisition yangyang xiao software validation field measurement investigation data curation visualization huihuan ma conceptualization methodology formal analysis writing review editing visualization funding acquisition pengpeng ni conceptualization methodology resources supervision pingjun lin software validation formal analysis investigation data curation visualization hao wang formal analysis software field measurement investigation shuai yang software resources formal analysis methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study had been supported by the national natural science foundation of china grants no 51808136 the guangxi natural science foundation grant no 2018jjb160058 the guangxi science and technology base and talent special funds grant no 2019ac20264 and guangxi key laboratory of disaster prevention and mitigation and engineering safety china grant no 2020zdk002 
20551,usually computational fluid dynamics cfd simulations are carried out under deterministic conditions however there are actually many uncertain factors such as fluid properties boundary conditions and working parameters that may have effects on the system response it is critical to study the uncertainty propagation in the stochastic cfd model in this paper one of surrogate models for uncertainty quantification uq problems non intrusive polynomial chaos nipc is introduced stochastic two dimensional cavity flow with uncertain lid velocity is taken as a study case to verify the effectiveness of nipc method in comparison with monte carlo mc method the results show that nipc method can greatly improve the efficiency of uq the influence of velocity uncertainty has obvious directivity in the flow field and the fluid viscosity has retardation effect on uncertainty propagation then the nipc method is applied to quantify the uncertainty of resistance sinkage and trim of the japan bulk carrier jbc model advancing with an uncertain speed in shallow water numerical simulations are carried out using the rans based cfd method the uq results indicate that the uncertainty of relevant variables can be evaluated accurately with small samples and under the same sampling points the higher the order of polynomial chaos expansion pce the more accurate the uq results keywords uncertainty quantification non intrusive polynomial chaos cfd simulation jbc model shallow water nomenclature b wl waterline breadth m c coefficients of polynomial chaos c b block coefficient c m midship section coefficient d dimension of stochastic variables d moulded depth m h water depth m k g vertical distance of the centre of gravity from keel m i xx moment of inertia about ox axis kg m2 i yy moment of inertia about oy axis kg m2 i zz moment of inertia about oz axis kg m2 l pp length between the perpendiculars m n runs number of cfd runs n c number of coefficients in pce p order of pce dimensionless pressure t draught m u uniform distribution v ship speed m s y dimensionless wall distance δ nm kronecker delta function μ expected value ν fluid kinematic viscosity m2 s ξ stochastic variable ρ fluid density kg m3 σ standard deviation displacement volume m3 cdf cumulative density function cfd computational fluid dynamics dfbi dynamic fluid body interaction ev expected value fdm finite difference method fvm finite volume method ipc intrusive polynomial chaos jbc japan bulk carrier lcb longitudinal centre of buoyancy lhs latin hypercube sampling mc monte carlo nipc non intrusive polynomial chaos nmri national maritime research institute pce polynomial chaos expansion pdf probability density function rans reynolds averaged navier stokes rbf radial basis sd standard deviation srs stochastic response surface uq uncertainty quantification v v verification and validation vof volume of fluid 1 introduction conventional computational fluid dynamics cfd simulations are carried out under deterministic conditions the uncertainties caused by computation model and numerical method can be estimated by verification and validation v v however many uncertainties caused by stochastic factors are ignored which may increase the degree of mismatch between the stochastic reality problem and the deterministic cfd simulations as shown in fig 1 in a traditional model the input parameters are assumed to be fixed so that the model response is deterministic without any uncertainty uncertainty quantification uq attempts to determine how likely the results are if some aspects of the system are not fully clear in other words uq takes the distributions of the uncertain input parameters into account and the response becomes a range of possible values the goal of uq is to obtain the statistical properties of the response such as expected value ev standard deviation sd probability density function pdf and cumulative density function cdf several uq methods have been applied in stochastic cfd problems including monte carlo mc method perturbation method moment method and surrogate models mc method can solve linear nonlinear uq problems if computing resources are sufficient but the accuracy of uq results is affected by the number of sampling points mc method is often regarded as the last means to solve uq problems in engineering practice because of its prohibitive computing cost and time span perturbation method and moment method are viable to solve linear uq problems with small parameter uncertainty recently several advanced surrogate models are developed to investigate uncertainty propagation problems such as polynomial chaos expansions pce liu et al 2014 rodio and congedo 2014 feinberg and langtangen 2015 kumar et al 2016 wu et al 2017 low rank tensor approximations rai 2014 gaussian process modelling bilionis et al 2013 the radial basis function rbf volpi et al 2015 and machine learning methods such as artificial neural network ann cheng et al 2019 and the deep learning model tripathy and bilionis 2018 the pce method will be explained in detail in section 2 low rank tensor approximation is a minimization problem in which the cost function measures the fit between a given matrix the given data and an approximating matrix the optimization variables subject to a constraint that the approximating matrix has reduced rank kriging or gaussian process regression is a method of interpolation for which the interpolated values are modeled by a gaussian process governed by prior covariances under suitable assumptions on the priors kriging gives the best linear unbiased prediction of the intermediate values interpolating methods based on other criteria such as smoothness may not yield the most likely intermediate values the method is widely used in the field of spatial analysis and computer experiments an rbf is a real valued function whose value depends only on the distance between the input and some fixed point the distance is usually euclidean distance although other metrics are sometimes used rbf has a property i e at the centre the output influence is highest at each unit distance away from the centre in any direction the influence decays a polyharmonic spline is a linear combination of polyharmonic radial basis functions rbfs which is used for function approximation and data interpolation in this paper pce method is used it can be divided into intrusive method and non intrusive method according to whether the cfd solver needs to be modified or not normally in the intrusive method the governing equations to solve are reformulated to target a pce then the unknown coefficients of pce can be obtained by galerkin projecting it is hard and time consuming to solve the stochastic three dimensional viscous flow problem due to the significant modification of cfd codes xiu and karniadakis 2003 applied a generalized polynomial chaos method to investigate the uncertainty propagation in incompressible flow simulations wang and kang 2010 introduced the intrusive polynomial chaos ipc method and the coupling process with one dimensional euler equation the uncertainty of two dimensional stochastic cavity flow was quantified by using ipc method as for non intrusive polynomial chaos nipc method there are two different approaches to calculate the coefficients of pce one is the projection based method that uses a numerical calculation of galerkin integrals pereira et al 2013 used the projection based nipc method to study the blood model uncertainty induced by viscosity the other approach is the regression based method that solves an over determined system based on a selected set of points daróczy et al 2016 simulated the transient turbulent flow in an h darrieus turbine with variable pitch angle and angular velocity and quantified the uncertainty of the performance coefficient and the quasi periodic torque curve via regression based nipc method abraham et al 2017 proposed a sparse regression nipc method for high dimensional stochastic problems avdonin et al 2018 carried out uq and sensitivity analysis of thermoacoustic stability of a turbulent swirl combustor and a laminar slit burner using the regression based nipc method in recent years there has been an increasing interest in uq in cfd fields such as aerodynamics bio fluid mechanics reacting flows and porous media fluid mechanics as for ship hydrodynamics there exists a mass of stochastic factors such as fluid properties ship speed initial and boundary conditions geometry and mechanics parameters caused by manufacture process which may affect the hydrodynamic performance of the ship therefore it is of great significance to take these factors into consideration in the initial stage of ship design as for uq problems in the field of ship hydrodynamics a few works have been carried out he et al 2013a carried out uq studies of cfd based performance prediction for the delft catamaran 372 the results demonstrated the efficiency of pce method and the potentials in reliability based robust design optimization he et al 2013b studied the performance of the delft catamaran in irregular head waves and carried out uq analysis of the resistance motions and slamming loads of the ship in head sea with uncertain regular waves and geometry using kriging and polyharmonic spline methods the uq results showed that the ordinary kriging and polyharmonic spline are efficient surrogate models for the uq problems mousaviraad et al 2013 discussed the relationship and differences between the deterministic v v methodology and non deterministic uq methodology and proposed a framework for evaluating convergence and validation for stochastic uq problems diez et al 2014 measured the uncertainty of resistance sinkage and trim of the delft catamaran under variable froude number and geometry conditions using metamodel quadrature and karhunen loeve expansion volpi et al 2015 developed a dynamic metamodel based on stochastic rbfs and applied it to two industrial uq problems in ship hydrodynamics the delft catamaran with variable froude number and in variable regular head waves dash 2016 developed a stochastic response surface srs method for evaluating the uncertainty propagation of a twin propeller twin rudder ship in zigzag and turning circle manoeuvres the model uncertainty came from variation of propeller thrust and torque rudder normal force and rudder torque in the mathematical model of manoeuvring motion the uq results showed that the srs method is more efficient than the mc method stern et al 2017 provided a summary of the literature on uq and validation methods for the practical problems of ship hydrodynamics xia et al 2020 validated the efficiency of nipc method by studying a stochastic function in comparison with that of mc method and used the nipc method to study a stochastic problem of ship hydrodynamics the dtc model in shallow water waves whose height and period were treated as random variables with gaussian distribution the uncertainty of the resistance heave motion and pitch motion of the dtc model was quantified it should be noted that normally there are two aspects in uq problems the first one is to obtain the distribution of stochastic input variables from reliable data the second one strives to quantify the uncertainty of output variables this paper focuses only on the second aspect the rest of the paper is organized as follows section 2 introduces the pce method for uq problems in detail section 3 shows the validity of nipc method by investigating a two dimensional stochastic cavity flow problem in section 4 a stochastic problem in ship hydrodynamics the japan bulk carrier jbc model advancing with an uncertain speed in shallow water is studied section 5 outlines some conclusions drawn from this study 2 polynomial chaos expansion 2 1 definition of uq problems uq study is defined as the study to measure the uncertainty in the output y of a model or system affected by uncertain input parameters 1 y f x t ξ where ξ ξ 1 ξ 2 ξ d t is a vector of uncertain input parameters x is a space coordinate and t is the time usually it is difficult to obtain an explicit representation of the model f x t ξ thus a reasonable surrogate model is constructed to express the model approximately pce is a general expression that uses a linear combination of orthogonal polynomials to represent the functional relationship between the random input variables and the random response it is practicable to compute the statistic properties of random response via the surrogate model pce as stated in wiener 1938 if the f process is a square integrable function defined on hilbert space and the stochastic variables ξ j j 1 2 d are independent the response y can be rewritten as a series of orthogonal polynomial bases 2 y a 0 ψ 0 i 1 1 d a i 1 ψ 1 ξ i 1 i 1 1 d i 2 1 i 1 a i 1 i 2 ψ 2 ξ i 1 ξ i 2 i 1 1 d i 2 1 i 1 i p 1 i p 1 a i 1 i p ψ p ξ i 1 ξ i 2 ξ i p where a x t are the polynomial coefficients related to deterministic x and t and ψ ξ are the multivariate polynomials of stochastic input variables ξ the polynomial chaos representation truncated by dimension d of stochastic variables and polynomials of degree p is expressed as 3 y ˆ a 0 ψ 0 i 1 1 d a i 1 ψ 1 ξ i 1 i 1 1 d i 2 1 i 1 a i 1 i 2 ψ 2 ξ i 1 ξ i 2 i 1 1 d i 2 1 i 1 i p 1 i p 1 a i 1 i p ψ p ξ i 1 ξ i p to simplify the mathematical expression y ˆ can be rewritten as y ˆ i 0 n c 1 c i φ i according to the one to one correspondence between a and c ψ and φ mollon et al 2010 where n c is the number of polynomial coefficients φ ξ are orthogonal concerning the joint probability density function p ξ 4 φ n ξ φ m ξ φ n 2 ξ δ n m where δ nm is the kronecker delta function and the inner product is defined as 5 φ n ξ φ m ξ φ n ξ φ m ξ p ξ d ξ the uncertain input parameters are assumed to be independent thus p ξ can be expressed as 6 p ξ i 1 d p i ξ i the number of unknown coefficients c in eq 3 is 7 n c 1 p 1 1 p 1 p 1 2 p 1 2 p 1 d p 1 d p d p d 2 2 construction of pce ghanem and spanos 1991 developed the polynomial chaos method on the basis of the homogeneous chaos theory wiener 1938 in the early stages of the uq study the form of pce was hermite polynomials when the distribution of random variables was normal distribution there are two approaches to cope with other random variables with different distributions one is to map the random variables to standard normal distribution spaces table 1 lists the relationship between transformed pdf and univariate pdf for different distributions chutia et al 2014 the other is wiener askey polynomial chaos method xiu and karniadakis 2002 some of corresponding polynomials obtained by this method with respect to different distributions are presented in table 2 2 3 calculation of pce coefficients there are two main nipc methods for solving uq problems one is based on projection and the other is based on regression as for the projection based method the inner product of y ˆ and polynomial chaos φ j ξ is the projection of y ˆ in the direction of φ j ξ 8 y ˆ φ j ξ i 0 n c 1 c i φ i ξ φ j ξ c j φ j 2 ξ the polynomial coefficients can be obtained according to the orthogonality of the polynomial chaos basis 9 c j 1 φ j 2 ξ y ˆ φ j ξ p ξ d ξ hence the goal is to evaluate the integrals numerically however numerical integration technique suffers the curse of dimensionality the number of sampling points rockets exponentially as the dimension of random variables increases a more affordable method is regression based method which carries out a regression on a response surface it should be noted that the number of sampling points m is supposed to be 2n c according to hosder et al 2007 the random number generation technology adopted in this study is latin hypercube sampling lhs method giunta et al 2003 lhs is a stratified sampling method for generating sampling points from a multidimensional distribution it is widely used in mc simulation because it can drastically reduce the number of runs necessary to achieve a reasonably accurate result lhs is based on the latin square design which refers to a square matrix with only one sample per row and column latin hypercube is a multidimensional generalization of latin square each hyperplane perpendicular to the axis contains at most one sample the computations are carried out according to the conditions determined by the sampling points the responses are expanded as follows 10 φ 0 ξ 1 φ n ξ 1 φ 0 ξ m φ n ξ m c 0 c n f ˆ x t ξ 1 f ˆ x t ξ m the compact form is 11 φc y ˆ the vector c can be computed via the least square method 12 c φ t φ 1 φ t y ˆ when all the polynomial coefficients are determined the statistical properties of the response variable like ev and sd can be obtained wang and kang 2010 13 μ x t d ξ y ˆ ξ p ξ d ξ d ξ j 0 n c 1 c j x t φ j ξ p ξ d ξ c 0 x t d ξ φ 0 p ξ d ξ j 1 n c 1 c j x t d ξ φ j ξ p ξ d ξ c 0 x t φ 0 j 1 n c 1 c j x t d ξ φ 0 φ j ξ p ξ d ξ c 0 x t 14 σ 2 x t d ξ y ˆ μ x t 2 p ξ d ξ d ξ y ˆ c 0 x t φ 0 2 p ξ d ξ d ξ j 0 n c 1 c j φ j ξ j 0 n c 1 c j φ j ξ 2 c 0 φ 0 j 0 n c 1 c j φ j ξ c 0 2 φ 0 2 p ξ d ξ i 0 n c 1 j 0 n c 1 d ξ c i c j φ i ξ φ j ξ p ξ d ξ c 0 2 φ 0 2 j 0 n c 1 c j 2 d ξ φ j 2 ξ p ξ d ξ c 0 2 φ 0 2 j 1 n c 1 c j 2 x t d ξ φ j 2 ξ p ξ d ξ j 1 n c 1 c j 2 x t φ j 2 ξ the pdf and cdf of the response variables can be approximated by the kernel density estimation technique mendes et al 2011 2 4 workflow of the nipc method the nipc method is implemented via the following steps 1 preprocessing determine the distribution of the stochastic variables then the form of pce can be determined according to table 2 and the orthogonal polynomials can be constructed by gram schmidt orthogonalization or three term recursion 2 sampling generate the sampling points where the model will be calculated under these conditions using projection based nipc method quadrature points and quadrature weights can be determined while using regression based nipc method random sampling points can be generated by a random number generator like lhs 3 calculating calculate the model under the conditions sampling points this step is most time consuming 4 postprocessing evaluate the coefficients of pce based on the form of pce obtained in step 1 and the results of output variables calculated in step 3 then compute the statistical characteristics of output variables such as ev and sd using eq 13 and eq 14 3 case of stochastic cavity flow in this section a two dimensional stochastic cavity flow as shown in fig 2 is studied the computational domain is a square cavity with both length and height of 2 the velocity components in the x and y directions are denoted by u and v the fluid kinematic viscosity ν and density ρ are 0 1 and 1 0 respectively all values in this case are dimensionless 3 1 governing equations and boundary initial conditions the governing equations two equations for the velocity components u v and one equation for the pressure p are as follows 15 u t u u x v u y 1 ρ p x ν 2 u x 2 2 u y 2 v t u v x v v y 1 ρ p y ν 2 v x 2 2 v y 2 2 p x 2 2 p y 2 ρ u x u x 2 u y v x v y v y the velocity of the lid driven is set as a stochastic parameter that satisfies normal distribution u lid n 1 0 0 12 reynolds number is about 20 and the flow is laminar the walls around are all no slip other boundary conditions are u v 0 on the other boundaries p y 0 at y 0 p 0 at y 2 p x 0 at x 0 2 the initial condition is u v p 0 at t 0 3 2 numerical solution the governing equations are solved using finite difference method fdm the structured mesh is 40 40 fig 3 shows the streamline pattern and pressure profile of the cavity flow under the deterministic condition it can be seen that there exists a large vortex close to the lid two corner vortexes locate at the upper corners it is a typical pattern of lid driven cavity flow 3 3 application of the nipc method this sub section shows the specific process of uncertainty quantification based on the nipc method in the case of stochastic cavity flow the lid velocity is normally distributed so the pce is of the form hermite polynomial according to table 2 pce can be calculated using gram schmidt orthogonalization method in this paper the pce is expanded to 4th order as 16 y ˆ c 0 c 1 u l i d 1 c 2 u l i d 2 2 u l i d 0 99 c 3 u l i d 3 3 u l i d 2 2 97 u l i d 0 97 c 4 u l i d 4 4 u l i d 3 5 94 u l i d 2 3 88 u l i d 0 9403 where y ˆ represents the output variable of interest to demonstrate how to calculate the coefficients of the pce four points x 1 y 0 05 0 1 0 15 0 2 are chosen as examples the velocity component u is taken as the system response and the uncertainty is quantified based on the results of 30 model runs based on the surrogate model eq 16 and the results of 30 runs the coefficients can be calculated using eq 12 eq 17 lists the surrogate models of the four points 17 u ˆ x 1 y 0 05 0 01553 0 00529 u l i d 1 0 00836 u l i d 2 2 u l i d 0 99 0 06068 u l i d 3 3 u l i d 2 2 97 u l i d 0 97 0 34773 u l i d 4 4 u l i d 3 5 94 u l i d 2 3 88 u l i d 0 9403 u ˆ x 1 y 0 1 0 02941 0 00911 u l i d 1 0 01638 u l i d 2 2 u l i d 0 99 0 12392 u l i d 3 3 u l i d 2 2 97 u l i d 0 97 0 67465 u l i d 4 4 u l i d 3 5 94 u l i d 2 3 88 u l i d 0 9403 u ˆ x 1 y 0 15 0 04205 0 01171 u l i d 1 0 02408 u l i d 2 2 u l i d 0 99 0 19142 u l i d 3 3 u l i d 2 2 97 u l i d 0 97 0 98619 u l i d 4 4 u l i d 3 5 94 u l i d 2 3 88 u l i d 0 9403 u ˆ x 1 y 0 2 0 05369 0 01333 u l i d 1 0 03140 u l i d 2 2 u l i d 0 99 0 26355 u l i d 3 3 u l i d 2 2 97 u l i d 0 97 1 28307 u l i d 4 4 u l i d 3 5 94 u l i d 2 3 88 u l i d 0 9403 then the ev and sd of these points can be calculated using eq 13 and eq 14 uq results for other points can be obtained in a similar way 3 4 comparison between nipc method and mc method in order to verify the efficiency of nipc method the uq results of the velocity component u at the vertical centre line x 1 obtained by 10 000 mc simulations serve as a standard for comparison the comparison between nipc method and mc method is carried out under the condition of small samples fig 4 shows the uq results based on 30 50 80 samples using nipc method and mc method from the histograms it can be seen that the absolute errors of ev and sd calculated by nipc method are less than those by mc method in most places as shown in fig 4 a and e the absolute error of ev calculated using nipc method can reach less than about 0 003 when the sample size is 30 while 80 samples are required to achieve the same accuracy when using mc method similarly as far as sd is concerned mc method requires more than 80 samples to achieve the accuracy obtained by nipc method using only 30 samples this indicates that when the sample size is small nipc method can quantify the uncertainty more efficiently 3 5 analysis of the results the discussion in this sub section focuses on the uncertainty of the flow velocity namely the distribution of velocity components u and v under the influence of uncertain lid velocity fig 5 shows the ev and sd of velocity components on the horizontal centre line y 1 and vertical centre line x 1 respectively the sd refers to the uncertainty range as shown in fig 5 a under the influence of the main vortex v fluctuates with two peaks located around the vortex while there is only one peak in the curve of u from the dotted line representing the sd it can be seen that the uncertainty of lid velocity propagates into the cavity flow and the effect differs along the horizontal centre line the greatest uncertainty occurs at the place where the velocity is largest as fig 5 b shows the randomness of lid velocity has less influence on v than on u which is in line with intuition as for u it has the largest uncertainty on the upper boundary as the distance to the lid with uncertain velocity increases the uncertainty decreases first and then reaches the local maximum at around y 0 75 fig 6 shows the contours of sd of velocity components u and v the maximal value of sd of u appears at the upper lid there are another two peaks which locate near below the core of the main vortex as for the distribution of sd of v two peaks exist on the left and right sides of the core of the main vortex it can be seen that the influence of velocity uncertainty has obvious directivity in the flow field and the convective effects of flow dominate the propagation of the uncertainty in order to investigate the effect of viscosity ν on the propagation of uncertainty two more cases ν n 0 05 0 005 2 and ν n 0 01 0 001 2 are studied under the same other conditions fig 7 shows the comparison of sds of velocity components for three different evs of viscosity as can be seen the sd for ev ν 0 01 is much larger than those of other two at most places the sd for ev ν 0 05 is the second largest in other words the greater the viscosity the more hindered the propagation of uncertainty the cause of this phenomenon is easy to understand from the view of viscosity property as the fluid viscosity increases the viscous force between the fluid particles gets larger this increases the retardation effect the increased viscous diffusion keeps the flow field more uniform as viscosity increases the ability to resist the effects of uncertainty increases 4 study case japan bulk carrier with stochastic speed ship speed is one of the most important properties of a ship and affects ship s usability and navigation efficiency prediction of ship resistance is of great importance because a ship designed with good resistance performance can ensure good economic performance when a ship sails in shallow water the ship s squat sinkage and trim and resistance will increase because of the hydrodynamic interaction between the hull and the seabed there are four main methods for predicting ship s squat and resistance empirical method analytical method experimental method with ship model and numerical method tezdogan et al 2016 analyzed the hydrodynamic performance of the dtc model with different ship draughts under different ship speeds by using cfd based numerical method the squat results were compared with experimental data terziev et al 2018 investigated the hydrodynamic behavior of the dtc model when advancing through restricted shallow waters by using three methods i e cfd slender body theory and empirical methods and good agreement was shown among the results obtained by the different methods traditionally prediction of ship hydrodynamic performance is carried out under deterministic conditions however a ship may not be able to maintain a constant speed in reality this section studies the application of nipc method in cfd based uq of ship resistance sinkage and trim with variable ship speed for the jbc model 4 1 geometry and simulation conditions the jbc is a capesize bulk carrier with an esd energy saving device and the hull lines and profile view are shown in fig 8 the main particulars of the jbc model are listed in table 3 the conditions of simulations refer to the benchmark cases of the national maritime research institute nmri in this paper the simulations of model tests are conducted for the ship model with an esd and without rudder propeller and the shallow water case with h t 1 515 is considered the ship speed is set as an uncertain variable with normal distribution v n 1 179 0 1179 2 the conditions of the ship speed are obtained by the lhs method the pce is expanded to first second and third order which requires 4 6 and 8 sampling points respectively with respect to one random input variable table 4 lists the specific values of the stochastic ship speed m s 4 2 cfd simulation the flow around the ship model is a three dimensional flow of incompressible viscous fluid which is governed by the reynolds averaged continuity equation and reynolds averaged navier stokes rans equations closure of the governing equations is achieved by using the realizable k ε turbulence model in this study the general cfd software package star ccm is used the numerical method for partial differential equations is finite volume method fvm the volume of fluid vof method is used to simulate the free surface in order to determine ship s sinkage and trim dynamic fluid body interaction dfbi module is used 4 3 computational domain and boundary conditions fig 9 shows the computational domain and the boundary conditions due to the symmetry of the flow with respect to the longitudinal centreplane of the hull only half of the flow field is considered it is suggested in cd adapco 2020 that the velocity inlet of the computational domain for resistance prediction should be located at least one ship length upstream of the fore perpendicular and the pressure outlet should be positioned at least two ship lengths downstream of the aft perpendicular according to the recommendation a velocity inlet condition is imposed on the inlet located 1 5 l p p upstream of the fore perpendicular the outlet is set as a pressure outlet to prevent backflow and is positioned 3 5 l p p downstream of the aft perpendicular on the hull and the bottom of the domain no slip wall conditions are imposed the bottom surface is located at the vertical position corresponding to the considered water depth h t 1 515 it should be noted that in the cfd simulation the hull is set to be immobile due to the relative motion of the fluid to the hull so the bottom is set to move with the same velocity as the incoming flow the top side of the domain is placed 1 0 l p p above the undisturbed free surface and the back side of the domain is located 1 5 l p p from the longitudinal centreplane of the hull the surfaces of the top and back sides are treated as velocity inlet a vof wave damping option is enforced to eliminate the wave reflection from the boundaries the vof wave damping length is set as 1 25 l p p a symmetry boundary condition is imposed on the surface of the front side that is located on the longitudinal centreplane of the hull 4 4 mesh generation and time step selection the mesh generation is carried out by the trimmed cell mesher in star ccm the generated meshes are mainly hexahedral unstructured meshes in the fluid domain and polyhedral trimmed meshes near the hull surface the meshes on the hull surface are locally denser with a greater mesh densifying ratio on the bow and transom the meshes near the free surface are densified vertically and the ones in the wave region are densified both laterally and vertically the meshes of the hull boundary layer and the bottom of the computational domain are generated by the prism layer mesher with 18 layers and a growth rate of 1 5 the y value which characterises the height of the first layer of the boundary layer meshes is controlled to be within 1 in order to use the low re y treatment fig 10 shows the generated mesh from different views fig 11 gives a graphical representation of y distribution on the hull and the bottom of computational domain the number of meshes generated in each case is approximately one million it is recommended by ittc 2011 that for ship resistance prediction the time step should be in the bound δt 0 005 0 01 l p p v in this paper the time step is set to 0 04s 0 006737 l p p v first order temporal discretization is selected in the implicit unsteady module which has been shown to obtain good convergence and stable results in similar studies such as tezdogan et al 2016 and terziev et al 2018 the maximum number of inner iterations for each unsteady time step is set to 10 4 5 results and discussion for deterministic cfd computations v v studies were performed using grid convergence index gci method to assess the numerical and modelling errors xia et al 2017 monotonic convergence was achieved numerical uncertainty was predicted and numerical solutions were evaluated against experimental data the present study mainly focuses on uq studies computation results of resistance sinkage and trim are processed using the regression based nipc method in order to quantify the uncertainty of the output variables induced by the uncertain ship speed table 5 lists the first second and third order pce with respect to one random variable the uncertain ship speed obeying normal distribution v n 1 179 0 1179 2 table 6 presents the results of cfd simulations under corresponding operating conditions in table 4 the coefficients of pce are calculated using least square method based on the polynomials in table 5 and the numerical results in table 6 in this section nine models have been studied mc based on 4 6 8 cfd runs first order pce based on 4 6 8 cfd runs second order pce based on 6 8 cfd runs and third order pce based on 8 cfd runs fig 12 shows the computed statistical properties of three output variables the total resistance sinkage and trim as the 3 bars at the top of each subgraph illustrate the uq results of the second order pce based on 6 cfd runs the second order pce based on 8 cfd runs and the third order pce based on 8 cfd runs are very close usually with the increase of the order of pce and the number of sampling points the statistical properties of the output variables obtained by nipc method tend to converge hosder et al 2007 thus the ev and sd computed by the third order pce based on 8 cfd runs p 3 n runs 8 can be considered as the most accurate result among all the results and used as a benchmark and the sd obtained by the surrogate model p 3 n runs 8 can be considered as the expected uncertainties as the 3 bars at the bottom of each subgraph show comparing the uq results obtained by mc method the results are not always convergent as the number of sampling points increases as for the evs of three output variables the results obtained by mc method based on 6 cfd runs instead of 8 cfd runs are more close to the benchmark result generally the uq results tend to converge gradually with the increase of sampling points however the randomness introduced by the generation algorithm of random numbers causes the fluctuation of uq results as for the sds the results obtained by mc method tend to get close to the benchmark result with the increase of sampling points the other 3 bars in the middle of each subgraph represent the uq results obtained by the models of polynomial chaos of order p 1 with 4 6 8 cfd runs it can be seen that with the increase of sampling points the values of both ev and sd are getting closer and closer to the benchmark result to illustrate the above conclusions more intuitively fig 13 presents the relative errors of ev and sd of the uq results compared with the benchmark result by comparing the results of the two surrogate models p 1 n runs 6 and p 2 n runs 6 it can be found that under the same number of sampling points the higher the order of pce the more accurate the uq results are the same conclusion can be drawn by the comparison between the surrogate models p 2 n runs 8 and p 3 n runs 8 in general nipc method can obtain more accurate uq results under small samples compared with mc method 5 conclusions this paper introduces a state of the art uq method nipc method firstly the stochastic behavior of a lid driven cavity flow affected by the uncertain lid velocity is studied using nipc method together with mc method the uq results show that nipc method is more effective than mc method the results of uncertainty propagation induced by the stochastic driven velocity show that the influence of the velocity uncertainty has obvious directivity in the flow field the viscosity of fluid has retardation effect on uncertainty propagation and the influence of stochastic parameters on uncertainty propagation in the flow decreases with the increase of viscosity then the uq problem of cfd simulations of the viscous flow around the jbc model advancing in shallow water is studied this case focuses on the influence of the pce order and the number of sampling points on the uq results by investigating the response of the jbc model in shallow water with the uncertain speed using mc method and nipc method the output variables of interest are resistance sinkage and trim the pce is expanded to first second and third order respectively with respect to 4 6 8 sampling points using mc method to quantify the uncertainty the uq results may fluctuate but in general they will gradually converge as the number of sampling points increases the comparison of uq results obtained by nipc method and mc method indicates that nipc method is more effective than mc method when the number of sampling points is fixed the higher the order of pce expansion the more accurate the uq results are the relatively simple two cases studied demonstrate that nipc method requires fewer sampling points compared with mc method thus is more efficient and it is easy to use in stochastic cfd problems on going and future work includes taking more uncertain parameters such as fluid properties manufacturing accuracy tolerance and boundary conditions into account investigating the effect of distribution of random variables analysing the effect of each stochastic parameter on the system response and applying the method to carry out robust design optimization of ship hydrodynamic performances credit authorship contribution statement li xia conceptualization methodology simulation formal analysis software visualization writing original draft zao jian zou methodology supervision writing review editing project administration zi hao wang methodology simulation formal analysis writing review editing lu zou methodology formal analysis supervision writing review editing funding acquisition hang gao methodology data processing investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grant no 51979164 
20551,usually computational fluid dynamics cfd simulations are carried out under deterministic conditions however there are actually many uncertain factors such as fluid properties boundary conditions and working parameters that may have effects on the system response it is critical to study the uncertainty propagation in the stochastic cfd model in this paper one of surrogate models for uncertainty quantification uq problems non intrusive polynomial chaos nipc is introduced stochastic two dimensional cavity flow with uncertain lid velocity is taken as a study case to verify the effectiveness of nipc method in comparison with monte carlo mc method the results show that nipc method can greatly improve the efficiency of uq the influence of velocity uncertainty has obvious directivity in the flow field and the fluid viscosity has retardation effect on uncertainty propagation then the nipc method is applied to quantify the uncertainty of resistance sinkage and trim of the japan bulk carrier jbc model advancing with an uncertain speed in shallow water numerical simulations are carried out using the rans based cfd method the uq results indicate that the uncertainty of relevant variables can be evaluated accurately with small samples and under the same sampling points the higher the order of polynomial chaos expansion pce the more accurate the uq results keywords uncertainty quantification non intrusive polynomial chaos cfd simulation jbc model shallow water nomenclature b wl waterline breadth m c coefficients of polynomial chaos c b block coefficient c m midship section coefficient d dimension of stochastic variables d moulded depth m h water depth m k g vertical distance of the centre of gravity from keel m i xx moment of inertia about ox axis kg m2 i yy moment of inertia about oy axis kg m2 i zz moment of inertia about oz axis kg m2 l pp length between the perpendiculars m n runs number of cfd runs n c number of coefficients in pce p order of pce dimensionless pressure t draught m u uniform distribution v ship speed m s y dimensionless wall distance δ nm kronecker delta function μ expected value ν fluid kinematic viscosity m2 s ξ stochastic variable ρ fluid density kg m3 σ standard deviation displacement volume m3 cdf cumulative density function cfd computational fluid dynamics dfbi dynamic fluid body interaction ev expected value fdm finite difference method fvm finite volume method ipc intrusive polynomial chaos jbc japan bulk carrier lcb longitudinal centre of buoyancy lhs latin hypercube sampling mc monte carlo nipc non intrusive polynomial chaos nmri national maritime research institute pce polynomial chaos expansion pdf probability density function rans reynolds averaged navier stokes rbf radial basis sd standard deviation srs stochastic response surface uq uncertainty quantification v v verification and validation vof volume of fluid 1 introduction conventional computational fluid dynamics cfd simulations are carried out under deterministic conditions the uncertainties caused by computation model and numerical method can be estimated by verification and validation v v however many uncertainties caused by stochastic factors are ignored which may increase the degree of mismatch between the stochastic reality problem and the deterministic cfd simulations as shown in fig 1 in a traditional model the input parameters are assumed to be fixed so that the model response is deterministic without any uncertainty uncertainty quantification uq attempts to determine how likely the results are if some aspects of the system are not fully clear in other words uq takes the distributions of the uncertain input parameters into account and the response becomes a range of possible values the goal of uq is to obtain the statistical properties of the response such as expected value ev standard deviation sd probability density function pdf and cumulative density function cdf several uq methods have been applied in stochastic cfd problems including monte carlo mc method perturbation method moment method and surrogate models mc method can solve linear nonlinear uq problems if computing resources are sufficient but the accuracy of uq results is affected by the number of sampling points mc method is often regarded as the last means to solve uq problems in engineering practice because of its prohibitive computing cost and time span perturbation method and moment method are viable to solve linear uq problems with small parameter uncertainty recently several advanced surrogate models are developed to investigate uncertainty propagation problems such as polynomial chaos expansions pce liu et al 2014 rodio and congedo 2014 feinberg and langtangen 2015 kumar et al 2016 wu et al 2017 low rank tensor approximations rai 2014 gaussian process modelling bilionis et al 2013 the radial basis function rbf volpi et al 2015 and machine learning methods such as artificial neural network ann cheng et al 2019 and the deep learning model tripathy and bilionis 2018 the pce method will be explained in detail in section 2 low rank tensor approximation is a minimization problem in which the cost function measures the fit between a given matrix the given data and an approximating matrix the optimization variables subject to a constraint that the approximating matrix has reduced rank kriging or gaussian process regression is a method of interpolation for which the interpolated values are modeled by a gaussian process governed by prior covariances under suitable assumptions on the priors kriging gives the best linear unbiased prediction of the intermediate values interpolating methods based on other criteria such as smoothness may not yield the most likely intermediate values the method is widely used in the field of spatial analysis and computer experiments an rbf is a real valued function whose value depends only on the distance between the input and some fixed point the distance is usually euclidean distance although other metrics are sometimes used rbf has a property i e at the centre the output influence is highest at each unit distance away from the centre in any direction the influence decays a polyharmonic spline is a linear combination of polyharmonic radial basis functions rbfs which is used for function approximation and data interpolation in this paper pce method is used it can be divided into intrusive method and non intrusive method according to whether the cfd solver needs to be modified or not normally in the intrusive method the governing equations to solve are reformulated to target a pce then the unknown coefficients of pce can be obtained by galerkin projecting it is hard and time consuming to solve the stochastic three dimensional viscous flow problem due to the significant modification of cfd codes xiu and karniadakis 2003 applied a generalized polynomial chaos method to investigate the uncertainty propagation in incompressible flow simulations wang and kang 2010 introduced the intrusive polynomial chaos ipc method and the coupling process with one dimensional euler equation the uncertainty of two dimensional stochastic cavity flow was quantified by using ipc method as for non intrusive polynomial chaos nipc method there are two different approaches to calculate the coefficients of pce one is the projection based method that uses a numerical calculation of galerkin integrals pereira et al 2013 used the projection based nipc method to study the blood model uncertainty induced by viscosity the other approach is the regression based method that solves an over determined system based on a selected set of points daróczy et al 2016 simulated the transient turbulent flow in an h darrieus turbine with variable pitch angle and angular velocity and quantified the uncertainty of the performance coefficient and the quasi periodic torque curve via regression based nipc method abraham et al 2017 proposed a sparse regression nipc method for high dimensional stochastic problems avdonin et al 2018 carried out uq and sensitivity analysis of thermoacoustic stability of a turbulent swirl combustor and a laminar slit burner using the regression based nipc method in recent years there has been an increasing interest in uq in cfd fields such as aerodynamics bio fluid mechanics reacting flows and porous media fluid mechanics as for ship hydrodynamics there exists a mass of stochastic factors such as fluid properties ship speed initial and boundary conditions geometry and mechanics parameters caused by manufacture process which may affect the hydrodynamic performance of the ship therefore it is of great significance to take these factors into consideration in the initial stage of ship design as for uq problems in the field of ship hydrodynamics a few works have been carried out he et al 2013a carried out uq studies of cfd based performance prediction for the delft catamaran 372 the results demonstrated the efficiency of pce method and the potentials in reliability based robust design optimization he et al 2013b studied the performance of the delft catamaran in irregular head waves and carried out uq analysis of the resistance motions and slamming loads of the ship in head sea with uncertain regular waves and geometry using kriging and polyharmonic spline methods the uq results showed that the ordinary kriging and polyharmonic spline are efficient surrogate models for the uq problems mousaviraad et al 2013 discussed the relationship and differences between the deterministic v v methodology and non deterministic uq methodology and proposed a framework for evaluating convergence and validation for stochastic uq problems diez et al 2014 measured the uncertainty of resistance sinkage and trim of the delft catamaran under variable froude number and geometry conditions using metamodel quadrature and karhunen loeve expansion volpi et al 2015 developed a dynamic metamodel based on stochastic rbfs and applied it to two industrial uq problems in ship hydrodynamics the delft catamaran with variable froude number and in variable regular head waves dash 2016 developed a stochastic response surface srs method for evaluating the uncertainty propagation of a twin propeller twin rudder ship in zigzag and turning circle manoeuvres the model uncertainty came from variation of propeller thrust and torque rudder normal force and rudder torque in the mathematical model of manoeuvring motion the uq results showed that the srs method is more efficient than the mc method stern et al 2017 provided a summary of the literature on uq and validation methods for the practical problems of ship hydrodynamics xia et al 2020 validated the efficiency of nipc method by studying a stochastic function in comparison with that of mc method and used the nipc method to study a stochastic problem of ship hydrodynamics the dtc model in shallow water waves whose height and period were treated as random variables with gaussian distribution the uncertainty of the resistance heave motion and pitch motion of the dtc model was quantified it should be noted that normally there are two aspects in uq problems the first one is to obtain the distribution of stochastic input variables from reliable data the second one strives to quantify the uncertainty of output variables this paper focuses only on the second aspect the rest of the paper is organized as follows section 2 introduces the pce method for uq problems in detail section 3 shows the validity of nipc method by investigating a two dimensional stochastic cavity flow problem in section 4 a stochastic problem in ship hydrodynamics the japan bulk carrier jbc model advancing with an uncertain speed in shallow water is studied section 5 outlines some conclusions drawn from this study 2 polynomial chaos expansion 2 1 definition of uq problems uq study is defined as the study to measure the uncertainty in the output y of a model or system affected by uncertain input parameters 1 y f x t ξ where ξ ξ 1 ξ 2 ξ d t is a vector of uncertain input parameters x is a space coordinate and t is the time usually it is difficult to obtain an explicit representation of the model f x t ξ thus a reasonable surrogate model is constructed to express the model approximately pce is a general expression that uses a linear combination of orthogonal polynomials to represent the functional relationship between the random input variables and the random response it is practicable to compute the statistic properties of random response via the surrogate model pce as stated in wiener 1938 if the f process is a square integrable function defined on hilbert space and the stochastic variables ξ j j 1 2 d are independent the response y can be rewritten as a series of orthogonal polynomial bases 2 y a 0 ψ 0 i 1 1 d a i 1 ψ 1 ξ i 1 i 1 1 d i 2 1 i 1 a i 1 i 2 ψ 2 ξ i 1 ξ i 2 i 1 1 d i 2 1 i 1 i p 1 i p 1 a i 1 i p ψ p ξ i 1 ξ i 2 ξ i p where a x t are the polynomial coefficients related to deterministic x and t and ψ ξ are the multivariate polynomials of stochastic input variables ξ the polynomial chaos representation truncated by dimension d of stochastic variables and polynomials of degree p is expressed as 3 y ˆ a 0 ψ 0 i 1 1 d a i 1 ψ 1 ξ i 1 i 1 1 d i 2 1 i 1 a i 1 i 2 ψ 2 ξ i 1 ξ i 2 i 1 1 d i 2 1 i 1 i p 1 i p 1 a i 1 i p ψ p ξ i 1 ξ i p to simplify the mathematical expression y ˆ can be rewritten as y ˆ i 0 n c 1 c i φ i according to the one to one correspondence between a and c ψ and φ mollon et al 2010 where n c is the number of polynomial coefficients φ ξ are orthogonal concerning the joint probability density function p ξ 4 φ n ξ φ m ξ φ n 2 ξ δ n m where δ nm is the kronecker delta function and the inner product is defined as 5 φ n ξ φ m ξ φ n ξ φ m ξ p ξ d ξ the uncertain input parameters are assumed to be independent thus p ξ can be expressed as 6 p ξ i 1 d p i ξ i the number of unknown coefficients c in eq 3 is 7 n c 1 p 1 1 p 1 p 1 2 p 1 2 p 1 d p 1 d p d p d 2 2 construction of pce ghanem and spanos 1991 developed the polynomial chaos method on the basis of the homogeneous chaos theory wiener 1938 in the early stages of the uq study the form of pce was hermite polynomials when the distribution of random variables was normal distribution there are two approaches to cope with other random variables with different distributions one is to map the random variables to standard normal distribution spaces table 1 lists the relationship between transformed pdf and univariate pdf for different distributions chutia et al 2014 the other is wiener askey polynomial chaos method xiu and karniadakis 2002 some of corresponding polynomials obtained by this method with respect to different distributions are presented in table 2 2 3 calculation of pce coefficients there are two main nipc methods for solving uq problems one is based on projection and the other is based on regression as for the projection based method the inner product of y ˆ and polynomial chaos φ j ξ is the projection of y ˆ in the direction of φ j ξ 8 y ˆ φ j ξ i 0 n c 1 c i φ i ξ φ j ξ c j φ j 2 ξ the polynomial coefficients can be obtained according to the orthogonality of the polynomial chaos basis 9 c j 1 φ j 2 ξ y ˆ φ j ξ p ξ d ξ hence the goal is to evaluate the integrals numerically however numerical integration technique suffers the curse of dimensionality the number of sampling points rockets exponentially as the dimension of random variables increases a more affordable method is regression based method which carries out a regression on a response surface it should be noted that the number of sampling points m is supposed to be 2n c according to hosder et al 2007 the random number generation technology adopted in this study is latin hypercube sampling lhs method giunta et al 2003 lhs is a stratified sampling method for generating sampling points from a multidimensional distribution it is widely used in mc simulation because it can drastically reduce the number of runs necessary to achieve a reasonably accurate result lhs is based on the latin square design which refers to a square matrix with only one sample per row and column latin hypercube is a multidimensional generalization of latin square each hyperplane perpendicular to the axis contains at most one sample the computations are carried out according to the conditions determined by the sampling points the responses are expanded as follows 10 φ 0 ξ 1 φ n ξ 1 φ 0 ξ m φ n ξ m c 0 c n f ˆ x t ξ 1 f ˆ x t ξ m the compact form is 11 φc y ˆ the vector c can be computed via the least square method 12 c φ t φ 1 φ t y ˆ when all the polynomial coefficients are determined the statistical properties of the response variable like ev and sd can be obtained wang and kang 2010 13 μ x t d ξ y ˆ ξ p ξ d ξ d ξ j 0 n c 1 c j x t φ j ξ p ξ d ξ c 0 x t d ξ φ 0 p ξ d ξ j 1 n c 1 c j x t d ξ φ j ξ p ξ d ξ c 0 x t φ 0 j 1 n c 1 c j x t d ξ φ 0 φ j ξ p ξ d ξ c 0 x t 14 σ 2 x t d ξ y ˆ μ x t 2 p ξ d ξ d ξ y ˆ c 0 x t φ 0 2 p ξ d ξ d ξ j 0 n c 1 c j φ j ξ j 0 n c 1 c j φ j ξ 2 c 0 φ 0 j 0 n c 1 c j φ j ξ c 0 2 φ 0 2 p ξ d ξ i 0 n c 1 j 0 n c 1 d ξ c i c j φ i ξ φ j ξ p ξ d ξ c 0 2 φ 0 2 j 0 n c 1 c j 2 d ξ φ j 2 ξ p ξ d ξ c 0 2 φ 0 2 j 1 n c 1 c j 2 x t d ξ φ j 2 ξ p ξ d ξ j 1 n c 1 c j 2 x t φ j 2 ξ the pdf and cdf of the response variables can be approximated by the kernel density estimation technique mendes et al 2011 2 4 workflow of the nipc method the nipc method is implemented via the following steps 1 preprocessing determine the distribution of the stochastic variables then the form of pce can be determined according to table 2 and the orthogonal polynomials can be constructed by gram schmidt orthogonalization or three term recursion 2 sampling generate the sampling points where the model will be calculated under these conditions using projection based nipc method quadrature points and quadrature weights can be determined while using regression based nipc method random sampling points can be generated by a random number generator like lhs 3 calculating calculate the model under the conditions sampling points this step is most time consuming 4 postprocessing evaluate the coefficients of pce based on the form of pce obtained in step 1 and the results of output variables calculated in step 3 then compute the statistical characteristics of output variables such as ev and sd using eq 13 and eq 14 3 case of stochastic cavity flow in this section a two dimensional stochastic cavity flow as shown in fig 2 is studied the computational domain is a square cavity with both length and height of 2 the velocity components in the x and y directions are denoted by u and v the fluid kinematic viscosity ν and density ρ are 0 1 and 1 0 respectively all values in this case are dimensionless 3 1 governing equations and boundary initial conditions the governing equations two equations for the velocity components u v and one equation for the pressure p are as follows 15 u t u u x v u y 1 ρ p x ν 2 u x 2 2 u y 2 v t u v x v v y 1 ρ p y ν 2 v x 2 2 v y 2 2 p x 2 2 p y 2 ρ u x u x 2 u y v x v y v y the velocity of the lid driven is set as a stochastic parameter that satisfies normal distribution u lid n 1 0 0 12 reynolds number is about 20 and the flow is laminar the walls around are all no slip other boundary conditions are u v 0 on the other boundaries p y 0 at y 0 p 0 at y 2 p x 0 at x 0 2 the initial condition is u v p 0 at t 0 3 2 numerical solution the governing equations are solved using finite difference method fdm the structured mesh is 40 40 fig 3 shows the streamline pattern and pressure profile of the cavity flow under the deterministic condition it can be seen that there exists a large vortex close to the lid two corner vortexes locate at the upper corners it is a typical pattern of lid driven cavity flow 3 3 application of the nipc method this sub section shows the specific process of uncertainty quantification based on the nipc method in the case of stochastic cavity flow the lid velocity is normally distributed so the pce is of the form hermite polynomial according to table 2 pce can be calculated using gram schmidt orthogonalization method in this paper the pce is expanded to 4th order as 16 y ˆ c 0 c 1 u l i d 1 c 2 u l i d 2 2 u l i d 0 99 c 3 u l i d 3 3 u l i d 2 2 97 u l i d 0 97 c 4 u l i d 4 4 u l i d 3 5 94 u l i d 2 3 88 u l i d 0 9403 where y ˆ represents the output variable of interest to demonstrate how to calculate the coefficients of the pce four points x 1 y 0 05 0 1 0 15 0 2 are chosen as examples the velocity component u is taken as the system response and the uncertainty is quantified based on the results of 30 model runs based on the surrogate model eq 16 and the results of 30 runs the coefficients can be calculated using eq 12 eq 17 lists the surrogate models of the four points 17 u ˆ x 1 y 0 05 0 01553 0 00529 u l i d 1 0 00836 u l i d 2 2 u l i d 0 99 0 06068 u l i d 3 3 u l i d 2 2 97 u l i d 0 97 0 34773 u l i d 4 4 u l i d 3 5 94 u l i d 2 3 88 u l i d 0 9403 u ˆ x 1 y 0 1 0 02941 0 00911 u l i d 1 0 01638 u l i d 2 2 u l i d 0 99 0 12392 u l i d 3 3 u l i d 2 2 97 u l i d 0 97 0 67465 u l i d 4 4 u l i d 3 5 94 u l i d 2 3 88 u l i d 0 9403 u ˆ x 1 y 0 15 0 04205 0 01171 u l i d 1 0 02408 u l i d 2 2 u l i d 0 99 0 19142 u l i d 3 3 u l i d 2 2 97 u l i d 0 97 0 98619 u l i d 4 4 u l i d 3 5 94 u l i d 2 3 88 u l i d 0 9403 u ˆ x 1 y 0 2 0 05369 0 01333 u l i d 1 0 03140 u l i d 2 2 u l i d 0 99 0 26355 u l i d 3 3 u l i d 2 2 97 u l i d 0 97 1 28307 u l i d 4 4 u l i d 3 5 94 u l i d 2 3 88 u l i d 0 9403 then the ev and sd of these points can be calculated using eq 13 and eq 14 uq results for other points can be obtained in a similar way 3 4 comparison between nipc method and mc method in order to verify the efficiency of nipc method the uq results of the velocity component u at the vertical centre line x 1 obtained by 10 000 mc simulations serve as a standard for comparison the comparison between nipc method and mc method is carried out under the condition of small samples fig 4 shows the uq results based on 30 50 80 samples using nipc method and mc method from the histograms it can be seen that the absolute errors of ev and sd calculated by nipc method are less than those by mc method in most places as shown in fig 4 a and e the absolute error of ev calculated using nipc method can reach less than about 0 003 when the sample size is 30 while 80 samples are required to achieve the same accuracy when using mc method similarly as far as sd is concerned mc method requires more than 80 samples to achieve the accuracy obtained by nipc method using only 30 samples this indicates that when the sample size is small nipc method can quantify the uncertainty more efficiently 3 5 analysis of the results the discussion in this sub section focuses on the uncertainty of the flow velocity namely the distribution of velocity components u and v under the influence of uncertain lid velocity fig 5 shows the ev and sd of velocity components on the horizontal centre line y 1 and vertical centre line x 1 respectively the sd refers to the uncertainty range as shown in fig 5 a under the influence of the main vortex v fluctuates with two peaks located around the vortex while there is only one peak in the curve of u from the dotted line representing the sd it can be seen that the uncertainty of lid velocity propagates into the cavity flow and the effect differs along the horizontal centre line the greatest uncertainty occurs at the place where the velocity is largest as fig 5 b shows the randomness of lid velocity has less influence on v than on u which is in line with intuition as for u it has the largest uncertainty on the upper boundary as the distance to the lid with uncertain velocity increases the uncertainty decreases first and then reaches the local maximum at around y 0 75 fig 6 shows the contours of sd of velocity components u and v the maximal value of sd of u appears at the upper lid there are another two peaks which locate near below the core of the main vortex as for the distribution of sd of v two peaks exist on the left and right sides of the core of the main vortex it can be seen that the influence of velocity uncertainty has obvious directivity in the flow field and the convective effects of flow dominate the propagation of the uncertainty in order to investigate the effect of viscosity ν on the propagation of uncertainty two more cases ν n 0 05 0 005 2 and ν n 0 01 0 001 2 are studied under the same other conditions fig 7 shows the comparison of sds of velocity components for three different evs of viscosity as can be seen the sd for ev ν 0 01 is much larger than those of other two at most places the sd for ev ν 0 05 is the second largest in other words the greater the viscosity the more hindered the propagation of uncertainty the cause of this phenomenon is easy to understand from the view of viscosity property as the fluid viscosity increases the viscous force between the fluid particles gets larger this increases the retardation effect the increased viscous diffusion keeps the flow field more uniform as viscosity increases the ability to resist the effects of uncertainty increases 4 study case japan bulk carrier with stochastic speed ship speed is one of the most important properties of a ship and affects ship s usability and navigation efficiency prediction of ship resistance is of great importance because a ship designed with good resistance performance can ensure good economic performance when a ship sails in shallow water the ship s squat sinkage and trim and resistance will increase because of the hydrodynamic interaction between the hull and the seabed there are four main methods for predicting ship s squat and resistance empirical method analytical method experimental method with ship model and numerical method tezdogan et al 2016 analyzed the hydrodynamic performance of the dtc model with different ship draughts under different ship speeds by using cfd based numerical method the squat results were compared with experimental data terziev et al 2018 investigated the hydrodynamic behavior of the dtc model when advancing through restricted shallow waters by using three methods i e cfd slender body theory and empirical methods and good agreement was shown among the results obtained by the different methods traditionally prediction of ship hydrodynamic performance is carried out under deterministic conditions however a ship may not be able to maintain a constant speed in reality this section studies the application of nipc method in cfd based uq of ship resistance sinkage and trim with variable ship speed for the jbc model 4 1 geometry and simulation conditions the jbc is a capesize bulk carrier with an esd energy saving device and the hull lines and profile view are shown in fig 8 the main particulars of the jbc model are listed in table 3 the conditions of simulations refer to the benchmark cases of the national maritime research institute nmri in this paper the simulations of model tests are conducted for the ship model with an esd and without rudder propeller and the shallow water case with h t 1 515 is considered the ship speed is set as an uncertain variable with normal distribution v n 1 179 0 1179 2 the conditions of the ship speed are obtained by the lhs method the pce is expanded to first second and third order which requires 4 6 and 8 sampling points respectively with respect to one random input variable table 4 lists the specific values of the stochastic ship speed m s 4 2 cfd simulation the flow around the ship model is a three dimensional flow of incompressible viscous fluid which is governed by the reynolds averaged continuity equation and reynolds averaged navier stokes rans equations closure of the governing equations is achieved by using the realizable k ε turbulence model in this study the general cfd software package star ccm is used the numerical method for partial differential equations is finite volume method fvm the volume of fluid vof method is used to simulate the free surface in order to determine ship s sinkage and trim dynamic fluid body interaction dfbi module is used 4 3 computational domain and boundary conditions fig 9 shows the computational domain and the boundary conditions due to the symmetry of the flow with respect to the longitudinal centreplane of the hull only half of the flow field is considered it is suggested in cd adapco 2020 that the velocity inlet of the computational domain for resistance prediction should be located at least one ship length upstream of the fore perpendicular and the pressure outlet should be positioned at least two ship lengths downstream of the aft perpendicular according to the recommendation a velocity inlet condition is imposed on the inlet located 1 5 l p p upstream of the fore perpendicular the outlet is set as a pressure outlet to prevent backflow and is positioned 3 5 l p p downstream of the aft perpendicular on the hull and the bottom of the domain no slip wall conditions are imposed the bottom surface is located at the vertical position corresponding to the considered water depth h t 1 515 it should be noted that in the cfd simulation the hull is set to be immobile due to the relative motion of the fluid to the hull so the bottom is set to move with the same velocity as the incoming flow the top side of the domain is placed 1 0 l p p above the undisturbed free surface and the back side of the domain is located 1 5 l p p from the longitudinal centreplane of the hull the surfaces of the top and back sides are treated as velocity inlet a vof wave damping option is enforced to eliminate the wave reflection from the boundaries the vof wave damping length is set as 1 25 l p p a symmetry boundary condition is imposed on the surface of the front side that is located on the longitudinal centreplane of the hull 4 4 mesh generation and time step selection the mesh generation is carried out by the trimmed cell mesher in star ccm the generated meshes are mainly hexahedral unstructured meshes in the fluid domain and polyhedral trimmed meshes near the hull surface the meshes on the hull surface are locally denser with a greater mesh densifying ratio on the bow and transom the meshes near the free surface are densified vertically and the ones in the wave region are densified both laterally and vertically the meshes of the hull boundary layer and the bottom of the computational domain are generated by the prism layer mesher with 18 layers and a growth rate of 1 5 the y value which characterises the height of the first layer of the boundary layer meshes is controlled to be within 1 in order to use the low re y treatment fig 10 shows the generated mesh from different views fig 11 gives a graphical representation of y distribution on the hull and the bottom of computational domain the number of meshes generated in each case is approximately one million it is recommended by ittc 2011 that for ship resistance prediction the time step should be in the bound δt 0 005 0 01 l p p v in this paper the time step is set to 0 04s 0 006737 l p p v first order temporal discretization is selected in the implicit unsteady module which has been shown to obtain good convergence and stable results in similar studies such as tezdogan et al 2016 and terziev et al 2018 the maximum number of inner iterations for each unsteady time step is set to 10 4 5 results and discussion for deterministic cfd computations v v studies were performed using grid convergence index gci method to assess the numerical and modelling errors xia et al 2017 monotonic convergence was achieved numerical uncertainty was predicted and numerical solutions were evaluated against experimental data the present study mainly focuses on uq studies computation results of resistance sinkage and trim are processed using the regression based nipc method in order to quantify the uncertainty of the output variables induced by the uncertain ship speed table 5 lists the first second and third order pce with respect to one random variable the uncertain ship speed obeying normal distribution v n 1 179 0 1179 2 table 6 presents the results of cfd simulations under corresponding operating conditions in table 4 the coefficients of pce are calculated using least square method based on the polynomials in table 5 and the numerical results in table 6 in this section nine models have been studied mc based on 4 6 8 cfd runs first order pce based on 4 6 8 cfd runs second order pce based on 6 8 cfd runs and third order pce based on 8 cfd runs fig 12 shows the computed statistical properties of three output variables the total resistance sinkage and trim as the 3 bars at the top of each subgraph illustrate the uq results of the second order pce based on 6 cfd runs the second order pce based on 8 cfd runs and the third order pce based on 8 cfd runs are very close usually with the increase of the order of pce and the number of sampling points the statistical properties of the output variables obtained by nipc method tend to converge hosder et al 2007 thus the ev and sd computed by the third order pce based on 8 cfd runs p 3 n runs 8 can be considered as the most accurate result among all the results and used as a benchmark and the sd obtained by the surrogate model p 3 n runs 8 can be considered as the expected uncertainties as the 3 bars at the bottom of each subgraph show comparing the uq results obtained by mc method the results are not always convergent as the number of sampling points increases as for the evs of three output variables the results obtained by mc method based on 6 cfd runs instead of 8 cfd runs are more close to the benchmark result generally the uq results tend to converge gradually with the increase of sampling points however the randomness introduced by the generation algorithm of random numbers causes the fluctuation of uq results as for the sds the results obtained by mc method tend to get close to the benchmark result with the increase of sampling points the other 3 bars in the middle of each subgraph represent the uq results obtained by the models of polynomial chaos of order p 1 with 4 6 8 cfd runs it can be seen that with the increase of sampling points the values of both ev and sd are getting closer and closer to the benchmark result to illustrate the above conclusions more intuitively fig 13 presents the relative errors of ev and sd of the uq results compared with the benchmark result by comparing the results of the two surrogate models p 1 n runs 6 and p 2 n runs 6 it can be found that under the same number of sampling points the higher the order of pce the more accurate the uq results are the same conclusion can be drawn by the comparison between the surrogate models p 2 n runs 8 and p 3 n runs 8 in general nipc method can obtain more accurate uq results under small samples compared with mc method 5 conclusions this paper introduces a state of the art uq method nipc method firstly the stochastic behavior of a lid driven cavity flow affected by the uncertain lid velocity is studied using nipc method together with mc method the uq results show that nipc method is more effective than mc method the results of uncertainty propagation induced by the stochastic driven velocity show that the influence of the velocity uncertainty has obvious directivity in the flow field the viscosity of fluid has retardation effect on uncertainty propagation and the influence of stochastic parameters on uncertainty propagation in the flow decreases with the increase of viscosity then the uq problem of cfd simulations of the viscous flow around the jbc model advancing in shallow water is studied this case focuses on the influence of the pce order and the number of sampling points on the uq results by investigating the response of the jbc model in shallow water with the uncertain speed using mc method and nipc method the output variables of interest are resistance sinkage and trim the pce is expanded to first second and third order respectively with respect to 4 6 8 sampling points using mc method to quantify the uncertainty the uq results may fluctuate but in general they will gradually converge as the number of sampling points increases the comparison of uq results obtained by nipc method and mc method indicates that nipc method is more effective than mc method when the number of sampling points is fixed the higher the order of pce expansion the more accurate the uq results are the relatively simple two cases studied demonstrate that nipc method requires fewer sampling points compared with mc method thus is more efficient and it is easy to use in stochastic cfd problems on going and future work includes taking more uncertain parameters such as fluid properties manufacturing accuracy tolerance and boundary conditions into account investigating the effect of distribution of random variables analysing the effect of each stochastic parameter on the system response and applying the method to carry out robust design optimization of ship hydrodynamic performances credit authorship contribution statement li xia conceptualization methodology simulation formal analysis software visualization writing original draft zao jian zou methodology supervision writing review editing project administration zi hao wang methodology simulation formal analysis writing review editing lu zou methodology formal analysis supervision writing review editing funding acquisition hang gao methodology data processing investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grant no 51979164 
20552,the vulnerability of a reinforced concrete rc girder bridge pier is numerically assessed using high and moderate resolution finite element fe simulations in ls dyna under the combination of vessel collisions and blast loadings the damage levels of the pier under combined loads are quantitatively assessed by proposing three different damage indices based on the residual axial load shear and flexural moment capacities of the pier column obtained through a series of multi step loading procedures on the simplified fe based model of the pier in addition the proposed simplified model of the pier is employed for sensitivity assessments of the damage indices of the pier to several loading related parameters including the vessel type the location of applied loads the impact velocity and the time lag between the initiations of loadings from the fe simulations it is found that the pier undergoes more severe localized failure when both impact and blast loads are applied at the same elevation on the pier column which is more likely to occur during barge collisions moreover it is found that the pier experiences greater internal forces when the sequent blast loading is applied at the occurrence time of the peak impact force keywords combined impact blast loading vessel collision bridge pier pier collapse local failure global shear failure 1 introduction bridges as the strategic structures may be exposed to dynamic and impulsive loads such as impact and blast loads during their service life the bridge failures have been reported in many cases all over the world due to the collision of vehicles or vessels and explosion loadings harik et al 1990 wardhana and hadipriono 2003 lee et al 2013 harik et al 1990 classified the bridge failures that occurred in the u s due to various causes during the period 1951 to 1988 it was reported that 42 cases of 79 i e about 53 bridges collapsed due to collisions in which 19 cases 24 caused by ships 11 cases 14 by trucks and 6 cases 8 by trains besides in 4 cases 5 the bridges collapsed due to the exploding or burning of fuel tanker trucks based on a study done by wardhana and hadipriono 2003 from 1989 to 2000 in the u s 12 of the total bridge failures occurred due to lateral impact forces arising from the collision of trucks barges ships and trains and 3 of the failures caused by fire and explosions from 2000 to 2008 according to a study by lee et al 2013 from 1980 to 2012 in the u s 15 3 and 2 8 of failures were due to collisions and fire and explosions respectively since the bridge piers play vital roles in the reliability and fail safe of the whole bridge structure because of their low redundancy compared to bridge decks and superstructures recognizing the failure behaviors and dynamic responses of bridge piers under extreme loads is very important to safely design and adopt efficient solutions for the vessel collision studies the impact force deformation relationships from low velocity consolazio and cowan 2003 and high velocity kantrales et al 2015 barge collisions with bridge piers were studied compared to the marginal effects of the pier size on the force deformation results consolazio and cowan 2003 found that the pier shape and geometry have significant influences on the impact forces besides as the high energy barge collision studies with bridge piers kantrales et al 2015 concluded that the collision with flat faced piers resulted in greater impact forces than those of round faced piers consolazio et al 2006 carried out a series of full scale experimental tests of barge collisions with the old st george island bridge to capture a total insight into the behaviors of impacting vessel and struck structure in real life afterwards some analytical methods were proposed by several previous research works consolazio and cowan 2005 consolazio and davidson 2008 fan et al 2010 to achieve the impact responses of both the vessel and impacted structure in simplified manners consolazio and cowan 2005 proposed a coupled vessel impact analysis cvia method in which an sdof vessel model collides with an mdof pier model i e medium resolution technique thereafter the proposed coupled cvia used to analyze the dynamic responses of an equivalent one pier two span opts simplified bridge model proposed by consolazio and davidson 2008 in which the effects and characteristics of adjacent piers and spans were considered using a series of equivalent translational and rotational springs attached to a lumped mass of adjusted piers and spans from an analytical study on ship pier collisions done by fan et al 2010 it was obtained that the strain rate effects of the steel materials used for the vessel bow had significant positive influences on the impact forces however the impact duration was negatively affected by the strain rate effects the amplification effects of structural dynamic parameters of the superstructure such as inertia on the impact responses of girder bridge piers were numerically investigated by davidson et al 2010 and gholipour et al 2019a some of the previous works considered different approaches such as energy based gholipour et al 2018a and reliability gholipour et al 2019b methods to analyze the responses of impacted structures gholipour et al 2018a revealed the significant effects of soil pile interactions on the dynamic responses of girder bridge piers using an energy distribution method fig 1 shows the typical failure modes of rc bridge piers under different collision loads based on observed real collision events and reported by buth et al 2010 different modes of shear failure including a punching shear failure or shear plug a shear hinge i e a shear failure mode that commonly occurs at the mid height of the pier and a diagonal shear failure originating from the impact point and extending to the column base are illustrated in fig 1a c respectively according to the literature agrawal et al 2018 buth et al 2010 do et al 2018 gholipour et al 2018b 2019b zhang et al 2020a shear failure modes commonly take place when bridge piers are subjected to high velocity collision loads under such loading conditions bridge columns suffer brittle failures which would increase the probability of the whole collapse of the bridge besides rc bridge piers may experience combined flexural shear failure mode and minor flexural damages as illustrated in fig 1d and e respectively when they are exposed to collision loads with relatively lower impact velocities although the progression of combined flexural shear damages may lead to the formation of a plastic hinge during the following stages of impact responses more time would be provided until the whole collapse i e a higher chance of survival compared to shear failure modes the damaged states and failure behaviors of rc bridge piers with the nonlinearity under vessel collisions were numerically evaluated in several research works gholipour et al 2018b 2020a wan et al 2019 however the dynamic strain rate effects of both concrete and steel materials on the dynamic responses were not taken into account in these studies gholilpour et al 2018b revealed the dynamic amplification and significant positive influences of the superstructure inertia on the peak impact forces moreover the sensitivity thresholds of the lateral resistance of the columns to the axial load ratio were explored it was found that the axial load positively affects the lateral resistance of rc columns when its ratio was between the ranges from 0 3 to 0 5 recently wan et al 2019 experimentally studied the scaled ship collisions with rc piers with the variability of the impact velocity and the dynamic parameters related to the steel materials used in the ship bow it was found that the nonlinearity of the concrete material used for the pier was substantially effective on the impact responses when under relatively high energy collisions the nonlinear dynamic responses and progressive damage process of a cable stayed rc bridge pier were numerically studied by gholipour et al 2020a in ls dyna furthermore the concrete strain rate effects were analytically formulated by proposing a simplified two degree of freedom system the capability of various proposed damage indices was assessed to explore a more efficient approach in describing the damage states of the impacted pier the failure behaviors of bridge piers under close in and far field explosions have been also investigated experimentally williamson et al 2011 and numerically hu et al 2016 in the literature the typical failure modes of rc bridge piers under different blast loads are illustrated in fig 2 based on large scale experimental blast tests as documented in williamson et al 2010 fig 2a c shows three types of severe damage states of rc columns under close in blast loads including brittle shear failure mode at the column base extensive spallation of concrete cover medium spall along with a shear failure and severe spallation leading to the breach of the cross section respectively according to a classification on spall damage of rc structures under different blast loads presented by mcvay 1988 and reviewed by zhang et al 2020b threshold spall represents a few cracks and exfoliation of concrete cover medium spall denotes a damaged state from a shallow spall to a third of the column thickness severe spall represents from over third of the column thickness to almost breach and the beach denotes the formation of light through to large hole in the cross section of columns besides rc columns may endure two typical failure modes including local spall and exfoliation of concrete cover threshold spall and flexural cracks as shown in fig 2d and e respectively under far field detonations with relatively large scaled distances the influences of various structural parameters including the cross sectional shape height reinforcement ratio type of transverse reinforcement and loading parameters such as the scaled standoff location of the explosion the blast responses of rc piers were assessed using different parametric studies by williamson et al 2011 and hu et al 2016 williamson et al 2011 revealed that although the square columns have larger areas exposed to the overpressure of close in blast loads than circular columns greater resistances against shear failure were provided by square shaped piers than round shaped columns in addition more severe spallation was observed in rc columns with increasing the height of blast loading location due to expanding the area exposed to striking blast waves hu et al 2016 the dynamic responses and failure behaviors of various types of rc structures under impact and blast loads have been comprehensively reviewed by zhang et al 2020a 2020b the responses of simply supported rc beams under the combination of close in blast loads with the middle rate impacts were studied zhang et al 2019 by varying several structural and loading related parameters it was found that the applying of the impact load before the detonation resulted in more severe spall damages in the beam cross section afterwards by evaluating the impact loading rate effects on the blast responses of simply supported rc beams by gholipour et al 2019c it was concluded that the damage index based on the shear forces at the supports was more sensitive to the increase of the impact velocity when the sequent detonation was initiated at the time of the initial peak impact force moreover the vulnerability of an axially loaded rc column to several loading parameters was assessed by gholipour et al 2019b subjected to synergetic effects of impact and blast loads it was revealed that the sensitivity level of the column failure to impact velocity and axial load ratio parameters decreased under combined loadings compared to those under sole impact and blast loads despite the aforementioned studies above investigating the responses and behaviors of rc bridge piers under the combination of impact and blast loadings is the gap of previous research works the combined actions of impact and blast loadings may be applied to bridges during accidental or intentional i e terrorist attacks collision of vessels vehicles etc which can carry explosive materials although the occurrence of such loading combinations has not been reported yet it is worthy to investigate the loading mechanisms and the structural behaviors to capture some insights into the protective design of bridges against such combined loadings based on a review study on the security recommendations for bridges and tunnels roberts et al 2003 it was declared that although blast loads arising from car bombs have the highest probability to happen applying blast loadings by vessels on bridge piers located at major waterways are also very likelihood besides the explosions by vessels may provide more intensive loading conditions due to the larger cargo carrying capacity of vessels than vehicles therefore the paper aims to ideally exercise the basic theory and the possible scenarios of the combination of impact and blast loadings on a typical rc girder bridge pier to this end the dynamic responses internal forces and failure behaviors of a typical rc girder bridge pier with two columns are numerically investigated with high and moderate resolutions in ls dyna 2015 under vessel collisions combined with blast loadings moreover the vulnerability of the bridge pier is quantitatively assessed varying in terms of several loading related parameters including the vessel type impact weight impact velocity the location of loadings and the time lag between the initiations of the applied loads by proposing three damage indices based on the residual axial load shear and flexural moment capacities of the pier column the residual capacities of the pier are obtained through a series of multi step loading procedures applied to the simplified fe based model of the pier with a moderate resolution in organizing the methodology for the loading scenarios in this study the collision of only two typical vessels including 2000 dwt jumbo hopper barge and 5000 dwt container ship which commonly navigate in inland waterways of the u s and china with moderate design velocities 4 m s for ship and 1 65 m s for barge are considered for the high resolution fe simulations that carry 200 kg and 500 kg tnt as the explosive materials on their deck level of rear portions respectively 2 fe modeling of vessels and bridge pier in this section the fe models of a typical bridge pier and striking vessels are described in detail then the calibration of fe models is carried out by comparing the simulation results from the present study and those from the previous experimental and numerical studies existing in the literature 2 1 fe modeling of vessels two typical vessels varying in terms of the bow configuration deadweight tonnage dwt and velocity are considered in this study one of these vessels is a 5000 dwt container ship with a total length of 121 m and a scantling draught of 5 0 m as shown in fig 3 a the details of fe models of the ship bow including the internal stiffeners and the outer plates are illustrated in fig 3a based on the design characteristics available in the literature fan and yuan 2014a 2014b 2014b another vessel is a 2000 dwt jumbo hopper barge with a total length of 59 4 m a depth of 4 26 m in the bow portion and a loaded draft of 2 56 m as shown in fig 3b according to design specifications available in aashto 2009 based on the design drawings presented by kantrales et al 2015 the details of fe models of the internal trusses and frames used in the bow portion of the barge are also illustrated in fig 3b all internal structures and outer plates used in the bow portions of the vessels are modeled using hughes liu shell elements with five integration points through the thickness lstc 2016 the steel plates modeled using shell elements in the bow portions have thicknesses range from 6 mm to 18 mm with mesh sizes between 50 mm and 150 mm to accurately predict the impact forces localized buckling and crushing behaviors during head on collisions to avoid any penetration between the structural components and take into account the possible secondary contacts during the collision a contact algorithm named automatic single surface is used in ls dyna between the internal and outer steel plates in the bow portions of the vessels with static and dynamic friction coefficients of 0 21 as recommended by previous studies yuan 2005 wan et al 2019 moreover to simplify and reduce the computation time of the fe simulations the non bow stern portions of the vessels are modeled using 8 node solid elements with coarse meshes by adopting a rigid material model named mat rigid mat 020 lstc 2016 since it is not expected to observe significant deformations in these portions the cargo weights of the vessels are adjusted using a mass distribution method in the stern portions in this method the cargo weights of the vessels herein vessels with fully loaded cargo capacities are divided into the total volume of the stern portions and applied to the mass density parameter of the material model defined in ls dyna for the rigid elements of the stern portions as given in table 1 it is noteworthy that a 10 added mass is considered for the stern portions of the vessels to take into account the hydrodynamic effects during fe simulations an elastic plastic material model named mat plastic kinematic mat 003 in ls dyna which represents the isotropic and kinematic hardening behaviors considering the strain rate effects of the steel material is used for the steel plates of the vessels bow portions the stress strain characteristics of a structural steel a36 with a failure strain of 0 25 are employed based on the standard specification for carbon structural steel astm 2008 to input in the material model of the steel plates used in the bow portions as given in table 1 also getter et al 2015 recommended adopting the average of the failure strain range from 0 2 to 0 4 for mild steel a36 since no significant sensitivity was observed to the use of failure strain over this range in this study the strain rate effects of the steel materials are modeled using cowper symonds coefficients of c 40 4 s 1 and p 5 0 in the properties of mat 003 in ls dyna these values have been widely used by many research works in the literature kantrales et al 2015 gholipour et al 2020a fan and yuan 2014b fan et al 2018 jones 2011 investigating the collision behaviors of vessels modeled using the dynamic characteristics of the materials of mild steel especially a36 steel according to the study done by symonds 1967 the basis for utilizing these values for cowper symonds coefficients is the dynamic stresses of various steel materials resulted from extensive experimental tests conducted by manjoine 1944 the strain rate parameters can be calculated using cowper and symonds s formulas as follows jones 2011 1 σ d σ s 1 ε c 1 p where σ d is the dynamic flow stress at uni axial plastic strain rate ε and σ s is the static flow stress c and p are the constants of steel material 2 2 fe modeling of bridge a typical rc girder bridge pier with two hollow section columns with the height of 38 8 m a piles cap with a thickness of 3 5 m fourteen concrete piles with 2 0 m in diameter and 98 0 m in height is considered to study under vessel collisions combined with blast loads as shown in fig 4 the detailed dimensions and elevations of the bridge pier and superstructure are illustrated in figs 4 and 5 a all the concrete material of the pier superstructures are modeled using constant stress solid elements in ls dyna however the reinforcements are modeled using 3 node beam elements in ls dyna as shown in fig 4a with considering minimum design requirements defined by design codes such as aci 318 2014 in which the longitudinal rebars have ratios between 2 and 4 also a coupling algorithm named constrained lagrange in solid is utilized to model the interaction between the concrete and the reinforcement bars fig 5b demonstrates the reinforcement configurations used in different parts of the bridge from the previous studies consolazio and davidson 2008 it was found that considering a part of the bridge with one pier and two adjacent spans can accurately capture the dynamic responses of the multi span bridge therefore only two spans of twin cell box girder superstructures with lengths of 70 0 m and weights of 25 5 tons per unit length placed on the pier top are considered as shown in fig 4 accordingly the weight of the superstructure with a partial length of 70 m is 1785 tons 70 25 5 which is equal to 10 of the axial load carrying capacity of the pier other ends of the superstructures are freely sitting on the rigid and fixed supporters it should be noted that an open joint was considered between the adjoining decks to avoid the significant contact forces developed during the closure of the deck joint due to the substantial displacements of the pier from the previous studies el tawil et al 2005 do et al 2018 it was concluded that utilizing bearing pads between the pier and superstructures had marginal influences on the impact loads and the responses of bridge piers therefore a contact algorithm named automatic surface to surface is used to model the stiffness between the concrete to the concrete surface of the superstructures and the cap beam of the pier with a friction coefficient of 0 6 as recommended in the literature aci 2014 do et al 2018 in instead of modeling the bearing pads to reduce the computational time of fe simulations also like as the previous studies sha and hao 2012 el tawil et al 2005 consolazio and cowan 2003 a similar contact algorithm with static and dynamic friction coefficients of 0 3 was used between the steel and concrete surface of the ship bow and the bridge pier table 2 summarizes the contact algorithms utilized between various components of the bridge with assumed friction coefficients based on the previous studies moreover it is assumed that the piles are surrounded by the soil with a mudline elevation of 8 0 m beneath the lower surface of the piles cap as shown in fig 5a also the interaction between the concrete piles and the soil layer in the near field is modeled using a contact algorithm named automatic nodes to surface with static and dynamic friction coefficients of 0 26 in ls dyna as recommended by brumund et al 1973 between the contact surface of silty i e clay sand soil and concrete materials as presented in table 2 to prohibit the reflection of stress waves from the boundaries the soil behaviors in the far field are modeled using non reflecting boundary conditions in ls dyna similar to the procedure employed in the literature fan yuan 2014b in ls dyna the infinite domain of soil layers is modeled using an artificial boundary condition named boundary non reflecting in modeling this boundary condition to avoid any exaggerated deformations occurred in the exterior boundary the fe model of surrounding soil contains two zones including i the near field soil modeled using nonlinear material and ii the far field soil modeled using a linear elastic material the nonlinear behavior of the soil surrounding the piles in the near field is modeled using an elastic plastic model mat mohr coulumb mat 173 with assuming the reasonable characteristics as given in the literature gholipour et al 2018a fan and yuan 2014b the material properties assumed for the various components of the bridge are summarized in table 3 the nonlinear damage behaviors of the concrete material are modeled using a continuous surface cap model cscm named mat cscm concrete mat 159 murray 2007 which captures some key mechanical characteristics of the concrete such as the pressure and strain hardening this model is easily available to use in ls dyna by inputting several parameters of concrete material including unconfined compression strength of concrete f c the element erosion i e the elimination of fe elements parameter erode and the maximum aggregate size dagg which profoundly governs the fracture energy murray 2007 the damage of the concrete is modeled by using the erosion parameter erode defined in this model based on the maximum principal strain when it is set more than 1 0 in ls dyna according to the previous studies gholipour et al 2018b zhang et al 2019 murray et al 2007 selecting the value of erode parameter between 1 05 and 1 1 was recommended to capture accurate and reasonable failure behaviors of the concrete materials under extreme loads in comparison with those from the experiments these ranges represent that the damage occurs when the strain of the concrete elements reaches between the ranges of 5 and 10 of the maximum principal strain respectively based on the fe simulations of dropping mass impact and blast loadings on rc beams and columns as given in the previous works zhang et al 2019 gholipour et al 2019c 2020b selecting a value of 1 08 for erode parameter resulted in acceptable results and failure behaviors compared to those from experimental tests more detailed validation studies on the failure behaviors of the concrete material model under impact and blast loads by adopting a value of 1 08 for the erosion parameter erode are presented in section 2 4 of this paper besides the material behaviors of structural steel of a615 grade 60 astm 2005 are used for the steel reinforcements of the bridge pier with a failure strain of 0 35 according to the recommendations made by aci 318 2014 also an elastic plastic material model named mat piecewise linear plasticity mat 024 is employed to model the behaviors of steel rebars considering the strain rate effects the strengths of rc structures under impulsive loads may increase due to the strain rate effects of the concrete and steel materials these enhancements in the relationship with the strain rates of the concrete and steel materials have been discussed in the previous study zhang et al 2019 2 3 validation of vessel models according to previous studies on ship collisions fan and yuan 2014 alsos and amdahl 2007 to accurately model the crushing behaviors of steel plates the ratio of element length to thickness should be adopted between the ranges 8 and 10 to meet this meshing criterion in this study the steel plates modeled using shell elements in the bow portions have thicknesses range from 6 mm to 18 mm with mesh sizes between 50 mm and 150 mm therefore the ratio of the element to the thickness of the steel plates employed for the vessels bow in this study is 8 33 which meets the meshing criterion proposed by alsos and amdhal 2007 therefore the internal structures and outer plates of the ship bow have 39 292 and 48 816 shell elements respectively to validate the fe model of the ship bow the force deformation results from a series of quasi static analyses of the ship bow collision with a rigid wall with a mesh size of 200 mm as shown in fig 6 a are compared with those computed by the current design codes and previous studies since there exists very limited experimental test data on the ship bow collisions in the literature the force deformation results from the ship impact simulations are compared with the empirical formulas given by aashto 2009 pedersen et al 1993 and china s bridge design codes cmr 2005 as shown in fig 6b a summary of key information from china s bridge design codes cmr 2005 in estimating the equivalent collision loading is provided in appendix a besides the fe model of the ship bow developed by fan and yuan 2014a which was verified using the aforementioned empirical formulas and met the meshing criterion proposed by alsos and amdahl 2007 based on fe benchmark models is additionally utilized to verify the fe model developed in the present study it should be noted that the characteristics of the ship model studied in the present work such as the ship dimensions the structural configuration of the bow portion the mesh sizes adopted for the ship bow and the rigid wall and the collision velocity i e 5 0 m s are the same as those considered in the study done by fan and yuan 2014a it is found that the force deformation results from the fe simulations are agreed well with those presented by fan and yuan 2014a see fig 6b compared to the empirical formulas proposed by china s bridge design codes and pedersen et al 1993 which capture underestimate and overestimate i e conservative results respectively aashto formulas can more accurately predict the force deformation of the ship collision as recommended by fan and yuan 2014a the mean impact forces obtained from the fe simulations and calculated by eq 2 are compared with those from the empirical formulas in the design codes as presented in fig 6c and table 4 a 50 percent scatter in the mean impact forces i e f a 50 from the fe simulations is considered similar to the ship collision study done by woisin as given by aashto 2009 by comparing the results in fig 6c it is observed that the trend of results from the fe simulations by the present study reasonably agreed well with those from empirical formulas as such the trends of results calculated by aashto 2009 and china s code 2005 are realized as the lower and upper bounds of the mean impact force results that are very close to 50 percent scatter in the mean impact forces from the fe simulations by the present study 2 f a 1 a e a 1 a 0 a f a d a where f a is the mean of impact force f a a denotes the crush depth and e a presents the crush energy of the ship bow similar to the fe modeling procedure employed for the ship bow thicknesses range from 6 mm to 18 mm with the mesh sizes between 50 mm and 150 mm used for all the steel plates of the barge bow portion which meets the meshing criterion proposed by alsos and amdahl 2007 based on fe benchmark models in which the length to thickness ratio of the shell elements should be between 8 and 10 accordingly the internal trusses and outer plates of the barge bow have 43 185 and 40 266 shell elements respectively to verify the fe models of the barge bow portion two quasi static collision tests of the reduced scale 0 4 scale barge bow were simulated in ls dyna with the rigid blocks with flat and round noses same as those adopted in the experimental tests conducted by kantrales et al 2015 as shown in fig 7 a and b since this paper investigates the barge impact scenarios on the round shaped piles cap and the flat shaped pier columns the reliability of the barge bow fe model is examined subjected to both round and flat nose rigid blocks the flat and round nose rigid blocks with the weights of 4182 and 4400 kg and the initial velocities of 9 16 and 9 34 m s collide with the fixed barge bow which represents the collision scenarios named flt1 and rnd1 conducted by kantrales et al 2015 respectively the dimensions of the rigid blocks against 0 4 scale barge bows are illustrated in fig 7a and b the impact force deformation results and crushing behaviors of the barge bow from the fe simulations of the present study and those from the experimental tests done by kantrales et al 2015 are compared in figs 8 and 9 respectively the values of the peak impact forces and the maximum deformations of barge bow are tabulated in table 5 by presenting their percentage of differences i e error between those from fe simulations and the experiment kantrales et al 2015 it is found that the results are very close since their percentage of differences less than 5 for flt1 for rnd1 although the difference of the peak forces is higher than 10 the difference between the maximum deformations is very low and less than 5 also the trend of force deformation curves from fe simulations are very similar to those from the experiments therefore good agreements between the fe simulation and the experimental results are obtained when a mesh size of 100 mm for the solid elements of the impactor and the mesh sizes from 50 to 150 mm for the shell elements of the barge bow is selected 2 4 validation of bridge pier model in this section the reliability of the fe model of the bridge pier is examined by investigating the sensitivity of the impact force results to the mesh size of the pier and studying the validity of the concrete material adopted in modeling the failure behaviors of the concrete pier two validation studies are separately carried out to evaluate the capability of the nonlinear concrete material model i e mat cscm concrete as described in section 2 2 in modeling the failure behaviors of the concrete under impact and blast loads because there is no available experimental test in the literature to investigate concrete structures subjected to synergetic effects of impact and blast loads simultaneously the first study includes the investigation of the impact responses and damage states of a simply supported rc beam previously studied by fujikake et al 2009 with a cross sectional dimension of 0 25 0 15 m in depth and width respectively and a span length of 1 7 m subjected to a 400 kg dropping mass with different impact velocities as shown in fig 10 a a schematic of this beam including its dimensions and cross sectional details is illustrated on the left side of fig 10a also the corresponding fe model of the beam developed in ls dyna by the present study with a mesh size of 10 mm and a value of 1 08 for the erosion parameter erode in the concrete material model mat cscm concrete is shown on the right side of fig 10a it should be noted that the material models used for the concrete and the reinforcements of the beam are similar to those adopted for the bridge pier as described in section 2 2 more detailed information about the fe modeling and material properties of the beam considering their strain rate effects can be found in the previous work the crack patterns and damage states of the beam resulted from the experimental tests done by fujikake et al 2009 under different impact loadings with velocities of 2 43 m s with a corresponding impact height of 0 3 m and 6 86 m s with a corresponding impact height of 2 4 m are illustrated on the left sides of fig 10b and c besides the corresponding fe simulation results of the failure behaviors of the beam are presented on the right sides of fig 10b and c the damage criteria for the concrete material mat cscm concrete is based on the maximum principal strain of the concrete which is controlled by using erode parameter the fringe levels presented for the fe model of concrete denote the levels of the effective plastic strain of the concrete which is directly related to the maximum principal strain and erode parameter the scalar ranges of this fringe level are between 0 and 1 0 in this study the value of 1 08 is selected for erode parameter which means that the concrete finite elements will be eliminated from the analysis when the effective plastic strain of the concrete exceeds 8 of the maximum principal strain of the concrete therefore the scalar value of 1 0 the range is shown with red color for the fringe level of the effective plastic strain of the concrete represents 8 of the maximum principal strain of the concrete material two major damage levels are notable from the validation studies one of these levels denotes the spallation of concrete which is modeled through the elimination of concrete elements from the fe models for this damage level the scalar value of the fringe level i e the effective plastic strain exceeds 1 0 another damage level represents the major and minor cracks with flexural or shear modes in the concrete the fringe levels of these crack patterns in the fe models where the concrete elements have the potential to be eliminated from the analysis have scalar values between 0 7 and 1 0 by comparing the damage levels of the concrete between the fe simulation and experimental results in fig 10 b and c it is seen that the fe simulations are efficiently able to model the different damage levels of the rc beam from overall failure modes including flexural cracks and flexural shear damages to localized failures and concrete spallation under different rate impact loadings by selecting a mesh size of 10 mm and the value of 1 08 for the erosion parameter i e erode of the concrete material model furthermore the impact responses of the rc beam resulted from fe simulations under different rate impact loadings are compared with those from the experiments in fig 11 a and b and table 6 it is seen that the initial peak of impact forces and maximum mid span displacements resulted from the fe simulations are very close to those from experiments with errors less than 2 and 3 respectively although the impact loading durations with velocities of 2 43 m s and 6 86 m s from the fe simulations have errors of 7 4 and 11 3 compared to those from the experiments respectively the results are generally in good agreements to validate the failure behaviors of the concrete material model with a value of 1 08 adopted for the erosion parameter erode under blast loads the fe model of a fixed base rc column with a square cross section with 0 3 0 3 m dimensions and a height of 3 2 m studied by siba 2014 is developed in this study with material models similar to those adopted for the bridge pier as described in section 2 2 and with a mesh size of 10 mm for the concrete and reinforcements as illustrated in fig 12 a also the column was reinforced using four 25 m longitudinal rebars with a diameter of 19 5 mm and 10 m transverse reinforcements with a diameter of 11 3 mm the rc column is subjected to different blast loadings with the scaled distances of 0 34 m kg1 3 seis 4 and 0 58 m kg1 3 seis 8 varying in the explosive standoff distance r when the explosive charge is located at the height of 1 0 m from the column base as shown in fig 12a more detailed information about the structural characteristics and the fe modeling of the column and blast loading scenarios can be found in the literature gholipour et al 2020b siba 2014 in fig 12b and c it is seen that the fe simulations can efficiently model the failure behaviors of the rc column including the exfoliation in the concrete cover and concrete spallation moreover fig 12d demonstrates that the peak value and the amplitude of the column displacement at the height of 2 0 m from the column base from the fe simulation under seis 8 are very close to those from the experiment with errors less than 5 8 respectively therefore the nonlinear material models adopted in this study are efficiently able to model the dynamic responses and failure behaviors of rc structures under blast loads to study the sensitivity of the impact results to the mesh size of the pier three collision scenarios of a 2000 dwt barge with three pier columns with different mesh sizes of 50 100 200 mm were carried out with an impact velocity of 1 65 m s and their impact forces are compared in fig 13 a it is noteworthy that the behaviors of the material of the barge and the pier concrete are modeled using the properties described in sections 2 1 and 2 2 in fig 13a it is seen that a 200 mm mesh obtains an underestimated impact force compared to those from 50 mm and 100 mm meshes that is the results are not converged for a 200 mm mesh since the differences between results from 200 mm mesh and those from 50 mm and 100 mm are rather high however the results from 50 mm and 100 mm meshes are very close due to the trend of convergence therefore to reduce the computational time of the simulations a 100 mm mesh was selected for meshing the pier concrete rather than a 50 mm mesh besides to improve the computational efficiency of the fe simulations the superstructure and the soil layers are modeled using coarse meshes moreover an hourglass control with a coefficient of 0 05 was employed in ls dyna to avoid excessive deformations which causes uncontrolled energy absorption in the mesh elements and providing the energy balance between the vessel and the pier components in the barge pier collision system as shown in fig 13b the hourglass energy is about 5 of the pier internal energy which indicates the robustness of the fe modeling of the pier with the mesh size of 100 mm 3 methodology and limitations the combined loading scenarios studied using high resolution fe based simulations in this paper are designed based on the variability of the vessel collision and explosion parameters in a reasonable manner considering those limitations existing in the current design codes all of the loading scenarios applied to the high resolution fe model of the bridge pier are summarized in table 7 due to the existing limitations of software facilities and the complexity of fe simulations only a limited number of fe simulations are carried out using the high resolution approach for the bridge system as introduced in section 2 these high resolution fe based modeling of combined loading scenarios includes some limitations listed as follows i tow typical vessels including a 5000 dwt container ship and a 2000 dwt jumbo hopper barge that commonly navigate in inland waterways of the u s a and china are considered as the impacting vessels with their design velocities i e 4 0 m s 2 06 knots for the ship and 1 65 m s 3 21 knots for the barge ii compared to the impact elevations of container ships which are commonly around the piles cap levels in the real world the probability of barge collision on the pier column is considered in the implementation of high resolution fe simulations which is more likely to happen in the real world than ship collisions due to their lower loaded drafts than those of ships hence the water level is assumed to be 2 1 m above the column base i e the top surface of the piles cap for the collision of a 5000 dwt ship with a scantling draught of 5 m on the pier cap level besides for the collision of a 2000 dwt barge with a loaded draft of 2 65 m when it is applied to the piles cap and the pier column with heights 4 5 m and 7 4 m the water levels are assumed to be 3 5 m below the column base i e at the bottom surface of the piles cap 2 89 m and 5 79 m above the column base respectively iii to study the effects of impact velocity using high resolution fe simulations the failure behaviors of bridge pier under a design velocity of 1 65 m s for barge collisions as recommended in aashto 2009 are compared with those under a reasonable high velocity range of 5 0 m s 10 0 knots iv for high resolution simulations it is assumed that the blast loads caused by explosive materials herein tnt are placed on the deck level and the boundary line between the bow and stern portions of the vessels also the distances of the explosive charge i e tnt from the pier at the onset time of detonation are assumed equal to the lengths of bow portions of the vessels v since there exists no clear and practical information about explosive charge weight for the bridge piers in the current design codes existing in the literature due to security considerations it is assumed that the charge weight carried by 2000 dwt barge and 5000 dwt container ship vessels are 200 kg and 500 kg respectively to assess the structural design permissions of the studied bridge pier under blast loadings assumed in this paper and explained in the previous paragraph the human tolerance and survival probabilities are checked at the farthest distance i e 70 m distance on the deck span from the center of explosive charge under the blast effects of assumed explosions by comparing the peak pressure and impulse results with those from ufc 3 340 02 u s department of defense 2008 according to this manual the structural analysis and design procedures are recommended for cases in which the survival probabilities of humans are notable when they do not suffer high lung damage and eardrum injuries by the primary effects of the blast pressure fig 14 a c shows the comparison of reflected pressure and impulse results at 70 m distance on the deck span from the center of charge obtained from fe simulations with those calculated by ufc 3 340 02 u s department of defense 2008 for blast loading scenarios with ids of b2c2h0 b2c2h7 and s5c5h8 respectively also the scalar magnitudes of the peak pressures p r impulses i r arrival times to peak pressures t a and amplitudes i e the time duration of impulse t o are quantitatively compared in table 8 it is seen that although the peak pressures obtained from the fe simulations are about 10 higher than those calculated using ufc 3 340 02 u s department of defense 2008 manual the amplitudes and arrival times to peak pressures are almost in good agreement also by checking the survival probabilities s p of a 70 kg adult human subjected to the blast effects of three explosions at 70 m distance from the center of charge on the deck span using ufc 3 340 02 u s department of defense 2008 manual it is found that under a blast loading scenario named s5c5h8 s p has a value less than 1 which means that almost no one will survive in the radius of 70 m under this detonation therefore this loading scenario i e s5c5h8 and its combination with vessel impact is not worthy to be considered for design analysis and further vulnerability assessments bridge pier with the variability of loading parameters including the impact velocity the time lag in sections 5 4 and 5 5 respectively besides it is seen that s p is ranged between 90 and 99 under b2c2h0 and between 50 and 90 under b2c2h7 as given in table 8 therefore it is worthy to investigate the vulnerability of the bridge pier and its progressive failure behaviors under these detonations and their combinations with vessel impact loads that is the additional collapse of the pier and the bridge deck two single spans will cause more fatality hence the failure analysis and structural design of the bridge pier is permitted as recommended by ufc 3 340 02 u s department of defense 2008 manual when it is subjected to sole blast loadings of b2c2h0 b2c2h7 and their combinations with vessel impacts 4 failure modes of the bridge pier under combined loadings in this section the failure behaviors and dynamic responses of the pier under combined impact blast loadings are evaluated compared to those under only vessel impact and only blast loads to do this a collision of a 2000 dwt barge with a design impact velocity of 1 65 m s 3 21 knots impacted on the pier column at the height of 7 4 m from the column base named b2v1h7 is considered in combination with a blast loading with a scaled distance of 1 28 m kg1 3 arising from a spherical explosive with a weight of 200 kg standing at the distance of 7 5 m named b2c2h7 as shown in fig 15 the combination of these loadings is named b2v1h7tn as identified in table 7 before the initiation of transient loading stages including the vessel collision and blast load the whole bridge including pier and superstructure is exposed to its gravity loads under self weight using load body keyword in ls dyna through an implicit dynamic relaxation analysis before transient impact and blast loading phases during explicit analysis then the results obtained from the implicit dynamic relaxation analysis are transferred to explicit analysis to consider the permanent gravity loads during the transient loading phases therefore the bridge undergoes the gravity loads during both stress initialization i e dynamic relaxation analysis and transient loading phases it is also noteworthy that the gravity loads should be gradually applied to the fe models for a sufficiently long time to avoid undesirable dynamic vibration in the structural responses of the bridge in this study the gravity loads are gradually applied to the models until the bridge pier and superstructure reach equilibrium and stable state with a vertical velocity of less than 0 1 m s after 0 5 s during an implicit analysis also global damping of 5 was used to achieve the equilibrium state of the whole bridge during a dynamic relaxation phase as recommended by bridge design codes aviram et al 2008 from a modal analysis and also using the operation of fast fourier transform fft function on the acceleration response of the bridge pier in the collision direction the first three natural frequencies of the pier are n 1 1 25 hz n 2 7 0 hz and n 3 12 6 hz as shown in fig 16 a therefore the first natural periodic time of the pier at t 1 0 8 s after barge collision is assumed as the initiation time of the following blast load which is almost simultaneous with the happening times of the final peaks of the impact force and the shear force at the critical section of the impacted column i e the middle of the shear plug under barge impact load as shown in fig 16b fig 17 a e demonstrate that the pier experiences larger deflections and greater internal forces under the combined loading compared to those under sole impact and blast loads in addition the pier loses its shear flexural and axial load carrying capacities under combined actions of impact and blast loads the failure behaviors of the pier under only barge impact only explosion loading and the combined impact blast loadings with the priority of the impact loading at different time stages of the pier response are illustrated in fig 18 a c respectively furthermore the corresponding flexural moments and shear forces distributed in the height of the front column of the pier are presented in fig 19 a c and fig 20 a c respectively in fig 18a the flexural cracks originating from the tensile surface i e back face of the impacted column at the impact level are extended when the inertial resistance of the superstructure is mobilized at t 0 17 s simultaneously with the occurrence of the peak flexural moment in the impacted column as shown in figs 17d and 19a afterwards the formation of substantial shear cracks propagated from the column base to the impact zone with an approximate angle of 45 is observed at t 0 8 s fig 20a shows the shear force distribution in the height of the impacted column it is found that the critical section for shear forces is at the height of 5 0 m from the column base around the middle of the shear damage although the pier withstands against the collapse under only vessel impact load as shown in fig 18a it suffers substantial shear and flexural damages at the impact and top elevations through the change of the directions of flexural moments during the free vibration phase of the pier response at t 1 95 s as shown in fig 19a besides the failure behaviors of the pier under the sole explosion with a scaled distance of 1 28 m kg1 3 at identical time stages are shown in fig 18b the predominance of global shear and flexural shear failures in combinations with localized failures composed of a localized shear plug spallation and the compressive damages are observed around the explosion elevation of the blast front column accordingly an additional shear failure occurs around the height of 20 m from the column base at t 1 95 s around this elevation the strength losses occur in the cross sectional capacities as shown in figs 19b and 20b fig 18c illustrates the failure behaviors of the pier under combined actions of impact and blast loads after the onset of the detonation at t 0 8 s it should be noted that the failure behaviors before t 0 8 s are identical with those under sole impact loading as shown in fig 18a the accumulative effects of the impact induced shear damage at t 0 8 s see fig 18a and the stresses arising from blast loading impulses mainly pressure result in the formation of a localized shear failure propagated from the column base to the impact zone shortly once the onset of the detonation at t 0 9 s thereafter the blast front column loses its shear resistance around t 1 3 s as shown in figs 17c and 20c then the column undergoes a flexural failure around t 1 5 s as shown in figs 17d and 19c finally the column collapses under self weight load after t 1 62 s which accordingly causes progressive damages in the other components of the pier and the collapse of bridge superstructures at t 1 95 s table 9 summarizes the peak values of the displacement and internal forces of the pier and the failure behaviors observed from the high resolution fe simulations in figs 17 and 18 respectively 5 vulnerability assessment of bridge pier under combined loadings in this paper the vulnerability of the bridge pier under impact and blast loads and their combinations is assessed using high and moderate resolution fe simulations in ls dyna varying in different loading related parameters including the location of applied loads vessel type varying in terms of the weight size and bow configurations vessel impact velocity and the time lag between the initiations of the loadings in this section high resolution fe simulations are carried out to visually and qualitatively study the failure behaviors of the bridge pier under different loading conditions besides a simplified fe model of the bridge pier in which only the impact front column and piles cap components are developed using high resolution finite elements is developed in ls dyna to quantitatively investigate the damage indices as defined in section 5 2 for the parametric studies based on the moderate resolution fe simulations 5 1 simplified fe model of the pier to assess the vulnerability of the bridge pier to various ranges of the loading parameters through a parametric study a simplified model of the bridge pier with a moderate resolution is developed to reduce the computation time of the fe simulations in this model the mass of the bridge superstructure is modeled using a lumped mass element and its lateral stiffness and damping behaviors are modeled using a spring element in parallel with a dashpot respectively as shown in fig 21 the equivalent stiffness and damping of the superstructure are obtained using the method proposed by consolazio et al 2014 based on the maximum displacement of the superstructure under the partial impact loading during static analysis more detailed descriptions of the procedure of this method can be found in the previous work gholipour et al 2019a according to this method the equivalent lumped mass of the superstructure is 1 785 mkg and the equivalent stiffness and damping of the superstructure are 1 0 108 n m and 2 7 107 n s m respectively by assuming critical damping of 0 05 as recommended by bridge design codes aviram et al 2008 besides the back column and the piles are modeled using 3 node elastic beam elements mat 001 with equivalent cross sectional characteristics these beam elements are attached to the lumped mass element of the superstructure and the piles cap using rigid links however the front column and the piles cap of the pier are modeled with high resolution finite elements to accurately capture the failure behaviors of the pier column which is exposed to impact and blast loads the soil pile interaction in lateral and axial directions are modeled using nonlinear elastic plastic spring elements attached to the piles nodes the lateral and axial resistances of the soil are modeled using the force deformation curves generated according to the method proposed by reese et al 1974 and matlock 1970 respectively based on the strength characteristics of the soil including unit weight internal friction angle and subgrade modulus then these curves are defined in the material model of the nonlinear soil springs that are modeled using mat spring general nonlinear mat s06 in ls dyna an example of the force deformation curve including both loading and unloading curves with considering the soil gap model gholipour et al 2018a is presented in fig 21 it is also noteworthy that the simplified model is only used to quantitatively investigate the damage indices defined in section 5 2 for the parametric studies based on the moderate resolution fe simulations to validate the simplified fe model proposed in this section the impact forces and displacements of the pier resulted from the simplified fe model are compared with those from high resolution simulations when the pier models are subjected to barge collisions with velocities of 1 65 m s and 5 0 m s as shown in fig 22 a and b it is seen that although the maximum displacements at the piles cap level fe high resolutions have about 5 10 errors compared to those from the simplified models the initial peaks and the impact durations are in good agreement therefore the simplified fe model is sufficiently reliable to be used for parametric study and sensitivity assessments in the following sections 5 2 damage indices to quantitatively assess the damage states and failure modes of the pier under combined loadings three damage indices based on the residual axial load shear force and flexural moment capacities of the pier column named di p di q di m respectively are defined by eqs 3 5 respectively 3 d i p 1 p r p l p n p l 4 d i q 1 q r q n 5 d i m 1 m r m n where p r q r and m r represent the residual axial load shear force and flexural moment respectively p n q n and m n denote the nominal axial shear and flexural moment capacities of the rc column that can be calculated using aci 318 2014 considering the dynamic increase factors due to the strain rate effects of the materials p l denotes the service axial load due to the weight of superstructure as described in section 2 2 which is equal to 10 of the axial load carrying capacity of the pier columns i e 0 1p n the residual capacities of the pier column are computed using a series of multiple step loading procedures as shown in fig 23 a and b these procedures have four loading steps that are sketched as follows first the simplified model of the pier is gradually exposed to the gravity loads due to the mass of the bridge superstructure and the pier column using load body keyword in ls dyna through an implicit dynamic relaxation analysis before transient impact and blast loading phases during explicit analysis to avoid undesirable dynamic vibrations the gravity loads are gradually applied to the fe models for a sufficiently long time until the bridge pier and superstructure reach equilibrium i e stable state with a vertical velocity less than 0 1 m s after 0 5 s as shown in fig 23a then the pier is subjected to barge collision during transient dynamic analysis the sequent blast loading is applied to the impact induced pier at a specified time stage after the collision phase finally the pier is exposed to a motion based axial loading at the end of the front column to obtain the residual axial load carrying capacity of the column as shown in fig 23a also through a separate analysis the pier model is subjected to a repetitive motion based barge collision with a constant velocity during a quasi static analysis to compute the residual shear and flexural capacities of the pier column as shown in fig 23b it should be noted that the pier is fixed at the piles cap level with the initiation of this step using a time controlled boundary condition keyword in ls dyna 5 3 influences of the loading location vessel type and impact weight two different types of vessels including a 2000 dwt jumbo hopper barge and a 5000 dtw container ship which commonly navigate in inland waterways of the u s a and china are considered for high resolution simulations of the bridge pier under combined impact blast loadings to simulate the combinations blast loads with the vessel collisions it is assumed that the explosive materials herein tnt are placed on the deck level of the stern portions of the vessels owing to different bow configurations of barges compared to those of container ships their bows strike on different elevations on the bridge piers as such the collision of a 5000 dwt container ship with the piles cap level with an impact velocity of 4 0 m s which carries 500 kg tnt placed at the elevation of 8 9 m i e the deck level of ship rear from the column base i e the piles cap level represents a combined loading scenario named s5c5v4tn in which the vessel impact loading elevation is different from that of the explosion as shown in fig 24 a in this scenario the scaled distance of the detonation is z 2 61 kg m1 3 besides during the collision of a 2000 dwt barge with an impact velocity of 1 65 m s which carries 200 kg tnt that is applied to different locations on the pier including the piles cap level and the heights of 4 5 m and 7 4 m from the column base represent combined loading scenarios named b2v1h0tn b2v1h4tn and b2v1h7tn respectively for these loading scenarios both impact and blast loads are applied to the pier at the same elevation one of these scenarios named b2v1h0tn represents the applying of combined loading to the piles cap level which causes a scaled distance of 2 62 kg m1 3 as shown in fig 24b two other scenarios including b2v1h4tn and b2v1h7tn denote applying of the combined loading to the heights h i of 4 5 m and 7 4 m from the column base with a scaled distance of 1 28 kg m1 3 as shown in fig 24c and d respectively figs 25 and 26 show the local and global behaviors of the pier and vessels during only vessel collisions respectively figs 25a and 26a demonstrate that the pier endures more severe localized damages at the piles cap i e impact zone and global flexural cracks under ship collision compared to those from the barge impact on the piles cap as shown in figs 25b and 27 b although the first peak impact forces from ship and barge impacts on the piles cap have almost similar magnitudes the vessel weight has significantly positive influences on the following peaks and the duration of impact loading as shown in fig 27a accordingly the pier experiences larger shear forces at piles cap level displacements and the flexural moment at the base of columns compared to those from barge collision as shown in fig 27b e respectively besides when the barge collides with the pier column at the upper elevations both the barge bow and the column suffer more severe localized damages and greater peak impact forces as illustrated in fig 25c and d and 27a respectively however the secondary peak impact force resulted from the barge impact on the piles cap level is greater than those from the barge collision with the pier column at upper elevations due to the mobilization of more internal trusses during the following impulses moreover the impacted column endures a more intense shear plug propagated from the column base to the impact point and larger shear forces at the critical section as shown in fig 26c and d and 27f figs 25b and 27e it is observed that the column suffers more localized damages and flexural moments at the base level in proportion to the decrease of the barge impact height on the column a summary of the dynamic responses and failure behaviors endured by the bridge pier under different loading conditions varying in the loading location vessel type and impact weight is presented in table 10 the first periodic time of the pier i e t 0 8 s simultaneous with the incidence time of the final peak impact force from the barge collision as shown in fig 16a and b and the second peak impact force from the ship collision at 0 57 s as shown in fig 27a are considered as the initiation times of the sequent blast loadings after barge and ship collisions respectively fig 28 a d illustrate the failure behaviors of the pier under different combined loadings varying in the vessel type and the location of applied loads in comparison with those from only blast loading in fig 28a it is seen that the pier suffers extensive spallation on its back surface of the blast front column and global shear damages in the back column under only blast loading detonated at the deck level of the ship rear that has a relatively higher elevation than that of the barge i e s5c5h8 with the combination of the ship collision load applied at the piles cap level with the identical blast loading named s5c5v4tn the pier endures large global deformations and severe global flexural damages in the piles head level and the extensive exfoliations and spallation in the front column compared to those under sole blast loading i e s5c5h8 however the pier still resists total collapse as shown in fig 28a when the pier is exposed to an explosion with a scaled distance of z 2 61 kg m1 3 applied at the piles cap level named b2c2h0 the front column suffers a shear plug damage in its one third height added to the spallation in its back surface the severity of this shear plug damage increases at the critical section and it is accumulated with global flexural damages in the piles head level when the pier is subjected to the combined loading of b2v1h0tn as shown in fig 28b despite suffering greater flexural moments at the piles head level under b2v1h0tn the bridge withstands total collapse as shown in fig 28a and b the corresponding residual flexural and axial forces as illustrated in fig 29 a and c respectively and the vertical displacements of the superstructure cross section in fig 30 a and b demonstrate the resistance of the pier against the whole collapse in contrast the whole collapse of the bridge is yielded through progressing a localized shear failure in the front column under the combined loadings of b2v1h4tn and b2v1h7tn that are associated with the barge impact on the pier column as shown in fig 28c and d the failure of the impacted column resulted from the shear and axial strength losses after about 1 5 s as illustrated in fig 29b and c which consequently leads to the collapse of the superstructure as shown in fig 30c and d the failure modes of the pier under combined loading scenarios compared to those under sole impact and blast loads are tabulated in table 10 to determine the predominant failure modes of the bridge pier under different combined loadings the moment shear interaction diagrams are plotted for various critical cross sections of the pier in comparison with the capacity curve that can be obtained using response 2000 software bentz and collins 2000 based on the modified compression field theory vecchio and collins 1986 as shown in fig 31 a d it is seen that the pier fails in flexural mode at the piles head level under s5c5v4tn and b2v1h0tn in which the vessels impact on the piles cap level besides the front column of the pier suffers a combined flexural shear failure mode at the column base and a shear failure mode at the critical cross section i e at the middle of shear plug propagated from the impact point with an angle of 45 toward the column base as shown in fig 31a and b respectively in fig 31c and d it is seen that the failure modes at the base and top zones of the front column tend to a combined failure mode with the increase of the loading height from the column base the results from sensitivity assessments of the bridge pier under different combined loadings varying in the loading height from the column base using the proposed damage indices by eqs 3 5 based on the simplified fe based model are presented in fig 32 a and b it is seen that the damage indices based on the residual axial load di p and flexural moment di m increase with increasing the loading height from the column base moreover these indices have an almost similar trend of sensitivity to the loading height with a sensitive level of 6 0 m sudden increase from the column base under combined loadings although this sensitivity level is not notable for the cases under only blast loadings di p and di m have a more sensitivity level of 10 m under only barge collisions therefore the combination of impact and blast loads significantly decrease the sensitivity level of pier failure to the loading height however the damage index based on the residual shear capacity of the pier column di q demonstrates different trends of sensitivity as illustrated in fig 32b it is seen that the ascending trend of di q is changed to a descending trend at the loading height of 7 4 m under the only impact and combined loadings however this turning level is 4 5 m under sole blast loading this is because the failure mode of the pier column tends to flexural and flexural shear failure modes with the increase of the loading height as demonstrated in fig 31a d besides the sensitivity of the di p to the loading height is also assessed by varying the barge weight and the scaled distance of the blast loading through a parametric study as shown in fig 32a and b from the damage index results as presented in fig 33 a it is seen that the value of di p significantly increase under a combined loading scenario in which the half of cargo capacity of the barge is loaded i e the weight of 1000 tons and loadings are applied to the height of 7 4 m also it is found that the pier suffers severe damages for the cases with damage indices higher than 0 6 when it is exposed to combined loadings with scaled distances shorter than 2 4 m kg1 3 for blast loads applied to heights higher than 7 4 m see fig 33b 5 4 influence of impact velocity the influences of impact velocity on the failure behaviors and responses of the pier are evaluated under the combination of 2000 dwt barge collisions with an explosion arising from 200 kg tnt applied to the different elevations including the piles cap level and the at height of 7 4 m from the base of columns in fig 34 a the local shear plug damages in the impacted column around the impact zone at the height h i of 7 4 m from the column base are formed when the pier is under only barge collision with a high impact velocity v i of 5 m s named b2v5h7 in fig 35 a it is seen that the front column of the pier experiences larger shear forces at the critical section i e the middle height of the shear plug propagated from the column base to the impact zone besides from a high rate barge collision at the piles cap level the combination of shear damages with a reverse direction than those from the collision scenario at upper elevation as shown in fig 35a and severe flexural damages at the piles head level are observed as shown in fig 34b in addition although the barge collision on the pier column results in a larger value for the first peak impact force a greater secondary peak impact force is captured when it collides with the piles cap due to the mobilization of more internal trusses of the barge during the following impulses as shown in fig 35b table 11 presents a summary of the dynamic responses and failure behaviors of the bridge pier under different loading conditions varying in the impact velocity to simulate the combined loading scenarios associated with barge collisions with relatively high rate velocities i e v i 5 m s the incidence time of the second peak impact force at 0 43 s for the barge piles cap impact scenario and the occurrence time of the peak shear force which is simultaneous with the occurrence of the final peak impact force at 0 77 s for the barge pier column impact scenario as shown in fig 35a and b respectively are assumed as the onset times of the sequent detonations fig 36 a and b demonstrate the failure behaviors of the pier subjected to the combination of high rate barge collisions i e 2000 dwt barge with the impact velocities of 5 0 m s and the blast loadings of 200 kg tnt with the scaled distances of 2 62 kg m1 3 and 1 28 kg m1 3 applied to the piles cap level named b2v5h0tn and the height h i of 7 4 m from the column base named b2v5h7tn respectively in fig 36a it is seen that the bridge pier endures an early local shear failure at the impact zone of the front column under b2v5h7tn which represents the combined actions of a high rate barge collision and the explosion loading shortly after the onset of the detonation at 0 43 s thus the progressive collapse of the pier column and the superstructure is observed at the time of 2 0 s besides when the pier is subjected to the combined loading of b2v5h0tn applied on the piles cap level the collapse of the bridge pier occurs due to the accumulative effects of the shear failures shear hinges in the front column after 1 7 s and global shear flexural failures formation of plastic hinges after about 2 5 s as shown in fig 36b a shear hinge is formed in the front column due to the accumulation effects of two shear plug damages with opposite directions resulting from each of impact and blast loads at the column s base also losing the shear and axial strengths of the front column under both aforementioned combined loading scenarios can be seen in fig 37 a and b respectively also the flexural strength loss which indicates the formation of plastic hinges at the piles head under b2v5h0tn can be observed in fig 37c the dynamic responses and failure behaviors of the pier under different loading conditions varying in the impact velocity are summarized in table 11 by assessing the influences of the impact velocity on the pier damage indices in fig 38 a it is seen that the magnitudes of all indices significantly increase beyond a velocity of 3 0 m s when the pier is subjected to sole barge collisions however this sensitivity level decreases to a velocity of 1 65 m s the recommended velocity by current design codes for 2000 dwt barge when the pier is exposed to the combination of impact and blast loads with a scaled distance of 1 28 m kg1 3 under this impact velocity the pier tends to a shear failure since it has a damage index value higher than 0 8 which represents the whole collapse of the pier besides the pier experiences a moderate damage state with a damage index less than 0 6 when the pier is exposed to combined loading with an impact velocity less than 3 0 m s applied to heights less than 4 5 m from the column base 5 5 influence of time lag the influences of the time lag between the initiations of the barge collision and the sequent blast loading are assessed on the failure behaviors and responses of the bridge pier to do this three different time stages of the response of the pier at 0 09 s 0 8 s and 1 62 s are considered as the initiation times of the sequent blast loading arising from 200 kg with a scaled distance of 1 28 m kg1 3 combined with a 2000 dwt barge impact on the pier column at h i 7 4 m with a low velocity of 1 65 m s that are named as the combined loadings of b2v1h7ti b2v1h7tn and b2v1h7td respectively these time stages represent the occurrence times of the peak impact force at 0 09 s as shown in fig 16b simultaneously with the peak shear force at the critical section of the impacted column the final peak impact force at 0 8 s as shown in fig 16b which is simultaneous with the first periodic time of the pier as shown in fig 16a and the peak displacement at the piles cap level at the simulation time of 1 62 s as shown in fig 17a which is simultaneous with the free vibration stage of the pier response in fig 39 a and b it is observed that the pier undergoes larger displacements at the piles cap and the top elevations under b2v1h7tn in which the sequent blast load is applied at the time of the first natural period at 0 8 s this is because of the resonance effects of the explosion on the pier response when the following blast load is applied simultaneously with the pier displacement with the most velocity i e the steepest slope of the pier displacement at 0 8 s besides the front column undergoes greater shear forces flexural moments and axial forces as shown in fig 39c e respectively under b2v1h7ti in which the following blast load is applied at the incidence time of the peak impact force peak shear and the first peak moment at 0 09 s fig 40 a and b demonstrate the failure behaviors of the pier under combined loadings of b2v1h7ti and b2v1h7td in which the sequent detonation is initiated at the occurrence times of the peak impact force and the peak displacement respectively it is observed that the pier suffers different failure modes under these combined loads such that the occurrence of global shear failures in the impacted column is observed after 1 5 s which causes the whole collapse of the pier at the following time stage see fig 40a however when the explosion occurs simultaneously with the peak displacement i e b2v1h7td the piers collapses due to the combined effects of local shear failure propagated from the column base to the impact point and the formation of a plastic hinge at the impact level of the column as shown in fig 40b in fig 41 compared to di m with magnitudes lower than 0 6 for the time lags shorter than 0 5 s di q results in index values higher than 0 6 which implies the tending of failure modes to shear failures beyond this time lag the pier suffers severe damages composed of shear and flexural failure modes that lead to the whole collapse of the pier since it demonstrates damage index values around and higher than 0 8 for all types of defined indices moreover from a sensitivity analysis on the effectiveness of the time lag versus the variation of the scaled distance of blast loading in fig 41b the pier suffers severe damages with damage index values higher than 0 6 when it is subjected to blast loadings with scaled distances less than of 2 4 m kg1 3 and the time lags higher than 0 4 s table 12 presents a summary of the dynamic responses and failure behaviors of the pier under different combined loadings varying in the time lag parameter 6 conclusions the failure behaviors and dynamic responses of an rc girder bridge pier were numerically evaluated subjected to synergetic effects of vessel collisions and blast loadings in comparison with those from sole impact and blast loads also a simplified model was proposed to assess the vulnerability of the bridge pier to different loading parameters including the location of applied loads the impact velocity of vessels vessel types varying in terms of impact weight velocity and the bow configurations and the time lag between the initiations of the applied loads through a parametric study the main conclusions arising from this paper can be drawn as follows compared to the collapse resistance of the bridge pier under sole impact and blast loads the pier experienced more severe damages and larger internal forces under the combined actions of a 2000 dwt barge collision with a moderate velocity of 1 65 m s and blast loadings arising from 200 kg tnt with a standoff distance of 7 5 m which leads to the whole collapse of the pier hence the current bridge design provisions taking into account blast or vessel collision loads may not be able to sufficiently predict the resistance capacities against the combinations of impact and blast loads the pier suffered more severe localized failures and shear plugs in the impacted column leading to the collapse of the whole pier when both impact and blast loads were applied at the same elevation on the pier column than those arising from scenarios in which loads were applied to the piles cap level this is more likely to happen during the barge collision scenarios in real life than container ship collisions therefore more critical combined loading conditions were concluded for barge pier column collisions than ship piles cap collisions in addition from a sensitivity analysis it was found the failure mode of the pier column tends to flexural and flexural shear failure modes with the increase of the loading height the pier suffered severe damages with damage index values higher than 0 6 when the loading height is higher than 7 4 m barge weight is greater than 1000 tons the half of barge cargo capacity and the scaled distance explosion is shorter than 2 4 m kg1 3 different failure modes were observed when the pier was subjected to combined loadings with high rate barge collisions applied at different elevations as such the pier failure mode changed from localized failure modes in the impacted column to global shear flexural modes at the piles head with reducing the height of applied loads from one fifth of the column height i e 7 4 m from the column base to the piles cap level from the design point of view both the structure and substructure components of the pier should be strengthened against combined loadings the pier experienced greater internal forces and deflections when the sequent blast load was applied simultaneously with the occurrence time of the peak impact force moreover the failure mode of the pier and the length of the damaged area significantly depend on the time lag between the initiations of the vessel collision and the following detonation as such the failure mode of the pier changed from a global failure with extensive damage in the pier column to a localized failure mode with increasing the time lag moreover using a sensitivity analysis it was concluded that suffered severe damages with damage index values higher than 0 6 when it is subjected to combined loadings associated with blast loadings with scaled distances less than 2 4 m kg1 3 and the time lags higher than 0 4 s credit authorship contribution statement gholamreza gholipour conceptualization methodology software validation formal analysis investigation data curation writing original draft preparation chunwei zhang supervision project administration funding acquisition writing review editing asma alsadat mousavi software data curation validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is financially supported by the ministry of science and technology of china grant no 2019yfe0112400 2018yfc1504303 the key research and development program of liaoning province grant no 2017231010 the taishan scholar priority discipline talent group program funded by the shandong province and the first class discipline project funded by the education department of shandong province appendix a according to china s bridge design code 43 the equivalent static load f s for ship collisions can be calculated as follows a 1 f s γ v w c 1 c 2 sin α when f s is in kn γ is the reduction coefficient of kinetic energy s m2 which is equal to 0 3 for head on bow collisions and it is equal to 0 2 for other collision cases v denotes the ship impact velocity m s2 w is the weight of vessel kn c 1 and c 2 are the elastic deformation coefficients of the vessel and the impacted bridge respectively c 1 c 2 0 0005 m kn if there are no data to refer and α denotes the collision angle of the ship 
20552,the vulnerability of a reinforced concrete rc girder bridge pier is numerically assessed using high and moderate resolution finite element fe simulations in ls dyna under the combination of vessel collisions and blast loadings the damage levels of the pier under combined loads are quantitatively assessed by proposing three different damage indices based on the residual axial load shear and flexural moment capacities of the pier column obtained through a series of multi step loading procedures on the simplified fe based model of the pier in addition the proposed simplified model of the pier is employed for sensitivity assessments of the damage indices of the pier to several loading related parameters including the vessel type the location of applied loads the impact velocity and the time lag between the initiations of loadings from the fe simulations it is found that the pier undergoes more severe localized failure when both impact and blast loads are applied at the same elevation on the pier column which is more likely to occur during barge collisions moreover it is found that the pier experiences greater internal forces when the sequent blast loading is applied at the occurrence time of the peak impact force keywords combined impact blast loading vessel collision bridge pier pier collapse local failure global shear failure 1 introduction bridges as the strategic structures may be exposed to dynamic and impulsive loads such as impact and blast loads during their service life the bridge failures have been reported in many cases all over the world due to the collision of vehicles or vessels and explosion loadings harik et al 1990 wardhana and hadipriono 2003 lee et al 2013 harik et al 1990 classified the bridge failures that occurred in the u s due to various causes during the period 1951 to 1988 it was reported that 42 cases of 79 i e about 53 bridges collapsed due to collisions in which 19 cases 24 caused by ships 11 cases 14 by trucks and 6 cases 8 by trains besides in 4 cases 5 the bridges collapsed due to the exploding or burning of fuel tanker trucks based on a study done by wardhana and hadipriono 2003 from 1989 to 2000 in the u s 12 of the total bridge failures occurred due to lateral impact forces arising from the collision of trucks barges ships and trains and 3 of the failures caused by fire and explosions from 2000 to 2008 according to a study by lee et al 2013 from 1980 to 2012 in the u s 15 3 and 2 8 of failures were due to collisions and fire and explosions respectively since the bridge piers play vital roles in the reliability and fail safe of the whole bridge structure because of their low redundancy compared to bridge decks and superstructures recognizing the failure behaviors and dynamic responses of bridge piers under extreme loads is very important to safely design and adopt efficient solutions for the vessel collision studies the impact force deformation relationships from low velocity consolazio and cowan 2003 and high velocity kantrales et al 2015 barge collisions with bridge piers were studied compared to the marginal effects of the pier size on the force deformation results consolazio and cowan 2003 found that the pier shape and geometry have significant influences on the impact forces besides as the high energy barge collision studies with bridge piers kantrales et al 2015 concluded that the collision with flat faced piers resulted in greater impact forces than those of round faced piers consolazio et al 2006 carried out a series of full scale experimental tests of barge collisions with the old st george island bridge to capture a total insight into the behaviors of impacting vessel and struck structure in real life afterwards some analytical methods were proposed by several previous research works consolazio and cowan 2005 consolazio and davidson 2008 fan et al 2010 to achieve the impact responses of both the vessel and impacted structure in simplified manners consolazio and cowan 2005 proposed a coupled vessel impact analysis cvia method in which an sdof vessel model collides with an mdof pier model i e medium resolution technique thereafter the proposed coupled cvia used to analyze the dynamic responses of an equivalent one pier two span opts simplified bridge model proposed by consolazio and davidson 2008 in which the effects and characteristics of adjacent piers and spans were considered using a series of equivalent translational and rotational springs attached to a lumped mass of adjusted piers and spans from an analytical study on ship pier collisions done by fan et al 2010 it was obtained that the strain rate effects of the steel materials used for the vessel bow had significant positive influences on the impact forces however the impact duration was negatively affected by the strain rate effects the amplification effects of structural dynamic parameters of the superstructure such as inertia on the impact responses of girder bridge piers were numerically investigated by davidson et al 2010 and gholipour et al 2019a some of the previous works considered different approaches such as energy based gholipour et al 2018a and reliability gholipour et al 2019b methods to analyze the responses of impacted structures gholipour et al 2018a revealed the significant effects of soil pile interactions on the dynamic responses of girder bridge piers using an energy distribution method fig 1 shows the typical failure modes of rc bridge piers under different collision loads based on observed real collision events and reported by buth et al 2010 different modes of shear failure including a punching shear failure or shear plug a shear hinge i e a shear failure mode that commonly occurs at the mid height of the pier and a diagonal shear failure originating from the impact point and extending to the column base are illustrated in fig 1a c respectively according to the literature agrawal et al 2018 buth et al 2010 do et al 2018 gholipour et al 2018b 2019b zhang et al 2020a shear failure modes commonly take place when bridge piers are subjected to high velocity collision loads under such loading conditions bridge columns suffer brittle failures which would increase the probability of the whole collapse of the bridge besides rc bridge piers may experience combined flexural shear failure mode and minor flexural damages as illustrated in fig 1d and e respectively when they are exposed to collision loads with relatively lower impact velocities although the progression of combined flexural shear damages may lead to the formation of a plastic hinge during the following stages of impact responses more time would be provided until the whole collapse i e a higher chance of survival compared to shear failure modes the damaged states and failure behaviors of rc bridge piers with the nonlinearity under vessel collisions were numerically evaluated in several research works gholipour et al 2018b 2020a wan et al 2019 however the dynamic strain rate effects of both concrete and steel materials on the dynamic responses were not taken into account in these studies gholilpour et al 2018b revealed the dynamic amplification and significant positive influences of the superstructure inertia on the peak impact forces moreover the sensitivity thresholds of the lateral resistance of the columns to the axial load ratio were explored it was found that the axial load positively affects the lateral resistance of rc columns when its ratio was between the ranges from 0 3 to 0 5 recently wan et al 2019 experimentally studied the scaled ship collisions with rc piers with the variability of the impact velocity and the dynamic parameters related to the steel materials used in the ship bow it was found that the nonlinearity of the concrete material used for the pier was substantially effective on the impact responses when under relatively high energy collisions the nonlinear dynamic responses and progressive damage process of a cable stayed rc bridge pier were numerically studied by gholipour et al 2020a in ls dyna furthermore the concrete strain rate effects were analytically formulated by proposing a simplified two degree of freedom system the capability of various proposed damage indices was assessed to explore a more efficient approach in describing the damage states of the impacted pier the failure behaviors of bridge piers under close in and far field explosions have been also investigated experimentally williamson et al 2011 and numerically hu et al 2016 in the literature the typical failure modes of rc bridge piers under different blast loads are illustrated in fig 2 based on large scale experimental blast tests as documented in williamson et al 2010 fig 2a c shows three types of severe damage states of rc columns under close in blast loads including brittle shear failure mode at the column base extensive spallation of concrete cover medium spall along with a shear failure and severe spallation leading to the breach of the cross section respectively according to a classification on spall damage of rc structures under different blast loads presented by mcvay 1988 and reviewed by zhang et al 2020b threshold spall represents a few cracks and exfoliation of concrete cover medium spall denotes a damaged state from a shallow spall to a third of the column thickness severe spall represents from over third of the column thickness to almost breach and the beach denotes the formation of light through to large hole in the cross section of columns besides rc columns may endure two typical failure modes including local spall and exfoliation of concrete cover threshold spall and flexural cracks as shown in fig 2d and e respectively under far field detonations with relatively large scaled distances the influences of various structural parameters including the cross sectional shape height reinforcement ratio type of transverse reinforcement and loading parameters such as the scaled standoff location of the explosion the blast responses of rc piers were assessed using different parametric studies by williamson et al 2011 and hu et al 2016 williamson et al 2011 revealed that although the square columns have larger areas exposed to the overpressure of close in blast loads than circular columns greater resistances against shear failure were provided by square shaped piers than round shaped columns in addition more severe spallation was observed in rc columns with increasing the height of blast loading location due to expanding the area exposed to striking blast waves hu et al 2016 the dynamic responses and failure behaviors of various types of rc structures under impact and blast loads have been comprehensively reviewed by zhang et al 2020a 2020b the responses of simply supported rc beams under the combination of close in blast loads with the middle rate impacts were studied zhang et al 2019 by varying several structural and loading related parameters it was found that the applying of the impact load before the detonation resulted in more severe spall damages in the beam cross section afterwards by evaluating the impact loading rate effects on the blast responses of simply supported rc beams by gholipour et al 2019c it was concluded that the damage index based on the shear forces at the supports was more sensitive to the increase of the impact velocity when the sequent detonation was initiated at the time of the initial peak impact force moreover the vulnerability of an axially loaded rc column to several loading parameters was assessed by gholipour et al 2019b subjected to synergetic effects of impact and blast loads it was revealed that the sensitivity level of the column failure to impact velocity and axial load ratio parameters decreased under combined loadings compared to those under sole impact and blast loads despite the aforementioned studies above investigating the responses and behaviors of rc bridge piers under the combination of impact and blast loadings is the gap of previous research works the combined actions of impact and blast loadings may be applied to bridges during accidental or intentional i e terrorist attacks collision of vessels vehicles etc which can carry explosive materials although the occurrence of such loading combinations has not been reported yet it is worthy to investigate the loading mechanisms and the structural behaviors to capture some insights into the protective design of bridges against such combined loadings based on a review study on the security recommendations for bridges and tunnels roberts et al 2003 it was declared that although blast loads arising from car bombs have the highest probability to happen applying blast loadings by vessels on bridge piers located at major waterways are also very likelihood besides the explosions by vessels may provide more intensive loading conditions due to the larger cargo carrying capacity of vessels than vehicles therefore the paper aims to ideally exercise the basic theory and the possible scenarios of the combination of impact and blast loadings on a typical rc girder bridge pier to this end the dynamic responses internal forces and failure behaviors of a typical rc girder bridge pier with two columns are numerically investigated with high and moderate resolutions in ls dyna 2015 under vessel collisions combined with blast loadings moreover the vulnerability of the bridge pier is quantitatively assessed varying in terms of several loading related parameters including the vessel type impact weight impact velocity the location of loadings and the time lag between the initiations of the applied loads by proposing three damage indices based on the residual axial load shear and flexural moment capacities of the pier column the residual capacities of the pier are obtained through a series of multi step loading procedures applied to the simplified fe based model of the pier with a moderate resolution in organizing the methodology for the loading scenarios in this study the collision of only two typical vessels including 2000 dwt jumbo hopper barge and 5000 dwt container ship which commonly navigate in inland waterways of the u s and china with moderate design velocities 4 m s for ship and 1 65 m s for barge are considered for the high resolution fe simulations that carry 200 kg and 500 kg tnt as the explosive materials on their deck level of rear portions respectively 2 fe modeling of vessels and bridge pier in this section the fe models of a typical bridge pier and striking vessels are described in detail then the calibration of fe models is carried out by comparing the simulation results from the present study and those from the previous experimental and numerical studies existing in the literature 2 1 fe modeling of vessels two typical vessels varying in terms of the bow configuration deadweight tonnage dwt and velocity are considered in this study one of these vessels is a 5000 dwt container ship with a total length of 121 m and a scantling draught of 5 0 m as shown in fig 3 a the details of fe models of the ship bow including the internal stiffeners and the outer plates are illustrated in fig 3a based on the design characteristics available in the literature fan and yuan 2014a 2014b 2014b another vessel is a 2000 dwt jumbo hopper barge with a total length of 59 4 m a depth of 4 26 m in the bow portion and a loaded draft of 2 56 m as shown in fig 3b according to design specifications available in aashto 2009 based on the design drawings presented by kantrales et al 2015 the details of fe models of the internal trusses and frames used in the bow portion of the barge are also illustrated in fig 3b all internal structures and outer plates used in the bow portions of the vessels are modeled using hughes liu shell elements with five integration points through the thickness lstc 2016 the steel plates modeled using shell elements in the bow portions have thicknesses range from 6 mm to 18 mm with mesh sizes between 50 mm and 150 mm to accurately predict the impact forces localized buckling and crushing behaviors during head on collisions to avoid any penetration between the structural components and take into account the possible secondary contacts during the collision a contact algorithm named automatic single surface is used in ls dyna between the internal and outer steel plates in the bow portions of the vessels with static and dynamic friction coefficients of 0 21 as recommended by previous studies yuan 2005 wan et al 2019 moreover to simplify and reduce the computation time of the fe simulations the non bow stern portions of the vessels are modeled using 8 node solid elements with coarse meshes by adopting a rigid material model named mat rigid mat 020 lstc 2016 since it is not expected to observe significant deformations in these portions the cargo weights of the vessels are adjusted using a mass distribution method in the stern portions in this method the cargo weights of the vessels herein vessels with fully loaded cargo capacities are divided into the total volume of the stern portions and applied to the mass density parameter of the material model defined in ls dyna for the rigid elements of the stern portions as given in table 1 it is noteworthy that a 10 added mass is considered for the stern portions of the vessels to take into account the hydrodynamic effects during fe simulations an elastic plastic material model named mat plastic kinematic mat 003 in ls dyna which represents the isotropic and kinematic hardening behaviors considering the strain rate effects of the steel material is used for the steel plates of the vessels bow portions the stress strain characteristics of a structural steel a36 with a failure strain of 0 25 are employed based on the standard specification for carbon structural steel astm 2008 to input in the material model of the steel plates used in the bow portions as given in table 1 also getter et al 2015 recommended adopting the average of the failure strain range from 0 2 to 0 4 for mild steel a36 since no significant sensitivity was observed to the use of failure strain over this range in this study the strain rate effects of the steel materials are modeled using cowper symonds coefficients of c 40 4 s 1 and p 5 0 in the properties of mat 003 in ls dyna these values have been widely used by many research works in the literature kantrales et al 2015 gholipour et al 2020a fan and yuan 2014b fan et al 2018 jones 2011 investigating the collision behaviors of vessels modeled using the dynamic characteristics of the materials of mild steel especially a36 steel according to the study done by symonds 1967 the basis for utilizing these values for cowper symonds coefficients is the dynamic stresses of various steel materials resulted from extensive experimental tests conducted by manjoine 1944 the strain rate parameters can be calculated using cowper and symonds s formulas as follows jones 2011 1 σ d σ s 1 ε c 1 p where σ d is the dynamic flow stress at uni axial plastic strain rate ε and σ s is the static flow stress c and p are the constants of steel material 2 2 fe modeling of bridge a typical rc girder bridge pier with two hollow section columns with the height of 38 8 m a piles cap with a thickness of 3 5 m fourteen concrete piles with 2 0 m in diameter and 98 0 m in height is considered to study under vessel collisions combined with blast loads as shown in fig 4 the detailed dimensions and elevations of the bridge pier and superstructure are illustrated in figs 4 and 5 a all the concrete material of the pier superstructures are modeled using constant stress solid elements in ls dyna however the reinforcements are modeled using 3 node beam elements in ls dyna as shown in fig 4a with considering minimum design requirements defined by design codes such as aci 318 2014 in which the longitudinal rebars have ratios between 2 and 4 also a coupling algorithm named constrained lagrange in solid is utilized to model the interaction between the concrete and the reinforcement bars fig 5b demonstrates the reinforcement configurations used in different parts of the bridge from the previous studies consolazio and davidson 2008 it was found that considering a part of the bridge with one pier and two adjacent spans can accurately capture the dynamic responses of the multi span bridge therefore only two spans of twin cell box girder superstructures with lengths of 70 0 m and weights of 25 5 tons per unit length placed on the pier top are considered as shown in fig 4 accordingly the weight of the superstructure with a partial length of 70 m is 1785 tons 70 25 5 which is equal to 10 of the axial load carrying capacity of the pier other ends of the superstructures are freely sitting on the rigid and fixed supporters it should be noted that an open joint was considered between the adjoining decks to avoid the significant contact forces developed during the closure of the deck joint due to the substantial displacements of the pier from the previous studies el tawil et al 2005 do et al 2018 it was concluded that utilizing bearing pads between the pier and superstructures had marginal influences on the impact loads and the responses of bridge piers therefore a contact algorithm named automatic surface to surface is used to model the stiffness between the concrete to the concrete surface of the superstructures and the cap beam of the pier with a friction coefficient of 0 6 as recommended in the literature aci 2014 do et al 2018 in instead of modeling the bearing pads to reduce the computational time of fe simulations also like as the previous studies sha and hao 2012 el tawil et al 2005 consolazio and cowan 2003 a similar contact algorithm with static and dynamic friction coefficients of 0 3 was used between the steel and concrete surface of the ship bow and the bridge pier table 2 summarizes the contact algorithms utilized between various components of the bridge with assumed friction coefficients based on the previous studies moreover it is assumed that the piles are surrounded by the soil with a mudline elevation of 8 0 m beneath the lower surface of the piles cap as shown in fig 5a also the interaction between the concrete piles and the soil layer in the near field is modeled using a contact algorithm named automatic nodes to surface with static and dynamic friction coefficients of 0 26 in ls dyna as recommended by brumund et al 1973 between the contact surface of silty i e clay sand soil and concrete materials as presented in table 2 to prohibit the reflection of stress waves from the boundaries the soil behaviors in the far field are modeled using non reflecting boundary conditions in ls dyna similar to the procedure employed in the literature fan yuan 2014b in ls dyna the infinite domain of soil layers is modeled using an artificial boundary condition named boundary non reflecting in modeling this boundary condition to avoid any exaggerated deformations occurred in the exterior boundary the fe model of surrounding soil contains two zones including i the near field soil modeled using nonlinear material and ii the far field soil modeled using a linear elastic material the nonlinear behavior of the soil surrounding the piles in the near field is modeled using an elastic plastic model mat mohr coulumb mat 173 with assuming the reasonable characteristics as given in the literature gholipour et al 2018a fan and yuan 2014b the material properties assumed for the various components of the bridge are summarized in table 3 the nonlinear damage behaviors of the concrete material are modeled using a continuous surface cap model cscm named mat cscm concrete mat 159 murray 2007 which captures some key mechanical characteristics of the concrete such as the pressure and strain hardening this model is easily available to use in ls dyna by inputting several parameters of concrete material including unconfined compression strength of concrete f c the element erosion i e the elimination of fe elements parameter erode and the maximum aggregate size dagg which profoundly governs the fracture energy murray 2007 the damage of the concrete is modeled by using the erosion parameter erode defined in this model based on the maximum principal strain when it is set more than 1 0 in ls dyna according to the previous studies gholipour et al 2018b zhang et al 2019 murray et al 2007 selecting the value of erode parameter between 1 05 and 1 1 was recommended to capture accurate and reasonable failure behaviors of the concrete materials under extreme loads in comparison with those from the experiments these ranges represent that the damage occurs when the strain of the concrete elements reaches between the ranges of 5 and 10 of the maximum principal strain respectively based on the fe simulations of dropping mass impact and blast loadings on rc beams and columns as given in the previous works zhang et al 2019 gholipour et al 2019c 2020b selecting a value of 1 08 for erode parameter resulted in acceptable results and failure behaviors compared to those from experimental tests more detailed validation studies on the failure behaviors of the concrete material model under impact and blast loads by adopting a value of 1 08 for the erosion parameter erode are presented in section 2 4 of this paper besides the material behaviors of structural steel of a615 grade 60 astm 2005 are used for the steel reinforcements of the bridge pier with a failure strain of 0 35 according to the recommendations made by aci 318 2014 also an elastic plastic material model named mat piecewise linear plasticity mat 024 is employed to model the behaviors of steel rebars considering the strain rate effects the strengths of rc structures under impulsive loads may increase due to the strain rate effects of the concrete and steel materials these enhancements in the relationship with the strain rates of the concrete and steel materials have been discussed in the previous study zhang et al 2019 2 3 validation of vessel models according to previous studies on ship collisions fan and yuan 2014 alsos and amdahl 2007 to accurately model the crushing behaviors of steel plates the ratio of element length to thickness should be adopted between the ranges 8 and 10 to meet this meshing criterion in this study the steel plates modeled using shell elements in the bow portions have thicknesses range from 6 mm to 18 mm with mesh sizes between 50 mm and 150 mm therefore the ratio of the element to the thickness of the steel plates employed for the vessels bow in this study is 8 33 which meets the meshing criterion proposed by alsos and amdhal 2007 therefore the internal structures and outer plates of the ship bow have 39 292 and 48 816 shell elements respectively to validate the fe model of the ship bow the force deformation results from a series of quasi static analyses of the ship bow collision with a rigid wall with a mesh size of 200 mm as shown in fig 6 a are compared with those computed by the current design codes and previous studies since there exists very limited experimental test data on the ship bow collisions in the literature the force deformation results from the ship impact simulations are compared with the empirical formulas given by aashto 2009 pedersen et al 1993 and china s bridge design codes cmr 2005 as shown in fig 6b a summary of key information from china s bridge design codes cmr 2005 in estimating the equivalent collision loading is provided in appendix a besides the fe model of the ship bow developed by fan and yuan 2014a which was verified using the aforementioned empirical formulas and met the meshing criterion proposed by alsos and amdahl 2007 based on fe benchmark models is additionally utilized to verify the fe model developed in the present study it should be noted that the characteristics of the ship model studied in the present work such as the ship dimensions the structural configuration of the bow portion the mesh sizes adopted for the ship bow and the rigid wall and the collision velocity i e 5 0 m s are the same as those considered in the study done by fan and yuan 2014a it is found that the force deformation results from the fe simulations are agreed well with those presented by fan and yuan 2014a see fig 6b compared to the empirical formulas proposed by china s bridge design codes and pedersen et al 1993 which capture underestimate and overestimate i e conservative results respectively aashto formulas can more accurately predict the force deformation of the ship collision as recommended by fan and yuan 2014a the mean impact forces obtained from the fe simulations and calculated by eq 2 are compared with those from the empirical formulas in the design codes as presented in fig 6c and table 4 a 50 percent scatter in the mean impact forces i e f a 50 from the fe simulations is considered similar to the ship collision study done by woisin as given by aashto 2009 by comparing the results in fig 6c it is observed that the trend of results from the fe simulations by the present study reasonably agreed well with those from empirical formulas as such the trends of results calculated by aashto 2009 and china s code 2005 are realized as the lower and upper bounds of the mean impact force results that are very close to 50 percent scatter in the mean impact forces from the fe simulations by the present study 2 f a 1 a e a 1 a 0 a f a d a where f a is the mean of impact force f a a denotes the crush depth and e a presents the crush energy of the ship bow similar to the fe modeling procedure employed for the ship bow thicknesses range from 6 mm to 18 mm with the mesh sizes between 50 mm and 150 mm used for all the steel plates of the barge bow portion which meets the meshing criterion proposed by alsos and amdahl 2007 based on fe benchmark models in which the length to thickness ratio of the shell elements should be between 8 and 10 accordingly the internal trusses and outer plates of the barge bow have 43 185 and 40 266 shell elements respectively to verify the fe models of the barge bow portion two quasi static collision tests of the reduced scale 0 4 scale barge bow were simulated in ls dyna with the rigid blocks with flat and round noses same as those adopted in the experimental tests conducted by kantrales et al 2015 as shown in fig 7 a and b since this paper investigates the barge impact scenarios on the round shaped piles cap and the flat shaped pier columns the reliability of the barge bow fe model is examined subjected to both round and flat nose rigid blocks the flat and round nose rigid blocks with the weights of 4182 and 4400 kg and the initial velocities of 9 16 and 9 34 m s collide with the fixed barge bow which represents the collision scenarios named flt1 and rnd1 conducted by kantrales et al 2015 respectively the dimensions of the rigid blocks against 0 4 scale barge bows are illustrated in fig 7a and b the impact force deformation results and crushing behaviors of the barge bow from the fe simulations of the present study and those from the experimental tests done by kantrales et al 2015 are compared in figs 8 and 9 respectively the values of the peak impact forces and the maximum deformations of barge bow are tabulated in table 5 by presenting their percentage of differences i e error between those from fe simulations and the experiment kantrales et al 2015 it is found that the results are very close since their percentage of differences less than 5 for flt1 for rnd1 although the difference of the peak forces is higher than 10 the difference between the maximum deformations is very low and less than 5 also the trend of force deformation curves from fe simulations are very similar to those from the experiments therefore good agreements between the fe simulation and the experimental results are obtained when a mesh size of 100 mm for the solid elements of the impactor and the mesh sizes from 50 to 150 mm for the shell elements of the barge bow is selected 2 4 validation of bridge pier model in this section the reliability of the fe model of the bridge pier is examined by investigating the sensitivity of the impact force results to the mesh size of the pier and studying the validity of the concrete material adopted in modeling the failure behaviors of the concrete pier two validation studies are separately carried out to evaluate the capability of the nonlinear concrete material model i e mat cscm concrete as described in section 2 2 in modeling the failure behaviors of the concrete under impact and blast loads because there is no available experimental test in the literature to investigate concrete structures subjected to synergetic effects of impact and blast loads simultaneously the first study includes the investigation of the impact responses and damage states of a simply supported rc beam previously studied by fujikake et al 2009 with a cross sectional dimension of 0 25 0 15 m in depth and width respectively and a span length of 1 7 m subjected to a 400 kg dropping mass with different impact velocities as shown in fig 10 a a schematic of this beam including its dimensions and cross sectional details is illustrated on the left side of fig 10a also the corresponding fe model of the beam developed in ls dyna by the present study with a mesh size of 10 mm and a value of 1 08 for the erosion parameter erode in the concrete material model mat cscm concrete is shown on the right side of fig 10a it should be noted that the material models used for the concrete and the reinforcements of the beam are similar to those adopted for the bridge pier as described in section 2 2 more detailed information about the fe modeling and material properties of the beam considering their strain rate effects can be found in the previous work the crack patterns and damage states of the beam resulted from the experimental tests done by fujikake et al 2009 under different impact loadings with velocities of 2 43 m s with a corresponding impact height of 0 3 m and 6 86 m s with a corresponding impact height of 2 4 m are illustrated on the left sides of fig 10b and c besides the corresponding fe simulation results of the failure behaviors of the beam are presented on the right sides of fig 10b and c the damage criteria for the concrete material mat cscm concrete is based on the maximum principal strain of the concrete which is controlled by using erode parameter the fringe levels presented for the fe model of concrete denote the levels of the effective plastic strain of the concrete which is directly related to the maximum principal strain and erode parameter the scalar ranges of this fringe level are between 0 and 1 0 in this study the value of 1 08 is selected for erode parameter which means that the concrete finite elements will be eliminated from the analysis when the effective plastic strain of the concrete exceeds 8 of the maximum principal strain of the concrete therefore the scalar value of 1 0 the range is shown with red color for the fringe level of the effective plastic strain of the concrete represents 8 of the maximum principal strain of the concrete material two major damage levels are notable from the validation studies one of these levels denotes the spallation of concrete which is modeled through the elimination of concrete elements from the fe models for this damage level the scalar value of the fringe level i e the effective plastic strain exceeds 1 0 another damage level represents the major and minor cracks with flexural or shear modes in the concrete the fringe levels of these crack patterns in the fe models where the concrete elements have the potential to be eliminated from the analysis have scalar values between 0 7 and 1 0 by comparing the damage levels of the concrete between the fe simulation and experimental results in fig 10 b and c it is seen that the fe simulations are efficiently able to model the different damage levels of the rc beam from overall failure modes including flexural cracks and flexural shear damages to localized failures and concrete spallation under different rate impact loadings by selecting a mesh size of 10 mm and the value of 1 08 for the erosion parameter i e erode of the concrete material model furthermore the impact responses of the rc beam resulted from fe simulations under different rate impact loadings are compared with those from the experiments in fig 11 a and b and table 6 it is seen that the initial peak of impact forces and maximum mid span displacements resulted from the fe simulations are very close to those from experiments with errors less than 2 and 3 respectively although the impact loading durations with velocities of 2 43 m s and 6 86 m s from the fe simulations have errors of 7 4 and 11 3 compared to those from the experiments respectively the results are generally in good agreements to validate the failure behaviors of the concrete material model with a value of 1 08 adopted for the erosion parameter erode under blast loads the fe model of a fixed base rc column with a square cross section with 0 3 0 3 m dimensions and a height of 3 2 m studied by siba 2014 is developed in this study with material models similar to those adopted for the bridge pier as described in section 2 2 and with a mesh size of 10 mm for the concrete and reinforcements as illustrated in fig 12 a also the column was reinforced using four 25 m longitudinal rebars with a diameter of 19 5 mm and 10 m transverse reinforcements with a diameter of 11 3 mm the rc column is subjected to different blast loadings with the scaled distances of 0 34 m kg1 3 seis 4 and 0 58 m kg1 3 seis 8 varying in the explosive standoff distance r when the explosive charge is located at the height of 1 0 m from the column base as shown in fig 12a more detailed information about the structural characteristics and the fe modeling of the column and blast loading scenarios can be found in the literature gholipour et al 2020b siba 2014 in fig 12b and c it is seen that the fe simulations can efficiently model the failure behaviors of the rc column including the exfoliation in the concrete cover and concrete spallation moreover fig 12d demonstrates that the peak value and the amplitude of the column displacement at the height of 2 0 m from the column base from the fe simulation under seis 8 are very close to those from the experiment with errors less than 5 8 respectively therefore the nonlinear material models adopted in this study are efficiently able to model the dynamic responses and failure behaviors of rc structures under blast loads to study the sensitivity of the impact results to the mesh size of the pier three collision scenarios of a 2000 dwt barge with three pier columns with different mesh sizes of 50 100 200 mm were carried out with an impact velocity of 1 65 m s and their impact forces are compared in fig 13 a it is noteworthy that the behaviors of the material of the barge and the pier concrete are modeled using the properties described in sections 2 1 and 2 2 in fig 13a it is seen that a 200 mm mesh obtains an underestimated impact force compared to those from 50 mm and 100 mm meshes that is the results are not converged for a 200 mm mesh since the differences between results from 200 mm mesh and those from 50 mm and 100 mm are rather high however the results from 50 mm and 100 mm meshes are very close due to the trend of convergence therefore to reduce the computational time of the simulations a 100 mm mesh was selected for meshing the pier concrete rather than a 50 mm mesh besides to improve the computational efficiency of the fe simulations the superstructure and the soil layers are modeled using coarse meshes moreover an hourglass control with a coefficient of 0 05 was employed in ls dyna to avoid excessive deformations which causes uncontrolled energy absorption in the mesh elements and providing the energy balance between the vessel and the pier components in the barge pier collision system as shown in fig 13b the hourglass energy is about 5 of the pier internal energy which indicates the robustness of the fe modeling of the pier with the mesh size of 100 mm 3 methodology and limitations the combined loading scenarios studied using high resolution fe based simulations in this paper are designed based on the variability of the vessel collision and explosion parameters in a reasonable manner considering those limitations existing in the current design codes all of the loading scenarios applied to the high resolution fe model of the bridge pier are summarized in table 7 due to the existing limitations of software facilities and the complexity of fe simulations only a limited number of fe simulations are carried out using the high resolution approach for the bridge system as introduced in section 2 these high resolution fe based modeling of combined loading scenarios includes some limitations listed as follows i tow typical vessels including a 5000 dwt container ship and a 2000 dwt jumbo hopper barge that commonly navigate in inland waterways of the u s a and china are considered as the impacting vessels with their design velocities i e 4 0 m s 2 06 knots for the ship and 1 65 m s 3 21 knots for the barge ii compared to the impact elevations of container ships which are commonly around the piles cap levels in the real world the probability of barge collision on the pier column is considered in the implementation of high resolution fe simulations which is more likely to happen in the real world than ship collisions due to their lower loaded drafts than those of ships hence the water level is assumed to be 2 1 m above the column base i e the top surface of the piles cap for the collision of a 5000 dwt ship with a scantling draught of 5 m on the pier cap level besides for the collision of a 2000 dwt barge with a loaded draft of 2 65 m when it is applied to the piles cap and the pier column with heights 4 5 m and 7 4 m the water levels are assumed to be 3 5 m below the column base i e at the bottom surface of the piles cap 2 89 m and 5 79 m above the column base respectively iii to study the effects of impact velocity using high resolution fe simulations the failure behaviors of bridge pier under a design velocity of 1 65 m s for barge collisions as recommended in aashto 2009 are compared with those under a reasonable high velocity range of 5 0 m s 10 0 knots iv for high resolution simulations it is assumed that the blast loads caused by explosive materials herein tnt are placed on the deck level and the boundary line between the bow and stern portions of the vessels also the distances of the explosive charge i e tnt from the pier at the onset time of detonation are assumed equal to the lengths of bow portions of the vessels v since there exists no clear and practical information about explosive charge weight for the bridge piers in the current design codes existing in the literature due to security considerations it is assumed that the charge weight carried by 2000 dwt barge and 5000 dwt container ship vessels are 200 kg and 500 kg respectively to assess the structural design permissions of the studied bridge pier under blast loadings assumed in this paper and explained in the previous paragraph the human tolerance and survival probabilities are checked at the farthest distance i e 70 m distance on the deck span from the center of explosive charge under the blast effects of assumed explosions by comparing the peak pressure and impulse results with those from ufc 3 340 02 u s department of defense 2008 according to this manual the structural analysis and design procedures are recommended for cases in which the survival probabilities of humans are notable when they do not suffer high lung damage and eardrum injuries by the primary effects of the blast pressure fig 14 a c shows the comparison of reflected pressure and impulse results at 70 m distance on the deck span from the center of charge obtained from fe simulations with those calculated by ufc 3 340 02 u s department of defense 2008 for blast loading scenarios with ids of b2c2h0 b2c2h7 and s5c5h8 respectively also the scalar magnitudes of the peak pressures p r impulses i r arrival times to peak pressures t a and amplitudes i e the time duration of impulse t o are quantitatively compared in table 8 it is seen that although the peak pressures obtained from the fe simulations are about 10 higher than those calculated using ufc 3 340 02 u s department of defense 2008 manual the amplitudes and arrival times to peak pressures are almost in good agreement also by checking the survival probabilities s p of a 70 kg adult human subjected to the blast effects of three explosions at 70 m distance from the center of charge on the deck span using ufc 3 340 02 u s department of defense 2008 manual it is found that under a blast loading scenario named s5c5h8 s p has a value less than 1 which means that almost no one will survive in the radius of 70 m under this detonation therefore this loading scenario i e s5c5h8 and its combination with vessel impact is not worthy to be considered for design analysis and further vulnerability assessments bridge pier with the variability of loading parameters including the impact velocity the time lag in sections 5 4 and 5 5 respectively besides it is seen that s p is ranged between 90 and 99 under b2c2h0 and between 50 and 90 under b2c2h7 as given in table 8 therefore it is worthy to investigate the vulnerability of the bridge pier and its progressive failure behaviors under these detonations and their combinations with vessel impact loads that is the additional collapse of the pier and the bridge deck two single spans will cause more fatality hence the failure analysis and structural design of the bridge pier is permitted as recommended by ufc 3 340 02 u s department of defense 2008 manual when it is subjected to sole blast loadings of b2c2h0 b2c2h7 and their combinations with vessel impacts 4 failure modes of the bridge pier under combined loadings in this section the failure behaviors and dynamic responses of the pier under combined impact blast loadings are evaluated compared to those under only vessel impact and only blast loads to do this a collision of a 2000 dwt barge with a design impact velocity of 1 65 m s 3 21 knots impacted on the pier column at the height of 7 4 m from the column base named b2v1h7 is considered in combination with a blast loading with a scaled distance of 1 28 m kg1 3 arising from a spherical explosive with a weight of 200 kg standing at the distance of 7 5 m named b2c2h7 as shown in fig 15 the combination of these loadings is named b2v1h7tn as identified in table 7 before the initiation of transient loading stages including the vessel collision and blast load the whole bridge including pier and superstructure is exposed to its gravity loads under self weight using load body keyword in ls dyna through an implicit dynamic relaxation analysis before transient impact and blast loading phases during explicit analysis then the results obtained from the implicit dynamic relaxation analysis are transferred to explicit analysis to consider the permanent gravity loads during the transient loading phases therefore the bridge undergoes the gravity loads during both stress initialization i e dynamic relaxation analysis and transient loading phases it is also noteworthy that the gravity loads should be gradually applied to the fe models for a sufficiently long time to avoid undesirable dynamic vibration in the structural responses of the bridge in this study the gravity loads are gradually applied to the models until the bridge pier and superstructure reach equilibrium and stable state with a vertical velocity of less than 0 1 m s after 0 5 s during an implicit analysis also global damping of 5 was used to achieve the equilibrium state of the whole bridge during a dynamic relaxation phase as recommended by bridge design codes aviram et al 2008 from a modal analysis and also using the operation of fast fourier transform fft function on the acceleration response of the bridge pier in the collision direction the first three natural frequencies of the pier are n 1 1 25 hz n 2 7 0 hz and n 3 12 6 hz as shown in fig 16 a therefore the first natural periodic time of the pier at t 1 0 8 s after barge collision is assumed as the initiation time of the following blast load which is almost simultaneous with the happening times of the final peaks of the impact force and the shear force at the critical section of the impacted column i e the middle of the shear plug under barge impact load as shown in fig 16b fig 17 a e demonstrate that the pier experiences larger deflections and greater internal forces under the combined loading compared to those under sole impact and blast loads in addition the pier loses its shear flexural and axial load carrying capacities under combined actions of impact and blast loads the failure behaviors of the pier under only barge impact only explosion loading and the combined impact blast loadings with the priority of the impact loading at different time stages of the pier response are illustrated in fig 18 a c respectively furthermore the corresponding flexural moments and shear forces distributed in the height of the front column of the pier are presented in fig 19 a c and fig 20 a c respectively in fig 18a the flexural cracks originating from the tensile surface i e back face of the impacted column at the impact level are extended when the inertial resistance of the superstructure is mobilized at t 0 17 s simultaneously with the occurrence of the peak flexural moment in the impacted column as shown in figs 17d and 19a afterwards the formation of substantial shear cracks propagated from the column base to the impact zone with an approximate angle of 45 is observed at t 0 8 s fig 20a shows the shear force distribution in the height of the impacted column it is found that the critical section for shear forces is at the height of 5 0 m from the column base around the middle of the shear damage although the pier withstands against the collapse under only vessel impact load as shown in fig 18a it suffers substantial shear and flexural damages at the impact and top elevations through the change of the directions of flexural moments during the free vibration phase of the pier response at t 1 95 s as shown in fig 19a besides the failure behaviors of the pier under the sole explosion with a scaled distance of 1 28 m kg1 3 at identical time stages are shown in fig 18b the predominance of global shear and flexural shear failures in combinations with localized failures composed of a localized shear plug spallation and the compressive damages are observed around the explosion elevation of the blast front column accordingly an additional shear failure occurs around the height of 20 m from the column base at t 1 95 s around this elevation the strength losses occur in the cross sectional capacities as shown in figs 19b and 20b fig 18c illustrates the failure behaviors of the pier under combined actions of impact and blast loads after the onset of the detonation at t 0 8 s it should be noted that the failure behaviors before t 0 8 s are identical with those under sole impact loading as shown in fig 18a the accumulative effects of the impact induced shear damage at t 0 8 s see fig 18a and the stresses arising from blast loading impulses mainly pressure result in the formation of a localized shear failure propagated from the column base to the impact zone shortly once the onset of the detonation at t 0 9 s thereafter the blast front column loses its shear resistance around t 1 3 s as shown in figs 17c and 20c then the column undergoes a flexural failure around t 1 5 s as shown in figs 17d and 19c finally the column collapses under self weight load after t 1 62 s which accordingly causes progressive damages in the other components of the pier and the collapse of bridge superstructures at t 1 95 s table 9 summarizes the peak values of the displacement and internal forces of the pier and the failure behaviors observed from the high resolution fe simulations in figs 17 and 18 respectively 5 vulnerability assessment of bridge pier under combined loadings in this paper the vulnerability of the bridge pier under impact and blast loads and their combinations is assessed using high and moderate resolution fe simulations in ls dyna varying in different loading related parameters including the location of applied loads vessel type varying in terms of the weight size and bow configurations vessel impact velocity and the time lag between the initiations of the loadings in this section high resolution fe simulations are carried out to visually and qualitatively study the failure behaviors of the bridge pier under different loading conditions besides a simplified fe model of the bridge pier in which only the impact front column and piles cap components are developed using high resolution finite elements is developed in ls dyna to quantitatively investigate the damage indices as defined in section 5 2 for the parametric studies based on the moderate resolution fe simulations 5 1 simplified fe model of the pier to assess the vulnerability of the bridge pier to various ranges of the loading parameters through a parametric study a simplified model of the bridge pier with a moderate resolution is developed to reduce the computation time of the fe simulations in this model the mass of the bridge superstructure is modeled using a lumped mass element and its lateral stiffness and damping behaviors are modeled using a spring element in parallel with a dashpot respectively as shown in fig 21 the equivalent stiffness and damping of the superstructure are obtained using the method proposed by consolazio et al 2014 based on the maximum displacement of the superstructure under the partial impact loading during static analysis more detailed descriptions of the procedure of this method can be found in the previous work gholipour et al 2019a according to this method the equivalent lumped mass of the superstructure is 1 785 mkg and the equivalent stiffness and damping of the superstructure are 1 0 108 n m and 2 7 107 n s m respectively by assuming critical damping of 0 05 as recommended by bridge design codes aviram et al 2008 besides the back column and the piles are modeled using 3 node elastic beam elements mat 001 with equivalent cross sectional characteristics these beam elements are attached to the lumped mass element of the superstructure and the piles cap using rigid links however the front column and the piles cap of the pier are modeled with high resolution finite elements to accurately capture the failure behaviors of the pier column which is exposed to impact and blast loads the soil pile interaction in lateral and axial directions are modeled using nonlinear elastic plastic spring elements attached to the piles nodes the lateral and axial resistances of the soil are modeled using the force deformation curves generated according to the method proposed by reese et al 1974 and matlock 1970 respectively based on the strength characteristics of the soil including unit weight internal friction angle and subgrade modulus then these curves are defined in the material model of the nonlinear soil springs that are modeled using mat spring general nonlinear mat s06 in ls dyna an example of the force deformation curve including both loading and unloading curves with considering the soil gap model gholipour et al 2018a is presented in fig 21 it is also noteworthy that the simplified model is only used to quantitatively investigate the damage indices defined in section 5 2 for the parametric studies based on the moderate resolution fe simulations to validate the simplified fe model proposed in this section the impact forces and displacements of the pier resulted from the simplified fe model are compared with those from high resolution simulations when the pier models are subjected to barge collisions with velocities of 1 65 m s and 5 0 m s as shown in fig 22 a and b it is seen that although the maximum displacements at the piles cap level fe high resolutions have about 5 10 errors compared to those from the simplified models the initial peaks and the impact durations are in good agreement therefore the simplified fe model is sufficiently reliable to be used for parametric study and sensitivity assessments in the following sections 5 2 damage indices to quantitatively assess the damage states and failure modes of the pier under combined loadings three damage indices based on the residual axial load shear force and flexural moment capacities of the pier column named di p di q di m respectively are defined by eqs 3 5 respectively 3 d i p 1 p r p l p n p l 4 d i q 1 q r q n 5 d i m 1 m r m n where p r q r and m r represent the residual axial load shear force and flexural moment respectively p n q n and m n denote the nominal axial shear and flexural moment capacities of the rc column that can be calculated using aci 318 2014 considering the dynamic increase factors due to the strain rate effects of the materials p l denotes the service axial load due to the weight of superstructure as described in section 2 2 which is equal to 10 of the axial load carrying capacity of the pier columns i e 0 1p n the residual capacities of the pier column are computed using a series of multiple step loading procedures as shown in fig 23 a and b these procedures have four loading steps that are sketched as follows first the simplified model of the pier is gradually exposed to the gravity loads due to the mass of the bridge superstructure and the pier column using load body keyword in ls dyna through an implicit dynamic relaxation analysis before transient impact and blast loading phases during explicit analysis to avoid undesirable dynamic vibrations the gravity loads are gradually applied to the fe models for a sufficiently long time until the bridge pier and superstructure reach equilibrium i e stable state with a vertical velocity less than 0 1 m s after 0 5 s as shown in fig 23a then the pier is subjected to barge collision during transient dynamic analysis the sequent blast loading is applied to the impact induced pier at a specified time stage after the collision phase finally the pier is exposed to a motion based axial loading at the end of the front column to obtain the residual axial load carrying capacity of the column as shown in fig 23a also through a separate analysis the pier model is subjected to a repetitive motion based barge collision with a constant velocity during a quasi static analysis to compute the residual shear and flexural capacities of the pier column as shown in fig 23b it should be noted that the pier is fixed at the piles cap level with the initiation of this step using a time controlled boundary condition keyword in ls dyna 5 3 influences of the loading location vessel type and impact weight two different types of vessels including a 2000 dwt jumbo hopper barge and a 5000 dtw container ship which commonly navigate in inland waterways of the u s a and china are considered for high resolution simulations of the bridge pier under combined impact blast loadings to simulate the combinations blast loads with the vessel collisions it is assumed that the explosive materials herein tnt are placed on the deck level of the stern portions of the vessels owing to different bow configurations of barges compared to those of container ships their bows strike on different elevations on the bridge piers as such the collision of a 5000 dwt container ship with the piles cap level with an impact velocity of 4 0 m s which carries 500 kg tnt placed at the elevation of 8 9 m i e the deck level of ship rear from the column base i e the piles cap level represents a combined loading scenario named s5c5v4tn in which the vessel impact loading elevation is different from that of the explosion as shown in fig 24 a in this scenario the scaled distance of the detonation is z 2 61 kg m1 3 besides during the collision of a 2000 dwt barge with an impact velocity of 1 65 m s which carries 200 kg tnt that is applied to different locations on the pier including the piles cap level and the heights of 4 5 m and 7 4 m from the column base represent combined loading scenarios named b2v1h0tn b2v1h4tn and b2v1h7tn respectively for these loading scenarios both impact and blast loads are applied to the pier at the same elevation one of these scenarios named b2v1h0tn represents the applying of combined loading to the piles cap level which causes a scaled distance of 2 62 kg m1 3 as shown in fig 24b two other scenarios including b2v1h4tn and b2v1h7tn denote applying of the combined loading to the heights h i of 4 5 m and 7 4 m from the column base with a scaled distance of 1 28 kg m1 3 as shown in fig 24c and d respectively figs 25 and 26 show the local and global behaviors of the pier and vessels during only vessel collisions respectively figs 25a and 26a demonstrate that the pier endures more severe localized damages at the piles cap i e impact zone and global flexural cracks under ship collision compared to those from the barge impact on the piles cap as shown in figs 25b and 27 b although the first peak impact forces from ship and barge impacts on the piles cap have almost similar magnitudes the vessel weight has significantly positive influences on the following peaks and the duration of impact loading as shown in fig 27a accordingly the pier experiences larger shear forces at piles cap level displacements and the flexural moment at the base of columns compared to those from barge collision as shown in fig 27b e respectively besides when the barge collides with the pier column at the upper elevations both the barge bow and the column suffer more severe localized damages and greater peak impact forces as illustrated in fig 25c and d and 27a respectively however the secondary peak impact force resulted from the barge impact on the piles cap level is greater than those from the barge collision with the pier column at upper elevations due to the mobilization of more internal trusses during the following impulses moreover the impacted column endures a more intense shear plug propagated from the column base to the impact point and larger shear forces at the critical section as shown in fig 26c and d and 27f figs 25b and 27e it is observed that the column suffers more localized damages and flexural moments at the base level in proportion to the decrease of the barge impact height on the column a summary of the dynamic responses and failure behaviors endured by the bridge pier under different loading conditions varying in the loading location vessel type and impact weight is presented in table 10 the first periodic time of the pier i e t 0 8 s simultaneous with the incidence time of the final peak impact force from the barge collision as shown in fig 16a and b and the second peak impact force from the ship collision at 0 57 s as shown in fig 27a are considered as the initiation times of the sequent blast loadings after barge and ship collisions respectively fig 28 a d illustrate the failure behaviors of the pier under different combined loadings varying in the vessel type and the location of applied loads in comparison with those from only blast loading in fig 28a it is seen that the pier suffers extensive spallation on its back surface of the blast front column and global shear damages in the back column under only blast loading detonated at the deck level of the ship rear that has a relatively higher elevation than that of the barge i e s5c5h8 with the combination of the ship collision load applied at the piles cap level with the identical blast loading named s5c5v4tn the pier endures large global deformations and severe global flexural damages in the piles head level and the extensive exfoliations and spallation in the front column compared to those under sole blast loading i e s5c5h8 however the pier still resists total collapse as shown in fig 28a when the pier is exposed to an explosion with a scaled distance of z 2 61 kg m1 3 applied at the piles cap level named b2c2h0 the front column suffers a shear plug damage in its one third height added to the spallation in its back surface the severity of this shear plug damage increases at the critical section and it is accumulated with global flexural damages in the piles head level when the pier is subjected to the combined loading of b2v1h0tn as shown in fig 28b despite suffering greater flexural moments at the piles head level under b2v1h0tn the bridge withstands total collapse as shown in fig 28a and b the corresponding residual flexural and axial forces as illustrated in fig 29 a and c respectively and the vertical displacements of the superstructure cross section in fig 30 a and b demonstrate the resistance of the pier against the whole collapse in contrast the whole collapse of the bridge is yielded through progressing a localized shear failure in the front column under the combined loadings of b2v1h4tn and b2v1h7tn that are associated with the barge impact on the pier column as shown in fig 28c and d the failure of the impacted column resulted from the shear and axial strength losses after about 1 5 s as illustrated in fig 29b and c which consequently leads to the collapse of the superstructure as shown in fig 30c and d the failure modes of the pier under combined loading scenarios compared to those under sole impact and blast loads are tabulated in table 10 to determine the predominant failure modes of the bridge pier under different combined loadings the moment shear interaction diagrams are plotted for various critical cross sections of the pier in comparison with the capacity curve that can be obtained using response 2000 software bentz and collins 2000 based on the modified compression field theory vecchio and collins 1986 as shown in fig 31 a d it is seen that the pier fails in flexural mode at the piles head level under s5c5v4tn and b2v1h0tn in which the vessels impact on the piles cap level besides the front column of the pier suffers a combined flexural shear failure mode at the column base and a shear failure mode at the critical cross section i e at the middle of shear plug propagated from the impact point with an angle of 45 toward the column base as shown in fig 31a and b respectively in fig 31c and d it is seen that the failure modes at the base and top zones of the front column tend to a combined failure mode with the increase of the loading height from the column base the results from sensitivity assessments of the bridge pier under different combined loadings varying in the loading height from the column base using the proposed damage indices by eqs 3 5 based on the simplified fe based model are presented in fig 32 a and b it is seen that the damage indices based on the residual axial load di p and flexural moment di m increase with increasing the loading height from the column base moreover these indices have an almost similar trend of sensitivity to the loading height with a sensitive level of 6 0 m sudden increase from the column base under combined loadings although this sensitivity level is not notable for the cases under only blast loadings di p and di m have a more sensitivity level of 10 m under only barge collisions therefore the combination of impact and blast loads significantly decrease the sensitivity level of pier failure to the loading height however the damage index based on the residual shear capacity of the pier column di q demonstrates different trends of sensitivity as illustrated in fig 32b it is seen that the ascending trend of di q is changed to a descending trend at the loading height of 7 4 m under the only impact and combined loadings however this turning level is 4 5 m under sole blast loading this is because the failure mode of the pier column tends to flexural and flexural shear failure modes with the increase of the loading height as demonstrated in fig 31a d besides the sensitivity of the di p to the loading height is also assessed by varying the barge weight and the scaled distance of the blast loading through a parametric study as shown in fig 32a and b from the damage index results as presented in fig 33 a it is seen that the value of di p significantly increase under a combined loading scenario in which the half of cargo capacity of the barge is loaded i e the weight of 1000 tons and loadings are applied to the height of 7 4 m also it is found that the pier suffers severe damages for the cases with damage indices higher than 0 6 when it is exposed to combined loadings with scaled distances shorter than 2 4 m kg1 3 for blast loads applied to heights higher than 7 4 m see fig 33b 5 4 influence of impact velocity the influences of impact velocity on the failure behaviors and responses of the pier are evaluated under the combination of 2000 dwt barge collisions with an explosion arising from 200 kg tnt applied to the different elevations including the piles cap level and the at height of 7 4 m from the base of columns in fig 34 a the local shear plug damages in the impacted column around the impact zone at the height h i of 7 4 m from the column base are formed when the pier is under only barge collision with a high impact velocity v i of 5 m s named b2v5h7 in fig 35 a it is seen that the front column of the pier experiences larger shear forces at the critical section i e the middle height of the shear plug propagated from the column base to the impact zone besides from a high rate barge collision at the piles cap level the combination of shear damages with a reverse direction than those from the collision scenario at upper elevation as shown in fig 35a and severe flexural damages at the piles head level are observed as shown in fig 34b in addition although the barge collision on the pier column results in a larger value for the first peak impact force a greater secondary peak impact force is captured when it collides with the piles cap due to the mobilization of more internal trusses of the barge during the following impulses as shown in fig 35b table 11 presents a summary of the dynamic responses and failure behaviors of the bridge pier under different loading conditions varying in the impact velocity to simulate the combined loading scenarios associated with barge collisions with relatively high rate velocities i e v i 5 m s the incidence time of the second peak impact force at 0 43 s for the barge piles cap impact scenario and the occurrence time of the peak shear force which is simultaneous with the occurrence of the final peak impact force at 0 77 s for the barge pier column impact scenario as shown in fig 35a and b respectively are assumed as the onset times of the sequent detonations fig 36 a and b demonstrate the failure behaviors of the pier subjected to the combination of high rate barge collisions i e 2000 dwt barge with the impact velocities of 5 0 m s and the blast loadings of 200 kg tnt with the scaled distances of 2 62 kg m1 3 and 1 28 kg m1 3 applied to the piles cap level named b2v5h0tn and the height h i of 7 4 m from the column base named b2v5h7tn respectively in fig 36a it is seen that the bridge pier endures an early local shear failure at the impact zone of the front column under b2v5h7tn which represents the combined actions of a high rate barge collision and the explosion loading shortly after the onset of the detonation at 0 43 s thus the progressive collapse of the pier column and the superstructure is observed at the time of 2 0 s besides when the pier is subjected to the combined loading of b2v5h0tn applied on the piles cap level the collapse of the bridge pier occurs due to the accumulative effects of the shear failures shear hinges in the front column after 1 7 s and global shear flexural failures formation of plastic hinges after about 2 5 s as shown in fig 36b a shear hinge is formed in the front column due to the accumulation effects of two shear plug damages with opposite directions resulting from each of impact and blast loads at the column s base also losing the shear and axial strengths of the front column under both aforementioned combined loading scenarios can be seen in fig 37 a and b respectively also the flexural strength loss which indicates the formation of plastic hinges at the piles head under b2v5h0tn can be observed in fig 37c the dynamic responses and failure behaviors of the pier under different loading conditions varying in the impact velocity are summarized in table 11 by assessing the influences of the impact velocity on the pier damage indices in fig 38 a it is seen that the magnitudes of all indices significantly increase beyond a velocity of 3 0 m s when the pier is subjected to sole barge collisions however this sensitivity level decreases to a velocity of 1 65 m s the recommended velocity by current design codes for 2000 dwt barge when the pier is exposed to the combination of impact and blast loads with a scaled distance of 1 28 m kg1 3 under this impact velocity the pier tends to a shear failure since it has a damage index value higher than 0 8 which represents the whole collapse of the pier besides the pier experiences a moderate damage state with a damage index less than 0 6 when the pier is exposed to combined loading with an impact velocity less than 3 0 m s applied to heights less than 4 5 m from the column base 5 5 influence of time lag the influences of the time lag between the initiations of the barge collision and the sequent blast loading are assessed on the failure behaviors and responses of the bridge pier to do this three different time stages of the response of the pier at 0 09 s 0 8 s and 1 62 s are considered as the initiation times of the sequent blast loading arising from 200 kg with a scaled distance of 1 28 m kg1 3 combined with a 2000 dwt barge impact on the pier column at h i 7 4 m with a low velocity of 1 65 m s that are named as the combined loadings of b2v1h7ti b2v1h7tn and b2v1h7td respectively these time stages represent the occurrence times of the peak impact force at 0 09 s as shown in fig 16b simultaneously with the peak shear force at the critical section of the impacted column the final peak impact force at 0 8 s as shown in fig 16b which is simultaneous with the first periodic time of the pier as shown in fig 16a and the peak displacement at the piles cap level at the simulation time of 1 62 s as shown in fig 17a which is simultaneous with the free vibration stage of the pier response in fig 39 a and b it is observed that the pier undergoes larger displacements at the piles cap and the top elevations under b2v1h7tn in which the sequent blast load is applied at the time of the first natural period at 0 8 s this is because of the resonance effects of the explosion on the pier response when the following blast load is applied simultaneously with the pier displacement with the most velocity i e the steepest slope of the pier displacement at 0 8 s besides the front column undergoes greater shear forces flexural moments and axial forces as shown in fig 39c e respectively under b2v1h7ti in which the following blast load is applied at the incidence time of the peak impact force peak shear and the first peak moment at 0 09 s fig 40 a and b demonstrate the failure behaviors of the pier under combined loadings of b2v1h7ti and b2v1h7td in which the sequent detonation is initiated at the occurrence times of the peak impact force and the peak displacement respectively it is observed that the pier suffers different failure modes under these combined loads such that the occurrence of global shear failures in the impacted column is observed after 1 5 s which causes the whole collapse of the pier at the following time stage see fig 40a however when the explosion occurs simultaneously with the peak displacement i e b2v1h7td the piers collapses due to the combined effects of local shear failure propagated from the column base to the impact point and the formation of a plastic hinge at the impact level of the column as shown in fig 40b in fig 41 compared to di m with magnitudes lower than 0 6 for the time lags shorter than 0 5 s di q results in index values higher than 0 6 which implies the tending of failure modes to shear failures beyond this time lag the pier suffers severe damages composed of shear and flexural failure modes that lead to the whole collapse of the pier since it demonstrates damage index values around and higher than 0 8 for all types of defined indices moreover from a sensitivity analysis on the effectiveness of the time lag versus the variation of the scaled distance of blast loading in fig 41b the pier suffers severe damages with damage index values higher than 0 6 when it is subjected to blast loadings with scaled distances less than of 2 4 m kg1 3 and the time lags higher than 0 4 s table 12 presents a summary of the dynamic responses and failure behaviors of the pier under different combined loadings varying in the time lag parameter 6 conclusions the failure behaviors and dynamic responses of an rc girder bridge pier were numerically evaluated subjected to synergetic effects of vessel collisions and blast loadings in comparison with those from sole impact and blast loads also a simplified model was proposed to assess the vulnerability of the bridge pier to different loading parameters including the location of applied loads the impact velocity of vessels vessel types varying in terms of impact weight velocity and the bow configurations and the time lag between the initiations of the applied loads through a parametric study the main conclusions arising from this paper can be drawn as follows compared to the collapse resistance of the bridge pier under sole impact and blast loads the pier experienced more severe damages and larger internal forces under the combined actions of a 2000 dwt barge collision with a moderate velocity of 1 65 m s and blast loadings arising from 200 kg tnt with a standoff distance of 7 5 m which leads to the whole collapse of the pier hence the current bridge design provisions taking into account blast or vessel collision loads may not be able to sufficiently predict the resistance capacities against the combinations of impact and blast loads the pier suffered more severe localized failures and shear plugs in the impacted column leading to the collapse of the whole pier when both impact and blast loads were applied at the same elevation on the pier column than those arising from scenarios in which loads were applied to the piles cap level this is more likely to happen during the barge collision scenarios in real life than container ship collisions therefore more critical combined loading conditions were concluded for barge pier column collisions than ship piles cap collisions in addition from a sensitivity analysis it was found the failure mode of the pier column tends to flexural and flexural shear failure modes with the increase of the loading height the pier suffered severe damages with damage index values higher than 0 6 when the loading height is higher than 7 4 m barge weight is greater than 1000 tons the half of barge cargo capacity and the scaled distance explosion is shorter than 2 4 m kg1 3 different failure modes were observed when the pier was subjected to combined loadings with high rate barge collisions applied at different elevations as such the pier failure mode changed from localized failure modes in the impacted column to global shear flexural modes at the piles head with reducing the height of applied loads from one fifth of the column height i e 7 4 m from the column base to the piles cap level from the design point of view both the structure and substructure components of the pier should be strengthened against combined loadings the pier experienced greater internal forces and deflections when the sequent blast load was applied simultaneously with the occurrence time of the peak impact force moreover the failure mode of the pier and the length of the damaged area significantly depend on the time lag between the initiations of the vessel collision and the following detonation as such the failure mode of the pier changed from a global failure with extensive damage in the pier column to a localized failure mode with increasing the time lag moreover using a sensitivity analysis it was concluded that suffered severe damages with damage index values higher than 0 6 when it is subjected to combined loadings associated with blast loadings with scaled distances less than 2 4 m kg1 3 and the time lags higher than 0 4 s credit authorship contribution statement gholamreza gholipour conceptualization methodology software validation formal analysis investigation data curation writing original draft preparation chunwei zhang supervision project administration funding acquisition writing review editing asma alsadat mousavi software data curation validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is financially supported by the ministry of science and technology of china grant no 2019yfe0112400 2018yfc1504303 the key research and development program of liaoning province grant no 2017231010 the taishan scholar priority discipline talent group program funded by the shandong province and the first class discipline project funded by the education department of shandong province appendix a according to china s bridge design code 43 the equivalent static load f s for ship collisions can be calculated as follows a 1 f s γ v w c 1 c 2 sin α when f s is in kn γ is the reduction coefficient of kinetic energy s m2 which is equal to 0 3 for head on bow collisions and it is equal to 0 2 for other collision cases v denotes the ship impact velocity m s2 w is the weight of vessel kn c 1 and c 2 are the elastic deformation coefficients of the vessel and the impacted bridge respectively c 1 c 2 0 0005 m kn if there are no data to refer and α denotes the collision angle of the ship 
20553,this paper addresses the three dimensional tracking and stabilization problems simultaneously for underactuated autonomous underwater vehicles auvs subjected to parametric uncertainties external disturbances unmeasured states and input saturation a modified error state formulation is introduced to produce auxiliary virtual controls for the underactuated kinematics a new high gain observer is proposed to estimate unavailable velocities which doesn t need the position and orientation of auvs to be bounded based on the backstepping technique and combinations of high gain observer and radial basis function neural network rbfnn approximations the kinematic and dynamic controllers are designed to force underactuated auvs to track a time varying trajectory or and a stationary point and guarantees the tracking errors convergent to a bounded neighborhood of the origin some comparative simulations are presented to validate the effectiveness and performance of the proposed control scheme keywords underactuated underwater vehicles three dimensional control neural networks output feedback tracking and stabilization 1 introduction in recent decades autonomous underwater vehicles auvs play more and more important roles in a wide range of civilian and military applications such as marine surveys ocean explorations pipe inspections and underwater rescue etc which also make the motion control of auvs to receive widespread attention from control communities compared to fully actuated auvs underactuated auvs have fewer independent actuators than their degrees of freedom dof as a result the main challenge in control problem of underactuated auvs is that there is no continuous time invariant state feedback laws to stabilize them brockett 1983 the three dimensional or spacial control problem of underactuated auvs with temporal constraints is usually divided into two distinct subproblems trajectory tracking and stabilization trajectory tracking control aims to force the auv to track a time varying spacial position and orientation where at least one of reference signals satisfies persistent excitation pe condition see chambrion and sigalotti 2008 rezazadegan et al 2015 cassu et al 2015 wang et al 2019 yu et al 2020 huang et al 2021 and the references therein on the contrary stabilization control requires the auv converge to a stationary point with a predefined posture see pettersen and egeland 1999 li and yan 2016 li et al 2018 niu and geng 2019 and the references therein besides for the purpose of reduce the difficulties caused by the underactuation there are lots of researches addressed the three dimensional control problem of underactuated vehicles such that only the number of state errors not more than dof can be controlled see aguiar and hespanha 2007 do 2013 shojaei and arefi 2015 shojaei and dolatshahi 2017 shojaei 2019 zhou et al 2018 yu et al 2019 duan et al 2020 liang et al 2020 and the references therein however in some complicated operations underactuated auvs maybe need to realize trajectory tracking and stabilization simultaneously where the aforementioned results can t be used stand alone on the other hand switching between trajectory tracking and stabilization controllers in one continuous operation is usually impractical because maybe there is no priori information on the operation is available and switching can destroy the stability of control systems therefore it is preferable to solve tracking and stabilization problems simultaneously using a single controller in do et al 2002 a single controller was designed to achieve tracking and stabilization simultaneously for underactuated surface ships with only surge force and yaw moment in behal et al 2002 a continuous time varying controller was presented by using a filtered error transformation with a dynamic oscillator to force the position and orientation errors globally exponentially to a neighborhood about zero based on the transverse function approach a single controller was designed for underactuated motorboat in hamel and samson 2016 to achieve practical stabilization of any smooth trajectory either feasible or non feasible in li 2018 and li 2019 two similar error state transformation schemes were presented to produce auxiliary variables satisfy pe conditions which can be applied to controllers to solve the problem of practical stabilization of arbitrary reference trajectories for underactuated ships a quite simple smooth feedback solution for simultaneous stabilization and tracking problem of nonholonomic mobile robots was presented in wang et al 2015 however the aforementioned results focus on planar underactuated systems and can not be applied to the three dimensional control problem of underactuated auvs to the author s best knowledge this problem was only addressed before in huang et al 2020 where a three dimensional tracking controller is designed for underactuated auvs to achieve practical convergence of tracking errors for general reference trajectories besides the underacutation the three dimensional tracking problem of underactuated auvs has other challenges caused by parametric uncertainties external disturbances unmeasurable states and input saturation many researches considering one or more these challenges have been presented based on numerous nonlinear control methods such as sliding mode control shojaei and arefi 2015 yu et al 2019 model predictive control li and yan 2016 fuzzy logic control liang et al 2020 neural network control shojaei and arefi 2015 shojaei 2019 wang et al 2019 duan et al 2020 huang et al 2021 observer based robust control tong et al 2020a b yu et al 2020 etc however to the author s best knowledge there is no research which has been presented to study the three dimensional tracking and stabilization problems simultaneously for underactuated auvs with consideration of the coupling effects caused by all the aforementioned challenges motivated by these observations this paper studies the three dimensional tracking problem for underactuated auvs subjected to parametric uncertainties unknown disturbances unmeasurable velocities and input saturation which under practical consideration includes the tasks of trajectory tracking and stabilization simultaneously a novel control strategy is proposed with the aid of a new error state modification a new high gain observer radial basis function neural network rbfnn approximations and the backstepping technique the main contributions and novelties of this paper are listed as follows 1 it is the first attempt to design a unified control strategy to solve the three dimensional trajectory tracking and stabilization problems simultaneously for underactuated auvs in presence of parametric uncertainties external disturbances unmeasured velocities and input saturation for this purpose a novel observer based neural adaptive controller is developed by combining with a new error state modification such that the global boundedness of tracking errors can be achieved and the input saturation constraints don t be violated 2 to estimate the unmeasured velocity signals a new high gain observer is presented to relax the constraints on the boundedness of available position and orientation signals 3 the combinations of high gain observer and rbfnns are employed to approximate unknown functions including parametric uncertainties and derivations of virtual controls which avoid computational complexities caused by the standard backstepping technique and make the expressions of actual controls more concise the rest of this paper is organized as follows in section 2 auv s model control objective and some useful preliminaries are introduced in section 3 the main results are presented including a new high gain observer an error state modification and the controllers in kinematic and dynamic levels stability analysis of the resultant closed loop system is presented in section 4 section 5 provides some numerical simulations to illustrate the effectiveness of the proposed controller finally a brief conclusion is summarized in section 6 notations throughout this paper the superscript t denotes the transpose of a matrix or a vector r n represents the n dimensional euclidean space denotes the euclidean norm of a vector or a matrix denotes the absolute value of a scalar quantity and diag denotes a diagonal matrix 2 problem statement and preliminaries 2 1 problem statement in this paper we consider an axial symmetric auv as shown in fig 1 assuming the effects of rolling motion are negligible the mathematic model of auv s dynamics can be given as follows fossen 2011 shojaei 2019 1 η j η ν m ν f ν τ τ w t where η x y z θ ψ t with x y z and θ ψ being the auv s position and orientation in the earth fixed frame respectively ν u v w q r t is the vector of the auv s velocities in the body fixed frame τ τ u 0 0 τ q τ r t is the input vector τ w τ w u τ w v τ w w τ w q τ w r t denotes the external disturbance vector due to wind currents and waves m diag m u m v m w m q m r is a positive definite matrix and denotes the auv s inertia including added mass j η is the transformation matrix between the earth fixed frame and body fixed frame which is given by 2 j η r η 0 3 2 0 2 3 t η r η cos ψ cos θ sin ψ cos ψ sin θ sin ψ cos θ cos ψ sin ψ sin θ sin θ 0 cos θ t η 1 0 0 1 cos θ f ν f u f v f w f q f r t with f i i u v w q r representing the nonlinear dynamics of auv including the centripetal coriolis hydrodynamic damping and gravitational terms whose components can be expressed as 3 f u m v v r m w w q d u u f v m u u r d v v f w m u u q d w w f q m w m u u w d q q g m l sin θ f r m u m v u v d r r in which d i 0 i u v w q r are the hydrodynamic coefficients and g m l denote the auv s tonnage and longitudinal metacentric height respectively in practice the control inputs of auvs are always subjected to saturation limits which can be formulated as 4 τ i τ i m i u q r where τ im 0 i u q r denote the maximum values of the corresponding inputs respectively assumption 1 the auv 1 satisfies that 1 the terms m and f are unknown 2 the auv s velocities are unmeasurable and bounded 3 the environmental disturbances are bounded i e τ wi τ wim i u v w q r with τ wim being known positive constants 4 the pitch angle θ satisfies θ θ m π 2 with θ m being a known positive constant control objective in this paper we aim to design saturated control inputs τ u τ q τ r for the auv 1 to track a smooth reference trajectory generated by a virtual underactuated auv model such that the tracking errors can be forced to globally converge to a bounded area centered at the origin without loss of generality the mathematic model of this virtual auv can be formulated by 5 η d j η d ν d m ν d f ν d τ d in which all of variables and parameters have similar definitions as that in 1 assumption 2 the reference trajectory satisfies that ν d and ν d are bounded vectors besides the reference pitch angle θ d in 5 satisfies θ d θ d m π 2 with θ dm being a known positive constant remark 1 it can be noticed that there is no limitation about whether the desired velocities in 5 satisfy persistent excited condition in assumption 2 thus the reference trajectory η d can be any smooth time varying trajectory or a fixed point which also implies that the control objective stated in this paper can be achieved under the situation only if the tracking and stabilization problems of the underacted auv 1 can be solved simultaneously to facilitate the upcoming controller designing procedure the tracking error states are firstly transformed into the following form 6 η e r t η 0 3 2 0 2 3 i 2 2 j η η η d where i 2 2 r 2 2 is the identity matrix since the matrix j η is globally invertible and det j 1 we have η e η η d differentiating 6 both sides along the solutions of 1 and 5 one can obtain 7 x e r y e q z e u e g x 1 sin θ e 2 g x 2 sin ψ e 2 y e r x e r z e tan θ v e g y sin ψ e 2 z e q x e r y e tan θ w e g z 1 sin θ e 2 g z 2 sin ψ e 2 θ e q e ψ e r e cos θ r d 1 cos θ 1 cos θ d with i e i i d i u v w q r being the velocity tracking errors and 8 g x 1 2 u d sin θ e 2 w d cos θ e 2 g x 2 2 cos θ v d cos ψ e 2 u d cos θ d sin ψ e 2 w d sin θ d sin ψ e 2 g y 2 u d cos θ d cos ψ e 2 v d sin ψ e 2 w d sin θ d cos ψ e 2 g z 1 2 u d cos θ e 2 w d sin θ e 2 g z 2 2 sin θ v d cos ψ e 2 u d cos θ d sin ψ e 2 w d sin θ d sin ψ e 2 then due to the definition of 6 the control objective can be transformed to stabilizing the transformed errors η e such that 9 lim t η e t ε η with ε η being a positive constant 2 2 high gain observer since the auv s velocities are unmeasurable the high gain observer can be applied to estimate these signals to implement the output feedback control strategy in this paper the approximate signals can be generated by a linear filter which is discussed in the following lemma lemma 1 behtash 1990 suppose a function ξ t and its first n derivatives are bounded such that ξ k ξ k k 0 1 n with ξ k being positive constants considering the following linear system 10 ε ζ i ζ i 1 i 1 2 n 1 ε ζ n a 1 ζ n a 2 ζ n 1 a n 1 ζ 2 ζ 1 ξ t where ε can be any small positive constant the parameters a 1 to a n 1 satisfy that the polynomial s n a 1 s n 1 a n 1 s 1 is hurwitz then there exist positive constants h i 1 i 1 2 n 1 and t such that for all t t the inequalities ξ i ζ i 1 ε i ε h i 1 hold 2 3 rbfnn approximation according to the universal approximation property rbfnn can be applied to approximate the parametric uncertainties involved in the control designing such that the following lemma holds lemma 2 park and sandberg 1991 tong et al 2020b for any continuous function f x r n i r over a compact set ω x r n i it can be approximated by a rbfnn with any given positive constant ϵ such that 11 f x w t φ x ϵ φ x φ 1 x φ 2 x φ n h x t φ i x exp x μ i 2 σ i 2 i 1 2 n h where w r n h is the ideal constant weight matrix n i and n h denote the numbers of input layer neurons and hidden layer neurons respectively φ i x denotes the ith gaussian basis function μ i r n i and σ i r are the center and standard derivation of the ith hidden node 3 controller design in this section a neural network adaptive output feedback controller is designed for the control inputs τ u τ q and τ r to stabilize the transformed tracking errors η e by using the backstepping technique the whole design procedure consists of three parts firstly a new high gain observer is introduced to estimate the velocities ν secondly an error state modification is introduced to deal with the underactuation finally by using the backstepping technique and rbfnn approximation method the actual controls are designed to stabilize the errors between the observations of u e and r e and their virtual controls the schematic diagram of the proposed controller is depicted in fig 2 3 1 high gain observer design due to the fact that the auv s velocities are not available for feedback we can t deal with them directly in designing procedure to overcome this difficulty the high gain observer with the form 10 is a typical choice for estimating these unmeasured signals however according to lemma 1 the observer 10 requires all of states involved to be bounded which implies that it maybe do not work when the domain of definition of the states η in 1 is an unbounded subset of r 5 under this consideration we introduce a new high gain observer in this subsection to begin with we firstly define a right continuous vector as follows 12 η t η t η t k t t k t k 1 where t k t 0 t 1 t 2 is a strictly increasing time sequence with t 0 0 being the initial time and δt t k 1 t k being the time step recalling assumption 1 we have η t t k t η s d s η max δ t with η max being the maximum value of η which implies that η t is always bounded besides due to the fact that η t k is a constant in each time interval we have 13 η t η t t t k t k 1 then we consider the high gain observer in the following form 14 ε π 1 π 2 ε π 2 γ 1 π 2 π 1 η where π 1 π 2 r 5 denote the state vectors of the high gain observer as a consequence due to the first equation of 1 the estimation of ν i e ν can be given by 15 ν j 1 η π 2 ε recalling the definition of j η one can yield that 16 j 1 η r t η 0 3 2 0 2 3 t 1 η t 1 η 1 0 0 cos θ which implies that j 1 η 1 then according to the first equation of 1 and lemma 1 the velocity estimation errors ν u v w q r t ν ν satisfy the following inequality 17 ν j 1 η η π 2 ε ε e ν with e ν being a positive constant which implies that the velocity estimation accuracy can be improved by choosing ε sufficiently small 3 2 error state modification a close look at 7 shows that the underactuated kinematics y e and z e are coupled with that of other directions through the acting terms q r g y g z1 and g z2 which implies that y e and z e can be stabilized through the regulation of other directions when those desired velocities are pe when these terms are not pe some new pe signals are needed with these observations and motivated by do et al 2002 hamel and samson 2016 and huang et al 2020 we define the following modified error states 18 θ e θ e δ θ ψ e ψ e δ ψ where δ θ and δ ψ are two bounded auxiliary time varying variables which are given by 19 c δ 2 δ i 2 c δ δ i δ i s i sin ω i t i θ ψ where c δ ω θ and ω ψ are positive constants to be chosen later s θ and s ψ are two bounded time varying functions with the following form 20 s θ 1 tanh ℓ ν u d 2 q d 2 tanh ℓ δ z e s ψ 1 tanh ℓ ν u d 2 r d 2 tanh ℓ δ y e in which ℓ ν 1 and ℓ δ are appropriate positive constants remark 2 due to 20 one can easily conclude that s θ tanh ℓ δ z e when u d 2 q d 2 0 s θ 0 when u d 2 q d 2 0 and similarly s ψ tanh ℓ δ y e when u d 2 r d 2 0 s ψ 0 when u d 2 r d 2 0 therefore by combining with 19 we yield that the auxiliary variables δ θ and δ ψ exponentially vanish when the desired velocities are pe on the other hand when the desired velocities are not pe these auxiliary variables will oscillate persistently until the tracking errors y e and z e converge to the origin roughly speaking these auxiliary variables do work only in stabilization cases which is different from the results stated in do et al 2002 and hamel and samson 2016 where the auxiliary variables work both in tracking and stabilization cases according to 18 and the knowledge of trigonometry we have sin i e 2 sin i e δ i 2 sin i e 2 1 2 δ i ξ i with ξ i 1 δ i cos δ i 1 sin i e 2 sin δ i cos i e 2 i θ ψ since cos δ i 1 δ i 0 1 sin ϖ δ i d ϖ and sin δ i δ i 0 1 cos ϖ δ i d ϖ i θ ψ are both bounded it can be easily seen that ξ θ and ξ ψ are both bounded too besides due to 8 the definitions of δ i i θ ψ and assumption 2 it can be obtained that g i δ j 0 i x 1 x 2 y z 1 z 2 j θ ψ with these observations and for the purpose of simplifying the designing procedure we assume g i δ j ξ j 0 i x 1 x 2 y z 1 z 2 j θ ψ then by using the modified errors θ e ψ and according to the above analysis we can rewrite 8 as follows 21 x e r y e q z e u e g x 1 sin θ e 2 g x 2 sin ψ e 2 y e r x e r z e tan θ v e g y sin ψ e 2 z e q x e r y e tan θ w e g z 1 sin θ e 2 g z 2 sin ψ e 2 θ e q e δ θ ψ e r e cos θ r d 1 cos θ 1 cos θ d δ ψ 3 3 observer based neural adaptive tracking controller design in this subsection a neural network adaptive three dimensional tracking controller is designed based on the high gain observer by using the backstepping technique the control design can be divided into two steps step 1 kinematic controller design for the purpose of stabilizing the error kinematics 21 we choose the velocities u q and r as virtual controls having the following form 22 α u k x x e l u d g x 1 sin θ e 2 g x 2 sin ψ e 2 α q k θ sin θ e 2 q d δ θ γ θ l g z 1 z e α r cos θ k ψ sin ψ e 2 r d cos θ d δ ψ γ ψ l g y y e g z 2 z e where α i i u q r denote the desired values of corresponding signals l 1 x e 2 y e 2 z e 2 k x k θ k ψ γ θ and γ ψ are positive constants then substituting 22 into 21 and defining e i i α i i u q r as virtual control errors we have 23 x e r y e q z e k x x e l e u y e r x e r z e tan θ v e g y sin ψ e 2 z e q x e r y e tan θ w e g z 1 sin θ e 2 g z 2 sin ψ e 2 θ e k θ sin θ e 2 e q γ θ l g z 1 z e ψ e k ψ sin ψ e 2 e r cos θ γ ψ l g y y e g z 2 z e step 2 dynamic controller design in this step we aim to seek appropriate control inputs τ i i u q r to stabilize the virtual control errors e i i u q r differentiating e i i u q r along the solutions of 1 and 22 yields 24 m i e i f i m i α i τ i τ w i i u q r from the part 1 and 2 of assumption 1 we know that m i and f i are unknown but bounded besides after a straightforward derivation of 22 we can conclude that α i i u q r are also bounded time varying functions then by lemma 2 it is known that the terms f i m i α i in 24 can be approximated by the following rbfnns 25 f i m i α i w i t φ i x i ϵ i i u q r where x u u v w q r α u t x q u w q α q sin θ t and x r u v r α r t are the input vectors of rbfnns w i and ϵ i i u q r denote the ideal weight vectors and approximation errors respectively to simplify the subsequent designing procedure the following assumption has been made for the above function approximation assumption 3 there are positive constants w im and ϵ im such that w i w i m and ϵ i ϵ i m substituting 25 into 24 yields 26 m i e i w i t φ i x i ϵ i τ i τ w i i u q r then based on the high gain observer 15 we choose the inputs τ i as 27 τ i k i tanh e i w i t φ i x i e 0 sgn e i χ i i u q r where k i i u q r are positive constants e i i α i is the estimated virtual control error and satisfies e i e i i sgn is the standard sign function e 0 max i u q r ϵ im τ wim x u u v w q r ϑ u ε t x q u w q ϑ q ε sin θ t x r u v r ϑ r ε t in which ϑ i i u q r are states of the following high gain observers 28 ε α i ϑ i ε ϑ i γ 1 ϑ i α i α i i u q r with α i being auxiliary variables w i is the estimated value of w i which due to assumption 3 can be determined by the following projection type updating law 29 w i γ w e i φ i x i w i w i m or w i t φ i x i e i 0 0 else with γ w 0 from the above updating law one can conclude that 1 when w i 0 w i m w i t w i m t 0 and 2 w i w i t w i γ w φ i x i e i 0 the compensation terms χ i are given by 30 χ u x e l χ q γ θ 1 sin θ e 2 χ r sin ψ e 2 γ ψ cos θ which due to the facts that x e l 1 sin θ e 2 1 sin ψ e 2 1 and cos θ cos θ m 0 implies that χ i χ im i u q r with χ um 1 χ q m γ θ 1 χ r m 1 γ ψ cos θ m substituting 27 into 26 yields the error dynamics as follows 31 m i e i k i tanh e i w i t φ i x i w i t φ i ϵ i τ w i e 0 sgn e i χ i i u q r where the relationship w i t φ i x i w i t φ i x i w i t φ i x i w i t φ i has been used with w i w i w i and φ i φ i x i φ i x i being estimation errors 4 stability analysis in this section the stability of the closed loop system is given by means of the following theorem theorem 1 consider the underactuated auv 1 and suppose assumptions 1 3 hold by choosing the parameters involved in the controller i e k i i u q r γ ψ γ θ and n h satisfying the following inequalities 32 k i n h w i m e 0 χ i m τ i m i u q r then the saturated control inputs given by 27 with the high gain observer 15 the modified error states 18 20 the virtual control law 22 and the adaptation law 29 can achieve the control objective 9 and do not violate the saturation constraints 4 proof consider the following lyapunov function candidate 33 v l 1 2 γ θ 1 1 cos θ e 2 2 γ ψ 1 1 cos ψ e 2 1 2 i u q r m i e i 2 γ w 1 w i t w i differentiating v along the solutions of 23 and 31 and after a simple calculation we can yield 34 v k x x e 2 l 2 l 1 y e v e z e w e k θ γ θ sin 2 θ e 2 k ψ γ ψ sin 2 ψ e 2 i u q r e i k i tanh e i w i t φ i x i w i t φ i ϵ i τ w i e 0 sgn e i γ w 1 w i t w i where the relationship w i w i has been used moreover due to the fact that e i e i i i u q r and the property 2 of the projection type updating law 29 we have 35 v k x x e 2 l 2 l 1 y e v e z e w e k θ γ θ sin 2 θ e 2 k ψ γ ψ sin 2 ψ e 2 i u q r e i i k i tanh e i w i t φ i x i w i t φ i ϵ i τ w i e 0 sgn e i w i t φ i x i e i k x x e 2 l 2 l 1 y e v e z e w e k θ γ θ sin 2 θ e 2 k ψ γ ψ sin 2 ψ e 2 i u q r k i e i tanh e i w i t φ i e i i w i t φ i x i ϵ i τ w i e 0 sgn e i then by using the following inequalities 36 y e l 1 z e l 1 e i e e i ε e ν v e v v d v m w e w w d w m w i 2 w i m φ x n h φ i ε e φ with v m w m e e and e φ being appropriate positive constants and according to assumptions 1 3 one can yield from 35 that 37 v k x x e 2 l 2 k θ γ θ sin 2 θ e 2 k ψ γ ψ sin 2 ψ e 2 i u q r k i e i tanh e i v m w m i u q r ε w i m e e e φ ε e ν 2 n h w i m 2 e 0 k θ 2 ξ 1 ε ξ 2 with 38 θ x e l sin θ e 2 sin ψ e 2 e u e q e r t k min k x k θ γ θ k ψ γ ψ k u k q k r ξ 1 v m w m ξ 2 i u q r w i m e e e φ 2 e ν n h w i m e 0 according to 37 we can obtain v 0 if θ ξ 1 ε ξ 2 k holds which implies that v is strictly decreasing and as a result the tracking errors x e y e z e θ e ψ e e u e q e r are asymptotically convergent otherwise if θ ξ 1 ε ξ 2 k holds one can conclude the boundedness of x e θ e ψ e e u e q e r straightforwardly due to the definition of θ and as a result the boundedness of e u e q e r can be also concluded via the application of the relationship between e i and e i i u q r and the velocity estimation inequality 17 besides if θ ξ 1 ε ξ 2 k holds one can obtain from the second and third equations of 23 that y e and z e can only oscillated with bounded frequencies because of the boundedness of the term r tan θ and as a result can also yield from the first equation of 23 that x e should be bounded to ensure the boundedness of x e which implies that the term ry e qz e should be bounded too on the other hand we know from 18 20 that r and q oscillate persistently with different frequencies when y e and z e are not equivalent to zero respectively and thus we can conclude from the boundedness of ry e qz e that y e and z e are bounded when θ ξ 1 ε ξ 2 k holds by far we have proved that x e y e z e θ e ψ e e u e q e r globally converge to bounded neighborhoods of the origin then by choosing an appropriate positive constant ε η we can conclude that lim t η t ε η which implies that the control objective 9 is achieved furthermore in order to prove that the control inputs 27 don t violate the saturation constraints 4 we can firstly yield from 27 that the following inequalities hold 39 τ i k i w i φ i e 0 χ i m i u q r then due to the facts that w i w i m and φ i n h we have 40 τ i k i n h w i m e 0 χ i m i u q r therefore when the parameters k i i u q r γ ψ γ θ and n h are chosen to satisfy 32 we can obtain straightforwardly τ i τ im which implies that the inputs don t violate the saturation constraints 4 this completes the proof remark 3 according to 37 it can be seen that the convergence area of θ is mainly decided by control parameters k x k θ k ψ k u k q and k r roughly speaking θ will decrease as these control parameters become large and vice versa more specifically larger k x k θ and k ψ can provide more acceptable convergent rates on tracking errors and while larger k u k q and k r can guarantee smaller steady tracking errors and more severe chattering phenomenon in addition the parameters γ θ and γ ψ not only have main impact on the decay rates of y e and z e but also decide the oscillation amplitudes of the orientation in the rbfnn approximations the parameter γ w decide the varying rate of the estimated weights n h has main impact on the precision of rbfnn approximation specifically larger n h can achieve higher precision of approximations but meanwhile can extremely add computation s burden in the high gain observer the exists of the time step δt maybe cause adverse impulses in the velocity estimations i e smaller δt causes smaller impulses but higher frequency oscillations thus designers should choose and adjust these parameters to obtain a good balance between control performance and design constraints 5 simulation results in this section some simulation results are presented to demonstrate the effectiveness of the proposed controller the auv s parameters used for these simulations are borrowed from shojaei 2019 which are given by m u 25 m v 17 5 m w 30 m q 22 5 m r 15 g m l 5 d u 30 d v 30 d w 30 d q 20 d r 20 the disturbances are chosen as τ wi t 2random 1 i u v w q r the input saturation limits are set as τ um τ qm τ rm 100 the reference trajectory is generated by 5 with the inputs being chosen as follows 41 τ d 10 0 0 0 0 t 0 100 10 0 0 1 1 t 100 350 0 0 0 0 0 t 350 which implies that the reference trajectory consisting of a straight line at the first 100s a spatial circle at time interval t 100 350 and a fixed point at rest time the initial desired conditions are set as η d 0 0 0 10 0 0 t and ν d 0 0 0 0 0 0 t while the destination of the reference trajectory is set as 30 8 40 0 0 the initial conditions of the actual auv are chosen as η 0 15 15 0 π 6 π 4 t and ν 0 0 0 0 0 0 t the control and high gain observer parameters are taken as k x 2 5 k θ k ψ 0 5 γ θ γ ψ 0 5 k u 25 k q k r 20 e 0 15 γ w 5 c δ 0 2 ℓ ν 20 ℓ δ 10 ω θ 0 4 ω ψ 0 6 ε 0 1 γ 1 2 and δt 50 the centers and derivations of rbfnns are selected on regular lattices in respective compact sets specifically the rbfnn w u t φ u x u contains 8 nodes with the centers evenly spaced in the interval 2 2 0 0 0 1 1 1 1 and derivations equal to 4 the rbfnn w q t φ q x q contains 8 nodes with the centers evenly spaced in the interval 2 2 0 0 1 1 1 1 and derivations equal to 1 and the rbfnn w r t φ r x r contains 8 nodes with the centers evenly spaced in the interval 2 2 0 1 1 1 1 and derivations equal to 1 besides the bounds of weights of these rbfnns are selected as w um w qm w rm 20 the simulation results are illustrated in figs 3 7 where fig 3 shows the reference trajectory and actual trajectory generated by the proposed controller fig 4 depicts the time evolutions of auv s posture tracking errors the time responses of control inputs and δ i i θ ψ and high gain estimation errors are illustrated in figs 5 and 6 respectively fig 7 shows the results of rbfnn approximations where the notations f e i f i m i α i w i φ i x i i u q r have been used for clarity it can be seen from above figures that the proposed controller has acceptable performances against the adverse effects of parametric uncertainties external disturbances and input saturation especially one can see that the proposed controller can work with a unified control structure and the same choice of control parameters whenever the desired velocities satisfy pe condition or not which is the most important and interesting part of our method furthermore some comparative simulations by using the proposed method and that designed in rezazadegan et al 2015 are also presented in these simulations the reference inputs of 5 are considered as 42 τ u d 1 5 d u m v v r m w w q t 1150 0 t 1150 43 τ q d m w m u u w d q q g m l sin θ m q θ 0 1 q t 1150 0 t 1150 44 τ r d m u m v u v t 150 m u m v u v 100 483 sin 0 0061 t cos 0 0061 t t 150 1150 0 t 1150 in addition the disturbances are increased as τ wi t 2 5sgn i 5 sin 0 1t i u v w q r to evaluate the controller robustness the initial desired conditions are set as η d 0 0 0 0 0 0 t and ν d 0 0 0 0 0 0 t while the destination of the reference trajectory is set as 250 50 150 0 0 the initial conditions of the actual auv are chosen as η 0 30 50 30 0 0 t and ν 0 0 0 0 0 0 t the control and rbfnn parameters are selected as same as the previous simulations except δt which is set as δt 200 here for the sake of smoothness of estimation errors the comparative results are plotted in figs 8 10 from above figures one can see that both controllers can stabilize the tracking errors and guarantee acceptable performance in the first 1150s while the proposed controller achieve a slightly better performance on orientation tracking errors for the rest time of simulations the proposed controller can achieve a consistent tracking performance as it has done in the first 1150s and meanwhile some tracking errors can t be stabilized anymore by the controller designed in rezazadegan et al 2015 because the pe condition is not satisfied in this time interval 6 conclusion in this paper a neural adaptive output feedback three dimensional tracking controller has been proposed for underactuated auvs subjected to parametric uncertainties external disturbances and input saturation a new error state modification form has been introduced to deal with the situation that the desired velocities do not satisfy pe condition to estimate unmeasured velocity signals a modified high gain observer has been designed which can relax the constraints on the boundedness of position signals three rbfnns have been adopted to approximate the unknown functions including modeling uncertainties and complex derivations of virtual controls based on these results the whole control strategy has been designed by using the backstepping technique and lyapunov theory to guarantee the tracking errors convergent to a bounded neighborhood of the origin finally some simulations have been performed to illustrate the effectiveness and robustness of the proposed controller credit authorship contribution statement kai fang conceptualization methodology software validation writing original draft haolin fang software validation writing original draft jiawen zhang investigation software validation jiaqi yao data curation formal analysis jiawang li conceptualization supervision methodology software validation formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20553,this paper addresses the three dimensional tracking and stabilization problems simultaneously for underactuated autonomous underwater vehicles auvs subjected to parametric uncertainties external disturbances unmeasured states and input saturation a modified error state formulation is introduced to produce auxiliary virtual controls for the underactuated kinematics a new high gain observer is proposed to estimate unavailable velocities which doesn t need the position and orientation of auvs to be bounded based on the backstepping technique and combinations of high gain observer and radial basis function neural network rbfnn approximations the kinematic and dynamic controllers are designed to force underactuated auvs to track a time varying trajectory or and a stationary point and guarantees the tracking errors convergent to a bounded neighborhood of the origin some comparative simulations are presented to validate the effectiveness and performance of the proposed control scheme keywords underactuated underwater vehicles three dimensional control neural networks output feedback tracking and stabilization 1 introduction in recent decades autonomous underwater vehicles auvs play more and more important roles in a wide range of civilian and military applications such as marine surveys ocean explorations pipe inspections and underwater rescue etc which also make the motion control of auvs to receive widespread attention from control communities compared to fully actuated auvs underactuated auvs have fewer independent actuators than their degrees of freedom dof as a result the main challenge in control problem of underactuated auvs is that there is no continuous time invariant state feedback laws to stabilize them brockett 1983 the three dimensional or spacial control problem of underactuated auvs with temporal constraints is usually divided into two distinct subproblems trajectory tracking and stabilization trajectory tracking control aims to force the auv to track a time varying spacial position and orientation where at least one of reference signals satisfies persistent excitation pe condition see chambrion and sigalotti 2008 rezazadegan et al 2015 cassu et al 2015 wang et al 2019 yu et al 2020 huang et al 2021 and the references therein on the contrary stabilization control requires the auv converge to a stationary point with a predefined posture see pettersen and egeland 1999 li and yan 2016 li et al 2018 niu and geng 2019 and the references therein besides for the purpose of reduce the difficulties caused by the underactuation there are lots of researches addressed the three dimensional control problem of underactuated vehicles such that only the number of state errors not more than dof can be controlled see aguiar and hespanha 2007 do 2013 shojaei and arefi 2015 shojaei and dolatshahi 2017 shojaei 2019 zhou et al 2018 yu et al 2019 duan et al 2020 liang et al 2020 and the references therein however in some complicated operations underactuated auvs maybe need to realize trajectory tracking and stabilization simultaneously where the aforementioned results can t be used stand alone on the other hand switching between trajectory tracking and stabilization controllers in one continuous operation is usually impractical because maybe there is no priori information on the operation is available and switching can destroy the stability of control systems therefore it is preferable to solve tracking and stabilization problems simultaneously using a single controller in do et al 2002 a single controller was designed to achieve tracking and stabilization simultaneously for underactuated surface ships with only surge force and yaw moment in behal et al 2002 a continuous time varying controller was presented by using a filtered error transformation with a dynamic oscillator to force the position and orientation errors globally exponentially to a neighborhood about zero based on the transverse function approach a single controller was designed for underactuated motorboat in hamel and samson 2016 to achieve practical stabilization of any smooth trajectory either feasible or non feasible in li 2018 and li 2019 two similar error state transformation schemes were presented to produce auxiliary variables satisfy pe conditions which can be applied to controllers to solve the problem of practical stabilization of arbitrary reference trajectories for underactuated ships a quite simple smooth feedback solution for simultaneous stabilization and tracking problem of nonholonomic mobile robots was presented in wang et al 2015 however the aforementioned results focus on planar underactuated systems and can not be applied to the three dimensional control problem of underactuated auvs to the author s best knowledge this problem was only addressed before in huang et al 2020 where a three dimensional tracking controller is designed for underactuated auvs to achieve practical convergence of tracking errors for general reference trajectories besides the underacutation the three dimensional tracking problem of underactuated auvs has other challenges caused by parametric uncertainties external disturbances unmeasurable states and input saturation many researches considering one or more these challenges have been presented based on numerous nonlinear control methods such as sliding mode control shojaei and arefi 2015 yu et al 2019 model predictive control li and yan 2016 fuzzy logic control liang et al 2020 neural network control shojaei and arefi 2015 shojaei 2019 wang et al 2019 duan et al 2020 huang et al 2021 observer based robust control tong et al 2020a b yu et al 2020 etc however to the author s best knowledge there is no research which has been presented to study the three dimensional tracking and stabilization problems simultaneously for underactuated auvs with consideration of the coupling effects caused by all the aforementioned challenges motivated by these observations this paper studies the three dimensional tracking problem for underactuated auvs subjected to parametric uncertainties unknown disturbances unmeasurable velocities and input saturation which under practical consideration includes the tasks of trajectory tracking and stabilization simultaneously a novel control strategy is proposed with the aid of a new error state modification a new high gain observer radial basis function neural network rbfnn approximations and the backstepping technique the main contributions and novelties of this paper are listed as follows 1 it is the first attempt to design a unified control strategy to solve the three dimensional trajectory tracking and stabilization problems simultaneously for underactuated auvs in presence of parametric uncertainties external disturbances unmeasured velocities and input saturation for this purpose a novel observer based neural adaptive controller is developed by combining with a new error state modification such that the global boundedness of tracking errors can be achieved and the input saturation constraints don t be violated 2 to estimate the unmeasured velocity signals a new high gain observer is presented to relax the constraints on the boundedness of available position and orientation signals 3 the combinations of high gain observer and rbfnns are employed to approximate unknown functions including parametric uncertainties and derivations of virtual controls which avoid computational complexities caused by the standard backstepping technique and make the expressions of actual controls more concise the rest of this paper is organized as follows in section 2 auv s model control objective and some useful preliminaries are introduced in section 3 the main results are presented including a new high gain observer an error state modification and the controllers in kinematic and dynamic levels stability analysis of the resultant closed loop system is presented in section 4 section 5 provides some numerical simulations to illustrate the effectiveness of the proposed controller finally a brief conclusion is summarized in section 6 notations throughout this paper the superscript t denotes the transpose of a matrix or a vector r n represents the n dimensional euclidean space denotes the euclidean norm of a vector or a matrix denotes the absolute value of a scalar quantity and diag denotes a diagonal matrix 2 problem statement and preliminaries 2 1 problem statement in this paper we consider an axial symmetric auv as shown in fig 1 assuming the effects of rolling motion are negligible the mathematic model of auv s dynamics can be given as follows fossen 2011 shojaei 2019 1 η j η ν m ν f ν τ τ w t where η x y z θ ψ t with x y z and θ ψ being the auv s position and orientation in the earth fixed frame respectively ν u v w q r t is the vector of the auv s velocities in the body fixed frame τ τ u 0 0 τ q τ r t is the input vector τ w τ w u τ w v τ w w τ w q τ w r t denotes the external disturbance vector due to wind currents and waves m diag m u m v m w m q m r is a positive definite matrix and denotes the auv s inertia including added mass j η is the transformation matrix between the earth fixed frame and body fixed frame which is given by 2 j η r η 0 3 2 0 2 3 t η r η cos ψ cos θ sin ψ cos ψ sin θ sin ψ cos θ cos ψ sin ψ sin θ sin θ 0 cos θ t η 1 0 0 1 cos θ f ν f u f v f w f q f r t with f i i u v w q r representing the nonlinear dynamics of auv including the centripetal coriolis hydrodynamic damping and gravitational terms whose components can be expressed as 3 f u m v v r m w w q d u u f v m u u r d v v f w m u u q d w w f q m w m u u w d q q g m l sin θ f r m u m v u v d r r in which d i 0 i u v w q r are the hydrodynamic coefficients and g m l denote the auv s tonnage and longitudinal metacentric height respectively in practice the control inputs of auvs are always subjected to saturation limits which can be formulated as 4 τ i τ i m i u q r where τ im 0 i u q r denote the maximum values of the corresponding inputs respectively assumption 1 the auv 1 satisfies that 1 the terms m and f are unknown 2 the auv s velocities are unmeasurable and bounded 3 the environmental disturbances are bounded i e τ wi τ wim i u v w q r with τ wim being known positive constants 4 the pitch angle θ satisfies θ θ m π 2 with θ m being a known positive constant control objective in this paper we aim to design saturated control inputs τ u τ q τ r for the auv 1 to track a smooth reference trajectory generated by a virtual underactuated auv model such that the tracking errors can be forced to globally converge to a bounded area centered at the origin without loss of generality the mathematic model of this virtual auv can be formulated by 5 η d j η d ν d m ν d f ν d τ d in which all of variables and parameters have similar definitions as that in 1 assumption 2 the reference trajectory satisfies that ν d and ν d are bounded vectors besides the reference pitch angle θ d in 5 satisfies θ d θ d m π 2 with θ dm being a known positive constant remark 1 it can be noticed that there is no limitation about whether the desired velocities in 5 satisfy persistent excited condition in assumption 2 thus the reference trajectory η d can be any smooth time varying trajectory or a fixed point which also implies that the control objective stated in this paper can be achieved under the situation only if the tracking and stabilization problems of the underacted auv 1 can be solved simultaneously to facilitate the upcoming controller designing procedure the tracking error states are firstly transformed into the following form 6 η e r t η 0 3 2 0 2 3 i 2 2 j η η η d where i 2 2 r 2 2 is the identity matrix since the matrix j η is globally invertible and det j 1 we have η e η η d differentiating 6 both sides along the solutions of 1 and 5 one can obtain 7 x e r y e q z e u e g x 1 sin θ e 2 g x 2 sin ψ e 2 y e r x e r z e tan θ v e g y sin ψ e 2 z e q x e r y e tan θ w e g z 1 sin θ e 2 g z 2 sin ψ e 2 θ e q e ψ e r e cos θ r d 1 cos θ 1 cos θ d with i e i i d i u v w q r being the velocity tracking errors and 8 g x 1 2 u d sin θ e 2 w d cos θ e 2 g x 2 2 cos θ v d cos ψ e 2 u d cos θ d sin ψ e 2 w d sin θ d sin ψ e 2 g y 2 u d cos θ d cos ψ e 2 v d sin ψ e 2 w d sin θ d cos ψ e 2 g z 1 2 u d cos θ e 2 w d sin θ e 2 g z 2 2 sin θ v d cos ψ e 2 u d cos θ d sin ψ e 2 w d sin θ d sin ψ e 2 then due to the definition of 6 the control objective can be transformed to stabilizing the transformed errors η e such that 9 lim t η e t ε η with ε η being a positive constant 2 2 high gain observer since the auv s velocities are unmeasurable the high gain observer can be applied to estimate these signals to implement the output feedback control strategy in this paper the approximate signals can be generated by a linear filter which is discussed in the following lemma lemma 1 behtash 1990 suppose a function ξ t and its first n derivatives are bounded such that ξ k ξ k k 0 1 n with ξ k being positive constants considering the following linear system 10 ε ζ i ζ i 1 i 1 2 n 1 ε ζ n a 1 ζ n a 2 ζ n 1 a n 1 ζ 2 ζ 1 ξ t where ε can be any small positive constant the parameters a 1 to a n 1 satisfy that the polynomial s n a 1 s n 1 a n 1 s 1 is hurwitz then there exist positive constants h i 1 i 1 2 n 1 and t such that for all t t the inequalities ξ i ζ i 1 ε i ε h i 1 hold 2 3 rbfnn approximation according to the universal approximation property rbfnn can be applied to approximate the parametric uncertainties involved in the control designing such that the following lemma holds lemma 2 park and sandberg 1991 tong et al 2020b for any continuous function f x r n i r over a compact set ω x r n i it can be approximated by a rbfnn with any given positive constant ϵ such that 11 f x w t φ x ϵ φ x φ 1 x φ 2 x φ n h x t φ i x exp x μ i 2 σ i 2 i 1 2 n h where w r n h is the ideal constant weight matrix n i and n h denote the numbers of input layer neurons and hidden layer neurons respectively φ i x denotes the ith gaussian basis function μ i r n i and σ i r are the center and standard derivation of the ith hidden node 3 controller design in this section a neural network adaptive output feedback controller is designed for the control inputs τ u τ q and τ r to stabilize the transformed tracking errors η e by using the backstepping technique the whole design procedure consists of three parts firstly a new high gain observer is introduced to estimate the velocities ν secondly an error state modification is introduced to deal with the underactuation finally by using the backstepping technique and rbfnn approximation method the actual controls are designed to stabilize the errors between the observations of u e and r e and their virtual controls the schematic diagram of the proposed controller is depicted in fig 2 3 1 high gain observer design due to the fact that the auv s velocities are not available for feedback we can t deal with them directly in designing procedure to overcome this difficulty the high gain observer with the form 10 is a typical choice for estimating these unmeasured signals however according to lemma 1 the observer 10 requires all of states involved to be bounded which implies that it maybe do not work when the domain of definition of the states η in 1 is an unbounded subset of r 5 under this consideration we introduce a new high gain observer in this subsection to begin with we firstly define a right continuous vector as follows 12 η t η t η t k t t k t k 1 where t k t 0 t 1 t 2 is a strictly increasing time sequence with t 0 0 being the initial time and δt t k 1 t k being the time step recalling assumption 1 we have η t t k t η s d s η max δ t with η max being the maximum value of η which implies that η t is always bounded besides due to the fact that η t k is a constant in each time interval we have 13 η t η t t t k t k 1 then we consider the high gain observer in the following form 14 ε π 1 π 2 ε π 2 γ 1 π 2 π 1 η where π 1 π 2 r 5 denote the state vectors of the high gain observer as a consequence due to the first equation of 1 the estimation of ν i e ν can be given by 15 ν j 1 η π 2 ε recalling the definition of j η one can yield that 16 j 1 η r t η 0 3 2 0 2 3 t 1 η t 1 η 1 0 0 cos θ which implies that j 1 η 1 then according to the first equation of 1 and lemma 1 the velocity estimation errors ν u v w q r t ν ν satisfy the following inequality 17 ν j 1 η η π 2 ε ε e ν with e ν being a positive constant which implies that the velocity estimation accuracy can be improved by choosing ε sufficiently small 3 2 error state modification a close look at 7 shows that the underactuated kinematics y e and z e are coupled with that of other directions through the acting terms q r g y g z1 and g z2 which implies that y e and z e can be stabilized through the regulation of other directions when those desired velocities are pe when these terms are not pe some new pe signals are needed with these observations and motivated by do et al 2002 hamel and samson 2016 and huang et al 2020 we define the following modified error states 18 θ e θ e δ θ ψ e ψ e δ ψ where δ θ and δ ψ are two bounded auxiliary time varying variables which are given by 19 c δ 2 δ i 2 c δ δ i δ i s i sin ω i t i θ ψ where c δ ω θ and ω ψ are positive constants to be chosen later s θ and s ψ are two bounded time varying functions with the following form 20 s θ 1 tanh ℓ ν u d 2 q d 2 tanh ℓ δ z e s ψ 1 tanh ℓ ν u d 2 r d 2 tanh ℓ δ y e in which ℓ ν 1 and ℓ δ are appropriate positive constants remark 2 due to 20 one can easily conclude that s θ tanh ℓ δ z e when u d 2 q d 2 0 s θ 0 when u d 2 q d 2 0 and similarly s ψ tanh ℓ δ y e when u d 2 r d 2 0 s ψ 0 when u d 2 r d 2 0 therefore by combining with 19 we yield that the auxiliary variables δ θ and δ ψ exponentially vanish when the desired velocities are pe on the other hand when the desired velocities are not pe these auxiliary variables will oscillate persistently until the tracking errors y e and z e converge to the origin roughly speaking these auxiliary variables do work only in stabilization cases which is different from the results stated in do et al 2002 and hamel and samson 2016 where the auxiliary variables work both in tracking and stabilization cases according to 18 and the knowledge of trigonometry we have sin i e 2 sin i e δ i 2 sin i e 2 1 2 δ i ξ i with ξ i 1 δ i cos δ i 1 sin i e 2 sin δ i cos i e 2 i θ ψ since cos δ i 1 δ i 0 1 sin ϖ δ i d ϖ and sin δ i δ i 0 1 cos ϖ δ i d ϖ i θ ψ are both bounded it can be easily seen that ξ θ and ξ ψ are both bounded too besides due to 8 the definitions of δ i i θ ψ and assumption 2 it can be obtained that g i δ j 0 i x 1 x 2 y z 1 z 2 j θ ψ with these observations and for the purpose of simplifying the designing procedure we assume g i δ j ξ j 0 i x 1 x 2 y z 1 z 2 j θ ψ then by using the modified errors θ e ψ and according to the above analysis we can rewrite 8 as follows 21 x e r y e q z e u e g x 1 sin θ e 2 g x 2 sin ψ e 2 y e r x e r z e tan θ v e g y sin ψ e 2 z e q x e r y e tan θ w e g z 1 sin θ e 2 g z 2 sin ψ e 2 θ e q e δ θ ψ e r e cos θ r d 1 cos θ 1 cos θ d δ ψ 3 3 observer based neural adaptive tracking controller design in this subsection a neural network adaptive three dimensional tracking controller is designed based on the high gain observer by using the backstepping technique the control design can be divided into two steps step 1 kinematic controller design for the purpose of stabilizing the error kinematics 21 we choose the velocities u q and r as virtual controls having the following form 22 α u k x x e l u d g x 1 sin θ e 2 g x 2 sin ψ e 2 α q k θ sin θ e 2 q d δ θ γ θ l g z 1 z e α r cos θ k ψ sin ψ e 2 r d cos θ d δ ψ γ ψ l g y y e g z 2 z e where α i i u q r denote the desired values of corresponding signals l 1 x e 2 y e 2 z e 2 k x k θ k ψ γ θ and γ ψ are positive constants then substituting 22 into 21 and defining e i i α i i u q r as virtual control errors we have 23 x e r y e q z e k x x e l e u y e r x e r z e tan θ v e g y sin ψ e 2 z e q x e r y e tan θ w e g z 1 sin θ e 2 g z 2 sin ψ e 2 θ e k θ sin θ e 2 e q γ θ l g z 1 z e ψ e k ψ sin ψ e 2 e r cos θ γ ψ l g y y e g z 2 z e step 2 dynamic controller design in this step we aim to seek appropriate control inputs τ i i u q r to stabilize the virtual control errors e i i u q r differentiating e i i u q r along the solutions of 1 and 22 yields 24 m i e i f i m i α i τ i τ w i i u q r from the part 1 and 2 of assumption 1 we know that m i and f i are unknown but bounded besides after a straightforward derivation of 22 we can conclude that α i i u q r are also bounded time varying functions then by lemma 2 it is known that the terms f i m i α i in 24 can be approximated by the following rbfnns 25 f i m i α i w i t φ i x i ϵ i i u q r where x u u v w q r α u t x q u w q α q sin θ t and x r u v r α r t are the input vectors of rbfnns w i and ϵ i i u q r denote the ideal weight vectors and approximation errors respectively to simplify the subsequent designing procedure the following assumption has been made for the above function approximation assumption 3 there are positive constants w im and ϵ im such that w i w i m and ϵ i ϵ i m substituting 25 into 24 yields 26 m i e i w i t φ i x i ϵ i τ i τ w i i u q r then based on the high gain observer 15 we choose the inputs τ i as 27 τ i k i tanh e i w i t φ i x i e 0 sgn e i χ i i u q r where k i i u q r are positive constants e i i α i is the estimated virtual control error and satisfies e i e i i sgn is the standard sign function e 0 max i u q r ϵ im τ wim x u u v w q r ϑ u ε t x q u w q ϑ q ε sin θ t x r u v r ϑ r ε t in which ϑ i i u q r are states of the following high gain observers 28 ε α i ϑ i ε ϑ i γ 1 ϑ i α i α i i u q r with α i being auxiliary variables w i is the estimated value of w i which due to assumption 3 can be determined by the following projection type updating law 29 w i γ w e i φ i x i w i w i m or w i t φ i x i e i 0 0 else with γ w 0 from the above updating law one can conclude that 1 when w i 0 w i m w i t w i m t 0 and 2 w i w i t w i γ w φ i x i e i 0 the compensation terms χ i are given by 30 χ u x e l χ q γ θ 1 sin θ e 2 χ r sin ψ e 2 γ ψ cos θ which due to the facts that x e l 1 sin θ e 2 1 sin ψ e 2 1 and cos θ cos θ m 0 implies that χ i χ im i u q r with χ um 1 χ q m γ θ 1 χ r m 1 γ ψ cos θ m substituting 27 into 26 yields the error dynamics as follows 31 m i e i k i tanh e i w i t φ i x i w i t φ i ϵ i τ w i e 0 sgn e i χ i i u q r where the relationship w i t φ i x i w i t φ i x i w i t φ i x i w i t φ i has been used with w i w i w i and φ i φ i x i φ i x i being estimation errors 4 stability analysis in this section the stability of the closed loop system is given by means of the following theorem theorem 1 consider the underactuated auv 1 and suppose assumptions 1 3 hold by choosing the parameters involved in the controller i e k i i u q r γ ψ γ θ and n h satisfying the following inequalities 32 k i n h w i m e 0 χ i m τ i m i u q r then the saturated control inputs given by 27 with the high gain observer 15 the modified error states 18 20 the virtual control law 22 and the adaptation law 29 can achieve the control objective 9 and do not violate the saturation constraints 4 proof consider the following lyapunov function candidate 33 v l 1 2 γ θ 1 1 cos θ e 2 2 γ ψ 1 1 cos ψ e 2 1 2 i u q r m i e i 2 γ w 1 w i t w i differentiating v along the solutions of 23 and 31 and after a simple calculation we can yield 34 v k x x e 2 l 2 l 1 y e v e z e w e k θ γ θ sin 2 θ e 2 k ψ γ ψ sin 2 ψ e 2 i u q r e i k i tanh e i w i t φ i x i w i t φ i ϵ i τ w i e 0 sgn e i γ w 1 w i t w i where the relationship w i w i has been used moreover due to the fact that e i e i i i u q r and the property 2 of the projection type updating law 29 we have 35 v k x x e 2 l 2 l 1 y e v e z e w e k θ γ θ sin 2 θ e 2 k ψ γ ψ sin 2 ψ e 2 i u q r e i i k i tanh e i w i t φ i x i w i t φ i ϵ i τ w i e 0 sgn e i w i t φ i x i e i k x x e 2 l 2 l 1 y e v e z e w e k θ γ θ sin 2 θ e 2 k ψ γ ψ sin 2 ψ e 2 i u q r k i e i tanh e i w i t φ i e i i w i t φ i x i ϵ i τ w i e 0 sgn e i then by using the following inequalities 36 y e l 1 z e l 1 e i e e i ε e ν v e v v d v m w e w w d w m w i 2 w i m φ x n h φ i ε e φ with v m w m e e and e φ being appropriate positive constants and according to assumptions 1 3 one can yield from 35 that 37 v k x x e 2 l 2 k θ γ θ sin 2 θ e 2 k ψ γ ψ sin 2 ψ e 2 i u q r k i e i tanh e i v m w m i u q r ε w i m e e e φ ε e ν 2 n h w i m 2 e 0 k θ 2 ξ 1 ε ξ 2 with 38 θ x e l sin θ e 2 sin ψ e 2 e u e q e r t k min k x k θ γ θ k ψ γ ψ k u k q k r ξ 1 v m w m ξ 2 i u q r w i m e e e φ 2 e ν n h w i m e 0 according to 37 we can obtain v 0 if θ ξ 1 ε ξ 2 k holds which implies that v is strictly decreasing and as a result the tracking errors x e y e z e θ e ψ e e u e q e r are asymptotically convergent otherwise if θ ξ 1 ε ξ 2 k holds one can conclude the boundedness of x e θ e ψ e e u e q e r straightforwardly due to the definition of θ and as a result the boundedness of e u e q e r can be also concluded via the application of the relationship between e i and e i i u q r and the velocity estimation inequality 17 besides if θ ξ 1 ε ξ 2 k holds one can obtain from the second and third equations of 23 that y e and z e can only oscillated with bounded frequencies because of the boundedness of the term r tan θ and as a result can also yield from the first equation of 23 that x e should be bounded to ensure the boundedness of x e which implies that the term ry e qz e should be bounded too on the other hand we know from 18 20 that r and q oscillate persistently with different frequencies when y e and z e are not equivalent to zero respectively and thus we can conclude from the boundedness of ry e qz e that y e and z e are bounded when θ ξ 1 ε ξ 2 k holds by far we have proved that x e y e z e θ e ψ e e u e q e r globally converge to bounded neighborhoods of the origin then by choosing an appropriate positive constant ε η we can conclude that lim t η t ε η which implies that the control objective 9 is achieved furthermore in order to prove that the control inputs 27 don t violate the saturation constraints 4 we can firstly yield from 27 that the following inequalities hold 39 τ i k i w i φ i e 0 χ i m i u q r then due to the facts that w i w i m and φ i n h we have 40 τ i k i n h w i m e 0 χ i m i u q r therefore when the parameters k i i u q r γ ψ γ θ and n h are chosen to satisfy 32 we can obtain straightforwardly τ i τ im which implies that the inputs don t violate the saturation constraints 4 this completes the proof remark 3 according to 37 it can be seen that the convergence area of θ is mainly decided by control parameters k x k θ k ψ k u k q and k r roughly speaking θ will decrease as these control parameters become large and vice versa more specifically larger k x k θ and k ψ can provide more acceptable convergent rates on tracking errors and while larger k u k q and k r can guarantee smaller steady tracking errors and more severe chattering phenomenon in addition the parameters γ θ and γ ψ not only have main impact on the decay rates of y e and z e but also decide the oscillation amplitudes of the orientation in the rbfnn approximations the parameter γ w decide the varying rate of the estimated weights n h has main impact on the precision of rbfnn approximation specifically larger n h can achieve higher precision of approximations but meanwhile can extremely add computation s burden in the high gain observer the exists of the time step δt maybe cause adverse impulses in the velocity estimations i e smaller δt causes smaller impulses but higher frequency oscillations thus designers should choose and adjust these parameters to obtain a good balance between control performance and design constraints 5 simulation results in this section some simulation results are presented to demonstrate the effectiveness of the proposed controller the auv s parameters used for these simulations are borrowed from shojaei 2019 which are given by m u 25 m v 17 5 m w 30 m q 22 5 m r 15 g m l 5 d u 30 d v 30 d w 30 d q 20 d r 20 the disturbances are chosen as τ wi t 2random 1 i u v w q r the input saturation limits are set as τ um τ qm τ rm 100 the reference trajectory is generated by 5 with the inputs being chosen as follows 41 τ d 10 0 0 0 0 t 0 100 10 0 0 1 1 t 100 350 0 0 0 0 0 t 350 which implies that the reference trajectory consisting of a straight line at the first 100s a spatial circle at time interval t 100 350 and a fixed point at rest time the initial desired conditions are set as η d 0 0 0 10 0 0 t and ν d 0 0 0 0 0 0 t while the destination of the reference trajectory is set as 30 8 40 0 0 the initial conditions of the actual auv are chosen as η 0 15 15 0 π 6 π 4 t and ν 0 0 0 0 0 0 t the control and high gain observer parameters are taken as k x 2 5 k θ k ψ 0 5 γ θ γ ψ 0 5 k u 25 k q k r 20 e 0 15 γ w 5 c δ 0 2 ℓ ν 20 ℓ δ 10 ω θ 0 4 ω ψ 0 6 ε 0 1 γ 1 2 and δt 50 the centers and derivations of rbfnns are selected on regular lattices in respective compact sets specifically the rbfnn w u t φ u x u contains 8 nodes with the centers evenly spaced in the interval 2 2 0 0 0 1 1 1 1 and derivations equal to 4 the rbfnn w q t φ q x q contains 8 nodes with the centers evenly spaced in the interval 2 2 0 0 1 1 1 1 and derivations equal to 1 and the rbfnn w r t φ r x r contains 8 nodes with the centers evenly spaced in the interval 2 2 0 1 1 1 1 and derivations equal to 1 besides the bounds of weights of these rbfnns are selected as w um w qm w rm 20 the simulation results are illustrated in figs 3 7 where fig 3 shows the reference trajectory and actual trajectory generated by the proposed controller fig 4 depicts the time evolutions of auv s posture tracking errors the time responses of control inputs and δ i i θ ψ and high gain estimation errors are illustrated in figs 5 and 6 respectively fig 7 shows the results of rbfnn approximations where the notations f e i f i m i α i w i φ i x i i u q r have been used for clarity it can be seen from above figures that the proposed controller has acceptable performances against the adverse effects of parametric uncertainties external disturbances and input saturation especially one can see that the proposed controller can work with a unified control structure and the same choice of control parameters whenever the desired velocities satisfy pe condition or not which is the most important and interesting part of our method furthermore some comparative simulations by using the proposed method and that designed in rezazadegan et al 2015 are also presented in these simulations the reference inputs of 5 are considered as 42 τ u d 1 5 d u m v v r m w w q t 1150 0 t 1150 43 τ q d m w m u u w d q q g m l sin θ m q θ 0 1 q t 1150 0 t 1150 44 τ r d m u m v u v t 150 m u m v u v 100 483 sin 0 0061 t cos 0 0061 t t 150 1150 0 t 1150 in addition the disturbances are increased as τ wi t 2 5sgn i 5 sin 0 1t i u v w q r to evaluate the controller robustness the initial desired conditions are set as η d 0 0 0 0 0 0 t and ν d 0 0 0 0 0 0 t while the destination of the reference trajectory is set as 250 50 150 0 0 the initial conditions of the actual auv are chosen as η 0 30 50 30 0 0 t and ν 0 0 0 0 0 0 t the control and rbfnn parameters are selected as same as the previous simulations except δt which is set as δt 200 here for the sake of smoothness of estimation errors the comparative results are plotted in figs 8 10 from above figures one can see that both controllers can stabilize the tracking errors and guarantee acceptable performance in the first 1150s while the proposed controller achieve a slightly better performance on orientation tracking errors for the rest time of simulations the proposed controller can achieve a consistent tracking performance as it has done in the first 1150s and meanwhile some tracking errors can t be stabilized anymore by the controller designed in rezazadegan et al 2015 because the pe condition is not satisfied in this time interval 6 conclusion in this paper a neural adaptive output feedback three dimensional tracking controller has been proposed for underactuated auvs subjected to parametric uncertainties external disturbances and input saturation a new error state modification form has been introduced to deal with the situation that the desired velocities do not satisfy pe condition to estimate unmeasured velocity signals a modified high gain observer has been designed which can relax the constraints on the boundedness of position signals three rbfnns have been adopted to approximate the unknown functions including modeling uncertainties and complex derivations of virtual controls based on these results the whole control strategy has been designed by using the backstepping technique and lyapunov theory to guarantee the tracking errors convergent to a bounded neighborhood of the origin finally some simulations have been performed to illustrate the effectiveness and robustness of the proposed controller credit authorship contribution statement kai fang conceptualization methodology software validation writing original draft haolin fang software validation writing original draft jiawen zhang investigation software validation jiaqi yao data curation formal analysis jiawang li conceptualization supervision methodology software validation formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20554,social interest in autonomous navigation systems for autonomous ships is also increasing for a robust autonomous navigation system the location speed and direction of the ship and other ships must be identified in real time and collision avoidance should be performed at an appropriate time by considering the collision risk in this study we proposed a collision avoidance method that quantitatively assesses the collision risk and then generates an avoidance path first to assess the collision risk a collision risk assessment method based on the ship domain and the closest point of approach cpa was proposed the ship domain is created with an asymmetric shape considering manoeuvring performance and the colregs the cpa is used to assess quantitative collision risk value subsequently a path generation algorithm based on deep reinforcement learning drl was proposed to determine the avoidance time and to generate an avoidance path complying the colregs for the most dangerous ship in terms of collision risk the information of own ship and target ship such as location speed heading collision risk is used as the input state and the rudder angle of own ship is set as the output action of the drl the cost function related to the path following and the collision avoidance is defined as the reward of the drl based collision avoidance method additionally the drl modes are defined to navigate the flexible avoidance path by changing the ratio between the path following and the collision avoidance to verify the proposed method we compared the collision avoidance method with the a algorithm which is a traditional path planning algorithm and analyzed the results for various scenarios the proposed method reliably avoided collisions through flexible paths for complex and unexpected changes in situations compared to the a algorithm graphical abstract image 1 keywords collision avoidance autonomous ship collision risk colregs deep reinforcement learning 1 introduction with the increase in the number of ships for sea transportation and the complication of shipping routes there has been an increase in the number of maritime accidents due to human error campbell et al 2012 therefore the necessity of autonomous navigation systems for autonomous ships is also increasing autonomous navigation systems should be able to predict the potential risks of dynamic obstacles i e other ships in complex situations and provide a collision free path for an autonomous ship for this purpose the location and speed of the autonomous ship and dynamic obstacles must be identified in real time and the collision risk cr for each dynamic obstacle should be assessed then collision avoidance should be executed at an appropriate time additionally all ships operating at sea must comply with the conventions on the international regulations for preventing collisions at sea colregs 1972 when performing collision avoidance accordingly autonomous navigation systems should consider the colregs when evaluating cr and generating a collision free path he et al 2017 zhang et al 2015 zhao et al 2016 however the existing path planning algorithms are difficult to respond to the unexpected situation due to the change of velocity or the loss of the other ships according to the communication error therefore a collision avoidance method for autonomous ships is proposed in this study including cr assessment first to predict the potential risk of dynamic obstacles a cr assessment method is proposed to quantitatively assess the cr by considering the relative location and speed of the autonomous ship and dynamic obstacles then a collision avoidance method based on deep reinforcement learning drl considering the cr and colregs is proposed to navigate the collision free path of an autonomous ship in real time 2 related works most of the existing studies focusing on collision avoidance methods of autonomous ships are related to collision free path generation ma 2014 proposed a collision avoidance method using smoothing a algorithms zhao et al 2016 and he et al 2017 proposed algorithms that quantify the cr of dynamic obstacles considering the colregs and generate a collision free path according to the encounter conditions of dynamic obstacles xue et al 2011 and liang et al 2019 proposed a collision avoidance method that considers the colregs according to the number of dynamic obstacles using the potential field method johansen et al 2016 and abdelaal et al 2018 proposed collision avoidance methods using model predictive control mpc which is a control analysis algorithm in particular they applied the algorithm to a complex scenario in which a large number of dynamic obstacles were approaching based on the prediction of the motion of the autonomous ship and with the consideration of uncertainty hu et al 2020 proposed a decision making algorithm for multi ship collision avoidance considering the colregs and cr using fuzzy logic mou et al 2020 proposed optimal path generation for multi ship collision avoidance using velocity obstacles and pid control huang et al 2020 compared the strengths and weaknesses of various collision avoidance methods such as fuzzy logic and virtual vector field methods traditional path planning algorithms require a large amount of computation because they generate a collision free path in advance for all predictable situations for this reason these algorithms are not efficient in generating collision free paths for multiple dynamic obstacles and have difficulties in dealing with uncertainties due to changes in encounter conditions with dynamic obstacles and rapidly changing sea conditions therefore traditional path planning algorithms have a limitation in being mounted on an autonomous navigation system and being applied in real time to address this limitation the drl is emerging as an alternative that is frequently used in the field of artificial intelligence and control the drl requires lots of training resources and time to converge the learning for complex systems such as autonomous ships however if the learning is completely converged and covers almost the system the drl can deal with the uncertainties flexibly in other words if the learning could cover various situations the drl can provide a flexible solution for the sudden change of the situation i e change of the speed and direction of other ships or obstacles coming out from nowhere compare to the traditional path planning algorithms the drl is a learning based algorithm that exhibits excellent performance in controlling complex systems such as autonomous ships that derive optimal policies through trial and error interactions with surrounding situations sutton and barto 2018 some studies proposed a control method for a mobile robot in indoor environments based on the drl to generate a collision free path everett et al 2018 long et al 2018 tai et al 2017 zhu et al 2017 in addition the drl is applied to various fields such as autonomous vehicles and unmanned aerial vehicles uavs singla et al 2019 unlike the autonomous robot international regulation colregs should be considered when autonomous ships perform collision avoidance cheng and zhang 2018 and bhopale et al 2019 proposed a collision avoidance method using a deep q network dqn which is a value based drl however these studies did not consider the effects of dynamic obstacles and sea conditions cui et al 2019 used a combination of the drl and mpc algorithms to generate a collision free path for an autonomous ship to apply the collision avoidance method to the actual problem the autonomous ship must comply with the colregs and safely perform collision avoidance for surrounding dynamic obstacles however the drl is difficult to apply when an autonomous ship encounters an arbitrary number of dynamic obstacles because it generally accepts a fixed number of input information to address this problem everett et al 2018 proposed an algorithm that generates an appropriate collision free path even when the number of dynamic obstacles is changed by using long short term memory lstm zhao et al 2019 reviewed the effectiveness of the drl for the problem of the collision avoidance method of an autonomous ship to comply with the colregs even in the presence of several dynamic obstacles zhao and roh 2019 proposed an algorithm that sets the closest dynamic obstacle to the autonomous ship as the input information of the drl and divides the encounter situation of the autonomous ship into four areas to generate a collision free path however most of the studies did not quantitatively assess the cr and simply generated a collision free path using only the distance between the autonomous ship and dynamic obstacles xu et al 2020 proposed a colregs intelligent collision avoidance cica algorithm using dqn and convolution neural network cnn and performed 3d simulations shen et al 2019 and xie et al 2019 proposed a collision avoidance method for an autonomous ship based on a dqn sawada et al 2020 proposed a collision avoidance method using lstm and obstacle zone by target ozt manoeuvring the usv through the imazu problem and considering the colregs woo and kim 2020 proposed a collision avoidance method using a neural network architecture and a semi markov decision process smdp model considering a grid map representation and the colregs however there were limitations in applying it to complex situations with considerable input and output information owing to the low learning convergence of the dqn table 1 summarizes related works on the collision avoidance of a ship in this study we proposed a method to quantitatively assess the cr of dynamic obstacles by combining the concept of ship domain and the closest point of approach cpa we also proposed an algorithm that generates a path that can avoid collision and complies with the colregs for a dynamic obstacle with the highest cr based on the drl the remainder of this paper is organized as follows section 3 describes the quantitative assessment of the cr section 4 presents a drl based algorithm that navigates a collision free path based on the assessed cr and the colregs section 5 describes the verification of the collision avoidance method proposed in this study by comparing it with the existing algorithm and section 6 analyzes the results of applying the proposed method to various examples finally the conclusions of this study and future works are discussed in section 7 3 assessment of collision risk to perform collision avoidance safely and efficiently the autonomous navigation system should determine the avoidance motion of the autonomous ship by quantitatively assessing the cr of dynamic obstacles when collision avoidance is performed early the autonomous ship operates along an inefficient path of increasing time and fuel consumption conversely when collision avoidance is performed late it could be excessively close to the dynamic obstacles thereby increasing the cr of the ship in this study we proposed a cr assessment method considering the colregs and the motion of the autonomous ship for accurate collision avoidance 3 1 regulations for preventing collisions in the sea colregs the colregs provide rules on the direction in which each ship should follow for collision avoidance through classification by the relative location of each ship for various ship encounter situations first a reference ship that makes a decision on the direction from the first person point of view is defined as one s own ship os and dynamic obstacles are defined as other ships in addition the target ship ts is defined as the most dangerous ship among others when the os and ts detect each other they maintain the current path or perform collision avoidance according to the colregs and return to the designed path when safety is ensured at this time the ship maintaining the current path is called a stand on ship and the ship performing collision avoidance is called a give way ship therefore the os could be a stand on or a give way ship depending on the relative location and direction with ts each encounter situation is classified according to the relative location and direction of the ts based on the os first the situation in which the ts approaches from the front based on the heading of the os is called a head on situation and both the os and ts must change their path to the starboard to avoid collisions second the situation in which the ts approaches from the starboard of the os is called a crossing give way situation wherein the ts must maintain the current path and the os must change the path to the starboard to avoid a collision therefore the ts becomes a stand on ship and the os becomes a give way ship in this situation next a situation in which the ts is located in front of the os and has the same direction as that of the os is called an overtaking situation wherein the ts maintains the current path and the os must change the path to the right or left to avoid a collision lastly the situation in which the ts approaches from the port side of the os is called a crossing stand on situation wherein the os must maintain the current path and the ts must change the path to the starboard to avoid a collision therefore the os becomes a stand on ship and the ts becomes a give way ship in this situation fig 1 illustrates the collision free path of each ship in encounter situations as shown in fig 1 the collision free path of each ship varies in various encounter situations depending on the colregs and the autonomous navigation system should also satisfy these regulations 3 2 collision risk calculation for an autonomous navigation system cr must be quantitatively assessed in a situation where the os and ts encounter and an appropriate avoidance point should be determined studies on cr are classified into the ship domain method and the cpa method the characteristics of each method are shown in table 2 the ship domain method prevents ts from entering the ship domain and assures certain collision avoidance but cannot assess quantitative cr values in contrast the cpa method provides a quantitative cr value but requires a separate path planning algorithm for collision avoidance in this study we proposed a cr assessment method that combines the two methods by evaluating the quantitative cr for ts through cpa after creating a ship domain around the os to assure certain collision avoidance the ship domain method is a method of creating a ship domain of a specific shape such as a circle or ellipse around the os and determining whether a collision occurs between the os and ts fujii and tanaka 1971 according to the colregs the os must perform collision avoidance by changing its own path to the starboard in most encounter situations e g head on crossing give way and overtaking therefore methods for creating an asymmetrical ship domain with a larger front and right side have also been proposed coldwell 1983 davis et al 1980 goodwin 1975 however the ship domain method only provides an area that should not be invaded to avoid a collision and does not provide a quantitative cr value for the os and ts encounter situations the cpa method evaluates cr by using the closest point between the os and ts when they maintain the current direction and speed the distance between the os and ts when the ts reaches the cpa is defined as the distance to the cpa dcpa and the time that the ts takes to reach the cpa is defined as the time to the cpa tcpa in fig 2 mou et al 2010 and zhen et al 2017 proposed methods to quantitatively assess the cr through a combination of dcpa and tcpa ahn et al 2012 assessed the cr using dcpa and tcpa as input information for the artificial neural network as described the ship domain is created by considering the colregs and the performance of the os to ensure certain collision avoidance at this time it is assumed that a collision occurs between the os and ts when ts enters the ship domain of the os fig 3 depicts the shape of the ship domain of the os used in this study according to the colregs the os performs collision avoidance by changing its own path to the starboard for most encounter situations therefore the ship domain can be assumed to have an asymmetric elliptical shape in which the front a and right d lengths are longer than the left b and rear c lengths as depicted in fig 3 each length of the ship domain can be determined by considering the colregs and the manoeuvring performance of the os more details regarding this are described in our previous study ha et al 2018 2021 the ship domain of the os means the minimum distance that os can avoid the ts in this study therefore it is assumed that the os and ts have a collision if the ts is on the boundary of the ship domain of the os also the value of cr is 1 if the ts is on the boundary of the ship domain of the os and decreases when the ts recede from the os in this study cpa was used to quantitatively assess the cr between the os and ts the concepts of cpa tcpa and dcpa are illustrated in fig 2 and tcpa and dcpa can be calculated from eqs 1 and 2 1 t c p a 0 i f v o v t 0 p o p t v o v t v o v t 2 o t h e r w i s e 2 d c p a p o v o t c p a p t v t t c p a here p o and p t are location vectors of the os and ts and v o and v t are the speeds of the os and ts respectively several studies have proposed methods to quantitatively assess cr using tcpa and dcpa in particular mou et al 2010 proposed a relatively simple assessment formula that uses the exponential functions of tcpa and dcpa however in this formula the cr is not normalized in each encounter situation therefore in this study we improved their research and proposed an assessment formula for cr such as eq 3 in this equation two parameters a and b are set as the cr is 1 at the boundary of the ship domain of the os the cr value decreases to a minimum value of 0 if the ts becomes farther in other words a larger cr value indicates a more dangerous situation and a value of 1 or more means a collision 3 c r exp d c p a a exp t c p a b in this study the coefficient a of the dcpa and b of the tcpa are determined by considering the length and speed of the os and ts and the distance in which the ships generally start to avoid a collision in the actual situation in addition the values of the two coefficients are set such that the ts has a constant allowable cr cr al when the ts is located at the recognition distance d r from the boundary of the ship domain of the os here d r is the distance at which the os starts to recognize and monitor ts in front cr al is a collision risk value which is set as a criterion to determine that the os should start to avoid ts fig 4 shows how to calculate the two coefficients a and b in fig 4 a it is assumed that ts is located at a distance d r from the front of the os and moves at an angle of 90 and a relative speed v the os and ts are the closest at this moment and the distance between them gradually increases therefore tcpa 0 and dcpa d r in fig 4 a thus the calculated coefficient a of dcpa by substituting these values into eq 3 is equal to eq 4 4 a d r ln c r a l in fig 4 b it is assumed that ts is approaching at a relative speed v at a distance as far as d r from the front of the os if the os and ts maintain the current direction and speed the os will collide with ts at the boundary of the ship domain in the ship domain method it is assumed that ts collides when it reaches the boundary of the ship domain of the os therefore dcpa is 0 and tcpa is d r v which represents the time required to collide from the current location therefore the calculated coefficient b of dcpa by substituting these values into eq 3 and eq 4 is equal to eq 5 5 b d r v ln c r a l thus eq 3 can be arranged as eq 6 6 c r exp d c p a v t c p a ln c r a l d r in this study the cr between the os and ts is quantitatively assessed using eq 6 in eq 6 the smaller dcpa and tcpa means more dangerous encounter situation if the dcpa or tcpa is infinity the cr has the minimum value 0 and there are not dangerous ts around the os by contrast the value of cr would be 1 if the ts is on the boundary of the ship domain of the os in this case it is assumed that the os and ts have a collision in this study even if the value of cr exceeds 1 due to the ts invading the ship domain of the os the simulation is proceeded to compare the robustness and the safety of each algorithm 4 generation of collision free path based on the drl sutton and barto 2018 defined a reinforcement learning rl algorithm as an algorithm that performs learning in such a way that the agent takes action to maximize the value function calculated through the reward in the current state the rl is a part of the markov decision process applied to solve sequential decision making problems 4 1 mathematical modeling of the drl for collision avoidance in the rl problem the agent which is the decision maker recognizes environmental situations called states from the environment subsequently the agent selects the next action that maximizes the value function that evaluates the state recently the rl using multilayer neural networks of deep learning as a value function of an agent has been proposed which is called the drl the drl shows higher learning performance for more complex problems than the existing rl through the excellent performance of neural networks and the ability to store large amounts of data fig 5 illustrates the learning process of the drl at each time step the agent fig 5 ① which corresponds to the os receives the current state s t s fig 5 ③ and reward r t fig 5 ④ from the environment fig 5 ② which corresponds to the maritime environment in which the os operates here s is the set of all possible states for the agent the agent selects action a t a s t fig 5 ⑦ through the policy denoted as π a s which can be regarded as the decision making process fig 5 ⑤ and calculates the value function v s fig 5 ⑥ for state s t a s t is the set of all actions that the agent can select from the current state s t and policy is the probability distribution of selecting the action a t from a s t subsequently the agent gives a t to the environment and the environment calculates the next state s t 1 fig 5 ⑧ and the reward r t 1 fig 5 ⑨ from the current state s t and the selected action a t in this study the proximal policy optimization ppo algorithm is used which is an actor critic drl algorithm the ppo algorithm demonstrates a high learning performance and stable learning convergence for the control problem of a given target such as the collision avoidance method long et al 2018 schulman et al 2017 actor critic drl solves a given problem by learning two neural networks the actor network that selects an action from the policy π a s by inputting the state and the critic network that evaluates the state by calculating the value function v s from the reward each network calculates the action a t and value function v s through the state s t and reward r t at each time step then the learning of each neural network is performed at the end of one iteration using the reward and value function obtained at each time step at this time the appropriate loss function of each network is defined as follows and used in the backpropagation process first the loss function l ppo θ of the actor network is defined by eq 7 7 l p p o θ e min η θ t g a e t c l i p η θ t 1 ε 1 ε g a e t w h e r e η θ t π a t s t π o l d a t s t in this equation η θ t is the ratio of the probabilities which is the ratio of the probability that the policy before the update takes a specific action in a specific state and the probability that the current policy takes the same action in the same state this ratio is clipped and used between 1 ϵ and 1 ϵ according to the clipping hyperparameter ϵ with a value of 0 1 0 2 therefore even if there is a significant change between the previous and the current policies l ppo θ stably changes within a small range near 1 here gae t is the generalized advantage estimation gae and can be defined as eq 8 using v s the result of the critic network schulman et al 2017 8 g a e t i 0 t 1 γ λ i μ i w h e r e μ i r i γ v s i 1 v s i in this equation γ and λ are the discount rate and advantage ratio respectively which denote depreciation added over time in contrast the loss function l v w of the critic network is defined by eq 9 9 l v w t 0 t t t 1 t γ t t r t v s t 2 t t t in this equation t is the total number of time steps taken until the end of one iteration in this study an adam optimizer with stable learning convergence and excellent optimization performance is applied to update the loss function of each network kingma and ba 2015 in the learning process each policy and value function is calculated from the actor and critic networks independently and the weights θ and w of each network are separated from each other table 3 shows the hyperparameters of each network used in the learning process in this study in table 3 the discount rate and advantage ratio are the values described in eq 6 and the max iteration implies the maximum number of iterations for learning batch size is the number of time steps required to perform one iteration and time steps indicate the maximum number of time steps required to complete a scenario e g the os arrives from the starting point to the destination the clipping hyperparameter is a value described in eq 7 and the learning rates of the actor and critic networks are the rates of updating each network 4 2 formulation of the state both the actor and critic networks of the ppo algorithm use the state described above as input information therefore all states must be observable previously the state was defined as information that the agent could receive from the environment at each time step t in this study the state is largely divided into s to and s tt which are related to the os and ts respectively the total state s t composed of 18 elements is defined by combining these two states zhao 2019 the states of the os and ts can be expressed as eqs 10 11 10 s t o x o y o p g o a l p o δ δ y e ψ e χ e ψ e χ e φ in eq 10 the state s to related to the os is composed of 11 elements first x o and y o are the os locations in the 2d plane x y coordinates and p goal p o represents the distance between the os location and the destination δ and δ represent the rudder angle and rudder angular velocity of the os respectively y e represents the difference between the os location and the reference path ψ e and χ e represent the heading angle and course angle errors and ψ e and χ e represent the time derivative of each error respectively φ is the relative angle between the course angle of the os and the angle pointing to the destination from the os 11 s t t x t y t v t x v t y p o p t χ χ t c r in eq 11 the state s tt related to ts is composed of 7 elements x t and y t are the ts locations in the 2d plane x y coordinates and v tx and v ty are the speeds of the ts in the x and y directions respectively p o p t and χ χ t denote the distance and the difference in the course angle between the os and ts respectively cr is assessed by eq 6 when a drl is in the learning process it is necessary to determine the number of nodes items of the input and output layers and the number of hidden layers of the neural network here the number of other ships changes during operation and the number of nodes of the input layer should be dynamically changed to contain information on all other ships however it is not possible to change the number of nodes in the input layer during the learning process if the number of nodes of the input layer is increased to consider all other ships the entire network becomes excessively large and complicated which considerably increases the time required for learning and reduces learning convergence owing to this issue the most dangerous ship is assumed to be the target ship ts and the drl only uses the information of the ts to the nodes of the input layer in this study after calculating the cr for all other ships within a specific distance e g 10 000 m from the os the ship with the largest cr is assumed as ts deep learning should have a fixed shape of a neural network and the same input and output variables therefore the drl should also have a fixed shape of the state to learn the neural network for this reason the collision avoidance method considers only one ts that has the largest cr in this study lastly some items related to location and speed among the states are normalized by dividing them by the total path length and the initial speed of the os the normalized value ensures that each element with a different scale has a uniform effect on learning and has effective performance even if a value that exceeds the learning range is obtained 4 3 formulation of action to avoid collisions with other ships the navigator needs to adjust the direction of the os to ensure the safety of the ship in a complicated path and it is necessary to make appropriate decisions based on long experience the collision avoidance method of an autonomous ship can be created through a sufficient learning process by simulating the appropriate decision making skills that the navigator acquires over a long period of experience in this study the rudder angle is defined as the action selected by the policy of the agent and this angle could change the direction and path of the os the direction of the ship could be maintained changed to the left or to the right therefore in this study the action that can be selected by the os is defined as three nodes of the output layer of the actor network as in eq 12 zhao 2019 12 a t δ max 0 δ max δ m a x represents the rudder angular velocity that the rudder can rotate considering the os manoeuvring performance the positive and negative values of action δ m a x represent the turning of the starboard and the turning of the port side respectively the os changes the rudder angle according to the selected action and calculates a rudder force corresponding to the rudder angle in this study the manoeuvring equation of motion of a ship is used to accurately simulate the motion of the os according to the selected action in other words the motion of the ship is expressed in three degrees of freedom such as surge sway and yaw as shown in eq 13 gertler and hagen 1967 13 m u v r x g r 2 x h x p x r x e m v u r x g r 2 y h y p y r y e i z z r m x g v u r n h n p n r n e here m represents the mass x g is the center of gravity in the x direction and i zz is the moment of inertia in the z direction of the os u v and r are the speeds in the x y and yaw directions of the os respectively u v and r are the accelerations in each direction x y and n denote the hydrodynamic forces in each direction each hydrodynamic force is divided into components due to hull h propeller p rudder r and environmental disturbance e at this time the hydrodynamic forces acting on the hull can be expressed as eq 14 by the mathematical modeling group kijima and nakiri 1990 14 x h x u u x v r v r x r r r 2 x v v v 2 x u y h y v v y r r y v v y v v v v y v r r v r 2 y r r y r r r r y r v v r v 2 n h n v v n r r n v v n v v v v n v r r v r 2 n r r n r r r r n r v v r v 2 here the coefficients of speeds u v and r and accelerations u v and r x u x v r x r r x v v y v y r y v y v v y r y r r y r v v n v n r n v n v v n r n r r n r v v are the coefficients of hydrodynamic forces in each direction of the ship x u represents the resistance constant of still water kim and kim 2008 when the ship moves forward y p and n p are ignored because the force acting by the propeller almost acts in the x direction surge of the ship and it is assumed that there is a constant x p x r y r and n r are rudder forces that occur when changing the rudder angle δ and can be briefly expressed as seen in eq 15 zhao et al 2019 15 x r x δ δ y r y δ δ n r n δ δ here x δ y δ and n δ are rudder coefficients calculated by considering the rudder area and coefficients for additional drag finally ships are exposed to various maritime conditions such as wind waves and current during operation and the external force in each direction that affects the os is represented by x e y e and n e in this study wind and current which considerably influence the ship s manoeuvring motion are considered as external forces 4 4 formulation of rewards the drl process proceeds in the direction to maximize the value function v s for each state when the agent selects actions for a given scenario in the ppo algorithm the loss function of each network was defined through gae gae t in eq 8 which is the sum of the rewards previously obtained and the value function v s thus the process of the entire drl proceeds in the direction in which the value of the loss function is minimized and the total reward is maximized in this study the rewards obtained for each time step are divided into two types first rewards for path following rpf reflect whether the os reaches the destination along the reference path here the virtual reference path is assumed as the line connecting the starting point and the destination if the reference path is not given in addition rewards for collision avoidance rca reflect whether the os is avoiding collisions with ts as shown in fig 6 the rpf is subdivided into goal r goal fig 6 ① cross error r cross fig 6 ② and check point rewards r check fig 6 ③ and the rca is subdivided into collision r collision fig 6 ④ and colregs rewards r colregs fig 6 ⑤ zhao 2019 and colregs maintain reward r maintain fig 6 ⑥ a detailed description of each reward is provided below the five rewards shown in fig 6 have different value ranges therefore to normalize the effect of each reward the value of each reward is adjusted to be within 1 and 1 to calculate the rewards in fig 6 the parameters for each reward should be decided the parameters are flexibly decided considering the complexity of the path the number of obstacles around the os and the environmental condition to solve this problem all states and rewards formulated in this study are normalized to navigate the collision free path when the parameters are changed therefore if the drl based collision avoidance method is completely converged with the os the collision avoidance method work normally with changed parameters according to the path and the number of obstacles the os assesses the cr according to eq 6 for all other observable ships at each time step and selects the most dangerous ts if the cr value of the ts is smaller than the allowable cr cr al which is the criterion for collision avoidance there is no risk of collision therefore at this time step only the rca is calculated however if the assessed cr value is larger than cr al there is a risk of collision therefore the final reward is calculated by the sum of the rpf and rca in this case depending on the ratio of the rpf and rca the path following or collision avoidance could be more weighted in this study three modes d normal d efficiency d safety are constituted with the ratio of the rpf and rca set to 1 1 2 1 and 1 2 respectively for the os to arrive at a destination from a starting point a calculation of a number of time steps is required one iteration is performed after the number of time steps reaches the batch size and the drl process continues until the max iteration n in table 3 the reward summed in each iteration is called total reward as learning progresses and iterations increase the collision avoidance performance of the os can be determined by examining the change in the total reward 4 4 1 rewards for path following the rpf is a reward reflecting whether the os reaches a destination along a reference path and consists of three subdivided rewards as follows 1 goal reward goal reward is defined as a reward given according to the distance between the current location of the os and the destination as depicted in fig 7 the os can move from the current location p o t to the next location p o t 1 by the given action a t the set of points that can be moved by the available actions at the current location is represented by a concentric circle whose center is p o t and the radius is v o dt as shown in the figure if the os moves to the intersection of the straight line connecting p o t and the destination goal and this concentric circle the os can be closer to the destination point 1 in fig 7 conversely if the os moves in the opposite direction point 2 in fig 7 it will be farther from the destination therefore the goal reward when the os moves to points 1 and 2 are set to 1 and 1 respectively eq 16 presents the formula for calculating the goal reward r goal 16 r g o a l l t l t 1 v o d t w h e r e l t x o t x g o a l 2 y o t y g o a l 2 in this equation v o is the os speed and dt is the time step l t and l t 1 denote the distance between the current location and next location p o t and p o t 1 of the os and the destination respectively therefore the denominator of eq 16 indicates the distance that the os can move at each time step and the numerator indicates the difference in distance to the destination at each time step as mentioned earlier when the os moves to point 1 in fig 7 the goal reward is 1 because it is closer to the destination when moving to point 2 the goal reward is 1 because it is farther from the destination using this equation the goal reward always has a value between 1 and 1 regardless of the change in ship type and maximum speed 2 cross error reward a cross error reward is defined as a reward given according to the distance between the next location of the os and the reference path by the given action a t as shown in fig 8 if a reference path is not given a line connecting the starting point and the destination is assumed as a virtual reference path eq 17 presents the formula for calculating the cross error reward r cross 17 r c r o s s d c l 2 y e d c l 2 in this equation d cl is the maximum distance of the os from the reference path and is set according to the complexity of the path and the number of other ships this means that if the value of d cl is set larger the os can deviate more from the reference path to avoid a collision y e is the distance between the os and the reference path at the next time step when the os moves by a given action a t from the current state therefore if the os is on the reference path or farther from it the cross error reward has the maximum value 1 or the minimum value 1 respectively thus the cross error reward also has a value within a range between 1 and 1 depending on the os location 3 check point reward check point reward is defined as a reward given when the os passes the designated check point by the given action a t if the os does not have check points to pass before the destination this reward is 0 during the simulation contrary to other rewards that are calculated at each time step the check point reward is set to be given a particular value only when the os passes the check point eq 18 presents the formula for calculating the check point reward r check 18 r c h e c k d c h e c k v o d t i f p c h e c k p o t 1 ε c h e c k d c h e c k v o d t o t h e r w i s e in this equation d check is the sailing distance between check points v o is the speed of the os and dt is the time step p check is the location of each check point and p t 1 is the next location of the os by a given action a t ε check is the margin of the distance that the os recognizes as having passed the check point and it is assumed to be 50 m in this study check point reward is a reward given only when the os is recognized as having passed the check point therefore this reward is calculated by dividing the sailing distance after the os passes the last check point by the product of its speed and time step this means calculating the number of time steps required for the move and calculating the number of time steps as the check point reward thus the check point reward is continuously 1 during the time step if the os passes the check point and 1 if the os does not pass the check point 4 4 2 rewards for collision avoidance as mentioned before the rca reflects whether the os avoids a collision with ts and consists of two subdivided rewards as follows 1 collision reward collision reward is defined as a reward given according to the cr value between the os and ts when the os moves to the next location by a given action a t as described in section 2 2 in this study the cr between the os and ts is assessed using eq 6 considering the ship domain and cpa if the ts is present at the os ship domain boundary the cr is set to 1 and decreases to 0 as the ts moves farther from the os collision reward is defined using the assessed cr value first if the assessed cr value is smaller than cr al which is a criterion for collision avoidance the collision reward is at its maximum of 1 when the calculated cr value is higher than cr al the collision reward is reduced as depicted in fig 9 if the cr is 1 or more i e when ts enters the boundary of the ship domain the collision reward is at its minimum i e 1 eq 19 presents the formula for calculating the collision reward r collision 19 r co l l i s i o n 1 i f c r c r a l 1 c r a l 1 c r a l 2 c r 1 c r a l i f c r a l c r 1 0 1 i f 1 0 c r in this equation cr represents the collision risk between the os and ts assessed using eq 6 in addition in this study cr al was assumed to be 0 3 based on several trials and errors which is a value that enables the os to evade the ts with sufficient margin even in complex situations also if the ts enters the ship domain of the os it is assumed that the collision between the os and ts occurs therefore the travel scenario of the os is regarded to be failed and the agent of the drl based collision avoidance method gets the failure reward of 1000 with this failure reward the drl based collision avoidance method considers collision avoidance the most important even if the range of collision reward is the same as other rewards 2 colregs reward colregs reward is defined as a reward given when the os properly avoids a collision according to the colregs 13 17 in four encounter situations of the os and ts described in section 2 1 in this study the colregs reward is the maximum value 1 if the os avoids a collision in each encounter situation otherwise it is the minimum value 1 for example in a head on or crossing give way situation the os must turn to starboard thus the colregs reward is 1 if the os turns to starboard when choosing δ m a x of eq 12 as the action by the given action a t otherwise when choosing 0 or δ m a x of eq 12 as the action it is 1 eq 20 presents the formula for calculating the colregs reward r colregs 20 r c o l r e g s r c o l r e g s i f s a t i s f i e s c o l r e g s 13 17 r c o l r e g s o t h e r w i s e in this equation r colregs is 1 the colregs are the most important factor in ship operation and must not be contravened for this the colregs are reflected as the asymmetric shape of the ship domain of the os in this study as the cr is calculated with the distance of the ts from the boundary of the ship domain of the os the colregs are also reflected in the collision reward indirectly therefore the colregs are considered more than other rewards that consist of the rpf 3 colregs maintain reward in the real operation of a ship the os and ts recognize each other with the radar arpa sensors which have a large error and are greatly affected by the maritime environment therefore colregs maintain reward is defined as a reward given when the os maintains the moving direction not to have multiple minor course alterations according to the colregs 8b which is the rule to prevent misleading for operators on other ships in this study the colregs maintain reward is the maximum value 1 if the os maintains the moving direction otherwise it is the minimum value 1 eq 21 presents the formula for calculating the colregs maintain reward r maintain 21 r m a i n t a i n r m a i n t a i n i f s a t i s f i e s c o l r e g s 8 b r m a i n t a i n o t h e r w i s e 5 verification of the collision avoidance method in this study we proposed a collision avoidance method that includes a method to determine the ts by calculating the cr in the encounter situation with other ships we applied the proposed method to a simple example to verify its effectiveness thus a kvlcc2 kim and kim 2008 a very large crude oil carrier was selected as the example ship for convenience both the os and ts are assumed to be the same ship table 4 summarizes the main specifications and parameters of the example ship used for verification in the process of creating the ship domain the standard speed of the os and ts is assumed to be 15 5 knots kim et al 2016 which is the reference speed of ground sog of the kvlcc2 and the turning radius is assumed to be 900 m when the maximum rudder angle of the os is 35 kim and kim 2008 as a result using the manoeuvring equation of motion eq 13 the front a and right d lengths of the ship domain are calculated to be approximately 940 m and the left b and rear c lengths are set to 314 m which is equal to the length of the ship in addition the recognition distance d r and allowable cr cr al are assumed to be 2000 m and 0 3 respectively the coefficient a of dcpa is calculated as 1661 17 and the coefficient b of tcpa is calculated as 276 86 using fig 4 and eqs 4 and 5 the drl based collision avoidance method underwent a learning process to avoid collision for one to one encounter situations between the os and ts according to the colregs for the drl based collision avoidance method the scenario is generated in each iteration in the learning scenario two checkpoints exist between departure and arrival the os encounters three other ships with the head on crossing and overtaking situation in a sequence the encounter situation of each other ship is decided beforehand but the initial location heading angle and speed of each other ship is randomly decided within a certain range the initial location of each ship is determined randomly in the range of 2000 m from the reference path of the os the heading angle is decided by the encounter situation but can be changed in the range of 40 the reference speed of other ships is 15 5 knots for the head on and crossing situation and 4 knots for overtaking situation in each scenario the initial speed of other ships can be changed in the range of 10 as a learning tool keras based on the tensorflow framework was used and the learning process was performed on a pc with an intel core i7 4 50 ghz cpu 16 gb ram geforce titan gpu it exhibited a learning speed of approximately 200 iterations per hour the total reward for one iteration is depicted in fig 10 until 9000 iterations the learning process was performed as depicted in fig 10 the total reward starts at a value of less than 0 and gradually increases this implies that collision avoidance performance improves as the learning progresses in particular it was confirmed that the total reward rapidly increased between approximately 1500 and 3000 iterations the total reward converged near 5000 without any significant change 5 1 performance test according to degree of learning the total reward calculated from the drl based collision avoidance method indicates whether the os avoids the ts according to the colregs and reaches the destination along the reference path at the same time in this section we compare and analyze the collision avoidance performance for four encounter situations of the os and ts according to the learning progress the initial conditions for each situation are shown in fig 11 the initial location of the os is set to 0 0 and the destination is set to 0 10000 which is 10 000 m away in the north direction from the initial location the initial location direction and speed of the ts are set as appropriate in each situation in addition it is assumed that the direction and speed of the ts are constant table 5 shows the results of the os avoidance according to the learning progress for each situation when learning did not progress 0 iterations the os did not avoid a collision with the ts in all four situations accordingly the minimum distance between the os and ts was 701 m 849 m 465 m and 701 m in each situation respectively and the maximum cr value was 1 which means that a collision occurred in the head on crossing give way and overtaking situations in the crossing stand on situation the os did not appear to avoid a collision however because the left length of the os ship domain is smaller than the right length collision did not occur even if the distance between the os and ts was the same as in the crossing give way situation in addition because the relative speed between the os and ts is used to calculate the cr the distance between the os and ts was differently measured when the cr value was 1 in each situation as the learning process of the drl based collision avoidance method progressed with more iterations the minimum distance between ships increased and the maximum cr value gradually decreased to perform safe avoidance fig 12 shows the os collision free path according to the learning progress in each situation in the head on crossing give way and overtaking situations the os avoided a collision by turning to starboard according to the colregs in the crossing stand on situation the os should maintain the path and ts should avoid a collision by turning to starboard however in this study it was confirmed that the os turned to the starboard to avoid a collision because it is assumed that the ts maintains a constant direction and speed regardless of the colregs the reason the os turned to starboard is that the colregs reward of the rca is defined as the os complies with the colregs in addition because the right length d of the ship domain is longer than the left length b the ts should be on the left side of the os to reduce the cr 5 2 performance test according to collision avoidance mode the collision avoidance method proposed in this study might be limited as it always provides a constant result regardless of the given conditions such as the number of other ships the complexity of the reference path and the sea condition in some cases path following could be important in terms of economics and the risk of collision could be important in terms of safety therefore in this study to provide a result that can respond to various conditions the priority between the rpf and the rca is diversified to configure three modes and the learning model for each mode is generated the normal mode simply d normal sets the rpf and rca at the same ratio of 1 1 the efficiency mode simply d efficiency sets the rpf and rca at a ratio of 2 1 and considers path following rather than the cr so the os reaches the destination with a short sailing distance safety mode simply d safety sets the rpf and rca at a ratio of 1 2 and considers the cr rather than path following so that the os reaches the destination as safely as possible by avoiding the ts in addition the performance of the collision avoidance method in three modes is compared with the a algorithm which is one of the traditional path planning algorithms the a algorithm is a traditional path planning algorithm that finds the shortest path from departure to arrival based on graph traversal ma 2014 generally the cost function of the a algorithm consists of the cost of the path from the departure and the heuristic function that estimates the cost of the shortest path to the arrival in general a grid based algorithm such as the a algorithm provides a collision free solution by determining whether each grid can be moved according to the presence or absence of obstacles in this study the a algorithm finds the shortest collision free path that the ship domain of the os does not violate the ts for this the a algorithm considers whether the ship domain of the os violates in each grid the ts or not as a constraint accordingly the a algorithm does not consider the continuous collision risk of the ts and colregs to generate the collision free path therefore the a algorithm could be difficult to respond to a sudden change of speed and direction of the ts when the a algorithm is applied to the ship collision avoidance the grid candidates in which the os can move is limited since the manoeuvring performance of the os must be considered in this study it is assumed that the heading angle can rotate 15 when the os advances 500 m considering the turning circle of kvlcc2 and a grid candidate that the os can move is selected fig 13 shows the result of the collision avoidance using each mode of the drl based collision avoidance method and the a algorithm for each situation as shown in fig 13 all three modes in the case of drl based algorithms tend to start collision avoidance before the a algorithm this is because even if the same cr al is applied to both algorithms the drl based algorithm starts collision avoidance even though the cr is smaller than the cr al by considering the dangerous situation in advance based on the learned results accordingly it is confirmed that the minimum distance between the os and ts is shorter and the maximum cr is larger because the a algorithm starts collision avoidance later than the drl based algorithm table 6 summarizes the collision avoidance results for each mode of the drl based and a algorithms in each situation as shown in table 6 in the case of the d safety mode which has a larger weight on the rca the minimum distance between the os and ts was the longest and the maximum cr was the lowest in the case of the d efficiency mode with a larger weight on the rpf the minimum distance between the os and ts was the shortest and had the largest maximum cr but the os reached the destination with the shortest sailing distance the above results indicate that it is possible to perform safer or more efficient collision avoidance than the existing algorithm by selecting and using an appropriate mode from a given condition 6 applications 6 1 development of the prototype program to apply the proposed method to various examples and easily check the results a prototype program using c language was developed in the microsoft visual studio 2019 environment this program consists of a manoeuvring module that is based on the manoeuvring equation of ship motion a collision avoidance module that assesses the cr and avoids a collision based on the drl a scenario generator module that generates a scenario and a visualization module to visualize the results fig 14 shows the entire screenshot of the developed program as shown in fig 14 the user interface of the developed program consists of 4 parts first the ribbon view includes a function to import a learning model in the desired mode and a simulation progress function the property view shows detailed information of the os and ts and includes the setting of the location of the destination and check points of the os and the initial location speed and direction of other ships through the scenario generation function the map view shows the current location and speed of the os and ts cr and the path the os has traveled finally the graph view visualizes the distance between the os and ts and the cr 6 2 test scenarios this section validates the effectiveness of the proposed method for more complex examples for an objective comparison the results of the proposed method are compared with those of the a algorithm three examples were selected for comparison the initial location of the os is set to 0 0 and the destination is set to 0 10000 which is 10 000 m away in the north direction from the initial location of the os the initial location direction and speed of 10 other ships are randomly generated around the path of the os in the first and second examples multiple other ships approach the os almost simultaneously and in the third example multiple other ships approach the os in succession as in section 4 the os and other ships are assumed to be kvlcc2 and it is also assumed that there is no change in the speed of the os and the direction and speed of the ts are constant other parameters for assessment are the same as in table 4 6 2 1 scenario 1 multiple other ships approaching the os at the same time fig 15 shows the initial conditions of the os and other ships in example 1 the dangling line of the triangle representing each ship indicates the direction of the ship the units of location and speed of the os and other ships are m and m s respectively other ships constantly move with given direction and speed ts 1 and ts 2 in fig 15 represent dangerous ships approaching the os as the simulation progresses if the os avoids ts 1 from the front 0 2500 location to the starboard according to the colregs the os faces ts 2 approaching from the 3000 2500 location and the os should continuously avoid the two tss fig 16 shows the result of the collision avoidance with the drl based collision avoidance method d normal mode and the a algorithm the a algorithm started collision avoidance somewhat later than the drl based algorithm in this example ts 1 and ts 2 approached the os at the same time the a algorithm found the collision free path discretely by determining only whether the os and ts had a collision in the grid therefore the collision free path is ensured with the a algorithm but the cr can temporarily exceed 1 when the os moves from a grid to the next grid this is due to the characteristics of the grid based algorithms that can only consider the states at the grid the minimum distance between the os and ts 2 was measured to be approximately 126 m and the maximum cr was 1 14 with the a algorithm in contrast in the d normal mode collision avoidance was performed earlier than with the a algorithm and the os performed collision avoidance with a sufficient margin for both ts 1 and ts 2 the minimum distance was measured to be approximately 704 m and the maximum cr was 0 81 with the d normal mode table 7 summarizes the avoidance results of the d normal mode in the drl based and a algorithms fig 17 shows the initial conditions of the os and other ships in another example that is example 2 ts 1 ts 2 and ts 3 represent other dangerous ships approaching the os as the simulation progresses if the os avoids ts 1 from the front 0 2500 location to the starboard according to the colregs ts 2 of the 1500 7500 location ts 3 of the 3500 2500 location and ts 4 of the 3500 4000 location are also approaching at a similar distance to the os and it is difficult to avoid all other ships fig 18 shows the result of the collision avoidance with the drl based collision avoidance method d normal mode and the a algorithm the minimum distance between the os and ts 3 was measured to be approximately 94 m and the maximum cr was 1 23 with the a algorithm in contrast in the d normal mode collision avoidance was performed earlier than with the a algorithm and the os performed collision avoidance with a sufficient margin for all near the ts the minimum distance was measured to be approximately 333 m and the maximum cr was 0 98 with the d normal mode table 8 summarizes the avoidance results of each algorithm 6 2 2 scenario 2 sudden direction change of the ts nearby the os fig 19 shows the initial conditions of the os and other ships in example 3 the initial situation is the same as fig 15 of example 1 however the direction of ts 2 is suddenly changed nearby the os fig 20 shows the result of collision avoidance the drl based collision avoidance method d normal mode and the a algorithm in this study the initial states of other ships were randomly determined in a certain range consequently the d normal mode could cover various encounter situations therefore even when the direction of ts 2 changed rapidly the os successfully avoided the collision because the d normal mode could respond to the changed state of ts 2 the distance between the os and ts was reduced to 576 m and the maximum cr was increased to 0 86 on the other hand the a algorithm did not consider the cr of the ts and found a tight shortest collision free path by determining only whether the os and ts had a collision or not therefore even if a new path was generated through the changed state of ts 2 the os could not respond to the change because of the manoeuvring performance of the os accordingly the minimum distance between the os and ts was measured to be approximately 85 m and the maximum cr was 1 42 with the a algorithm table 9 summarizes the avoidance results of each algorithm 7 conclusion and future works in this study a collision avoidance method for autonomous ships was proposed including a cr assessment method the cr assessment method quantitatively assesses cr and selects the most dangerous ts in situations where multiple other ships are approaching the collision avoidance method navigates an appropriate collision free path and assures the safety of the os with respect to the ts to assess the cr we created an asymmetric elliptical ship domain considering colregs and improved the cpa based method to calculate the cr of other ships in addition based on the ppo algorithm of the drl the state action and reward were defined to propose a collision avoidance method for an autonomous ship the state was defined with the information of the os and ts to navigate a collision free path as a result of the drl the next rudder angle of the os was defined as an action to determine the os avoidance motion in particular the manoeuvring equation of motion with three degrees of freedom was used to simulate the exact motion of the os and determine the next location and speed the reward was calculated by dividing it into the rpf and rca to consider both the collision avoidance for the ts and the path following to the destination to apply the method to various situations the ratio of the rpf and rca was adjusted to create three modes of learning models d normal d efficiency and d safety in addition to verify the effectiveness of the collision avoidance method proposed in this study avoidance performance according to the learning progress was evaluated and the learning model of each mode was compared with the a algorithm as a result it was confirmed that the proposed algorithm performs the avoidance with a path that decreases the maximum cr by 15 compared to the a algorithm in four one to one encounter situations according to colregs based on the d normal mode the d efficiency mode generated a collision free path with the shortest sailing distance of the os and the d safety mode generated a safe collision free path with the lowest cr the proposed method was applied to the encounter situation of multiple other ships and the results were analyzed as a result stable collision avoidance was performed even when multiple other ships were simultaneously or continuously approaching in the first and second examples in which multiple other ships were simultaneously approaching the ts temporarily violated the ship domain of the os in the proposed method d normal the maximum cr was 0 81 and 0 98 and collision avoidance was performed by determining a safe path with the maximum cr reduced by 29 and 20 compared to the a algorithm in the third example where a sudden direction change of the ts nearby the os the maximum cr value was 1 42 for the a algorithm resulting in a collision however in the proposed method d normal mode the avoidance was performed by determining a safe path with the maximum cr reduced by 39 to 0 86 this was because the a algorithm is a grid based algorithm the a algorithm found the collision free path based on whether the os and ts had a collision in the grid not assessing the cr of the ts therefore while the os was moving from the grid to the grid a section in which cr exceeded 1 could occur and it was difficult to respond to sudden changes in the ts however the proposed method has some limitations about the encounter situation and avoidance motion first the proposed method only considers the situation that the os and ts are sailing in the open sea maritime accidents mainly occur in restricted waters where have a high probability of collision due to heavy traffic and limited movement accordingly the collision avoidance method should consider the restricted waters based on electronic navigational charts enc therefore we plan to consider map data such as enc based vector charts or bitmaps through our future studies in addition colregs rule 9 related to navigation in narrow channels will be added in consideration of the encounter situation in restricted waters as our future study the method for the collision risk assessment will be improved to derive more practical collision risk considering the probabilistic ship domain and the clustering density of the tss the ship domain could be calculated flexibly by considering the condition of the sea traffic and tss then the collision risk of the tss in safe situations could be relatively decreased and a more economic collision avoidance strategy could be derived on the other hand the collision risk of the tss in dangerous situations should be relatively increased and a more secure collision avoidance strategy has to be derived for this the collision risk assessment using the probabilistic ship domain will be applied to the rewards for collision avoidance second the proposed method can only control the rudder angle as the action of the drl based collision avoidance method we will extend the action of the drl based collision avoidance method to not only the rudder angle but also the speed of the os to control both the rudder angle and the speed of the os with the drl based collision avoidance method the neural network of deep learning should be more complexed and more advanced drl algorithms is needed therefore the twin delayed deep deterministic policy gradient td3 fujimoto et al 2019 and the soft actor critic sac haarnoja et al 2018 algorithm of the drl which are known to have better control performance than the ppo algorithm will be applied to ship collision avoidance problems as these algorithms have higher sample efficiency and stable learning convergence among drl algorithms they are more suitable for continuous control problems however these algorithms require more training data for learning also the collision avoidance method proposed in this study only considered the information of the ts which has the maximum cr consequently multiple minor course alterations can occur when the ts with the maximum cr changes recently there are several attempts to consider multiple targets by using the cnn with the information of grids szoke et al 2020 sudden course alteration when the ts with the maximum cr changes will be minimized by considering multiple tss at once with these attempts finally we plan to improve the authors existing studies zhao and roh 2019 to avoid multiple other ships continuously approaching and the effectiveness of the proposed method will be validated through experiments credit authorship contribution statement do hyun chun conceptualization methodology software visualization validation writing original draft myung il roh conceptualization validation writing review editing funding acquisition hye won lee software visualization validation jisang ha software visualization validation donghun yu validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is an expansion of our previous studies zhao et al 2019 zhao and roh 2019 ha et al 2021 and was partially supported by a daewoo shipbuilding and marine engineering co ltd republic of korea b research institute of marine systems engineering of seoul national university republic of korea and c institute of engineering research of seoul national university republic of korea 
20554,social interest in autonomous navigation systems for autonomous ships is also increasing for a robust autonomous navigation system the location speed and direction of the ship and other ships must be identified in real time and collision avoidance should be performed at an appropriate time by considering the collision risk in this study we proposed a collision avoidance method that quantitatively assesses the collision risk and then generates an avoidance path first to assess the collision risk a collision risk assessment method based on the ship domain and the closest point of approach cpa was proposed the ship domain is created with an asymmetric shape considering manoeuvring performance and the colregs the cpa is used to assess quantitative collision risk value subsequently a path generation algorithm based on deep reinforcement learning drl was proposed to determine the avoidance time and to generate an avoidance path complying the colregs for the most dangerous ship in terms of collision risk the information of own ship and target ship such as location speed heading collision risk is used as the input state and the rudder angle of own ship is set as the output action of the drl the cost function related to the path following and the collision avoidance is defined as the reward of the drl based collision avoidance method additionally the drl modes are defined to navigate the flexible avoidance path by changing the ratio between the path following and the collision avoidance to verify the proposed method we compared the collision avoidance method with the a algorithm which is a traditional path planning algorithm and analyzed the results for various scenarios the proposed method reliably avoided collisions through flexible paths for complex and unexpected changes in situations compared to the a algorithm graphical abstract image 1 keywords collision avoidance autonomous ship collision risk colregs deep reinforcement learning 1 introduction with the increase in the number of ships for sea transportation and the complication of shipping routes there has been an increase in the number of maritime accidents due to human error campbell et al 2012 therefore the necessity of autonomous navigation systems for autonomous ships is also increasing autonomous navigation systems should be able to predict the potential risks of dynamic obstacles i e other ships in complex situations and provide a collision free path for an autonomous ship for this purpose the location and speed of the autonomous ship and dynamic obstacles must be identified in real time and the collision risk cr for each dynamic obstacle should be assessed then collision avoidance should be executed at an appropriate time additionally all ships operating at sea must comply with the conventions on the international regulations for preventing collisions at sea colregs 1972 when performing collision avoidance accordingly autonomous navigation systems should consider the colregs when evaluating cr and generating a collision free path he et al 2017 zhang et al 2015 zhao et al 2016 however the existing path planning algorithms are difficult to respond to the unexpected situation due to the change of velocity or the loss of the other ships according to the communication error therefore a collision avoidance method for autonomous ships is proposed in this study including cr assessment first to predict the potential risk of dynamic obstacles a cr assessment method is proposed to quantitatively assess the cr by considering the relative location and speed of the autonomous ship and dynamic obstacles then a collision avoidance method based on deep reinforcement learning drl considering the cr and colregs is proposed to navigate the collision free path of an autonomous ship in real time 2 related works most of the existing studies focusing on collision avoidance methods of autonomous ships are related to collision free path generation ma 2014 proposed a collision avoidance method using smoothing a algorithms zhao et al 2016 and he et al 2017 proposed algorithms that quantify the cr of dynamic obstacles considering the colregs and generate a collision free path according to the encounter conditions of dynamic obstacles xue et al 2011 and liang et al 2019 proposed a collision avoidance method that considers the colregs according to the number of dynamic obstacles using the potential field method johansen et al 2016 and abdelaal et al 2018 proposed collision avoidance methods using model predictive control mpc which is a control analysis algorithm in particular they applied the algorithm to a complex scenario in which a large number of dynamic obstacles were approaching based on the prediction of the motion of the autonomous ship and with the consideration of uncertainty hu et al 2020 proposed a decision making algorithm for multi ship collision avoidance considering the colregs and cr using fuzzy logic mou et al 2020 proposed optimal path generation for multi ship collision avoidance using velocity obstacles and pid control huang et al 2020 compared the strengths and weaknesses of various collision avoidance methods such as fuzzy logic and virtual vector field methods traditional path planning algorithms require a large amount of computation because they generate a collision free path in advance for all predictable situations for this reason these algorithms are not efficient in generating collision free paths for multiple dynamic obstacles and have difficulties in dealing with uncertainties due to changes in encounter conditions with dynamic obstacles and rapidly changing sea conditions therefore traditional path planning algorithms have a limitation in being mounted on an autonomous navigation system and being applied in real time to address this limitation the drl is emerging as an alternative that is frequently used in the field of artificial intelligence and control the drl requires lots of training resources and time to converge the learning for complex systems such as autonomous ships however if the learning is completely converged and covers almost the system the drl can deal with the uncertainties flexibly in other words if the learning could cover various situations the drl can provide a flexible solution for the sudden change of the situation i e change of the speed and direction of other ships or obstacles coming out from nowhere compare to the traditional path planning algorithms the drl is a learning based algorithm that exhibits excellent performance in controlling complex systems such as autonomous ships that derive optimal policies through trial and error interactions with surrounding situations sutton and barto 2018 some studies proposed a control method for a mobile robot in indoor environments based on the drl to generate a collision free path everett et al 2018 long et al 2018 tai et al 2017 zhu et al 2017 in addition the drl is applied to various fields such as autonomous vehicles and unmanned aerial vehicles uavs singla et al 2019 unlike the autonomous robot international regulation colregs should be considered when autonomous ships perform collision avoidance cheng and zhang 2018 and bhopale et al 2019 proposed a collision avoidance method using a deep q network dqn which is a value based drl however these studies did not consider the effects of dynamic obstacles and sea conditions cui et al 2019 used a combination of the drl and mpc algorithms to generate a collision free path for an autonomous ship to apply the collision avoidance method to the actual problem the autonomous ship must comply with the colregs and safely perform collision avoidance for surrounding dynamic obstacles however the drl is difficult to apply when an autonomous ship encounters an arbitrary number of dynamic obstacles because it generally accepts a fixed number of input information to address this problem everett et al 2018 proposed an algorithm that generates an appropriate collision free path even when the number of dynamic obstacles is changed by using long short term memory lstm zhao et al 2019 reviewed the effectiveness of the drl for the problem of the collision avoidance method of an autonomous ship to comply with the colregs even in the presence of several dynamic obstacles zhao and roh 2019 proposed an algorithm that sets the closest dynamic obstacle to the autonomous ship as the input information of the drl and divides the encounter situation of the autonomous ship into four areas to generate a collision free path however most of the studies did not quantitatively assess the cr and simply generated a collision free path using only the distance between the autonomous ship and dynamic obstacles xu et al 2020 proposed a colregs intelligent collision avoidance cica algorithm using dqn and convolution neural network cnn and performed 3d simulations shen et al 2019 and xie et al 2019 proposed a collision avoidance method for an autonomous ship based on a dqn sawada et al 2020 proposed a collision avoidance method using lstm and obstacle zone by target ozt manoeuvring the usv through the imazu problem and considering the colregs woo and kim 2020 proposed a collision avoidance method using a neural network architecture and a semi markov decision process smdp model considering a grid map representation and the colregs however there were limitations in applying it to complex situations with considerable input and output information owing to the low learning convergence of the dqn table 1 summarizes related works on the collision avoidance of a ship in this study we proposed a method to quantitatively assess the cr of dynamic obstacles by combining the concept of ship domain and the closest point of approach cpa we also proposed an algorithm that generates a path that can avoid collision and complies with the colregs for a dynamic obstacle with the highest cr based on the drl the remainder of this paper is organized as follows section 3 describes the quantitative assessment of the cr section 4 presents a drl based algorithm that navigates a collision free path based on the assessed cr and the colregs section 5 describes the verification of the collision avoidance method proposed in this study by comparing it with the existing algorithm and section 6 analyzes the results of applying the proposed method to various examples finally the conclusions of this study and future works are discussed in section 7 3 assessment of collision risk to perform collision avoidance safely and efficiently the autonomous navigation system should determine the avoidance motion of the autonomous ship by quantitatively assessing the cr of dynamic obstacles when collision avoidance is performed early the autonomous ship operates along an inefficient path of increasing time and fuel consumption conversely when collision avoidance is performed late it could be excessively close to the dynamic obstacles thereby increasing the cr of the ship in this study we proposed a cr assessment method considering the colregs and the motion of the autonomous ship for accurate collision avoidance 3 1 regulations for preventing collisions in the sea colregs the colregs provide rules on the direction in which each ship should follow for collision avoidance through classification by the relative location of each ship for various ship encounter situations first a reference ship that makes a decision on the direction from the first person point of view is defined as one s own ship os and dynamic obstacles are defined as other ships in addition the target ship ts is defined as the most dangerous ship among others when the os and ts detect each other they maintain the current path or perform collision avoidance according to the colregs and return to the designed path when safety is ensured at this time the ship maintaining the current path is called a stand on ship and the ship performing collision avoidance is called a give way ship therefore the os could be a stand on or a give way ship depending on the relative location and direction with ts each encounter situation is classified according to the relative location and direction of the ts based on the os first the situation in which the ts approaches from the front based on the heading of the os is called a head on situation and both the os and ts must change their path to the starboard to avoid collisions second the situation in which the ts approaches from the starboard of the os is called a crossing give way situation wherein the ts must maintain the current path and the os must change the path to the starboard to avoid a collision therefore the ts becomes a stand on ship and the os becomes a give way ship in this situation next a situation in which the ts is located in front of the os and has the same direction as that of the os is called an overtaking situation wherein the ts maintains the current path and the os must change the path to the right or left to avoid a collision lastly the situation in which the ts approaches from the port side of the os is called a crossing stand on situation wherein the os must maintain the current path and the ts must change the path to the starboard to avoid a collision therefore the os becomes a stand on ship and the ts becomes a give way ship in this situation fig 1 illustrates the collision free path of each ship in encounter situations as shown in fig 1 the collision free path of each ship varies in various encounter situations depending on the colregs and the autonomous navigation system should also satisfy these regulations 3 2 collision risk calculation for an autonomous navigation system cr must be quantitatively assessed in a situation where the os and ts encounter and an appropriate avoidance point should be determined studies on cr are classified into the ship domain method and the cpa method the characteristics of each method are shown in table 2 the ship domain method prevents ts from entering the ship domain and assures certain collision avoidance but cannot assess quantitative cr values in contrast the cpa method provides a quantitative cr value but requires a separate path planning algorithm for collision avoidance in this study we proposed a cr assessment method that combines the two methods by evaluating the quantitative cr for ts through cpa after creating a ship domain around the os to assure certain collision avoidance the ship domain method is a method of creating a ship domain of a specific shape such as a circle or ellipse around the os and determining whether a collision occurs between the os and ts fujii and tanaka 1971 according to the colregs the os must perform collision avoidance by changing its own path to the starboard in most encounter situations e g head on crossing give way and overtaking therefore methods for creating an asymmetrical ship domain with a larger front and right side have also been proposed coldwell 1983 davis et al 1980 goodwin 1975 however the ship domain method only provides an area that should not be invaded to avoid a collision and does not provide a quantitative cr value for the os and ts encounter situations the cpa method evaluates cr by using the closest point between the os and ts when they maintain the current direction and speed the distance between the os and ts when the ts reaches the cpa is defined as the distance to the cpa dcpa and the time that the ts takes to reach the cpa is defined as the time to the cpa tcpa in fig 2 mou et al 2010 and zhen et al 2017 proposed methods to quantitatively assess the cr through a combination of dcpa and tcpa ahn et al 2012 assessed the cr using dcpa and tcpa as input information for the artificial neural network as described the ship domain is created by considering the colregs and the performance of the os to ensure certain collision avoidance at this time it is assumed that a collision occurs between the os and ts when ts enters the ship domain of the os fig 3 depicts the shape of the ship domain of the os used in this study according to the colregs the os performs collision avoidance by changing its own path to the starboard for most encounter situations therefore the ship domain can be assumed to have an asymmetric elliptical shape in which the front a and right d lengths are longer than the left b and rear c lengths as depicted in fig 3 each length of the ship domain can be determined by considering the colregs and the manoeuvring performance of the os more details regarding this are described in our previous study ha et al 2018 2021 the ship domain of the os means the minimum distance that os can avoid the ts in this study therefore it is assumed that the os and ts have a collision if the ts is on the boundary of the ship domain of the os also the value of cr is 1 if the ts is on the boundary of the ship domain of the os and decreases when the ts recede from the os in this study cpa was used to quantitatively assess the cr between the os and ts the concepts of cpa tcpa and dcpa are illustrated in fig 2 and tcpa and dcpa can be calculated from eqs 1 and 2 1 t c p a 0 i f v o v t 0 p o p t v o v t v o v t 2 o t h e r w i s e 2 d c p a p o v o t c p a p t v t t c p a here p o and p t are location vectors of the os and ts and v o and v t are the speeds of the os and ts respectively several studies have proposed methods to quantitatively assess cr using tcpa and dcpa in particular mou et al 2010 proposed a relatively simple assessment formula that uses the exponential functions of tcpa and dcpa however in this formula the cr is not normalized in each encounter situation therefore in this study we improved their research and proposed an assessment formula for cr such as eq 3 in this equation two parameters a and b are set as the cr is 1 at the boundary of the ship domain of the os the cr value decreases to a minimum value of 0 if the ts becomes farther in other words a larger cr value indicates a more dangerous situation and a value of 1 or more means a collision 3 c r exp d c p a a exp t c p a b in this study the coefficient a of the dcpa and b of the tcpa are determined by considering the length and speed of the os and ts and the distance in which the ships generally start to avoid a collision in the actual situation in addition the values of the two coefficients are set such that the ts has a constant allowable cr cr al when the ts is located at the recognition distance d r from the boundary of the ship domain of the os here d r is the distance at which the os starts to recognize and monitor ts in front cr al is a collision risk value which is set as a criterion to determine that the os should start to avoid ts fig 4 shows how to calculate the two coefficients a and b in fig 4 a it is assumed that ts is located at a distance d r from the front of the os and moves at an angle of 90 and a relative speed v the os and ts are the closest at this moment and the distance between them gradually increases therefore tcpa 0 and dcpa d r in fig 4 a thus the calculated coefficient a of dcpa by substituting these values into eq 3 is equal to eq 4 4 a d r ln c r a l in fig 4 b it is assumed that ts is approaching at a relative speed v at a distance as far as d r from the front of the os if the os and ts maintain the current direction and speed the os will collide with ts at the boundary of the ship domain in the ship domain method it is assumed that ts collides when it reaches the boundary of the ship domain of the os therefore dcpa is 0 and tcpa is d r v which represents the time required to collide from the current location therefore the calculated coefficient b of dcpa by substituting these values into eq 3 and eq 4 is equal to eq 5 5 b d r v ln c r a l thus eq 3 can be arranged as eq 6 6 c r exp d c p a v t c p a ln c r a l d r in this study the cr between the os and ts is quantitatively assessed using eq 6 in eq 6 the smaller dcpa and tcpa means more dangerous encounter situation if the dcpa or tcpa is infinity the cr has the minimum value 0 and there are not dangerous ts around the os by contrast the value of cr would be 1 if the ts is on the boundary of the ship domain of the os in this case it is assumed that the os and ts have a collision in this study even if the value of cr exceeds 1 due to the ts invading the ship domain of the os the simulation is proceeded to compare the robustness and the safety of each algorithm 4 generation of collision free path based on the drl sutton and barto 2018 defined a reinforcement learning rl algorithm as an algorithm that performs learning in such a way that the agent takes action to maximize the value function calculated through the reward in the current state the rl is a part of the markov decision process applied to solve sequential decision making problems 4 1 mathematical modeling of the drl for collision avoidance in the rl problem the agent which is the decision maker recognizes environmental situations called states from the environment subsequently the agent selects the next action that maximizes the value function that evaluates the state recently the rl using multilayer neural networks of deep learning as a value function of an agent has been proposed which is called the drl the drl shows higher learning performance for more complex problems than the existing rl through the excellent performance of neural networks and the ability to store large amounts of data fig 5 illustrates the learning process of the drl at each time step the agent fig 5 ① which corresponds to the os receives the current state s t s fig 5 ③ and reward r t fig 5 ④ from the environment fig 5 ② which corresponds to the maritime environment in which the os operates here s is the set of all possible states for the agent the agent selects action a t a s t fig 5 ⑦ through the policy denoted as π a s which can be regarded as the decision making process fig 5 ⑤ and calculates the value function v s fig 5 ⑥ for state s t a s t is the set of all actions that the agent can select from the current state s t and policy is the probability distribution of selecting the action a t from a s t subsequently the agent gives a t to the environment and the environment calculates the next state s t 1 fig 5 ⑧ and the reward r t 1 fig 5 ⑨ from the current state s t and the selected action a t in this study the proximal policy optimization ppo algorithm is used which is an actor critic drl algorithm the ppo algorithm demonstrates a high learning performance and stable learning convergence for the control problem of a given target such as the collision avoidance method long et al 2018 schulman et al 2017 actor critic drl solves a given problem by learning two neural networks the actor network that selects an action from the policy π a s by inputting the state and the critic network that evaluates the state by calculating the value function v s from the reward each network calculates the action a t and value function v s through the state s t and reward r t at each time step then the learning of each neural network is performed at the end of one iteration using the reward and value function obtained at each time step at this time the appropriate loss function of each network is defined as follows and used in the backpropagation process first the loss function l ppo θ of the actor network is defined by eq 7 7 l p p o θ e min η θ t g a e t c l i p η θ t 1 ε 1 ε g a e t w h e r e η θ t π a t s t π o l d a t s t in this equation η θ t is the ratio of the probabilities which is the ratio of the probability that the policy before the update takes a specific action in a specific state and the probability that the current policy takes the same action in the same state this ratio is clipped and used between 1 ϵ and 1 ϵ according to the clipping hyperparameter ϵ with a value of 0 1 0 2 therefore even if there is a significant change between the previous and the current policies l ppo θ stably changes within a small range near 1 here gae t is the generalized advantage estimation gae and can be defined as eq 8 using v s the result of the critic network schulman et al 2017 8 g a e t i 0 t 1 γ λ i μ i w h e r e μ i r i γ v s i 1 v s i in this equation γ and λ are the discount rate and advantage ratio respectively which denote depreciation added over time in contrast the loss function l v w of the critic network is defined by eq 9 9 l v w t 0 t t t 1 t γ t t r t v s t 2 t t t in this equation t is the total number of time steps taken until the end of one iteration in this study an adam optimizer with stable learning convergence and excellent optimization performance is applied to update the loss function of each network kingma and ba 2015 in the learning process each policy and value function is calculated from the actor and critic networks independently and the weights θ and w of each network are separated from each other table 3 shows the hyperparameters of each network used in the learning process in this study in table 3 the discount rate and advantage ratio are the values described in eq 6 and the max iteration implies the maximum number of iterations for learning batch size is the number of time steps required to perform one iteration and time steps indicate the maximum number of time steps required to complete a scenario e g the os arrives from the starting point to the destination the clipping hyperparameter is a value described in eq 7 and the learning rates of the actor and critic networks are the rates of updating each network 4 2 formulation of the state both the actor and critic networks of the ppo algorithm use the state described above as input information therefore all states must be observable previously the state was defined as information that the agent could receive from the environment at each time step t in this study the state is largely divided into s to and s tt which are related to the os and ts respectively the total state s t composed of 18 elements is defined by combining these two states zhao 2019 the states of the os and ts can be expressed as eqs 10 11 10 s t o x o y o p g o a l p o δ δ y e ψ e χ e ψ e χ e φ in eq 10 the state s to related to the os is composed of 11 elements first x o and y o are the os locations in the 2d plane x y coordinates and p goal p o represents the distance between the os location and the destination δ and δ represent the rudder angle and rudder angular velocity of the os respectively y e represents the difference between the os location and the reference path ψ e and χ e represent the heading angle and course angle errors and ψ e and χ e represent the time derivative of each error respectively φ is the relative angle between the course angle of the os and the angle pointing to the destination from the os 11 s t t x t y t v t x v t y p o p t χ χ t c r in eq 11 the state s tt related to ts is composed of 7 elements x t and y t are the ts locations in the 2d plane x y coordinates and v tx and v ty are the speeds of the ts in the x and y directions respectively p o p t and χ χ t denote the distance and the difference in the course angle between the os and ts respectively cr is assessed by eq 6 when a drl is in the learning process it is necessary to determine the number of nodes items of the input and output layers and the number of hidden layers of the neural network here the number of other ships changes during operation and the number of nodes of the input layer should be dynamically changed to contain information on all other ships however it is not possible to change the number of nodes in the input layer during the learning process if the number of nodes of the input layer is increased to consider all other ships the entire network becomes excessively large and complicated which considerably increases the time required for learning and reduces learning convergence owing to this issue the most dangerous ship is assumed to be the target ship ts and the drl only uses the information of the ts to the nodes of the input layer in this study after calculating the cr for all other ships within a specific distance e g 10 000 m from the os the ship with the largest cr is assumed as ts deep learning should have a fixed shape of a neural network and the same input and output variables therefore the drl should also have a fixed shape of the state to learn the neural network for this reason the collision avoidance method considers only one ts that has the largest cr in this study lastly some items related to location and speed among the states are normalized by dividing them by the total path length and the initial speed of the os the normalized value ensures that each element with a different scale has a uniform effect on learning and has effective performance even if a value that exceeds the learning range is obtained 4 3 formulation of action to avoid collisions with other ships the navigator needs to adjust the direction of the os to ensure the safety of the ship in a complicated path and it is necessary to make appropriate decisions based on long experience the collision avoidance method of an autonomous ship can be created through a sufficient learning process by simulating the appropriate decision making skills that the navigator acquires over a long period of experience in this study the rudder angle is defined as the action selected by the policy of the agent and this angle could change the direction and path of the os the direction of the ship could be maintained changed to the left or to the right therefore in this study the action that can be selected by the os is defined as three nodes of the output layer of the actor network as in eq 12 zhao 2019 12 a t δ max 0 δ max δ m a x represents the rudder angular velocity that the rudder can rotate considering the os manoeuvring performance the positive and negative values of action δ m a x represent the turning of the starboard and the turning of the port side respectively the os changes the rudder angle according to the selected action and calculates a rudder force corresponding to the rudder angle in this study the manoeuvring equation of motion of a ship is used to accurately simulate the motion of the os according to the selected action in other words the motion of the ship is expressed in three degrees of freedom such as surge sway and yaw as shown in eq 13 gertler and hagen 1967 13 m u v r x g r 2 x h x p x r x e m v u r x g r 2 y h y p y r y e i z z r m x g v u r n h n p n r n e here m represents the mass x g is the center of gravity in the x direction and i zz is the moment of inertia in the z direction of the os u v and r are the speeds in the x y and yaw directions of the os respectively u v and r are the accelerations in each direction x y and n denote the hydrodynamic forces in each direction each hydrodynamic force is divided into components due to hull h propeller p rudder r and environmental disturbance e at this time the hydrodynamic forces acting on the hull can be expressed as eq 14 by the mathematical modeling group kijima and nakiri 1990 14 x h x u u x v r v r x r r r 2 x v v v 2 x u y h y v v y r r y v v y v v v v y v r r v r 2 y r r y r r r r y r v v r v 2 n h n v v n r r n v v n v v v v n v r r v r 2 n r r n r r r r n r v v r v 2 here the coefficients of speeds u v and r and accelerations u v and r x u x v r x r r x v v y v y r y v y v v y r y r r y r v v n v n r n v n v v n r n r r n r v v are the coefficients of hydrodynamic forces in each direction of the ship x u represents the resistance constant of still water kim and kim 2008 when the ship moves forward y p and n p are ignored because the force acting by the propeller almost acts in the x direction surge of the ship and it is assumed that there is a constant x p x r y r and n r are rudder forces that occur when changing the rudder angle δ and can be briefly expressed as seen in eq 15 zhao et al 2019 15 x r x δ δ y r y δ δ n r n δ δ here x δ y δ and n δ are rudder coefficients calculated by considering the rudder area and coefficients for additional drag finally ships are exposed to various maritime conditions such as wind waves and current during operation and the external force in each direction that affects the os is represented by x e y e and n e in this study wind and current which considerably influence the ship s manoeuvring motion are considered as external forces 4 4 formulation of rewards the drl process proceeds in the direction to maximize the value function v s for each state when the agent selects actions for a given scenario in the ppo algorithm the loss function of each network was defined through gae gae t in eq 8 which is the sum of the rewards previously obtained and the value function v s thus the process of the entire drl proceeds in the direction in which the value of the loss function is minimized and the total reward is maximized in this study the rewards obtained for each time step are divided into two types first rewards for path following rpf reflect whether the os reaches the destination along the reference path here the virtual reference path is assumed as the line connecting the starting point and the destination if the reference path is not given in addition rewards for collision avoidance rca reflect whether the os is avoiding collisions with ts as shown in fig 6 the rpf is subdivided into goal r goal fig 6 ① cross error r cross fig 6 ② and check point rewards r check fig 6 ③ and the rca is subdivided into collision r collision fig 6 ④ and colregs rewards r colregs fig 6 ⑤ zhao 2019 and colregs maintain reward r maintain fig 6 ⑥ a detailed description of each reward is provided below the five rewards shown in fig 6 have different value ranges therefore to normalize the effect of each reward the value of each reward is adjusted to be within 1 and 1 to calculate the rewards in fig 6 the parameters for each reward should be decided the parameters are flexibly decided considering the complexity of the path the number of obstacles around the os and the environmental condition to solve this problem all states and rewards formulated in this study are normalized to navigate the collision free path when the parameters are changed therefore if the drl based collision avoidance method is completely converged with the os the collision avoidance method work normally with changed parameters according to the path and the number of obstacles the os assesses the cr according to eq 6 for all other observable ships at each time step and selects the most dangerous ts if the cr value of the ts is smaller than the allowable cr cr al which is the criterion for collision avoidance there is no risk of collision therefore at this time step only the rca is calculated however if the assessed cr value is larger than cr al there is a risk of collision therefore the final reward is calculated by the sum of the rpf and rca in this case depending on the ratio of the rpf and rca the path following or collision avoidance could be more weighted in this study three modes d normal d efficiency d safety are constituted with the ratio of the rpf and rca set to 1 1 2 1 and 1 2 respectively for the os to arrive at a destination from a starting point a calculation of a number of time steps is required one iteration is performed after the number of time steps reaches the batch size and the drl process continues until the max iteration n in table 3 the reward summed in each iteration is called total reward as learning progresses and iterations increase the collision avoidance performance of the os can be determined by examining the change in the total reward 4 4 1 rewards for path following the rpf is a reward reflecting whether the os reaches a destination along a reference path and consists of three subdivided rewards as follows 1 goal reward goal reward is defined as a reward given according to the distance between the current location of the os and the destination as depicted in fig 7 the os can move from the current location p o t to the next location p o t 1 by the given action a t the set of points that can be moved by the available actions at the current location is represented by a concentric circle whose center is p o t and the radius is v o dt as shown in the figure if the os moves to the intersection of the straight line connecting p o t and the destination goal and this concentric circle the os can be closer to the destination point 1 in fig 7 conversely if the os moves in the opposite direction point 2 in fig 7 it will be farther from the destination therefore the goal reward when the os moves to points 1 and 2 are set to 1 and 1 respectively eq 16 presents the formula for calculating the goal reward r goal 16 r g o a l l t l t 1 v o d t w h e r e l t x o t x g o a l 2 y o t y g o a l 2 in this equation v o is the os speed and dt is the time step l t and l t 1 denote the distance between the current location and next location p o t and p o t 1 of the os and the destination respectively therefore the denominator of eq 16 indicates the distance that the os can move at each time step and the numerator indicates the difference in distance to the destination at each time step as mentioned earlier when the os moves to point 1 in fig 7 the goal reward is 1 because it is closer to the destination when moving to point 2 the goal reward is 1 because it is farther from the destination using this equation the goal reward always has a value between 1 and 1 regardless of the change in ship type and maximum speed 2 cross error reward a cross error reward is defined as a reward given according to the distance between the next location of the os and the reference path by the given action a t as shown in fig 8 if a reference path is not given a line connecting the starting point and the destination is assumed as a virtual reference path eq 17 presents the formula for calculating the cross error reward r cross 17 r c r o s s d c l 2 y e d c l 2 in this equation d cl is the maximum distance of the os from the reference path and is set according to the complexity of the path and the number of other ships this means that if the value of d cl is set larger the os can deviate more from the reference path to avoid a collision y e is the distance between the os and the reference path at the next time step when the os moves by a given action a t from the current state therefore if the os is on the reference path or farther from it the cross error reward has the maximum value 1 or the minimum value 1 respectively thus the cross error reward also has a value within a range between 1 and 1 depending on the os location 3 check point reward check point reward is defined as a reward given when the os passes the designated check point by the given action a t if the os does not have check points to pass before the destination this reward is 0 during the simulation contrary to other rewards that are calculated at each time step the check point reward is set to be given a particular value only when the os passes the check point eq 18 presents the formula for calculating the check point reward r check 18 r c h e c k d c h e c k v o d t i f p c h e c k p o t 1 ε c h e c k d c h e c k v o d t o t h e r w i s e in this equation d check is the sailing distance between check points v o is the speed of the os and dt is the time step p check is the location of each check point and p t 1 is the next location of the os by a given action a t ε check is the margin of the distance that the os recognizes as having passed the check point and it is assumed to be 50 m in this study check point reward is a reward given only when the os is recognized as having passed the check point therefore this reward is calculated by dividing the sailing distance after the os passes the last check point by the product of its speed and time step this means calculating the number of time steps required for the move and calculating the number of time steps as the check point reward thus the check point reward is continuously 1 during the time step if the os passes the check point and 1 if the os does not pass the check point 4 4 2 rewards for collision avoidance as mentioned before the rca reflects whether the os avoids a collision with ts and consists of two subdivided rewards as follows 1 collision reward collision reward is defined as a reward given according to the cr value between the os and ts when the os moves to the next location by a given action a t as described in section 2 2 in this study the cr between the os and ts is assessed using eq 6 considering the ship domain and cpa if the ts is present at the os ship domain boundary the cr is set to 1 and decreases to 0 as the ts moves farther from the os collision reward is defined using the assessed cr value first if the assessed cr value is smaller than cr al which is a criterion for collision avoidance the collision reward is at its maximum of 1 when the calculated cr value is higher than cr al the collision reward is reduced as depicted in fig 9 if the cr is 1 or more i e when ts enters the boundary of the ship domain the collision reward is at its minimum i e 1 eq 19 presents the formula for calculating the collision reward r collision 19 r co l l i s i o n 1 i f c r c r a l 1 c r a l 1 c r a l 2 c r 1 c r a l i f c r a l c r 1 0 1 i f 1 0 c r in this equation cr represents the collision risk between the os and ts assessed using eq 6 in addition in this study cr al was assumed to be 0 3 based on several trials and errors which is a value that enables the os to evade the ts with sufficient margin even in complex situations also if the ts enters the ship domain of the os it is assumed that the collision between the os and ts occurs therefore the travel scenario of the os is regarded to be failed and the agent of the drl based collision avoidance method gets the failure reward of 1000 with this failure reward the drl based collision avoidance method considers collision avoidance the most important even if the range of collision reward is the same as other rewards 2 colregs reward colregs reward is defined as a reward given when the os properly avoids a collision according to the colregs 13 17 in four encounter situations of the os and ts described in section 2 1 in this study the colregs reward is the maximum value 1 if the os avoids a collision in each encounter situation otherwise it is the minimum value 1 for example in a head on or crossing give way situation the os must turn to starboard thus the colregs reward is 1 if the os turns to starboard when choosing δ m a x of eq 12 as the action by the given action a t otherwise when choosing 0 or δ m a x of eq 12 as the action it is 1 eq 20 presents the formula for calculating the colregs reward r colregs 20 r c o l r e g s r c o l r e g s i f s a t i s f i e s c o l r e g s 13 17 r c o l r e g s o t h e r w i s e in this equation r colregs is 1 the colregs are the most important factor in ship operation and must not be contravened for this the colregs are reflected as the asymmetric shape of the ship domain of the os in this study as the cr is calculated with the distance of the ts from the boundary of the ship domain of the os the colregs are also reflected in the collision reward indirectly therefore the colregs are considered more than other rewards that consist of the rpf 3 colregs maintain reward in the real operation of a ship the os and ts recognize each other with the radar arpa sensors which have a large error and are greatly affected by the maritime environment therefore colregs maintain reward is defined as a reward given when the os maintains the moving direction not to have multiple minor course alterations according to the colregs 8b which is the rule to prevent misleading for operators on other ships in this study the colregs maintain reward is the maximum value 1 if the os maintains the moving direction otherwise it is the minimum value 1 eq 21 presents the formula for calculating the colregs maintain reward r maintain 21 r m a i n t a i n r m a i n t a i n i f s a t i s f i e s c o l r e g s 8 b r m a i n t a i n o t h e r w i s e 5 verification of the collision avoidance method in this study we proposed a collision avoidance method that includes a method to determine the ts by calculating the cr in the encounter situation with other ships we applied the proposed method to a simple example to verify its effectiveness thus a kvlcc2 kim and kim 2008 a very large crude oil carrier was selected as the example ship for convenience both the os and ts are assumed to be the same ship table 4 summarizes the main specifications and parameters of the example ship used for verification in the process of creating the ship domain the standard speed of the os and ts is assumed to be 15 5 knots kim et al 2016 which is the reference speed of ground sog of the kvlcc2 and the turning radius is assumed to be 900 m when the maximum rudder angle of the os is 35 kim and kim 2008 as a result using the manoeuvring equation of motion eq 13 the front a and right d lengths of the ship domain are calculated to be approximately 940 m and the left b and rear c lengths are set to 314 m which is equal to the length of the ship in addition the recognition distance d r and allowable cr cr al are assumed to be 2000 m and 0 3 respectively the coefficient a of dcpa is calculated as 1661 17 and the coefficient b of tcpa is calculated as 276 86 using fig 4 and eqs 4 and 5 the drl based collision avoidance method underwent a learning process to avoid collision for one to one encounter situations between the os and ts according to the colregs for the drl based collision avoidance method the scenario is generated in each iteration in the learning scenario two checkpoints exist between departure and arrival the os encounters three other ships with the head on crossing and overtaking situation in a sequence the encounter situation of each other ship is decided beforehand but the initial location heading angle and speed of each other ship is randomly decided within a certain range the initial location of each ship is determined randomly in the range of 2000 m from the reference path of the os the heading angle is decided by the encounter situation but can be changed in the range of 40 the reference speed of other ships is 15 5 knots for the head on and crossing situation and 4 knots for overtaking situation in each scenario the initial speed of other ships can be changed in the range of 10 as a learning tool keras based on the tensorflow framework was used and the learning process was performed on a pc with an intel core i7 4 50 ghz cpu 16 gb ram geforce titan gpu it exhibited a learning speed of approximately 200 iterations per hour the total reward for one iteration is depicted in fig 10 until 9000 iterations the learning process was performed as depicted in fig 10 the total reward starts at a value of less than 0 and gradually increases this implies that collision avoidance performance improves as the learning progresses in particular it was confirmed that the total reward rapidly increased between approximately 1500 and 3000 iterations the total reward converged near 5000 without any significant change 5 1 performance test according to degree of learning the total reward calculated from the drl based collision avoidance method indicates whether the os avoids the ts according to the colregs and reaches the destination along the reference path at the same time in this section we compare and analyze the collision avoidance performance for four encounter situations of the os and ts according to the learning progress the initial conditions for each situation are shown in fig 11 the initial location of the os is set to 0 0 and the destination is set to 0 10000 which is 10 000 m away in the north direction from the initial location the initial location direction and speed of the ts are set as appropriate in each situation in addition it is assumed that the direction and speed of the ts are constant table 5 shows the results of the os avoidance according to the learning progress for each situation when learning did not progress 0 iterations the os did not avoid a collision with the ts in all four situations accordingly the minimum distance between the os and ts was 701 m 849 m 465 m and 701 m in each situation respectively and the maximum cr value was 1 which means that a collision occurred in the head on crossing give way and overtaking situations in the crossing stand on situation the os did not appear to avoid a collision however because the left length of the os ship domain is smaller than the right length collision did not occur even if the distance between the os and ts was the same as in the crossing give way situation in addition because the relative speed between the os and ts is used to calculate the cr the distance between the os and ts was differently measured when the cr value was 1 in each situation as the learning process of the drl based collision avoidance method progressed with more iterations the minimum distance between ships increased and the maximum cr value gradually decreased to perform safe avoidance fig 12 shows the os collision free path according to the learning progress in each situation in the head on crossing give way and overtaking situations the os avoided a collision by turning to starboard according to the colregs in the crossing stand on situation the os should maintain the path and ts should avoid a collision by turning to starboard however in this study it was confirmed that the os turned to the starboard to avoid a collision because it is assumed that the ts maintains a constant direction and speed regardless of the colregs the reason the os turned to starboard is that the colregs reward of the rca is defined as the os complies with the colregs in addition because the right length d of the ship domain is longer than the left length b the ts should be on the left side of the os to reduce the cr 5 2 performance test according to collision avoidance mode the collision avoidance method proposed in this study might be limited as it always provides a constant result regardless of the given conditions such as the number of other ships the complexity of the reference path and the sea condition in some cases path following could be important in terms of economics and the risk of collision could be important in terms of safety therefore in this study to provide a result that can respond to various conditions the priority between the rpf and the rca is diversified to configure three modes and the learning model for each mode is generated the normal mode simply d normal sets the rpf and rca at the same ratio of 1 1 the efficiency mode simply d efficiency sets the rpf and rca at a ratio of 2 1 and considers path following rather than the cr so the os reaches the destination with a short sailing distance safety mode simply d safety sets the rpf and rca at a ratio of 1 2 and considers the cr rather than path following so that the os reaches the destination as safely as possible by avoiding the ts in addition the performance of the collision avoidance method in three modes is compared with the a algorithm which is one of the traditional path planning algorithms the a algorithm is a traditional path planning algorithm that finds the shortest path from departure to arrival based on graph traversal ma 2014 generally the cost function of the a algorithm consists of the cost of the path from the departure and the heuristic function that estimates the cost of the shortest path to the arrival in general a grid based algorithm such as the a algorithm provides a collision free solution by determining whether each grid can be moved according to the presence or absence of obstacles in this study the a algorithm finds the shortest collision free path that the ship domain of the os does not violate the ts for this the a algorithm considers whether the ship domain of the os violates in each grid the ts or not as a constraint accordingly the a algorithm does not consider the continuous collision risk of the ts and colregs to generate the collision free path therefore the a algorithm could be difficult to respond to a sudden change of speed and direction of the ts when the a algorithm is applied to the ship collision avoidance the grid candidates in which the os can move is limited since the manoeuvring performance of the os must be considered in this study it is assumed that the heading angle can rotate 15 when the os advances 500 m considering the turning circle of kvlcc2 and a grid candidate that the os can move is selected fig 13 shows the result of the collision avoidance using each mode of the drl based collision avoidance method and the a algorithm for each situation as shown in fig 13 all three modes in the case of drl based algorithms tend to start collision avoidance before the a algorithm this is because even if the same cr al is applied to both algorithms the drl based algorithm starts collision avoidance even though the cr is smaller than the cr al by considering the dangerous situation in advance based on the learned results accordingly it is confirmed that the minimum distance between the os and ts is shorter and the maximum cr is larger because the a algorithm starts collision avoidance later than the drl based algorithm table 6 summarizes the collision avoidance results for each mode of the drl based and a algorithms in each situation as shown in table 6 in the case of the d safety mode which has a larger weight on the rca the minimum distance between the os and ts was the longest and the maximum cr was the lowest in the case of the d efficiency mode with a larger weight on the rpf the minimum distance between the os and ts was the shortest and had the largest maximum cr but the os reached the destination with the shortest sailing distance the above results indicate that it is possible to perform safer or more efficient collision avoidance than the existing algorithm by selecting and using an appropriate mode from a given condition 6 applications 6 1 development of the prototype program to apply the proposed method to various examples and easily check the results a prototype program using c language was developed in the microsoft visual studio 2019 environment this program consists of a manoeuvring module that is based on the manoeuvring equation of ship motion a collision avoidance module that assesses the cr and avoids a collision based on the drl a scenario generator module that generates a scenario and a visualization module to visualize the results fig 14 shows the entire screenshot of the developed program as shown in fig 14 the user interface of the developed program consists of 4 parts first the ribbon view includes a function to import a learning model in the desired mode and a simulation progress function the property view shows detailed information of the os and ts and includes the setting of the location of the destination and check points of the os and the initial location speed and direction of other ships through the scenario generation function the map view shows the current location and speed of the os and ts cr and the path the os has traveled finally the graph view visualizes the distance between the os and ts and the cr 6 2 test scenarios this section validates the effectiveness of the proposed method for more complex examples for an objective comparison the results of the proposed method are compared with those of the a algorithm three examples were selected for comparison the initial location of the os is set to 0 0 and the destination is set to 0 10000 which is 10 000 m away in the north direction from the initial location of the os the initial location direction and speed of 10 other ships are randomly generated around the path of the os in the first and second examples multiple other ships approach the os almost simultaneously and in the third example multiple other ships approach the os in succession as in section 4 the os and other ships are assumed to be kvlcc2 and it is also assumed that there is no change in the speed of the os and the direction and speed of the ts are constant other parameters for assessment are the same as in table 4 6 2 1 scenario 1 multiple other ships approaching the os at the same time fig 15 shows the initial conditions of the os and other ships in example 1 the dangling line of the triangle representing each ship indicates the direction of the ship the units of location and speed of the os and other ships are m and m s respectively other ships constantly move with given direction and speed ts 1 and ts 2 in fig 15 represent dangerous ships approaching the os as the simulation progresses if the os avoids ts 1 from the front 0 2500 location to the starboard according to the colregs the os faces ts 2 approaching from the 3000 2500 location and the os should continuously avoid the two tss fig 16 shows the result of the collision avoidance with the drl based collision avoidance method d normal mode and the a algorithm the a algorithm started collision avoidance somewhat later than the drl based algorithm in this example ts 1 and ts 2 approached the os at the same time the a algorithm found the collision free path discretely by determining only whether the os and ts had a collision in the grid therefore the collision free path is ensured with the a algorithm but the cr can temporarily exceed 1 when the os moves from a grid to the next grid this is due to the characteristics of the grid based algorithms that can only consider the states at the grid the minimum distance between the os and ts 2 was measured to be approximately 126 m and the maximum cr was 1 14 with the a algorithm in contrast in the d normal mode collision avoidance was performed earlier than with the a algorithm and the os performed collision avoidance with a sufficient margin for both ts 1 and ts 2 the minimum distance was measured to be approximately 704 m and the maximum cr was 0 81 with the d normal mode table 7 summarizes the avoidance results of the d normal mode in the drl based and a algorithms fig 17 shows the initial conditions of the os and other ships in another example that is example 2 ts 1 ts 2 and ts 3 represent other dangerous ships approaching the os as the simulation progresses if the os avoids ts 1 from the front 0 2500 location to the starboard according to the colregs ts 2 of the 1500 7500 location ts 3 of the 3500 2500 location and ts 4 of the 3500 4000 location are also approaching at a similar distance to the os and it is difficult to avoid all other ships fig 18 shows the result of the collision avoidance with the drl based collision avoidance method d normal mode and the a algorithm the minimum distance between the os and ts 3 was measured to be approximately 94 m and the maximum cr was 1 23 with the a algorithm in contrast in the d normal mode collision avoidance was performed earlier than with the a algorithm and the os performed collision avoidance with a sufficient margin for all near the ts the minimum distance was measured to be approximately 333 m and the maximum cr was 0 98 with the d normal mode table 8 summarizes the avoidance results of each algorithm 6 2 2 scenario 2 sudden direction change of the ts nearby the os fig 19 shows the initial conditions of the os and other ships in example 3 the initial situation is the same as fig 15 of example 1 however the direction of ts 2 is suddenly changed nearby the os fig 20 shows the result of collision avoidance the drl based collision avoidance method d normal mode and the a algorithm in this study the initial states of other ships were randomly determined in a certain range consequently the d normal mode could cover various encounter situations therefore even when the direction of ts 2 changed rapidly the os successfully avoided the collision because the d normal mode could respond to the changed state of ts 2 the distance between the os and ts was reduced to 576 m and the maximum cr was increased to 0 86 on the other hand the a algorithm did not consider the cr of the ts and found a tight shortest collision free path by determining only whether the os and ts had a collision or not therefore even if a new path was generated through the changed state of ts 2 the os could not respond to the change because of the manoeuvring performance of the os accordingly the minimum distance between the os and ts was measured to be approximately 85 m and the maximum cr was 1 42 with the a algorithm table 9 summarizes the avoidance results of each algorithm 7 conclusion and future works in this study a collision avoidance method for autonomous ships was proposed including a cr assessment method the cr assessment method quantitatively assesses cr and selects the most dangerous ts in situations where multiple other ships are approaching the collision avoidance method navigates an appropriate collision free path and assures the safety of the os with respect to the ts to assess the cr we created an asymmetric elliptical ship domain considering colregs and improved the cpa based method to calculate the cr of other ships in addition based on the ppo algorithm of the drl the state action and reward were defined to propose a collision avoidance method for an autonomous ship the state was defined with the information of the os and ts to navigate a collision free path as a result of the drl the next rudder angle of the os was defined as an action to determine the os avoidance motion in particular the manoeuvring equation of motion with three degrees of freedom was used to simulate the exact motion of the os and determine the next location and speed the reward was calculated by dividing it into the rpf and rca to consider both the collision avoidance for the ts and the path following to the destination to apply the method to various situations the ratio of the rpf and rca was adjusted to create three modes of learning models d normal d efficiency and d safety in addition to verify the effectiveness of the collision avoidance method proposed in this study avoidance performance according to the learning progress was evaluated and the learning model of each mode was compared with the a algorithm as a result it was confirmed that the proposed algorithm performs the avoidance with a path that decreases the maximum cr by 15 compared to the a algorithm in four one to one encounter situations according to colregs based on the d normal mode the d efficiency mode generated a collision free path with the shortest sailing distance of the os and the d safety mode generated a safe collision free path with the lowest cr the proposed method was applied to the encounter situation of multiple other ships and the results were analyzed as a result stable collision avoidance was performed even when multiple other ships were simultaneously or continuously approaching in the first and second examples in which multiple other ships were simultaneously approaching the ts temporarily violated the ship domain of the os in the proposed method d normal the maximum cr was 0 81 and 0 98 and collision avoidance was performed by determining a safe path with the maximum cr reduced by 29 and 20 compared to the a algorithm in the third example where a sudden direction change of the ts nearby the os the maximum cr value was 1 42 for the a algorithm resulting in a collision however in the proposed method d normal mode the avoidance was performed by determining a safe path with the maximum cr reduced by 39 to 0 86 this was because the a algorithm is a grid based algorithm the a algorithm found the collision free path based on whether the os and ts had a collision in the grid not assessing the cr of the ts therefore while the os was moving from the grid to the grid a section in which cr exceeded 1 could occur and it was difficult to respond to sudden changes in the ts however the proposed method has some limitations about the encounter situation and avoidance motion first the proposed method only considers the situation that the os and ts are sailing in the open sea maritime accidents mainly occur in restricted waters where have a high probability of collision due to heavy traffic and limited movement accordingly the collision avoidance method should consider the restricted waters based on electronic navigational charts enc therefore we plan to consider map data such as enc based vector charts or bitmaps through our future studies in addition colregs rule 9 related to navigation in narrow channels will be added in consideration of the encounter situation in restricted waters as our future study the method for the collision risk assessment will be improved to derive more practical collision risk considering the probabilistic ship domain and the clustering density of the tss the ship domain could be calculated flexibly by considering the condition of the sea traffic and tss then the collision risk of the tss in safe situations could be relatively decreased and a more economic collision avoidance strategy could be derived on the other hand the collision risk of the tss in dangerous situations should be relatively increased and a more secure collision avoidance strategy has to be derived for this the collision risk assessment using the probabilistic ship domain will be applied to the rewards for collision avoidance second the proposed method can only control the rudder angle as the action of the drl based collision avoidance method we will extend the action of the drl based collision avoidance method to not only the rudder angle but also the speed of the os to control both the rudder angle and the speed of the os with the drl based collision avoidance method the neural network of deep learning should be more complexed and more advanced drl algorithms is needed therefore the twin delayed deep deterministic policy gradient td3 fujimoto et al 2019 and the soft actor critic sac haarnoja et al 2018 algorithm of the drl which are known to have better control performance than the ppo algorithm will be applied to ship collision avoidance problems as these algorithms have higher sample efficiency and stable learning convergence among drl algorithms they are more suitable for continuous control problems however these algorithms require more training data for learning also the collision avoidance method proposed in this study only considered the information of the ts which has the maximum cr consequently multiple minor course alterations can occur when the ts with the maximum cr changes recently there are several attempts to consider multiple targets by using the cnn with the information of grids szoke et al 2020 sudden course alteration when the ts with the maximum cr changes will be minimized by considering multiple tss at once with these attempts finally we plan to improve the authors existing studies zhao and roh 2019 to avoid multiple other ships continuously approaching and the effectiveness of the proposed method will be validated through experiments credit authorship contribution statement do hyun chun conceptualization methodology software visualization validation writing original draft myung il roh conceptualization validation writing review editing funding acquisition hye won lee software visualization validation jisang ha software visualization validation donghun yu validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is an expansion of our previous studies zhao et al 2019 zhao and roh 2019 ha et al 2021 and was partially supported by a daewoo shipbuilding and marine engineering co ltd republic of korea b research institute of marine systems engineering of seoul national university republic of korea and c institute of engineering research of seoul national university republic of korea 
