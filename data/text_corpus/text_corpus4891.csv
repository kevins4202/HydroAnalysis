index,text
24455,we propose a metapopulation model to investigate the role of environmental changes in shaping species diversity the model is studied under the framework of the fisher geometric model which assumes the existence of an optimal phenotype in each patch the phenotypic distance rules out the survivorship of the individuals in a patch to the optimal phenotype additionally we provide our model a genetic ground such that changes in phenotype are associated with mutational events one simulates environmental changes as shifts of the optimum phenotype quite surprisingly we find that the pattern of speciation depends only on the net effect of the environmental disturbances in a given time interval no matter the rate at which the events occur we also observe that migration has a pivotal role in shaping diversity due to its substantial effects on the genetic distance among individuals at small and intermediate values of the strength of selection keywords speciation metapopulation species richness migration phenotype genotype 1 introduction speciation extinction selection and dispersal are essential processes in the eco evolutionary dynamics of metapopulations understanding this dynamic is challenging since it requires long term temporal data making mathematical models a powerful alternative earlier mathematical models on metapopulation dynamics have focused on how local extinction and recolonization influence demographic persistence the coexistence of interacting species and genetic variation bürger 2006 levins 1969 hanski 1998 these studies show that environmental variation and demographic events greatly determine the dynamics of structured populations following levins reasoning a metapopulation consists of a set of unstable local populations levins 1969 hanski 1998 spatially explicit models for species area relationships incorporate the process of speciation besides extinction and colonization into the dynamics in which newly arising species originate from an ancestral species at a certain probability durrett and levin 1996 gavrilets 2004 there is no explicit genetic structure in such models individuals are not associated with a genome so those models are not equipped with a genotype space and a metric to quantify genetic dissimilarity among individuals instead speciation rates are defined so every event gives rise to a new species the mechanisms above were incorporated into the theory of biodiversity and biogeography and aimed to explain the diversity and relative abundance of species in ecological communities hubbell 2011 in all these frameworks species are considered ecologically equivalent understanding speciation is central to ecology and evolutionary biology turelli et al 2001 sobel et al 2010 according to the classic view speciation ensues after the accumulation of genetic differences such that these differences prevent interbreeding and recombination between populations dobzhansky 1937 coyne 1992 it is thus critical to incorporate an underlying genetics basis to any model and its interplay with interspecies interactions and environmental variation to explain the evolution of reproductive isolation and the splitting of lineages into separate species via 2002 it is well established that geography plays a fundamental role in constraining or promoting speciation coyne and orr 2004 fitzpatrick et al 2009 geographic barriers can hamper gene flow leading separated populations to evolve along different paths due to mutation genetic drift and local adaptation effects given enough time they will eventually become incompatible with each other fitzpatrick et al 2009 other modes of speciation can occur and their classifications are based on the geographical distribution of species populations turelli et al 2001 via 2002 with sympatric and allopatric speciations as extreme cases in allopatric speciation there exists a complete geographic separation whereas sympatric speciation refers to the absence of geographic barriers generally associated with disruptive selection and or assortative mating de aguiar et al 2009 hoelzer et al 2008 speciation is expected to be triggered by events of environmental change as well as a response to climate adaptation qvarnström et al 2016 but also as a result of human activities and urbanization thompson et al 2018 hendry et al 2007 there are many other factors that lead to speciation and their interplay leads to nonlinear responses gavrilets 2003 fragmentation of habitats has a prominent role in shaping barriers to gene flow because small and fragmented populations harbor reduced adaptive genetic variation relative to large populations though the rise of fragmentation also leads to greater genetic divergence among the resulting subpopulations keyghobadi et al 2005 bull and maron 2016 which in its turn may affect speciation rates in this contribution we investigate the emerging pattern of diversity in a metapopulation in a time varying environment the population evolves in response to viability selection density dependent reproduction and migration here we adopt a fitness landscape based on fisher s geometric model fisher 1930 the population is structured and individuals are subject to local adaptation in which the viability of the individuals in the patch they rely on depends on the phenotypic distance to the single phenotypic fitness optimum of that patch our model is phenotypic with a genetic basis in which mutations correspond to random displacements in trait space and mutations are assumed to act additively martin et al 2007 hwang et al 2017 this insight provides us a proper framework to address the problem of speciation as reproductive isolation results from incompatibilities at the genotypic level in our approach a fluctuating environment leads to changes in the optimum phenotype of every patch therefore these changes are expected to increase the mismatch of individuals phenotype with the optimum thus causing a drop in individual viability in harsh conditions in which either the selective pressure is too intense or the rate of environmental changes is too high the risk of population extinction is enhanced chevin et al 2010 through mutations the subpopulations occupying the patches can evolve towards the new optimum phenotype the rate of environmental changes and the response to selective pressure will also determine the resilience of the population at local and global scales together these processes with the demographic aspects may influence the level of genetic variation and diversity of the metapopulation 2 materials and methods 2 1 the model we adopt a mechanistic modeling for a metapopulation that is distributed over a constant number of m patches under sustained environmental change each patch imposes a selection pressure on the individuals representing different locations or resources as hosts in the host parasite interactions braga et al 2018 the patches form a fully connected network in which they can exchange migrants individuals are haploid and characterized by an infinitely large genome such that the infinite sites assumption applies fig 1 mutations occur at a rate μ we can think of the genome as a sequence of infinite sites g s 1 s 2 s with s α 0 1 where s α 1 means that a mutation occurred in position α as the genome is infinite there is no back mutation and each newly arisen mutation is unique at the phenotypic level individuals are described by l traits which will rule out their adaptation levels to the patch they belong in this way every individual is represented as a vector in a l dimensional phenotypic space r r 1 r 2 r l where r i is the value of the i th trait and r is the phenotype vector associated with a given genotype once a mutation arises the phenotype of the mutant becomes r η fig 1 so a mutation can affect the l traits resulting in a displacement η in the phenotypic space because we make use of the additive assumption mutations are combined additively such that the phenotype arising from two mutations is simply r η 1 η 2 martin et al 2007 hwang et al 2017 once a mutation occurs each component of the displacement vector η is obtained from a gaussian distribution of null mean and variance σ m u t 2 henceforth σ m u t is set at σ m u t 0 01 being in the range of realistic values as found for drosophila melanogaster and microbes drake 1999 gao et al 2011 inspired by the fisher s geometric model fisher 1930 orr 2005 de sousa et al 2016 braga et al 2018 the phentoype vector rules out the level of adaptation of the organism to the local patch and the fitness declines with the distance to the optimum individual fitness is determined by l traits under gaussian stabilizing selection on viability thus the viability of an organism j with phenotype r j r j 1 r j 2 r j l in a given patch k is calculated as 1 v j k exp ℓ r j ℓ h k ℓ 2 2 α r 2 where h k ℓ represents the optimum value of trait ℓ at patch k which is subject to temporal change the parameter α r is the width of the viability function and associated with the strength of selection the smaller the α r the stronger the selection is in the limit α r 0 only those individuals whose phenotype matches the patch optimum phenotype survives whereas in the limit α r one recovers the neutral selection regime note that selection is independent and equally strong in all l traits the population evolves according to the following life cycle viability selection sexual reproduction and migration please see fig 1 as usual the combination of alleles of the reproducing organisms received from their parents is the direct result of recombination those individuals that survive selection as described above are then subject to recombination and reproduction which occur locally inside the patch each individual randomly selects a potential partner from the same patch reproduction ensues once the hamming distance the genetic distance between two genotypes is smaller than g in the infinite site approach the hamming distance between two genotypes is simply given by π i j n i n j 2 n i j where n i is the number of mutations of genotype i and n i j is the number of mutations shared by the two genotypes then if the condition π i j g is met there is exchange of genetic information in which the one point crossover scheme is adopted for the recombination fig 1 presents an illustration of the process accordingly the parental genotypes are cut once in a randomly chosen position of the genome and recombined to form the offspring klug et al 2019 non overlapping generations and a density dependent population regulation are assumed hassell 1975 such that the number of copies of a given offspring is obtained from a poisson distribution of mean value henriques silva et al 2015 2 ρ λ 1 γ n t β with 3 γ λ 1 β 1 k in eq 2 λ refers to per capita growth rate n t is number of successful mating in the patch note that γ is chosen such that the minimum value of ρ is one if n t k in fact k makes the role of a carrying capacity and is assumed to be the same for all patches the parameter β defines the type of competition and is set at β 1 corresponding to a contest competition de oliveira et al 2020 the last stage of the life cycle concerns the process of migration as we assume a fully connected network individuals inside the patch can migrate to one of the m 1 remaining patches at a probability m per generation the migrant is equally likely to move to one of the m 1 remaining patches 2 2 moving optimum in the model the fitness landscape is not static such that the phenotype favored by each patch changes periodically every τ generations the phenotype favored by patch k h k h k 1 h k 2 h k l undergoes a shift in the phenotype space each component h k j changes by an amount ɛ j obtained from a gaussian distribution of null mean and variance σ h 2 in section 3 3 we will define and incorporate a directional component of selection 2 3 parameter values and initial conditions table 1 presents the values of the parameters used in our simulations it is important to highlight that the population is isogenic i e all individuals share the same genome and phenotype at the beginning though the landscape is heterogeneous and thereby each component of the optimum phenotype h k in patch k is chosen from a gaussian distribution with standard deviation σ 0 3 2 4 statistical measurements one of the main quantities of interest is the number of species hereafter species richness the species richness relies on genetic measurements of the pool of extant distinct genotypes in the metapopulation two distinct genotypes correspond to distinct species if their hamming distance π is larger or equal to g i e they cannot mate and recombine and besides there is no possibility of gene flow between them the latter condition means that there are no paths in genotype space connecting the two genomes i e there are no intermediate species connecting them the other two quantities assessed in all simulations are genetic and phenotypic dissimilarities which correspond to the average hamming distance π and average distance in the phenotypic space π p respectively for both quantities a sampling of size n s a m p l i n g is taken from the whole population and hence proceed with the pairwise measurements and average estimates for each pair of genomes ℓ and m the hamming distance between them is just π ℓ m n ℓ n m 2 n ℓ m where as before n i is the number of mutations of genotype i ℓ m and n ℓ m is simply the number of mutations shared by the two genotypes on the other hand the phenotypic distance between two sampled individuals is given by 4 π p ℓ m k r ℓ k r m k 2 and provides the euclidian distance between the two samples individuals in the phenotypic space 2 5 implementation details of the model the model is comprised of a recurrent cycle as previously presented see also fig 1 viability selection recombination followed by reproduction and migration concerning the details of each stage of the life cycle 1 selection each individual survives this step with a probability provided by eq 1 those individuals who do not survive will be removed therefore those individuals whose phenotype is more distant from the optimum phenotype will be removed with a higher probability 2 reproduction for each surviving individual another individual from the same patch is randomly selected with reposition if the hamming distance between the two genotypes is smaller than g the matting is successful the genomes of these two individuals are recombined and a mutation can occur this new genome is then reserved until all individuals in the patch have had a chance to mate then copies of these new genomes recompose the population in the patch the number of copies of each genome is defined by a poisson distribution of parameter ρ as defined in eq 2 those individuals that failed to recombine cannot reproduce and will not be present in the next generation 3 migration every individual migrates to a random patch with probability m per generation and with a probability 1 m remains in the original patch in the case of migration the recipient patch is chosen randomly among the m 1 available patches 3 results and discussions it is of utmost interest to understand how evolutionary mechanisms and forces drive speciation and maintenance of diversity in metapopulations in fig 2 we investigate how the strength of selection shapes the species richness results are shown for different values of τ the time to environmental changes we assess the species richness after the metapopulation has evolved for 30 000 generations ensuring that measurements are taken after an equilibrium regime has been attained the species richness is a one humped function of α r the width of selection viability in fig 2 migration probability m is set at m 0 005 the curves are shifted towards lower values of α r as τ increases i e the rate of environmental change decreases and collapse in the regime of strong selection the extent of the domain where the species richness remains in its maximum value is wider for smaller periodicity τ by one side the domain of small α r harbors a higher number of species while a single species remains in the domain of large α r the critical value of α r which characterizes the onset of the single species regime also depends on τ being shifted towards bigger α r as environmental changes decrease their periodicity thus the homogenizing effect of dispersal depends on the rate of environmental changes the width of viability selection α r is responsible for establishing the tolerance limits of the individuals the lower the α r the stronger the selection and the narrower the phenotypic range the individuals are viable so individuals belonging to distinct patches are less likely to migrate and thrive the reason species richness is maximized in the range of intermediate values of α r can be understood as follows when α r is small meaning the selection is hard the shift of the optimum phenotypes can be disruptive at a global scale leading to population extinction while the likelihood of global extinctions shrinks when α r is augmented events of local extinction i e those in a patch are still probable please see fig 3 note that the probability of extinction sharply drops within a narrow range of α r whereas the fraction of non empty groups rises steeply with α r local extinctions can lead to a continuous process of extinction followed by recolonization of patches entailing the loss of genetic variation the so called founder effect barton and charlesworth 1984 and hence the reduced species richness on the other hand when α r increases selection becomes softer turning the drift of the optimum phenotype less harsh the softness of selection first leads to increased species richness within the metapopulation as local populations can now respond to selection and evolve towards the optimum phenotype thus avoiding local extinction therefore the increase of α r turns the subpopulations more resilient to environmental changes though at small and intermediate values of α r the variation of optimum phenotypes among patches which is expected to be more significant than the resulting variation due to environmental changes within the patch contributes to making subpopulations more isolated and effectively reduce gene flow this occurs in spite of dispersal but to the reduced capability of migrants to thrive in neighboring patches in fig 4 we observe the influence of the variance of environmental changes σ h 2 on species richness the rise of σ h 2 might bring about more severe drops of the viability within a patch at the time of the optimum phenotype shift especially when selection is intense we notice that the domain of α r in which the events of local extinction followed by recolonization are relevant as well as the range of maximization of the species richness is broadened with σ h 2 this region is characterized by the growth of the species richness with α r moreover the onset of the monospecies regime is shifted towards larger α r the influence of σ h 2 on the levels of diversity urges us to inquire about the role of gradual vs discontinuous and abrupt changes on the dynamics in order to make a proper analysis the comparison will be made by taking gradual changes whose accumulated distribution of the variation of the optimum phenotype over a given period τ resembles the distribution of single events that takes place every time interval τ for the sake of clarity fig 5 shows a sketch of the dynamics under the two scenarios under the elucidative example of constant displacement after time τ the net displacement of the two processes will be the same as the displacement of the optimum phenotype is additive over time and from our knowledge of the central limit theorem reichl 1999 the accumulated distribution of gradual changes matches the distribution under discontinuous change whenever σ g r a d u a l 2 σ h 2 τ in our model which assumes a non constant displacement per event fig 2 addresses this question by comparing gradual vs abrupt environmental changes in the plot for abrupt changes one has set σ h at σ h 0 05 and different values for the time between environmental changes τ were simulated in the same plot we present results for their gradual counterparts open symbols as aforementioned gradual environmental changes are subject to the condition σ g r a d u a l σ h τ in a nutshell we can state that the curves nearly collapse meaning that the pattern of speciation is practically independent of the mode and rate of environmental changes quite surprisingly these outcomes demonstrate that what matters is the magnitude of the net displacement in the phenotypic space over a given time interval the rate at which these changes occur seems to have no noticeable effect once the overall effect is the same 3 1 genetic and phenotypic distances to comprehend the macroevolutionary scenario it is important to see how it relates to the metapopulation dynamics at a finer scale fig 6 shows the dependence of the genetic distance and the phenotypic distance among individuals on the width α r both distances have a similar pattern of the species richness fig 2 they first increase with α r reaching a maximum and then decrease although strong selection imposes differentiation among individuals it also increases mortality extinguishing individuals from some patches fig 3 then a little reduction in the selection strength avoids extinctions and increases the overall differentiation as the model tends to the neutral regime α r the pressure around the optimum phenotype decreases we could expect more phenotypic variation among individuals in opposition to what was observed however the reduction in the genetic and phenotypic distances probably occurs because the system reduces to only one species when the mating threshold imposes small variation among individuals as soon as the regime of a single species is attained both genetic and phenotypic distances plateaus i e they become independent of α r therefore an effective neutral regime establishes as soon as the single species regime is attained the highest phenotypic distance occurs under the smaller period of environmental changes probably because the higher number of changing events results in optimum phenotypes farther from each other once again results for abrupt environmental changes match their gradual counterparts the shape of the curves is basically unaltered and a collapse of the curves is still observed borrowing ideas from population genetics the average pairwise hamming distance π is used not only as a measure of genetic variation but also can be used as an estimator of the effective population size kimura 1969 tajima 1996 under neutral evolution in and under infinite sites assumption the pairwise hamming distance for haploid organisms is 5 π 1 n n 1 2 π ℓ m 2 n μ where n is sampling size and the sum runs over all pairs of the sampling thus we can investigate how the effective population which is just n e f f π 2 μ is influenced by the parameters of the model gordo et al 2009 shpak et al 2017 the computation of n e f f is quite important as it is related to the strength of stochasticity of the evolutionary dynamics the less the n e f f the more important is the influence of stochastic components on the dynamics the simulation results in fig 6 unveils that despite having a pivotal job in shaping the level of diversity the frequency of environmental changes does not settle the effective population size in the neutral regime in the neutral regime where π 6 the effective population size is of order 300 individuals which is considerably smaller than the sum of the carrying capacities of all patches which provides 5 000 in the face of such results one observes that ecological drift plays a prominent role in this domain of α r the role of ecological drift is especially weakened in the range of α r around α r m a x in such region local adaptation seems to be the dominating driving force shaping the pattern of speciation 3 2 the role of migration on shaping species diversity fig 7 displays a heat map for the species richness in terms of the viability width α r and migration m the scenario displayed in fig 2 in which the species richness is maximized in a range of intermediate value of α r is no longer observed when the migration probability is small as one reduces the migration probability it first leads to the shift of the onset of the neutral regime besides there is an enlargement of the domain of α r of maximum species richness up to the point at which a further reduction of migration leads to the loss of the single species regime under this scenario the species richness reaches its maximum value at α r m a x 0 5 and persists in such level of diversity in the range of α r α r m a x the maximum number of species equals the number of patches given that sympatric speciation had never been verified thus the metapopulation consists of isolated subpopulations under low migration and genetic incompatibilities accumulate between subpopulations of different patches to be shown in fig 8 the region of the phase diagram in which the process of local extinction followed by recolonization plays a central role and the strength of selection is strong is found in the left region of the diagram α r 0 5 in this phase migration seems to not play a prominent function and the levels of diversity are especially determined by the selective pressure a thorough analysis of the role of migration on the genotypic and phenotypic level is carried out in fig 8 from the plots we clearly acknowledge the effect of migration on the genetic distance between individuals while the migration seems to not influence the genetic distance in the domain of small α r it has a strong effect on the level of genetic differentiation at intermediate and large values of the width α r as the migration increases species richness goes to one and genetic distance reduces please note the logarithmic scale on fig 8 similar qualitative dependence on migration is observed at its phenotypic counterpart the right panel of fig 8 exhibits the average phenotypic distance from the individuals in the sampling to the optimum phenotypes of the patches they lie in contrary to what has been observed regarding the pairwise phenotypic distance the phenotypic distance to the patch s optimum phenotype grows with migration this behavior sets up on the onset of the neutral regime and the divergence between the curves increases with α r altogether these outcomes suggest that as individuals increase their motility over the metacommunity they become phenotypically more similar at the same time they are phenotypically more distant from the optimum phenotype in their patch this phenomenon occurs because the selection strength is reduced allowing the population to survive in a suboptimal condition araujo et al 2015 brooks et al 2019 under higher migration our results show that it is selectively advantageous to have a phenotype that reasonably matches most of the patches see in fig 8 that the distance from the optimum is higher under a higher migration rate 3 3 moving optimum with directional selection gradual vs abrupt changes here we will consider a slight modification of our modeling and include a directional component of selection such that the population faces a combination of directional and stabilizing selection thus the j th component of the optimum phenotype at patch k at the n th environmental change becomes 6 h k j h k j 0 v n υ where v denotes the directional component of selection υ is the sum of n gaussian variable of null mean and variance σ h 2 and h k j 0 is its initial value in order to make a correct comparison between gradual and abrupt changes v g r a d u a l v τ and as already established σ g r a d u a l 2 σ h 2 τ fig 9 displays the species richness vs α r under a metapopulation subject to directional and stabilizing selection in the plot we have chosen v 0 005 while σ h 0 05 results are presented for abrupt changes taking place every τ 200 generations and gradual changes under the rescale v g r a d u a l v τ and σ g r a d u a l 2 σ h 2 τ as emphasized above once again the agreement between the two scenarios is remarkable therefore the pattern of speciation remains unaltered even when directional selection components are considered in the plot v 0 005 3 4 dependence on the number of traits the dependence of the pattern of speciation on the number of traits l is more easily captured by rescaling the width of the viability function α r by 1 l we observe in fig 10 a reasonable collapse of the curves for different values of l especially on the onset of the neutral regime and beyond which shows that the effect of the number of traits on the curve species richness α r is to shift the onset of the neutral regime by a factor proportional to l the argument underneath the choice of 1 l as the rescaling factor is quite simple the number of terms in the argument of the viability function as defined in eq 1 is exactly the number of traits from our knowledge of classical statistical mechanics and similar reasoning applied to random walks the squared distance in the numerator should scale with l because α r appears in the equation as 1 α r 2 the rescaled quantity α r l comes about 3 5 dependence on the carrying capacity k for the sake of completeness in fig 11 we show the effect of the carrying capacity on the pattern of speciation by examining the figure we observe that changing the carrying capacity k while keeping the migration rate constant is similar to changing migration while keeping the carrying capacity fixed k 500 corresponds to the prevalent value used in our simulations when the carrying capacity is reduced to k 400 the onset of the neutral regime shifts towards higher α r and when it is further reduced to k 200 the species richness first grows with α r it then plateaus at the maximum level of diversity found the picture is quite similar to the one displayed in fig 7 in which first the decrease of migration leads to the shift of the neutral regime whereas for low migration rates the diversity grows with α r and then plateaus at the maximum level of diversity these results lead us to conclude that what matters is the number of migrants per generation since this number is directly proportional to both migration rate and carrying capacity k 4 conclusions there is a long standing debate about the role of climatic and ecological changes in shaping biodiversity little is known whether the biotic responses are a consequence of fast rapid or gradual climate change botta et al 2019 while some empirical studies suggest that evolutionary responses are slower relative to environmental change i e environmental changes are abrupt davis et al 2005 jackson 2000 taking as a special case climate change huntley et al 1991 other studies claim that such changes are gradual or even that both modes co occur osgood et al 2021 biological responses to climate changes occur through migration and phenotypic or molecular evolution and when failing populations and species can go locally or even globally extinct davis et al 2005 lorenzen et al 2011 we proposed a metapopulation model that employs the framework of fisher s geometric model to study how the pattern of speciation is influenced by environmental changes and their modes of occurrence quite surprisingly we found that under the framework of the fisher geometric model and in the range of analyzed parameters the pattern of speciation is only dependent on the magnitude of the environmental changes in a given time interval regardless of whether the changes are abrupt or ensue from repeated processes of smaller variations according to our approach the magnitude of environmental changes corresponds to each patch displacements of the optimum phenotype we draw the displacements from a gaussian distribution of null mean and fixed variance by rescaling the variance here using the reasoning of the central limit theorem reichl 1999 one can generate distributions of events that are additive and of smaller magnitudes that are equivalent to those resulting from single events because the central limit theorem ensures that the distribution of a sum of independent stochastic variables is gaussian distributed regardless of the distribution of the stochastic variables our claim is not dependent on the particular choice for the distribution of the magnitude of environmental changes our claim remains unaltered even in the presence of directional selection the aforementioned achievements are clearly of difficult empirical verification but a recent study on the dynamics of adaptation in yeast populations gorter et al 2016 shows that in which concerns the adaptation levels gradual and abrupt changes does not affect final fitness we find that migration has a pivotal role in shaping diversity due to profound effects at the genotypic level at the phenotypic level migration influences the pairwise and the phenotypic distance to the patch s optimum phenotype in an opposed manner while the former decreases with an increased migration rate the phenotypic distance to the patch s optimum phenotype grows in all cases the effect of migration is more pronounced close to the onset of the neutral regime and beyond the increase of migration has a homogenizing effect so the individuals phenotype tends to be more similar concomitantly the augmentation of the phenotypic distance to the patches can be explained by the activity of the viability selection that favors those phenotypes that can thrive in most of the patches in the detriment of local adaptation to a single patch as the alternation of patches become more frequent this effect becomes more pronounced as the selection strength 1 α r declines credit authorship contribution statement osmar freitas designed the study carried out the computer simulations participated in data analysis drafted the manuscript sabrina b l araujo designed the study participated in data analysis drafted the manuscript paulo r a campos designed the study carried out the computer simulations participated in data analysis drafted the manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments of is supported by the coordenação de aperfeiçoamento de pessoal de nível superior brasil capes finance code 001 prac acknowledges financial support from conselho nacional de desenvolvimento científico e tecnológico cnpq under projects no 406594 2018 0 and no 302569 2018 9 prac also acknowledges financial support from edital qualis a ufpe 
24455,we propose a metapopulation model to investigate the role of environmental changes in shaping species diversity the model is studied under the framework of the fisher geometric model which assumes the existence of an optimal phenotype in each patch the phenotypic distance rules out the survivorship of the individuals in a patch to the optimal phenotype additionally we provide our model a genetic ground such that changes in phenotype are associated with mutational events one simulates environmental changes as shifts of the optimum phenotype quite surprisingly we find that the pattern of speciation depends only on the net effect of the environmental disturbances in a given time interval no matter the rate at which the events occur we also observe that migration has a pivotal role in shaping diversity due to its substantial effects on the genetic distance among individuals at small and intermediate values of the strength of selection keywords speciation metapopulation species richness migration phenotype genotype 1 introduction speciation extinction selection and dispersal are essential processes in the eco evolutionary dynamics of metapopulations understanding this dynamic is challenging since it requires long term temporal data making mathematical models a powerful alternative earlier mathematical models on metapopulation dynamics have focused on how local extinction and recolonization influence demographic persistence the coexistence of interacting species and genetic variation bürger 2006 levins 1969 hanski 1998 these studies show that environmental variation and demographic events greatly determine the dynamics of structured populations following levins reasoning a metapopulation consists of a set of unstable local populations levins 1969 hanski 1998 spatially explicit models for species area relationships incorporate the process of speciation besides extinction and colonization into the dynamics in which newly arising species originate from an ancestral species at a certain probability durrett and levin 1996 gavrilets 2004 there is no explicit genetic structure in such models individuals are not associated with a genome so those models are not equipped with a genotype space and a metric to quantify genetic dissimilarity among individuals instead speciation rates are defined so every event gives rise to a new species the mechanisms above were incorporated into the theory of biodiversity and biogeography and aimed to explain the diversity and relative abundance of species in ecological communities hubbell 2011 in all these frameworks species are considered ecologically equivalent understanding speciation is central to ecology and evolutionary biology turelli et al 2001 sobel et al 2010 according to the classic view speciation ensues after the accumulation of genetic differences such that these differences prevent interbreeding and recombination between populations dobzhansky 1937 coyne 1992 it is thus critical to incorporate an underlying genetics basis to any model and its interplay with interspecies interactions and environmental variation to explain the evolution of reproductive isolation and the splitting of lineages into separate species via 2002 it is well established that geography plays a fundamental role in constraining or promoting speciation coyne and orr 2004 fitzpatrick et al 2009 geographic barriers can hamper gene flow leading separated populations to evolve along different paths due to mutation genetic drift and local adaptation effects given enough time they will eventually become incompatible with each other fitzpatrick et al 2009 other modes of speciation can occur and their classifications are based on the geographical distribution of species populations turelli et al 2001 via 2002 with sympatric and allopatric speciations as extreme cases in allopatric speciation there exists a complete geographic separation whereas sympatric speciation refers to the absence of geographic barriers generally associated with disruptive selection and or assortative mating de aguiar et al 2009 hoelzer et al 2008 speciation is expected to be triggered by events of environmental change as well as a response to climate adaptation qvarnström et al 2016 but also as a result of human activities and urbanization thompson et al 2018 hendry et al 2007 there are many other factors that lead to speciation and their interplay leads to nonlinear responses gavrilets 2003 fragmentation of habitats has a prominent role in shaping barriers to gene flow because small and fragmented populations harbor reduced adaptive genetic variation relative to large populations though the rise of fragmentation also leads to greater genetic divergence among the resulting subpopulations keyghobadi et al 2005 bull and maron 2016 which in its turn may affect speciation rates in this contribution we investigate the emerging pattern of diversity in a metapopulation in a time varying environment the population evolves in response to viability selection density dependent reproduction and migration here we adopt a fitness landscape based on fisher s geometric model fisher 1930 the population is structured and individuals are subject to local adaptation in which the viability of the individuals in the patch they rely on depends on the phenotypic distance to the single phenotypic fitness optimum of that patch our model is phenotypic with a genetic basis in which mutations correspond to random displacements in trait space and mutations are assumed to act additively martin et al 2007 hwang et al 2017 this insight provides us a proper framework to address the problem of speciation as reproductive isolation results from incompatibilities at the genotypic level in our approach a fluctuating environment leads to changes in the optimum phenotype of every patch therefore these changes are expected to increase the mismatch of individuals phenotype with the optimum thus causing a drop in individual viability in harsh conditions in which either the selective pressure is too intense or the rate of environmental changes is too high the risk of population extinction is enhanced chevin et al 2010 through mutations the subpopulations occupying the patches can evolve towards the new optimum phenotype the rate of environmental changes and the response to selective pressure will also determine the resilience of the population at local and global scales together these processes with the demographic aspects may influence the level of genetic variation and diversity of the metapopulation 2 materials and methods 2 1 the model we adopt a mechanistic modeling for a metapopulation that is distributed over a constant number of m patches under sustained environmental change each patch imposes a selection pressure on the individuals representing different locations or resources as hosts in the host parasite interactions braga et al 2018 the patches form a fully connected network in which they can exchange migrants individuals are haploid and characterized by an infinitely large genome such that the infinite sites assumption applies fig 1 mutations occur at a rate μ we can think of the genome as a sequence of infinite sites g s 1 s 2 s with s α 0 1 where s α 1 means that a mutation occurred in position α as the genome is infinite there is no back mutation and each newly arisen mutation is unique at the phenotypic level individuals are described by l traits which will rule out their adaptation levels to the patch they belong in this way every individual is represented as a vector in a l dimensional phenotypic space r r 1 r 2 r l where r i is the value of the i th trait and r is the phenotype vector associated with a given genotype once a mutation arises the phenotype of the mutant becomes r η fig 1 so a mutation can affect the l traits resulting in a displacement η in the phenotypic space because we make use of the additive assumption mutations are combined additively such that the phenotype arising from two mutations is simply r η 1 η 2 martin et al 2007 hwang et al 2017 once a mutation occurs each component of the displacement vector η is obtained from a gaussian distribution of null mean and variance σ m u t 2 henceforth σ m u t is set at σ m u t 0 01 being in the range of realistic values as found for drosophila melanogaster and microbes drake 1999 gao et al 2011 inspired by the fisher s geometric model fisher 1930 orr 2005 de sousa et al 2016 braga et al 2018 the phentoype vector rules out the level of adaptation of the organism to the local patch and the fitness declines with the distance to the optimum individual fitness is determined by l traits under gaussian stabilizing selection on viability thus the viability of an organism j with phenotype r j r j 1 r j 2 r j l in a given patch k is calculated as 1 v j k exp ℓ r j ℓ h k ℓ 2 2 α r 2 where h k ℓ represents the optimum value of trait ℓ at patch k which is subject to temporal change the parameter α r is the width of the viability function and associated with the strength of selection the smaller the α r the stronger the selection is in the limit α r 0 only those individuals whose phenotype matches the patch optimum phenotype survives whereas in the limit α r one recovers the neutral selection regime note that selection is independent and equally strong in all l traits the population evolves according to the following life cycle viability selection sexual reproduction and migration please see fig 1 as usual the combination of alleles of the reproducing organisms received from their parents is the direct result of recombination those individuals that survive selection as described above are then subject to recombination and reproduction which occur locally inside the patch each individual randomly selects a potential partner from the same patch reproduction ensues once the hamming distance the genetic distance between two genotypes is smaller than g in the infinite site approach the hamming distance between two genotypes is simply given by π i j n i n j 2 n i j where n i is the number of mutations of genotype i and n i j is the number of mutations shared by the two genotypes then if the condition π i j g is met there is exchange of genetic information in which the one point crossover scheme is adopted for the recombination fig 1 presents an illustration of the process accordingly the parental genotypes are cut once in a randomly chosen position of the genome and recombined to form the offspring klug et al 2019 non overlapping generations and a density dependent population regulation are assumed hassell 1975 such that the number of copies of a given offspring is obtained from a poisson distribution of mean value henriques silva et al 2015 2 ρ λ 1 γ n t β with 3 γ λ 1 β 1 k in eq 2 λ refers to per capita growth rate n t is number of successful mating in the patch note that γ is chosen such that the minimum value of ρ is one if n t k in fact k makes the role of a carrying capacity and is assumed to be the same for all patches the parameter β defines the type of competition and is set at β 1 corresponding to a contest competition de oliveira et al 2020 the last stage of the life cycle concerns the process of migration as we assume a fully connected network individuals inside the patch can migrate to one of the m 1 remaining patches at a probability m per generation the migrant is equally likely to move to one of the m 1 remaining patches 2 2 moving optimum in the model the fitness landscape is not static such that the phenotype favored by each patch changes periodically every τ generations the phenotype favored by patch k h k h k 1 h k 2 h k l undergoes a shift in the phenotype space each component h k j changes by an amount ɛ j obtained from a gaussian distribution of null mean and variance σ h 2 in section 3 3 we will define and incorporate a directional component of selection 2 3 parameter values and initial conditions table 1 presents the values of the parameters used in our simulations it is important to highlight that the population is isogenic i e all individuals share the same genome and phenotype at the beginning though the landscape is heterogeneous and thereby each component of the optimum phenotype h k in patch k is chosen from a gaussian distribution with standard deviation σ 0 3 2 4 statistical measurements one of the main quantities of interest is the number of species hereafter species richness the species richness relies on genetic measurements of the pool of extant distinct genotypes in the metapopulation two distinct genotypes correspond to distinct species if their hamming distance π is larger or equal to g i e they cannot mate and recombine and besides there is no possibility of gene flow between them the latter condition means that there are no paths in genotype space connecting the two genomes i e there are no intermediate species connecting them the other two quantities assessed in all simulations are genetic and phenotypic dissimilarities which correspond to the average hamming distance π and average distance in the phenotypic space π p respectively for both quantities a sampling of size n s a m p l i n g is taken from the whole population and hence proceed with the pairwise measurements and average estimates for each pair of genomes ℓ and m the hamming distance between them is just π ℓ m n ℓ n m 2 n ℓ m where as before n i is the number of mutations of genotype i ℓ m and n ℓ m is simply the number of mutations shared by the two genotypes on the other hand the phenotypic distance between two sampled individuals is given by 4 π p ℓ m k r ℓ k r m k 2 and provides the euclidian distance between the two samples individuals in the phenotypic space 2 5 implementation details of the model the model is comprised of a recurrent cycle as previously presented see also fig 1 viability selection recombination followed by reproduction and migration concerning the details of each stage of the life cycle 1 selection each individual survives this step with a probability provided by eq 1 those individuals who do not survive will be removed therefore those individuals whose phenotype is more distant from the optimum phenotype will be removed with a higher probability 2 reproduction for each surviving individual another individual from the same patch is randomly selected with reposition if the hamming distance between the two genotypes is smaller than g the matting is successful the genomes of these two individuals are recombined and a mutation can occur this new genome is then reserved until all individuals in the patch have had a chance to mate then copies of these new genomes recompose the population in the patch the number of copies of each genome is defined by a poisson distribution of parameter ρ as defined in eq 2 those individuals that failed to recombine cannot reproduce and will not be present in the next generation 3 migration every individual migrates to a random patch with probability m per generation and with a probability 1 m remains in the original patch in the case of migration the recipient patch is chosen randomly among the m 1 available patches 3 results and discussions it is of utmost interest to understand how evolutionary mechanisms and forces drive speciation and maintenance of diversity in metapopulations in fig 2 we investigate how the strength of selection shapes the species richness results are shown for different values of τ the time to environmental changes we assess the species richness after the metapopulation has evolved for 30 000 generations ensuring that measurements are taken after an equilibrium regime has been attained the species richness is a one humped function of α r the width of selection viability in fig 2 migration probability m is set at m 0 005 the curves are shifted towards lower values of α r as τ increases i e the rate of environmental change decreases and collapse in the regime of strong selection the extent of the domain where the species richness remains in its maximum value is wider for smaller periodicity τ by one side the domain of small α r harbors a higher number of species while a single species remains in the domain of large α r the critical value of α r which characterizes the onset of the single species regime also depends on τ being shifted towards bigger α r as environmental changes decrease their periodicity thus the homogenizing effect of dispersal depends on the rate of environmental changes the width of viability selection α r is responsible for establishing the tolerance limits of the individuals the lower the α r the stronger the selection and the narrower the phenotypic range the individuals are viable so individuals belonging to distinct patches are less likely to migrate and thrive the reason species richness is maximized in the range of intermediate values of α r can be understood as follows when α r is small meaning the selection is hard the shift of the optimum phenotypes can be disruptive at a global scale leading to population extinction while the likelihood of global extinctions shrinks when α r is augmented events of local extinction i e those in a patch are still probable please see fig 3 note that the probability of extinction sharply drops within a narrow range of α r whereas the fraction of non empty groups rises steeply with α r local extinctions can lead to a continuous process of extinction followed by recolonization of patches entailing the loss of genetic variation the so called founder effect barton and charlesworth 1984 and hence the reduced species richness on the other hand when α r increases selection becomes softer turning the drift of the optimum phenotype less harsh the softness of selection first leads to increased species richness within the metapopulation as local populations can now respond to selection and evolve towards the optimum phenotype thus avoiding local extinction therefore the increase of α r turns the subpopulations more resilient to environmental changes though at small and intermediate values of α r the variation of optimum phenotypes among patches which is expected to be more significant than the resulting variation due to environmental changes within the patch contributes to making subpopulations more isolated and effectively reduce gene flow this occurs in spite of dispersal but to the reduced capability of migrants to thrive in neighboring patches in fig 4 we observe the influence of the variance of environmental changes σ h 2 on species richness the rise of σ h 2 might bring about more severe drops of the viability within a patch at the time of the optimum phenotype shift especially when selection is intense we notice that the domain of α r in which the events of local extinction followed by recolonization are relevant as well as the range of maximization of the species richness is broadened with σ h 2 this region is characterized by the growth of the species richness with α r moreover the onset of the monospecies regime is shifted towards larger α r the influence of σ h 2 on the levels of diversity urges us to inquire about the role of gradual vs discontinuous and abrupt changes on the dynamics in order to make a proper analysis the comparison will be made by taking gradual changes whose accumulated distribution of the variation of the optimum phenotype over a given period τ resembles the distribution of single events that takes place every time interval τ for the sake of clarity fig 5 shows a sketch of the dynamics under the two scenarios under the elucidative example of constant displacement after time τ the net displacement of the two processes will be the same as the displacement of the optimum phenotype is additive over time and from our knowledge of the central limit theorem reichl 1999 the accumulated distribution of gradual changes matches the distribution under discontinuous change whenever σ g r a d u a l 2 σ h 2 τ in our model which assumes a non constant displacement per event fig 2 addresses this question by comparing gradual vs abrupt environmental changes in the plot for abrupt changes one has set σ h at σ h 0 05 and different values for the time between environmental changes τ were simulated in the same plot we present results for their gradual counterparts open symbols as aforementioned gradual environmental changes are subject to the condition σ g r a d u a l σ h τ in a nutshell we can state that the curves nearly collapse meaning that the pattern of speciation is practically independent of the mode and rate of environmental changes quite surprisingly these outcomes demonstrate that what matters is the magnitude of the net displacement in the phenotypic space over a given time interval the rate at which these changes occur seems to have no noticeable effect once the overall effect is the same 3 1 genetic and phenotypic distances to comprehend the macroevolutionary scenario it is important to see how it relates to the metapopulation dynamics at a finer scale fig 6 shows the dependence of the genetic distance and the phenotypic distance among individuals on the width α r both distances have a similar pattern of the species richness fig 2 they first increase with α r reaching a maximum and then decrease although strong selection imposes differentiation among individuals it also increases mortality extinguishing individuals from some patches fig 3 then a little reduction in the selection strength avoids extinctions and increases the overall differentiation as the model tends to the neutral regime α r the pressure around the optimum phenotype decreases we could expect more phenotypic variation among individuals in opposition to what was observed however the reduction in the genetic and phenotypic distances probably occurs because the system reduces to only one species when the mating threshold imposes small variation among individuals as soon as the regime of a single species is attained both genetic and phenotypic distances plateaus i e they become independent of α r therefore an effective neutral regime establishes as soon as the single species regime is attained the highest phenotypic distance occurs under the smaller period of environmental changes probably because the higher number of changing events results in optimum phenotypes farther from each other once again results for abrupt environmental changes match their gradual counterparts the shape of the curves is basically unaltered and a collapse of the curves is still observed borrowing ideas from population genetics the average pairwise hamming distance π is used not only as a measure of genetic variation but also can be used as an estimator of the effective population size kimura 1969 tajima 1996 under neutral evolution in and under infinite sites assumption the pairwise hamming distance for haploid organisms is 5 π 1 n n 1 2 π ℓ m 2 n μ where n is sampling size and the sum runs over all pairs of the sampling thus we can investigate how the effective population which is just n e f f π 2 μ is influenced by the parameters of the model gordo et al 2009 shpak et al 2017 the computation of n e f f is quite important as it is related to the strength of stochasticity of the evolutionary dynamics the less the n e f f the more important is the influence of stochastic components on the dynamics the simulation results in fig 6 unveils that despite having a pivotal job in shaping the level of diversity the frequency of environmental changes does not settle the effective population size in the neutral regime in the neutral regime where π 6 the effective population size is of order 300 individuals which is considerably smaller than the sum of the carrying capacities of all patches which provides 5 000 in the face of such results one observes that ecological drift plays a prominent role in this domain of α r the role of ecological drift is especially weakened in the range of α r around α r m a x in such region local adaptation seems to be the dominating driving force shaping the pattern of speciation 3 2 the role of migration on shaping species diversity fig 7 displays a heat map for the species richness in terms of the viability width α r and migration m the scenario displayed in fig 2 in which the species richness is maximized in a range of intermediate value of α r is no longer observed when the migration probability is small as one reduces the migration probability it first leads to the shift of the onset of the neutral regime besides there is an enlargement of the domain of α r of maximum species richness up to the point at which a further reduction of migration leads to the loss of the single species regime under this scenario the species richness reaches its maximum value at α r m a x 0 5 and persists in such level of diversity in the range of α r α r m a x the maximum number of species equals the number of patches given that sympatric speciation had never been verified thus the metapopulation consists of isolated subpopulations under low migration and genetic incompatibilities accumulate between subpopulations of different patches to be shown in fig 8 the region of the phase diagram in which the process of local extinction followed by recolonization plays a central role and the strength of selection is strong is found in the left region of the diagram α r 0 5 in this phase migration seems to not play a prominent function and the levels of diversity are especially determined by the selective pressure a thorough analysis of the role of migration on the genotypic and phenotypic level is carried out in fig 8 from the plots we clearly acknowledge the effect of migration on the genetic distance between individuals while the migration seems to not influence the genetic distance in the domain of small α r it has a strong effect on the level of genetic differentiation at intermediate and large values of the width α r as the migration increases species richness goes to one and genetic distance reduces please note the logarithmic scale on fig 8 similar qualitative dependence on migration is observed at its phenotypic counterpart the right panel of fig 8 exhibits the average phenotypic distance from the individuals in the sampling to the optimum phenotypes of the patches they lie in contrary to what has been observed regarding the pairwise phenotypic distance the phenotypic distance to the patch s optimum phenotype grows with migration this behavior sets up on the onset of the neutral regime and the divergence between the curves increases with α r altogether these outcomes suggest that as individuals increase their motility over the metacommunity they become phenotypically more similar at the same time they are phenotypically more distant from the optimum phenotype in their patch this phenomenon occurs because the selection strength is reduced allowing the population to survive in a suboptimal condition araujo et al 2015 brooks et al 2019 under higher migration our results show that it is selectively advantageous to have a phenotype that reasonably matches most of the patches see in fig 8 that the distance from the optimum is higher under a higher migration rate 3 3 moving optimum with directional selection gradual vs abrupt changes here we will consider a slight modification of our modeling and include a directional component of selection such that the population faces a combination of directional and stabilizing selection thus the j th component of the optimum phenotype at patch k at the n th environmental change becomes 6 h k j h k j 0 v n υ where v denotes the directional component of selection υ is the sum of n gaussian variable of null mean and variance σ h 2 and h k j 0 is its initial value in order to make a correct comparison between gradual and abrupt changes v g r a d u a l v τ and as already established σ g r a d u a l 2 σ h 2 τ fig 9 displays the species richness vs α r under a metapopulation subject to directional and stabilizing selection in the plot we have chosen v 0 005 while σ h 0 05 results are presented for abrupt changes taking place every τ 200 generations and gradual changes under the rescale v g r a d u a l v τ and σ g r a d u a l 2 σ h 2 τ as emphasized above once again the agreement between the two scenarios is remarkable therefore the pattern of speciation remains unaltered even when directional selection components are considered in the plot v 0 005 3 4 dependence on the number of traits the dependence of the pattern of speciation on the number of traits l is more easily captured by rescaling the width of the viability function α r by 1 l we observe in fig 10 a reasonable collapse of the curves for different values of l especially on the onset of the neutral regime and beyond which shows that the effect of the number of traits on the curve species richness α r is to shift the onset of the neutral regime by a factor proportional to l the argument underneath the choice of 1 l as the rescaling factor is quite simple the number of terms in the argument of the viability function as defined in eq 1 is exactly the number of traits from our knowledge of classical statistical mechanics and similar reasoning applied to random walks the squared distance in the numerator should scale with l because α r appears in the equation as 1 α r 2 the rescaled quantity α r l comes about 3 5 dependence on the carrying capacity k for the sake of completeness in fig 11 we show the effect of the carrying capacity on the pattern of speciation by examining the figure we observe that changing the carrying capacity k while keeping the migration rate constant is similar to changing migration while keeping the carrying capacity fixed k 500 corresponds to the prevalent value used in our simulations when the carrying capacity is reduced to k 400 the onset of the neutral regime shifts towards higher α r and when it is further reduced to k 200 the species richness first grows with α r it then plateaus at the maximum level of diversity found the picture is quite similar to the one displayed in fig 7 in which first the decrease of migration leads to the shift of the neutral regime whereas for low migration rates the diversity grows with α r and then plateaus at the maximum level of diversity these results lead us to conclude that what matters is the number of migrants per generation since this number is directly proportional to both migration rate and carrying capacity k 4 conclusions there is a long standing debate about the role of climatic and ecological changes in shaping biodiversity little is known whether the biotic responses are a consequence of fast rapid or gradual climate change botta et al 2019 while some empirical studies suggest that evolutionary responses are slower relative to environmental change i e environmental changes are abrupt davis et al 2005 jackson 2000 taking as a special case climate change huntley et al 1991 other studies claim that such changes are gradual or even that both modes co occur osgood et al 2021 biological responses to climate changes occur through migration and phenotypic or molecular evolution and when failing populations and species can go locally or even globally extinct davis et al 2005 lorenzen et al 2011 we proposed a metapopulation model that employs the framework of fisher s geometric model to study how the pattern of speciation is influenced by environmental changes and their modes of occurrence quite surprisingly we found that under the framework of the fisher geometric model and in the range of analyzed parameters the pattern of speciation is only dependent on the magnitude of the environmental changes in a given time interval regardless of whether the changes are abrupt or ensue from repeated processes of smaller variations according to our approach the magnitude of environmental changes corresponds to each patch displacements of the optimum phenotype we draw the displacements from a gaussian distribution of null mean and fixed variance by rescaling the variance here using the reasoning of the central limit theorem reichl 1999 one can generate distributions of events that are additive and of smaller magnitudes that are equivalent to those resulting from single events because the central limit theorem ensures that the distribution of a sum of independent stochastic variables is gaussian distributed regardless of the distribution of the stochastic variables our claim is not dependent on the particular choice for the distribution of the magnitude of environmental changes our claim remains unaltered even in the presence of directional selection the aforementioned achievements are clearly of difficult empirical verification but a recent study on the dynamics of adaptation in yeast populations gorter et al 2016 shows that in which concerns the adaptation levels gradual and abrupt changes does not affect final fitness we find that migration has a pivotal role in shaping diversity due to profound effects at the genotypic level at the phenotypic level migration influences the pairwise and the phenotypic distance to the patch s optimum phenotype in an opposed manner while the former decreases with an increased migration rate the phenotypic distance to the patch s optimum phenotype grows in all cases the effect of migration is more pronounced close to the onset of the neutral regime and beyond the increase of migration has a homogenizing effect so the individuals phenotype tends to be more similar concomitantly the augmentation of the phenotypic distance to the patches can be explained by the activity of the viability selection that favors those phenotypes that can thrive in most of the patches in the detriment of local adaptation to a single patch as the alternation of patches become more frequent this effect becomes more pronounced as the selection strength 1 α r declines credit authorship contribution statement osmar freitas designed the study carried out the computer simulations participated in data analysis drafted the manuscript sabrina b l araujo designed the study participated in data analysis drafted the manuscript paulo r a campos designed the study carried out the computer simulations participated in data analysis drafted the manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments of is supported by the coordenação de aperfeiçoamento de pessoal de nível superior brasil capes finance code 001 prac acknowledges financial support from conselho nacional de desenvolvimento científico e tecnológico cnpq under projects no 406594 2018 0 and no 302569 2018 9 prac also acknowledges financial support from edital qualis a ufpe 
24456,shelled pteropods are cosmopolitan free swimming organisms of biogeochemical and commercial importance they are widely used as sentinel species for the overall response of marine ecosystems to environmental stressors associated with climate change and changes in ocean chemistry however currently we are unable to project the effects of climate change on shelled pteropods at the population level due to the missing spatio temporal characterization of the response of pteropods to environmental stressors and the limited information on the pteropod life history and life cycle in this study we implement a shelled pteropod individual based model ibm i e we simulate a pteropod population as a set of discrete individuals over several generations life stages eggs larvae juveniles and adults and as a function of temperature food availability and aragonite saturation state the model is able to provide an abundance signal that is consistent with the abundance signal measured in the temperate region in addition the modeled life stage progression matches the reported size spectrum across the year with two major spawning periods in spring and fall and maturation in march and september furthermore our ibm correctly predicts the abundance maxima of younger smaller and potentially more susceptible life stages in spring and winter thus our model provides a tool for advancing our understanding of the response of pteropod populations to future environmental changes keywords pteropods individual based modeling life cycle california current system data and materials availability the code for the project is freely available upon request 1 introduction shelled pteropods or sea butterflies are cosmopolitan marine sea snails that spend their entire life cycle as free swimming organisms bednaršek et al 2012a suárez morales et al 2009 pteropods represent a major food source for other zooplankton seabirds whales and fish falk petersen et al 2001 hunt et al 2008 including commercially important ones such as herring mackerel or salmon lebrasseur 1966 lalli and gilmer 1989 in addition pteropods are substantial contributors to carbon export among pelagic marine calcifiers buitenhuis et al 2019 pteropods act as vectors for the export of particulate organic carbon to deeper waters due to the ballasting effect of their shells klaas and archer 2002 and because they repackage buoyant particles into faecal pellets tréguer et al 2003 manno et al 2009 and produce mucus webs during feeding gilmer 1972 which aggregate and sediment particles that would not sink otherwise noji et al 1997 shelled pteropods represent an ideal sentinel species for the response of marine ecosystems to ocean acidification due to their soluble aragonite shells that are sensitive to the state of the ocean carbonate chemistry orr et al 2005 bednaršek et al 2017b pteropods produce thin shells made out of the metastable calcium carbonate mineral aragonite lalli and gilmer 1989 which is approximately 50 more soluble than its calcite counterpart mucci 1983 thus a decrease in seawater carbonate concentration and ph due to the marine uptake of atmospheric co 2 doney et al 2009 leads to widespread pteropod shell dissolution and a decrease in pteropod survival wall palmer et al 2013 bednaršek et al 2017b manno et al 2017 in addition the exposure to lower carbonate concentration and ph decreases shell growth comeau et al 2010b bednaršek et al 2014 calcification moya et al 2016 egg organogenesis manno et al 2016 downward swimming velocities bednaršek et al 2014 bergan et al 2017 and mechanical protection against predators lalli and gilmer 1989 comeau et al 2010a the exposure to lower carbonate concentration is also linked to developmental delays thabet et al 2015 shell malformations or the complete loss of shells comeau et al 2010a the impacts of ocean acidification on the survival of pteropods depend not only on the magnitude and duration of the exposure to corrosive waters but on the life stage of the pteropods bednaršek et al 2016 as well as their exposure history bednaršek et al 2017a the exposure of pteropods to corrosive waters has far reaching consequences for biogeochemical cycles e g bednaršek et al 2014 and the flow of energy across trophic levels and from surface to depth e g capuzzo et al 2017 for instance developmental delays and impaired growth rates can reduce the carbon export to deeper layers due to a diminished ballasting effect of pteropod shells klaas and archer 2002 bednaršek et al 2014 or decrease the flow of energy and carbon across trophic levels capuzzo et al 2017 the latter can diminish fisheries yield ware 2005 and global food resources chassot et al 2010 although pteropods are used as sentinel species for ocean acidification orr et al 2005 bednaršek et al 2017b available in situ time series studies while having the highest degree of realism and ability to quantify population level responses to acidification andersson et al 2015 have shown no change ohman et al 2009 head and pepin 2010 thibodeau et al 2018 declining beaugrand et al 2012 beare et al 2013 mackas and galbraith 2011 and increasing howes et al 2015 trends in pteropod abundances around the world this lack of relationship between pteropod abundances and acidification is likely linked to the variable responses of pteropods in nature bednaršek et al 2016 alternatively the tipping point at which ocean acidification influences pteropods on a population level might not have been crossed yet mackas and galbraith 2011 doo et al 2020 however this stands in contrast to the observed widespread shell dissolution bednaršek and ohman 2015 which suggests that studies of abundance time series might have neglected indirect or sublethal effects that leave the abundances unaffected but influence shell structure morphology vertical distribution or population demographics ohman et al 2009 bednaršek and ohman 2015 manno et al 2017 bednaršek et al 2019 doo et al 2020 thus a spatio temporal characterization of shell dissolution that includes the life cycle of pteropods over several generations with life stage specific responses and sensitivities to multiple stressors e g ocean acidification and heat waves will likely provide an accurate picture of the effects of acidification on pteropod populations johnson et al 2016 bednaršek et al 2016 manno et al 2017 bednaršek et al 2019 one possible approach to resolve the aforementioned limited spatio temporal characterization of shell dissolution in pteropod populations is the simulation of pteropod populations as a set of discrete individuals over several generations using an individual based model ibm deangelis and grimm 2014 this approach requires a generalized life cycle model of shelled pteropods and their growth rates despite the ubiquity commercial and biogeochemical importance of pteropods their life cycle and growth rates have not been fully described hunt et al 2008 manno et al 2017 due to the difficulty to culture them in a laboratory howes et al 2014 and the dependence of their life cycle and longevity on local environmental conditions and taxonomic affiliation bednaršek et al 2012a wang et al 2017 manno et al 2017 however unlike pteropods in the polar regions e g kobayashi 1974 gannefors et al 2005 hunt et al 2008 bednaršek et al 2012b a life cycle with two generations per year has been reported across different regions and species in the temperate zone such as in the east coast of south america for l retroversa australis dadon and de cidre 1992 the coast of nova scotia and the gulf of maine for l retroversa lalli and gilmer 1989 maas et al 2020 or the temperate north pacific for l helicina wang et al 2017 the life cycle of l helicina and l retroversa has an overwintering generation that grows slowly during winter reaches a maturity by spring spawns the spring generation and dies shortly after dadon and de cidre 1992 wang et al 2017 maas et al 2020 the spring generation grows rapidly to maturity and dies shortly after spawning the next overwintering generation in late autumn dadon and de cidre 1992 wang et al 2017 maas et al 2020 the life cycle and growth rates of these species in temperate regions are likely less influenced by seasonal changes in environmental conditions compared to their polar analogue species manno et al 2017 the longevity and growth rates of l helicina and l retroversa are consistent across temperate regions additionally recent culturing experiments of the temperate l retroversa s life cycle identify ten stages and the developmental timings of key organs traits howes et al 2014 thabet et al 2015 these recent findings refine the description of the life cycle of these temperate pteropods and thus allow for the modeling of specific effects of multiple stressors at the organismal to the population level the different life stages in the pteropod life cycle are separated by the development of key organs thabet et al 2015 the development of key organs includes the larval shell protoconch wings parapodia and mature female gonads after six days three weeks and three months from hatching respectively thabet et al 2015 this detailed life cycle description with the developmental timings of key organs is crucial for the interpretation of the response of pteropods to ocean acidification for instance the development of the protoconch marks the onset of early shell dissolution thabet et al 2015 johnson et al 2016 which likely diminishes the ability for pteropods to deal with upcoming shell dissolution bednaršek et al 2017a alternatively the development of parapodia marks the onset of the daily upward and downward migration of pteropods across the water column i e diel vertical migration dvm lalli and gilmer 1989 mackas et al 2005 hunt et al 2008 which exposes pteropods to corrosive waters at deeper layers and non corrosive waters near the surface bednaršek and ohman 2015 an additional size or stage dependent trait is the calcification rate or shell repair rate comeau et al 2010b which increases with pteropod size bednaršek et al 2014 the relation between size and calcification or shell repair rate makes juveniles performing dvm relatively more susceptible to shell dissolution than adult organisms however the shell repair process is debated in the literature where shelled pteropods might produce thinner shells as a response to increased acidification mekkes et al 2021 nevertheless a pteropod ibm can be implemented based on the life cycle of temperate l helicina and l retroversa due to the consensus in the life cycle of temperate l helicina and l retroversa across regions lalli and gilmer 1989 dadon and de cidre 1992 wang et al 2017 maas et al 2020 and the recent success in culturing experiments detailing the stages and developmental timings of l retroversa howes et al 2014 thabet et al 2015 ibms have been used successfully in marine applications to characterize the life history of planktonic organisms or life stages and the interaction between individuals and their surroundings e g werner et al 1997 parada et al 2003 miller et al 1998 dorman et al 2015b ibms are well suited to link parameterized responses of individuals to environmental drivers and predict the overall responses of populations dorman et al 2011 stillman et al 2014 in ibms the population level responses emerge from the interaction between individuals and their environment and between the individuals themselves deangelis and grimm 2014 dorman et al 2015a thus ibms are able to consider variations among individuals of a population and along their life cycle deangelis and grimm 2014 ibms can also account for the dynamic and heterogeneous environmental conditions that determine population level characteristics such as size or life stage structure in time and space stillman et al 2014 in the case of l helicina and l retroversa their response to ocean acidification has been shown to depend on their life stage bednaršek et al 2016 life history bednaršek et al 2017a behavior bednaršek and ohman 2015 and size bednaršek et al 2014 for instance younger l helicina are more sensitive to corrosive waters relative to adults bednaršek et al 2016 smaller organisms are predominantly found near the surface while larger ones might actively avoid corrosive waters bednaršek and ohman 2015 while higher shell repair rates bednaršek et al 2014 allow individuals to compensate shell damage due to corrosive conditions comeau et al 2010b thus a pteropod ibm considers indirect or sublethal effects of acidification and unlike traditional time series analyses might be able to aid in finding population level responses to acidification at different time scales from ocean acidification extremes to climate change trends in this study we implement a shelled pteropod ibm using the life cycle with two generations per year of l helicina and l retroversa for the temperate region lalli and gilmer 1989 dadon and de cidre 1992 wang et al 2017 maas et al 2020 the developmental timings of their life stages howes et al 2014 thabet et al 2015 and a novel temperature and food availability dependence on shell growth buitenhuis et al 2019 in addition we implement the acidification sensitivity along the life cycle of pteropods bednaršek et al 2016 calcification rate with changing shell size bednaršek et al 2014 exposure to acidification due to a size dependent dvm maas et al 2012 bednaršek and ohman 2015 and swimming velocities bergan et al 2017 we analyze the outcome of our ibm on the output of a circulation model for the california current system calcs this allows us to test the hypotheses that the pteropod ibm i reproduces the pteropod abundance signal measured in the temperate region ii reproduces the measured size spectrum across seasons and iii characterizes the spatio temporal distribution of pteropod life stages in the calcs 2 model description the description of the model follows the odd overview design concepts details protocol for ibms grimm et al 2006 2010 2020 the ibm is implemented in python 3 7 and is available in the electronic supplementary material 2 1 purpose and patterns the primary purpose of this model is to predict the number size spectrum and population dynamics of shelled pteropods and their spatio temporal distribution in the calcs to this end we parameterized this model using mainly properties of the temperate species l helicina in cases where parameterizations for l helicina are limited we use properties of other members of the limacinidae family such as those characterizing l retroversa hereinafter we refer to the modeled pteropods based on l helicina and others as shelled pteropods ultimately the purpose of this model which will be presented in follow up work is to explore the relationship between pteropod populations and environmental stressors such as acidification across a range of different time scales to simulate population dynamics we use a life cycle with two generations per year for simulated pteropods wang et al 2017 and developmental timings of life stages key traits and behaviors e g protoconch parapodia onset of diel vertical migration and maturity howes et al 2014 thabet et al 2015 as a function of shell size in our implementation environmental stressors reduce shell size growth which allows our model to simulate the impacts of stressors on the life history behavior population demographics and spatio temporal distribution of individual pteropods 2 2 entities attributes and scales our model includes one entity the shelled pteropods to improve the model speed and memory use the shelled pteropod are treated as a collection of individuals with a constant number of members i e as super individual scheffer et al 1995 these pteropods are characterized by 15 attributes divided into nine state variables and six environmental life history characteristics table 1 the state variables are id the parent id parent size generation age size egg release readiness err index spawning events and accumulated damage d a m a c c the environmental life history characteristics are water temperature experienced t aragonite undersaturation experienced ω a r a g the chlorophyll a concentration chl oxygen concentration o 2 date and location the id and parent id are unique identifiers for each pteropod and the pteropod that spawned them the parent size represents the shell length mm of the parent pteropod during spawning the generation is an integer used to differentiate between pteropods of the spring even integer and overwintering odd integer generation as described for temperate regions dadon and de cidre 1992 lalli and gilmer 1989 wang et al 2017 maas et al 2020 the age measures the life time of pteropods in days since spawning the size represents the current shell size of the pteropods the err index similar to the clutch readiness fraction presented in miller et al 1998 represents whether or not a mature pteropod is ready to spawn eggs the spawning events represent the number of times a pteropod has produced and released eggs the t and ω a r a g quantify the average water temperature in c and aragonite undersaturation experienced by a pteropod in one day respectively the chl mg m 3 quantifies the cumulative sum of chlorophyll a concentrations experienced by a pteropod wormuth 1981 hunt et al 2008 the o 2 mmol m 3 quantifies the oxygen concentration experienced by a pteropod throughout the day the d a m a c c quantifies the amount of caco 3 mg lost due to dissolution or lack of accretion throughout the life time of each pteropod after growth and repair of previously accumulated damage the date and location depict the day in a year after the 1st of january and the depth m latitude n and longitude e of a pteropod the date and location attributes enable us to analyze the ibm using a circulation model output however the ibm on its own does not have a spatial scale the ibm s total simulation time is not constrained and is run at a one day time step 2 3 process overview and scheduling in this section we provide an overview of the processes that occur in our ibm the order in which they are executed and how the attributes are changed out of the 15 attributes the age size err index spawning events t ω a r a g c h l o 2 d a m a c c date and location are changed on each one day time step by the following five processes fig 1 1 movement and environment tracker 2 mortality 3 shell growth 4 development 5 spawning eggs 1 movement and environment tracker this function computes the vertical and horizontal movement of pteropods and tracks the environmental conditions i e the t c h l o 2 and ω a r a g that pteropods experience on an one hour time step at each location this higher temporal resolution was chosen since vertical migration can result in exposure to corrosive and non corrosive waters within a single day bednaršek and ohman 2015 in order to fit the simulation time step of one day we calculate the average t ω a r a g and the cumulative sum of c h l experienced by each pteropods in a 24 h window the movement and environment tracker was calculated using the lagrangian ocean analysis tool parcels probably a really computationally efficient lagrangian simulator v2 1 3 delandmeter and van sebille 2019 this lagrangian tool uses custom parcels objects for the execution and thus we have to translate the information for each pteropod stored as a numpy array oliphant 2006 into the custom parcels object back and forth before and after the execution of the movement and environment tracker function 2 mortality this function computes whether a pteropod dies or continues to live based on daily life stage dependent mortality rates the age of the pteropods generation dissolution and number of spawning events 3 shell growth this function calculates the net shell growth i e growth including dissolution lack of accretion and repair given the pteropod size and the t ω a r a g and chl experienced by the pteropod in the movement and environment tracker 4 development this function determines the life stage that each pteropod has reached based on their size different life stages are linked to the development of key traits organs e g protoconch parapodia juvenile adult shell maturity these key traits organs are used in other functions e g the development of the protoconch and parapodia to mark the onset of shell dissolution and dvm respectively 5 spawning this function determines whether a pteropod has reached maturity and is ready to spawn eggs 2 4 design concepts basic principles in this paper we implement a shelled pteropod ibm to characterize the life stage composition of pteropod populations in the calcs in accordance with previous findings our model uses size as a key trait to determine the developmental timings of pteropods kiørboe and hirst 2014 andersen et al 2016 in addition we link the growth and behavior of individuals to environmental conditions such as temperature ω a r a g food availability and oxygen concentration based on observations of l helicina and l retroversa and modeling efforts e g wang et al 2017 bednaršek et al 2012b 2014 thabet et al 2015 buitenhuis et al 2019 emergence pteropod population size structure and developmental timings over several generations emerge from the temperature food availability size dependent sensitivity to acidification repair rates and the occurrence of undersaturated conditions in relation to their life cycle as susceptible life stages may co occur with more corrosive conditions continuous exposure to corrosive conditions may result in developmental delays that ultimately shift the peak of pteropod abundances and population demographics in future generations adaptation pteropods that have developed parapodia adapt their maximum dvm depth during their descent pteropods descend in the water column until they reach a maximum depth which depends on their current size and the maximum depth at the current location however if the pteropods reach the upper boundary of the aphotic zone they stop their descent prior to reaching their maximum dvm depth in addition individuals actively avoid hypoxic layers 60 μ mol l 1 keeling et al 2010 ekau et al 2010 by swimming towards the surface these behaviors are modeled as indirect objective seeking i e individuals follow rules that have been observed in nature grimm et al 2010 2020 sensing pteropods in our model are assumed to sense their current depth the light availability oxygen and the time at which the sun sets and rises at their current location and time the modeled pteropods descend to their maximum depth and upon reaching this depth the descent stops stochasticity processes such as the onset of dvm and mortality or egg release time after reaching maturity are not explicitly implemented in our model however we use a stochastic parameterization to mimic the observed natural variability grimm et al 2010 2020 or to smooth the transition of one life stage to the next miller et al 1998 with regard to the onset of dvm the mechanism by which pteropods sense the sunrise and sunset times at each location is not modeled instead the onset of the migration towards the surface and towards the deeper layers are determined by the timing of the sunset and sunrise at the current location and date of the pteropods bianchi and mislan 2015 pteropod mortality in our model is represented using stochastic process formulations first we determine the survival probability of each pteropod based on their life stage second we draw a pseudo random number from a continuous uniform distribution over the interval 0 1 where individual pteropods die if their survival probability is lower than the pseudo random number finally the time needed to release eggs after reaching maturity is determined by the err index section 2 2 during initialization the err index is drawn from a pseudo random number from a continuous uniform distribution over the interval 1 1 observations data that can be collected from our ibm for testing and analysis include the abundances of pteropods population life stage composition size structure and all 15 attributes throughout the simulation over time and space in addition individual level observations such as the shell size as a function of the experienced ω a r a g temperature food availability age and generation can be collected from our ibm 2 5 initialization the aim of the initialization is two fold first it eliminates effects of initial conditions by spinning up the model to a steady state such that initial conditions have a minimal effect on the model s outcome grimm et al 2020 second the model at steady state defines a starting pteropod population life stage composition for future simulation experiments section 2 10 during the initialization pteropod experienced idealized environmental conditions and growth is not impaired by acidification the idealized environmental conditions were taken from daily sea surface chlorophyll a concentration and temperature climatologies between 30 n 60 n and 115 w 135 w for chlorophyll a we used the level 4 chlorophyll a product from the eu copernicus marine environment monitoring service cmems 2021 for temperature we used the sea surface temperature from the world ocean atlas 2013 locarnini et al 2013 we ran the initialization for 5 000 time steps i e around 13 simulation years starting with a population of 1 500 eggs of the spring generation and the processes listed in section 2 3 except for the movement and environment tracker function by excluding the latter process the exposure to acidification is turned off i e pteropod growth is not impaired by environmental stressors the attributes of the initial 1 500 eggs are as follows the ids are set to a number between zero and 1 499 parent ids and parent size to 1 generation age and spawning events to zero err to a random number in the interval 1 1 size to 0 15 mm wang et al 2017 and the d a m a c c to 0 0 mg caco 3 the remaining attributes t ω a r a g c h l o 2 date and location are not initialized at this point since these attributes are only changed during the execution of the movement and environment tracker function the outcome of the initialization is used to find a starting pteropod population composition on the 1st of january for simulations under time varying environmental conditions to find the initial population composition on the 1st of january we first compute the average daily modeled abundances from the last third of the simulation with 5 000 time steps where the 1st of january is represented by the first time step in the last third of the simulation second we calculate the similarity between the modeled abundances and the observed pteropod abundances between 30 and 60 latitude in the northern hemisphere reported in the marine ecosystem biomass data maredat initiative henceforth referred to as the maredat abundances bednaršek et al 2012a the eggs modeled were not included to calculate the daily mean pteropod abundances because the maredat abundances do not contain egg counts the similarity was measured based on the pearson r and spearman ρ correlation coefficient the manhattan distance l 1 and the proportion of modeled abundances f o u t outside of the abundance range mean std dev reported in maredat third we shift the position of the 1st of january by one time step forward and compare the resulting average modeled abundances to the maredat abundances this third step is repeated until all time steps in the last third of the simulation are used as the 1st of january last the modeled population on the time step defined as the 1st of january that resulted in the largest similarity to the maredat abundances is chosen as the initial population for simulations under time varying environmental conditions in the following section we present the structure and source of the physical biogeochemical forcing used to represent the time varying environmental conditions 2 6 input data in order to simulate changes in pteropod populations driven by environmental conditions the pteropod ibm requires input from external sources to represent changes in environmental conditions over time and space the input data for the physical biogeochemical forcing of the ibm need to be given for each grid cells with the attributes time in days since the start of the simulation location given as depth m latitude n and longitude e maximum depth m land water index horizontal and vertical current velocities u v and w in m s temperature c ω a r a g chlorophyll a concentration mg m 3 s and oxygen concentration mmol m 3 table 2 in this project we used the basin wide hindcast simulation of desmet et al in review for the period between 01 01 1984 and 31 12 2019 to simulate the time varying environmental conditions experienced by pteropods this simulation has a daily average output of temperature ω a r a g chlorophyll a concentration oxygen concentration and horizontal and vertical current velocities modeled using the ucla eth version of the regional oceanic modeling system roms marchesiello et al 2002 shchepetkin and mcwilliams 2005 frischknecht et al 2018 coupled with the biological elemental cycling model bec moore et al 2013 frischknecht et al 2017 the chlorophyll a concentration was adjusted to the maximum and minimum chlorophyll a concentrations found between 30 n 60 n and 115 w 125 w in the level 4 chlorophyll a product from the eu copernicus marine environment monitoring service cmems 2021 the coupled model uses a horizontal curvilinear grid with its center at the us west coast marchesiello et al 2002 frischknecht et al 2018 and has 64 terrain following vertical coordinates desmet et al in review this setup covers the pacific ocean basin with a horizontal grid spacing of 60 km that decreases to roughly 4 km towards central california frischknecht et al 2018 the high resolution at the coast of california in the telescopic setup properly simulates upwelling conditions along the coastal region and captures local frischknecht et al 2018 as well as basin wide processes frischknecht et al 2015 2017 the bec model simulates the cycling of nutrients e g carbon phosphorus nitrogen silicon iron which govern the growth of a lower trophic level marine ecosystem represented by three phytoplankton functional types small phytoplankton diatoms and diazotrophs and one zooplankton type moore et al 2013 frischknecht et al 2017 the ω a r a g is calculated offline using the mocsy 2 0 routine dickson et al 2007 orr and epitalon 2015 in the following section we present in detail how the pteropods interact with the environment and how they develop 2 7 submodels all model parameters and processes implemented in the ibm are summarized in the following sections in our ibm all five submodels section 2 3 use size as an input because it determines the developmental stage of the pteropods their behavior and interaction with the environment thus we first describe the shell growth function and build upon the assumption and parameterizations used in this function to describe the development spawning mortality and movement and environment tracker functions a summary of the functions and parameters are shown in table a 4 and table a 5 2 7 1 shell growth measurements of the growth rate of shelled pteropods as a function of temperature and food availability are unlike for other calcifying zooplankton e g foraminifera lombard et al 2009 2011 rare or are mostly constrained to the caribbean or the polar regions see compilation in bednaršek et al 2016 in addition the growth in pteropods varies between families bandel and hemleben 1995 lalli and gilmer 1989 for instance members of the cavoliniidae family reach the final shell size and shape early in their life cycle and their shells thicken inwards for the remainder of their life cycle bé et al 1972 lalli and gilmer 1989 in comparison the size of members of the limacinidae family correlates with the developmental stage and maturity hsiao 1939 lalli and wells 1978 to deal with these limitations current models represent pteropods using the growth rates of better constrained and similarly sized zooplankton species e g copepods buitenhuis et al 2019 however a recent multi year length frequency analysis of pteropod populations parameterized the size of l helicina as a function of time in the temperate north pacific wang et al 2017 this parameterization provides a realistic progression of shell size throughout the life of members of the limacinidae family in this temperate region thus for our ibm we define the size specific growth rate as the derivative of the equation for shell size with respect to time and include key environmental drivers of growth i e a temperature sensitivity based on the temperature coefficient q 10 buitenhuis et al 2019 a food limitation term using the monod equation monod 1978 lombard et al 2011 and a function for accretion and dissolution bednaršek et al 2014 the implementation of these processes is described in fig 2 each one day time step this function calculates the shell growth in four steps for each pteropod first we calculate the shell mass m s h e l l in mg caco 3 second we calculate the shell accretion and dissolution as a function of m s h e l l and the ω a r a g that pteropods experienced third we calculate the potential amount of caco 3 in mg that pteropods can produce as a function of their current size experienced temperature and food availability finally we calculate the growth or shell repair based on the potential amount of caco 3 that can be produced and the amount lost due to lack of accretion or dissolution step 1 shell mass we estimate the shell mass m s h e l l in mg caco 3 as a function of the size l as presented in bednaršek et al 2012b 2014 the relationship between m s h e l l and l is calculated using an empirical shell length weight relationship derived from fitting an exponential function to shell length and dry weight d w measurements of l helicina bednaršek et al 2012b 1 d w l 0 137 mg dry weight l 1 mm 1 5005 where d w is given in mg and l is given in mm and non dimensionalised next we calculate m s h e l l from d w d w is transformed to total carbon content t c in mg using the average conversion factor 0 25 mg tc mg dry weight of dry weight to total carbon of pteropods davis and wiebe 1985 the total inorganic carbon t i c is calculated from t c based on the finding that 27 appendix a 13 of the t c correspond to the t i c bednaršek et al 2012b m s h e l l is calculated from t i c using the molecular mass ratio of c to caco 3 8 33 mg caco 3 mol 1 mg tic mol 1 this results in the following relationship between m s h e l l and l 2 m s h e l l l d w l 0 25 mg tc mg dry weight 0 27 mg tic mg tc 8 33 mg caco 3 mol 1 mg tic mol 1 step 2 accretion and dissolution the damage to the shell as a function of the ω a r a g l in mg caco 3 d 1 is calculated based on the empirical fit of a two parameter exponential function to measurements of the percentage pteropod shell loss per day ν in shell loss d 1 as a function of ω a r a g in incubation experiments of l helicina bednaršek et al 2014 3 ν ω a r a g 65 76 d 1 e x p 4 7606 ω a r a g the exponential function ν is able to capture shell mass loss at supersaturated conditions ω a r a g 1 and accurately describes the observed two to three fold increase in shell mass loss between ω a r a g 1 and ω a r a g 0 8 bednaršek et al 2014 at higher supersaturation the shell mass loss approaches zero e g 0 052 at ω a r a g 1 5 fig a 8 the l is then calculated by multiplying m s h e l l by ν 4 l l ω a r a g m s h e l l l ν ω a r a g step 3 potential growth the growth rate g is calculated as the potential amount of caco 3 that a pteropod can produce in the absence of corrosive conditions in mg caco 3 d 1 this potential growth without dissolution is based on the growth rate μ l t f of the pteropod which includes the influence of size l temperature t and food availability f on calcification waldbusser et al 2010 gazeau et al 2013 explicitly we subtract the shell mass calculated in step 1 eq 2 from the shell mass that pteropods would have after growth given their size the temperature they experience and food availability 5 g l t f m s h e l l μ l t f l m s h e l l l μ is a function of the current size l the temperature that pteropods experience t c and food availability f mg chl m 3 μ l t f consists of three terms the reference growth rate μ 0 the temperature sensitivity of growth buitenhuis et al 2019 and the food limitation of growth monod 1978 lombard et al 2011 6 μ l t f μ 0 l q 10 t t 0 10 c f f k s 7 μ 0 l l t 1 l t 1 d 1 l t where q 10 1 3 is the unitless temperature coefficient buitenhuis et al 2019 t 0 14 5 c the reference temperature for growth wang et al 2017 and k s the chlorophyll a half saturation constant mg chl m 3 the value for k s 0 418 mg chl m 3 was determined based on our model tuning which is explained in detailed in section 2 8 the μ 0 i e the size increase per day relative to the current size at t 0 is calculated using the three year cohort length frequency analysis of l helicina in the temperate north pacific fig 3 wang et al 2017 the length frequency analysis uses a variation of the von bertalanffy growth function von bertalanffy 1938 which considers seasonal changes in pteropod growth rates within one year wang et al 2017 and is formulated as follows somers 1988 garcía berthou et al 2012 pauly 2013 8 l t l 1 e x p k t t 0 s t s t 0 9 s t c k ω s i n ω t t s where l t is the size in mm at age t s t parameterizes the seasonal changes in pteropod growth ω in yr 1 is the recurrence rate of seasonal changes in pteropod growth t s in yr marks the time sinusoidal growth oscillations begin with respect to a reference age t 0 l in mm denotes the maximum size of the pteropods k in yr 1 is the rate at which l is approached t is the age given as fraction of a year the reference age t 0 y r is the age at which the pteropods have l 0 0 mm c is a unitless factor between zero and one that expresses the amplitude of growth oscillations for this study we use the values t s 0 4 yr ω 2 π yr 1 and c 0 4 wang et al 2017 the values for k 5 07 yr 1 and l 4 53 mm are averaged from values reported in wang et al 2017 for the spring generation the maximum life span of a generation is 300 days wang et al 2017 manno et al 2017 as the size of pteropods is initialized as 0 15 mm section 2 5 wang et al 2017 the values of l t are shifted upwards to match a starting position of 0 15 mm i e l 0 0 15 mm step 4 net growth we calculate the net amount of caco 3 n e t caco 3 that remains after potential lack of accretion dissolution and calcification 10 n e t caco 3 g l we then use n e t caco 3 to calculate the effective change in shell mass δ m s h e l l and d a m a c c 11 δ m s h e l l n e t caco 3 d a m a c c if n e t caco 3 d a m a c c 0 otherwise 12 d a m a c c m a x 0 d a m a c c n e t caco 3 where an increase in shell mass only occurs if n e t caco 3 is larger than the current d a m a c c to find the size change we add δ m s h e l l to the m s h e l l l calculated in step 1 eq 2 and extract the corresponding l during step 4 the process by which pteropods cope with corrosive conditions depends on the potential growth g the loss term l and the balance between the two n e t caco 3 g l accretion is reduced when the loss term is non zero l l ω a r a g 0 and n e t caco 3 0 because the calcification rate of the pteropods is reduced by l l ω a r a g in cases where the loss term is larger than the growth term n e t caco 3 0 accretion drops to zero pteropods accumulate damage and do not grow 2 7 2 development recent culturing experiments with the temperate l retroversa have provided a detailed description of the life stage progression and development of limacina species howes et al 2014 thabet et al 2015 the life cycle of l retroversa includes the following stages and developmental timings after spawning the 2 4 h 4 6 h 8 9 h 16 cell 11 h blastula 16 h gastrula 24 72 h hatching 3 days trochophore 3 6 days veliger 6 7 days non reproductive juveniles 1 month and reproductive adult 3 months thabet et al 2015 these life stages are linked to the development of key organs including the larval shell protoconch and wings parapodia after six days and three weeks from hatching respectively thabet et al 2015 this detailed life cycle description with the developmental timings of key organs is crucial for the interpretation of the response of pteropods to ocean acidification because the development of the protoconch marks the onset of early shell dissolution thabet et al 2015 johnson et al 2016 which likely diminishes the ability for pteropods to deal with upcoming shell dissolution bednaršek et al 2017a in addition the development of parapodia marks the onset of dvm lalli and gilmer 1989 mackas et al 2005 hunt et al 2008 which might expose pteropods to corrosive waters at deeper layers and non corrosive ones near the surface bednaršek and ohman 2015 the life stages that we diagnose in our ibm are based on the ten stage life cycle model of l retroversa howes et al 2014 thabet et al 2015 however we simplify the ten stage life cycle into four life stage tracers fig 3 the eggs containing the 2 4 8 16 cell blastula gastrula and trochophore stages larvae containing the veliger stage juveniles containing the non reproductive juveniles and reproductive adults these four life stages were chosen based on the development of key organs the transition from egg to larvae is based on the formation of the protoconch after six days of development thabet et al 2015 during the larvae stage pteropods develop parapodia after 21 days of development thabet et al 2015 the transition from larvae to juvenile is based on the formation of the juvenile shell after 30 days of development thabet et al 2015 and the transition from juvenile to adult is based on the development of female gonads and mature ova after 90 days of development thabet et al 2015 this definition facilitates the analysis of the model output by binning individuals that share physiological and behavioral characteristics i e protoconch parapodia juvenile adult shell maturity into categories in order to implement the four life stages in our ibm we first defined size thresholds for the development of the key organs protoconch parapodia juvenile shell female gonads using the pteropod size parameterization l t eq 8 fig 3 the protoconch develops at a size of l t 6 days 0 50 mm the parapodia at l t 21 days 1 31 mm the juvenile shell at l t 30 days 1 74 mm and the female gonads and mature ova at l t 90 days 3 65 mm on each time step this function determines the life stage that a pteropod has reached depending on their size and increases the age of the pteropods by one day 2 7 3 spawning pteropods are protandrous hermaphrodites transitioning and functioning first as males and then as females hsiao 1939 newman and corey 1984 lalli and gilmer 1989 female tissue and low level spawning has been observed year round in populations of limacina species e g hsiao 1939 wang et al 2017 maas et al 2020 however major synchronizes spawning events followed by die off events of larger individuals take place in spring and autumn lalli and gilmer 1989 dadon and de cidre 1992 thabet et al 2015 wang et al 2017 maas et al 2020 the magnitude and timing of these synchronized widespread spawning events likely determine the abundance and population structure in subsequent generations seibel and dierssen 2003 gannefors et al 2005 maas et al 2011 the eggs are released as buoyant free floating masses at the water surface lalli and wells 1978 paranjape 1968 schalk 1990 gannefors et al 2005 comeau et al 2010a manno et al 2016 the number of eggs released per reproductive pteropod adult has a high variability which is likely linked to the environmental conditions that pteropods experience e g temperature food availability aragonite undersaturation paranjape 1968 manno et al 2016 for instance adult l helicina release on average 5 936 eggs observations range between 524 eggs and 1 0 051 eggs in the arctic lalli and wells 1978 and 565 eggs observations range between 465 eggs and 708 eggs in temperate regions paranjape 1968 across species and at the same region the number of eggs released per adult can vary where the number of eggs released by adult l retroversa range between 83 eggs and 650 eggs in the arctic lalli and wells 1978 in our model we simulate the synchronized widespread spawning events in spring and autumn lalli and gilmer 1989 thabet et al 2015 wang et al 2017 the die off of the largest individuals dadon and de cidre 1992 wang et al 2017 maas et al 2020 and neglect continuous low level spawning throughout the year see appendix a 10 lalli and gilmer 1989 thabet et al 2015 wang et al 2017 to this end we simplify the reproduction of pteropods by emphasizing the timing of maximum egg production i e the two major spawning and die off events in spring and autumn thus modeled adult pteropods only release eggs once and die afterwards we use a conservative estimate of 500 eggs per spawning event and per adult since it is within the ranges reported for l retroversa and l helicina in the arctic and temperate regions paranjape 1968 lalli and wells 1978 these eggs are released at the surface as free floating masses and the spawning time is spread in a time window of at most 20 days after maturation using the err index section 2 2 the latter indicates whether a modeled adult is ready to release eggs e r r 1 and is used to smooth the shift from one life stage to the next similar to the clutch readiness fraction presented in miller et al 1998 each one day time step we first increase the err index of all adults by 1 10 such that pteropods with an initial err index of 1 section 2 5 begin spawning 20 days after reaching maturation at the latest paranjape 1968 second we select all adults with e r r 1 third each selected adults spawn 500 eggs the attributes of the eggs are initialized as follows the unique ids are determined based on the largest id of the population prior to spawning parent ids and parent size are the ids of the parents and their current shell size generation is set to the generation of the parent plus one age and spawning events are set to zero err to a random number in the interval 1 0 size to 0 15 mm wang et al 2017 and the d a m a c c to 0 0 mg caco 3 the attributes date and location are initialized to the current date and the surface at the current latitude and longitude of the parent the remaining attributes t ω a r a g c h l o 2 are initialized as missing values as they are initialized during the execution of the movement and environment tracker function during the following time step finally the attribute spawning events of each parent pteropod is set to one 2 7 4 mortality information on the life span of temperate shelled pteropods is scarce manno et al 2017 under laboratory conditions l retroversa was recently shown to have a lifetime of six months howes et al 2014 thabet et al 2015 in the field individuals may persist longer than one year in a population wang et al 2017 however in this study we focus on the average pattern of the multi year cohort analysis of wang et al 2017 which indicates an average lifetime of six months for a spring generation and an average lifetime of eleven months for an overwintering generation of l helicina in the north pacific appendix a 12 both generations are separated by die off events of larger pteropods shortly after the two major spawning events in spring and fall dadon and de cidre 1992 wang et al 2017 maas et al 2020 for mesozooplankton daily mortality rates have been linked to the size of the organism zhang and dam 1997 however such a relationship does not account for differences between the spring and overwintering generation and is not suited for all life stages or sizes see appendix a 11 zhang and dam 1997 hence we estimate life stage and generation specific mortality rates using available observations and a tuning procedure in terms of daily mortality information on daily mortality rates β bednaršek et al 2016 or mortality coefficients m lischka et al 2011 for different pteropod life stages is scarce and reported values show large variability for instance juvenile l helicina collected in kongsfjord had a mean mortality coefficient of 12 6 lischka et al 2011 whereas the mortality coefficient for juvenile l helicina in the scotia sea is around 1 0 bednaršek et al 2012b 2016 however the limited observations of pteropod mortality document the effect of the exposure to corrosive water to pteropod mortality for different undersaturation states and temperatures lischka et al 2011 and thus a potential parameterization for the increase in daily mortality as a function of the aragonite undersaturation state experienced by pteropods in our model the pteropods die after reaching a maximum age after releasing eggs due to exposure to corrosive waters and due to other causes we chose a maximum age of ten months as averaged in the multi year cohort analysis of wang et al 2017 we used the data reported in lischka et al 2011 to calculate the increase in mortality due to the exposure to corrosive waters due to the very limited information on β we tested 56 2 500 combinations of life stage and generation specific values for β we chose the best combination of life stage and generation specific β that led to the best match up between simulated pteropod abundance and observed pteropod abundance between 30 and 60 latitude in the northern hemisphere the detailed tuning procedure is presented in section 2 8 each one day time step we first calculate m for each life stage and generation based on the calibrated values for β this means that we first calculate the proportion of individuals of each life stage that would die bednaršek et al 2016 13 m 1 e β 1 d second for each modeled pteropod we draw a pseudo random number from a discrete uniform distribution in the interval 0 1 and compare this number with the life stage and generation specific m if the pseudo random number is smaller than m then the modeled individual dies third we calculate the increase of m δ m as a function of the ω a r a g experienced by each modeled pteropod appendix a 2 fig a 9 based on the observations of lischka et al 2011 δ m is given by the difference between the undersaturation experienced by the modeled pteropod ω a r a g and the reference saturation state where dissolution is negligible ω a r a g 1 5 section 2 7 1 step 2 14 δ m 0 06 ω a r a g 1 5 if ω a r a g 1 5 0 otherwise fourth we add δ m to m and compare the pseudo random number drawn at the beginning with the corrected mortality coefficient if the pseudo random number is smaller than m δ m then the modeled individual dies finally we select the individuals with an age of ten months or those that have released eggs and remove them from the population 2 7 5 movement and environment tracker shelled pteropods are able to remain neutrally buoyant for extended periods of time e g during feeding lalli and gilmer 1989 and thus drift horizontally with the ocean currents however pteropods develop parapodia during their larvae stage thabet et al 2015 which allow them to escape predation gilmer 1972 gilmer and harbison 1986 the vertical distribution of shelled pteropods is species dependent where some shelled pteropod species have a weak or no vertical migration e g l trochiformis l retroversa creseis acicula myers 1968 wormuth 1981 hunt et al 2008 and others such as l helicina l inflata l lesueri myers 1968 wormuth 1981 ascend towards the surface at sunset to feed and descend to deeper waters to avoid predation at sunrise wormuth 1981 lalli and gilmer 1989 mackas et al 2005 hunt et al 2008 maas et al 2012 bianchi and mislan 2015 most shelled pteropods approximately remain in the upper 200 m of the water column lalli and gilmer 1989 but individuals of some species have been observed to migrate to deeper depths e g diacria trispinosa wormuth 1981 karakas et al 2020 the swimming speeds of pteropods is species dependent upward swimming speeds range between 12 mm s 1 heliconoides inflatus and 114 mm s 1 d trispinosa karakas et al 2020 sinking speeds range between 13 mm s 1 h inflatus and 105 mm s 1 d trispinosa karakas et al 2020 these relatively high swimming and sinking speeds imply that pteropods are able to swim several hundreds of meters in a short time span one to two hours lalli and gilmer 1989 and thus pteropods can experience a wide range of environmental conditions in a single day for instance they can be exposed to corrosive conditions at deeper depths and non corrosive conditions near the surface within a single day due to their vertical migration bednaršek and ohman 2015 these differences between day time and night time environmental conditions might increase with age where for some species e g l helicina older and larger individuals have been observed to swim to deeper layers in comparison to younger and smaller individuals bednaršek and ohman 2015 in our model this function serves three purposes first we simulate the drift of the pteropods along the ocean currents based on the horizontal and vertical current velocities calculated in the roms hindcast section 2 6 to this end we use the lagrangian ocean analysis tool parcels v2 1 3 delandmeter and van sebille 2019 second on top of the drift we simulate the vertical distribution of migratory pteropods using size dependent swimming and sinking speeds chang and yen 2012 and a size dependent dvm depth bednaršek and ohman 2015 the onset of the upward migration towards the surface and downward migration towards the deeper layers are determined by the timing of the sunset and sunrise at the location and date of the pteropod bianchi and mislan 2015 respectively third we calculate the average t ω a r a g and o 2 and the cumulative sum of c h l that the pteropods experience throughout their movement in a day to this end the movement and environment tracker function interpolates the physical biogeochemical forcing from two daily average outputs section 2 5 to then calculate the position of each pteropod and sample the environmental conditions that the pteropods experience throughout the day with a sub timestep of one hour current driven drift the current driven drift of modeled pteropods is calculated using the horizontal and vertical current velocities of the roms hindcast simulation section 2 6 using parcels built in fourth order runge kutta integration scheme including the vertical velocity delandmeter and van sebille 2019 this advection scheme may result in beaching of particles delandmeter and van sebille 2019 thus as recommended in delandmeter and van sebille 2019 we implemented an artificial current that pushes pteropods back to the ocean if they drift onto the shore below the sea floor or above the surface dvm the depth of the modeled pteropods is only changed through dvm if they have developed parapodia i e if modeled pteropods have a size of 1 31 mm fig 3 the vertical movement of modeled pteropods is constrained to the upper 250 m of the water column since l helicina and other shelled pteropods in the calcs have mainly been observed to stay above this depth bednaršek and ohman 2015 the depth to which modeled pteropods sink d d v m l is calculated as the product of the maximum depth of 250 m and the ratio of the current pteropod size l to the maximum pteropod size l 4 53 mm section 2 7 1 step 3 15 d d v m l 250 m l l in cases where the water column is shallower than d d v m l modeled pteropods sink to the bottom of the water column after calculating d d v m l we determine the swimming and sinking velocities of the modeled pteropods based on their current size v l adult l helicina can reach upward swimming speeds of 44 mm s 1 sinking speeds of 45 mm s 1 chang and yen 2012 thus we define the maximum swimming and sinking speed as 44 mm s 1 chang and yen 2012 and scale it by the ratio of l to l 16 v l 44 mm s l l our formulation is consistent with the description of chang and yen 2012 where the smallest modeled individuals l 1 30 mm reach a swimming velocity of 12 6 mm s 1 and the largest ones l 4 53 mm a velocity of 44 mm s 1 finally to calculate the dvm we simulate the amount of time that modeled pteropods spend at the surface migrating between the surface and deeper waters and at their dvm depth to this end we use the finding that zooplankton in general start swimming downwards around sunrise and arrive at the surface from their maximum dvm depth around sunset bianchi and mislan 2015 the sunrise and sunset timings were calculated based on the date and the position of each modeled pteropod nautical almanac office 1990 specifically the onset of the downward migration t d o w n corresponds to the sunrise time of the following day t s u n r i s e t s u n r i s e is determined for the following day since the movement of pteropods is calculated for 24 h starting at noon section 2 6 for the onset of the upward migration t u p we first determine the sunset time of the current day t s u n s e t to obtain the time at which pteropods arrive at the surface next we calculate the time at which the pteropods start their upward migration as the time each pteropod would need to reach the surface from their maximum dvm depth given their size and their upward swimming speed v 17 t d o w n t s u n r i s e 18 t u p t s u n s e t d d v m v l after reaching the surface modeled pteropods maintain their depth until t d o w n similarly modeled pteropods that reach d d v m maintain their depth sampling of environmental conditions the environmental conditions are provided by the roms hindcast simulation section 2 6 on each one hour time step of the movement and environment tracker function section 2 7 5 modeled pteropods sample their environment temperature chlorophyll a concentration oxygen concentration and aragonite saturation state at their location after 24 one hour time steps we calculate the average temperature aragonite saturation state chlorophyll a concentration and oxygen concentration that the pteropods experienced and update the attributes t ω a r a g c h l and o 2 with these values section 2 3 2 8 model tuning information of the values of the half saturation constant for the food limitation k s section 2 7 1 and the life stage and generation specific mortality rates β section 2 7 4 are limited or unknown to find possible values for k s and β we performed a two fold tuning exercise under idealized conditions section 2 5 first we estimate the value of k s to simulate the two generation per year cycle reported for temperate pteropods lalli and gilmer 1989 dadon and de cidre 1992 wang et al 2017 maas et al 2020 i e the time span between a pteropod that hatches in spring 30th april and the day that the next generation releases eggs is around 365 days second we ran our model for 5 000 time steps with 56 2 500 different combinations of life stage and generation specific mortality rates β section 2 7 4 for each model run we calculated the similarity between the daily average abundances and the maredat abundances see section 2 5 the similarity was measured based on the pearson r and spearman ρ correlation coefficient the manhattan distance l 1 and the proportion of modeled abundances f o u t outside of the abundance range mean std dev reported in maredat with regard to k s we tested values for k s ranging between 0 01 mg chl m 3 and 1 00 mg chl m 3 the duration of the two generation cycle increases linearly with increasing k s fig a 10 where k s 0 418 mg chl m 3 results in a two generation cycle of 365 days fig 3 under idealized conditions we did not observe a phase of slow growth during winter overwintering in the calcs however food scarcity 0 1 mg m 3 or lower temperatures 7 5 c during winter can lead to phases of slow growth followed by rapid growth in spring fig a 11 similar to the findings reported in wang et al 2017 between and within pteropod life stages the β can vary by more than a factor of ten e g between eggs and all other life stages lischka et al 2011 bednaršek et al 2016 thus for the life stage and generation specific β we tested the values 10 20 25 35 45 50 1 0 2 d 1 for the eggs and 1 2 5 5 7 5 10 1 0 2 d 1 for all other life stages the combinations that resulted in stable population dynamics with at least 50 and at most 35 000 individuals excluding eggs were evaluated based on the similarity between the daily mean pteropod abundances across the last third of the simulation and the daily pteropod abundances interpolated from the monthly abundance climatology observed in the maredat abundances bednaršek et al 2012a the eggs modeled were not included to calculate the daily mean pteropod abundances since the maredat abundances does not contain egg counts the similarity was measured based on the pearson r and spearman ρ correlation coefficient the manhattan distance l 1 and the proportion of modeled abundances f o u t outside of the abundance range mean std dev reported in maredat the values 10 7 5 1 7 5 1 0 2 d 1 for the eggs larvae juvenile and adults of the spring generation and 45 1 1 1 1 0 2 d 1 for eggs larvae juveniles and adults of the overwintering generation led to the most similar pteropod abundance pattern with r 0 99 ρ 0 91 l 1 15 50 and f o u t 0 29 fig 4 differences between the maredat abundances and the ibm simulation are found in the abundance magnitude in winter and the timing of abundance peaks in spring the simulated abundances are mostly within the range reported in the maredat abundances except in winter at the beginning of spring and early summer in addition the spring pteropod abundance peak occurs four days later in the ibm than in the maredat abundances 2 9 sensitivity experiments the daily mortality rates between and within pteropod life stages has been reported to vary by more than a factor of ten section 2 7 3 lischka et al 2011 bednaršek et al 2016 similarly the range of the number of eggs that an adult pteropod releases can vary between 83 and 1 0 051 depending on the species and region section 2 7 3 lalli and wells 1978 these parameters represent a major uncertainty with regard to the life cycle of pteropods thus we test the sensitivity of the ibm to the parameter choices associated with these two processes under idealized conditions section 2 5 to this end we increase and decrease the number of eggs released by adults the err and each life stage and generation specific mortality rate by 10 individually we ran our model for 5 000 time steps for each change of the parameters and calculate the similarity between the daily average modeled abundances and the maredat abundances see section 2 5 we evaluate the absolute abundance change in model data misfit based on the manhattan distance l 1 and the seasonal changes caused by the increase decrease in the chosen parameters using the pearson correlation r overall the l 1 between modeled pteropod abundances and the maredat abundances increases for all sensitivity experiments and r decreases by at most 0 12 table a 6 the largest difference in the modeled pteropod abundances is seen for the decrease by 10 of the number of eggs released per adult fig a 12i with an increase in l 1 of 27 1 the second largest change in modeled abundances is caused by an increase in the daily decrease in the mortality rate of the adults of the spring generation with l 1 25 3 and r 0 95 table a 6 this decrease in the parameter results in a longer spawning period and thus a shift in the period of higher pteropod abundances relative to the unchanged simulation fig a 12g for all other sensitivity runs the modeled abundance pattern resembles the unchanged simulation albeit with mostly lower magnitude in the modeled abundances during spring and early summer fig a 12 2 10 modeling goals in this study we aim to i reproduce the pteropod abundance signal measured in the temperate region ii reproduce the measured size spectrum across seasons and iii characterize the spatio temporal distribution of pteropod life stages in the calcs to this end we run the shelled pteropod ibm for each year in the roms hindcast simulation 19984 2019 starting on the 1st of january until the 31st of december first we define an initial pteropod population based on the ibm initialization section 2 5 which defines a starting pteropod population and life stage composition second we randomly seed the initial pteropod population in the calcs fig a 13 and initialize the depths and environmental conditions of the initial population using only the movement and environment tracker function for three days third we run the ibm for an entire year using all submodels section 2 7 thus we start each simulation year with the same initial population this approach was chosen because it emphasizes the role of drift and environmental conditions on the pteropod population e g dorman et al 2011 2015b a in order to compare the modeled pteropod abundances in the fully coupled model with the pteropod abundance signal measured in the temperate region we calculate a pteropod abundance climatology based on the median from all ibm one year runs for the entire hindcast period 01 01 1984 31 12 2019 we use this approach for the comparison since the maredat abundance data encompass observations from several years 1951 2010 bednaršek et al 2012a in addition the climatology contains potential inter annual variation in the modeled pteropod population which might be more comparable to the maredat abundance data next we define the number of individuals within each super individual section 2 2 by dividing the maximum number of pteropods reported in the maredat abundances across the region by the maximum number of modeled super individuals in the climatology to test our model performance we compare the pteropod population composition and the life stage progression from the climatology with the observed life stage duration and developmental timings under laboratory conditions howes et al 2014 thabet et al 2015 in addition we assess whether the modeled life stage progression and generation life span match field observations hsiao 1939 newman and corey 1984 dadon and de cidre 1992 lalli and gilmer 1989 thabet et al 2015 wang et al 2017 maas et al 2020 this study focuses on the two generation per year life cycle reported for l helicina and l retroversa in the temperate region and neglects low level spawning throughout the year section 2 7 3 thus the comparison between the modeled life stage presence and observations was adapted to only include observations of processes that are also implemented in our model to this end we use reports of major spawning events for the comparison with the modeled egg life stage the presence of immature individuals juveniles and larger non reproducing individuals for the comparison with the modeled juvenile life stage and the presence of individuals with mature ova and individuals producing eggs for the comparison with the modeled adult life stage we omit the comparison of modeled larvae with observations because the occurrence of larvae can only be inferred from the occurrence of eggs and juveniles in the available studies and their occurrence was not stated or shown explicitly in the studies listed above in a last step we characterize the spatio temporal distribution of pteropod life stages throughout a year based on their latitude and longitude to this end we determine the dominant life stage in terms of local abundances for each simulation day and 1 4 1 4 pixel in the modeled climatology this approach allows us to characterize the dispersal and horizontal distribution of pteropod life stages during different developmental stages in the modeled pteropod life cycle 3 results 3 1 population dynamics the modeled pteropod community structure is characterized by a succession pattern of three different generations which replace one another throughout the year fig 5 across the year the maximum median abundance of modeled super individuals was 1 3 665 5 excluding eggs section 2 8 which is roughly 18 times lower than the maximum number of pteropods reported in the maredat abundance across the region 24 9 960 thus each super individuals represents a collection of 18 individuals in general the duration of both generations is similar in magnitude table 3 the spring generation is present in the population between 231 days 5th percentile and 254 days 95th percentile in comparison individuals of the overwintering generation are present in the modeled population between 237 days and 271 days the main difference between the spring and overwintering generation relates to their relative abundance for instance the spring generation reaches a maximum median abundance of 1 3 619 5 super individuals fig 5a in comparison the larvae of the overwintering generation reach a maximum median abundance of 1 600 super individuals fig 5b table 3 outlines the succession pattern of the pteropod generations and life stages across all modeled years starting on the 1st of january the juveniles of the overwintering generation mature after 72 81 days and are ready to release eggs after 90 100 days 95th and 5th percentiles after spawning the individuals of the overwintering generation die 152 164 days after the 1st of january the eggs of the spring generation begin their transition to the larval juvenile and adult stages between 100 110 138 152 and 248 270 days after the 1st of january respectively upon reaching maturity adults of the spring generation begin to spawn the next overwintering generation at the earliest 257 days after the 1st of january and at the latest 279 days after the 1st of january the spring generation then disappears from the population 331 344 days after the 1st of january the eggs of the overwintering generation begin their transition to the larval and juvenile stages 263 287 days and 292 320 days after the 1st of january respectively overall the modeled life stage progression fits well with the reported pteropod life stage occurrence across multiple regions fig 6 the main difference between the modeled and observed life stage occurrence is seen for the modeled juveniles juveniles have been observed throughout the year mainly between 175 days and 264 days after the 1st of january for the spring generation newman and corey 1984 dadon and de cidre 1992 wang et al 2017 maas et al 2020 and between 265 days and 86 days after the 1st of january of the following year for the overwintering generation newman and corey 1984 dadon and de cidre 1992 wang et al 2017 maas et al 2020 in addition juveniles occur in the population for most of the year in both the observations and simulation however juveniles of the spring generation occur between 148 days and 327 days after the 1st of january the juveniles of the overwintering generation are present between 312 days and 136 days after the 1st of january of the following year red in fig 6 in addition the eggs of the overwintering generation and the adults of the spring generation are present 42 and 25 days longer in the model compared to observations respectively fig 6 3 2 spatio temporal distribution of shelled pteropods the analysis of the pteropod population dynamics neglects the spatial distribution of pteropods in the calcs and aggregates them to a single point in space thus we explore the spatio temporal distribution of the pteropod life stages of the spring and overwintering generations throughout a year fig 7 in terms of dispersal the pteropod population is advected southwestward from its initial location fig 7 the initial population was located between 33 n and 40 n median 36 75 n fig 7a and between 128 e and 121 e median 124 5 e fig 7b after one year the median latitude and longitude of the population decreased by 11 75 25 n fig 7a and 0 5 125 e fig 7b respectively in addition the range that the pteropods cover expands with time in both latitude and longitude by the end of the simulation year the pteropod population is located between 17 n and 44 n and between 143 e and 110 e overall the juveniles are the most dominant life stage for most of the year across all latitudes 62 5 and longitudes 63 6 fig 7 for roughly one quarter of the year the larval stage represents the dominant life stage across all latitudes 27 3 and across all longitudes 27 4 the eggs are the most dominant life stage for 7 9 7 0 of the year across all latitudes longitudes the adult life stage represent the dominant life stage only during 2 2 and 1 9 of the year across latitudes and longitudes respectively in comparison to the life stage succession sequence presented above section 3 1 we observe a similar pattern in the dominance succession across latitudes and longitudes fig 7 however the adult life stage is never the dominant life stage across all latitudes or all longitudes starting from the 1st of january the juvenile life stage represent the dominant life stage across all latitudes and longitudes fig 7 110 111 days after the 1st of january eggs represents the dominant life stage until 132 133 days after the 1st of january when the larvae life stage becomes the most dominant life stage across all latitudes longitudes the larvae become the most dominant life stage between 133 134 days after the 1st of january across all latitudes longitudes between 183 and 305 183 and 301 days after the 1st of january the juvenile life stage becomes the most dominant life stage across all latitudes longitudes afterwards the larvae life stage dominates the simulated population until 354 350 days after the 1st of january across all latitudes longitudes finally for the remainder of the year the juvenile life stage becomes the dominant life stage across all latitudes and longitudes overall the transitions from one life stage to the next occur roughly within the same week across latitudes during the first 180 days after the 1st of january fig 7a afterwards the transition from one dominant life stage to next occurs later at higher latitudes than at lower ones for instance the transition from larvae to juveniles near the end of the year at 20 n occurs 26 days prior to the transition at 40 n fig a 14 similarly in the first 250 days after the 1st of january the transitions from one life stage to the next occur roughly within the same week throughout the year and across all longitudes fig 7b in the second half of the year life stages further western transition slower from one life stage to the next than in the east larvae located at 140 e transition to the juvenile stage roughly 20 days later than those located at 120 e figs a 15 4 discussion our first aim of this study was to reproduce the measured pteropod abundance signal in the temperate region 30 n 60 n section 2 10 our ibm was able to reproduce the abundance signal under time varying environmental conditions for the northwestern pacific fig a 22 under these conditions the similarity between the observed and simulated abundances is high with a spearman correlation coefficient of 0 96 fig a 22 the mismatch between simulated and observed abundances mainly occurs during early spring where the onset of abundance increase occurs roughly 30 days later in our simulation the delayed onset of modeled abundance increase in spring is likely linked to the narrow spawning period implemented in the ibm however despite the lagged onset of abundance increase in the simulation the timing of the maximum pteropod abundance occurs within the range reported in maredat and the simulated abundances remain mostly within the observed range throughout the rest of the year fig a 22 thus on a population level our ibm is able to accurately reproduce the pteropod abundance signal measured in the temperate region in addition to the population level match between simulation and observation the second aim of this study was to provide a pteropod population life stage composition across one year that matches the life stage succession reported in the literature unlike in our model the distinction between individuals of the overwintering and spring generation is more challenging later in the year because individuals of different populations and individuals of different generations may overlap in time and space hsiao 1939 wang et al 2017 nevertheless the modeled longevity of seven eight months for the spring overwintering generation is of the same order of magnitude as the longevity reported for l retroversa kept under constant temperature 8 c and food replete conditions six months thabet et al 2015 and for l helicina in the temperate north pacific six months and eleven months for the spring and overwintering generation respectively wang et al 2017 on the life stage level the prolonged duration is most pronounced during the juvenile stages the modeled juvenile life stage has a duration of 114 days and 130 days for the spring and overwintering generation respectively table 3 in comparison under laboratory conditions this life stage lasts for 60 days section 2 7 2 thabet et al 2015 compared to field observations the juvenile life stage of the spring generation has a duration of 53 days fig 6 dadon and de cidre 1992 wang et al 2017 however the duration of the juvenile life stage of the overwintering generation has been observed to take 173 days dadon and de cidre 1992 wang et al 2017 thus the modeled duration of juveniles appears to be within the reported duration between the first juvenile and the first adult the difference between modeled and observed longevity might be explained by the difference between modeled and observed temperature and food availability that pteropods experience relative to the observed environmental conditions in the temperate north pacific with temperatures ranging between 6 c and 14 5 c and chlorophyll a concentrations between 2 5 mg m 3 and 15 mg m 3 wang et al 2017 the modeled pteropods experience warmer temperatures and lower food availability in our model simulations e g figs a 16 and a 18 thus the coupling between growth temperature and food availability fig a 11 in combination with warmer temperatures and food scarcity results in a longer spring generation and a shorter overwintering generation in the model domain detailed reports on the life stage progression or the life cycle of pteropods are scarce howes et al 2014 manno et al 2017 however we find that on average 87 of the modeled life stages weighted by modeled abundances fall within the corresponding life stage occurrence observations reported across multiple regions fig 6 such as in the gulf of maine hsiao 1939 thabet et al 2015 maas et al 2020 the bay of fundy newman and corey 1984 the temperate north pacific wang et al 2017 or the western south atlantic dadon and de cidre 1992 overall the timing in the development of the spring generation reflects the general patterns reported in the literature fig 6 the main difference between modeled and observed life stages occurs for the juveniles of the overwintering generation during winter at the beginning of the year the simulated juveniles experience relatively cold temperatures figs a 16 to a 17 and likely a slower growth period buitenhuis et al 2019 thibodeau et al 2020 which might explain the longer life stage occurrence these lower temperatures might have extended the duration of the modeled juvenile life stage and resulted in a progressively increasing delay in the life stage progression across the year in relation to the life stage dominance in the model we found that younger and smaller life stages dominate over older and larger ones in terms of abundance which is consistent with the observed dominance of smaller life stages in the calcs bednaršek and ohman 2015 and the temperate north pacific wang et al 2017 the third aim of this study was to characterize the spatio temporal distribution of pteropod life stages throughout a year however the comparison of model results to observations is limited by the fact that pteropods and zooplankton in general have a heterogeneous and patchy distribution e g wishner et al 1988 miller et al 1998 brentnall 2003 maas et al 2020 pasternak et al 2020 where sampling pteropods across small spatial scales can yield significantly different size specific abundances and vertical distributions in the calcs bednaršek and ohman 2015 nevertheless we found key similarities between our model results and observations in terms of dispersal and life stage spatio temporal distribution first we find a heterogeneous and patchy distribution in our modeled pteropod population evidenced by the isolated paths shown in fig 7 or as shown for seasonal maps of individual years figs a 20 and a 21 this aggregation into patches in our model is likely caused by eddies that are able to retain plankton within their boundaries for up to 67 days in our domain condie and condie 2016 and by our use of super individuals to match the observed pteropod abundances section 2 8 the latter results in a reduced representation of variable dispersal patterns and further increases spatial heterogeneity in the simulation parry and evans 2008 second we find a predominantly southwestward trajectory of the modeled pteropod population throughout a year which resembles the direction of the lateral export of organic matter towards the open ocean wit the california current frischknecht et al 2018 third our ibm simulates a dominance of the juvenile life stages in terms of presence across the year fig 7 and a relatively small dominance of adult life stages this finding reflects the observation that juvenile life stages can be observed throughout the year and the larger individuals are relatively seldom observed bednaršek and ohman 2015 wang et al 2017 in summary the abundances modeled with our shelled pteropod ibm is consistent with the measured pteropod abundance signal in the temperate region of the northern hemisphere and its application to the calcs results in a realistic perspective of the life stage progression for the simulated years this is evidenced by the match between the simulated life stage progression and the reported occurrence of life stages across several regions fig 6 such as the major spawning events in spring and fall hsiao 1939 dadon and de cidre 1992 thabet et al 2015 the subsequent die off events dadon and de cidre 1992 maas et al 2020 the overall dominance of earlier life stages in terms of abundance and dominant presence of juvenile life stages throughout a year newman and corey 1984 dadon and de cidre 1992 wang et al 2017 4 1 caveats and limitations the aim of this model is to describe north pacific temperate pteropod populations and to provide a template for modeling shelled pteropods which demonstrates the functionality of the ibm based on limicinidae species in the northwestern pacific thus the modeled pteropods their growth behavior and development are mainly based on observations of l helicina in the calcs and other limacinidae species in polar to temperate regions to apply this model to other regions the growth development bé et al 1972 bandel and hemleben 1995 and behavior e g migratory or non migratory wormuth 1981 of the modeled pteropods would need to be adjusted to the local pteropod community the species of interest and the scope of the project for instance in contrast to the continuous growth of l helicina for species of the cavoliniidae family the shell growth and development module would need to be adapted to reflect their two phase growth progression accurately section 2 7 1 depending on the species of interest the dvm behavior needs to be modified according to their migratory extent or lack thereof wormuth 1981 we used a simplified representation of the hermaphroditic reproduction of shelled pteropods section 2 7 3 hsiao 1939 that focuses on the timing of maximum egg production during spring and fall dadon and de cidre 1992 wang et al 2017 and neglects lower level spawning see appendix a 10 this choice emphasizes the role of temperature and food availability on pteropod growth and development and removes potentially confounding effects caused by multiple spawning events and a high diversity in life stage composition throughout the year thus the simplified spawning matches our the objective of this study to simulate a life cycle with two generations per year which corresponds to the observed abundance pattern at temperate latitudes for instance for assessments with the focus on the relationship between life stage variability and population fitness the influence of size on mortality or the adaptive or acclimation strategies of pteropods to corrosive conditions the spawning appendix a 10 mortality appendix a 11 or the parameters related to shell carbonate content appendix a 13 need to be adapted to fit the project s objective respectively despite the large amount of information on the biology of shelled pteropods information on some key processes remains scarce such as life stage specific mortality lischka et al 2011 bednaršek et al 2012b 2016 as shown by our sensitivity analysis changes in the mortality rates mainly affect the modeled abundances but not the seasonality table a 6 in terms of abundance changes linked to mortality rate uncertainty the shelled pteropod ibm uses super individuals to match the observed pteropod abundances thus we do not expect the life stage succession patterns to be affected by this uncertainty and the decrease increase in pteropod abundances due to the uncertainties in mortality rates could be lessened by adjusting the number of individuals within each super individual in terms of the spatio temporal distribution of pteropods a potential source of uncertainty is our choice in restarting each simulation year with the same initial population section 2 10 and the use of super individuals itself the former led to a simulation with reduced variability in the life stage composition of the pteropod population at the beginning of the simulation and a higher life stage variability near the end of the simulation however this approach emphasizes the role of environmental conditions such as temperature fig a 16 or food availability fig a 19 on the population life stage progression see also dorman et al 2011 2015b a with respect to the use of super individuals this approach was necessary to improve the model speed and memory use scheffer et al 1995 at the cost of reduced variable dispersal and enhanced patchiness parry and evans 2008 however unlike in our pteropod ibm the reduced dispersal is especially important if density dependent functions and interactive individuals are used parry and evans 2008 in addition the number of individuals per super individual in our ibm is roughly within the recommended order of magnitude ten parry and evans 2008 other potential caveats relate to the responses of pteropod to environmental conditions our model does not incorporate a direct pteropod response to some key factors such as oxygen gilmer 1974 mclaren 1963 hauss et al 2016 or predation e g by fish or shell less pteropods ohman 1990 peijnenburg et al 2020 however additional experimental and field work is needed prior to the incorporation of these direct responses due to the relatively high uncertainty in the influence of environmental stressors on pteropods and missing parameterizations lischka et al 2011 lischka and riebesell 2016 pasternak et al 2020 5 conclusion to the best of our knowledge this is the first ibm to simulate the life cycle of shelled pteropods with a spring and overwintering generation and four life stages in the model we use available information on and parameterizations of the biology of l helicina and l retroversa and link the characteristics of the individuals e g growth the onset of vertical migration mortality development response to environmental conditions to their size and the environmental conditions that they experience throughout their life our model successfully captures the measured pteropod abundance signal of the regions between 30 n and 60 n the life stage duration and succession sequence reported in the literature as shown in this study our model can be used to characterize the spatio temporal distribution of pteropod life stages in a region e g calcs overall our ibm is particularly relevant for quantifying ongoing and future effects of climate change which may manifest as changes in pteropod abundance size and growth e g ocean acidification bednaršek et al 2017b our implementation illustrates changes in the phenology and life stage composition of a pteropod population throughout a year fig 5 the behavior and development of individual pteropods is determined by the size of individual pteropods see litchman et al 2013 and the environmental conditions that pteropods experience e g food availability fig a 18 the inclusion of mechanistic responses to environmental conditions may allow our ibm to capture the effects of environmental stressors on populations as a whole or on individuals in the context of climate change marshall et al 2017 doo et al 2020 this approach may provide a detailed picture of the future and current effects of climate change on marine ecosystems where the ongoing pteropod shell dissolution illustrates a concrete marine ecosystem response to climate change manno et al 2017 bednaršek et al 2019 credit authorship contribution statement urs hofmann elizondo conceptualized the project developed the model prepared the data performed the analyses visualization wrote the first draft interpreted the results reviewed the manuscript meike vogt conceptualized the project developed the model interpreted the results reviewed the manuscript supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank n gruber and the environmental physics group for analytical and visualization advice funding this research was supported by eth zürich switzerland under grant 175787 x ebus extreme ocean weather events and their role for ocean biogeochemistry and ecosystems in eastern boundary upwelling systems snf appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ecolmodel 2022 109944 appendix a supplementary data summary of pteropod ibm parameterisations supporting information sensitivity analyses and alternative submodels the following is the supplementary material related to this article mmc s1 
24456,shelled pteropods are cosmopolitan free swimming organisms of biogeochemical and commercial importance they are widely used as sentinel species for the overall response of marine ecosystems to environmental stressors associated with climate change and changes in ocean chemistry however currently we are unable to project the effects of climate change on shelled pteropods at the population level due to the missing spatio temporal characterization of the response of pteropods to environmental stressors and the limited information on the pteropod life history and life cycle in this study we implement a shelled pteropod individual based model ibm i e we simulate a pteropod population as a set of discrete individuals over several generations life stages eggs larvae juveniles and adults and as a function of temperature food availability and aragonite saturation state the model is able to provide an abundance signal that is consistent with the abundance signal measured in the temperate region in addition the modeled life stage progression matches the reported size spectrum across the year with two major spawning periods in spring and fall and maturation in march and september furthermore our ibm correctly predicts the abundance maxima of younger smaller and potentially more susceptible life stages in spring and winter thus our model provides a tool for advancing our understanding of the response of pteropod populations to future environmental changes keywords pteropods individual based modeling life cycle california current system data and materials availability the code for the project is freely available upon request 1 introduction shelled pteropods or sea butterflies are cosmopolitan marine sea snails that spend their entire life cycle as free swimming organisms bednaršek et al 2012a suárez morales et al 2009 pteropods represent a major food source for other zooplankton seabirds whales and fish falk petersen et al 2001 hunt et al 2008 including commercially important ones such as herring mackerel or salmon lebrasseur 1966 lalli and gilmer 1989 in addition pteropods are substantial contributors to carbon export among pelagic marine calcifiers buitenhuis et al 2019 pteropods act as vectors for the export of particulate organic carbon to deeper waters due to the ballasting effect of their shells klaas and archer 2002 and because they repackage buoyant particles into faecal pellets tréguer et al 2003 manno et al 2009 and produce mucus webs during feeding gilmer 1972 which aggregate and sediment particles that would not sink otherwise noji et al 1997 shelled pteropods represent an ideal sentinel species for the response of marine ecosystems to ocean acidification due to their soluble aragonite shells that are sensitive to the state of the ocean carbonate chemistry orr et al 2005 bednaršek et al 2017b pteropods produce thin shells made out of the metastable calcium carbonate mineral aragonite lalli and gilmer 1989 which is approximately 50 more soluble than its calcite counterpart mucci 1983 thus a decrease in seawater carbonate concentration and ph due to the marine uptake of atmospheric co 2 doney et al 2009 leads to widespread pteropod shell dissolution and a decrease in pteropod survival wall palmer et al 2013 bednaršek et al 2017b manno et al 2017 in addition the exposure to lower carbonate concentration and ph decreases shell growth comeau et al 2010b bednaršek et al 2014 calcification moya et al 2016 egg organogenesis manno et al 2016 downward swimming velocities bednaršek et al 2014 bergan et al 2017 and mechanical protection against predators lalli and gilmer 1989 comeau et al 2010a the exposure to lower carbonate concentration is also linked to developmental delays thabet et al 2015 shell malformations or the complete loss of shells comeau et al 2010a the impacts of ocean acidification on the survival of pteropods depend not only on the magnitude and duration of the exposure to corrosive waters but on the life stage of the pteropods bednaršek et al 2016 as well as their exposure history bednaršek et al 2017a the exposure of pteropods to corrosive waters has far reaching consequences for biogeochemical cycles e g bednaršek et al 2014 and the flow of energy across trophic levels and from surface to depth e g capuzzo et al 2017 for instance developmental delays and impaired growth rates can reduce the carbon export to deeper layers due to a diminished ballasting effect of pteropod shells klaas and archer 2002 bednaršek et al 2014 or decrease the flow of energy and carbon across trophic levels capuzzo et al 2017 the latter can diminish fisheries yield ware 2005 and global food resources chassot et al 2010 although pteropods are used as sentinel species for ocean acidification orr et al 2005 bednaršek et al 2017b available in situ time series studies while having the highest degree of realism and ability to quantify population level responses to acidification andersson et al 2015 have shown no change ohman et al 2009 head and pepin 2010 thibodeau et al 2018 declining beaugrand et al 2012 beare et al 2013 mackas and galbraith 2011 and increasing howes et al 2015 trends in pteropod abundances around the world this lack of relationship between pteropod abundances and acidification is likely linked to the variable responses of pteropods in nature bednaršek et al 2016 alternatively the tipping point at which ocean acidification influences pteropods on a population level might not have been crossed yet mackas and galbraith 2011 doo et al 2020 however this stands in contrast to the observed widespread shell dissolution bednaršek and ohman 2015 which suggests that studies of abundance time series might have neglected indirect or sublethal effects that leave the abundances unaffected but influence shell structure morphology vertical distribution or population demographics ohman et al 2009 bednaršek and ohman 2015 manno et al 2017 bednaršek et al 2019 doo et al 2020 thus a spatio temporal characterization of shell dissolution that includes the life cycle of pteropods over several generations with life stage specific responses and sensitivities to multiple stressors e g ocean acidification and heat waves will likely provide an accurate picture of the effects of acidification on pteropod populations johnson et al 2016 bednaršek et al 2016 manno et al 2017 bednaršek et al 2019 one possible approach to resolve the aforementioned limited spatio temporal characterization of shell dissolution in pteropod populations is the simulation of pteropod populations as a set of discrete individuals over several generations using an individual based model ibm deangelis and grimm 2014 this approach requires a generalized life cycle model of shelled pteropods and their growth rates despite the ubiquity commercial and biogeochemical importance of pteropods their life cycle and growth rates have not been fully described hunt et al 2008 manno et al 2017 due to the difficulty to culture them in a laboratory howes et al 2014 and the dependence of their life cycle and longevity on local environmental conditions and taxonomic affiliation bednaršek et al 2012a wang et al 2017 manno et al 2017 however unlike pteropods in the polar regions e g kobayashi 1974 gannefors et al 2005 hunt et al 2008 bednaršek et al 2012b a life cycle with two generations per year has been reported across different regions and species in the temperate zone such as in the east coast of south america for l retroversa australis dadon and de cidre 1992 the coast of nova scotia and the gulf of maine for l retroversa lalli and gilmer 1989 maas et al 2020 or the temperate north pacific for l helicina wang et al 2017 the life cycle of l helicina and l retroversa has an overwintering generation that grows slowly during winter reaches a maturity by spring spawns the spring generation and dies shortly after dadon and de cidre 1992 wang et al 2017 maas et al 2020 the spring generation grows rapidly to maturity and dies shortly after spawning the next overwintering generation in late autumn dadon and de cidre 1992 wang et al 2017 maas et al 2020 the life cycle and growth rates of these species in temperate regions are likely less influenced by seasonal changes in environmental conditions compared to their polar analogue species manno et al 2017 the longevity and growth rates of l helicina and l retroversa are consistent across temperate regions additionally recent culturing experiments of the temperate l retroversa s life cycle identify ten stages and the developmental timings of key organs traits howes et al 2014 thabet et al 2015 these recent findings refine the description of the life cycle of these temperate pteropods and thus allow for the modeling of specific effects of multiple stressors at the organismal to the population level the different life stages in the pteropod life cycle are separated by the development of key organs thabet et al 2015 the development of key organs includes the larval shell protoconch wings parapodia and mature female gonads after six days three weeks and three months from hatching respectively thabet et al 2015 this detailed life cycle description with the developmental timings of key organs is crucial for the interpretation of the response of pteropods to ocean acidification for instance the development of the protoconch marks the onset of early shell dissolution thabet et al 2015 johnson et al 2016 which likely diminishes the ability for pteropods to deal with upcoming shell dissolution bednaršek et al 2017a alternatively the development of parapodia marks the onset of the daily upward and downward migration of pteropods across the water column i e diel vertical migration dvm lalli and gilmer 1989 mackas et al 2005 hunt et al 2008 which exposes pteropods to corrosive waters at deeper layers and non corrosive waters near the surface bednaršek and ohman 2015 an additional size or stage dependent trait is the calcification rate or shell repair rate comeau et al 2010b which increases with pteropod size bednaršek et al 2014 the relation between size and calcification or shell repair rate makes juveniles performing dvm relatively more susceptible to shell dissolution than adult organisms however the shell repair process is debated in the literature where shelled pteropods might produce thinner shells as a response to increased acidification mekkes et al 2021 nevertheless a pteropod ibm can be implemented based on the life cycle of temperate l helicina and l retroversa due to the consensus in the life cycle of temperate l helicina and l retroversa across regions lalli and gilmer 1989 dadon and de cidre 1992 wang et al 2017 maas et al 2020 and the recent success in culturing experiments detailing the stages and developmental timings of l retroversa howes et al 2014 thabet et al 2015 ibms have been used successfully in marine applications to characterize the life history of planktonic organisms or life stages and the interaction between individuals and their surroundings e g werner et al 1997 parada et al 2003 miller et al 1998 dorman et al 2015b ibms are well suited to link parameterized responses of individuals to environmental drivers and predict the overall responses of populations dorman et al 2011 stillman et al 2014 in ibms the population level responses emerge from the interaction between individuals and their environment and between the individuals themselves deangelis and grimm 2014 dorman et al 2015a thus ibms are able to consider variations among individuals of a population and along their life cycle deangelis and grimm 2014 ibms can also account for the dynamic and heterogeneous environmental conditions that determine population level characteristics such as size or life stage structure in time and space stillman et al 2014 in the case of l helicina and l retroversa their response to ocean acidification has been shown to depend on their life stage bednaršek et al 2016 life history bednaršek et al 2017a behavior bednaršek and ohman 2015 and size bednaršek et al 2014 for instance younger l helicina are more sensitive to corrosive waters relative to adults bednaršek et al 2016 smaller organisms are predominantly found near the surface while larger ones might actively avoid corrosive waters bednaršek and ohman 2015 while higher shell repair rates bednaršek et al 2014 allow individuals to compensate shell damage due to corrosive conditions comeau et al 2010b thus a pteropod ibm considers indirect or sublethal effects of acidification and unlike traditional time series analyses might be able to aid in finding population level responses to acidification at different time scales from ocean acidification extremes to climate change trends in this study we implement a shelled pteropod ibm using the life cycle with two generations per year of l helicina and l retroversa for the temperate region lalli and gilmer 1989 dadon and de cidre 1992 wang et al 2017 maas et al 2020 the developmental timings of their life stages howes et al 2014 thabet et al 2015 and a novel temperature and food availability dependence on shell growth buitenhuis et al 2019 in addition we implement the acidification sensitivity along the life cycle of pteropods bednaršek et al 2016 calcification rate with changing shell size bednaršek et al 2014 exposure to acidification due to a size dependent dvm maas et al 2012 bednaršek and ohman 2015 and swimming velocities bergan et al 2017 we analyze the outcome of our ibm on the output of a circulation model for the california current system calcs this allows us to test the hypotheses that the pteropod ibm i reproduces the pteropod abundance signal measured in the temperate region ii reproduces the measured size spectrum across seasons and iii characterizes the spatio temporal distribution of pteropod life stages in the calcs 2 model description the description of the model follows the odd overview design concepts details protocol for ibms grimm et al 2006 2010 2020 the ibm is implemented in python 3 7 and is available in the electronic supplementary material 2 1 purpose and patterns the primary purpose of this model is to predict the number size spectrum and population dynamics of shelled pteropods and their spatio temporal distribution in the calcs to this end we parameterized this model using mainly properties of the temperate species l helicina in cases where parameterizations for l helicina are limited we use properties of other members of the limacinidae family such as those characterizing l retroversa hereinafter we refer to the modeled pteropods based on l helicina and others as shelled pteropods ultimately the purpose of this model which will be presented in follow up work is to explore the relationship between pteropod populations and environmental stressors such as acidification across a range of different time scales to simulate population dynamics we use a life cycle with two generations per year for simulated pteropods wang et al 2017 and developmental timings of life stages key traits and behaviors e g protoconch parapodia onset of diel vertical migration and maturity howes et al 2014 thabet et al 2015 as a function of shell size in our implementation environmental stressors reduce shell size growth which allows our model to simulate the impacts of stressors on the life history behavior population demographics and spatio temporal distribution of individual pteropods 2 2 entities attributes and scales our model includes one entity the shelled pteropods to improve the model speed and memory use the shelled pteropod are treated as a collection of individuals with a constant number of members i e as super individual scheffer et al 1995 these pteropods are characterized by 15 attributes divided into nine state variables and six environmental life history characteristics table 1 the state variables are id the parent id parent size generation age size egg release readiness err index spawning events and accumulated damage d a m a c c the environmental life history characteristics are water temperature experienced t aragonite undersaturation experienced ω a r a g the chlorophyll a concentration chl oxygen concentration o 2 date and location the id and parent id are unique identifiers for each pteropod and the pteropod that spawned them the parent size represents the shell length mm of the parent pteropod during spawning the generation is an integer used to differentiate between pteropods of the spring even integer and overwintering odd integer generation as described for temperate regions dadon and de cidre 1992 lalli and gilmer 1989 wang et al 2017 maas et al 2020 the age measures the life time of pteropods in days since spawning the size represents the current shell size of the pteropods the err index similar to the clutch readiness fraction presented in miller et al 1998 represents whether or not a mature pteropod is ready to spawn eggs the spawning events represent the number of times a pteropod has produced and released eggs the t and ω a r a g quantify the average water temperature in c and aragonite undersaturation experienced by a pteropod in one day respectively the chl mg m 3 quantifies the cumulative sum of chlorophyll a concentrations experienced by a pteropod wormuth 1981 hunt et al 2008 the o 2 mmol m 3 quantifies the oxygen concentration experienced by a pteropod throughout the day the d a m a c c quantifies the amount of caco 3 mg lost due to dissolution or lack of accretion throughout the life time of each pteropod after growth and repair of previously accumulated damage the date and location depict the day in a year after the 1st of january and the depth m latitude n and longitude e of a pteropod the date and location attributes enable us to analyze the ibm using a circulation model output however the ibm on its own does not have a spatial scale the ibm s total simulation time is not constrained and is run at a one day time step 2 3 process overview and scheduling in this section we provide an overview of the processes that occur in our ibm the order in which they are executed and how the attributes are changed out of the 15 attributes the age size err index spawning events t ω a r a g c h l o 2 d a m a c c date and location are changed on each one day time step by the following five processes fig 1 1 movement and environment tracker 2 mortality 3 shell growth 4 development 5 spawning eggs 1 movement and environment tracker this function computes the vertical and horizontal movement of pteropods and tracks the environmental conditions i e the t c h l o 2 and ω a r a g that pteropods experience on an one hour time step at each location this higher temporal resolution was chosen since vertical migration can result in exposure to corrosive and non corrosive waters within a single day bednaršek and ohman 2015 in order to fit the simulation time step of one day we calculate the average t ω a r a g and the cumulative sum of c h l experienced by each pteropods in a 24 h window the movement and environment tracker was calculated using the lagrangian ocean analysis tool parcels probably a really computationally efficient lagrangian simulator v2 1 3 delandmeter and van sebille 2019 this lagrangian tool uses custom parcels objects for the execution and thus we have to translate the information for each pteropod stored as a numpy array oliphant 2006 into the custom parcels object back and forth before and after the execution of the movement and environment tracker function 2 mortality this function computes whether a pteropod dies or continues to live based on daily life stage dependent mortality rates the age of the pteropods generation dissolution and number of spawning events 3 shell growth this function calculates the net shell growth i e growth including dissolution lack of accretion and repair given the pteropod size and the t ω a r a g and chl experienced by the pteropod in the movement and environment tracker 4 development this function determines the life stage that each pteropod has reached based on their size different life stages are linked to the development of key traits organs e g protoconch parapodia juvenile adult shell maturity these key traits organs are used in other functions e g the development of the protoconch and parapodia to mark the onset of shell dissolution and dvm respectively 5 spawning this function determines whether a pteropod has reached maturity and is ready to spawn eggs 2 4 design concepts basic principles in this paper we implement a shelled pteropod ibm to characterize the life stage composition of pteropod populations in the calcs in accordance with previous findings our model uses size as a key trait to determine the developmental timings of pteropods kiørboe and hirst 2014 andersen et al 2016 in addition we link the growth and behavior of individuals to environmental conditions such as temperature ω a r a g food availability and oxygen concentration based on observations of l helicina and l retroversa and modeling efforts e g wang et al 2017 bednaršek et al 2012b 2014 thabet et al 2015 buitenhuis et al 2019 emergence pteropod population size structure and developmental timings over several generations emerge from the temperature food availability size dependent sensitivity to acidification repair rates and the occurrence of undersaturated conditions in relation to their life cycle as susceptible life stages may co occur with more corrosive conditions continuous exposure to corrosive conditions may result in developmental delays that ultimately shift the peak of pteropod abundances and population demographics in future generations adaptation pteropods that have developed parapodia adapt their maximum dvm depth during their descent pteropods descend in the water column until they reach a maximum depth which depends on their current size and the maximum depth at the current location however if the pteropods reach the upper boundary of the aphotic zone they stop their descent prior to reaching their maximum dvm depth in addition individuals actively avoid hypoxic layers 60 μ mol l 1 keeling et al 2010 ekau et al 2010 by swimming towards the surface these behaviors are modeled as indirect objective seeking i e individuals follow rules that have been observed in nature grimm et al 2010 2020 sensing pteropods in our model are assumed to sense their current depth the light availability oxygen and the time at which the sun sets and rises at their current location and time the modeled pteropods descend to their maximum depth and upon reaching this depth the descent stops stochasticity processes such as the onset of dvm and mortality or egg release time after reaching maturity are not explicitly implemented in our model however we use a stochastic parameterization to mimic the observed natural variability grimm et al 2010 2020 or to smooth the transition of one life stage to the next miller et al 1998 with regard to the onset of dvm the mechanism by which pteropods sense the sunrise and sunset times at each location is not modeled instead the onset of the migration towards the surface and towards the deeper layers are determined by the timing of the sunset and sunrise at the current location and date of the pteropods bianchi and mislan 2015 pteropod mortality in our model is represented using stochastic process formulations first we determine the survival probability of each pteropod based on their life stage second we draw a pseudo random number from a continuous uniform distribution over the interval 0 1 where individual pteropods die if their survival probability is lower than the pseudo random number finally the time needed to release eggs after reaching maturity is determined by the err index section 2 2 during initialization the err index is drawn from a pseudo random number from a continuous uniform distribution over the interval 1 1 observations data that can be collected from our ibm for testing and analysis include the abundances of pteropods population life stage composition size structure and all 15 attributes throughout the simulation over time and space in addition individual level observations such as the shell size as a function of the experienced ω a r a g temperature food availability age and generation can be collected from our ibm 2 5 initialization the aim of the initialization is two fold first it eliminates effects of initial conditions by spinning up the model to a steady state such that initial conditions have a minimal effect on the model s outcome grimm et al 2020 second the model at steady state defines a starting pteropod population life stage composition for future simulation experiments section 2 10 during the initialization pteropod experienced idealized environmental conditions and growth is not impaired by acidification the idealized environmental conditions were taken from daily sea surface chlorophyll a concentration and temperature climatologies between 30 n 60 n and 115 w 135 w for chlorophyll a we used the level 4 chlorophyll a product from the eu copernicus marine environment monitoring service cmems 2021 for temperature we used the sea surface temperature from the world ocean atlas 2013 locarnini et al 2013 we ran the initialization for 5 000 time steps i e around 13 simulation years starting with a population of 1 500 eggs of the spring generation and the processes listed in section 2 3 except for the movement and environment tracker function by excluding the latter process the exposure to acidification is turned off i e pteropod growth is not impaired by environmental stressors the attributes of the initial 1 500 eggs are as follows the ids are set to a number between zero and 1 499 parent ids and parent size to 1 generation age and spawning events to zero err to a random number in the interval 1 1 size to 0 15 mm wang et al 2017 and the d a m a c c to 0 0 mg caco 3 the remaining attributes t ω a r a g c h l o 2 date and location are not initialized at this point since these attributes are only changed during the execution of the movement and environment tracker function the outcome of the initialization is used to find a starting pteropod population composition on the 1st of january for simulations under time varying environmental conditions to find the initial population composition on the 1st of january we first compute the average daily modeled abundances from the last third of the simulation with 5 000 time steps where the 1st of january is represented by the first time step in the last third of the simulation second we calculate the similarity between the modeled abundances and the observed pteropod abundances between 30 and 60 latitude in the northern hemisphere reported in the marine ecosystem biomass data maredat initiative henceforth referred to as the maredat abundances bednaršek et al 2012a the eggs modeled were not included to calculate the daily mean pteropod abundances because the maredat abundances do not contain egg counts the similarity was measured based on the pearson r and spearman ρ correlation coefficient the manhattan distance l 1 and the proportion of modeled abundances f o u t outside of the abundance range mean std dev reported in maredat third we shift the position of the 1st of january by one time step forward and compare the resulting average modeled abundances to the maredat abundances this third step is repeated until all time steps in the last third of the simulation are used as the 1st of january last the modeled population on the time step defined as the 1st of january that resulted in the largest similarity to the maredat abundances is chosen as the initial population for simulations under time varying environmental conditions in the following section we present the structure and source of the physical biogeochemical forcing used to represent the time varying environmental conditions 2 6 input data in order to simulate changes in pteropod populations driven by environmental conditions the pteropod ibm requires input from external sources to represent changes in environmental conditions over time and space the input data for the physical biogeochemical forcing of the ibm need to be given for each grid cells with the attributes time in days since the start of the simulation location given as depth m latitude n and longitude e maximum depth m land water index horizontal and vertical current velocities u v and w in m s temperature c ω a r a g chlorophyll a concentration mg m 3 s and oxygen concentration mmol m 3 table 2 in this project we used the basin wide hindcast simulation of desmet et al in review for the period between 01 01 1984 and 31 12 2019 to simulate the time varying environmental conditions experienced by pteropods this simulation has a daily average output of temperature ω a r a g chlorophyll a concentration oxygen concentration and horizontal and vertical current velocities modeled using the ucla eth version of the regional oceanic modeling system roms marchesiello et al 2002 shchepetkin and mcwilliams 2005 frischknecht et al 2018 coupled with the biological elemental cycling model bec moore et al 2013 frischknecht et al 2017 the chlorophyll a concentration was adjusted to the maximum and minimum chlorophyll a concentrations found between 30 n 60 n and 115 w 125 w in the level 4 chlorophyll a product from the eu copernicus marine environment monitoring service cmems 2021 the coupled model uses a horizontal curvilinear grid with its center at the us west coast marchesiello et al 2002 frischknecht et al 2018 and has 64 terrain following vertical coordinates desmet et al in review this setup covers the pacific ocean basin with a horizontal grid spacing of 60 km that decreases to roughly 4 km towards central california frischknecht et al 2018 the high resolution at the coast of california in the telescopic setup properly simulates upwelling conditions along the coastal region and captures local frischknecht et al 2018 as well as basin wide processes frischknecht et al 2015 2017 the bec model simulates the cycling of nutrients e g carbon phosphorus nitrogen silicon iron which govern the growth of a lower trophic level marine ecosystem represented by three phytoplankton functional types small phytoplankton diatoms and diazotrophs and one zooplankton type moore et al 2013 frischknecht et al 2017 the ω a r a g is calculated offline using the mocsy 2 0 routine dickson et al 2007 orr and epitalon 2015 in the following section we present in detail how the pteropods interact with the environment and how they develop 2 7 submodels all model parameters and processes implemented in the ibm are summarized in the following sections in our ibm all five submodels section 2 3 use size as an input because it determines the developmental stage of the pteropods their behavior and interaction with the environment thus we first describe the shell growth function and build upon the assumption and parameterizations used in this function to describe the development spawning mortality and movement and environment tracker functions a summary of the functions and parameters are shown in table a 4 and table a 5 2 7 1 shell growth measurements of the growth rate of shelled pteropods as a function of temperature and food availability are unlike for other calcifying zooplankton e g foraminifera lombard et al 2009 2011 rare or are mostly constrained to the caribbean or the polar regions see compilation in bednaršek et al 2016 in addition the growth in pteropods varies between families bandel and hemleben 1995 lalli and gilmer 1989 for instance members of the cavoliniidae family reach the final shell size and shape early in their life cycle and their shells thicken inwards for the remainder of their life cycle bé et al 1972 lalli and gilmer 1989 in comparison the size of members of the limacinidae family correlates with the developmental stage and maturity hsiao 1939 lalli and wells 1978 to deal with these limitations current models represent pteropods using the growth rates of better constrained and similarly sized zooplankton species e g copepods buitenhuis et al 2019 however a recent multi year length frequency analysis of pteropod populations parameterized the size of l helicina as a function of time in the temperate north pacific wang et al 2017 this parameterization provides a realistic progression of shell size throughout the life of members of the limacinidae family in this temperate region thus for our ibm we define the size specific growth rate as the derivative of the equation for shell size with respect to time and include key environmental drivers of growth i e a temperature sensitivity based on the temperature coefficient q 10 buitenhuis et al 2019 a food limitation term using the monod equation monod 1978 lombard et al 2011 and a function for accretion and dissolution bednaršek et al 2014 the implementation of these processes is described in fig 2 each one day time step this function calculates the shell growth in four steps for each pteropod first we calculate the shell mass m s h e l l in mg caco 3 second we calculate the shell accretion and dissolution as a function of m s h e l l and the ω a r a g that pteropods experienced third we calculate the potential amount of caco 3 in mg that pteropods can produce as a function of their current size experienced temperature and food availability finally we calculate the growth or shell repair based on the potential amount of caco 3 that can be produced and the amount lost due to lack of accretion or dissolution step 1 shell mass we estimate the shell mass m s h e l l in mg caco 3 as a function of the size l as presented in bednaršek et al 2012b 2014 the relationship between m s h e l l and l is calculated using an empirical shell length weight relationship derived from fitting an exponential function to shell length and dry weight d w measurements of l helicina bednaršek et al 2012b 1 d w l 0 137 mg dry weight l 1 mm 1 5005 where d w is given in mg and l is given in mm and non dimensionalised next we calculate m s h e l l from d w d w is transformed to total carbon content t c in mg using the average conversion factor 0 25 mg tc mg dry weight of dry weight to total carbon of pteropods davis and wiebe 1985 the total inorganic carbon t i c is calculated from t c based on the finding that 27 appendix a 13 of the t c correspond to the t i c bednaršek et al 2012b m s h e l l is calculated from t i c using the molecular mass ratio of c to caco 3 8 33 mg caco 3 mol 1 mg tic mol 1 this results in the following relationship between m s h e l l and l 2 m s h e l l l d w l 0 25 mg tc mg dry weight 0 27 mg tic mg tc 8 33 mg caco 3 mol 1 mg tic mol 1 step 2 accretion and dissolution the damage to the shell as a function of the ω a r a g l in mg caco 3 d 1 is calculated based on the empirical fit of a two parameter exponential function to measurements of the percentage pteropod shell loss per day ν in shell loss d 1 as a function of ω a r a g in incubation experiments of l helicina bednaršek et al 2014 3 ν ω a r a g 65 76 d 1 e x p 4 7606 ω a r a g the exponential function ν is able to capture shell mass loss at supersaturated conditions ω a r a g 1 and accurately describes the observed two to three fold increase in shell mass loss between ω a r a g 1 and ω a r a g 0 8 bednaršek et al 2014 at higher supersaturation the shell mass loss approaches zero e g 0 052 at ω a r a g 1 5 fig a 8 the l is then calculated by multiplying m s h e l l by ν 4 l l ω a r a g m s h e l l l ν ω a r a g step 3 potential growth the growth rate g is calculated as the potential amount of caco 3 that a pteropod can produce in the absence of corrosive conditions in mg caco 3 d 1 this potential growth without dissolution is based on the growth rate μ l t f of the pteropod which includes the influence of size l temperature t and food availability f on calcification waldbusser et al 2010 gazeau et al 2013 explicitly we subtract the shell mass calculated in step 1 eq 2 from the shell mass that pteropods would have after growth given their size the temperature they experience and food availability 5 g l t f m s h e l l μ l t f l m s h e l l l μ is a function of the current size l the temperature that pteropods experience t c and food availability f mg chl m 3 μ l t f consists of three terms the reference growth rate μ 0 the temperature sensitivity of growth buitenhuis et al 2019 and the food limitation of growth monod 1978 lombard et al 2011 6 μ l t f μ 0 l q 10 t t 0 10 c f f k s 7 μ 0 l l t 1 l t 1 d 1 l t where q 10 1 3 is the unitless temperature coefficient buitenhuis et al 2019 t 0 14 5 c the reference temperature for growth wang et al 2017 and k s the chlorophyll a half saturation constant mg chl m 3 the value for k s 0 418 mg chl m 3 was determined based on our model tuning which is explained in detailed in section 2 8 the μ 0 i e the size increase per day relative to the current size at t 0 is calculated using the three year cohort length frequency analysis of l helicina in the temperate north pacific fig 3 wang et al 2017 the length frequency analysis uses a variation of the von bertalanffy growth function von bertalanffy 1938 which considers seasonal changes in pteropod growth rates within one year wang et al 2017 and is formulated as follows somers 1988 garcía berthou et al 2012 pauly 2013 8 l t l 1 e x p k t t 0 s t s t 0 9 s t c k ω s i n ω t t s where l t is the size in mm at age t s t parameterizes the seasonal changes in pteropod growth ω in yr 1 is the recurrence rate of seasonal changes in pteropod growth t s in yr marks the time sinusoidal growth oscillations begin with respect to a reference age t 0 l in mm denotes the maximum size of the pteropods k in yr 1 is the rate at which l is approached t is the age given as fraction of a year the reference age t 0 y r is the age at which the pteropods have l 0 0 mm c is a unitless factor between zero and one that expresses the amplitude of growth oscillations for this study we use the values t s 0 4 yr ω 2 π yr 1 and c 0 4 wang et al 2017 the values for k 5 07 yr 1 and l 4 53 mm are averaged from values reported in wang et al 2017 for the spring generation the maximum life span of a generation is 300 days wang et al 2017 manno et al 2017 as the size of pteropods is initialized as 0 15 mm section 2 5 wang et al 2017 the values of l t are shifted upwards to match a starting position of 0 15 mm i e l 0 0 15 mm step 4 net growth we calculate the net amount of caco 3 n e t caco 3 that remains after potential lack of accretion dissolution and calcification 10 n e t caco 3 g l we then use n e t caco 3 to calculate the effective change in shell mass δ m s h e l l and d a m a c c 11 δ m s h e l l n e t caco 3 d a m a c c if n e t caco 3 d a m a c c 0 otherwise 12 d a m a c c m a x 0 d a m a c c n e t caco 3 where an increase in shell mass only occurs if n e t caco 3 is larger than the current d a m a c c to find the size change we add δ m s h e l l to the m s h e l l l calculated in step 1 eq 2 and extract the corresponding l during step 4 the process by which pteropods cope with corrosive conditions depends on the potential growth g the loss term l and the balance between the two n e t caco 3 g l accretion is reduced when the loss term is non zero l l ω a r a g 0 and n e t caco 3 0 because the calcification rate of the pteropods is reduced by l l ω a r a g in cases where the loss term is larger than the growth term n e t caco 3 0 accretion drops to zero pteropods accumulate damage and do not grow 2 7 2 development recent culturing experiments with the temperate l retroversa have provided a detailed description of the life stage progression and development of limacina species howes et al 2014 thabet et al 2015 the life cycle of l retroversa includes the following stages and developmental timings after spawning the 2 4 h 4 6 h 8 9 h 16 cell 11 h blastula 16 h gastrula 24 72 h hatching 3 days trochophore 3 6 days veliger 6 7 days non reproductive juveniles 1 month and reproductive adult 3 months thabet et al 2015 these life stages are linked to the development of key organs including the larval shell protoconch and wings parapodia after six days and three weeks from hatching respectively thabet et al 2015 this detailed life cycle description with the developmental timings of key organs is crucial for the interpretation of the response of pteropods to ocean acidification because the development of the protoconch marks the onset of early shell dissolution thabet et al 2015 johnson et al 2016 which likely diminishes the ability for pteropods to deal with upcoming shell dissolution bednaršek et al 2017a in addition the development of parapodia marks the onset of dvm lalli and gilmer 1989 mackas et al 2005 hunt et al 2008 which might expose pteropods to corrosive waters at deeper layers and non corrosive ones near the surface bednaršek and ohman 2015 the life stages that we diagnose in our ibm are based on the ten stage life cycle model of l retroversa howes et al 2014 thabet et al 2015 however we simplify the ten stage life cycle into four life stage tracers fig 3 the eggs containing the 2 4 8 16 cell blastula gastrula and trochophore stages larvae containing the veliger stage juveniles containing the non reproductive juveniles and reproductive adults these four life stages were chosen based on the development of key organs the transition from egg to larvae is based on the formation of the protoconch after six days of development thabet et al 2015 during the larvae stage pteropods develop parapodia after 21 days of development thabet et al 2015 the transition from larvae to juvenile is based on the formation of the juvenile shell after 30 days of development thabet et al 2015 and the transition from juvenile to adult is based on the development of female gonads and mature ova after 90 days of development thabet et al 2015 this definition facilitates the analysis of the model output by binning individuals that share physiological and behavioral characteristics i e protoconch parapodia juvenile adult shell maturity into categories in order to implement the four life stages in our ibm we first defined size thresholds for the development of the key organs protoconch parapodia juvenile shell female gonads using the pteropod size parameterization l t eq 8 fig 3 the protoconch develops at a size of l t 6 days 0 50 mm the parapodia at l t 21 days 1 31 mm the juvenile shell at l t 30 days 1 74 mm and the female gonads and mature ova at l t 90 days 3 65 mm on each time step this function determines the life stage that a pteropod has reached depending on their size and increases the age of the pteropods by one day 2 7 3 spawning pteropods are protandrous hermaphrodites transitioning and functioning first as males and then as females hsiao 1939 newman and corey 1984 lalli and gilmer 1989 female tissue and low level spawning has been observed year round in populations of limacina species e g hsiao 1939 wang et al 2017 maas et al 2020 however major synchronizes spawning events followed by die off events of larger individuals take place in spring and autumn lalli and gilmer 1989 dadon and de cidre 1992 thabet et al 2015 wang et al 2017 maas et al 2020 the magnitude and timing of these synchronized widespread spawning events likely determine the abundance and population structure in subsequent generations seibel and dierssen 2003 gannefors et al 2005 maas et al 2011 the eggs are released as buoyant free floating masses at the water surface lalli and wells 1978 paranjape 1968 schalk 1990 gannefors et al 2005 comeau et al 2010a manno et al 2016 the number of eggs released per reproductive pteropod adult has a high variability which is likely linked to the environmental conditions that pteropods experience e g temperature food availability aragonite undersaturation paranjape 1968 manno et al 2016 for instance adult l helicina release on average 5 936 eggs observations range between 524 eggs and 1 0 051 eggs in the arctic lalli and wells 1978 and 565 eggs observations range between 465 eggs and 708 eggs in temperate regions paranjape 1968 across species and at the same region the number of eggs released per adult can vary where the number of eggs released by adult l retroversa range between 83 eggs and 650 eggs in the arctic lalli and wells 1978 in our model we simulate the synchronized widespread spawning events in spring and autumn lalli and gilmer 1989 thabet et al 2015 wang et al 2017 the die off of the largest individuals dadon and de cidre 1992 wang et al 2017 maas et al 2020 and neglect continuous low level spawning throughout the year see appendix a 10 lalli and gilmer 1989 thabet et al 2015 wang et al 2017 to this end we simplify the reproduction of pteropods by emphasizing the timing of maximum egg production i e the two major spawning and die off events in spring and autumn thus modeled adult pteropods only release eggs once and die afterwards we use a conservative estimate of 500 eggs per spawning event and per adult since it is within the ranges reported for l retroversa and l helicina in the arctic and temperate regions paranjape 1968 lalli and wells 1978 these eggs are released at the surface as free floating masses and the spawning time is spread in a time window of at most 20 days after maturation using the err index section 2 2 the latter indicates whether a modeled adult is ready to release eggs e r r 1 and is used to smooth the shift from one life stage to the next similar to the clutch readiness fraction presented in miller et al 1998 each one day time step we first increase the err index of all adults by 1 10 such that pteropods with an initial err index of 1 section 2 5 begin spawning 20 days after reaching maturation at the latest paranjape 1968 second we select all adults with e r r 1 third each selected adults spawn 500 eggs the attributes of the eggs are initialized as follows the unique ids are determined based on the largest id of the population prior to spawning parent ids and parent size are the ids of the parents and their current shell size generation is set to the generation of the parent plus one age and spawning events are set to zero err to a random number in the interval 1 0 size to 0 15 mm wang et al 2017 and the d a m a c c to 0 0 mg caco 3 the attributes date and location are initialized to the current date and the surface at the current latitude and longitude of the parent the remaining attributes t ω a r a g c h l o 2 are initialized as missing values as they are initialized during the execution of the movement and environment tracker function during the following time step finally the attribute spawning events of each parent pteropod is set to one 2 7 4 mortality information on the life span of temperate shelled pteropods is scarce manno et al 2017 under laboratory conditions l retroversa was recently shown to have a lifetime of six months howes et al 2014 thabet et al 2015 in the field individuals may persist longer than one year in a population wang et al 2017 however in this study we focus on the average pattern of the multi year cohort analysis of wang et al 2017 which indicates an average lifetime of six months for a spring generation and an average lifetime of eleven months for an overwintering generation of l helicina in the north pacific appendix a 12 both generations are separated by die off events of larger pteropods shortly after the two major spawning events in spring and fall dadon and de cidre 1992 wang et al 2017 maas et al 2020 for mesozooplankton daily mortality rates have been linked to the size of the organism zhang and dam 1997 however such a relationship does not account for differences between the spring and overwintering generation and is not suited for all life stages or sizes see appendix a 11 zhang and dam 1997 hence we estimate life stage and generation specific mortality rates using available observations and a tuning procedure in terms of daily mortality information on daily mortality rates β bednaršek et al 2016 or mortality coefficients m lischka et al 2011 for different pteropod life stages is scarce and reported values show large variability for instance juvenile l helicina collected in kongsfjord had a mean mortality coefficient of 12 6 lischka et al 2011 whereas the mortality coefficient for juvenile l helicina in the scotia sea is around 1 0 bednaršek et al 2012b 2016 however the limited observations of pteropod mortality document the effect of the exposure to corrosive water to pteropod mortality for different undersaturation states and temperatures lischka et al 2011 and thus a potential parameterization for the increase in daily mortality as a function of the aragonite undersaturation state experienced by pteropods in our model the pteropods die after reaching a maximum age after releasing eggs due to exposure to corrosive waters and due to other causes we chose a maximum age of ten months as averaged in the multi year cohort analysis of wang et al 2017 we used the data reported in lischka et al 2011 to calculate the increase in mortality due to the exposure to corrosive waters due to the very limited information on β we tested 56 2 500 combinations of life stage and generation specific values for β we chose the best combination of life stage and generation specific β that led to the best match up between simulated pteropod abundance and observed pteropod abundance between 30 and 60 latitude in the northern hemisphere the detailed tuning procedure is presented in section 2 8 each one day time step we first calculate m for each life stage and generation based on the calibrated values for β this means that we first calculate the proportion of individuals of each life stage that would die bednaršek et al 2016 13 m 1 e β 1 d second for each modeled pteropod we draw a pseudo random number from a discrete uniform distribution in the interval 0 1 and compare this number with the life stage and generation specific m if the pseudo random number is smaller than m then the modeled individual dies third we calculate the increase of m δ m as a function of the ω a r a g experienced by each modeled pteropod appendix a 2 fig a 9 based on the observations of lischka et al 2011 δ m is given by the difference between the undersaturation experienced by the modeled pteropod ω a r a g and the reference saturation state where dissolution is negligible ω a r a g 1 5 section 2 7 1 step 2 14 δ m 0 06 ω a r a g 1 5 if ω a r a g 1 5 0 otherwise fourth we add δ m to m and compare the pseudo random number drawn at the beginning with the corrected mortality coefficient if the pseudo random number is smaller than m δ m then the modeled individual dies finally we select the individuals with an age of ten months or those that have released eggs and remove them from the population 2 7 5 movement and environment tracker shelled pteropods are able to remain neutrally buoyant for extended periods of time e g during feeding lalli and gilmer 1989 and thus drift horizontally with the ocean currents however pteropods develop parapodia during their larvae stage thabet et al 2015 which allow them to escape predation gilmer 1972 gilmer and harbison 1986 the vertical distribution of shelled pteropods is species dependent where some shelled pteropod species have a weak or no vertical migration e g l trochiformis l retroversa creseis acicula myers 1968 wormuth 1981 hunt et al 2008 and others such as l helicina l inflata l lesueri myers 1968 wormuth 1981 ascend towards the surface at sunset to feed and descend to deeper waters to avoid predation at sunrise wormuth 1981 lalli and gilmer 1989 mackas et al 2005 hunt et al 2008 maas et al 2012 bianchi and mislan 2015 most shelled pteropods approximately remain in the upper 200 m of the water column lalli and gilmer 1989 but individuals of some species have been observed to migrate to deeper depths e g diacria trispinosa wormuth 1981 karakas et al 2020 the swimming speeds of pteropods is species dependent upward swimming speeds range between 12 mm s 1 heliconoides inflatus and 114 mm s 1 d trispinosa karakas et al 2020 sinking speeds range between 13 mm s 1 h inflatus and 105 mm s 1 d trispinosa karakas et al 2020 these relatively high swimming and sinking speeds imply that pteropods are able to swim several hundreds of meters in a short time span one to two hours lalli and gilmer 1989 and thus pteropods can experience a wide range of environmental conditions in a single day for instance they can be exposed to corrosive conditions at deeper depths and non corrosive conditions near the surface within a single day due to their vertical migration bednaršek and ohman 2015 these differences between day time and night time environmental conditions might increase with age where for some species e g l helicina older and larger individuals have been observed to swim to deeper layers in comparison to younger and smaller individuals bednaršek and ohman 2015 in our model this function serves three purposes first we simulate the drift of the pteropods along the ocean currents based on the horizontal and vertical current velocities calculated in the roms hindcast section 2 6 to this end we use the lagrangian ocean analysis tool parcels v2 1 3 delandmeter and van sebille 2019 second on top of the drift we simulate the vertical distribution of migratory pteropods using size dependent swimming and sinking speeds chang and yen 2012 and a size dependent dvm depth bednaršek and ohman 2015 the onset of the upward migration towards the surface and downward migration towards the deeper layers are determined by the timing of the sunset and sunrise at the location and date of the pteropod bianchi and mislan 2015 respectively third we calculate the average t ω a r a g and o 2 and the cumulative sum of c h l that the pteropods experience throughout their movement in a day to this end the movement and environment tracker function interpolates the physical biogeochemical forcing from two daily average outputs section 2 5 to then calculate the position of each pteropod and sample the environmental conditions that the pteropods experience throughout the day with a sub timestep of one hour current driven drift the current driven drift of modeled pteropods is calculated using the horizontal and vertical current velocities of the roms hindcast simulation section 2 6 using parcels built in fourth order runge kutta integration scheme including the vertical velocity delandmeter and van sebille 2019 this advection scheme may result in beaching of particles delandmeter and van sebille 2019 thus as recommended in delandmeter and van sebille 2019 we implemented an artificial current that pushes pteropods back to the ocean if they drift onto the shore below the sea floor or above the surface dvm the depth of the modeled pteropods is only changed through dvm if they have developed parapodia i e if modeled pteropods have a size of 1 31 mm fig 3 the vertical movement of modeled pteropods is constrained to the upper 250 m of the water column since l helicina and other shelled pteropods in the calcs have mainly been observed to stay above this depth bednaršek and ohman 2015 the depth to which modeled pteropods sink d d v m l is calculated as the product of the maximum depth of 250 m and the ratio of the current pteropod size l to the maximum pteropod size l 4 53 mm section 2 7 1 step 3 15 d d v m l 250 m l l in cases where the water column is shallower than d d v m l modeled pteropods sink to the bottom of the water column after calculating d d v m l we determine the swimming and sinking velocities of the modeled pteropods based on their current size v l adult l helicina can reach upward swimming speeds of 44 mm s 1 sinking speeds of 45 mm s 1 chang and yen 2012 thus we define the maximum swimming and sinking speed as 44 mm s 1 chang and yen 2012 and scale it by the ratio of l to l 16 v l 44 mm s l l our formulation is consistent with the description of chang and yen 2012 where the smallest modeled individuals l 1 30 mm reach a swimming velocity of 12 6 mm s 1 and the largest ones l 4 53 mm a velocity of 44 mm s 1 finally to calculate the dvm we simulate the amount of time that modeled pteropods spend at the surface migrating between the surface and deeper waters and at their dvm depth to this end we use the finding that zooplankton in general start swimming downwards around sunrise and arrive at the surface from their maximum dvm depth around sunset bianchi and mislan 2015 the sunrise and sunset timings were calculated based on the date and the position of each modeled pteropod nautical almanac office 1990 specifically the onset of the downward migration t d o w n corresponds to the sunrise time of the following day t s u n r i s e t s u n r i s e is determined for the following day since the movement of pteropods is calculated for 24 h starting at noon section 2 6 for the onset of the upward migration t u p we first determine the sunset time of the current day t s u n s e t to obtain the time at which pteropods arrive at the surface next we calculate the time at which the pteropods start their upward migration as the time each pteropod would need to reach the surface from their maximum dvm depth given their size and their upward swimming speed v 17 t d o w n t s u n r i s e 18 t u p t s u n s e t d d v m v l after reaching the surface modeled pteropods maintain their depth until t d o w n similarly modeled pteropods that reach d d v m maintain their depth sampling of environmental conditions the environmental conditions are provided by the roms hindcast simulation section 2 6 on each one hour time step of the movement and environment tracker function section 2 7 5 modeled pteropods sample their environment temperature chlorophyll a concentration oxygen concentration and aragonite saturation state at their location after 24 one hour time steps we calculate the average temperature aragonite saturation state chlorophyll a concentration and oxygen concentration that the pteropods experienced and update the attributes t ω a r a g c h l and o 2 with these values section 2 3 2 8 model tuning information of the values of the half saturation constant for the food limitation k s section 2 7 1 and the life stage and generation specific mortality rates β section 2 7 4 are limited or unknown to find possible values for k s and β we performed a two fold tuning exercise under idealized conditions section 2 5 first we estimate the value of k s to simulate the two generation per year cycle reported for temperate pteropods lalli and gilmer 1989 dadon and de cidre 1992 wang et al 2017 maas et al 2020 i e the time span between a pteropod that hatches in spring 30th april and the day that the next generation releases eggs is around 365 days second we ran our model for 5 000 time steps with 56 2 500 different combinations of life stage and generation specific mortality rates β section 2 7 4 for each model run we calculated the similarity between the daily average abundances and the maredat abundances see section 2 5 the similarity was measured based on the pearson r and spearman ρ correlation coefficient the manhattan distance l 1 and the proportion of modeled abundances f o u t outside of the abundance range mean std dev reported in maredat with regard to k s we tested values for k s ranging between 0 01 mg chl m 3 and 1 00 mg chl m 3 the duration of the two generation cycle increases linearly with increasing k s fig a 10 where k s 0 418 mg chl m 3 results in a two generation cycle of 365 days fig 3 under idealized conditions we did not observe a phase of slow growth during winter overwintering in the calcs however food scarcity 0 1 mg m 3 or lower temperatures 7 5 c during winter can lead to phases of slow growth followed by rapid growth in spring fig a 11 similar to the findings reported in wang et al 2017 between and within pteropod life stages the β can vary by more than a factor of ten e g between eggs and all other life stages lischka et al 2011 bednaršek et al 2016 thus for the life stage and generation specific β we tested the values 10 20 25 35 45 50 1 0 2 d 1 for the eggs and 1 2 5 5 7 5 10 1 0 2 d 1 for all other life stages the combinations that resulted in stable population dynamics with at least 50 and at most 35 000 individuals excluding eggs were evaluated based on the similarity between the daily mean pteropod abundances across the last third of the simulation and the daily pteropod abundances interpolated from the monthly abundance climatology observed in the maredat abundances bednaršek et al 2012a the eggs modeled were not included to calculate the daily mean pteropod abundances since the maredat abundances does not contain egg counts the similarity was measured based on the pearson r and spearman ρ correlation coefficient the manhattan distance l 1 and the proportion of modeled abundances f o u t outside of the abundance range mean std dev reported in maredat the values 10 7 5 1 7 5 1 0 2 d 1 for the eggs larvae juvenile and adults of the spring generation and 45 1 1 1 1 0 2 d 1 for eggs larvae juveniles and adults of the overwintering generation led to the most similar pteropod abundance pattern with r 0 99 ρ 0 91 l 1 15 50 and f o u t 0 29 fig 4 differences between the maredat abundances and the ibm simulation are found in the abundance magnitude in winter and the timing of abundance peaks in spring the simulated abundances are mostly within the range reported in the maredat abundances except in winter at the beginning of spring and early summer in addition the spring pteropod abundance peak occurs four days later in the ibm than in the maredat abundances 2 9 sensitivity experiments the daily mortality rates between and within pteropod life stages has been reported to vary by more than a factor of ten section 2 7 3 lischka et al 2011 bednaršek et al 2016 similarly the range of the number of eggs that an adult pteropod releases can vary between 83 and 1 0 051 depending on the species and region section 2 7 3 lalli and wells 1978 these parameters represent a major uncertainty with regard to the life cycle of pteropods thus we test the sensitivity of the ibm to the parameter choices associated with these two processes under idealized conditions section 2 5 to this end we increase and decrease the number of eggs released by adults the err and each life stage and generation specific mortality rate by 10 individually we ran our model for 5 000 time steps for each change of the parameters and calculate the similarity between the daily average modeled abundances and the maredat abundances see section 2 5 we evaluate the absolute abundance change in model data misfit based on the manhattan distance l 1 and the seasonal changes caused by the increase decrease in the chosen parameters using the pearson correlation r overall the l 1 between modeled pteropod abundances and the maredat abundances increases for all sensitivity experiments and r decreases by at most 0 12 table a 6 the largest difference in the modeled pteropod abundances is seen for the decrease by 10 of the number of eggs released per adult fig a 12i with an increase in l 1 of 27 1 the second largest change in modeled abundances is caused by an increase in the daily decrease in the mortality rate of the adults of the spring generation with l 1 25 3 and r 0 95 table a 6 this decrease in the parameter results in a longer spawning period and thus a shift in the period of higher pteropod abundances relative to the unchanged simulation fig a 12g for all other sensitivity runs the modeled abundance pattern resembles the unchanged simulation albeit with mostly lower magnitude in the modeled abundances during spring and early summer fig a 12 2 10 modeling goals in this study we aim to i reproduce the pteropod abundance signal measured in the temperate region ii reproduce the measured size spectrum across seasons and iii characterize the spatio temporal distribution of pteropod life stages in the calcs to this end we run the shelled pteropod ibm for each year in the roms hindcast simulation 19984 2019 starting on the 1st of january until the 31st of december first we define an initial pteropod population based on the ibm initialization section 2 5 which defines a starting pteropod population and life stage composition second we randomly seed the initial pteropod population in the calcs fig a 13 and initialize the depths and environmental conditions of the initial population using only the movement and environment tracker function for three days third we run the ibm for an entire year using all submodels section 2 7 thus we start each simulation year with the same initial population this approach was chosen because it emphasizes the role of drift and environmental conditions on the pteropod population e g dorman et al 2011 2015b a in order to compare the modeled pteropod abundances in the fully coupled model with the pteropod abundance signal measured in the temperate region we calculate a pteropod abundance climatology based on the median from all ibm one year runs for the entire hindcast period 01 01 1984 31 12 2019 we use this approach for the comparison since the maredat abundance data encompass observations from several years 1951 2010 bednaršek et al 2012a in addition the climatology contains potential inter annual variation in the modeled pteropod population which might be more comparable to the maredat abundance data next we define the number of individuals within each super individual section 2 2 by dividing the maximum number of pteropods reported in the maredat abundances across the region by the maximum number of modeled super individuals in the climatology to test our model performance we compare the pteropod population composition and the life stage progression from the climatology with the observed life stage duration and developmental timings under laboratory conditions howes et al 2014 thabet et al 2015 in addition we assess whether the modeled life stage progression and generation life span match field observations hsiao 1939 newman and corey 1984 dadon and de cidre 1992 lalli and gilmer 1989 thabet et al 2015 wang et al 2017 maas et al 2020 this study focuses on the two generation per year life cycle reported for l helicina and l retroversa in the temperate region and neglects low level spawning throughout the year section 2 7 3 thus the comparison between the modeled life stage presence and observations was adapted to only include observations of processes that are also implemented in our model to this end we use reports of major spawning events for the comparison with the modeled egg life stage the presence of immature individuals juveniles and larger non reproducing individuals for the comparison with the modeled juvenile life stage and the presence of individuals with mature ova and individuals producing eggs for the comparison with the modeled adult life stage we omit the comparison of modeled larvae with observations because the occurrence of larvae can only be inferred from the occurrence of eggs and juveniles in the available studies and their occurrence was not stated or shown explicitly in the studies listed above in a last step we characterize the spatio temporal distribution of pteropod life stages throughout a year based on their latitude and longitude to this end we determine the dominant life stage in terms of local abundances for each simulation day and 1 4 1 4 pixel in the modeled climatology this approach allows us to characterize the dispersal and horizontal distribution of pteropod life stages during different developmental stages in the modeled pteropod life cycle 3 results 3 1 population dynamics the modeled pteropod community structure is characterized by a succession pattern of three different generations which replace one another throughout the year fig 5 across the year the maximum median abundance of modeled super individuals was 1 3 665 5 excluding eggs section 2 8 which is roughly 18 times lower than the maximum number of pteropods reported in the maredat abundance across the region 24 9 960 thus each super individuals represents a collection of 18 individuals in general the duration of both generations is similar in magnitude table 3 the spring generation is present in the population between 231 days 5th percentile and 254 days 95th percentile in comparison individuals of the overwintering generation are present in the modeled population between 237 days and 271 days the main difference between the spring and overwintering generation relates to their relative abundance for instance the spring generation reaches a maximum median abundance of 1 3 619 5 super individuals fig 5a in comparison the larvae of the overwintering generation reach a maximum median abundance of 1 600 super individuals fig 5b table 3 outlines the succession pattern of the pteropod generations and life stages across all modeled years starting on the 1st of january the juveniles of the overwintering generation mature after 72 81 days and are ready to release eggs after 90 100 days 95th and 5th percentiles after spawning the individuals of the overwintering generation die 152 164 days after the 1st of january the eggs of the spring generation begin their transition to the larval juvenile and adult stages between 100 110 138 152 and 248 270 days after the 1st of january respectively upon reaching maturity adults of the spring generation begin to spawn the next overwintering generation at the earliest 257 days after the 1st of january and at the latest 279 days after the 1st of january the spring generation then disappears from the population 331 344 days after the 1st of january the eggs of the overwintering generation begin their transition to the larval and juvenile stages 263 287 days and 292 320 days after the 1st of january respectively overall the modeled life stage progression fits well with the reported pteropod life stage occurrence across multiple regions fig 6 the main difference between the modeled and observed life stage occurrence is seen for the modeled juveniles juveniles have been observed throughout the year mainly between 175 days and 264 days after the 1st of january for the spring generation newman and corey 1984 dadon and de cidre 1992 wang et al 2017 maas et al 2020 and between 265 days and 86 days after the 1st of january of the following year for the overwintering generation newman and corey 1984 dadon and de cidre 1992 wang et al 2017 maas et al 2020 in addition juveniles occur in the population for most of the year in both the observations and simulation however juveniles of the spring generation occur between 148 days and 327 days after the 1st of january the juveniles of the overwintering generation are present between 312 days and 136 days after the 1st of january of the following year red in fig 6 in addition the eggs of the overwintering generation and the adults of the spring generation are present 42 and 25 days longer in the model compared to observations respectively fig 6 3 2 spatio temporal distribution of shelled pteropods the analysis of the pteropod population dynamics neglects the spatial distribution of pteropods in the calcs and aggregates them to a single point in space thus we explore the spatio temporal distribution of the pteropod life stages of the spring and overwintering generations throughout a year fig 7 in terms of dispersal the pteropod population is advected southwestward from its initial location fig 7 the initial population was located between 33 n and 40 n median 36 75 n fig 7a and between 128 e and 121 e median 124 5 e fig 7b after one year the median latitude and longitude of the population decreased by 11 75 25 n fig 7a and 0 5 125 e fig 7b respectively in addition the range that the pteropods cover expands with time in both latitude and longitude by the end of the simulation year the pteropod population is located between 17 n and 44 n and between 143 e and 110 e overall the juveniles are the most dominant life stage for most of the year across all latitudes 62 5 and longitudes 63 6 fig 7 for roughly one quarter of the year the larval stage represents the dominant life stage across all latitudes 27 3 and across all longitudes 27 4 the eggs are the most dominant life stage for 7 9 7 0 of the year across all latitudes longitudes the adult life stage represent the dominant life stage only during 2 2 and 1 9 of the year across latitudes and longitudes respectively in comparison to the life stage succession sequence presented above section 3 1 we observe a similar pattern in the dominance succession across latitudes and longitudes fig 7 however the adult life stage is never the dominant life stage across all latitudes or all longitudes starting from the 1st of january the juvenile life stage represent the dominant life stage across all latitudes and longitudes fig 7 110 111 days after the 1st of january eggs represents the dominant life stage until 132 133 days after the 1st of january when the larvae life stage becomes the most dominant life stage across all latitudes longitudes the larvae become the most dominant life stage between 133 134 days after the 1st of january across all latitudes longitudes between 183 and 305 183 and 301 days after the 1st of january the juvenile life stage becomes the most dominant life stage across all latitudes longitudes afterwards the larvae life stage dominates the simulated population until 354 350 days after the 1st of january across all latitudes longitudes finally for the remainder of the year the juvenile life stage becomes the dominant life stage across all latitudes and longitudes overall the transitions from one life stage to the next occur roughly within the same week across latitudes during the first 180 days after the 1st of january fig 7a afterwards the transition from one dominant life stage to next occurs later at higher latitudes than at lower ones for instance the transition from larvae to juveniles near the end of the year at 20 n occurs 26 days prior to the transition at 40 n fig a 14 similarly in the first 250 days after the 1st of january the transitions from one life stage to the next occur roughly within the same week throughout the year and across all longitudes fig 7b in the second half of the year life stages further western transition slower from one life stage to the next than in the east larvae located at 140 e transition to the juvenile stage roughly 20 days later than those located at 120 e figs a 15 4 discussion our first aim of this study was to reproduce the measured pteropod abundance signal in the temperate region 30 n 60 n section 2 10 our ibm was able to reproduce the abundance signal under time varying environmental conditions for the northwestern pacific fig a 22 under these conditions the similarity between the observed and simulated abundances is high with a spearman correlation coefficient of 0 96 fig a 22 the mismatch between simulated and observed abundances mainly occurs during early spring where the onset of abundance increase occurs roughly 30 days later in our simulation the delayed onset of modeled abundance increase in spring is likely linked to the narrow spawning period implemented in the ibm however despite the lagged onset of abundance increase in the simulation the timing of the maximum pteropod abundance occurs within the range reported in maredat and the simulated abundances remain mostly within the observed range throughout the rest of the year fig a 22 thus on a population level our ibm is able to accurately reproduce the pteropod abundance signal measured in the temperate region in addition to the population level match between simulation and observation the second aim of this study was to provide a pteropod population life stage composition across one year that matches the life stage succession reported in the literature unlike in our model the distinction between individuals of the overwintering and spring generation is more challenging later in the year because individuals of different populations and individuals of different generations may overlap in time and space hsiao 1939 wang et al 2017 nevertheless the modeled longevity of seven eight months for the spring overwintering generation is of the same order of magnitude as the longevity reported for l retroversa kept under constant temperature 8 c and food replete conditions six months thabet et al 2015 and for l helicina in the temperate north pacific six months and eleven months for the spring and overwintering generation respectively wang et al 2017 on the life stage level the prolonged duration is most pronounced during the juvenile stages the modeled juvenile life stage has a duration of 114 days and 130 days for the spring and overwintering generation respectively table 3 in comparison under laboratory conditions this life stage lasts for 60 days section 2 7 2 thabet et al 2015 compared to field observations the juvenile life stage of the spring generation has a duration of 53 days fig 6 dadon and de cidre 1992 wang et al 2017 however the duration of the juvenile life stage of the overwintering generation has been observed to take 173 days dadon and de cidre 1992 wang et al 2017 thus the modeled duration of juveniles appears to be within the reported duration between the first juvenile and the first adult the difference between modeled and observed longevity might be explained by the difference between modeled and observed temperature and food availability that pteropods experience relative to the observed environmental conditions in the temperate north pacific with temperatures ranging between 6 c and 14 5 c and chlorophyll a concentrations between 2 5 mg m 3 and 15 mg m 3 wang et al 2017 the modeled pteropods experience warmer temperatures and lower food availability in our model simulations e g figs a 16 and a 18 thus the coupling between growth temperature and food availability fig a 11 in combination with warmer temperatures and food scarcity results in a longer spring generation and a shorter overwintering generation in the model domain detailed reports on the life stage progression or the life cycle of pteropods are scarce howes et al 2014 manno et al 2017 however we find that on average 87 of the modeled life stages weighted by modeled abundances fall within the corresponding life stage occurrence observations reported across multiple regions fig 6 such as in the gulf of maine hsiao 1939 thabet et al 2015 maas et al 2020 the bay of fundy newman and corey 1984 the temperate north pacific wang et al 2017 or the western south atlantic dadon and de cidre 1992 overall the timing in the development of the spring generation reflects the general patterns reported in the literature fig 6 the main difference between modeled and observed life stages occurs for the juveniles of the overwintering generation during winter at the beginning of the year the simulated juveniles experience relatively cold temperatures figs a 16 to a 17 and likely a slower growth period buitenhuis et al 2019 thibodeau et al 2020 which might explain the longer life stage occurrence these lower temperatures might have extended the duration of the modeled juvenile life stage and resulted in a progressively increasing delay in the life stage progression across the year in relation to the life stage dominance in the model we found that younger and smaller life stages dominate over older and larger ones in terms of abundance which is consistent with the observed dominance of smaller life stages in the calcs bednaršek and ohman 2015 and the temperate north pacific wang et al 2017 the third aim of this study was to characterize the spatio temporal distribution of pteropod life stages throughout a year however the comparison of model results to observations is limited by the fact that pteropods and zooplankton in general have a heterogeneous and patchy distribution e g wishner et al 1988 miller et al 1998 brentnall 2003 maas et al 2020 pasternak et al 2020 where sampling pteropods across small spatial scales can yield significantly different size specific abundances and vertical distributions in the calcs bednaršek and ohman 2015 nevertheless we found key similarities between our model results and observations in terms of dispersal and life stage spatio temporal distribution first we find a heterogeneous and patchy distribution in our modeled pteropod population evidenced by the isolated paths shown in fig 7 or as shown for seasonal maps of individual years figs a 20 and a 21 this aggregation into patches in our model is likely caused by eddies that are able to retain plankton within their boundaries for up to 67 days in our domain condie and condie 2016 and by our use of super individuals to match the observed pteropod abundances section 2 8 the latter results in a reduced representation of variable dispersal patterns and further increases spatial heterogeneity in the simulation parry and evans 2008 second we find a predominantly southwestward trajectory of the modeled pteropod population throughout a year which resembles the direction of the lateral export of organic matter towards the open ocean wit the california current frischknecht et al 2018 third our ibm simulates a dominance of the juvenile life stages in terms of presence across the year fig 7 and a relatively small dominance of adult life stages this finding reflects the observation that juvenile life stages can be observed throughout the year and the larger individuals are relatively seldom observed bednaršek and ohman 2015 wang et al 2017 in summary the abundances modeled with our shelled pteropod ibm is consistent with the measured pteropod abundance signal in the temperate region of the northern hemisphere and its application to the calcs results in a realistic perspective of the life stage progression for the simulated years this is evidenced by the match between the simulated life stage progression and the reported occurrence of life stages across several regions fig 6 such as the major spawning events in spring and fall hsiao 1939 dadon and de cidre 1992 thabet et al 2015 the subsequent die off events dadon and de cidre 1992 maas et al 2020 the overall dominance of earlier life stages in terms of abundance and dominant presence of juvenile life stages throughout a year newman and corey 1984 dadon and de cidre 1992 wang et al 2017 4 1 caveats and limitations the aim of this model is to describe north pacific temperate pteropod populations and to provide a template for modeling shelled pteropods which demonstrates the functionality of the ibm based on limicinidae species in the northwestern pacific thus the modeled pteropods their growth behavior and development are mainly based on observations of l helicina in the calcs and other limacinidae species in polar to temperate regions to apply this model to other regions the growth development bé et al 1972 bandel and hemleben 1995 and behavior e g migratory or non migratory wormuth 1981 of the modeled pteropods would need to be adjusted to the local pteropod community the species of interest and the scope of the project for instance in contrast to the continuous growth of l helicina for species of the cavoliniidae family the shell growth and development module would need to be adapted to reflect their two phase growth progression accurately section 2 7 1 depending on the species of interest the dvm behavior needs to be modified according to their migratory extent or lack thereof wormuth 1981 we used a simplified representation of the hermaphroditic reproduction of shelled pteropods section 2 7 3 hsiao 1939 that focuses on the timing of maximum egg production during spring and fall dadon and de cidre 1992 wang et al 2017 and neglects lower level spawning see appendix a 10 this choice emphasizes the role of temperature and food availability on pteropod growth and development and removes potentially confounding effects caused by multiple spawning events and a high diversity in life stage composition throughout the year thus the simplified spawning matches our the objective of this study to simulate a life cycle with two generations per year which corresponds to the observed abundance pattern at temperate latitudes for instance for assessments with the focus on the relationship between life stage variability and population fitness the influence of size on mortality or the adaptive or acclimation strategies of pteropods to corrosive conditions the spawning appendix a 10 mortality appendix a 11 or the parameters related to shell carbonate content appendix a 13 need to be adapted to fit the project s objective respectively despite the large amount of information on the biology of shelled pteropods information on some key processes remains scarce such as life stage specific mortality lischka et al 2011 bednaršek et al 2012b 2016 as shown by our sensitivity analysis changes in the mortality rates mainly affect the modeled abundances but not the seasonality table a 6 in terms of abundance changes linked to mortality rate uncertainty the shelled pteropod ibm uses super individuals to match the observed pteropod abundances thus we do not expect the life stage succession patterns to be affected by this uncertainty and the decrease increase in pteropod abundances due to the uncertainties in mortality rates could be lessened by adjusting the number of individuals within each super individual in terms of the spatio temporal distribution of pteropods a potential source of uncertainty is our choice in restarting each simulation year with the same initial population section 2 10 and the use of super individuals itself the former led to a simulation with reduced variability in the life stage composition of the pteropod population at the beginning of the simulation and a higher life stage variability near the end of the simulation however this approach emphasizes the role of environmental conditions such as temperature fig a 16 or food availability fig a 19 on the population life stage progression see also dorman et al 2011 2015b a with respect to the use of super individuals this approach was necessary to improve the model speed and memory use scheffer et al 1995 at the cost of reduced variable dispersal and enhanced patchiness parry and evans 2008 however unlike in our pteropod ibm the reduced dispersal is especially important if density dependent functions and interactive individuals are used parry and evans 2008 in addition the number of individuals per super individual in our ibm is roughly within the recommended order of magnitude ten parry and evans 2008 other potential caveats relate to the responses of pteropod to environmental conditions our model does not incorporate a direct pteropod response to some key factors such as oxygen gilmer 1974 mclaren 1963 hauss et al 2016 or predation e g by fish or shell less pteropods ohman 1990 peijnenburg et al 2020 however additional experimental and field work is needed prior to the incorporation of these direct responses due to the relatively high uncertainty in the influence of environmental stressors on pteropods and missing parameterizations lischka et al 2011 lischka and riebesell 2016 pasternak et al 2020 5 conclusion to the best of our knowledge this is the first ibm to simulate the life cycle of shelled pteropods with a spring and overwintering generation and four life stages in the model we use available information on and parameterizations of the biology of l helicina and l retroversa and link the characteristics of the individuals e g growth the onset of vertical migration mortality development response to environmental conditions to their size and the environmental conditions that they experience throughout their life our model successfully captures the measured pteropod abundance signal of the regions between 30 n and 60 n the life stage duration and succession sequence reported in the literature as shown in this study our model can be used to characterize the spatio temporal distribution of pteropod life stages in a region e g calcs overall our ibm is particularly relevant for quantifying ongoing and future effects of climate change which may manifest as changes in pteropod abundance size and growth e g ocean acidification bednaršek et al 2017b our implementation illustrates changes in the phenology and life stage composition of a pteropod population throughout a year fig 5 the behavior and development of individual pteropods is determined by the size of individual pteropods see litchman et al 2013 and the environmental conditions that pteropods experience e g food availability fig a 18 the inclusion of mechanistic responses to environmental conditions may allow our ibm to capture the effects of environmental stressors on populations as a whole or on individuals in the context of climate change marshall et al 2017 doo et al 2020 this approach may provide a detailed picture of the future and current effects of climate change on marine ecosystems where the ongoing pteropod shell dissolution illustrates a concrete marine ecosystem response to climate change manno et al 2017 bednaršek et al 2019 credit authorship contribution statement urs hofmann elizondo conceptualized the project developed the model prepared the data performed the analyses visualization wrote the first draft interpreted the results reviewed the manuscript meike vogt conceptualized the project developed the model interpreted the results reviewed the manuscript supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank n gruber and the environmental physics group for analytical and visualization advice funding this research was supported by eth zürich switzerland under grant 175787 x ebus extreme ocean weather events and their role for ocean biogeochemistry and ecosystems in eastern boundary upwelling systems snf appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ecolmodel 2022 109944 appendix a supplementary data summary of pteropod ibm parameterisations supporting information sensitivity analyses and alternative submodels the following is the supplementary material related to this article mmc s1 
24457,many introduced plants pose invasion risks globally and threaten the biodiversity of native ecosystems such non native plants can become invasive when they have advantages over native plants such as having fewer natural enemies invasive plants often have the ability to alter ecosystem properties after they have become established which can make it difficult to eliminate the invasive in principle this can cause a regime shift that may not be reversed through intense control efforts that increase mortality and reduce growth of the invasive species here we use spatially explicit agent based modeling to simulate the invasion of an introduced tree species into a habitat occupied by a native species the model describes an invasive tree with fast growth and high seed production and in addition produces litter that has a suppressive effect on native seedlings these are properties for example shared by the invasive melaleuca quinquenervia in southern florida habitats we use simulation modeling to test the following logical hypotheses partial suppression of native tree seedlings by the invasive tree s litter 1 will accelerate the spread of the invasive tree into native vegetation 2 will impede efforts to control invasive spread through biocontrol and 3 can cause a regime shift that is not reversed even if the biocontrol lowers invasive growth and reproduction to levels substantially lower than those of the native species additionally 4 the earlier in the invasion biocontrol is introduced the more effective it will be in reversing the invasion the simulations support all four hypotheses while these results highlight the potential for biocontrol of invasive tree species our findings also suggest that successful elimination of positive litter feedbacks and invasive spread may critically depend on the timing of control efforts within the invasion process key words individual based model invasion dynamics regime shift litter accumulation biocontrol 1 introduction invasive plant species have been ranked as one of the most severe current threats to biodiversity rai 2015 ecologists studying invasions and trying to predict the possible spread of an introduced species need to understand the factors that make invasion by a particular non native species successful among the most commonly hypothesized factors for invasion success is that a non native species is likely to have few natural enemies in its new environment enemy release hypothesis keane and crawley 2002 if an invader is free of natural enemies it can allocate less energy for defense and more energy into growth and reproduction in fact a meta analysis on the performance of species both plants and animals shows that invasive species on average do better in terms of growth fecundity and abundance in favorable environments outside their native ranges parker et al 2013 other factors favoring invasion of plants may be physical disturbances to an invaded site and species attributes that allow them to exploit resources more efficiently than native plants collectively these advantages can result in successful invasion lake and leishman 2004 another important question is whether an invasive plant species will simply become a part of the existing plant community or whether it will become dominant and cause a complete change or regime shift in the community this possibility was investigated by gaertner et al 2014 in a meta analysis of 173 invasive plant studies their study showed that an invasive species can cause a regime shift by modifying the environment in a way that favors its own fitness in the environment over that of native species in that case the invader can create a self reinforcing or positive feedback loop once it gains a foothold in a new environment eventually replacing the native species that is being ecosystem engineers e g crooks 2002 cuddington and hastings 2004 eisenhauer et al 2009 gaertner et al 2014 identified five main mechanisms involved in feedback loops that can lead to regime shift two are of interest to our study the seedbank composition feedback and the litter feedback the first of these mechanisms refers to the high seed production of some invaders which can eventually overwhelm native species in recruitment the second refers to the production by some invasive species of large amounts of leaf litter that have a greater negative effect on native seedlings than on their own seedlings the fact that a thick litter layer can have a negative effect on seedling emergence has been observed in certain ecosystems facelli and pickett 1991 for example this can occur when an increased layer of spruce picea abies litter suppresses other species such as hazel corylus avellana whereas an increased hazel litter layer does not suppress seedling emergence and even has a positive effect on seedling growth koorem et al 2011 kaproth et al 2013 found that the invasive wetland grass phalaris arundinacea benefits from the high abundance of litter that it produces while eppinga and molofsky 2013 additionally found that the litter suppresses performance of native species experiments by kostel hughes et al 2005 showed that emergence of seedlings of small seeded trees such as betula lenta and liquidambar styraciflua decreased with increasing litter depth xiong and nilsson 1999 analyzed data from 35 independent studies on effects of plant litter on germination and establishment of plants showing variable but mostly negative effects another invasive species that has been shown to have negative effects on native seedlings is the tree melaleuca quinquenervia which is a successful invader in southern florida this species is in the family of myrtaceae and is commonly known as paperbark tree serbesoff king 2003 we will refer to the species as melaleuca hereafter melaleuca is a native australian tree species introduced into florida in the late 19th century for the purpose of pulp production and as an ornamental also it has the ability to lower the water table since it has a high capacity for transpiration chin 1998 which was felt useful in the everglades drainage project for preventing flooding bodle et al 1994 however melaleuca showed strong invasive tendencies throughout southern florida and spread over 200 000 ha in southern florida dray jr 2003 it has impacted ecosystems such as pine flatwoods freshwater marshes sawgrass prairies cypress domes hardwood hammock and buttonwood mangrove associations of southern florida by the end of the 20th century dray et al 2006 melaleuca is one of the invading species shown in the meta analysis of parker et al 2013 to show higher fitness in its invaded habitats than in its native habitats as noted above in addition to its potential for fast growth and high reproduction invasive melaleuca carries with it a feedback effect on the local environment that falls into the category of litter feedback identified by gaertner et al 2014 melaleuca produces a large amount of leaf litterfall that has a lower decomposition rate than much of the vegetation native to southern florida such as hardwood hammock species van et al 2002 southern florida has a subtropical climate such that litter decomposition is usually rapid and the accumulation of litter under local hardwood hammock is generally relatively small sampaio et al 1993 however melaleuca s leaf litter turnover rate of around 60 yearly finlayson et al 1993 though faster than native pine leaf litter is significantly slower than sawgrass marsh and native broadleaf tree litter thus litter accumulation of melaleuca on sites in southern florida is greater than that of other tropical species gholz et al 2000 rayamajhi et al 2010 rayamajhi et al 2012 demonstrated suppression of the emergence of native seedlings by melaleuca quinquenervia the seedling emergence of two species common in southern florida wax myrtle morella cerifera and sawgrass cladium jamaicense was compared to that of melaleuca seedlings under melaleuca litter rayamajhi et al 2012 the authors found that the litter had a much greater suppressive effect on emergence of seedlings of the other two species than on that of melaleuca seedlings the effect of litter on seedlings is possibly relevant to the invasion of melaleuca into southern florida communities to which it has caused damage over large areas because of the harmful effects of invading melaleuca by the end of the 20th century biocontrol agents were introduced to try to control its spread dray et al 2006 some introduced herbivores were effective in suppressing the melaleuca vegetation including the melaleuca weevil oxyops vitiosa pascoe and the psyllid boreioglycaspis melaleucae moore myers and bazely 2003 rayamajhi et al 2007 after application of biocontrol agents significant suppression of melaleuca has been shown notably the growth rate of plants has been reduced by at least 83 and the seedling survivorship reduced by 49 center et al 2007 the trend of decrease of melaleuca and gradual restoration to native vegetation has indicated that application of herbivores to suppressing melaleuca has been successful rayamajhi et al 2007 after years of the herbivore control agents coupled with chemical and mechanical treatment melaleuca is now considered under control in southern florida center et al 2012 although melaleuca now appears to be under control it is important to understand whether characteristics like melaleuca litter s suppression of seedlings might affect the rate of recovery of native vegetation our objective is to study through modeling of an invasive tree with the described characteristics of fast growth high reproductive rate and litter suppression of native seedlings is able to create a self reinforcing feedback that increases the invader s rate of spread and or makes reversal of the invasion difficult although it is not our intention to model melaleuca specifically which would require more precise parameter values than we have our study should provide some insights on the long term effects of biocontrol of a species with its properties we ask the general question of how litter suppression of native seedlings by an invader may speed up the spread of the invader and delay or even prevent the restoration of native vegetation through biocontrol alone we also examine whether the timing of application of biocontrol relative to the initial time of invasion matters in success of control the following hypotheses will be tested in a model hypothesis 1 the negative effect of melaleuca litter on native seedlings will allow the invader to spread faster from an initial point of invasion than if it had no effect on the native seedlings hypothesis 2 the negative effect of invader litter on native seedlings will make it more difficult for biocontrol on the invader to reverse the spread of the invader in the native vegetation hypothesis 3 if the negative effect of invader litter on native seedlings is great enough it will create a hysteresis effect that even very strong biocontrol effort will not easily overcome and thereby could result in a permanent regime shift unless biocontrol is complemented with other means of control such as mechanical removal hypothesis 4 the earlier in the invasion that biocontrol is introduced the more effective it will be in reversing the invasion to test these hypotheses we performed simulations using a spatially explicit agent based model representing an invasive and a native species we used a spatially explicit agent based model so that the mechanisms of individual tree growth reproduction seed dispersal mortality and spatial interactions including litter suppression of seedlings could be studied in a detailed way we performed simulation experiments or scenarios first the litter accumulation effect on seedling was simulated under different scenarios without biocontrol then biocontrol was added to the model and the biocontrol effectiveness was tested with both different assumed levels of litter suppression of seedlings and different biocontrol scenarios other factors were varied as well between the scenarios although our model was motivated by the interaction between melaleuca and native tree species such as hardwood hammock or pine flatwoods we do not have good enough estimates of all the parameters needed for such models therefore this is a theoretical study rather than an attempt to make predictions that can be used for any particular species ideally though the model presented can eventually be better parameterized and used in practical applications 2 methods spatially explicit individual based seib modeling is an approach that can be used for examining ecological phenomena at the level of individuals interacting in space grimm and berger 2016 note the term agent based is often used interchangeably with individual based we use seib modeling to describe the invasion of a native population of trees by a non native tree species or group of tree species that we represent as a single species an advantage of seib modeling is that many traits of individuals of the different species can be incorporated in the model including those related to spread and occupation of space which allows study of which traits are especially crucial for the success of one or the other species this study is theoretical but is designed to provide insights for the invasion of melaleuca in a stand of native tree species simplified to a one species population in southern florida because hardwood hammocks which consist of a number of tropical hardwood species are among the impacted habitat types we will sometimes refer to hammock as the native type although sawgrass wetland pine forest and cypress forest are also invaded we describe the model briefly using the overview design concepts and details protocol grimm et al 2010 2 1 purpose and patterns the modeling was conducted to understand the dynamics of two competing tree species an invader patterned after melaleuca and a generic species representative of trees native to southern florida the model describes the spatial dynamics of invasion of an initially pure stand of native trees our overarching question is how the suppression of native seedlings by the invader s leaf litter will counter the effects of biocontrol this question is addressed for different assumed strengths of litter suppression and different assumed times of initiation of biocontrol following invasion 2 2 entities state variables and scales the area of the plot simulated is 100 100 meters the model includes two basic types of entities first there are individual trees which are termed agents each of which is either an invader or a native tree individual trees are defined by age diameter at breast height dbh and spatial location following jiang et al 2012 tree height and leaf area are allometrically related to dbh the individual trees are distributed in continuous space that is they can be located at any point within the 100 100 m space and can have canopies covering up to a 5 5 set of 1 x 1 m cells the second entities are the heterogenous litter accumulations across the plot as individual tree canopies can overlap the contributions of each tree to the litterfall in a 1 x 1 m cell are summed to a total amount of litter deposition 2 3 process overview and scheduling all processes growth reproduction and mortality of individual trees as well as their litter production are modeled as discrete annual time steps growth of individual trees is a function of the effects of neighboring trees through the field of neighborhood fon approach described below and in appendix a of the supplementary information reproduction is assumed only for trees of either species greater than 20 years of age dispersal of seeds is assumed to decline with distance from the parent tree litterfall dynamics comprises the influx of litterfall and the outflux of litter decomposition 2 4 design concepts basic principles the theoretical purpose of the model is the assessment of biotic factors in particular litterfall and its turnover rate which can affect the emergence of seedlings of different vegetation types to different degrees and thus affect population and community dynamics emergent properties an ecotone between the two woody vegetation types is the key emergent property the expected output of the model is that ecotones which can be sharp or diffuse will form dividing the landscape into clusters of single vegetation types the suppression of seedlings due to litter accumulation may contribute to ecotone formation adaptation the species are adapted to their environment through their growth rates rates of reproduction seed dispersal distances and resistance to mortality in addition the invasive species produces litter that has a suppressive effect on the emergence of native seedlings no changes in the levels of these adaptive traits are assumed to occur over the time scales of the simulations objectives the objective of each tree type is to maintain itself and spread spatially biocontrol to attempt to control the invasive species is inserted into the simulation at a certain time after the start of the invasion and is assumed to continue at the same level indefinitely interaction the individual trees interact with each other locally depending on relative sizes and distance but with no difference between species in ability to compete for space and light as described by the field of neighborhood approach berger and hildenbrandt 2000 litter accumulation of the invasive species is assumed to interact with the establishment of seedlings of the native species but not vice versa stochasticity the production of seedlings and their locations are stochastic processes 2 5 initialization the initial spatial distribution of native tree individuals was set to approximate a typical tree distribution ranging from 1 to 80 years of age along with corresponding assumed diameters at breast height dbh across the 100 100 m plot a small number of invaders are initially scattered near the center of the plot which are uniformly randomly distributed in ages less than the age of maturity and all with corresponding dbh vs age values based on estimates from data on the tree species common lime and common ash in lukaszkiewicz and kosmala 2008 d b h d b h 1 d b h 2 a g e where dbh 1 is the intercept and dbh 2 is the slope all neighbors within 5 m of each tree were determined and put into a matrix called neibi so that their effects on growth through fon interactions could be determined no litterfall accumulation is assumed in the cells in the first year see table 1 for parameter values used the simulation was started when the oldest invasive tree had survived to 20 years of age because the invasion dynamics only really start when the invasive trees start to reproduce 2 6 input data input data were designed for a theoretical study rather than being fit to a specific empirical situation 2 7 sub models here we describe sub models of the model 2 7 1 growth the growth model is similar to earlier models developed for describing woody plant growth in agent based simulations e g botkin et al 1972 and is described in appendix a the growth model is the same for the two vegetation types except for the growth rate coefficient g see table s1 which is gnative 267 and ginvader 400 parameter g relates growth rate in volume of the tree to leaf area and is used to scale the relative early growth rates of trees of different species moore 1989 botkin 1993 when biocontrol was assumed to occur in the model it was assumed to reduce the growth rate of the invader by about 80 to ginvader 80 2 7 2 competition the field of neighborhood fon model berger and hildenbrandt 2000 is used to describe the effect of close neighbors on the growth of each other all neighbors within 5 m of each tree i were determined and put into a matrix called neibi so that their effects on growth through fon interactions could be determined this is done using the data on neighbors within 5 m of each tree stored in matrix neib the details of the fon are described in appendix a 2 7 3 litterfall and its accumulation the total annual leaf litterfall per tree lfi in kg y 1 is determined as an allometric function of dbh l f i c l f i 100 d b h b l w i where clfi and blwi are constants i invasive or native the parameters are estimated for melaleuca based on van et al 2002 native litterfall was kept track of in the model but because it was not assumed to have any effects in the model the coefficients were arbitrarily chosen with clfnative clfinvasive the computer code kept track of how much leaf litter from each tree falls annually in a particular 1 1 m cell and sums these for all trees part of whose canopy covers that cell for each species separately to do this the spatial extent of the canopy of each tree is first determined canopy extent is assumed to be the same as that of the rooting zone which is calculated allometrically from dbh the maximum extension of the radius of the roots is given in meters by m a x r t d b h 2 c 4 c 5 d b h 2 based on komiyama et al 2000 komiyama et al 1987 where c4 and c5 are constants that are the same for invader and native the rooting zone is assumed to cover a square of 1 1 m cells with each side of the square being the length of the radius this is also assumed to be the size of the canopy the total annual leaf litter of the tree is divided evenly among the cells as calculated in the function rootfrc m each cell receives input from all the trees whose canopies overlap that cell the function rootfrc m the details of which are described in appendix a returns to the main code the values of lfi jk the total yearly leaf litterfall of all trees of species i that have some of their canopy in 1 1 m cell j k the cumulative leaf litter depth of the invader is calculated using the equation l f a c c u m u l a t i o n t 1 1 k i l f a c c u m u l a t i o n t l f i j k t where ki is the yearly turnover rate see table 2 for parameter values used in the simulations here because only the litter of the invasive tree is considered in the model to suppress seedlings some parameter values are shown only for the invasive trees 2 7 4 reproduction in calculating annual reproduction a seedling production probability constant bratei i invasive or native is assigned which is greater for the invader than for the native species in the iteration over all trees greater than a certain age set arbitrarily at 20 years here the code specifies that each tree can produce an upper limit of nseedling limit viable seedlings each year with each seedling having the probability brate to survive in each iteration over the these nseedling limit chances a uniform random number between 0 and 1 rand is selected where survival occurs if rand bratei therefore each mature tree can produce anywhere from zero up to nseedling limit seedlings each year the low value of nseedling limit used here see table 3 takes into account the very low survivorship of seedlings 2 7 5 seedling dispersal the distance of dispersal of each seedling is a random variable assuming that propagule dispersal distances disperi follow exponential distributions with means 1 c3 i that differ between the species the distance dispersed from the parent tree for a given propagule can be calculated as a random variable d i s p e r i ln r a n d c 3 i for each tree i invasive or native from those radial distances the x and y coordinates of the new seedling are calculated assuming each direction from the parent tree is equally likely and the seedling is assigned and initial dbh of 1 cm only those propagules that land within the 100 100 grid are counted 2 7 6 litter suppression of seedlings next potential suppression of seedlings is calculated the invader litter accumulation lfaccumulation is known for the 1 1 m cell in which a given propagule has landed so the degree of suppression can be calculated l f b r a t e i e l f a c c u m u l a t i o n i s l i t t e r i where s l i t t e r i is a constant that measures the effect of litter of the invader on species i only invasive litter is assumed to have a suppressive effect and the effect differs for seedlings of different species we assume here that s l i t t e r i is not known and we examine the effects of a series of values a random number rand is chosen for each propagule if r a n d l f b r a t e i n v a s i v e then the seedling survives otherwise it does not emerge if it survives the new seedling is put into the neibi matrix that stores each tree s neighbors after its neighboring trees are determined see table 3 for parameter values used in the simulations here 2 7 7 mortality three types of tree mortality are included size dependent mortality mortality due to poor growth rate and density dependent mortality these are described as follows size dependent mortality m c 1 μ 1 μ 2 e μ 3 d b h mortality due to poor growth rate m c 2 μ 4 e μ 5 d n c where dnc is the increase in diameter at the current time step the diameter increase per year is determined in part by competition between trees within a certain distance as determined by the field of neighborhood submodel described in appendix 1 mortality due to density dependence m c 3 10 6 e μ 6 n d e n s i t y e μ 3 d b h where the mortality due to density dependence spatial crowding declines with size of tree there may appear to be some overlap of mc2 and mc3 but the ecological reasoning is that mc3 applies largely to very young trees that are close to the parent and die from lack of suitable growing conditions while mc2 may also correspond to older trees that may experience slow growth over a number of years that can eventually lead to death all of the µi values are constants and the same for both vegetation types ndensity is the number of adult neighbors with stems within a distance of 5 meters the values of ri differ for invasive and native trees as it is assumed that the invasive tree can tolerate higher density therefore mc3 differs for the two species then the total mortality rate is m c i m c 1 m c 2 m c 3 i see table 4 for parameter values used in the simulations 2 7 8 biocontrol insect herbivores were not simulated explicitly a constant effect level of herbivory on each invasive tree was assumed for our model we assumed reductions of growth rate of 80 from ginvader 400 to ginvader 80 and of reproduction of 80 from brateinvader 0 7 to 0 14 the effect on reproduction assumed here is greater than estimates in tipping et al 2008 for melaleuca we varied the timing of introduction of biocontrol tbiocontrol which was 100 50 or other year after the start of a simulation to summarize the invasive species has some advantage over the native species in growth rate reproduction rate seedling dispersal distance and its tolerance of crowding in addition the litter of the invader can suppress emergence of the native species biocontrol reduces growth and reproduction rates of the invader substantially below those of the native species 3 simulation scenarios simulations of scenarios were performed using matlab r2020a to test each of the proposed hypotheses related to litter suppression of seedlings and to biocontrol stated in the introduction the simulations performed are described within the descriptions of testing of each of the hypotheses below and then are summarized in table 5 in the simulations identical random number initiators were used such that initial tree locations ages and dbh s were the same for all runs to make comparisons of the simulations easier replicate simulations not shown using different random number initiators produced similar enough output to indicate that single simulations for each case were sufficient to demonstrate the effects of different scenarios 4 results before describing output related to the hypotheses we give an overview of the invasion dynamics in the absence of litter suppression of native seedling and of biocontrol without a suppressive effect on native seedlings i e s i n v a s i v e l i t t e r n a t i v e 0 the invasive species spreads from its initial 25 stems due to its higher rates of both growth and reproduction replacing the native species within 200 years figure 1 the invasive species reaches a density of about 1700 stems per hectare before being replaced by the invader while the invader which is slightly more tolerant of crowding reached over 2300 stems per hectare figures s1a s1f supplementary information show snapshots of all invasive and native trees from 20 to 120 years following the start of the simulation while figure s1g shows the size distribution of invasive trees at the end of the period although our invader is generic and does not try to simulate the invasion of melaleuca specifically it is interesting to compare densities of both tree stems and litter from the model with those measured in the field van et al 2002 estimated stem densities of melaleuca in six sites in southern florida as ranging from about 11 000 to 36 000 stems per hectare this is far greater than our simulations of close to 2500 stems per hectare van et al 2000 measured litterfall as ranging from 6 5 t ha 1 to 9 9 t ha 1 t is metric tons or 0 65 kg m 1 to 0 99 kg m 1 our simulations calculated accumulated leaf litter as shown spatially in figure 2 ranging up to values of slightly over 1 2 kg m 1 in a few spots but mostly in the range 0 to 0 8 an accumulated litter range of 0 to 0 8 kg m 2 corresponds to litterfall rate of 0 to 0 48 kg m 2 y 1 the higher values at some places on the boundary cells of plot are artefacts of the simulations because they do not change any of our results we did not redo our simulations to eliminate them thus our simulation values of stem density are substantially less than the empirical data on melaleuca but model output on litterfall resembles that measured in the field for melaleuca a possible explanation for the discrepancy in stem density is that the size distributions of melaleuca in van et al 2002 their table 2 is more skewed towards stems of small dbh than is our model s this indicates that our parameters regarding density dependence differ from those of melaleuca in any case our model must be considered only theoretical 4 1 hypothesis 1 we performed five initial simulations to test hypothesis 1 the invader was simulated to spread for 200 years without biocontrol five values of s l i t t e r o n n a t i v e were assumed with values of 1 10 20 50 and 200 1 kg m 2 which ranged from mild to very severe the invader s litter was assumed to have only a weak effect of 1 1 kg m 2 on its own seedlings all other parameters were the default values in the above tables the rate of spread can be shown to be roughly constant in time which approximates what is expected from fisher s equation for a population traveling wave it can also be shown that the rate of spread has some dependence on s l i t t e r o n n a t i v e figure 3 shows plots of the mean distance of invasive trees from the center of the plot as a function of time for five values of s l i t t e r o n n a t i v e 1 10 20 50 and 100 the calculated slopes from year 1 to year 80 are respectively 0 2341 0 2800 0 2745 0 2938 and 0 3588 showing a general increase of slope with strength of litter in suppressing the native seedlings this supports our hypothesis 1 that litter suppression can cause the speed of invasion to increase the method used here used averages of mean distance of the invader which has the disadvantage that fluctuations in density closer to the center of the plot could affect the curves and appears to do so other approaches would be to keep track of the distances of the forerunners of the invasion it can also be expected that rates of spatial spread will be positive functions of reproductive rate and mean seedling dispersal distance in order to confirm this additional simulations were performed with large ranges of each of the two parameters nseedling limit and c3 invader the first parameter affects reproduction the maximum potential number of seedlings produced by an individual tree in a given year in these simulations the maximum potential surviving seedling numbers ranged from 3 to 12 the second parameter controlling mean distance of spread of a seedling was c3 invader which is related to mean dispersal distance as d i s p e r s a l m e a n r a n d c 3 i n v a d e r in the sensitivity analysis the mean distances of spread ranged from about 2 5 to about 7 meters the results for the radial rate of spread as functions of these parameter are shown for a single simulation in figure 4 4 2 hypothesis 2 simulations that included biocontrol were performed to test hypothesis 2 that invader litter suppression of native seedlings will impede efforts to reverse invasion through biocontrol biocontrol was imposed starting at year 100 of the simulation and continuing with 80 reductions in both the maximum growth rate parameter g and in the parameter for seedling production brate three different values of s l i t t e r o n n a t i v e were assumed mild s l i t t e r o n n a t i v e 1 intermediate s l i t t e r o n n a t i v e 20 and severe s l i t t e r o n n a t i v e 200 levels shown in the three vertical panels of figure 5 it is clear that the litter suppression at least slows down the recovery of the native trees the severe effect on litter of s i n v a s i v e l i t t e r n a t i v e 200 level appears in figure 5 bottom to actually prevent the biocontrol from succeeding although this value of suppression may be unrealistically high 4 3 hypothesis 3 a simulation was performed to test hypothesis 3 for whether a high level of native seedling suppression could allow the invader to be maintained in the system despite biocontrol at the level of 80 reduction in both growth rate and reproduction simulation was run with biocontrol starting at year 50 and with s i n v a s i v e l i t t e r n a t i v e 200 1 kg m 2 the values of invader growth and reproduction under biocontrol g 80 and brate 0 14 are far less than the respective values of the native species of g 247 and brate 0 25 the simulation results shown in figure 5c from hypothesis 2 confirm that strong enough litter suppression effects can overcome that level of biocontrol even though the invasive species in reduced to a far lower stem density about 1500 per ha than without biocontrol 2300 per ha to test how earlier application of biocontrol might help alleviate this difficulty in overcoming the effects of litter suppression by the invader we made only one change from the simulation shown in figure 5 bottom that is we changed the time of application of biocontrol from year 100 to year 50 the results of a 1200 year simulation in figure 6 a show instead of clear success of biocontrol that the invasive species continued to expand and reached an apparently constant density coexisting with a lower density of native species a 1200 year simulation of course is only of theoretical interest but it shows that the simultaneous application of certain levels of biocontrol effects on growth and reproduction combined with strong native seedling suppression by the invader can lead to long term coexistence at a constant level of both species that the litter suppression of native seedlings is responsible for the continued persistence of the invader is seen from a further simulation in which the suppression effect is removed is seen in figure 6b in which the invader is gradually eliminated this is a further corroboration of hypothesis 3 assuming that a change from native dominance to coexistence can be termed a regime shift although it is possible that the state in figure 6b is long term transient this is investigated further in appendix b where it is shown that if both species are assumed initially evenly dispersed spatially and intermediate biocontrol is applied from the beginning the long term coexistence of invader and native species as shown in figure 6a is actually an intermediate state probably long term transient between two alternative table states one in which the invader cannot invade from low numbers relative to the native and the other in which the native cannot invade at low numbers relative to the invader 4 4 hypothesis 4 it was hypothesized that the time at which biocontrol was applied after the start of invasion was important in the effectiveness of control so three times of application of biocontrol following the start of the simulation early tbiocontrol 50 years intermediate tbiocontrol 75 years and late tbiocontrol 100 years were used the outputs in figure 7 a for 50 years and figure 7b for 75 years are compared with figure 6b 100 years in each case it is assumed s i l i t t e r n a t i v e 20 these results confirm the hypothesis that early application of biocontrol can substantially increase the effectiveness of biocontrol the results of the testing of all four hypotheses are summarized in table 5 5 discussion the simulation modeling tested four hypotheses hypothesis 1 proposed that litter suppression of native seedlings by the litter of invasive species would promote faster spread of the invasive species that hypothesis was supported the rate of spread of the invader differed among five simulations with different values of s l i t t e r o n n a t i v e figure 3 increasing strength of suppression further simulations showed that the rate of spread of the invasive wave increased as a function of parameters for reproductive rate and mean seedling dispersal distance figure 4 as expected from fisher s traveling wave equation hypothesis 2 that invader litter suppression of native seedlings would make it difficult to reverse the invasion was supported in figure 5a b in which the time scale for recovery of native vegetation is slower for a larger value of suppression figure 5 c shows that an extremely high value of suppression may make recovery impossible despite the fact that biocontrol causes growth and reproduction rates to be far lower in the invader than in the native species this figure also supports hypothesis 3 that proposes that a regime shift can occur in which a hysteresis effect can prevent native tree recovery appendix b explores a variation on the two species competition in which the two species are initially uniformly dispersed spatially in that case bistability clearly occurs figure 6 a shows that the regime shift could be toward long term stable coexistence of the two species in that case biocontrol prevents further expansion of the invader while the extreme litter suppression effect on the native species prevents it from moving into areas occupied by the invader this suggests that when an invader creates an environmental change that negatively affects the native as does litter suppression of seedlings in this case biocontrol by itself may not be sufficient to reverse an established invasion in such cases biocontrol would need to be supplemented by other control measures such as herbicide treatment to reduce the invasive species to a level that can be controlled by biocontrol experiments combining biocontrol with herbicide treatment have been carried out for both melaleuca and other invasive plants our modeling may help in their interpretation hypothesis 4 which proposed that earlier application of biocontrol promotes faster recovery of the native trees was supported the effect seen by comparing figures 7a b and 6b is dramatic as early application of biocontrol limits the seedling production of the invader once the invader is established its seedling production can overwhelm the native trees and slow any recovery through biocontrol therefore the litter suppression effect makes invasion difficult to reverse and there is some suggestion that a regime shift can occur but a regime shift is not inevitable and early application of biocontrol decreases the likelihood it needs to be kept in mind that besides suppression of native litter the invader was assumed to have another advantage over the native species in that its growth rate was slightly less affected by spatial stem density an advantage that was not affected by biocontrol see μ4 in the mortality submodel that property contributed to the invader s resistance to biocontrol and that should be studied further the invading species in our model was patterned after melaleuca which has greater litter production than native hardwood hammock as well as a greater effect of litter suppression on seedlings of the native species field studies have suggested that there is a significant difference in seed production of melaleuca in southern florida and in its original habitat in australia according to rayamajhi et al 2002 melaleuca produces eight times more seeds per individual in southern florida that could be a factor in why melaleuca had high seedling emergence despite its high litter production an additional factor is that even if the litter layer covers melaleuca seeds blocking them from sunlight one year these seeds remain viable up to two years after dispersing from their seed capsules woodall 1978 woodall 1982 hartman 1999 rayamajhi et al 2002 therefore melaleuca tends to be a litter tolerant species compared to native hardwood hammock this may be related to a suggestion by kortessis et al in review that plant species with greater litter production may also be more litter tolerant and thus tend to be more competitive in the ecosystem field results suggest that when melaleuca invades it outcompetes the native species and turns the community into a monoculture of melaleuca serbesoff king 2003 the preliminary results from our model mesh well with empirical studies which show that litter suppression on some native species increases when invasive biomass increases rayamajhi et al 2010 2012 in figure 5a where the litter suppression coefficient for native hardwood hammock is relatively small the invasion progress was reversed by biocontrol even when only started after 100 years unlike figures 5b c with their higher litter suppression in our model biocontrol exerts a density independent effect on growth and mortality that may or may not be true in nature where biocontrol agents could have a functional or numerical response to vegetation density however the effect of biocontrol on growth may contribute to the effect of an existing density dependent mechanism in the model high tree density leads to slower growth through the field of neighborhood submodel slower growth leads to increased probability of mortality through µ3 in the mortality submodel the slower growth of invader trees due to biocontrol contributes to that source of mortality one of the features of all simulations in which biocontrol was imposed whether or not the biocontrol ultimately succeeded was that there was an immediate sharp decline in the invasive trees the reason for the sharp initial decline was the fact that some degree of clustering of stems occurs so that density dependent effects caused some fraction of individual growth rates to be low even before biocontrol the additional slowing of growth due to the biocontrol pushed them below a threshold that made them highly vulnerable to mortality each yearly time step after this burst of mortality the invasive trees were thinned out such that the density dependent source of mortality was diminished and the other mortality sources dominated and were decisive in whether the invasive trees were controlled or not see appendix b supplementary information for output demonstrating the rapid thinning caused by the imposition of biocontrol there is an additional density dependent mortality in the model represented by µ4 in the mortality submodel that effect increases the mortality of trees that are close together within 2 5 m for native trees and 2 0 m for invasive trees and particularly affects seedlings or immature trees that are too close to larger trees and may be shaded although there may be some overlap of the effects of µ3 and µ4 may overlap to some degree we believe both are relevant in southern florida after introduction of the biological control agents melaleuca weevil oxyops vitiosa pascoe and the psyllid boreioglycaspis melaleucae moore significant suppression has been shown on the melaleuca in particular the growth rate has been reduced by at least 80 and the seedling survivorship reduced by 60 center et al 2007 with further evidence of the negative impact of herbivore agents on melaleuca vegetation in rayamajhi et al 2008 center et al 2012 in figures 7a b the seedling suppression effect was intermediate in strength and biocontrol was introduced relatively early 50 and 75 years respectively after the invader started reproduction the simulated control results turned out to be successful with less invading vegetation build up instead the vegetation mostly returned back to native vegetation because the biocontrol agents reduce the seed production and seedling survival rate a significant restoration result can be expected when applied early and at high enough strength to quickly stop the spread in this model we have only considered the effects of invader leaf litter suppression of native seedlings however leaf litter and its decomposition can have broader effects that are not considered here leaf litter decomposition is important to the nutrient cycle in the dynamics of plant soil interaction facelli and pickett 1991 evidence also supports that invasive plants can modify soil attributes including nitrogen cycling and microbiomes ehrenfeld 2003 some studies also suggest the modification of soil can facilitate the invasion process such as by suppressing native species or improving the invader s own fitness reinhart and callaway 2006 simberloff 2006 for example ellsworth et al 2004 found an invasive vine species is benefited by its denser litter layer which allows it to allocate nutrients that improve its survivorship future work may include more complex soil processes there are a number of limitations on this model one simplification was that the biocontrol agent was not simulated as a variable but only represented by reductions of reproduction and growth we are not able to consider every potential biotic and abiotic aspect that could impact the vegetation formation some of these will be considered in future work although this model we developed here is a theoretical model with accurate parameterization this model framework can be applied more explicitly to melaleuca invasion and perhaps more broadly extended to other invasive plant species author contributions designed the study y l d l d performed the simulations y l j x j j d l d wrote and revised the paper all authors declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that cdocould have appeared to influence the work reported in this paper acknowledgements we are grateful for useful comments of nicholas kortessis margaret simon amy kendig david kikuchi and michael barfield of the holt lab of the university of florida james grace u s geological survey maarten eppinga university of zürich and an anonymous reviewer dld and yl were supported by greater everglades priority ecosystem science program any use of trade firm or product names is for descriptive purposes only and does not imply endorsement by the u s government appendix a submodel tree growth each tree is assigned an initial tree diameter at breast height dbh dbhinvader dbhnative the code iterates over all trees and computes their growth the yearly increments are designated dncinvader and dncnative respectively for invader and native the yearly increment in dbh is then given by d n c i n v a d e r g i n v a d e r d b h i n v a d e r 1 d b h i n v a d e r h t i n v a d e r d m a x i n v a d e r h m a x i n v a d e r 1 274 3 b 2 i n v a d e r d b h i n v a d e r 4 b 3 i n v a d e r d b h i n v a d e r 2 r f o n d n c n a t i v e g n a t i v e d b h n a t i v e 1 d b h n a t i v e h t n a t i v e d m a x n a t i v e h m a x n a t i v e 1 274 3 b 2 n a t i v e d b h n a t i v e 4 b 3 n a t i v e d b h n a t i v e 2 r f o n where g i n v a d e r and g n a t i v e are growth rate constants and where tree height is calculated allometrically from dbh h t i n v a d e r 137 b 2 i n v a d e r d b h b 3 i n v a d e r d b h 2 h t n a t i v e 137 b 2 n a t i v e d b h b 3 n a t i v e d b h 2 submodel field of neighborhood method for calculating effects of neighbors next the field of neighborhood is used to calculate the effects of all neighbors of a particular tree on that tree s growth the annual growth increment is reduced by the fraction r fon where r fon is given by r f o n 1 2 f s a v e we can calculate the fs ave as follows first let r2 be the radius of the subject tree which we define convert from centimeters dbh to radius in meters r 2 d b h 200 m e t e r s it is assumed that there is a zone from an inner radius kr k r c 1 r 2 c 2 to an outer radius nr max given by n r m a x c 1 140 200 c 2 within which existing neighbors can have an effect on the subject tree assume that the radius of a given neighbor is in meters r 1 d b h n e i g h b o r 200 the distance di of each given neighbor of the subject tree along with r1 and kr is sent to the function fon di r1 kr to compute the degree of overlap and thus the potential shading effect from that neighboring tree every neighboring tree that is wholly within the inner radius kr is assumed to have full influence on the subject tree for neighboring trees outside of kr but within nr max the influence declines by the quantity f 0 1 d i k r r 1 which is computed within function fon di r1 kr this is done for each tree and the effect fon di r1 kr of each neighboring tree is added sequentially to determine the fs sum fs sum fon di r1 kr to arrive at a summation over all the neighboring trees then the average over the area zone of influence is computed fs ave fs sum pi kr 2 where the denominator pi kr 2 accounts for the size of the subject tree the larger the size the less influence of the neighbors on its growth it is finally assumed that if r fon 0 5 the growth increment dnc is set to zero submodel canopy extent for many trees the canopy of a tree tends to have an extend similar to that of the roots so we used an approximation of root extent from jiang et al 2012 to approximate the canopy extent this is calculated in a matlab function rootfrac an individual tree s root system can extend to several cells when the tree reaches a sufficiently large size and takes up water from these cells the fraction of root biomass per cell f x y is root biomass at one cell divided by total root biomass the root biomass in each cell is average of biomass at four corner points of cell at which integrated from the root lateral distribution f x y 1 4 i 1 4 b l i b r o o t root lateral distribution bl can be expressed as an exponential function of distance from the tree base l b l b 0 e β l where β is the attenuation rate of root density and b0 stands for the initial root density at the tree base b0 is calculated from komiyama et al 2000 komiyama et al 1987 b 0 b r o o t 2 π β 2 1 e β m a x l β m a x l 1 where max l is the maximum extension of the roots of a tree m a x l d 2 a h l b h l d 2 and where ahl and bhl are constants of the allometric relationship between maximum root extension and tree diameter the relationship between root biomass and tree diameter is given by an allometric equation komiyama et al 2008 b r o o t η c a b d b a b where broot is total biomass of the root system and η is the ratio of below ground biomass to above ground biomass the mangroves of florida have been recorded as accumulating large amounts of biomass in their roots castaneda 2010 so this ratio is high compared to that of upland forests cab and bab are constants of the allometric relationship between tree diameter and root biomass from the above relationships and the data on the position of the tree stem in continuous space the fraction of the canopy of each tree within 5 5 m spatial cells could be calculated appendix b here we elaborate on two observations that were made concerning some of the results described in the main text first it was noted in consideration of hypothesis 3 that the combination of biocontrol and strong litter suppression of native seedlings that long term coexistence occurred in which the continued spread of the invader was arrested but not reversed figure 6a this seems to be a situation that can be described as invader pinning e g keitt et al 2001 our simulations all started with invaders being a small cluster in the center of the plot the question arises a what would happen if both the invader and the native species were uniformly and randomly distributed various numerical ratios in response we have done sets of simulations to address this question a specific set of parameters close to those used in the simulations in figure 6a with relatively high litter suppression s i n v a s i v e l i t t e r n a t i v e 1 0 but with biocontrol initiated very early in the invasion year 5 was performed three cases of initial different numbers of invaders and native species were used and the results are as follows nnative 2000 ninvaders 500 in this case the invaders were excluded figure b1 nnative 500 ninvaders 2000 in this case the natives were excluded figure b2 nnative 2000 ninvaders 1200 in this case long term coexistence occurs over 1200 simulated years with no indication that one or the other species will be excluded figure b3 these results show that neither species can invade from small relative numbers which describes bistability when both species are initiated at large fairly similar numbers long term coexistence occurs this may be a long transient but effectively is appears that even in the case of uniform initial distributions of both species results analogous to invader pinning the second observation was the precipitous initial reductions in invader numbers that occurred immediately after imposition of biocontrol in figures 5a b c we proposed that the reason for the sharp initial decline was the fact that some degree of clustering of stems occurs so that density dependent effects caused some fraction of individual growth rates to be low even before biocontrol the additional slowing of growth due to the biocontrol pushed them below a threshold that made them highly vulnerable to mortality each yearly time step after this burst of mortality the invasive trees were thinned out such that the density dependent source of mortality was diminished and the other mortality sources dominated and were decisive in whether the invasive trees were controlled or not here we show the thinning out that occurred soon after the imposition of biocontrol which occurred in this simulation at year 80 figure b4 shows the spatial pattern of both native and invasive trees at this year while figure b5 shows the pattern 10 years after which shows a strong degree of thinning as suggested individual trees that were already stressed from high densities were vulnerable to mortality caused by the additions stress on growth produced by biocontrol the sharp thinning was followed by a decreased rate of mortality of invaders keitt t h lewis m a and holt r d 2001 allee effects invasion pinning and species borders the american naturalist 157 2 pp 203 216 
24457,many introduced plants pose invasion risks globally and threaten the biodiversity of native ecosystems such non native plants can become invasive when they have advantages over native plants such as having fewer natural enemies invasive plants often have the ability to alter ecosystem properties after they have become established which can make it difficult to eliminate the invasive in principle this can cause a regime shift that may not be reversed through intense control efforts that increase mortality and reduce growth of the invasive species here we use spatially explicit agent based modeling to simulate the invasion of an introduced tree species into a habitat occupied by a native species the model describes an invasive tree with fast growth and high seed production and in addition produces litter that has a suppressive effect on native seedlings these are properties for example shared by the invasive melaleuca quinquenervia in southern florida habitats we use simulation modeling to test the following logical hypotheses partial suppression of native tree seedlings by the invasive tree s litter 1 will accelerate the spread of the invasive tree into native vegetation 2 will impede efforts to control invasive spread through biocontrol and 3 can cause a regime shift that is not reversed even if the biocontrol lowers invasive growth and reproduction to levels substantially lower than those of the native species additionally 4 the earlier in the invasion biocontrol is introduced the more effective it will be in reversing the invasion the simulations support all four hypotheses while these results highlight the potential for biocontrol of invasive tree species our findings also suggest that successful elimination of positive litter feedbacks and invasive spread may critically depend on the timing of control efforts within the invasion process key words individual based model invasion dynamics regime shift litter accumulation biocontrol 1 introduction invasive plant species have been ranked as one of the most severe current threats to biodiversity rai 2015 ecologists studying invasions and trying to predict the possible spread of an introduced species need to understand the factors that make invasion by a particular non native species successful among the most commonly hypothesized factors for invasion success is that a non native species is likely to have few natural enemies in its new environment enemy release hypothesis keane and crawley 2002 if an invader is free of natural enemies it can allocate less energy for defense and more energy into growth and reproduction in fact a meta analysis on the performance of species both plants and animals shows that invasive species on average do better in terms of growth fecundity and abundance in favorable environments outside their native ranges parker et al 2013 other factors favoring invasion of plants may be physical disturbances to an invaded site and species attributes that allow them to exploit resources more efficiently than native plants collectively these advantages can result in successful invasion lake and leishman 2004 another important question is whether an invasive plant species will simply become a part of the existing plant community or whether it will become dominant and cause a complete change or regime shift in the community this possibility was investigated by gaertner et al 2014 in a meta analysis of 173 invasive plant studies their study showed that an invasive species can cause a regime shift by modifying the environment in a way that favors its own fitness in the environment over that of native species in that case the invader can create a self reinforcing or positive feedback loop once it gains a foothold in a new environment eventually replacing the native species that is being ecosystem engineers e g crooks 2002 cuddington and hastings 2004 eisenhauer et al 2009 gaertner et al 2014 identified five main mechanisms involved in feedback loops that can lead to regime shift two are of interest to our study the seedbank composition feedback and the litter feedback the first of these mechanisms refers to the high seed production of some invaders which can eventually overwhelm native species in recruitment the second refers to the production by some invasive species of large amounts of leaf litter that have a greater negative effect on native seedlings than on their own seedlings the fact that a thick litter layer can have a negative effect on seedling emergence has been observed in certain ecosystems facelli and pickett 1991 for example this can occur when an increased layer of spruce picea abies litter suppresses other species such as hazel corylus avellana whereas an increased hazel litter layer does not suppress seedling emergence and even has a positive effect on seedling growth koorem et al 2011 kaproth et al 2013 found that the invasive wetland grass phalaris arundinacea benefits from the high abundance of litter that it produces while eppinga and molofsky 2013 additionally found that the litter suppresses performance of native species experiments by kostel hughes et al 2005 showed that emergence of seedlings of small seeded trees such as betula lenta and liquidambar styraciflua decreased with increasing litter depth xiong and nilsson 1999 analyzed data from 35 independent studies on effects of plant litter on germination and establishment of plants showing variable but mostly negative effects another invasive species that has been shown to have negative effects on native seedlings is the tree melaleuca quinquenervia which is a successful invader in southern florida this species is in the family of myrtaceae and is commonly known as paperbark tree serbesoff king 2003 we will refer to the species as melaleuca hereafter melaleuca is a native australian tree species introduced into florida in the late 19th century for the purpose of pulp production and as an ornamental also it has the ability to lower the water table since it has a high capacity for transpiration chin 1998 which was felt useful in the everglades drainage project for preventing flooding bodle et al 1994 however melaleuca showed strong invasive tendencies throughout southern florida and spread over 200 000 ha in southern florida dray jr 2003 it has impacted ecosystems such as pine flatwoods freshwater marshes sawgrass prairies cypress domes hardwood hammock and buttonwood mangrove associations of southern florida by the end of the 20th century dray et al 2006 melaleuca is one of the invading species shown in the meta analysis of parker et al 2013 to show higher fitness in its invaded habitats than in its native habitats as noted above in addition to its potential for fast growth and high reproduction invasive melaleuca carries with it a feedback effect on the local environment that falls into the category of litter feedback identified by gaertner et al 2014 melaleuca produces a large amount of leaf litterfall that has a lower decomposition rate than much of the vegetation native to southern florida such as hardwood hammock species van et al 2002 southern florida has a subtropical climate such that litter decomposition is usually rapid and the accumulation of litter under local hardwood hammock is generally relatively small sampaio et al 1993 however melaleuca s leaf litter turnover rate of around 60 yearly finlayson et al 1993 though faster than native pine leaf litter is significantly slower than sawgrass marsh and native broadleaf tree litter thus litter accumulation of melaleuca on sites in southern florida is greater than that of other tropical species gholz et al 2000 rayamajhi et al 2010 rayamajhi et al 2012 demonstrated suppression of the emergence of native seedlings by melaleuca quinquenervia the seedling emergence of two species common in southern florida wax myrtle morella cerifera and sawgrass cladium jamaicense was compared to that of melaleuca seedlings under melaleuca litter rayamajhi et al 2012 the authors found that the litter had a much greater suppressive effect on emergence of seedlings of the other two species than on that of melaleuca seedlings the effect of litter on seedlings is possibly relevant to the invasion of melaleuca into southern florida communities to which it has caused damage over large areas because of the harmful effects of invading melaleuca by the end of the 20th century biocontrol agents were introduced to try to control its spread dray et al 2006 some introduced herbivores were effective in suppressing the melaleuca vegetation including the melaleuca weevil oxyops vitiosa pascoe and the psyllid boreioglycaspis melaleucae moore myers and bazely 2003 rayamajhi et al 2007 after application of biocontrol agents significant suppression of melaleuca has been shown notably the growth rate of plants has been reduced by at least 83 and the seedling survivorship reduced by 49 center et al 2007 the trend of decrease of melaleuca and gradual restoration to native vegetation has indicated that application of herbivores to suppressing melaleuca has been successful rayamajhi et al 2007 after years of the herbivore control agents coupled with chemical and mechanical treatment melaleuca is now considered under control in southern florida center et al 2012 although melaleuca now appears to be under control it is important to understand whether characteristics like melaleuca litter s suppression of seedlings might affect the rate of recovery of native vegetation our objective is to study through modeling of an invasive tree with the described characteristics of fast growth high reproductive rate and litter suppression of native seedlings is able to create a self reinforcing feedback that increases the invader s rate of spread and or makes reversal of the invasion difficult although it is not our intention to model melaleuca specifically which would require more precise parameter values than we have our study should provide some insights on the long term effects of biocontrol of a species with its properties we ask the general question of how litter suppression of native seedlings by an invader may speed up the spread of the invader and delay or even prevent the restoration of native vegetation through biocontrol alone we also examine whether the timing of application of biocontrol relative to the initial time of invasion matters in success of control the following hypotheses will be tested in a model hypothesis 1 the negative effect of melaleuca litter on native seedlings will allow the invader to spread faster from an initial point of invasion than if it had no effect on the native seedlings hypothesis 2 the negative effect of invader litter on native seedlings will make it more difficult for biocontrol on the invader to reverse the spread of the invader in the native vegetation hypothesis 3 if the negative effect of invader litter on native seedlings is great enough it will create a hysteresis effect that even very strong biocontrol effort will not easily overcome and thereby could result in a permanent regime shift unless biocontrol is complemented with other means of control such as mechanical removal hypothesis 4 the earlier in the invasion that biocontrol is introduced the more effective it will be in reversing the invasion to test these hypotheses we performed simulations using a spatially explicit agent based model representing an invasive and a native species we used a spatially explicit agent based model so that the mechanisms of individual tree growth reproduction seed dispersal mortality and spatial interactions including litter suppression of seedlings could be studied in a detailed way we performed simulation experiments or scenarios first the litter accumulation effect on seedling was simulated under different scenarios without biocontrol then biocontrol was added to the model and the biocontrol effectiveness was tested with both different assumed levels of litter suppression of seedlings and different biocontrol scenarios other factors were varied as well between the scenarios although our model was motivated by the interaction between melaleuca and native tree species such as hardwood hammock or pine flatwoods we do not have good enough estimates of all the parameters needed for such models therefore this is a theoretical study rather than an attempt to make predictions that can be used for any particular species ideally though the model presented can eventually be better parameterized and used in practical applications 2 methods spatially explicit individual based seib modeling is an approach that can be used for examining ecological phenomena at the level of individuals interacting in space grimm and berger 2016 note the term agent based is often used interchangeably with individual based we use seib modeling to describe the invasion of a native population of trees by a non native tree species or group of tree species that we represent as a single species an advantage of seib modeling is that many traits of individuals of the different species can be incorporated in the model including those related to spread and occupation of space which allows study of which traits are especially crucial for the success of one or the other species this study is theoretical but is designed to provide insights for the invasion of melaleuca in a stand of native tree species simplified to a one species population in southern florida because hardwood hammocks which consist of a number of tropical hardwood species are among the impacted habitat types we will sometimes refer to hammock as the native type although sawgrass wetland pine forest and cypress forest are also invaded we describe the model briefly using the overview design concepts and details protocol grimm et al 2010 2 1 purpose and patterns the modeling was conducted to understand the dynamics of two competing tree species an invader patterned after melaleuca and a generic species representative of trees native to southern florida the model describes the spatial dynamics of invasion of an initially pure stand of native trees our overarching question is how the suppression of native seedlings by the invader s leaf litter will counter the effects of biocontrol this question is addressed for different assumed strengths of litter suppression and different assumed times of initiation of biocontrol following invasion 2 2 entities state variables and scales the area of the plot simulated is 100 100 meters the model includes two basic types of entities first there are individual trees which are termed agents each of which is either an invader or a native tree individual trees are defined by age diameter at breast height dbh and spatial location following jiang et al 2012 tree height and leaf area are allometrically related to dbh the individual trees are distributed in continuous space that is they can be located at any point within the 100 100 m space and can have canopies covering up to a 5 5 set of 1 x 1 m cells the second entities are the heterogenous litter accumulations across the plot as individual tree canopies can overlap the contributions of each tree to the litterfall in a 1 x 1 m cell are summed to a total amount of litter deposition 2 3 process overview and scheduling all processes growth reproduction and mortality of individual trees as well as their litter production are modeled as discrete annual time steps growth of individual trees is a function of the effects of neighboring trees through the field of neighborhood fon approach described below and in appendix a of the supplementary information reproduction is assumed only for trees of either species greater than 20 years of age dispersal of seeds is assumed to decline with distance from the parent tree litterfall dynamics comprises the influx of litterfall and the outflux of litter decomposition 2 4 design concepts basic principles the theoretical purpose of the model is the assessment of biotic factors in particular litterfall and its turnover rate which can affect the emergence of seedlings of different vegetation types to different degrees and thus affect population and community dynamics emergent properties an ecotone between the two woody vegetation types is the key emergent property the expected output of the model is that ecotones which can be sharp or diffuse will form dividing the landscape into clusters of single vegetation types the suppression of seedlings due to litter accumulation may contribute to ecotone formation adaptation the species are adapted to their environment through their growth rates rates of reproduction seed dispersal distances and resistance to mortality in addition the invasive species produces litter that has a suppressive effect on the emergence of native seedlings no changes in the levels of these adaptive traits are assumed to occur over the time scales of the simulations objectives the objective of each tree type is to maintain itself and spread spatially biocontrol to attempt to control the invasive species is inserted into the simulation at a certain time after the start of the invasion and is assumed to continue at the same level indefinitely interaction the individual trees interact with each other locally depending on relative sizes and distance but with no difference between species in ability to compete for space and light as described by the field of neighborhood approach berger and hildenbrandt 2000 litter accumulation of the invasive species is assumed to interact with the establishment of seedlings of the native species but not vice versa stochasticity the production of seedlings and their locations are stochastic processes 2 5 initialization the initial spatial distribution of native tree individuals was set to approximate a typical tree distribution ranging from 1 to 80 years of age along with corresponding assumed diameters at breast height dbh across the 100 100 m plot a small number of invaders are initially scattered near the center of the plot which are uniformly randomly distributed in ages less than the age of maturity and all with corresponding dbh vs age values based on estimates from data on the tree species common lime and common ash in lukaszkiewicz and kosmala 2008 d b h d b h 1 d b h 2 a g e where dbh 1 is the intercept and dbh 2 is the slope all neighbors within 5 m of each tree were determined and put into a matrix called neibi so that their effects on growth through fon interactions could be determined no litterfall accumulation is assumed in the cells in the first year see table 1 for parameter values used the simulation was started when the oldest invasive tree had survived to 20 years of age because the invasion dynamics only really start when the invasive trees start to reproduce 2 6 input data input data were designed for a theoretical study rather than being fit to a specific empirical situation 2 7 sub models here we describe sub models of the model 2 7 1 growth the growth model is similar to earlier models developed for describing woody plant growth in agent based simulations e g botkin et al 1972 and is described in appendix a the growth model is the same for the two vegetation types except for the growth rate coefficient g see table s1 which is gnative 267 and ginvader 400 parameter g relates growth rate in volume of the tree to leaf area and is used to scale the relative early growth rates of trees of different species moore 1989 botkin 1993 when biocontrol was assumed to occur in the model it was assumed to reduce the growth rate of the invader by about 80 to ginvader 80 2 7 2 competition the field of neighborhood fon model berger and hildenbrandt 2000 is used to describe the effect of close neighbors on the growth of each other all neighbors within 5 m of each tree i were determined and put into a matrix called neibi so that their effects on growth through fon interactions could be determined this is done using the data on neighbors within 5 m of each tree stored in matrix neib the details of the fon are described in appendix a 2 7 3 litterfall and its accumulation the total annual leaf litterfall per tree lfi in kg y 1 is determined as an allometric function of dbh l f i c l f i 100 d b h b l w i where clfi and blwi are constants i invasive or native the parameters are estimated for melaleuca based on van et al 2002 native litterfall was kept track of in the model but because it was not assumed to have any effects in the model the coefficients were arbitrarily chosen with clfnative clfinvasive the computer code kept track of how much leaf litter from each tree falls annually in a particular 1 1 m cell and sums these for all trees part of whose canopy covers that cell for each species separately to do this the spatial extent of the canopy of each tree is first determined canopy extent is assumed to be the same as that of the rooting zone which is calculated allometrically from dbh the maximum extension of the radius of the roots is given in meters by m a x r t d b h 2 c 4 c 5 d b h 2 based on komiyama et al 2000 komiyama et al 1987 where c4 and c5 are constants that are the same for invader and native the rooting zone is assumed to cover a square of 1 1 m cells with each side of the square being the length of the radius this is also assumed to be the size of the canopy the total annual leaf litter of the tree is divided evenly among the cells as calculated in the function rootfrc m each cell receives input from all the trees whose canopies overlap that cell the function rootfrc m the details of which are described in appendix a returns to the main code the values of lfi jk the total yearly leaf litterfall of all trees of species i that have some of their canopy in 1 1 m cell j k the cumulative leaf litter depth of the invader is calculated using the equation l f a c c u m u l a t i o n t 1 1 k i l f a c c u m u l a t i o n t l f i j k t where ki is the yearly turnover rate see table 2 for parameter values used in the simulations here because only the litter of the invasive tree is considered in the model to suppress seedlings some parameter values are shown only for the invasive trees 2 7 4 reproduction in calculating annual reproduction a seedling production probability constant bratei i invasive or native is assigned which is greater for the invader than for the native species in the iteration over all trees greater than a certain age set arbitrarily at 20 years here the code specifies that each tree can produce an upper limit of nseedling limit viable seedlings each year with each seedling having the probability brate to survive in each iteration over the these nseedling limit chances a uniform random number between 0 and 1 rand is selected where survival occurs if rand bratei therefore each mature tree can produce anywhere from zero up to nseedling limit seedlings each year the low value of nseedling limit used here see table 3 takes into account the very low survivorship of seedlings 2 7 5 seedling dispersal the distance of dispersal of each seedling is a random variable assuming that propagule dispersal distances disperi follow exponential distributions with means 1 c3 i that differ between the species the distance dispersed from the parent tree for a given propagule can be calculated as a random variable d i s p e r i ln r a n d c 3 i for each tree i invasive or native from those radial distances the x and y coordinates of the new seedling are calculated assuming each direction from the parent tree is equally likely and the seedling is assigned and initial dbh of 1 cm only those propagules that land within the 100 100 grid are counted 2 7 6 litter suppression of seedlings next potential suppression of seedlings is calculated the invader litter accumulation lfaccumulation is known for the 1 1 m cell in which a given propagule has landed so the degree of suppression can be calculated l f b r a t e i e l f a c c u m u l a t i o n i s l i t t e r i where s l i t t e r i is a constant that measures the effect of litter of the invader on species i only invasive litter is assumed to have a suppressive effect and the effect differs for seedlings of different species we assume here that s l i t t e r i is not known and we examine the effects of a series of values a random number rand is chosen for each propagule if r a n d l f b r a t e i n v a s i v e then the seedling survives otherwise it does not emerge if it survives the new seedling is put into the neibi matrix that stores each tree s neighbors after its neighboring trees are determined see table 3 for parameter values used in the simulations here 2 7 7 mortality three types of tree mortality are included size dependent mortality mortality due to poor growth rate and density dependent mortality these are described as follows size dependent mortality m c 1 μ 1 μ 2 e μ 3 d b h mortality due to poor growth rate m c 2 μ 4 e μ 5 d n c where dnc is the increase in diameter at the current time step the diameter increase per year is determined in part by competition between trees within a certain distance as determined by the field of neighborhood submodel described in appendix 1 mortality due to density dependence m c 3 10 6 e μ 6 n d e n s i t y e μ 3 d b h where the mortality due to density dependence spatial crowding declines with size of tree there may appear to be some overlap of mc2 and mc3 but the ecological reasoning is that mc3 applies largely to very young trees that are close to the parent and die from lack of suitable growing conditions while mc2 may also correspond to older trees that may experience slow growth over a number of years that can eventually lead to death all of the µi values are constants and the same for both vegetation types ndensity is the number of adult neighbors with stems within a distance of 5 meters the values of ri differ for invasive and native trees as it is assumed that the invasive tree can tolerate higher density therefore mc3 differs for the two species then the total mortality rate is m c i m c 1 m c 2 m c 3 i see table 4 for parameter values used in the simulations 2 7 8 biocontrol insect herbivores were not simulated explicitly a constant effect level of herbivory on each invasive tree was assumed for our model we assumed reductions of growth rate of 80 from ginvader 400 to ginvader 80 and of reproduction of 80 from brateinvader 0 7 to 0 14 the effect on reproduction assumed here is greater than estimates in tipping et al 2008 for melaleuca we varied the timing of introduction of biocontrol tbiocontrol which was 100 50 or other year after the start of a simulation to summarize the invasive species has some advantage over the native species in growth rate reproduction rate seedling dispersal distance and its tolerance of crowding in addition the litter of the invader can suppress emergence of the native species biocontrol reduces growth and reproduction rates of the invader substantially below those of the native species 3 simulation scenarios simulations of scenarios were performed using matlab r2020a to test each of the proposed hypotheses related to litter suppression of seedlings and to biocontrol stated in the introduction the simulations performed are described within the descriptions of testing of each of the hypotheses below and then are summarized in table 5 in the simulations identical random number initiators were used such that initial tree locations ages and dbh s were the same for all runs to make comparisons of the simulations easier replicate simulations not shown using different random number initiators produced similar enough output to indicate that single simulations for each case were sufficient to demonstrate the effects of different scenarios 4 results before describing output related to the hypotheses we give an overview of the invasion dynamics in the absence of litter suppression of native seedling and of biocontrol without a suppressive effect on native seedlings i e s i n v a s i v e l i t t e r n a t i v e 0 the invasive species spreads from its initial 25 stems due to its higher rates of both growth and reproduction replacing the native species within 200 years figure 1 the invasive species reaches a density of about 1700 stems per hectare before being replaced by the invader while the invader which is slightly more tolerant of crowding reached over 2300 stems per hectare figures s1a s1f supplementary information show snapshots of all invasive and native trees from 20 to 120 years following the start of the simulation while figure s1g shows the size distribution of invasive trees at the end of the period although our invader is generic and does not try to simulate the invasion of melaleuca specifically it is interesting to compare densities of both tree stems and litter from the model with those measured in the field van et al 2002 estimated stem densities of melaleuca in six sites in southern florida as ranging from about 11 000 to 36 000 stems per hectare this is far greater than our simulations of close to 2500 stems per hectare van et al 2000 measured litterfall as ranging from 6 5 t ha 1 to 9 9 t ha 1 t is metric tons or 0 65 kg m 1 to 0 99 kg m 1 our simulations calculated accumulated leaf litter as shown spatially in figure 2 ranging up to values of slightly over 1 2 kg m 1 in a few spots but mostly in the range 0 to 0 8 an accumulated litter range of 0 to 0 8 kg m 2 corresponds to litterfall rate of 0 to 0 48 kg m 2 y 1 the higher values at some places on the boundary cells of plot are artefacts of the simulations because they do not change any of our results we did not redo our simulations to eliminate them thus our simulation values of stem density are substantially less than the empirical data on melaleuca but model output on litterfall resembles that measured in the field for melaleuca a possible explanation for the discrepancy in stem density is that the size distributions of melaleuca in van et al 2002 their table 2 is more skewed towards stems of small dbh than is our model s this indicates that our parameters regarding density dependence differ from those of melaleuca in any case our model must be considered only theoretical 4 1 hypothesis 1 we performed five initial simulations to test hypothesis 1 the invader was simulated to spread for 200 years without biocontrol five values of s l i t t e r o n n a t i v e were assumed with values of 1 10 20 50 and 200 1 kg m 2 which ranged from mild to very severe the invader s litter was assumed to have only a weak effect of 1 1 kg m 2 on its own seedlings all other parameters were the default values in the above tables the rate of spread can be shown to be roughly constant in time which approximates what is expected from fisher s equation for a population traveling wave it can also be shown that the rate of spread has some dependence on s l i t t e r o n n a t i v e figure 3 shows plots of the mean distance of invasive trees from the center of the plot as a function of time for five values of s l i t t e r o n n a t i v e 1 10 20 50 and 100 the calculated slopes from year 1 to year 80 are respectively 0 2341 0 2800 0 2745 0 2938 and 0 3588 showing a general increase of slope with strength of litter in suppressing the native seedlings this supports our hypothesis 1 that litter suppression can cause the speed of invasion to increase the method used here used averages of mean distance of the invader which has the disadvantage that fluctuations in density closer to the center of the plot could affect the curves and appears to do so other approaches would be to keep track of the distances of the forerunners of the invasion it can also be expected that rates of spatial spread will be positive functions of reproductive rate and mean seedling dispersal distance in order to confirm this additional simulations were performed with large ranges of each of the two parameters nseedling limit and c3 invader the first parameter affects reproduction the maximum potential number of seedlings produced by an individual tree in a given year in these simulations the maximum potential surviving seedling numbers ranged from 3 to 12 the second parameter controlling mean distance of spread of a seedling was c3 invader which is related to mean dispersal distance as d i s p e r s a l m e a n r a n d c 3 i n v a d e r in the sensitivity analysis the mean distances of spread ranged from about 2 5 to about 7 meters the results for the radial rate of spread as functions of these parameter are shown for a single simulation in figure 4 4 2 hypothesis 2 simulations that included biocontrol were performed to test hypothesis 2 that invader litter suppression of native seedlings will impede efforts to reverse invasion through biocontrol biocontrol was imposed starting at year 100 of the simulation and continuing with 80 reductions in both the maximum growth rate parameter g and in the parameter for seedling production brate three different values of s l i t t e r o n n a t i v e were assumed mild s l i t t e r o n n a t i v e 1 intermediate s l i t t e r o n n a t i v e 20 and severe s l i t t e r o n n a t i v e 200 levels shown in the three vertical panels of figure 5 it is clear that the litter suppression at least slows down the recovery of the native trees the severe effect on litter of s i n v a s i v e l i t t e r n a t i v e 200 level appears in figure 5 bottom to actually prevent the biocontrol from succeeding although this value of suppression may be unrealistically high 4 3 hypothesis 3 a simulation was performed to test hypothesis 3 for whether a high level of native seedling suppression could allow the invader to be maintained in the system despite biocontrol at the level of 80 reduction in both growth rate and reproduction simulation was run with biocontrol starting at year 50 and with s i n v a s i v e l i t t e r n a t i v e 200 1 kg m 2 the values of invader growth and reproduction under biocontrol g 80 and brate 0 14 are far less than the respective values of the native species of g 247 and brate 0 25 the simulation results shown in figure 5c from hypothesis 2 confirm that strong enough litter suppression effects can overcome that level of biocontrol even though the invasive species in reduced to a far lower stem density about 1500 per ha than without biocontrol 2300 per ha to test how earlier application of biocontrol might help alleviate this difficulty in overcoming the effects of litter suppression by the invader we made only one change from the simulation shown in figure 5 bottom that is we changed the time of application of biocontrol from year 100 to year 50 the results of a 1200 year simulation in figure 6 a show instead of clear success of biocontrol that the invasive species continued to expand and reached an apparently constant density coexisting with a lower density of native species a 1200 year simulation of course is only of theoretical interest but it shows that the simultaneous application of certain levels of biocontrol effects on growth and reproduction combined with strong native seedling suppression by the invader can lead to long term coexistence at a constant level of both species that the litter suppression of native seedlings is responsible for the continued persistence of the invader is seen from a further simulation in which the suppression effect is removed is seen in figure 6b in which the invader is gradually eliminated this is a further corroboration of hypothesis 3 assuming that a change from native dominance to coexistence can be termed a regime shift although it is possible that the state in figure 6b is long term transient this is investigated further in appendix b where it is shown that if both species are assumed initially evenly dispersed spatially and intermediate biocontrol is applied from the beginning the long term coexistence of invader and native species as shown in figure 6a is actually an intermediate state probably long term transient between two alternative table states one in which the invader cannot invade from low numbers relative to the native and the other in which the native cannot invade at low numbers relative to the invader 4 4 hypothesis 4 it was hypothesized that the time at which biocontrol was applied after the start of invasion was important in the effectiveness of control so three times of application of biocontrol following the start of the simulation early tbiocontrol 50 years intermediate tbiocontrol 75 years and late tbiocontrol 100 years were used the outputs in figure 7 a for 50 years and figure 7b for 75 years are compared with figure 6b 100 years in each case it is assumed s i l i t t e r n a t i v e 20 these results confirm the hypothesis that early application of biocontrol can substantially increase the effectiveness of biocontrol the results of the testing of all four hypotheses are summarized in table 5 5 discussion the simulation modeling tested four hypotheses hypothesis 1 proposed that litter suppression of native seedlings by the litter of invasive species would promote faster spread of the invasive species that hypothesis was supported the rate of spread of the invader differed among five simulations with different values of s l i t t e r o n n a t i v e figure 3 increasing strength of suppression further simulations showed that the rate of spread of the invasive wave increased as a function of parameters for reproductive rate and mean seedling dispersal distance figure 4 as expected from fisher s traveling wave equation hypothesis 2 that invader litter suppression of native seedlings would make it difficult to reverse the invasion was supported in figure 5a b in which the time scale for recovery of native vegetation is slower for a larger value of suppression figure 5 c shows that an extremely high value of suppression may make recovery impossible despite the fact that biocontrol causes growth and reproduction rates to be far lower in the invader than in the native species this figure also supports hypothesis 3 that proposes that a regime shift can occur in which a hysteresis effect can prevent native tree recovery appendix b explores a variation on the two species competition in which the two species are initially uniformly dispersed spatially in that case bistability clearly occurs figure 6 a shows that the regime shift could be toward long term stable coexistence of the two species in that case biocontrol prevents further expansion of the invader while the extreme litter suppression effect on the native species prevents it from moving into areas occupied by the invader this suggests that when an invader creates an environmental change that negatively affects the native as does litter suppression of seedlings in this case biocontrol by itself may not be sufficient to reverse an established invasion in such cases biocontrol would need to be supplemented by other control measures such as herbicide treatment to reduce the invasive species to a level that can be controlled by biocontrol experiments combining biocontrol with herbicide treatment have been carried out for both melaleuca and other invasive plants our modeling may help in their interpretation hypothesis 4 which proposed that earlier application of biocontrol promotes faster recovery of the native trees was supported the effect seen by comparing figures 7a b and 6b is dramatic as early application of biocontrol limits the seedling production of the invader once the invader is established its seedling production can overwhelm the native trees and slow any recovery through biocontrol therefore the litter suppression effect makes invasion difficult to reverse and there is some suggestion that a regime shift can occur but a regime shift is not inevitable and early application of biocontrol decreases the likelihood it needs to be kept in mind that besides suppression of native litter the invader was assumed to have another advantage over the native species in that its growth rate was slightly less affected by spatial stem density an advantage that was not affected by biocontrol see μ4 in the mortality submodel that property contributed to the invader s resistance to biocontrol and that should be studied further the invading species in our model was patterned after melaleuca which has greater litter production than native hardwood hammock as well as a greater effect of litter suppression on seedlings of the native species field studies have suggested that there is a significant difference in seed production of melaleuca in southern florida and in its original habitat in australia according to rayamajhi et al 2002 melaleuca produces eight times more seeds per individual in southern florida that could be a factor in why melaleuca had high seedling emergence despite its high litter production an additional factor is that even if the litter layer covers melaleuca seeds blocking them from sunlight one year these seeds remain viable up to two years after dispersing from their seed capsules woodall 1978 woodall 1982 hartman 1999 rayamajhi et al 2002 therefore melaleuca tends to be a litter tolerant species compared to native hardwood hammock this may be related to a suggestion by kortessis et al in review that plant species with greater litter production may also be more litter tolerant and thus tend to be more competitive in the ecosystem field results suggest that when melaleuca invades it outcompetes the native species and turns the community into a monoculture of melaleuca serbesoff king 2003 the preliminary results from our model mesh well with empirical studies which show that litter suppression on some native species increases when invasive biomass increases rayamajhi et al 2010 2012 in figure 5a where the litter suppression coefficient for native hardwood hammock is relatively small the invasion progress was reversed by biocontrol even when only started after 100 years unlike figures 5b c with their higher litter suppression in our model biocontrol exerts a density independent effect on growth and mortality that may or may not be true in nature where biocontrol agents could have a functional or numerical response to vegetation density however the effect of biocontrol on growth may contribute to the effect of an existing density dependent mechanism in the model high tree density leads to slower growth through the field of neighborhood submodel slower growth leads to increased probability of mortality through µ3 in the mortality submodel the slower growth of invader trees due to biocontrol contributes to that source of mortality one of the features of all simulations in which biocontrol was imposed whether or not the biocontrol ultimately succeeded was that there was an immediate sharp decline in the invasive trees the reason for the sharp initial decline was the fact that some degree of clustering of stems occurs so that density dependent effects caused some fraction of individual growth rates to be low even before biocontrol the additional slowing of growth due to the biocontrol pushed them below a threshold that made them highly vulnerable to mortality each yearly time step after this burst of mortality the invasive trees were thinned out such that the density dependent source of mortality was diminished and the other mortality sources dominated and were decisive in whether the invasive trees were controlled or not see appendix b supplementary information for output demonstrating the rapid thinning caused by the imposition of biocontrol there is an additional density dependent mortality in the model represented by µ4 in the mortality submodel that effect increases the mortality of trees that are close together within 2 5 m for native trees and 2 0 m for invasive trees and particularly affects seedlings or immature trees that are too close to larger trees and may be shaded although there may be some overlap of the effects of µ3 and µ4 may overlap to some degree we believe both are relevant in southern florida after introduction of the biological control agents melaleuca weevil oxyops vitiosa pascoe and the psyllid boreioglycaspis melaleucae moore significant suppression has been shown on the melaleuca in particular the growth rate has been reduced by at least 80 and the seedling survivorship reduced by 60 center et al 2007 with further evidence of the negative impact of herbivore agents on melaleuca vegetation in rayamajhi et al 2008 center et al 2012 in figures 7a b the seedling suppression effect was intermediate in strength and biocontrol was introduced relatively early 50 and 75 years respectively after the invader started reproduction the simulated control results turned out to be successful with less invading vegetation build up instead the vegetation mostly returned back to native vegetation because the biocontrol agents reduce the seed production and seedling survival rate a significant restoration result can be expected when applied early and at high enough strength to quickly stop the spread in this model we have only considered the effects of invader leaf litter suppression of native seedlings however leaf litter and its decomposition can have broader effects that are not considered here leaf litter decomposition is important to the nutrient cycle in the dynamics of plant soil interaction facelli and pickett 1991 evidence also supports that invasive plants can modify soil attributes including nitrogen cycling and microbiomes ehrenfeld 2003 some studies also suggest the modification of soil can facilitate the invasion process such as by suppressing native species or improving the invader s own fitness reinhart and callaway 2006 simberloff 2006 for example ellsworth et al 2004 found an invasive vine species is benefited by its denser litter layer which allows it to allocate nutrients that improve its survivorship future work may include more complex soil processes there are a number of limitations on this model one simplification was that the biocontrol agent was not simulated as a variable but only represented by reductions of reproduction and growth we are not able to consider every potential biotic and abiotic aspect that could impact the vegetation formation some of these will be considered in future work although this model we developed here is a theoretical model with accurate parameterization this model framework can be applied more explicitly to melaleuca invasion and perhaps more broadly extended to other invasive plant species author contributions designed the study y l d l d performed the simulations y l j x j j d l d wrote and revised the paper all authors declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that cdocould have appeared to influence the work reported in this paper acknowledgements we are grateful for useful comments of nicholas kortessis margaret simon amy kendig david kikuchi and michael barfield of the holt lab of the university of florida james grace u s geological survey maarten eppinga university of zürich and an anonymous reviewer dld and yl were supported by greater everglades priority ecosystem science program any use of trade firm or product names is for descriptive purposes only and does not imply endorsement by the u s government appendix a submodel tree growth each tree is assigned an initial tree diameter at breast height dbh dbhinvader dbhnative the code iterates over all trees and computes their growth the yearly increments are designated dncinvader and dncnative respectively for invader and native the yearly increment in dbh is then given by d n c i n v a d e r g i n v a d e r d b h i n v a d e r 1 d b h i n v a d e r h t i n v a d e r d m a x i n v a d e r h m a x i n v a d e r 1 274 3 b 2 i n v a d e r d b h i n v a d e r 4 b 3 i n v a d e r d b h i n v a d e r 2 r f o n d n c n a t i v e g n a t i v e d b h n a t i v e 1 d b h n a t i v e h t n a t i v e d m a x n a t i v e h m a x n a t i v e 1 274 3 b 2 n a t i v e d b h n a t i v e 4 b 3 n a t i v e d b h n a t i v e 2 r f o n where g i n v a d e r and g n a t i v e are growth rate constants and where tree height is calculated allometrically from dbh h t i n v a d e r 137 b 2 i n v a d e r d b h b 3 i n v a d e r d b h 2 h t n a t i v e 137 b 2 n a t i v e d b h b 3 n a t i v e d b h 2 submodel field of neighborhood method for calculating effects of neighbors next the field of neighborhood is used to calculate the effects of all neighbors of a particular tree on that tree s growth the annual growth increment is reduced by the fraction r fon where r fon is given by r f o n 1 2 f s a v e we can calculate the fs ave as follows first let r2 be the radius of the subject tree which we define convert from centimeters dbh to radius in meters r 2 d b h 200 m e t e r s it is assumed that there is a zone from an inner radius kr k r c 1 r 2 c 2 to an outer radius nr max given by n r m a x c 1 140 200 c 2 within which existing neighbors can have an effect on the subject tree assume that the radius of a given neighbor is in meters r 1 d b h n e i g h b o r 200 the distance di of each given neighbor of the subject tree along with r1 and kr is sent to the function fon di r1 kr to compute the degree of overlap and thus the potential shading effect from that neighboring tree every neighboring tree that is wholly within the inner radius kr is assumed to have full influence on the subject tree for neighboring trees outside of kr but within nr max the influence declines by the quantity f 0 1 d i k r r 1 which is computed within function fon di r1 kr this is done for each tree and the effect fon di r1 kr of each neighboring tree is added sequentially to determine the fs sum fs sum fon di r1 kr to arrive at a summation over all the neighboring trees then the average over the area zone of influence is computed fs ave fs sum pi kr 2 where the denominator pi kr 2 accounts for the size of the subject tree the larger the size the less influence of the neighbors on its growth it is finally assumed that if r fon 0 5 the growth increment dnc is set to zero submodel canopy extent for many trees the canopy of a tree tends to have an extend similar to that of the roots so we used an approximation of root extent from jiang et al 2012 to approximate the canopy extent this is calculated in a matlab function rootfrac an individual tree s root system can extend to several cells when the tree reaches a sufficiently large size and takes up water from these cells the fraction of root biomass per cell f x y is root biomass at one cell divided by total root biomass the root biomass in each cell is average of biomass at four corner points of cell at which integrated from the root lateral distribution f x y 1 4 i 1 4 b l i b r o o t root lateral distribution bl can be expressed as an exponential function of distance from the tree base l b l b 0 e β l where β is the attenuation rate of root density and b0 stands for the initial root density at the tree base b0 is calculated from komiyama et al 2000 komiyama et al 1987 b 0 b r o o t 2 π β 2 1 e β m a x l β m a x l 1 where max l is the maximum extension of the roots of a tree m a x l d 2 a h l b h l d 2 and where ahl and bhl are constants of the allometric relationship between maximum root extension and tree diameter the relationship between root biomass and tree diameter is given by an allometric equation komiyama et al 2008 b r o o t η c a b d b a b where broot is total biomass of the root system and η is the ratio of below ground biomass to above ground biomass the mangroves of florida have been recorded as accumulating large amounts of biomass in their roots castaneda 2010 so this ratio is high compared to that of upland forests cab and bab are constants of the allometric relationship between tree diameter and root biomass from the above relationships and the data on the position of the tree stem in continuous space the fraction of the canopy of each tree within 5 5 m spatial cells could be calculated appendix b here we elaborate on two observations that were made concerning some of the results described in the main text first it was noted in consideration of hypothesis 3 that the combination of biocontrol and strong litter suppression of native seedlings that long term coexistence occurred in which the continued spread of the invader was arrested but not reversed figure 6a this seems to be a situation that can be described as invader pinning e g keitt et al 2001 our simulations all started with invaders being a small cluster in the center of the plot the question arises a what would happen if both the invader and the native species were uniformly and randomly distributed various numerical ratios in response we have done sets of simulations to address this question a specific set of parameters close to those used in the simulations in figure 6a with relatively high litter suppression s i n v a s i v e l i t t e r n a t i v e 1 0 but with biocontrol initiated very early in the invasion year 5 was performed three cases of initial different numbers of invaders and native species were used and the results are as follows nnative 2000 ninvaders 500 in this case the invaders were excluded figure b1 nnative 500 ninvaders 2000 in this case the natives were excluded figure b2 nnative 2000 ninvaders 1200 in this case long term coexistence occurs over 1200 simulated years with no indication that one or the other species will be excluded figure b3 these results show that neither species can invade from small relative numbers which describes bistability when both species are initiated at large fairly similar numbers long term coexistence occurs this may be a long transient but effectively is appears that even in the case of uniform initial distributions of both species results analogous to invader pinning the second observation was the precipitous initial reductions in invader numbers that occurred immediately after imposition of biocontrol in figures 5a b c we proposed that the reason for the sharp initial decline was the fact that some degree of clustering of stems occurs so that density dependent effects caused some fraction of individual growth rates to be low even before biocontrol the additional slowing of growth due to the biocontrol pushed them below a threshold that made them highly vulnerable to mortality each yearly time step after this burst of mortality the invasive trees were thinned out such that the density dependent source of mortality was diminished and the other mortality sources dominated and were decisive in whether the invasive trees were controlled or not here we show the thinning out that occurred soon after the imposition of biocontrol which occurred in this simulation at year 80 figure b4 shows the spatial pattern of both native and invasive trees at this year while figure b5 shows the pattern 10 years after which shows a strong degree of thinning as suggested individual trees that were already stressed from high densities were vulnerable to mortality caused by the additions stress on growth produced by biocontrol the sharp thinning was followed by a decreased rate of mortality of invaders keitt t h lewis m a and holt r d 2001 allee effects invasion pinning and species borders the american naturalist 157 2 pp 203 216 
24458,repeatability in habitat use often termed site fidelity is widespread and ubiquitous often used habitat areas may be inherited by offspring in a phenomenon called natal philopatry leading to intergenerational repeatability in habitat preferences both fidelity and philopatry may represent strategies that could optimize fitness in spatially and temporally heterogeneous environments however the suite of ecological factors that encourage or discourage fidelity and philopatry remain poorly understood in most taxa while turtles order testudines exhibit both fidelity and natal philopatry when selecting nesting areas emerging evidence suggests that nest choice may be more plastic than previously thought however few studies to date have attempted to explore the behavioral choices that may produce deviations from nest site fidelity and philopatry we used a spatially explicit individual based model to explore how behavioral responses to a heterogeneous landscape can generate population level patterns of fidelity and philopatry we demonstrate that this model can dispersal patterns inferred from behavioral and genetic data from a blanding s turtle emydoidea blandingii population in central wisconsin reduced philopatry was associated with increasing error rates in habitat discrimination and reduced site fidelity was associated with decreasing risk tolerance unpredictable spatial distributions of risk increased natal philopatry but decreased site fidelity overall suggesting that strong natal imprinting may sometimes be associated with rapid shifts in habitat preferences in unpredictable environments associating risk exposure with increased adult or nest mortality led to increased nest site fidelity in both cases but with relatively weak effects on natal philopatry we also demonstrate the utility of this model for other landscapes and species by exploring a simplified seabird system our model holds promise for more detailed exploration of the ecological and evolutionary factors that may give rise to fidelity and philopatry keywords fidelity individual based model life history nest selection philopatry turtles 1 introduction repeatability in animal movements towards previously visited locations is widespread and ubiquitous bell et al 2009 richardson et al 2017 in its basic form this repeatability often and variously termed site fidelity switzer 1993 tenacity gratto 1988 and recurrence gonzalez et al 2008 involves biases in habitat use with locations often associated with crucial behaviors such as foraging nesting denning or shelter bell et al 2009 richardson et al 2017 switzer 1993 the ubiquity of site fidelity has led to a wide taxonomic representation of empirical studies on this subject including studies in primates boyer et al 2012 aquatic mammals pomeroy et al 2000 wolverines aronsson and persson 2018 turtles freedberg et al 2005 rowe et al 2005 sheridan et al 2010 birds hoover 2003 schlossberg 2009 and spiders hoefler et al 2006 in some cases these studies have found that consistently selected sites are sometimes inherited by offspring often termed natal philopatry suggesting the potential for intergenerational repeatability in habitat preferences greenwood 1980 stiebens et al 2013 valenzuela and janzen 2001 waser and jones 1983 this empirical work has coincided with the concurrent emergence of theories associated with the evolution of site fidelity richardson et al 2017 schmidt 2001 switzer 1993 in particular several studies have postulated that site fidelity is related to habitat predictability hoover 2003 switzer 1993 given the importance of habitat quality in driving reproductive success growth and survival dias 1996 freckleton et al 2006 root 1998 although see chalfoun and schmidt 2012 it is unsurprising that temporal variability in habitat quality has had documented demographic impacts adler and wilson 1987 tomimatsu and ohara 2010 in temporally variable environments selecting habitats based on past indicators of high habitat quality may not be a reliable means of maximizing fitness however such strategies termed win stay lose switch may be advantageous in more predictable environments campomizzi et al 2012 chalfoun and martin 2010 switzer 1993 in contrast high site fidelity may be a productive means of maximizing fitness in temporally unpredictable conditions potentially explaining the evolution of site fidelity more broadly hoover 2003 kokko et al 2001 schmidt et al 2010 switzer 1993 an interesting corollary to this is that although individuals are often expected to distribute themselves in space according to current availability of resources fretwell and lucas 1969 the realized distribution of individuals in space for organisms with high site fidelity may depend more on past experience of the habitat and past resource availability potentially resulting in lower or higher realized fitness than expected under ideal free distributions although these theoretical frameworks explain under what conditions site fidelity produces higher survival or fitness the exact means by which individual perceptions of habitat quality influence individual and population scale patterns of fidelity remain uncertain and largely unexplored kokko and sutherland 2001 kokko et al 2001 schmidt and whelan 2010 many studies into indicators of habitat quality have suggested that cues used are highly dependent upon the effects of habitat features on fitness components for example predator densities spencer 2002 food supply brown 1999 martin 1995 sergio et al 2003 and conspecific shared use citta and lindberg 2007 danchin et al 1998 fletcher 2007 have all been suggested as indicators of habitat quality for foraging sites in avian systems past reproductive success is a frequently observed cue used by birds to predict nesting habitat quality gjerdrum et al 2005 martin 1995 reproductive success is likely a particularly advantageous cue to use for assessing habitat quality due to its role as one sub component of fitness citta and lindberg 2007 danchin et al 1998 martin 1995 however evidence also suggests that the risk of injury or mortality for the adult is also utilized to assess reproductive site quality byer et al 2019 martin 1995 spencer 2002 in avian systems for example trade offs between adult mortality risk and reproductive site attendance whereby adult breeders only tolerate levels of mortality risk up to certain thresholds before abandoning reproductive sites have been frequently documented badyaev and ghalambor 2001 ghalambor and martin 2001 such tactics are often grouped under the classification of bet hedging reproductive strategies which broadly involve animals favoring future reproductive output at the expense of current reproductive output beaumont et al 2009 cunnington and brooks 1996 lips 2001 rollinson and brooks 2007 although a number of studies have provided empirical support for bet hedging strategies how such strategies manifest in patterns of habitat selection fidelity and philopatry remains poorly known beaumont et al 2009 cunnington and brooks 1996 lips 2001 rollinson and brooks 2007 nesting behaviors are critical to fitness in reptilian species and studies of reptilian nesting particularly those focusing on turtles have identified unique sets of trade offs associated with these behaviors many long lived reptiles follow a traditional bet hedging reproductive strategy often nesting in areas that minimize adult risk exposure byer et al 2019 spencer 2002 or foregoing energetic investment in current reproduction in favor of adult survival or growth rollinson and brooks 2007 accordingly in many reptile species and virtually all turtle species mothers immediately do not attend nest sites after nests are laid often retreating to wetland or non nesting habitat immediately after nest completion limiting the forms of maternal investment made into each clutch to more indirect forms brooks et al 1991 rasmussen and litzgus 2010 wallace et al 2007 thus many turtles have no means of directly assessing reproductive success associated with nest site choice instead selecting for a relatively narrow range of conditions expected to ensure successful nesting hays et al 1995 hughes and brooks 2006 kolbe and janzen 2002 mitchell et al 2013 when habitats considered suitable for nesting are spatially aggregated on the landscape nesting aggregations may form as documented in turtles lei and booth 2017 iguanas rand 1968 crocodilians woodward et al 1984 and many other reptilian taxa doody et al 2009 in addition many and perhaps most turtles exhibit site fidelity and natal philopatry whereby adult female turtles return to the same nesting area defined here as terrestrial areas with suitable substrate for oviposition used by multiple females and first time breeders often nest in the same patches where they hatched respectively e g carr 1975 lee et al 2007 rowe et al 2005 sheridan et al 2010 empirical studies do suggest that nesting behaviors by turtles can be plastic morjan 2003 refsnider and janzen 2012 and rates of dispersal by hatchlings and nesting adults between nesting areas may be low but non zero reid et al 2016a however while studies have explored the evolutionary role of natal philopatry and fidelity in promoting patterns of sex determination e g charnov and bull 1977 reinhold 1998 valenzuela and janzen 2001 the role of life history traits writ large in producing or disrupting fidelity and philopatry remains largely unexplored this is particularly true for taxa with slow life histories such as turtles as these systems often require extremely long field studies to effectively sample patterns of habitat use through time given these knowledge gaps there is a pressing need for studies that explore the complex interplay between animal life history and space use to explore how individual perceptions of risk in a heterogeneous environment can create emergent patterns of fidelity and philopatry we constructed a spatially explicit individual based model although site fidelity and philopatry presumably emerge from the interplay between species level life history traits and individual level behavioral choices very few studies have explicitly explored these emergent relationships in space and time to examine whether the model can realistically reproduce pattern of fidelity and philopatry we use the model to conduct a series of simulations patterned after nesting behavior in the blanding s turtle emydoidea blandingii a habitat specialist native to the northeastern united states ernst and lovich 2009 while this species is largely aquatic it also undertakes extensive terrestrial movements to reach nesting areas beaudry et al 2010 and adult females typically return to previously used nesting areas far from their home wetlands suggesting fidelity and possibly natal philopatry congdon et al 1983b recent population genetic studies have documented low but non zero rates of dispersal between nesting areas which may indicate greater plasticity in philopatry and fidelity than previously assumed reid et al 2016a we designed this model around observed patterns at sandhill wildlife area swa in babcock wisconsin and leverage long term behavioral demographic and genetic datasets associated with this site for creation and calibration of our individual based behavioral model byer et al 2019 reid et al 2017 2016a 2016b in particular variable rates of nest survival between nesting areas at this site reid et al 2016a and heterogeneity in temperature and mammalian predator density across the landscape byer et al 2019 likely indicate varying costs and benefits associated with choices of nesting areas beyond utilizing the model to explore natal philopatry and nest site fidelity in a broad sense we also used our model to address two theoretical questions a how is dispersal affected by increasing fitness costs associated with risk exposure b how does habitat predictability affect rates of dispersal furthermore while originally created for use with reptilian systems we also demonstrate the flexibility of this model by applying it to a simplified seabird system modelled largely on the marbled murrelet brachyramphus marmoratus overall we demonstrate that our model provides novel insights into how both the fitness costs and temporal predictability of risk can influence site fidelity and philopatry 2 materials and methods throughout this section we document model choices using the overview design concepts and details odd protocol grimm 2020 grimm et al 2010 2020 in addition we primarily describe parameterization of this model based on prior studies at swa and refer to several core nesting areas described previously reid et al 2016b a series of old fields around an elevated bluff site n two open quarries site q and a gravel road near an intensively managed oak barrens site b of note previous research at swa has indicated higher recruitment and a younger age structure for turtles at area b and attributed these demographic differences to habitat restoration in that area reid et al 2016b although we focus on swa for data analysis note that the model can flexibly accommodate user specified maps and in the absence of a provided raster map either user provided or included with model will generate a simplified landscape in addition users may also choose to run the model using a simplified seabird example described in more detail in sections 2 1 2 2 and 2 10 2 throughout the manuscript we follow reid et al 2016a by distinguishing between two forms of dispersal breeding dispersal or the movement of adult animals between breeding sites and natal dispersal or the movement of first time breeders to their natal breeding site reid et al 2016a in our model these dispersal rates are influenced by individual level risk exposure in the context of this model we define risk broadly as factors that cause stress injury or in extreme cases death for a particular animal this flexible definition allows the exploration of both sub lethal and lethal forms of risk exposure this model was created using netlogo version 6 0 1 wilensky 1999 and is available online see data availability section for access to model see fig 1 for a diagrammatical overview of the core model structure 2 1 purpose and patterns this model explores how population level patterns of natal philopatry and fidelity are influenced by habitat predictability and individual responses to perceived risk ultimately patterns of natal philopatry and fidelity are reflected in both the distribution of individuals across nesting areas and estimated breeding and natal dispersal rates between nesting areas additionally optional model components allow users to a adjust how risk affects nest and or adult survival b alter how risk is distributed across land cover types c adjust the vital rates and carrying capacity of the population of interest d modify dispersal distances associated with traversal to nesting areas e explore alternative and possibly custom habitat maps such as a simplified seabird system and f adjust error rates in natal habitat discrimination for first time breeders thus the optional extensions of this model are intended to explore a wide range of conditions that may produce deviations from nest site fidelity and philopatry and the spatial patterns that result from plasticity in habitat use we used several real world patterns in model development evaluation and qualification gallagher et al 2021 these patterns are detailed below organized into model development model evaluation and model qualification patterns 2 1 1 model development pattern 1 mean rates of breeding and natal dispersal during model development we used previously published rates of breeding and natal dispersal reid et al 2016a to ensure that simulation parameter values while often unitless could approximate mean rates of dispersal these parameter values were then used to inform appropriate ranges of parameter values in downstream model experiments and analyses although iterative simulation runs involved in model development are not summarized in detail in this manuscript the simulation experiments described in sections 2 8 and 3 1 illustrate combinations of risk thresholds and natal error rates that best approximate mean empirical dispersal rates 2 1 2 model development pattern 2 population level demography we also leveraged previous demographic analyses at this site reid et al 2016b to assure that survival and reproductive rates in the model approximated the finite rate of population growth calculated for this site λ 1 03 reid et al 2016b byer et al 2020 some aspects of animal demography including clutch sizes and juvenile survival were unknown and iterative calibration of the model to approximate empirical population growth rates allowed us to set appropriate defaults for these demographic parameters the survival parameter values set when pressing blanding s defaults represent parameter values that best approximated this finite population growth rate these survival estimates closely approximated those leveraged for previous spatially explicit demographic modeling efforts for this species byer et al 2020 2 1 3 model evaluation pattern 1 distances between home wetlands and nest sites in order to assess the plausibility of nesting dispersal movements in the model we extracted euclidian distances between selected nesting areas and home wetlands in this model and compared those estimates to previously reported distances between home wetlands and nesting areas for this species 100 2000 m congdon et al 2011 2 1 4 model evaluation pattern 2 area specific growth rates we extracted simulation based estimates of finite growth rates λ for simulated nesting areas to previously reported area specific λ for this landscape for core nesting sites n q and b λn 0 972 λq 1 010 λb 1 145 reid et al 2016b see fig 1 for representations of which simulated nesting areas corresponded to these core empirical nesting areas 2 1 5 model qualification pattern 1 seabird demographic rates and spatial trends a necessary stage of model creation involves model qualification which involves testing the accuracy of the model outside of the system s from which model development patterns were drawn in our case this meant exploring systems with differing spatial scales landscape configurations life history traits and dispersal patterns to this end we provide a landscape and set of parameter values intended to approximate site fidelity and philopatry in a simplified seabird system focusing on the marbled murrelet b marmoratus in order to create this simplified system we drew demographic and landscape parameter settings from published estimates of marbled murrelet demographic rates beissinger 1995 and previous studies that indicate highest risk associated with nest deposition and attendance beissinger 1995 divoky and horton 1995 2 1 6 model qualification pattern 2 seabird fidelity and philopatry in the simplified seabird system we explored how well the model can replicate published rates of natal philopatry and nest site fidelity expected for the marbled murrelet divoky and horton 1995 in brief this species is expected to show rates of breeding dispersal comparable to other alcids 0 06 divoky and horton 1995 hall et al 2009 and higher rates of natal dispersal relative to breeding dispersal divoky and horton 1995 2 2 entities state variables and scales the model comprises four hierarchical levels the individual the nesting area subpopulation the population and the environment state variables associated with individuals include identity number age dispersal distance size natal patch risk threshold current risk and home wetland preference as this model is female only sex was not included as a state variable breeding age individuals have the additional following state variables current nesting area preferences and previous nesting area preferences with the latter recorded for the sake of record keeping all following variables described are primarily discussed for the blanding s turtle specific implementation of this model however note that age structure and demographic rates can be manipulated by the user all individuals less than age 1 are considered hatchlings which have no breeding characteristics and reduced survival relative to other stages all individuals greater than age 1 but less than age 17 are considered sub adults which experience survival rates intermediate between the other two stages all individuals age 17 or greater are considered adults the only stage characterized by all state variables outlined above individuals age 17 or greater are separated further into first time breeders and repeated breeders with this classification dependent on the number of nesting events previously logged by that individual to simplify this classification animals at age 17 are considered to be first time breeders whereas animals at ages 18 and older are considered repeated breeders when individuals are not actively breeding individuals are distributed between wetlands across the landscape depending on home wetland preferences a nesting area subpopulation is comprised of all the individuals associated with a given area the spatial boundaries of nesting area subpopulations were delineated based on long term observations of nest placement collected between 2001 and 2017 and each nesting area subpopulation is characterized by the following state variables identity number characteristics of individuals associated with that patch and relative nest survival values for that patch females that are members of a particular nesting area subpopulation experience nest survival rates characteristic of that subpopulation the population is composed of the nesting area subpopulations delineated above along with turtles below breeding age the population is described by the total number of individuals compared to current carrying capacity k the proportions of stage classes represented proportions of individuals associated with each nesting area proportions of individuals moving between each combination of nesting areas and the current spatial distribution of individuals the highest level in the model is the abiotic environment this environment is simplified to include three land cover types that correspond to core habitat types associated with blanding s turtle nesting activities upland non nesting habitat upland nesting habitat with distinct nesting areas assigned unique nesting habitat identifiers between 1 and 30 and wetland habitat each patch is characterized by the following state variables risk level habitat classification with values 30 used to distinguish nesting areas and nesting area a binary variable coded as 1 for suitable nesting habitat and 0 for non nesting habitat types the spatial scales represented by the model are highly flexible and determined by the input map originally provided for the purposes of the default blanding s turtle specific landscape we use an input map that is 238 patches in the x dimension and 234 in the y dimension with a patch size of 30 m x 30 m in contrast the seabird landscape covers a much broader spatial extent for the intended study species the marbled murrelet patch size presumably covers several 100 m divoky and horton 1995 regardless of the spatial scales involved natal and breeding dispersal are always quantified based on philopatry and fidelity respectively to sets of nesting habitat patches with the same nesting area identification number thus animals may breed in different habitat patches but are not assumed to have exhibited breeding or natal dispersal in doing so if those different nesting habitat patches share the same identification number note that a user may provide a habitat map where each nesting area is given a separate nesting area identification number thus allowing for consideration of very fine scale breeding and natal dispersal between all habitat patches classified as nesting habitat however tracking such a large number of possible transitions between nesting areas would be difficult and likely cumbersome with the current model design in terms of temporal scales the model always proceeds by yearly time steps thus the model is best suited for species that are assumed to breed one time per year see fig 2 for depictions of the two default landscapes 2 3 process overview and scheduling the model proceeds in discrete yearly time steps within each year the following events take place in sequence survival aging repeated and first time breeder nest choice population growth calculation and risk exposure resampling for randomly sampled and random risk stability settings in brief and outlined in fig 1 each time step starts with animals surviving and dying based on random number generation any animals that survive then age by one year and if appropriate transition to new stage classes reproductively mature animals first time breeders and repeated breeders then select nests in different ways 1 first time breeders attempt to reach natal habitat areas but may nest elsewhere depending on natal error rates and 2 repeated breeders nest in their current nesting area choice but adjust this choice in following years if risk exposure is above their risk threshold hatchlings are then produced from nest locations set their initial wetland and nesting area preferences and move to wetland areas the model then calculates population growth by dividing current population size by previous population size finally depending on parameter settings associated with risk stability risk levels across the landscape are potentially resampled these processe are summarized in more detail in section 2 7 2 4 design concepts 2 4 1 basic principles model design is based on two primary areas of inquiry fitness trade offs during reproduction and repeatability in habitat utilization in unpredictable environments the first principle is based more broadly in the concept of life history trade offs which assume that energetic limitations require organisms to sub optimally balance survival and reproduction schluter et al 1991 stearns 1976 1989 in turtles and other long lived species this involves making choices that negatively impact current reproduction in favor of future reproduction often resulting in choices that maximize adult survival at the expense of reproductive success guiden et al 2019 spencer 2002 the second principle habitat fidelity and philopatry in unpredictable environments is based on empirical and theoretical work on how organisms select habitat to minimize unpredictability hoover 2003 schmidt et al 2010 sheridan et al 2010 switzer 1993 these two principles inform most aspects of model design but particularly the way in which turtles select breeding habitat turtles that experience risk above their tolerance threshold will choose to nest in different patches in the future aligning with expectations of risk minimization for long lived organisms under life history theory in tandem unpredictability in habitat preferences will ultimately produce nesting preferences that minimize unpredictability between years in addition optional settings invoke more severe fitness costs associated with risk and habitat unpredictability which are expected to produce stronger demographic and behavioral feedbacks with emergent patterns of nesting area choice the model is ultimately intended to provide novel insights into the interplay between behavior habitat unpredictability and life history traits in producing nesting area preferences 2 4 2 emergence individual behaviors in the model are largely imposed by two simple behavioral rules followed during nesting a first time breeders are assigned a random decimal between 0 and 1 and only nest initially in natal patches if this number is higher than the natal error rate and b repeated breeders sample risk around their selected nest sites each year and switch nest sites the following year if this sampled number exceeds their risk threshold while these rules are quite rigid and imposed by the model code other aspects of the model are emergent individual nesting area preferences population level dispersal rates and frequencies of population level patch preferences are modelled as emergent consequences of demographic behavioral and landscape settings population level breeding dispersal rates represented as the proportion of repeated breeders that nest somewhere other than their previously used nesting area in a given year and emerge from individual behavioral decisions to shift nesting preferences when exposed to risk in a similar fashion natal dispersal is the proportion of first time breeders that nest somewhere other than their natal patch and emerges from individually sampled error rates in natal habitat discrimination demographic rates in contrast are initially user defined and imposed upon individual level survival and reproduction but optional model settings allow users to impose varying degrees of demographic sensitivity to risk across the landscape 2 4 3 behavioral adaptation individual behavioral adaptation primarily takes the form of several simple rules that impose adaptive nesting habitat preferences all individuals initially prefer to nest in their natal patch when individuals reach sexual maturity they attempt to nest in their natal patch with a certain probability natal error rate that they will fail to find their natal patch if they fail to find their natal patch they instead nest in a random nearby patch but proceed as normal otherwise in this way initial nesting habitat preferences have a random chance of being adjusted due to random error in contrast repeated breeders always breed in their preferred patch regardless of quantified levels of risk around nesting areas however they switch to a random nearby patch if the sum of risk in the eight neighbor area around their current nesting location is above their risk threshold defined as the level of risk that an animal can tolerate before shifting habitat preferences and or experiencing survival effects although individuals do not actively select for habitat that minimizes risk repeatedly switching nesting habitat is expected to gradually lead to nesting habitat preferences that expose individuals to less risk additional optional settings allow for stronger demographic feedbacks between risk and adult and or nest survival providing stronger pressures for individuals to nest in low risk areas 2 4 4 learning and prediction no explicit learning is incorporated into the model agents make choices about future nesting behaviors based on current conditions in this way agents assume that current conditions are indicators of future conditions while individuals do not act to reduce risk during nesting excursions increase adult survival or maximize nest survival per se individuals do avoid repeatedly nesting in areas with high risk in this way the population gradually begins to nest in patches with lower risk through time 2 4 5 sensing individuals are always aware of their preferred wetland area their preferred nesting area and their natal nesting area individuals do not actively sense nesting behavior of conspecifics thus density effects in nesting areas are not considered individuals are also able to sense risk in the eight neighbor area around their current location and make decisions based on this level relative to their risk threshold turtles rely largely on sight when sensing risk during nesting excursions and have relatively poor visual capabilities spencer 2002 thus while alternative buffer areas for risk assessment were possible the eight neighbor area around each animal provided a compromise between biological realism and analytical convenience 2 4 6 stochasticity many aspects of the model are fully or partially random first individual level probabilities of survival each year are sampled randomly and compared relative to set demographic rates as this is a common approach for sampling individual level demographic parameters morris and doak 2002 second adjustments in nesting preferences are random to a certain extent with individuals selecting alternate nesting areas within set dispersal distances this was appropriate because turtles have no means of directly assessing nest survival probability in any given nesting area brooks et al 1991 rasmussen and litzgus 2010 wallace et al 2007 third optional settings associated with predictability of risk impose either random resampling of landscape level risk values within normal distributions around provided risk parameter settings or entirely random risk values across the landscape given the preponderance of studies that explore the effects of stochasticity on site fidelity and philopatry this was deemed an appropriate means of exploring this aspect of model behavior hoover 2003 kokko et al 2001 schmidt et al 2010 switzer 1993 2 4 7 collectives and interaction there are no collectives in the model 2 4 8 observation the primary data outputs from the model involve summaries of dispersal rates and patch preferences patch preferences are calculated at each yearly time step as the total count of all individuals with particular nesting area preferences through time breeding dispersal rates are calculated as follows number of experienced breeders with current nesting area preferences that are not equivalent to previous preferences divided by total number of experienced breeders natal dispersal rates are calculated as follows number of first time breeders with current nesting area preferences that are not equivalent to their natal patch divided by total number of first time breeders these two definitions are in line with previous studies at this focal site reid et al 2016a 2 5 initialization after launching the model users should first decide upon which landscape they might choose to use the model provides substantial flexibility for setting initial landscape conditions however suggested default settings can be assigned by clicking either blanding s defaults or seabird defaults and using one of two default landscape settings with either blanding s maps or seabird map the blanding s defaults are meant to replicate empirical relationships documented for this focal area reid et al 2016a 2016b if users have their own map they may click load your own patches to upload that map at present the model assumes that nesting patches are assigned unique values from 1 to 30 with varying values indicating different nesting area identities wetland patches are assigned unique values greater than 30 and all other habitat is assigned 0 for the sake of simplicity model initialization will be discussed based on the blanding s default settings upon hitting the setup button several cleanup functions are called to clear plots patches and turtles from memory next the model checks for the presence of an input map classifies habitat patches as nesting wetland or upland habitat see input data and assigns risk values to each land cover type default settings assign risk levels of 1 for wetland patches 5 for nesting areas and 10 for upland patches a number of turtles default 200 are then created equal to a user assigned value since repeated breeders are defined by their previous experiences during nesting we assume that any turtles at model initialization are breeding for the first time thus only first time breeders sub adults and hatchlings are created at mode initialization all turtles are then distributed into random wetland patches set their wetland preferences to that patch are assigned a natal area and set their dispersal distance to the user specified value default 60 patches note that this dispersal distance is arbitrary with units scaled directly to the extent of the provided input map as with other features this dispersal distance can be customized flexibly each turtle then sets its age randomly within ranges that depend on its assumed stage ages 18 30 17 3 16 and 0 2 for repeated breeders first time breeders sub adults and hatchlings respectively and sets preferred nesting area to its natal patch 2 6 input data the model does not use dynamic input data 2 7 submodels the model is split into several core sub models or steps in model iteration that implement in order upon executing the go command these sub models are survival aging repeated and first time breeder nest choice and nest survival population growth calculation and risk exposure sampling for randomly sampled and random risk stability settings we describe each sub model below and detail these model parameters in table 1 2 7 1 survival under default settings for each individual in each stage class a random decimal between 0 and 1 is sampled if this number exceeds or equals that stage s user set survival number then that individual dies otherwise that individual continues to live optional settings allow survival rates to be risk sensitive for first time breeders and repeat breeders under these settings as in the repeated breeder component of the nest choice and survival sub model described below individuals assess the cumulative risk of the eight cell neighborhood around their currently occupied patch at the start of this sub model if cumulative risk exceeds an individual s risk threshold a similar sampling procedure to that described above is used but with adult survival reduced by a fixed value the optional risk sensitive survival setting also affects processes during the repeated breeder and first time breeder nest choice and movement sub models as well see below 2 7 2 aging and initial movements after the survival sub model turtles age and transition into new stages first turtles age by adding one to their stored age value then individuals classified as first time breeders check if their age is greater than or equal to one plus the user specified age of adult maturity in our case age of maturity is 17 years if so those individuals transition to become repeated breeders since sub adult movement is not simulated in any other sub model and random movement may represent a means with which animals delineate available habitat zollner and lima 1999 morales and ellner 2002 sub adults first move to a patch in a radius equal to dispersal distance size divided by 10 assuming that sub adults move shorter distances overall than adults pappas et al 2009 and then check if their age is greater than or equal to 17 if so they transition to becoming first time breeders finally hatchlings move in a radius equal to dispersal distance size divided by 20 reflecting more limited dispersal capabilities for this stage then check if their age is greater than or equal to 2 if so that individual transitions to the sub adult stage finally repeated breeders check if their age is greater than or equal to 70 if so those individuals die 2 7 3 risk exposure sampling since users have freedom to set risk stability settings between the options of stable sampled risk or random risk the model recalculates risk values for each patch for random draw and random risk stability settings for the sampled risk setting risk for each patch is sampled at model setup and at the end of each year from a normal distribution with sd 2 around each land cover specific risk value for the random risk setting risk is sampled from between the values of 1 and 80 for each patch regardless of land cover type 2 7 4 nest patch choice dispersal and nest survival as detailed above strategies associated with nesting events differ between first time breeders and repeat breeders which represent different processes leading to natal and breeding dispersal first time breeders attempt to reach their natal patch but have a user specified natal patch discrimination error rate repeated breeders in contrast first consider where they nested previously and move towards the nearest patch with that nesting area id once repeated breeders reach that patch they assess risk in their eight cell neighborhood and choose to maintain the same nest patch preference for the next year or select another nesting area if risk is greater than their tolerance of risk risk threshold and their current preferred patch is not where they were born their natal patch they move back to their natal patch this makes the assumption that repeat breeders remember where natal patches are which is likely realistic given reid et al 2016a if risk is greater than risk tolerance and animals currently prefer their natal patch they select a random nest patch within dispersal distance for future nest preferences if risk is less than risk tolerance patch preferences remain unaltered regardless of classification as repeated or first time breeder nest survival is then drawn from 0 to 1 randomly at this point three options are provided for nest survival if nest survival mode is set to base then if there are fewer turtles than carrying capacity k and the random number for nest survival is less than the provided nest survival rate then 8 hatchlings are born if there are more turtles than k then no hatchlings are born if nest survival mode is set to risk sensitive then nest survival is reduced by the user defined nest risk penalty when cumulative risk is greater than the turtle s risk threshold this assumes that risk affects nest choice and adult perception of risk and nest survival in similar ways finally if nest survival mode is set to empirical then the user provided nest survival value is overridden by patch specific nest survival rates derived from empirical data at sandhill wildlife area n w byer unpubl data when hatchlings are born they record their natal nesting area set a random wetland patch nearby as their preferred wetland and temporarily remain at that patch 2 7 5 population growth calculation population size is recorded at two points within each yearly step at the beginning of the year representing pre survival and aging population counts and at the end of the year representing post survival aging and breeding sub model population counts population growth rate λ for each year is then calculated as follows λ end of year population count beginning of year population count 2 8 initial experiments and demonstrations of model behavior before leveraging the model to address specific ecological questions we first explored model behavior with several interactive simulation experiments the first set of three simulation experiments was designed to explore the behavior of the model when risk threshold and natal error values were varied the first such experiment involved varying risk threshold values between 0 and 100 in increments of 5 and extracting breeding dispersal rates natal dispersal rates and frequencies of patch use for each time step for each simulation this experiment was designed to explore a the way in which breeding dispersal is affected by risk threshold values and b any potential unanticipated effects of risk threshold values on natal dispersal estimates the second experiment in contrast involved varying natal error rates between 0 and 1 in intervals of 0 05 while holding all other parameters constant this experiment was designed to explore a the way in which natal dispersal is affected by natal error rates and b any potential unanticipated effects of natal error rates values on breeding dispersal estimates third we ran an experiment where natal error rates and risk thresholds were varied simultaneously across the ranges and increments of parameter values described above intended to explore how simultaneous shifts in natal error rates and risk thresholds influenced breeding and natal dispersal rates we set up each of the experiments in behaviorspace and ran five replicates for each parameter combination 2 9 model selection we then tested a suite of models related to targeted theoretical questions using a full factorial design intended to explore combinations of all parameters of interest in order to ease computational burden associated with parameter exploration we did not explore full parameter space instead we chose between two and five levels for parameters of interest producing a total of 1728 parameter sets and 8640 runs total we extracted yearly results first and then filtered further to consider only the final year of each run we used nl get step result to extract values for breeding dispersal natal dispersal and nesting area frequencies for each year we then filtered this dataset to the final year 300 results for each run we then used several a priori designated subsets of this full factorial dataset for the following analyses a consideration of how fitness costs associated with risk in the form of decreased nest survival and or adult survival create emergent shifts in breeding and natal dispersal and b how imposing instability in habitat characteristics affects patch preferences breeding dispersal and natal dispersal for these analyses we filtered the full factorial simulation dataset to include only parameters relevant to each analysis table 1 and formulated model statements a priori that explored the factors of interest supplementary materials s1 for top beta regression models we provide 95 confidence intervals cis around parameter estimates β for multinomial models we provide 95 cis around odds ratios or 2 10 model evaluation and qualification 2 10 1 model evaluation we then designed a series of small experiments to evaluate model accuracy relative to the model testing patterns secondary patterns gallagher et al 2021 described in section 2 1 first we used output from the simple experiments described in section 2 8 to determine parameter combinations that would be best calibrated to reproduce our primary empirical patterns after doing so we ran 200 simulation runs with these parameter settings for each time step we extracted the following information a distances between an animal s home wetland and nesting areas in each time step and b patch specific finite population growth rates each of these output values correspond to quantitative empirical patterns assessed by previous studies of this species for instance previous nesting studies have indicated that blanding s turtles typically move 100 m to 2000 m during nesting excursions which provides a point of comparison with distances between wetlands and nesting areas in the simulation congdon et al 2011 similarly patch specific growth rates have been intensively studied at this study site and indicated rapid population growth for area b stable population size for area q and population declines for area n reid et al 2016b 2 10 2 model qualification in order to qualify model performance we performed a final interactive experiment with the simplified seabird system described in sections 2 1 2 2 and 2 5 while this model could be broadly applied to other seabird systems as well the wealth of data available for the marbled murrelet meant that many empirical patterns were based at least in part on this system beissinger 1995 divoky and horton 1995 first we used an initial set of empirical patterns model qualification pattern 1 see section 2 1 drawn from prior publications to optimize demographic and landscape parameters that could reasonably approximate those observed in the marbled murrelet beissinger 1995 we then iteratively set other parameters based on prior empirical studies of natal and breeding dispersal in this species model qualification pattern 2 we limit our analysis to descriptive model behavior under these parameter settings 3 results 3 1 initial experiments and demonstrations of model behavior when all other covariates were held constant increasing risk thresholds led to exponentially decreasing breeding dispersal rates with no observed breeding dispersal past a risk threshold of 70 in contrast increasing risk threshold alone had no directional impacts on natal dispersal rates when natal error rates were increased independently natal dispersal rates increased in a linear fashion unexpectedly increasing natal error rates also produced slight increases in breeding dispersal rates as well when natal error rates and risk thresholds were increased simultaneously outcomes were generally like those described previously as well fig 3 3 2 model selection 3 2 1 consequences of risk associated fitness costs the top model for breeding dispersal included risk associated costs for adult survival risk associated costs for nest survival and risk thresholds risk sensitivity in adult survival dramatically reduced breeding dispersal rates βrisk sensitive adult survival 0 808 95 ci 1 356 to 0 260 as did risk sensitivity in nest survival βrisk sensitive nest survival 0 559 95 ci 0 0144 to 1 103 in contrast although two models were competitive for explorations of effects on natal dispersal only one variable had confidence intervals not overlapping with zero in either model risk sensitivity in nest survival supplementary materials s2 βrisk sensitive nest survival 0 542 95 ci 0 115 to 0 968 furthermore the model that considered only risk sensitivity in nest survival did not explain substantially more variation than the null model thus fitness consequences associated with risk exposure appear to lead to reduced dispersal rates in experienced breeders but not necessarily in first time breeders fig 4 3 2 2 habitat predictability and dispersal simulations that explored effects of habitat stability on dispersal and patch use suggested shifts in dispersal behavior under unpredictable conditions the top model for breeding dispersal included effects of risk stability settings and risk thresholds supplementary materials s2 in this model increased risk tolerance led to lower breeding dispersal rates βrisk threshold 0 010 95 ci 0 014 to 0 006 furthermore fully stochastic risk stability settings led to increased breeding dispersal rates βrandom risk 1 375 95 ci 0 0942 to 1 808 whereas patch settings based on random normal sampling around user supplied land cover risk values did not substantially increase or decrease breeding dispersal βsampled risk 0 012 95 ci 0 396 to 0 420 in contrast the top model for natal dispersal included effects of risk stability and interactions between risk thresholds and natal error rates supplementary materials s2 this model indicated increased natal dispersal with increasing natal error rates βnatal error 1 922 95 ci 0 403 to 3 441 and with simultaneous increases in risk thresholds and natal error rates βinteraction 0 025 95 ci 0 002 to 0 048 however the independent effect of risk threshold had confidence intervals that overlapped with zero βrisk threshold 0 005 95 ci 0 004 to 0 014 in addition fully stochastic patch stability settings substantially reduced natal dispersal rates βrandom risk 0 63 95 ci 0 971 to 0 282 whereas sampled risk values did not substantially alter natal dispersal βsampled risk 0 180 95 ci 0 155 to 0 515 thus habitat instability led to divergent effects on first time breeders and repeated breeders with first time breeders responding to instability by reducing natal dispersal and repeated breeders responding by increasing breeding dispersal fig 4 the same top model for natal dispersal best explained patterns of nesting area dominance supplementary materials s2 for the site b vs n comparison higher risk thresholds led to a higher probability of dominant use of site n orrisk threshold 1 077 95 ci 1 033 to 1 121 while simultaneous increases in risk tolerance and natal error rates led to dominant use of site b orinteraction 0 847 95 ci 0 769 to 0 934 however independent effects of natal error rates had confidence intervals that overlapped with one ornatal error 0 023 95 ci 0 to 2 784 for this same comparison fully stochastic or sampled risk values tended to favor dominant use of site b orrandom risk and orsampled risk 0 001 although site b was still favored under more stochastic settings for the b vs q comparison orrandom risk and orsampled risk 0 001 other parameter estimates differed from the b vs n comparison higher risk thresholds tended to favor use of site b over q orrisk threshold 0 001 whereas higher natal error rates favored site q over n ornatal error 100 several general conclusions can be drawn from these models a site b is favored when habitat conditions are unpredictable b site n appears to require the highest risk thresholds for consistent use suggesting that it is likely riskier than other nesting sites and c site q appears to be used most frequently when natal error rates are high likely because of its central position in the study landscape fig 5 3 3 model evaluation and qualification 3 3 1 model evaluation model evaluation simulations indicated concordance between model evaluation patterns and model behavior first the average simulation based nesting excursion distance was 51 78 patches given that patches for the default input map were 30 m x 30 m this equates to an average distance of 1553 m range 1379 1796 m these distances are well within those previously reported for this species 100 m to 2000 m congdon et al 2011 in addition distributions of estimated finite population growth rates for previously studied core nesting areas generally included mean and 95 confidence intervals around field estimates reid et al 2016b the main exception was for site b for which field based growth rates were noticeably larger than simulation based estimates however simulations correctly estimated higher population growth rates for this site relative to other sites indicating that core empirical trends were recovered by the simulation fig 6 3 3 2 model qualification although not a subject of detailed study we used model qualification patterns i and ii to guide creation of a simple seabird simulation system fig 1 after setting default seabird system parameters to mirror marbled murrelet demography and ecology we ran a small subset of simulations to explore model behavior with varying risk thresholds and natal error rates table x as with the blanding s turtle model risk thresholds at 60 or above appeared to produce low but finite rates of breeding dispersal range 0 01053 0 02105 although slightly lower than rates of breeding dispersal calculated for marbled murrelets previously 0 06 this likely represents a promising set of initial parameters for more detailed exploration in a similar fashion natal dispersal behaved predictably with increasing natal error rates increasing linearly with increasing natal error rates given uncertainty in natal dispersal rates for this species this model represents a promising tool for exploring the spatial and demographic consequences of varying natal dispersal conditions 4 discussion our study integrates detailed field information prior population genetic analyses and in depth knowledge of life history and demography into a spatially explicit individual based simulation of nest patch selection in the blanding s turtle although previous simulation studies have incorporated habitat fidelity or philopatry metsaranta 2008 schmidt 2004 wang and grimm 2007 most of these models have primarily been focused on ecological factors other than fidelity or philopatry explicitly unlike these previous efforts our model focuses explicitly upon two forms of dispersal shaped by habitat fidelity and philopatry a natal dispersal defined as animals deviating from natal philopatry by nesting in areas other than where they were born and b breeding dispersal defined as animals deviating from habitat fidelity by nesting in different areas between years reid et al 2016a furthermore we explore how plasticity in natal philopatry and habitat fidelity may be influenced by the following factors a threshold dependent risk avoidance with risk envisioned primarily as that imposed by the presence of predators on the landscape byer et al 2019 b errors in habitat discrimination c demographic consequences of risk exposure and d temporal unpredictability and instability in risk our simulation results coupled with the observed empirical patterns of nesting area use at swa suggest that turtles and other long lived species with limited maternal investment are relatively tolerant of risk and accurate in natal habitat discrimination furthermore connecting risk exposure to reduced adult and nest survival increased habitat fidelity and reduced breeding dispersal whereas unpredictability in habitat features led to increased natal philopatry or decreased natal dispersal and reduced habitat fidelity or increased breeding dispersal we discuss each of these findings in more detail below 4 1 initial explorations of model behavior initial simple experiments focused on exploring the behavior of the model with varying risk thresholds and natal error rates conveniently these simulations also allowed for illustration of dispersal rates relative to model development pattern i model settings that successfully reproduced previously documented breeding and natal dispersal rates revealed several general insights into risk tolerance and habitat discrimination many of which are supported by previous studies of turtles and other long lived species first mean breeding dispersal rates for our focal field site were only recreated at relatively high risk threshold values in a narrow portion of parameter space around approximately 92 suggesting that adult turtles are relatively insensitive to risk overall however non zero rates of breeding dispersal indicate that this insensitivity is not absolute as with several empirical studies of freshwater turtles byer et al 2019 spencer 2002 threshold dependent responses to predator activity as a proxy for risk may be critical for ensuring that females survive nesting attempts although units associated with risk thresholds and risk levels are relative and arbitrary in our study we consider this range of risk thresholds to represent relative positions upon life history gradients associated with risk tolerance with potential for simulating and estimating potential breeding dispersal rates in other species based on hypothesized risk tolerance levels for example turtles with lighter physical protection may be expected to be more likely to abandon habitats and thus more likely to exhibit higher breeding dispersal rates for example the softer shells of many trionychids soft shell turtles are typically associated with a number of behavioral differences between trionychids and other turtle groups scheyer et al 2007 thus we believe that our model may hold promise for characterizing relative risk tolerance for any species for which breeding dispersal rates are known in contrast low but nonzero 10 9 error rates in discrimination are also in line with previous findings as well most turtles show high degrees of philopatry in nesting attempts often returning to within several meters of nesting areas between years janzen and morjan 2001 lee et al 2007 limpus et al 1984 sheridan et al 2010 however the factors used to discriminate natal from non natal habitat are still uncertain and vary among taxa for example salmon have been found to primarily use olfactory cues when finding natal waters dittman et al 1996 hasler et al 1978 whereas sea turtles likely use a complex combination of chemical geomagnetic and solar cues allard et al 1994 lee et al 2007 lohmann et al 2008 furthermore although errors in natal habitat discrimination have clear ramifications for natal dispersal rates data on the rates of philopatry are somewhat sparse and taxa specific pomeroy et al 2000 documented natal philopatry rates of 0 36 for gray seals whereas thorrold et al 2001 documented natal philopatry rates of 0 60 to 0 81 for weakfish cynoscion regalis existing data on turtles suggest much stronger natal philopatry in many species levasseur et al 2020 nishizawa et al 2011 reid et al 2016a potentially suggesting that rates documented for other taxa do not typify turtles reinhold 1998 and valenzuela and janzen 2001 suggest that strong natal philopatry may have been required for the evolution of temperature dependent sex determination tsd a ubiquitous pattern in turtles whereby environmental temperatures of nests dictate offspring sex ratios it remains to be seen if high but imperfect rates of natal philopatry suggested by our study and reid et al 2016a typify other turtles if so imperfect natal philopatry may be more ubiquitous in turtles than previously thought 4 2 model selection 4 2 1 demographic consequences of risk depend on individual experience although mortality during nesting is relatively uncommon for adult turtles there are documented incidents of adult mortality due to overexposure burger and montevecchi 1975 jessop et al 2000 spotila and standora 1985 or predation refsnider et al 2015 spencer 2002 during nesting excursions given many aspects of turtle life history and demography including delayed ages of maturity high adult survival in most populations and low to moderate fecundity in most species even relatively low probabilities of mortality or harm during nesting excursions may be expected to shape behavior byer et al 2019 spencer 2002 thus although the primary effect of risk exposure in our model was through shifts in patch preferences and increases in breeding dispersal optional model extensions allow for risk associated reductions in adult survival nest survival or both incorporation of both adult and nest survival costs associated with risk exposure was associated with reduced breeding dispersal but with relatively weak effects on natal dispersal there are two primary factors that we expect are associated with this first adult survival costs associated with nesting in high risk areas lead to increased mortality for turtles nesting in those patches since these turtles die before they can adjust nesting preferences breeding dispersal rates are reduced although first time breeders do experience reductions in survival in high risk areas under these settings natal dispersal rates are primarily influenced by errors in natal habitat discrimination rather than risk second nest survival costs associated with high risk areas lead to reduced numbers of hatchlings with natal habitat assigned to those high risk habitats this leads to reduction in the total number of turtles eventually nesting in those patches as well which once again produces reduced breeding dispersal rates in this case although we did find associations between natal dispersal and nest survival these effects were weak and models incorporating this effect did not perform substantially better than null models we suspect that this is due to time lags between hatching and transition to first time breeding status it takes 17 model years to become a mature adult and over time numbers of sub adults in each yearly cohort will decline due to stochastic mortality thus although risk associated reductions in nest survival do appear to have effects on natal dispersal these effects are obscured by other demographic factors inherent in the model it is possible that risk associated reductions in nest survival may have stronger effects on natal dispersal for species with lower ages of maturity such as chicken turtles five years buhlmann et al 2009 congdon et al 1983a or painted turtles six to ten years tinkle et al 1981 risk associated reductions in nest survival are well documented in a number of turtles and birds with higher densities of mammalian predators often associated with reduced nest survival ringelman 2014 schmidt et al 2006 or consistent patterns of nest placement to reduce visibility or detectability by predators colombelli négrel and kleindorfer 2009 however few studies to date have considered how consistently low nest survival due to predators may have stronger more detectable influences on philopatry for short lived rather than long lived species since philopatry has been found to create ecological traps when used sites are associated with high predation risk ekroos et al 2012 further study will be needed to understand how age of maturity modifies the strength of natal philopatry in high risk environments 4 2 2 divergent influences of habitat predictability philopatry but no fidelity the role of habitat predictability in driving repeatability of habitat use is among the most frequently studied topics associated with habitat selection alerstam and enckell 1979 kokko and sutherland 2001 schmidt et al 2010 switzer 1993 when unpredictability is high from year to year habitat selection is influenced not only by the overall quality of a particular habitat area but also the degree of variability associated with those areas thus more unpredictable conditions will likely lead to altered optimal distributions of used habitat that is habitats associated with highest fitness danchin et al 1998 switzer 1993 furthermore since site fidelity minimizes uncertainty in future reproductive success when habitat quality is highly unpredictable individual animals will be less likely to adjust habitat preferences when maximizing fitness switzer 1993 however such concepts implicitly assume that animals have knowledge of past reproductive success for taxa that show little to no nest attendance or maternal investment in incubation such as turtles several factors are likely at play a natal philopatry represents a productive means of reducing uncertainty since successful nesting areas will always produce more young that return to nest when they mature than unsuccessful areas and b proxies for habitat quality such as predator densities around used habitats or overstory cover may be used under the assumption that they are predictive of reproductive success chalfoun and schmidt 2012 clark and shutler 1999 janzen and morjan 2001 since many proxies for habitat quality used when selecting habitat often do not accurately predict fitness associated with that patch chalfoun and schmidt 2012 such strategies may be particularly prone to the emergence of ecological traps whereby animals continue to use habitats due to a mismatch between cues erroneously used to predict habitat quality and actual fitness ekroos et al 2012 sih et al 2011 our simulations indicated contrasting influences of predictability on natal and breeding dispersal when risk was highly unpredictable first time breeders were more likely to nest in their natal habitat indicating higher natal philopatry and reduced natal dispersal in contrast unpredictability in risk substantially increased breeding dispersal rates thus reducing site fidelity in effect this suggests that animals are more likely to use natal habitat for their first nesting event but are highly likely to switch habitats every time following such a strategy whereby initial philopatry is eventually replaced by a more roving reproductive strategy has been documented in several systems including non territorial male behavior in galapagos sea lions meise et al 2013 furthermore strategies associated with strong natal imprinting may actually be expected to be associated with rapid shifts in habitat preferences kokko and sutherland 2001 schmidt et al 2010 the fact that our model reproduced and reaffirmed results of previous theoretical studies by suggesting the potential emergence of high philopatry low fidelity strategies is encouraging and suggests that a combination of several factors may ultimately lead to such a strategy a low maternal information on reproductive success in habitat patches b high variability of more proximate indicators of quality and c implicit but imperfect knowledge of natal habitat placement 4 3 model evaluation and qualification a critical aspect of individual based models and simulation models in general involves successfully connecting simulation results to empirical pattern this ensures that simulation models are rooted in a desire to understand more about the real systems under study grimm et al 1996 grimm and railsback 2012 piou et al 2009 wang et al 2018 one approach to connecting empirical pattern to simulation results involves using empirical pattern as both guiding principles for model creation and calibration conditions for evaluating internal modeling hypotheses often termed pattern oriented modelling pom grimm et al 1996 grimm and railsback 2012 wang et al 2018 this approach has been used to guide model creation and assessment in a number of systems semeniuk et al 2012 wang et al 2018 thus evaluation of model behavior focused on reproducing empirical movement distances and demographic rates model evaluation was largely successful with estimates of movement distances and patch specific demographic rates largely corresponding to empirical expectations first the model produced estimates of mean nesting excursion distances that were generally between 1300 m and 1800 m which was well within the range of dispersal distances previously reported for this species congdon et al 2011 second although simulation based estimates of area specific population growth did not precisely replicate empirical estimates the model successfully recovered higher population growth rates for area b relative to other nesting areas reid et al 2016b given that rapid empirical population growth rates for area b were previously associated with habitat restoration efforts in that area the lack of concordance between simulation based and empirical estimates of population growth for this area highlight a potential limitation of the model in general that it assumes by default fixed landscape characteristics with no potential for habitat improvement or degradataion reid et al 2016b while it remains to be seen if habitat improvements are the primary reason for these discrepancies this does represent a promising potential model improvement that could be explored in the future although not analyzed in detail we also qualified model behavior by utilizing empirical patterns associated with a novel system to explore model behavior in conditions not originally considered during model deisgn gallagher et al 2021 we ultimately chose to leverage existing data on the marbled murrelet and other seabirds to characterize breeding and natal dispersal patterns beissinger 1995 divoky and horton 1995 initial model qualification efforts indicated that this model could easily be applied to address questions related to breeding and natal dispersal in non reptilian systems as the model readily incorporated alternate demographic ecological and landscape conditions for this seabird system we hope to further refine the seabird system settings more fully in the future to facilitate further simulation based explorations of breeding and natal dispersal across systems 5 conclusions and future research our model accomplishes each of the core tasks originally intended a it reproduces empirical pattern in dispersal rates and patch preferences while contributing to our understanding of the processes that have ultimately produced these patterns b it explores interactions between demographic feedbacks and dispersal rates contributing to knowledge of how life history evolution constrains dispersal and c it answers fundamental questions related to emergent strategies of habitat use in unpredictable environments extending and confirming existing theories regarding philopatry fidelity and habitat predictability kokko and sutherland 2001 schmidt et al 2010 switzer 1993 however implementation of this model is not without its caveats in particular our model is female only and thus cannot account for sex specific difference in dispersal that may produce genetic signatures of dispersal between nesting areas reid et al 2016a sheridan et al 2010 since asymmetries in age of maturity between sexes may also have downstream impacts for age structure and demography we hope to extend this model to incoporate different behaviors for males and females such a model extension would also lend itself quite easily to incorporation of tsd and incubation temperature variation into our model since previous studies have suggested that tsd and philopatry may have co evolved reinhold 1998 valenzuela and janzen 2001 an extension of this model with two sexes and sex ratio differences between nests may reveal more complex interactions between risk habitat discrimination demographic feedbacks and habitat predictability our model also assumes that while nesting behaviors are plastic individuals within a population do not vary in their risk threshold or their natal error rate incorporating heritable variation in these parameters into a model with tsd would also allow us to examine how differences in fitness associated with specific behaviors affect the co evolution of nesting behavior and sex determination regardless our model sheds new light on the processes that contribute to site fidelity philopatry and dispersal as individual based models become more widely integrated into studies of behavior life history and ecology we believe that many questions previously seen as intractable to address in field studies will be tractable in simulation contexts thus broadening our understanding of the role of individual level behavior in shaping population level patterns deangelis and gross 1992 grimm and railsback 2004 we hope that this and similar approaches will stimulate additional discussions into the maintenance of fidelity and philopatry data availability the model and data necessary for recreating results reported herein are available at https github com testudinidude riskyturtles declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank dr m z peery and the peery lab for insightful comments and suggestions related to this work the first author was supported by a usda hatch act grant pi m z peery wis01865 during the initial project conceptualization and coding efforts for this paper field data were largely collected by the second author supported by and environmental protection agency epa star fellowship fp917106 the authors would like to thank numerous field assitants and students for their help with field data collection and participation in project efforts including r verkhovykh j millonzi j summers b witek j wogsland p riddle a swichtenberg s tomke and r klausch finally field work was approved by the university of wisconsin madison institutional animal care and use committee assurance no 3368 01 and by the wisconsin department of natural resources endangered and threatened resources permit no 681 supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 109968 appendix supplementary materials image application 1 
24458,repeatability in habitat use often termed site fidelity is widespread and ubiquitous often used habitat areas may be inherited by offspring in a phenomenon called natal philopatry leading to intergenerational repeatability in habitat preferences both fidelity and philopatry may represent strategies that could optimize fitness in spatially and temporally heterogeneous environments however the suite of ecological factors that encourage or discourage fidelity and philopatry remain poorly understood in most taxa while turtles order testudines exhibit both fidelity and natal philopatry when selecting nesting areas emerging evidence suggests that nest choice may be more plastic than previously thought however few studies to date have attempted to explore the behavioral choices that may produce deviations from nest site fidelity and philopatry we used a spatially explicit individual based model to explore how behavioral responses to a heterogeneous landscape can generate population level patterns of fidelity and philopatry we demonstrate that this model can dispersal patterns inferred from behavioral and genetic data from a blanding s turtle emydoidea blandingii population in central wisconsin reduced philopatry was associated with increasing error rates in habitat discrimination and reduced site fidelity was associated with decreasing risk tolerance unpredictable spatial distributions of risk increased natal philopatry but decreased site fidelity overall suggesting that strong natal imprinting may sometimes be associated with rapid shifts in habitat preferences in unpredictable environments associating risk exposure with increased adult or nest mortality led to increased nest site fidelity in both cases but with relatively weak effects on natal philopatry we also demonstrate the utility of this model for other landscapes and species by exploring a simplified seabird system our model holds promise for more detailed exploration of the ecological and evolutionary factors that may give rise to fidelity and philopatry keywords fidelity individual based model life history nest selection philopatry turtles 1 introduction repeatability in animal movements towards previously visited locations is widespread and ubiquitous bell et al 2009 richardson et al 2017 in its basic form this repeatability often and variously termed site fidelity switzer 1993 tenacity gratto 1988 and recurrence gonzalez et al 2008 involves biases in habitat use with locations often associated with crucial behaviors such as foraging nesting denning or shelter bell et al 2009 richardson et al 2017 switzer 1993 the ubiquity of site fidelity has led to a wide taxonomic representation of empirical studies on this subject including studies in primates boyer et al 2012 aquatic mammals pomeroy et al 2000 wolverines aronsson and persson 2018 turtles freedberg et al 2005 rowe et al 2005 sheridan et al 2010 birds hoover 2003 schlossberg 2009 and spiders hoefler et al 2006 in some cases these studies have found that consistently selected sites are sometimes inherited by offspring often termed natal philopatry suggesting the potential for intergenerational repeatability in habitat preferences greenwood 1980 stiebens et al 2013 valenzuela and janzen 2001 waser and jones 1983 this empirical work has coincided with the concurrent emergence of theories associated with the evolution of site fidelity richardson et al 2017 schmidt 2001 switzer 1993 in particular several studies have postulated that site fidelity is related to habitat predictability hoover 2003 switzer 1993 given the importance of habitat quality in driving reproductive success growth and survival dias 1996 freckleton et al 2006 root 1998 although see chalfoun and schmidt 2012 it is unsurprising that temporal variability in habitat quality has had documented demographic impacts adler and wilson 1987 tomimatsu and ohara 2010 in temporally variable environments selecting habitats based on past indicators of high habitat quality may not be a reliable means of maximizing fitness however such strategies termed win stay lose switch may be advantageous in more predictable environments campomizzi et al 2012 chalfoun and martin 2010 switzer 1993 in contrast high site fidelity may be a productive means of maximizing fitness in temporally unpredictable conditions potentially explaining the evolution of site fidelity more broadly hoover 2003 kokko et al 2001 schmidt et al 2010 switzer 1993 an interesting corollary to this is that although individuals are often expected to distribute themselves in space according to current availability of resources fretwell and lucas 1969 the realized distribution of individuals in space for organisms with high site fidelity may depend more on past experience of the habitat and past resource availability potentially resulting in lower or higher realized fitness than expected under ideal free distributions although these theoretical frameworks explain under what conditions site fidelity produces higher survival or fitness the exact means by which individual perceptions of habitat quality influence individual and population scale patterns of fidelity remain uncertain and largely unexplored kokko and sutherland 2001 kokko et al 2001 schmidt and whelan 2010 many studies into indicators of habitat quality have suggested that cues used are highly dependent upon the effects of habitat features on fitness components for example predator densities spencer 2002 food supply brown 1999 martin 1995 sergio et al 2003 and conspecific shared use citta and lindberg 2007 danchin et al 1998 fletcher 2007 have all been suggested as indicators of habitat quality for foraging sites in avian systems past reproductive success is a frequently observed cue used by birds to predict nesting habitat quality gjerdrum et al 2005 martin 1995 reproductive success is likely a particularly advantageous cue to use for assessing habitat quality due to its role as one sub component of fitness citta and lindberg 2007 danchin et al 1998 martin 1995 however evidence also suggests that the risk of injury or mortality for the adult is also utilized to assess reproductive site quality byer et al 2019 martin 1995 spencer 2002 in avian systems for example trade offs between adult mortality risk and reproductive site attendance whereby adult breeders only tolerate levels of mortality risk up to certain thresholds before abandoning reproductive sites have been frequently documented badyaev and ghalambor 2001 ghalambor and martin 2001 such tactics are often grouped under the classification of bet hedging reproductive strategies which broadly involve animals favoring future reproductive output at the expense of current reproductive output beaumont et al 2009 cunnington and brooks 1996 lips 2001 rollinson and brooks 2007 although a number of studies have provided empirical support for bet hedging strategies how such strategies manifest in patterns of habitat selection fidelity and philopatry remains poorly known beaumont et al 2009 cunnington and brooks 1996 lips 2001 rollinson and brooks 2007 nesting behaviors are critical to fitness in reptilian species and studies of reptilian nesting particularly those focusing on turtles have identified unique sets of trade offs associated with these behaviors many long lived reptiles follow a traditional bet hedging reproductive strategy often nesting in areas that minimize adult risk exposure byer et al 2019 spencer 2002 or foregoing energetic investment in current reproduction in favor of adult survival or growth rollinson and brooks 2007 accordingly in many reptile species and virtually all turtle species mothers immediately do not attend nest sites after nests are laid often retreating to wetland or non nesting habitat immediately after nest completion limiting the forms of maternal investment made into each clutch to more indirect forms brooks et al 1991 rasmussen and litzgus 2010 wallace et al 2007 thus many turtles have no means of directly assessing reproductive success associated with nest site choice instead selecting for a relatively narrow range of conditions expected to ensure successful nesting hays et al 1995 hughes and brooks 2006 kolbe and janzen 2002 mitchell et al 2013 when habitats considered suitable for nesting are spatially aggregated on the landscape nesting aggregations may form as documented in turtles lei and booth 2017 iguanas rand 1968 crocodilians woodward et al 1984 and many other reptilian taxa doody et al 2009 in addition many and perhaps most turtles exhibit site fidelity and natal philopatry whereby adult female turtles return to the same nesting area defined here as terrestrial areas with suitable substrate for oviposition used by multiple females and first time breeders often nest in the same patches where they hatched respectively e g carr 1975 lee et al 2007 rowe et al 2005 sheridan et al 2010 empirical studies do suggest that nesting behaviors by turtles can be plastic morjan 2003 refsnider and janzen 2012 and rates of dispersal by hatchlings and nesting adults between nesting areas may be low but non zero reid et al 2016a however while studies have explored the evolutionary role of natal philopatry and fidelity in promoting patterns of sex determination e g charnov and bull 1977 reinhold 1998 valenzuela and janzen 2001 the role of life history traits writ large in producing or disrupting fidelity and philopatry remains largely unexplored this is particularly true for taxa with slow life histories such as turtles as these systems often require extremely long field studies to effectively sample patterns of habitat use through time given these knowledge gaps there is a pressing need for studies that explore the complex interplay between animal life history and space use to explore how individual perceptions of risk in a heterogeneous environment can create emergent patterns of fidelity and philopatry we constructed a spatially explicit individual based model although site fidelity and philopatry presumably emerge from the interplay between species level life history traits and individual level behavioral choices very few studies have explicitly explored these emergent relationships in space and time to examine whether the model can realistically reproduce pattern of fidelity and philopatry we use the model to conduct a series of simulations patterned after nesting behavior in the blanding s turtle emydoidea blandingii a habitat specialist native to the northeastern united states ernst and lovich 2009 while this species is largely aquatic it also undertakes extensive terrestrial movements to reach nesting areas beaudry et al 2010 and adult females typically return to previously used nesting areas far from their home wetlands suggesting fidelity and possibly natal philopatry congdon et al 1983b recent population genetic studies have documented low but non zero rates of dispersal between nesting areas which may indicate greater plasticity in philopatry and fidelity than previously assumed reid et al 2016a we designed this model around observed patterns at sandhill wildlife area swa in babcock wisconsin and leverage long term behavioral demographic and genetic datasets associated with this site for creation and calibration of our individual based behavioral model byer et al 2019 reid et al 2017 2016a 2016b in particular variable rates of nest survival between nesting areas at this site reid et al 2016a and heterogeneity in temperature and mammalian predator density across the landscape byer et al 2019 likely indicate varying costs and benefits associated with choices of nesting areas beyond utilizing the model to explore natal philopatry and nest site fidelity in a broad sense we also used our model to address two theoretical questions a how is dispersal affected by increasing fitness costs associated with risk exposure b how does habitat predictability affect rates of dispersal furthermore while originally created for use with reptilian systems we also demonstrate the flexibility of this model by applying it to a simplified seabird system modelled largely on the marbled murrelet brachyramphus marmoratus overall we demonstrate that our model provides novel insights into how both the fitness costs and temporal predictability of risk can influence site fidelity and philopatry 2 materials and methods throughout this section we document model choices using the overview design concepts and details odd protocol grimm 2020 grimm et al 2010 2020 in addition we primarily describe parameterization of this model based on prior studies at swa and refer to several core nesting areas described previously reid et al 2016b a series of old fields around an elevated bluff site n two open quarries site q and a gravel road near an intensively managed oak barrens site b of note previous research at swa has indicated higher recruitment and a younger age structure for turtles at area b and attributed these demographic differences to habitat restoration in that area reid et al 2016b although we focus on swa for data analysis note that the model can flexibly accommodate user specified maps and in the absence of a provided raster map either user provided or included with model will generate a simplified landscape in addition users may also choose to run the model using a simplified seabird example described in more detail in sections 2 1 2 2 and 2 10 2 throughout the manuscript we follow reid et al 2016a by distinguishing between two forms of dispersal breeding dispersal or the movement of adult animals between breeding sites and natal dispersal or the movement of first time breeders to their natal breeding site reid et al 2016a in our model these dispersal rates are influenced by individual level risk exposure in the context of this model we define risk broadly as factors that cause stress injury or in extreme cases death for a particular animal this flexible definition allows the exploration of both sub lethal and lethal forms of risk exposure this model was created using netlogo version 6 0 1 wilensky 1999 and is available online see data availability section for access to model see fig 1 for a diagrammatical overview of the core model structure 2 1 purpose and patterns this model explores how population level patterns of natal philopatry and fidelity are influenced by habitat predictability and individual responses to perceived risk ultimately patterns of natal philopatry and fidelity are reflected in both the distribution of individuals across nesting areas and estimated breeding and natal dispersal rates between nesting areas additionally optional model components allow users to a adjust how risk affects nest and or adult survival b alter how risk is distributed across land cover types c adjust the vital rates and carrying capacity of the population of interest d modify dispersal distances associated with traversal to nesting areas e explore alternative and possibly custom habitat maps such as a simplified seabird system and f adjust error rates in natal habitat discrimination for first time breeders thus the optional extensions of this model are intended to explore a wide range of conditions that may produce deviations from nest site fidelity and philopatry and the spatial patterns that result from plasticity in habitat use we used several real world patterns in model development evaluation and qualification gallagher et al 2021 these patterns are detailed below organized into model development model evaluation and model qualification patterns 2 1 1 model development pattern 1 mean rates of breeding and natal dispersal during model development we used previously published rates of breeding and natal dispersal reid et al 2016a to ensure that simulation parameter values while often unitless could approximate mean rates of dispersal these parameter values were then used to inform appropriate ranges of parameter values in downstream model experiments and analyses although iterative simulation runs involved in model development are not summarized in detail in this manuscript the simulation experiments described in sections 2 8 and 3 1 illustrate combinations of risk thresholds and natal error rates that best approximate mean empirical dispersal rates 2 1 2 model development pattern 2 population level demography we also leveraged previous demographic analyses at this site reid et al 2016b to assure that survival and reproductive rates in the model approximated the finite rate of population growth calculated for this site λ 1 03 reid et al 2016b byer et al 2020 some aspects of animal demography including clutch sizes and juvenile survival were unknown and iterative calibration of the model to approximate empirical population growth rates allowed us to set appropriate defaults for these demographic parameters the survival parameter values set when pressing blanding s defaults represent parameter values that best approximated this finite population growth rate these survival estimates closely approximated those leveraged for previous spatially explicit demographic modeling efforts for this species byer et al 2020 2 1 3 model evaluation pattern 1 distances between home wetlands and nest sites in order to assess the plausibility of nesting dispersal movements in the model we extracted euclidian distances between selected nesting areas and home wetlands in this model and compared those estimates to previously reported distances between home wetlands and nesting areas for this species 100 2000 m congdon et al 2011 2 1 4 model evaluation pattern 2 area specific growth rates we extracted simulation based estimates of finite growth rates λ for simulated nesting areas to previously reported area specific λ for this landscape for core nesting sites n q and b λn 0 972 λq 1 010 λb 1 145 reid et al 2016b see fig 1 for representations of which simulated nesting areas corresponded to these core empirical nesting areas 2 1 5 model qualification pattern 1 seabird demographic rates and spatial trends a necessary stage of model creation involves model qualification which involves testing the accuracy of the model outside of the system s from which model development patterns were drawn in our case this meant exploring systems with differing spatial scales landscape configurations life history traits and dispersal patterns to this end we provide a landscape and set of parameter values intended to approximate site fidelity and philopatry in a simplified seabird system focusing on the marbled murrelet b marmoratus in order to create this simplified system we drew demographic and landscape parameter settings from published estimates of marbled murrelet demographic rates beissinger 1995 and previous studies that indicate highest risk associated with nest deposition and attendance beissinger 1995 divoky and horton 1995 2 1 6 model qualification pattern 2 seabird fidelity and philopatry in the simplified seabird system we explored how well the model can replicate published rates of natal philopatry and nest site fidelity expected for the marbled murrelet divoky and horton 1995 in brief this species is expected to show rates of breeding dispersal comparable to other alcids 0 06 divoky and horton 1995 hall et al 2009 and higher rates of natal dispersal relative to breeding dispersal divoky and horton 1995 2 2 entities state variables and scales the model comprises four hierarchical levels the individual the nesting area subpopulation the population and the environment state variables associated with individuals include identity number age dispersal distance size natal patch risk threshold current risk and home wetland preference as this model is female only sex was not included as a state variable breeding age individuals have the additional following state variables current nesting area preferences and previous nesting area preferences with the latter recorded for the sake of record keeping all following variables described are primarily discussed for the blanding s turtle specific implementation of this model however note that age structure and demographic rates can be manipulated by the user all individuals less than age 1 are considered hatchlings which have no breeding characteristics and reduced survival relative to other stages all individuals greater than age 1 but less than age 17 are considered sub adults which experience survival rates intermediate between the other two stages all individuals age 17 or greater are considered adults the only stage characterized by all state variables outlined above individuals age 17 or greater are separated further into first time breeders and repeated breeders with this classification dependent on the number of nesting events previously logged by that individual to simplify this classification animals at age 17 are considered to be first time breeders whereas animals at ages 18 and older are considered repeated breeders when individuals are not actively breeding individuals are distributed between wetlands across the landscape depending on home wetland preferences a nesting area subpopulation is comprised of all the individuals associated with a given area the spatial boundaries of nesting area subpopulations were delineated based on long term observations of nest placement collected between 2001 and 2017 and each nesting area subpopulation is characterized by the following state variables identity number characteristics of individuals associated with that patch and relative nest survival values for that patch females that are members of a particular nesting area subpopulation experience nest survival rates characteristic of that subpopulation the population is composed of the nesting area subpopulations delineated above along with turtles below breeding age the population is described by the total number of individuals compared to current carrying capacity k the proportions of stage classes represented proportions of individuals associated with each nesting area proportions of individuals moving between each combination of nesting areas and the current spatial distribution of individuals the highest level in the model is the abiotic environment this environment is simplified to include three land cover types that correspond to core habitat types associated with blanding s turtle nesting activities upland non nesting habitat upland nesting habitat with distinct nesting areas assigned unique nesting habitat identifiers between 1 and 30 and wetland habitat each patch is characterized by the following state variables risk level habitat classification with values 30 used to distinguish nesting areas and nesting area a binary variable coded as 1 for suitable nesting habitat and 0 for non nesting habitat types the spatial scales represented by the model are highly flexible and determined by the input map originally provided for the purposes of the default blanding s turtle specific landscape we use an input map that is 238 patches in the x dimension and 234 in the y dimension with a patch size of 30 m x 30 m in contrast the seabird landscape covers a much broader spatial extent for the intended study species the marbled murrelet patch size presumably covers several 100 m divoky and horton 1995 regardless of the spatial scales involved natal and breeding dispersal are always quantified based on philopatry and fidelity respectively to sets of nesting habitat patches with the same nesting area identification number thus animals may breed in different habitat patches but are not assumed to have exhibited breeding or natal dispersal in doing so if those different nesting habitat patches share the same identification number note that a user may provide a habitat map where each nesting area is given a separate nesting area identification number thus allowing for consideration of very fine scale breeding and natal dispersal between all habitat patches classified as nesting habitat however tracking such a large number of possible transitions between nesting areas would be difficult and likely cumbersome with the current model design in terms of temporal scales the model always proceeds by yearly time steps thus the model is best suited for species that are assumed to breed one time per year see fig 2 for depictions of the two default landscapes 2 3 process overview and scheduling the model proceeds in discrete yearly time steps within each year the following events take place in sequence survival aging repeated and first time breeder nest choice population growth calculation and risk exposure resampling for randomly sampled and random risk stability settings in brief and outlined in fig 1 each time step starts with animals surviving and dying based on random number generation any animals that survive then age by one year and if appropriate transition to new stage classes reproductively mature animals first time breeders and repeated breeders then select nests in different ways 1 first time breeders attempt to reach natal habitat areas but may nest elsewhere depending on natal error rates and 2 repeated breeders nest in their current nesting area choice but adjust this choice in following years if risk exposure is above their risk threshold hatchlings are then produced from nest locations set their initial wetland and nesting area preferences and move to wetland areas the model then calculates population growth by dividing current population size by previous population size finally depending on parameter settings associated with risk stability risk levels across the landscape are potentially resampled these processe are summarized in more detail in section 2 7 2 4 design concepts 2 4 1 basic principles model design is based on two primary areas of inquiry fitness trade offs during reproduction and repeatability in habitat utilization in unpredictable environments the first principle is based more broadly in the concept of life history trade offs which assume that energetic limitations require organisms to sub optimally balance survival and reproduction schluter et al 1991 stearns 1976 1989 in turtles and other long lived species this involves making choices that negatively impact current reproduction in favor of future reproduction often resulting in choices that maximize adult survival at the expense of reproductive success guiden et al 2019 spencer 2002 the second principle habitat fidelity and philopatry in unpredictable environments is based on empirical and theoretical work on how organisms select habitat to minimize unpredictability hoover 2003 schmidt et al 2010 sheridan et al 2010 switzer 1993 these two principles inform most aspects of model design but particularly the way in which turtles select breeding habitat turtles that experience risk above their tolerance threshold will choose to nest in different patches in the future aligning with expectations of risk minimization for long lived organisms under life history theory in tandem unpredictability in habitat preferences will ultimately produce nesting preferences that minimize unpredictability between years in addition optional settings invoke more severe fitness costs associated with risk and habitat unpredictability which are expected to produce stronger demographic and behavioral feedbacks with emergent patterns of nesting area choice the model is ultimately intended to provide novel insights into the interplay between behavior habitat unpredictability and life history traits in producing nesting area preferences 2 4 2 emergence individual behaviors in the model are largely imposed by two simple behavioral rules followed during nesting a first time breeders are assigned a random decimal between 0 and 1 and only nest initially in natal patches if this number is higher than the natal error rate and b repeated breeders sample risk around their selected nest sites each year and switch nest sites the following year if this sampled number exceeds their risk threshold while these rules are quite rigid and imposed by the model code other aspects of the model are emergent individual nesting area preferences population level dispersal rates and frequencies of population level patch preferences are modelled as emergent consequences of demographic behavioral and landscape settings population level breeding dispersal rates represented as the proportion of repeated breeders that nest somewhere other than their previously used nesting area in a given year and emerge from individual behavioral decisions to shift nesting preferences when exposed to risk in a similar fashion natal dispersal is the proportion of first time breeders that nest somewhere other than their natal patch and emerges from individually sampled error rates in natal habitat discrimination demographic rates in contrast are initially user defined and imposed upon individual level survival and reproduction but optional model settings allow users to impose varying degrees of demographic sensitivity to risk across the landscape 2 4 3 behavioral adaptation individual behavioral adaptation primarily takes the form of several simple rules that impose adaptive nesting habitat preferences all individuals initially prefer to nest in their natal patch when individuals reach sexual maturity they attempt to nest in their natal patch with a certain probability natal error rate that they will fail to find their natal patch if they fail to find their natal patch they instead nest in a random nearby patch but proceed as normal otherwise in this way initial nesting habitat preferences have a random chance of being adjusted due to random error in contrast repeated breeders always breed in their preferred patch regardless of quantified levels of risk around nesting areas however they switch to a random nearby patch if the sum of risk in the eight neighbor area around their current nesting location is above their risk threshold defined as the level of risk that an animal can tolerate before shifting habitat preferences and or experiencing survival effects although individuals do not actively select for habitat that minimizes risk repeatedly switching nesting habitat is expected to gradually lead to nesting habitat preferences that expose individuals to less risk additional optional settings allow for stronger demographic feedbacks between risk and adult and or nest survival providing stronger pressures for individuals to nest in low risk areas 2 4 4 learning and prediction no explicit learning is incorporated into the model agents make choices about future nesting behaviors based on current conditions in this way agents assume that current conditions are indicators of future conditions while individuals do not act to reduce risk during nesting excursions increase adult survival or maximize nest survival per se individuals do avoid repeatedly nesting in areas with high risk in this way the population gradually begins to nest in patches with lower risk through time 2 4 5 sensing individuals are always aware of their preferred wetland area their preferred nesting area and their natal nesting area individuals do not actively sense nesting behavior of conspecifics thus density effects in nesting areas are not considered individuals are also able to sense risk in the eight neighbor area around their current location and make decisions based on this level relative to their risk threshold turtles rely largely on sight when sensing risk during nesting excursions and have relatively poor visual capabilities spencer 2002 thus while alternative buffer areas for risk assessment were possible the eight neighbor area around each animal provided a compromise between biological realism and analytical convenience 2 4 6 stochasticity many aspects of the model are fully or partially random first individual level probabilities of survival each year are sampled randomly and compared relative to set demographic rates as this is a common approach for sampling individual level demographic parameters morris and doak 2002 second adjustments in nesting preferences are random to a certain extent with individuals selecting alternate nesting areas within set dispersal distances this was appropriate because turtles have no means of directly assessing nest survival probability in any given nesting area brooks et al 1991 rasmussen and litzgus 2010 wallace et al 2007 third optional settings associated with predictability of risk impose either random resampling of landscape level risk values within normal distributions around provided risk parameter settings or entirely random risk values across the landscape given the preponderance of studies that explore the effects of stochasticity on site fidelity and philopatry this was deemed an appropriate means of exploring this aspect of model behavior hoover 2003 kokko et al 2001 schmidt et al 2010 switzer 1993 2 4 7 collectives and interaction there are no collectives in the model 2 4 8 observation the primary data outputs from the model involve summaries of dispersal rates and patch preferences patch preferences are calculated at each yearly time step as the total count of all individuals with particular nesting area preferences through time breeding dispersal rates are calculated as follows number of experienced breeders with current nesting area preferences that are not equivalent to previous preferences divided by total number of experienced breeders natal dispersal rates are calculated as follows number of first time breeders with current nesting area preferences that are not equivalent to their natal patch divided by total number of first time breeders these two definitions are in line with previous studies at this focal site reid et al 2016a 2 5 initialization after launching the model users should first decide upon which landscape they might choose to use the model provides substantial flexibility for setting initial landscape conditions however suggested default settings can be assigned by clicking either blanding s defaults or seabird defaults and using one of two default landscape settings with either blanding s maps or seabird map the blanding s defaults are meant to replicate empirical relationships documented for this focal area reid et al 2016a 2016b if users have their own map they may click load your own patches to upload that map at present the model assumes that nesting patches are assigned unique values from 1 to 30 with varying values indicating different nesting area identities wetland patches are assigned unique values greater than 30 and all other habitat is assigned 0 for the sake of simplicity model initialization will be discussed based on the blanding s default settings upon hitting the setup button several cleanup functions are called to clear plots patches and turtles from memory next the model checks for the presence of an input map classifies habitat patches as nesting wetland or upland habitat see input data and assigns risk values to each land cover type default settings assign risk levels of 1 for wetland patches 5 for nesting areas and 10 for upland patches a number of turtles default 200 are then created equal to a user assigned value since repeated breeders are defined by their previous experiences during nesting we assume that any turtles at model initialization are breeding for the first time thus only first time breeders sub adults and hatchlings are created at mode initialization all turtles are then distributed into random wetland patches set their wetland preferences to that patch are assigned a natal area and set their dispersal distance to the user specified value default 60 patches note that this dispersal distance is arbitrary with units scaled directly to the extent of the provided input map as with other features this dispersal distance can be customized flexibly each turtle then sets its age randomly within ranges that depend on its assumed stage ages 18 30 17 3 16 and 0 2 for repeated breeders first time breeders sub adults and hatchlings respectively and sets preferred nesting area to its natal patch 2 6 input data the model does not use dynamic input data 2 7 submodels the model is split into several core sub models or steps in model iteration that implement in order upon executing the go command these sub models are survival aging repeated and first time breeder nest choice and nest survival population growth calculation and risk exposure sampling for randomly sampled and random risk stability settings we describe each sub model below and detail these model parameters in table 1 2 7 1 survival under default settings for each individual in each stage class a random decimal between 0 and 1 is sampled if this number exceeds or equals that stage s user set survival number then that individual dies otherwise that individual continues to live optional settings allow survival rates to be risk sensitive for first time breeders and repeat breeders under these settings as in the repeated breeder component of the nest choice and survival sub model described below individuals assess the cumulative risk of the eight cell neighborhood around their currently occupied patch at the start of this sub model if cumulative risk exceeds an individual s risk threshold a similar sampling procedure to that described above is used but with adult survival reduced by a fixed value the optional risk sensitive survival setting also affects processes during the repeated breeder and first time breeder nest choice and movement sub models as well see below 2 7 2 aging and initial movements after the survival sub model turtles age and transition into new stages first turtles age by adding one to their stored age value then individuals classified as first time breeders check if their age is greater than or equal to one plus the user specified age of adult maturity in our case age of maturity is 17 years if so those individuals transition to become repeated breeders since sub adult movement is not simulated in any other sub model and random movement may represent a means with which animals delineate available habitat zollner and lima 1999 morales and ellner 2002 sub adults first move to a patch in a radius equal to dispersal distance size divided by 10 assuming that sub adults move shorter distances overall than adults pappas et al 2009 and then check if their age is greater than or equal to 17 if so they transition to becoming first time breeders finally hatchlings move in a radius equal to dispersal distance size divided by 20 reflecting more limited dispersal capabilities for this stage then check if their age is greater than or equal to 2 if so that individual transitions to the sub adult stage finally repeated breeders check if their age is greater than or equal to 70 if so those individuals die 2 7 3 risk exposure sampling since users have freedom to set risk stability settings between the options of stable sampled risk or random risk the model recalculates risk values for each patch for random draw and random risk stability settings for the sampled risk setting risk for each patch is sampled at model setup and at the end of each year from a normal distribution with sd 2 around each land cover specific risk value for the random risk setting risk is sampled from between the values of 1 and 80 for each patch regardless of land cover type 2 7 4 nest patch choice dispersal and nest survival as detailed above strategies associated with nesting events differ between first time breeders and repeat breeders which represent different processes leading to natal and breeding dispersal first time breeders attempt to reach their natal patch but have a user specified natal patch discrimination error rate repeated breeders in contrast first consider where they nested previously and move towards the nearest patch with that nesting area id once repeated breeders reach that patch they assess risk in their eight cell neighborhood and choose to maintain the same nest patch preference for the next year or select another nesting area if risk is greater than their tolerance of risk risk threshold and their current preferred patch is not where they were born their natal patch they move back to their natal patch this makes the assumption that repeat breeders remember where natal patches are which is likely realistic given reid et al 2016a if risk is greater than risk tolerance and animals currently prefer their natal patch they select a random nest patch within dispersal distance for future nest preferences if risk is less than risk tolerance patch preferences remain unaltered regardless of classification as repeated or first time breeder nest survival is then drawn from 0 to 1 randomly at this point three options are provided for nest survival if nest survival mode is set to base then if there are fewer turtles than carrying capacity k and the random number for nest survival is less than the provided nest survival rate then 8 hatchlings are born if there are more turtles than k then no hatchlings are born if nest survival mode is set to risk sensitive then nest survival is reduced by the user defined nest risk penalty when cumulative risk is greater than the turtle s risk threshold this assumes that risk affects nest choice and adult perception of risk and nest survival in similar ways finally if nest survival mode is set to empirical then the user provided nest survival value is overridden by patch specific nest survival rates derived from empirical data at sandhill wildlife area n w byer unpubl data when hatchlings are born they record their natal nesting area set a random wetland patch nearby as their preferred wetland and temporarily remain at that patch 2 7 5 population growth calculation population size is recorded at two points within each yearly step at the beginning of the year representing pre survival and aging population counts and at the end of the year representing post survival aging and breeding sub model population counts population growth rate λ for each year is then calculated as follows λ end of year population count beginning of year population count 2 8 initial experiments and demonstrations of model behavior before leveraging the model to address specific ecological questions we first explored model behavior with several interactive simulation experiments the first set of three simulation experiments was designed to explore the behavior of the model when risk threshold and natal error values were varied the first such experiment involved varying risk threshold values between 0 and 100 in increments of 5 and extracting breeding dispersal rates natal dispersal rates and frequencies of patch use for each time step for each simulation this experiment was designed to explore a the way in which breeding dispersal is affected by risk threshold values and b any potential unanticipated effects of risk threshold values on natal dispersal estimates the second experiment in contrast involved varying natal error rates between 0 and 1 in intervals of 0 05 while holding all other parameters constant this experiment was designed to explore a the way in which natal dispersal is affected by natal error rates and b any potential unanticipated effects of natal error rates values on breeding dispersal estimates third we ran an experiment where natal error rates and risk thresholds were varied simultaneously across the ranges and increments of parameter values described above intended to explore how simultaneous shifts in natal error rates and risk thresholds influenced breeding and natal dispersal rates we set up each of the experiments in behaviorspace and ran five replicates for each parameter combination 2 9 model selection we then tested a suite of models related to targeted theoretical questions using a full factorial design intended to explore combinations of all parameters of interest in order to ease computational burden associated with parameter exploration we did not explore full parameter space instead we chose between two and five levels for parameters of interest producing a total of 1728 parameter sets and 8640 runs total we extracted yearly results first and then filtered further to consider only the final year of each run we used nl get step result to extract values for breeding dispersal natal dispersal and nesting area frequencies for each year we then filtered this dataset to the final year 300 results for each run we then used several a priori designated subsets of this full factorial dataset for the following analyses a consideration of how fitness costs associated with risk in the form of decreased nest survival and or adult survival create emergent shifts in breeding and natal dispersal and b how imposing instability in habitat characteristics affects patch preferences breeding dispersal and natal dispersal for these analyses we filtered the full factorial simulation dataset to include only parameters relevant to each analysis table 1 and formulated model statements a priori that explored the factors of interest supplementary materials s1 for top beta regression models we provide 95 confidence intervals cis around parameter estimates β for multinomial models we provide 95 cis around odds ratios or 2 10 model evaluation and qualification 2 10 1 model evaluation we then designed a series of small experiments to evaluate model accuracy relative to the model testing patterns secondary patterns gallagher et al 2021 described in section 2 1 first we used output from the simple experiments described in section 2 8 to determine parameter combinations that would be best calibrated to reproduce our primary empirical patterns after doing so we ran 200 simulation runs with these parameter settings for each time step we extracted the following information a distances between an animal s home wetland and nesting areas in each time step and b patch specific finite population growth rates each of these output values correspond to quantitative empirical patterns assessed by previous studies of this species for instance previous nesting studies have indicated that blanding s turtles typically move 100 m to 2000 m during nesting excursions which provides a point of comparison with distances between wetlands and nesting areas in the simulation congdon et al 2011 similarly patch specific growth rates have been intensively studied at this study site and indicated rapid population growth for area b stable population size for area q and population declines for area n reid et al 2016b 2 10 2 model qualification in order to qualify model performance we performed a final interactive experiment with the simplified seabird system described in sections 2 1 2 2 and 2 5 while this model could be broadly applied to other seabird systems as well the wealth of data available for the marbled murrelet meant that many empirical patterns were based at least in part on this system beissinger 1995 divoky and horton 1995 first we used an initial set of empirical patterns model qualification pattern 1 see section 2 1 drawn from prior publications to optimize demographic and landscape parameters that could reasonably approximate those observed in the marbled murrelet beissinger 1995 we then iteratively set other parameters based on prior empirical studies of natal and breeding dispersal in this species model qualification pattern 2 we limit our analysis to descriptive model behavior under these parameter settings 3 results 3 1 initial experiments and demonstrations of model behavior when all other covariates were held constant increasing risk thresholds led to exponentially decreasing breeding dispersal rates with no observed breeding dispersal past a risk threshold of 70 in contrast increasing risk threshold alone had no directional impacts on natal dispersal rates when natal error rates were increased independently natal dispersal rates increased in a linear fashion unexpectedly increasing natal error rates also produced slight increases in breeding dispersal rates as well when natal error rates and risk thresholds were increased simultaneously outcomes were generally like those described previously as well fig 3 3 2 model selection 3 2 1 consequences of risk associated fitness costs the top model for breeding dispersal included risk associated costs for adult survival risk associated costs for nest survival and risk thresholds risk sensitivity in adult survival dramatically reduced breeding dispersal rates βrisk sensitive adult survival 0 808 95 ci 1 356 to 0 260 as did risk sensitivity in nest survival βrisk sensitive nest survival 0 559 95 ci 0 0144 to 1 103 in contrast although two models were competitive for explorations of effects on natal dispersal only one variable had confidence intervals not overlapping with zero in either model risk sensitivity in nest survival supplementary materials s2 βrisk sensitive nest survival 0 542 95 ci 0 115 to 0 968 furthermore the model that considered only risk sensitivity in nest survival did not explain substantially more variation than the null model thus fitness consequences associated with risk exposure appear to lead to reduced dispersal rates in experienced breeders but not necessarily in first time breeders fig 4 3 2 2 habitat predictability and dispersal simulations that explored effects of habitat stability on dispersal and patch use suggested shifts in dispersal behavior under unpredictable conditions the top model for breeding dispersal included effects of risk stability settings and risk thresholds supplementary materials s2 in this model increased risk tolerance led to lower breeding dispersal rates βrisk threshold 0 010 95 ci 0 014 to 0 006 furthermore fully stochastic risk stability settings led to increased breeding dispersal rates βrandom risk 1 375 95 ci 0 0942 to 1 808 whereas patch settings based on random normal sampling around user supplied land cover risk values did not substantially increase or decrease breeding dispersal βsampled risk 0 012 95 ci 0 396 to 0 420 in contrast the top model for natal dispersal included effects of risk stability and interactions between risk thresholds and natal error rates supplementary materials s2 this model indicated increased natal dispersal with increasing natal error rates βnatal error 1 922 95 ci 0 403 to 3 441 and with simultaneous increases in risk thresholds and natal error rates βinteraction 0 025 95 ci 0 002 to 0 048 however the independent effect of risk threshold had confidence intervals that overlapped with zero βrisk threshold 0 005 95 ci 0 004 to 0 014 in addition fully stochastic patch stability settings substantially reduced natal dispersal rates βrandom risk 0 63 95 ci 0 971 to 0 282 whereas sampled risk values did not substantially alter natal dispersal βsampled risk 0 180 95 ci 0 155 to 0 515 thus habitat instability led to divergent effects on first time breeders and repeated breeders with first time breeders responding to instability by reducing natal dispersal and repeated breeders responding by increasing breeding dispersal fig 4 the same top model for natal dispersal best explained patterns of nesting area dominance supplementary materials s2 for the site b vs n comparison higher risk thresholds led to a higher probability of dominant use of site n orrisk threshold 1 077 95 ci 1 033 to 1 121 while simultaneous increases in risk tolerance and natal error rates led to dominant use of site b orinteraction 0 847 95 ci 0 769 to 0 934 however independent effects of natal error rates had confidence intervals that overlapped with one ornatal error 0 023 95 ci 0 to 2 784 for this same comparison fully stochastic or sampled risk values tended to favor dominant use of site b orrandom risk and orsampled risk 0 001 although site b was still favored under more stochastic settings for the b vs q comparison orrandom risk and orsampled risk 0 001 other parameter estimates differed from the b vs n comparison higher risk thresholds tended to favor use of site b over q orrisk threshold 0 001 whereas higher natal error rates favored site q over n ornatal error 100 several general conclusions can be drawn from these models a site b is favored when habitat conditions are unpredictable b site n appears to require the highest risk thresholds for consistent use suggesting that it is likely riskier than other nesting sites and c site q appears to be used most frequently when natal error rates are high likely because of its central position in the study landscape fig 5 3 3 model evaluation and qualification 3 3 1 model evaluation model evaluation simulations indicated concordance between model evaluation patterns and model behavior first the average simulation based nesting excursion distance was 51 78 patches given that patches for the default input map were 30 m x 30 m this equates to an average distance of 1553 m range 1379 1796 m these distances are well within those previously reported for this species 100 m to 2000 m congdon et al 2011 in addition distributions of estimated finite population growth rates for previously studied core nesting areas generally included mean and 95 confidence intervals around field estimates reid et al 2016b the main exception was for site b for which field based growth rates were noticeably larger than simulation based estimates however simulations correctly estimated higher population growth rates for this site relative to other sites indicating that core empirical trends were recovered by the simulation fig 6 3 3 2 model qualification although not a subject of detailed study we used model qualification patterns i and ii to guide creation of a simple seabird simulation system fig 1 after setting default seabird system parameters to mirror marbled murrelet demography and ecology we ran a small subset of simulations to explore model behavior with varying risk thresholds and natal error rates table x as with the blanding s turtle model risk thresholds at 60 or above appeared to produce low but finite rates of breeding dispersal range 0 01053 0 02105 although slightly lower than rates of breeding dispersal calculated for marbled murrelets previously 0 06 this likely represents a promising set of initial parameters for more detailed exploration in a similar fashion natal dispersal behaved predictably with increasing natal error rates increasing linearly with increasing natal error rates given uncertainty in natal dispersal rates for this species this model represents a promising tool for exploring the spatial and demographic consequences of varying natal dispersal conditions 4 discussion our study integrates detailed field information prior population genetic analyses and in depth knowledge of life history and demography into a spatially explicit individual based simulation of nest patch selection in the blanding s turtle although previous simulation studies have incorporated habitat fidelity or philopatry metsaranta 2008 schmidt 2004 wang and grimm 2007 most of these models have primarily been focused on ecological factors other than fidelity or philopatry explicitly unlike these previous efforts our model focuses explicitly upon two forms of dispersal shaped by habitat fidelity and philopatry a natal dispersal defined as animals deviating from natal philopatry by nesting in areas other than where they were born and b breeding dispersal defined as animals deviating from habitat fidelity by nesting in different areas between years reid et al 2016a furthermore we explore how plasticity in natal philopatry and habitat fidelity may be influenced by the following factors a threshold dependent risk avoidance with risk envisioned primarily as that imposed by the presence of predators on the landscape byer et al 2019 b errors in habitat discrimination c demographic consequences of risk exposure and d temporal unpredictability and instability in risk our simulation results coupled with the observed empirical patterns of nesting area use at swa suggest that turtles and other long lived species with limited maternal investment are relatively tolerant of risk and accurate in natal habitat discrimination furthermore connecting risk exposure to reduced adult and nest survival increased habitat fidelity and reduced breeding dispersal whereas unpredictability in habitat features led to increased natal philopatry or decreased natal dispersal and reduced habitat fidelity or increased breeding dispersal we discuss each of these findings in more detail below 4 1 initial explorations of model behavior initial simple experiments focused on exploring the behavior of the model with varying risk thresholds and natal error rates conveniently these simulations also allowed for illustration of dispersal rates relative to model development pattern i model settings that successfully reproduced previously documented breeding and natal dispersal rates revealed several general insights into risk tolerance and habitat discrimination many of which are supported by previous studies of turtles and other long lived species first mean breeding dispersal rates for our focal field site were only recreated at relatively high risk threshold values in a narrow portion of parameter space around approximately 92 suggesting that adult turtles are relatively insensitive to risk overall however non zero rates of breeding dispersal indicate that this insensitivity is not absolute as with several empirical studies of freshwater turtles byer et al 2019 spencer 2002 threshold dependent responses to predator activity as a proxy for risk may be critical for ensuring that females survive nesting attempts although units associated with risk thresholds and risk levels are relative and arbitrary in our study we consider this range of risk thresholds to represent relative positions upon life history gradients associated with risk tolerance with potential for simulating and estimating potential breeding dispersal rates in other species based on hypothesized risk tolerance levels for example turtles with lighter physical protection may be expected to be more likely to abandon habitats and thus more likely to exhibit higher breeding dispersal rates for example the softer shells of many trionychids soft shell turtles are typically associated with a number of behavioral differences between trionychids and other turtle groups scheyer et al 2007 thus we believe that our model may hold promise for characterizing relative risk tolerance for any species for which breeding dispersal rates are known in contrast low but nonzero 10 9 error rates in discrimination are also in line with previous findings as well most turtles show high degrees of philopatry in nesting attempts often returning to within several meters of nesting areas between years janzen and morjan 2001 lee et al 2007 limpus et al 1984 sheridan et al 2010 however the factors used to discriminate natal from non natal habitat are still uncertain and vary among taxa for example salmon have been found to primarily use olfactory cues when finding natal waters dittman et al 1996 hasler et al 1978 whereas sea turtles likely use a complex combination of chemical geomagnetic and solar cues allard et al 1994 lee et al 2007 lohmann et al 2008 furthermore although errors in natal habitat discrimination have clear ramifications for natal dispersal rates data on the rates of philopatry are somewhat sparse and taxa specific pomeroy et al 2000 documented natal philopatry rates of 0 36 for gray seals whereas thorrold et al 2001 documented natal philopatry rates of 0 60 to 0 81 for weakfish cynoscion regalis existing data on turtles suggest much stronger natal philopatry in many species levasseur et al 2020 nishizawa et al 2011 reid et al 2016a potentially suggesting that rates documented for other taxa do not typify turtles reinhold 1998 and valenzuela and janzen 2001 suggest that strong natal philopatry may have been required for the evolution of temperature dependent sex determination tsd a ubiquitous pattern in turtles whereby environmental temperatures of nests dictate offspring sex ratios it remains to be seen if high but imperfect rates of natal philopatry suggested by our study and reid et al 2016a typify other turtles if so imperfect natal philopatry may be more ubiquitous in turtles than previously thought 4 2 model selection 4 2 1 demographic consequences of risk depend on individual experience although mortality during nesting is relatively uncommon for adult turtles there are documented incidents of adult mortality due to overexposure burger and montevecchi 1975 jessop et al 2000 spotila and standora 1985 or predation refsnider et al 2015 spencer 2002 during nesting excursions given many aspects of turtle life history and demography including delayed ages of maturity high adult survival in most populations and low to moderate fecundity in most species even relatively low probabilities of mortality or harm during nesting excursions may be expected to shape behavior byer et al 2019 spencer 2002 thus although the primary effect of risk exposure in our model was through shifts in patch preferences and increases in breeding dispersal optional model extensions allow for risk associated reductions in adult survival nest survival or both incorporation of both adult and nest survival costs associated with risk exposure was associated with reduced breeding dispersal but with relatively weak effects on natal dispersal there are two primary factors that we expect are associated with this first adult survival costs associated with nesting in high risk areas lead to increased mortality for turtles nesting in those patches since these turtles die before they can adjust nesting preferences breeding dispersal rates are reduced although first time breeders do experience reductions in survival in high risk areas under these settings natal dispersal rates are primarily influenced by errors in natal habitat discrimination rather than risk second nest survival costs associated with high risk areas lead to reduced numbers of hatchlings with natal habitat assigned to those high risk habitats this leads to reduction in the total number of turtles eventually nesting in those patches as well which once again produces reduced breeding dispersal rates in this case although we did find associations between natal dispersal and nest survival these effects were weak and models incorporating this effect did not perform substantially better than null models we suspect that this is due to time lags between hatching and transition to first time breeding status it takes 17 model years to become a mature adult and over time numbers of sub adults in each yearly cohort will decline due to stochastic mortality thus although risk associated reductions in nest survival do appear to have effects on natal dispersal these effects are obscured by other demographic factors inherent in the model it is possible that risk associated reductions in nest survival may have stronger effects on natal dispersal for species with lower ages of maturity such as chicken turtles five years buhlmann et al 2009 congdon et al 1983a or painted turtles six to ten years tinkle et al 1981 risk associated reductions in nest survival are well documented in a number of turtles and birds with higher densities of mammalian predators often associated with reduced nest survival ringelman 2014 schmidt et al 2006 or consistent patterns of nest placement to reduce visibility or detectability by predators colombelli négrel and kleindorfer 2009 however few studies to date have considered how consistently low nest survival due to predators may have stronger more detectable influences on philopatry for short lived rather than long lived species since philopatry has been found to create ecological traps when used sites are associated with high predation risk ekroos et al 2012 further study will be needed to understand how age of maturity modifies the strength of natal philopatry in high risk environments 4 2 2 divergent influences of habitat predictability philopatry but no fidelity the role of habitat predictability in driving repeatability of habitat use is among the most frequently studied topics associated with habitat selection alerstam and enckell 1979 kokko and sutherland 2001 schmidt et al 2010 switzer 1993 when unpredictability is high from year to year habitat selection is influenced not only by the overall quality of a particular habitat area but also the degree of variability associated with those areas thus more unpredictable conditions will likely lead to altered optimal distributions of used habitat that is habitats associated with highest fitness danchin et al 1998 switzer 1993 furthermore since site fidelity minimizes uncertainty in future reproductive success when habitat quality is highly unpredictable individual animals will be less likely to adjust habitat preferences when maximizing fitness switzer 1993 however such concepts implicitly assume that animals have knowledge of past reproductive success for taxa that show little to no nest attendance or maternal investment in incubation such as turtles several factors are likely at play a natal philopatry represents a productive means of reducing uncertainty since successful nesting areas will always produce more young that return to nest when they mature than unsuccessful areas and b proxies for habitat quality such as predator densities around used habitats or overstory cover may be used under the assumption that they are predictive of reproductive success chalfoun and schmidt 2012 clark and shutler 1999 janzen and morjan 2001 since many proxies for habitat quality used when selecting habitat often do not accurately predict fitness associated with that patch chalfoun and schmidt 2012 such strategies may be particularly prone to the emergence of ecological traps whereby animals continue to use habitats due to a mismatch between cues erroneously used to predict habitat quality and actual fitness ekroos et al 2012 sih et al 2011 our simulations indicated contrasting influences of predictability on natal and breeding dispersal when risk was highly unpredictable first time breeders were more likely to nest in their natal habitat indicating higher natal philopatry and reduced natal dispersal in contrast unpredictability in risk substantially increased breeding dispersal rates thus reducing site fidelity in effect this suggests that animals are more likely to use natal habitat for their first nesting event but are highly likely to switch habitats every time following such a strategy whereby initial philopatry is eventually replaced by a more roving reproductive strategy has been documented in several systems including non territorial male behavior in galapagos sea lions meise et al 2013 furthermore strategies associated with strong natal imprinting may actually be expected to be associated with rapid shifts in habitat preferences kokko and sutherland 2001 schmidt et al 2010 the fact that our model reproduced and reaffirmed results of previous theoretical studies by suggesting the potential emergence of high philopatry low fidelity strategies is encouraging and suggests that a combination of several factors may ultimately lead to such a strategy a low maternal information on reproductive success in habitat patches b high variability of more proximate indicators of quality and c implicit but imperfect knowledge of natal habitat placement 4 3 model evaluation and qualification a critical aspect of individual based models and simulation models in general involves successfully connecting simulation results to empirical pattern this ensures that simulation models are rooted in a desire to understand more about the real systems under study grimm et al 1996 grimm and railsback 2012 piou et al 2009 wang et al 2018 one approach to connecting empirical pattern to simulation results involves using empirical pattern as both guiding principles for model creation and calibration conditions for evaluating internal modeling hypotheses often termed pattern oriented modelling pom grimm et al 1996 grimm and railsback 2012 wang et al 2018 this approach has been used to guide model creation and assessment in a number of systems semeniuk et al 2012 wang et al 2018 thus evaluation of model behavior focused on reproducing empirical movement distances and demographic rates model evaluation was largely successful with estimates of movement distances and patch specific demographic rates largely corresponding to empirical expectations first the model produced estimates of mean nesting excursion distances that were generally between 1300 m and 1800 m which was well within the range of dispersal distances previously reported for this species congdon et al 2011 second although simulation based estimates of area specific population growth did not precisely replicate empirical estimates the model successfully recovered higher population growth rates for area b relative to other nesting areas reid et al 2016b given that rapid empirical population growth rates for area b were previously associated with habitat restoration efforts in that area the lack of concordance between simulation based and empirical estimates of population growth for this area highlight a potential limitation of the model in general that it assumes by default fixed landscape characteristics with no potential for habitat improvement or degradataion reid et al 2016b while it remains to be seen if habitat improvements are the primary reason for these discrepancies this does represent a promising potential model improvement that could be explored in the future although not analyzed in detail we also qualified model behavior by utilizing empirical patterns associated with a novel system to explore model behavior in conditions not originally considered during model deisgn gallagher et al 2021 we ultimately chose to leverage existing data on the marbled murrelet and other seabirds to characterize breeding and natal dispersal patterns beissinger 1995 divoky and horton 1995 initial model qualification efforts indicated that this model could easily be applied to address questions related to breeding and natal dispersal in non reptilian systems as the model readily incorporated alternate demographic ecological and landscape conditions for this seabird system we hope to further refine the seabird system settings more fully in the future to facilitate further simulation based explorations of breeding and natal dispersal across systems 5 conclusions and future research our model accomplishes each of the core tasks originally intended a it reproduces empirical pattern in dispersal rates and patch preferences while contributing to our understanding of the processes that have ultimately produced these patterns b it explores interactions between demographic feedbacks and dispersal rates contributing to knowledge of how life history evolution constrains dispersal and c it answers fundamental questions related to emergent strategies of habitat use in unpredictable environments extending and confirming existing theories regarding philopatry fidelity and habitat predictability kokko and sutherland 2001 schmidt et al 2010 switzer 1993 however implementation of this model is not without its caveats in particular our model is female only and thus cannot account for sex specific difference in dispersal that may produce genetic signatures of dispersal between nesting areas reid et al 2016a sheridan et al 2010 since asymmetries in age of maturity between sexes may also have downstream impacts for age structure and demography we hope to extend this model to incoporate different behaviors for males and females such a model extension would also lend itself quite easily to incorporation of tsd and incubation temperature variation into our model since previous studies have suggested that tsd and philopatry may have co evolved reinhold 1998 valenzuela and janzen 2001 an extension of this model with two sexes and sex ratio differences between nests may reveal more complex interactions between risk habitat discrimination demographic feedbacks and habitat predictability our model also assumes that while nesting behaviors are plastic individuals within a population do not vary in their risk threshold or their natal error rate incorporating heritable variation in these parameters into a model with tsd would also allow us to examine how differences in fitness associated with specific behaviors affect the co evolution of nesting behavior and sex determination regardless our model sheds new light on the processes that contribute to site fidelity philopatry and dispersal as individual based models become more widely integrated into studies of behavior life history and ecology we believe that many questions previously seen as intractable to address in field studies will be tractable in simulation contexts thus broadening our understanding of the role of individual level behavior in shaping population level patterns deangelis and gross 1992 grimm and railsback 2004 we hope that this and similar approaches will stimulate additional discussions into the maintenance of fidelity and philopatry data availability the model and data necessary for recreating results reported herein are available at https github com testudinidude riskyturtles declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank dr m z peery and the peery lab for insightful comments and suggestions related to this work the first author was supported by a usda hatch act grant pi m z peery wis01865 during the initial project conceptualization and coding efforts for this paper field data were largely collected by the second author supported by and environmental protection agency epa star fellowship fp917106 the authors would like to thank numerous field assitants and students for their help with field data collection and participation in project efforts including r verkhovykh j millonzi j summers b witek j wogsland p riddle a swichtenberg s tomke and r klausch finally field work was approved by the university of wisconsin madison institutional animal care and use committee assurance no 3368 01 and by the wisconsin department of natural resources endangered and threatened resources permit no 681 supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 109968 appendix supplementary materials image application 1 
24459,urban expansion occupies open space at the city edge most of which are ecological lands and cropland their losses cause far reaching impact on ecological security and food security the urban growth boundaries delimitation has been proposed to preserve these open spaces current studies consider ecosystem conservation or cropland protection independently while largely ignore the potential trade offs between them this study aims to integratedly coordinate both ecosystem conservation and cropland protection by protecting superior ecological lands and cropland in the urban growth boundaries delimitation the superiorities of ecological lands and croplands are treated equally for supporting urban expansion and are considered at the same time during land use simulation habitat quality quantified by the invest model and agricultural production potential are applied to reflect the superiority of ecological lands and cropland respectively by applying a land use simulation model landscape the demand for urban land can be met by occupying inferior ecological lands and cropland the urban growth boundaries can be thus delimitated accordingly based on the projected urban areas the effect of urban growth boundaries delimitation can be reflected by the mitigated losses in habitat quality agricultural production potential and change in urban compactness two scenarios are set up for comparing the effect of our approach the result shows that our approach performs better in coordinating ecosystem conservation cropland protection and a more compact urban morphology this research contributes to a rational urban growth boundaries delimitation which integratedly incorporating ecosystem conservation cropland protection and urban compactness keywords urban growth boundaries delimitation landscape model urban expansion ecosystem conservation cropland protection urban compactness 1 introduction urbanization results in a great loss of natural resource at rural areas most of which are ecological lands such as forest grassland and wetlands and cropland considerable evidences have revealed its negative effects on biodiversity climate change hydrology and energy balance due to the losses in ecological lands during urbanization grimm et al 2008 seto et al 2011 the ratio of the loss in ecological lands is unprecedented in recent decades and the amount is large ipbes 2019 farmland is one the most significant land use types where urbanization takes place among others the share of irrigated farmland located near urban areas is projected to account for more than 60 of the total amount worldwide d amour et al 2017 it is predicted that about 1 8 2 4 farmlands will be lost during the urbanization progress by 2035 d amour et al 2017 many of the occupied farmlands are fertile in agricultural production which is expected to be 1 77 times more productive than that of the global average bren et al 2017 farmland loss not only directly threatens food security chen 2007 tan et al 2005 song and pijanowski 2014 but also implies a further loss of other ecological lands due to land reclamation for agricultural use in order to maintain an overall stable food production in a region ke et al 2018 this is particularly true at the city edge where urbanization processes are rapid and chaotic deng et al 2015 godfray et al 2010 liu et al 2017 the concept of urban growth boundaries ugb dates back to the great britain s green belt in the 1930s nelson 1985 a classical application of ugb for reference worldwide is the definition of regional boundaries in portland oregon the usa in the 1960s nelson and moore 1993 by defining the ugb urban development is constrained within the boundary while areas outside are protected from being occupied particularly those important ecological lands and farmland nelson and moore 1993 tayyebi et al 2011 ugb practices have been carried out for preventing urban sprawl by optimizing urban function layout with the aims of stimulating a compact and resource saving urban development and improving the quality of urban space bhatta 2009 the ideas of ugb delimitation can be categorized into three types 1 growth driven method which is based on the demand for urban land growth in the planning year 2 anti planning method which excludes unsuitable construction zones such as ecological lands and ecologically sensitive zones and 3 a combination of the previous two methods huang et al 2019 currently the ugb delimitation are mainly conducted in two ways 1 expert based approach which is based on planners working experience and the constraints of administrative instructions of local government mainly during the urban master planning li et al 2019 and 2 model based approach that uses urban growth models which stimulate land use pattern in the end of the planning year the expert based approach is advantaged in making decisions according to their working experiences and domain knowledge while can be short for being subjective thus the results often vary among different experts long et al 2013 besides an insufficient incorporation of multiple stakeholders demands can be a weakness li et al 2019 comparatively the model based approach allows for a quantitative support ma et al 2017 but is limited for those factors considered for land use simulation thus a potential ignorance of key factors may produce biased results he et al 2018 moreover data availability sometimes can be a problem li et al 2011 mcgarigal et al 2018 the model based approach is increasingly applied in ugb delimitation as the development of computer science and an increasing availability of data among them the ca based models are widely used for being flexible in considering the suitability or constraint of urban growth by combing the assessments of for example land suitability zheng et al 2017 and ecologically sensitivity li et al 2019 as the process of land use change is highly complex and non linear thus can be difficult to identify based on historical land use changes lambin et al 2001 with this regard a prediction of future land use change based on advanced algorithms is requested for ugb delimitation accordingly ca based models are developed by coupling algorithms such as artificial neural networks anns wu and silva 2010 ant colony optimization aco li et al 2011 and genetic algorithm shan et al 2008 as well as a combination of these algorithms the cellular automata based ca based models keep on evolving to deal with the increasingly complex and multiple demands among various stakeholders in the practices of ugb delimitation landscape model is one of such land use simulation models and is applied in this study and is superior to other ca based models in hierarchical allocation strategy among multiple land use types ke et al 2017 despite the practices of ugb delimitation have been carried out during the past decades there occurs ineffectiveness sometimes this ineffectiveness can be resulted from the fragmented pattern of ugb and the insufficient space for urban development in the near future actually compact cities have been one of the leading global paradigms of sustainable urbanism since the early 1990s cec 1990 and are favoured for limiting the loss of green and natural areas bibri et al 2020 moreover the compactness is a high priority factor for ecological conservation and favours for cropland protection matisziw and murray 2006 however most of current studies may suffer potential failures for allowing urban expansion on the premise of avoiding occupying protected areas in specific in most studies ecosystem conservation dominates the concept of ugb delimitation rather than an integrated consideration of integrated factors see examples such as mcgarigal et al 2018 and ma et al 2017 which take the integrity of ecological systems or ecological sensitivity as the constraints of future land use simulation in some other studies cropland protection is also excluded from the area of ugb in priority huang et al 2019 li et al 2019 zheng and lv 2016 this may lead to an increase in fragmentation and newly added urban areas scattered distributed therefore this study aims to see whether a model based approach can be proposed in order to facilitate its effective implementation that integratedly coordinates cropland protection ecosystem conservation and urban compactness into the ugb delimitation nowadays the ugb has been widely put into practice worldwide including cities in china benfield et al 2001 huang et al 2019 china is one of the countries that undergoes rapid urbanization and has reached an urbanization rate of 63 89 in 2020 http english www gov cn as the urban population in china is projected to reach 1 4 billion by 2050 un 2021 and the process of urbanization is expected to continue in the near future in such a dense population country cropland protection is necessary to confront from the challenge of food security liu et al 2015 song and pijanowski 2014 in the meanwhile as the conscious of environment protection among the public has been aroused and the demand for high quality of life ecosystem conservation has become increasingly important in recent years such targets have been exploring to be incorporated in the ugb delimitation in china the urban construction boundaries ucbs have been requested in urban master and detailed plans with the release of the act of urban and rural planning in china li et al 2019 in addition borderlines defining urban ecological agricultural spaces have been initiated by the general land use planning and general urban planning liu et al 2017 the ugb delimitation has been put into practice in 14 pilot cities in 2014 nationwide and followed by another 600 cities and towns in more recent years ma et al 2017 2 methods 2 1 research framework according to the aim of this study the fundamental step of ugb delimitation is to optimize land use pattern by meeting the demand of urban land in the planning year 2030 and mitigating the negative impacts on ecosystem conservation cropland protection and urban compactness at the minimum this can be realized by converting those inferior ecological lands and cropland for supporting urban expansion in priority at the same time the urban compactness should be facilitated by converting newly added urban lands where adjacent to existed urban area habitat quality is taken as an indicator to reflect the superiority of the ecological lands liu et al 2017 and is quantified by using the invest integrated valuation of ecosystem services and tradeoffs model sharp et al 2015 agricultural production potential is used to reflect the superiority of cropland in fertility fischer et al 2012 urban compactness index is calculated to indicate the compact level of the urban expansion li et al 2011 a rapidly urbanizing megacity wuhan in central china is selected as the study area to conduct the analysis the land use patterns are simulated in 2030 in response to a 10 year period 2021 2030 as a customary urban planning time the demand for urban land in 2030 is calculated with a logarithmic function based on historical data appendix 1 the landscape model is accordingly applied to simulate land uses for both scenarios in wuhan in 2030 the overall research framework follows the steps of scenario setting up model calibration land use simulation ugb delimitation effect analysis fig 1 in order to show the effect of the ugb delimitation incorporated with ecosystem conservation and cropland protection two scenarios are set up for comparison 1 scenario 1 short for sc1 hereafter as a referenced scenario for comparison urban development is prohibited within ecosystem conservation zone primary cropland protection area and without considering the neighbourhood effect and 2 scenario 2 short for sc2 hereafter urban development is coordinately considered with ecosystem conservation cropland protection and the neighbourhood effect 2 2 ugb delimitation in 2030 with the landscape model the landscape model is developed as a cellular automata ca model it is capable of revealing interaction between multiple land use types based on a hierarchical allocation strategy which performs better than other traditional ca models ke et al 2017 depending on the relationship with human demands land use types are grouped into an active or passive type white and engelen 1997 subsequently these two land use types are allocated in two interactive processes in the landscape model in specific active land use types such as built up area and rural settlement are allocated hierarchically based on the sequence of aggressiveness namely the most aggressive land use type is allocated in priority and followed by a less competitive one subsequently passive land types e g forest and wetland would change based on the change of active land use types suitability and resistance together determine the transfer rule of a land use type the suitability reflects the suitable degree of a location to transfer to a target land use type influenced by driving forces and the resistance denotes the difficulty of one land use type transferring to another ke et al 2017 by following ke et al 2017 the suitability is determined by land use terrain accessibility soil and meteorological data and the resistance is calculated based on the superiority of agricultural production potential and habitat quality appendix 2 the landscape model should be calibrated for accuracy before being used for projecting land use change accuracy assessment can be measured by a model s goodness of fit rykiel 1996 kappa simulation of the map comparison kit which is developed by the netherlands environmental assessment agency pbl visser and de nijs 2006 is applied to calculate the accuracy of landscape model by following van vliet et al 2011 the score of kappa simulation varying from 1 to 1 indicating a higher accuracy with a higher value in specific 1 indicates a perfect match between simulated and observed land use map 0 indicates the model accuracy is as the same as a random model while a value below 0 indicates an inaccurate model result the model calibration is conducted by using the observed land use maps in 2000 and 2010 a calibrated land use simulation model landscape is used to simulate land use patterns in 2030 for both scenarios ke et al 2017 based on the simulated land use maps the ugb can be delimitated 1 extract urban areas 2 exclude scattered patches to enable the ugb encompasses areas within it compact and broadly connected following liu et al 2017 and the size is set as smaller than 5 km2 according to the scattered and small parcels of simulated land uses of wuhan and 3 draw a smooth and closed curve along the urban boundary with the remaining areas by using the arcgis 10 2 liang et al 2018 2 3 effect evaluation of ugb delimitation 2 3 1 ecosystem conservation reflected by habitat quality the habitat quality is quantified with the application of invest model according to sharp et al 2015 information of land use land change lulc and threats to biodiversity are combined to produce habitat quality maps in order to reveal the relative extent and degradation of different types of habitat types in a region and changes across time the suitability of a land use type for being a habitat differs among different land use types a weight is given to a raster of lulc to indicate the suitability of a specific lulc as a habitat appendix 3 following sharp et al 2015 moreover habitat threat density is required to show the impact on habitat quality and is revealed by the road accessibility and proximity to agricultural land sharp et al 2015 appendix 4 let the quality of habitat in parcel x that is in lulc j be given by qxj 1 q x j h j 1 d x j z d x j z k z where hj refers to the habitat s suitability dxj indicates the degree of degradation of a grid unit x associated with a land use type j z is an intrinsic conversion factor setting up as 2 5 and k was a half saturation factor setting up as 5 by following sharp et al 2015 2 3 2 cropland protection reflected by agricultural production potential change in agricultural production potential from 2015 to 2030 can be assessed based on the difference between this periods of time agricultural production potential in 2015 and 2030 are reflected by the data in 2000 and 2008 respectively due to the limitation of data availability 2 3 3 urban compactness measured by the index of urban compactness compactness index is often applied to measure the landscape pattern characterized as the ration of the area to the perimeter for each urban patch li et al 2011 this study applies an average compactness index and is expressed as f c o m p a c t p 1 p 2 π a p π l p p where f c o m p a c t is the average compactness of urban patches p is the total number of urban patches a p and l p are the area and the perimeter of patch p respectively p 1 2 p 2 4 study area wuhan is a rapidly urbanizing megacity in central china which covers an area of 8569 68 km2 there are 12 33 million inhabitants and more than 80 of which are urban dwellers by the end of 2020 tjj wuhan gov cn the average annual population growth rate reached 2 34 between 2010 and 2020 which is much higher than a national average level of 0 53 national bureau of statistics of china 2021 more than half of the area in wuhan is covered by cropland hubei bureau of statistics 2020 fig 2 and most of the soils are suitable for agricultural production wuhan is also named as the city of hundreds of lakes which provides important habitats for biodiversity while in the past years the landscape tends to be more fragmented and irregular during urban expansion tan et al 2014 and has resulted in server lake shrinkage and water ecosystem degradation the citizens quality of life is negatively influenced by the deteriorated ecosystem and environmental problems such as urban flooding chen et al 2018 and urban heat island debbage and shepherd 2015 wuhan has been listed as a hub city in the outline of yangtze river economic belt development plan which stands out the important role of this area in the national economy development in china therefore wuhan is expected to develop under a fierce competition among economic development ecosystem conservation and cropland protection 2 5 data sources six data sets are needed in this research land use data ecosystem conservation zone cropland protection zone agricultural production potential traffic data and population table 1 land use data in 2005 and 2015 are used for landscape model calibration land use data in 2015 is further used as the basic map for land use simulation in 2030 and to extract the urban area and cropland as the threat for habitat quality in quantifying habitat quality sharp et al 2015 ecosystem conservation zone and cropland protection zone are taken as the constraint for prohibited occupied areas in land use simulation in sc1 due to the data availability agricultural production potential in 2000 and 2008 are applied to reflect the status of 2015 and 2030 respectively traffic data is used as one of the threats of habitat quality sharp et al 2015 the population data from 2000 to 2016 are used to predict the future population in 2030 in order to further estimate the demand for urban land in 2030 all data are converted to raster data with a resolution of 100 m 100 m for being consistent with the land use data 3 results 3 1 calibration of landscape model a simulated land use map in 2015 based on 2005 was used for model calibration by testing the level of agreement between which and the observed land use map in 2015 mitsova et al 2011 the result shows that kappa simulation score of all land use types were larger than 0 appendix 5 which validates the calibrated landscape model is capable to provide reliable results moreover the scores of ktransition are generally higher than those of ktransloc indicating that changes in quantity among land use types were simulated more accurately than changes in location van vliet et al 2013 with the calibrated landscape model land use patterns in 2030 were simulated for the two scenarios 3 2 land use simulations in 2030 of both scenarios according to historical land use data in wuhan from 2000 to 2016 a logarithmic function was applied and projected the demand for built up area in 2030 as 1071 21 km2 appendix 1 habitat quality is quantified by applying the invest model for both scenarios the land use simulations in both scenarios are displayed in fig 3 wuhan covers a total area of 8569 68 km2 and is dominated by cropland at a proportion of 55 95 table 2 wetland and built up area rank the second and third at a proportion of 15 80 and 12 50 respectively grassland bareland and rural settlement are the least at 0 67 0 78 and 2 82 respectively comparing with the land use in 2015 the most significant change in 2030 is the increase of built up area which accounts in 75 69 this is mainly at the cost of grassland rural settlement and bareland at about 12 more than 8 and less than 8 respectively 3 3 ugb delimitation based on the simulated land use types in 2030 the ugb have been delimitated for each scenario by using arcgis 10 2 fig 4 as is shown in the figure most of the built up areas concentrated in the urban center have been delimited within the ugb presenting a compact and contiguous pattern there is 85 built up area encompassed by the ugb leaving the rest of the built up area which are scattered and in small sizes excluded in addition it is unavoidable to include some other land use types that locate in the city center inside the ugb which are mainly cropland and wetland accounts for about 15 and 14 respectively 3 4 effect evaluation of ugb delimitation the spatial differences are found in the loss in agricultural production potential the loss in habitat quality and the change in urban compactness between the two scenarios from 2015 to 2030 in particular the loss in agricultural production potential presents higher values in the north part as well as along the yangtze river while those of lower values are mainly in the south and further to the yangtze river fig 5 in general the loss in agricultural production potential is slightly lower in sc2 at 39 45 compared to sc1 at 39 62 table 3 this indicates that the effect of cropland protection is better in sc2 than sc1 the losses in habitat quality show spatial differences with higher values where wetlands are distributed concentrated in the south part and northeast within the ugb fig 6 this includes the south lake in the southeast part area within the ugb and hou lake jinyin lake and houguan lake in the west the loss in habitat quality is overall slightly lower in sc2 at 34 34 compared to sc1 at 34 62 table 4 this indicates that sc2 performs better in maintaining habitat quality than sc1 by applying the average compactness index the urban compactness of both scenarios are measured results show that the change in urban compactness is larger in sc2 at 5 11 compared to sc1 at 4 88 table 5 this indicates that sc2 also performs better in the improvement of urban compactness than sc1 4 discussion 4 1 land use simulations with the landscape model the landscape model allows for future land use simulation for combining land suitability and constrains which are neighbourhood effect agricultural production potential and habitat quality in our study this capability of accurate land use prediction confronted from the complex urbanization process improves the effect in ugb implementation in practice zheng and lv 2016 the landscape model is properly applied in simulating future land uses as our focus is on illustrating the scenario based utility of this model rather than developing a more advanced urban growth model or details of the evaluation of agricultural production potential and ecological assessment there are many other ca based models that are advantaged in mitigating conflicts among multiple objectives for example ant colony optimization aco algorithms which considers zoning protected natural areas and multi type land use allocation li et al 2011 the landscape model differs from such approaches in its superiority of higher simulation accuracy more importantly its hierarchical allocation strategy allows for an explicit determination of the allocation sequence by urban expansion taking place in ecological lands and cropland from inferior area to superior area in sequence 4 2 effect of ugb delimitation 4 2 1 the loss in agricultural production potential 2015 2030 the effect of sc2 is better in cropland protection compared to sc1 can be partly resulted from that superior lands are less occupied during urban expansion sc2 allows urban expansion to take place where agricultural production potential are inferior rather than strictly prohibits in primary cropland protection areas in sc1 as most other studies did one of the differences between the two scenarios lies in the flexibility of allowing a proper occupation in farmland in sc2 although cropland protection is regarded as one of the aims of ugb delimitation ever since the ugb concept was proposed cropland is far less considered than ecological conservation in the ugb delimitation in early years for example ma et al 2017 takes the layer of cropland protection zone as the suitability map li et al 2019 regards cropland protection zone as one of the resources of green infrastructure in this study cropland protection is more directly considered as one of the targets as important as ecosystem conservation and is measured by agricultural production potential this is useful in protecting those fertile lands excluded from the primary cropland protection zone especially in wuhan where the average fertility of agricultural production is high 4 2 2 the loss in habitat quality 2015 2030 as one of the important target of ugb delimitation ecosystem conservation is considered in various ways this ensures the ugb to facilitate biodiversity maintenance and environmental health to the public for example to assess the green infrastructure to stand out conservation priorities into urban growth simulation by identifying natural or restored space that forms a green network li et al 2019 the evaluation of ecological sensitivity is also widely used for considering ecosystem conservation jia et al 2019 liu et al 2017 delimitated the urban development boundary by mitigating the conflict between urban development and ecological conservation by measuring habitat quality with the invest model to reflect the resistance of a parcel of land to be occupied during urbanization which is in line with our study the effect of sc2 is better in ecosystem conservation compared to sc1 is mainly resulted from that superior habitat are less occupied during urban expansion the most significant losses of habitat quality corresponds to the lakes which indicates the role of wetland in maintaining habitat quality in the study area 4 2 3 the change in urban compactness 2015 2030 the ugb delimitation performs better in sc2 because the parcels of built up areas encompassed by the ugb are larger and more contiguous the more compact pattern in sc2 can be directly resulted from this scenarios allows for a more flexible scheme of land use change among multiple land use types contrasting to sc1 which strictly prohibits urban expansion to protected cropland and protected ecological zone the higher urban compactness facilitates the effect of ugb implementation as was argued by santé et al 2008 who found a compact urban patch is preferred by developers to perform development activities to control the urban sprawl is meaningful to megacities including wuhan and hangzhou li et al 2019 tan et al 2014 xu et al 2018 as well as other rapidly urbanizing cities that tend to occur urban sprawl tong et al 2017 in addition our approach is in line with the opinions who state the necessity of the ugb delimitation being flexible to allow a proper urban expansion to adjacent open space in order to support economic development cho et al 2007 jun 2004 xu et al 2018 4 3 implication for land use guidance the study aims to call for the ugb delimitation by avoiding the conflicts among various regulation zones such as farmland protection area and ecosystem conservation zone as well as urban compactness integratedly this is true in current land use in china where are implementing various regulation lines for example red line for prime cropland protection blue line for water protection and ugb is one of such lines called green line these lines sometimes show spatial overlay thus their spatial regulations sometimes can be difficult he et al 2018 one aims of the ugb delimitation is to orientate a compact urban development bhatta 2009 while some studies are limited in presenting a compact and contiguous pattern this is particularly true for those with the anti planning approach which identify ugb by avoiding ecological conservation zone or primary farmland protection zones can results in expanding newly added urban land scattered and fragmented around the city edge which reduces the urban compactness our approach calls for an integratedly ugb delimitation by considering cropland protection and ecosystem conservation rather than considering these aspects in sequence this facilitates the pattern of land use simulation more compact and contiguous which is helpful in enhancing the effect of implementation 4 4 limitation of this study it should be acknowledged that there are some limitations of land use simulation one of which is the large ignorance of some other biophysical factors e g precipitation and elevation and socioeconomic factors e g distance to important sites that may influence the way of urban expansion this can result in a difference between the simulated maps and that in reality for example the topography factor may limit the way urban expands as is documented by he et al 2018 in the role of the lakes and yangtz river in influencing the shape of ugb in wuhan moreover as a typical socioeconomic factor the market incentives of land price are not incorporated in this study supporters believe that ugb delimited in areas where are more accessible to higher house price and transportation facilities may be risky of ineffective implementation dempsey and plantinga 2013 long et al 2013 in this case the 13 districts in wuhan varies in geographic and socioeconomic conditions for the well developed wuchang district in the center of wuhan an effective implementation may be more difficult than a less developed jiangxia district in the south of wuhan however the advantage of considering such simple constraints is to highlight the impact of cropland protection ecosystem conservation and urban compactness on the ugb delimitation rather than other factors 5 conclusion this study proposed an approach that integratedly coordinates cropland protection ecosystem conservation and urban compactness in the ugb delimitation with a land use simulation model landscape land use patterns in two scenarios are projected in 2030 by comparing the losses in agricultural production potential habitat quality and the change in urban compactness encompassed by ugb between 2015 and 2030 the result indicates our proposed approach sc2 performs better in all the aspects of cropland protection ecosystem conservation and urban compactness thereby our approach is potential to improve the effect of ugb implementation in practice compared to other studies that only consider one or two aspects among them in practice identifying ugb encounters much more complex situations including the game for urban land quota at different levels of governments land use demands among different departments environmental risk and social cohesion the effectiveness of ugb implementation is largely rely on how these conflicts are alleviated this study supplies an open approach to address such constraints in an integrated way in the ugb delimitation credit authorship contribution statement ting zhou conceptualization methodology software formal analysis data curation writing original draft visualization funding acquisition xi yang conceptualization methodology software formal analysis investigation resources writing review editing supervision xinli ke conceptualization validation investigation resources writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was funded by the national natural science foundation of china grant numbers 42101265 41971240 and the fellowship of china postdoctoral science foundation grant number 2021t140240 appendix 1 historical data of built up area in wuhan 2008 2016 unit km2 year area of built up area 2008 460 00 2009 466 60 2010 484 01 2011 506 42 2012 520 30 2013 543 28 2014 552 61 2015 566 13 2016 585 61 the equation was established as ŷ t 1 14 723 967455 e0 031532k 14 264 appendix 2 parameters of landscape model land use types demand in each land use type in 2030 km2 active passive resistance cropland active 1 4 forest passive 1 3 grassland passive 1 3 river passive 1 2 wetland passive 1 3 built up area 1071 21 active 1 5 rural settlement active 1 1 appendix 3 suitability parameters of lulc as a habitat in the invest model lulc land use types habitat agriculture paved road urban area 1 cropland 0 0 0 0 2 forest 1 0 7 0 6 0 6 3 grassland 0 6 0 7 0 6 0 6 4 river 0 9 0 9 0 9 0 9 5 wetland 0 9 0 9 0 9 0 9 6 built up area 0 0 0 0 7 rural 0 0 0 0 8 unused 0 6 0 4 0 6 0 6 note referenced by sharp et al 2015 appendix 4 attributes of threats threat max dist weight decay cropland 8 1 linear road 5 0 7 exponential urban 5 0 7 exponential appendix 5 kappa simulation score for each land use type land uses cropland forest grassland river built up area rural settlement bareland kappa simulation score 0 228 0 075 0 064 1 000 0 448 0 069 0 090 note river is excluded from the table as it is set up unchanged during this period of time 
24459,urban expansion occupies open space at the city edge most of which are ecological lands and cropland their losses cause far reaching impact on ecological security and food security the urban growth boundaries delimitation has been proposed to preserve these open spaces current studies consider ecosystem conservation or cropland protection independently while largely ignore the potential trade offs between them this study aims to integratedly coordinate both ecosystem conservation and cropland protection by protecting superior ecological lands and cropland in the urban growth boundaries delimitation the superiorities of ecological lands and croplands are treated equally for supporting urban expansion and are considered at the same time during land use simulation habitat quality quantified by the invest model and agricultural production potential are applied to reflect the superiority of ecological lands and cropland respectively by applying a land use simulation model landscape the demand for urban land can be met by occupying inferior ecological lands and cropland the urban growth boundaries can be thus delimitated accordingly based on the projected urban areas the effect of urban growth boundaries delimitation can be reflected by the mitigated losses in habitat quality agricultural production potential and change in urban compactness two scenarios are set up for comparing the effect of our approach the result shows that our approach performs better in coordinating ecosystem conservation cropland protection and a more compact urban morphology this research contributes to a rational urban growth boundaries delimitation which integratedly incorporating ecosystem conservation cropland protection and urban compactness keywords urban growth boundaries delimitation landscape model urban expansion ecosystem conservation cropland protection urban compactness 1 introduction urbanization results in a great loss of natural resource at rural areas most of which are ecological lands such as forest grassland and wetlands and cropland considerable evidences have revealed its negative effects on biodiversity climate change hydrology and energy balance due to the losses in ecological lands during urbanization grimm et al 2008 seto et al 2011 the ratio of the loss in ecological lands is unprecedented in recent decades and the amount is large ipbes 2019 farmland is one the most significant land use types where urbanization takes place among others the share of irrigated farmland located near urban areas is projected to account for more than 60 of the total amount worldwide d amour et al 2017 it is predicted that about 1 8 2 4 farmlands will be lost during the urbanization progress by 2035 d amour et al 2017 many of the occupied farmlands are fertile in agricultural production which is expected to be 1 77 times more productive than that of the global average bren et al 2017 farmland loss not only directly threatens food security chen 2007 tan et al 2005 song and pijanowski 2014 but also implies a further loss of other ecological lands due to land reclamation for agricultural use in order to maintain an overall stable food production in a region ke et al 2018 this is particularly true at the city edge where urbanization processes are rapid and chaotic deng et al 2015 godfray et al 2010 liu et al 2017 the concept of urban growth boundaries ugb dates back to the great britain s green belt in the 1930s nelson 1985 a classical application of ugb for reference worldwide is the definition of regional boundaries in portland oregon the usa in the 1960s nelson and moore 1993 by defining the ugb urban development is constrained within the boundary while areas outside are protected from being occupied particularly those important ecological lands and farmland nelson and moore 1993 tayyebi et al 2011 ugb practices have been carried out for preventing urban sprawl by optimizing urban function layout with the aims of stimulating a compact and resource saving urban development and improving the quality of urban space bhatta 2009 the ideas of ugb delimitation can be categorized into three types 1 growth driven method which is based on the demand for urban land growth in the planning year 2 anti planning method which excludes unsuitable construction zones such as ecological lands and ecologically sensitive zones and 3 a combination of the previous two methods huang et al 2019 currently the ugb delimitation are mainly conducted in two ways 1 expert based approach which is based on planners working experience and the constraints of administrative instructions of local government mainly during the urban master planning li et al 2019 and 2 model based approach that uses urban growth models which stimulate land use pattern in the end of the planning year the expert based approach is advantaged in making decisions according to their working experiences and domain knowledge while can be short for being subjective thus the results often vary among different experts long et al 2013 besides an insufficient incorporation of multiple stakeholders demands can be a weakness li et al 2019 comparatively the model based approach allows for a quantitative support ma et al 2017 but is limited for those factors considered for land use simulation thus a potential ignorance of key factors may produce biased results he et al 2018 moreover data availability sometimes can be a problem li et al 2011 mcgarigal et al 2018 the model based approach is increasingly applied in ugb delimitation as the development of computer science and an increasing availability of data among them the ca based models are widely used for being flexible in considering the suitability or constraint of urban growth by combing the assessments of for example land suitability zheng et al 2017 and ecologically sensitivity li et al 2019 as the process of land use change is highly complex and non linear thus can be difficult to identify based on historical land use changes lambin et al 2001 with this regard a prediction of future land use change based on advanced algorithms is requested for ugb delimitation accordingly ca based models are developed by coupling algorithms such as artificial neural networks anns wu and silva 2010 ant colony optimization aco li et al 2011 and genetic algorithm shan et al 2008 as well as a combination of these algorithms the cellular automata based ca based models keep on evolving to deal with the increasingly complex and multiple demands among various stakeholders in the practices of ugb delimitation landscape model is one of such land use simulation models and is applied in this study and is superior to other ca based models in hierarchical allocation strategy among multiple land use types ke et al 2017 despite the practices of ugb delimitation have been carried out during the past decades there occurs ineffectiveness sometimes this ineffectiveness can be resulted from the fragmented pattern of ugb and the insufficient space for urban development in the near future actually compact cities have been one of the leading global paradigms of sustainable urbanism since the early 1990s cec 1990 and are favoured for limiting the loss of green and natural areas bibri et al 2020 moreover the compactness is a high priority factor for ecological conservation and favours for cropland protection matisziw and murray 2006 however most of current studies may suffer potential failures for allowing urban expansion on the premise of avoiding occupying protected areas in specific in most studies ecosystem conservation dominates the concept of ugb delimitation rather than an integrated consideration of integrated factors see examples such as mcgarigal et al 2018 and ma et al 2017 which take the integrity of ecological systems or ecological sensitivity as the constraints of future land use simulation in some other studies cropland protection is also excluded from the area of ugb in priority huang et al 2019 li et al 2019 zheng and lv 2016 this may lead to an increase in fragmentation and newly added urban areas scattered distributed therefore this study aims to see whether a model based approach can be proposed in order to facilitate its effective implementation that integratedly coordinates cropland protection ecosystem conservation and urban compactness into the ugb delimitation nowadays the ugb has been widely put into practice worldwide including cities in china benfield et al 2001 huang et al 2019 china is one of the countries that undergoes rapid urbanization and has reached an urbanization rate of 63 89 in 2020 http english www gov cn as the urban population in china is projected to reach 1 4 billion by 2050 un 2021 and the process of urbanization is expected to continue in the near future in such a dense population country cropland protection is necessary to confront from the challenge of food security liu et al 2015 song and pijanowski 2014 in the meanwhile as the conscious of environment protection among the public has been aroused and the demand for high quality of life ecosystem conservation has become increasingly important in recent years such targets have been exploring to be incorporated in the ugb delimitation in china the urban construction boundaries ucbs have been requested in urban master and detailed plans with the release of the act of urban and rural planning in china li et al 2019 in addition borderlines defining urban ecological agricultural spaces have been initiated by the general land use planning and general urban planning liu et al 2017 the ugb delimitation has been put into practice in 14 pilot cities in 2014 nationwide and followed by another 600 cities and towns in more recent years ma et al 2017 2 methods 2 1 research framework according to the aim of this study the fundamental step of ugb delimitation is to optimize land use pattern by meeting the demand of urban land in the planning year 2030 and mitigating the negative impacts on ecosystem conservation cropland protection and urban compactness at the minimum this can be realized by converting those inferior ecological lands and cropland for supporting urban expansion in priority at the same time the urban compactness should be facilitated by converting newly added urban lands where adjacent to existed urban area habitat quality is taken as an indicator to reflect the superiority of the ecological lands liu et al 2017 and is quantified by using the invest integrated valuation of ecosystem services and tradeoffs model sharp et al 2015 agricultural production potential is used to reflect the superiority of cropland in fertility fischer et al 2012 urban compactness index is calculated to indicate the compact level of the urban expansion li et al 2011 a rapidly urbanizing megacity wuhan in central china is selected as the study area to conduct the analysis the land use patterns are simulated in 2030 in response to a 10 year period 2021 2030 as a customary urban planning time the demand for urban land in 2030 is calculated with a logarithmic function based on historical data appendix 1 the landscape model is accordingly applied to simulate land uses for both scenarios in wuhan in 2030 the overall research framework follows the steps of scenario setting up model calibration land use simulation ugb delimitation effect analysis fig 1 in order to show the effect of the ugb delimitation incorporated with ecosystem conservation and cropland protection two scenarios are set up for comparison 1 scenario 1 short for sc1 hereafter as a referenced scenario for comparison urban development is prohibited within ecosystem conservation zone primary cropland protection area and without considering the neighbourhood effect and 2 scenario 2 short for sc2 hereafter urban development is coordinately considered with ecosystem conservation cropland protection and the neighbourhood effect 2 2 ugb delimitation in 2030 with the landscape model the landscape model is developed as a cellular automata ca model it is capable of revealing interaction between multiple land use types based on a hierarchical allocation strategy which performs better than other traditional ca models ke et al 2017 depending on the relationship with human demands land use types are grouped into an active or passive type white and engelen 1997 subsequently these two land use types are allocated in two interactive processes in the landscape model in specific active land use types such as built up area and rural settlement are allocated hierarchically based on the sequence of aggressiveness namely the most aggressive land use type is allocated in priority and followed by a less competitive one subsequently passive land types e g forest and wetland would change based on the change of active land use types suitability and resistance together determine the transfer rule of a land use type the suitability reflects the suitable degree of a location to transfer to a target land use type influenced by driving forces and the resistance denotes the difficulty of one land use type transferring to another ke et al 2017 by following ke et al 2017 the suitability is determined by land use terrain accessibility soil and meteorological data and the resistance is calculated based on the superiority of agricultural production potential and habitat quality appendix 2 the landscape model should be calibrated for accuracy before being used for projecting land use change accuracy assessment can be measured by a model s goodness of fit rykiel 1996 kappa simulation of the map comparison kit which is developed by the netherlands environmental assessment agency pbl visser and de nijs 2006 is applied to calculate the accuracy of landscape model by following van vliet et al 2011 the score of kappa simulation varying from 1 to 1 indicating a higher accuracy with a higher value in specific 1 indicates a perfect match between simulated and observed land use map 0 indicates the model accuracy is as the same as a random model while a value below 0 indicates an inaccurate model result the model calibration is conducted by using the observed land use maps in 2000 and 2010 a calibrated land use simulation model landscape is used to simulate land use patterns in 2030 for both scenarios ke et al 2017 based on the simulated land use maps the ugb can be delimitated 1 extract urban areas 2 exclude scattered patches to enable the ugb encompasses areas within it compact and broadly connected following liu et al 2017 and the size is set as smaller than 5 km2 according to the scattered and small parcels of simulated land uses of wuhan and 3 draw a smooth and closed curve along the urban boundary with the remaining areas by using the arcgis 10 2 liang et al 2018 2 3 effect evaluation of ugb delimitation 2 3 1 ecosystem conservation reflected by habitat quality the habitat quality is quantified with the application of invest model according to sharp et al 2015 information of land use land change lulc and threats to biodiversity are combined to produce habitat quality maps in order to reveal the relative extent and degradation of different types of habitat types in a region and changes across time the suitability of a land use type for being a habitat differs among different land use types a weight is given to a raster of lulc to indicate the suitability of a specific lulc as a habitat appendix 3 following sharp et al 2015 moreover habitat threat density is required to show the impact on habitat quality and is revealed by the road accessibility and proximity to agricultural land sharp et al 2015 appendix 4 let the quality of habitat in parcel x that is in lulc j be given by qxj 1 q x j h j 1 d x j z d x j z k z where hj refers to the habitat s suitability dxj indicates the degree of degradation of a grid unit x associated with a land use type j z is an intrinsic conversion factor setting up as 2 5 and k was a half saturation factor setting up as 5 by following sharp et al 2015 2 3 2 cropland protection reflected by agricultural production potential change in agricultural production potential from 2015 to 2030 can be assessed based on the difference between this periods of time agricultural production potential in 2015 and 2030 are reflected by the data in 2000 and 2008 respectively due to the limitation of data availability 2 3 3 urban compactness measured by the index of urban compactness compactness index is often applied to measure the landscape pattern characterized as the ration of the area to the perimeter for each urban patch li et al 2011 this study applies an average compactness index and is expressed as f c o m p a c t p 1 p 2 π a p π l p p where f c o m p a c t is the average compactness of urban patches p is the total number of urban patches a p and l p are the area and the perimeter of patch p respectively p 1 2 p 2 4 study area wuhan is a rapidly urbanizing megacity in central china which covers an area of 8569 68 km2 there are 12 33 million inhabitants and more than 80 of which are urban dwellers by the end of 2020 tjj wuhan gov cn the average annual population growth rate reached 2 34 between 2010 and 2020 which is much higher than a national average level of 0 53 national bureau of statistics of china 2021 more than half of the area in wuhan is covered by cropland hubei bureau of statistics 2020 fig 2 and most of the soils are suitable for agricultural production wuhan is also named as the city of hundreds of lakes which provides important habitats for biodiversity while in the past years the landscape tends to be more fragmented and irregular during urban expansion tan et al 2014 and has resulted in server lake shrinkage and water ecosystem degradation the citizens quality of life is negatively influenced by the deteriorated ecosystem and environmental problems such as urban flooding chen et al 2018 and urban heat island debbage and shepherd 2015 wuhan has been listed as a hub city in the outline of yangtze river economic belt development plan which stands out the important role of this area in the national economy development in china therefore wuhan is expected to develop under a fierce competition among economic development ecosystem conservation and cropland protection 2 5 data sources six data sets are needed in this research land use data ecosystem conservation zone cropland protection zone agricultural production potential traffic data and population table 1 land use data in 2005 and 2015 are used for landscape model calibration land use data in 2015 is further used as the basic map for land use simulation in 2030 and to extract the urban area and cropland as the threat for habitat quality in quantifying habitat quality sharp et al 2015 ecosystem conservation zone and cropland protection zone are taken as the constraint for prohibited occupied areas in land use simulation in sc1 due to the data availability agricultural production potential in 2000 and 2008 are applied to reflect the status of 2015 and 2030 respectively traffic data is used as one of the threats of habitat quality sharp et al 2015 the population data from 2000 to 2016 are used to predict the future population in 2030 in order to further estimate the demand for urban land in 2030 all data are converted to raster data with a resolution of 100 m 100 m for being consistent with the land use data 3 results 3 1 calibration of landscape model a simulated land use map in 2015 based on 2005 was used for model calibration by testing the level of agreement between which and the observed land use map in 2015 mitsova et al 2011 the result shows that kappa simulation score of all land use types were larger than 0 appendix 5 which validates the calibrated landscape model is capable to provide reliable results moreover the scores of ktransition are generally higher than those of ktransloc indicating that changes in quantity among land use types were simulated more accurately than changes in location van vliet et al 2013 with the calibrated landscape model land use patterns in 2030 were simulated for the two scenarios 3 2 land use simulations in 2030 of both scenarios according to historical land use data in wuhan from 2000 to 2016 a logarithmic function was applied and projected the demand for built up area in 2030 as 1071 21 km2 appendix 1 habitat quality is quantified by applying the invest model for both scenarios the land use simulations in both scenarios are displayed in fig 3 wuhan covers a total area of 8569 68 km2 and is dominated by cropland at a proportion of 55 95 table 2 wetland and built up area rank the second and third at a proportion of 15 80 and 12 50 respectively grassland bareland and rural settlement are the least at 0 67 0 78 and 2 82 respectively comparing with the land use in 2015 the most significant change in 2030 is the increase of built up area which accounts in 75 69 this is mainly at the cost of grassland rural settlement and bareland at about 12 more than 8 and less than 8 respectively 3 3 ugb delimitation based on the simulated land use types in 2030 the ugb have been delimitated for each scenario by using arcgis 10 2 fig 4 as is shown in the figure most of the built up areas concentrated in the urban center have been delimited within the ugb presenting a compact and contiguous pattern there is 85 built up area encompassed by the ugb leaving the rest of the built up area which are scattered and in small sizes excluded in addition it is unavoidable to include some other land use types that locate in the city center inside the ugb which are mainly cropland and wetland accounts for about 15 and 14 respectively 3 4 effect evaluation of ugb delimitation the spatial differences are found in the loss in agricultural production potential the loss in habitat quality and the change in urban compactness between the two scenarios from 2015 to 2030 in particular the loss in agricultural production potential presents higher values in the north part as well as along the yangtze river while those of lower values are mainly in the south and further to the yangtze river fig 5 in general the loss in agricultural production potential is slightly lower in sc2 at 39 45 compared to sc1 at 39 62 table 3 this indicates that the effect of cropland protection is better in sc2 than sc1 the losses in habitat quality show spatial differences with higher values where wetlands are distributed concentrated in the south part and northeast within the ugb fig 6 this includes the south lake in the southeast part area within the ugb and hou lake jinyin lake and houguan lake in the west the loss in habitat quality is overall slightly lower in sc2 at 34 34 compared to sc1 at 34 62 table 4 this indicates that sc2 performs better in maintaining habitat quality than sc1 by applying the average compactness index the urban compactness of both scenarios are measured results show that the change in urban compactness is larger in sc2 at 5 11 compared to sc1 at 4 88 table 5 this indicates that sc2 also performs better in the improvement of urban compactness than sc1 4 discussion 4 1 land use simulations with the landscape model the landscape model allows for future land use simulation for combining land suitability and constrains which are neighbourhood effect agricultural production potential and habitat quality in our study this capability of accurate land use prediction confronted from the complex urbanization process improves the effect in ugb implementation in practice zheng and lv 2016 the landscape model is properly applied in simulating future land uses as our focus is on illustrating the scenario based utility of this model rather than developing a more advanced urban growth model or details of the evaluation of agricultural production potential and ecological assessment there are many other ca based models that are advantaged in mitigating conflicts among multiple objectives for example ant colony optimization aco algorithms which considers zoning protected natural areas and multi type land use allocation li et al 2011 the landscape model differs from such approaches in its superiority of higher simulation accuracy more importantly its hierarchical allocation strategy allows for an explicit determination of the allocation sequence by urban expansion taking place in ecological lands and cropland from inferior area to superior area in sequence 4 2 effect of ugb delimitation 4 2 1 the loss in agricultural production potential 2015 2030 the effect of sc2 is better in cropland protection compared to sc1 can be partly resulted from that superior lands are less occupied during urban expansion sc2 allows urban expansion to take place where agricultural production potential are inferior rather than strictly prohibits in primary cropland protection areas in sc1 as most other studies did one of the differences between the two scenarios lies in the flexibility of allowing a proper occupation in farmland in sc2 although cropland protection is regarded as one of the aims of ugb delimitation ever since the ugb concept was proposed cropland is far less considered than ecological conservation in the ugb delimitation in early years for example ma et al 2017 takes the layer of cropland protection zone as the suitability map li et al 2019 regards cropland protection zone as one of the resources of green infrastructure in this study cropland protection is more directly considered as one of the targets as important as ecosystem conservation and is measured by agricultural production potential this is useful in protecting those fertile lands excluded from the primary cropland protection zone especially in wuhan where the average fertility of agricultural production is high 4 2 2 the loss in habitat quality 2015 2030 as one of the important target of ugb delimitation ecosystem conservation is considered in various ways this ensures the ugb to facilitate biodiversity maintenance and environmental health to the public for example to assess the green infrastructure to stand out conservation priorities into urban growth simulation by identifying natural or restored space that forms a green network li et al 2019 the evaluation of ecological sensitivity is also widely used for considering ecosystem conservation jia et al 2019 liu et al 2017 delimitated the urban development boundary by mitigating the conflict between urban development and ecological conservation by measuring habitat quality with the invest model to reflect the resistance of a parcel of land to be occupied during urbanization which is in line with our study the effect of sc2 is better in ecosystem conservation compared to sc1 is mainly resulted from that superior habitat are less occupied during urban expansion the most significant losses of habitat quality corresponds to the lakes which indicates the role of wetland in maintaining habitat quality in the study area 4 2 3 the change in urban compactness 2015 2030 the ugb delimitation performs better in sc2 because the parcels of built up areas encompassed by the ugb are larger and more contiguous the more compact pattern in sc2 can be directly resulted from this scenarios allows for a more flexible scheme of land use change among multiple land use types contrasting to sc1 which strictly prohibits urban expansion to protected cropland and protected ecological zone the higher urban compactness facilitates the effect of ugb implementation as was argued by santé et al 2008 who found a compact urban patch is preferred by developers to perform development activities to control the urban sprawl is meaningful to megacities including wuhan and hangzhou li et al 2019 tan et al 2014 xu et al 2018 as well as other rapidly urbanizing cities that tend to occur urban sprawl tong et al 2017 in addition our approach is in line with the opinions who state the necessity of the ugb delimitation being flexible to allow a proper urban expansion to adjacent open space in order to support economic development cho et al 2007 jun 2004 xu et al 2018 4 3 implication for land use guidance the study aims to call for the ugb delimitation by avoiding the conflicts among various regulation zones such as farmland protection area and ecosystem conservation zone as well as urban compactness integratedly this is true in current land use in china where are implementing various regulation lines for example red line for prime cropland protection blue line for water protection and ugb is one of such lines called green line these lines sometimes show spatial overlay thus their spatial regulations sometimes can be difficult he et al 2018 one aims of the ugb delimitation is to orientate a compact urban development bhatta 2009 while some studies are limited in presenting a compact and contiguous pattern this is particularly true for those with the anti planning approach which identify ugb by avoiding ecological conservation zone or primary farmland protection zones can results in expanding newly added urban land scattered and fragmented around the city edge which reduces the urban compactness our approach calls for an integratedly ugb delimitation by considering cropland protection and ecosystem conservation rather than considering these aspects in sequence this facilitates the pattern of land use simulation more compact and contiguous which is helpful in enhancing the effect of implementation 4 4 limitation of this study it should be acknowledged that there are some limitations of land use simulation one of which is the large ignorance of some other biophysical factors e g precipitation and elevation and socioeconomic factors e g distance to important sites that may influence the way of urban expansion this can result in a difference between the simulated maps and that in reality for example the topography factor may limit the way urban expands as is documented by he et al 2018 in the role of the lakes and yangtz river in influencing the shape of ugb in wuhan moreover as a typical socioeconomic factor the market incentives of land price are not incorporated in this study supporters believe that ugb delimited in areas where are more accessible to higher house price and transportation facilities may be risky of ineffective implementation dempsey and plantinga 2013 long et al 2013 in this case the 13 districts in wuhan varies in geographic and socioeconomic conditions for the well developed wuchang district in the center of wuhan an effective implementation may be more difficult than a less developed jiangxia district in the south of wuhan however the advantage of considering such simple constraints is to highlight the impact of cropland protection ecosystem conservation and urban compactness on the ugb delimitation rather than other factors 5 conclusion this study proposed an approach that integratedly coordinates cropland protection ecosystem conservation and urban compactness in the ugb delimitation with a land use simulation model landscape land use patterns in two scenarios are projected in 2030 by comparing the losses in agricultural production potential habitat quality and the change in urban compactness encompassed by ugb between 2015 and 2030 the result indicates our proposed approach sc2 performs better in all the aspects of cropland protection ecosystem conservation and urban compactness thereby our approach is potential to improve the effect of ugb implementation in practice compared to other studies that only consider one or two aspects among them in practice identifying ugb encounters much more complex situations including the game for urban land quota at different levels of governments land use demands among different departments environmental risk and social cohesion the effectiveness of ugb implementation is largely rely on how these conflicts are alleviated this study supplies an open approach to address such constraints in an integrated way in the ugb delimitation credit authorship contribution statement ting zhou conceptualization methodology software formal analysis data curation writing original draft visualization funding acquisition xi yang conceptualization methodology software formal analysis investigation resources writing review editing supervision xinli ke conceptualization validation investigation resources writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was funded by the national natural science foundation of china grant numbers 42101265 41971240 and the fellowship of china postdoctoral science foundation grant number 2021t140240 appendix 1 historical data of built up area in wuhan 2008 2016 unit km2 year area of built up area 2008 460 00 2009 466 60 2010 484 01 2011 506 42 2012 520 30 2013 543 28 2014 552 61 2015 566 13 2016 585 61 the equation was established as ŷ t 1 14 723 967455 e0 031532k 14 264 appendix 2 parameters of landscape model land use types demand in each land use type in 2030 km2 active passive resistance cropland active 1 4 forest passive 1 3 grassland passive 1 3 river passive 1 2 wetland passive 1 3 built up area 1071 21 active 1 5 rural settlement active 1 1 appendix 3 suitability parameters of lulc as a habitat in the invest model lulc land use types habitat agriculture paved road urban area 1 cropland 0 0 0 0 2 forest 1 0 7 0 6 0 6 3 grassland 0 6 0 7 0 6 0 6 4 river 0 9 0 9 0 9 0 9 5 wetland 0 9 0 9 0 9 0 9 6 built up area 0 0 0 0 7 rural 0 0 0 0 8 unused 0 6 0 4 0 6 0 6 note referenced by sharp et al 2015 appendix 4 attributes of threats threat max dist weight decay cropland 8 1 linear road 5 0 7 exponential urban 5 0 7 exponential appendix 5 kappa simulation score for each land use type land uses cropland forest grassland river built up area rural settlement bareland kappa simulation score 0 228 0 075 0 064 1 000 0 448 0 069 0 090 note river is excluded from the table as it is set up unchanged during this period of time 
