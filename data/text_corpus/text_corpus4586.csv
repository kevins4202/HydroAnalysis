index,text
22930,modal parameters of an electrical submersible pump e s p installed in a test well were numerically and experimentally identified the numerical model was developed using the finite element method all the masses and stiffness elements necessary to evaluate the lateral vibration of the equipment were considered as well as the hydrodynamic added mass effect in the experimental test an impact hammer was used for exciting the e s p structure near the wellhead in the production pipe and not directly at equipment frame vibration signals along the e s p were acquired and eigensystem realization algorithm e r a method was used to identify the modal properties results showed the impact test as a useful method for modal parameters identification of e s p s installed in a test well however due to the location where the impacts were applied the lower vibration modes outside the operating range were not excited on the other hand the natural frequencies numerically identified were overestimated in comparison with those obtained experimentally keywords electrical submersible pump finite element method modal analysis eigensystem realization algorithm abbreviations α and β arbitrary positive integers δ t finite time difference ξ r damping ration of mode r λ r eigenvalue of mode r ρ fluid density σ matrix of singular values φ modal matrix in the state space coordinates ψ modal matrix in physical coordinates ω frequency ω r natural frequency of mode r ω r d natural damped natural frequency of mode r n r damping factor of mode r a system matrix in the space state representation b the entry matrix in the space state representation c output matrix in the space state representation d damping matrix f excitation force vector n number of degree of freedom h t impulse response function h k impulse response matrix h k hankel matrix j complex number notation k stiffness matrix k sample index in discrete time domain l number of measurement locations m mass matrix p number of excitation locations q observability matrix r vibration mode number r load distribution matrix s eigenvalue matrix related to the system natural frequencies and damping ratios s r eigenvalue of mode r t non singular matrix that represents a similarity transformation u matrix of singular vectors v matrix of singular vectors w controllability matrix a n p s d averaged normalized power spectrum density e r a eigensystem realization algorithm e s p electrical submersible pump f e m finite element method i r f impulse response function l s c e least square complex exponential s v d singular value decomposition 1 introduction electrical submersible pumps e s p s are of great interest in the oil industry due to their ability to pump large amounts of fluid over long distances being responsible for about 10 of the oil world production minette et al 2016 the artificial lift method by e s p consists of the installation of equipment into the well or near the head of the production well thus any kind of maintenance is very expensive and interventions are performed only when the system fails or when maintenance can be done remotely the installation of esp in satellite wells located in deep and ultra deep waters require large investments and the use of high daily cost drill ships the mean time to failure mttf of an e s p is around 2 3 years and the industry is working to increase this time making it economically competitive to the marine environment minette et al 2016 to increase the reliability of e s p s is of extreme importance to know the dynamic behavior during the equipment operation the operational condition closest to the real condition is when they are operating in a test well where electrical and mechanical tests are carried out to evaluate performance and dynamic behavior in a previous work minette et al 2016 the dynamic behavior of two e s p s were evaluated using impact tests the natural frequencies identified using the l s c e method least square complex exponential were compared with the results obtained in a sweep test where the own rotation of the e s p excites the natural frequency of the assembly as the operation range varies from 1800 to 3720 r p m 30 62 h z there is no way to use the sweep test to evaluate the modal parameters out of this range moreover the rotation variation is made by predetermined steps and it might not excite some natural frequency a numerical model of the esp was developed using the finite element method fem and the modal parameters obtained as a result were compared with those experimentally derived through the excitation of the esp with an impact hammer and using era method eigensystem realization algorithm for modal parameter identification 2 output only modal analysis the experimental modal analysis basically involves three steps i test preparing ii measurement of excitations and structure responses and iii modal parameter identification using techniques in the time and or frequency domain fu and he 2001 however the excitation force measurement of a system in operation is not always possible and this led to the development of methods in which the modal parameter identification is based only on the responses of the structure modal output only analysis freitas there are many modal identification methods in the literature these methods can be separated in the time domain and the frequency domain maia and e silva 1997 the time domain methods have the disadvantage that the number of system s degrees of freedom is unknown in advance while methods in the frequency domain have the disadvantage of presenting spectral leakage due to the signal acquisition time and the use of temporal windows windowing 2 1 eigensystem realization algorithm era the modal identification method used in this study is the eigensystem realization algorithm e r a which is a robust method in time domain able to deal with close or repeated vibration modes zhang et al 2001 the essence of e r a is to apply singular value decomposition svd in the free vibration responses to determine the minimum number of structure s degrees of freedom number of vibration modes and to determine the system matrix a the entry matrix b and the output matrix c using the space state representation the estimated system matrix may be used in the eigenvalue problem and thus determine the modal parameters when the dimensions of a b and c are minimal the minimum system realization is achieved a n degree of freedom system with p excitation forces is governed by equation 1 fu and he 2001 1 m n x n x n x 1 d n x n x n x 1 k n x n x n x 1 r n x p f p x 1 where m d and k are the mass damping and stiffness matrices of the system respectively and f is the excitation force vector and r is a load distribution matrix combining equation 1 with an identity matrix x i x and defining the space state variable x x x we can form equation 2 after sampling the system s response to obtain the discrete time version 2 x k 1 0 i m 1 k m 1 d x k 0 m 1 r f or 3 x k 1 a x k b f if the system has l output points the output vector y is related to the state variable through the output matrix c 4 y k l x 1 c l x 2 n x k 2 n x 1 by sampling the impulse response function h t we will have a time series function h k where k 1 2 3 the impulse response matrix considering all measurements is given by 5 h k h 11 k h 1 p k h l 1 k h l p k l x p the impulse response matrix can be written as a function of a b and c matrices according to equation 6 fu and he 2001 the constant matrices in the sequence are known as the markov parameters 6 h k c a k b k 1 2 the minimum realizaton of the impulse responses starts with the partioned hankel matrix which is built with the impulse response data 7 h k 1 h k h k 1 h k β 1 h k 1 h k 2 h k β h k α 1 h k α h k α β 2 l α x p β the minimum realization becomes a math task to find a b and c from h k so that the matrix order is minimal theoretically the rank of the matrix h k 1 is a constant and equal to the system order due to measurement noise the rank varies until the α and β in equation 7 reach certain values fu and he 2001 in this study α was considered equal to the number of degrees of freedom chosen a priori and β was chosen such that all samples of the time series were used allowing varying α models with different orders or degrees of freedom or vibration modes are estimated using a graphical tool known as stabilization diagram minette et al 2016 similarly the hankel matrix shifted by one consecutive time step is 8 h k h k 1 h k 2 h k β h k 2 h k 3 h k β 1 k α k α 1 k α β 1 l α x p β and can be decomposed as juang and pappa 1985 9 h k 1 q α a k 1 w β where q α is the observability and w β is the controllability matrices as defined in equations 10 and 11 10 q α c c a c a 2 c a α 1 l α x 2 n 11 w β b a b a 2 b a β 1 b 2 n x l β the derivation of the algorithm can start with equation 9 and with the initial impulse response matrix 12 h 0 q α w β on the other hand the singular value decomposition svd of matrix h 0 leads to equation 13 13 h 0 u σ 2 v t u l α x 2 n σ 2 n x 2 n 2 v 2 n x β p t the number of non zero singular values indicates the rank of h 0 which is the system order n the reduced diagonal matrix σ 2 n x 2 n 2 is obtained by omiting the zero singular values matrices u l α x 2 n and v 2 n x β n t are obtained by omiting the corresponding columns respectively from equations 12 and 13 14 q t u σ 15 t 1 w σ v t where t 2 n x 2 n is a non singular matrix that represents a similarity transformation and will always be set equal to the identity matrix knowing the matrix forms of equations 10 and 11 c and b can be obtained as the decomposition of equation 12 is not unique the shifted matrix is used for evaluating another decomposition expressed in equation 16 16 h 1 q α a w β thus from equations 12 16 matrices a b and c can be obtained 17 a σ 1 2 u h 1 v t σ 1 2 b σ 1 2 v e p c e l t u t σ 1 2 where the matrices e l t and e p t are defined as 18 e l t i l l x l 0 l x l 0 l x l l x l α 19 e p t i p p x p 0 p x p 0 p x p p x p β in equations 18 and 19 i p is a p x p and i l is a l x l identity matrices the eigenvalue solution of matrix a provides the system modal properties its eigenvalue decomposition is 20 ψ 1 a ψ s the modal matrix ψ in the state space coordinates contains 2 n complex mode shapes as shown in equation 20 the eigenvalues in the diagonal matrix s are related to the system natural frequencies and damping ratios as showed in the following equations considering the r t h eigenvalue 21 s r e λ r δ t a r j b r and knowing that each λ r is of the form 22 λ r n r j ω d r then combining equations 21 and 22 23 n r 1 2 δ t ln a 2 b 2 24 ω d r 1 δ t tan 1 b r a r so the undamped natural frequency and the damping ratio for each vibration mode can be derived 25 ω r ω d r 2 n r 2 26 ζ r n r ω r the modal matrix in physical coordinates φ is obtained by the following transformation 27 φ c ψ the confidence factor used in the e r a method to differenciate the structural modes from the numeric modes is the modal assurance criterion m a c juang and pappa 1985 the mac value is used to determine the similarity linearity of a mode shape when it is compared with another reference mode mac value goes from 0 to 1 0 corresponds to inconsistent modes and 1 corresponds to consistent modes the m a c value is calculated from the equation below caicedo 2011 28 m a c c d j 1 n φ c j φ d j 2 j 1 n φ c j 2 j 1 n φ d j 2 where φ c j is the j th coordinate of the mode shape c and φ d j is the j th coordinate of the mode shape d as the vibration mode is unknow a priori mac is used to compare the identified modes in each iteration the result is a vector indication of which modes are similar to the reference mode 2 2 stabilization diagram in the modal identification of a dynamic system in time domain the vibration modes system order is unknown a priori therefore it is customary to predefine a model order greater than that one expected in practice during the calculations this high order system leads to the appearance of computational or numerical modes mixed to the real modes ni et al 2012 one of the techniques used to separate the physical modes from the computational modes is through the utilization of the stabilization diagram peeters it is known that the physical modes remain stable when changing the system order while the computational modes do not if the modal parameters do not have much variation within a predetermined tolerance range then the mode is considered stable and thus considered real when the modal order varies otherwise if the variation of the modes is outside the tolerance range then the mode is considered spurious or computational in this study if the stabilization diagram was used with the natural frequencies values identified in x axis in function of the order number y axis overlapped to the diagram the a n p s d curve average normalized power spectrum density was also plotted minette et al 2016 3 numerical analysis using finite element method a numerical model of an e s p including the production pipe has been developed using f e m in order to obtain the natural frequencies and vibration modes of the structure within the operating range by simulating the operating conditions during the experimental test the finite element model was developed in two parts first an 3d model was used to evaluate the esp interaction with the fluid surrounding it since the esp is submerged which is represented by additional hydrodynamic mass in the second part with an 1d model the results of the addtional mass were used together with the structural model and submitted to a numerical modal analysis to obtain the natural frequencies and modes shapes of lateral vibration free vibration the contacts between the rotor stages bearings and the housing were considered rigid the 3d and 1d models developed with rhinoceros 5 cad software used shell and beam elements respectively the integrated model was solved using the hydrodynamic and structural packages of the ansys 15 software to build the model the e s p s geometric characteristics were taken into consideration including the production pipe pump suction seal motor and the bottom sensor according to the representation in fig 4 the position of the bearings between rotor and housing and the fluid within the pump and production pipe were also considered as the goal was to evaluate the lateral vibration disregarding the rotordynamic effect the e s p could be modeled as a hollow beam of circular section with all the components contributing to stiffness and mass 3 1 hydrodynamic added mass calculation when a body vibrates or moves at an accelerated motion in its six degrees of freedom in a fluid medium it leads the movement of the fluid particles in the body vicinity the reactions of these fluid particles to the moving body changes the body s dynamic behavior which requires the consideration of a virtual added mass that depends on the depth of the fluid medium and body shape korotkin 2008 to perform this calculation a cylinder of simple circular section of a radius r is considered partially submerged in a fluid of density ρ floating with its centroid coinciding with the waterline height assuming that the cylinder oscillates laterally and that its movement has small amplitude one can calculate the hydrodynamic added mass of the cylinder similarly the added mass can be calculated due to the lateral vibration of the esp a commercial software package has been used to calculate the hydrodynamic added mass fig 1 shows the added mass values of the e s p as a function of wave frequency it is noted that the maximum value is 139 37 k g for a wave frequency of 1 25 h z but for the frequency band analyzed the added mass may be considered as a constant which will not alter the results of the modal analysis the added mass was distributed along the e s p model 3 2 boundary conditions as the pump shaft is supported in the housing through bearings being one every four stages and four bearings in the electric motor appropriate connections for this condition were defined since they influence the rigidity of the set furthermore the e s p was considered as a beam simply supported at the wellhead to represent the experimental test condition fig 2 shows a typical stage distribution in an e s p 3 3 numerical results the computation of the natural frequencies and modes of vibration was conducted using a commercial finite element software package table 1 shows the results obtained in the frequency range from 0 to 100 h z it is observed that there are 7 modes of vibration within the esp s operating range between 30 h z and 62 h z besides numerical results show that there are three closely spaced modes within the operating range modes 12 t h 13 t h and 14 t h that in order to be identified experimentally requires the use of an output only modal identification method with this capability such as e r a fig 3 shows the rigid body motion and the following natural vibration modes of the esp p 18 62 s t a g e s s t g 1 s t to 19 t h 4 experimental analysis 4 1 test device the impacts were applied to the e s p p 18 62 stages installed in a test well the test well was about 35 m e t e r s in depth and 13 i n c h e s in diameter it was filled with water and connected to a closed circuit and instrumented as shown in fig 4 this structure is used to perform string tests in all e s p strings the details of this test were described in minette et al 2016 the only place available to apply the impacts in the esp is close to the point where it is supported on the production pipe at the wellhead the tests were conducted using an impact hammer with rubber tip p c b 086 d 50 model fig 4 also shows the point where the impacts were applied and the accelerometers locations three accelerometers were installed in each component except in the pump where only two accelerometers were installed resulting in 8 measuring points s 1 s 2 s 8 4 2 experimental results to identify the modal parameters only the accelerometers whose responses to the impact represented a free vibration signal with no distortion caused by noise were considered vibration signals were filtered with a low pass filter of 500 h z and re sampled with an acquisition rate of 1 k h z fig 5 shows the stabilization diagram for natural frequencies identified through the era method in the range from 0 to 100 h z the red line is the a n p s d average normalized power spectrum density which represents the average of the normalized power spectra of the vibration signals used for identification and the blue dots represent the natural frequencies that have reamained stable when varying the system order vibration modes in the stabilization diagram the identified natural frequencies correspond to peak values of the a n p s d table 2 shows the natural frequencies and their damping rates stabilized in the range from 0 to 100 h z these values were obtained when it was considered that the maximum number of modes presented in the free vibration signals was 80 5 results discussion table 3 below shows a comparison between the natural frequencies identified numerically f e m and those which have been identified experimentally with the e r a it is observed that there are three vibration modes below 5 h z which have not been experimentally identified this shows that the impact test did not excite the low vibration modes due to the location of the excitation point different impact hammers were used but even so the lower modes were not excited too much energy is required to excite the e s p structure in the frequency range from 0 to 5 h z since there is no way to change the application area of the impact which is near the wellhead as shown in fig 4 as there was the risk of damaging the structure to excite the e s p in that frequency range this type of test was not performed experimentally 13 modes of vibration were identified whilst numerical analysis indicated the presence of 19 vibration modes in the range up to 100 h z taking as reference the experimental results the natural frequency of the 6 t h mode has the largest difference in relation to the numerical results 21 4 different boundary conditions were tested in the f e m model and none led to meaningful results other than those showed in table 3 the only parameter that significantly influenced the results was the hydrodynamic added mass the numerical analysis also showed seven 7 vibration modes within the e s p s operating range between 1800 and 3720 r p m from 30 to 62 h z three are closely spaced modes modes 12 13 and 14 as e r a is a method capable of identifying closely spaced and coupled modes we can conclude that the impact test was not able to excite the closely spaced modes considering that the impact test excited the majority of the vibration modes in the range from 0 to 100 h z with a 78 accuracy rate and taking into consideration the results published in reference minette et al 2016 where two e s p s of different sizes were tested the impact test at the production pipe can be acknowledged as a useful method for identifying the modal parameters of e s p strings the advantage of this method is that the e s p does not need to be operating nor the excitation force has to be measured 6 conclusion in this paper an e s p of 62 stages installed in a test well had its modal parameters identified numerically and experimentally in the experimental analysis only the vibration responses were used with the e r a eigensystem realization algorithm method the numerical analysis involved the development of a finite element model which calculates the natural frequencies and vibration modes in the range from 0 to 100 h z the operational range of the e s p is between 1800 and 3720 r p m from 30 to 62 h z due to the fact that the impact location was close to the wellhead it was not possible to excite the vibration modes in the range from 0 to 5 h z although different impact hammers have been used which leads to the conclusion that the impact test in these conditions favors the high frequency region the differences between the experimental and numerical results are due to the considerations concerning the hydrodynamic added mass nevertheless the f e m model can be calibrated to represent the experimental results obtained it is concluded that the impact test is a valuable method for identifying the modal parameters of e s p in test well and if it is necessary to identify all the vibration modes within the operating range the use of operational modal analysis o m a where the equipment is tested during normal operation should be considered this will be the next step of this research acknowledgement this study was possible due to sponsorship of petrobras through its research and development center cenpes under grant 5850 0106375 17 9 and the electrical submersible pump specialized workshop ue bcs located in mossoró rn brazil their technical group was preponderant to developing this work 
22930,modal parameters of an electrical submersible pump e s p installed in a test well were numerically and experimentally identified the numerical model was developed using the finite element method all the masses and stiffness elements necessary to evaluate the lateral vibration of the equipment were considered as well as the hydrodynamic added mass effect in the experimental test an impact hammer was used for exciting the e s p structure near the wellhead in the production pipe and not directly at equipment frame vibration signals along the e s p were acquired and eigensystem realization algorithm e r a method was used to identify the modal properties results showed the impact test as a useful method for modal parameters identification of e s p s installed in a test well however due to the location where the impacts were applied the lower vibration modes outside the operating range were not excited on the other hand the natural frequencies numerically identified were overestimated in comparison with those obtained experimentally keywords electrical submersible pump finite element method modal analysis eigensystem realization algorithm abbreviations α and β arbitrary positive integers δ t finite time difference ξ r damping ration of mode r λ r eigenvalue of mode r ρ fluid density σ matrix of singular values φ modal matrix in the state space coordinates ψ modal matrix in physical coordinates ω frequency ω r natural frequency of mode r ω r d natural damped natural frequency of mode r n r damping factor of mode r a system matrix in the space state representation b the entry matrix in the space state representation c output matrix in the space state representation d damping matrix f excitation force vector n number of degree of freedom h t impulse response function h k impulse response matrix h k hankel matrix j complex number notation k stiffness matrix k sample index in discrete time domain l number of measurement locations m mass matrix p number of excitation locations q observability matrix r vibration mode number r load distribution matrix s eigenvalue matrix related to the system natural frequencies and damping ratios s r eigenvalue of mode r t non singular matrix that represents a similarity transformation u matrix of singular vectors v matrix of singular vectors w controllability matrix a n p s d averaged normalized power spectrum density e r a eigensystem realization algorithm e s p electrical submersible pump f e m finite element method i r f impulse response function l s c e least square complex exponential s v d singular value decomposition 1 introduction electrical submersible pumps e s p s are of great interest in the oil industry due to their ability to pump large amounts of fluid over long distances being responsible for about 10 of the oil world production minette et al 2016 the artificial lift method by e s p consists of the installation of equipment into the well or near the head of the production well thus any kind of maintenance is very expensive and interventions are performed only when the system fails or when maintenance can be done remotely the installation of esp in satellite wells located in deep and ultra deep waters require large investments and the use of high daily cost drill ships the mean time to failure mttf of an e s p is around 2 3 years and the industry is working to increase this time making it economically competitive to the marine environment minette et al 2016 to increase the reliability of e s p s is of extreme importance to know the dynamic behavior during the equipment operation the operational condition closest to the real condition is when they are operating in a test well where electrical and mechanical tests are carried out to evaluate performance and dynamic behavior in a previous work minette et al 2016 the dynamic behavior of two e s p s were evaluated using impact tests the natural frequencies identified using the l s c e method least square complex exponential were compared with the results obtained in a sweep test where the own rotation of the e s p excites the natural frequency of the assembly as the operation range varies from 1800 to 3720 r p m 30 62 h z there is no way to use the sweep test to evaluate the modal parameters out of this range moreover the rotation variation is made by predetermined steps and it might not excite some natural frequency a numerical model of the esp was developed using the finite element method fem and the modal parameters obtained as a result were compared with those experimentally derived through the excitation of the esp with an impact hammer and using era method eigensystem realization algorithm for modal parameter identification 2 output only modal analysis the experimental modal analysis basically involves three steps i test preparing ii measurement of excitations and structure responses and iii modal parameter identification using techniques in the time and or frequency domain fu and he 2001 however the excitation force measurement of a system in operation is not always possible and this led to the development of methods in which the modal parameter identification is based only on the responses of the structure modal output only analysis freitas there are many modal identification methods in the literature these methods can be separated in the time domain and the frequency domain maia and e silva 1997 the time domain methods have the disadvantage that the number of system s degrees of freedom is unknown in advance while methods in the frequency domain have the disadvantage of presenting spectral leakage due to the signal acquisition time and the use of temporal windows windowing 2 1 eigensystem realization algorithm era the modal identification method used in this study is the eigensystem realization algorithm e r a which is a robust method in time domain able to deal with close or repeated vibration modes zhang et al 2001 the essence of e r a is to apply singular value decomposition svd in the free vibration responses to determine the minimum number of structure s degrees of freedom number of vibration modes and to determine the system matrix a the entry matrix b and the output matrix c using the space state representation the estimated system matrix may be used in the eigenvalue problem and thus determine the modal parameters when the dimensions of a b and c are minimal the minimum system realization is achieved a n degree of freedom system with p excitation forces is governed by equation 1 fu and he 2001 1 m n x n x n x 1 d n x n x n x 1 k n x n x n x 1 r n x p f p x 1 where m d and k are the mass damping and stiffness matrices of the system respectively and f is the excitation force vector and r is a load distribution matrix combining equation 1 with an identity matrix x i x and defining the space state variable x x x we can form equation 2 after sampling the system s response to obtain the discrete time version 2 x k 1 0 i m 1 k m 1 d x k 0 m 1 r f or 3 x k 1 a x k b f if the system has l output points the output vector y is related to the state variable through the output matrix c 4 y k l x 1 c l x 2 n x k 2 n x 1 by sampling the impulse response function h t we will have a time series function h k where k 1 2 3 the impulse response matrix considering all measurements is given by 5 h k h 11 k h 1 p k h l 1 k h l p k l x p the impulse response matrix can be written as a function of a b and c matrices according to equation 6 fu and he 2001 the constant matrices in the sequence are known as the markov parameters 6 h k c a k b k 1 2 the minimum realizaton of the impulse responses starts with the partioned hankel matrix which is built with the impulse response data 7 h k 1 h k h k 1 h k β 1 h k 1 h k 2 h k β h k α 1 h k α h k α β 2 l α x p β the minimum realization becomes a math task to find a b and c from h k so that the matrix order is minimal theoretically the rank of the matrix h k 1 is a constant and equal to the system order due to measurement noise the rank varies until the α and β in equation 7 reach certain values fu and he 2001 in this study α was considered equal to the number of degrees of freedom chosen a priori and β was chosen such that all samples of the time series were used allowing varying α models with different orders or degrees of freedom or vibration modes are estimated using a graphical tool known as stabilization diagram minette et al 2016 similarly the hankel matrix shifted by one consecutive time step is 8 h k h k 1 h k 2 h k β h k 2 h k 3 h k β 1 k α k α 1 k α β 1 l α x p β and can be decomposed as juang and pappa 1985 9 h k 1 q α a k 1 w β where q α is the observability and w β is the controllability matrices as defined in equations 10 and 11 10 q α c c a c a 2 c a α 1 l α x 2 n 11 w β b a b a 2 b a β 1 b 2 n x l β the derivation of the algorithm can start with equation 9 and with the initial impulse response matrix 12 h 0 q α w β on the other hand the singular value decomposition svd of matrix h 0 leads to equation 13 13 h 0 u σ 2 v t u l α x 2 n σ 2 n x 2 n 2 v 2 n x β p t the number of non zero singular values indicates the rank of h 0 which is the system order n the reduced diagonal matrix σ 2 n x 2 n 2 is obtained by omiting the zero singular values matrices u l α x 2 n and v 2 n x β n t are obtained by omiting the corresponding columns respectively from equations 12 and 13 14 q t u σ 15 t 1 w σ v t where t 2 n x 2 n is a non singular matrix that represents a similarity transformation and will always be set equal to the identity matrix knowing the matrix forms of equations 10 and 11 c and b can be obtained as the decomposition of equation 12 is not unique the shifted matrix is used for evaluating another decomposition expressed in equation 16 16 h 1 q α a w β thus from equations 12 16 matrices a b and c can be obtained 17 a σ 1 2 u h 1 v t σ 1 2 b σ 1 2 v e p c e l t u t σ 1 2 where the matrices e l t and e p t are defined as 18 e l t i l l x l 0 l x l 0 l x l l x l α 19 e p t i p p x p 0 p x p 0 p x p p x p β in equations 18 and 19 i p is a p x p and i l is a l x l identity matrices the eigenvalue solution of matrix a provides the system modal properties its eigenvalue decomposition is 20 ψ 1 a ψ s the modal matrix ψ in the state space coordinates contains 2 n complex mode shapes as shown in equation 20 the eigenvalues in the diagonal matrix s are related to the system natural frequencies and damping ratios as showed in the following equations considering the r t h eigenvalue 21 s r e λ r δ t a r j b r and knowing that each λ r is of the form 22 λ r n r j ω d r then combining equations 21 and 22 23 n r 1 2 δ t ln a 2 b 2 24 ω d r 1 δ t tan 1 b r a r so the undamped natural frequency and the damping ratio for each vibration mode can be derived 25 ω r ω d r 2 n r 2 26 ζ r n r ω r the modal matrix in physical coordinates φ is obtained by the following transformation 27 φ c ψ the confidence factor used in the e r a method to differenciate the structural modes from the numeric modes is the modal assurance criterion m a c juang and pappa 1985 the mac value is used to determine the similarity linearity of a mode shape when it is compared with another reference mode mac value goes from 0 to 1 0 corresponds to inconsistent modes and 1 corresponds to consistent modes the m a c value is calculated from the equation below caicedo 2011 28 m a c c d j 1 n φ c j φ d j 2 j 1 n φ c j 2 j 1 n φ d j 2 where φ c j is the j th coordinate of the mode shape c and φ d j is the j th coordinate of the mode shape d as the vibration mode is unknow a priori mac is used to compare the identified modes in each iteration the result is a vector indication of which modes are similar to the reference mode 2 2 stabilization diagram in the modal identification of a dynamic system in time domain the vibration modes system order is unknown a priori therefore it is customary to predefine a model order greater than that one expected in practice during the calculations this high order system leads to the appearance of computational or numerical modes mixed to the real modes ni et al 2012 one of the techniques used to separate the physical modes from the computational modes is through the utilization of the stabilization diagram peeters it is known that the physical modes remain stable when changing the system order while the computational modes do not if the modal parameters do not have much variation within a predetermined tolerance range then the mode is considered stable and thus considered real when the modal order varies otherwise if the variation of the modes is outside the tolerance range then the mode is considered spurious or computational in this study if the stabilization diagram was used with the natural frequencies values identified in x axis in function of the order number y axis overlapped to the diagram the a n p s d curve average normalized power spectrum density was also plotted minette et al 2016 3 numerical analysis using finite element method a numerical model of an e s p including the production pipe has been developed using f e m in order to obtain the natural frequencies and vibration modes of the structure within the operating range by simulating the operating conditions during the experimental test the finite element model was developed in two parts first an 3d model was used to evaluate the esp interaction with the fluid surrounding it since the esp is submerged which is represented by additional hydrodynamic mass in the second part with an 1d model the results of the addtional mass were used together with the structural model and submitted to a numerical modal analysis to obtain the natural frequencies and modes shapes of lateral vibration free vibration the contacts between the rotor stages bearings and the housing were considered rigid the 3d and 1d models developed with rhinoceros 5 cad software used shell and beam elements respectively the integrated model was solved using the hydrodynamic and structural packages of the ansys 15 software to build the model the e s p s geometric characteristics were taken into consideration including the production pipe pump suction seal motor and the bottom sensor according to the representation in fig 4 the position of the bearings between rotor and housing and the fluid within the pump and production pipe were also considered as the goal was to evaluate the lateral vibration disregarding the rotordynamic effect the e s p could be modeled as a hollow beam of circular section with all the components contributing to stiffness and mass 3 1 hydrodynamic added mass calculation when a body vibrates or moves at an accelerated motion in its six degrees of freedom in a fluid medium it leads the movement of the fluid particles in the body vicinity the reactions of these fluid particles to the moving body changes the body s dynamic behavior which requires the consideration of a virtual added mass that depends on the depth of the fluid medium and body shape korotkin 2008 to perform this calculation a cylinder of simple circular section of a radius r is considered partially submerged in a fluid of density ρ floating with its centroid coinciding with the waterline height assuming that the cylinder oscillates laterally and that its movement has small amplitude one can calculate the hydrodynamic added mass of the cylinder similarly the added mass can be calculated due to the lateral vibration of the esp a commercial software package has been used to calculate the hydrodynamic added mass fig 1 shows the added mass values of the e s p as a function of wave frequency it is noted that the maximum value is 139 37 k g for a wave frequency of 1 25 h z but for the frequency band analyzed the added mass may be considered as a constant which will not alter the results of the modal analysis the added mass was distributed along the e s p model 3 2 boundary conditions as the pump shaft is supported in the housing through bearings being one every four stages and four bearings in the electric motor appropriate connections for this condition were defined since they influence the rigidity of the set furthermore the e s p was considered as a beam simply supported at the wellhead to represent the experimental test condition fig 2 shows a typical stage distribution in an e s p 3 3 numerical results the computation of the natural frequencies and modes of vibration was conducted using a commercial finite element software package table 1 shows the results obtained in the frequency range from 0 to 100 h z it is observed that there are 7 modes of vibration within the esp s operating range between 30 h z and 62 h z besides numerical results show that there are three closely spaced modes within the operating range modes 12 t h 13 t h and 14 t h that in order to be identified experimentally requires the use of an output only modal identification method with this capability such as e r a fig 3 shows the rigid body motion and the following natural vibration modes of the esp p 18 62 s t a g e s s t g 1 s t to 19 t h 4 experimental analysis 4 1 test device the impacts were applied to the e s p p 18 62 stages installed in a test well the test well was about 35 m e t e r s in depth and 13 i n c h e s in diameter it was filled with water and connected to a closed circuit and instrumented as shown in fig 4 this structure is used to perform string tests in all e s p strings the details of this test were described in minette et al 2016 the only place available to apply the impacts in the esp is close to the point where it is supported on the production pipe at the wellhead the tests were conducted using an impact hammer with rubber tip p c b 086 d 50 model fig 4 also shows the point where the impacts were applied and the accelerometers locations three accelerometers were installed in each component except in the pump where only two accelerometers were installed resulting in 8 measuring points s 1 s 2 s 8 4 2 experimental results to identify the modal parameters only the accelerometers whose responses to the impact represented a free vibration signal with no distortion caused by noise were considered vibration signals were filtered with a low pass filter of 500 h z and re sampled with an acquisition rate of 1 k h z fig 5 shows the stabilization diagram for natural frequencies identified through the era method in the range from 0 to 100 h z the red line is the a n p s d average normalized power spectrum density which represents the average of the normalized power spectra of the vibration signals used for identification and the blue dots represent the natural frequencies that have reamained stable when varying the system order vibration modes in the stabilization diagram the identified natural frequencies correspond to peak values of the a n p s d table 2 shows the natural frequencies and their damping rates stabilized in the range from 0 to 100 h z these values were obtained when it was considered that the maximum number of modes presented in the free vibration signals was 80 5 results discussion table 3 below shows a comparison between the natural frequencies identified numerically f e m and those which have been identified experimentally with the e r a it is observed that there are three vibration modes below 5 h z which have not been experimentally identified this shows that the impact test did not excite the low vibration modes due to the location of the excitation point different impact hammers were used but even so the lower modes were not excited too much energy is required to excite the e s p structure in the frequency range from 0 to 5 h z since there is no way to change the application area of the impact which is near the wellhead as shown in fig 4 as there was the risk of damaging the structure to excite the e s p in that frequency range this type of test was not performed experimentally 13 modes of vibration were identified whilst numerical analysis indicated the presence of 19 vibration modes in the range up to 100 h z taking as reference the experimental results the natural frequency of the 6 t h mode has the largest difference in relation to the numerical results 21 4 different boundary conditions were tested in the f e m model and none led to meaningful results other than those showed in table 3 the only parameter that significantly influenced the results was the hydrodynamic added mass the numerical analysis also showed seven 7 vibration modes within the e s p s operating range between 1800 and 3720 r p m from 30 to 62 h z three are closely spaced modes modes 12 13 and 14 as e r a is a method capable of identifying closely spaced and coupled modes we can conclude that the impact test was not able to excite the closely spaced modes considering that the impact test excited the majority of the vibration modes in the range from 0 to 100 h z with a 78 accuracy rate and taking into consideration the results published in reference minette et al 2016 where two e s p s of different sizes were tested the impact test at the production pipe can be acknowledged as a useful method for identifying the modal parameters of e s p strings the advantage of this method is that the e s p does not need to be operating nor the excitation force has to be measured 6 conclusion in this paper an e s p of 62 stages installed in a test well had its modal parameters identified numerically and experimentally in the experimental analysis only the vibration responses were used with the e r a eigensystem realization algorithm method the numerical analysis involved the development of a finite element model which calculates the natural frequencies and vibration modes in the range from 0 to 100 h z the operational range of the e s p is between 1800 and 3720 r p m from 30 to 62 h z due to the fact that the impact location was close to the wellhead it was not possible to excite the vibration modes in the range from 0 to 5 h z although different impact hammers have been used which leads to the conclusion that the impact test in these conditions favors the high frequency region the differences between the experimental and numerical results are due to the considerations concerning the hydrodynamic added mass nevertheless the f e m model can be calibrated to represent the experimental results obtained it is concluded that the impact test is a valuable method for identifying the modal parameters of e s p in test well and if it is necessary to identify all the vibration modes within the operating range the use of operational modal analysis o m a where the equipment is tested during normal operation should be considered this will be the next step of this research acknowledgement this study was possible due to sponsorship of petrobras through its research and development center cenpes under grant 5850 0106375 17 9 and the electrical submersible pump specialized workshop ue bcs located in mossoró rn brazil their technical group was preponderant to developing this work 
22931,this study aims to investigate a new turbine access system tas for offshore wind farms in taiwan strait sea conditions having a wave period of 7 5 s and a significant wave height of 1 5 m including the novel system integration of mechanism design hydraulic driving system and control system the dynamic co simulation of tas is achieved firstly for confirming the system design and parameters after that a full scale test rig is set up for experimental verification the vertical height the roll angle and the vertical acceleration of the tas end effector can be reduced effectively through the active motion compensation control for improving the access safety of the offshore wind turbine in simulation the dynamic modelling of mechanism is implemented by software adams the hydraulic driving system and the control system are derived mathematically in this study and implemented via matlab simulink then the dynamic simulation of tas is achieved through the co simulation of adams and matlab simulink for verifying the active compensation control performance of tas in addition fuzzy sliding mode control is used to develop the roll and pitch controllers for improving the compensation performance in the experiment a full scale test rig of tas is set up for verifying the effect of active compensation control system experimentally through the active compensation control experiment in the full scale test rig the vertical height the rolling angle and the vertical acceleration of the tas end effector can be reduced and validated by practical experiments keywords offshore wind turbine access system active motion compensation motion compensation control kinematics analysis dynamic simulation experiment 1 introduction due to the quick development of offshore wind energy taiwan is planning to develop 5 5 gw of offshore wind farm in taiwan strait by 2025 maritime engineering has become one of the important localization technology in taiwan how to reach safety assurance for the maintenance of offshore wind turbines becomes a significant issue in order to prevent maintenance staffs from the risk of getting in and out the offshore wind turbines the turbine access system tas is one of the necessary equipment tas of offshore wind turbines not only can ensure the safety of maintenance but also can effectively enhance the attendance of maritime ship and reduce the installation cost of maritime works in general the docking methods for docking vessel at the turbine influence the design of tas primarily different docking methods for connecting ship and wind turbines may lead to different design concepts of tas the main categories twidell and gaudiosi 2014 include i pushing the vessel against the tower through propeller thrust ii tying the vessel to the tower iii keeping the vessel at a short distance from the tower the docking methods i and ii rely on the propeller thrust to maintain vessel stability the docking method iii requires dynamic positioning system to make vessel positioning the docking methods i and ii can effectively reduce the degree of freedom dof of the vessel motion caused by waves the propeller thrust can counteract the motion in the direction of surge in addition the friction between bow and tower is large enough such that the motion in the directions of sway and yaw can be negligible therefore the two docking methods can reduce the dof of vessel motion from six dofs to three dofs so that only heave pitch and roll need to be considered cerda salzmann 2007 early tas usually installed some elastic rubber as damper in front of a catamaran or a small waterplane area twin hull swath to maintain a twin hull ship in the tower more easily ctruk 2015 such vessels can provide a larger front deck space and better stability to be applied in offshore wind farms however the above two kinds of ships are unable to actively compensate the motion caused by waves hence it is really dangerous when the maintenance staffs enter the tower since they not only need to tie the rope but also need to determine the right time to climb the tower the tas of maxccess bedford 2015 has large clamping jaws installed on the bow the jaws are controlled by the hydraulic servo system to fix the ship in the tower and stabilize the ship however a disadvantage may happen when the wave is too large it may generate a force that the jaws cannot withstand and result in fracture of the jaws company momac leske 2011 momac robotics de 2015 leske 1103 used the multi axis series industrial robotic arm set at stern for tas the advantages include high flexibility lighter weight and small required space however the series mechanism results in large cumulative error easy to shake and poor security besides only one person can be transported at the same time company ampelmann applied the stewart platform used in flight simulators for tas ampelmann 2015 keuning 2014 the parallel mechanism design platform can perform good stability and high security such that it can achieve high precision positioning nevertheless the mechanism is more complex easy to have singular point restrictions and requires large base space the tas designed by houlder houlder 2014 is only for compensating the ship motion of heave pitch and roll this tas mechanism is relatively simple inexpensive and has a large load capacity the disadvantage is that it cannot fully compensate ship shaking this study aims to investigate a new turbine access system for offshore wind farms in taiwan strait sea conditions having a wave period of 7 5 s and a significant wave height of 1 5 m including the novel system integration of mechanism design hydraulic driving system and control system the dynamic co simulation of tas is achieved firstly for confirming the system design and parameters through the co simulation of adams and matlab simulink for verifying the effect of active compensation control system of tas after that a full scale test rig is set up for experimental verification through the active compensation control experiment in the full scale test rig the vertical height the rolling angle and the vertical acceleration of the tas end effector can be reduced and verified by practical experiments 2 layout of tas in consideration of manufacturing cost function and feasibility of practical application the tas proposed in this study is installed at the ship bow to compensate ship shaking as the ship is docking and pushing against the tower through the propeller thrust to reduce the degree of freedom of ship motion from six to three such as heave roll and pitch the tas only requires compensating three dofs of motion base on the three dofs of ship motion the design of tas includes three compensating systems in roll pitch and heave as shown in fig 1 the roll compensating system consists of a pair of differential hydraulic cylinders moving at the same time to achieve the rolling motion of tas in the pitch and heave compensating systems a tilted hydraulic cylinder is used to compensate the ship pitching and heaving motion simultaneously in the practical situation the maintenance staff will go from the side ladder to the upper aisle with handrails on both sides in order to facilitate the experiment this study simplifies the tas design without ladder and handrails the system configuration of tas test rig is shown in fig 2 in order to increase the hydraulic system response the hydraulic servo valves are mounted on the hydraulic cylinders directly the position sensors are fixed on hydraulic cylinders to measure the cylinder position in the control system the d a interface card sends out the control signal to drive the hydraulic servo valve and the a d interface card receives the feedback signals from position sensors besides the hydraulic power unit with supply pressure of 70 bar is set up the hydraulic circuit of tas shown in fig 2 and the specification of each components is given in table 1 3 ship motion modelling in this section we first establish the wave mathematical model and then analyze the motion of ship center induced by wave force 3 1 model of wave wave is complex and hard to be modelled and simulated since 1980 some publications have investigated the wave simulation including five categories 1 cycloidal formula proposed by fournier 1986 and suitable for shallow waves 2 profile formula proposed by peachy 1986 adopting the linear wave to formulate the sea wave suitable for the simulation of sea wave in deep sea area 3 beta spline formula proposed by ts o and barsky pauline 1987 by using the beta spline curve to describe the sea wave 4 long wave formula proposed by dai which first uses the mathematical model of long wave to find the control points of the beta spline curve and then simulates the wave based on the beta spline curve 5 crushing formula proposed by anjyo 1991 suitable for the establishment of a rough sense of the sea level however it is not suitable for large waves and surging situation according to the literature perng and tsai 1996 the long wave formula is suitable for describing the motion of ship docked at the tower the derived mathematical model is simple and convenient for the following simulation based on the long wave formula this study assumes that the sea surface consists of n different directions of the basic wave described as 1 y w a v e i 1 n a i sin k i x cos θ k i z sin θ 2 π f i t where a i is the wave amplitude k i is the wave length f i is the wave frequency θ is the wave direction flow angle and t represents time eq 1 contains four parameters a i k i f i and θ to be decided as the state of the waves on the sea changes dramatically over time this study selected the parameters according to the statistical method presented in fu 1984 and lu 1999 the statistical results showed that the probability of occurrence of wave height the wave length and the square size of wave period are rayleigh distribution the probability density functions of wave height h wave length l and wave period t are respectively expressed as 2 p h h 1 e π 4 h h 2 3 p l l 1 e π 4 l l 2 4 p t t 1 e π 4 2 t t 2 where h l and t are the average of wave height wave length and wave period as h l and t are given h l and t can be determined from eqs 2 4 correspondingly the values of h l and t in this study are the measured data of taiwan strait once h l and t are determined the wave amplitude a i the wave number k i and the wave frequency f i in eq 1 can be obtained by a h 2 k 2 π l and f 1 t the wave direction θ is described in fig 3 3 2 model of ship motion according to the wave data and model the ship motion in wave can be analyzed in order to simplify the complex ship motion in wave the following assumptions are made referring to kinsman 1984 when the ship is docked at the tower 1 assume ship is a rigid body and ignore the elastic deformation 2 ship motion can be solved by superposition of linear term 3 viscosity of water is negligible 4 the motion of ship is only 3 dof in roll pitch and heave as docking at the tower in this study we divide the ship into several segments and analyze the forces of waves applied to the ship according to fluid mechanics and then integrate all the force and moment on the center of gravity of the ship to derive the ship motion consider a segment of ship in the coordinate system shown in fig 4 and assume a vertical external force caused by waves affects the segment to move in the z direction as the segment reaches a new equilibrium position the impact of the hydrostatic force is 5 f c c z ζ where z is the motion of the segment in the z direction ζ is the water level of surface wave and c is the constant of restoring force in addition the hydrodynamic force contains damping force f b and internal force f a which can be respectively expressed as 6 f b b z ζ 7 f a a z z ζ where b is the damping constant a z is the added mass z and z are the vertical velocity and acceleration of the segment ζ and ζ are the vertical velocity and acceleration of the surface wave according to the newton s second law the dynamic equilibrium equation of the segment can be described as 8 f a z z ζ b z ζ c z ζ according to sandaruwan et al 2010 the total force and moments through the ship center of gravity can be expressed as 9 f t o t a l i 1 n f i l i l i l i m c g 10 τ t o t a l i 1 n f i l i where i represents the i th segment of the ship f i is the force acting on the i th segment l i is the vector from center of gravity of the ship to the segment and m c g is the gravity of the ship from eqs 9 and 10 the ship motion can be described by heave displacement z heave roll angle θ roll and pitch angle θ pitch 11 z h e a v e f t o t a l k ˆ m c d t d t 12 θ r o l l τ t o t a l i ˆ i x d t d t 13 θ p i t c h τ t o t a l j ˆ i y d t d t where i ˆ j ˆ and k ˆ are the unit vectors in the x y and z direction i x and i y are the moment of inertial in the x and y direction 4 kinematics of tas this section introduces the kinematics of tas including inverse kinematics and forward kinematics here both the inverse and forward kinematics of tas are derived in the geometrical projection analysis method spong et al 2006 yeh et al 2005 and solved by matlab 4 1 inverse kinematics of tas the inverse kinematics of tas is used to calculate the displacement of the hydraulic cylinders which are required to maintain the end effector at the desired position while the ship is moved by waves the ship motion can be described by heave displacement z heave roll angle θ roll and pitch angle θ pitch when the ship is turning θ roll in the roll direction tas must roll back with the same angle to achieve a full compensation that is 14 α r o l l θ r o l l for compensating the vertical height of the tas end effector the original height d of the end effector and the lengths m n p q are required as shown in fig 5 which values used in the tas are d 2 88 m m 12 02 m n 1 82 m p 0 9 m q 3 91 m besides the structural deviated angle γ 2 4 is also shown in fig 5 hence the height h of the end effector can be calculated as 15 h z h e a v e m sin θ p i t c h n cos θ p i t c h cos θ r o l l p cos θ p i t c h q sin α p i t c h θ p i t c h γ cos α r o l l θ r o l l where the compensated roll angle α roll is given in eq 14 and α pitch is the compensated pitch angle the vertical displacement of the end effector is defined as 16 h h d which is the difference between the height of end effector and the original height when h 0 the vertical height is fully compensated with 17 α p i t c h sin 1 d z h e a v e m sin θ p i t c h n cos θ p i t c h cos θ r o l l p cos θ p i t c h q θ p i t c h γ which can be calculated from eqs 14 16 to generate the compensated roll angle in eq 14 the displacement of the hydraulic cylinders shown in fig 6 can be obtained as 18 x r o l l w r o l l 2 t r o l l 2 2 w r o l l t r o l l cos β r o l l α r o l l l r o l l where l roll 0 89m w roll 0 66m t roll 0 53m and β roll 96 7 similarly for generating the compensated pitch angle in eq 17 the displacement of the hydraulic cylinder shown in fig 7 can be obtained as 19 x p i t c h w p i t c h 2 t p i t c h 2 2 w p i t c h t p i t c h cos β p i t c h α p i t c h l p i t c h where l pitch 1 17m w pitch 1 41m t pitch 0 66m and β pitch 55 75 4 2 forward kinematics of tas according to the displacement of the hydraulic cylinders in roll motion given in eq 18 the roll angle of tas can be calculated as 20 α r o l l cos 1 w r o l l 2 t r o l l 2 x r o l l l r o l l 2 2 w r o l l t r o l l β r o l l the roll angle of end effector is obtained as 21 η r o l l α r o l l where θ roll is roll angle of ship similarly from eq 20 the pitch angle of tas can be calculated as 22 α p i t c h cos 1 w p i t c h 2 t p i t c h 2 x p i t c h l p i t c h 2 2 w p i t c h t p i t c h β p i t c h from eqs 15 and 16 the vertical displacement of end effector can be obtained as 23 h z h e a v e m sin θ p i t c h n cos θ p i t c h cos θ r o l l p cos θ p i t c h q sin α p i t c h θ p i t c h γ cos α r o l l θ r o l l d besides the vertical acceleration a d 2 h d t 2 is adopted as a performance index for comparison 5 dynamic modelling of tas this section introduces the dynamic modelling of tas including the hydraulic servo system dynamics and tas mechanism dynamics here the dynamic model of hydraulic servo system is derived and then implemented by matlab simulink including the valve dynamic equation the flow equation and the continuity equation then the dynamic model of tas mechanism can be implemented by adams for more detailed consideration of mechanism model 5 1 dynamic modelling of hydraulic servo system in the hydraulic servo system the input control signals make the valve spool generate displacement and force for adjusting volume flow and pressure eventually the pressure difference on the hydraulic cylinder results in the piston displacement therefore the mathematical models of hydraulic servo system contain the dynamic model of hydraulic servo valve and the dynamic model of hydraulic cylinder since the mechanism of hydraulic servo valve is complicated neglect the leakage of hydraulic oil and the pressure loss in hydraulic pipelines to simplify the mathematical model 5 1 1 dynamics model of valve spool the dynamic characteristics of servo valve requires high order nonlinear equations to describe due to its complex structure since the response of ship motion is not so fast in this study the valve spool model can be reduced to a second order system the relationship between the spool displacement y and the input current i is described as 24 y 2 ξ ω n y ω n 2 y ω n 2 v v i with damping ratio ξ natural frequency ωn and servo valve gain vv 5 1 2 flow equation the 4 way 3 position servo valve is used in this study to drive a single rod hydraulic cylinder as shown in fig 8 the volume flow of the chambers a and b are given as 25 q a q 1 q 2 q b q 4 q 3 where q k is the kth flow of servo valve k 1 2 3 4 which can be determined from the orifice equation expressed as 26 q c o a o 2 δ p ρ where q is the volume flow c o is the dimensionless orifice flow coefficient usually set as 0 625 a o is the open area of the orifice ρ is the oil density and δp is the pressure difference if the displacement y satisfies y y 0 the open area the servo valve is 27 a o π d y y 0 where d is the diameter of the spool and y 0 is the valve overlap for convenience the flow in eq 26 can be rewritten as 28 q b y y 0 δ p where 29 b 0 625 π d 2 ρ in conclusion the flow equation of each port of 4 way 3 position servo valve can be described as below 30 q 1 b y y 0 p 0 p a y y 0 0 q 1 0 y y 0 0 q 2 b y y 0 p a y y 0 0 q 2 0 y y 0 0 q 3 b y y 0 p 0 p b y y 0 0 q 3 0 y y 0 0 q 4 b y y 0 p b y y 0 0 q 4 0 y y 0 0 where p 0 is the original pressure and p a and p b are respectively the pressures of chamber a and chamber b 5 1 3 continuity equation in the hydraulic cylinder the continuity equation describes the effective flow of the chamber a related to the piston speed x p as 31 q e f f a q a q l i p q l e p x p a a where q lip and q lep are the internal and external leakages both leakages are given as 32 q l i p k l i p p a p b q l e p k l e p p a with constant coefficients k lip and k lep similarly the effective flow of the chamber b can be expressed as 33 q e f f b q b q l i p q l e p x p a b the hydraulic capacity of chamber a can be described as 34 c h a v t o t a h a x p a a b o i l a where b oil a is the bulk modulus v tot a is the bulk of pipe and h a is the stroke the bulk modulus can be defined as 35 b o i l a v a p a v a where v a a a x p and p a are respectively the bulk and the pressure of chamber a similarly the capacity of chamber b can be expressed as 36 c h b v t o t b h b x p a b b o i l b the relationship between the pressure change of hydraulic cylinder δp and the effective flow q eff is shown as 37 δ p a q e f f a c h a d t 38 δ p b q e f f b c h b d t 5 2 dynamic modelling of tas mechanism the dynamic modelling of tas mechanism is introduced however due to the complexity of the system it is hard to model the system by the newton s second law instead this study uses the software adams to simulate the dynamics model of tas mechanism for considering the mechanism dynamics more accurately the mechanism of tas is designed by solidworks first and then imported into software adams to simulate the dynamic model after setting the required parameters and functions 6 controller design 6 1 design of roll and pitch controller under the changing sea conditions in the taiwan strait it is not suitable to use the pid controller to compensate the ship motion since the pid controller needs to adjust the parameters when the sea condition changes instead in this study we choose the fuzzy sliding mode controller fsmc which can adapt to different sea conditions in many fuzzy control systems the fuzzy rule base simultaneously depends on both control error e and error rate e such that the number of the fuzzy inference rules increases and the membership functions are complicated the fuzzy sliding mode control system however introduces a fuzzy sliding surface function σ for not only reducing the dimensions of the input space and the number of fuzzy inference rules but also improving the system robustness as shown in fig 9 consider a non linear system 39 x n t f n x t d t u x n d n x d t n where x t x x x n 1 t is the state vector f n x t is a non linear function with bound f n x t d t is a disturbance bounded by d t and u is the control input the tracking error of the state vector is defined as 40 e t x t x d t e e e n 1 t where x d t is the target conventional fuzzy control uses two variables control error e and its derivative e to establish a two dimensional fuzzy rule base in fsmc the sliding surface of nth order system is introduced as 41 σ x t d d t α n 1 e 0 where α is a positive constant hence the fuzzy sliding surface of a second order system can be defined as 42 σ α e e z e r o as shown in fig 10 the positive constant α is the gradient of the fuzzy sliding surface σ z e r o and φ indicates the boundary layer of the fuzzy sliding surface fig 11 shows the membership functions of the sliding function σ and the control input u the sliding function σ can be divided by seven fuzzy rules r 1 to r 7 r 1 if σ is nb then u is nb r 2 if σ is nm then u is nm r 3 if σ is ns then u is ns r 4 if σ is zr then u is zr r 5 if σ is ps then u is ps r 6 if σ is pm then u is pm r 7 if σ is pb then u is pb in the fuzzy rules the control input u is partitioned by the membership function and all the labels of fuzzy set nb nm ns zr ps pm and pb respectively stand for negative big negative medium negative small zero positive small positive medium and positive big the mamdani method is used for fuzzy inference and the center of area defuzzifier is selected and given as 43 u f g u μ u u d u μ u d u where μ u indicates the membership function of the control input u and g u is the proportional element 6 2 control system layout of simulation and experiment fig 12 shows the block diagram of overall tas control system in simulation where the sea condition is provided to calculate the ship motion caused by waves to compensate the wave induced motion of end effector the required displacement of each hydraulic cylinders is determined by the inverse kinematics which become the target position of each hydraulic cylinder for the closed loop position control of hydraulic system furthermore fsmc algorithm is used to design the pitch and roll controllers to make the hydraulic cylinders generate force correspondingly to drive the tas fig 13 shows the block diagram of overall tas control system in experiment in the experiment the control input from the controllers designed by fsmc is given to the hydraulic systems to drive the test rig and the position of each hydraulic cylinder is measured by position sensors and fed back to the controllers furthermore based on the measured position of the hydraulic cylinders the position of tas end effector can be calculated according to the forward kinematics 7 results and discussion this section contains closed loop simulation and experiment of test rig to verify the tas control performance based on fig 12 the overall system simulation is achieved via the co simulation of adams and matlab simulink besides the overall system experiment in test rig is performed via real time workshop of matlab simulink according to figs 2 and 13 since the sea wave condition influences the ship motion the motion variation of the ship s gravity center caused by the given sea wave condition of taiwan offshore wind farm of wave period of 7 5 s significant wave height of 1 5 m and wave direction of 45 is shown in fig 14 besides the fsmc pid control designed by ziegler and nichols method is also used for comparison according to the ship motion in fig 14 the desired position for the hydraulic cylinders of pitch and roll to compensate the motion of end effector can be calculated by the inverse kinematics which are given as the target position trajectory of each cylinder fig 15 shows the control responses of the pitch and roll hydraulic control system in simulation and experiment fig 15 a and d show the position control responses in fig 15 b the control errors of pitch hydraulic cylinder are within 120 mm for pid control experiment 30 mm for fsmc simulation and 60 mm for fsmc experiment the integral of absolute error iae of pitch hydraulic cylinder is shown in fig 15 c for clear comparison obviously the iae of fsmc experiment shows less than that of the pid experiment so that the better control performance of fsmc can be verified in fig 15 e the control errors of roll hydraulic cylinder can be achieved within 19 mm for pid control experiment 5 mm for fsmc simulation and 5 mm for fsmc experiment similarly the iae of roll hydraulic cylinder in fig 15 f shows that the fsmc can achieve better control performance than the pid experimen therefore according to the simulation and experiment results the control performance of fsmc is better than that of the pid control furthermore the active motion compensation response at tas end effector can be compared and confirmed through the roll angle vertical displacement and vertical acceleration of the end effector fig 16 shows the active motion compensation results at tas end effector including vertical displacement response of end effector in fig 16 a roll angle response of end effector in fig 16 b and vertical acceleration response of end effector in fig 16 c in the condition without compensation the vertical displacement roll angle and vertical acceleration of end effector significantly change within 1 3 m of vertical displacement 3 3 of roll angle and 1 3 m sec2 of vertical acceleration respectively after the work of the active motion compensation the vertical displacement change of end effector can be reduced to 0 2 m in fsmc simulation 0 75 m in the experimental results of pid control and 0 35 m in the experimental results of fsmc the roll angle variation can also be diminished to 0 5 in fsmc simulation 2 in the experimental results of pid control and 0 5 in the experimental results of fsmc the vertical acceleration of end effector can also be reduced to 0 7 m sec2 in fsmc simulation 1 5 m sec2 in the experimental results of pid control and 1 m sec2 in the experimental results of fsmc therefore through the verification and comparison in simulation and experiment both fsmc and pid control can achieve motion compensation effect however fsmc can perform obviously better than pid control for active motion compensation of tas end effector 8 conclusions this study developed a tas with 3 dof active motion compensation system of the offshore wind farms for taiwan strait sea conditions of wave period of 7 5 s and significant wave height of 1 5 m the system is driven by pitch and roll active motion compensation control systems using fsmc the dynamic co simulation of tas via adams and matlab simulink were achieved for confirming the system design and parameters in addition a full scale test rig combined with real time workshop of matlab simulink was set up for experimental verification under the sea condition of taiwan strait with wave period of 7 5 s and significant wave height of 1 5 m the vertical displacement the roll angle and the vertical acceleration of the tas end effector can be reduced effectively through the active compensation control in both simulation and experiment besides fsmc and pid control were used to develop the roll and pitch controllers for comparing the control performance according to the simulation and experimental results both fsmc and pid control can achieve motion compensation effect and fsmc can achieve obviously better performance than pid control for active motion compensation of tas end effector finally the tas proposed in this study has been verified in simulation and experiment with satisfactory active motion compensation performance acknowledgement the research was sponsored by the ministry of science and technology taiwan under the grant most 106 2221 e 002 109 my3 
22931,this study aims to investigate a new turbine access system tas for offshore wind farms in taiwan strait sea conditions having a wave period of 7 5 s and a significant wave height of 1 5 m including the novel system integration of mechanism design hydraulic driving system and control system the dynamic co simulation of tas is achieved firstly for confirming the system design and parameters after that a full scale test rig is set up for experimental verification the vertical height the roll angle and the vertical acceleration of the tas end effector can be reduced effectively through the active motion compensation control for improving the access safety of the offshore wind turbine in simulation the dynamic modelling of mechanism is implemented by software adams the hydraulic driving system and the control system are derived mathematically in this study and implemented via matlab simulink then the dynamic simulation of tas is achieved through the co simulation of adams and matlab simulink for verifying the active compensation control performance of tas in addition fuzzy sliding mode control is used to develop the roll and pitch controllers for improving the compensation performance in the experiment a full scale test rig of tas is set up for verifying the effect of active compensation control system experimentally through the active compensation control experiment in the full scale test rig the vertical height the rolling angle and the vertical acceleration of the tas end effector can be reduced and validated by practical experiments keywords offshore wind turbine access system active motion compensation motion compensation control kinematics analysis dynamic simulation experiment 1 introduction due to the quick development of offshore wind energy taiwan is planning to develop 5 5 gw of offshore wind farm in taiwan strait by 2025 maritime engineering has become one of the important localization technology in taiwan how to reach safety assurance for the maintenance of offshore wind turbines becomes a significant issue in order to prevent maintenance staffs from the risk of getting in and out the offshore wind turbines the turbine access system tas is one of the necessary equipment tas of offshore wind turbines not only can ensure the safety of maintenance but also can effectively enhance the attendance of maritime ship and reduce the installation cost of maritime works in general the docking methods for docking vessel at the turbine influence the design of tas primarily different docking methods for connecting ship and wind turbines may lead to different design concepts of tas the main categories twidell and gaudiosi 2014 include i pushing the vessel against the tower through propeller thrust ii tying the vessel to the tower iii keeping the vessel at a short distance from the tower the docking methods i and ii rely on the propeller thrust to maintain vessel stability the docking method iii requires dynamic positioning system to make vessel positioning the docking methods i and ii can effectively reduce the degree of freedom dof of the vessel motion caused by waves the propeller thrust can counteract the motion in the direction of surge in addition the friction between bow and tower is large enough such that the motion in the directions of sway and yaw can be negligible therefore the two docking methods can reduce the dof of vessel motion from six dofs to three dofs so that only heave pitch and roll need to be considered cerda salzmann 2007 early tas usually installed some elastic rubber as damper in front of a catamaran or a small waterplane area twin hull swath to maintain a twin hull ship in the tower more easily ctruk 2015 such vessels can provide a larger front deck space and better stability to be applied in offshore wind farms however the above two kinds of ships are unable to actively compensate the motion caused by waves hence it is really dangerous when the maintenance staffs enter the tower since they not only need to tie the rope but also need to determine the right time to climb the tower the tas of maxccess bedford 2015 has large clamping jaws installed on the bow the jaws are controlled by the hydraulic servo system to fix the ship in the tower and stabilize the ship however a disadvantage may happen when the wave is too large it may generate a force that the jaws cannot withstand and result in fracture of the jaws company momac leske 2011 momac robotics de 2015 leske 1103 used the multi axis series industrial robotic arm set at stern for tas the advantages include high flexibility lighter weight and small required space however the series mechanism results in large cumulative error easy to shake and poor security besides only one person can be transported at the same time company ampelmann applied the stewart platform used in flight simulators for tas ampelmann 2015 keuning 2014 the parallel mechanism design platform can perform good stability and high security such that it can achieve high precision positioning nevertheless the mechanism is more complex easy to have singular point restrictions and requires large base space the tas designed by houlder houlder 2014 is only for compensating the ship motion of heave pitch and roll this tas mechanism is relatively simple inexpensive and has a large load capacity the disadvantage is that it cannot fully compensate ship shaking this study aims to investigate a new turbine access system for offshore wind farms in taiwan strait sea conditions having a wave period of 7 5 s and a significant wave height of 1 5 m including the novel system integration of mechanism design hydraulic driving system and control system the dynamic co simulation of tas is achieved firstly for confirming the system design and parameters through the co simulation of adams and matlab simulink for verifying the effect of active compensation control system of tas after that a full scale test rig is set up for experimental verification through the active compensation control experiment in the full scale test rig the vertical height the rolling angle and the vertical acceleration of the tas end effector can be reduced and verified by practical experiments 2 layout of tas in consideration of manufacturing cost function and feasibility of practical application the tas proposed in this study is installed at the ship bow to compensate ship shaking as the ship is docking and pushing against the tower through the propeller thrust to reduce the degree of freedom of ship motion from six to three such as heave roll and pitch the tas only requires compensating three dofs of motion base on the three dofs of ship motion the design of tas includes three compensating systems in roll pitch and heave as shown in fig 1 the roll compensating system consists of a pair of differential hydraulic cylinders moving at the same time to achieve the rolling motion of tas in the pitch and heave compensating systems a tilted hydraulic cylinder is used to compensate the ship pitching and heaving motion simultaneously in the practical situation the maintenance staff will go from the side ladder to the upper aisle with handrails on both sides in order to facilitate the experiment this study simplifies the tas design without ladder and handrails the system configuration of tas test rig is shown in fig 2 in order to increase the hydraulic system response the hydraulic servo valves are mounted on the hydraulic cylinders directly the position sensors are fixed on hydraulic cylinders to measure the cylinder position in the control system the d a interface card sends out the control signal to drive the hydraulic servo valve and the a d interface card receives the feedback signals from position sensors besides the hydraulic power unit with supply pressure of 70 bar is set up the hydraulic circuit of tas shown in fig 2 and the specification of each components is given in table 1 3 ship motion modelling in this section we first establish the wave mathematical model and then analyze the motion of ship center induced by wave force 3 1 model of wave wave is complex and hard to be modelled and simulated since 1980 some publications have investigated the wave simulation including five categories 1 cycloidal formula proposed by fournier 1986 and suitable for shallow waves 2 profile formula proposed by peachy 1986 adopting the linear wave to formulate the sea wave suitable for the simulation of sea wave in deep sea area 3 beta spline formula proposed by ts o and barsky pauline 1987 by using the beta spline curve to describe the sea wave 4 long wave formula proposed by dai which first uses the mathematical model of long wave to find the control points of the beta spline curve and then simulates the wave based on the beta spline curve 5 crushing formula proposed by anjyo 1991 suitable for the establishment of a rough sense of the sea level however it is not suitable for large waves and surging situation according to the literature perng and tsai 1996 the long wave formula is suitable for describing the motion of ship docked at the tower the derived mathematical model is simple and convenient for the following simulation based on the long wave formula this study assumes that the sea surface consists of n different directions of the basic wave described as 1 y w a v e i 1 n a i sin k i x cos θ k i z sin θ 2 π f i t where a i is the wave amplitude k i is the wave length f i is the wave frequency θ is the wave direction flow angle and t represents time eq 1 contains four parameters a i k i f i and θ to be decided as the state of the waves on the sea changes dramatically over time this study selected the parameters according to the statistical method presented in fu 1984 and lu 1999 the statistical results showed that the probability of occurrence of wave height the wave length and the square size of wave period are rayleigh distribution the probability density functions of wave height h wave length l and wave period t are respectively expressed as 2 p h h 1 e π 4 h h 2 3 p l l 1 e π 4 l l 2 4 p t t 1 e π 4 2 t t 2 where h l and t are the average of wave height wave length and wave period as h l and t are given h l and t can be determined from eqs 2 4 correspondingly the values of h l and t in this study are the measured data of taiwan strait once h l and t are determined the wave amplitude a i the wave number k i and the wave frequency f i in eq 1 can be obtained by a h 2 k 2 π l and f 1 t the wave direction θ is described in fig 3 3 2 model of ship motion according to the wave data and model the ship motion in wave can be analyzed in order to simplify the complex ship motion in wave the following assumptions are made referring to kinsman 1984 when the ship is docked at the tower 1 assume ship is a rigid body and ignore the elastic deformation 2 ship motion can be solved by superposition of linear term 3 viscosity of water is negligible 4 the motion of ship is only 3 dof in roll pitch and heave as docking at the tower in this study we divide the ship into several segments and analyze the forces of waves applied to the ship according to fluid mechanics and then integrate all the force and moment on the center of gravity of the ship to derive the ship motion consider a segment of ship in the coordinate system shown in fig 4 and assume a vertical external force caused by waves affects the segment to move in the z direction as the segment reaches a new equilibrium position the impact of the hydrostatic force is 5 f c c z ζ where z is the motion of the segment in the z direction ζ is the water level of surface wave and c is the constant of restoring force in addition the hydrodynamic force contains damping force f b and internal force f a which can be respectively expressed as 6 f b b z ζ 7 f a a z z ζ where b is the damping constant a z is the added mass z and z are the vertical velocity and acceleration of the segment ζ and ζ are the vertical velocity and acceleration of the surface wave according to the newton s second law the dynamic equilibrium equation of the segment can be described as 8 f a z z ζ b z ζ c z ζ according to sandaruwan et al 2010 the total force and moments through the ship center of gravity can be expressed as 9 f t o t a l i 1 n f i l i l i l i m c g 10 τ t o t a l i 1 n f i l i where i represents the i th segment of the ship f i is the force acting on the i th segment l i is the vector from center of gravity of the ship to the segment and m c g is the gravity of the ship from eqs 9 and 10 the ship motion can be described by heave displacement z heave roll angle θ roll and pitch angle θ pitch 11 z h e a v e f t o t a l k ˆ m c d t d t 12 θ r o l l τ t o t a l i ˆ i x d t d t 13 θ p i t c h τ t o t a l j ˆ i y d t d t where i ˆ j ˆ and k ˆ are the unit vectors in the x y and z direction i x and i y are the moment of inertial in the x and y direction 4 kinematics of tas this section introduces the kinematics of tas including inverse kinematics and forward kinematics here both the inverse and forward kinematics of tas are derived in the geometrical projection analysis method spong et al 2006 yeh et al 2005 and solved by matlab 4 1 inverse kinematics of tas the inverse kinematics of tas is used to calculate the displacement of the hydraulic cylinders which are required to maintain the end effector at the desired position while the ship is moved by waves the ship motion can be described by heave displacement z heave roll angle θ roll and pitch angle θ pitch when the ship is turning θ roll in the roll direction tas must roll back with the same angle to achieve a full compensation that is 14 α r o l l θ r o l l for compensating the vertical height of the tas end effector the original height d of the end effector and the lengths m n p q are required as shown in fig 5 which values used in the tas are d 2 88 m m 12 02 m n 1 82 m p 0 9 m q 3 91 m besides the structural deviated angle γ 2 4 is also shown in fig 5 hence the height h of the end effector can be calculated as 15 h z h e a v e m sin θ p i t c h n cos θ p i t c h cos θ r o l l p cos θ p i t c h q sin α p i t c h θ p i t c h γ cos α r o l l θ r o l l where the compensated roll angle α roll is given in eq 14 and α pitch is the compensated pitch angle the vertical displacement of the end effector is defined as 16 h h d which is the difference between the height of end effector and the original height when h 0 the vertical height is fully compensated with 17 α p i t c h sin 1 d z h e a v e m sin θ p i t c h n cos θ p i t c h cos θ r o l l p cos θ p i t c h q θ p i t c h γ which can be calculated from eqs 14 16 to generate the compensated roll angle in eq 14 the displacement of the hydraulic cylinders shown in fig 6 can be obtained as 18 x r o l l w r o l l 2 t r o l l 2 2 w r o l l t r o l l cos β r o l l α r o l l l r o l l where l roll 0 89m w roll 0 66m t roll 0 53m and β roll 96 7 similarly for generating the compensated pitch angle in eq 17 the displacement of the hydraulic cylinder shown in fig 7 can be obtained as 19 x p i t c h w p i t c h 2 t p i t c h 2 2 w p i t c h t p i t c h cos β p i t c h α p i t c h l p i t c h where l pitch 1 17m w pitch 1 41m t pitch 0 66m and β pitch 55 75 4 2 forward kinematics of tas according to the displacement of the hydraulic cylinders in roll motion given in eq 18 the roll angle of tas can be calculated as 20 α r o l l cos 1 w r o l l 2 t r o l l 2 x r o l l l r o l l 2 2 w r o l l t r o l l β r o l l the roll angle of end effector is obtained as 21 η r o l l α r o l l where θ roll is roll angle of ship similarly from eq 20 the pitch angle of tas can be calculated as 22 α p i t c h cos 1 w p i t c h 2 t p i t c h 2 x p i t c h l p i t c h 2 2 w p i t c h t p i t c h β p i t c h from eqs 15 and 16 the vertical displacement of end effector can be obtained as 23 h z h e a v e m sin θ p i t c h n cos θ p i t c h cos θ r o l l p cos θ p i t c h q sin α p i t c h θ p i t c h γ cos α r o l l θ r o l l d besides the vertical acceleration a d 2 h d t 2 is adopted as a performance index for comparison 5 dynamic modelling of tas this section introduces the dynamic modelling of tas including the hydraulic servo system dynamics and tas mechanism dynamics here the dynamic model of hydraulic servo system is derived and then implemented by matlab simulink including the valve dynamic equation the flow equation and the continuity equation then the dynamic model of tas mechanism can be implemented by adams for more detailed consideration of mechanism model 5 1 dynamic modelling of hydraulic servo system in the hydraulic servo system the input control signals make the valve spool generate displacement and force for adjusting volume flow and pressure eventually the pressure difference on the hydraulic cylinder results in the piston displacement therefore the mathematical models of hydraulic servo system contain the dynamic model of hydraulic servo valve and the dynamic model of hydraulic cylinder since the mechanism of hydraulic servo valve is complicated neglect the leakage of hydraulic oil and the pressure loss in hydraulic pipelines to simplify the mathematical model 5 1 1 dynamics model of valve spool the dynamic characteristics of servo valve requires high order nonlinear equations to describe due to its complex structure since the response of ship motion is not so fast in this study the valve spool model can be reduced to a second order system the relationship between the spool displacement y and the input current i is described as 24 y 2 ξ ω n y ω n 2 y ω n 2 v v i with damping ratio ξ natural frequency ωn and servo valve gain vv 5 1 2 flow equation the 4 way 3 position servo valve is used in this study to drive a single rod hydraulic cylinder as shown in fig 8 the volume flow of the chambers a and b are given as 25 q a q 1 q 2 q b q 4 q 3 where q k is the kth flow of servo valve k 1 2 3 4 which can be determined from the orifice equation expressed as 26 q c o a o 2 δ p ρ where q is the volume flow c o is the dimensionless orifice flow coefficient usually set as 0 625 a o is the open area of the orifice ρ is the oil density and δp is the pressure difference if the displacement y satisfies y y 0 the open area the servo valve is 27 a o π d y y 0 where d is the diameter of the spool and y 0 is the valve overlap for convenience the flow in eq 26 can be rewritten as 28 q b y y 0 δ p where 29 b 0 625 π d 2 ρ in conclusion the flow equation of each port of 4 way 3 position servo valve can be described as below 30 q 1 b y y 0 p 0 p a y y 0 0 q 1 0 y y 0 0 q 2 b y y 0 p a y y 0 0 q 2 0 y y 0 0 q 3 b y y 0 p 0 p b y y 0 0 q 3 0 y y 0 0 q 4 b y y 0 p b y y 0 0 q 4 0 y y 0 0 where p 0 is the original pressure and p a and p b are respectively the pressures of chamber a and chamber b 5 1 3 continuity equation in the hydraulic cylinder the continuity equation describes the effective flow of the chamber a related to the piston speed x p as 31 q e f f a q a q l i p q l e p x p a a where q lip and q lep are the internal and external leakages both leakages are given as 32 q l i p k l i p p a p b q l e p k l e p p a with constant coefficients k lip and k lep similarly the effective flow of the chamber b can be expressed as 33 q e f f b q b q l i p q l e p x p a b the hydraulic capacity of chamber a can be described as 34 c h a v t o t a h a x p a a b o i l a where b oil a is the bulk modulus v tot a is the bulk of pipe and h a is the stroke the bulk modulus can be defined as 35 b o i l a v a p a v a where v a a a x p and p a are respectively the bulk and the pressure of chamber a similarly the capacity of chamber b can be expressed as 36 c h b v t o t b h b x p a b b o i l b the relationship between the pressure change of hydraulic cylinder δp and the effective flow q eff is shown as 37 δ p a q e f f a c h a d t 38 δ p b q e f f b c h b d t 5 2 dynamic modelling of tas mechanism the dynamic modelling of tas mechanism is introduced however due to the complexity of the system it is hard to model the system by the newton s second law instead this study uses the software adams to simulate the dynamics model of tas mechanism for considering the mechanism dynamics more accurately the mechanism of tas is designed by solidworks first and then imported into software adams to simulate the dynamic model after setting the required parameters and functions 6 controller design 6 1 design of roll and pitch controller under the changing sea conditions in the taiwan strait it is not suitable to use the pid controller to compensate the ship motion since the pid controller needs to adjust the parameters when the sea condition changes instead in this study we choose the fuzzy sliding mode controller fsmc which can adapt to different sea conditions in many fuzzy control systems the fuzzy rule base simultaneously depends on both control error e and error rate e such that the number of the fuzzy inference rules increases and the membership functions are complicated the fuzzy sliding mode control system however introduces a fuzzy sliding surface function σ for not only reducing the dimensions of the input space and the number of fuzzy inference rules but also improving the system robustness as shown in fig 9 consider a non linear system 39 x n t f n x t d t u x n d n x d t n where x t x x x n 1 t is the state vector f n x t is a non linear function with bound f n x t d t is a disturbance bounded by d t and u is the control input the tracking error of the state vector is defined as 40 e t x t x d t e e e n 1 t where x d t is the target conventional fuzzy control uses two variables control error e and its derivative e to establish a two dimensional fuzzy rule base in fsmc the sliding surface of nth order system is introduced as 41 σ x t d d t α n 1 e 0 where α is a positive constant hence the fuzzy sliding surface of a second order system can be defined as 42 σ α e e z e r o as shown in fig 10 the positive constant α is the gradient of the fuzzy sliding surface σ z e r o and φ indicates the boundary layer of the fuzzy sliding surface fig 11 shows the membership functions of the sliding function σ and the control input u the sliding function σ can be divided by seven fuzzy rules r 1 to r 7 r 1 if σ is nb then u is nb r 2 if σ is nm then u is nm r 3 if σ is ns then u is ns r 4 if σ is zr then u is zr r 5 if σ is ps then u is ps r 6 if σ is pm then u is pm r 7 if σ is pb then u is pb in the fuzzy rules the control input u is partitioned by the membership function and all the labels of fuzzy set nb nm ns zr ps pm and pb respectively stand for negative big negative medium negative small zero positive small positive medium and positive big the mamdani method is used for fuzzy inference and the center of area defuzzifier is selected and given as 43 u f g u μ u u d u μ u d u where μ u indicates the membership function of the control input u and g u is the proportional element 6 2 control system layout of simulation and experiment fig 12 shows the block diagram of overall tas control system in simulation where the sea condition is provided to calculate the ship motion caused by waves to compensate the wave induced motion of end effector the required displacement of each hydraulic cylinders is determined by the inverse kinematics which become the target position of each hydraulic cylinder for the closed loop position control of hydraulic system furthermore fsmc algorithm is used to design the pitch and roll controllers to make the hydraulic cylinders generate force correspondingly to drive the tas fig 13 shows the block diagram of overall tas control system in experiment in the experiment the control input from the controllers designed by fsmc is given to the hydraulic systems to drive the test rig and the position of each hydraulic cylinder is measured by position sensors and fed back to the controllers furthermore based on the measured position of the hydraulic cylinders the position of tas end effector can be calculated according to the forward kinematics 7 results and discussion this section contains closed loop simulation and experiment of test rig to verify the tas control performance based on fig 12 the overall system simulation is achieved via the co simulation of adams and matlab simulink besides the overall system experiment in test rig is performed via real time workshop of matlab simulink according to figs 2 and 13 since the sea wave condition influences the ship motion the motion variation of the ship s gravity center caused by the given sea wave condition of taiwan offshore wind farm of wave period of 7 5 s significant wave height of 1 5 m and wave direction of 45 is shown in fig 14 besides the fsmc pid control designed by ziegler and nichols method is also used for comparison according to the ship motion in fig 14 the desired position for the hydraulic cylinders of pitch and roll to compensate the motion of end effector can be calculated by the inverse kinematics which are given as the target position trajectory of each cylinder fig 15 shows the control responses of the pitch and roll hydraulic control system in simulation and experiment fig 15 a and d show the position control responses in fig 15 b the control errors of pitch hydraulic cylinder are within 120 mm for pid control experiment 30 mm for fsmc simulation and 60 mm for fsmc experiment the integral of absolute error iae of pitch hydraulic cylinder is shown in fig 15 c for clear comparison obviously the iae of fsmc experiment shows less than that of the pid experiment so that the better control performance of fsmc can be verified in fig 15 e the control errors of roll hydraulic cylinder can be achieved within 19 mm for pid control experiment 5 mm for fsmc simulation and 5 mm for fsmc experiment similarly the iae of roll hydraulic cylinder in fig 15 f shows that the fsmc can achieve better control performance than the pid experimen therefore according to the simulation and experiment results the control performance of fsmc is better than that of the pid control furthermore the active motion compensation response at tas end effector can be compared and confirmed through the roll angle vertical displacement and vertical acceleration of the end effector fig 16 shows the active motion compensation results at tas end effector including vertical displacement response of end effector in fig 16 a roll angle response of end effector in fig 16 b and vertical acceleration response of end effector in fig 16 c in the condition without compensation the vertical displacement roll angle and vertical acceleration of end effector significantly change within 1 3 m of vertical displacement 3 3 of roll angle and 1 3 m sec2 of vertical acceleration respectively after the work of the active motion compensation the vertical displacement change of end effector can be reduced to 0 2 m in fsmc simulation 0 75 m in the experimental results of pid control and 0 35 m in the experimental results of fsmc the roll angle variation can also be diminished to 0 5 in fsmc simulation 2 in the experimental results of pid control and 0 5 in the experimental results of fsmc the vertical acceleration of end effector can also be reduced to 0 7 m sec2 in fsmc simulation 1 5 m sec2 in the experimental results of pid control and 1 m sec2 in the experimental results of fsmc therefore through the verification and comparison in simulation and experiment both fsmc and pid control can achieve motion compensation effect however fsmc can perform obviously better than pid control for active motion compensation of tas end effector 8 conclusions this study developed a tas with 3 dof active motion compensation system of the offshore wind farms for taiwan strait sea conditions of wave period of 7 5 s and significant wave height of 1 5 m the system is driven by pitch and roll active motion compensation control systems using fsmc the dynamic co simulation of tas via adams and matlab simulink were achieved for confirming the system design and parameters in addition a full scale test rig combined with real time workshop of matlab simulink was set up for experimental verification under the sea condition of taiwan strait with wave period of 7 5 s and significant wave height of 1 5 m the vertical displacement the roll angle and the vertical acceleration of the tas end effector can be reduced effectively through the active compensation control in both simulation and experiment besides fsmc and pid control were used to develop the roll and pitch controllers for comparing the control performance according to the simulation and experimental results both fsmc and pid control can achieve motion compensation effect and fsmc can achieve obviously better performance than pid control for active motion compensation of tas end effector finally the tas proposed in this study has been verified in simulation and experiment with satisfactory active motion compensation performance acknowledgement the research was sponsored by the ministry of science and technology taiwan under the grant most 106 2221 e 002 109 my3 
22932,arctic spar typically has a sloped hull surface near the waterline to break ice through bending however the rapid variation of its waterplane area by the heave motion may cause unexpected nonlinear behaviors which can result in instability in the current study the heave to pitch roll and heave to heave mathieu instability mi of arctic spar are investigated by using a nonlinear time domain simulation program the time dependent nonlinear hydrostatic restoring coefficient hc and nonlinear froude krylov fk force are considered for the instantaneous wetted body underneath the instantaneous wave elevation the effects of the two nonlinear terms for the generation of heave to pitch and heave to heave mi are systematically compared and discussed by employing four different approaches including conventional linear theory analytical equations of heave and pitch are also used with hill s infinite determinants method to determine the boundaries of mathieu s equation parameters where instability occurs through a series of numerical simulations the occurrences of both heave to pitch and heave to heave mi have been clearly demonstrated both in regular and irregular waves the simulated results agree well with the theoretical instability diagram the importance of the combined effects of nonlinear fk forces and nonlinear hc in triggering pronounced heave to heave mi is underscored especially in the case of 100 year storm condition keywords arctic spar mathieu instability mi nonlinear froude krylov fk force nonlinear hydrostatic restoring coefficient hc heave to pitch heave to heave mi fully coupled time domain simulation 1 introduction one of the greatest challenges in developing the arctic region is the severe environmental conditions caused by the presence of ice to reduce the impact of ice researchers have introduced a sloping wall concept which allows the ice to fail in a flexural mode for deeper arctic water a new spar platform design called arctic spar has been proposed in various publications chernetsov and karlinsky 2006 2008 murray et al 2009 murray and yang 2009 bruun et al 2009 2011 sablok et al 2011 jochmann and evers 2014 arctic spar is characterized by its conical shape around the mean water level and a mooring riser system that can be disconnected to avoid the impact of extreme ice because of the sloped hull shape at the waterline the nonlinear effects become significant when there is either considerable platform motion or steep waves these effects could result in nonlinear platform behavior with largely amplified motion through resonance the nonlinear behavior of a classic spar has been investigated numerically and experimentally by several researchers they have observed unstable pitch motion of mathieu type instability heave to pitch mi large heave motion at the half of pitch natural period induces amplified unstable pitch motion where the pitch natural period was twice that of the heave natural period previous literature about mathieu instability has presented insightful findings for a classic spar in particular koo et al 2004 conducted numerical tests for a classic spar with different damping models and concluded that the additional damping plays an important role in suppressing mathieu instability jingrui et al 2010 derived the heave pitch coupled equation of motion for a conventional spar and found that nonlinear motion may occur at the wave frequency close to the sum of heave and pitch natural frequencies yang and xu 2015 investigated the parametric instabilities of spar platforms in irregular waves and provided several suggestions to avoid the parametric pitch resonance the effect of various hulls of spar platforms on mathieu instability has also been investigated haslum and faltinsen 1999 studied the five alternative hull shapes and observed the heave and pitch instability using simplified methods wan et al 2015 performed experimental tests under survival conditions for a spar type floating offshore wind turbine equipped with a torus shape wave energy converter wec when the torus was locked to the spar at the mean water level the heave induced pitch instability occurred at the wave period equal to half of the pitch natural period nallayarasu and mathai 2016 2017a also conducted numerical and experimental tests and compared three spar models under regular wave tests however those papers above only considered the heave to pitch mathieu instability caused by the irregular hull shape near the waterline the current study aims to numerically investigate mathieu instability for arctic spar in both the pitch and heave directions caused by the conical shaped hull near the waterline as far as authors know the time domain nonlinear simulation results showing heave to heave mi the sinusoidally varying heave restoring force caused by the cone shaped hull surface near waterline induces amplified unstable heave motion especially when the heave motion period is at the half of heave natural period caused by the inclined surface near the waterline were not published in the open literature by considering the instantaneous submerged body underneath the instantaneous wave elevation the instantaneous entire wetted body is gridded and the corresponding nonlinear hydrostatic coefficients and fk forces are considered along with other constituent forces in a time domain simulation the equation of motion in heave and pitch is derived as a form of the mathieu equation the numerical results are discussed by varying the wave parameters and methodologies and are compared to the theoretical stability diagram at the end the dynamic performance of arctic spar under a 100 year storm condition including significant heave to heave mi is discussed 2 dynamics of arctic spar 2 1 nonlinear hydrostatic stiffness in a linear analysis restoring stiffness is linearized about the mean water level with the assumption that the body motion is small and the waterplane area is constant along the hull near the waterline however with large wave heights and body motions the effect of time varying nonlinear restoring stiffness is significant furthermore for arctic spar the waterplane area changes a lot with heave motions which means time dependent hydrostatic stiffness with respect to the instantaneous body position needs to be used we adopt the method used by guérinel et al 2011 and extend it to the 6 dof floater motions then the time dependent hydrostatic coefficients c h y d r o in heave 3 roll 4 pitch 5 and their coupling terms as well as the corresponding coordinate system see fig 1 can be defined as 1 c h y d r o 3 3 ρ g i 1 n n 3 i s w i t c h y d r o 3 4 ρ g i 1 n x 2 i t x 0 2 t n 3 i s w i t c h y d r o 3 5 ρ g i 1 n x 1 i t x 0 1 t n 3 i s w i t c h y d r o 4 4 ρ g i 1 n x 0 2 t x 2 i t 2 n 3 i s w i t ρ g t x b 3 t m g x g 3 t c h y d r o 4 5 ρ g i 1 n x 1 i t x 0 1 t x 2 i t x 0 2 t n 3 i s w i t c h y d r o 4 6 ρ g t x b 1 t m g x g 1 t c h y d r o 5 5 ρ g i 1 n x 0 1 t x 1 i t 2 n 3 i s w i t ρ g t x b 3 t m g x g 3 t c h y d r o 5 6 ρ g t x b 1 t m g x g 1 t where t i 1 n n j i x j i x 0 j t s w i t x b j t 1 2 t i 1 n n j x j x 0 j 2 s w i t where s w i t is the area of the wetted surface panel n is the total number of wetted surface panels x j i and n j i are the centroid of the submerged panel and normal vector x 0 j is the origin of a body coordinate t is the time varying submerged volume x b j is the time varying center of buoyancy x g j is the center of mass m is the mass g is the gravitational acceleration ρ is the density of water i denotes the ith panel and j of 1 2 and 3 denotes x y and z dimension 2 2 partially nonlinear wave forces in this paper the nonlinear wave forces on arctic spar are considered throughout the time domain numerical simulation the wave force is divided into four components as follows 2 f w a v e f l i n e a r d i f f f n o n l i n e a r f k f n o n l i n e a r d r a g f c o n v o l u t i o n where f w a v e is the total wave force f l i n e a r d i f f is the linear diffraction force caused by disturbed incident waves f n o n l i n e a r f k is the nonlinear fk force f n o n l i n e a r d r a g is the nonlinear viscous drag force and f c o n v o l u t i o n is the radiation damping force the linear diffraction force is calculated based on the first order 3d diffraction radiation potential theory during the time domain simulation the diffraction force remains linear the nonlinear fk force caused by undisturbed incident wave s pressure is calculated considering the instantaneous submerged structure position the structure mesh is re gridded using the euler angles method at every time step considering the instant body translations and rotations then the nonlinear fk force is evaluated by integrating the incident wave pressure on the instantaneous submerged body surface the equation of the nonlinear fk wave force is as follows 3 f n o n l i n e a r f k t i 1 n p i n j i s w i t j 1 2 3 m n o n l i n e a r f k t i 1 n p i r n j 3 i s w i t j 4 5 6 where p i ρ φ 0 t f o r x 3 i 0 p i x 3 i 0 f o r x 3 i 0 where p i is the pressure by incident waves r is the position vector from the body origin to the centroid of the ith panel and φ 0 is the velocity potential for incident waves above the mean water level the dynamic pressure is evaluated using the vertical stretching method such that the pressure above the mean water level is equal to the pressure at the waterline the nonlinear viscous drag force is evaluated at every time step by the morison s equation eq 4 considering wave particle kinematics at the instantaneous body position 4 f n o n l i n e a r d r a g 1 2 c d ρ a u ζ u ζ where c d is the drag coefficient a is the projected area u and ζ are the instantaneous wave particle and body velocities normal to the projected area at the instantaneous body position the nonlinear forces and moments induced by the viscous drag are calculated by integrating the forces on the discrete elements using the 6 point gaussian quadrature integration the fourth component f c o n v o l u t i o n is associated with radiation wave making damping and explained in the next sub section 2 3 hydrodynamic coefficients in the time domain the hydrodynamic coefficient is first calculated from the frequency domain 3d diffraction radiation panel program wamit 2006 and the results are converted to the form used in time domain simulation based on the kramers kronig relationship the radiation damping force can be expressed using the convolution integral form to represent the memory effects the added mass at infinite frequency is a function of the retardation function and remains constant as follows 5 f c o n v o l u t i o n t ζ t r t τ ζ τ d τ r t 2 π 0 b ϖ cos ϖ t d ϖ m a d d m a d d ϖ 0 r t cos ϖ t d t where f c o n v o l u t i o n is the radiation damping force x is the 6 dof velocities of the floating body r t is the retardation function b ϖ is the linear radiation damping matrix at frequency ϖ and m a d d is the added mass at infinite frequency 2 4 equation of arctic spar 6 dof motions in this paper the time dependent hydrostatic stiffness matrix c h y d r o t is considered and the nonlinear wave force is separated into the linear diffraction nonlinear fk nonlinear viscous drag and convolution damping forces then the equation of motion can be re written as 6 m m a d d ζ t c h y d r o t k m o o r i n g ζ t f l i n e a r d i f f t f n o n l i n e a r f k t f d r a g t f c o n v o l u t i o n t to solve the 6 dof dynamic equation of motion a combination of the adams bashforth and adams moulton methods is used with a constant time step for numerical integration the present approach is called the body nonlinear method with nonlinear fk force the fully nonlinear computation including fully nonlinear free surface and body surface conditions is extremely complex and time consuming since the instantaneous free surface and large size matrix equation need to be updated and solved at each time step therefore the present approach is not fully nonlinear but the most important body nonlinearity is included to investigate the resulting mi phenomenon 3 analytic investigation for the mathieu equation in heave and pitch motions for floating structures the waterplane area a w mainly contributes to the heave restoring stiffness represented by ρ g a w for arctic spar the time varying heave restoring coefficient due to the heave motion in open water can be calculated based on the time dependent waterplane area which changes with heave displacements and the wave elevation for the 45 degree slope case see figs 3 and 4 the waterplane area can be calculated as follows 7 ρ g a w ρ g π r o ζ 3 t η t 2 r i 2 ρ g π r o 2 r i 2 2 r o η t 2 r o ζ 3 t ζ 3 t η t 2 where r o and r i are the outer and inner radius of the waterplan area respectively ζ 3 t is the heave motion and η t is the wave elevation since the heave motion and wave elevation are relatively small compared to the radius of the waterplane area the last high order eventually third order term is ignored for simplicity then with the assumptions of a sinusoidal wave elevation η t η cos ω t and the small pitch induced heave motion the equation of heave motion can be written as 8a m a 33 ζ 3 b 33 ζ 3 ρ g π r o 2 r i 2 2 r o η cos ω t ζ 3 2 ρ g π r o ζ 3 2 0 where b 33 is the damping coefficient and η is the amplitude of the wave elevation this is the form of a nonlinear mathieu equation including the quadratic term for the range of incident wave frequencies considered here 0 28 0 45 rad s the phase of heave response is 180 degree out of phase of that of incident wave then the last two terms of 8 can be combined as 8b m a 33 ζ 3 b 33 ζ 3 ρ g π r o 2 r i 2 2 r o η ζ 3 cos ω t ζ 3 0 similarly the pitch motion equation coupled with the heave motion can be derived by considering the time varying displaced volume and metacentric height g m a detailed derivation of the coupled pitch equation of motion is given in the paper by koo et al 2004 9 i 55 a 55 ζ 5 t b 55 ζ 5 t ρ g g m 0 1 2 x 3 cos ω t ζ 5 t 0 where g m 0 is the metacentric height when the platform is at rest a general form of the damped mathieu equation is 10 ζ c ζ α β cos t ζ 0 the parameters in the form of mathieu s equation are defined in table 1 for simplicity the linear mathieu equation is considered for the stability diagram for the heave motion the hill s infinite determinants method is applied to obtain the boundaries of the instability regions with parameters α and β α is defined as the square of a ratio between the natural frequency of motions and the wave frequency if β increases the possibility of the system being unstable increases therefore with larger heave motion the possibility of mathieu instability increases more koo et al 2004 described the damping effect which shifts the critical line to the upper level and enlarges the stable regions as shown in fig 2 among the series of unstable regions the primary unstable region is less affected by damping which means that the instability most likely occurs when α is equal to 0 25 in fig 2 the last quadratic term of eq 8a is not included in the hill s stability analysis 4 arctic spar model the arctic spar model see fig 3 by murray et al 2009 without moon pool bottom plate is adopted in the current study since the current body nonlinear numerical model requires the exact shape of a hull even above mean water level the structural properties are modified accordingly to model the equivalent structure for the nonlinear analysis the hollowed spar with an open bottom is modelled as shown in fig 4 the mean draft was chosen as shown in fig 3 so that the inclined surface can break level ice effectively however it may not be the optimal position in view of mi and wave loading the main properties of the structure are given in table 2 from the plot of the surge restoring force and displacement in fig 5 the 6 6 stiffness matrix of the mooring line system is estimated based on the results the surge restoring force linearly increases with increasing displacement up to 15 m thus one can calculate the surge stiffness with the corresponding surge displacement with a linear approximation the rotational restoring stiffness is determined to have the same natural frequency with the model test and the coupling term is calculated by multiplying the surge stiffness by the distance from the origin to the center of gravity we intentionally change the location of the fairlead points to the center of gravity for simplicity since there is no information about the heave restoring stiffness from mooring it is assumed to be small and negligible which is the typical case of spar design the linear mooring stiffness with respect to the body origin is given in eq 11 5 numerical test matrix in this study the numerical simulation in the time domain is achieved by extending the existing program charm3d kim 2006 which has been developed and extensively verified by the second author s research group over the past two decades kim et al 2001 2005 yang and kim 2011 kang and kim 2014 the program is capable of simulating the interaction between fluid and floating offshore structures with mooring lines the mooring dynamics is based on the finite element method the first author has further extended this software for the nonlinear hydrostatic and fk forces updated at every time step the hydrodynamic coefficients added mass radiation damping and diffraction wave force obtained by the 3d panel method are fed into this program as an input for the subsequent time domain simulations for frequency domain calculations 32 wave frequencies from 0 01 rad sec to 10 0 rad sec are used three different analyses are conducted in the time domain see table 3 the first analysis na1 is the linear analysis which means that all dynamic components mass damping stiffness and force are derived based on the linear theory the second analysis na2 includes the time varying nonlinear hc and fk forces in the third analysis na3 only the nonlinear hc is considered without nonlinear fk force compared to the second approach since the parametric resonance is caused by the sinusoidally varying stiffness coefficient it is expected that the second and third analyses show the mathieu instability the time step of 0 05 s is used in the simulations 6 free decay tests numerical free decay tests are performed to identify the natural frequency and damping ratio of the entire system the structure is initially translated into 15 m 7 m and 0 1 radian in the surge heave and pitch free decay tests respectively the drag coefficient of 1 0 is applied for the cylindrical hull in the horizontal direction and that of 5 0 is used for the bottom plate and sloped surfaces in the vertical direction according to he 2003 and liapis et al 2015 the heave drag coefficients of a spar with bottom heave plate at low kc numbers are typically in the range of 5 10 we used the smallest value 5 assuming minimal heave plate like effect fig 6 shows the time series of the free decay test results generally since the wave force is not considered in the free decay test the analysis configurations for na2 and na3 are exactly the same which results in the same time series in surge the motions in the three cases are identical with the same natural frequency because the mooring stiffness and total mass are the same in the surge direction in heave na1 decays over time with the same period of 32 s however na2 and na3 show a nonlinear decaying motion due to the inverted conical shape around the mean water level from the numerical heave free decay test the heave natural period depends on heave amplitudes for the body nonlinear case as shown in table 4 which is the typical nonlinear behavior of arctic spar in the heave direction as the displacement decreases and the number of oscillations increases the nonlinearity becomes insignificant and in the end the decaying period converges to the same decaying period of na1 as shown in table 4 in the pitch direction na1 na2 and na3 show a similar trend and natural periods the slight difference in pitch is attributed to a change in the center of buoyancy and nonlinear restoring moment the pitch stiffness hardens with increasing pitch motion however the nonlinear effect due to the inverted conical hull shape is not more significant than that in the heave case due to the relatively small change of center of buoyancy to calculate the damping ratio the logarithmic decrement method is employed table 5 indicates the damping ratio for the three cases surge heave and pitch directions 7 numerical analysis in time domain and discussions a total of 30 regular wave numerical simulations with 3 wave heights and 10 wave frequencies are conducted to investigate the mathieu instability for arctic spar see table 6 since mathieu type instability most likely occurs when the ratio of the natural frequency to the wave frequency is 0 5 the wave periods are chosen near half of the heave and pitch natural periods at 16 s and 29 s respectively to have enough time to develop instability a conservative simulation time of 20 000 s is selected 7 1 comparison of three analysis cases with the wave of 3 m height and 31sec period numerical simulations are conducted with a 3 m wave height and 31 s period which is close to the heave natural period the dynamics statistics of platform motions are given in table 7 the surge and pitch motions in the three cases have similar statistics with the similar extreme values whereas the statistics in heave motions of the three cases are quite different the heave motion in na1 is the largest followed by those in na3 and na2 as shown in fig 7 first the heave motion in na1 is amplified and shows the resonance motion however in na2 and na3 a smaller heave motion than that in na1 is observed due to the nonlinear effects related to stiffness with the increasing heave motion furthermore the nonlinear fk force makes the heave motion in na2 even smaller the incident wave force applied on na1 and na3 is a sinusoidal function and the psd plot has one peak at the frequency equal to the wave frequency however due to the sloped hull shape the nonlinear fk force becomes non sinusoidal with double frequency as shown in fig 9 in the corresponding psd plot for na2 two peak frequencies are observed due to nonlinear fk forces applied to the system consequently the wave force amplitude at the original wave frequency is reduced and thus the corresponding heave amplitude is also reduced as observed in fig 9 on the other hand the peaks of the three cases in the pitch psd plot see fig 8 are located at the frequency equal to the wave excitation frequency this result implies that none of the three cases exhibits heave to pitch mathieu instability with a wave height of 3 m and a period of 31 s because they do not satisfy the instability conditions this example typically shows that even though heave motion is large if its half frequency does not coincide with the pitch natural frequency pitch mi does not occur on the contrary the next section shows that even if the heave motion is not large if its half frequency coincides with the pitch natural frequency pitch mi happens and it results in large pitch roll motions at the half frequency of heave and wave in this regard the mi resembles the phenomenon of sub harmonic parametric excitation 7 2 pitch roll mathieu instability in the next simulation a slight change in the wave period to 29 s is made so that the ratio of the pitch natural frequency to the wave frequency α factor can be close to 0 25 compared to the previous case the wave frequency is more distanced away from the heave natural frequency and the resulting amplitudes of heave motions are generally smaller in all cases however in na2 and na3 due to the nonlinearity large pitch motions at the half frequency clearly appear at the later stage of simulation due to mathieu type instability fig 10 shows the corresponding time simulation results up to 2700s ordinary wave frequency pitch motions can be observed however from the 2700 s the pitch motion in na3 is suddenly amplified and the greatly increased pitch motions at the half of wave frequency continue as a result of mathieu instability the initially growing motion by mi is limited later by nonlinearity to have stable motion amplitude and period similar phenomenon also happens in na2 at the delayed time of after 3800 s in both cases the peaks in the pitch psd are not located at the wave frequency but at its half frequency as evidenced in fig 12 and fig 13 close to the pitch natural frequency which implies resonant motion interestingly up to 2700s all the 3 cases produced very similar pitch motions since roll equation of motion is very similar to that of pitch eq 9 due to geometrical symmetry the same mathieu instability also happens as evidenced by fig 10b in the roll mode on the other hand in fig 11 we do not observe any mathieu instability in heave motions as the wave height increases the mathieu instability in na2 and na3 occurs earlier with the wave height of 5 m the instability is initiated at 2000 s in na3 which is 700 s earlier than the case of h 3 m similarly although the heave motion in na2 is still small resonance type behavior in the pitch motion is observed since the heave motion increases with the wave height more heave energy is transferred to the pitch motion in addition the parameter β in table 1 increases linearly with the heave motion which means the structure is more likely to be located in the unstable region in fig 2 in this comparison the linear analysis na1 cannot capture the nonlinear phenomena such as mathieu instability because it assumes that the metacentric height gm and the restoring stiffness are constant throughout the simulation however the nonlinear simulation with the time varying restoring stiffness clearly shows the nonlinear behavior of arctic spar in the previous studies examining the mathieu instability some researchers haslum 2000 dalane et al 2012 have presented a simplified method to approximate the time varying gm and others haslum and faltinsen 1999 koo et al 2004 jingrui et al 2010 have derived an analytic pitch equation of motion coupled with the heave motion and wave elevation in the current study we use the instantaneous submerged body and calculate the exact instantaneous hydrostatic coefficients by taking advantage of computing the time varying nonlinear hydrostatic coefficients in a numerical simulation we find the time series and psd of the pitch restoring coefficients as presented in fig 14 the restoring coefficients in na2 and na3 show time varying patterns with multiple frequencies the dominant frequency at 0 21 rad sec in the psd plot is the same as the wave frequency and this corresponds to the α factor of 0 25 which is the first principal unstable region of mathieu instability the initial heave motion influences not only the pitch motion but also the roll motion by transferring the energy internally as is pointed out in fig 10 therefore when mathieu instability occurs the spar tends to have conical pendulum like behavior including both pitch and roll fig 15 indicates the trajectory of the horizontal motion a and the phase plane trajectory of the roll motion b over time the roll motion increases and the sway motion develops correspondingly this is because the equation of the roll motion is also coupled with the heave motion in the form of the mathieu equation as the pitch equation of motion however the roll motion generally requires a longer time than the pitch case to fully develop and reveal the mathieu instability the mathieu stability diagram is also investigated theoretically and numerically the theoretical diagram is drawn using hill s infinite determinants method in fig 16 for na3 the markers are the results from the time domain simulations corresponding to the wave heights of 1 m 3 m and 5 m and periods of 25 s 27 s 29 s 31 s and 33 s the theoretical line is computed based on the simplified equation of the pitch motion without a damping term eq 9 the damping slightly elevates the bottom cusp see fig 2 since the pitch damping is relatively small see table 5 in the present case the given line is the reasonable measure of mi occurrence when comparing the theory and actual nonlinear numerical simulations it is seen that the equation predicts the unstable regions well 7 3 heave mathieu instability the mathieu instability in the heave direction is investigated using the numerical simulations with regular waves with the range of half of the heave natural frequency in the regular wave test with a 3 m wave height and 14 s period the heave and pitch motions in the three cases are very small the small motions are obvious because the wave period of 14 s is away from their natural frequencies the results in na1 and na3 are almost identical in all directions the difference of na2 in the heave can be attributed to the nonlinear fk wave forces applied on the sloping wall when the structure moves downward the nonlinear fk heave force acts upward as can also be seen in fig 9 so that the downward motions are smaller than upward motions having positive mean value as shown in fig 17 although the nonlinear effect is observed under this condition there is no mathieu instability both in heave and pitch see figs 17 and 18 however at the wave period of 16 s i e half of the heave natural period mathieu instability in the heave motion is observed in na2 and na3 since the restoring stiffness of na1 is constant throughout the simulation the heave motion in na1 shows a harmonic motion and the frequencies of the heave and pitch motions are the same as the incident wave frequency in contrast the heave motions in na2 and na3 show greatly amplified motions at the half of wave frequency heave natural frequency starting at 1100 s and 2300 s respectively see fig 19 the psd plot in fig 20 also indicates that this behavior occurs at the heave natural frequency it is also seen that the nonlinear fk enhances the magnitude of mi through enlarged heave motions in another simulation example of wave height 1 m although not shown here mathieu instability also occurs in the heave direction in both na2 and na3 cases fig 21 shows that we do not have such mi phenomenon for pitch mode as far as authors know the time domain nonlinear simulation results showing this kind of heave to heave mi caused by the inclined surface near the waterline were not published in the open literature the 16 s wave period is very close to the peak period of the typical 100 yr storm so this phenomenon may be of significant practical importance which will be investigated in the next section a similar trend is also observed in the cases with a higher wave height at a wave height of 5 m although not shown here before a steady state response fully develops mathieu instability is initiated earlier than the h 3 m case i e from 800 s in na2 and 1100 s in na3 respectively we find that mathieu instability in heave is more sensitive to the wave height than that in the pitch direction due to nonlinear restoring forces this is because β factor is directly associated with the wave amplitude η and the order of β factor in heave is much larger than that in pitch the time varying heave restoring coefficients in na2 and na3 are presented in fig 22 at the early stage of simulation with a small heave motion the wave elevation component mainly contributes to the change in the restoring coefficient with the same frequency as the incident wave as observed in fig 22a however after mathieu instability occurs at heave resonance frequency with increased motion amplitude the quadratic motion term in eq 8a influences more on the heave restoring coefficients therefore the behavior of the time varying heave restoring coefficient is also changed to that of dual frequency as can be seen in fig 22b and c the heave stability diagram for na3 is presented in fig 23 similar to the pitch case each marker represents each nonlinear time domain simulation result the theoretical diagram predicts the instability and parametric resonances well which occur at the wave period of 16 s h1t16 h3t16 and h5t16 this means that the numerical algorithm for the nonlinear hydrostatic restoring coefficient can clearly demonstrate essential nonlinear phenomena such as mathieu instability by having the enlarged motions at the half of the wave frequency whereas a linear analysis cannot capture it if enlarged heave motions are generated at the heave natural frequency as a result of heave to heave mi instability the effects of fk force are also to be increased as can be seen in na2 case see fig 20 the amplified motions by larger fk force also enhance the mi instability through the nonlinear hydrostatic restoring coefficient this can be called as mutually ascending effect between nonlinear fk force and nonlinear hydrostatic restoring coefficient for mi when it happens the theoretical mathieu instability line is to be modified due to the nonlinear terms of 8 as was pointed out by el dib 2001 the nonlinear terms in the mathieu equation generally increase the width of the unstable region 7 4 mathieu instability in random seas in this section the numerical simulation for the same arctic spar is conducted under a 100 year storm condition to investigate the nonlinear effects including mi in a more realistic condition the jonswap wave spectrum see fig 24 is used to generate irregular waves with 100 regular wave components and frequency intervals are randomly perturbed to generate non repeating long time history kim and yue 1991 the current is assumed to be steady with the depth attenuation by 1 7 power law the environmental conditions are summarized in table 8 based on murray and yang 2009 in this section to observe the mutually ascending effect between nonlinear fk and nonlinear hydrostatic coefficient more clearly we introduce another case na4 in which nonlinear fk force is calculated at the body instantaneous wetted surface but the hc is kept as constant like linear theory also to observe the potential mi phenomenon more clearly the second order sum and difference frequency wave excitations are intentionally excluded figs 25 28 show the time histories and corresponding psds of the platform motions in surge heave and pitch roll directions the corresponding statistics are tabulated in table 9 in surge the dynamic characteristics of the four cases na1 na2 na3 and na4 are similar but two low frequency peaks are noticeable in na2 and na4 due to the nonlinear fk forces the lowest and second lowest peaks are at the surge and pitch natural frequencies respectively the peak at the pitch natural frequency is caused by the surge pitch coupled effect in the heave direction since the irregular wave peak period tp is close to the half of the heave natural period judging from the insights obtained in the previous regular wave tests the heave motions in na2 and na3 are expected to be largely amplified due to mathieu instability as subharmonic resonance however in na3 there is no apparent heave to heave mi phenomenon and the result is similar to that of na1 since the wave frequency heave motions by linear potential excitations are too small to trigger the mi in na3 although nonlinear hc is employed in na4 we see that the nonlinear fk generates excitations near the heave natural frequency and thus can amplify the corresponding heave motions however since the hc is maintained as constant here the enlarged motions are not due to mi in na2 both nonlinear fk force and nonlinear hc are included and thus the additional enlargement of heave motions can be attributed to mi therefore we can conclude in this case that both nonlinear fk and nonlinear hc play equally important role in significantly amplifying heave motions through heave to heave mi the standard deviation of heave motion in na2 is 6 4 times greater than that of linear theory na1 the above examples demonstrate that the heave to heave mi is more clearly observed in swell regular wave condition but it can also play an important role in irregular waves through mutually ascending effect between nonlinear fk force and nonlinear hc this conclusion may be related to the fact that koo et al 2004 did not observe spar heave to pitch mi in irregular waves when only nonlinear hc was employed but later nallayarasu and kumar 2017b found spar heave to pitch mi when both nonlinear fk and nonlinear hc were included because the nonlinear fk forces in na2 and na4 have positive mean values due to the sloping hull surface near the waterline as are shown in fig 29 positive mean values in the heave direction are observed in pitch wave frequency responses are the same in the four conditions however na2 and na4 generate low frequency pitch motions at the pitch natural frequency although there is no wave energy there there are no nonlinear fk pitch moments there as can be seen in fig 30 large heave motions are generated in na2 and na4 only at twice the pitch natural frequency and they trigger the heave to pitch roll mi as is observed in the regular wave cases their amplitudes are however not that significant to be of practical importance for the present arctic spar under this 100 year storm condition 8 conclusions the mathieu instability on an arctic spar is investigated in both heave and pitch roll directions by applying a body nonlinear time domain model three different analyses are conducted and compared a linear analysis na1 time varying hc and fk forces na2 and time varying hc na3 by deriving the mi equation for heave and pitch the parameters in the mathieu equation are defined and the stability diagram is discussed from the numerical free decay test the natural frequency and damping ratio are determined and compared a series of regular wave tests are carried out to examine the nonlinear behavior of arctic spar including mi furthermore the dynamic performance of arctic spar is considered under a 100 year storm condition the conclusions drawn from the numerical simulations are summarized as follows in the free decay test the effects of the nonlinear time varying restoring stiffness are clearly observed in heave and pitch the decaying period changes in time because of the sloped hull surface near the waterline as the motion is dampened and becomes small the nonlinearity becomes insignificant and the decaying period converges to the value of the linear analysis the nonlinear fk force for arctic spar plays an important role when the wave frequency is close to the heave natural frequency by preventing significantly enlarged resonance motion a nonlinear analysis considering the time varying restoring stiffness can capture the mathieu instability of arctic spar at subharmonic resonant frequency whereas a linear analysis cannot in heave to pitch roll the parametric resonance occurs at the wave frequency twice the pitch roll natural frequency as the wave height increases instability is initiated earlier the simulation results coincide well with the theoretical stability diagram the same phenomenon of instability is observed in heave when the wave frequency is twice the heave natural frequency this heave to heave mi is caused by the sloped hull surface near the waterline and thus unique for arctic spar the simulation results coincide well with the theoretical stability diagram when nonlinear fk force generates excitations as the resonance motion develops by mi the combined effects can further amplify the heave motion under the 100 year storm irregular wave condition significantly enlarged heave motions are observed as a result of heave to heave mathieu instability which can be of practical importance both nonlinear fk forces and nonlinear hc play equally important roles in triggering the phenomenon acknowledgement this work was partly supported by the national research foundation of korea grant funded by the korea government msit no 2017r1a5a1014883 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 02 029 
22932,arctic spar typically has a sloped hull surface near the waterline to break ice through bending however the rapid variation of its waterplane area by the heave motion may cause unexpected nonlinear behaviors which can result in instability in the current study the heave to pitch roll and heave to heave mathieu instability mi of arctic spar are investigated by using a nonlinear time domain simulation program the time dependent nonlinear hydrostatic restoring coefficient hc and nonlinear froude krylov fk force are considered for the instantaneous wetted body underneath the instantaneous wave elevation the effects of the two nonlinear terms for the generation of heave to pitch and heave to heave mi are systematically compared and discussed by employing four different approaches including conventional linear theory analytical equations of heave and pitch are also used with hill s infinite determinants method to determine the boundaries of mathieu s equation parameters where instability occurs through a series of numerical simulations the occurrences of both heave to pitch and heave to heave mi have been clearly demonstrated both in regular and irregular waves the simulated results agree well with the theoretical instability diagram the importance of the combined effects of nonlinear fk forces and nonlinear hc in triggering pronounced heave to heave mi is underscored especially in the case of 100 year storm condition keywords arctic spar mathieu instability mi nonlinear froude krylov fk force nonlinear hydrostatic restoring coefficient hc heave to pitch heave to heave mi fully coupled time domain simulation 1 introduction one of the greatest challenges in developing the arctic region is the severe environmental conditions caused by the presence of ice to reduce the impact of ice researchers have introduced a sloping wall concept which allows the ice to fail in a flexural mode for deeper arctic water a new spar platform design called arctic spar has been proposed in various publications chernetsov and karlinsky 2006 2008 murray et al 2009 murray and yang 2009 bruun et al 2009 2011 sablok et al 2011 jochmann and evers 2014 arctic spar is characterized by its conical shape around the mean water level and a mooring riser system that can be disconnected to avoid the impact of extreme ice because of the sloped hull shape at the waterline the nonlinear effects become significant when there is either considerable platform motion or steep waves these effects could result in nonlinear platform behavior with largely amplified motion through resonance the nonlinear behavior of a classic spar has been investigated numerically and experimentally by several researchers they have observed unstable pitch motion of mathieu type instability heave to pitch mi large heave motion at the half of pitch natural period induces amplified unstable pitch motion where the pitch natural period was twice that of the heave natural period previous literature about mathieu instability has presented insightful findings for a classic spar in particular koo et al 2004 conducted numerical tests for a classic spar with different damping models and concluded that the additional damping plays an important role in suppressing mathieu instability jingrui et al 2010 derived the heave pitch coupled equation of motion for a conventional spar and found that nonlinear motion may occur at the wave frequency close to the sum of heave and pitch natural frequencies yang and xu 2015 investigated the parametric instabilities of spar platforms in irregular waves and provided several suggestions to avoid the parametric pitch resonance the effect of various hulls of spar platforms on mathieu instability has also been investigated haslum and faltinsen 1999 studied the five alternative hull shapes and observed the heave and pitch instability using simplified methods wan et al 2015 performed experimental tests under survival conditions for a spar type floating offshore wind turbine equipped with a torus shape wave energy converter wec when the torus was locked to the spar at the mean water level the heave induced pitch instability occurred at the wave period equal to half of the pitch natural period nallayarasu and mathai 2016 2017a also conducted numerical and experimental tests and compared three spar models under regular wave tests however those papers above only considered the heave to pitch mathieu instability caused by the irregular hull shape near the waterline the current study aims to numerically investigate mathieu instability for arctic spar in both the pitch and heave directions caused by the conical shaped hull near the waterline as far as authors know the time domain nonlinear simulation results showing heave to heave mi the sinusoidally varying heave restoring force caused by the cone shaped hull surface near waterline induces amplified unstable heave motion especially when the heave motion period is at the half of heave natural period caused by the inclined surface near the waterline were not published in the open literature by considering the instantaneous submerged body underneath the instantaneous wave elevation the instantaneous entire wetted body is gridded and the corresponding nonlinear hydrostatic coefficients and fk forces are considered along with other constituent forces in a time domain simulation the equation of motion in heave and pitch is derived as a form of the mathieu equation the numerical results are discussed by varying the wave parameters and methodologies and are compared to the theoretical stability diagram at the end the dynamic performance of arctic spar under a 100 year storm condition including significant heave to heave mi is discussed 2 dynamics of arctic spar 2 1 nonlinear hydrostatic stiffness in a linear analysis restoring stiffness is linearized about the mean water level with the assumption that the body motion is small and the waterplane area is constant along the hull near the waterline however with large wave heights and body motions the effect of time varying nonlinear restoring stiffness is significant furthermore for arctic spar the waterplane area changes a lot with heave motions which means time dependent hydrostatic stiffness with respect to the instantaneous body position needs to be used we adopt the method used by guérinel et al 2011 and extend it to the 6 dof floater motions then the time dependent hydrostatic coefficients c h y d r o in heave 3 roll 4 pitch 5 and their coupling terms as well as the corresponding coordinate system see fig 1 can be defined as 1 c h y d r o 3 3 ρ g i 1 n n 3 i s w i t c h y d r o 3 4 ρ g i 1 n x 2 i t x 0 2 t n 3 i s w i t c h y d r o 3 5 ρ g i 1 n x 1 i t x 0 1 t n 3 i s w i t c h y d r o 4 4 ρ g i 1 n x 0 2 t x 2 i t 2 n 3 i s w i t ρ g t x b 3 t m g x g 3 t c h y d r o 4 5 ρ g i 1 n x 1 i t x 0 1 t x 2 i t x 0 2 t n 3 i s w i t c h y d r o 4 6 ρ g t x b 1 t m g x g 1 t c h y d r o 5 5 ρ g i 1 n x 0 1 t x 1 i t 2 n 3 i s w i t ρ g t x b 3 t m g x g 3 t c h y d r o 5 6 ρ g t x b 1 t m g x g 1 t where t i 1 n n j i x j i x 0 j t s w i t x b j t 1 2 t i 1 n n j x j x 0 j 2 s w i t where s w i t is the area of the wetted surface panel n is the total number of wetted surface panels x j i and n j i are the centroid of the submerged panel and normal vector x 0 j is the origin of a body coordinate t is the time varying submerged volume x b j is the time varying center of buoyancy x g j is the center of mass m is the mass g is the gravitational acceleration ρ is the density of water i denotes the ith panel and j of 1 2 and 3 denotes x y and z dimension 2 2 partially nonlinear wave forces in this paper the nonlinear wave forces on arctic spar are considered throughout the time domain numerical simulation the wave force is divided into four components as follows 2 f w a v e f l i n e a r d i f f f n o n l i n e a r f k f n o n l i n e a r d r a g f c o n v o l u t i o n where f w a v e is the total wave force f l i n e a r d i f f is the linear diffraction force caused by disturbed incident waves f n o n l i n e a r f k is the nonlinear fk force f n o n l i n e a r d r a g is the nonlinear viscous drag force and f c o n v o l u t i o n is the radiation damping force the linear diffraction force is calculated based on the first order 3d diffraction radiation potential theory during the time domain simulation the diffraction force remains linear the nonlinear fk force caused by undisturbed incident wave s pressure is calculated considering the instantaneous submerged structure position the structure mesh is re gridded using the euler angles method at every time step considering the instant body translations and rotations then the nonlinear fk force is evaluated by integrating the incident wave pressure on the instantaneous submerged body surface the equation of the nonlinear fk wave force is as follows 3 f n o n l i n e a r f k t i 1 n p i n j i s w i t j 1 2 3 m n o n l i n e a r f k t i 1 n p i r n j 3 i s w i t j 4 5 6 where p i ρ φ 0 t f o r x 3 i 0 p i x 3 i 0 f o r x 3 i 0 where p i is the pressure by incident waves r is the position vector from the body origin to the centroid of the ith panel and φ 0 is the velocity potential for incident waves above the mean water level the dynamic pressure is evaluated using the vertical stretching method such that the pressure above the mean water level is equal to the pressure at the waterline the nonlinear viscous drag force is evaluated at every time step by the morison s equation eq 4 considering wave particle kinematics at the instantaneous body position 4 f n o n l i n e a r d r a g 1 2 c d ρ a u ζ u ζ where c d is the drag coefficient a is the projected area u and ζ are the instantaneous wave particle and body velocities normal to the projected area at the instantaneous body position the nonlinear forces and moments induced by the viscous drag are calculated by integrating the forces on the discrete elements using the 6 point gaussian quadrature integration the fourth component f c o n v o l u t i o n is associated with radiation wave making damping and explained in the next sub section 2 3 hydrodynamic coefficients in the time domain the hydrodynamic coefficient is first calculated from the frequency domain 3d diffraction radiation panel program wamit 2006 and the results are converted to the form used in time domain simulation based on the kramers kronig relationship the radiation damping force can be expressed using the convolution integral form to represent the memory effects the added mass at infinite frequency is a function of the retardation function and remains constant as follows 5 f c o n v o l u t i o n t ζ t r t τ ζ τ d τ r t 2 π 0 b ϖ cos ϖ t d ϖ m a d d m a d d ϖ 0 r t cos ϖ t d t where f c o n v o l u t i o n is the radiation damping force x is the 6 dof velocities of the floating body r t is the retardation function b ϖ is the linear radiation damping matrix at frequency ϖ and m a d d is the added mass at infinite frequency 2 4 equation of arctic spar 6 dof motions in this paper the time dependent hydrostatic stiffness matrix c h y d r o t is considered and the nonlinear wave force is separated into the linear diffraction nonlinear fk nonlinear viscous drag and convolution damping forces then the equation of motion can be re written as 6 m m a d d ζ t c h y d r o t k m o o r i n g ζ t f l i n e a r d i f f t f n o n l i n e a r f k t f d r a g t f c o n v o l u t i o n t to solve the 6 dof dynamic equation of motion a combination of the adams bashforth and adams moulton methods is used with a constant time step for numerical integration the present approach is called the body nonlinear method with nonlinear fk force the fully nonlinear computation including fully nonlinear free surface and body surface conditions is extremely complex and time consuming since the instantaneous free surface and large size matrix equation need to be updated and solved at each time step therefore the present approach is not fully nonlinear but the most important body nonlinearity is included to investigate the resulting mi phenomenon 3 analytic investigation for the mathieu equation in heave and pitch motions for floating structures the waterplane area a w mainly contributes to the heave restoring stiffness represented by ρ g a w for arctic spar the time varying heave restoring coefficient due to the heave motion in open water can be calculated based on the time dependent waterplane area which changes with heave displacements and the wave elevation for the 45 degree slope case see figs 3 and 4 the waterplane area can be calculated as follows 7 ρ g a w ρ g π r o ζ 3 t η t 2 r i 2 ρ g π r o 2 r i 2 2 r o η t 2 r o ζ 3 t ζ 3 t η t 2 where r o and r i are the outer and inner radius of the waterplan area respectively ζ 3 t is the heave motion and η t is the wave elevation since the heave motion and wave elevation are relatively small compared to the radius of the waterplane area the last high order eventually third order term is ignored for simplicity then with the assumptions of a sinusoidal wave elevation η t η cos ω t and the small pitch induced heave motion the equation of heave motion can be written as 8a m a 33 ζ 3 b 33 ζ 3 ρ g π r o 2 r i 2 2 r o η cos ω t ζ 3 2 ρ g π r o ζ 3 2 0 where b 33 is the damping coefficient and η is the amplitude of the wave elevation this is the form of a nonlinear mathieu equation including the quadratic term for the range of incident wave frequencies considered here 0 28 0 45 rad s the phase of heave response is 180 degree out of phase of that of incident wave then the last two terms of 8 can be combined as 8b m a 33 ζ 3 b 33 ζ 3 ρ g π r o 2 r i 2 2 r o η ζ 3 cos ω t ζ 3 0 similarly the pitch motion equation coupled with the heave motion can be derived by considering the time varying displaced volume and metacentric height g m a detailed derivation of the coupled pitch equation of motion is given in the paper by koo et al 2004 9 i 55 a 55 ζ 5 t b 55 ζ 5 t ρ g g m 0 1 2 x 3 cos ω t ζ 5 t 0 where g m 0 is the metacentric height when the platform is at rest a general form of the damped mathieu equation is 10 ζ c ζ α β cos t ζ 0 the parameters in the form of mathieu s equation are defined in table 1 for simplicity the linear mathieu equation is considered for the stability diagram for the heave motion the hill s infinite determinants method is applied to obtain the boundaries of the instability regions with parameters α and β α is defined as the square of a ratio between the natural frequency of motions and the wave frequency if β increases the possibility of the system being unstable increases therefore with larger heave motion the possibility of mathieu instability increases more koo et al 2004 described the damping effect which shifts the critical line to the upper level and enlarges the stable regions as shown in fig 2 among the series of unstable regions the primary unstable region is less affected by damping which means that the instability most likely occurs when α is equal to 0 25 in fig 2 the last quadratic term of eq 8a is not included in the hill s stability analysis 4 arctic spar model the arctic spar model see fig 3 by murray et al 2009 without moon pool bottom plate is adopted in the current study since the current body nonlinear numerical model requires the exact shape of a hull even above mean water level the structural properties are modified accordingly to model the equivalent structure for the nonlinear analysis the hollowed spar with an open bottom is modelled as shown in fig 4 the mean draft was chosen as shown in fig 3 so that the inclined surface can break level ice effectively however it may not be the optimal position in view of mi and wave loading the main properties of the structure are given in table 2 from the plot of the surge restoring force and displacement in fig 5 the 6 6 stiffness matrix of the mooring line system is estimated based on the results the surge restoring force linearly increases with increasing displacement up to 15 m thus one can calculate the surge stiffness with the corresponding surge displacement with a linear approximation the rotational restoring stiffness is determined to have the same natural frequency with the model test and the coupling term is calculated by multiplying the surge stiffness by the distance from the origin to the center of gravity we intentionally change the location of the fairlead points to the center of gravity for simplicity since there is no information about the heave restoring stiffness from mooring it is assumed to be small and negligible which is the typical case of spar design the linear mooring stiffness with respect to the body origin is given in eq 11 5 numerical test matrix in this study the numerical simulation in the time domain is achieved by extending the existing program charm3d kim 2006 which has been developed and extensively verified by the second author s research group over the past two decades kim et al 2001 2005 yang and kim 2011 kang and kim 2014 the program is capable of simulating the interaction between fluid and floating offshore structures with mooring lines the mooring dynamics is based on the finite element method the first author has further extended this software for the nonlinear hydrostatic and fk forces updated at every time step the hydrodynamic coefficients added mass radiation damping and diffraction wave force obtained by the 3d panel method are fed into this program as an input for the subsequent time domain simulations for frequency domain calculations 32 wave frequencies from 0 01 rad sec to 10 0 rad sec are used three different analyses are conducted in the time domain see table 3 the first analysis na1 is the linear analysis which means that all dynamic components mass damping stiffness and force are derived based on the linear theory the second analysis na2 includes the time varying nonlinear hc and fk forces in the third analysis na3 only the nonlinear hc is considered without nonlinear fk force compared to the second approach since the parametric resonance is caused by the sinusoidally varying stiffness coefficient it is expected that the second and third analyses show the mathieu instability the time step of 0 05 s is used in the simulations 6 free decay tests numerical free decay tests are performed to identify the natural frequency and damping ratio of the entire system the structure is initially translated into 15 m 7 m and 0 1 radian in the surge heave and pitch free decay tests respectively the drag coefficient of 1 0 is applied for the cylindrical hull in the horizontal direction and that of 5 0 is used for the bottom plate and sloped surfaces in the vertical direction according to he 2003 and liapis et al 2015 the heave drag coefficients of a spar with bottom heave plate at low kc numbers are typically in the range of 5 10 we used the smallest value 5 assuming minimal heave plate like effect fig 6 shows the time series of the free decay test results generally since the wave force is not considered in the free decay test the analysis configurations for na2 and na3 are exactly the same which results in the same time series in surge the motions in the three cases are identical with the same natural frequency because the mooring stiffness and total mass are the same in the surge direction in heave na1 decays over time with the same period of 32 s however na2 and na3 show a nonlinear decaying motion due to the inverted conical shape around the mean water level from the numerical heave free decay test the heave natural period depends on heave amplitudes for the body nonlinear case as shown in table 4 which is the typical nonlinear behavior of arctic spar in the heave direction as the displacement decreases and the number of oscillations increases the nonlinearity becomes insignificant and in the end the decaying period converges to the same decaying period of na1 as shown in table 4 in the pitch direction na1 na2 and na3 show a similar trend and natural periods the slight difference in pitch is attributed to a change in the center of buoyancy and nonlinear restoring moment the pitch stiffness hardens with increasing pitch motion however the nonlinear effect due to the inverted conical hull shape is not more significant than that in the heave case due to the relatively small change of center of buoyancy to calculate the damping ratio the logarithmic decrement method is employed table 5 indicates the damping ratio for the three cases surge heave and pitch directions 7 numerical analysis in time domain and discussions a total of 30 regular wave numerical simulations with 3 wave heights and 10 wave frequencies are conducted to investigate the mathieu instability for arctic spar see table 6 since mathieu type instability most likely occurs when the ratio of the natural frequency to the wave frequency is 0 5 the wave periods are chosen near half of the heave and pitch natural periods at 16 s and 29 s respectively to have enough time to develop instability a conservative simulation time of 20 000 s is selected 7 1 comparison of three analysis cases with the wave of 3 m height and 31sec period numerical simulations are conducted with a 3 m wave height and 31 s period which is close to the heave natural period the dynamics statistics of platform motions are given in table 7 the surge and pitch motions in the three cases have similar statistics with the similar extreme values whereas the statistics in heave motions of the three cases are quite different the heave motion in na1 is the largest followed by those in na3 and na2 as shown in fig 7 first the heave motion in na1 is amplified and shows the resonance motion however in na2 and na3 a smaller heave motion than that in na1 is observed due to the nonlinear effects related to stiffness with the increasing heave motion furthermore the nonlinear fk force makes the heave motion in na2 even smaller the incident wave force applied on na1 and na3 is a sinusoidal function and the psd plot has one peak at the frequency equal to the wave frequency however due to the sloped hull shape the nonlinear fk force becomes non sinusoidal with double frequency as shown in fig 9 in the corresponding psd plot for na2 two peak frequencies are observed due to nonlinear fk forces applied to the system consequently the wave force amplitude at the original wave frequency is reduced and thus the corresponding heave amplitude is also reduced as observed in fig 9 on the other hand the peaks of the three cases in the pitch psd plot see fig 8 are located at the frequency equal to the wave excitation frequency this result implies that none of the three cases exhibits heave to pitch mathieu instability with a wave height of 3 m and a period of 31 s because they do not satisfy the instability conditions this example typically shows that even though heave motion is large if its half frequency does not coincide with the pitch natural frequency pitch mi does not occur on the contrary the next section shows that even if the heave motion is not large if its half frequency coincides with the pitch natural frequency pitch mi happens and it results in large pitch roll motions at the half frequency of heave and wave in this regard the mi resembles the phenomenon of sub harmonic parametric excitation 7 2 pitch roll mathieu instability in the next simulation a slight change in the wave period to 29 s is made so that the ratio of the pitch natural frequency to the wave frequency α factor can be close to 0 25 compared to the previous case the wave frequency is more distanced away from the heave natural frequency and the resulting amplitudes of heave motions are generally smaller in all cases however in na2 and na3 due to the nonlinearity large pitch motions at the half frequency clearly appear at the later stage of simulation due to mathieu type instability fig 10 shows the corresponding time simulation results up to 2700s ordinary wave frequency pitch motions can be observed however from the 2700 s the pitch motion in na3 is suddenly amplified and the greatly increased pitch motions at the half of wave frequency continue as a result of mathieu instability the initially growing motion by mi is limited later by nonlinearity to have stable motion amplitude and period similar phenomenon also happens in na2 at the delayed time of after 3800 s in both cases the peaks in the pitch psd are not located at the wave frequency but at its half frequency as evidenced in fig 12 and fig 13 close to the pitch natural frequency which implies resonant motion interestingly up to 2700s all the 3 cases produced very similar pitch motions since roll equation of motion is very similar to that of pitch eq 9 due to geometrical symmetry the same mathieu instability also happens as evidenced by fig 10b in the roll mode on the other hand in fig 11 we do not observe any mathieu instability in heave motions as the wave height increases the mathieu instability in na2 and na3 occurs earlier with the wave height of 5 m the instability is initiated at 2000 s in na3 which is 700 s earlier than the case of h 3 m similarly although the heave motion in na2 is still small resonance type behavior in the pitch motion is observed since the heave motion increases with the wave height more heave energy is transferred to the pitch motion in addition the parameter β in table 1 increases linearly with the heave motion which means the structure is more likely to be located in the unstable region in fig 2 in this comparison the linear analysis na1 cannot capture the nonlinear phenomena such as mathieu instability because it assumes that the metacentric height gm and the restoring stiffness are constant throughout the simulation however the nonlinear simulation with the time varying restoring stiffness clearly shows the nonlinear behavior of arctic spar in the previous studies examining the mathieu instability some researchers haslum 2000 dalane et al 2012 have presented a simplified method to approximate the time varying gm and others haslum and faltinsen 1999 koo et al 2004 jingrui et al 2010 have derived an analytic pitch equation of motion coupled with the heave motion and wave elevation in the current study we use the instantaneous submerged body and calculate the exact instantaneous hydrostatic coefficients by taking advantage of computing the time varying nonlinear hydrostatic coefficients in a numerical simulation we find the time series and psd of the pitch restoring coefficients as presented in fig 14 the restoring coefficients in na2 and na3 show time varying patterns with multiple frequencies the dominant frequency at 0 21 rad sec in the psd plot is the same as the wave frequency and this corresponds to the α factor of 0 25 which is the first principal unstable region of mathieu instability the initial heave motion influences not only the pitch motion but also the roll motion by transferring the energy internally as is pointed out in fig 10 therefore when mathieu instability occurs the spar tends to have conical pendulum like behavior including both pitch and roll fig 15 indicates the trajectory of the horizontal motion a and the phase plane trajectory of the roll motion b over time the roll motion increases and the sway motion develops correspondingly this is because the equation of the roll motion is also coupled with the heave motion in the form of the mathieu equation as the pitch equation of motion however the roll motion generally requires a longer time than the pitch case to fully develop and reveal the mathieu instability the mathieu stability diagram is also investigated theoretically and numerically the theoretical diagram is drawn using hill s infinite determinants method in fig 16 for na3 the markers are the results from the time domain simulations corresponding to the wave heights of 1 m 3 m and 5 m and periods of 25 s 27 s 29 s 31 s and 33 s the theoretical line is computed based on the simplified equation of the pitch motion without a damping term eq 9 the damping slightly elevates the bottom cusp see fig 2 since the pitch damping is relatively small see table 5 in the present case the given line is the reasonable measure of mi occurrence when comparing the theory and actual nonlinear numerical simulations it is seen that the equation predicts the unstable regions well 7 3 heave mathieu instability the mathieu instability in the heave direction is investigated using the numerical simulations with regular waves with the range of half of the heave natural frequency in the regular wave test with a 3 m wave height and 14 s period the heave and pitch motions in the three cases are very small the small motions are obvious because the wave period of 14 s is away from their natural frequencies the results in na1 and na3 are almost identical in all directions the difference of na2 in the heave can be attributed to the nonlinear fk wave forces applied on the sloping wall when the structure moves downward the nonlinear fk heave force acts upward as can also be seen in fig 9 so that the downward motions are smaller than upward motions having positive mean value as shown in fig 17 although the nonlinear effect is observed under this condition there is no mathieu instability both in heave and pitch see figs 17 and 18 however at the wave period of 16 s i e half of the heave natural period mathieu instability in the heave motion is observed in na2 and na3 since the restoring stiffness of na1 is constant throughout the simulation the heave motion in na1 shows a harmonic motion and the frequencies of the heave and pitch motions are the same as the incident wave frequency in contrast the heave motions in na2 and na3 show greatly amplified motions at the half of wave frequency heave natural frequency starting at 1100 s and 2300 s respectively see fig 19 the psd plot in fig 20 also indicates that this behavior occurs at the heave natural frequency it is also seen that the nonlinear fk enhances the magnitude of mi through enlarged heave motions in another simulation example of wave height 1 m although not shown here mathieu instability also occurs in the heave direction in both na2 and na3 cases fig 21 shows that we do not have such mi phenomenon for pitch mode as far as authors know the time domain nonlinear simulation results showing this kind of heave to heave mi caused by the inclined surface near the waterline were not published in the open literature the 16 s wave period is very close to the peak period of the typical 100 yr storm so this phenomenon may be of significant practical importance which will be investigated in the next section a similar trend is also observed in the cases with a higher wave height at a wave height of 5 m although not shown here before a steady state response fully develops mathieu instability is initiated earlier than the h 3 m case i e from 800 s in na2 and 1100 s in na3 respectively we find that mathieu instability in heave is more sensitive to the wave height than that in the pitch direction due to nonlinear restoring forces this is because β factor is directly associated with the wave amplitude η and the order of β factor in heave is much larger than that in pitch the time varying heave restoring coefficients in na2 and na3 are presented in fig 22 at the early stage of simulation with a small heave motion the wave elevation component mainly contributes to the change in the restoring coefficient with the same frequency as the incident wave as observed in fig 22a however after mathieu instability occurs at heave resonance frequency with increased motion amplitude the quadratic motion term in eq 8a influences more on the heave restoring coefficients therefore the behavior of the time varying heave restoring coefficient is also changed to that of dual frequency as can be seen in fig 22b and c the heave stability diagram for na3 is presented in fig 23 similar to the pitch case each marker represents each nonlinear time domain simulation result the theoretical diagram predicts the instability and parametric resonances well which occur at the wave period of 16 s h1t16 h3t16 and h5t16 this means that the numerical algorithm for the nonlinear hydrostatic restoring coefficient can clearly demonstrate essential nonlinear phenomena such as mathieu instability by having the enlarged motions at the half of the wave frequency whereas a linear analysis cannot capture it if enlarged heave motions are generated at the heave natural frequency as a result of heave to heave mi instability the effects of fk force are also to be increased as can be seen in na2 case see fig 20 the amplified motions by larger fk force also enhance the mi instability through the nonlinear hydrostatic restoring coefficient this can be called as mutually ascending effect between nonlinear fk force and nonlinear hydrostatic restoring coefficient for mi when it happens the theoretical mathieu instability line is to be modified due to the nonlinear terms of 8 as was pointed out by el dib 2001 the nonlinear terms in the mathieu equation generally increase the width of the unstable region 7 4 mathieu instability in random seas in this section the numerical simulation for the same arctic spar is conducted under a 100 year storm condition to investigate the nonlinear effects including mi in a more realistic condition the jonswap wave spectrum see fig 24 is used to generate irregular waves with 100 regular wave components and frequency intervals are randomly perturbed to generate non repeating long time history kim and yue 1991 the current is assumed to be steady with the depth attenuation by 1 7 power law the environmental conditions are summarized in table 8 based on murray and yang 2009 in this section to observe the mutually ascending effect between nonlinear fk and nonlinear hydrostatic coefficient more clearly we introduce another case na4 in which nonlinear fk force is calculated at the body instantaneous wetted surface but the hc is kept as constant like linear theory also to observe the potential mi phenomenon more clearly the second order sum and difference frequency wave excitations are intentionally excluded figs 25 28 show the time histories and corresponding psds of the platform motions in surge heave and pitch roll directions the corresponding statistics are tabulated in table 9 in surge the dynamic characteristics of the four cases na1 na2 na3 and na4 are similar but two low frequency peaks are noticeable in na2 and na4 due to the nonlinear fk forces the lowest and second lowest peaks are at the surge and pitch natural frequencies respectively the peak at the pitch natural frequency is caused by the surge pitch coupled effect in the heave direction since the irregular wave peak period tp is close to the half of the heave natural period judging from the insights obtained in the previous regular wave tests the heave motions in na2 and na3 are expected to be largely amplified due to mathieu instability as subharmonic resonance however in na3 there is no apparent heave to heave mi phenomenon and the result is similar to that of na1 since the wave frequency heave motions by linear potential excitations are too small to trigger the mi in na3 although nonlinear hc is employed in na4 we see that the nonlinear fk generates excitations near the heave natural frequency and thus can amplify the corresponding heave motions however since the hc is maintained as constant here the enlarged motions are not due to mi in na2 both nonlinear fk force and nonlinear hc are included and thus the additional enlargement of heave motions can be attributed to mi therefore we can conclude in this case that both nonlinear fk and nonlinear hc play equally important role in significantly amplifying heave motions through heave to heave mi the standard deviation of heave motion in na2 is 6 4 times greater than that of linear theory na1 the above examples demonstrate that the heave to heave mi is more clearly observed in swell regular wave condition but it can also play an important role in irregular waves through mutually ascending effect between nonlinear fk force and nonlinear hc this conclusion may be related to the fact that koo et al 2004 did not observe spar heave to pitch mi in irregular waves when only nonlinear hc was employed but later nallayarasu and kumar 2017b found spar heave to pitch mi when both nonlinear fk and nonlinear hc were included because the nonlinear fk forces in na2 and na4 have positive mean values due to the sloping hull surface near the waterline as are shown in fig 29 positive mean values in the heave direction are observed in pitch wave frequency responses are the same in the four conditions however na2 and na4 generate low frequency pitch motions at the pitch natural frequency although there is no wave energy there there are no nonlinear fk pitch moments there as can be seen in fig 30 large heave motions are generated in na2 and na4 only at twice the pitch natural frequency and they trigger the heave to pitch roll mi as is observed in the regular wave cases their amplitudes are however not that significant to be of practical importance for the present arctic spar under this 100 year storm condition 8 conclusions the mathieu instability on an arctic spar is investigated in both heave and pitch roll directions by applying a body nonlinear time domain model three different analyses are conducted and compared a linear analysis na1 time varying hc and fk forces na2 and time varying hc na3 by deriving the mi equation for heave and pitch the parameters in the mathieu equation are defined and the stability diagram is discussed from the numerical free decay test the natural frequency and damping ratio are determined and compared a series of regular wave tests are carried out to examine the nonlinear behavior of arctic spar including mi furthermore the dynamic performance of arctic spar is considered under a 100 year storm condition the conclusions drawn from the numerical simulations are summarized as follows in the free decay test the effects of the nonlinear time varying restoring stiffness are clearly observed in heave and pitch the decaying period changes in time because of the sloped hull surface near the waterline as the motion is dampened and becomes small the nonlinearity becomes insignificant and the decaying period converges to the value of the linear analysis the nonlinear fk force for arctic spar plays an important role when the wave frequency is close to the heave natural frequency by preventing significantly enlarged resonance motion a nonlinear analysis considering the time varying restoring stiffness can capture the mathieu instability of arctic spar at subharmonic resonant frequency whereas a linear analysis cannot in heave to pitch roll the parametric resonance occurs at the wave frequency twice the pitch roll natural frequency as the wave height increases instability is initiated earlier the simulation results coincide well with the theoretical stability diagram the same phenomenon of instability is observed in heave when the wave frequency is twice the heave natural frequency this heave to heave mi is caused by the sloped hull surface near the waterline and thus unique for arctic spar the simulation results coincide well with the theoretical stability diagram when nonlinear fk force generates excitations as the resonance motion develops by mi the combined effects can further amplify the heave motion under the 100 year storm irregular wave condition significantly enlarged heave motions are observed as a result of heave to heave mathieu instability which can be of practical importance both nonlinear fk forces and nonlinear hc play equally important roles in triggering the phenomenon acknowledgement this work was partly supported by the national research foundation of korea grant funded by the korea government msit no 2017r1a5a1014883 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 02 029 
22933,the passive truncation model called dytrunmoor is proposed to realize the dynamic similarity of mooring line in this paper the nonlinear inertial forces and drag forces are integrated with morison model within elastic rod model to reserve dynamic response of mooring line the mooring line parameters of truncated line are figured out with the optimization algorithm nsga ii for the static and dynamic simulation the fitness function for nsga ii is constructed with tension amplitudes corresponding to limited frequencies which are fetched from tension history with fast fourier transform algorithm a single mooring line is discussed in detail with truncation from 1500 m to 1050 m water depth the feasibility and accuracy of the truncation method is verified with harmonic forced motion which shows a consistent nonlinearity in the dynamic response of the original and the truncated mooring line truncation design is also carried out to a semi submersible platform mooring system truncated from 1200 m to 700 m the static and dynamic characteristics are compared which verifies the validity of the proposed method keywords mooring line dynamic similarity passive truncation consistent nonlinearity elastic rod model 1 introduction the oil and gas industry turns the attention to the deeper ocean for more resources from the 1990s which leads the working depth of the floating platform mooring system continuously increasing and various floating structures are designed to adapt to the new environment the accuracy and reliability of the design and theoretical analysis results usually need to be verified by model tests however the deep water mooring system cannot be modeled entirely in the basin with a reasonable scale due to the limit dimension of offshore basin the hybrid model testing is a feasible method for this problem including the active truncation and the passive truncation an improved passive model is proposed in this paper the majority of current truncation designs is the passive pattern which is proposed by ittc in the passive truncation system the lower part of mooring line is excluded and the truncation point is fixed the most important step is the redesign of mooring system to make the equivalence to full deep system called the equivalent truncation design of mooring system secondly the model test is carried out in the basin with the equivalent truncation model test in which the static characteristics of the mooring system is ensured it is becoming difficult to achieve the accuracy with the depth of water increasing so the numerical reconstruction and numerical extrapolation methods are used to solve this problem the reconstruction is a numerical simulation of truncation model test by adjusting each hydrodynamic parameter until the calculation result is consistent with the test result then the full depth system is numerically simulated and calculated through extrapolation finally this results are adopted as the ultimate passive hybrid model test solution the ultimate objective of truncation design is to achieve static and dynamic equivalence with respect to a full depth system after a lot of research static equivalence can already be well implemented qiao and ou 2014 made a truncation model test for mooring lines of a semi submersible platform the mooring line was truncated to 400 m from 1500 m full depth felix gonzalez and mercier 2016 developed a program for optimization design of the statically equivalent mooring system based on the genetic algorithm and a fitness function was established to perform an extensive search from multiple sets of design parameters to find the optimal solution a semisubmersible with polyester mooring lines as a research example was used to confirm the robustness and reliability of the genetic algorithm optimization process the genetic algorithm was also used for the optimization of mooring system by yan et al 2018 and shafieefar and rezvani 2007 wang et al 2016 analyzed a turret moored fpso with good agreements obtained in static characteristics in which the numerical simulations are performed based on lumped mass model and the catenary theory zhang et al 2017 used the passive mooring truncation method to truncate an internal turret mooring system from the water depth of 320 m 160 m the static characteristics were consistent for the full depth and the truncated mooring system which were verified by the model tests fan et al 2018 made the truncation analysis for catenary semi taut and taut mooring systems for a semi submersible platform in order to achieve the dynamic similarity of truncated mooring system many solutions were proposed ji and xu 2014 investigated the platform motion responses and the mooring line dynamics for a large truncation factor greater than 5 the mooring system of a semi submersible platform was truncated to 200 m from 1000 m to 1500 m respectively the dynamic responses of mooring lines were obtained by model test the damping equivalence method was also proposed with the concept that the damping was important for evaluating low frequency motion su et al 2009 studied the effect of mooring line parameters on damping by the combination of numerical calculations and model tests which showed that the wave damping of truncated mooring lines can be good agreement with full depth mooring lines by adjusting the mooring line parameters fan et al 2014 also proposed a new method to design the truncated mooring system based on the damping equivalence in which the mooring damping was calculated by the quasi static method and the dissipation energy model the objective function was created with weighted damping force in different frequencies addition to the tension force and the genetic algorithm for a semi submersible with the depth of 1500 m the catenary semi taut and taut mooring systems were truncated to 700 m the results showed that the calculation program is feasible when the damping is considered fan et al 2017a made an experimental verification for the mooring system of the semi submersible platform with the static and damping equivalence under irregular wave to meet both static and dynamic equivalences for truncation design ma et al 2017 made a dynamic truncation for a fpso with a multi objective optimization method based on static equivalence for each line the coupled dynamic analysis is used to verify the dynamic similarity fan et al 2017b proposed an improved quasi static model to include the damping effect with the consideration that the lf excitation caused by the irregular wave may induce large resonant motion responses wei et al 2017a proposed a four level screening method for multi objectives problems in equivalent truncating design of moorings the procedure was refined into four steps which were optimized using common evolutionary multi objective optimization methods firstly a reasonable variable ranges of the relevant variables were selected according to the initial constraints then the static characteristics of each mooring line was analyzed separately to achieve the static equivalence of each line thirdly the entire system was analyzed to achieve the static equivalence finally the hydrodynamics of truncated and full depth moorings were compared to determine the remaining variables based on dynamic equivalence which was matched with the average deviation over the time series a truncated models of a taut mooring system and an asymmetric system were designed with this method the static and dynamic characteristics of the full depth and the truncated models were compared which showed that the truncation model under this method can equivalently replace the static and dynamic characteristics of the full depth system in order to further strengthen the accuracy of the equivalent truncated mooring system for the deep water platform wei et al 2017b used the above mentioned four level screening method to carry out an asymmetric truncation design and the model test for a semi submersible platform mooring system in 1500 m water depth a similar procedure was also created by ferreira et al 2016 a set of computers was used to check reliability of the design by performing dynamic simulations under different wave conditions this method was used to the catenary moored semi submersible platform and a semi taut moored fpso the comparison result showed that this method was feasible with a large involved computational cost it can be found that the dynamic truncation has formed a relative stable procedure which is to make the static truncation analysis first and then forward to the dynamic truncation analysis with the optimization algorithm the main difference is focused on the objective function which will lead to the accuracy the convergence and the calculation cost problems here a new objective function is proposed in the dynamic truncation method called dytrunmoor by using of the genetic algorithm and the slender rod model for the static and dynamic similarity this method will try to reserve the complete nonlinearity of the mooring forces and its peak values the second section is to describe the dynamic truncation method including the dynamic truncation principle the truncation scheme and the genetic algorithm nags ii and the slender rod model for the specified implementation the third and fourth sections are to demonstrate the verifications of the proposed method with two examples in static and dynamic responses 2 methodology of mooring truncation with dynamic similarity dytrunmoor the dynamic mooring truncation method is proposed in this paper and is simplified as dytrunmoor the consistent nonlinearity of one single line must lead to the same response of the whole mooring system so only one single line is discussed presently in detail in this paper 2 1 truncation principle the principle of the passive truncation analysis is to try to keep the same characteristics of the mooring line after the truncation the following items are suggested to be implemented 1 the components should be the same in both the truncated and the original line and there is no restrictions on the characteristic parameters of every part 2 the relationship of static offset and restoring force should be as close as possible in different directions for the truncated and the original line 3 the tensions should be as close as possible in different directions for the truncated and the original line 4 the dynamic characteristics should be as close as possible for truncated and original lines 2 2 truncation scheme in order to promote the truncation design efficiency the mooring program is combined with optimization algorithm and the static characteristics is ensured firstly then the dynamic characteristics is guaranteed the first step of the truncation design is to determine the variables of a mooring line for optimization there are many characteristic parameters of the different parts of a mooring line and some of them are important the length l axis stiffness ea and wet mass per length w are suitable for static analysis the dry weight per length m hydrodynamic diameter d are key parameters for dynamic analysis a subscript i is used for the index of the segment in line which starts from the anchor to the fairlead it is usually to demonstrate the segment of a mooring line as l e a w m d i the second step is to keep the static characteristics be consistent the curve of restoring force and offset is an important verification for the static characteristics of a mooring line in which specified offsets are applied on the fairlead and then the axial tensions are compared at different positions between truncated and original line the objective function of the optimization is expressed as 1 f i t s t a t i c 1 1 n j 1 n f x j t r u n f x j f u l l f x j f u l l 2 2 f i t s t a t i c 2 1 n j 1 n f y j t r u n f y j f u l l f y j f u l l 2 3 f i t s t a t i c 3 1 n j 1 n f z j t r u n f z j f u l l f z j f u l l 2 4 f i t s t a t i c 4 1 n j 1 n t j t r u n t j f u l l t j f u l l 2 where f i t s t a t i c 1 f i t s t a t i c 2 f i t s t a t i c 3 f i t s t a t i c 4 are the objective function in x y z and axial direction the index j means the offset of the fairlead n is the total number of applied offsets the superscript f u l l means the original mooring line in full water depth the superscript t r u n means the truncated mooring line f means the component force in x y z directions got from the tension force t the l e a w i are used in the static truncation analysis the final step is to meet the match of the dynamic response of the truncated and the origin mooring line in time domain on the base of the static truncation results which are optimized parameters l e a w i the new dynamic parameters different from static parameters are the mass per length in air and hydrodynamic diameter m d i in the static analysis the mooring line is set to the equilibrium state by the self weight and buoyance force which results a so called wet weight it is convenient to confirmed the wet weight first no matter with the shape of the mooring line the dry mass and the resultant area for buoyance force can be changed together to satisfy other restrictions the nonlinear dynamic forces mostly mean the inertial forces and the drag forces which are related with the mass the resultant area and the resultant diameter the d m and w are usually closely related by the buoyancy of the line especially for steel wire the other hydrodynamic parameters can be got with hydrodynamic diameter in the experiments the chain is usually added with separated leads which makes the diameter difficult to be determined so here both of them are listed as optimization parameters as wei et al 2017a b if the strong relation is used the chain can be recognized as wrapped in a massless tube then only dry mass will be determined in the dynamic optimization process the resultant area and diameter can be deduced with the wet mass and dry mass when all the parameters are used in the experiments the dry mass and wet mass should be strictly satisfied the diameter is usually recognized as a reference value because the mooring line in experiment may be mixed with different materials the key issue of the dynamic optimization is to connect the dynamic program with the optimization algorithm with limited time and compare the line tension between the truncated and un truncated lines in every time step the optimization will be too difficult to proceed if the selected points are numerous an innovative method is proposed here to construct an effective fitness function with transformation between the time domain and frequency domain for dynamic truncation optimization the procedures are as following 1 static truncation optimization of the mooring line to determine the optimal truncated parameters length axis stiffness and wet mass per length l e a w i 2 suppose the initial dynamic parameters m d i of the truncated line with a dynamic mooring model then the tensions and component forces of the truncated and full lines are got respectively 5 f x t f y t f z t t t m o o r d y n a m i d i where f x t f y t f z t t t are the component forces in x y z directions and axial tension at the fairlead of the line at every time step the m o o r d y n a is a dynamic mooring function to calculate the line forces in time domain it should be qualified to simulate the drag forces and inertial forces applied on mooring lines 3 get tension force amplitudes with frequencies with fast fourier transformation fft from time domain in this way the changes of the tensions at different frequencies can be decomposed clearly and the nonlinearity of mooring lines can be reserved as much as possible 6 a x f f f t f x t a y f f f t f y t a z f f f t f z t a t f f f t t t in which the a means the tension amplitude in different directions in frequency domain corresponding to different natural frequency f the f f t is the fast fourier transform function used to transfer tension history into frequency domain 4 construct dynamic truncation fitness function with representative tension amplitudes in frequency domain here the least square errors are used to build fitness function as 7 f i t d y n a 1 1 n k 1 n a x k t r u n a x k f u l l a x k f u l l 2 8 f i t d y n a 2 1 n k 1 n a y k t r u n a y k f u l l a y k f u l l 2 9 f i t d y n a 3 1 n k 1 n a z k t r u n a z k f u l l a z k f u l l 2 10 f i t d y n a 4 1 n k 1 n a t k t r u n a t k f u l l a t k f u l l 2 in which the k is the index of the tension amplitude the n is the number of adopted tension amplitudes and should cover a large domain of the curve especially the peak regions the n is suggested to be more than 20 in order to include as much valuable data as possible the frequencies around the peak tension amplitudes are suggested to be selected for the fitness comparison as fig 1 the value of n should be determined case by case depended on the profile of the tension amplitude in frequency domain 5 find pareto front solution with multi objective optimization algorithm and stop it until the results meet the requirement of truncation precision and there are usually many data sets got the best one may be chosen by the designer in accordance with specific conditions the procedure of the dynamic truncation analysis is in fig 2 2 3 slender rod model of mooring line in order to incorporate the nonlinearity of mooring lines the dynamic characteristics are simulated with slender rod model which is proposed by webster et al 2012 and ma et al 2014 in the mooring line model the main issue to simulate the nonlinear distributed force in which the hydrodynamic loads consist of the drag and inertial forces here the forces are simulated with the morison equations written as 11 q d s t 1 2 ρ f c d d f n v r s t n v r s t 12 q a s t ρ f a f c m n v f s t r s t in which q d is the drag force vector q a is the inertial force vector added mass part c d is the tangent drag coefficient c m is the tangent added mass coefficient ρ f is the sea water density d f is the resultant diameter for the drag force a f is the resultant area for hydro forces including buoyance force and inertial force n is the coordinate transformation matrix v r is the relevant velocity vector between rod and fluid v f is the fluid acceleration r is the rod acceleration 2 4 optimization procedure for truncation analysis considering the rapidity and efficiency the multi objective optimization algorithm is found to be suitable for the mooring truncation design the nsga ii is used to optimize the truncation of mooring system with the procedure demonstrated in fig 3 during the truncation design it is important to set allowable domains of the mooring variables and it is helpful for the optimization program to converge quickly define x i as the optimization variable and then the domain of x i is 13 x i l x i x i u where x i l is the lower limit x i u is the upper limit i 1 n and n is the number of optimization variables in this study the following is used for the bound values 1 the length of every part should between 0 and l f u l l which is the full length of the un truncated line 2 the domain of axial stiffness wet mass per length hydrodynamic diameter of each segment is initialized based on geometric scale theory the domain of the truncated parameters should be near the 14 γ h t r u n c h f u l l 15 e a t r u n c i γ e a f u l l i 16 w t r u n c i w f u l l i γ 17 m t r u n c i m f u l l i γ 18 d t r u n c i d f u l l i γ where γ is the truncation factor h is the water depth i is index of segment of mooring line 3 case study of one mooring line a single catenary mooring line is discussed as a verification case for dynamic truncation method the line is truncated to 1050 m water depth from 1500 m 3 1 original catenary mooring line the geometrical parameters of the original mooring line are listed in table 1 the origin of the global coordinate system is at the mean water surface with positive y upwards as in fig 4 the pretension is 1890 kn 3 2 static truncation scheme static truncation analysis is carried out firstly the horizontal span of the anchor is determined to be 1700 m according to the actual demands which are constant during the truncation procedure the static truncation analysis is performed in two schemes both in one dimention and two dimentions and the offset points are adopted in vertical plane in the one dimention case the offsets are applied in x direction in the two dimention case the offsets are applied in x and y directions meanwhile as fig 5 the static truncation analysis will result in a series of results as pareto solutions fig 6 in which each point means a solution grouped with l e a w i those results are equivalent for the fitness functions used in the static truncation the displacement offsets in x direction only and in xy directions are used separately to obtain the static property of the mooring line in the optimization process it can be found that both of them get good results under the same level of relative fitness errors the pareto front means all the results have the equivalent weight in the optimization process so one of them is selected and presented in table 2 the static property is checked in fig 7 in the static truncation analysis the maximum horizontal offset maybe 5 6 of the water depth here the offset 75 m is adopted to check the static characteristics it can be found that the maximum difference is at the largest offset position the relative errors for the horizontal force the vertical force and the tension are 5 07 0 65 and 0 89 respectively at the maximum offset position that means the static characteristics are reserved well and acceptable for the further analysis 3 3 dynamic truncation scheme based on the static results the dynamic truncation analysis is carried out with the target to get the dry mass resultant areas and diameters for hydrodynamic effects in this section the resultant areas are supposed to get from diameters which are optimized with nsga ii as well as the dry masses in the next section a strong relationship is created for the dry mass area and diameter with wet mass to study the coupled dynamic response 3 3 1 effect of population size in dynamic truncation the population size is a key parameter in the optimizaiton algorithm nsag ii to find potential solutions usually the bigger the population size is the more accuracy results are calculated which also means more time are consumed here is to find a suitable value for the optimization the dynamic truncation analysis is set up with the forced sinusoidal motion in x direction amplitude 20 m period 600s the parameter population size is set to 100 200 and 300 in order to meet the convergence requirement from the result shown in fig 8 it is can be found that the population size 100 is good enough to find the best potensional solution with the same level of fitness errors compared with population size 200 and 300 3 3 2 the forced sinusoidal motion in horizontal plane the forced motion is created with three frequencies for the sinusoidal motion together as in table 3 with equation 19 from fig 9 it can be found that the population size 100 can not be suitable for this case the population size 200 and 300 are both get almost the same fitness error which means the population size 200 is good enough for this calculation 19 x i 1 3 a i sin 2 π t i t in which x is the forced moved displacement a is the amplitude of i t h force motion t i is the period of the i t h forced motion in order to check the accuracy of the dynamic truncation result the dynamic analysis is performed in time domain for the original mooring line the selected 3 sets of results from fig 9 listed in table 4 the first set result means the fitness error is small in x direction the second one means the fitness error is small in y direction the third one means the fitness errors reach a compromise in x and y direction additional the average values calculated from first third pareto results are also used in order to make a quick choice for potential solutions from the time history in fig 10 the force amplitudes of the truncated line are a little larger than the original line in x direction inversely for the force amplitude in y direction as shown in fig 11 as a result the tension is consistent for all lines fig 12 the amplitude and frequency are also checked with the fft transformation as shown in fig 13 and fig 14 4 case study of a semi mooring system the proposed method is verified with a coupled dynamic response of a semi submersible semi platform for which the mooring system working in 1200 m is truncated to 700 m water depth the main dimensions of semi are listed in table 5 there are 12 catenary mooring lines altogether and with three segments in each line as in fig 15 and table 6 in this section the relationships of wet mass dry mass resultant area and diameter are set up with the following formulas 20 w m ρ a f 21 a f π d f 2 4 in which the a f is the resultant area acting for the inertial force and buoyance force the d f is the resultant diameter acting for the drag force 4 1 static truncation of mooring system of semi the static truncation design is carried out by the optimizaiton of segment length axial stiffness and the mass in water in order to get reasonable results the axial stiffness is set to be less than 10 times the original value the population size is set to be 500 within nsga ii as well as 10 generations each horizontal displacement offset is 5 m which is repeated for 15 times finally the best fitness result is selected from the pareto front with the maximus relative error under 1 in each direction table 7 the static property of the mooring line is plotted with a good consistent in all directions fig 16 which means the truncated line has a very good similarity with the original line there are some differences in vertical direction when the offset becomes large the difference is relatively very small especially compared to the greate displacements of the semi 53847 5t 4 2 dynamic truncation of mooring system of semi the dynamic truncation is performed based on the static truncation results the main target is to find suitable dry mass the specified forced motions are applied on the top point of mooring line with the following 4 sets of amplitudes and periods table 8 the drag coffecient and added mass coffecient are set to be 1 0 the coupled analysis is simulated for 10000s in time domain with aqwa the population size and generations are the same with the static truncation case the range of dry mass is set to be less than double of the original dry mass the pareto front is finally calculated fig 17 and one of the best fitness result is select from the pareto front as table 9 the resultant diameters and areas are calculated with equations 20 and 21 the time history is checked in fig 18 it can be found that the periods and phases are well matched with a little difference on the amplitudes it means it is very difficulty to make sure the components of the tension be completely matched the relative errors should be considered when the optimized value used in experiments the coupled motion analysis is performed to check the accuracy further under irregular waves the johnswap spectrum is used with hs 8 0 m tp 13 0s γ 2 5 the waves are supposed to act on semi with relative 30 degree the dynamic responses of the semi platform are very good consistent in vertical direction due to the heavy displacements of the semi resulting the small displacement the motions in horizontal place has the almost same phases in time domain as well as the high quality peak capture fig 19 the components of the testation are checked for line 2 in the time series fig 20 it is very clear to classify the varying of the forces due to the wave frequency and the difference frequency the periods due to the slow drift motion are matched well in each direction the main differences are focused on the amplitudes of the forces the minimum maximum mean and rms are compared in table 10 it can be found that the mean value of the tension is very close with each other with the relative error 0 94 the maximum tension is also captured with the relative error 6 38 the semi is positioned with symmetric mooring lines even there are some horizontal differences the total forces can also be balanced from the relative smaller platform motion and larger restore force it can be found that the optimized mooring system has a little larger stiffness than the original mooring system all of those demonstrate that the proposed method has a good ability to simulate the dynamic truncation of mooring line in deepwater 5 conclusions a dynamic truncation method is proposed with combination of slender rod model and multi objective genetic algorithm nsga ii verification cases of one catenary mooring line and semi mooring system are demonstrated for the convergence and the accuracy the conclusions can be conducted as following 1 the fitness function for the optimization is constructed with tension amplitudes transformed from time domain it is proved that this process makes a guaranty for the nonlinear consistence of the truncated and the original mooring line 2 it is well verified that the combination of slender rod model and nsga ii is an effective way to find right mooring parameters for both the static and dynamic responses the isolation of two parameter groups l e a w i and m d i is helpful for the efficient optimization process in which maximum 9 parameters are used that almost reach the best optimization ability of nsga ii 3 two cases are used to verify the accuracy of the proposed method with 1500 m water depth truncated to 1050 m and 1200 m 700 m both of them get good consistence in static and dynamic responses in the static truncation process the stiffness is the key parameter which is suggested to be less than 10 times of the original value in the dynamic truncation analysis the dry mass is suggested to be limited by the reference of the wet mass e g less than 2 times acknowledgments the work presented here is supported by the national natural science foundation of china grant no 51739001 51579056 51879047 the natural science foundation of heilongjiang province of china grant no e2017029 the fundamental research funds for the central universities grant no heucf180103 the national science and technology major project of china grant no 2016zx05057020 
22933,the passive truncation model called dytrunmoor is proposed to realize the dynamic similarity of mooring line in this paper the nonlinear inertial forces and drag forces are integrated with morison model within elastic rod model to reserve dynamic response of mooring line the mooring line parameters of truncated line are figured out with the optimization algorithm nsga ii for the static and dynamic simulation the fitness function for nsga ii is constructed with tension amplitudes corresponding to limited frequencies which are fetched from tension history with fast fourier transform algorithm a single mooring line is discussed in detail with truncation from 1500 m to 1050 m water depth the feasibility and accuracy of the truncation method is verified with harmonic forced motion which shows a consistent nonlinearity in the dynamic response of the original and the truncated mooring line truncation design is also carried out to a semi submersible platform mooring system truncated from 1200 m to 700 m the static and dynamic characteristics are compared which verifies the validity of the proposed method keywords mooring line dynamic similarity passive truncation consistent nonlinearity elastic rod model 1 introduction the oil and gas industry turns the attention to the deeper ocean for more resources from the 1990s which leads the working depth of the floating platform mooring system continuously increasing and various floating structures are designed to adapt to the new environment the accuracy and reliability of the design and theoretical analysis results usually need to be verified by model tests however the deep water mooring system cannot be modeled entirely in the basin with a reasonable scale due to the limit dimension of offshore basin the hybrid model testing is a feasible method for this problem including the active truncation and the passive truncation an improved passive model is proposed in this paper the majority of current truncation designs is the passive pattern which is proposed by ittc in the passive truncation system the lower part of mooring line is excluded and the truncation point is fixed the most important step is the redesign of mooring system to make the equivalence to full deep system called the equivalent truncation design of mooring system secondly the model test is carried out in the basin with the equivalent truncation model test in which the static characteristics of the mooring system is ensured it is becoming difficult to achieve the accuracy with the depth of water increasing so the numerical reconstruction and numerical extrapolation methods are used to solve this problem the reconstruction is a numerical simulation of truncation model test by adjusting each hydrodynamic parameter until the calculation result is consistent with the test result then the full depth system is numerically simulated and calculated through extrapolation finally this results are adopted as the ultimate passive hybrid model test solution the ultimate objective of truncation design is to achieve static and dynamic equivalence with respect to a full depth system after a lot of research static equivalence can already be well implemented qiao and ou 2014 made a truncation model test for mooring lines of a semi submersible platform the mooring line was truncated to 400 m from 1500 m full depth felix gonzalez and mercier 2016 developed a program for optimization design of the statically equivalent mooring system based on the genetic algorithm and a fitness function was established to perform an extensive search from multiple sets of design parameters to find the optimal solution a semisubmersible with polyester mooring lines as a research example was used to confirm the robustness and reliability of the genetic algorithm optimization process the genetic algorithm was also used for the optimization of mooring system by yan et al 2018 and shafieefar and rezvani 2007 wang et al 2016 analyzed a turret moored fpso with good agreements obtained in static characteristics in which the numerical simulations are performed based on lumped mass model and the catenary theory zhang et al 2017 used the passive mooring truncation method to truncate an internal turret mooring system from the water depth of 320 m 160 m the static characteristics were consistent for the full depth and the truncated mooring system which were verified by the model tests fan et al 2018 made the truncation analysis for catenary semi taut and taut mooring systems for a semi submersible platform in order to achieve the dynamic similarity of truncated mooring system many solutions were proposed ji and xu 2014 investigated the platform motion responses and the mooring line dynamics for a large truncation factor greater than 5 the mooring system of a semi submersible platform was truncated to 200 m from 1000 m to 1500 m respectively the dynamic responses of mooring lines were obtained by model test the damping equivalence method was also proposed with the concept that the damping was important for evaluating low frequency motion su et al 2009 studied the effect of mooring line parameters on damping by the combination of numerical calculations and model tests which showed that the wave damping of truncated mooring lines can be good agreement with full depth mooring lines by adjusting the mooring line parameters fan et al 2014 also proposed a new method to design the truncated mooring system based on the damping equivalence in which the mooring damping was calculated by the quasi static method and the dissipation energy model the objective function was created with weighted damping force in different frequencies addition to the tension force and the genetic algorithm for a semi submersible with the depth of 1500 m the catenary semi taut and taut mooring systems were truncated to 700 m the results showed that the calculation program is feasible when the damping is considered fan et al 2017a made an experimental verification for the mooring system of the semi submersible platform with the static and damping equivalence under irregular wave to meet both static and dynamic equivalences for truncation design ma et al 2017 made a dynamic truncation for a fpso with a multi objective optimization method based on static equivalence for each line the coupled dynamic analysis is used to verify the dynamic similarity fan et al 2017b proposed an improved quasi static model to include the damping effect with the consideration that the lf excitation caused by the irregular wave may induce large resonant motion responses wei et al 2017a proposed a four level screening method for multi objectives problems in equivalent truncating design of moorings the procedure was refined into four steps which were optimized using common evolutionary multi objective optimization methods firstly a reasonable variable ranges of the relevant variables were selected according to the initial constraints then the static characteristics of each mooring line was analyzed separately to achieve the static equivalence of each line thirdly the entire system was analyzed to achieve the static equivalence finally the hydrodynamics of truncated and full depth moorings were compared to determine the remaining variables based on dynamic equivalence which was matched with the average deviation over the time series a truncated models of a taut mooring system and an asymmetric system were designed with this method the static and dynamic characteristics of the full depth and the truncated models were compared which showed that the truncation model under this method can equivalently replace the static and dynamic characteristics of the full depth system in order to further strengthen the accuracy of the equivalent truncated mooring system for the deep water platform wei et al 2017b used the above mentioned four level screening method to carry out an asymmetric truncation design and the model test for a semi submersible platform mooring system in 1500 m water depth a similar procedure was also created by ferreira et al 2016 a set of computers was used to check reliability of the design by performing dynamic simulations under different wave conditions this method was used to the catenary moored semi submersible platform and a semi taut moored fpso the comparison result showed that this method was feasible with a large involved computational cost it can be found that the dynamic truncation has formed a relative stable procedure which is to make the static truncation analysis first and then forward to the dynamic truncation analysis with the optimization algorithm the main difference is focused on the objective function which will lead to the accuracy the convergence and the calculation cost problems here a new objective function is proposed in the dynamic truncation method called dytrunmoor by using of the genetic algorithm and the slender rod model for the static and dynamic similarity this method will try to reserve the complete nonlinearity of the mooring forces and its peak values the second section is to describe the dynamic truncation method including the dynamic truncation principle the truncation scheme and the genetic algorithm nags ii and the slender rod model for the specified implementation the third and fourth sections are to demonstrate the verifications of the proposed method with two examples in static and dynamic responses 2 methodology of mooring truncation with dynamic similarity dytrunmoor the dynamic mooring truncation method is proposed in this paper and is simplified as dytrunmoor the consistent nonlinearity of one single line must lead to the same response of the whole mooring system so only one single line is discussed presently in detail in this paper 2 1 truncation principle the principle of the passive truncation analysis is to try to keep the same characteristics of the mooring line after the truncation the following items are suggested to be implemented 1 the components should be the same in both the truncated and the original line and there is no restrictions on the characteristic parameters of every part 2 the relationship of static offset and restoring force should be as close as possible in different directions for the truncated and the original line 3 the tensions should be as close as possible in different directions for the truncated and the original line 4 the dynamic characteristics should be as close as possible for truncated and original lines 2 2 truncation scheme in order to promote the truncation design efficiency the mooring program is combined with optimization algorithm and the static characteristics is ensured firstly then the dynamic characteristics is guaranteed the first step of the truncation design is to determine the variables of a mooring line for optimization there are many characteristic parameters of the different parts of a mooring line and some of them are important the length l axis stiffness ea and wet mass per length w are suitable for static analysis the dry weight per length m hydrodynamic diameter d are key parameters for dynamic analysis a subscript i is used for the index of the segment in line which starts from the anchor to the fairlead it is usually to demonstrate the segment of a mooring line as l e a w m d i the second step is to keep the static characteristics be consistent the curve of restoring force and offset is an important verification for the static characteristics of a mooring line in which specified offsets are applied on the fairlead and then the axial tensions are compared at different positions between truncated and original line the objective function of the optimization is expressed as 1 f i t s t a t i c 1 1 n j 1 n f x j t r u n f x j f u l l f x j f u l l 2 2 f i t s t a t i c 2 1 n j 1 n f y j t r u n f y j f u l l f y j f u l l 2 3 f i t s t a t i c 3 1 n j 1 n f z j t r u n f z j f u l l f z j f u l l 2 4 f i t s t a t i c 4 1 n j 1 n t j t r u n t j f u l l t j f u l l 2 where f i t s t a t i c 1 f i t s t a t i c 2 f i t s t a t i c 3 f i t s t a t i c 4 are the objective function in x y z and axial direction the index j means the offset of the fairlead n is the total number of applied offsets the superscript f u l l means the original mooring line in full water depth the superscript t r u n means the truncated mooring line f means the component force in x y z directions got from the tension force t the l e a w i are used in the static truncation analysis the final step is to meet the match of the dynamic response of the truncated and the origin mooring line in time domain on the base of the static truncation results which are optimized parameters l e a w i the new dynamic parameters different from static parameters are the mass per length in air and hydrodynamic diameter m d i in the static analysis the mooring line is set to the equilibrium state by the self weight and buoyance force which results a so called wet weight it is convenient to confirmed the wet weight first no matter with the shape of the mooring line the dry mass and the resultant area for buoyance force can be changed together to satisfy other restrictions the nonlinear dynamic forces mostly mean the inertial forces and the drag forces which are related with the mass the resultant area and the resultant diameter the d m and w are usually closely related by the buoyancy of the line especially for steel wire the other hydrodynamic parameters can be got with hydrodynamic diameter in the experiments the chain is usually added with separated leads which makes the diameter difficult to be determined so here both of them are listed as optimization parameters as wei et al 2017a b if the strong relation is used the chain can be recognized as wrapped in a massless tube then only dry mass will be determined in the dynamic optimization process the resultant area and diameter can be deduced with the wet mass and dry mass when all the parameters are used in the experiments the dry mass and wet mass should be strictly satisfied the diameter is usually recognized as a reference value because the mooring line in experiment may be mixed with different materials the key issue of the dynamic optimization is to connect the dynamic program with the optimization algorithm with limited time and compare the line tension between the truncated and un truncated lines in every time step the optimization will be too difficult to proceed if the selected points are numerous an innovative method is proposed here to construct an effective fitness function with transformation between the time domain and frequency domain for dynamic truncation optimization the procedures are as following 1 static truncation optimization of the mooring line to determine the optimal truncated parameters length axis stiffness and wet mass per length l e a w i 2 suppose the initial dynamic parameters m d i of the truncated line with a dynamic mooring model then the tensions and component forces of the truncated and full lines are got respectively 5 f x t f y t f z t t t m o o r d y n a m i d i where f x t f y t f z t t t are the component forces in x y z directions and axial tension at the fairlead of the line at every time step the m o o r d y n a is a dynamic mooring function to calculate the line forces in time domain it should be qualified to simulate the drag forces and inertial forces applied on mooring lines 3 get tension force amplitudes with frequencies with fast fourier transformation fft from time domain in this way the changes of the tensions at different frequencies can be decomposed clearly and the nonlinearity of mooring lines can be reserved as much as possible 6 a x f f f t f x t a y f f f t f y t a z f f f t f z t a t f f f t t t in which the a means the tension amplitude in different directions in frequency domain corresponding to different natural frequency f the f f t is the fast fourier transform function used to transfer tension history into frequency domain 4 construct dynamic truncation fitness function with representative tension amplitudes in frequency domain here the least square errors are used to build fitness function as 7 f i t d y n a 1 1 n k 1 n a x k t r u n a x k f u l l a x k f u l l 2 8 f i t d y n a 2 1 n k 1 n a y k t r u n a y k f u l l a y k f u l l 2 9 f i t d y n a 3 1 n k 1 n a z k t r u n a z k f u l l a z k f u l l 2 10 f i t d y n a 4 1 n k 1 n a t k t r u n a t k f u l l a t k f u l l 2 in which the k is the index of the tension amplitude the n is the number of adopted tension amplitudes and should cover a large domain of the curve especially the peak regions the n is suggested to be more than 20 in order to include as much valuable data as possible the frequencies around the peak tension amplitudes are suggested to be selected for the fitness comparison as fig 1 the value of n should be determined case by case depended on the profile of the tension amplitude in frequency domain 5 find pareto front solution with multi objective optimization algorithm and stop it until the results meet the requirement of truncation precision and there are usually many data sets got the best one may be chosen by the designer in accordance with specific conditions the procedure of the dynamic truncation analysis is in fig 2 2 3 slender rod model of mooring line in order to incorporate the nonlinearity of mooring lines the dynamic characteristics are simulated with slender rod model which is proposed by webster et al 2012 and ma et al 2014 in the mooring line model the main issue to simulate the nonlinear distributed force in which the hydrodynamic loads consist of the drag and inertial forces here the forces are simulated with the morison equations written as 11 q d s t 1 2 ρ f c d d f n v r s t n v r s t 12 q a s t ρ f a f c m n v f s t r s t in which q d is the drag force vector q a is the inertial force vector added mass part c d is the tangent drag coefficient c m is the tangent added mass coefficient ρ f is the sea water density d f is the resultant diameter for the drag force a f is the resultant area for hydro forces including buoyance force and inertial force n is the coordinate transformation matrix v r is the relevant velocity vector between rod and fluid v f is the fluid acceleration r is the rod acceleration 2 4 optimization procedure for truncation analysis considering the rapidity and efficiency the multi objective optimization algorithm is found to be suitable for the mooring truncation design the nsga ii is used to optimize the truncation of mooring system with the procedure demonstrated in fig 3 during the truncation design it is important to set allowable domains of the mooring variables and it is helpful for the optimization program to converge quickly define x i as the optimization variable and then the domain of x i is 13 x i l x i x i u where x i l is the lower limit x i u is the upper limit i 1 n and n is the number of optimization variables in this study the following is used for the bound values 1 the length of every part should between 0 and l f u l l which is the full length of the un truncated line 2 the domain of axial stiffness wet mass per length hydrodynamic diameter of each segment is initialized based on geometric scale theory the domain of the truncated parameters should be near the 14 γ h t r u n c h f u l l 15 e a t r u n c i γ e a f u l l i 16 w t r u n c i w f u l l i γ 17 m t r u n c i m f u l l i γ 18 d t r u n c i d f u l l i γ where γ is the truncation factor h is the water depth i is index of segment of mooring line 3 case study of one mooring line a single catenary mooring line is discussed as a verification case for dynamic truncation method the line is truncated to 1050 m water depth from 1500 m 3 1 original catenary mooring line the geometrical parameters of the original mooring line are listed in table 1 the origin of the global coordinate system is at the mean water surface with positive y upwards as in fig 4 the pretension is 1890 kn 3 2 static truncation scheme static truncation analysis is carried out firstly the horizontal span of the anchor is determined to be 1700 m according to the actual demands which are constant during the truncation procedure the static truncation analysis is performed in two schemes both in one dimention and two dimentions and the offset points are adopted in vertical plane in the one dimention case the offsets are applied in x direction in the two dimention case the offsets are applied in x and y directions meanwhile as fig 5 the static truncation analysis will result in a series of results as pareto solutions fig 6 in which each point means a solution grouped with l e a w i those results are equivalent for the fitness functions used in the static truncation the displacement offsets in x direction only and in xy directions are used separately to obtain the static property of the mooring line in the optimization process it can be found that both of them get good results under the same level of relative fitness errors the pareto front means all the results have the equivalent weight in the optimization process so one of them is selected and presented in table 2 the static property is checked in fig 7 in the static truncation analysis the maximum horizontal offset maybe 5 6 of the water depth here the offset 75 m is adopted to check the static characteristics it can be found that the maximum difference is at the largest offset position the relative errors for the horizontal force the vertical force and the tension are 5 07 0 65 and 0 89 respectively at the maximum offset position that means the static characteristics are reserved well and acceptable for the further analysis 3 3 dynamic truncation scheme based on the static results the dynamic truncation analysis is carried out with the target to get the dry mass resultant areas and diameters for hydrodynamic effects in this section the resultant areas are supposed to get from diameters which are optimized with nsga ii as well as the dry masses in the next section a strong relationship is created for the dry mass area and diameter with wet mass to study the coupled dynamic response 3 3 1 effect of population size in dynamic truncation the population size is a key parameter in the optimizaiton algorithm nsag ii to find potential solutions usually the bigger the population size is the more accuracy results are calculated which also means more time are consumed here is to find a suitable value for the optimization the dynamic truncation analysis is set up with the forced sinusoidal motion in x direction amplitude 20 m period 600s the parameter population size is set to 100 200 and 300 in order to meet the convergence requirement from the result shown in fig 8 it is can be found that the population size 100 is good enough to find the best potensional solution with the same level of fitness errors compared with population size 200 and 300 3 3 2 the forced sinusoidal motion in horizontal plane the forced motion is created with three frequencies for the sinusoidal motion together as in table 3 with equation 19 from fig 9 it can be found that the population size 100 can not be suitable for this case the population size 200 and 300 are both get almost the same fitness error which means the population size 200 is good enough for this calculation 19 x i 1 3 a i sin 2 π t i t in which x is the forced moved displacement a is the amplitude of i t h force motion t i is the period of the i t h forced motion in order to check the accuracy of the dynamic truncation result the dynamic analysis is performed in time domain for the original mooring line the selected 3 sets of results from fig 9 listed in table 4 the first set result means the fitness error is small in x direction the second one means the fitness error is small in y direction the third one means the fitness errors reach a compromise in x and y direction additional the average values calculated from first third pareto results are also used in order to make a quick choice for potential solutions from the time history in fig 10 the force amplitudes of the truncated line are a little larger than the original line in x direction inversely for the force amplitude in y direction as shown in fig 11 as a result the tension is consistent for all lines fig 12 the amplitude and frequency are also checked with the fft transformation as shown in fig 13 and fig 14 4 case study of a semi mooring system the proposed method is verified with a coupled dynamic response of a semi submersible semi platform for which the mooring system working in 1200 m is truncated to 700 m water depth the main dimensions of semi are listed in table 5 there are 12 catenary mooring lines altogether and with three segments in each line as in fig 15 and table 6 in this section the relationships of wet mass dry mass resultant area and diameter are set up with the following formulas 20 w m ρ a f 21 a f π d f 2 4 in which the a f is the resultant area acting for the inertial force and buoyance force the d f is the resultant diameter acting for the drag force 4 1 static truncation of mooring system of semi the static truncation design is carried out by the optimizaiton of segment length axial stiffness and the mass in water in order to get reasonable results the axial stiffness is set to be less than 10 times the original value the population size is set to be 500 within nsga ii as well as 10 generations each horizontal displacement offset is 5 m which is repeated for 15 times finally the best fitness result is selected from the pareto front with the maximus relative error under 1 in each direction table 7 the static property of the mooring line is plotted with a good consistent in all directions fig 16 which means the truncated line has a very good similarity with the original line there are some differences in vertical direction when the offset becomes large the difference is relatively very small especially compared to the greate displacements of the semi 53847 5t 4 2 dynamic truncation of mooring system of semi the dynamic truncation is performed based on the static truncation results the main target is to find suitable dry mass the specified forced motions are applied on the top point of mooring line with the following 4 sets of amplitudes and periods table 8 the drag coffecient and added mass coffecient are set to be 1 0 the coupled analysis is simulated for 10000s in time domain with aqwa the population size and generations are the same with the static truncation case the range of dry mass is set to be less than double of the original dry mass the pareto front is finally calculated fig 17 and one of the best fitness result is select from the pareto front as table 9 the resultant diameters and areas are calculated with equations 20 and 21 the time history is checked in fig 18 it can be found that the periods and phases are well matched with a little difference on the amplitudes it means it is very difficulty to make sure the components of the tension be completely matched the relative errors should be considered when the optimized value used in experiments the coupled motion analysis is performed to check the accuracy further under irregular waves the johnswap spectrum is used with hs 8 0 m tp 13 0s γ 2 5 the waves are supposed to act on semi with relative 30 degree the dynamic responses of the semi platform are very good consistent in vertical direction due to the heavy displacements of the semi resulting the small displacement the motions in horizontal place has the almost same phases in time domain as well as the high quality peak capture fig 19 the components of the testation are checked for line 2 in the time series fig 20 it is very clear to classify the varying of the forces due to the wave frequency and the difference frequency the periods due to the slow drift motion are matched well in each direction the main differences are focused on the amplitudes of the forces the minimum maximum mean and rms are compared in table 10 it can be found that the mean value of the tension is very close with each other with the relative error 0 94 the maximum tension is also captured with the relative error 6 38 the semi is positioned with symmetric mooring lines even there are some horizontal differences the total forces can also be balanced from the relative smaller platform motion and larger restore force it can be found that the optimized mooring system has a little larger stiffness than the original mooring system all of those demonstrate that the proposed method has a good ability to simulate the dynamic truncation of mooring line in deepwater 5 conclusions a dynamic truncation method is proposed with combination of slender rod model and multi objective genetic algorithm nsga ii verification cases of one catenary mooring line and semi mooring system are demonstrated for the convergence and the accuracy the conclusions can be conducted as following 1 the fitness function for the optimization is constructed with tension amplitudes transformed from time domain it is proved that this process makes a guaranty for the nonlinear consistence of the truncated and the original mooring line 2 it is well verified that the combination of slender rod model and nsga ii is an effective way to find right mooring parameters for both the static and dynamic responses the isolation of two parameter groups l e a w i and m d i is helpful for the efficient optimization process in which maximum 9 parameters are used that almost reach the best optimization ability of nsga ii 3 two cases are used to verify the accuracy of the proposed method with 1500 m water depth truncated to 1050 m and 1200 m 700 m both of them get good consistence in static and dynamic responses in the static truncation process the stiffness is the key parameter which is suggested to be less than 10 times of the original value in the dynamic truncation analysis the dry mass is suggested to be limited by the reference of the wet mass e g less than 2 times acknowledgments the work presented here is supported by the national natural science foundation of china grant no 51739001 51579056 51879047 the natural science foundation of heilongjiang province of china grant no e2017029 the fundamental research funds for the central universities grant no heucf180103 the national science and technology major project of china grant no 2016zx05057020 
22934,in this paper suffering from multiple unknowns including unmodeled dynamics uncertainties and disturbances a fuzzy unknown observer based robust adaptive path following control fuo rapfc scheme for an underactuated surface vehicle usv is proposed main contributions are as follows 1 a surge guided line of sight sglos guidance law is created to guide surge speed and heading angle simultaneously and thereby adapting to path following errors to enhance robustness and flexibility 2 by virtue of combining auxiliary observation dynamics with adaptive approximation error compensation the fuo is innovatively devised to accurately lumped unknowns rather than bounded observations 3 fuo based robust adaptive tracking control laws are eventually synthesized and ensure that the guided signals can be globally asymptotically tracked simulation studies are conducted to demonstrate remarkable performance of the fuo rapfc scheme keywords surge guided line of sight guidance path following control underactuated surface vehicle fuzzy unknown observer 1 introduction the application of underactuated surface vehicles usvs becomes more and more prevalent due to its flexibility and versatility in both maritime civilian and military wynn and huvenne 2014 xu and xiao 2007 xiang et al 2016 wang et al 2018a 2018b accordingly motion control of usvs has been being within a research hotspot allotta et al 2016 mai et al 2017 zhao et al 2016 in the literature among most of scenarios including stabilization trajectory tracking and path following it is of practical importance to follow a predefined path without time constraint and thereby resulting that path following control pfc takes a critical part in various high risk unmanned maritime tasks the overall pfc scheme of a usv usually includes guidance module and control module fossen 1994 fossen et al 2003 breivik and fossen whereby the former is utilized to generate guidance signals which may include attitudes and or velocities and the later is required to follow previous guided references the former guidance module works at guiding attitudes and or velocities the line of sight los guidance method has been prevalently used for path following of a usv whereby an los projection algorithm was deployed to follow a segmented path actually connected by waypoints fossen et al 2003 the proportional line of sight plos guidance approach was proposed in pettersen and lefeber 2001 and fossen and pettersen 2014 where the guided heading angle was derived from the arctangent value associated with cross track error and lookahead distance however the sideslip angle i e the discrepancy between the heading and the course angles which may be caused by multiple unknowns and or maneuvers has not been addressed in previous works in brhaug et al 2008 and caharija and pettersen 2016 taking sideslip angle as a slow time varying unknown term the integral line of sight ilos guidance was proposed to compensate the unknown sideslip the adaptive los alos guidance method was proposed in fossen et al 2015 whereby unknown sideslip was estimated by an adaptive term the guidance approach for curved paths was developed in moe et al 2016 it should be noted that the previous guidance laws proposed in fossen et al 2003 breivik and fossen pettersen and lefeber 2001 fossen and pettersen 2014 brhaug et al 2008 caharija and pettersen 2016 fossen et al 2015 moe et al 2016 inevitably suffer from the singularity problem in the selection of projection points nevertheless surge velocity is roughly treated as a user defined parameter and is usually predefined as a constant in this context the usv is actually controlled only by the rudder torque and thereby not only cutting down the overall manipulability but also increasing maneuvering burden on the rudder the control module within the path following scheme is desired to render the usv track the guided signals as accurately as possible in this context nonlinear tracking controllers can be directly derived from backstepping like techniques wang et al 2017a 2017b zhou et al 2017a li et al 2017 in li et al 2008 the adaptive controllers were designed to solve waypoint tracking problem of a usv whereby all tracking error signals within the closed loop system were rendered to be uniformly ultimately bounded in miao et al 2017 the auto disturbances rejection control adrc approach was deployed to achieve pfc of a uuv recently an adaptive robust finite time tracking control schemes using non smooth and homogeneity tools for trajectory tracking of a marine surface vehicle with unknown disturbances have been proposed in wang et al 2016a liu et al 2017 a singular perturbation control strategy has been developed in yi et al 2016 in order to handle complex unknowns finite time observer based motion control schemes for marine vehicles have been addressed in wang et al 2017d note that intelligent approaches have been extensively applied to various industrial areas wang et al 2018d 2019 fuzzy systems wang et al 2017e 2018e artificial neural networks wang et al 2015a and fuzzy neural networks wang and er 2015 etc have been intensively explored within trajectory tracking control of marine surface vehicles in wang et al 2017f an adaptive universe based fuzzy control scheme with retractable fuzzy partitioning in global universe of discourse has been created to achieve global asymptotic model free trajectory independent tracking however comparing to tracking control approaches of fully actuated marine vehicles complex unknowns pertaining to underactuated marine vehicles are still hardly be tackled sufficiently due to underactuation appearing in sway dynamics in this paper motivated by above observations a fuzzy unknown observer based robust adaptive path following control fuo rapfc scheme is created to achieve accurate path following of a usv with multiple unknowns including internal unmodeled dynamics e g parametric unknowns uncertainties and external disturbances simultaneously which have not been addressed in previous works stemming from line of sight los approach a surge guided los sglos guidance law is devised and ensures that the reference surge speed can be autonomously guided with respect to path following errors to be more interesting by designing auxiliary observation dynamics the fuo is innovatively devised to accurately estimate multiple unknowns and thereby contributing to robust adaptive tracking controllers which guarantee that guided signals can be accurately tracked the rest is organized as follows section 2 states problem formulation the sglos guidance law and the fuo based robust adaptive tracking controllers are presented in sections 3 and 4 respectively simulation studies are conducted in section 5 section 6 concludes this paper 2 problem formulation 2 1 usv kinematics and dynamics the kinematics of a usv are as follows fossen 1 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r where x y ψ are planar position and heading orientation of the usv in the earth fixed frame and u v r are surge sway and yaw velocities within the body fixed frame respectively suffering from the internal unmodelled dynamics parametric perturbations and external environmental disturbances the dynamics of a usv can be formulated as follows 2 m 11 δ m 11 u m 22 δ m 22 v r d 11 δ d 11 u τ u τ δ u m 22 δ m 22 v m 11 δ m 11 u r d 22 δ d 22 v τ δ v m 33 δ m 33 r m 11 m 22 δ m 11 δ m 22 u v d 33 δ d 33 r τ r τ δ r where m i i i 1 2 3 and d i i i 1 2 3 denote ship inertia including added mass and the hydrodynamic damping in surge sway and yaw δ m i i i 1 2 3 and δ d i i i 1 2 3 represent parametric perturbations the available controls are surge control force τ u and the yaw control moment τ r and τ δ u τ δ v τ δ r are external disturbances in surge sway and yaw directions the dynamics 2 can be further rearranged as follows 3 u f u u v r τ u m 11 d u u v r m 11 v f v u v r d v u v r m 22 r f r u v r τ r m 33 d r u v r m 33 where 4 f u u v r m 22 m 11 v r d 11 m 11 u f v u v r m 11 m 22 u r d 22 m 22 v f r u v r m 11 m 22 m 33 u v d 33 m 33 r and d u d v d r are treated as lumped unknowns including both unmodeled dynamics uncertainties and disturbances and are given by 5 d u u v r δ m 11 u δ m 22 v r δ d 11 u τ δ u d v u v r δ m 22 v δ m 11 u r δ d 22 v τ δ v d r u v r δ m 33 r δ m 11 δ m 22 u v δ d 33 r τ δ r remark 1 it should be noted that lumped unknowns d u d v and d r are essentially associated with usv dynamics parametric uncertainties and disturbances apparently the foregoing unknowns can impossibly be approximated accurately by any nonlinear mapping since both internal derivatives and external disturbances exist 2 2 path following error dynamics in fig 1 a reference curve path that is parameterized by a time dependent variable ϖ t the path tangent reference frame ptrf at the point x p ϖ y p ϖ is rotated with ϕ p relative to the inertial coordinate system given by 6 ϕ p atan 2 y p ϖ x p ϖ where x p ϖ x p ϖ and y p ϖ y p ϖ the path following errors between x y and x p y p expressed in the ptrf frame are as follows 7 x e y e cos ϕ p sin ϕ p sin ϕ p cos ϕ p t x x p y y p where x e and y e are referred to the cross and along track errors respectively accordingly tracking error dynamics can be obtained 8 x e u cos ψ ϕ p v sin ψ ϕ p ϕ p y e u t a r y e u sin ψ ϕ p v cos ψ ϕ p ϕ p x e where u tar is the total speed of the virtual target as follows 9 u tar ϖ x p 2 ϖ y p 2 ϖ by defining the sideslip angle as follows 10 β a t a n 2 v u yields tracking error dynamics given by 11 x e u cos ψ ϕ p u sin ψ ϕ p tan β ϕ p y e u t a r y e u sin ψ ϕ p u cos ψ ϕ p tan β ϕ p x e where sideslip angle is the actually unknown 3 surge guided los sglos guidance as shown in fig 2 a surge guided line of sight sglos guidance scheme consisting of surge heading and virtual target guidance laws is designed in guidance system within the sglos scheme the surge guidance law is designed as follows 12 u d k 1 y e 2 δ 2 where k 1 0 and δ 0 is the lookahead distance in this context the minimum value of the guided surge velocity can be obtained 13 u d min k 1 δ the heading guidance law is governed by 14 ψ d ϕ p β d arctan y e δ where 15 β d arctan v u d in addition the virtual target guidance law is chosen as follows 16 u t a r k 2 x e u d cos ψ ϕ p β d where k 2 0 and u d u d 2 v 2 remark 2 an sglos guidance scheme is proposed in 12 and enables the surge speed can be flexibly guided by path following error and thereby enhancing the entire tracking performance more importantly the sglos scheme can effectively avoid computational complexity and singularity in previous guidance laws fossen et al 2003 breivik and fossen pettersen and lefeber 2001 fossen and pettersen 2014 brhaug et al 2008 caharija and pettersen 2016 fossen et al 2015 moe et al 2016 the key result on the sglos scheme is collected as follows theorem 1 applying the sglos guidance scheme 12 16 to the path following system 11 path following errors are globally asymptotically stable proof substituting the heading guidance law in 14 into the following formula can be obtained as follows 17 sin ψ d ϕ p sin β d arctan y e δ sin β d δ y e 2 δ 2 cos β d y e y e 2 δ 2 sin β d δ cos β d y e y e 2 δ 2 cos ψ d ϕ p cos β d arctan y e δ cos β d δ y e 2 δ 2 sin β d y e y e 2 δ 2 cos β d δ sin β d y e y e 2 δ 2 together with the sglos guidance scheme 12 16 and path following system error dynamics 11 we have 18 x e k 2 x e ϕ p y e y e u sin β d δ cos β d y e y e 2 δ 2 ϕ p x e u cos β d δ sin β d y e y e 2 δ 2 tan β k 1 sin β d δ cos β d y e ϕ p x e k 1 cos β d δ sin β d y e tan β k 1 cos β d y e ϕ p x e consider the lyapunov function as follows 19 v 1 1 2 x e 2 y e 2 differentiating v 1 along 18 yields 20 v 1 x e k 2 x e ϕ p y e y e k 1 cos β d y e ϕ p x e k 1 cos β d y e 2 k 2 x e 2 note u d u d m i n 0 and β d p i 2 p i 2 we further have 21 v 1 k 1 y e 2 k 2 x e 2 k v 1 where k 2 min k 1 k 2 this concludes the proof 4 controller design 4 1 fuzzy logic system a fuzzy logic system fls can be described as follows 22 r j if x 1 is f 1 j x 2 is f 2 j and x n is f n j then y 1 is θ 1 j y 2 is θ 2 j and y m is θ m j where x x 1 x 2 x n t r n and y y 1 y 2 y m t r m are input and output variables respectively f i j i 1 2 n j 1 2 n denotes the fuzzy set in the i th dimension within the j th fuzzy rule and θ k j k 1 2 m j 1 2 n denotes the fuzzy singleton the overall output of the fls is formulated as follows 23 y k θ k t ξ x k 1 2 m where θ k θ k 1 θ k 2 θ k n t and ξ x ξ 1 x ξ 2 x ξ n x t is fuzzy basis function vector defined by 24 ξ j x i 1 n μ f i j x i j 1 n i 1 n μ f i j x i j 1 2 n where μ f i j x i is the membership function of fuzzy set f i j and is usually defined by gaussian function by the universal approximation capability of the fls the unknown uncertainties d u d r can be completely described as follows 25 d u θ u t ξ u ε u d r θ r t ξ r ε r where θ u θ r are optimal weight parameters and ε u ε r is the ideal approximation error which is bounded i e 26 ε u ε u ε r ε r with an upper bound ε u ε r 0 4 2 surge control surge control τ u is designed as follows 27 τ u m 11 k u u e f u u v r u d d ˆ u ε ˆ u sgn u e where k u 0 u e u u d is the surge tracking error and d ˆ u is the output of fuzzy unknown observer fuo in surge designed as follows 28 d ˆ u θ ˆ u t ξ u ν where ξ u is predefined fuzzy basis function ν u v r t is the velocity vector of the usv and θ ˆ u and ε ˆ u are estimates of weight parameters and the approximation error respectively with adaptive laws governed by 29 θ ˆ u γ θ u m 11 u e σ u ξ u ε ˆ u γ ε u m 11 u e σ u where γ θ u γ ε u 0 and the uncertainty observation error σ u is defined as follows 30 σ u u e ρ u with auxiliary observation dynamics as follows 31 ρ u k ρ u ρ u f u u v r τ u m 11 d ˆ u m 11 u d k ρ u u e ε ˆ u sgn σ u m 11 where k ρ u 0 theorem 2 applying the robust surge control law in 27 and the parameter adaptive laws in 29 with the fuo 28 the guided surge speed u d in 12 can be globally asymptotically tracked proof consider the following lyapunov function 32 v 2 1 2 u e 2 γ θ u 1 θ u t θ u γ ε u 1 ε u 2 σ u 2 where θ u θ u θ ˆ u and ε u ε u ε ˆ u are the corresponding adaptive estimation errors differentiating v 2 along surge dynamics in 3 yields 33 v 2 u e u e γ θ u 1 θ u t θ ˆ u γ ε u 1 ε u ε ˆ u σ u σ u u e f u u v r τ u m 11 d u m 11 u d γ θ u 1 θ u t θ ˆ u γ ε u 1 ε u ε ˆ u σ u k ρ u σ u d u m 11 d ˆ u ε ˆ u sgn σ u m 11 substituting the robust surge control law in 27 and the parameter adaptive laws in 29 into 33 gives 34 v 2 u e k u u e θ u t ξ u ε u ε ˆ u sgn u e m 11 γ θ u 1 θ u t θ ˆ u γ ε u 1 ε u ε ˆ u σ u k ρ u σ u θ u t ξ u m 11 ε u ε ˆ u sgn σ u m 11 k u u e 2 k ρ u σ u 2 θ u t 1 m 11 u e σ u ξ u γ θ u 1 θ ˆ u ε u 1 m 11 u e σ u γ ε u 1 ε ˆ u k u u e 2 k ρ u σ u 2 which implies that u e θ u ε u σ u are all bounded by straightforward derivation and using barbalats lemma we can conclude that u e and σ u are globally asymptotically stable this concludes the proof 4 3 heading control yaw torque τ r is designed as follows 35 τ r m 33 f r u v r k r r e ψ e r d d ˆ r ε ˆ r sgn r e where k r 0 ψ e ψ ψ d is the heading tracking error r e r r d is the yaw tracking error and r d is a virtual signal governed by 36 r d k ψ ψ e ψ d with k ψ 0 and d ˆ r is the fuo in yaw dynamics designed as follows 37 d ˆ r θ ˆ r t ξ r ν where ξ r is predefined fuzzy basis function θ ˆ r and ε ˆ r are estimates of weight parameters and approximation error and are governed by 38 θ ˆ r γ θ r m 33 r e σ r ξ r ε ˆ r γ ε r m 33 r e σ r where γ θ r γ ε r 0 and σ r is the uncertainty observation error devised as 39 σ r r e ρ r with auxiliary observation dynamics as follows 40 ρ r k ρ r ρ r f r u v r τ r m 33 d ˆ r m 33 r d k ρ r r e ε ˆ r sgn σ r m 33 where k ρ r 0 the key result on surge and heading tracking is summarized as follows theorem 3 consider heading control law in 35 and the parameter adaptive laws in 38 with the fuo 37 the heading tracking error and uncertainty observation error are globally asymptotically stable proof consider the following lyapunov function 41 v 3 1 2 ψ e 2 r e 2 γ θ r 1 θ r t θ r γ ε r 1 ε r 2 σ r 2 differentiating v 3 along surge dynamics in 3 yields 42 v 3 ψ e ψ e r e r e γ θ r 1 θ r t θ ˆ r γ ε r 1 ε r ε ˆ r σ r σ r ψ e r e r d ψ d r e f r u v r τ r m 33 d r m 33 r d γ θ r 1 θ r t θ ˆ r γ ε r 1 ε r ε ˆ r σ r k ρ r σ r d r d ˆ r ε ˆ r sgn σ r m 33 substituting the robust heading control law in 35 and the parameter adaptive laws in 38 into 42 gives 43 v 3 k ψ ψ e 2 r e k r r e θ r t ξ r ε r ε ˆ r sgn r e m 33 γ θ r 1 θ r t θ ˆ r γ ε r 1 ε r ε ˆ r σ r k ρ r σ r θ r t ξ r m 33 ε r ε ˆ r sgn σ r m 33 k ψ ψ e 2 k r r e 2 k ρ r σ r 2 θ r t 1 m 33 r e σ r ξ r γ θ r 1 θ ˆ r ε r 1 m 33 r e σ r γ ε r 1 ε ˆ ˆ r k ψ ψ e 2 k r r e 2 k ρ r σ r 2 which implies that ψ e r e θ r ε r σ r are all bounded by straightforward derivation and using barbalats lemma khalil we can conclude that ψ e r e and σ r are globally asymptotically stable this concludes the proof 4 4 sway dynamics the sway dynamics can be rearranged into the following form 44 m 22 v m 11 u r d 22 v d v the complex unknowns d v is bounded in practice i e d v d v moreover from theorems 2 and 3 surge and yaw speeds u and r are made bounded in this context we have 45 v d 22 m 22 v d v where d 22 is actually positive for an usv fossen 1994 and d v m 11 u r d v m 22 using bellman gronwall comparison principle khalil we have 46 v t v t 0 e d 22 m 22 t t 0 d v m 22 d 22 1 e d 22 m 22 t t 0 v t 0 d v m 22 d 22 t 0 t from the above analysis the sway velocity v is bounded 5 simulation studies in order to verify the proposed fuo rapfc scheme we conduct simulation studies and comparisons on the benchmark usv cybership i ghommam et al 2007 inertia parameters of cybership i are as follows m 11 19 kg m 22 35 2 kg m 33 4 2 kg d 11 4 kg s d 22 1 kg s d 33 10 kg s in order to facilitate simulation settings parametric uncertainties and disturbances are assumed as follows δ m 11 0 1 m 11 sin 0 7 t δ m 22 0 1 m 22 cos 0 7 t δ m 33 0 1 m 33 sin 0 7 t δ d 11 0 1 d 11 cos 0 7 t δ d 22 0 1 d 22 sin 0 7 t δ d 33 0 1 d 33 sin 0 7 t τ δ u 2 4 sin t π 3 τ δ v 2 2 sin t π 6 and τ δ r 0 4 sin t π 3 the initial kinematics and dynamics of the usv are as follows x y ψ 10 0 0 and u v r 0 0 0 the desired path is defined as a curve governed by 47 x p ϖ 10 sin 0 1 ϖ ϖ y p ϖ ϖ where ϖ t is the time dependent path variable determined by 48 ϖ u tar x p 2 ϖ y p 2 ϖ where u tar is the virtual target guidance law in 16 in addition the guidance signals of surge heading and target point are designed as follows 49 u d k 1 y e 2 δ 2 ψ d ϕ p β d arctan y e δ u t a r k 2 x e u d cos ψ ϕ p β d with parameters k 1 1 k 2 1 and the lookahead distance δ 1 2 the design parameters of the fuo rapfc scheme are chosen as follows k u 0 25 k ψ 0 65 k r 0 25 k ρ u 3 k ρ v 1 8 k ρ r 8 γ θ u 2 10 3 γ θ v 5 10 4 γ θ r 3 10 3 γ ε u 0 03 γ ε v 0 03 and γ ε r 0 03 the actual and reference paths are shown in fig 3 in comparison with the rapfc scheme without the fuo the proposed fuo rapfc scheme can achieve significantly remarkable performance and much stronger uncertainty rejection simultaneously from fig 4 it can be observed path following errors within the fuo rapfc scheme can converge smoothly to zero while the cross track error without uncertainty observation cannot converge to zero under complex multiple unknowns figs 5 and 6 show the remarkable path following performance of the proposed fuo rapfc scheme with multiple uncertainties whereby the actual signals can track corresponding references by contrast the rapfc cannot achieve accurate tracking subject to multiple unknowns in addition uncertainty observation errors can converge to zero with fast convergence and thereby contributing to precise uncertainty observation as shown in fig 7 the remarkable performance of the proposed fuo rapfc scheme on exact path following relies on the accurate observation on the lumped unknowns via a fuo in fig 8 a numerical table of estimated errors is shown in table 1 among that d u d u d ˆ u d v d v d ˆ v d r d r d ˆ r respectively represent estimation errors in surge sway and yaw dimensions the control input in surge and yaw of the usv are shown in fig 9 in summary the overall fuo rapfc scheme can achieve exact path following together with accurate uncertainty observation in presence of multiple unknowns including the internal parametric perturbations external environmental disturbances and unmodelled dynamics 6 conclusion in this paper accurate path following problem of a usv with multiple unknowns has been solved by devising an fuo rapfc scheme multiple unknowns have been exactly estimated by the proposed fuo in addition the proposed sglos law has achieved simultaneous surge and heading guidance and thereby not only enhancing path following performance but also avoiding possible singularity and computational complexity of the projection point selection involved in traditional los methods combining backstepping technique with the fuo approach robust adaptive tracking controllers have been developed to render the overall closed loop tracking error dynamics globally asymptotically stable and thereby contributing to the entire fuo rapfc scheme that can achieve accurate path following of a usv with multiple unknowns acknowledgments the authors would like to thank the editor in chief the associate editor and anonymous referees for their invaluable comments and suggestions 
22934,in this paper suffering from multiple unknowns including unmodeled dynamics uncertainties and disturbances a fuzzy unknown observer based robust adaptive path following control fuo rapfc scheme for an underactuated surface vehicle usv is proposed main contributions are as follows 1 a surge guided line of sight sglos guidance law is created to guide surge speed and heading angle simultaneously and thereby adapting to path following errors to enhance robustness and flexibility 2 by virtue of combining auxiliary observation dynamics with adaptive approximation error compensation the fuo is innovatively devised to accurately lumped unknowns rather than bounded observations 3 fuo based robust adaptive tracking control laws are eventually synthesized and ensure that the guided signals can be globally asymptotically tracked simulation studies are conducted to demonstrate remarkable performance of the fuo rapfc scheme keywords surge guided line of sight guidance path following control underactuated surface vehicle fuzzy unknown observer 1 introduction the application of underactuated surface vehicles usvs becomes more and more prevalent due to its flexibility and versatility in both maritime civilian and military wynn and huvenne 2014 xu and xiao 2007 xiang et al 2016 wang et al 2018a 2018b accordingly motion control of usvs has been being within a research hotspot allotta et al 2016 mai et al 2017 zhao et al 2016 in the literature among most of scenarios including stabilization trajectory tracking and path following it is of practical importance to follow a predefined path without time constraint and thereby resulting that path following control pfc takes a critical part in various high risk unmanned maritime tasks the overall pfc scheme of a usv usually includes guidance module and control module fossen 1994 fossen et al 2003 breivik and fossen whereby the former is utilized to generate guidance signals which may include attitudes and or velocities and the later is required to follow previous guided references the former guidance module works at guiding attitudes and or velocities the line of sight los guidance method has been prevalently used for path following of a usv whereby an los projection algorithm was deployed to follow a segmented path actually connected by waypoints fossen et al 2003 the proportional line of sight plos guidance approach was proposed in pettersen and lefeber 2001 and fossen and pettersen 2014 where the guided heading angle was derived from the arctangent value associated with cross track error and lookahead distance however the sideslip angle i e the discrepancy between the heading and the course angles which may be caused by multiple unknowns and or maneuvers has not been addressed in previous works in brhaug et al 2008 and caharija and pettersen 2016 taking sideslip angle as a slow time varying unknown term the integral line of sight ilos guidance was proposed to compensate the unknown sideslip the adaptive los alos guidance method was proposed in fossen et al 2015 whereby unknown sideslip was estimated by an adaptive term the guidance approach for curved paths was developed in moe et al 2016 it should be noted that the previous guidance laws proposed in fossen et al 2003 breivik and fossen pettersen and lefeber 2001 fossen and pettersen 2014 brhaug et al 2008 caharija and pettersen 2016 fossen et al 2015 moe et al 2016 inevitably suffer from the singularity problem in the selection of projection points nevertheless surge velocity is roughly treated as a user defined parameter and is usually predefined as a constant in this context the usv is actually controlled only by the rudder torque and thereby not only cutting down the overall manipulability but also increasing maneuvering burden on the rudder the control module within the path following scheme is desired to render the usv track the guided signals as accurately as possible in this context nonlinear tracking controllers can be directly derived from backstepping like techniques wang et al 2017a 2017b zhou et al 2017a li et al 2017 in li et al 2008 the adaptive controllers were designed to solve waypoint tracking problem of a usv whereby all tracking error signals within the closed loop system were rendered to be uniformly ultimately bounded in miao et al 2017 the auto disturbances rejection control adrc approach was deployed to achieve pfc of a uuv recently an adaptive robust finite time tracking control schemes using non smooth and homogeneity tools for trajectory tracking of a marine surface vehicle with unknown disturbances have been proposed in wang et al 2016a liu et al 2017 a singular perturbation control strategy has been developed in yi et al 2016 in order to handle complex unknowns finite time observer based motion control schemes for marine vehicles have been addressed in wang et al 2017d note that intelligent approaches have been extensively applied to various industrial areas wang et al 2018d 2019 fuzzy systems wang et al 2017e 2018e artificial neural networks wang et al 2015a and fuzzy neural networks wang and er 2015 etc have been intensively explored within trajectory tracking control of marine surface vehicles in wang et al 2017f an adaptive universe based fuzzy control scheme with retractable fuzzy partitioning in global universe of discourse has been created to achieve global asymptotic model free trajectory independent tracking however comparing to tracking control approaches of fully actuated marine vehicles complex unknowns pertaining to underactuated marine vehicles are still hardly be tackled sufficiently due to underactuation appearing in sway dynamics in this paper motivated by above observations a fuzzy unknown observer based robust adaptive path following control fuo rapfc scheme is created to achieve accurate path following of a usv with multiple unknowns including internal unmodeled dynamics e g parametric unknowns uncertainties and external disturbances simultaneously which have not been addressed in previous works stemming from line of sight los approach a surge guided los sglos guidance law is devised and ensures that the reference surge speed can be autonomously guided with respect to path following errors to be more interesting by designing auxiliary observation dynamics the fuo is innovatively devised to accurately estimate multiple unknowns and thereby contributing to robust adaptive tracking controllers which guarantee that guided signals can be accurately tracked the rest is organized as follows section 2 states problem formulation the sglos guidance law and the fuo based robust adaptive tracking controllers are presented in sections 3 and 4 respectively simulation studies are conducted in section 5 section 6 concludes this paper 2 problem formulation 2 1 usv kinematics and dynamics the kinematics of a usv are as follows fossen 1 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r where x y ψ are planar position and heading orientation of the usv in the earth fixed frame and u v r are surge sway and yaw velocities within the body fixed frame respectively suffering from the internal unmodelled dynamics parametric perturbations and external environmental disturbances the dynamics of a usv can be formulated as follows 2 m 11 δ m 11 u m 22 δ m 22 v r d 11 δ d 11 u τ u τ δ u m 22 δ m 22 v m 11 δ m 11 u r d 22 δ d 22 v τ δ v m 33 δ m 33 r m 11 m 22 δ m 11 δ m 22 u v d 33 δ d 33 r τ r τ δ r where m i i i 1 2 3 and d i i i 1 2 3 denote ship inertia including added mass and the hydrodynamic damping in surge sway and yaw δ m i i i 1 2 3 and δ d i i i 1 2 3 represent parametric perturbations the available controls are surge control force τ u and the yaw control moment τ r and τ δ u τ δ v τ δ r are external disturbances in surge sway and yaw directions the dynamics 2 can be further rearranged as follows 3 u f u u v r τ u m 11 d u u v r m 11 v f v u v r d v u v r m 22 r f r u v r τ r m 33 d r u v r m 33 where 4 f u u v r m 22 m 11 v r d 11 m 11 u f v u v r m 11 m 22 u r d 22 m 22 v f r u v r m 11 m 22 m 33 u v d 33 m 33 r and d u d v d r are treated as lumped unknowns including both unmodeled dynamics uncertainties and disturbances and are given by 5 d u u v r δ m 11 u δ m 22 v r δ d 11 u τ δ u d v u v r δ m 22 v δ m 11 u r δ d 22 v τ δ v d r u v r δ m 33 r δ m 11 δ m 22 u v δ d 33 r τ δ r remark 1 it should be noted that lumped unknowns d u d v and d r are essentially associated with usv dynamics parametric uncertainties and disturbances apparently the foregoing unknowns can impossibly be approximated accurately by any nonlinear mapping since both internal derivatives and external disturbances exist 2 2 path following error dynamics in fig 1 a reference curve path that is parameterized by a time dependent variable ϖ t the path tangent reference frame ptrf at the point x p ϖ y p ϖ is rotated with ϕ p relative to the inertial coordinate system given by 6 ϕ p atan 2 y p ϖ x p ϖ where x p ϖ x p ϖ and y p ϖ y p ϖ the path following errors between x y and x p y p expressed in the ptrf frame are as follows 7 x e y e cos ϕ p sin ϕ p sin ϕ p cos ϕ p t x x p y y p where x e and y e are referred to the cross and along track errors respectively accordingly tracking error dynamics can be obtained 8 x e u cos ψ ϕ p v sin ψ ϕ p ϕ p y e u t a r y e u sin ψ ϕ p v cos ψ ϕ p ϕ p x e where u tar is the total speed of the virtual target as follows 9 u tar ϖ x p 2 ϖ y p 2 ϖ by defining the sideslip angle as follows 10 β a t a n 2 v u yields tracking error dynamics given by 11 x e u cos ψ ϕ p u sin ψ ϕ p tan β ϕ p y e u t a r y e u sin ψ ϕ p u cos ψ ϕ p tan β ϕ p x e where sideslip angle is the actually unknown 3 surge guided los sglos guidance as shown in fig 2 a surge guided line of sight sglos guidance scheme consisting of surge heading and virtual target guidance laws is designed in guidance system within the sglos scheme the surge guidance law is designed as follows 12 u d k 1 y e 2 δ 2 where k 1 0 and δ 0 is the lookahead distance in this context the minimum value of the guided surge velocity can be obtained 13 u d min k 1 δ the heading guidance law is governed by 14 ψ d ϕ p β d arctan y e δ where 15 β d arctan v u d in addition the virtual target guidance law is chosen as follows 16 u t a r k 2 x e u d cos ψ ϕ p β d where k 2 0 and u d u d 2 v 2 remark 2 an sglos guidance scheme is proposed in 12 and enables the surge speed can be flexibly guided by path following error and thereby enhancing the entire tracking performance more importantly the sglos scheme can effectively avoid computational complexity and singularity in previous guidance laws fossen et al 2003 breivik and fossen pettersen and lefeber 2001 fossen and pettersen 2014 brhaug et al 2008 caharija and pettersen 2016 fossen et al 2015 moe et al 2016 the key result on the sglos scheme is collected as follows theorem 1 applying the sglos guidance scheme 12 16 to the path following system 11 path following errors are globally asymptotically stable proof substituting the heading guidance law in 14 into the following formula can be obtained as follows 17 sin ψ d ϕ p sin β d arctan y e δ sin β d δ y e 2 δ 2 cos β d y e y e 2 δ 2 sin β d δ cos β d y e y e 2 δ 2 cos ψ d ϕ p cos β d arctan y e δ cos β d δ y e 2 δ 2 sin β d y e y e 2 δ 2 cos β d δ sin β d y e y e 2 δ 2 together with the sglos guidance scheme 12 16 and path following system error dynamics 11 we have 18 x e k 2 x e ϕ p y e y e u sin β d δ cos β d y e y e 2 δ 2 ϕ p x e u cos β d δ sin β d y e y e 2 δ 2 tan β k 1 sin β d δ cos β d y e ϕ p x e k 1 cos β d δ sin β d y e tan β k 1 cos β d y e ϕ p x e consider the lyapunov function as follows 19 v 1 1 2 x e 2 y e 2 differentiating v 1 along 18 yields 20 v 1 x e k 2 x e ϕ p y e y e k 1 cos β d y e ϕ p x e k 1 cos β d y e 2 k 2 x e 2 note u d u d m i n 0 and β d p i 2 p i 2 we further have 21 v 1 k 1 y e 2 k 2 x e 2 k v 1 where k 2 min k 1 k 2 this concludes the proof 4 controller design 4 1 fuzzy logic system a fuzzy logic system fls can be described as follows 22 r j if x 1 is f 1 j x 2 is f 2 j and x n is f n j then y 1 is θ 1 j y 2 is θ 2 j and y m is θ m j where x x 1 x 2 x n t r n and y y 1 y 2 y m t r m are input and output variables respectively f i j i 1 2 n j 1 2 n denotes the fuzzy set in the i th dimension within the j th fuzzy rule and θ k j k 1 2 m j 1 2 n denotes the fuzzy singleton the overall output of the fls is formulated as follows 23 y k θ k t ξ x k 1 2 m where θ k θ k 1 θ k 2 θ k n t and ξ x ξ 1 x ξ 2 x ξ n x t is fuzzy basis function vector defined by 24 ξ j x i 1 n μ f i j x i j 1 n i 1 n μ f i j x i j 1 2 n where μ f i j x i is the membership function of fuzzy set f i j and is usually defined by gaussian function by the universal approximation capability of the fls the unknown uncertainties d u d r can be completely described as follows 25 d u θ u t ξ u ε u d r θ r t ξ r ε r where θ u θ r are optimal weight parameters and ε u ε r is the ideal approximation error which is bounded i e 26 ε u ε u ε r ε r with an upper bound ε u ε r 0 4 2 surge control surge control τ u is designed as follows 27 τ u m 11 k u u e f u u v r u d d ˆ u ε ˆ u sgn u e where k u 0 u e u u d is the surge tracking error and d ˆ u is the output of fuzzy unknown observer fuo in surge designed as follows 28 d ˆ u θ ˆ u t ξ u ν where ξ u is predefined fuzzy basis function ν u v r t is the velocity vector of the usv and θ ˆ u and ε ˆ u are estimates of weight parameters and the approximation error respectively with adaptive laws governed by 29 θ ˆ u γ θ u m 11 u e σ u ξ u ε ˆ u γ ε u m 11 u e σ u where γ θ u γ ε u 0 and the uncertainty observation error σ u is defined as follows 30 σ u u e ρ u with auxiliary observation dynamics as follows 31 ρ u k ρ u ρ u f u u v r τ u m 11 d ˆ u m 11 u d k ρ u u e ε ˆ u sgn σ u m 11 where k ρ u 0 theorem 2 applying the robust surge control law in 27 and the parameter adaptive laws in 29 with the fuo 28 the guided surge speed u d in 12 can be globally asymptotically tracked proof consider the following lyapunov function 32 v 2 1 2 u e 2 γ θ u 1 θ u t θ u γ ε u 1 ε u 2 σ u 2 where θ u θ u θ ˆ u and ε u ε u ε ˆ u are the corresponding adaptive estimation errors differentiating v 2 along surge dynamics in 3 yields 33 v 2 u e u e γ θ u 1 θ u t θ ˆ u γ ε u 1 ε u ε ˆ u σ u σ u u e f u u v r τ u m 11 d u m 11 u d γ θ u 1 θ u t θ ˆ u γ ε u 1 ε u ε ˆ u σ u k ρ u σ u d u m 11 d ˆ u ε ˆ u sgn σ u m 11 substituting the robust surge control law in 27 and the parameter adaptive laws in 29 into 33 gives 34 v 2 u e k u u e θ u t ξ u ε u ε ˆ u sgn u e m 11 γ θ u 1 θ u t θ ˆ u γ ε u 1 ε u ε ˆ u σ u k ρ u σ u θ u t ξ u m 11 ε u ε ˆ u sgn σ u m 11 k u u e 2 k ρ u σ u 2 θ u t 1 m 11 u e σ u ξ u γ θ u 1 θ ˆ u ε u 1 m 11 u e σ u γ ε u 1 ε ˆ u k u u e 2 k ρ u σ u 2 which implies that u e θ u ε u σ u are all bounded by straightforward derivation and using barbalats lemma we can conclude that u e and σ u are globally asymptotically stable this concludes the proof 4 3 heading control yaw torque τ r is designed as follows 35 τ r m 33 f r u v r k r r e ψ e r d d ˆ r ε ˆ r sgn r e where k r 0 ψ e ψ ψ d is the heading tracking error r e r r d is the yaw tracking error and r d is a virtual signal governed by 36 r d k ψ ψ e ψ d with k ψ 0 and d ˆ r is the fuo in yaw dynamics designed as follows 37 d ˆ r θ ˆ r t ξ r ν where ξ r is predefined fuzzy basis function θ ˆ r and ε ˆ r are estimates of weight parameters and approximation error and are governed by 38 θ ˆ r γ θ r m 33 r e σ r ξ r ε ˆ r γ ε r m 33 r e σ r where γ θ r γ ε r 0 and σ r is the uncertainty observation error devised as 39 σ r r e ρ r with auxiliary observation dynamics as follows 40 ρ r k ρ r ρ r f r u v r τ r m 33 d ˆ r m 33 r d k ρ r r e ε ˆ r sgn σ r m 33 where k ρ r 0 the key result on surge and heading tracking is summarized as follows theorem 3 consider heading control law in 35 and the parameter adaptive laws in 38 with the fuo 37 the heading tracking error and uncertainty observation error are globally asymptotically stable proof consider the following lyapunov function 41 v 3 1 2 ψ e 2 r e 2 γ θ r 1 θ r t θ r γ ε r 1 ε r 2 σ r 2 differentiating v 3 along surge dynamics in 3 yields 42 v 3 ψ e ψ e r e r e γ θ r 1 θ r t θ ˆ r γ ε r 1 ε r ε ˆ r σ r σ r ψ e r e r d ψ d r e f r u v r τ r m 33 d r m 33 r d γ θ r 1 θ r t θ ˆ r γ ε r 1 ε r ε ˆ r σ r k ρ r σ r d r d ˆ r ε ˆ r sgn σ r m 33 substituting the robust heading control law in 35 and the parameter adaptive laws in 38 into 42 gives 43 v 3 k ψ ψ e 2 r e k r r e θ r t ξ r ε r ε ˆ r sgn r e m 33 γ θ r 1 θ r t θ ˆ r γ ε r 1 ε r ε ˆ r σ r k ρ r σ r θ r t ξ r m 33 ε r ε ˆ r sgn σ r m 33 k ψ ψ e 2 k r r e 2 k ρ r σ r 2 θ r t 1 m 33 r e σ r ξ r γ θ r 1 θ ˆ r ε r 1 m 33 r e σ r γ ε r 1 ε ˆ ˆ r k ψ ψ e 2 k r r e 2 k ρ r σ r 2 which implies that ψ e r e θ r ε r σ r are all bounded by straightforward derivation and using barbalats lemma khalil we can conclude that ψ e r e and σ r are globally asymptotically stable this concludes the proof 4 4 sway dynamics the sway dynamics can be rearranged into the following form 44 m 22 v m 11 u r d 22 v d v the complex unknowns d v is bounded in practice i e d v d v moreover from theorems 2 and 3 surge and yaw speeds u and r are made bounded in this context we have 45 v d 22 m 22 v d v where d 22 is actually positive for an usv fossen 1994 and d v m 11 u r d v m 22 using bellman gronwall comparison principle khalil we have 46 v t v t 0 e d 22 m 22 t t 0 d v m 22 d 22 1 e d 22 m 22 t t 0 v t 0 d v m 22 d 22 t 0 t from the above analysis the sway velocity v is bounded 5 simulation studies in order to verify the proposed fuo rapfc scheme we conduct simulation studies and comparisons on the benchmark usv cybership i ghommam et al 2007 inertia parameters of cybership i are as follows m 11 19 kg m 22 35 2 kg m 33 4 2 kg d 11 4 kg s d 22 1 kg s d 33 10 kg s in order to facilitate simulation settings parametric uncertainties and disturbances are assumed as follows δ m 11 0 1 m 11 sin 0 7 t δ m 22 0 1 m 22 cos 0 7 t δ m 33 0 1 m 33 sin 0 7 t δ d 11 0 1 d 11 cos 0 7 t δ d 22 0 1 d 22 sin 0 7 t δ d 33 0 1 d 33 sin 0 7 t τ δ u 2 4 sin t π 3 τ δ v 2 2 sin t π 6 and τ δ r 0 4 sin t π 3 the initial kinematics and dynamics of the usv are as follows x y ψ 10 0 0 and u v r 0 0 0 the desired path is defined as a curve governed by 47 x p ϖ 10 sin 0 1 ϖ ϖ y p ϖ ϖ where ϖ t is the time dependent path variable determined by 48 ϖ u tar x p 2 ϖ y p 2 ϖ where u tar is the virtual target guidance law in 16 in addition the guidance signals of surge heading and target point are designed as follows 49 u d k 1 y e 2 δ 2 ψ d ϕ p β d arctan y e δ u t a r k 2 x e u d cos ψ ϕ p β d with parameters k 1 1 k 2 1 and the lookahead distance δ 1 2 the design parameters of the fuo rapfc scheme are chosen as follows k u 0 25 k ψ 0 65 k r 0 25 k ρ u 3 k ρ v 1 8 k ρ r 8 γ θ u 2 10 3 γ θ v 5 10 4 γ θ r 3 10 3 γ ε u 0 03 γ ε v 0 03 and γ ε r 0 03 the actual and reference paths are shown in fig 3 in comparison with the rapfc scheme without the fuo the proposed fuo rapfc scheme can achieve significantly remarkable performance and much stronger uncertainty rejection simultaneously from fig 4 it can be observed path following errors within the fuo rapfc scheme can converge smoothly to zero while the cross track error without uncertainty observation cannot converge to zero under complex multiple unknowns figs 5 and 6 show the remarkable path following performance of the proposed fuo rapfc scheme with multiple uncertainties whereby the actual signals can track corresponding references by contrast the rapfc cannot achieve accurate tracking subject to multiple unknowns in addition uncertainty observation errors can converge to zero with fast convergence and thereby contributing to precise uncertainty observation as shown in fig 7 the remarkable performance of the proposed fuo rapfc scheme on exact path following relies on the accurate observation on the lumped unknowns via a fuo in fig 8 a numerical table of estimated errors is shown in table 1 among that d u d u d ˆ u d v d v d ˆ v d r d r d ˆ r respectively represent estimation errors in surge sway and yaw dimensions the control input in surge and yaw of the usv are shown in fig 9 in summary the overall fuo rapfc scheme can achieve exact path following together with accurate uncertainty observation in presence of multiple unknowns including the internal parametric perturbations external environmental disturbances and unmodelled dynamics 6 conclusion in this paper accurate path following problem of a usv with multiple unknowns has been solved by devising an fuo rapfc scheme multiple unknowns have been exactly estimated by the proposed fuo in addition the proposed sglos law has achieved simultaneous surge and heading guidance and thereby not only enhancing path following performance but also avoiding possible singularity and computational complexity of the projection point selection involved in traditional los methods combining backstepping technique with the fuo approach robust adaptive tracking controllers have been developed to render the overall closed loop tracking error dynamics globally asymptotically stable and thereby contributing to the entire fuo rapfc scheme that can achieve accurate path following of a usv with multiple unknowns acknowledgments the authors would like to thank the editor in chief the associate editor and anonymous referees for their invaluable comments and suggestions 
