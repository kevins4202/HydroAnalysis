index,text
23315,a point absorber wave energy converter is commonly used because its structure is simple and efficient this paper proposes a multi point absorber wave energy converter mpawec in which hydrostatic transmission is used to convert wave energy into electric energy with multi point absorbers and a high pressure accumulator the design offers advantages such as greater energy harvesting and stabilization of the output power a small scale test rig was fabricated for experiments all of the components of the mpawec were mathematically modeled and simulation results were compared with the experimental results the overall efficiency of the proposed system is 27 3 keywords hydrostatic transmission multi point absorber wave energy converter high pressure accumulator nomenclature a bh wet cross section of the buoy on a plane perpendicular to the direction of the wave m 2 a cvii cross section of the check valve cvi i a cvoi cross section of the check valve cvo i a pi piston area of the cylinder i th m 2 a v relief valve throttling area m 2 c d discharge coefficient c d drag coefficient in water d bore diameter of cylinder m d b diameter of floating buoy m d max maximum displacement of hydraulic motor cc rev f i random frequencies of wave component hz g gravitational acceleration m s2 h wave height m h b cylindrical height of the floating buoy m hpa high pressure accumulator lpa low pressure accumulator m b mass of the floating buoy kg m g mass of the gas in hpa kg m s mass of the moving shaft kg n adiabatic coefficient p g pressure of the gas in the accumulator p i pressure at the cylinder i th ports p l pressure in the low pressure line and the lpa p g0 gas pre charged pressure in the hpa pa p h pressure in the high pressure line pa r hemisphere radius of the floating buoy m s a f i spectral density of the represented sea states m2s t g temperature of the gas in hpa k v h volume of the hoses m3 v 0hpa initial volume of the hpa m3 y t displacement of the floating buoy m y t irregular wave displacement m z submerged level of the floating buoy m α m displacement ratio of hydraulic motor β bulk modulus of oil pa ω motor rotation speed rpm ω w wave angular frequency s 1 δf increment of wave frequency hz δp pressure difference between the two ports of the motor pa η c friction coefficient of cylinder η vm volumetric efficiency of hydraulic motor η tm mechanical efficiency of hydraulic motor ρ density of water kg m3 φ rand i random phases of wave component rad v wave velocity m s 1 introduction various concepts of wave energy converters wecs have been developed drew et al 2009 and there has been much research to maximize the absorbed power and improve their efficiency valério et al 2007 investigated the performance of several control strategies for an archimedes wave swing aws such as reactive control phase control amplitude control latching control and feedback linearization control feedback linearization control was the best method nielsen et al 2014 proposed an optimal control law for maximum absorbed mean power of an array of point absorber the law can be optimal for any 2d or 3d irregular sea state and during the transient phase numeral calculation using wamit software shows good result hardy et al 2016 presented a maximum capture width tracking mcwt latching controller for an oscillating water column owc and investigated the controller performance in irregular waves the simulation results showed that in stationary sea states both maximum power point tracking mppt and mcwt controllers can optimize a wec within the confidence bounds where the optimal capture width can be determined cargo et al 2016 presented a methodology for obtaining the optimum pto damping coefficient for a given sea state they used an open loop active tuning method to adjust the pto parameters to achieve optimum damping gaspar et al 2016 presented a generic pto concept that can be adapted to different types of wecs and can minimize undesirable hydraulic pressure losses and compressibility effects however the case study only used simulations to examine the point absorbers with only a one point absorber the pressure of the high pressure line fluctuates in a large range thus the output power is not stable few studies have focused on smoothing the output power in a combined wind and wave farm astariz and iglesias 2016 zhao et al 2016 some studies have looked at the smoothing effect and reducing power fluctuations in a wave array and wave farm molinas et al 2007 tissander et al 2008 babarit 2013 goteman et al 2014 the methods proposed include increasing the number of wec devices adjusting the spacing or positioning of the wec platform and using different buoy sizes in a wec park however the smoothing power using a pto system has not been studied sufficiently do et al 2015 proposed an adjustable slope angle wave energy converter asawec that is similar to the wavestar concept nambiar et al 2015 ransley et al 2017 they investigated the effect of the slope angle on the performance of the proposed wave energy converter to find the optimal slope angle the goal was to increase the power capture capability and energy efficiency to overcome the disadvantages of previous approaches this paper proposes a multi point absorber wave energy converter mpawec that uses a hydrostatic transmission and a high pressure accumulator hpa some previous research has applied an hpa to a hydraulic system falcão 2007 vicente et al 2013 but the problem of smoothing the output power was not considered the pressure coupling principle is used for the speed control method the objective is to stabilize and enhance the output power different configurations were investigated including single point absorber wecs without an hpa with an hpa and with a flywheel a multi point absorber with an hpa using the flow coupling principle and a multi point absorber with an hpa using the pressure coupling principle the main points of the proposed mpawec are as follows all sets of floating buoys and cylinders are placed equidistantly from neighboring ones based on the same phase difference on the propagation route in this way the fluid from each cylinder can compensate for the fluid in the others making the total flow into the accumulator nearly constant the hpa has two functions to smooth the fluid pressure supplied from the cylinders and to store energy when wave conditions are strong the wave power is greater than the rated power and the excess power is absorbed by the hpa when wave conditions are weak the wave power is less than the rated power and the hpa compensates for the deficit in power supplied to the hydraulic motor the driving speed of a generator can be controlled by using the pressure coupling principle of the hydrostatic transmission hence the amplitude of pressure fluctuations can be reduced and the driving speed of the generator can be maintained stably despite changes in the wave conditions the reference speed can be selected automatically based on the pressure of condition hpa the remainder of this paper is organized as follows section 2 describes the proposed mpawec and section 3 explains the mathematical model of the hydraulic system section 4 presents condition results of simulations and experiments and section 5 discusses the conclusions and future work 2 description of a multi point absorber wave energy converter a multi point absorber wave energy converter is used to reduce the fluctuation magnitude of the output power and utilize a common pressure rail connected to an hpa in the conceptual design multi point absorbers are placed in two arrays on the seabed a 3d conceptual design of the proposed mpawec is shown in fig 1 two arrays of floating buoys are fixed to the moving shaft one cylinder functions as a hydraulic pump and is attached to each shaft one end of the cylinder is joined to the moving shaft while the other is joined to the frame the frame and all of its attached components are supported by columns which are fixed to the sea bottom when a wave arrives the floating buoys and the moving shaft oscillate together along the tilt longitudinal direction the wave s force is divided into a vertical component and a horizontal component the resultant force has the same direction as the moving direction or differs from it by a small angle therefore friction between moving parts is reduced and more power is absorbed from the wave the piston of the cylinder moves up and down thereby generating high pressure fluid at the output port of the cylinder the sliding angle of a floating buoy can be adjusted by an actuator as shown in fig 2 do et al 2017 proposed a self adjustment method for the sliding angle the mpawec i test rig is used in a wave making tank which includes a wave making wall that is moved by hydraulic propulsion cylinders in a water tank a slope damping net is attached to the opposite side of the wave making wall to eliminate reflex waves and avoid unexpected noise the motion of the wave making wall and cylinders is set up and controlled by a computer and sensors to achieve an exact wave amplitude and frequency a diagram and the parameters of the wave making tank are shown in fig 3 mpawec i is a small scale test rig and the wave making tank can generate small waves for this rig the mpawec ii test rig was fabricated for stronger wave conditions the new wave conditions are simulated by the motion of a float motion simulator 2 the experiment system includes 4 blocks as shown in fig 4 the power supply block 1 supplies high pressure fluid to run the 5 lower cylinders of the floating buoy motion simulator 2 each of the cylinders is controlled separately motion of the cylinder is achieved by a wave float interaction model the 5 upper cylinders convert energy from the oscillating motion into high pressure fluid power the high pressure fluid is collected in a high pressure line via check valves one part of the high pressure flow is used to drive the hydraulic motor to run the generator of the generator block 3 the excess high pressure fluid is stored in the hpa the hpa smoothens the operating pressure and the driving speed of the hydraulic motor is stabilized in the generator block we employ a hydraulic pump and a proportional relief valve to simulate the load of the generator instead of a real generator the measured data and control signals to and from these 3 blocks are processed by a control system included the control panel 4 and a computer the hydraulic circuit and control system of the proposed mpawec are shown in fig 5 when the cylinder extends fluid from the low pressure accumulator lpa fills the full bore chamber of the cylinder when the cylinder is compressed the fluid in the chamber is pressurized and pumped to the hpa all the cylinders work with a similar principle the check valve system allows only low pressure fluid from the low pressure line into the cylinder and high pressure fluid from the cylinder into the high pressure line to charge the hpa high pressure fluid is used to drive the hydraulic motor to rotate the generator the relief valve rlv1 releases pressure in the hpa to protect the hydraulic circuit if the operating pressure becomes too high this research mainly focuses on the power take off concept of the wec system other approaches strongly focus on increasing the absorbed power without considering the smoothing of the output power the fluctuation of the output power may decrease the effectiveness of the whole wec since the generator only achieves the highest efficiency at its rated speed thus this paper examines the reduction of the fluctuation phenomena of incident wave power using the proposed method consequently the output power will be stable and more energy will be harvested and converted to electricity the interaction between wec devices is expressed by the q factor and has been the subject of extensive research evans 1982 mavrakos and mciver 1997 babarit 2013 de chowdhury and manasseh 2017 the previous studies show that the absorbed power of an array of wecs can be either less q 1 or greater q 1 than the power of the same number of isolated devices thus there are methods that can be applied to optimize the power extraction e g array configuration positioning and mooring this topic will be a focus of future work with a full scale real sea multi point wec test rig 3 mathematical modeling of the multi point absorber wave energy converter 3 1 wave model an irregular ocean wave can be represented as the superposition of single waves described by the pierson moskowitz spectrum alves et al 2003 as shown in fig 6 hansen et al 2011 1 s a f α g 2 2 π 4 f 5 exp 1 25 f m f 4 where f is the wave frequency in hertz f m v p m g u 19 5 is the dimensional peak frequency in hertz the scaled non dimensional peak frequency is v 19 5 p m 0 145 α 0 0081 is the empirically determined equilibrium range level or the phillips constant and u 19 5 is the wind speed at 19 4 m above the sea surface the irregular wave spectrum is represented by the significant wave height h s and the peak wave period t p an irregular wave can be generated as a sum of wave components hansen et al 2011 2 y t i 1 n 2 s a f i δ f sin 2 π f i t φ r a n d i where y t is the irregular wave displacement s a f i is the spectral density of the represented sea states δf is the increment of wave frequency and f i and φ rand i are the frequency and random phases of each component respectively 3 2 hydrodynamic model of a floating buoy the motion of a floating buoy can be described using the following equation 3 m b m s y t f w cos γ f p t o where m b and m s are the mass of the floating buoy and the mass of the moving shaft respectively y t is the displacement of the floating buoy f pto is the force to move the cylinder piston to make high pressure fluid f w is the resultant force of a wave on the floating buoy and γ is the difference between the optimal slope angle and the instantaneous slope angle as shown in fig 7 including the vertical component or the heave force f heav and the horizontal component or the surge force f surg 4 f w f h e a v f s u r g according to falnes 2002 the heave force exerted on the floating buoy can be represented as a superposition of three components the hydrostatic force the excitation force applied by an incoming regular wave to a fixed float and the radiation force experienced by an oscillating float which is the sum of the forces created by the motion of the other buoys floating on the water the heave force from the wave is defined as 5 f h e a v f b f e x f r f g where f b is the buoyancy force f ex is the excitation force and f r is the radiation force produced by an oscillating body creating waves on an otherwise calm sea f g is the gravity force the buoyancy force f b is calculated as 6 f b ρ g v s where ρ is the density of water g is gravitational acceleration and v s is the volume of the floating buoy that is below the water surface as shown in fig 8 and defined as 7 v s π 3 3 r z z 2 0 z r 2 π 3 r 3 π r 2 z r r z r h b the excitation force f ex is expressed as in cargo et al 2011 8 f e x ω f 3 ω y ˆ ω where f 3 is the excitation force coefficient falnes 2002 and y is the wave amplitude 9 f 3 k 3 ρ g π r 2 the coefficient k 3 depends on the wave frequency and varies from one to zero as the wave frequency increases from zero to infinity the coefficient k 3 can be obtained from falnes 2002 figure 5 7 page 135 by calculating the normalized wave frequency ω w db 4g ˆ 1 2 the radiation force is expressed as 10 f r ω m r ω y ˆ r r ω y ˆ where m r ω is the added mass and r r ω is the radiation damping coefficient these parameters can be calculated using wamit software the gravity force f g is calculated as 11 f g m b m s g the surge force from a wave is modeled in a similar way as the heave force as the sum of the excitation force and radiation force in the surge direction 12 f s u r f e x s u r f r s u r 3 3 model of hydraulic cylinder cylinders were employed as hydraulic pumps to convert the kinetic energy of a floating buoy into potential energy stored in the hpa the floating buoys are moved by waves and then fluid in the cylinders is pressurized x t is the x coordinate of the piston because the cylinder s rod is fixed to the floating buoy 13 x t y t considering the ith cylinder shown in fig 9 and referring to hansen et al 2011 the continuity equations of the bore chamber as the floating buoy moves up are 14 d p i d t β a p i l x i a p i x i q c v i i q c v o i a pi is the piston area in m 2 15 a p i π d 2 4 q cvii is the input flow rates from the lpa via check valves cvi i to the ith cylinder 16 q c v i i c d a c v i i 2 p l p i ρ i f p l p i 0 e l s e q cvoi is the output flow rates from the ith cylinder via check valves cvo i to the hpa 17 q c v o i c d a c v o i 2 p i p h ρ i f p i p h 0 e l s e i 1 2 5 for the 1st to 5th cylinders p i is the pressure at the cylinder ith port defined by eq 14 the cylinder force is calculated as 18 f p t o i δ p i a p i f f r i c where 19 δ p i p i p t p t is considered as the pressure in the lpa f fri is the friction of the cylinder defined as 20 f f r i c δ p i a p i 1 η c the cylinder friction f fric is defined such that the cylinder has a friction coefficient η c 3 4 modeling and calculation of the hpa we employed a bladder accumulator that is filled with nitrogen gas according to rabie 2009 the nitrogen gas is assumed to compress and expand based on the adiabatic gas law 21 p g v n p g 0 v 0 n p g max v min n the gas pressure in the hpa is expressed by the beattie bridgman equation 22 p g m g v 2 r a c t g 1 m g c v t g 3 v m g b 0 1 m g b a c v a 0 1 m g a a c v the gas volume can be estimated from the flow rate into the accumulator 23 v v 0 h p a 0 t q h p a d t 3 5 model of connecting line using the flow continuity equation the pressure in the high pressure line is expressed as 24 d p h d t β v h i 1 5 q c v o i q h p a q r q m where q cvoi represents the flow rates through check valve cvo i formulated in eq 17 q hpa is the flow rate into the hpa 25 q h p a v h p a 0 i f p h p 0 1 n v 0 1 p 0 p h 1 n n p 0 p h p h 2 e l s e q r is the flow rate through the relief valve rlv according to pinches and ashby 1988 q r can be expressed as 26 q r 0 i f δ p p s e t c d a v 2 δ p ρ i f δ p p s e t q m is the actual flow rate of the hydraulic motor as in eq 31 and δp is the pressure difference between the high pressure and low pressure lines which is considered to be the pressure in the lpa 27 δ p p h p l 3 6 model of the hydraulic motor the ideal flow rate of the piston hydraulic motor is defined as 28 q i α m d max ω m where ω m is the motor rotation speed the volumetric efficiency mechanical efficiency actual flow rate and actual output torque of the hydraulic piston motor are expressed by eqs 29 32 respectively 29 η v m α m d max ω m α m d max ω m q l 30 η t m α m d max δ p t l α m d max δ p 31 q m q i η v m 32 t m α m δ p d max η t m where q l and t l are the loss flow rate and the loss torque of the pump respectively ho and ahn 2010 see table 1 4 simulation and experiment of mpawec the structure of the simulation and experiment investigations with different configurations is presented in table 2 the hydrodynamic parameters in sections 3 1 and 3 2 are obtained using wamit software the simulation was built in a co simulation environment which is a combination of amesim software version 9 0 and matlab simulink software the wave profile and wave forces are obtained using matlab simulink the motion and force acting on a cylinder are embedded into the hydraulic circuit sections 3 3 3 6 which are built in amesim consequently the pressure flow rate motor torque motor speed and energy are obtained a flowchart of the simulation is presented in fig 10 a simulation of a single point absorber wec was performed with a flywheel as an energy storage device to compare with it the hpa storage system and a case without any energy storage system both the simulation and experiment were performed for the multi point absorber using the flow coupling principle and the results were compared to verify the agreement between the numerical approach and the real system the simulation program was then used to obtain the result of the method proposed in section 4 3 since the experiment could not be done due to the limitations of the current test rig based on the parameters of the generator and wave conditions the hydraulic components of the proposed system were calculated and chosen as shown in table 3 4 1 experiment with a single cylinder wec initially experiments were carried out with a single cylinder in two cases without an hpa and with an hpa in addition a single point absorber configuration using an inertial energy storage system iess was also investigated as shown in fig 11 in this approach the hpa is removed and a flywheel flw is installed between the hydraulic motor shaft and generator shaft the hydraulic circuit and parameters of the single point absorber using iess are shown in fig 12 and table 4 respectively the volume of hpa was chosen based on the energy capacity maximum intended working pressure and flow rate capacity of the hydraulic circuit the optimal volume of the hpa was calculated based on rabie 2009 and then a commercial product that has similar parameters to the calculated results was chosen some numerical simulations with other volumes were also done but at the scale of this test rig the proposed parameters in table 4 are the most suitable fig 13 shows the cylinder displacement and motor flow rate obtained with and without an hpa the cylinder displacement has a sinusoidal profile amplitude 0 2 m period 6s as shown in fig 13a the profiles are similar in both cases but the motor flow rate is very different in the case without the hpa the flow rate amplitude varies from 0 to 22 lpm whereas with the hpa the flow rate amplitude is steady at around 5 lpm as shown in fig 13b fig 14 illustrates the pressure at the cylinder port red solid curve and motor port blue dashed curve in the cases with and without the hpa in fig 14a without the damping effect of the hpa the pressure at the motor input port strongly fluctuates from 15 to 160 bar which is similar to the cylinder pressure by adding the hpa the pressure at the motor input port slightly increases from 75 to 85 bar despite the strong variation of the cylinder pressure as shown in fig 14b the fluctuation of the pressure at the motor port causes a disadvantage for the motor speed and motor torque in the case without the hpa as shown in fig 15 without the hpa the motor speed varies from 0 to 1200 rpm and the motor torque changes from 0 to 38 nm however after adding the hpa the motor speed is stable around 200 rpm and the motor torque is slightly increased from 20 to 24 nm hence the output power of the motor is more stable when adding the hpa fig 15 displays the simulation results of the motor speed and motor torque in cases with 2 5kgm2 and 5kgm2 flywheels when using the 2 5kgm2 flywheel the motor speed range is 180 500 rpm the range of the generator speed is reduced from 200 to 400 rpm when using the 5kgm2 flywheel the motor torque when using the flywheel is high and suddenly increases when the hydraulic motor speeds up generally the hpa smoothens the motor speed and torque compared to the other cases 4 2 simulation and experiment with an mpawec with the flow coupling principle in a hydraulic system if a hydraulic motor or actuator consumes all of the fluid flow generated by the hydraulic pump without storing it anywhere the flow coupling principle occurs an experiment was carried out with multiple cylinders and the flow coupling principle in this experiment the 5 lower cylinders are controlled to achieve the motion given by the wave float interaction model as shown in fig 3 the 5 upper cylinders convert energy from the oscillating motion into high pressure fluid power according to mccormick 2010 the energy flux in one period for the deep water of the water tank is expressed as 34 e ρ g 2 h 2 t 2 b 16 π the parameters in table 5 are for a full scale prototype based on these parameters the hydrodynamics of the buoy and waves were calculated by wamit software and then embedded in the experiment and simulation investigations the results of the energy flux in one period and 30s are calculated as shown in table 6 fig 16 shows wave blue dot curve with parameters shown in table 6 and wave buoy displacement and buoyant speed with flow coupling principle displacement of the buoy 1 in simulation wine dot curve and displacement of the buoy 1 in experiment red solid curve and buoyant speed of 5 cylinders in the experiment speed of the buoy 1 in experiment red solid curve speed of the buoy 2 in experiment blue dash dot curve speed of the buoy 3 in experiment black dot curve speed of the buoy 4 in experiment wine dot curve and speed of the buoy 5 in experiment cyan dash dot curve the experimental results of buoyancy forces of 5 cylinders are presented in fig 17 a buoyant force of the cylinder 1 in experiment red solid curve buoyant force of the cylinder 2 in experiment blue dash dot curve buoyant force of the cylinder 3 in experiment black dot curve buoyant force of the cylinder 4 in experiment wine dot curve and buoyant force of the cylinder 5 in experiment cyan dash dot curve the buoyancy force of buoy 1 in both the simulation blue dash curve and experiment red solid curve are shown in fig 17b the buoyancy force amplitude of buoy 1 in the simulation is quite similar to the force amplitude in the experiment the flow rate and pressure at the motor input port are shown in fig 18 the profiles of both the flow rate and pressure in the experimental results in the case of 5 cylinders are smoother and higher than in the case of a single cylinder in section 4 1 the experimental results and simulation results show good agreement fig 19 shows the motor speed and torque in the simulation blue dashed curve and experiment red solid curve the fluid from the 5 cylinders and the effect of the hpa can reduce the fluctuation of both the motor speed and torque the motor speed is stable around 1100 rpm in the experiment and simulation while motor torque is around 37 nm in the simulation and 39 nm in the experiment the input and output power and energy are presented in fig 20 the input power is the hydraulic input power and is calculated as the product of the force and speed at the rods of the 5 cylinders the output power is the product of the rotational speed and the torque at the hydraulic motor s shaft the input powers in both the simulation and the experiment strongly fluctuate from 1 to 12 kw however the output power is stable around 5 kw in both the simulation and the experiment the input and output energies are the integrals of the input and output power after 150s the input and output energies are 882 9 kj and 587 2 kj in the experiment and 858 1 kj and 579 3 kj in the simulation respectively according to the energy flux shown in table 6 the efficiencies can be calculated as shown in table 7 the table shows that there is good agreement between the simulation and experimental results 4 3 simulation of an mpawec with the pressure coupling principle if a hydraulic motor or hydraulic actuator consume only the flow it needs the excess or insufficient flow is stored or compensated by an energy storage system ess such as a hydraulic accumulator a secondary control unit scu is controlled by a controller to achieve a reference position speed torque and other parameters this is called the pressure coupling principle in the simulation of the mpawec with pressure coupling principle the hpa is again employed but a variable displacement motor is used instead of the fixed displacement motor in the mpawec ii test rig the hydraulic motor is a fixed displacement motor so we can only examine the pressure coupling method with simulation results experimental results with a variable displacement motor will be obtained in future work with a full scale test rig the wave and displacement of buoy 1 are presented in fig 21 a and the force at buoy 1 is presented in fig 21b the reference speed of the hydraulic motor is set based on the pressure of the hpa as shown in table 8 a pid controller can track the reference speed well as shown in fig 22 a the motor torque is shown in fig 22b we assume that the rated speed of the generator is 1500 rpm normally the motor should run at the rated speed when the pressure of the hpa becomes higher and higher it means that the input power is higher than the output power and vice versa if the pressure reaches the upper setting value the reference speed is switched to the higher level to use more power at the output the pressure of the accumulator tends to decrease if the pressure reaches the lower setting value the reference speed is switched to the lower level to use less power at the output the pressure of the accumulator tends to increase as shown in figs 22a and 23b the hpa is initially charged until the pressure reaches 140 bar at 5s and then the reference speed is switched from 0 to 1600 rpm this reference speed corresponds to the upper pressure setting the output power used is greater than the input power so the pressure of the hpa decreases when the pressure of the hpa decreases at 130 bar at 38s the reference speed is switched to 1500 rpm the output power is less than the input power so the spare energy is stored in the hpa and the pressure increases at 92s the pressure reaches 140 bar again and then the reference speed is switched to 1600 rpm the pressure of the hpa repeatedly decreases to 130 bar while the reference speed is switched to 1500 rpm the reference speed switching method can widen the operating range of the input power the input power strongly fluctuates but the output power is almost constant as shown in fig 24 a hence the change of the motor flow rate in fig 23a is opposite to the change of the accumulator pressure in fig 23b at the end of the simulation the input energy is 878 6 kj and the output energy is 598 1 kj the hydraulic efficiency is 68 1 and the overall efficiency is 27 3 5 conclusions and future works this paper proposed a new concept of a wave energy converter based on a combination of a multi point absorber and a pressure coupling hydrostatic transmission the object of this approach is to maintain the driving speed of the generator and reduce the effect of wave power fluctuation on the output power mathematical models of the hydraulic components were presented and simulations were carried out the simulations and experiments were done using several wec configurations the investigations showed that the pressure fluctuation can be reduced by using the hpa and multi point absorber by using the pressure coupling principle the driving speed of the generator was controlled strictly to track the reference speed the reference speed could be chosen logically based on the pressure of the hpa therefore the stability of the output power can be improved the simulation and experiment demonstrated good agreement between the results the results indicated the effectiveness of the proposed mpawec in the maintenance of the driving speed to satisfy the operating conditions of the generator with a relative speed error of less than 0 67 the hydraulic efficiency of the proposed system was 68 1 and the overall efficiency was 27 3 in future work a full scale test rig needs to be fabricated in this rig a variable displacement hydraulic motor would be employed to run the generator to apply the pressure coupling principle and stabilize the output power acknowledgements this work was supported by basic science research program through the national research foundation of korea nrf funded by the korean government mest nrf 2017r1a2b3004625 
23315,a point absorber wave energy converter is commonly used because its structure is simple and efficient this paper proposes a multi point absorber wave energy converter mpawec in which hydrostatic transmission is used to convert wave energy into electric energy with multi point absorbers and a high pressure accumulator the design offers advantages such as greater energy harvesting and stabilization of the output power a small scale test rig was fabricated for experiments all of the components of the mpawec were mathematically modeled and simulation results were compared with the experimental results the overall efficiency of the proposed system is 27 3 keywords hydrostatic transmission multi point absorber wave energy converter high pressure accumulator nomenclature a bh wet cross section of the buoy on a plane perpendicular to the direction of the wave m 2 a cvii cross section of the check valve cvi i a cvoi cross section of the check valve cvo i a pi piston area of the cylinder i th m 2 a v relief valve throttling area m 2 c d discharge coefficient c d drag coefficient in water d bore diameter of cylinder m d b diameter of floating buoy m d max maximum displacement of hydraulic motor cc rev f i random frequencies of wave component hz g gravitational acceleration m s2 h wave height m h b cylindrical height of the floating buoy m hpa high pressure accumulator lpa low pressure accumulator m b mass of the floating buoy kg m g mass of the gas in hpa kg m s mass of the moving shaft kg n adiabatic coefficient p g pressure of the gas in the accumulator p i pressure at the cylinder i th ports p l pressure in the low pressure line and the lpa p g0 gas pre charged pressure in the hpa pa p h pressure in the high pressure line pa r hemisphere radius of the floating buoy m s a f i spectral density of the represented sea states m2s t g temperature of the gas in hpa k v h volume of the hoses m3 v 0hpa initial volume of the hpa m3 y t displacement of the floating buoy m y t irregular wave displacement m z submerged level of the floating buoy m α m displacement ratio of hydraulic motor β bulk modulus of oil pa ω motor rotation speed rpm ω w wave angular frequency s 1 δf increment of wave frequency hz δp pressure difference between the two ports of the motor pa η c friction coefficient of cylinder η vm volumetric efficiency of hydraulic motor η tm mechanical efficiency of hydraulic motor ρ density of water kg m3 φ rand i random phases of wave component rad v wave velocity m s 1 introduction various concepts of wave energy converters wecs have been developed drew et al 2009 and there has been much research to maximize the absorbed power and improve their efficiency valério et al 2007 investigated the performance of several control strategies for an archimedes wave swing aws such as reactive control phase control amplitude control latching control and feedback linearization control feedback linearization control was the best method nielsen et al 2014 proposed an optimal control law for maximum absorbed mean power of an array of point absorber the law can be optimal for any 2d or 3d irregular sea state and during the transient phase numeral calculation using wamit software shows good result hardy et al 2016 presented a maximum capture width tracking mcwt latching controller for an oscillating water column owc and investigated the controller performance in irregular waves the simulation results showed that in stationary sea states both maximum power point tracking mppt and mcwt controllers can optimize a wec within the confidence bounds where the optimal capture width can be determined cargo et al 2016 presented a methodology for obtaining the optimum pto damping coefficient for a given sea state they used an open loop active tuning method to adjust the pto parameters to achieve optimum damping gaspar et al 2016 presented a generic pto concept that can be adapted to different types of wecs and can minimize undesirable hydraulic pressure losses and compressibility effects however the case study only used simulations to examine the point absorbers with only a one point absorber the pressure of the high pressure line fluctuates in a large range thus the output power is not stable few studies have focused on smoothing the output power in a combined wind and wave farm astariz and iglesias 2016 zhao et al 2016 some studies have looked at the smoothing effect and reducing power fluctuations in a wave array and wave farm molinas et al 2007 tissander et al 2008 babarit 2013 goteman et al 2014 the methods proposed include increasing the number of wec devices adjusting the spacing or positioning of the wec platform and using different buoy sizes in a wec park however the smoothing power using a pto system has not been studied sufficiently do et al 2015 proposed an adjustable slope angle wave energy converter asawec that is similar to the wavestar concept nambiar et al 2015 ransley et al 2017 they investigated the effect of the slope angle on the performance of the proposed wave energy converter to find the optimal slope angle the goal was to increase the power capture capability and energy efficiency to overcome the disadvantages of previous approaches this paper proposes a multi point absorber wave energy converter mpawec that uses a hydrostatic transmission and a high pressure accumulator hpa some previous research has applied an hpa to a hydraulic system falcão 2007 vicente et al 2013 but the problem of smoothing the output power was not considered the pressure coupling principle is used for the speed control method the objective is to stabilize and enhance the output power different configurations were investigated including single point absorber wecs without an hpa with an hpa and with a flywheel a multi point absorber with an hpa using the flow coupling principle and a multi point absorber with an hpa using the pressure coupling principle the main points of the proposed mpawec are as follows all sets of floating buoys and cylinders are placed equidistantly from neighboring ones based on the same phase difference on the propagation route in this way the fluid from each cylinder can compensate for the fluid in the others making the total flow into the accumulator nearly constant the hpa has two functions to smooth the fluid pressure supplied from the cylinders and to store energy when wave conditions are strong the wave power is greater than the rated power and the excess power is absorbed by the hpa when wave conditions are weak the wave power is less than the rated power and the hpa compensates for the deficit in power supplied to the hydraulic motor the driving speed of a generator can be controlled by using the pressure coupling principle of the hydrostatic transmission hence the amplitude of pressure fluctuations can be reduced and the driving speed of the generator can be maintained stably despite changes in the wave conditions the reference speed can be selected automatically based on the pressure of condition hpa the remainder of this paper is organized as follows section 2 describes the proposed mpawec and section 3 explains the mathematical model of the hydraulic system section 4 presents condition results of simulations and experiments and section 5 discusses the conclusions and future work 2 description of a multi point absorber wave energy converter a multi point absorber wave energy converter is used to reduce the fluctuation magnitude of the output power and utilize a common pressure rail connected to an hpa in the conceptual design multi point absorbers are placed in two arrays on the seabed a 3d conceptual design of the proposed mpawec is shown in fig 1 two arrays of floating buoys are fixed to the moving shaft one cylinder functions as a hydraulic pump and is attached to each shaft one end of the cylinder is joined to the moving shaft while the other is joined to the frame the frame and all of its attached components are supported by columns which are fixed to the sea bottom when a wave arrives the floating buoys and the moving shaft oscillate together along the tilt longitudinal direction the wave s force is divided into a vertical component and a horizontal component the resultant force has the same direction as the moving direction or differs from it by a small angle therefore friction between moving parts is reduced and more power is absorbed from the wave the piston of the cylinder moves up and down thereby generating high pressure fluid at the output port of the cylinder the sliding angle of a floating buoy can be adjusted by an actuator as shown in fig 2 do et al 2017 proposed a self adjustment method for the sliding angle the mpawec i test rig is used in a wave making tank which includes a wave making wall that is moved by hydraulic propulsion cylinders in a water tank a slope damping net is attached to the opposite side of the wave making wall to eliminate reflex waves and avoid unexpected noise the motion of the wave making wall and cylinders is set up and controlled by a computer and sensors to achieve an exact wave amplitude and frequency a diagram and the parameters of the wave making tank are shown in fig 3 mpawec i is a small scale test rig and the wave making tank can generate small waves for this rig the mpawec ii test rig was fabricated for stronger wave conditions the new wave conditions are simulated by the motion of a float motion simulator 2 the experiment system includes 4 blocks as shown in fig 4 the power supply block 1 supplies high pressure fluid to run the 5 lower cylinders of the floating buoy motion simulator 2 each of the cylinders is controlled separately motion of the cylinder is achieved by a wave float interaction model the 5 upper cylinders convert energy from the oscillating motion into high pressure fluid power the high pressure fluid is collected in a high pressure line via check valves one part of the high pressure flow is used to drive the hydraulic motor to run the generator of the generator block 3 the excess high pressure fluid is stored in the hpa the hpa smoothens the operating pressure and the driving speed of the hydraulic motor is stabilized in the generator block we employ a hydraulic pump and a proportional relief valve to simulate the load of the generator instead of a real generator the measured data and control signals to and from these 3 blocks are processed by a control system included the control panel 4 and a computer the hydraulic circuit and control system of the proposed mpawec are shown in fig 5 when the cylinder extends fluid from the low pressure accumulator lpa fills the full bore chamber of the cylinder when the cylinder is compressed the fluid in the chamber is pressurized and pumped to the hpa all the cylinders work with a similar principle the check valve system allows only low pressure fluid from the low pressure line into the cylinder and high pressure fluid from the cylinder into the high pressure line to charge the hpa high pressure fluid is used to drive the hydraulic motor to rotate the generator the relief valve rlv1 releases pressure in the hpa to protect the hydraulic circuit if the operating pressure becomes too high this research mainly focuses on the power take off concept of the wec system other approaches strongly focus on increasing the absorbed power without considering the smoothing of the output power the fluctuation of the output power may decrease the effectiveness of the whole wec since the generator only achieves the highest efficiency at its rated speed thus this paper examines the reduction of the fluctuation phenomena of incident wave power using the proposed method consequently the output power will be stable and more energy will be harvested and converted to electricity the interaction between wec devices is expressed by the q factor and has been the subject of extensive research evans 1982 mavrakos and mciver 1997 babarit 2013 de chowdhury and manasseh 2017 the previous studies show that the absorbed power of an array of wecs can be either less q 1 or greater q 1 than the power of the same number of isolated devices thus there are methods that can be applied to optimize the power extraction e g array configuration positioning and mooring this topic will be a focus of future work with a full scale real sea multi point wec test rig 3 mathematical modeling of the multi point absorber wave energy converter 3 1 wave model an irregular ocean wave can be represented as the superposition of single waves described by the pierson moskowitz spectrum alves et al 2003 as shown in fig 6 hansen et al 2011 1 s a f α g 2 2 π 4 f 5 exp 1 25 f m f 4 where f is the wave frequency in hertz f m v p m g u 19 5 is the dimensional peak frequency in hertz the scaled non dimensional peak frequency is v 19 5 p m 0 145 α 0 0081 is the empirically determined equilibrium range level or the phillips constant and u 19 5 is the wind speed at 19 4 m above the sea surface the irregular wave spectrum is represented by the significant wave height h s and the peak wave period t p an irregular wave can be generated as a sum of wave components hansen et al 2011 2 y t i 1 n 2 s a f i δ f sin 2 π f i t φ r a n d i where y t is the irregular wave displacement s a f i is the spectral density of the represented sea states δf is the increment of wave frequency and f i and φ rand i are the frequency and random phases of each component respectively 3 2 hydrodynamic model of a floating buoy the motion of a floating buoy can be described using the following equation 3 m b m s y t f w cos γ f p t o where m b and m s are the mass of the floating buoy and the mass of the moving shaft respectively y t is the displacement of the floating buoy f pto is the force to move the cylinder piston to make high pressure fluid f w is the resultant force of a wave on the floating buoy and γ is the difference between the optimal slope angle and the instantaneous slope angle as shown in fig 7 including the vertical component or the heave force f heav and the horizontal component or the surge force f surg 4 f w f h e a v f s u r g according to falnes 2002 the heave force exerted on the floating buoy can be represented as a superposition of three components the hydrostatic force the excitation force applied by an incoming regular wave to a fixed float and the radiation force experienced by an oscillating float which is the sum of the forces created by the motion of the other buoys floating on the water the heave force from the wave is defined as 5 f h e a v f b f e x f r f g where f b is the buoyancy force f ex is the excitation force and f r is the radiation force produced by an oscillating body creating waves on an otherwise calm sea f g is the gravity force the buoyancy force f b is calculated as 6 f b ρ g v s where ρ is the density of water g is gravitational acceleration and v s is the volume of the floating buoy that is below the water surface as shown in fig 8 and defined as 7 v s π 3 3 r z z 2 0 z r 2 π 3 r 3 π r 2 z r r z r h b the excitation force f ex is expressed as in cargo et al 2011 8 f e x ω f 3 ω y ˆ ω where f 3 is the excitation force coefficient falnes 2002 and y is the wave amplitude 9 f 3 k 3 ρ g π r 2 the coefficient k 3 depends on the wave frequency and varies from one to zero as the wave frequency increases from zero to infinity the coefficient k 3 can be obtained from falnes 2002 figure 5 7 page 135 by calculating the normalized wave frequency ω w db 4g ˆ 1 2 the radiation force is expressed as 10 f r ω m r ω y ˆ r r ω y ˆ where m r ω is the added mass and r r ω is the radiation damping coefficient these parameters can be calculated using wamit software the gravity force f g is calculated as 11 f g m b m s g the surge force from a wave is modeled in a similar way as the heave force as the sum of the excitation force and radiation force in the surge direction 12 f s u r f e x s u r f r s u r 3 3 model of hydraulic cylinder cylinders were employed as hydraulic pumps to convert the kinetic energy of a floating buoy into potential energy stored in the hpa the floating buoys are moved by waves and then fluid in the cylinders is pressurized x t is the x coordinate of the piston because the cylinder s rod is fixed to the floating buoy 13 x t y t considering the ith cylinder shown in fig 9 and referring to hansen et al 2011 the continuity equations of the bore chamber as the floating buoy moves up are 14 d p i d t β a p i l x i a p i x i q c v i i q c v o i a pi is the piston area in m 2 15 a p i π d 2 4 q cvii is the input flow rates from the lpa via check valves cvi i to the ith cylinder 16 q c v i i c d a c v i i 2 p l p i ρ i f p l p i 0 e l s e q cvoi is the output flow rates from the ith cylinder via check valves cvo i to the hpa 17 q c v o i c d a c v o i 2 p i p h ρ i f p i p h 0 e l s e i 1 2 5 for the 1st to 5th cylinders p i is the pressure at the cylinder ith port defined by eq 14 the cylinder force is calculated as 18 f p t o i δ p i a p i f f r i c where 19 δ p i p i p t p t is considered as the pressure in the lpa f fri is the friction of the cylinder defined as 20 f f r i c δ p i a p i 1 η c the cylinder friction f fric is defined such that the cylinder has a friction coefficient η c 3 4 modeling and calculation of the hpa we employed a bladder accumulator that is filled with nitrogen gas according to rabie 2009 the nitrogen gas is assumed to compress and expand based on the adiabatic gas law 21 p g v n p g 0 v 0 n p g max v min n the gas pressure in the hpa is expressed by the beattie bridgman equation 22 p g m g v 2 r a c t g 1 m g c v t g 3 v m g b 0 1 m g b a c v a 0 1 m g a a c v the gas volume can be estimated from the flow rate into the accumulator 23 v v 0 h p a 0 t q h p a d t 3 5 model of connecting line using the flow continuity equation the pressure in the high pressure line is expressed as 24 d p h d t β v h i 1 5 q c v o i q h p a q r q m where q cvoi represents the flow rates through check valve cvo i formulated in eq 17 q hpa is the flow rate into the hpa 25 q h p a v h p a 0 i f p h p 0 1 n v 0 1 p 0 p h 1 n n p 0 p h p h 2 e l s e q r is the flow rate through the relief valve rlv according to pinches and ashby 1988 q r can be expressed as 26 q r 0 i f δ p p s e t c d a v 2 δ p ρ i f δ p p s e t q m is the actual flow rate of the hydraulic motor as in eq 31 and δp is the pressure difference between the high pressure and low pressure lines which is considered to be the pressure in the lpa 27 δ p p h p l 3 6 model of the hydraulic motor the ideal flow rate of the piston hydraulic motor is defined as 28 q i α m d max ω m where ω m is the motor rotation speed the volumetric efficiency mechanical efficiency actual flow rate and actual output torque of the hydraulic piston motor are expressed by eqs 29 32 respectively 29 η v m α m d max ω m α m d max ω m q l 30 η t m α m d max δ p t l α m d max δ p 31 q m q i η v m 32 t m α m δ p d max η t m where q l and t l are the loss flow rate and the loss torque of the pump respectively ho and ahn 2010 see table 1 4 simulation and experiment of mpawec the structure of the simulation and experiment investigations with different configurations is presented in table 2 the hydrodynamic parameters in sections 3 1 and 3 2 are obtained using wamit software the simulation was built in a co simulation environment which is a combination of amesim software version 9 0 and matlab simulink software the wave profile and wave forces are obtained using matlab simulink the motion and force acting on a cylinder are embedded into the hydraulic circuit sections 3 3 3 6 which are built in amesim consequently the pressure flow rate motor torque motor speed and energy are obtained a flowchart of the simulation is presented in fig 10 a simulation of a single point absorber wec was performed with a flywheel as an energy storage device to compare with it the hpa storage system and a case without any energy storage system both the simulation and experiment were performed for the multi point absorber using the flow coupling principle and the results were compared to verify the agreement between the numerical approach and the real system the simulation program was then used to obtain the result of the method proposed in section 4 3 since the experiment could not be done due to the limitations of the current test rig based on the parameters of the generator and wave conditions the hydraulic components of the proposed system were calculated and chosen as shown in table 3 4 1 experiment with a single cylinder wec initially experiments were carried out with a single cylinder in two cases without an hpa and with an hpa in addition a single point absorber configuration using an inertial energy storage system iess was also investigated as shown in fig 11 in this approach the hpa is removed and a flywheel flw is installed between the hydraulic motor shaft and generator shaft the hydraulic circuit and parameters of the single point absorber using iess are shown in fig 12 and table 4 respectively the volume of hpa was chosen based on the energy capacity maximum intended working pressure and flow rate capacity of the hydraulic circuit the optimal volume of the hpa was calculated based on rabie 2009 and then a commercial product that has similar parameters to the calculated results was chosen some numerical simulations with other volumes were also done but at the scale of this test rig the proposed parameters in table 4 are the most suitable fig 13 shows the cylinder displacement and motor flow rate obtained with and without an hpa the cylinder displacement has a sinusoidal profile amplitude 0 2 m period 6s as shown in fig 13a the profiles are similar in both cases but the motor flow rate is very different in the case without the hpa the flow rate amplitude varies from 0 to 22 lpm whereas with the hpa the flow rate amplitude is steady at around 5 lpm as shown in fig 13b fig 14 illustrates the pressure at the cylinder port red solid curve and motor port blue dashed curve in the cases with and without the hpa in fig 14a without the damping effect of the hpa the pressure at the motor input port strongly fluctuates from 15 to 160 bar which is similar to the cylinder pressure by adding the hpa the pressure at the motor input port slightly increases from 75 to 85 bar despite the strong variation of the cylinder pressure as shown in fig 14b the fluctuation of the pressure at the motor port causes a disadvantage for the motor speed and motor torque in the case without the hpa as shown in fig 15 without the hpa the motor speed varies from 0 to 1200 rpm and the motor torque changes from 0 to 38 nm however after adding the hpa the motor speed is stable around 200 rpm and the motor torque is slightly increased from 20 to 24 nm hence the output power of the motor is more stable when adding the hpa fig 15 displays the simulation results of the motor speed and motor torque in cases with 2 5kgm2 and 5kgm2 flywheels when using the 2 5kgm2 flywheel the motor speed range is 180 500 rpm the range of the generator speed is reduced from 200 to 400 rpm when using the 5kgm2 flywheel the motor torque when using the flywheel is high and suddenly increases when the hydraulic motor speeds up generally the hpa smoothens the motor speed and torque compared to the other cases 4 2 simulation and experiment with an mpawec with the flow coupling principle in a hydraulic system if a hydraulic motor or actuator consumes all of the fluid flow generated by the hydraulic pump without storing it anywhere the flow coupling principle occurs an experiment was carried out with multiple cylinders and the flow coupling principle in this experiment the 5 lower cylinders are controlled to achieve the motion given by the wave float interaction model as shown in fig 3 the 5 upper cylinders convert energy from the oscillating motion into high pressure fluid power according to mccormick 2010 the energy flux in one period for the deep water of the water tank is expressed as 34 e ρ g 2 h 2 t 2 b 16 π the parameters in table 5 are for a full scale prototype based on these parameters the hydrodynamics of the buoy and waves were calculated by wamit software and then embedded in the experiment and simulation investigations the results of the energy flux in one period and 30s are calculated as shown in table 6 fig 16 shows wave blue dot curve with parameters shown in table 6 and wave buoy displacement and buoyant speed with flow coupling principle displacement of the buoy 1 in simulation wine dot curve and displacement of the buoy 1 in experiment red solid curve and buoyant speed of 5 cylinders in the experiment speed of the buoy 1 in experiment red solid curve speed of the buoy 2 in experiment blue dash dot curve speed of the buoy 3 in experiment black dot curve speed of the buoy 4 in experiment wine dot curve and speed of the buoy 5 in experiment cyan dash dot curve the experimental results of buoyancy forces of 5 cylinders are presented in fig 17 a buoyant force of the cylinder 1 in experiment red solid curve buoyant force of the cylinder 2 in experiment blue dash dot curve buoyant force of the cylinder 3 in experiment black dot curve buoyant force of the cylinder 4 in experiment wine dot curve and buoyant force of the cylinder 5 in experiment cyan dash dot curve the buoyancy force of buoy 1 in both the simulation blue dash curve and experiment red solid curve are shown in fig 17b the buoyancy force amplitude of buoy 1 in the simulation is quite similar to the force amplitude in the experiment the flow rate and pressure at the motor input port are shown in fig 18 the profiles of both the flow rate and pressure in the experimental results in the case of 5 cylinders are smoother and higher than in the case of a single cylinder in section 4 1 the experimental results and simulation results show good agreement fig 19 shows the motor speed and torque in the simulation blue dashed curve and experiment red solid curve the fluid from the 5 cylinders and the effect of the hpa can reduce the fluctuation of both the motor speed and torque the motor speed is stable around 1100 rpm in the experiment and simulation while motor torque is around 37 nm in the simulation and 39 nm in the experiment the input and output power and energy are presented in fig 20 the input power is the hydraulic input power and is calculated as the product of the force and speed at the rods of the 5 cylinders the output power is the product of the rotational speed and the torque at the hydraulic motor s shaft the input powers in both the simulation and the experiment strongly fluctuate from 1 to 12 kw however the output power is stable around 5 kw in both the simulation and the experiment the input and output energies are the integrals of the input and output power after 150s the input and output energies are 882 9 kj and 587 2 kj in the experiment and 858 1 kj and 579 3 kj in the simulation respectively according to the energy flux shown in table 6 the efficiencies can be calculated as shown in table 7 the table shows that there is good agreement between the simulation and experimental results 4 3 simulation of an mpawec with the pressure coupling principle if a hydraulic motor or hydraulic actuator consume only the flow it needs the excess or insufficient flow is stored or compensated by an energy storage system ess such as a hydraulic accumulator a secondary control unit scu is controlled by a controller to achieve a reference position speed torque and other parameters this is called the pressure coupling principle in the simulation of the mpawec with pressure coupling principle the hpa is again employed but a variable displacement motor is used instead of the fixed displacement motor in the mpawec ii test rig the hydraulic motor is a fixed displacement motor so we can only examine the pressure coupling method with simulation results experimental results with a variable displacement motor will be obtained in future work with a full scale test rig the wave and displacement of buoy 1 are presented in fig 21 a and the force at buoy 1 is presented in fig 21b the reference speed of the hydraulic motor is set based on the pressure of the hpa as shown in table 8 a pid controller can track the reference speed well as shown in fig 22 a the motor torque is shown in fig 22b we assume that the rated speed of the generator is 1500 rpm normally the motor should run at the rated speed when the pressure of the hpa becomes higher and higher it means that the input power is higher than the output power and vice versa if the pressure reaches the upper setting value the reference speed is switched to the higher level to use more power at the output the pressure of the accumulator tends to decrease if the pressure reaches the lower setting value the reference speed is switched to the lower level to use less power at the output the pressure of the accumulator tends to increase as shown in figs 22a and 23b the hpa is initially charged until the pressure reaches 140 bar at 5s and then the reference speed is switched from 0 to 1600 rpm this reference speed corresponds to the upper pressure setting the output power used is greater than the input power so the pressure of the hpa decreases when the pressure of the hpa decreases at 130 bar at 38s the reference speed is switched to 1500 rpm the output power is less than the input power so the spare energy is stored in the hpa and the pressure increases at 92s the pressure reaches 140 bar again and then the reference speed is switched to 1600 rpm the pressure of the hpa repeatedly decreases to 130 bar while the reference speed is switched to 1500 rpm the reference speed switching method can widen the operating range of the input power the input power strongly fluctuates but the output power is almost constant as shown in fig 24 a hence the change of the motor flow rate in fig 23a is opposite to the change of the accumulator pressure in fig 23b at the end of the simulation the input energy is 878 6 kj and the output energy is 598 1 kj the hydraulic efficiency is 68 1 and the overall efficiency is 27 3 5 conclusions and future works this paper proposed a new concept of a wave energy converter based on a combination of a multi point absorber and a pressure coupling hydrostatic transmission the object of this approach is to maintain the driving speed of the generator and reduce the effect of wave power fluctuation on the output power mathematical models of the hydraulic components were presented and simulations were carried out the simulations and experiments were done using several wec configurations the investigations showed that the pressure fluctuation can be reduced by using the hpa and multi point absorber by using the pressure coupling principle the driving speed of the generator was controlled strictly to track the reference speed the reference speed could be chosen logically based on the pressure of the hpa therefore the stability of the output power can be improved the simulation and experiment demonstrated good agreement between the results the results indicated the effectiveness of the proposed mpawec in the maintenance of the driving speed to satisfy the operating conditions of the generator with a relative speed error of less than 0 67 the hydraulic efficiency of the proposed system was 68 1 and the overall efficiency was 27 3 in future work a full scale test rig needs to be fabricated in this rig a variable displacement hydraulic motor would be employed to run the generator to apply the pressure coupling principle and stabilize the output power acknowledgements this work was supported by basic science research program through the national research foundation of korea nrf funded by the korean government mest nrf 2017r1a2b3004625 
23316,this work investigates the extensional torsional response of a flexible pipe with one up to ten wires broken in its outer tensile armor experimental tests were conducted and the results obtained are compared to those from a finite element fe and a simplified analytical model in these tests the pipe was firstly subjected to pure tension and then to clockwise and anticlockwise torsion the experimental results indicate a decrease in the stiffness of the pipe with the increasing number of broken wires as well as a significant impact on its extensional torsional balance high stress concentrations in the wires close to those damaged were observed furthermore local changes in the curvature of the pressure armor and the inner carcass induced bending strains not only in these layers but also in the inner tensile armor wires the fe model captured these effects and agreed well with the experimental measurements while the analytical model predicted the overall response of the pipe but local effects could not be evaluated keywords flexible pipes offshore structures damage stress analysis finite element method 1 introduction in the last decades the exploitation of several offshore hydrocarbon fields has been based on floating production units and wet christmas trees in this scenario the use of unbonded flexible pipes or simply flexible pipes instead of carbon steel rigid pipes is often advantageous due to their easy installation compliance with movements from floating units and ability to absorb harsh environmental loads flexible pipes such as the one presented in fig 1 are multilayered structures in which each layer is designed to meet specific requirements these layers are either polymeric or metallic the polymeric layers work as sealing insulating or anti wear components while the metallic layers resist the applied structural loads in a typical flexible pipe three different metallic layers are found api 2014a inner carcass which is made from profiled steel strips wound at angles close to 90 and mainly resists radial inward forces pressure armor which are usually made from z shaped steel wires also wound at angles close to 90 with the main function of supporting the system internal pressure and also radial inward forces and tensile armors which are constituted of several rectangular steel wires laid in two or four layers cross wound at angles between 20 and 55 that resist tension torque and pressure end cap effects despite their effectiveness in the last few years periodic inspections of these structures have detected a considerable number of damages in their cross sections anderson et al 2007 botto et al 2008 carneval et al 2006 eide and muren 2014 eriksen and engelbreth 2014 taylor et al 2002 fagundes 2009 and one of the most common type of damage is the rupture of the outer sheath botto et al 2008 carneval et al 2006 eide and muren 2014 eriksen and engelbreth 2014 this type of damage may occur during the installation of the pipe when the sheath may be accidentally torn or during its operation due to eide and muren 2014 eriksen and engelbreth 2014 abrasion caused by contact with other pipes or components of floating production facilities impact of dropped objects cracking of the sheath or problems in the venting valves of the pipe even though damages in the outer sheath do not immediately affect the structural capacity of flexible pipes they may work as failure initiators a breach in the outer sheath such as the one illustrated in fig 2 a exposes the wires of the tensile armors to the outer environment and allows the ingress of oxygenated seawater and or air into the annulus of the pipe initially the exposure of these carbon steel wires to this aggressive environment causes the appearance of corrosion pits as shown in fig 2b in the course of time if the pipe is left unrepaired these corrosion pits may lead to the rupture of the affected wires by corrosion fatigue and or excessive loading eide and muren 2014 eriksen and engelbreth 2014 félix henry 2007 berge et al 2014 fig 2c the rupture of wires affects the torsional balance of the pipe fig 2d and also provokes a redistribution of forces among the remaining wires which consequently have to sustain higher loads if these loads are higher than their actual structural capacity more wires would break this mechanism continues until the wires of the tensile armors are not capable of sustaining the imposed axial loads and the whole pipe fails it is also worth remarking that even if the outer sheath is intact corrosion may occur in the tensile armor wires mainly due to the diffusion and condensation of water in the annulus of the pipe eriksen and engelbreth 2014 api api 2014a states that the integrity of the tensile armors has to be ensured during the entire service life of a flexible pipe as the rupture of their wires significantly reduces the structural capacity of the pipe and may lead to the premature failure of the whole structure therefore once the rupture of a wire in a tensile armor layer is detected with one of the several inspection and surface in field monitoring techniques carneval et al 2006 clarke et al 2011 the repair of the pipe is required however the need to repair or replace a damaged structure may lead to high operational costs which are related to the repair itself and a possible shut down in the production to replace the damaged section of the pipe aiming at reducing operational costs and at the same time ensure the secure operation of these structures the mechanical response of damaged flexible pipes to axisymmetric and bending loads needs to be studied the main problem in analyzing a flexible pipe with damaged wires is the need to individually represent these wires in the chosen model for instance the analytical models devoted to the axisymmetric analysis of flexible pipes typically assume that all wires of an armor layer have the same stress state and are usually represented in terms of total geometric properties total areas moments of inertia and number of wires muñoz et al 2016 therefore these models are suitable for the intact local mechanical analysis of flexible pipes under axisymmetric loads but in the case of damaged pipes they can only be used in very specific cases or for a qualitative understanding of their mechanics de sousa et al de sousa et al 2014 however employed the three dimensional nonlinear finite element fe model proposed in de sousa et al de sousa et al 2009 to analyze the mechanical response of a 6 flexible pipe with wires broken in its tensile armor layers and subjected to pure tension this fe model is capable of representing each wire of these layers and localized defects including total rupture may be adequately addressed in this study the pipe had one of its ends free to translate and or rotate and the other end was fixed experimental studies were also presented in order to validate the fe predictions the numerical analyses and the experimental tests indicated that the rupture of wires in the outer tensile armor layer of a flexible pipe reduces its axial stiffness the stresses in the wires of the outer tensile armor layer are higher next to the damaged ones and progressively reduce to the values observed in the intact structure in wires distant from them the rupture of the outer tensile armor wires seems to not affect the normal stress distribution in the inner tensile armor wires and vice versa this response is associated with the boundary conditions considered in the study the wires broken in the outer tensile armor layer induce an uneven pressure distribution on the pressure armor and the inner carcass which results in high bending moments in these layers however the normal strains in the pressure armor and the inner carcass are not significantly modified due to the deformed shape of the inner carcass and the pressure armor significant bending normal strains may arise in the wires of the inner tensile armor layer when damages are present in the outer tensile armor layer ji et al 2014 analyzed the response of a 6 flexible pipe to tension pressure and bending loads considering 2 4 and 6 neighbor wires broken in its inner tensile armor a three dimensional fe model was constructed using the commercial fe package marc in their analyses the pipe had one end fixed and the other was only allowed to axially translate the numerical analyses combining tension and pressure loads indicated high stress strain concentration factors scfs in the tensile armor wires near the damaged region but these stresses reduce to the intact value in wires distant from the damaged region furthermore scfs close to those found by de sousa et al de sousa et al 2014 were also observed as well as an increase of the normal stresses strains in the pressure armor in this work these studies are extended in order to better understand the extensional torsional response of damaged flexible pipes the extensional torsional response of flexible pipes is a key aspect in the design of equipments to detect the rupture of tensile armor wires in field camerini et al 2008 and moreover to adequately simulate pull out operations de sousa et al 2014 a modified version of the fe model proposed by de sousa et al de sousa et al 2009 is used to study a 9 13 flexible with wires broken in its outer tensile armor two different types of load cases are considered pure tension and torsion clockwise and anticlockwise combined with tension results from experimental tests are compared to the numerical predictions in order to verify the use of the proposed fe model and to discuss the use of an analytical model in the analysis of damaged flexible pipes the main aspects of the modified version of the fe model are introduced next after that the analytical model is presented followed by the description of the studied flexible pipe and the experimental apparatus all results obtained with these models and in the experimental tests are then presented and discussed finally these results are used to obtain the tension vs torsion load capacity curves of the studied flexible pipe and the main conclusions of this work are stablished 2 fe model 2 1 general remarks fig 3 presents a general overview of the proposed fe model the model is composed of concentric cylindrical shells which represent each layer of the pipe except the wires of the tensile armors that are modeled with three dimensional beam elements the presence of contact elements ensures the interaction between layers the construction of this model requires the calculation of the inner carcass and pressure armor thickness and material properties and the choice of adequate finite elements to represent these layers the choice of finite elements suitable for modeling the polymeric and the tensile armor layers the geometric and physical properties of these layers can be directly obtained from data sheets provided by manufacturers or from direct measures of flexible pipes samples the calculation of the contact stiffnesses between all layers as well as the development of contact modeling techniques the friction model parameters have also to be defined the choice of a solver to efficiently solve the set of equations generated by the fe model these aspects are discussed next 2 1 1 inner carcass and pressure armor representation the construction of a solid three dimensional fe model to represent the inner carcass and the pressure armor of a flexible pipe is an extremely onerous computational task due to the high number of degrees of freedom involved this approach is typically employed in burst melendez cuamatzi et al 2015 or hydrostatic collapse gay neto et al 2012 analyses of these structures as in these cases only short lengths of the inner carcass and or the pressure armor are modeled and seem to be sufficient to represent the mechanical response of the whole pipe nevertheless even these small models have hundreds of thousands of degrees of freedom on the other hand the analysis of a flexible pipe subjected to axisymmetric loads involves the adequate representation of all its layers and requires numerical models with a total length of at least one or two linear pitches of the tensile armor wires in order to avoid the effect of the extremities on the response of the pipe muñoz et al 2016 in comparison with the burst and hydrostatic collapse models these models are roughly 20 times longer thus an alternative approach capable of reducing the number of degrees of freedom and adequately modeling the inner carcass and the pressure armor of typical flexible pipes is necessary de sousa et al de sousa et al 2009 initially supposed that 1 the internal friction in these layers is negligible 2 there is no lateral contact between tendons tendon refers to the profiled steel strip that forms the inner carcass and also to each wire that constitutes the pressure armor these hypotheses seem to be valid because the interlocking process leaves internal gaps in these layers and these gaps are dimensioned to avoid lateral contact under moderate loading moreover internal friction or lateral contact in these layers would substantially increase the axial stiffness of the pipe intact or damaged but this has not been observed in previous studies muñoz et al 2016 de sousa et al 2014 by assuming hypotheses 1 and 2 each tendon could be considered as a helical beam and modeled for instance with three dimensional beam elements lacerda et al 2015 however the tendons have very small pitch as their lay angles are close to 90 and consequently a large number of beam elements would be necessary and the computational cost of the model may also be high nevertheless an alternative approach can be derived based on the works presented by hobbs and raoof 1982 and raoof and hobbs 1988 who dealt with the problem of calculating the mechanical properties of strands and wire ropes by representing different layers of helical wires with equivalent orthotropic shells the same idea was employed by de sousa et al de sousa et al 2009 but in a fe approach that guarantees the equivalence between the tendons and the shell stiffnesses two other hypotheses were assumed de sousa et al 2009 3 the thickness of the inner carcass and of the pressure armor are small in comparison to the internal diameter of the layer 4 shear effects are negligible i e linear elements perpendicular to the middle plane of the structure remain straight and normal to the deflected surface of the structure after bending typically the diameter to thickness ratio in pipes for deep water applications are higher than 20 which indicates that these layers can be considered as moderately thick cylinders and hypotheses 3 and 4 seem to be adequate considering hypotheses 1 to 4 the inner carcass and the pressure armor can be assumed orthotropic shells and considering the coordinated axes of fig 4 the stress strain relations in these layers are stated as 1 σ s x e s x 1 ν s x y ν s y x ε s x e s x ν s y x 1 ν s x y ν s y x ε s y σ s y e s y ν s x y 1 ν s x y ν s y x ε s x e s y 1 ν s x y ν s y x ε s y τ s x y g s x y γ s x y where σ s and τ s are respectively the normal and shear stresses at the shell surface ε s and γ s are respectively its elongation and angular distortion e s g s and ν s are in this order the young modulus the shear modulus and the poisson coefficient of the material that constitutes the shell and subscripts x and y designate the direction to which the mentioned values are related by hypotheses 1 and 2 the tendons do not resist to loads normal to their laying direction thus leading to e s y 0 and ν s x y ν s y x 0 and eq 1 can be rewritten 2 σ s x e s x ε s x σ s y 0 τ s x y g s x y γ s x y considering eq 2 the membrane e a s bending e i s and torsional g j s stiffnesses of the equivalent orthotropic shell are in this order given by timoshenko and woinowsky krieger 1959 3 e a s h s e s x e i s h s 3 12 e s x g j s h s 3 6 g s x y where h s is the thickness of the orthotropic shell assuming that the tendons of the inner carcass and the pressure armor have unsymmetrical cross sections their axial e a t bending e i t and torsional g j t stiffnesses can be stated as proposed by cook and young 1985 for straight bars but assuming a helicoidal shape for these tendons 4 e a t a n t l p e e i t k i y i y z tan λ n t l p e g j t j n t l p g where e and g are in this order the young modulus and the shear modulus of the material that constitute the tendon a i y i y z and j are respectively the cross sectional area lower second moment of area product of inertia and torsional constant of the tendon n t is the number of tendons in the considered layer which is generally 1 for the inner carcass and 1 or 2 for the pressure armor and l p is the linear pitch of the tendon 5 l p 2 π r tan α where r is the mean radius of the layer and α is the lay angle of the tendon the term in curly brackets in the bending stiffness equation eq 4 is often called the equivalent moment of inertia of the tendon i e q and k is a factor that depends on the lay angle and the moment of inertia of the section larsen et al 2014 relying on previous experimental tests de sousa et al 2009 souza 2002 muñoz et al 2016 employed the expression 6 k 12 n t 1 ν 2 i y i y z tan λ l p h 3 where h is the thickness of the tendon ν is the poisson coefficient of the material and λ is the angle between the neutral axis of the cross section and the centroidal yz axes presented in fig 4 and is given by 7 λ atan i y z i z it is worth remarking that in eqs 1 7 only bending with respect to the weaker axis is considered bending moments related to the stronger axis are assumed to be negligible equaling eqs 3 and 4 the equivalent physical and geometric properties of the orthotropic shell are 8 h s 12 i e q a e s x a n t l p h s e g s x y 6 j n t l p h s 3 g at this point the stress strain relations of the orthotropic shell are defined with eqs 2 and 8 the stiffness of the helical tendons and of the orthotropic shells as well as the acting axial forces n x bending moments m y and torsional moments m x can be made equal the normal and shear stress distribution in the carcass and pressure armor cross sections are thus stated respectively as 9 σ x y z n x a z y tan λ m y i e q l p n t τ x y l p h n t j m x where y and z are the coordinates of a point located in the cross section of the inner carcass or the pressure armor fig 4 the normal and shear stresses along the cross sections of the tendons can be directly obtained with eq 9 considering the axial forces and the bending and torsional moments calculated in the fe model finally the proposed approach is slightly different from the one proposed in de sousa et al de sousa et al 2009 as in the previous approach λ equals 0 and consequently the inclination of the section neutral axis is not considered in the strain stress calculation the effect of this assumption is discussed in section 4 4 2 2 polymeric layers representation the polymeric layers of flexible pipes are assumed thin to moderately thick cylinders and are modeled with reissner mindlin shell elements the polymeric sheaths have physical properties equal in all directions and therefore isotropic shell elements are used antiwear and fabric tapes are employed to minimize the effects of friction between layers and to avoid the extrusion of the polymeric sheaths in the voids between the metallic armors respectively moreover some pipes designed to operate in deep and ultra deep water depths also have polymeric bandages named high strength tapes which are employed to prevent the failure of the pipe by excessive axial compression all these tapes are wound at angles close to 90 and consequently are modeled with orthotropic shells moreover the high strength tapes resist only tension which introduces a nonlinear physical behavior to the fe model 2 3 tensile armor representation the helical wires of the tensile armors layers are modeled with three dimensional euler bernoulli beam elements as the width and the thickness of these wires are usually much smaller than their length moreover by hypothesis the wires are assumed to be rectangular shaped and perfectly conformed to the cylinder that supports them 2 4 modeling contact nonlinearities in the numerical modeling of flexible pipes contact elements are mainly used to ensure the interaction between layers by allowing their separation contact and relative displacements in case of contact excessive penetration between layers should also be avoided in this work however the layers of the pipe are modeled with shell and beam elements and their thicknesses are not directly represented the contact elements thus have an additional function which is to guarantee the radial stiffness equivalence between the actual pipe and its numerical model by relying on results presented by muñoz et al 2016 and de sousa et al de sousa et al 2009 2012 the interaction between the layers of a flexible pipe is established with contact elements that allow large relative displacement between these layers by using a contact detection algorithm based on the pinball technique and contact forces evaluated with the penalty method belytschko and neal 1991 the penalty method relies on the computation of penalty forces that are calculated by placing fictitious springs along the boundaries of two bodies in contact these forces are directly proportional to a penalty parameter called normal contact stiffness which corresponds to the stiffness of the springs the normal stiffness k n in this work is given by muñoz et al 2016 de sousa et al 2009 2012 10 k n i k n i k n i 1 k n i k n i 1 i 1 n l 1 where n l is the number of layers in the flexible pipe and 11 k n i e i a c i 1 ν i 1 2 ν i h i in this equation the poisson coefficient ν equals 0 if layer i is an armor or a polymeric tape the contact area between two layers a c i is approximated by 12 a c i 2 π r i n t l t n c d i n l d i i 1 n l 1 where r i n t n c d and n l d are respectively the interface radius and the number of circumferential and longitudinal divisions of the inner layer upon which the contact elements are placed and l t is the length of the model moreover friction between layers is addressed by considering the coulomb friction law which is written as 13 τ max τ o μ σ n where τ m a x is the limit shear stress τ o is the initial adhesion between the two surfaces in contact σ n is the normal contact stress and μ is the friction coefficient between the two surfaces the modeling of frictional behavior using the penalty method requires the definition of a tangential stiffness as some amount of slip has to be allowed in the stick phase the tangential stiffness k s for the contact elements of interface i may be expressed as saevik 2011 14 k s i f b e i a i r i n t 2 sin 2 α l t n l d i i 1 n l 1 where f b is a correction coefficient that enforces the plane surface remains plane condition during the stick phase in case of contact between an armor layer and a polymeric layer i relates to the armor layer in case of contact between two polymeric layers sheaths or tapes α equals 90 if not available it is worth remarking that high values of f b better approximate the plane surface remains plane condition in the stick phase but tend to introduce numerical difficulties in the analyses on the other hand lower values avoid numerical problems in the analyses but allow larger relative displacements between the supporting cylinder and the wires of the tensile armors saevik saevik 2011 suggests a f b of 0 08 in order to obtain the best compromise between numerical convergence and an accurate description of the stick slip behavior however in this work after few simulations a f b of about 9 was found adequate to ensure both the plane surface remains plane condition and numerical convergence finally four different types of interlayer contacts may be observed in a typical flexible pipe i e contact between an inner carcass and or pressure armor and a polymeric layer a polymeric layer and another polymeric layer wires of a tensile armor and a polymeric layer and finally two tensile armor layers in the fe model proposed in this work the first two types of contact can be dealt with surface to surface contact elements however the contact between the wires of a tensile armor and a polymeric layer or between tensile armor layers demand the use of line to surface or line to line contact elements respectively in numerical tests previously performed the use of these elements required great computational effort and often resulted in unconverged analyses therefore in order to overcome this difficulty an alternative approach is proposed dummy isotropic shell elements with very low bending and axial stiffnesses of about 10 5 of a metallic armor with the same thickness are used to fill the voids between the three dimensional beam elements that are used to model the wires of a tensile armor layer the contact between these wires and the surrounding polymeric layers is then ensured by employing surface to surface contact elements a detail of these elements is presented in fig 3 2 5 implementation and solution the described model was implemented in the in house fe mesh generator risertools and all generated meshes are analyzed in the commercial fe package ansys version 16 2 the model employs the nonlinear shell finite element shell181 to represent all layers of the pipe with exception of the tensile armors wires that are modeled with the nonlinear beam element beam188 contact elements conta174 and targe170 simulate the contact between all layers of the pipe typically the fe mesh of a flexible pipe has more than 100 000 degrees of freedom and nonlinearities have to be addressed in these cases ansys recommends the use of the sparse or direct solver method combined to equation reordering strategies which are internal to the software to solve the set of equations generated by the fe discretization previous tests with the proposed model using several fe meshes and iterative solvers such as the preconditioned conjugate gradient led to higher computational effort with the same accuracy 3 analytical model as discussed in section 1 analytical models have some limitations with respect to the analysis of damaged flexible pipes but these models may provide some insights into the extensional torsional response of these structures with this purpose the analytical model proposed by batista et al 1989 is used and slightly modified in this work to obtain closed form expressions for the stiffness coefficients and the strains in the carcass pressure and tensile armor layers of intact and damaged flexible pipes therefore in addition to the hypotheses assumed by batista et al 1989 the following hypotheses are also assumed here all layers remain in contact radial deformations are disregarded the contribution of the polymeric layers to the axial resistance of the pipe is negligible the core of the pipe is constituted of a pressure armor an internal sheath and an inner carcass and resists only radial loads the lay angles of the inner and outer tensile armor wires are equal but with opposite signs the absolute lay angle is α t moreover the wires are constituted by the same material with young modulus e and have the same cross sectional area a their mean radii are assumed equal to r t 3 1 intact pipe the extensional torsional response of a flexible pipe is usually expressed as ramos et al 2014 15 n x m x c 1 c 2 c 3 c 4 δ l l t δ ϕ l t where n x and m x are the imposed tensile and torsional loads respectively δ l and δ ϕ are in this order the axial elongation and rotation of the pipe c 1 and c 4 are respectively the axial and torsional effective stiffness of the pipe and c 2 and c 3 are called the coupling stiffness coefficients in this equation the terms related to the internal and external pressure as proposed by ramos et al 2014 are not considered to be consistent with the experimental tests described in section 4 2 considering all hypotheses the stiffness coefficients c 1 to c 4 may be written as 16 c 1 n i a n o a e a cos 3 α t 17 c 2 n i a n o a e a r t cos 2 α t sin α t 18 c 3 c 2 19 c 4 n i a n o a e a r t 2 cos α t sin 2 α t where n i a and n o a are respectively the number of wires in the inner and outer tensile armor layers of the intact pipe the normal strains ε x in the wires of the inner and outer tensile armor wires can be expressed as batista et al 1989 feret and bournazel 1987 20 ε x cos 2 α t δ l l t 1 2 r t sin 2 α t α α t δ ϕ l t it is also important to calculate the total axial force n t acting on a tensile armor layer which is given by 21 n t i 1 n w e a ε x i where n w is the number of wires in the layer if pure tension is imposed and the pipe is stretched without twisting i e δ ϕ 0 the relation between axial elongation and tension load is given by combining the first of eqs 15 and 16 22 n x n i a n o a e a cos 3 α t δ l l t the axial elongation δ l l t can be obtained with eq 22 and is employed in eq 20 to obtain the strains in the inner and outer tensile armor wires the strain ratio is defined in this work as the variation of the strains in the wires with the applied load eq 23 indicates strain ratios for the inner and outer tensile armor layers ε x i a r and ε x o a r equal to 23 ε x i a r ε x o a r 1 n i a n o a e a cos α t moreover the total loads acting on the inner n t i a and outer n t o a tensile armor layers can be obtained by combining eqs 20 22 24 n t i a n i a n x n i a n o a cos α t n t o a n o a n x n i a n o a cos α t in a second load case the axial elongation δ l l t is constant and the pipe is submitted to clockwise and anticlockwise twist the relation between the torsional moment and the imposed twist is derived with the second of eqs 15 considering eqs 16 19 25 m x n i a n o a e a r t cos 2 α t sin α t δ l l t n i a n o a e a r t 2 cos α t sin 2 α t δ ϕ l t the first term in this equation is constant and corresponds to the reaction torque due to the imposed tensile load the second term in brackets is the torsional stiffness of the pipe the inner and outer strains in the tensile armor wires can be calculated with eq 20 considering the twist computed with eq 25 moreover by assuming that the inner wires have a positive lay angle and the outer wires have a negative lay angle the strain ratios in these wires are given by 26 ε x i a r 1 n i a n o a e a r t sin α t ε x o a r ε x i a r the total load acting on the tensile armor layers in this case can be calculated by combining eq 25 with eqs 20 and 21 leading to 27 n t i a 2 n o a n i a n i a n o a cos 2 α t e a δ l l t n i a n i a n o a r t sin α t m y z n t o a 2 n i a n o a n i a n o a cos 2 α t e a δ l l t n o a n i a n o a r t sin α t m y z the first terms in eq 27 are constant and therefore the variation of the total axial force is caused by the variation of the second term which is related to the imposed torsional loads the tensile and torsional loads deform the tensile armor wires which consequently squeeze the core of the pipe relying on the expression for the pressure differential through each layer proposed by feret and bournazel 1987 the squeeze pressure variation with the imposed load p s q r may be written as 28 p s q r e a sin α t tan α t 2 π r t 2 n i a ε x i a r n o a ε x o a r where ε x i a r and ε x i a r are given by eq 23 or 26 if pure tension or torsion combined with tension are imposed on the pipe respectively the strain ratios in the inner carcass and the pressure armor ε x i c r and ε x p a r may be approximated by 29 ε x i c r r i c e s x i c h s i c δ p i c r 30 ε x p a r r p a e s x p a h s p a δ p p a r where r is the mean radius of the layer and e s x and h s are given by eq 8 the subscripts i c and p a refer to the inner carcass and the pressure armor respectively the pressure differential variation in each layer δ p i c r and δ p p a r are written as 31 δ p i c r ρ p a ρ i c p s q r 32 δ p p a r 1 ρ p a p s q r where 33 ρ p a ρ p a 1 ρ p a 1 ρ p a 2 34 ρ i c ρ i c 1 ρ i c 2 where 35 ρ p a 1 e i p h i p r p a r p a h s p a 2 1 ν i p e s x p a h s p a r i p r i p h i p 2 36 ρ p a 2 1 v i p r i p r i p h i p 1 ρ i c v i p h i p r i p h i p 37 ρ i c 1 1 1 ν i p 1 ν i p r i p ν i p h i p r i p h i p 38 ρ i c 2 1 1 ν i p e i p h i p r i c r i c h s i c 2 1 ν i p e s x i c h s i c r i p r i p h i p 2 and the subscript i p refers to the inner plastic sheath 3 2 damaged pipe assuming that the number of intact inner and outer wires are n i a d and n o a d respectively and moreover considering that these wires are uniformly distributed along their supporting layers the stiffness coefficients of the damaged pipe may be written as 39 c 1 d n i a d n o a d n i a n o a c 1 40 c 2 d n i a d n o a d n i a n o a c 2 41 c 3 d c 2 d 42 c 4 d n i a d n o a d n i a n o a c 4 in this work the ratio between a damaged and an intact stiffness coefficient is named normalized stiffness coefficient which corresponds to the terms in parenthesis in eqs 39 42 by considering eqs 23 and 26 the strain ratios in the inner ε x i a r d and outer ε x o a r d tensile armor wires may be written as 43 ε x i a r d n i a n o a n i a d n o a d ε x i a r ε x o a r d n i a n o a n i a d n o a d ε x o a r the strain concentration factors scfs are defined as the ratio between the strain ratios in the damaged and intact conditions for the inner and outer tensile armor wires the scfs correspond to the terms in parenthesis in eq 43 by observing eqs 29 38 the strain ratios in the inner carcass and the pressure armor are given by the ratio between the squeeze pressures acting on the damaged and intact pipe in case of pure tension the combination of eqs 23 and 28 shows that these pressures do not vary with the number of wires in the tensile armor layers on the other hand if torsion is considered the combination of eq 26 with eq 28 shows that the squeeze pressure depends on the number of wires the strain ratios in these layers are thus given by 44 ε x i c r d ε x i c r 1 0 n x 0 and m y z 0 n i a n o a n i a d n o a d n i a d n o a d n i a n o a m y z 0 ε x p a r d ε x p a r 1 0 n x 0 and m y z 0 n i a n o a n i a d n o a d n i a d n o a d n i a n o a m y z 0 the scfs in the inner carcass and the pressure armor are equal and given by the expressions in curly brackets in eq 44 finally the non dimensional total acting force variation on a tensile armor layer is defined as the variation of the total acting force δ n t on a tensile armor layer considering a damaged condition in the pipe divided by the force in the layer assuming the intact condition regardless the load case eq 24 or 27 the non dimensional forces acting on the inner δ n t i a d or outer δ n t o a d armor layers are 45 δ n t i a d n i a n o a n i a d n o a d n i a d n i a δ n t i a δ n t o a d n i a n o a n i a d n o a d n o a d n o a δ n t o a 4 case study 4 1 description the response of a 9 13 internal diameter of 232 mm flexible pipe to tension and torsion is studied in this work the pipe has nine layers including a stainless steel inner carcass yield stress of 510 mpa a pressure armor of high carbon steel yield stress of 900 mpa and two pairs of tensile armors of high carbon steel yield stress of 1260 mpa the inner tensile armor layer has 63 wires laid with an angle of 30 while the outer tensile armor layer has 66 wires laid with an angle of 30 the wires have approximated rectangular cross sections with 4 mm in height and 12 mm in width moreover the pipe has a free span of 5 37 m which is equivalent to 3 3 linear pitches of the outer tensile armor wires more details on the flexible pipe structure can be obtained in londoño et al 2014 two different load cases are considered pure tension the pipe is tensioned until a maximum load of 1000 kn is reached this load is approximately 17 of the estimated damaging pull of the pipe after that three load cycles with total amplitude of 200 kn and mean value of 800 kn are applied in this case one end of the pipe is fixed and the other is only allowed to elongate torsion combined with tension a pre tension of 1000 kn is imposed by prescribing an axial displacement to one of the pipe s extremities this axial displacement is kept constant during the test an anticlockwise twist of 6 0 1 117 m is then applied followed by three load cycles with total amplitude of 4 0 0 745 m and mean value of about 2 0 0 372 m after that the torsional load is reversed and the same loads are imposed on the pipe it is worth mentioning that in this pipe anticlockwise torsional moments tight the wires of the outer tensile armor layer whilst clockwise torsional moments tight the wires of the inner armor each of these tests were performed considering the structure intact and with 1 up to 10 wires broken in its outer tensile armor layer 4 2 experimental tests aiming at simulating the load cases described in section 4 1 a sample of the 9 13 flexible pipe was installed in the experimental apparatus presented in fig 5 a and schematically with all instrumentation in fig 5b this apparatus consists of two hydraulic actuators tensile and torsional loads can be simultaneously imposed on the pipe tensile loads are applied by a hydraulic actuator connected to one of the pipe s ends as shown in fig 5 this actuator has a total load capacity of 1000 kn another hydraulic actuator is linked to a torque arm that is connected to the opposite end of the pipe as also shown in fig 5 this arm imposes a total torsional load up to 15 knm on the pipe three displacement transducers f1 f2 and f3 in fig 5 two transducers f2 and f3 were used to measure the axial displacements of the pipe these transducers were fixed to one of the end fittings of the pipe as shown in fig 5 two nylon yarns are attached to these transducers and fixed to the opposite end fitting thus measuring the axial relative displacements between them another transducer f1 was positioned at the mid section of the pipe in order to measure its transverse displacement three inclinometers a1 a2 and a3 in fig 5 these inclinometers were fixed to metallic plates and linked to the ends of the flexible pipe by magnetic bases two inclinometers were fixed on the torsional actuator and the third on the axial actuator these inclinometers measured the twist angle of the pipe strain gages part of the outer plastic sheath was removed around the mid section of the pipe thus exposing the outer tensile armor wires strain gages were mounted in each wire of this armor as shown in fig 6 a and in this section one up to ten wires of the outer armor layer i e 0 up to 15 of its wires were cut with the help of a die grinder when three neighbor wires were broken all wires of the inner tensile armor layer were exposed and a strain gage was fixed on each of them as indicated in fig 6b therefore the strains in the wires of the inner layer could also be monitored finally as the loads were applied with very low rates dynamic effects on the response of the pipe may be neglected 4 3 numerical model in all numerical analyses a fe mesh with a total length of 5 37 m is employed after performing several mesh tests the layers of the pipe are discretized with 66 finite elements along the circumference and 214 elements along their length the exceptions are the inner tensile armor layer and the associated dummy shell elements which were discretized with 63 elements along the circumference and 214 elements along their length the employed fe mesh has 154 802 nodes and 491 672 elements leading to 755 298 degrees of freedom loads and boundary conditions equivalent to those employed in the load cases described in section 4 1 were imposed on nodes positioned in the axis of the pipe and at its extremities as shown in fig 3b these nodes are rigidly linked to the nodes of the correspondent cross section of the pipe thus simulating perfect end fittings i e end fittings inside which all armors are perfectly anchored furthermore tensile loads are imposed on one extremity of the model and torsional loads are applied in the opposite one in order to simulate the experimental tests the pure tension analyses were carried out with a single load step while the torsional analyses involved two load steps as the pipe is pre tensioned during the experimental tests all analyses were conducted considering an initial first load increment equivalent to 1 of the total load and this value is automatically adjusted during the analysis depending on the convergence of the model minimum and maximum load increments equivalent to 0 1 and 10 of the total load were admitted analyses with the intact pipe take few minutes while analyses with the damaged pipe depending on the number of load steps may take about 10 h to be run on an intel i7 4 0 ghz machine with 8 cores and 32 gb of ram an important aspect of the numerical model is to properly represent the interaction between all layers of the flexible pipe the numerical model proposed here employs the coulomb friction law eq 13 but there are significant uncertainties in selecting the friction coefficient to be used in the local analysis of flexible pipes api 2014a typically values between 0 05 and 0 30 are employed in local analysis models after performing few numerical simulations with different friction coefficients and comparing the load vs displacement curves obtained with those from the experimental tests no initial adhesion and a friction coefficient of 0 07 was considered between all layers of the pipe finally the damages to the pipe are located at the same positions of the experimental tests mid section of the pipe and in neighbor wires of the outer tensile armor one finite element of each damaged wire has their stiffness matrix multiplied by a small number 10 6 i e the element is deactivated while the stiffness matrices of all other elements are kept unchanged 4 4 results 4 4 1 pure tension fig 7 presents the tension vs axial elongation curves obtained in the experimental tests and with the fe and the analytical eq 22 models considering 0 intact and ten wires broken in the outer tensile armor layer of the flexible pipe these curves indicate a linear relation between the axial elongation and the imposed tensile load in the experimental tests during the load cycles a small hysteresis loop is observed but the responses during loading or unloading are quite well predicted by fitting linear regression curves to these points similar curves were also obtained in all other conditions and table 1 summarizes the related axial stiffnesses c 1 this table indicates that the axial stiffnesses calculated with the fe and the analytical eq 16 and 39 models are very close to those obtained in the experimental tests fig 8 presents the variation of the normalized axial stiffness with the number of wires broken in the outer armor layer the experimental tests indicate a scattered variation but the axial stiffnesses tend to slightly decrease with the increasing number of broken wires the axial stiffness of the pipe with ten wires broken is only 7 lower than the intact value moreover the fe and the analytical models correlate quite well with the experimental normalized stiffness table 1 also presents the numerical and analytical eq 18 values for the stiffness coupling coefficient c 3 this table shows that the analytical and the numerical values differ significantly the analytical model assumes that each layer of the pipe has the same axial translations and rotations in each cross section however as discussed in muñoz et al 2016 generally this is only confirmed by the fe model at the ends of the pipe where all layers have their displacements coupled due to the presence of end fittings or if relative sliding is not allowed between layers due to friction in all other cross sections and or for other interlayer friction conditions the inner carcass the pressure armor and the polymeric layers tend to have the same axial translations and rotations but the tensile armors slide relatively to these layers and consequently the induced axial translations and mainly axial rotations are different from those predicted by the analytical model eq 18 shows that the stiffness coefficient c 3 is directly proportional to the difference between the number of inner and outer tensile armor wires in the intact condition this coefficient is small and negative as the outer armor layer has few more wires than the inner layer and consequently the pipe is approximately torque balanced moreover the induced torque elongates the outer tensile armor wires and compresses the inner wires this equation also indicates that initially if few wires are broken the pipe becomes more balanced and no torque is induced when the number of outer tensile armor wires equals the number of inner wires fully balanced pipe however an increase in the number of broken wires leads to a reversal in the induced torque associated with an increasing extensional torsional unbalance in this case the induced torque becomes positive elongates the inner tensile armor wires and compresses the outer wires this response can be observed in table 1 and also in fig 9 which presents the variation of the normalized numerical and analytical eq 18 stiffness coefficient c 3 with the number of broken wires in the outer armor layer as can be depicted in fig 9 the analytical and the fe models show a reversal of the induced torque but with a nonlinear variation with the number of broken wires in the fe model and with a linear variation in the analytical model this nonlinear response of the fe model may be attributed to the clustered distribution of the damage in the outer armor layer while the analytical model assumes a uniformly distributed damage in this layer it is also worth remarking that significant changes are observed in the coupling coefficient even if few wires are broken however this variation does not mean that the induced torques are high the fe model estimates a torque variation of only 0 6 knm during the load unload cycles in the intact pipe and of 1 4 knm when the pipe has ten wires broken the maximum value is about 2 of the cyclic torsional loads imposed on the pipe which will be discussed in the next section during the experimental tests several attempts to measure this variation were tried but the internal friction of the actuators and the precision of the load cells combined with the low values of the induced torques led to curves with no clear tendencies and therefore the experimental stiffness coefficients c 3 are not presented here however it is recognized that this point should be addressed in future studies in all conditions the fe model eq 23 and the experimental tests indicate that the strains in the wires vary linearly with the imposed tensile load therefore fig 10 presents the strain ratios in the outer tensile armor wires considering the pipe intact this figure indicates that the experimental strain ratios vary from wire to wire the average strain ratio considering all wires is 0 85 μm m kn with a standard deviation of 0 14 μm m kn the fe and the analytical models predict that all wires are equally loaded and strain ratios of 0 88 μm m kn and 0 91 μm m kn were calculated respectively these values are close to the experimental average a possible explanation for the different strain ratios obtained in the experimental tests is the different anchoring conditions of the wires inside the end fittings as discussed in de sousa et al de sousa et al 2013 moreover the fe model estimates strain ratios of 0 92 μm m kn for the inner tensile armor wires 0 13 μm m kn for the pressure armor and 0 10 μm m kn for the inner carcass while the analytical model indicates strain ratios of 0 91 μm m kn for the inner tensile armor wires eq 23 0 12 μm m kn for the pressure armor eq 30 and 0 10 μm m kn for the inner carcass eq 29 fig 11 presents the variation of the scfs in the wires of the outer tensile armor layer in the damaged section mid section of the pipe and table 2 points the maximum scfs associated with each analyzed case this figure and table indicate that in all cases the strains and consequently the stresses in the wires close to those broken are considerably higher than the strains obtained in the intact condition these strains however decrease and values lower than those observed in the intact case are observed in wires far from the damaged wires maximum experimental scfs varying between 1 092 one wire broken and 2 140 10 wires broken were measured the fe predictions agreed well with the experimental values and also indicate negligible bending normal and binormal strains in the wires discrepancies between the estimated values and the experimental measurements can possibly be attributed to the wires anchoring conditions and furthermore to local changes in the geometry of the wires as can be observed for instance in fig 6b where two outer wires are clearly far from their original position when compared to fig 6a this very large relative displacement which was also perceived in the unloaded condition was not captured by the fe model and may be related to the cyclic loading imposed on the pipe furthermore eq 43 predicts much lower uniform elevations in the strains of the outer tensile armor wires which are not consistent with the nonlinear variation observed in the tests and in the fe model this difference can be attributed to the hypothesis of uniform damage distribution in the analytical model and evidences that the spatial distribution of the broken wires affects the scfs in the layer these points also deserve future studies fig 12 presents the variation of the scf along six different wires of the outer tensile armor layer wires 26 to 31 considering 10 wires broken in this layer wire 26 corresponds to the intact wire close to the damage and wire 31 is the damaged wire more distant from the intact wires this figure indicates that the damaged wires recover part of their load capacity due to the friction between them and the surrounding layers and on the other hand the strains in the intact wires reduce from a maximum in the damaged cross section to lower values close to the extremities of the pipe this recovery affects the stiffness and coupling coefficients of the pipe as indicated in table 1 for friction coefficients of 0 07 0 10 and 0 20 the axial stiffness of the pipe is slightly modified but the coupling coefficients are deeply affected and this is a key aspect for monitoring systems that rely on the twist angle variation to detect damages in the tensile armor wires of flexible pipes similar conclusions were obtained for all other conditions eq 41 indicates that the rupture of the outer tensile armor wires increases the total force acting on the inner tensile armor layer and on the contrary reduces the total force imposed on the outer layer table 3 confirms this response by presenting the normalized total loads in the outer and inner tensile armor layers obtained with the fe and analytical models eq 45 and measured in the experimental tests in these tests only the total load in the outer armor is available the experimental tests point to a decrease in the total load acting on the outer tensile armor layer with scattered distribution which nevertheless agreed relatively well with the fe and the analytical values the increase in the total load acting on the inner layer predicted by the fe model was also close to the values estimated with the analytical model it is worth observing that the tensile armor layers uniformly squeeze the core inner carcass pressure armor of a flexible pipe under tension and the deformed structure maintains a constant curvature muñoz et al 2016 however a broken wire does not squeeze the core and the resulting squeeze pressure is thus not uniform this uneven pressure distribution deforms the core of the pipe in the damaged region as shown in fig 13 leading to a local change in curvature moreover eq 43 indicates that the normal strains in the wires of a tensile armor layer are inversely proportional to the total number of intact wires in the pipe and consequently the rupture of the outer wires increases the normal strains in all wires of the inner layer altogether the effect of the rupture of wires in the outer tensile armor in the inner layer is twofold i e it increases the normal strains in all wires of the layer global effect and induces bending strains in the wires close to the damaged region local effect fig 14 presents the distributions of the fe scfs in each wire of the inner tensile armor layer and at the mid section of the pipe damaged section these values correspond to the strains measured in the outer fibers of the inner wires this figure indicates that the higher strains occur in wires below the damaged region and about half distance between the first intact wires of the outer layer the maximum scf vary from 1 020 1 wire up to 1 222 10 wires and result from a combination of the local change of curvature and global increase of the normal strains effects in the wire on the other hand the scfs in wires far from the damage which are mainly associated with the global effect vary between 1 005 1 wire and 1 151 10 wires table 4 summarizes the fe scfs obtained in each case analyzed as well as the factors exclusively related to the increase in the normal strains moreover the scfs predicted using eq 43 are also presented the analytical values are exclusively related to the increase in the normal strains in the wire global effect and agree well with the fe scf in wires far from those damaged as the maximum difference observed is of 5 4 when 10 wires are broken however the maximum values which include the local effect captured by the fe model in wires close to the damage may differ significantly in this case differences up to 13 4 are observed when 10 wires are broken in the experimental tests the inner tensile armor layer could only be assessed when 3 wires of the outer layer were cut and considering this condition the strain gages were mounted on all inner wires at half distance between the first intact wires as indicated in fig 6b as these strain gages maintained the same relative position with respect to the first intact wires in all conditions analyzed the same strains possibly with very small variations were expected to be measured by all these gages in each test fig 15 illustrates the strain ratios measured in the experimental tests considering three wires broken in the outer armor layer as well as the values predicted by the fe and the analytical models the experimental values vary from wire to wire because these wires like the outer armor wires may be subjected to different anchoring conditions de sousa et al 2013 the average strain ratio equals 0 90 μm m kn with a standard deviation of 0 09 μmm mm kn the fe and the analytical models predict constant strain ratios that are equal to 0 97 μm m kn and 0 93 μm m kn respectively these values are close to the experimental average value in this work for the sake of comparison the scf for the inner tensile armor wires were calculated by dividing the strains obtained in the analyses with 4 or more wires broken in the outer tensile armor layer and the strains obtained in the condition with 3 wires broken in this layer as the inner layer in the experimental tests could not be assessed before these 3 wires were cut fig 16 thus presents the scfs obtained in the experimental tests and those predicted by the fe and the analytical models this figure and table 4 indicate that the scfs measured in the experimental tests had a small dispersion with respect to their average value furthermore the experimental values agreed quite well with the maximum fe scfs but may differ significantly from the analytical scfs especially if several wires are broken altogether these aspects confirm the importance of considering the local change of curvature in the response of the inner wires when the outer tensile armor wires are broken the deformation of the pipe s core leads to significant bending moments in the inner carcass and the pressure armor fig 17 presents the normalized bending moment distributions along the inner carcass and the pressure armor values are normalized with respect to the maximum bending moments in each layer this figure indicates that the outer fibers of both layers are tensioned red zones in the regions below the damaged tensile armor wires while the neighbor regions are compressed blue zones it is worth remarking that these bending moments reduce as points more distant from the damaged region are observed due to the partial recovery of the damaged wires load capacities fig 17 shows a reduction in the induced bending moments of about 40 near the ends of the pipe these bending moments induce high scfs in the inner carcass and the pressure armor fig 18 presents the scfs observed along the outer and middle fibers of these layers and in the damaged region the scfs in the middle fibers which are associated with the increase in the normal strains varied between 0 7 one wire broken and 9 9 ten wires broken in the inner carcass and between 0 4 one wire broken and 5 0 ten wires broken in the pressure armor these strain concentrations occur below the damaged region at points far from the damaged region there is no significant variation in the normal strains which is in accordance with the analytical model eq 44 the maximum scfs in the outer fibers are much higher than those observed in the middle fibers but very similar in both layers as the inner carcass and the pressure armor are initially under compression the rupture of 1 wire decreases the strains in the outer fibers however as the number of wires broken increase the maximum strains in these fibers substantially increase the rupture of 10 wires leads to a maximum scf in the outer fibers of about 7 0 in both layers these very high scf are however localized and vary in the extreme fibers of the inner carcass and the pressure armor due to their unsymmetrical cross sections fig 19 presents the expected variation of the scf in these cross sections when 10 outer tensile armor wires are broken both the inner carcass and the pressure armor indicate that the maximum scf occurs close to the mid point of their extreme surfaces y 0 z h 2 fig 4 in the inner carcass this point would present higher scfs but it does not belong to the cross section while in the pressure armor the scf at this point is lower than the one indicated in fig 18 the use of the strains or stresses at the mid point of the cross section is a common assumption of models that rely on equivalent cross sections and therefore depending on the shape of the cross section may lead to slightly conservative values for the inner carcass and slightly unconservative values for the pressure armor 4 4 2 torsion combined with tension in this work clockwise positive and anticlockwise negative torsion were superimposed to a tensile load with the axial elongation restrained at both extremities anticlockwise torsion tensions the outer tensile armor wires and tights the studied flexible pipe while clockwise torsion tensions the inner wires and separates the tensile armor layers however the imposed tensile load was high enough to maintain all layers in contact and therefore the responses of the pipe to anticlockwise and clockwise torsions are expected to be close fig 20 a and fig 20b show that the twist per unit length in the intact and damaged 10 wires broken pipe varies linearly with the imposed torsional load the hysteretic loops observed during both the clockwise and anticlockwise load cycles in the experimental tests can be approximated with linear regression curves and the obtained torsional stiffnesses c 4 are presented in table 1 for all cases this table indicates a very good agreement among the numerical analytical eq 19 and experimental values moreover the anticlockwise and the clockwise stiffnesses are also close due to the imposed tensile load which avoids the separation between the tensile armor layers as in the case of pure tension the variation of the experimental normalized anticlockwise and clockwise torsional stiffnesses is slightly scattered but tends to decrease with the increasing number of broken wires as shown in fig 8 the fe and the analytical models predict normalized stiffnesses close to those measured in the experimental tests and these values are also similar to those obtained in the pure tension analyses table 1 also presents the numerical and analytical eq 17 values for the stiffness coupling coefficient c 2 this table indicates that the c 2 and c 3 fe values for the intact pipe are very close and the stiffness matrix eq 15 of the pipe can be assumed symmetric however when the pipe is damaged significant differences are observed in the clockwise and anticlockwise c 2 and between these values and c 3 leading to an unsymmetric stiffness matrix eq 15 the analytical model assumes that this matrix is always symmetric and analogously to what was observed in the pure tension analyses the analytical values of c 2 differ from the fe values due to the different assumptions on the relative slide of the pipe s layers however all models indicate that the pipe is more balanced if few wires are broken but if more than 3 or 5 wires are ruptured there is a significant increase in the extensional torsional unbalance again it is important to remark that the axial force induced by the imposed torsion is in all cases very small and difficult to measure as discussed in section 4 4 1 the strains in the outer tensile armor wires varied linearly with the imposed torsional loads and fig 21 presents the distribution of the strain ratios in these wires along the mid section of the intact pipe the experimental strain ratios vary from wire to wire but the anticlockwise values are more scattered than the clockwise ones in average the experimental anticlockwise strain ratio is 10 47 μm m knm with a standard deviation of 1 18 μm m knm while the experimental clockwise strain ratio is slightly higher and equals to 10 79 μm m knm with a standard deviation of 0 57 μm m knm the fe model estimates anticlockwise and clockwise strain ratios for the outer armor wires of 10 39 μm m knm and the analytical model eq 26 predicts 10 56 μm m knm all these values are close to the experimental ones the fe model also calculated a strain ratio of 10 78 μm m knm for the inner tensile armor wires and eq 26 indicates 10 56 μm m knm for both the clockwise and anticlockwise torsion neither the inner carcass nor the pressure armor had their stress states significantly altered by the torsional loads as indicated by eqs 29 and 30 and also by the fe model fig 22 presents the variation of the scfs in the wires of the outer tensile armor layer in the mid section damaged section of the pipe table 2 resumes the maximum scfs obtained in each case the experimental tests and the fe model show that the clockwise and the anticlockwise torsional scfs are close the maximum scf always occur in the wires close to the damaged ones but the measured strains reduce to values slightly lower than those obtained in the intact case in wires distant from those damaged the experimental tests indicate that the rupture of 1 wire of the outer armor increases the strains in the neighbor wires by 11 13 while the rupture of 2 wires increases the strains by 22 24 and the rupture of 10 wires approximately doubles the strains in the wires close to the damage the fe scfs correlate quite well with the experimental values while the analytical scfs eq 43 are not consistent with the experimental ones as discussed in section 4 4 1 furthermore the fe model presented negligible normal and binormal bending strains in the outer tensile armor wires in all cases and the effect of friction was very similar to the effect observed in the pure tension analyses the normalized total loads in the outer and inner tensile armors are presented in table 3 for both torsional conditions analyzed and as observed in the pure tension analyses there is a reduction in the total load acting on the outer tensile armor layer and an increase in the total load imposed on the inner layer moreover there is no difference in the acting total loads due to clockwise or anticlockwise torsion and the normalized loads are close to those obtained in the pure tension analyses fig 23 presents the fe distribution of the scfs in the outer fibers of the inner tensile armor wires along the damaged section of the pipe as discussed in section 4 4 1 the rupture of wires in the outer armor layer has global and local effects on the wires of the inner layer the normal strains in the wires of the inner layer increase due to force redistribution global effect and normal bending strains develop in wires below the damaged region of the outer layer due to the deformation of the pipe s core local effect in the case of anticlockwise torsion there is an increase in the compressive normal strains in the inner layer however below the damaged region tensile bending strains arise in the outer fibers of the inner wires due to the increase of the uneven squeeze pressure imposed by the tensile armors on the inner carcass and the pressure armor if less than 3 wires are broken the local effect governs the strains in the wires and the scfs below the damaged region decrease with the number of broken wires on the other hand if more wires are broken the global effect prevails and the scfs increase in the case of clockwise torsion tensile strains are induced by force redistribution but as the squeeze pressure imposed by the tensile armor layers are reduced due to the tendency of layer separation compressive strains also arise in the outer fibers below the damaged region therefore clockwise and anticlockwise torsion have similar responses table 4 summarizes the fe scfs below the damaged region and the factors associated with the increase in the normal strains the increase of the normal strains with respect to the intact condition vary from about 0 5 1 wire broken up to 15 10 wires broken while below the damaged region the strains reduce 2 4 when 3 wires are broken and if ten wires are broken in the outer layer the strains are about 9 higher than the values observed in the intact condition moreover the scfs predicted using eq 43 are also presented as the analytical model does not capture the local effect of the wire s damage in the outer layer only the increase in the normal strains is predicted the analytical values are close to those estimated by the fe model for wires far from the damage below the damaged region in the outer tensile armor layer the analytical and the fe scfs also agree quite well but in this region the fe model captures the local effect that reduce the strains in these fibers while the analytical model does not therefore if more wires are broken these values would probably tend to diverge fig 24 illustrates the strain ratios measured in the experimental tests considering 3 wires broken in the outer armor layer and the values predicted by the fe and the analytical models the experimental values vary from wire to wire as discussed in section 4 4 1 in the anti clockwise tests the average strain ratio equals 9 35 μm m knm with a standard deviation of 0 72 μm m knm in the clockwise tests the average value is 10 20 μm m knm with a standard deviation of 0 74 μm m knm the fe and analytical models indicate respectively 10 60 μm m knm and 10 82 μm m knm the experimental scfs for the inner wires were calculated by dividing the strains obtained in the tests with 4 or more wires broken in the outer tensile armor layer and the strains obtained in the condition with 3 wires broken in this layer fe and analytical scfs were also computed according to this definition and are presented in fig 25 and table 4 which indicate that the experimental values agreed well with the fe and the analytical predictions but the analytical scfs tend to be lower than the experimental and fe ones finally the fe model and eqs 29 30 and 44 indicates that the clockwise and anticlockwise torsional moments do not significantly modify the normal strains in the inner carcass and the pressure armor of the damaged flexible pipe however the local change of contact pressures between layers leads to a local change of curvature and consequently bending strains are induced in these layers the distributions of the bending moments and bending strains are quite similar to those observed in the pure tension analyses figs 17 and 18 but the scfs to these layers are not meaningful as the strains induced by torsion in the inner carcass and the pressure armor of the intact pipe are almost negligible therefore fig 26 shows the strain ratios in the outer fibers of these layers along the damaged region of the flexible pipe it is worth remarking that the anticlockwise and clockwise strain ratios are almost equal and the curves presented in fig 26 refer to both loads this figure indicates that in the damaged section the strain ratios are negative thus leading to compressive strains if clockwise torsion is imposed and otherwise tensile strains if anticlockwise torsion is imposed tensile strains are related to an increase in the curvature radius of these layers while compressive strains indicate a decrease in the curvature radius this mechanism as discussed previously affects the strains in the inner tensile armor wires 5 load capacity curves as discussed in section 4 4 the analytical and fe models agreed with the experimental measurements when the pipe was intact but while the response of the damaged pipe was quite well predicted by the fe model the analytical model failed to capture local stress changes however the analytical model has a much lower computational cost when compared to the fe model and its use if modified to account for these local effects would be attractive in this section therefore the analytical model is modified to calculate the tension vs torsion load capacity curves for the studied flexible pipe considering intact and damaged conditions these curves are obtained by combining the intact analytical response with the scfs calculated with the fe model to obtain utilization factors equal to those stablished by api spec 17j api 2014b api spec 17j api 2014b initially states that the utilization factors for the metallic layers are given by the ratio between the average stress in the layer and its structural capacity the average stress is estimated by uniformly distributing the total layer load among its wires or tendons and the structural capacity is the yield stress of the material that constitutes the layer or 0 9 times its ultimate tensile strength if the pipe is assumed to be installed in a water depth higher than 900 m under normal operating conditions and if recurrent functional and environmental loading is also assumed the utilization factors for the inner carcass pressure armor and tensile armors are 0 85 0 67 and 0 67 respectively the experimental and fe results presented in section 4 4 however indicate that the rupture of the tensile armor wires induces local stress concentrations in the metallic layers along the damaged region these local stresses are much higher than the average stress in the layer and if average stresses were employed to calculate the utilization factors in the metallic layers very unconservative results would be obtained for instance if the pipe was subjected to pure tension and ten wires were broken in their outer tensile armor layer the average stress in this layer would be 8 4 higher than the value calculated in the intact analysis while the experimental tests and the fe model show that the wires near to the damage have their stresses raised by about 100 if these wires fail and the imposed tensile load is maintained the adjacent wires would probably break leading to a progressive reduction in the overall structural capacity of the pipe and finally to its failure in cases that local wire stresses exceed the average stress in the tensile armor layer api api 2014a api 2014b recommends the use of these local stresses in the investigation of the associated potential damage mechanisms in the wire which are typically related to extreme and or abnormal operating conditions of the pipe these extreme stresses should not result in maximum local stresses higher than the material yield stress and or unacceptable deformations or crack initiation at any location in the armor wire cross section thus avoiding a possible progressive failure of the pipe in this work therefore this criterion is addressed by writing the utilization factor f u in a metallic layer in the form 46 f u max s c f n m e f ε x n r n x max s c f m m e f ε x m r m x ε y where ε y is the yield strain of the material that constitutes the metallic layer max s c f n m e f and max s c f m m e f are the maximum strain concentration factors calculated by the fe model for each metallic layer of the flexible pipe and induced by tensile and torsional loads respectively ε x n r and ε x m r are the strain ratios in each metallic layer due to the tensile and torsional loads respectively the strain ratios in the tensile armors are given by eq 23 tension and eq 26 torsion while eqs 29 and 30 are used to compute the strain ratios in the inner carcass and the pressure armor it is important to remark that eq 46 does not account for residual stresses in wires due to manufacturing and fat factory acceptance test but utilization factors associated with normal operating conditions api 2014b are assumed in this work for sake of conservatism furthermore as the analytical model does not account for layer separation the load capacity curves are calculated assuming only positive values for the squeeze pressure eq 28 and tensile strains in the outer tensile armor layer considering all these conditions fig 27 presents the load capacity curves obtained considering 0 intact up to 10 wires broken in the outer tensile armor layer of the 9 13 flexible pipe the internal region of all curves presented in fig 27 corresponds to the safe operational zone while the external region is the unsafe zone this figure indicates that for negative anticlockwise torsional moments the limit loads are governed by the response of the damaged outer tensile armor layer as its wires are tensioned by these moments if less than 5 wires are broken in the outer layer the tensile load reaches a peak but with increasing positive clockwise moments being imposed on the pipe the inner layer is tensioned and governs the response of the pipe the allowable tensile load thus decreases until layer separation and or compression in the outer layer occur if more than 5 wires are broken the tensile load is limited by excessive bending stresses in the pressure armor of the pipe until layer separation occurs or compressive stresses arise in the outer layer 6 final remarks the extensional torsional response of a flexible pipe with broken outer tensile armor wires was investigated with a modified version of the fe model proposed by de sousa et al de sousa et al 2009 and a simplified analytical model the results obtained with these models were compared to those from experimental tests in which pure tension and anticlockwise and clockwise torsion were imposed on the pipe the rupture of wires in the outer tensile armor layer led to a decrease in the axial tensile or torsional stiffness of the pipe associated with a progressive extensional torsional unbalance the decrease in the axial stiffness is approximately proportional to the ratio between the number of intact wires in the damaged pipe and the total number of wires in the intact pipe the extensional torsional balance is related to the ratio between the difference in the number of intact wires in the inner and outer tensile armors of the damaged pipe and the same difference in the intact pipe therefore when few outer tensile armor wires were broken the pipe became more balanced but the rupture of more wires increased the extensional torsional unbalance significantly it is also worth remarking that friction between layers is an important parameter to predict the extensional torsional unbalance of the damaged pipe the damaged wires tend to recover part of their loading capacity along the length of the pipe thus also recovering part of its intact stiffness and balance this is a key aspect for monitoring systems that rely on observations of the twist angle variation to detect damages in the tensile armor wires of flexible pipes significant stress strain concentration in the wires close to those damaged in the outer tensile armor layer was also observed nevertheless these stresses strains progressively reduced to values slightly lower than those observed in the intact structure in wires distant from the damaged region and no significant bending strains were observed moreover the scfs obtained in the pure tension and in the torsional analyses were very close suggesting that a single set of scfs could be considered the normal stresses strains in all inner tensile armor wires increased due to force redistribution among the layers of the pipe moreover the uneven pressure distribution imposed by the tensile armor layers deforms the core inner carcass and pressure armor of the pipe thus inducing significant bending strains in the inner wires below the damaged outer tensile armor wires it is important remarking that the increase in the normal strains is directly related to the boundary conditions assumed in this study the extremities of the pipe were restrained to twist pure tension or elongate torsion combined with tension on the other hand de sousa et al de sousa et al 2014 tested a flexible pipe on which pure tension was imposed considering one extremity free to rotate and no redistribution of forces to the inner wires was observed this aspect may be of interest in pull out operations de sousa et al 2014 as by allowing or restraining the twist of the pipe the operator can transfer load from a damaged layer to another possibly alleviating one of these layers the analyses also indicated that the rupture of tensile armor wires has little impact on the normal strains induced in the inner carcass and the pressure armor however the uneven squeeze pressure imposed by the tensile armor wires induced significant bending moments in these layers the computation of the maximum stresses strains in these layers should therefore account for these bending moments as well as the unsymmetrical cross sections of the tendons that constitute these layers the fe model managed to capture all these effects and agreed quite well with the experimental measurements the analytical model provided a reasonable insight into the mechanical response of the damaged pipe and predicted quite well the variation of the axial stiffness and the extensional torsional unbalance the force redistribution was also indicated but the model fails to evaluate local effects of the rupture of wires such as the stress strain concentrations in the wires close to those damaged and the induced bending strains to sum up this study relies on analyses of a single flexible pipe with few wires broken and specific boundary conditions more flexible pipes with a higher number of broken wires as well as other boundary and interlayer friction conditions have yet to be studied nevertheless this set of results provides a reasonable view of the impact of damaged tensile armor wires on the extensional torsional response of flexible pipes and furthermore the theoretical tools presented may help in the investigation of other flexible pipes subjected to different types of loads acknowledgments authors from coppe ufrj would like to thank petrobras for allowing the publication of this work and the first author also thanks the national council for scientific and technological development cnpq for the research grant pq 308403 2016 9 
23316,this work investigates the extensional torsional response of a flexible pipe with one up to ten wires broken in its outer tensile armor experimental tests were conducted and the results obtained are compared to those from a finite element fe and a simplified analytical model in these tests the pipe was firstly subjected to pure tension and then to clockwise and anticlockwise torsion the experimental results indicate a decrease in the stiffness of the pipe with the increasing number of broken wires as well as a significant impact on its extensional torsional balance high stress concentrations in the wires close to those damaged were observed furthermore local changes in the curvature of the pressure armor and the inner carcass induced bending strains not only in these layers but also in the inner tensile armor wires the fe model captured these effects and agreed well with the experimental measurements while the analytical model predicted the overall response of the pipe but local effects could not be evaluated keywords flexible pipes offshore structures damage stress analysis finite element method 1 introduction in the last decades the exploitation of several offshore hydrocarbon fields has been based on floating production units and wet christmas trees in this scenario the use of unbonded flexible pipes or simply flexible pipes instead of carbon steel rigid pipes is often advantageous due to their easy installation compliance with movements from floating units and ability to absorb harsh environmental loads flexible pipes such as the one presented in fig 1 are multilayered structures in which each layer is designed to meet specific requirements these layers are either polymeric or metallic the polymeric layers work as sealing insulating or anti wear components while the metallic layers resist the applied structural loads in a typical flexible pipe three different metallic layers are found api 2014a inner carcass which is made from profiled steel strips wound at angles close to 90 and mainly resists radial inward forces pressure armor which are usually made from z shaped steel wires also wound at angles close to 90 with the main function of supporting the system internal pressure and also radial inward forces and tensile armors which are constituted of several rectangular steel wires laid in two or four layers cross wound at angles between 20 and 55 that resist tension torque and pressure end cap effects despite their effectiveness in the last few years periodic inspections of these structures have detected a considerable number of damages in their cross sections anderson et al 2007 botto et al 2008 carneval et al 2006 eide and muren 2014 eriksen and engelbreth 2014 taylor et al 2002 fagundes 2009 and one of the most common type of damage is the rupture of the outer sheath botto et al 2008 carneval et al 2006 eide and muren 2014 eriksen and engelbreth 2014 this type of damage may occur during the installation of the pipe when the sheath may be accidentally torn or during its operation due to eide and muren 2014 eriksen and engelbreth 2014 abrasion caused by contact with other pipes or components of floating production facilities impact of dropped objects cracking of the sheath or problems in the venting valves of the pipe even though damages in the outer sheath do not immediately affect the structural capacity of flexible pipes they may work as failure initiators a breach in the outer sheath such as the one illustrated in fig 2 a exposes the wires of the tensile armors to the outer environment and allows the ingress of oxygenated seawater and or air into the annulus of the pipe initially the exposure of these carbon steel wires to this aggressive environment causes the appearance of corrosion pits as shown in fig 2b in the course of time if the pipe is left unrepaired these corrosion pits may lead to the rupture of the affected wires by corrosion fatigue and or excessive loading eide and muren 2014 eriksen and engelbreth 2014 félix henry 2007 berge et al 2014 fig 2c the rupture of wires affects the torsional balance of the pipe fig 2d and also provokes a redistribution of forces among the remaining wires which consequently have to sustain higher loads if these loads are higher than their actual structural capacity more wires would break this mechanism continues until the wires of the tensile armors are not capable of sustaining the imposed axial loads and the whole pipe fails it is also worth remarking that even if the outer sheath is intact corrosion may occur in the tensile armor wires mainly due to the diffusion and condensation of water in the annulus of the pipe eriksen and engelbreth 2014 api api 2014a states that the integrity of the tensile armors has to be ensured during the entire service life of a flexible pipe as the rupture of their wires significantly reduces the structural capacity of the pipe and may lead to the premature failure of the whole structure therefore once the rupture of a wire in a tensile armor layer is detected with one of the several inspection and surface in field monitoring techniques carneval et al 2006 clarke et al 2011 the repair of the pipe is required however the need to repair or replace a damaged structure may lead to high operational costs which are related to the repair itself and a possible shut down in the production to replace the damaged section of the pipe aiming at reducing operational costs and at the same time ensure the secure operation of these structures the mechanical response of damaged flexible pipes to axisymmetric and bending loads needs to be studied the main problem in analyzing a flexible pipe with damaged wires is the need to individually represent these wires in the chosen model for instance the analytical models devoted to the axisymmetric analysis of flexible pipes typically assume that all wires of an armor layer have the same stress state and are usually represented in terms of total geometric properties total areas moments of inertia and number of wires muñoz et al 2016 therefore these models are suitable for the intact local mechanical analysis of flexible pipes under axisymmetric loads but in the case of damaged pipes they can only be used in very specific cases or for a qualitative understanding of their mechanics de sousa et al de sousa et al 2014 however employed the three dimensional nonlinear finite element fe model proposed in de sousa et al de sousa et al 2009 to analyze the mechanical response of a 6 flexible pipe with wires broken in its tensile armor layers and subjected to pure tension this fe model is capable of representing each wire of these layers and localized defects including total rupture may be adequately addressed in this study the pipe had one of its ends free to translate and or rotate and the other end was fixed experimental studies were also presented in order to validate the fe predictions the numerical analyses and the experimental tests indicated that the rupture of wires in the outer tensile armor layer of a flexible pipe reduces its axial stiffness the stresses in the wires of the outer tensile armor layer are higher next to the damaged ones and progressively reduce to the values observed in the intact structure in wires distant from them the rupture of the outer tensile armor wires seems to not affect the normal stress distribution in the inner tensile armor wires and vice versa this response is associated with the boundary conditions considered in the study the wires broken in the outer tensile armor layer induce an uneven pressure distribution on the pressure armor and the inner carcass which results in high bending moments in these layers however the normal strains in the pressure armor and the inner carcass are not significantly modified due to the deformed shape of the inner carcass and the pressure armor significant bending normal strains may arise in the wires of the inner tensile armor layer when damages are present in the outer tensile armor layer ji et al 2014 analyzed the response of a 6 flexible pipe to tension pressure and bending loads considering 2 4 and 6 neighbor wires broken in its inner tensile armor a three dimensional fe model was constructed using the commercial fe package marc in their analyses the pipe had one end fixed and the other was only allowed to axially translate the numerical analyses combining tension and pressure loads indicated high stress strain concentration factors scfs in the tensile armor wires near the damaged region but these stresses reduce to the intact value in wires distant from the damaged region furthermore scfs close to those found by de sousa et al de sousa et al 2014 were also observed as well as an increase of the normal stresses strains in the pressure armor in this work these studies are extended in order to better understand the extensional torsional response of damaged flexible pipes the extensional torsional response of flexible pipes is a key aspect in the design of equipments to detect the rupture of tensile armor wires in field camerini et al 2008 and moreover to adequately simulate pull out operations de sousa et al 2014 a modified version of the fe model proposed by de sousa et al de sousa et al 2009 is used to study a 9 13 flexible with wires broken in its outer tensile armor two different types of load cases are considered pure tension and torsion clockwise and anticlockwise combined with tension results from experimental tests are compared to the numerical predictions in order to verify the use of the proposed fe model and to discuss the use of an analytical model in the analysis of damaged flexible pipes the main aspects of the modified version of the fe model are introduced next after that the analytical model is presented followed by the description of the studied flexible pipe and the experimental apparatus all results obtained with these models and in the experimental tests are then presented and discussed finally these results are used to obtain the tension vs torsion load capacity curves of the studied flexible pipe and the main conclusions of this work are stablished 2 fe model 2 1 general remarks fig 3 presents a general overview of the proposed fe model the model is composed of concentric cylindrical shells which represent each layer of the pipe except the wires of the tensile armors that are modeled with three dimensional beam elements the presence of contact elements ensures the interaction between layers the construction of this model requires the calculation of the inner carcass and pressure armor thickness and material properties and the choice of adequate finite elements to represent these layers the choice of finite elements suitable for modeling the polymeric and the tensile armor layers the geometric and physical properties of these layers can be directly obtained from data sheets provided by manufacturers or from direct measures of flexible pipes samples the calculation of the contact stiffnesses between all layers as well as the development of contact modeling techniques the friction model parameters have also to be defined the choice of a solver to efficiently solve the set of equations generated by the fe model these aspects are discussed next 2 1 1 inner carcass and pressure armor representation the construction of a solid three dimensional fe model to represent the inner carcass and the pressure armor of a flexible pipe is an extremely onerous computational task due to the high number of degrees of freedom involved this approach is typically employed in burst melendez cuamatzi et al 2015 or hydrostatic collapse gay neto et al 2012 analyses of these structures as in these cases only short lengths of the inner carcass and or the pressure armor are modeled and seem to be sufficient to represent the mechanical response of the whole pipe nevertheless even these small models have hundreds of thousands of degrees of freedom on the other hand the analysis of a flexible pipe subjected to axisymmetric loads involves the adequate representation of all its layers and requires numerical models with a total length of at least one or two linear pitches of the tensile armor wires in order to avoid the effect of the extremities on the response of the pipe muñoz et al 2016 in comparison with the burst and hydrostatic collapse models these models are roughly 20 times longer thus an alternative approach capable of reducing the number of degrees of freedom and adequately modeling the inner carcass and the pressure armor of typical flexible pipes is necessary de sousa et al de sousa et al 2009 initially supposed that 1 the internal friction in these layers is negligible 2 there is no lateral contact between tendons tendon refers to the profiled steel strip that forms the inner carcass and also to each wire that constitutes the pressure armor these hypotheses seem to be valid because the interlocking process leaves internal gaps in these layers and these gaps are dimensioned to avoid lateral contact under moderate loading moreover internal friction or lateral contact in these layers would substantially increase the axial stiffness of the pipe intact or damaged but this has not been observed in previous studies muñoz et al 2016 de sousa et al 2014 by assuming hypotheses 1 and 2 each tendon could be considered as a helical beam and modeled for instance with three dimensional beam elements lacerda et al 2015 however the tendons have very small pitch as their lay angles are close to 90 and consequently a large number of beam elements would be necessary and the computational cost of the model may also be high nevertheless an alternative approach can be derived based on the works presented by hobbs and raoof 1982 and raoof and hobbs 1988 who dealt with the problem of calculating the mechanical properties of strands and wire ropes by representing different layers of helical wires with equivalent orthotropic shells the same idea was employed by de sousa et al de sousa et al 2009 but in a fe approach that guarantees the equivalence between the tendons and the shell stiffnesses two other hypotheses were assumed de sousa et al 2009 3 the thickness of the inner carcass and of the pressure armor are small in comparison to the internal diameter of the layer 4 shear effects are negligible i e linear elements perpendicular to the middle plane of the structure remain straight and normal to the deflected surface of the structure after bending typically the diameter to thickness ratio in pipes for deep water applications are higher than 20 which indicates that these layers can be considered as moderately thick cylinders and hypotheses 3 and 4 seem to be adequate considering hypotheses 1 to 4 the inner carcass and the pressure armor can be assumed orthotropic shells and considering the coordinated axes of fig 4 the stress strain relations in these layers are stated as 1 σ s x e s x 1 ν s x y ν s y x ε s x e s x ν s y x 1 ν s x y ν s y x ε s y σ s y e s y ν s x y 1 ν s x y ν s y x ε s x e s y 1 ν s x y ν s y x ε s y τ s x y g s x y γ s x y where σ s and τ s are respectively the normal and shear stresses at the shell surface ε s and γ s are respectively its elongation and angular distortion e s g s and ν s are in this order the young modulus the shear modulus and the poisson coefficient of the material that constitutes the shell and subscripts x and y designate the direction to which the mentioned values are related by hypotheses 1 and 2 the tendons do not resist to loads normal to their laying direction thus leading to e s y 0 and ν s x y ν s y x 0 and eq 1 can be rewritten 2 σ s x e s x ε s x σ s y 0 τ s x y g s x y γ s x y considering eq 2 the membrane e a s bending e i s and torsional g j s stiffnesses of the equivalent orthotropic shell are in this order given by timoshenko and woinowsky krieger 1959 3 e a s h s e s x e i s h s 3 12 e s x g j s h s 3 6 g s x y where h s is the thickness of the orthotropic shell assuming that the tendons of the inner carcass and the pressure armor have unsymmetrical cross sections their axial e a t bending e i t and torsional g j t stiffnesses can be stated as proposed by cook and young 1985 for straight bars but assuming a helicoidal shape for these tendons 4 e a t a n t l p e e i t k i y i y z tan λ n t l p e g j t j n t l p g where e and g are in this order the young modulus and the shear modulus of the material that constitute the tendon a i y i y z and j are respectively the cross sectional area lower second moment of area product of inertia and torsional constant of the tendon n t is the number of tendons in the considered layer which is generally 1 for the inner carcass and 1 or 2 for the pressure armor and l p is the linear pitch of the tendon 5 l p 2 π r tan α where r is the mean radius of the layer and α is the lay angle of the tendon the term in curly brackets in the bending stiffness equation eq 4 is often called the equivalent moment of inertia of the tendon i e q and k is a factor that depends on the lay angle and the moment of inertia of the section larsen et al 2014 relying on previous experimental tests de sousa et al 2009 souza 2002 muñoz et al 2016 employed the expression 6 k 12 n t 1 ν 2 i y i y z tan λ l p h 3 where h is the thickness of the tendon ν is the poisson coefficient of the material and λ is the angle between the neutral axis of the cross section and the centroidal yz axes presented in fig 4 and is given by 7 λ atan i y z i z it is worth remarking that in eqs 1 7 only bending with respect to the weaker axis is considered bending moments related to the stronger axis are assumed to be negligible equaling eqs 3 and 4 the equivalent physical and geometric properties of the orthotropic shell are 8 h s 12 i e q a e s x a n t l p h s e g s x y 6 j n t l p h s 3 g at this point the stress strain relations of the orthotropic shell are defined with eqs 2 and 8 the stiffness of the helical tendons and of the orthotropic shells as well as the acting axial forces n x bending moments m y and torsional moments m x can be made equal the normal and shear stress distribution in the carcass and pressure armor cross sections are thus stated respectively as 9 σ x y z n x a z y tan λ m y i e q l p n t τ x y l p h n t j m x where y and z are the coordinates of a point located in the cross section of the inner carcass or the pressure armor fig 4 the normal and shear stresses along the cross sections of the tendons can be directly obtained with eq 9 considering the axial forces and the bending and torsional moments calculated in the fe model finally the proposed approach is slightly different from the one proposed in de sousa et al de sousa et al 2009 as in the previous approach λ equals 0 and consequently the inclination of the section neutral axis is not considered in the strain stress calculation the effect of this assumption is discussed in section 4 4 2 2 polymeric layers representation the polymeric layers of flexible pipes are assumed thin to moderately thick cylinders and are modeled with reissner mindlin shell elements the polymeric sheaths have physical properties equal in all directions and therefore isotropic shell elements are used antiwear and fabric tapes are employed to minimize the effects of friction between layers and to avoid the extrusion of the polymeric sheaths in the voids between the metallic armors respectively moreover some pipes designed to operate in deep and ultra deep water depths also have polymeric bandages named high strength tapes which are employed to prevent the failure of the pipe by excessive axial compression all these tapes are wound at angles close to 90 and consequently are modeled with orthotropic shells moreover the high strength tapes resist only tension which introduces a nonlinear physical behavior to the fe model 2 3 tensile armor representation the helical wires of the tensile armors layers are modeled with three dimensional euler bernoulli beam elements as the width and the thickness of these wires are usually much smaller than their length moreover by hypothesis the wires are assumed to be rectangular shaped and perfectly conformed to the cylinder that supports them 2 4 modeling contact nonlinearities in the numerical modeling of flexible pipes contact elements are mainly used to ensure the interaction between layers by allowing their separation contact and relative displacements in case of contact excessive penetration between layers should also be avoided in this work however the layers of the pipe are modeled with shell and beam elements and their thicknesses are not directly represented the contact elements thus have an additional function which is to guarantee the radial stiffness equivalence between the actual pipe and its numerical model by relying on results presented by muñoz et al 2016 and de sousa et al de sousa et al 2009 2012 the interaction between the layers of a flexible pipe is established with contact elements that allow large relative displacement between these layers by using a contact detection algorithm based on the pinball technique and contact forces evaluated with the penalty method belytschko and neal 1991 the penalty method relies on the computation of penalty forces that are calculated by placing fictitious springs along the boundaries of two bodies in contact these forces are directly proportional to a penalty parameter called normal contact stiffness which corresponds to the stiffness of the springs the normal stiffness k n in this work is given by muñoz et al 2016 de sousa et al 2009 2012 10 k n i k n i k n i 1 k n i k n i 1 i 1 n l 1 where n l is the number of layers in the flexible pipe and 11 k n i e i a c i 1 ν i 1 2 ν i h i in this equation the poisson coefficient ν equals 0 if layer i is an armor or a polymeric tape the contact area between two layers a c i is approximated by 12 a c i 2 π r i n t l t n c d i n l d i i 1 n l 1 where r i n t n c d and n l d are respectively the interface radius and the number of circumferential and longitudinal divisions of the inner layer upon which the contact elements are placed and l t is the length of the model moreover friction between layers is addressed by considering the coulomb friction law which is written as 13 τ max τ o μ σ n where τ m a x is the limit shear stress τ o is the initial adhesion between the two surfaces in contact σ n is the normal contact stress and μ is the friction coefficient between the two surfaces the modeling of frictional behavior using the penalty method requires the definition of a tangential stiffness as some amount of slip has to be allowed in the stick phase the tangential stiffness k s for the contact elements of interface i may be expressed as saevik 2011 14 k s i f b e i a i r i n t 2 sin 2 α l t n l d i i 1 n l 1 where f b is a correction coefficient that enforces the plane surface remains plane condition during the stick phase in case of contact between an armor layer and a polymeric layer i relates to the armor layer in case of contact between two polymeric layers sheaths or tapes α equals 90 if not available it is worth remarking that high values of f b better approximate the plane surface remains plane condition in the stick phase but tend to introduce numerical difficulties in the analyses on the other hand lower values avoid numerical problems in the analyses but allow larger relative displacements between the supporting cylinder and the wires of the tensile armors saevik saevik 2011 suggests a f b of 0 08 in order to obtain the best compromise between numerical convergence and an accurate description of the stick slip behavior however in this work after few simulations a f b of about 9 was found adequate to ensure both the plane surface remains plane condition and numerical convergence finally four different types of interlayer contacts may be observed in a typical flexible pipe i e contact between an inner carcass and or pressure armor and a polymeric layer a polymeric layer and another polymeric layer wires of a tensile armor and a polymeric layer and finally two tensile armor layers in the fe model proposed in this work the first two types of contact can be dealt with surface to surface contact elements however the contact between the wires of a tensile armor and a polymeric layer or between tensile armor layers demand the use of line to surface or line to line contact elements respectively in numerical tests previously performed the use of these elements required great computational effort and often resulted in unconverged analyses therefore in order to overcome this difficulty an alternative approach is proposed dummy isotropic shell elements with very low bending and axial stiffnesses of about 10 5 of a metallic armor with the same thickness are used to fill the voids between the three dimensional beam elements that are used to model the wires of a tensile armor layer the contact between these wires and the surrounding polymeric layers is then ensured by employing surface to surface contact elements a detail of these elements is presented in fig 3 2 5 implementation and solution the described model was implemented in the in house fe mesh generator risertools and all generated meshes are analyzed in the commercial fe package ansys version 16 2 the model employs the nonlinear shell finite element shell181 to represent all layers of the pipe with exception of the tensile armors wires that are modeled with the nonlinear beam element beam188 contact elements conta174 and targe170 simulate the contact between all layers of the pipe typically the fe mesh of a flexible pipe has more than 100 000 degrees of freedom and nonlinearities have to be addressed in these cases ansys recommends the use of the sparse or direct solver method combined to equation reordering strategies which are internal to the software to solve the set of equations generated by the fe discretization previous tests with the proposed model using several fe meshes and iterative solvers such as the preconditioned conjugate gradient led to higher computational effort with the same accuracy 3 analytical model as discussed in section 1 analytical models have some limitations with respect to the analysis of damaged flexible pipes but these models may provide some insights into the extensional torsional response of these structures with this purpose the analytical model proposed by batista et al 1989 is used and slightly modified in this work to obtain closed form expressions for the stiffness coefficients and the strains in the carcass pressure and tensile armor layers of intact and damaged flexible pipes therefore in addition to the hypotheses assumed by batista et al 1989 the following hypotheses are also assumed here all layers remain in contact radial deformations are disregarded the contribution of the polymeric layers to the axial resistance of the pipe is negligible the core of the pipe is constituted of a pressure armor an internal sheath and an inner carcass and resists only radial loads the lay angles of the inner and outer tensile armor wires are equal but with opposite signs the absolute lay angle is α t moreover the wires are constituted by the same material with young modulus e and have the same cross sectional area a their mean radii are assumed equal to r t 3 1 intact pipe the extensional torsional response of a flexible pipe is usually expressed as ramos et al 2014 15 n x m x c 1 c 2 c 3 c 4 δ l l t δ ϕ l t where n x and m x are the imposed tensile and torsional loads respectively δ l and δ ϕ are in this order the axial elongation and rotation of the pipe c 1 and c 4 are respectively the axial and torsional effective stiffness of the pipe and c 2 and c 3 are called the coupling stiffness coefficients in this equation the terms related to the internal and external pressure as proposed by ramos et al 2014 are not considered to be consistent with the experimental tests described in section 4 2 considering all hypotheses the stiffness coefficients c 1 to c 4 may be written as 16 c 1 n i a n o a e a cos 3 α t 17 c 2 n i a n o a e a r t cos 2 α t sin α t 18 c 3 c 2 19 c 4 n i a n o a e a r t 2 cos α t sin 2 α t where n i a and n o a are respectively the number of wires in the inner and outer tensile armor layers of the intact pipe the normal strains ε x in the wires of the inner and outer tensile armor wires can be expressed as batista et al 1989 feret and bournazel 1987 20 ε x cos 2 α t δ l l t 1 2 r t sin 2 α t α α t δ ϕ l t it is also important to calculate the total axial force n t acting on a tensile armor layer which is given by 21 n t i 1 n w e a ε x i where n w is the number of wires in the layer if pure tension is imposed and the pipe is stretched without twisting i e δ ϕ 0 the relation between axial elongation and tension load is given by combining the first of eqs 15 and 16 22 n x n i a n o a e a cos 3 α t δ l l t the axial elongation δ l l t can be obtained with eq 22 and is employed in eq 20 to obtain the strains in the inner and outer tensile armor wires the strain ratio is defined in this work as the variation of the strains in the wires with the applied load eq 23 indicates strain ratios for the inner and outer tensile armor layers ε x i a r and ε x o a r equal to 23 ε x i a r ε x o a r 1 n i a n o a e a cos α t moreover the total loads acting on the inner n t i a and outer n t o a tensile armor layers can be obtained by combining eqs 20 22 24 n t i a n i a n x n i a n o a cos α t n t o a n o a n x n i a n o a cos α t in a second load case the axial elongation δ l l t is constant and the pipe is submitted to clockwise and anticlockwise twist the relation between the torsional moment and the imposed twist is derived with the second of eqs 15 considering eqs 16 19 25 m x n i a n o a e a r t cos 2 α t sin α t δ l l t n i a n o a e a r t 2 cos α t sin 2 α t δ ϕ l t the first term in this equation is constant and corresponds to the reaction torque due to the imposed tensile load the second term in brackets is the torsional stiffness of the pipe the inner and outer strains in the tensile armor wires can be calculated with eq 20 considering the twist computed with eq 25 moreover by assuming that the inner wires have a positive lay angle and the outer wires have a negative lay angle the strain ratios in these wires are given by 26 ε x i a r 1 n i a n o a e a r t sin α t ε x o a r ε x i a r the total load acting on the tensile armor layers in this case can be calculated by combining eq 25 with eqs 20 and 21 leading to 27 n t i a 2 n o a n i a n i a n o a cos 2 α t e a δ l l t n i a n i a n o a r t sin α t m y z n t o a 2 n i a n o a n i a n o a cos 2 α t e a δ l l t n o a n i a n o a r t sin α t m y z the first terms in eq 27 are constant and therefore the variation of the total axial force is caused by the variation of the second term which is related to the imposed torsional loads the tensile and torsional loads deform the tensile armor wires which consequently squeeze the core of the pipe relying on the expression for the pressure differential through each layer proposed by feret and bournazel 1987 the squeeze pressure variation with the imposed load p s q r may be written as 28 p s q r e a sin α t tan α t 2 π r t 2 n i a ε x i a r n o a ε x o a r where ε x i a r and ε x i a r are given by eq 23 or 26 if pure tension or torsion combined with tension are imposed on the pipe respectively the strain ratios in the inner carcass and the pressure armor ε x i c r and ε x p a r may be approximated by 29 ε x i c r r i c e s x i c h s i c δ p i c r 30 ε x p a r r p a e s x p a h s p a δ p p a r where r is the mean radius of the layer and e s x and h s are given by eq 8 the subscripts i c and p a refer to the inner carcass and the pressure armor respectively the pressure differential variation in each layer δ p i c r and δ p p a r are written as 31 δ p i c r ρ p a ρ i c p s q r 32 δ p p a r 1 ρ p a p s q r where 33 ρ p a ρ p a 1 ρ p a 1 ρ p a 2 34 ρ i c ρ i c 1 ρ i c 2 where 35 ρ p a 1 e i p h i p r p a r p a h s p a 2 1 ν i p e s x p a h s p a r i p r i p h i p 2 36 ρ p a 2 1 v i p r i p r i p h i p 1 ρ i c v i p h i p r i p h i p 37 ρ i c 1 1 1 ν i p 1 ν i p r i p ν i p h i p r i p h i p 38 ρ i c 2 1 1 ν i p e i p h i p r i c r i c h s i c 2 1 ν i p e s x i c h s i c r i p r i p h i p 2 and the subscript i p refers to the inner plastic sheath 3 2 damaged pipe assuming that the number of intact inner and outer wires are n i a d and n o a d respectively and moreover considering that these wires are uniformly distributed along their supporting layers the stiffness coefficients of the damaged pipe may be written as 39 c 1 d n i a d n o a d n i a n o a c 1 40 c 2 d n i a d n o a d n i a n o a c 2 41 c 3 d c 2 d 42 c 4 d n i a d n o a d n i a n o a c 4 in this work the ratio between a damaged and an intact stiffness coefficient is named normalized stiffness coefficient which corresponds to the terms in parenthesis in eqs 39 42 by considering eqs 23 and 26 the strain ratios in the inner ε x i a r d and outer ε x o a r d tensile armor wires may be written as 43 ε x i a r d n i a n o a n i a d n o a d ε x i a r ε x o a r d n i a n o a n i a d n o a d ε x o a r the strain concentration factors scfs are defined as the ratio between the strain ratios in the damaged and intact conditions for the inner and outer tensile armor wires the scfs correspond to the terms in parenthesis in eq 43 by observing eqs 29 38 the strain ratios in the inner carcass and the pressure armor are given by the ratio between the squeeze pressures acting on the damaged and intact pipe in case of pure tension the combination of eqs 23 and 28 shows that these pressures do not vary with the number of wires in the tensile armor layers on the other hand if torsion is considered the combination of eq 26 with eq 28 shows that the squeeze pressure depends on the number of wires the strain ratios in these layers are thus given by 44 ε x i c r d ε x i c r 1 0 n x 0 and m y z 0 n i a n o a n i a d n o a d n i a d n o a d n i a n o a m y z 0 ε x p a r d ε x p a r 1 0 n x 0 and m y z 0 n i a n o a n i a d n o a d n i a d n o a d n i a n o a m y z 0 the scfs in the inner carcass and the pressure armor are equal and given by the expressions in curly brackets in eq 44 finally the non dimensional total acting force variation on a tensile armor layer is defined as the variation of the total acting force δ n t on a tensile armor layer considering a damaged condition in the pipe divided by the force in the layer assuming the intact condition regardless the load case eq 24 or 27 the non dimensional forces acting on the inner δ n t i a d or outer δ n t o a d armor layers are 45 δ n t i a d n i a n o a n i a d n o a d n i a d n i a δ n t i a δ n t o a d n i a n o a n i a d n o a d n o a d n o a δ n t o a 4 case study 4 1 description the response of a 9 13 internal diameter of 232 mm flexible pipe to tension and torsion is studied in this work the pipe has nine layers including a stainless steel inner carcass yield stress of 510 mpa a pressure armor of high carbon steel yield stress of 900 mpa and two pairs of tensile armors of high carbon steel yield stress of 1260 mpa the inner tensile armor layer has 63 wires laid with an angle of 30 while the outer tensile armor layer has 66 wires laid with an angle of 30 the wires have approximated rectangular cross sections with 4 mm in height and 12 mm in width moreover the pipe has a free span of 5 37 m which is equivalent to 3 3 linear pitches of the outer tensile armor wires more details on the flexible pipe structure can be obtained in londoño et al 2014 two different load cases are considered pure tension the pipe is tensioned until a maximum load of 1000 kn is reached this load is approximately 17 of the estimated damaging pull of the pipe after that three load cycles with total amplitude of 200 kn and mean value of 800 kn are applied in this case one end of the pipe is fixed and the other is only allowed to elongate torsion combined with tension a pre tension of 1000 kn is imposed by prescribing an axial displacement to one of the pipe s extremities this axial displacement is kept constant during the test an anticlockwise twist of 6 0 1 117 m is then applied followed by three load cycles with total amplitude of 4 0 0 745 m and mean value of about 2 0 0 372 m after that the torsional load is reversed and the same loads are imposed on the pipe it is worth mentioning that in this pipe anticlockwise torsional moments tight the wires of the outer tensile armor layer whilst clockwise torsional moments tight the wires of the inner armor each of these tests were performed considering the structure intact and with 1 up to 10 wires broken in its outer tensile armor layer 4 2 experimental tests aiming at simulating the load cases described in section 4 1 a sample of the 9 13 flexible pipe was installed in the experimental apparatus presented in fig 5 a and schematically with all instrumentation in fig 5b this apparatus consists of two hydraulic actuators tensile and torsional loads can be simultaneously imposed on the pipe tensile loads are applied by a hydraulic actuator connected to one of the pipe s ends as shown in fig 5 this actuator has a total load capacity of 1000 kn another hydraulic actuator is linked to a torque arm that is connected to the opposite end of the pipe as also shown in fig 5 this arm imposes a total torsional load up to 15 knm on the pipe three displacement transducers f1 f2 and f3 in fig 5 two transducers f2 and f3 were used to measure the axial displacements of the pipe these transducers were fixed to one of the end fittings of the pipe as shown in fig 5 two nylon yarns are attached to these transducers and fixed to the opposite end fitting thus measuring the axial relative displacements between them another transducer f1 was positioned at the mid section of the pipe in order to measure its transverse displacement three inclinometers a1 a2 and a3 in fig 5 these inclinometers were fixed to metallic plates and linked to the ends of the flexible pipe by magnetic bases two inclinometers were fixed on the torsional actuator and the third on the axial actuator these inclinometers measured the twist angle of the pipe strain gages part of the outer plastic sheath was removed around the mid section of the pipe thus exposing the outer tensile armor wires strain gages were mounted in each wire of this armor as shown in fig 6 a and in this section one up to ten wires of the outer armor layer i e 0 up to 15 of its wires were cut with the help of a die grinder when three neighbor wires were broken all wires of the inner tensile armor layer were exposed and a strain gage was fixed on each of them as indicated in fig 6b therefore the strains in the wires of the inner layer could also be monitored finally as the loads were applied with very low rates dynamic effects on the response of the pipe may be neglected 4 3 numerical model in all numerical analyses a fe mesh with a total length of 5 37 m is employed after performing several mesh tests the layers of the pipe are discretized with 66 finite elements along the circumference and 214 elements along their length the exceptions are the inner tensile armor layer and the associated dummy shell elements which were discretized with 63 elements along the circumference and 214 elements along their length the employed fe mesh has 154 802 nodes and 491 672 elements leading to 755 298 degrees of freedom loads and boundary conditions equivalent to those employed in the load cases described in section 4 1 were imposed on nodes positioned in the axis of the pipe and at its extremities as shown in fig 3b these nodes are rigidly linked to the nodes of the correspondent cross section of the pipe thus simulating perfect end fittings i e end fittings inside which all armors are perfectly anchored furthermore tensile loads are imposed on one extremity of the model and torsional loads are applied in the opposite one in order to simulate the experimental tests the pure tension analyses were carried out with a single load step while the torsional analyses involved two load steps as the pipe is pre tensioned during the experimental tests all analyses were conducted considering an initial first load increment equivalent to 1 of the total load and this value is automatically adjusted during the analysis depending on the convergence of the model minimum and maximum load increments equivalent to 0 1 and 10 of the total load were admitted analyses with the intact pipe take few minutes while analyses with the damaged pipe depending on the number of load steps may take about 10 h to be run on an intel i7 4 0 ghz machine with 8 cores and 32 gb of ram an important aspect of the numerical model is to properly represent the interaction between all layers of the flexible pipe the numerical model proposed here employs the coulomb friction law eq 13 but there are significant uncertainties in selecting the friction coefficient to be used in the local analysis of flexible pipes api 2014a typically values between 0 05 and 0 30 are employed in local analysis models after performing few numerical simulations with different friction coefficients and comparing the load vs displacement curves obtained with those from the experimental tests no initial adhesion and a friction coefficient of 0 07 was considered between all layers of the pipe finally the damages to the pipe are located at the same positions of the experimental tests mid section of the pipe and in neighbor wires of the outer tensile armor one finite element of each damaged wire has their stiffness matrix multiplied by a small number 10 6 i e the element is deactivated while the stiffness matrices of all other elements are kept unchanged 4 4 results 4 4 1 pure tension fig 7 presents the tension vs axial elongation curves obtained in the experimental tests and with the fe and the analytical eq 22 models considering 0 intact and ten wires broken in the outer tensile armor layer of the flexible pipe these curves indicate a linear relation between the axial elongation and the imposed tensile load in the experimental tests during the load cycles a small hysteresis loop is observed but the responses during loading or unloading are quite well predicted by fitting linear regression curves to these points similar curves were also obtained in all other conditions and table 1 summarizes the related axial stiffnesses c 1 this table indicates that the axial stiffnesses calculated with the fe and the analytical eq 16 and 39 models are very close to those obtained in the experimental tests fig 8 presents the variation of the normalized axial stiffness with the number of wires broken in the outer armor layer the experimental tests indicate a scattered variation but the axial stiffnesses tend to slightly decrease with the increasing number of broken wires the axial stiffness of the pipe with ten wires broken is only 7 lower than the intact value moreover the fe and the analytical models correlate quite well with the experimental normalized stiffness table 1 also presents the numerical and analytical eq 18 values for the stiffness coupling coefficient c 3 this table shows that the analytical and the numerical values differ significantly the analytical model assumes that each layer of the pipe has the same axial translations and rotations in each cross section however as discussed in muñoz et al 2016 generally this is only confirmed by the fe model at the ends of the pipe where all layers have their displacements coupled due to the presence of end fittings or if relative sliding is not allowed between layers due to friction in all other cross sections and or for other interlayer friction conditions the inner carcass the pressure armor and the polymeric layers tend to have the same axial translations and rotations but the tensile armors slide relatively to these layers and consequently the induced axial translations and mainly axial rotations are different from those predicted by the analytical model eq 18 shows that the stiffness coefficient c 3 is directly proportional to the difference between the number of inner and outer tensile armor wires in the intact condition this coefficient is small and negative as the outer armor layer has few more wires than the inner layer and consequently the pipe is approximately torque balanced moreover the induced torque elongates the outer tensile armor wires and compresses the inner wires this equation also indicates that initially if few wires are broken the pipe becomes more balanced and no torque is induced when the number of outer tensile armor wires equals the number of inner wires fully balanced pipe however an increase in the number of broken wires leads to a reversal in the induced torque associated with an increasing extensional torsional unbalance in this case the induced torque becomes positive elongates the inner tensile armor wires and compresses the outer wires this response can be observed in table 1 and also in fig 9 which presents the variation of the normalized numerical and analytical eq 18 stiffness coefficient c 3 with the number of broken wires in the outer armor layer as can be depicted in fig 9 the analytical and the fe models show a reversal of the induced torque but with a nonlinear variation with the number of broken wires in the fe model and with a linear variation in the analytical model this nonlinear response of the fe model may be attributed to the clustered distribution of the damage in the outer armor layer while the analytical model assumes a uniformly distributed damage in this layer it is also worth remarking that significant changes are observed in the coupling coefficient even if few wires are broken however this variation does not mean that the induced torques are high the fe model estimates a torque variation of only 0 6 knm during the load unload cycles in the intact pipe and of 1 4 knm when the pipe has ten wires broken the maximum value is about 2 of the cyclic torsional loads imposed on the pipe which will be discussed in the next section during the experimental tests several attempts to measure this variation were tried but the internal friction of the actuators and the precision of the load cells combined with the low values of the induced torques led to curves with no clear tendencies and therefore the experimental stiffness coefficients c 3 are not presented here however it is recognized that this point should be addressed in future studies in all conditions the fe model eq 23 and the experimental tests indicate that the strains in the wires vary linearly with the imposed tensile load therefore fig 10 presents the strain ratios in the outer tensile armor wires considering the pipe intact this figure indicates that the experimental strain ratios vary from wire to wire the average strain ratio considering all wires is 0 85 μm m kn with a standard deviation of 0 14 μm m kn the fe and the analytical models predict that all wires are equally loaded and strain ratios of 0 88 μm m kn and 0 91 μm m kn were calculated respectively these values are close to the experimental average a possible explanation for the different strain ratios obtained in the experimental tests is the different anchoring conditions of the wires inside the end fittings as discussed in de sousa et al de sousa et al 2013 moreover the fe model estimates strain ratios of 0 92 μm m kn for the inner tensile armor wires 0 13 μm m kn for the pressure armor and 0 10 μm m kn for the inner carcass while the analytical model indicates strain ratios of 0 91 μm m kn for the inner tensile armor wires eq 23 0 12 μm m kn for the pressure armor eq 30 and 0 10 μm m kn for the inner carcass eq 29 fig 11 presents the variation of the scfs in the wires of the outer tensile armor layer in the damaged section mid section of the pipe and table 2 points the maximum scfs associated with each analyzed case this figure and table indicate that in all cases the strains and consequently the stresses in the wires close to those broken are considerably higher than the strains obtained in the intact condition these strains however decrease and values lower than those observed in the intact case are observed in wires far from the damaged wires maximum experimental scfs varying between 1 092 one wire broken and 2 140 10 wires broken were measured the fe predictions agreed well with the experimental values and also indicate negligible bending normal and binormal strains in the wires discrepancies between the estimated values and the experimental measurements can possibly be attributed to the wires anchoring conditions and furthermore to local changes in the geometry of the wires as can be observed for instance in fig 6b where two outer wires are clearly far from their original position when compared to fig 6a this very large relative displacement which was also perceived in the unloaded condition was not captured by the fe model and may be related to the cyclic loading imposed on the pipe furthermore eq 43 predicts much lower uniform elevations in the strains of the outer tensile armor wires which are not consistent with the nonlinear variation observed in the tests and in the fe model this difference can be attributed to the hypothesis of uniform damage distribution in the analytical model and evidences that the spatial distribution of the broken wires affects the scfs in the layer these points also deserve future studies fig 12 presents the variation of the scf along six different wires of the outer tensile armor layer wires 26 to 31 considering 10 wires broken in this layer wire 26 corresponds to the intact wire close to the damage and wire 31 is the damaged wire more distant from the intact wires this figure indicates that the damaged wires recover part of their load capacity due to the friction between them and the surrounding layers and on the other hand the strains in the intact wires reduce from a maximum in the damaged cross section to lower values close to the extremities of the pipe this recovery affects the stiffness and coupling coefficients of the pipe as indicated in table 1 for friction coefficients of 0 07 0 10 and 0 20 the axial stiffness of the pipe is slightly modified but the coupling coefficients are deeply affected and this is a key aspect for monitoring systems that rely on the twist angle variation to detect damages in the tensile armor wires of flexible pipes similar conclusions were obtained for all other conditions eq 41 indicates that the rupture of the outer tensile armor wires increases the total force acting on the inner tensile armor layer and on the contrary reduces the total force imposed on the outer layer table 3 confirms this response by presenting the normalized total loads in the outer and inner tensile armor layers obtained with the fe and analytical models eq 45 and measured in the experimental tests in these tests only the total load in the outer armor is available the experimental tests point to a decrease in the total load acting on the outer tensile armor layer with scattered distribution which nevertheless agreed relatively well with the fe and the analytical values the increase in the total load acting on the inner layer predicted by the fe model was also close to the values estimated with the analytical model it is worth observing that the tensile armor layers uniformly squeeze the core inner carcass pressure armor of a flexible pipe under tension and the deformed structure maintains a constant curvature muñoz et al 2016 however a broken wire does not squeeze the core and the resulting squeeze pressure is thus not uniform this uneven pressure distribution deforms the core of the pipe in the damaged region as shown in fig 13 leading to a local change in curvature moreover eq 43 indicates that the normal strains in the wires of a tensile armor layer are inversely proportional to the total number of intact wires in the pipe and consequently the rupture of the outer wires increases the normal strains in all wires of the inner layer altogether the effect of the rupture of wires in the outer tensile armor in the inner layer is twofold i e it increases the normal strains in all wires of the layer global effect and induces bending strains in the wires close to the damaged region local effect fig 14 presents the distributions of the fe scfs in each wire of the inner tensile armor layer and at the mid section of the pipe damaged section these values correspond to the strains measured in the outer fibers of the inner wires this figure indicates that the higher strains occur in wires below the damaged region and about half distance between the first intact wires of the outer layer the maximum scf vary from 1 020 1 wire up to 1 222 10 wires and result from a combination of the local change of curvature and global increase of the normal strains effects in the wire on the other hand the scfs in wires far from the damage which are mainly associated with the global effect vary between 1 005 1 wire and 1 151 10 wires table 4 summarizes the fe scfs obtained in each case analyzed as well as the factors exclusively related to the increase in the normal strains moreover the scfs predicted using eq 43 are also presented the analytical values are exclusively related to the increase in the normal strains in the wire global effect and agree well with the fe scf in wires far from those damaged as the maximum difference observed is of 5 4 when 10 wires are broken however the maximum values which include the local effect captured by the fe model in wires close to the damage may differ significantly in this case differences up to 13 4 are observed when 10 wires are broken in the experimental tests the inner tensile armor layer could only be assessed when 3 wires of the outer layer were cut and considering this condition the strain gages were mounted on all inner wires at half distance between the first intact wires as indicated in fig 6b as these strain gages maintained the same relative position with respect to the first intact wires in all conditions analyzed the same strains possibly with very small variations were expected to be measured by all these gages in each test fig 15 illustrates the strain ratios measured in the experimental tests considering three wires broken in the outer armor layer as well as the values predicted by the fe and the analytical models the experimental values vary from wire to wire because these wires like the outer armor wires may be subjected to different anchoring conditions de sousa et al 2013 the average strain ratio equals 0 90 μm m kn with a standard deviation of 0 09 μmm mm kn the fe and the analytical models predict constant strain ratios that are equal to 0 97 μm m kn and 0 93 μm m kn respectively these values are close to the experimental average value in this work for the sake of comparison the scf for the inner tensile armor wires were calculated by dividing the strains obtained in the analyses with 4 or more wires broken in the outer tensile armor layer and the strains obtained in the condition with 3 wires broken in this layer as the inner layer in the experimental tests could not be assessed before these 3 wires were cut fig 16 thus presents the scfs obtained in the experimental tests and those predicted by the fe and the analytical models this figure and table 4 indicate that the scfs measured in the experimental tests had a small dispersion with respect to their average value furthermore the experimental values agreed quite well with the maximum fe scfs but may differ significantly from the analytical scfs especially if several wires are broken altogether these aspects confirm the importance of considering the local change of curvature in the response of the inner wires when the outer tensile armor wires are broken the deformation of the pipe s core leads to significant bending moments in the inner carcass and the pressure armor fig 17 presents the normalized bending moment distributions along the inner carcass and the pressure armor values are normalized with respect to the maximum bending moments in each layer this figure indicates that the outer fibers of both layers are tensioned red zones in the regions below the damaged tensile armor wires while the neighbor regions are compressed blue zones it is worth remarking that these bending moments reduce as points more distant from the damaged region are observed due to the partial recovery of the damaged wires load capacities fig 17 shows a reduction in the induced bending moments of about 40 near the ends of the pipe these bending moments induce high scfs in the inner carcass and the pressure armor fig 18 presents the scfs observed along the outer and middle fibers of these layers and in the damaged region the scfs in the middle fibers which are associated with the increase in the normal strains varied between 0 7 one wire broken and 9 9 ten wires broken in the inner carcass and between 0 4 one wire broken and 5 0 ten wires broken in the pressure armor these strain concentrations occur below the damaged region at points far from the damaged region there is no significant variation in the normal strains which is in accordance with the analytical model eq 44 the maximum scfs in the outer fibers are much higher than those observed in the middle fibers but very similar in both layers as the inner carcass and the pressure armor are initially under compression the rupture of 1 wire decreases the strains in the outer fibers however as the number of wires broken increase the maximum strains in these fibers substantially increase the rupture of 10 wires leads to a maximum scf in the outer fibers of about 7 0 in both layers these very high scf are however localized and vary in the extreme fibers of the inner carcass and the pressure armor due to their unsymmetrical cross sections fig 19 presents the expected variation of the scf in these cross sections when 10 outer tensile armor wires are broken both the inner carcass and the pressure armor indicate that the maximum scf occurs close to the mid point of their extreme surfaces y 0 z h 2 fig 4 in the inner carcass this point would present higher scfs but it does not belong to the cross section while in the pressure armor the scf at this point is lower than the one indicated in fig 18 the use of the strains or stresses at the mid point of the cross section is a common assumption of models that rely on equivalent cross sections and therefore depending on the shape of the cross section may lead to slightly conservative values for the inner carcass and slightly unconservative values for the pressure armor 4 4 2 torsion combined with tension in this work clockwise positive and anticlockwise negative torsion were superimposed to a tensile load with the axial elongation restrained at both extremities anticlockwise torsion tensions the outer tensile armor wires and tights the studied flexible pipe while clockwise torsion tensions the inner wires and separates the tensile armor layers however the imposed tensile load was high enough to maintain all layers in contact and therefore the responses of the pipe to anticlockwise and clockwise torsions are expected to be close fig 20 a and fig 20b show that the twist per unit length in the intact and damaged 10 wires broken pipe varies linearly with the imposed torsional load the hysteretic loops observed during both the clockwise and anticlockwise load cycles in the experimental tests can be approximated with linear regression curves and the obtained torsional stiffnesses c 4 are presented in table 1 for all cases this table indicates a very good agreement among the numerical analytical eq 19 and experimental values moreover the anticlockwise and the clockwise stiffnesses are also close due to the imposed tensile load which avoids the separation between the tensile armor layers as in the case of pure tension the variation of the experimental normalized anticlockwise and clockwise torsional stiffnesses is slightly scattered but tends to decrease with the increasing number of broken wires as shown in fig 8 the fe and the analytical models predict normalized stiffnesses close to those measured in the experimental tests and these values are also similar to those obtained in the pure tension analyses table 1 also presents the numerical and analytical eq 17 values for the stiffness coupling coefficient c 2 this table indicates that the c 2 and c 3 fe values for the intact pipe are very close and the stiffness matrix eq 15 of the pipe can be assumed symmetric however when the pipe is damaged significant differences are observed in the clockwise and anticlockwise c 2 and between these values and c 3 leading to an unsymmetric stiffness matrix eq 15 the analytical model assumes that this matrix is always symmetric and analogously to what was observed in the pure tension analyses the analytical values of c 2 differ from the fe values due to the different assumptions on the relative slide of the pipe s layers however all models indicate that the pipe is more balanced if few wires are broken but if more than 3 or 5 wires are ruptured there is a significant increase in the extensional torsional unbalance again it is important to remark that the axial force induced by the imposed torsion is in all cases very small and difficult to measure as discussed in section 4 4 1 the strains in the outer tensile armor wires varied linearly with the imposed torsional loads and fig 21 presents the distribution of the strain ratios in these wires along the mid section of the intact pipe the experimental strain ratios vary from wire to wire but the anticlockwise values are more scattered than the clockwise ones in average the experimental anticlockwise strain ratio is 10 47 μm m knm with a standard deviation of 1 18 μm m knm while the experimental clockwise strain ratio is slightly higher and equals to 10 79 μm m knm with a standard deviation of 0 57 μm m knm the fe model estimates anticlockwise and clockwise strain ratios for the outer armor wires of 10 39 μm m knm and the analytical model eq 26 predicts 10 56 μm m knm all these values are close to the experimental ones the fe model also calculated a strain ratio of 10 78 μm m knm for the inner tensile armor wires and eq 26 indicates 10 56 μm m knm for both the clockwise and anticlockwise torsion neither the inner carcass nor the pressure armor had their stress states significantly altered by the torsional loads as indicated by eqs 29 and 30 and also by the fe model fig 22 presents the variation of the scfs in the wires of the outer tensile armor layer in the mid section damaged section of the pipe table 2 resumes the maximum scfs obtained in each case the experimental tests and the fe model show that the clockwise and the anticlockwise torsional scfs are close the maximum scf always occur in the wires close to the damaged ones but the measured strains reduce to values slightly lower than those obtained in the intact case in wires distant from those damaged the experimental tests indicate that the rupture of 1 wire of the outer armor increases the strains in the neighbor wires by 11 13 while the rupture of 2 wires increases the strains by 22 24 and the rupture of 10 wires approximately doubles the strains in the wires close to the damage the fe scfs correlate quite well with the experimental values while the analytical scfs eq 43 are not consistent with the experimental ones as discussed in section 4 4 1 furthermore the fe model presented negligible normal and binormal bending strains in the outer tensile armor wires in all cases and the effect of friction was very similar to the effect observed in the pure tension analyses the normalized total loads in the outer and inner tensile armors are presented in table 3 for both torsional conditions analyzed and as observed in the pure tension analyses there is a reduction in the total load acting on the outer tensile armor layer and an increase in the total load imposed on the inner layer moreover there is no difference in the acting total loads due to clockwise or anticlockwise torsion and the normalized loads are close to those obtained in the pure tension analyses fig 23 presents the fe distribution of the scfs in the outer fibers of the inner tensile armor wires along the damaged section of the pipe as discussed in section 4 4 1 the rupture of wires in the outer armor layer has global and local effects on the wires of the inner layer the normal strains in the wires of the inner layer increase due to force redistribution global effect and normal bending strains develop in wires below the damaged region of the outer layer due to the deformation of the pipe s core local effect in the case of anticlockwise torsion there is an increase in the compressive normal strains in the inner layer however below the damaged region tensile bending strains arise in the outer fibers of the inner wires due to the increase of the uneven squeeze pressure imposed by the tensile armors on the inner carcass and the pressure armor if less than 3 wires are broken the local effect governs the strains in the wires and the scfs below the damaged region decrease with the number of broken wires on the other hand if more wires are broken the global effect prevails and the scfs increase in the case of clockwise torsion tensile strains are induced by force redistribution but as the squeeze pressure imposed by the tensile armor layers are reduced due to the tendency of layer separation compressive strains also arise in the outer fibers below the damaged region therefore clockwise and anticlockwise torsion have similar responses table 4 summarizes the fe scfs below the damaged region and the factors associated with the increase in the normal strains the increase of the normal strains with respect to the intact condition vary from about 0 5 1 wire broken up to 15 10 wires broken while below the damaged region the strains reduce 2 4 when 3 wires are broken and if ten wires are broken in the outer layer the strains are about 9 higher than the values observed in the intact condition moreover the scfs predicted using eq 43 are also presented as the analytical model does not capture the local effect of the wire s damage in the outer layer only the increase in the normal strains is predicted the analytical values are close to those estimated by the fe model for wires far from the damage below the damaged region in the outer tensile armor layer the analytical and the fe scfs also agree quite well but in this region the fe model captures the local effect that reduce the strains in these fibers while the analytical model does not therefore if more wires are broken these values would probably tend to diverge fig 24 illustrates the strain ratios measured in the experimental tests considering 3 wires broken in the outer armor layer and the values predicted by the fe and the analytical models the experimental values vary from wire to wire as discussed in section 4 4 1 in the anti clockwise tests the average strain ratio equals 9 35 μm m knm with a standard deviation of 0 72 μm m knm in the clockwise tests the average value is 10 20 μm m knm with a standard deviation of 0 74 μm m knm the fe and analytical models indicate respectively 10 60 μm m knm and 10 82 μm m knm the experimental scfs for the inner wires were calculated by dividing the strains obtained in the tests with 4 or more wires broken in the outer tensile armor layer and the strains obtained in the condition with 3 wires broken in this layer fe and analytical scfs were also computed according to this definition and are presented in fig 25 and table 4 which indicate that the experimental values agreed well with the fe and the analytical predictions but the analytical scfs tend to be lower than the experimental and fe ones finally the fe model and eqs 29 30 and 44 indicates that the clockwise and anticlockwise torsional moments do not significantly modify the normal strains in the inner carcass and the pressure armor of the damaged flexible pipe however the local change of contact pressures between layers leads to a local change of curvature and consequently bending strains are induced in these layers the distributions of the bending moments and bending strains are quite similar to those observed in the pure tension analyses figs 17 and 18 but the scfs to these layers are not meaningful as the strains induced by torsion in the inner carcass and the pressure armor of the intact pipe are almost negligible therefore fig 26 shows the strain ratios in the outer fibers of these layers along the damaged region of the flexible pipe it is worth remarking that the anticlockwise and clockwise strain ratios are almost equal and the curves presented in fig 26 refer to both loads this figure indicates that in the damaged section the strain ratios are negative thus leading to compressive strains if clockwise torsion is imposed and otherwise tensile strains if anticlockwise torsion is imposed tensile strains are related to an increase in the curvature radius of these layers while compressive strains indicate a decrease in the curvature radius this mechanism as discussed previously affects the strains in the inner tensile armor wires 5 load capacity curves as discussed in section 4 4 the analytical and fe models agreed with the experimental measurements when the pipe was intact but while the response of the damaged pipe was quite well predicted by the fe model the analytical model failed to capture local stress changes however the analytical model has a much lower computational cost when compared to the fe model and its use if modified to account for these local effects would be attractive in this section therefore the analytical model is modified to calculate the tension vs torsion load capacity curves for the studied flexible pipe considering intact and damaged conditions these curves are obtained by combining the intact analytical response with the scfs calculated with the fe model to obtain utilization factors equal to those stablished by api spec 17j api 2014b api spec 17j api 2014b initially states that the utilization factors for the metallic layers are given by the ratio between the average stress in the layer and its structural capacity the average stress is estimated by uniformly distributing the total layer load among its wires or tendons and the structural capacity is the yield stress of the material that constitutes the layer or 0 9 times its ultimate tensile strength if the pipe is assumed to be installed in a water depth higher than 900 m under normal operating conditions and if recurrent functional and environmental loading is also assumed the utilization factors for the inner carcass pressure armor and tensile armors are 0 85 0 67 and 0 67 respectively the experimental and fe results presented in section 4 4 however indicate that the rupture of the tensile armor wires induces local stress concentrations in the metallic layers along the damaged region these local stresses are much higher than the average stress in the layer and if average stresses were employed to calculate the utilization factors in the metallic layers very unconservative results would be obtained for instance if the pipe was subjected to pure tension and ten wires were broken in their outer tensile armor layer the average stress in this layer would be 8 4 higher than the value calculated in the intact analysis while the experimental tests and the fe model show that the wires near to the damage have their stresses raised by about 100 if these wires fail and the imposed tensile load is maintained the adjacent wires would probably break leading to a progressive reduction in the overall structural capacity of the pipe and finally to its failure in cases that local wire stresses exceed the average stress in the tensile armor layer api api 2014a api 2014b recommends the use of these local stresses in the investigation of the associated potential damage mechanisms in the wire which are typically related to extreme and or abnormal operating conditions of the pipe these extreme stresses should not result in maximum local stresses higher than the material yield stress and or unacceptable deformations or crack initiation at any location in the armor wire cross section thus avoiding a possible progressive failure of the pipe in this work therefore this criterion is addressed by writing the utilization factor f u in a metallic layer in the form 46 f u max s c f n m e f ε x n r n x max s c f m m e f ε x m r m x ε y where ε y is the yield strain of the material that constitutes the metallic layer max s c f n m e f and max s c f m m e f are the maximum strain concentration factors calculated by the fe model for each metallic layer of the flexible pipe and induced by tensile and torsional loads respectively ε x n r and ε x m r are the strain ratios in each metallic layer due to the tensile and torsional loads respectively the strain ratios in the tensile armors are given by eq 23 tension and eq 26 torsion while eqs 29 and 30 are used to compute the strain ratios in the inner carcass and the pressure armor it is important to remark that eq 46 does not account for residual stresses in wires due to manufacturing and fat factory acceptance test but utilization factors associated with normal operating conditions api 2014b are assumed in this work for sake of conservatism furthermore as the analytical model does not account for layer separation the load capacity curves are calculated assuming only positive values for the squeeze pressure eq 28 and tensile strains in the outer tensile armor layer considering all these conditions fig 27 presents the load capacity curves obtained considering 0 intact up to 10 wires broken in the outer tensile armor layer of the 9 13 flexible pipe the internal region of all curves presented in fig 27 corresponds to the safe operational zone while the external region is the unsafe zone this figure indicates that for negative anticlockwise torsional moments the limit loads are governed by the response of the damaged outer tensile armor layer as its wires are tensioned by these moments if less than 5 wires are broken in the outer layer the tensile load reaches a peak but with increasing positive clockwise moments being imposed on the pipe the inner layer is tensioned and governs the response of the pipe the allowable tensile load thus decreases until layer separation and or compression in the outer layer occur if more than 5 wires are broken the tensile load is limited by excessive bending stresses in the pressure armor of the pipe until layer separation occurs or compressive stresses arise in the outer layer 6 final remarks the extensional torsional response of a flexible pipe with broken outer tensile armor wires was investigated with a modified version of the fe model proposed by de sousa et al de sousa et al 2009 and a simplified analytical model the results obtained with these models were compared to those from experimental tests in which pure tension and anticlockwise and clockwise torsion were imposed on the pipe the rupture of wires in the outer tensile armor layer led to a decrease in the axial tensile or torsional stiffness of the pipe associated with a progressive extensional torsional unbalance the decrease in the axial stiffness is approximately proportional to the ratio between the number of intact wires in the damaged pipe and the total number of wires in the intact pipe the extensional torsional balance is related to the ratio between the difference in the number of intact wires in the inner and outer tensile armors of the damaged pipe and the same difference in the intact pipe therefore when few outer tensile armor wires were broken the pipe became more balanced but the rupture of more wires increased the extensional torsional unbalance significantly it is also worth remarking that friction between layers is an important parameter to predict the extensional torsional unbalance of the damaged pipe the damaged wires tend to recover part of their loading capacity along the length of the pipe thus also recovering part of its intact stiffness and balance this is a key aspect for monitoring systems that rely on observations of the twist angle variation to detect damages in the tensile armor wires of flexible pipes significant stress strain concentration in the wires close to those damaged in the outer tensile armor layer was also observed nevertheless these stresses strains progressively reduced to values slightly lower than those observed in the intact structure in wires distant from the damaged region and no significant bending strains were observed moreover the scfs obtained in the pure tension and in the torsional analyses were very close suggesting that a single set of scfs could be considered the normal stresses strains in all inner tensile armor wires increased due to force redistribution among the layers of the pipe moreover the uneven pressure distribution imposed by the tensile armor layers deforms the core inner carcass and pressure armor of the pipe thus inducing significant bending strains in the inner wires below the damaged outer tensile armor wires it is important remarking that the increase in the normal strains is directly related to the boundary conditions assumed in this study the extremities of the pipe were restrained to twist pure tension or elongate torsion combined with tension on the other hand de sousa et al de sousa et al 2014 tested a flexible pipe on which pure tension was imposed considering one extremity free to rotate and no redistribution of forces to the inner wires was observed this aspect may be of interest in pull out operations de sousa et al 2014 as by allowing or restraining the twist of the pipe the operator can transfer load from a damaged layer to another possibly alleviating one of these layers the analyses also indicated that the rupture of tensile armor wires has little impact on the normal strains induced in the inner carcass and the pressure armor however the uneven squeeze pressure imposed by the tensile armor wires induced significant bending moments in these layers the computation of the maximum stresses strains in these layers should therefore account for these bending moments as well as the unsymmetrical cross sections of the tendons that constitute these layers the fe model managed to capture all these effects and agreed quite well with the experimental measurements the analytical model provided a reasonable insight into the mechanical response of the damaged pipe and predicted quite well the variation of the axial stiffness and the extensional torsional unbalance the force redistribution was also indicated but the model fails to evaluate local effects of the rupture of wires such as the stress strain concentrations in the wires close to those damaged and the induced bending strains to sum up this study relies on analyses of a single flexible pipe with few wires broken and specific boundary conditions more flexible pipes with a higher number of broken wires as well as other boundary and interlayer friction conditions have yet to be studied nevertheless this set of results provides a reasonable view of the impact of damaged tensile armor wires on the extensional torsional response of flexible pipes and furthermore the theoretical tools presented may help in the investigation of other flexible pipes subjected to different types of loads acknowledgments authors from coppe ufrj would like to thank petrobras for allowing the publication of this work and the first author also thanks the national council for scientific and technological development cnpq for the research grant pq 308403 2016 9 
23317,a dual tip optical fiber probe has been attempted to make measurement of bubble size in breaking waves especially for the violent and aerated bubble plumes presented immediately after breaking in laboratory and field however the performance of field measurement based on such probe is not satisfactory due to the measurement error produced by the large numbers of escaped and missing bubbles the objective of the present study and its companion are to evaluate the errors of bubble size measurement in breaking waves using a dual tip optical fiber probe and the errors were grouped as oncoming bubble errors receding bubble errors and missing bubble errors in terms of the bubble motion relative to the probe the study on errors shows that the incomplete velocity vector of bubble and missing pierced position vector where the tips contact the bubble are the major reasons for errors in order to make error correction this paper proposes a four tip optical fiber probe to obtain these two vectors and other required parameters the mathematical model of the recommended probe is derived which enables the bubble velocity components in the x y and z directions and the pierced position vector is the unique functions of several time intervals and probe s spatial distribution relationship the optimized algorithm is suggested to calculate the velocity vector the pierced position vector and other required parameters from time intervals taken from the output signals of the proposed probe the model and algorithm claim that the velocity vector of bubbles and pierced position vector can be obtained as long as the time intervals can be captured by four tip optical fiber probe verification and validation of the model is presented in the accompanying paper keywords breaking waves bubble size measurement error study dual tip optical fiber probe four tip optical fiber probe measurement modeling 1 introduction the size distribution of the entrained bubbles in breaking waves have been of great interest to engineers and oceanographers as they have great impacts on many geophysical processes including the generation of sea surface sound loewen and melville 1991 production of marine aerosols cipriano and blanchard 1981 and enrichment of the sea surface microlayer blanchard 1989 in order to quantify the influence of air entrainment on these processes many studies have been focused on the bubble size measurement by breaking waves in both the laboratory and field and the results show that the size distribution of the entrained bubbles is a controlling factor in these processes and the size distribution may be described by the bubble size distribution bsd or chord length distribution cld bsd may be represented either in terms of the equivalent diameters bsd deq or in terms of the bubble major axis bsd a which is used to the actual size distribution besagni et al 2016 besagni 2017 and the cld refers to the size distribution with a set of random chord length values rather than equivalent diameter or major axis in general non intrusive techniques i e image analysis are generally preferred over intrusive methods i e probes for bsd measurement and the probes are well known to provide cld the techniques used in existing investigations on the bubble size distribution generated by breaking waves in both the laboratory and ocean are classified as acoustic medwin 1970 vagle and farmer 1998 czerski et al 2011 photographic stokes and deane 1999 leifer et al 2003 geißler and jähne 1995 and probe serdula and loewen 1998 rojas and loewen 2007 blenkinsopp and chaplin 2007 photographic technique is commonly used to investigate the bsd from the images collected by different types of underwater imaging system deane and stokes teams have made invention and improvement on a waterproof camera placed in the interior of the bubble plumes generated by breaking waves and collect bsd data stokes and deane 1999 they find that the bubble density is proportional to the bubble radius to the power of 3 2 for small bubbles radius less than 1 0 mm and the smallest bubbles can be collected as small as 200 μm such camera has been also deployed in a shore based configuration data and power supplied via shore connected cables as well as an autonomous device in the open sea with its own power supply and data storage which have been used in ascos the arctic summer cloud ocean study leifer et al 2003 dogee the deep ocean gas exchange experiment geißler and jähne 1995 seasaw the sea spray gas flux and whitecap study norris et al 2011 and hiwase high wind air sea exchanges brooks et al 2009 to examine the bubble formation mechanisms acoustic techniques are also used to measure the void fraction and bsd in bubble plumes generated by breaking waves both in the ocean and laboratory for example medwin and co workers medwin 1970 vagle and farmer 1998 farmer et al 1998 czerski et al 2011 developed the acoustical resonator in order to make much more detailed measurements inside oceanic bubble plumes farmer et al made improvements on the original resonator design and carried out a theoretical analysis of its operation since then resonators have been used regularly to measure the size distributions of bubbles with radii between 16 and 300 μm vagle and farmer 1998 czerski et al 2011 moreover farmer and co workers extended the bubble population measurement to smaller radius less than 16 μm using improved acoustical resonator with higher frequency czerski et al 2011 in summary photographic technique is commonly used to investigate the bsd and bubble shapes because of its non intrusive nature it has been verified that this method is suitable for analyzing void fraction up to 5 besagni et al 2017 but this technology is not suitable for the dense bubble plume and large fraction active acoustic techniques for estimating oceanic bsd require relatively large dimensions for the instrument i e acoustic doppler velocimetry and acoustical resonator and may significantly disturb the flow resulting in frequent unreliable noisy data especially on the laboratory scale moreover the studies of this two techniques mainly focus on the subsequent periods after formation stage it is suggested that the life of a plume can be divided into four main phases formation injection rise and senescence de leeuw and leifer 2002 the bubble with large size and high void fraction during the formation stage can not be detected in acoustic and photographic methods and the large bubbles produced in the formation stage make a significant contribution to the air sea gas transfer velocity and the rapid degassing of the bubble plume after wave breaking de leeuw and leifer 2002 therefore it is necessary to measure the bsd inside these dense bubble plumes so as to quantify the influence of air entrainment on these geophysical processes more accurately in comparison with the aforementioned techniques the intrusive probe technique is much simpler and has a highly comparable accuracy in dense bubble plumes measurements of void fraction and velocity optical fiber phase detection probe is first used by miller and mitchie 1970 and described in detail by cartellier and achard 1991 following their pioneering work the optical fiber probes with single tip or dual tips have been extended to investigate the natural multiphase flow such as gas liquid two phase flows that occur at the air sea interface when bubbles are entrained by breaking waves serdula and loewen 1998 rojas and loewen 2007 blenkinsopp and chaplin 2007 2010 2011 loewen and co workers have compared the bsd and void fraction using the single tipped optical fiber probes with video image data in a unidirectional flow cell using a specialized flow cell system and in laboratory wave channel respectively it is found that the optical fiber probes could be used to obtain fairly accurate estimates of the void fraction in dense bubble plumes serdula and loewen 1998 loewen 1998 rojas and loewen 2007 blenkinsopp and chaplin follow the work of loewen and co workers they make more detailed measurements of the bsd in a laboratory wave channel including the influence on bubble size and void fraction produced by different types of water effect of scale on air entrainment by different breaking wave types blenkinsopp and chaplin 2007 2010 2011 it is concluded that the influence of water type may be relatively insignificant but the effect of scale may impact interpretation of the results the laboratory measurement of bubble size using optical fiber probes discussed in above studies confirm that the optical fiber probe technique can be used to make reasonable estimates of bsd in the dense bubble plumes entrained immediately beneath breaking waves however probes usually record chord lengths of bubbles rather than bubble vertical diameters or true bubble size the bsd is derived from the chord length distribution cld by using statistical algorithms hence another aim for these studies is to derive bsds from measured clds using reasonable algorithms it is concluded that a correlation between the bubble shape and size is essential for these process and the aspect ratio take a vital role in cld to bsd algorithms giorgio besagni proposed the aspect ratio correlation derived from the image analysis of dense plume the different aspect ratio correlation have been proposed according to the major axis of the bubble besagni et al 2016 furthermore the experimental error of the optical probe produced by three effects should be considered improper dewetting at the probe tip the blinding effect alteration of bubble trajectory prior to or during the piercing process the drifting effect bubble deformation and or deceleration at the probe tip the crawling effect the relative influence of these effects on the final residence time estimates as well as their absolute magnitude is not yet clear however the drifting effects was widely estimated in non perpendicular piercing experiments beneath breaking waves in laboratory where the probes are layed with variation of the impact angle rather than oriented at 90 or at 0 in existing experiments the results showing the drifting effects may be qualified by the impact angle furthermore an extra single tip optical fiber probe or a dual tip optical fiber probe d ofp is deployed in order to carry out an independent measure of the angle between the probe axis and bubble motion direction but it is capable of measuring the lager bubble rather than the angle between the probe axis and bubble motion direction blenkinsopp and chaplin 2010 the present article considers the inaccuracy of the optical probe technique in dense bubble plumes the first objective is to find proper parameters for correcting the errors produced by probes with one or two tips in the non perpendicular piercing experiments the second objective is to find the solution of estimated the proposed parameters that are responsible for inaccuracies in the cld the outline of this paper is as follows in section 2 we outline the basic measurement principle of an optical fiber probe with two tips the measurement error of this probe is analyzed in section 3 mathematical model of improved probe for making correction of error is presented in section 4 section 5 provides a detailed description of bubble parameters algorithm in the proposed model the conclusions are given in section 6 verification validation and the performance of the recommended model of the method are reported in the accompanying paper 2 bubble measurement principle of d ofp this section describes the measurement principle of optical fiber probe with two tips although the probes used in existing measurement have been equipped with only one tip the amount of probes is to be one or two in the same point the maximum number of tips employed in current studies is up to 2 it means that the researchers have attempted to use probes with more tips to make more accurate measurement for bubble size hence this study focuses on the bubble measurement theory of d ofp the measurement principle of optical fiber probes used for bubble size measurement is based on the fact that the critical angle for reflection refraction changes significantly in the different phases light that is sent into the fiber will leave the fiber if the tip is immersed in water while it will be reflected if air is present at the tip of the fiber there are two sensors in d ofp called as downstream sensor seen as a in fig 1 a and upstream sensor seen as b in fig 1 a which are aligned with the same direction by small distance and each sensor is constructed with two optical fibers one fiber for transmitting light and another for receiving it if the sensor tip is surrounded by liquid there is very little light reflected back but if it pierces a gas bubble the light is almost totally reflected the reflected light is transmitted back to the signal conditioning module via the second optical fiber the signal measured is the amount of light detected at the signal conditioning module thus a low signal level indicates water whereas a high level indicates air the typical output signals from the d ofp are shown in fig 1 b with the acquired signals from the sensor the bubble velocity v is given by 1 v 1 2 s t 2 t 1 s t 4 t 3 where is the distance between downstream sensor and upstream sensor t 1 is the time when bubble impacts the downstream sensor t 2 is the time when bubble impacts the upstream sensor t 3 is the time when downstream sensor takes to fully penetrate the bubble t 4 is the time when upstream sensor takes to fully penetrate the bubble the void fraction can be also measured by the d ofp α p is given by 2 α p 1 t i 1 n b t g i where t g i is the gas residence time of the ith bubble n b is the total number of bubbles for which the gas residence time was measured and t is the total sampling time furthermore the probability density function of the diameters of bubbles can be found from the probability density function of the chord of bubbles 3 p c y y 2 α y α 2 r 2 p p r d r where p p r is the probability density function of the sizes of bubbles r is the radius of bubbles α is the ratio of semi major axis and semi minor axis of ellipse as shown in fig 1 c 3 the measurement error evaluation of d ofp the laboratory and field experiments on bubble size measurement using optical fiber probes are based on the two indispensable assumptions the one is that the probes were aligned perpendicular or parallel to bubble plumes generated by breaking waves another is the bubbles have spherical shapes without size changes and do not alter their moving courses between the two probe tips in a real two phase bubble flow bubbles have variable shapes and move in a complicated manner it means some bubbles is to escape from the probe and some bubbles to be deformed and changed in their velocity magnitudes and directions in the probe bubble touching processes these effects somewhat decrease the reliability of the optical fiber probe measurement and should be analyzed and evaluated accurately according to the bubble motion relative to the probe the measurement errors were categorized as follows i the error produced by oncoming bubbles the bubbles move against the probe with certain angle between 0 and 90 which ensures that the downstream sensor piece the bubble first ahead of upstream sensor as shown in fig 2 a ii the error produced by receding bubbles the bubbles move opposite to the probe orientation which ensures that the upstream sensor piece the bubble first ahead of downstream sensor as shown in fig 2 b iii the error produced by transversal bubbles the bubbles move in the direction nearly perpendicular to the probe orientation touch the front sensor tip and the rear sensor tip simultaneously in fig 2 c or touch the front sensor tip but miss the rear sensor tip called as missing bubbles the situation of fig 2 c can be regarded as bubble impact the single tip optical fiber probes and it is very difficult to evaluate the velocity change and the measurement error from missing bubbles to analyze the measurement errors in the bubble velocity and bubble chord length obtained by a dual tip probe some assumptions are made refer to fig 2 1 the bubbles have a symmetric plane e g spherical or ellipsoidal bubbles 2 the bubble shape fluctuation and deformation of the bubble due to its interaction with the probe are neglected 3 the bubble velocity vector magnitude and direction does not change during the bubble passing by the probe three types of measurement errors mentioned above are discussed in details as below i the error produced by oncoming bubbles with these assumptions considering the lateral motion the velocity of bubble is given by eq 1 and then the velocity magnitude of category i will be refined as follows 4 v 1 2 s cos θ t 2 t 1 s cos θ t 4 t 3 the relative error in the measurements of the bubble vertical velocity component is 5 δ v v v v s t 2 t 1 s t 4 t 3 s cos θ t 2 t 1 s cos θ t 4 t 3 s cos θ t 2 t 1 s cos θ t 4 t 3 100 1 cos θ 1 100 the relative errors predicted by eq 5 are shown in fig 3 it can be seen that the errors are always nonnegative the magnitude of the bubble velocity vector obtained by d ofp is always larger than the real value the errors increase with the value of θ it can be as large as 100 at θ 60 and it is even larger at larger θ values until it goes to infinity at θ 90 ii the error produced by receding bubbles the error in the catalogue ii can be considered as the similar case of catalogue i but the four intervals are redefined t 2 is the time when bubble impacts the downstream sensor t 1 is the time when bubble impacts the upstream sensor t 4 is the time when downstream sensor takes to fully penetrate the bubble t 3 is the time when upstream sensor takes to fully penetrate the bubble and the velocity vector and the relative error of the bubble is same as the catalogue i iii the error produced by transversal bubbles it is difficult to evaluate the error produced by the transversal bubbles but when the bubble impact one of the tips the measurement error can be estimated the bubble is treated as if they are measured by the single tip probe and the velocity vector of bubble can be corrected by a correction coefficient α 6 α n s n b where n s and n b are the bubble numbers detected by one sensor of a probe and the effective bubble numbers sensed by all sensors of a probe respectively and the velocity magnitude of bubble can be refined as 7 v n s 2 n b s t 2 t 1 s t 4 t 3 hence the key aim of making correction of bubble size measurement is to correct the error produced by the oncoming bubbles fig 3 shows that the results from d ofp is reasonable when angle between the bubble velocity vector and the probe axial direction is less than 10 it means that d ofp can only be used in the situations where all bubbles move strictly in one direction such as in forced concurrent gas liquid flow in pipes and are not suitable for systems with complex flow dynamics such as bubble plume alpha plumes in breaking waves so it is essential to design a new probes and algorithms for obtaining more details of bubble motion especially for the angle between probe orientation and bubble motion in bubble plumes beneath breaking waves 4 theoretical model of the proposed optical probe to overcome the limitation of d ofp several researchers have used multi tip optical fiber probes to evaluate the angle between probe orientation and bubble motion in gas liquid flow in chemical industry luther et al 2004 shen et al 2008 euh et al 2001 the four tip optical fiber probe f ofp is widely used for gas liquid flow measurement but the data processing algorithm employed in these studies is questionable in this section the theoretical model of this probe is described and the new data processing algorithm is proposed the mathematic model of f ofp based d ofp is shown in fig 4 there are four sensors including the leading tip p0 and three lateral tips p1 p3 p0 and p2 are aligned along the z axis with a distance of l p1 and p3 are at distances d 1 and d 2 from p0 along the x and y axis respectively each pair of the front sensor and one rear sensor can be considered as a d ofp which means there are three d ofp in a f ofp and the principle of f ofp is similar to the d ofp the theoretical model is based on the following assumptions 1 there are many shapes of bubbles such as ellipse spherical and oblate spheroid etc the model presented in this study is valid only for spherical bubbles considering the alpha bubble plume is characterized by large size experimental observation has indicated that large bubbles with diameters in the range 20 mm d 64 mm were detected by probes and bubbles were nearly spherical blenkinsopp and chaplin 2010 on the other side experimental observation using optical probe and image analysis has indicated that in gas in oil flows the largest oil droplets up to about 8 mm in size tend to be oblate spheroids for these large droplets the ratio of the length of the shortest axis to the length of the longest axis defined herein as the aspect ratio has been observed by several researchers the same solution will be adopted in the verification and validation experiments in our accompanying paper in which the errors in bubble size measurement associated with non sphericity are discussed in detail 2 the bubble velocity vector magnitude and direction does not change during the measurement interval 3 the shape fluctuation and deformation of the bubble caused by its interaction with the probe are neglected 4 the bubble surface contacts all of the rear sensors twice first when the bubble initially contacts a sensor and second when the bubble leaves the sensor 5 all of the bubbles hit the front p0 first head of the other three rear sensors this assumption is realistic since p0 is the leading sensor the probe s coordinate system is shown in fig 4 we assume that a bubble moves with a velocity vector v across the f ofp this velocity vector can be written as 8 v v η ˆ v sin α sin β i sin α cos β j cos α k where v is the magnitude of the bubble velocity and η ˆ is the unit vector representing direction of velocity i j and k are unit vectors in x y z directions respectively α and β are the polar and azimuthal angle associated with v as shown in fig 4 c respectively α implies the angle between the bubble motion and the z axis whereas β implies the angle between the projection of the bubble motion in oxy plane and the x axis let us suppose that the bubble moves against the probe and impact the leading tip p0 and then the pierced position vector p is given as 9 p r ξ ˆ r sin ϕ sin φ i sin ϕ cos φ j cos ϕ k where r is the radius of the bubble and ξ ˆ is the unit vector in the direction of p the definitions of i j and k are same as eq 8 and the distance vector of leading tip to the three rear tips s 0 1 s 0 2 and s 0 3 can be written as 10 s 0 1 d 1 j l k 11 s 0 2 l k 12 s 0 3 d 2 i l k since p is the pierced position vector which is on the surface of spherical bubbles then it can be expressed as 13 p p r 2 if the bubble moves from this position and reaches sensor p1 after time δ t 1 as shown in fig 4 a according to the triangle rule of vector addition the relation among s s 0 1 p and v δ t 1 can be written as 14 s p s 0 1 v δ t 1 and s is also on the surface of spherical bubble it can be expressed as 15 s s r 2 substituting eqs 8 10 and eq 14 into eq 15 we can obtain 16 v 2 δ t 1 2 2 v δ t 1 l η ˆ k d 1 η ˆ j r η ˆ ξ ˆ d 1 2 l 2 2 d 1 r ξ ˆ j 2 r ξ ˆ k 0 eq 16 can be considered as a quadratic equation in δ t 1 the two solutions denoted as δ t 1 a and δ t 1 b are solved as 17 δ t 1 a δ t 1 b l η ˆ k d 1 η ˆ j r η ˆ ξ ˆ l η ˆ k d 1 η ˆ j r η ˆ ξ ˆ 2 d 1 2 l 2 2 d 1 r ξ ˆ j 2 r ξ ˆ k v the first solution the smaller value of time δt 1 a gives the time interval between the bubble surface first contacting p0 and then first contacting p1 the second solution the larger value of time δt 1 b corresponds to the time interval between the bubble surface first impacting p0 and then leaving p1 since each pair of the front sensor and one rear sensor can be considered as a d ofp the following equation is valid for the times δt 2 δt 3 when the bubble surface comes into contact with p3 and p2 respectively the moving trial of bubble can also be given by 18 v 2 δ t 2 2 2 v δ t 2 l η ˆ k d 2 η ˆ i r η ˆ ξ ˆ d 2 2 l 2 2 d 1 r ξ ˆ i 2 r ξ ˆ k 0 19 v 2 δ t 3 2 2 v δ t 3 l η ˆ k r η ˆ ξ ˆ d 2 2 l 2 2 r l ξ ˆ k 0 and the solutions of eqs 18 and 19 can be written in terms of time delays δt 2 a δt 2 b δt 3 a and δt 3 b δt 3 b as shown below 20 δ t 2 a δ t 2 b l η ˆ k d 2 η ˆ i r η ˆ ξ ˆ l η ˆ k d 2 η ˆ i r η ˆ ξ ˆ 2 d 2 2 l 2 2 d 2 r ξ ˆ i 2 r ξ ˆ k v 21 δ t 3 a δ t 3 b l η ˆ k r η ˆ ξ ˆ l η ˆ k r η ˆ ξ ˆ 2 l 2 2 r l ξ ˆ k v where δ t 2 a is the time interval between the bubble surface first contacting p0 and then first contacting p2 δ t 2 b the larger value of time corresponds to the time interval between the bubble surface first contacting p0 and then leaving p2 where δ t 3 a is the time interval between the bubble surface first contacting p0 and then first contacting p3 δ t 3 b the larger value of time corresponds to the time interval between the bubble surface first contacting p0 and then leaving p3 the parameters in the mathematical model of f ofp based eqs 16 18 and 19 can be classified as follows 1 three couples of time intervals δ t 1 a δ t 1 b δ t 2 a δ t 2 b δ t 3 a and δ t 3 b when three d ofp contact the bubble respectively 2 the parameters of bubble plume including the radius r the direction of bubble motion α and β the velocity of bubble motion v the position angles where the tips contact the bubbles ϕ and φ the first group can be defined as the functions of the latter parameters in the second group therefore if the time intervals including δ t 1 a δ t 1 b δ t 2 a δ t 2 b δ t 3 a and δ t 3 b can be measured firstly the parameters of bubble plume can be estimated in theory 5 the proposed data processing algorithm of bubble parameters the algorithms for f ofp are shown in fig 5 the signal processing is composed of four processes as described below 1 the smoothing process 2 the determination of thresholds process 3 the detection of time intervals of bubble impact the tips 4 the calculation of velocity vector the pierced position vector and other required parameters since the first two processes involve the true signal collected by probes this section will give the key points of the last two processes to solve eqs 16 18 and 19 a computational procedure is described as follows in details in this computational procedure the three distances d 1 d 2 and l and the six time delays δ t 1 a δ t 1 b δ t 2 a δ t 2 b δ t 3 a and δ t 3 b are the input parameters the direction of bubble motion β and α the position angles where the tips contact the bubbles ϕ and φ the radius of bubble r and the speed of bubble motion v are the output parameters they are calculated by following schedules step 1 input six time internals output the azimuthal angle β according to the relation between coefficient and solution of quadratic equations the solutions of eqs 16 18 and 19 can be written as 22 δ t 1 a δ t 1 b 2 l cos α d 1 sin α cos β r sin α sin β sin ϕ sin φ r sin α cos β sin ϕ cos φ r cos α cos ϕ v 23 δ t 2 a δ t 2 b 2 l cos α d 2 sin α sin β r sin α sin β sin ϕ sin φ r sin α cos β sin ϕ cos φ r cos α cos ϕ v 24 δ t 3 a δ t 3 b 2 l cos α r sin α sin β sin ϕ sin φ r sin α cos β sin ϕ cos φ r cos α cos ϕ v 25 δ t 1 a δ t 1 b d 1 2 l 2 2 d 1 r sin ϕ cos φ 2 r cos ϕ v 2 26 δ t 2 a δ t 2 b d 2 2 l 2 2 d 1 r sin ϕ sin φ 2 r cos ϕ v 2 27 δ t 3 a δ t 3 b d 2 2 l 2 2 r l cos ϕ v 2 transform eqs 22 24 into 28 δ t 1 a δ t 1 b δ t 3 a δ t 3 b 2 d 1 sin α cos β v 29 δ t 2 a δ t 2 b δ t 3 a δ t 3 b 2 d 2 sin α sin β v eq 29 divides eq 28 the azimuthal angle β associated with v can be calculated 30 tan β δ t 2 a δ t 2 b δ t 3 a δ t 3 b d 1 δ t 1 a δ t 1 b δ t 3 a δ t 3 b d 2 step 2 give assumed velocity amplitude output the polar angle α next we must assume a value of v the angle α can be calculated using eqs 22 24 31 2 δ t 1 a 2 δ t 1 b δ t 3 a δ t 3 b δ t 2 a δ t 2 b 2 sin α 2 d 1 cos β d 2 sin β v eq 31 also has the form 32 sin α 2 δ t 1 a 2 δ t 1 b δ t 3 a δ t 3 b δ t 2 a δ t 2 b v 2 2 d 1 cos β d 2 sin β step 3 continuing to output the azimuthal angle φ continuing to transform eqs 25 27 become 33 δ t 1 a δ t 1 b v 2 d 1 2 l 2 2 d 1 r sin ϕ cos φ 2 r cos ϕ 34 δ t 2 a δ t 2 b v 2 d 2 2 l 2 2 d 1 r sin ϕ sin φ 2 r cos ϕ 35 2 r cos ϕ δ t 3 a δ t 3 b v 2 d 2 2 l 2 l substituting 2 r cos ϕ of eq 35 into eqs 33 and 34 the azimuthal angle of tip contact the bubble φ is given by 36 cos φ δ t 1 a δ t 1 b v 2 d 1 2 l 2 δ t 3 a δ t 3 b v 2 d 2 2 l 2 l 2 d 1 r sin ϕ 37 sin φ δ t 2 a δ t 2 b v 2 d 2 2 l 2 δ t 3 a δ t 3 b v 2 d 2 2 l 2 l 2 d 2 r sin ϕ eq 37 is divided by eq 36 38 φ arctan l δ t 2 a δ t 2 b v 2 δ t 3 a δ t 3 b v 2 l 3 l 2 l d 2 2 d 2 2 d 1 l δ t 1 a δ t 1 b v 2 δ t 3 a δ t 3 b v 2 l 3 l 2 l d 1 2 d 2 2 d 2 step 4 input the assumed velocity and azimuthal angle φ output polar angle of the pierced position vector ϕ from eq 35 the ϕ can be written as 39 cos ϕ δ t 3 a δ t 3 b v 2 d 2 2 l 2 2 r l eq 36 can be written as 40 sin ϕ δ t 1 a δ t 1 b v 2 d 1 2 l 2 δ t 3 a δ t 3 b v 2 d 2 2 l 2 l 2 d 1 r cos φ eq 40 divides eq 39 the ϕ can be calculated 41 ϕ arctan l δ t 1 a δ t 1 b v 2 δ t 3 a δ t 3 b v 2 l 3 l 2 l d 1 2 d 2 2 d 1 cos φ δ t 3 a δ t 3 b v 2 d 2 2 l 2 step 5 input the assumed velocity and polar angle ϕ output bubble radius r if the ϕ is known the radius of bubble r can be obtained from the eq 39 42 r δ t 3 a δ t 3 b v 2 d 2 2 l 2 2 l cos ϕ step 6 input bubble radius r output bubble velocity amplitude v from eqs 30 32 38 39 and 42 the five parameters β α ϕ φ and r are known when v is assumed since v is the function of the radius of bubble r the calculating procedure is described in details as bellow transform eqs 25 27 become 43 δ t 1 a δ t 1 b v 2 d 1 2 l 2 2 d 1 r sin ϕ cos φ 2 r cos ϕ 44 δ t 2 a δ t 2 b v 2 d 2 2 l 2 2 d 1 r sin ϕ sin φ 2 r cos ϕ 45 δ t 3 a δ t 3 b v 2 d 2 2 l 2 2 r l cos ϕ eq 45 can be written as 46 2 r cos ϕ δ t 3 a δ t 3 b v 2 d 2 2 l 2 l substituting for 2 r cos ϕ using eq 46 eq 43 becomes 47 δ t 1 a δ t 1 b v 2 d 1 2 l 2 2 d 1 r sin ϕ cos φ δ t 3 a δ t 3 b v 2 d 2 2 l 2 l continue to transform eq 47 48 cos φ δ t 1 a δ t 1 b l δ t 3 a δ t 3 b v 2 l 3 l 2 l d 1 2 d 2 2 2 d 1 l r sin ϕ substituting for 2 r cos ϕ using eq 46 eq 44 becomes 49 δ t 2 a δ t 2 b v 2 d 2 2 l 2 2 d 1 r sin ϕ sin φ δ t 3 a δ t 3 b v 2 d 2 2 l 2 l continue to transform eq 49 50 sin φ δ t 2 a δ t 2 b l δ t 3 a δ t 3 b v 2 l 3 l 2 l d 2 2 d 2 2 2 d 1 l r sin ϕ according to the trigonometric function relationship 51 sin 2 φ cos 2 φ 1 substituting for cos φ and sin φ using eq 48 and eq 50 respectively we can obtain 52 sin 2 ϕ δ t 1 a δ t 1 b l δ t 3 a δ t 3 b v 2 l 3 l 2 l d 1 2 d 2 2 2 δ t 2 a δ t 2 b l δ t 3 a δ t 3 b v 2 l 3 l 2 l d 2 2 d 2 2 2 4 d 1 2 l 2 r 2 similarly 53 sin 2 ϕ cos 2 ϕ 1 substituting for cos ϕ and sin ϕ using eq 46 and eq 52 respectively and let a δ t 1 a δ t 1 b l δ t 3 a δ t 3 b b l 3 l 2 l d 1 2 d 2 2 c δ t 2 a δ t 2 b l δ t 3 a δ t 3 b d l 3 l 2 l d 2 2 d 2 2 e δ t 3 a δ t 3 b f d 2 2 l 2 the eq 53 becomes 54 4 d 1 2 r 2 l 2 a v 2 b 2 c v 2 d 2 e v 2 f 2 d 1 2 eq 54 becomes a quadratic equation of v 2 55 a 2 c 2 e 2 d 1 2 v 4 2 ab 2 cd 2 ef d 1 2 v 2 b 2 d 2 f 2 d 1 2 4 d 1 2 r 2 l 2 0 the solution of eq 54 can be written as 56 v 2 ab 2 cd 2 ef d 1 2 2 ab 2 cd 2 ef d 1 2 2 4 a 2 c 2 e 2 d 1 2 b 2 d 2 f 2 d 1 2 4 d 1 2 r 2 l 2 2 a 2 c 2 e 2 d 1 2 step 7 this computed velocity magnitude will be compared with the assumed velocity magnitude until the assumed and the computed velocity magnitudes agree to a very high level of accuracy at which point it is assumed that the calculated values of α β ϕ φ and r are the correct values 6 summary the presented work was dedicated to investigate the performance of a d ofp on the determination of the bubble velocity in bubble plume in breaking waves in theory and a f ofp was proposed to be employed for compensating its error the following conclusions are drawn from this work first of all the measurement error of a d ofp are classified as three types including oncoming bubble errors receding bubble errors and missing bubble errors in terms of the bubble motion relative to the probe the conclusion based on theoretical calculation confirmed that three errors can be transformed as the error caused by bubble s lateral movement and the measure results using a d ofp is reasonable only in the case that the angle between the bubble velocity vector and the probe axial direction is less than 10 therefore the simultaneous velocity vector and the pierced position vector measurement is proposed to carry out for further compensation the errors produced by a d ofp second of all a solution of the velocity vector and the pierced position vector measurement for bubble plumes beneath breaking waves is described in detail the solution is composed of a mathematical model for a f ofp and an optimized algorithm for bubble plumes parameters from the raw data collected by the probe there commended model is conducted by three quadratic equations which include six unknown parameters including the velocity vector amplitude polar and azimuthal angle the pierced position vector polar and azimuthal angle and bubble radius the solution algorithm for six parameters is a combination of the relation between coefficient and solution of quadratic equations and iteration algorithms that use a variable corrector the corrector is the difference of the assumed velocity and calculated velocity by the optimized procedure a detailed verification and validation of the model are presented in accompanying paper acknowledgements the authors acknowledge the support of the national natural science foundation of china grant funded by the national natural science found grant no 41706109 
23317,a dual tip optical fiber probe has been attempted to make measurement of bubble size in breaking waves especially for the violent and aerated bubble plumes presented immediately after breaking in laboratory and field however the performance of field measurement based on such probe is not satisfactory due to the measurement error produced by the large numbers of escaped and missing bubbles the objective of the present study and its companion are to evaluate the errors of bubble size measurement in breaking waves using a dual tip optical fiber probe and the errors were grouped as oncoming bubble errors receding bubble errors and missing bubble errors in terms of the bubble motion relative to the probe the study on errors shows that the incomplete velocity vector of bubble and missing pierced position vector where the tips contact the bubble are the major reasons for errors in order to make error correction this paper proposes a four tip optical fiber probe to obtain these two vectors and other required parameters the mathematical model of the recommended probe is derived which enables the bubble velocity components in the x y and z directions and the pierced position vector is the unique functions of several time intervals and probe s spatial distribution relationship the optimized algorithm is suggested to calculate the velocity vector the pierced position vector and other required parameters from time intervals taken from the output signals of the proposed probe the model and algorithm claim that the velocity vector of bubbles and pierced position vector can be obtained as long as the time intervals can be captured by four tip optical fiber probe verification and validation of the model is presented in the accompanying paper keywords breaking waves bubble size measurement error study dual tip optical fiber probe four tip optical fiber probe measurement modeling 1 introduction the size distribution of the entrained bubbles in breaking waves have been of great interest to engineers and oceanographers as they have great impacts on many geophysical processes including the generation of sea surface sound loewen and melville 1991 production of marine aerosols cipriano and blanchard 1981 and enrichment of the sea surface microlayer blanchard 1989 in order to quantify the influence of air entrainment on these processes many studies have been focused on the bubble size measurement by breaking waves in both the laboratory and field and the results show that the size distribution of the entrained bubbles is a controlling factor in these processes and the size distribution may be described by the bubble size distribution bsd or chord length distribution cld bsd may be represented either in terms of the equivalent diameters bsd deq or in terms of the bubble major axis bsd a which is used to the actual size distribution besagni et al 2016 besagni 2017 and the cld refers to the size distribution with a set of random chord length values rather than equivalent diameter or major axis in general non intrusive techniques i e image analysis are generally preferred over intrusive methods i e probes for bsd measurement and the probes are well known to provide cld the techniques used in existing investigations on the bubble size distribution generated by breaking waves in both the laboratory and ocean are classified as acoustic medwin 1970 vagle and farmer 1998 czerski et al 2011 photographic stokes and deane 1999 leifer et al 2003 geißler and jähne 1995 and probe serdula and loewen 1998 rojas and loewen 2007 blenkinsopp and chaplin 2007 photographic technique is commonly used to investigate the bsd from the images collected by different types of underwater imaging system deane and stokes teams have made invention and improvement on a waterproof camera placed in the interior of the bubble plumes generated by breaking waves and collect bsd data stokes and deane 1999 they find that the bubble density is proportional to the bubble radius to the power of 3 2 for small bubbles radius less than 1 0 mm and the smallest bubbles can be collected as small as 200 μm such camera has been also deployed in a shore based configuration data and power supplied via shore connected cables as well as an autonomous device in the open sea with its own power supply and data storage which have been used in ascos the arctic summer cloud ocean study leifer et al 2003 dogee the deep ocean gas exchange experiment geißler and jähne 1995 seasaw the sea spray gas flux and whitecap study norris et al 2011 and hiwase high wind air sea exchanges brooks et al 2009 to examine the bubble formation mechanisms acoustic techniques are also used to measure the void fraction and bsd in bubble plumes generated by breaking waves both in the ocean and laboratory for example medwin and co workers medwin 1970 vagle and farmer 1998 farmer et al 1998 czerski et al 2011 developed the acoustical resonator in order to make much more detailed measurements inside oceanic bubble plumes farmer et al made improvements on the original resonator design and carried out a theoretical analysis of its operation since then resonators have been used regularly to measure the size distributions of bubbles with radii between 16 and 300 μm vagle and farmer 1998 czerski et al 2011 moreover farmer and co workers extended the bubble population measurement to smaller radius less than 16 μm using improved acoustical resonator with higher frequency czerski et al 2011 in summary photographic technique is commonly used to investigate the bsd and bubble shapes because of its non intrusive nature it has been verified that this method is suitable for analyzing void fraction up to 5 besagni et al 2017 but this technology is not suitable for the dense bubble plume and large fraction active acoustic techniques for estimating oceanic bsd require relatively large dimensions for the instrument i e acoustic doppler velocimetry and acoustical resonator and may significantly disturb the flow resulting in frequent unreliable noisy data especially on the laboratory scale moreover the studies of this two techniques mainly focus on the subsequent periods after formation stage it is suggested that the life of a plume can be divided into four main phases formation injection rise and senescence de leeuw and leifer 2002 the bubble with large size and high void fraction during the formation stage can not be detected in acoustic and photographic methods and the large bubbles produced in the formation stage make a significant contribution to the air sea gas transfer velocity and the rapid degassing of the bubble plume after wave breaking de leeuw and leifer 2002 therefore it is necessary to measure the bsd inside these dense bubble plumes so as to quantify the influence of air entrainment on these geophysical processes more accurately in comparison with the aforementioned techniques the intrusive probe technique is much simpler and has a highly comparable accuracy in dense bubble plumes measurements of void fraction and velocity optical fiber phase detection probe is first used by miller and mitchie 1970 and described in detail by cartellier and achard 1991 following their pioneering work the optical fiber probes with single tip or dual tips have been extended to investigate the natural multiphase flow such as gas liquid two phase flows that occur at the air sea interface when bubbles are entrained by breaking waves serdula and loewen 1998 rojas and loewen 2007 blenkinsopp and chaplin 2007 2010 2011 loewen and co workers have compared the bsd and void fraction using the single tipped optical fiber probes with video image data in a unidirectional flow cell using a specialized flow cell system and in laboratory wave channel respectively it is found that the optical fiber probes could be used to obtain fairly accurate estimates of the void fraction in dense bubble plumes serdula and loewen 1998 loewen 1998 rojas and loewen 2007 blenkinsopp and chaplin follow the work of loewen and co workers they make more detailed measurements of the bsd in a laboratory wave channel including the influence on bubble size and void fraction produced by different types of water effect of scale on air entrainment by different breaking wave types blenkinsopp and chaplin 2007 2010 2011 it is concluded that the influence of water type may be relatively insignificant but the effect of scale may impact interpretation of the results the laboratory measurement of bubble size using optical fiber probes discussed in above studies confirm that the optical fiber probe technique can be used to make reasonable estimates of bsd in the dense bubble plumes entrained immediately beneath breaking waves however probes usually record chord lengths of bubbles rather than bubble vertical diameters or true bubble size the bsd is derived from the chord length distribution cld by using statistical algorithms hence another aim for these studies is to derive bsds from measured clds using reasonable algorithms it is concluded that a correlation between the bubble shape and size is essential for these process and the aspect ratio take a vital role in cld to bsd algorithms giorgio besagni proposed the aspect ratio correlation derived from the image analysis of dense plume the different aspect ratio correlation have been proposed according to the major axis of the bubble besagni et al 2016 furthermore the experimental error of the optical probe produced by three effects should be considered improper dewetting at the probe tip the blinding effect alteration of bubble trajectory prior to or during the piercing process the drifting effect bubble deformation and or deceleration at the probe tip the crawling effect the relative influence of these effects on the final residence time estimates as well as their absolute magnitude is not yet clear however the drifting effects was widely estimated in non perpendicular piercing experiments beneath breaking waves in laboratory where the probes are layed with variation of the impact angle rather than oriented at 90 or at 0 in existing experiments the results showing the drifting effects may be qualified by the impact angle furthermore an extra single tip optical fiber probe or a dual tip optical fiber probe d ofp is deployed in order to carry out an independent measure of the angle between the probe axis and bubble motion direction but it is capable of measuring the lager bubble rather than the angle between the probe axis and bubble motion direction blenkinsopp and chaplin 2010 the present article considers the inaccuracy of the optical probe technique in dense bubble plumes the first objective is to find proper parameters for correcting the errors produced by probes with one or two tips in the non perpendicular piercing experiments the second objective is to find the solution of estimated the proposed parameters that are responsible for inaccuracies in the cld the outline of this paper is as follows in section 2 we outline the basic measurement principle of an optical fiber probe with two tips the measurement error of this probe is analyzed in section 3 mathematical model of improved probe for making correction of error is presented in section 4 section 5 provides a detailed description of bubble parameters algorithm in the proposed model the conclusions are given in section 6 verification validation and the performance of the recommended model of the method are reported in the accompanying paper 2 bubble measurement principle of d ofp this section describes the measurement principle of optical fiber probe with two tips although the probes used in existing measurement have been equipped with only one tip the amount of probes is to be one or two in the same point the maximum number of tips employed in current studies is up to 2 it means that the researchers have attempted to use probes with more tips to make more accurate measurement for bubble size hence this study focuses on the bubble measurement theory of d ofp the measurement principle of optical fiber probes used for bubble size measurement is based on the fact that the critical angle for reflection refraction changes significantly in the different phases light that is sent into the fiber will leave the fiber if the tip is immersed in water while it will be reflected if air is present at the tip of the fiber there are two sensors in d ofp called as downstream sensor seen as a in fig 1 a and upstream sensor seen as b in fig 1 a which are aligned with the same direction by small distance and each sensor is constructed with two optical fibers one fiber for transmitting light and another for receiving it if the sensor tip is surrounded by liquid there is very little light reflected back but if it pierces a gas bubble the light is almost totally reflected the reflected light is transmitted back to the signal conditioning module via the second optical fiber the signal measured is the amount of light detected at the signal conditioning module thus a low signal level indicates water whereas a high level indicates air the typical output signals from the d ofp are shown in fig 1 b with the acquired signals from the sensor the bubble velocity v is given by 1 v 1 2 s t 2 t 1 s t 4 t 3 where is the distance between downstream sensor and upstream sensor t 1 is the time when bubble impacts the downstream sensor t 2 is the time when bubble impacts the upstream sensor t 3 is the time when downstream sensor takes to fully penetrate the bubble t 4 is the time when upstream sensor takes to fully penetrate the bubble the void fraction can be also measured by the d ofp α p is given by 2 α p 1 t i 1 n b t g i where t g i is the gas residence time of the ith bubble n b is the total number of bubbles for which the gas residence time was measured and t is the total sampling time furthermore the probability density function of the diameters of bubbles can be found from the probability density function of the chord of bubbles 3 p c y y 2 α y α 2 r 2 p p r d r where p p r is the probability density function of the sizes of bubbles r is the radius of bubbles α is the ratio of semi major axis and semi minor axis of ellipse as shown in fig 1 c 3 the measurement error evaluation of d ofp the laboratory and field experiments on bubble size measurement using optical fiber probes are based on the two indispensable assumptions the one is that the probes were aligned perpendicular or parallel to bubble plumes generated by breaking waves another is the bubbles have spherical shapes without size changes and do not alter their moving courses between the two probe tips in a real two phase bubble flow bubbles have variable shapes and move in a complicated manner it means some bubbles is to escape from the probe and some bubbles to be deformed and changed in their velocity magnitudes and directions in the probe bubble touching processes these effects somewhat decrease the reliability of the optical fiber probe measurement and should be analyzed and evaluated accurately according to the bubble motion relative to the probe the measurement errors were categorized as follows i the error produced by oncoming bubbles the bubbles move against the probe with certain angle between 0 and 90 which ensures that the downstream sensor piece the bubble first ahead of upstream sensor as shown in fig 2 a ii the error produced by receding bubbles the bubbles move opposite to the probe orientation which ensures that the upstream sensor piece the bubble first ahead of downstream sensor as shown in fig 2 b iii the error produced by transversal bubbles the bubbles move in the direction nearly perpendicular to the probe orientation touch the front sensor tip and the rear sensor tip simultaneously in fig 2 c or touch the front sensor tip but miss the rear sensor tip called as missing bubbles the situation of fig 2 c can be regarded as bubble impact the single tip optical fiber probes and it is very difficult to evaluate the velocity change and the measurement error from missing bubbles to analyze the measurement errors in the bubble velocity and bubble chord length obtained by a dual tip probe some assumptions are made refer to fig 2 1 the bubbles have a symmetric plane e g spherical or ellipsoidal bubbles 2 the bubble shape fluctuation and deformation of the bubble due to its interaction with the probe are neglected 3 the bubble velocity vector magnitude and direction does not change during the bubble passing by the probe three types of measurement errors mentioned above are discussed in details as below i the error produced by oncoming bubbles with these assumptions considering the lateral motion the velocity of bubble is given by eq 1 and then the velocity magnitude of category i will be refined as follows 4 v 1 2 s cos θ t 2 t 1 s cos θ t 4 t 3 the relative error in the measurements of the bubble vertical velocity component is 5 δ v v v v s t 2 t 1 s t 4 t 3 s cos θ t 2 t 1 s cos θ t 4 t 3 s cos θ t 2 t 1 s cos θ t 4 t 3 100 1 cos θ 1 100 the relative errors predicted by eq 5 are shown in fig 3 it can be seen that the errors are always nonnegative the magnitude of the bubble velocity vector obtained by d ofp is always larger than the real value the errors increase with the value of θ it can be as large as 100 at θ 60 and it is even larger at larger θ values until it goes to infinity at θ 90 ii the error produced by receding bubbles the error in the catalogue ii can be considered as the similar case of catalogue i but the four intervals are redefined t 2 is the time when bubble impacts the downstream sensor t 1 is the time when bubble impacts the upstream sensor t 4 is the time when downstream sensor takes to fully penetrate the bubble t 3 is the time when upstream sensor takes to fully penetrate the bubble and the velocity vector and the relative error of the bubble is same as the catalogue i iii the error produced by transversal bubbles it is difficult to evaluate the error produced by the transversal bubbles but when the bubble impact one of the tips the measurement error can be estimated the bubble is treated as if they are measured by the single tip probe and the velocity vector of bubble can be corrected by a correction coefficient α 6 α n s n b where n s and n b are the bubble numbers detected by one sensor of a probe and the effective bubble numbers sensed by all sensors of a probe respectively and the velocity magnitude of bubble can be refined as 7 v n s 2 n b s t 2 t 1 s t 4 t 3 hence the key aim of making correction of bubble size measurement is to correct the error produced by the oncoming bubbles fig 3 shows that the results from d ofp is reasonable when angle between the bubble velocity vector and the probe axial direction is less than 10 it means that d ofp can only be used in the situations where all bubbles move strictly in one direction such as in forced concurrent gas liquid flow in pipes and are not suitable for systems with complex flow dynamics such as bubble plume alpha plumes in breaking waves so it is essential to design a new probes and algorithms for obtaining more details of bubble motion especially for the angle between probe orientation and bubble motion in bubble plumes beneath breaking waves 4 theoretical model of the proposed optical probe to overcome the limitation of d ofp several researchers have used multi tip optical fiber probes to evaluate the angle between probe orientation and bubble motion in gas liquid flow in chemical industry luther et al 2004 shen et al 2008 euh et al 2001 the four tip optical fiber probe f ofp is widely used for gas liquid flow measurement but the data processing algorithm employed in these studies is questionable in this section the theoretical model of this probe is described and the new data processing algorithm is proposed the mathematic model of f ofp based d ofp is shown in fig 4 there are four sensors including the leading tip p0 and three lateral tips p1 p3 p0 and p2 are aligned along the z axis with a distance of l p1 and p3 are at distances d 1 and d 2 from p0 along the x and y axis respectively each pair of the front sensor and one rear sensor can be considered as a d ofp which means there are three d ofp in a f ofp and the principle of f ofp is similar to the d ofp the theoretical model is based on the following assumptions 1 there are many shapes of bubbles such as ellipse spherical and oblate spheroid etc the model presented in this study is valid only for spherical bubbles considering the alpha bubble plume is characterized by large size experimental observation has indicated that large bubbles with diameters in the range 20 mm d 64 mm were detected by probes and bubbles were nearly spherical blenkinsopp and chaplin 2010 on the other side experimental observation using optical probe and image analysis has indicated that in gas in oil flows the largest oil droplets up to about 8 mm in size tend to be oblate spheroids for these large droplets the ratio of the length of the shortest axis to the length of the longest axis defined herein as the aspect ratio has been observed by several researchers the same solution will be adopted in the verification and validation experiments in our accompanying paper in which the errors in bubble size measurement associated with non sphericity are discussed in detail 2 the bubble velocity vector magnitude and direction does not change during the measurement interval 3 the shape fluctuation and deformation of the bubble caused by its interaction with the probe are neglected 4 the bubble surface contacts all of the rear sensors twice first when the bubble initially contacts a sensor and second when the bubble leaves the sensor 5 all of the bubbles hit the front p0 first head of the other three rear sensors this assumption is realistic since p0 is the leading sensor the probe s coordinate system is shown in fig 4 we assume that a bubble moves with a velocity vector v across the f ofp this velocity vector can be written as 8 v v η ˆ v sin α sin β i sin α cos β j cos α k where v is the magnitude of the bubble velocity and η ˆ is the unit vector representing direction of velocity i j and k are unit vectors in x y z directions respectively α and β are the polar and azimuthal angle associated with v as shown in fig 4 c respectively α implies the angle between the bubble motion and the z axis whereas β implies the angle between the projection of the bubble motion in oxy plane and the x axis let us suppose that the bubble moves against the probe and impact the leading tip p0 and then the pierced position vector p is given as 9 p r ξ ˆ r sin ϕ sin φ i sin ϕ cos φ j cos ϕ k where r is the radius of the bubble and ξ ˆ is the unit vector in the direction of p the definitions of i j and k are same as eq 8 and the distance vector of leading tip to the three rear tips s 0 1 s 0 2 and s 0 3 can be written as 10 s 0 1 d 1 j l k 11 s 0 2 l k 12 s 0 3 d 2 i l k since p is the pierced position vector which is on the surface of spherical bubbles then it can be expressed as 13 p p r 2 if the bubble moves from this position and reaches sensor p1 after time δ t 1 as shown in fig 4 a according to the triangle rule of vector addition the relation among s s 0 1 p and v δ t 1 can be written as 14 s p s 0 1 v δ t 1 and s is also on the surface of spherical bubble it can be expressed as 15 s s r 2 substituting eqs 8 10 and eq 14 into eq 15 we can obtain 16 v 2 δ t 1 2 2 v δ t 1 l η ˆ k d 1 η ˆ j r η ˆ ξ ˆ d 1 2 l 2 2 d 1 r ξ ˆ j 2 r ξ ˆ k 0 eq 16 can be considered as a quadratic equation in δ t 1 the two solutions denoted as δ t 1 a and δ t 1 b are solved as 17 δ t 1 a δ t 1 b l η ˆ k d 1 η ˆ j r η ˆ ξ ˆ l η ˆ k d 1 η ˆ j r η ˆ ξ ˆ 2 d 1 2 l 2 2 d 1 r ξ ˆ j 2 r ξ ˆ k v the first solution the smaller value of time δt 1 a gives the time interval between the bubble surface first contacting p0 and then first contacting p1 the second solution the larger value of time δt 1 b corresponds to the time interval between the bubble surface first impacting p0 and then leaving p1 since each pair of the front sensor and one rear sensor can be considered as a d ofp the following equation is valid for the times δt 2 δt 3 when the bubble surface comes into contact with p3 and p2 respectively the moving trial of bubble can also be given by 18 v 2 δ t 2 2 2 v δ t 2 l η ˆ k d 2 η ˆ i r η ˆ ξ ˆ d 2 2 l 2 2 d 1 r ξ ˆ i 2 r ξ ˆ k 0 19 v 2 δ t 3 2 2 v δ t 3 l η ˆ k r η ˆ ξ ˆ d 2 2 l 2 2 r l ξ ˆ k 0 and the solutions of eqs 18 and 19 can be written in terms of time delays δt 2 a δt 2 b δt 3 a and δt 3 b δt 3 b as shown below 20 δ t 2 a δ t 2 b l η ˆ k d 2 η ˆ i r η ˆ ξ ˆ l η ˆ k d 2 η ˆ i r η ˆ ξ ˆ 2 d 2 2 l 2 2 d 2 r ξ ˆ i 2 r ξ ˆ k v 21 δ t 3 a δ t 3 b l η ˆ k r η ˆ ξ ˆ l η ˆ k r η ˆ ξ ˆ 2 l 2 2 r l ξ ˆ k v where δ t 2 a is the time interval between the bubble surface first contacting p0 and then first contacting p2 δ t 2 b the larger value of time corresponds to the time interval between the bubble surface first contacting p0 and then leaving p2 where δ t 3 a is the time interval between the bubble surface first contacting p0 and then first contacting p3 δ t 3 b the larger value of time corresponds to the time interval between the bubble surface first contacting p0 and then leaving p3 the parameters in the mathematical model of f ofp based eqs 16 18 and 19 can be classified as follows 1 three couples of time intervals δ t 1 a δ t 1 b δ t 2 a δ t 2 b δ t 3 a and δ t 3 b when three d ofp contact the bubble respectively 2 the parameters of bubble plume including the radius r the direction of bubble motion α and β the velocity of bubble motion v the position angles where the tips contact the bubbles ϕ and φ the first group can be defined as the functions of the latter parameters in the second group therefore if the time intervals including δ t 1 a δ t 1 b δ t 2 a δ t 2 b δ t 3 a and δ t 3 b can be measured firstly the parameters of bubble plume can be estimated in theory 5 the proposed data processing algorithm of bubble parameters the algorithms for f ofp are shown in fig 5 the signal processing is composed of four processes as described below 1 the smoothing process 2 the determination of thresholds process 3 the detection of time intervals of bubble impact the tips 4 the calculation of velocity vector the pierced position vector and other required parameters since the first two processes involve the true signal collected by probes this section will give the key points of the last two processes to solve eqs 16 18 and 19 a computational procedure is described as follows in details in this computational procedure the three distances d 1 d 2 and l and the six time delays δ t 1 a δ t 1 b δ t 2 a δ t 2 b δ t 3 a and δ t 3 b are the input parameters the direction of bubble motion β and α the position angles where the tips contact the bubbles ϕ and φ the radius of bubble r and the speed of bubble motion v are the output parameters they are calculated by following schedules step 1 input six time internals output the azimuthal angle β according to the relation between coefficient and solution of quadratic equations the solutions of eqs 16 18 and 19 can be written as 22 δ t 1 a δ t 1 b 2 l cos α d 1 sin α cos β r sin α sin β sin ϕ sin φ r sin α cos β sin ϕ cos φ r cos α cos ϕ v 23 δ t 2 a δ t 2 b 2 l cos α d 2 sin α sin β r sin α sin β sin ϕ sin φ r sin α cos β sin ϕ cos φ r cos α cos ϕ v 24 δ t 3 a δ t 3 b 2 l cos α r sin α sin β sin ϕ sin φ r sin α cos β sin ϕ cos φ r cos α cos ϕ v 25 δ t 1 a δ t 1 b d 1 2 l 2 2 d 1 r sin ϕ cos φ 2 r cos ϕ v 2 26 δ t 2 a δ t 2 b d 2 2 l 2 2 d 1 r sin ϕ sin φ 2 r cos ϕ v 2 27 δ t 3 a δ t 3 b d 2 2 l 2 2 r l cos ϕ v 2 transform eqs 22 24 into 28 δ t 1 a δ t 1 b δ t 3 a δ t 3 b 2 d 1 sin α cos β v 29 δ t 2 a δ t 2 b δ t 3 a δ t 3 b 2 d 2 sin α sin β v eq 29 divides eq 28 the azimuthal angle β associated with v can be calculated 30 tan β δ t 2 a δ t 2 b δ t 3 a δ t 3 b d 1 δ t 1 a δ t 1 b δ t 3 a δ t 3 b d 2 step 2 give assumed velocity amplitude output the polar angle α next we must assume a value of v the angle α can be calculated using eqs 22 24 31 2 δ t 1 a 2 δ t 1 b δ t 3 a δ t 3 b δ t 2 a δ t 2 b 2 sin α 2 d 1 cos β d 2 sin β v eq 31 also has the form 32 sin α 2 δ t 1 a 2 δ t 1 b δ t 3 a δ t 3 b δ t 2 a δ t 2 b v 2 2 d 1 cos β d 2 sin β step 3 continuing to output the azimuthal angle φ continuing to transform eqs 25 27 become 33 δ t 1 a δ t 1 b v 2 d 1 2 l 2 2 d 1 r sin ϕ cos φ 2 r cos ϕ 34 δ t 2 a δ t 2 b v 2 d 2 2 l 2 2 d 1 r sin ϕ sin φ 2 r cos ϕ 35 2 r cos ϕ δ t 3 a δ t 3 b v 2 d 2 2 l 2 l substituting 2 r cos ϕ of eq 35 into eqs 33 and 34 the azimuthal angle of tip contact the bubble φ is given by 36 cos φ δ t 1 a δ t 1 b v 2 d 1 2 l 2 δ t 3 a δ t 3 b v 2 d 2 2 l 2 l 2 d 1 r sin ϕ 37 sin φ δ t 2 a δ t 2 b v 2 d 2 2 l 2 δ t 3 a δ t 3 b v 2 d 2 2 l 2 l 2 d 2 r sin ϕ eq 37 is divided by eq 36 38 φ arctan l δ t 2 a δ t 2 b v 2 δ t 3 a δ t 3 b v 2 l 3 l 2 l d 2 2 d 2 2 d 1 l δ t 1 a δ t 1 b v 2 δ t 3 a δ t 3 b v 2 l 3 l 2 l d 1 2 d 2 2 d 2 step 4 input the assumed velocity and azimuthal angle φ output polar angle of the pierced position vector ϕ from eq 35 the ϕ can be written as 39 cos ϕ δ t 3 a δ t 3 b v 2 d 2 2 l 2 2 r l eq 36 can be written as 40 sin ϕ δ t 1 a δ t 1 b v 2 d 1 2 l 2 δ t 3 a δ t 3 b v 2 d 2 2 l 2 l 2 d 1 r cos φ eq 40 divides eq 39 the ϕ can be calculated 41 ϕ arctan l δ t 1 a δ t 1 b v 2 δ t 3 a δ t 3 b v 2 l 3 l 2 l d 1 2 d 2 2 d 1 cos φ δ t 3 a δ t 3 b v 2 d 2 2 l 2 step 5 input the assumed velocity and polar angle ϕ output bubble radius r if the ϕ is known the radius of bubble r can be obtained from the eq 39 42 r δ t 3 a δ t 3 b v 2 d 2 2 l 2 2 l cos ϕ step 6 input bubble radius r output bubble velocity amplitude v from eqs 30 32 38 39 and 42 the five parameters β α ϕ φ and r are known when v is assumed since v is the function of the radius of bubble r the calculating procedure is described in details as bellow transform eqs 25 27 become 43 δ t 1 a δ t 1 b v 2 d 1 2 l 2 2 d 1 r sin ϕ cos φ 2 r cos ϕ 44 δ t 2 a δ t 2 b v 2 d 2 2 l 2 2 d 1 r sin ϕ sin φ 2 r cos ϕ 45 δ t 3 a δ t 3 b v 2 d 2 2 l 2 2 r l cos ϕ eq 45 can be written as 46 2 r cos ϕ δ t 3 a δ t 3 b v 2 d 2 2 l 2 l substituting for 2 r cos ϕ using eq 46 eq 43 becomes 47 δ t 1 a δ t 1 b v 2 d 1 2 l 2 2 d 1 r sin ϕ cos φ δ t 3 a δ t 3 b v 2 d 2 2 l 2 l continue to transform eq 47 48 cos φ δ t 1 a δ t 1 b l δ t 3 a δ t 3 b v 2 l 3 l 2 l d 1 2 d 2 2 2 d 1 l r sin ϕ substituting for 2 r cos ϕ using eq 46 eq 44 becomes 49 δ t 2 a δ t 2 b v 2 d 2 2 l 2 2 d 1 r sin ϕ sin φ δ t 3 a δ t 3 b v 2 d 2 2 l 2 l continue to transform eq 49 50 sin φ δ t 2 a δ t 2 b l δ t 3 a δ t 3 b v 2 l 3 l 2 l d 2 2 d 2 2 2 d 1 l r sin ϕ according to the trigonometric function relationship 51 sin 2 φ cos 2 φ 1 substituting for cos φ and sin φ using eq 48 and eq 50 respectively we can obtain 52 sin 2 ϕ δ t 1 a δ t 1 b l δ t 3 a δ t 3 b v 2 l 3 l 2 l d 1 2 d 2 2 2 δ t 2 a δ t 2 b l δ t 3 a δ t 3 b v 2 l 3 l 2 l d 2 2 d 2 2 2 4 d 1 2 l 2 r 2 similarly 53 sin 2 ϕ cos 2 ϕ 1 substituting for cos ϕ and sin ϕ using eq 46 and eq 52 respectively and let a δ t 1 a δ t 1 b l δ t 3 a δ t 3 b b l 3 l 2 l d 1 2 d 2 2 c δ t 2 a δ t 2 b l δ t 3 a δ t 3 b d l 3 l 2 l d 2 2 d 2 2 e δ t 3 a δ t 3 b f d 2 2 l 2 the eq 53 becomes 54 4 d 1 2 r 2 l 2 a v 2 b 2 c v 2 d 2 e v 2 f 2 d 1 2 eq 54 becomes a quadratic equation of v 2 55 a 2 c 2 e 2 d 1 2 v 4 2 ab 2 cd 2 ef d 1 2 v 2 b 2 d 2 f 2 d 1 2 4 d 1 2 r 2 l 2 0 the solution of eq 54 can be written as 56 v 2 ab 2 cd 2 ef d 1 2 2 ab 2 cd 2 ef d 1 2 2 4 a 2 c 2 e 2 d 1 2 b 2 d 2 f 2 d 1 2 4 d 1 2 r 2 l 2 2 a 2 c 2 e 2 d 1 2 step 7 this computed velocity magnitude will be compared with the assumed velocity magnitude until the assumed and the computed velocity magnitudes agree to a very high level of accuracy at which point it is assumed that the calculated values of α β ϕ φ and r are the correct values 6 summary the presented work was dedicated to investigate the performance of a d ofp on the determination of the bubble velocity in bubble plume in breaking waves in theory and a f ofp was proposed to be employed for compensating its error the following conclusions are drawn from this work first of all the measurement error of a d ofp are classified as three types including oncoming bubble errors receding bubble errors and missing bubble errors in terms of the bubble motion relative to the probe the conclusion based on theoretical calculation confirmed that three errors can be transformed as the error caused by bubble s lateral movement and the measure results using a d ofp is reasonable only in the case that the angle between the bubble velocity vector and the probe axial direction is less than 10 therefore the simultaneous velocity vector and the pierced position vector measurement is proposed to carry out for further compensation the errors produced by a d ofp second of all a solution of the velocity vector and the pierced position vector measurement for bubble plumes beneath breaking waves is described in detail the solution is composed of a mathematical model for a f ofp and an optimized algorithm for bubble plumes parameters from the raw data collected by the probe there commended model is conducted by three quadratic equations which include six unknown parameters including the velocity vector amplitude polar and azimuthal angle the pierced position vector polar and azimuthal angle and bubble radius the solution algorithm for six parameters is a combination of the relation between coefficient and solution of quadratic equations and iteration algorithms that use a variable corrector the corrector is the difference of the assumed velocity and calculated velocity by the optimized procedure a detailed verification and validation of the model are presented in accompanying paper acknowledgements the authors acknowledge the support of the national natural science foundation of china grant funded by the national natural science found grant no 41706109 
23318,this paper presents a fault tolerant model predictive control ft mpc for a vessel featured by the presence of a greater number of actuators with respect to the number of controlled outputs classified in the category of over actuated systems over actuated plants are usually controlled by a main controller in conjunction with a thrust allocation ta algorithm in order to guarantee the required control performances in this work an unconstrained quadratic programming qp ta policy is considered in conjunction with a mpc to drive the vessel the proposed solution has been tested on an over actuated vessel called cybership ii the main contribution of this paper is the introduction in the mpc of a fault tolerant action in order to improve control performance in actuators fault scenarios a linear parameter varying lpv model has been used to described the cybership ii dynamics and to develop the proposed controller considering this model a mpc has been developed to drive the vessel verifying controller performance in standard control scenarios the proposed ft mpc has been compared with respect to a standard mpc in actuators fault scenarios considering several wave noise disturbances reported simulation results show the effectiveness of the proposed approach keywords model predictive control thrust allocation fault tolerance linear parameter varying model 1 introduction a fault tolerant control system ftcs is a closed loop controller able to automatically accommodate component failures maintaining system stability and acceptable control performance in the event of fault zhang and jiang 2008 research and development of ftcs and fault detection and diagnosis fdd systems involved large part of the international research community due to a growing demand for safety reliability maintainability and survivability in dynamical systems patton 2015 the fdd systems detect if there is a fault in the system and provide some specific information about it yin et al 2014a on the other hand the ftcs is designed to use information provided by the fdd to re modulate the controller depending on the availability of redundancies in the control system as well as design approaches used in the synthesis of fault tolerant controllers jiang and yu 2012 different ftcs solutions have been proposed for safety critical applications in several technical fields such as power systems zhang et al 2014 green energy production qiao and lu 2015 and surface vehicles svs izadi zamanabadi and blanke 1999 among the techniques proposed in the development of ftcs adaptive control maalouf et al 2015 fuzzy based policy tong et al 2014 and most recently data driven approach yin et al 2014b represent the widely used solutions due to their typical on line re modulation features during the past few years model predictive control mpc became increasingly interesting in several fields e g automotive svs and power converters pisaturo et al 2015 oh and sun 2010 cavanini et al 2016 cavanini et al 2017a and has been also proposed in conjunction with ffd techniques in order to develop ft controllers sanchez et al 2016 peng et al 2016 mpc explicitly uses the system model to formulate and solve at each sampling time a constrained finite horizon optimal control problem allowing to optimally drive multivariable systems camacho and alba 2013 in this paper a fault tolerant ft mpc policy has been proposed to drive an over actuated vessel the considered plant is the cybership ii skjetne et al 2004 a scale model of a vessel provided with a redundant set of actuators for this reason it requires a low level thrust allocation ta algorithm in order to obtain prescribed closed loop control performance by an optimal control force allocation among available actuators the introduction of ta policies is a standard solution to simplify the design of control system for over actuated system and it is usually considered to develop ftcs wu et al 2016 the main contributions of this paper is the introduction of a feedback loop between the ta algorithm and the mpc in order to model actuators fault or failure and to automatically re modulate the fault free control law by the introduction of the fault effect into the mpc reference model due to the considered feedback the proposed ft mpc allows to improve control performances in actuators fault scenarios and guaranteeing system safety in case of critical faults combinations the proposed solution has been tested in different actuators failure scenarios comparing the obtained control results with respect to the performances of a standard mpc the comparison has been done by the analysis of a standard control index and showing the transient response improvement in the reported results due to the presence of the wave disturbances in real cases the control performance can be effected by the presence of output additive noise liu et al 2017 gao et al in order to verify the control performance also in case of strong additive noise comparison results varying the intensity of the additive output wave disturbances have been reported to develop the proposed controller a linear parameter varying lpv model of the vessel nonlinear dynamics has beed considered and a comparative analysis of the performance of the proposed lpv model based mpc with respect to a standard nonlinear mpc has been performed the paper is organized as follow in section 2 the considered vessel dynamical model is presented reporting the nonlinear plant characteristics and the lpv model section 3 deals with the considered ta and mpc policies section 4 presents the proposed ft mpc solution section 5 reports the results of the simulations comparing the considered control algorithm in several control scenarios section 6 concludes the paper 2 cybership ii in this section the cybership ii model considered in the control law formulation has been reported in subsection 2 1 the nonlinear vessel dynamic is presented with the considered hypothesis in the model formulation in subsection 2 2 the linear parameter varying lpv model of the vessel is given 2 1 dynamical system the cybership ii skjetne et al 2004 is a scale 1 70 model of an over actuated supply vessel having a mass of 23 8 kg a length of 1 255 m a breadth of 0 29 m the ship has two main propellers two rudders aft and one bow thruster the dynamic model is fully described by six degree of freedom dof related to the ship position in the three dimensional space x y and z positions called surge sway and heave respectively and orientation ϕ θ and ψ angles called roll pitch and yaw respectively in the following the ship has been considered longitudinally and laterally metacentrically stable due to the assumption of small amplitude of roll and pitch angles and angle rate i e ϕ θ δ ϕ δ θ 0 in the same way it is possible to discard the heavy dynamic considering the ship floating to z 0 the result of the previous assumptions is that the cybership ii model is described by a 3 dof equation system related to the state array η x y ψ referred to the north east down ned earth fixed reference frame lindegaard and fossen 2003 considering υ u v r with u and v the surge and sway velocities and r the yaw rate the ship rigid body dynamic is described by the kinematic relationship 1 η r ψ υ where r ψ is the rotation matrix defined as 2 r ψ cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 as proposed in lindegaard and fossen 2003 the ship can be considered a low speed surface vessel described by 3 η r ψ υ m υ d υ u with u τ x τ y τ n the input vector where τ x and τ y are the surge and sway control forces respectively τ n is the yaw control moment and m d are the mass and damping matrices respectively 4 m m x u 0 0 0 m y v m x g y r 0 x g y r i z n r d x u 0 0 0 y v y r 0 y r n r the cybership ii dynamical model parameters have been reported in table 1 2 2 linear parameter varying model a linear parameter varying lpv model of the nonlinear vessel dynamics of eq 2 1 has been considered the discrete time lpv model s k has the form 5 x k 1 a γ k x k b γ k u k z k c γ k x k where u k τ x k τ y k τ n k is the input vector of dimension n u 3 z k x k y k ψ k is the output vector of dimension n z 3 γ k γ ℝ n γ is the vector of the time varying scheduling parameters of dimension n γ 2 and γ is a given set of interest the state vector x k υ k η k has dimension n x 6 and the sample time is t s 0 25 s the system of eq 2 2 allows to represent the nonlinear model state evolution of eq 2 1 by a linear time varying system described by the instantaneous value of the parameter vector defined as γ k γ 1 k γ 2 k with γ 1 k sin ψ k and γ 2 k cos ψ k γ 1 k γ 2 k 1 1 such that 6 a γ k a k e a γ t t s b γ k b k 0 t s e a γ t t s b d τ c γ k c k c in eq 6 a k ℝ n x n x b k ℝ n x n u and c k ℝ n z n x are the discrete time matrices of the lpv model obtained from the nonlinear model matrices of the vessel presented in eq 3 t s is the sampling time and a γ t b c are the continuous time matrices describing the continuous time lpv model 7 a γ t m 1 d 0 r γ t 0 b m 1 0 c 0 i with i 0 ℝ 3 3 and m 1 is the inverse matrix of m such that m 1 m i 3 control architecture the architecture of the controller is shown in fig 1 it is composed of a thrust allocation ta algorithm used to assign the nominal control effort u computed by the mpc among the available actuators and providing the real thrust effort u r a wave filter wf fossen and strand 1999 that allows to estimate the ship position y r in the presence of external environment noise d affecting the measured output y m the controller mpc has been tuned with respect to the lpv model of eq 5 with the feedback signals f r and f defined in sec 3 1 from the ta algorithm in order to compute the considered fault tolerant policy 3 1 thrust allocation the thrust allocation policy coordinates the different thrusts of the over actuated system in order to produce the desired control efforts the ta module architecture is reported in fig 2 the ta algorithm allocates the required control effort u computed by the mpc among the provided actuators set with respect to the actuators position and orientation the ta solution is the allocated control force f of fig 2 that represents the reference signal for the system real actuators the actuators set driven by f provides the real force signals f r used to compute the real control effort u r by the thrust inverse mapping related to the geometrical configuration of the vessel actuators several ta algorithms have been proposed in last years and for the state of the art of control allocation policies it is possible to refer to johansen and fossen 2013 in this paper a quadratic programming qp formulation of the unconstrained ta solution for the fixed actuators allocation problem has been introduced in the control loop of the cybership ii given the actuators vector p ℝ n p such that n p n p f n p r with n p f fixed and n p r rotable actuator respectively each rotable actuator is modeled as two fixed actuators lindegaard and fossen 2003 i e n p n p f 2 n p r in the proposed approach the ship is an over actuated system because of the number of actuator n p q where q is the number of the degree of freedom of the vessel the actuators position vector is defined as 8 r l x l y with l x and l y the vectors of coordinates in the ship body reference system the generalized force input vector that the actuators can produce at the k th time instance is given by 9 u r k a f r k where the vector u r k has the same size n u of the input vector u of the model of eq 5 in eq 9 the constant configuration matrix of the ship a a r α ℝ n u n p is 10 a cos α 1 cos α p sin α 1 sin α p l y 1 cos α 1 l x 1 cos α 1 l y p cos α 1 l x 1 cos α p with α ℝ n p the vector of the constant actuators orientations and f r k ℝ n p the vector of real forces provided by the actuators set driven by the extended thruster vector f k ℝ n p provided by the ta algorithm 11 f k a u k in eq 11 a is the generalized moore penrose right inverse matrix 12 a a a a 1 and the solution of the allocation f k a u k is the weighed 2 norm sense optimal solution for an identity weight matrix w i of appropriate dimension fossen and johansen 2006 13 f k w f k f k w f k f k ℝ n p f k a u k 3 2 model predictive control the mpc solves iteratively a finite horizon optimal control problem formulated with respect to a prediction model of the controlled process and an estimation of its current state the lpv model of eq 5 has been used to design the mpc considering the scheduling parameters constant in prediction mollov et al 2004 cavanini et al 2017b 2017c with respect to the cybership ii nonlinear plant considering the control scheme of fig 1 in the proposed solution a quadratic cost is minimized subject to a set of affine constraints 14a min δ u i 1 n p q z z k i k r k 2 2 j 0 n u 1 q δ u δ u k j k 2 2 14b s t x k k x k 14c x k i 1 k a k x k i k b k u k i k 14d z k i 1 k c k x k i 1 k 14e δ u k n u j k 0 14f u k i k u 14g i 0 1 n p 1 14h j 0 1 n u 1 where n p is the prediction horizon n u is the control horizon q δ u and q z are the weights matrices with q δ u invertible x k i k denotes the prediction of the variable x at time k i based on the information available at time k δ u k i k is the vector of the input increments with u k 1 k u k 1 r k r x k r y k r ψ k is the output reference u is the polyhedral set of constraints on inputs and z k is the considered plant input due to the considered wave filter wf algorithm fossen and strand 1999 output z k y r k where y r k is the real pose of the ship and z k the filtered one problem 14 can be casted into a condensed qp problem of the form 15 min μ 1 2 μ h k μ ρ k f k μ s t g μ v ρ k w where μ ℝ n μ is the vector of optimization variables ρ k ℙ and ρ k ℙ are vectors of mpc parameters of dimension n ρ n u n x n z and n ρ n u with ℙ ℝ n ρ and ℙ ℝ n ρ bounded sets of interest with ρ k u k 1 and ρ k u k 1 x k z k h k ℝ n μ n μ is a symmetric and positive definite matrix f k ℝ n μ n ρ is the linear cost term g ℝ m u n μ v ℝ m u n ρ and w ℝ m u are the terms defining the inputs constraints remark 1 the mpc of eq 14 has been developed with respect to the lpv model of eq 5 in order to formulate a lpv mpc the lpv mpc approach considers a problem formulation closed to the lti mpc that represents a faster corona and de schutter 2008 cavanini et al 2017d cavanini et al and certifiable cimini and bemporad 2017 solution with respect to nonlinear mpc nmpc algorithms liu et al 2015 the additive computational effort required by the lpv mpc related to the computation of the matrices of the minimization problem can be exactly computed a priori whereas the nmpc can not guarantee to maintain the convexity of the quadratic minimization problem camacho and alba 2013 the possibility to certify the algorithm complexity and the computational effort required to compute the control law is of paramount importance for a real time implementation of the algorithm in commercial control platform for a comparative performance analysis between lpv mpc and nonlinear mpc algorithms it is possible to refer to casavola et al 2003 and in particular the cybership ii control case study has been analyzed in zheng et al 2014 remark 2 due to the formulation of the ta algorithm in the optimization problem of eq 13 the force allocation could be directly integrated within the mpc controller johansen and fossen 2013 in the proposed approach the ta and the mpc have been decoupled for two reasons i due to the study of the actuators configuration the ta policy can be developed and used to simplify the definition of the lpv model of sec 2 2 representing the nonlinear plant when a system is provided with a trust allocation policy usually the controller is decoupled from the ta that run with a different execution rate and it is assumed as part of the controlled plant in the proposed work the authors considered this approach to define the lpv model of the nonlinear plant and to develop the proposed controller i i maintaining decoupled the ta and the mpc allows to introduce in the controller the ft policy proposed in sec 4 4 fault tolerant model predictive control the previous qp problem of eq 15 is the standard mpc formulated with respect to the lpv model of eq 5 it guarantees control performances in the nominal scenario however in case of actuators fault this control has low effectiveness in this paper has been introduced a direct feedback from the ta block to the mpc see fig 1 in order to consider the actuators fault effect into the control law such feedback considers the direct knowledge of the computed actuator force reference value f and of the real actuators force f r see fig 1 gao et al 2015 only the control effort constraints have been considered in the minimization problem of eq 14f 16 u k i k u u k i k ℝ n u g u δ u k i k v u u k i 1 k u c where 17 g u i i v u i i u c u m u m μ δ u k k δ u k n u 1 k with i ℝ n u n u and 18 u m τ x m τ y m τ n m u m τ x m τ y m τ n m the vectors of minimum and maximum control effort bounds respectively the qp problem constraints matrices are 19 g g u 0 0 g u g u 0 0 g u g u v v u v u w u c u c in the same way the hessian matrix h and the linear term matrix ρ k f in the qp problem 15 have been defined as 20 h k h k h k q δ u h k q δ u f k ρ k h k q z f k x k s k where h k h a k b k c k ℝ n y n p n u n p n c is named prediction matrix h k ℝ n u n p n c n u n p n c f k f a k c k ℝ n p n z n x q z ℝ n p n z n p n z and q δ u ℝ n u n u n u n u are weight matrices built from q n δ u and q n z of eq 14 s k ℝ n p n z such that s k r k r k and 21 h k c k b k 0 0 c k a k b k c k b k 0 c k a k n p 1 b k c k a k n p n u b k f k c k a k c k a k 2 c k a k n p the input constraints of eq 14f formulated by eq 21 guarantee to compute a nominal control effort u k satisfying the tuning input signals bounds as discussed in section 3 1 the provided control effort is not applied directly to the system this is due to the presence of the ta algorithm that allows to compute the optimal extended force vector f k of eq 11 with respect to the nominal matrix a of eq 12 the real applied control effort is then computed as u r k a f r k by the moore penrose pseudo inverse proprieties a a i considering an actuators fault scenario u r k u k because of the computed optimal extended force vector f k f r k where f r k is the real extended force vector provided by the thrusters remark 3 control effort estimation is a widely studied problem and several solutions have been proposed in order to provide an estimation useful for fault detection and tolerance algorithms cristofaro and johansen 2014 liu et al 2016 liu and gao 2015 these results allow to consider the estimated value instead of the real force provided by each thruster if a provides the thrust allocation result in nominal conditions and u r k 1 a f r k 1 defining the diagonal matrix f k ℝ n p n p 22 f k f r k 1 1 f k 1 1 0 0 0 0 f r k 1 n p f k 1 n p where f k 1 i is the nominal force required by the i th actuator and f r k 1 i is the real one provided at previous time instance for i 1 n p the mapping matrix in case of fault is a k a f k such that 23 u r k a k a u k if f r k f k u k otherwise the equality f r k 1 f k 1 tested at each time step k successive to the application of the control effort f r k 1 is the fault detection condition in fault scenarios the plant 5 could not fit the real system behaviour due to unavailable actuators and to the relative reduction of system governability from eq 23 the fault matrix m k ℝ n u n u is defined and iteratively computed 24 m k a k a a f k a in order to introduce the fault effect in the plant model s f k 25 x k 1 a k x k b k m k u k z k c k x k where m k i in absence of fault the definition of system 4 suggest to rebuild the mpc with respect to the new system in order to formulate the fault tolerant policy of the following sec 4 1 4 1 fault tolerant algorithm the introduction of the matrix m k of eq 24 into the plant model of eq 25 causes a main drawback replacing in the model of eq 5 the input matrix b k with b k m k causes the lost of knowledge of the real plant input u r which in absence of fault has been constrained as in eq 23 this input in fault scenario cannot be constrained because the control law provides only the ta input u k losing the knowledge about u r k in order to overcome this problem it is possible to introduce directly the fault effect into the qp problem of eq 15 defining the block diagonal matrix 26 m k m k 0 0 0 m k 0 0 0 m k where m k ℝ n u n u n u n u and solving iteratively the problem 27 min μ 1 2 μ h k μ ρ k f k μ s t g k μ v k ρ k w the problem matrices are 28 h k m k h k m k q δ u f k f m k g k g m k v k v m k with h k ℝ n μ n μ f k ℝ n μ n ρ g k ℝ m u n μ v k ℝ m u n ρ in the case of not actuator fault by eq 23 h k h k f k f k g k g v k v both mpc and ft mpc algorithms requires the estimated state x k in order to compute iteratively the control law and in standard lpv mpc it is usually provided by a kalman filter kf as preposed in majecki et al 2017 in fault scenarios also the nominal kf designed with respect to nominal plant s k of eq 5 need to be re formulated in particular in the proposed work it has been done replacing in the kf algorithm the nominal b k matrix with the recomputed one b k m k referred to s f k of eq 25 4 2 non controllable scenarios the proposed approach allows to control the vessel in the presence of actuators fault and also to rebuild correctly input constraints with respect to the real applied input avoiding the drawback considered in sec 4 1 moreover by the presented solution it is possible to study the conditions of plant controllability in case of fault under the assumption that the nominal lpv plant model s k of eq 5 is controllable 29 rank b k a k b k a k n x 1 b k r a k b k n x the controllability of the plant in case of fault i e s f k of eq 4 is given by rank r a k b k m k n x this condition can be verified iteratively in case of fault in order to check if it is allowed to maintain the control of the system and otherwise to set to a safety state the control action furthermore the above controllability condition can be used to define offline the not controllable scenarios set according to the value of each element of f k see eq 22 testing for which combination of values 0 f r k i f k i 1 with i 0 n p the system becomes not controllable with f k i 0 to identify not controllable fault scenarios it is necessary to verify only the combinations of fault conditions causing a full breakdown failure of some actuator f r k i f k i 0 and then to check if f k f where 30 f f ℝ n p rank r a k b k m k n x is the not controllable actuators fault set with f ℝ f where ℝ f is the actuators fault subspace ℝ f ℝ n p defined as 31 ℝ f f ℝ n p 0 f i f i the tested fault tolerant mpc algorithm is reported in algorithm 4 2 the system is stopped in the presence of an actuators fault verifying the not controllability condition image 1 5 simulation results in this section the simulation results have been reported controlling the cybership ii nonlinear model of eq 3 both mpc and ft mpc have been formulated with respect to the lpv model presented in sec 2 2 the not controllable set of actuators faults has been studied considering the unavailability of actuators affected by faults by setting f r i 0 for each i t h lost actuator and f r i f i for the other ones the not controllable set f obtained by the study of the condition of eq 30 has been shown in table 2 reporting actuator fault combinations driving the system in the safety state such that u k 0 0 0 due to the actuators configuration fault scenarios setting the model into a not controllable state are related to a controllability matrix r a k b k m k featured by a rank value smaller than the size of the considered space state representation of eq 2 2 with n x 6 the tuning parameters of the considered mpc have been reported in table 3 in the proposed simulations the additive noise d k has been generated by the model 32 h w i s σ i s s 2 ζ i ω 0 i s ω 0 i 2 where i 1 2 3 is the index relative to the considered output surge sway and yaw respectively σ i 0 5 is the parameter related to the wave intensity ζ i 0 1 is the relative damping ratio and ω 0 i 0 8976 rad s is the dominant wave frequency in order to generate a wave disturbance featured by a frequency of 0 1429 hz the wave filter wf proposed in fossen and strand 1999 has been considered to estimate the true ship asset filtering the disturbances d k due to the sea wave the scheduling parameter vector has been computed with respect to the heading angle estimated by this filter the matlab active set based qp solver quadprog is used in the reported simulations the reference signal for the ship orientation r ψ has been filtered by an appropriate low pass filter introduced in order to provide a smooth output behaviour in order to validate the lpv mpc proposed in eq 14 a set of simulations have been reported in fig 3 and fig 4 showing the control performance tracking a set of step references with different amplitudes fig 3 presents the controlled outputs yellow by the proposed lpv mpc with respect to the reference signal dashed black and fig 4 shows the control effort computed by the lpv mpc driving the cybership ii nonlinear plant reported results validate the proposed control approach showing the effectiveness of the controller in fault free scenarios to verify the performance of the proposed ft policy the ft mpc presented in sec 4 has been compared with respect to the mpc of eq 14 in order to test the effectiveness of the considered algorithm a set of fault scenarios have been considered driving the vessel by a set of test trajectories and considering several actuators faults both mpc and ft mpc have been tested driving the vessel with a set of step reference signals of amplitude r x 10 m r y 5 m and r ψ 0 0175 rad introducing a wave disturbance featured by a noise intensity σ i 0 5 the tested scenario shows the large tracking error of the mpc in absence of the ft policy the algorithms have been compared with respect to the percentage integral square error ise improvement δise mpc ft mpc 33 δise mpc ft mpc ise mpc ise ft mpc ise mpc 100 in table 4 the δise mpc ft mpc results related to the considered step response for each controlled output have been reported the pedics x y and ψ refer to the controlled outputs the first row of table 4 presents the δise mpc ft mpc value in case of normal behaviour i e in absence of actuators fault and the other rows compare the mpc and ft mpc algorithms for each faults combination the average percentage ise improvements of the ft mpc with respect to the standard mpc are 12 38 27 21 and 99 54 for x y and ψ respectively in particular the proposed fault tolerant policy allows to eliminate the transient overshoot related to the controlled orientation ψ and to reduce the controlled output steady state error variance 5 with the ft mpc instead of the 8 of the reference value with the standard mpc these results confirm the effectiveness of the proposed approach showing the improvement of the ft mpc with respect to the standard mpc in each fault scenarios and maintaining standard performance in case of fault free behaviour the reported δise mpc ft mpc results show the reduction of the error obtained applying the ft mpc in particular with respect to the orientation error ψ which in case of fault is the most affected by performance degradation as an example in figs 5 6 simulations related to one of the proposed actuators fault scenarios i e considering the combination f r f 1 0 f 3 0 f 5 have been reported in order to shown the transient response improvement given by the introduction of the fault tolerant action in the standard mpc in the simulations of figs 5 6 the system has been driven with two consecutive equal steps during the first step the fault free scenario has been considered see time instant t 100 and in the second step see time instant t 100 the considered actuators faults configuration has been introduced in the vessel the results show simulation that consider an additive wave noise featured by an intensity of σ i 0 5 in particular fig 5 shows the improvement introduced by the proposed approach with respect to the standard mpc controlling each driven output in a fault scenario t 100 fig 6 shows the control efforts comparison showing that the introduction of the fault effects in the reference plant model causes the computation of different control signals allowing to improve the control performances the compared algorithms provide the same control results in the first part of the simulation of figs 5 6 t 100 i e when the nominal fault free scenario has been considered furthermore considering the previous fault scenario simulation results considering a wave noise featured by an intensity of σ i 5 have been reported in order to test the control performance in case of strong wave additive disturbance fig 7 and fig 8 shown the controlled outputs and the control efforts respectively in fault free and in faulty scenario in fault free control scenario t 100 the compared controllers provide the same results for t 100 the fault is introduce in the vessel showing that the ft mpc provides again good control performances the percentage ise improvements of the ft mpc with respect to the standard mpc are 12 43 6 43 and 98 32 for x y and ϕ respectively the results of the ft mpc are similar to that obtained in the previous case of low wave noise while the control results provided by the standard mpc show lower performance also in these conditions of strong disturbance the orientation ψ presents a good improvement due to the introduction of the fault tolerant action providing results comparable with those obtained in the fault free scenario in terms of transient overshoot compensation and steady state stabilization error variance to design the proposed ft mpc policy in sec 4 the true thrusters state in fault scenarios has been considered known due to the possibility to introduce in the controller a thrusters state estimator in real applications the estimated thrusters state can be affected by estimation errors due to the presence of noise and external disturbances in order to test the performance of the proposed ft mpc algorithm in the presence of thrusters state estimation errors a comparative analysis has been performed in particular the ft mpc in the presence of thruster estimation errors ft mpc e has been compared with respect to the ft mpc considering available the true thrusters state ft mpc r the estimation error has been modeled by an additive white noise signal affecting the real thrusters state values provided to the ft mpc the considered noise signal is featured by a sample time of 0 25 s a zero mean value and a variance of the 5 of the nominal thrusters power the comparison results have been collected in table 5 in terms of the δise ft mpc r ft mpc e computed as in eq 33 these results show that the control performance are strictly related to the goodness of the thrusters state estimation the ft mpc e affected by the introduced thrusters state estimation errors provides a performance degradation of 0 5230 0 0823 and 5 1989 with a variance of the 9 0736 6 0203 and 20 2189 for the x y and ϕ outputs with respect to the ft mpc r furthermore to validate the proposed approach a control performance comparison has been done considering the mpc of eq 14 and the nonlinear mpc nmpc proposed in de nicolao et al 1997 both lpv mpc and nmpc have been tested tracking a set of random reference signals in the fault free scenario the average value and the variance of the δise nmpc mpc values computed as in eq 33 provided by the algorithms and the related average computation time have been considered in the comparison the proposed mpc provided with respect to the nmpc a δise nmpc mpc degradation of 3 2 4 1 and 2 4 with a variance of the 3 9 2 5 and 1 8 for the x y and ϕ outputs respectively 6 conclusions in this paper a model predictive control mpc policy to improve the performance of an over actuated ship in actuators fault scenarios has been proposed the vessel has been described by a linear parameter varying lpv model allowing to design a lpv mpc solution to control the vessel the presented fault tolerant ft solution introduces a feedback signals between the thrust allocation ta algorithm and the main controller in order to obtain a ft mpc policy the ft mpc algorithm improves the control results also in the presence of wave disturbance with different intensities the proposed approach allows to define off line possible fault combinations that reduce the system controllability defining ad hoc control actions the performance of the proposed ft mpc have been evaluated with respect to a standard mpc by the evaluation of a control index ise and by the analysis of the transient response results 
23318,this paper presents a fault tolerant model predictive control ft mpc for a vessel featured by the presence of a greater number of actuators with respect to the number of controlled outputs classified in the category of over actuated systems over actuated plants are usually controlled by a main controller in conjunction with a thrust allocation ta algorithm in order to guarantee the required control performances in this work an unconstrained quadratic programming qp ta policy is considered in conjunction with a mpc to drive the vessel the proposed solution has been tested on an over actuated vessel called cybership ii the main contribution of this paper is the introduction in the mpc of a fault tolerant action in order to improve control performance in actuators fault scenarios a linear parameter varying lpv model has been used to described the cybership ii dynamics and to develop the proposed controller considering this model a mpc has been developed to drive the vessel verifying controller performance in standard control scenarios the proposed ft mpc has been compared with respect to a standard mpc in actuators fault scenarios considering several wave noise disturbances reported simulation results show the effectiveness of the proposed approach keywords model predictive control thrust allocation fault tolerance linear parameter varying model 1 introduction a fault tolerant control system ftcs is a closed loop controller able to automatically accommodate component failures maintaining system stability and acceptable control performance in the event of fault zhang and jiang 2008 research and development of ftcs and fault detection and diagnosis fdd systems involved large part of the international research community due to a growing demand for safety reliability maintainability and survivability in dynamical systems patton 2015 the fdd systems detect if there is a fault in the system and provide some specific information about it yin et al 2014a on the other hand the ftcs is designed to use information provided by the fdd to re modulate the controller depending on the availability of redundancies in the control system as well as design approaches used in the synthesis of fault tolerant controllers jiang and yu 2012 different ftcs solutions have been proposed for safety critical applications in several technical fields such as power systems zhang et al 2014 green energy production qiao and lu 2015 and surface vehicles svs izadi zamanabadi and blanke 1999 among the techniques proposed in the development of ftcs adaptive control maalouf et al 2015 fuzzy based policy tong et al 2014 and most recently data driven approach yin et al 2014b represent the widely used solutions due to their typical on line re modulation features during the past few years model predictive control mpc became increasingly interesting in several fields e g automotive svs and power converters pisaturo et al 2015 oh and sun 2010 cavanini et al 2016 cavanini et al 2017a and has been also proposed in conjunction with ffd techniques in order to develop ft controllers sanchez et al 2016 peng et al 2016 mpc explicitly uses the system model to formulate and solve at each sampling time a constrained finite horizon optimal control problem allowing to optimally drive multivariable systems camacho and alba 2013 in this paper a fault tolerant ft mpc policy has been proposed to drive an over actuated vessel the considered plant is the cybership ii skjetne et al 2004 a scale model of a vessel provided with a redundant set of actuators for this reason it requires a low level thrust allocation ta algorithm in order to obtain prescribed closed loop control performance by an optimal control force allocation among available actuators the introduction of ta policies is a standard solution to simplify the design of control system for over actuated system and it is usually considered to develop ftcs wu et al 2016 the main contributions of this paper is the introduction of a feedback loop between the ta algorithm and the mpc in order to model actuators fault or failure and to automatically re modulate the fault free control law by the introduction of the fault effect into the mpc reference model due to the considered feedback the proposed ft mpc allows to improve control performances in actuators fault scenarios and guaranteeing system safety in case of critical faults combinations the proposed solution has been tested in different actuators failure scenarios comparing the obtained control results with respect to the performances of a standard mpc the comparison has been done by the analysis of a standard control index and showing the transient response improvement in the reported results due to the presence of the wave disturbances in real cases the control performance can be effected by the presence of output additive noise liu et al 2017 gao et al in order to verify the control performance also in case of strong additive noise comparison results varying the intensity of the additive output wave disturbances have been reported to develop the proposed controller a linear parameter varying lpv model of the vessel nonlinear dynamics has beed considered and a comparative analysis of the performance of the proposed lpv model based mpc with respect to a standard nonlinear mpc has been performed the paper is organized as follow in section 2 the considered vessel dynamical model is presented reporting the nonlinear plant characteristics and the lpv model section 3 deals with the considered ta and mpc policies section 4 presents the proposed ft mpc solution section 5 reports the results of the simulations comparing the considered control algorithm in several control scenarios section 6 concludes the paper 2 cybership ii in this section the cybership ii model considered in the control law formulation has been reported in subsection 2 1 the nonlinear vessel dynamic is presented with the considered hypothesis in the model formulation in subsection 2 2 the linear parameter varying lpv model of the vessel is given 2 1 dynamical system the cybership ii skjetne et al 2004 is a scale 1 70 model of an over actuated supply vessel having a mass of 23 8 kg a length of 1 255 m a breadth of 0 29 m the ship has two main propellers two rudders aft and one bow thruster the dynamic model is fully described by six degree of freedom dof related to the ship position in the three dimensional space x y and z positions called surge sway and heave respectively and orientation ϕ θ and ψ angles called roll pitch and yaw respectively in the following the ship has been considered longitudinally and laterally metacentrically stable due to the assumption of small amplitude of roll and pitch angles and angle rate i e ϕ θ δ ϕ δ θ 0 in the same way it is possible to discard the heavy dynamic considering the ship floating to z 0 the result of the previous assumptions is that the cybership ii model is described by a 3 dof equation system related to the state array η x y ψ referred to the north east down ned earth fixed reference frame lindegaard and fossen 2003 considering υ u v r with u and v the surge and sway velocities and r the yaw rate the ship rigid body dynamic is described by the kinematic relationship 1 η r ψ υ where r ψ is the rotation matrix defined as 2 r ψ cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 as proposed in lindegaard and fossen 2003 the ship can be considered a low speed surface vessel described by 3 η r ψ υ m υ d υ u with u τ x τ y τ n the input vector where τ x and τ y are the surge and sway control forces respectively τ n is the yaw control moment and m d are the mass and damping matrices respectively 4 m m x u 0 0 0 m y v m x g y r 0 x g y r i z n r d x u 0 0 0 y v y r 0 y r n r the cybership ii dynamical model parameters have been reported in table 1 2 2 linear parameter varying model a linear parameter varying lpv model of the nonlinear vessel dynamics of eq 2 1 has been considered the discrete time lpv model s k has the form 5 x k 1 a γ k x k b γ k u k z k c γ k x k where u k τ x k τ y k τ n k is the input vector of dimension n u 3 z k x k y k ψ k is the output vector of dimension n z 3 γ k γ ℝ n γ is the vector of the time varying scheduling parameters of dimension n γ 2 and γ is a given set of interest the state vector x k υ k η k has dimension n x 6 and the sample time is t s 0 25 s the system of eq 2 2 allows to represent the nonlinear model state evolution of eq 2 1 by a linear time varying system described by the instantaneous value of the parameter vector defined as γ k γ 1 k γ 2 k with γ 1 k sin ψ k and γ 2 k cos ψ k γ 1 k γ 2 k 1 1 such that 6 a γ k a k e a γ t t s b γ k b k 0 t s e a γ t t s b d τ c γ k c k c in eq 6 a k ℝ n x n x b k ℝ n x n u and c k ℝ n z n x are the discrete time matrices of the lpv model obtained from the nonlinear model matrices of the vessel presented in eq 3 t s is the sampling time and a γ t b c are the continuous time matrices describing the continuous time lpv model 7 a γ t m 1 d 0 r γ t 0 b m 1 0 c 0 i with i 0 ℝ 3 3 and m 1 is the inverse matrix of m such that m 1 m i 3 control architecture the architecture of the controller is shown in fig 1 it is composed of a thrust allocation ta algorithm used to assign the nominal control effort u computed by the mpc among the available actuators and providing the real thrust effort u r a wave filter wf fossen and strand 1999 that allows to estimate the ship position y r in the presence of external environment noise d affecting the measured output y m the controller mpc has been tuned with respect to the lpv model of eq 5 with the feedback signals f r and f defined in sec 3 1 from the ta algorithm in order to compute the considered fault tolerant policy 3 1 thrust allocation the thrust allocation policy coordinates the different thrusts of the over actuated system in order to produce the desired control efforts the ta module architecture is reported in fig 2 the ta algorithm allocates the required control effort u computed by the mpc among the provided actuators set with respect to the actuators position and orientation the ta solution is the allocated control force f of fig 2 that represents the reference signal for the system real actuators the actuators set driven by f provides the real force signals f r used to compute the real control effort u r by the thrust inverse mapping related to the geometrical configuration of the vessel actuators several ta algorithms have been proposed in last years and for the state of the art of control allocation policies it is possible to refer to johansen and fossen 2013 in this paper a quadratic programming qp formulation of the unconstrained ta solution for the fixed actuators allocation problem has been introduced in the control loop of the cybership ii given the actuators vector p ℝ n p such that n p n p f n p r with n p f fixed and n p r rotable actuator respectively each rotable actuator is modeled as two fixed actuators lindegaard and fossen 2003 i e n p n p f 2 n p r in the proposed approach the ship is an over actuated system because of the number of actuator n p q where q is the number of the degree of freedom of the vessel the actuators position vector is defined as 8 r l x l y with l x and l y the vectors of coordinates in the ship body reference system the generalized force input vector that the actuators can produce at the k th time instance is given by 9 u r k a f r k where the vector u r k has the same size n u of the input vector u of the model of eq 5 in eq 9 the constant configuration matrix of the ship a a r α ℝ n u n p is 10 a cos α 1 cos α p sin α 1 sin α p l y 1 cos α 1 l x 1 cos α 1 l y p cos α 1 l x 1 cos α p with α ℝ n p the vector of the constant actuators orientations and f r k ℝ n p the vector of real forces provided by the actuators set driven by the extended thruster vector f k ℝ n p provided by the ta algorithm 11 f k a u k in eq 11 a is the generalized moore penrose right inverse matrix 12 a a a a 1 and the solution of the allocation f k a u k is the weighed 2 norm sense optimal solution for an identity weight matrix w i of appropriate dimension fossen and johansen 2006 13 f k w f k f k w f k f k ℝ n p f k a u k 3 2 model predictive control the mpc solves iteratively a finite horizon optimal control problem formulated with respect to a prediction model of the controlled process and an estimation of its current state the lpv model of eq 5 has been used to design the mpc considering the scheduling parameters constant in prediction mollov et al 2004 cavanini et al 2017b 2017c with respect to the cybership ii nonlinear plant considering the control scheme of fig 1 in the proposed solution a quadratic cost is minimized subject to a set of affine constraints 14a min δ u i 1 n p q z z k i k r k 2 2 j 0 n u 1 q δ u δ u k j k 2 2 14b s t x k k x k 14c x k i 1 k a k x k i k b k u k i k 14d z k i 1 k c k x k i 1 k 14e δ u k n u j k 0 14f u k i k u 14g i 0 1 n p 1 14h j 0 1 n u 1 where n p is the prediction horizon n u is the control horizon q δ u and q z are the weights matrices with q δ u invertible x k i k denotes the prediction of the variable x at time k i based on the information available at time k δ u k i k is the vector of the input increments with u k 1 k u k 1 r k r x k r y k r ψ k is the output reference u is the polyhedral set of constraints on inputs and z k is the considered plant input due to the considered wave filter wf algorithm fossen and strand 1999 output z k y r k where y r k is the real pose of the ship and z k the filtered one problem 14 can be casted into a condensed qp problem of the form 15 min μ 1 2 μ h k μ ρ k f k μ s t g μ v ρ k w where μ ℝ n μ is the vector of optimization variables ρ k ℙ and ρ k ℙ are vectors of mpc parameters of dimension n ρ n u n x n z and n ρ n u with ℙ ℝ n ρ and ℙ ℝ n ρ bounded sets of interest with ρ k u k 1 and ρ k u k 1 x k z k h k ℝ n μ n μ is a symmetric and positive definite matrix f k ℝ n μ n ρ is the linear cost term g ℝ m u n μ v ℝ m u n ρ and w ℝ m u are the terms defining the inputs constraints remark 1 the mpc of eq 14 has been developed with respect to the lpv model of eq 5 in order to formulate a lpv mpc the lpv mpc approach considers a problem formulation closed to the lti mpc that represents a faster corona and de schutter 2008 cavanini et al 2017d cavanini et al and certifiable cimini and bemporad 2017 solution with respect to nonlinear mpc nmpc algorithms liu et al 2015 the additive computational effort required by the lpv mpc related to the computation of the matrices of the minimization problem can be exactly computed a priori whereas the nmpc can not guarantee to maintain the convexity of the quadratic minimization problem camacho and alba 2013 the possibility to certify the algorithm complexity and the computational effort required to compute the control law is of paramount importance for a real time implementation of the algorithm in commercial control platform for a comparative performance analysis between lpv mpc and nonlinear mpc algorithms it is possible to refer to casavola et al 2003 and in particular the cybership ii control case study has been analyzed in zheng et al 2014 remark 2 due to the formulation of the ta algorithm in the optimization problem of eq 13 the force allocation could be directly integrated within the mpc controller johansen and fossen 2013 in the proposed approach the ta and the mpc have been decoupled for two reasons i due to the study of the actuators configuration the ta policy can be developed and used to simplify the definition of the lpv model of sec 2 2 representing the nonlinear plant when a system is provided with a trust allocation policy usually the controller is decoupled from the ta that run with a different execution rate and it is assumed as part of the controlled plant in the proposed work the authors considered this approach to define the lpv model of the nonlinear plant and to develop the proposed controller i i maintaining decoupled the ta and the mpc allows to introduce in the controller the ft policy proposed in sec 4 4 fault tolerant model predictive control the previous qp problem of eq 15 is the standard mpc formulated with respect to the lpv model of eq 5 it guarantees control performances in the nominal scenario however in case of actuators fault this control has low effectiveness in this paper has been introduced a direct feedback from the ta block to the mpc see fig 1 in order to consider the actuators fault effect into the control law such feedback considers the direct knowledge of the computed actuator force reference value f and of the real actuators force f r see fig 1 gao et al 2015 only the control effort constraints have been considered in the minimization problem of eq 14f 16 u k i k u u k i k ℝ n u g u δ u k i k v u u k i 1 k u c where 17 g u i i v u i i u c u m u m μ δ u k k δ u k n u 1 k with i ℝ n u n u and 18 u m τ x m τ y m τ n m u m τ x m τ y m τ n m the vectors of minimum and maximum control effort bounds respectively the qp problem constraints matrices are 19 g g u 0 0 g u g u 0 0 g u g u v v u v u w u c u c in the same way the hessian matrix h and the linear term matrix ρ k f in the qp problem 15 have been defined as 20 h k h k h k q δ u h k q δ u f k ρ k h k q z f k x k s k where h k h a k b k c k ℝ n y n p n u n p n c is named prediction matrix h k ℝ n u n p n c n u n p n c f k f a k c k ℝ n p n z n x q z ℝ n p n z n p n z and q δ u ℝ n u n u n u n u are weight matrices built from q n δ u and q n z of eq 14 s k ℝ n p n z such that s k r k r k and 21 h k c k b k 0 0 c k a k b k c k b k 0 c k a k n p 1 b k c k a k n p n u b k f k c k a k c k a k 2 c k a k n p the input constraints of eq 14f formulated by eq 21 guarantee to compute a nominal control effort u k satisfying the tuning input signals bounds as discussed in section 3 1 the provided control effort is not applied directly to the system this is due to the presence of the ta algorithm that allows to compute the optimal extended force vector f k of eq 11 with respect to the nominal matrix a of eq 12 the real applied control effort is then computed as u r k a f r k by the moore penrose pseudo inverse proprieties a a i considering an actuators fault scenario u r k u k because of the computed optimal extended force vector f k f r k where f r k is the real extended force vector provided by the thrusters remark 3 control effort estimation is a widely studied problem and several solutions have been proposed in order to provide an estimation useful for fault detection and tolerance algorithms cristofaro and johansen 2014 liu et al 2016 liu and gao 2015 these results allow to consider the estimated value instead of the real force provided by each thruster if a provides the thrust allocation result in nominal conditions and u r k 1 a f r k 1 defining the diagonal matrix f k ℝ n p n p 22 f k f r k 1 1 f k 1 1 0 0 0 0 f r k 1 n p f k 1 n p where f k 1 i is the nominal force required by the i th actuator and f r k 1 i is the real one provided at previous time instance for i 1 n p the mapping matrix in case of fault is a k a f k such that 23 u r k a k a u k if f r k f k u k otherwise the equality f r k 1 f k 1 tested at each time step k successive to the application of the control effort f r k 1 is the fault detection condition in fault scenarios the plant 5 could not fit the real system behaviour due to unavailable actuators and to the relative reduction of system governability from eq 23 the fault matrix m k ℝ n u n u is defined and iteratively computed 24 m k a k a a f k a in order to introduce the fault effect in the plant model s f k 25 x k 1 a k x k b k m k u k z k c k x k where m k i in absence of fault the definition of system 4 suggest to rebuild the mpc with respect to the new system in order to formulate the fault tolerant policy of the following sec 4 1 4 1 fault tolerant algorithm the introduction of the matrix m k of eq 24 into the plant model of eq 25 causes a main drawback replacing in the model of eq 5 the input matrix b k with b k m k causes the lost of knowledge of the real plant input u r which in absence of fault has been constrained as in eq 23 this input in fault scenario cannot be constrained because the control law provides only the ta input u k losing the knowledge about u r k in order to overcome this problem it is possible to introduce directly the fault effect into the qp problem of eq 15 defining the block diagonal matrix 26 m k m k 0 0 0 m k 0 0 0 m k where m k ℝ n u n u n u n u and solving iteratively the problem 27 min μ 1 2 μ h k μ ρ k f k μ s t g k μ v k ρ k w the problem matrices are 28 h k m k h k m k q δ u f k f m k g k g m k v k v m k with h k ℝ n μ n μ f k ℝ n μ n ρ g k ℝ m u n μ v k ℝ m u n ρ in the case of not actuator fault by eq 23 h k h k f k f k g k g v k v both mpc and ft mpc algorithms requires the estimated state x k in order to compute iteratively the control law and in standard lpv mpc it is usually provided by a kalman filter kf as preposed in majecki et al 2017 in fault scenarios also the nominal kf designed with respect to nominal plant s k of eq 5 need to be re formulated in particular in the proposed work it has been done replacing in the kf algorithm the nominal b k matrix with the recomputed one b k m k referred to s f k of eq 25 4 2 non controllable scenarios the proposed approach allows to control the vessel in the presence of actuators fault and also to rebuild correctly input constraints with respect to the real applied input avoiding the drawback considered in sec 4 1 moreover by the presented solution it is possible to study the conditions of plant controllability in case of fault under the assumption that the nominal lpv plant model s k of eq 5 is controllable 29 rank b k a k b k a k n x 1 b k r a k b k n x the controllability of the plant in case of fault i e s f k of eq 4 is given by rank r a k b k m k n x this condition can be verified iteratively in case of fault in order to check if it is allowed to maintain the control of the system and otherwise to set to a safety state the control action furthermore the above controllability condition can be used to define offline the not controllable scenarios set according to the value of each element of f k see eq 22 testing for which combination of values 0 f r k i f k i 1 with i 0 n p the system becomes not controllable with f k i 0 to identify not controllable fault scenarios it is necessary to verify only the combinations of fault conditions causing a full breakdown failure of some actuator f r k i f k i 0 and then to check if f k f where 30 f f ℝ n p rank r a k b k m k n x is the not controllable actuators fault set with f ℝ f where ℝ f is the actuators fault subspace ℝ f ℝ n p defined as 31 ℝ f f ℝ n p 0 f i f i the tested fault tolerant mpc algorithm is reported in algorithm 4 2 the system is stopped in the presence of an actuators fault verifying the not controllability condition image 1 5 simulation results in this section the simulation results have been reported controlling the cybership ii nonlinear model of eq 3 both mpc and ft mpc have been formulated with respect to the lpv model presented in sec 2 2 the not controllable set of actuators faults has been studied considering the unavailability of actuators affected by faults by setting f r i 0 for each i t h lost actuator and f r i f i for the other ones the not controllable set f obtained by the study of the condition of eq 30 has been shown in table 2 reporting actuator fault combinations driving the system in the safety state such that u k 0 0 0 due to the actuators configuration fault scenarios setting the model into a not controllable state are related to a controllability matrix r a k b k m k featured by a rank value smaller than the size of the considered space state representation of eq 2 2 with n x 6 the tuning parameters of the considered mpc have been reported in table 3 in the proposed simulations the additive noise d k has been generated by the model 32 h w i s σ i s s 2 ζ i ω 0 i s ω 0 i 2 where i 1 2 3 is the index relative to the considered output surge sway and yaw respectively σ i 0 5 is the parameter related to the wave intensity ζ i 0 1 is the relative damping ratio and ω 0 i 0 8976 rad s is the dominant wave frequency in order to generate a wave disturbance featured by a frequency of 0 1429 hz the wave filter wf proposed in fossen and strand 1999 has been considered to estimate the true ship asset filtering the disturbances d k due to the sea wave the scheduling parameter vector has been computed with respect to the heading angle estimated by this filter the matlab active set based qp solver quadprog is used in the reported simulations the reference signal for the ship orientation r ψ has been filtered by an appropriate low pass filter introduced in order to provide a smooth output behaviour in order to validate the lpv mpc proposed in eq 14 a set of simulations have been reported in fig 3 and fig 4 showing the control performance tracking a set of step references with different amplitudes fig 3 presents the controlled outputs yellow by the proposed lpv mpc with respect to the reference signal dashed black and fig 4 shows the control effort computed by the lpv mpc driving the cybership ii nonlinear plant reported results validate the proposed control approach showing the effectiveness of the controller in fault free scenarios to verify the performance of the proposed ft policy the ft mpc presented in sec 4 has been compared with respect to the mpc of eq 14 in order to test the effectiveness of the considered algorithm a set of fault scenarios have been considered driving the vessel by a set of test trajectories and considering several actuators faults both mpc and ft mpc have been tested driving the vessel with a set of step reference signals of amplitude r x 10 m r y 5 m and r ψ 0 0175 rad introducing a wave disturbance featured by a noise intensity σ i 0 5 the tested scenario shows the large tracking error of the mpc in absence of the ft policy the algorithms have been compared with respect to the percentage integral square error ise improvement δise mpc ft mpc 33 δise mpc ft mpc ise mpc ise ft mpc ise mpc 100 in table 4 the δise mpc ft mpc results related to the considered step response for each controlled output have been reported the pedics x y and ψ refer to the controlled outputs the first row of table 4 presents the δise mpc ft mpc value in case of normal behaviour i e in absence of actuators fault and the other rows compare the mpc and ft mpc algorithms for each faults combination the average percentage ise improvements of the ft mpc with respect to the standard mpc are 12 38 27 21 and 99 54 for x y and ψ respectively in particular the proposed fault tolerant policy allows to eliminate the transient overshoot related to the controlled orientation ψ and to reduce the controlled output steady state error variance 5 with the ft mpc instead of the 8 of the reference value with the standard mpc these results confirm the effectiveness of the proposed approach showing the improvement of the ft mpc with respect to the standard mpc in each fault scenarios and maintaining standard performance in case of fault free behaviour the reported δise mpc ft mpc results show the reduction of the error obtained applying the ft mpc in particular with respect to the orientation error ψ which in case of fault is the most affected by performance degradation as an example in figs 5 6 simulations related to one of the proposed actuators fault scenarios i e considering the combination f r f 1 0 f 3 0 f 5 have been reported in order to shown the transient response improvement given by the introduction of the fault tolerant action in the standard mpc in the simulations of figs 5 6 the system has been driven with two consecutive equal steps during the first step the fault free scenario has been considered see time instant t 100 and in the second step see time instant t 100 the considered actuators faults configuration has been introduced in the vessel the results show simulation that consider an additive wave noise featured by an intensity of σ i 0 5 in particular fig 5 shows the improvement introduced by the proposed approach with respect to the standard mpc controlling each driven output in a fault scenario t 100 fig 6 shows the control efforts comparison showing that the introduction of the fault effects in the reference plant model causes the computation of different control signals allowing to improve the control performances the compared algorithms provide the same control results in the first part of the simulation of figs 5 6 t 100 i e when the nominal fault free scenario has been considered furthermore considering the previous fault scenario simulation results considering a wave noise featured by an intensity of σ i 5 have been reported in order to test the control performance in case of strong wave additive disturbance fig 7 and fig 8 shown the controlled outputs and the control efforts respectively in fault free and in faulty scenario in fault free control scenario t 100 the compared controllers provide the same results for t 100 the fault is introduce in the vessel showing that the ft mpc provides again good control performances the percentage ise improvements of the ft mpc with respect to the standard mpc are 12 43 6 43 and 98 32 for x y and ϕ respectively the results of the ft mpc are similar to that obtained in the previous case of low wave noise while the control results provided by the standard mpc show lower performance also in these conditions of strong disturbance the orientation ψ presents a good improvement due to the introduction of the fault tolerant action providing results comparable with those obtained in the fault free scenario in terms of transient overshoot compensation and steady state stabilization error variance to design the proposed ft mpc policy in sec 4 the true thrusters state in fault scenarios has been considered known due to the possibility to introduce in the controller a thrusters state estimator in real applications the estimated thrusters state can be affected by estimation errors due to the presence of noise and external disturbances in order to test the performance of the proposed ft mpc algorithm in the presence of thrusters state estimation errors a comparative analysis has been performed in particular the ft mpc in the presence of thruster estimation errors ft mpc e has been compared with respect to the ft mpc considering available the true thrusters state ft mpc r the estimation error has been modeled by an additive white noise signal affecting the real thrusters state values provided to the ft mpc the considered noise signal is featured by a sample time of 0 25 s a zero mean value and a variance of the 5 of the nominal thrusters power the comparison results have been collected in table 5 in terms of the δise ft mpc r ft mpc e computed as in eq 33 these results show that the control performance are strictly related to the goodness of the thrusters state estimation the ft mpc e affected by the introduced thrusters state estimation errors provides a performance degradation of 0 5230 0 0823 and 5 1989 with a variance of the 9 0736 6 0203 and 20 2189 for the x y and ϕ outputs with respect to the ft mpc r furthermore to validate the proposed approach a control performance comparison has been done considering the mpc of eq 14 and the nonlinear mpc nmpc proposed in de nicolao et al 1997 both lpv mpc and nmpc have been tested tracking a set of random reference signals in the fault free scenario the average value and the variance of the δise nmpc mpc values computed as in eq 33 provided by the algorithms and the related average computation time have been considered in the comparison the proposed mpc provided with respect to the nmpc a δise nmpc mpc degradation of 3 2 4 1 and 2 4 with a variance of the 3 9 2 5 and 1 8 for the x y and ϕ outputs respectively 6 conclusions in this paper a model predictive control mpc policy to improve the performance of an over actuated ship in actuators fault scenarios has been proposed the vessel has been described by a linear parameter varying lpv model allowing to design a lpv mpc solution to control the vessel the presented fault tolerant ft solution introduces a feedback signals between the thrust allocation ta algorithm and the main controller in order to obtain a ft mpc policy the ft mpc algorithm improves the control results also in the presence of wave disturbance with different intensities the proposed approach allows to define off line possible fault combinations that reduce the system controllability defining ad hoc control actions the performance of the proposed ft mpc have been evaluated with respect to a standard mpc by the evaluation of a control index ise and by the analysis of the transient response results 
23319,real time prediction of ship roll motion is vital for marine safety and efficiency of operations onboard the ship however ship roll motion is a complex time varying nonlinear process which varies with various sailing conditions as well as time varying environmental factors to achieve precise real time ship roll prediction an ensemble prediction scheme is constructed by combining the discrete wavelet transform dwt method with the variable structure radial basis function rbf network the dwt is used to reduce the time series data redundancies and carry the data information in few significant uncoupled sub series thus facilitate the identification and prediction by using the variable rbf networks the variable rbf networks are used to represent time varying dynamics with both the structure and parameters are tuned in real time the dwt transform based variable rbf networks are used to represent the time varying nonlinear dynamics of ship roll movement during ship maneuvering the effectiveness of the proposed dwt based real time roll prediction scheme is demonstrated by short term ship roll motion prediction experiments based on the actual ship roll motion measurements collected during sea test of m v yukun keywords ship roll motion real time prediction variable neural network radial basis function network wavelet decomposition 1 introduction ship s roll motion is vital for marine safety especially under condition of rough seas the prediction of ship roll is also necessary for operations such as landing or takeoff of air vehicles onboard ship however ship roll motion in the sea is a complex process with nonlinearity time varying dynamics and uncertainty fossen 2011 its dynamics vary with changes of sailing conditions such as speed trim and loading conditions vidic perunovic and jensen 2009 ship motions are also influenced by time varying environmental factors like winds backalov et al 2010 currents and waves bulian and francescutto 2011 ship s roll and movements in other degrees of freedom such as heave yu et al 2006 pitch zhou and chen 2008 motions are influenced and coupled with each other chang 2008 therefore it is hard to establish a deterministic model to represent the complex dynamics of ship s motion at sea wang et al 2016a b to get precise real time ship roll predictions an adaptive nonlinear model is needed to represent the complex time varying nonlinear dynamics the booming intelligent computation techniques have been successfully used in areas of nonlinear system identification and control haddara and xu 1998 malekmohamadi et al 2011 yin et al 2013 wang et al 2016a b among various advanced computational approaches neural networks have gained much popularity because of their virtues such as inherent nonlinearity nature and adaptive ability haykin 1999 neural networks have also been widely utilized in system identification dai et al 2012 kim et al 2016 and prediction kumar et al 2017 in areas of ocean engineering and naval architecture in recent years however conventional batch learning neural networks are designed to represent the holistic pattern of a system rather than the time varying dynamics thus are not suitable to represent time varying dynamics to represent current status of system dynamics the newly received samples should be processed online for identifying current system dynamics to adapt to the changes of system dynamics the network model should be variable in both parameters and structure the sequential learning strategies are oriented to construct and tune network adaptively and have gained much research popularity in the last decades suresh et al 2010 platt 1991 liang et al 2006 platt proposed resource allocation network ran sequential learning strategy platt 1991 ran was then developed and applied widely in various fields kumar et al 2017 but ran tunes network structure based on the newest single sample may cause instability of the resulted network structure to solve this problem yin et al presented gradient orthogonal model selection goms algorithm to construct a variable structure radial basis function rbf network based on sliding data window sdw yin et al 2013b 2017 to represent time varying system dynamics the sdw scheme has been employed as system status observer in control akpan and hassapis 2011 and information processing li et al 2013 applications by learning real time updated samples in sdw the neural network can be tuned according to the time varying system dynamics represented by the data in the sdw the ship s motion is inevitably influenced by environmental factors such as winds waves and currents its dynamics can be more complex with the incorporation of factors of the draft trim thrust etc various factors effects with different characteristics are entangled together which increases the difficulties for representing the overall dynamics among various advanced signal processing and data mining methods kim and park 2015 wavelet transform has become a useful tool for analyzing variations and trends of time series in the last decade wilson 2017 mallat 2008 in the ship motion analysis applications yu et al explored wavelet transforms to investigate the nonlinear dynamical characteristics of ship roll and coupled heave roll motion in waves yu et al 2006 du et al applied daubechies wavelet function to analyze measured ship model data du et al 2008 hariharan et al applied an efficient shifted second kind chebyshev wavelet method s2kcwm to ship vibrating dynamical models hariharan et al 2016 sathyaseelan et al introduced an efficient legendre wavelet spectral method lwsm to identify ship roll motion sathyaseelan et al 2017 hariharan and sathiyaseelan employed two wavelet methods for the numerical solutions of the transient free surface ship model hariharan and sathiyaseelan 2017 wavelet analysis is a multi resolution analysis method in both time and frequency domain thus the original signal can be decomposed into different resolution sub signals using the discrete wavelet transform dwt method the dtw can be used to reduce the redundancy of the data and convey the information in few uncoupled components chou and wang 2004 napoli et al 2010 the intrinsic features of subseries could be shown more obvious than that of the original series which facilitates the analysis identification and prediction of the complex time series the decomposed time series can represent the changes of the ship motion dynamics but the underlying hydrodynamic and kinematics characteristics of decomposed time series are still unknown because the variable ann can identify and generalize the time varying nonlinearity information adaptively the combination of dwt and ann takes advantage of the two methods and is suitable to represent and predict complex time varying nonlinear system like ship roll movement the combination of dwt and ann has been widely used in time varying time series analysis and prediction approach in recent years kumar et al decompose the eeg signals to approximation and detail coefficients by dwt and process the coefficients by a feed forward back propagation neural network kumar et al 2014 wei et al utilized discrete wavelet multi resolution method to decompose the time series into sub series which were used as inputs of the artificial neural network ann to generate river discharge predictions wei et al 2012 deka employed the decomposed sub signals as inputs of the ann to forecast the significant sea height at different multistep lead time deka and prahlada 2012 chen constructed a hybrid model for tide prediction by combining the ann with wavelet multi resolution analysis mra method chen et al 2007 in deshmukh s study the decomposed sub signals are provided as inputs to the neural network instead of the raw signal time series for forecasting ocean waves deshmukh et al 2016 the wavelet decomposition method and variable rbf network are implemented in ship roll motion prediction to validate the effectiveness of the ensemble prediction model in this paper aiming at the time varying and nonlinear natures of ship motion dynamics an ensemble model is established for real time short term ship roll motion prediction by combining the variable rbf network and dwt multi resolution decomposition the ship roll motion time series is decomposed and the decomposed sub series are predicted individually by variable rbf network the variable rbf network is used to represent time varying dynamics by tuning its structure and parameters in real time individual predictions of subseries are reconstructed to obtain the final prediction result to validate the feasibility and effectiveness the proposed prediction model was applied to real time ship roll prediction experiment by using measured data of zigzag test in a full scale sea trial of m v yukun the remainder of this paper is organized as follows the dwt decomposition and the variable rbf network are presented in section 2 the structure of the function and the dwt based variable rbf network is presented in section 3 in section 4 the real time ship roll motion prediction simulations using dwt based variable rbf network are conducted and the performance is discussed conclusions are finally derived in section 5 2 ensemble ship roll motion prediction the prediction scheme is established by combining the discrete wavelet transformation method and a variable rbf network constructed by goms algorithm which would be described as follows respectively 2 1 discrete wavelet transformation the time series of time roll motion contains useful information concerning the influences of environmental factors and other unmodeled factors but the influences of different factors are tangled together thus making the time series hard to represent and predict precisely wavelet transformation is a signal processing tool which is capable of analyzing both stationary and nonstationary information and to generate both time and frequency information in a higher resolution which is not available from the traditional transformation like fourier transform mallat 2008 the wavelet transform decomposes the original signal into wavelets which are scaled and shifted versions of the mother wavelet the discrete wavelet transform dwt method decompose the original signal into a limited number of components can be assembled back into the original signal without loss of information this processing of signal facilitates the applications such as using the sub signals as the inputs to ann or processing the sub signals individually in multi resolution signal decomposition of dwt approach signals are analyzed at different scales using filters with different limit frequencies original signal x t is passed through a series of high and low pass filters and down sampled to approximation coefficients a k and detail coefficients d 1 d 2 d k respectively logarithmic uniform spacing mallat 2008 allows the completely orthogonal wavelet basis to be constructed it uses n transform coefficients to fully describe a signal with the length of n with zero redundancy these discrete wavelets are not specified continuously on time axis but at discrete locations the resulting discrete wavelet transform dwt can be translated and dilated in discrete time steps for original signal x t the discrete wavelets can be expressed as 1 ψ m n t τ s 1 s 0 m ψ t n τ 0 s 0 m s 0 m where m and n are integers that control the wavelet dilation and shift respectively s is the scale and τ is the location parameter greater than zero s 0 m is a fixed dilation step greater than 1 from eq 1 it is noticed that the translation steps n τ 0 s 0 m depend upon the dilation s 0 m the discrete wavelet transform using mallat algorithm is adopted for time series decomposition and reconstruction mallat 2008 2 2 variable rbf neural network as environmental influencing factors to ship motion such as winds and waves usually change rapidly over time custom static neural networks with fixed network structure cannot represent time varying dynamics efficiently even for the decomposed sub signals so there is a practical need for a variable network whose structure and parameters are both adjusted in real time construction of a variable structure neural network by sequential learning is a research focus in recent years suresh et al 2010 sequential learning algorithms have been used to represent time varying system dynamics with the variable neural network platt 1991 liang et al 2006 yin et al 2013b it handles samples sequentially and tunes the network s structure and parameters adaptively among various types of networks radial basis function rbf network is the most popular network in sequential learning due to their local response character simple topology fast convergence speed and no local minima haykin 1999 therefore in this study the f is modeled by a variable structure rbf network which is constructed by a sequential learning goms algorithm yin et al 2013b which is described as follows the adjustment of the network structure involves both network growing and network pruning at each step in the growing stage the latest sample is added as a new hidden unit directly while in the pruning stage units with little contributions are pruned from the network hidden layer once the units are determined at each step the connecting weight between the hidden and output layers would be adjusted accordingly in this sequential learning scheme a sliding data window sdw is employed to represent time varying dynamics and algorithm learns samples in the window sequentially yin et al 2013b the sdw is a first in first out fifo sequence expressed as follows 2 w sd x t y t x t 1 y t 1 x t n 1 y t n 1 where n denotes the width of sliding window x and y denote the input and output vectors the window includes the input matrix x x t x t n 1 ℜ n n and the output matrix y y t y t n 1 t ℜ m n with n and m being the dimensions of input and output respectively therefore the real time updated window in real time can be utilized to represent current system dynamics in this study the single hidden layer is adopted in the rbf network and the j th output can be expressed as follows 3 y j k 1 m θ k ϕ k x c k k 1 m θ k exp x c k 2 2 σ k 2 where ϕ i is the activation function of k th hidden unit with the gaussian function being selected in this study c k is the k th hidden unit center denotes the euclidean distance operator σ is the scale parameter of k th hidden unit j is the index of outputs m is the number of hidden units θ k is the connecting weight between the k th hidden unit and the j th output the total input output mapping of rbf network can be represented in matrix form 4 y φ θ the response matrix is orthogonalized using the gram schmidt method chen et al 1991 to evaluate the contribution of individual hidden unit 5 φ w a where w is the orthogonalized response matrix whose individuals are mutually orthogonal and a is an upper triangular matrix then the contribution of the k th hidden unit to the output is evaluated according to its corresponding error reduction ratio err 6 e r r k w k t y w k t w k y t y where w k is the k th vector of the orthogonalized response matrix w the value of err is the projection of each hidden unit in the space spanned by w which is used to evaluate the contribution of each hidden unit to the output for multi in multi output mimo process chen et al 1992 err is calculated by 7 e r r k j j 1 m w k t y j 2 w k t w k trace y t y where j denotes the index of outputs however the matrices of φ ℜ n m and w ℜ n m are not square when m the number of hidden units is not equal to n the sliding window width therefore the summation of err is not equal to 1 and cause it impossible to evaluate the contribution of an individual hidden unit by err directly to utilize err in this sdw based sequential learning scheme an index of normalized error reduction ratio nerr is employed to measure the contribution of each hidden unit yin et al 2013b 8 n e r r k e r r k k 1 m e r r k therefore the summation of nerr becomes 1 thus the contribution of an individual hidden unit can be evaluated by means of nerr at each step the nerr of individual hidden unit is calculated and units with small values of nerr are selected the selection process would be terminated once the summation of nerr reaches a preset accuracy threshold ρ 9 i 1 p 1 n e r r i ρ where p is the number of selected hidden units it is noted that the summed value of nerr corresponding to the selected p units is less than ρ if certain units are selected for l consecutive steps they would be regarded as obsolete and pruned from the network this procedure is taken to assure the stability of the rbf network by deleting the units which are inactive consecutively at each step after the hidden units are adjusted by adding and pruning connecting weights θ can be updated using the pseudo inverse method 10 θ φ y φ t φ 1 φ t y by adjusting the network dimension it can also alleviate the phenomenon of over fitting and under fitting thus guarantee generalization capability as well as the processing speed 3 real time ship roll motion prediction mechanism 3 1 dwt based neural network prediction scheme configuration the prediction of ship roll motion presents challenges because ship roll dynamics exhibited in the original time series are difficult to detect ship roll dynamics are often obscured by the holistic trend or fluctuations of the time series effects of various influential factors such as winds and waves exhibit different frequencies and features in the time series which increase the difficulties for identification and prediction in this study to overcome this problem the original ship roll time series is separated into multiple resolutions at different frequencies by dwt thus the signals at multiple resolutions for different frequencies can be analyzed separately which enables us to catch the characteristics in the subseries precisely in order to generate precise forecasts for ship roll motion the original ship roll time series is decomposed into frequency related subseries and the individual subseries are identified and predicted separately then the prediction is achieved by reconstructing the forecasts from every subseries in this study the dwt based variable rbf network is proposed which combines the advantages of wavelet decomposition and variable rbf network the wavelet decomposition is used to reduce data redundancies and to obtain representation of raw time series with a few significant uncoupled coefficients and generate effective long term predictions napoli et al 2010 even the series is decomposed into sub signals with different frequencies they also possess nonlinearities in nature therefore neural networks are employed to represent the nonlinearities in subseries the custom static neural networks cannot represent the complex influence of time varying meteorological factors however the variable rbf network enables the adaptability and nonlinear representation capability of the model the dwt is used to reduce the time series data redundancies and carry the data information in few significant uncoupled sub series thus facilitate the identification and prediction by using the variable rbf networks the prediction is processed in two stages the identification stage and prediction stage on the identification stage the ship roll angle time series is decomposed to several subseries for further identification performed by the variable rbf network which is online constructed by the goms algorithm while on the prediction stage the tuned rbf networks are implemented for prediction of sub series and the results are finally combined to generate the ship roll prediction the ship roll angle time series which incorporates the influences of environmental and other unmodeled factors can be expressed by relatively simple subseries for each subseries the identification is performed by the variable rbf network to represent their individual dynamics that is the variable rbf network is tuned to represent the dynamics of individual sub series the configuration of the learning process is illustrated in fig 1 in this sequential processing mode the prediction stage is conducted once the identification stage is completed with both stages being conducted at each step consecutively in the prediction process the overall output is subsequently achieved by summing the prediction results of the individual sub series the configuration of the prediction process is illustrated in fig 2 3 2 variable radial basis function network structure in this study the original ship roll motion time series r is decomposed into multi level subseries prior to the prediction procedure the resulting relatively simple subseries are represented and predicted by individual variable rbf network the prediction results are then summed together to achieve the final prediction for k level decomposition the resulted subseries are denoted as a k d 1 d k respectively here we take a k for example to illustrate the prediction model ship roll motion time series contains much useful information and the time series prediction is employed in this study the time series prediction can be represented by the nonlinear autoregressive with exogenous input narx prediction model take 1 step ahead prediction of subseries a k for example the identification model at time t is expressed as 11 a k t f 1 a k t 1 a k t 2 a k t p ε 1 t therefore prediction of a k t 1 can be achieved by using the samples which are currently available 12 a ˆ k t 1 f 1 a k t a k t 1 a k t p 1 generally for q step ahead prediction of subseries ak the identification model is 13 a k t g 1 a k t q a k t q 1 a k t q p 1 ε t narx model for q step ahead prediction can be obtained by replacing t in 15 with t q 14 a ˆ k t q g 1 a k t a k t 1 a k t p 1 the lag p is set as 7 in this study as a result the topology structure of the variable rbf network model is i7h x o1 where i7 denotes 7 input units o1 denotes single output and h x denotes the x hidden units with value of x being on line adjusted by the goms algorithm 4 real time ship roll prediction simulation 4 1 prediction simulation settings experiments of online ship roll prediction were conducted to verify the efficiency of the online neural prediction strategy based on multi resolution decomposition the future ship roll angle is estimated by variable rbf network based on dwt decomposition the rbf network is adjusted based on the learning of samples in the sliding data window in this study experiments are conducted under matlab 7 9 environment and run at 2 40 ghz cpu and 3 57 gb memory ram the data used in this study are measured from the sea test of m v yukun a scientific research and training ship of dalian maritime university as displayed in fig 3 the main particulars of motor vessel yukun are shown in table 1 the ship motion status is achieved by using ashtec adu2 which is a ship motion measurement device which can measure the ship motion status during the ship maneuvering in the sea the prediction process would be conducted once the network is online established in the learning process at each step ship s zigzag test is a conventional manoeuvre test used to evaluate the ship manoeuvrability to validate the efficiency of the proposed predictive approach the experimental data of 20 20 full scale zigzag test of yukun from sea trial is adopted to validate the adaptability of the proposed method the voyages before and after the zigzag test is also included the initial speed of the ship in the zigzag test is set at 14 7 kn the sea trial was performed in the bohai sea area on aug 8 2009 and the sea state is 4 ship motion trajectory during the zigzag test is shown in fig 4 it is noted that there are two straight line sailing segments before and after the zigzag test and their ship motion dynamics are quite different from the zigzag motion dynamics therefore the ship roll motions of straight line sailing segments are also included in the experiment to evaluate the adaptability of the proposed prediction method the changes of ship roll angles during the test are depicted in fig 5 the wavelet decomposition is employed with decomposition level being selected as 4 and the wavelet type selected as db5 the decomposed approximation and details of ship roll motion time series are shown in fig 6 4 2 ship roll motion prediction simulation results the identification and prediction performances of the model are evaluated by an index of root mean square error rmse noted as prediction rmse rmse pre 15 r m s e pre i 1 n y pre t q y t q 2 n where y pre t q and y t q are the predicted and actual values of ship roll angles at time t q respectively the 60s ahead ship roll motion prediction experiment was conducted to illustrate the performance of the proposed dwt based neural prediction scheme in this experiment the parameters for goms algorithm are selected as n 3 ρ 0 2 l 3 respectively the variable rbf networks are individually tuned using the decomposed components in each step after identification procedure is completed the tuned rbf networks would be used to predict individual decomposed components the predicted components would be summed together to obtain the prediction of ship roll angle the final ship roll motion prediction is then achieved by combining the prediction results of decomposed components by using variable rbf network the 60 s ahead ship roll prediction results are depicted in fig 7 together with the actually measured ship roll angles it is shown that the dwt based variable neural network predictive model can detect and represent time varying dynamics in decomposed time series components except for component of d1 this can be attributed to the multi stage decomposition of the ship roll angle time series which decomposes the original complex time series into components which are much easier to be predicted the big error in predicting sub series of d1 is because that the sub signal with high frequency is random to a large extent thus is hard to predict the individual prediction errors of the one approximation and four details components are illustrated in fig 8 it is shown in fig 8 that the prediction error of a4 fluctuates within a small range and the prediction errors of details of d2 d3 and d4 fluctuate within a relatively small range while the prediction error of d1 varies within a relatively large range these differences can be attributed to the fact that the change of approximation a4 is smooth thus is relatively easy to be predicted while the detail components which change fast would lead to larger prediction errors it is also noticed in fig 8 that there are no sustained deviations between the predicted ship roll angles and measured ones the root mean square prediction errors of a4 d1 d2 d3 and d4 are 0 0417 0 4732 0 3380 0 2244 and 0 0501 respectively during the simulation the rbf network structure is variable with hidden units being added or pruned adaptively to represent the time varying dynamic changes of ship roll motion it is noticed that the number of hidden units is variable it ranges from 4 to 10 during the identification process for approximation component a4 and the corresponding average hidden units number hun during simulation is 5 7660 the average huns for the details d1 d2 d3 and d4 are 8 3260 11 8920 8 0920 and 6 5080 respectively the ahnn evolution history of different wavelet components is depicted in fig 9 respectively the maximum values minimum values and standard deviations of the hidden units corresponding to predictions of different components are shown in table 2 respectively as the hidden units increase from 1 the minimum number of hidden units is 1 for all the components however after the 10 th step the minimum hidden units numbers for a4 d1 d2 d3 and d4 become 5 5 8 5 and 5 respectively the tuning mechanism for hidden units enables there are enough hidden units to approximate the input output mapping this enables the prediction accuracy as well as the stability of the algorithm there are several detailed components and approximation component which are identified and predicted respectively the choice of the components which compose the final prediction also has an influence on the representation ability of the proposed prediction scheme approximation component a4 indicates the changing tendency of the ship roll and should be reserved the detailed components d2 d3 and d4 convey the low frequencies signals and some high frequencies signals and the corresponding prediction results are included in the final results the detailed component d1 possesses the highest variation frequency comparing to other decomposed components as detailed component d1 has higher frequency comparing with other components so it is more prone to be contaminated by random measurement noises which would lead to large prediction errors in this study the experimental data is measured by ashtech adu2 and the measurement variance is 0 4 which is high comparing to the amplitude of the ship roll angles so the prediction of these strong random measurement noises would bring extra deviation from actual values in this study therefore in this study the component of d1 is discarded in the ship roll prediction scheme the prediction result by combining the predicted values of components of a4 d2 d3 and d4 is shown in fig 10 the rmse of the prediction error by using components of a4 d2 d3 and d4 is 0 4882 and the correlation coefficient between the actual ship roll angles and the predicted ones is 0 9637 for comparison purpose the prediction result by combining the predicted values of components of a4 d1 d2 d3 and d4 is shown in fig 11 the rmse of the prediction error by using all the components of a4 d1 d2 d3 and d4 is 0 6126 which is 25 5 higher than that obtained by neglecting the prediction result of d1 and the correlation coefficient between the actual ship roll angles and the predicted ones is 0 9428 as detail component d1 contains measuring noises which are hard to estimate precisely would bring extra prediction errors when incorporating the estimation of d1 in the prediction mechanism for comparison purpose other combinations of components are tested in conditions including the component of a4 the prediction error is relatively small with prediction rmse of 0 5500 by using a4 d3 and d4 and with prediction rmse of 0 8159 by using a4 and d4 in conditions without a4 the prediction error is quite large comparing those with a4 the results are presented in table 3 to further validate the prediction mechanism the experimental data of yukun s 10 turning circle test is adopted to perform 60s ahead ship roll motion prediction experiment the sea trial was performed in the bohai sea area on aug 8 2009 under sea state of 5 and the turning circle test was performed at initial speed of 16 kn altogether 500 steps of prediction are conducted and the parameters of the prediction scheme is the same as that of the ship roll prediction simulation based on the measurements of zigzag test different combinations of components are tested and the results are also compared in table 3 it can be noted in table 3 that the discard of d1 increases the prediction accuracy in this online ship roll motion prediction study validated the feasibility of the proposed ship roll prediction mechanism however the application of this kind of component selection is under specific circumstances that is the measurements noises signal is strong and the estimation of these signal may degrade the prediction accuracy furthermore the small number of hidden units in the variable rbf network may also deteriorate its anti noise ability comparing with conventional neural networks which will lead to large prediction errors for signals with strong measurement noises therefore it should be noted that the selection of components in this study is valid due to some random effects like the strong measurement noises by using adu2 and the prediction scheme based on variable rbf network it may not valid under other databases or other prediction schemes as stated above at each step the prediction would be conducted once the identification is finished during the identification process the ship roll motion time series is decomposed identified and predicted by variable rbf networks in this study sequential learning rbf network only employs a small number of hidden units which enables its high processing speed of the hybrid prediction model the overall consumed cpu time for 500 steps of processing is 9 70s the average time for each step including identification and prediction process is only 0 019s the fast computational speed facilitates its practical applications to demonstrate the advantage of wavelet decomposition process conventional variable rbf network was also implemented for 60 s ahead prediction using the same ship roll motion database for comparison purpose the parameters for constructing conventional variable rbf network are selected as n 5 ρ 0 0001 l 2 the resulting rmse pre is 1 2701 and the correlation coefficient between the actual ship roll angles and the predicted ones is 0 7758 which exhibits lower accuracy comparing to the dwt based ensemble prediction scheme the decomposed components of ship roll angles time series are simpler to be predicted which lead to the higher prediction accuracy the average hidden units number is 5 5475 the running time of 500 steps of simulation is 1 71s and the average running time for each step is 0 003s the faster processing speed using conventional variable rbf network is caused by the exemption of processing various decomposed wavelet components to validate the prediction accuracy for longer time horizon simulations are conducted based on the same measurement data in the simulation same parameters are employed for constructing variable rbf network by using goms algorithm and the results are compared in table 4 the cc denotes the correlation coefficient between the predicted values and the measured ones it is noticed in table 4 that the proposed dwt based ensemble prediction method can give stable predictions for ship roll predictions with higher prediction accuracy than that without dwt composition this can be attributed to that the decomposed subseries are easier to be represented than original ship roll time series the prediction accuracy fluctuates slightly with the extension of the prediction horizon which shows that the individual decomposed sub signal shows similar dynamics and facilitates the representation and prediction it also demonstrates that the ship roll motion dynamics vary slightly during the ship sea test it can also be noticed that the dwt based neural prediction scheme consumes more time than that without dwt decomposition this is because the dwt based prediction scheme would conduct identification and prediction processes for each wavelet components so that the processing time is also increased consequently however because there are only small number of hidden units the processing speed is rather fast the high processing speed of the variable rbfn based prediction schemes can also be ascribed to that it only processes the samples in the sliding data window to make comparison with other prediction approaches some conventional prediction approaches are also implemented to perform ship roll prediction simulation by using the same measurement data these employed approaches include the back propagation bp networks the os elm model liang et al 2006 and the custom autoregressive ar model respectively in the implementation of bp network the levenberg marquardt method is employed for bp learning and the hidden layer number is selected as 3 the os elm model is featured by its extremely quick processing speed and satisfactory generalization capability in implementing os elm the number of hidden units is set as 30 and the initial number of training samples is set as 20 as a conventional prediction method the linear ar model is also employed for comparison the comparison results using methods of bp neural network os elm and custom ar approach are shown in table 5 the rmsepre index represents the root mean square errors of prediction it is shown from the simulation results that the nonlinear methods like bp network os elm goms and dwt based goms possess higher prediction accuracy than linear ar prediction method but the processing speed of bp network is slow because of its iterative training process the os elm method has the fastest processing speed attributing to its random selection scheme but its prediction error is larger than that by using the approaches of goms and dwt based goms custom linear ar method has relatively fast processing speed but it is difficult to represent and predict the nonlinear ship motion using linear method the results also demonstrate the effectiveness of the presented dwt based goms algorithm 5 conclusion a dwt based variable neural prediction scheme is proposed by making use of both the wavelet decomposition method and the variable rbf network decomposition of the ship roll motion information by multi level wavelet decomposition facilitates the identification and prediction of variable rbf network simulation results of real time ship roll motion prediction demonstrate that the proposed method generates precise predictions with high processing speed which demonstrates the feasibility and effectiveness of the ship motion prediction method to adapt to the diversity of the ship sailing conditions and to extend the prediction horizon the self adaptation of scheme parameters and the inclusion of more a priori knowledge of ship motion in the prediction scheme will be our future research efforts acknowledgements the authors would like to thank the editors and anonymous reviewers for their valuable comments and constructive suggestions that led to a substantially improved paper this work is supported by the national natural science foundation of p r china under grants 51009017 and 51379002 the fund for dalian distinguished young scholars under grant 2016rj10 the innovation support plan for dalian high level talents under grant 2015r065 and the fundamental research funds for the central universities under grants 3132016314 and 3132016322 
23319,real time prediction of ship roll motion is vital for marine safety and efficiency of operations onboard the ship however ship roll motion is a complex time varying nonlinear process which varies with various sailing conditions as well as time varying environmental factors to achieve precise real time ship roll prediction an ensemble prediction scheme is constructed by combining the discrete wavelet transform dwt method with the variable structure radial basis function rbf network the dwt is used to reduce the time series data redundancies and carry the data information in few significant uncoupled sub series thus facilitate the identification and prediction by using the variable rbf networks the variable rbf networks are used to represent time varying dynamics with both the structure and parameters are tuned in real time the dwt transform based variable rbf networks are used to represent the time varying nonlinear dynamics of ship roll movement during ship maneuvering the effectiveness of the proposed dwt based real time roll prediction scheme is demonstrated by short term ship roll motion prediction experiments based on the actual ship roll motion measurements collected during sea test of m v yukun keywords ship roll motion real time prediction variable neural network radial basis function network wavelet decomposition 1 introduction ship s roll motion is vital for marine safety especially under condition of rough seas the prediction of ship roll is also necessary for operations such as landing or takeoff of air vehicles onboard ship however ship roll motion in the sea is a complex process with nonlinearity time varying dynamics and uncertainty fossen 2011 its dynamics vary with changes of sailing conditions such as speed trim and loading conditions vidic perunovic and jensen 2009 ship motions are also influenced by time varying environmental factors like winds backalov et al 2010 currents and waves bulian and francescutto 2011 ship s roll and movements in other degrees of freedom such as heave yu et al 2006 pitch zhou and chen 2008 motions are influenced and coupled with each other chang 2008 therefore it is hard to establish a deterministic model to represent the complex dynamics of ship s motion at sea wang et al 2016a b to get precise real time ship roll predictions an adaptive nonlinear model is needed to represent the complex time varying nonlinear dynamics the booming intelligent computation techniques have been successfully used in areas of nonlinear system identification and control haddara and xu 1998 malekmohamadi et al 2011 yin et al 2013 wang et al 2016a b among various advanced computational approaches neural networks have gained much popularity because of their virtues such as inherent nonlinearity nature and adaptive ability haykin 1999 neural networks have also been widely utilized in system identification dai et al 2012 kim et al 2016 and prediction kumar et al 2017 in areas of ocean engineering and naval architecture in recent years however conventional batch learning neural networks are designed to represent the holistic pattern of a system rather than the time varying dynamics thus are not suitable to represent time varying dynamics to represent current status of system dynamics the newly received samples should be processed online for identifying current system dynamics to adapt to the changes of system dynamics the network model should be variable in both parameters and structure the sequential learning strategies are oriented to construct and tune network adaptively and have gained much research popularity in the last decades suresh et al 2010 platt 1991 liang et al 2006 platt proposed resource allocation network ran sequential learning strategy platt 1991 ran was then developed and applied widely in various fields kumar et al 2017 but ran tunes network structure based on the newest single sample may cause instability of the resulted network structure to solve this problem yin et al presented gradient orthogonal model selection goms algorithm to construct a variable structure radial basis function rbf network based on sliding data window sdw yin et al 2013b 2017 to represent time varying system dynamics the sdw scheme has been employed as system status observer in control akpan and hassapis 2011 and information processing li et al 2013 applications by learning real time updated samples in sdw the neural network can be tuned according to the time varying system dynamics represented by the data in the sdw the ship s motion is inevitably influenced by environmental factors such as winds waves and currents its dynamics can be more complex with the incorporation of factors of the draft trim thrust etc various factors effects with different characteristics are entangled together which increases the difficulties for representing the overall dynamics among various advanced signal processing and data mining methods kim and park 2015 wavelet transform has become a useful tool for analyzing variations and trends of time series in the last decade wilson 2017 mallat 2008 in the ship motion analysis applications yu et al explored wavelet transforms to investigate the nonlinear dynamical characteristics of ship roll and coupled heave roll motion in waves yu et al 2006 du et al applied daubechies wavelet function to analyze measured ship model data du et al 2008 hariharan et al applied an efficient shifted second kind chebyshev wavelet method s2kcwm to ship vibrating dynamical models hariharan et al 2016 sathyaseelan et al introduced an efficient legendre wavelet spectral method lwsm to identify ship roll motion sathyaseelan et al 2017 hariharan and sathiyaseelan employed two wavelet methods for the numerical solutions of the transient free surface ship model hariharan and sathiyaseelan 2017 wavelet analysis is a multi resolution analysis method in both time and frequency domain thus the original signal can be decomposed into different resolution sub signals using the discrete wavelet transform dwt method the dtw can be used to reduce the redundancy of the data and convey the information in few uncoupled components chou and wang 2004 napoli et al 2010 the intrinsic features of subseries could be shown more obvious than that of the original series which facilitates the analysis identification and prediction of the complex time series the decomposed time series can represent the changes of the ship motion dynamics but the underlying hydrodynamic and kinematics characteristics of decomposed time series are still unknown because the variable ann can identify and generalize the time varying nonlinearity information adaptively the combination of dwt and ann takes advantage of the two methods and is suitable to represent and predict complex time varying nonlinear system like ship roll movement the combination of dwt and ann has been widely used in time varying time series analysis and prediction approach in recent years kumar et al decompose the eeg signals to approximation and detail coefficients by dwt and process the coefficients by a feed forward back propagation neural network kumar et al 2014 wei et al utilized discrete wavelet multi resolution method to decompose the time series into sub series which were used as inputs of the artificial neural network ann to generate river discharge predictions wei et al 2012 deka employed the decomposed sub signals as inputs of the ann to forecast the significant sea height at different multistep lead time deka and prahlada 2012 chen constructed a hybrid model for tide prediction by combining the ann with wavelet multi resolution analysis mra method chen et al 2007 in deshmukh s study the decomposed sub signals are provided as inputs to the neural network instead of the raw signal time series for forecasting ocean waves deshmukh et al 2016 the wavelet decomposition method and variable rbf network are implemented in ship roll motion prediction to validate the effectiveness of the ensemble prediction model in this paper aiming at the time varying and nonlinear natures of ship motion dynamics an ensemble model is established for real time short term ship roll motion prediction by combining the variable rbf network and dwt multi resolution decomposition the ship roll motion time series is decomposed and the decomposed sub series are predicted individually by variable rbf network the variable rbf network is used to represent time varying dynamics by tuning its structure and parameters in real time individual predictions of subseries are reconstructed to obtain the final prediction result to validate the feasibility and effectiveness the proposed prediction model was applied to real time ship roll prediction experiment by using measured data of zigzag test in a full scale sea trial of m v yukun the remainder of this paper is organized as follows the dwt decomposition and the variable rbf network are presented in section 2 the structure of the function and the dwt based variable rbf network is presented in section 3 in section 4 the real time ship roll motion prediction simulations using dwt based variable rbf network are conducted and the performance is discussed conclusions are finally derived in section 5 2 ensemble ship roll motion prediction the prediction scheme is established by combining the discrete wavelet transformation method and a variable rbf network constructed by goms algorithm which would be described as follows respectively 2 1 discrete wavelet transformation the time series of time roll motion contains useful information concerning the influences of environmental factors and other unmodeled factors but the influences of different factors are tangled together thus making the time series hard to represent and predict precisely wavelet transformation is a signal processing tool which is capable of analyzing both stationary and nonstationary information and to generate both time and frequency information in a higher resolution which is not available from the traditional transformation like fourier transform mallat 2008 the wavelet transform decomposes the original signal into wavelets which are scaled and shifted versions of the mother wavelet the discrete wavelet transform dwt method decompose the original signal into a limited number of components can be assembled back into the original signal without loss of information this processing of signal facilitates the applications such as using the sub signals as the inputs to ann or processing the sub signals individually in multi resolution signal decomposition of dwt approach signals are analyzed at different scales using filters with different limit frequencies original signal x t is passed through a series of high and low pass filters and down sampled to approximation coefficients a k and detail coefficients d 1 d 2 d k respectively logarithmic uniform spacing mallat 2008 allows the completely orthogonal wavelet basis to be constructed it uses n transform coefficients to fully describe a signal with the length of n with zero redundancy these discrete wavelets are not specified continuously on time axis but at discrete locations the resulting discrete wavelet transform dwt can be translated and dilated in discrete time steps for original signal x t the discrete wavelets can be expressed as 1 ψ m n t τ s 1 s 0 m ψ t n τ 0 s 0 m s 0 m where m and n are integers that control the wavelet dilation and shift respectively s is the scale and τ is the location parameter greater than zero s 0 m is a fixed dilation step greater than 1 from eq 1 it is noticed that the translation steps n τ 0 s 0 m depend upon the dilation s 0 m the discrete wavelet transform using mallat algorithm is adopted for time series decomposition and reconstruction mallat 2008 2 2 variable rbf neural network as environmental influencing factors to ship motion such as winds and waves usually change rapidly over time custom static neural networks with fixed network structure cannot represent time varying dynamics efficiently even for the decomposed sub signals so there is a practical need for a variable network whose structure and parameters are both adjusted in real time construction of a variable structure neural network by sequential learning is a research focus in recent years suresh et al 2010 sequential learning algorithms have been used to represent time varying system dynamics with the variable neural network platt 1991 liang et al 2006 yin et al 2013b it handles samples sequentially and tunes the network s structure and parameters adaptively among various types of networks radial basis function rbf network is the most popular network in sequential learning due to their local response character simple topology fast convergence speed and no local minima haykin 1999 therefore in this study the f is modeled by a variable structure rbf network which is constructed by a sequential learning goms algorithm yin et al 2013b which is described as follows the adjustment of the network structure involves both network growing and network pruning at each step in the growing stage the latest sample is added as a new hidden unit directly while in the pruning stage units with little contributions are pruned from the network hidden layer once the units are determined at each step the connecting weight between the hidden and output layers would be adjusted accordingly in this sequential learning scheme a sliding data window sdw is employed to represent time varying dynamics and algorithm learns samples in the window sequentially yin et al 2013b the sdw is a first in first out fifo sequence expressed as follows 2 w sd x t y t x t 1 y t 1 x t n 1 y t n 1 where n denotes the width of sliding window x and y denote the input and output vectors the window includes the input matrix x x t x t n 1 ℜ n n and the output matrix y y t y t n 1 t ℜ m n with n and m being the dimensions of input and output respectively therefore the real time updated window in real time can be utilized to represent current system dynamics in this study the single hidden layer is adopted in the rbf network and the j th output can be expressed as follows 3 y j k 1 m θ k ϕ k x c k k 1 m θ k exp x c k 2 2 σ k 2 where ϕ i is the activation function of k th hidden unit with the gaussian function being selected in this study c k is the k th hidden unit center denotes the euclidean distance operator σ is the scale parameter of k th hidden unit j is the index of outputs m is the number of hidden units θ k is the connecting weight between the k th hidden unit and the j th output the total input output mapping of rbf network can be represented in matrix form 4 y φ θ the response matrix is orthogonalized using the gram schmidt method chen et al 1991 to evaluate the contribution of individual hidden unit 5 φ w a where w is the orthogonalized response matrix whose individuals are mutually orthogonal and a is an upper triangular matrix then the contribution of the k th hidden unit to the output is evaluated according to its corresponding error reduction ratio err 6 e r r k w k t y w k t w k y t y where w k is the k th vector of the orthogonalized response matrix w the value of err is the projection of each hidden unit in the space spanned by w which is used to evaluate the contribution of each hidden unit to the output for multi in multi output mimo process chen et al 1992 err is calculated by 7 e r r k j j 1 m w k t y j 2 w k t w k trace y t y where j denotes the index of outputs however the matrices of φ ℜ n m and w ℜ n m are not square when m the number of hidden units is not equal to n the sliding window width therefore the summation of err is not equal to 1 and cause it impossible to evaluate the contribution of an individual hidden unit by err directly to utilize err in this sdw based sequential learning scheme an index of normalized error reduction ratio nerr is employed to measure the contribution of each hidden unit yin et al 2013b 8 n e r r k e r r k k 1 m e r r k therefore the summation of nerr becomes 1 thus the contribution of an individual hidden unit can be evaluated by means of nerr at each step the nerr of individual hidden unit is calculated and units with small values of nerr are selected the selection process would be terminated once the summation of nerr reaches a preset accuracy threshold ρ 9 i 1 p 1 n e r r i ρ where p is the number of selected hidden units it is noted that the summed value of nerr corresponding to the selected p units is less than ρ if certain units are selected for l consecutive steps they would be regarded as obsolete and pruned from the network this procedure is taken to assure the stability of the rbf network by deleting the units which are inactive consecutively at each step after the hidden units are adjusted by adding and pruning connecting weights θ can be updated using the pseudo inverse method 10 θ φ y φ t φ 1 φ t y by adjusting the network dimension it can also alleviate the phenomenon of over fitting and under fitting thus guarantee generalization capability as well as the processing speed 3 real time ship roll motion prediction mechanism 3 1 dwt based neural network prediction scheme configuration the prediction of ship roll motion presents challenges because ship roll dynamics exhibited in the original time series are difficult to detect ship roll dynamics are often obscured by the holistic trend or fluctuations of the time series effects of various influential factors such as winds and waves exhibit different frequencies and features in the time series which increase the difficulties for identification and prediction in this study to overcome this problem the original ship roll time series is separated into multiple resolutions at different frequencies by dwt thus the signals at multiple resolutions for different frequencies can be analyzed separately which enables us to catch the characteristics in the subseries precisely in order to generate precise forecasts for ship roll motion the original ship roll time series is decomposed into frequency related subseries and the individual subseries are identified and predicted separately then the prediction is achieved by reconstructing the forecasts from every subseries in this study the dwt based variable rbf network is proposed which combines the advantages of wavelet decomposition and variable rbf network the wavelet decomposition is used to reduce data redundancies and to obtain representation of raw time series with a few significant uncoupled coefficients and generate effective long term predictions napoli et al 2010 even the series is decomposed into sub signals with different frequencies they also possess nonlinearities in nature therefore neural networks are employed to represent the nonlinearities in subseries the custom static neural networks cannot represent the complex influence of time varying meteorological factors however the variable rbf network enables the adaptability and nonlinear representation capability of the model the dwt is used to reduce the time series data redundancies and carry the data information in few significant uncoupled sub series thus facilitate the identification and prediction by using the variable rbf networks the prediction is processed in two stages the identification stage and prediction stage on the identification stage the ship roll angle time series is decomposed to several subseries for further identification performed by the variable rbf network which is online constructed by the goms algorithm while on the prediction stage the tuned rbf networks are implemented for prediction of sub series and the results are finally combined to generate the ship roll prediction the ship roll angle time series which incorporates the influences of environmental and other unmodeled factors can be expressed by relatively simple subseries for each subseries the identification is performed by the variable rbf network to represent their individual dynamics that is the variable rbf network is tuned to represent the dynamics of individual sub series the configuration of the learning process is illustrated in fig 1 in this sequential processing mode the prediction stage is conducted once the identification stage is completed with both stages being conducted at each step consecutively in the prediction process the overall output is subsequently achieved by summing the prediction results of the individual sub series the configuration of the prediction process is illustrated in fig 2 3 2 variable radial basis function network structure in this study the original ship roll motion time series r is decomposed into multi level subseries prior to the prediction procedure the resulting relatively simple subseries are represented and predicted by individual variable rbf network the prediction results are then summed together to achieve the final prediction for k level decomposition the resulted subseries are denoted as a k d 1 d k respectively here we take a k for example to illustrate the prediction model ship roll motion time series contains much useful information and the time series prediction is employed in this study the time series prediction can be represented by the nonlinear autoregressive with exogenous input narx prediction model take 1 step ahead prediction of subseries a k for example the identification model at time t is expressed as 11 a k t f 1 a k t 1 a k t 2 a k t p ε 1 t therefore prediction of a k t 1 can be achieved by using the samples which are currently available 12 a ˆ k t 1 f 1 a k t a k t 1 a k t p 1 generally for q step ahead prediction of subseries ak the identification model is 13 a k t g 1 a k t q a k t q 1 a k t q p 1 ε t narx model for q step ahead prediction can be obtained by replacing t in 15 with t q 14 a ˆ k t q g 1 a k t a k t 1 a k t p 1 the lag p is set as 7 in this study as a result the topology structure of the variable rbf network model is i7h x o1 where i7 denotes 7 input units o1 denotes single output and h x denotes the x hidden units with value of x being on line adjusted by the goms algorithm 4 real time ship roll prediction simulation 4 1 prediction simulation settings experiments of online ship roll prediction were conducted to verify the efficiency of the online neural prediction strategy based on multi resolution decomposition the future ship roll angle is estimated by variable rbf network based on dwt decomposition the rbf network is adjusted based on the learning of samples in the sliding data window in this study experiments are conducted under matlab 7 9 environment and run at 2 40 ghz cpu and 3 57 gb memory ram the data used in this study are measured from the sea test of m v yukun a scientific research and training ship of dalian maritime university as displayed in fig 3 the main particulars of motor vessel yukun are shown in table 1 the ship motion status is achieved by using ashtec adu2 which is a ship motion measurement device which can measure the ship motion status during the ship maneuvering in the sea the prediction process would be conducted once the network is online established in the learning process at each step ship s zigzag test is a conventional manoeuvre test used to evaluate the ship manoeuvrability to validate the efficiency of the proposed predictive approach the experimental data of 20 20 full scale zigzag test of yukun from sea trial is adopted to validate the adaptability of the proposed method the voyages before and after the zigzag test is also included the initial speed of the ship in the zigzag test is set at 14 7 kn the sea trial was performed in the bohai sea area on aug 8 2009 and the sea state is 4 ship motion trajectory during the zigzag test is shown in fig 4 it is noted that there are two straight line sailing segments before and after the zigzag test and their ship motion dynamics are quite different from the zigzag motion dynamics therefore the ship roll motions of straight line sailing segments are also included in the experiment to evaluate the adaptability of the proposed prediction method the changes of ship roll angles during the test are depicted in fig 5 the wavelet decomposition is employed with decomposition level being selected as 4 and the wavelet type selected as db5 the decomposed approximation and details of ship roll motion time series are shown in fig 6 4 2 ship roll motion prediction simulation results the identification and prediction performances of the model are evaluated by an index of root mean square error rmse noted as prediction rmse rmse pre 15 r m s e pre i 1 n y pre t q y t q 2 n where y pre t q and y t q are the predicted and actual values of ship roll angles at time t q respectively the 60s ahead ship roll motion prediction experiment was conducted to illustrate the performance of the proposed dwt based neural prediction scheme in this experiment the parameters for goms algorithm are selected as n 3 ρ 0 2 l 3 respectively the variable rbf networks are individually tuned using the decomposed components in each step after identification procedure is completed the tuned rbf networks would be used to predict individual decomposed components the predicted components would be summed together to obtain the prediction of ship roll angle the final ship roll motion prediction is then achieved by combining the prediction results of decomposed components by using variable rbf network the 60 s ahead ship roll prediction results are depicted in fig 7 together with the actually measured ship roll angles it is shown that the dwt based variable neural network predictive model can detect and represent time varying dynamics in decomposed time series components except for component of d1 this can be attributed to the multi stage decomposition of the ship roll angle time series which decomposes the original complex time series into components which are much easier to be predicted the big error in predicting sub series of d1 is because that the sub signal with high frequency is random to a large extent thus is hard to predict the individual prediction errors of the one approximation and four details components are illustrated in fig 8 it is shown in fig 8 that the prediction error of a4 fluctuates within a small range and the prediction errors of details of d2 d3 and d4 fluctuate within a relatively small range while the prediction error of d1 varies within a relatively large range these differences can be attributed to the fact that the change of approximation a4 is smooth thus is relatively easy to be predicted while the detail components which change fast would lead to larger prediction errors it is also noticed in fig 8 that there are no sustained deviations between the predicted ship roll angles and measured ones the root mean square prediction errors of a4 d1 d2 d3 and d4 are 0 0417 0 4732 0 3380 0 2244 and 0 0501 respectively during the simulation the rbf network structure is variable with hidden units being added or pruned adaptively to represent the time varying dynamic changes of ship roll motion it is noticed that the number of hidden units is variable it ranges from 4 to 10 during the identification process for approximation component a4 and the corresponding average hidden units number hun during simulation is 5 7660 the average huns for the details d1 d2 d3 and d4 are 8 3260 11 8920 8 0920 and 6 5080 respectively the ahnn evolution history of different wavelet components is depicted in fig 9 respectively the maximum values minimum values and standard deviations of the hidden units corresponding to predictions of different components are shown in table 2 respectively as the hidden units increase from 1 the minimum number of hidden units is 1 for all the components however after the 10 th step the minimum hidden units numbers for a4 d1 d2 d3 and d4 become 5 5 8 5 and 5 respectively the tuning mechanism for hidden units enables there are enough hidden units to approximate the input output mapping this enables the prediction accuracy as well as the stability of the algorithm there are several detailed components and approximation component which are identified and predicted respectively the choice of the components which compose the final prediction also has an influence on the representation ability of the proposed prediction scheme approximation component a4 indicates the changing tendency of the ship roll and should be reserved the detailed components d2 d3 and d4 convey the low frequencies signals and some high frequencies signals and the corresponding prediction results are included in the final results the detailed component d1 possesses the highest variation frequency comparing to other decomposed components as detailed component d1 has higher frequency comparing with other components so it is more prone to be contaminated by random measurement noises which would lead to large prediction errors in this study the experimental data is measured by ashtech adu2 and the measurement variance is 0 4 which is high comparing to the amplitude of the ship roll angles so the prediction of these strong random measurement noises would bring extra deviation from actual values in this study therefore in this study the component of d1 is discarded in the ship roll prediction scheme the prediction result by combining the predicted values of components of a4 d2 d3 and d4 is shown in fig 10 the rmse of the prediction error by using components of a4 d2 d3 and d4 is 0 4882 and the correlation coefficient between the actual ship roll angles and the predicted ones is 0 9637 for comparison purpose the prediction result by combining the predicted values of components of a4 d1 d2 d3 and d4 is shown in fig 11 the rmse of the prediction error by using all the components of a4 d1 d2 d3 and d4 is 0 6126 which is 25 5 higher than that obtained by neglecting the prediction result of d1 and the correlation coefficient between the actual ship roll angles and the predicted ones is 0 9428 as detail component d1 contains measuring noises which are hard to estimate precisely would bring extra prediction errors when incorporating the estimation of d1 in the prediction mechanism for comparison purpose other combinations of components are tested in conditions including the component of a4 the prediction error is relatively small with prediction rmse of 0 5500 by using a4 d3 and d4 and with prediction rmse of 0 8159 by using a4 and d4 in conditions without a4 the prediction error is quite large comparing those with a4 the results are presented in table 3 to further validate the prediction mechanism the experimental data of yukun s 10 turning circle test is adopted to perform 60s ahead ship roll motion prediction experiment the sea trial was performed in the bohai sea area on aug 8 2009 under sea state of 5 and the turning circle test was performed at initial speed of 16 kn altogether 500 steps of prediction are conducted and the parameters of the prediction scheme is the same as that of the ship roll prediction simulation based on the measurements of zigzag test different combinations of components are tested and the results are also compared in table 3 it can be noted in table 3 that the discard of d1 increases the prediction accuracy in this online ship roll motion prediction study validated the feasibility of the proposed ship roll prediction mechanism however the application of this kind of component selection is under specific circumstances that is the measurements noises signal is strong and the estimation of these signal may degrade the prediction accuracy furthermore the small number of hidden units in the variable rbf network may also deteriorate its anti noise ability comparing with conventional neural networks which will lead to large prediction errors for signals with strong measurement noises therefore it should be noted that the selection of components in this study is valid due to some random effects like the strong measurement noises by using adu2 and the prediction scheme based on variable rbf network it may not valid under other databases or other prediction schemes as stated above at each step the prediction would be conducted once the identification is finished during the identification process the ship roll motion time series is decomposed identified and predicted by variable rbf networks in this study sequential learning rbf network only employs a small number of hidden units which enables its high processing speed of the hybrid prediction model the overall consumed cpu time for 500 steps of processing is 9 70s the average time for each step including identification and prediction process is only 0 019s the fast computational speed facilitates its practical applications to demonstrate the advantage of wavelet decomposition process conventional variable rbf network was also implemented for 60 s ahead prediction using the same ship roll motion database for comparison purpose the parameters for constructing conventional variable rbf network are selected as n 5 ρ 0 0001 l 2 the resulting rmse pre is 1 2701 and the correlation coefficient between the actual ship roll angles and the predicted ones is 0 7758 which exhibits lower accuracy comparing to the dwt based ensemble prediction scheme the decomposed components of ship roll angles time series are simpler to be predicted which lead to the higher prediction accuracy the average hidden units number is 5 5475 the running time of 500 steps of simulation is 1 71s and the average running time for each step is 0 003s the faster processing speed using conventional variable rbf network is caused by the exemption of processing various decomposed wavelet components to validate the prediction accuracy for longer time horizon simulations are conducted based on the same measurement data in the simulation same parameters are employed for constructing variable rbf network by using goms algorithm and the results are compared in table 4 the cc denotes the correlation coefficient between the predicted values and the measured ones it is noticed in table 4 that the proposed dwt based ensemble prediction method can give stable predictions for ship roll predictions with higher prediction accuracy than that without dwt composition this can be attributed to that the decomposed subseries are easier to be represented than original ship roll time series the prediction accuracy fluctuates slightly with the extension of the prediction horizon which shows that the individual decomposed sub signal shows similar dynamics and facilitates the representation and prediction it also demonstrates that the ship roll motion dynamics vary slightly during the ship sea test it can also be noticed that the dwt based neural prediction scheme consumes more time than that without dwt decomposition this is because the dwt based prediction scheme would conduct identification and prediction processes for each wavelet components so that the processing time is also increased consequently however because there are only small number of hidden units the processing speed is rather fast the high processing speed of the variable rbfn based prediction schemes can also be ascribed to that it only processes the samples in the sliding data window to make comparison with other prediction approaches some conventional prediction approaches are also implemented to perform ship roll prediction simulation by using the same measurement data these employed approaches include the back propagation bp networks the os elm model liang et al 2006 and the custom autoregressive ar model respectively in the implementation of bp network the levenberg marquardt method is employed for bp learning and the hidden layer number is selected as 3 the os elm model is featured by its extremely quick processing speed and satisfactory generalization capability in implementing os elm the number of hidden units is set as 30 and the initial number of training samples is set as 20 as a conventional prediction method the linear ar model is also employed for comparison the comparison results using methods of bp neural network os elm and custom ar approach are shown in table 5 the rmsepre index represents the root mean square errors of prediction it is shown from the simulation results that the nonlinear methods like bp network os elm goms and dwt based goms possess higher prediction accuracy than linear ar prediction method but the processing speed of bp network is slow because of its iterative training process the os elm method has the fastest processing speed attributing to its random selection scheme but its prediction error is larger than that by using the approaches of goms and dwt based goms custom linear ar method has relatively fast processing speed but it is difficult to represent and predict the nonlinear ship motion using linear method the results also demonstrate the effectiveness of the presented dwt based goms algorithm 5 conclusion a dwt based variable neural prediction scheme is proposed by making use of both the wavelet decomposition method and the variable rbf network decomposition of the ship roll motion information by multi level wavelet decomposition facilitates the identification and prediction of variable rbf network simulation results of real time ship roll motion prediction demonstrate that the proposed method generates precise predictions with high processing speed which demonstrates the feasibility and effectiveness of the ship motion prediction method to adapt to the diversity of the ship sailing conditions and to extend the prediction horizon the self adaptation of scheme parameters and the inclusion of more a priori knowledge of ship motion in the prediction scheme will be our future research efforts acknowledgements the authors would like to thank the editors and anonymous reviewers for their valuable comments and constructive suggestions that led to a substantially improved paper this work is supported by the national natural science foundation of p r china under grants 51009017 and 51379002 the fund for dalian distinguished young scholars under grant 2016rj10 the innovation support plan for dalian high level talents under grant 2015r065 and the fundamental research funds for the central universities under grants 3132016314 and 3132016322 
