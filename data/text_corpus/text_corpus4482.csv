index,text
22410,automatic ship docking is one of the applications of autonomous ships how to realize autonomous low speed maneuver under environmental disturbances for docking is the fundamental problem at present this paper presents an efficient approach based on artificial neural network ann for automatic ship docking the problem is formulated and well modeled for simulating ship docking operation a joystick implementation in simulation provides manual maneuvering and thus enables collection of sufficient and reliable data from successful maneuvers to keep consistent with the manual control an ann with two parallel structure is proposed to control the ship s thrust and rudder respectively feature selection technique and genetic algorithm ga are utilized to optimize the structure and reduce the training cost numerical simulations under different environmental disturbances including no wind constant wind and dynamic wind are carried out the results show the ship is able to reach the dock smoothly which confirms the effectiveness of the proposed approach keywords autonomous ship ship docking feature selection neural network genetic algorithm 1 introduction digitization is a major agenda in the development strategy of the european shipbuilding industry which promotes technological innovation and economic growth this agenda points out that the first task is to achieve ship autopilot characterized by strong adaptability to sea conditions low energy consumption and high safety performance automatic ship docking is considered an essential application of ship autopilot ship docking is a challenging maneuvering task for captains during the docking process the captain needs to know the ship s current state and estimates its future state based on the maneuverability of the ship the ship is suggested to be sailed at low speed to avoid collision with the dock and other vessels but low speed will sharply reduce the ship s maneuverability and increase control complexity to address the above challenges attempts have been made to design advanced controllers using knowledge of nonlinear control theory katayama and aoki 2014 li et al 2016 mizuno et al 2016 and fuzzy theory yingjie et al 2019 tran et al 2017 however it is hard to construct nonlinear mathematical models and define fuzzy rules for ship docking since any unpredictable situations including weather influences and other vessels disturbances may arise in such a case an ann based approach with the ability to learn the underlying nature from maneuvering data provides a potential solution for automatic ship docking in principle the robustness of this approach depends not only on the ann s structure but also on the training data the training data can be either from real ship docking operation or from reliable simulation the former has high reliability but is difficult to be collected under different environmental disturbances the latter is most frequently used because of its high efficiency and as long as the fidelity of modeling ship docking operation is good enough the reliability of the training data is guaranteed in this paper we propose a new ann based approach to achieve automatic ship docking under different environmental disturbances the main contributions of this paper can be summarized as follows 1 a ship docking simulation module with complete ship environment models is established for generating reliable docking data 2 the feature selection technique is applied to provide optimal inputs for the ann 3 the ann based approach with two parallel structure optimized by genetic algorithm is verified to be able to dock the ship under different environmental disturbances the present paper is organized as follow section 2 is a brief overview of related work in section 3 a ship docking simulation module including ship mathematical model and wind disturbance model is established in section 4 the proposed ann based approach from data collection feature selection to ann construction and optimization is introduced in detail section 5 presents the docking results of the approach under different environmental disturbances conclusions and future work are given in section 6 2 related work the first automatic ship berthing system based on ann was demonstrated in the 1990 s by yamato 1990 later zhang et al developed an automatic ship berthing system using a multivariate neural network based controller zhang et al 1997 the pre planned birthing path was determined as the input of the controller however the authors did not introduce how to set the berthing path in 2001 im and hasegawa proposed a parallel neural network based controller to control ship thrust rpm and rudder im and hasegawa 2001 the experimental results demonstrated the proposed parallel neural network based controller could eliminate the effects of slight wind and current but failed to manipulate the ship to the destination in harsh environment to address this challenge a motion recognition method was utilized to cope with environmental impacts im et al 2002 the method succeeded to compensate the crosswind disturbance but still failed when the wind comes from the direction of the bow nguyen and jung explored the adaptive neural networks to achieve automatic ship berthing nguyen and jung 2007 recently zhang et al proposed a robust adaptive neural network approach based on the navigation dynamic deep rooted information to reconstruct the lumped uncertainties caused by unknown ship dynamics and external disturbances zhang et al 2019 the above researches focused more on the structure design of the ann controller whilst none of them tried to generate training data with different constraints by using an algorithm to improve the applicability of the ann controller in fact there have been attempts in training data generation in 2007 ohtsu et al proposed a new solution using nonlinear programming method to generate minimum time ship maneuvering data mizuno et al 2007 hasegawa et al first attempted to use a nonlinear programming language npl to generate ship berthing data with restricted conditions xu and hasegawa 2012 ahmed and hasegawa followed the research and first proposed the concept of virtual windows which is used to ensure the consistency of training data ahmed and hasegawa 2012 ahmed et al 2013 ahmed and hasegawa 2014 2015 the npl method allows the user to define non equal constraints by setting rudder angle as the optimal variable and the time as an objective function however excessive restrictions are defined as termination conditions in these researches when using the npl method which causes fluctuation of rudder angle commands nonlinear model prediction algorithm is another solution for optimal berthing data generation but requires higher computational resources to obtain the optimal maneuver path mizuno et al 2003 however taking advantages of graphics processing unit the method can be executed in parallel which makes real time optimal control feasible mizuno et al 2012 for example mizuno et al proposed a quasi real time optimal control system composed of a multiple shooting algorithm for docking data generation and a nonlinear model predictive controller for path following under wind disturbance mizuno et al 2015 there are also researches that directly use real ship docking data obtained by experienced captains who successfully maneuver the ship into the berth to train neural network based controllers im and nguyen 2018 nguyen et al 2018 but the method is not applicable to general docking operation as it is difficult to collect large number of real ship docking data under different cases of environmental disturbances for training to achieve the generality of ann based docking in different environment disturbances we propose a new automatic ship docking strategy that employs a ship docking simulation platform to generate reliable docking data and an ann based approach with optimized parallel structure to maneuver ships into the dock 3 docking problem statement and simulation model 3 1 docking problem statement slow speed planning on board sensing equipment and control approach play key roles in ship docking kose et al proposed two requirements to ensure ship safety according to the maneuvering procedures followed by the captain in the actual docking of ships kose et al 1986 the first one is that the destination for docking should be at some distance away the dock instead of completely at the dock the second one is that the captain has enough time to plan a good maneuver in any critical situation to meet these two requirements the whole process can be divided into two phases as shown in fig 1 the first is the ballistic phase it utilizes the main thrusters and rudder for course changing speed adjustment and stopping the second phase is to use tunnel thrusters to achieve side push in this paper we focus on the first phase of the docking operation it is assumed that the ship starts from a stationary state and maneuvers towards the port in low speed the ship will dock in parallel to the port with zero velocities when it arrives at the destination moreover three different sea conditions including no wind constant wind and dynamic wind are considered for the docking problem in fig 1 n x n y n is the north east coordinate system and its coordinate values can be obtained from the global positioning system gps d x o y o is called the north up coordinate system which includes the heading angle and distance from ship to dock nguyen et al 2018 in this paper all simulations are performed in the north up coordinate system the merit of using the north up coordinate system is to control the ship into other different docks without retraining the controller b x b y b represents the body coordinate system the notation for the marine vessel in fig 1 is shown in table 1 3 2 ship mathematical model the study of ship dynamics consists of two parts kinematics which overcomes geometrical problems of motion and kinetics which analyzes the relationship between force and motion ship movement is expressed in six degrees of freedom dof which includes surge sway heave roll pitch and yaw fossen 2011 for a surface ship as shown in fig 1 it is only necessary to study the motion in three dof namely the surge sway and yaw in this study the maneuver model group mmg is used to describe ship motion in which the hydrodynamic forces and moments acting on the ship are divided into modular components such as hull rudder and propeller the following is an mmg based mathematical model considering wind influence committee et al 2002 1 m m x u m m y v r x h x p x r x w m m y v m m x u r y h y p y r y w i z z j z z ṙ n h n p n r n w where m is the ship mass m x m y are the added mass in surge sway direction i z z is the mass moment of inertia j z z is the added mass moment of inertia x y and n denote surge force sway force and yaw moment h p r and w are the symbols that represent hull propeller rudder and wind x h y h and n h represent the hydrodynamic forces and moment acting on the ship hull which are defined as katsuro et al 1990 2 x h ρ 2 l d u 2 x β r sin β x u u cos 2 β r l u y h ρ 2 l d u 2 y β y r r l u y β β β β y r r r l u r l u y β β r β 2 r l u y β r r β β r l u 2 n h ρ 2 l d u 2 n β n r r l u n β β β β n r r r l u r l u n β β r β 2 r l u n β r r β β r l u 2 where ρ is the water density l denotes the length over all of ship d is the draught of ship u represents the speed of ship the hydrodynamic coefficients x β r x u u n β r r can be estimated with the method described in katsuro et al 1990 the propeller mainly produces longitudinal force and its lateral force is negligible thus propeller hydrodynamic model can be written as 3 x p 1 t p t y p 0 n p 0 where t p is a coefficient and the propeller thrust force t is defined 4 t ρ n 2 d p 4 k t where n is propeller speed rpm d p is diameter of the propeller k t is the thrust coefficient the hydrodynamic forces and moment generated by the rudder can be calculated by the following formula 5 x r 1 t r f n sin δ y r 1 a h f n cos δ n r x r a h x h f n cos δ where t r a h are coefficients x r and x h are the distances from the rudder and the propeller to the ship s center of gravity respectively f n is the rudder pressure δ denotes the rudder angle as a result the control inputs of the mmg model are the propeller speed n and rudder angle δ the ship velocities u v and r represented as the state variables in eq 1 are the control outputs of the model 3 3 wind force model the wind has a significant effect on the ship which will affect heading and sway movement failure to compensate correctly for wind during docking is one of the main factor of docking accidents here the wind forces and moments acting on the ship are estimated as fujiwara et al 1998 6 x w 1 2 c x ρ a v r 2 a f y w 1 2 c y ρ a v r 2 a l n w 1 2 c n ρ a v r 2 a l l the physical meaning of each symbol in eq 6 is shown in table 2 4 proposed approach fig 2 schematically depicts the ann based ship docking control strategy for ship docking under environmental disturbances first the ship docking simulation module is constructed it consists of a ship model and environmental disturbance models which is fundamental to both manual control and ann based control based on that training data set can be generated as indicated by the blue arrow the data set is the collection of ship maneuvering data from the simulation the data is pre processed through feature selection to find optimal input parameters for ann construction and further normalized before the training of the ann the green arrow illustrates the implementation of the ann based approach the ann is optimized by a genetic algorithm and trained using the data set as a result the trained ann model can be applied to steer the ship to dock under external disturbances 4 1 data generation in this research training data is created through manual controller i e by a skilled captain using a joystick to control ship s rudder and thrust the usage of the joystick is shown in fig 3 button 4 is used to enable the control of thruster speed only when it is pressed can button 1 be used to adjust thruster speed within the range of 130 130 r p m similarly button 5 enables the use of rudder control and handle 2 can adjust rudder angle between 45 and 45 only if button 5 is pressed button 3 is the stop key when the ship arrives at the dock safely the captain can press the button to stop the maneuver 4 2 data pre processing the data pre processing mainly contains two parts feature selection and data normalization the purpose of feature selection is to choose an optimal subset from the training data for ship control in this paper a step wise feature selection method is developed first those constant variables would be deleted in addition to remove the redundant information between input parameters pearson correlation analysis bolboaca and jäntschi 2006 is applied then ann based variance based sensitivity analysis is used for identifying the importance of each feature cheng et al 2019 assume any two input parameters x and y the pearson correlation of these two parameters can be defined as follows 7 ρ x y σ x y 2 σ x 2 σ y 2 where σ x is the standard deviation of x σ x 2 is the variance of x σ y is the standard deviation of y σ y 2 is the variance of y σ x y 2 is the co variance of the variables x and y the pearson coefficient can be used to detect the dependency of two input parameters in this paper one of the two parameters would be removed if the pearson coefficient of the two parameters is large if the model form is f x f x 1 x m where x x 1 x m represents the model input which contains m independent parameters based on the theory of sobol saltelli and sobol 1995 the variance based sensitivity index can be described as the ratio of partial variance and total variance the influence of the i th variable x i to the output can be defined by 8 s t i 1 v i v where s t i is the influence of input parameter to output v stands for the total variance and v i represents the influence excluding the i th variable if the s t i is close to zero the parameter can be considered to be non important in addition it is necessary to normalize all parameters to speed up the training convergence and improve accuracy of the ann model all the parameters would be normalized 9 x ˆ x e x v a r x ϵ where e x represents the mean of x v a r x stands for the variance of x ϵ is a positive infinitesimal to make the calculation possible when x is a constant ϵ is set to 10 6 in this paper 4 3 ann based controller since the automatic ship docking system is a multi input and multi output system it is important to design a neural network that can learn the underlying nature relationship between inputs and outputs autonomously an ann based controller with two independent parallel structure is designed the inputs of the ann are the parameters selected from data analysis and the outputs are the ship s propeller speed and rudder angle the construction of the two parallel multi layer ann is demonstrated in fig 4 the ann is a multilayer feedforward network that can be trained by error backpropagation the principle of the training algorithm is the gradient descent method that is used to minimize the mean square error mse between the actual output value of the network and the desired output value assume the neural network in fig 4 consists of an input layer m hidden layers and an output layer the output of each hidden layer can be written as 10 h i f w i 1 i h i 1 b i i 1 2 m where h 0 i m w i i 1 is the weight between the hidden layers b i is the offset of the hidden layer and f is activation functions here we choose the tansig function as the activation function and its mathematical expression is expressed as 11 f x 2 1 e x p 2 x 1 similarly the output layer of ann uses linear function and its formula is expressed as following form 12 o c p u r e l i n w n c h n b c where w n c is the weight between the last hidden layer and output layer b c is the offset and h n is the input of the output layer the performance of the trained network is determined by calculating the value of the mse suppose there are k samples in the training data x 1 y 1 x 2 y 2 x k y k where x k y k represent the inputs and outputs of the samples the objective function of the network training is written as 13 m s e 1 k i 1 k y i o c 2 where y i can be either rudder angle or propeller speed the levenberg marquardt algorithm is used to minimize the mse the weights of the ann are updated as follows 14 w i 1 i t w i 1 i t 1 j t w i 1 i t 1 j w i 1 i t 1 μ i 1 j t w i 1 i t 1 m s e w i 1 i t where j is jacobian matrix and i is identity matrix in this paper ga is used to optimize the ann based controller the chromosome consists of integers representing the number of hidden layers and the number of neurons in each hidden layer phan et al 2017 the fitness function is designed as the performance of ann in eq 13 through ga operation including crossover and mutation individuals with high fitness values will be selected to form a new generation the process is repeated until termination condition is satisfied as a result the ann structure is optimized to fit the training data 5 experiments this section is devoted to the validation of the proposed ann based approach first a simulated offshore vessel represented by the mmg model with parameters derived from the marine systems simulator mss perez et al 2006 is set up as shown in table 3 next a docking scenario is built up as listed in table 4 the task is to steer the vessel from the initial state to the final state under a zero velocity constraint of the respective state after that data with three different environmental conditions including no wind constant wind and dynamic wind is collected for training the ann based controller introduced in section 4 3 all experiments are conducted in a computer equipped with 2 60 ghz i7 6700k cpu and 16 gb ram 5 1 feature selection to obtain the optimal input parameters for the ann shown in fig 4 the proposed feature selection method is performed there are 16 parameters are logged in the simulated scenarios mainly including two categories state of vessel and environmental information the vessel s state includes its position and heading the speed of vessel in each dof the force of vessel in each dof and the state of thrusters environmental information includes the force of wind in each dof the wind speed and the wind direction since wind speed and wind direction are constant values they are removed for analysis thus the correlation of 12 parameters excluding two output variables i e rudder and thruster speed are used for correlation analysis as shown in fig 5 we further use a threshold ρ x y 0 84 to eliminate redundant information among parameters which results in the removal of parameters yaw speed surge force sway force yaw force wind force of surge wind force of sway and wind force of yaw an ann used for sensitivity analysis is built on the basis of the rest 5 parameters a variance based sobol method with a distribution sampled from the original data is performed on the ann cheng et al 2019 fig 6 shows the sensitivity index of the 5 parameters according to the results of sensitivity analysis three input parameters i e the relative distances x and y between the ship and the dock and heading angle are selected as the inputs of the ann the output of the ann as shown in fig 4 are the rudder angle δ and thruster speed n introduced in section 3 2 5 2 configuration of ann it is necessary to determine the structure of ann as there are no existing rules that can be used to accurately select the number of layers of the hidden layer and the number of neurons in this study the structure was determined by trial and observation of the minimum mse employing ga the search for the number of hidden layers is set as m 2 3 4 5 6 and the search for the number of neurons in each hidden layer is set as n 0 3 6 9 12 the optimized hidden number m o should meet the requirement m o m for ga each chromosome contains the above two parameters i e number of hidden layers and neurons the crossover probability and mutation probability of ga are set to 0 3 and the stopping criterion is that the number of generations reaches 50 table 5 lists the optimized hidden layers and the neuron number of each hidden layer considering a metric among mse number of neurons and training time four hidden layers with the corresponding neuron number shown in bold in table 5 are used for the experiment 5 3 verification of ann in no wind condition fig 7 illustrates some successful maneuvers without wind perturbation in dotted lines using the ann based approach note the two paths one in red representing the trajectory using the same initial heading in training data and the blue one representing a completely new initial heading different from the training data the rudder angle and thruster speed generated completely by the ann are expressed in fig 8 fig 9 illustrates the variation of the ship s surge velocity sway velocity yaw velocity and heading angle during the docking process when the ship arrives at the dock its velocities are very close to zero less than 0 01 m s and the ship s heading angle is also approximately 270 in this case the ship successfully stopped at the dock and terminal states also meet the requirements in table 4 5 4 verification of ann in constant wind condition here we test the ann based controller in different initial states under constant wind condition of v w 3 m s and β w 0 fig 10 illustrates the automatic docking trajectory starting from different initial headings the red curve and the blue curve are two successful maneuvers with the same initial states and different initial states from the training set respectively fig 11 shows the control commands used for the docking the thruster speed dramatically fluctuates between 300 and 400 s which may be caused by speed adjustment it can be seen from fig 12 that when ships arrive at the dock the surge velocity and yaw velocity are close to zero and the heading angle is also close to 270 due to the disturbance of wind the ship s sway velocity is not zero 5 5 verification of ann in dynamic wind condition the ann based controller is tested under different wind speeds fig 13 shows the results of different ship initial states the red curve represents a ship docking path starting from heading 300 which is included in training data the blue curve is a maneuver that the ship starts from a random heading it shows that the ann cannot navigate the ship to move straight when arriving at position 0 500 even though the ship is heading towards the dock the reason is that the wind is becoming stronger at the moment in the simulation wind direction is constant β w 0 and speed changes randomly from 1 5 m s to 4 5 m s per minute as demonstrated in the bottom panel of fig 14 the change of surge velocity yaw velocity and heading angle can converge to zero at last but the sway velocity fluctuates periodically with the wind disturbance as shown in fig 15 5 6 discussion the simulation results show that in no wind condition the ann controller works very well with only small fluctuations in command of rudder angle and thruster speed moreover the ship states are in full compliance with the requirements in table 4 when the ship arrives at its destination ships can also dock safely in the constant wind environment but there is a slight error in the final heading angle less than 2 and the yaw speed is not fully zero the main reason for this problem is that the ship is required to sail at low speed when it approaches the berth which greatly reduces the ship s maneuverability in the dynamic wind condition the control results of the ann are not as good as these in the previous conditions due to the randomness of the wind the rudder angle and propeller speed fluctuate drastically and the path is not smooth enough in addition the ship cannot successfully arrive the dock when it departs from initial heading angles between 5 and 23 because at these initial heading angles the ann is very sensitive to the disturbance of dynamic wind 6 conclusion this research proposes a novel way to generate reliable ship docking data and finds the optimal variables for training a new neural network by employing feature selection technique and genetic algorithm which were not considered in previous studies the conclusions of this work are summarized as follows 1 a ship docking simulation module is established which provides both manual and algorithm based interface for ship docking operation 2 feature selection is applied to eliminate redundant information between input parameters and identify their importance to ship s control parameters 3 to ensure the stability of the ann based approach the neural network structure is optimized by using ga two parallel forward neural networks with four hidden layers are established to control ship s rudder angle and the propeller speed respectively 4 numerical results show that under no wind and constant wind conditions the feasibility of the ann based approach is fully reflected while under the dynamic wind environment the performance is inferior but can still steer the ship into dock for future study the degree of sensitivity of the trained ann based controller to the initial and termination states will be investigated furthermore it is critical to improve the proposed approach to effectively compensate for dynamic wind disturbances advanced mechanisms will be set up to create versatile control strategies that meet different requirements such as minimum time maneuver lowest energy consumption and collision avoidance with dynamic obstacles acknowledgments this work was partially supported by the project digital twins for vessel life cycle service project no 280703 and partially by the project dynamic motion planning based on trajectory prediction in close range maneuvering project no 298399 in norway 
22410,automatic ship docking is one of the applications of autonomous ships how to realize autonomous low speed maneuver under environmental disturbances for docking is the fundamental problem at present this paper presents an efficient approach based on artificial neural network ann for automatic ship docking the problem is formulated and well modeled for simulating ship docking operation a joystick implementation in simulation provides manual maneuvering and thus enables collection of sufficient and reliable data from successful maneuvers to keep consistent with the manual control an ann with two parallel structure is proposed to control the ship s thrust and rudder respectively feature selection technique and genetic algorithm ga are utilized to optimize the structure and reduce the training cost numerical simulations under different environmental disturbances including no wind constant wind and dynamic wind are carried out the results show the ship is able to reach the dock smoothly which confirms the effectiveness of the proposed approach keywords autonomous ship ship docking feature selection neural network genetic algorithm 1 introduction digitization is a major agenda in the development strategy of the european shipbuilding industry which promotes technological innovation and economic growth this agenda points out that the first task is to achieve ship autopilot characterized by strong adaptability to sea conditions low energy consumption and high safety performance automatic ship docking is considered an essential application of ship autopilot ship docking is a challenging maneuvering task for captains during the docking process the captain needs to know the ship s current state and estimates its future state based on the maneuverability of the ship the ship is suggested to be sailed at low speed to avoid collision with the dock and other vessels but low speed will sharply reduce the ship s maneuverability and increase control complexity to address the above challenges attempts have been made to design advanced controllers using knowledge of nonlinear control theory katayama and aoki 2014 li et al 2016 mizuno et al 2016 and fuzzy theory yingjie et al 2019 tran et al 2017 however it is hard to construct nonlinear mathematical models and define fuzzy rules for ship docking since any unpredictable situations including weather influences and other vessels disturbances may arise in such a case an ann based approach with the ability to learn the underlying nature from maneuvering data provides a potential solution for automatic ship docking in principle the robustness of this approach depends not only on the ann s structure but also on the training data the training data can be either from real ship docking operation or from reliable simulation the former has high reliability but is difficult to be collected under different environmental disturbances the latter is most frequently used because of its high efficiency and as long as the fidelity of modeling ship docking operation is good enough the reliability of the training data is guaranteed in this paper we propose a new ann based approach to achieve automatic ship docking under different environmental disturbances the main contributions of this paper can be summarized as follows 1 a ship docking simulation module with complete ship environment models is established for generating reliable docking data 2 the feature selection technique is applied to provide optimal inputs for the ann 3 the ann based approach with two parallel structure optimized by genetic algorithm is verified to be able to dock the ship under different environmental disturbances the present paper is organized as follow section 2 is a brief overview of related work in section 3 a ship docking simulation module including ship mathematical model and wind disturbance model is established in section 4 the proposed ann based approach from data collection feature selection to ann construction and optimization is introduced in detail section 5 presents the docking results of the approach under different environmental disturbances conclusions and future work are given in section 6 2 related work the first automatic ship berthing system based on ann was demonstrated in the 1990 s by yamato 1990 later zhang et al developed an automatic ship berthing system using a multivariate neural network based controller zhang et al 1997 the pre planned birthing path was determined as the input of the controller however the authors did not introduce how to set the berthing path in 2001 im and hasegawa proposed a parallel neural network based controller to control ship thrust rpm and rudder im and hasegawa 2001 the experimental results demonstrated the proposed parallel neural network based controller could eliminate the effects of slight wind and current but failed to manipulate the ship to the destination in harsh environment to address this challenge a motion recognition method was utilized to cope with environmental impacts im et al 2002 the method succeeded to compensate the crosswind disturbance but still failed when the wind comes from the direction of the bow nguyen and jung explored the adaptive neural networks to achieve automatic ship berthing nguyen and jung 2007 recently zhang et al proposed a robust adaptive neural network approach based on the navigation dynamic deep rooted information to reconstruct the lumped uncertainties caused by unknown ship dynamics and external disturbances zhang et al 2019 the above researches focused more on the structure design of the ann controller whilst none of them tried to generate training data with different constraints by using an algorithm to improve the applicability of the ann controller in fact there have been attempts in training data generation in 2007 ohtsu et al proposed a new solution using nonlinear programming method to generate minimum time ship maneuvering data mizuno et al 2007 hasegawa et al first attempted to use a nonlinear programming language npl to generate ship berthing data with restricted conditions xu and hasegawa 2012 ahmed and hasegawa followed the research and first proposed the concept of virtual windows which is used to ensure the consistency of training data ahmed and hasegawa 2012 ahmed et al 2013 ahmed and hasegawa 2014 2015 the npl method allows the user to define non equal constraints by setting rudder angle as the optimal variable and the time as an objective function however excessive restrictions are defined as termination conditions in these researches when using the npl method which causes fluctuation of rudder angle commands nonlinear model prediction algorithm is another solution for optimal berthing data generation but requires higher computational resources to obtain the optimal maneuver path mizuno et al 2003 however taking advantages of graphics processing unit the method can be executed in parallel which makes real time optimal control feasible mizuno et al 2012 for example mizuno et al proposed a quasi real time optimal control system composed of a multiple shooting algorithm for docking data generation and a nonlinear model predictive controller for path following under wind disturbance mizuno et al 2015 there are also researches that directly use real ship docking data obtained by experienced captains who successfully maneuver the ship into the berth to train neural network based controllers im and nguyen 2018 nguyen et al 2018 but the method is not applicable to general docking operation as it is difficult to collect large number of real ship docking data under different cases of environmental disturbances for training to achieve the generality of ann based docking in different environment disturbances we propose a new automatic ship docking strategy that employs a ship docking simulation platform to generate reliable docking data and an ann based approach with optimized parallel structure to maneuver ships into the dock 3 docking problem statement and simulation model 3 1 docking problem statement slow speed planning on board sensing equipment and control approach play key roles in ship docking kose et al proposed two requirements to ensure ship safety according to the maneuvering procedures followed by the captain in the actual docking of ships kose et al 1986 the first one is that the destination for docking should be at some distance away the dock instead of completely at the dock the second one is that the captain has enough time to plan a good maneuver in any critical situation to meet these two requirements the whole process can be divided into two phases as shown in fig 1 the first is the ballistic phase it utilizes the main thrusters and rudder for course changing speed adjustment and stopping the second phase is to use tunnel thrusters to achieve side push in this paper we focus on the first phase of the docking operation it is assumed that the ship starts from a stationary state and maneuvers towards the port in low speed the ship will dock in parallel to the port with zero velocities when it arrives at the destination moreover three different sea conditions including no wind constant wind and dynamic wind are considered for the docking problem in fig 1 n x n y n is the north east coordinate system and its coordinate values can be obtained from the global positioning system gps d x o y o is called the north up coordinate system which includes the heading angle and distance from ship to dock nguyen et al 2018 in this paper all simulations are performed in the north up coordinate system the merit of using the north up coordinate system is to control the ship into other different docks without retraining the controller b x b y b represents the body coordinate system the notation for the marine vessel in fig 1 is shown in table 1 3 2 ship mathematical model the study of ship dynamics consists of two parts kinematics which overcomes geometrical problems of motion and kinetics which analyzes the relationship between force and motion ship movement is expressed in six degrees of freedom dof which includes surge sway heave roll pitch and yaw fossen 2011 for a surface ship as shown in fig 1 it is only necessary to study the motion in three dof namely the surge sway and yaw in this study the maneuver model group mmg is used to describe ship motion in which the hydrodynamic forces and moments acting on the ship are divided into modular components such as hull rudder and propeller the following is an mmg based mathematical model considering wind influence committee et al 2002 1 m m x u m m y v r x h x p x r x w m m y v m m x u r y h y p y r y w i z z j z z ṙ n h n p n r n w where m is the ship mass m x m y are the added mass in surge sway direction i z z is the mass moment of inertia j z z is the added mass moment of inertia x y and n denote surge force sway force and yaw moment h p r and w are the symbols that represent hull propeller rudder and wind x h y h and n h represent the hydrodynamic forces and moment acting on the ship hull which are defined as katsuro et al 1990 2 x h ρ 2 l d u 2 x β r sin β x u u cos 2 β r l u y h ρ 2 l d u 2 y β y r r l u y β β β β y r r r l u r l u y β β r β 2 r l u y β r r β β r l u 2 n h ρ 2 l d u 2 n β n r r l u n β β β β n r r r l u r l u n β β r β 2 r l u n β r r β β r l u 2 where ρ is the water density l denotes the length over all of ship d is the draught of ship u represents the speed of ship the hydrodynamic coefficients x β r x u u n β r r can be estimated with the method described in katsuro et al 1990 the propeller mainly produces longitudinal force and its lateral force is negligible thus propeller hydrodynamic model can be written as 3 x p 1 t p t y p 0 n p 0 where t p is a coefficient and the propeller thrust force t is defined 4 t ρ n 2 d p 4 k t where n is propeller speed rpm d p is diameter of the propeller k t is the thrust coefficient the hydrodynamic forces and moment generated by the rudder can be calculated by the following formula 5 x r 1 t r f n sin δ y r 1 a h f n cos δ n r x r a h x h f n cos δ where t r a h are coefficients x r and x h are the distances from the rudder and the propeller to the ship s center of gravity respectively f n is the rudder pressure δ denotes the rudder angle as a result the control inputs of the mmg model are the propeller speed n and rudder angle δ the ship velocities u v and r represented as the state variables in eq 1 are the control outputs of the model 3 3 wind force model the wind has a significant effect on the ship which will affect heading and sway movement failure to compensate correctly for wind during docking is one of the main factor of docking accidents here the wind forces and moments acting on the ship are estimated as fujiwara et al 1998 6 x w 1 2 c x ρ a v r 2 a f y w 1 2 c y ρ a v r 2 a l n w 1 2 c n ρ a v r 2 a l l the physical meaning of each symbol in eq 6 is shown in table 2 4 proposed approach fig 2 schematically depicts the ann based ship docking control strategy for ship docking under environmental disturbances first the ship docking simulation module is constructed it consists of a ship model and environmental disturbance models which is fundamental to both manual control and ann based control based on that training data set can be generated as indicated by the blue arrow the data set is the collection of ship maneuvering data from the simulation the data is pre processed through feature selection to find optimal input parameters for ann construction and further normalized before the training of the ann the green arrow illustrates the implementation of the ann based approach the ann is optimized by a genetic algorithm and trained using the data set as a result the trained ann model can be applied to steer the ship to dock under external disturbances 4 1 data generation in this research training data is created through manual controller i e by a skilled captain using a joystick to control ship s rudder and thrust the usage of the joystick is shown in fig 3 button 4 is used to enable the control of thruster speed only when it is pressed can button 1 be used to adjust thruster speed within the range of 130 130 r p m similarly button 5 enables the use of rudder control and handle 2 can adjust rudder angle between 45 and 45 only if button 5 is pressed button 3 is the stop key when the ship arrives at the dock safely the captain can press the button to stop the maneuver 4 2 data pre processing the data pre processing mainly contains two parts feature selection and data normalization the purpose of feature selection is to choose an optimal subset from the training data for ship control in this paper a step wise feature selection method is developed first those constant variables would be deleted in addition to remove the redundant information between input parameters pearson correlation analysis bolboaca and jäntschi 2006 is applied then ann based variance based sensitivity analysis is used for identifying the importance of each feature cheng et al 2019 assume any two input parameters x and y the pearson correlation of these two parameters can be defined as follows 7 ρ x y σ x y 2 σ x 2 σ y 2 where σ x is the standard deviation of x σ x 2 is the variance of x σ y is the standard deviation of y σ y 2 is the variance of y σ x y 2 is the co variance of the variables x and y the pearson coefficient can be used to detect the dependency of two input parameters in this paper one of the two parameters would be removed if the pearson coefficient of the two parameters is large if the model form is f x f x 1 x m where x x 1 x m represents the model input which contains m independent parameters based on the theory of sobol saltelli and sobol 1995 the variance based sensitivity index can be described as the ratio of partial variance and total variance the influence of the i th variable x i to the output can be defined by 8 s t i 1 v i v where s t i is the influence of input parameter to output v stands for the total variance and v i represents the influence excluding the i th variable if the s t i is close to zero the parameter can be considered to be non important in addition it is necessary to normalize all parameters to speed up the training convergence and improve accuracy of the ann model all the parameters would be normalized 9 x ˆ x e x v a r x ϵ where e x represents the mean of x v a r x stands for the variance of x ϵ is a positive infinitesimal to make the calculation possible when x is a constant ϵ is set to 10 6 in this paper 4 3 ann based controller since the automatic ship docking system is a multi input and multi output system it is important to design a neural network that can learn the underlying nature relationship between inputs and outputs autonomously an ann based controller with two independent parallel structure is designed the inputs of the ann are the parameters selected from data analysis and the outputs are the ship s propeller speed and rudder angle the construction of the two parallel multi layer ann is demonstrated in fig 4 the ann is a multilayer feedforward network that can be trained by error backpropagation the principle of the training algorithm is the gradient descent method that is used to minimize the mean square error mse between the actual output value of the network and the desired output value assume the neural network in fig 4 consists of an input layer m hidden layers and an output layer the output of each hidden layer can be written as 10 h i f w i 1 i h i 1 b i i 1 2 m where h 0 i m w i i 1 is the weight between the hidden layers b i is the offset of the hidden layer and f is activation functions here we choose the tansig function as the activation function and its mathematical expression is expressed as 11 f x 2 1 e x p 2 x 1 similarly the output layer of ann uses linear function and its formula is expressed as following form 12 o c p u r e l i n w n c h n b c where w n c is the weight between the last hidden layer and output layer b c is the offset and h n is the input of the output layer the performance of the trained network is determined by calculating the value of the mse suppose there are k samples in the training data x 1 y 1 x 2 y 2 x k y k where x k y k represent the inputs and outputs of the samples the objective function of the network training is written as 13 m s e 1 k i 1 k y i o c 2 where y i can be either rudder angle or propeller speed the levenberg marquardt algorithm is used to minimize the mse the weights of the ann are updated as follows 14 w i 1 i t w i 1 i t 1 j t w i 1 i t 1 j w i 1 i t 1 μ i 1 j t w i 1 i t 1 m s e w i 1 i t where j is jacobian matrix and i is identity matrix in this paper ga is used to optimize the ann based controller the chromosome consists of integers representing the number of hidden layers and the number of neurons in each hidden layer phan et al 2017 the fitness function is designed as the performance of ann in eq 13 through ga operation including crossover and mutation individuals with high fitness values will be selected to form a new generation the process is repeated until termination condition is satisfied as a result the ann structure is optimized to fit the training data 5 experiments this section is devoted to the validation of the proposed ann based approach first a simulated offshore vessel represented by the mmg model with parameters derived from the marine systems simulator mss perez et al 2006 is set up as shown in table 3 next a docking scenario is built up as listed in table 4 the task is to steer the vessel from the initial state to the final state under a zero velocity constraint of the respective state after that data with three different environmental conditions including no wind constant wind and dynamic wind is collected for training the ann based controller introduced in section 4 3 all experiments are conducted in a computer equipped with 2 60 ghz i7 6700k cpu and 16 gb ram 5 1 feature selection to obtain the optimal input parameters for the ann shown in fig 4 the proposed feature selection method is performed there are 16 parameters are logged in the simulated scenarios mainly including two categories state of vessel and environmental information the vessel s state includes its position and heading the speed of vessel in each dof the force of vessel in each dof and the state of thrusters environmental information includes the force of wind in each dof the wind speed and the wind direction since wind speed and wind direction are constant values they are removed for analysis thus the correlation of 12 parameters excluding two output variables i e rudder and thruster speed are used for correlation analysis as shown in fig 5 we further use a threshold ρ x y 0 84 to eliminate redundant information among parameters which results in the removal of parameters yaw speed surge force sway force yaw force wind force of surge wind force of sway and wind force of yaw an ann used for sensitivity analysis is built on the basis of the rest 5 parameters a variance based sobol method with a distribution sampled from the original data is performed on the ann cheng et al 2019 fig 6 shows the sensitivity index of the 5 parameters according to the results of sensitivity analysis three input parameters i e the relative distances x and y between the ship and the dock and heading angle are selected as the inputs of the ann the output of the ann as shown in fig 4 are the rudder angle δ and thruster speed n introduced in section 3 2 5 2 configuration of ann it is necessary to determine the structure of ann as there are no existing rules that can be used to accurately select the number of layers of the hidden layer and the number of neurons in this study the structure was determined by trial and observation of the minimum mse employing ga the search for the number of hidden layers is set as m 2 3 4 5 6 and the search for the number of neurons in each hidden layer is set as n 0 3 6 9 12 the optimized hidden number m o should meet the requirement m o m for ga each chromosome contains the above two parameters i e number of hidden layers and neurons the crossover probability and mutation probability of ga are set to 0 3 and the stopping criterion is that the number of generations reaches 50 table 5 lists the optimized hidden layers and the neuron number of each hidden layer considering a metric among mse number of neurons and training time four hidden layers with the corresponding neuron number shown in bold in table 5 are used for the experiment 5 3 verification of ann in no wind condition fig 7 illustrates some successful maneuvers without wind perturbation in dotted lines using the ann based approach note the two paths one in red representing the trajectory using the same initial heading in training data and the blue one representing a completely new initial heading different from the training data the rudder angle and thruster speed generated completely by the ann are expressed in fig 8 fig 9 illustrates the variation of the ship s surge velocity sway velocity yaw velocity and heading angle during the docking process when the ship arrives at the dock its velocities are very close to zero less than 0 01 m s and the ship s heading angle is also approximately 270 in this case the ship successfully stopped at the dock and terminal states also meet the requirements in table 4 5 4 verification of ann in constant wind condition here we test the ann based controller in different initial states under constant wind condition of v w 3 m s and β w 0 fig 10 illustrates the automatic docking trajectory starting from different initial headings the red curve and the blue curve are two successful maneuvers with the same initial states and different initial states from the training set respectively fig 11 shows the control commands used for the docking the thruster speed dramatically fluctuates between 300 and 400 s which may be caused by speed adjustment it can be seen from fig 12 that when ships arrive at the dock the surge velocity and yaw velocity are close to zero and the heading angle is also close to 270 due to the disturbance of wind the ship s sway velocity is not zero 5 5 verification of ann in dynamic wind condition the ann based controller is tested under different wind speeds fig 13 shows the results of different ship initial states the red curve represents a ship docking path starting from heading 300 which is included in training data the blue curve is a maneuver that the ship starts from a random heading it shows that the ann cannot navigate the ship to move straight when arriving at position 0 500 even though the ship is heading towards the dock the reason is that the wind is becoming stronger at the moment in the simulation wind direction is constant β w 0 and speed changes randomly from 1 5 m s to 4 5 m s per minute as demonstrated in the bottom panel of fig 14 the change of surge velocity yaw velocity and heading angle can converge to zero at last but the sway velocity fluctuates periodically with the wind disturbance as shown in fig 15 5 6 discussion the simulation results show that in no wind condition the ann controller works very well with only small fluctuations in command of rudder angle and thruster speed moreover the ship states are in full compliance with the requirements in table 4 when the ship arrives at its destination ships can also dock safely in the constant wind environment but there is a slight error in the final heading angle less than 2 and the yaw speed is not fully zero the main reason for this problem is that the ship is required to sail at low speed when it approaches the berth which greatly reduces the ship s maneuverability in the dynamic wind condition the control results of the ann are not as good as these in the previous conditions due to the randomness of the wind the rudder angle and propeller speed fluctuate drastically and the path is not smooth enough in addition the ship cannot successfully arrive the dock when it departs from initial heading angles between 5 and 23 because at these initial heading angles the ann is very sensitive to the disturbance of dynamic wind 6 conclusion this research proposes a novel way to generate reliable ship docking data and finds the optimal variables for training a new neural network by employing feature selection technique and genetic algorithm which were not considered in previous studies the conclusions of this work are summarized as follows 1 a ship docking simulation module is established which provides both manual and algorithm based interface for ship docking operation 2 feature selection is applied to eliminate redundant information between input parameters and identify their importance to ship s control parameters 3 to ensure the stability of the ann based approach the neural network structure is optimized by using ga two parallel forward neural networks with four hidden layers are established to control ship s rudder angle and the propeller speed respectively 4 numerical results show that under no wind and constant wind conditions the feasibility of the ann based approach is fully reflected while under the dynamic wind environment the performance is inferior but can still steer the ship into dock for future study the degree of sensitivity of the trained ann based controller to the initial and termination states will be investigated furthermore it is critical to improve the proposed approach to effectively compensate for dynamic wind disturbances advanced mechanisms will be set up to create versatile control strategies that meet different requirements such as minimum time maneuver lowest energy consumption and collision avoidance with dynamic obstacles acknowledgments this work was partially supported by the project digital twins for vessel life cycle service project no 280703 and partially by the project dynamic motion planning based on trajectory prediction in close range maneuvering project no 298399 in norway 
22411,the flow induced vibration fiv of a rotating circular cylinder in reduced velocity range of 3 0 u 14 is investigated numerically the forced rotating cylinder can freely vibrate in flow and cross flow directions the amplitude and frequency are analyzed to understand the effect of rotation on fiv the oscillation of cylinder is enhanced significantly by rotation in flow direction but the opposite phenomenon is observed in cross flow direction the maximum amplitudes of 0 363d in flow direction and 0 611d in cross flow direction are obtained the skewing of vibration in cross flow direction is observed due to magnus effect and the time averaged displacement of rotating cylinder in cross flow direction increases monotonously with the rotation rate α meanwhile same frequencies in two directions are observed for rotating cylinder which leads to closed loop trajectories that are quite different from the situations of non rotating cylinder for different α the frequency ratios in cross flow direction stay around 1 1 when u 6 0 except for α 1 0 the trajectories also reflect the instability of vibration for high reduced velocity due to the asymmetry generated by the rotation large lift and drag force coefficients are obtained the 2s and u vortex patterns are observed for the fiv of rotating circular cylinder keywords flow induced vibration two degree of freedom rotation magnus effect circular cylinder 1 introduction the phenomenon of flow past bluff bodies is widespread in both nature and industry such as in heat exchangers cooling tower in power plant long span suspension bridges and marine risers chen et al 2018a narendran et al 2018 avila sanchez et al 2017 turmo and luco 2010 the elastically mounted bluff bodies will experience flow induced vibration fiv when they are exposed to transverse fluid flow in most cases fiv needs to be suppressed to avoid fatigue damage to structures low and srinil 2016 the responses control and suppression of fiv have drawn great interests from researchers zhu and gao 2017 huera huarte 2017 ma and srinil 2017 kumar et al 2018 for contrary purpose it is necessary to enhance oscillation when extracting clean energy including wind energy and hydroenergy by fiv ding et al 2018 kim and bernitsas 2016 hu et al 2019 therefore the control of fiv is necessary for different purposes and the rotation of bluff body is one of the simplest controlling methods moreover the fiv of rotatory cylinder can be observed in the rotating slender structure exposed to current in offshore engineering and deep water drilling yan et al 2015 therefore the rotation of cylinder in fiv with two degrees of freedom 2 dof has been studied due to its important role in energy harvesting and suppression of fatigue damage the one degree of freedom 1 dof fiv of cylinder has been investigated extensively in simulation and experiment by many researchers chen et al 2018b ding et al 2013 2015a focusing on the responses of fiv in terms of the amplitude and frequency response characteristics viv vortex induced vibration is one kind of the common fiv phenomena which is a self exciting self limiting phenomenon brika and laneville 2006 yang et al 2019 navrose 2017 pigazzini et al 2018 three typical regions of viv for circular cylinder can been observed in the amplitude responses including the viv initial branch upper branch and lower branch williamson and govardhan 2004 munir et al 2018 three dimensional numerical investigate the 1 dof viv responses of forced rotating cylinder when reynolds number is 500 they found that the lock in regime for forced rotation cylinder is wider than that of non rotating cylinder resonance will be caused when the vortex shedding frequency is close to the natural frequency of the system and large amplitude of the oscillation can be achieved in the condition of 1 dof for the cylinder with asymmetry factor such as rotation the unstable force on cylinder will cause galloping and lead to high amplitude of fiv as well ding et al 2013 2015a 2015b chang et al 2011 compared to 1 dof fiv the oscillatory response of cylinders are quite different when 2 dof motions of the cylinders are allowed in most cases of 2 dof the amplitude of fiv in cross flow direction is much larger than that in flow direction pastrana et al 2018 yu et al 2018 kang et al 2018 this would lead to spindly trajectories in addition the trajectories of cylinder in fiv can be influenced by natural frequencies of the oscillatory system kang et al 2016 found that the oscillating frequency in two directions have more than one domain frequency and the trajectories of cylinder were significantly different from the traditional 8 shape the 8 shape trajectories indicate the oscillatory frequency in flow direction is twice of that in cross flow direction when considering the forced rotation of cylinder in fiv under 2 dof vibration the amplitude response and trajectory will be more complicated however only 1 dof has been considered in most studies of fiv for a rotating cylinder bourguet and lo jacono 2014 wong et al 2018 wong et al 2017 relatively few studies have considered the rotation of cylinder in fiv under the condition of 2 dof zhao et al 2014 found that the rotation of cylinder would lead to single closed loop trajectories in 2 dof fiv due to same value of the oscillating frequencies in the two directions they also found that the amplitude responses of rotating cylinder are different from that of no rotation cylinder and amplitude of forced rotation cylinder in flow direction increases significantly in 2 dof fiv forced rotation of non oscillating cylinder is also studied to obtain the influence of rotation of the cylinder to vortex shedding mittal and kumar 2003 naik et al 2017 padrino and joseph 2006 the vortex pattern is depending on the reynolds number and nondimensionalised rotation rate the nondimensionalised rotation rate α is defined as α d ω 2u where ω is the angular velocity of the rotating circular cylinder d is the diameter of the rotating cylinder u is the velocity of incoming flow the review of rao et al 2015 detailed summarized differences of two steady states for α 7 0 and reynolds numbers re 400 namely steady state i and steady state ii which are classified depending on the vortex pattern and the vortex induced force acting on the cylinder most of the studies for rotating cylinder in fiv are focused on the amplitude response and trajectory of cylinder wong et al 2017 investigated the forced rotation cylinder in 1 dof fiv by experiment and found that the rotation can enhance vibration when compared with the amplitude response of non rotating cylinder moreover the studies of forced rotating cylinder in fiv were mostly under low reynolds number and only allowed for motion in the cross flow direction in industrial applications the turbulence flow is more common to encounter and the oscillation in 2 dof is more applicable therefore a relative higher reynolds number range of 1805 re 8430 is considered for the 2 dof fiv of a rotating circular cylinder in this study a series of numerical simulations are conducted to understand the influence of rotation rate on 2 dof fiv and the simulation results of 2 dof fiv are compared with experimental data of 1 dof fiv from others wong et al 2017 the physical model and numerical approach are presented in section 2 and 3 respectively the results including amplitude and frequency responses the time averaged displacements tracks of cylinder lift and drag coefficients and near wake structures are presented and discussed in section 4 conclusions are drawn in section 5 2 physical model the physical model of the oscillatory systems is depicted in fig 1 the compositions of the fiv system are a rigid rotating circular cylinder of diameter d supporting linear springs of stiffness k 1 x direction and k 2 y direction and the system dampings c 1 x direction and c 2 y direction due to friction the circular cylinder is forced to rotate in the anticlockwise around its axis in an angular velocity which depends on the rotation rate α defined as α d ω 2u where ω is the angular velocity of the rotating circular cylinder the uniform incoming fluid flows in x direction and its velocity is u the rotating cylinder can move freely in the x direction and y direction the equilibrium position of oscillation in this model will move to the negative y direction due the unbalanced force by effect of rotation the parameters of spring and damping are the same in two oscillatory directions the mass ratio is defined as m m system m water where m system is the mass of the cylinder and m water is the displaced mass of the fluid the value of m is considered as 5 78 in this paper for the convenience of comparison which is the same as the value in the experiment of wong et al 2017 all the system parameters are listed in table 1 3 numerical approach 3 1 governing equations of fluid mechanics to describe the incompressible and turbulent flow the two dimensional unsteady reynolds averaged navier stokes urans equations and the stranded k ε turbulence model are applied to obtain flow parameters in the present study the simulations are conducted by commercial cfd software of fluent and combine the user define function udf the governing equations can be expressed as 1 u i x i 0 2 ρ u i u i x j x j p δ i j μ u i x j u j x i ρ u i u j where the reynolds stress tensor τ i j u i u j and u i u j is the reynolds stresses which are defined as 3 u i u j ν t s i j 2 3 δ i j k in which 4 s i j 1 2 u i x j u j x i 5 ν t c μ k 2 ε where x i is the coordinate in the direction i u is the velocity in x direction ρ is the fluid density p is pressure ν t is the turbulence kinematic viscosity c μ is a constant value of 0 09 s ij is the mean strain rate tensor and k is the turbulence kinetic energy which is defined as 6 k 1 2 u i u i for the k ε turbulence model singhal and spalding 1981 the parameters of k and ε are calculated by the navier stokes n s equations the transport of k and ε can be expressed as 7 k t u j k x j x j ν ν t σ k k x j g ε 8 ε t u j ε x j x j ν ν t σ ε ε x j c ε 1 ε k g c ε 2 ε 2 k where u j means the velocity component in y direction g is defined as 9 g u i u j u i x j ν t u j x i u i x j u i x j in eq 7 and eq 8 c ε1 c ε2 σ k and σ ε are constants 3 2 kinematic equation and discrete method the oscillating system is simplified as a typical mass spring damper system which is used to describe the cylinder s oscillation in fiv so the equations of motion in x direction and y direction can be expressed as 10 m s y s t e m x c 1 x k 1 x f f l u i d x 11 m s y s t e m y c 2 y k 2 y f f l u i d y where m system is the inertial mass of the oscillation system f fluid x and f fluid y are the fluid force acting on the cylinder in the x direction and y direction respectively x x and x are displacement velocity and acceleration of the cylinder in x direction and y y and y are displacement velocity and acceleration of the cylinder in y direction c 1 and c 2 are the system damping in x direction and y direction for the oscillatory cylinder the velocities are defined as 12 υ x t x t 13 υ y t y t the initial conditions for the forced rotating cylinder are 14 υ x 0 υ y 0 0 15 x 0 y 0 0 for eq 11 the periodic forces acting on the cylinder are f fluid x and f fluid y respective the drag force and lift forces respectively for one calculating step eq 1 and eq 2 are solved and then the value of f fluid x and f fluid y are calculated by integrating the pressure and viscous forces over the surface of the forced rotating cylinder when f fluid x and f fluid y are obtained the above two equations can be discreted by the method of fourth order runge kutta in the y direction eq 11 can be expressed as 16 y t n 1 y t n δ t 6 k 1 2 k 2 2 k 3 k 4 17 y t n 1 y t n υ y t n δ t δ t 2 6 k 1 k 2 k 3 in which 18 k 1 f f l u i d y t n m s y s t e m c 2 m s y s t e m υ y t n δ t k 2 m s y s t e m y t n 19 k 2 f f l u i d y t n m s y s t e m c 2 m s y s t e m υ y t n δ t 2 k 1 k 2 m s y s t e m y t n δ t 2 υ y t n 20 k 3 f f l u i d y t n m s y s t e m c 2 m s y s t e m υ y t n δ t 2 k 2 k 2 m s y s t e m y t n δ t 2 υ y t n δ t 2 4 k 1 21 k 4 f f l u i d y t n m s y s t e m c 2 m s y s t e m υ y t n k 3 δ t k 2 m s y s t e m y t n δ t 2 υ y t n δ t 2 2 k 2 where k 1 k 2 k 3 and k 4 are fourth order runge kutta coefficients υ y is the velocity of cylinder in y direction δt is time step eq 17 can be calculated when combined with the initial conditions eq 12 to eq 15 the motion of cylinder is determined by user defined functions udfs to ensure the accuracy of calculation for rotating cylinder the time step δt is set as 0 004s in this work naik et al 2017 3 3 computational domain and grid generation the size of computational domain is 8d l 2h for the rotating cylinder system as shown in fig 2 at the initial condition the center of cylinder is 8d away from the boundary of inlet and the distance between the cylinder and outlet in flow direction is l the cylinder is located at the center of the computational domain in cross flow direction the distance of h between the cylinder and top is the same as that between the cylinder and bottom the value of h and l should be large enough to ensure the accuracy of the results for simulations however the oversize of the two distances would cost too much computing resources and time to balance the two requirements a series of grid sensitivity studies were conducted and the optimal value of h and l are analyzed separately see in this section the boundary condition of inlet is set as uniform velocity the outlet condition is zero gradient for velocity u y 0 v y 0 the boundary conditions of top and bottom are specified as a no slip wall thus u y 0 and v 0 the no slip condition is applied on the surface of the forced rotating cylinder overlapped grids are applied in this work which need two sets of mesh background mesh and append mesh there is an internal boundary which define as overset whose role is to transfer data between background mesh and append mesh fig 3 a shows the part of background mesh in optimal size of computational domain and maximum mesh density which is static and structured the grid of the cylinder s motion area and the wake area are refined to capture the accurate oscillation of the cylinder and the wake structures where the mesh density is maximum in background mesh fig 3 b shows the append mesh which is moving with the oscillatory cylinder and still structured the layer grid is applied around the cylinder to obtain the accuracy of the layer motion for the first layer thickness in the radial direction is δy and the growth factor is 1 1 the stranded k ε solver require y plus of close to 30 δy can be carried out by the equation stated by pope 2001 22 y 0 172 δ y d r e 0 9 where d is diameter of the rotating cylinder the value of δy depends on the reynolds number and for different re the thickness of the first layer is not a constant but vary with the reynolds number 1805 re 8430 in this paper the thickness of the first layer δy 0 001533 m thus 0 0511d corresponds the highest re 8430 depending on the different δy a series of mesh is generated for the simulations in order to obtain appropriate mesh to gain both accurate resolution and acceptable computing time the validation studies of the mesh density and the size for computation domain were conducted the validation studies were accomplished when the reduced velocity u u f n d 5 0 re 3000 α 0 the mesh density was represented by the minimal mesh size δh of background mesh a firstly capture the optimal mesh density due to the density of background mesh corresponds to that of append mesh the background mesh and append mesh have been validated simultaneously in this step the computational domain was fixed at a large size of 8d 25d 36d the mesh density can be characterized by the minimum mesh size and three different mesh sizes of 0 01d 0 02d and 0 04d were used to discretize the domain as shown in table 2 a the optimal minimal background mesh size of 0 02d was selected after overall consideration for a peaks x d a peaks x d the rms lift coefficient is defined as c l r m s 1 t o s c 0 t o s c c l 2 t d t where c l 2f fluid y ρu 2 dl and t osc is the period of vibration and the time averaged drag coefficient is c d m e a n 1 t o s c 0 t o s c c d t d t where c d 2f fluid x ρu 2 dl b secondly capture the optimal height of computational domain the height of the computational domain corresponds to the height of background mesh in this step kept the minimal background mesh size was kept at 0 02d and the wake region length l at a large size of 25d then the cross flow height h was changed 10d 15d 18d to obtain optimal value in this step the simulated results are shown in table 2 b the optimal h of 15d was selected by comparing the results of amplitudes and force coefficients in different cases c lastly capture the optimal length of wake region during this process the cross flow direction size was fixed at 2 15d and minimal background mesh size was still kept at 0 02d three wake region length of 15d 20d and 25d were investigated in this step the force coefficients and the amplitude ratios for each case are shown in table 2 c the percentage change in the values was less than 1 when the flow direction length was changed from 20d to 25d this means that l 20d was found suitable for the work in conclusion the optimal computational domain size of 8d 20d 30d and the minimal background mesh size of 0 02d were confirmed 3 4 validation the simulations of fiv only in cross flow direction were carried out when α 0 1 0 and 1 5 for validation the simulation results were compared with the experimental work by wong et al 2017 it is worthy noted that all the parameters which are used in validation cases are exactly the same with that of the experiments wong et al 2017 the results of amplitude and frequency as presented in fig 4 show that the 1 dof fiv responses of cylinder match well with experimental tests for all the cases tested in this section the three branches which are viv initial branch upper branch and lower branch can be clearly observed when u 12 the oscillation of the circular cylinder is suppressed seriously and a peaks y 0 in this range the frequency ratio of α 0 increases with the reduced velocity when 3 0 u 7 0 then the frequency ratio f stays around 1 1 in the range of 7 0 u 9 0 when u 9 0 a slight rise of frequency is observed as for the cases of α 1 0 and 1 5 the value of f increases rapidly with the increase of reduced velocity in the range of 3 0 u 6 0 and then increases slowly in the range of 6 0 u 10 therefore the computational schemes proved to be reliable by comparison between the computational results and the experimental ones the numerical method used in this work is an effective method 4 results and discussions in order to understand the behavior of 2 dof fiv of a forced rotating cylinder the results of numerical simulations are presented and discussed in this section the amplitude and frequency responses are the most important parameters to describe the strength of oscillation in fiv for comparison purposes all the amplitudes in this paper are made nondimensional by the diameter of cylinder therefore the amplitude responses are analyzed by the amplitude ratios in x direction a peaks x defined as a peaks x a peaks x d and y direction a peaks y defined as a peaks y a peaks y d it should be noted that time averaged displacement was subtracted for the calculation of amplitudes in subsection 4 1 to further analyze the fiv of forced rotating circular cylinder drag and lift coefficients the tracks for oscillating cylinder and wake structures are discussed in this section the results of wong et al 2017 and bourguet et al bourguet and lo jacono 2014 are presented for comparison as well 4 1 amplitude response for different u reduced velocity and rotation rate α the amplitude ratio of the circular cylinder in x direction a peaks x is shown in fig 5 the amplitude of non rotating cylinder α 0 is also shown for comparison the overall trend in the amplitude ratios is that the amplitude ratio increases firstly and then decreases to a stable value with the increasing of reduced velocity u the trends of the amplitude in x direction for different rotation rates are similar however there are large gaps of maximum amplitude value between different rotation rates for α 0 non rotating the amplitude ratios in x direction a peaks x is generally much less than that of α 0 5 1 0 and 1 5 at most u which are basically in the range of 0 a peaks x 0 013 the maximum amplitude ratio of 0 013 is obtained when u 5 0 for α 0 5 when α 0 5 the amplitude ratios increase rapidly compared with α 0 a peaks x increases rapidly from almost 0 to 0 363 when 3 0 u 5 0 and then experiences a quick drop in the range of 5 0 u 8 0 when u 8 0 the amplitude ratios almost remain unchanged and the value are a little higher than 0 when α 1 0 the trend of the amplitude ratio is the same with the case of α 0 5 and a maximum amplitude of 0 363d is obtained at u 5 0 for α 1 5 a peaks x continues to rise in a reduced velocity range of 3 0 u 4 5 and reaches a maximum value of 0 267 at u 4 5 but for 4 5 u 7 0 the amplitude ratio drops to almost 0 the results of amplitude ratio in y direction a peaks y d for present work and wong et al 2017 are shown in fig 6 the amplitude in y direction of forced rotating cylinder with 2 dof oscillation is smaller than that for only one degree of freedom in most cases the maximum amplitude ratio is also lower than that of 1 dof for the same α three branches including initial branch upper branch and lower branch are observed in amplitude responses as shown in fig 6 the initial branches in the simulations are hardly observed for the experiment the oscillation in cross flow direction is enhanced by the effects of rotation over a broad range of u especially for α 1 5 on the contrary the oscillation in y direction is suppressed for the case of 2 dof the overall trends of a peaks y increase first and then decrease with the rising of u to be more specific the increasing range of a peaks y for α 0 is 3 0 u 5 0 and the increasing ranges are 3 0 u 4 5 for cases of α 0 5 the maximum amplitudes are 0 611d for α 0 0 561d for α 0 5 0 482d for α 1 0 and 0 315d for α 1 5 compared with the fiv in 1 dof the a peaks y of the rotating cylinder in cross flow direction for 2 dof is significantly smaller for most velocities especially for u 8 0 when α 1 5 it indicates that the higher rotation rate can result in the suppression of oscillation in y direction 4 2 time averaged displacement responses due to the drag force and the magnus effect caused by rotation the equilibrium position in two directions do not stay at the initial position thus the time averaged displacements in two directions is not equal to zero the time averaged displacements of the rotating cylinder in two directions are shown in fig 7 and fig 8 the cylinder will migrate in flow direction due to the dynamic pressure on cylinder time averaged displacement of rotating cylinder in x direction is x mean and it increases monotonously with u moreover the rate of increase grows the values of x mean for α 0 0 5 and 1 0 are very close at the same u but x mean for α 1 5 is smaller than that of other α in the range of 3 0 u 8 0 the contrary tendency can be observed in the region of 8 0 u 14 this means the rotation rate almost do not affect the equilibrium position in x direction and the maximum x mean of α 0 0 5 1 0 and 1 5 are 0 422d 0 437d 0 439d and 0 580d respectively it is noted that there are some small fluctuations of the time averaged displacement in the range of 4 0 u 8 0 for α 0 0 5 and 1 0 as shown in fig 8 the equilibrium position in y direction almost keep in the initial position when α 0 non rotating thus y mean 0 the lift force of rotating cylinder increases with α due to magnus effect seifert 2012 which leads to the magnitude of time averaged displacement also increases with α compared with the 1 dof fiv of rotating cylinder bourguet and lo jacono 2014 y mean of rotating cylinder in 2 dof is larger for the same rotation rate except for α 0 and the maximum time averaged displacement is y mean 1 183d when α 1 5 and u 14 for 2 dof fiv 4 3 frequency response it was found that the value of oscillatory frequency in cross direction is the same as that in flow direction when the cylinder is forced to rotate as for the non rotation cases the frequency in x direction is the twice of that in y direction therefore only the frequency in y direction is presented for the sake of brevity the frequency ratio reduced nondimensional frequency is defined as f f osc f n water to describe the frequency responses of forced rotating cylinder in this paper the first order oscillation frequency f osc of the cylinder is carried out by fast fourier transform over the time history displacement of the rotating cylinder as shown in fig 9 a the frequency ratio of forced rotating cylinder is presented as a function of reduced velocity and rotation rate the frequency ratios of 1 dof cases by wong et al 2017 are also presented for comparison the frequency ratios increase in low velocity range and then maintaining stability the frequency ratio of non rotating cylinder in 2 dof α 0 increases monotonously to 1 16 for 3 0 u 6 0 and fluctuates within a narrow range compared to 1 dof fiv f for 2 dof cases are higher in the range of 3 0 u 8 0 for α 0 5 the similar trend is observed except for u 11 different from the results of α 0 and 0 5 the frequencies ratios of α 1 0 and α 1 5 are higher when u 8 0 even reach 1 39 for α 1 0 at u 13 it is noted that irregularities for the oscillation for forced rotating cylinder is widespread for all the interest rotation rates when u 11 such as the case of α 0 5 when u 13 the time history displacement of which is presented in fig 9 b in addition the transition in the curve of time history displacements is caused by the setting of initial condition in simulation and it does not affect the cfd result 4 4 trajectories of rotating cylinder in fiv the motion of the cylinder can be described visualized by the trajectory of each case in this section the xy trajectories of cylinder are plotted in fig 10 to fig 13 according to different rotation rates as shown in fig 10 the trajectories for non rotation cylinder are typical 8 shapes which similar to the outline of number 8 when 4 0 u 8 0 the 8 shape of the trajectories for 2 dof fiv were also observed in previous studies munir et al 2018 zhao and cheng 2011 gsell et al 2016 this phenomenon is caused by the different oscillatory frequency and amplitude in x direction and y direction the trajectories show that the tendency of amplitude increases first and then decreases with the rising of u in y directions which is match with the tendencies of figs 5 and 6 the trajectories also show that the equilibrium position of non rotation cylinder always stays at x 0 which means that the time averaged displacements of non rotation cylinder keeps at zero as observed in fig 8 the shape of the oscillation trajectories also shows that the motion frequency in the flow direction is the double of that in the y direction for α 0 in addition the center of the trajectories for non rotation cylinder are located in the line of a y d 0 which is also match with the time averaged displacement in fig 8 when the circular cylinder is forced to rotate anticlockwise with a rotation rate of α 0 5 1 0 and 1 5 the trajectories of oscillation are plotted in fig 11 fig 13 the trajectories of the cylinder in the lock in regime 4 0 u 8 0 for α 0 5 1 0 and 1 5 corresponds to a circular closed loop which are entirely different from that of α 0 these xy trajectories show that the vibration frequencies of cylinder are same in two directions it should be noted that the length width ratio of the trajectories decreases as α increases which means that the value of the amplitude in two directions is getting closer when the rotation rate increases can be verified by comparing fig 5 with fig 6 in addition the size of the trajectories increases first and then decreases with the increasing of u the shape of trajectories is not always similar to a single ellipse when u 8 0 for example the xy trajectory of u 12 for α 0 5 the reason for existence of irregular trajectory is that the oscillation of the rotating cylinder for higher reduced velocity is unsteady the vortex structures for higher reduced velocities also show that the vortex shedding is more complex when compared with the situation of lower u the centroids of trajectories for forced rotation cylinder get further and further away from the initial position x 0 y 0 with the increasing of u and α the phenomenon is caused by the magnus effect and the tendency correspond with the results of time averaged displacements in figs 7 and 8 4 5 lift and drag coefficients in order to understand the correlation between the force coefficient and the vibration the standard deviation σ cl and time averaged value of lift coefficients c l mean are discussed in this section as shown in fig 14 a the standard deviation σ cl increase sharply first and then decrease to a stable value with the increases of u for all rotation rates for the cases of α 0 and 1 5 the maximum values of σ cl can be obtained when u 4 0 which are σ cl max 0 64 and 1 28 respectively and the standard deviation peaks at u 4 5 for the cases of α 0 5 and 1 0 the maximum values are σ cl max 1 61 and 1 59 respectively when u 6 0 σ cl almost keep at a stable value which is lower than 0 2 for all the cases the high amplitude responses of the cylinder are partly contributed by the large standard deviation of lift coefficients the standard deviation of lift coefficients represents the oscillation part of c l which leads to the oscillation of the rotation cylinder in y directions and this is the reason why the variation tendencies of σ cl shown in fig 14 a correspond to that of a peaks y in fig 6 as shown in fig 14 b the absolute values of time averaged lift coefficients c l mean of rotating circular cylinder are significantly larger than non rotating cylinder α 0 due to magnus effect seifert 2012 moreover the absolute values of c l mean increases with increasing α for the forced rotating cylinder in the range of 3 0 u 5 5 the absolute values of c l mean decrease first and then increase with the increase of reduced velocity for the cases of α 0 5 and 1 0 after that the absolute values of c l mean drop off and then maintain at a stable value when u 6 0 the similar tendency can be observed for the cases of α 1 5 in addition the time averaged lift coefficient keeps at zero for the non rotating case α 0 the time history of lift coefficient c l for α 0 when u 3 0 is presented in fig 15 the amplitude of c l stays around a small value of 0 26 and the time averaged lift coefficient is zero these result in a low standard deviation of lift coefficients and low amplitude response of the cylinder in y direction the time averaged drag coefficients c d mean of the cylinder in 2 dof fiv are shown in fig 16 the overall trend of c d mean rises first and then drops to a stabilized value with the increase of reduced velocity which is similar to that of a peaks x in fig 5 for α 0 0 5 and 1 0 c d mean increase rapidly over u when 3 0 u 5 0 and then decrease for 5 0 u 10 the increase and decrease of time averaged drag coefficients result in the increase and decrease of amplitude in x direction respectively which can be observed in fig 5 when u 10 c d mean is basically constant for above rotation rate the maximum c d mean is obtained at u 5 the value of which are 1 70 1 92 and 1 64 for α 0 0 5 and 1 0 respectively for α 1 5 c d mean increases to a maximum value of 1 32 from u 3 0 to u 6 0 and then it experiences a drop in the range of 6 0 u 9 0 when u 9 0 the time averaged drag coefficient rises slowly 4 6 near wake structure similar near wake structures were observed for 0 α 1 0 therefore only the near wake structures of α 1 0 and α 1 5 are presented in this section applying on one period of oscillation in y direction it should be noted that the cylinder is located at equilibrium position when t t n 0 00 for all cases and there is a tendency to move downwards at this moment fig 17 depicts the near wake structures of forced rotating cylinder for α 1 0 it should be noted that the color of red and blue in fig 17 represent the positive and negative vorticity in fluid field respectively red color means that the vortex rotates in counter clockwise direction on the contrary blue color denotes clockwise direction as shown in fig 17 a two vortices separate from the surface of rotating cylinder in one oscillation period when α 1 0 and u 4 0 to be more specific a single vortex s is shedding from the cylinder when it moves downward to maximum displacement at t t n 0 25 as the cylinder moves from the wave trough to the balance position t t n 0 25 0 50 another vortex generates during the further upward motion of the rotating cylinder t t n 0 50 0 75 it is observed that the generated vortex shedding from the surface of the cylinder this means the vortex pattern is 2s for this case the vortex pattern is always 2s for the increasing of u at α 1 0 but owing to the rotational speed increase with the rising of u for the same rotation rate the vortices stretch in the flow direction for the imposed rotation especially for the case of u 14 fig 17 d the vortices almost cannot separate and stretch to be two string wake areas as presented in fig 18 for the cases of α 1 5 the vortex shedding pattern is quite different from that of the cases of α 0 0 5 and 1 0 for sufficiently low reduced velocity u 4 0 fig 18 a the wake is narrow and no vortices shedding from the surface of rotating cylinder this phenomenon corresponds to the u pattern bourguet and lo jacono 2014 as u increases to 6 0 fig 18 b the vortex pattern translates to 2s and the vortices are stretched in flow direction after u 9 0 the shedding pattern manifest as u pattern again fig 18 c fig 18 d there is no vortex shedding from the cylinder and the wake dissipate along the flow direction due to the oscillation in flow direction there are significant differences between this work and the study of bourguet et al bourguet and lo jacono 2014 for near wake structure for the 2 dof oscillation cases the u pattern are mainly related to the high reduced velocity and low oscillating amplitude but for the case of 1 dof fiv the u pattern is also observed in the low frequency cases and exists in a relative wide range of oscillation amplitudes in addition the slight upward shift of the wake for the forced rotating cylinder is observed due to the anticlockwise rotation of the cylinder fig 1 essentially the shift of the wake is caused by the asymmetry which owing to the magnus effect 5 conclusions the 2 dof fivs of forced rotating cylinder are numerical investigated in the range of 3 0 u 14 1805 re 8430 the amplitude and frequency responses of cylinder in two oscillatory directions were presented and discussed the standard deviation of lift coefficient and time averaged drag coefficient were also analyzed to understand the oscillation of forced rotating cylinder in 2 dof thoroughly the xy trajectories and near wake structures were shown and illustrated the following conclusions can be drawn 1 the upper branch and lower branch of vortex induced vibration are clearly observed in the amplitude responses of the cylinder in y direction the amplitude in flow direction can be enhanced markedly by the effect of rotation but the amplitude in cross flow direction is weakened the maximum amplitudes are 0 330d α 0 5 u 5 0 and 0 611d α 0 u 5 0 in flow direction and cross flow direction respectively 2 for the non rotating cylinder the oscillating frequency in flow direction is twice of that in cross flow direction at the same velocity while the oscillating frequency in flow direction is the same with that in cross flow direction at the same reduced velocity for forced rotating cylinder 3 the elliptical shapes of xy trajectories for the rotating cylinder were observed due to the same oscillation frequency in flow direction and cross flow direction but the xy trajectories for non rotation cylinder are typical shapes which are similar to the outline of the number of 8 4 compared with the oscillation of the non rotating cylinder higher lift and drag coefficients for forced rotating cylinder are obtained due to the magnus effect which also leads to the skewing of the oscillation in cross flow direction 5 the 2s and u vortex patterns were observed for the 2 dof fiv of rotating circular cylinder the rotation of the cylinder in fiv can stretch the vortex shedding from the surface of the cylinder and this phenomenon is more obvious at high angular velocities moreover the wake of cylinder also skews in cross flow direction due to the effect of forced rotation acknowledgment the authors gratefully acknowledge the support from the national natural science foundation of china grant no 51776021 and fundamental research funds for the central universities grant no 106112016cdjxy145505 natural science foundation of chongqing china grant no cstc2016jcyja0255 
22411,the flow induced vibration fiv of a rotating circular cylinder in reduced velocity range of 3 0 u 14 is investigated numerically the forced rotating cylinder can freely vibrate in flow and cross flow directions the amplitude and frequency are analyzed to understand the effect of rotation on fiv the oscillation of cylinder is enhanced significantly by rotation in flow direction but the opposite phenomenon is observed in cross flow direction the maximum amplitudes of 0 363d in flow direction and 0 611d in cross flow direction are obtained the skewing of vibration in cross flow direction is observed due to magnus effect and the time averaged displacement of rotating cylinder in cross flow direction increases monotonously with the rotation rate α meanwhile same frequencies in two directions are observed for rotating cylinder which leads to closed loop trajectories that are quite different from the situations of non rotating cylinder for different α the frequency ratios in cross flow direction stay around 1 1 when u 6 0 except for α 1 0 the trajectories also reflect the instability of vibration for high reduced velocity due to the asymmetry generated by the rotation large lift and drag force coefficients are obtained the 2s and u vortex patterns are observed for the fiv of rotating circular cylinder keywords flow induced vibration two degree of freedom rotation magnus effect circular cylinder 1 introduction the phenomenon of flow past bluff bodies is widespread in both nature and industry such as in heat exchangers cooling tower in power plant long span suspension bridges and marine risers chen et al 2018a narendran et al 2018 avila sanchez et al 2017 turmo and luco 2010 the elastically mounted bluff bodies will experience flow induced vibration fiv when they are exposed to transverse fluid flow in most cases fiv needs to be suppressed to avoid fatigue damage to structures low and srinil 2016 the responses control and suppression of fiv have drawn great interests from researchers zhu and gao 2017 huera huarte 2017 ma and srinil 2017 kumar et al 2018 for contrary purpose it is necessary to enhance oscillation when extracting clean energy including wind energy and hydroenergy by fiv ding et al 2018 kim and bernitsas 2016 hu et al 2019 therefore the control of fiv is necessary for different purposes and the rotation of bluff body is one of the simplest controlling methods moreover the fiv of rotatory cylinder can be observed in the rotating slender structure exposed to current in offshore engineering and deep water drilling yan et al 2015 therefore the rotation of cylinder in fiv with two degrees of freedom 2 dof has been studied due to its important role in energy harvesting and suppression of fatigue damage the one degree of freedom 1 dof fiv of cylinder has been investigated extensively in simulation and experiment by many researchers chen et al 2018b ding et al 2013 2015a focusing on the responses of fiv in terms of the amplitude and frequency response characteristics viv vortex induced vibration is one kind of the common fiv phenomena which is a self exciting self limiting phenomenon brika and laneville 2006 yang et al 2019 navrose 2017 pigazzini et al 2018 three typical regions of viv for circular cylinder can been observed in the amplitude responses including the viv initial branch upper branch and lower branch williamson and govardhan 2004 munir et al 2018 three dimensional numerical investigate the 1 dof viv responses of forced rotating cylinder when reynolds number is 500 they found that the lock in regime for forced rotation cylinder is wider than that of non rotating cylinder resonance will be caused when the vortex shedding frequency is close to the natural frequency of the system and large amplitude of the oscillation can be achieved in the condition of 1 dof for the cylinder with asymmetry factor such as rotation the unstable force on cylinder will cause galloping and lead to high amplitude of fiv as well ding et al 2013 2015a 2015b chang et al 2011 compared to 1 dof fiv the oscillatory response of cylinders are quite different when 2 dof motions of the cylinders are allowed in most cases of 2 dof the amplitude of fiv in cross flow direction is much larger than that in flow direction pastrana et al 2018 yu et al 2018 kang et al 2018 this would lead to spindly trajectories in addition the trajectories of cylinder in fiv can be influenced by natural frequencies of the oscillatory system kang et al 2016 found that the oscillating frequency in two directions have more than one domain frequency and the trajectories of cylinder were significantly different from the traditional 8 shape the 8 shape trajectories indicate the oscillatory frequency in flow direction is twice of that in cross flow direction when considering the forced rotation of cylinder in fiv under 2 dof vibration the amplitude response and trajectory will be more complicated however only 1 dof has been considered in most studies of fiv for a rotating cylinder bourguet and lo jacono 2014 wong et al 2018 wong et al 2017 relatively few studies have considered the rotation of cylinder in fiv under the condition of 2 dof zhao et al 2014 found that the rotation of cylinder would lead to single closed loop trajectories in 2 dof fiv due to same value of the oscillating frequencies in the two directions they also found that the amplitude responses of rotating cylinder are different from that of no rotation cylinder and amplitude of forced rotation cylinder in flow direction increases significantly in 2 dof fiv forced rotation of non oscillating cylinder is also studied to obtain the influence of rotation of the cylinder to vortex shedding mittal and kumar 2003 naik et al 2017 padrino and joseph 2006 the vortex pattern is depending on the reynolds number and nondimensionalised rotation rate the nondimensionalised rotation rate α is defined as α d ω 2u where ω is the angular velocity of the rotating circular cylinder d is the diameter of the rotating cylinder u is the velocity of incoming flow the review of rao et al 2015 detailed summarized differences of two steady states for α 7 0 and reynolds numbers re 400 namely steady state i and steady state ii which are classified depending on the vortex pattern and the vortex induced force acting on the cylinder most of the studies for rotating cylinder in fiv are focused on the amplitude response and trajectory of cylinder wong et al 2017 investigated the forced rotation cylinder in 1 dof fiv by experiment and found that the rotation can enhance vibration when compared with the amplitude response of non rotating cylinder moreover the studies of forced rotating cylinder in fiv were mostly under low reynolds number and only allowed for motion in the cross flow direction in industrial applications the turbulence flow is more common to encounter and the oscillation in 2 dof is more applicable therefore a relative higher reynolds number range of 1805 re 8430 is considered for the 2 dof fiv of a rotating circular cylinder in this study a series of numerical simulations are conducted to understand the influence of rotation rate on 2 dof fiv and the simulation results of 2 dof fiv are compared with experimental data of 1 dof fiv from others wong et al 2017 the physical model and numerical approach are presented in section 2 and 3 respectively the results including amplitude and frequency responses the time averaged displacements tracks of cylinder lift and drag coefficients and near wake structures are presented and discussed in section 4 conclusions are drawn in section 5 2 physical model the physical model of the oscillatory systems is depicted in fig 1 the compositions of the fiv system are a rigid rotating circular cylinder of diameter d supporting linear springs of stiffness k 1 x direction and k 2 y direction and the system dampings c 1 x direction and c 2 y direction due to friction the circular cylinder is forced to rotate in the anticlockwise around its axis in an angular velocity which depends on the rotation rate α defined as α d ω 2u where ω is the angular velocity of the rotating circular cylinder the uniform incoming fluid flows in x direction and its velocity is u the rotating cylinder can move freely in the x direction and y direction the equilibrium position of oscillation in this model will move to the negative y direction due the unbalanced force by effect of rotation the parameters of spring and damping are the same in two oscillatory directions the mass ratio is defined as m m system m water where m system is the mass of the cylinder and m water is the displaced mass of the fluid the value of m is considered as 5 78 in this paper for the convenience of comparison which is the same as the value in the experiment of wong et al 2017 all the system parameters are listed in table 1 3 numerical approach 3 1 governing equations of fluid mechanics to describe the incompressible and turbulent flow the two dimensional unsteady reynolds averaged navier stokes urans equations and the stranded k ε turbulence model are applied to obtain flow parameters in the present study the simulations are conducted by commercial cfd software of fluent and combine the user define function udf the governing equations can be expressed as 1 u i x i 0 2 ρ u i u i x j x j p δ i j μ u i x j u j x i ρ u i u j where the reynolds stress tensor τ i j u i u j and u i u j is the reynolds stresses which are defined as 3 u i u j ν t s i j 2 3 δ i j k in which 4 s i j 1 2 u i x j u j x i 5 ν t c μ k 2 ε where x i is the coordinate in the direction i u is the velocity in x direction ρ is the fluid density p is pressure ν t is the turbulence kinematic viscosity c μ is a constant value of 0 09 s ij is the mean strain rate tensor and k is the turbulence kinetic energy which is defined as 6 k 1 2 u i u i for the k ε turbulence model singhal and spalding 1981 the parameters of k and ε are calculated by the navier stokes n s equations the transport of k and ε can be expressed as 7 k t u j k x j x j ν ν t σ k k x j g ε 8 ε t u j ε x j x j ν ν t σ ε ε x j c ε 1 ε k g c ε 2 ε 2 k where u j means the velocity component in y direction g is defined as 9 g u i u j u i x j ν t u j x i u i x j u i x j in eq 7 and eq 8 c ε1 c ε2 σ k and σ ε are constants 3 2 kinematic equation and discrete method the oscillating system is simplified as a typical mass spring damper system which is used to describe the cylinder s oscillation in fiv so the equations of motion in x direction and y direction can be expressed as 10 m s y s t e m x c 1 x k 1 x f f l u i d x 11 m s y s t e m y c 2 y k 2 y f f l u i d y where m system is the inertial mass of the oscillation system f fluid x and f fluid y are the fluid force acting on the cylinder in the x direction and y direction respectively x x and x are displacement velocity and acceleration of the cylinder in x direction and y y and y are displacement velocity and acceleration of the cylinder in y direction c 1 and c 2 are the system damping in x direction and y direction for the oscillatory cylinder the velocities are defined as 12 υ x t x t 13 υ y t y t the initial conditions for the forced rotating cylinder are 14 υ x 0 υ y 0 0 15 x 0 y 0 0 for eq 11 the periodic forces acting on the cylinder are f fluid x and f fluid y respective the drag force and lift forces respectively for one calculating step eq 1 and eq 2 are solved and then the value of f fluid x and f fluid y are calculated by integrating the pressure and viscous forces over the surface of the forced rotating cylinder when f fluid x and f fluid y are obtained the above two equations can be discreted by the method of fourth order runge kutta in the y direction eq 11 can be expressed as 16 y t n 1 y t n δ t 6 k 1 2 k 2 2 k 3 k 4 17 y t n 1 y t n υ y t n δ t δ t 2 6 k 1 k 2 k 3 in which 18 k 1 f f l u i d y t n m s y s t e m c 2 m s y s t e m υ y t n δ t k 2 m s y s t e m y t n 19 k 2 f f l u i d y t n m s y s t e m c 2 m s y s t e m υ y t n δ t 2 k 1 k 2 m s y s t e m y t n δ t 2 υ y t n 20 k 3 f f l u i d y t n m s y s t e m c 2 m s y s t e m υ y t n δ t 2 k 2 k 2 m s y s t e m y t n δ t 2 υ y t n δ t 2 4 k 1 21 k 4 f f l u i d y t n m s y s t e m c 2 m s y s t e m υ y t n k 3 δ t k 2 m s y s t e m y t n δ t 2 υ y t n δ t 2 2 k 2 where k 1 k 2 k 3 and k 4 are fourth order runge kutta coefficients υ y is the velocity of cylinder in y direction δt is time step eq 17 can be calculated when combined with the initial conditions eq 12 to eq 15 the motion of cylinder is determined by user defined functions udfs to ensure the accuracy of calculation for rotating cylinder the time step δt is set as 0 004s in this work naik et al 2017 3 3 computational domain and grid generation the size of computational domain is 8d l 2h for the rotating cylinder system as shown in fig 2 at the initial condition the center of cylinder is 8d away from the boundary of inlet and the distance between the cylinder and outlet in flow direction is l the cylinder is located at the center of the computational domain in cross flow direction the distance of h between the cylinder and top is the same as that between the cylinder and bottom the value of h and l should be large enough to ensure the accuracy of the results for simulations however the oversize of the two distances would cost too much computing resources and time to balance the two requirements a series of grid sensitivity studies were conducted and the optimal value of h and l are analyzed separately see in this section the boundary condition of inlet is set as uniform velocity the outlet condition is zero gradient for velocity u y 0 v y 0 the boundary conditions of top and bottom are specified as a no slip wall thus u y 0 and v 0 the no slip condition is applied on the surface of the forced rotating cylinder overlapped grids are applied in this work which need two sets of mesh background mesh and append mesh there is an internal boundary which define as overset whose role is to transfer data between background mesh and append mesh fig 3 a shows the part of background mesh in optimal size of computational domain and maximum mesh density which is static and structured the grid of the cylinder s motion area and the wake area are refined to capture the accurate oscillation of the cylinder and the wake structures where the mesh density is maximum in background mesh fig 3 b shows the append mesh which is moving with the oscillatory cylinder and still structured the layer grid is applied around the cylinder to obtain the accuracy of the layer motion for the first layer thickness in the radial direction is δy and the growth factor is 1 1 the stranded k ε solver require y plus of close to 30 δy can be carried out by the equation stated by pope 2001 22 y 0 172 δ y d r e 0 9 where d is diameter of the rotating cylinder the value of δy depends on the reynolds number and for different re the thickness of the first layer is not a constant but vary with the reynolds number 1805 re 8430 in this paper the thickness of the first layer δy 0 001533 m thus 0 0511d corresponds the highest re 8430 depending on the different δy a series of mesh is generated for the simulations in order to obtain appropriate mesh to gain both accurate resolution and acceptable computing time the validation studies of the mesh density and the size for computation domain were conducted the validation studies were accomplished when the reduced velocity u u f n d 5 0 re 3000 α 0 the mesh density was represented by the minimal mesh size δh of background mesh a firstly capture the optimal mesh density due to the density of background mesh corresponds to that of append mesh the background mesh and append mesh have been validated simultaneously in this step the computational domain was fixed at a large size of 8d 25d 36d the mesh density can be characterized by the minimum mesh size and three different mesh sizes of 0 01d 0 02d and 0 04d were used to discretize the domain as shown in table 2 a the optimal minimal background mesh size of 0 02d was selected after overall consideration for a peaks x d a peaks x d the rms lift coefficient is defined as c l r m s 1 t o s c 0 t o s c c l 2 t d t where c l 2f fluid y ρu 2 dl and t osc is the period of vibration and the time averaged drag coefficient is c d m e a n 1 t o s c 0 t o s c c d t d t where c d 2f fluid x ρu 2 dl b secondly capture the optimal height of computational domain the height of the computational domain corresponds to the height of background mesh in this step kept the minimal background mesh size was kept at 0 02d and the wake region length l at a large size of 25d then the cross flow height h was changed 10d 15d 18d to obtain optimal value in this step the simulated results are shown in table 2 b the optimal h of 15d was selected by comparing the results of amplitudes and force coefficients in different cases c lastly capture the optimal length of wake region during this process the cross flow direction size was fixed at 2 15d and minimal background mesh size was still kept at 0 02d three wake region length of 15d 20d and 25d were investigated in this step the force coefficients and the amplitude ratios for each case are shown in table 2 c the percentage change in the values was less than 1 when the flow direction length was changed from 20d to 25d this means that l 20d was found suitable for the work in conclusion the optimal computational domain size of 8d 20d 30d and the minimal background mesh size of 0 02d were confirmed 3 4 validation the simulations of fiv only in cross flow direction were carried out when α 0 1 0 and 1 5 for validation the simulation results were compared with the experimental work by wong et al 2017 it is worthy noted that all the parameters which are used in validation cases are exactly the same with that of the experiments wong et al 2017 the results of amplitude and frequency as presented in fig 4 show that the 1 dof fiv responses of cylinder match well with experimental tests for all the cases tested in this section the three branches which are viv initial branch upper branch and lower branch can be clearly observed when u 12 the oscillation of the circular cylinder is suppressed seriously and a peaks y 0 in this range the frequency ratio of α 0 increases with the reduced velocity when 3 0 u 7 0 then the frequency ratio f stays around 1 1 in the range of 7 0 u 9 0 when u 9 0 a slight rise of frequency is observed as for the cases of α 1 0 and 1 5 the value of f increases rapidly with the increase of reduced velocity in the range of 3 0 u 6 0 and then increases slowly in the range of 6 0 u 10 therefore the computational schemes proved to be reliable by comparison between the computational results and the experimental ones the numerical method used in this work is an effective method 4 results and discussions in order to understand the behavior of 2 dof fiv of a forced rotating cylinder the results of numerical simulations are presented and discussed in this section the amplitude and frequency responses are the most important parameters to describe the strength of oscillation in fiv for comparison purposes all the amplitudes in this paper are made nondimensional by the diameter of cylinder therefore the amplitude responses are analyzed by the amplitude ratios in x direction a peaks x defined as a peaks x a peaks x d and y direction a peaks y defined as a peaks y a peaks y d it should be noted that time averaged displacement was subtracted for the calculation of amplitudes in subsection 4 1 to further analyze the fiv of forced rotating circular cylinder drag and lift coefficients the tracks for oscillating cylinder and wake structures are discussed in this section the results of wong et al 2017 and bourguet et al bourguet and lo jacono 2014 are presented for comparison as well 4 1 amplitude response for different u reduced velocity and rotation rate α the amplitude ratio of the circular cylinder in x direction a peaks x is shown in fig 5 the amplitude of non rotating cylinder α 0 is also shown for comparison the overall trend in the amplitude ratios is that the amplitude ratio increases firstly and then decreases to a stable value with the increasing of reduced velocity u the trends of the amplitude in x direction for different rotation rates are similar however there are large gaps of maximum amplitude value between different rotation rates for α 0 non rotating the amplitude ratios in x direction a peaks x is generally much less than that of α 0 5 1 0 and 1 5 at most u which are basically in the range of 0 a peaks x 0 013 the maximum amplitude ratio of 0 013 is obtained when u 5 0 for α 0 5 when α 0 5 the amplitude ratios increase rapidly compared with α 0 a peaks x increases rapidly from almost 0 to 0 363 when 3 0 u 5 0 and then experiences a quick drop in the range of 5 0 u 8 0 when u 8 0 the amplitude ratios almost remain unchanged and the value are a little higher than 0 when α 1 0 the trend of the amplitude ratio is the same with the case of α 0 5 and a maximum amplitude of 0 363d is obtained at u 5 0 for α 1 5 a peaks x continues to rise in a reduced velocity range of 3 0 u 4 5 and reaches a maximum value of 0 267 at u 4 5 but for 4 5 u 7 0 the amplitude ratio drops to almost 0 the results of amplitude ratio in y direction a peaks y d for present work and wong et al 2017 are shown in fig 6 the amplitude in y direction of forced rotating cylinder with 2 dof oscillation is smaller than that for only one degree of freedom in most cases the maximum amplitude ratio is also lower than that of 1 dof for the same α three branches including initial branch upper branch and lower branch are observed in amplitude responses as shown in fig 6 the initial branches in the simulations are hardly observed for the experiment the oscillation in cross flow direction is enhanced by the effects of rotation over a broad range of u especially for α 1 5 on the contrary the oscillation in y direction is suppressed for the case of 2 dof the overall trends of a peaks y increase first and then decrease with the rising of u to be more specific the increasing range of a peaks y for α 0 is 3 0 u 5 0 and the increasing ranges are 3 0 u 4 5 for cases of α 0 5 the maximum amplitudes are 0 611d for α 0 0 561d for α 0 5 0 482d for α 1 0 and 0 315d for α 1 5 compared with the fiv in 1 dof the a peaks y of the rotating cylinder in cross flow direction for 2 dof is significantly smaller for most velocities especially for u 8 0 when α 1 5 it indicates that the higher rotation rate can result in the suppression of oscillation in y direction 4 2 time averaged displacement responses due to the drag force and the magnus effect caused by rotation the equilibrium position in two directions do not stay at the initial position thus the time averaged displacements in two directions is not equal to zero the time averaged displacements of the rotating cylinder in two directions are shown in fig 7 and fig 8 the cylinder will migrate in flow direction due to the dynamic pressure on cylinder time averaged displacement of rotating cylinder in x direction is x mean and it increases monotonously with u moreover the rate of increase grows the values of x mean for α 0 0 5 and 1 0 are very close at the same u but x mean for α 1 5 is smaller than that of other α in the range of 3 0 u 8 0 the contrary tendency can be observed in the region of 8 0 u 14 this means the rotation rate almost do not affect the equilibrium position in x direction and the maximum x mean of α 0 0 5 1 0 and 1 5 are 0 422d 0 437d 0 439d and 0 580d respectively it is noted that there are some small fluctuations of the time averaged displacement in the range of 4 0 u 8 0 for α 0 0 5 and 1 0 as shown in fig 8 the equilibrium position in y direction almost keep in the initial position when α 0 non rotating thus y mean 0 the lift force of rotating cylinder increases with α due to magnus effect seifert 2012 which leads to the magnitude of time averaged displacement also increases with α compared with the 1 dof fiv of rotating cylinder bourguet and lo jacono 2014 y mean of rotating cylinder in 2 dof is larger for the same rotation rate except for α 0 and the maximum time averaged displacement is y mean 1 183d when α 1 5 and u 14 for 2 dof fiv 4 3 frequency response it was found that the value of oscillatory frequency in cross direction is the same as that in flow direction when the cylinder is forced to rotate as for the non rotation cases the frequency in x direction is the twice of that in y direction therefore only the frequency in y direction is presented for the sake of brevity the frequency ratio reduced nondimensional frequency is defined as f f osc f n water to describe the frequency responses of forced rotating cylinder in this paper the first order oscillation frequency f osc of the cylinder is carried out by fast fourier transform over the time history displacement of the rotating cylinder as shown in fig 9 a the frequency ratio of forced rotating cylinder is presented as a function of reduced velocity and rotation rate the frequency ratios of 1 dof cases by wong et al 2017 are also presented for comparison the frequency ratios increase in low velocity range and then maintaining stability the frequency ratio of non rotating cylinder in 2 dof α 0 increases monotonously to 1 16 for 3 0 u 6 0 and fluctuates within a narrow range compared to 1 dof fiv f for 2 dof cases are higher in the range of 3 0 u 8 0 for α 0 5 the similar trend is observed except for u 11 different from the results of α 0 and 0 5 the frequencies ratios of α 1 0 and α 1 5 are higher when u 8 0 even reach 1 39 for α 1 0 at u 13 it is noted that irregularities for the oscillation for forced rotating cylinder is widespread for all the interest rotation rates when u 11 such as the case of α 0 5 when u 13 the time history displacement of which is presented in fig 9 b in addition the transition in the curve of time history displacements is caused by the setting of initial condition in simulation and it does not affect the cfd result 4 4 trajectories of rotating cylinder in fiv the motion of the cylinder can be described visualized by the trajectory of each case in this section the xy trajectories of cylinder are plotted in fig 10 to fig 13 according to different rotation rates as shown in fig 10 the trajectories for non rotation cylinder are typical 8 shapes which similar to the outline of number 8 when 4 0 u 8 0 the 8 shape of the trajectories for 2 dof fiv were also observed in previous studies munir et al 2018 zhao and cheng 2011 gsell et al 2016 this phenomenon is caused by the different oscillatory frequency and amplitude in x direction and y direction the trajectories show that the tendency of amplitude increases first and then decreases with the rising of u in y directions which is match with the tendencies of figs 5 and 6 the trajectories also show that the equilibrium position of non rotation cylinder always stays at x 0 which means that the time averaged displacements of non rotation cylinder keeps at zero as observed in fig 8 the shape of the oscillation trajectories also shows that the motion frequency in the flow direction is the double of that in the y direction for α 0 in addition the center of the trajectories for non rotation cylinder are located in the line of a y d 0 which is also match with the time averaged displacement in fig 8 when the circular cylinder is forced to rotate anticlockwise with a rotation rate of α 0 5 1 0 and 1 5 the trajectories of oscillation are plotted in fig 11 fig 13 the trajectories of the cylinder in the lock in regime 4 0 u 8 0 for α 0 5 1 0 and 1 5 corresponds to a circular closed loop which are entirely different from that of α 0 these xy trajectories show that the vibration frequencies of cylinder are same in two directions it should be noted that the length width ratio of the trajectories decreases as α increases which means that the value of the amplitude in two directions is getting closer when the rotation rate increases can be verified by comparing fig 5 with fig 6 in addition the size of the trajectories increases first and then decreases with the increasing of u the shape of trajectories is not always similar to a single ellipse when u 8 0 for example the xy trajectory of u 12 for α 0 5 the reason for existence of irregular trajectory is that the oscillation of the rotating cylinder for higher reduced velocity is unsteady the vortex structures for higher reduced velocities also show that the vortex shedding is more complex when compared with the situation of lower u the centroids of trajectories for forced rotation cylinder get further and further away from the initial position x 0 y 0 with the increasing of u and α the phenomenon is caused by the magnus effect and the tendency correspond with the results of time averaged displacements in figs 7 and 8 4 5 lift and drag coefficients in order to understand the correlation between the force coefficient and the vibration the standard deviation σ cl and time averaged value of lift coefficients c l mean are discussed in this section as shown in fig 14 a the standard deviation σ cl increase sharply first and then decrease to a stable value with the increases of u for all rotation rates for the cases of α 0 and 1 5 the maximum values of σ cl can be obtained when u 4 0 which are σ cl max 0 64 and 1 28 respectively and the standard deviation peaks at u 4 5 for the cases of α 0 5 and 1 0 the maximum values are σ cl max 1 61 and 1 59 respectively when u 6 0 σ cl almost keep at a stable value which is lower than 0 2 for all the cases the high amplitude responses of the cylinder are partly contributed by the large standard deviation of lift coefficients the standard deviation of lift coefficients represents the oscillation part of c l which leads to the oscillation of the rotation cylinder in y directions and this is the reason why the variation tendencies of σ cl shown in fig 14 a correspond to that of a peaks y in fig 6 as shown in fig 14 b the absolute values of time averaged lift coefficients c l mean of rotating circular cylinder are significantly larger than non rotating cylinder α 0 due to magnus effect seifert 2012 moreover the absolute values of c l mean increases with increasing α for the forced rotating cylinder in the range of 3 0 u 5 5 the absolute values of c l mean decrease first and then increase with the increase of reduced velocity for the cases of α 0 5 and 1 0 after that the absolute values of c l mean drop off and then maintain at a stable value when u 6 0 the similar tendency can be observed for the cases of α 1 5 in addition the time averaged lift coefficient keeps at zero for the non rotating case α 0 the time history of lift coefficient c l for α 0 when u 3 0 is presented in fig 15 the amplitude of c l stays around a small value of 0 26 and the time averaged lift coefficient is zero these result in a low standard deviation of lift coefficients and low amplitude response of the cylinder in y direction the time averaged drag coefficients c d mean of the cylinder in 2 dof fiv are shown in fig 16 the overall trend of c d mean rises first and then drops to a stabilized value with the increase of reduced velocity which is similar to that of a peaks x in fig 5 for α 0 0 5 and 1 0 c d mean increase rapidly over u when 3 0 u 5 0 and then decrease for 5 0 u 10 the increase and decrease of time averaged drag coefficients result in the increase and decrease of amplitude in x direction respectively which can be observed in fig 5 when u 10 c d mean is basically constant for above rotation rate the maximum c d mean is obtained at u 5 the value of which are 1 70 1 92 and 1 64 for α 0 0 5 and 1 0 respectively for α 1 5 c d mean increases to a maximum value of 1 32 from u 3 0 to u 6 0 and then it experiences a drop in the range of 6 0 u 9 0 when u 9 0 the time averaged drag coefficient rises slowly 4 6 near wake structure similar near wake structures were observed for 0 α 1 0 therefore only the near wake structures of α 1 0 and α 1 5 are presented in this section applying on one period of oscillation in y direction it should be noted that the cylinder is located at equilibrium position when t t n 0 00 for all cases and there is a tendency to move downwards at this moment fig 17 depicts the near wake structures of forced rotating cylinder for α 1 0 it should be noted that the color of red and blue in fig 17 represent the positive and negative vorticity in fluid field respectively red color means that the vortex rotates in counter clockwise direction on the contrary blue color denotes clockwise direction as shown in fig 17 a two vortices separate from the surface of rotating cylinder in one oscillation period when α 1 0 and u 4 0 to be more specific a single vortex s is shedding from the cylinder when it moves downward to maximum displacement at t t n 0 25 as the cylinder moves from the wave trough to the balance position t t n 0 25 0 50 another vortex generates during the further upward motion of the rotating cylinder t t n 0 50 0 75 it is observed that the generated vortex shedding from the surface of the cylinder this means the vortex pattern is 2s for this case the vortex pattern is always 2s for the increasing of u at α 1 0 but owing to the rotational speed increase with the rising of u for the same rotation rate the vortices stretch in the flow direction for the imposed rotation especially for the case of u 14 fig 17 d the vortices almost cannot separate and stretch to be two string wake areas as presented in fig 18 for the cases of α 1 5 the vortex shedding pattern is quite different from that of the cases of α 0 0 5 and 1 0 for sufficiently low reduced velocity u 4 0 fig 18 a the wake is narrow and no vortices shedding from the surface of rotating cylinder this phenomenon corresponds to the u pattern bourguet and lo jacono 2014 as u increases to 6 0 fig 18 b the vortex pattern translates to 2s and the vortices are stretched in flow direction after u 9 0 the shedding pattern manifest as u pattern again fig 18 c fig 18 d there is no vortex shedding from the cylinder and the wake dissipate along the flow direction due to the oscillation in flow direction there are significant differences between this work and the study of bourguet et al bourguet and lo jacono 2014 for near wake structure for the 2 dof oscillation cases the u pattern are mainly related to the high reduced velocity and low oscillating amplitude but for the case of 1 dof fiv the u pattern is also observed in the low frequency cases and exists in a relative wide range of oscillation amplitudes in addition the slight upward shift of the wake for the forced rotating cylinder is observed due to the anticlockwise rotation of the cylinder fig 1 essentially the shift of the wake is caused by the asymmetry which owing to the magnus effect 5 conclusions the 2 dof fivs of forced rotating cylinder are numerical investigated in the range of 3 0 u 14 1805 re 8430 the amplitude and frequency responses of cylinder in two oscillatory directions were presented and discussed the standard deviation of lift coefficient and time averaged drag coefficient were also analyzed to understand the oscillation of forced rotating cylinder in 2 dof thoroughly the xy trajectories and near wake structures were shown and illustrated the following conclusions can be drawn 1 the upper branch and lower branch of vortex induced vibration are clearly observed in the amplitude responses of the cylinder in y direction the amplitude in flow direction can be enhanced markedly by the effect of rotation but the amplitude in cross flow direction is weakened the maximum amplitudes are 0 330d α 0 5 u 5 0 and 0 611d α 0 u 5 0 in flow direction and cross flow direction respectively 2 for the non rotating cylinder the oscillating frequency in flow direction is twice of that in cross flow direction at the same velocity while the oscillating frequency in flow direction is the same with that in cross flow direction at the same reduced velocity for forced rotating cylinder 3 the elliptical shapes of xy trajectories for the rotating cylinder were observed due to the same oscillation frequency in flow direction and cross flow direction but the xy trajectories for non rotation cylinder are typical shapes which are similar to the outline of the number of 8 4 compared with the oscillation of the non rotating cylinder higher lift and drag coefficients for forced rotating cylinder are obtained due to the magnus effect which also leads to the skewing of the oscillation in cross flow direction 5 the 2s and u vortex patterns were observed for the 2 dof fiv of rotating circular cylinder the rotation of the cylinder in fiv can stretch the vortex shedding from the surface of the cylinder and this phenomenon is more obvious at high angular velocities moreover the wake of cylinder also skews in cross flow direction due to the effect of forced rotation acknowledgment the authors gratefully acknowledge the support from the national natural science foundation of china grant no 51776021 and fundamental research funds for the central universities grant no 106112016cdjxy145505 natural science foundation of chongqing china grant no cstc2016jcyja0255 
22412,underwater glider is one of the most promising autonomous observation platforms for long term ocean observation which can glide through water columns by adjusting its buoyancy and attitude in this paper gliding range of the petrel l underwater glider is increased by optimizing the motion parameters according to different observation missions the optimization is established to maximize the gliding range and minimize the energy consumption for one gliding cycle which is solved by the inner penalty function method ipfm based on the nonlinear variation rule of the buoyancy loss a hidden gliding strategy model hgsm is proposed and the optimization result indicates that it can increase the gliding range by 24 13 for petrel l when the power related with time is 0 2 w the optimization is applicable to other types of underwater gliders keywords motion parameter optimization gliding strategy analysis underwater glider 1 introduction driven by its net buoyancy underwater glider ug can glide through water columns by adjusting the buoyancy and the pitching angle bachmayer et al 2004 since the concept of ug was first demonstrated by stommel 1989 various underwater gliders including the slocum webb et al 2001 the seaglider eriksen et al 2001 and the spray sherman et al 2001 have been developed and widely applied in ocean observation for their temporal and spatial cruising ability rudnick et al 2004 new types of underwater gliders such as the deepglider osse and eriksen 2007 with 6000 m operating depth the zray d spain et al 2005 with heavy payload capability and the sea explorer claustre et al 2014 with high gliding velocity have been designed with the development of marine science a larger gliding range is required for the observation of some larger scale and longer lasting ocean phenomena stuntz et al 2016 though gliding range can be elongated by increasing the battery capacity in the limited internal space of the underwater glider it seems to be great significance to increase the gliding range through reducing energy consumption improving gliding strates and optimizing motion parameters this paper focuses on the motion parameter optimization and gliding strategy analysis of the underwater glider several research results have been reported in the literatures to increase the cruising ability and reduce the energy consumption which can be realized by optimized control and improved designs in terms of optimized control several typical researches are listed yu et al 2013 optimized gliding motion parameters and sensor scheduling to increase the gliding range of underwater gliders without considering the variation of net buoyancy in the gliding cycles xue et al 2018 proposed a multi layer coordinate control strategy of underwater gliders by optimizing the motion parameters huang et al 2018 improved the control and energy efficiency over the pitch angle adjustment by a self searching optimal active disturbance rejection control theory to increase the endurance of the thermal glider sang et al 2018 proposed a new hybrid heading tracking control algorithm to improve the adaptability and robustness of underwater glider s heading control claus and bachmayer 2016 presented an energy optimal depth controller design methodology for long range autonomous underwater vehicles with applications to a propeller driven hybrid ug during level flight yoon and kim 2016 formulated an optimal control problem for an underwater glider by considering depth constraints into a nonlinear two point boundary value problem with inequality constraints which was solved by numerical methods liu et al 2017 developed an optimal three dimensional path planning method for low energy consumption miller 2018 applied the bio inspired energy utilization strates to the underwater vehicles to achieve a 10 40 range promotion the following studies focused on the optimal design to increase the cruising ability and reduce the energy consumption fu et al 2018 proposed a multi objective shape optimization scheme of underwater gliders for low drag high efficiency low energy consumption and long voyage li et al 2018 presented a simplified shape optimization strategy for blended wing body underwater gliders by which the lift to drag ratio is increased by 4 2 tang et al 2018 designed a neutrally buoyant pressure hull using bi directional evolutionary topology method to reduce the buoyancy loss he et al 2017 carried out a multi objective optimization of a multi bubble pressure cabin in the underwater glider with blended wing body using kriging and the non dominated sorting genetic algorithm wang et al 2017 adopted the design of experiment doe theory to solve the multi objective design optimization of the underwater glider which improved the hydrodynamic performance by 9 1 although the above investigations have provided numerous results related to the optimization design there exist the following problems 1 the net buoyancy variation is not taken into account in the motion parameter optimization in the previous works which affects the gliding motion state and is influenced by the deformation of the pressure hull and the density variation of the seawater yang et al 2017 2 integrated with the ctds turbulence sensors acoustic sensors and biochemical sensors underwater gliders have been widely applied in the mesoscale eddy observation the submesoscale eddy observation the internal wave observation and the turbulent microstructure observation rudnick 2016 the power of the carried sensors is necessary to be analyzed in the optimization which has a significant impact on the gliding range 3 since the physical parameters of the seawater including density and temperature show nonlinear variation with the depth therefore the conventional gliding strategy model cgsm in the previous optimization may not be the optimal gliding strategy for the largest gliding range which needs to be analyzed in this paper an efficient method is developed to increase the gliding range of underwater gliders by optimizing the motion parameters and analyzing the gliding strategy compared with the existing work the main contributions of this paper are in two aspects 1 an optimization method is established to increase the gliding range which takes the variation of the net buoyancy into account and analyzes the effect of the power of the carried sensors on the optimized motion parameters based on the different observation missions the optimization is constructed by the kinematic model in the vertical plane two gliding strategy model and an energy consumption model the objective of the optimization is maximizing the gliding range and minimizing the energy consumption which is solved by the ipfm and the trend of the optimized motion parameters for the different temporal power is researched 2 a hidden gliding strategy model hgsm is presented by analyzing the nonlinear variation trend of the buoyancy loss the application effect of which on improving the gliding range is analyzed in comparison with the cgsm this paper is organized as follows section 2 introduces the petrel l underwater glider for modeling in section 3 the mathematical model is derived based on the kinematical model of glider motion in vertical plane the gliding strategy model and the energy consumption model in section 4 an optimization is established to analyze how to control the motion parameters for the largest gliding range in section 5 the optimization results and discussions are introduced in section 6 a sea trail is carried out to verify the validity of the optimization finally section 7 concludes the paper 2 the petrel l underwater glider the petrel l shown in fig 1 is an underwater glider developed by tianjin university china it consists of a cylindrical pressure hull to which the emergency device fixed wings two fairings and a trailing antenna are attached the subsystems inside the pressure hull include the buoyancy regulating unit pitch regulating unit roll regulating unit control unit communication and navigation unit and battery pack table 1 shows the main technical specifications of petrel l as a core part of the petrel l the buoyancy regulating unit consists of an external bladder an internal reservoir some hydraulic valves a displacement sensor a pressurized gear pump and a high pressure plunger pump the pumps and valves can adjust the oil volume of the external bladder to change the buoyancy of the glider and thus drive its vertical motion the displacement sensor monitors the oil volume of the internal reservoir when the buoyancy regulating unit works during gliding the attitude angles of glider including the pitching angle the roll angle and the heading are adjusted by an internal translational and rotational battery pack which can change the position of mass center of the underwater glider hence the glider dives and climbs in a zigzag trajectory through the seawater 3 modeling of the petrel l underwater glider 3 1 buoyancy loss of petrel l as the glider ascends higher in the water column and the pressure relaxes it becomes less buoyant because the hull is less compressible than seawater jenkins et al 2003 therefore the net buoyancy decreases gradually in the diving phase and the climbing phase this phenomenon is obvious particularly when the glider goes across the thermocline where the seawater density changes sharply in the gliding motion the buoyancy loss b glider is decided by the buoyancy of the glider which is mainly related to the volume of the pressure hull and the density of the seawater the buoyancy loss of the glider can be calculated as 1 δ b glider z ρ z v z g ρ 0 v 0 g here v z is the volume of the glider under the hydrostatic pressure of the seawater v 0 is the volume of petrel l under the atmospheric pressure which is 91 l ρ z is the density of seawater varying with the depth and ρ 0 is 1021 8 kg m3 according to the international gravity formula proposed by moritz 1984 the acceleration of gravity g is considered as 9 8 kg m3 because it varies little with the latitude and the height relative to sea level the seawater density varies with temperature salinity and pressure in this paper the density is considered as a variable changing with the depth z and can be obtained by the sea trial data in south china sea the quartic polynomial fitted curve is described in fig 2 the maximum value is 1031 98 kg m3 at the depth of 1000 m and the minimum value ρ 0 is 1021 8 kg m3 at sea surface the expression of the density can be described as 2 ρ z z p 1 z 4 p 2 z 3 p 3 z 2 p 4 z p 5 where z is the depth of the seawater and the fitted coefficients p i i 1 5 are 4 8547 10 11 1 1823 10 7 1 0165 10 4 0 0422 and 1021 6 respectively when the glider glides through the water columns the temperature and pressure change gradually which leads to the thermal stress and hydrostatic stress applied on the pressure hull the temperature variation with the depth observed by petrel l in the south china sea can be described by a quartic polynomial analogously and the variation trend is shown in fig 3 3 t q 1 z 4 q 2 z 3 q 3 z 2 q 4 z q 5 where the fitted coefficients q i i 1 5 are 1 3811 10 10 3 4465 10 7 3 0883 10 4 0 1265 and 28 7196 respectively in this paper the finite element analysis code ansys workbench is adopted to analyze the deformation and volume variation of the pressure hull due to temperature and hydraulic pressure changes in the seawater firstly a steady state thermal model is adopted and the temperature difference is imported into the model then a static structural model is established and the analysis result of the steady state thermal model is imported what calls for special attention is that the pressure inputted in the static structural model needs to match the temperature inputted in the steady state thermal model according to the ocean environment moreover the effects of pressure and temperature on the volume variety are simulated to evaluate the influence of temperature fig 4 shows the effects of coupling pressure and temperature on the volume variety of the pressure hull respectively it can be seen from fig 4 that the effects of pressure and temperature are nonlinearly coupling moreover it is necessary to take the temperature into account in the volume variety simulation because the volume variety caused by temperature is 21 7 of that by coupling when the pressure is 10 mpa to validate the calculated result a pressure test is carried out to measure the strain of the pressure the strain gages are pasted on the internal face of the pressure hull and the environment temperature is 28 c during the test the temperature of water is 12 c fig 5 shows the pressure test and the result comparison which indicates the consistency between the simulation result and the test result the fitted quadratic can be calculated 4 δ v z z r 1 z 2 r 2 z 5 v z z v 0 δ v z where v z is the volume variation of the pressure hull and the coefficients r 1 and r 2 are 1 384 104 and 0 386675 respectively substitute eqs 2 4 and 5 into eq 1 and the buoyancy loss can be obtained 6 δ b glider z p 1 r 1 z 6 g p 1 r 2 p 2 r 1 z 5 g p 2 r 2 p 3 r 1 z 4 g p 3 r 2 p 4 r 1 z 3 g p 4 r 2 p 5 r 1 z 2 g p 5 r 2 z g ρ 0 v 0 g the buoyancy loss is described in fig 6 as shown in the figure there exists nonlinear variation and the net buoyancy decreases faster in the shallow sea than in deep sea because of the existence of the thermocline 3 2 gliding strategy modeling 3 2 1 the cgsm gliding strategy as shown in fig 7 the cgsm can be divided into five phases the diving preparation phase the diving phase the climbing preparation phase the climbing phase and the communication phase in the diving preparation phase the solenoid valve turns on and the hydraulic oil flows from the external bladder to the internal reservoir until the oil volume in the internal reservoir reaches the set value then the pitch regulating unit bns to adjust the pitching angle to a desired value and the diving phase bns during which the roll regulating unit adjusts the heading when the glider deviates from the target heading when the glider reaches the target depth the climbing preparation phase bns and the hydraulic oil is pumped back to the external bladder until the oil volume in the internal reservoir reaches the set value then the glider will climb and enter the climbing phase during which the pitch regulating unit and the roll regulating unit work interruptedly to control the attitude of the glider after arriving at the surface the communication phase bns during which the battery pack moves fully forward and the hydraulic oil is pumped to the external bladder the trailing antenna emerges from the surface and the pitching angle is larger than 45 in this phase the gps module and the iridium satellite communication module bn to work and we can get the position of the glider and control the glider by the iridium satellite communication 3 2 2 the hgsm gliding strategy the gliding model adopted mostly by the legacy underwater gliders is the cgsm the gliding efficiency of which is low because the net buoyancy changes sharply when the glider goes through the thermocline thus the buoyancy regulating unit has to pump extra oil to the external bladder to keep a certain gliding velocity jenkins et al 2003 in this work a hgsm shown in fig 8 is proposed in which the glider does not need to go through the thermocline for a few sequent gliding cycles this gliding strategy can be adopted when the glider is far from the sea area of the task for example the glider needs to move to the sea area of the next task when it has finished the current task moreover it can also be adopted to save the cost of the observation task when the sea area of the task is far from the coast and the glider is launched near the shore in the hgsm the minimum gliding depth needs to be confirmed below which the buoyancy loss rate is the lowest as expressed by eq 7 and fig 9 the minimum depth is 331 m below which the net buoyancy loss rate r net buoyancy loss per unit depth is 2 934 10 3 n m 7 r δ b glider z 1000 δ b glider 1000 z 3 3 mathematical modeling in vertical plane 3 3 1 mass distribution the mass configuration of a glider is critical because it moves in the seawater by adjusting its buoyancy shown in fig 10 the mass of a glider m consists of mass of the hull m h internal moving point mass m m and ballast mass m b the component m h is a fixed uniformly mass the vector r m and r b describes the position of the moving mass m m and ballast mass m b in the body fixed frame at time t the ballast mass m b1 and m b2 of the glider are the mass of fluid taken in during its descent and given out during its ascent respectively therefore the total mass of the diving phase and climbing phase is 8 m m h m m m b 1 m h m m m b 2 and the net buoyancy of the glider b is given by 9 δ b z m g ρ 0 z v 0 g δ b glider z if the b 0 then glider is neutrally buoyant the glider descends if b 0 and ascends if b 0 in order to maintain a steady glide the state variables of glider velocity gliding angle and angle of attack need remain constant 3 3 2 kinematic and dynamic model of glider motion petrel l glider is designed to have a separate control algorithm and actuators for controlling the lateral dynamics and vertical plane dynamics in this paper the vertical plane dynamics are controlled using the movable mass here the lateral dynamics can be ignored since a fixed back rudder is adopted to make the glider glide in a straight motion in a vertical plane and thus stabilize the dynamics experiments using the slocum glider show that the vertical plane steady glides are qualitatively consistent with the result of the model leonard and graver 2001 thus the study of the vertical plane dynamics as a representative of actual glider operation is useful leonard and graver 2001 derived the equation of motions of glider in the vertical plane and described the mathematical model of the steady state dynamics of glider in the vertical plane the kinematics of the vehicle can be explained based on fig 9 singh et al 2017 two frames the inertial frame e frame and the body frame b frame are required in the work of building dynamic model of the glider definition of the two frames is same as that of the common underwater vehicles wang et al 2015 sarkar et al 2016 the origins of the b frame coincide with the center of the buoyancy the e frame is fixed to a point on the sea surface in reference to e frame the velocity of the glider along x y and z axis is represented by u v and w respectively while the angular velocity of the glider along x y and z axis is represented by p q and s respectively all in b frame in fig 11 θ is the pitching angle angle between x axis of e frame and x axis of b frame α is the angle of attack angle between gliding velocity vector and x axis of b frame γ is the gliding angle angle between gliding velocity vector and x axis of e frame u is the gliding velocity l and d are vehicle lift and drag respectively when the glider descends γ and θ are positive and α is negative when the glider ascends γ and θ are negative and α is positive in order to ease the analysis process some restrictions have to be made to simplify the mass distribution on the glider graver 2005 pm denotes momentum of the moving mass in the b frame be represents the position in e frame while ω represent the angular velocity vector in b frame respectively r is the rotational matrix which defines the orientation of glider in b frame the control inputs to the system are the ballast rate u b internal force u m acting on the moving mass u mx represent the internal force acting on moving mass along z direction m fx and m fz represent the added mass along x and z axis respectively k m0 and k m are the zero moment coefficient and induced moment coefficient respectively i yy represents the mass moment of inertia along y axis the roll yaw and sway velocity terms are taken to be zero assuming zero side slip angles the hydrodynamic shear force is neglected the simplified parameters for motion are expressed in eq 10 as 10 b e x 0 z t ω 0 q 0 t u u 0 w t r m r m x 0 r m z r b r b x 0 r b z p m p m x 0 p m z u m u m x 0 u m z the velocity and the angular velocity in b frame can be expressed in e frame as 11 x 0 z r u 0 w 12 0 θ 0 r 0 q 0 where the modified equations of motion are represented in eq 13 as 13 x u cos θ w sin θ z u sin θ w cos θ α tan 1 w u θ q q 1 i y y m f z m f x u w r m x p m x r b x p b x r m z p m z q m m r m z g sin θ m m r m x m b r b x g cos θ m p r m z u m x r m x u m z u 1 m f x m f z w q p m z p b z q δ b g sin θ l sin α d cos α u m x w 1 m f z m f x w q p m x p b x q δ b g cos θ l cos α d sin α u m z r m x p m x m m u r m z q r m z p m z m m u r m x q p m x u m x p m z u m z m b u b m p represents the pitching angle moment the expression of which is 14 m p k m 0 k m α u 2 w 2 u is denoted as 15 u 2 u 2 w 2 3 3 3 mathematical model of the steady state gliding motion the kinematic and equilibrium relations follow from graver 2005 as 16 θ γ α δ b cos γ l δ b sin γ d the hydrodynamic drag and lift can be defined as 17 d k d 0 k d α 2 u 2 l k l 0 k l α u 2 where k d0 and k d are the zero angle of attack drag coefficient and induced drag coefficient respectively k l0 and k l are the zero angle of attack lift coefficient and induced lift coefficient respectively eqs 16 and 17 can be used to define the relation between α and γ as 18 tan γ d l k d 0 k d α 2 k l 0 k l α for a solution in the real number field one must have 19 k l tan γ 2 4 k d k d 0 k l 0 tan γ 0 when the equation is satisfied in eq 19 the solution of the tanγ is 20 tan γ 2 k d k l k l 0 k l k l 0 k l 2 k d 0 k d therefore the attainable value range of the gliding angle for a glider is 21 γ π 2 tan 1 2 k d k l k l 0 k l k l 0 k l 2 k d 0 k d tan 1 2 k d k l k l 0 k l k l 0 k l 2 k d 0 k d π 2 and the expression of α can be deduced by eq 18 22 α γ k l tan γ 2 k d 1 1 4 k d cot γ k d 0 cot γ k l 0 k l 2 the gliding velocity can be expressed as a function of gliding angle using eqs 16 and 17 as follows 23 δ b z cos γ k l 0 k l α u 2 24 u δ b z cos γ k l 0 k l α γ substituting from α γ eq 22 in eq 24 one obtains 25 u 2 δ b z k d 2 k l 0 k d cot γ k l sin γ k l k l 2 4 k d k d 0 cot 2 γ 4 k d k l 0 cot γ which is the relationship between the gliding velocity and the gliding angle and the horizontal velocity u h and vertical velocity u v are 26 x u cos θ α z u sin θ α the mathematical model established above is widely used in the design of the glider and graver 2005 illustrated the use of the equations of motion to simulate the sawtooth gliding in the vertical plane by making use of the parameters of a glider in size as slocum in this paper the parameters used for simulation are k d0 9 4546 n s m 2 k d 553 1856 n s m 2 k l0 0 n s m 2 k l 604 2496 n s m 2 k m0 0 n s m 2 k m 311 53 n s m 2 r mz 0 02 m i yy 28 2689 kg m2 m h 77 kg m b 16 5 kg m fx 2 7374 kg m fz 105 1181 kg u 0 0 3 m s θ 0 17 3 4 energy consumption modeling the energy consumption reduction of each part plays an important role in increasing the gliding range of the glider and therefore an energy consumption model needs to be established in the optimization the subsystems in the energy consumption consist of the buoyancy regulating unit the attitude adjustment unit the measuring unit the control unit and the communication unit 3 4 1 the buoyancy regulating unit the energy consumption of the buoyancy regulating unit is directly related to the control parameters including the oil volume m b1 pumped back to the internal reservoir and the oil mass m b2 pumped into the external bladder in the diving preparation phase the solenoid valve works and the quantity q valve and the power p valve are measured to be 24 ml s and 5 w respectively the energy consumption of solenoid valve for this phase can be obtained by eq 27 27 w valve p valve m b 1 ρ oil q valve where ρ oil is the density of the hydraulic oil in the climbing preparation phase the oil is pumped into the external bladder and the quantity q pump and the power p pump are related to the load namely the pressure applied on the external bladder by the seawater which can be fitted by the measured data in fig 12 28 q pump j 1 ρ 0 g z 10 6 3 j 2 ρ 0 g z 10 6 2 j 3 ρ 0 g z 10 6 j 4 29 p pump k 1 ρ 0 g z 10 6 k 2 here the coefficients j 1 j 4 are 0 0158 0 2536 0 3487 and 101 9852 k 1 is 1 9168 and k 2 is 22 7191 respectively hence the energy consumption of the pump in the climbing preparation phase can be calculated 30 w pump p pump m b 2 ρ o i l q pump in conclusion the energy consumption of the buoyancy regulating unit for one gliding cycle can be calculated 31 w buo w valve w pump 3 4 2 the attitude adjustment unit the attitude adjustment unit includes the pitch regulating unit and the roll adjustment unit which adjust the pitching angle and the roll angle the major energy consuming components are the motors and the actuators in this paper the energy consumption of the attitude adjustment unit for one gliding cycle is referred as a constant then energy consumption of this part can be achieved by adding up the energy consumption of the attitude adjustment unit and calculating the average value for one profile a total of 356 1000 m deep profiles are analyzed and the energy consumption of the attitude adjustment unit w att for one gliding cycle is calculated as 3 08 kj 3 4 3 the measuring unit and the control unit the measuring unit consists of the task sensors integrated on the gliders such as the ctd dissolved oxygen sensor and other types of sensors the control unit keeps running when the glider works and its energy consumption includes that of the monitoring sensor hence energy consumption of these parts p mea and p con are determined by the power and the sample frequency of the sensors which can be seen as variables in the energy consumption model 3 4 4 the communication unit similar to the attitude adjustment unit energy consumption of the communication unit w com can also be seen as a constant which is calculated as 1 244 kj by the energy consumption statistics 3 4 5 the total energy consumption of one gliding cycle based on the above discussions the total energy consumption of one gliding cycle can be computed as 32 e g w buo w att w com p mea p con t g where t is the time of one gliding cycle 4 optimal model for gliding range the optimizer is designed to maximize the gliding range and minimize the energy consumption of one gliding profile the optimization design is mathematically modeled as follows 4 1 optimal model with cgsm strategy 4 1 1 the optimized variables in the optimization the motion parameters imported into the control unit are selected as the optimized variables including the ballast mass m b the gliding angle γ 1 in the diving phase and γ 2 in the climbing phase 4 1 2 the objective function in this study the optimization aims to maximize the gliding range and minimize the energy consumption of one gliding profile thus the objective function of the optimization is the ratio of the gliding range to the energy consumption for one profile which expresses the gliding range of the glider per energy consumption unit in fact limited by the depth of diving preparation phase and climbing preparation phase the petrel l glides from the depth of 50 m to the depth of 950 m in the diving phase and from 1000 m deep to 0 m deep in the diving phase actually then the time t and the range for one gliding cycle x cgsm can be calculated 33 t cgsm t 0 1000 γ 1 m b 1 t 1000 0 γ 2 m b 2 34 x cgsm 900 1000 x 0 1000 γ 1 m b 1 x 1000 0 γ 2 m b 2 and the objective function f cgsm is 35 f cgsm x cgsm e g t t cgsm 4 1 3 the constraint conditions to take some practical conditions into consideration some constraints need to be satisfied which are described below 4 1 3 1 side constraints each optimized variable needs to have a feasible ron in which the optimum value can be achieved taking the reality into account the scope of the imported motion parameters needs to be wide enough to get a correct optimized result hence the side constraints of the four imported motion parameters can be expressed 36 g 1 660 g m b 1 1200 g 37 g 2 760 g m b 2 1300 g 38 g 3 10 o γ 1 30 o 39 g 4 10 o γ 2 30 o 4 1 3 2 other constraints in addition for one gliding cycle the parameter connected with the oil volume needs to meet the following relationship in order to keep a minimum net buoyancy jenkins et al 2003 introduced that the legacy gliders are presently using a variable net buoyancy volume of 100 150 cc therefore the minimum net buoyancy volume of petrel l is 1 n 40 g 5 m b 2 g δ b glider 1000 1 n 4 2 optimal model with hgsm strategy 4 2 1 the optimized variables similarly the motion parameters imported into the control system are selected as the optimized variables including the ballast mass m b according to eq 16 the angle of attack can be expressed by the gliding angle thus to reduce the difficulty of solving the optimization the gliding angle γ 1 and γ 2 are selected as the optimized variables instead of γ 1 and γ 2 4 2 2 the objective function similarly the gliding time t hgsm and gliding range r hgsm of the hgsm can be expressed by eq 41 and eq 42 41 t hgsm t 331 1000 γ 1 m b 1 t 1000 331 γ 2 m b 2 42 x hgsm 569 669 x 331 1000 γ 1 m b 1 x 1000 331 γ 2 m b 2 the objective function f hgsm is shown in eq 43 it is worth noting that the communication unit does not consume energy in hgsm and the energy consumption of the attitude adjustment unit appears to scale with the gliding depth 43 f hgsm x hgsm e g t t hgsm 4 2 3 the constraint conditions 4 2 3 1 side constraints the side constraints in the hgsm is similar to those in the cgsm which is shown as 44 g 1 290 g m b 1 600 g 45 g 2 390 g m b 2 700 g 46 g 3 10 o γ 1 30 o 47 g 4 10 o γ 2 30 o 4 2 3 2 the other constraint the other constraint in the hgsm is same as that in the cgsm 48 g 5 m b 2 g δ b glider 1000 δ b glider 331 1 n 4 3 the solution algorithm in this paper the optimization of motion parameters is a linear constraint optimization issue consisting of some inequality constraints in this study the ipfm is applied to solve this problem in consideration of its high precision and high efficiency which is effective to solve the constrained optimization problem procedure of the optimization solution is shown in fig 13 5 results and discussions before optimizing the model we assume that eq 40 and eq 48 are the equalities in the optimal model and the angle of attack in the diving phase is equal to that in the climbing phase fig 14 shows the results of the average gliding velocity with different glide angles γ and ballast mass m b2 it can be seen in fig 14 that the average gliding velocity increases with the gliding angle and the oil volume pumped into the external bladder fig 15 shows the variation trend of the optimal average gliding velocity in cgsm and hgsm it can be seen that the gliding velocity increases with the power of the measurement unit and control unit and that the average gliding velocity in the cgsm is higher than that in the hgsm with the same power because the buoyancy loss makes the ballast masses larger in the cgsm in the cgsm the optimal gliding velocity reduces to 0 25 m s and becomes stable when the power of the measurement unit and control unit is lower than 0 4 w for different observation missions of the underwater glider the power of the measuring unit is different which needs to be considered thus in the optimization the power of the measuring unit and the control unit is referred as a time dependent variable fig 16 shows the partial result of the objective function with different gliding angles γ and ballast mass m b2 in which the power range of the measuring unit and the control unit is 0 2 3 4 w from fig 16 we can see the variation trend of the optimal point the pink point in the hook face and the optimal area the red portion in the hook face in cgsm and hgsm the minimum oil volume and the minimum gliding angle cannot be the optimal point any more with the power increase of the control unit and measuring unit the optimization results in cgsm and hgsm are described in fig 17 from which we can see that γ 1 γ 2 and f decrease with the power increase in a nonlinear trend and γ 1 is larger than γ 2 in cgsm and hgsm moreover the ballast mass m b1 and m b2 increase with the power increase in a linear trend basically and the difference of m b1 and m b2 becomes larger when the power is larger than 3 5 w in cgsm and 1 w in hgsm fig 18 shows the increasing rate of gliding range if the hgsm is applied to the petrel l it can be seen in fig 18 that the hgsm is effective to increase the gliding range when the power is lower than 0 8 w and that the enhancing effect is more obvious when the power is lower when the power decreases to 0 2 w the gliding range can increase by 24 13 the reason is that the energy consumption of the buoyancy regulating unit plays a leading role in the entire energy consumption when the power is less than 0 8 w thus the hgsm has its advantages because the buoyancy loss in the cgsm is inevitable and the ballast masses cannot be smaller which consume the extra energy when the power turns larger the optimized ballast masses become larger to shorten the gliding time and the increasing rate of the ballast mass mb2 in the hgsm is larger than that in the cgsm as shown in fig 17 moreover the gliding depth for one profile in the cgsm is larger than that in the hgsm and the depth difference is changeless thus with the increase of the power the cgsm is more suitable than the hgsm 6 verification of the model in order to ensure the validity of the optimization described above petrel l experienced the sea trial from june 30th 2018 to november 17th 2018 for performance test in south china sea as shown in fig 19 and 734 gliding cycles are counted in fig 18 including 692 1000 m deep gliding cycles the gliding range reaches 3619 6 km and the average range of 1000 m depth gliding cycles is 4 93 km the average gliding time for one gliding cycle is 263 min the power of the measuring unit and the control unit is 0 75 w in the sea trail table 2 shows the two groups of motion parameters set in the sea trail to analyze the influence of motion parameters on the gliding range to avoid the influence of the current on the gliding range the target heading of the two sequent profile is opposing and the average gliding range is calculated as the gliding range for one cycle by inputting the parameters in table 2 into the model described above the gliding trajectories and pitching angle of the two gliding cycle can be described in fig 20 and the average gliding range gliding time and pitching angle for one gliding cycle can be calculated as shown in table 3 it can be seen that there is a good consistent between the results of the optimization model and sea trail which proves the validity of the optimization model 7 conclusions in this paper we established an optimized mathematical model which includes the steady motion model the gliding strategy model and the energy consumption model then the motion parameters are optimized to increase the gliding range considering different powers related to the gliding time and different gliding strates the two gliding strates cgsm and hgsm are analyzed base on the result of the optimization the experimental study on the petrel l validates the effectiveness of the proposed methods and the following conclusions can be drawn 1 the establishment of steady motion model hydrodynamic model gliding range model and energy consumption model is an effective way to obtain the optimal motion parameters of the underwater gliders for the largest gliding range based on the different observation mission 2 with the augment of the power related to gliding time the optimal gliding angles are decreased and the ballast masses are increased for the largest gliding range 3 the hgsm is effective to increase the gliding range when the power of the control unit and the measuring unit is less than 1 2 w for petrel l and the enhancing effect of which is more obvious with the decrease of the power therefore the hgsm can be applied when the target area is far from the current location of the glider in the future the optimization of the pressure hull and the hydrodynamic shape will be studied to enlarge the gliding range and the ocean current will be considered in the optimization which has a certain influence on the gliding range acknowledgments this work was jointly supported by national key r d program of china grant nos 2016yfc0301100 and national natural science foundation of china grant nos 51721003 51722508 and 11902219 the authors also would like to express their sincere thanks to l ma for her to revise the grammar 
22412,underwater glider is one of the most promising autonomous observation platforms for long term ocean observation which can glide through water columns by adjusting its buoyancy and attitude in this paper gliding range of the petrel l underwater glider is increased by optimizing the motion parameters according to different observation missions the optimization is established to maximize the gliding range and minimize the energy consumption for one gliding cycle which is solved by the inner penalty function method ipfm based on the nonlinear variation rule of the buoyancy loss a hidden gliding strategy model hgsm is proposed and the optimization result indicates that it can increase the gliding range by 24 13 for petrel l when the power related with time is 0 2 w the optimization is applicable to other types of underwater gliders keywords motion parameter optimization gliding strategy analysis underwater glider 1 introduction driven by its net buoyancy underwater glider ug can glide through water columns by adjusting the buoyancy and the pitching angle bachmayer et al 2004 since the concept of ug was first demonstrated by stommel 1989 various underwater gliders including the slocum webb et al 2001 the seaglider eriksen et al 2001 and the spray sherman et al 2001 have been developed and widely applied in ocean observation for their temporal and spatial cruising ability rudnick et al 2004 new types of underwater gliders such as the deepglider osse and eriksen 2007 with 6000 m operating depth the zray d spain et al 2005 with heavy payload capability and the sea explorer claustre et al 2014 with high gliding velocity have been designed with the development of marine science a larger gliding range is required for the observation of some larger scale and longer lasting ocean phenomena stuntz et al 2016 though gliding range can be elongated by increasing the battery capacity in the limited internal space of the underwater glider it seems to be great significance to increase the gliding range through reducing energy consumption improving gliding strates and optimizing motion parameters this paper focuses on the motion parameter optimization and gliding strategy analysis of the underwater glider several research results have been reported in the literatures to increase the cruising ability and reduce the energy consumption which can be realized by optimized control and improved designs in terms of optimized control several typical researches are listed yu et al 2013 optimized gliding motion parameters and sensor scheduling to increase the gliding range of underwater gliders without considering the variation of net buoyancy in the gliding cycles xue et al 2018 proposed a multi layer coordinate control strategy of underwater gliders by optimizing the motion parameters huang et al 2018 improved the control and energy efficiency over the pitch angle adjustment by a self searching optimal active disturbance rejection control theory to increase the endurance of the thermal glider sang et al 2018 proposed a new hybrid heading tracking control algorithm to improve the adaptability and robustness of underwater glider s heading control claus and bachmayer 2016 presented an energy optimal depth controller design methodology for long range autonomous underwater vehicles with applications to a propeller driven hybrid ug during level flight yoon and kim 2016 formulated an optimal control problem for an underwater glider by considering depth constraints into a nonlinear two point boundary value problem with inequality constraints which was solved by numerical methods liu et al 2017 developed an optimal three dimensional path planning method for low energy consumption miller 2018 applied the bio inspired energy utilization strates to the underwater vehicles to achieve a 10 40 range promotion the following studies focused on the optimal design to increase the cruising ability and reduce the energy consumption fu et al 2018 proposed a multi objective shape optimization scheme of underwater gliders for low drag high efficiency low energy consumption and long voyage li et al 2018 presented a simplified shape optimization strategy for blended wing body underwater gliders by which the lift to drag ratio is increased by 4 2 tang et al 2018 designed a neutrally buoyant pressure hull using bi directional evolutionary topology method to reduce the buoyancy loss he et al 2017 carried out a multi objective optimization of a multi bubble pressure cabin in the underwater glider with blended wing body using kriging and the non dominated sorting genetic algorithm wang et al 2017 adopted the design of experiment doe theory to solve the multi objective design optimization of the underwater glider which improved the hydrodynamic performance by 9 1 although the above investigations have provided numerous results related to the optimization design there exist the following problems 1 the net buoyancy variation is not taken into account in the motion parameter optimization in the previous works which affects the gliding motion state and is influenced by the deformation of the pressure hull and the density variation of the seawater yang et al 2017 2 integrated with the ctds turbulence sensors acoustic sensors and biochemical sensors underwater gliders have been widely applied in the mesoscale eddy observation the submesoscale eddy observation the internal wave observation and the turbulent microstructure observation rudnick 2016 the power of the carried sensors is necessary to be analyzed in the optimization which has a significant impact on the gliding range 3 since the physical parameters of the seawater including density and temperature show nonlinear variation with the depth therefore the conventional gliding strategy model cgsm in the previous optimization may not be the optimal gliding strategy for the largest gliding range which needs to be analyzed in this paper an efficient method is developed to increase the gliding range of underwater gliders by optimizing the motion parameters and analyzing the gliding strategy compared with the existing work the main contributions of this paper are in two aspects 1 an optimization method is established to increase the gliding range which takes the variation of the net buoyancy into account and analyzes the effect of the power of the carried sensors on the optimized motion parameters based on the different observation missions the optimization is constructed by the kinematic model in the vertical plane two gliding strategy model and an energy consumption model the objective of the optimization is maximizing the gliding range and minimizing the energy consumption which is solved by the ipfm and the trend of the optimized motion parameters for the different temporal power is researched 2 a hidden gliding strategy model hgsm is presented by analyzing the nonlinear variation trend of the buoyancy loss the application effect of which on improving the gliding range is analyzed in comparison with the cgsm this paper is organized as follows section 2 introduces the petrel l underwater glider for modeling in section 3 the mathematical model is derived based on the kinematical model of glider motion in vertical plane the gliding strategy model and the energy consumption model in section 4 an optimization is established to analyze how to control the motion parameters for the largest gliding range in section 5 the optimization results and discussions are introduced in section 6 a sea trail is carried out to verify the validity of the optimization finally section 7 concludes the paper 2 the petrel l underwater glider the petrel l shown in fig 1 is an underwater glider developed by tianjin university china it consists of a cylindrical pressure hull to which the emergency device fixed wings two fairings and a trailing antenna are attached the subsystems inside the pressure hull include the buoyancy regulating unit pitch regulating unit roll regulating unit control unit communication and navigation unit and battery pack table 1 shows the main technical specifications of petrel l as a core part of the petrel l the buoyancy regulating unit consists of an external bladder an internal reservoir some hydraulic valves a displacement sensor a pressurized gear pump and a high pressure plunger pump the pumps and valves can adjust the oil volume of the external bladder to change the buoyancy of the glider and thus drive its vertical motion the displacement sensor monitors the oil volume of the internal reservoir when the buoyancy regulating unit works during gliding the attitude angles of glider including the pitching angle the roll angle and the heading are adjusted by an internal translational and rotational battery pack which can change the position of mass center of the underwater glider hence the glider dives and climbs in a zigzag trajectory through the seawater 3 modeling of the petrel l underwater glider 3 1 buoyancy loss of petrel l as the glider ascends higher in the water column and the pressure relaxes it becomes less buoyant because the hull is less compressible than seawater jenkins et al 2003 therefore the net buoyancy decreases gradually in the diving phase and the climbing phase this phenomenon is obvious particularly when the glider goes across the thermocline where the seawater density changes sharply in the gliding motion the buoyancy loss b glider is decided by the buoyancy of the glider which is mainly related to the volume of the pressure hull and the density of the seawater the buoyancy loss of the glider can be calculated as 1 δ b glider z ρ z v z g ρ 0 v 0 g here v z is the volume of the glider under the hydrostatic pressure of the seawater v 0 is the volume of petrel l under the atmospheric pressure which is 91 l ρ z is the density of seawater varying with the depth and ρ 0 is 1021 8 kg m3 according to the international gravity formula proposed by moritz 1984 the acceleration of gravity g is considered as 9 8 kg m3 because it varies little with the latitude and the height relative to sea level the seawater density varies with temperature salinity and pressure in this paper the density is considered as a variable changing with the depth z and can be obtained by the sea trial data in south china sea the quartic polynomial fitted curve is described in fig 2 the maximum value is 1031 98 kg m3 at the depth of 1000 m and the minimum value ρ 0 is 1021 8 kg m3 at sea surface the expression of the density can be described as 2 ρ z z p 1 z 4 p 2 z 3 p 3 z 2 p 4 z p 5 where z is the depth of the seawater and the fitted coefficients p i i 1 5 are 4 8547 10 11 1 1823 10 7 1 0165 10 4 0 0422 and 1021 6 respectively when the glider glides through the water columns the temperature and pressure change gradually which leads to the thermal stress and hydrostatic stress applied on the pressure hull the temperature variation with the depth observed by petrel l in the south china sea can be described by a quartic polynomial analogously and the variation trend is shown in fig 3 3 t q 1 z 4 q 2 z 3 q 3 z 2 q 4 z q 5 where the fitted coefficients q i i 1 5 are 1 3811 10 10 3 4465 10 7 3 0883 10 4 0 1265 and 28 7196 respectively in this paper the finite element analysis code ansys workbench is adopted to analyze the deformation and volume variation of the pressure hull due to temperature and hydraulic pressure changes in the seawater firstly a steady state thermal model is adopted and the temperature difference is imported into the model then a static structural model is established and the analysis result of the steady state thermal model is imported what calls for special attention is that the pressure inputted in the static structural model needs to match the temperature inputted in the steady state thermal model according to the ocean environment moreover the effects of pressure and temperature on the volume variety are simulated to evaluate the influence of temperature fig 4 shows the effects of coupling pressure and temperature on the volume variety of the pressure hull respectively it can be seen from fig 4 that the effects of pressure and temperature are nonlinearly coupling moreover it is necessary to take the temperature into account in the volume variety simulation because the volume variety caused by temperature is 21 7 of that by coupling when the pressure is 10 mpa to validate the calculated result a pressure test is carried out to measure the strain of the pressure the strain gages are pasted on the internal face of the pressure hull and the environment temperature is 28 c during the test the temperature of water is 12 c fig 5 shows the pressure test and the result comparison which indicates the consistency between the simulation result and the test result the fitted quadratic can be calculated 4 δ v z z r 1 z 2 r 2 z 5 v z z v 0 δ v z where v z is the volume variation of the pressure hull and the coefficients r 1 and r 2 are 1 384 104 and 0 386675 respectively substitute eqs 2 4 and 5 into eq 1 and the buoyancy loss can be obtained 6 δ b glider z p 1 r 1 z 6 g p 1 r 2 p 2 r 1 z 5 g p 2 r 2 p 3 r 1 z 4 g p 3 r 2 p 4 r 1 z 3 g p 4 r 2 p 5 r 1 z 2 g p 5 r 2 z g ρ 0 v 0 g the buoyancy loss is described in fig 6 as shown in the figure there exists nonlinear variation and the net buoyancy decreases faster in the shallow sea than in deep sea because of the existence of the thermocline 3 2 gliding strategy modeling 3 2 1 the cgsm gliding strategy as shown in fig 7 the cgsm can be divided into five phases the diving preparation phase the diving phase the climbing preparation phase the climbing phase and the communication phase in the diving preparation phase the solenoid valve turns on and the hydraulic oil flows from the external bladder to the internal reservoir until the oil volume in the internal reservoir reaches the set value then the pitch regulating unit bns to adjust the pitching angle to a desired value and the diving phase bns during which the roll regulating unit adjusts the heading when the glider deviates from the target heading when the glider reaches the target depth the climbing preparation phase bns and the hydraulic oil is pumped back to the external bladder until the oil volume in the internal reservoir reaches the set value then the glider will climb and enter the climbing phase during which the pitch regulating unit and the roll regulating unit work interruptedly to control the attitude of the glider after arriving at the surface the communication phase bns during which the battery pack moves fully forward and the hydraulic oil is pumped to the external bladder the trailing antenna emerges from the surface and the pitching angle is larger than 45 in this phase the gps module and the iridium satellite communication module bn to work and we can get the position of the glider and control the glider by the iridium satellite communication 3 2 2 the hgsm gliding strategy the gliding model adopted mostly by the legacy underwater gliders is the cgsm the gliding efficiency of which is low because the net buoyancy changes sharply when the glider goes through the thermocline thus the buoyancy regulating unit has to pump extra oil to the external bladder to keep a certain gliding velocity jenkins et al 2003 in this work a hgsm shown in fig 8 is proposed in which the glider does not need to go through the thermocline for a few sequent gliding cycles this gliding strategy can be adopted when the glider is far from the sea area of the task for example the glider needs to move to the sea area of the next task when it has finished the current task moreover it can also be adopted to save the cost of the observation task when the sea area of the task is far from the coast and the glider is launched near the shore in the hgsm the minimum gliding depth needs to be confirmed below which the buoyancy loss rate is the lowest as expressed by eq 7 and fig 9 the minimum depth is 331 m below which the net buoyancy loss rate r net buoyancy loss per unit depth is 2 934 10 3 n m 7 r δ b glider z 1000 δ b glider 1000 z 3 3 mathematical modeling in vertical plane 3 3 1 mass distribution the mass configuration of a glider is critical because it moves in the seawater by adjusting its buoyancy shown in fig 10 the mass of a glider m consists of mass of the hull m h internal moving point mass m m and ballast mass m b the component m h is a fixed uniformly mass the vector r m and r b describes the position of the moving mass m m and ballast mass m b in the body fixed frame at time t the ballast mass m b1 and m b2 of the glider are the mass of fluid taken in during its descent and given out during its ascent respectively therefore the total mass of the diving phase and climbing phase is 8 m m h m m m b 1 m h m m m b 2 and the net buoyancy of the glider b is given by 9 δ b z m g ρ 0 z v 0 g δ b glider z if the b 0 then glider is neutrally buoyant the glider descends if b 0 and ascends if b 0 in order to maintain a steady glide the state variables of glider velocity gliding angle and angle of attack need remain constant 3 3 2 kinematic and dynamic model of glider motion petrel l glider is designed to have a separate control algorithm and actuators for controlling the lateral dynamics and vertical plane dynamics in this paper the vertical plane dynamics are controlled using the movable mass here the lateral dynamics can be ignored since a fixed back rudder is adopted to make the glider glide in a straight motion in a vertical plane and thus stabilize the dynamics experiments using the slocum glider show that the vertical plane steady glides are qualitatively consistent with the result of the model leonard and graver 2001 thus the study of the vertical plane dynamics as a representative of actual glider operation is useful leonard and graver 2001 derived the equation of motions of glider in the vertical plane and described the mathematical model of the steady state dynamics of glider in the vertical plane the kinematics of the vehicle can be explained based on fig 9 singh et al 2017 two frames the inertial frame e frame and the body frame b frame are required in the work of building dynamic model of the glider definition of the two frames is same as that of the common underwater vehicles wang et al 2015 sarkar et al 2016 the origins of the b frame coincide with the center of the buoyancy the e frame is fixed to a point on the sea surface in reference to e frame the velocity of the glider along x y and z axis is represented by u v and w respectively while the angular velocity of the glider along x y and z axis is represented by p q and s respectively all in b frame in fig 11 θ is the pitching angle angle between x axis of e frame and x axis of b frame α is the angle of attack angle between gliding velocity vector and x axis of b frame γ is the gliding angle angle between gliding velocity vector and x axis of e frame u is the gliding velocity l and d are vehicle lift and drag respectively when the glider descends γ and θ are positive and α is negative when the glider ascends γ and θ are negative and α is positive in order to ease the analysis process some restrictions have to be made to simplify the mass distribution on the glider graver 2005 pm denotes momentum of the moving mass in the b frame be represents the position in e frame while ω represent the angular velocity vector in b frame respectively r is the rotational matrix which defines the orientation of glider in b frame the control inputs to the system are the ballast rate u b internal force u m acting on the moving mass u mx represent the internal force acting on moving mass along z direction m fx and m fz represent the added mass along x and z axis respectively k m0 and k m are the zero moment coefficient and induced moment coefficient respectively i yy represents the mass moment of inertia along y axis the roll yaw and sway velocity terms are taken to be zero assuming zero side slip angles the hydrodynamic shear force is neglected the simplified parameters for motion are expressed in eq 10 as 10 b e x 0 z t ω 0 q 0 t u u 0 w t r m r m x 0 r m z r b r b x 0 r b z p m p m x 0 p m z u m u m x 0 u m z the velocity and the angular velocity in b frame can be expressed in e frame as 11 x 0 z r u 0 w 12 0 θ 0 r 0 q 0 where the modified equations of motion are represented in eq 13 as 13 x u cos θ w sin θ z u sin θ w cos θ α tan 1 w u θ q q 1 i y y m f z m f x u w r m x p m x r b x p b x r m z p m z q m m r m z g sin θ m m r m x m b r b x g cos θ m p r m z u m x r m x u m z u 1 m f x m f z w q p m z p b z q δ b g sin θ l sin α d cos α u m x w 1 m f z m f x w q p m x p b x q δ b g cos θ l cos α d sin α u m z r m x p m x m m u r m z q r m z p m z m m u r m x q p m x u m x p m z u m z m b u b m p represents the pitching angle moment the expression of which is 14 m p k m 0 k m α u 2 w 2 u is denoted as 15 u 2 u 2 w 2 3 3 3 mathematical model of the steady state gliding motion the kinematic and equilibrium relations follow from graver 2005 as 16 θ γ α δ b cos γ l δ b sin γ d the hydrodynamic drag and lift can be defined as 17 d k d 0 k d α 2 u 2 l k l 0 k l α u 2 where k d0 and k d are the zero angle of attack drag coefficient and induced drag coefficient respectively k l0 and k l are the zero angle of attack lift coefficient and induced lift coefficient respectively eqs 16 and 17 can be used to define the relation between α and γ as 18 tan γ d l k d 0 k d α 2 k l 0 k l α for a solution in the real number field one must have 19 k l tan γ 2 4 k d k d 0 k l 0 tan γ 0 when the equation is satisfied in eq 19 the solution of the tanγ is 20 tan γ 2 k d k l k l 0 k l k l 0 k l 2 k d 0 k d therefore the attainable value range of the gliding angle for a glider is 21 γ π 2 tan 1 2 k d k l k l 0 k l k l 0 k l 2 k d 0 k d tan 1 2 k d k l k l 0 k l k l 0 k l 2 k d 0 k d π 2 and the expression of α can be deduced by eq 18 22 α γ k l tan γ 2 k d 1 1 4 k d cot γ k d 0 cot γ k l 0 k l 2 the gliding velocity can be expressed as a function of gliding angle using eqs 16 and 17 as follows 23 δ b z cos γ k l 0 k l α u 2 24 u δ b z cos γ k l 0 k l α γ substituting from α γ eq 22 in eq 24 one obtains 25 u 2 δ b z k d 2 k l 0 k d cot γ k l sin γ k l k l 2 4 k d k d 0 cot 2 γ 4 k d k l 0 cot γ which is the relationship between the gliding velocity and the gliding angle and the horizontal velocity u h and vertical velocity u v are 26 x u cos θ α z u sin θ α the mathematical model established above is widely used in the design of the glider and graver 2005 illustrated the use of the equations of motion to simulate the sawtooth gliding in the vertical plane by making use of the parameters of a glider in size as slocum in this paper the parameters used for simulation are k d0 9 4546 n s m 2 k d 553 1856 n s m 2 k l0 0 n s m 2 k l 604 2496 n s m 2 k m0 0 n s m 2 k m 311 53 n s m 2 r mz 0 02 m i yy 28 2689 kg m2 m h 77 kg m b 16 5 kg m fx 2 7374 kg m fz 105 1181 kg u 0 0 3 m s θ 0 17 3 4 energy consumption modeling the energy consumption reduction of each part plays an important role in increasing the gliding range of the glider and therefore an energy consumption model needs to be established in the optimization the subsystems in the energy consumption consist of the buoyancy regulating unit the attitude adjustment unit the measuring unit the control unit and the communication unit 3 4 1 the buoyancy regulating unit the energy consumption of the buoyancy regulating unit is directly related to the control parameters including the oil volume m b1 pumped back to the internal reservoir and the oil mass m b2 pumped into the external bladder in the diving preparation phase the solenoid valve works and the quantity q valve and the power p valve are measured to be 24 ml s and 5 w respectively the energy consumption of solenoid valve for this phase can be obtained by eq 27 27 w valve p valve m b 1 ρ oil q valve where ρ oil is the density of the hydraulic oil in the climbing preparation phase the oil is pumped into the external bladder and the quantity q pump and the power p pump are related to the load namely the pressure applied on the external bladder by the seawater which can be fitted by the measured data in fig 12 28 q pump j 1 ρ 0 g z 10 6 3 j 2 ρ 0 g z 10 6 2 j 3 ρ 0 g z 10 6 j 4 29 p pump k 1 ρ 0 g z 10 6 k 2 here the coefficients j 1 j 4 are 0 0158 0 2536 0 3487 and 101 9852 k 1 is 1 9168 and k 2 is 22 7191 respectively hence the energy consumption of the pump in the climbing preparation phase can be calculated 30 w pump p pump m b 2 ρ o i l q pump in conclusion the energy consumption of the buoyancy regulating unit for one gliding cycle can be calculated 31 w buo w valve w pump 3 4 2 the attitude adjustment unit the attitude adjustment unit includes the pitch regulating unit and the roll adjustment unit which adjust the pitching angle and the roll angle the major energy consuming components are the motors and the actuators in this paper the energy consumption of the attitude adjustment unit for one gliding cycle is referred as a constant then energy consumption of this part can be achieved by adding up the energy consumption of the attitude adjustment unit and calculating the average value for one profile a total of 356 1000 m deep profiles are analyzed and the energy consumption of the attitude adjustment unit w att for one gliding cycle is calculated as 3 08 kj 3 4 3 the measuring unit and the control unit the measuring unit consists of the task sensors integrated on the gliders such as the ctd dissolved oxygen sensor and other types of sensors the control unit keeps running when the glider works and its energy consumption includes that of the monitoring sensor hence energy consumption of these parts p mea and p con are determined by the power and the sample frequency of the sensors which can be seen as variables in the energy consumption model 3 4 4 the communication unit similar to the attitude adjustment unit energy consumption of the communication unit w com can also be seen as a constant which is calculated as 1 244 kj by the energy consumption statistics 3 4 5 the total energy consumption of one gliding cycle based on the above discussions the total energy consumption of one gliding cycle can be computed as 32 e g w buo w att w com p mea p con t g where t is the time of one gliding cycle 4 optimal model for gliding range the optimizer is designed to maximize the gliding range and minimize the energy consumption of one gliding profile the optimization design is mathematically modeled as follows 4 1 optimal model with cgsm strategy 4 1 1 the optimized variables in the optimization the motion parameters imported into the control unit are selected as the optimized variables including the ballast mass m b the gliding angle γ 1 in the diving phase and γ 2 in the climbing phase 4 1 2 the objective function in this study the optimization aims to maximize the gliding range and minimize the energy consumption of one gliding profile thus the objective function of the optimization is the ratio of the gliding range to the energy consumption for one profile which expresses the gliding range of the glider per energy consumption unit in fact limited by the depth of diving preparation phase and climbing preparation phase the petrel l glides from the depth of 50 m to the depth of 950 m in the diving phase and from 1000 m deep to 0 m deep in the diving phase actually then the time t and the range for one gliding cycle x cgsm can be calculated 33 t cgsm t 0 1000 γ 1 m b 1 t 1000 0 γ 2 m b 2 34 x cgsm 900 1000 x 0 1000 γ 1 m b 1 x 1000 0 γ 2 m b 2 and the objective function f cgsm is 35 f cgsm x cgsm e g t t cgsm 4 1 3 the constraint conditions to take some practical conditions into consideration some constraints need to be satisfied which are described below 4 1 3 1 side constraints each optimized variable needs to have a feasible ron in which the optimum value can be achieved taking the reality into account the scope of the imported motion parameters needs to be wide enough to get a correct optimized result hence the side constraints of the four imported motion parameters can be expressed 36 g 1 660 g m b 1 1200 g 37 g 2 760 g m b 2 1300 g 38 g 3 10 o γ 1 30 o 39 g 4 10 o γ 2 30 o 4 1 3 2 other constraints in addition for one gliding cycle the parameter connected with the oil volume needs to meet the following relationship in order to keep a minimum net buoyancy jenkins et al 2003 introduced that the legacy gliders are presently using a variable net buoyancy volume of 100 150 cc therefore the minimum net buoyancy volume of petrel l is 1 n 40 g 5 m b 2 g δ b glider 1000 1 n 4 2 optimal model with hgsm strategy 4 2 1 the optimized variables similarly the motion parameters imported into the control system are selected as the optimized variables including the ballast mass m b according to eq 16 the angle of attack can be expressed by the gliding angle thus to reduce the difficulty of solving the optimization the gliding angle γ 1 and γ 2 are selected as the optimized variables instead of γ 1 and γ 2 4 2 2 the objective function similarly the gliding time t hgsm and gliding range r hgsm of the hgsm can be expressed by eq 41 and eq 42 41 t hgsm t 331 1000 γ 1 m b 1 t 1000 331 γ 2 m b 2 42 x hgsm 569 669 x 331 1000 γ 1 m b 1 x 1000 331 γ 2 m b 2 the objective function f hgsm is shown in eq 43 it is worth noting that the communication unit does not consume energy in hgsm and the energy consumption of the attitude adjustment unit appears to scale with the gliding depth 43 f hgsm x hgsm e g t t hgsm 4 2 3 the constraint conditions 4 2 3 1 side constraints the side constraints in the hgsm is similar to those in the cgsm which is shown as 44 g 1 290 g m b 1 600 g 45 g 2 390 g m b 2 700 g 46 g 3 10 o γ 1 30 o 47 g 4 10 o γ 2 30 o 4 2 3 2 the other constraint the other constraint in the hgsm is same as that in the cgsm 48 g 5 m b 2 g δ b glider 1000 δ b glider 331 1 n 4 3 the solution algorithm in this paper the optimization of motion parameters is a linear constraint optimization issue consisting of some inequality constraints in this study the ipfm is applied to solve this problem in consideration of its high precision and high efficiency which is effective to solve the constrained optimization problem procedure of the optimization solution is shown in fig 13 5 results and discussions before optimizing the model we assume that eq 40 and eq 48 are the equalities in the optimal model and the angle of attack in the diving phase is equal to that in the climbing phase fig 14 shows the results of the average gliding velocity with different glide angles γ and ballast mass m b2 it can be seen in fig 14 that the average gliding velocity increases with the gliding angle and the oil volume pumped into the external bladder fig 15 shows the variation trend of the optimal average gliding velocity in cgsm and hgsm it can be seen that the gliding velocity increases with the power of the measurement unit and control unit and that the average gliding velocity in the cgsm is higher than that in the hgsm with the same power because the buoyancy loss makes the ballast masses larger in the cgsm in the cgsm the optimal gliding velocity reduces to 0 25 m s and becomes stable when the power of the measurement unit and control unit is lower than 0 4 w for different observation missions of the underwater glider the power of the measuring unit is different which needs to be considered thus in the optimization the power of the measuring unit and the control unit is referred as a time dependent variable fig 16 shows the partial result of the objective function with different gliding angles γ and ballast mass m b2 in which the power range of the measuring unit and the control unit is 0 2 3 4 w from fig 16 we can see the variation trend of the optimal point the pink point in the hook face and the optimal area the red portion in the hook face in cgsm and hgsm the minimum oil volume and the minimum gliding angle cannot be the optimal point any more with the power increase of the control unit and measuring unit the optimization results in cgsm and hgsm are described in fig 17 from which we can see that γ 1 γ 2 and f decrease with the power increase in a nonlinear trend and γ 1 is larger than γ 2 in cgsm and hgsm moreover the ballast mass m b1 and m b2 increase with the power increase in a linear trend basically and the difference of m b1 and m b2 becomes larger when the power is larger than 3 5 w in cgsm and 1 w in hgsm fig 18 shows the increasing rate of gliding range if the hgsm is applied to the petrel l it can be seen in fig 18 that the hgsm is effective to increase the gliding range when the power is lower than 0 8 w and that the enhancing effect is more obvious when the power is lower when the power decreases to 0 2 w the gliding range can increase by 24 13 the reason is that the energy consumption of the buoyancy regulating unit plays a leading role in the entire energy consumption when the power is less than 0 8 w thus the hgsm has its advantages because the buoyancy loss in the cgsm is inevitable and the ballast masses cannot be smaller which consume the extra energy when the power turns larger the optimized ballast masses become larger to shorten the gliding time and the increasing rate of the ballast mass mb2 in the hgsm is larger than that in the cgsm as shown in fig 17 moreover the gliding depth for one profile in the cgsm is larger than that in the hgsm and the depth difference is changeless thus with the increase of the power the cgsm is more suitable than the hgsm 6 verification of the model in order to ensure the validity of the optimization described above petrel l experienced the sea trial from june 30th 2018 to november 17th 2018 for performance test in south china sea as shown in fig 19 and 734 gliding cycles are counted in fig 18 including 692 1000 m deep gliding cycles the gliding range reaches 3619 6 km and the average range of 1000 m depth gliding cycles is 4 93 km the average gliding time for one gliding cycle is 263 min the power of the measuring unit and the control unit is 0 75 w in the sea trail table 2 shows the two groups of motion parameters set in the sea trail to analyze the influence of motion parameters on the gliding range to avoid the influence of the current on the gliding range the target heading of the two sequent profile is opposing and the average gliding range is calculated as the gliding range for one cycle by inputting the parameters in table 2 into the model described above the gliding trajectories and pitching angle of the two gliding cycle can be described in fig 20 and the average gliding range gliding time and pitching angle for one gliding cycle can be calculated as shown in table 3 it can be seen that there is a good consistent between the results of the optimization model and sea trail which proves the validity of the optimization model 7 conclusions in this paper we established an optimized mathematical model which includes the steady motion model the gliding strategy model and the energy consumption model then the motion parameters are optimized to increase the gliding range considering different powers related to the gliding time and different gliding strates the two gliding strates cgsm and hgsm are analyzed base on the result of the optimization the experimental study on the petrel l validates the effectiveness of the proposed methods and the following conclusions can be drawn 1 the establishment of steady motion model hydrodynamic model gliding range model and energy consumption model is an effective way to obtain the optimal motion parameters of the underwater gliders for the largest gliding range based on the different observation mission 2 with the augment of the power related to gliding time the optimal gliding angles are decreased and the ballast masses are increased for the largest gliding range 3 the hgsm is effective to increase the gliding range when the power of the control unit and the measuring unit is less than 1 2 w for petrel l and the enhancing effect of which is more obvious with the decrease of the power therefore the hgsm can be applied when the target area is far from the current location of the glider in the future the optimization of the pressure hull and the hydrodynamic shape will be studied to enlarge the gliding range and the ocean current will be considered in the optimization which has a certain influence on the gliding range acknowledgments this work was jointly supported by national key r d program of china grant nos 2016yfc0301100 and national natural science foundation of china grant nos 51721003 51722508 and 11902219 the authors also would like to express their sincere thanks to l ma for her to revise the grammar 
22413,for ships the stealth performance is an important indicator of its vitality it is extremely important to study the noise reduction of ship propulsions in this work pump jet propulsion with a darpa suboff submarine was taken as the investigated object the trailing edge of its duct was transformed with some serrations and its noise reduction effect was studied large eddy simulation les method was utilized to predict the hydrodynamic performance of the pump jet propulsion then the fw h acoustic model was added into the noise performance simulation after the flow stabilization after the installation of the serrated trailing edge the propulsion sound pressure level spl changes were observed according to the contributions of different parts to the noise intensity and the vortex field changes the noise reduction effect was analyzed the results indicate that not only the propulsion noise radiation but also the noise reduction effect is directional due to the larger noise contribution of the duct the serrated trailing edge has a better effect in the radial direction in addition the circumferential correlation of the duct vortex is broken by the serrations the large vortices are divided into several small ones and the vortex diffusion is accelerated keywords noise reduction large eddy simulation serrated trailing edge pump jet propulsion acoustic simulation 1 introduction in the process of navigation the ship will produce noise which will not only affect the sonar s working but also reduce the ship stealth performance with the continuous improvement of ship speed the engine power increases gradually which also leads to the enhancement of the propulsion load and noise intensity thus how to reduce the propulsion noise is an attractive topic in ship propulsion research about the experimental researches and engineering applications of the serrated trailing edge a lot of investigations have been done most of those are focused on the aerodynamic noise reduction of airfoils sandberg and jones 2011 employed the direct numerical simulation dns in the noise performance predictions of naca0012 airfoils according to the flow field changes it is found that the spanwise correlation of the flow field is weakened by the serrations the vortices were broken into several small pieces which accelerated the vortex diffusion and resulted in noise reduction some similar researches pröbsting 2011 chong et al 2013 2015 were carried out particle image velocimetry piv technology was introduced in the flow field observation the results indicated that the airfoil spl decreased with the installation of the trailing edge serrations in addition increasing the serration width and height would make the noise reduction effect greater then chong and joseph 2013 designed an experiment on a series of plats modified with the serrated trailing edge besides the noise reduction effect the result showed that the spl reduced more significant as the wind speed decreased zhu and shen 2015 modified the dtu ln118 airfoil and used the large eddy simulation les to predict its aerodynamic performance the results showed that there was little influence of the serrations on the aerodynamic performance of the dtu ln118 airfoil the broadband noise generated by a naca0018 airfoil with trailing edge serrations was investigated león et al 2017 varying both the airfoil angle of attack and serration flap angle the results showed that the installation angles have an influence on the noise reduction effect furthermore the impacts of the serration shapes and parameters on the noise reduction effect were investigated avallone et al 2017 lau and huang 2018 juknevicius and chong 2018 mathews and peake 2018 the results manifested that the serration optimization could make the noise reduction effect enhanced in the field of engineering applications oerlemans et al 2007 applied serration noise reduction to the blade trailing edge of a fan in his monitor range the total spl was decreased as much as 3 2 db a simulation wang et al 2018b using large eddy simulation les is demonstrated to predict the near field turbulence and far field acoustics from an ultra high bypass ratio engine with round and serrated nozzles it was found that the serrations shifted the energy from the low frequencies to the high frequencies and decreased overall spls by about 3 db over the low frequency range experimental studies lee et al 2019 in an anechoic chamber were conducted to investigate the influence of quarter flat tip half flat tip and rectangular serrations on reducing propeller trailing edge noise the results showed the significant noise reduction effect however the propulsive thrust was also weakened almost all the above works pay close attention to the noise performance of airfoils and ignore the aerodynamic performance analysis at the same time the engineering applications in the ship propulsion are barely any for submarines stealth performance is one of the important indicators to measure their viability as a kind of advanced propulsion pump jet propulsions have more blades and a higher expanded area ratio which can reduce the radiated noise improve the submarine low noise speed and delay the cavitation occurrence significantly therefore the cavitation noise isn t taken into account in this research liu 2013 designed a pump jet propulsion for a submarine by circumfluence theory combined with surface panel method spm and lifting design method of axial flow pump in his doctoral dissertation his research results will provide data support for the simulation method validation in this work built on his design the pump jet propulsion was transformed with the serrated trailing edge installed on a pump jet propulsion and the noise reduction effect was investigated the large eddy simulation les method was applied to the hydrodynamic performance prediction and the fw h acoustic model was used to calculate the noise performance after the steady flow field obtained by comparing the flow field and hydrodynamic noise performance of propulsions the noise reduction mechanisms were analyzed the results will contribute to improving the stealth performance of submarine and provide a new research method and design idea to promote noise reduction of ship propulsion 2 investigation object our study object was a pump jet propulsion designed by liu 2013 which powered a darpa suboff submarine with full appendages the full model is introduced as followed 2 1 submarine model the noise reduction effect of serrated trailing edge installed on a pump jet duct was investigated in this work in order to obtain the results closer to the real situation a darpa suboff submarine designed for the experimental research in the model scale was set to provide a wake flow the overall length l of the submarine was 4356 mm and the diameter d max of the parallel middle body was 508 mm the rest major parameters are given in fig 1 2 2 pump jet propulsion the origin propulsion model is shown in fig 2 a the blue part was the rotor the red part was the stator and the grey part was the duct of which the trailing edge was straight after spread out its major parameters are described in table 1 the submarine speed u 0 was fixed at 3 051 m s and the design propulsion rotation speed n was 1264 rpm accordingly the design advance coefficient j was 0 724 and the reynolds number re was 6 3 106 which exceeded the critical re the hydrodynamic coefficients and flow turbulences are hardly affected by the scale effect therefore we think the investigation results can be applied in the real scale in this paper a serrated trailing edge was installed on the duct to reduce the propulsion radiation noise the serration length was one tenth of the duct chord chong et al 2013 and the serration number was 54 the transformed propulsion is illustrated in fig 2b 3 mathematic base 3 1 theoretical basis of les method there are three computational fluid dynamics cfd method for the turbulence simulation wagner et al 2007 ansys inc 2011 1 direct numerical simulation dns 2 large eddy simulation les 3 reynolds averaged navier stokes rans dns method has the highest accuracy but the number of grids is excessively huge rans method has difficulty in providing enough pressure fluctuation and vortex distribution information for hydrodynamic noise prediction les method can obtain more flow details with a much higher accuracy in the solution process of the les method it is essential to use the filter function to classify the physical quantities in the flow field which include the large scale physical quantities that can be directly calculated and the small scale quantities that can be modeled therefore the continuity equation and the incompressible navier stokes equation can be rewritten as following form 1 u i x i 0 2 u i t x j u i u j 1 ρ p x i v 2 u i x j 2 x j τ i j s where i j 1 2 3 which stand for the spatial coordinates directions u i represents the velocity component in the x i direction u is the average velocity component after filtering operation ρ is fluid density ν is the kinematic viscous coefficient and τ i j s u i u j u i u j is subgrid scale reynolds stress clark 1979 mcmillan and ferziger 1978 this study employed the les model in the task of analyzing the hydrodynamic acoustics of the propulsions as a typical rotating machine the rotor of pump jet propulsion performs a periodic rotational motion sliding mesh technique carrica et al 2012 was applied to the unsteady rotation motion simulation of the rotor in all the simulations which were run by using the pressure based solver wei et al 2016 wang et al 2018a the simplec algorithm was applied for pressure velocity coupling with second order used for pressure discretization bounded central differencing for momentum term and second order implicit discretization for time term according to the range of noise frequency monitored each time step was fixed at 10 5s in which 20 iterations were proceeded the reducing time step will not affect the calculation results of noise performance kim et al 2006 li et al 2018 the hydrodynamic performance calculation converged after the propulsion forces and flow field stabled by simulating the unsteady flow field the thrust t and torque q as a function of the advance coefficient j were obtained the hydrodynamic performance coefficients of the propulsion system were calculated according to the following formulas zhang and jaimanb 2019 advance coefficient j v n d thrust coefficient of the rotor k t t ρ n 2 d 4 torque coefficient of the rotor k q q ρ n 2 d 5 thrust coefficient of the stator k s t s ρ n 2 d 4 3 thrust coefficient of the duct k d t d ρ n 2 d 4 total thrust coefficient k a k t k s k d efficiency of propulsion system η a j 2 π k a k q where j is the advance coefficient ρ is the fluid density kg m3 v is the inflow velocity m s n is the rotation speed 1 s d is the propeller diameter m t and q are the thrust n and torque n m of the propeller rotor t s and t d n are the thrust of stator and duct 3 2 acoustic simulation method fw h equation was employed in the acoustic simulation whose governing equation was given by 4 1 c 0 2 p t 2 2 p t ρ 0 v n ρ u n v n δ f x i p i j n j ρ u i u n v n δ f 2 x i x j t i j h f where c 0 and ρ 0 are the reference sound speed and fluid density p p p 0 is the sound pressure of the disturbed flow field δ i j represents the kronecker product function δ f and h f represent the dirac delta function and heaviside function f represents the wall function u n stands for the flow velocity component in the x i direction and v n stands for the normal velocity component on the wall the acoustic model was added into the hydrodynamic performance simulation after the flow field simulation converged kowalczyk and felicjancik 2016 li et al 2018 of which the rest settings were unchanged in the water the reference sound pressure is 10 6pa and the sound speed is 1500 m s during the acoustic performance simulation a series of points shown in fig 3 were set to monitor the sound pressure level spl changes in the central longitudinal section and propeller disk the distance between each unnumbered point and the propeller disk center was 2d each point was spaced apart from each other by 15 the distances between these numbered points were d the calculation converged after the noise performance remained unchanged after the propulsion model changed the simulation steps are repeated from the beginning the spl results of two propulsions for the noise reduction effect analysis are output from the solver then the work of the calculation parts is done in addition the contributions of different parts can be obtained according to the noise superposition equation 5 l p 10 lg 10 l p 1 10 10 l p 2 10 10 l pi 10 where l p is the total spl the subscript i stands for the numbers of different noise sources 4 numerical modeling all the flow simulation was performed with the solution technique implemented in fluent version 17 0 the details are introduced as below 4 1 computational domain with its meshing 4 1 1 main domain according to the submarine shape a cylinder domain was established the coordinate origin was located at the front top of the submarine axis directions domain sizes and boundary conditions were defined in fig 4 to ensure the flow field fully developed the inlet and outlet were 0 8l and 2l away from the stem and stern and the radius of the cylinder side was 10d max inlet outlet and side were set as the velocity inlet pressure outlet and symmetry separately due to the enough distance 25 times of propeller disk diameter d between the propulsion and side the flow field near the cylinder has little influence on the hydrodynamic noise results of this work in addition a control domain was established for the numerical simulation of propulsion flow field the computational domain excluding the control domain was named as domain 0 after the verification of the wake flow at the propeller disk the pump jet propulsion was installed at the submarine bottom then the grids in the control domain were remeshing grids of the computational domain are shown in fig 5 layer meshes are required for simulating turbulence especially at high reynolds numbers zhu and fang 2012 wang et al 2014 according to the simulation method sezen et al 2018 hexahedral structured grids were applied to keep y on the model surface under 1 the thickness of the first prismatic layer mesh was set as 10 5m with a stretching factor of 1 20 asnaghi et al 2018 zhang and jaimanb 2019 4 1 2 subdomain of propulsion the rotor with hub stator with duct and submarine tail were placed in some domains shown in fig 6 a domain 1 was where the rotor was placed domain 2 was hub vortex region and domain 3 was the control domain where the stator and duct were placed due to the central symmetry of propulsion models one blade one stator and 1 9 duct were processed separately then the entire mesh model can be obtained by the rotation replications of these girds illustrated in fig 6 similarly hexahedral structured grids were applied in the thickness adjustment of the first prismatic layer mesh conveniently 4 2 mesh sensitivity analysis in order to exclude the interference of grid parameters to the hydrodynamic performance predictions three meshing schemes were generated for grid independent validation the medium and fine grids were generated by reducing the global cell size of the mesh the grid numbers of coarse medium and fine grids were 8 02 million 11 44 million and 17 82 million respectively the major parameters are listed in table 2 the propulsion efficiencies computed with the coarse medium and fine grids were compared with each other the efficiency results of three grid schemes given in table 3 coincided reasonably well the increased mesh density had little impact on the efficiency calculation therefore the scheme of the medium grids was applied to the hydrodynamic simulation 5 result and discussion 5 1 validation of numerical model the validation takes two steps totally the aim of step 1 is to indicate the mesh scheme of the submarine is verified which makes sure that the grids around the submarine could provide a predictable wake flow then the grids around the stern are substituted after the installation of the pump jet propulsion the propulsive performance behind the submarine is validated in step 2 after these two steps we think the hydrodynamic performance under the impact of the submarine wake are verified 5 1 1 resistance performance of naked hull firstly the resistance performance of the naked hull bhushan et al 2013 was predicted the results are illustrated in fig 7 where the suffixes experiment and calculation represent the experimental and numerical data respectively the error of resistance performance at design advance coefficient u 0 3 051 m s is 2 54 with the enhancement of the flow speed the values of re and y are amplified correspondingly the errors of les method are increased at the design speed the 0 25d max wake flow distributions at x 4 260 m where the propeller disk located were calculated the comparison with the experimental results is shown in fig 8 the horizontal ordinate θ stands for the angular coordinate at the propeller disk and the vertical ordinate stands for the wake fraction u i i 1 2 3 is the wake velocity component in cartesian coordinate system and u i u 0 represents the wake fraction in that direction the axial velocity distribution is given in fig 9 according to the comparison results the reliability of the wake distribution results could be verified therefore the wake flow at u 0 3 051 m s was applied to the hydrodynamic performance simulation 5 1 2 hydrodynamic performance of pump jet propulsion the forces of rotor stator and duct were simulated by the les method according to the eq 3 the hydrodynamic coefficients were obtained and compared with the results liu 2013 of surface panel method spm the spm model is shown in fig 10 the hydrodynamic performance curves and pressure coefficient distributions are given in fig 11 and fig 12 it is showed that all the efficiency errors are less than 3 and the errors of k a 10 k q are less than 5 at the designed advanced coefficient j 0 724 after the observation of the pressure coefficient distributions the hydrodynamic performances are in good agreement therefore it is considered that the hydrodynamic performance results obtained by the les method are reliable in this paper the forces on each part was recorded and converted into the hydrodynamic coefficients the results shown in fig 13 indicate that the three parts can product positive thrusts among them the rotor thrust is the largest duct thrust is next stator thrust is the smallest comparing the force variations between the duct and the stator it can be seen that the fluctuation range and frequency of k d is much more magnificent than those of k s therefore the duct has a greater impact on hydrodynamic performance than the stator 5 2 noise performance and vortex distributions in order to analyze the noise reduction mechanism the noise intensities of different parts were observed meanwhile the vortex distributions around the propulsion were simulated the results are shown in fig 14 and fig 15 spl distributions in the central longitudinal section are plotted in fig 14 the hollow squares stand for the total spl the solid circles upper triangles and lower triangles represent the spl results of rotor duct and stator respectively according to equation 5 the total spl in different directions is made up by the spl of these three parts it can be seen that the spl contributions of different parts are directional the total spl perpendicular to the propeller shaft is the greatest the total spl along the propeller shaft is next and the total spl at 30 is the smallest with the comparison results it is concluded that the spl of the duct is distributed in the form of which contributes the most to the vertical spl the spl of the rotor is distributed in the form of 8 which contributes the most to the axial spl and the stator spl contribution is negligible fig 15 shows the vortex intensity distribution of the flow field the vortices generated by the propulsion consist of the vortices attached to the propulsion surface blade tip vortices hub vortex and trailing vortices of different parts the blade trailing vortices develop in the duct after being disturbed by the stator the vorticity intensity decreases rapidly when the wake flow reaches the duct trailing edge the vorticity intensity is basically 0 the tip vortex generated by the rotor moves backwards along the inner wall of the duct gradually merges with the vortex attached to the duct and forms a stronger vortex the stator also produces wake vortices these vortices exist right behind the stator fins and disappear rapidly in addition the vortex becomes weaker after the duct transformed in the later investigation the vortex magnitude will be analyzed in the section of x axis to make the view clearer according to the results the duct has a significant impact on the hydrodynamic performance and noise performance of the pump jet propulsion therefore the duct is modified to enhance the stealth performance of the submarine 5 3 hydrodynamic coefficients before and after modification the numerical method reliability of this work has been verified and the same mesh scheme is applied to the two propulsions the hydrodynamic performances before and after the modification were simulated after the hydrodynamic coefficient results obtained the changes of hydrodynamic performance are illustrated in fig 16 and table 4 in all the following figures te stands for trailing edge from the calculation results it can be seen that the thrusts and torques of the propulsion are reduced by the serrations at j 0 724 the thrust coefficient k a decreases by 1 51 the torque coefficient 10k q decreases by 1 49 and as the advance coefficient j increasing the thrust loss gradually becomes more significant the efficiency η a decreases by 0 37 at most therefore it is believed that the serrations have little impact on the efficiency in order to make up the thrust loss the rotation speed adjustments at j 0 5 0 724 0 9 are illustrated in table 5 after the adjustments the hydrodynamic coefficients are basically the same at each advance coefficient 5 4 noise reduction effect analysis 5 4 1 noise performance at propeller disk the noise performance of the pump jet propulsion was simulated the calculation results of the average spl at 2d away from the propeller disk center are described in table 6 in table 6 it can be seen that the average spl is decreased by 2 30 db at j 0 724 after the installation of the serrated trailing edge with the increase of the advance coefficient j the noise reduction effect gradually decreases in addition the rotation adjustment has a slightly impact on the effect 5 4 2 noise performance in central longitudinal section it is well known that the noise radiation is directional so the spl at different positions were observed during all the comparison process the propulsive thrusts were kept unchanged the spl results and the noise reduction effect were analyzed in fig 17 and fig 18 the results indicated that not only the spl but also the noise reduction effect is directional after the installation of the serrations the noise reduction effect is gradually reduced from upside and downside of the duct to the downstream of the flow which is negative in the range of 30 therefore the noise reduction effect is more significant at the upside and downside of the duct in addition as the rotation speed of the rotor increases the serrated trailing edge has a better noise reduction effect 5 4 3 sound pressure level spectrum spl spectrums of two propulsions are shown in fig 19 and fig 20 in the axial direction the spl of the low frequency noise is reduced significantly by 10 db 25 db after the installation of the serrated trailing edge in the range where the noise frequency is greater than 1000 hz the noise sound pressure level is increased by 1 db due to the spl existence of the first five order blade frequency the noise reduction effect at the low frequencies doesn t come out thus axial spl increases slightly in the radial direction the spl in the overall frequency range is reduced by 3 db 10 db compared with the axial noise reduction effect the radial noise reduction effect is less obvious when the noise frequency less than 1000 hz and there are still some noise reduction effects in the high frequency range 5 5 flow field of propulsions aiming at the observation of the flow field information two sections were taken in the propulsion system the two sections are located where fig 21 shows the distances between the two sections and the propeller disk were 0 15d x 4 29 m and 0 4d x 4 34 m the simulation cases were imported into the tecplot software and the flow field information was visual output from fig 22 to fig 26 the analysis results are illustrated as follows 5 5 1 pressure distribution j 0 724 as the serrated trailing edge installed the pressure distributions on the ducts given by fig 22 change the pressure in the former half of the duct is hardly affected the pressure on the inner and outer sides near the trailing edge becomes smaller while the pressure change on the duct contributes little to the axial force change fig 23 shows the pressure distribution near the pump jet propulsion it is indicated that after the installation of the serrations the fluid pressure before the rotor is not affected the fluid pressure between the rotor and the stator is reduced and the fluid pressure after the stator and the duct is increased the pressure distribution changes response to the thrust coefficient changes in the previous analysis 5 5 2 velocity distribution j 0 724 fig 24 provides the axial velocity contours of the pump jet propulsions it is showed that the serrations have little impact on the velocity distributions between the rotor and the stator while the smooth contour lines become tortuous behind the serrated trailing edge based on the results it is found that velocity distribution around the blade tips and the hub unchanged and the cavitation numbers are very small the cavitation numbers behind the serrated trailing edge are reduced slightly with the velocity increased which are still much higher than any other locations therefore the cavitation performance of the propulsion is unaffected with the installation of the serrated trailing edge 5 5 3 vortex distribution in order to analyze the noise reduction mechanism the vortex intensity distribution is compared the comparison results are given in fig 25 and fig 26 from figs 25 and 26 it can be found that the vortex intensity at x 4 29 m is substantially unchanged while there are some significant changes at x 4 34 m as the advance coefficient increased the rotational movement slows down which leads to the vortex intensity reduction the vortex intensity behind the straight trailing edge is circumferentially continuous after the installation of the serrations the vortex intensity is greatly reduced and the circumferential continuity is destroyed which lead to the diffusion acceleration of the vortex on the basis of the results about the noise contributions of the different parts it can be analyzed that the noise reduction effect is directional the axial noise is mainly generated by the rotor and the radial noise is contributed by the duct majorly the serrated trailing edge accelerates the trailing vortex diffusion and weakens the radial force fluctuation of the duct which results in the radial spl decreased 6 conclusion pump jet propulsions have more blades and a higher expanded area ratio which can delay the cavitation occurrence significantly therefore the cavitation noise isn t taken into account in this research in this work the pump jet propulsion was installed at the stern of the suboff submarine the reynolds number was 6 3 106 which exceeded the critical value the hydrodynamic coefficients and flow turbulences are hardly affected by the scale effect the hydrodynamic performance was simulated by large eddy simulation les method and sliding mesh technique after the flow field stabilization fw h model was added to predict the noise performance then the pump jet propulsion was modified by the installation of the serrated trailing edge on the duct and the hydrodynamic noise performance was predicted with the simulation results the noise reduction effect was analyzed the conclusions are as follows 1 the validation of the numerical results shows that all the errors of the hydrodynamic coefficients are within acceptable limits the pressure coefficient distributions are in good agreement therefore it is considered that the hydrodynamic performance results obtained are reliable in this paper in addition the same mesh scheme and numerical method is applied to the two propulsions so the contrast results are reasonable 2 comparing the force variations between the duct and the stator it can be seen that the fluctuation range and frequency of k d is much more magnificent than those of k s therefore the duct has a greater impact on hydrodynamic performance than the stator 3 based on the flow field distribution the noise performance was analyzed the spl of the pump jet propulsion is directional the spl perpendicular to the shaft is the greatest the spl along the shaft is smaller and the spl at 30 is the smallest by observing the noise performance of each part separately it is found that the duct spl is distributed in the shape of which contributes the most to the vertical spl the rotor is distributed in the shape of 8 which contributes the most to the axial spl and the stator spl contribution is negligible 4 the installation of the serrated trailing edge reduces the propulsion thrust torque and propulsive efficiency slightly it is considered that the serrated trailing edge has little impact on the hydrodynamic performance while the propulsion spl changes significant the noise reduction effect is also directional the effect is the most significant in the range where the duct noise contributes greater 5 the axial spl of the low frequency noise is reduced significantly by 10 db 25 db after the installation of the serrated trailing edge due to the spl existence of the first five order blade frequency the noise reduction effect at the low frequencies doesn t come out at same time the spl at the high frequency is increased by 1 db because of the small vortex increase thus axial spl increases slightly by contrast the radial spl in the overall frequency range is reduced by 3 db 10 db 6 the vortex near the trailing edge of the original duct is circumferentially continuous with the installation of the serrated trailing edge the vortex intensity is greatly reduced and broken into smaller vortex therefore the circumferential continuity is weakened which accelerates the diffusion of the vortex this change of the vortex intensity can reduce the radial force fluctuation and noise radiation of the duct overall it can be seen that the research about the serrated trailing edge is very attractive to the marine propulsion noise reduction since only the numerical simulation of the noise reduction effect has been carried out in this research the future work may focus on the optimization of serration parameters and how to design an experiment scheme to verify the above results acknowledgements this work was supported by the national natural science foundation of china grant numbers 551009038 and the china postdoctoral science foundation grant number 2013m540271 
22413,for ships the stealth performance is an important indicator of its vitality it is extremely important to study the noise reduction of ship propulsions in this work pump jet propulsion with a darpa suboff submarine was taken as the investigated object the trailing edge of its duct was transformed with some serrations and its noise reduction effect was studied large eddy simulation les method was utilized to predict the hydrodynamic performance of the pump jet propulsion then the fw h acoustic model was added into the noise performance simulation after the flow stabilization after the installation of the serrated trailing edge the propulsion sound pressure level spl changes were observed according to the contributions of different parts to the noise intensity and the vortex field changes the noise reduction effect was analyzed the results indicate that not only the propulsion noise radiation but also the noise reduction effect is directional due to the larger noise contribution of the duct the serrated trailing edge has a better effect in the radial direction in addition the circumferential correlation of the duct vortex is broken by the serrations the large vortices are divided into several small ones and the vortex diffusion is accelerated keywords noise reduction large eddy simulation serrated trailing edge pump jet propulsion acoustic simulation 1 introduction in the process of navigation the ship will produce noise which will not only affect the sonar s working but also reduce the ship stealth performance with the continuous improvement of ship speed the engine power increases gradually which also leads to the enhancement of the propulsion load and noise intensity thus how to reduce the propulsion noise is an attractive topic in ship propulsion research about the experimental researches and engineering applications of the serrated trailing edge a lot of investigations have been done most of those are focused on the aerodynamic noise reduction of airfoils sandberg and jones 2011 employed the direct numerical simulation dns in the noise performance predictions of naca0012 airfoils according to the flow field changes it is found that the spanwise correlation of the flow field is weakened by the serrations the vortices were broken into several small pieces which accelerated the vortex diffusion and resulted in noise reduction some similar researches pröbsting 2011 chong et al 2013 2015 were carried out particle image velocimetry piv technology was introduced in the flow field observation the results indicated that the airfoil spl decreased with the installation of the trailing edge serrations in addition increasing the serration width and height would make the noise reduction effect greater then chong and joseph 2013 designed an experiment on a series of plats modified with the serrated trailing edge besides the noise reduction effect the result showed that the spl reduced more significant as the wind speed decreased zhu and shen 2015 modified the dtu ln118 airfoil and used the large eddy simulation les to predict its aerodynamic performance the results showed that there was little influence of the serrations on the aerodynamic performance of the dtu ln118 airfoil the broadband noise generated by a naca0018 airfoil with trailing edge serrations was investigated león et al 2017 varying both the airfoil angle of attack and serration flap angle the results showed that the installation angles have an influence on the noise reduction effect furthermore the impacts of the serration shapes and parameters on the noise reduction effect were investigated avallone et al 2017 lau and huang 2018 juknevicius and chong 2018 mathews and peake 2018 the results manifested that the serration optimization could make the noise reduction effect enhanced in the field of engineering applications oerlemans et al 2007 applied serration noise reduction to the blade trailing edge of a fan in his monitor range the total spl was decreased as much as 3 2 db a simulation wang et al 2018b using large eddy simulation les is demonstrated to predict the near field turbulence and far field acoustics from an ultra high bypass ratio engine with round and serrated nozzles it was found that the serrations shifted the energy from the low frequencies to the high frequencies and decreased overall spls by about 3 db over the low frequency range experimental studies lee et al 2019 in an anechoic chamber were conducted to investigate the influence of quarter flat tip half flat tip and rectangular serrations on reducing propeller trailing edge noise the results showed the significant noise reduction effect however the propulsive thrust was also weakened almost all the above works pay close attention to the noise performance of airfoils and ignore the aerodynamic performance analysis at the same time the engineering applications in the ship propulsion are barely any for submarines stealth performance is one of the important indicators to measure their viability as a kind of advanced propulsion pump jet propulsions have more blades and a higher expanded area ratio which can reduce the radiated noise improve the submarine low noise speed and delay the cavitation occurrence significantly therefore the cavitation noise isn t taken into account in this research liu 2013 designed a pump jet propulsion for a submarine by circumfluence theory combined with surface panel method spm and lifting design method of axial flow pump in his doctoral dissertation his research results will provide data support for the simulation method validation in this work built on his design the pump jet propulsion was transformed with the serrated trailing edge installed on a pump jet propulsion and the noise reduction effect was investigated the large eddy simulation les method was applied to the hydrodynamic performance prediction and the fw h acoustic model was used to calculate the noise performance after the steady flow field obtained by comparing the flow field and hydrodynamic noise performance of propulsions the noise reduction mechanisms were analyzed the results will contribute to improving the stealth performance of submarine and provide a new research method and design idea to promote noise reduction of ship propulsion 2 investigation object our study object was a pump jet propulsion designed by liu 2013 which powered a darpa suboff submarine with full appendages the full model is introduced as followed 2 1 submarine model the noise reduction effect of serrated trailing edge installed on a pump jet duct was investigated in this work in order to obtain the results closer to the real situation a darpa suboff submarine designed for the experimental research in the model scale was set to provide a wake flow the overall length l of the submarine was 4356 mm and the diameter d max of the parallel middle body was 508 mm the rest major parameters are given in fig 1 2 2 pump jet propulsion the origin propulsion model is shown in fig 2 a the blue part was the rotor the red part was the stator and the grey part was the duct of which the trailing edge was straight after spread out its major parameters are described in table 1 the submarine speed u 0 was fixed at 3 051 m s and the design propulsion rotation speed n was 1264 rpm accordingly the design advance coefficient j was 0 724 and the reynolds number re was 6 3 106 which exceeded the critical re the hydrodynamic coefficients and flow turbulences are hardly affected by the scale effect therefore we think the investigation results can be applied in the real scale in this paper a serrated trailing edge was installed on the duct to reduce the propulsion radiation noise the serration length was one tenth of the duct chord chong et al 2013 and the serration number was 54 the transformed propulsion is illustrated in fig 2b 3 mathematic base 3 1 theoretical basis of les method there are three computational fluid dynamics cfd method for the turbulence simulation wagner et al 2007 ansys inc 2011 1 direct numerical simulation dns 2 large eddy simulation les 3 reynolds averaged navier stokes rans dns method has the highest accuracy but the number of grids is excessively huge rans method has difficulty in providing enough pressure fluctuation and vortex distribution information for hydrodynamic noise prediction les method can obtain more flow details with a much higher accuracy in the solution process of the les method it is essential to use the filter function to classify the physical quantities in the flow field which include the large scale physical quantities that can be directly calculated and the small scale quantities that can be modeled therefore the continuity equation and the incompressible navier stokes equation can be rewritten as following form 1 u i x i 0 2 u i t x j u i u j 1 ρ p x i v 2 u i x j 2 x j τ i j s where i j 1 2 3 which stand for the spatial coordinates directions u i represents the velocity component in the x i direction u is the average velocity component after filtering operation ρ is fluid density ν is the kinematic viscous coefficient and τ i j s u i u j u i u j is subgrid scale reynolds stress clark 1979 mcmillan and ferziger 1978 this study employed the les model in the task of analyzing the hydrodynamic acoustics of the propulsions as a typical rotating machine the rotor of pump jet propulsion performs a periodic rotational motion sliding mesh technique carrica et al 2012 was applied to the unsteady rotation motion simulation of the rotor in all the simulations which were run by using the pressure based solver wei et al 2016 wang et al 2018a the simplec algorithm was applied for pressure velocity coupling with second order used for pressure discretization bounded central differencing for momentum term and second order implicit discretization for time term according to the range of noise frequency monitored each time step was fixed at 10 5s in which 20 iterations were proceeded the reducing time step will not affect the calculation results of noise performance kim et al 2006 li et al 2018 the hydrodynamic performance calculation converged after the propulsion forces and flow field stabled by simulating the unsteady flow field the thrust t and torque q as a function of the advance coefficient j were obtained the hydrodynamic performance coefficients of the propulsion system were calculated according to the following formulas zhang and jaimanb 2019 advance coefficient j v n d thrust coefficient of the rotor k t t ρ n 2 d 4 torque coefficient of the rotor k q q ρ n 2 d 5 thrust coefficient of the stator k s t s ρ n 2 d 4 3 thrust coefficient of the duct k d t d ρ n 2 d 4 total thrust coefficient k a k t k s k d efficiency of propulsion system η a j 2 π k a k q where j is the advance coefficient ρ is the fluid density kg m3 v is the inflow velocity m s n is the rotation speed 1 s d is the propeller diameter m t and q are the thrust n and torque n m of the propeller rotor t s and t d n are the thrust of stator and duct 3 2 acoustic simulation method fw h equation was employed in the acoustic simulation whose governing equation was given by 4 1 c 0 2 p t 2 2 p t ρ 0 v n ρ u n v n δ f x i p i j n j ρ u i u n v n δ f 2 x i x j t i j h f where c 0 and ρ 0 are the reference sound speed and fluid density p p p 0 is the sound pressure of the disturbed flow field δ i j represents the kronecker product function δ f and h f represent the dirac delta function and heaviside function f represents the wall function u n stands for the flow velocity component in the x i direction and v n stands for the normal velocity component on the wall the acoustic model was added into the hydrodynamic performance simulation after the flow field simulation converged kowalczyk and felicjancik 2016 li et al 2018 of which the rest settings were unchanged in the water the reference sound pressure is 10 6pa and the sound speed is 1500 m s during the acoustic performance simulation a series of points shown in fig 3 were set to monitor the sound pressure level spl changes in the central longitudinal section and propeller disk the distance between each unnumbered point and the propeller disk center was 2d each point was spaced apart from each other by 15 the distances between these numbered points were d the calculation converged after the noise performance remained unchanged after the propulsion model changed the simulation steps are repeated from the beginning the spl results of two propulsions for the noise reduction effect analysis are output from the solver then the work of the calculation parts is done in addition the contributions of different parts can be obtained according to the noise superposition equation 5 l p 10 lg 10 l p 1 10 10 l p 2 10 10 l pi 10 where l p is the total spl the subscript i stands for the numbers of different noise sources 4 numerical modeling all the flow simulation was performed with the solution technique implemented in fluent version 17 0 the details are introduced as below 4 1 computational domain with its meshing 4 1 1 main domain according to the submarine shape a cylinder domain was established the coordinate origin was located at the front top of the submarine axis directions domain sizes and boundary conditions were defined in fig 4 to ensure the flow field fully developed the inlet and outlet were 0 8l and 2l away from the stem and stern and the radius of the cylinder side was 10d max inlet outlet and side were set as the velocity inlet pressure outlet and symmetry separately due to the enough distance 25 times of propeller disk diameter d between the propulsion and side the flow field near the cylinder has little influence on the hydrodynamic noise results of this work in addition a control domain was established for the numerical simulation of propulsion flow field the computational domain excluding the control domain was named as domain 0 after the verification of the wake flow at the propeller disk the pump jet propulsion was installed at the submarine bottom then the grids in the control domain were remeshing grids of the computational domain are shown in fig 5 layer meshes are required for simulating turbulence especially at high reynolds numbers zhu and fang 2012 wang et al 2014 according to the simulation method sezen et al 2018 hexahedral structured grids were applied to keep y on the model surface under 1 the thickness of the first prismatic layer mesh was set as 10 5m with a stretching factor of 1 20 asnaghi et al 2018 zhang and jaimanb 2019 4 1 2 subdomain of propulsion the rotor with hub stator with duct and submarine tail were placed in some domains shown in fig 6 a domain 1 was where the rotor was placed domain 2 was hub vortex region and domain 3 was the control domain where the stator and duct were placed due to the central symmetry of propulsion models one blade one stator and 1 9 duct were processed separately then the entire mesh model can be obtained by the rotation replications of these girds illustrated in fig 6 similarly hexahedral structured grids were applied in the thickness adjustment of the first prismatic layer mesh conveniently 4 2 mesh sensitivity analysis in order to exclude the interference of grid parameters to the hydrodynamic performance predictions three meshing schemes were generated for grid independent validation the medium and fine grids were generated by reducing the global cell size of the mesh the grid numbers of coarse medium and fine grids were 8 02 million 11 44 million and 17 82 million respectively the major parameters are listed in table 2 the propulsion efficiencies computed with the coarse medium and fine grids were compared with each other the efficiency results of three grid schemes given in table 3 coincided reasonably well the increased mesh density had little impact on the efficiency calculation therefore the scheme of the medium grids was applied to the hydrodynamic simulation 5 result and discussion 5 1 validation of numerical model the validation takes two steps totally the aim of step 1 is to indicate the mesh scheme of the submarine is verified which makes sure that the grids around the submarine could provide a predictable wake flow then the grids around the stern are substituted after the installation of the pump jet propulsion the propulsive performance behind the submarine is validated in step 2 after these two steps we think the hydrodynamic performance under the impact of the submarine wake are verified 5 1 1 resistance performance of naked hull firstly the resistance performance of the naked hull bhushan et al 2013 was predicted the results are illustrated in fig 7 where the suffixes experiment and calculation represent the experimental and numerical data respectively the error of resistance performance at design advance coefficient u 0 3 051 m s is 2 54 with the enhancement of the flow speed the values of re and y are amplified correspondingly the errors of les method are increased at the design speed the 0 25d max wake flow distributions at x 4 260 m where the propeller disk located were calculated the comparison with the experimental results is shown in fig 8 the horizontal ordinate θ stands for the angular coordinate at the propeller disk and the vertical ordinate stands for the wake fraction u i i 1 2 3 is the wake velocity component in cartesian coordinate system and u i u 0 represents the wake fraction in that direction the axial velocity distribution is given in fig 9 according to the comparison results the reliability of the wake distribution results could be verified therefore the wake flow at u 0 3 051 m s was applied to the hydrodynamic performance simulation 5 1 2 hydrodynamic performance of pump jet propulsion the forces of rotor stator and duct were simulated by the les method according to the eq 3 the hydrodynamic coefficients were obtained and compared with the results liu 2013 of surface panel method spm the spm model is shown in fig 10 the hydrodynamic performance curves and pressure coefficient distributions are given in fig 11 and fig 12 it is showed that all the efficiency errors are less than 3 and the errors of k a 10 k q are less than 5 at the designed advanced coefficient j 0 724 after the observation of the pressure coefficient distributions the hydrodynamic performances are in good agreement therefore it is considered that the hydrodynamic performance results obtained by the les method are reliable in this paper the forces on each part was recorded and converted into the hydrodynamic coefficients the results shown in fig 13 indicate that the three parts can product positive thrusts among them the rotor thrust is the largest duct thrust is next stator thrust is the smallest comparing the force variations between the duct and the stator it can be seen that the fluctuation range and frequency of k d is much more magnificent than those of k s therefore the duct has a greater impact on hydrodynamic performance than the stator 5 2 noise performance and vortex distributions in order to analyze the noise reduction mechanism the noise intensities of different parts were observed meanwhile the vortex distributions around the propulsion were simulated the results are shown in fig 14 and fig 15 spl distributions in the central longitudinal section are plotted in fig 14 the hollow squares stand for the total spl the solid circles upper triangles and lower triangles represent the spl results of rotor duct and stator respectively according to equation 5 the total spl in different directions is made up by the spl of these three parts it can be seen that the spl contributions of different parts are directional the total spl perpendicular to the propeller shaft is the greatest the total spl along the propeller shaft is next and the total spl at 30 is the smallest with the comparison results it is concluded that the spl of the duct is distributed in the form of which contributes the most to the vertical spl the spl of the rotor is distributed in the form of 8 which contributes the most to the axial spl and the stator spl contribution is negligible fig 15 shows the vortex intensity distribution of the flow field the vortices generated by the propulsion consist of the vortices attached to the propulsion surface blade tip vortices hub vortex and trailing vortices of different parts the blade trailing vortices develop in the duct after being disturbed by the stator the vorticity intensity decreases rapidly when the wake flow reaches the duct trailing edge the vorticity intensity is basically 0 the tip vortex generated by the rotor moves backwards along the inner wall of the duct gradually merges with the vortex attached to the duct and forms a stronger vortex the stator also produces wake vortices these vortices exist right behind the stator fins and disappear rapidly in addition the vortex becomes weaker after the duct transformed in the later investigation the vortex magnitude will be analyzed in the section of x axis to make the view clearer according to the results the duct has a significant impact on the hydrodynamic performance and noise performance of the pump jet propulsion therefore the duct is modified to enhance the stealth performance of the submarine 5 3 hydrodynamic coefficients before and after modification the numerical method reliability of this work has been verified and the same mesh scheme is applied to the two propulsions the hydrodynamic performances before and after the modification were simulated after the hydrodynamic coefficient results obtained the changes of hydrodynamic performance are illustrated in fig 16 and table 4 in all the following figures te stands for trailing edge from the calculation results it can be seen that the thrusts and torques of the propulsion are reduced by the serrations at j 0 724 the thrust coefficient k a decreases by 1 51 the torque coefficient 10k q decreases by 1 49 and as the advance coefficient j increasing the thrust loss gradually becomes more significant the efficiency η a decreases by 0 37 at most therefore it is believed that the serrations have little impact on the efficiency in order to make up the thrust loss the rotation speed adjustments at j 0 5 0 724 0 9 are illustrated in table 5 after the adjustments the hydrodynamic coefficients are basically the same at each advance coefficient 5 4 noise reduction effect analysis 5 4 1 noise performance at propeller disk the noise performance of the pump jet propulsion was simulated the calculation results of the average spl at 2d away from the propeller disk center are described in table 6 in table 6 it can be seen that the average spl is decreased by 2 30 db at j 0 724 after the installation of the serrated trailing edge with the increase of the advance coefficient j the noise reduction effect gradually decreases in addition the rotation adjustment has a slightly impact on the effect 5 4 2 noise performance in central longitudinal section it is well known that the noise radiation is directional so the spl at different positions were observed during all the comparison process the propulsive thrusts were kept unchanged the spl results and the noise reduction effect were analyzed in fig 17 and fig 18 the results indicated that not only the spl but also the noise reduction effect is directional after the installation of the serrations the noise reduction effect is gradually reduced from upside and downside of the duct to the downstream of the flow which is negative in the range of 30 therefore the noise reduction effect is more significant at the upside and downside of the duct in addition as the rotation speed of the rotor increases the serrated trailing edge has a better noise reduction effect 5 4 3 sound pressure level spectrum spl spectrums of two propulsions are shown in fig 19 and fig 20 in the axial direction the spl of the low frequency noise is reduced significantly by 10 db 25 db after the installation of the serrated trailing edge in the range where the noise frequency is greater than 1000 hz the noise sound pressure level is increased by 1 db due to the spl existence of the first five order blade frequency the noise reduction effect at the low frequencies doesn t come out thus axial spl increases slightly in the radial direction the spl in the overall frequency range is reduced by 3 db 10 db compared with the axial noise reduction effect the radial noise reduction effect is less obvious when the noise frequency less than 1000 hz and there are still some noise reduction effects in the high frequency range 5 5 flow field of propulsions aiming at the observation of the flow field information two sections were taken in the propulsion system the two sections are located where fig 21 shows the distances between the two sections and the propeller disk were 0 15d x 4 29 m and 0 4d x 4 34 m the simulation cases were imported into the tecplot software and the flow field information was visual output from fig 22 to fig 26 the analysis results are illustrated as follows 5 5 1 pressure distribution j 0 724 as the serrated trailing edge installed the pressure distributions on the ducts given by fig 22 change the pressure in the former half of the duct is hardly affected the pressure on the inner and outer sides near the trailing edge becomes smaller while the pressure change on the duct contributes little to the axial force change fig 23 shows the pressure distribution near the pump jet propulsion it is indicated that after the installation of the serrations the fluid pressure before the rotor is not affected the fluid pressure between the rotor and the stator is reduced and the fluid pressure after the stator and the duct is increased the pressure distribution changes response to the thrust coefficient changes in the previous analysis 5 5 2 velocity distribution j 0 724 fig 24 provides the axial velocity contours of the pump jet propulsions it is showed that the serrations have little impact on the velocity distributions between the rotor and the stator while the smooth contour lines become tortuous behind the serrated trailing edge based on the results it is found that velocity distribution around the blade tips and the hub unchanged and the cavitation numbers are very small the cavitation numbers behind the serrated trailing edge are reduced slightly with the velocity increased which are still much higher than any other locations therefore the cavitation performance of the propulsion is unaffected with the installation of the serrated trailing edge 5 5 3 vortex distribution in order to analyze the noise reduction mechanism the vortex intensity distribution is compared the comparison results are given in fig 25 and fig 26 from figs 25 and 26 it can be found that the vortex intensity at x 4 29 m is substantially unchanged while there are some significant changes at x 4 34 m as the advance coefficient increased the rotational movement slows down which leads to the vortex intensity reduction the vortex intensity behind the straight trailing edge is circumferentially continuous after the installation of the serrations the vortex intensity is greatly reduced and the circumferential continuity is destroyed which lead to the diffusion acceleration of the vortex on the basis of the results about the noise contributions of the different parts it can be analyzed that the noise reduction effect is directional the axial noise is mainly generated by the rotor and the radial noise is contributed by the duct majorly the serrated trailing edge accelerates the trailing vortex diffusion and weakens the radial force fluctuation of the duct which results in the radial spl decreased 6 conclusion pump jet propulsions have more blades and a higher expanded area ratio which can delay the cavitation occurrence significantly therefore the cavitation noise isn t taken into account in this research in this work the pump jet propulsion was installed at the stern of the suboff submarine the reynolds number was 6 3 106 which exceeded the critical value the hydrodynamic coefficients and flow turbulences are hardly affected by the scale effect the hydrodynamic performance was simulated by large eddy simulation les method and sliding mesh technique after the flow field stabilization fw h model was added to predict the noise performance then the pump jet propulsion was modified by the installation of the serrated trailing edge on the duct and the hydrodynamic noise performance was predicted with the simulation results the noise reduction effect was analyzed the conclusions are as follows 1 the validation of the numerical results shows that all the errors of the hydrodynamic coefficients are within acceptable limits the pressure coefficient distributions are in good agreement therefore it is considered that the hydrodynamic performance results obtained are reliable in this paper in addition the same mesh scheme and numerical method is applied to the two propulsions so the contrast results are reasonable 2 comparing the force variations between the duct and the stator it can be seen that the fluctuation range and frequency of k d is much more magnificent than those of k s therefore the duct has a greater impact on hydrodynamic performance than the stator 3 based on the flow field distribution the noise performance was analyzed the spl of the pump jet propulsion is directional the spl perpendicular to the shaft is the greatest the spl along the shaft is smaller and the spl at 30 is the smallest by observing the noise performance of each part separately it is found that the duct spl is distributed in the shape of which contributes the most to the vertical spl the rotor is distributed in the shape of 8 which contributes the most to the axial spl and the stator spl contribution is negligible 4 the installation of the serrated trailing edge reduces the propulsion thrust torque and propulsive efficiency slightly it is considered that the serrated trailing edge has little impact on the hydrodynamic performance while the propulsion spl changes significant the noise reduction effect is also directional the effect is the most significant in the range where the duct noise contributes greater 5 the axial spl of the low frequency noise is reduced significantly by 10 db 25 db after the installation of the serrated trailing edge due to the spl existence of the first five order blade frequency the noise reduction effect at the low frequencies doesn t come out at same time the spl at the high frequency is increased by 1 db because of the small vortex increase thus axial spl increases slightly by contrast the radial spl in the overall frequency range is reduced by 3 db 10 db 6 the vortex near the trailing edge of the original duct is circumferentially continuous with the installation of the serrated trailing edge the vortex intensity is greatly reduced and broken into smaller vortex therefore the circumferential continuity is weakened which accelerates the diffusion of the vortex this change of the vortex intensity can reduce the radial force fluctuation and noise radiation of the duct overall it can be seen that the research about the serrated trailing edge is very attractive to the marine propulsion noise reduction since only the numerical simulation of the noise reduction effect has been carried out in this research the future work may focus on the optimization of serration parameters and how to design an experiment scheme to verify the above results acknowledgements this work was supported by the national natural science foundation of china grant numbers 551009038 and the china postdoctoral science foundation grant number 2013m540271 
22414,this paper investigates the distributed time varying formation control for a swarm of under actuated autonomous surface vehicles subject to unknown input gains in addition to model uncertainties and ocean disturbances the fleet is required to follow a parameterized path with a time varying formation while avoiding collisions and maintaining connectivity at a complex sea environment at the kinematic level a distributed guidance control law is proposed based on a consensus approach a path following design artificial potential functions and an auxiliary variable approach at the kinetic level an adaptive kinetic control law is designed based on an indirect model reference adaptive control approach where a neural estimator is developed for identifying unknown input gains model uncertainties and ocean disturbances the stability of the closed loop system is proven via cascade stability analysis the advantage of the proposed method is three folds first the developed time varying formation controller is able to achieve various coordinated behaviors such as cooperative target tracking and target enclosing second the proposed time varying formation controller is robust against model uncertainties ocean disturbances and unknown input gains third the proposed distributed controller holds the capability of collision avoidance and connectivity preservation simulation results substantiate the effectiveness of the proposed path guided time varying formation controllers keywords parameterized path time varying formation control autonomous surface vehicles collision avoidance connectivity preservation indirect model reference adaptive control 1 introduction during the past few years formation control of autonomous surface vehicles has aroused compelling research interest peng et al 2018 2019a 2019b liu et al in press 2019 2019a 2019b 2018a 2017a 2017b dai et al 2016 2018 li et al 2018b park and yoo 2019 zhang et al 2019 xiang et al 2017a b shi et al 2017 qin et al 2018 in press 2019a in press 2019b due to its broad applications in offshore marine industry many missions that are difficult to finish by single surface vehicle could be accomplished by multiple surface vehicles in a cooperative fashion aimed at achieving expected formation behaviors various approaches have been proposed including graph based method li et al 2018a 2017 peng et al 2018 yuan et al 2018 virtual structure method beard et al 2001 leader follower method jin 2016 sun et al 2018 shojaei 2016 peng et al 2013 cui et al 2010 behavioral method balch and arkin 1998 and artificial potential field method liu et al 2018b ge et al 2016 in particular the graph based method has been intensively studied in the literature liu et al in press 2019 ihle et al 2007 almeida et al 2010 2011 chen and wei 2014 skjetne et al 2004 liu et al 2017d c peng et al 2018 2019a 2017a 2017b gu et al 2019 yuan et al 2018 qin et al 2018 in press 2019a in light of types of leaders they can be generally categorized into trajectory guided coordinated control qin et al 2018 in press 2019a fu and yu 2018 park and yoo 2019 ma and zeng 2015 li and wang 2013 liu et al 2015 peng et al 2016 2018 and path guided coordinated control liu et al in press 2019 ihle et al 2007 almeida et al 2010 chen and wei 2014 skjetne et al 2004 liu et al 2017d c almeida et al 2011 gu et al in press 2019b peng et al in press 2019 a salient feature of path guided coordinated control is that the spatial constraint and temporal constraint can be decoupled cooperative path following with the full knowledge of multiple parameterized paths has been studied in liu et al in press 2019 ihle et al 2007 almeida et al 2010 chen and wei 2014 skjetne et al 2004 liu et al 2017d c almeida et al 2011 gu et al in press 2019b where the formation pattern is achieved by coordinating the path variables in cooperative path following each vehicle should be assigned a parameterized path known as a priori in case that the numbers of paths are less than that of the follower vehicles distributed path maneuvering with the partial knowledge of multiple parameterized paths are addressed in peng et al 2017a b gu et al 2019 zhang et al 2019 such that a containment formation is reached without assigning a path to each vehicle in light of one parameterized path distributed path maneuvering of asvs is considered in peng et al 2018 2019a however the restrictions are two folds first the collisions among asvs are not considered in peng et al 2017a b gu et al 2019 peng et al 2018 besides the network connectivity may not be preserved at a complex sea environment second the results in peng et al 2017a b gu et al 2019 peng et al 2018 2019a are confined to fully actuated asvs which means that they are not applicable to under actuated asvs this will limit their applications in marine practice as most marine vehicles are configured or moving in an under actuated fashion the kinetics of asvs suffer from model uncertainties unmodelled hydrodynamics and unknown environmental forces caused by wind waves and ocean currents motion control of marine vehicles subject to model uncertainties unmodelled dynamics and external disturbances is a long lasting research topic which has been extensively studied and the existing literature is rich in order to address system uncertainties many efficient methods have been proposed including parametric adaptive control skjetne et al 2005 do et al 2004 do and pan 2006 almeida et al 2010 sliding model control zhang et al 2000 fahimi 2007 ashrafiuon et al 2008 cui et al 2016 yu et al 2012 liu et al 2014 robust control do et al 2004 do and pan 2006 annamalai et al 2014 do and jiang 2004 do 2016 neural network control tee and ge 2006 cui et al 2010 peng et al 2013 chen et al 2016 2013 dai et al 2012 cui et al 2016 yin and xiao 2017 peng et al 2015 2017a 2017b fuzzy control yang et al 2003 chen and tan 2013 peng et al 2018 disturbance observer based control do 2012 zheng et al 2018 zheng and feroskhan 2017a and extended state observer based control liu et al 2017b cui et al 2017 lei and guo 2015 fu and yu 2018 it should be pointed out that most works assume that the input gains relevant to system inertial parameters are assumed to be known in advance however the identification of the input gains needs time consuming experiments although nominal input gains could be obtained by experiments they may suffer from perturbations due to load variations or actuator faults from a practical perspective it is highly desirable to develop an adaptive controller adapting to unknown input gains in addition to model uncertainties and ocean disturbances motivated by the above observations this paper considers the distributed time varying formation control problem of under actuated asvs subject to unknown input gains in addition to system uncertainties the vehicle group is guided by a parameterized path where collisions and obstacles should be avoided due to the limited communication ranges at a complex sea environment the connectivity is requited to be connected to address the above problem a distributed guidance law is proposed at the kinematic loop based on a consensus approach a path following design artificial potential functions and an axillary variable approach to deal with the under actuation in the kinetic control loop a neural estimator is developed for estimating the unknown uncertainties environmental disturbances and unknown control gains then an adaptive kinetic control law is designed on the basis of indirect model reference adaptive control approach the stability of the closed loop system is proven via cascade stability analysis finally simulation results substantiate the efficacy of the proposed method for time varying formation control of under actuated asvs compared with existing results on formation control of marine vehicles the salient features of the proposed method are as follows distributed formation control of asvs are addressed in peng et al 2017a b 2018 2019a qin et al 2018 in press 2019a dai et al 2018 fu and yu 2018 while these results are confined to fully actuated asvs this paper aims to address the distributed formation maneuvering of under actuated asvs guided by one parameterized path different from peng et al 2017a b 2018 2019a qin et al 2018 in press 2019a dai et al 2018 fu and yu 2018 li et al 2018a the proposed formation control method is able to achieve a time varying formation pattern in contrast to the distributed formation control methods in qin et al 2018 in press 2019a peng et al 2017a b 2018 gu et al 2019 li et al 2018a fu and yu 2018 the proposed formation controllers are capable of avoiding collisions and obstacles and preserving network connectivity in a complex maritime environment compared with the previous results in tee and ge 2006 cui et al 2010 peng et al 2013 chen et al 2016 2013 dai et al 2012 cui et al 2016 yin and xiao 2017 peng et al 2015 2017a 2017b zheng and feroskhan 2017b zheng et al 2018 zheng and feroskhan 2017a gu et al in press 2019a where the unknown input gains are not addressed or inertial matrix is assumed to be known an indirect model reference adaptive control is developed herein such that the input gains or inertial matrix are not required to be known 2 preliminaries in the paper the following notations are used denotes the absolute value of a real number denotes the euclidean norm of a vector λ min denotes the minimum eigenvalue of a matrix 2 1 potential function for collision avoidance the potential function for collision avoidance between asvs is defined as 1 v i j c p i j min 0 p i j 2 r 2 p i j 2 r 2 2 where i j 1 m i j p i j x i x j 2 y i y j 2 with x i y i t and x j y j t being the position of the ith and the jth asv respectively r 0 and r 0 with r r are the radii of the detection region and the avoidance region respectively this function is zero outside the detection area and is infinite at the edge of the avoidance area if the distance between two asvs satisfies r p i j r v i j c p i j in 1 will be larger than 0 and the potential function will be valid in the additional control input upon taking the partial derivative of 1 with respect to p i one can obtain 2 v i j c p i 4 r 2 r 2 p i j 2 r 2 p i j 2 r 2 3 p i j r p i j r 0 2 p i j r where p i x i y i t 2 2 potential function for obstacle avoidance static obstacle avoidance problem can be addressed using the following potential function 3 v i k o p i j min 0 p i k 2 r o 2 p i k 2 r o 2 2 where i 1 m k 1 m 0 with m 0 being the number of static obstacles p i k x i x k 2 y i y k 2 with x i y i t and x k y k t being the position of the ith asv and the kth obstacle respectively r o 0 and r o 0 with r o r o are the radii of the detection area and the avoidance area respectively similar to 1 the function 3 is also infinite at the boundary of the avoidance region and is 0 outside the detection region if the distance between the asv and the static obstacle satisfies r o p i k r o v i k o p i k in 3 will be larger than 0 and the potential function will be valid in the additional control input upon taking the partial derivative of 3 with respect to p i one has 4 v i k o p i 4 r o 2 r o 2 p i k 2 r o 2 p i k 2 r o 2 3 p i k r o p i k r o 0 2 p i k r o 2 3 potential function for connectivity preservation the following potential function is used to keep network connectivity between vehicle pairs 5 v i j m p i j 1 2 r m 2 p i j 2 r m p i j r m 0 p i j r m and its partial derivative with respect to p i j is given by 6 v i j m p i 1 r m 2 p i j 2 2 p i j r m p i j r m 0 2 p i j r m or p i j r m where r m 0 is the maximal communication range and r m 0 is the minimal range when the connectivity maintenance function is active and they satisfy r m r m 3 problem formulation consider a swarm system consisting of m under actuated asvs with the kinematics described as 7 x i u i cos ψ i b v i sin ψ i b y i u i sin ψ i b v i cos ψ i b ψ i b r i where x i y i is the position of the center of mass expressed in body fixed frame ψ i b is the heading angle u i v i and r i denote the surge speed sway speed and angular rate respectively the kinetics is given by 8 m i u u i f i u u i v i r i τ i u τ i u w m i v v i f i v u i v i r i τ i v w m i r r i f i r u i v i r i τ i r τ i r w where m i u m i x u m i v m i y v m i r i z n r with m i being the mass of asv i z being the moment of inertia about z axis and x u y v n r being the hydrodynamic derivatives f i u f i v and f i r are nonlinear functions including coriolis centripetal force and hydrodynamic damping effects τ i u and τ i r are the surge force and yaw moment τ i u w τ i v w and τ i r w are the time varying ocean disturbances caused by wind waves and ocean currents let ϑ i u i 2 v i 2 be the total speed of the ith vehicle with ϑ i 0 7 can be rewritten as follows 9 x i ϑ i cos ψ i b y i ϑ i sin ψ i b ψ i r i β i d where ψ i ψ i b β i be the course angle with β i atan 2 v i u i and β i d being the derivative of β i consider a virtual leader moving along a parameterized path 10 p 0 θ x 0 θ y 0 θ t r 2 with θ r being a path variable the partial derivative of p 0 θ is p 0 θ θ p 0 θ θ where p 0 θ θ is assumed to be bounded the topology among the m asvs and the virtual leader is described by a graph g v e consisting of a node set v n 0 n m and an edge set e i j v v the pair n i n j describes the communication from node j to node i define an adjacency matrix a a i j r m m if an edge n j n i e then a i j 1 otherwise a i j 0 in this paper the following assumption for the graph g is used assumption 1 the graph g contains a spanning tree with the root node being the node n 0 a geometrical illustration of the path guided time varying formation control of asvs is shown in fig 1 the control objective of the path guided time varying formation control of asvs include a geometric task a velocity task a collision and obstacle avoidance task and a connectivity maintenance task geometric task force each asv to follow a virtual leader moving along a parameterized path and form a desired formation 11 lim t p i t p i d t p 0 θ t ε 1 where p i d t r 2 represents a time varying deviation between the ith asv and the virtual leader and its time derivative is bounded ε 1 r is a positive constant velocity task force θ t to converge to an expected path update speed 12 lim t θ t v s t ε 2 where ε 2 r is a positive constant and v s t is a desired path update velocity collision and obstacle avoidance task collisions among vehicles and obstacles can be avoided such that 13 p i t p j t r p i t p k t r o connectivity maintenance task if the initial network is connected the network connectivity can be preserved such that 14 p i t p j t r m 4 design and analysis the controller design includes a distributed kinematic controller for achieving a time varying formation with the capability of collision avoidance and connectivity maintenance and an adaptive kinetic controller to compensate for model uncertainties external disturbances and unknown control inputs the stability will be analyzed in the next section 4 1 kinematic controller design as observed in nature the swarm group can be guided by an experimented individual animal which has the knowledge of the path information for migration this motivates us to study the path guided formation control problem first a local distributed time varying formation control error is defined as 15 z i r i t ψ i j n i a i j p i p j p i j d a i 0 p i p 0 θ p i 0 d where p i j d p i d p j d is a relative deviation which can be time varying for j 0 n a i j 1 if the ith node accesses the information of the jth node otherwise a i j 0 n i is the neighboring set excluding the node 0 r i ψ i is a rotation matrix given as r i ψ i cos ψ i sin ψ i sin ψ i cos ψ i defining θ v s ϖ and taking the time derivative of 4 1 it follows that 16 z i r i β i d s z i d i ϑ i 0 t j n i a i j r i t ψ i p j a i 0 r i t ψ i p 0 θ θ v s ϖ j n i a i j r i t ψ i p i j d where d i j 0 m a i j n i is the neighboring set of the ith asv ϖ is a variable to be designed subsequently s is defined as s 0 1 1 0 to facilitate the controller design for under actuated asvs an auxiliary variable δ 0 is introduced such that 17 z i r i β i d s z i d i ϑ i 0 t r i β i d s δ j n i a i j r i t ψ i p j a i 0 r i t ψ i p 0 θ θ v s ϖ j n i a i j r i t ψ i p i j d where z i z i δ 0 and δ 0 δ 0 0 t r 2 with δ 0 r being a positive constant transforming 17 into a compact form we obtain 18 z i r i β i d s z i b i ϑ i r i β i d t j n i a i j r i t ψ i p j a i 0 r i t ψ i p 0 θ θ v s ϖ j n i a i j r i t ψ i p i j d where b i diag d i δ 0 remark 1 in the error dynamics 16 there is no control input to stabilize the second entry of z i due to the underactuation of the asv to overcome it a constant δ 0 is introduced and a new error dynamics z i is obtained in 18 as a result the control input r i will appear in the new error dynamics and it can be utilized to stabilize the second entry of z i define q i q i x q i y t z i r i t ψ i z i f with 19 z i f j 1 m v i j c p i k 1 m o v i k o p i j 1 m v i j m p i where v i k c v i j o and v i j m are potential functions defined in section 2 to achieve the path guided time varying formation control with the capability of collision avoidance and connectivity preservation a distributed kinematic guidance law is designed as follows 20 ϑ i c r i c b i 1 k i q i π i j n i a i j r i t ψ i p j a i 0 v s r i t ψ i p 0 θ θ j n i a i j r i t ψ i p i j d where k i diag k i 1 k i 2 r 2 2 with k i 1 r and k i 2 r being positive constants π i q i 2 ε i 2 and ε i r is a positive constant ϖ is updated as follows 21 ϖ λ ϖ μ i n 0 a i 0 p 0 θ θ t r i ψ i q i where λ r and μ r are positive constants remark 2 the signals β i d p j and p i j d are assumed to be known herein in order to relax the assumption an extended state observer can be used to estimate the unknown part as follows z ˆ i k o b 1 z ˆ i z i b i ϑ i r i t a i 0 r i t ψ i p 0 θ θ v s ϖ σ ˆ i σ ˆ i k o b 2 z ˆ i z i where k o b 1 and k o b 2 are observer gains z ˆ i and σ ˆ i are the estimates of z i and σ i with σ i r i β i d s z i 0 δ 0 β i d t j n i a i j r i t ψ i p j j n i a i j r i t ψ i p i j d by using the extended state observer the same stability result can be obtained see reference liu et al 2019b 4 2 kinetic controller design in the previous section a distributed kinematic controller is presented this section gives the adaptive kinetic controller design noting that u i ϑ i cos β i and v i ϑ i sin β i it follows that 22 m i u ϑ i cos β i f i u u i v i r i τ i u w sin β i f i v u i v i r i τ i v w m i u m i v 2 sin 2 β i 2 τ i u τ i u recalling 8 it follows that 23 ϑ i b i ϑ cos β i f i u u i v i r i τ i u w b i v sin β i b i ϑ τ i v w f i v u i v i r i 2 sin 2 β i 2 τ i u b i ϑ τ i u r i b i r f i r u i v i r i τ i r w b i r τ i r where b i ϑ 1 m i u b i r 1 m i r and b i v 1 m i v in what follows two reference models are used to characterize the desired surge speed and yaw rate tracking performance 24 ϑ i r a i ϑ ϑ i r a i ϑ ϑ i c r i r a i r r i r a i r r i c where a i ϑ and a i r are design parameters based on the reference models equation 23 can be put into 25 ϑ i a i ϑ ϑ i a i ϑ ω i ϑ τ i u f i ϑ r i a i r r i a i r ω i r τ i r f i r where f i r b i r f i r u i v i r i τ i r w a i r r i f i ϑ b i ϑ cos β i f i u u i v i r i τ i u w a i ϑ 2 sin 2 β i 2 τ i u a i ϑ b i v sin β i b i ϑ τ i v w f i v u i v i r i a i ϑ ϑ ω i ϑ b i ϑ a i ϑ and ω i r b i r a i r let f i ϑ and f i r be represented by neural networks as follows 26 f i ϑ w i ϑ t x i ϑ ξ i ϑ ε i ϑ f i r w i r t x i r ξ i r ε i r where w i ϑ r n and w i r r n are the output weight matrices satisfying w i ϑ w i ϑ and w i r w i r with w i ϑ and w i r being positive constants x i ϑ and x i r are known activation functions ε i ϑ and ε i r are the approximation errors meeting the conditions ε i ϑ ε i ϑ and ε i r ε i r with ε i ϑ and ε i r being positive constants ξ i ϑ and ξ i r are inputs of neural networks expressed as ξ i ϑ ϑ i t ϑ i t t d τ i u t and ξ i r r i t r i t t d τ i r t where t d is the sample time in the most existing method that use to address system uncertainties they assume that the control gains are known in advance however the control gains are related to the system inertial parameters which are difficult to obtain in practical applications it is desirable to develop an adaptive estimation method to adapt the unknown control gains online let ϑ ˆ i and r ˆ i be the estimates of ϑ i and r i w ˆ i ϑ and w ˆ i r be the estimates of w i ϑ and w i r and ω ˆ i ϑ and ω ˆ i r be the estimates of ω i ϑ and ω i r then two state estimators are designed to facilitate identifying the unknown dynamics and input gains as follows 27 ϑ ˆ i a i ϑ ϑ ˆ i a i ϑ ω ˆ i ϑ τ i ϑ τ i ϑ a d κ i ϑ ϑ i r ˆ i a i r r ˆ i a i r ω ˆ i r τ i r τ i r a d κ i r r i where 28 τ i ϑ a d w ˆ i ϑ t x i ϑ ξ i ϑ τ i r a d w ˆ i r t x i r ξ i r and 29 w ˆ i ϑ γ i ϑ p r o j w ˆ i ϑ x i ϑ ξ i ϑ ϑ i a i ϑ w ˆ i r γ i r p r o j w ˆ i r x i r ξ i r r i a i r ω ˆ i ϑ γ i ω ϑ p r o j ω ˆ i ϑ τ i ϑ a i ϑ ϑ i ω ˆ i r γ i ω r p r o j ω ˆ i r τ i r a i r r i where p r o j denotes the projection operator pomet and praly 1992 γ i ϑ γ i r γ i ω ϑ and γ i ω r are positive constants remark 3 an indirect model reference adaptive method is used to estimate the unknown control input gains herein the unknown input gains can be estimated accurately if the input signals satisfy the condition of persistence of excitation the adaptive control method assures that the output tracking performance can be satisfied even though the parameter estimation is not convergent letting ϑ i ϑ ˆ i ϑ i r i r ˆ i r i w i ϑ w ˆ i ϑ w i ϑ w i r w ˆ i r w i r ω i ϑ ω ˆ i ϑ ω i ϑ and ω i r ω ˆ i r ω i r the dynamics of ϑ i r i w i ϑ w i r ω i ϑ and ω i r can be expressed as 30 ϑ i a i ϑ ω i ϑ τ i u w i ϑ t x i ϑ ξ i ϑ κ i ϑ a i ϑ ϑ i ε i ϑ r i a i r ω i r τ i r w i r t x i r ξ i r κ i r a i r r i ε i r w i ϑ γ i ϑ p r o j w ˆ i ϑ a i ϑ x i ϑ ξ i ϑ ϑ i w i r γ i r p r o j w ˆ i r a i r x i r ξ i r r i ω i ϑ γ i ω ϑ p r o j ω ˆ i ϑ τ i ϑ a i ϑ ϑ i ω i r γ i ω r p r o j ω ˆ i r τ i r a i r r i define z i ϑ ϑ ˆ i ϑ i r and z i r r ˆ i r i r whose time derivatives with 27 are given by 31 z i ϑ a i ϑ z i ϑ a i ϑ ω ˆ i ϑ τ i ϑ ϑ i c τ i ϑ a d κ i ϑ ϑ i z i r a i r z i r a i r ω ˆ i r τ i r r i c τ i r a d κ i r r i two kinetic control laws are proposed on the basis of the neural estimation models 32 τ i ϑ ϑ i c τ i ϑ a d d i q i x a i ϑ ω ˆ i ϑ τ i r r i c τ i r a d δ 0 q i y a i r ω ˆ i r substituting 32 into 31 one has 33 z i ϑ a i ϑ z i ϑ κ i ϑ ϑ i d i q i x z i r a i r z i r κ i r r i δ 0 q i y as a consequence the resulting error subsystem in terms of z i ϖ z i u and z i r can be expressed by 34 z i r i β i d s z i k i q i π i a i 0 r i t ψ i p 0 θ ϖ l i ϖ λ ϖ μ i 1 m a i 0 p 0 θ t r i ψ i q i z i ϑ a i ϑ z i ϑ κ i ϑ ϑ i d i q i x z i r a i r z i r κ i r r i δ 0 q i y where l i l i ϑ l i r t with l i ϑ ϑ i r ϑ i c and l i r r i r r i c 4 3 stability analysis the closed loop system can be regarded as a cascade system formed by the subsystem 30 and the subsystem 34 the following lemmas state the input to state stability of the subsystems 30 and 34 lemma 1 the subsystem 30 viewed as a system with the states being ϑ i r i w i ϑ w i r ω i ϑ and ω i r the inputs being ε i ϑ ε i r w i ϑ w i r ω i ϑ and ω i r is input to state stable iss proof consider the following lyapunov function 35 v 1 1 2 i 1 m ϑ i 2 r i 2 w i ϑ t γ i ϑ 1 w i ϑ w i r t γ i r 1 w i r ω i ϑ t γ i ω ϑ 1 ω i ϑ ω i r t γ i ω r 1 ω i r whose time derivative along 30 satisfies 36 v 1 i 1 m e i 1 t k i 1 e i 1 h i 1 t e i 1 i 1 m λ min k i 1 e i 1 2 λ min k i 1 w i ϑ 2 λ min k i 1 w i r 2 λ min k i 1 ω i ϑ 2 λ min k i 1 ω i r 2 h i 1 t e i 1 λ min k i 1 w i ϑ 2 λ min k i 1 w i r 2 λ min k i 1 ω i ϑ 2 λ min k i 1 ω i r 2 i 1 m λ min k i 1 e i 2 2 h i 2 e i 2 where k i 1 diag κ i ϑ a i ϑ κ i r a i r e i 1 ϑ i r i t h i 1 ε i ϑ ε i r t e i 2 ϑ i r i w i ϑ w i r ω i ϑ ω i r t h i 2 ε i ϑ ε i r λ min k i 1 w i ϑ λ min k i 1 w i r λ min k i 1 ω i ϑ λ min k i 1 ω i r t since 37 e i 2 h i 2 θ i 1 λ min k i 1 renders 38 v 1 i 1 m 1 θ i 1 λ min k i 1 e i 1 2 where 0 θ i 1 1 it follows that the subsystem 30 is iss choosing 39 κ i p 1 s λ min p i o 2 s 2 κ i p 2 s λ max p i o 2 s 2 with p i o diag 1 γ i ϑ 1 γ i r 1 γ i ω ϑ 1 γ i ω r 1 1 λ μ it follows that 40 e i 2 t λ max p i o λ min p i o max e i 2 t 0 e γ 1 i t t 0 h i 2 θ i 1 λ min k i 1 t t 0 where γ 1 i 2 1 θ i 1 λ min k i 1 λ max p i o lemma 2 the error subsystem 34 viewed as a system with the states being z i ϖ z i ϑ and z i r the inputs being ϑ i r i and l i is iss outside the collision and obstacle avoidance region and connectivity maintenance region proof consider the following lyapunov function 41 v 1 1 2 i 1 m z i t z i d i j n i c v i j c d i k n i o v i k o d i j n i m v i j m z i ϑ 2 z i r 2 ϖ 2 2 λ μ taking the time derivative of 41 and using the error dynamics 34 it follows that 42 v 2 i 1 m q i t k i q i a i ϑ z i ϑ 2 a i r z i r 2 κ i ϑ z i ϑ ϑ i κ i r z i r r i q i t b i l i e i 1 z i f t ν i ϖ 2 μ where k i k i π i and ν i j n i a i j p j p i j d r i ψ i 0 δ 0 r i β i d t it follows that 43 v 2 i 1 m λ min k i q i 2 a i ϑ a i r z i ϑ r 2 z i f ν i κ i ϑ κ i r e i 2 z i ϑ r l i e i 2 b i q i ϖ 2 μ where z i ϑ r z i ϑ z i r t define q q 1 t q m t t z z 1 t z m t t z ϑ r z 1 ϑ r t z m ϑ r t t e 3 z t z ϑ r t ϖ t and c min i 1 m λ min k i a i ϑ a i r 1 μ outside the collision avoidance and connectivity preservation region r p i j r m v i j c p i v i j o p i v i j m p i 0 hence q i z i and 43 can be rewritten as follows 44 v 2 c 1 θ 2 e 3 2 c θ 2 e 3 2 e 3 i 1 m 2 ℏ i e i 2 l i where ℏ i max i 1 m κ i ϑ κ i r b i noting that 45 e 3 i 1 m 2 ℏ i e i 2 l i c θ 2 renders 46 v 2 c 1 θ 2 e 3 2 it can be concluded that subsystem 34 is iss choosing 47 κ p 3 s λ min p c 2 s 2 κ p 4 s λ max p c 2 s 2 with p c diag 1 d i 1 λ μ it follows that 48 e 3 t λ max p c λ min p c max e 3 t 0 e γ 2 i t t 0 i 1 m 2 ℏ i e i 2 l i c θ 2 t t 0 where γ 2 i 2 c 1 θ 2 λ max p c the stability of the closed loop distributed time varying formation control system is stated as below theorem 1 consider the asv kinematics 9 and kinetics 8 with kinematic guidance law 4 1 the path update law 21 the reference model 24 the neural estimator 27 the adaptation law 29 and the kinetic control law 32 if assumption 1 is satisfied the path guided time varying formation maneuvering control with collision avoidance and connectivity preservation can be achieved and all signals in the closed loop path guided time varying formation maneuvering system are uniformly ultimately bounded proof at first we prove the stability of the closed loop system outside the collision abstable avoidance and connectivity reservation range by applying cascade system stability and using lemmas 1 and 2 the closed loop system cascaded by subsystem 30 and subsystem 34 is iss according to 24 there exists a positive constant l i such that l i l i it follows from 40 and 48 that e 3 is ultimately bounded by 49 e 3 t λ max p c λ min p c i 1 m λ max p i o λ min p i o 2 ℏ i h i 2 c θ i 1 θ 2 λ min k i 1 2 l i c θ 2 let e e 1 t e m t t r diag r 1 t ψ 1 r m t ψ m and δ δ 0 δ 0 t where e i p i p i d p 0 and then z z δ r h i 2 e δ where h d a with d diag d i r m m under assumption 1 h is nonsingular and we obtain e z δ o h e 3 δ o h where o h is the smallest singular value of h hence 50 e t 1 o h λ max p c λ min p c i 1 m λ max p i o λ min p i o 2 ℏ i h i 2 c θ i 1 θ 2 λ min k i 1 2 l i c θ 2 δ implying 11 since ϖ is bounded there exists ε 2 such that 12 is satisfied this means that control objective 11 and 12 are achieved next we analyze the stability of the formation control system where the asvs are inside the collision avoidance or connectivity preservation range i e r p i j r or r m p i j r m recalling 43 and letting e 4 q t z 2 t ϖ t it follows that 51 v 2 c 1 θ 3 e 4 2 c θ 3 e 4 2 e 4 i 1 m 2 ℏ i e i 2 l i ν i since 52 e 4 i 1 m 2 ℏ i e i 2 l i ν i c θ 3 renders 53 v 2 c 1 θ 3 e 4 2 as e i 2 l i and ν i are bounded the signals in e 4 are bounded because v 2 is non increasing when the asvs are inside the collision obstable avoidance and connectivity preservation range and v i j c as p i j r v i j o as p i j r o and v i j m as p i j r m there is no collision among asvs static obstacles can be avoided and connectivity is maintained if the vehicle network are initially connected the control objectives 13 and 14 are achieved this proof completes in summary the proposed path guided distributed time varying formation control algorithm is given in table 1 5 simulation result in this section simulation results are provided to illustrate the efficacy of the proposed path guided distributed time varying formation controllers for under actuated asvs consider a swarm system consisting of five asvs and one leader the virtual leader is set to move along a parameterized path p 0 θ 0 06 θ 2 0 06 θ 2 t the parameters for the five vehicles are selected as m i u 25 8 k g m i v 33 8 k g m i r 2 76 k g m 2 f i u 5 87 u 3 1 33 u u 0 72 u m i v v r 1 0948 r 2 f i v 36 5 v v 0 8896 v 0 805 v r m i u u r and f i r 0 75 r r 1 90 r 0 08 v r m i u m i v u v 1 0948 u r the initial states of five asvs are given as p 1 1 8 1 8 t p 2 t 2 6 p 3 2 2 t p 4 2 9 t p 5 2 5 t the desired formation pattern are set as p 1 d 0 0 t p 2 d 5 sin t 16 5 cos t 16 t p 3 d 5 sin t 16 5 cos t 16 t p 4 d 10 sin t 16 10 cos t 16 t and p 5 d 10 sin t 16 10 cos t 16 t the parameters for the proposed controllers are set to k i diag 0 1 0 1 δ 0 0 1 λ 10 ε i 0 01 μ 10 γ i ϑ 50 γ i r 50 γ i ω ϑ 20 γ i ω r 20 a i ϑ 5 and a i r 5 the parameters for the potential functions are selected as r o 13 r o 10 r m 10 r m 7 5 r 4 5 r 2 in order to test the control performance of the proposed adaptive kinetic controller in the presence of unknown control gains some variations on the inertial parameters are added and the inertial parameters change according to the sets m i u 12 9 k g 25 8 k g 38 7 k g 51 6 k g 64 5 k g and m i r 1 38 k g m 2 2 76 k g m 2 4 14 k g m 2 5 52 k g m 2 6 90 k g m 2 the control performance under different control input gains is verified under the same control parameters the simulation results by using the proposed path guided distributed time varying formation control algorithm in table 1 are illustrated in figs 2 10 fig 2 shows the path guided distributed time varying formation control trajectories of the five asvs it can be observed that a circular formation shaped by the five asvs is achieved in addition static obstacles are avoided and there are no collisions between asvs fig 3 plots the distances of connected asvs through an underlying network during 300s 600s the relative distances are smaller than the prescribed relative distance because obstacle avoidance capability is activated due to the static obstables fig 4 depicts the time varying formation tracking control errors of the five asvs the obstacle avoidance function is active when obstacles are encountered leading to non zero formation tracking errors fig 5 shows the surge speed and the yaw speed of five asvs fig 6 depicts the profiles of the surge force and the yaw torque of five asvs fig 7 and fig 8 show the tracking performances of the total speed and yaw velocity in the presence of different ω i u and ω i r respectively it can be observed that the tracking errors can converge to a small neighborhood of zero regardless of the variation of ω i u or ω i r finally the estimation performances of ω ˆ i u and ω ˆ i r corresponding to the first asv are given in fig 9 and fig 10 respectively it can be observed they arrive constant values after a short transient learning process 6 conclusion this paper has investigated the path guided time varying formation control problem for a swarm of under actuated asvs subject to model uncertainties and unknown input gains a design method is presented to achieve a time varying formation control with capability of collision avoidance and connectivity preservation specifically a distributed guidance control law is proposed based on a consensus approach a path following design artificial potential functions and an auxiliary variable approach at the kinematic level at the kinetic level an adaptive kinetic control law is designed on the basis of indirect model reference adaptive control where a neural estimator is used to identify the unknown uncertainties ocean disturbances and unknown input gains the stability is established based on cascade stability analysis simulation results showed the efficiency of the proposed path guided time varying formation controller for under actuated asvs subject to unknown input gains in future it is of interest to investigate the time varying formation control of asvs guided by multiple leaders acknowledgement this work was supported in part by the national natural science foundation of china under grants 61673081 51979020 51909021 51579023 and in part by science and technology fund for distinguished young scholars of dalian under grant 2018rj08 and in part by the stable supporting fund of science and technology on underwater vehicle technology jckys2019604sxjqr 01 and in part by the innovative talents in universities of liaoning province under grant lr2017014 and in part by the training program for high level technical talent in transportation industry under grant 2018 030 and in part by the national key research and development program of china under grant 2016yfc0301500 and in part by the fundamental research funds for the central universities under grant 3132019319 and in part by china postdoctoral science foundation 2019m650086 
22414,this paper investigates the distributed time varying formation control for a swarm of under actuated autonomous surface vehicles subject to unknown input gains in addition to model uncertainties and ocean disturbances the fleet is required to follow a parameterized path with a time varying formation while avoiding collisions and maintaining connectivity at a complex sea environment at the kinematic level a distributed guidance control law is proposed based on a consensus approach a path following design artificial potential functions and an auxiliary variable approach at the kinetic level an adaptive kinetic control law is designed based on an indirect model reference adaptive control approach where a neural estimator is developed for identifying unknown input gains model uncertainties and ocean disturbances the stability of the closed loop system is proven via cascade stability analysis the advantage of the proposed method is three folds first the developed time varying formation controller is able to achieve various coordinated behaviors such as cooperative target tracking and target enclosing second the proposed time varying formation controller is robust against model uncertainties ocean disturbances and unknown input gains third the proposed distributed controller holds the capability of collision avoidance and connectivity preservation simulation results substantiate the effectiveness of the proposed path guided time varying formation controllers keywords parameterized path time varying formation control autonomous surface vehicles collision avoidance connectivity preservation indirect model reference adaptive control 1 introduction during the past few years formation control of autonomous surface vehicles has aroused compelling research interest peng et al 2018 2019a 2019b liu et al in press 2019 2019a 2019b 2018a 2017a 2017b dai et al 2016 2018 li et al 2018b park and yoo 2019 zhang et al 2019 xiang et al 2017a b shi et al 2017 qin et al 2018 in press 2019a in press 2019b due to its broad applications in offshore marine industry many missions that are difficult to finish by single surface vehicle could be accomplished by multiple surface vehicles in a cooperative fashion aimed at achieving expected formation behaviors various approaches have been proposed including graph based method li et al 2018a 2017 peng et al 2018 yuan et al 2018 virtual structure method beard et al 2001 leader follower method jin 2016 sun et al 2018 shojaei 2016 peng et al 2013 cui et al 2010 behavioral method balch and arkin 1998 and artificial potential field method liu et al 2018b ge et al 2016 in particular the graph based method has been intensively studied in the literature liu et al in press 2019 ihle et al 2007 almeida et al 2010 2011 chen and wei 2014 skjetne et al 2004 liu et al 2017d c peng et al 2018 2019a 2017a 2017b gu et al 2019 yuan et al 2018 qin et al 2018 in press 2019a in light of types of leaders they can be generally categorized into trajectory guided coordinated control qin et al 2018 in press 2019a fu and yu 2018 park and yoo 2019 ma and zeng 2015 li and wang 2013 liu et al 2015 peng et al 2016 2018 and path guided coordinated control liu et al in press 2019 ihle et al 2007 almeida et al 2010 chen and wei 2014 skjetne et al 2004 liu et al 2017d c almeida et al 2011 gu et al in press 2019b peng et al in press 2019 a salient feature of path guided coordinated control is that the spatial constraint and temporal constraint can be decoupled cooperative path following with the full knowledge of multiple parameterized paths has been studied in liu et al in press 2019 ihle et al 2007 almeida et al 2010 chen and wei 2014 skjetne et al 2004 liu et al 2017d c almeida et al 2011 gu et al in press 2019b where the formation pattern is achieved by coordinating the path variables in cooperative path following each vehicle should be assigned a parameterized path known as a priori in case that the numbers of paths are less than that of the follower vehicles distributed path maneuvering with the partial knowledge of multiple parameterized paths are addressed in peng et al 2017a b gu et al 2019 zhang et al 2019 such that a containment formation is reached without assigning a path to each vehicle in light of one parameterized path distributed path maneuvering of asvs is considered in peng et al 2018 2019a however the restrictions are two folds first the collisions among asvs are not considered in peng et al 2017a b gu et al 2019 peng et al 2018 besides the network connectivity may not be preserved at a complex sea environment second the results in peng et al 2017a b gu et al 2019 peng et al 2018 2019a are confined to fully actuated asvs which means that they are not applicable to under actuated asvs this will limit their applications in marine practice as most marine vehicles are configured or moving in an under actuated fashion the kinetics of asvs suffer from model uncertainties unmodelled hydrodynamics and unknown environmental forces caused by wind waves and ocean currents motion control of marine vehicles subject to model uncertainties unmodelled dynamics and external disturbances is a long lasting research topic which has been extensively studied and the existing literature is rich in order to address system uncertainties many efficient methods have been proposed including parametric adaptive control skjetne et al 2005 do et al 2004 do and pan 2006 almeida et al 2010 sliding model control zhang et al 2000 fahimi 2007 ashrafiuon et al 2008 cui et al 2016 yu et al 2012 liu et al 2014 robust control do et al 2004 do and pan 2006 annamalai et al 2014 do and jiang 2004 do 2016 neural network control tee and ge 2006 cui et al 2010 peng et al 2013 chen et al 2016 2013 dai et al 2012 cui et al 2016 yin and xiao 2017 peng et al 2015 2017a 2017b fuzzy control yang et al 2003 chen and tan 2013 peng et al 2018 disturbance observer based control do 2012 zheng et al 2018 zheng and feroskhan 2017a and extended state observer based control liu et al 2017b cui et al 2017 lei and guo 2015 fu and yu 2018 it should be pointed out that most works assume that the input gains relevant to system inertial parameters are assumed to be known in advance however the identification of the input gains needs time consuming experiments although nominal input gains could be obtained by experiments they may suffer from perturbations due to load variations or actuator faults from a practical perspective it is highly desirable to develop an adaptive controller adapting to unknown input gains in addition to model uncertainties and ocean disturbances motivated by the above observations this paper considers the distributed time varying formation control problem of under actuated asvs subject to unknown input gains in addition to system uncertainties the vehicle group is guided by a parameterized path where collisions and obstacles should be avoided due to the limited communication ranges at a complex sea environment the connectivity is requited to be connected to address the above problem a distributed guidance law is proposed at the kinematic loop based on a consensus approach a path following design artificial potential functions and an axillary variable approach to deal with the under actuation in the kinetic control loop a neural estimator is developed for estimating the unknown uncertainties environmental disturbances and unknown control gains then an adaptive kinetic control law is designed on the basis of indirect model reference adaptive control approach the stability of the closed loop system is proven via cascade stability analysis finally simulation results substantiate the efficacy of the proposed method for time varying formation control of under actuated asvs compared with existing results on formation control of marine vehicles the salient features of the proposed method are as follows distributed formation control of asvs are addressed in peng et al 2017a b 2018 2019a qin et al 2018 in press 2019a dai et al 2018 fu and yu 2018 while these results are confined to fully actuated asvs this paper aims to address the distributed formation maneuvering of under actuated asvs guided by one parameterized path different from peng et al 2017a b 2018 2019a qin et al 2018 in press 2019a dai et al 2018 fu and yu 2018 li et al 2018a the proposed formation control method is able to achieve a time varying formation pattern in contrast to the distributed formation control methods in qin et al 2018 in press 2019a peng et al 2017a b 2018 gu et al 2019 li et al 2018a fu and yu 2018 the proposed formation controllers are capable of avoiding collisions and obstacles and preserving network connectivity in a complex maritime environment compared with the previous results in tee and ge 2006 cui et al 2010 peng et al 2013 chen et al 2016 2013 dai et al 2012 cui et al 2016 yin and xiao 2017 peng et al 2015 2017a 2017b zheng and feroskhan 2017b zheng et al 2018 zheng and feroskhan 2017a gu et al in press 2019a where the unknown input gains are not addressed or inertial matrix is assumed to be known an indirect model reference adaptive control is developed herein such that the input gains or inertial matrix are not required to be known 2 preliminaries in the paper the following notations are used denotes the absolute value of a real number denotes the euclidean norm of a vector λ min denotes the minimum eigenvalue of a matrix 2 1 potential function for collision avoidance the potential function for collision avoidance between asvs is defined as 1 v i j c p i j min 0 p i j 2 r 2 p i j 2 r 2 2 where i j 1 m i j p i j x i x j 2 y i y j 2 with x i y i t and x j y j t being the position of the ith and the jth asv respectively r 0 and r 0 with r r are the radii of the detection region and the avoidance region respectively this function is zero outside the detection area and is infinite at the edge of the avoidance area if the distance between two asvs satisfies r p i j r v i j c p i j in 1 will be larger than 0 and the potential function will be valid in the additional control input upon taking the partial derivative of 1 with respect to p i one can obtain 2 v i j c p i 4 r 2 r 2 p i j 2 r 2 p i j 2 r 2 3 p i j r p i j r 0 2 p i j r where p i x i y i t 2 2 potential function for obstacle avoidance static obstacle avoidance problem can be addressed using the following potential function 3 v i k o p i j min 0 p i k 2 r o 2 p i k 2 r o 2 2 where i 1 m k 1 m 0 with m 0 being the number of static obstacles p i k x i x k 2 y i y k 2 with x i y i t and x k y k t being the position of the ith asv and the kth obstacle respectively r o 0 and r o 0 with r o r o are the radii of the detection area and the avoidance area respectively similar to 1 the function 3 is also infinite at the boundary of the avoidance region and is 0 outside the detection region if the distance between the asv and the static obstacle satisfies r o p i k r o v i k o p i k in 3 will be larger than 0 and the potential function will be valid in the additional control input upon taking the partial derivative of 3 with respect to p i one has 4 v i k o p i 4 r o 2 r o 2 p i k 2 r o 2 p i k 2 r o 2 3 p i k r o p i k r o 0 2 p i k r o 2 3 potential function for connectivity preservation the following potential function is used to keep network connectivity between vehicle pairs 5 v i j m p i j 1 2 r m 2 p i j 2 r m p i j r m 0 p i j r m and its partial derivative with respect to p i j is given by 6 v i j m p i 1 r m 2 p i j 2 2 p i j r m p i j r m 0 2 p i j r m or p i j r m where r m 0 is the maximal communication range and r m 0 is the minimal range when the connectivity maintenance function is active and they satisfy r m r m 3 problem formulation consider a swarm system consisting of m under actuated asvs with the kinematics described as 7 x i u i cos ψ i b v i sin ψ i b y i u i sin ψ i b v i cos ψ i b ψ i b r i where x i y i is the position of the center of mass expressed in body fixed frame ψ i b is the heading angle u i v i and r i denote the surge speed sway speed and angular rate respectively the kinetics is given by 8 m i u u i f i u u i v i r i τ i u τ i u w m i v v i f i v u i v i r i τ i v w m i r r i f i r u i v i r i τ i r τ i r w where m i u m i x u m i v m i y v m i r i z n r with m i being the mass of asv i z being the moment of inertia about z axis and x u y v n r being the hydrodynamic derivatives f i u f i v and f i r are nonlinear functions including coriolis centripetal force and hydrodynamic damping effects τ i u and τ i r are the surge force and yaw moment τ i u w τ i v w and τ i r w are the time varying ocean disturbances caused by wind waves and ocean currents let ϑ i u i 2 v i 2 be the total speed of the ith vehicle with ϑ i 0 7 can be rewritten as follows 9 x i ϑ i cos ψ i b y i ϑ i sin ψ i b ψ i r i β i d where ψ i ψ i b β i be the course angle with β i atan 2 v i u i and β i d being the derivative of β i consider a virtual leader moving along a parameterized path 10 p 0 θ x 0 θ y 0 θ t r 2 with θ r being a path variable the partial derivative of p 0 θ is p 0 θ θ p 0 θ θ where p 0 θ θ is assumed to be bounded the topology among the m asvs and the virtual leader is described by a graph g v e consisting of a node set v n 0 n m and an edge set e i j v v the pair n i n j describes the communication from node j to node i define an adjacency matrix a a i j r m m if an edge n j n i e then a i j 1 otherwise a i j 0 in this paper the following assumption for the graph g is used assumption 1 the graph g contains a spanning tree with the root node being the node n 0 a geometrical illustration of the path guided time varying formation control of asvs is shown in fig 1 the control objective of the path guided time varying formation control of asvs include a geometric task a velocity task a collision and obstacle avoidance task and a connectivity maintenance task geometric task force each asv to follow a virtual leader moving along a parameterized path and form a desired formation 11 lim t p i t p i d t p 0 θ t ε 1 where p i d t r 2 represents a time varying deviation between the ith asv and the virtual leader and its time derivative is bounded ε 1 r is a positive constant velocity task force θ t to converge to an expected path update speed 12 lim t θ t v s t ε 2 where ε 2 r is a positive constant and v s t is a desired path update velocity collision and obstacle avoidance task collisions among vehicles and obstacles can be avoided such that 13 p i t p j t r p i t p k t r o connectivity maintenance task if the initial network is connected the network connectivity can be preserved such that 14 p i t p j t r m 4 design and analysis the controller design includes a distributed kinematic controller for achieving a time varying formation with the capability of collision avoidance and connectivity maintenance and an adaptive kinetic controller to compensate for model uncertainties external disturbances and unknown control inputs the stability will be analyzed in the next section 4 1 kinematic controller design as observed in nature the swarm group can be guided by an experimented individual animal which has the knowledge of the path information for migration this motivates us to study the path guided formation control problem first a local distributed time varying formation control error is defined as 15 z i r i t ψ i j n i a i j p i p j p i j d a i 0 p i p 0 θ p i 0 d where p i j d p i d p j d is a relative deviation which can be time varying for j 0 n a i j 1 if the ith node accesses the information of the jth node otherwise a i j 0 n i is the neighboring set excluding the node 0 r i ψ i is a rotation matrix given as r i ψ i cos ψ i sin ψ i sin ψ i cos ψ i defining θ v s ϖ and taking the time derivative of 4 1 it follows that 16 z i r i β i d s z i d i ϑ i 0 t j n i a i j r i t ψ i p j a i 0 r i t ψ i p 0 θ θ v s ϖ j n i a i j r i t ψ i p i j d where d i j 0 m a i j n i is the neighboring set of the ith asv ϖ is a variable to be designed subsequently s is defined as s 0 1 1 0 to facilitate the controller design for under actuated asvs an auxiliary variable δ 0 is introduced such that 17 z i r i β i d s z i d i ϑ i 0 t r i β i d s δ j n i a i j r i t ψ i p j a i 0 r i t ψ i p 0 θ θ v s ϖ j n i a i j r i t ψ i p i j d where z i z i δ 0 and δ 0 δ 0 0 t r 2 with δ 0 r being a positive constant transforming 17 into a compact form we obtain 18 z i r i β i d s z i b i ϑ i r i β i d t j n i a i j r i t ψ i p j a i 0 r i t ψ i p 0 θ θ v s ϖ j n i a i j r i t ψ i p i j d where b i diag d i δ 0 remark 1 in the error dynamics 16 there is no control input to stabilize the second entry of z i due to the underactuation of the asv to overcome it a constant δ 0 is introduced and a new error dynamics z i is obtained in 18 as a result the control input r i will appear in the new error dynamics and it can be utilized to stabilize the second entry of z i define q i q i x q i y t z i r i t ψ i z i f with 19 z i f j 1 m v i j c p i k 1 m o v i k o p i j 1 m v i j m p i where v i k c v i j o and v i j m are potential functions defined in section 2 to achieve the path guided time varying formation control with the capability of collision avoidance and connectivity preservation a distributed kinematic guidance law is designed as follows 20 ϑ i c r i c b i 1 k i q i π i j n i a i j r i t ψ i p j a i 0 v s r i t ψ i p 0 θ θ j n i a i j r i t ψ i p i j d where k i diag k i 1 k i 2 r 2 2 with k i 1 r and k i 2 r being positive constants π i q i 2 ε i 2 and ε i r is a positive constant ϖ is updated as follows 21 ϖ λ ϖ μ i n 0 a i 0 p 0 θ θ t r i ψ i q i where λ r and μ r are positive constants remark 2 the signals β i d p j and p i j d are assumed to be known herein in order to relax the assumption an extended state observer can be used to estimate the unknown part as follows z ˆ i k o b 1 z ˆ i z i b i ϑ i r i t a i 0 r i t ψ i p 0 θ θ v s ϖ σ ˆ i σ ˆ i k o b 2 z ˆ i z i where k o b 1 and k o b 2 are observer gains z ˆ i and σ ˆ i are the estimates of z i and σ i with σ i r i β i d s z i 0 δ 0 β i d t j n i a i j r i t ψ i p j j n i a i j r i t ψ i p i j d by using the extended state observer the same stability result can be obtained see reference liu et al 2019b 4 2 kinetic controller design in the previous section a distributed kinematic controller is presented this section gives the adaptive kinetic controller design noting that u i ϑ i cos β i and v i ϑ i sin β i it follows that 22 m i u ϑ i cos β i f i u u i v i r i τ i u w sin β i f i v u i v i r i τ i v w m i u m i v 2 sin 2 β i 2 τ i u τ i u recalling 8 it follows that 23 ϑ i b i ϑ cos β i f i u u i v i r i τ i u w b i v sin β i b i ϑ τ i v w f i v u i v i r i 2 sin 2 β i 2 τ i u b i ϑ τ i u r i b i r f i r u i v i r i τ i r w b i r τ i r where b i ϑ 1 m i u b i r 1 m i r and b i v 1 m i v in what follows two reference models are used to characterize the desired surge speed and yaw rate tracking performance 24 ϑ i r a i ϑ ϑ i r a i ϑ ϑ i c r i r a i r r i r a i r r i c where a i ϑ and a i r are design parameters based on the reference models equation 23 can be put into 25 ϑ i a i ϑ ϑ i a i ϑ ω i ϑ τ i u f i ϑ r i a i r r i a i r ω i r τ i r f i r where f i r b i r f i r u i v i r i τ i r w a i r r i f i ϑ b i ϑ cos β i f i u u i v i r i τ i u w a i ϑ 2 sin 2 β i 2 τ i u a i ϑ b i v sin β i b i ϑ τ i v w f i v u i v i r i a i ϑ ϑ ω i ϑ b i ϑ a i ϑ and ω i r b i r a i r let f i ϑ and f i r be represented by neural networks as follows 26 f i ϑ w i ϑ t x i ϑ ξ i ϑ ε i ϑ f i r w i r t x i r ξ i r ε i r where w i ϑ r n and w i r r n are the output weight matrices satisfying w i ϑ w i ϑ and w i r w i r with w i ϑ and w i r being positive constants x i ϑ and x i r are known activation functions ε i ϑ and ε i r are the approximation errors meeting the conditions ε i ϑ ε i ϑ and ε i r ε i r with ε i ϑ and ε i r being positive constants ξ i ϑ and ξ i r are inputs of neural networks expressed as ξ i ϑ ϑ i t ϑ i t t d τ i u t and ξ i r r i t r i t t d τ i r t where t d is the sample time in the most existing method that use to address system uncertainties they assume that the control gains are known in advance however the control gains are related to the system inertial parameters which are difficult to obtain in practical applications it is desirable to develop an adaptive estimation method to adapt the unknown control gains online let ϑ ˆ i and r ˆ i be the estimates of ϑ i and r i w ˆ i ϑ and w ˆ i r be the estimates of w i ϑ and w i r and ω ˆ i ϑ and ω ˆ i r be the estimates of ω i ϑ and ω i r then two state estimators are designed to facilitate identifying the unknown dynamics and input gains as follows 27 ϑ ˆ i a i ϑ ϑ ˆ i a i ϑ ω ˆ i ϑ τ i ϑ τ i ϑ a d κ i ϑ ϑ i r ˆ i a i r r ˆ i a i r ω ˆ i r τ i r τ i r a d κ i r r i where 28 τ i ϑ a d w ˆ i ϑ t x i ϑ ξ i ϑ τ i r a d w ˆ i r t x i r ξ i r and 29 w ˆ i ϑ γ i ϑ p r o j w ˆ i ϑ x i ϑ ξ i ϑ ϑ i a i ϑ w ˆ i r γ i r p r o j w ˆ i r x i r ξ i r r i a i r ω ˆ i ϑ γ i ω ϑ p r o j ω ˆ i ϑ τ i ϑ a i ϑ ϑ i ω ˆ i r γ i ω r p r o j ω ˆ i r τ i r a i r r i where p r o j denotes the projection operator pomet and praly 1992 γ i ϑ γ i r γ i ω ϑ and γ i ω r are positive constants remark 3 an indirect model reference adaptive method is used to estimate the unknown control input gains herein the unknown input gains can be estimated accurately if the input signals satisfy the condition of persistence of excitation the adaptive control method assures that the output tracking performance can be satisfied even though the parameter estimation is not convergent letting ϑ i ϑ ˆ i ϑ i r i r ˆ i r i w i ϑ w ˆ i ϑ w i ϑ w i r w ˆ i r w i r ω i ϑ ω ˆ i ϑ ω i ϑ and ω i r ω ˆ i r ω i r the dynamics of ϑ i r i w i ϑ w i r ω i ϑ and ω i r can be expressed as 30 ϑ i a i ϑ ω i ϑ τ i u w i ϑ t x i ϑ ξ i ϑ κ i ϑ a i ϑ ϑ i ε i ϑ r i a i r ω i r τ i r w i r t x i r ξ i r κ i r a i r r i ε i r w i ϑ γ i ϑ p r o j w ˆ i ϑ a i ϑ x i ϑ ξ i ϑ ϑ i w i r γ i r p r o j w ˆ i r a i r x i r ξ i r r i ω i ϑ γ i ω ϑ p r o j ω ˆ i ϑ τ i ϑ a i ϑ ϑ i ω i r γ i ω r p r o j ω ˆ i r τ i r a i r r i define z i ϑ ϑ ˆ i ϑ i r and z i r r ˆ i r i r whose time derivatives with 27 are given by 31 z i ϑ a i ϑ z i ϑ a i ϑ ω ˆ i ϑ τ i ϑ ϑ i c τ i ϑ a d κ i ϑ ϑ i z i r a i r z i r a i r ω ˆ i r τ i r r i c τ i r a d κ i r r i two kinetic control laws are proposed on the basis of the neural estimation models 32 τ i ϑ ϑ i c τ i ϑ a d d i q i x a i ϑ ω ˆ i ϑ τ i r r i c τ i r a d δ 0 q i y a i r ω ˆ i r substituting 32 into 31 one has 33 z i ϑ a i ϑ z i ϑ κ i ϑ ϑ i d i q i x z i r a i r z i r κ i r r i δ 0 q i y as a consequence the resulting error subsystem in terms of z i ϖ z i u and z i r can be expressed by 34 z i r i β i d s z i k i q i π i a i 0 r i t ψ i p 0 θ ϖ l i ϖ λ ϖ μ i 1 m a i 0 p 0 θ t r i ψ i q i z i ϑ a i ϑ z i ϑ κ i ϑ ϑ i d i q i x z i r a i r z i r κ i r r i δ 0 q i y where l i l i ϑ l i r t with l i ϑ ϑ i r ϑ i c and l i r r i r r i c 4 3 stability analysis the closed loop system can be regarded as a cascade system formed by the subsystem 30 and the subsystem 34 the following lemmas state the input to state stability of the subsystems 30 and 34 lemma 1 the subsystem 30 viewed as a system with the states being ϑ i r i w i ϑ w i r ω i ϑ and ω i r the inputs being ε i ϑ ε i r w i ϑ w i r ω i ϑ and ω i r is input to state stable iss proof consider the following lyapunov function 35 v 1 1 2 i 1 m ϑ i 2 r i 2 w i ϑ t γ i ϑ 1 w i ϑ w i r t γ i r 1 w i r ω i ϑ t γ i ω ϑ 1 ω i ϑ ω i r t γ i ω r 1 ω i r whose time derivative along 30 satisfies 36 v 1 i 1 m e i 1 t k i 1 e i 1 h i 1 t e i 1 i 1 m λ min k i 1 e i 1 2 λ min k i 1 w i ϑ 2 λ min k i 1 w i r 2 λ min k i 1 ω i ϑ 2 λ min k i 1 ω i r 2 h i 1 t e i 1 λ min k i 1 w i ϑ 2 λ min k i 1 w i r 2 λ min k i 1 ω i ϑ 2 λ min k i 1 ω i r 2 i 1 m λ min k i 1 e i 2 2 h i 2 e i 2 where k i 1 diag κ i ϑ a i ϑ κ i r a i r e i 1 ϑ i r i t h i 1 ε i ϑ ε i r t e i 2 ϑ i r i w i ϑ w i r ω i ϑ ω i r t h i 2 ε i ϑ ε i r λ min k i 1 w i ϑ λ min k i 1 w i r λ min k i 1 ω i ϑ λ min k i 1 ω i r t since 37 e i 2 h i 2 θ i 1 λ min k i 1 renders 38 v 1 i 1 m 1 θ i 1 λ min k i 1 e i 1 2 where 0 θ i 1 1 it follows that the subsystem 30 is iss choosing 39 κ i p 1 s λ min p i o 2 s 2 κ i p 2 s λ max p i o 2 s 2 with p i o diag 1 γ i ϑ 1 γ i r 1 γ i ω ϑ 1 γ i ω r 1 1 λ μ it follows that 40 e i 2 t λ max p i o λ min p i o max e i 2 t 0 e γ 1 i t t 0 h i 2 θ i 1 λ min k i 1 t t 0 where γ 1 i 2 1 θ i 1 λ min k i 1 λ max p i o lemma 2 the error subsystem 34 viewed as a system with the states being z i ϖ z i ϑ and z i r the inputs being ϑ i r i and l i is iss outside the collision and obstacle avoidance region and connectivity maintenance region proof consider the following lyapunov function 41 v 1 1 2 i 1 m z i t z i d i j n i c v i j c d i k n i o v i k o d i j n i m v i j m z i ϑ 2 z i r 2 ϖ 2 2 λ μ taking the time derivative of 41 and using the error dynamics 34 it follows that 42 v 2 i 1 m q i t k i q i a i ϑ z i ϑ 2 a i r z i r 2 κ i ϑ z i ϑ ϑ i κ i r z i r r i q i t b i l i e i 1 z i f t ν i ϖ 2 μ where k i k i π i and ν i j n i a i j p j p i j d r i ψ i 0 δ 0 r i β i d t it follows that 43 v 2 i 1 m λ min k i q i 2 a i ϑ a i r z i ϑ r 2 z i f ν i κ i ϑ κ i r e i 2 z i ϑ r l i e i 2 b i q i ϖ 2 μ where z i ϑ r z i ϑ z i r t define q q 1 t q m t t z z 1 t z m t t z ϑ r z 1 ϑ r t z m ϑ r t t e 3 z t z ϑ r t ϖ t and c min i 1 m λ min k i a i ϑ a i r 1 μ outside the collision avoidance and connectivity preservation region r p i j r m v i j c p i v i j o p i v i j m p i 0 hence q i z i and 43 can be rewritten as follows 44 v 2 c 1 θ 2 e 3 2 c θ 2 e 3 2 e 3 i 1 m 2 ℏ i e i 2 l i where ℏ i max i 1 m κ i ϑ κ i r b i noting that 45 e 3 i 1 m 2 ℏ i e i 2 l i c θ 2 renders 46 v 2 c 1 θ 2 e 3 2 it can be concluded that subsystem 34 is iss choosing 47 κ p 3 s λ min p c 2 s 2 κ p 4 s λ max p c 2 s 2 with p c diag 1 d i 1 λ μ it follows that 48 e 3 t λ max p c λ min p c max e 3 t 0 e γ 2 i t t 0 i 1 m 2 ℏ i e i 2 l i c θ 2 t t 0 where γ 2 i 2 c 1 θ 2 λ max p c the stability of the closed loop distributed time varying formation control system is stated as below theorem 1 consider the asv kinematics 9 and kinetics 8 with kinematic guidance law 4 1 the path update law 21 the reference model 24 the neural estimator 27 the adaptation law 29 and the kinetic control law 32 if assumption 1 is satisfied the path guided time varying formation maneuvering control with collision avoidance and connectivity preservation can be achieved and all signals in the closed loop path guided time varying formation maneuvering system are uniformly ultimately bounded proof at first we prove the stability of the closed loop system outside the collision abstable avoidance and connectivity reservation range by applying cascade system stability and using lemmas 1 and 2 the closed loop system cascaded by subsystem 30 and subsystem 34 is iss according to 24 there exists a positive constant l i such that l i l i it follows from 40 and 48 that e 3 is ultimately bounded by 49 e 3 t λ max p c λ min p c i 1 m λ max p i o λ min p i o 2 ℏ i h i 2 c θ i 1 θ 2 λ min k i 1 2 l i c θ 2 let e e 1 t e m t t r diag r 1 t ψ 1 r m t ψ m and δ δ 0 δ 0 t where e i p i p i d p 0 and then z z δ r h i 2 e δ where h d a with d diag d i r m m under assumption 1 h is nonsingular and we obtain e z δ o h e 3 δ o h where o h is the smallest singular value of h hence 50 e t 1 o h λ max p c λ min p c i 1 m λ max p i o λ min p i o 2 ℏ i h i 2 c θ i 1 θ 2 λ min k i 1 2 l i c θ 2 δ implying 11 since ϖ is bounded there exists ε 2 such that 12 is satisfied this means that control objective 11 and 12 are achieved next we analyze the stability of the formation control system where the asvs are inside the collision avoidance or connectivity preservation range i e r p i j r or r m p i j r m recalling 43 and letting e 4 q t z 2 t ϖ t it follows that 51 v 2 c 1 θ 3 e 4 2 c θ 3 e 4 2 e 4 i 1 m 2 ℏ i e i 2 l i ν i since 52 e 4 i 1 m 2 ℏ i e i 2 l i ν i c θ 3 renders 53 v 2 c 1 θ 3 e 4 2 as e i 2 l i and ν i are bounded the signals in e 4 are bounded because v 2 is non increasing when the asvs are inside the collision obstable avoidance and connectivity preservation range and v i j c as p i j r v i j o as p i j r o and v i j m as p i j r m there is no collision among asvs static obstacles can be avoided and connectivity is maintained if the vehicle network are initially connected the control objectives 13 and 14 are achieved this proof completes in summary the proposed path guided distributed time varying formation control algorithm is given in table 1 5 simulation result in this section simulation results are provided to illustrate the efficacy of the proposed path guided distributed time varying formation controllers for under actuated asvs consider a swarm system consisting of five asvs and one leader the virtual leader is set to move along a parameterized path p 0 θ 0 06 θ 2 0 06 θ 2 t the parameters for the five vehicles are selected as m i u 25 8 k g m i v 33 8 k g m i r 2 76 k g m 2 f i u 5 87 u 3 1 33 u u 0 72 u m i v v r 1 0948 r 2 f i v 36 5 v v 0 8896 v 0 805 v r m i u u r and f i r 0 75 r r 1 90 r 0 08 v r m i u m i v u v 1 0948 u r the initial states of five asvs are given as p 1 1 8 1 8 t p 2 t 2 6 p 3 2 2 t p 4 2 9 t p 5 2 5 t the desired formation pattern are set as p 1 d 0 0 t p 2 d 5 sin t 16 5 cos t 16 t p 3 d 5 sin t 16 5 cos t 16 t p 4 d 10 sin t 16 10 cos t 16 t and p 5 d 10 sin t 16 10 cos t 16 t the parameters for the proposed controllers are set to k i diag 0 1 0 1 δ 0 0 1 λ 10 ε i 0 01 μ 10 γ i ϑ 50 γ i r 50 γ i ω ϑ 20 γ i ω r 20 a i ϑ 5 and a i r 5 the parameters for the potential functions are selected as r o 13 r o 10 r m 10 r m 7 5 r 4 5 r 2 in order to test the control performance of the proposed adaptive kinetic controller in the presence of unknown control gains some variations on the inertial parameters are added and the inertial parameters change according to the sets m i u 12 9 k g 25 8 k g 38 7 k g 51 6 k g 64 5 k g and m i r 1 38 k g m 2 2 76 k g m 2 4 14 k g m 2 5 52 k g m 2 6 90 k g m 2 the control performance under different control input gains is verified under the same control parameters the simulation results by using the proposed path guided distributed time varying formation control algorithm in table 1 are illustrated in figs 2 10 fig 2 shows the path guided distributed time varying formation control trajectories of the five asvs it can be observed that a circular formation shaped by the five asvs is achieved in addition static obstacles are avoided and there are no collisions between asvs fig 3 plots the distances of connected asvs through an underlying network during 300s 600s the relative distances are smaller than the prescribed relative distance because obstacle avoidance capability is activated due to the static obstables fig 4 depicts the time varying formation tracking control errors of the five asvs the obstacle avoidance function is active when obstacles are encountered leading to non zero formation tracking errors fig 5 shows the surge speed and the yaw speed of five asvs fig 6 depicts the profiles of the surge force and the yaw torque of five asvs fig 7 and fig 8 show the tracking performances of the total speed and yaw velocity in the presence of different ω i u and ω i r respectively it can be observed that the tracking errors can converge to a small neighborhood of zero regardless of the variation of ω i u or ω i r finally the estimation performances of ω ˆ i u and ω ˆ i r corresponding to the first asv are given in fig 9 and fig 10 respectively it can be observed they arrive constant values after a short transient learning process 6 conclusion this paper has investigated the path guided time varying formation control problem for a swarm of under actuated asvs subject to model uncertainties and unknown input gains a design method is presented to achieve a time varying formation control with capability of collision avoidance and connectivity preservation specifically a distributed guidance control law is proposed based on a consensus approach a path following design artificial potential functions and an auxiliary variable approach at the kinematic level at the kinetic level an adaptive kinetic control law is designed on the basis of indirect model reference adaptive control where a neural estimator is used to identify the unknown uncertainties ocean disturbances and unknown input gains the stability is established based on cascade stability analysis simulation results showed the efficiency of the proposed path guided time varying formation controller for under actuated asvs subject to unknown input gains in future it is of interest to investigate the time varying formation control of asvs guided by multiple leaders acknowledgement this work was supported in part by the national natural science foundation of china under grants 61673081 51979020 51909021 51579023 and in part by science and technology fund for distinguished young scholars of dalian under grant 2018rj08 and in part by the stable supporting fund of science and technology on underwater vehicle technology jckys2019604sxjqr 01 and in part by the innovative talents in universities of liaoning province under grant lr2017014 and in part by the training program for high level technical talent in transportation industry under grant 2018 030 and in part by the national key research and development program of china under grant 2016yfc0301500 and in part by the fundamental research funds for the central universities under grant 3132019319 and in part by china postdoctoral science foundation 2019m650086 
