index,text
24110,parameterizing the dissipative effects of small unresolved coastal features is fundamental to improve the skills of wave models the established technique to deal with this problem consists in reducing the amount of energy advected within the propagation scheme and is currently available only for regular grids to find a more general approach mentaschi et al 2015b formulated a technique based on source terms and validated it on synthetic case studies this technique separates the parameterization of the unresolved features from the energy advection and can therefore be applied to any numerical scheme and to any type of mesh here we developed an open source library for the estimation of the transparency coefficients needed by this approach from bathymetric data and for any type of mesh the spectral wave model wavewatch iii was used to show that in a real world domain such as the caribbean sea the proposed approach has skills comparable and sometimes better than the established propagation based technique keywords wave modeling subscale modelling unresolved obstacles wavewatch uost source term 1 introduction unresolved bathymetric and coastal features such as cliffs shoals and small islands are a major source of local error in spectral wave models their dissipative effects can be accumulated over long distances and therefore neglecting them can compromise the simulation skills on large portions of the domain mentaschi et al 2015a tolman 2003 tuomi et al 2014 an established approach to subscale model these dissipative effect consists in attenuating the energy of the waves as they travel through partially obstructed cells representing the unresolved features by means of transparency coefficients this attenuation is typically implemented in the numerical scheme that models energy advection booij et al 1999 hardy et al 2000 tolman 2014 2003 generally in this approach only 2 transparency coefficients are considered for spectral components moving along the 2 axes of the mesh though for some implementations the directional layout of the unresolved obstacles is considered hardy et al 2000 the introduction of this technique led to major improvements of the models skill but comes with an important drawback the fact that it is implemented in the propagation scheme till now limited its application to the sole regular grids this is due to a couple of reasons 1 in principle the established approach could be implemented in any numerical scheme based on cell boundary fluxes however some of the logics implemented in regular grids for subscale modelling are not immediately applicable to some of the other types of mesh for example in finite elements schemes the evolution of the spectral density is estimated in terms of flux convergence into the median dual cells associated with the nodes roland 2008 tolman 2014 zijlema 2010 in such schemes understanding the directionality of the reductions related with unresolved obstacles and how these reductions should be combined would not be straightforward 2 powerful reliable and freely available tools exist for the automatic estimation of the unresolved obstacles in regular grids e g chawla and tolman 2008 for other types of mesh like triangular meshes roland 2008 zijlema 2010 or spherical multi cell smc meshes li 2011 these tools should be deeply revised these drawbacks impact both model developers the cost of developing and testing the established technique might be high and modelers currently a parameterization of unresolved obstacles for meshes other than regular does not exist we further need to say that the meshes of finite elements and smc schemes are flexible and in principle allow overcoming the problem of unresolved coastal features by increasing the grid resolution locally however this may result in computationally expensive meshes especially for large scale models not to mention the overhead required to elaborate locally highly refined flexible meshes therefore a good first order parameterization of the effects of unresolved obstacles would be very useful also when using one of these schemes a possible solution to this problem is parameterizing the unresolved features with source terms thus separating the parameterization of the unresolved obstacles from the energy propagation the unresolved obstacles source term uost was proposed by mentaschi et al 2015b to this purpose and models the effects of the subscale features on the cell where they are located and their shadow on the downstream cells uost was tested in a set of ideal case studies where its skills have been found to be close to the average skills of high resolution models mentaschi et al 2015b in this manuscript we present the first application of uost to a real world case i e based on real world bathymetry and wind data that was possible only after the development of a software package hereinafter referenced as alphabetalab for the estimation of the transparency coefficients needed by the source term from real bathymetric data we focused our efforts on the caribbean sea an area where the presence of many small islands and cliffs requires parameterization in low resolution models due to their corresponding large impact on wave dynamics we examined the performances of uost on a time frame of 10 years 2000 2009 and compared it to the approach established in ww3 chawla and tolman 2008 tolman 2003 in section 2 a brief summary of uost is given section 3 describes the simulations carried out in this study and the methodology used for validation and comparison in section 4 the model skill in the caribbean sea is presented and discussed conclusions are finally drawn in section 5 2 parameterizing unresolved features with source terms the uost alphabetalab approach relies on the hypothesis that any mesh can be considered as a set of polygons called cells and that a spectral wave model estimates the average value of the unknowns in each cell the definition of cell depends on the numerical scheme in regular grids the cells are all the rectangles that form when the domain is subdivided with a regular lattice in triangular meshes the nodes are the reference points of the median dual cells in smc meshes cells are rectangular as in regular grids and their size and position depend on the resolution of the local lattice given a cell let us call it a fig 1 ab uost estimates for each spectral component the effect of a the unresolved features located in a local dissipation ld b the unresolved features located upstream of a and projecting their shadow on a shadow effect se for the estimation of se an upstream polygon a is defined for each cell spectral component as the intersection between the joint cells neighboring a cells b c and d in fig 1 a b and the flux upstream of a for each cell or upstream polygon and for each spectral component two different transparency coefficients are estimated 1 the overall transparency coefficient α a value of 1 for this coefficient indicates a cell or upstream polygon completely free of unresolved obstacles while α 0 indicates a totally obstructed cell upstream polygon 2 a layout dependent transparency β defined as the average transparency of cell sections starting from the cell upstream side values close to 1 represent a polygon free of obstacles or with obstacles all located close to the downstream side values close to 0 indicate that the polygon is totally obstructed and the obstacles are all located close to the upstream side of the polygon the values of α and β are such that always β α the ld and se components of the source term can be written as mentaschi et al 2015b 1 f t l d x k 1 β l β l c g δ l f 2 f t s e x k β u α u 1 c g δ l f where f is the spectral density x is the position of the cell in space k is the wave vector of the spectral component cg is the group velocity δl is the path length of the spectral component in the cell the subscripts l and u of α and β indicate that these coefficients can be referred respectively to the cell and to the upstream polygon we need to mention that theoretically a formulation based on source terms such as uost is unable to model total blocking however we notice that the ld and se contributions diverge in case of total blocking virtually providing infinite dissipation in practice a high limit is imposed to the maximum allowed dissipation able to dump almost completely the energy for a more detailed discussion of 1 and 2 the reader is referred to mentaschi et al 2015b the estimation of the transparency coefficients from a real bathymetry is a major challenge in the parameterization of unresolved obstacles and the reason for the development of automation software such as gridgen chawla and tolman 2008 the package alphabetalab comes as a logical generalization of gridgen and automates the estimation of the upstream polygon and of the coefficients αl βl αu βu without making any assumption on the geometrical nature of the cells other than considering them as free polygons this involves that it can be applied to any type of mesh including unstructured finite elements and smc meshes we need to mention that while uost would be able to modulate the energy dissipation with the spectral frequency only the direction is currently considered in alphabetalab given a polygon alphabetalab estimates the transparency coefficient α as a function of the cross section σ of the unresolved obstacles for each directional bin fig 1 c d 3 α x k 1 σ x k the coefficient β is estimated slicing the cell into ns subsections starting from the upstream side along the direction of each propagating spectral component i e the sides of the slices are normal to the propagation direction the last slice being equal to the whole polygon in the case shown in 1 c where the algorithm is illustrated for ns 4 and for a spectral component propagating along the x axis for a rectangular cell the first slice would span from x0 to x1 the last from x0 to x4 the coefficient β is then estimated as the average α of all the slices in the present study ns 8 slices have been considered for each directional bin for more details about the definition and the estimation of β the reader is referred to mentaschi et al 2015b for cells intersecting large land bodies for more than 10 of their surface α and β are set to 1 no unresolved obstacles because there uost would conflict with the resolved part of wave sheltering and shallow water dynamics we need to underline that both uost and gridgen do not provide full subscale modelling but only a parameterization of the energy dissipation due to unresolved obstacles full subscale modelling would require also a parameterization of refraction reflection as well as shallow water dynamics mentaschi et al 2015b 2 1 time resolution in spectral models adopting the fractional steps method yanenko 1971 setting a source term time step i e the time step of application of the source terms much larger than the critical courant friedrichs lewy cfl time step i e the time required for the fastest spectral component to cross a specific cell can lead to inaccuracies especially if the wave climate and wind forcing change significantly in the length scale of one cell tolman 2014 appendix b1 this can happen for example in extreme conditions in the case of subscale modeling significant changes in the amount of advected wave energy take place inside single cells due to the presence of local or upstream unresolved features using time steps larger than the critical cfl time step for spatial propagation would results in a leakage of energy that would pass through the cell without being attenuated by uost this restriction on the time step comes as a limitation of uost with respect to gridgen although in the simulations carried out in the current study the computational costs of uost and of gridgen are roughly equal the adoption of a time step equal to the critical cfl time step can result in computationally more expensive models depending on the specific application there are however practices and possible future developments that can alleviate this limitation 1 using unstructured grids especially with implicit schemes a modeler may choose the minimum size of a cell where a complete parameterization of unresolved obstacles is required and set consequently the source term time step of the model to the resulting critical cfl time step in other words only cells large enough for their critical cfl time steps to be larger than the source term time step would be considered in uost this would be enough to model correctly for example conditions when high resolution resolved coasts are sheltered by low resolution resolved coral reefs cliffs tiny islands 2 in models adopting the fractional steps method the application of the uost source term could be done for each spectral component according to the propagation time step rather than to the source term time step this strategy would remove the limitation for explicit schemes but not for implicit schemes where the propagation time step can exceed the critical cfl time step 3 let us define cfl critical length lcfl as the distance covered by a spectral component in a single time step a future development of alphabetalab may distribute the effect of the unresolved obstacles of a cell smaller than lcfl through several contiguous cells in order to cover a distance lcfl such an implementation would remove the limitation also for implicit numerical schemes with a time step above the critical cfl one besides implicit schemes with a time step larger than the critical cfl one are known for providing good spatial means of the variables but the numerical accuracy at single cells is limited e g choi and moin 1994 3 model setup and runs the uost approach was implemented in the third generation spectral wave model wavewatch iii hereinater ww3 tolman 2014 version 4 18 for all the different spatial resolutions the spectral resolution consists of 25 frequencies exponentially spaced ranging from 0 04 hz corresponding to a period of 25 s to 0 45 hz about 2 s and 24 directions the source term st4 ardhuin et al 2010b was employed to represent the growth dissipation of the waves the source term time step i e the time step of application of the source terms that in ww3 coincides with the main time step was set to 1800 s for all the simulations the models ran on a global domain but subscale modelling was applied and investigated only in the area of the caribbean 100 e longitude 55 e 5 n latitude 30 n the forcing consists of cfsr winds and the time horizon is 10 years ranging from 2000 to 2009 the simulations were performed at different resolutions employing different approaches for subscale modelling uost was applied to a regular mesh with a resolution of 1 5 deg simulation uost15 the same grid was used with the propagation scheme based approach implemented in ww3 hereinafter gridgen chawla and tolman 2008 simulation gridgen15 and with no subscale modelling simulation nosm15 to compare the skills of the 1 5 deg simulations with higher resolution ones a subsequent run was carried out with a resolution of 0 4 deg simulation gridgen04 these simulations are summarized in table 1 for the gridgen runs the obstruction coefficients have been estimated using the software package distributed with the source code of ww3 fig 2 for the computation of the transparency coefficients needed by uost alphabetalab was employed the resulting values of αl θ and βl θ i e the local transparency coefficients of the cell are shown in fig 3 a for each cell as a pie diagram while αu θ βu θ i e the transparency coefficients of the upstream polygon are shown in fig 3b we need to mention that α and β can be represented in the same pie diagram because always β α therefore when the blue value is not visible we are in a situation when β α for those cells with α and β uniformly equal to 1 i e cells without unresolved obstacles a full pie would be plotted but in such cases the pie is not plotted for the validation the simulated significant wave height hs was compared with measurements of satellite altimeters queffeulou and croizé fillon 2014 since the spatial temporal resolution of satellite data along the satellite tracks is much higher than that of the model satellite data have been binned over latitudinal spans of 1 5 coincident with the latitudinal limits of the coarser grid cells and averaged before comparing them with model data the average skills of the models are quantified estimating for each of the cells the normalized root mean square error nrmse the normalized bias nbi and the normalized bias of the mean annual maxima nbiymax mentaschi et al 2013 the overall value of these indicators is computed by averaging them over the cells covering the caribbean sea region the directional spectra of the different model set ups were compared at location a fig 4 during the tropical storm helen in september 2000 further at location b fig 4 where the buoy 42 059 of the us national data buoy center ndbc is moored hs the mean period t 10 holthuijsen 2007 komen et al 1994 and the frequency spectra of the different model set ups were compared with the ones measured by the buoy 4 model skill in the caribbean sea the skills of uost15 and gridgen15 for the examined case are qualitatively similar and both can be considered as a major improvement compared with nosm15 table 1 in the caribbean sea the model without subscale modelling has a strong positive bias of about 20 of mean hs while gridgen15 and uost15 have a weak negative bias of about 1 and 0 5 respectively the performance measured with nrmse of hs shows a similar trend nosm15 having a high nrmse close to 30 and the other simulations with a much lower value between 17 and 18 uost15 is the overall best performing with nrmse 17 13 the positive bias of annual maxima is 9 for nosm15 while it ranges between 2 7 and 3 7 for the other simulations in this case uost15 performs slightly worse compared to gridgen15 about 3 7 vs 2 7 but its skills are similar to gridgen04 about 3 6 interestingly increasing the spatial resolution to 0 4 deg in gridgen04 does not have a significant impact on the overall skills of the model in this domain neither in terms of average hs nor in terms of yearly maxima this can be explained with the fact that uost and gridgen parameterize the large scale effect of small bathymetric features reasonably well and consequently the average skills of low and high resolution models on large areas are comparable the benefit of high resolution would be better appreciated considering the model performance in proximity of the coast or of small features not resolved in low resolution models or in the development of mesoscale dominated extreme events such as tropical cyclones provided these events are adequately modeled in the wind forcing this consideration underlines the importance in wave modelling of subscale parameterizations such as uost and gridgen cell by cell skills of uost15 and gridgen15 are illustrated in fig 4 uost15 performs generally better in the area around florida the bahamas and cuba in this area both uost15 and gridgen15 are affected by strong positive bias but in uost15 the bias is reduced in some cells by more than 30 the explanation is that the bahamas islands have an elongated shape lying in direction nw se normal to the dominant wave climate with energy coming mainly from ne in the uost scheme the transparency coefficients α and β are modulated with the direction this can be seen clearly in fig 3 a b where at the bahamas islands the α β pies are clearly tilted in nw se direction involving a stronger dissipation for spectral components coming from ne than for those coming from nw instead in gridgen only two transparencies are considered one in longitudinal and the other in latitudinal direction fig 2 consequently the dissipation in direction ne sw is underestimated the directionality of unresolved obstacles plays a role also west of the lesser antilles which have a geometry clearly tilted around the eastern caribbean fig 3a b the skill of uost15 is considerably worse than gridgen15 south of cuba exhibiting a strong underestimation of hs this is due to the inability of the alphabetalab algorithm to determine which parts of cuba should be considered as unresolved the cells close to large land bodies are generally modelled correctly without subscale modelling and that is why both alphabetalab and gridgen do not compute a transparency coefficient for cells close to continental coasts in this case cuba provides a limiting case because at a resolution of 1 5 parts of it are correctly represented as land while other parts need to be parameterized with subscale modelling gridgen is better than alphabetalab in detecting in which cases subscale modelling is needed the current implementation of alphabetalab estimates transparency coefficients in too many cells and the dissipation south of cuba is consequently overestimated indeed alphabetalab estimates low transparency coefficients α and β in cells intersecting the coasts of cuba fig 3 whereas gridgen correctly identifies them as coastal cells with transparency equal to 1 obstruction level equal to 0 fig 2 the directional spectra were examined and compared at location a south of the virgin island coordinates 64 81 e 16 775 n fig 4 during the tropical storm helen in september 2000 fig 5 location a was chosen because it is placed along the storm track of a medium size tropical storm like helen downstream of the lesser antilles at this location both uost15 and gridgen15 perform generally well but gridgen15 slightly underestimates hs for this tropical storm the time series of hs for uost15 gridgen15 and gridgen04 lie fairly close together far below the strongly overestimating nosm15 fig 5a we notice that hs estimated by gridgen04 lies between gridgen15 and uost15 the spectra of september 18 2000 simulated by uost15 gridgen15 and gridgen04 for location a have a similar shape with an intense peak directed towards sw corresponding to the moving direction of the tropical storm and a weaker peak directed towards nw fig 5b c e in uost15 the sw peak is more intense than in the other models due to weaker dissipation associated with the small islands ne of location a the nw peak is alike in all three simulations in this case spectra and hs of gridgen15 and gridgen04 are more similar than that of uost15 this could depend from the fact location a is in proximity of small islands that even in gridgen04 require the gridgen approach for a correct parameterization a further test was performed at location b south west of puerto rico coordinates 67 51 e 15 252 n fig 4 in january 2008 here frequency spectra and bulk parameters modeled by the different simulations were compared with the 12 h moving average of the ones measured at buoy 42 059 of ndbc fig 6 at this location both uost15 and gridgen15 generally underestimate hs fig 4d e likely due to a tendency of parameterization test451f of ardhuin et al 2010a to underestimate short fetches with cfsr wind data kazeminezhad and siadatmousavi 2017 mentaschi et al 2015a however neglecting the unresolved obstacles leads to strong overestimation of both hs and t 10 fig 6a b the values simulated by uost and gridgen04 both for bulk parameters and frequency spectra are remarkably similar the differences between the buoy spectra and the ones modeled by uost gridgen are party due to the underestimation of the model partly to limitations of the discrete interaction approximation dia that tends to overestimate the energy transfer from the peak to higher and lower frequencies hasselmann et al 1985 rogers and van vledder 2013 furthermore the broader shape of the modeled spectra compared with the measured ones may be related with the underestimation of both wave growth that takes place mainly at high frequencies and wave dissipation at low frequencies in the comparison of the frequency spectra nosm is found overestimating mainly at low frequencies corresponding to swell that in uost and gridgen15 are better modelled thanks to the parameterization of unresolved obstacles 5 final remarks our analysis indicates that uost can be successfully applied to real world applications in general uost performances are comparable to the ones of the established approach for subscale modelling in some locations where a correct parameterization of the unresolved obstacles is crucial like downstream of the bahamas and the antilles islands the skills of uost benefit of its taking into account the directional layout of the unresolved obstacles in other areas uost underperforms and this can be attributed to limits of the current implementation of alphabetalab rather than to the uost approach itself for example south of cuba where strong dissipation is modelled in areas with coastal features that should not be considered unresolved fig 3 however the real advantage of uost is its applicability to any numerical scheme and the development of alphabetalab is a significant step towards this generalization the only further step necessary to implement uost on a particular mesh is to provide alphabetalab the mesh definition as a set of polygonal cells for example an implementation for triangular grids based on an approximate estimation of the median dual cell is already available although it requires further test a problem of the current implementation of alphabetalab is that it is rather slow it takes about 2 minutes to estimate the transparency coefficients in the small domain considered in this study even parallelizing the computation on 12 highly performing xeon cores while runs on bigger domains would require much longer times while this is surely a secondary aspect alphabetalab has to run once for one domain a better optimized version of the algorithm would be useful for faster development and testing the source code of alphabetalab is freely available at https github com menta78 alphabetalab for the sake of reproducibility the related methods article mentaschi et al 2018 contains detailed instructions to replicate the case study on the caribbean sea and a description of the architecture of alphabetalab acknowledgment the research leading to these results has received funding from the jrc of the european commission as part of the coast and adaptation projects we thank the anonymous reviewers for helping with their comments to substantially improve the quality of this manuscript supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ocemod 2018 04 003 appendix supplementary materials image application 1 
24110,parameterizing the dissipative effects of small unresolved coastal features is fundamental to improve the skills of wave models the established technique to deal with this problem consists in reducing the amount of energy advected within the propagation scheme and is currently available only for regular grids to find a more general approach mentaschi et al 2015b formulated a technique based on source terms and validated it on synthetic case studies this technique separates the parameterization of the unresolved features from the energy advection and can therefore be applied to any numerical scheme and to any type of mesh here we developed an open source library for the estimation of the transparency coefficients needed by this approach from bathymetric data and for any type of mesh the spectral wave model wavewatch iii was used to show that in a real world domain such as the caribbean sea the proposed approach has skills comparable and sometimes better than the established propagation based technique keywords wave modeling subscale modelling unresolved obstacles wavewatch uost source term 1 introduction unresolved bathymetric and coastal features such as cliffs shoals and small islands are a major source of local error in spectral wave models their dissipative effects can be accumulated over long distances and therefore neglecting them can compromise the simulation skills on large portions of the domain mentaschi et al 2015a tolman 2003 tuomi et al 2014 an established approach to subscale model these dissipative effect consists in attenuating the energy of the waves as they travel through partially obstructed cells representing the unresolved features by means of transparency coefficients this attenuation is typically implemented in the numerical scheme that models energy advection booij et al 1999 hardy et al 2000 tolman 2014 2003 generally in this approach only 2 transparency coefficients are considered for spectral components moving along the 2 axes of the mesh though for some implementations the directional layout of the unresolved obstacles is considered hardy et al 2000 the introduction of this technique led to major improvements of the models skill but comes with an important drawback the fact that it is implemented in the propagation scheme till now limited its application to the sole regular grids this is due to a couple of reasons 1 in principle the established approach could be implemented in any numerical scheme based on cell boundary fluxes however some of the logics implemented in regular grids for subscale modelling are not immediately applicable to some of the other types of mesh for example in finite elements schemes the evolution of the spectral density is estimated in terms of flux convergence into the median dual cells associated with the nodes roland 2008 tolman 2014 zijlema 2010 in such schemes understanding the directionality of the reductions related with unresolved obstacles and how these reductions should be combined would not be straightforward 2 powerful reliable and freely available tools exist for the automatic estimation of the unresolved obstacles in regular grids e g chawla and tolman 2008 for other types of mesh like triangular meshes roland 2008 zijlema 2010 or spherical multi cell smc meshes li 2011 these tools should be deeply revised these drawbacks impact both model developers the cost of developing and testing the established technique might be high and modelers currently a parameterization of unresolved obstacles for meshes other than regular does not exist we further need to say that the meshes of finite elements and smc schemes are flexible and in principle allow overcoming the problem of unresolved coastal features by increasing the grid resolution locally however this may result in computationally expensive meshes especially for large scale models not to mention the overhead required to elaborate locally highly refined flexible meshes therefore a good first order parameterization of the effects of unresolved obstacles would be very useful also when using one of these schemes a possible solution to this problem is parameterizing the unresolved features with source terms thus separating the parameterization of the unresolved obstacles from the energy propagation the unresolved obstacles source term uost was proposed by mentaschi et al 2015b to this purpose and models the effects of the subscale features on the cell where they are located and their shadow on the downstream cells uost was tested in a set of ideal case studies where its skills have been found to be close to the average skills of high resolution models mentaschi et al 2015b in this manuscript we present the first application of uost to a real world case i e based on real world bathymetry and wind data that was possible only after the development of a software package hereinafter referenced as alphabetalab for the estimation of the transparency coefficients needed by the source term from real bathymetric data we focused our efforts on the caribbean sea an area where the presence of many small islands and cliffs requires parameterization in low resolution models due to their corresponding large impact on wave dynamics we examined the performances of uost on a time frame of 10 years 2000 2009 and compared it to the approach established in ww3 chawla and tolman 2008 tolman 2003 in section 2 a brief summary of uost is given section 3 describes the simulations carried out in this study and the methodology used for validation and comparison in section 4 the model skill in the caribbean sea is presented and discussed conclusions are finally drawn in section 5 2 parameterizing unresolved features with source terms the uost alphabetalab approach relies on the hypothesis that any mesh can be considered as a set of polygons called cells and that a spectral wave model estimates the average value of the unknowns in each cell the definition of cell depends on the numerical scheme in regular grids the cells are all the rectangles that form when the domain is subdivided with a regular lattice in triangular meshes the nodes are the reference points of the median dual cells in smc meshes cells are rectangular as in regular grids and their size and position depend on the resolution of the local lattice given a cell let us call it a fig 1 ab uost estimates for each spectral component the effect of a the unresolved features located in a local dissipation ld b the unresolved features located upstream of a and projecting their shadow on a shadow effect se for the estimation of se an upstream polygon a is defined for each cell spectral component as the intersection between the joint cells neighboring a cells b c and d in fig 1 a b and the flux upstream of a for each cell or upstream polygon and for each spectral component two different transparency coefficients are estimated 1 the overall transparency coefficient α a value of 1 for this coefficient indicates a cell or upstream polygon completely free of unresolved obstacles while α 0 indicates a totally obstructed cell upstream polygon 2 a layout dependent transparency β defined as the average transparency of cell sections starting from the cell upstream side values close to 1 represent a polygon free of obstacles or with obstacles all located close to the downstream side values close to 0 indicate that the polygon is totally obstructed and the obstacles are all located close to the upstream side of the polygon the values of α and β are such that always β α the ld and se components of the source term can be written as mentaschi et al 2015b 1 f t l d x k 1 β l β l c g δ l f 2 f t s e x k β u α u 1 c g δ l f where f is the spectral density x is the position of the cell in space k is the wave vector of the spectral component cg is the group velocity δl is the path length of the spectral component in the cell the subscripts l and u of α and β indicate that these coefficients can be referred respectively to the cell and to the upstream polygon we need to mention that theoretically a formulation based on source terms such as uost is unable to model total blocking however we notice that the ld and se contributions diverge in case of total blocking virtually providing infinite dissipation in practice a high limit is imposed to the maximum allowed dissipation able to dump almost completely the energy for a more detailed discussion of 1 and 2 the reader is referred to mentaschi et al 2015b the estimation of the transparency coefficients from a real bathymetry is a major challenge in the parameterization of unresolved obstacles and the reason for the development of automation software such as gridgen chawla and tolman 2008 the package alphabetalab comes as a logical generalization of gridgen and automates the estimation of the upstream polygon and of the coefficients αl βl αu βu without making any assumption on the geometrical nature of the cells other than considering them as free polygons this involves that it can be applied to any type of mesh including unstructured finite elements and smc meshes we need to mention that while uost would be able to modulate the energy dissipation with the spectral frequency only the direction is currently considered in alphabetalab given a polygon alphabetalab estimates the transparency coefficient α as a function of the cross section σ of the unresolved obstacles for each directional bin fig 1 c d 3 α x k 1 σ x k the coefficient β is estimated slicing the cell into ns subsections starting from the upstream side along the direction of each propagating spectral component i e the sides of the slices are normal to the propagation direction the last slice being equal to the whole polygon in the case shown in 1 c where the algorithm is illustrated for ns 4 and for a spectral component propagating along the x axis for a rectangular cell the first slice would span from x0 to x1 the last from x0 to x4 the coefficient β is then estimated as the average α of all the slices in the present study ns 8 slices have been considered for each directional bin for more details about the definition and the estimation of β the reader is referred to mentaschi et al 2015b for cells intersecting large land bodies for more than 10 of their surface α and β are set to 1 no unresolved obstacles because there uost would conflict with the resolved part of wave sheltering and shallow water dynamics we need to underline that both uost and gridgen do not provide full subscale modelling but only a parameterization of the energy dissipation due to unresolved obstacles full subscale modelling would require also a parameterization of refraction reflection as well as shallow water dynamics mentaschi et al 2015b 2 1 time resolution in spectral models adopting the fractional steps method yanenko 1971 setting a source term time step i e the time step of application of the source terms much larger than the critical courant friedrichs lewy cfl time step i e the time required for the fastest spectral component to cross a specific cell can lead to inaccuracies especially if the wave climate and wind forcing change significantly in the length scale of one cell tolman 2014 appendix b1 this can happen for example in extreme conditions in the case of subscale modeling significant changes in the amount of advected wave energy take place inside single cells due to the presence of local or upstream unresolved features using time steps larger than the critical cfl time step for spatial propagation would results in a leakage of energy that would pass through the cell without being attenuated by uost this restriction on the time step comes as a limitation of uost with respect to gridgen although in the simulations carried out in the current study the computational costs of uost and of gridgen are roughly equal the adoption of a time step equal to the critical cfl time step can result in computationally more expensive models depending on the specific application there are however practices and possible future developments that can alleviate this limitation 1 using unstructured grids especially with implicit schemes a modeler may choose the minimum size of a cell where a complete parameterization of unresolved obstacles is required and set consequently the source term time step of the model to the resulting critical cfl time step in other words only cells large enough for their critical cfl time steps to be larger than the source term time step would be considered in uost this would be enough to model correctly for example conditions when high resolution resolved coasts are sheltered by low resolution resolved coral reefs cliffs tiny islands 2 in models adopting the fractional steps method the application of the uost source term could be done for each spectral component according to the propagation time step rather than to the source term time step this strategy would remove the limitation for explicit schemes but not for implicit schemes where the propagation time step can exceed the critical cfl time step 3 let us define cfl critical length lcfl as the distance covered by a spectral component in a single time step a future development of alphabetalab may distribute the effect of the unresolved obstacles of a cell smaller than lcfl through several contiguous cells in order to cover a distance lcfl such an implementation would remove the limitation also for implicit numerical schemes with a time step above the critical cfl one besides implicit schemes with a time step larger than the critical cfl one are known for providing good spatial means of the variables but the numerical accuracy at single cells is limited e g choi and moin 1994 3 model setup and runs the uost approach was implemented in the third generation spectral wave model wavewatch iii hereinater ww3 tolman 2014 version 4 18 for all the different spatial resolutions the spectral resolution consists of 25 frequencies exponentially spaced ranging from 0 04 hz corresponding to a period of 25 s to 0 45 hz about 2 s and 24 directions the source term st4 ardhuin et al 2010b was employed to represent the growth dissipation of the waves the source term time step i e the time step of application of the source terms that in ww3 coincides with the main time step was set to 1800 s for all the simulations the models ran on a global domain but subscale modelling was applied and investigated only in the area of the caribbean 100 e longitude 55 e 5 n latitude 30 n the forcing consists of cfsr winds and the time horizon is 10 years ranging from 2000 to 2009 the simulations were performed at different resolutions employing different approaches for subscale modelling uost was applied to a regular mesh with a resolution of 1 5 deg simulation uost15 the same grid was used with the propagation scheme based approach implemented in ww3 hereinafter gridgen chawla and tolman 2008 simulation gridgen15 and with no subscale modelling simulation nosm15 to compare the skills of the 1 5 deg simulations with higher resolution ones a subsequent run was carried out with a resolution of 0 4 deg simulation gridgen04 these simulations are summarized in table 1 for the gridgen runs the obstruction coefficients have been estimated using the software package distributed with the source code of ww3 fig 2 for the computation of the transparency coefficients needed by uost alphabetalab was employed the resulting values of αl θ and βl θ i e the local transparency coefficients of the cell are shown in fig 3 a for each cell as a pie diagram while αu θ βu θ i e the transparency coefficients of the upstream polygon are shown in fig 3b we need to mention that α and β can be represented in the same pie diagram because always β α therefore when the blue value is not visible we are in a situation when β α for those cells with α and β uniformly equal to 1 i e cells without unresolved obstacles a full pie would be plotted but in such cases the pie is not plotted for the validation the simulated significant wave height hs was compared with measurements of satellite altimeters queffeulou and croizé fillon 2014 since the spatial temporal resolution of satellite data along the satellite tracks is much higher than that of the model satellite data have been binned over latitudinal spans of 1 5 coincident with the latitudinal limits of the coarser grid cells and averaged before comparing them with model data the average skills of the models are quantified estimating for each of the cells the normalized root mean square error nrmse the normalized bias nbi and the normalized bias of the mean annual maxima nbiymax mentaschi et al 2013 the overall value of these indicators is computed by averaging them over the cells covering the caribbean sea region the directional spectra of the different model set ups were compared at location a fig 4 during the tropical storm helen in september 2000 further at location b fig 4 where the buoy 42 059 of the us national data buoy center ndbc is moored hs the mean period t 10 holthuijsen 2007 komen et al 1994 and the frequency spectra of the different model set ups were compared with the ones measured by the buoy 4 model skill in the caribbean sea the skills of uost15 and gridgen15 for the examined case are qualitatively similar and both can be considered as a major improvement compared with nosm15 table 1 in the caribbean sea the model without subscale modelling has a strong positive bias of about 20 of mean hs while gridgen15 and uost15 have a weak negative bias of about 1 and 0 5 respectively the performance measured with nrmse of hs shows a similar trend nosm15 having a high nrmse close to 30 and the other simulations with a much lower value between 17 and 18 uost15 is the overall best performing with nrmse 17 13 the positive bias of annual maxima is 9 for nosm15 while it ranges between 2 7 and 3 7 for the other simulations in this case uost15 performs slightly worse compared to gridgen15 about 3 7 vs 2 7 but its skills are similar to gridgen04 about 3 6 interestingly increasing the spatial resolution to 0 4 deg in gridgen04 does not have a significant impact on the overall skills of the model in this domain neither in terms of average hs nor in terms of yearly maxima this can be explained with the fact that uost and gridgen parameterize the large scale effect of small bathymetric features reasonably well and consequently the average skills of low and high resolution models on large areas are comparable the benefit of high resolution would be better appreciated considering the model performance in proximity of the coast or of small features not resolved in low resolution models or in the development of mesoscale dominated extreme events such as tropical cyclones provided these events are adequately modeled in the wind forcing this consideration underlines the importance in wave modelling of subscale parameterizations such as uost and gridgen cell by cell skills of uost15 and gridgen15 are illustrated in fig 4 uost15 performs generally better in the area around florida the bahamas and cuba in this area both uost15 and gridgen15 are affected by strong positive bias but in uost15 the bias is reduced in some cells by more than 30 the explanation is that the bahamas islands have an elongated shape lying in direction nw se normal to the dominant wave climate with energy coming mainly from ne in the uost scheme the transparency coefficients α and β are modulated with the direction this can be seen clearly in fig 3 a b where at the bahamas islands the α β pies are clearly tilted in nw se direction involving a stronger dissipation for spectral components coming from ne than for those coming from nw instead in gridgen only two transparencies are considered one in longitudinal and the other in latitudinal direction fig 2 consequently the dissipation in direction ne sw is underestimated the directionality of unresolved obstacles plays a role also west of the lesser antilles which have a geometry clearly tilted around the eastern caribbean fig 3a b the skill of uost15 is considerably worse than gridgen15 south of cuba exhibiting a strong underestimation of hs this is due to the inability of the alphabetalab algorithm to determine which parts of cuba should be considered as unresolved the cells close to large land bodies are generally modelled correctly without subscale modelling and that is why both alphabetalab and gridgen do not compute a transparency coefficient for cells close to continental coasts in this case cuba provides a limiting case because at a resolution of 1 5 parts of it are correctly represented as land while other parts need to be parameterized with subscale modelling gridgen is better than alphabetalab in detecting in which cases subscale modelling is needed the current implementation of alphabetalab estimates transparency coefficients in too many cells and the dissipation south of cuba is consequently overestimated indeed alphabetalab estimates low transparency coefficients α and β in cells intersecting the coasts of cuba fig 3 whereas gridgen correctly identifies them as coastal cells with transparency equal to 1 obstruction level equal to 0 fig 2 the directional spectra were examined and compared at location a south of the virgin island coordinates 64 81 e 16 775 n fig 4 during the tropical storm helen in september 2000 fig 5 location a was chosen because it is placed along the storm track of a medium size tropical storm like helen downstream of the lesser antilles at this location both uost15 and gridgen15 perform generally well but gridgen15 slightly underestimates hs for this tropical storm the time series of hs for uost15 gridgen15 and gridgen04 lie fairly close together far below the strongly overestimating nosm15 fig 5a we notice that hs estimated by gridgen04 lies between gridgen15 and uost15 the spectra of september 18 2000 simulated by uost15 gridgen15 and gridgen04 for location a have a similar shape with an intense peak directed towards sw corresponding to the moving direction of the tropical storm and a weaker peak directed towards nw fig 5b c e in uost15 the sw peak is more intense than in the other models due to weaker dissipation associated with the small islands ne of location a the nw peak is alike in all three simulations in this case spectra and hs of gridgen15 and gridgen04 are more similar than that of uost15 this could depend from the fact location a is in proximity of small islands that even in gridgen04 require the gridgen approach for a correct parameterization a further test was performed at location b south west of puerto rico coordinates 67 51 e 15 252 n fig 4 in january 2008 here frequency spectra and bulk parameters modeled by the different simulations were compared with the 12 h moving average of the ones measured at buoy 42 059 of ndbc fig 6 at this location both uost15 and gridgen15 generally underestimate hs fig 4d e likely due to a tendency of parameterization test451f of ardhuin et al 2010a to underestimate short fetches with cfsr wind data kazeminezhad and siadatmousavi 2017 mentaschi et al 2015a however neglecting the unresolved obstacles leads to strong overestimation of both hs and t 10 fig 6a b the values simulated by uost and gridgen04 both for bulk parameters and frequency spectra are remarkably similar the differences between the buoy spectra and the ones modeled by uost gridgen are party due to the underestimation of the model partly to limitations of the discrete interaction approximation dia that tends to overestimate the energy transfer from the peak to higher and lower frequencies hasselmann et al 1985 rogers and van vledder 2013 furthermore the broader shape of the modeled spectra compared with the measured ones may be related with the underestimation of both wave growth that takes place mainly at high frequencies and wave dissipation at low frequencies in the comparison of the frequency spectra nosm is found overestimating mainly at low frequencies corresponding to swell that in uost and gridgen15 are better modelled thanks to the parameterization of unresolved obstacles 5 final remarks our analysis indicates that uost can be successfully applied to real world applications in general uost performances are comparable to the ones of the established approach for subscale modelling in some locations where a correct parameterization of the unresolved obstacles is crucial like downstream of the bahamas and the antilles islands the skills of uost benefit of its taking into account the directional layout of the unresolved obstacles in other areas uost underperforms and this can be attributed to limits of the current implementation of alphabetalab rather than to the uost approach itself for example south of cuba where strong dissipation is modelled in areas with coastal features that should not be considered unresolved fig 3 however the real advantage of uost is its applicability to any numerical scheme and the development of alphabetalab is a significant step towards this generalization the only further step necessary to implement uost on a particular mesh is to provide alphabetalab the mesh definition as a set of polygonal cells for example an implementation for triangular grids based on an approximate estimation of the median dual cell is already available although it requires further test a problem of the current implementation of alphabetalab is that it is rather slow it takes about 2 minutes to estimate the transparency coefficients in the small domain considered in this study even parallelizing the computation on 12 highly performing xeon cores while runs on bigger domains would require much longer times while this is surely a secondary aspect alphabetalab has to run once for one domain a better optimized version of the algorithm would be useful for faster development and testing the source code of alphabetalab is freely available at https github com menta78 alphabetalab for the sake of reproducibility the related methods article mentaschi et al 2018 contains detailed instructions to replicate the case study on the caribbean sea and a description of the architecture of alphabetalab acknowledgment the research leading to these results has received funding from the jrc of the european commission as part of the coast and adaptation projects we thank the anonymous reviewers for helping with their comments to substantially improve the quality of this manuscript supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ocemod 2018 04 003 appendix supplementary materials image application 1 
24111,in recent years significant progress has been made in the development of high resolution ocean reanalysis products this paper compares aspects of the gulf stream gs from the florida straits to south of the grand banks particularly florida strait transport separation of the gs near cape hatteras gs properties along the oleander line from new jersey to bermuda gs path and the gs north wall positions in 13 widely used global reanalysis products of various resolutions including two unconstrained products a large spread across reanalysis products is found hycom and glorys2v4 stand out for their superior performance by most metrics some common biases are found in all discussed models for example the velocity structure of the gs near the oleander line is too symmetrical and the maximum velocity is too weak compared with observations less than half of the reanalysis products show significant correlations at the 95 confidence level with observations for the gs separation latitude at cape hatteras the gs transport and net transport across oleander line the cross stream velocity structure is further discussed by a theoretical model idealizing gs as a smoothed pv front keywords north atlantic ocean gulf stream ocean reanalysis intercomparison 1 introduction a complete quantification of ocean variables through their horizontal and vertical extents is needed to initialize and validate ocean circulation models and the oceanic component of climate models errors in specifying the state of the ocean are therefore a major source of uncertainty in climate modeling at this time numerical modeling of the global ocean has seen significant progress in recent years large errors do however remain many of these errors can be attributed to inadequate grid resolution poor parametrization of key processes errors in initialization and propagation of numerical errors in an effort to circumvent these shortcomings reanalysis products have been developed in which the models are constrained to be consistent with available observations using data assimilation procedures reanalysis products are expected to provide more accurate information than unconstrained numerical models with the caveat that significant errors are likely to remain because of inadequate coverage of the ocean by observation networks balmaseda et al 2015 toyoda et al 2017 in addition inconsistencies among different reanalyses also exist due to differences in resolutions model physics and data assimilation methods reanalysis intercomparisons are well established in the atmospheric science community but have only recently become common in oceanography for example balmaseda et al 2015 presented an ocean reanalysis intercomparison focused on global features of the ocean such as heat content sea level steric height surface heat fluxes mixed layer depth salinity depth of 20 c isotherm and sea ice for the period 1993 2010 the authors compared several reanalyses with different resolutions atmospheric fluxes or assimilation methods and found several areas of large uncertainty differences among models and systematic biases with respect to observations pointing to the need for continuous model improvement through the comparison of several long term reanalysis products stammer et al 2010 found an increasing tendency of the spread across these products toward present they suggested the convergence of different products in early years might be determined by boundary forcing and initial conditions while the large discrepancies close to the end of the estimation period are due to the different assimilation approaches lee et al 2009 reviewed existing reanalysis products and their application to meridional overturning circulation pointing out the challenges in robustly estimating the uncertainties of models and observations stammer et al 2016 reviewed applications of the ocean data assimilation in climate research pointing out the necessity of fully coupled earth system models for climate forecasts the reader is referred to the special issue on reanalysis intercomparisons in volume 49 issue 3 of climate dynamics for a more comprehensive overview of the current state of ocean reanalysis intercomparisons the intercomparison presented in this paper is narrower in scope than the previous efforts with a focus on the gulf stream gs from the florida straits to south of the grand banks the gs is not only the western boundary current of the north atlantic subtropical gyre but also a branch of the atlantic meridional overturning circulation amoc as such the gs has a major influence on the dynamics and climate of the north atlantic as well as the climates of eastern north america and europe kelly et al 2010 kwon et al 2010 palter 2015 a practical motivation for the present intercomparison is to provide an evaluation of reanalysis products for those involved in gs research furthermore the goal of ocean modeling and reanalysis in particular is to produce a model of reality the underlying hope is that these models will eventually converge on the same result in which case we can say that we ve learned something about the physical system the fact that reanalyses often disagree with observations and each other tells us that we have some distance to go before realizing this goal therefore a detailed validation of reanalysis products is valuable in its own right the gs is one of the most densely observed oceanic features in the world one expects these observations should place a particularly heavy constraint on reanalysis products compared to more sparsely observed parts of the ocean and that this would tend to minimize inter model differences in this sense the gs represents perhaps the most favorable setting in which to assess the skill of the reanalysis products if they fail to adequately represent this observation dense region of the ocean there is little reason to expect that they will provide useful results in data poor regions such as the southern ocean several previous works have compared the gs in numerical models but with different focus than this paper hurlburt and hogan 2000 and chassignet and xu 2017 evaluated the gs in a series of numerical models with horizontal resolution varying from 1 10 to 1 50 concluding that the gs simulation benefits from higher resolution specifically a significant improvement of the gs simulation is found once the resolution is sufficiently fine to resolve submesoscales 1 50 chassignet and xu 2017 hurlburt et al 2011 investigated the multi year mean gs path and its separation near the cape hatteras in several eddy resolving numerical models and found a very positive impact on the gs path simulation from data assimilation in this paper we evaluate the mean state and variability of several gs features in the reanalysis products and observational data listed in section 2 specifically the following aspects will be discussed in section 3 the florida current transport fct the separation of gs from the coast at cape hatteras the gs transport and structure along the oleander line a transect from new jersey to bermuda and the positions of the gs path and the gs north wall in section 4 a simple theoretical model is employed to explain the cross stream structure of the gulf stream and the overall performance of the numerical products is discussed finally the paper is summarized in section 5 2 datasets 2 1 reanalyses table 1 lists the reanalysis datasets used in this study all of these products are based on one of four ocean general circulation models ogcms a mit general circulation model mitgcm marshall et al 1997 b hybrid coordinate ocean model hycom bleck 2002 c modular ocean model mom pacanowski and griffies 2000 griffies et al 2004 d nucleus for european modelling of the ocean nemo madec 2008 the products based on nemo use the louvain la neuve sea ice model lim and those based on mom4 and mom5 use the sea ice simulator sis to simulate sea ice products based on hycom and the mitgcm use those ogcm s built in sea ice models while ofes and godas are run without sea ice further ofes and ecco2 are unconstrained that is they are run without assimilated data they are included in this research as examples of free run results the reanalysis products can be divided into three groups based on their horizontal resolution a eddy resolving with resolutions of 0 1 or finer hycom and ofes b eddy permitting with resolutions of 0 25 orap5 c glorsv5 glorys2v4 ur025 4 soda3 3 1 and ecco2 c and coarse resolution with resolutions of 0 5 or coarser cfsr eccov4r2 godas gecco2 and ecdav3 1 the eddy resolving and eddy permitting products will be considered as high resolution numerical products in this paper an overlapping period of all reanalysis products 1993 2010 is used in all following analysis unless otherwise noted the numerical products are always listed in order of their resolution from high resolution to low resolution 2 2 observations the observationally based datasets used to verify the numerical models are described in this section 2 2 1 en4 version 1 1 en4 version 1 1 is a 1 gridded temperature and salinity dataset based on objective analysis of observations since 1900 it is produced by the uk met office hadley centre good et al 2013 and widely used in oceanic and climate research armour et al 2016 dieng et al 2015 häkkinen et al 2015 in this paper it is considered as the reference or true temperature when in situ observations are unavailable 2 2 2 absolute dynamic topography adt absolute dynamic topography adt is the sea surface height ssh with respect to the geoid the filtered along track adt product version 5 0 and the all satellite merged 0 25 gridded adt product version 5 0 are used to detect the gs path both of them are distributed by aviso 1 1 the altimeter products were produced by ssalto duacs and distributed by aviso with support from cnes http www aviso altimetry fr duacs and the gridded adt product is referred as aviso adt in this paper 2 2 3 armor3d v3 1 armor3d v3 1 consists of monthly mean gridded temperature salinity ssh and horizontal velocity reconstructed from observations at 0 25 resolution in the upper 1500 m the temperature below sea surface is based on synthetic analyses and optimal interpolation first a synthetic temperature anomaly field is derived from sea level anomaly sla and sea surface temperature sst via multiple linear regression then the final temperature field is generated by combining the synthetic results temperature anomaly plus climate mean temperature and in situ observations though optimal interpolation guinehut et al 2012 the ssh and horizontal velocity data computed from the thermal wind equation is borrowed from its companion dataset surcouf3d mulet et al 2012 please note that armor3d is a gridded product derived from observations it is included to complement the en4 data set and provide an estimate of observational errors 2 2 4 the florida current transport fct the florida current transport fct is well observed via underwater cables and cable calibration cruises since 1982 daily fct data is available from the project website 2 2 http www aoml noaa gov phod floridacurrent index php one large gap during 1998 2000 and a few small gaps exist in the records meinen et al 2010 reviewed the historical fct observations suggesting that an accurate estimate of monthly mean fct requires at least 20 daily observations to get a continuous time series of monthly mean fct the transport in the months with less than 20 observations are derived from another fct dataset based on satellite altimetry goni et al 2017 2 2 5 the oleander project the oleander project has observed temperature and velocity via xbts and a ship mounted adcp along a transect between new jersey and bermuda the oleander line black dashed line in fig 1 regularly since 1992 flagg et al 1998 rossby et al 2014 rossby and gottlieb 1998 velocity data is available to 400 m prior to 2005 and to 800 m after that with a one year gap in 2008 the xbt observation only covers half of the oleander line from new jersey to the gs before 2009 in addition to in situ data the oleander project also provides estimates of the gs position along the oleander line and six month running mean transports across the oleander line 3 comparison between observations and models 3 1 florida current transport the climate mean of the fct is 32 1 0 2 sv meinen et al 2010 3 3 the 0 2 sv is the statistical standard error of the mean with annually averaged values varying between 29 0 sv and 34 6 sv sanchez franks 2015 the fct is a combination of transports from north atlantic subtropical gyre and the upper limb of atlantic meridional overturning circulation amoc if all upper limb amoc transport crossed 26 n via florida strait 17 2 sv transport of amoc at 26 n mccarthy et al 2015 of the fct is from amoc and the rest 14 9 sv is from the subtropical gyre by analyzing water properties schmitz and richardson 1991 find that the near surface temperature 24 c flow and near bottom temperature between 7 and 12 c flow across the florida strait are primarily amoc components originating from south atlantic while the waters found mid depth temperature between 12 and 24 c are mainly from the north atlantic subtropical gyre xu et al 2012 2016 find similar results in their numerical simulations szuts and meinen 2017 discuss the fate of the waters passing through the florida strait finding that the near bottom water the intermediate water on the west side and part of the intermediate water on the east side contribute to the amoc in contrast the near surface water and the remaining intermediate water on the east side return to the subtropical gyre the interannual variability of fct during 1982 1998 has been explained by wind stress curl near 27 n and the nao via a rossby wave mechanism however this mechanism fails to explain the variability of the fct outside of this period dinezio et al 2009 meinen et al 2010 even though the florida current marks the upstream end of the gs sanchez franks 2015 shows that fct is uncorrelated with gs transport across the oleander line fig 2 shows boxplots of annual mean fct during 1993 2010 from direct observations via underwater cables an observationally based dataset armor3d and numerical models in order of coarser resolution from left to right the means and standard deviations of the fct are also shown in table 2 which summarizes the results of this study all high resolution models horizontal resolution 0 25 have lower median and mean fct than the observations while some coarse resolution models obtain higher median and mean fct values however the interquartile range iqr and median absolute deviation mad of the fct is much larger in the numerical models 0 99 and 0 51 respectively than in observations 0 66 and 0 29 respectively the four models with mean fct closest to the observations are orap5 cfsr eccov4 and ecdav3 1 the four models with standard deviation of fct closest to the observations are hycom ofes glorys2v4 and ecco2 the annual mean fcts in most numerical models are significantly correlated to the observations at 95 level with a highest coefficient of 0 74 glorys2v4 while large spread exists between different seasons table 3 generally the numerical models perform better in summer jas and autumn ond than in winter jfm and spring amj only 1 0 of the 13 numerical models shows significant correlation with the observations at zero lag in winter spring while in summer autumn 6 9 models show significant correlations at 90 confidence level glorys2v4 is the only reanalysis product in which the fct is significantly correlated to the observations in all four seasons a similar seasonal pattern also exists in the observational dataset armor3d the seasonal dependence of correlation indicates that the mechanism driving fct variability may change with season 3 2 the gulf stream separation at cape hatteras after the florida straits the gs flows northward as a narrow stable current along the coast until cape hatteras where it turns eastward and separates from the coast this separation point is considered a key test of gs simulations as it is not reproduced well by many models hurlburt and hogan 2000 suggest that 1 32 horizontal resolution is required for the robust simulation of the separation in unconstrained models following gangopadhyay et al 1992 the separation latitude fig 3 used in this paper is defined as the latitude where gs crosses the 2000 m isobath 4 4 the details of gs path detection are introduced in section 3 4 1 the mean separation latitude during 1993 2010 is 34 25 n with a standard deviation of 0 15 this is 1 south of the separation latitude found by gangopadhyay et al 1992 however the gs path used in their research is detected via frontal analysis from satellite infrared images which is closer to the definition of gs north wall further discussed in section 3 4 2 since the gs north wall is always located north to the gs path the difference between the separation latitude derived in this paper and derived by gangopadhyay et al 1992 is probably a result of the different definitions of the gs path the observed separation latitude via aviso adt data is highly stable except for a slight northward movement during 1998 2000 and an extreme southward shift in 2010 fig 3 this extreme event event 2010 lasted about 3 months with minimum monthly latitude of 32 2 n in february 2010 which is 4 7σ south of its mean position the cause of this event is still unknown but it might be related to the sharp decrease in amoc transport and the extremely low nao event in the winter of 2009 2010 mccarthy et al 2012 bryden et al 2014 the djf mean nao index in 2010 was 1 67 which is the lowest value since 1950 only armor3d and 3 of the 13 numerical models hycom glorys2v4 and ur025 4 can reproduce this event with more than a 3σ southward shift from its mean latitude fig 4 shows the climate mean separation latitudes for each month with boxplots derived from aviso adt an annual cycle with a maximum latitude in september is clearly visible although most of the numerical models can reproduce a seasonal cycle with low separation latitude in winter and spring and high separation latitude in summer and autumn only a few of them can reproduce the sharp peak in september to evaluate the seasonal cycle in each numerical model root mean square error rmse is calculated for each dataset table 2 as r m s e 1 12 i 1 12 s l a t n o r m m o d e l i s l a t n o r m o b i 2 where s l a t n o r m o b i is the 1993 2010 mean observed separation latitude for month i and the subscript model indicates that the separation latitude is from a numerical model the separation latitudes were normalized before the calculation of rmse lower rmse indicates a seasonal cycle closer to the observed one the four numerical models with smallest rmse are hycom 0 11 glorys2v4 0 12 ur025 4 0 12 soda 3 3 1 0 12 cfsr 0 12 gecco2 0 09 and ecdav3 1 0 12 5 5 seven models are listed here because five of them share similar value of rmes 0 12 to evaluate the interannual variability of the numerical models boxplots of annual mean separation latitudes from observations and all datasets are shown in fig 5 the gs in godas and gecco2 does not separate from the coast at cape hatteras while in ecco2 eccov4 and ecdav3 1 the gs separates from the coast too early the four 1 resolution models eccov4 godas gecco2 and ecdav3 1 have the largest mean or median bias except eccov4 consistent with the common agreement that 1 horizontal resolution is not sufficient for proper simulation of gs separation chassignet and marshall 2008 as expected armor3d is correlated with observations at better than 95 confidence while the correlation coefficients from only 2 of the 13 numerical models hycom and glorys2v4 are also significant at 95 confidence level 3 3 oleander line the oleander line the black dashed line in fig 1 is a section between new jersey and bermuda with regular observations since 1992 using xbt and ship mounted adcp 6 6 data available at http www po gso uri edu rafos research ole index html flagg et al 1998 rossby et al 2014 it is nearly perpendicular to the mean gs path making the cross oleander line velocity a good approximation of the downstream velocity of the gs the long term continuous observations are very useful for comparison with the gs in numerical models note that the oleander line crosses the gs near a point where the latitudinal variability of the gs is minimal cornillon 1986 for a specific numerical model its capacity to simulate this variability minimum will likely affect their agreement with oleander observations 3 3 1 gs vertical and horizontal structure the structure of gs velocity across the oleander line is shown in a natural coordinate where maximum velocity is located at the origin figs 6 and 7 the 75 khz adcp data which can reach more than 800 m depth is available since 2005 only 46 cruises provide sufficient coverage to calculate the velocity distribution in the gs these cruises are seasonally biased with 31 of the cruises in may september during 2005 2010 to compensate for this seasonal bias only velocities from the corresponding months from aromr3d and numerical models are used in this section the observed gs is about 200 km wide distance between the first zero downstream velocity position north south to the gs path at 55 m depth at the oleander line in high resolution models the gs is about 250 300 km wide while it is much broader 300km in the coarse resolution models this is consistent with the extremely small downstream velocities in the coarse resolution models maximum velocity across the oleander line is less than 0 3 m s 1 and the correct order of net northward transport in the western boundary because the horizontal gs velocity structures in coarse resolution models are very unrealistic only the structures in high resolution models will be discussed further the observed downstream velocity shows significant horizontal asymmetry black lines in fig 6a d the velocity north of the gs path the negative distance region in fig 6 decreases much faster than to its south the positive distance region to further discuss the horizontal structure quantitatively kurtosis and skewness are employed by taking the downstream horizontal velocity as a probability distribution function negative velocity is ignored during this calculation the asymmetry of the horizontal velocity decreases with depth with a skewness that decreases from 0 88 at 55 m to 0 33 at 600 m the sharp decrease in the velocity to the north of the maximum likely results from the strong potential vorticity front near the north wall of the gs see section 4 the horizontal downstream velocity structure in both the observationally based armor3d and most of the numerical models are nearly symmetric figs 6 and 7 this is also shown by the average skewness of horizontal velocity structure at 55 m 200 m 400 m and 600 m depth table 2 the average skewness from observations is 0 58 while the largest skewness from numerical models is 0 20 orap5 and glorys2v4 besides the velocity decreases more slowly away from the peak in armor3d and the numerical models compared to observations above 600 m the kurtosis of the observed horizontal gs velocity structure 3 16 is larger than that in the numerical models no more than 2 83 that is the horizontal velocity distribution is compared to its tails in observations than in numerical models in observations the kurtosis of horizontal gs velocity decreases with depth the ratio of observed kurtosis at 600 m and 55 m is 0 75 this vertically decreasing pattern is well captured by orap5 the ratio in which is 0 77 the ratio is 0 89 in armor3d 0 83 in glorys2v4 and no less than 0 90 in the other high resolution models a southward shift of the maximum velocity axis of the gs with depth black line in fig 6e can be found in adcp observations ratsimandresy and pelegri 2005 attributed this to the horizontal temperature gradient and the thermal wind relation the gs axis shift with depth in most of high resolution models is near the observed shift figs 6e and 7e a slightly northward shift of the gs axis is observed below 800 m in the high resolution models except orap5 in which a northward shift occurs below 1000 m not shown however it is difficult to determine whether this is a real effect because this region is not covered by observations the gs axis has a near constant position at all depths in armor3d this is probably due to the synthetic analysis method used in armor3d see section 2 for more details surprisingly both the observationally based dataset armor3d and the numerical models including the eddy resolving models significantly underestimate the maximum downstream velocity across oleander line figs 6f and 7f the maximum downstream velocity is 1 91 m s 1 in the observations while it is only 1 10 m s 1 in armor3d 1 08 m s 1 in hycom 1 02 m s 1 in glorys2v4 and less than 1 m s 1 in the others this bias is not significantly smaller in the eddy resolving models hycom and ofes than in the eddy permitting models the underestimation of the peak velocity due to two factors first the numerical models underestimate the transport of the gs section 3 3 2 second the gs is broader in the numerical models than in observations so the already weak transport is spread over a larger cross sectional area to evaluate the temperature structure in the numerical models fig 8 shows the averaged 15 c isotherm in xbt observations observationally based dataset armor3d and numerical models along the oleander line during july 2009 december 2010 the 15 c isotherm is shown because its position at 200 m depth is used as the position of the gs north wall fuglister and voorhis 1965 joyce et al 2000 joyce et al 2009 a sharp shoaling of the 15 c isotherm can be found between 36 5 n and 38 n in the xbt observations black solid line southeast of the sharp slope the isotherm is horizontal for 1 35 5 n 36 5 n then gently shoals toward the southeast the position of the 15 c isotherm along the oleander line is consistent with observations in most of the constrained high resolution models except in orap5 in which the 15 c isotherm is several hundred meters below the observed one north of 37 n the large bias in orap5 is due to the overshooting of the gs after cape hatteras the isotherms in the two unconstrained products ofes and ecco2 at any specific time show a similar pattern as the observation a sharp slope near the gs axis not shown the near constant slope of the long term mean isotherm in the two models is a result of their gs paths having more variability than observed the slopes of isotherms in en4 armor3d and the numerical models are flatter with a shallower maximum depth than in the xbt observations the slope in hycom is closest to the observations and the slopes from armor3d glorys2v4 ur025 4 and soda 3 3 1 are closer to the xbt observations than that from en4 as with the down stream velocity along the oleander line the isotherms in all coarse resolution models are flatted compared to the observations to compare the slope and its position in different products quantitatively the horizontal absolute distance between the 15 c isotherms in the observationally based armor3d numerical models and in observations along the oleander line is calculated at 300 m 400 m and 500 m the distance averaged over the three layers is shown in table 2 the averaged distance indicates a combination bias of both the mean position and the slope of the isotherm in each dataset the 15 c isotherm in hycom is closest to the observation with only a 6 4 km bias the averaged distance for en4 is 62 6 km which is larger than most high resolution models and observationally based dataset armor3d 3 3 2 gulf stream transport across the oleander line transport across the oleander line consists of three parts the slope sea current part of the northern recirculation gyre the gs and the southern recirculation gyre in the sargasso sea rossby et al 2014 estimated gs transport across the oleander line by the velocity at 55 m which is just below the ekman layer based on previous observations they estimated that the gs transport integrated to 2000 m was 700 times the transport at 55 m to be consistent with the observed transports the transports across the oleander line in numerical models are also estimated from the velocity at a single layer at 55 m unit m3 s 1 m 1 or m2 s 1 thus the gs transport is the velocity at 55 m normal to the oleander line integrated between where the normal velocity first reaches zero from either side of the gs axis the slope sea transport is the normal velocity at 55 m integrated from the northern edge of the gs to continental shelf 39 31 n 72 57 w and the sargasso sea transport is the normal velocity at 55 m integrated from the southern edge of the gs to near bermuda 32 78 n 64 89 w the net transport is the sum of the transport in slope sea the gs and the sargasso sea note that both the slope sea current and the current in the sargasso sea are southwestward and a large part of the two southwestward currents will join the gs as a result the net transport across the oleander line is smaller than the gs transport transports from observationally based armor3d and numerical models are smoothed using a six month running mean to be consistent with how the observational transports from the oleander project are processed the transports from in situ observations armor3d and numerical models are shown in fig 9 the errors of the transports in armor3d and models are shown in fig 10 all numerical models evaluated in this paper underestimate the gs transport the slope sea transport and the sargasso sea transport across the oleander line fig 9 7 7 in fact the mean and median gs transports of the numerical models are smaller than more 75 of the observed transport values the slope sea current is missing in coarse resolution models and among all high resolution models only hycom and ur025 4 reproduce the slope sea transport with the correct order of magnitude the magnitude of sargasso sea transport is close to the observations in all high resolution models except ecco2 the biases of the net transport in the numerical models are much smaller than the gs transport which indicates that the gs transport bias in numerical models is mainly due to the underestimated transports of the two southwestward currents more specifically the error of the slope sea transport contributes more to the gs transport bias than the error of sargasso sea transport in most high resolution models in contrast the error of the sargasso sea transport contributes more to the gs transport bias than the error of slope sea transport in the coarse resolution models even though the slope sea current is missing in these models fig 10 similar results are shown by the time series of gs transports and net transports figs 11 and 12 generally the gs transports in the high resolution models are between the observed gs and net transports while both transports in the coarse resolution models are closer to the observed net transport the observed net transport is locally maximum around january 2005 while all numerical models as well as the observationally based armor3d show decreasing net transport at this time the reason for this discrepancy is unclear four of the thirteen numerical models are correlated to the observations in gs transport at 95 confidence level hycom 55 glorys2v4 59 gecco2 49 and ecdav3 1 40 hycom 41 0 glorys2v4 38 cfsr 36 and godas 36 are correlated to the observations in net transport across the oleander line at 95 confidence level note that cfsr s correlation is negative further glorys2v4 is more highly correlated with the oleander observations of both gs and net transport than the observationally based armor3d 3 3 3 gs position at oleander line the gs position at the oleander line is defined as the position of maximum downstream velocity at 55 m sanchez franks 2015 however some numerical models occasionally give two velocity maxima within a single monthly mean at the oleander line this may be due to switching of the path of gs within the month in such cases the peak closest to the gs path detected via aviso adt see section 3 4 1 is considered as the primary axis of the gs the annual mean gs latitude along the oleander line from in situ observations armor3d and other numerical models is shown in fig 13 the observed position does not have a trend the gs latitude is not significantly biased in the numerical models except in ofes unconstrained orap5 ecco2 unconstrained godas after 2005 and gecco2 after 2002 it is however more variable in the numerical models than in the observations the latitude fluctuations in 4 of the 13 models are significantly correlated with observations at the 95 level hycom 88 glorys2v4 68 ur025 4 72 and eccov4 67 the seasonal cycle of the gs position along the oleander line is not shown because it is weak in observations with a small southward shift in spring 3 4 gs path and its north wall 3 4 1 gs path the gs path is the maximum velocity axis of gs it is difficult to identify precisely and several different proxies are used in practice one such proxy is the adt contour of a specific value which is usually 0 25 m rossby et al 2014 andres 2016 the 0 5 m sea surface height anomaly is also used in some cases gangopadhyay et al 2016 however the ssh reported by the numerical models is not generally referenced to the same geoid used by observational datasets and so it is necessary to determine an appropriate ssh contour separately for each model in each model we choose the ssh contour that most frequency coincides with the location of maximum velocity at the 8 satellite altimeter tracks shown in fig 1 more precisely the chosen ssh contour is south or north of the velocity maximum at 50 of the space time points defined by the altimeter tracks when applied to the altimeter observations this method gives the 0 29 m adt contour as the gs path this adt value is sufficiently close to that used by rossby et al 2014 and andres 2016 that we consider the method to be validated in the following we therefore use the 0 29 meter adt contour to define the gs path in observations and similarly obtained ssh contours ranging from 0 19 m to 0 31 m to define the gs path in the numerical models the mean gs path from avisoadt during 1993 2010 is shown in fig 14 dashed black lines the mean path of the gs is flat west of 65 w with a few small undulations appearing to the east in all constrained high resolution models except orap5 the mean gs path between 75 w and 50 w is close to the observed path fig 14a and b the gs path from orap5 overshoots northward after cape hatteras between 74 w and 70 w which indicates that orap5 does not reproduce the separation from the coast adequately considering orap5 c glorsv5 and ur025 4 are all based on nemo use the same horizontal grid similar forcing and assimilation methods the overshooting problem in orap5 is probably not due to its grid resolution or assimilation method both orap5 and c glorsv5 have slope sea transports which are in the opposite direction as observed fig 9 which could contribute to the gs overshoot zhang and vallis 2007 however the overshoot in c glorsv5 is much smaller than in orap5 even though its slope sea transport is more in error than orap5 a possible source of the overshooting gs path in orap5 is its sub grid scale parameterization methods the unrealistically large undulations throughout the gs path in orap5 indicates errors in the potential vorticity pv balance of the gs which is sensitive to the details of the sub grid scale parameterization in the two unconstrained models ofes and ecco2 the gs paths depart from the observed path at most longitudes the gs paths in all coarse resolution models fig 14c are biased between 75 w and 70 w and show fewer undulations east of 70 w the bias between 75 w and 70 w may due to the unrealistic topography in the coarse resolution models in order to quantify model bias in the gs path we calculated the absolute error area for the gs path aea gs which is the area between monthly snapshots of the gs path in numerical models and aviso adt from 73 w to 55 w an exampe of the aea gs calcultion is shown in fig 15 the mean length of the gs path between 73 w and 55 w is about 2140 km so a 47 km meridional bias of the gs path results in 10 1010 m2 aea gs since the ssh in armor3d is based on satellite observations its mean aea gs value provides an estimate of errors due to interpolation hycom has the minimum mean aea gs among the numerical models fig 16 on average the gs path in hycom is biased by about 0 25 glorys2v4 and ur025 4 show the second and third minimum mean aea gs not surprisingly the two unconstrained models ofes and ecco2 show the largest mean aea gs the mean aea gs from all the other models are in a range from a little below 1 1011 m2 eccov4 to 1 75 1011 m2 gecco2 the aea gss in coarse resolution models are comparable to that in some of the high resolution models note that the aea gs is an estimate of the gs path bias between 73 w and 55 w and does not reflect the error in separation latitude that is a smaller aea gs does not necessarily imply a more accurate gs separation position at cape hatteras 3 4 2 north wall position the northern edge of the gs is referred as the north wall for its strong horizontal temperature gradient persisting to great depth it is occasionally visible in low level atmospheric features due to strong local air sea interaction sweet et al 1981 young and sikora 2003 the meridional position of the north wall has proven to be important not only in local climate joyce et al 2009 kwon and joyce 2013 taylor 1996 but also in marine biology nye et al 2011 saba et al 2015 a number of operational definitions for the position of the north wall have been proposed the most common being 1 the 15 c isotherm at 200 m joyce et al 2000 joyce et al 2009 2 the 12 c isotherm at 400 m bryan et al 2007 3 the location of sst front by ir satellite taylor and stephens 1998 and 4 the location of temperature 2 c lower than the maximum temperature in the current rossby and gottlieb 1998 we use the 15 c isotherm at 200 m to identify the north wall position in this paper as the location of the 15 c is readily obtained from hydrographic measurements going back several decades we regard the 15 c isotherm at 200 m from en4 dashed orange line in fig 1 to be the observed north wall position the biases of the mean north wall position fig 17 from numerical models are similar to their biases of the mean gs path fig 14 the topography changes dramatically near cape hatteras fig 1 from more than 3000 m southeast of the north wall position to less than 100 m northwest of the north wall at 75 w 36 n due to its coarse resolution en4 fails to recognize this sharp topography change the north wall path from en4 at 75 w which is derived from 15 c isotherm at 200 m is located at a position shallower than 200 m this is why the north wall in most high resolution models is south to its position in en4 at 75 w the discrepancy of the north wall position close to its west end among coarse resolution models is also partly due to their poor resolution of topography the overall bias of the north wall position in each model is estimated by the area between monthly snapshots of the gs north wall position derived from the model and en4 from 73 w to 55 w or absolute error area for north wall position aea nw the mean aea nw during 1993 2010 in each dataset is shown in fig 18 eccov4 with 1 horizontal resolution has the smallest aea nw which is smaller than the bias in the observationally based dataset armor3d the aea nw in hycom c glorsv5 glorys2v4 ur025 4 and ecdav3 1 are slightly larger than that in armor3d note that smaller error in eccov4 may partly be due to the horizontal resolution of the reference dataset en4 which is the same as in eccov4 several different indices have been introduced to describe the meridional position of the north wall as a whole one which is well suited to model data comparison is the gulf stream index gsi introduced by joyce et al 2000 and joyce et al 2009 it is defined as the first principal component of 200 m temperature at nine points along the mean north wall position shown in fig 1 the loading pattern of the first eof is positive at all the nine points joyce et al 2009 so positive negative values of its principal component indicate a coherent northward southward shift of the north wall the original gsi is derived from sparse in situ temperature profiles from the world ocean database wod joyce et al 2009 first interpolated 200 m temperature into 1 x 1 grids in the middle of each season where the temperature at each grid is the weighted average of all available temperature within 1 year in time 1 in latitude and 2 in longitude a gaussian taper is applied during the interpolation with e 2 folding scale of 0 5 year in time 1 in latitude and 2 in longitude finally temperature at the nine selected points are interpolated from the gridded temperature for the comparison in this paper we calculated a modified gsi gsi e8 with two major differences from the gsi introduced by joyce et al 2009 first only the eastern 8 of the 9 locations are used since the actual water depth at the west most point used by joyce et al 2009 is less than 200 m second the temperature at the eight points are interpolated from the seasonal mean temperature provided by en4 no gaussian taper is applied detrended and normalized annual mean gsi and gsi e8 are shown in fig 19 the annual mean gsi e8 follows gsi well with a correlation coefficient of 79 6 at 99 confidence level the pc of eof depends sensitively on the analysis period of data and only 18 years of data 1993 2010 can be obtained from the numerical models which is much shorter than the interval used to calculate the gsi e8 1954 2012 hence to keep the reconstructed gsi e8 rgsi e8 derived from armor3d and numerical models consistent with the gsi e8 derived from en4 rgsi e8 is derived via a fixed loading pattern which is the loading pattern of first eof mode during the calculation of gsi e8 from en4 annual mean rgsi e8 detrended and normalized is shown in fig 20 the correlation coefficients between annual rgsi e8 and gsi e8 are significant at 95 confidence level in 9 of the 13 numerical models hycom 79 c glorsv5 83 glorys2v4 64 ur025 4 80 soda 3 3 1 66 cfsr 79 godas 81 eccov4 65 ecdav3 1 62 and the observationally dataset armor3d 87 4 discussion 4 1 the cross stream gs structure the skewness and kurtosis of the observed gs can be explained by noting that the gs is a pv as well as a temperature front separating the high pv waters of the slope sea to the north from the low pv waters of the sargasso sea to the south the pv increases rapidly as the core of the gs is crossed to the north either at constant depth or while following a surface of constant density todd et al 2016 a simple model of the gs can be formulated as an ideal pv front using the reduced gravity equations we idealize the gs as a thin jet and following cushman roisin et al 1993 make use of the reduced gravity equations on an f plane for the present case it is only necessary to consider a single moving surface layer the pv in the moving layer is given by 1 q u y f h where u is the downstream velocity y is the cross stream distance h is the thickness of the moving layer and subscripts indicate partial differentiation we take y 0 as the location of the pv front for an ideal front the pv distribution is 2 q y q s y 0 q n y 0 with q n qs since the zonal velocity vanishes far from the front the two values of the pv are q s f h s and q n f h n where h s and h n are interpreted as the depths of the thermocline far to the south and north respectively of the gs 8 8 the downstream direction is inclined with respect to due east at the oleander line so north and south in this context are more precisely northwest and southeast eqs 1 and 2 provide a relationship between the layer thickness velocity and the conditions far from the front the system is closed by the geostrophic relation 3 u g f h y where g is the reduced gravity inserting 3 into 1 and 2 gives a differential equation in h 4 h y y f q y g h f 2 g the solution to 4 for the ideal pv distribution 2 gives this downstream velocity profile 5 u f l s l n e y l s y 0 e y l n y 0 where l s n g h s n f are the rossby deformation radii on the south and north side of the gs an important feature of the solution 4 is its asymmetry about the origin the velocity decays away from the core of the gs more slowly to the south than to the north because the rossby radius is larger on the southern side of the gs than on the northern side the velocity profile 4 is compared to the oleander velocity observations at 55 m in fig 21 the only adjustable parameters in 4 are the two rossby radii these were determined by a least square fit to the oleander observations over the range where the observed velocity is positive the optimal radii l s 46 km and l n 22 km are broadly consistent with the observed rossby radii in the sargasso and slope seas e g chelton et al 1998 the rms error in the fit is 8 remarkably small for such a simple model the observed velocity profile is smoother than the ideal front velocity profile and the velocity profiles obtained from the numerical models are smoother still any amount of turbulence or numerical dissipation will erode a sharp front like that given in 2 resulting in a smoother pv distribution and as a result a smoother velocity profile a crude model of diffusive spreading of the pv front can be constructed by imagining that the ideal front 2 is representative of the gs structure immediately after separation at cape hatteras thereafter the pv front is advected downstream and diffused laterally in steady state the pv budget is 6 u q x k e q y y where x is the downstream coordinate ke is an eddy diffusivity of pv and u is the mean downstream velocity which for simplicity we consider to be independent of the cross and downstream coordinates the solution to 6 with upstream conditions 2 is 7 q f 2 1 h n 1 h s f 2 1 h n 1 h s erf y 2 d where d 2 k e x u and x is the downstream distance from cape hatteras to the oleander line about 600 km note that the pv distribution 7 is the same as that obtained by convolving the ideal front distribution 2 with a gaussian with standard deviation d the equation for the moving layer thickness 4 is challenging to solve analytically with the pv distribution 7 but it is readily solved numerically by finite differences the solutions presented here were obtained by discretizing 7 on a domain of width 10l s with a grid spacing of 0 001l s as with the ideal front model the rossby radii and smoothing width are found by a least squares fit to the oleander observations the best fit shown in fig 21 has rossby radii l s 43 km and l n 17 km and a smoothing width of d 10 km note that the maximum velocity obtained from the smoothed front model is displaced toward the low pv side i e the south side the profile in fig 21 has been shifted horizontally so the maximum velocity is again found at y 0 the optimal rossby radii are not significantly different from the ideal front model if we use 600 km and 1 m s 1 for the distance to cape hatteras and the advecting velocity respectively d 10 km corresponds to a cross stream eddy diffusivity for pv of ke 166 m2 s 1 the smoothed front model fits the observations slightly better than better than the ideal front model with an rms error of 5 the smoothed front model is fit to the remaining observational and high resolution products the pv front is too diffuse in the coarse resolution models to reliably estimate the required fitting parameters the fit to the hycom velocity profile is shown in fig 21 the best fit rossby radii are similar to those obtained from the oleander observations l s 38 km and l n 11 km but the smoothing width is significantly larger at d 58 km the equivalent cross front diffusivity is ke 5500 m2 s 1 about thirty three times larger than that inferred from observations the pv front in the hycom product is therefore significantly broader and smoother than that found from observations this indicates that the subgrid scale parameterizations of dissipation used by hycom are unrealistically efficient at mixing pv across the gs the core of which has been found to be a barrier to mixing by numerous studies e g bower et al 1985 bower and rossby 1989 bower 1991 samelson 1992 bower and lozier 1994 lozier et al 1997 the implication is that even at 1 12 resolution hycom s dynamics are simply too diffuse to properly represent the sharpness of the gs pv front data assimilation cannot force the model to maintain a pv front which is sharper than its dynamics allow although it may prevent the front from spreading beyond this fundamental limit the results obtained from fitting the smoothed front model to the other high resolution products and armor3d are summarized in fig 22 the misfit is always less than 11 and the rossby radii are all within a physically reasonable range though with some variation with the exception of the oleander observations the smoothing widths are all about 1 1 5 times the southern rossby radius and the implied pv diffusivities are nearly two orders of magnitude larger than that inferred from the observed velocity profile armor3d is a gridded but observationally based data set and therefore does not have the pv mixing dynamics of the numerical models in this case the smoothing kernels inherent in the optimal interpolation procedure play a role similar to pv mixing the inferred pv diffusivity could thus be thought of as an effective diffusivity induced by the interpolation when the smoothing width exceeds the rossby radii on the northern and southern flanks of the gs the scale of the velocity s decay from its maximum value is dominated by the smoothing scale the velocity profiles obtained from the gridded dataset and numerical products are thus broader and more symmetric than the observed velocity profile for a given transport the peak gs velocity must decrease as the gs becomes broader as all of the numerical products have excessively broad gss they all underestimate the maximum gs velocity products which also significantly underestimate the gs transport have even smaller peak velocities 4 2 overall performance of the numerical models the performance of each dataset discussed in section 3 is summarized in table 2 to show the overall performance of each dataset more clearly the models closest to observations in each aspect is marked in bold and the four models closest to the observations are marked by shaded backgrounds in the table two of the models hycom and glorys2v4 are among the best for nearly all aspects hycom is among the top 4 models in 21 of the 25 listed aspects in table 2 and glorys2v4 is among the top 4 numerical models in 20 of the 25 aspects generally high resolution models perform better than coarse resolution models the noteworthy performance of hycom might be expected since it is the highest resolution constrained product discussed in this paper however it is not a priori clear that assimilation of sparse observational data should lead to similar improvements an eddy resolving model as seen in more coarsely resolved models in the case of hycom it appears that data assimilation continues to yield dividends at high resolution in contrast the superiority of glorys2v4 over orap5 c glorysv5 and ur025 4 is surprising because all the four constrained models are based on nemo sharing same horizontal gird and similar forcing one possible reason is that glorys2v4 is constrained via a reduced order kalman filter method 9 9 the 3dvar method is also applied to correct the large scale temperature and salinity distribution in glorys2v4 when enough observations are available garric and parent 2017 while orap5 c glorysv5 and ur025 4 are constrained via 3dvar method the kalman filter method has been shown to give better performance than 3dvar in many cases miyoshi 2005 whitaker et al 2008 yang et al 2009 5 summary an observationally based 3d ocean dataset armor3d and thirteen numerical models including eleven ocean reanalysis products hycom orap5 c glorsv5 glorys2v4 ur025 4 soda 3 3 1 cfsr eccov4 godas gecco2 ecdav3 1 and two unconstrained ocean simulations ofes ecco2 are compared with in situ analyzed and remote observations the intercomparison is focused on the gulf stream from the florida straits to south of the grand banks and considers the florida current transport the separation of gulf stream at cape hatteras gulf stream transport position and structure along the oleander line gulf stream path and the north wall of the gulf stream the variations between products in the cross stream structure of the gs is explained using a simple model of the gs as a smoothed pv front broader pv fronts lead to broader and more symmetric velocity profiles as well as lower peak velocities it is suggested that the failure of the numerical models to reproduce the observed peak gs velocity is due to overly aggressive sub grid scale dissipation which erodes the gs pv front among the 13 numerical models the gs in two of them hycom and glorys2v4 is closest to the observations hycom s primary advantage is likely its high resolution 1 12 the good performance of glorys2v4 may be due to its assimilation method kalman filter even though reanalysis products are expected to improve numerical simulations and provide near observation results they do not have to be so we show in this paper that in fact most available reanalysis products fail to adequate represent some of the most basic features of the gulf stream excluding the two free run simulations ofes and ecco2 less than half of the 11 constrained products are significantly 95 level correlated with the observations in the gulf stream separation latitude the gulf stream and the net transport along the oleander line in some of the models the 11 year mean values may also be largely biased such as the gulf stream transport across the oleander line in addition some common errors exist in the numerical models discussed in the paper none of the models can reproduce the correct horizontal structure and maximum value of the velocity along the oleander line there is thus much work to be done before ocean reanalyses can be regarded as approximations to reality with the same confidence commonly attached to atmospheric reanalyses acknowledgment this work was supported by the national science foundation oce 1634829 the authors thank terrence m joyce for providing gsi data and two anonymous reviewers for providing comments which improved the manuscript 
24111,in recent years significant progress has been made in the development of high resolution ocean reanalysis products this paper compares aspects of the gulf stream gs from the florida straits to south of the grand banks particularly florida strait transport separation of the gs near cape hatteras gs properties along the oleander line from new jersey to bermuda gs path and the gs north wall positions in 13 widely used global reanalysis products of various resolutions including two unconstrained products a large spread across reanalysis products is found hycom and glorys2v4 stand out for their superior performance by most metrics some common biases are found in all discussed models for example the velocity structure of the gs near the oleander line is too symmetrical and the maximum velocity is too weak compared with observations less than half of the reanalysis products show significant correlations at the 95 confidence level with observations for the gs separation latitude at cape hatteras the gs transport and net transport across oleander line the cross stream velocity structure is further discussed by a theoretical model idealizing gs as a smoothed pv front keywords north atlantic ocean gulf stream ocean reanalysis intercomparison 1 introduction a complete quantification of ocean variables through their horizontal and vertical extents is needed to initialize and validate ocean circulation models and the oceanic component of climate models errors in specifying the state of the ocean are therefore a major source of uncertainty in climate modeling at this time numerical modeling of the global ocean has seen significant progress in recent years large errors do however remain many of these errors can be attributed to inadequate grid resolution poor parametrization of key processes errors in initialization and propagation of numerical errors in an effort to circumvent these shortcomings reanalysis products have been developed in which the models are constrained to be consistent with available observations using data assimilation procedures reanalysis products are expected to provide more accurate information than unconstrained numerical models with the caveat that significant errors are likely to remain because of inadequate coverage of the ocean by observation networks balmaseda et al 2015 toyoda et al 2017 in addition inconsistencies among different reanalyses also exist due to differences in resolutions model physics and data assimilation methods reanalysis intercomparisons are well established in the atmospheric science community but have only recently become common in oceanography for example balmaseda et al 2015 presented an ocean reanalysis intercomparison focused on global features of the ocean such as heat content sea level steric height surface heat fluxes mixed layer depth salinity depth of 20 c isotherm and sea ice for the period 1993 2010 the authors compared several reanalyses with different resolutions atmospheric fluxes or assimilation methods and found several areas of large uncertainty differences among models and systematic biases with respect to observations pointing to the need for continuous model improvement through the comparison of several long term reanalysis products stammer et al 2010 found an increasing tendency of the spread across these products toward present they suggested the convergence of different products in early years might be determined by boundary forcing and initial conditions while the large discrepancies close to the end of the estimation period are due to the different assimilation approaches lee et al 2009 reviewed existing reanalysis products and their application to meridional overturning circulation pointing out the challenges in robustly estimating the uncertainties of models and observations stammer et al 2016 reviewed applications of the ocean data assimilation in climate research pointing out the necessity of fully coupled earth system models for climate forecasts the reader is referred to the special issue on reanalysis intercomparisons in volume 49 issue 3 of climate dynamics for a more comprehensive overview of the current state of ocean reanalysis intercomparisons the intercomparison presented in this paper is narrower in scope than the previous efforts with a focus on the gulf stream gs from the florida straits to south of the grand banks the gs is not only the western boundary current of the north atlantic subtropical gyre but also a branch of the atlantic meridional overturning circulation amoc as such the gs has a major influence on the dynamics and climate of the north atlantic as well as the climates of eastern north america and europe kelly et al 2010 kwon et al 2010 palter 2015 a practical motivation for the present intercomparison is to provide an evaluation of reanalysis products for those involved in gs research furthermore the goal of ocean modeling and reanalysis in particular is to produce a model of reality the underlying hope is that these models will eventually converge on the same result in which case we can say that we ve learned something about the physical system the fact that reanalyses often disagree with observations and each other tells us that we have some distance to go before realizing this goal therefore a detailed validation of reanalysis products is valuable in its own right the gs is one of the most densely observed oceanic features in the world one expects these observations should place a particularly heavy constraint on reanalysis products compared to more sparsely observed parts of the ocean and that this would tend to minimize inter model differences in this sense the gs represents perhaps the most favorable setting in which to assess the skill of the reanalysis products if they fail to adequately represent this observation dense region of the ocean there is little reason to expect that they will provide useful results in data poor regions such as the southern ocean several previous works have compared the gs in numerical models but with different focus than this paper hurlburt and hogan 2000 and chassignet and xu 2017 evaluated the gs in a series of numerical models with horizontal resolution varying from 1 10 to 1 50 concluding that the gs simulation benefits from higher resolution specifically a significant improvement of the gs simulation is found once the resolution is sufficiently fine to resolve submesoscales 1 50 chassignet and xu 2017 hurlburt et al 2011 investigated the multi year mean gs path and its separation near the cape hatteras in several eddy resolving numerical models and found a very positive impact on the gs path simulation from data assimilation in this paper we evaluate the mean state and variability of several gs features in the reanalysis products and observational data listed in section 2 specifically the following aspects will be discussed in section 3 the florida current transport fct the separation of gs from the coast at cape hatteras the gs transport and structure along the oleander line a transect from new jersey to bermuda and the positions of the gs path and the gs north wall in section 4 a simple theoretical model is employed to explain the cross stream structure of the gulf stream and the overall performance of the numerical products is discussed finally the paper is summarized in section 5 2 datasets 2 1 reanalyses table 1 lists the reanalysis datasets used in this study all of these products are based on one of four ocean general circulation models ogcms a mit general circulation model mitgcm marshall et al 1997 b hybrid coordinate ocean model hycom bleck 2002 c modular ocean model mom pacanowski and griffies 2000 griffies et al 2004 d nucleus for european modelling of the ocean nemo madec 2008 the products based on nemo use the louvain la neuve sea ice model lim and those based on mom4 and mom5 use the sea ice simulator sis to simulate sea ice products based on hycom and the mitgcm use those ogcm s built in sea ice models while ofes and godas are run without sea ice further ofes and ecco2 are unconstrained that is they are run without assimilated data they are included in this research as examples of free run results the reanalysis products can be divided into three groups based on their horizontal resolution a eddy resolving with resolutions of 0 1 or finer hycom and ofes b eddy permitting with resolutions of 0 25 orap5 c glorsv5 glorys2v4 ur025 4 soda3 3 1 and ecco2 c and coarse resolution with resolutions of 0 5 or coarser cfsr eccov4r2 godas gecco2 and ecdav3 1 the eddy resolving and eddy permitting products will be considered as high resolution numerical products in this paper an overlapping period of all reanalysis products 1993 2010 is used in all following analysis unless otherwise noted the numerical products are always listed in order of their resolution from high resolution to low resolution 2 2 observations the observationally based datasets used to verify the numerical models are described in this section 2 2 1 en4 version 1 1 en4 version 1 1 is a 1 gridded temperature and salinity dataset based on objective analysis of observations since 1900 it is produced by the uk met office hadley centre good et al 2013 and widely used in oceanic and climate research armour et al 2016 dieng et al 2015 häkkinen et al 2015 in this paper it is considered as the reference or true temperature when in situ observations are unavailable 2 2 2 absolute dynamic topography adt absolute dynamic topography adt is the sea surface height ssh with respect to the geoid the filtered along track adt product version 5 0 and the all satellite merged 0 25 gridded adt product version 5 0 are used to detect the gs path both of them are distributed by aviso 1 1 the altimeter products were produced by ssalto duacs and distributed by aviso with support from cnes http www aviso altimetry fr duacs and the gridded adt product is referred as aviso adt in this paper 2 2 3 armor3d v3 1 armor3d v3 1 consists of monthly mean gridded temperature salinity ssh and horizontal velocity reconstructed from observations at 0 25 resolution in the upper 1500 m the temperature below sea surface is based on synthetic analyses and optimal interpolation first a synthetic temperature anomaly field is derived from sea level anomaly sla and sea surface temperature sst via multiple linear regression then the final temperature field is generated by combining the synthetic results temperature anomaly plus climate mean temperature and in situ observations though optimal interpolation guinehut et al 2012 the ssh and horizontal velocity data computed from the thermal wind equation is borrowed from its companion dataset surcouf3d mulet et al 2012 please note that armor3d is a gridded product derived from observations it is included to complement the en4 data set and provide an estimate of observational errors 2 2 4 the florida current transport fct the florida current transport fct is well observed via underwater cables and cable calibration cruises since 1982 daily fct data is available from the project website 2 2 http www aoml noaa gov phod floridacurrent index php one large gap during 1998 2000 and a few small gaps exist in the records meinen et al 2010 reviewed the historical fct observations suggesting that an accurate estimate of monthly mean fct requires at least 20 daily observations to get a continuous time series of monthly mean fct the transport in the months with less than 20 observations are derived from another fct dataset based on satellite altimetry goni et al 2017 2 2 5 the oleander project the oleander project has observed temperature and velocity via xbts and a ship mounted adcp along a transect between new jersey and bermuda the oleander line black dashed line in fig 1 regularly since 1992 flagg et al 1998 rossby et al 2014 rossby and gottlieb 1998 velocity data is available to 400 m prior to 2005 and to 800 m after that with a one year gap in 2008 the xbt observation only covers half of the oleander line from new jersey to the gs before 2009 in addition to in situ data the oleander project also provides estimates of the gs position along the oleander line and six month running mean transports across the oleander line 3 comparison between observations and models 3 1 florida current transport the climate mean of the fct is 32 1 0 2 sv meinen et al 2010 3 3 the 0 2 sv is the statistical standard error of the mean with annually averaged values varying between 29 0 sv and 34 6 sv sanchez franks 2015 the fct is a combination of transports from north atlantic subtropical gyre and the upper limb of atlantic meridional overturning circulation amoc if all upper limb amoc transport crossed 26 n via florida strait 17 2 sv transport of amoc at 26 n mccarthy et al 2015 of the fct is from amoc and the rest 14 9 sv is from the subtropical gyre by analyzing water properties schmitz and richardson 1991 find that the near surface temperature 24 c flow and near bottom temperature between 7 and 12 c flow across the florida strait are primarily amoc components originating from south atlantic while the waters found mid depth temperature between 12 and 24 c are mainly from the north atlantic subtropical gyre xu et al 2012 2016 find similar results in their numerical simulations szuts and meinen 2017 discuss the fate of the waters passing through the florida strait finding that the near bottom water the intermediate water on the west side and part of the intermediate water on the east side contribute to the amoc in contrast the near surface water and the remaining intermediate water on the east side return to the subtropical gyre the interannual variability of fct during 1982 1998 has been explained by wind stress curl near 27 n and the nao via a rossby wave mechanism however this mechanism fails to explain the variability of the fct outside of this period dinezio et al 2009 meinen et al 2010 even though the florida current marks the upstream end of the gs sanchez franks 2015 shows that fct is uncorrelated with gs transport across the oleander line fig 2 shows boxplots of annual mean fct during 1993 2010 from direct observations via underwater cables an observationally based dataset armor3d and numerical models in order of coarser resolution from left to right the means and standard deviations of the fct are also shown in table 2 which summarizes the results of this study all high resolution models horizontal resolution 0 25 have lower median and mean fct than the observations while some coarse resolution models obtain higher median and mean fct values however the interquartile range iqr and median absolute deviation mad of the fct is much larger in the numerical models 0 99 and 0 51 respectively than in observations 0 66 and 0 29 respectively the four models with mean fct closest to the observations are orap5 cfsr eccov4 and ecdav3 1 the four models with standard deviation of fct closest to the observations are hycom ofes glorys2v4 and ecco2 the annual mean fcts in most numerical models are significantly correlated to the observations at 95 level with a highest coefficient of 0 74 glorys2v4 while large spread exists between different seasons table 3 generally the numerical models perform better in summer jas and autumn ond than in winter jfm and spring amj only 1 0 of the 13 numerical models shows significant correlation with the observations at zero lag in winter spring while in summer autumn 6 9 models show significant correlations at 90 confidence level glorys2v4 is the only reanalysis product in which the fct is significantly correlated to the observations in all four seasons a similar seasonal pattern also exists in the observational dataset armor3d the seasonal dependence of correlation indicates that the mechanism driving fct variability may change with season 3 2 the gulf stream separation at cape hatteras after the florida straits the gs flows northward as a narrow stable current along the coast until cape hatteras where it turns eastward and separates from the coast this separation point is considered a key test of gs simulations as it is not reproduced well by many models hurlburt and hogan 2000 suggest that 1 32 horizontal resolution is required for the robust simulation of the separation in unconstrained models following gangopadhyay et al 1992 the separation latitude fig 3 used in this paper is defined as the latitude where gs crosses the 2000 m isobath 4 4 the details of gs path detection are introduced in section 3 4 1 the mean separation latitude during 1993 2010 is 34 25 n with a standard deviation of 0 15 this is 1 south of the separation latitude found by gangopadhyay et al 1992 however the gs path used in their research is detected via frontal analysis from satellite infrared images which is closer to the definition of gs north wall further discussed in section 3 4 2 since the gs north wall is always located north to the gs path the difference between the separation latitude derived in this paper and derived by gangopadhyay et al 1992 is probably a result of the different definitions of the gs path the observed separation latitude via aviso adt data is highly stable except for a slight northward movement during 1998 2000 and an extreme southward shift in 2010 fig 3 this extreme event event 2010 lasted about 3 months with minimum monthly latitude of 32 2 n in february 2010 which is 4 7σ south of its mean position the cause of this event is still unknown but it might be related to the sharp decrease in amoc transport and the extremely low nao event in the winter of 2009 2010 mccarthy et al 2012 bryden et al 2014 the djf mean nao index in 2010 was 1 67 which is the lowest value since 1950 only armor3d and 3 of the 13 numerical models hycom glorys2v4 and ur025 4 can reproduce this event with more than a 3σ southward shift from its mean latitude fig 4 shows the climate mean separation latitudes for each month with boxplots derived from aviso adt an annual cycle with a maximum latitude in september is clearly visible although most of the numerical models can reproduce a seasonal cycle with low separation latitude in winter and spring and high separation latitude in summer and autumn only a few of them can reproduce the sharp peak in september to evaluate the seasonal cycle in each numerical model root mean square error rmse is calculated for each dataset table 2 as r m s e 1 12 i 1 12 s l a t n o r m m o d e l i s l a t n o r m o b i 2 where s l a t n o r m o b i is the 1993 2010 mean observed separation latitude for month i and the subscript model indicates that the separation latitude is from a numerical model the separation latitudes were normalized before the calculation of rmse lower rmse indicates a seasonal cycle closer to the observed one the four numerical models with smallest rmse are hycom 0 11 glorys2v4 0 12 ur025 4 0 12 soda 3 3 1 0 12 cfsr 0 12 gecco2 0 09 and ecdav3 1 0 12 5 5 seven models are listed here because five of them share similar value of rmes 0 12 to evaluate the interannual variability of the numerical models boxplots of annual mean separation latitudes from observations and all datasets are shown in fig 5 the gs in godas and gecco2 does not separate from the coast at cape hatteras while in ecco2 eccov4 and ecdav3 1 the gs separates from the coast too early the four 1 resolution models eccov4 godas gecco2 and ecdav3 1 have the largest mean or median bias except eccov4 consistent with the common agreement that 1 horizontal resolution is not sufficient for proper simulation of gs separation chassignet and marshall 2008 as expected armor3d is correlated with observations at better than 95 confidence while the correlation coefficients from only 2 of the 13 numerical models hycom and glorys2v4 are also significant at 95 confidence level 3 3 oleander line the oleander line the black dashed line in fig 1 is a section between new jersey and bermuda with regular observations since 1992 using xbt and ship mounted adcp 6 6 data available at http www po gso uri edu rafos research ole index html flagg et al 1998 rossby et al 2014 it is nearly perpendicular to the mean gs path making the cross oleander line velocity a good approximation of the downstream velocity of the gs the long term continuous observations are very useful for comparison with the gs in numerical models note that the oleander line crosses the gs near a point where the latitudinal variability of the gs is minimal cornillon 1986 for a specific numerical model its capacity to simulate this variability minimum will likely affect their agreement with oleander observations 3 3 1 gs vertical and horizontal structure the structure of gs velocity across the oleander line is shown in a natural coordinate where maximum velocity is located at the origin figs 6 and 7 the 75 khz adcp data which can reach more than 800 m depth is available since 2005 only 46 cruises provide sufficient coverage to calculate the velocity distribution in the gs these cruises are seasonally biased with 31 of the cruises in may september during 2005 2010 to compensate for this seasonal bias only velocities from the corresponding months from aromr3d and numerical models are used in this section the observed gs is about 200 km wide distance between the first zero downstream velocity position north south to the gs path at 55 m depth at the oleander line in high resolution models the gs is about 250 300 km wide while it is much broader 300km in the coarse resolution models this is consistent with the extremely small downstream velocities in the coarse resolution models maximum velocity across the oleander line is less than 0 3 m s 1 and the correct order of net northward transport in the western boundary because the horizontal gs velocity structures in coarse resolution models are very unrealistic only the structures in high resolution models will be discussed further the observed downstream velocity shows significant horizontal asymmetry black lines in fig 6a d the velocity north of the gs path the negative distance region in fig 6 decreases much faster than to its south the positive distance region to further discuss the horizontal structure quantitatively kurtosis and skewness are employed by taking the downstream horizontal velocity as a probability distribution function negative velocity is ignored during this calculation the asymmetry of the horizontal velocity decreases with depth with a skewness that decreases from 0 88 at 55 m to 0 33 at 600 m the sharp decrease in the velocity to the north of the maximum likely results from the strong potential vorticity front near the north wall of the gs see section 4 the horizontal downstream velocity structure in both the observationally based armor3d and most of the numerical models are nearly symmetric figs 6 and 7 this is also shown by the average skewness of horizontal velocity structure at 55 m 200 m 400 m and 600 m depth table 2 the average skewness from observations is 0 58 while the largest skewness from numerical models is 0 20 orap5 and glorys2v4 besides the velocity decreases more slowly away from the peak in armor3d and the numerical models compared to observations above 600 m the kurtosis of the observed horizontal gs velocity structure 3 16 is larger than that in the numerical models no more than 2 83 that is the horizontal velocity distribution is compared to its tails in observations than in numerical models in observations the kurtosis of horizontal gs velocity decreases with depth the ratio of observed kurtosis at 600 m and 55 m is 0 75 this vertically decreasing pattern is well captured by orap5 the ratio in which is 0 77 the ratio is 0 89 in armor3d 0 83 in glorys2v4 and no less than 0 90 in the other high resolution models a southward shift of the maximum velocity axis of the gs with depth black line in fig 6e can be found in adcp observations ratsimandresy and pelegri 2005 attributed this to the horizontal temperature gradient and the thermal wind relation the gs axis shift with depth in most of high resolution models is near the observed shift figs 6e and 7e a slightly northward shift of the gs axis is observed below 800 m in the high resolution models except orap5 in which a northward shift occurs below 1000 m not shown however it is difficult to determine whether this is a real effect because this region is not covered by observations the gs axis has a near constant position at all depths in armor3d this is probably due to the synthetic analysis method used in armor3d see section 2 for more details surprisingly both the observationally based dataset armor3d and the numerical models including the eddy resolving models significantly underestimate the maximum downstream velocity across oleander line figs 6f and 7f the maximum downstream velocity is 1 91 m s 1 in the observations while it is only 1 10 m s 1 in armor3d 1 08 m s 1 in hycom 1 02 m s 1 in glorys2v4 and less than 1 m s 1 in the others this bias is not significantly smaller in the eddy resolving models hycom and ofes than in the eddy permitting models the underestimation of the peak velocity due to two factors first the numerical models underestimate the transport of the gs section 3 3 2 second the gs is broader in the numerical models than in observations so the already weak transport is spread over a larger cross sectional area to evaluate the temperature structure in the numerical models fig 8 shows the averaged 15 c isotherm in xbt observations observationally based dataset armor3d and numerical models along the oleander line during july 2009 december 2010 the 15 c isotherm is shown because its position at 200 m depth is used as the position of the gs north wall fuglister and voorhis 1965 joyce et al 2000 joyce et al 2009 a sharp shoaling of the 15 c isotherm can be found between 36 5 n and 38 n in the xbt observations black solid line southeast of the sharp slope the isotherm is horizontal for 1 35 5 n 36 5 n then gently shoals toward the southeast the position of the 15 c isotherm along the oleander line is consistent with observations in most of the constrained high resolution models except in orap5 in which the 15 c isotherm is several hundred meters below the observed one north of 37 n the large bias in orap5 is due to the overshooting of the gs after cape hatteras the isotherms in the two unconstrained products ofes and ecco2 at any specific time show a similar pattern as the observation a sharp slope near the gs axis not shown the near constant slope of the long term mean isotherm in the two models is a result of their gs paths having more variability than observed the slopes of isotherms in en4 armor3d and the numerical models are flatter with a shallower maximum depth than in the xbt observations the slope in hycom is closest to the observations and the slopes from armor3d glorys2v4 ur025 4 and soda 3 3 1 are closer to the xbt observations than that from en4 as with the down stream velocity along the oleander line the isotherms in all coarse resolution models are flatted compared to the observations to compare the slope and its position in different products quantitatively the horizontal absolute distance between the 15 c isotherms in the observationally based armor3d numerical models and in observations along the oleander line is calculated at 300 m 400 m and 500 m the distance averaged over the three layers is shown in table 2 the averaged distance indicates a combination bias of both the mean position and the slope of the isotherm in each dataset the 15 c isotherm in hycom is closest to the observation with only a 6 4 km bias the averaged distance for en4 is 62 6 km which is larger than most high resolution models and observationally based dataset armor3d 3 3 2 gulf stream transport across the oleander line transport across the oleander line consists of three parts the slope sea current part of the northern recirculation gyre the gs and the southern recirculation gyre in the sargasso sea rossby et al 2014 estimated gs transport across the oleander line by the velocity at 55 m which is just below the ekman layer based on previous observations they estimated that the gs transport integrated to 2000 m was 700 times the transport at 55 m to be consistent with the observed transports the transports across the oleander line in numerical models are also estimated from the velocity at a single layer at 55 m unit m3 s 1 m 1 or m2 s 1 thus the gs transport is the velocity at 55 m normal to the oleander line integrated between where the normal velocity first reaches zero from either side of the gs axis the slope sea transport is the normal velocity at 55 m integrated from the northern edge of the gs to continental shelf 39 31 n 72 57 w and the sargasso sea transport is the normal velocity at 55 m integrated from the southern edge of the gs to near bermuda 32 78 n 64 89 w the net transport is the sum of the transport in slope sea the gs and the sargasso sea note that both the slope sea current and the current in the sargasso sea are southwestward and a large part of the two southwestward currents will join the gs as a result the net transport across the oleander line is smaller than the gs transport transports from observationally based armor3d and numerical models are smoothed using a six month running mean to be consistent with how the observational transports from the oleander project are processed the transports from in situ observations armor3d and numerical models are shown in fig 9 the errors of the transports in armor3d and models are shown in fig 10 all numerical models evaluated in this paper underestimate the gs transport the slope sea transport and the sargasso sea transport across the oleander line fig 9 7 7 in fact the mean and median gs transports of the numerical models are smaller than more 75 of the observed transport values the slope sea current is missing in coarse resolution models and among all high resolution models only hycom and ur025 4 reproduce the slope sea transport with the correct order of magnitude the magnitude of sargasso sea transport is close to the observations in all high resolution models except ecco2 the biases of the net transport in the numerical models are much smaller than the gs transport which indicates that the gs transport bias in numerical models is mainly due to the underestimated transports of the two southwestward currents more specifically the error of the slope sea transport contributes more to the gs transport bias than the error of sargasso sea transport in most high resolution models in contrast the error of the sargasso sea transport contributes more to the gs transport bias than the error of slope sea transport in the coarse resolution models even though the slope sea current is missing in these models fig 10 similar results are shown by the time series of gs transports and net transports figs 11 and 12 generally the gs transports in the high resolution models are between the observed gs and net transports while both transports in the coarse resolution models are closer to the observed net transport the observed net transport is locally maximum around january 2005 while all numerical models as well as the observationally based armor3d show decreasing net transport at this time the reason for this discrepancy is unclear four of the thirteen numerical models are correlated to the observations in gs transport at 95 confidence level hycom 55 glorys2v4 59 gecco2 49 and ecdav3 1 40 hycom 41 0 glorys2v4 38 cfsr 36 and godas 36 are correlated to the observations in net transport across the oleander line at 95 confidence level note that cfsr s correlation is negative further glorys2v4 is more highly correlated with the oleander observations of both gs and net transport than the observationally based armor3d 3 3 3 gs position at oleander line the gs position at the oleander line is defined as the position of maximum downstream velocity at 55 m sanchez franks 2015 however some numerical models occasionally give two velocity maxima within a single monthly mean at the oleander line this may be due to switching of the path of gs within the month in such cases the peak closest to the gs path detected via aviso adt see section 3 4 1 is considered as the primary axis of the gs the annual mean gs latitude along the oleander line from in situ observations armor3d and other numerical models is shown in fig 13 the observed position does not have a trend the gs latitude is not significantly biased in the numerical models except in ofes unconstrained orap5 ecco2 unconstrained godas after 2005 and gecco2 after 2002 it is however more variable in the numerical models than in the observations the latitude fluctuations in 4 of the 13 models are significantly correlated with observations at the 95 level hycom 88 glorys2v4 68 ur025 4 72 and eccov4 67 the seasonal cycle of the gs position along the oleander line is not shown because it is weak in observations with a small southward shift in spring 3 4 gs path and its north wall 3 4 1 gs path the gs path is the maximum velocity axis of gs it is difficult to identify precisely and several different proxies are used in practice one such proxy is the adt contour of a specific value which is usually 0 25 m rossby et al 2014 andres 2016 the 0 5 m sea surface height anomaly is also used in some cases gangopadhyay et al 2016 however the ssh reported by the numerical models is not generally referenced to the same geoid used by observational datasets and so it is necessary to determine an appropriate ssh contour separately for each model in each model we choose the ssh contour that most frequency coincides with the location of maximum velocity at the 8 satellite altimeter tracks shown in fig 1 more precisely the chosen ssh contour is south or north of the velocity maximum at 50 of the space time points defined by the altimeter tracks when applied to the altimeter observations this method gives the 0 29 m adt contour as the gs path this adt value is sufficiently close to that used by rossby et al 2014 and andres 2016 that we consider the method to be validated in the following we therefore use the 0 29 meter adt contour to define the gs path in observations and similarly obtained ssh contours ranging from 0 19 m to 0 31 m to define the gs path in the numerical models the mean gs path from avisoadt during 1993 2010 is shown in fig 14 dashed black lines the mean path of the gs is flat west of 65 w with a few small undulations appearing to the east in all constrained high resolution models except orap5 the mean gs path between 75 w and 50 w is close to the observed path fig 14a and b the gs path from orap5 overshoots northward after cape hatteras between 74 w and 70 w which indicates that orap5 does not reproduce the separation from the coast adequately considering orap5 c glorsv5 and ur025 4 are all based on nemo use the same horizontal grid similar forcing and assimilation methods the overshooting problem in orap5 is probably not due to its grid resolution or assimilation method both orap5 and c glorsv5 have slope sea transports which are in the opposite direction as observed fig 9 which could contribute to the gs overshoot zhang and vallis 2007 however the overshoot in c glorsv5 is much smaller than in orap5 even though its slope sea transport is more in error than orap5 a possible source of the overshooting gs path in orap5 is its sub grid scale parameterization methods the unrealistically large undulations throughout the gs path in orap5 indicates errors in the potential vorticity pv balance of the gs which is sensitive to the details of the sub grid scale parameterization in the two unconstrained models ofes and ecco2 the gs paths depart from the observed path at most longitudes the gs paths in all coarse resolution models fig 14c are biased between 75 w and 70 w and show fewer undulations east of 70 w the bias between 75 w and 70 w may due to the unrealistic topography in the coarse resolution models in order to quantify model bias in the gs path we calculated the absolute error area for the gs path aea gs which is the area between monthly snapshots of the gs path in numerical models and aviso adt from 73 w to 55 w an exampe of the aea gs calcultion is shown in fig 15 the mean length of the gs path between 73 w and 55 w is about 2140 km so a 47 km meridional bias of the gs path results in 10 1010 m2 aea gs since the ssh in armor3d is based on satellite observations its mean aea gs value provides an estimate of errors due to interpolation hycom has the minimum mean aea gs among the numerical models fig 16 on average the gs path in hycom is biased by about 0 25 glorys2v4 and ur025 4 show the second and third minimum mean aea gs not surprisingly the two unconstrained models ofes and ecco2 show the largest mean aea gs the mean aea gs from all the other models are in a range from a little below 1 1011 m2 eccov4 to 1 75 1011 m2 gecco2 the aea gss in coarse resolution models are comparable to that in some of the high resolution models note that the aea gs is an estimate of the gs path bias between 73 w and 55 w and does not reflect the error in separation latitude that is a smaller aea gs does not necessarily imply a more accurate gs separation position at cape hatteras 3 4 2 north wall position the northern edge of the gs is referred as the north wall for its strong horizontal temperature gradient persisting to great depth it is occasionally visible in low level atmospheric features due to strong local air sea interaction sweet et al 1981 young and sikora 2003 the meridional position of the north wall has proven to be important not only in local climate joyce et al 2009 kwon and joyce 2013 taylor 1996 but also in marine biology nye et al 2011 saba et al 2015 a number of operational definitions for the position of the north wall have been proposed the most common being 1 the 15 c isotherm at 200 m joyce et al 2000 joyce et al 2009 2 the 12 c isotherm at 400 m bryan et al 2007 3 the location of sst front by ir satellite taylor and stephens 1998 and 4 the location of temperature 2 c lower than the maximum temperature in the current rossby and gottlieb 1998 we use the 15 c isotherm at 200 m to identify the north wall position in this paper as the location of the 15 c is readily obtained from hydrographic measurements going back several decades we regard the 15 c isotherm at 200 m from en4 dashed orange line in fig 1 to be the observed north wall position the biases of the mean north wall position fig 17 from numerical models are similar to their biases of the mean gs path fig 14 the topography changes dramatically near cape hatteras fig 1 from more than 3000 m southeast of the north wall position to less than 100 m northwest of the north wall at 75 w 36 n due to its coarse resolution en4 fails to recognize this sharp topography change the north wall path from en4 at 75 w which is derived from 15 c isotherm at 200 m is located at a position shallower than 200 m this is why the north wall in most high resolution models is south to its position in en4 at 75 w the discrepancy of the north wall position close to its west end among coarse resolution models is also partly due to their poor resolution of topography the overall bias of the north wall position in each model is estimated by the area between monthly snapshots of the gs north wall position derived from the model and en4 from 73 w to 55 w or absolute error area for north wall position aea nw the mean aea nw during 1993 2010 in each dataset is shown in fig 18 eccov4 with 1 horizontal resolution has the smallest aea nw which is smaller than the bias in the observationally based dataset armor3d the aea nw in hycom c glorsv5 glorys2v4 ur025 4 and ecdav3 1 are slightly larger than that in armor3d note that smaller error in eccov4 may partly be due to the horizontal resolution of the reference dataset en4 which is the same as in eccov4 several different indices have been introduced to describe the meridional position of the north wall as a whole one which is well suited to model data comparison is the gulf stream index gsi introduced by joyce et al 2000 and joyce et al 2009 it is defined as the first principal component of 200 m temperature at nine points along the mean north wall position shown in fig 1 the loading pattern of the first eof is positive at all the nine points joyce et al 2009 so positive negative values of its principal component indicate a coherent northward southward shift of the north wall the original gsi is derived from sparse in situ temperature profiles from the world ocean database wod joyce et al 2009 first interpolated 200 m temperature into 1 x 1 grids in the middle of each season where the temperature at each grid is the weighted average of all available temperature within 1 year in time 1 in latitude and 2 in longitude a gaussian taper is applied during the interpolation with e 2 folding scale of 0 5 year in time 1 in latitude and 2 in longitude finally temperature at the nine selected points are interpolated from the gridded temperature for the comparison in this paper we calculated a modified gsi gsi e8 with two major differences from the gsi introduced by joyce et al 2009 first only the eastern 8 of the 9 locations are used since the actual water depth at the west most point used by joyce et al 2009 is less than 200 m second the temperature at the eight points are interpolated from the seasonal mean temperature provided by en4 no gaussian taper is applied detrended and normalized annual mean gsi and gsi e8 are shown in fig 19 the annual mean gsi e8 follows gsi well with a correlation coefficient of 79 6 at 99 confidence level the pc of eof depends sensitively on the analysis period of data and only 18 years of data 1993 2010 can be obtained from the numerical models which is much shorter than the interval used to calculate the gsi e8 1954 2012 hence to keep the reconstructed gsi e8 rgsi e8 derived from armor3d and numerical models consistent with the gsi e8 derived from en4 rgsi e8 is derived via a fixed loading pattern which is the loading pattern of first eof mode during the calculation of gsi e8 from en4 annual mean rgsi e8 detrended and normalized is shown in fig 20 the correlation coefficients between annual rgsi e8 and gsi e8 are significant at 95 confidence level in 9 of the 13 numerical models hycom 79 c glorsv5 83 glorys2v4 64 ur025 4 80 soda 3 3 1 66 cfsr 79 godas 81 eccov4 65 ecdav3 1 62 and the observationally dataset armor3d 87 4 discussion 4 1 the cross stream gs structure the skewness and kurtosis of the observed gs can be explained by noting that the gs is a pv as well as a temperature front separating the high pv waters of the slope sea to the north from the low pv waters of the sargasso sea to the south the pv increases rapidly as the core of the gs is crossed to the north either at constant depth or while following a surface of constant density todd et al 2016 a simple model of the gs can be formulated as an ideal pv front using the reduced gravity equations we idealize the gs as a thin jet and following cushman roisin et al 1993 make use of the reduced gravity equations on an f plane for the present case it is only necessary to consider a single moving surface layer the pv in the moving layer is given by 1 q u y f h where u is the downstream velocity y is the cross stream distance h is the thickness of the moving layer and subscripts indicate partial differentiation we take y 0 as the location of the pv front for an ideal front the pv distribution is 2 q y q s y 0 q n y 0 with q n qs since the zonal velocity vanishes far from the front the two values of the pv are q s f h s and q n f h n where h s and h n are interpreted as the depths of the thermocline far to the south and north respectively of the gs 8 8 the downstream direction is inclined with respect to due east at the oleander line so north and south in this context are more precisely northwest and southeast eqs 1 and 2 provide a relationship between the layer thickness velocity and the conditions far from the front the system is closed by the geostrophic relation 3 u g f h y where g is the reduced gravity inserting 3 into 1 and 2 gives a differential equation in h 4 h y y f q y g h f 2 g the solution to 4 for the ideal pv distribution 2 gives this downstream velocity profile 5 u f l s l n e y l s y 0 e y l n y 0 where l s n g h s n f are the rossby deformation radii on the south and north side of the gs an important feature of the solution 4 is its asymmetry about the origin the velocity decays away from the core of the gs more slowly to the south than to the north because the rossby radius is larger on the southern side of the gs than on the northern side the velocity profile 4 is compared to the oleander velocity observations at 55 m in fig 21 the only adjustable parameters in 4 are the two rossby radii these were determined by a least square fit to the oleander observations over the range where the observed velocity is positive the optimal radii l s 46 km and l n 22 km are broadly consistent with the observed rossby radii in the sargasso and slope seas e g chelton et al 1998 the rms error in the fit is 8 remarkably small for such a simple model the observed velocity profile is smoother than the ideal front velocity profile and the velocity profiles obtained from the numerical models are smoother still any amount of turbulence or numerical dissipation will erode a sharp front like that given in 2 resulting in a smoother pv distribution and as a result a smoother velocity profile a crude model of diffusive spreading of the pv front can be constructed by imagining that the ideal front 2 is representative of the gs structure immediately after separation at cape hatteras thereafter the pv front is advected downstream and diffused laterally in steady state the pv budget is 6 u q x k e q y y where x is the downstream coordinate ke is an eddy diffusivity of pv and u is the mean downstream velocity which for simplicity we consider to be independent of the cross and downstream coordinates the solution to 6 with upstream conditions 2 is 7 q f 2 1 h n 1 h s f 2 1 h n 1 h s erf y 2 d where d 2 k e x u and x is the downstream distance from cape hatteras to the oleander line about 600 km note that the pv distribution 7 is the same as that obtained by convolving the ideal front distribution 2 with a gaussian with standard deviation d the equation for the moving layer thickness 4 is challenging to solve analytically with the pv distribution 7 but it is readily solved numerically by finite differences the solutions presented here were obtained by discretizing 7 on a domain of width 10l s with a grid spacing of 0 001l s as with the ideal front model the rossby radii and smoothing width are found by a least squares fit to the oleander observations the best fit shown in fig 21 has rossby radii l s 43 km and l n 17 km and a smoothing width of d 10 km note that the maximum velocity obtained from the smoothed front model is displaced toward the low pv side i e the south side the profile in fig 21 has been shifted horizontally so the maximum velocity is again found at y 0 the optimal rossby radii are not significantly different from the ideal front model if we use 600 km and 1 m s 1 for the distance to cape hatteras and the advecting velocity respectively d 10 km corresponds to a cross stream eddy diffusivity for pv of ke 166 m2 s 1 the smoothed front model fits the observations slightly better than better than the ideal front model with an rms error of 5 the smoothed front model is fit to the remaining observational and high resolution products the pv front is too diffuse in the coarse resolution models to reliably estimate the required fitting parameters the fit to the hycom velocity profile is shown in fig 21 the best fit rossby radii are similar to those obtained from the oleander observations l s 38 km and l n 11 km but the smoothing width is significantly larger at d 58 km the equivalent cross front diffusivity is ke 5500 m2 s 1 about thirty three times larger than that inferred from observations the pv front in the hycom product is therefore significantly broader and smoother than that found from observations this indicates that the subgrid scale parameterizations of dissipation used by hycom are unrealistically efficient at mixing pv across the gs the core of which has been found to be a barrier to mixing by numerous studies e g bower et al 1985 bower and rossby 1989 bower 1991 samelson 1992 bower and lozier 1994 lozier et al 1997 the implication is that even at 1 12 resolution hycom s dynamics are simply too diffuse to properly represent the sharpness of the gs pv front data assimilation cannot force the model to maintain a pv front which is sharper than its dynamics allow although it may prevent the front from spreading beyond this fundamental limit the results obtained from fitting the smoothed front model to the other high resolution products and armor3d are summarized in fig 22 the misfit is always less than 11 and the rossby radii are all within a physically reasonable range though with some variation with the exception of the oleander observations the smoothing widths are all about 1 1 5 times the southern rossby radius and the implied pv diffusivities are nearly two orders of magnitude larger than that inferred from the observed velocity profile armor3d is a gridded but observationally based data set and therefore does not have the pv mixing dynamics of the numerical models in this case the smoothing kernels inherent in the optimal interpolation procedure play a role similar to pv mixing the inferred pv diffusivity could thus be thought of as an effective diffusivity induced by the interpolation when the smoothing width exceeds the rossby radii on the northern and southern flanks of the gs the scale of the velocity s decay from its maximum value is dominated by the smoothing scale the velocity profiles obtained from the gridded dataset and numerical products are thus broader and more symmetric than the observed velocity profile for a given transport the peak gs velocity must decrease as the gs becomes broader as all of the numerical products have excessively broad gss they all underestimate the maximum gs velocity products which also significantly underestimate the gs transport have even smaller peak velocities 4 2 overall performance of the numerical models the performance of each dataset discussed in section 3 is summarized in table 2 to show the overall performance of each dataset more clearly the models closest to observations in each aspect is marked in bold and the four models closest to the observations are marked by shaded backgrounds in the table two of the models hycom and glorys2v4 are among the best for nearly all aspects hycom is among the top 4 models in 21 of the 25 listed aspects in table 2 and glorys2v4 is among the top 4 numerical models in 20 of the 25 aspects generally high resolution models perform better than coarse resolution models the noteworthy performance of hycom might be expected since it is the highest resolution constrained product discussed in this paper however it is not a priori clear that assimilation of sparse observational data should lead to similar improvements an eddy resolving model as seen in more coarsely resolved models in the case of hycom it appears that data assimilation continues to yield dividends at high resolution in contrast the superiority of glorys2v4 over orap5 c glorysv5 and ur025 4 is surprising because all the four constrained models are based on nemo sharing same horizontal gird and similar forcing one possible reason is that glorys2v4 is constrained via a reduced order kalman filter method 9 9 the 3dvar method is also applied to correct the large scale temperature and salinity distribution in glorys2v4 when enough observations are available garric and parent 2017 while orap5 c glorysv5 and ur025 4 are constrained via 3dvar method the kalman filter method has been shown to give better performance than 3dvar in many cases miyoshi 2005 whitaker et al 2008 yang et al 2009 5 summary an observationally based 3d ocean dataset armor3d and thirteen numerical models including eleven ocean reanalysis products hycom orap5 c glorsv5 glorys2v4 ur025 4 soda 3 3 1 cfsr eccov4 godas gecco2 ecdav3 1 and two unconstrained ocean simulations ofes ecco2 are compared with in situ analyzed and remote observations the intercomparison is focused on the gulf stream from the florida straits to south of the grand banks and considers the florida current transport the separation of gulf stream at cape hatteras gulf stream transport position and structure along the oleander line gulf stream path and the north wall of the gulf stream the variations between products in the cross stream structure of the gs is explained using a simple model of the gs as a smoothed pv front broader pv fronts lead to broader and more symmetric velocity profiles as well as lower peak velocities it is suggested that the failure of the numerical models to reproduce the observed peak gs velocity is due to overly aggressive sub grid scale dissipation which erodes the gs pv front among the 13 numerical models the gs in two of them hycom and glorys2v4 is closest to the observations hycom s primary advantage is likely its high resolution 1 12 the good performance of glorys2v4 may be due to its assimilation method kalman filter even though reanalysis products are expected to improve numerical simulations and provide near observation results they do not have to be so we show in this paper that in fact most available reanalysis products fail to adequate represent some of the most basic features of the gulf stream excluding the two free run simulations ofes and ecco2 less than half of the 11 constrained products are significantly 95 level correlated with the observations in the gulf stream separation latitude the gulf stream and the net transport along the oleander line in some of the models the 11 year mean values may also be largely biased such as the gulf stream transport across the oleander line in addition some common errors exist in the numerical models discussed in the paper none of the models can reproduce the correct horizontal structure and maximum value of the velocity along the oleander line there is thus much work to be done before ocean reanalyses can be regarded as approximations to reality with the same confidence commonly attached to atmospheric reanalyses acknowledgment this work was supported by the national science foundation oce 1634829 the authors thank terrence m joyce for providing gsi data and two anonymous reviewers for providing comments which improved the manuscript 
24112,dense water dw formation commonly occurs in the shallow northern adriatic sea during winter outbreaks when there is a combination of the cooling of surface waters by the winds and high salinity as a result of reduced river inputs these dws subsequently propagate southwards over a period of weeks months eventually arriving in the southern adriatic sea the investigation is based on a new nonhydrostatic nh formulation of the 3d finite element model shyfem that is validated for a number of theoretical test cases subsequently this model is used to simulate through high resolution numerical simulations an extreme dw event that occurred in the adriatic sea in 2012 we perform both hydrostatic hy and nh simulations in order to explicitly see the impact of nh processes on the dw dynamics the modeled results are compared to observations collected in the field campaign of march april 2012 in the southern adriatic sea the nh run correctly reproduces the across isobath bottom trapped gravity current characterizing the canyon dw pathways it also more accurately captures the frequency and intensity of dense water cascading pulsing events as the inclusion of nh processes produces stronger currents with different dw mixing characteristics finally the nh run simulates internal gravity waves igw generated during the cascading at the edge of the canyon which propagate downslope this igw activity is not captured in the hy case keywords dense water nonhydrostatic process finite element model southern adriatic sea submarine canyon 1 introduction dense water dw produced on the continental shelf and its propagation to the deep ocean via a bottom trapped gravity current have been widely studied ivanov et al 2004 not only because of its role in exchanging water masses with different properties between the shelf and the deep ocean but also because the cascading dynamics can influence the thermohaline circulation in the ocean özgökmen et al 2006 herrmann et al 2008 thus these currents have a role to play in the climate system herrmann et al 2008 dw on the continental shelf can be generated by a number of factors such as cooling evaporation over precipitation salinization or surface layer freezing once formed the dw can sink to the bottom and propagate flowing geostrophically along isobaths if this geostrophic balance is broken dw masses can flow down the slope across isobaths and this process is called cascading i e in submarine canyons trincardi et al 2007 canals et al 2006 this process occurs in many areas like the eastern greenland shelf magaldi and haine 2015 the antarctic tanaka and akitomo 2000 and the mediterranean shelf slope borders gulf of lion salat et al 2010 adriatic sea bergamasco et al 1999 langone et al 2016 mihanović et al 2013 chiggiato et al 2016 aegean sea vervatis et al 2011 there have been many studies to determine the main characteristics shape and dynamics of dw flows wåhlin and walin 2001 in the mediterranean sea canals et al 2006 highlighted the importance of dw flows in transporting sediment loads from the shelf to the slope contributing to the excavation of the typical canyon structure seen in the gulf of lions dws are seen as a transport mean for sediments and organic matter shaping the sea floor as well as bringing nutrients to the deep ecosystems canals et al 2006 turchetto et al 2007 and trincardi et al 2007 studied the bari canyon system southern adriatic sea finding evidence that identify preferential pathways for sediment fluxes in correspondence with dw events that are modulated by pulsating behavior a general assumption is that energy transfer and balance are driving the definition of dw pathways and water transport dw events can be detected by measurements though their unsteady nature makes these phenomena extremely challenging to be fully captured temporally and spatially measurements have shown that the cascading process occurs once a specific energetic threshold is reached breaking the geostrophic balance and allowing the prevailing effects of secondary forcings that make the bottom plume pulsing with the plume then being modified by entraining dynamics with surrounding waters wang et al 2003 wåhlin and walin 2001 shapiro and hill 1997 there are also many modeling applications in idealized environments investigating the formation and occurrence of dw plumes and their interaction with the surrounding water masses several simplified models based on specific processes were implemented and compared with evidence from laboratory experiments for example wobus et al 2011 simulated dw cascading using the model polcom reproducing a laboratory experiment of dw on a steep slope using a rotating turntable they concluded that hy models can reproduce the main features of the bottom layer dynamics shapiro and hill 1997 proposed a simplified 1 1 2 layer model which showed the importance of vertical mixing to enhance the downslope propagation of dw plumes while also clarifying how bottom friction plays a major role for thin dw plumes wang et al 2003 considered a two layer reduced gravity model to identify different behaviors for dw flows with thicknesses below or above the bottom ekman layer the former is mainly influenced by bottom ekman veering that allows cross isobath pathways while the latter is affected by geostrophy superimposed to cycloidal inertial oscillations however in this work no entrainment of the bottom trapped gravity current was considered a certain number of studies on limited size domains were conducted with fully nonhydrostatic nh models for example tanaka and akitomo 2000 found that the alternation of upward and downward flows at the shelf break leads to intensified mixing processes they identified bottom friction seafloor features and the evolution of instabilities as factors modulating the breakdown of geostrophic balance that leads to downslope dw flows moreover tanaka and akitomo 2001 linked the baroclinic instability of a flow to the slope steepness on gentle slopes unstable eddies are present over the whole slope limiting the downslope flow on steeper slopes these eddies are confined to the upper part of the slope causing downslope transport to be enhanced finally spurgin and allen 2014 investigated the dynamics in the proximity of bottom features like canyons identifying them as enhancing factors for downward advection of dw flows with evidence of a general upwelling dynamics in the areas outside the canyons much less information is available on the modeling characterization of nh processes in dw dynamics in real ocean environments due to the numerical cost needed to fully implement a model at the adequate temporal and spatial scales needed at the basin scale from an operational point of view there is the need to model the regional or global circulation considering the contribution of dw flows these models are generally hydrostatic a full review can be found in legg et al 2009 and reference therein where solutions for including dw effects were provided with improved parameterizations for reproducing vertical mixing also mixing parameterizations or new approaches in dealing with horizontal and vertical discretization were investigated legg et al 2006 ezer and mellor 2004 however these model implementations even if correctly providing thermohaline changes due to dw and improving water masses reproduction did not deal with the full physical modeling of the connected nh processes such as dw cascading magaldi and haine 2015 investigated the effects of nh formulation on the capability of reproducing dw cascading processes off the east greenland shelf their work suggests a central role of nh processes in transferring energy from the continental slope to the deep ocean when a breakdown in geostrophic balance occurs with a subsequent generation of internal gravity waves in this study we consider the importance of including nh processes for modeling dense water dynamics focusing on a particular event that occurred in the adriatic sea during the winter of 2012 an extraordinarily large amount of dw around 0 55 sv as a lower estimate was formed in the northern adriatic sea and propagated as a bottom trapped gravity current within a couple of months it reached the southern part of the basin where cascading occurred mihanović et al 2013 two main pathways of dw were identified south of the mid adriatic pit also called jabuka pit fig 1 with dw veins seen between 50 and 100 m benetazzo et al 2014 measurements downhill with respect to the so called canyon b within the bari canyon system fig 1 showed that the dw vein follows the preferential pathway driven by the morphology decreasing its thickness and detaching from the bottom chiggiato et al 2016 the observed dw tongue flowed at the bottom with measured velocity reaching 40 cm s 1 and its thickness was progressively increased due to entrainment with thermohaline modification of water chiggiato et al 2016 cascading dynamics is not representative only of the canyon area other pathways were identified like the gondola slide fig 1 and the north eastern border of the south adriatic pit there modified dw that already experienced mixing with older waters in the mid adriatic pit with thinner tongues and a pulsing behavior at sub inertial frequency overflowed the sill chiggiato et al 2016 several different modeling studies of this dw event were carried out benetazzo et al 2014 used the roms model reproducing current wave interaction stating the importance of river discharge and coastal wave effects for shelf dw modulation carniel et al 2016 made a sensitivity analysis identifying the importance also of sediment transport modeling for dw reproduction in these two works the dynamics was investigated with a horizontal resolution of 1 km and with a maximum bottom layer thickness of 15 m which was considered enough to identify the bottom dw vein these two implementations assumed that nh processes were of minor importance in dw formation and propagation while a study by mckiver et al 2016 has shown that nh processes play no role in the dw formation in the northern adriatic sea the present work aims at evaluating their importance for the south adriatic dw propagation and subsequent cascading events to this end a new nh version of the shyfem model is developed and tested it is then applied to study the dw event of winter 2012 where we perform both hydrostatic hy and nh simulations in order to quantify the relative importance of nh processes for the reproduction of dw evolution and cascading in section 2 we introduce the nh shyfem model presenting the equations and the numerical approach to solve them followed by a validation of the model using well known test cases in section 3 we describe the winter 2012 dw event summarizing the observations used then describing the model setup followed by a comparison of the model simulations and observations in section 4 we describe and discuss the dw and cascading characteristics reproduced in the two simulations outlining the impact of the inclusion of nh dynamics 2 nonhydrostatic shyfem shyfem is a finite element hydrodynamic model originally developed to solve the shallow water equations umgiesser et al 2004 though more recently updated for the 3d primitive equations bellafiore and umgiesser 2010 and applied for a preliminary investigation of dw dynamics in the northern adriatic sea mckiver et al 2016 here we outline the recent development of the nh version of shyfem previous implementations of shyfem assumed hydrostatic balance where there is a balance between the vertical gradient of pressure and buoyancy this assumption vastly simplifies the equations by removing the vertical momentum equation as the vertical acceleration can be neglected in the nh case the vertical momentum equation must be included to solve for the vertical acceleration and velocity and also the nh pressure must be solved through the solution of a 3d poisson equation the nh equations are relevant in flows where there is strong vertical acceleration 2 1 equations of motion the equations of motion for an incompressible boussinesq flow comprise the equations of momentum balance 1a u t u u x v u y w u z f v p x ν h 2 u x 2 2 u y 2 ν v 2 u z 2 1b v t u v x v v y w v z f u p y ν h 2 v x 2 2 v y 2 ν v 2 v z 2 1c w t u w x v w y w w z p z g ν h 2 w x 2 2 w y 2 ν v 2 w z 2 as well as the continuity equation 2 u x v y w z 0 where u v w are the three dimensional velocity field components p is the normalized pressure defined as the pressure divided by ρ 0 where ρ 0 is the constant background density f is the coriolis parameter νh and νv are the horizontal and vertical viscosity coefficients respectively and g is gravity the vertical integration over the water column of the continuity equation provides an equation for the water level ζ at the free surface 3 ζ t x h ζ u d z y h ζ v d z 0 where h is the undisturbed water depth the normalized pressure is subdivided into a hy and nh component i e p π q where π is the hy component which incorporates the barotropic and baroclinic pressure terms i e 4 π g ζ z g ρ 0 z ζ ρ z d z and q is the nh pressure 2 2 solution method the shyfem model bellafiore and umgiesser 2010 umgiesser et al 2004 uses a finite element discretization of the domain in the horizontal while the vertical water column is discretized into nl layers of thickness hl the full nh equations are solved following the two step approach of casulli 1999 see also casulli and zanolli 2002 whereby in the first step only the hy equations are solved followed by a second step where the nh pressure is computed and then used to correct the hy fields to solve the equations of motion we apply a semi implicit treatment of certain time dependent variables given by 5 x α x n 1 α x n where x represents the time dependent variable α 1 α and the superscripts n and n 1 represent the value at the current and next time step respectively the weighting parameter α is in the interval 0 to 1 where a value of 0 means fully explicit treatment whereas 1 implies a fully implicit treatment the horizontal advective and viscosity terms in the momentum equations are treated fully explicitly while the vertical component of viscosity in the momentum equations is treated fully implicitly the horizontal divergence term in the continuity equation is treated semi implicitly with weighting parameter αz i e 6 α z u x n 1 v y n 1 α z u x n v y n w z n 1 0 which leads to similar treatment in the equation for the water level at the free surface i e 7 ζ t α z x h ζ u n 1 d z y h ζ v n 1 d z α z x h ζ u n d z y h ζ v n d z 0 also the coriolis term and the hy and nh pressure gradient terms in the momentum equations are treated semi implicitly their weighting parameters being denoted by αf αm and αq respectively for implementation the αz and αm parameters were set to 0 6 close to the semi implicit approach allowing some artificial damping for the gravity waves for stability reasons the coriolis term αf was set to 0 5 which is energy conserving for the rossby waves considering a forward differencing step for time derivatives and discretizing the domain into nl layers of thickness hl in the vertical we can write the momentum equations as 8a u l n 1 u l n δ t a d v l x f α f v l n 1 α f v l n α m π l x n 1 α m π l n x α q q l n x ν h 2 u l n x 2 2 u l n y 2 ν v 2 u l z 2 n 1 8b v l n 1 v l n δ t a d v l y f α f u l n 1 α f u l n α m π l y n 1 α m π l n y α q q l n y ν h 2 v l n x 2 2 v l n y 2 ν v 2 v l z 2 n 1 8c w l n 1 w l n δ t a d v l z α q q l n z ν h 2 w l n x 2 2 w l n y 2 ν v 2 w l z 2 n 1 where advx advy and advz are the advection terms for u v and w respectively which are treated explicitly all variables are evaluated at the center of the layer except the vertical velocity which is evaluated at the interface between layers in this case wl and w l 1 refer to the bottom and top interface of layer l respectively and w 0 is the vertical velocity at the surface we use x n 1 to denote that these variables are only the intermediate solutions i e the hydrostatic step at this stage the unknown nh pressure at time step n 1 has been neglected and will be considered only at the next nh step the second step that applies the nh correction is given by 9a u l n 1 u l n 1 α q δ t q l x n 1 9b v l n 1 v l n 1 α q δ t q l y n 1 9c w l n 1 w l n 1 α q δ t q z n 1 l where in eq 9c the brackets indicate the derivative at the layer interface i e 10 q z n 1 l q l 1 n 1 q l n 1 δ z where δ z h l 1 h l 2 in order to implement the second step we must first solve for the nh pressure to obtain an equation for the nh pressure we begin with the continuity equation eq 6 in shyfem this equation is discretized as 11 α z u l x n 1 v l y n 1 α z u l x n v l y n w l 1 n 1 w l n 1 0 where u and v are the horizontal transport components defined as ul hlul and vl hlvl this holds for all the layers below the surface 2 l n to derive an equation for the surface we use eq 3 in its discretized form which reads 12 ζ n 1 ζ n δ t l 1 n α z u l x n 1 v l y n 1 α z u l n x v l n y 0 inserting eq 11 from layers 2 to n we obtain assuming that the vertical bottom velocity wn is zero 13 ζ n 1 ζ n δ t α z u 1 x n 1 v 1 y n 1 α z u 1 n x v 1 n y w 1 n 1 0 to solve this equation we assume that the pressure is hydrostatic in the surface layer casulli 1999 thus we can write 14 p 1 n 1 g ζ n 1 z 1 g ζ n 1 z 1 q 1 n 1 leading to 15 ζ n 1 ζ n 1 q 1 n 1 g using this in the integrated continuity eq 13 as well as the equations for the nh correction eq 9 it can be shown casulli 1999 that at the free surface l 1 we have 16 h 1 α q δ t α z 2 q 1 x 2 n 1 2 q 1 y 2 n 1 α q δ t q z n 1 1 q 1 g δ t α z u 1 x n 1 v 1 y n 1 α z u 1 n x v 1 n y ζ n 1 ζ n δ t w 1 n 1 the equation for the layers below the surface is obtained by substituting eq 9 into eq 11 giving 17 h l α q δ t α z 2 q l x 2 n 1 2 q l y 2 n 1 α q δ t q z n 1 l 1 q z n 1 l α z u l x n 1 v l y n 1 α z u l n x v l n y w l 1 n 1 w l n 1 eqs 16 and 17 represent a poisson equation that must be solved for all nodes and over all vertical layers these equations can be represented as a linear matrix system a x b which can be solved using iterative sparse matrix solvers once solved the final velocity fields and water level are obtained from eqs 9 and 15 respectively the final nh pressure is obtained from 18 q l n 1 q l n 1 q 1 n 1 in order to stabilize the poisson system the parameter αq was chosen to be fully implicit 1 0 as also recommended in casulli 1999 and casulli and zanolli 2002 in order to take into account the full contribution of the nh terms to the hydrodynamics the new shyfem version has to exclude the automatic correction for the vertical turbulence term as computed by the gotm k ϵ turbulence closure burchard et al 1999 burchard and bolding 2001 this scheme previously used in shyfem was meant to re stabilize the water column through an artificial increase in vertical viscosity in areas with unstable stratification this correction applied in the hy version of the code helps to avoid instabilities while if not excluded in the nh version it could counteract the vertical dynamics due to nh processes particularly enhanced along an unstably stratified water column being interested in reproducing the vertical processes in a realistic way allowing the development of unstable stratification the nh formulation leaves the mixing to the vertical acceleration terms while the above mentioned correction could lead to fictionally increased local mixing in the hy run the new nh formulation of the shyfem code has a computational cost on average 4 times longer than the hy version therefore it is presently suitable for process studies while requiring further development to be applied for operational purposes 2 3 test simulations of nh shyfem for our first test of the nh model we considered a standing wave in a deep basin the square basin has length l 10 m and depth h 10 m initially the velocity is zero while the initial free surface elevation is given by 19 ζ x ζ 0 cos k x 0 x l where k π l and the initial amplitude is taken as ζ 0 0 1 from the theory of small amplitude waves the frequency ω of the resulting wave is approximated by the positive root of ω 2 g k tanh k h the finite element grid used is made of 205 nodes and 320 elements with 100 vertical z layers 5 cm thick each hy and nh runs were performed with a 0 01 s time step fig 2 shows the surface water level at both ends of the basin x 0 m and x 10 m comparing the analytical solution with the modeled ones the hydrostatic model s inability to capture the evolution is evident whereas the nh model well reproduces the standing wave pointing to the need to include nonhydrostatic dynamics to reproduce this process as a second test of the model we consider the classical lock exchange experiment which requires the nh terms in the equations of motion in order to fully capture its dynamics shin et al 2004 in the lock exchange experiment a rectangular tank is filled with two fluids of different density that are initially separated by a thin barrier when the barrier is removed the heavy fluid begins to flow as a gravity current along the bottom of the tank while at the same time the lighter fluid form a current moving in the opposite direction at the surface for our test we apply the same configuration of lai et al 2010 the tank has a length of 0 8 m a width of 0 008 m and a depth of 0 1 m we take the light fluid to be freshwater while the heavy fluid is salt water with a salinity of 1 3592 the finite element numerical grid has 6400 triangular elements of the same size having 3909 nodes with 100 z layers in the vertical in fig 3 we show snapshots of the density field from simulations comparing the hy and nh runs in the case of a hy flow the front of these gravity currents has a sharp flat shape which is not observed in nature in the nh case the fronts are curved and eventually develop kelvin helmholtz instabilities at the interface of the two fluids when the velocity shear between them is strong enough the unrealistic dynamics seen in the hy case is due to the removal of a mechanism of energy transfer between the vertical and horizontal direction because the hydrostatic approximation defines the vertical velocity through the equation of continuity berntsen et al 2006 only with the inclusion of the nh pressure it is possible to obtain the real dynamics observed in experiments 3 the adriatic sea dw event of 2012 here we focus on a dw event that occurred in the winter of 2012 in the adriatic sea during the period january february there was a massive generation of dw in the northern adriatic sea with record breaking density anomalies of above 5 kg m 3 relative to a value of 1025 kg m 3 mihanović et al 2013 this event occurred after a particularly warm and dry year resulting in a reduction of coastal freshwater supply in the backdrop of an already long term trend of increasing salinity the event was then triggered by an extended period of cold weather with strong bora winds in the coastal north eastern adriatic region that lasted for about three weeks between the 25th of january and the 14th of february 2012 mihanović et al 2013 after its generation the dw quickly sank and became a bottom trapped gravity current which propagated southwards along isobaths of the italian continental shelf two months later it arrived in the southern adriatic sea where dense water cascading was observed chiggiato et al 2016 3 1 observational data a large dataset of observations is available from operation dense water odw campaigns carried out in march april 2012 ctd sbe 911 plus probes and moorings are exploited here for model validation purposes the whole set of data is fully described in chiggiato et al 2016 and here we outline only the measurements which are most relevant for our purposes ctd profiles were collected in two cruises in the southern adriatic sea between the 23th of march and the 20th of april 2012 particularly in the first leg the 60 ctd profiles gave precise details about the presence of dw and are therefore used for the model validation black dots in fig 1a data during the dw event were collected within the first 100 m above the bottom by five mooring chains equipped with temperature and salinity sensors and acoustic doppler current profilers adcp their locations are indicated as red dots in fig 1b moorings b c located within the bari canyon systems and f are the ones where dw were detected in a sloping environment which is central for inferring about the nh processes occurring during cascading therefore these are the ones used in the next section for validation purposes and the characterization of dw event 3 2 model setup using as a basis the previous shyfem implementation in the adriatic sea discussed in mckiver et al 2016 new simulations hy and nh were set up in order to reproduce the dw event of 2012 a new finite element grid was created fig 1 the grid covers the whole adriatic sea up to the otranto strait where the open sea boundary is set and consists of 35 203 nodes and 68 267 elements horizontal resolution is variable over the domain and reaches 50 100 m in both the coastal area and the southern adriatic sea in the area comprising the bari canyon system the water column is discretized with 100 z layers having increasing thickness from 1 m at the surface to 17 m near the bottom considered suitable for dw bottom flow reproduction and comparable with previous works mckiver et al 2016 benetazzo et al 2014 carniel et al 2016 an up to date bathymetry is used that comprises a merge of data from nurc nato undersea research centre provided within the adria 02 framework and by ismar cnr institute of marine science national research council within the last few years in the northern adriatic sea and in the proximity of the bari canyon southern adriatic sea the system is initiated with water levels set to the mean sea level and 3d temperature and salinity fields from daily mean 2 km horizontal resolution afs adriatic forecasting system data the same dataset is used to force the system laterally at the open boundary of the otranto strait at the same open boundary water levels tides and surge are imposed with hourly time step from the otis osu tidal inversion software tidal model and afs sea surface height data the freshwater sources are treated as described in mckiver et al 2016 surface forcing for wind air pressure air temperature relative humidity and cloud cover are from the moloch modello locale in h coordinates model malguzzi et al 2006 ferrarin et al 2013 a complete description of datasets used to force the present simulations and the numerical schemes applied for computation is provided in mckiver et al 2016 unlike the previous implementation done by shyfem for the dw event of 2012 the present simulations use more vertical layers in order to properly match the bottom dynamics 3 3 model assessment from the 60 ctd casts acquired in the first leg of the cruise in the southern adriatic sea temperature salinity and potential density bias model measurements and root mean square error rmse were computed for the hy and the nh runs the results shown in fig 4 indicate that salinity bias is negative for both simulations with lower values in the surface 100 m 0 2 on average the nh run has a smaller bias 0 05 over the water column than the hy run 0 1 overall both simulations match fairly well the salinity average behavior only having small differences within tenths of a unit also the salinity rmse reveals the higher spatial variability of the signal in the upper 100 m with a higher error found in the hy run with respect to the nh case this discrepancy in the upper 100 m is present also for the temperature and potential density fields both runs underestimate temperature in the thermocline with similar behavior both in terms of bias and rmse however major differences between the two simulations occur between 300 m and 800 m depth where the nh run matches very well with the measurements having a rmse within 0 2 c the two runs show opposite sign biases at the deepest levels being positive and negative for the nh and hy cases respectively it should be noted that only a few ctd casts reach the lowest depths therefore also the corresponding statistics are less significant just to give an idea of the statistical relevance less than 15 of ctd casts reach depths below 600 m in the depth range 300 800 m the nh rmse is half that of the corresponding hy one then increasing below 900 m to 0 3 c the tendencies for salinity and temperature identify the nh model capability to better reproduce potential density profiles from the surface down to 800 m with a lower bias and lower rmse as an average not higher than 0 05 kg m 3 on the other hand the nh run shows a more negative bias and larger rmse below that depth 4 ctd casts on 60 in order to investigate the horizontal shape of the dw plume we consider sections of the salinity temperature and potential density anomaly defined as the density difference with respect to the density of sea water at the surface 1025 kg m 3 along the transects a and b figs 5 and 6 respectively which were investigated during the field campaign of march april 2012 chiggiato et al 2016 described the dw vein in transect a as being 20 30 m thick with two local maxima around 100 m and 130 m depth see fig 5d where the plume is expected to be in geostrophic balance they also found another local maximum detected at depth 180 m and representing an across isobath dw flow fig 5d they deduced the characteristics of the dw vein from a temperature section identifying as part of the vein the water with temperature lower than 13 c from fig 5e the hy case has a dw vein with peak values at 100 130 m more evident in the temperature section if just temperature is analyzed the second peak at 180 m depth seems not to be matched by either the hy or nh runs however looking at the density section fig 5i the nh run has the second density peak at 180 m values above 1029 2 kg m 3 and represents a cross isobath descending flow with dw having slightly different thermohaline characteristics a small area of higher salinity fig 5 that suggests possible entrainment of surrounding water the second dw core is not reproduced by the hy run due to the presence of across isobaths dw flows there as mentioned in chiggiato et al 2016 that can only be reproduced by including nh processes in the formulation on the southernmost transect b the measurements detected a dw plume characterized by an asymmetrical behavior with a flat dw upper edge whilst the thickness of the dw tongue further offshore was diminished by the action of bottom friction their measurements also identified the highest potential density anomalies of the whole field campaign fig 6g in this transect the part of the dw tongue detected further offshore is strongly affected by the influence of open sea waters with higher salinity fig 6a for the model results shown in fig 6 the dw plume is more accurately reproduced by the nh run than the hy run having similar shape compared with measurements with a thicker bulb inshore which decreases in thickness moving further offshore also the influence of more salty offshore water is correctly captured by the nh run that has higher salinity at the 180 200 m depth isobath fig 6c in fig 7 we look at mooring time series of density anomaly a and c and current speed b and d collected during the dw spreading event in the two locations close to the bari canyon b and c see fig 1 and compare them to the hy and nh simulations the potential density anomaly is better reproduced by the nh model overall the nh reproduces better the variability in both locations whereas the hy density seems generally smoother less sensitive to the thermohaline variations connected with singular events of dw flow within the bari canyon over the whole monitored period the hy run potential density biases are 0 071 kg m3 and 0 011 kg m3 for b and c respectively nh run potential density biases are 0 067 kg m3 and 0 015 kg m3 for b and c both runs slightly overestimate potential density in canyon b and underestimate it in canyon c however looking at the speed reproduction both runs underestimate currents at mooring b the simulated velocities are never higher than 0 2 m s 1 for the nh run and 0 1 m s 1 for the hy run while measurements show peaks up to 0 6 m s 1 the simulation of current speed at mooring c is underestimated as well though two peak events are matched by the hy run the northernmost mooring f detected pulsing events of cascading on the slope with frequencies around 1 5 days these signals are evident in two wave trains of subsequent high current speed and density pulses at the end of march and in the first week of april 2012 fig 7e and f both the hy and nh runs seem not able to fully match these pulses in speed intensity the hy run seems to miss the signal completely while the nh run though underestimating the potential density and the corresponding speed is at least able to partially match the occurrence of the wave train measured at the beginning of april fig 7 analyzing the results we found that the pulsing process is reproduced by the nh run along a path slightly displaced spatially from the mooring f with a delay of about 3 5 days see fig 7 and supplementary material below to make this evident we plot in fig 7e and f red dashed curve also the nh potential density anomaly and speed time series extracted 5 km south east of the mooring f denoted f1 fig 1 and shifted by 3 5 days while the potential density anomaly values are quite similar to the ones extracted in mooring f there is an improvement in speeds almost reaching the same measured values the simulated dw flow which is generated in the northern adriatic sea and takes months to reach the study area has a time shift probably due to small errors in the reproduction of the general circulation possibly due to uncertainties or biases in temperature salinity or heat flux forcings to more clearly identify pulsing dw cascading we compute the single sided amplitude spectrum of current speed over the period of the pulsing dw trains fig 8 shows the comparison of measurements in f with results extracted in f1 from the hy and nh runs the pulses periodicity can be clearly detected from measurements frequency of 7 10 6 s 1 corresponding to a period of 1 65 days the nh run fairly matches the 7 10 6 s 1 frequency while the hy spectrum gives a less clear picture with an attenuated peak at the same frequency and additional peaks 4 dense water plume and cascading characteristics in this section we look at how the models capture specific characteristics of the dense water plume and the dense water cascading events in fig 9 we plot maps of bottom currents and potential density anomaly temporally averaged over the period in which dw was detected in the study area 9th of march 9th of april averaged bottom currents are less energetic along the italian coast in the hy run case with peak values not exceeding 0 3 m s 1 the most intense current pathways are seen at the slope border of the italian shelf following some morphologic structures like the dauno seamount the nh run shows intensified bottom currents along the italian coast flowing southward peak bottom velocities reach 0 4 m s 1 that even if lower than measured ones are more consistent with measurements than the hy case the nh run has intensified bottom current patterns slightly detached south of mooring f then developing along the dauno seamount this evidence suggests that the across isobath dw flow detected by measurements and not clearly seen from the modeled nh time series in mooring f fig 7 is not totally missed but just slightly shifted as already mentioned in the analysis of figs 7 and 8 above probably due to some discrepancies in the general circulation feature reproduction and in the representation of bottom morphology fig 9 a and b fig 9 shows also how the nh run has denser bottom waters spreading southward in larger veins generally the hy run reproduces dw with lower potential density anomaly values compared with the nh run the hy run identifies a dw vein with the same density seen from measurements values above 4 3 kg m3 as evident from ctd values in transect a and b figs 5 and 6 but it follows mainly along bathymetry pathways dw maintains its preferential pathway along shelf and dw spreads less along the shelf compared with the nh case fig 9 looking at the vorticity patterns integrated over the water column fig 9 bottom panels higher absolute values for the nh run along the whole border of the south adriatic pit are evident indicating stronger currents interestingly the major differences compared with the hy run are not only in the intensity of the vorticity but also in the patterns particularly following the isobaths close to the dauno seamount and in the bari canyon system south of mooring f the hy run simulates a core of positive vorticity along isobaths at the border of the slope this could be due to the main pathway of dw that is kept more on the shelf not breaking geostrophy for the nh run the same area shows lower vorticity that as is also evident from the bottom currents can be connected with flow more directed across isobath with lower lateral gradients moving south to the bari canyon system both the hy and nh runs simulate higher bottom speeds compared with the surrounding area chiggiato et al 2016 found the highest bottom speeds within canyon b also canyon c experiences intense fluxes but slightly lower than canyon b canyon b shows a bimodal distribution of current speeds one along the canyon main axis the other flowing southward probably overflowing the sill to reach the southernmost canyon c in the latter canyon the bottom current is directed mainly along the canyon major axis trincardi et al 2007 investigated the bottom forms along the two canyons and hypothesized that part of the dw flow in the deepest segment of b canyon could enter the deepest part of canyon c enhancing the turbidity and increasing the hydrodynamics and consequently the morphodynamics of this area both the hy and nh modeled bottom currents shown in fig 9 identify the features connected with the morphological shape of the two canyons the hy run shows particularly for canyon b a major flux along isobaths crossing the major axis of canyon b and a convergence of water to canyon c the nh run matches the portion of flux that as hypothesized by trincardi et al 2007 overflows from canyon b to canyon c but is also able to reproduce the along axis flux even if velocities are underestimated compared with measurements fig 10 looking at the bottom potential density anomaly in the bari canyon around moorings b and c the isolines crossing the canyons in the case of the hy run reveal how there is not a defined pathway for higher density water in the area fig 10 on the contrary the isolines shape for the nh run show how much denser water is flowing through the canyons crossing isobaths in canyon c particularly nh run reproduces a uniform pattern of denser waters 4 1 kg m 3 along the whole canyon crossing isobaths and suggesting a bottom trapped gravity current fig 10 black box this feature observed in the field is probably caused by the vertical acceleration within the canyons that can only be reproduced with the inclusion of nh processes in the map of vorticity for the hy run there is a major bulb of cyclonic vorticity with a thin tongue of anti cyclonic vorticity just at the southern edge of canyon c the hy model has weaker velocities downhill and stronger along isobath flows compared with measurements giving rise to a less realistic vorticity pattern the nh run has areas of convergence that increase the downward flow at the southern edge of each canyon probably representing the main pathway of cascading flow the cyclonic vorticity close to the canyon c mooring could counteract the downhill flow in the last part of the canyon and could justify the lower velocities measured there by the mooring compared with the other canyon chiggiato et al 2016 in order to characterize the cascading dynamics occurring in the two simulations in fig 11 we plot the time evolution of the bottom potential density anomaly and the vertically averaged vorticity during the pulsing cascading event around mooring f site dw cascading along the edge of the continental slope into the pit is seen in both the hy and nh cases this cascading process is associated with the passage of a patch of strong cyclonic vorticity vortices developed at the shelf border and increasing baroclinic instabilities magaldi and haine 2015 also described this dynamics as the cyclone moves on the continental shelf along the edge of the pit dense water is pushed down at its leading edge while lighter water is pulled up at its tail while the shelf currents are stronger in the nh case the density anomaly peaks are higher in the hy case at a certain point these cascading events have a well defined periodicity as can be seen in the pulsing signal shown previously in fig 7 this occurs as the balance between the downslope pressure and the coriolis force is changed within the ekman layer tanaka and akitomo 2000 tanaka and akitomo 2000 explained the pulsing behavior of dw cascading as an alternation and compensation of the downslope force due to density deviation and the upslope pressure gradients obtained through geostrophic adjustment that piles up dw on the shelf break increasing again the pressure gradients due to density deviation this pulsing dynamics has been detected at mooring f though for the model it appears that the passage of the cascading dense water occurs south of the mooring as previously discussed the nh case accurately captures the periodicity of this event while the hy overestimates the period due to the slower passage of the cyclonic eddy along the slope edge this latter aspect could be related to the less dense water mass present on the shelf in the hy run compared with the nh run that would induce less energetic baroclinic instabilities over the slope fig 11 finally another process which can occur during the dw cascading is the generation of inertia gravity waves igw as the dw flows over the slope in fig 12 we show snapshots from the nh simulation of the vertical velocity at a depth of 13 m from the surface where an igw is generated at the edge of the cyclonic vorticity structure as it moves along the continental shelf we do not see these waves in the hy simulation though they are generally difficult to detect given the overall weakness of the vertical velocity field igw generation was also seen in magaldi and haine 2015 where they also found that they are more accurately captured using a nh model further work is needed to understand better how these waves interact and influence the wider cascading dynamics 5 conclusions this work presented a modeling study with the aim of reproducing the propagation of dw along the continental slope and the related cascading events in particular we focused on how the inclusion of nonhydrostatic processes affects the dw dynamics therefore we developed a new nh version of the shyfem model and validated it for two theoretical test cases this model was then applied to reproduce dw evolution in the adriatic sea specifically considering a particular event that occurred in the winter spring of 2012 for which in situ measurements were available the model was run both in hydrostatic and nonhydrostatic configurations in order to understand the influence of nh processes on the dw dynamics the application of the model to the adriatic sea poses a number of practical issues as this problem requires numerous accurate forcings surface fluxes and river inputs as well as an adequate resolution of the complex bottom morphology it is an extremely challenging problem for the reproduction of the dw evolution in the southern adriatic sea and its dynamics along the slope and the canyon systems a major difficulty was to simulate the small scale processes we were interested in while trying to fully match the general circulation patterns driving them some mismatches between both the model simulations and the observations were seen particularly in temperature this is probably connected to uncertainties in the forcings and boundary conditions mckiver et al 2016 subsequently small errors in the thermohaline circulation reproduction can interact and provide feedbacks also on the reproduced small scale dynamics along the coast and on the slope another point that affects the simulated dynamics is the choice of model resolution here we use a finite element grid with the highest resolution applied at the coastal areas and along the slopes of the south adriatic pit however it is still an open question just what is the appropriate horizontal and vertical resolution needed to fully capture these processes despite the limits of the modeling implementations overall the model results and the in situ measurements ctd casts are in good agreement with the nh model performing better than the hy run the nh run captures correctly the across isobaths gravity current characterizing the canyon dw pathways the nh run more accurately reproduces also the pulsing cascading events of dw that occur in mooring f this process is not specifically driven by the presence of nh dynamics as it does occur also in the hy simulation however the period of oscillation seen in the hy case is much longer than the observed value this is due to the differences in both the dw mixing and the currents because of the lack of nh dynamics as stated in the work of magaldi and haine 2015 the inclusion of nh dynamics can give rise to the generation of more inertial gravity waves igw along the shelf as the cyclonic vorticity evolves these waves need the full nh vertical velocity field in order to accurately propagate possibly giving rise to increased mixing downslope away from the continental shelf the nh run simulates more igw activity that is not captured in the hy case overall in this study we find that including nh processes gives an improvement in the modeled dynamics of specific dense water events namely the propagation along the continental slope and cascading clearly nh processes play an important role in the transfer of energy between the shallow coastal areas and the deep sea however there is still much work to be done to fully assess the importance of nh processes for modeling the wider ocean circulation such an assessment is limited not only by a lack of in situ measurements but also because applying a nh model has a much greater computational cost than a hy model thus more work must be done to improve the efficiency of such models in order to make them a more viable tool for describing the general ocean circulation acknowledgments this work is partially funded by ritmare flagship project national research programme italian ministry of university and research odw2012 campaign was partially supported by coconet grant agreement no 287844 of the european commission and the flagship project ritmare the authors want to acknowledge cnr isac for the provision of meteorological forcings 
24112,dense water dw formation commonly occurs in the shallow northern adriatic sea during winter outbreaks when there is a combination of the cooling of surface waters by the winds and high salinity as a result of reduced river inputs these dws subsequently propagate southwards over a period of weeks months eventually arriving in the southern adriatic sea the investigation is based on a new nonhydrostatic nh formulation of the 3d finite element model shyfem that is validated for a number of theoretical test cases subsequently this model is used to simulate through high resolution numerical simulations an extreme dw event that occurred in the adriatic sea in 2012 we perform both hydrostatic hy and nh simulations in order to explicitly see the impact of nh processes on the dw dynamics the modeled results are compared to observations collected in the field campaign of march april 2012 in the southern adriatic sea the nh run correctly reproduces the across isobath bottom trapped gravity current characterizing the canyon dw pathways it also more accurately captures the frequency and intensity of dense water cascading pulsing events as the inclusion of nh processes produces stronger currents with different dw mixing characteristics finally the nh run simulates internal gravity waves igw generated during the cascading at the edge of the canyon which propagate downslope this igw activity is not captured in the hy case keywords dense water nonhydrostatic process finite element model southern adriatic sea submarine canyon 1 introduction dense water dw produced on the continental shelf and its propagation to the deep ocean via a bottom trapped gravity current have been widely studied ivanov et al 2004 not only because of its role in exchanging water masses with different properties between the shelf and the deep ocean but also because the cascading dynamics can influence the thermohaline circulation in the ocean özgökmen et al 2006 herrmann et al 2008 thus these currents have a role to play in the climate system herrmann et al 2008 dw on the continental shelf can be generated by a number of factors such as cooling evaporation over precipitation salinization or surface layer freezing once formed the dw can sink to the bottom and propagate flowing geostrophically along isobaths if this geostrophic balance is broken dw masses can flow down the slope across isobaths and this process is called cascading i e in submarine canyons trincardi et al 2007 canals et al 2006 this process occurs in many areas like the eastern greenland shelf magaldi and haine 2015 the antarctic tanaka and akitomo 2000 and the mediterranean shelf slope borders gulf of lion salat et al 2010 adriatic sea bergamasco et al 1999 langone et al 2016 mihanović et al 2013 chiggiato et al 2016 aegean sea vervatis et al 2011 there have been many studies to determine the main characteristics shape and dynamics of dw flows wåhlin and walin 2001 in the mediterranean sea canals et al 2006 highlighted the importance of dw flows in transporting sediment loads from the shelf to the slope contributing to the excavation of the typical canyon structure seen in the gulf of lions dws are seen as a transport mean for sediments and organic matter shaping the sea floor as well as bringing nutrients to the deep ecosystems canals et al 2006 turchetto et al 2007 and trincardi et al 2007 studied the bari canyon system southern adriatic sea finding evidence that identify preferential pathways for sediment fluxes in correspondence with dw events that are modulated by pulsating behavior a general assumption is that energy transfer and balance are driving the definition of dw pathways and water transport dw events can be detected by measurements though their unsteady nature makes these phenomena extremely challenging to be fully captured temporally and spatially measurements have shown that the cascading process occurs once a specific energetic threshold is reached breaking the geostrophic balance and allowing the prevailing effects of secondary forcings that make the bottom plume pulsing with the plume then being modified by entraining dynamics with surrounding waters wang et al 2003 wåhlin and walin 2001 shapiro and hill 1997 there are also many modeling applications in idealized environments investigating the formation and occurrence of dw plumes and their interaction with the surrounding water masses several simplified models based on specific processes were implemented and compared with evidence from laboratory experiments for example wobus et al 2011 simulated dw cascading using the model polcom reproducing a laboratory experiment of dw on a steep slope using a rotating turntable they concluded that hy models can reproduce the main features of the bottom layer dynamics shapiro and hill 1997 proposed a simplified 1 1 2 layer model which showed the importance of vertical mixing to enhance the downslope propagation of dw plumes while also clarifying how bottom friction plays a major role for thin dw plumes wang et al 2003 considered a two layer reduced gravity model to identify different behaviors for dw flows with thicknesses below or above the bottom ekman layer the former is mainly influenced by bottom ekman veering that allows cross isobath pathways while the latter is affected by geostrophy superimposed to cycloidal inertial oscillations however in this work no entrainment of the bottom trapped gravity current was considered a certain number of studies on limited size domains were conducted with fully nonhydrostatic nh models for example tanaka and akitomo 2000 found that the alternation of upward and downward flows at the shelf break leads to intensified mixing processes they identified bottom friction seafloor features and the evolution of instabilities as factors modulating the breakdown of geostrophic balance that leads to downslope dw flows moreover tanaka and akitomo 2001 linked the baroclinic instability of a flow to the slope steepness on gentle slopes unstable eddies are present over the whole slope limiting the downslope flow on steeper slopes these eddies are confined to the upper part of the slope causing downslope transport to be enhanced finally spurgin and allen 2014 investigated the dynamics in the proximity of bottom features like canyons identifying them as enhancing factors for downward advection of dw flows with evidence of a general upwelling dynamics in the areas outside the canyons much less information is available on the modeling characterization of nh processes in dw dynamics in real ocean environments due to the numerical cost needed to fully implement a model at the adequate temporal and spatial scales needed at the basin scale from an operational point of view there is the need to model the regional or global circulation considering the contribution of dw flows these models are generally hydrostatic a full review can be found in legg et al 2009 and reference therein where solutions for including dw effects were provided with improved parameterizations for reproducing vertical mixing also mixing parameterizations or new approaches in dealing with horizontal and vertical discretization were investigated legg et al 2006 ezer and mellor 2004 however these model implementations even if correctly providing thermohaline changes due to dw and improving water masses reproduction did not deal with the full physical modeling of the connected nh processes such as dw cascading magaldi and haine 2015 investigated the effects of nh formulation on the capability of reproducing dw cascading processes off the east greenland shelf their work suggests a central role of nh processes in transferring energy from the continental slope to the deep ocean when a breakdown in geostrophic balance occurs with a subsequent generation of internal gravity waves in this study we consider the importance of including nh processes for modeling dense water dynamics focusing on a particular event that occurred in the adriatic sea during the winter of 2012 an extraordinarily large amount of dw around 0 55 sv as a lower estimate was formed in the northern adriatic sea and propagated as a bottom trapped gravity current within a couple of months it reached the southern part of the basin where cascading occurred mihanović et al 2013 two main pathways of dw were identified south of the mid adriatic pit also called jabuka pit fig 1 with dw veins seen between 50 and 100 m benetazzo et al 2014 measurements downhill with respect to the so called canyon b within the bari canyon system fig 1 showed that the dw vein follows the preferential pathway driven by the morphology decreasing its thickness and detaching from the bottom chiggiato et al 2016 the observed dw tongue flowed at the bottom with measured velocity reaching 40 cm s 1 and its thickness was progressively increased due to entrainment with thermohaline modification of water chiggiato et al 2016 cascading dynamics is not representative only of the canyon area other pathways were identified like the gondola slide fig 1 and the north eastern border of the south adriatic pit there modified dw that already experienced mixing with older waters in the mid adriatic pit with thinner tongues and a pulsing behavior at sub inertial frequency overflowed the sill chiggiato et al 2016 several different modeling studies of this dw event were carried out benetazzo et al 2014 used the roms model reproducing current wave interaction stating the importance of river discharge and coastal wave effects for shelf dw modulation carniel et al 2016 made a sensitivity analysis identifying the importance also of sediment transport modeling for dw reproduction in these two works the dynamics was investigated with a horizontal resolution of 1 km and with a maximum bottom layer thickness of 15 m which was considered enough to identify the bottom dw vein these two implementations assumed that nh processes were of minor importance in dw formation and propagation while a study by mckiver et al 2016 has shown that nh processes play no role in the dw formation in the northern adriatic sea the present work aims at evaluating their importance for the south adriatic dw propagation and subsequent cascading events to this end a new nh version of the shyfem model is developed and tested it is then applied to study the dw event of winter 2012 where we perform both hydrostatic hy and nh simulations in order to quantify the relative importance of nh processes for the reproduction of dw evolution and cascading in section 2 we introduce the nh shyfem model presenting the equations and the numerical approach to solve them followed by a validation of the model using well known test cases in section 3 we describe the winter 2012 dw event summarizing the observations used then describing the model setup followed by a comparison of the model simulations and observations in section 4 we describe and discuss the dw and cascading characteristics reproduced in the two simulations outlining the impact of the inclusion of nh dynamics 2 nonhydrostatic shyfem shyfem is a finite element hydrodynamic model originally developed to solve the shallow water equations umgiesser et al 2004 though more recently updated for the 3d primitive equations bellafiore and umgiesser 2010 and applied for a preliminary investigation of dw dynamics in the northern adriatic sea mckiver et al 2016 here we outline the recent development of the nh version of shyfem previous implementations of shyfem assumed hydrostatic balance where there is a balance between the vertical gradient of pressure and buoyancy this assumption vastly simplifies the equations by removing the vertical momentum equation as the vertical acceleration can be neglected in the nh case the vertical momentum equation must be included to solve for the vertical acceleration and velocity and also the nh pressure must be solved through the solution of a 3d poisson equation the nh equations are relevant in flows where there is strong vertical acceleration 2 1 equations of motion the equations of motion for an incompressible boussinesq flow comprise the equations of momentum balance 1a u t u u x v u y w u z f v p x ν h 2 u x 2 2 u y 2 ν v 2 u z 2 1b v t u v x v v y w v z f u p y ν h 2 v x 2 2 v y 2 ν v 2 v z 2 1c w t u w x v w y w w z p z g ν h 2 w x 2 2 w y 2 ν v 2 w z 2 as well as the continuity equation 2 u x v y w z 0 where u v w are the three dimensional velocity field components p is the normalized pressure defined as the pressure divided by ρ 0 where ρ 0 is the constant background density f is the coriolis parameter νh and νv are the horizontal and vertical viscosity coefficients respectively and g is gravity the vertical integration over the water column of the continuity equation provides an equation for the water level ζ at the free surface 3 ζ t x h ζ u d z y h ζ v d z 0 where h is the undisturbed water depth the normalized pressure is subdivided into a hy and nh component i e p π q where π is the hy component which incorporates the barotropic and baroclinic pressure terms i e 4 π g ζ z g ρ 0 z ζ ρ z d z and q is the nh pressure 2 2 solution method the shyfem model bellafiore and umgiesser 2010 umgiesser et al 2004 uses a finite element discretization of the domain in the horizontal while the vertical water column is discretized into nl layers of thickness hl the full nh equations are solved following the two step approach of casulli 1999 see also casulli and zanolli 2002 whereby in the first step only the hy equations are solved followed by a second step where the nh pressure is computed and then used to correct the hy fields to solve the equations of motion we apply a semi implicit treatment of certain time dependent variables given by 5 x α x n 1 α x n where x represents the time dependent variable α 1 α and the superscripts n and n 1 represent the value at the current and next time step respectively the weighting parameter α is in the interval 0 to 1 where a value of 0 means fully explicit treatment whereas 1 implies a fully implicit treatment the horizontal advective and viscosity terms in the momentum equations are treated fully explicitly while the vertical component of viscosity in the momentum equations is treated fully implicitly the horizontal divergence term in the continuity equation is treated semi implicitly with weighting parameter αz i e 6 α z u x n 1 v y n 1 α z u x n v y n w z n 1 0 which leads to similar treatment in the equation for the water level at the free surface i e 7 ζ t α z x h ζ u n 1 d z y h ζ v n 1 d z α z x h ζ u n d z y h ζ v n d z 0 also the coriolis term and the hy and nh pressure gradient terms in the momentum equations are treated semi implicitly their weighting parameters being denoted by αf αm and αq respectively for implementation the αz and αm parameters were set to 0 6 close to the semi implicit approach allowing some artificial damping for the gravity waves for stability reasons the coriolis term αf was set to 0 5 which is energy conserving for the rossby waves considering a forward differencing step for time derivatives and discretizing the domain into nl layers of thickness hl in the vertical we can write the momentum equations as 8a u l n 1 u l n δ t a d v l x f α f v l n 1 α f v l n α m π l x n 1 α m π l n x α q q l n x ν h 2 u l n x 2 2 u l n y 2 ν v 2 u l z 2 n 1 8b v l n 1 v l n δ t a d v l y f α f u l n 1 α f u l n α m π l y n 1 α m π l n y α q q l n y ν h 2 v l n x 2 2 v l n y 2 ν v 2 v l z 2 n 1 8c w l n 1 w l n δ t a d v l z α q q l n z ν h 2 w l n x 2 2 w l n y 2 ν v 2 w l z 2 n 1 where advx advy and advz are the advection terms for u v and w respectively which are treated explicitly all variables are evaluated at the center of the layer except the vertical velocity which is evaluated at the interface between layers in this case wl and w l 1 refer to the bottom and top interface of layer l respectively and w 0 is the vertical velocity at the surface we use x n 1 to denote that these variables are only the intermediate solutions i e the hydrostatic step at this stage the unknown nh pressure at time step n 1 has been neglected and will be considered only at the next nh step the second step that applies the nh correction is given by 9a u l n 1 u l n 1 α q δ t q l x n 1 9b v l n 1 v l n 1 α q δ t q l y n 1 9c w l n 1 w l n 1 α q δ t q z n 1 l where in eq 9c the brackets indicate the derivative at the layer interface i e 10 q z n 1 l q l 1 n 1 q l n 1 δ z where δ z h l 1 h l 2 in order to implement the second step we must first solve for the nh pressure to obtain an equation for the nh pressure we begin with the continuity equation eq 6 in shyfem this equation is discretized as 11 α z u l x n 1 v l y n 1 α z u l x n v l y n w l 1 n 1 w l n 1 0 where u and v are the horizontal transport components defined as ul hlul and vl hlvl this holds for all the layers below the surface 2 l n to derive an equation for the surface we use eq 3 in its discretized form which reads 12 ζ n 1 ζ n δ t l 1 n α z u l x n 1 v l y n 1 α z u l n x v l n y 0 inserting eq 11 from layers 2 to n we obtain assuming that the vertical bottom velocity wn is zero 13 ζ n 1 ζ n δ t α z u 1 x n 1 v 1 y n 1 α z u 1 n x v 1 n y w 1 n 1 0 to solve this equation we assume that the pressure is hydrostatic in the surface layer casulli 1999 thus we can write 14 p 1 n 1 g ζ n 1 z 1 g ζ n 1 z 1 q 1 n 1 leading to 15 ζ n 1 ζ n 1 q 1 n 1 g using this in the integrated continuity eq 13 as well as the equations for the nh correction eq 9 it can be shown casulli 1999 that at the free surface l 1 we have 16 h 1 α q δ t α z 2 q 1 x 2 n 1 2 q 1 y 2 n 1 α q δ t q z n 1 1 q 1 g δ t α z u 1 x n 1 v 1 y n 1 α z u 1 n x v 1 n y ζ n 1 ζ n δ t w 1 n 1 the equation for the layers below the surface is obtained by substituting eq 9 into eq 11 giving 17 h l α q δ t α z 2 q l x 2 n 1 2 q l y 2 n 1 α q δ t q z n 1 l 1 q z n 1 l α z u l x n 1 v l y n 1 α z u l n x v l n y w l 1 n 1 w l n 1 eqs 16 and 17 represent a poisson equation that must be solved for all nodes and over all vertical layers these equations can be represented as a linear matrix system a x b which can be solved using iterative sparse matrix solvers once solved the final velocity fields and water level are obtained from eqs 9 and 15 respectively the final nh pressure is obtained from 18 q l n 1 q l n 1 q 1 n 1 in order to stabilize the poisson system the parameter αq was chosen to be fully implicit 1 0 as also recommended in casulli 1999 and casulli and zanolli 2002 in order to take into account the full contribution of the nh terms to the hydrodynamics the new shyfem version has to exclude the automatic correction for the vertical turbulence term as computed by the gotm k ϵ turbulence closure burchard et al 1999 burchard and bolding 2001 this scheme previously used in shyfem was meant to re stabilize the water column through an artificial increase in vertical viscosity in areas with unstable stratification this correction applied in the hy version of the code helps to avoid instabilities while if not excluded in the nh version it could counteract the vertical dynamics due to nh processes particularly enhanced along an unstably stratified water column being interested in reproducing the vertical processes in a realistic way allowing the development of unstable stratification the nh formulation leaves the mixing to the vertical acceleration terms while the above mentioned correction could lead to fictionally increased local mixing in the hy run the new nh formulation of the shyfem code has a computational cost on average 4 times longer than the hy version therefore it is presently suitable for process studies while requiring further development to be applied for operational purposes 2 3 test simulations of nh shyfem for our first test of the nh model we considered a standing wave in a deep basin the square basin has length l 10 m and depth h 10 m initially the velocity is zero while the initial free surface elevation is given by 19 ζ x ζ 0 cos k x 0 x l where k π l and the initial amplitude is taken as ζ 0 0 1 from the theory of small amplitude waves the frequency ω of the resulting wave is approximated by the positive root of ω 2 g k tanh k h the finite element grid used is made of 205 nodes and 320 elements with 100 vertical z layers 5 cm thick each hy and nh runs were performed with a 0 01 s time step fig 2 shows the surface water level at both ends of the basin x 0 m and x 10 m comparing the analytical solution with the modeled ones the hydrostatic model s inability to capture the evolution is evident whereas the nh model well reproduces the standing wave pointing to the need to include nonhydrostatic dynamics to reproduce this process as a second test of the model we consider the classical lock exchange experiment which requires the nh terms in the equations of motion in order to fully capture its dynamics shin et al 2004 in the lock exchange experiment a rectangular tank is filled with two fluids of different density that are initially separated by a thin barrier when the barrier is removed the heavy fluid begins to flow as a gravity current along the bottom of the tank while at the same time the lighter fluid form a current moving in the opposite direction at the surface for our test we apply the same configuration of lai et al 2010 the tank has a length of 0 8 m a width of 0 008 m and a depth of 0 1 m we take the light fluid to be freshwater while the heavy fluid is salt water with a salinity of 1 3592 the finite element numerical grid has 6400 triangular elements of the same size having 3909 nodes with 100 z layers in the vertical in fig 3 we show snapshots of the density field from simulations comparing the hy and nh runs in the case of a hy flow the front of these gravity currents has a sharp flat shape which is not observed in nature in the nh case the fronts are curved and eventually develop kelvin helmholtz instabilities at the interface of the two fluids when the velocity shear between them is strong enough the unrealistic dynamics seen in the hy case is due to the removal of a mechanism of energy transfer between the vertical and horizontal direction because the hydrostatic approximation defines the vertical velocity through the equation of continuity berntsen et al 2006 only with the inclusion of the nh pressure it is possible to obtain the real dynamics observed in experiments 3 the adriatic sea dw event of 2012 here we focus on a dw event that occurred in the winter of 2012 in the adriatic sea during the period january february there was a massive generation of dw in the northern adriatic sea with record breaking density anomalies of above 5 kg m 3 relative to a value of 1025 kg m 3 mihanović et al 2013 this event occurred after a particularly warm and dry year resulting in a reduction of coastal freshwater supply in the backdrop of an already long term trend of increasing salinity the event was then triggered by an extended period of cold weather with strong bora winds in the coastal north eastern adriatic region that lasted for about three weeks between the 25th of january and the 14th of february 2012 mihanović et al 2013 after its generation the dw quickly sank and became a bottom trapped gravity current which propagated southwards along isobaths of the italian continental shelf two months later it arrived in the southern adriatic sea where dense water cascading was observed chiggiato et al 2016 3 1 observational data a large dataset of observations is available from operation dense water odw campaigns carried out in march april 2012 ctd sbe 911 plus probes and moorings are exploited here for model validation purposes the whole set of data is fully described in chiggiato et al 2016 and here we outline only the measurements which are most relevant for our purposes ctd profiles were collected in two cruises in the southern adriatic sea between the 23th of march and the 20th of april 2012 particularly in the first leg the 60 ctd profiles gave precise details about the presence of dw and are therefore used for the model validation black dots in fig 1a data during the dw event were collected within the first 100 m above the bottom by five mooring chains equipped with temperature and salinity sensors and acoustic doppler current profilers adcp their locations are indicated as red dots in fig 1b moorings b c located within the bari canyon systems and f are the ones where dw were detected in a sloping environment which is central for inferring about the nh processes occurring during cascading therefore these are the ones used in the next section for validation purposes and the characterization of dw event 3 2 model setup using as a basis the previous shyfem implementation in the adriatic sea discussed in mckiver et al 2016 new simulations hy and nh were set up in order to reproduce the dw event of 2012 a new finite element grid was created fig 1 the grid covers the whole adriatic sea up to the otranto strait where the open sea boundary is set and consists of 35 203 nodes and 68 267 elements horizontal resolution is variable over the domain and reaches 50 100 m in both the coastal area and the southern adriatic sea in the area comprising the bari canyon system the water column is discretized with 100 z layers having increasing thickness from 1 m at the surface to 17 m near the bottom considered suitable for dw bottom flow reproduction and comparable with previous works mckiver et al 2016 benetazzo et al 2014 carniel et al 2016 an up to date bathymetry is used that comprises a merge of data from nurc nato undersea research centre provided within the adria 02 framework and by ismar cnr institute of marine science national research council within the last few years in the northern adriatic sea and in the proximity of the bari canyon southern adriatic sea the system is initiated with water levels set to the mean sea level and 3d temperature and salinity fields from daily mean 2 km horizontal resolution afs adriatic forecasting system data the same dataset is used to force the system laterally at the open boundary of the otranto strait at the same open boundary water levels tides and surge are imposed with hourly time step from the otis osu tidal inversion software tidal model and afs sea surface height data the freshwater sources are treated as described in mckiver et al 2016 surface forcing for wind air pressure air temperature relative humidity and cloud cover are from the moloch modello locale in h coordinates model malguzzi et al 2006 ferrarin et al 2013 a complete description of datasets used to force the present simulations and the numerical schemes applied for computation is provided in mckiver et al 2016 unlike the previous implementation done by shyfem for the dw event of 2012 the present simulations use more vertical layers in order to properly match the bottom dynamics 3 3 model assessment from the 60 ctd casts acquired in the first leg of the cruise in the southern adriatic sea temperature salinity and potential density bias model measurements and root mean square error rmse were computed for the hy and the nh runs the results shown in fig 4 indicate that salinity bias is negative for both simulations with lower values in the surface 100 m 0 2 on average the nh run has a smaller bias 0 05 over the water column than the hy run 0 1 overall both simulations match fairly well the salinity average behavior only having small differences within tenths of a unit also the salinity rmse reveals the higher spatial variability of the signal in the upper 100 m with a higher error found in the hy run with respect to the nh case this discrepancy in the upper 100 m is present also for the temperature and potential density fields both runs underestimate temperature in the thermocline with similar behavior both in terms of bias and rmse however major differences between the two simulations occur between 300 m and 800 m depth where the nh run matches very well with the measurements having a rmse within 0 2 c the two runs show opposite sign biases at the deepest levels being positive and negative for the nh and hy cases respectively it should be noted that only a few ctd casts reach the lowest depths therefore also the corresponding statistics are less significant just to give an idea of the statistical relevance less than 15 of ctd casts reach depths below 600 m in the depth range 300 800 m the nh rmse is half that of the corresponding hy one then increasing below 900 m to 0 3 c the tendencies for salinity and temperature identify the nh model capability to better reproduce potential density profiles from the surface down to 800 m with a lower bias and lower rmse as an average not higher than 0 05 kg m 3 on the other hand the nh run shows a more negative bias and larger rmse below that depth 4 ctd casts on 60 in order to investigate the horizontal shape of the dw plume we consider sections of the salinity temperature and potential density anomaly defined as the density difference with respect to the density of sea water at the surface 1025 kg m 3 along the transects a and b figs 5 and 6 respectively which were investigated during the field campaign of march april 2012 chiggiato et al 2016 described the dw vein in transect a as being 20 30 m thick with two local maxima around 100 m and 130 m depth see fig 5d where the plume is expected to be in geostrophic balance they also found another local maximum detected at depth 180 m and representing an across isobath dw flow fig 5d they deduced the characteristics of the dw vein from a temperature section identifying as part of the vein the water with temperature lower than 13 c from fig 5e the hy case has a dw vein with peak values at 100 130 m more evident in the temperature section if just temperature is analyzed the second peak at 180 m depth seems not to be matched by either the hy or nh runs however looking at the density section fig 5i the nh run has the second density peak at 180 m values above 1029 2 kg m 3 and represents a cross isobath descending flow with dw having slightly different thermohaline characteristics a small area of higher salinity fig 5 that suggests possible entrainment of surrounding water the second dw core is not reproduced by the hy run due to the presence of across isobaths dw flows there as mentioned in chiggiato et al 2016 that can only be reproduced by including nh processes in the formulation on the southernmost transect b the measurements detected a dw plume characterized by an asymmetrical behavior with a flat dw upper edge whilst the thickness of the dw tongue further offshore was diminished by the action of bottom friction their measurements also identified the highest potential density anomalies of the whole field campaign fig 6g in this transect the part of the dw tongue detected further offshore is strongly affected by the influence of open sea waters with higher salinity fig 6a for the model results shown in fig 6 the dw plume is more accurately reproduced by the nh run than the hy run having similar shape compared with measurements with a thicker bulb inshore which decreases in thickness moving further offshore also the influence of more salty offshore water is correctly captured by the nh run that has higher salinity at the 180 200 m depth isobath fig 6c in fig 7 we look at mooring time series of density anomaly a and c and current speed b and d collected during the dw spreading event in the two locations close to the bari canyon b and c see fig 1 and compare them to the hy and nh simulations the potential density anomaly is better reproduced by the nh model overall the nh reproduces better the variability in both locations whereas the hy density seems generally smoother less sensitive to the thermohaline variations connected with singular events of dw flow within the bari canyon over the whole monitored period the hy run potential density biases are 0 071 kg m3 and 0 011 kg m3 for b and c respectively nh run potential density biases are 0 067 kg m3 and 0 015 kg m3 for b and c both runs slightly overestimate potential density in canyon b and underestimate it in canyon c however looking at the speed reproduction both runs underestimate currents at mooring b the simulated velocities are never higher than 0 2 m s 1 for the nh run and 0 1 m s 1 for the hy run while measurements show peaks up to 0 6 m s 1 the simulation of current speed at mooring c is underestimated as well though two peak events are matched by the hy run the northernmost mooring f detected pulsing events of cascading on the slope with frequencies around 1 5 days these signals are evident in two wave trains of subsequent high current speed and density pulses at the end of march and in the first week of april 2012 fig 7e and f both the hy and nh runs seem not able to fully match these pulses in speed intensity the hy run seems to miss the signal completely while the nh run though underestimating the potential density and the corresponding speed is at least able to partially match the occurrence of the wave train measured at the beginning of april fig 7 analyzing the results we found that the pulsing process is reproduced by the nh run along a path slightly displaced spatially from the mooring f with a delay of about 3 5 days see fig 7 and supplementary material below to make this evident we plot in fig 7e and f red dashed curve also the nh potential density anomaly and speed time series extracted 5 km south east of the mooring f denoted f1 fig 1 and shifted by 3 5 days while the potential density anomaly values are quite similar to the ones extracted in mooring f there is an improvement in speeds almost reaching the same measured values the simulated dw flow which is generated in the northern adriatic sea and takes months to reach the study area has a time shift probably due to small errors in the reproduction of the general circulation possibly due to uncertainties or biases in temperature salinity or heat flux forcings to more clearly identify pulsing dw cascading we compute the single sided amplitude spectrum of current speed over the period of the pulsing dw trains fig 8 shows the comparison of measurements in f with results extracted in f1 from the hy and nh runs the pulses periodicity can be clearly detected from measurements frequency of 7 10 6 s 1 corresponding to a period of 1 65 days the nh run fairly matches the 7 10 6 s 1 frequency while the hy spectrum gives a less clear picture with an attenuated peak at the same frequency and additional peaks 4 dense water plume and cascading characteristics in this section we look at how the models capture specific characteristics of the dense water plume and the dense water cascading events in fig 9 we plot maps of bottom currents and potential density anomaly temporally averaged over the period in which dw was detected in the study area 9th of march 9th of april averaged bottom currents are less energetic along the italian coast in the hy run case with peak values not exceeding 0 3 m s 1 the most intense current pathways are seen at the slope border of the italian shelf following some morphologic structures like the dauno seamount the nh run shows intensified bottom currents along the italian coast flowing southward peak bottom velocities reach 0 4 m s 1 that even if lower than measured ones are more consistent with measurements than the hy case the nh run has intensified bottom current patterns slightly detached south of mooring f then developing along the dauno seamount this evidence suggests that the across isobath dw flow detected by measurements and not clearly seen from the modeled nh time series in mooring f fig 7 is not totally missed but just slightly shifted as already mentioned in the analysis of figs 7 and 8 above probably due to some discrepancies in the general circulation feature reproduction and in the representation of bottom morphology fig 9 a and b fig 9 shows also how the nh run has denser bottom waters spreading southward in larger veins generally the hy run reproduces dw with lower potential density anomaly values compared with the nh run the hy run identifies a dw vein with the same density seen from measurements values above 4 3 kg m3 as evident from ctd values in transect a and b figs 5 and 6 but it follows mainly along bathymetry pathways dw maintains its preferential pathway along shelf and dw spreads less along the shelf compared with the nh case fig 9 looking at the vorticity patterns integrated over the water column fig 9 bottom panels higher absolute values for the nh run along the whole border of the south adriatic pit are evident indicating stronger currents interestingly the major differences compared with the hy run are not only in the intensity of the vorticity but also in the patterns particularly following the isobaths close to the dauno seamount and in the bari canyon system south of mooring f the hy run simulates a core of positive vorticity along isobaths at the border of the slope this could be due to the main pathway of dw that is kept more on the shelf not breaking geostrophy for the nh run the same area shows lower vorticity that as is also evident from the bottom currents can be connected with flow more directed across isobath with lower lateral gradients moving south to the bari canyon system both the hy and nh runs simulate higher bottom speeds compared with the surrounding area chiggiato et al 2016 found the highest bottom speeds within canyon b also canyon c experiences intense fluxes but slightly lower than canyon b canyon b shows a bimodal distribution of current speeds one along the canyon main axis the other flowing southward probably overflowing the sill to reach the southernmost canyon c in the latter canyon the bottom current is directed mainly along the canyon major axis trincardi et al 2007 investigated the bottom forms along the two canyons and hypothesized that part of the dw flow in the deepest segment of b canyon could enter the deepest part of canyon c enhancing the turbidity and increasing the hydrodynamics and consequently the morphodynamics of this area both the hy and nh modeled bottom currents shown in fig 9 identify the features connected with the morphological shape of the two canyons the hy run shows particularly for canyon b a major flux along isobaths crossing the major axis of canyon b and a convergence of water to canyon c the nh run matches the portion of flux that as hypothesized by trincardi et al 2007 overflows from canyon b to canyon c but is also able to reproduce the along axis flux even if velocities are underestimated compared with measurements fig 10 looking at the bottom potential density anomaly in the bari canyon around moorings b and c the isolines crossing the canyons in the case of the hy run reveal how there is not a defined pathway for higher density water in the area fig 10 on the contrary the isolines shape for the nh run show how much denser water is flowing through the canyons crossing isobaths in canyon c particularly nh run reproduces a uniform pattern of denser waters 4 1 kg m 3 along the whole canyon crossing isobaths and suggesting a bottom trapped gravity current fig 10 black box this feature observed in the field is probably caused by the vertical acceleration within the canyons that can only be reproduced with the inclusion of nh processes in the map of vorticity for the hy run there is a major bulb of cyclonic vorticity with a thin tongue of anti cyclonic vorticity just at the southern edge of canyon c the hy model has weaker velocities downhill and stronger along isobath flows compared with measurements giving rise to a less realistic vorticity pattern the nh run has areas of convergence that increase the downward flow at the southern edge of each canyon probably representing the main pathway of cascading flow the cyclonic vorticity close to the canyon c mooring could counteract the downhill flow in the last part of the canyon and could justify the lower velocities measured there by the mooring compared with the other canyon chiggiato et al 2016 in order to characterize the cascading dynamics occurring in the two simulations in fig 11 we plot the time evolution of the bottom potential density anomaly and the vertically averaged vorticity during the pulsing cascading event around mooring f site dw cascading along the edge of the continental slope into the pit is seen in both the hy and nh cases this cascading process is associated with the passage of a patch of strong cyclonic vorticity vortices developed at the shelf border and increasing baroclinic instabilities magaldi and haine 2015 also described this dynamics as the cyclone moves on the continental shelf along the edge of the pit dense water is pushed down at its leading edge while lighter water is pulled up at its tail while the shelf currents are stronger in the nh case the density anomaly peaks are higher in the hy case at a certain point these cascading events have a well defined periodicity as can be seen in the pulsing signal shown previously in fig 7 this occurs as the balance between the downslope pressure and the coriolis force is changed within the ekman layer tanaka and akitomo 2000 tanaka and akitomo 2000 explained the pulsing behavior of dw cascading as an alternation and compensation of the downslope force due to density deviation and the upslope pressure gradients obtained through geostrophic adjustment that piles up dw on the shelf break increasing again the pressure gradients due to density deviation this pulsing dynamics has been detected at mooring f though for the model it appears that the passage of the cascading dense water occurs south of the mooring as previously discussed the nh case accurately captures the periodicity of this event while the hy overestimates the period due to the slower passage of the cyclonic eddy along the slope edge this latter aspect could be related to the less dense water mass present on the shelf in the hy run compared with the nh run that would induce less energetic baroclinic instabilities over the slope fig 11 finally another process which can occur during the dw cascading is the generation of inertia gravity waves igw as the dw flows over the slope in fig 12 we show snapshots from the nh simulation of the vertical velocity at a depth of 13 m from the surface where an igw is generated at the edge of the cyclonic vorticity structure as it moves along the continental shelf we do not see these waves in the hy simulation though they are generally difficult to detect given the overall weakness of the vertical velocity field igw generation was also seen in magaldi and haine 2015 where they also found that they are more accurately captured using a nh model further work is needed to understand better how these waves interact and influence the wider cascading dynamics 5 conclusions this work presented a modeling study with the aim of reproducing the propagation of dw along the continental slope and the related cascading events in particular we focused on how the inclusion of nonhydrostatic processes affects the dw dynamics therefore we developed a new nh version of the shyfem model and validated it for two theoretical test cases this model was then applied to reproduce dw evolution in the adriatic sea specifically considering a particular event that occurred in the winter spring of 2012 for which in situ measurements were available the model was run both in hydrostatic and nonhydrostatic configurations in order to understand the influence of nh processes on the dw dynamics the application of the model to the adriatic sea poses a number of practical issues as this problem requires numerous accurate forcings surface fluxes and river inputs as well as an adequate resolution of the complex bottom morphology it is an extremely challenging problem for the reproduction of the dw evolution in the southern adriatic sea and its dynamics along the slope and the canyon systems a major difficulty was to simulate the small scale processes we were interested in while trying to fully match the general circulation patterns driving them some mismatches between both the model simulations and the observations were seen particularly in temperature this is probably connected to uncertainties in the forcings and boundary conditions mckiver et al 2016 subsequently small errors in the thermohaline circulation reproduction can interact and provide feedbacks also on the reproduced small scale dynamics along the coast and on the slope another point that affects the simulated dynamics is the choice of model resolution here we use a finite element grid with the highest resolution applied at the coastal areas and along the slopes of the south adriatic pit however it is still an open question just what is the appropriate horizontal and vertical resolution needed to fully capture these processes despite the limits of the modeling implementations overall the model results and the in situ measurements ctd casts are in good agreement with the nh model performing better than the hy run the nh run captures correctly the across isobaths gravity current characterizing the canyon dw pathways the nh run more accurately reproduces also the pulsing cascading events of dw that occur in mooring f this process is not specifically driven by the presence of nh dynamics as it does occur also in the hy simulation however the period of oscillation seen in the hy case is much longer than the observed value this is due to the differences in both the dw mixing and the currents because of the lack of nh dynamics as stated in the work of magaldi and haine 2015 the inclusion of nh dynamics can give rise to the generation of more inertial gravity waves igw along the shelf as the cyclonic vorticity evolves these waves need the full nh vertical velocity field in order to accurately propagate possibly giving rise to increased mixing downslope away from the continental shelf the nh run simulates more igw activity that is not captured in the hy case overall in this study we find that including nh processes gives an improvement in the modeled dynamics of specific dense water events namely the propagation along the continental slope and cascading clearly nh processes play an important role in the transfer of energy between the shallow coastal areas and the deep sea however there is still much work to be done to fully assess the importance of nh processes for modeling the wider ocean circulation such an assessment is limited not only by a lack of in situ measurements but also because applying a nh model has a much greater computational cost than a hy model thus more work must be done to improve the efficiency of such models in order to make them a more viable tool for describing the general ocean circulation acknowledgments this work is partially funded by ritmare flagship project national research programme italian ministry of university and research odw2012 campaign was partially supported by coconet grant agreement no 287844 of the european commission and the flagship project ritmare the authors want to acknowledge cnr isac for the provision of meteorological forcings 
24113,this paper examines quasigeostrophic flows in an ocean that can be subdivided into an upper active layer al and a lower passive layer pl with the flow and density stratification mainly confined to the former under this assumption an asymptotic model is derived parameterizing the effect of the pl on the al the model depends only on the pl s depth whereas its väisälä brunt frequency turns out to be unimportant as long as it is small under an additional assumption that the potential vorticity field in the pl is well diffused and thus uniform the derived model reduces to a simple boundary condition this condition is to be applied at the al pl interface after which the pl can be excluded from consideration keywords mesoscale flows quasigeostrophic approximation stratification 1 introduction oceanic currents and density stratification are often confined to an upper active layer al of the ocean which does not however mean that the response of the lower passive layer pl can be neglected as a result a significant proportion of computer resources in numerical simulations has to be spent on the pl even if when nothing significant occurs there in the problem at hand the high cost of resolving the pl is not the only difficulty when modeling a layered ocean since little is known about the väisälä brunt frequency n in the ocean s deeper parts except that n is small modeling the pl poses problems even if one has resources for resolving it an additional difficulty arises when one uses the quasigeostrophic qg model which becomes singular in the limit n 0 to avoid all these problems many assume the väisälä brunt frequency to be constant which is however not the case near the al pl interface and thus may give rise to an error which is impossible to estimate in this work a model is presented parameterizing the effect of the passive layer on the active layer under the qg approximation the problem is formulated in section 2 solved asymptotically in section 3 and section 4 addresses the practical issue of how one can subdivide a continuously stratified ocean into an al and pl in section 5 the general asymptotic model is adapted for the case where the potential vorticity field in the pl is uniform 2 the governing equations consider a mesoscale flow in the ocean characterized by the coriolis parameter f and the väisälä brunt frequency n z where z is the vertical coordinate with x y and t being the horizontal coordinates and time let the flow be described by the qg equation for the stream function ψ for the applicability of the qg theory see pedlosky 1987 1 t 2 ψ z f 2 n 2 ψ z j ψ 2 ψ z f 2 n 2 ψ z 0 where the horizontal laplacian and jacobian are 2 ψ 2 ψ x 2 2 ψ y 2 j ψ q ψ x q y ψ y q x under the rigid lid approximation the boundary conditions at the ocean s surface and bottom are 2 2 ψ t z j ψ ψ z 0 at z 0 3 2 ψ t z j ψ ψ z 0 at z h where h is the ocean s depth 3 the analysis assume that the ocean can be subdivided into an active and passive layers of depths ha and h p h h a with the corresponding scales of the väisälä brunt frequency being such that na np introduce also the horizontal spatial scale l of the flow the same for both al and pl now two burger numbers can be introduced b u a n a 2 h a 2 f 2 l 2 b u p n p 2 h p 2 f 2 l 2 the only assumption used in this work is that bup is small 2 2 note that despite the smallness of bup which often signals that the qg approximation should be replaced with the frontal geostrophic one the deviation of the isopycnals in the pl is assumed small hence the qg still holds mainly due to the smallness of np whereas bua remains unrestricted the following derivation is straightforward so there is no need to nondimensionalize the governing equations if bup 1 the terms involving 1 n 2 dominate eq 1 in the pl so that the solution of 1 can be sought in the form of a series ψ ψ 0 ψ 1 for z h h a where ψ 1 ψ 0 o b u p and 4 2 t z f 2 n 2 ψ 0 z j ψ 0 z f 2 n 2 ψ 0 z 0 5 t 2 ψ 0 z f 2 n 2 ψ 1 z j ψ 1 z f 2 n 2 ψ 0 z j ψ 0 2 ψ 0 z f 2 n 2 ψ 1 z 0 note that a two layer beta plane equivalent of eq 4 has been previously derived by dewar and gailliard 1994 the boundary condition 3 in turn yields 6 2 ψ 0 t z j ψ 0 ψ 0 z 0 at z h 7 2 ψ 1 t z j ψ 0 ψ 1 z j ψ 1 ψ 0 z 0 at z h next to match the pl and al solutions one should require the continuity of the pressure and isopycnal displacement under the qg approximation this amounts to 8 ψ z h a 0 ψ z h a 0 f 2 n 2 ψ z z h a 0 f 2 n 2 ψ z z h a 0 since the pl part of the streamfunction is now subdivided into ψ 0 and ψ 1 8 should also be subdivided into two pairs of matching conditions for ψ 0 and ψ 1 9 ψ 0 z h a 0 ψ z h a 0 f 2 n 2 ψ 0 z z h a 0 0 10 ψ 1 z h a 0 0 f 2 n 2 ψ 1 z z h a 0 f 2 n 2 ψ z z h a 0 observe that the al pressure which can be large is matched to ψ 0 whereas the al isopycnal displacement which is relatively small as ha hp 1 is matched to ψ 1 this way the subdivided matching conditions are balanced i e involve terms of the same order it turns out that ψ 1 can be eliminated integrating eq 5 with respect to z from h to h a 0 and integrating by parts the terms that involve both ψ 0 and ψ 1 one can verify that the bulk integral terms involving ψ 1 cancel out and 5 becomes 11 t h h a 2 ψ 0 d z f 2 n 2 ψ 1 z z h a 0 f 2 n 2 ψ 1 z z h j ψ 0 f 2 n 2 ψ 1 z j ψ 1 f 2 n 2 ψ 0 z z h a 0 j ψ 0 f 2 n 2 ψ 1 z j ψ 1 f 2 n 2 ψ 0 z z h h h a j ψ 0 2 ψ 0 d z 0 now taking into account the boundary matching conditions 6 7 and 9 10 one obtains 12 t 2 h h a ψ 0 d z φ h h a j ψ 0 2 ψ 0 d z j ψ φ 0 where 13 ψ x y t ψ z h a 0 φ x y t f 2 n 2 ψ z z h a 0 the leading order solution ψ 0 in turn cannot be eliminated note however that the passive layer is not supposed to have independent dynamics but should be driven by the active layer i e the pressure field in the former ψ 0 should be fully determined by the pressure applied at the interface hence 14 ψ 0 ψ x y t subject to 14 eqs 4 and 6 are satisfied identically whereas 12 yields 15 t h p 2 ψ φ j ψ h p 2 ψ φ 0 note that letting ψ 0 be independent of z makes the pl flow barotropic but the isopycnal displacement determined by f 2 n 2 ψ 1 z does depend on z and is order one due to the presence of the factor 1 n 2 thus the complete governing set comprises 1 the al eqs 1 2 2 the pl eq 15 and 3 the matching conditions 13 where the 0 can be omitted 16 ψ ψ f 2 n 2 ψ z φ at z h a items 2 3 are the main results of this work note that an approximation similar to 15 16 has been derived by benilov 1995 for the particular case of normal modes in a baroclinic current the possibility of an extension to arbitrary qg flows however was overlooked 4 examples the asymptotic model developed above is valid when the ocean can be subdivided into an al and pl the real ocean however is continuously stratified with no clear cut inter layer boundary leaving us with a question what is the optimal choice for the al pl interface this issue is clarified below by applying the general model 15 16 to the example of baroclinic instability of a vertically sheared but horizontally uniform flow the asymptotic results for different values of ha are then compared to the exact solution it is convenient to nondimensionalize the problem by introducing n n d n n a x n d y n d x y l z n d z h t n d v 0 t l ψ n d ψ v 0 l where na is the maximum väisälä brunt frequency va is the maximum velocity and l h f n a rewriting the exact eqs 1 3 in terms of the non dimensional variables and omitting the subscript nd one obtains 17 t 2 ψ z 1 n 2 ψ z j ψ 2 ψ z 1 n 2 ψ z 0 18 2 ψ t z j ψ ψ z 0 at z 0 19 2 ψ t z j ψ ψ z 0 at z 1 next let ψ y v z ψ x z t where v z is the base flow and ψ is a small perturbation linearizing eqs 17 19 and letting ψ ψ z e i k x c t where k and c are the perturbation s wavenumber and phase speed one obtains 20 c v d d z 1 n 2 d ψ d z k 2 ψ ψ d d z 1 n 2 d v d z 0 21 c v d ψ d z d v d z ψ 0 if z 0 22 c v d ψ d z d v d z ψ 0 if z 1 repeating the same procedure linearization etc for the asymptotic equations 15 16 and eliminating ψ and φ one obtains 23 1 n 2 d ψ d z d p k 2 1 v c n 2 d v d z ψ if z d a where d a p h a p h condition 23 is the asymptotic alternative to the exact boundary condition 22 numerous examples of v z and n z have been examined yielding more or less the same results below are described those for 24 n 2 z 1 n p 2 2 tanh z δ n w n 1 n p 2 where n p n p n a and δn and wn are the non dimensional depth and width of the transitional region between the main thermocline and the weakly stratified part of the ocean the seasonal thermocline is neglected assuming that the main thermocline is 800 m deep and the transitional region is about two times thinner see for example pedlosky 1987 fig 1 3 1 then recalling that the ocean s mean depth is 4 km and finally choosing a small value for np on a more or less ad hoc basis one obtains 25 δ n 0 25 w n 0 3 n p 0 1 the following velocity profile will be assumed 26 v z sech z δ v where δv is the flow s penetration depth the following two examples have been examined a thin flow confined to the thermocline and a thick one partly penetrating the weakly stratified part of the ocean 27 thin flow δ v 0 07 thick flow δ v 0 12 n z and both versions of v z are shown in fig 1 the corresponding slope ηy z of isopycnal surfaces and the horizontal gradient qy z of potential vorticity pv η y 1 n 2 d v d z q y d d z 1 n 2 d v d z are plotted in fig 2 observe that for both examples of v z the isopycnal displacement penetrates noticeably deeper than the flow and stratification themselves the solution of the exact eigenvalue problem 20 22 and that of the asymptotic problem 20 21 23 were computed using the shooting method to avoid the singularity arising in neutrally stable cases eq 20 was integrated along a path in the complex z plane bypassing the critical level for more details see boyd 1985 benilov and sakov 1999 for all values of the wavenumber k no more than one unstable k im c 0 eigenvalue has been found for both exact and asymptotic problems in figs 3 and 4 the asymptotic phase speed re c and growth rate k im c are compared to the corresponding exact results as one might expect a sufficiently accurate asymptotic model for the thick flow turned out to require a larger da than that for the thin one less expectedly the two flows turned out to differ in how the asymptotic model s accuracy improves with growing da for the thick flow it does so gradually but for the thin one the solution becomes accurate abruptly as soon as da passes a threshold of 0 3 to understand why the value of d a 0 3 is special note that the al pl interface in this case is located just below the level of the extreme pv gradient see fig 2 b more broadly numerous examples of thin flows have been examined and the following conclusions have been drawn if for a certain choice of da the al does not include the extremum of qy z the accuracy of the asymptotic model in application to a thin flow is poor if da is large enough for the al to include the extremum of qy z the asymptotic model is sufficiently accurate despite the fact that the al may still not include the decaying portion of qy z and the maximum of the isopycnal slope ηy z see fig 2 in the latter case there is no point in increasing da beyond this threshold as this results in wasting computational resources on a minor accuracy improvement for thick flows in turn the following rule of thumb has been established the inter layer boundary can be drawn below the deepest extremum of the pv gradient qy at the depth where qy has decayed by a factor of 3 by comparison with that extremum the same rule would work for thin flows as well but it would not deliver the optimal choice in this case finally fig 5 illustrates the potential dangers of an often used approach consisting in assuming n z to be constant in the whole ocean i e ignoring the pl for thick flows it produces noticeably less fitting results than those obtained through the asymptotic model proposed for thin flows in turn the two approaches produce similar results but the asymptotic one is still cheaper computationally 5 a reduced asymptotic model observe that the asymptotic eq 15 is satisfied if 28 φ h p 2 ψ reduction 28 implies that the pv anomaly in the pl is zero i e the pv field itself is well diffused which it indeed is in the deep ocean unless up or down welling has recently occurred substituting 28 into 16 and eliminating ψ one obtains 29 f 2 n 2 ψ z h p 2 ψ if z h a now one can exclude the pl from consideration and solve the self contained boundary value problem 1 2 29 for the al note also that the boundary condition 29 imposes a constraint on the allowable initial condition consider for example a vertically sheared but horizontally homogeneous flow described by ψ y v z which expression satisfies 29 only if d v d z 0 at z h a another example is the so called columnar vortices e g dritschel and de la torre juárez 1996 in this case ψ ψ r which satisfies 29 only if ψ r unrestricted solid body rotation which is meaningless physically in both cases the constraint originates from the requirement of uniform potential vorticity in the pl used to obtain the boundary condition 29 still despite the constraint the boundary condition 29 has important physical applications e g near surface oceanic vortices which are both abundant in the ocean and crucial for its dynamics olson 1991 chelton et al 2011 at the same time the pv field beneath such vortices can indeed be conjectured to be uniform benilov 2004 benilov and flanagan 2008 in addition a lot of work has been done on vortices submerged in a fluid with uniform pv e g dritschel et al 2005 and 29 would be useful for extending these results to the real ocean conditions involving a passive layer it should be emphasized that the general model 15 16 does not impose any constraints on the al initial condition 6 summary and concluding remarks thus two models parameterizing the ocean s passive layer have been derived the general model 15 16 and the reduced model 29 assuming that the pv field in the passive layer is uniform the latter is particular simple as it allows to fully exclude the passive layer from consideration the former model in turn implies solving a partial differential equation for the passive layer which however involves only horizontal spatial variables and thus is much simpler than the original three dimensional qg equation in both models one still has to compute the solution in the active layer but this is of course cheaper than solving the qg equation in the whole domain in order to subdivide the real continuously stratified ocean into an al and pl the following rule of thumb has been established the passive layer can be assumed to begin at the depth where the horizontal pv gradient has decayed by a factor of 3 by comparison with its deepest extremum this typically implies a reduction of the computational domain at least by 50 and sometimes by up to 70 acknowledgments the author acknowledges the support of the science foundation ireland grant no 12 ia 1683 
24113,this paper examines quasigeostrophic flows in an ocean that can be subdivided into an upper active layer al and a lower passive layer pl with the flow and density stratification mainly confined to the former under this assumption an asymptotic model is derived parameterizing the effect of the pl on the al the model depends only on the pl s depth whereas its väisälä brunt frequency turns out to be unimportant as long as it is small under an additional assumption that the potential vorticity field in the pl is well diffused and thus uniform the derived model reduces to a simple boundary condition this condition is to be applied at the al pl interface after which the pl can be excluded from consideration keywords mesoscale flows quasigeostrophic approximation stratification 1 introduction oceanic currents and density stratification are often confined to an upper active layer al of the ocean which does not however mean that the response of the lower passive layer pl can be neglected as a result a significant proportion of computer resources in numerical simulations has to be spent on the pl even if when nothing significant occurs there in the problem at hand the high cost of resolving the pl is not the only difficulty when modeling a layered ocean since little is known about the väisälä brunt frequency n in the ocean s deeper parts except that n is small modeling the pl poses problems even if one has resources for resolving it an additional difficulty arises when one uses the quasigeostrophic qg model which becomes singular in the limit n 0 to avoid all these problems many assume the väisälä brunt frequency to be constant which is however not the case near the al pl interface and thus may give rise to an error which is impossible to estimate in this work a model is presented parameterizing the effect of the passive layer on the active layer under the qg approximation the problem is formulated in section 2 solved asymptotically in section 3 and section 4 addresses the practical issue of how one can subdivide a continuously stratified ocean into an al and pl in section 5 the general asymptotic model is adapted for the case where the potential vorticity field in the pl is uniform 2 the governing equations consider a mesoscale flow in the ocean characterized by the coriolis parameter f and the väisälä brunt frequency n z where z is the vertical coordinate with x y and t being the horizontal coordinates and time let the flow be described by the qg equation for the stream function ψ for the applicability of the qg theory see pedlosky 1987 1 t 2 ψ z f 2 n 2 ψ z j ψ 2 ψ z f 2 n 2 ψ z 0 where the horizontal laplacian and jacobian are 2 ψ 2 ψ x 2 2 ψ y 2 j ψ q ψ x q y ψ y q x under the rigid lid approximation the boundary conditions at the ocean s surface and bottom are 2 2 ψ t z j ψ ψ z 0 at z 0 3 2 ψ t z j ψ ψ z 0 at z h where h is the ocean s depth 3 the analysis assume that the ocean can be subdivided into an active and passive layers of depths ha and h p h h a with the corresponding scales of the väisälä brunt frequency being such that na np introduce also the horizontal spatial scale l of the flow the same for both al and pl now two burger numbers can be introduced b u a n a 2 h a 2 f 2 l 2 b u p n p 2 h p 2 f 2 l 2 the only assumption used in this work is that bup is small 2 2 note that despite the smallness of bup which often signals that the qg approximation should be replaced with the frontal geostrophic one the deviation of the isopycnals in the pl is assumed small hence the qg still holds mainly due to the smallness of np whereas bua remains unrestricted the following derivation is straightforward so there is no need to nondimensionalize the governing equations if bup 1 the terms involving 1 n 2 dominate eq 1 in the pl so that the solution of 1 can be sought in the form of a series ψ ψ 0 ψ 1 for z h h a where ψ 1 ψ 0 o b u p and 4 2 t z f 2 n 2 ψ 0 z j ψ 0 z f 2 n 2 ψ 0 z 0 5 t 2 ψ 0 z f 2 n 2 ψ 1 z j ψ 1 z f 2 n 2 ψ 0 z j ψ 0 2 ψ 0 z f 2 n 2 ψ 1 z 0 note that a two layer beta plane equivalent of eq 4 has been previously derived by dewar and gailliard 1994 the boundary condition 3 in turn yields 6 2 ψ 0 t z j ψ 0 ψ 0 z 0 at z h 7 2 ψ 1 t z j ψ 0 ψ 1 z j ψ 1 ψ 0 z 0 at z h next to match the pl and al solutions one should require the continuity of the pressure and isopycnal displacement under the qg approximation this amounts to 8 ψ z h a 0 ψ z h a 0 f 2 n 2 ψ z z h a 0 f 2 n 2 ψ z z h a 0 since the pl part of the streamfunction is now subdivided into ψ 0 and ψ 1 8 should also be subdivided into two pairs of matching conditions for ψ 0 and ψ 1 9 ψ 0 z h a 0 ψ z h a 0 f 2 n 2 ψ 0 z z h a 0 0 10 ψ 1 z h a 0 0 f 2 n 2 ψ 1 z z h a 0 f 2 n 2 ψ z z h a 0 observe that the al pressure which can be large is matched to ψ 0 whereas the al isopycnal displacement which is relatively small as ha hp 1 is matched to ψ 1 this way the subdivided matching conditions are balanced i e involve terms of the same order it turns out that ψ 1 can be eliminated integrating eq 5 with respect to z from h to h a 0 and integrating by parts the terms that involve both ψ 0 and ψ 1 one can verify that the bulk integral terms involving ψ 1 cancel out and 5 becomes 11 t h h a 2 ψ 0 d z f 2 n 2 ψ 1 z z h a 0 f 2 n 2 ψ 1 z z h j ψ 0 f 2 n 2 ψ 1 z j ψ 1 f 2 n 2 ψ 0 z z h a 0 j ψ 0 f 2 n 2 ψ 1 z j ψ 1 f 2 n 2 ψ 0 z z h h h a j ψ 0 2 ψ 0 d z 0 now taking into account the boundary matching conditions 6 7 and 9 10 one obtains 12 t 2 h h a ψ 0 d z φ h h a j ψ 0 2 ψ 0 d z j ψ φ 0 where 13 ψ x y t ψ z h a 0 φ x y t f 2 n 2 ψ z z h a 0 the leading order solution ψ 0 in turn cannot be eliminated note however that the passive layer is not supposed to have independent dynamics but should be driven by the active layer i e the pressure field in the former ψ 0 should be fully determined by the pressure applied at the interface hence 14 ψ 0 ψ x y t subject to 14 eqs 4 and 6 are satisfied identically whereas 12 yields 15 t h p 2 ψ φ j ψ h p 2 ψ φ 0 note that letting ψ 0 be independent of z makes the pl flow barotropic but the isopycnal displacement determined by f 2 n 2 ψ 1 z does depend on z and is order one due to the presence of the factor 1 n 2 thus the complete governing set comprises 1 the al eqs 1 2 2 the pl eq 15 and 3 the matching conditions 13 where the 0 can be omitted 16 ψ ψ f 2 n 2 ψ z φ at z h a items 2 3 are the main results of this work note that an approximation similar to 15 16 has been derived by benilov 1995 for the particular case of normal modes in a baroclinic current the possibility of an extension to arbitrary qg flows however was overlooked 4 examples the asymptotic model developed above is valid when the ocean can be subdivided into an al and pl the real ocean however is continuously stratified with no clear cut inter layer boundary leaving us with a question what is the optimal choice for the al pl interface this issue is clarified below by applying the general model 15 16 to the example of baroclinic instability of a vertically sheared but horizontally uniform flow the asymptotic results for different values of ha are then compared to the exact solution it is convenient to nondimensionalize the problem by introducing n n d n n a x n d y n d x y l z n d z h t n d v 0 t l ψ n d ψ v 0 l where na is the maximum väisälä brunt frequency va is the maximum velocity and l h f n a rewriting the exact eqs 1 3 in terms of the non dimensional variables and omitting the subscript nd one obtains 17 t 2 ψ z 1 n 2 ψ z j ψ 2 ψ z 1 n 2 ψ z 0 18 2 ψ t z j ψ ψ z 0 at z 0 19 2 ψ t z j ψ ψ z 0 at z 1 next let ψ y v z ψ x z t where v z is the base flow and ψ is a small perturbation linearizing eqs 17 19 and letting ψ ψ z e i k x c t where k and c are the perturbation s wavenumber and phase speed one obtains 20 c v d d z 1 n 2 d ψ d z k 2 ψ ψ d d z 1 n 2 d v d z 0 21 c v d ψ d z d v d z ψ 0 if z 0 22 c v d ψ d z d v d z ψ 0 if z 1 repeating the same procedure linearization etc for the asymptotic equations 15 16 and eliminating ψ and φ one obtains 23 1 n 2 d ψ d z d p k 2 1 v c n 2 d v d z ψ if z d a where d a p h a p h condition 23 is the asymptotic alternative to the exact boundary condition 22 numerous examples of v z and n z have been examined yielding more or less the same results below are described those for 24 n 2 z 1 n p 2 2 tanh z δ n w n 1 n p 2 where n p n p n a and δn and wn are the non dimensional depth and width of the transitional region between the main thermocline and the weakly stratified part of the ocean the seasonal thermocline is neglected assuming that the main thermocline is 800 m deep and the transitional region is about two times thinner see for example pedlosky 1987 fig 1 3 1 then recalling that the ocean s mean depth is 4 km and finally choosing a small value for np on a more or less ad hoc basis one obtains 25 δ n 0 25 w n 0 3 n p 0 1 the following velocity profile will be assumed 26 v z sech z δ v where δv is the flow s penetration depth the following two examples have been examined a thin flow confined to the thermocline and a thick one partly penetrating the weakly stratified part of the ocean 27 thin flow δ v 0 07 thick flow δ v 0 12 n z and both versions of v z are shown in fig 1 the corresponding slope ηy z of isopycnal surfaces and the horizontal gradient qy z of potential vorticity pv η y 1 n 2 d v d z q y d d z 1 n 2 d v d z are plotted in fig 2 observe that for both examples of v z the isopycnal displacement penetrates noticeably deeper than the flow and stratification themselves the solution of the exact eigenvalue problem 20 22 and that of the asymptotic problem 20 21 23 were computed using the shooting method to avoid the singularity arising in neutrally stable cases eq 20 was integrated along a path in the complex z plane bypassing the critical level for more details see boyd 1985 benilov and sakov 1999 for all values of the wavenumber k no more than one unstable k im c 0 eigenvalue has been found for both exact and asymptotic problems in figs 3 and 4 the asymptotic phase speed re c and growth rate k im c are compared to the corresponding exact results as one might expect a sufficiently accurate asymptotic model for the thick flow turned out to require a larger da than that for the thin one less expectedly the two flows turned out to differ in how the asymptotic model s accuracy improves with growing da for the thick flow it does so gradually but for the thin one the solution becomes accurate abruptly as soon as da passes a threshold of 0 3 to understand why the value of d a 0 3 is special note that the al pl interface in this case is located just below the level of the extreme pv gradient see fig 2 b more broadly numerous examples of thin flows have been examined and the following conclusions have been drawn if for a certain choice of da the al does not include the extremum of qy z the accuracy of the asymptotic model in application to a thin flow is poor if da is large enough for the al to include the extremum of qy z the asymptotic model is sufficiently accurate despite the fact that the al may still not include the decaying portion of qy z and the maximum of the isopycnal slope ηy z see fig 2 in the latter case there is no point in increasing da beyond this threshold as this results in wasting computational resources on a minor accuracy improvement for thick flows in turn the following rule of thumb has been established the inter layer boundary can be drawn below the deepest extremum of the pv gradient qy at the depth where qy has decayed by a factor of 3 by comparison with that extremum the same rule would work for thin flows as well but it would not deliver the optimal choice in this case finally fig 5 illustrates the potential dangers of an often used approach consisting in assuming n z to be constant in the whole ocean i e ignoring the pl for thick flows it produces noticeably less fitting results than those obtained through the asymptotic model proposed for thin flows in turn the two approaches produce similar results but the asymptotic one is still cheaper computationally 5 a reduced asymptotic model observe that the asymptotic eq 15 is satisfied if 28 φ h p 2 ψ reduction 28 implies that the pv anomaly in the pl is zero i e the pv field itself is well diffused which it indeed is in the deep ocean unless up or down welling has recently occurred substituting 28 into 16 and eliminating ψ one obtains 29 f 2 n 2 ψ z h p 2 ψ if z h a now one can exclude the pl from consideration and solve the self contained boundary value problem 1 2 29 for the al note also that the boundary condition 29 imposes a constraint on the allowable initial condition consider for example a vertically sheared but horizontally homogeneous flow described by ψ y v z which expression satisfies 29 only if d v d z 0 at z h a another example is the so called columnar vortices e g dritschel and de la torre juárez 1996 in this case ψ ψ r which satisfies 29 only if ψ r unrestricted solid body rotation which is meaningless physically in both cases the constraint originates from the requirement of uniform potential vorticity in the pl used to obtain the boundary condition 29 still despite the constraint the boundary condition 29 has important physical applications e g near surface oceanic vortices which are both abundant in the ocean and crucial for its dynamics olson 1991 chelton et al 2011 at the same time the pv field beneath such vortices can indeed be conjectured to be uniform benilov 2004 benilov and flanagan 2008 in addition a lot of work has been done on vortices submerged in a fluid with uniform pv e g dritschel et al 2005 and 29 would be useful for extending these results to the real ocean conditions involving a passive layer it should be emphasized that the general model 15 16 does not impose any constraints on the al initial condition 6 summary and concluding remarks thus two models parameterizing the ocean s passive layer have been derived the general model 15 16 and the reduced model 29 assuming that the pv field in the passive layer is uniform the latter is particular simple as it allows to fully exclude the passive layer from consideration the former model in turn implies solving a partial differential equation for the passive layer which however involves only horizontal spatial variables and thus is much simpler than the original three dimensional qg equation in both models one still has to compute the solution in the active layer but this is of course cheaper than solving the qg equation in the whole domain in order to subdivide the real continuously stratified ocean into an al and pl the following rule of thumb has been established the passive layer can be assumed to begin at the depth where the horizontal pv gradient has decayed by a factor of 3 by comparison with its deepest extremum this typically implies a reduction of the computational domain at least by 50 and sometimes by up to 70 acknowledgments the author acknowledges the support of the science foundation ireland grant no 12 ia 1683 
24114,synchronous coupling is developed between an ice sheet model and a z coordinate ocean model the mitgcm a previously developed scheme to allow continuous vertical movement of the ice ocean interface of a floating ice shelf vertical coupling is built upon to allow continuous movement of the grounding line or point of floatation of the ice sheet horizontal coupling horizontal coupling is implemented through the maintenance of a thin layer of ocean 1 m under grounded ice which is inflated into the real ocean as the ice ungrounds this is accomplished through a modification of the ocean model s nonlinear free surface evolution in a manner akin to a hydrological model in the presence of steep bathymetry the coupled model is applied to a number of idealized geometries and shown to successfully represent ocean forced marine ice sheet retreat while maintaining a continuous ocean circulation keywords glaciology ice ocean interaction moving boundary 1 introduction a number of important physical processes in coastal oceanography involve the horizontal influx of water into regions that were previously dry as well as the complete removal of water from other regions that were at some point wet in estuarine regions submerged boundaries change with the tidal cycle and numerical codes which attempt to model important biological and geomorphological processes must capture this wetting and drying accurately hardy et al 2000 de brye et al 2010 flood models of storm surge must properly capture the advance and retreat of the flooding front van t hof and vollebregt 2005 there is an extensive numerical literature which deals with the problem of encroaching and retreating coastal flows medeiros and hagen 2013 there is however an important coastal oceanographic process not often discussed in the computational literature surrounding wetting and drying problems in antarctica and to a lesser extent greenland and likely elsewhere during past glaciations the ice sheet is marine terminating it extends into the ocean in the form of large floating ice shelves due to the relatively small ice ocean density differential this occurs at depths 500 1000 m below sea level the location where the ice sheet goes afloat called the grounding line is a topic of much discussion in the literature surrounding ice sheet dynamics this is due to it being a sharp transition between two very different regimes of ice flow vieli and payne 2003 pattyn et al 2006 schoof and hewitt 2013 from an ice dynamics perspective determining the floatation point is equivalent to a viscous contact problem one which requires very sophisticated numerical schemes schoof 2011 although certain approximations make the problem more tractable goldberg et al 2009 cornford et al 2013 the focus of this paper however is not on the glaciological dynamics of grounding line migration but rather on the coupling between the ice and the ocean underneath the ocean circulates in a cavity bounded above and below by the ice shelf and bedrock respectively and on the landward side by the grounding line where the water column depth pinches off the circulation within the cavity is influenced by density variation and by the topography of the ice shelf and sea bed macayeal 1984 from the ocean s perspective the ice sheet ice shelf presents itself as variable surface pressure and when the surface pressure favors the flooding of previously dry domain the ocean will do so aside from the spatially varying surface pressure the problem is analogous to run up on a sloped beach this wetting drying problem is quite an important one in the context of antarctic ice sheet contributions to sea level rise melting and thinning of floating ice does not contribute significantly to sea level change jenkins and holland 2007 but retreat of the grounding line towards the interior represents loss of grounded ice which does moreover if the depth of the bed deepens inland as is the case around much of the antarctic coastline fretwell et al 2013 retreat of the grounding line can lead to an increase in ice sheet thinning rates upstream potentially leading to a positive feedback effect weertman 1974 schoof 2007b vaughan and arthern 2007 yet most ocean models including those adapted to study ice shelf ocean interactions e g holland and jenkins 2001 little et al 2008 walker and holland 2007 gwyther et al 2014 have not implemented such wetting and drying there are two important differences between the ice sheet wetting drying problem and the standard coastal wetting drying problem firstly while the latter can be addressed through shallow water equations the former must be addressed by a three dimensional model representing baroclinic motions in the ocean and therefore must represent active tracer heat and salt evolution as well as an evolving upper boundary the base of the ice shelf hence the approaches used for wetting drying problems in coastal oceanography cannot be straightforwardly transferred to ocean models secondly the wetting front advance and retreat associated with grounding line change is much slower than in flooding and storm surge problems with observed retreat rates of up to 3 km year rignot et al 2014 but often much slower the separation of time scales allows for quasi static discontinuous approaches in which a sequence of ocean runs are carried out with fixed cavity geometries with the geometry sequence arising from the evolution of the ice sheet model grosfeld and sandhager 2004 goldberg et al 2012 de rydt and gudmundsson 2016 such an approach makes the assumption that a given geometry and far field oceanic conditions will lead to a unique circulation which may not be the case e g if the ocean cavity is still in a transient state when the ice adjusts additionally the ocean model must be spun up with each coupled time step making the approach unsuitable for regional or global ocean models more recently efforts have been made to retain the ocean state during adjustments to the cavity geometry such asynchronous approaches are still not ideal typical coupling frequencies of a month to a year may lead to significant depth changes in the ice ocean interface upon geometry updates the necessary infilling with predefined water properties can lead to violations of mass and tracer conservation as well as significant nonphysical adjustments in one instance the latter has been addressed through imposing that barotropic velocities remain fixed between updates asay davis et al 2016 still it seems clear that a synchronous approach i e one in which the ocean geometry is adjusted on or close to the ocean time step is a preferable approach to modelling ice sheet ocean interactions on continental and global scales particularly if the ocean is subject to forcing on fast time scales such as changes in wind stress christianson et al 2016 and episodic additions of fresh water smith et al 2017 in this paper we modify the massachusetts institute of technology general circulation model mitgcm marshall et al 1997 to allow for synchronous coupling of an ice sheet and ocean model mitgcm is a general purpose fluid solver for simulating process level to global scale ocean circulation that is usually configured in hydrostatic and boussinesq approximations in vertical z coordinates as has been done in the present study components of the development have been completed previous to this study the most important of which allows continuous thinning and thickening of a floating ice shelf which we term vertical coupling jordan et al 2017 here we focus primarily on a scheme to allow for both grounded and floating ice and a dynamic grounding line horizontal coupling in the following we briefly discuss the vertical coupling scheme and demonstrate how it can be used to allow for grounding line migration over a flat bed topography with minimal code changes we then discuss the difficulties involved with variable bed topography which are common to all z coordinate models and present a strategy to overcome them which involves combining the ocean model algorithm with a scheme akin to flow through a porous medium finally we present results from the first three dimensional synchronously coupled ice ocean model of marine ice sheet retreat 2 flat topography methodology with a flat bed topography we are able to cleanly simulate synchronous coupled grounding line migration by making use of recent novel developments within mitgcm to allow for vertical coupling defined above the work builds on previous developments to allow thermodynamic ice shelf ocean interactions within mitgcm losch 2008 dansereau et al 2014 as well as the development of an ice sheet component within the modelling framework goldberg and heimbach 2013 vertical coupling is described in detail in jordan et al 2017 but we briefly describe those components which are relevant to our study in order to provide context for our results and for our further developments of the model note that we refer below to the z coordinate implementation not the z implementation adcroft and campin 2004 2 1 vertical coupling in this subsection we give details of vertical coupling and the mitgcm glacial flow model which are also described in jordan et al 2017 readers familiar with this paper might skip to section 2 3 vertical coupling within mitgcm hinges on the nonlinear free surface capabilities of the model campin et al 2004 the free surface elevation η defined relative to a reference surface elevation z d which for the ice free ocean is d 0 but for a cell occupied by the ice shelf is generalised to the height of the ocean ice shelf z d in losch 2008 η is updated in each time step in a fully mass heat and salt conserving fashion and responds both to barotropic pressure gradients and to gradients in surface load psurf which is imposed as the weight per unit area of the ice shelf as flexural stresses within the ice shelf are not presently considered 1 p s u r f ρ i g h under the ice shelf where g is gravitational acceleration ρi is ice density and h is ice thickness which is updated at each time step in response to ice dynamics and basal melting or freezing the ice model rather than updating its velocity and thickness at the same time as is common practice in ice sheet modelling updates its thickness on the ocean time step velocity updates which are more costly take place every 12 h but this is acceptable as velocity change induced by thickness changes on this time scale is very small in this manner the surface load can be updated smoothly without exposing the ocean to sudden large changes in surface pressure as the ice and ocean codes are both components of mitgcm there is no issue passing ice thickness to the ocean code and melt rate to the ice code in the z coordinate free surface implementation of mitgcm the height of the top level cell grows with η in contrast to the z coordinate implementation in which cells thicken and thin uniformly in a column without intervention this can either lead to poor representation of the ice ocean boundary layer jenkins 2016 as the ice thins or to negative cell height as the ice thickens to this end a remeshing algorithm has been implemented upon initialisation of mitgcm model cells are flagged as being either ice or ocean the remeshing process essentially allows cells to switch from ice to ocean and vice versa within a model run and without the need to reinitialise ice and ocean masks whilst the topmost ocean cell thickness in a given column evolves every time step at predetermined intervals we check to see if it has grown above a splitting threshold or below a merging threshold in either event a remeshing process is triggered whereby cells that are too thick are split into two separate cells and cells that are too thin are merged with the cell below see fig 1 for visualisation in both cases salt temperature mass and momentum are locally conserved in the present study the splitting and merging thresholds are 1 3 and 0 29 times the baseline cell thickness in all simulations 2 2 ice sheet shelf model the ocean model is coupled to the mitgcm ice sheet flow model developed within the mitgcm code and described briefly in the following glacial ice is modelled as a slowly flowing viscous fluid with a non newtonian power law rheology cuffey and paterson 2010 due to its viscous nature forces are at all times in balance and its velocity field is determined by its geometry schoof and hewitt 2013 thus reducing the navier stokes equations to a stokes flow problem the mitgcm ice model uses an approximate force balance in which the forces within the ice sheet are considered to be hydrostatic and membrane stresses internal stresses which transmit force horizontally are considered depth uniform schoof and hewitt 2013 it has been shown that such an approximation is appropriate where motion is dominated by either vertical shearing or along flow stretching and cross flow shearing schoof and hindmarsh 2010 goldberg 2011 which encompasses most flow regimes in antarctica the equations solved for velocity see goldberg 2011 for further detail are 2 x h ν 4 u x 2 v y y h ν v x u y β 2 u b ρ i g h s x 3 x h ν v x u y y h ν 4 v y 2 u x β 2 v b ρ i g h s y 4 ν a 1 n 2 u x 2 v y 2 u x v y 1 4 u y v x 2 1 4 u z 2 1 4 v z 2 1 n 2 n here h is vertical ice thickness s is surface elevation u u v is horizontal ice velocity and ρi is ice density overbars indicate vertical averaging while the b subscript indicates basal velocities a linear frictional sliding law is prescribed by 2 and 3 for which β 2 is the sliding coefficient the exponent of 2 indicating it is strictly positive the above equations differ for floating ice ice shelves only in that β 0 the rheology is determined by glen s law cuffey and paterson 2010 wherein n 3 and a is a parameter governed by the fabric and temperature of the ice in this study β is uniform under grounded ice and a is uniform as well all relevant parameter values can be found in table 1 at the horizontal boundary between ice and open ocean the calving front the conditions on the velocity equations are 5 h ν 4 u x 2 v y n x h ν v x u y n y 1 2 h 2 ρ r e f ρ i z l o w 2 ρ i g n x 6 h ν v x u y n x h ν 4 v y 2 u x n y 1 2 h 2 ρ r e f ρ i z l o w 2 ρ i g n y where n n x n y is the seaward normal to the calving front ρref is the ocean reference density and zlow is ocean bathymetry at all other lateral boundaries we impose no slip conditions on the ice model the ice thickness evolves as a result of horizontal ice mass flux divergence and surface and basal mass balance the last of which takes place only where ice is floating the evolution equation is 7 h t h u m a where m is ice shelf mass balance positive where ice is melting and a surface mass balance set to zero in this study the grounding line is dynamic and is determined by a simple floatation condition a consequence of the assumption of hydrostasy 8 ρ i h ρ r e f z l o w and where ice is floating the surface and basal elevation b depends only on thickness and reference densities 9 s 1 ρ i ρ r e f h 10 b ρ i ρ r e f h note that the criterion 8 is not consistent with the ocean model criterion i e that implied by mmin in 15 and the basal elevation b is not necessarily equal to the upper surface of the ocean in our simulations though the two floatation criteria are not seen to disagree by more than a grid cell it would be straightforward to modify the ice flow model to enforce these consistencies though for the present study we have not done so ice sheet models generally evolve thickness and velocities with the same time step but to evolve both on the ocean time step would be prohibitive rather a split approach is taken it is seen from eq 4 that the equations for velocity are nonlinear and must be solved iteratively in uncoupled mode the mitgcm ice model solves a sequence of linear elliptic partial differential equations to a required tolerance the number of iterations required depends on the change in thickness over a time step in our coupled model we take a single such iteration once to twice daily in jordan et al 2017 it is shown this approach maintains convergence of the velocity solution meanwhile ice thickness is evolved on the ocean time step the most recent velocities are used in eq 7 for brevity we omit details on the thermodynamic coupling between ice and ocean the basic equations are given in holland and jenkins 1999 and have been implemented in mitgcm by losch 2008 and dansereau et al 2014 and modified by jordan et al 2017 to allow for real rather than virtual fresh water fluxes aside from those listed in table 1 all parameters relevant to the melt are as in dansereau et al 2014 2 2 1 parameterised buttressing in some of the results in this paper a two dimensional x z flowline ice model is considered coupled to a corresponding two dimensional ocean model i e coriolis forces are omitted to enable long model runs that are computationally cheaper this removes the effect of buttressing whereby confining stresses acting on the ice shelf are transmitted back to the grounding line slowing grounded ice motion thomas 1979 ocean melting feeds back on ice sheet flow by thinning the ice shelf which reduces buttressing the lack of buttressing is dealt with through a parameterisation which makes a further approximation that the along flow normal stresses in the ice shelf do not vary across the shelf dupont and alley 2005 assuming flow is in the y direction eq 3 becomes 11 y h ν v y β 2 v b h w 5 v a w 1 n ρ i g h s y here w is the half width of the ice sheet ice shelf treated as constant in the three dimensional simulation we present later the buttressing parameterisation is not needed 2 3 subglacial layer the method of vertical coupling described above has been thoroughly tested in the case of ice shelves with no grounded component jordan et al 2017 however alone it cannot be used to simulate grounding line migration the difficulties in implementing such a capability are linked to the way in which the ocean surface is evolved here the present algorithm for free surface evolution in mitgcm is briefly discussed for further detail see marshall et al 1997 and campin et al 2004 in one horizontal dimension the free surface equation can be written 12 η n 1 η n δ t f w ρ r e f x h n u n 1 here the n and n 1 superscripts represent the current and new time steps not to be confused with n in eq 4 fw represents net fresh water flux combined precipitation evaporation run off ice shelf melting and freezing as a mass flux in kg s h is ocean column thickness u is velocity the overbar represents a vertical average while the superscript indicates both the update of velocity from time n due to inertia baroclinic pressure viscous effects etc referred to below as g u n 1 2 as well as a correction due to momentum imparted by the barotropic pressure gradient over a time step 13 u n 1 u n δ t g u n 1 2 g δ t x η n 1 u g δ t x η n 1 combining the two yields the following equation for η n 1 14 x g h n x η n 1 1 δ t 2 η n 1 f w ρ r e f δ t 1 δ t 2 η n 1 δ t x h n u this elliptic partial differential equation which in two horizontal dimensions requires a large linear system solver such as conjugate gradients arises from the use of η n 1 in the right hand side of 13 rather than ηn this implicit approach damps high frequency barotropic waves and computational modes dukowicz and smith 1994 it also allows for tractable ocean simulation by greatly increasing the allowable time step on the other hand it causes difficulties transporting fluid into ocean columns which were previously dry column thickness zero if the equation were solved over portions of the domain with zero thickness there is no guarantee that negative thicknesses would not arise a compromise to maintain the efficiency of an implicit free surface is to maintain a thin ocean layer under all regions of the ice sheet which could potentially unground a so called thin film approach to wetting and drying medeiros and hagen 2013 the only complication arising is the fact that the weight of a grounded ice column can be far greater than the weight of the ocean column it replaces driving a strong pressure gradient which will quickly deflate such a layer to address this we modify the definition of psurf above a minimum ice mass mmin is defined as the minimum mass required for ice to be grounded 15 m m i n z l o w h m w c t z s l ρ a v g z d z where zlow is the same as that used for the ice flow model ρavg is the horizontally averaged density over all ocean filled cells at a given grid level and zsl is the ocean surface height averaged over the ice free ocean hmwct is the minimum water column thickness the definition of psurf above is modified as follows 16 p s u r f g m e f f where 17 m e f f ρ i h 1 a 2 g f a c 1 a 2 a m m i n ɛ m 1 ρ i h 2 g f a c tanh 1 ɛ m 2 m m i n ρ i h accordingly the load felt by the ocean is the actual weight of the ice column where ice is floating i e where ρih meff and is equal to mmin under grounded ice with a narrow transition between the two regimes around the grounding line as shown for a simple example in fig 2 the result is that when ice is thin enough to float with an ocean column of at least hmwct the full load of the ice is felt above this the load is reduced note that 17 is heuristically defined to achieve a certain effect rather than arising from physical principles we further impose that there is no melting where ρih meff the approach has already been used in another study snow et al 2017 in all results presented ε m1 is 0 01 and ε m2 is 10 5 the sensitivity of results to hmwct is tested later in the paper 3 flat topography experiment to illustrate the applicability of the subglacial water layer method described in section 2 3 a simple two dimensional x z coupled model with a flat topography is applied the coupled ice ocean model is initialised in a two dimensional domain implemented through free slip ocean walls and setting the coriolis parameter to zero the domain is 320 km long with a horizontal resolution of 800 m bathymetry is 1000 m uniformly and vertical resolution is 10 m the ice flows into the domain at x 0 with a fixed volume flux of 4 105 m2 yr per unit width an initial calving front is specified at x 240 km the ice front can retreat from this point by thinning to zero thickness but cannot advance beyond it the ocean model extends to x 320 km and is forced with a sponge layer extending over the last 20 grid cells of the domain in the sponge layer temperature and salinity are relaxed to the profile in fig 3 a with a time constant varying from 2 days at the domain boundary to 10 days at the edge of the sponge layer the target thickness of the subglacial water layer hmwct is 1 m the ice sheet model is initialized without coupling to the ocean and run to a steady state the coupled model is then initialised using this ice sheet geometry and with a time step of 200 s and run until either a steady state or complete ungrounding of the ice stream is reached as in snow et al 2017 velocities at the open ocean boundary are adjusted in response to the spatially averaged open ocean surface elevation in order to maintain sea levels without doing so sea level would adjust considerably in response to grounded ice loss due to the small ocean domain however these velocities are small on the order of millimeters per second or less and do not strongly affect ocean circulation in the initial ice state see fig 4 c the ice is flowing across the grounding line at 300 m a increasing to 700 m a at the ice shelf front initial temperature and salinity are uniformly 1 c and 34 2 psu respectively as the flushing time of the cavity is short on the order of days to weeks we do not expect this to affect coupled evolution significantly movement in the subglacial water layer is far slower so the impact of its initial conditions must be investigated this is done in section 6 fig 4 summarizes the results of the experiment fig 4 a shows the evolution of the ice sheet ice shelf geometry there is rapid thinning of the ice shelf to a new shape superimposed on near steady grounding line retreat the grounding line retreat occurs due to a thinning of grounded ice which is a response to an increase of ice flux across the grounding line due to ice shelf thinning and buttressing loss the movement of a grounding line can be a challenging computational issue in ice sheet modelling goldberg et al 2009 but it has been shown that in the presence of relatively weak beds and narrow channel widths resolution of 1 2 km is sufficient to represent this process gladstone et al 2012 thus we are confident that the experiments in this study are able to do so the thinning and retreat of the ice sheet is encapsulated in a measure known as volume above floatation vaf defined as the area integral of h ρ r e f ρ i z l o w where indicates the positive part and the negative part of the quantity vaf represents the volume of ice that if melted would contribute to sea level rise floating ice makes no contribution fig 4 d and f illustrate this concept the profiles of actual mass are shown as well as the effective mass felt by the ocean cf fig 2 the difference between the two profiles is the mass of the ice above floatation the rate of loss of vaf steadily increases as the ice shelf thins fig 4 b but when the grounding line retreats substantially and the ice shelf lengthens the vaf loss decelerates and eventually slows to zero while this may be due to increased buttressing from an increasing lateral ice shelf area e g little et al 2012 it is more likely because of the diminishing ice sheet having increasingly less volume above floatation to lose melt rate profiles fig 4 d and f appear quite different between the early and late stages of the simulation reflecting the different ice shelf profiles fig 4 c and e melt rate is controlled by nearby ocean temperature as well as ocean velocity melt rate is therefore higher in deeper waters where water is warmer and in areas of steeper shelf slope which drive faster flow of melt buoyed water this melt freshened water causes an overturning circulation which is closed by the sponge but does not strongly affect the stratification in the ocean interior the jagged appearance of the melt rate is related to the striped pattern discussed in losch 2008 and indicates the transition of the ice shelf base into a new vertical level the boundary layer parameterization of losch 2008 which averages relevant ocean properties salinity temperature velocity and surface fluxes over a full vertical cell thickness alleviates this variability somewhat in the static shelf case and jordan et al 2017 modifies the parameterization for vertical coupling this variability would be problematic if it reinforced itself i e if it led to ice shelf thinning in a sawtooth pattern which exacerbated the variability in fact the opposite is observed to happen therefore the stripes do not amplify significantly over time and importantly do not affect coupled dynamics it is important to note that despite appearances the dominant direction of melting is vertically not horizontally in reality this is due to the low ice shelf aspect ratio in mitgcm it is explicit as melt is not applied to vertical cell faces grounded ice is lost because the ice shelf which buttresses the flow is thinned finally it is seen that while the under ice layer of water evolves figs 4 b its fluctuations are small giving confidence that even thinner layers could potentially be used here the smallest layer we consider is 1 m 4 variable topography methodology the simulation presented in the previous section is a completely synchronous simulation of a marine ice sheet with a dynamic grounding line coupled to an ocean model it is limiting however in that the bathymetry is constant the true interest in coupled ice sheet ice shelf ocean dynamics arises because of variable topography in particular large parts of antarctica rest on a bed that is well below sea level more than a km in places and deepens inland fretwell et al 2013 the effects of buttressing aside the rate of flow of a marine ice sheet across its grounding line depends strongly on bed depth at that location weertman 1974 schoof 2007b this means that if the grounding line of an ice sheet were to retreat over an inland deepening bed the rate of grounded ice loss would increase and so would grounded ice thinning rates leading to further grounding line retreat ice shelf buttressing represents a stabilizing process goldberg et al 2009 gudmundsson 2013 but ice ocean dynamics could potentially affect this stability leading to increased melt rates as grounding lines retreat and ice shelf cavities change shape jacobs et al 2011 de rydt et al 2014 a difficulty arises however in attempting to apply the methodology presented in section 2 to varying topography this is because in a z level coordinate ocean model fluid cells can only communicate with cells which are directly adjacent consider the schematic in fig 5 in columns 1 and 2 ice is thicker than its floatation thickness the subglacial water layer described in section 2 3 should remain at or near hmwct in column 3 ice has dropped below its floatation thickness and in column 4 ice is fully floating with a flat bathymetry water would simply flow from the column 4 into the column 3 as the ice thins and the load on the column decreases and would do so in accordance with the mass and momentum balances of the ocean model however there is no hydraulic connectivity between any of the cells in columns 3 and 4 and therefore this cannot happen as the ice in column 3 thins further fluid may flow from the column 2 increasing the depth of column 3 there are two possibilities either column 2 will thin to zero causing an error or the fluid cell in column 3 will thicken enough to split into two cells the upper one of which is hydraulically connected to column 4 however the pressure differential between columns 3 and 4 could be enormous leading to tsunami generation and disturbance such disturbances are artificial a result of finite mesh spacing here we seek to minimize the disturbance one solution is to find combinations of horizontal and vertical resolution and subglacial water layer depth that ensure a hydraulic connection between all cells at all times this could become quite complex and could lead to either unfeasibly high resolution or subglacial water layers so thick they can no longer be considered negligible for instance the bathymetry for a recent ice ocean coupling intercomparison asay davis et al 2016 would lead to layer thicknesses up to 50 m with 1 km horizontal resolution a high resolution for such a large domain an alternative solution and the one presented in this study is to allow hydraulic connectivity even between cells that are not at the same z level models of subglacial hydrology e g schoof 2010 werder et al 2013 follow such a solution thus avoiding constraints regarding the transfer of fluid between different elevations they define a hydraulic potential which replaces pressure as a driving force our aim is to implement this property within the mitgcm ocean model in certain cases we stress that our subglacial water layer is in no sense meant to represent the actual flow of water under ice sheets which is extremely heterogeneous with rate factors highly dependent on the direction of flow hewitt 2013 rather it is a compromise to enable the use of an ocean gcm for a problem for which it was not originally designed as such the implementation of hydraulic fluxes within the layer is simply a means of allowing the layer to fill its purpose that is to thicken or thin in a locally mass salt and heat conservative manner when variations in ice overburden force it to do so returning to the schematic in fig 5 in order to allow fluid to move freely from the column 4 to column 3 as well as columns 1 and 2 when hydraulic potential makes this favorable several developments are necessary beyond those made in section 2 and they are discussed below 4 1 porous flux the issue illustrated by fig 5 arises because the ocean floor and ice shelf base are discretized to the ocean grid in reality there should in general be pathways and conduits for the water to follow and if narrow enough these conduits will be controlled by lubricating flow to represent this flow we modify eq 12 to be 18 η n 1 η n δ t f w ρ r e f x h n u n 1 q where q is a porous flux defined at velocity points in mitgcm s c grid equal to 19 q κ p o r d p o r x φ κ p o r d p o r g x η n 1 x ψ l o w κ p o r d p o r g x η n 1 x p l o w p l o w ρ r e f where κpor and dpor are defined below note the second expression above decomposes φ into its free surface and baroclinic components and the third defines ψlow p is the baroclinic component of the pressure that is the component due to the vertical integral of density from z 0 p l o w is the baroclinic pressure component at the center of the lowest cell of each column plow is taken from p z a horizontal average pressure profile which in turn is found from a horizontally averaged density profile ρ z h where the h subscript is to distinguish from the vertical average in eq 12 ρ z h is found by averaging over all fluid filled cells at each depth level using ρref in any levels that contain no such cells the definition of ψlow may be unfamiliar to readers and can be reasoned as follows the potential governing flow in hydrology models e g schoof 2010 werder et al 2013 can be seen as the deviation of pressure from a reference pressure profile one that is derived via a constant density our reference pressure rather is derived from a reference density profile i e ρ z h our definition of φ is used on the basis that its gradients transition smoothly to ocean pressure gradients when the subglacial water layer thickens as shown below and that it minimizes movement far inland from the grounding line dpor depends on the total thickness of the ocean column h and is defined as 20 d p o r ɛ p o r 1 2 π cos π h 2 ɛ p o r h h ɛ p o r 0 h ɛ p o r see also fig 2 and κpor and ε por are parameters to be set this definition ensures the porous flux transitions smoothly to zero as h increases from zero to ε por the product κpordpor resembles a hydraulic conductivity but in no way is it meant to represent the true hydraulic conductivity of the subglacial hydrological system for two adjacent cells at the same z level q is such that if they are equalised with respect to the porous flux there should not be any ocean pressure gradient either if the grounding line in fig 5 retreats further and a connection is established between columns 1 and 2 there will be little to no pressure gradient driving flow the same is not true for columns 3 and 4 since ψlow corresponds to level k 1 in column 3 and to level k in column 4 once connectivity is established assuming equalisation of the porous flux the difference in φ at level k between columns 3 and 4 due to baroclinic effects is 21 g ρ r e f z k 1 z k ρ z ρ z h d z where ρ z ρ z h is the deviation from the horizontally averaged density profile in column 3 with a bedrock step of 50 m over a single grid cell of 1 km width and an average deviation of 0 2 kg m3 this will yield a potential difference of 0 1 m2 s2 yielding an acceleration of 10 4 m s2 when connection is established this is not a large acceleration while it is likely an overestimate of density variations but this error should be kept in mind it is straightforward to implement this porous flux implementation eq 14 the elliptic equation for the updated free surface η n 1 becomes 22 x g h n κ p o r d p o r n δ t x η n 1 1 δ t 2 η n 1 f w ρ r e f δ t 1 δ t 2 η n 1 δ t x h n u κ p o r d p o r n δ t ψ l o w n the free surface calculation is independent from the thermodynamic component of the ocean model the above changes enable transport of mass across barriers to the ocean model but not tracers temperature and salinity and any passive tracers we enable this transport with a simple first order upwind scheme between the two extremal cells on either side of a boundary where porous flux is nonzero where extremal means the exchange is between the top fluid containing cell in one column and the bottom of another or vice versa our parameterization bears similarity to a bottom boundary layer parameterization bblp which has been developed in several variants in ocean models in order to represent small scale dense overflows killworth 2003 our parameterization is distinct from most bblp s in that there is a net transfer of mass as well as tracer on the other hand we do not search for neutral density levels between which to transfer heat and salt which is done by some overflow parameterizations campin and goosse 1999 the flux q exists simply because the discretisation of topography prevents a smooth advance of the ocean into new regions opened up by thinning ice for the rate of grounding line retreat not to be limited by the porous flux parameters κpor or ε por the flux q must be large enough that the pressure of the subglacial water layer is roughly equalised with that of the ice shelf cavity i e porous flux must not be a limiting factor it is worth considering typical magnitudes of q assume that in an ice stream the upstream region within 5 km of the grounding line were thinning at an average rate of 50 m yr almost an order of magnitude larger than even the fastest thinning ice streams today if this region were going afloat a volume flux of 0 008 m2 s into the newly created cavity would be required implying velocities of a similar magnitude if ε por 1 m such velocities would not disrupt the circulation within the cavity nevertheless in subsequent sections we investigate the sensitivity of large scale behaviour to the porous flux parameters 4 2 implicit bottom drag at tracer points i e at cell centers fluid cell thicknesses are prevented from becoming too thin however grounding line migration over variable topography means cell thicknesses at u and v points have no lower limit this is problematic as bottom drag in the mitgcm ocean model is explicit and this leads to numerical instability in cells that are too thin a new scheme for implicit bottom drag has been developed in mitgcm the scheme is a modification of the already existing scheme for implicit vertical viscosity as the former is best understood in terms of the latter an explanation of both is given in the appendix a 5 variable topography experiment to illustrate the implementation of the porous flux scheme an experiment similar to that of section 3 is carried out but with variable topography the bed shallows from 2090 m at x 0 to 900 m at x 320 km a slope of 0 005 which is steep for the average bed slope of an ice stream fretwell et al 2013 ice model input flux is 5 105 m2 yr per unit width the profile to which the ocean is relaxed is shown in fig 3 b which has slightly cooler water 1 c at depth but is otherwise similar all other parameters are identical to those in section 3 save those relating to the porous flux parameterization the experiment is initialized in the same fashion by first steadying the ice flow model without any basal melting and then initialising the coupled model with resulting ice thickness in fig 6 results are shown for a 24 year run with h m w c t 3 κpor 4 0 s and ε por 0 75 m κpor and ε por are chosen to yield porous fluxes on the order of 10 4 10 3 m2 s during fast retreat despite the slightly cooler water the ice stream ungrounds completely in approximately 16 years the induced circulation is seen to have a much stronger influence on stratification in the cavity than in the flat bed case once the grounding line has retreated and the ice shelf changed shape considerably multiple overturning cells can be seen fig 6 e in this case the melt plume is reaching neutral buoyancy and flowing out of the cavity at depth with a distinct plume forming above this depth as with the flat bed experiment vaf loss rate begins to decrease past a certain point but again this is likely due to the vanishing of the ice stream vaf loss rates are much larger than in the flat bed experiment moreover in the flat bed experiment the rate of acceleration of vaf loss is constantly decreasing i e the curvature of the plot d 3 v a f d t 3 is positive this means there is acceleration of vaf loss but it is slowing here there is downward curvature around year 7 indicating an instability related to the shape of the bed as discussed previously there is known to be an instability related to ice dynamics when a grounding line retreats over a deepening bed however it can be seen as well that melt rates increase as the cavity expands due in turn to an strengthened circulation jacobs et al 2011 and a depression of the freezing point with depth the subglacial water layer thickness fig 6 b exhibits centimeter and decimeter scale fluctuations rather than the millimeter scale fluctuations in the flat bed experiment the short term fluctuations may be related to ungrounding if an ice shelf grid cell just downstream of the grounding line is undergoing strong dynamic thinning it can induce low pressures which could draw in water from the subglacial water layer this reduces the layer thickness by no more than a centimeter however despite the strong retreat seen in the simulation the largest drop in layer thickness is seen when the ice goes completely afloat which may be due to interaction between the grounding line the subglacial water layer and the domain boundary we anticipate though that in normal use the solution will be terminated before the grounding line reaches the edge of the domain as such in the sensitivity tests below we truncate the experiment after 12 years 6 sensitity to porous flow parameters a parameterisation has been introduced to an ocean model and it is not a parameterisation based on a physical process but rather to circumvent an unrealistic constraint placed upon the ocean by the discretization of topography it must be shown then that the behavior of the model is not sensitive to the parameters involved with the parameterisation namely κpor and ε por the hydraulic conductivity and thickness scale of the porous flux layer the minimum water column thickness hmwct plays a similar role it is not related to the actual subglacial water thickness but exists instead to prevent the water column from becoming negative we test the impact of all three parameters on the outcome of the experiment of section 5 as discussed in section 4 1 the influence of κpor and ε por should be minimal as long as fluxes are a large enough to keep pace with the thinning of grounded ice but b small enough that any induced movement is low table 2 details the values investigated in experiments 1a f each parameter is varied independently κpor is halved and ε por is doubled relative to section 5 and hmwct is decreased to 2 m and to 1 m this parameter variation is seen to affect vaf by at most 0 15 over 12 years of simulation fig 7 a melt rates vary by at most 1 fig 7 b at the end of the 12 years during which the grounding line has retreated 80 km and ice has thinned over a kilometer in places the variation leads to differences of at most 6 m in ice thickness fig 7 c overall these purely numerical parameters seem to have very little effect on the evolution of the coupled system the reference density ρref is also varied a small change in this parameter has little effect on ocean circulation but as discussed above it affects hydraulic potential gradients in the subglacial water layer the effect of decreasing ρref by 3 kg m3 is quite small notably it thins the subglacial water layer slightly close to the upstream boundary fig 7 c it is important to establish that coupled evolution does not depend critically on melt rates in the near vicinity of the grounding line as this is where circulation is most likely to be affected by the presence of the subglacial water layer and porous flux parameterisation to this end we mask out melting when the ocean column is below a certain thickness zmelt and vary this threshold between 0 and 10 m see experiments 2a c in table 2 the effect on coupled evolution is very small fig 7 d f a number of studies have suggested that in the absence of tidal mixing or significant subglacial runoff melt rates are small within a short distance 3 5 km of the grounding line as water flowing up the underside of the shelf must gain sufficient buoyancy before substantial mixing of heat to the ice ocean interface can occur little et al 2009 seroussi et al 2017 thus we are confident that this relative unimportance of melt rates where the ocean column is 10 m will carry to other settings finally the initial conditions of the subglacial water layer are investigated as mentioned previously movement in the layer is negligible far from the grounding line as is transport of heat and salt therefore initial conditions in the layer will persist we carry out two additional sensitivity tests experiments 3a b in table 2 in these experiments initial temperature in the layer either linearly increases to 1 0 c or decreases linearly to 0 8 c with distance from the grounding line the range of variability seen is similar to that of other sensitivity experiments fig 7 d f a possible reason is that where the ocean column is thin either under grounded ice or very close to it movement is so slow that thermodynamic processes such as diffusion mixing and very low rates of melt are sufficient to homogenize the ocean conditions and shield the cavity from the conditions of the subglacial water layer the impact of not using the porous flux parameterization at all can be observed by setting all relevant parameters to zero except hmwct which is necessarily nonzero to allow grounding line retreat see experiment 4 in table 2 the results are shown in fig 8 the result is shown from the perspective of the ocean for which the grounding line does not retreat at all despite significant thinning of the ice shelf this can be understood in reference to fig 5 due to ice shelf thinning the ice in column 3 has thinned sufficiently to go afloat but for the ocean column to inflate water must flow in from column 4 and it cannot from the ice model perspective the grounding line has retreated as mentioned in section 2 2 the ice model calculates its own grounding line irrespective of the ocean model the ocean model only influences the ice model through melting as plotted in fig 8 a the ice surface appears to have a local maximum but this is only from the ocean perspective nevertheless the ice sheet has not thinned as much as in fig 6 e as the ocean cavity has not increased in extent if the ice model were to determine its grounding line position based on ocean column thickness rather than ice thickness there would still be little grounding line retreat and the ice would have thinned even less but as mentioned in section 2 2 this modification is not made to the ice model in the present study we infer that at least for our simplified two dimensional experiment coupled evolution is insensitive to porous flux parameters within a reasonable range but excluding porous flux altogether over steep topography can be problematic 6 1 advancing grounding line in all prior experiments coupled grounding line retreat has been demonstrated but for our method to be robust it must be shown that grounding line advance can be simulated as well we carry out three additional experiments where the steep topography runs detailed above are halted after 8 years and exposed to a step change in far field oceanic conditions by lowering temperature to 1 9 c uniformly at the boundary one additional change is made the buttressing half width w is decreased from 25 to 15 km the reason for this change is that it was found the ice stream has reached a point of instability after 8 years of retreat from this point the grounding line will continue its retreat without stopping even if melt rates are set to zero this instability is often referred to as the marine ice sheet instability weertman 1974 schoof 2007a in which grounding line retreat on a seaward sloping bed accelerates as the grounding line deepens as much of the antarctic margin has similarly sloped beds the instability is cause for concern however our aim is not to verify this instability but capture coupled evolution in the presence of a retreating and advancing grounding line thus the step change in w while artificial is necessary to cause grounding line advance in contrast to the high rate of retreat in the previous experiments advance occurs more slowly advancing 10 km in 16 years fig 9 a but is sufficient to establish that advance can be represented a full parameter sensitivity test is not carried out but we examine sensitivity to hmwct fig 9 c e as the primary driver of change in vaf is the step change in w the sensitivity of vaf to layer thickness might not be indicative of the robustness of the algorithm melt rate and ice shelf draft however are insensitive to layer thickness just as in the retreat experiments 7 three dimensional coupled experiment a three dimensional coupled experiment is carried out over variable topography the domain is 300 km long by 50 km wide with 1 km horizontal resolution in ice and ocean models and 20 m vertical resolution in the ocean model bathymetry is similar to that described in section 5 it is uniform in the across flow x direction and rises in the y direction with a slope of 0 005 from 2000 m to 900 m over 220 km the location of the ice front it then levels off and beyond this point open ocean is assumed ice enters the domain at the southern boundary at a uniform flux of 2 25 106 m2 yr per unit width the profiles of temperature and salinity to which the ocean is relaxed in the sponge layer are as in fig 3 with the same restoring time constant the ice model has no slip conditions along the x boundaries in the ocean the minimum water column thickness hmwct is 1 0 m the porous flux conductivity κpor is 4 s and the porous flux layer thickness ε por is 0 75 m the experiment is carried out on the f plane with coriolis parameter f set to 10 4 all other ice and ocean parameters are as described previously or in table 1 the results are presented in fig 10 overall evolution is similar to the two dimensional experiment though initially a bulge forms at the base of the ice shelf and propagates to the front fig 10 a having a small but noticeable effect on local melt rates due to its effects on sub ice velocity it is not known whether such features form in real ice shelves as they are transient in our model though similar features were observed in the experiments of jordan et al 2017 despite there being no moving grounding line after 40 years the ice stream is nearly completely afloat melt rate response is similar to the two dimensional runs after an initial 5 year adjustment the bulk melt rate increases fig 10 b which coincides with the onset of grounding line retreat and cavity widening deepening vaf loss rates are considerable 50 km3 a which would translate to 0 14 mm a global sea level rise though this number should not be seen as representative as the ice shelf was initially in equilibrium with no melting at all grounded ice loss rates lessen toward the end of the run but as with previous experiments this is likely due to the grounding line approaching the upstream boundary there is a strong overturning circulation under the ice shelf which strongly alters the stratification fig 10 c and e similarly to the two dimensional experiments though this occurs primarily at the western boundary x 0 due to the effects of rotation the coriolis effect can most easily be seen in under ice flow and melt rate fig 10 d and f most melting takes place at depth where water is warm but as geostrophy prevents the buoyant melt laden water from flowing directly up the sloped ice shelf base it flows to the western edge of the domain where boundary effects break the geostrophic constraints as a result velocities are quite high in this boundary as are melt rates yielding considerably more thinning at the western boundary than elsewhere in the shelf ocean driven melting has a strong effect on ice shelf flow as well as can be seen in fig 11 the initial ice configuration i e in steady state with the absence of melting yields a symmetric velocity which moves fastest at the ice shelf front and has very little flow in the transverse direction after 40 years the flow pattern is strongly asymmetric with speeds increasing toward the western side and flow is significantly deflected in the western direction these features can be largely explained by the melt driven channel along the western boundary which allows greater shear within the ice shelf and also induces a flow pattern which acts against the thickness differential this asymmetry however does not express itself in the flow pattern across the grounding line which explains why the grounding line remains roughly straight throughout the simulation 8 discussion the major output of this study is a coupled ice sheet ocean model that can represent grounding line migration over variable topography for which the ocean component can run continuously without requiring mass salt or heat to be arbitrarily moved to different locations numerical experiments were carried out in which far field forcing was applied to the ocean model inducing retreat of an ice sheet over a bathymetry which deepens inland it is fair to point out that these simulations could have been carried out with an asynchronous model and in fact similar experiments have been carried out yielding similar qualitative behaviour however the locally conservative properties of our scheme additionally mean that our methodology can be implemented in a regional or global ocean model without requiring artificial sources and sinks to preserve conservation which would be required with an asynchronous approach additionally asynchronous approaches still leave open the question as to whether ocean dynamics are affected by the intermittent coupling between ice and ocean in effect our approach reduces the coupling time step to the ocean time step and all approaches with longer coupling time steps are an approximation to this solution moreover in the experiments presented here ocean forcing was persistent but in reality forcing of various time scales does occur from centennial time scales reflecting climate changes boning et al 2008 to monthly or potentially weekly time scales reflecting fast glacial processes and subseasonal ocean time scales smith et al 2017 christianson et al 2016 with an asynchronous model forcing the ocean model on time scales on the order of or shorter than the coupling frequency would be problematic as aspects of the coupled evolution would not be captured our synchronous coupling allows for forcing on daily or even hourly time scales our mode of coupling is not yet complete however marine ice sheet models determine the location of the grounding line and the depth of the ice shelf draft by assuming a static ocean of uniform density the same is done in our ice sheet model which is influenced by the ocean through melting only a future plan for development is to allow the floatation of ice to be determined by the ocean state a further advantage of a synchronously coupled ice ocean model is the prospect of an adjoint coupled model adjoint models allow detailed investigation of sensitivities in a manner that would be intractable through standard parameter variation and enable state estimation and uncertainty quantification adjoints of both ice and ocean components are easily and flexibly generated through algorithmic differentiation heimbach and losch 2012 goldberg and heimbach 2013 synchronous coupling between the two now allows for a coupled adjoint a coupled adjoint would allow detailed sensitivities of the coupled ice ocean system to be investigated and could aid in initialization of the coupled system to observations in our implementation a thin layer of ocean is maintained under grounded ice this is essentially a numerical approximation so that the ocean can advance continuously into previously ice covered ground and as with all approximations the thickness of the layer should not strongly impact the model evolution in our sensitivity study in section 6 we vary the thickness of this layer between 1 and 3 m and see little impact in order to allow movement within the layer in the presence of variable topography we introduce a porous flux parameterisation that is driven by a potential which is related to ocean pressure without this parameterisation the layer would need to be considerably thicker than the values stated above in the presence of steep topography the active ocean layer under grounded ice should not be confused with a true subglacial water layer which is fed by basal melting of the ice sheet still the movement of such water is driven by a balance between friction overburden and potential gradient which is essentially what drives the water in our thin ocean layer as such it may be possible to modify the dynamics of the layer slightly to properly represent a subglacial hydrological regime which continuously transitions to an ocean cavity regime this would require significant further investigation and development effort however 9 conclusions we develop a scheme that allows for synchronous coupling between a marine ice sheet model with a dynamic grounding line and a z coordinate ocean model while vertical coupling the continuous evolution of the ice shelf ocean interface due to melting was developed in a separate study jordan et al 2017 this study focuses on horizontal coupling i e the advance and retreat of the ocean s lateral extent with a flat bathymetry little modification to the ocean model is required beyond limiting ice overburden to allow a thin subglacial water layer in the presence of variable topography a porous flux parameterization is required to allow the ocean to infiltrate new areas where ice has thinned to the point of floatation the porous flux is not based on a physical model rather it exists to counter the nonphysical obstruction of water due to the discretization of topography the porous flux transport is small enough that it has negligible effect on the ocean circulation yet it is large enough that ice dynamics remains the controlling factor of grounding line migration in realistic simulations the modifications made to the code are relatively non invasive the major modification is to the poisson equation solved for the implicit free surface evolution this introduces a few unconstrained parameters but sensitivity of model behaviour to these parameters is shown to be small or negligible experiments carried out in two and three dimensions demonstrate physically reasonable behavior suggesting the coupled model is suitable for scientific experimentation acknowledgments we thank editor william perrie and three anonymous reviews for their helpful comments this work was supported in part by nerc grant ne m003590 1 p heimbach and j m campin are supported in part by nsf oce 1737759 and through the nasa project ecco understanding sea level ice and the earth s climate via a jpl caltech subcontract the code used to generate all results is available freely at mitgcm org appendix a implicit bottom drag an implicit backward in time stepping of vertical viscosity is often used in ocean models to avoid the strict limitation on the time step that an explicit forward in time stepping would impose either when vertical viscosity is large e g in mixed layer or with high vertical resolution currently however ocean basal drag is imposed explicitly in mitgcm with dynamical ice shelf coupling grid cells at u and v points on the c grid can go to zero thickness and an unconditionally stable scheme for basal drag with respect to vertical resolution is also required here we describe a new implementation of implicit bottom drag used in this study a 1 without implicit surface or bottom drag we first review the time stepping procedure for implicit vertical viscosity within the hydrostatic z coordinate mitgcm implementation using implicit free surface note what follows immediately describes the scheme for vertical viscosity in mitgcm previous to this study the discretized form of the zonal momentum equations in 2 d plane x z δx δz can be written 23 u n 1 u n δ t g u n 1 2 c u n δ z u n g δ t x η n 1 δ t z ν z u n 1 u g δ t x η n 1 δ t z ν z u n 1 with boundary conditions 24 u n 1 z 0 at the bottom and the surface of the column compare 23 with 13 the two are equivalent but different symbols have been used as shown below u from 13 is the result of inverting the vertical viscosity operator hence the use of a distinct symbol u here and g u n 1 2 represents the processes applied to the previous velocity coriolis advection wind forcing prior to this inversion the function c is written generally and can represent either linear drag quadratic drag or a no slip condition the derivations below do not depend on the specific form 23 can be written as 25 l u n 1 u n 1 δ t z ν z u n 1 u g δ t x η n 1 in the ocean model l is discretized using a finite volume approach yielding a tridiagonal matrix for each column that can be easily inverted independently e g using l u decomposition 26 u n 1 l 1 u g δ l 1 x η n 1 l 1 u g δ t x η n 1 u g δ t x η n 1 where the second equality is due to the particular form of l which only acts on vertical shear without changing the depth integrated transport a 2 with implicit surface or bottom drag here we describe our modification to the above scheme to allow for implicit bottom drag 23 is rewritten as 27 u n 1 u n δ t g u n 1 2 c u n δ z u n 1 g δ t x η n 1 δ t z ν z u n 1 u g δ t x η n 1 c u n δ z u n 1 δ t z ν z u n 1 where u n 1 now appears in the drag term and a new intermediary u u n δ t g u n 1 2 has been defined the equivalent of 26 is 28 u n 1 l d 1 u l d 1 g δ t x η n 1 where the new operator l d is given by 29 l d u n 1 u n 1 c u n δ z u n 1 δ t z ν z u n 1 l d can be discretized similarly to l the one difference being the addition of the surface and or bottom drag terms to the diagonal matrix coefficient in the relevant rows the inversion of l d in the second term on the right hand side of 28 no longer reduces to the identity but instead 28 can be written as 30 u n 1 l d 1 u g δ t x η n 1 l d 1 i where i is a function equal to unity in the vertical note l d 1 i is a function of depth which we will refer to as j if we now redefine u as l d 1 u then 14 the elliptic equation to be solved for η n 1 now becomes 31 x g h n j n x η n 1 1 δ t 2 η n 1 f w ρ r e f δ t 1 δ t 2 η n 1 δ t x h n u where j n is the vertical average of j at time n which becomes a weighting factor in the elliptic operator that is solved for the free surface update 
24114,synchronous coupling is developed between an ice sheet model and a z coordinate ocean model the mitgcm a previously developed scheme to allow continuous vertical movement of the ice ocean interface of a floating ice shelf vertical coupling is built upon to allow continuous movement of the grounding line or point of floatation of the ice sheet horizontal coupling horizontal coupling is implemented through the maintenance of a thin layer of ocean 1 m under grounded ice which is inflated into the real ocean as the ice ungrounds this is accomplished through a modification of the ocean model s nonlinear free surface evolution in a manner akin to a hydrological model in the presence of steep bathymetry the coupled model is applied to a number of idealized geometries and shown to successfully represent ocean forced marine ice sheet retreat while maintaining a continuous ocean circulation keywords glaciology ice ocean interaction moving boundary 1 introduction a number of important physical processes in coastal oceanography involve the horizontal influx of water into regions that were previously dry as well as the complete removal of water from other regions that were at some point wet in estuarine regions submerged boundaries change with the tidal cycle and numerical codes which attempt to model important biological and geomorphological processes must capture this wetting and drying accurately hardy et al 2000 de brye et al 2010 flood models of storm surge must properly capture the advance and retreat of the flooding front van t hof and vollebregt 2005 there is an extensive numerical literature which deals with the problem of encroaching and retreating coastal flows medeiros and hagen 2013 there is however an important coastal oceanographic process not often discussed in the computational literature surrounding wetting and drying problems in antarctica and to a lesser extent greenland and likely elsewhere during past glaciations the ice sheet is marine terminating it extends into the ocean in the form of large floating ice shelves due to the relatively small ice ocean density differential this occurs at depths 500 1000 m below sea level the location where the ice sheet goes afloat called the grounding line is a topic of much discussion in the literature surrounding ice sheet dynamics this is due to it being a sharp transition between two very different regimes of ice flow vieli and payne 2003 pattyn et al 2006 schoof and hewitt 2013 from an ice dynamics perspective determining the floatation point is equivalent to a viscous contact problem one which requires very sophisticated numerical schemes schoof 2011 although certain approximations make the problem more tractable goldberg et al 2009 cornford et al 2013 the focus of this paper however is not on the glaciological dynamics of grounding line migration but rather on the coupling between the ice and the ocean underneath the ocean circulates in a cavity bounded above and below by the ice shelf and bedrock respectively and on the landward side by the grounding line where the water column depth pinches off the circulation within the cavity is influenced by density variation and by the topography of the ice shelf and sea bed macayeal 1984 from the ocean s perspective the ice sheet ice shelf presents itself as variable surface pressure and when the surface pressure favors the flooding of previously dry domain the ocean will do so aside from the spatially varying surface pressure the problem is analogous to run up on a sloped beach this wetting drying problem is quite an important one in the context of antarctic ice sheet contributions to sea level rise melting and thinning of floating ice does not contribute significantly to sea level change jenkins and holland 2007 but retreat of the grounding line towards the interior represents loss of grounded ice which does moreover if the depth of the bed deepens inland as is the case around much of the antarctic coastline fretwell et al 2013 retreat of the grounding line can lead to an increase in ice sheet thinning rates upstream potentially leading to a positive feedback effect weertman 1974 schoof 2007b vaughan and arthern 2007 yet most ocean models including those adapted to study ice shelf ocean interactions e g holland and jenkins 2001 little et al 2008 walker and holland 2007 gwyther et al 2014 have not implemented such wetting and drying there are two important differences between the ice sheet wetting drying problem and the standard coastal wetting drying problem firstly while the latter can be addressed through shallow water equations the former must be addressed by a three dimensional model representing baroclinic motions in the ocean and therefore must represent active tracer heat and salt evolution as well as an evolving upper boundary the base of the ice shelf hence the approaches used for wetting drying problems in coastal oceanography cannot be straightforwardly transferred to ocean models secondly the wetting front advance and retreat associated with grounding line change is much slower than in flooding and storm surge problems with observed retreat rates of up to 3 km year rignot et al 2014 but often much slower the separation of time scales allows for quasi static discontinuous approaches in which a sequence of ocean runs are carried out with fixed cavity geometries with the geometry sequence arising from the evolution of the ice sheet model grosfeld and sandhager 2004 goldberg et al 2012 de rydt and gudmundsson 2016 such an approach makes the assumption that a given geometry and far field oceanic conditions will lead to a unique circulation which may not be the case e g if the ocean cavity is still in a transient state when the ice adjusts additionally the ocean model must be spun up with each coupled time step making the approach unsuitable for regional or global ocean models more recently efforts have been made to retain the ocean state during adjustments to the cavity geometry such asynchronous approaches are still not ideal typical coupling frequencies of a month to a year may lead to significant depth changes in the ice ocean interface upon geometry updates the necessary infilling with predefined water properties can lead to violations of mass and tracer conservation as well as significant nonphysical adjustments in one instance the latter has been addressed through imposing that barotropic velocities remain fixed between updates asay davis et al 2016 still it seems clear that a synchronous approach i e one in which the ocean geometry is adjusted on or close to the ocean time step is a preferable approach to modelling ice sheet ocean interactions on continental and global scales particularly if the ocean is subject to forcing on fast time scales such as changes in wind stress christianson et al 2016 and episodic additions of fresh water smith et al 2017 in this paper we modify the massachusetts institute of technology general circulation model mitgcm marshall et al 1997 to allow for synchronous coupling of an ice sheet and ocean model mitgcm is a general purpose fluid solver for simulating process level to global scale ocean circulation that is usually configured in hydrostatic and boussinesq approximations in vertical z coordinates as has been done in the present study components of the development have been completed previous to this study the most important of which allows continuous thinning and thickening of a floating ice shelf which we term vertical coupling jordan et al 2017 here we focus primarily on a scheme to allow for both grounded and floating ice and a dynamic grounding line horizontal coupling in the following we briefly discuss the vertical coupling scheme and demonstrate how it can be used to allow for grounding line migration over a flat bed topography with minimal code changes we then discuss the difficulties involved with variable bed topography which are common to all z coordinate models and present a strategy to overcome them which involves combining the ocean model algorithm with a scheme akin to flow through a porous medium finally we present results from the first three dimensional synchronously coupled ice ocean model of marine ice sheet retreat 2 flat topography methodology with a flat bed topography we are able to cleanly simulate synchronous coupled grounding line migration by making use of recent novel developments within mitgcm to allow for vertical coupling defined above the work builds on previous developments to allow thermodynamic ice shelf ocean interactions within mitgcm losch 2008 dansereau et al 2014 as well as the development of an ice sheet component within the modelling framework goldberg and heimbach 2013 vertical coupling is described in detail in jordan et al 2017 but we briefly describe those components which are relevant to our study in order to provide context for our results and for our further developments of the model note that we refer below to the z coordinate implementation not the z implementation adcroft and campin 2004 2 1 vertical coupling in this subsection we give details of vertical coupling and the mitgcm glacial flow model which are also described in jordan et al 2017 readers familiar with this paper might skip to section 2 3 vertical coupling within mitgcm hinges on the nonlinear free surface capabilities of the model campin et al 2004 the free surface elevation η defined relative to a reference surface elevation z d which for the ice free ocean is d 0 but for a cell occupied by the ice shelf is generalised to the height of the ocean ice shelf z d in losch 2008 η is updated in each time step in a fully mass heat and salt conserving fashion and responds both to barotropic pressure gradients and to gradients in surface load psurf which is imposed as the weight per unit area of the ice shelf as flexural stresses within the ice shelf are not presently considered 1 p s u r f ρ i g h under the ice shelf where g is gravitational acceleration ρi is ice density and h is ice thickness which is updated at each time step in response to ice dynamics and basal melting or freezing the ice model rather than updating its velocity and thickness at the same time as is common practice in ice sheet modelling updates its thickness on the ocean time step velocity updates which are more costly take place every 12 h but this is acceptable as velocity change induced by thickness changes on this time scale is very small in this manner the surface load can be updated smoothly without exposing the ocean to sudden large changes in surface pressure as the ice and ocean codes are both components of mitgcm there is no issue passing ice thickness to the ocean code and melt rate to the ice code in the z coordinate free surface implementation of mitgcm the height of the top level cell grows with η in contrast to the z coordinate implementation in which cells thicken and thin uniformly in a column without intervention this can either lead to poor representation of the ice ocean boundary layer jenkins 2016 as the ice thins or to negative cell height as the ice thickens to this end a remeshing algorithm has been implemented upon initialisation of mitgcm model cells are flagged as being either ice or ocean the remeshing process essentially allows cells to switch from ice to ocean and vice versa within a model run and without the need to reinitialise ice and ocean masks whilst the topmost ocean cell thickness in a given column evolves every time step at predetermined intervals we check to see if it has grown above a splitting threshold or below a merging threshold in either event a remeshing process is triggered whereby cells that are too thick are split into two separate cells and cells that are too thin are merged with the cell below see fig 1 for visualisation in both cases salt temperature mass and momentum are locally conserved in the present study the splitting and merging thresholds are 1 3 and 0 29 times the baseline cell thickness in all simulations 2 2 ice sheet shelf model the ocean model is coupled to the mitgcm ice sheet flow model developed within the mitgcm code and described briefly in the following glacial ice is modelled as a slowly flowing viscous fluid with a non newtonian power law rheology cuffey and paterson 2010 due to its viscous nature forces are at all times in balance and its velocity field is determined by its geometry schoof and hewitt 2013 thus reducing the navier stokes equations to a stokes flow problem the mitgcm ice model uses an approximate force balance in which the forces within the ice sheet are considered to be hydrostatic and membrane stresses internal stresses which transmit force horizontally are considered depth uniform schoof and hewitt 2013 it has been shown that such an approximation is appropriate where motion is dominated by either vertical shearing or along flow stretching and cross flow shearing schoof and hindmarsh 2010 goldberg 2011 which encompasses most flow regimes in antarctica the equations solved for velocity see goldberg 2011 for further detail are 2 x h ν 4 u x 2 v y y h ν v x u y β 2 u b ρ i g h s x 3 x h ν v x u y y h ν 4 v y 2 u x β 2 v b ρ i g h s y 4 ν a 1 n 2 u x 2 v y 2 u x v y 1 4 u y v x 2 1 4 u z 2 1 4 v z 2 1 n 2 n here h is vertical ice thickness s is surface elevation u u v is horizontal ice velocity and ρi is ice density overbars indicate vertical averaging while the b subscript indicates basal velocities a linear frictional sliding law is prescribed by 2 and 3 for which β 2 is the sliding coefficient the exponent of 2 indicating it is strictly positive the above equations differ for floating ice ice shelves only in that β 0 the rheology is determined by glen s law cuffey and paterson 2010 wherein n 3 and a is a parameter governed by the fabric and temperature of the ice in this study β is uniform under grounded ice and a is uniform as well all relevant parameter values can be found in table 1 at the horizontal boundary between ice and open ocean the calving front the conditions on the velocity equations are 5 h ν 4 u x 2 v y n x h ν v x u y n y 1 2 h 2 ρ r e f ρ i z l o w 2 ρ i g n x 6 h ν v x u y n x h ν 4 v y 2 u x n y 1 2 h 2 ρ r e f ρ i z l o w 2 ρ i g n y where n n x n y is the seaward normal to the calving front ρref is the ocean reference density and zlow is ocean bathymetry at all other lateral boundaries we impose no slip conditions on the ice model the ice thickness evolves as a result of horizontal ice mass flux divergence and surface and basal mass balance the last of which takes place only where ice is floating the evolution equation is 7 h t h u m a where m is ice shelf mass balance positive where ice is melting and a surface mass balance set to zero in this study the grounding line is dynamic and is determined by a simple floatation condition a consequence of the assumption of hydrostasy 8 ρ i h ρ r e f z l o w and where ice is floating the surface and basal elevation b depends only on thickness and reference densities 9 s 1 ρ i ρ r e f h 10 b ρ i ρ r e f h note that the criterion 8 is not consistent with the ocean model criterion i e that implied by mmin in 15 and the basal elevation b is not necessarily equal to the upper surface of the ocean in our simulations though the two floatation criteria are not seen to disagree by more than a grid cell it would be straightforward to modify the ice flow model to enforce these consistencies though for the present study we have not done so ice sheet models generally evolve thickness and velocities with the same time step but to evolve both on the ocean time step would be prohibitive rather a split approach is taken it is seen from eq 4 that the equations for velocity are nonlinear and must be solved iteratively in uncoupled mode the mitgcm ice model solves a sequence of linear elliptic partial differential equations to a required tolerance the number of iterations required depends on the change in thickness over a time step in our coupled model we take a single such iteration once to twice daily in jordan et al 2017 it is shown this approach maintains convergence of the velocity solution meanwhile ice thickness is evolved on the ocean time step the most recent velocities are used in eq 7 for brevity we omit details on the thermodynamic coupling between ice and ocean the basic equations are given in holland and jenkins 1999 and have been implemented in mitgcm by losch 2008 and dansereau et al 2014 and modified by jordan et al 2017 to allow for real rather than virtual fresh water fluxes aside from those listed in table 1 all parameters relevant to the melt are as in dansereau et al 2014 2 2 1 parameterised buttressing in some of the results in this paper a two dimensional x z flowline ice model is considered coupled to a corresponding two dimensional ocean model i e coriolis forces are omitted to enable long model runs that are computationally cheaper this removes the effect of buttressing whereby confining stresses acting on the ice shelf are transmitted back to the grounding line slowing grounded ice motion thomas 1979 ocean melting feeds back on ice sheet flow by thinning the ice shelf which reduces buttressing the lack of buttressing is dealt with through a parameterisation which makes a further approximation that the along flow normal stresses in the ice shelf do not vary across the shelf dupont and alley 2005 assuming flow is in the y direction eq 3 becomes 11 y h ν v y β 2 v b h w 5 v a w 1 n ρ i g h s y here w is the half width of the ice sheet ice shelf treated as constant in the three dimensional simulation we present later the buttressing parameterisation is not needed 2 3 subglacial layer the method of vertical coupling described above has been thoroughly tested in the case of ice shelves with no grounded component jordan et al 2017 however alone it cannot be used to simulate grounding line migration the difficulties in implementing such a capability are linked to the way in which the ocean surface is evolved here the present algorithm for free surface evolution in mitgcm is briefly discussed for further detail see marshall et al 1997 and campin et al 2004 in one horizontal dimension the free surface equation can be written 12 η n 1 η n δ t f w ρ r e f x h n u n 1 here the n and n 1 superscripts represent the current and new time steps not to be confused with n in eq 4 fw represents net fresh water flux combined precipitation evaporation run off ice shelf melting and freezing as a mass flux in kg s h is ocean column thickness u is velocity the overbar represents a vertical average while the superscript indicates both the update of velocity from time n due to inertia baroclinic pressure viscous effects etc referred to below as g u n 1 2 as well as a correction due to momentum imparted by the barotropic pressure gradient over a time step 13 u n 1 u n δ t g u n 1 2 g δ t x η n 1 u g δ t x η n 1 combining the two yields the following equation for η n 1 14 x g h n x η n 1 1 δ t 2 η n 1 f w ρ r e f δ t 1 δ t 2 η n 1 δ t x h n u this elliptic partial differential equation which in two horizontal dimensions requires a large linear system solver such as conjugate gradients arises from the use of η n 1 in the right hand side of 13 rather than ηn this implicit approach damps high frequency barotropic waves and computational modes dukowicz and smith 1994 it also allows for tractable ocean simulation by greatly increasing the allowable time step on the other hand it causes difficulties transporting fluid into ocean columns which were previously dry column thickness zero if the equation were solved over portions of the domain with zero thickness there is no guarantee that negative thicknesses would not arise a compromise to maintain the efficiency of an implicit free surface is to maintain a thin ocean layer under all regions of the ice sheet which could potentially unground a so called thin film approach to wetting and drying medeiros and hagen 2013 the only complication arising is the fact that the weight of a grounded ice column can be far greater than the weight of the ocean column it replaces driving a strong pressure gradient which will quickly deflate such a layer to address this we modify the definition of psurf above a minimum ice mass mmin is defined as the minimum mass required for ice to be grounded 15 m m i n z l o w h m w c t z s l ρ a v g z d z where zlow is the same as that used for the ice flow model ρavg is the horizontally averaged density over all ocean filled cells at a given grid level and zsl is the ocean surface height averaged over the ice free ocean hmwct is the minimum water column thickness the definition of psurf above is modified as follows 16 p s u r f g m e f f where 17 m e f f ρ i h 1 a 2 g f a c 1 a 2 a m m i n ɛ m 1 ρ i h 2 g f a c tanh 1 ɛ m 2 m m i n ρ i h accordingly the load felt by the ocean is the actual weight of the ice column where ice is floating i e where ρih meff and is equal to mmin under grounded ice with a narrow transition between the two regimes around the grounding line as shown for a simple example in fig 2 the result is that when ice is thin enough to float with an ocean column of at least hmwct the full load of the ice is felt above this the load is reduced note that 17 is heuristically defined to achieve a certain effect rather than arising from physical principles we further impose that there is no melting where ρih meff the approach has already been used in another study snow et al 2017 in all results presented ε m1 is 0 01 and ε m2 is 10 5 the sensitivity of results to hmwct is tested later in the paper 3 flat topography experiment to illustrate the applicability of the subglacial water layer method described in section 2 3 a simple two dimensional x z coupled model with a flat topography is applied the coupled ice ocean model is initialised in a two dimensional domain implemented through free slip ocean walls and setting the coriolis parameter to zero the domain is 320 km long with a horizontal resolution of 800 m bathymetry is 1000 m uniformly and vertical resolution is 10 m the ice flows into the domain at x 0 with a fixed volume flux of 4 105 m2 yr per unit width an initial calving front is specified at x 240 km the ice front can retreat from this point by thinning to zero thickness but cannot advance beyond it the ocean model extends to x 320 km and is forced with a sponge layer extending over the last 20 grid cells of the domain in the sponge layer temperature and salinity are relaxed to the profile in fig 3 a with a time constant varying from 2 days at the domain boundary to 10 days at the edge of the sponge layer the target thickness of the subglacial water layer hmwct is 1 m the ice sheet model is initialized without coupling to the ocean and run to a steady state the coupled model is then initialised using this ice sheet geometry and with a time step of 200 s and run until either a steady state or complete ungrounding of the ice stream is reached as in snow et al 2017 velocities at the open ocean boundary are adjusted in response to the spatially averaged open ocean surface elevation in order to maintain sea levels without doing so sea level would adjust considerably in response to grounded ice loss due to the small ocean domain however these velocities are small on the order of millimeters per second or less and do not strongly affect ocean circulation in the initial ice state see fig 4 c the ice is flowing across the grounding line at 300 m a increasing to 700 m a at the ice shelf front initial temperature and salinity are uniformly 1 c and 34 2 psu respectively as the flushing time of the cavity is short on the order of days to weeks we do not expect this to affect coupled evolution significantly movement in the subglacial water layer is far slower so the impact of its initial conditions must be investigated this is done in section 6 fig 4 summarizes the results of the experiment fig 4 a shows the evolution of the ice sheet ice shelf geometry there is rapid thinning of the ice shelf to a new shape superimposed on near steady grounding line retreat the grounding line retreat occurs due to a thinning of grounded ice which is a response to an increase of ice flux across the grounding line due to ice shelf thinning and buttressing loss the movement of a grounding line can be a challenging computational issue in ice sheet modelling goldberg et al 2009 but it has been shown that in the presence of relatively weak beds and narrow channel widths resolution of 1 2 km is sufficient to represent this process gladstone et al 2012 thus we are confident that the experiments in this study are able to do so the thinning and retreat of the ice sheet is encapsulated in a measure known as volume above floatation vaf defined as the area integral of h ρ r e f ρ i z l o w where indicates the positive part and the negative part of the quantity vaf represents the volume of ice that if melted would contribute to sea level rise floating ice makes no contribution fig 4 d and f illustrate this concept the profiles of actual mass are shown as well as the effective mass felt by the ocean cf fig 2 the difference between the two profiles is the mass of the ice above floatation the rate of loss of vaf steadily increases as the ice shelf thins fig 4 b but when the grounding line retreats substantially and the ice shelf lengthens the vaf loss decelerates and eventually slows to zero while this may be due to increased buttressing from an increasing lateral ice shelf area e g little et al 2012 it is more likely because of the diminishing ice sheet having increasingly less volume above floatation to lose melt rate profiles fig 4 d and f appear quite different between the early and late stages of the simulation reflecting the different ice shelf profiles fig 4 c and e melt rate is controlled by nearby ocean temperature as well as ocean velocity melt rate is therefore higher in deeper waters where water is warmer and in areas of steeper shelf slope which drive faster flow of melt buoyed water this melt freshened water causes an overturning circulation which is closed by the sponge but does not strongly affect the stratification in the ocean interior the jagged appearance of the melt rate is related to the striped pattern discussed in losch 2008 and indicates the transition of the ice shelf base into a new vertical level the boundary layer parameterization of losch 2008 which averages relevant ocean properties salinity temperature velocity and surface fluxes over a full vertical cell thickness alleviates this variability somewhat in the static shelf case and jordan et al 2017 modifies the parameterization for vertical coupling this variability would be problematic if it reinforced itself i e if it led to ice shelf thinning in a sawtooth pattern which exacerbated the variability in fact the opposite is observed to happen therefore the stripes do not amplify significantly over time and importantly do not affect coupled dynamics it is important to note that despite appearances the dominant direction of melting is vertically not horizontally in reality this is due to the low ice shelf aspect ratio in mitgcm it is explicit as melt is not applied to vertical cell faces grounded ice is lost because the ice shelf which buttresses the flow is thinned finally it is seen that while the under ice layer of water evolves figs 4 b its fluctuations are small giving confidence that even thinner layers could potentially be used here the smallest layer we consider is 1 m 4 variable topography methodology the simulation presented in the previous section is a completely synchronous simulation of a marine ice sheet with a dynamic grounding line coupled to an ocean model it is limiting however in that the bathymetry is constant the true interest in coupled ice sheet ice shelf ocean dynamics arises because of variable topography in particular large parts of antarctica rest on a bed that is well below sea level more than a km in places and deepens inland fretwell et al 2013 the effects of buttressing aside the rate of flow of a marine ice sheet across its grounding line depends strongly on bed depth at that location weertman 1974 schoof 2007b this means that if the grounding line of an ice sheet were to retreat over an inland deepening bed the rate of grounded ice loss would increase and so would grounded ice thinning rates leading to further grounding line retreat ice shelf buttressing represents a stabilizing process goldberg et al 2009 gudmundsson 2013 but ice ocean dynamics could potentially affect this stability leading to increased melt rates as grounding lines retreat and ice shelf cavities change shape jacobs et al 2011 de rydt et al 2014 a difficulty arises however in attempting to apply the methodology presented in section 2 to varying topography this is because in a z level coordinate ocean model fluid cells can only communicate with cells which are directly adjacent consider the schematic in fig 5 in columns 1 and 2 ice is thicker than its floatation thickness the subglacial water layer described in section 2 3 should remain at or near hmwct in column 3 ice has dropped below its floatation thickness and in column 4 ice is fully floating with a flat bathymetry water would simply flow from the column 4 into the column 3 as the ice thins and the load on the column decreases and would do so in accordance with the mass and momentum balances of the ocean model however there is no hydraulic connectivity between any of the cells in columns 3 and 4 and therefore this cannot happen as the ice in column 3 thins further fluid may flow from the column 2 increasing the depth of column 3 there are two possibilities either column 2 will thin to zero causing an error or the fluid cell in column 3 will thicken enough to split into two cells the upper one of which is hydraulically connected to column 4 however the pressure differential between columns 3 and 4 could be enormous leading to tsunami generation and disturbance such disturbances are artificial a result of finite mesh spacing here we seek to minimize the disturbance one solution is to find combinations of horizontal and vertical resolution and subglacial water layer depth that ensure a hydraulic connection between all cells at all times this could become quite complex and could lead to either unfeasibly high resolution or subglacial water layers so thick they can no longer be considered negligible for instance the bathymetry for a recent ice ocean coupling intercomparison asay davis et al 2016 would lead to layer thicknesses up to 50 m with 1 km horizontal resolution a high resolution for such a large domain an alternative solution and the one presented in this study is to allow hydraulic connectivity even between cells that are not at the same z level models of subglacial hydrology e g schoof 2010 werder et al 2013 follow such a solution thus avoiding constraints regarding the transfer of fluid between different elevations they define a hydraulic potential which replaces pressure as a driving force our aim is to implement this property within the mitgcm ocean model in certain cases we stress that our subglacial water layer is in no sense meant to represent the actual flow of water under ice sheets which is extremely heterogeneous with rate factors highly dependent on the direction of flow hewitt 2013 rather it is a compromise to enable the use of an ocean gcm for a problem for which it was not originally designed as such the implementation of hydraulic fluxes within the layer is simply a means of allowing the layer to fill its purpose that is to thicken or thin in a locally mass salt and heat conservative manner when variations in ice overburden force it to do so returning to the schematic in fig 5 in order to allow fluid to move freely from the column 4 to column 3 as well as columns 1 and 2 when hydraulic potential makes this favorable several developments are necessary beyond those made in section 2 and they are discussed below 4 1 porous flux the issue illustrated by fig 5 arises because the ocean floor and ice shelf base are discretized to the ocean grid in reality there should in general be pathways and conduits for the water to follow and if narrow enough these conduits will be controlled by lubricating flow to represent this flow we modify eq 12 to be 18 η n 1 η n δ t f w ρ r e f x h n u n 1 q where q is a porous flux defined at velocity points in mitgcm s c grid equal to 19 q κ p o r d p o r x φ κ p o r d p o r g x η n 1 x ψ l o w κ p o r d p o r g x η n 1 x p l o w p l o w ρ r e f where κpor and dpor are defined below note the second expression above decomposes φ into its free surface and baroclinic components and the third defines ψlow p is the baroclinic component of the pressure that is the component due to the vertical integral of density from z 0 p l o w is the baroclinic pressure component at the center of the lowest cell of each column plow is taken from p z a horizontal average pressure profile which in turn is found from a horizontally averaged density profile ρ z h where the h subscript is to distinguish from the vertical average in eq 12 ρ z h is found by averaging over all fluid filled cells at each depth level using ρref in any levels that contain no such cells the definition of ψlow may be unfamiliar to readers and can be reasoned as follows the potential governing flow in hydrology models e g schoof 2010 werder et al 2013 can be seen as the deviation of pressure from a reference pressure profile one that is derived via a constant density our reference pressure rather is derived from a reference density profile i e ρ z h our definition of φ is used on the basis that its gradients transition smoothly to ocean pressure gradients when the subglacial water layer thickens as shown below and that it minimizes movement far inland from the grounding line dpor depends on the total thickness of the ocean column h and is defined as 20 d p o r ɛ p o r 1 2 π cos π h 2 ɛ p o r h h ɛ p o r 0 h ɛ p o r see also fig 2 and κpor and ε por are parameters to be set this definition ensures the porous flux transitions smoothly to zero as h increases from zero to ε por the product κpordpor resembles a hydraulic conductivity but in no way is it meant to represent the true hydraulic conductivity of the subglacial hydrological system for two adjacent cells at the same z level q is such that if they are equalised with respect to the porous flux there should not be any ocean pressure gradient either if the grounding line in fig 5 retreats further and a connection is established between columns 1 and 2 there will be little to no pressure gradient driving flow the same is not true for columns 3 and 4 since ψlow corresponds to level k 1 in column 3 and to level k in column 4 once connectivity is established assuming equalisation of the porous flux the difference in φ at level k between columns 3 and 4 due to baroclinic effects is 21 g ρ r e f z k 1 z k ρ z ρ z h d z where ρ z ρ z h is the deviation from the horizontally averaged density profile in column 3 with a bedrock step of 50 m over a single grid cell of 1 km width and an average deviation of 0 2 kg m3 this will yield a potential difference of 0 1 m2 s2 yielding an acceleration of 10 4 m s2 when connection is established this is not a large acceleration while it is likely an overestimate of density variations but this error should be kept in mind it is straightforward to implement this porous flux implementation eq 14 the elliptic equation for the updated free surface η n 1 becomes 22 x g h n κ p o r d p o r n δ t x η n 1 1 δ t 2 η n 1 f w ρ r e f δ t 1 δ t 2 η n 1 δ t x h n u κ p o r d p o r n δ t ψ l o w n the free surface calculation is independent from the thermodynamic component of the ocean model the above changes enable transport of mass across barriers to the ocean model but not tracers temperature and salinity and any passive tracers we enable this transport with a simple first order upwind scheme between the two extremal cells on either side of a boundary where porous flux is nonzero where extremal means the exchange is between the top fluid containing cell in one column and the bottom of another or vice versa our parameterization bears similarity to a bottom boundary layer parameterization bblp which has been developed in several variants in ocean models in order to represent small scale dense overflows killworth 2003 our parameterization is distinct from most bblp s in that there is a net transfer of mass as well as tracer on the other hand we do not search for neutral density levels between which to transfer heat and salt which is done by some overflow parameterizations campin and goosse 1999 the flux q exists simply because the discretisation of topography prevents a smooth advance of the ocean into new regions opened up by thinning ice for the rate of grounding line retreat not to be limited by the porous flux parameters κpor or ε por the flux q must be large enough that the pressure of the subglacial water layer is roughly equalised with that of the ice shelf cavity i e porous flux must not be a limiting factor it is worth considering typical magnitudes of q assume that in an ice stream the upstream region within 5 km of the grounding line were thinning at an average rate of 50 m yr almost an order of magnitude larger than even the fastest thinning ice streams today if this region were going afloat a volume flux of 0 008 m2 s into the newly created cavity would be required implying velocities of a similar magnitude if ε por 1 m such velocities would not disrupt the circulation within the cavity nevertheless in subsequent sections we investigate the sensitivity of large scale behaviour to the porous flux parameters 4 2 implicit bottom drag at tracer points i e at cell centers fluid cell thicknesses are prevented from becoming too thin however grounding line migration over variable topography means cell thicknesses at u and v points have no lower limit this is problematic as bottom drag in the mitgcm ocean model is explicit and this leads to numerical instability in cells that are too thin a new scheme for implicit bottom drag has been developed in mitgcm the scheme is a modification of the already existing scheme for implicit vertical viscosity as the former is best understood in terms of the latter an explanation of both is given in the appendix a 5 variable topography experiment to illustrate the implementation of the porous flux scheme an experiment similar to that of section 3 is carried out but with variable topography the bed shallows from 2090 m at x 0 to 900 m at x 320 km a slope of 0 005 which is steep for the average bed slope of an ice stream fretwell et al 2013 ice model input flux is 5 105 m2 yr per unit width the profile to which the ocean is relaxed is shown in fig 3 b which has slightly cooler water 1 c at depth but is otherwise similar all other parameters are identical to those in section 3 save those relating to the porous flux parameterization the experiment is initialized in the same fashion by first steadying the ice flow model without any basal melting and then initialising the coupled model with resulting ice thickness in fig 6 results are shown for a 24 year run with h m w c t 3 κpor 4 0 s and ε por 0 75 m κpor and ε por are chosen to yield porous fluxes on the order of 10 4 10 3 m2 s during fast retreat despite the slightly cooler water the ice stream ungrounds completely in approximately 16 years the induced circulation is seen to have a much stronger influence on stratification in the cavity than in the flat bed case once the grounding line has retreated and the ice shelf changed shape considerably multiple overturning cells can be seen fig 6 e in this case the melt plume is reaching neutral buoyancy and flowing out of the cavity at depth with a distinct plume forming above this depth as with the flat bed experiment vaf loss rate begins to decrease past a certain point but again this is likely due to the vanishing of the ice stream vaf loss rates are much larger than in the flat bed experiment moreover in the flat bed experiment the rate of acceleration of vaf loss is constantly decreasing i e the curvature of the plot d 3 v a f d t 3 is positive this means there is acceleration of vaf loss but it is slowing here there is downward curvature around year 7 indicating an instability related to the shape of the bed as discussed previously there is known to be an instability related to ice dynamics when a grounding line retreats over a deepening bed however it can be seen as well that melt rates increase as the cavity expands due in turn to an strengthened circulation jacobs et al 2011 and a depression of the freezing point with depth the subglacial water layer thickness fig 6 b exhibits centimeter and decimeter scale fluctuations rather than the millimeter scale fluctuations in the flat bed experiment the short term fluctuations may be related to ungrounding if an ice shelf grid cell just downstream of the grounding line is undergoing strong dynamic thinning it can induce low pressures which could draw in water from the subglacial water layer this reduces the layer thickness by no more than a centimeter however despite the strong retreat seen in the simulation the largest drop in layer thickness is seen when the ice goes completely afloat which may be due to interaction between the grounding line the subglacial water layer and the domain boundary we anticipate though that in normal use the solution will be terminated before the grounding line reaches the edge of the domain as such in the sensitivity tests below we truncate the experiment after 12 years 6 sensitity to porous flow parameters a parameterisation has been introduced to an ocean model and it is not a parameterisation based on a physical process but rather to circumvent an unrealistic constraint placed upon the ocean by the discretization of topography it must be shown then that the behavior of the model is not sensitive to the parameters involved with the parameterisation namely κpor and ε por the hydraulic conductivity and thickness scale of the porous flux layer the minimum water column thickness hmwct plays a similar role it is not related to the actual subglacial water thickness but exists instead to prevent the water column from becoming negative we test the impact of all three parameters on the outcome of the experiment of section 5 as discussed in section 4 1 the influence of κpor and ε por should be minimal as long as fluxes are a large enough to keep pace with the thinning of grounded ice but b small enough that any induced movement is low table 2 details the values investigated in experiments 1a f each parameter is varied independently κpor is halved and ε por is doubled relative to section 5 and hmwct is decreased to 2 m and to 1 m this parameter variation is seen to affect vaf by at most 0 15 over 12 years of simulation fig 7 a melt rates vary by at most 1 fig 7 b at the end of the 12 years during which the grounding line has retreated 80 km and ice has thinned over a kilometer in places the variation leads to differences of at most 6 m in ice thickness fig 7 c overall these purely numerical parameters seem to have very little effect on the evolution of the coupled system the reference density ρref is also varied a small change in this parameter has little effect on ocean circulation but as discussed above it affects hydraulic potential gradients in the subglacial water layer the effect of decreasing ρref by 3 kg m3 is quite small notably it thins the subglacial water layer slightly close to the upstream boundary fig 7 c it is important to establish that coupled evolution does not depend critically on melt rates in the near vicinity of the grounding line as this is where circulation is most likely to be affected by the presence of the subglacial water layer and porous flux parameterisation to this end we mask out melting when the ocean column is below a certain thickness zmelt and vary this threshold between 0 and 10 m see experiments 2a c in table 2 the effect on coupled evolution is very small fig 7 d f a number of studies have suggested that in the absence of tidal mixing or significant subglacial runoff melt rates are small within a short distance 3 5 km of the grounding line as water flowing up the underside of the shelf must gain sufficient buoyancy before substantial mixing of heat to the ice ocean interface can occur little et al 2009 seroussi et al 2017 thus we are confident that this relative unimportance of melt rates where the ocean column is 10 m will carry to other settings finally the initial conditions of the subglacial water layer are investigated as mentioned previously movement in the layer is negligible far from the grounding line as is transport of heat and salt therefore initial conditions in the layer will persist we carry out two additional sensitivity tests experiments 3a b in table 2 in these experiments initial temperature in the layer either linearly increases to 1 0 c or decreases linearly to 0 8 c with distance from the grounding line the range of variability seen is similar to that of other sensitivity experiments fig 7 d f a possible reason is that where the ocean column is thin either under grounded ice or very close to it movement is so slow that thermodynamic processes such as diffusion mixing and very low rates of melt are sufficient to homogenize the ocean conditions and shield the cavity from the conditions of the subglacial water layer the impact of not using the porous flux parameterization at all can be observed by setting all relevant parameters to zero except hmwct which is necessarily nonzero to allow grounding line retreat see experiment 4 in table 2 the results are shown in fig 8 the result is shown from the perspective of the ocean for which the grounding line does not retreat at all despite significant thinning of the ice shelf this can be understood in reference to fig 5 due to ice shelf thinning the ice in column 3 has thinned sufficiently to go afloat but for the ocean column to inflate water must flow in from column 4 and it cannot from the ice model perspective the grounding line has retreated as mentioned in section 2 2 the ice model calculates its own grounding line irrespective of the ocean model the ocean model only influences the ice model through melting as plotted in fig 8 a the ice surface appears to have a local maximum but this is only from the ocean perspective nevertheless the ice sheet has not thinned as much as in fig 6 e as the ocean cavity has not increased in extent if the ice model were to determine its grounding line position based on ocean column thickness rather than ice thickness there would still be little grounding line retreat and the ice would have thinned even less but as mentioned in section 2 2 this modification is not made to the ice model in the present study we infer that at least for our simplified two dimensional experiment coupled evolution is insensitive to porous flux parameters within a reasonable range but excluding porous flux altogether over steep topography can be problematic 6 1 advancing grounding line in all prior experiments coupled grounding line retreat has been demonstrated but for our method to be robust it must be shown that grounding line advance can be simulated as well we carry out three additional experiments where the steep topography runs detailed above are halted after 8 years and exposed to a step change in far field oceanic conditions by lowering temperature to 1 9 c uniformly at the boundary one additional change is made the buttressing half width w is decreased from 25 to 15 km the reason for this change is that it was found the ice stream has reached a point of instability after 8 years of retreat from this point the grounding line will continue its retreat without stopping even if melt rates are set to zero this instability is often referred to as the marine ice sheet instability weertman 1974 schoof 2007a in which grounding line retreat on a seaward sloping bed accelerates as the grounding line deepens as much of the antarctic margin has similarly sloped beds the instability is cause for concern however our aim is not to verify this instability but capture coupled evolution in the presence of a retreating and advancing grounding line thus the step change in w while artificial is necessary to cause grounding line advance in contrast to the high rate of retreat in the previous experiments advance occurs more slowly advancing 10 km in 16 years fig 9 a but is sufficient to establish that advance can be represented a full parameter sensitivity test is not carried out but we examine sensitivity to hmwct fig 9 c e as the primary driver of change in vaf is the step change in w the sensitivity of vaf to layer thickness might not be indicative of the robustness of the algorithm melt rate and ice shelf draft however are insensitive to layer thickness just as in the retreat experiments 7 three dimensional coupled experiment a three dimensional coupled experiment is carried out over variable topography the domain is 300 km long by 50 km wide with 1 km horizontal resolution in ice and ocean models and 20 m vertical resolution in the ocean model bathymetry is similar to that described in section 5 it is uniform in the across flow x direction and rises in the y direction with a slope of 0 005 from 2000 m to 900 m over 220 km the location of the ice front it then levels off and beyond this point open ocean is assumed ice enters the domain at the southern boundary at a uniform flux of 2 25 106 m2 yr per unit width the profiles of temperature and salinity to which the ocean is relaxed in the sponge layer are as in fig 3 with the same restoring time constant the ice model has no slip conditions along the x boundaries in the ocean the minimum water column thickness hmwct is 1 0 m the porous flux conductivity κpor is 4 s and the porous flux layer thickness ε por is 0 75 m the experiment is carried out on the f plane with coriolis parameter f set to 10 4 all other ice and ocean parameters are as described previously or in table 1 the results are presented in fig 10 overall evolution is similar to the two dimensional experiment though initially a bulge forms at the base of the ice shelf and propagates to the front fig 10 a having a small but noticeable effect on local melt rates due to its effects on sub ice velocity it is not known whether such features form in real ice shelves as they are transient in our model though similar features were observed in the experiments of jordan et al 2017 despite there being no moving grounding line after 40 years the ice stream is nearly completely afloat melt rate response is similar to the two dimensional runs after an initial 5 year adjustment the bulk melt rate increases fig 10 b which coincides with the onset of grounding line retreat and cavity widening deepening vaf loss rates are considerable 50 km3 a which would translate to 0 14 mm a global sea level rise though this number should not be seen as representative as the ice shelf was initially in equilibrium with no melting at all grounded ice loss rates lessen toward the end of the run but as with previous experiments this is likely due to the grounding line approaching the upstream boundary there is a strong overturning circulation under the ice shelf which strongly alters the stratification fig 10 c and e similarly to the two dimensional experiments though this occurs primarily at the western boundary x 0 due to the effects of rotation the coriolis effect can most easily be seen in under ice flow and melt rate fig 10 d and f most melting takes place at depth where water is warm but as geostrophy prevents the buoyant melt laden water from flowing directly up the sloped ice shelf base it flows to the western edge of the domain where boundary effects break the geostrophic constraints as a result velocities are quite high in this boundary as are melt rates yielding considerably more thinning at the western boundary than elsewhere in the shelf ocean driven melting has a strong effect on ice shelf flow as well as can be seen in fig 11 the initial ice configuration i e in steady state with the absence of melting yields a symmetric velocity which moves fastest at the ice shelf front and has very little flow in the transverse direction after 40 years the flow pattern is strongly asymmetric with speeds increasing toward the western side and flow is significantly deflected in the western direction these features can be largely explained by the melt driven channel along the western boundary which allows greater shear within the ice shelf and also induces a flow pattern which acts against the thickness differential this asymmetry however does not express itself in the flow pattern across the grounding line which explains why the grounding line remains roughly straight throughout the simulation 8 discussion the major output of this study is a coupled ice sheet ocean model that can represent grounding line migration over variable topography for which the ocean component can run continuously without requiring mass salt or heat to be arbitrarily moved to different locations numerical experiments were carried out in which far field forcing was applied to the ocean model inducing retreat of an ice sheet over a bathymetry which deepens inland it is fair to point out that these simulations could have been carried out with an asynchronous model and in fact similar experiments have been carried out yielding similar qualitative behaviour however the locally conservative properties of our scheme additionally mean that our methodology can be implemented in a regional or global ocean model without requiring artificial sources and sinks to preserve conservation which would be required with an asynchronous approach additionally asynchronous approaches still leave open the question as to whether ocean dynamics are affected by the intermittent coupling between ice and ocean in effect our approach reduces the coupling time step to the ocean time step and all approaches with longer coupling time steps are an approximation to this solution moreover in the experiments presented here ocean forcing was persistent but in reality forcing of various time scales does occur from centennial time scales reflecting climate changes boning et al 2008 to monthly or potentially weekly time scales reflecting fast glacial processes and subseasonal ocean time scales smith et al 2017 christianson et al 2016 with an asynchronous model forcing the ocean model on time scales on the order of or shorter than the coupling frequency would be problematic as aspects of the coupled evolution would not be captured our synchronous coupling allows for forcing on daily or even hourly time scales our mode of coupling is not yet complete however marine ice sheet models determine the location of the grounding line and the depth of the ice shelf draft by assuming a static ocean of uniform density the same is done in our ice sheet model which is influenced by the ocean through melting only a future plan for development is to allow the floatation of ice to be determined by the ocean state a further advantage of a synchronously coupled ice ocean model is the prospect of an adjoint coupled model adjoint models allow detailed investigation of sensitivities in a manner that would be intractable through standard parameter variation and enable state estimation and uncertainty quantification adjoints of both ice and ocean components are easily and flexibly generated through algorithmic differentiation heimbach and losch 2012 goldberg and heimbach 2013 synchronous coupling between the two now allows for a coupled adjoint a coupled adjoint would allow detailed sensitivities of the coupled ice ocean system to be investigated and could aid in initialization of the coupled system to observations in our implementation a thin layer of ocean is maintained under grounded ice this is essentially a numerical approximation so that the ocean can advance continuously into previously ice covered ground and as with all approximations the thickness of the layer should not strongly impact the model evolution in our sensitivity study in section 6 we vary the thickness of this layer between 1 and 3 m and see little impact in order to allow movement within the layer in the presence of variable topography we introduce a porous flux parameterisation that is driven by a potential which is related to ocean pressure without this parameterisation the layer would need to be considerably thicker than the values stated above in the presence of steep topography the active ocean layer under grounded ice should not be confused with a true subglacial water layer which is fed by basal melting of the ice sheet still the movement of such water is driven by a balance between friction overburden and potential gradient which is essentially what drives the water in our thin ocean layer as such it may be possible to modify the dynamics of the layer slightly to properly represent a subglacial hydrological regime which continuously transitions to an ocean cavity regime this would require significant further investigation and development effort however 9 conclusions we develop a scheme that allows for synchronous coupling between a marine ice sheet model with a dynamic grounding line and a z coordinate ocean model while vertical coupling the continuous evolution of the ice shelf ocean interface due to melting was developed in a separate study jordan et al 2017 this study focuses on horizontal coupling i e the advance and retreat of the ocean s lateral extent with a flat bathymetry little modification to the ocean model is required beyond limiting ice overburden to allow a thin subglacial water layer in the presence of variable topography a porous flux parameterization is required to allow the ocean to infiltrate new areas where ice has thinned to the point of floatation the porous flux is not based on a physical model rather it exists to counter the nonphysical obstruction of water due to the discretization of topography the porous flux transport is small enough that it has negligible effect on the ocean circulation yet it is large enough that ice dynamics remains the controlling factor of grounding line migration in realistic simulations the modifications made to the code are relatively non invasive the major modification is to the poisson equation solved for the implicit free surface evolution this introduces a few unconstrained parameters but sensitivity of model behaviour to these parameters is shown to be small or negligible experiments carried out in two and three dimensions demonstrate physically reasonable behavior suggesting the coupled model is suitable for scientific experimentation acknowledgments we thank editor william perrie and three anonymous reviews for their helpful comments this work was supported in part by nerc grant ne m003590 1 p heimbach and j m campin are supported in part by nsf oce 1737759 and through the nasa project ecco understanding sea level ice and the earth s climate via a jpl caltech subcontract the code used to generate all results is available freely at mitgcm org appendix a implicit bottom drag an implicit backward in time stepping of vertical viscosity is often used in ocean models to avoid the strict limitation on the time step that an explicit forward in time stepping would impose either when vertical viscosity is large e g in mixed layer or with high vertical resolution currently however ocean basal drag is imposed explicitly in mitgcm with dynamical ice shelf coupling grid cells at u and v points on the c grid can go to zero thickness and an unconditionally stable scheme for basal drag with respect to vertical resolution is also required here we describe a new implementation of implicit bottom drag used in this study a 1 without implicit surface or bottom drag we first review the time stepping procedure for implicit vertical viscosity within the hydrostatic z coordinate mitgcm implementation using implicit free surface note what follows immediately describes the scheme for vertical viscosity in mitgcm previous to this study the discretized form of the zonal momentum equations in 2 d plane x z δx δz can be written 23 u n 1 u n δ t g u n 1 2 c u n δ z u n g δ t x η n 1 δ t z ν z u n 1 u g δ t x η n 1 δ t z ν z u n 1 with boundary conditions 24 u n 1 z 0 at the bottom and the surface of the column compare 23 with 13 the two are equivalent but different symbols have been used as shown below u from 13 is the result of inverting the vertical viscosity operator hence the use of a distinct symbol u here and g u n 1 2 represents the processes applied to the previous velocity coriolis advection wind forcing prior to this inversion the function c is written generally and can represent either linear drag quadratic drag or a no slip condition the derivations below do not depend on the specific form 23 can be written as 25 l u n 1 u n 1 δ t z ν z u n 1 u g δ t x η n 1 in the ocean model l is discretized using a finite volume approach yielding a tridiagonal matrix for each column that can be easily inverted independently e g using l u decomposition 26 u n 1 l 1 u g δ l 1 x η n 1 l 1 u g δ t x η n 1 u g δ t x η n 1 where the second equality is due to the particular form of l which only acts on vertical shear without changing the depth integrated transport a 2 with implicit surface or bottom drag here we describe our modification to the above scheme to allow for implicit bottom drag 23 is rewritten as 27 u n 1 u n δ t g u n 1 2 c u n δ z u n 1 g δ t x η n 1 δ t z ν z u n 1 u g δ t x η n 1 c u n δ z u n 1 δ t z ν z u n 1 where u n 1 now appears in the drag term and a new intermediary u u n δ t g u n 1 2 has been defined the equivalent of 26 is 28 u n 1 l d 1 u l d 1 g δ t x η n 1 where the new operator l d is given by 29 l d u n 1 u n 1 c u n δ z u n 1 δ t z ν z u n 1 l d can be discretized similarly to l the one difference being the addition of the surface and or bottom drag terms to the diagonal matrix coefficient in the relevant rows the inversion of l d in the second term on the right hand side of 28 no longer reduces to the identity but instead 28 can be written as 30 u n 1 l d 1 u g δ t x η n 1 l d 1 i where i is a function equal to unity in the vertical note l d 1 i is a function of depth which we will refer to as j if we now redefine u as l d 1 u then 14 the elliptic equation to be solved for η n 1 now becomes 31 x g h n j n x η n 1 1 δ t 2 η n 1 f w ρ r e f δ t 1 δ t 2 η n 1 δ t x h n u where j n is the vertical average of j at time n which becomes a weighting factor in the elliptic operator that is solved for the free surface update 
