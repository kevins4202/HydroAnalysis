index,text
730,the probabilistic collocation method pcm has drawn wide attention in uncertainty quantification nevertheless pcm may become prohibitively expensive for high dimensional nonlinear problems to alleviate the computational burden we develop an anova analysis of variance based multi fidelity probabilistic collocation method amf pcm in this study instead of directly approximating the computationally expensive system model i e high fidelity hf model as in the traditional pcm a computationally cheap while less accurate numerical model i e low fidelity lf model is used in amf pcm the central idea of amf pcm is to take advantage of both the accuracy of the hf model and the computational efficiency of the lf model to address the high dimensionality issue we propose to respectively decompose the lf model and the discrepancy between the hf and lf models with functional anova by approximating them with the summation of low order anova components using pcm then the final model approximation can be easily obtained from the combined results the efficiency and accuracy of amf pcm are demonstrated by several numerical cases of coupled unsaturated flow and heat transport where two ways of building a computationally cheap lf model i e by simplifying the physics or using a coarser discretization are employed compared to the traditional pcm that is solely based on the hf model amf pcm achieves a better accuracy with a significantly lower computational cost 1 introduction it is widely recognized that subsurface media is inherently heterogeneous jiang et al 2010 zhang 2002 due to the relatively high cost the measurements of medium properties related to flow and transport are usually available at only a few locations the combination of spatial heterogeneity and a relatively small number of measurements lead to uncertainty in predicting flow and transport in such media in the past decade the probabilistic collocation method pcm also referred to as the stochastic collocation method scm has been widely used in evaluating uncertainties in subsurface flow and transport chang et al 2015 ganis et al 2008 li and zhang 2009 li et al 2009 liao et al 2017 lin and tartakovsky 2009 shi et al 2009 2010 2014 sun et al 2013 zeng et al 2016 zhang et al 2013 in pcm the system responses e g pressure head and moisture content are approximated by the polynomial chaos expansion pce of random parameters where the unknown pce coefficients are solved by either pseudospectral projection le maı tre et al 2002 xiu 2010 or least square regression isukapalli et al 1998 li and zhang 2007 however pcm suffers from the so called curse of dimensionality i e the number of requisite model simulations for solving the pce coefficients grows rapidly as the number of input parameters i e the random dimensionality increases thus the computational cost of pcm in high dimensional problems may be unaffordable in this study we consider the coupled water flow and heat transport in the vadose zone which connects the hydrology process above the soil surface and the saturated aquifer in the subsurface it is known that the water flow and heat transport in the vadose zone are closely coupled and affect each other gao and shao 2015 moradi et al 2016 sakai et al 2009 uncertainty quantification for such a system may become intractable as a single simulation of fine mesh high fidelity hf model is time demanding and pcm may require a large number of model simulations although many efforts have been made to reduce the computational burden of pcm typically through sparse grids ganapathysubramanian and zabaras 2007 nobile et al 2008 transformation liao and zhang 2013 2014 2016 and adaptive approaches agarwal and aluru 2009 eldred 2009 the bare minimum number of requisite hf model simulations may still be beyond practical feasibility in many situations some low fidelity lf models for approximating the underlying system e g based on simplified physics much coarser discretization etc are often available compared to hf models lf models are usually computationally cheap to simulate but with the lower accuracy there is a recent surge of interest in multi fidelity methods which leverage both the accuracy of hf model and the computational efficiency of lf model pioneered by ng and eldred 2012 a multi fidelity uncertainty quantification framework using scm was proposed specifically pce expansion was implemented for both the lf model and the discrepancy between the hf and lf models then the unknown pce coefficients were solved by scm with different levels of sparse grids i e a finely resolved grid for the lf model in combination with a more coarsely resolved grid for the discrepancy the quantities of interest were then approximated using the combined results compared to the traditional solution directly from a large number of expensive hf model simulations greater computational efficiency can be obtained by fusing the information from a less expensive lf model in another work narayan et al 2014 proposed an scm algorithm with multi fidelity models in which the lf model information was used to inform the approximation space for the hf model and compute a hf model reconstruction this method can better utilize the lf model information for global searches over parameter space along this line zhu et al 2014 2017 further extended the multi fidelity method for computing the statistical moments of stochastic problems the efficiency was demonstrated by some low dimensional numerical examples with known analytical forms however the multi fidelity scm may not be suitable for handling the high dimensional problems functional anova analysis of variance decomposition also known as high dimensional model representation can effectively alleviate the curse of dimensionality in certain approximation li et al 2001 rabitz and aliş 1999 this approach involves splitting a high dimensional function into a set of low dimensional functions known as anova components once the decomposition is done the retained anova components can be expanded with pce which is much less costly than the direct expansion of the model response with pce foo and karniadakis 2010 combined the functional anova decomposition with pcm for solving stochastic problems with high dimensionality an adaptive version of anova was developed to automatically identify the important anova components for approximating the model response ma and zabaras 2010 yang et al 2012 recently man et al 2017 developed an anova based transformed pcm for bayesian data worth analysis in contrast with the previous work of pcm and its variants solely based on the expensive hf model foo and karniadakis 2010 man et al 2017 we develop an efficient approach by integrating pcm into a multi fidelity framework in this study the new method takes advantage of both the accuracy of hf model and the computational efficiency of lf model furthermore to address the high dimensionality issue we propose to respectively decompose the lf model and the discrepancy between the hf and lf models with functional anova by approximating them with the summation of low order anova components using pcm this leads to an anova based multi fidelity probabilistic collocation method amf pcm the contribution of this work is to extend the applicability of the multi fidelity framework proposed by ng and eldred 2012 making it suitable for handling higher dimensional problems the remainder of this paper is organized as follows section 2 presents the mathematical model of coupled water flow and heat transport in the vadose zone section 3 formulates the theoretical underpinning of amf pcm section 4 illustrates the results and discussion from numerical case studies and finally we draw some conclusions from our study in section 5 2 system model in this study the two dimensional coupled water flow and heat transport in the vadose zone are considered the unsaturated flow is governed by the richards equation 1 θ t x k h h x z k h h z k h where θ is the soil water content l3l 3 at time t t h is the corresponding soil water pressure head l x and z are the horizontal and vertical spatial coordinates l respectively k h is the hydraulic conductivity function that varies with h which can be characterized by the van genuchten mualem vgm model mualem 1976 van genuchten 1980 2 k h k s s e 0 5 1 1 s e 1 m m 2 m 1 1 n 3 s e θ θ r θ s θ r 1 1 α h n 1 1 n h 0 1 h 0 where ks is the saturated hydraulic conductivity lt 1 se is the effective saturation θs and θr are the saturated and residual water content l3l 3 respectively α l 1 and n are the shape parameters reflecting the soil pore size distribution the governing equation for two dimensional heat transport can be expressed as sophocleous 1979 4 c θ t t z λ x z θ t x c w q z t z where t is the soil temperature k c θ and cw are the volumetric heat capacity of soil and water ml 1t 2k 1 λxz θ is the apparent thermal conductivity mlt 3k 1 given by simunek and suarez 1993 5 λ x z θ λ x c w q δ x z λ z λ x c w q x q z q λ 0 θ δ x z where q is the absolute value of flux density lt 1 δxz is the kronecker delta function λx and λz are the transverse and longitudinal thermal dispersivities l respectively λ 0 is the thermal conductivity of soil in the absence of flow which can be evaluated by the following formulation chung and horton 1987 6 λ 0 θ b 1 b 2 θ b 3 θ 0 5 where b 1 b 2 and b 3 are the empirical parameters mlt 3k 1 the coupling between water flow and heat transport is reflected in the influence of temperature on the soil hydraulic functions according to the capillary theory the temperature dependence of the soil water pressure head can be expressed as philip and de vries 1957 7 h t σ t σ t 0 h t 0 β h h t 0 where ht and h t 0 σ t and σ t 0 are the pressure heads surface tensions at the air water interface mt 2 at temperature t and reference temperature t 0 respectively βh is the temperature scaling factor for the pressure head the temperature dependence of the hydraulic conductivity can be expressed as constantz 1982 8 k t θ μ t 0 μ t ρ t ρ t 0 k t 0 θ β k k t 0 θ where kt and k t 0 are the hydraulic conductivities at temperature t and reference temperature t 0 respectively μ t and μ t 0 ρ t and ρ t 0 are the dynamic viscosity ml 1t 1 density of soil water ml 3 at temperature t and reference temperature t 0 respectively βk is the temperature scaling factor for the hydraulic conductivity 3 methodology in this study we treat ks α and n as random parameters or functions then eqs 1 8 become stochastic differential equations suppose the stochastic partial differential equation is expressed as 9 l s x t ξ g x t ξ 0 where l is the differential operator s x t ξ is the model response such as pressure head water content etc g x t ξ is a given function representing the coupled unsaturated flow and heat transport model x is the physical location and ξ ξ 1 ξ 2 ξ m is the distributed parameter vector with m components e g the unsaturated soil hydraulic parameters 3 1 probabilistic collocation method pcm employs the pce to approximate the stochastic model response s x t ξ ghanem and spanos 2003 for the sake of simplicity the time and location indices are omitted in the following formulations the pce form of s ξ is expressed as 10 s ξ j 0 q 1 c j ψ j ξ q d m d m where ψ j ξ are the orthogonal pce basis functions with maximum polynomial degree of d which satisfy 11 ψ j ξ ψ k ξ ψ j ξ ψ k ξ ρ ξ d ξ δ jk where denotes the expectation ρ ξ is the corresponding probability density function δjk is the kronecker delta function δjk 1 if j k and 0 if j k cj are the pce coefficients that can be determined by performing spectral projection le maître and knio 2010 xiu 2010 i e 12 c j s ξ ψ j ξ ρ ξ d ξ ψ j ξ ψ j ξ ρ ξ d ξ i 1 p s ξ i ψ j ξ i w i ψ j 2 ξ where ξ i w i i 1 p are a set of collocation points and associated weights such that the summation approximates the integral finally we can calculate the statistical moments e g mean and variance and probability density function of the model response using eq 10 due to the orthogonal property of the pce basis functions the mean and variance of the model response can be directly calculated from the pce coefficients 13 μ s s ξ ρ ξ d ξ c 0 14 σ s 2 s ξ μ s 2 ρ ξ d ξ j 1 q 1 c j 2 ψ j 2 ξ 3 2 anova based multi fidelity pcm to improve the computational efficiency of pcm we develop an amf pcm by integrating pcm into a multi fidelity framework in this study instead of directly expanding the hf model with pce we firstly apply the functional anova decomposition to the lf model and its discrepancy to the hf model respectively and approximate them with the summation of low order anova components then we implement the pce expansion on these low order anova components and formulate the pce representation of the hf model as a combined expansion of the lf model and the discrepancy 3 2 1 multi fidelity framework let s high ξ and s low ξ be the responses respectively obtained from the hf model and the lf model in the multi fidelity framework we assume that the lf model response can be corrected to match the hf model response by adding a correction term s err ξ ng and eldred 2012 i e 15 s high ξ s low ξ s err ξ 3 2 2 pce approximation based on the functional anova decomposition in this subsection we apply the functional anova decomposition to the lf model and the correction function respectively and then construct the pce approximations given their anova components in terms of the theoretical part the sparsity of effects principle montgomery 2017 states that a system is usually dominated by the main effects and low order interactions thus it is most likely that the main single factor effects and two factor interactions are the most significant responses in other words higher order interactions such as three factor interactions are very rare in this study we use the 0th 1st and 2nd order anova components to approximate the lf model i e 16 s low ξ f low ξ f 0 low j 1 m f j low ξ j 1 j k m m f j k low ξ j ξ k where the function f 1 2 w with w random variables ξ 1 ξ 2 ξ w is entitled the w th order anova component in amf pcm the lf model should catch the right trend of the input output relationship of the hf model then the anova components up to the first order are usually sufficient to approximate the correction function i e 17 s err ξ f err ξ f 0 err j 1 m f j err ξ j suppose the random variables ξ are gaussian distributed the hermite polynomials xiu 2010 are then used to expand each anova component into pce for parametric distributions other than gaussian distribution the generalized polynomial chaos gpc developed by xiu 2010 can be used for the gaussian distribution the first three one dimensional pce basis functions are ψ 0 ξ 1 ψ 1 ξ ξ and ψ 2 ξ ξ 2 1 2 on this basis the 1st order anova component can be expressed as 18 f 1 ξ 1 j 0 2 c j ψ j ξ 1 c 0 c 1 ξ 1 c 2 ξ 1 2 1 2 for the component function f 1 2 ξ 1 ξ 2 its pce basis functions are formulated from the tensor product of the corresponding one dimensional basis i e 19 f 1 2 ξ 1 ξ 2 j 0 2 k 0 2 c j k ψ j ξ 1 ψ k ξ 2 c 00 c 01 ξ 2 c 02 ξ 2 2 1 2 c 10 ξ 1 c 11 ξ 1 ξ 2 c 12 ξ 1 ξ 2 2 1 2 c 20 ξ 1 2 1 2 c 21 ξ 2 ξ 1 2 1 2 c 22 ξ 1 2 1 ξ 2 2 1 2 3 2 3 solving the pce coefficients after expanding the lf model and correction function with anova based pce pcm is employed to solve the lf pce and correction pce coefficients according to li et al 2001 2002 the 0th 1st and 2nd order anova components can be calculated as follows 20 f 0 f 0 21 f 1 ξ 1 f ξ 1 0 0 f 0 22 f 2 ξ 2 f 0 ξ 2 0 f 0 23 f 1 2 ξ 1 ξ 2 f ξ 1 ξ 2 0 0 f 1 ξ 1 f 2 ξ 2 f 0 in pcm with different sets of collocation points we evaluate the component f 1 2 w ξ 1 ξ 2 ξ w and make it equal to the corresponding polynomials for a one dimensional pce with the highest polynomial degree of d the collocation points are positioned at the roots of the d 1 th polynomial specifically for the one dimensional second order hermite pce the collocation points are the roots of the third order hermite polynomial ξ 3 3 ξ 6 i e 3 0 and 3 while for a multidimensional pce the collocation points are formulated from the tensor product of the one dimensional collocation points note that the correction pce which serves as a corrector for lf pce is constructed based on the discrepancy between the hf and lf model responses at selected collocation points in this situation several hf model simulations are required to allow some of the lf model responses to be corrected by the hf model responses thus the hf model simulations are required to expand the correction function into pce the computational cost of amf pcm is spent on solving the lf pce and correction pce coefficients overall it requires 1 2 m times of hf model evaluations and 1 2m 2 times of lf model evaluations 3 2 4 post processing after determining the pce coefficients we sum up all the pce basis functions to formulate the pce approximations for the lf model and correction function then the pce representation of the hf model response can be expressed as a combination of the lf pce and correction pce 24 s high ξ j γ r c j low c j err ψ j ξ j γ q γ r c j low ψ j ξ where г q are the indices for the pce basis functions of the multi fidelity mf expansion γ r γ q are the indices for the common pce basis functions of the lf and correction expansions using the above expansions the mean and variance of the hf model response can then be calculated as 25 μ s c 0 low c 0 err 26 σ s 2 j γ r 0 c j low c j err 2 ψ j 2 ξ j γ q γ r c j low 2 ψ j 2 ξ 3 2 5 algorithm summary the computational procedure of amf pcm is summarized as follows 1 lf model approximation 1 truncate the 0th 1st and 2nd order anova components to approximate the lf model i e eq 16 2 calculate the 0th order anova component by evaluating the lf model at the collocation points ξ 0 and expand the 1st and 2nd order anova components into pce respectively using eqs 18 and 19 3 solve the lf pce coefficients c low by pcm 2 correction function approximation 1 truncate the 0th and 1st order anova components to approximate the correction function i e eq 17 2 calculate the discrepancy between the hf and lf model responses at the collocation point ξ 0 and regard it as the 0th order anova component then expand the 1st order anova components into pce using eq 18 3 solve the correction pce coefficients c err by pcm 3 post processing 1 construct the pce representation of the hf model response as a combination of the lf pce and correction pce 2 use the combined expansion to calculate the statistical moments i e eqs 25 and 26 4 case studies in this section several numerical case studies are used to demonstrate the efficiency of the proposed method as shown in fig 1 the study domain is 1 m 2 m discretized into 21 41 rectangular elements the orange dots along the central vertical line x 0 5 m represent the validation locations for pressure head initially the pressure head is 2 m at the top and linearly changed to 0 m at the bottom this initial condition represents a real world scenario of when the groundwater table is 2 m below the surface and the matric potential head is at equilibrium with the gravitational head thus the total potential head is 0 and no water movement we specify a constant flux rate q 0 005 m d 1 at the upper boundary to simulate the infiltration a constant pressure head h 0 m water table at the bottom and no flow conditions at the left and right boundaries the temperature at the upper boundary varies sinusoidally to simulate the diurnal temperature variations of soil surface 27 t t a t a cos 2 π t 13 p where ta 30 c is the average temperature ta 5 c is the temperature amplitude p 24 h the simulated infiltration period is 10 days the pressure heads at the validation locations are analyzed at time t 10 days for each simulation the hydrus 2d simunek et al 2008 is used to solve the coupled unsaturated flow and heat transport model all the computations are implemented on a pc running windows 10 pro 64 bit with a 2 10 ghz cpu and 64 gb ram we design a series of numerical cases with increasing complexities to test the performance of amf pcm for uncertainty quantification of coupled unsaturated flow and heat transport problems two ways of building a computationally cheap lf model are presented in our case studies one is to simplify the physics i e without considering the coupling between the unsaturated flow and heat transport the other one is to adopt a coarser discretization the results provided by the traditional 2nd order pcm abbreviated as pcm in the following discussion are taken for comparisons in order to quantify the accuracy of the pce approximation the root mean square error rmse and coefficient of determination r2 between the pce representations and the hf model responses are used 28 rmse 1 n v i 1 n v s i s i high 2 29 r 2 i 1 n v s i s s i high s high i 1 n v s i s 2 i 1 n v s i high s high 2 2 where s i high are the pressure heads computed from nv times of monte carlo mc simulations of hf model si are a set of nv outputs of the pce representations using eq 24 here nv 5000 the quantities with the bar s s high denote the mean parts 4 1 homogeneous random hydraulic parameters in this section we assume all the parameters are homogeneous and the uncertainty stems from three unknown hydraulic parameters i e ks α n note that both ks and α are positive quantities and n must be larger than one here we assume that the log saturated hydraulic conductivity y ln ks the log pore size distribution parameter x ln α and the fitting parameter z ln n 1 are gaussian distributed li et al 2009 the mean values of the three parameters are set to be μ k s 1 m d 1 μ α 2 m 1 and μ n 1 0 4 the variability is given in terms of the coefficient of variation as follows c v k s 1 cv α 0 2 and cv n 1 0 2 with the mean and coefficient of variation of the lognormal random variable v the statistical moments of the corresponding transformed variable u ln v where u y x z can be easily calculated through the following formulations zhang 2002 30 μ u 2 ln μ v 0 5 ln μ v 2 1 c v v 2 31 σ u 2 ln 1 c v v 2 the correlation coefficients between the three random parameters are set as γ yx 0 8 γ yz 0 3 γ xz 0 6 li et al 2009 then the hydraulic parameter realizations can be generated by sampling from these prior statistics the other parameters related to the coupled unsaturated flow and heat transport model are assumed known and listed in table 1 for a single hf model simulation the cpu time is about 2 s in this case we choose to build an lf model without considering the coupling of water flow and heat transport which takes about 1 s for a single model simulation the r2 values between the hf and lf pressure heads at the validation locations are plotted in fig 2 a overall the lf pressure heads exhibit a relatively high correlation with the hf pressure heads despite this it does not mean that one can simply replace the hf model with the lf model here we use the results from validation location z 0 2 m to illustrate this point the scatter plot between the hf and lf pressure heads from the top validation location z 0 2 m is shown in fig 2b it can be seen that systematical deviations always exist between the hf and lf models this is caused by neglecting temperature dependence of the soil water pressure head and the hydraulic conductivity as shown in eqs 7 and 8 in the lf model theoretically speaking amf pcm works only if the discrepancy between the hf and lf models is less complex than the lf model it is because that the central idea of amf pcm is to correct the lower order terms of the lf pce by the correction pce and then predict the higher order behavior of the hf model response that is not captured by the correction pce to illustrate this point we analyze the decay of pce coefficients solved by amf pcm fig 3 plots the lf correction and mf pce coefficients of pressure head from validation location z 0 2 m it is clearly shown that the spectrum of correction pce coefficients has lower magnitude and faster decay than those of lf pce coefficients this indicates that it is easier to approximate the correction function compared to the lf model which guarantees the feasibility of the mf pce simulation to illustrate the superiority of amf pcm we also solve the stochastic problem using the traditional pcm respectively based on the hf model and the lf model the rmse and r2 values of pressure head at the validation locations calculated by pcm and amf pcm are plotted in fig 4 it is obvious that the lf based pcm gives significantly biased results at some validation locations as indicated by the largest rmse and smallest r2 values it is also noted that compared with the hf based pcm amf pcm provide the smaller rmse and larger r2 values this indicates that a better accuracy is achieved by amf pcm it is because that functional anova decomposition is employed in amf pcm and the maximum polynomial degree of amf pcm can reach as high as four as shown in eq 19 while the full pce is used in pcm and the maximum polynomial degree of the pcm is only two in other words it is wise to neglect the high order anova components rather than using the full pce in terms of the computational cost 31 times of hf model evaluations are required for the hf based pcm while for amf pcm it requires 7 1 2 3 times of hf model evaluations and 19 1 2 32 times of lf model evaluations it should be noted that amf pcm is easy to parallelize without loss of generality we compare the cpu time for a single core serial calculation it is easily known that the cpu time of the hf based pcm and amf pcm is 62 2 31 s and 33 2 7 1 19 s respectively compared with the traditional pcm that is solely based on the hf model the amf pcm achieves a better accuracy with nearly half the cost 4 2 heterogeneous parameter field in this section we treat α and n to be deterministic but the log saturated hydraulic conductivity y ln ks as the only input random field with different levels of variability and correlation lengths as shown in table 2 the random field is assumed gaussian distributed with the mean μ y 0 3 and the following separable exponential covariance function 32 c y y x 1 z 1 y x 2 z 2 σ y 2 exp x 1 x 2 λ x z 1 z 2 λ z where σ y 2 is the variance of the random field λx and λz are the correlation lengths in the horizontal and vertical directions respectively both pcm and amf pcm suffer from the curse of dimensionality when dealing with the spatially varying parameter field in this study we decompose y ln ks with the karhunen loève expansion kle zhang and lu 2004 and retain the first m random terms to parameterize the log saturated hydraulic conductivity field then the random field can be expressed as 33 y x z μ y j 1 m η j f j x z ξ j where η j and fj x z are the eigenvalues and eigenfunctions of the covariance function respectively which can be solved from the fredholm equation of the second kind note that the sum of all eigenvalues is related to the total variance of the random field keeping more kle terms helps to characterize the random field more accurately the cpu time for each hf model with 861 21 41 rectangular elements simulation is about 32 s 4 2 1 lf model with simplified physics for the first four cases shown in table 2 the lf model is built by simplifying the physics i e without considering the coupling between water flow and heat transport the cpu time of evaluating such an lf model is about 2 s in amf pcm a high correlation between the hf and lf models is essential for successful mf simulations here we take case 1 as an example to illustrate in case 1 we keep 20 kle terms and calculate the r2 values between the hf and lf pressure heads at the validation locations as shown in fig 5 a a good correlation is observed between the pressure heads obtained from the hf and lf models fig 5b shows a scatter plot between the hf and lf pressure heads from the top validation location z 0 2 m it can be seen that although the main trend of the hf model can be captured by the lf model systematical deviations always exist this provides the necessity to perform the mf pce simulation note that the lf model can assist mf pce simulation only if the decay of the correction pce coefficients is faster than that of the lf pce coefficients the lf correction and mf pce coefficients of pressure head from the top validation location z 0 2 m are calculated and plotted in fig 6 it is clearly shown that the spectrum of correction pce coefficients has lower magnitude and faster decay than those of lf pce coefficients this verifies the feasibility of the mf pce simulation fig 7 compares the rmse and r2 values of pressure head at the validation locations calculated by pcm and amf pcm for different levels of variability and correlation lengths it can be seen that amf pcm achieves a better accuracy as indicated by the smaller rmse and larger r2 values in terms of the computational cost 881 times of hf lf model evaluations are required for the pcm while for amf pcm it requires 41 1 2 20 times of hf model evaluations and 801 1 2 202 times of lf model evaluations furthermore we also compare the total cpu time of the hf based pcm and amf pcm the cpu time of the hf based pcm and amf pcm are 28 192 32 881 s and 2914 32 41 2 801 s respectively compared with the traditional hf based pcm amf pcm achieves a better accuracy with nearly an order of magnitude of speed up thus simplification of the physics and the anova technique significantly reduce the computational effort while the mf framework guarantees the accuracy in case 2 all model settings are the same as case 1 except that the horizontal correlation length of ln ks field is smaller the superiority of amf pcm over pcm is demonstrated in this smaller scale problem in case 3 all input parameters are the same as those in case 2 except that the variance of ln ks field is increased to 2 it is seen from fig 7 that the accuracy of amf pcm deteriorates with the increasing variance the summation of eigenvalues with different correlation lengths are shown in fig 8 it can be seen that for a smaller correlation length more kle terms are needed to retain the same accuracy in case 4 we retain more i e m 50 kle terms to parameterize the parameter field fig 9 plots the mean and variance of pressure head at the validation locations calculated by amf pcm and mc method with 8000 realizations using the hf model it can be seen that the solutions from amf pcm are in good agreements with those from mc simulations it should be noted that the number of hf model evaluations in amf pcm is only 101 furthermore in fig 10 we compare the rmse and r2 values of pressure head at the validation locations calculated by pcm and amf pcm compared with pcm amf pcm is more computationally efficient for solving such a high dimensional stochastic problem 4 2 2 lf model with a coarser discretization in case 5 we build an lf model using a much coarser discretization i e 7 21 rectangular elements the cpu time of evaluating such an lf model is about 3 s to test the correlation between the hf and lf models we calculate the r2 values between the hf and lf pressure heads at the validation locations fig 11 it can be seen that all the r2 values can reach 0 99 or more which means a good correlation between the hf and lf pressure heads the rmse and r2 values of pressure head at the validation locations calculated by pcm and amf pcm are plotted in fig 12 the superiority of amf pcm over pcm is demonstrated again 5 conclusions in this study we develop an anova based multi fidelity probabilistic collocation method amf pcm for uncertainty quantification of coupled water flow and heat transport in the vadose zone this method can take advantage of both the accuracy of the high fidelity hf model and the computational efficiency of the low fidelity lf model to implement amf pcm two typical ways of building a computationally cheap lf model i e by simplifying the physics or using a coarser discretization are presented in amf pcm we apply the functional anova decomposition to the lf model and its discrepancy to the hf model respectively and approximate them with the summation of low order anova components then we implement the pce expansion on these low order anova components and formulate the pce representation of the hf model as the combined expansion of the lf model and the discrepancy which is much less costly than the direct expansion of the hf model with pce the efficiency and accuracy of amf pcm are systematically investigated by several numerical examples of uncertainty quantification in coupled unsaturated flow and heat transport model compared to the traditional pcm that is solely based on the hf model amf pcm achieves a better accuracy with a significantly lower computational cost in amf pcm the lf model should catch the right trend of the input output relationship of the hf model in other words the lf model should be carefully checked if the correlation between the hf and lf models is weak the performance of amf pcm will compromise to further improve the efficiency of amf pcm the adaptive anova decomposition can be explored in the future study it is a promising way of adaptively selecting active anova components which leads to an adaptive approach to construct a pce approximation for the lf model especially when the computational cost of the lf model simulation cannot be negligible acknowledgements this work is supported by the national natural science foundation of china grants 41571215 and 41771254 and china postdoctoral science foundation grant no 2018m630680 data and computer codes used are available upon request to the corresponding author 
730,the probabilistic collocation method pcm has drawn wide attention in uncertainty quantification nevertheless pcm may become prohibitively expensive for high dimensional nonlinear problems to alleviate the computational burden we develop an anova analysis of variance based multi fidelity probabilistic collocation method amf pcm in this study instead of directly approximating the computationally expensive system model i e high fidelity hf model as in the traditional pcm a computationally cheap while less accurate numerical model i e low fidelity lf model is used in amf pcm the central idea of amf pcm is to take advantage of both the accuracy of the hf model and the computational efficiency of the lf model to address the high dimensionality issue we propose to respectively decompose the lf model and the discrepancy between the hf and lf models with functional anova by approximating them with the summation of low order anova components using pcm then the final model approximation can be easily obtained from the combined results the efficiency and accuracy of amf pcm are demonstrated by several numerical cases of coupled unsaturated flow and heat transport where two ways of building a computationally cheap lf model i e by simplifying the physics or using a coarser discretization are employed compared to the traditional pcm that is solely based on the hf model amf pcm achieves a better accuracy with a significantly lower computational cost 1 introduction it is widely recognized that subsurface media is inherently heterogeneous jiang et al 2010 zhang 2002 due to the relatively high cost the measurements of medium properties related to flow and transport are usually available at only a few locations the combination of spatial heterogeneity and a relatively small number of measurements lead to uncertainty in predicting flow and transport in such media in the past decade the probabilistic collocation method pcm also referred to as the stochastic collocation method scm has been widely used in evaluating uncertainties in subsurface flow and transport chang et al 2015 ganis et al 2008 li and zhang 2009 li et al 2009 liao et al 2017 lin and tartakovsky 2009 shi et al 2009 2010 2014 sun et al 2013 zeng et al 2016 zhang et al 2013 in pcm the system responses e g pressure head and moisture content are approximated by the polynomial chaos expansion pce of random parameters where the unknown pce coefficients are solved by either pseudospectral projection le maı tre et al 2002 xiu 2010 or least square regression isukapalli et al 1998 li and zhang 2007 however pcm suffers from the so called curse of dimensionality i e the number of requisite model simulations for solving the pce coefficients grows rapidly as the number of input parameters i e the random dimensionality increases thus the computational cost of pcm in high dimensional problems may be unaffordable in this study we consider the coupled water flow and heat transport in the vadose zone which connects the hydrology process above the soil surface and the saturated aquifer in the subsurface it is known that the water flow and heat transport in the vadose zone are closely coupled and affect each other gao and shao 2015 moradi et al 2016 sakai et al 2009 uncertainty quantification for such a system may become intractable as a single simulation of fine mesh high fidelity hf model is time demanding and pcm may require a large number of model simulations although many efforts have been made to reduce the computational burden of pcm typically through sparse grids ganapathysubramanian and zabaras 2007 nobile et al 2008 transformation liao and zhang 2013 2014 2016 and adaptive approaches agarwal and aluru 2009 eldred 2009 the bare minimum number of requisite hf model simulations may still be beyond practical feasibility in many situations some low fidelity lf models for approximating the underlying system e g based on simplified physics much coarser discretization etc are often available compared to hf models lf models are usually computationally cheap to simulate but with the lower accuracy there is a recent surge of interest in multi fidelity methods which leverage both the accuracy of hf model and the computational efficiency of lf model pioneered by ng and eldred 2012 a multi fidelity uncertainty quantification framework using scm was proposed specifically pce expansion was implemented for both the lf model and the discrepancy between the hf and lf models then the unknown pce coefficients were solved by scm with different levels of sparse grids i e a finely resolved grid for the lf model in combination with a more coarsely resolved grid for the discrepancy the quantities of interest were then approximated using the combined results compared to the traditional solution directly from a large number of expensive hf model simulations greater computational efficiency can be obtained by fusing the information from a less expensive lf model in another work narayan et al 2014 proposed an scm algorithm with multi fidelity models in which the lf model information was used to inform the approximation space for the hf model and compute a hf model reconstruction this method can better utilize the lf model information for global searches over parameter space along this line zhu et al 2014 2017 further extended the multi fidelity method for computing the statistical moments of stochastic problems the efficiency was demonstrated by some low dimensional numerical examples with known analytical forms however the multi fidelity scm may not be suitable for handling the high dimensional problems functional anova analysis of variance decomposition also known as high dimensional model representation can effectively alleviate the curse of dimensionality in certain approximation li et al 2001 rabitz and aliş 1999 this approach involves splitting a high dimensional function into a set of low dimensional functions known as anova components once the decomposition is done the retained anova components can be expanded with pce which is much less costly than the direct expansion of the model response with pce foo and karniadakis 2010 combined the functional anova decomposition with pcm for solving stochastic problems with high dimensionality an adaptive version of anova was developed to automatically identify the important anova components for approximating the model response ma and zabaras 2010 yang et al 2012 recently man et al 2017 developed an anova based transformed pcm for bayesian data worth analysis in contrast with the previous work of pcm and its variants solely based on the expensive hf model foo and karniadakis 2010 man et al 2017 we develop an efficient approach by integrating pcm into a multi fidelity framework in this study the new method takes advantage of both the accuracy of hf model and the computational efficiency of lf model furthermore to address the high dimensionality issue we propose to respectively decompose the lf model and the discrepancy between the hf and lf models with functional anova by approximating them with the summation of low order anova components using pcm this leads to an anova based multi fidelity probabilistic collocation method amf pcm the contribution of this work is to extend the applicability of the multi fidelity framework proposed by ng and eldred 2012 making it suitable for handling higher dimensional problems the remainder of this paper is organized as follows section 2 presents the mathematical model of coupled water flow and heat transport in the vadose zone section 3 formulates the theoretical underpinning of amf pcm section 4 illustrates the results and discussion from numerical case studies and finally we draw some conclusions from our study in section 5 2 system model in this study the two dimensional coupled water flow and heat transport in the vadose zone are considered the unsaturated flow is governed by the richards equation 1 θ t x k h h x z k h h z k h where θ is the soil water content l3l 3 at time t t h is the corresponding soil water pressure head l x and z are the horizontal and vertical spatial coordinates l respectively k h is the hydraulic conductivity function that varies with h which can be characterized by the van genuchten mualem vgm model mualem 1976 van genuchten 1980 2 k h k s s e 0 5 1 1 s e 1 m m 2 m 1 1 n 3 s e θ θ r θ s θ r 1 1 α h n 1 1 n h 0 1 h 0 where ks is the saturated hydraulic conductivity lt 1 se is the effective saturation θs and θr are the saturated and residual water content l3l 3 respectively α l 1 and n are the shape parameters reflecting the soil pore size distribution the governing equation for two dimensional heat transport can be expressed as sophocleous 1979 4 c θ t t z λ x z θ t x c w q z t z where t is the soil temperature k c θ and cw are the volumetric heat capacity of soil and water ml 1t 2k 1 λxz θ is the apparent thermal conductivity mlt 3k 1 given by simunek and suarez 1993 5 λ x z θ λ x c w q δ x z λ z λ x c w q x q z q λ 0 θ δ x z where q is the absolute value of flux density lt 1 δxz is the kronecker delta function λx and λz are the transverse and longitudinal thermal dispersivities l respectively λ 0 is the thermal conductivity of soil in the absence of flow which can be evaluated by the following formulation chung and horton 1987 6 λ 0 θ b 1 b 2 θ b 3 θ 0 5 where b 1 b 2 and b 3 are the empirical parameters mlt 3k 1 the coupling between water flow and heat transport is reflected in the influence of temperature on the soil hydraulic functions according to the capillary theory the temperature dependence of the soil water pressure head can be expressed as philip and de vries 1957 7 h t σ t σ t 0 h t 0 β h h t 0 where ht and h t 0 σ t and σ t 0 are the pressure heads surface tensions at the air water interface mt 2 at temperature t and reference temperature t 0 respectively βh is the temperature scaling factor for the pressure head the temperature dependence of the hydraulic conductivity can be expressed as constantz 1982 8 k t θ μ t 0 μ t ρ t ρ t 0 k t 0 θ β k k t 0 θ where kt and k t 0 are the hydraulic conductivities at temperature t and reference temperature t 0 respectively μ t and μ t 0 ρ t and ρ t 0 are the dynamic viscosity ml 1t 1 density of soil water ml 3 at temperature t and reference temperature t 0 respectively βk is the temperature scaling factor for the hydraulic conductivity 3 methodology in this study we treat ks α and n as random parameters or functions then eqs 1 8 become stochastic differential equations suppose the stochastic partial differential equation is expressed as 9 l s x t ξ g x t ξ 0 where l is the differential operator s x t ξ is the model response such as pressure head water content etc g x t ξ is a given function representing the coupled unsaturated flow and heat transport model x is the physical location and ξ ξ 1 ξ 2 ξ m is the distributed parameter vector with m components e g the unsaturated soil hydraulic parameters 3 1 probabilistic collocation method pcm employs the pce to approximate the stochastic model response s x t ξ ghanem and spanos 2003 for the sake of simplicity the time and location indices are omitted in the following formulations the pce form of s ξ is expressed as 10 s ξ j 0 q 1 c j ψ j ξ q d m d m where ψ j ξ are the orthogonal pce basis functions with maximum polynomial degree of d which satisfy 11 ψ j ξ ψ k ξ ψ j ξ ψ k ξ ρ ξ d ξ δ jk where denotes the expectation ρ ξ is the corresponding probability density function δjk is the kronecker delta function δjk 1 if j k and 0 if j k cj are the pce coefficients that can be determined by performing spectral projection le maître and knio 2010 xiu 2010 i e 12 c j s ξ ψ j ξ ρ ξ d ξ ψ j ξ ψ j ξ ρ ξ d ξ i 1 p s ξ i ψ j ξ i w i ψ j 2 ξ where ξ i w i i 1 p are a set of collocation points and associated weights such that the summation approximates the integral finally we can calculate the statistical moments e g mean and variance and probability density function of the model response using eq 10 due to the orthogonal property of the pce basis functions the mean and variance of the model response can be directly calculated from the pce coefficients 13 μ s s ξ ρ ξ d ξ c 0 14 σ s 2 s ξ μ s 2 ρ ξ d ξ j 1 q 1 c j 2 ψ j 2 ξ 3 2 anova based multi fidelity pcm to improve the computational efficiency of pcm we develop an amf pcm by integrating pcm into a multi fidelity framework in this study instead of directly expanding the hf model with pce we firstly apply the functional anova decomposition to the lf model and its discrepancy to the hf model respectively and approximate them with the summation of low order anova components then we implement the pce expansion on these low order anova components and formulate the pce representation of the hf model as a combined expansion of the lf model and the discrepancy 3 2 1 multi fidelity framework let s high ξ and s low ξ be the responses respectively obtained from the hf model and the lf model in the multi fidelity framework we assume that the lf model response can be corrected to match the hf model response by adding a correction term s err ξ ng and eldred 2012 i e 15 s high ξ s low ξ s err ξ 3 2 2 pce approximation based on the functional anova decomposition in this subsection we apply the functional anova decomposition to the lf model and the correction function respectively and then construct the pce approximations given their anova components in terms of the theoretical part the sparsity of effects principle montgomery 2017 states that a system is usually dominated by the main effects and low order interactions thus it is most likely that the main single factor effects and two factor interactions are the most significant responses in other words higher order interactions such as three factor interactions are very rare in this study we use the 0th 1st and 2nd order anova components to approximate the lf model i e 16 s low ξ f low ξ f 0 low j 1 m f j low ξ j 1 j k m m f j k low ξ j ξ k where the function f 1 2 w with w random variables ξ 1 ξ 2 ξ w is entitled the w th order anova component in amf pcm the lf model should catch the right trend of the input output relationship of the hf model then the anova components up to the first order are usually sufficient to approximate the correction function i e 17 s err ξ f err ξ f 0 err j 1 m f j err ξ j suppose the random variables ξ are gaussian distributed the hermite polynomials xiu 2010 are then used to expand each anova component into pce for parametric distributions other than gaussian distribution the generalized polynomial chaos gpc developed by xiu 2010 can be used for the gaussian distribution the first three one dimensional pce basis functions are ψ 0 ξ 1 ψ 1 ξ ξ and ψ 2 ξ ξ 2 1 2 on this basis the 1st order anova component can be expressed as 18 f 1 ξ 1 j 0 2 c j ψ j ξ 1 c 0 c 1 ξ 1 c 2 ξ 1 2 1 2 for the component function f 1 2 ξ 1 ξ 2 its pce basis functions are formulated from the tensor product of the corresponding one dimensional basis i e 19 f 1 2 ξ 1 ξ 2 j 0 2 k 0 2 c j k ψ j ξ 1 ψ k ξ 2 c 00 c 01 ξ 2 c 02 ξ 2 2 1 2 c 10 ξ 1 c 11 ξ 1 ξ 2 c 12 ξ 1 ξ 2 2 1 2 c 20 ξ 1 2 1 2 c 21 ξ 2 ξ 1 2 1 2 c 22 ξ 1 2 1 ξ 2 2 1 2 3 2 3 solving the pce coefficients after expanding the lf model and correction function with anova based pce pcm is employed to solve the lf pce and correction pce coefficients according to li et al 2001 2002 the 0th 1st and 2nd order anova components can be calculated as follows 20 f 0 f 0 21 f 1 ξ 1 f ξ 1 0 0 f 0 22 f 2 ξ 2 f 0 ξ 2 0 f 0 23 f 1 2 ξ 1 ξ 2 f ξ 1 ξ 2 0 0 f 1 ξ 1 f 2 ξ 2 f 0 in pcm with different sets of collocation points we evaluate the component f 1 2 w ξ 1 ξ 2 ξ w and make it equal to the corresponding polynomials for a one dimensional pce with the highest polynomial degree of d the collocation points are positioned at the roots of the d 1 th polynomial specifically for the one dimensional second order hermite pce the collocation points are the roots of the third order hermite polynomial ξ 3 3 ξ 6 i e 3 0 and 3 while for a multidimensional pce the collocation points are formulated from the tensor product of the one dimensional collocation points note that the correction pce which serves as a corrector for lf pce is constructed based on the discrepancy between the hf and lf model responses at selected collocation points in this situation several hf model simulations are required to allow some of the lf model responses to be corrected by the hf model responses thus the hf model simulations are required to expand the correction function into pce the computational cost of amf pcm is spent on solving the lf pce and correction pce coefficients overall it requires 1 2 m times of hf model evaluations and 1 2m 2 times of lf model evaluations 3 2 4 post processing after determining the pce coefficients we sum up all the pce basis functions to formulate the pce approximations for the lf model and correction function then the pce representation of the hf model response can be expressed as a combination of the lf pce and correction pce 24 s high ξ j γ r c j low c j err ψ j ξ j γ q γ r c j low ψ j ξ where г q are the indices for the pce basis functions of the multi fidelity mf expansion γ r γ q are the indices for the common pce basis functions of the lf and correction expansions using the above expansions the mean and variance of the hf model response can then be calculated as 25 μ s c 0 low c 0 err 26 σ s 2 j γ r 0 c j low c j err 2 ψ j 2 ξ j γ q γ r c j low 2 ψ j 2 ξ 3 2 5 algorithm summary the computational procedure of amf pcm is summarized as follows 1 lf model approximation 1 truncate the 0th 1st and 2nd order anova components to approximate the lf model i e eq 16 2 calculate the 0th order anova component by evaluating the lf model at the collocation points ξ 0 and expand the 1st and 2nd order anova components into pce respectively using eqs 18 and 19 3 solve the lf pce coefficients c low by pcm 2 correction function approximation 1 truncate the 0th and 1st order anova components to approximate the correction function i e eq 17 2 calculate the discrepancy between the hf and lf model responses at the collocation point ξ 0 and regard it as the 0th order anova component then expand the 1st order anova components into pce using eq 18 3 solve the correction pce coefficients c err by pcm 3 post processing 1 construct the pce representation of the hf model response as a combination of the lf pce and correction pce 2 use the combined expansion to calculate the statistical moments i e eqs 25 and 26 4 case studies in this section several numerical case studies are used to demonstrate the efficiency of the proposed method as shown in fig 1 the study domain is 1 m 2 m discretized into 21 41 rectangular elements the orange dots along the central vertical line x 0 5 m represent the validation locations for pressure head initially the pressure head is 2 m at the top and linearly changed to 0 m at the bottom this initial condition represents a real world scenario of when the groundwater table is 2 m below the surface and the matric potential head is at equilibrium with the gravitational head thus the total potential head is 0 and no water movement we specify a constant flux rate q 0 005 m d 1 at the upper boundary to simulate the infiltration a constant pressure head h 0 m water table at the bottom and no flow conditions at the left and right boundaries the temperature at the upper boundary varies sinusoidally to simulate the diurnal temperature variations of soil surface 27 t t a t a cos 2 π t 13 p where ta 30 c is the average temperature ta 5 c is the temperature amplitude p 24 h the simulated infiltration period is 10 days the pressure heads at the validation locations are analyzed at time t 10 days for each simulation the hydrus 2d simunek et al 2008 is used to solve the coupled unsaturated flow and heat transport model all the computations are implemented on a pc running windows 10 pro 64 bit with a 2 10 ghz cpu and 64 gb ram we design a series of numerical cases with increasing complexities to test the performance of amf pcm for uncertainty quantification of coupled unsaturated flow and heat transport problems two ways of building a computationally cheap lf model are presented in our case studies one is to simplify the physics i e without considering the coupling between the unsaturated flow and heat transport the other one is to adopt a coarser discretization the results provided by the traditional 2nd order pcm abbreviated as pcm in the following discussion are taken for comparisons in order to quantify the accuracy of the pce approximation the root mean square error rmse and coefficient of determination r2 between the pce representations and the hf model responses are used 28 rmse 1 n v i 1 n v s i s i high 2 29 r 2 i 1 n v s i s s i high s high i 1 n v s i s 2 i 1 n v s i high s high 2 2 where s i high are the pressure heads computed from nv times of monte carlo mc simulations of hf model si are a set of nv outputs of the pce representations using eq 24 here nv 5000 the quantities with the bar s s high denote the mean parts 4 1 homogeneous random hydraulic parameters in this section we assume all the parameters are homogeneous and the uncertainty stems from three unknown hydraulic parameters i e ks α n note that both ks and α are positive quantities and n must be larger than one here we assume that the log saturated hydraulic conductivity y ln ks the log pore size distribution parameter x ln α and the fitting parameter z ln n 1 are gaussian distributed li et al 2009 the mean values of the three parameters are set to be μ k s 1 m d 1 μ α 2 m 1 and μ n 1 0 4 the variability is given in terms of the coefficient of variation as follows c v k s 1 cv α 0 2 and cv n 1 0 2 with the mean and coefficient of variation of the lognormal random variable v the statistical moments of the corresponding transformed variable u ln v where u y x z can be easily calculated through the following formulations zhang 2002 30 μ u 2 ln μ v 0 5 ln μ v 2 1 c v v 2 31 σ u 2 ln 1 c v v 2 the correlation coefficients between the three random parameters are set as γ yx 0 8 γ yz 0 3 γ xz 0 6 li et al 2009 then the hydraulic parameter realizations can be generated by sampling from these prior statistics the other parameters related to the coupled unsaturated flow and heat transport model are assumed known and listed in table 1 for a single hf model simulation the cpu time is about 2 s in this case we choose to build an lf model without considering the coupling of water flow and heat transport which takes about 1 s for a single model simulation the r2 values between the hf and lf pressure heads at the validation locations are plotted in fig 2 a overall the lf pressure heads exhibit a relatively high correlation with the hf pressure heads despite this it does not mean that one can simply replace the hf model with the lf model here we use the results from validation location z 0 2 m to illustrate this point the scatter plot between the hf and lf pressure heads from the top validation location z 0 2 m is shown in fig 2b it can be seen that systematical deviations always exist between the hf and lf models this is caused by neglecting temperature dependence of the soil water pressure head and the hydraulic conductivity as shown in eqs 7 and 8 in the lf model theoretically speaking amf pcm works only if the discrepancy between the hf and lf models is less complex than the lf model it is because that the central idea of amf pcm is to correct the lower order terms of the lf pce by the correction pce and then predict the higher order behavior of the hf model response that is not captured by the correction pce to illustrate this point we analyze the decay of pce coefficients solved by amf pcm fig 3 plots the lf correction and mf pce coefficients of pressure head from validation location z 0 2 m it is clearly shown that the spectrum of correction pce coefficients has lower magnitude and faster decay than those of lf pce coefficients this indicates that it is easier to approximate the correction function compared to the lf model which guarantees the feasibility of the mf pce simulation to illustrate the superiority of amf pcm we also solve the stochastic problem using the traditional pcm respectively based on the hf model and the lf model the rmse and r2 values of pressure head at the validation locations calculated by pcm and amf pcm are plotted in fig 4 it is obvious that the lf based pcm gives significantly biased results at some validation locations as indicated by the largest rmse and smallest r2 values it is also noted that compared with the hf based pcm amf pcm provide the smaller rmse and larger r2 values this indicates that a better accuracy is achieved by amf pcm it is because that functional anova decomposition is employed in amf pcm and the maximum polynomial degree of amf pcm can reach as high as four as shown in eq 19 while the full pce is used in pcm and the maximum polynomial degree of the pcm is only two in other words it is wise to neglect the high order anova components rather than using the full pce in terms of the computational cost 31 times of hf model evaluations are required for the hf based pcm while for amf pcm it requires 7 1 2 3 times of hf model evaluations and 19 1 2 32 times of lf model evaluations it should be noted that amf pcm is easy to parallelize without loss of generality we compare the cpu time for a single core serial calculation it is easily known that the cpu time of the hf based pcm and amf pcm is 62 2 31 s and 33 2 7 1 19 s respectively compared with the traditional pcm that is solely based on the hf model the amf pcm achieves a better accuracy with nearly half the cost 4 2 heterogeneous parameter field in this section we treat α and n to be deterministic but the log saturated hydraulic conductivity y ln ks as the only input random field with different levels of variability and correlation lengths as shown in table 2 the random field is assumed gaussian distributed with the mean μ y 0 3 and the following separable exponential covariance function 32 c y y x 1 z 1 y x 2 z 2 σ y 2 exp x 1 x 2 λ x z 1 z 2 λ z where σ y 2 is the variance of the random field λx and λz are the correlation lengths in the horizontal and vertical directions respectively both pcm and amf pcm suffer from the curse of dimensionality when dealing with the spatially varying parameter field in this study we decompose y ln ks with the karhunen loève expansion kle zhang and lu 2004 and retain the first m random terms to parameterize the log saturated hydraulic conductivity field then the random field can be expressed as 33 y x z μ y j 1 m η j f j x z ξ j where η j and fj x z are the eigenvalues and eigenfunctions of the covariance function respectively which can be solved from the fredholm equation of the second kind note that the sum of all eigenvalues is related to the total variance of the random field keeping more kle terms helps to characterize the random field more accurately the cpu time for each hf model with 861 21 41 rectangular elements simulation is about 32 s 4 2 1 lf model with simplified physics for the first four cases shown in table 2 the lf model is built by simplifying the physics i e without considering the coupling between water flow and heat transport the cpu time of evaluating such an lf model is about 2 s in amf pcm a high correlation between the hf and lf models is essential for successful mf simulations here we take case 1 as an example to illustrate in case 1 we keep 20 kle terms and calculate the r2 values between the hf and lf pressure heads at the validation locations as shown in fig 5 a a good correlation is observed between the pressure heads obtained from the hf and lf models fig 5b shows a scatter plot between the hf and lf pressure heads from the top validation location z 0 2 m it can be seen that although the main trend of the hf model can be captured by the lf model systematical deviations always exist this provides the necessity to perform the mf pce simulation note that the lf model can assist mf pce simulation only if the decay of the correction pce coefficients is faster than that of the lf pce coefficients the lf correction and mf pce coefficients of pressure head from the top validation location z 0 2 m are calculated and plotted in fig 6 it is clearly shown that the spectrum of correction pce coefficients has lower magnitude and faster decay than those of lf pce coefficients this verifies the feasibility of the mf pce simulation fig 7 compares the rmse and r2 values of pressure head at the validation locations calculated by pcm and amf pcm for different levels of variability and correlation lengths it can be seen that amf pcm achieves a better accuracy as indicated by the smaller rmse and larger r2 values in terms of the computational cost 881 times of hf lf model evaluations are required for the pcm while for amf pcm it requires 41 1 2 20 times of hf model evaluations and 801 1 2 202 times of lf model evaluations furthermore we also compare the total cpu time of the hf based pcm and amf pcm the cpu time of the hf based pcm and amf pcm are 28 192 32 881 s and 2914 32 41 2 801 s respectively compared with the traditional hf based pcm amf pcm achieves a better accuracy with nearly an order of magnitude of speed up thus simplification of the physics and the anova technique significantly reduce the computational effort while the mf framework guarantees the accuracy in case 2 all model settings are the same as case 1 except that the horizontal correlation length of ln ks field is smaller the superiority of amf pcm over pcm is demonstrated in this smaller scale problem in case 3 all input parameters are the same as those in case 2 except that the variance of ln ks field is increased to 2 it is seen from fig 7 that the accuracy of amf pcm deteriorates with the increasing variance the summation of eigenvalues with different correlation lengths are shown in fig 8 it can be seen that for a smaller correlation length more kle terms are needed to retain the same accuracy in case 4 we retain more i e m 50 kle terms to parameterize the parameter field fig 9 plots the mean and variance of pressure head at the validation locations calculated by amf pcm and mc method with 8000 realizations using the hf model it can be seen that the solutions from amf pcm are in good agreements with those from mc simulations it should be noted that the number of hf model evaluations in amf pcm is only 101 furthermore in fig 10 we compare the rmse and r2 values of pressure head at the validation locations calculated by pcm and amf pcm compared with pcm amf pcm is more computationally efficient for solving such a high dimensional stochastic problem 4 2 2 lf model with a coarser discretization in case 5 we build an lf model using a much coarser discretization i e 7 21 rectangular elements the cpu time of evaluating such an lf model is about 3 s to test the correlation between the hf and lf models we calculate the r2 values between the hf and lf pressure heads at the validation locations fig 11 it can be seen that all the r2 values can reach 0 99 or more which means a good correlation between the hf and lf pressure heads the rmse and r2 values of pressure head at the validation locations calculated by pcm and amf pcm are plotted in fig 12 the superiority of amf pcm over pcm is demonstrated again 5 conclusions in this study we develop an anova based multi fidelity probabilistic collocation method amf pcm for uncertainty quantification of coupled water flow and heat transport in the vadose zone this method can take advantage of both the accuracy of the high fidelity hf model and the computational efficiency of the low fidelity lf model to implement amf pcm two typical ways of building a computationally cheap lf model i e by simplifying the physics or using a coarser discretization are presented in amf pcm we apply the functional anova decomposition to the lf model and its discrepancy to the hf model respectively and approximate them with the summation of low order anova components then we implement the pce expansion on these low order anova components and formulate the pce representation of the hf model as the combined expansion of the lf model and the discrepancy which is much less costly than the direct expansion of the hf model with pce the efficiency and accuracy of amf pcm are systematically investigated by several numerical examples of uncertainty quantification in coupled unsaturated flow and heat transport model compared to the traditional pcm that is solely based on the hf model amf pcm achieves a better accuracy with a significantly lower computational cost in amf pcm the lf model should catch the right trend of the input output relationship of the hf model in other words the lf model should be carefully checked if the correlation between the hf and lf models is weak the performance of amf pcm will compromise to further improve the efficiency of amf pcm the adaptive anova decomposition can be explored in the future study it is a promising way of adaptively selecting active anova components which leads to an adaptive approach to construct a pce approximation for the lf model especially when the computational cost of the lf model simulation cannot be negligible acknowledgements this work is supported by the national natural science foundation of china grants 41571215 and 41771254 and china postdoctoral science foundation grant no 2018m630680 data and computer codes used are available upon request to the corresponding author 
731,in reality most of the fluid and rock interactions occur in the presence of multiple fluid phases such exchanges thus are very important when different fluids under the influence of external forces coexist in the pore space in this work the response of berea sandstone under quasi static loading conditions is modeled in the presence of multiple fluid phases the solid matrix is characterized by hyperelasticity while the fluids are assumed to be incompressible and newtonian the behavior of the sample was investigated during the exertion of confining stresses at the grain boundaries followed by a sequence of drainage and imbibition cycles using the volume of fluid vof method to investigate the effect of triaxial loading on fluid distribution we further investigated the role of stress on relative permeability initial water saturation residual oil saturation and trapped oil globule size distribution our results indicate relative permeability alteration due to compaction and changes in the pore geometry relative permeability of the oil phase during drainage was reduced while there was a slight decrease in relative permeability of water furthermore the initial water saturation increased due to a general shift in the pore throat diameter distribution towards smaller values leading to the wetting phase occupying more pore throats finally higher confining stress conditions resulted in a greater distribution of disconnected oil globules compared to a smaller distribution of globules at zero stress conditions keywords volume of fluid fluid solid interface non linear hyperelastic deformation nomenclature symbol definition eij green strain tensor δ ij kronecker delta fij deformation gradient sij second piola kirchhoff stress tensor u i j lagrangian displacement σ ij cauchy stress tensor j jacobian w strain density function cijkl compliance matrix c i j k l tangent modulus tensor vf divergence free velocity nca capillary number z datum or reference point q volume flow rate of fluid s fluid saturation α indicator function k effective permeability κ interface curvature parameter definition kro relative permeability of oil krw relative permeability of water ξ interfacial tension µ fluid dynamic viscosity vd superficial velocity ρ fluid density ρ1 density of the reference fluid ρ2 density of the secondary fluid µ1 viscosity of the reference fluid µ2 viscosity of the secondary fluid subscripts w wetting phase nw non wetting phase i j k l indices 1 introduction the mechanical and structural behavior of a rock may be influenced by many competing factors such as porosity mineralogy pore fluids and confining pressure baud et al 2000 mair et al 2002 scott and nielsen 1991 tahmasebi 2018a b fluid flow through porous media can be equally affected by induced stresses from external load or a change in internal pressure alteration in fluid pressure gradient in berea sandstone sample has been attributed to prevalent uniaxial stress conditions fagbemi et al 2018 research has also shown that external stress alters absolute permeability berryman 1992 davies et al 1999 davies and davies 1999 dong et al 2010 fagbemi et al 2018 holt 1990 mclatchie et al 1957 wei et al 1986 zhang and tahmasebi 2018 at the subsurface rocks are continually under the influence of traction along their respective boundaries owing to plate tectonic driving forces gravitation loading and other external forces resulting from human activities e g fluid extraction injection and mining anderson 1951 terzaghi 1923 such local perturbations both natural and manmade induce large and small scale stresses which eventually result in deformation of rock masses that in turn lead to changes in rock and flow properties therefore rigorous characterization and modeling of subsurface conditions require interlinking of physical processes such as hydro thermal and mechanical processes at the pore scale single phase numerical simulations at pore scale have helped to enhance the development of macroscopic models and constitutive relationships which have led to robust descriptions of coupled flow through porous media coupled multiphase flow modeling on the other hand has not been thoroughly investigated multiphase flow modeling is very important for most subsurface applications especially in complex fluid fluid systems such as gas water oil water and gas oil or even a three phase flow scenario of gas oil water modeling of such systems involve solving certain transport equations which require sophisticated computational fluid dynamics tools in order to have a general understanding of the interaction between multiphase flow and solid mechanics we present a decoupled framework in this paper i e we assume the fluid forces inducing solid deformation are negligible at this scale of investigation as a result the grains deform under quasi static loading based on hyperelastic constitutive behavior and then multiphase flow simulations are carried out on the deformed sample different lagrangian and eulerian computational approaches for modeling multiphase flow at fine scale have been indicated in the literature front tracking method tryggvason et al 2001 van sint annaland et al 2006 which is lagrangian in nature based on discrete phase model dpm is one of the preliminary methods this technique requires mesh cell movement with the continuous medium such a method is unstable for porous media applications due to oscillations which could occur at the fluid fluid interface if the indicators move independently off each other another approach that has gained a lot of attention is the continuous phase model which is an eulerian approach some examples include the volume of fluid method vof hirt and nichols 1981 mixture models wang and cheng 1996 and interface tracking methods such as level set olsson and kreiss 2005 and the phase field method badalassi et al 2003 jacqmin 1999 the interface tracking methods model the flow of two different immiscible fluids separated by a clearly defined interface in the phase field and level set methods the fluid s interface is tracked using a color function on a fixed mesh this function is tracked by solving additional transport equations the mixture model is typically used for simulating dispersed phases it solves one set of navier stokes equations for the momentum of the mixture a mixture averaged continuity equation and a transport equation for the volume fraction of the dispersed phase in the volume of fluid method vof the volume fraction is tracked instead of the phase interface as a result it provides a clear picture of the velocity and pressure fields of a reference fluid as well as the interfacial tension force for pore scale fluid flow it requires the solution of one navier stokes equation along with advection of an indicator function based on divergence free velocity hence it is reliable stable and more computationally efficient than other eulerian methods in this work a filtered and segmented voxel based berea solid geometry is meshed using tetrahedral grid elements and then solved for non linear elastic deformation based on external forces acting on the outer boundaries this is achieved using the finite element method fem we then apply the vof method to track the volume fraction of the multiphase system and compute the occupancy of the reference and the secondary phase based on the indicator function spatial and temporal domains for the fluid are discretized using finite volume technique vof is deemed appropriate for this work because it has been used to successfully to model drainage in micromodels such as sphere pack geometries ferrari and lunati 2013 two phase flow in tubes gupta et al 2009 and trickling effect in reactors in an array of tubes horgue et al 2013 rohan and lukeš 2015 this work is arranged as follows we briefly introduce preprocessing of the fluid and solid domains the hyperelastic constitutive model for the solid matrix is then explained the direct approach for the flow equations which is based on vof at the pore scale is described all simulations are carried out under capillary dominated regimes additionally we briefly discuss the microscopic terms used in obtaining their upscaled macroscopic equivalents finally we examine how these fluid properties are affected by quasi static triaxial loading 2 computational domain as stated earlier we intend to examine the effect of nonlinear deformation on fluid flow processes in porous media the geometry used for stress and fluid simulations was constructed based on images from micro ct scans berea sandstone was imaged at a resolution of 1 5 µm the dry image was then carefully filtered to eliminate noise followed by segmentation to separate solid and fluid phases the extracted solid domain was eventually smoothened by averaging the existing weights and finally tetrahedral grids were generated using avizo fire important properties of the utilized 3d image are highlighted in table 1 and the berea sample used in this study can be seen in fig 1 this sample represents only one scenario for the existing rock samples for quantifying the uncertainty and variation in terms of pore morphology several other samples can be generated computationally karimpouli and tahmasebi 2016 tahmasebi et al 2017a b this topic however is not investigated in this paper 2 1 non linear elastic solid model in order to properly model subsurface grain compaction we implement a hyperelastic constitutive model that accounts for non linear deformation of the rock sample the material is subjected to quasi static load under triaxial conditions considering that the deformation is elastic it is not accompanied by energy dissipation einav and nguyen 2009 hence we can apply large initial strains on the material and study how multiphase flow properties are affected we explicitly present a non linear model of the stress strain behavior of the berea sandstone under different confining stress conditions the rock used in this work is a high permeability sandstone with a porosity of 25 05 rocks of this nature are commonly known to exhibit low to medium compressive strength and are therefore subject to large strains 2 1 1 governing equations solid matrix in general linear elasticity is not sufficient for modeling the constitutive behavior of berea sandstone due to the presence of pore and grain contacts in the elastic porous material these pore grain contacts have been known in literature to introduce non linearity bernabé et al 1994 khan et al 1991 consequently the elastic portion of the stress strain cycle for berea sandstone is going to be highly nonlinear as such hyperelastic equations are applied for modeling the non linear behavior of the solid matrix generally hyperelastic materials are characterized by the existence of strain or stored energy potential which is a function of finite strain this strain energy function w is defined as the energy stored in the rock material per unit reference volume or the work required per unit initial material volume to reach the strain state for the hyperelastic or green elastic material the model accounts for finite strains and hence we define the material strain using the green lagrangian strain tensor the green strain tensor is given by 1 e i j 1 2 f k i f k j δ i j where f is the deformation gradient and δ ij is the kronecker delta function in terms of lagrangian displacements eq 1 can be expressed as 2 e i j 1 2 u i j u j i u k i u k j the strain relationship can then be defined as 3 s i j c i j k l e k l the corresponding strain rate is given by eq 4 4 s i j c i j k l e k l where c i j k l represents the tangent modulus tensor and s is the conjugate stress rate and e the strain rate for a material where c i j k l c i j k l we can define a potential function as w if the potential function depends on the green strain tensor the second piola kirchhoff stress is given as 5 s i j w e i j for stress applications in rocks soils that have complex heterogeneous behavior and medium compressive strength we apply the saint venant kirchhoff model which extends the linear elastic material model to the nonlinear regime for compressible materials 6 s i j λ e k k δ i j 2 μ s e i j where λ and µ s are the lame constants the following strain energy function used for the model is given by eq 7 7 w e λ 2 e k k 2 μ s e i j e i j sij from eq 6 can be expressed in the form of the cauchy stress tensor by 8 σ i j f r i s i j f k j j 1 3 two phase flow simulation in the last ten years direct methods have been gaining more attention and considered as a suitable alternative for carrying out pore scale simulations in that interfacial tension viscous and capillary forces can be easily incorporated into the model while preserving the pore space geometry hence we examine the numerical method for solving two phase incompressible and isothermal flow equation directly from a finite volume mesh discretization is achieved with respect to the spatial and temporal domains 3 1 fluid equations direct simulation of multiphase flow requires that mass momentum and energy are conserved in the control volume assuming isothermal conditions and that the fluid is located in a non rotating frame of reference mass is conserved for the incompressible fluid by the continuity equation 9 v i x i 0 for momentum conservation 10 ρ v i t v j v i x j p x i μ v i j j ρ f i where vi represents the pore velocity p is the fluid pressure µ denotes the dynamic viscosity of the fluid ρ is the density and f is the body force eqs 9 and 10 are referred to as the incompressible navier stokes equations for an isothermal system at the pore scale the momentum balance equation for incompressible fluids is used to relate the density of the fluid fluid shear stresses interfacial or pore scale velocity pressure gradient and the external forces surface and body forces knowing the pressure gradient together with capillary and gravity forces the momentum balance equation can be used to update the velocity field at any time step in order to incorporate more fluid phases into the system we apply an indicator or color function by the following equation 11 α i t α i v f 0 where vf is the divergence free velocity obtained from the solution of eqs 9 and 10 α i is the scalar indicator function that is solved by a pure advection the color function represents the fraction of the computational grid occupied by one phase it results in 1 for the reference phase and 0 for the secondary phase properties of multiphase mixtures are given by a summation of each of the components densities and viscosities 12 ρ i 1 n α i ρ i 13 μ i 1 n α i μ i where n is the number of phases for the two phase vof system the average fluid density and viscosity are given by 14 ρ α ρ 1 1 α ρ 2 15 μ α μ 1 1 α μ 2 the vof is used to solve eq 11 the equation is advected with an explicit lagrangian advection method using the fluid velocity and the normal vector at the fluid fluid interface one advantage of the vof method is that it does not have to solve several navier stokes equations for each phase each of the fluid phases in the simulation is accounted for by the indicator function interfacial tension is represented in the vof model to account for in contact fluids interaction interfacial energy present between the residing fluids results from the inward attraction of the molecules of each phase modeling this interfacial phenomenon in our system is achieved by the continuum surface force csf developed by brackbill et al 1992 the csf model includes a volume force that yields a surface force when the thickness of the interface is infinitely small it is important to note that interfacial tension acts only at the interface therefore entering only in the boundary conditions thus it is implemented as a body force within the navier stokes equation by including eq 16 16 f s f σ κ n s δ s where fsf is the interfacial force term δ s is the surface delta function and κ represents the curvature of the surface given by 17 κ α α this form of equation requires a constant interfacial tension the momentum equation or pressure velocity coupled system is solved using the pressure implicit splitting of operators piso algorithm by issa 1986 a summary of the piso loop is presented in the dashed box in fig 2 in the piso loop the momentum equation is solved first the exact pressure gradient source term is not known at the beginning of the simulation the pressure field from the previous time step is then used to provide an approximation of the new velocity field these are referred to as predicted velocities the predicted velocities can then be used to reformulate the new pressure equation the solution of the pressure equation gives the first estimate of the new pressure field this step is called the pressure solution velocity correction is then carried out in an explicit manner 3 2 macroscopic properties of fluid pore scale multiphase simulations using direct numerical simulation dns methods focus on modeling velocity distributions and hydraulic gradients locally however the needed quantities to explicitly model the flow in porous media are macroscopic in nature although carrying out direct numerical simulation on the entire continuum grid might produce a nearly perfect description of flow conditions at large scale employing extremely fine spatial discretization would require massive computer memory and hence not feasible the approach to tackle this problem is to select a sub volume domain that represents the properties of the porous media and can produce an aggregate response for a sample to be considered representative it must be comprised of significant amount of heterogeneities microscopic fluid properties can then be averaged over the representative volume to obtain the equivalent velocity or pressure in darcy i e macroscopic scale in order to obtain the absolute permeability of the sample we upscale under the assumption that the flow is laminar and the effect of momentum transfer within the fluid is negligible compared to drag forces at the fluid grain interface we can therefore obtain the influx of fluid through a cross section in terms of hydraulic gradient by darcy s law for a two phase flow system with water and oil the volume flow rates of each of the fluids can be given in terms of kw and knw which represent the effective permeability of the wetting and non wetting phases respectively and are defined using 18a q w k w s w μ w p w ρ w g z 18b q n w k n w s n w μ n w p n w ρ n w g z 3 3 relative permeability for multiphase flow in porous media the fluids will experience a reduction in conductivity due to fluid fluid and fluid solid interactions as well as the fact that they share the same pore space these effects can be represented using relative permeability concept two experimental approaches that are available for obtaining the relative permeability are the steady state avraam and payatakes 1995 and unsteady state methods sarem 1966 steady state technique involves simultaneous flow of two phases at different flow rates until steady state conditions are established while for the unsteady state one phase displaces the other similarly by using direct computational methods one can mirror these experimental procedures silin et al 2009 computed relative permeabilites when the fluids were assumed to be in equilibrium saturation maps were used and one phase is assumed to be static while the effective permeability of the other phase was computed by utilizing similar boundary conditions at solid fluid interface another approach is presented by raeini et al 2014 to compute the relative permeability by considering the rate of dissipation of microscopic forces i e pressure and viscous forces per unit flow rate for the system in essence the macroscopic pressure drop across a porous medium is attributed to the dissipation fluid forces at pore scale we apply the later computational approach for computing the pressure drop across the system then we systematically average the velocities of the both phases the relative permeability is then obtained by computing the ratio of the flow rate of reference fluid per unit macroscopic pressure drop to the flow rate per unit macroscopic pressure drop of the equivalent single phase event 4 computations investigation of the effects of triaxial loading on injected fluid behavior requires a sequence of drainage oil displacing water and imbibition water displacing oil simulations to be carried out the porous media geometry was obtained from micro ct imaging with a volume of 850 µm3 and average equivalent grain size diameter of 191 366 µm thereafter tetrahedral meshes were generated using cad based meshing techniques due to the large size of the computational domain we carried out grid coarsening by the use of gaussian pyramid algorithm this effectively helped reduce the image size by half to 424 425 µm3 while still maintaining the image s complexity and heterogeneity compressive forces were applied on the external grain wall boundaries while applying a fixed constraint boundary condition on the bottom boundary to ensure stress continuity across the solid domain the confining stresses used in this study were 1 mpa 2 5 mpa 5 0 mpa and 10 mpa 4 1 primary drainage simulations fluid domains were extracted from the deformed solid domains by inversion fluid meshes were iteratively castellated and eventually snapped onto their respective surfaces based on specified criteria the non wetting phase oil was injected into the pore domain at a constant uniform velocity v f i n at the inlet while maintaining a constant pressure p out at the outlet the walls were defined as no flow boundaries the densities of the wetting and non wetting phases were kept constant multiphase simulations began with the wetting phase occupying the entire computational fluid domain prior to the injection of non wetting phase 14 of the pore volume was initialized with oil at the inlet boundary for the undeformed configuration and 12 5 for the deformed medium to account for the reduction in pore volume during loading a dynamic contact angle of 0 was prescribed at the inlet because only water was present at the beginning of the simulations and oil had not yet began to displace water a constant contact angle of 45 between the grain walls and the fluid fluid interface was enforced to prevent change in wettability during simulations the drainage simulations continued until one pore volume of the non wetting phase was injected gravity forces were assumed to be insignificant due to the small scale of the work and the horizontal nature of the flow flow conditions were characterized by three dimensionless numbers namely the capillary number nca viscosity ratio m and reynolds number re the capillary number was used to monitor the flow condition the capillary number represents the ratio of viscous to capillary forces it is expressed as 19 n c a μ v d ξ where ξ is the interfacial tension and vd is the superficial velocity and µ is the viscosity of the displacing phase typical values for flow in a reservoir are in the range 10 8 nca 10 6 guo et al 2015 each of the flow simulations were carried out under capillary dominated flow regime to achieve this drainage process was carried out at slow rates thereby rendering the effects of viscous forces nearly insignificant we ensured a stable displacement front by using a viscosity ratio m µ nw µ w greater than 1 for the simulations high values of m imply that the invading fluid is more viscous than the defending phase leading to a stable front similarly a combination of low nca and low m 1 results in capillary fingering while high nca and very low m 1 leads to viscous fingering regime multiphase flow is also affected by the macroscopic capillary pressure which can be determined by the difference between the pressure at the inlet of the displacing fluid phase and the pressure at the outlet of the defending fluid for a comprehensive study of this subject the reader is referred to ferrari and lunati 2013 5 results and discussion a series of triaxial compression tests were carried out on the solid using hydrostatic loads of 1 mpa 2 5 mpa 5 mpa and 10 mpa the fluid distribution and permeability after non linear solid deformation were investigated high performance computing was used in carrying out flow simulations on a hybrid cpu gpu supercomputing cluster boasting a total of 4560 computing cores the supercomputer is powered by intel xeon cpus with nvidia tesla k20x gpus for accelerating the computations 9 nodes were used in this work each with 20 cores making a total of 180 cores quasi static loading was applied normal to the free boundaries while fixed boundary condition was imposed on the bottom plane for each loading scenario the vertical stress was held constant while confining stresses were systematically increased during the simulation porosity reduction occurred as compressive forces were increased as seen in table 3 porosity reduced from the original state of 0 250575 to 0 250561 when 10 mpa of stress was applied fig 4 indicates a three dimensional 3d evolution of axial strain at two different compressive states the non linear pore grain interfaces appear to be impacted the most by the stresses in the axial direction it should be noted that the young s modulus of berea increased as more confining stress was applied the rock alters its elastic properties in response to hydrostatic stresses by becoming more rigid additionally increase in confining stress resulted in the negative strain signifying strain was approaching tensile state where compressive strain is taken to be positive the results are numerically presented in fig 5 increase in the confining stress shifts the differential stress curve to the left indicating closure of narrow pore space as well as elongation in the axial direction for finite deformation in a lagrangian framework there is bound to be mesh distortion during simulation we implemented an automatic mesh nonlinear adaptivity in the model to handle this problem 5 1 primary drainage initial conditions were applied before drainage simulations commenced fluid computational domain was entirely saturated with wetting phase oil injection began after 14 of the pore space was filled with non wetting phase from the inlet as shown in fig 3 a oil non wetting phase and water wetting phase were used in the simulations due to the similar nature of the fluid simulation results only results for three cases are presented in this paper namely case a case b and case c case a corresponds to the undeformed pore configuration while cases b and c are the pore configurations deformed by 2 5 mpa and 10 mpa confining stresses respectively the fluid properties for these cases are seen in tables 2 and 3 drainage results are presented in fig 6 as observed in the figure oil is able to displace water when its pressure exceeds the threshold capillary pressure of the system different flow rates are used at specified locations during the simulation to enhance the computational efficiency and to ensure that there was no backflow in the system some pore spots were randomly selected to observe the extent of nonlinear deformation and the corresponding fluid distribution increase in compressive stress as indicated in fig 7 leads to the bridging of some pores and closure of pore spaces in other sections the level of closure depends on the local structural property of the adjacent grain grid cells as observed from fig 7 g i consolidation of disconnected pores eventually aids in reconnecting isolated pores hence improving the local hydraulic conductivity of the porous medium a concept we term stress initiated fluid flow in fig 7 a c there is a reduction in the pore volume resulting from the compressive action on the solid matrix furthermore the results indicate a propagated pore closure due to grain movement in the loading direction relative permeability is equally affected by increase in confining stress the path for the mobilization of fluid phases is inhibited due to pore closure along the axis of the stress application both fluids cannot gain access to previously accessible pore spaces due to reduction in their effective permeabilities and absolute permeabilities as such relative permeabilities of the fluids are reduced as well this trend is illustrated in fig 8 after drainage was completed initial water saturation swi was attained see table 4 this value was determined during the simulation when the oil saturation became invariant indicating no more water could be displaced it can be observed that increase in the confining stress results in an increase in swi when no stress was applied swi was at a value of 13 8 after a confining stress of 10 mpa was applied swi increased to 19 56 similar trend has been observed ali et al 1987 this phenomenon is due to compaction of the solid grains causing a general shift in the pore throat diameter distribution towards smaller values this leads to redistribution of the wetting phase occupying more pore throats additionally it is worth mentioning that the time it took to reach swi varied among the three cases for case c it took almost 34 longer to reach swi compared to case b and about 10 longer for case b compared to case a the effect of confining stress on the average velocity distribution can be seen in fig 9 the figure shows the velocity distribution during the drainage process the average velocity at zero stress condition was 0 26 µm s while the average velocity at 10 mpa confining pressure was 0 12 µm s 5 2 imbibition primary drainage was evaluated up to swi thereafter a series of waterflooding simulations were carried out on the sample fig 10 indicates the imbibition results fluid occupancy at the end of drainage is indicated in fig 10 a for case a while fig 10 d and g are for cases b and c respectively low sweep efficiency occurred when water was imbibed spontaneously inlet water velocity v f i n was zero water was only able to displace 3 5 of the non wetting phase and thereafter no more oil was produced v f i n was eventually increased to 0 005 m s to enhance the displacement efficiency for all cases the inlet side of the sample lost more oil than the outlet this is indicative of a small capillary end effect which is expected for low capillary numbers in the simulation the results after 110 s of the simulation for case a b and c are seen in fig 10 b e and h respectively at the end of the imbibition process residual oil saturation sor was established the sor value for case a was 13 65 while cases b and c had values of 16 99 and 17 58 this indicates that sor increased with increasing confining stress trapped oil globules at the end of imbibition are seen in fig 11 for all cases 5 2 1 oil cluster distribution the distribution and configuration of the oil in the pore space and its evolution during imbibition can be further characterized via the oil cluster size distribution this section is dedicated for investigating the effect of confining stress on oil globules the simulation results were collectively extracted as point clouds after simulation and were segmented into individual clusters by means of euclidean segmentation this was achieved by the use of a three dimensional grid of the pore space built with fixed width boxes kdtree structure was used for finding and organizing the nearest neighbor points in space cluster sizes were eventually obtained by voxel counting of the segmented point cloud in image form and binned to have an approximately similar counting statistics in each bin over the whole range fig 12 summarizes the results of the segmentation clusters in fig 12 a have a size distribution ranging from 147 9 to 1 26 104 µm3 with a count of 55 while fig 12 c ranged from 137 to 1 32 104 µm3 with a count of 81 the generated clusters were quantified based on the stress path across the medium and hence are used for illustrating how the confining stress affects oil entrapment residual trapping of the non wetting phase is seen to be a function of confining stress we have a greater distribution of disconnected oil globules under higher stress conditions as a result of oil being forced across the narrow pore configurations created during compaction compared to a smaller distribution of clusters at zero stress conditions fig 12 a finally as described earlier the solutions of both the fluid and solid equations are based on a decoupled framework and hence a study of the effect of the triaxial stress in real time is not possible in future studies we propose a two way or strongly coupled system based on aitkens relaxation and interface quasi newton inverse least square iqn ils algorithm by which the effect of external loading on a porous medium containing multiple fluid phases can be studied at the pore scale effectively 6 summary in this work a quasi static triaxial load was applied on a digital sandstone medium obtained from x ray micro ct imaging to investigate the effects of stress on fluid distributions and permeability on realistic pore geometries the solid was modeled as a hyperelastic material while the fluids were assumed to be incompressible and newtonian volume of fluid vof method was used for solving the multiphase flow equation by advecting a scalar that represents the volume fraction of the fluid a series of primary drainage and imbibition simulations were carried out on the sample to investigate the effect of triaxial stress on flow properties from our results we were able to establish that increase in compressive stress enhances bridging of pores in some locations as well as the closure of pore spaces in other sites the level of closure depends on the local structural property of the adjacent grain grid cells stress initiated fluid flow occurred for isolated pores that were reconnected relative permeability of the oil phase reduced due to restriction of the oil path however the relative permeability of water was not affected greatly furthermore the rock exhibited some tensile behavior as the confining stress increased initial water saturation was also observed to increase due to compaction of the solid grains causing a general shift in the pore throat diameter distribution towards smaller values this led to an overall redistribution of the wetting phase occupying more pore throats finally after imbibition there was a greater distribution of disconnected oil globules under higher stress conditions as a result of oil being forced across the narrow pore configurations created during compaction compared to a smaller distribution of clusters at zero stress conditions acknowledgments we greatly acknowledge the financial support of thermo fisher scientific hess corporation and the university of wyoming supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 10 018 appendix supplementary materials image application 1 
731,in reality most of the fluid and rock interactions occur in the presence of multiple fluid phases such exchanges thus are very important when different fluids under the influence of external forces coexist in the pore space in this work the response of berea sandstone under quasi static loading conditions is modeled in the presence of multiple fluid phases the solid matrix is characterized by hyperelasticity while the fluids are assumed to be incompressible and newtonian the behavior of the sample was investigated during the exertion of confining stresses at the grain boundaries followed by a sequence of drainage and imbibition cycles using the volume of fluid vof method to investigate the effect of triaxial loading on fluid distribution we further investigated the role of stress on relative permeability initial water saturation residual oil saturation and trapped oil globule size distribution our results indicate relative permeability alteration due to compaction and changes in the pore geometry relative permeability of the oil phase during drainage was reduced while there was a slight decrease in relative permeability of water furthermore the initial water saturation increased due to a general shift in the pore throat diameter distribution towards smaller values leading to the wetting phase occupying more pore throats finally higher confining stress conditions resulted in a greater distribution of disconnected oil globules compared to a smaller distribution of globules at zero stress conditions keywords volume of fluid fluid solid interface non linear hyperelastic deformation nomenclature symbol definition eij green strain tensor δ ij kronecker delta fij deformation gradient sij second piola kirchhoff stress tensor u i j lagrangian displacement σ ij cauchy stress tensor j jacobian w strain density function cijkl compliance matrix c i j k l tangent modulus tensor vf divergence free velocity nca capillary number z datum or reference point q volume flow rate of fluid s fluid saturation α indicator function k effective permeability κ interface curvature parameter definition kro relative permeability of oil krw relative permeability of water ξ interfacial tension µ fluid dynamic viscosity vd superficial velocity ρ fluid density ρ1 density of the reference fluid ρ2 density of the secondary fluid µ1 viscosity of the reference fluid µ2 viscosity of the secondary fluid subscripts w wetting phase nw non wetting phase i j k l indices 1 introduction the mechanical and structural behavior of a rock may be influenced by many competing factors such as porosity mineralogy pore fluids and confining pressure baud et al 2000 mair et al 2002 scott and nielsen 1991 tahmasebi 2018a b fluid flow through porous media can be equally affected by induced stresses from external load or a change in internal pressure alteration in fluid pressure gradient in berea sandstone sample has been attributed to prevalent uniaxial stress conditions fagbemi et al 2018 research has also shown that external stress alters absolute permeability berryman 1992 davies et al 1999 davies and davies 1999 dong et al 2010 fagbemi et al 2018 holt 1990 mclatchie et al 1957 wei et al 1986 zhang and tahmasebi 2018 at the subsurface rocks are continually under the influence of traction along their respective boundaries owing to plate tectonic driving forces gravitation loading and other external forces resulting from human activities e g fluid extraction injection and mining anderson 1951 terzaghi 1923 such local perturbations both natural and manmade induce large and small scale stresses which eventually result in deformation of rock masses that in turn lead to changes in rock and flow properties therefore rigorous characterization and modeling of subsurface conditions require interlinking of physical processes such as hydro thermal and mechanical processes at the pore scale single phase numerical simulations at pore scale have helped to enhance the development of macroscopic models and constitutive relationships which have led to robust descriptions of coupled flow through porous media coupled multiphase flow modeling on the other hand has not been thoroughly investigated multiphase flow modeling is very important for most subsurface applications especially in complex fluid fluid systems such as gas water oil water and gas oil or even a three phase flow scenario of gas oil water modeling of such systems involve solving certain transport equations which require sophisticated computational fluid dynamics tools in order to have a general understanding of the interaction between multiphase flow and solid mechanics we present a decoupled framework in this paper i e we assume the fluid forces inducing solid deformation are negligible at this scale of investigation as a result the grains deform under quasi static loading based on hyperelastic constitutive behavior and then multiphase flow simulations are carried out on the deformed sample different lagrangian and eulerian computational approaches for modeling multiphase flow at fine scale have been indicated in the literature front tracking method tryggvason et al 2001 van sint annaland et al 2006 which is lagrangian in nature based on discrete phase model dpm is one of the preliminary methods this technique requires mesh cell movement with the continuous medium such a method is unstable for porous media applications due to oscillations which could occur at the fluid fluid interface if the indicators move independently off each other another approach that has gained a lot of attention is the continuous phase model which is an eulerian approach some examples include the volume of fluid method vof hirt and nichols 1981 mixture models wang and cheng 1996 and interface tracking methods such as level set olsson and kreiss 2005 and the phase field method badalassi et al 2003 jacqmin 1999 the interface tracking methods model the flow of two different immiscible fluids separated by a clearly defined interface in the phase field and level set methods the fluid s interface is tracked using a color function on a fixed mesh this function is tracked by solving additional transport equations the mixture model is typically used for simulating dispersed phases it solves one set of navier stokes equations for the momentum of the mixture a mixture averaged continuity equation and a transport equation for the volume fraction of the dispersed phase in the volume of fluid method vof the volume fraction is tracked instead of the phase interface as a result it provides a clear picture of the velocity and pressure fields of a reference fluid as well as the interfacial tension force for pore scale fluid flow it requires the solution of one navier stokes equation along with advection of an indicator function based on divergence free velocity hence it is reliable stable and more computationally efficient than other eulerian methods in this work a filtered and segmented voxel based berea solid geometry is meshed using tetrahedral grid elements and then solved for non linear elastic deformation based on external forces acting on the outer boundaries this is achieved using the finite element method fem we then apply the vof method to track the volume fraction of the multiphase system and compute the occupancy of the reference and the secondary phase based on the indicator function spatial and temporal domains for the fluid are discretized using finite volume technique vof is deemed appropriate for this work because it has been used to successfully to model drainage in micromodels such as sphere pack geometries ferrari and lunati 2013 two phase flow in tubes gupta et al 2009 and trickling effect in reactors in an array of tubes horgue et al 2013 rohan and lukeš 2015 this work is arranged as follows we briefly introduce preprocessing of the fluid and solid domains the hyperelastic constitutive model for the solid matrix is then explained the direct approach for the flow equations which is based on vof at the pore scale is described all simulations are carried out under capillary dominated regimes additionally we briefly discuss the microscopic terms used in obtaining their upscaled macroscopic equivalents finally we examine how these fluid properties are affected by quasi static triaxial loading 2 computational domain as stated earlier we intend to examine the effect of nonlinear deformation on fluid flow processes in porous media the geometry used for stress and fluid simulations was constructed based on images from micro ct scans berea sandstone was imaged at a resolution of 1 5 µm the dry image was then carefully filtered to eliminate noise followed by segmentation to separate solid and fluid phases the extracted solid domain was eventually smoothened by averaging the existing weights and finally tetrahedral grids were generated using avizo fire important properties of the utilized 3d image are highlighted in table 1 and the berea sample used in this study can be seen in fig 1 this sample represents only one scenario for the existing rock samples for quantifying the uncertainty and variation in terms of pore morphology several other samples can be generated computationally karimpouli and tahmasebi 2016 tahmasebi et al 2017a b this topic however is not investigated in this paper 2 1 non linear elastic solid model in order to properly model subsurface grain compaction we implement a hyperelastic constitutive model that accounts for non linear deformation of the rock sample the material is subjected to quasi static load under triaxial conditions considering that the deformation is elastic it is not accompanied by energy dissipation einav and nguyen 2009 hence we can apply large initial strains on the material and study how multiphase flow properties are affected we explicitly present a non linear model of the stress strain behavior of the berea sandstone under different confining stress conditions the rock used in this work is a high permeability sandstone with a porosity of 25 05 rocks of this nature are commonly known to exhibit low to medium compressive strength and are therefore subject to large strains 2 1 1 governing equations solid matrix in general linear elasticity is not sufficient for modeling the constitutive behavior of berea sandstone due to the presence of pore and grain contacts in the elastic porous material these pore grain contacts have been known in literature to introduce non linearity bernabé et al 1994 khan et al 1991 consequently the elastic portion of the stress strain cycle for berea sandstone is going to be highly nonlinear as such hyperelastic equations are applied for modeling the non linear behavior of the solid matrix generally hyperelastic materials are characterized by the existence of strain or stored energy potential which is a function of finite strain this strain energy function w is defined as the energy stored in the rock material per unit reference volume or the work required per unit initial material volume to reach the strain state for the hyperelastic or green elastic material the model accounts for finite strains and hence we define the material strain using the green lagrangian strain tensor the green strain tensor is given by 1 e i j 1 2 f k i f k j δ i j where f is the deformation gradient and δ ij is the kronecker delta function in terms of lagrangian displacements eq 1 can be expressed as 2 e i j 1 2 u i j u j i u k i u k j the strain relationship can then be defined as 3 s i j c i j k l e k l the corresponding strain rate is given by eq 4 4 s i j c i j k l e k l where c i j k l represents the tangent modulus tensor and s is the conjugate stress rate and e the strain rate for a material where c i j k l c i j k l we can define a potential function as w if the potential function depends on the green strain tensor the second piola kirchhoff stress is given as 5 s i j w e i j for stress applications in rocks soils that have complex heterogeneous behavior and medium compressive strength we apply the saint venant kirchhoff model which extends the linear elastic material model to the nonlinear regime for compressible materials 6 s i j λ e k k δ i j 2 μ s e i j where λ and µ s are the lame constants the following strain energy function used for the model is given by eq 7 7 w e λ 2 e k k 2 μ s e i j e i j sij from eq 6 can be expressed in the form of the cauchy stress tensor by 8 σ i j f r i s i j f k j j 1 3 two phase flow simulation in the last ten years direct methods have been gaining more attention and considered as a suitable alternative for carrying out pore scale simulations in that interfacial tension viscous and capillary forces can be easily incorporated into the model while preserving the pore space geometry hence we examine the numerical method for solving two phase incompressible and isothermal flow equation directly from a finite volume mesh discretization is achieved with respect to the spatial and temporal domains 3 1 fluid equations direct simulation of multiphase flow requires that mass momentum and energy are conserved in the control volume assuming isothermal conditions and that the fluid is located in a non rotating frame of reference mass is conserved for the incompressible fluid by the continuity equation 9 v i x i 0 for momentum conservation 10 ρ v i t v j v i x j p x i μ v i j j ρ f i where vi represents the pore velocity p is the fluid pressure µ denotes the dynamic viscosity of the fluid ρ is the density and f is the body force eqs 9 and 10 are referred to as the incompressible navier stokes equations for an isothermal system at the pore scale the momentum balance equation for incompressible fluids is used to relate the density of the fluid fluid shear stresses interfacial or pore scale velocity pressure gradient and the external forces surface and body forces knowing the pressure gradient together with capillary and gravity forces the momentum balance equation can be used to update the velocity field at any time step in order to incorporate more fluid phases into the system we apply an indicator or color function by the following equation 11 α i t α i v f 0 where vf is the divergence free velocity obtained from the solution of eqs 9 and 10 α i is the scalar indicator function that is solved by a pure advection the color function represents the fraction of the computational grid occupied by one phase it results in 1 for the reference phase and 0 for the secondary phase properties of multiphase mixtures are given by a summation of each of the components densities and viscosities 12 ρ i 1 n α i ρ i 13 μ i 1 n α i μ i where n is the number of phases for the two phase vof system the average fluid density and viscosity are given by 14 ρ α ρ 1 1 α ρ 2 15 μ α μ 1 1 α μ 2 the vof is used to solve eq 11 the equation is advected with an explicit lagrangian advection method using the fluid velocity and the normal vector at the fluid fluid interface one advantage of the vof method is that it does not have to solve several navier stokes equations for each phase each of the fluid phases in the simulation is accounted for by the indicator function interfacial tension is represented in the vof model to account for in contact fluids interaction interfacial energy present between the residing fluids results from the inward attraction of the molecules of each phase modeling this interfacial phenomenon in our system is achieved by the continuum surface force csf developed by brackbill et al 1992 the csf model includes a volume force that yields a surface force when the thickness of the interface is infinitely small it is important to note that interfacial tension acts only at the interface therefore entering only in the boundary conditions thus it is implemented as a body force within the navier stokes equation by including eq 16 16 f s f σ κ n s δ s where fsf is the interfacial force term δ s is the surface delta function and κ represents the curvature of the surface given by 17 κ α α this form of equation requires a constant interfacial tension the momentum equation or pressure velocity coupled system is solved using the pressure implicit splitting of operators piso algorithm by issa 1986 a summary of the piso loop is presented in the dashed box in fig 2 in the piso loop the momentum equation is solved first the exact pressure gradient source term is not known at the beginning of the simulation the pressure field from the previous time step is then used to provide an approximation of the new velocity field these are referred to as predicted velocities the predicted velocities can then be used to reformulate the new pressure equation the solution of the pressure equation gives the first estimate of the new pressure field this step is called the pressure solution velocity correction is then carried out in an explicit manner 3 2 macroscopic properties of fluid pore scale multiphase simulations using direct numerical simulation dns methods focus on modeling velocity distributions and hydraulic gradients locally however the needed quantities to explicitly model the flow in porous media are macroscopic in nature although carrying out direct numerical simulation on the entire continuum grid might produce a nearly perfect description of flow conditions at large scale employing extremely fine spatial discretization would require massive computer memory and hence not feasible the approach to tackle this problem is to select a sub volume domain that represents the properties of the porous media and can produce an aggregate response for a sample to be considered representative it must be comprised of significant amount of heterogeneities microscopic fluid properties can then be averaged over the representative volume to obtain the equivalent velocity or pressure in darcy i e macroscopic scale in order to obtain the absolute permeability of the sample we upscale under the assumption that the flow is laminar and the effect of momentum transfer within the fluid is negligible compared to drag forces at the fluid grain interface we can therefore obtain the influx of fluid through a cross section in terms of hydraulic gradient by darcy s law for a two phase flow system with water and oil the volume flow rates of each of the fluids can be given in terms of kw and knw which represent the effective permeability of the wetting and non wetting phases respectively and are defined using 18a q w k w s w μ w p w ρ w g z 18b q n w k n w s n w μ n w p n w ρ n w g z 3 3 relative permeability for multiphase flow in porous media the fluids will experience a reduction in conductivity due to fluid fluid and fluid solid interactions as well as the fact that they share the same pore space these effects can be represented using relative permeability concept two experimental approaches that are available for obtaining the relative permeability are the steady state avraam and payatakes 1995 and unsteady state methods sarem 1966 steady state technique involves simultaneous flow of two phases at different flow rates until steady state conditions are established while for the unsteady state one phase displaces the other similarly by using direct computational methods one can mirror these experimental procedures silin et al 2009 computed relative permeabilites when the fluids were assumed to be in equilibrium saturation maps were used and one phase is assumed to be static while the effective permeability of the other phase was computed by utilizing similar boundary conditions at solid fluid interface another approach is presented by raeini et al 2014 to compute the relative permeability by considering the rate of dissipation of microscopic forces i e pressure and viscous forces per unit flow rate for the system in essence the macroscopic pressure drop across a porous medium is attributed to the dissipation fluid forces at pore scale we apply the later computational approach for computing the pressure drop across the system then we systematically average the velocities of the both phases the relative permeability is then obtained by computing the ratio of the flow rate of reference fluid per unit macroscopic pressure drop to the flow rate per unit macroscopic pressure drop of the equivalent single phase event 4 computations investigation of the effects of triaxial loading on injected fluid behavior requires a sequence of drainage oil displacing water and imbibition water displacing oil simulations to be carried out the porous media geometry was obtained from micro ct imaging with a volume of 850 µm3 and average equivalent grain size diameter of 191 366 µm thereafter tetrahedral meshes were generated using cad based meshing techniques due to the large size of the computational domain we carried out grid coarsening by the use of gaussian pyramid algorithm this effectively helped reduce the image size by half to 424 425 µm3 while still maintaining the image s complexity and heterogeneity compressive forces were applied on the external grain wall boundaries while applying a fixed constraint boundary condition on the bottom boundary to ensure stress continuity across the solid domain the confining stresses used in this study were 1 mpa 2 5 mpa 5 0 mpa and 10 mpa 4 1 primary drainage simulations fluid domains were extracted from the deformed solid domains by inversion fluid meshes were iteratively castellated and eventually snapped onto their respective surfaces based on specified criteria the non wetting phase oil was injected into the pore domain at a constant uniform velocity v f i n at the inlet while maintaining a constant pressure p out at the outlet the walls were defined as no flow boundaries the densities of the wetting and non wetting phases were kept constant multiphase simulations began with the wetting phase occupying the entire computational fluid domain prior to the injection of non wetting phase 14 of the pore volume was initialized with oil at the inlet boundary for the undeformed configuration and 12 5 for the deformed medium to account for the reduction in pore volume during loading a dynamic contact angle of 0 was prescribed at the inlet because only water was present at the beginning of the simulations and oil had not yet began to displace water a constant contact angle of 45 between the grain walls and the fluid fluid interface was enforced to prevent change in wettability during simulations the drainage simulations continued until one pore volume of the non wetting phase was injected gravity forces were assumed to be insignificant due to the small scale of the work and the horizontal nature of the flow flow conditions were characterized by three dimensionless numbers namely the capillary number nca viscosity ratio m and reynolds number re the capillary number was used to monitor the flow condition the capillary number represents the ratio of viscous to capillary forces it is expressed as 19 n c a μ v d ξ where ξ is the interfacial tension and vd is the superficial velocity and µ is the viscosity of the displacing phase typical values for flow in a reservoir are in the range 10 8 nca 10 6 guo et al 2015 each of the flow simulations were carried out under capillary dominated flow regime to achieve this drainage process was carried out at slow rates thereby rendering the effects of viscous forces nearly insignificant we ensured a stable displacement front by using a viscosity ratio m µ nw µ w greater than 1 for the simulations high values of m imply that the invading fluid is more viscous than the defending phase leading to a stable front similarly a combination of low nca and low m 1 results in capillary fingering while high nca and very low m 1 leads to viscous fingering regime multiphase flow is also affected by the macroscopic capillary pressure which can be determined by the difference between the pressure at the inlet of the displacing fluid phase and the pressure at the outlet of the defending fluid for a comprehensive study of this subject the reader is referred to ferrari and lunati 2013 5 results and discussion a series of triaxial compression tests were carried out on the solid using hydrostatic loads of 1 mpa 2 5 mpa 5 mpa and 10 mpa the fluid distribution and permeability after non linear solid deformation were investigated high performance computing was used in carrying out flow simulations on a hybrid cpu gpu supercomputing cluster boasting a total of 4560 computing cores the supercomputer is powered by intel xeon cpus with nvidia tesla k20x gpus for accelerating the computations 9 nodes were used in this work each with 20 cores making a total of 180 cores quasi static loading was applied normal to the free boundaries while fixed boundary condition was imposed on the bottom plane for each loading scenario the vertical stress was held constant while confining stresses were systematically increased during the simulation porosity reduction occurred as compressive forces were increased as seen in table 3 porosity reduced from the original state of 0 250575 to 0 250561 when 10 mpa of stress was applied fig 4 indicates a three dimensional 3d evolution of axial strain at two different compressive states the non linear pore grain interfaces appear to be impacted the most by the stresses in the axial direction it should be noted that the young s modulus of berea increased as more confining stress was applied the rock alters its elastic properties in response to hydrostatic stresses by becoming more rigid additionally increase in confining stress resulted in the negative strain signifying strain was approaching tensile state where compressive strain is taken to be positive the results are numerically presented in fig 5 increase in the confining stress shifts the differential stress curve to the left indicating closure of narrow pore space as well as elongation in the axial direction for finite deformation in a lagrangian framework there is bound to be mesh distortion during simulation we implemented an automatic mesh nonlinear adaptivity in the model to handle this problem 5 1 primary drainage initial conditions were applied before drainage simulations commenced fluid computational domain was entirely saturated with wetting phase oil injection began after 14 of the pore space was filled with non wetting phase from the inlet as shown in fig 3 a oil non wetting phase and water wetting phase were used in the simulations due to the similar nature of the fluid simulation results only results for three cases are presented in this paper namely case a case b and case c case a corresponds to the undeformed pore configuration while cases b and c are the pore configurations deformed by 2 5 mpa and 10 mpa confining stresses respectively the fluid properties for these cases are seen in tables 2 and 3 drainage results are presented in fig 6 as observed in the figure oil is able to displace water when its pressure exceeds the threshold capillary pressure of the system different flow rates are used at specified locations during the simulation to enhance the computational efficiency and to ensure that there was no backflow in the system some pore spots were randomly selected to observe the extent of nonlinear deformation and the corresponding fluid distribution increase in compressive stress as indicated in fig 7 leads to the bridging of some pores and closure of pore spaces in other sections the level of closure depends on the local structural property of the adjacent grain grid cells as observed from fig 7 g i consolidation of disconnected pores eventually aids in reconnecting isolated pores hence improving the local hydraulic conductivity of the porous medium a concept we term stress initiated fluid flow in fig 7 a c there is a reduction in the pore volume resulting from the compressive action on the solid matrix furthermore the results indicate a propagated pore closure due to grain movement in the loading direction relative permeability is equally affected by increase in confining stress the path for the mobilization of fluid phases is inhibited due to pore closure along the axis of the stress application both fluids cannot gain access to previously accessible pore spaces due to reduction in their effective permeabilities and absolute permeabilities as such relative permeabilities of the fluids are reduced as well this trend is illustrated in fig 8 after drainage was completed initial water saturation swi was attained see table 4 this value was determined during the simulation when the oil saturation became invariant indicating no more water could be displaced it can be observed that increase in the confining stress results in an increase in swi when no stress was applied swi was at a value of 13 8 after a confining stress of 10 mpa was applied swi increased to 19 56 similar trend has been observed ali et al 1987 this phenomenon is due to compaction of the solid grains causing a general shift in the pore throat diameter distribution towards smaller values this leads to redistribution of the wetting phase occupying more pore throats additionally it is worth mentioning that the time it took to reach swi varied among the three cases for case c it took almost 34 longer to reach swi compared to case b and about 10 longer for case b compared to case a the effect of confining stress on the average velocity distribution can be seen in fig 9 the figure shows the velocity distribution during the drainage process the average velocity at zero stress condition was 0 26 µm s while the average velocity at 10 mpa confining pressure was 0 12 µm s 5 2 imbibition primary drainage was evaluated up to swi thereafter a series of waterflooding simulations were carried out on the sample fig 10 indicates the imbibition results fluid occupancy at the end of drainage is indicated in fig 10 a for case a while fig 10 d and g are for cases b and c respectively low sweep efficiency occurred when water was imbibed spontaneously inlet water velocity v f i n was zero water was only able to displace 3 5 of the non wetting phase and thereafter no more oil was produced v f i n was eventually increased to 0 005 m s to enhance the displacement efficiency for all cases the inlet side of the sample lost more oil than the outlet this is indicative of a small capillary end effect which is expected for low capillary numbers in the simulation the results after 110 s of the simulation for case a b and c are seen in fig 10 b e and h respectively at the end of the imbibition process residual oil saturation sor was established the sor value for case a was 13 65 while cases b and c had values of 16 99 and 17 58 this indicates that sor increased with increasing confining stress trapped oil globules at the end of imbibition are seen in fig 11 for all cases 5 2 1 oil cluster distribution the distribution and configuration of the oil in the pore space and its evolution during imbibition can be further characterized via the oil cluster size distribution this section is dedicated for investigating the effect of confining stress on oil globules the simulation results were collectively extracted as point clouds after simulation and were segmented into individual clusters by means of euclidean segmentation this was achieved by the use of a three dimensional grid of the pore space built with fixed width boxes kdtree structure was used for finding and organizing the nearest neighbor points in space cluster sizes were eventually obtained by voxel counting of the segmented point cloud in image form and binned to have an approximately similar counting statistics in each bin over the whole range fig 12 summarizes the results of the segmentation clusters in fig 12 a have a size distribution ranging from 147 9 to 1 26 104 µm3 with a count of 55 while fig 12 c ranged from 137 to 1 32 104 µm3 with a count of 81 the generated clusters were quantified based on the stress path across the medium and hence are used for illustrating how the confining stress affects oil entrapment residual trapping of the non wetting phase is seen to be a function of confining stress we have a greater distribution of disconnected oil globules under higher stress conditions as a result of oil being forced across the narrow pore configurations created during compaction compared to a smaller distribution of clusters at zero stress conditions fig 12 a finally as described earlier the solutions of both the fluid and solid equations are based on a decoupled framework and hence a study of the effect of the triaxial stress in real time is not possible in future studies we propose a two way or strongly coupled system based on aitkens relaxation and interface quasi newton inverse least square iqn ils algorithm by which the effect of external loading on a porous medium containing multiple fluid phases can be studied at the pore scale effectively 6 summary in this work a quasi static triaxial load was applied on a digital sandstone medium obtained from x ray micro ct imaging to investigate the effects of stress on fluid distributions and permeability on realistic pore geometries the solid was modeled as a hyperelastic material while the fluids were assumed to be incompressible and newtonian volume of fluid vof method was used for solving the multiphase flow equation by advecting a scalar that represents the volume fraction of the fluid a series of primary drainage and imbibition simulations were carried out on the sample to investigate the effect of triaxial stress on flow properties from our results we were able to establish that increase in compressive stress enhances bridging of pores in some locations as well as the closure of pore spaces in other sites the level of closure depends on the local structural property of the adjacent grain grid cells stress initiated fluid flow occurred for isolated pores that were reconnected relative permeability of the oil phase reduced due to restriction of the oil path however the relative permeability of water was not affected greatly furthermore the rock exhibited some tensile behavior as the confining stress increased initial water saturation was also observed to increase due to compaction of the solid grains causing a general shift in the pore throat diameter distribution towards smaller values this led to an overall redistribution of the wetting phase occupying more pore throats finally after imbibition there was a greater distribution of disconnected oil globules under higher stress conditions as a result of oil being forced across the narrow pore configurations created during compaction compared to a smaller distribution of clusters at zero stress conditions acknowledgments we greatly acknowledge the financial support of thermo fisher scientific hess corporation and the university of wyoming supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 10 018 appendix supplementary materials image application 1 
732,the large number of dammed rivers worldwide emphasizes the need to couple models of natural processes with models describing human behaviors however such behavioral models are often simplistic and lack proper validation against observational data in this work we contribute a new approach to infer the typical operations of water reservoirs from historical observations using data driven behavioral modeling based on eigenbehavior analysis the approach is demonstrated using monthly storage data from 172 reservoirs in california usa results show that the proposed method identifies four typical behavioral profiles which are strongly linked to key features of the reservoirs moreover we show how the identified models can be used for discovering behavioral profiles and associated reservoir characteristics that are vulnerable to drought conditions keywords behavioral modeling data driven modeling water reservoir operations drought management data mining 1 introduction existing dams control approximately 46 of large rivers worldwide i e rivers with average flows above 1000 m3 s with a cumulative storage capacity of about 8000 km3 lehner et al 2011 these figures are expected to grow in the future driven by the renewed interest in dams as a primary means to secure water and energy particularly in rapidly developing african and asian countries world bank 2009 zarfl et al 2014 this tendency will further increase the number of river systems in which flow dynamics are not only determined by their natural streamflow regime botter et al 2010 but are also strongly influenced by human decisions hanasaki et al 2006 however the role of human decisions has been generally overlooked in the water resources systems modeling literature sivapalan and blöschl 2015 which for many years focused on improving our understanding of natural processes e g dooge 1959 mulvaney 1851 today this unilateral perspective might no longer be adequate thompson et al 2013 motivating the emergence of a number of conceptual frameworks including coupled human natural systems liu et al 2007 coupled environmental human systems horan et al 2011 socio hydrology sivapalan et al 2012 and socio environmental systems filatova et al 2016 with the shared goal of better describing both the natural and the human components of water systems while mathematical models of natural processes are rigorously developed at fine spatial scales e g hundreds of meters and temporal scales e g hourly models describing human behavior are often quite simplistic wada et al 2017 we can broadly distinguish two main categories smith 1991 namely descriptive models which represent the decision mechanism e g camerer et al 2011 and normative models which focus on goal oriented actions e g becker 1978 descriptive models mainly developed in cognitive psychology and the social sciences derive behavioral rules specifying human actions in response to external stimuli however because the detailed data to create such descriptive models have only recently become available sanderson et al 2002 they often rely on general theories and lack a rigorous validation against observational data ligtenberg et al 2010 conversely normative models originally developed in economics assume fully rational behaviors and provide optimal decisions that maximize a given utility function this second approach has been largely adopted in water resources planning and management applications e g loucks et al 2005 poff et al 2015 but the resulting optimal decisions often do not match observed behaviors simon 1957 this has challenged the uptake of normative decision support systems in real world operational contexts labadie 2004 newman et al 2017 simonovic 1992 today an unprecedented torrent of information economist 2011 produced by pervasive sensor networks e g hart and martinez 2006 mccabe et al 2017 remote sensing e g lettenmaier et al 2015 zhang et al 2016 and crowdsourcing e g giuliani et al 2016a michelsen et al 2016 combined with the advances in data analytics and machine learning watt et al 2016 creates new possibilities for constructing accurate behavioral models based on observational data the idea of inferring a behavioral model of a reservoir operator from historical data has been explored in a few previous studies with multiple goals deriving operational rules via regression techniques barbagallo et al 2006 bessler et al 2003 shrestha et al 1996 yang et al 2016 exploring which sources of hydrologic information condition reservoir releases hejazi et al 2008 yang et al 2016 and formulating candidate objective functions to explain the observed behavior howitt et al 2005 mason et al 2018 building on these studies this paper introduces a novel data driven behavioral modeling approach to mine typical behaviors of water reservoir operators from historical observations using eigenbehavior analysis eigenbehavior analysis was originally proposed by eagle and pentland 2009 for identifying behavioral routines in the location data of 100 individuals monitored via smartphone communications and was recently adopted by cominola et al 2018 to analyze residential water energy demand profiles here we extend this approach to characterize typical operating strategies across a large set of water reservoirs these typical operating strategies are obtained through the extraction of principal components from behavioral data to obtain a set of vectors called eigenbehaviors spanning the behavioral space of the monitored operators specifically the principal components are computed as the eigenvectors of the covariance matrix of the behavioral data where the vectors associated with high loadings represent a type of recurrent behavior i e a behavioral profile we then cluster the individuals reservoir operators on the basis of their corresponding behavioral profiles this segmentation process is finally verified a posteriori by relating the clustered profiles to specific features of the reservoirs location elevation and capacity we demonstrate the potential of our modeling approach using data from 172 water reservoirs in california which are described by historical trajectories of monthly storage volume obtained from the california data exchange center http cdec water ca gov as well as the reservoirs location elevation and capacity moreover we show how studying the discrepancies between observations and model outputs allows detecting anomalous circumstances when operators deviate from their typical behaviors due to external forcing in particular the quantification of these deviations during the recent california drought allows formulating a drought vulnerability risk index dvri that can be used for discovering behavioral profiles and associated features of the reservoirs that are most vulnerable to severe drought conditions the rest of the paper is organized as follows the next section introduces the methodology followed by the description of the california reservoirs considered in this study results and discussion are reported in sections 4 and 5 while final remarks along with suggestions for further research are presented in the last section 2 material and methods 2 1 eigenbehavior analysis eigenbehavior analysis aims to identify typical behavioral profiles of reservoir operators via data mining of historical observational data specifically we consider time series of storage variation y t k with t 1 h where h is the length of the time series defined as 1 y t k s t k s t 1 k q t k r t k where s t k and s t 1 k are the storage of the reservoir k with k 1 r and r is the total number of reservoirs at the current and previous time step while q t k and r t k are the reservoir inflow and the regulated release during the time interval t 1 t considering the trajectory of storage variation yt allows isolating the human behavior that determines the regulated release rt in response to the hydrologic conditions represented by the inflow qt for the same value of inflows different behaviors will be captured by different values of yt looking only at the release trajectory could be misleading as two equivalent values of releases would suggest the same behavior but if those decisions are made with different values of storage inflows they should be identified as different behaviors it is also worth noticing that even in cases where the change in storage is dominated by inflows the change in storage still reflects an operational decision to store the inflows rather than release them our data driven behavioral modeling procedure is composed of four main steps as illustrated in fig 1 binary tranformation eigenbehavior extraction eigenbehavior clustering and eigenbehavior interpretation binary transformation the time series y t k of the kth reservoir is first rearranged into a matrix xk of dimension ny t where ny is the number of years of available observations and t is the annual period each row of xk hence corresponds to one year and each column to one day week or month depending on the temporal resolution of the data we then transform the matrix xk into a binary matrix γk where the observed values of storage variations are classified into one of a mutually exclusive actions e g drawdown stable or refill each row of γk contains n t a elements where the binary values of γk map the observations of xk into the corresponding action we can then identify average operations ψk of each reservoir i e the action usually performed in each period of the year defined as 2 ψ k 1 n y i 1 n y γ i k however the average operations ψk do not guarantee a good representation of the original behavioral data which often present a large variability around the average values eigenbehavior extraction this step is performed on the matrices γk constructed in the binary transformation step formally the eigenbehaviors are computed via principal component analysis pca a dimensionality reduction technique that searches for linear combinations of the original variables such that the coefficients of the output combinations the principal vectors form a low dimensional sub space defined by directions explaining maximal variance in the original data joliffe 2002 a few principal components generally explain a high percentage of the variance of the original variables ensuring dimension reduction in addition the representation of the original data in the projected space defined by principal components is uncorrelated thus providing a useful tool for physical and statistical interpretations pca is performed via eigenvalue decomposition of the covariance matrix q of γk i e 3 q 1 n y i 1 n y γ i k γ i k where the resulting eigenvectors w q k of q with q 1 n are the eigenbehaviors of the kth reservoir and allow mapping the original matrix γk into its principal components i e 4 ϱ q k γ k w q k with q 1 n eigenbehavior clustering after the extraction of the eigenbehaviors via pca the reservoirs are classified into different behavioral profiles based on their first few eigenvectors it is generally sufficient to consider only the first eigenvector w 1 k as it accounts for the most variance in the behavioral data for reservoir k quantified by the associated highest eigenvalue however highly variable datasets may require more eigenvectors to better capture the variance of the observed behavior our classification was run using an iterative implementation of t distributed stochastic neighbour embedding t sne maaten and hinton 2008 and k means clustering macqueen 1967 specifically the t sne method is used to select the number of clusters for the k means clustering t sne performs the dimensionality reduction and projects the eigenvectors w 1 k into two dimensional points to allow visual analysis of the separability of the k means clusters eigenbehavior interpretation lastly the behavioral profiles determined in the previous step are discussed with respect to the characteristics of the reservoirs belonging to each cluster to infer potential factors influencing the observed behaviors 2 2 drought vulnerability risk index the behavioral profiles identified via eigenbehavior analysis offer a means for analysing the reservoir operations during drought events with the goal of discovering behavioral profiles and associated reservoir features that are particularly vulnerable to severe drought conditions this analysis builds on the confusion matrix obtained by contrasting the observed storage variations and the ones modelled via eigenbehavior specifically we can count the number of drawdown false negatives i e observed drawdown months that the eigenbehavior model erroneously predicts as stable or refill this value normalized with respect to the total number of observations in the considered time period is expected to increase during drought episodes with respect to normal conditions the drought vulnerability risk index dvri can hence be defined as 5 d v r i δ d δ n where δd and δn are the number of drawdown false negatives during a drought and in normal conditions respectively vulnerable reservoirs will be characterized by values of dvri greater than one which capture episodes when operators likely did not adapt their policy and maintained normal release decisions despite decreasing inflow volumes such a strategy causes reservoir storage to decrease in months that under normal conditions would be operated to refill or maintain stable levels 3 study site the method is tested on a dataset of 172 reservoirs in california usa nearly all large rivers in california are dammed grantham et al 2014 and these reservoirs serve multiple important objectives including urban and agricultural water supply flood control and hydropower generation they are operated by a mix of local state and federal agencies during typical hydrologic years the largest state and federal reservoirs are operated for the primary purpose of storing snowmelt from the sierra nevada mountains for delivery to irrigation later in the year however they also play an important role in inter year operations during extreme conditions as observed during the recent drought these operating strategies will likely need to change in the future as some projections indicate long term decreases in water supply vicuna et al 2007 increases in the magnitude of flood events anderson et al 2007 and an increased rain fraction of winter storms due to rising temperatures stewart et al 2005 the dataset used in this work is drawn from the california data exchange center cdec http cdec water ca gov a few of the reservoirs included in the dataset are in nearby states nevada arizona oregon but are nevertheless connected to the california water supply network the dataset includes monthly storage time series for each reservoir from the earliest available month through december 2016 the shortest available record is 36 years beginning in 1980 the majority of reservoirs have records between 50 70 years the reservoir characteristics related to eigenbehavior clusters namely elevation and capacity were also drawn from cdec in cases where a capacity value was not available the maximum observed storage volume from the record was used instead reservoir locations and capacities are shown in fig 2 a while a histogram of record lengths is shown fig 2b three discrete modes of operation are considered for the eigenbehavior analysis drawdown stable and refill a month is classified as drawdown refill if the decrease increase of the storage with respect to previous month exceeds 5 it is worth mentioning that alternative thresholds could be considered in performing the binary transformation step e g a larger storage variation or a fixed percentage of the reservoir capacity our choice of using the 5 relative to the previous month is motivated by the need of capturing also unintended drawdown during drought periods 4 results 4 1 analysis of eigenbehaviors this section reports the analysis of the eigenbehaviors extracted from the monthly storage observations of the 172 california reservoirs as described in section 2 the analysis assigns a typical behavioral profile to each reservoir a behavioral profile is defined as an annual pattern of operating strategies that distinguishes periods of drawdown refill and stable level weighted by the values of the eigenbehavior loadings an illustrative example for folsom reservoir is reported in fig 3 where each row corresponds to a month each column to a different action i e drawdown refill and stable level and the color intensity is proportional to the magnitude of the eigenbehavior loadings with dark colors identifying recurrent actions in each month of the year the results show a marked drawdown period during the summer when the maximum agricultural demand occurs and the operator decides a release higher than the inflow and a refill period in early spring during the snowmelt period when the operator releases less water than the inflow for a single reservoir these results are not surprising however the potential of our analysis lies in classifying numerous reservoirs according to their extracted behavioral profiles fig 4 illustrates the variety of eigenbehaviors across the 172 reservoirs considered in this study each column of the matrix represents one reservoir with the color intensity proportional to the loadings of the first eigenbehavior as in fig 3 each eigenbehavior is subdivided into the three actions drawdown stable refill and each action has 12 coefficients one for each month of the year in this study we consider only the first eigenbehavior i e first principal component as it explains on average 58 of the variance in the original data while the second eigenbehavior only contributes an additional 8 the eigenbehaviors reported in fig 4 are clustered into four profiles p1 p4 separated by the magenta dashed lines according to similarities in the magnitude of loadings for example fig 4 shows that profile p2 includes reservoirs characterized by stable water levels throughout the year indicated by the dark pixels in the center of the figure possibly due to large storage capacity on the contrary profiles p1 and p4 have marked drawdown and refill periods represented by the dark pixels in late summer and early spring respectively profile p3 includes reservoirs with more variable operations showing less regular recurrent drawdown refill periods than p1 and p4 finally reservoirs associated with profile p4 start refilling before p1 possibly because these reservoirs are located in lower elevation basins than the ones classified in profile p1 the seasonal storage of high elevation reservoirs is mostly created by snowmelt while the winter rainfall becomes predominant at lower elevation where snow is not accumulating the clustering of the reservoirs produced four distinct behavioral profiles which can be modeled according to the loadings of the clusters centroids as reported in fig 5 this alternative visualization confirms and summarizes the characteristics of the four profiles identified in fig 4 in terms of the most recurrent action made in each month of the year represented by the line with the maximum loading value profiles p1 and p4 have frequent drawdown refill periods illustrated by the larger values of the orange and blue lines relative to the black one the major difference between p1 and p4 is the timing of the peak in the blue refill line reservoirs in profile p1 refill primarily in spring while those in profile p4 are able to refill in late winter profile p2 includes reservoirs with stable storage for the entire year as shown by the high values of the black line during all 12 months finally profile p3 is characterized by more variable operations represented by the smaller differences between the two highest lines blue and black in winter orange and black in summer than in other profiles this means that in those months the reservoir operator does not follow a regular behavior but instead alternates between stable refill in winter and stable drawdown in summer the variability in p3 could be due to long term changes in operating policies over the period of record or the implementation of different policies depending on climate conditions rather than a consistent pattern in all years despite this variability the peak of the orange line drawdown is synchronized with those in profiles p1 and p4 due to the high water demand requirements in the summer months to validate the results presented so far fig 6 illustrates some reservoir features e g spatial location elevation capacity that may explain the profile classifications results show that there is no clear spatial separation of the profiles the only spatial pattern is observed in profile p1 blue edges which is mostly concentrated in the sierra nevada mountains at the same time many reservoirs which are located close one to another and have similar elevation represented by the gray tone in fig 6a were classified in different behavioral profiles despite being exposed to nearly equivalent hydrologic conditions this observation confirms that the reservoir storage dynamics are governed by operational decisions aligned with seasonal water demands the distinctive mountainous location of many reservoirs in profile p1 is confirmed by looking at the elevation of the reservoirs fig 6a with those classified in profile p1 represented by dark circles high elevation the average elevation of p1 reservoirs is almost 5000 ft around 1500 m more than double the average elevation of the other profiles such difference in elevation also explains the different timing of refill strategies that separates p1 from p4 at lower elevation p4 refills early through winter rainfall but the higher elevation p1 reservoirs refill from snowmelt later in the spring finally profile p2 is characterized by the lowest average elevation this low elevation probably contributes in maintaining a stable water level during the year as described by the eigenbehaviors in fig 5 because these reservoirs are located downstream of the others and can benefit from upstream releases to reduce the summer drawdown cycle the second reservoir feature that can help to interpret the clustered profiles is the storage capacity fig 6b results show that reservoirs classified in profile p2 generally have a much larger capacity darker color than the ones in the other profiles profile p2 reservoirs have an average capacity of about 1 2 million acre feet around 1 5 109 m3 which is three times larger than the average capacity of the reservoirs in the other profiles this large difference further clarifies the peculiar pattern of eigenbehaviors in profile p2 namely stable reservoir level for the entire year conversely profiles p1 and p4 contain the smallest reservoirs by volume thus explaining the evident drawdown and refill periods observed in fig 5 finally fig 7 deepens the analysis on the relationships between the extracted behavioral profiles with the features of the reservoirs discussed in fig 6 by mapping each reservoir in terms of elevation x axis and capacity y axis with the color of the circles representing the four different profiles the scattering of the circles in the figure shows that elevation capacity and profile classification are not directly related in addition no separation between reservoirs in different behavioral profiles emerges from the scatterplot this suggests that the identified profiles are primarily determined by behavioral factors rather than the elevation or capacity of the reservoirs in fact in most of the elevation capacity space we can find multiple behavioral profiles meaning that reservoirs with similar physical characteristics are operated in different ways for example despite the fact that profile p2 has the largest average capacity not all large reservoirs located in the top part of the figure are characterized by stable storage throughout the year similarly this operational pattern is also observed for some of the reservoirs with smaller capacities these results confirm the need to advance behavioral models for reproducing human decisions in integrated coupled human natural system models as we cannot simulate the behavior of reservoir operators by considering only the physical characteristics of the reservoirs 4 2 analysis of reservoir operations during drought events the behavioral profiles identified and characterized in the previous section offer a means for studying the operations of these reservoirs during drought events with the goal of discovering behavioral profiles that are particularly vulnerable to severe drought conditions as illustrated in section 2 2 this analysis builds on the confusion matrix obtained by contrasting the observed storage variations and the ones modelled via eigenbehavior to compute the drought vulnerability risk index dvri defined as the ratio in the number of drawdown false negatives during a drought with respect to normal conditions vulnerable reservoirs will be characterized by values of dvri greater than one table 1 provides an illustrative example of the confusion matrix for folsom reservoir where each row of the table represents the action predicted by the eigenbehavior model and each column the observed action with the drawdown false negatives identified by the bold cells in particular the upper table is computed over the entire time series of observations which is assumed to include a range of typical hydroclimatic conditions including wet normal and dry periods while the lower table is computed only over the recent california drought i e 2009 2015 as expected we can observe that the number of drawdown false negatives is 15 28 during the drought compared to 11 07 during the entire time series yielding a dvri 1 38 the computation of the confusion matrix the number of drawdown false negatives over the two periods and the resulting dvri can be repeated for all the 172 reservoirs considered in this study fig 8 illustrates the number of drawdown false negatives over the entire time series x axis against the one during the california drought y axis where each circle represents one reservoir and the color is associated to corresponding behavioral profile in this scatterplot vulnerable reservoirs which are characterized by a higher number of drawdown false negative during the drought than over the entire period will be located above the main diagonal dotted black line the circles in fig 8 are quite equally distributed above and below the diagonal thus not suggesting any clear tendency of increasing drawdown false negatives during the drought however we can deepen the analysis by exploring if the four behavioral profiles extracted by the eigenbehavior analysis are characterized by different average values of dvri possibly also relating the level of drought vulnerability of the different profiles to the associated reservoir features for this purpose for each behavioral profile we perform a separate linear regression with fixed intercept where the slope of the resulting lines the colored dashed lines in fig 8 represents the dvri of the four profiles if the dvri i e the slope of the line is greater than one the line will be located above the diagonal indicating that the behavioral profile is vulnerable in case of drought the figure shows that profiles p1 and p4 have a dvri equal to 1 013 and 1 151 respectively this means that these two profiles are classified as more vulnerable than profiles p2 and p3 which instead have a dvri equal to 0 966 and 0 882 respectively these results suggest that small reservoirs generally operated with marked drawdown and refill cycles are particularly exposed to the negative impacts of droughts conversely medium to large reservoirs operated with limited storage fluctuations are more drought resilient reservoirs classified in profiles p2 and p3 are also located at lower elevations than those in p1 and p4 and are likely adapting to the drought by capitalizing on the coordinated operations of the multi reservoir network interestingly p3 is the least vulnerable profile according to the dvri metric even though p2 has the largest average capacity this result emphasizes the key role of operational flexibility during drought events in fact larger reservoirs trying to maintain a stable water level profile p2 may still be vulnerable to drought events while a smaller capacity with more variable operations profile p3 may more easily adapt to the challenges posed by a severe drought 5 discussion the results reported in the previous section show the benefits of eigenbehavior analysis with respect to alternative policy identification methods first the eigenbehavior analysis is scalable with respect to the number of reservoirs most of the previous studies focus on a single barbagallo et al 2006 shrestha et al 1996 or a small set of reservoirs bessler et al 2003 yang et al 2016 while in this work we successfully modelled 172 reservoirs using a similar technique cominola et al 2018 processed a dataset of hourly water and electricity consumption data gathered for 1107 residential accounts second the eigenbehavior analysis has the ability to classify similar behaviors across the set of reservoirs via clustering over the identified eigenbehavior loadings this is a key feature of our approach as in the literature the similarity of the extracted behaviors has been analyzed only by hejazi et al 2008 while the eigenbehavior analysis does not directly result in an operating rule to be simulated it could be considered a screening step toward building large scale simulation models including reservoirs operations since the clustered profiles could be used to inform one operating policy for each cluster based on the similarity of operators behavior rather than one for each single reservoir moreover the proposed eigenbehavior analysis is a fully data driven modelling approach which unlike other recent studies does not require any assumptions about the underlying objective function driving the observed behavior e g giuliani et al 2016b herman and giuliani 2018 turner et al 2017 the operator s risk aversion howitt et al 2005 or the preference between competing objectives amigoni et al 2016 mason et al 2018 however it is worth noting the strong behavioral similarity across the 172 considered reservoirs clustered in only four profiles which suggests some level of organizing rationality among the reservoir operators which the method is able to identify the analysis of drought vulnerability risk index is another key contribution of our method for discovering behavioral profiles that are most vulnerable to severe drought conditions differently from traditional drought indicators e g standardized precipitation index standardized precipitation and evapotranspiration index which are mostly focused on natural processes and often fail in representing drought conditions when regulated reservoir releases and or groundwater pumping filter the natural water availability zaniolo et al 2018 the proposed dvri aims at capturing unexpected drawdown episodes due to normal releases despite decreasing inflow volumes this metric can therefore represent a valuable support for recognizing anthropogenic droughts which are water stress conditions caused or intensified by human activities aghakouchak 2015 it is worth mentioning that the eigenbehavior analysis is highly portable in other contexts as it only requires historical observations of the reservoir storage which are often recorded by existing monitoring systems or can be obtained via remote sensing e g duan and bastiaanssen 2013 conversely other policy identification methods generally need observations of reservoir releases which represent the output of the regression problem yet such data are frequently not readily available particularly in transboundary river basins either because of not being measured or restricted accessibility as they are considered sensitive data muala et al 2014 finally the definition of the eigenbehaviors in terms of loadings for three different actions drawdown stable refill provides information both on the typical behaviors as represented by the values of the highest loadings and on less frequent actions made in the same months this approach also captures the variability in operator behavior which could be considered either adaptivity or irrationality when different actions would be expected under similar conditions this feature is particularly relevant for the eigenbehavior model to accurately reproduce the variability in human decisions and integrate it within a coupled human natural system model unlike the deterministic descriptions commonly found in the literature 6 conclusions human decisions regarding reservoir operations now control a large fraction of rivers worldwide the dynamics of these systems are therefore not only determined by their natural regime thus motivating the need to develop accurate behavioral models accounting for the key role of human decisions this paper contributes a new data driven behavioral modeling approach based on the eigenbehavior analysis to mine typical operations of water reservoirs directly from historical observations demonstrated using 172 reservoirs in california numerical results show that the proposed method is able to mine typical behavioral profiles from heterogeneous reservoir storage data specifically we identified four different profiles which can be interpreted by considering some features of the reservoirs i e elevation and capacity moreover we show that two of the extracted profiles characterized by marked drawdown and refill cycles in low capacity reservoirs are particularly vulnerable to severe drought conditions future research efforts will focus on extending the analysis to a larger spatial domain possibly using data collected at higher resolutions than the monthly storage observations considered in this study in order to better explore the role of geographic variability and associated climate conditions on the behavior of reservoir operators moreover the present analysis includes only a few reservoir characteristics future applications might also consider other explanatory variables describing local economics and land use for each reservoir to explore the existence of interesting relationships between the clustered profiles and these variables acknowledgements we would like to thank andrea cominola for helpful discussions related to this work jonathan d herman was partially supported by the national science foundation infews grant cns 1639268 any opinions findings and conclusions are those of the authors and do not necessarily reflect the views or policies of the nsf 
732,the large number of dammed rivers worldwide emphasizes the need to couple models of natural processes with models describing human behaviors however such behavioral models are often simplistic and lack proper validation against observational data in this work we contribute a new approach to infer the typical operations of water reservoirs from historical observations using data driven behavioral modeling based on eigenbehavior analysis the approach is demonstrated using monthly storage data from 172 reservoirs in california usa results show that the proposed method identifies four typical behavioral profiles which are strongly linked to key features of the reservoirs moreover we show how the identified models can be used for discovering behavioral profiles and associated reservoir characteristics that are vulnerable to drought conditions keywords behavioral modeling data driven modeling water reservoir operations drought management data mining 1 introduction existing dams control approximately 46 of large rivers worldwide i e rivers with average flows above 1000 m3 s with a cumulative storage capacity of about 8000 km3 lehner et al 2011 these figures are expected to grow in the future driven by the renewed interest in dams as a primary means to secure water and energy particularly in rapidly developing african and asian countries world bank 2009 zarfl et al 2014 this tendency will further increase the number of river systems in which flow dynamics are not only determined by their natural streamflow regime botter et al 2010 but are also strongly influenced by human decisions hanasaki et al 2006 however the role of human decisions has been generally overlooked in the water resources systems modeling literature sivapalan and blöschl 2015 which for many years focused on improving our understanding of natural processes e g dooge 1959 mulvaney 1851 today this unilateral perspective might no longer be adequate thompson et al 2013 motivating the emergence of a number of conceptual frameworks including coupled human natural systems liu et al 2007 coupled environmental human systems horan et al 2011 socio hydrology sivapalan et al 2012 and socio environmental systems filatova et al 2016 with the shared goal of better describing both the natural and the human components of water systems while mathematical models of natural processes are rigorously developed at fine spatial scales e g hundreds of meters and temporal scales e g hourly models describing human behavior are often quite simplistic wada et al 2017 we can broadly distinguish two main categories smith 1991 namely descriptive models which represent the decision mechanism e g camerer et al 2011 and normative models which focus on goal oriented actions e g becker 1978 descriptive models mainly developed in cognitive psychology and the social sciences derive behavioral rules specifying human actions in response to external stimuli however because the detailed data to create such descriptive models have only recently become available sanderson et al 2002 they often rely on general theories and lack a rigorous validation against observational data ligtenberg et al 2010 conversely normative models originally developed in economics assume fully rational behaviors and provide optimal decisions that maximize a given utility function this second approach has been largely adopted in water resources planning and management applications e g loucks et al 2005 poff et al 2015 but the resulting optimal decisions often do not match observed behaviors simon 1957 this has challenged the uptake of normative decision support systems in real world operational contexts labadie 2004 newman et al 2017 simonovic 1992 today an unprecedented torrent of information economist 2011 produced by pervasive sensor networks e g hart and martinez 2006 mccabe et al 2017 remote sensing e g lettenmaier et al 2015 zhang et al 2016 and crowdsourcing e g giuliani et al 2016a michelsen et al 2016 combined with the advances in data analytics and machine learning watt et al 2016 creates new possibilities for constructing accurate behavioral models based on observational data the idea of inferring a behavioral model of a reservoir operator from historical data has been explored in a few previous studies with multiple goals deriving operational rules via regression techniques barbagallo et al 2006 bessler et al 2003 shrestha et al 1996 yang et al 2016 exploring which sources of hydrologic information condition reservoir releases hejazi et al 2008 yang et al 2016 and formulating candidate objective functions to explain the observed behavior howitt et al 2005 mason et al 2018 building on these studies this paper introduces a novel data driven behavioral modeling approach to mine typical behaviors of water reservoir operators from historical observations using eigenbehavior analysis eigenbehavior analysis was originally proposed by eagle and pentland 2009 for identifying behavioral routines in the location data of 100 individuals monitored via smartphone communications and was recently adopted by cominola et al 2018 to analyze residential water energy demand profiles here we extend this approach to characterize typical operating strategies across a large set of water reservoirs these typical operating strategies are obtained through the extraction of principal components from behavioral data to obtain a set of vectors called eigenbehaviors spanning the behavioral space of the monitored operators specifically the principal components are computed as the eigenvectors of the covariance matrix of the behavioral data where the vectors associated with high loadings represent a type of recurrent behavior i e a behavioral profile we then cluster the individuals reservoir operators on the basis of their corresponding behavioral profiles this segmentation process is finally verified a posteriori by relating the clustered profiles to specific features of the reservoirs location elevation and capacity we demonstrate the potential of our modeling approach using data from 172 water reservoirs in california which are described by historical trajectories of monthly storage volume obtained from the california data exchange center http cdec water ca gov as well as the reservoirs location elevation and capacity moreover we show how studying the discrepancies between observations and model outputs allows detecting anomalous circumstances when operators deviate from their typical behaviors due to external forcing in particular the quantification of these deviations during the recent california drought allows formulating a drought vulnerability risk index dvri that can be used for discovering behavioral profiles and associated features of the reservoirs that are most vulnerable to severe drought conditions the rest of the paper is organized as follows the next section introduces the methodology followed by the description of the california reservoirs considered in this study results and discussion are reported in sections 4 and 5 while final remarks along with suggestions for further research are presented in the last section 2 material and methods 2 1 eigenbehavior analysis eigenbehavior analysis aims to identify typical behavioral profiles of reservoir operators via data mining of historical observational data specifically we consider time series of storage variation y t k with t 1 h where h is the length of the time series defined as 1 y t k s t k s t 1 k q t k r t k where s t k and s t 1 k are the storage of the reservoir k with k 1 r and r is the total number of reservoirs at the current and previous time step while q t k and r t k are the reservoir inflow and the regulated release during the time interval t 1 t considering the trajectory of storage variation yt allows isolating the human behavior that determines the regulated release rt in response to the hydrologic conditions represented by the inflow qt for the same value of inflows different behaviors will be captured by different values of yt looking only at the release trajectory could be misleading as two equivalent values of releases would suggest the same behavior but if those decisions are made with different values of storage inflows they should be identified as different behaviors it is also worth noticing that even in cases where the change in storage is dominated by inflows the change in storage still reflects an operational decision to store the inflows rather than release them our data driven behavioral modeling procedure is composed of four main steps as illustrated in fig 1 binary tranformation eigenbehavior extraction eigenbehavior clustering and eigenbehavior interpretation binary transformation the time series y t k of the kth reservoir is first rearranged into a matrix xk of dimension ny t where ny is the number of years of available observations and t is the annual period each row of xk hence corresponds to one year and each column to one day week or month depending on the temporal resolution of the data we then transform the matrix xk into a binary matrix γk where the observed values of storage variations are classified into one of a mutually exclusive actions e g drawdown stable or refill each row of γk contains n t a elements where the binary values of γk map the observations of xk into the corresponding action we can then identify average operations ψk of each reservoir i e the action usually performed in each period of the year defined as 2 ψ k 1 n y i 1 n y γ i k however the average operations ψk do not guarantee a good representation of the original behavioral data which often present a large variability around the average values eigenbehavior extraction this step is performed on the matrices γk constructed in the binary transformation step formally the eigenbehaviors are computed via principal component analysis pca a dimensionality reduction technique that searches for linear combinations of the original variables such that the coefficients of the output combinations the principal vectors form a low dimensional sub space defined by directions explaining maximal variance in the original data joliffe 2002 a few principal components generally explain a high percentage of the variance of the original variables ensuring dimension reduction in addition the representation of the original data in the projected space defined by principal components is uncorrelated thus providing a useful tool for physical and statistical interpretations pca is performed via eigenvalue decomposition of the covariance matrix q of γk i e 3 q 1 n y i 1 n y γ i k γ i k where the resulting eigenvectors w q k of q with q 1 n are the eigenbehaviors of the kth reservoir and allow mapping the original matrix γk into its principal components i e 4 ϱ q k γ k w q k with q 1 n eigenbehavior clustering after the extraction of the eigenbehaviors via pca the reservoirs are classified into different behavioral profiles based on their first few eigenvectors it is generally sufficient to consider only the first eigenvector w 1 k as it accounts for the most variance in the behavioral data for reservoir k quantified by the associated highest eigenvalue however highly variable datasets may require more eigenvectors to better capture the variance of the observed behavior our classification was run using an iterative implementation of t distributed stochastic neighbour embedding t sne maaten and hinton 2008 and k means clustering macqueen 1967 specifically the t sne method is used to select the number of clusters for the k means clustering t sne performs the dimensionality reduction and projects the eigenvectors w 1 k into two dimensional points to allow visual analysis of the separability of the k means clusters eigenbehavior interpretation lastly the behavioral profiles determined in the previous step are discussed with respect to the characteristics of the reservoirs belonging to each cluster to infer potential factors influencing the observed behaviors 2 2 drought vulnerability risk index the behavioral profiles identified via eigenbehavior analysis offer a means for analysing the reservoir operations during drought events with the goal of discovering behavioral profiles and associated reservoir features that are particularly vulnerable to severe drought conditions this analysis builds on the confusion matrix obtained by contrasting the observed storage variations and the ones modelled via eigenbehavior specifically we can count the number of drawdown false negatives i e observed drawdown months that the eigenbehavior model erroneously predicts as stable or refill this value normalized with respect to the total number of observations in the considered time period is expected to increase during drought episodes with respect to normal conditions the drought vulnerability risk index dvri can hence be defined as 5 d v r i δ d δ n where δd and δn are the number of drawdown false negatives during a drought and in normal conditions respectively vulnerable reservoirs will be characterized by values of dvri greater than one which capture episodes when operators likely did not adapt their policy and maintained normal release decisions despite decreasing inflow volumes such a strategy causes reservoir storage to decrease in months that under normal conditions would be operated to refill or maintain stable levels 3 study site the method is tested on a dataset of 172 reservoirs in california usa nearly all large rivers in california are dammed grantham et al 2014 and these reservoirs serve multiple important objectives including urban and agricultural water supply flood control and hydropower generation they are operated by a mix of local state and federal agencies during typical hydrologic years the largest state and federal reservoirs are operated for the primary purpose of storing snowmelt from the sierra nevada mountains for delivery to irrigation later in the year however they also play an important role in inter year operations during extreme conditions as observed during the recent drought these operating strategies will likely need to change in the future as some projections indicate long term decreases in water supply vicuna et al 2007 increases in the magnitude of flood events anderson et al 2007 and an increased rain fraction of winter storms due to rising temperatures stewart et al 2005 the dataset used in this work is drawn from the california data exchange center cdec http cdec water ca gov a few of the reservoirs included in the dataset are in nearby states nevada arizona oregon but are nevertheless connected to the california water supply network the dataset includes monthly storage time series for each reservoir from the earliest available month through december 2016 the shortest available record is 36 years beginning in 1980 the majority of reservoirs have records between 50 70 years the reservoir characteristics related to eigenbehavior clusters namely elevation and capacity were also drawn from cdec in cases where a capacity value was not available the maximum observed storage volume from the record was used instead reservoir locations and capacities are shown in fig 2 a while a histogram of record lengths is shown fig 2b three discrete modes of operation are considered for the eigenbehavior analysis drawdown stable and refill a month is classified as drawdown refill if the decrease increase of the storage with respect to previous month exceeds 5 it is worth mentioning that alternative thresholds could be considered in performing the binary transformation step e g a larger storage variation or a fixed percentage of the reservoir capacity our choice of using the 5 relative to the previous month is motivated by the need of capturing also unintended drawdown during drought periods 4 results 4 1 analysis of eigenbehaviors this section reports the analysis of the eigenbehaviors extracted from the monthly storage observations of the 172 california reservoirs as described in section 2 the analysis assigns a typical behavioral profile to each reservoir a behavioral profile is defined as an annual pattern of operating strategies that distinguishes periods of drawdown refill and stable level weighted by the values of the eigenbehavior loadings an illustrative example for folsom reservoir is reported in fig 3 where each row corresponds to a month each column to a different action i e drawdown refill and stable level and the color intensity is proportional to the magnitude of the eigenbehavior loadings with dark colors identifying recurrent actions in each month of the year the results show a marked drawdown period during the summer when the maximum agricultural demand occurs and the operator decides a release higher than the inflow and a refill period in early spring during the snowmelt period when the operator releases less water than the inflow for a single reservoir these results are not surprising however the potential of our analysis lies in classifying numerous reservoirs according to their extracted behavioral profiles fig 4 illustrates the variety of eigenbehaviors across the 172 reservoirs considered in this study each column of the matrix represents one reservoir with the color intensity proportional to the loadings of the first eigenbehavior as in fig 3 each eigenbehavior is subdivided into the three actions drawdown stable refill and each action has 12 coefficients one for each month of the year in this study we consider only the first eigenbehavior i e first principal component as it explains on average 58 of the variance in the original data while the second eigenbehavior only contributes an additional 8 the eigenbehaviors reported in fig 4 are clustered into four profiles p1 p4 separated by the magenta dashed lines according to similarities in the magnitude of loadings for example fig 4 shows that profile p2 includes reservoirs characterized by stable water levels throughout the year indicated by the dark pixels in the center of the figure possibly due to large storage capacity on the contrary profiles p1 and p4 have marked drawdown and refill periods represented by the dark pixels in late summer and early spring respectively profile p3 includes reservoirs with more variable operations showing less regular recurrent drawdown refill periods than p1 and p4 finally reservoirs associated with profile p4 start refilling before p1 possibly because these reservoirs are located in lower elevation basins than the ones classified in profile p1 the seasonal storage of high elevation reservoirs is mostly created by snowmelt while the winter rainfall becomes predominant at lower elevation where snow is not accumulating the clustering of the reservoirs produced four distinct behavioral profiles which can be modeled according to the loadings of the clusters centroids as reported in fig 5 this alternative visualization confirms and summarizes the characteristics of the four profiles identified in fig 4 in terms of the most recurrent action made in each month of the year represented by the line with the maximum loading value profiles p1 and p4 have frequent drawdown refill periods illustrated by the larger values of the orange and blue lines relative to the black one the major difference between p1 and p4 is the timing of the peak in the blue refill line reservoirs in profile p1 refill primarily in spring while those in profile p4 are able to refill in late winter profile p2 includes reservoirs with stable storage for the entire year as shown by the high values of the black line during all 12 months finally profile p3 is characterized by more variable operations represented by the smaller differences between the two highest lines blue and black in winter orange and black in summer than in other profiles this means that in those months the reservoir operator does not follow a regular behavior but instead alternates between stable refill in winter and stable drawdown in summer the variability in p3 could be due to long term changes in operating policies over the period of record or the implementation of different policies depending on climate conditions rather than a consistent pattern in all years despite this variability the peak of the orange line drawdown is synchronized with those in profiles p1 and p4 due to the high water demand requirements in the summer months to validate the results presented so far fig 6 illustrates some reservoir features e g spatial location elevation capacity that may explain the profile classifications results show that there is no clear spatial separation of the profiles the only spatial pattern is observed in profile p1 blue edges which is mostly concentrated in the sierra nevada mountains at the same time many reservoirs which are located close one to another and have similar elevation represented by the gray tone in fig 6a were classified in different behavioral profiles despite being exposed to nearly equivalent hydrologic conditions this observation confirms that the reservoir storage dynamics are governed by operational decisions aligned with seasonal water demands the distinctive mountainous location of many reservoirs in profile p1 is confirmed by looking at the elevation of the reservoirs fig 6a with those classified in profile p1 represented by dark circles high elevation the average elevation of p1 reservoirs is almost 5000 ft around 1500 m more than double the average elevation of the other profiles such difference in elevation also explains the different timing of refill strategies that separates p1 from p4 at lower elevation p4 refills early through winter rainfall but the higher elevation p1 reservoirs refill from snowmelt later in the spring finally profile p2 is characterized by the lowest average elevation this low elevation probably contributes in maintaining a stable water level during the year as described by the eigenbehaviors in fig 5 because these reservoirs are located downstream of the others and can benefit from upstream releases to reduce the summer drawdown cycle the second reservoir feature that can help to interpret the clustered profiles is the storage capacity fig 6b results show that reservoirs classified in profile p2 generally have a much larger capacity darker color than the ones in the other profiles profile p2 reservoirs have an average capacity of about 1 2 million acre feet around 1 5 109 m3 which is three times larger than the average capacity of the reservoirs in the other profiles this large difference further clarifies the peculiar pattern of eigenbehaviors in profile p2 namely stable reservoir level for the entire year conversely profiles p1 and p4 contain the smallest reservoirs by volume thus explaining the evident drawdown and refill periods observed in fig 5 finally fig 7 deepens the analysis on the relationships between the extracted behavioral profiles with the features of the reservoirs discussed in fig 6 by mapping each reservoir in terms of elevation x axis and capacity y axis with the color of the circles representing the four different profiles the scattering of the circles in the figure shows that elevation capacity and profile classification are not directly related in addition no separation between reservoirs in different behavioral profiles emerges from the scatterplot this suggests that the identified profiles are primarily determined by behavioral factors rather than the elevation or capacity of the reservoirs in fact in most of the elevation capacity space we can find multiple behavioral profiles meaning that reservoirs with similar physical characteristics are operated in different ways for example despite the fact that profile p2 has the largest average capacity not all large reservoirs located in the top part of the figure are characterized by stable storage throughout the year similarly this operational pattern is also observed for some of the reservoirs with smaller capacities these results confirm the need to advance behavioral models for reproducing human decisions in integrated coupled human natural system models as we cannot simulate the behavior of reservoir operators by considering only the physical characteristics of the reservoirs 4 2 analysis of reservoir operations during drought events the behavioral profiles identified and characterized in the previous section offer a means for studying the operations of these reservoirs during drought events with the goal of discovering behavioral profiles that are particularly vulnerable to severe drought conditions as illustrated in section 2 2 this analysis builds on the confusion matrix obtained by contrasting the observed storage variations and the ones modelled via eigenbehavior to compute the drought vulnerability risk index dvri defined as the ratio in the number of drawdown false negatives during a drought with respect to normal conditions vulnerable reservoirs will be characterized by values of dvri greater than one table 1 provides an illustrative example of the confusion matrix for folsom reservoir where each row of the table represents the action predicted by the eigenbehavior model and each column the observed action with the drawdown false negatives identified by the bold cells in particular the upper table is computed over the entire time series of observations which is assumed to include a range of typical hydroclimatic conditions including wet normal and dry periods while the lower table is computed only over the recent california drought i e 2009 2015 as expected we can observe that the number of drawdown false negatives is 15 28 during the drought compared to 11 07 during the entire time series yielding a dvri 1 38 the computation of the confusion matrix the number of drawdown false negatives over the two periods and the resulting dvri can be repeated for all the 172 reservoirs considered in this study fig 8 illustrates the number of drawdown false negatives over the entire time series x axis against the one during the california drought y axis where each circle represents one reservoir and the color is associated to corresponding behavioral profile in this scatterplot vulnerable reservoirs which are characterized by a higher number of drawdown false negative during the drought than over the entire period will be located above the main diagonal dotted black line the circles in fig 8 are quite equally distributed above and below the diagonal thus not suggesting any clear tendency of increasing drawdown false negatives during the drought however we can deepen the analysis by exploring if the four behavioral profiles extracted by the eigenbehavior analysis are characterized by different average values of dvri possibly also relating the level of drought vulnerability of the different profiles to the associated reservoir features for this purpose for each behavioral profile we perform a separate linear regression with fixed intercept where the slope of the resulting lines the colored dashed lines in fig 8 represents the dvri of the four profiles if the dvri i e the slope of the line is greater than one the line will be located above the diagonal indicating that the behavioral profile is vulnerable in case of drought the figure shows that profiles p1 and p4 have a dvri equal to 1 013 and 1 151 respectively this means that these two profiles are classified as more vulnerable than profiles p2 and p3 which instead have a dvri equal to 0 966 and 0 882 respectively these results suggest that small reservoirs generally operated with marked drawdown and refill cycles are particularly exposed to the negative impacts of droughts conversely medium to large reservoirs operated with limited storage fluctuations are more drought resilient reservoirs classified in profiles p2 and p3 are also located at lower elevations than those in p1 and p4 and are likely adapting to the drought by capitalizing on the coordinated operations of the multi reservoir network interestingly p3 is the least vulnerable profile according to the dvri metric even though p2 has the largest average capacity this result emphasizes the key role of operational flexibility during drought events in fact larger reservoirs trying to maintain a stable water level profile p2 may still be vulnerable to drought events while a smaller capacity with more variable operations profile p3 may more easily adapt to the challenges posed by a severe drought 5 discussion the results reported in the previous section show the benefits of eigenbehavior analysis with respect to alternative policy identification methods first the eigenbehavior analysis is scalable with respect to the number of reservoirs most of the previous studies focus on a single barbagallo et al 2006 shrestha et al 1996 or a small set of reservoirs bessler et al 2003 yang et al 2016 while in this work we successfully modelled 172 reservoirs using a similar technique cominola et al 2018 processed a dataset of hourly water and electricity consumption data gathered for 1107 residential accounts second the eigenbehavior analysis has the ability to classify similar behaviors across the set of reservoirs via clustering over the identified eigenbehavior loadings this is a key feature of our approach as in the literature the similarity of the extracted behaviors has been analyzed only by hejazi et al 2008 while the eigenbehavior analysis does not directly result in an operating rule to be simulated it could be considered a screening step toward building large scale simulation models including reservoirs operations since the clustered profiles could be used to inform one operating policy for each cluster based on the similarity of operators behavior rather than one for each single reservoir moreover the proposed eigenbehavior analysis is a fully data driven modelling approach which unlike other recent studies does not require any assumptions about the underlying objective function driving the observed behavior e g giuliani et al 2016b herman and giuliani 2018 turner et al 2017 the operator s risk aversion howitt et al 2005 or the preference between competing objectives amigoni et al 2016 mason et al 2018 however it is worth noting the strong behavioral similarity across the 172 considered reservoirs clustered in only four profiles which suggests some level of organizing rationality among the reservoir operators which the method is able to identify the analysis of drought vulnerability risk index is another key contribution of our method for discovering behavioral profiles that are most vulnerable to severe drought conditions differently from traditional drought indicators e g standardized precipitation index standardized precipitation and evapotranspiration index which are mostly focused on natural processes and often fail in representing drought conditions when regulated reservoir releases and or groundwater pumping filter the natural water availability zaniolo et al 2018 the proposed dvri aims at capturing unexpected drawdown episodes due to normal releases despite decreasing inflow volumes this metric can therefore represent a valuable support for recognizing anthropogenic droughts which are water stress conditions caused or intensified by human activities aghakouchak 2015 it is worth mentioning that the eigenbehavior analysis is highly portable in other contexts as it only requires historical observations of the reservoir storage which are often recorded by existing monitoring systems or can be obtained via remote sensing e g duan and bastiaanssen 2013 conversely other policy identification methods generally need observations of reservoir releases which represent the output of the regression problem yet such data are frequently not readily available particularly in transboundary river basins either because of not being measured or restricted accessibility as they are considered sensitive data muala et al 2014 finally the definition of the eigenbehaviors in terms of loadings for three different actions drawdown stable refill provides information both on the typical behaviors as represented by the values of the highest loadings and on less frequent actions made in the same months this approach also captures the variability in operator behavior which could be considered either adaptivity or irrationality when different actions would be expected under similar conditions this feature is particularly relevant for the eigenbehavior model to accurately reproduce the variability in human decisions and integrate it within a coupled human natural system model unlike the deterministic descriptions commonly found in the literature 6 conclusions human decisions regarding reservoir operations now control a large fraction of rivers worldwide the dynamics of these systems are therefore not only determined by their natural regime thus motivating the need to develop accurate behavioral models accounting for the key role of human decisions this paper contributes a new data driven behavioral modeling approach based on the eigenbehavior analysis to mine typical operations of water reservoirs directly from historical observations demonstrated using 172 reservoirs in california numerical results show that the proposed method is able to mine typical behavioral profiles from heterogeneous reservoir storage data specifically we identified four different profiles which can be interpreted by considering some features of the reservoirs i e elevation and capacity moreover we show that two of the extracted profiles characterized by marked drawdown and refill cycles in low capacity reservoirs are particularly vulnerable to severe drought conditions future research efforts will focus on extending the analysis to a larger spatial domain possibly using data collected at higher resolutions than the monthly storage observations considered in this study in order to better explore the role of geographic variability and associated climate conditions on the behavior of reservoir operators moreover the present analysis includes only a few reservoir characteristics future applications might also consider other explanatory variables describing local economics and land use for each reservoir to explore the existence of interesting relationships between the clustered profiles and these variables acknowledgements we would like to thank andrea cominola for helpful discussions related to this work jonathan d herman was partially supported by the national science foundation infews grant cns 1639268 any opinions findings and conclusions are those of the authors and do not necessarily reflect the views or policies of the nsf 
733,karst landscape covers more than 10 of the global land surface and plays an important role in supporting ecosystems and human society may be strongly influenced by climate change vegetation available water vaw is a key variable impacting the sensitivity of ecosystems to a changing environment however vaw in karst region is difficult to determine and remains uncertain this study improved a dynamic budyko type water balance model by introducing a nonlinear equation linking climate vegetation and budyko type water balance this model was calibrated using evolutionary algorithm based on monthly runoff comparison results in the pearl yangtze and 12 karst catchments in south china suggested high effectiveness of this improved model in simulating monthly runoff and evapotranspiration furthermore in the 12 karst catchments the max vaw was negatively correlated to the portion of karst landscape of the catchment pok r 0 63 α 0 027 and the elasticity of evapotranspiration to precipitation r 0 60 α 0 04 these implied that karst catchments with higher pok had lower vaw making the ecosystems rely more on precipitation keywords ecohydrology hydrological modeling water balance budyko framework climate sensitivity 1 introduction karst landscape covers more than 10 of the earth s land surface and has important roles in water supply for human society about 25 of the world population is dependent on karst water to some extent ford and williams 2013 hartmann et al 2014 however owing to the carbonate nature karst landscape is generally characterized by thin soil high infiltration capacity and low water holding capacity liu et al 2012 wilcox et al 2008 williams 2008 and the karst ecosystem often exhibits high vulnerability and sensitivity to changing environment e g climate change human activities fan et al 2011 hou et al 2016 liu et al 2014 liu et al 2016 wang et al 2004 for example huang et al 2013 reported that the npp net primary production in south china generally decreased during 2006 2011 while the magnitude of decrease in npp in karst region was obviously higher than that in non karst region recently liu et al 2016 pointed out that the actual evapotranspiration in karst catchments in southwestern china was more less sensitive to change in precipitation potential evapotranspiration and was exposed to higher degradation stress brought by climate change than that in non karst catchments in facts there are many factors affecting climate sensitivity of ecosystems ning et al 2017 potter et al 2005 yokoo et al 2008 besides the physiological properties of vegetation the vegetation available water vaw is a key factor directly affecting ecosystem resilience milly 1994 potter et al 2005 therefore quantifying vaw is essential in understanding the ecohydrological sensitivity or responses of karst catchments to the changing environment however direct estimates of vaw in karst landscape is still a big challenge to adapt to the environment vegetation in karst landscape may utilize water from both soil and epikarst zone water in cracks conduits depending on the rooting depth nie et al 2012 schwinning 2008 highly weathered rock may have the ability to store high quantities of water querejeta et al 2006 however the solution enlarged fissures cracks and conduits allow rapid transport of water preferential flow hartmann and baker 2017 heilman et al 2014 which can also lead to water bypassing the root zone arbel et al 2010 dasgupta et al 2006 due to the high heterogeneity of the karst critical zone bakalowicz 2005 it is hard to quantify the properties of soil e g depth distribution epikarst e g porosity cracks and vegetation rooted depth which jointly determine the vaw therefore inverse analysis based on ecohydrological models may be an alternative way dorfliger et al 2009 pinault et al 2001 there are many models for karst ecohydrology modeling distributed or lumped on which hartmann et al 2014 provided an excellent review generally distributed models need many parameters which are usually not available in karst region in comparison lumped models require only a small number of parameters and thus are often preferred charlier et al 2012 hartmann et al 2013 jukic and denic jukic 2009 tritz et al 2011 among these models the main differences pertain to the treatments of karstic media evapotranspiration runoff generation and groundwater recharge hartmann et al 2014 hartmann et al 2012 scanlon et al 2003 zhang et al 2011 particularly evapotranspiration in lumped models is often assumed to be a function of the soil water storage hartmann et al 2013 janza 2010 or simply the potential evapotranspiration jukic and denic jukic 2009 tritz et al 2011 ignoring the impacts of vegetation dynamics these treatments would lead to high uncertainties in evapotranspiration modeling in fact these models are mainly used to model rainfall runoff response and karstic aquifer recharge jukic and denic jukic 2009 to model water balance over variable time scales zhang et al 2008 developed a dynamic budyko water balance model budyko 1974 choudhury 1999 yang et al 2008 this model divides the catchment water storage into root zone storage and groundwater storage and assumes that water partitioning among different hydrological components e g runoff evapotranspiration follows the budyko hypothesis zhang et al 2008 this lumped parameter dynamic budyko model has shown good performance in runoff modeling zhang et al 2008 most importantly this model contains several important concepts related to ecohydrological sensitivity however this model also ignores the impacts of dynamic vegetation and its performance in karst region has not been verified the purposes of this study were two fold to improve and validate the dynamic budyko model in runoff and evapotranspiration modeling in karst catchments and to investigate how the karst landscape affects ecohydrological parameters this paper is arranged as follows section 2 introduces the data sources section 3 focuses on the study area and introduces the model and the improvements as well as the methodologies section 4 includes the results section 5 provides our discussion and the conclusion is given in section 6 2 data sources monthly precipitation p potential evapotranspiration pet evapotranspiration et runoff q and change in water storage δs of 32 global large catchments were collected form pan s dataset 1984 2006 pan et al 2012 this dataset is based on multiple sources and has been widely used in previous hydrological studies liu et al 2017 zeng and cai 2016 the normalized difference vegetation index ndvi was derived from the gimms global inventory modeling and mapping studies ndvi3g ndvi version 3 g dataset 1982 2012 anyamba et al 2014 to reflect vegetation monthly natural runoff 1950s 2000 in 12 karst catchments were collected from the changjiang river conservancy commission and zhujiang water resources commission daily meteorological data 1950s 2000 at 32 meteorological stations in the 12 karst catchments were from the china meteorological data service network http www escience gov cn metdata page index html the ceres clouds and the earth s radiant energy system ebaf energy balanced and filled surface fluxes data set 1 1 grid 2000 2014 http ceres larc nasa gov order data php was used to calibrate surface albedo in calculating potential evapotranspiration in the 12 karst catchments mean slope was calculated based on the dem digital elevation model 30 m collected form the data sharing infrastructure of earth system science http www geodata cn portal mdsearch listmetadata jsp category 175 pn 2 meanwhile the remote sensing based evapotranspiration 1981 2012 developed by zhang et al 2016 https data csiro au dap landingpage execution e1s4 was used to evaluate the modeled et in the 12 karst catchments this remote sensing based et was developed based on the pml algorithm leuning et al 2008 and multisource of inputs zhang et al 2016 3 methods 3 1 descriptions of the original dynamic budyko model in the original dynamic budyko model zhang et al 2008 the precipitation p is partitioned into direct runoff qd and other water components x which includes the ground water recharge r root zone storage change δs and evapotranspiration et 1 p t q d t x t where the subscripts t means the corresponding component in period t and x t can be considered as catchment water retention the potential max catchment water retention is 2 x 0 t s m x s t 1 p e t t where pet t is the potential evapotranspiration s t 1 is the residual available water in the preceding period t 1 and smx is the max vegetation available water vaw in karst region where vegetation can utilize water in soil and bedrock e g cracks nie et al 2012 schwinning 2008 the smx represents the total max vaw in both soil and the epikarst zone assuming that the water partitioning between precipitation p t and catchment water retention x t follows the budyko hypothesis budyko 1974 choudhury 1999 x t can be calculated as 3 x t p t x 0 t p t γ 1 x 0 t γ 1 1 γ 1 where γ1 is the catchment water retention efficiency therefore based on water balance the direct runoff can be calculated as 4 q d t p t x t in period t the total available water w t is the sum of the residual water storage s t 1 and the catchment water retention x t 5 w t x t s t 1 the total available water w t would provide water for evapotranspiration recharge root zone water storage and groundwater 6 w t e t t s t r t where et t is the evapotranspiration s t is the root zone water storage and r t is the groundwater recharge in period t defining that the evapotranspiration opportunity y t as sankarasubramanian and vogel 2002 7 y t e t t s t then the potential max evapotranspiration opportunity is the sum of potential evapotranspiration and the max vegetation available water 8 y 0 t p e t t s m x likely assuming that water partitioning between w t and y t follows the budyko hypothesis y t can be described as 9 y t w t y 0 t w t δ t y 0 t δ t 1 δ t within the y t the et t is calculated as 10 e t t w t p e t t w t δ t p e t t δ t 1 δ t where the δ t represents the evapotranspiration efficiency then based on eqs 5 7 the groundwater recharge r t and root zone water storage change δs t can be calculated as 11 r t w t e t t s t w t y t 12 δ s t s t s t 1 y t e t t s t 1 finally the groundwater storage g t is treated as a linear reservoir and the base flow q b t is modeled as 13 q b t γ 2 g t 1 where γ2 is a constant representing the outflow rate of groundwater recession constant therefore the groundwater storage g t in period t is 14 g t 1 γ 2 g t 1 r t where q b t is the base flow g t is the groundwater storage all the abbreviations are summarized in table 1 3 2 improving the model by linking evapotranspiration and vegetation the original dynamic budyko model treats the evapotranspiration efficiency δ t eq 10 as a constant zhang et al 2008 however many studies reported that vegetation dynamics including phenology and climate seasonality controlled water partitioning milly and shmakin 2002 ning et al 2017 potter et al 2005 for example eq 15 is widely used to model plant water uptake at sub annual scale feddes et al 1978 liu et al 2013 somma et al 1998 vrugt et al 2001 15 e t φ β 1 e k l a i t p φ β 1 e k l a i k c e t 0 where kc is the crop coefficient et 0 is the reference evapotranspiration k is the radiation extinction coefficient and lai is the leaf area index eq 15 shows that evapotranspiration is proportional to potential evapotranspiration penman 1948 yang et al 2006 similarly the choudhury s equation eq 10 can be considered as a proportional relationship between et t and pet t choudhury 1999 16 e t t w t w t δ t p e t t δ t 1 δ t p e t t the φ β 1 e k lai kc in eq 15 is closely related to vegetation because the β and lai represent the roots and canopy properties kc has clear seasonal variation with vegetation growth allen et al 1998 and φ reflect the water stress therefore term w t w t δ t p e t t δ t 1 δ t in eq 16 could reflect vegetation conditions like the term φ β 1 e k lai kc in eq 15 based on the gimms ndvi3g dataset and the water budget dataset developed by pan et al 2012 there is a linear relationship between w t w t δ t p e t t δ t 1 δ t and ndvi 17 w t w t δ t p e t t δ t 1 δ t p t δ s t p t δ s t δ t p e t t δ t 1 δ t ω 1 n d v i t ω 2 where δs is the changes in water storage ω1 is the slope and ω2 is an constant the determination coefficient r 2 for eq 17 being generally higher than 0 7 8 out of the 12 catchments fig 1 thus eq 17 was used to link vegetation ndvi t water supply w t energy pet t and evapotranspiration efficiency δ t for improving the original model the main difference between the improved and the original model is that in the original model the δ t is a constant while in the improved model the δ t is the solution of eq 17 and depends on vegetation ndvi available water w t and energy pet t 3 3 study area the performance of the original and improved models were evaluated in the pearl yangtze and 12 karst catchments in south china fig 2 the 12 karst catchments which are belong to the pearl no 9 11 and yangtze no 1 8 and 12 catchments and cover totally about 11 5 104 km2 are located in guizhou guangxi and yunnan provinces in southwestern china where is dominated by karst terrains liu et al 2016 zhang et al 2014 and subtropical monsoon climate the drainage area of the 12 karst catchments ranges from 0 23 104 km2 to 2 29 104 km2 table 2 the portion of karst landscape pok areakarst areab where areakarst is the karst landscape area and areab is the catchment area ranges from 0 52 to 0 95 mean of 0 74 the slope ranges from 0 32 to 0 67 mean of 0 44 table 2 the ranges for aridity index pet p annual ndvi runoff coefficient qc runoff precipitation are 0 74 1 16 mean of 0 85 0 47 0 57 mean of 0 54 and 0 46 0 65 mean of 0 53 respectively table 2 the cv ndvi coefficient of variation of the monthly ndvi during 1982 2000 ranges from 0 21 to 0 32 table 2 note that there were two reasons for calibrating and validating the original and improved models in the pearl and yangtze catchments first the 12 karst catchments are located in these two big catchments and therefore have the similar climate second the catchment scale et series in the two catchments can be collected from the pan s dataset pan et al 2012 though uncertainties may still exist the et data in pan s dataset would be close to the trues because they are based on multiple sources of data and assimilation techniques pan et al 2012 of course the catchment scale et can also be derived from remote sensing technique however some uncertainties of the remote sensing based et were found in this region see the fig 8 in section 4 2 therefore based on the pan s et series we could quantify the performance of the original and improved models in et modeling with more confidence 3 4 data preparation in the 12 karst catchments the pet were calculated using the penman method penman 1948 in which the solar radiation were estimated using the angstrom equation allen et al 1998 and the surface albedo were calibrated using ceres ebaf surface fluxes details can be found in liu et al 2016 catchment scale monthly p pet and etrm remote sensing based et were calculated by arithmetically averaging the monthly data at all stations grids in each catchment the monthly p and pet were aggregated from daily values in the 12 karst catchments while in the pearl and yangtze catchments the monthly p et and pet were directly collected form pan s dataset 1984 2006 pan et al 2012 in all the catchments the monthly ndvi were calculated by arithmetically averaging the monthly data at all grids in each catchment owing to the different time coverages the q p pet ndvi and etrm et were constrained to the period 1982 2000 for the 12 karst catchments and 1984 2006 for the pearl and yangtze catchments 3 5 parameters optimization and their identifiability there are six parameters need to be calibrated the smx max vaw γ1 water retention efficiency ω1 slope in eq 17 ω2 constant in eq 17 γ2 recession constant and g 0 the initial groundwater storage here these parameters were calibrated based on monthly runoff by using the evolutionary algorithm the evolutionary algorithms are considered to be robust globally oriented and generally more straightforward to apply in situations where there is little or no a priori knowledge evolutionary algorithms have been widely used in parameter optimization for hydrological models cheng et al 2002 duan et al 1992 tang et al 2005 wang 1991 here the objective function was designed as 18 r m s e i 1 n q m i q o b i 2 n where rmse is the root mean square error q m i is the modeled runoff at time i q ob i is the observed runoff at time i n is the number of observations the calibration was performed by using the geatbx genetic and evolutionary algorithm toolbox for matlab pohlheim 2006 the geatbx contains many variants of genetic algorithms and genetic programming and can provide many optimization capabilities pohlheim 2006 details of this matlab based toolbox can be found in pohlheim 2006 in the calibration the parameter ranges for the smx γ1 ω1 ω2 γ2 and g 0 were set to be lower upper 0 500 mm 0 5 dimensionless 0 5 dimensionless 0 5 to 1 dimensionless 0 1 mm 1 month 1 and 0 500 mm respectively meanwhile the number of individuals per subpopulations nind maximum number of generations maxgen generation gap ggap as well as precision of binary representation preci were set to be 35 100 0 6 and 10 the calibration procedure was repeated 10 000 times in each catchment and the parameters that produced the minimum rmse eq 18 were used as the final results note that in the optimization the evolutionary algorithms may give some initial assignments such that there is no numerical and real solution to eq 17 in this case the objective function eq 18 was assigned a very large value e g 9999 meanwhile the identifiability of the model parameters was analyzed by using the famous generalized likelihood uncertainty estimation glue method beven and binley 1992 ortiz et al 2011 stedinger et al 2008 sun et al 2016 in the analysis the rmse eq 18 was also used as the likelihood function a total of 10 000 randomly parameter combinations within the ranges mentioned above were produced based on the latin hypercube sampling methods li et al 2010 similarly the likelihood function for the parameter combinations that led to no numerical and real solution to eq 17 were removed in further analysis 3 6 evaluation of the improved model in the pearl and yangtze catchments the time series of p pet et q δs and ndvi were artificially divided into two periods 1984 1996 for calibration and 1997 2006 for validation in the 12 karst catchments the p pet etrm q and ndvi were artificially divided into two periods 1982 1994 for calibration and 1994 2000 for validation the six parameters of the improved model and the four parameters of the original model were calibrated using the method mentioned in section 3 5 the performance the two models were evaluated by comparing the modeled and observed or remote sensing based q and et based on correlation analysis and rmse eq 18 note that in the pearl and yangtze catchments the et from pan s dataset pan et al 2012 was used as the observed et etob while in the 12 karst catchments the model performance in et modeling was evaluated by comparing to the etrm remote sensing based et 3 7 linkages between catchment properties and model parameters the relationships among the optimized model parameters and catchment properties including portion of karst landscape pok slope climate elasticity of evapotranspiration were investigated based on correlation and non linear regression analysis in particular the elasticity of evapotranspiration to precipitation ε p and potential evapotranspiration ε e at mean annual scale were calculated based on the budyko method donohue et al 2011 liu et al 2016 19 ɛ p e t p p e t p e t n p n p e t n 20 ɛ e e t p e t p e t e t p n p n p e t n where the e t p e t and p are the long term mean annual et pet and p n is the catchment efficient derived by numerically solving eq 21 21 e t p q p p e t p n p e t n 1 n where q is the long term mean annual runoff 4 results 4 1 identifiability of the model parameters table 3 shows the optimized parameters for the improved and original models fig 3 shows the variation of rmse with variation of the six parameters improved model in the 12 karst catchments clearly though there existing some differences the rmse of the dots at the lower edge firstly decreased and then increased with increase in s mx γ1 ω1 and γ2 fig 3 these indicated that the s mx γ1 ω1 and γ2 were identifiable parameters in the 12 catchments as expected the optimized values red dots of these 4 parameters were generally at the bottom of the scatters fig 3 relatively the ω2 and g 0 were less identifiable because the scatters distributed nearly uniformly fig 3 however the optimizing procedure could constrain their ranges as illustrated in fig 4 in the pearl and yangtze catchments the optimized ω1 and ω2 were 0 70 and 0 25 pearl and 1 29 and 0 28 yangtze respectively table 3 while the statistical ω1 and ω2 by using linear regression were 0 79 and 0 16 pearl and 1 07 and 0 16 yangtze respectively fig 1 the differences between the w t w t δ t p e t t δ t 1 δ t that derived from optimized ω1 and ω2 table 3 and that derived from statistical ω1 and ω2 fig 1 were small fig 4 4 2 performance of the improved model with these parameters the qim q modeled by the improved model generally coincides with the qob observed q fig 5 in the pearl and yangtze catchments the regression coefficients and coefficient of determination r 2 for the linear regression model qim k qob were generally higher than 0 95 in both the calibration and validation fig 5 in all the catchments the correlations between qim and qob r ranged 0 74 to 0 98 and 0 71 and 0 98 in the calibration and validation respectively table 4 the rmse ranged from 6 4 mm month 1 to 24 7 mm month 1 and from 6 5 mm month 1 to 28 2 mm month 1 respectively in the calibration and validation table 4 also the original model could predict runoff well with the correlation rmse between qor q modeled by the original model and qob being slightly higher lower than those for the improved model table 4 meanwhile the correlation between etim et modeled by the improved model and etob observed et were 0 82 calibration and 0 77 validation and 0 98 calibration and 0 98 validation respectively in the pearl and yangtze catchments also the regression coefficients for the linear regression model etim k etob were close to 1 0 in both the calibration and validation fig 6 a d however the original model had relatively larger uncertainties in et modeling especially in the yangtze catchment the original model often underestimated et in summer and overestimated et in winter fig 6g h in the 12 karst catchments the etim was highly and linearly correlated to the etrs remote sensing based et with the r 2 being generally higher than 0 8 fig 7 also the etor et modeled by the original model were highly related to the etrs however the ranges of etor were narrower than those of etim similar to the results in fig 6g h the etor were generally higher and lower than the etim respectively in summer and winter fig 7 this phenomenon also showed some relationships with the cv ndvi coefficient of variation of ndvi the departure between etor and etim seemed to be more obvious in the catchments with larger cv ndvi fig 7 on the other hand we also note that the modeled et by both the models were generally lower than the etrs fig 7 further analysis showed that in these 12 catchments the etrs often exceeds pet fig 8 4 3 relationships among model parameters climate elasticity and catchment properties the s mx was negatively correlated to pok portion of karst landscape with the r 2 being 0 35 r 0 63 α 0 027 fig 9 a meanwhile there existed a power relationship between the water retention efficiency γ1 and slope with the r 2 being 0 47 r 0 69 for γ1 vs slope 0 788 α 0 01 fig 9a other correlations table 5 were generally insignificant α 0 05 however the correlation for γ2 vs slope was also relatively high r 0 50 α 0 08 furthermore the correlations between ε p elasticity of et to p ε e elasticity of et to pet and s mx was 0 60 α 0 04 and 0 60 α 0 04 respectively fig 9b 5 discussion the dynamic budyko model proposed by zhang et al 2008 treats the evapotranspiration efficiency δ t as a constant however at short time scales e g monthly some of the catchment properties are transient especially the vegetation the dynamic vegetation including phenology should affect water partitioning a lot donohue et al 2007 ning et al 2017 this study found a linear relationship eq 17 at monthly scale r 2 were generally higher than 0 7 fig 1 reflecting the interactions among energy water availability and vegetation this relationship means that under a given pet the higher ndvi better vegetation is the higher the et which is highly related to the vegetation growth and production chong et al 1993 schimel et al 1997 however this relationship eq 17 was poor at annual or longer time scales data not shown here mainly due to that the linearly aggregated e g average and sum pet pand ndvi have missed their seasonality information the high correlation for eq 17 evidenced the importance of climate and vegetation seasonality in water energy balance the nonlinear eq 17 was employed for improving the original dynamic budyko model zhang et al 2008 the low rmse and high correlations between the q ob observed q and et ob observed et and the q im q modeled by the improved model and et im et modeled by the improved model in the pearl and yangtze catchments demonstrated the effectiveness of the improved model in q and et modeling figs 5 and 6 table 4 similarly in the 12 karst catchments the high correlations and relatively low rmse illustrated that the improved model could capture well q in karst region table 4 as for et modeling the etim were highly correlated to but were always lower than the etrs remote sensing based et zhang et al 2016 fig 7 however the etim may have higher accuracy than the etrs because the latter often exceeds pet in this region fig 8 relatively the rmse correlation between q im and q ob were slightly lower higher than those between q or q modeled by the original model and q ob indicating that the effectiveness in q modeling of the improved and original models were similar to each other however the larger ranges of etim and higher correlation between etim and etrs indicated the advantages of the improved model in et modeling figs 6 and 7 the original model neglects vegetation dynamics and treats the evapotranspiration efficiency δ t eq 10 as a constant results demonstrated that this treatment brought out underestimation of et in summer and overestimation of et winter figs 6 and 7 especially in catchments with larger vegetation variability e g cv ndvi the coefficient of variation of ndvi fig 7 most importantly each of the parameters in the improved model has a physical interpretation the γ1 is the catchment water retention efficiency a larger smaller γ1 represents more less precipitation retention and less more direct runoff under a given precipitation in the 12 karst catchments the γ1 was highly and negatively related to slope r 0 69 for γ1 vs slope 0 788 α 0 01 fig 9 this is reasonable because high slope means well drained yokoo et al 2008 and therefore less residual precipitation in the catchment xu et al 2013 zhang et al 2008 the ω1 reflects the ecohydrological interactions between vegetation and climate larger ω1 indicates higher sensitivity of et to vegetation there is no clear relationship among ω1 pok and slope table 5 and the vegetation types data not shown here however we deduce that the vegetation types distribution physio ecological properties and the vegetation terrain coupling characteristics might be the control factors for ω1 the recession constant γ2 nathan and mcmahon 1990 zhang et al 2008 representing the outflow rate of groundwater was positively correlated to pok r 0 18 α 0 05 and slope r 0 50 α 0 08 table 5 indicating that larger amount of groundwater could discharge as base flow in catchment with higher pok and steeper terrain this is consistent with other findings price 2011 for example tetzlaff et al 2009 found that in steeper montane regions the transit times tend to be lower previous studies also reported that the influence of topography on base flow is most pronounced in relatively high relief settings such as the karst or highly porous settings devito et al 2005 price 2011 tetzlaff et al 2009 furthermore the smx represents the max available water storage in the vegetation root zone soil and epikarst zone in karst region when there is no precipitation in a period for example in a drought the smx means the max available water for the vegetation generally speaking the vegetation in land with high available water may have better ability to adapt to climate change variability seasonality yokoo et al 2008 the negative correlation between smx and pok r 0 63 α 0 05 fig 9a indicated that ecosystem in karst catchments have relatively lower smx might rely more on precipitation than in non karst catchments this is demonstrated by the negative correlation between ε p elasticity of evapotranspiration to precipitation and smx r 0 60 α 0 04 fig 9b which suggested that a same change increase decrease in p would bring about greater change increase decrease in et in karst region similarly liu et al 2016 also pointed out that karst catchments might exhibit higher degradation stress from climate change than the non karst catchments in southwestern china in fact the smx is a vegetation related parameter zhang et al 2008 and is an overall property controlled by the spatial heterogeneous vegetation terrain coupling in a catchment vegetation types rooting depth properties of soil and epikarst zone could affect smx to some extent for example deep rooted plant e g some native trees may have higher smx while shallow rooted plants e g grass may have lower smx therefore the smx may exhibit strong spatial heterogeneity the relative low correlation 0 63 suggests that pok is just one of the factors affecting smx furthermore we also note that the pok is far from efficient to represent the highly heterogeneous karstic media the porosity position and hydrological connectivity of the fractures conduits and caves soil depth and the hydraulic properties as well as vegetation conditions are key factors affecting the hydrological processes in karst aquifers therefore even the pok in two catchments were the same to each other the parameters of the two catchments would be quite different for example in the catchments no 9 and no 10 with the pok being the same 0 66 the s mx γ1 ω1 and γ2 in no 10 were obviously larger than those in no 9 table 3 beside these uncertainties of the optimized parameters would also affect the reliability of these results results demonstrated that the s mx γ1 ω1 and γ2 were generally identifiable in the 12 karst catchments fig 3 however the sensitivity of runoff to these parameters in different catchments differed from each other fig 3 and even the runoff exhibited insensitivity to some parameters for example the parameters ω2 was relatively non identifiable in this case though the optimizing procedure could constrain their ranges there also existing some differences between the true and the optimized fig 4 these slight differences would affect the optimized results of other parameters nevertheless the paper proposed an improved model with high effectiveness in runoff and evapotranspiration modeling in karst catchments and provided evidences for why the ecosystem in karst catchment is overall fragile and sensitive to climate change 6 summary and conclusion this study improved a dynamic budyko model by linking available water potential evapotranspiration and vegetation ndvi at monthly scale the six parameters including max available water storage s mx evapotranspiration efficiency ω1 and ω2 catchment water retention efficiency γ1 recession constant γ2 and the initial groundwater storage g 0 were calibrated based on monthly runoff by using evolutionary algorithm the performance of the model was evaluated in 14 catchments pearl yangtze and 12 karst catchments and the relationships among model parameters and the catchment properties including the portion of karst landscape pok slope and the climate elasticity of evapotranspiration were analyzed in 12 karst catchments the high correlations generally higher than 0 85 and low rmse root mean square error between observations and simulations in the 14 catchments proved the effectiveness of the improved model in runoff and evapotranspiration modeling relatively the original model could simulate runoff as well as the improved model but exhibited larger uncertainties in et modeling moreover the max available water storage s mx was negatively correlated to pok r 0 63 α 0 05 and the ε p elasticity of evapotranspiration to precipitation r 0 60 α 0 04 and the slope was negatively correlated to the water retention efficiency γ1 r 0 69 α 0 01 and positively correlated to the recession constant γ2 r 0 50 α 0 08 these results indicated that the catchments with higher pok in southwestern china have lower vegetation available water and ecosystem relied more on precipitation acknowledgments this study was supported by the national natural science foundation of china 41571130073 41501042 the open fund of key laboratory of agro ecological processes in subtropical region chinese academy of sciences isa2018302 cas interdisciplinary and the innovation team and youth innovation team project of isa cas 2017qncxtd xxl and the cas interdisciplinary innovation team 
733,karst landscape covers more than 10 of the global land surface and plays an important role in supporting ecosystems and human society may be strongly influenced by climate change vegetation available water vaw is a key variable impacting the sensitivity of ecosystems to a changing environment however vaw in karst region is difficult to determine and remains uncertain this study improved a dynamic budyko type water balance model by introducing a nonlinear equation linking climate vegetation and budyko type water balance this model was calibrated using evolutionary algorithm based on monthly runoff comparison results in the pearl yangtze and 12 karst catchments in south china suggested high effectiveness of this improved model in simulating monthly runoff and evapotranspiration furthermore in the 12 karst catchments the max vaw was negatively correlated to the portion of karst landscape of the catchment pok r 0 63 α 0 027 and the elasticity of evapotranspiration to precipitation r 0 60 α 0 04 these implied that karst catchments with higher pok had lower vaw making the ecosystems rely more on precipitation keywords ecohydrology hydrological modeling water balance budyko framework climate sensitivity 1 introduction karst landscape covers more than 10 of the earth s land surface and has important roles in water supply for human society about 25 of the world population is dependent on karst water to some extent ford and williams 2013 hartmann et al 2014 however owing to the carbonate nature karst landscape is generally characterized by thin soil high infiltration capacity and low water holding capacity liu et al 2012 wilcox et al 2008 williams 2008 and the karst ecosystem often exhibits high vulnerability and sensitivity to changing environment e g climate change human activities fan et al 2011 hou et al 2016 liu et al 2014 liu et al 2016 wang et al 2004 for example huang et al 2013 reported that the npp net primary production in south china generally decreased during 2006 2011 while the magnitude of decrease in npp in karst region was obviously higher than that in non karst region recently liu et al 2016 pointed out that the actual evapotranspiration in karst catchments in southwestern china was more less sensitive to change in precipitation potential evapotranspiration and was exposed to higher degradation stress brought by climate change than that in non karst catchments in facts there are many factors affecting climate sensitivity of ecosystems ning et al 2017 potter et al 2005 yokoo et al 2008 besides the physiological properties of vegetation the vegetation available water vaw is a key factor directly affecting ecosystem resilience milly 1994 potter et al 2005 therefore quantifying vaw is essential in understanding the ecohydrological sensitivity or responses of karst catchments to the changing environment however direct estimates of vaw in karst landscape is still a big challenge to adapt to the environment vegetation in karst landscape may utilize water from both soil and epikarst zone water in cracks conduits depending on the rooting depth nie et al 2012 schwinning 2008 highly weathered rock may have the ability to store high quantities of water querejeta et al 2006 however the solution enlarged fissures cracks and conduits allow rapid transport of water preferential flow hartmann and baker 2017 heilman et al 2014 which can also lead to water bypassing the root zone arbel et al 2010 dasgupta et al 2006 due to the high heterogeneity of the karst critical zone bakalowicz 2005 it is hard to quantify the properties of soil e g depth distribution epikarst e g porosity cracks and vegetation rooted depth which jointly determine the vaw therefore inverse analysis based on ecohydrological models may be an alternative way dorfliger et al 2009 pinault et al 2001 there are many models for karst ecohydrology modeling distributed or lumped on which hartmann et al 2014 provided an excellent review generally distributed models need many parameters which are usually not available in karst region in comparison lumped models require only a small number of parameters and thus are often preferred charlier et al 2012 hartmann et al 2013 jukic and denic jukic 2009 tritz et al 2011 among these models the main differences pertain to the treatments of karstic media evapotranspiration runoff generation and groundwater recharge hartmann et al 2014 hartmann et al 2012 scanlon et al 2003 zhang et al 2011 particularly evapotranspiration in lumped models is often assumed to be a function of the soil water storage hartmann et al 2013 janza 2010 or simply the potential evapotranspiration jukic and denic jukic 2009 tritz et al 2011 ignoring the impacts of vegetation dynamics these treatments would lead to high uncertainties in evapotranspiration modeling in fact these models are mainly used to model rainfall runoff response and karstic aquifer recharge jukic and denic jukic 2009 to model water balance over variable time scales zhang et al 2008 developed a dynamic budyko water balance model budyko 1974 choudhury 1999 yang et al 2008 this model divides the catchment water storage into root zone storage and groundwater storage and assumes that water partitioning among different hydrological components e g runoff evapotranspiration follows the budyko hypothesis zhang et al 2008 this lumped parameter dynamic budyko model has shown good performance in runoff modeling zhang et al 2008 most importantly this model contains several important concepts related to ecohydrological sensitivity however this model also ignores the impacts of dynamic vegetation and its performance in karst region has not been verified the purposes of this study were two fold to improve and validate the dynamic budyko model in runoff and evapotranspiration modeling in karst catchments and to investigate how the karst landscape affects ecohydrological parameters this paper is arranged as follows section 2 introduces the data sources section 3 focuses on the study area and introduces the model and the improvements as well as the methodologies section 4 includes the results section 5 provides our discussion and the conclusion is given in section 6 2 data sources monthly precipitation p potential evapotranspiration pet evapotranspiration et runoff q and change in water storage δs of 32 global large catchments were collected form pan s dataset 1984 2006 pan et al 2012 this dataset is based on multiple sources and has been widely used in previous hydrological studies liu et al 2017 zeng and cai 2016 the normalized difference vegetation index ndvi was derived from the gimms global inventory modeling and mapping studies ndvi3g ndvi version 3 g dataset 1982 2012 anyamba et al 2014 to reflect vegetation monthly natural runoff 1950s 2000 in 12 karst catchments were collected from the changjiang river conservancy commission and zhujiang water resources commission daily meteorological data 1950s 2000 at 32 meteorological stations in the 12 karst catchments were from the china meteorological data service network http www escience gov cn metdata page index html the ceres clouds and the earth s radiant energy system ebaf energy balanced and filled surface fluxes data set 1 1 grid 2000 2014 http ceres larc nasa gov order data php was used to calibrate surface albedo in calculating potential evapotranspiration in the 12 karst catchments mean slope was calculated based on the dem digital elevation model 30 m collected form the data sharing infrastructure of earth system science http www geodata cn portal mdsearch listmetadata jsp category 175 pn 2 meanwhile the remote sensing based evapotranspiration 1981 2012 developed by zhang et al 2016 https data csiro au dap landingpage execution e1s4 was used to evaluate the modeled et in the 12 karst catchments this remote sensing based et was developed based on the pml algorithm leuning et al 2008 and multisource of inputs zhang et al 2016 3 methods 3 1 descriptions of the original dynamic budyko model in the original dynamic budyko model zhang et al 2008 the precipitation p is partitioned into direct runoff qd and other water components x which includes the ground water recharge r root zone storage change δs and evapotranspiration et 1 p t q d t x t where the subscripts t means the corresponding component in period t and x t can be considered as catchment water retention the potential max catchment water retention is 2 x 0 t s m x s t 1 p e t t where pet t is the potential evapotranspiration s t 1 is the residual available water in the preceding period t 1 and smx is the max vegetation available water vaw in karst region where vegetation can utilize water in soil and bedrock e g cracks nie et al 2012 schwinning 2008 the smx represents the total max vaw in both soil and the epikarst zone assuming that the water partitioning between precipitation p t and catchment water retention x t follows the budyko hypothesis budyko 1974 choudhury 1999 x t can be calculated as 3 x t p t x 0 t p t γ 1 x 0 t γ 1 1 γ 1 where γ1 is the catchment water retention efficiency therefore based on water balance the direct runoff can be calculated as 4 q d t p t x t in period t the total available water w t is the sum of the residual water storage s t 1 and the catchment water retention x t 5 w t x t s t 1 the total available water w t would provide water for evapotranspiration recharge root zone water storage and groundwater 6 w t e t t s t r t where et t is the evapotranspiration s t is the root zone water storage and r t is the groundwater recharge in period t defining that the evapotranspiration opportunity y t as sankarasubramanian and vogel 2002 7 y t e t t s t then the potential max evapotranspiration opportunity is the sum of potential evapotranspiration and the max vegetation available water 8 y 0 t p e t t s m x likely assuming that water partitioning between w t and y t follows the budyko hypothesis y t can be described as 9 y t w t y 0 t w t δ t y 0 t δ t 1 δ t within the y t the et t is calculated as 10 e t t w t p e t t w t δ t p e t t δ t 1 δ t where the δ t represents the evapotranspiration efficiency then based on eqs 5 7 the groundwater recharge r t and root zone water storage change δs t can be calculated as 11 r t w t e t t s t w t y t 12 δ s t s t s t 1 y t e t t s t 1 finally the groundwater storage g t is treated as a linear reservoir and the base flow q b t is modeled as 13 q b t γ 2 g t 1 where γ2 is a constant representing the outflow rate of groundwater recession constant therefore the groundwater storage g t in period t is 14 g t 1 γ 2 g t 1 r t where q b t is the base flow g t is the groundwater storage all the abbreviations are summarized in table 1 3 2 improving the model by linking evapotranspiration and vegetation the original dynamic budyko model treats the evapotranspiration efficiency δ t eq 10 as a constant zhang et al 2008 however many studies reported that vegetation dynamics including phenology and climate seasonality controlled water partitioning milly and shmakin 2002 ning et al 2017 potter et al 2005 for example eq 15 is widely used to model plant water uptake at sub annual scale feddes et al 1978 liu et al 2013 somma et al 1998 vrugt et al 2001 15 e t φ β 1 e k l a i t p φ β 1 e k l a i k c e t 0 where kc is the crop coefficient et 0 is the reference evapotranspiration k is the radiation extinction coefficient and lai is the leaf area index eq 15 shows that evapotranspiration is proportional to potential evapotranspiration penman 1948 yang et al 2006 similarly the choudhury s equation eq 10 can be considered as a proportional relationship between et t and pet t choudhury 1999 16 e t t w t w t δ t p e t t δ t 1 δ t p e t t the φ β 1 e k lai kc in eq 15 is closely related to vegetation because the β and lai represent the roots and canopy properties kc has clear seasonal variation with vegetation growth allen et al 1998 and φ reflect the water stress therefore term w t w t δ t p e t t δ t 1 δ t in eq 16 could reflect vegetation conditions like the term φ β 1 e k lai kc in eq 15 based on the gimms ndvi3g dataset and the water budget dataset developed by pan et al 2012 there is a linear relationship between w t w t δ t p e t t δ t 1 δ t and ndvi 17 w t w t δ t p e t t δ t 1 δ t p t δ s t p t δ s t δ t p e t t δ t 1 δ t ω 1 n d v i t ω 2 where δs is the changes in water storage ω1 is the slope and ω2 is an constant the determination coefficient r 2 for eq 17 being generally higher than 0 7 8 out of the 12 catchments fig 1 thus eq 17 was used to link vegetation ndvi t water supply w t energy pet t and evapotranspiration efficiency δ t for improving the original model the main difference between the improved and the original model is that in the original model the δ t is a constant while in the improved model the δ t is the solution of eq 17 and depends on vegetation ndvi available water w t and energy pet t 3 3 study area the performance of the original and improved models were evaluated in the pearl yangtze and 12 karst catchments in south china fig 2 the 12 karst catchments which are belong to the pearl no 9 11 and yangtze no 1 8 and 12 catchments and cover totally about 11 5 104 km2 are located in guizhou guangxi and yunnan provinces in southwestern china where is dominated by karst terrains liu et al 2016 zhang et al 2014 and subtropical monsoon climate the drainage area of the 12 karst catchments ranges from 0 23 104 km2 to 2 29 104 km2 table 2 the portion of karst landscape pok areakarst areab where areakarst is the karst landscape area and areab is the catchment area ranges from 0 52 to 0 95 mean of 0 74 the slope ranges from 0 32 to 0 67 mean of 0 44 table 2 the ranges for aridity index pet p annual ndvi runoff coefficient qc runoff precipitation are 0 74 1 16 mean of 0 85 0 47 0 57 mean of 0 54 and 0 46 0 65 mean of 0 53 respectively table 2 the cv ndvi coefficient of variation of the monthly ndvi during 1982 2000 ranges from 0 21 to 0 32 table 2 note that there were two reasons for calibrating and validating the original and improved models in the pearl and yangtze catchments first the 12 karst catchments are located in these two big catchments and therefore have the similar climate second the catchment scale et series in the two catchments can be collected from the pan s dataset pan et al 2012 though uncertainties may still exist the et data in pan s dataset would be close to the trues because they are based on multiple sources of data and assimilation techniques pan et al 2012 of course the catchment scale et can also be derived from remote sensing technique however some uncertainties of the remote sensing based et were found in this region see the fig 8 in section 4 2 therefore based on the pan s et series we could quantify the performance of the original and improved models in et modeling with more confidence 3 4 data preparation in the 12 karst catchments the pet were calculated using the penman method penman 1948 in which the solar radiation were estimated using the angstrom equation allen et al 1998 and the surface albedo were calibrated using ceres ebaf surface fluxes details can be found in liu et al 2016 catchment scale monthly p pet and etrm remote sensing based et were calculated by arithmetically averaging the monthly data at all stations grids in each catchment the monthly p and pet were aggregated from daily values in the 12 karst catchments while in the pearl and yangtze catchments the monthly p et and pet were directly collected form pan s dataset 1984 2006 pan et al 2012 in all the catchments the monthly ndvi were calculated by arithmetically averaging the monthly data at all grids in each catchment owing to the different time coverages the q p pet ndvi and etrm et were constrained to the period 1982 2000 for the 12 karst catchments and 1984 2006 for the pearl and yangtze catchments 3 5 parameters optimization and their identifiability there are six parameters need to be calibrated the smx max vaw γ1 water retention efficiency ω1 slope in eq 17 ω2 constant in eq 17 γ2 recession constant and g 0 the initial groundwater storage here these parameters were calibrated based on monthly runoff by using the evolutionary algorithm the evolutionary algorithms are considered to be robust globally oriented and generally more straightforward to apply in situations where there is little or no a priori knowledge evolutionary algorithms have been widely used in parameter optimization for hydrological models cheng et al 2002 duan et al 1992 tang et al 2005 wang 1991 here the objective function was designed as 18 r m s e i 1 n q m i q o b i 2 n where rmse is the root mean square error q m i is the modeled runoff at time i q ob i is the observed runoff at time i n is the number of observations the calibration was performed by using the geatbx genetic and evolutionary algorithm toolbox for matlab pohlheim 2006 the geatbx contains many variants of genetic algorithms and genetic programming and can provide many optimization capabilities pohlheim 2006 details of this matlab based toolbox can be found in pohlheim 2006 in the calibration the parameter ranges for the smx γ1 ω1 ω2 γ2 and g 0 were set to be lower upper 0 500 mm 0 5 dimensionless 0 5 dimensionless 0 5 to 1 dimensionless 0 1 mm 1 month 1 and 0 500 mm respectively meanwhile the number of individuals per subpopulations nind maximum number of generations maxgen generation gap ggap as well as precision of binary representation preci were set to be 35 100 0 6 and 10 the calibration procedure was repeated 10 000 times in each catchment and the parameters that produced the minimum rmse eq 18 were used as the final results note that in the optimization the evolutionary algorithms may give some initial assignments such that there is no numerical and real solution to eq 17 in this case the objective function eq 18 was assigned a very large value e g 9999 meanwhile the identifiability of the model parameters was analyzed by using the famous generalized likelihood uncertainty estimation glue method beven and binley 1992 ortiz et al 2011 stedinger et al 2008 sun et al 2016 in the analysis the rmse eq 18 was also used as the likelihood function a total of 10 000 randomly parameter combinations within the ranges mentioned above were produced based on the latin hypercube sampling methods li et al 2010 similarly the likelihood function for the parameter combinations that led to no numerical and real solution to eq 17 were removed in further analysis 3 6 evaluation of the improved model in the pearl and yangtze catchments the time series of p pet et q δs and ndvi were artificially divided into two periods 1984 1996 for calibration and 1997 2006 for validation in the 12 karst catchments the p pet etrm q and ndvi were artificially divided into two periods 1982 1994 for calibration and 1994 2000 for validation the six parameters of the improved model and the four parameters of the original model were calibrated using the method mentioned in section 3 5 the performance the two models were evaluated by comparing the modeled and observed or remote sensing based q and et based on correlation analysis and rmse eq 18 note that in the pearl and yangtze catchments the et from pan s dataset pan et al 2012 was used as the observed et etob while in the 12 karst catchments the model performance in et modeling was evaluated by comparing to the etrm remote sensing based et 3 7 linkages between catchment properties and model parameters the relationships among the optimized model parameters and catchment properties including portion of karst landscape pok slope climate elasticity of evapotranspiration were investigated based on correlation and non linear regression analysis in particular the elasticity of evapotranspiration to precipitation ε p and potential evapotranspiration ε e at mean annual scale were calculated based on the budyko method donohue et al 2011 liu et al 2016 19 ɛ p e t p p e t p e t n p n p e t n 20 ɛ e e t p e t p e t e t p n p n p e t n where the e t p e t and p are the long term mean annual et pet and p n is the catchment efficient derived by numerically solving eq 21 21 e t p q p p e t p n p e t n 1 n where q is the long term mean annual runoff 4 results 4 1 identifiability of the model parameters table 3 shows the optimized parameters for the improved and original models fig 3 shows the variation of rmse with variation of the six parameters improved model in the 12 karst catchments clearly though there existing some differences the rmse of the dots at the lower edge firstly decreased and then increased with increase in s mx γ1 ω1 and γ2 fig 3 these indicated that the s mx γ1 ω1 and γ2 were identifiable parameters in the 12 catchments as expected the optimized values red dots of these 4 parameters were generally at the bottom of the scatters fig 3 relatively the ω2 and g 0 were less identifiable because the scatters distributed nearly uniformly fig 3 however the optimizing procedure could constrain their ranges as illustrated in fig 4 in the pearl and yangtze catchments the optimized ω1 and ω2 were 0 70 and 0 25 pearl and 1 29 and 0 28 yangtze respectively table 3 while the statistical ω1 and ω2 by using linear regression were 0 79 and 0 16 pearl and 1 07 and 0 16 yangtze respectively fig 1 the differences between the w t w t δ t p e t t δ t 1 δ t that derived from optimized ω1 and ω2 table 3 and that derived from statistical ω1 and ω2 fig 1 were small fig 4 4 2 performance of the improved model with these parameters the qim q modeled by the improved model generally coincides with the qob observed q fig 5 in the pearl and yangtze catchments the regression coefficients and coefficient of determination r 2 for the linear regression model qim k qob were generally higher than 0 95 in both the calibration and validation fig 5 in all the catchments the correlations between qim and qob r ranged 0 74 to 0 98 and 0 71 and 0 98 in the calibration and validation respectively table 4 the rmse ranged from 6 4 mm month 1 to 24 7 mm month 1 and from 6 5 mm month 1 to 28 2 mm month 1 respectively in the calibration and validation table 4 also the original model could predict runoff well with the correlation rmse between qor q modeled by the original model and qob being slightly higher lower than those for the improved model table 4 meanwhile the correlation between etim et modeled by the improved model and etob observed et were 0 82 calibration and 0 77 validation and 0 98 calibration and 0 98 validation respectively in the pearl and yangtze catchments also the regression coefficients for the linear regression model etim k etob were close to 1 0 in both the calibration and validation fig 6 a d however the original model had relatively larger uncertainties in et modeling especially in the yangtze catchment the original model often underestimated et in summer and overestimated et in winter fig 6g h in the 12 karst catchments the etim was highly and linearly correlated to the etrs remote sensing based et with the r 2 being generally higher than 0 8 fig 7 also the etor et modeled by the original model were highly related to the etrs however the ranges of etor were narrower than those of etim similar to the results in fig 6g h the etor were generally higher and lower than the etim respectively in summer and winter fig 7 this phenomenon also showed some relationships with the cv ndvi coefficient of variation of ndvi the departure between etor and etim seemed to be more obvious in the catchments with larger cv ndvi fig 7 on the other hand we also note that the modeled et by both the models were generally lower than the etrs fig 7 further analysis showed that in these 12 catchments the etrs often exceeds pet fig 8 4 3 relationships among model parameters climate elasticity and catchment properties the s mx was negatively correlated to pok portion of karst landscape with the r 2 being 0 35 r 0 63 α 0 027 fig 9 a meanwhile there existed a power relationship between the water retention efficiency γ1 and slope with the r 2 being 0 47 r 0 69 for γ1 vs slope 0 788 α 0 01 fig 9a other correlations table 5 were generally insignificant α 0 05 however the correlation for γ2 vs slope was also relatively high r 0 50 α 0 08 furthermore the correlations between ε p elasticity of et to p ε e elasticity of et to pet and s mx was 0 60 α 0 04 and 0 60 α 0 04 respectively fig 9b 5 discussion the dynamic budyko model proposed by zhang et al 2008 treats the evapotranspiration efficiency δ t as a constant however at short time scales e g monthly some of the catchment properties are transient especially the vegetation the dynamic vegetation including phenology should affect water partitioning a lot donohue et al 2007 ning et al 2017 this study found a linear relationship eq 17 at monthly scale r 2 were generally higher than 0 7 fig 1 reflecting the interactions among energy water availability and vegetation this relationship means that under a given pet the higher ndvi better vegetation is the higher the et which is highly related to the vegetation growth and production chong et al 1993 schimel et al 1997 however this relationship eq 17 was poor at annual or longer time scales data not shown here mainly due to that the linearly aggregated e g average and sum pet pand ndvi have missed their seasonality information the high correlation for eq 17 evidenced the importance of climate and vegetation seasonality in water energy balance the nonlinear eq 17 was employed for improving the original dynamic budyko model zhang et al 2008 the low rmse and high correlations between the q ob observed q and et ob observed et and the q im q modeled by the improved model and et im et modeled by the improved model in the pearl and yangtze catchments demonstrated the effectiveness of the improved model in q and et modeling figs 5 and 6 table 4 similarly in the 12 karst catchments the high correlations and relatively low rmse illustrated that the improved model could capture well q in karst region table 4 as for et modeling the etim were highly correlated to but were always lower than the etrs remote sensing based et zhang et al 2016 fig 7 however the etim may have higher accuracy than the etrs because the latter often exceeds pet in this region fig 8 relatively the rmse correlation between q im and q ob were slightly lower higher than those between q or q modeled by the original model and q ob indicating that the effectiveness in q modeling of the improved and original models were similar to each other however the larger ranges of etim and higher correlation between etim and etrs indicated the advantages of the improved model in et modeling figs 6 and 7 the original model neglects vegetation dynamics and treats the evapotranspiration efficiency δ t eq 10 as a constant results demonstrated that this treatment brought out underestimation of et in summer and overestimation of et winter figs 6 and 7 especially in catchments with larger vegetation variability e g cv ndvi the coefficient of variation of ndvi fig 7 most importantly each of the parameters in the improved model has a physical interpretation the γ1 is the catchment water retention efficiency a larger smaller γ1 represents more less precipitation retention and less more direct runoff under a given precipitation in the 12 karst catchments the γ1 was highly and negatively related to slope r 0 69 for γ1 vs slope 0 788 α 0 01 fig 9 this is reasonable because high slope means well drained yokoo et al 2008 and therefore less residual precipitation in the catchment xu et al 2013 zhang et al 2008 the ω1 reflects the ecohydrological interactions between vegetation and climate larger ω1 indicates higher sensitivity of et to vegetation there is no clear relationship among ω1 pok and slope table 5 and the vegetation types data not shown here however we deduce that the vegetation types distribution physio ecological properties and the vegetation terrain coupling characteristics might be the control factors for ω1 the recession constant γ2 nathan and mcmahon 1990 zhang et al 2008 representing the outflow rate of groundwater was positively correlated to pok r 0 18 α 0 05 and slope r 0 50 α 0 08 table 5 indicating that larger amount of groundwater could discharge as base flow in catchment with higher pok and steeper terrain this is consistent with other findings price 2011 for example tetzlaff et al 2009 found that in steeper montane regions the transit times tend to be lower previous studies also reported that the influence of topography on base flow is most pronounced in relatively high relief settings such as the karst or highly porous settings devito et al 2005 price 2011 tetzlaff et al 2009 furthermore the smx represents the max available water storage in the vegetation root zone soil and epikarst zone in karst region when there is no precipitation in a period for example in a drought the smx means the max available water for the vegetation generally speaking the vegetation in land with high available water may have better ability to adapt to climate change variability seasonality yokoo et al 2008 the negative correlation between smx and pok r 0 63 α 0 05 fig 9a indicated that ecosystem in karst catchments have relatively lower smx might rely more on precipitation than in non karst catchments this is demonstrated by the negative correlation between ε p elasticity of evapotranspiration to precipitation and smx r 0 60 α 0 04 fig 9b which suggested that a same change increase decrease in p would bring about greater change increase decrease in et in karst region similarly liu et al 2016 also pointed out that karst catchments might exhibit higher degradation stress from climate change than the non karst catchments in southwestern china in fact the smx is a vegetation related parameter zhang et al 2008 and is an overall property controlled by the spatial heterogeneous vegetation terrain coupling in a catchment vegetation types rooting depth properties of soil and epikarst zone could affect smx to some extent for example deep rooted plant e g some native trees may have higher smx while shallow rooted plants e g grass may have lower smx therefore the smx may exhibit strong spatial heterogeneity the relative low correlation 0 63 suggests that pok is just one of the factors affecting smx furthermore we also note that the pok is far from efficient to represent the highly heterogeneous karstic media the porosity position and hydrological connectivity of the fractures conduits and caves soil depth and the hydraulic properties as well as vegetation conditions are key factors affecting the hydrological processes in karst aquifers therefore even the pok in two catchments were the same to each other the parameters of the two catchments would be quite different for example in the catchments no 9 and no 10 with the pok being the same 0 66 the s mx γ1 ω1 and γ2 in no 10 were obviously larger than those in no 9 table 3 beside these uncertainties of the optimized parameters would also affect the reliability of these results results demonstrated that the s mx γ1 ω1 and γ2 were generally identifiable in the 12 karst catchments fig 3 however the sensitivity of runoff to these parameters in different catchments differed from each other fig 3 and even the runoff exhibited insensitivity to some parameters for example the parameters ω2 was relatively non identifiable in this case though the optimizing procedure could constrain their ranges there also existing some differences between the true and the optimized fig 4 these slight differences would affect the optimized results of other parameters nevertheless the paper proposed an improved model with high effectiveness in runoff and evapotranspiration modeling in karst catchments and provided evidences for why the ecosystem in karst catchment is overall fragile and sensitive to climate change 6 summary and conclusion this study improved a dynamic budyko model by linking available water potential evapotranspiration and vegetation ndvi at monthly scale the six parameters including max available water storage s mx evapotranspiration efficiency ω1 and ω2 catchment water retention efficiency γ1 recession constant γ2 and the initial groundwater storage g 0 were calibrated based on monthly runoff by using evolutionary algorithm the performance of the model was evaluated in 14 catchments pearl yangtze and 12 karst catchments and the relationships among model parameters and the catchment properties including the portion of karst landscape pok slope and the climate elasticity of evapotranspiration were analyzed in 12 karst catchments the high correlations generally higher than 0 85 and low rmse root mean square error between observations and simulations in the 14 catchments proved the effectiveness of the improved model in runoff and evapotranspiration modeling relatively the original model could simulate runoff as well as the improved model but exhibited larger uncertainties in et modeling moreover the max available water storage s mx was negatively correlated to pok r 0 63 α 0 05 and the ε p elasticity of evapotranspiration to precipitation r 0 60 α 0 04 and the slope was negatively correlated to the water retention efficiency γ1 r 0 69 α 0 01 and positively correlated to the recession constant γ2 r 0 50 α 0 08 these results indicated that the catchments with higher pok in southwestern china have lower vegetation available water and ecosystem relied more on precipitation acknowledgments this study was supported by the national natural science foundation of china 41571130073 41501042 the open fund of key laboratory of agro ecological processes in subtropical region chinese academy of sciences isa2018302 cas interdisciplinary and the innovation team and youth innovation team project of isa cas 2017qncxtd xxl and the cas interdisciplinary innovation team 
734,previous studies of bedform induced hyporheic flow focused on processes driven by longitudinal hydraulic head variations at the sediment water interface swi due to river flow and bedform interactions by way of numerical simulations we examined the transverse hyporheic flow in a river system with compound sections comprising a main river channel and a floodplain connected by a bank the results show that head fluctuations across the compound beds associated with the transverse secondary flow can cause significant lateral hyporheic flow through two pore water circulating cells such a 2 d compound bedfrom have a higher flux across the swi than the 2 d longitudinal dunes since the 2 d compound cross section form induces more drag the circulating flow cells originate from the bank surface and terminate at the main channel and floodplain bed surfaces respectively the hyporheic exchange concentrates on the bank region below the swi where an intensive solute transfer concurrently occurred the head gradient along the swi is sensitive to the bank slope angle which consequently determines transverse hyporheic flow dynamics and solute transport processes larger bank slope angles induce higher hyporheic fluxes and smaller hyporheic areas and residence time the effects of increasing flux on solute transport in the compound section are partly influenced by a sharply decreasing hyporheic area thus the solute consequently transfers downward within the hyporheic zone with a lower rate at larger bank slope angle larger river discharges may promote both the transverse hyporheic flow and solute transformation across the bed surface these physical processes may have implications for the biogeochemical processing within the hyporheic zone across a compound river system keywords hyporheic zone surface water groundwater interaction compound channels bank slopes secondary currents notation x y z axes in the longitudinal along stream vertical and transverse directions respectively θ bank slope angle a area of streambed area enclosed by streamline and the swi l2 ab total area of the riverbed area l2 b width of the compound channel l b width of the main river channel l b projected length of the sloping bank l l compound channel length l dm bed thickness below the main river channel l df bed thickness below the floodplain l hm depth of river water for the main river channel l hf depth of river water for the floodplain l u v w time averaged river water flow velocity along x y z direction respectively lt 1 umax maximum streamwise water river flow velocity lt 1 uave average streamwise river water flow velocity lt 1 u i river water flow velocity fluctuations along xi lt 1 ct solute concentration in river water ml 3 c0 initial solute concentration in river water ml 3 c solute concentration in pore water ml 3 n unit vector normal to the bed surface pointing outward l h hydraulic head l p fluid pressure ml 1 t 2 e elevation with the bottom boundary of pore water domain set as the datum l κ the intrinsic permeability of the sand bed l2 k hydraulic conductivity for the streambed sand lt 1 η bulk porosity of sand bed ρ fluid density ml 3 μ dynamic fluid viscosity ml 1t 1 lc bedform stoss length defined in literature l db bed depth defined in additional simulations l hsw depth of river water defined in additional simulations l vs secondary flow velocity lt 1 vsmax maxima of secondary flow velocity lt 1 hmax maxima of the hydraulic head along the sediment water interface in connecting regions l hmin minima of the hydraulic head along the sediment water interface in connecting regions l hint difference between the head maxima hmax and the head minima hmin along the swi in connecting regions l q total volumetric flux through the swi computed by integrating the magnitude of normal interfacial flux along the swi enclosed by the streamlines l3t 1 q hyporheic flux through the hyporheic zone lt 1 qint normalized effective flux density m total amount of solute accumulation in the bed per unit length ml 1 m normalized total amount of solute accumulation in the bed per unit length dm pore water molecular diffusion coefficient l2t 1 dij pore water 2 d hydrodynamic dispersion coefficient tensor components l2t 1 αl longitudinal dispersivity l αt transverse dispersivity l ui pore water flow velocity lt 1 cc ij convective term in the reynolds stress transport equation dt ij turbulent diffusion term in the reynolds stress transport equation dl ij molecular viscous diffusion term in the reynolds stress transport equation τ ij production term of stress in the reynolds stress transport equation ϕij pressure strain term in the reynolds stress transport equation εij dissipation term in the reynolds stress transport equation fij production term of system rotation μt turbulent viscosity coefficient ml 1t 1 k turbulent kinetic energy l2t 2 ε turbulent dissipation rate l2t 3 eijk alternating symbol δij kronecker delta function ω characteristic swirl number 1 introduction the hyporheic zone is broadly defined as a transition zone beneath and adjacent to a river in riverbeds riverbanks and riparian corridors and floodplains where surface water and groundwater mix krause et al 2009 the hyporheic zone typically exhibits complex characteristics that are affected by various physical chemical and biological processes bencala 1984 huettel et al 1996 krause et al 2009 precht et al 2004 recent studies have shown that the hyporheic zone plays an important role in many river ecosystems exchange of water between the two different water bodies facilitates important transport of nutrient pollutant energy heat biota and carbon within these systems cardenas 2006 cardenas and wilson 2007b hill et al 1998 packman and brooks 2001 the exchange affects river water quality and ecology linked to nutrient cycling and carbon fluxes as well as the distribution and abundance of organisms in the overlying river water and hyporheic zone boulton et al 1998 groffman et al 2005 a better understanding of the mechanism that underlies hyporheic exchange assists studies of nutrients and toxic contaminants in rivers and the management of the river ecosystem in natural rivers hyporheic exchange occurs not only vertically but also laterally through the bed which typically have a compound cross section banzhaf et al 2011 boulton et al 2010 butturini et al 2002 gerecht et al 2011 trauth et al 2013 xia et al 2013 such cross section consists of a main river channel where discharge takes place all the time and adjacent floodplain which gets dry during droughts fig 1 a knight and demetriou 1983 pezzinga 1994 shiono and knight 1991 yang et al 2014 the compound shaped bedforms can induce head gradients in the across river direction within the floodplain which in turn alter the spatial extent of hyporheic zone and thus greatly influence the hyporheic flow banzhaf et al 2011 chen et al 2015 a key mechanism of hyporheic exchange in natural rivers is provided by riverbed morphologic features such as bedforms bottacin busolin and marion 2010 cardenas and wilson 2007a packman et al 2004 experiments and numerical simulations have been conducted to describe the topography driven hyporheic flow in porous media based on flume experiments elliott and brooks 1997 packman et al 2004 thibodeaux and boyle 1987 researchers have previously investigated hyporheic flow induced by dune shaped bedform their results demonstrated that flow over bedforms induces additional pressure gradients which generates significant advective flows within the beds packman et al 2004 solute transport through the streambed follows a circulating flow path which enters the streambed from the bedform s stoss face and exits to the water column on the lee face cardenas and wilson 2007a 2007b and salehin 2004 simulated 2 d pore water flow in a bed with triangular bedforms in which the turbulent flow in the water column was sequentially coupled to darcian porous media flow via the pressure distribution along the swi their results proved that flow bedform interactions induced hydraulic head gradients at the swi which in turn generates pore water circulation through the bed producing an exchange flux this process of advective pumping is well understood to regulate hyporheic fluxes and residence times another important mechanism causing hyporheic flow is turbulence diffusion across the concentration boundary layer bottacin busolin 2017 cardenas 2015 packman et al 2004 roche et al 2018 shimizu and tsujimoto 1990 turbulent eddies penetrate across the high permeable coarse gravel riverbeds and drives momentum flux below the interface which may dominate the hyporheic exchange in a thin layer of flat riverbeds blois et al 2012 king et al 2009 roche et al 2018 the exchange rate is found to be proportional to the square of the characteristic bed sediment size packman et al 2004 such vertical turbulence induced momentum transfer is most intense near the swi and decreases with depth in sediments breugem et al 2006 packman et al 2004 vollmer et al 2002 in these instances effects of river turbulent transport on biogeochemical processes such as hyporheic denitrification have been addressed in recent works bottacin busolin 2017 grant et al 2018 li et al 2017 their results suggested rapid flushing of the highly bioactive region formed near the swi due to high turbulent activity across the swi which significantly speeds up nutrient removal from the river to the grained sediment li et al 2017 the turbulence induced hyporheic exchange is more likely to dominate in flat beds of high permeability coarse grained riverbeds and influence a very thin region of the riverbeds chandler et al 2016 packman et al 2004 roche et al 2018 shimizu and tsujimoto 1990 voermans et al 2017 the head induced convection still tends to be the major form of hyporheic exchange through low permeability beds covered by diverse bedforms where the effects of turbulent diffusion near the swi was relatively minor boano et al 2014 jin 2009 however previous studies of bedform induced hyporheic flow largely concentrated on the processes in the longitudinal direction i e hyporheic flow and associated solute transport driven by longitudinal hydraulic head gradients at the swi their results have allowed for prediction of vertical hyporheic fluxes and residence times through the hyporheic zone elliott and brooks 1997 marion et al 2002 packman and brooks 2001 packman et al 2000 ren and packman 2005 wörman et al 2007 only a few studies have analyzed laterally hyporheic exchange in a river cross section induced by the bedform typically in a compound cross section banzhaf et al 2011 boano et al 2008 gerecht et al 2011 parsons and best 2013 trauth et al 2013 which is clearly different from the dune shaped bedforms fig 1a in a compound river system the water in the main river channel flows out of the bank onto the adjacent floodplain during floods owing to the variation in the cross sectional shape and different roughness between the main river channel and the floodplain the faster moving water in the main river channel interacts with slower moving water on the floodplain this causes lateral momentum transport between the main river channel and floodplain generating a large shear layer with complex transverse flow structures in the form of longitudinal vortexes secondary currents near the connecting bank knight and hamed 1984 knight and sellin 1987 shiono and knight 1991 tominaga and nezu 1991 fig 1a compared to the dunes this different flow behaviours secondary currents over compound shaped beds would result in a different head gradient pattern over the interface in the transverse direction which in turn generates transverse hyporheic flow in the riverbeds and adjacent floodplains fig 1b furthermore variations in shapes of compound cross sections will make a difference in formation of vortex zones and stagnation points xiao et al 2017 it will greatly affect head distribution and hyporheic flow pattern which have not yet been adequately investigated in previous studies gerecht et al 2011 trauth et al 2013 several studies often supported by field observations and numerical simulations have investigated the transverse hyporheic exchange but within a limited context most of them described the transverse exchange via comparing the hydrologic linkage between the main river channel and its adjacent floodplains for example banzhaf et al 2011 carried out field observations with gauged surface water levels and groundwater levels in the riverbank of an alluvial stream under different aquifer conditions their studies illustrated that the solute enters the riverbank via the stream and for this reason they pointed out the occurrence of transverse hyporheic exchange between the riverbeds and the riverbanks gerecht et al 2011 observed the dynamic head variation across a bed to bank transect over a dam storage release cycle their results illustrated a decreasing trend of the hyporheic exchange flux and time with the increasing distance from the bank these studies proved the presence of transverse exchange but did not investigate the underlying hydrodynamic processes of the system either in the water column or within the sediments it has been recognised the hyporheic flux and residence time determine the delivery of solutes and the rate and spatial extent of biogeochemical processes between the main river channel and the floodplain knowledge of flow path and water flux as well as its residence time through the compound transect is required in order to better understand the hydrodynamics on this scale langhoff et al 2006 wroblicky et al 1998 trauth et al 2013 filled partly this knowledge gap through a study of 3 d hyporheic exchange in a pool riffle stream based on numerical simulations their models illustrated a complex hydraulic head distribution along the swi that leads to lateral hyporheic flow affected by both longitudinally and laterally distributed dune shaped bedform nevertheless a systematic and comprehensive investigation focused on the transverse hyporheic flow depends on the 2 d cross channel bed topography in a compound shape is still lacking since it is challenging to design appropriate flume experiments of the sediment water interface numerical simulations have proven to be a viable way to help improve our mechanistic understanding of hydrodynamics and biogeochemistry in complex nature of turbulent flow over 3 d bedforms and the induced hyporheic flow in these simulations a multiphysics computational fluid dynamics cfd approach of cardenas and wilson 2007a 2007b sawyer et al 2011 and also janssen et al 2012 was widespreadly used the river flow over bed morphologies and the resulting pressure along the bed surface can be most accurately simulated using the cfd codes that solve the full navier stokes equations bardini et al 2012 cardenas and wilson 2007c packman et al 2004 tonina and buffington 2009 these flow simulations can efffecitvely decribe the normal reynolds stresses and flow in the transverse direction secondary flow resulted from the anisotropy of normal stresses jing et al 2009 xiao et al 2017 to improve our understanding of transverse hyporheic exchange and underlying processes induced by compound shaped bedform we firstly conducted numerical simulations of 3 d overbank river flows through a compound channel using a 3 d cfd code this 3 d river water flow is sequentially coupled to 2 d pore water flow in the riverbed cross section via head gradients at the swi generated by the transverse secondary flow hyporheic flow scenarios for six different bedform geometry bank slope angle were systematically evaluated for different river discharges longitudinal mean flow the analysis focused on river water flow structures hyporheic flow patterns exchange fluxes across the bed surface and advective transit time as well as the solute transport in the bed additional numerical simulations were also conducted to make a comparison with the longitudinal hyporheic exchange through these simulations we are able to systematically address the following unexplored questions 1 what are the hydrodynamic processes of transverse hyporheic exchange in the transect of a compound river system 2 how variations in geometric shapes of the compound cross section and river discharge affect the transverse hyporheic flow and solute transport in a compound river system and 3 how important this transverse hyporheic flow dynamics are compared with the longitudinal hyporheic flow in a river system the results also contribute to growing experimental data on transverse hyporheic exchange processes and solute transport in the cross section of a compound river system 2 methodology 2 1 model geometry and parameterization compound shaped topography in the numerical model was represented by a simplified approximation of a straight prismatic two stage compound channel comprising a main river channel two floodplains and a sloping bank due to the symmetric bed configurations along the river centre only one half of the channel was included in the modelling domain fig 2 significantly reducing calculation times we used six different river water flow domains in which the channel morphology differs by the bank slope angle θ varying from 25 to 30 45 60 75 and 90 in all simulations the compound channel had a length l of 19 m a width b of 1 6 m a constant slope of 1 16 10 3 was assigned to the channel morphology which was close to the values used by knight and shiono 1990 0 966 10 3 as well as shiono and knight 1991 1 027 10 3 the depth of overlying water for the main river channel hm and floodplain hf were respectively referred to 0 3 m and 0 15 m in order to fully submerge the main river channel and the connecting bank to reproduce overbank flow scenarios knight and sellin 1987 shiono and knight 1991 tominaga and nezu 1991 the thickness of the bed below the main river channel dm and the floodplain df were respectively 0 85 m and 1 0 m in the simulations three different river flow discharge scenarios for each channel morphology were performed table 1 which were in the range of values used in previous studies cardenas and wilson 2007a knight and shiono 1990 shen et al 1990 trauth et al 2013 the numerical conditions are listed in table 1 2 2 numerical modeling and boundary conditions the river flow over the compound channel and pore water flow and solute transport in the bed were simulated following the computational fluid dynamics cfd approach of cardenas and wilson 2007a in which a one way sequential coupling method was used and has been shown to be robust chen et al 2015 jin et al 2010 trauth et al 2013 first the steady state 3 d overbank flows through the compound channel were simulated from which the associated fluid pressure at the bed surface over the middle cross section was determined and subsequently used for pore water flow simulations fig 2a then a steady state 2 d across the bed in the middle reach of the channel was modelled this 2 d pore water flow was driven by the combined effects of cfd derived interfacial pressure and elevation variations at the bed surface fig 2b finally solute transport in the bed was simulated based on the simulated pore water flow field the governing equations and boundary conditions for both the surface water flow and pore water flow are described in the following sections 2 2 1 3 d steady state river water flow the fluent finite volume based software chen et al 2015 was used to simulate the 3 d steady state turbulent flow over compound beds fig 2a in order to derive the hydraulic head h p ρg e with p being the fluid pressure and e being the elevation distribution at the bed surface the turbulent flow is governed by the continuity equation and the reynolds averaged navier stokes rans equations for an incompressible homogeneous fluid cardenas wilson 2007b chen et al 2015 the details of the governing equation can be found in our earlier publication xiao et al 2017 rsm reynolds stress model turbulence closure scheme was used here since it has been proved to work well for treating secondary flows due to the anisotropy of normal stresses jing et al 2009 kang choi 2005 sugiyama et al 2006 including flows over the compound beds where there was a pair of secondary currents the rsm closes the rans equations by solving transport equations for the reynolds stresses fluent 2006 the details of these equations can be found in the supplementary material equations s1 s9 the boundary conditions largely follow previous studies cardenas and wilson 2007a cardenas et al 2008 chen et al 2015 and represented in fig 2a the top boundary of the overlying water was approximated as a rigid lid by specifying zero shear stresses since the river water depth in our simulations was large enough to replace the free surface with the symmetry condition surface water flow froude numbers in all simulations are 1 this approximation of the free surface has been widely used and shown to be reasonable for conditions with small bedforms relative to the river water depth cardenas and wilson 2007a janssen et al 2012 salehin 2004 the bottom of the surface water domain i e the swi was treated as an impervious no slip wall boundary cardenas and wilson 2007a janssen et al 2012 tonina and buffington 2009 although recent studies have emphasized the effects of wall permeability on the mass and momentum exchange at the swi li et al 2017 roche et al 2018 this approximation was still valid for interfacial flow with lower permeability porous media cardenas and wilson 2007a chen et al 2015 the intrinsic permeability κ was set as 1 10 10 m2 with a porosity η of 0 3 typically in the range of coarse sand cardenas and wilson 2007c chen et al 2015 trauth et al 2013 effects of wall roughness were not considered here by adopting the default roughness height ks value of zero corresponding to smooth walls the near wall region was described using an enhanced wall treatment scheme based on the wall function approach in the fluent simulation package jin et al 2010 launder and spalding 1974 a similar no slip wall boundary was applied at the vertical right side of the surface water domain trauth et al 2013 xiao et al 2017 a symmetric boundary condition was used at the left vertical side of the surface water domain at the inlet upstream boundary the average streamwise velocity and turbulence intensity were specified at the outlet downstream boundary 19 m from the upstream boundary the gradients of the streamwise flow velocity component and turbulence intensity in the flow direction were set to zero 2 2 2 2 d pore water flow and solute transport the finite element comsol multiphysics software chen et al 2015 janssen et al 2012 jin et al 2010 sawyer and cardenas 2009 was used to simulate numerically 2 d steady state pore water flow through a cross section of the compound bed note that except for areas near the upstream and downstream boundaries the flow structures in the transverse direction secondary flow change little along the river thus the pore water flow was focused on a cross section in the middle reach of the 3 d compound channel from which we analyzed the overlying water flow structure and took the associated pressure distribution at the bed surface fig 2 the saturated pore water flow through the sediment is governed by the combination of darcy s law and the continuity equation for incompressible fluid flow in a non deformable medium bear 1972 cardenas and wilson 2007a 2007b trauth et al 2013 1 x i κ μ p x i ρ g e x i 0 where μ is the dynamic fluid viscosity set to 1 10 3 pa s ρ is the fluid density κ is the intrinsic permeability p is the total fluid pressure and e is the elevation with the bottom boundary of pore water domain as the datum the boundary conditions for the pore water domain was largely following those of cardenas and wilson 2007a 2007b and chen et al 2015 as shown in fig 2b the surface water model was coupled to the pore water model by imposing the rans derived pressure head at the cross sectional bed surface to the top boundary of the pore water domain as a dirichlet boundary this approach was similar to those of cardenas and wilson 2007a and bardini et al 2012 along with the fluid pressure effects of elevation head variations along the top boundary on driving pore water flow was considered as well both the left and right vertical side were treated in the same way as surface water domain as symmetry or zero flow boundaries chen et al 2015 janssen et al 2012 trauth et al 2013 the bottom boundary was also set as no flow boundary chen et al 2015 janssen et al 2012 jin et al 2010 some recent studies have emphasized the effects of the ambient groundwater discharge on the hyporheic flow azizian et al 2017 caruso et al 2016 trauth et al 2013 their results demonstrated that groundwater upwelling could alter the hyporheic flow pattern and diminish its spatial extent as well as the hyporheic exchange flux for simplicity the effects of groundwater discharge from underlying aquifers below the hyporheic zone were not considered in the model the solute transport in the pore water was modelled by solving the 2 d advection diffusion dispersion equation see the supplementary material equations s10 s11 for details of the governing equation following qian et al 2008 and jin et al 2010 the boundary conditions for the solute transport were illustrated in fig 2b specifically a symmetric or no flux boundary condition was imposed on both the left and right vertical side of the sediment domain a no flux condition was also applied at the bottom boundary the boundary condition on the bed surface was set according to the local flow direction being inflow or outflow cardenas et al 2008 jin et al 2010 i e where n is the unit vector normal to the bed surface pointing outward and ct is the solute concentration in the river water for simplicity ct was kept constant over the simulation period i e ct c0 1 kg m 3 for the purpose of brevity discussions of the details of the model i e meshing software type of mesh number of iterations etc are recapped briefly in the supplementary material page 5 although no field studies have reported the observation of hyporheic flow and concentration profile in the cross section of a compound river due to the apparatus constraints the accuracy of the surface water flow model was validated by comparisons between predicted and measured flow fields and turbulence intensities in our previous studies xiao et al 2017 we validated the 3 d turbulent flow model by simulating the flume experiments of tominaga and nezu 1991 and tominaga et al 1989 the validations proved that the numerical method used in this paper is capable of accurately reproducing the flows in compound channels however further experiments on the transverse hyporheic flow and solute transport are needed in our future studies in order to enhance the reliability of the coupled numerical simulation results we conducted three additional simulations on transverse hyporheic flow case s45 a1 case s45 a2 and case s45 a3 using above numerical approach with similar model parameters as numerical studies of jin 2009 cardenas and wilson 2007a and chen et al 2015 then we compared the simulated results to earlier numerical results of longitudinal hyporheic flow through a 2 d dune these simulations aim to examine whether the compound bed cross section is more efficient in driving transverse hyporheic flow than the dune shaped bedforms in longitudinal flow presented in section 3 4 we respectively chose the base cases from cardenas and wilson 2007a jin 2009 and chen et al 2015 as the target for comparison in all additional simulations the bank slope was kept as 45 the parameters adopted in these additional simulations are listed in table 2 3 results and discussions 3 1 river water vortexes and hydraulic head variations on the bed surface fig 3 shows the river flow fields in a typical cross section see fig 2a for cases with different slope angles under 0 3 m s river flow rate secondary current v w is highlighted by the vector plot and the colour image shows the magnitude of streamwise river water flow velocity it is clear that due to transverse momentum transport between the main river channel deep section and the floodplain shallow section secondary currents with a complex flow structure were generated consistent with findings of previous studies tominaga and nezu 1991 a diagonally upward flow pattern developed at the floodplain tip with a pair of vortexes formed on both sides the vortexes affected the mainstream flow as evident in the variations of velocity magnitude particularly in the boundary layer near the bed surface this would lead to local pressure and hydraulic head variations on the bed surface which in turn drive circulating flow through the bed note that another pair of vortexes formed at the other end of the floodplain section which was generated by the anisotropy of turbulence because of the existence of the free surface and the vertical sidewall the sidewall vortexes are expected to affect local head variations on the bed surface and consequently create extra hyporheic flow through the bed as the bank slope increased the vortexes contracted in the transverse direction becoming more distinct and strengthened as a result the secondary current intensified with increased magnitude of transverse flow velocity for the same average streamwise river flow velocity uave the maxima of the secondary current velocity vs v 2 w 2 gradually increased with the bank slope angle fig 4 for the largest slope angle cases 90 the maxima of secondary current velocity reached about 3 84 of umax similar to the value of 4 reported by tominaga and nezu 1991 the secondary current intensified under larger streamwise river flow especially in the case with a steep bank fig 4 the effects of streamwise river flow on the transverse flow and vortexes were greater in the case with a larger bank slope angle the maximum transverse flow velocity increased by 0 0049 m s in the case with the bank slope of 25 when the mean river flow velocity rose from 0 3 m s to 1 0 m s such increase was multiplied by 4 in the 90 case due to intensified transverse momentum exchange in the river flow the transverse flow and vortexes across the river channels resulted in pressure and hydraulic head variations on the bed surface fig 5 the head fluctuations occurred mainly in the sloping bank area corresponding to the vortex formation the maximum head appeared at the reattachment point of the two vortexes close to the centre edge of the shallow channel section the head decreased rapidly toward the side boundary to reach a lower level and remained around it for the shallow channel section until variations formed near the boundary due to the near boundary vortexes toward the river centre the head declined gradually on the bank slope prior to undergoing rapid changes near the edge of the flat bed of the deep channel after reaching a minimum the head rose and oscillated slightly and then remained relatively constant on the flat bed toward the center even in the case of 90 slope angle the hydraulic head variations were similar except that the gradual head decline took place on a vertical face as the bank slope increased the area of head variations on the sloping bank became smaller due to the reduced range of the vortex in the river flow as the mean river flow velocity uave increased the head oscillations in the sloping bank area became stronger resulting from the intensified vortexes in the case with uave 1 0 m s a large head fluctuation was evident in the sloping bank area which disturbed the circulating flow in the bed fig 7e and f to further explore the head variations over the bed surface we calculated the difference between the maximum and minimum heads i e hint hmax hmin on the swi in connecting regions we then estimated the head gradient based on hint b where b is the characteristic length defined as the projected length of the sloping bank see fig 2a the results showed an increasing trend of hint b with the bank slope angle fig 6 this is because with a gentle bank slope such as 25 and 30 the difference of streamwise flow velocity between the main channel deep and floodplain shallow is smaller than that in the larger angle case in such cases the lateral momentum exchange between the main channel and floodplain is weaker generating fewer head fluctuations on the bed surface similar to the effect on the vortex in the river flow fig 4 higher mean river flow velocity resulted in higher head gradient but the influence of river flow on the head gradient was not as strong as that on the vortex maxima the increased magnitude of the head gradient in larger slope angle cases was much greater than that of smaller slope angle cases indicating a 3 2 interfacial exchange zone fluxes and advective transit time fig 7 displays the simulated pore water flow field and velocity magnitude distribution in the bed for different bank slope angles under three river flow rate conditions in each case a high velocity zone occurred in the vicinity of the sloping bank below the interface the magnitudes of pore water velocities in the middle part of the bed were generally much higher than those in areas on the two sides the pore water flow speed decreased significantly with the horizontal distance from the bank and depth the head variations on the bed surface led to hydraulic head gradients that drove hyporheic flow through two circulating cells both with relatively strong inflow through the sloping bank but relatively weak outflow from wider areas on the flat beds of the deep and shallow channel sections respectively the pore water circulation cells corresponded well with the vortexes in the river flow based on the simulated flow field we calculated the flow pathlines and advective transit time using the particle tracking method recapped briefly in the supplementary material page 6 to show the hyporheic flow patterns fig 7 between two neighbouring pathlines is a flow tube within which the pore water flux remains constant and hence the flow velocity decreases and increases as the tube expands and contracts respectively under the condition of uave 0 3 m s the pathlines in all bank slope angle cases concentrated in the shallow area of the bed with over 90 of particles moving through which indicated the dominance of transverse hyporheic flow in this area as shown in fig 8 the relationship between the area of the bed and the total flux through the area is non linear in all cases the flux initially experienced a sharp increase within the shallow areas followed by a gradual rise with the increasing areas and a final trend of approaching a constant level except for a slight increase under uave 0 6 m s due to vortexes near the side wall in the river flow the results again confirm higher exchange rates interfacial flux near the sloping bank than elsewhere in the bed and the circulation in these shallow areas dominated the hyporheic flow in the bed the particles placed close to the slope bottom and floodplain tip moved through relatively short pathlines while the ones in the middle part of the slope took relatively long paths when the bank slope angle equals 30 the particle transit time differed by three orders of magnitude between the short and long flow paths increasing from 2 minutes for a shallow flow path to 9d for a flow path through the bottom part of the bed the number of particles moving through the floodplain 11 out of 19 and corresponding circulation cell sizewere larger than those exiting the main channel figs 7 and 8 this indicates floodplain circulating flow plays a dominant role in driving the transverse hyporheic exchange between the river and bed as the bank slope angle increased from 30 to 45 the area of the high velocity zone below the sloping bank contracted to a smaller level but the flow field in the deep area of the bed appeared to change little the circulation cells under both the main channel and floodplain shrunk figs 7 and 8 the particles consequently moved out of the bed through relatively shorter pathlines over reduced transit times the number of particles moving through the main channel decreased to 7 out of 19 the number of particles exiting the floodplain increased to 12 a steeper bank slope may result in stronger circulating flow and hyporheic exchange through the shallow channel floodplain section of the bed when the mean river flow rate uave increased to 0 6 m s the distribution of pore water flow velocity magnitude near the sloping bank area changed in all bank slope cases fig 7 the high velocity zone split into two parts due to large head oscillations on the bed surface in the sloping bank area in the case of 30 bank slope angle the area of circulation cell under the main channel section decreased slightly but the hyporheic flux displayed distinct reduction the resulting particle transit time in the main channel section generally lengthened fig 7c the circulation cell under the floodplain section expanded resulting in longer particle transit time in the case of 45 bank slope angle the value of hyporheic flux was smaller than that with uave 0 3 m s moreover the circulation cell under the main channel section contracted significantly to a much smaller area with reduced transit time in contrast the circulation cell in the floodplain section expanded to a much larger size resulting in longer particle transit time these results indicate that under a larger river flow rate uave 0 6 m s the circulation cell contracted under the main channel section but expanded under the floodplain section especially in the bed with a relatively steep bank slope however the number of particles moving through the main channel increased to 9 19 and 8 19 in the 30 and 45 cases respectively the increased river flow rate intensified the circulating flow across the main channel fig 9 shows the normal flux varying along the interface of the hyporheic zone i e the exchange pattern with inflow and outflow across the swi in the cross section in all cases the interfacial exchange mainly occurred in the bank slope area especially near the floodplain tip upper corner of the sloping bank and the bottom lower corner of the bank slope where two pairs of peak inflow and outflow formed respectively as the bank slope angle increased the maximum interfacial flux became larger as the velocity of the mean river flow increased the highest interfacial flux decreased in the floodplain but increased in the main river channel this was due to the enhanced transverse momentum exchange between the main channel and floodplain in the river flow which promoted the interfacial exchange in the main channel but weakened it in the floodplain the hyporheic flux q through the hyporheic zone is another measure of interfacial exchange it was calculated by integrating the magnitude absolute value of normal fluxes along the swi shown in fig 9 and dividing by two since the integration does not discriminate between inward and outward flows which are equal the flux q was then divided by the actual bedform width b giving an effective flux density based on the bedform width the effective flux density normalized by the hydraulic conductivity k κρg μ of the sediment and expressed as 4 q i n t q k b fig 10 shows a monotonic relationship between q i n t and the side slope angle of the main channel in all cases with different river flow rates the hyporheic flux increased with increasing bank slope angle with the flux magnitude increasing from 0 0262 in the cases with 25 slope angle to 0 033 in the cases with 90 slope angle an increase of 26 this indicates that the steeper bank slope significantly strengthened the hyporheic flow by increasing both the hyporheic flux and the highest interfacial exchange rate on the bed surface this behaviour is generally consistent with findings from jin 2009 where the hyporheic flux increased with the slope of the stoss face of the rippled bedform as the river flow rate increased the hyporheic flux generally increased except for small angle cases with 25 and 30 fig 10 this is consistent with the results of earlier 2 d longitudinal cases jonsson 2003 patschke 1999 reidy 2004 the variations of the hyporheic flux in the large bank slope angle cases appeared to be greater than those in the smaller angle cases suggesting that the effect of river flow rate on the total interfacial flux are more important in the former cases 3 3 solute transport in the streambed to analyze the solute transport process affected by different side slope angles we conducted numerical simulations based on a constant solute concentration in the overlying water over the simulation period since the initial solute concentration in the pore water was assumed to be zero the solute transport driven by the transverse hyporheic flow led to the transfer of solute from the river to the bed fig 11 the solute entered the bed from the sloping bank area where the pore water circulating cells originated and then moved downward to the deep area of the bed based on the calculating flow pathlines with particles initially placed on the sloping bank surface over different elapse times fig 7 we examined first how these pathines related to the movement of the solute in the bed as given by the predicted solute concentration field fig 11 the results show that paths tracked well the downward moving solute front at the early time by elapse time of 4 h when the solute front remained in the shallow area however as the solute front moved further down to the deep area over a longer time 4 d it started to deviate from the particle s travel path these trends were generally consistent with the findings of solute transport affected by longitudinal hyporheic flow by jin 2009 advection played the dominant role in solute transport within the shallow area during the early period while dispersion became significant in the deep area over longer periods it is also clear that as the slope angle increased the location of the solute front became shallower at the same time point this suggests that the rate of solute downward movement to the deep area was decreased at larger slope angles however the solute front was still found to be well tracked by the particle pathlines in the shallow area and departed from the pathlines in the deep area of the bed to analyze further the effects of slope angles on the solute transport process in the bed we calculated the total amount of solute mass m in the bed at different elapse times as follows 5 m a b ɛ c x 1 x 2 t d a ɛ c 0 a b where normalization has been applied based on the full solute storage in the bed i e εc 0 ab with ab being the total area of the bed the cumulative solute mass in the bed generally decreased with increasing bank slope angle fig 12 this transverse solute transport behaviour induced by transverse bedform variations was different from the reported longitudinal solute transport process by jin 2009 in which the cumulative solute mass increased with increasing slope of the stoss face of the rippled bedform this could be explained by that the cumulative mass in the bed is expected to be affected significantly by both the hyporheic flow path and the hyporheic flux as displayed in fig 10 an increase of the bank slope angle raised the hyporheic flux significantly but with the corresponding circulation cell contracted to a much smaller size fig 7 the solute was carried out of the bed more rapidly by the stronger circulating flow through shorter pathlines in the bed as a result the cumulative solute mass in the bed decreased despite an increase in the hyporheic flux an exception existed for the cases with uave 1 0 m s and θ 25 45 75 and 90 where the cumulative solute mass displayed an increasing trend with increasing bank slope angle this might be due to the large head fluctuations in the sloping bank area under the high river flow rate the resulting circulating flow paths were significantly altered and became irregular compared with those under uave 0 3 m s and 0 6 m s fig 7 thus the variation pattern of solute mass with increasing bank slope angle became more complicated under uave 1 0 m s overall the behaviour of cumulative solute mass was consistent the result shown in fig 8 which indicates that the circulating flow near the sloping bank was much stronger than that in other areas of the bed and played a dominant role in the hyporheic exchange between the river and the bed in the cases with a relatively small bank slope 30 although the total area of the circulation cells slightly increased as the river flow rate increased fig 7 leading to longer particle transit time through the bed the hyporheic flux showed a significant decrease fig 10 as a result the total amount of the solute entering the bed via the circulating flow decreased while in the case with a relatively large bank slope angle e g 75 both the hyporheic flux and the total area of the circulation cells displayed considerable increases as the river flow rate became higher figs 7 and 10 thus much more solute entered the bed via the circulating flow and travelled through lengthened circulating flow pathlines remained in the bed for extended periods the cumulative amount of solute in the bed were hence increased 3 4 comparisons with longitudinal hyporheic flow the purpose of the analyses presented in this section is to determine the importance of transverse hyporheic exchange relative to the longitudinal exchange in a river system in particular we were interested in analyzing the results of head differences and hyporheic fluxes under similar simulation conditions see table 2 we examined first how the flow field was under deeper water depth condition for case s45 a1 shown in fig 13 it is clear that as the water depth increased to 0 5 m a pair of reverse river water vortexes also formed above the bank across the compound channel these transverse secondary currents lead to similar hydraulic head variations with those shown in fig 5 which in turn drove the transverse hyporheic flow in the form of two circulating cells through the bed as well the river water entered the bed from a sloping bank area and exited from the flat beds of the deep and shallow channel sections respectively the maximum speed of the transverse vortexes secondary currents was only about 2 44 of the maximum streamwise flow rate umax similar to the value of 3 84 discussed in section 3 1 the relative importance of the hyporheic exchange in the two directions was examined by computing the effective hyporheic flux density q i n t using eq 4 after cardenas and wilson 2007a and chen et al 2015 table 3 gives our calculated results of head differences and hyporheic fluxes for the transverse cases and the reported results of head differences and hyporheic fluxes for the longitudinal cases by jin 2009 cardenas and wilson 2007a and chen et al 2015 compared to the longitudinal cases under similar flow conditions the magnitude of hyporheic flux induced by the transverse bedform was generally larger especially at a higher flow rate as shown in table 3 the flux densities q i n t for the transverse cases case s45 a1 case s45 a2 and case s45 a3 simulated in this paper ranging from 0 0259 to 0 0266 were about one to two order of magnitude higher than those of the longitudinal cases considered in earlier studies ranging from 0 00078 to 0 0046 it could be explained by the head configuration over the swi the head differences hint for the transverse cases were about one to two orders of magnitude higher than the reported values of earlier longitudinal cases this higher head gradient in the transverse direction over the compound shaped bedform provided strong force to drive transverse hyporheic flow through the bed thus more transverse hyporheic fluxes were generated than those induced by the longitudinal processes despite that the maximum magnitude of transverse flow vsmax in the river water was only around 2 of the maximum magnitude of mainstream river flow umax the comparison results suggested that the compound riverbed cross section could be more efficient in driving transverse hyporheic flow than the longitudinal dune shaped bedform that drove hyporheic flow in the river flow direction 4 conclusions and implications compound bedforms across a river and its floodplains causes complex transverse flow structures in the river flow which in turn lead to head variations on the bed surface and induce hyporheic flow in the transverse direction through the bed however previous investigations mostly focused on the longitudinal bedform induced hyporheic flow in the river flow direction in this paper numerical simulations were conducted to investigate the dynamic processes of transverse hyporheic flow in a river system with compound beds comprising a main river channel and a floodplain we focused the analysis on the river water flow structures hyporheic flow patterns and exchange across the bed surface under the influence of bank slopes and river discharges seeking to answer 1 what are the characteristics of transverse hyporheic flow and solute transport in the cross section of a compound river system 2 what are the main influencing factors also a particular question to answer in this paper was on the relative importance of transverse hyporheic flow and longitudinal hyporheic flow in a river system the numerical results showed that transverse flow secondary currents formed in the sloping bank area across the compound channel leading to significant hydraulic head variations on the bed surface which in turn drove two circulating cells through the bed the river water entered the bed from a sloping bank area and exited from the main channel and floodplain areas respectively the circulating pore water flow under the floodplain was stronger than that under the main channel the hyporheic exchange was mostly driven by the circulation through the shallow bed generally as the bank slope angle increased the hyporheic flow through the bed was strengthened by the larger head gradient on the swi associated with the intensified secondary currents in the river flow the circulating cells under both the main channel and floodplain were contracted to a much smaller size leading to the shortened solute transit time through the corresponding pathlines and consequently decreased solute mass in the bed the effects of river discharge on the hyporheic flow pattern and exchange were greater in cases with larger bank slope angles as the river flow rate increased the total interfacial flux across the bed increased with relatively steep bank slope generally with the expansion of circulating cells the solute transit time through the pathlines extended and solute mass in the sediment increased in the transverse direction the compound bedform caused head gradients that were one to two orders of magnitude higher than those of earlier longitudinal cases which consequently create more hyporheic fluxes across the swi than those of the longitudinal cases our numerical modelling study indicates that compound bedform can drive significant transverse hyporheic flow in the cross section such a compound cross section is even more efficient in driving the transverse hyporheic flow than longitudinal dune shaped bedform hyporheic exchange rate is highest near the sloping bank this implies an intensive nutrient processing within this zone across the river bed moreover the modelling results here also highlight the importance of bank slope for hyporheic zone extent and the characteristics of the 2 d transverse hyporheic flow field in the cross section of a compound river the extent of the hyporheic zone area within the compound cross section strongly decreased with increased bank slope angle accompanied by a higher hyporheic exchange flow rate and shorter residence time bank slope is expected to control solute transport and retention processes through such exchange hydrodynamics an increased bank slope angle could decrease both the solute transfer rate and total amount of solute accumulation in the bed this is because the transverse hyporheic zone area is much smaller at steeper bank slope which minimizes the effects of increasing relative hyporheic flux this implies that under the influence of bank slope the solute transport within hyporheic zones in the cross section is more sensitive to the size of hyporheic zone than the fluid flux our findings elucidated distinct 2 d patterns and dynamics of transverse hyporheic exchange in compound rivers and for the first time highlighted how bank slope affects the hyporheic exchange processes and the importance of transverse hyporheic flow relative to the longitudinal cases in a river system understanding these physical processes will improve assessment of the integrated biogeochemical transformation of solutes between the main channel and floodplain in a compound river system given that our model assumed steady flow conditions in the water column the results should be taken as explanatory of the hydrodynamic processes rather than predictive for most natural flows are unsteady flows turbulent momentum transfer across the swi neglected in this paper could enhance the transverse hyporheic exchange in compound sections the importance of the faster exchange processes associated with fluid turbulence on the transverse flow requires further investigations these investigations should also consider groundwater upwelling caused by regional head gradients which have been found to significantly affect the hyporheic exchange rate and extent fox et al 2014 hester et al 2013 trauth et al 2013 considering the lack of measurements of transverse hyporheic flow in a compound river channel experimental studies in this area are needed in order to validate the modelling results acknowledgments this work was supported by the chinese scholarship council the national natural science foundation of china grant numbers 51239003 and the australian research council results of the numerical simulations supporting the conclusions can be obtained through an e mail request to the corresponding author 
734,previous studies of bedform induced hyporheic flow focused on processes driven by longitudinal hydraulic head variations at the sediment water interface swi due to river flow and bedform interactions by way of numerical simulations we examined the transverse hyporheic flow in a river system with compound sections comprising a main river channel and a floodplain connected by a bank the results show that head fluctuations across the compound beds associated with the transverse secondary flow can cause significant lateral hyporheic flow through two pore water circulating cells such a 2 d compound bedfrom have a higher flux across the swi than the 2 d longitudinal dunes since the 2 d compound cross section form induces more drag the circulating flow cells originate from the bank surface and terminate at the main channel and floodplain bed surfaces respectively the hyporheic exchange concentrates on the bank region below the swi where an intensive solute transfer concurrently occurred the head gradient along the swi is sensitive to the bank slope angle which consequently determines transverse hyporheic flow dynamics and solute transport processes larger bank slope angles induce higher hyporheic fluxes and smaller hyporheic areas and residence time the effects of increasing flux on solute transport in the compound section are partly influenced by a sharply decreasing hyporheic area thus the solute consequently transfers downward within the hyporheic zone with a lower rate at larger bank slope angle larger river discharges may promote both the transverse hyporheic flow and solute transformation across the bed surface these physical processes may have implications for the biogeochemical processing within the hyporheic zone across a compound river system keywords hyporheic zone surface water groundwater interaction compound channels bank slopes secondary currents notation x y z axes in the longitudinal along stream vertical and transverse directions respectively θ bank slope angle a area of streambed area enclosed by streamline and the swi l2 ab total area of the riverbed area l2 b width of the compound channel l b width of the main river channel l b projected length of the sloping bank l l compound channel length l dm bed thickness below the main river channel l df bed thickness below the floodplain l hm depth of river water for the main river channel l hf depth of river water for the floodplain l u v w time averaged river water flow velocity along x y z direction respectively lt 1 umax maximum streamwise water river flow velocity lt 1 uave average streamwise river water flow velocity lt 1 u i river water flow velocity fluctuations along xi lt 1 ct solute concentration in river water ml 3 c0 initial solute concentration in river water ml 3 c solute concentration in pore water ml 3 n unit vector normal to the bed surface pointing outward l h hydraulic head l p fluid pressure ml 1 t 2 e elevation with the bottom boundary of pore water domain set as the datum l κ the intrinsic permeability of the sand bed l2 k hydraulic conductivity for the streambed sand lt 1 η bulk porosity of sand bed ρ fluid density ml 3 μ dynamic fluid viscosity ml 1t 1 lc bedform stoss length defined in literature l db bed depth defined in additional simulations l hsw depth of river water defined in additional simulations l vs secondary flow velocity lt 1 vsmax maxima of secondary flow velocity lt 1 hmax maxima of the hydraulic head along the sediment water interface in connecting regions l hmin minima of the hydraulic head along the sediment water interface in connecting regions l hint difference between the head maxima hmax and the head minima hmin along the swi in connecting regions l q total volumetric flux through the swi computed by integrating the magnitude of normal interfacial flux along the swi enclosed by the streamlines l3t 1 q hyporheic flux through the hyporheic zone lt 1 qint normalized effective flux density m total amount of solute accumulation in the bed per unit length ml 1 m normalized total amount of solute accumulation in the bed per unit length dm pore water molecular diffusion coefficient l2t 1 dij pore water 2 d hydrodynamic dispersion coefficient tensor components l2t 1 αl longitudinal dispersivity l αt transverse dispersivity l ui pore water flow velocity lt 1 cc ij convective term in the reynolds stress transport equation dt ij turbulent diffusion term in the reynolds stress transport equation dl ij molecular viscous diffusion term in the reynolds stress transport equation τ ij production term of stress in the reynolds stress transport equation ϕij pressure strain term in the reynolds stress transport equation εij dissipation term in the reynolds stress transport equation fij production term of system rotation μt turbulent viscosity coefficient ml 1t 1 k turbulent kinetic energy l2t 2 ε turbulent dissipation rate l2t 3 eijk alternating symbol δij kronecker delta function ω characteristic swirl number 1 introduction the hyporheic zone is broadly defined as a transition zone beneath and adjacent to a river in riverbeds riverbanks and riparian corridors and floodplains where surface water and groundwater mix krause et al 2009 the hyporheic zone typically exhibits complex characteristics that are affected by various physical chemical and biological processes bencala 1984 huettel et al 1996 krause et al 2009 precht et al 2004 recent studies have shown that the hyporheic zone plays an important role in many river ecosystems exchange of water between the two different water bodies facilitates important transport of nutrient pollutant energy heat biota and carbon within these systems cardenas 2006 cardenas and wilson 2007b hill et al 1998 packman and brooks 2001 the exchange affects river water quality and ecology linked to nutrient cycling and carbon fluxes as well as the distribution and abundance of organisms in the overlying river water and hyporheic zone boulton et al 1998 groffman et al 2005 a better understanding of the mechanism that underlies hyporheic exchange assists studies of nutrients and toxic contaminants in rivers and the management of the river ecosystem in natural rivers hyporheic exchange occurs not only vertically but also laterally through the bed which typically have a compound cross section banzhaf et al 2011 boulton et al 2010 butturini et al 2002 gerecht et al 2011 trauth et al 2013 xia et al 2013 such cross section consists of a main river channel where discharge takes place all the time and adjacent floodplain which gets dry during droughts fig 1 a knight and demetriou 1983 pezzinga 1994 shiono and knight 1991 yang et al 2014 the compound shaped bedforms can induce head gradients in the across river direction within the floodplain which in turn alter the spatial extent of hyporheic zone and thus greatly influence the hyporheic flow banzhaf et al 2011 chen et al 2015 a key mechanism of hyporheic exchange in natural rivers is provided by riverbed morphologic features such as bedforms bottacin busolin and marion 2010 cardenas and wilson 2007a packman et al 2004 experiments and numerical simulations have been conducted to describe the topography driven hyporheic flow in porous media based on flume experiments elliott and brooks 1997 packman et al 2004 thibodeaux and boyle 1987 researchers have previously investigated hyporheic flow induced by dune shaped bedform their results demonstrated that flow over bedforms induces additional pressure gradients which generates significant advective flows within the beds packman et al 2004 solute transport through the streambed follows a circulating flow path which enters the streambed from the bedform s stoss face and exits to the water column on the lee face cardenas and wilson 2007a 2007b and salehin 2004 simulated 2 d pore water flow in a bed with triangular bedforms in which the turbulent flow in the water column was sequentially coupled to darcian porous media flow via the pressure distribution along the swi their results proved that flow bedform interactions induced hydraulic head gradients at the swi which in turn generates pore water circulation through the bed producing an exchange flux this process of advective pumping is well understood to regulate hyporheic fluxes and residence times another important mechanism causing hyporheic flow is turbulence diffusion across the concentration boundary layer bottacin busolin 2017 cardenas 2015 packman et al 2004 roche et al 2018 shimizu and tsujimoto 1990 turbulent eddies penetrate across the high permeable coarse gravel riverbeds and drives momentum flux below the interface which may dominate the hyporheic exchange in a thin layer of flat riverbeds blois et al 2012 king et al 2009 roche et al 2018 the exchange rate is found to be proportional to the square of the characteristic bed sediment size packman et al 2004 such vertical turbulence induced momentum transfer is most intense near the swi and decreases with depth in sediments breugem et al 2006 packman et al 2004 vollmer et al 2002 in these instances effects of river turbulent transport on biogeochemical processes such as hyporheic denitrification have been addressed in recent works bottacin busolin 2017 grant et al 2018 li et al 2017 their results suggested rapid flushing of the highly bioactive region formed near the swi due to high turbulent activity across the swi which significantly speeds up nutrient removal from the river to the grained sediment li et al 2017 the turbulence induced hyporheic exchange is more likely to dominate in flat beds of high permeability coarse grained riverbeds and influence a very thin region of the riverbeds chandler et al 2016 packman et al 2004 roche et al 2018 shimizu and tsujimoto 1990 voermans et al 2017 the head induced convection still tends to be the major form of hyporheic exchange through low permeability beds covered by diverse bedforms where the effects of turbulent diffusion near the swi was relatively minor boano et al 2014 jin 2009 however previous studies of bedform induced hyporheic flow largely concentrated on the processes in the longitudinal direction i e hyporheic flow and associated solute transport driven by longitudinal hydraulic head gradients at the swi their results have allowed for prediction of vertical hyporheic fluxes and residence times through the hyporheic zone elliott and brooks 1997 marion et al 2002 packman and brooks 2001 packman et al 2000 ren and packman 2005 wörman et al 2007 only a few studies have analyzed laterally hyporheic exchange in a river cross section induced by the bedform typically in a compound cross section banzhaf et al 2011 boano et al 2008 gerecht et al 2011 parsons and best 2013 trauth et al 2013 which is clearly different from the dune shaped bedforms fig 1a in a compound river system the water in the main river channel flows out of the bank onto the adjacent floodplain during floods owing to the variation in the cross sectional shape and different roughness between the main river channel and the floodplain the faster moving water in the main river channel interacts with slower moving water on the floodplain this causes lateral momentum transport between the main river channel and floodplain generating a large shear layer with complex transverse flow structures in the form of longitudinal vortexes secondary currents near the connecting bank knight and hamed 1984 knight and sellin 1987 shiono and knight 1991 tominaga and nezu 1991 fig 1a compared to the dunes this different flow behaviours secondary currents over compound shaped beds would result in a different head gradient pattern over the interface in the transverse direction which in turn generates transverse hyporheic flow in the riverbeds and adjacent floodplains fig 1b furthermore variations in shapes of compound cross sections will make a difference in formation of vortex zones and stagnation points xiao et al 2017 it will greatly affect head distribution and hyporheic flow pattern which have not yet been adequately investigated in previous studies gerecht et al 2011 trauth et al 2013 several studies often supported by field observations and numerical simulations have investigated the transverse hyporheic exchange but within a limited context most of them described the transverse exchange via comparing the hydrologic linkage between the main river channel and its adjacent floodplains for example banzhaf et al 2011 carried out field observations with gauged surface water levels and groundwater levels in the riverbank of an alluvial stream under different aquifer conditions their studies illustrated that the solute enters the riverbank via the stream and for this reason they pointed out the occurrence of transverse hyporheic exchange between the riverbeds and the riverbanks gerecht et al 2011 observed the dynamic head variation across a bed to bank transect over a dam storage release cycle their results illustrated a decreasing trend of the hyporheic exchange flux and time with the increasing distance from the bank these studies proved the presence of transverse exchange but did not investigate the underlying hydrodynamic processes of the system either in the water column or within the sediments it has been recognised the hyporheic flux and residence time determine the delivery of solutes and the rate and spatial extent of biogeochemical processes between the main river channel and the floodplain knowledge of flow path and water flux as well as its residence time through the compound transect is required in order to better understand the hydrodynamics on this scale langhoff et al 2006 wroblicky et al 1998 trauth et al 2013 filled partly this knowledge gap through a study of 3 d hyporheic exchange in a pool riffle stream based on numerical simulations their models illustrated a complex hydraulic head distribution along the swi that leads to lateral hyporheic flow affected by both longitudinally and laterally distributed dune shaped bedform nevertheless a systematic and comprehensive investigation focused on the transverse hyporheic flow depends on the 2 d cross channel bed topography in a compound shape is still lacking since it is challenging to design appropriate flume experiments of the sediment water interface numerical simulations have proven to be a viable way to help improve our mechanistic understanding of hydrodynamics and biogeochemistry in complex nature of turbulent flow over 3 d bedforms and the induced hyporheic flow in these simulations a multiphysics computational fluid dynamics cfd approach of cardenas and wilson 2007a 2007b sawyer et al 2011 and also janssen et al 2012 was widespreadly used the river flow over bed morphologies and the resulting pressure along the bed surface can be most accurately simulated using the cfd codes that solve the full navier stokes equations bardini et al 2012 cardenas and wilson 2007c packman et al 2004 tonina and buffington 2009 these flow simulations can efffecitvely decribe the normal reynolds stresses and flow in the transverse direction secondary flow resulted from the anisotropy of normal stresses jing et al 2009 xiao et al 2017 to improve our understanding of transverse hyporheic exchange and underlying processes induced by compound shaped bedform we firstly conducted numerical simulations of 3 d overbank river flows through a compound channel using a 3 d cfd code this 3 d river water flow is sequentially coupled to 2 d pore water flow in the riverbed cross section via head gradients at the swi generated by the transverse secondary flow hyporheic flow scenarios for six different bedform geometry bank slope angle were systematically evaluated for different river discharges longitudinal mean flow the analysis focused on river water flow structures hyporheic flow patterns exchange fluxes across the bed surface and advective transit time as well as the solute transport in the bed additional numerical simulations were also conducted to make a comparison with the longitudinal hyporheic exchange through these simulations we are able to systematically address the following unexplored questions 1 what are the hydrodynamic processes of transverse hyporheic exchange in the transect of a compound river system 2 how variations in geometric shapes of the compound cross section and river discharge affect the transverse hyporheic flow and solute transport in a compound river system and 3 how important this transverse hyporheic flow dynamics are compared with the longitudinal hyporheic flow in a river system the results also contribute to growing experimental data on transverse hyporheic exchange processes and solute transport in the cross section of a compound river system 2 methodology 2 1 model geometry and parameterization compound shaped topography in the numerical model was represented by a simplified approximation of a straight prismatic two stage compound channel comprising a main river channel two floodplains and a sloping bank due to the symmetric bed configurations along the river centre only one half of the channel was included in the modelling domain fig 2 significantly reducing calculation times we used six different river water flow domains in which the channel morphology differs by the bank slope angle θ varying from 25 to 30 45 60 75 and 90 in all simulations the compound channel had a length l of 19 m a width b of 1 6 m a constant slope of 1 16 10 3 was assigned to the channel morphology which was close to the values used by knight and shiono 1990 0 966 10 3 as well as shiono and knight 1991 1 027 10 3 the depth of overlying water for the main river channel hm and floodplain hf were respectively referred to 0 3 m and 0 15 m in order to fully submerge the main river channel and the connecting bank to reproduce overbank flow scenarios knight and sellin 1987 shiono and knight 1991 tominaga and nezu 1991 the thickness of the bed below the main river channel dm and the floodplain df were respectively 0 85 m and 1 0 m in the simulations three different river flow discharge scenarios for each channel morphology were performed table 1 which were in the range of values used in previous studies cardenas and wilson 2007a knight and shiono 1990 shen et al 1990 trauth et al 2013 the numerical conditions are listed in table 1 2 2 numerical modeling and boundary conditions the river flow over the compound channel and pore water flow and solute transport in the bed were simulated following the computational fluid dynamics cfd approach of cardenas and wilson 2007a in which a one way sequential coupling method was used and has been shown to be robust chen et al 2015 jin et al 2010 trauth et al 2013 first the steady state 3 d overbank flows through the compound channel were simulated from which the associated fluid pressure at the bed surface over the middle cross section was determined and subsequently used for pore water flow simulations fig 2a then a steady state 2 d across the bed in the middle reach of the channel was modelled this 2 d pore water flow was driven by the combined effects of cfd derived interfacial pressure and elevation variations at the bed surface fig 2b finally solute transport in the bed was simulated based on the simulated pore water flow field the governing equations and boundary conditions for both the surface water flow and pore water flow are described in the following sections 2 2 1 3 d steady state river water flow the fluent finite volume based software chen et al 2015 was used to simulate the 3 d steady state turbulent flow over compound beds fig 2a in order to derive the hydraulic head h p ρg e with p being the fluid pressure and e being the elevation distribution at the bed surface the turbulent flow is governed by the continuity equation and the reynolds averaged navier stokes rans equations for an incompressible homogeneous fluid cardenas wilson 2007b chen et al 2015 the details of the governing equation can be found in our earlier publication xiao et al 2017 rsm reynolds stress model turbulence closure scheme was used here since it has been proved to work well for treating secondary flows due to the anisotropy of normal stresses jing et al 2009 kang choi 2005 sugiyama et al 2006 including flows over the compound beds where there was a pair of secondary currents the rsm closes the rans equations by solving transport equations for the reynolds stresses fluent 2006 the details of these equations can be found in the supplementary material equations s1 s9 the boundary conditions largely follow previous studies cardenas and wilson 2007a cardenas et al 2008 chen et al 2015 and represented in fig 2a the top boundary of the overlying water was approximated as a rigid lid by specifying zero shear stresses since the river water depth in our simulations was large enough to replace the free surface with the symmetry condition surface water flow froude numbers in all simulations are 1 this approximation of the free surface has been widely used and shown to be reasonable for conditions with small bedforms relative to the river water depth cardenas and wilson 2007a janssen et al 2012 salehin 2004 the bottom of the surface water domain i e the swi was treated as an impervious no slip wall boundary cardenas and wilson 2007a janssen et al 2012 tonina and buffington 2009 although recent studies have emphasized the effects of wall permeability on the mass and momentum exchange at the swi li et al 2017 roche et al 2018 this approximation was still valid for interfacial flow with lower permeability porous media cardenas and wilson 2007a chen et al 2015 the intrinsic permeability κ was set as 1 10 10 m2 with a porosity η of 0 3 typically in the range of coarse sand cardenas and wilson 2007c chen et al 2015 trauth et al 2013 effects of wall roughness were not considered here by adopting the default roughness height ks value of zero corresponding to smooth walls the near wall region was described using an enhanced wall treatment scheme based on the wall function approach in the fluent simulation package jin et al 2010 launder and spalding 1974 a similar no slip wall boundary was applied at the vertical right side of the surface water domain trauth et al 2013 xiao et al 2017 a symmetric boundary condition was used at the left vertical side of the surface water domain at the inlet upstream boundary the average streamwise velocity and turbulence intensity were specified at the outlet downstream boundary 19 m from the upstream boundary the gradients of the streamwise flow velocity component and turbulence intensity in the flow direction were set to zero 2 2 2 2 d pore water flow and solute transport the finite element comsol multiphysics software chen et al 2015 janssen et al 2012 jin et al 2010 sawyer and cardenas 2009 was used to simulate numerically 2 d steady state pore water flow through a cross section of the compound bed note that except for areas near the upstream and downstream boundaries the flow structures in the transverse direction secondary flow change little along the river thus the pore water flow was focused on a cross section in the middle reach of the 3 d compound channel from which we analyzed the overlying water flow structure and took the associated pressure distribution at the bed surface fig 2 the saturated pore water flow through the sediment is governed by the combination of darcy s law and the continuity equation for incompressible fluid flow in a non deformable medium bear 1972 cardenas and wilson 2007a 2007b trauth et al 2013 1 x i κ μ p x i ρ g e x i 0 where μ is the dynamic fluid viscosity set to 1 10 3 pa s ρ is the fluid density κ is the intrinsic permeability p is the total fluid pressure and e is the elevation with the bottom boundary of pore water domain as the datum the boundary conditions for the pore water domain was largely following those of cardenas and wilson 2007a 2007b and chen et al 2015 as shown in fig 2b the surface water model was coupled to the pore water model by imposing the rans derived pressure head at the cross sectional bed surface to the top boundary of the pore water domain as a dirichlet boundary this approach was similar to those of cardenas and wilson 2007a and bardini et al 2012 along with the fluid pressure effects of elevation head variations along the top boundary on driving pore water flow was considered as well both the left and right vertical side were treated in the same way as surface water domain as symmetry or zero flow boundaries chen et al 2015 janssen et al 2012 trauth et al 2013 the bottom boundary was also set as no flow boundary chen et al 2015 janssen et al 2012 jin et al 2010 some recent studies have emphasized the effects of the ambient groundwater discharge on the hyporheic flow azizian et al 2017 caruso et al 2016 trauth et al 2013 their results demonstrated that groundwater upwelling could alter the hyporheic flow pattern and diminish its spatial extent as well as the hyporheic exchange flux for simplicity the effects of groundwater discharge from underlying aquifers below the hyporheic zone were not considered in the model the solute transport in the pore water was modelled by solving the 2 d advection diffusion dispersion equation see the supplementary material equations s10 s11 for details of the governing equation following qian et al 2008 and jin et al 2010 the boundary conditions for the solute transport were illustrated in fig 2b specifically a symmetric or no flux boundary condition was imposed on both the left and right vertical side of the sediment domain a no flux condition was also applied at the bottom boundary the boundary condition on the bed surface was set according to the local flow direction being inflow or outflow cardenas et al 2008 jin et al 2010 i e where n is the unit vector normal to the bed surface pointing outward and ct is the solute concentration in the river water for simplicity ct was kept constant over the simulation period i e ct c0 1 kg m 3 for the purpose of brevity discussions of the details of the model i e meshing software type of mesh number of iterations etc are recapped briefly in the supplementary material page 5 although no field studies have reported the observation of hyporheic flow and concentration profile in the cross section of a compound river due to the apparatus constraints the accuracy of the surface water flow model was validated by comparisons between predicted and measured flow fields and turbulence intensities in our previous studies xiao et al 2017 we validated the 3 d turbulent flow model by simulating the flume experiments of tominaga and nezu 1991 and tominaga et al 1989 the validations proved that the numerical method used in this paper is capable of accurately reproducing the flows in compound channels however further experiments on the transverse hyporheic flow and solute transport are needed in our future studies in order to enhance the reliability of the coupled numerical simulation results we conducted three additional simulations on transverse hyporheic flow case s45 a1 case s45 a2 and case s45 a3 using above numerical approach with similar model parameters as numerical studies of jin 2009 cardenas and wilson 2007a and chen et al 2015 then we compared the simulated results to earlier numerical results of longitudinal hyporheic flow through a 2 d dune these simulations aim to examine whether the compound bed cross section is more efficient in driving transverse hyporheic flow than the dune shaped bedforms in longitudinal flow presented in section 3 4 we respectively chose the base cases from cardenas and wilson 2007a jin 2009 and chen et al 2015 as the target for comparison in all additional simulations the bank slope was kept as 45 the parameters adopted in these additional simulations are listed in table 2 3 results and discussions 3 1 river water vortexes and hydraulic head variations on the bed surface fig 3 shows the river flow fields in a typical cross section see fig 2a for cases with different slope angles under 0 3 m s river flow rate secondary current v w is highlighted by the vector plot and the colour image shows the magnitude of streamwise river water flow velocity it is clear that due to transverse momentum transport between the main river channel deep section and the floodplain shallow section secondary currents with a complex flow structure were generated consistent with findings of previous studies tominaga and nezu 1991 a diagonally upward flow pattern developed at the floodplain tip with a pair of vortexes formed on both sides the vortexes affected the mainstream flow as evident in the variations of velocity magnitude particularly in the boundary layer near the bed surface this would lead to local pressure and hydraulic head variations on the bed surface which in turn drive circulating flow through the bed note that another pair of vortexes formed at the other end of the floodplain section which was generated by the anisotropy of turbulence because of the existence of the free surface and the vertical sidewall the sidewall vortexes are expected to affect local head variations on the bed surface and consequently create extra hyporheic flow through the bed as the bank slope increased the vortexes contracted in the transverse direction becoming more distinct and strengthened as a result the secondary current intensified with increased magnitude of transverse flow velocity for the same average streamwise river flow velocity uave the maxima of the secondary current velocity vs v 2 w 2 gradually increased with the bank slope angle fig 4 for the largest slope angle cases 90 the maxima of secondary current velocity reached about 3 84 of umax similar to the value of 4 reported by tominaga and nezu 1991 the secondary current intensified under larger streamwise river flow especially in the case with a steep bank fig 4 the effects of streamwise river flow on the transverse flow and vortexes were greater in the case with a larger bank slope angle the maximum transverse flow velocity increased by 0 0049 m s in the case with the bank slope of 25 when the mean river flow velocity rose from 0 3 m s to 1 0 m s such increase was multiplied by 4 in the 90 case due to intensified transverse momentum exchange in the river flow the transverse flow and vortexes across the river channels resulted in pressure and hydraulic head variations on the bed surface fig 5 the head fluctuations occurred mainly in the sloping bank area corresponding to the vortex formation the maximum head appeared at the reattachment point of the two vortexes close to the centre edge of the shallow channel section the head decreased rapidly toward the side boundary to reach a lower level and remained around it for the shallow channel section until variations formed near the boundary due to the near boundary vortexes toward the river centre the head declined gradually on the bank slope prior to undergoing rapid changes near the edge of the flat bed of the deep channel after reaching a minimum the head rose and oscillated slightly and then remained relatively constant on the flat bed toward the center even in the case of 90 slope angle the hydraulic head variations were similar except that the gradual head decline took place on a vertical face as the bank slope increased the area of head variations on the sloping bank became smaller due to the reduced range of the vortex in the river flow as the mean river flow velocity uave increased the head oscillations in the sloping bank area became stronger resulting from the intensified vortexes in the case with uave 1 0 m s a large head fluctuation was evident in the sloping bank area which disturbed the circulating flow in the bed fig 7e and f to further explore the head variations over the bed surface we calculated the difference between the maximum and minimum heads i e hint hmax hmin on the swi in connecting regions we then estimated the head gradient based on hint b where b is the characteristic length defined as the projected length of the sloping bank see fig 2a the results showed an increasing trend of hint b with the bank slope angle fig 6 this is because with a gentle bank slope such as 25 and 30 the difference of streamwise flow velocity between the main channel deep and floodplain shallow is smaller than that in the larger angle case in such cases the lateral momentum exchange between the main channel and floodplain is weaker generating fewer head fluctuations on the bed surface similar to the effect on the vortex in the river flow fig 4 higher mean river flow velocity resulted in higher head gradient but the influence of river flow on the head gradient was not as strong as that on the vortex maxima the increased magnitude of the head gradient in larger slope angle cases was much greater than that of smaller slope angle cases indicating a 3 2 interfacial exchange zone fluxes and advective transit time fig 7 displays the simulated pore water flow field and velocity magnitude distribution in the bed for different bank slope angles under three river flow rate conditions in each case a high velocity zone occurred in the vicinity of the sloping bank below the interface the magnitudes of pore water velocities in the middle part of the bed were generally much higher than those in areas on the two sides the pore water flow speed decreased significantly with the horizontal distance from the bank and depth the head variations on the bed surface led to hydraulic head gradients that drove hyporheic flow through two circulating cells both with relatively strong inflow through the sloping bank but relatively weak outflow from wider areas on the flat beds of the deep and shallow channel sections respectively the pore water circulation cells corresponded well with the vortexes in the river flow based on the simulated flow field we calculated the flow pathlines and advective transit time using the particle tracking method recapped briefly in the supplementary material page 6 to show the hyporheic flow patterns fig 7 between two neighbouring pathlines is a flow tube within which the pore water flux remains constant and hence the flow velocity decreases and increases as the tube expands and contracts respectively under the condition of uave 0 3 m s the pathlines in all bank slope angle cases concentrated in the shallow area of the bed with over 90 of particles moving through which indicated the dominance of transverse hyporheic flow in this area as shown in fig 8 the relationship between the area of the bed and the total flux through the area is non linear in all cases the flux initially experienced a sharp increase within the shallow areas followed by a gradual rise with the increasing areas and a final trend of approaching a constant level except for a slight increase under uave 0 6 m s due to vortexes near the side wall in the river flow the results again confirm higher exchange rates interfacial flux near the sloping bank than elsewhere in the bed and the circulation in these shallow areas dominated the hyporheic flow in the bed the particles placed close to the slope bottom and floodplain tip moved through relatively short pathlines while the ones in the middle part of the slope took relatively long paths when the bank slope angle equals 30 the particle transit time differed by three orders of magnitude between the short and long flow paths increasing from 2 minutes for a shallow flow path to 9d for a flow path through the bottom part of the bed the number of particles moving through the floodplain 11 out of 19 and corresponding circulation cell sizewere larger than those exiting the main channel figs 7 and 8 this indicates floodplain circulating flow plays a dominant role in driving the transverse hyporheic exchange between the river and bed as the bank slope angle increased from 30 to 45 the area of the high velocity zone below the sloping bank contracted to a smaller level but the flow field in the deep area of the bed appeared to change little the circulation cells under both the main channel and floodplain shrunk figs 7 and 8 the particles consequently moved out of the bed through relatively shorter pathlines over reduced transit times the number of particles moving through the main channel decreased to 7 out of 19 the number of particles exiting the floodplain increased to 12 a steeper bank slope may result in stronger circulating flow and hyporheic exchange through the shallow channel floodplain section of the bed when the mean river flow rate uave increased to 0 6 m s the distribution of pore water flow velocity magnitude near the sloping bank area changed in all bank slope cases fig 7 the high velocity zone split into two parts due to large head oscillations on the bed surface in the sloping bank area in the case of 30 bank slope angle the area of circulation cell under the main channel section decreased slightly but the hyporheic flux displayed distinct reduction the resulting particle transit time in the main channel section generally lengthened fig 7c the circulation cell under the floodplain section expanded resulting in longer particle transit time in the case of 45 bank slope angle the value of hyporheic flux was smaller than that with uave 0 3 m s moreover the circulation cell under the main channel section contracted significantly to a much smaller area with reduced transit time in contrast the circulation cell in the floodplain section expanded to a much larger size resulting in longer particle transit time these results indicate that under a larger river flow rate uave 0 6 m s the circulation cell contracted under the main channel section but expanded under the floodplain section especially in the bed with a relatively steep bank slope however the number of particles moving through the main channel increased to 9 19 and 8 19 in the 30 and 45 cases respectively the increased river flow rate intensified the circulating flow across the main channel fig 9 shows the normal flux varying along the interface of the hyporheic zone i e the exchange pattern with inflow and outflow across the swi in the cross section in all cases the interfacial exchange mainly occurred in the bank slope area especially near the floodplain tip upper corner of the sloping bank and the bottom lower corner of the bank slope where two pairs of peak inflow and outflow formed respectively as the bank slope angle increased the maximum interfacial flux became larger as the velocity of the mean river flow increased the highest interfacial flux decreased in the floodplain but increased in the main river channel this was due to the enhanced transverse momentum exchange between the main channel and floodplain in the river flow which promoted the interfacial exchange in the main channel but weakened it in the floodplain the hyporheic flux q through the hyporheic zone is another measure of interfacial exchange it was calculated by integrating the magnitude absolute value of normal fluxes along the swi shown in fig 9 and dividing by two since the integration does not discriminate between inward and outward flows which are equal the flux q was then divided by the actual bedform width b giving an effective flux density based on the bedform width the effective flux density normalized by the hydraulic conductivity k κρg μ of the sediment and expressed as 4 q i n t q k b fig 10 shows a monotonic relationship between q i n t and the side slope angle of the main channel in all cases with different river flow rates the hyporheic flux increased with increasing bank slope angle with the flux magnitude increasing from 0 0262 in the cases with 25 slope angle to 0 033 in the cases with 90 slope angle an increase of 26 this indicates that the steeper bank slope significantly strengthened the hyporheic flow by increasing both the hyporheic flux and the highest interfacial exchange rate on the bed surface this behaviour is generally consistent with findings from jin 2009 where the hyporheic flux increased with the slope of the stoss face of the rippled bedform as the river flow rate increased the hyporheic flux generally increased except for small angle cases with 25 and 30 fig 10 this is consistent with the results of earlier 2 d longitudinal cases jonsson 2003 patschke 1999 reidy 2004 the variations of the hyporheic flux in the large bank slope angle cases appeared to be greater than those in the smaller angle cases suggesting that the effect of river flow rate on the total interfacial flux are more important in the former cases 3 3 solute transport in the streambed to analyze the solute transport process affected by different side slope angles we conducted numerical simulations based on a constant solute concentration in the overlying water over the simulation period since the initial solute concentration in the pore water was assumed to be zero the solute transport driven by the transverse hyporheic flow led to the transfer of solute from the river to the bed fig 11 the solute entered the bed from the sloping bank area where the pore water circulating cells originated and then moved downward to the deep area of the bed based on the calculating flow pathlines with particles initially placed on the sloping bank surface over different elapse times fig 7 we examined first how these pathines related to the movement of the solute in the bed as given by the predicted solute concentration field fig 11 the results show that paths tracked well the downward moving solute front at the early time by elapse time of 4 h when the solute front remained in the shallow area however as the solute front moved further down to the deep area over a longer time 4 d it started to deviate from the particle s travel path these trends were generally consistent with the findings of solute transport affected by longitudinal hyporheic flow by jin 2009 advection played the dominant role in solute transport within the shallow area during the early period while dispersion became significant in the deep area over longer periods it is also clear that as the slope angle increased the location of the solute front became shallower at the same time point this suggests that the rate of solute downward movement to the deep area was decreased at larger slope angles however the solute front was still found to be well tracked by the particle pathlines in the shallow area and departed from the pathlines in the deep area of the bed to analyze further the effects of slope angles on the solute transport process in the bed we calculated the total amount of solute mass m in the bed at different elapse times as follows 5 m a b ɛ c x 1 x 2 t d a ɛ c 0 a b where normalization has been applied based on the full solute storage in the bed i e εc 0 ab with ab being the total area of the bed the cumulative solute mass in the bed generally decreased with increasing bank slope angle fig 12 this transverse solute transport behaviour induced by transverse bedform variations was different from the reported longitudinal solute transport process by jin 2009 in which the cumulative solute mass increased with increasing slope of the stoss face of the rippled bedform this could be explained by that the cumulative mass in the bed is expected to be affected significantly by both the hyporheic flow path and the hyporheic flux as displayed in fig 10 an increase of the bank slope angle raised the hyporheic flux significantly but with the corresponding circulation cell contracted to a much smaller size fig 7 the solute was carried out of the bed more rapidly by the stronger circulating flow through shorter pathlines in the bed as a result the cumulative solute mass in the bed decreased despite an increase in the hyporheic flux an exception existed for the cases with uave 1 0 m s and θ 25 45 75 and 90 where the cumulative solute mass displayed an increasing trend with increasing bank slope angle this might be due to the large head fluctuations in the sloping bank area under the high river flow rate the resulting circulating flow paths were significantly altered and became irregular compared with those under uave 0 3 m s and 0 6 m s fig 7 thus the variation pattern of solute mass with increasing bank slope angle became more complicated under uave 1 0 m s overall the behaviour of cumulative solute mass was consistent the result shown in fig 8 which indicates that the circulating flow near the sloping bank was much stronger than that in other areas of the bed and played a dominant role in the hyporheic exchange between the river and the bed in the cases with a relatively small bank slope 30 although the total area of the circulation cells slightly increased as the river flow rate increased fig 7 leading to longer particle transit time through the bed the hyporheic flux showed a significant decrease fig 10 as a result the total amount of the solute entering the bed via the circulating flow decreased while in the case with a relatively large bank slope angle e g 75 both the hyporheic flux and the total area of the circulation cells displayed considerable increases as the river flow rate became higher figs 7 and 10 thus much more solute entered the bed via the circulating flow and travelled through lengthened circulating flow pathlines remained in the bed for extended periods the cumulative amount of solute in the bed were hence increased 3 4 comparisons with longitudinal hyporheic flow the purpose of the analyses presented in this section is to determine the importance of transverse hyporheic exchange relative to the longitudinal exchange in a river system in particular we were interested in analyzing the results of head differences and hyporheic fluxes under similar simulation conditions see table 2 we examined first how the flow field was under deeper water depth condition for case s45 a1 shown in fig 13 it is clear that as the water depth increased to 0 5 m a pair of reverse river water vortexes also formed above the bank across the compound channel these transverse secondary currents lead to similar hydraulic head variations with those shown in fig 5 which in turn drove the transverse hyporheic flow in the form of two circulating cells through the bed as well the river water entered the bed from a sloping bank area and exited from the flat beds of the deep and shallow channel sections respectively the maximum speed of the transverse vortexes secondary currents was only about 2 44 of the maximum streamwise flow rate umax similar to the value of 3 84 discussed in section 3 1 the relative importance of the hyporheic exchange in the two directions was examined by computing the effective hyporheic flux density q i n t using eq 4 after cardenas and wilson 2007a and chen et al 2015 table 3 gives our calculated results of head differences and hyporheic fluxes for the transverse cases and the reported results of head differences and hyporheic fluxes for the longitudinal cases by jin 2009 cardenas and wilson 2007a and chen et al 2015 compared to the longitudinal cases under similar flow conditions the magnitude of hyporheic flux induced by the transverse bedform was generally larger especially at a higher flow rate as shown in table 3 the flux densities q i n t for the transverse cases case s45 a1 case s45 a2 and case s45 a3 simulated in this paper ranging from 0 0259 to 0 0266 were about one to two order of magnitude higher than those of the longitudinal cases considered in earlier studies ranging from 0 00078 to 0 0046 it could be explained by the head configuration over the swi the head differences hint for the transverse cases were about one to two orders of magnitude higher than the reported values of earlier longitudinal cases this higher head gradient in the transverse direction over the compound shaped bedform provided strong force to drive transverse hyporheic flow through the bed thus more transverse hyporheic fluxes were generated than those induced by the longitudinal processes despite that the maximum magnitude of transverse flow vsmax in the river water was only around 2 of the maximum magnitude of mainstream river flow umax the comparison results suggested that the compound riverbed cross section could be more efficient in driving transverse hyporheic flow than the longitudinal dune shaped bedform that drove hyporheic flow in the river flow direction 4 conclusions and implications compound bedforms across a river and its floodplains causes complex transverse flow structures in the river flow which in turn lead to head variations on the bed surface and induce hyporheic flow in the transverse direction through the bed however previous investigations mostly focused on the longitudinal bedform induced hyporheic flow in the river flow direction in this paper numerical simulations were conducted to investigate the dynamic processes of transverse hyporheic flow in a river system with compound beds comprising a main river channel and a floodplain we focused the analysis on the river water flow structures hyporheic flow patterns and exchange across the bed surface under the influence of bank slopes and river discharges seeking to answer 1 what are the characteristics of transverse hyporheic flow and solute transport in the cross section of a compound river system 2 what are the main influencing factors also a particular question to answer in this paper was on the relative importance of transverse hyporheic flow and longitudinal hyporheic flow in a river system the numerical results showed that transverse flow secondary currents formed in the sloping bank area across the compound channel leading to significant hydraulic head variations on the bed surface which in turn drove two circulating cells through the bed the river water entered the bed from a sloping bank area and exited from the main channel and floodplain areas respectively the circulating pore water flow under the floodplain was stronger than that under the main channel the hyporheic exchange was mostly driven by the circulation through the shallow bed generally as the bank slope angle increased the hyporheic flow through the bed was strengthened by the larger head gradient on the swi associated with the intensified secondary currents in the river flow the circulating cells under both the main channel and floodplain were contracted to a much smaller size leading to the shortened solute transit time through the corresponding pathlines and consequently decreased solute mass in the bed the effects of river discharge on the hyporheic flow pattern and exchange were greater in cases with larger bank slope angles as the river flow rate increased the total interfacial flux across the bed increased with relatively steep bank slope generally with the expansion of circulating cells the solute transit time through the pathlines extended and solute mass in the sediment increased in the transverse direction the compound bedform caused head gradients that were one to two orders of magnitude higher than those of earlier longitudinal cases which consequently create more hyporheic fluxes across the swi than those of the longitudinal cases our numerical modelling study indicates that compound bedform can drive significant transverse hyporheic flow in the cross section such a compound cross section is even more efficient in driving the transverse hyporheic flow than longitudinal dune shaped bedform hyporheic exchange rate is highest near the sloping bank this implies an intensive nutrient processing within this zone across the river bed moreover the modelling results here also highlight the importance of bank slope for hyporheic zone extent and the characteristics of the 2 d transverse hyporheic flow field in the cross section of a compound river the extent of the hyporheic zone area within the compound cross section strongly decreased with increased bank slope angle accompanied by a higher hyporheic exchange flow rate and shorter residence time bank slope is expected to control solute transport and retention processes through such exchange hydrodynamics an increased bank slope angle could decrease both the solute transfer rate and total amount of solute accumulation in the bed this is because the transverse hyporheic zone area is much smaller at steeper bank slope which minimizes the effects of increasing relative hyporheic flux this implies that under the influence of bank slope the solute transport within hyporheic zones in the cross section is more sensitive to the size of hyporheic zone than the fluid flux our findings elucidated distinct 2 d patterns and dynamics of transverse hyporheic exchange in compound rivers and for the first time highlighted how bank slope affects the hyporheic exchange processes and the importance of transverse hyporheic flow relative to the longitudinal cases in a river system understanding these physical processes will improve assessment of the integrated biogeochemical transformation of solutes between the main channel and floodplain in a compound river system given that our model assumed steady flow conditions in the water column the results should be taken as explanatory of the hydrodynamic processes rather than predictive for most natural flows are unsteady flows turbulent momentum transfer across the swi neglected in this paper could enhance the transverse hyporheic exchange in compound sections the importance of the faster exchange processes associated with fluid turbulence on the transverse flow requires further investigations these investigations should also consider groundwater upwelling caused by regional head gradients which have been found to significantly affect the hyporheic exchange rate and extent fox et al 2014 hester et al 2013 trauth et al 2013 considering the lack of measurements of transverse hyporheic flow in a compound river channel experimental studies in this area are needed in order to validate the modelling results acknowledgments this work was supported by the chinese scholarship council the national natural science foundation of china grant numbers 51239003 and the australian research council results of the numerical simulations supporting the conclusions can be obtained through an e mail request to the corresponding author 
