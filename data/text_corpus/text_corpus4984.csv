index,text
24920,understanding how energy and matter flow among habitats is a central issue in ecology in lake ecosystems benthic pelagic coupling b p coupling was mainly studied based on the diets of top consumers at a population level or through food chains however how b p coupling operates at the ecosystem level is largely unknown in the present study we revealed b p coupling within an energetic food web framework combining stable isotope analyses and mass balanced model we constructed the energetic food webs of two large shallow lakes of different trophic status based on field survey data we also defined benthic and pelagic components based on the proportion of consumer energy uptake from phytoplankton benthic 50 pelagic 50 benthivore 20 planktivore 80 coupler 20 80 and quantified the energy flux through b p coupling in the two lake food webs the total consumption was estimated to be 699 t km2 y in lake erhai mesoeutrophic lake and 2094 t km2 y in lake dianchi hypereutrophic lake and the b p coupling energy was 405 t km2 y and 213 t km2 y respectively in these lakes b p coupling occurred on multiple trophic levels lower trophic level consumers contributed the largest proportion 90 and 98 while top consumers were of limited importance most coupling links were weak and energy exchange was highly asymmetric with the total amount of energy exported from benthic part to pelagic part being over 4 folds of the counter flux the quantity and pattern of b p coupling vary between the mesoeutrophic and hypereutrophic lakes in terms of energy flux per unit area the total system throughput in the mesoeutrophic lake lake erhai was 3 73 times of that in the hypereutrophic lake lake dianchi while the proportion of coupling energy was much lower in the former 19 than the latter 31 a greater energy flux through pelagic to benthic pathways was found in the hypereutrophic lake and most of the coupling energy was contributed by consumers at higher trophic levels besides the coupling strength was stronger in the hypereutrophic than the mesoeutrophic lake we showed for the first time how b p coupling operates in lake energetic food webs our results provided new insights into understanding the energy flux through b p coupling of lake ecosystems and how such coupling could be changed by environmental disturbances we also provided a new approach to reveal habitat coupling within an energetic food web framework keywords benthic pelagic coupling energetic food web ecopath shallow lake eutrophication 1 introduction understanding how energy and matter flow among habitats is a central issue in ecology barnes et al 2007 habitat coupling refers to the integration of resources by consumers from different habitats schindler and scheuerell 2002 tunney et al 2018 it occurs in a variety of ecosystems and various forms such as benthic pelagic coupling in lakes root aboveground interaction in terrestrial habitats and reef seagrass interface in estuary scheu 2001 schindler et al 1996 valentine et al 2007 it exerts strong influences on many key ecological processes and plays important roles in maintaining population persistence community stability and ecosystem functioning huxel and mccann 1998 kidd et al 2001 polis et al 1997 schreiber and rudolf 2008 vadeboncoeur et al 2005 vander zanden and vadeboncoeur 2002 habitat coupling is also found to be closely related to some environmental issues such as transport of pollutants and dispersal of pathogens lambin et al 2010 schindler and scheuerell 2002 although there is increasing attention on the effects of habitat coupling understanding how it operates is still challenging especially in ecosystems under persistent anthropogenic disturbances post et al 2000 previous studies considered the benthic and pelagic parts separately with overwhelming attention on the latter vadeboncoeur et al 2002 recent studies have revealed a significant amount of lake production contributed by benthic communities chandra et al 2005 schindler and scheuerell 2002 vander zanden and vadeboncoeur 2002 wagner et al 2012 moreover many studies have shown the trophic complexity of benthic biota with diverse feeding habits and a high degree of omnivory liu et al 2006 schindler and scheuerell 2002 however benthic communities are usually treated as simplified food web compartments in whole lake food web construction aravindan 1993 vander zanden and vadeboncoeur 2002 walline et al 1993 some studies have assessed the importance of benthic and pelagic food webs based on an estimation of production chandra et al 2005 schindler et al 1996 vadeboncoeur et al 2001 when interactions between benthic and pelagic food webs are ignored production is one good way to assess the relative importance of benthic and pelagic food webs however the interactions between these two parts are continuous and substantial vadeboncoeur et al 2002 one key challenge of understanding b p coupling is quantification dimitriou et al 2015 previously quantification of b p coupling has been mostly based on diet analyses of specific consumers mainly fish using stable isotope analysis bartels et al 2016 batt et al 2015 chandra et al 2005 huxel and mccann 1998 tunney et al 2018 vander zanden and vadeboncoeur 2002 fish and top consumers with high mobility were reasonably considered to be the major spatial connectors gorman et al 2012 consequently primary producers and small lower trophic consumers were often integrated to represent the basal resources vadeboncoeur et al 2001 such coarse resolution has largely neglected the coupling that might occur on lower trophic levels kahn and leys 2016 also the vertical migration of planktons can potentially strengthen trophic interactions between benthic and pelagic food webs rautio and vincent 2006 until now such complexity of b p coupling is largely unknown vander zanden and vadeboncoeur 2002 suggested that quantifying energy pathways assists the understanding of food web dynamics and interactions energy flux by itself an ecosystem function not only links multitrophic communities to other ecosystem functions but also provides a unified currency for cross system comparisons barnes et al 2018 quantification of energy flux in a mass balanced model could provide a realistic picture of how b p coupling operates vander zanden and vadeboncoeur 2002 many energetic food webs have been built for lake ecosystems very few are oriented towards understanding the role of b p coupling lake management mitigating anthropogenic disturbances needs better comprehension of how disturbance changes b p coupling doi et al 2010 griffiths et al 2017 eutrophication has long become one of the most severe environmental problems to lake ecosystems conley et al 2009 donohue et al 2009 huisman et al 2018 smith 2003 smith et al 1999 it has been widely recognized that eutrophication shapes the physical chemical characteristics biological community structure and ecosystem functioning of lakes to various degrees although the effects of eutrophication have been studied intensively and extensively its impacts on b p coupling receive little concern tunney et al 2012 in this study we revealed the patterns of b p coupling within a whole lake food web framework we asked three specific questions 1 how much energy is transferred through b p coupling in lake food webs 2 by whom and in which ways do these couplings operate and 3 how is b p coupling affected by eutrophication to answer these questions we constructed whole lake energetic food webs in two shallow lakes of different trophic status considering the ubiquity of b p coupling schindler and scheuerell 2002 we assumed that the energy flux through b p coupling would make a large proportion of whole lake food webs although top consumers were important spatial connectors there were studies suggesting habitat coupling by lower trophic level consumers batt et al 2015 vander zanden and vadeboncoeur 2002 wolkovich et al 2014 therefore we assumed that coupling was not only performed by top consumers concurrently as organisms are of various production rate the amount of coupling energy might vary along with trophic levels finally we assumed that eutrophication could affect both the amount of energy flux and the manner that b p coupling operates as under eutrophication both the decrease in benthic food resources and the deterioration of pelagic food resources vadeboncoeur et al 2003 would compel cross habitat feeding batt et al 2015 2 methods 2 1 study lakes the present study was carried out in two subtropical shallow lakes lake erhai 25 36 25 58 n 100 06 100 28 e and lake dianchi 24 40 25 02 n 102 36 102 47 e on yunnan guizhou plateau located in the southwest of china fig 1 the two lakes are similar in size morphology and climate the surface area of lake erhai is 250 km2 shoreline length 128 km and average water depth 10 6 m the surface area of lake dianchi is 300 km2 shoreline length 163 km and average water depth 4 4 m lake erhai is regarded as a mesoeutrophic lake with the total nitrogen and phosphorus in lake water during field surveys being 0 51 mg l and 0 03 mg l respectively lake dianchi is a hypereutrophic lake with the total nitrogen and total phosphorus in lake water during field surveys being 6 71 mg l and 0 11 mg l respectively wang et al 2018 heavy cyanobacteria bloom occurs during april october every year in lake dianchi while little is recorded in lake erhai li et al 2014 the coverage of macrophytes is 7 9 in lake erhai and less than 1 in lake dianchi chen et al 2003 li et al 2011 2 2 biological data collection field surveys were carried out during 2015 2016 and each lake was sampled for three times i e august 2015 november 2015 and april 2016 samples were taken from both inshore and offshore areas there were 13 inshore sites and 7 offshore sites in lake erhai and 10 inshore sites and 8 offshore sites in lake dianchi fig 1 quantitative samples of phytoplankton benthic algae macrophytes zooplankton and macroinvertebrates were collected to determine the taxonomic composition density and biomass of each taxon fish sampling was carried out during the open fishing season october 2015 january 2016 phytoplankton and zooplankton were collected on offshore sites two to three water samples were taken vertically from middle to surface water column at each site using a 5 l water sampler water was mixed before concentrated through plankton net 125 μm for zooplankton identification mixed water samples of 1 l were preserved with lugol s solution taken back to the laboratory settled for 24 h for taxonomic identification and biomass estimations according to standard protocols zhang and huang 1991 according to the dry wet ratios suggested by zhang and huang 1991 the wet mass was converted to dry mass mg l benthic algae were sampled in inshore sites for quantification filamentous and non filamentous attached algae were sampled separately each sample was collected from substrates with an area of 10 10 cm2 and three random replicates were taken at each site filamentous algae were scraped off from substrates kept in a 4 c ice chilled box and washed with distilled water in the laboratory non filamentous algae were brushed off from substrates centrifuged with colloidal silica ludox tm50 sigma aldrich germany and the supernatant with algae was carefully collected and filtered on predried and preweighted whatman gf c glass fiber filters the glass fiber filters with non filamentous algae and filamentous algae samples were oven dried at 60 c for at least 48 h to determine the dry mass which was further converted to ash free dry mass according to apha 1998 aquatic plants including macrophytes and hygrophytes were collected at inshore sites three to ten samples of macrophytes and one to three samples of hygrophytes were collected at each site depending on the heterogeneity of lake bathymetry macrophytes were collected by a scythe of 0 28 m2 and hygrophytes were collected within a plot of 0 25 m2 all species encountered were recorded the aboveground part of plants was collected and oven dried at 60 c for at least 48 h to determine the dry mass macroinvertebrates were sampled from both the inshore and offshore sites each inshore sample was collected with a d shaped kick net with an area of 3 m2 and offshore samples were collected with a modified peterson grab 1 16 m2 all specimens were identified to the genus level as possible following the identification keys epler 2001 liu et al 1993 morse et al 1984 the dry mass g m2 of each specimen was converted from the wet mass using dry wet ratios from previous studies liang and yan 1999 wang et al 2018 yan 1998 zhao 2010 for mollusks the shell free dry mass was used fish samples were collected from local fishermen and mainly caught by gill nets and trammel nets all specimens were identified to species or genus chu and chen 1990 data of total fish catch and fish stocking were obtained from the local government the biomass of each taxon was estimated using the basic equations 1 biomass yield fishing mortality 2 fishing mortality total mortality natural mortality where yield is in t km 2 year 1 the total mortality was suggested to be approximate to p b production biomass ratio under steady conditions pauly et al 2000 p b ratios were referred to previous studies shan et al 2014 tang 2013 2 3 stable isotope analysis basal resources and consumers were sampled for stable isotope analyses detritus was collected from sediments in both inshore and offshore areas coarse particle organic matters cpom 1000 m and fine particle organic matters fpom 250 1000 μm were separated by a sieve and the latter were filtered through pre combusted whatman gf f glass fiber filters particle organic matters pom was filtered on the pre combusted whatman gf f glass fiber filters until clogging plankton was collected with triple layered plankton net of mesh size of 64μm 125 μm and 250 μm after microscopic examination samples in the nets of 64 and 125 μm mesh size were treated as phytoplankton and samples in the net of 250 μm were treated as zooplankton both phytoplankton and zooplankton samples were filtered through pre combusted whatman gf f glass fiber filters benthic algae were subsampled from the biomass samples aquatic plants were separated into c4 groups mainly submerged macrophytes and poaceae species and c3 groups the others and the aboveground parts of the dominant species were collected for macroinvertebrate 1 3 samples were collected for each taxon encountered for mollusks shrimps and fish 3 6 muscles were preserved for each taxon all stable isotope samples were kept in a 4 c ice chilled box and oven dried at 60 c for 48 h for further analysis to estimate the c13 and n15 content each dried sample was grounded homogenized and encapsulated into a 4 6 mm tin capsule samples were analyzed on a delta v advantage isotope ratio mass spectrometer thermo fisher scientific germany at the institute of hydrobiology chinese academy of sciences the references are usgs40 and usgs 41 except for small body macroinvertebrates more than 3 replicates were analyzed for each taxon for small body macroinvertebrates at least 1 sample was analyzed for each taxon taxa with inadequate samples e g genus level were combined and labeled with a higher taxonomic level e g family level to quantify the trophic relationships the diet of each consumer was analyzed using the bayesian stable isotope mixing model bayesian simm with the siar package in r r core team 2018 hopkins iii and ferguson 2012 parnell 2008 phillips et al 2014 the qualitative trophic relationships were determined using gut content information collected from the literature chu and chen 1990 morse et al 1984 to improve the analysis results gut content information was referred to as a prior and concentrations of carbon and nitrogen were also included in the model also different trophic enrichment factors tefs were applied according to the taxonomic groups e g mollusks insects shrimps fishes etc regarding their feeding habits france 1995 vander zanden and rasmussen 2001 vanderklift and ponsard 2003 2 4 energetic food web construction 2 4 1 model construction static mass balance models were constructed for the two lakes using the software ecopath version 6 2 http www ecopath org the basic equation for ecopath is as follow 3 b i p b i e e i j 1 n b j p b j d c i j y j e j b a j 0 where i and j stand for resource and consumer b is the biomass p b the production to biomass ratio ee ecotrophic efficiency dcij fraction of resource i in the diet of consumer j y the total fishery catch rate e the net migration rate ba biomass accumulation rate the model requires the following parameters biomass p b ratio q b consumption biomass ratio and diet composition of each taxon biomass of each taxon was estimated from our field investigations values of p b ratio and q b ratio of previous studies was referred shan et al 2014 tang 2013 yan 1998 zhang and huang 1991 when data were lacking values of the same or a similar genus were used diet composition was acquired from the bayesian simm since the ecopath model requires ee not exceeding 1 diet composition was finely adjusted to balance the model the total system throughput the sum of total consumption total export total respiration and total flows to detritus expressed in t km2 year tst and the total consumption of the system were extracted from ecopath 2 4 2 energy flux quantification to estimate the energy flux through pelagic and benthic pathways the basal resources were classified into two groups the pelagic basal resource pbr and the benthic basal resource bbr in this study pbr is phytoplankton and bbr consists of cpom fpom benthic algae filamentous and non filamentous c3 and c4 aquatic plants the energy flux from a basal resource to a given consumer was calculated with the following equation 4 f i j c j f i j where fij is the energy flux from resource i to consumer j cj is the energy consumption of consumer j derived from the outputs of ecopath fij is the fraction of the total input to consumer j that came from resource i overall pathways of all lengths hannon 1973 ulanowicz 2004 the fraction of energy flux from pbr to a consumer fpbr is the fraction of energy from phytoplankton while the fraction of bbr fbbr was a sum of all benthic basal resources the calculations were processed with python version 2 7 2 4 3 trophic position estimation when estimating the trophic position of consumers acquire energy from multi habitat e g pelagic and benthic habitat a two baseline strategy according should be applied to capture the spatial heterogeneity in nitrogen stable isotopes post 2002 primary consumers typically feeding upon pbr usually bivalves and bbr gastropods are generally treated as the two baselines the pelagic baseline and the benthic baseline the post s equation 2002 is as below 5 t p c o n λ δ 15 n c o n δ 15 n b a s e 1 α δ 15 n b a s e d 2 1 α 3 4 where tpcon is trophic position of a consumer λ is trophic position of baseline species i e λ 2 δ15ncon is the 15n isotope value of the consumer δ15nbase1 is the 15n isotope value of the pelagic baseline δ15nbase2 is the 15n isotope value of the benthic baseline α is the fraction of energy flux from pelagic basal resources pbr to the consumer 2 5 b p coupling quantification 2 5 1 benthic and pelagic component definition previous studies define the benthic and pelagic parts in lake food webs with much vagueness since such definition was mainly based on the spatial areas where consumers commonly live or feed but not relied on the trophic resources they utilized schindler and scheuerell 2002 in this study the fraction of energy flux from pbr was used to separate the benthic and pelagic parts consumers with 50 energy uptake from pbr were treated as the components of the pelagic part and the rest as the components of the benthic part fig 2 taxa with 20 80 energy uptake from pbr were defined as couplers among which two sub groups were classified as b couplers 20 50 and p couplers 50 80 taxa with 20 energy uptake from pbr were defined as benthivores and those with 80 as planktivores 2 5 2 coupling energy estimation the coupling energy refers to the total energy exchanged among benthivores planktivores and couplers it also equals to the total consumption of the food web minus the non coupling energy i e energy flux among benthivores or planktivores to facilitate the calculation the following equations were used 6 f c c f b f p 7 f b i 1 n j 1 n c b j f b i b j f o r i j 8 f p i 1 n j 1 n c p j f p i p j f o r i j where f c is the amount of coupling energy f b is the energy flux among benthivores f p is the energy flux among planktivores c is the total energy consumption c b j is the consumption of a benthivore c p j is the consumption of a planktivore f b i b j is the diet fraction of a benthivore consumer b j directly contributed by a benthivore resource b i f p i p j is the diet fraction of a planktivore consumer p j directly contributed by a planktivore resource p i the coupling energy flowing to a trophic level was calculated as 9 f b j c b j f p b r b j 10 f p j c p j f b b r p j where f b j is the energy uptake of pbr by a benthic consumer and f p j is the energy uptake of bbr by a pelagic consumer c b j or c p j represents the energy consumption of the corresponding consumer f p b r b j is the fraction of energy uptake from pbr by the benthic consumer and f b b r p j is fraction of energy uptake from bbr by the pelagic consumer the total energy flux coupled at each trophic level and by each group were calculated 2 5 3 direct energy flux between the benthic and pelagic parts the exchanged energy between the benthic and pelagic parts was calculated with the following equations 11 f p b i 1 n j 1 n c b j f p i b j 12 f b p i 1 n j 1 n c p j f b i p j where f p b the total energy flux from pelagic components to benthic components f b p is the total energy flux from benthic components to pelagic components 2 5 4 energy coupled through couplers to reveal the role of couplers in b p coupling the proportion of coupling energy through couplers was calculated for the whole food web as well as by each trophic level 13 p a b i 1 n j 1 n f a i b j f b i a j c i j 14 p a b r j r f a i b j f b i a j j r f j i j where group a and b represent the two groups of the benthivore coupler pair planktivore coupler pair or benthivore planktivore pair p a b is the proportion of energy flux between group a and b over total consumption f a i b j is the energy flux from group a to group b f b i a j is the energy flux from group b to group a c the total consumption of the system in eq 14 p a b r is the proportion of energy flux between group a and b at trophic level r f j is the input to consumer j 2 5 5 strength of coupling links to assess the strength of coupling two aspects were considered the relative amount of coupling energy and the complexity of coupling links the relative amount of coupling energy is the proportion of total coupling energy in total consumption and the complexity of coupling links is represented by the connectance of coupling links the strength of coupling s c was calculated as follows 15 s c c o u p l i n g e n e r g y t o t a l c o n s u m p t i o n l c s 2 where lc is the number of coupling links s is the total species number based on this calculation a stronger coupling is derived from a larger relative amount of coupling energy and more complex coupling links 3 results 3 1 the energetic food web the energetic flow diagrams are shown in fig 3 trophic heights in the two lakes were rather similar 3 9 in lake erhai and 4 0 in lake dianchi the food web size was 93 in lake dianchi and 115 in lake erhai food web composition in the two lakes was generally similar benthivore consisted the majority 58 out of 115 in lake erhai and 69 out of 93 in lake dianchi and planktivore was the smallest minority 7 out of 115 in lake erhai and 5 out of 93 in lake dianchi compared to lake erhai lake dianchi supported a larger proportion of benthivores 75 vs 50 fig 4 the total system throughput tst was estimated to be 1802 t km2 y in lake dianchi and 6729 t km2 y in lake erhai and the total consumption was 699 t km2 y and 2094 t km2 y respectively the tst of lake erhai was 3 73 times of lake dianchi and the total consumption was 2 99 times of lake dianchi based on the diet composition derived from stable isotope analyses the average consumption of pbr consists 28 4 of consumers diet in lake erhai and 14 8 of consumers diet in lake dianchi in contrary based on the mass balanced model consumers energy uptake including direct and indirect energy flow from pbr consists 79 0 of the total consumption in lake erhai and 58 8 in lake dianchi for more details about the two models please refer to appendix s3 and s4 3 2 b p coupling the simplified b p coupling conceptual diagram is shown in fig 5 the proportion of coupling energy was much higher in lake dianchi 31 than in lake erhai 19 fig 6 in the two lakes the largest energy flux was detected among planktivores 50 in both lakes 1608 t km2 y in lake erhai and 380 t km2 y in lake dianchi followed by b p coupling 405 t km2 y in lake erhai and 213 t km2 y in lake dianchi and the smallest flux was among benthivores 15 in both lakes 64 t km2 y in lake erhai and 101 t km2 y in lake dianchi the energy flux among benthivores was higher in lake dianchi 14 vs 3 the direct energy flux between the benthic and pelagic parts was highly asymmetric the pelagic to benthic flux and benthic to pelagic flux in lake erhai were 13 t km2 y and 338 t km2 y the pelagic to benthic flux and benthic to pelagic flux in lake dianchi were 34 t km2 y and 130 t km2 y the total amount of benthic to pelagic flux being 4 folds lake dianchi and 25 folds lake erhai of the counter flux in terms of trophic level specific coupling most coupling performed by benthic omnivores and zooplanktons were around trophic level 2 0 in lake erhai accounting for 95 0 of the total coupling energy fig 7 the main coupling energy flows were from fpom to zooplankton 318 2 t km2 y zooplankton to shrimp 6 2 t km2 y fpom to silver carp 2 0 t km2 y and shrimp to carp 1 8 t km2 y in lake erhai in lake dianchi most coupling performers were at comparatively higher trophic position around trophic level 2 0 3 0 accounting for 73 0 of the total coupling energy fig 6 in lake dianchi the main coupling energy flows were from fpom to zooplankton 124 4 t km2 y from zooplankton to redfin culter 4 7 t km2 y from fpom to silver carp 4 6 t km2 y from phytoplankton to goldfish 3 8 t km2 y the largest amount of coupling energy flows directly between benthivores and planktivores in both lakes 108 3 t km2 y in lake erhai and 266 8 t km2 y in lake dianchi appendix s5 it was the same to both lakes that the energy flowing between benthivores and couplers occurred mainly around trophic levels 1 0 2 0 benthic omnivores and trophic level 3 0 benthic predators appendix s6 the b p coupling strength sc is 0 0028 in lake erhai and 0 0094 in lake dianchi the pelagic to benthic coupling complexity is 0 0078 in lake erhai and 0 0209 in lake dianchi the benthic to pelagic coupling complexity is 0 033 in lake erhai and 0 0193 in lake dianchi 4 discussion 4 1 whole lake energetic food web high resolution energetic food webs help to reveal the role of consumers in lake b p coupling in lake ecosystems pelagic basal resources pbr are the main energy sources of consumers often consisting about 50 75 of the total energy uptake hossaina et al 2010 moreau et al 1993a b similar patterns were found in the present study energy uptake from pbr consisted more than 55 of total energy consumption in both study lakes we found the average proportion of pbr in consumer diet based on stable isotope analysis was much less than the energy contribution of pbr in the total consumption of the ecosystem based on the mass balanced model it indicated that the importance of a certain food source in an ecosystem might be overlooked if only assessed with stable isotope analysis result we found both the system throughput and total consumption were lower in the hypereutrophic lake lake dianchi than the mesoeutrophic lake lake erhai the reason might be that long term eutrophication could lead to the decrease in species diversity and biomass heip 1995 smith et al 1999 in the present study we found a higher relative benthic basal resources bbr uptake in the hypereutrophic lake where top consumers were supported mainly by bbr this is the reason that top consumers in the hypereutrophic lake were mostly benthivores energy uptake from pbr 50 moreover benthivores were the main food web components in the hypereutrophic lake in a highly eutrophic lake the frequent algae bloom homogenizes pbr and lowers food edibility ger et al 2014 huisman et al 2018 sukenik et al 2015 and thus reduce the consumers energy uptake of pbr it has been commonly accepted that eutrophication impedes benthic primary productions vadeboncoeur et al 2001 and leads to the loss of benthic pathways vadeboncoeur et al 2003 however we found a similar number of benthic components in both lakes 85 vs 78 on contrast there were less pelagic components in the hypereutrophic lake 30 vs 15 it implies the possibility that on the aspect of pathway number it was the pelagic pathways rather than benthic pathways which were largely reduced in the hypereutrophic lake 4 2 b p coupling in lakes the proportion of b p coupling energy varies between lake ecosystems fig 6 the proportion of coupling energy was much higher in the hypereutrophic lake than mesoeutrophic lake indicating that b p coupling might be strengthened through eutrophication similar results were also found in other lakes suffering progressive cultural eutrophication batt et al 2015 chandra et al 2005 vadeboncoeur et al 2001 the underlying mechanisms that eutrophication could promote b p coupling in the study lakes are discussed as follows first heavy cyanobacterial blooms in the hypereutrophic lake could result in toxic and low quality pelagic basal resources pbr ger et al 2014 ghadouani et al 2003 in this case pbr was less involved directly in the pelagic food web contrarily they become detritus and sink to the lake bottom as a food resource for benthic consumers our stable isotope data also revealed a potentially higher consumption of detritus by consumers in the hypereutrophic lake compared to the mesoeutrophic lake benthivores such as many oligochaetes and chironomids prefer eutrophicated water brinkhurst 1970 casellato and caneva 1994 finogenova 1996 and they perform coupling by feeding fpom mostly originated from pbr potentially strengthening energy exchange between the benthic and pelagic parts second consumers feeding in multi habitats would rely more on littoral bbr due to the homogenization of offshore habitat under eutrophication wang et al 2018 a larger proportion of bbr uptake by pelagic consumers was found in the more eutrophicated lake which might be caused by the change of primary consumers an increase in benthic detritus feeders 5 vs 64 detritivore biomass in macroinvertebrates such a change could strengthen b p coupling by increasing bbr energy uptake by couplers and planktivores fig 7 previously top consumers usually fish were considered to play a chief role in lake b p coupling since they are highly mobile and capable of integrating food resources from different habitats fry et al 2008 gorman et al 2012 vander zanden and vadeboncoeur 2002 in these studies the measurement of coupling strength was mainly based on diet composition in these studies consumers feed equally from each habitat were considered as the strongest couplers bartels et al 2016 tunney et al 2018 2012 however the role of top consumers might be overestimated since the studies did not assess the amount of energy coupled by smaller or lower trophic level consumers who possess large biomass or a high production biomass ratio p b ratio in the present study we found that the role of top consumers in b p coupling was rather limited in the energetic perspective while consumers at the lower to middle trophic levels were quantitatively important the largest proportion of energy exchanged between the benthic and pelagic parts was performed directly between lower trophic level benthivores and planktivores such as detritus and zooplankton zooplankton and shrimps etc such coupling pathways have long been neglected and have not been quantitatively revealed in a whole lake energetic food web before also b p coupling occurred at multiple trophic levels implied a complex manner of habitat coupling in the study lakes concerning the role of each group involved in the coupling we found that benthic couplers i e shrimps and other benthic omnivores in the hypereutrophic lake played a stronger role than in the mesotrophic lake especially a stronger coupling of benthic predators and top consumers was found in the hypereutrophic lake therefore from an energetic perspective eutrophication strengthened the coupling role of benthic omnivores and predators in b p coupling we also found a strong asymmetry in b p coupling in the study lakes the benthic to pelagic pathways dominated in the binary exchange of energy between the benthic and pelagic part which indicated that there was a large amount of energy from bbr flowing to the pelagic food web it is mainly through the feeding of pelagic primary consumers of fine particulate organic detritus mainly consisting of dead algae and biofilms we also found a greater asymmetry in the mesoeutrophic lake than in the hypereutrophic lake the hypereutrophic lake presented a lower level of asymmetry suggesting that eutrophication might weaken such asymmetry in b p coupling asymmetries have been commonly recognized in network structure consumer resource interactions and energy flow in food webs schindler and scheuerell 2002 how that asymmetry in b p energy exchange related to the ecosystem functioning is unknown but there appears to be a variation of this asymmetry between the meso and hyper eutrophic lakes there was a stronger strength of b p coupling sc in the hypereutrophic lake the larger proportion of coupling energy together with the higher complexity of pelagic to benthic feeding relationships resulted in a high b p coupling strength in the hypereutrophic lake compared to mesoeutrophic lake zooplankton in the hypereutrophic lake depends more on energy from fine particulate organic detritus and benthic consumers feed more on zooplankton and sedimented phytoplankton it also appears that more than 70 coupling links holding energy flux less than 0 1 kg km2 y such patterns were consistent with previous studies that weak links are the majority in ecosystems berlow 1999 berlow et al 2004 mccann et al 1998 however the role of weak coupling links could not be ignored considering their importance in stabilizing ecosystems berlow 1999 paine 1980 5 conclusion in the present study we revealed b p coupling within an energetic food web framework combining stable isotope analyses and mass balanced model b p coupling occurred on multiple trophic levels and consumers on the lower trophic level other than top consumers were quantitatively important energy through b p coupling in lakes was asymmetric and most coupling links were weak in terms of energy flux besides we found that although eutrophication decreased the total amount of energy flux in lake food webs it could strengthen b p coupling by increasing the proportion of coupling energy and the complexity in coupling links declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment we thank jianqiang ouyang saibo yuan wenjuan gao yaxue ma and zhendong yang tong wu senrong fan yilin wang and zhen wu for their help on the fieldwork we also thank yajing he weisong feng yan li and saibo yuan for taxonomic identification and milen marinov for the helpful comments on the manuscript this work was supported by the national basic research program of china grant number 2015cb458900 appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2019 108928 appendix a supplementary data the following is supplementary data to this article 
24920,understanding how energy and matter flow among habitats is a central issue in ecology in lake ecosystems benthic pelagic coupling b p coupling was mainly studied based on the diets of top consumers at a population level or through food chains however how b p coupling operates at the ecosystem level is largely unknown in the present study we revealed b p coupling within an energetic food web framework combining stable isotope analyses and mass balanced model we constructed the energetic food webs of two large shallow lakes of different trophic status based on field survey data we also defined benthic and pelagic components based on the proportion of consumer energy uptake from phytoplankton benthic 50 pelagic 50 benthivore 20 planktivore 80 coupler 20 80 and quantified the energy flux through b p coupling in the two lake food webs the total consumption was estimated to be 699 t km2 y in lake erhai mesoeutrophic lake and 2094 t km2 y in lake dianchi hypereutrophic lake and the b p coupling energy was 405 t km2 y and 213 t km2 y respectively in these lakes b p coupling occurred on multiple trophic levels lower trophic level consumers contributed the largest proportion 90 and 98 while top consumers were of limited importance most coupling links were weak and energy exchange was highly asymmetric with the total amount of energy exported from benthic part to pelagic part being over 4 folds of the counter flux the quantity and pattern of b p coupling vary between the mesoeutrophic and hypereutrophic lakes in terms of energy flux per unit area the total system throughput in the mesoeutrophic lake lake erhai was 3 73 times of that in the hypereutrophic lake lake dianchi while the proportion of coupling energy was much lower in the former 19 than the latter 31 a greater energy flux through pelagic to benthic pathways was found in the hypereutrophic lake and most of the coupling energy was contributed by consumers at higher trophic levels besides the coupling strength was stronger in the hypereutrophic than the mesoeutrophic lake we showed for the first time how b p coupling operates in lake energetic food webs our results provided new insights into understanding the energy flux through b p coupling of lake ecosystems and how such coupling could be changed by environmental disturbances we also provided a new approach to reveal habitat coupling within an energetic food web framework keywords benthic pelagic coupling energetic food web ecopath shallow lake eutrophication 1 introduction understanding how energy and matter flow among habitats is a central issue in ecology barnes et al 2007 habitat coupling refers to the integration of resources by consumers from different habitats schindler and scheuerell 2002 tunney et al 2018 it occurs in a variety of ecosystems and various forms such as benthic pelagic coupling in lakes root aboveground interaction in terrestrial habitats and reef seagrass interface in estuary scheu 2001 schindler et al 1996 valentine et al 2007 it exerts strong influences on many key ecological processes and plays important roles in maintaining population persistence community stability and ecosystem functioning huxel and mccann 1998 kidd et al 2001 polis et al 1997 schreiber and rudolf 2008 vadeboncoeur et al 2005 vander zanden and vadeboncoeur 2002 habitat coupling is also found to be closely related to some environmental issues such as transport of pollutants and dispersal of pathogens lambin et al 2010 schindler and scheuerell 2002 although there is increasing attention on the effects of habitat coupling understanding how it operates is still challenging especially in ecosystems under persistent anthropogenic disturbances post et al 2000 previous studies considered the benthic and pelagic parts separately with overwhelming attention on the latter vadeboncoeur et al 2002 recent studies have revealed a significant amount of lake production contributed by benthic communities chandra et al 2005 schindler and scheuerell 2002 vander zanden and vadeboncoeur 2002 wagner et al 2012 moreover many studies have shown the trophic complexity of benthic biota with diverse feeding habits and a high degree of omnivory liu et al 2006 schindler and scheuerell 2002 however benthic communities are usually treated as simplified food web compartments in whole lake food web construction aravindan 1993 vander zanden and vadeboncoeur 2002 walline et al 1993 some studies have assessed the importance of benthic and pelagic food webs based on an estimation of production chandra et al 2005 schindler et al 1996 vadeboncoeur et al 2001 when interactions between benthic and pelagic food webs are ignored production is one good way to assess the relative importance of benthic and pelagic food webs however the interactions between these two parts are continuous and substantial vadeboncoeur et al 2002 one key challenge of understanding b p coupling is quantification dimitriou et al 2015 previously quantification of b p coupling has been mostly based on diet analyses of specific consumers mainly fish using stable isotope analysis bartels et al 2016 batt et al 2015 chandra et al 2005 huxel and mccann 1998 tunney et al 2018 vander zanden and vadeboncoeur 2002 fish and top consumers with high mobility were reasonably considered to be the major spatial connectors gorman et al 2012 consequently primary producers and small lower trophic consumers were often integrated to represent the basal resources vadeboncoeur et al 2001 such coarse resolution has largely neglected the coupling that might occur on lower trophic levels kahn and leys 2016 also the vertical migration of planktons can potentially strengthen trophic interactions between benthic and pelagic food webs rautio and vincent 2006 until now such complexity of b p coupling is largely unknown vander zanden and vadeboncoeur 2002 suggested that quantifying energy pathways assists the understanding of food web dynamics and interactions energy flux by itself an ecosystem function not only links multitrophic communities to other ecosystem functions but also provides a unified currency for cross system comparisons barnes et al 2018 quantification of energy flux in a mass balanced model could provide a realistic picture of how b p coupling operates vander zanden and vadeboncoeur 2002 many energetic food webs have been built for lake ecosystems very few are oriented towards understanding the role of b p coupling lake management mitigating anthropogenic disturbances needs better comprehension of how disturbance changes b p coupling doi et al 2010 griffiths et al 2017 eutrophication has long become one of the most severe environmental problems to lake ecosystems conley et al 2009 donohue et al 2009 huisman et al 2018 smith 2003 smith et al 1999 it has been widely recognized that eutrophication shapes the physical chemical characteristics biological community structure and ecosystem functioning of lakes to various degrees although the effects of eutrophication have been studied intensively and extensively its impacts on b p coupling receive little concern tunney et al 2012 in this study we revealed the patterns of b p coupling within a whole lake food web framework we asked three specific questions 1 how much energy is transferred through b p coupling in lake food webs 2 by whom and in which ways do these couplings operate and 3 how is b p coupling affected by eutrophication to answer these questions we constructed whole lake energetic food webs in two shallow lakes of different trophic status considering the ubiquity of b p coupling schindler and scheuerell 2002 we assumed that the energy flux through b p coupling would make a large proportion of whole lake food webs although top consumers were important spatial connectors there were studies suggesting habitat coupling by lower trophic level consumers batt et al 2015 vander zanden and vadeboncoeur 2002 wolkovich et al 2014 therefore we assumed that coupling was not only performed by top consumers concurrently as organisms are of various production rate the amount of coupling energy might vary along with trophic levels finally we assumed that eutrophication could affect both the amount of energy flux and the manner that b p coupling operates as under eutrophication both the decrease in benthic food resources and the deterioration of pelagic food resources vadeboncoeur et al 2003 would compel cross habitat feeding batt et al 2015 2 methods 2 1 study lakes the present study was carried out in two subtropical shallow lakes lake erhai 25 36 25 58 n 100 06 100 28 e and lake dianchi 24 40 25 02 n 102 36 102 47 e on yunnan guizhou plateau located in the southwest of china fig 1 the two lakes are similar in size morphology and climate the surface area of lake erhai is 250 km2 shoreline length 128 km and average water depth 10 6 m the surface area of lake dianchi is 300 km2 shoreline length 163 km and average water depth 4 4 m lake erhai is regarded as a mesoeutrophic lake with the total nitrogen and phosphorus in lake water during field surveys being 0 51 mg l and 0 03 mg l respectively lake dianchi is a hypereutrophic lake with the total nitrogen and total phosphorus in lake water during field surveys being 6 71 mg l and 0 11 mg l respectively wang et al 2018 heavy cyanobacteria bloom occurs during april october every year in lake dianchi while little is recorded in lake erhai li et al 2014 the coverage of macrophytes is 7 9 in lake erhai and less than 1 in lake dianchi chen et al 2003 li et al 2011 2 2 biological data collection field surveys were carried out during 2015 2016 and each lake was sampled for three times i e august 2015 november 2015 and april 2016 samples were taken from both inshore and offshore areas there were 13 inshore sites and 7 offshore sites in lake erhai and 10 inshore sites and 8 offshore sites in lake dianchi fig 1 quantitative samples of phytoplankton benthic algae macrophytes zooplankton and macroinvertebrates were collected to determine the taxonomic composition density and biomass of each taxon fish sampling was carried out during the open fishing season october 2015 january 2016 phytoplankton and zooplankton were collected on offshore sites two to three water samples were taken vertically from middle to surface water column at each site using a 5 l water sampler water was mixed before concentrated through plankton net 125 μm for zooplankton identification mixed water samples of 1 l were preserved with lugol s solution taken back to the laboratory settled for 24 h for taxonomic identification and biomass estimations according to standard protocols zhang and huang 1991 according to the dry wet ratios suggested by zhang and huang 1991 the wet mass was converted to dry mass mg l benthic algae were sampled in inshore sites for quantification filamentous and non filamentous attached algae were sampled separately each sample was collected from substrates with an area of 10 10 cm2 and three random replicates were taken at each site filamentous algae were scraped off from substrates kept in a 4 c ice chilled box and washed with distilled water in the laboratory non filamentous algae were brushed off from substrates centrifuged with colloidal silica ludox tm50 sigma aldrich germany and the supernatant with algae was carefully collected and filtered on predried and preweighted whatman gf c glass fiber filters the glass fiber filters with non filamentous algae and filamentous algae samples were oven dried at 60 c for at least 48 h to determine the dry mass which was further converted to ash free dry mass according to apha 1998 aquatic plants including macrophytes and hygrophytes were collected at inshore sites three to ten samples of macrophytes and one to three samples of hygrophytes were collected at each site depending on the heterogeneity of lake bathymetry macrophytes were collected by a scythe of 0 28 m2 and hygrophytes were collected within a plot of 0 25 m2 all species encountered were recorded the aboveground part of plants was collected and oven dried at 60 c for at least 48 h to determine the dry mass macroinvertebrates were sampled from both the inshore and offshore sites each inshore sample was collected with a d shaped kick net with an area of 3 m2 and offshore samples were collected with a modified peterson grab 1 16 m2 all specimens were identified to the genus level as possible following the identification keys epler 2001 liu et al 1993 morse et al 1984 the dry mass g m2 of each specimen was converted from the wet mass using dry wet ratios from previous studies liang and yan 1999 wang et al 2018 yan 1998 zhao 2010 for mollusks the shell free dry mass was used fish samples were collected from local fishermen and mainly caught by gill nets and trammel nets all specimens were identified to species or genus chu and chen 1990 data of total fish catch and fish stocking were obtained from the local government the biomass of each taxon was estimated using the basic equations 1 biomass yield fishing mortality 2 fishing mortality total mortality natural mortality where yield is in t km 2 year 1 the total mortality was suggested to be approximate to p b production biomass ratio under steady conditions pauly et al 2000 p b ratios were referred to previous studies shan et al 2014 tang 2013 2 3 stable isotope analysis basal resources and consumers were sampled for stable isotope analyses detritus was collected from sediments in both inshore and offshore areas coarse particle organic matters cpom 1000 m and fine particle organic matters fpom 250 1000 μm were separated by a sieve and the latter were filtered through pre combusted whatman gf f glass fiber filters particle organic matters pom was filtered on the pre combusted whatman gf f glass fiber filters until clogging plankton was collected with triple layered plankton net of mesh size of 64μm 125 μm and 250 μm after microscopic examination samples in the nets of 64 and 125 μm mesh size were treated as phytoplankton and samples in the net of 250 μm were treated as zooplankton both phytoplankton and zooplankton samples were filtered through pre combusted whatman gf f glass fiber filters benthic algae were subsampled from the biomass samples aquatic plants were separated into c4 groups mainly submerged macrophytes and poaceae species and c3 groups the others and the aboveground parts of the dominant species were collected for macroinvertebrate 1 3 samples were collected for each taxon encountered for mollusks shrimps and fish 3 6 muscles were preserved for each taxon all stable isotope samples were kept in a 4 c ice chilled box and oven dried at 60 c for 48 h for further analysis to estimate the c13 and n15 content each dried sample was grounded homogenized and encapsulated into a 4 6 mm tin capsule samples were analyzed on a delta v advantage isotope ratio mass spectrometer thermo fisher scientific germany at the institute of hydrobiology chinese academy of sciences the references are usgs40 and usgs 41 except for small body macroinvertebrates more than 3 replicates were analyzed for each taxon for small body macroinvertebrates at least 1 sample was analyzed for each taxon taxa with inadequate samples e g genus level were combined and labeled with a higher taxonomic level e g family level to quantify the trophic relationships the diet of each consumer was analyzed using the bayesian stable isotope mixing model bayesian simm with the siar package in r r core team 2018 hopkins iii and ferguson 2012 parnell 2008 phillips et al 2014 the qualitative trophic relationships were determined using gut content information collected from the literature chu and chen 1990 morse et al 1984 to improve the analysis results gut content information was referred to as a prior and concentrations of carbon and nitrogen were also included in the model also different trophic enrichment factors tefs were applied according to the taxonomic groups e g mollusks insects shrimps fishes etc regarding their feeding habits france 1995 vander zanden and rasmussen 2001 vanderklift and ponsard 2003 2 4 energetic food web construction 2 4 1 model construction static mass balance models were constructed for the two lakes using the software ecopath version 6 2 http www ecopath org the basic equation for ecopath is as follow 3 b i p b i e e i j 1 n b j p b j d c i j y j e j b a j 0 where i and j stand for resource and consumer b is the biomass p b the production to biomass ratio ee ecotrophic efficiency dcij fraction of resource i in the diet of consumer j y the total fishery catch rate e the net migration rate ba biomass accumulation rate the model requires the following parameters biomass p b ratio q b consumption biomass ratio and diet composition of each taxon biomass of each taxon was estimated from our field investigations values of p b ratio and q b ratio of previous studies was referred shan et al 2014 tang 2013 yan 1998 zhang and huang 1991 when data were lacking values of the same or a similar genus were used diet composition was acquired from the bayesian simm since the ecopath model requires ee not exceeding 1 diet composition was finely adjusted to balance the model the total system throughput the sum of total consumption total export total respiration and total flows to detritus expressed in t km2 year tst and the total consumption of the system were extracted from ecopath 2 4 2 energy flux quantification to estimate the energy flux through pelagic and benthic pathways the basal resources were classified into two groups the pelagic basal resource pbr and the benthic basal resource bbr in this study pbr is phytoplankton and bbr consists of cpom fpom benthic algae filamentous and non filamentous c3 and c4 aquatic plants the energy flux from a basal resource to a given consumer was calculated with the following equation 4 f i j c j f i j where fij is the energy flux from resource i to consumer j cj is the energy consumption of consumer j derived from the outputs of ecopath fij is the fraction of the total input to consumer j that came from resource i overall pathways of all lengths hannon 1973 ulanowicz 2004 the fraction of energy flux from pbr to a consumer fpbr is the fraction of energy from phytoplankton while the fraction of bbr fbbr was a sum of all benthic basal resources the calculations were processed with python version 2 7 2 4 3 trophic position estimation when estimating the trophic position of consumers acquire energy from multi habitat e g pelagic and benthic habitat a two baseline strategy according should be applied to capture the spatial heterogeneity in nitrogen stable isotopes post 2002 primary consumers typically feeding upon pbr usually bivalves and bbr gastropods are generally treated as the two baselines the pelagic baseline and the benthic baseline the post s equation 2002 is as below 5 t p c o n λ δ 15 n c o n δ 15 n b a s e 1 α δ 15 n b a s e d 2 1 α 3 4 where tpcon is trophic position of a consumer λ is trophic position of baseline species i e λ 2 δ15ncon is the 15n isotope value of the consumer δ15nbase1 is the 15n isotope value of the pelagic baseline δ15nbase2 is the 15n isotope value of the benthic baseline α is the fraction of energy flux from pelagic basal resources pbr to the consumer 2 5 b p coupling quantification 2 5 1 benthic and pelagic component definition previous studies define the benthic and pelagic parts in lake food webs with much vagueness since such definition was mainly based on the spatial areas where consumers commonly live or feed but not relied on the trophic resources they utilized schindler and scheuerell 2002 in this study the fraction of energy flux from pbr was used to separate the benthic and pelagic parts consumers with 50 energy uptake from pbr were treated as the components of the pelagic part and the rest as the components of the benthic part fig 2 taxa with 20 80 energy uptake from pbr were defined as couplers among which two sub groups were classified as b couplers 20 50 and p couplers 50 80 taxa with 20 energy uptake from pbr were defined as benthivores and those with 80 as planktivores 2 5 2 coupling energy estimation the coupling energy refers to the total energy exchanged among benthivores planktivores and couplers it also equals to the total consumption of the food web minus the non coupling energy i e energy flux among benthivores or planktivores to facilitate the calculation the following equations were used 6 f c c f b f p 7 f b i 1 n j 1 n c b j f b i b j f o r i j 8 f p i 1 n j 1 n c p j f p i p j f o r i j where f c is the amount of coupling energy f b is the energy flux among benthivores f p is the energy flux among planktivores c is the total energy consumption c b j is the consumption of a benthivore c p j is the consumption of a planktivore f b i b j is the diet fraction of a benthivore consumer b j directly contributed by a benthivore resource b i f p i p j is the diet fraction of a planktivore consumer p j directly contributed by a planktivore resource p i the coupling energy flowing to a trophic level was calculated as 9 f b j c b j f p b r b j 10 f p j c p j f b b r p j where f b j is the energy uptake of pbr by a benthic consumer and f p j is the energy uptake of bbr by a pelagic consumer c b j or c p j represents the energy consumption of the corresponding consumer f p b r b j is the fraction of energy uptake from pbr by the benthic consumer and f b b r p j is fraction of energy uptake from bbr by the pelagic consumer the total energy flux coupled at each trophic level and by each group were calculated 2 5 3 direct energy flux between the benthic and pelagic parts the exchanged energy between the benthic and pelagic parts was calculated with the following equations 11 f p b i 1 n j 1 n c b j f p i b j 12 f b p i 1 n j 1 n c p j f b i p j where f p b the total energy flux from pelagic components to benthic components f b p is the total energy flux from benthic components to pelagic components 2 5 4 energy coupled through couplers to reveal the role of couplers in b p coupling the proportion of coupling energy through couplers was calculated for the whole food web as well as by each trophic level 13 p a b i 1 n j 1 n f a i b j f b i a j c i j 14 p a b r j r f a i b j f b i a j j r f j i j where group a and b represent the two groups of the benthivore coupler pair planktivore coupler pair or benthivore planktivore pair p a b is the proportion of energy flux between group a and b over total consumption f a i b j is the energy flux from group a to group b f b i a j is the energy flux from group b to group a c the total consumption of the system in eq 14 p a b r is the proportion of energy flux between group a and b at trophic level r f j is the input to consumer j 2 5 5 strength of coupling links to assess the strength of coupling two aspects were considered the relative amount of coupling energy and the complexity of coupling links the relative amount of coupling energy is the proportion of total coupling energy in total consumption and the complexity of coupling links is represented by the connectance of coupling links the strength of coupling s c was calculated as follows 15 s c c o u p l i n g e n e r g y t o t a l c o n s u m p t i o n l c s 2 where lc is the number of coupling links s is the total species number based on this calculation a stronger coupling is derived from a larger relative amount of coupling energy and more complex coupling links 3 results 3 1 the energetic food web the energetic flow diagrams are shown in fig 3 trophic heights in the two lakes were rather similar 3 9 in lake erhai and 4 0 in lake dianchi the food web size was 93 in lake dianchi and 115 in lake erhai food web composition in the two lakes was generally similar benthivore consisted the majority 58 out of 115 in lake erhai and 69 out of 93 in lake dianchi and planktivore was the smallest minority 7 out of 115 in lake erhai and 5 out of 93 in lake dianchi compared to lake erhai lake dianchi supported a larger proportion of benthivores 75 vs 50 fig 4 the total system throughput tst was estimated to be 1802 t km2 y in lake dianchi and 6729 t km2 y in lake erhai and the total consumption was 699 t km2 y and 2094 t km2 y respectively the tst of lake erhai was 3 73 times of lake dianchi and the total consumption was 2 99 times of lake dianchi based on the diet composition derived from stable isotope analyses the average consumption of pbr consists 28 4 of consumers diet in lake erhai and 14 8 of consumers diet in lake dianchi in contrary based on the mass balanced model consumers energy uptake including direct and indirect energy flow from pbr consists 79 0 of the total consumption in lake erhai and 58 8 in lake dianchi for more details about the two models please refer to appendix s3 and s4 3 2 b p coupling the simplified b p coupling conceptual diagram is shown in fig 5 the proportion of coupling energy was much higher in lake dianchi 31 than in lake erhai 19 fig 6 in the two lakes the largest energy flux was detected among planktivores 50 in both lakes 1608 t km2 y in lake erhai and 380 t km2 y in lake dianchi followed by b p coupling 405 t km2 y in lake erhai and 213 t km2 y in lake dianchi and the smallest flux was among benthivores 15 in both lakes 64 t km2 y in lake erhai and 101 t km2 y in lake dianchi the energy flux among benthivores was higher in lake dianchi 14 vs 3 the direct energy flux between the benthic and pelagic parts was highly asymmetric the pelagic to benthic flux and benthic to pelagic flux in lake erhai were 13 t km2 y and 338 t km2 y the pelagic to benthic flux and benthic to pelagic flux in lake dianchi were 34 t km2 y and 130 t km2 y the total amount of benthic to pelagic flux being 4 folds lake dianchi and 25 folds lake erhai of the counter flux in terms of trophic level specific coupling most coupling performed by benthic omnivores and zooplanktons were around trophic level 2 0 in lake erhai accounting for 95 0 of the total coupling energy fig 7 the main coupling energy flows were from fpom to zooplankton 318 2 t km2 y zooplankton to shrimp 6 2 t km2 y fpom to silver carp 2 0 t km2 y and shrimp to carp 1 8 t km2 y in lake erhai in lake dianchi most coupling performers were at comparatively higher trophic position around trophic level 2 0 3 0 accounting for 73 0 of the total coupling energy fig 6 in lake dianchi the main coupling energy flows were from fpom to zooplankton 124 4 t km2 y from zooplankton to redfin culter 4 7 t km2 y from fpom to silver carp 4 6 t km2 y from phytoplankton to goldfish 3 8 t km2 y the largest amount of coupling energy flows directly between benthivores and planktivores in both lakes 108 3 t km2 y in lake erhai and 266 8 t km2 y in lake dianchi appendix s5 it was the same to both lakes that the energy flowing between benthivores and couplers occurred mainly around trophic levels 1 0 2 0 benthic omnivores and trophic level 3 0 benthic predators appendix s6 the b p coupling strength sc is 0 0028 in lake erhai and 0 0094 in lake dianchi the pelagic to benthic coupling complexity is 0 0078 in lake erhai and 0 0209 in lake dianchi the benthic to pelagic coupling complexity is 0 033 in lake erhai and 0 0193 in lake dianchi 4 discussion 4 1 whole lake energetic food web high resolution energetic food webs help to reveal the role of consumers in lake b p coupling in lake ecosystems pelagic basal resources pbr are the main energy sources of consumers often consisting about 50 75 of the total energy uptake hossaina et al 2010 moreau et al 1993a b similar patterns were found in the present study energy uptake from pbr consisted more than 55 of total energy consumption in both study lakes we found the average proportion of pbr in consumer diet based on stable isotope analysis was much less than the energy contribution of pbr in the total consumption of the ecosystem based on the mass balanced model it indicated that the importance of a certain food source in an ecosystem might be overlooked if only assessed with stable isotope analysis result we found both the system throughput and total consumption were lower in the hypereutrophic lake lake dianchi than the mesoeutrophic lake lake erhai the reason might be that long term eutrophication could lead to the decrease in species diversity and biomass heip 1995 smith et al 1999 in the present study we found a higher relative benthic basal resources bbr uptake in the hypereutrophic lake where top consumers were supported mainly by bbr this is the reason that top consumers in the hypereutrophic lake were mostly benthivores energy uptake from pbr 50 moreover benthivores were the main food web components in the hypereutrophic lake in a highly eutrophic lake the frequent algae bloom homogenizes pbr and lowers food edibility ger et al 2014 huisman et al 2018 sukenik et al 2015 and thus reduce the consumers energy uptake of pbr it has been commonly accepted that eutrophication impedes benthic primary productions vadeboncoeur et al 2001 and leads to the loss of benthic pathways vadeboncoeur et al 2003 however we found a similar number of benthic components in both lakes 85 vs 78 on contrast there were less pelagic components in the hypereutrophic lake 30 vs 15 it implies the possibility that on the aspect of pathway number it was the pelagic pathways rather than benthic pathways which were largely reduced in the hypereutrophic lake 4 2 b p coupling in lakes the proportion of b p coupling energy varies between lake ecosystems fig 6 the proportion of coupling energy was much higher in the hypereutrophic lake than mesoeutrophic lake indicating that b p coupling might be strengthened through eutrophication similar results were also found in other lakes suffering progressive cultural eutrophication batt et al 2015 chandra et al 2005 vadeboncoeur et al 2001 the underlying mechanisms that eutrophication could promote b p coupling in the study lakes are discussed as follows first heavy cyanobacterial blooms in the hypereutrophic lake could result in toxic and low quality pelagic basal resources pbr ger et al 2014 ghadouani et al 2003 in this case pbr was less involved directly in the pelagic food web contrarily they become detritus and sink to the lake bottom as a food resource for benthic consumers our stable isotope data also revealed a potentially higher consumption of detritus by consumers in the hypereutrophic lake compared to the mesoeutrophic lake benthivores such as many oligochaetes and chironomids prefer eutrophicated water brinkhurst 1970 casellato and caneva 1994 finogenova 1996 and they perform coupling by feeding fpom mostly originated from pbr potentially strengthening energy exchange between the benthic and pelagic parts second consumers feeding in multi habitats would rely more on littoral bbr due to the homogenization of offshore habitat under eutrophication wang et al 2018 a larger proportion of bbr uptake by pelagic consumers was found in the more eutrophicated lake which might be caused by the change of primary consumers an increase in benthic detritus feeders 5 vs 64 detritivore biomass in macroinvertebrates such a change could strengthen b p coupling by increasing bbr energy uptake by couplers and planktivores fig 7 previously top consumers usually fish were considered to play a chief role in lake b p coupling since they are highly mobile and capable of integrating food resources from different habitats fry et al 2008 gorman et al 2012 vander zanden and vadeboncoeur 2002 in these studies the measurement of coupling strength was mainly based on diet composition in these studies consumers feed equally from each habitat were considered as the strongest couplers bartels et al 2016 tunney et al 2018 2012 however the role of top consumers might be overestimated since the studies did not assess the amount of energy coupled by smaller or lower trophic level consumers who possess large biomass or a high production biomass ratio p b ratio in the present study we found that the role of top consumers in b p coupling was rather limited in the energetic perspective while consumers at the lower to middle trophic levels were quantitatively important the largest proportion of energy exchanged between the benthic and pelagic parts was performed directly between lower trophic level benthivores and planktivores such as detritus and zooplankton zooplankton and shrimps etc such coupling pathways have long been neglected and have not been quantitatively revealed in a whole lake energetic food web before also b p coupling occurred at multiple trophic levels implied a complex manner of habitat coupling in the study lakes concerning the role of each group involved in the coupling we found that benthic couplers i e shrimps and other benthic omnivores in the hypereutrophic lake played a stronger role than in the mesotrophic lake especially a stronger coupling of benthic predators and top consumers was found in the hypereutrophic lake therefore from an energetic perspective eutrophication strengthened the coupling role of benthic omnivores and predators in b p coupling we also found a strong asymmetry in b p coupling in the study lakes the benthic to pelagic pathways dominated in the binary exchange of energy between the benthic and pelagic part which indicated that there was a large amount of energy from bbr flowing to the pelagic food web it is mainly through the feeding of pelagic primary consumers of fine particulate organic detritus mainly consisting of dead algae and biofilms we also found a greater asymmetry in the mesoeutrophic lake than in the hypereutrophic lake the hypereutrophic lake presented a lower level of asymmetry suggesting that eutrophication might weaken such asymmetry in b p coupling asymmetries have been commonly recognized in network structure consumer resource interactions and energy flow in food webs schindler and scheuerell 2002 how that asymmetry in b p energy exchange related to the ecosystem functioning is unknown but there appears to be a variation of this asymmetry between the meso and hyper eutrophic lakes there was a stronger strength of b p coupling sc in the hypereutrophic lake the larger proportion of coupling energy together with the higher complexity of pelagic to benthic feeding relationships resulted in a high b p coupling strength in the hypereutrophic lake compared to mesoeutrophic lake zooplankton in the hypereutrophic lake depends more on energy from fine particulate organic detritus and benthic consumers feed more on zooplankton and sedimented phytoplankton it also appears that more than 70 coupling links holding energy flux less than 0 1 kg km2 y such patterns were consistent with previous studies that weak links are the majority in ecosystems berlow 1999 berlow et al 2004 mccann et al 1998 however the role of weak coupling links could not be ignored considering their importance in stabilizing ecosystems berlow 1999 paine 1980 5 conclusion in the present study we revealed b p coupling within an energetic food web framework combining stable isotope analyses and mass balanced model b p coupling occurred on multiple trophic levels and consumers on the lower trophic level other than top consumers were quantitatively important energy through b p coupling in lakes was asymmetric and most coupling links were weak in terms of energy flux besides we found that although eutrophication decreased the total amount of energy flux in lake food webs it could strengthen b p coupling by increasing the proportion of coupling energy and the complexity in coupling links declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment we thank jianqiang ouyang saibo yuan wenjuan gao yaxue ma and zhendong yang tong wu senrong fan yilin wang and zhen wu for their help on the fieldwork we also thank yajing he weisong feng yan li and saibo yuan for taxonomic identification and milen marinov for the helpful comments on the manuscript this work was supported by the national basic research program of china grant number 2015cb458900 appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2019 108928 appendix a supplementary data the following is supplementary data to this article 
24921,despite the great effort of nutrient loading reduction lake rehabilitation often suffers from the impacts of internal nutrient cycling however the mechanisms of internal nutrient cycling specifically the feedback of algal blooms on nutrients cycling is still an open question management of lake dianchi the most eutrophic lake in china has involved a series of costly measures but without significant algal bloom decreasing in view of the difficulty to evaluate the importance of internal cycling only by monitoring data a three dimensional model based flux tracking approach was performed to identify the contributions of internal cycling the results highlighted the role of nitrogen n and phosphorus p benthic fluxes with high seasonal fluctuations contributing 29 n and 18 p of total input the scenario analysis indicated that n loading reduction was more efficient for lake restoration furthermore a positive feedback was detected between algae biomass and benthic p flux benthic p flux varied from adsorption to release when algae biomass increased this phenomenon implied that a close link existed between n and p cycles with algae acting as a strong integrator due to the positive feedback loop between benthic p flux and algal blooms as well as the high efficiency of n loading reduction controlling both n and p loadings will benefit lake restoration especially eutrophic lakes with heavy sediment nutrient loadings keywords internal nutrient cycling phosphorus release water quality model scenario analysis algae feedback lake dianchi 1 introduction external loading reduction of nitrogen n and phosphorus p has been conducted globally for lake eutrophication control conley et al 2009 davidson and howarth 2007 seitzinger 2008 however there is an increasingly puzzle that it is not necessarily effective for all lakes ding et al 2018 liu et al 2013 yang et al 2013 possibly due to impacts of unobserved internal nutrient cycling previous studies have found that in eutrophic lakes internal nutrient cycling like benthic fluxes of n and p can be a significant part of nutrient input preventing or delaying lake recovery after external loading reduction especially significantly enhancing algal growth as nutrients sources bergstrom and jansson 2006 carpenter et al 1999 nowlin et al 2005 roy et al 2012 sondergaard et al 2013 wu et al 2017 zhou et al 2016 however the driving factors of internal nutrient cycling processes are complex and often harder to control than those affecting external loadings more importantly cottingham et al 2015 raised a new finding that cyanobacterial blooms could in turn affect p cycling a recent lab study also found a positive feedback loop where benthic p flux fuels algal blooms which in turn enhance the release of p chen et al 2018 algae was considered as a biological pump in this positive feedback loop while there is great need for more quantitative or empirical evidences therefore for effective management of lake eutrophication it is essential to consider the roles of internal nutrient cycling and to explore a how internal nutrient cycling processes respond to various nutrient management strategies and b how algae will change the nutrient cycling dynamics the effectiveness of loading reduction has been well studied however diverse patterns of internal cycling processes under different loading reduction scenarios have seldom been explored furthermore isolated considerations of n or p cycling changes in response to changes in external n or p loading may be misleading if we ignore the potentially tight links of lake n and p cycles due to the highly constrained link of n and p in living biomass bernhardt 2013 for example finlay et al 2013 showed that reducing p loading alone may result in exceptionally high n storage in lakes in which algae act as a primary link between n and p cycling mccarthy et al 2016 suding et al 2004 as primary producer the biomass of algae can be extremely large compared with macrophytes and consumers in eutrophic lakes meaning that nutrient uptake and release by algae might dominate the overall fluxes of n and p anderson et al 2002 friedrich et al 2003 qin 2009 ramin et al 2012 moreover algal blooms can also cause a drastic change of chemical conditions at sediment water interface favoring the release of fe bound p chen et al 2018 algae therefore have the potential to influence internal nutrient cycling three specific questions arose during the attempts to understand the internal nutrient cycling in lakes a are there any changes in the contribution of internal cycling during load reduction b if yes will there be different patterns for n p or n and p loading reduction and c is there a feedback loop between algae and nutrient cycling if so what is the mechanisms of the feedback although some internal processes can be evaluated in lab or by in situ experiments nowlin et al 2005 risgaard petersen et al 2003 it is still difficult to establish the patterns of internal nutrient cycling fluxes for a whole lake in different seasons considering spatial and temporal differences numerical modeling is a valuable and feasible tool to explore the dynamics of nutrient cycling integrating existing knowledge of relevant biogeochemical processes boyd 2012 hu et al 2006 wang et al 2003a b here a three dimensional 3d model derived from our previously developed calibrated and validated model of lake dianchi was used to simulate temporal changes of nutrient budgets under nutrient loading scenarios to explore the mechanisms of nutrient cycling liu et al 2014 wang et al 2014 yi et al 2016 2 methods 2 1 study area and data sources lake dianchi is the 6th largest lake in china and the largest plateau one in yunnan province southwestern china fig 1 with a surface area of 309 km2 a volume of 1 56 109 m3 a mean depth of 4 4 m and a watershed area of 2920 km2 historical monitoring has shown that lake water quality has deteriorated rapidly since late 1970s and especially since the 1990s however after over 20 years of restoration efforts the water column n and p concentrations decreased but there is no sign of significant improvement as expected for algae biomass figure s1 in supporting materials lake dianchi is a typical semi enclosed lake with high inflow low outflow long residence time and high evaporation which highlights the potential importance of internal nutrient cycling gao et al 2014 wu et al 2017 to facilitate more effective decision making for eutrophication control and ecological restoration in lake dianchi it is crucial to explore the dynamic processes of nutrient cycling and the responses of algae biomass in the lake monthly water quality data was collected from the routine monitoring program conducted by kunming environmental monitoring center it provides the basis for calibrating and validating the model developed in this study atmospheric and meteorological data are from the national meteorological information center river flow and velocity data are from the kunming bureau of hydrology and water resources please refer to supporting materials for the detailed configuration of boundary and initial conditions 2 2 model based numerical tracking of nutrient fluxes and pools changes in nutrient pools and fluxes are important to evaluate the ecological status of lakes while nutrient pools and fluxes can be estimated via direct measurements and experiments these often cannot illustrate the picture of the whole lake due to limitations on sampling sites impacts of vertical stratification and limited spatial coverage in contrast the 3d model is useful to calculate nutrient pools and fluxes the model for lake dianchi was derived from our previously developed calibrated and validated 3d model which was used in various studies like global sensitivity analysis and water diversion scenarios liu et al 2014 yi et al 2016 the model was based on efdc environmental fluids dynamics code an integrated 3d model to simulate hydrodynamics temperature and the cycles of carbon nitrogen phosphorus and silicon in living inorganic and organic forms refer to content s1 and figure s2 in supporting materials for modeling details in the model of lake dianchi nutrient pools and fluxes were calculated based on the mechanistic equations and spatial configuration fluxes and pools were calculated in each grid of the model the integral for fluxes and pools of all the grids were obtained according to the computational grid of lake dianchi based on the same discrete distribution the main equations for nutrient pools and fluxes are as below 1 n u t r i e n t p o o l m i t c i d x d y d z 2 n u t r i e n t l o a d i n g f w s i t k 1 n q t k c t k i 3 a t m o s p h e r i c d e p o s i t i o n f a i r i t d d i t d w i t d x d y 4 o u t p u t f o i t k 1 m q k t c k t i 5 b e n t h i c f l u x f b e n i t b e n i t d x d y 6 s e d i m e n t a t i o n f s e t i t f s i t d x d y 7 d e n i t r i f i c a t i o n f d e n t f d n t d x d y d z 8 n i t r o g e n f i x a t i o n f n f i x t f n f t d x d y d z where i represent different forms of nutrient c i is the concentration of i in water body q t k is the quantity of flow in inflowing river k on time t c t k i is the concentration of i in inflowing river k on time t dw i t is wet deposition of i dd i t is dry deposition of i q k t is the quantity of flow in outflowing river k on time t c k t i is the concentration of i in outflowing river k on time t ben i t is the benthic flux rate of i fs i t is sedimentation rate of i fdn t is the denitrification rate fnf t is the n fixation rate refer to s1 1 in supporting materials for detailed flux expressions 2 3 scenario definition in order to explore the efficiency of nutrient loading reductions and the impact of loading reduction on internal cycling processes three types of scenarios were evaluated a reducing n loading only b reducing p loading only and c reducing both n and p loading table s2 in each type of scenarios the reduction ratios are 10 30 50 70 80 and 90 there are 19 scenarios in all including baseline scenario the baseline scenario was defined as no reduction the results of all the scenarios were the fifth year of each model run in order to get a steady state the limiting nutrient of algae growth can be detected by the comparison of n only scenarios and p only scenarios the relationship between internal cycling of p or n to algae biomass change could be effectively studied in scenarios of n or p loading reduction based on the water quality modeling and calculation of nutrient cycling fluxes 3 results and discussion 3 1 model results before the model of lake dianchi could be used for the calculation of nutrient cycling fluxes as well as scenario analysis its ability to represent in lake water quality and processes of nutrient cycling were established through a model calibration and validation process in this study a data set consisting of two years of observations was used for calibration and validation the hydrodynamic module was first calibrated with the temperature data the water quality module was then calibrated with the observed data of chlorophyll a chla nh4 total phosphorus tp and do the simulated concentrations of chla nh4 tp and do in the surface layer are compared with observed data at eight routine monitoring stations in lake dianchi in fig 2 s4 however due to the lack of subsurface water column and surface sediment data the model was calibrated only with surface water quality data the calibrated values of for the key water quality parameters are listed in table s3 uncertainty analysis was conducted based on the lhs latin hypercube sampling method to see the uncertainty of chla do tn and tp and the sensitivity analysis was also conducted to see the response of chla do tn and tp to 38 parameters based on morris method figure s5 and table s5 supporting materials overall the validation results showed that the model results fit well with observed water quality variations in lake dianchi and the model can serve as a computational platform for further analysis some distinct seasonal patterns were found in the results of nutrient pools fig 3 nh4 and no3 pools increased in november and december but started to decrease in january and february indicating that a huge sink of nh4 and no3 existed during warmer seasons when algae started to grow this huge sink may result from the uptake of algae growth furthermore a delay was detected between nh4 and no3 indicating that nitrification took place in january and february leading to a rapid decrease of nh4 and an increase of no3 then no3 decreased rapidly and remained relatively low from april to october in contrast to nh4 and total phosphate tpo4 likely because of the relatively high denitrification flux during algal bloom from may to october different from no3 an increase of nh4 and tpo4 occurred from july to october likely due to the sediment release of nh4 and tpo4 during algal bloom in contrast to dissolved nutrients algae biomass increased from march and decreased in november logically algae uptake is likely the primary reason for the decrease of dissolved nutrients during algal bloom 3 2 contributions of nutrient internal cycling increasing evidence has shown that internal cycling of nutrients in shallow lakes may be one of the main factors maintaining eutrophication and preventing improvements in water quality jeppesen et al 2005 reductions of external nutrient loading have been implemented for decades in lake dianchi however there are still serious algal blooms with the summer maximum chlorophyll a chla reaching 209 μg l in recent years thus exploring the dynamics of internal cycling of nutrients may offer useful insights for lake rehabilitation the model results showed that in lake dianchi benthic fluxes of n and p accounted for 29 of total n input and 18 of total p input these fluxes were second to external loadings which contributed 68 for n and 80 for p fig 4 similar results have been shown in other studies for example in lake pontchartrain benthic p flux contributed 30 44 of annual p loading roy et al 2012 in lake taihu benthic fluxes of nh4 contributed 20 25 of total n loading while benthic p fluxes accounted for almost 50 of total p loading qin and zhu 2006 qin et al 2006 moreover a great fluctuation was detected in benthic fluxes of nutrients throughout the year in the model fig 4 seasonal fluctuations of benthic nutrients fluxes in the lake dianchi are supported by previous studies which showed that the benthic fluxes of nutrients vary monthly or seasonally sondergaard et al 1992 spears et al 2012 yang et al 2013 the benthic p flux in lake dianchi acted as a source sediment release of p to the water column from may to october but acted as a sink adsorption in other months unlike tpo4 the benthic n flux was close to zero from january to march which means an equilibrium existed between sediment release and adsorption of din dissolved inorganic nitrogen however this equilibrium was broken in early march because of the uptake by algae low do near the sediment as well as strong concentration gradients are likely the main driving factors enhancing benthic fluxes in systems like lake dianchi amirbahman et al 2003 li et al 2016 nowlin et al 2005 wu et al 2014 in lake dianchi benthic fluxes of n and p are synchronous with algae on account of the enhanced driving factors caused by biological uptake of algae as well as bottom hypoxia do 2 mg l resulting from algal bloom figure s5 paerl et al 2011 similar results were found in lake uzarzewskie a hyper eutrophic lake in poland kowalczewska madura et al 2015 where the highest p release rate was observed in autumn 44 7 mg p m2 day but p accumulation in sediments dominated over release in winter 0 33 0 62 mg p m2 day removal processes of nutrients are essential for lake dianchi because of its semi closed morphology in the absence of significant hydrologic outflow sedimentation of particulate organic matter and denitrification were the main pathways of nutrient removal in lake dianchi the outflow only accounted for 4 5 of total n loss and 9 4 of total p loss sedimentation was a major removal pathway for both n and p and accounted for 90 6 of total p loss and 46 5 of total n loss denitrification was a unique and important removal pathway of n internal cycling and accounted for 49 of the total n loss which is larger than sedimentation this large contribution of denitrification may be explained by algal blooms and the resulting low benthic do concentrations figure s6 it had been thought that hypoxia could not occur in lake dianchi because of its shallow depth however our previous model results showed that 6 82 of lake dianchi s volume was hypoxic annually which cannot be obtained from well mixed or 2d models liu et al 2014 overall our modeling effort highlights that benthic fluxes of n and p as well as denitrification are of great importance in eutrophic shallow lakes especially semi enclosed lakes 3 3 scenario analysis efficiency of p vs n loading reduction eighteen scenarios table s2 were set based on the validated model configuration to explore the efficiency of loading reduction on algae regulation as well as n and p internal cycling overall the scenario results showed that as expected algae biomass decreased when external loading was reduced however the efficiencies of n and p loading reduction were not the same n loading reduction and dual nutrient loading reduction had almost equal and higher performance for algae biomass than p loading reduction fig 5 a the reason why the efficiencies of these two measures were similar is that nutrient limitation was decided by taking the minimal value of n and p limitation factors in the algae growth equation of the model hamrick 1992 the lower efficiency of p loading reduction implied that bioavailable p was much more difficult to remove to the limiting level given the same nutrient loading reduction measures although n loading reduction was more efficient a non linear relationship between algae biomass and n loading reduction was still detected the same as p loading reduction in order to explore the non linear relationships between algae biomass and nutrient loading reduction n and p in different forms and fluxes of nutrient cycling processes were calculated in all scenarios fig 6 s7 table s6 s7 the reason why n loading reduction was more efficient lay in the insufficiency of din which implied that the internal source of din cannot support the uptake of algae n loading reduction had a large impact on n cycling processes although the contribution of benthic n flux increased from 29 0 46 3 of total n input in n loading reduction scenarios the actual flux decreased compared with benthic p flux the contribution of which increased from 18 3 84 8 of total p input actual flux increased from 82 4 t year to 249 1 t year figs 5b 6 b when p loading was reduced internal n supply seemed to be the more insufficient one moreover although n fixation fluxes increased from 91 4 t year to 406 t year and the relative contribution of n fixation increased from 1 2 20 3 when n loading was reduced to 10 of baseline the increase of n fixation still could not cover the total reduction of external n loading in contrast to the scenarios proposed by schindler et al 2008 the reason for this difference could be differences in species composition and in time scales of studies the theoretical basis for schindler s view that n is not a limiting factor is that n fixation can eventually offset an n deficit indeed this is true from a long time scale however our model focused on yearly time scales since n fixation is also controlled by a number of physicochemical factors it does not necessary fully make up the n deficit in any given year especially in the presence of intense denitrification thus giving rise to n limitation in lake dianchi the cyanobacteria species composition is another potential reason for n limitation in lake dianchi not all species of cyanobacteria are capable of fixing n in lake dianchi the n fixer aphanizomenon only persists from march to may while non fixing microcystis dominates the lake throughout the year liu et al 2006 non linear relationships were detected in both n and p loading reduction scenarios this kind of phenomenon was well studied as internal nutrient loading essington and carpenter 2000 nowlin et al 2005 sondergaard et al 2013 in this model although n is the more insufficient nutrient internal n sources including benthic n flux and n fixation still had a positive influence on the hysteresis in n remediation in lake dianchi moreover the flux and contribution of denitrification decreased while n loading reduction increased n supply and anaerobic conditions are the two primary factors for denitrification nizzoli et al 2010 these were both removed by n loading reduction and resulting algae biomass reduction hence decreased removal by denitrification in response to reduction of n loading could be another reason for the hysteresis in n remediation in lake dianchi the strength of non linear relationship could also reflect the relative abundance of nutrients as bioavailable p tpo4 was more sufficient than din when p or n loading was reduced although the amount and fraction of tpo4 decreased under p loading reduction benthic p flux increased from 82 4 t year to 249 1 t year the contribution of it increased from 18 3 84 8 which contributed more than benthic n flux to the maintenance of eutrophication the increasing contribution of benthic fluxes of n and p with increasing load reduction support the hypothesis that internal loading has inhibited the remediation of eutrophication in lake dianchi and may be a similar role elsewhere together with the observed difference in the effects of n vs p loading reduction on algae biomass this differential impact of n vs p reduction on n and p cycling implies that n is the main limiting nutrient in lake dianchi 3 4 algae feedback enhancing nutrient cycling as cottingham et al 2015 pointed algae could affect nutrient cycling as a positive feedback however there is little quantitative evaluation of the changes of nutrient cycling due to algal blooms since the limiting nutrient in lake dianchi appears to be n the model of lake dianchi provides a perfect platform to explore the feedback of algae on p cycling especially benthic p flux in n loading reduction scenarios algae biomass can be controlled by the reduction of n loading which has no direct effect on p cycling an interesting pattern was found in p cycling in a series of n loading reduction scenarios the model simulations showed a negative non linear correlation between tpo4 and algae biomass annual average values were used in this analysis same below which indicated that tpo4 was consumed by algae when algae biomass increased fig 7 a this was associated with the increasing demand of tpo4 by algae that resulted from n loading increase besides tpo4 remained at a relatively low level when algae biomass reached 300 t n algae biomass is counted in n implying a significant contribution of benthic p flux to p pool nevertheless a strong positive linear correlation was found between benthic p flux and algae biomass as algae biomass increased the annual benthic p flux turned from negative to positive from acting as a sink of p cycling and resulting in up to 29 of the total p loss to acting as a main source of p cycling and accounting for 18 of total p input fig 7b in this series of scenarios external forcings of p remained the same as baseline scenario implying that all the changes of p cycling were driven by the change of algae biomass tpo4 uptake by algae increased as the algae biomass increased in different scenarios causing a steep tpo4 concentration gradient toward sediment which was a benefit of p release besides do was also consumed by algal blooms increasing the occurrence of hypoxic condition which was the driving factor of benthic p flux fig 7c as a result benthic p flux switched from adsorbing p into sediment to releasing p into water column thus the strong feedback of algae on benthic p flux in lake dianchi emphasized that algae played an important role as the primary linkage between n and p cycles different lakes may have different types of algae feedback nutrient limitation of algae plays an important role in algae feedback by influencing the metabolism of algae and subsequently the cycling of nutrients even in lake dianchi different algae feedback were observed of all the removal processes sedimentation is a key nutrient cycling process in lake system to some extent sedimentation limits the availability of nutrients for regeneration and release poister and armstrong 2003 moreover sedimentation of organic materials drives hypolimnetic oxygen depletion which further affects several biogeochemical processes including sediment tpo4 release and denitrification in the model of lake dianchi p sedimentation was the main removal pathway of total p loss however in the scenario analyses sedimentation fluxes of refractory particulate organic phosphorus rpop labile particulate organic phosphorus lpop and algae decreased more strongly with reduction of external n loading rather than with reduction of p when loading reduction is higher than 50 indicating a close link between n and p by algae figure s8 this phenomenon implies that considerable amounts of particulate organic phosphorus pop were from the metabolism of algae and zooplankton excretion instead of external loading which could be affected by n loading reduction in an n limited lake like lake dianchi genkai kato and carpenter 2005 guildford and taylor 2011 hantke et al 1996 qin and zhu 2006 wetzel 2001 in eutrophic lakes the recycling ratio would be much higher than in oligotrophic or mesotrophic lakes which means that the internal cycling of nutrients weighs much more than external loading in eutrophic lakes baines and pace 1994 essington and carpenter 2000 constitent with our previous study wu et al 2017 another kind of algae feedback was found in finlay et al 2013 n removal processes especially denitrification were closely related to algal blooms since p is viewed as the limiting nutrient in most lakes for algae growth reducing external p loading can reduce algal blooms and the influence of hypoxia weakening the algae feedback on denitrification denitrification was thereby impaired because of the aerobic water column and surficial sediments chen et al 2012 knuth and kelly 2011 however in the current study of lake dianchi in spite of the increase of no3 pool from 34 6 ton to 52 0 ton during algal bloom the denitrification flux remained nearly the same when external p loading was reduced on different levels figure 5c 5d since n was the limiting nutrient according to michaelis menten kinetics in the lake dianchi model the lake remained eutrophic and hypoxic due to algal blooms even when external p loading was reduced furthermore in this condition rates of denitrification remained the same as in the baseline scenario accordingly the main factor that likely leads to the difference between finlay et al 2013 and lake dianchi is the difference in the limiting nutrient for algae the limiting nutrient in different lakes varies greatly therefore the effects of nutrient loading reduction differ among lakes abell et al 2010 jeppesen et al 2007 moon and carrick 2007 thus changes in nutrient limitation status may alter the mechanisms of the feedback loop of algae and nutrient cycles which should be taken in to consideration for lake restoration efforts 4 conclusion a 3d model based nutrient flux tracking approach was developed to identify the fate and transport of nutrients along with algae growth in lake dianchi china the contributions of internal nutrient cycling and the response of nutrient cycling to external loading were explored the model results and scenario analysis highlighted a positive feedback loop between algal bloom and sediment release of p as well as the importance of internal nutrient cycling in lake dianchi a the annual fluxes of external loadings were 5164 t for n and 359 t for p accounting for 67 8 for n and 79 8 for p second to external loading were the benthic fluxes 2213 t for n and 82 4 t for p accounting for 28 04 for n and 18 30 for p denitrification was the biggest n removal processes at 3741 t per year contributing 49 of total n loss sedimentation of pop accounted for 62 8 of total p loss the largest component of p losses b benthic fluxes of n and p fluctuated considerably during the year with peaks in july benthic p flux in lake dianchi acted as a source of p to the water column from may to october but as a sink in other months in contrast to p benthic n fluxes were close to zero from january to march and increased rapidly from march to april the rapid increase of benthic fluxes of both n and p reflected the onset of hypoxia and establishment of concentration gradients c the results of scenario analyses showed that n was the primary and seasonal limiting nutrient for algae growth in lake dianchi in addition a positive feedback was detected between algal bloom and sediment release of p with different n loading reduction scenarios algae could support the sediment release of p by forming a steep tpo4 concentration gradient toward sediment as well as do consumption declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this paper was supported by the national science foundation of china 51779002 national basic research program of china 2015cb458900 and yunnan key laboratory of pollution process and management of plateau lake watershed appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2019 108881 appendix a supplementary data the following is supplementary data to this article 
24921,despite the great effort of nutrient loading reduction lake rehabilitation often suffers from the impacts of internal nutrient cycling however the mechanisms of internal nutrient cycling specifically the feedback of algal blooms on nutrients cycling is still an open question management of lake dianchi the most eutrophic lake in china has involved a series of costly measures but without significant algal bloom decreasing in view of the difficulty to evaluate the importance of internal cycling only by monitoring data a three dimensional model based flux tracking approach was performed to identify the contributions of internal cycling the results highlighted the role of nitrogen n and phosphorus p benthic fluxes with high seasonal fluctuations contributing 29 n and 18 p of total input the scenario analysis indicated that n loading reduction was more efficient for lake restoration furthermore a positive feedback was detected between algae biomass and benthic p flux benthic p flux varied from adsorption to release when algae biomass increased this phenomenon implied that a close link existed between n and p cycles with algae acting as a strong integrator due to the positive feedback loop between benthic p flux and algal blooms as well as the high efficiency of n loading reduction controlling both n and p loadings will benefit lake restoration especially eutrophic lakes with heavy sediment nutrient loadings keywords internal nutrient cycling phosphorus release water quality model scenario analysis algae feedback lake dianchi 1 introduction external loading reduction of nitrogen n and phosphorus p has been conducted globally for lake eutrophication control conley et al 2009 davidson and howarth 2007 seitzinger 2008 however there is an increasingly puzzle that it is not necessarily effective for all lakes ding et al 2018 liu et al 2013 yang et al 2013 possibly due to impacts of unobserved internal nutrient cycling previous studies have found that in eutrophic lakes internal nutrient cycling like benthic fluxes of n and p can be a significant part of nutrient input preventing or delaying lake recovery after external loading reduction especially significantly enhancing algal growth as nutrients sources bergstrom and jansson 2006 carpenter et al 1999 nowlin et al 2005 roy et al 2012 sondergaard et al 2013 wu et al 2017 zhou et al 2016 however the driving factors of internal nutrient cycling processes are complex and often harder to control than those affecting external loadings more importantly cottingham et al 2015 raised a new finding that cyanobacterial blooms could in turn affect p cycling a recent lab study also found a positive feedback loop where benthic p flux fuels algal blooms which in turn enhance the release of p chen et al 2018 algae was considered as a biological pump in this positive feedback loop while there is great need for more quantitative or empirical evidences therefore for effective management of lake eutrophication it is essential to consider the roles of internal nutrient cycling and to explore a how internal nutrient cycling processes respond to various nutrient management strategies and b how algae will change the nutrient cycling dynamics the effectiveness of loading reduction has been well studied however diverse patterns of internal cycling processes under different loading reduction scenarios have seldom been explored furthermore isolated considerations of n or p cycling changes in response to changes in external n or p loading may be misleading if we ignore the potentially tight links of lake n and p cycles due to the highly constrained link of n and p in living biomass bernhardt 2013 for example finlay et al 2013 showed that reducing p loading alone may result in exceptionally high n storage in lakes in which algae act as a primary link between n and p cycling mccarthy et al 2016 suding et al 2004 as primary producer the biomass of algae can be extremely large compared with macrophytes and consumers in eutrophic lakes meaning that nutrient uptake and release by algae might dominate the overall fluxes of n and p anderson et al 2002 friedrich et al 2003 qin 2009 ramin et al 2012 moreover algal blooms can also cause a drastic change of chemical conditions at sediment water interface favoring the release of fe bound p chen et al 2018 algae therefore have the potential to influence internal nutrient cycling three specific questions arose during the attempts to understand the internal nutrient cycling in lakes a are there any changes in the contribution of internal cycling during load reduction b if yes will there be different patterns for n p or n and p loading reduction and c is there a feedback loop between algae and nutrient cycling if so what is the mechanisms of the feedback although some internal processes can be evaluated in lab or by in situ experiments nowlin et al 2005 risgaard petersen et al 2003 it is still difficult to establish the patterns of internal nutrient cycling fluxes for a whole lake in different seasons considering spatial and temporal differences numerical modeling is a valuable and feasible tool to explore the dynamics of nutrient cycling integrating existing knowledge of relevant biogeochemical processes boyd 2012 hu et al 2006 wang et al 2003a b here a three dimensional 3d model derived from our previously developed calibrated and validated model of lake dianchi was used to simulate temporal changes of nutrient budgets under nutrient loading scenarios to explore the mechanisms of nutrient cycling liu et al 2014 wang et al 2014 yi et al 2016 2 methods 2 1 study area and data sources lake dianchi is the 6th largest lake in china and the largest plateau one in yunnan province southwestern china fig 1 with a surface area of 309 km2 a volume of 1 56 109 m3 a mean depth of 4 4 m and a watershed area of 2920 km2 historical monitoring has shown that lake water quality has deteriorated rapidly since late 1970s and especially since the 1990s however after over 20 years of restoration efforts the water column n and p concentrations decreased but there is no sign of significant improvement as expected for algae biomass figure s1 in supporting materials lake dianchi is a typical semi enclosed lake with high inflow low outflow long residence time and high evaporation which highlights the potential importance of internal nutrient cycling gao et al 2014 wu et al 2017 to facilitate more effective decision making for eutrophication control and ecological restoration in lake dianchi it is crucial to explore the dynamic processes of nutrient cycling and the responses of algae biomass in the lake monthly water quality data was collected from the routine monitoring program conducted by kunming environmental monitoring center it provides the basis for calibrating and validating the model developed in this study atmospheric and meteorological data are from the national meteorological information center river flow and velocity data are from the kunming bureau of hydrology and water resources please refer to supporting materials for the detailed configuration of boundary and initial conditions 2 2 model based numerical tracking of nutrient fluxes and pools changes in nutrient pools and fluxes are important to evaluate the ecological status of lakes while nutrient pools and fluxes can be estimated via direct measurements and experiments these often cannot illustrate the picture of the whole lake due to limitations on sampling sites impacts of vertical stratification and limited spatial coverage in contrast the 3d model is useful to calculate nutrient pools and fluxes the model for lake dianchi was derived from our previously developed calibrated and validated 3d model which was used in various studies like global sensitivity analysis and water diversion scenarios liu et al 2014 yi et al 2016 the model was based on efdc environmental fluids dynamics code an integrated 3d model to simulate hydrodynamics temperature and the cycles of carbon nitrogen phosphorus and silicon in living inorganic and organic forms refer to content s1 and figure s2 in supporting materials for modeling details in the model of lake dianchi nutrient pools and fluxes were calculated based on the mechanistic equations and spatial configuration fluxes and pools were calculated in each grid of the model the integral for fluxes and pools of all the grids were obtained according to the computational grid of lake dianchi based on the same discrete distribution the main equations for nutrient pools and fluxes are as below 1 n u t r i e n t p o o l m i t c i d x d y d z 2 n u t r i e n t l o a d i n g f w s i t k 1 n q t k c t k i 3 a t m o s p h e r i c d e p o s i t i o n f a i r i t d d i t d w i t d x d y 4 o u t p u t f o i t k 1 m q k t c k t i 5 b e n t h i c f l u x f b e n i t b e n i t d x d y 6 s e d i m e n t a t i o n f s e t i t f s i t d x d y 7 d e n i t r i f i c a t i o n f d e n t f d n t d x d y d z 8 n i t r o g e n f i x a t i o n f n f i x t f n f t d x d y d z where i represent different forms of nutrient c i is the concentration of i in water body q t k is the quantity of flow in inflowing river k on time t c t k i is the concentration of i in inflowing river k on time t dw i t is wet deposition of i dd i t is dry deposition of i q k t is the quantity of flow in outflowing river k on time t c k t i is the concentration of i in outflowing river k on time t ben i t is the benthic flux rate of i fs i t is sedimentation rate of i fdn t is the denitrification rate fnf t is the n fixation rate refer to s1 1 in supporting materials for detailed flux expressions 2 3 scenario definition in order to explore the efficiency of nutrient loading reductions and the impact of loading reduction on internal cycling processes three types of scenarios were evaluated a reducing n loading only b reducing p loading only and c reducing both n and p loading table s2 in each type of scenarios the reduction ratios are 10 30 50 70 80 and 90 there are 19 scenarios in all including baseline scenario the baseline scenario was defined as no reduction the results of all the scenarios were the fifth year of each model run in order to get a steady state the limiting nutrient of algae growth can be detected by the comparison of n only scenarios and p only scenarios the relationship between internal cycling of p or n to algae biomass change could be effectively studied in scenarios of n or p loading reduction based on the water quality modeling and calculation of nutrient cycling fluxes 3 results and discussion 3 1 model results before the model of lake dianchi could be used for the calculation of nutrient cycling fluxes as well as scenario analysis its ability to represent in lake water quality and processes of nutrient cycling were established through a model calibration and validation process in this study a data set consisting of two years of observations was used for calibration and validation the hydrodynamic module was first calibrated with the temperature data the water quality module was then calibrated with the observed data of chlorophyll a chla nh4 total phosphorus tp and do the simulated concentrations of chla nh4 tp and do in the surface layer are compared with observed data at eight routine monitoring stations in lake dianchi in fig 2 s4 however due to the lack of subsurface water column and surface sediment data the model was calibrated only with surface water quality data the calibrated values of for the key water quality parameters are listed in table s3 uncertainty analysis was conducted based on the lhs latin hypercube sampling method to see the uncertainty of chla do tn and tp and the sensitivity analysis was also conducted to see the response of chla do tn and tp to 38 parameters based on morris method figure s5 and table s5 supporting materials overall the validation results showed that the model results fit well with observed water quality variations in lake dianchi and the model can serve as a computational platform for further analysis some distinct seasonal patterns were found in the results of nutrient pools fig 3 nh4 and no3 pools increased in november and december but started to decrease in january and february indicating that a huge sink of nh4 and no3 existed during warmer seasons when algae started to grow this huge sink may result from the uptake of algae growth furthermore a delay was detected between nh4 and no3 indicating that nitrification took place in january and february leading to a rapid decrease of nh4 and an increase of no3 then no3 decreased rapidly and remained relatively low from april to october in contrast to nh4 and total phosphate tpo4 likely because of the relatively high denitrification flux during algal bloom from may to october different from no3 an increase of nh4 and tpo4 occurred from july to october likely due to the sediment release of nh4 and tpo4 during algal bloom in contrast to dissolved nutrients algae biomass increased from march and decreased in november logically algae uptake is likely the primary reason for the decrease of dissolved nutrients during algal bloom 3 2 contributions of nutrient internal cycling increasing evidence has shown that internal cycling of nutrients in shallow lakes may be one of the main factors maintaining eutrophication and preventing improvements in water quality jeppesen et al 2005 reductions of external nutrient loading have been implemented for decades in lake dianchi however there are still serious algal blooms with the summer maximum chlorophyll a chla reaching 209 μg l in recent years thus exploring the dynamics of internal cycling of nutrients may offer useful insights for lake rehabilitation the model results showed that in lake dianchi benthic fluxes of n and p accounted for 29 of total n input and 18 of total p input these fluxes were second to external loadings which contributed 68 for n and 80 for p fig 4 similar results have been shown in other studies for example in lake pontchartrain benthic p flux contributed 30 44 of annual p loading roy et al 2012 in lake taihu benthic fluxes of nh4 contributed 20 25 of total n loading while benthic p fluxes accounted for almost 50 of total p loading qin and zhu 2006 qin et al 2006 moreover a great fluctuation was detected in benthic fluxes of nutrients throughout the year in the model fig 4 seasonal fluctuations of benthic nutrients fluxes in the lake dianchi are supported by previous studies which showed that the benthic fluxes of nutrients vary monthly or seasonally sondergaard et al 1992 spears et al 2012 yang et al 2013 the benthic p flux in lake dianchi acted as a source sediment release of p to the water column from may to october but acted as a sink adsorption in other months unlike tpo4 the benthic n flux was close to zero from january to march which means an equilibrium existed between sediment release and adsorption of din dissolved inorganic nitrogen however this equilibrium was broken in early march because of the uptake by algae low do near the sediment as well as strong concentration gradients are likely the main driving factors enhancing benthic fluxes in systems like lake dianchi amirbahman et al 2003 li et al 2016 nowlin et al 2005 wu et al 2014 in lake dianchi benthic fluxes of n and p are synchronous with algae on account of the enhanced driving factors caused by biological uptake of algae as well as bottom hypoxia do 2 mg l resulting from algal bloom figure s5 paerl et al 2011 similar results were found in lake uzarzewskie a hyper eutrophic lake in poland kowalczewska madura et al 2015 where the highest p release rate was observed in autumn 44 7 mg p m2 day but p accumulation in sediments dominated over release in winter 0 33 0 62 mg p m2 day removal processes of nutrients are essential for lake dianchi because of its semi closed morphology in the absence of significant hydrologic outflow sedimentation of particulate organic matter and denitrification were the main pathways of nutrient removal in lake dianchi the outflow only accounted for 4 5 of total n loss and 9 4 of total p loss sedimentation was a major removal pathway for both n and p and accounted for 90 6 of total p loss and 46 5 of total n loss denitrification was a unique and important removal pathway of n internal cycling and accounted for 49 of the total n loss which is larger than sedimentation this large contribution of denitrification may be explained by algal blooms and the resulting low benthic do concentrations figure s6 it had been thought that hypoxia could not occur in lake dianchi because of its shallow depth however our previous model results showed that 6 82 of lake dianchi s volume was hypoxic annually which cannot be obtained from well mixed or 2d models liu et al 2014 overall our modeling effort highlights that benthic fluxes of n and p as well as denitrification are of great importance in eutrophic shallow lakes especially semi enclosed lakes 3 3 scenario analysis efficiency of p vs n loading reduction eighteen scenarios table s2 were set based on the validated model configuration to explore the efficiency of loading reduction on algae regulation as well as n and p internal cycling overall the scenario results showed that as expected algae biomass decreased when external loading was reduced however the efficiencies of n and p loading reduction were not the same n loading reduction and dual nutrient loading reduction had almost equal and higher performance for algae biomass than p loading reduction fig 5 a the reason why the efficiencies of these two measures were similar is that nutrient limitation was decided by taking the minimal value of n and p limitation factors in the algae growth equation of the model hamrick 1992 the lower efficiency of p loading reduction implied that bioavailable p was much more difficult to remove to the limiting level given the same nutrient loading reduction measures although n loading reduction was more efficient a non linear relationship between algae biomass and n loading reduction was still detected the same as p loading reduction in order to explore the non linear relationships between algae biomass and nutrient loading reduction n and p in different forms and fluxes of nutrient cycling processes were calculated in all scenarios fig 6 s7 table s6 s7 the reason why n loading reduction was more efficient lay in the insufficiency of din which implied that the internal source of din cannot support the uptake of algae n loading reduction had a large impact on n cycling processes although the contribution of benthic n flux increased from 29 0 46 3 of total n input in n loading reduction scenarios the actual flux decreased compared with benthic p flux the contribution of which increased from 18 3 84 8 of total p input actual flux increased from 82 4 t year to 249 1 t year figs 5b 6 b when p loading was reduced internal n supply seemed to be the more insufficient one moreover although n fixation fluxes increased from 91 4 t year to 406 t year and the relative contribution of n fixation increased from 1 2 20 3 when n loading was reduced to 10 of baseline the increase of n fixation still could not cover the total reduction of external n loading in contrast to the scenarios proposed by schindler et al 2008 the reason for this difference could be differences in species composition and in time scales of studies the theoretical basis for schindler s view that n is not a limiting factor is that n fixation can eventually offset an n deficit indeed this is true from a long time scale however our model focused on yearly time scales since n fixation is also controlled by a number of physicochemical factors it does not necessary fully make up the n deficit in any given year especially in the presence of intense denitrification thus giving rise to n limitation in lake dianchi the cyanobacteria species composition is another potential reason for n limitation in lake dianchi not all species of cyanobacteria are capable of fixing n in lake dianchi the n fixer aphanizomenon only persists from march to may while non fixing microcystis dominates the lake throughout the year liu et al 2006 non linear relationships were detected in both n and p loading reduction scenarios this kind of phenomenon was well studied as internal nutrient loading essington and carpenter 2000 nowlin et al 2005 sondergaard et al 2013 in this model although n is the more insufficient nutrient internal n sources including benthic n flux and n fixation still had a positive influence on the hysteresis in n remediation in lake dianchi moreover the flux and contribution of denitrification decreased while n loading reduction increased n supply and anaerobic conditions are the two primary factors for denitrification nizzoli et al 2010 these were both removed by n loading reduction and resulting algae biomass reduction hence decreased removal by denitrification in response to reduction of n loading could be another reason for the hysteresis in n remediation in lake dianchi the strength of non linear relationship could also reflect the relative abundance of nutrients as bioavailable p tpo4 was more sufficient than din when p or n loading was reduced although the amount and fraction of tpo4 decreased under p loading reduction benthic p flux increased from 82 4 t year to 249 1 t year the contribution of it increased from 18 3 84 8 which contributed more than benthic n flux to the maintenance of eutrophication the increasing contribution of benthic fluxes of n and p with increasing load reduction support the hypothesis that internal loading has inhibited the remediation of eutrophication in lake dianchi and may be a similar role elsewhere together with the observed difference in the effects of n vs p loading reduction on algae biomass this differential impact of n vs p reduction on n and p cycling implies that n is the main limiting nutrient in lake dianchi 3 4 algae feedback enhancing nutrient cycling as cottingham et al 2015 pointed algae could affect nutrient cycling as a positive feedback however there is little quantitative evaluation of the changes of nutrient cycling due to algal blooms since the limiting nutrient in lake dianchi appears to be n the model of lake dianchi provides a perfect platform to explore the feedback of algae on p cycling especially benthic p flux in n loading reduction scenarios algae biomass can be controlled by the reduction of n loading which has no direct effect on p cycling an interesting pattern was found in p cycling in a series of n loading reduction scenarios the model simulations showed a negative non linear correlation between tpo4 and algae biomass annual average values were used in this analysis same below which indicated that tpo4 was consumed by algae when algae biomass increased fig 7 a this was associated with the increasing demand of tpo4 by algae that resulted from n loading increase besides tpo4 remained at a relatively low level when algae biomass reached 300 t n algae biomass is counted in n implying a significant contribution of benthic p flux to p pool nevertheless a strong positive linear correlation was found between benthic p flux and algae biomass as algae biomass increased the annual benthic p flux turned from negative to positive from acting as a sink of p cycling and resulting in up to 29 of the total p loss to acting as a main source of p cycling and accounting for 18 of total p input fig 7b in this series of scenarios external forcings of p remained the same as baseline scenario implying that all the changes of p cycling were driven by the change of algae biomass tpo4 uptake by algae increased as the algae biomass increased in different scenarios causing a steep tpo4 concentration gradient toward sediment which was a benefit of p release besides do was also consumed by algal blooms increasing the occurrence of hypoxic condition which was the driving factor of benthic p flux fig 7c as a result benthic p flux switched from adsorbing p into sediment to releasing p into water column thus the strong feedback of algae on benthic p flux in lake dianchi emphasized that algae played an important role as the primary linkage between n and p cycles different lakes may have different types of algae feedback nutrient limitation of algae plays an important role in algae feedback by influencing the metabolism of algae and subsequently the cycling of nutrients even in lake dianchi different algae feedback were observed of all the removal processes sedimentation is a key nutrient cycling process in lake system to some extent sedimentation limits the availability of nutrients for regeneration and release poister and armstrong 2003 moreover sedimentation of organic materials drives hypolimnetic oxygen depletion which further affects several biogeochemical processes including sediment tpo4 release and denitrification in the model of lake dianchi p sedimentation was the main removal pathway of total p loss however in the scenario analyses sedimentation fluxes of refractory particulate organic phosphorus rpop labile particulate organic phosphorus lpop and algae decreased more strongly with reduction of external n loading rather than with reduction of p when loading reduction is higher than 50 indicating a close link between n and p by algae figure s8 this phenomenon implies that considerable amounts of particulate organic phosphorus pop were from the metabolism of algae and zooplankton excretion instead of external loading which could be affected by n loading reduction in an n limited lake like lake dianchi genkai kato and carpenter 2005 guildford and taylor 2011 hantke et al 1996 qin and zhu 2006 wetzel 2001 in eutrophic lakes the recycling ratio would be much higher than in oligotrophic or mesotrophic lakes which means that the internal cycling of nutrients weighs much more than external loading in eutrophic lakes baines and pace 1994 essington and carpenter 2000 constitent with our previous study wu et al 2017 another kind of algae feedback was found in finlay et al 2013 n removal processes especially denitrification were closely related to algal blooms since p is viewed as the limiting nutrient in most lakes for algae growth reducing external p loading can reduce algal blooms and the influence of hypoxia weakening the algae feedback on denitrification denitrification was thereby impaired because of the aerobic water column and surficial sediments chen et al 2012 knuth and kelly 2011 however in the current study of lake dianchi in spite of the increase of no3 pool from 34 6 ton to 52 0 ton during algal bloom the denitrification flux remained nearly the same when external p loading was reduced on different levels figure 5c 5d since n was the limiting nutrient according to michaelis menten kinetics in the lake dianchi model the lake remained eutrophic and hypoxic due to algal blooms even when external p loading was reduced furthermore in this condition rates of denitrification remained the same as in the baseline scenario accordingly the main factor that likely leads to the difference between finlay et al 2013 and lake dianchi is the difference in the limiting nutrient for algae the limiting nutrient in different lakes varies greatly therefore the effects of nutrient loading reduction differ among lakes abell et al 2010 jeppesen et al 2007 moon and carrick 2007 thus changes in nutrient limitation status may alter the mechanisms of the feedback loop of algae and nutrient cycles which should be taken in to consideration for lake restoration efforts 4 conclusion a 3d model based nutrient flux tracking approach was developed to identify the fate and transport of nutrients along with algae growth in lake dianchi china the contributions of internal nutrient cycling and the response of nutrient cycling to external loading were explored the model results and scenario analysis highlighted a positive feedback loop between algal bloom and sediment release of p as well as the importance of internal nutrient cycling in lake dianchi a the annual fluxes of external loadings were 5164 t for n and 359 t for p accounting for 67 8 for n and 79 8 for p second to external loading were the benthic fluxes 2213 t for n and 82 4 t for p accounting for 28 04 for n and 18 30 for p denitrification was the biggest n removal processes at 3741 t per year contributing 49 of total n loss sedimentation of pop accounted for 62 8 of total p loss the largest component of p losses b benthic fluxes of n and p fluctuated considerably during the year with peaks in july benthic p flux in lake dianchi acted as a source of p to the water column from may to october but as a sink in other months in contrast to p benthic n fluxes were close to zero from january to march and increased rapidly from march to april the rapid increase of benthic fluxes of both n and p reflected the onset of hypoxia and establishment of concentration gradients c the results of scenario analyses showed that n was the primary and seasonal limiting nutrient for algae growth in lake dianchi in addition a positive feedback was detected between algal bloom and sediment release of p with different n loading reduction scenarios algae could support the sediment release of p by forming a steep tpo4 concentration gradient toward sediment as well as do consumption declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this paper was supported by the national science foundation of china 51779002 national basic research program of china 2015cb458900 and yunnan key laboratory of pollution process and management of plateau lake watershed appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2019 108881 appendix a supplementary data the following is supplementary data to this article 
24922,the robustness of communities to species loss is a major topic in ecological research here we introduce the dependent random search coextinction model dcm a new approach for modelling the consequences of primary extinctions in ecological networks the dcm assumes that species may persist after a primary extinction through two non exclusive mechanisms compensation i e by increasing the interaction strength with living partners and new interactions in the dcm the strengths of the compensated interactions are proportional to the dependence on the lost partner while the strengths of new interactions are proportional to the resemblance e g phylogenetic functional between the extinct partners and the new ones using simulations with mutualistic webs as templates we show that the probability of extinction cascades and the total number of extinctions decrease in highly connected networks and the probability of extinction cascades increased in highly nested networks the proposed model is simple and can be used in a variety of interaction networks e g mutualistic food webs host parasite with any species species resemblances representing ecological or evolutionary dissimilarities keywords species interactions network robustness extinction cascades species loss primary extinction network rewiring 1 introduction the fragility of ecological systems to species loss and its effects on the sustainability of the structure of communities has been a major concern among ecologists carpenter et al 2015 ecological systems consist of interconnected participants that can be investigated as interaction networks with vertices composed of species or trophic levels dunne et al 2002 bascompte 2010 although the loss of a single species inevitably places other species at risk it is not an easy task to estimate the likelihood that primary extinctions will cause new extinction events integrating species interactions and network based approaches have allowed to evaluate the joint effects of species loss vulnerability and extinction cascades gao et al 2016 however because large scale extinction experiments involving multiple interacting species are difficult to implement keil et al 2018 a common solution is to resort to simulations to evaluate the fragility of ecological communities binzer et al 2011 evans et al 2013 such simulations are built under certain assumptions with the ultimate goal of understanding the vulnerability of ecological networks to species loss within a range of theoretical conditions simulations are very useful tools in predicting biodiversity loss and its consequences and their applications have evolved considerably in recent years traveset et al 2017 the proportion of secondary or higher order species losses after a primary extinction event i e extinctions following other extinction events is a conventional way of assessing the fragility of ecological networks eklöf and ebenman 2006 curtsdotter et al 2011 landi et al 2018 one key problem involved in such an approach is how to estimate the susceptibility to extinction for the other species as a result of a primary extinction the first solution to this problem came from the topological coextinction model tcm see dunne et al 2002 memmott et al 2004 which is based on a binary 0 or 1 extinction probability in a simple algorithm the tcm removes species from networks and checks how many of its partners would be left with no remaining interactions it assumes that the coextinction of a given species will occur only when it has no link with any remaining species for the sake of simplicity the tcm also ignores differences in interaction strength as well as differences in species specific dependence memmott et al 2004 vázquez et al 2005 in particular this model revealed that more species were likely to suffer secondary extinctions in weakly connected networks due to the higher probability of a species losing all of its partners dunne et al 2002 memmott et al 2004 vieira and almeida neto 2015 however the dependence of each species on each particular interaction seems intuitively fundamental to estimate the probability of persistence when modelling coextinctions recently the stochastic coextinction model scm was developed to account for additional factors that are expected to affect the probability of coextinction vieira and almeida neto 2015 in contrast to the tcm the coextinction probabilities under the scm range from 0 to 1 and are calculated independently for each species the coextinction probabilities are based on the interaction strength with the primarily extinct species and on the intrinsic demographic dependence on the service provided by the interaction for instance the probability of a plant species going extinct after the extinction of a given pollinator depends on how frequent the visits of such pollinator are in relation to all others and how this plant species is able to produce viable seeds through selfing or apomixis this model is more flexible because it relaxes the assumption that coextinctions are restricted to the loss of all partners i e species may become extinct even with still living partners primarily this means that the scm may result in more complex extinction cascades i e coextinctions following coextinctions or horizontal extinctions sanders et al 2013 interestingly more extinctions were observed in highly connected networks due to the higher number of species that were prone to coextinction following a primary extinction vieira and almeida neto 2015 however extracting empirical information about the intrinsic demographic dependence of each species on each interaction is challenging and this limits the applications of the scm these topological and stochastic models along with extensions to include populations and interaction dynamics trophic cascade effects alternative sequences of extinctions and perturbations have been extensively used to model extinction cascades representing complementary theoretical advances eklöf and ebenman 2006 curtsdotter et al 2011 brodie et al 2014 fricke et al 2017 traveset et al 2017 although the scm represents a clear improvement over the simplistic assumptions of the tcm both models i only implicitly account for compensating interactions and ii do not account for new interactions compensation mediated persistence occurs when individuals reallocate their interactions towards the remaining partners offsetting the negative demographic effects of losing one or more partners carvalheiro et al 2008 brodie et al 2014 under the tcm species are able to compensate for the loss of any partner regardless of its importance whenever it has at least one remaining partner for this reason no biological or population level constraints are imposed and compensation efforts are virtually equivalent complementarily the scm assumes that compensation is directly related to the dependence on extinct partners a species low probability of coextinction is interpreted as having a high potential to compensate for the loss by interacting more frequently with the remaining partners vieira and almeida neto 2015 quantifying compensation explicitly is a challenging task because many species specific aspects of ecological networks are not directly measurable even more difficult is to quantify the probability of new interactions because of many biological and ecological constraints regarding morphology and physiological adaptations accessibility and population dynamics thierry et al 2011 brodie et al 2014 in an attempt to introduce more realism to extinction simulations we developed a coextinction model that directly incorporates compensation mediated persistence and the formation of new interactions while retaining the relative simplicity of existing coextinction models our dependent random search coextinction model dcm preserves the stochastic properties of the scm and incorporates deterministic processes based on species dissimilarities and interactions strength see methods for definitions the main novelty of our model is that it relates the susceptibility to extinction and the selection of new partners directly with how similar the remaining species are to the lost partner this is done by incorporating the resemblances among species which can represent a variety of biological ecological and evolutionary aspects that fit in a species species dissimilarity matrix intuitively we may expect that the probability of coextinction will decrease as long as the existing or potential partners resemble e g morphologically functionally or phylogenetically the extinct one for example in a given community if a pollinator interacts with a plant that has a unique flower type and color this ecological dissimilarity from the other plants suggest that the chance for compensation or new interactions is unlikely for this pollinator although we used mutualistic networks to exemplify the new coextinction model is perfectly applicable to other types of ecological and non ecological networks e g food webs host parasite and species habitat networks finally to explore the behavior of the dcm and compare it with those for the scm and tcm we evaluated the extent to which patterns of coextinctions under the three models are related to connectance and nestedness two network properties that have been shown to influence robustness against coextinctions 2 materials and methods 2 1 the model we developed a coextinction model for ecological networks based on the key assumption that species may persist through two non exclusive mechanisms 1 compensation for lost interactions by intensifying the interactions with the current partners and 2 the establishment of new interactions with the remaining species the model is suitable for any kind of bipartite network formed by two sets a and b in which every element in a interacts with one or more elements in b and vice versa and could eventually deal with networks that are often unipartite e g food webs but requires particular adjustments regarding extinctions and probability calculations the inputs of the model requires a species by species ith by jth interaction matrix the species specific intrinsic demographic dependences for each species r i and the dissimilarities among species which are optional but are the core development of the model if initially provided the model which has its routine illustrated in fig 1 starts with a random extinction of a single species j from for example level a we defined s i j d i j r i d i s t j as the susceptibility of species i from level b to coextinction following the extinction of species j the dependence of i on j d i j is defined as the relative strength of the interaction between i and j i i j and is calculated by dividing the ij interaction by the sum of all interactions of i bascompte et al 2006 note that d i j and d j i may not be equivalent r i is a constant that depicts the intrinsic demographic dependence of species i on the interaction in question finally d i s t j is defined as the average distance dissimilarity between species j and all other species in its group this measure may represent a variety of resemblances i e relatedness between species within a group in regard to certain ecological evolutionary behavioral and or phylogenetic components legendre and legendre 2012 if we consider phylogenetic dissimilarities for example the more phylogenetically closer a new plant partner is to the extinct one the greater the probability of persistence of the pollinator assuming that the phylogenetic signal is strong enough to result in a similar phenotype the same can be expected if functional dissimilarities are considered for simplicity we used the bray curtis dissimilarities among species within each group as calculated from an interaction matrix based on the pairwise dissimilarities for both rows and columns this is a quantitative dissimilarity index widely used in ecology but the model can be easily adapted to deal with any other index for mathematical purposes when dissimilarities are not initially provided the calculated values belong to the interval between 0 and 1 if provided the dissimilarities are standardized to this interval independently if d i s t j is high then species j is very dissimilar to other species in that group in terms of shared partners ecologically this implies in a low probability of finding another related partner j such that i may compensate for the extinction of j or establish a new interaction if species i is likely to become extinct following a bernoulli trial with the susceptibility to coextinction s i j i e species i is likely to become coextinct if s i j is greater than a random value between 0 and 1 sampled from a uniform distribution the model will deal with this in one of two ways fig 1 first if species i is susceptible to coextinction and interacts only with j the persistence of i will be contingent upon new interaction s with another partner s at this step a parameter defined as an extinction threshold e t will modulate the persistence of i based on s i j this parameter represents a threshold for the coextinction probability in which species will persist if e t s i j and was implemented to prevent the model from indiscriminately creating new interactions and therefore allowing every potentially isolated species to persist thus if species i is able to establish new interactions it is defined as persistent and proceeds to partner s selection the selection of the new partner s follows three rules first the model respects the original degree of each species i e the number of interaction links jordano et al 2003 for example the maximum number of links for a species that seeks new interactions i e the maximum number of new interactions allowed for species i is restricted to its original degree n before a primary extinction event in addition the maximum number of links for species that receive new interactions i e the maximum number of interactions for species j is limited to n 1 this criterion considers the observed structure of each empirical interaction network assuming that it portrays the result of the species evolutionary history and demographic constraints bascompte et al 2006 besides it prevents the model from creating an overestimated robustness during the simulations second the selection of new partners considers the similarities between the extinct partner and all remaining species in other words the model is likely to select new partners that are more similar to the extinct ones as is expected in natural networks this is achieved by using the similarities between each species pair jj given by 1 d i s t j j as probabilities during the selection of each new partner from j s group third each new interaction between i and the new partner j is created as n i j i i j 1 d i s t j j where the strength of the new interaction n i j will be proportional to the lost interaction i i j and decreased by the distance between the extinct partner j and the new partner j d i s t j j ecologically our model assumes that species whose interactions were preferentially established with the extinct partner i e high i i j will invest more in making new interactions representing the species struggle to persist most importantly the model will consider that species will be able to establish stronger interactions with new partners that are more similar to the ones that were extinct assuming the underlying role of co evolution and ecological affinity it should be noted that new interactions will never exceed the strength of lost interactions but can eventually become stronger than existing interactions complementarily if species i is susceptible to coextinction but also interacts with other species compensation mediated persistence may occur at this stage a bernoulli trial may result in coextinction to conserve the stochastic properties in the model and also to depict slow inertia in species adaptation towards existing or new partners if persistence is confirmed the existing interactions between i and all other partners in j s group j will be enhanced so that the strength of each compensated interaction is given by c i j i i j 1 d i j where i i j is the previous strength of the interaction between i and j and d i j is the dependence of i on its extinct partner j ecologically this means that species with a higher dependence on extinct partners will exhibit increased compensation mediated persistence assuming that there are no population level constraints i e individuals of species j can actually receive or interact with more individuals of i at this step the model also considers the possibility for a new interaction for each species in addition to the compensation mediated persistence the probability of making a new interaction is calculated for each i species as p i g i d i j where g i is the normalized degree of species i i e number of realized interactions number of possible interactions which is a measure of the generalization of i simply put generalist species would have greater opportunities of making new interactions even if they still have living partners as we may expect in ecological systems only one new interaction is allowed at this stage to avoid artificial robustness during simulations finally the definition of the selected partner will depend on the d i s t j j as described above in sum simulations start by removing a single species from a level e g level a and then calculating the susceptibility to coextinction for every species in the other level e g level b if one or more species from level b is prone to coextinction the model simulates new interactions if the species was only interacting with the extinct partner and or compensation mediated persistence if the species has remaining partners finally if one or more species is coextinct in level b the susceptibility to coextinction is calculated back for all species in level a and the same steps are repeated whenever co extinctions in one level results in coextinctions in the other level the degree of extinction cascade increases i e extinctions without coextinctions are considered degree one coextinctions following extinctions are degree two and coextinctions following coextinctions are considered as degree three or higher the interaction matrix is updated i e to include vanished compensated and new interactions and dependences are recalculated equilibrium is reached when no additional coextinctions occur in our model no species can survive without interactions and species undergo coextinction after the loss of a partner through the following mechanisms i stochastic coextinctions of species that interacted with additional partners before possible compensation and ii deterministic coextinctions of species that only interacted with the extinct partner and display a high probability of coextinction the implementation of ii implies that the model will not force every species that was left without partners to establish new interactions and thus persist this conservative theoretical decision aimed to indirectly prevent the model from indiscriminately creating interactions during the simulations on the other hand the model restricts species to the formation of a single new interaction in the case of those presenting one or more non extinct partners assuming that a given species has less cost to adapt interactions with its current partners rather than establishing new interactions this condition was important to avoid creating a new network at each simulation step which would stray far from a realistic situation moreover our model incorporates deterministic properties by considering the strength of existing interactions and the resemblances among species for the susceptibility to extinction and the selection of new partners because new interactions are assigned in our model through a random search procedure that considers the similarities among species we named it the dependent random search coextinction model dcm the full model algorithm is summarized in fig 1 2 2 simulations with empirical data model performance was evaluated using data from 30 quantitative mutualistic networks 17 pollinator plant and 13 seed dispersal networks we obtained data from rezende et al 2007 and dormann et al 2008 see appendix 1 each simulation was a single extinction cascade in which one species was removed at random and the following coextinctions were tracked initial values for d i j were calculated from the original interaction matrices and updated during the cascades the values for r i were uniformly sampled for each simulated cascade from three intervals representing low 0 r i 0 3 intermediate 0 3 r i 0 6 and high 0 6 r i 1 intrinsic demographic dependence on interactions to evaluate how the parameter e t may affect the model performance we simulated cascades using three levels 0 25 0 5 and 0 75 the degree of extinction cascades increased every time the cascade produced another round of coextinctions in the other level furthermore we recorded the overall number of extinctions in each cascade by counting the species that became extinct for each network we performed 1000 simulations to estimate the frequency distribution of cascade degree and the number of extinctions based on this distribution we calculated the probability of a primary extinction resulting in an extinction cascade by counting all cascades that produced degrees 1 and dividing by the number of simulations to investigate the overall trends between network properties connectance and nestedness and the extinction cascades observed in our model we used spearman s rank correlations to correlate these two network properties with the probability of extinction cascades and the number of extinctions we calculate connectance as proportion of possible interactions that were realized to calculate the degree of nestedness we used the nodf index almeida neto et al 2008 to check for model coherence we also correlated these metrics with the mean values for the number of compensated interactions as well as the number of new interactions we also compared the performance of our model with additional extinction simulations using the scm and the tcm all procedures including model implementation evaluation and data analysis were performed in the r programming environment r development core team 2018 the main code and auxiliary functions are available at a github repository https github com mtbaumgartner dcm connectance and nestedness were calculated using the bipartite package dormann et al 2009 3 results 3 1 model performance the frequency distribution of extinction cascades differed depending on the coextinction model as exemplified in fig 2 all models presented higher frequencies of one degree cascades representing single extinctions that did not result in coextinctions as expected the dcm and scm had longer extinction cascades than the tcm which by constraint cannot produce third or higher degree cascades which made the frequency of one degree cascades the highest for this last model the frequency of extinction cascades decreased consistently for both the dcm and scm with an increasing degree of extinction cascade however the maximum values of cascade degrees were generally lower for the dcm than for the scm in the example from fig 2 the maximum degree was five for the dcm and nine for the scm meaning that primary extinctions led to shorter cascades in simulations under the dcm in the dcm connectance had a negative effect on the probability of extinction cascades fig 3 a as expected secondary extinctions were more likely in highly connected networks under the scm fig 3b while the opposite was observed under the tcm fig 3c furthermore nestedness increased the probability of extinction cascades under both the dcm and scm fig 3d e with no clear effect observed under the tcm fig 3f similarly the overall number of extinctions displayed a significant negative relationship with connectance under both the dcm fig 3g and the tcm fig 3h highly nested networks displayed fewer extinctions under the dcm fig 3j and the tcm fig 3k with no effect observed under the scm fig 3l 3 2 network metrics vs model parameters the overall effects of connectance and nestedness on both the degree of extinction cascades and the overall number of extinctions were observed across the considered levels of the model parameters r i and e t fig 4 these effects emerged as both model parameters increased especially r i in accordance with the evidence above under alternative combinations of model parameters the probability that a primary extinction will result in extinction cascades decreased with connectance and increased with nestedness fig 4a c conversely the total number of extinctions decrease with both connectance and nestedness fig 4d f remarkably there was a clear trend of an increasing effect of network metrics on community robustness as the intrinsic demographic dependence on the interaction r i increases particularly for nestedness fig 4a c however an exception is noted in networks with low r i in this scenario species are less likely to exhibit secondary extinctions even if dependence on lost interactions d i j and average distance to potential partners d i s t j are high which diminishes the potential effects of the network metrics on the consequences of primary extinctions this illustrates that both parameters affect the model performance due to their influence on the relationship between network structure and species coextinctions comparatively the effect of parameter e t appears more discrete than the effect of r i overall in practice we recommend setting e t to 0 5 as a conservative condition when using the dcm which may prevent user driven bias during model simulations in evaluating the relationships between network metrics and model outputs fig 5 no relationship was observed between connectance or nestedness and the number of compensated interactions fig 5e f however connectance and nestedness presented a positive effect on the number of new interactions with a particular hump shaped increase fig 5a b the probability of new interactions increased with connectance because the species are not allowed to increase their degree i e number of partners during the coextinction events in highly nested networks the similarities in terms of shared partners increases the chance of finding a more profitable new partner the number of compensated interactions was highly correlated with the total number of extinctions fig 5g assuming from an ecological perspective that the higher the number of partners that are extinct the more willing the remaining species will be to compensate interactions our model performed precisely as expected 4 discussion we introduced a novel approach to modelling species coextinctions the dcm which incorporates compensation mediated persistence and new interactions into coextinction simulations in ecological networks the dcm combines several characteristics of existing coextinction models and its retrieved statistics revealed that the artificial dynamics of the interactions are performing adequately under certain ecological assumptions regarding the struggle of species for persistence using mutualistic networks as templates we found that the probability of extinction cascades decrease with connectance and increase with nestedness while the overall number of extinctions decreases with increasing levels of both network properties we also found that the extinction cascades were shorter than those under the scm the fact that our model showed that the number of secondary extinctions decreases in more connected networks follows the view that robustness increases with connectance dunne et al 2002 eklöf and ebenman 2006 thébault and fontaine 2010 however we also evidenced that differences in interaction strategy i e dependence rather than network structure e g connectance and nestedness primarily accounts for stability in ecological networks see fricke et al 2017 the dcm accounted for intrinsic dependencies on each particular interaction an important piece of biological and ecological information vieira and almeida neto 2015 traveset et al 2017 our model also accounted for the similarities between the remaining species and the lost partners which we believe is a more straightforward approach than those of previous models in our model the probability of secondary extinctions increases with nestedness but the total number of extinctions was lower in highly nested networks these findings suggest an underlying mechanism relating nestedness and community robustness considering the tradeoff between the increased probability of extinction cascade and the lower total number of extinctions nestedness is a common pattern in ecological networks bascompte et al 2003 nielsen and bascompte 2007 ulrich and almeida neto 2012 and species that contribute most to nestedness have also been shown to contribute the most to community robustness nested patterns also arise from simulations that consider interaction switch i e when species change their partners through time in a cost effective way starting from random interactions zhang et al 2011 nuwagaba et al 2017 it has also been highlighted that interactions in ecological networks dynamically change over time kaiser bunbury et al 2010 blonder et al 2012 schleuning et al 2016 moreover evolutionary adaptation and increased phenotypic plasticity are mechanisms that can also prevent species coextinctions through new interactions brodie et al 2014 caradonna et al 2017 hui et al 2018 although our model does not account for any other cause for interaction shifts besides extinctions the fact that species can compensate for extinctions and establish new interactions when facing potential coextinction is crucial in approaching the complexity of real world networks while preserving model simplicity in practice more complex models have limited use because more biological information is required to define the model parameters which is the main reason we developed the dcm within the narrowest simplicity in addition the fact that more compensated interactions arise in networks under high extinction levels suggests that our model actually represents the willing of networks to avoid collapse and sustain its structure the formation of new interactions i e species rewiring or switching in networks has already been considered in previous extinction simulations schleuning et al 2016 caradonna et al 2017 nnakenyi et al 2019 furthermore rewiring can increase the network robustness against species loss and disturbances ramos jiliberto et al 2012 nuwagaba et al 2017 the dcm constitutes an important step towards more realistic coextinction models i e in terms of recreating more realistic networks than former approaches for three main reasons first the strength of compensated interactions is directly related to species dependence on lost partners the dcm builds on the approach of vieira and almeida neto 2015 and improves it by directly modifying the interaction matrices and dependencies updating the interaction strengths among species second the selection of new partners follows the intuition that species extinction risk is inversely related to population abundances and the availability of potential partners i e mutualists resource that are more similar to the lost ones third our model also extends upon the approach of schleuning et al 2016 in regard to the formation of new interactions changes in the biotic interaction structure have been considered key aspects of the maintenance of network structure and functioning nnakenyi et al 2019 in addition the adaptive interaction switching behavior seems to be the dynamics underlying empirical ecological networks nuwagaba et al 2017 while the dcm allows species to interact with new partners it is also respectful to the original number of interactions of each species in the network the number of newly made interactions between species likely to go coextinct and those that are hosting new interaction are constrained by the original degree of species for this reason the criteria for rewiring in the dcm are quite concrete in their ecological constraints which improves over other highly unrestrictive coextinction models e g nuwagaba et al 2017 thus representing an important contribution for assessing robustness in ecological communities of course as a simulation model it is still a simplification of real world systems and conclusions might be context dependent and must still be carefully evaluated although correlations between the probability of extinction cascades and the number of extinctions in the dcm were similar to those in the topological coextinction model tcm there are a few important differences see table 1 the dcm predicts longer extinction cascades while the tcm is not able to do so the tcm consists of only two steps select one random species to go extinct and then count those partners that no longer establish interactions this process systematically ignores the probability of coextinction when species are still connected to non extinct partners memmott et al 2004 which underestimates the overall number of extinctions in a network conversely both the dcm and scm do not truncate the degree of extinction cascade or the number of extinctions which is why we believe that these models are conceptually closer to real ecological communities vieira and almeida neto 2015 we also found that extinction cascades were shorter in our model than in the scm this can be attributed to its compensation mediated persistence and the ability to establish new interactions because the ability to either switch interactions or establish new ones increases the robustness against species extinctions in mutualistic networks ramos jiliberto et al 2012 we believe that our model the dcm is a more realistic representation of ecological networks specifically those characterized by less constrained and less specialized interactions when the establishment of new interactions is highly constrained by coevolved adaptations e g figs and fig wasps plants and galling insects then it is less likely that coextinctions will be significantly reduced by a species ability to switch and establish new interactions the dcm is proposed herein as a tool for many applications in ecology because of its flexibility to work depending on which resemblances are provided to widen the use of our model we suggest constructing hypotheses based on the different types of species dissimilarities for example one can identify keystone species in a community and investigate how its functional traits relate to community robustness simply by manipulating which traits are used to compute functional dissimilarity matrices alternatively the dcm can be used in antagonistic networks such as traditional food webs and host parasite networks in such case if a prey species goes extinct the remaining consumer s may be able to compensate by consuming more on another prey species or by consuming on a new species however if a consumer goes extinct its prey species and their interactions with other consumers will be preserved this is achieved by setting all dissimilarities among consumers to zero although this is a straightforward approach we should also note that it neglects population level dynamics in conclusion our model allows one to extend the simulations of coextinction cascades in ecological networks by considering the possibility of species reducing the negative effects of losing a partner by increasing its interactions with existing partners or establishing new interactions with other species we believe that this approach models cascades more accurately than previous coextinction models that neglect the possibilities of compensation by new or existing interactions furthermore the dcm expands previous modelling toolkit and allow ecologists to assess ecosystem vulnerability and to identify keystone species via its flexibility in incorporating specific hypothesis driven approaches finally we believe the next step in the development of coextinction models would be to incorporate a dynamic structure in which species can switch their interaction partners according to resource availability and increased fitness derived from this switching author contributions m t b and m a n conceived the model and designed the study m t b collected the data implemented the code and performed the analyses m t b wrote the first draft m a n and l c g contributed fundamentally to the drafts all authors gave final approval for publication software and data availability there are three online supporting files for this article the first two are excel files xlsx with the networks used and the correlations respectively that are available along with the online version the third is the source code and auxiliary functions in r language for the model that are stored in a github repository declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we are grateful to luisa carvalheiro and marcos costa vieira for their constructive suggestions on an early version of this manuscript as well as to two anonymous reviewers for their fruitful contributions mtb would like to thank the scholarship provided by the coordenação de aperfeiçoamento de pessoal de nível superior capes process 88882 344449 2019 01 man received funding from conselho nacional de desenvolvimento científico e tecnológico cnpq grant 310461 2015 4 appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2019 108876 appendix a supplementary data the following are supplementary data to this article 
24922,the robustness of communities to species loss is a major topic in ecological research here we introduce the dependent random search coextinction model dcm a new approach for modelling the consequences of primary extinctions in ecological networks the dcm assumes that species may persist after a primary extinction through two non exclusive mechanisms compensation i e by increasing the interaction strength with living partners and new interactions in the dcm the strengths of the compensated interactions are proportional to the dependence on the lost partner while the strengths of new interactions are proportional to the resemblance e g phylogenetic functional between the extinct partners and the new ones using simulations with mutualistic webs as templates we show that the probability of extinction cascades and the total number of extinctions decrease in highly connected networks and the probability of extinction cascades increased in highly nested networks the proposed model is simple and can be used in a variety of interaction networks e g mutualistic food webs host parasite with any species species resemblances representing ecological or evolutionary dissimilarities keywords species interactions network robustness extinction cascades species loss primary extinction network rewiring 1 introduction the fragility of ecological systems to species loss and its effects on the sustainability of the structure of communities has been a major concern among ecologists carpenter et al 2015 ecological systems consist of interconnected participants that can be investigated as interaction networks with vertices composed of species or trophic levels dunne et al 2002 bascompte 2010 although the loss of a single species inevitably places other species at risk it is not an easy task to estimate the likelihood that primary extinctions will cause new extinction events integrating species interactions and network based approaches have allowed to evaluate the joint effects of species loss vulnerability and extinction cascades gao et al 2016 however because large scale extinction experiments involving multiple interacting species are difficult to implement keil et al 2018 a common solution is to resort to simulations to evaluate the fragility of ecological communities binzer et al 2011 evans et al 2013 such simulations are built under certain assumptions with the ultimate goal of understanding the vulnerability of ecological networks to species loss within a range of theoretical conditions simulations are very useful tools in predicting biodiversity loss and its consequences and their applications have evolved considerably in recent years traveset et al 2017 the proportion of secondary or higher order species losses after a primary extinction event i e extinctions following other extinction events is a conventional way of assessing the fragility of ecological networks eklöf and ebenman 2006 curtsdotter et al 2011 landi et al 2018 one key problem involved in such an approach is how to estimate the susceptibility to extinction for the other species as a result of a primary extinction the first solution to this problem came from the topological coextinction model tcm see dunne et al 2002 memmott et al 2004 which is based on a binary 0 or 1 extinction probability in a simple algorithm the tcm removes species from networks and checks how many of its partners would be left with no remaining interactions it assumes that the coextinction of a given species will occur only when it has no link with any remaining species for the sake of simplicity the tcm also ignores differences in interaction strength as well as differences in species specific dependence memmott et al 2004 vázquez et al 2005 in particular this model revealed that more species were likely to suffer secondary extinctions in weakly connected networks due to the higher probability of a species losing all of its partners dunne et al 2002 memmott et al 2004 vieira and almeida neto 2015 however the dependence of each species on each particular interaction seems intuitively fundamental to estimate the probability of persistence when modelling coextinctions recently the stochastic coextinction model scm was developed to account for additional factors that are expected to affect the probability of coextinction vieira and almeida neto 2015 in contrast to the tcm the coextinction probabilities under the scm range from 0 to 1 and are calculated independently for each species the coextinction probabilities are based on the interaction strength with the primarily extinct species and on the intrinsic demographic dependence on the service provided by the interaction for instance the probability of a plant species going extinct after the extinction of a given pollinator depends on how frequent the visits of such pollinator are in relation to all others and how this plant species is able to produce viable seeds through selfing or apomixis this model is more flexible because it relaxes the assumption that coextinctions are restricted to the loss of all partners i e species may become extinct even with still living partners primarily this means that the scm may result in more complex extinction cascades i e coextinctions following coextinctions or horizontal extinctions sanders et al 2013 interestingly more extinctions were observed in highly connected networks due to the higher number of species that were prone to coextinction following a primary extinction vieira and almeida neto 2015 however extracting empirical information about the intrinsic demographic dependence of each species on each interaction is challenging and this limits the applications of the scm these topological and stochastic models along with extensions to include populations and interaction dynamics trophic cascade effects alternative sequences of extinctions and perturbations have been extensively used to model extinction cascades representing complementary theoretical advances eklöf and ebenman 2006 curtsdotter et al 2011 brodie et al 2014 fricke et al 2017 traveset et al 2017 although the scm represents a clear improvement over the simplistic assumptions of the tcm both models i only implicitly account for compensating interactions and ii do not account for new interactions compensation mediated persistence occurs when individuals reallocate their interactions towards the remaining partners offsetting the negative demographic effects of losing one or more partners carvalheiro et al 2008 brodie et al 2014 under the tcm species are able to compensate for the loss of any partner regardless of its importance whenever it has at least one remaining partner for this reason no biological or population level constraints are imposed and compensation efforts are virtually equivalent complementarily the scm assumes that compensation is directly related to the dependence on extinct partners a species low probability of coextinction is interpreted as having a high potential to compensate for the loss by interacting more frequently with the remaining partners vieira and almeida neto 2015 quantifying compensation explicitly is a challenging task because many species specific aspects of ecological networks are not directly measurable even more difficult is to quantify the probability of new interactions because of many biological and ecological constraints regarding morphology and physiological adaptations accessibility and population dynamics thierry et al 2011 brodie et al 2014 in an attempt to introduce more realism to extinction simulations we developed a coextinction model that directly incorporates compensation mediated persistence and the formation of new interactions while retaining the relative simplicity of existing coextinction models our dependent random search coextinction model dcm preserves the stochastic properties of the scm and incorporates deterministic processes based on species dissimilarities and interactions strength see methods for definitions the main novelty of our model is that it relates the susceptibility to extinction and the selection of new partners directly with how similar the remaining species are to the lost partner this is done by incorporating the resemblances among species which can represent a variety of biological ecological and evolutionary aspects that fit in a species species dissimilarity matrix intuitively we may expect that the probability of coextinction will decrease as long as the existing or potential partners resemble e g morphologically functionally or phylogenetically the extinct one for example in a given community if a pollinator interacts with a plant that has a unique flower type and color this ecological dissimilarity from the other plants suggest that the chance for compensation or new interactions is unlikely for this pollinator although we used mutualistic networks to exemplify the new coextinction model is perfectly applicable to other types of ecological and non ecological networks e g food webs host parasite and species habitat networks finally to explore the behavior of the dcm and compare it with those for the scm and tcm we evaluated the extent to which patterns of coextinctions under the three models are related to connectance and nestedness two network properties that have been shown to influence robustness against coextinctions 2 materials and methods 2 1 the model we developed a coextinction model for ecological networks based on the key assumption that species may persist through two non exclusive mechanisms 1 compensation for lost interactions by intensifying the interactions with the current partners and 2 the establishment of new interactions with the remaining species the model is suitable for any kind of bipartite network formed by two sets a and b in which every element in a interacts with one or more elements in b and vice versa and could eventually deal with networks that are often unipartite e g food webs but requires particular adjustments regarding extinctions and probability calculations the inputs of the model requires a species by species ith by jth interaction matrix the species specific intrinsic demographic dependences for each species r i and the dissimilarities among species which are optional but are the core development of the model if initially provided the model which has its routine illustrated in fig 1 starts with a random extinction of a single species j from for example level a we defined s i j d i j r i d i s t j as the susceptibility of species i from level b to coextinction following the extinction of species j the dependence of i on j d i j is defined as the relative strength of the interaction between i and j i i j and is calculated by dividing the ij interaction by the sum of all interactions of i bascompte et al 2006 note that d i j and d j i may not be equivalent r i is a constant that depicts the intrinsic demographic dependence of species i on the interaction in question finally d i s t j is defined as the average distance dissimilarity between species j and all other species in its group this measure may represent a variety of resemblances i e relatedness between species within a group in regard to certain ecological evolutionary behavioral and or phylogenetic components legendre and legendre 2012 if we consider phylogenetic dissimilarities for example the more phylogenetically closer a new plant partner is to the extinct one the greater the probability of persistence of the pollinator assuming that the phylogenetic signal is strong enough to result in a similar phenotype the same can be expected if functional dissimilarities are considered for simplicity we used the bray curtis dissimilarities among species within each group as calculated from an interaction matrix based on the pairwise dissimilarities for both rows and columns this is a quantitative dissimilarity index widely used in ecology but the model can be easily adapted to deal with any other index for mathematical purposes when dissimilarities are not initially provided the calculated values belong to the interval between 0 and 1 if provided the dissimilarities are standardized to this interval independently if d i s t j is high then species j is very dissimilar to other species in that group in terms of shared partners ecologically this implies in a low probability of finding another related partner j such that i may compensate for the extinction of j or establish a new interaction if species i is likely to become extinct following a bernoulli trial with the susceptibility to coextinction s i j i e species i is likely to become coextinct if s i j is greater than a random value between 0 and 1 sampled from a uniform distribution the model will deal with this in one of two ways fig 1 first if species i is susceptible to coextinction and interacts only with j the persistence of i will be contingent upon new interaction s with another partner s at this step a parameter defined as an extinction threshold e t will modulate the persistence of i based on s i j this parameter represents a threshold for the coextinction probability in which species will persist if e t s i j and was implemented to prevent the model from indiscriminately creating new interactions and therefore allowing every potentially isolated species to persist thus if species i is able to establish new interactions it is defined as persistent and proceeds to partner s selection the selection of the new partner s follows three rules first the model respects the original degree of each species i e the number of interaction links jordano et al 2003 for example the maximum number of links for a species that seeks new interactions i e the maximum number of new interactions allowed for species i is restricted to its original degree n before a primary extinction event in addition the maximum number of links for species that receive new interactions i e the maximum number of interactions for species j is limited to n 1 this criterion considers the observed structure of each empirical interaction network assuming that it portrays the result of the species evolutionary history and demographic constraints bascompte et al 2006 besides it prevents the model from creating an overestimated robustness during the simulations second the selection of new partners considers the similarities between the extinct partner and all remaining species in other words the model is likely to select new partners that are more similar to the extinct ones as is expected in natural networks this is achieved by using the similarities between each species pair jj given by 1 d i s t j j as probabilities during the selection of each new partner from j s group third each new interaction between i and the new partner j is created as n i j i i j 1 d i s t j j where the strength of the new interaction n i j will be proportional to the lost interaction i i j and decreased by the distance between the extinct partner j and the new partner j d i s t j j ecologically our model assumes that species whose interactions were preferentially established with the extinct partner i e high i i j will invest more in making new interactions representing the species struggle to persist most importantly the model will consider that species will be able to establish stronger interactions with new partners that are more similar to the ones that were extinct assuming the underlying role of co evolution and ecological affinity it should be noted that new interactions will never exceed the strength of lost interactions but can eventually become stronger than existing interactions complementarily if species i is susceptible to coextinction but also interacts with other species compensation mediated persistence may occur at this stage a bernoulli trial may result in coextinction to conserve the stochastic properties in the model and also to depict slow inertia in species adaptation towards existing or new partners if persistence is confirmed the existing interactions between i and all other partners in j s group j will be enhanced so that the strength of each compensated interaction is given by c i j i i j 1 d i j where i i j is the previous strength of the interaction between i and j and d i j is the dependence of i on its extinct partner j ecologically this means that species with a higher dependence on extinct partners will exhibit increased compensation mediated persistence assuming that there are no population level constraints i e individuals of species j can actually receive or interact with more individuals of i at this step the model also considers the possibility for a new interaction for each species in addition to the compensation mediated persistence the probability of making a new interaction is calculated for each i species as p i g i d i j where g i is the normalized degree of species i i e number of realized interactions number of possible interactions which is a measure of the generalization of i simply put generalist species would have greater opportunities of making new interactions even if they still have living partners as we may expect in ecological systems only one new interaction is allowed at this stage to avoid artificial robustness during simulations finally the definition of the selected partner will depend on the d i s t j j as described above in sum simulations start by removing a single species from a level e g level a and then calculating the susceptibility to coextinction for every species in the other level e g level b if one or more species from level b is prone to coextinction the model simulates new interactions if the species was only interacting with the extinct partner and or compensation mediated persistence if the species has remaining partners finally if one or more species is coextinct in level b the susceptibility to coextinction is calculated back for all species in level a and the same steps are repeated whenever co extinctions in one level results in coextinctions in the other level the degree of extinction cascade increases i e extinctions without coextinctions are considered degree one coextinctions following extinctions are degree two and coextinctions following coextinctions are considered as degree three or higher the interaction matrix is updated i e to include vanished compensated and new interactions and dependences are recalculated equilibrium is reached when no additional coextinctions occur in our model no species can survive without interactions and species undergo coextinction after the loss of a partner through the following mechanisms i stochastic coextinctions of species that interacted with additional partners before possible compensation and ii deterministic coextinctions of species that only interacted with the extinct partner and display a high probability of coextinction the implementation of ii implies that the model will not force every species that was left without partners to establish new interactions and thus persist this conservative theoretical decision aimed to indirectly prevent the model from indiscriminately creating interactions during the simulations on the other hand the model restricts species to the formation of a single new interaction in the case of those presenting one or more non extinct partners assuming that a given species has less cost to adapt interactions with its current partners rather than establishing new interactions this condition was important to avoid creating a new network at each simulation step which would stray far from a realistic situation moreover our model incorporates deterministic properties by considering the strength of existing interactions and the resemblances among species for the susceptibility to extinction and the selection of new partners because new interactions are assigned in our model through a random search procedure that considers the similarities among species we named it the dependent random search coextinction model dcm the full model algorithm is summarized in fig 1 2 2 simulations with empirical data model performance was evaluated using data from 30 quantitative mutualistic networks 17 pollinator plant and 13 seed dispersal networks we obtained data from rezende et al 2007 and dormann et al 2008 see appendix 1 each simulation was a single extinction cascade in which one species was removed at random and the following coextinctions were tracked initial values for d i j were calculated from the original interaction matrices and updated during the cascades the values for r i were uniformly sampled for each simulated cascade from three intervals representing low 0 r i 0 3 intermediate 0 3 r i 0 6 and high 0 6 r i 1 intrinsic demographic dependence on interactions to evaluate how the parameter e t may affect the model performance we simulated cascades using three levels 0 25 0 5 and 0 75 the degree of extinction cascades increased every time the cascade produced another round of coextinctions in the other level furthermore we recorded the overall number of extinctions in each cascade by counting the species that became extinct for each network we performed 1000 simulations to estimate the frequency distribution of cascade degree and the number of extinctions based on this distribution we calculated the probability of a primary extinction resulting in an extinction cascade by counting all cascades that produced degrees 1 and dividing by the number of simulations to investigate the overall trends between network properties connectance and nestedness and the extinction cascades observed in our model we used spearman s rank correlations to correlate these two network properties with the probability of extinction cascades and the number of extinctions we calculate connectance as proportion of possible interactions that were realized to calculate the degree of nestedness we used the nodf index almeida neto et al 2008 to check for model coherence we also correlated these metrics with the mean values for the number of compensated interactions as well as the number of new interactions we also compared the performance of our model with additional extinction simulations using the scm and the tcm all procedures including model implementation evaluation and data analysis were performed in the r programming environment r development core team 2018 the main code and auxiliary functions are available at a github repository https github com mtbaumgartner dcm connectance and nestedness were calculated using the bipartite package dormann et al 2009 3 results 3 1 model performance the frequency distribution of extinction cascades differed depending on the coextinction model as exemplified in fig 2 all models presented higher frequencies of one degree cascades representing single extinctions that did not result in coextinctions as expected the dcm and scm had longer extinction cascades than the tcm which by constraint cannot produce third or higher degree cascades which made the frequency of one degree cascades the highest for this last model the frequency of extinction cascades decreased consistently for both the dcm and scm with an increasing degree of extinction cascade however the maximum values of cascade degrees were generally lower for the dcm than for the scm in the example from fig 2 the maximum degree was five for the dcm and nine for the scm meaning that primary extinctions led to shorter cascades in simulations under the dcm in the dcm connectance had a negative effect on the probability of extinction cascades fig 3 a as expected secondary extinctions were more likely in highly connected networks under the scm fig 3b while the opposite was observed under the tcm fig 3c furthermore nestedness increased the probability of extinction cascades under both the dcm and scm fig 3d e with no clear effect observed under the tcm fig 3f similarly the overall number of extinctions displayed a significant negative relationship with connectance under both the dcm fig 3g and the tcm fig 3h highly nested networks displayed fewer extinctions under the dcm fig 3j and the tcm fig 3k with no effect observed under the scm fig 3l 3 2 network metrics vs model parameters the overall effects of connectance and nestedness on both the degree of extinction cascades and the overall number of extinctions were observed across the considered levels of the model parameters r i and e t fig 4 these effects emerged as both model parameters increased especially r i in accordance with the evidence above under alternative combinations of model parameters the probability that a primary extinction will result in extinction cascades decreased with connectance and increased with nestedness fig 4a c conversely the total number of extinctions decrease with both connectance and nestedness fig 4d f remarkably there was a clear trend of an increasing effect of network metrics on community robustness as the intrinsic demographic dependence on the interaction r i increases particularly for nestedness fig 4a c however an exception is noted in networks with low r i in this scenario species are less likely to exhibit secondary extinctions even if dependence on lost interactions d i j and average distance to potential partners d i s t j are high which diminishes the potential effects of the network metrics on the consequences of primary extinctions this illustrates that both parameters affect the model performance due to their influence on the relationship between network structure and species coextinctions comparatively the effect of parameter e t appears more discrete than the effect of r i overall in practice we recommend setting e t to 0 5 as a conservative condition when using the dcm which may prevent user driven bias during model simulations in evaluating the relationships between network metrics and model outputs fig 5 no relationship was observed between connectance or nestedness and the number of compensated interactions fig 5e f however connectance and nestedness presented a positive effect on the number of new interactions with a particular hump shaped increase fig 5a b the probability of new interactions increased with connectance because the species are not allowed to increase their degree i e number of partners during the coextinction events in highly nested networks the similarities in terms of shared partners increases the chance of finding a more profitable new partner the number of compensated interactions was highly correlated with the total number of extinctions fig 5g assuming from an ecological perspective that the higher the number of partners that are extinct the more willing the remaining species will be to compensate interactions our model performed precisely as expected 4 discussion we introduced a novel approach to modelling species coextinctions the dcm which incorporates compensation mediated persistence and new interactions into coextinction simulations in ecological networks the dcm combines several characteristics of existing coextinction models and its retrieved statistics revealed that the artificial dynamics of the interactions are performing adequately under certain ecological assumptions regarding the struggle of species for persistence using mutualistic networks as templates we found that the probability of extinction cascades decrease with connectance and increase with nestedness while the overall number of extinctions decreases with increasing levels of both network properties we also found that the extinction cascades were shorter than those under the scm the fact that our model showed that the number of secondary extinctions decreases in more connected networks follows the view that robustness increases with connectance dunne et al 2002 eklöf and ebenman 2006 thébault and fontaine 2010 however we also evidenced that differences in interaction strategy i e dependence rather than network structure e g connectance and nestedness primarily accounts for stability in ecological networks see fricke et al 2017 the dcm accounted for intrinsic dependencies on each particular interaction an important piece of biological and ecological information vieira and almeida neto 2015 traveset et al 2017 our model also accounted for the similarities between the remaining species and the lost partners which we believe is a more straightforward approach than those of previous models in our model the probability of secondary extinctions increases with nestedness but the total number of extinctions was lower in highly nested networks these findings suggest an underlying mechanism relating nestedness and community robustness considering the tradeoff between the increased probability of extinction cascade and the lower total number of extinctions nestedness is a common pattern in ecological networks bascompte et al 2003 nielsen and bascompte 2007 ulrich and almeida neto 2012 and species that contribute most to nestedness have also been shown to contribute the most to community robustness nested patterns also arise from simulations that consider interaction switch i e when species change their partners through time in a cost effective way starting from random interactions zhang et al 2011 nuwagaba et al 2017 it has also been highlighted that interactions in ecological networks dynamically change over time kaiser bunbury et al 2010 blonder et al 2012 schleuning et al 2016 moreover evolutionary adaptation and increased phenotypic plasticity are mechanisms that can also prevent species coextinctions through new interactions brodie et al 2014 caradonna et al 2017 hui et al 2018 although our model does not account for any other cause for interaction shifts besides extinctions the fact that species can compensate for extinctions and establish new interactions when facing potential coextinction is crucial in approaching the complexity of real world networks while preserving model simplicity in practice more complex models have limited use because more biological information is required to define the model parameters which is the main reason we developed the dcm within the narrowest simplicity in addition the fact that more compensated interactions arise in networks under high extinction levels suggests that our model actually represents the willing of networks to avoid collapse and sustain its structure the formation of new interactions i e species rewiring or switching in networks has already been considered in previous extinction simulations schleuning et al 2016 caradonna et al 2017 nnakenyi et al 2019 furthermore rewiring can increase the network robustness against species loss and disturbances ramos jiliberto et al 2012 nuwagaba et al 2017 the dcm constitutes an important step towards more realistic coextinction models i e in terms of recreating more realistic networks than former approaches for three main reasons first the strength of compensated interactions is directly related to species dependence on lost partners the dcm builds on the approach of vieira and almeida neto 2015 and improves it by directly modifying the interaction matrices and dependencies updating the interaction strengths among species second the selection of new partners follows the intuition that species extinction risk is inversely related to population abundances and the availability of potential partners i e mutualists resource that are more similar to the lost ones third our model also extends upon the approach of schleuning et al 2016 in regard to the formation of new interactions changes in the biotic interaction structure have been considered key aspects of the maintenance of network structure and functioning nnakenyi et al 2019 in addition the adaptive interaction switching behavior seems to be the dynamics underlying empirical ecological networks nuwagaba et al 2017 while the dcm allows species to interact with new partners it is also respectful to the original number of interactions of each species in the network the number of newly made interactions between species likely to go coextinct and those that are hosting new interaction are constrained by the original degree of species for this reason the criteria for rewiring in the dcm are quite concrete in their ecological constraints which improves over other highly unrestrictive coextinction models e g nuwagaba et al 2017 thus representing an important contribution for assessing robustness in ecological communities of course as a simulation model it is still a simplification of real world systems and conclusions might be context dependent and must still be carefully evaluated although correlations between the probability of extinction cascades and the number of extinctions in the dcm were similar to those in the topological coextinction model tcm there are a few important differences see table 1 the dcm predicts longer extinction cascades while the tcm is not able to do so the tcm consists of only two steps select one random species to go extinct and then count those partners that no longer establish interactions this process systematically ignores the probability of coextinction when species are still connected to non extinct partners memmott et al 2004 which underestimates the overall number of extinctions in a network conversely both the dcm and scm do not truncate the degree of extinction cascade or the number of extinctions which is why we believe that these models are conceptually closer to real ecological communities vieira and almeida neto 2015 we also found that extinction cascades were shorter in our model than in the scm this can be attributed to its compensation mediated persistence and the ability to establish new interactions because the ability to either switch interactions or establish new ones increases the robustness against species extinctions in mutualistic networks ramos jiliberto et al 2012 we believe that our model the dcm is a more realistic representation of ecological networks specifically those characterized by less constrained and less specialized interactions when the establishment of new interactions is highly constrained by coevolved adaptations e g figs and fig wasps plants and galling insects then it is less likely that coextinctions will be significantly reduced by a species ability to switch and establish new interactions the dcm is proposed herein as a tool for many applications in ecology because of its flexibility to work depending on which resemblances are provided to widen the use of our model we suggest constructing hypotheses based on the different types of species dissimilarities for example one can identify keystone species in a community and investigate how its functional traits relate to community robustness simply by manipulating which traits are used to compute functional dissimilarity matrices alternatively the dcm can be used in antagonistic networks such as traditional food webs and host parasite networks in such case if a prey species goes extinct the remaining consumer s may be able to compensate by consuming more on another prey species or by consuming on a new species however if a consumer goes extinct its prey species and their interactions with other consumers will be preserved this is achieved by setting all dissimilarities among consumers to zero although this is a straightforward approach we should also note that it neglects population level dynamics in conclusion our model allows one to extend the simulations of coextinction cascades in ecological networks by considering the possibility of species reducing the negative effects of losing a partner by increasing its interactions with existing partners or establishing new interactions with other species we believe that this approach models cascades more accurately than previous coextinction models that neglect the possibilities of compensation by new or existing interactions furthermore the dcm expands previous modelling toolkit and allow ecologists to assess ecosystem vulnerability and to identify keystone species via its flexibility in incorporating specific hypothesis driven approaches finally we believe the next step in the development of coextinction models would be to incorporate a dynamic structure in which species can switch their interaction partners according to resource availability and increased fitness derived from this switching author contributions m t b and m a n conceived the model and designed the study m t b collected the data implemented the code and performed the analyses m t b wrote the first draft m a n and l c g contributed fundamentally to the drafts all authors gave final approval for publication software and data availability there are three online supporting files for this article the first two are excel files xlsx with the networks used and the correlations respectively that are available along with the online version the third is the source code and auxiliary functions in r language for the model that are stored in a github repository declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we are grateful to luisa carvalheiro and marcos costa vieira for their constructive suggestions on an early version of this manuscript as well as to two anonymous reviewers for their fruitful contributions mtb would like to thank the scholarship provided by the coordenação de aperfeiçoamento de pessoal de nível superior capes process 88882 344449 2019 01 man received funding from conselho nacional de desenvolvimento científico e tecnológico cnpq grant 310461 2015 4 appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2019 108876 appendix a supplementary data the following are supplementary data to this article 
24923,anthropogenic activities have significantly increased the movement of nitrogen n from land to freshwaters and to coastal waters and have led to severe environmental consequences the flow of n is moderated by retention processes in terrestrial freshwater and marine ecosystems freshwater ecosystems have the highest areal n retention rates the proportion of n retained in aquatic ecosystems depends on the areal hydraulic load and is described by relatively simple semi empirical or strictly empirical models here i compared the predictive power of several models that predict the annual mean proportion of total n tn and dissolved inorganic n din retained in lakes and reservoirs and developed an improved version of the models currently in use by inclusion of additional relevant parameters the study shows that models derived from mass balances describing the proportion of annual mean retention of tn and din as a sigmoid function of the areal hydraulic load can be approximated by a linear function on the logarithm of the areal hydraulic load stepwise multiple linear regression analyses identified the logarithm of the areal hydraulic load as the main explanatory variable for the proportion of retained tn followed by the ratio between the din and the tn load and the ratio between in lake concentrations of tn and total phosphorus tp the logarithm of the areal hydraulic load the ratio between the din and the tn load and the logarithm of the in lake concentration of tp explained the largest proportion of retained din addition of the second and third explanatory variable decreased the normalized root mean square deviation between the observed and predicted proportion of retained tn from 37 to 31 and to 30 and between the observed and predicted proportion of retained din from 39 to 35 and to 32 keywords empirical model mass balance nitrogen retention lakes reservoirs multiple linear regression 1 introduction the global cycling of nitrogen n has almost doubled over the last century due to the large increase of anthropogenic n fixation through production of fertilizers cultivation of legume crops and combustion of fossil fuels galloway et al 2004 almost all n originating from land based sources is retained from the three main ecosystem types terrestrial soils 40 freshwater groundwater lakes and reservoirs rivers 35 and marine estuaries continental shelves oxygen minimum zones 25 with rates per unit area in rivers lakes that are up to 10 times higher than in soils seitzinger et al 2006 understanding and quantifying n retention processes is extremely important for managing and mitigating the severe environmental consequences associated with n pollution boyer et al 2006 the main n retention processes are microbial mediated emissions of n2 gas permanent storage in soils and sediments and uptake by primary producers in aquatic ecosystems uptake of n by macrophytes and algae is usually only temporary as most nutrients assimilated during the growing phase are mineralized and released again in autumn clarke 2002 the primary permanent n retention mechanism in aquatic systems is generally denitrification nixon et al 1996 saunders and kalff 2001a seitzinger 1988 although more recently anaerobic ammonium oxidation anammox has been reported to contribute significantly to n retention lu et al 2018 denitrification occurs at oxic anoxic interfaces in aquatic systems these are located in the anaerobic layer of the sediments in the suboxic bottom waters seitzinger et al 2006 and in biofilms of submerged macrophytes or other substrates weisner et al 1994 nitrate can be supplied either from the overlaying water or produced in the sediment by nitrification of ammonium coupled nitrification denitrification the first pathway may prevail in waters with a high external input of nitrate the second when water column nitrate becomes limiting de klein 2008 measurements of denitrification rates in lakes show that nitrate concentration in the water above the sediment is the most important factor for predicting denitrification at variable geographical scales mccrackin and elser 2012 rissanen et al 2013 but dependence on temperature ahlgren et al 1994 saunders and kalff 2001b veraart et al 2011 and organic matter saunders and kalff 2001b have also been reported because of the complexity of the n cycle before n is finally retained from the aquatic ecosystem it can undergo numerous reactions assimilation mineralization nitrification dissimilatory nitrate reduction to ammonium that depend on a variety of environmental parameters such as concentrations of n p carbon c and oxygen hydrology morphology and temperature n occurs in different forms and oxidation states nitrate ammonium nitrite nitrous oxide dinitrogen organic nitrogen given this complexity it is surprizing how well relatively simple empirical models are able to predict the proportion of tn retained in aquatic ecosystems rtn most such models have been derived from n input output budgets kelly et al 1987 alexander et al 2002 basically two main approaches for modelling rtn have been applied models that predict directly rtn alexander et al 2002 jensen et al 1990 molot and dillon 1993 and models that are based on the assumption that most n is retained on account of the imported nitrate and estimate rt n indirectly from models that predict the proportion of retained dissolved inorganic nitrogen rdin hindar et al 2001 seitzinger et al 2002 both rtn and rdin correlate positively with the water residence time τ and negatively with the mean depth of the water column z molot and dillon 1993 τ and z affect the duration and the extent of the contact between the water column and the sediment surface influencing the n uptake by the sediment coppens et al 2015 some of these relations have been used to make predictions of n retention rates at regional and global scales alexander et al 2002 beusen et al 2016 harrison et al 2009 seitzinger et al 2010 wollheim et al 2008 several studies suggested that parameters other than τ and z may significantly influence the proportion of n retained in lakes in lake concentration of p berge et al 1997 coppens et al 2015 kaste and lyche solheim 2005 and nitrate mulholland et al 2008 the tn tp ratio guildford and hecky 2000 temperature coppens et al 2015 rissanen et al 2013 the presence of organic matter and the quality of the n loads i e less easily recyclable inorganic n rissanen et al 2013 the aim of this study was to compare the predictive power of existing simple empirical annual mean tn and din retention models for lakes and reservoirs and to develop an improved version of the models currently in use by inclusion of other relevant parameters the purpose is to predict the amount of annual mean tn and din that is retained 2 material and methods 2 1 derivation and calibration of the models currently in use existing empirical n retention models can basically be divided into semi empirical and strictly empirical models semi empirical models are derived from n mass balance equations of lakes or river sections they are calibrated with measured environmental variables and they describe the proportion of retained n as a function of τ and z empirical models are a based on statistical relationships between rtn and τ z 2 1 1 semi empirical model according to the mass balance of a lake reservoir at steady state retention of tn tnret can be expressed as see fig 1 1 t n r e t t n i n t n o u t with tnin and tnout referring to the tn input and output respectively rtn corresponds to kelly et al 1987 2 r t n t n r e t t n i n 1 t n o u t t n i n 1 t n o u t t n r e t t n o u t assuming completely mixed conditions and considering n retention a first order reaction eq 2 can be rewritten as follows with volumetric units per unit area 3 r t n r t n l t n 1 q a c t n q t n c t n q a c t n 1 q q t n q q t n q t n q where rtn is the areal tn retention rate ltn the areal load q is the outflow discharge m3 yr 1 a the area of the lake reservoir m2 ctn the in lake concentration of tn mg n m 3 q q a is the water discharge height or areal hydraulic load and corresponds also to the ratio between z and τ qtn represents the biological activity in the form of the uptake velocity wollheim et al 2008 and is also called mass transfer coefficient kelly et al 1987 or apparent settling velocity alexander et al 2002 in addition to being proposed for modelling retention of tn molot and dillon 1993 eq 4 has also been used for predicting retention of din rdin kaste and dillon 2003 kelly et al 1987 molot and dillon 1993 4 r d i n r d i n l d i n q d i n q d i n q according to eq 3 and eq 4 for very low and very high q rtn and rdin approach 1 and 0 respectively a sigmoid dependence of rtn from q is also described by mathematically different functions first used to model retention of tn in rivers alexander et al 2002 wollheim et al 2008 and then adapted to lakes reservoirs alexander et al 2002 harrison et al 2009 these functions were derived from the solution of the differential equation that describes changes of ctn along a river assuming a first order reaction for tn retention steady state conditions and a completely mixed river section 5 r t n 1 exp q t n q and likewise for din 6 r d i n 1 exp q d i n q 2 1 2 strictly empirical models for not too small and not too high values of q eqs 3 6 can be approximated by a linear equation describing rtn and rdin as a function of log10 q fig 2 a and fig 2b respectively 7 r t n a 1 b 1 l o g 10 q 8 r d i n a 2 b 2 l o g 10 q power function regressions between rtn and q and between rdin and q were proposed by windolf et al 1996 and seitzinger et al 2006 respectively 9 r t n a 3 q b 3 10 r d i n a 4 q b 4 with a1 a2 a3 a4 and b1 b2 b3 b4 being the constants derived from the regressions 2 1 3 calibration eqs 3 5 and 9 describing rtn as a function of q were calibrated using annual mean rtn assessed from tn mass balances of 158 lakes and 20 reservoirs compiled from literature appendix n 1 178 while eqs 4 6 and 10 describing rdin as a function of q were calibrated using din input output data of 85 lakes and 10 reservoirs appendix n 141 235 lakes that are listed more than once represent different time periods mass balances made for periods shorter than one year were excluded tn and din input included transport from the surrounding watershed and atmospheric deposition directly to the surface of the lake reservoir n fixation can also contribute to the n budget for most published input output mass balances however n fixation was negligible or low 10 of the tn input budgets with significant n fixation 10 of the tn input were excluded from the analysis because estimates of n fixation could often not be indicated with sufficient precision we also excluded lakes reservoirs with very high q 1400 m yr 1 as these are more representative for river ecosystems for meromictic lakes z and q refer to the mixed lake volume appendix lakes n 39 153 156 199 models of eqs 3 6 were calibrated by minimizing the normalized root mean square deviation between observed and predicted values nrmsd while for the calibration of the models of eqs 9 10 the equations were first linearized and the calibration parameters determined by linear regression of log10 rtn and log10 rdin respectively on log10 q since eqs 7 and 8 are valid only for intermediate values of q only lakes and reservoirs with values of q higher than 1 m yr 1 and lower than 100 m yr 1 were considered 138 lakes and 16 reservoirs for eq 7 and 75 lakes and 9 reservoir for eq 8 the range of acceptable q was estimated visually from the data in fig 2 2 2 improvement of the models currently in use the linearity of the two strictly empirical models eqs 7 8 gives the opportunity to test the linear dependence of rtn and rdin on other possible explanatory variables in particular the possibility to improve the models was tested by performing stepwise multiple linear regression analyses between the response variable rtn and rdin and the explanatory variables log10 q in lake concentrations of tp ctp its logarithm log10 ctp the tn tp ratio tn tp the ratio between the din load and the tn load ldin ltn and absolute latitude lat as possible indicator of temperature as it has been reported that the efficiency of biotic uptake and denitrification declines with increasing nitrate concentration mulholland et al 2008 inlet concentrations of tn ctnin and din cdinin and their logarithm log10 ctnin and log10 cdinin were also tested as possible explanatory variables the testing of the improvement of eq 7 was performed in two steps because data for the additional explanatory variables were not available for all lakes reservoirs for most lakes reservoirs with tn input output budgets ctp tn tp ctnin and lat were available while cdinin and ldin ltn were often lacking the first step was to carry out stepwise multiple linear regressions not including ldin ltn and cdinin as explanatory variables and using data of a larger subgroup of lakes reservoirs 134 lakes 13 reservoirs the second step involved including ldin ltn and cdinin as additional explanatory variables using data from a smaller subgroup of lakes reservoirs 35 lakes 2 reservoirs similarly the possibility to improve eq 8 was tested with the explanatory variables ctp cdinin lat on a larger subgroup of lakes reservoirs 71 lakes and 2 reservoirs and the additional variables ctnin ldin ltn tn tp on a smaller subgroup 34 lakes and 1 reservoirs the multiple linear regression analyses were performed with the statistic software spss spss inc 2012 a stepping criteria of p 0 05 was considered the results were tested for normality homoscedasticity and the absence of multi collinearity 2 3 comparison of model performances to assess model performance the predicted rtn and rdin were compared with the measured values and intercept and slope of the linear regression line were compared also the nrmsd between predicted and observed values were calculated and compared piñeiro et al 2008 3 results as expected rtn and rdin increase with decreasing areal hydraulic load q fig 2 the calculated lake reservoir specific settling velocities qtn and qdin varied somewhat depending on the model used for their calculation in general qtn and qdin calculated with the semi empirical models derived from the mass balance of lake reservoirs eqs 3 and 4 were slightly higher than if calculated with the semi empirical models derived from the mass balance of rivers sections eqs 5 and 6 according to eqs 3 and 5 qtn ranged from 19 to 95 m yr 1 mean 10 5 m yr 1 and from 20 to 81 m yr 1 mean 7 7 m yr 1 respectively according to eqs 4 and 6 qdin ranged from 19 to 104 m yr 1 mean 15 2 m yr 1 and from 21 to 42 m yr 1 mean 7 7 m yr 1 respectively a two tail t test for the null hypothesis that the means of qtn of lakes and reservoirs are equal with the assumption of unequal variances could not be rejected indicating that mean qtn in lakes 9 5 m yr 1 for eq 3 and 6 8 m yr 1 for eq 5 and reservoirs 18 2 m yr 1 for eq 3 and 15 0 m yr 1 for eq 5 do not differ significantly p 0 11 for eq 3 p 0 07 for eq 5 qdin of lakes and reservoirs was almost identical 15 3 m yr 1 eq 4 and 14 4 m yr 1 eq 6 the model values of qtn and qdin obtained by minimizing the nrmsd between observed and predicted values were 5 9 and 3 9 m yr 1 for eqs 3 and eq 5 respectively qtn in table 1 and 10 8 m yr 1 and 6 9 m yr 1 for eqs 4 and 6 respectively qdin in table 2 differences in the predictive power of the semi empirical models derived from the mass balance of a lake reservoir eqs 3 and 4 and from the mass balance of a river section were minimal eqs 5 and 6 for both rtn and rdin however slightly better results were obtained with the models derived from the mass balance of lakes reservoirs this is shown by the fits of the rtn and rdin predicting models in fig 2 but also by comparing the parameters of the linear regression between the observed and the predicted values intercepts closer to zero slopes closer to 1 higher r2 and lower nrmsd table 3 and table 4 respectively among the strictly empirical models approximating the semi empirical models the linear relations between rtn rdin and log10 q eqs 7 and 8 respectively gave better results both approximations did not worsen the predictive power of the semi empirical models derived from the mass balance of lakes reservoirs the predictive power of eq 8 was similar to that of eq 4 while the predictive power of eq 7 was even better than that of eq 3 the first improvement of eq 7 resulting from the stepwise multiple linear regression analysis between rtn and log10 q ctp log10 ctp tn tp lat ctnin log10 ctnin identified log10 q as the most significant explanatory variable eq 11a in table 1 followed by log10 ctnin eq 11b in table 1 and tn tp eq 11c in table 1 the addition of log10 ctnin and tn tp to the model increased the adjusted r2 from 0 43 to 0 48 to 0 50 table 1 the improvement of the predictions of rtn is also shown by the increase of r2 of the linear regression between observed and modelled rtn from 0 48 to 0 51 to 0 52 and by the decrease of the its nrmsd from 44 to 43 to 42 table 3 the second improvement of eq 7 resulting from the stepwise multiple linear regression analysis between rtn and the same variables as before plus cdin log10 cdin and ldin ltn identified again log10 q as the most significant explanatory variable eq 12a in table 1 followed by ldin ltn eq 12b in table 1 and tn tp eq 12c in table 1 whereby the adjusted r2 increased from 0 50 to 0 64 to 0 67 and the r2 of the linear regression between observed and predicted rtn increased from 0 57 to 0 69 to 0 72 and its nrmsd decreased from 37 to 31 to 30 changes in the prediction of rtn by successive addition of the parameters log10 q ldin ltn and tn tp to the model are shown in fig 3 a1 a2 a3 the first improvement of eq 8 resulting from the stepwise multiple linear regression analysis between rdin and log10 q ctp log10 ctp lat cdinin log10 cdinin identified log10 q as the most significant explanatory variable eq 13a in table 2 followed by log10 cdinin eq 13b in table 2 the addition of log10 cdinin to the model increased the adjusted r2 from 0 56 to 0 71 table 2 the improvement of the predictions of rdin is also shown by the increase of r2 of the linear regression between observed and modelled rdin from 0 64 to 0 75 and by the decrease of the its nrmsd from 38 to 28 table 4 the same explanatory variables were identified when performing the stepwise multiple linear regression analysis on a smaller subgroup of lakes reservoirs and by including also ctnin log10 ctnin ldin ltn tn tp as possible explanatory variables eqs 14a and 14b in table 2 if log10 cdinin was excluded log10 ctnin was identified as an additional explanatory variable after log10 q eqs 15a and 15b in table 2 if log10 ctnin also was excluded the identified variables were ldin ltn followed by log10 ctp eqs 16a c in table 2 interestingly the adjusted r2 of the final models 14b 15b and 16c 0 73 0 70 0 69 respectively see table 2 did not differ greatly nor did the r2 of the linear regression between the observed and modelled rdin 0 70 0 69 0 72 respectively see table 4 and its nrmsd 33 37 32 respectively see table 4 on the contrary the last added model describing rdin as a linear function of log10 q ldin ltn and log10 ctp gave the best predictions changes in the prediction of rdin by successive addition of the parameters log10 q ldin ltn and log10 ctp to the model are shown in fig 3 b1 b2 b3 4 discussion the analysis in this paper has shown that the areal hydraulic load q is the key variable for the prediction of both rtn and rdin this indicates that rtn and rdin increase with increasing τ and with decreasing mean depth z longer τ increases the chance of nutrients to the be transformed in the water column and lower z increases the chance of nutrients to be transformed at the sediment surface where most denitrification the main n retention process occurs saunders and kalff 2001a seitzinger 1988 the study has also shown that although the semi empirical models describe quite well the dependence of rtn and rdin from q lake specific mass transfer coefficient qtn and qdin can vary greatly indicating that other explanatory variables than q must influence rtn and rdin mean qtn was comparable to other studies 6 2 m yr 1 for 75 lakes and reservoirs in the waitako river basin in new zealand alexander et al 2002 eq 5 8 3 m yr 1 for 16 shallow danish lakes windolf et al 1996 eq 3 8 9 m yr 1 for 115 lakes and reservoirs compiled from literature harrison et al 2009 eq 5 different to this study harrison et al 2009 found a significant difference between mean qtn of lakes and reservoirs 6 8 m yr 1 and 13 7 m yr 1 respectively calculated with eq 5 and ascribed it to the increased availability of highly labile organic matter in the reservoirs because of the flooding of previously terrestrial soils and ecosystems mean qdin was slightly higher than reported for 13 oligotrophic p limited canadian and norwegian lakes kaste and dillon 1993 2 8 m yr 1 eq 4 the latter values are recommended for the estimation of in lake retention of nitrogen in the calculation of the critical loads of acidity and their exceedances for lake ecosystems clrtap 2017 in the strictly empirical models linear regressions describing variations of rtn and rdin as a function of log10 q eqs 7 and 8 respectively gave significantly better predictions than the power function regressions describing variations of rtn and rdin as a function of q eqs 9 and 10 respectively eq 9 has been proposed as a tn retention model by windolf et al 1996 with the calibration constants a3 0 15 and b3 0 56 they calibrated the model with hypereutrophic danish shallow lakes rtn predicted with this model were on average 17 higher than when calculated with the power function in this study seitzinger et al 2002 derived calibration constants a4 0 88 and b4 0 37 for eq 10 very close to the values of this study they used data from about 20 oligotrophic and eutrophic lakes and about 10 rivers the study has also shown that the approximation of the semi empirical models eqs 3 6 by the strictly empirical linear models eqs 7 and 8 did not worsen predictions of rtn and rdin on the contrary predictions with the linear models seemed to be slightly better especially for rdin this result led to search for other possible significant explanatory variables related linearly to rtn and rdin for rtn the most important explanatory variable was as expected log10 q followed by ldin ltn and tn tp the variable ldin ltn was not as important as log10 q but substantially more relevant than tn tp the fact that the rtn increases with increasing ldin ltn indicates that the quality of n entering a lake or reservoir is important for the n retention mechanisms in most freshwaters nitrate and don are the main n species between the two nitrate is generally considered to be the most bioavailable form because assimilation of don by plants algae and microorganisms has been reported but it seems to become a key resource only in n limited oligo to mesotrophic estuaries or freshwaters durand et al 2011 saunders and kalff 2001a have shown that retention of tn occurs mainly by denitrification 80 85 followed by sedimentation 15 20 it is therefore not surprising that the supply of din to lakes and reservoirs greatly influences retention of tn directly by providing denitrifying organisms with nitrate and indirectly through uptake by primary producers transformation into biomass that can be permanently incorporated in the sediment or supply denitrifying bacteria with nitrate coupled nitrification denitrification or anammox bacteria with ammonia from mineralization of organic n the fact that in the absence of ldin ltn log10 ctnin was identified as explanatory variable is probably due to the positive relation between ldin ltn and ctnin in aquatic ecosystems at low n concentrations 1 mg l 1 in ultra oligotrophic systems don is the dominant species while at higher n concentrations nitrate becomes dominant durand et al 2011 ctnin may therefore have acted as a surrogate of ldin ltn the correlation between log10 ctnin and ldin ltn is 0 57 tn tp the third explanatory variable identified for predicting rtn can be seen as an indicator for the proportion of the imported n that can be potentially assimilated into biomass followed by net burial into the sediment coupled nitrification denitrification but also of the supply of organic material to denitrifying bacteria the slight negative relation found between rtn and tn tp may be the result of all these mechanisms higher tn tp infers a lower proportion of n that is transformed into biomass and indirectly contributes to retention of tn the variable tn tp is also an indicator for the availability of p relative to n and is often used to discriminate between n and p limitation using the criterion of kelly et al 2013 120 of the lakes reservoirs with tn input output mass balances and tn tp data were probably p limited tn tp 14 4 were n limited tn tp 3 5 and other 45 co limited by both n and p meaning that most lakes reservoirs of the dataset were at least temporarily p limited at these conditions we might expect ctp to be a significant indicator for primary productivity and to have a significant influence on tn retention in contrast to other studies berge et al 1997 finlay et al 2013 however ctp was not identified as a significant explanatory variable for prediction of rtn stepwise multiple linear regression analyses between rtn and the variables log10 q ctp log10 ctp tn tp lat and ctnin and log10 ctnin to lake reservoirs with tn tp values 14 did also not indicate that p concentration was relevant for prediction of rtn concentration of p log10 ctp was significant only if z ctnin and tn tp were excluded from the analyses and rtn was expressed as a function of log10 1 τ and log10 ctp p value 0 001 adjusted r2 0 30 the significance of the alternative model however was significantly lower this together with the high negative correlation between log10 z and log10 ctp 0 53 suggests that log10 ctp may in reality just act as a surrogate of log10 z this might explain why finlay et al 2013 indicated a positive dependence of rtn and rtn on ctp in the plots of rtn vs log10 1 τ and log10 rtn vs log10 ltn for the improvement of predictions of rdin stepwise multiple linear regression gave the most important explanatory variable as log10 q followed by log10 cdinin eq 13b excluding ctnin and cdinin from the analyses after log10 q ldin ltn and log10 ctp were identified as significant explanatory variables eq 16c and the predicted rdin s were closer to the measured smaller nrmsd again especially ctnin but also cdinin might here have acted as a surrogate of another parameter specifically since log10 ctnin correlates positively with ldin ltn pearson correlation 0 57 and log10 ctp pearson correlation 0 69 it might have acted as a surrogate for both variables this also explains why ctnin was identified as a better significant explanatory variable than either ldin ltn or log10 ctp alone to understand the reason for the significance of ldin ltn and log10 ctp for the prediction of rdin a closer look to what rdin represents is necessary rdin is positively influenced by net retention of din by denitrification or sedimentation and by transformation of din into ton and negatively by net retention of ton from the mass balance equations of tn din and ton it follows 17 r d i n r t n l d i n o t o n l t o n l d i n with lton and oton being the areal input and output of ton the equation indicates that the difference between rdin and rtn ldin corresponds to the areal net production of ton relative to ldin if oton lton 0 and to the areal net retention of ton relative to ldin if oton lton 0 the data in this study show that oton lton ldin increases linearly with increasing ldin ltn fig 4 a pearson correlation 0 69 and to a lesser extent with increasing log10 ctp fig 4b pearson correlation 0 41 the two additional explanatory variables next to log10 q to be identified for prediction of rdin eq 16c in other words from lakes with low values of ldin ltn with elevated percentages of ton in the inlets to lakes with high values of ldin ltn with elevated percentages of din in the inlets the areal input output ton mass balance changes from ton net retention to ton net production more precisely net production of ton is prevalent in lakes with ldin ltn 0 8 and since ldin ltn has been shown to correlate positively with log10 ctnin and log10 ctp at ctnin 3 mg l 1 and ctp 0 3 mg p 1 while net retention of ton is prevalent in lakes with ldin ltn 0 6 ctnin 2 mg l 1 ctp 0 05 mg p 1 and tn tp 50 for lakes with values in between both ton net retention or net production can occur several studies estimated rtn from models that predict rdin assuming that most n is retained on account of the imported din and that there is only minor net transformation of din into ton hindar et al 2001 mayorga et al 2010 under these assumptions eq 17 becomes 18 r d i n r t n l d i n and analogously 19 r t n r t n l t n r d i n l d i n l t n the comparison between measured rdin ltn and measured rtn is shown in fig 4c in the presence of a net retention of ton however rtn and ctn estimated from rdin are under and overestimated respectively the opposite occurs in the presence of a net production of ton in addition since it has been shown that the net production of ton is positively correlated with ldin ltn and as it is known that in aquatic ecosystems the ratio between the concentrations of din and tn is positively related to concentrations of tn at low ctnin 2 mg l 1 ctn estimated from rdin is somewhat overestimated and at high ctnin 3 mg l 1 somewhat underestimated estimation of rtn from modelled rdin requires an additional consideration from the comparison of eq 17 with eq 16c and the consideration of the linear relation between the second term of eq 17 oton lton ldin and ldin ltn and log10 ctp it can be derived that rtn ldin can be approximated by the first part of eq 16c a24 b24log10 q therefore measured rtn was compared with values estimated from eqs 4 and 8 that describe rdin as a function of q alone and have been shown to produce best predictions and their predictive power compared with that of eq 12c that describe rtn as a function of log10 q ldin ltn and tn tp table 3 the comparison could be made for 37 lakes and 2 reservoirs for which all necessary explanatory variables were known almost identical were predictions of rtn from eqs 4 and 8 intercept slope and r2 of the linear regression between observed and predicted values was 0 09 0 97 0 72 respectively and the nrmsd was 37 for eq 4 and 36 for eq 8 these values suggest just slightly worse predictions of rtn than obtained from eq 12c for which the values of the same parameters were 0 01 1 03 0 72 and 30 however the comparison of measured with predicted rtn obtained from rdin models also showed that rtn were underestimated on average by 8 shown for eq 4 in fig 4d the reason is that the lakes reservoirs used for calibrating the rdin models were probably not equally distributed regarding their ton net retention and net production the analyses of the subgroup of lakes reservoirs with available ton input output mass balance used for calibration of eq 4 showed that the number of lakes with a net retention of ton was higher than that with a net production of ton 25 vs 13 and also the absolute average value of oton lton ldin 0 21 vs 0 15 for the other lakes reservoirs used in the calibration of eq 4 the ton input output data were not available however as it was shown that ton net retention or net production depends also on ctp the analysis of the representativeness of the lakes regarding this parameter might give further information in the subgroup of lakes reservoirs with ton input output data 59 of the lakes reservoirs had ctp values 50 mg p l 1 probable indicator for the occurrence of a ton net retention 5 had ctp values 300 mg p l 1 probable indicator for the occurrence of a ton net production and the remaining 36 had values in between where both ton net production of retention can occur in the larger dataset used for the calibration 37 of the lakes reservoirs had ctp values 50 mg p l 1 3 had ctp values 300 mg p l 1 and 61 had values in between indicating that also in the larger group lakes reservoirs with net ton production were probably less represented as a consequence the calibration curve is more representative for lakes reservoirs with a ton net retention leading to an underestimation of rtn if the rdin models are used for its estimation an underestimation of rtn 13 on average was also obtained when it was estimated from rdin modelled with the empirical equation proposed by seitzinger et al 2002 thus rdin models should be used to predict only rdin and not rtn the same consideration holds when calibration of rdin is made only for oligotrophic p limited lakes as has been done by kaste and dillon 2003 the models are fine if used for prediction of rdin in oligotrophic p limited lakes but as at low ctp the relative to ldin areal retention of ton might be considerable predictions of rtn from rdin may lead to an underestimation for example using an average qdin of 5 m yr 1 proposed by hindar et al 2001 for estimating retention of din in oligotrophic p limited lakes rtn of a subgroup of 14 oligotrophic p limited lakes estimated from rdin using eq 4 is underestimated on average by 14 another suggestion for the use of the models presented in this study is to use the best model for which explanatory variables are available for the prediction of rtn the lowest deviations of the measured from the predicted values were given by eq 12c describing rtn as a function of log10 q ldin ltn and tn tp if tn tp is not known it can be neglected with not much loss of precision by the use of eq 12b if even ldin ltn is not known it can be substituted by log10 ctnin using eq 11b and if tn tp is available by eq 11c if only q is known then eq 9 is recommended because it has been calibrated with a larger dataset predictions of rdin should be approached in a similar way eq 16c that predicts rdin as a function of log10 q ldin ltn and log10 ctp gave the best results in the absence of log10 ctp log10 ctp can be neglected with not much loss of precision and 16b can be used instead if ldin ltn is not known it may be approximated by cdinin and the use of eq 13a and if q alone is known than eqs 4 or 8 should be used for prediction of rdin interestingly the variables ctnin and cdinin were initially introduced as explanatory variables in the expectation of a negative relation with rtn and rdin reflecting a decline in the efficiency of n retention at higher n concentrations mulholland et al 2008 both variables ended up to be positively related to rtn and rdin when other more relevant parameters were not available for the prediction of rtn log10 ctnin stood for ldin ltn and for the prediction of rdin log10 cdinin stood for both ldin ltn and log10 ctp in addition to the controlling factors identified in this study q ldin ltn tn tp ctp other parameters are likely to influence retention of tn and din temperature for the retention of both tn and din and the presence of organic carbon for tn may be relevant as well both parameters could not be investigated in this study because of the lack of data latitude was tested as a surrogate for temperature but was not a significant explanatory variable for rtn and rdin although not object of this study temperature has been shown to influence seasonality of rtn and rdin with generally higher values especially of rdin during summer kaste and lyche solheim 2005 windolf et al 1996 little has been reported about the influence of temperature on annual mean rtn and rdin of aquatic ecosystems temperature is generally known to enhance biogeochemical processes in natural aquatic systems schwoerbel 1987 as observed by veraart et al 2011 temperature may affect denitrification but also several biogeochemical reactions preceding denitrification such as mineralization and nitrification as an example microcosm experiments field measurements and a simple model approach suggested a doubling of denitrification rates by a temperature increase of three degrees in systems not n limited when denitrification of nitrate from the water column is the main mechanism because of the decrease of oxygen concentrations due to lower solubility and due to the steeper increase of respiration compared to photosynthesis veraart et al 2011 however in n limited systems characterized by an increase of the importance of nitrification denitrification as denitrifying mechanism the influence of temperature on mineralization and nitrification may be more relevant and an increase of temperature can theoretically both stimulate nitrification and inhibit nitrification because of lower oxygen concentrations veraart et al 2011 in addition with increasing temperatures primary productivity stimulates tn retention by supplying denitrifiers with organic carbon and contributing to net sedimentation but might also inhibit denitrification by competing for inorganic n cabrita and brotas 2000 all this indicates that the influence of temperature on n retention might be extremely complex and therefore not easily included in an empirical model as presented here also because other explanatory variables might be more relevant 5 conclusion in summary this study showed that empirical models derived from input output mass balances of tn and din describing annual mean rtn and rdin in lakes reservoirs as a sigmoid function of q can be approximated by a linear function on log10 q with little loss of information and can be significantly improved by focusing on the inorganic n load to the lakes nevertheless the relatively low values of the adjusted r2 of the models 0 5 0 7 suggests that the here presented models still deliver only estimates of the proportion of retained tn and din the reasons are various first not all assumptions the models are based on i e lakes at steady state completely mixed water column no n2 fixation first order reaction of the n retention mechanism may have been fulfilled by the n mass balances used for the calibration second the mass balances themselves might have been characterized by errors and uncertainties third the water bodies used for the calibrations varied in part enormously in their hydrologic morphologic hydrochemical and climatic characteristics that the here proposed empirical functions were not able to fully reflect it is clear that more complex mechanistic models are generally more accurate however these models tend to require extensive data that may be difficult to obtain wherefore they are rather used at local scale for large scale analyses the more general empirical models are preferred bouwman et al 2013 furthermore empirical n retention models are also used for the calculation of the critical loads of acidity and their exceedances for lake ecosystems clrtap 2017 that s why the here presented models are still useful tools to estimate tn and din retention in lakes and reservoirs moreover since the din load has been shown to influence tn retention the tn and din retention models can be combined to model multiple lakes in sequence in addition the accuracy of the presented empirical models might be improved further by repeating the analysis with subsets of lakes reservoirs that are more homogeneous it can also be attempted to further improve the models by including n2 fixation in the mass balance and expressing it as a function of the tn tp ratio of the external input as proposed by ruan 2014 or it can be tried to adapt the models to describe seasonality of n retention by including surface water temperature as proposed by windolf et al 1996 finally the models might also be calibrated with input output mass balance data from other types of aquatic ecosystems as well acknowledgments this research did not receive any specific grant from founding agencies in the public commercial or not for profit sector i m very grateful to dr richard wright for controlling and editing the english language and for his very useful suggestions also very precious were the comments of two anonymous reviewers appendix a calibration dataset table a1 
24923,anthropogenic activities have significantly increased the movement of nitrogen n from land to freshwaters and to coastal waters and have led to severe environmental consequences the flow of n is moderated by retention processes in terrestrial freshwater and marine ecosystems freshwater ecosystems have the highest areal n retention rates the proportion of n retained in aquatic ecosystems depends on the areal hydraulic load and is described by relatively simple semi empirical or strictly empirical models here i compared the predictive power of several models that predict the annual mean proportion of total n tn and dissolved inorganic n din retained in lakes and reservoirs and developed an improved version of the models currently in use by inclusion of additional relevant parameters the study shows that models derived from mass balances describing the proportion of annual mean retention of tn and din as a sigmoid function of the areal hydraulic load can be approximated by a linear function on the logarithm of the areal hydraulic load stepwise multiple linear regression analyses identified the logarithm of the areal hydraulic load as the main explanatory variable for the proportion of retained tn followed by the ratio between the din and the tn load and the ratio between in lake concentrations of tn and total phosphorus tp the logarithm of the areal hydraulic load the ratio between the din and the tn load and the logarithm of the in lake concentration of tp explained the largest proportion of retained din addition of the second and third explanatory variable decreased the normalized root mean square deviation between the observed and predicted proportion of retained tn from 37 to 31 and to 30 and between the observed and predicted proportion of retained din from 39 to 35 and to 32 keywords empirical model mass balance nitrogen retention lakes reservoirs multiple linear regression 1 introduction the global cycling of nitrogen n has almost doubled over the last century due to the large increase of anthropogenic n fixation through production of fertilizers cultivation of legume crops and combustion of fossil fuels galloway et al 2004 almost all n originating from land based sources is retained from the three main ecosystem types terrestrial soils 40 freshwater groundwater lakes and reservoirs rivers 35 and marine estuaries continental shelves oxygen minimum zones 25 with rates per unit area in rivers lakes that are up to 10 times higher than in soils seitzinger et al 2006 understanding and quantifying n retention processes is extremely important for managing and mitigating the severe environmental consequences associated with n pollution boyer et al 2006 the main n retention processes are microbial mediated emissions of n2 gas permanent storage in soils and sediments and uptake by primary producers in aquatic ecosystems uptake of n by macrophytes and algae is usually only temporary as most nutrients assimilated during the growing phase are mineralized and released again in autumn clarke 2002 the primary permanent n retention mechanism in aquatic systems is generally denitrification nixon et al 1996 saunders and kalff 2001a seitzinger 1988 although more recently anaerobic ammonium oxidation anammox has been reported to contribute significantly to n retention lu et al 2018 denitrification occurs at oxic anoxic interfaces in aquatic systems these are located in the anaerobic layer of the sediments in the suboxic bottom waters seitzinger et al 2006 and in biofilms of submerged macrophytes or other substrates weisner et al 1994 nitrate can be supplied either from the overlaying water or produced in the sediment by nitrification of ammonium coupled nitrification denitrification the first pathway may prevail in waters with a high external input of nitrate the second when water column nitrate becomes limiting de klein 2008 measurements of denitrification rates in lakes show that nitrate concentration in the water above the sediment is the most important factor for predicting denitrification at variable geographical scales mccrackin and elser 2012 rissanen et al 2013 but dependence on temperature ahlgren et al 1994 saunders and kalff 2001b veraart et al 2011 and organic matter saunders and kalff 2001b have also been reported because of the complexity of the n cycle before n is finally retained from the aquatic ecosystem it can undergo numerous reactions assimilation mineralization nitrification dissimilatory nitrate reduction to ammonium that depend on a variety of environmental parameters such as concentrations of n p carbon c and oxygen hydrology morphology and temperature n occurs in different forms and oxidation states nitrate ammonium nitrite nitrous oxide dinitrogen organic nitrogen given this complexity it is surprizing how well relatively simple empirical models are able to predict the proportion of tn retained in aquatic ecosystems rtn most such models have been derived from n input output budgets kelly et al 1987 alexander et al 2002 basically two main approaches for modelling rtn have been applied models that predict directly rtn alexander et al 2002 jensen et al 1990 molot and dillon 1993 and models that are based on the assumption that most n is retained on account of the imported nitrate and estimate rt n indirectly from models that predict the proportion of retained dissolved inorganic nitrogen rdin hindar et al 2001 seitzinger et al 2002 both rtn and rdin correlate positively with the water residence time τ and negatively with the mean depth of the water column z molot and dillon 1993 τ and z affect the duration and the extent of the contact between the water column and the sediment surface influencing the n uptake by the sediment coppens et al 2015 some of these relations have been used to make predictions of n retention rates at regional and global scales alexander et al 2002 beusen et al 2016 harrison et al 2009 seitzinger et al 2010 wollheim et al 2008 several studies suggested that parameters other than τ and z may significantly influence the proportion of n retained in lakes in lake concentration of p berge et al 1997 coppens et al 2015 kaste and lyche solheim 2005 and nitrate mulholland et al 2008 the tn tp ratio guildford and hecky 2000 temperature coppens et al 2015 rissanen et al 2013 the presence of organic matter and the quality of the n loads i e less easily recyclable inorganic n rissanen et al 2013 the aim of this study was to compare the predictive power of existing simple empirical annual mean tn and din retention models for lakes and reservoirs and to develop an improved version of the models currently in use by inclusion of other relevant parameters the purpose is to predict the amount of annual mean tn and din that is retained 2 material and methods 2 1 derivation and calibration of the models currently in use existing empirical n retention models can basically be divided into semi empirical and strictly empirical models semi empirical models are derived from n mass balance equations of lakes or river sections they are calibrated with measured environmental variables and they describe the proportion of retained n as a function of τ and z empirical models are a based on statistical relationships between rtn and τ z 2 1 1 semi empirical model according to the mass balance of a lake reservoir at steady state retention of tn tnret can be expressed as see fig 1 1 t n r e t t n i n t n o u t with tnin and tnout referring to the tn input and output respectively rtn corresponds to kelly et al 1987 2 r t n t n r e t t n i n 1 t n o u t t n i n 1 t n o u t t n r e t t n o u t assuming completely mixed conditions and considering n retention a first order reaction eq 2 can be rewritten as follows with volumetric units per unit area 3 r t n r t n l t n 1 q a c t n q t n c t n q a c t n 1 q q t n q q t n q t n q where rtn is the areal tn retention rate ltn the areal load q is the outflow discharge m3 yr 1 a the area of the lake reservoir m2 ctn the in lake concentration of tn mg n m 3 q q a is the water discharge height or areal hydraulic load and corresponds also to the ratio between z and τ qtn represents the biological activity in the form of the uptake velocity wollheim et al 2008 and is also called mass transfer coefficient kelly et al 1987 or apparent settling velocity alexander et al 2002 in addition to being proposed for modelling retention of tn molot and dillon 1993 eq 4 has also been used for predicting retention of din rdin kaste and dillon 2003 kelly et al 1987 molot and dillon 1993 4 r d i n r d i n l d i n q d i n q d i n q according to eq 3 and eq 4 for very low and very high q rtn and rdin approach 1 and 0 respectively a sigmoid dependence of rtn from q is also described by mathematically different functions first used to model retention of tn in rivers alexander et al 2002 wollheim et al 2008 and then adapted to lakes reservoirs alexander et al 2002 harrison et al 2009 these functions were derived from the solution of the differential equation that describes changes of ctn along a river assuming a first order reaction for tn retention steady state conditions and a completely mixed river section 5 r t n 1 exp q t n q and likewise for din 6 r d i n 1 exp q d i n q 2 1 2 strictly empirical models for not too small and not too high values of q eqs 3 6 can be approximated by a linear equation describing rtn and rdin as a function of log10 q fig 2 a and fig 2b respectively 7 r t n a 1 b 1 l o g 10 q 8 r d i n a 2 b 2 l o g 10 q power function regressions between rtn and q and between rdin and q were proposed by windolf et al 1996 and seitzinger et al 2006 respectively 9 r t n a 3 q b 3 10 r d i n a 4 q b 4 with a1 a2 a3 a4 and b1 b2 b3 b4 being the constants derived from the regressions 2 1 3 calibration eqs 3 5 and 9 describing rtn as a function of q were calibrated using annual mean rtn assessed from tn mass balances of 158 lakes and 20 reservoirs compiled from literature appendix n 1 178 while eqs 4 6 and 10 describing rdin as a function of q were calibrated using din input output data of 85 lakes and 10 reservoirs appendix n 141 235 lakes that are listed more than once represent different time periods mass balances made for periods shorter than one year were excluded tn and din input included transport from the surrounding watershed and atmospheric deposition directly to the surface of the lake reservoir n fixation can also contribute to the n budget for most published input output mass balances however n fixation was negligible or low 10 of the tn input budgets with significant n fixation 10 of the tn input were excluded from the analysis because estimates of n fixation could often not be indicated with sufficient precision we also excluded lakes reservoirs with very high q 1400 m yr 1 as these are more representative for river ecosystems for meromictic lakes z and q refer to the mixed lake volume appendix lakes n 39 153 156 199 models of eqs 3 6 were calibrated by minimizing the normalized root mean square deviation between observed and predicted values nrmsd while for the calibration of the models of eqs 9 10 the equations were first linearized and the calibration parameters determined by linear regression of log10 rtn and log10 rdin respectively on log10 q since eqs 7 and 8 are valid only for intermediate values of q only lakes and reservoirs with values of q higher than 1 m yr 1 and lower than 100 m yr 1 were considered 138 lakes and 16 reservoirs for eq 7 and 75 lakes and 9 reservoir for eq 8 the range of acceptable q was estimated visually from the data in fig 2 2 2 improvement of the models currently in use the linearity of the two strictly empirical models eqs 7 8 gives the opportunity to test the linear dependence of rtn and rdin on other possible explanatory variables in particular the possibility to improve the models was tested by performing stepwise multiple linear regression analyses between the response variable rtn and rdin and the explanatory variables log10 q in lake concentrations of tp ctp its logarithm log10 ctp the tn tp ratio tn tp the ratio between the din load and the tn load ldin ltn and absolute latitude lat as possible indicator of temperature as it has been reported that the efficiency of biotic uptake and denitrification declines with increasing nitrate concentration mulholland et al 2008 inlet concentrations of tn ctnin and din cdinin and their logarithm log10 ctnin and log10 cdinin were also tested as possible explanatory variables the testing of the improvement of eq 7 was performed in two steps because data for the additional explanatory variables were not available for all lakes reservoirs for most lakes reservoirs with tn input output budgets ctp tn tp ctnin and lat were available while cdinin and ldin ltn were often lacking the first step was to carry out stepwise multiple linear regressions not including ldin ltn and cdinin as explanatory variables and using data of a larger subgroup of lakes reservoirs 134 lakes 13 reservoirs the second step involved including ldin ltn and cdinin as additional explanatory variables using data from a smaller subgroup of lakes reservoirs 35 lakes 2 reservoirs similarly the possibility to improve eq 8 was tested with the explanatory variables ctp cdinin lat on a larger subgroup of lakes reservoirs 71 lakes and 2 reservoirs and the additional variables ctnin ldin ltn tn tp on a smaller subgroup 34 lakes and 1 reservoirs the multiple linear regression analyses were performed with the statistic software spss spss inc 2012 a stepping criteria of p 0 05 was considered the results were tested for normality homoscedasticity and the absence of multi collinearity 2 3 comparison of model performances to assess model performance the predicted rtn and rdin were compared with the measured values and intercept and slope of the linear regression line were compared also the nrmsd between predicted and observed values were calculated and compared piñeiro et al 2008 3 results as expected rtn and rdin increase with decreasing areal hydraulic load q fig 2 the calculated lake reservoir specific settling velocities qtn and qdin varied somewhat depending on the model used for their calculation in general qtn and qdin calculated with the semi empirical models derived from the mass balance of lake reservoirs eqs 3 and 4 were slightly higher than if calculated with the semi empirical models derived from the mass balance of rivers sections eqs 5 and 6 according to eqs 3 and 5 qtn ranged from 19 to 95 m yr 1 mean 10 5 m yr 1 and from 20 to 81 m yr 1 mean 7 7 m yr 1 respectively according to eqs 4 and 6 qdin ranged from 19 to 104 m yr 1 mean 15 2 m yr 1 and from 21 to 42 m yr 1 mean 7 7 m yr 1 respectively a two tail t test for the null hypothesis that the means of qtn of lakes and reservoirs are equal with the assumption of unequal variances could not be rejected indicating that mean qtn in lakes 9 5 m yr 1 for eq 3 and 6 8 m yr 1 for eq 5 and reservoirs 18 2 m yr 1 for eq 3 and 15 0 m yr 1 for eq 5 do not differ significantly p 0 11 for eq 3 p 0 07 for eq 5 qdin of lakes and reservoirs was almost identical 15 3 m yr 1 eq 4 and 14 4 m yr 1 eq 6 the model values of qtn and qdin obtained by minimizing the nrmsd between observed and predicted values were 5 9 and 3 9 m yr 1 for eqs 3 and eq 5 respectively qtn in table 1 and 10 8 m yr 1 and 6 9 m yr 1 for eqs 4 and 6 respectively qdin in table 2 differences in the predictive power of the semi empirical models derived from the mass balance of a lake reservoir eqs 3 and 4 and from the mass balance of a river section were minimal eqs 5 and 6 for both rtn and rdin however slightly better results were obtained with the models derived from the mass balance of lakes reservoirs this is shown by the fits of the rtn and rdin predicting models in fig 2 but also by comparing the parameters of the linear regression between the observed and the predicted values intercepts closer to zero slopes closer to 1 higher r2 and lower nrmsd table 3 and table 4 respectively among the strictly empirical models approximating the semi empirical models the linear relations between rtn rdin and log10 q eqs 7 and 8 respectively gave better results both approximations did not worsen the predictive power of the semi empirical models derived from the mass balance of lakes reservoirs the predictive power of eq 8 was similar to that of eq 4 while the predictive power of eq 7 was even better than that of eq 3 the first improvement of eq 7 resulting from the stepwise multiple linear regression analysis between rtn and log10 q ctp log10 ctp tn tp lat ctnin log10 ctnin identified log10 q as the most significant explanatory variable eq 11a in table 1 followed by log10 ctnin eq 11b in table 1 and tn tp eq 11c in table 1 the addition of log10 ctnin and tn tp to the model increased the adjusted r2 from 0 43 to 0 48 to 0 50 table 1 the improvement of the predictions of rtn is also shown by the increase of r2 of the linear regression between observed and modelled rtn from 0 48 to 0 51 to 0 52 and by the decrease of the its nrmsd from 44 to 43 to 42 table 3 the second improvement of eq 7 resulting from the stepwise multiple linear regression analysis between rtn and the same variables as before plus cdin log10 cdin and ldin ltn identified again log10 q as the most significant explanatory variable eq 12a in table 1 followed by ldin ltn eq 12b in table 1 and tn tp eq 12c in table 1 whereby the adjusted r2 increased from 0 50 to 0 64 to 0 67 and the r2 of the linear regression between observed and predicted rtn increased from 0 57 to 0 69 to 0 72 and its nrmsd decreased from 37 to 31 to 30 changes in the prediction of rtn by successive addition of the parameters log10 q ldin ltn and tn tp to the model are shown in fig 3 a1 a2 a3 the first improvement of eq 8 resulting from the stepwise multiple linear regression analysis between rdin and log10 q ctp log10 ctp lat cdinin log10 cdinin identified log10 q as the most significant explanatory variable eq 13a in table 2 followed by log10 cdinin eq 13b in table 2 the addition of log10 cdinin to the model increased the adjusted r2 from 0 56 to 0 71 table 2 the improvement of the predictions of rdin is also shown by the increase of r2 of the linear regression between observed and modelled rdin from 0 64 to 0 75 and by the decrease of the its nrmsd from 38 to 28 table 4 the same explanatory variables were identified when performing the stepwise multiple linear regression analysis on a smaller subgroup of lakes reservoirs and by including also ctnin log10 ctnin ldin ltn tn tp as possible explanatory variables eqs 14a and 14b in table 2 if log10 cdinin was excluded log10 ctnin was identified as an additional explanatory variable after log10 q eqs 15a and 15b in table 2 if log10 ctnin also was excluded the identified variables were ldin ltn followed by log10 ctp eqs 16a c in table 2 interestingly the adjusted r2 of the final models 14b 15b and 16c 0 73 0 70 0 69 respectively see table 2 did not differ greatly nor did the r2 of the linear regression between the observed and modelled rdin 0 70 0 69 0 72 respectively see table 4 and its nrmsd 33 37 32 respectively see table 4 on the contrary the last added model describing rdin as a linear function of log10 q ldin ltn and log10 ctp gave the best predictions changes in the prediction of rdin by successive addition of the parameters log10 q ldin ltn and log10 ctp to the model are shown in fig 3 b1 b2 b3 4 discussion the analysis in this paper has shown that the areal hydraulic load q is the key variable for the prediction of both rtn and rdin this indicates that rtn and rdin increase with increasing τ and with decreasing mean depth z longer τ increases the chance of nutrients to the be transformed in the water column and lower z increases the chance of nutrients to be transformed at the sediment surface where most denitrification the main n retention process occurs saunders and kalff 2001a seitzinger 1988 the study has also shown that although the semi empirical models describe quite well the dependence of rtn and rdin from q lake specific mass transfer coefficient qtn and qdin can vary greatly indicating that other explanatory variables than q must influence rtn and rdin mean qtn was comparable to other studies 6 2 m yr 1 for 75 lakes and reservoirs in the waitako river basin in new zealand alexander et al 2002 eq 5 8 3 m yr 1 for 16 shallow danish lakes windolf et al 1996 eq 3 8 9 m yr 1 for 115 lakes and reservoirs compiled from literature harrison et al 2009 eq 5 different to this study harrison et al 2009 found a significant difference between mean qtn of lakes and reservoirs 6 8 m yr 1 and 13 7 m yr 1 respectively calculated with eq 5 and ascribed it to the increased availability of highly labile organic matter in the reservoirs because of the flooding of previously terrestrial soils and ecosystems mean qdin was slightly higher than reported for 13 oligotrophic p limited canadian and norwegian lakes kaste and dillon 1993 2 8 m yr 1 eq 4 the latter values are recommended for the estimation of in lake retention of nitrogen in the calculation of the critical loads of acidity and their exceedances for lake ecosystems clrtap 2017 in the strictly empirical models linear regressions describing variations of rtn and rdin as a function of log10 q eqs 7 and 8 respectively gave significantly better predictions than the power function regressions describing variations of rtn and rdin as a function of q eqs 9 and 10 respectively eq 9 has been proposed as a tn retention model by windolf et al 1996 with the calibration constants a3 0 15 and b3 0 56 they calibrated the model with hypereutrophic danish shallow lakes rtn predicted with this model were on average 17 higher than when calculated with the power function in this study seitzinger et al 2002 derived calibration constants a4 0 88 and b4 0 37 for eq 10 very close to the values of this study they used data from about 20 oligotrophic and eutrophic lakes and about 10 rivers the study has also shown that the approximation of the semi empirical models eqs 3 6 by the strictly empirical linear models eqs 7 and 8 did not worsen predictions of rtn and rdin on the contrary predictions with the linear models seemed to be slightly better especially for rdin this result led to search for other possible significant explanatory variables related linearly to rtn and rdin for rtn the most important explanatory variable was as expected log10 q followed by ldin ltn and tn tp the variable ldin ltn was not as important as log10 q but substantially more relevant than tn tp the fact that the rtn increases with increasing ldin ltn indicates that the quality of n entering a lake or reservoir is important for the n retention mechanisms in most freshwaters nitrate and don are the main n species between the two nitrate is generally considered to be the most bioavailable form because assimilation of don by plants algae and microorganisms has been reported but it seems to become a key resource only in n limited oligo to mesotrophic estuaries or freshwaters durand et al 2011 saunders and kalff 2001a have shown that retention of tn occurs mainly by denitrification 80 85 followed by sedimentation 15 20 it is therefore not surprising that the supply of din to lakes and reservoirs greatly influences retention of tn directly by providing denitrifying organisms with nitrate and indirectly through uptake by primary producers transformation into biomass that can be permanently incorporated in the sediment or supply denitrifying bacteria with nitrate coupled nitrification denitrification or anammox bacteria with ammonia from mineralization of organic n the fact that in the absence of ldin ltn log10 ctnin was identified as explanatory variable is probably due to the positive relation between ldin ltn and ctnin in aquatic ecosystems at low n concentrations 1 mg l 1 in ultra oligotrophic systems don is the dominant species while at higher n concentrations nitrate becomes dominant durand et al 2011 ctnin may therefore have acted as a surrogate of ldin ltn the correlation between log10 ctnin and ldin ltn is 0 57 tn tp the third explanatory variable identified for predicting rtn can be seen as an indicator for the proportion of the imported n that can be potentially assimilated into biomass followed by net burial into the sediment coupled nitrification denitrification but also of the supply of organic material to denitrifying bacteria the slight negative relation found between rtn and tn tp may be the result of all these mechanisms higher tn tp infers a lower proportion of n that is transformed into biomass and indirectly contributes to retention of tn the variable tn tp is also an indicator for the availability of p relative to n and is often used to discriminate between n and p limitation using the criterion of kelly et al 2013 120 of the lakes reservoirs with tn input output mass balances and tn tp data were probably p limited tn tp 14 4 were n limited tn tp 3 5 and other 45 co limited by both n and p meaning that most lakes reservoirs of the dataset were at least temporarily p limited at these conditions we might expect ctp to be a significant indicator for primary productivity and to have a significant influence on tn retention in contrast to other studies berge et al 1997 finlay et al 2013 however ctp was not identified as a significant explanatory variable for prediction of rtn stepwise multiple linear regression analyses between rtn and the variables log10 q ctp log10 ctp tn tp lat and ctnin and log10 ctnin to lake reservoirs with tn tp values 14 did also not indicate that p concentration was relevant for prediction of rtn concentration of p log10 ctp was significant only if z ctnin and tn tp were excluded from the analyses and rtn was expressed as a function of log10 1 τ and log10 ctp p value 0 001 adjusted r2 0 30 the significance of the alternative model however was significantly lower this together with the high negative correlation between log10 z and log10 ctp 0 53 suggests that log10 ctp may in reality just act as a surrogate of log10 z this might explain why finlay et al 2013 indicated a positive dependence of rtn and rtn on ctp in the plots of rtn vs log10 1 τ and log10 rtn vs log10 ltn for the improvement of predictions of rdin stepwise multiple linear regression gave the most important explanatory variable as log10 q followed by log10 cdinin eq 13b excluding ctnin and cdinin from the analyses after log10 q ldin ltn and log10 ctp were identified as significant explanatory variables eq 16c and the predicted rdin s were closer to the measured smaller nrmsd again especially ctnin but also cdinin might here have acted as a surrogate of another parameter specifically since log10 ctnin correlates positively with ldin ltn pearson correlation 0 57 and log10 ctp pearson correlation 0 69 it might have acted as a surrogate for both variables this also explains why ctnin was identified as a better significant explanatory variable than either ldin ltn or log10 ctp alone to understand the reason for the significance of ldin ltn and log10 ctp for the prediction of rdin a closer look to what rdin represents is necessary rdin is positively influenced by net retention of din by denitrification or sedimentation and by transformation of din into ton and negatively by net retention of ton from the mass balance equations of tn din and ton it follows 17 r d i n r t n l d i n o t o n l t o n l d i n with lton and oton being the areal input and output of ton the equation indicates that the difference between rdin and rtn ldin corresponds to the areal net production of ton relative to ldin if oton lton 0 and to the areal net retention of ton relative to ldin if oton lton 0 the data in this study show that oton lton ldin increases linearly with increasing ldin ltn fig 4 a pearson correlation 0 69 and to a lesser extent with increasing log10 ctp fig 4b pearson correlation 0 41 the two additional explanatory variables next to log10 q to be identified for prediction of rdin eq 16c in other words from lakes with low values of ldin ltn with elevated percentages of ton in the inlets to lakes with high values of ldin ltn with elevated percentages of din in the inlets the areal input output ton mass balance changes from ton net retention to ton net production more precisely net production of ton is prevalent in lakes with ldin ltn 0 8 and since ldin ltn has been shown to correlate positively with log10 ctnin and log10 ctp at ctnin 3 mg l 1 and ctp 0 3 mg p 1 while net retention of ton is prevalent in lakes with ldin ltn 0 6 ctnin 2 mg l 1 ctp 0 05 mg p 1 and tn tp 50 for lakes with values in between both ton net retention or net production can occur several studies estimated rtn from models that predict rdin assuming that most n is retained on account of the imported din and that there is only minor net transformation of din into ton hindar et al 2001 mayorga et al 2010 under these assumptions eq 17 becomes 18 r d i n r t n l d i n and analogously 19 r t n r t n l t n r d i n l d i n l t n the comparison between measured rdin ltn and measured rtn is shown in fig 4c in the presence of a net retention of ton however rtn and ctn estimated from rdin are under and overestimated respectively the opposite occurs in the presence of a net production of ton in addition since it has been shown that the net production of ton is positively correlated with ldin ltn and as it is known that in aquatic ecosystems the ratio between the concentrations of din and tn is positively related to concentrations of tn at low ctnin 2 mg l 1 ctn estimated from rdin is somewhat overestimated and at high ctnin 3 mg l 1 somewhat underestimated estimation of rtn from modelled rdin requires an additional consideration from the comparison of eq 17 with eq 16c and the consideration of the linear relation between the second term of eq 17 oton lton ldin and ldin ltn and log10 ctp it can be derived that rtn ldin can be approximated by the first part of eq 16c a24 b24log10 q therefore measured rtn was compared with values estimated from eqs 4 and 8 that describe rdin as a function of q alone and have been shown to produce best predictions and their predictive power compared with that of eq 12c that describe rtn as a function of log10 q ldin ltn and tn tp table 3 the comparison could be made for 37 lakes and 2 reservoirs for which all necessary explanatory variables were known almost identical were predictions of rtn from eqs 4 and 8 intercept slope and r2 of the linear regression between observed and predicted values was 0 09 0 97 0 72 respectively and the nrmsd was 37 for eq 4 and 36 for eq 8 these values suggest just slightly worse predictions of rtn than obtained from eq 12c for which the values of the same parameters were 0 01 1 03 0 72 and 30 however the comparison of measured with predicted rtn obtained from rdin models also showed that rtn were underestimated on average by 8 shown for eq 4 in fig 4d the reason is that the lakes reservoirs used for calibrating the rdin models were probably not equally distributed regarding their ton net retention and net production the analyses of the subgroup of lakes reservoirs with available ton input output mass balance used for calibration of eq 4 showed that the number of lakes with a net retention of ton was higher than that with a net production of ton 25 vs 13 and also the absolute average value of oton lton ldin 0 21 vs 0 15 for the other lakes reservoirs used in the calibration of eq 4 the ton input output data were not available however as it was shown that ton net retention or net production depends also on ctp the analysis of the representativeness of the lakes regarding this parameter might give further information in the subgroup of lakes reservoirs with ton input output data 59 of the lakes reservoirs had ctp values 50 mg p l 1 probable indicator for the occurrence of a ton net retention 5 had ctp values 300 mg p l 1 probable indicator for the occurrence of a ton net production and the remaining 36 had values in between where both ton net production of retention can occur in the larger dataset used for the calibration 37 of the lakes reservoirs had ctp values 50 mg p l 1 3 had ctp values 300 mg p l 1 and 61 had values in between indicating that also in the larger group lakes reservoirs with net ton production were probably less represented as a consequence the calibration curve is more representative for lakes reservoirs with a ton net retention leading to an underestimation of rtn if the rdin models are used for its estimation an underestimation of rtn 13 on average was also obtained when it was estimated from rdin modelled with the empirical equation proposed by seitzinger et al 2002 thus rdin models should be used to predict only rdin and not rtn the same consideration holds when calibration of rdin is made only for oligotrophic p limited lakes as has been done by kaste and dillon 2003 the models are fine if used for prediction of rdin in oligotrophic p limited lakes but as at low ctp the relative to ldin areal retention of ton might be considerable predictions of rtn from rdin may lead to an underestimation for example using an average qdin of 5 m yr 1 proposed by hindar et al 2001 for estimating retention of din in oligotrophic p limited lakes rtn of a subgroup of 14 oligotrophic p limited lakes estimated from rdin using eq 4 is underestimated on average by 14 another suggestion for the use of the models presented in this study is to use the best model for which explanatory variables are available for the prediction of rtn the lowest deviations of the measured from the predicted values were given by eq 12c describing rtn as a function of log10 q ldin ltn and tn tp if tn tp is not known it can be neglected with not much loss of precision by the use of eq 12b if even ldin ltn is not known it can be substituted by log10 ctnin using eq 11b and if tn tp is available by eq 11c if only q is known then eq 9 is recommended because it has been calibrated with a larger dataset predictions of rdin should be approached in a similar way eq 16c that predicts rdin as a function of log10 q ldin ltn and log10 ctp gave the best results in the absence of log10 ctp log10 ctp can be neglected with not much loss of precision and 16b can be used instead if ldin ltn is not known it may be approximated by cdinin and the use of eq 13a and if q alone is known than eqs 4 or 8 should be used for prediction of rdin interestingly the variables ctnin and cdinin were initially introduced as explanatory variables in the expectation of a negative relation with rtn and rdin reflecting a decline in the efficiency of n retention at higher n concentrations mulholland et al 2008 both variables ended up to be positively related to rtn and rdin when other more relevant parameters were not available for the prediction of rtn log10 ctnin stood for ldin ltn and for the prediction of rdin log10 cdinin stood for both ldin ltn and log10 ctp in addition to the controlling factors identified in this study q ldin ltn tn tp ctp other parameters are likely to influence retention of tn and din temperature for the retention of both tn and din and the presence of organic carbon for tn may be relevant as well both parameters could not be investigated in this study because of the lack of data latitude was tested as a surrogate for temperature but was not a significant explanatory variable for rtn and rdin although not object of this study temperature has been shown to influence seasonality of rtn and rdin with generally higher values especially of rdin during summer kaste and lyche solheim 2005 windolf et al 1996 little has been reported about the influence of temperature on annual mean rtn and rdin of aquatic ecosystems temperature is generally known to enhance biogeochemical processes in natural aquatic systems schwoerbel 1987 as observed by veraart et al 2011 temperature may affect denitrification but also several biogeochemical reactions preceding denitrification such as mineralization and nitrification as an example microcosm experiments field measurements and a simple model approach suggested a doubling of denitrification rates by a temperature increase of three degrees in systems not n limited when denitrification of nitrate from the water column is the main mechanism because of the decrease of oxygen concentrations due to lower solubility and due to the steeper increase of respiration compared to photosynthesis veraart et al 2011 however in n limited systems characterized by an increase of the importance of nitrification denitrification as denitrifying mechanism the influence of temperature on mineralization and nitrification may be more relevant and an increase of temperature can theoretically both stimulate nitrification and inhibit nitrification because of lower oxygen concentrations veraart et al 2011 in addition with increasing temperatures primary productivity stimulates tn retention by supplying denitrifiers with organic carbon and contributing to net sedimentation but might also inhibit denitrification by competing for inorganic n cabrita and brotas 2000 all this indicates that the influence of temperature on n retention might be extremely complex and therefore not easily included in an empirical model as presented here also because other explanatory variables might be more relevant 5 conclusion in summary this study showed that empirical models derived from input output mass balances of tn and din describing annual mean rtn and rdin in lakes reservoirs as a sigmoid function of q can be approximated by a linear function on log10 q with little loss of information and can be significantly improved by focusing on the inorganic n load to the lakes nevertheless the relatively low values of the adjusted r2 of the models 0 5 0 7 suggests that the here presented models still deliver only estimates of the proportion of retained tn and din the reasons are various first not all assumptions the models are based on i e lakes at steady state completely mixed water column no n2 fixation first order reaction of the n retention mechanism may have been fulfilled by the n mass balances used for the calibration second the mass balances themselves might have been characterized by errors and uncertainties third the water bodies used for the calibrations varied in part enormously in their hydrologic morphologic hydrochemical and climatic characteristics that the here proposed empirical functions were not able to fully reflect it is clear that more complex mechanistic models are generally more accurate however these models tend to require extensive data that may be difficult to obtain wherefore they are rather used at local scale for large scale analyses the more general empirical models are preferred bouwman et al 2013 furthermore empirical n retention models are also used for the calculation of the critical loads of acidity and their exceedances for lake ecosystems clrtap 2017 that s why the here presented models are still useful tools to estimate tn and din retention in lakes and reservoirs moreover since the din load has been shown to influence tn retention the tn and din retention models can be combined to model multiple lakes in sequence in addition the accuracy of the presented empirical models might be improved further by repeating the analysis with subsets of lakes reservoirs that are more homogeneous it can also be attempted to further improve the models by including n2 fixation in the mass balance and expressing it as a function of the tn tp ratio of the external input as proposed by ruan 2014 or it can be tried to adapt the models to describe seasonality of n retention by including surface water temperature as proposed by windolf et al 1996 finally the models might also be calibrated with input output mass balance data from other types of aquatic ecosystems as well acknowledgments this research did not receive any specific grant from founding agencies in the public commercial or not for profit sector i m very grateful to dr richard wright for controlling and editing the english language and for his very useful suggestions also very precious were the comments of two anonymous reviewers appendix a calibration dataset table a1 
24924,a new approach to the calculation of fisher information in a complex dynamic system is proposed in this work the numerical strategy involves the successive solution of a series of optimal control problems to achieve the simultaneous estimation of the time cycle as a fundamental parameter in the calculation of fisher information and a set of fisher information average values as well as the dynamic optimization of the system a sequence of optimal control problems are solved first for estimating the time cycle which is required to calculate the fisher information of the system then the last optimization problem is solved to obtain not only the optimal profiles for the state and control variables but also a set of time averaged fisher information values such averaged values can be used to identify changes on the dynamic order of the system two illustrative examples are studied a simple predator prey lotka volterra model is solved to explain the application of the numerical strategy for the estimation of the time cycle and time averaged fisher information values and a proposed thirteen compartment socio economic ecological model solved after the simple model to show the effectiveness of the approach to detect regime changes in a more complex system the results of the simple model show a good approximation to the estimation of the time cycle after local minimum and maximum optimal points are obtained since the system shows a regular cyclic behavior for the larger model the results confirm the effectiveness of the proposed optimal control based approach in more complex systems and the benefits of using fisher information average values to analyze the behavior of the system while also identifying the policies that optimize the mass interactions among the compartments keywords optimal control sustainability ecological models nomenclature y state variable to denote the compartments in the ecological model g i growth function for compartment i g ci growth parameter for compartment i ε exchange between compartments 1 to indicate flow in 1 to flow out and 0 to no exchange β i j fraction of mass exchanged from compartment i to compartment j m mortality parameter r recycling variable k p goverment mass restriction cp parameter for price calculation cpd parameter for production calculation cd parameter for demand calculation y p i price of compartment i y prod i production of compartment i y dem i demand of compartment i w wage a w constant for the calculation of wage b w constant for the calculation of wage r c i constant for the calculation of mass recycled by producer 1 and 2 t time t cycle time cycle α fi fisher information variance f i fisher information average value u t control variable in an optimal control problem i set of compartments in the 13 compartment ecological model i p subset of compartments in the 13 compartment ecological model i h subset of compartments in the 13 compartment ecological model i n subset of compartments in the 13 compartment cological model i c subset of compartments in the 13 compartment ecological model i compartment in the ecological model j compartment in an ecological model t f final time c dem omnivore demands of compartment i c prod fraction of mass sent to omnivore by compartment i m w mass wasted by industrial sector h i hunting control 1 introduction ecological models and complex integrated models which are ecological models that not only include ecological variables on the dynamics of the system but also variables related to social and economical compartments have been studied as alternatives to represent the complex interactions of different sectors with the environment the use of ecological models has recently increased in search for the development of more robust and comprehensive tools that can support the assessment of the sustainability of biological systems after they have been influenced by human interactions sustainability is defined as a fundamental effort to create and maintain a regime in which the human population and their necessary material and energy consumption can be supported by a biological system on earth 25 and its quantitative assessment requires the estimation of different metrics which involve a basic understanding of both the behavior of the system and the non linear and non intuitive interaction among multiple variables fisher information fi has been proposed and reported in the literature as a useful tool for the development of sustainability theory for the analysis of ecological models 9 16 12 fi is used not only as a sustainability index but also as a measure of the variability of dynamic systems hence fi has been proven to be suitable for the study of ecological models by providing information about the dynamic regime of the system and its transitions however one significant conceptual issue that should be considered is that fi requires the system to present a cyclic behavior where the length of the time cycle has to be a known parameter for complex ecological systems the time cycle to be used for the calculation of fi is not known incorporating with this an additional complexity to the use of fi in large dynamic systems this problem has caught the attention of ecological modellers into the study of new approaches that could allow a more accurate and straightforward calculation and interpretation of fi 1 12 and even though the concept of fi has been successfully implemented no formal mathematical approach has been proposed for the calculation of the time cycle needed for its calculation trying to answer to this problem in this paper we propose a formal strategy to estimate the value of the time cycle required for the calculation of fi and its time averaged values which will be further used to determine regime changes in the dynamic systems to illustrate the methodology we present two case studies a simple two compartment prey predator lotka volterra dynamic model and a proposed 13 compartment socio economic ecological model the solution strategy of the optimal control problems involved in the numerical approach requires the discretization of the differential equations of the system followed by the solution of the non linear optimization problem at the end both the cyclic behavior of the state and control variables and the dynamic regime of the ecological model are identified the paper is organized as follows a brief overview of ecological models and fisher information theory is given in section 2 while section 3 describes the formal approach to estimate the time cycle and fi by solving a series of optimal control problems the case studies are given in section 4 whereas the implementation of the formal strategy and its analysis is presented in the results in section 5 finally the conclusions are presented in section 6 2 ecological modelling and fisher information in ecological modelling the interactions among the different levels in a trophic chain are represented by a set of blocks or compartments that exchange mass and or energy with each other and are mathematically represented as a set of algebraic and differential equations daes over the last decade different models have been proposed in order to have a deeper understanding of these dynamic interactions being the socio economic ecological models an example of them in these types of models typical analyses include not only the interaction between the environment and its natural predators but also the interdependency between the human population and the use of ecological systems to satisfy the industry and energy sectors currently included in the trophic chain the use of fisher information fi as a tool for the prediction of patterns to determine the state of order or organization of a system has allowed a better understanding of the use of the natural resources and its response to the different forms of exploitation by human activities fi proposed by 10 is a variable capable of saving a set of random observations about multiple unknown parameters this gives fi two different roles to play a measurement of the ability to estimate a parameter and a way to determine the disorder of a system or phenomenon 11 regardless the number of variables involved in the system in fact it is this particular capacity of merging different variables into one single value that makes fi suitable for the study of complex systems ecological economical etc fisher information is calculated using equation 1 for a dynamic system in a periodic steady state in this equation 1 fi is represented by the integral of the ratio of acceleration r t to speed r t of the state variables y i along a state space trajectory with the speed r t and the acceleration r t defined by equations 2 and 3 respectively these changes on the state variable y i have to be estimated to capture the critical properties of the system in a particular time period t where the variable or variables when multiple variables are considered will be measured 1 1 fi 1 t r t 2 r t 4 dt 2 r t i i dy i dt 2 3 r t 1 r t i i dy i dt d 2 y i dt 2 sustainability has been linked to fi dynamic order and regime shifts in ecological models by establishing that when a system becomes unsustainable the value of fi begins to either gain or lose information meaning that the system is gaining or losing stability having a high disorder in the information or disperse values for the state variables means that there is a lack of predictability of the values of these variables over a given range this is represented by small values of fi or low information available since the state of the variables is continuously changing on the other hand if the variables show bias to a particular set of values i e state variables remain in a preferred set of values the fi exhibits low disorder which results in more information and large fi values the longer the variables are in a specific state the more likely one would be able to find it in that state when sampling 2 in general these changes on the fi data and the dynamic state of a system are the ones that define the regime of the system and can be interpreted by following the sustainable regime hypothesis stated as follows 2 12 16 i for a sustainable regime in a system the average value of fi for a period of time t or time averaged fi value must be higher than zero and constant over such a period of time ii when the values of fi increase the system is gaining information and becoming more organized which implies that the system is shifting to successive regimes and increasing its dynamic order iii when the fi values decrease the system is losing information and becoming more disorganized which implies that the system is shifting to successive regimes and decreasing its dynamic order iv the regime under which the dynamic system is working on will change if the time averaged fi values present a steep rise or drop in dynamic order it is important to mention that since previous fi papers have yet to statistically delineate the meaning of a steep rise or drop in fi data the final decision is to be determined by the experience of the researcher using this index and the system to be studied following fi hypothesis some studies have used fi for the investigation of the performance of dynamic systems 21 and for the estimation of fi in nonlinear ecological models 9 4 2 3 5 6 22 19 15 7 16 for the last case fi values were able to determine how relatively disorganized or stable a system is based on an initial steady state regime and on the definition of the behavioral patterns that characterize the sustainability as well as the regime changes in the system under study despite the extended work that has been presented for the interpretation and calculation of fi to provide information about the system there is still a lack of information about the complexity on the determination of the cyclic behavior embedded on fi calculation the calculation of the time cycle generally considered the period t is a problem that has been examined in new proposed approaches 1 12 in the work of 12 the approach proposes the calculation of the time period as a trial and error iterative procedure starting with an initial guess for the time period the authors estimate the averaged fi values and the standard deviation for one time period then the time step is iteratively incremented until the standard deviation with respect to fi tends to zero as one of our contributions to the calculation of fi our approach intends to improve the iterative estimation procedure by using a formal optimization based approach method based on local optimal solutions using nonlinear programming solvers 3 optimal control problems and estimation of the time cycle the proposed approach to both the determination of the time cycle to be used in equation 1 for the calculation of fi and the dynamic optimization of the system is performed in this work through the solution of a series of optimization problems given in their mathematical form in table 1 the main goals of the approach are i to obtain a conceptually appropriate value of the time cycle needed to calculate fi ii to optimize the system while calculating fi and its average values for a finite number of time periods and iii to identify the dynamic regime of the system to determine a sustainable behavior in terms of fi losing or gaining information by comparing the time averaged fi values to accomplish the first and second goals we define the optimal control problems op1 j and op2 of table 1 to be used for the optimal location of local minimum and maximum points of a basis variable to determine the time cycle the third goal is accomplished by solving an optimization problem op3 which is used for the calculation and minimization of fi variance in order to reduce the spread of the data from the average value notice that for the solution of the dynamic optimization problems the discretization of the differential and algebraic set of equations is performed first using orthogonal collocation over finite elements followed by its nonlinear programming solution using an interior point method while considering multiple control variables u t in the dynamic system the proposed approach is separated into two main steps being step 1 defined for the calculation of the time cycle t cycle and step 2 used for the implementation of these time cycles into the calculation of fi in the dynamic problem the details of these steps are given next 1 the time cycle t cycle is obtained by solving a series of optimization problems denoted by op1 j and op2 in table 1 the solution of the optimal control problems allows the estimation of the start time and the end time of a time period where the system experiments a cyclic behavior these values provide the duration of each cycle of a periodic variable the range of values of the index j depends on the mathematical nature of the dynamic system in particular it depends on the number of local minima of the variables within a time period equal to t cycle which is unknown 2 in fact in this step the goal of the optimal control problems is to find the values of time corresponding to the local minimum op1 j and maximum values op2 of the selected variable the selection of this basis variable should be made by considering the variable that characterizes or has the more influence over the periodic cyclic like behavior of the dynamic system to find the minimum and maximum values of the basis variable we perform the procedure described in figures 1 and 2 when the state variable y i is considered the basis variable the procedure is explained in more detail in the following substeps it is crucial to note that besides solving the optimization problems the algorithm must verify the periodicity condition of the system by comparing the minimum values obtained in the optimization problems for the basis variable note that for a periodic system with time cycle equal to t cycle the equality y i t y i t t cycle must hold i the optimal control problem op11 that is j 1 is solved first to find the time t f1 that achieves a local minimum point of the one basis variables y i this is the cycle start time the values for all the state variables at this local minimum point must be saved since they are used as the initial conditions of the optimal control problem in step 2 ii a second optimization problem op2 with the same dynamic system is solved next where a local maximum point for the basis variable y i is obtained at a final time t f2 as a new constraint t f2 has to be higher than t f1 if the basis variable cycles are known to be regular step 1 of the algorithm ends here where t cycle is calculated using t cycle 2 t f 2 t f 1 this is the case shown in figure 1 where the end time for the symmetric cycle is t f 3 sym t f 2 t f 2 t f 1 iii if the cycles are not regular and display an arbitrary behavior a third optimization problem op12 j 2 is solved to obtain a time t f3 that reaches a second local minimum point of the basis variable y i in order to avoid the nlp solver to return to the first local minimum point found with the op11 a new time constraint indicating that t f3 has to be higher than t f2 is included once op12 is solved and t f3 is found a simple test is performed to verify that the basis variable is indeed displaying a periodic behavior between t f3 and t f1 the expected condition is 4 y i t f 1 y i t f 3 for practical purposes equation 4 is used as 5 y i t f 1 y i t f 3 tolerance where y i is the basis variable considered in the system if equation 5 holds the t cycle is calculated by using equation 6 6 t cycle t f 3 t f 1 if equation 5 does not hold successive optimal control problems of the type op1 j have to be solved that is j 3 4 j searching for additional local minima of the variable y i for each additional problem the constraint t f j 1 t f j ξ is added to the optimal control problem with ξ representing a small number and defined to avoid the nlp solver to return to the previous optimal solution this procedure is illustrated in figure 2 where a periodic of t cycle equal to t but arbitrary behavior of variable y i is shown note that substeps i and ii allow the estimation of a minimum at t f1 and a maximum at t f2 of y i however the solution of op12 provides t f3 but the algorithm does not stop at that point since y i t f3 y i t f1 to accomplish the expected condition in equation 4 additional problems of type op1 j are required until op14 is solved this can be seen in figure 2 where op14 provides t f5 which satisfies the expected condition y i t f5 y i t f1 points a and e in figure 2 the t cycle can therefore be estimated as t cycle t f5 t f1 in general after j problems of type op1 j find minimum values of y i that satisfy the periodicity condition the time cycle is calculated from equation 7 7 t cycle t f j t f 1 3 once t cycle has been calculated optimization problem op3 is solved by proposing a set of n arbitrary number of n time periods to be used for the fi calculation this set of proposed time periods is calculated using equation 8 8 t n n 1 t cycle n t cycle n n when n 1 considering this set of time periods and the values of the state variables at t f1 as the new initial conditions we solve the optimization problem op3 which includes the estimation of fi and solves an objective function that minimizes the fi variance of the system the dynamics and general constraints remain the same as those of the previous optimization problems while now the estimation of fi average values fi for each time period is also included these average values are to be essential since they are the main source to determine the variability of fi in the proposed periods of time which will later define the order or disorder of the dynamic system to delimit and interpret these average values we propose the following considerations a if the average values of fi are not changing over the proposed time periods variations of less than 10 the final time period t to be used for fi calculation is equal to 0 t cycle this means that fi is not losing and gaining information from the dynamic system i e the dynamic system is working under a stable regime on that particular set of periods this is described in figure 3 for the case of a symmetric periodic system as that shown in figure 1 b if the average values of fi for a dynamic system slightly vary over the proposed time periods variations between 10 to 30 a new value of t cycle needs to be proposed and calculated using equation 9 after this go back to the beginning of step 2 to recalculate the average values of fi with the new time periods this substep is described graphically in figures 4 a and b 9 t cycle new k t cycle where k 2 k c if the average values of fi are drastically changing variations greater than 50 no new value of t cycle is proposed and we determine that there is a regime change on the dynamic system over the proposed set of time periods finally by following the aforementioned considerations the final time periods are found and the optimal profiles obtained by the solution of op3 represent the optimal behavior of the system and can then be used to determine changes in the system regime 3 1 limitations of the approach for the estimation of t cycle the proposed approach described above to estimate t cycle present two main limitations the first one is evident and it is related to the computational effort associated to the successive solution of optimal control problems the second limitation that can be identified for approaching systems such as those illustrated in figure 5 figure 5 shows the dynamic periodic behavior of a system with t cycle equal to t notice however that the system also shows a periodic behavior in a smaller time period between points a and c the algorithm proposed in this work would estimate the values of t cycle as that of t on the one hand to our favor we think such behavior is highly unlikely for large arbitrary problems on the other hand and most important we also think that the numerical problem faced for a system similar to that of figure 5 is just the result of a bigger conceptual problem in terms of the estimation of fi could the time period defined between points a and c be used for an analysis based on fi in a smaller time frame we tend to think that the answer is yes and that the algorithm could provide the t cycle required for such an analysis 4 case studies to illustrate the calculation of the time cycle we first study a simple two compartment model in case i then we propose a 13 compartment socio economic ecological model in case ii in order to generalize the calculation of fi using the approach of section 3 the details of the cases are given below case i simple two compartment ecological model as an illustrative case for the calculation of the time cycle we propose the solution of a simple two species lotka volterra type of model that describes the interaction between a prey y 0 and its predator y 1 as presented in 12 the model equations in equations 10 and 11 are used for the solution of the optimal control problems in table 1 considering the following parameters a prey growth rate a 1 2 a predator death rate c 0 8 a parameter b 0 41 and a parameter d 0 3 10 dy 0 dt a b y 1 y 0 11 dy 1 dt d y 0 c y 1 case ii complex socio economic ecological model in order to generalize the proposed approach for the estimation of the time cycle and to finally calculate fi and to minimize fi variance we developed a 13 compartment socio economic ecological model this complex model is proposed to represent an ecosystem that regulates the mass exchanges between ecological compartments according to the needs of a human population for this we considered the same definitions and assumptions made in the models proposed by 25 17 3 and 8 the interactions among the thirteen compartments in the proposed ecological model are expressed in terms of mass flowrates sent from one compartment to another these interactions are shown in detail in figure 6 including the following trophic levels an accessible and inaccessible resource pool y 9 and y 10 respectively three primary producers y 1 y 2 and y 3 three herbivores y 4 y 5 and y 6 two carnivores y 7 and y 8 an omnivore or human household y 11 and an industrial y 12 and energy y 13 sectors the resource pool is the main source to be consumed by the primary producers to grow by the energy producer for the production of clean energy and by the industry sector for the production of industrial finished goods the producers 1 2 and 3 represent the agricultural products whereas the herbivores 4 5 and 6 represent the livestock and wild species in the ecosystem the waste from the producers herbivores omnivores and carnivores is sent to the resource pool to be returned to the system as nutrients while the waste from the industrial sector and energy producer is sent to the inaccessible resource pool these interactions are not included in figure 6 for simplicity but are included in the model equations the mortality and waste parameters m i and m w respectively are also given to express the complex interactions among the compartments we considered lotka volterra type of equations 12 d y i d t j i ε i j β i j g j y j y i m i y i i i where y i is the mass of the compartment i in the model ε is a exchange parameter with a value of either 1 1 or 0 depending on the direction of the mass exchange among the compartments and β is the fraction of mass exchanged between compartments the proposed set of equations for the 13 compartment socio economic ecological model are given in equations 13 to 20 including three economic functions in equation 18 that follow the dynamics of supply demand and price 23 the compartments that depend on the resource pool are limited in growth by its availability such as seasonal variation following a sinusoidal growth behavior given in equation 20 all the fixed parameters and initial conditions for the variables are given in appendix a in tables 2 3 and 4 for the solution of op3 two control variables are considered the fraction of mass sent by producer 1 and the energy sector to the industrial sector β 1 12 and β 13 12 respectively the notation for the variables in the model is included at the end of the paper sets i 1 13 i p 1 4 12 13 i h 5 6 i c 7 8 i n 1 2 3 12 13 producers i 1 2 and 3 13 dy 1 dt j i ε 1 j β 1 j g 1 y 1 y j y dem 1 c dem 1 g 1 12 y prod 12 m 1 y 1 dy 2 dt j i ε 2 j β 2 j g 2 y 2 y j r 2 k p m 2 y 2 dy 3 dt j i ε 3 j β 3 j g 3 y 3 y j r 3 m 3 y 3 herbivores i 4 5 and 6 14 dy 4 dt j i ε 4 j β 4 j y 4 y j k p y dem 4 c dem 4 m 4 y 4 dy i dt j i ε i j β i j y i y j m i y i i i h carnivores i 7 and 8 15 dy i dt j i ε i j β i j y i y j h i y i m i y i i i c accessible and inaccessible resource pools i 9 and 10 16 dy 9 dt j i m 9 j y j y 9 j 1 3 β 9 j g j y j m 9 dy 10 dt m 9 m 13 r 2 r 3 m 10 y 10 m w y dem 12 c dem 12 omnivore industrial and energy sector i 11 12 and 13 17 dy 11 dt j i ε 11 j β 11 j y 11 y j j i p y dem j c dem j m 11 y 11 dy 12 dt j i ε 12 j β 12 j y 12 y j g 1 12 y prod 12 g 13 12 y prod 12 y dem 12 c dem 12 1 m w dy 13 dt j i ε 13 j β 13 j y 13 y j g 13 12 y prod 13 y dem 13 c dem 13 m 13 economic functions 18 d y p i dt cp 1 i y dem i y prod i cp 2 i w i i p d y prod i dt cpd 1 i y dem i 1 cpd 2 i y p i i i p d y dem i dt 1 cd 1 i y prod i cd 2 i y p i i i p w a w t b w other recycle function 19 r i r c i y 10 r c 2 r c 3 for i 2 3 sinusoidal growth function 20 g i g ci 1 1 3 sin 2 π t t π 2 i i n the model equations of both of the models were written in python using the package pyomo 14 13 the differential equations are discretized using orthogonal collocation over finite elements using the framework pyomo dae 18 followed by the use of the solver ipopt 24 for the solution of the discretized nonlinear optimization problem for both of the cases 12 finite elements with 4 orthogonal collocation points are used for the solution of the optimization problem op3 5 results the illustrative simple ecological model in case i is studied first followed by the 13 compartment ecological case study ii the details are given below case i the estimation of t cycle is performed first by using the prey y 0 as the basis variable the results are shown in figures 7 a and b by solving op11 the first local minimum point for the prey values is found at t f1 and equal to 0 95 followed by the solution of op2 that maximizes the prey values at a final time t f2 4 43 these results are shown as the boundary values of the shaded area in figure 7 a the solution of op12 gives a final time t f3 7 43 obtaining an optimal minimum point for the prey and accomplishing the expected condition in equation 5 y 0 t f1 y 0 t f3 0 001 this time t f3 can be seen as the boundary right value in figure 7 b considering these results the time cycle is then calculated using equation 6 obtaining a final value of t cycle 6 49 which can be seen in the shaded area in figure 7 b given this t cycle value the following time periods are proposed t 1 0 6 49 t 2 6 49 12 98 t 3 12 98 19 47 and t 4 19 47 25 96 considering these time periods and the new initial conditions for the state variables the op3 for the minimization of fi variance is solved the optimal profiles for the prey and predator and fi for this optimization problem are shown in figures 8 a and 8 b respectively including dashed vertical lines that represent the proposed time periods t j as we can see the prey in figure 8 a starts at its minimum point at time zero with constant fi average values for each time period see figure 8 b since no drastic changes are observed between the fi average values we conclude that one period t is indeed equal to the calculated value of 6 49 this value shows a difference of about 5 88 from the value obtained by 12 who reported a period equal to 6 883 for the same dynamic system using an iterative trial and error methodology considering that the proposed approach shows accurate results this methodology is used for the study of the more complex 13 compartment model in case ii case ii the calculation of t cycle is performed considering g 1 as the basis variable the profile for this function is shown in figure 9 a including a gray shaded area to highlight the calculated time cycle with a value of 12 this time cycle is obtained after the solution of op11 op2 and op12 when the constraint given by equation 5 is satisfied the following time periods are proposed for the solution of the op3 t 1 0 12 t 2 12 24 t 3 24 36 and t 4 36 48 the average values of fi are obtained and shown in figure 9 b after the first time interval fi shows a drastic change in its average value representing that the system loses information on this first period while reaching a constant regime on the following three time periods to study these changes on the averaged fi values the optimal profiles for the thirteen compartments in the socio economic ecological model are shown in figures 10 10 a 10 b 10 c and 10 d figure 10 a presents a gradual increase of producer 1 influencing the growth of herbivore 1 in figure 10 b and indirectly the growth carnivore 1 in figure 10 c figure 10 a shows that the level of producer 2 for the first time interval t 1 0 12 highlighted on the light gray shaded area increases by consuming more mass from the resource pool figure 10 d to then start decreasing when the herbivores in figure 10 b and the energy producer in figure 10 c start consuming its available mass the levels of herbivores 2 and 3 in figure 10 b decrease in response to their consumption by the carnivores 1 and 2 in figure 10 c since these predators are only controlled by natural death and not by predation carnivore 1 shows a steeply increase through time which is also true for the omnivore human households as shown in figure 10 d since the omnivore mass is increasing the demand and production of goods from the industrial and energy sector also slowly increasing as shown in figure 10 c this industrial sector availability is controlled by the optimal profiles of the control variables given in figure 11 where we observe that producer 1 sends a constant fraction of its mass while the energy producer reduces the fraction of mass exchanged due to the reduction on its mass availability these profiles indicate that the system regime is maintained due to the availability of mass from the resource pool which continues feeding the system before it reaches to zero figure 10 d when the resource pool gets closer to zero the system can not be maintained anymore and fi loses more information this lost on fi values indicate that the system with no more available resources cannot be sustained and becomes disorganized and unstable 6 conclusion this work presents and implements a numerical optimal control based approach to the determination of fisher information in particular the algorithm intends to estimate the time period t cycle used to calculate fi when a periodic behavior of the dynamic system is considered as an additional result the algorithm also estimates the time averaged values of fisher information which are used as a tool to analyze the ecological system regimes and their shifts the proposed algorithm assumes a periodic behavior of the system and involves the successive solution of a series of optimal control problems which are solved through the discretization of the differential equations and the use of a nlp local optimizer since no global optimal solutions are found an incorrect estimation of t cycle could be obtained if there are multiple critical points with the same value for the basis variable within a one cycle period this is included as one of the limitations of the approach to illustrate the proposed approach a simple predator prey model was solved first the results show that for a periodic system the maximization and minimization of the reference variable allow the calculation of t cycle to extend the use of the proposed approach in a much more larger problem a complex socio ecological economical model is proposed and solved showing the results that the time averaged fisher information values can be used to analyze regime shifts in the system the state variables profiles for this complex example show that at the beginning of the simulation the time averaged fisher information values are higher and start decreasing when the compartments in the model start interacting with each other a drop in the time averaged fisher information value is observed when the main producer of the system resource pool starts disappearing meaning that the system is losing its dynamic order and hence it is becoming less sustainable many literature reports discuss the potential use of fisher information as metrics for the sustainability of a dynamic system the focus of our work is not to provide additional evidence of that statement the aim of this work is to provide a tool for achieving theoretical consistency on the estimation of fi in other words for periodic system t should not be arbitrarily defined to estimate fi t should be defined in terms of the time period of one cycle although t can be any number of cycles three interesting topics remain to be further studied as future work one refers to analyze the effect of regime shifts on t cycle i e t cycle might not be a constant through the entire time horizon the second issue is of course a continued effort to assess the value of fisher information as a metric for sustainability finally caution should be taken about extending the use of this algorithm for complex real world problems although given a dynamic model of any size the approach suggested could be attempted several problems could be envisioned such as the computationally effort required the numerical problems associated to achieve convergence on a large scale highly non linear model and the potential complexities associated to local optimality acknowledgments the authors are grateful for the financial support provided by conacyt mexico for the development of this work appendix a the initial conditions and constant parameters used in the 13 compartment model equations in section 4 are given in tables 2 3 and 4 the notation for the state variables y is as follows 1 for producer 1 2 for producer 2 3 for producer 3 4 for herbivore 1 5 for herbivore 2 6 for herbivore 3 7 for carnivore 1 8 for carnivore 2 9 for resource pool 10 for inaccessible resource pool 11 for omnivore 12 for the industrial sector and 13 for the energy sector 2 3 4 
24924,a new approach to the calculation of fisher information in a complex dynamic system is proposed in this work the numerical strategy involves the successive solution of a series of optimal control problems to achieve the simultaneous estimation of the time cycle as a fundamental parameter in the calculation of fisher information and a set of fisher information average values as well as the dynamic optimization of the system a sequence of optimal control problems are solved first for estimating the time cycle which is required to calculate the fisher information of the system then the last optimization problem is solved to obtain not only the optimal profiles for the state and control variables but also a set of time averaged fisher information values such averaged values can be used to identify changes on the dynamic order of the system two illustrative examples are studied a simple predator prey lotka volterra model is solved to explain the application of the numerical strategy for the estimation of the time cycle and time averaged fisher information values and a proposed thirteen compartment socio economic ecological model solved after the simple model to show the effectiveness of the approach to detect regime changes in a more complex system the results of the simple model show a good approximation to the estimation of the time cycle after local minimum and maximum optimal points are obtained since the system shows a regular cyclic behavior for the larger model the results confirm the effectiveness of the proposed optimal control based approach in more complex systems and the benefits of using fisher information average values to analyze the behavior of the system while also identifying the policies that optimize the mass interactions among the compartments keywords optimal control sustainability ecological models nomenclature y state variable to denote the compartments in the ecological model g i growth function for compartment i g ci growth parameter for compartment i ε exchange between compartments 1 to indicate flow in 1 to flow out and 0 to no exchange β i j fraction of mass exchanged from compartment i to compartment j m mortality parameter r recycling variable k p goverment mass restriction cp parameter for price calculation cpd parameter for production calculation cd parameter for demand calculation y p i price of compartment i y prod i production of compartment i y dem i demand of compartment i w wage a w constant for the calculation of wage b w constant for the calculation of wage r c i constant for the calculation of mass recycled by producer 1 and 2 t time t cycle time cycle α fi fisher information variance f i fisher information average value u t control variable in an optimal control problem i set of compartments in the 13 compartment ecological model i p subset of compartments in the 13 compartment ecological model i h subset of compartments in the 13 compartment ecological model i n subset of compartments in the 13 compartment cological model i c subset of compartments in the 13 compartment ecological model i compartment in the ecological model j compartment in an ecological model t f final time c dem omnivore demands of compartment i c prod fraction of mass sent to omnivore by compartment i m w mass wasted by industrial sector h i hunting control 1 introduction ecological models and complex integrated models which are ecological models that not only include ecological variables on the dynamics of the system but also variables related to social and economical compartments have been studied as alternatives to represent the complex interactions of different sectors with the environment the use of ecological models has recently increased in search for the development of more robust and comprehensive tools that can support the assessment of the sustainability of biological systems after they have been influenced by human interactions sustainability is defined as a fundamental effort to create and maintain a regime in which the human population and their necessary material and energy consumption can be supported by a biological system on earth 25 and its quantitative assessment requires the estimation of different metrics which involve a basic understanding of both the behavior of the system and the non linear and non intuitive interaction among multiple variables fisher information fi has been proposed and reported in the literature as a useful tool for the development of sustainability theory for the analysis of ecological models 9 16 12 fi is used not only as a sustainability index but also as a measure of the variability of dynamic systems hence fi has been proven to be suitable for the study of ecological models by providing information about the dynamic regime of the system and its transitions however one significant conceptual issue that should be considered is that fi requires the system to present a cyclic behavior where the length of the time cycle has to be a known parameter for complex ecological systems the time cycle to be used for the calculation of fi is not known incorporating with this an additional complexity to the use of fi in large dynamic systems this problem has caught the attention of ecological modellers into the study of new approaches that could allow a more accurate and straightforward calculation and interpretation of fi 1 12 and even though the concept of fi has been successfully implemented no formal mathematical approach has been proposed for the calculation of the time cycle needed for its calculation trying to answer to this problem in this paper we propose a formal strategy to estimate the value of the time cycle required for the calculation of fi and its time averaged values which will be further used to determine regime changes in the dynamic systems to illustrate the methodology we present two case studies a simple two compartment prey predator lotka volterra dynamic model and a proposed 13 compartment socio economic ecological model the solution strategy of the optimal control problems involved in the numerical approach requires the discretization of the differential equations of the system followed by the solution of the non linear optimization problem at the end both the cyclic behavior of the state and control variables and the dynamic regime of the ecological model are identified the paper is organized as follows a brief overview of ecological models and fisher information theory is given in section 2 while section 3 describes the formal approach to estimate the time cycle and fi by solving a series of optimal control problems the case studies are given in section 4 whereas the implementation of the formal strategy and its analysis is presented in the results in section 5 finally the conclusions are presented in section 6 2 ecological modelling and fisher information in ecological modelling the interactions among the different levels in a trophic chain are represented by a set of blocks or compartments that exchange mass and or energy with each other and are mathematically represented as a set of algebraic and differential equations daes over the last decade different models have been proposed in order to have a deeper understanding of these dynamic interactions being the socio economic ecological models an example of them in these types of models typical analyses include not only the interaction between the environment and its natural predators but also the interdependency between the human population and the use of ecological systems to satisfy the industry and energy sectors currently included in the trophic chain the use of fisher information fi as a tool for the prediction of patterns to determine the state of order or organization of a system has allowed a better understanding of the use of the natural resources and its response to the different forms of exploitation by human activities fi proposed by 10 is a variable capable of saving a set of random observations about multiple unknown parameters this gives fi two different roles to play a measurement of the ability to estimate a parameter and a way to determine the disorder of a system or phenomenon 11 regardless the number of variables involved in the system in fact it is this particular capacity of merging different variables into one single value that makes fi suitable for the study of complex systems ecological economical etc fisher information is calculated using equation 1 for a dynamic system in a periodic steady state in this equation 1 fi is represented by the integral of the ratio of acceleration r t to speed r t of the state variables y i along a state space trajectory with the speed r t and the acceleration r t defined by equations 2 and 3 respectively these changes on the state variable y i have to be estimated to capture the critical properties of the system in a particular time period t where the variable or variables when multiple variables are considered will be measured 1 1 fi 1 t r t 2 r t 4 dt 2 r t i i dy i dt 2 3 r t 1 r t i i dy i dt d 2 y i dt 2 sustainability has been linked to fi dynamic order and regime shifts in ecological models by establishing that when a system becomes unsustainable the value of fi begins to either gain or lose information meaning that the system is gaining or losing stability having a high disorder in the information or disperse values for the state variables means that there is a lack of predictability of the values of these variables over a given range this is represented by small values of fi or low information available since the state of the variables is continuously changing on the other hand if the variables show bias to a particular set of values i e state variables remain in a preferred set of values the fi exhibits low disorder which results in more information and large fi values the longer the variables are in a specific state the more likely one would be able to find it in that state when sampling 2 in general these changes on the fi data and the dynamic state of a system are the ones that define the regime of the system and can be interpreted by following the sustainable regime hypothesis stated as follows 2 12 16 i for a sustainable regime in a system the average value of fi for a period of time t or time averaged fi value must be higher than zero and constant over such a period of time ii when the values of fi increase the system is gaining information and becoming more organized which implies that the system is shifting to successive regimes and increasing its dynamic order iii when the fi values decrease the system is losing information and becoming more disorganized which implies that the system is shifting to successive regimes and decreasing its dynamic order iv the regime under which the dynamic system is working on will change if the time averaged fi values present a steep rise or drop in dynamic order it is important to mention that since previous fi papers have yet to statistically delineate the meaning of a steep rise or drop in fi data the final decision is to be determined by the experience of the researcher using this index and the system to be studied following fi hypothesis some studies have used fi for the investigation of the performance of dynamic systems 21 and for the estimation of fi in nonlinear ecological models 9 4 2 3 5 6 22 19 15 7 16 for the last case fi values were able to determine how relatively disorganized or stable a system is based on an initial steady state regime and on the definition of the behavioral patterns that characterize the sustainability as well as the regime changes in the system under study despite the extended work that has been presented for the interpretation and calculation of fi to provide information about the system there is still a lack of information about the complexity on the determination of the cyclic behavior embedded on fi calculation the calculation of the time cycle generally considered the period t is a problem that has been examined in new proposed approaches 1 12 in the work of 12 the approach proposes the calculation of the time period as a trial and error iterative procedure starting with an initial guess for the time period the authors estimate the averaged fi values and the standard deviation for one time period then the time step is iteratively incremented until the standard deviation with respect to fi tends to zero as one of our contributions to the calculation of fi our approach intends to improve the iterative estimation procedure by using a formal optimization based approach method based on local optimal solutions using nonlinear programming solvers 3 optimal control problems and estimation of the time cycle the proposed approach to both the determination of the time cycle to be used in equation 1 for the calculation of fi and the dynamic optimization of the system is performed in this work through the solution of a series of optimization problems given in their mathematical form in table 1 the main goals of the approach are i to obtain a conceptually appropriate value of the time cycle needed to calculate fi ii to optimize the system while calculating fi and its average values for a finite number of time periods and iii to identify the dynamic regime of the system to determine a sustainable behavior in terms of fi losing or gaining information by comparing the time averaged fi values to accomplish the first and second goals we define the optimal control problems op1 j and op2 of table 1 to be used for the optimal location of local minimum and maximum points of a basis variable to determine the time cycle the third goal is accomplished by solving an optimization problem op3 which is used for the calculation and minimization of fi variance in order to reduce the spread of the data from the average value notice that for the solution of the dynamic optimization problems the discretization of the differential and algebraic set of equations is performed first using orthogonal collocation over finite elements followed by its nonlinear programming solution using an interior point method while considering multiple control variables u t in the dynamic system the proposed approach is separated into two main steps being step 1 defined for the calculation of the time cycle t cycle and step 2 used for the implementation of these time cycles into the calculation of fi in the dynamic problem the details of these steps are given next 1 the time cycle t cycle is obtained by solving a series of optimization problems denoted by op1 j and op2 in table 1 the solution of the optimal control problems allows the estimation of the start time and the end time of a time period where the system experiments a cyclic behavior these values provide the duration of each cycle of a periodic variable the range of values of the index j depends on the mathematical nature of the dynamic system in particular it depends on the number of local minima of the variables within a time period equal to t cycle which is unknown 2 in fact in this step the goal of the optimal control problems is to find the values of time corresponding to the local minimum op1 j and maximum values op2 of the selected variable the selection of this basis variable should be made by considering the variable that characterizes or has the more influence over the periodic cyclic like behavior of the dynamic system to find the minimum and maximum values of the basis variable we perform the procedure described in figures 1 and 2 when the state variable y i is considered the basis variable the procedure is explained in more detail in the following substeps it is crucial to note that besides solving the optimization problems the algorithm must verify the periodicity condition of the system by comparing the minimum values obtained in the optimization problems for the basis variable note that for a periodic system with time cycle equal to t cycle the equality y i t y i t t cycle must hold i the optimal control problem op11 that is j 1 is solved first to find the time t f1 that achieves a local minimum point of the one basis variables y i this is the cycle start time the values for all the state variables at this local minimum point must be saved since they are used as the initial conditions of the optimal control problem in step 2 ii a second optimization problem op2 with the same dynamic system is solved next where a local maximum point for the basis variable y i is obtained at a final time t f2 as a new constraint t f2 has to be higher than t f1 if the basis variable cycles are known to be regular step 1 of the algorithm ends here where t cycle is calculated using t cycle 2 t f 2 t f 1 this is the case shown in figure 1 where the end time for the symmetric cycle is t f 3 sym t f 2 t f 2 t f 1 iii if the cycles are not regular and display an arbitrary behavior a third optimization problem op12 j 2 is solved to obtain a time t f3 that reaches a second local minimum point of the basis variable y i in order to avoid the nlp solver to return to the first local minimum point found with the op11 a new time constraint indicating that t f3 has to be higher than t f2 is included once op12 is solved and t f3 is found a simple test is performed to verify that the basis variable is indeed displaying a periodic behavior between t f3 and t f1 the expected condition is 4 y i t f 1 y i t f 3 for practical purposes equation 4 is used as 5 y i t f 1 y i t f 3 tolerance where y i is the basis variable considered in the system if equation 5 holds the t cycle is calculated by using equation 6 6 t cycle t f 3 t f 1 if equation 5 does not hold successive optimal control problems of the type op1 j have to be solved that is j 3 4 j searching for additional local minima of the variable y i for each additional problem the constraint t f j 1 t f j ξ is added to the optimal control problem with ξ representing a small number and defined to avoid the nlp solver to return to the previous optimal solution this procedure is illustrated in figure 2 where a periodic of t cycle equal to t but arbitrary behavior of variable y i is shown note that substeps i and ii allow the estimation of a minimum at t f1 and a maximum at t f2 of y i however the solution of op12 provides t f3 but the algorithm does not stop at that point since y i t f3 y i t f1 to accomplish the expected condition in equation 4 additional problems of type op1 j are required until op14 is solved this can be seen in figure 2 where op14 provides t f5 which satisfies the expected condition y i t f5 y i t f1 points a and e in figure 2 the t cycle can therefore be estimated as t cycle t f5 t f1 in general after j problems of type op1 j find minimum values of y i that satisfy the periodicity condition the time cycle is calculated from equation 7 7 t cycle t f j t f 1 3 once t cycle has been calculated optimization problem op3 is solved by proposing a set of n arbitrary number of n time periods to be used for the fi calculation this set of proposed time periods is calculated using equation 8 8 t n n 1 t cycle n t cycle n n when n 1 considering this set of time periods and the values of the state variables at t f1 as the new initial conditions we solve the optimization problem op3 which includes the estimation of fi and solves an objective function that minimizes the fi variance of the system the dynamics and general constraints remain the same as those of the previous optimization problems while now the estimation of fi average values fi for each time period is also included these average values are to be essential since they are the main source to determine the variability of fi in the proposed periods of time which will later define the order or disorder of the dynamic system to delimit and interpret these average values we propose the following considerations a if the average values of fi are not changing over the proposed time periods variations of less than 10 the final time period t to be used for fi calculation is equal to 0 t cycle this means that fi is not losing and gaining information from the dynamic system i e the dynamic system is working under a stable regime on that particular set of periods this is described in figure 3 for the case of a symmetric periodic system as that shown in figure 1 b if the average values of fi for a dynamic system slightly vary over the proposed time periods variations between 10 to 30 a new value of t cycle needs to be proposed and calculated using equation 9 after this go back to the beginning of step 2 to recalculate the average values of fi with the new time periods this substep is described graphically in figures 4 a and b 9 t cycle new k t cycle where k 2 k c if the average values of fi are drastically changing variations greater than 50 no new value of t cycle is proposed and we determine that there is a regime change on the dynamic system over the proposed set of time periods finally by following the aforementioned considerations the final time periods are found and the optimal profiles obtained by the solution of op3 represent the optimal behavior of the system and can then be used to determine changes in the system regime 3 1 limitations of the approach for the estimation of t cycle the proposed approach described above to estimate t cycle present two main limitations the first one is evident and it is related to the computational effort associated to the successive solution of optimal control problems the second limitation that can be identified for approaching systems such as those illustrated in figure 5 figure 5 shows the dynamic periodic behavior of a system with t cycle equal to t notice however that the system also shows a periodic behavior in a smaller time period between points a and c the algorithm proposed in this work would estimate the values of t cycle as that of t on the one hand to our favor we think such behavior is highly unlikely for large arbitrary problems on the other hand and most important we also think that the numerical problem faced for a system similar to that of figure 5 is just the result of a bigger conceptual problem in terms of the estimation of fi could the time period defined between points a and c be used for an analysis based on fi in a smaller time frame we tend to think that the answer is yes and that the algorithm could provide the t cycle required for such an analysis 4 case studies to illustrate the calculation of the time cycle we first study a simple two compartment model in case i then we propose a 13 compartment socio economic ecological model in case ii in order to generalize the calculation of fi using the approach of section 3 the details of the cases are given below case i simple two compartment ecological model as an illustrative case for the calculation of the time cycle we propose the solution of a simple two species lotka volterra type of model that describes the interaction between a prey y 0 and its predator y 1 as presented in 12 the model equations in equations 10 and 11 are used for the solution of the optimal control problems in table 1 considering the following parameters a prey growth rate a 1 2 a predator death rate c 0 8 a parameter b 0 41 and a parameter d 0 3 10 dy 0 dt a b y 1 y 0 11 dy 1 dt d y 0 c y 1 case ii complex socio economic ecological model in order to generalize the proposed approach for the estimation of the time cycle and to finally calculate fi and to minimize fi variance we developed a 13 compartment socio economic ecological model this complex model is proposed to represent an ecosystem that regulates the mass exchanges between ecological compartments according to the needs of a human population for this we considered the same definitions and assumptions made in the models proposed by 25 17 3 and 8 the interactions among the thirteen compartments in the proposed ecological model are expressed in terms of mass flowrates sent from one compartment to another these interactions are shown in detail in figure 6 including the following trophic levels an accessible and inaccessible resource pool y 9 and y 10 respectively three primary producers y 1 y 2 and y 3 three herbivores y 4 y 5 and y 6 two carnivores y 7 and y 8 an omnivore or human household y 11 and an industrial y 12 and energy y 13 sectors the resource pool is the main source to be consumed by the primary producers to grow by the energy producer for the production of clean energy and by the industry sector for the production of industrial finished goods the producers 1 2 and 3 represent the agricultural products whereas the herbivores 4 5 and 6 represent the livestock and wild species in the ecosystem the waste from the producers herbivores omnivores and carnivores is sent to the resource pool to be returned to the system as nutrients while the waste from the industrial sector and energy producer is sent to the inaccessible resource pool these interactions are not included in figure 6 for simplicity but are included in the model equations the mortality and waste parameters m i and m w respectively are also given to express the complex interactions among the compartments we considered lotka volterra type of equations 12 d y i d t j i ε i j β i j g j y j y i m i y i i i where y i is the mass of the compartment i in the model ε is a exchange parameter with a value of either 1 1 or 0 depending on the direction of the mass exchange among the compartments and β is the fraction of mass exchanged between compartments the proposed set of equations for the 13 compartment socio economic ecological model are given in equations 13 to 20 including three economic functions in equation 18 that follow the dynamics of supply demand and price 23 the compartments that depend on the resource pool are limited in growth by its availability such as seasonal variation following a sinusoidal growth behavior given in equation 20 all the fixed parameters and initial conditions for the variables are given in appendix a in tables 2 3 and 4 for the solution of op3 two control variables are considered the fraction of mass sent by producer 1 and the energy sector to the industrial sector β 1 12 and β 13 12 respectively the notation for the variables in the model is included at the end of the paper sets i 1 13 i p 1 4 12 13 i h 5 6 i c 7 8 i n 1 2 3 12 13 producers i 1 2 and 3 13 dy 1 dt j i ε 1 j β 1 j g 1 y 1 y j y dem 1 c dem 1 g 1 12 y prod 12 m 1 y 1 dy 2 dt j i ε 2 j β 2 j g 2 y 2 y j r 2 k p m 2 y 2 dy 3 dt j i ε 3 j β 3 j g 3 y 3 y j r 3 m 3 y 3 herbivores i 4 5 and 6 14 dy 4 dt j i ε 4 j β 4 j y 4 y j k p y dem 4 c dem 4 m 4 y 4 dy i dt j i ε i j β i j y i y j m i y i i i h carnivores i 7 and 8 15 dy i dt j i ε i j β i j y i y j h i y i m i y i i i c accessible and inaccessible resource pools i 9 and 10 16 dy 9 dt j i m 9 j y j y 9 j 1 3 β 9 j g j y j m 9 dy 10 dt m 9 m 13 r 2 r 3 m 10 y 10 m w y dem 12 c dem 12 omnivore industrial and energy sector i 11 12 and 13 17 dy 11 dt j i ε 11 j β 11 j y 11 y j j i p y dem j c dem j m 11 y 11 dy 12 dt j i ε 12 j β 12 j y 12 y j g 1 12 y prod 12 g 13 12 y prod 12 y dem 12 c dem 12 1 m w dy 13 dt j i ε 13 j β 13 j y 13 y j g 13 12 y prod 13 y dem 13 c dem 13 m 13 economic functions 18 d y p i dt cp 1 i y dem i y prod i cp 2 i w i i p d y prod i dt cpd 1 i y dem i 1 cpd 2 i y p i i i p d y dem i dt 1 cd 1 i y prod i cd 2 i y p i i i p w a w t b w other recycle function 19 r i r c i y 10 r c 2 r c 3 for i 2 3 sinusoidal growth function 20 g i g ci 1 1 3 sin 2 π t t π 2 i i n the model equations of both of the models were written in python using the package pyomo 14 13 the differential equations are discretized using orthogonal collocation over finite elements using the framework pyomo dae 18 followed by the use of the solver ipopt 24 for the solution of the discretized nonlinear optimization problem for both of the cases 12 finite elements with 4 orthogonal collocation points are used for the solution of the optimization problem op3 5 results the illustrative simple ecological model in case i is studied first followed by the 13 compartment ecological case study ii the details are given below case i the estimation of t cycle is performed first by using the prey y 0 as the basis variable the results are shown in figures 7 a and b by solving op11 the first local minimum point for the prey values is found at t f1 and equal to 0 95 followed by the solution of op2 that maximizes the prey values at a final time t f2 4 43 these results are shown as the boundary values of the shaded area in figure 7 a the solution of op12 gives a final time t f3 7 43 obtaining an optimal minimum point for the prey and accomplishing the expected condition in equation 5 y 0 t f1 y 0 t f3 0 001 this time t f3 can be seen as the boundary right value in figure 7 b considering these results the time cycle is then calculated using equation 6 obtaining a final value of t cycle 6 49 which can be seen in the shaded area in figure 7 b given this t cycle value the following time periods are proposed t 1 0 6 49 t 2 6 49 12 98 t 3 12 98 19 47 and t 4 19 47 25 96 considering these time periods and the new initial conditions for the state variables the op3 for the minimization of fi variance is solved the optimal profiles for the prey and predator and fi for this optimization problem are shown in figures 8 a and 8 b respectively including dashed vertical lines that represent the proposed time periods t j as we can see the prey in figure 8 a starts at its minimum point at time zero with constant fi average values for each time period see figure 8 b since no drastic changes are observed between the fi average values we conclude that one period t is indeed equal to the calculated value of 6 49 this value shows a difference of about 5 88 from the value obtained by 12 who reported a period equal to 6 883 for the same dynamic system using an iterative trial and error methodology considering that the proposed approach shows accurate results this methodology is used for the study of the more complex 13 compartment model in case ii case ii the calculation of t cycle is performed considering g 1 as the basis variable the profile for this function is shown in figure 9 a including a gray shaded area to highlight the calculated time cycle with a value of 12 this time cycle is obtained after the solution of op11 op2 and op12 when the constraint given by equation 5 is satisfied the following time periods are proposed for the solution of the op3 t 1 0 12 t 2 12 24 t 3 24 36 and t 4 36 48 the average values of fi are obtained and shown in figure 9 b after the first time interval fi shows a drastic change in its average value representing that the system loses information on this first period while reaching a constant regime on the following three time periods to study these changes on the averaged fi values the optimal profiles for the thirteen compartments in the socio economic ecological model are shown in figures 10 10 a 10 b 10 c and 10 d figure 10 a presents a gradual increase of producer 1 influencing the growth of herbivore 1 in figure 10 b and indirectly the growth carnivore 1 in figure 10 c figure 10 a shows that the level of producer 2 for the first time interval t 1 0 12 highlighted on the light gray shaded area increases by consuming more mass from the resource pool figure 10 d to then start decreasing when the herbivores in figure 10 b and the energy producer in figure 10 c start consuming its available mass the levels of herbivores 2 and 3 in figure 10 b decrease in response to their consumption by the carnivores 1 and 2 in figure 10 c since these predators are only controlled by natural death and not by predation carnivore 1 shows a steeply increase through time which is also true for the omnivore human households as shown in figure 10 d since the omnivore mass is increasing the demand and production of goods from the industrial and energy sector also slowly increasing as shown in figure 10 c this industrial sector availability is controlled by the optimal profiles of the control variables given in figure 11 where we observe that producer 1 sends a constant fraction of its mass while the energy producer reduces the fraction of mass exchanged due to the reduction on its mass availability these profiles indicate that the system regime is maintained due to the availability of mass from the resource pool which continues feeding the system before it reaches to zero figure 10 d when the resource pool gets closer to zero the system can not be maintained anymore and fi loses more information this lost on fi values indicate that the system with no more available resources cannot be sustained and becomes disorganized and unstable 6 conclusion this work presents and implements a numerical optimal control based approach to the determination of fisher information in particular the algorithm intends to estimate the time period t cycle used to calculate fi when a periodic behavior of the dynamic system is considered as an additional result the algorithm also estimates the time averaged values of fisher information which are used as a tool to analyze the ecological system regimes and their shifts the proposed algorithm assumes a periodic behavior of the system and involves the successive solution of a series of optimal control problems which are solved through the discretization of the differential equations and the use of a nlp local optimizer since no global optimal solutions are found an incorrect estimation of t cycle could be obtained if there are multiple critical points with the same value for the basis variable within a one cycle period this is included as one of the limitations of the approach to illustrate the proposed approach a simple predator prey model was solved first the results show that for a periodic system the maximization and minimization of the reference variable allow the calculation of t cycle to extend the use of the proposed approach in a much more larger problem a complex socio ecological economical model is proposed and solved showing the results that the time averaged fisher information values can be used to analyze regime shifts in the system the state variables profiles for this complex example show that at the beginning of the simulation the time averaged fisher information values are higher and start decreasing when the compartments in the model start interacting with each other a drop in the time averaged fisher information value is observed when the main producer of the system resource pool starts disappearing meaning that the system is losing its dynamic order and hence it is becoming less sustainable many literature reports discuss the potential use of fisher information as metrics for the sustainability of a dynamic system the focus of our work is not to provide additional evidence of that statement the aim of this work is to provide a tool for achieving theoretical consistency on the estimation of fi in other words for periodic system t should not be arbitrarily defined to estimate fi t should be defined in terms of the time period of one cycle although t can be any number of cycles three interesting topics remain to be further studied as future work one refers to analyze the effect of regime shifts on t cycle i e t cycle might not be a constant through the entire time horizon the second issue is of course a continued effort to assess the value of fisher information as a metric for sustainability finally caution should be taken about extending the use of this algorithm for complex real world problems although given a dynamic model of any size the approach suggested could be attempted several problems could be envisioned such as the computationally effort required the numerical problems associated to achieve convergence on a large scale highly non linear model and the potential complexities associated to local optimality acknowledgments the authors are grateful for the financial support provided by conacyt mexico for the development of this work appendix a the initial conditions and constant parameters used in the 13 compartment model equations in section 4 are given in tables 2 3 and 4 the notation for the state variables y is as follows 1 for producer 1 2 for producer 2 3 for producer 3 4 for herbivore 1 5 for herbivore 2 6 for herbivore 3 7 for carnivore 1 8 for carnivore 2 9 for resource pool 10 for inaccessible resource pool 11 for omnivore 12 for the industrial sector and 13 for the energy sector 2 3 4 
