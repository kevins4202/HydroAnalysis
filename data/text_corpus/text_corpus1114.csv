index,text
5570,stochastic storm transposition sst involves resampling and random geospatial shifting i e transposition of observed storm events to generate hypothetical but realistic rainstorms though developed as a probabilistic alternative to probable maximum precipitation pmp and sharing pmp s storm transposition characteristic sst can also be used in more typical rainfall frequency analysis rfa and flood frequency analysis ffa applications this paper explains the method discusses its origins and linkages to both pmp and rfa ffa and reviews the development of sst research over the past six decades discussion topics includes the relevance of recent advances in precipitation remote sensing to frequency analysis numerical weather prediction and distributed rainfall runoff modeling uncertainty and boundedness in rainfall and floods the flood frequency challenges posed by climatic and land use change and the concept of multi scale flood frequency recent literature has shown that process based multiscale ffa in which the joint distributions of flood producing meteorological and hydrological processes are synthesized and resolved using distributed physics based rainfall runoff models provides a useful framework for translating nonstationary hydroclimatic conditions into flood frequency estimates sst pairs well with the process based approaches this pairing is promising because it can leverage advances from other branches of hydrology and hydrometeorology that appear to be difficult to integrate into better known rfa and ffa approaches the paper closes with several recommendations for future sst research and applications keywords extreme rainfall floods rainfall frequency analysis flood frequency analysis rainfall remote sensing stochastic hydrology 1 introduction the estimation of flood flows emerged in the early twentieth century as a core challenge in hydrology spurred by a dam building boom which in the u s ran from roughly 1910 to the 1970s beyond dam spillway design these estimates are used for the sizing of stormwater and flood control infrastructure and for floodplain mapping the objective is usually to determine a flood quantile i e the peak discharge or volume associated with a particular annual exceedance probability aep a flood with aep 0 01 corresponds to the 100 year flood the quantile estimation process is referred to as flood frequency analysis ffa the related practice for rainfall is referred to as rainfall frequency analysis rfa there are two widely known approaches to ffa national research council 1988 the first flood based statistical ffa involves fitting a probability distribution to extreme values typically annual maxima of multi decadal streamflow records the desired quantile can then be obtained from that distribution the second uses representations of one or more rainstorms as input to a rainfall runoff hydrologic model to produce simulated flood peaks or hydrographs the most common starting point for model based approaches is intensity duration frequency idf information which describes the probability distribution of extreme rainfall depths or rates and is generated using similar methods to statistical ffa idealized or observed spatial or temporal patterns are often used to disaggregate a rainfall quantile into a more realistic hypothetical storm the resulting design storm is then used as input to a rainfall runoff model which has been initialized using a prescribed soil moisture condition this combination of idf and a rainfall runoff model with an assumed initial soil moisture is referred to as the design storm method e g curtis et al 2013a b packman and kidd 1980 both idf estimation and flood based statistical ffa are station based in that the observations and resulting predictions are made at individual fixed locations rain gages or stream gages national research council 1994 while a rain gage measurement may reflect the passage of a rainstorm and a streamflow measurement may reflect the result of that rainstorm s interactions with hillslopes and river networks neither observation explicitly considers the complex space time rainfall structure and its interactions with watershed feature such as varying terrain and river channels idf estimation and flood based statistical ffa face certain limitations 1 long term records of rainfall or flood extremes may not yield accurate aep estimates for current or future conditions due to climatic and land use changes 2 their station based nature offers limited insight into the joint meteorological and hydrologic processes highly variable in space and time that cause floods and that dictate their probability of occurrence 3 these station based methods are formulated such that it is difficult to integrate recent advances from adjacent branches of hydrology and meteorology such as precipitation remote sensing numerical weather prediction and in the case of ffa distributed hydrologic modeling a separate class of methods has also evolved for high risk infrastructure such as large dams and nuclear power facilities probable maximum precipitation pmp and probable maximum flood pmf pmp pmf methods differ from typical rfa ffa in two ways 1 they do not yield exceedance probabilities but rather theoretical or practical upper bounds of rainfall and floods and 2 they are storm based rather than station based the largest conceivable rainstorm for a watershed of interest the pmp is developed based on theoretical arguments regional scale observations and assumptions hansen 1987 pmp estimation explicitly uses rainfall spatiotemporal structure often in the form of rainfall fields i e rainfall maps at regular time steps pmf by extension considers this rainfall s interaction with watershed features by routing it through a rainfall runoff model rainstorm structure including fine scale variability and motion is an important determinant of flood response e g arnoud et al 2002 meierdiercks et al 2010 mejia and moglen 2010 morin et al 2006 norbiato et al 2007 ramos et al 2005 sivapalan et al 1987 smith et al 2005 2002 yang et al 2013 explicit consideration of rainfall structure means that storm based methods such as pmp unlike station based methods can incorporate advances in both meteorological understanding and observations such as radar satellites and numerical weather prediction national research council 1994 see abbs 1999 ohara et al 2011 for pmp examples important limitations of pmp pmf are 1 the use of single values without an exceedance probability makes them unsuitable for hydrologic risk analyses ball et al 2019 swain et al 2006 usbr and usace 2018 and 2 developing the largest conceivable rainstorm necessarily involves the analyst s subjectivity e g dawdy and lettenmaier 1987 both the distinctions between statistical rfa ffa and pmp pmf and their limitations raise two questions can we leverage spatiotemporal observations of extreme rainstorms probabilistically to perform storm based rfa and can we combine such an approach with rainfall runoff modeling for ffa in this paper we examine stochastic storm transposition sst a technique developed to answer these questions we review developments over 60 years that indicate sst can address the limitations of both rfa ffa and pmp pmf incidentally sst is as old as the journal of hydrology though the term wasn t coined until fontaine and potter 1989 alexander 1963 introduced the concept in volume 1 issue 1 of this journal historical and conceptual links of sst to other ffa methods and to pmp pmf are discussed in section 2 section 3 describes the sst methodology in section 4 we review more than six decades of peer reviewed sst research some important considerations limitations and useful properties of sst are discussed in section 5 we conclude in section 6 with some recommendations for future directions of sst research and applications 2 historical background early researchers noted that rainfall records tended to be more numerous and often longer than those of flood flows miami conservancy district 1917 this implied that the estimation of extreme flood flows probabilistic or otherwise could be improved by considering extreme rainfall observations nonetheless records of extreme rainfall over individual watersheds even today tend to be limited to at most a handful of notable events making it difficult to characterize the upper tail of rainfall and flood hazard using these records alone as a response two ways have emerged to use rainfall and flood observations from a wider region to support ffa the first regionalized frequency analysis involves leveraging nearby rainfall or streamflow observations to increase the robustness of statistical parameter or quantile estimates at a specific location or to produce estimates at ungaged locations in the streamflow case this is referred to as regional flood frequency analysis rffa we use the term regional rainfall frequency analysis rrfa for rainfall applications these contrast with at site ffa or rfa which only use local observations at the site of interest rffa and rrfa are still station based they use point observations and produce point predictions fuller 1914 introduced what is believed to be the first formula for estimating flood quantiles 1 q t q 1 0 8 log 10 t where q is the mean annual flood peak t is the return period the reciprocal of the aep and q t is the flood peak estimate corresponding to t fuller calculated the empirical coefficient 0 8 using flood observations from across the non arid u s in other words the first flood frequency formula was an rffa formula research has continued ever since see requena et al 2019 stephenson et al 2016 for recent examples and both rffa and rrfa are commonplace in applications we point readers to dawdy et al 2012 and svensson and jones 2010 for further information on rffa and rrfa respectively the second approach to using regional information is flood or storm transposition rather than use nearby observations to support statistical parameter or quantile estimation transposition involves moving storm or flood observations to the watershed of interest and evaluating the result fuller 1914 solved eq 1 for t using available annual maxima flood observations and found that the largest of these observations yielded estimates of t in excess of 1000 years when preparing a dam spillway design in a new location he therefore advocated using t 1000 years since evidence of such floods was available in observational records myers 1969 points out that fuller was thus implicitly recommending transposing a property t of observed floods to new locations while the transposition of flood events poses theoretical and practical challenges transposition of rainstorms is more straightforward myers 1966 myers 1969 summarized the advantages a rainfall is much less dependent on the underlying topography than is peak discharge its transposition is therefore more physically realistic and accurate b precipitation records are in many instances longer and more comprehensive than discharge records c the isohyets of a storm may be centered precisely over a basin or in a number of different positions over a basin a flexibility not available in discharge transposition these factors contributed to deterministic storm transposition being proposed as an element of flood estimation meyer 1917 woodward 1920 and becoming an integral part in the evolution of pmp pmf methods bernard 1936 showalter and solot 1942 by the 1940s pmp pmf rather than the probabilistic methods of fuller and his successors had become the preferred approach for spillway design in the united states myers 1969 and these methods were also adopted by nascent nuclear power industry england 2011 meanwhile probabilistic approaches continued to be widely used for applications in which less extreme return periods e g 10 1 to 10 3 were relevant hershfield 1961 and miller 1964 for example provided nationwide rainfall idf maps for return periods up to 100 years while the national flood insurance program started in 1968 focused on risk management within 100 year floodplains knowles and kunreuther 2014 interest also renewed in probabilistic estimation of extremely rare storms and floods national research council 1994 1988 motivated by unease at the level of subjectivity in pmp estimation which could potentially result in costly designs or retrofitting alexander 1963 dawdy and lettenmaier 1987 yeac 1984 some federal agencies in the u s england 2011 swain et al 1998 and elsewhere ball et al 2019 wilson et al 2011 now use a combination of deterministic and probabilistic approaches for dam safety risk analysis and risk informed decision making usbr 2013 it was one such probabilistic foray into the realm of aep 10 3 that conceived sst alexander 1969 1963 see section 4 1 it should be noted that other probabilistic approaches generally monte carlo in their nature have also emerged e g beran 1973 charalambous et al 2013 muzik 1993 rahman et al 2002 schaefer and barker 2002 stephens et al 2016 thorough review of these other approaches is beyond the scope of this study many of the considerations and challenges that we explore in this review however are also relevant to those techniques examples include storm spatiotemporal structures and pairing them with seasonally varying probabilistic watershed initial conditions for flood simulation 3 sst methodology 3 1 the basics sst includes the following key elements defining a transposition domain developing an extreme storm catalog randomly transposing storms in a region over a watershed and estimating rainfall or flood probabilities the concept shown schematically in fig 1 can be briefly summarized observed storms are transposed at random within a transposition domain of area ad in such a way that new unobserved realizations of extreme rainfall over the domain are produced in doing so new realizations of extreme rainfall are created for a watershed of area aw that resides within this domain the space time structure of rainstorms including intensities areas and movement is preserved sst can be understood as a bootstrap method in which resampling from a catalog of observed storms is followed by random transposition of the newly generated sample of storms the details are described in sections 3 2 through 3 5 3 2 defining a meteorologically homogeneous transposition domain storm transposition is only defensible insofar as the storm could have occurred at that location with some nonzero probability chow 1964 defined a homogeneous region also referred to as a transposition domain as the area surrounding the given river basin in which storm producing factors are substantially comparable i e the general area within which meteorological influences and topography are sufficiently alike the transposition domain shown in fig 1 is square and centered around the watershed but this need not be the case see for example fig 2 a which shows an example transposition domain for hurricane harvey and new orleans louisiana gupta 1972 argued that a transposition domain could include a very large geographic area in the eastern half of the united states where topographic relief is generally moderate and it may include relatively small areas in the western united states where extreme topography is encountered the issue of regional homogeneity is not unique to sst rffa and rrfa must also wrestle with it e g hosking and wallis 1993 for sst to be of value the transposition domain must be sufficiently large that it includes multiple observed extreme rainstorms if the domain is very large relative to the size of the watershed of interest however the probability of transposing one of these rainstorms over the watershed is small alexander 1963 introduced a simple equation that shows this 2 p tr a w a d where ptr is the probability that the centroid of a storm from a transposition domain ad will be transposed over a watershed of area aw see fig 1 though eq 2 is an incomplete description of the true process since a storm could produce nonzero rainfall over a basin even if its centroid falls outside the basin boundary it can be nonetheless instructive some implications of eq 2 are discussed in sections 3 4 and 5 2 3 3 creating a storm catalog from spatial rainfall observations sst considers multiple storms that have occurred within the transposition domain for the watershed of interest this set of storms is henceforth referred to as a storm catalog most sst studies have used rainfall observations from rain gage networks often expressed as depth area duration dad curves or tables that depict rainfall depth or rate as a function of averaging area and duration by using dad information along with assumptions of storm geometry the labor of drawing or digitizing paper based rainfall maps and then transposing them can be avoided a useful source of both dad tables and rainfall maps has been usace 1973 which includes information on nearly 600 major u s storms starting in the 1880s though impressive in length and level of detail this volume nonetheless has shortcomings it has relatively fewer storms in the western u s and the evolution of rain gages over that time period means that the record does not provide a consistent picture of major storm activity even in the eastern part of the country such inconsistencies pose potential problems for sst foufoula georgiou 1989 national research council 1988 since the resampling described in section 3 4 implicitly assumes that the storm catalog reflects the true extreme rainfall hydroclimate within the transposition domain advances in rainfall remote sensing using ground based radar and satellites offer alternative data sources for storm catalog creation an example of the spatially detailed depiction of regional rainfall provided by radar remote sensing is shown in fig 2b for hurricane harvey which struck the southeastern texas coast in august 2017 sections 4 4 and 5 1 discusses some potential strengths of these new data sources for sst 3 4 storm resampling and transposition the main objective of sst to estimate rainfall or flood aeps is achieved by resampling from the storm catalog to generate large numbers of realizations of extreme rainstorms over the watershed of interest these realizations should synthesize new realistic annual patterns of rainstorms over the transposition domain and by extension over the watershed to do this a random number of storms k is generated by modeling the annual arrival process of storms over the domain the storm arrival process is usually assumed to follow either a bernoulli or poisson distribution with an arrival rate λ m n storms per year where m is the number of storms in the storm catalog and n is the length of the record in years from which the catalog was generated note the restrictions 0 λ 1 and k 0 1 if a bernoulli distribution is used meaning that m n this makes the bernoulli arrival process suitable only if small values of m are used as a consequence p tr eq 2 will be relatively low and many realizations of transposed rainfall will thus be small or zero this can be seen in fig 2c d in which little and no rainfall is produced for new orleans louisiana for two possible transpositions of hurricane harvey fig 2e meanwhile shows a transposition that produces extreme rainfall over new orleans this feature makes the bernoulli arrival model suitable only for estimation of very low aeps such as those needed for spillway design the magnitude of more common events will be greatly underestimated this restriction is lifted if a poisson distribution is used though as discussed in section 5 2 underestimation of the magnitude of more common events can nonetheless result if m is not sufficiently large no sst study to date has sought to model the temporal sequencing of these k storms meaning that to use the parlance of rainfall runoff modeling sst has thus far only been event based e g chu and steinman 2009 the k storms are randomly sampled from the storm catalog and randomly transposed within the transposition domain a single transposition is shown schematically in fig 1 three possible transpositions of 72 hour rainfall from hurricane harvey are shown in fig 2c e all rainfall fields or isohyets that constitute a storm are transposed by a north south distance δ y and an east west distance δ x which are randomly selected from distributions dy and dx respectively these distributions jointly describe the spatial probability of storm occurrence the notion of a homogeneous transposition domain implies that the probabilities of random placement of transposed storms should be equal throughout the transposition domain i e that dy and dx are uniform relaxation of this stricture allows larger values of ad and thus m but could introduce bias since rainfall properties would not be strictly homogeneous this issue was discussed in very general terms by alexander 1963 who wrote that the basic problem is to preserve only the essential statistical features of the area by discarding those which may be ascribed to sampling errors several more recent schemes have provided ways to either modify the storm transposition probability or storm magnitude to limit these biases nathan et al 2016 wilson and foufoula georgiou 1990 wright et al 2017 zhou et al 2019 once transposed the k resulting rainfall amounts over the watershed are computed the largest of these can be understood as a synthetic annual rainfall maxima which form the basis of aep estimation 3 5 estimating rainfall and flood quantiles unlike statistical ffa and rfa it is not necessary to fit distributions to the synthetic annual maxima in order to obtain aeps rather aeps can be estimated directly from the ranked synthetic annual maxima using plotting position formulae for example 1000 annual maxima generated through sst would facilitate direct estimation of aeps as low as 10 3 uncertainty bounds can be obtained by generating multiple such sets of realizations fig 2f for example shows an sst based idf curve for new orleans in which 100 sets of 1000 annual maxima each were generated the shaded area denotes the spread among these 100 sets obtaining flood quantiles requires the use of a rainfall runoff model but flood aeps are otherwise computed in the same manner there need not be a 1 1 correspondence between rainfall and flood aep if rainfall spatiotemporal structure is considered or if watershed initial conditions such as soil moisture are treated as random variables franchini et al 1996 gupta 1972 wright et al 2017 yu et al 2019 a brief graphical summary of the step by step procedure described in section 3 is shown in fig 3 4 review of sst developments and applications 4 1 early theoretical development 1963 1972 sst originated in australia where preference for pmp pmf was not as strongly rooted as in the united states alexander 1969 alexander s 1963 initial study focused mainly on the probability of transposing a storm event over a watershed given their respective spatial scales and the size of the transposition domain e g eq 2 though some empirical properties of dad were mentioned no results were provided the paper outlined the basic concept of a homogeneous region identified relevant spatial and temporal scales and described the bernoulli storm arrival process shape and orientation of storms were neglected alexander 1969 followed by discussing additional aspects including the meteorological rationale used to select a transposition domain in the australian state of victoria this second study also showed results of rainfall depth vs aep as low as 10 4 for an unspecified watershed in victoria gupta 1972 provided a more detailed treatment including discussion though not results of its extension to the frequency analysis of flood volumes he introduced the poisson arrival model and suggested that second order storm properties orientation shape within storm temporal distribution etc were also important considerations his procedure included stochastic rotation of transposed rainfall fields which were then run through a simple rainfall runoff model the storm catalog consisted of five storms in the midwestern u s and the rainfall runoff model considered seasonally appropriate initial conditions though these initial conditions were not treated as random variables it was recommended that future studies do so echoing other contemporary work on non sst probabilistic ffa e g beran 1973 he proposed that stochastic simulation of storms could be used to augment the limited size of a storm catalog notably his thesis also presented a practical computer oriented methodology of transposing storms of a region and a historical sample to any river basin inside that region though the lack of probabilistic results implies that this methodology stopped somewhat short of a fully realized sst software something that would not emerge until much later 4 2 theoretical and practical advances 1984 1996 interest in sst renewed in the 1980s this was spurred by a technical study from the yankee atomic electric company yeac 1984 that study used a variant of sst to assess the likelihood that harriman dam in vermont in the northeastern u s would be overtopped thus threatening a downstream nuclear facility it was motivated by disagreement over pmp estimates for the 520 km2 watershed which ranged from 14 in to over 22 in in 24 h this study showed that the dad based sst procedure produced more credible extreme rainfall frequency estimates than conventional rfa and demonstrated how reservoir initial conditions could be randomized based on historical records the yeac 1984 report featured prominently in a comprehensive report on rare flood quantile estimation published by the national research council 1988 which went so far as to propose its own sst approach fontaine and potter 1989 compared the yeac 1984 and national research council 1988 approaches for aeps approaching 10 6 using a catalog of four major storms in the midwestern u s the authors argued that there is a need to develop a more formal theoretical framework but also that requirements of strict homogeneity should be relaxed to maximize the potential size of the transposition domain they also argued that uncertainty estimation including errors in rainfall observations should be considered and echoed gupta s 1972 recommendation that stochastic simulation of storm events could be useful for enlarging the storm catalog this latter recommendation was picked up in foufoula georgiou 1989 who introduced a stochastic model to simulate elliptical storms using dad and geometric information from usace 1973 this model could produce arbitrary numbers of storms including ones with higher rainfall magnitudes larger spatial extents etc the random variables used in the storm model were maximum rainfall depth at the storm center orientation of the ellipsis major axis the ratio of major to minor axes and two parameters describing the decay of rainfall depth with distance from the storm center this formulation thus precluded non elliptical or multi cell storms and did not incorporate temporal rainfall structure or motion the author evaluated several aspects related to the probability of catchment rainfall by transposing elliptical representations of 18 observed storms from the midwestern u s over idealized watershed shapes and geometries this stochastic rainfall model was fully implemented in wilson and foufoula georgiou 1990 and was parameterized using a larger set of 65 storms they also linked this model to a nonhomogeneous point process that jointly modeled storm occurrence location fig 4 and peak rainfall depth easing the need for a homogeneous transposition domain they estimated rainfall aeps lower than 10 12 over hypothetical circular 100 mi2 catchments showing that the combination of the stochastic storm and point process models could qualitatively reproduce the spatial patterns exhibited by existing pmp studies in the region they also assessed sensitivity of the method to storm eccentricity and to incomplete storm catalogs franchini et al 1996 applied the method of wilson and foufoula georgiou 1990 to estimate the frequency of peak flows using a lumped rainfall runoff model to incorporate rainfall temporal structure they probabilistically disaggregated 24 hour storm totals to finer time scales using dimensionless temporal distributions they examined the sensitivity of ffa to initial soil moisture though a lack of observations precluded its representation as a random variable even for very extreme events this sensitivity was high the aep associated with the 400 m3 s 1800 m3 s flood peak ranged from 10 1 10 3 for saturated conditions to roughly 10 3 10 5 for dry conditions they also showed importance of rainfall temporal distribution in determining flood peaks thus highlighting that flood magnitude and thus flood frequency strongly depend on characteristics beyond simply rainfall depth 4 3 recent sst efforts for rare storms and floods nathan et al 1999 and agho et al 2000 investigated the potential of sst in southeastern australia the authors documented challenges addressing homogeneity while transposing storms in the region this line of work continued to evolve in nathan et al 2016 who used sst and another stochastic method to estimate the aep of existing pmp values for two watersheds in southeastern australia their aep estimates ranged from 10 5 and 10 6 depending on the method and watershed they used a 114 year gridded rain gage dataset to generate elliptical storm events a key contribution was the elaboration of dimensionless sst in which storm rainfall r i transposed from location i to location j is rendered dimensionless by dividing by an index quantile i i q and then rescaled by i j q to obtain a transposed rainfall value r j 3 r j i j q i i q r i dimensionless sst provides a straightforward means for relaxing the strictures of transposition domain selection since transposed rainfall is rescaled according to a measure of the local extreme rainfall climatology this allowed them to use a very large transposition domain that covered much of southeastern australia dimensionless sst may render nonuniform transposition probabilities unnecessary at least in practice since it implicitly accounts for spatial variability in storm frequency as well as intensity the ratio i j q i i q will be sensitive to errors in quantile estimates the authors used at site estimates of the 50 year rainfall quantile to compute this ratio such a high quantile may be prone to substantial sampling error this can also be said for earlier efforts agho et al 2000 nathan et al 1999 which used areal pmp estimates to rescale ri nathan et al 2016 state that dimensionless sst deserves further research this could include evaluation of less uncertain index quantiles such as the 2 year or 5 year rainfall wright and holman 2019 it should be noted that rescaling by an index quantile is common practice in rffa and rrfa specifically in the index flood approach e g stedinger et al 1993 england et al 2014 examined ffa in the 12 000 km2 arkansas river watershed upstream of pueblo colorado in the western u s by combining sst based rainfall events with a distributed physics based rainfall runoff model sst based results are presented alongside flood based statistical ffa estimates of several historical floods and paleoflood data fig 5 this integration of collaborative work in hydrometeorology flood hydrology and paleoflood hydrology is noteworthy for several reasons 1 it was the first to generate sst based ffa estimates for a relatively large watershed in mountainous terrain 2 it was among the first to combine sst with a physics based distributed hydrologic model wright et al 2014 appeared in the same year 3 it highlighted that transposition domain selection and watershed interaction in complex terrain can have a major influence on results this contrasts with wright et al 2013b 2017 who reported only modest sensitivities in less topographically complex regions and 4 its usage of multiple sources of probabilistic flood estimates provided an interesting demonstration uncertainty estimation through to use a legal term preponderance of evidence which can increase the credibility and resulting confidence in the results swain et al 1998 4 4 rainfall remote sensing multi scale ffa and rainyday the sst studies reviewed thus far sought to estimate rare rainfall and flood probabilities mainly for dam safety dams can be understood as point scale features since the concern is generally a single distribution of rainfall or flood discharge upstream of the facility levee systems transportation networks and stormwater systems on the other hand are multi scale flood distributions may be needed at many locations along the drainage network many applications in such contexts are focused on more common events e g aep 10 3 wright et al 2013b introduced an sst methodology for estimating rainfall idf curves using a high resolution 10 year radar rainfall dataset results were shown for watersheds from 2 5 to 240 km2 and for durations from 1 to 12 h in charlotte north carolina with idf curves tailored to the specific watershed size shape and orientation these idf curves reflected the effects of storm structure and motion and the authors showed that the temporal and spatial rainfall averages represented by these idfs masked considerable variability in the spatiotemporal properties of the transposed rainstorms used to derive them they argued that rainfall remote sensing is the key to assessing this variability since few rain gage networks are dense enough to sample fine scale rainfall structure sst s storm based nature also allowed the authors to examine how storm hydroclimate influenced idf estimates finding that for short durations and small areas tropical cyclones are insignificant contributors to extreme rainfall distributions in charlotte while their importance grows with duration and watershed size wright et al 2014 extended this analysis to multiscale ffa for an urbanized 110 km2 watershed using a detailed physically based distributed hydrologic model when combined with high resolution rainfall scenarios the interactions of second order rainfall properties with land cover river channels and the urban storm drain network could be translated into ffa this circumvents the design storm assumption of 1 1 equivalency of rainfall and runoff return period eliminates the need to carefully link design storm duration to watershed characteristics such as the time of concentration and captures the intra event aep variability that can occur across the river network they also argued that the combination of sst with physically based models opens opportunities for modeling future flood frequencies in nonstationary land use or climate conditions wright et al 2017 detailed rainyday an open source python based sst software see wright 2019 for source code rainyday is based on the methodology of wright et al 2013b 2014 subsequent software updates include the dimensionless sst of nathan et al 2016 and an alternative rescaling approach outlined in wright and holman 2019 wright et al 2017 demonstrated rfa and ffa results using ground based radar rainfall and several satellite based datasets the distributed hillslope link model hlm krajewski et al 2017 mantilla and gupta 2005 was used in conjunction with rainyday in turkey river a 4000 km2 watershed in the midwestern u s that has exhibited flood nonstationarity in recent decades rainyday ffa estimates were more consistent with recent peak discharge observations than rffa results published by the us geological survey fig 6 wright et al 2017 was also the first sst study to treat antecedent watershed conditions specifically soil moisture and channel flow as random variables it should be noted that other non sst probabilistic ffa studies had previously considered this issue see for example charalambous et al 2013 muzik 1993 rahman et al 2002 schaefer and barker 2002 zhou et al 2019 present an investigation of rainfall heterogeneity and its consequences for rfa in the region surrounding baltimore maryland in the u s mid atlantic the rainfall hydroclimate there is influenced by the chesapeake bay to the southeast the topographic gradient leading to the appalachian mountain ranges to the northwest and localized urban rainfall modification smith et al 2012 they used the rainyday software to examine the impact of this heterogeneity on the extreme storm hydroclimatology and hydrometeorology and on idf estimates to account for regional heterogeneities in extreme rainfall rainfall r i transposed from location i to location j was rescaled according to the ratio 4 r j r j r i r i where r i is the mean rainfall of all storms in the storm catalog from location i a stochastic generalization of zhou et al s 2019 approach was introduced in wright and holman 2019 who compared it against the index quantile ratio method eq 3 from nathan et al 2016 zhu et al 2018 examined the importance of rainfall spatiotemporal structure in flood frequency using the combination of rainyday and hlm from wright et al 2017 they also examined how this importance is modulated by soil moisture a set of 10 000 high resolution rainfall scenarios were used to simulate flood frequency at 5000 subwatersheds of the 4000 km2 turkey river watershed as were three additional sets generated by downsampling to coarser spatial and temporal resolutions complex relationships were found between rainfall structure watershed scale and initial soil moisture their results suggest that rainfall structure is an important control on real world flood frequency and that ffa efforts that simplify this structure may underestimate flood risk especially for smaller scale watersheds this confirms that high resolution rainfall remote sensing datasets are valuable when combined with sst and distributed hydrologic models yu et al 2019 introduced a more thorough approach to sst based ffa for the same watershed evaluated in wright et al 2017 and zhu et al 2018 a library of seasonally varying soil moisture and seasonal snowpack conditions was created via a long term continuous hydrologic simulation initial conditions were then sampled from this library paired with rainyday based transposed storms from the same season and run through a simple lumped conceptual rainfall runoff model though their framework is generalizable to more complex models seasonally realistic joint distributions of rainfall soil moisture and snowpack were thus preserved and translated into ffa results they refer to this approach as process based ffa which is discussed further in section 5 6 they showed that seasonal shifts in soil moisture snowpack and extreme rainfall explain the recent upward trend in large scale floods and downward trend in more common floods in turkey river using the same combination of rainyday sst radar rainfall and hlm as wright et al 2017 perez et al 2019 conducted a synthetic analysis of commonly used statistical at site and regional ffa methods 10 000 simulated annual maximum flood peaks at 5000 locations within turkey river formed a synthetic population of flood peaks this combination of tools allowed for explicit simulation of the interactions between rainfall spatiotemporal variability with watershed and river channel morphology subsets of this population were then created representing samples of various sizes e g 10 years 30 years etc and in the case of rffa methods various numbers of sites the robustness of several commonly used ffa rffa methods were then compared as a function of sample size and number of sites this contrasts with previous efforts to assess statistical rffa methods which have relied on simplistic assumptions regarding the regional variability of flood peaks perez et al 2019 found that the difficulty of estimating distributional shape or skew a major challenge in rffa can be partially explained by the river network structure and the orientation of the watershed relative to prevailing storm directions the approach shows how sst can facilitate the use of recent advances in other branches of hydrology and other fields e g distributed models rainfall remote sensing to better understand and potentially improve or replace existing ffa methods 5 discussion 5 1 rainfall data and sst sparse rain gage networks can fail to adequately sample fine scale rainfall variability such as localized precipitation events and the locations of peak storm intensity e g curtis 2007 foufoula georgiou 1989 this lack of detail may limit rain gages direct applicability to multi scale ffa the recent sst studies reviewed in section 4 4 show the merit of coupling sst with weather radar data due to the latter s depiction of rainfall variability at high spatial and temporal resolution on the other hand a lack of long term records radar records and the need for careful bias correction places limits on radar s broad usefulness to estimate rainfall and flood aeps 10 1 to 10 3 it appears that at least one decade of radar rainfall data is needed estimation of rarer aeps may require longer records other remote sensing based rfa attempts exist using station based methods see faridzad et al 2018 mcgraw et al 2019 and references therein those methods appear to be more sensitive to the relative shortness of remote sensing records than sst the potential of satellites and numerical weather prediction nwp models for sst have received little and no attention respectively but these data sources are currently showing improvements in terms of resolution accuracy and record length the latest satellite datasets for example offer relatively long records 2 decades at higher resolution and improved accuracy relative to previous generations convection permitting regional climate models rcms are now able to be run for decadal periods at higher spatial and temporal resolutions e g prein et al 2015 recent multi decadal atmospheric reanalysis datasets have resolutions sufficient for some rfa and ffa applications e g toride et al 2018 rcms and reanalyses have the potential to perform better than radar or satellites in complex terrain e g wright 2018 both satellite datasets and nwp provide the potential for sst in regions such as developing countries where both rain gage networks and weather radar are lacking though most sst studies have listed data quality as critical its influence on sst has only partially been evaluated foufoula georgiou 1989 wilson and foufoula georgiou 1990 wright et al 2013b while rainfall measurement using any instrument is nontrivial national research council 1994 radar satellite and nwp based estimates are typified by large errors presently all the sources of rainfall measurements mentioned above are heavily reliant on rain gages to identify and eliminate biases thus the rain gage networks that were critical for early sst work are as essential now the current decline in rain gage networks worldwide e g stokstad 1999 thus poses a threat to the future of sst and rfa ffa more generally wright et al 2017 pointed out that sst and other regional methods are able to improve more quickly than at site frequency analysis as new extreme events are observed since these observations need not have occurred over the watershed of interest this logic extends backwards as well notwithstanding challenges data homogeneity the prospect of combining recent rainfall records with older isohyetal maps and dad observations holds the allure of providing very long rainfall records for sst england et al 2014 shows an example of this this prospect is perhaps not far off at least in the u s since usace 1973 and other records of old storm information have been or are currently being digitized 5 2 aep uncertainty and boundedness in sst suppose the sst resampling and transposition described in section 3 4 is repeated to create 100 000 annual maxima when converting these to aep estimates section 3 5 the analyst can rank these maxima to obtain probabilities as low as 10 5 or subdivide these into 100 samples and thus obtain 100 estimates for each aep down to 10 3 studies focusing on very rare floods sections 4 1 to 4 3 have done the former while the recent studies in section 4 4 do the latter clearly the former does not give the true population of all possible rainstorms and floods while the latter does not represent the full real world uncertainty about these quantities the side by side comparison of multiple ffa methods by england et al 2014 showed one practical pathway to better grapple with such uncertainty sst using observed rainstorms will have an upper bound associated with the largest rainstorm in the storm catalog transposed to maximize the rainfall over the watershed of interest wright et al 2013b 2017 this upper bound is the result of sampling error i e incomplete knowledge of the true population of extreme rainstorms upper bounds in sst should not be confused with upper boundedness in real rainfall and flood processes which has been a topic of lively debate in the hydrologic community for nearly a century see smith and baeck 2015 and references therein an interesting question however is whether sst can bring new insights to that debate linkages between generation and sampling from storm catalogs and the asymptotic behavior of extrema that is the focus of extreme value statistics e g davison and huser 2015 may be worth exploring quite separate from the question of upper bounds is the existence of a lower bound or bias which is an artifact of the sst procedure there is a nonzero probability that a transposed storm will cause no rainfall at all over the watershed of interest e g fig 2c this is especially true if via eq 2 a w a d is small under a bernoulli arrival model this would translate to a synthetic rainfall maxima of zero under a poisson model zero rainfall remains a potential outcome nonzero but still small synthetic annual maxima are relatively likely in both models and are clearly unrealistic this issue is unimportant when the objective is the estimation of very rare events for the studies reviewed in section 3 4 however this is a major problem since more common aeps are an objective this can be remedied by using a large storm catalog which increases the poisson arrival rate wright et al 2017 recommended a catalog with at least m 10 n storms while the current version of the rainyday software defaults to m 20 n bias associated with this effect can be seen in fig 7 in sst based results for aep 0 5 which used m 14 3 n 5 3 spatial considerations of rainfall and flood extremes beyond very small catchment areas the spatial dimensions of storm events become increasingly important in flooding e g marston 1924 taken alone rain gage based idf curves are therefore unsuitable for ffa aside from in small catchments since the statistics of point rainfall can differ dramatically from those of watershed scale rainfall to compensate for this analysts can employ area reduction factors arfs to estimate areal rainfalls from point scale idf information wright et al 2013a showed that typical arf methods are conceptually flawed in ways that are not easily remedied estimation of spatial idf curves is often challenging because of the required density of long term contemporaneous rain gage observations sst s storm based nature provides an alternative method for estimating rainfall idfs for spatial scales beyond a single rain gage fig 7 and obviate the usage of arfs these scales can be relatively small down to a single rainfall remote sensing grid cell e g 1 km2 for ground based weather radar to 100 km2 for satellite or reanalysis datasets despite sst s ability to produce idf estimates such estimates need not be an intermediate step in sst based ffa rather transposed rainfall fields should be used directly as inputs to rainfall runoff modeling preserving observed space time structure and enabling multi scale ffa while sst holds distinct advantages for rfa and ffa at spatial scales beyond small watersheds there is likely an upper limit to the areas over which it can be applied gupta 1972 pointed out that large basins can have pronounced differences in meteorological and topographic influences which may make the transposition of storms unrealistic he suggested that this might constrain sst to watersheds smaller than 1000 square miles 2600 km2 recent sst studies particularly england et al 2014 underline that this limit might be larger than gupta speculated nonetheless sst is almost certainly not applicable for continental scale river basins such as the mississippi or amazon without modification floods in continental river basins are generally not the result of individual storms but rather of spatially and temporally clustered events occurring over periods of weeks to months and covering spatial scales as high as 106 km2 these storms may occur in climatologically distinct regions rendering the notion of a single transposition domain unworkable one could in principal create a storm catalog comprised of the most rainy multi week periods and conduct sst using these the number of available events would be small if month long storm periods were used to create a storm catalog for example the number of events would be at most 12 times the length of the rainfall record in years few of these storm catalog entries would be particularly important from a flood generation standpoint second transposition of a month long rainy period may not yield sufficient realizations of rainfall spatiotemporal variability since the individual storm elements within this period are fixed in their relative locations and timing the reshuffling of individual storm elements in space and time to create new realizations may be possible but poses conceptual and practical challenges 5 4 other event based and continuous rainfall generators an alternative to sst for generating large numbers of hypothetical rainfall events is to develop a point or basin scale idf curve randomly sample quantiles from this curve and combine these quantiles with spatial or temporal rainfall patterns from observed storms examples of this include charalambous et al 2013 and schaefer and barker 2002 this requires a collection of observed storm events as well as the ability to estimate either areal averaged idfs or arfs not necessarily easy to do see section 5 3 the approach implicitly assumes that the annual rainfall maxima provided by idf curves lead to annual flood maxima this may be adequate for estimating rare flood quantiles it is problematic for more common events yu et al 2019 as far as we are aware existing examples of the approach have assumed that rainfall quantiles and spatiotemporal structures can be considered to be independent stochastic rainfall generators srgs are another way to generate hypothetical realizations of rainfall they attempt to simulate rainfall variability so that one could generate potentially many thousands of years of rainfall sharma and mehrotra 2010 while sst involves transposing observed storms srgs rely on rainfall observations for training and validation the stochastic storm model of foufoula georgiou 1989 and wilson and foufoula georgiou 1990 is one example but most generate continuous sequences rather than individual storms continuous srgs have been used for ffa e g blazkova and beven 2002 cameron et al 1999 peleg et al 2017 while most srgs have been either point based or provide areal averaged rainfall more detailed models provide high detail in both space and time e g paschalis et al 2013 peleg and morin 2014 spatially explicit srgs are preferable for ffa since fine scale variability is an important determinant of flood response paschalis et al 2014 zhu et al 2018 like sst these srgs also facilitate multi scale ffa e g peleg et al 2017 and process based ffa the key test for both sst and srgs is whether they can faithfully represent the extreme tail of rainfall magnitude and associated spatiotemporal variability this test is arguably easier passed in the sst paradigm which relies directly on observed rainfall properties srgs must depict these processes using space time statistics and have historically struggled to reproduce extremes furrer and katz 2008 willems et al 2012 to date no detailed comparison of sst and an srg for rfa or ffa has been conducted furthermore no effort since wilson and foufoula georgiou 1990 has sought to merge progress in srgs with sst 5 5 process based ffa and flood nonstationarity to our knowledge the term process based ffa was first introduced in sivapalan and samuel 2009 but the general approach has been previously referred to as derived ffa e g eagleson 1972 franchini et al 2005 haberlandt et al 2008 and physically based ffa e g díaz granados et al 1984 muzik 1993 shen et al 1990 briefly introduced in section 4 4 process based ffa merits further discussion essentially it aims to construct distributions of flood outcomes by recreating the joint distributions of the relevant flood producing processes rainfall watershed states such as soil moisture and snowpack surface and subsurface flow and river channel routing a key aspect of these joint distributions is seasonality in the midwestern u s for example snowpack usually persists only into march while soil moisture peaks in march april and peak rainfall rates occur in june august yu et al 2019 this means that floods usually occur sometime in march august but the specific combinations of processes that cause them can vary dramatically over this timeframe nonstationarity particularly climatic change manifests as changes in seasonality of one or more processes this implies that process based approaches may be necessary for translating nonstationarity in the hydrologic cycle into nonstationarity in flood frequency the results of wright et al 2017 and yu et al 2019 show the potential of sst combined with process based approaches in one watershed exhibiting hydrologic nonstationarity here we demonstrate the opportunity to examine the relative roles of rainfall and antecedent soil in determining flood peak variability fig 8 using rainyday with stage iv gage corrected radar rainfall and the wrf hydro distributed hydrologic model gochis et al 2018 in contrast with process based ffa flood based statistical methods do not explicitly consider the physical processes that produce floods wright et al 2014 rather the sample of flood observations used in those methods represent outcomes of combinations of these processes whether this sample space adequately describes the population of possible floods that could result from different combinations is unknowable furthermore how these combinations change with spatial scale and with climate or land use change is not clear from streamflow records alone thus it is not obvious how to generate estimates of future flood quantiles even using nonstationary statistical models sivapalan and samuel 2009 stedinger and griffis 2011 the rainfall runoff models used in design storm methods can explicitly represent important process interactions to a degree design storms require strong assumptions regarding the joint distributions of these processes however including 1 an annual maximum flood peak result from rainfall annual maxima even though a smaller rainstorm plus wetter initial conditions could produce an annual maximum 2 a single antecedent soil moisture value is sufficient to understand flood outcomes even though real world soil moisture is variable and 3 a rainfall idf quantile translates directly to the same flood quantile i e a 100 year storm produces a 100 year flood the consequences of these assumptions are not well understood adams and howard 1986 curtis et al 2013a b packman and kidd 1980 wright et al 2014 2013a b hydrologic practice has been well served by both statistically based and design storm based ffa due to their strengths and also to healthy doses of conservatism in engineering design practices both are starting to show their age however published idf estimates have been shown to be out of date often severely underestimating the frequency of extreme rainfalls in the u s chin and ross 2018 wright et al 2019 and elsewhere e g madsen et al 2014 though the issue of flood nonstationarity is less clear e g sharma et al 2018 recent work has argued that future progress on rffa will require more careful consideration of watershed geomorphology ayalew and krajewski 2017 and hydrometeorology smith et al 2018 consistent with the conclusions of the national research council 1994 storm based approaches such as sst together with process based ffa are better positioned than conventional station based approaches to leverage advances in distributed modeling and in rainfall remote sensing and numerical simulation 5 6 multiscale ffa the concept of multi scale ffa was briefly introduced in section 4 4 there are applications in which flood quantiles across an entire drainage network are needed rather than for an individual river reach or gage location such applications include mapping of floodplains and the design of levee and stormwater systems in addition it can be useful to be able to model flood scenarios that resolve the spatial distribution of impacts within an individual flood event applications that can benefit from this capability include probabilistic risk assessment stress testing of actively managed hydrologic infrastructure such as reservoirs or evaluation of transportation network response to flood impacts on bridges or roadways in such applications depiction of a wide range of storm events with realistic spatiotemporal distribution of rainfall across the watershed and the ability to resolve the resulting flood response using distributed rainfall runoff modeling is essential e g pilgrim 1986 sst and some other methods see section 5 4 are able to do these things provided that adequate input rainfall data are available a well performing rainfall runoff model is used and suitable approaches are employed to account for variability in initial conditions thus the concepts of multiscale ffa and process based ffa are linked the former requires the latter while the latter requires the former if scale dependent interactions in flood generating mechanisms are to be properly considered we demonstrate several examples of process based sst generated using rainyday together with stage iv rainfall and wrf hydro including the distribution of specific flood quantiles across the river network fig 9 a b also shown are two random storm transpositions with very different rainfall patterns fig 9c d and spatial patterns of resulting flood peak discharges fig 9e f despite having both produced 100 year peak discharges at the watershed outlet at garber iowa 5 7 rainfall runoff models for ffa both design storm methods and the process based and multiscale ffa described in sections 5 5 and 5 6 rely on rainfall runoff hydrologic models a common criticism is that parameter and structural uncertainty in such models is unacceptably large while these can indeed be problematic we provide several counterarguments first the confidence intervals provided in flood based statistical ffa methods understate the true uncertainty inherent in such methods by ignoring the potentially major role of rating curve errors potter and walker 1985 when these errors are considered uncertainty has been shown to balloon dramatically steinbakk et al 2016 second there have been numerous demonstrations that rainfall runoff ffa methods can perform as well or better than statistical methods in cases of basin storage discontinuities rogger et al 2012 reservoirs ayalew et al 2013 and land use or climatic change cunha et al 2011 third at least some blame for poor model performance lies on the precipitation and other meteorological inputs the role of rainfall runoff model error has not yet been studied in sst based ffa and would presumably yield wider uncertainty bounds than those shown in existing studies the non sst ffa work of blazkova and beven 2009 2002 and cameron et al 1999 provide a possible roadmap for considering model errors 6 summary and recommendations in this review we summarize the origins of stochastic storm transposition sst in the context of three better known forms of rainfall and flood hazard estimation regionalized rainfall and flood frequency analysis design storms and pmp pmf we briefly explain the methodology review existing research discuss some of sst s properties strengths and limitations and contrast it with other methods in the six decades since alexander s 1963 description of sst in issue 1 of the journal of hydrology the problem of estimating the likelihood and magnitude of floods has not been solved indeed climate change economic growth and urbanization mean that risks have and will likely continue to grow kundzewicz et al 2014 at the same time recent experiences have identified weaknesses in longstanding methods for rfa ffa and pmp pmf climatic and land cover changes are particularly challenging as a storm based approach built explicitly around the spatiotemporal variability of rainfall sst holds promise to address these issues critically it is able to leverage advances from other branches of hydrology and from related fields such as meteorology including distributed hydrologic modeling and remote sensing and numerical simulation of extreme rainfall example rfa and ffa applications for watersheds in louisiana iowa wisconsin maryland colorado and southeastern australia have demonstrated the practical utility of sst for floodplain management and dam safety while six decades of research into the concept suggests that sst is a viable complement to existing approaches important questions remain we conclude with five areas for future work 1 a chief criticism of sst is the subjectivity involved in defining the transposition domain definition of transposition domains based on climatological characteristics combined with modest rescaling of storms represent a reasonable compromise between the desire for large domains and the need for approximate homogeneity previous sst work has begun to address this nathan et al 2016 wilson and foufoula georgiou 1990 wright et al 2019 zhou et al 2019 but more is needed methods from related fields such as regionalized l moments hosking and wallis 1997 should be considered 2 errors from rainfall measurements extreme storm sampling and rainfall runoff modeling should be examined to understand the propagation of such errors through to sst based ffa estimates these errors should be compared side by side with those resulting from flood based statistical ffa to better understand the relative strengths and limits of each method the bayesian approach used in steinbakk et al 2016 both highlights the importance of error propagation in ffa and provides a roadmap for studying it 3 england et al 2014 showed that sst can be used alongside other methods to develop a preponderance of evidence approach to ffa while perez et al 2019 showed that sst based ffa can help to evaluate other methodologies more explicit merging of sst with other rfa ffa approaches and rainfall estimation techniques is likely to prove valuable an example of the former could be the usage of sst to help estimate the skewness of rainfall and flood distributions a major challenge in conventional ffa examples of the latter could include integration of sst and modern high resolution stochastic rainfall generators and explicit coupling of sst with numerical weather prediction models that can explicitly simulate rainfall in complex terrain 4 process based and multi scale ffa concepts can connect flood processes to flood distributions including in nonstationary conditions though previous studies have begun to explore these connections rigorous interpretation of results in terms of hydrologic processes such as runoff generation mechanisms and channel routing has been lacking a key question is whether a return to the simplified storm and watershed representations of early sst work could prove illuminating in this effort or if real world process complexities would limit the value of such idealizations 5 finally while sst research has been generally confined to the united states and australia the need for rainfall and flood frequency estimation is widespread while global precipitation estimates using satellites and atmospheric reanalyses are improving to the point that they may be useful in rfa and ffa applications validation of these results in ungaged regions remains a challenge nonetheless numerous regions around the globe spanning diverse hydroclimatic and socioeconomic conditions have at least some high quality rainfall and flood observations partnerships with researchers and end users in those regions would help to explore the potential for sst to go global declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors thank stephen j burges and james a smith for their help in identifying pioneering early rainfall and flood studies daniel wright s and guo yu s efforts were supported by the u s national science foundation hydrologic sciences program career project ear 1749638 and by the u s department of the interior bureau of reclamation research and development office project 1735 the authors would like to acknowledge the support of the various funding organizations that have facilitated the sst research that is reviewed in this paper 
5570,stochastic storm transposition sst involves resampling and random geospatial shifting i e transposition of observed storm events to generate hypothetical but realistic rainstorms though developed as a probabilistic alternative to probable maximum precipitation pmp and sharing pmp s storm transposition characteristic sst can also be used in more typical rainfall frequency analysis rfa and flood frequency analysis ffa applications this paper explains the method discusses its origins and linkages to both pmp and rfa ffa and reviews the development of sst research over the past six decades discussion topics includes the relevance of recent advances in precipitation remote sensing to frequency analysis numerical weather prediction and distributed rainfall runoff modeling uncertainty and boundedness in rainfall and floods the flood frequency challenges posed by climatic and land use change and the concept of multi scale flood frequency recent literature has shown that process based multiscale ffa in which the joint distributions of flood producing meteorological and hydrological processes are synthesized and resolved using distributed physics based rainfall runoff models provides a useful framework for translating nonstationary hydroclimatic conditions into flood frequency estimates sst pairs well with the process based approaches this pairing is promising because it can leverage advances from other branches of hydrology and hydrometeorology that appear to be difficult to integrate into better known rfa and ffa approaches the paper closes with several recommendations for future sst research and applications keywords extreme rainfall floods rainfall frequency analysis flood frequency analysis rainfall remote sensing stochastic hydrology 1 introduction the estimation of flood flows emerged in the early twentieth century as a core challenge in hydrology spurred by a dam building boom which in the u s ran from roughly 1910 to the 1970s beyond dam spillway design these estimates are used for the sizing of stormwater and flood control infrastructure and for floodplain mapping the objective is usually to determine a flood quantile i e the peak discharge or volume associated with a particular annual exceedance probability aep a flood with aep 0 01 corresponds to the 100 year flood the quantile estimation process is referred to as flood frequency analysis ffa the related practice for rainfall is referred to as rainfall frequency analysis rfa there are two widely known approaches to ffa national research council 1988 the first flood based statistical ffa involves fitting a probability distribution to extreme values typically annual maxima of multi decadal streamflow records the desired quantile can then be obtained from that distribution the second uses representations of one or more rainstorms as input to a rainfall runoff hydrologic model to produce simulated flood peaks or hydrographs the most common starting point for model based approaches is intensity duration frequency idf information which describes the probability distribution of extreme rainfall depths or rates and is generated using similar methods to statistical ffa idealized or observed spatial or temporal patterns are often used to disaggregate a rainfall quantile into a more realistic hypothetical storm the resulting design storm is then used as input to a rainfall runoff model which has been initialized using a prescribed soil moisture condition this combination of idf and a rainfall runoff model with an assumed initial soil moisture is referred to as the design storm method e g curtis et al 2013a b packman and kidd 1980 both idf estimation and flood based statistical ffa are station based in that the observations and resulting predictions are made at individual fixed locations rain gages or stream gages national research council 1994 while a rain gage measurement may reflect the passage of a rainstorm and a streamflow measurement may reflect the result of that rainstorm s interactions with hillslopes and river networks neither observation explicitly considers the complex space time rainfall structure and its interactions with watershed feature such as varying terrain and river channels idf estimation and flood based statistical ffa face certain limitations 1 long term records of rainfall or flood extremes may not yield accurate aep estimates for current or future conditions due to climatic and land use changes 2 their station based nature offers limited insight into the joint meteorological and hydrologic processes highly variable in space and time that cause floods and that dictate their probability of occurrence 3 these station based methods are formulated such that it is difficult to integrate recent advances from adjacent branches of hydrology and meteorology such as precipitation remote sensing numerical weather prediction and in the case of ffa distributed hydrologic modeling a separate class of methods has also evolved for high risk infrastructure such as large dams and nuclear power facilities probable maximum precipitation pmp and probable maximum flood pmf pmp pmf methods differ from typical rfa ffa in two ways 1 they do not yield exceedance probabilities but rather theoretical or practical upper bounds of rainfall and floods and 2 they are storm based rather than station based the largest conceivable rainstorm for a watershed of interest the pmp is developed based on theoretical arguments regional scale observations and assumptions hansen 1987 pmp estimation explicitly uses rainfall spatiotemporal structure often in the form of rainfall fields i e rainfall maps at regular time steps pmf by extension considers this rainfall s interaction with watershed features by routing it through a rainfall runoff model rainstorm structure including fine scale variability and motion is an important determinant of flood response e g arnoud et al 2002 meierdiercks et al 2010 mejia and moglen 2010 morin et al 2006 norbiato et al 2007 ramos et al 2005 sivapalan et al 1987 smith et al 2005 2002 yang et al 2013 explicit consideration of rainfall structure means that storm based methods such as pmp unlike station based methods can incorporate advances in both meteorological understanding and observations such as radar satellites and numerical weather prediction national research council 1994 see abbs 1999 ohara et al 2011 for pmp examples important limitations of pmp pmf are 1 the use of single values without an exceedance probability makes them unsuitable for hydrologic risk analyses ball et al 2019 swain et al 2006 usbr and usace 2018 and 2 developing the largest conceivable rainstorm necessarily involves the analyst s subjectivity e g dawdy and lettenmaier 1987 both the distinctions between statistical rfa ffa and pmp pmf and their limitations raise two questions can we leverage spatiotemporal observations of extreme rainstorms probabilistically to perform storm based rfa and can we combine such an approach with rainfall runoff modeling for ffa in this paper we examine stochastic storm transposition sst a technique developed to answer these questions we review developments over 60 years that indicate sst can address the limitations of both rfa ffa and pmp pmf incidentally sst is as old as the journal of hydrology though the term wasn t coined until fontaine and potter 1989 alexander 1963 introduced the concept in volume 1 issue 1 of this journal historical and conceptual links of sst to other ffa methods and to pmp pmf are discussed in section 2 section 3 describes the sst methodology in section 4 we review more than six decades of peer reviewed sst research some important considerations limitations and useful properties of sst are discussed in section 5 we conclude in section 6 with some recommendations for future directions of sst research and applications 2 historical background early researchers noted that rainfall records tended to be more numerous and often longer than those of flood flows miami conservancy district 1917 this implied that the estimation of extreme flood flows probabilistic or otherwise could be improved by considering extreme rainfall observations nonetheless records of extreme rainfall over individual watersheds even today tend to be limited to at most a handful of notable events making it difficult to characterize the upper tail of rainfall and flood hazard using these records alone as a response two ways have emerged to use rainfall and flood observations from a wider region to support ffa the first regionalized frequency analysis involves leveraging nearby rainfall or streamflow observations to increase the robustness of statistical parameter or quantile estimates at a specific location or to produce estimates at ungaged locations in the streamflow case this is referred to as regional flood frequency analysis rffa we use the term regional rainfall frequency analysis rrfa for rainfall applications these contrast with at site ffa or rfa which only use local observations at the site of interest rffa and rrfa are still station based they use point observations and produce point predictions fuller 1914 introduced what is believed to be the first formula for estimating flood quantiles 1 q t q 1 0 8 log 10 t where q is the mean annual flood peak t is the return period the reciprocal of the aep and q t is the flood peak estimate corresponding to t fuller calculated the empirical coefficient 0 8 using flood observations from across the non arid u s in other words the first flood frequency formula was an rffa formula research has continued ever since see requena et al 2019 stephenson et al 2016 for recent examples and both rffa and rrfa are commonplace in applications we point readers to dawdy et al 2012 and svensson and jones 2010 for further information on rffa and rrfa respectively the second approach to using regional information is flood or storm transposition rather than use nearby observations to support statistical parameter or quantile estimation transposition involves moving storm or flood observations to the watershed of interest and evaluating the result fuller 1914 solved eq 1 for t using available annual maxima flood observations and found that the largest of these observations yielded estimates of t in excess of 1000 years when preparing a dam spillway design in a new location he therefore advocated using t 1000 years since evidence of such floods was available in observational records myers 1969 points out that fuller was thus implicitly recommending transposing a property t of observed floods to new locations while the transposition of flood events poses theoretical and practical challenges transposition of rainstorms is more straightforward myers 1966 myers 1969 summarized the advantages a rainfall is much less dependent on the underlying topography than is peak discharge its transposition is therefore more physically realistic and accurate b precipitation records are in many instances longer and more comprehensive than discharge records c the isohyets of a storm may be centered precisely over a basin or in a number of different positions over a basin a flexibility not available in discharge transposition these factors contributed to deterministic storm transposition being proposed as an element of flood estimation meyer 1917 woodward 1920 and becoming an integral part in the evolution of pmp pmf methods bernard 1936 showalter and solot 1942 by the 1940s pmp pmf rather than the probabilistic methods of fuller and his successors had become the preferred approach for spillway design in the united states myers 1969 and these methods were also adopted by nascent nuclear power industry england 2011 meanwhile probabilistic approaches continued to be widely used for applications in which less extreme return periods e g 10 1 to 10 3 were relevant hershfield 1961 and miller 1964 for example provided nationwide rainfall idf maps for return periods up to 100 years while the national flood insurance program started in 1968 focused on risk management within 100 year floodplains knowles and kunreuther 2014 interest also renewed in probabilistic estimation of extremely rare storms and floods national research council 1994 1988 motivated by unease at the level of subjectivity in pmp estimation which could potentially result in costly designs or retrofitting alexander 1963 dawdy and lettenmaier 1987 yeac 1984 some federal agencies in the u s england 2011 swain et al 1998 and elsewhere ball et al 2019 wilson et al 2011 now use a combination of deterministic and probabilistic approaches for dam safety risk analysis and risk informed decision making usbr 2013 it was one such probabilistic foray into the realm of aep 10 3 that conceived sst alexander 1969 1963 see section 4 1 it should be noted that other probabilistic approaches generally monte carlo in their nature have also emerged e g beran 1973 charalambous et al 2013 muzik 1993 rahman et al 2002 schaefer and barker 2002 stephens et al 2016 thorough review of these other approaches is beyond the scope of this study many of the considerations and challenges that we explore in this review however are also relevant to those techniques examples include storm spatiotemporal structures and pairing them with seasonally varying probabilistic watershed initial conditions for flood simulation 3 sst methodology 3 1 the basics sst includes the following key elements defining a transposition domain developing an extreme storm catalog randomly transposing storms in a region over a watershed and estimating rainfall or flood probabilities the concept shown schematically in fig 1 can be briefly summarized observed storms are transposed at random within a transposition domain of area ad in such a way that new unobserved realizations of extreme rainfall over the domain are produced in doing so new realizations of extreme rainfall are created for a watershed of area aw that resides within this domain the space time structure of rainstorms including intensities areas and movement is preserved sst can be understood as a bootstrap method in which resampling from a catalog of observed storms is followed by random transposition of the newly generated sample of storms the details are described in sections 3 2 through 3 5 3 2 defining a meteorologically homogeneous transposition domain storm transposition is only defensible insofar as the storm could have occurred at that location with some nonzero probability chow 1964 defined a homogeneous region also referred to as a transposition domain as the area surrounding the given river basin in which storm producing factors are substantially comparable i e the general area within which meteorological influences and topography are sufficiently alike the transposition domain shown in fig 1 is square and centered around the watershed but this need not be the case see for example fig 2 a which shows an example transposition domain for hurricane harvey and new orleans louisiana gupta 1972 argued that a transposition domain could include a very large geographic area in the eastern half of the united states where topographic relief is generally moderate and it may include relatively small areas in the western united states where extreme topography is encountered the issue of regional homogeneity is not unique to sst rffa and rrfa must also wrestle with it e g hosking and wallis 1993 for sst to be of value the transposition domain must be sufficiently large that it includes multiple observed extreme rainstorms if the domain is very large relative to the size of the watershed of interest however the probability of transposing one of these rainstorms over the watershed is small alexander 1963 introduced a simple equation that shows this 2 p tr a w a d where ptr is the probability that the centroid of a storm from a transposition domain ad will be transposed over a watershed of area aw see fig 1 though eq 2 is an incomplete description of the true process since a storm could produce nonzero rainfall over a basin even if its centroid falls outside the basin boundary it can be nonetheless instructive some implications of eq 2 are discussed in sections 3 4 and 5 2 3 3 creating a storm catalog from spatial rainfall observations sst considers multiple storms that have occurred within the transposition domain for the watershed of interest this set of storms is henceforth referred to as a storm catalog most sst studies have used rainfall observations from rain gage networks often expressed as depth area duration dad curves or tables that depict rainfall depth or rate as a function of averaging area and duration by using dad information along with assumptions of storm geometry the labor of drawing or digitizing paper based rainfall maps and then transposing them can be avoided a useful source of both dad tables and rainfall maps has been usace 1973 which includes information on nearly 600 major u s storms starting in the 1880s though impressive in length and level of detail this volume nonetheless has shortcomings it has relatively fewer storms in the western u s and the evolution of rain gages over that time period means that the record does not provide a consistent picture of major storm activity even in the eastern part of the country such inconsistencies pose potential problems for sst foufoula georgiou 1989 national research council 1988 since the resampling described in section 3 4 implicitly assumes that the storm catalog reflects the true extreme rainfall hydroclimate within the transposition domain advances in rainfall remote sensing using ground based radar and satellites offer alternative data sources for storm catalog creation an example of the spatially detailed depiction of regional rainfall provided by radar remote sensing is shown in fig 2b for hurricane harvey which struck the southeastern texas coast in august 2017 sections 4 4 and 5 1 discusses some potential strengths of these new data sources for sst 3 4 storm resampling and transposition the main objective of sst to estimate rainfall or flood aeps is achieved by resampling from the storm catalog to generate large numbers of realizations of extreme rainstorms over the watershed of interest these realizations should synthesize new realistic annual patterns of rainstorms over the transposition domain and by extension over the watershed to do this a random number of storms k is generated by modeling the annual arrival process of storms over the domain the storm arrival process is usually assumed to follow either a bernoulli or poisson distribution with an arrival rate λ m n storms per year where m is the number of storms in the storm catalog and n is the length of the record in years from which the catalog was generated note the restrictions 0 λ 1 and k 0 1 if a bernoulli distribution is used meaning that m n this makes the bernoulli arrival process suitable only if small values of m are used as a consequence p tr eq 2 will be relatively low and many realizations of transposed rainfall will thus be small or zero this can be seen in fig 2c d in which little and no rainfall is produced for new orleans louisiana for two possible transpositions of hurricane harvey fig 2e meanwhile shows a transposition that produces extreme rainfall over new orleans this feature makes the bernoulli arrival model suitable only for estimation of very low aeps such as those needed for spillway design the magnitude of more common events will be greatly underestimated this restriction is lifted if a poisson distribution is used though as discussed in section 5 2 underestimation of the magnitude of more common events can nonetheless result if m is not sufficiently large no sst study to date has sought to model the temporal sequencing of these k storms meaning that to use the parlance of rainfall runoff modeling sst has thus far only been event based e g chu and steinman 2009 the k storms are randomly sampled from the storm catalog and randomly transposed within the transposition domain a single transposition is shown schematically in fig 1 three possible transpositions of 72 hour rainfall from hurricane harvey are shown in fig 2c e all rainfall fields or isohyets that constitute a storm are transposed by a north south distance δ y and an east west distance δ x which are randomly selected from distributions dy and dx respectively these distributions jointly describe the spatial probability of storm occurrence the notion of a homogeneous transposition domain implies that the probabilities of random placement of transposed storms should be equal throughout the transposition domain i e that dy and dx are uniform relaxation of this stricture allows larger values of ad and thus m but could introduce bias since rainfall properties would not be strictly homogeneous this issue was discussed in very general terms by alexander 1963 who wrote that the basic problem is to preserve only the essential statistical features of the area by discarding those which may be ascribed to sampling errors several more recent schemes have provided ways to either modify the storm transposition probability or storm magnitude to limit these biases nathan et al 2016 wilson and foufoula georgiou 1990 wright et al 2017 zhou et al 2019 once transposed the k resulting rainfall amounts over the watershed are computed the largest of these can be understood as a synthetic annual rainfall maxima which form the basis of aep estimation 3 5 estimating rainfall and flood quantiles unlike statistical ffa and rfa it is not necessary to fit distributions to the synthetic annual maxima in order to obtain aeps rather aeps can be estimated directly from the ranked synthetic annual maxima using plotting position formulae for example 1000 annual maxima generated through sst would facilitate direct estimation of aeps as low as 10 3 uncertainty bounds can be obtained by generating multiple such sets of realizations fig 2f for example shows an sst based idf curve for new orleans in which 100 sets of 1000 annual maxima each were generated the shaded area denotes the spread among these 100 sets obtaining flood quantiles requires the use of a rainfall runoff model but flood aeps are otherwise computed in the same manner there need not be a 1 1 correspondence between rainfall and flood aep if rainfall spatiotemporal structure is considered or if watershed initial conditions such as soil moisture are treated as random variables franchini et al 1996 gupta 1972 wright et al 2017 yu et al 2019 a brief graphical summary of the step by step procedure described in section 3 is shown in fig 3 4 review of sst developments and applications 4 1 early theoretical development 1963 1972 sst originated in australia where preference for pmp pmf was not as strongly rooted as in the united states alexander 1969 alexander s 1963 initial study focused mainly on the probability of transposing a storm event over a watershed given their respective spatial scales and the size of the transposition domain e g eq 2 though some empirical properties of dad were mentioned no results were provided the paper outlined the basic concept of a homogeneous region identified relevant spatial and temporal scales and described the bernoulli storm arrival process shape and orientation of storms were neglected alexander 1969 followed by discussing additional aspects including the meteorological rationale used to select a transposition domain in the australian state of victoria this second study also showed results of rainfall depth vs aep as low as 10 4 for an unspecified watershed in victoria gupta 1972 provided a more detailed treatment including discussion though not results of its extension to the frequency analysis of flood volumes he introduced the poisson arrival model and suggested that second order storm properties orientation shape within storm temporal distribution etc were also important considerations his procedure included stochastic rotation of transposed rainfall fields which were then run through a simple rainfall runoff model the storm catalog consisted of five storms in the midwestern u s and the rainfall runoff model considered seasonally appropriate initial conditions though these initial conditions were not treated as random variables it was recommended that future studies do so echoing other contemporary work on non sst probabilistic ffa e g beran 1973 he proposed that stochastic simulation of storms could be used to augment the limited size of a storm catalog notably his thesis also presented a practical computer oriented methodology of transposing storms of a region and a historical sample to any river basin inside that region though the lack of probabilistic results implies that this methodology stopped somewhat short of a fully realized sst software something that would not emerge until much later 4 2 theoretical and practical advances 1984 1996 interest in sst renewed in the 1980s this was spurred by a technical study from the yankee atomic electric company yeac 1984 that study used a variant of sst to assess the likelihood that harriman dam in vermont in the northeastern u s would be overtopped thus threatening a downstream nuclear facility it was motivated by disagreement over pmp estimates for the 520 km2 watershed which ranged from 14 in to over 22 in in 24 h this study showed that the dad based sst procedure produced more credible extreme rainfall frequency estimates than conventional rfa and demonstrated how reservoir initial conditions could be randomized based on historical records the yeac 1984 report featured prominently in a comprehensive report on rare flood quantile estimation published by the national research council 1988 which went so far as to propose its own sst approach fontaine and potter 1989 compared the yeac 1984 and national research council 1988 approaches for aeps approaching 10 6 using a catalog of four major storms in the midwestern u s the authors argued that there is a need to develop a more formal theoretical framework but also that requirements of strict homogeneity should be relaxed to maximize the potential size of the transposition domain they also argued that uncertainty estimation including errors in rainfall observations should be considered and echoed gupta s 1972 recommendation that stochastic simulation of storm events could be useful for enlarging the storm catalog this latter recommendation was picked up in foufoula georgiou 1989 who introduced a stochastic model to simulate elliptical storms using dad and geometric information from usace 1973 this model could produce arbitrary numbers of storms including ones with higher rainfall magnitudes larger spatial extents etc the random variables used in the storm model were maximum rainfall depth at the storm center orientation of the ellipsis major axis the ratio of major to minor axes and two parameters describing the decay of rainfall depth with distance from the storm center this formulation thus precluded non elliptical or multi cell storms and did not incorporate temporal rainfall structure or motion the author evaluated several aspects related to the probability of catchment rainfall by transposing elliptical representations of 18 observed storms from the midwestern u s over idealized watershed shapes and geometries this stochastic rainfall model was fully implemented in wilson and foufoula georgiou 1990 and was parameterized using a larger set of 65 storms they also linked this model to a nonhomogeneous point process that jointly modeled storm occurrence location fig 4 and peak rainfall depth easing the need for a homogeneous transposition domain they estimated rainfall aeps lower than 10 12 over hypothetical circular 100 mi2 catchments showing that the combination of the stochastic storm and point process models could qualitatively reproduce the spatial patterns exhibited by existing pmp studies in the region they also assessed sensitivity of the method to storm eccentricity and to incomplete storm catalogs franchini et al 1996 applied the method of wilson and foufoula georgiou 1990 to estimate the frequency of peak flows using a lumped rainfall runoff model to incorporate rainfall temporal structure they probabilistically disaggregated 24 hour storm totals to finer time scales using dimensionless temporal distributions they examined the sensitivity of ffa to initial soil moisture though a lack of observations precluded its representation as a random variable even for very extreme events this sensitivity was high the aep associated with the 400 m3 s 1800 m3 s flood peak ranged from 10 1 10 3 for saturated conditions to roughly 10 3 10 5 for dry conditions they also showed importance of rainfall temporal distribution in determining flood peaks thus highlighting that flood magnitude and thus flood frequency strongly depend on characteristics beyond simply rainfall depth 4 3 recent sst efforts for rare storms and floods nathan et al 1999 and agho et al 2000 investigated the potential of sst in southeastern australia the authors documented challenges addressing homogeneity while transposing storms in the region this line of work continued to evolve in nathan et al 2016 who used sst and another stochastic method to estimate the aep of existing pmp values for two watersheds in southeastern australia their aep estimates ranged from 10 5 and 10 6 depending on the method and watershed they used a 114 year gridded rain gage dataset to generate elliptical storm events a key contribution was the elaboration of dimensionless sst in which storm rainfall r i transposed from location i to location j is rendered dimensionless by dividing by an index quantile i i q and then rescaled by i j q to obtain a transposed rainfall value r j 3 r j i j q i i q r i dimensionless sst provides a straightforward means for relaxing the strictures of transposition domain selection since transposed rainfall is rescaled according to a measure of the local extreme rainfall climatology this allowed them to use a very large transposition domain that covered much of southeastern australia dimensionless sst may render nonuniform transposition probabilities unnecessary at least in practice since it implicitly accounts for spatial variability in storm frequency as well as intensity the ratio i j q i i q will be sensitive to errors in quantile estimates the authors used at site estimates of the 50 year rainfall quantile to compute this ratio such a high quantile may be prone to substantial sampling error this can also be said for earlier efforts agho et al 2000 nathan et al 1999 which used areal pmp estimates to rescale ri nathan et al 2016 state that dimensionless sst deserves further research this could include evaluation of less uncertain index quantiles such as the 2 year or 5 year rainfall wright and holman 2019 it should be noted that rescaling by an index quantile is common practice in rffa and rrfa specifically in the index flood approach e g stedinger et al 1993 england et al 2014 examined ffa in the 12 000 km2 arkansas river watershed upstream of pueblo colorado in the western u s by combining sst based rainfall events with a distributed physics based rainfall runoff model sst based results are presented alongside flood based statistical ffa estimates of several historical floods and paleoflood data fig 5 this integration of collaborative work in hydrometeorology flood hydrology and paleoflood hydrology is noteworthy for several reasons 1 it was the first to generate sst based ffa estimates for a relatively large watershed in mountainous terrain 2 it was among the first to combine sst with a physics based distributed hydrologic model wright et al 2014 appeared in the same year 3 it highlighted that transposition domain selection and watershed interaction in complex terrain can have a major influence on results this contrasts with wright et al 2013b 2017 who reported only modest sensitivities in less topographically complex regions and 4 its usage of multiple sources of probabilistic flood estimates provided an interesting demonstration uncertainty estimation through to use a legal term preponderance of evidence which can increase the credibility and resulting confidence in the results swain et al 1998 4 4 rainfall remote sensing multi scale ffa and rainyday the sst studies reviewed thus far sought to estimate rare rainfall and flood probabilities mainly for dam safety dams can be understood as point scale features since the concern is generally a single distribution of rainfall or flood discharge upstream of the facility levee systems transportation networks and stormwater systems on the other hand are multi scale flood distributions may be needed at many locations along the drainage network many applications in such contexts are focused on more common events e g aep 10 3 wright et al 2013b introduced an sst methodology for estimating rainfall idf curves using a high resolution 10 year radar rainfall dataset results were shown for watersheds from 2 5 to 240 km2 and for durations from 1 to 12 h in charlotte north carolina with idf curves tailored to the specific watershed size shape and orientation these idf curves reflected the effects of storm structure and motion and the authors showed that the temporal and spatial rainfall averages represented by these idfs masked considerable variability in the spatiotemporal properties of the transposed rainstorms used to derive them they argued that rainfall remote sensing is the key to assessing this variability since few rain gage networks are dense enough to sample fine scale rainfall structure sst s storm based nature also allowed the authors to examine how storm hydroclimate influenced idf estimates finding that for short durations and small areas tropical cyclones are insignificant contributors to extreme rainfall distributions in charlotte while their importance grows with duration and watershed size wright et al 2014 extended this analysis to multiscale ffa for an urbanized 110 km2 watershed using a detailed physically based distributed hydrologic model when combined with high resolution rainfall scenarios the interactions of second order rainfall properties with land cover river channels and the urban storm drain network could be translated into ffa this circumvents the design storm assumption of 1 1 equivalency of rainfall and runoff return period eliminates the need to carefully link design storm duration to watershed characteristics such as the time of concentration and captures the intra event aep variability that can occur across the river network they also argued that the combination of sst with physically based models opens opportunities for modeling future flood frequencies in nonstationary land use or climate conditions wright et al 2017 detailed rainyday an open source python based sst software see wright 2019 for source code rainyday is based on the methodology of wright et al 2013b 2014 subsequent software updates include the dimensionless sst of nathan et al 2016 and an alternative rescaling approach outlined in wright and holman 2019 wright et al 2017 demonstrated rfa and ffa results using ground based radar rainfall and several satellite based datasets the distributed hillslope link model hlm krajewski et al 2017 mantilla and gupta 2005 was used in conjunction with rainyday in turkey river a 4000 km2 watershed in the midwestern u s that has exhibited flood nonstationarity in recent decades rainyday ffa estimates were more consistent with recent peak discharge observations than rffa results published by the us geological survey fig 6 wright et al 2017 was also the first sst study to treat antecedent watershed conditions specifically soil moisture and channel flow as random variables it should be noted that other non sst probabilistic ffa studies had previously considered this issue see for example charalambous et al 2013 muzik 1993 rahman et al 2002 schaefer and barker 2002 zhou et al 2019 present an investigation of rainfall heterogeneity and its consequences for rfa in the region surrounding baltimore maryland in the u s mid atlantic the rainfall hydroclimate there is influenced by the chesapeake bay to the southeast the topographic gradient leading to the appalachian mountain ranges to the northwest and localized urban rainfall modification smith et al 2012 they used the rainyday software to examine the impact of this heterogeneity on the extreme storm hydroclimatology and hydrometeorology and on idf estimates to account for regional heterogeneities in extreme rainfall rainfall r i transposed from location i to location j was rescaled according to the ratio 4 r j r j r i r i where r i is the mean rainfall of all storms in the storm catalog from location i a stochastic generalization of zhou et al s 2019 approach was introduced in wright and holman 2019 who compared it against the index quantile ratio method eq 3 from nathan et al 2016 zhu et al 2018 examined the importance of rainfall spatiotemporal structure in flood frequency using the combination of rainyday and hlm from wright et al 2017 they also examined how this importance is modulated by soil moisture a set of 10 000 high resolution rainfall scenarios were used to simulate flood frequency at 5000 subwatersheds of the 4000 km2 turkey river watershed as were three additional sets generated by downsampling to coarser spatial and temporal resolutions complex relationships were found between rainfall structure watershed scale and initial soil moisture their results suggest that rainfall structure is an important control on real world flood frequency and that ffa efforts that simplify this structure may underestimate flood risk especially for smaller scale watersheds this confirms that high resolution rainfall remote sensing datasets are valuable when combined with sst and distributed hydrologic models yu et al 2019 introduced a more thorough approach to sst based ffa for the same watershed evaluated in wright et al 2017 and zhu et al 2018 a library of seasonally varying soil moisture and seasonal snowpack conditions was created via a long term continuous hydrologic simulation initial conditions were then sampled from this library paired with rainyday based transposed storms from the same season and run through a simple lumped conceptual rainfall runoff model though their framework is generalizable to more complex models seasonally realistic joint distributions of rainfall soil moisture and snowpack were thus preserved and translated into ffa results they refer to this approach as process based ffa which is discussed further in section 5 6 they showed that seasonal shifts in soil moisture snowpack and extreme rainfall explain the recent upward trend in large scale floods and downward trend in more common floods in turkey river using the same combination of rainyday sst radar rainfall and hlm as wright et al 2017 perez et al 2019 conducted a synthetic analysis of commonly used statistical at site and regional ffa methods 10 000 simulated annual maximum flood peaks at 5000 locations within turkey river formed a synthetic population of flood peaks this combination of tools allowed for explicit simulation of the interactions between rainfall spatiotemporal variability with watershed and river channel morphology subsets of this population were then created representing samples of various sizes e g 10 years 30 years etc and in the case of rffa methods various numbers of sites the robustness of several commonly used ffa rffa methods were then compared as a function of sample size and number of sites this contrasts with previous efforts to assess statistical rffa methods which have relied on simplistic assumptions regarding the regional variability of flood peaks perez et al 2019 found that the difficulty of estimating distributional shape or skew a major challenge in rffa can be partially explained by the river network structure and the orientation of the watershed relative to prevailing storm directions the approach shows how sst can facilitate the use of recent advances in other branches of hydrology and other fields e g distributed models rainfall remote sensing to better understand and potentially improve or replace existing ffa methods 5 discussion 5 1 rainfall data and sst sparse rain gage networks can fail to adequately sample fine scale rainfall variability such as localized precipitation events and the locations of peak storm intensity e g curtis 2007 foufoula georgiou 1989 this lack of detail may limit rain gages direct applicability to multi scale ffa the recent sst studies reviewed in section 4 4 show the merit of coupling sst with weather radar data due to the latter s depiction of rainfall variability at high spatial and temporal resolution on the other hand a lack of long term records radar records and the need for careful bias correction places limits on radar s broad usefulness to estimate rainfall and flood aeps 10 1 to 10 3 it appears that at least one decade of radar rainfall data is needed estimation of rarer aeps may require longer records other remote sensing based rfa attempts exist using station based methods see faridzad et al 2018 mcgraw et al 2019 and references therein those methods appear to be more sensitive to the relative shortness of remote sensing records than sst the potential of satellites and numerical weather prediction nwp models for sst have received little and no attention respectively but these data sources are currently showing improvements in terms of resolution accuracy and record length the latest satellite datasets for example offer relatively long records 2 decades at higher resolution and improved accuracy relative to previous generations convection permitting regional climate models rcms are now able to be run for decadal periods at higher spatial and temporal resolutions e g prein et al 2015 recent multi decadal atmospheric reanalysis datasets have resolutions sufficient for some rfa and ffa applications e g toride et al 2018 rcms and reanalyses have the potential to perform better than radar or satellites in complex terrain e g wright 2018 both satellite datasets and nwp provide the potential for sst in regions such as developing countries where both rain gage networks and weather radar are lacking though most sst studies have listed data quality as critical its influence on sst has only partially been evaluated foufoula georgiou 1989 wilson and foufoula georgiou 1990 wright et al 2013b while rainfall measurement using any instrument is nontrivial national research council 1994 radar satellite and nwp based estimates are typified by large errors presently all the sources of rainfall measurements mentioned above are heavily reliant on rain gages to identify and eliminate biases thus the rain gage networks that were critical for early sst work are as essential now the current decline in rain gage networks worldwide e g stokstad 1999 thus poses a threat to the future of sst and rfa ffa more generally wright et al 2017 pointed out that sst and other regional methods are able to improve more quickly than at site frequency analysis as new extreme events are observed since these observations need not have occurred over the watershed of interest this logic extends backwards as well notwithstanding challenges data homogeneity the prospect of combining recent rainfall records with older isohyetal maps and dad observations holds the allure of providing very long rainfall records for sst england et al 2014 shows an example of this this prospect is perhaps not far off at least in the u s since usace 1973 and other records of old storm information have been or are currently being digitized 5 2 aep uncertainty and boundedness in sst suppose the sst resampling and transposition described in section 3 4 is repeated to create 100 000 annual maxima when converting these to aep estimates section 3 5 the analyst can rank these maxima to obtain probabilities as low as 10 5 or subdivide these into 100 samples and thus obtain 100 estimates for each aep down to 10 3 studies focusing on very rare floods sections 4 1 to 4 3 have done the former while the recent studies in section 4 4 do the latter clearly the former does not give the true population of all possible rainstorms and floods while the latter does not represent the full real world uncertainty about these quantities the side by side comparison of multiple ffa methods by england et al 2014 showed one practical pathway to better grapple with such uncertainty sst using observed rainstorms will have an upper bound associated with the largest rainstorm in the storm catalog transposed to maximize the rainfall over the watershed of interest wright et al 2013b 2017 this upper bound is the result of sampling error i e incomplete knowledge of the true population of extreme rainstorms upper bounds in sst should not be confused with upper boundedness in real rainfall and flood processes which has been a topic of lively debate in the hydrologic community for nearly a century see smith and baeck 2015 and references therein an interesting question however is whether sst can bring new insights to that debate linkages between generation and sampling from storm catalogs and the asymptotic behavior of extrema that is the focus of extreme value statistics e g davison and huser 2015 may be worth exploring quite separate from the question of upper bounds is the existence of a lower bound or bias which is an artifact of the sst procedure there is a nonzero probability that a transposed storm will cause no rainfall at all over the watershed of interest e g fig 2c this is especially true if via eq 2 a w a d is small under a bernoulli arrival model this would translate to a synthetic rainfall maxima of zero under a poisson model zero rainfall remains a potential outcome nonzero but still small synthetic annual maxima are relatively likely in both models and are clearly unrealistic this issue is unimportant when the objective is the estimation of very rare events for the studies reviewed in section 3 4 however this is a major problem since more common aeps are an objective this can be remedied by using a large storm catalog which increases the poisson arrival rate wright et al 2017 recommended a catalog with at least m 10 n storms while the current version of the rainyday software defaults to m 20 n bias associated with this effect can be seen in fig 7 in sst based results for aep 0 5 which used m 14 3 n 5 3 spatial considerations of rainfall and flood extremes beyond very small catchment areas the spatial dimensions of storm events become increasingly important in flooding e g marston 1924 taken alone rain gage based idf curves are therefore unsuitable for ffa aside from in small catchments since the statistics of point rainfall can differ dramatically from those of watershed scale rainfall to compensate for this analysts can employ area reduction factors arfs to estimate areal rainfalls from point scale idf information wright et al 2013a showed that typical arf methods are conceptually flawed in ways that are not easily remedied estimation of spatial idf curves is often challenging because of the required density of long term contemporaneous rain gage observations sst s storm based nature provides an alternative method for estimating rainfall idfs for spatial scales beyond a single rain gage fig 7 and obviate the usage of arfs these scales can be relatively small down to a single rainfall remote sensing grid cell e g 1 km2 for ground based weather radar to 100 km2 for satellite or reanalysis datasets despite sst s ability to produce idf estimates such estimates need not be an intermediate step in sst based ffa rather transposed rainfall fields should be used directly as inputs to rainfall runoff modeling preserving observed space time structure and enabling multi scale ffa while sst holds distinct advantages for rfa and ffa at spatial scales beyond small watersheds there is likely an upper limit to the areas over which it can be applied gupta 1972 pointed out that large basins can have pronounced differences in meteorological and topographic influences which may make the transposition of storms unrealistic he suggested that this might constrain sst to watersheds smaller than 1000 square miles 2600 km2 recent sst studies particularly england et al 2014 underline that this limit might be larger than gupta speculated nonetheless sst is almost certainly not applicable for continental scale river basins such as the mississippi or amazon without modification floods in continental river basins are generally not the result of individual storms but rather of spatially and temporally clustered events occurring over periods of weeks to months and covering spatial scales as high as 106 km2 these storms may occur in climatologically distinct regions rendering the notion of a single transposition domain unworkable one could in principal create a storm catalog comprised of the most rainy multi week periods and conduct sst using these the number of available events would be small if month long storm periods were used to create a storm catalog for example the number of events would be at most 12 times the length of the rainfall record in years few of these storm catalog entries would be particularly important from a flood generation standpoint second transposition of a month long rainy period may not yield sufficient realizations of rainfall spatiotemporal variability since the individual storm elements within this period are fixed in their relative locations and timing the reshuffling of individual storm elements in space and time to create new realizations may be possible but poses conceptual and practical challenges 5 4 other event based and continuous rainfall generators an alternative to sst for generating large numbers of hypothetical rainfall events is to develop a point or basin scale idf curve randomly sample quantiles from this curve and combine these quantiles with spatial or temporal rainfall patterns from observed storms examples of this include charalambous et al 2013 and schaefer and barker 2002 this requires a collection of observed storm events as well as the ability to estimate either areal averaged idfs or arfs not necessarily easy to do see section 5 3 the approach implicitly assumes that the annual rainfall maxima provided by idf curves lead to annual flood maxima this may be adequate for estimating rare flood quantiles it is problematic for more common events yu et al 2019 as far as we are aware existing examples of the approach have assumed that rainfall quantiles and spatiotemporal structures can be considered to be independent stochastic rainfall generators srgs are another way to generate hypothetical realizations of rainfall they attempt to simulate rainfall variability so that one could generate potentially many thousands of years of rainfall sharma and mehrotra 2010 while sst involves transposing observed storms srgs rely on rainfall observations for training and validation the stochastic storm model of foufoula georgiou 1989 and wilson and foufoula georgiou 1990 is one example but most generate continuous sequences rather than individual storms continuous srgs have been used for ffa e g blazkova and beven 2002 cameron et al 1999 peleg et al 2017 while most srgs have been either point based or provide areal averaged rainfall more detailed models provide high detail in both space and time e g paschalis et al 2013 peleg and morin 2014 spatially explicit srgs are preferable for ffa since fine scale variability is an important determinant of flood response paschalis et al 2014 zhu et al 2018 like sst these srgs also facilitate multi scale ffa e g peleg et al 2017 and process based ffa the key test for both sst and srgs is whether they can faithfully represent the extreme tail of rainfall magnitude and associated spatiotemporal variability this test is arguably easier passed in the sst paradigm which relies directly on observed rainfall properties srgs must depict these processes using space time statistics and have historically struggled to reproduce extremes furrer and katz 2008 willems et al 2012 to date no detailed comparison of sst and an srg for rfa or ffa has been conducted furthermore no effort since wilson and foufoula georgiou 1990 has sought to merge progress in srgs with sst 5 5 process based ffa and flood nonstationarity to our knowledge the term process based ffa was first introduced in sivapalan and samuel 2009 but the general approach has been previously referred to as derived ffa e g eagleson 1972 franchini et al 2005 haberlandt et al 2008 and physically based ffa e g díaz granados et al 1984 muzik 1993 shen et al 1990 briefly introduced in section 4 4 process based ffa merits further discussion essentially it aims to construct distributions of flood outcomes by recreating the joint distributions of the relevant flood producing processes rainfall watershed states such as soil moisture and snowpack surface and subsurface flow and river channel routing a key aspect of these joint distributions is seasonality in the midwestern u s for example snowpack usually persists only into march while soil moisture peaks in march april and peak rainfall rates occur in june august yu et al 2019 this means that floods usually occur sometime in march august but the specific combinations of processes that cause them can vary dramatically over this timeframe nonstationarity particularly climatic change manifests as changes in seasonality of one or more processes this implies that process based approaches may be necessary for translating nonstationarity in the hydrologic cycle into nonstationarity in flood frequency the results of wright et al 2017 and yu et al 2019 show the potential of sst combined with process based approaches in one watershed exhibiting hydrologic nonstationarity here we demonstrate the opportunity to examine the relative roles of rainfall and antecedent soil in determining flood peak variability fig 8 using rainyday with stage iv gage corrected radar rainfall and the wrf hydro distributed hydrologic model gochis et al 2018 in contrast with process based ffa flood based statistical methods do not explicitly consider the physical processes that produce floods wright et al 2014 rather the sample of flood observations used in those methods represent outcomes of combinations of these processes whether this sample space adequately describes the population of possible floods that could result from different combinations is unknowable furthermore how these combinations change with spatial scale and with climate or land use change is not clear from streamflow records alone thus it is not obvious how to generate estimates of future flood quantiles even using nonstationary statistical models sivapalan and samuel 2009 stedinger and griffis 2011 the rainfall runoff models used in design storm methods can explicitly represent important process interactions to a degree design storms require strong assumptions regarding the joint distributions of these processes however including 1 an annual maximum flood peak result from rainfall annual maxima even though a smaller rainstorm plus wetter initial conditions could produce an annual maximum 2 a single antecedent soil moisture value is sufficient to understand flood outcomes even though real world soil moisture is variable and 3 a rainfall idf quantile translates directly to the same flood quantile i e a 100 year storm produces a 100 year flood the consequences of these assumptions are not well understood adams and howard 1986 curtis et al 2013a b packman and kidd 1980 wright et al 2014 2013a b hydrologic practice has been well served by both statistically based and design storm based ffa due to their strengths and also to healthy doses of conservatism in engineering design practices both are starting to show their age however published idf estimates have been shown to be out of date often severely underestimating the frequency of extreme rainfalls in the u s chin and ross 2018 wright et al 2019 and elsewhere e g madsen et al 2014 though the issue of flood nonstationarity is less clear e g sharma et al 2018 recent work has argued that future progress on rffa will require more careful consideration of watershed geomorphology ayalew and krajewski 2017 and hydrometeorology smith et al 2018 consistent with the conclusions of the national research council 1994 storm based approaches such as sst together with process based ffa are better positioned than conventional station based approaches to leverage advances in distributed modeling and in rainfall remote sensing and numerical simulation 5 6 multiscale ffa the concept of multi scale ffa was briefly introduced in section 4 4 there are applications in which flood quantiles across an entire drainage network are needed rather than for an individual river reach or gage location such applications include mapping of floodplains and the design of levee and stormwater systems in addition it can be useful to be able to model flood scenarios that resolve the spatial distribution of impacts within an individual flood event applications that can benefit from this capability include probabilistic risk assessment stress testing of actively managed hydrologic infrastructure such as reservoirs or evaluation of transportation network response to flood impacts on bridges or roadways in such applications depiction of a wide range of storm events with realistic spatiotemporal distribution of rainfall across the watershed and the ability to resolve the resulting flood response using distributed rainfall runoff modeling is essential e g pilgrim 1986 sst and some other methods see section 5 4 are able to do these things provided that adequate input rainfall data are available a well performing rainfall runoff model is used and suitable approaches are employed to account for variability in initial conditions thus the concepts of multiscale ffa and process based ffa are linked the former requires the latter while the latter requires the former if scale dependent interactions in flood generating mechanisms are to be properly considered we demonstrate several examples of process based sst generated using rainyday together with stage iv rainfall and wrf hydro including the distribution of specific flood quantiles across the river network fig 9 a b also shown are two random storm transpositions with very different rainfall patterns fig 9c d and spatial patterns of resulting flood peak discharges fig 9e f despite having both produced 100 year peak discharges at the watershed outlet at garber iowa 5 7 rainfall runoff models for ffa both design storm methods and the process based and multiscale ffa described in sections 5 5 and 5 6 rely on rainfall runoff hydrologic models a common criticism is that parameter and structural uncertainty in such models is unacceptably large while these can indeed be problematic we provide several counterarguments first the confidence intervals provided in flood based statistical ffa methods understate the true uncertainty inherent in such methods by ignoring the potentially major role of rating curve errors potter and walker 1985 when these errors are considered uncertainty has been shown to balloon dramatically steinbakk et al 2016 second there have been numerous demonstrations that rainfall runoff ffa methods can perform as well or better than statistical methods in cases of basin storage discontinuities rogger et al 2012 reservoirs ayalew et al 2013 and land use or climatic change cunha et al 2011 third at least some blame for poor model performance lies on the precipitation and other meteorological inputs the role of rainfall runoff model error has not yet been studied in sst based ffa and would presumably yield wider uncertainty bounds than those shown in existing studies the non sst ffa work of blazkova and beven 2009 2002 and cameron et al 1999 provide a possible roadmap for considering model errors 6 summary and recommendations in this review we summarize the origins of stochastic storm transposition sst in the context of three better known forms of rainfall and flood hazard estimation regionalized rainfall and flood frequency analysis design storms and pmp pmf we briefly explain the methodology review existing research discuss some of sst s properties strengths and limitations and contrast it with other methods in the six decades since alexander s 1963 description of sst in issue 1 of the journal of hydrology the problem of estimating the likelihood and magnitude of floods has not been solved indeed climate change economic growth and urbanization mean that risks have and will likely continue to grow kundzewicz et al 2014 at the same time recent experiences have identified weaknesses in longstanding methods for rfa ffa and pmp pmf climatic and land cover changes are particularly challenging as a storm based approach built explicitly around the spatiotemporal variability of rainfall sst holds promise to address these issues critically it is able to leverage advances from other branches of hydrology and from related fields such as meteorology including distributed hydrologic modeling and remote sensing and numerical simulation of extreme rainfall example rfa and ffa applications for watersheds in louisiana iowa wisconsin maryland colorado and southeastern australia have demonstrated the practical utility of sst for floodplain management and dam safety while six decades of research into the concept suggests that sst is a viable complement to existing approaches important questions remain we conclude with five areas for future work 1 a chief criticism of sst is the subjectivity involved in defining the transposition domain definition of transposition domains based on climatological characteristics combined with modest rescaling of storms represent a reasonable compromise between the desire for large domains and the need for approximate homogeneity previous sst work has begun to address this nathan et al 2016 wilson and foufoula georgiou 1990 wright et al 2019 zhou et al 2019 but more is needed methods from related fields such as regionalized l moments hosking and wallis 1997 should be considered 2 errors from rainfall measurements extreme storm sampling and rainfall runoff modeling should be examined to understand the propagation of such errors through to sst based ffa estimates these errors should be compared side by side with those resulting from flood based statistical ffa to better understand the relative strengths and limits of each method the bayesian approach used in steinbakk et al 2016 both highlights the importance of error propagation in ffa and provides a roadmap for studying it 3 england et al 2014 showed that sst can be used alongside other methods to develop a preponderance of evidence approach to ffa while perez et al 2019 showed that sst based ffa can help to evaluate other methodologies more explicit merging of sst with other rfa ffa approaches and rainfall estimation techniques is likely to prove valuable an example of the former could be the usage of sst to help estimate the skewness of rainfall and flood distributions a major challenge in conventional ffa examples of the latter could include integration of sst and modern high resolution stochastic rainfall generators and explicit coupling of sst with numerical weather prediction models that can explicitly simulate rainfall in complex terrain 4 process based and multi scale ffa concepts can connect flood processes to flood distributions including in nonstationary conditions though previous studies have begun to explore these connections rigorous interpretation of results in terms of hydrologic processes such as runoff generation mechanisms and channel routing has been lacking a key question is whether a return to the simplified storm and watershed representations of early sst work could prove illuminating in this effort or if real world process complexities would limit the value of such idealizations 5 finally while sst research has been generally confined to the united states and australia the need for rainfall and flood frequency estimation is widespread while global precipitation estimates using satellites and atmospheric reanalyses are improving to the point that they may be useful in rfa and ffa applications validation of these results in ungaged regions remains a challenge nonetheless numerous regions around the globe spanning diverse hydroclimatic and socioeconomic conditions have at least some high quality rainfall and flood observations partnerships with researchers and end users in those regions would help to explore the potential for sst to go global declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors thank stephen j burges and james a smith for their help in identifying pioneering early rainfall and flood studies daniel wright s and guo yu s efforts were supported by the u s national science foundation hydrologic sciences program career project ear 1749638 and by the u s department of the interior bureau of reclamation research and development office project 1735 the authors would like to acknowledge the support of the various funding organizations that have facilitated the sst research that is reviewed in this paper 
5571,due to global climate change and growing population fresh water resources are becoming more vulnerable to pollution protecting fresh water resources especially lakes and the associated environment is one of the key challenges faced by policy makers and water managers lake water level is an important physical indicator of lakes and its fluctuation may significantly impact lake ecosystems therefore reliable forecasting of lake water level is vital for a proper assessment of the health of lake ecosystems and their management in this study two machine learning models including feed forward neural network ffnn and deep learning dl technique were used to predict monthly lake water level the two models were employed for one month ahead forecasting of lake water level in 69 temperate lakes in poland the results show that both the ffnn and the dl models performed generally well for forecasting of lake water level of the 69 lakes with only marginal differences the results also indicate that the dl model did not show significant superiority over the traditional ffnn model indeed the ffnn model slightly outperformed the dl model for 33 of the 69 lakes these results seem to suggest that traditional machine learning models may just be sufficient for forecasting of lake water level when they are properly trained the outcomes of the present study have important implications for water level forecasting and water resources management of lakes especially from the perspective of machine learning models and their complexities keywords lake water level forecasting deep learning neural networks feed forward neural networks long short term memory time series forecasting 1 introduction lakes are valuable natural resources on the earth playing a significant role on economic and societal development lake water level wl is an important physical indicator of lakes and its fluctuations may significantly impact lake ecosystems coops et al 2003 zohary and ostrovsky 2011 ptak et al 2017 for example zohary and ostrovsky 2011 found that at moderate wl fluctuation levels in lakes littoral habitats and biota were affected and with further disturbance levels ecosystem destabilization symptoms such as weakening of keystone species proliferation of nuisance and invasive species loss of biodiversity and increased internal nutrient loading were observed it is therefore of great significance to study water level fluctuations in lakes mathematical models are powerful tools to model and forecast water level fluctuations in lake systems during the past several decades a wide variety of models have been developed from very simple statistical models aksoy et al 2013 khatibi et al 2014 to highly complex physically based hydrodynamic models kebede et al 2006 huang et al 2010 the physically based hydrodynamic models which are complex in general need a bunch of data as model inputs such as lake bathymetry inflow and outflow conditions and a complete set of meteorological variables e g air temperature precipitation wind this makes their application impractical for areas with limited data this limitation has also led to the development and applications of machine learning models for wl forecasting due to their relatively minor data requirements as inputs kisi et al 2015 li et al 2016 shiri et al 2016 in recent decades various types of machine learning models have been developed and applied in hydrological and environmental studies afan et al 2015 yaseen et al 2016 2019 hameed et al 2017 sulaiman et al 2018 ghorbani et al 2018 zhu et al 2018 2019 sanikhani et al 2019 as for the forecasting of lake water level several traditional and classic model types have been assessed such as artificial neural networks anns altunkaynak 2007 yarar et al 2009 buyukyildiz et al 2014 adaptive neuro fuzzy inference systems anfis yarar et al 2009 güldal and tongal 2010 kisi et al 2012 and extreme learning machines elm shiri et al 2016 bonakdari et al 2019 among others with the development of artificial intelligence deep learning dl methods e g the long short term memory lstm recurrent neural network rnn deep restricted boltzmann machine stack autoencoder have been successfully applied for hydrological time series forecasting such as flow forecasting sahoo et al 2019 prediction of water level of the combined sewer overflow structure zhang et al 2018a rainfall runoff simulation hu et al 2018 water table depth prediction in agricultural areas zhang et al 2018b and daily reservoir inflow forecasting li et al 2016 among others deep learning networks allow computational models composed of multiple processing layers to learn representations of data with multiple levels of abstraction and these networks simulate the way the human brain works among the dl networks the long short term memory lstm recurrent neural network rnn is a type of advanced ann approach which involves feedback connections in the model architecture zhang et al 2018a while it has found many applications in other areas of hydrology its applications for lake water level forecasting are very limited to our knowledge only three studies have employed the deep learning models for lake water level forecasting güldal and tongal 2010 liang et al 2018 hrnjica and bonacci 2019 güldal and tongal 2010 applied the recurrent neural network for water level forecasting in the eg irdir lake in turkey and compared the results with those obtained using adaptive neuro fuzzy inference system and stochastic models liang et al 2018 applied the lstm model for forecasting the water level in the tongding lake china and found that the lstm model outperformed the support vector machine svm method hrnjica and bonacci 2019 developed the lstm and the feed forward neural network ffnn models to forecast the water level in the vrana lake croatia they found that the lstm and ffnn models performed better than the time series methods such as nonlinear regression exponential smoothing and autoregressive integrated moving average arma model the outcomes of the above studies are certainly encouraging regarding the suitability and effectiveness of the dl models for lake water level forecasting however a definitive conclusion and generalization on the performance of dl models is difficult to make since each of the above studies has focused on only one specific lake the eg irdir lake by güldal and tongal 2010 the tongding lake by liang et al 2018 and the vrana lake by hrnjica and bonacci 2019 therefore whether the dl model can also perform well and better than other models in forecasting water levels at multiple lakes in a region remains a relevant and key question this provides the motivation for the present study to address the above question in this study we applied the dl model for water level forecasting at 69 lakes in poland we analyzed long term monthly wl data at least 31 years from each of these lakes the results obtained using the dl model were also compared with those obtained from the widely used ffnn model to check its superiority the methods we employed in the present study were the same as that of hrnjica and bonacci 2019 however there was a major difference between the two studies in the way the analysis was done hrnjica and bonacci 2019 used the data from one lake and hence the data used was limited in the present study we trained the data from multiple lakes and then used the model for wl forecasting for multiple lakes this allowed better evaluation of the models since we had a large dataset the outcomes were expected to provide useful information on the robustness of the dl models for wl forecasting in lakes further since the present study was the first attempt to apply the dl models for forecasting water level in as many as 69 polish lakes the outcomes could provide new avenues for lake modeling and management in poland additionally the forecasting results of monthly lake water level would provide guideline for different agencies to facilitate lake water management such as water supply the regulation of ecological water level for lakes and flood control for the lake watershed 2 materials and methods 2 1 study area and data in the present study water level forecasting of multiple lakes in poland was attempted due to the impact of the last glaciation weichselian which occurred about 12000 years ago most lakes in poland are located in the northern part czernecki and ptak 2018 fig 1 these lakes have and continue to important water resources for economic and social development in poland including water supply for domestic industrial agricultural and recreational uses ptak et al 2018 in this study water level data from 69 lakes were used the morphologies of these lakes are summarized in table s1 as seen these lakes have diverse morphologies for instance the mean water depth ranges from 1 0 m to 17 7 m and the lake area varies from 1 1 km2 and 114 9 km2 in poland lake water level is measured at 7 am daily by the institute of meteorology and water management national research institute imgw pib daily observed wl data were available from 1984 to 2018 35 years for 42 lakes for the other 27 lakes daily observed wl data were available from 1984 to 2014 31 years the imgw pib has followed strict procedures for lake wl measurements to assure data quality more detailed information on these data and their quality can be found in https www imgw pl instytut imgw obserwator the daily observed data were averaged to obtain monthly data for the modeling studies thus for 42 lakes there are 420 monthly wl data points 35 years and for the other 27 lakes there are 372 monthly wl data points 31 years fig 2 presents the time series of the monthly wl data of 8 lakes as examples śniardwy wigry wdzydze sępoleńskie sławianowskie studzieniczne selmet wlk and rospuda 2 2 feed forward neural network ffnn artificial neural network was inspired by the human brain and neurons a typical ann model consists of several sets input variables xi weight factors wi bias term b0 and activation function a zhu et al 2019 graf et al 2019 with these inputs the output of an ann model y can be represented as 1 y a i 1 n x i w i b 0 the feed forward neural network ffnn is a widely used ann model in this network information moves only in the forward direction from the input layer through the hidden layer and finally to the output layer in the input layer the number of neurons is determined by the number of input variables in the output layer the number of neurons is determined by the number of output variables the optimal number of neurons in the hidden layer is generally determined by a trial and error method graf et al 2019 the ffnn model is developed by connecting the above neurons into one network since each neuron can produce a simple decision the ffnn model must consist of many neurons in order to establish a network that can find solutions to real world problems burgsteiner 2006 bartolini et al 2011 the three layers of the ffnn are fully connected since every neuron from one layer is connected to every neuron in the next layer 2 3 recurrent neural network rnn the widely used ffnn models are usually built on the fact that data has no order when fed into the network thus the output of the ann depends only on the input features consequently for data where the sequence of data is important specifically when the data is recorded in time simple feed forward ann might not handle it jiang 2009 nourani 2009 one of the solutions for such kind of problems is to develop the recurrent neural network rnn the rnn was first introduced by hopfield 1982 and was later popularized when the backpropagation algorithm was improved pineda 1987 the concept of the rnn model is depicted in fig 3 top here x1 x2 xt are model inputs and h1 h2 ht are model outputs as seen the rnn contains cycles indicating that the current state of the network relies on the data from the current network as well as the outputs produced by the previous network a particular problem with rnn is the vanishing or exploding gradient bengio et al 1994 in the vanishing gradient problem updates of weights are proportional to the gradient of the error in most cases the gradient value is vanishingly small which results in the corresponding weight to be constant and stops the network from further training the exploding gradient problem refers to the opposite behavior where the updates of weights gradient of the cost function become large in each backpropagation step in both cases vanishing and exploding the error propagation through the network is not constant the solution to the above mentioned problems is found in the specific design of the rnn called long short term memory lstm hochreiter and schmidhuber 1997 the lstm is a special rnn which can provide a constant error flow this requires a special network design the lstm consists of the memory blocks with self connection defined in the hidden layer that have the ability to store the temporal state of the network besides the memorization the lstm cell has special multiplicative units called gates which control the information flow each memory block consists of the input gate it which controls the flow of the input activations into a memory cell and the output gate ot which controls the output flow of the cell activation in addition the lstm cell also contains the forget gate ft which filters the information from the input xt and the previous output and decides which one should be remembered or forgotten and dropped the lstm cell with activation layers input output forget gates and the cell connected with peephole connections is shown in fig 3 bottom here xt is the input ft is the forget gate it is the input gate ĉt is the cell update ct is the cell state ot is the output gate and ht is the output 2 4 deep learning dl recently deep learning dl technique has become very popular and has been applied in various fields the dl technique has found widespread applications in some fields such as image and speech recognition processing of computer vision and natural language noda et al 2015 oyedotun and khashman 2017 applications of the dl technique in hydrologic climate and environmental sciences have started to emerge only very recently fang et al 2017 shen 2018 reichstein et al 2019 hrnjica and mehr 2020 but are gaining significant momentum at the current time despite their state of infancy such dl model based studies have provided encouraging results with generally more reliable and accurate predictions for water related processes consequently the dl technique is being increasingly recommended for forecasting environmental time series especially for its ability to provide robust and scalable solutions shen 2018 shen et al 2018 the dl technique is essentially based on ann however it differs from the traditional ffnn in terms of the number and types of hidden layers the dl defines a deep learning network dln consisting of two or more hidden layers the hidden layers can be of different structure type or dimension depending on the complexity of the problem the dln may contain one or more of the following layers normalization layer it normalizes the data before it gets into another layer it can be placed at the beginning or in the interior of the network data normalization is an important step in dl and it helps to remove the dimensional differences in the input data and improve the prediction ability zhu et al 2019 in this study the widely used z score method heddam 2016 zhu et al 2019 was used fig 4 encoding decoding layer this layer is part of the autoencoders network the autoencoder network represents a set of layers mostly used for dimensionality reduction and feature extraction convolution layer this layer is used as feature transformation and dimensionality reduction as a part of the subnetwork usually called convolutional network recurrent neural network layer this layer can be of lstm gated recurrent unit gru or classic rnn layer based on recurrent neural network in this study the widely used lstm layer liang et al 2018 hrnjica and bonacci 2019 was used fig 4 dropout layer it is a special layer for preserving overfitting in the network it is widely used in dl wu and gu 2015 it can be placed between any two layers in the dl network dense layer it is a fully connected feed forward network layer in this layer all activation neurons units are connected to all the inputs and the information is passed to the next layer the dl model proposed in this study consisted of different layers normalization encoding lstm dropout and dense layers fig 4 2 5 model structure in the present study we lumped the data from the above 69 lakes in poland into one dataset for the two models the whole dataset was divided into two parts one part for model training and the other for model testing for each lake the data was trained separately the training dataset consisted of 280 monthly water level values for each lake almost 2 3rd and the remaining data of each lake were used as the testing dataset almost 1 3rd hrnjica and bonacci 2019 model input was the water levels of the previous two months and model output was the water level of the month for which forecasting was to be made after model training and testing the modelling results were reconstructed for each lake the workflow of data preparation multivariate time series construction into data frame machine learning ready dataset and data frame deconstruction into time series for each lake using the dl model is presented in fig 5 the same procedure was followed for the construction of the ffnn model data preparation model training and evaluations were performed using anndotnet a deep learning tool on the net platform hrnjica 2018 the anndotnet implements the machine learning engine based on cognitive toolkit cntk a deep learning framework developed by microsoft research yu et al 2014 for the ffnn and dl models the number of iterations was fixed to 10000 and the early stopping criterion was used by saving models for every 25 epochs the internal parameters of the models were determined by trial and error and the criterion was to minimize the modeling error for lstm cells per layer were 150 for ffnn neurons per layer were 150 for both models adam learner was used the learning rate was set as 0 01 momentum value was set as 0 85 squared error se was used as the loss function relative mean squared error rmse was used as the evaluation function and minibatch size was set as 75 the source codes model data and model structure files can be found in github https github com bhrnjica 69lakes 2 6 model performance measures in this study model accuracy was assessed with two evaluation measures the relative root mean squared error r m s e and the coefficient of correlation r these are given by 2 rmse 1 p i 1 p o i m i 2 o m 3 r 1 p o i o m m i m m 1 p i 1 p o i o m 2 1 n i 1 p m i m m 2 where p is the total number of data points oi is the measured lake water level and mi is the forecasted lake water level and om and mm are respectively the average values of oi and mi the reason we used r m s e in this study is that it would be easier to assess model performance with large datasets between multiple lakes since these lakes may have quite different annual average lake water levels 3 results and discussion the variation of the model error rmse relative mean squared error for all the lakes against the number of iterations is presented in fig 6 as seen the rmse values decreased with the increase in the number of iterations and tended to be stable after about 8000 iterations when the training process was completed the best model was selected and the results were evaluated the results from the ffnn and dl models are presented next ffnn model the modeling results obtained using the ffnn model for the training and testing datasets are presented in table s2 in the training period the r m s e values varied between 1 25 lake raduńskie górne and 22 88 lake charzykowskie with an average value of 5 15 and the r values ranged between 0 46 lake jeziorak and 0 98 lake lednica with an average value of 0 83 in the testing period the ffnn model performed much better with lower r m s e values the r m s e values varied from 0 72 lake raduńskie górne to 15 87 lake charzykowskie with an average value of 4 63 and the r values varied between 0 23 lake łebsko and 0 97 lake lednica with an average value of 0 79 in the training period the r m s e values for 64 of the 69 lakes 92 8 were less than 10 and for 43 of the 69 lakes 62 3 were less than 5 the r values for 49 of the 69 lakes 71 0 were greater than 0 8 and for 25 of the 69 lakes 36 2 were greater than 0 9 in the testing period the r m s e values for 65 of the 69 lakes 94 2 were less than 10 and for 46 of the 69 lakes 66 7 were less than 5 the r values for 40 of the 69 lakes 58 0 were greater than 0 9 and for 20 of the 69 lakes 29 0 were greater than 0 9 overall the ffnn model yielded satisfactory forecasting results for most of the 69 lakes studied here a comparison of the time series of the observed water level values and the ffnn modeled water level values for eight selected lakes for which the ffnn model performed better than that for the other lakes is presented in fig 7 dl model table s2 also presents the lake water level forecasting results obtained using the ffnn model for the training and testing datasets in the training period the r m s e values varied between 1 21 lake raduńskie górne and 23 31 lake charzykowskie with an average value of 5 25 and the r values ranged between 0 45 lake drużno and 0 98 lake lednica with an average value of 0 82 in the testing period the model performed better with lower r m s e values the r m s e values ranged from 0 73 lake raduńskie górne to 15 75 lake charzykowskie with an average value of 4 56 and the r values varied between 0 31 lake łebsko and 0 97 lake lednica with an average value of 0 80 in the training period the r m s e values for 63 of the 69 lakes 91 3 were found to be less than 10 and for 43 of the 69 lakes 62 3 were less than 5 the r values for 51 of the 69 lakes 73 9 were greater than 0 8 and for 28 of the 69 lakes 40 6 were greater than 0 9 in the testing period the r m s e values for 65 of the 69 lakes 94 2 were less than 10 and for 49 of the 69 lakes 71 0 were less than 5 the r values for 45 of the 69 lakes 65 2 were greater than 0 9 and for 25 of the 69 lakes 36 2 were greater than 0 9 these results indicate that the forecasting results from the dl model were generally good for most of the 69 lakes studied here fig 8 for example presents the time series comparison of the observed water level values and the dl modeled water level values for eight selected lakes for which the dl model performed better than that for the other lakes śniardwy wigry wdzydze ińsko sławianowskie leleskie mikołajskie and lednica comparing the forecasting results obtained from the ffnn and dl models table s2 and figs 9 and 10 it was found that for most of the lakes the two models performed nearly the same with only marginal differences this observation was similar to that reported in the study by hrnjica and bonacci 2019 which compared the dl and ffnn models for lake water level forecasting in the vrana lake croatia the spatial distributions of r m s e and r indicated that for the two models model errors were heterogeneous spatially the obtained results in the spatial system showed no evident similarities in the regional system e g in reference to climatic regions as is the case for example in the case of water temperature or ice phenomena ptak et al 2018 2019 the situation was caused by the stronger influence of the local conditions on the course of water levels as confirmed by earlier studies plewa et al 2018 wrzesiński et al 2018 the present results indicated that the dl model did not show any significant superiority over the traditional ffnn model for lake water level forecasting this is even more clearly shown in figs 11 and 12 using the box and histogram plots indeed the ffnn model slightly outperformed the dl model for 33 of the 69 lakes while the dl performed slightly better than the ffnn model for 7 of the 69 lakes for the remaining 29 lakes the two models performed almost equally however from the point view of its overall performance we can conclude that the dl model is a suitable and effective model to forecast lake water level fluctuations the generally accurate results obtained from the two models indicate that using the wl information from the past to estimate wl in the future is reliable this has also been proved in a number of previous studies on lake wl modeling e g altunkaynak 2007 yarar et al 2009 güldal and tongal 2010 kisi et al 2012 buyukyildiz et al 2014 shiri et al 2016 bonakdari et al 2019 therefore for the study area the modeling results can be used to 1 inform water supply as water availability is determined by lake water level and 2 provide guidelines for flood control and lake management with these encouraging results it is also important to note that for some lakes both the dl model and the ffnn model performed poorly in water level forecasting this is exemplified by lake charzykowskie and also several other cases roś białe augustowskie and rajgrodzkie for lake charzykowskie as seen in table s2 both models have higher r m s e values 22 in the training period and 15 in the testing period even though the r values are greater than 0 8 the poor performance of both the models may have been mainly due to the model input used for instance for both models water level information during the previous two time periods i e months were used as model input for forecasting of water level at the current time period i e month in the case of those lakes however due to the effect of anthropogenic activity frequent water level fluctuations were observed lake charzykowskie is fed by the brda river mean flow rate 11 0 m3 s 1 station swornegacie on some selected sections of the river artificial clearing of its channel is necessary to facilitate water flow otherwise the surrounding areas would be flooded affecting the water level fluctuation dynamics another factor is a weir located in mylof regulating the water level in the river depending on the needs of the local power plant lake roś is located below the system of the great masurian lakes the largest river lake system in poland connected with canals and artificially regulated water levels are determined by the operation of the karwnik dam closing the entire hydrographic system to the south lake białe augustowskie is an important part of the augustów canal a waterway already exploited for almost two centuries where the water level is regulated by a system of weirs and dams in the case of lake rajgrodzkie chrzanowski 1995 emphasized its role as a retention reservoir used as a source of water for irrigation of the kuwasy peatland therefore the sole use of information on water level as input data for the model may be insufficient to capture the water level dynamics further research is required to verify and confirm this key information in this scope as evidenced in the cited examples should particularly cover local conditions especially since it is now difficult to find lakes not impacted by humans in terms of water level fluctuations they are regulated directly on the water outflow from the lake weirs floodgates on the outflow or hydrotechnical works are conducted in their vicinity as reported by several studies on water level fluctuations in polish lakes wrzesiński and ptak 2016 plewa et al 2018 wrzesiński et al 2018 nowak and ptak 2019 it is the processes occurring in the catchment and not climatic factors which are obviously important but constitute a background for activities undertaken by humans that are primarily responsible for the dynamics of water level fluctuations in lakes nowak and ptak 2018a described a situation where a floodgate renovated in 2010 located on the outflow from lake powidzkie along with high precipitation in the period contributed to the prolongation of the occurrence of high water levels in the case of lake wierzchowo hydrotechnical infrastructure was the primary element determining the course of water levels due to the increased frequency of local floods the lake dam was abandoned which considerably changed the current water level regime and conditions related to the course of water levels ptak 2015a cieśliński 2016 described a case of coastal lake jamno where the construction of a floodgate contributed to a reduction of the amplitude of water level fluctuations in the lake by an order of 30 40 cm annually according to dorożyński and skowron 2002 in the case of lake gopło as a result of melioration works the water level permanently decreased by more than 3 m moreover situations where water level regulation caused complete disappearance of lakes are numerous ptak 2015b 2017 the above examples point to a broad range of adaptation of lakes with artificially regulated water level fluctuations from the perspective of the observed climate changes it will be important to have detailed knowledge on the possibilities of conducting water management in reference to natural lakes constituting easily available water reservoirs activities undertaken by the governmental agencies in poland aim at an increase in water retention and lakes constitute the key element of the programme in the case of only one administrative region wielkopolskie voivodeship it is estimated that damming of lakes will result in an increase in water resources by approximately 33 008 million m3 www wzmiuw pl therefore the results from the present study may prove to facilitate making decisions concerning hydrotechnical infrastructure on lakes and in a further perspective shaping water resources it is a situation requiring relatively fast and universal solutions considering among others the overgrowing and shallowing of lakes choiński et al 2014 2016 the territory of poland is among the least abundant in water in europe due to this extensive activities have been undertaken aimed at prolongation of water retention in the environment one of the primary elements potentially rapidly retaining water resources are lakes and the possibility of their damming nowak and ptak 2018b the results obtained from the present study will permit better modelling of water level fluctuations which is key for conducting proper water management on particular lakes importantly the knowledge can provide the basis for future planning of potential regulation works 4 conclusions in this study two machine learning models including the traditional feed forward neural network ffnn model and the deep learning dl model were used for forecasting time series of monthly water level in lakes the two models were applied to water level data from 69 temperate lakes in poland the results from this study led to the following conclusions 1 the ffnn and dl models performed generally well for lake water level forecasting indicating the successful application of the ffnn and dl models for multivariate times series forecasting 2 the ffnn and dl models performed nearly the same for most of the lakes with only marginal differences 3 the dl model did not show any significant superiority over the traditional ffnn model for lake water level forecasting 4 for lake water level forecasting using the traditional machine learning models maybe sufficient when such models are well calibrated the results from the present study have important implications for research on water level forecasting in lakes especially from the viewpoint of employing deep learning methods although the ffnn and dl models used in this study generally performed well further improvements are still needed for some lakes both the ffnn model and the dl model produced poor results which may have been induced by the model input used in this study many other influencing factors such as meteorological variables inflow to lakes and water withdrawal from lakes often significantly impact water level fluctuations in these lakes it is important to properly consider these variables and refine the models to achieve more reliable outcomes we will address this in our future studies credit authorship contribution statement senlin zhu supervision funding acquisition conceptualization methodology project administration investigation software writing original draft writing review editing bahrudin hrnjica software conceptualization writing review editing mariusz ptak conceptualization writing review editing adam choiński conceptualization writing review editing bellie sivakumar supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was jointly funded by the national key r d program of china 2018yfc0407203 china postdoctoral science foundation 2018m640499 and the research funding from nanjing hydraulic research institute y118009 the authors would like to thank the two anonymous reviewers and the associate editor for their constructive comments and useful suggestions on an earlier version of the manuscript which led to significant improvements to the quality of the manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 124819 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5571,due to global climate change and growing population fresh water resources are becoming more vulnerable to pollution protecting fresh water resources especially lakes and the associated environment is one of the key challenges faced by policy makers and water managers lake water level is an important physical indicator of lakes and its fluctuation may significantly impact lake ecosystems therefore reliable forecasting of lake water level is vital for a proper assessment of the health of lake ecosystems and their management in this study two machine learning models including feed forward neural network ffnn and deep learning dl technique were used to predict monthly lake water level the two models were employed for one month ahead forecasting of lake water level in 69 temperate lakes in poland the results show that both the ffnn and the dl models performed generally well for forecasting of lake water level of the 69 lakes with only marginal differences the results also indicate that the dl model did not show significant superiority over the traditional ffnn model indeed the ffnn model slightly outperformed the dl model for 33 of the 69 lakes these results seem to suggest that traditional machine learning models may just be sufficient for forecasting of lake water level when they are properly trained the outcomes of the present study have important implications for water level forecasting and water resources management of lakes especially from the perspective of machine learning models and their complexities keywords lake water level forecasting deep learning neural networks feed forward neural networks long short term memory time series forecasting 1 introduction lakes are valuable natural resources on the earth playing a significant role on economic and societal development lake water level wl is an important physical indicator of lakes and its fluctuations may significantly impact lake ecosystems coops et al 2003 zohary and ostrovsky 2011 ptak et al 2017 for example zohary and ostrovsky 2011 found that at moderate wl fluctuation levels in lakes littoral habitats and biota were affected and with further disturbance levels ecosystem destabilization symptoms such as weakening of keystone species proliferation of nuisance and invasive species loss of biodiversity and increased internal nutrient loading were observed it is therefore of great significance to study water level fluctuations in lakes mathematical models are powerful tools to model and forecast water level fluctuations in lake systems during the past several decades a wide variety of models have been developed from very simple statistical models aksoy et al 2013 khatibi et al 2014 to highly complex physically based hydrodynamic models kebede et al 2006 huang et al 2010 the physically based hydrodynamic models which are complex in general need a bunch of data as model inputs such as lake bathymetry inflow and outflow conditions and a complete set of meteorological variables e g air temperature precipitation wind this makes their application impractical for areas with limited data this limitation has also led to the development and applications of machine learning models for wl forecasting due to their relatively minor data requirements as inputs kisi et al 2015 li et al 2016 shiri et al 2016 in recent decades various types of machine learning models have been developed and applied in hydrological and environmental studies afan et al 2015 yaseen et al 2016 2019 hameed et al 2017 sulaiman et al 2018 ghorbani et al 2018 zhu et al 2018 2019 sanikhani et al 2019 as for the forecasting of lake water level several traditional and classic model types have been assessed such as artificial neural networks anns altunkaynak 2007 yarar et al 2009 buyukyildiz et al 2014 adaptive neuro fuzzy inference systems anfis yarar et al 2009 güldal and tongal 2010 kisi et al 2012 and extreme learning machines elm shiri et al 2016 bonakdari et al 2019 among others with the development of artificial intelligence deep learning dl methods e g the long short term memory lstm recurrent neural network rnn deep restricted boltzmann machine stack autoencoder have been successfully applied for hydrological time series forecasting such as flow forecasting sahoo et al 2019 prediction of water level of the combined sewer overflow structure zhang et al 2018a rainfall runoff simulation hu et al 2018 water table depth prediction in agricultural areas zhang et al 2018b and daily reservoir inflow forecasting li et al 2016 among others deep learning networks allow computational models composed of multiple processing layers to learn representations of data with multiple levels of abstraction and these networks simulate the way the human brain works among the dl networks the long short term memory lstm recurrent neural network rnn is a type of advanced ann approach which involves feedback connections in the model architecture zhang et al 2018a while it has found many applications in other areas of hydrology its applications for lake water level forecasting are very limited to our knowledge only three studies have employed the deep learning models for lake water level forecasting güldal and tongal 2010 liang et al 2018 hrnjica and bonacci 2019 güldal and tongal 2010 applied the recurrent neural network for water level forecasting in the eg irdir lake in turkey and compared the results with those obtained using adaptive neuro fuzzy inference system and stochastic models liang et al 2018 applied the lstm model for forecasting the water level in the tongding lake china and found that the lstm model outperformed the support vector machine svm method hrnjica and bonacci 2019 developed the lstm and the feed forward neural network ffnn models to forecast the water level in the vrana lake croatia they found that the lstm and ffnn models performed better than the time series methods such as nonlinear regression exponential smoothing and autoregressive integrated moving average arma model the outcomes of the above studies are certainly encouraging regarding the suitability and effectiveness of the dl models for lake water level forecasting however a definitive conclusion and generalization on the performance of dl models is difficult to make since each of the above studies has focused on only one specific lake the eg irdir lake by güldal and tongal 2010 the tongding lake by liang et al 2018 and the vrana lake by hrnjica and bonacci 2019 therefore whether the dl model can also perform well and better than other models in forecasting water levels at multiple lakes in a region remains a relevant and key question this provides the motivation for the present study to address the above question in this study we applied the dl model for water level forecasting at 69 lakes in poland we analyzed long term monthly wl data at least 31 years from each of these lakes the results obtained using the dl model were also compared with those obtained from the widely used ffnn model to check its superiority the methods we employed in the present study were the same as that of hrnjica and bonacci 2019 however there was a major difference between the two studies in the way the analysis was done hrnjica and bonacci 2019 used the data from one lake and hence the data used was limited in the present study we trained the data from multiple lakes and then used the model for wl forecasting for multiple lakes this allowed better evaluation of the models since we had a large dataset the outcomes were expected to provide useful information on the robustness of the dl models for wl forecasting in lakes further since the present study was the first attempt to apply the dl models for forecasting water level in as many as 69 polish lakes the outcomes could provide new avenues for lake modeling and management in poland additionally the forecasting results of monthly lake water level would provide guideline for different agencies to facilitate lake water management such as water supply the regulation of ecological water level for lakes and flood control for the lake watershed 2 materials and methods 2 1 study area and data in the present study water level forecasting of multiple lakes in poland was attempted due to the impact of the last glaciation weichselian which occurred about 12000 years ago most lakes in poland are located in the northern part czernecki and ptak 2018 fig 1 these lakes have and continue to important water resources for economic and social development in poland including water supply for domestic industrial agricultural and recreational uses ptak et al 2018 in this study water level data from 69 lakes were used the morphologies of these lakes are summarized in table s1 as seen these lakes have diverse morphologies for instance the mean water depth ranges from 1 0 m to 17 7 m and the lake area varies from 1 1 km2 and 114 9 km2 in poland lake water level is measured at 7 am daily by the institute of meteorology and water management national research institute imgw pib daily observed wl data were available from 1984 to 2018 35 years for 42 lakes for the other 27 lakes daily observed wl data were available from 1984 to 2014 31 years the imgw pib has followed strict procedures for lake wl measurements to assure data quality more detailed information on these data and their quality can be found in https www imgw pl instytut imgw obserwator the daily observed data were averaged to obtain monthly data for the modeling studies thus for 42 lakes there are 420 monthly wl data points 35 years and for the other 27 lakes there are 372 monthly wl data points 31 years fig 2 presents the time series of the monthly wl data of 8 lakes as examples śniardwy wigry wdzydze sępoleńskie sławianowskie studzieniczne selmet wlk and rospuda 2 2 feed forward neural network ffnn artificial neural network was inspired by the human brain and neurons a typical ann model consists of several sets input variables xi weight factors wi bias term b0 and activation function a zhu et al 2019 graf et al 2019 with these inputs the output of an ann model y can be represented as 1 y a i 1 n x i w i b 0 the feed forward neural network ffnn is a widely used ann model in this network information moves only in the forward direction from the input layer through the hidden layer and finally to the output layer in the input layer the number of neurons is determined by the number of input variables in the output layer the number of neurons is determined by the number of output variables the optimal number of neurons in the hidden layer is generally determined by a trial and error method graf et al 2019 the ffnn model is developed by connecting the above neurons into one network since each neuron can produce a simple decision the ffnn model must consist of many neurons in order to establish a network that can find solutions to real world problems burgsteiner 2006 bartolini et al 2011 the three layers of the ffnn are fully connected since every neuron from one layer is connected to every neuron in the next layer 2 3 recurrent neural network rnn the widely used ffnn models are usually built on the fact that data has no order when fed into the network thus the output of the ann depends only on the input features consequently for data where the sequence of data is important specifically when the data is recorded in time simple feed forward ann might not handle it jiang 2009 nourani 2009 one of the solutions for such kind of problems is to develop the recurrent neural network rnn the rnn was first introduced by hopfield 1982 and was later popularized when the backpropagation algorithm was improved pineda 1987 the concept of the rnn model is depicted in fig 3 top here x1 x2 xt are model inputs and h1 h2 ht are model outputs as seen the rnn contains cycles indicating that the current state of the network relies on the data from the current network as well as the outputs produced by the previous network a particular problem with rnn is the vanishing or exploding gradient bengio et al 1994 in the vanishing gradient problem updates of weights are proportional to the gradient of the error in most cases the gradient value is vanishingly small which results in the corresponding weight to be constant and stops the network from further training the exploding gradient problem refers to the opposite behavior where the updates of weights gradient of the cost function become large in each backpropagation step in both cases vanishing and exploding the error propagation through the network is not constant the solution to the above mentioned problems is found in the specific design of the rnn called long short term memory lstm hochreiter and schmidhuber 1997 the lstm is a special rnn which can provide a constant error flow this requires a special network design the lstm consists of the memory blocks with self connection defined in the hidden layer that have the ability to store the temporal state of the network besides the memorization the lstm cell has special multiplicative units called gates which control the information flow each memory block consists of the input gate it which controls the flow of the input activations into a memory cell and the output gate ot which controls the output flow of the cell activation in addition the lstm cell also contains the forget gate ft which filters the information from the input xt and the previous output and decides which one should be remembered or forgotten and dropped the lstm cell with activation layers input output forget gates and the cell connected with peephole connections is shown in fig 3 bottom here xt is the input ft is the forget gate it is the input gate ĉt is the cell update ct is the cell state ot is the output gate and ht is the output 2 4 deep learning dl recently deep learning dl technique has become very popular and has been applied in various fields the dl technique has found widespread applications in some fields such as image and speech recognition processing of computer vision and natural language noda et al 2015 oyedotun and khashman 2017 applications of the dl technique in hydrologic climate and environmental sciences have started to emerge only very recently fang et al 2017 shen 2018 reichstein et al 2019 hrnjica and mehr 2020 but are gaining significant momentum at the current time despite their state of infancy such dl model based studies have provided encouraging results with generally more reliable and accurate predictions for water related processes consequently the dl technique is being increasingly recommended for forecasting environmental time series especially for its ability to provide robust and scalable solutions shen 2018 shen et al 2018 the dl technique is essentially based on ann however it differs from the traditional ffnn in terms of the number and types of hidden layers the dl defines a deep learning network dln consisting of two or more hidden layers the hidden layers can be of different structure type or dimension depending on the complexity of the problem the dln may contain one or more of the following layers normalization layer it normalizes the data before it gets into another layer it can be placed at the beginning or in the interior of the network data normalization is an important step in dl and it helps to remove the dimensional differences in the input data and improve the prediction ability zhu et al 2019 in this study the widely used z score method heddam 2016 zhu et al 2019 was used fig 4 encoding decoding layer this layer is part of the autoencoders network the autoencoder network represents a set of layers mostly used for dimensionality reduction and feature extraction convolution layer this layer is used as feature transformation and dimensionality reduction as a part of the subnetwork usually called convolutional network recurrent neural network layer this layer can be of lstm gated recurrent unit gru or classic rnn layer based on recurrent neural network in this study the widely used lstm layer liang et al 2018 hrnjica and bonacci 2019 was used fig 4 dropout layer it is a special layer for preserving overfitting in the network it is widely used in dl wu and gu 2015 it can be placed between any two layers in the dl network dense layer it is a fully connected feed forward network layer in this layer all activation neurons units are connected to all the inputs and the information is passed to the next layer the dl model proposed in this study consisted of different layers normalization encoding lstm dropout and dense layers fig 4 2 5 model structure in the present study we lumped the data from the above 69 lakes in poland into one dataset for the two models the whole dataset was divided into two parts one part for model training and the other for model testing for each lake the data was trained separately the training dataset consisted of 280 monthly water level values for each lake almost 2 3rd and the remaining data of each lake were used as the testing dataset almost 1 3rd hrnjica and bonacci 2019 model input was the water levels of the previous two months and model output was the water level of the month for which forecasting was to be made after model training and testing the modelling results were reconstructed for each lake the workflow of data preparation multivariate time series construction into data frame machine learning ready dataset and data frame deconstruction into time series for each lake using the dl model is presented in fig 5 the same procedure was followed for the construction of the ffnn model data preparation model training and evaluations were performed using anndotnet a deep learning tool on the net platform hrnjica 2018 the anndotnet implements the machine learning engine based on cognitive toolkit cntk a deep learning framework developed by microsoft research yu et al 2014 for the ffnn and dl models the number of iterations was fixed to 10000 and the early stopping criterion was used by saving models for every 25 epochs the internal parameters of the models were determined by trial and error and the criterion was to minimize the modeling error for lstm cells per layer were 150 for ffnn neurons per layer were 150 for both models adam learner was used the learning rate was set as 0 01 momentum value was set as 0 85 squared error se was used as the loss function relative mean squared error rmse was used as the evaluation function and minibatch size was set as 75 the source codes model data and model structure files can be found in github https github com bhrnjica 69lakes 2 6 model performance measures in this study model accuracy was assessed with two evaluation measures the relative root mean squared error r m s e and the coefficient of correlation r these are given by 2 rmse 1 p i 1 p o i m i 2 o m 3 r 1 p o i o m m i m m 1 p i 1 p o i o m 2 1 n i 1 p m i m m 2 where p is the total number of data points oi is the measured lake water level and mi is the forecasted lake water level and om and mm are respectively the average values of oi and mi the reason we used r m s e in this study is that it would be easier to assess model performance with large datasets between multiple lakes since these lakes may have quite different annual average lake water levels 3 results and discussion the variation of the model error rmse relative mean squared error for all the lakes against the number of iterations is presented in fig 6 as seen the rmse values decreased with the increase in the number of iterations and tended to be stable after about 8000 iterations when the training process was completed the best model was selected and the results were evaluated the results from the ffnn and dl models are presented next ffnn model the modeling results obtained using the ffnn model for the training and testing datasets are presented in table s2 in the training period the r m s e values varied between 1 25 lake raduńskie górne and 22 88 lake charzykowskie with an average value of 5 15 and the r values ranged between 0 46 lake jeziorak and 0 98 lake lednica with an average value of 0 83 in the testing period the ffnn model performed much better with lower r m s e values the r m s e values varied from 0 72 lake raduńskie górne to 15 87 lake charzykowskie with an average value of 4 63 and the r values varied between 0 23 lake łebsko and 0 97 lake lednica with an average value of 0 79 in the training period the r m s e values for 64 of the 69 lakes 92 8 were less than 10 and for 43 of the 69 lakes 62 3 were less than 5 the r values for 49 of the 69 lakes 71 0 were greater than 0 8 and for 25 of the 69 lakes 36 2 were greater than 0 9 in the testing period the r m s e values for 65 of the 69 lakes 94 2 were less than 10 and for 46 of the 69 lakes 66 7 were less than 5 the r values for 40 of the 69 lakes 58 0 were greater than 0 9 and for 20 of the 69 lakes 29 0 were greater than 0 9 overall the ffnn model yielded satisfactory forecasting results for most of the 69 lakes studied here a comparison of the time series of the observed water level values and the ffnn modeled water level values for eight selected lakes for which the ffnn model performed better than that for the other lakes is presented in fig 7 dl model table s2 also presents the lake water level forecasting results obtained using the ffnn model for the training and testing datasets in the training period the r m s e values varied between 1 21 lake raduńskie górne and 23 31 lake charzykowskie with an average value of 5 25 and the r values ranged between 0 45 lake drużno and 0 98 lake lednica with an average value of 0 82 in the testing period the model performed better with lower r m s e values the r m s e values ranged from 0 73 lake raduńskie górne to 15 75 lake charzykowskie with an average value of 4 56 and the r values varied between 0 31 lake łebsko and 0 97 lake lednica with an average value of 0 80 in the training period the r m s e values for 63 of the 69 lakes 91 3 were found to be less than 10 and for 43 of the 69 lakes 62 3 were less than 5 the r values for 51 of the 69 lakes 73 9 were greater than 0 8 and for 28 of the 69 lakes 40 6 were greater than 0 9 in the testing period the r m s e values for 65 of the 69 lakes 94 2 were less than 10 and for 49 of the 69 lakes 71 0 were less than 5 the r values for 45 of the 69 lakes 65 2 were greater than 0 9 and for 25 of the 69 lakes 36 2 were greater than 0 9 these results indicate that the forecasting results from the dl model were generally good for most of the 69 lakes studied here fig 8 for example presents the time series comparison of the observed water level values and the dl modeled water level values for eight selected lakes for which the dl model performed better than that for the other lakes śniardwy wigry wdzydze ińsko sławianowskie leleskie mikołajskie and lednica comparing the forecasting results obtained from the ffnn and dl models table s2 and figs 9 and 10 it was found that for most of the lakes the two models performed nearly the same with only marginal differences this observation was similar to that reported in the study by hrnjica and bonacci 2019 which compared the dl and ffnn models for lake water level forecasting in the vrana lake croatia the spatial distributions of r m s e and r indicated that for the two models model errors were heterogeneous spatially the obtained results in the spatial system showed no evident similarities in the regional system e g in reference to climatic regions as is the case for example in the case of water temperature or ice phenomena ptak et al 2018 2019 the situation was caused by the stronger influence of the local conditions on the course of water levels as confirmed by earlier studies plewa et al 2018 wrzesiński et al 2018 the present results indicated that the dl model did not show any significant superiority over the traditional ffnn model for lake water level forecasting this is even more clearly shown in figs 11 and 12 using the box and histogram plots indeed the ffnn model slightly outperformed the dl model for 33 of the 69 lakes while the dl performed slightly better than the ffnn model for 7 of the 69 lakes for the remaining 29 lakes the two models performed almost equally however from the point view of its overall performance we can conclude that the dl model is a suitable and effective model to forecast lake water level fluctuations the generally accurate results obtained from the two models indicate that using the wl information from the past to estimate wl in the future is reliable this has also been proved in a number of previous studies on lake wl modeling e g altunkaynak 2007 yarar et al 2009 güldal and tongal 2010 kisi et al 2012 buyukyildiz et al 2014 shiri et al 2016 bonakdari et al 2019 therefore for the study area the modeling results can be used to 1 inform water supply as water availability is determined by lake water level and 2 provide guidelines for flood control and lake management with these encouraging results it is also important to note that for some lakes both the dl model and the ffnn model performed poorly in water level forecasting this is exemplified by lake charzykowskie and also several other cases roś białe augustowskie and rajgrodzkie for lake charzykowskie as seen in table s2 both models have higher r m s e values 22 in the training period and 15 in the testing period even though the r values are greater than 0 8 the poor performance of both the models may have been mainly due to the model input used for instance for both models water level information during the previous two time periods i e months were used as model input for forecasting of water level at the current time period i e month in the case of those lakes however due to the effect of anthropogenic activity frequent water level fluctuations were observed lake charzykowskie is fed by the brda river mean flow rate 11 0 m3 s 1 station swornegacie on some selected sections of the river artificial clearing of its channel is necessary to facilitate water flow otherwise the surrounding areas would be flooded affecting the water level fluctuation dynamics another factor is a weir located in mylof regulating the water level in the river depending on the needs of the local power plant lake roś is located below the system of the great masurian lakes the largest river lake system in poland connected with canals and artificially regulated water levels are determined by the operation of the karwnik dam closing the entire hydrographic system to the south lake białe augustowskie is an important part of the augustów canal a waterway already exploited for almost two centuries where the water level is regulated by a system of weirs and dams in the case of lake rajgrodzkie chrzanowski 1995 emphasized its role as a retention reservoir used as a source of water for irrigation of the kuwasy peatland therefore the sole use of information on water level as input data for the model may be insufficient to capture the water level dynamics further research is required to verify and confirm this key information in this scope as evidenced in the cited examples should particularly cover local conditions especially since it is now difficult to find lakes not impacted by humans in terms of water level fluctuations they are regulated directly on the water outflow from the lake weirs floodgates on the outflow or hydrotechnical works are conducted in their vicinity as reported by several studies on water level fluctuations in polish lakes wrzesiński and ptak 2016 plewa et al 2018 wrzesiński et al 2018 nowak and ptak 2019 it is the processes occurring in the catchment and not climatic factors which are obviously important but constitute a background for activities undertaken by humans that are primarily responsible for the dynamics of water level fluctuations in lakes nowak and ptak 2018a described a situation where a floodgate renovated in 2010 located on the outflow from lake powidzkie along with high precipitation in the period contributed to the prolongation of the occurrence of high water levels in the case of lake wierzchowo hydrotechnical infrastructure was the primary element determining the course of water levels due to the increased frequency of local floods the lake dam was abandoned which considerably changed the current water level regime and conditions related to the course of water levels ptak 2015a cieśliński 2016 described a case of coastal lake jamno where the construction of a floodgate contributed to a reduction of the amplitude of water level fluctuations in the lake by an order of 30 40 cm annually according to dorożyński and skowron 2002 in the case of lake gopło as a result of melioration works the water level permanently decreased by more than 3 m moreover situations where water level regulation caused complete disappearance of lakes are numerous ptak 2015b 2017 the above examples point to a broad range of adaptation of lakes with artificially regulated water level fluctuations from the perspective of the observed climate changes it will be important to have detailed knowledge on the possibilities of conducting water management in reference to natural lakes constituting easily available water reservoirs activities undertaken by the governmental agencies in poland aim at an increase in water retention and lakes constitute the key element of the programme in the case of only one administrative region wielkopolskie voivodeship it is estimated that damming of lakes will result in an increase in water resources by approximately 33 008 million m3 www wzmiuw pl therefore the results from the present study may prove to facilitate making decisions concerning hydrotechnical infrastructure on lakes and in a further perspective shaping water resources it is a situation requiring relatively fast and universal solutions considering among others the overgrowing and shallowing of lakes choiński et al 2014 2016 the territory of poland is among the least abundant in water in europe due to this extensive activities have been undertaken aimed at prolongation of water retention in the environment one of the primary elements potentially rapidly retaining water resources are lakes and the possibility of their damming nowak and ptak 2018b the results obtained from the present study will permit better modelling of water level fluctuations which is key for conducting proper water management on particular lakes importantly the knowledge can provide the basis for future planning of potential regulation works 4 conclusions in this study two machine learning models including the traditional feed forward neural network ffnn model and the deep learning dl model were used for forecasting time series of monthly water level in lakes the two models were applied to water level data from 69 temperate lakes in poland the results from this study led to the following conclusions 1 the ffnn and dl models performed generally well for lake water level forecasting indicating the successful application of the ffnn and dl models for multivariate times series forecasting 2 the ffnn and dl models performed nearly the same for most of the lakes with only marginal differences 3 the dl model did not show any significant superiority over the traditional ffnn model for lake water level forecasting 4 for lake water level forecasting using the traditional machine learning models maybe sufficient when such models are well calibrated the results from the present study have important implications for research on water level forecasting in lakes especially from the viewpoint of employing deep learning methods although the ffnn and dl models used in this study generally performed well further improvements are still needed for some lakes both the ffnn model and the dl model produced poor results which may have been induced by the model input used in this study many other influencing factors such as meteorological variables inflow to lakes and water withdrawal from lakes often significantly impact water level fluctuations in these lakes it is important to properly consider these variables and refine the models to achieve more reliable outcomes we will address this in our future studies credit authorship contribution statement senlin zhu supervision funding acquisition conceptualization methodology project administration investigation software writing original draft writing review editing bahrudin hrnjica software conceptualization writing review editing mariusz ptak conceptualization writing review editing adam choiński conceptualization writing review editing bellie sivakumar supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was jointly funded by the national key r d program of china 2018yfc0407203 china postdoctoral science foundation 2018m640499 and the research funding from nanjing hydraulic research institute y118009 the authors would like to thank the two anonymous reviewers and the associate editor for their constructive comments and useful suggestions on an earlier version of the manuscript which led to significant improvements to the quality of the manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 124819 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5572,in this study the climate variability and associated atmospheric water cycle changes in the xinjiang china over the past five decades 1961 2010 are investigated the brubaker model and the schär model were used to estimate the regional precipitation recycling on the climate scale while evaporation and transpiration et in the area were estimated via the budyko theory meanwhile we proposed a conceptual framework that delineates the climatic variability and associated atmospheric water cycle changes in xinjiang most of the climatic indicators in xinjiang experienced a dramatic change in the late 1980s or early 1990s rapid warming increased precipitation and water vapor as well as wind strengthening have all been observed over the last two decades all these changes have enhanced the potential evapotranspiration pet and the surface actual et the warming and moistening of the atmosphere reinforced the local moisture cycle and increased precipitation recycling the average values of the precipitation recycling ratio prr were 6 48 and 7 79 for the two models respectively the prr increased remarkably with a strong upward trend from the early 1980s to the early 21st century it implied that the local precipitation recycling had been accelerating over the last three decades the prr changes were dominated by the moisture variables e g actual et precipitation amount and water vapor conditions keywords climate change atmospheric water cycle moisture budget precipitation recycling xinjiang 1 introduction water cycle is a crucial component of earth s climate and environment system trenberth et al 2007 allan and liepert 2010 and has been reported to intensify on the global scale under the effects of global warming huntington 2006 ipcc 2013 as a critical process water cycle is most sensitive to climate warming in arid regions the latter which leads to significant environmental problems li et al 2018 numerous studies have also reported that consequences of changes in the global water cycle are profoundly affecting the environment allan and liepert 2010 the atmospheric water cycle awc is one of the branches of the water cycle process su and feng 2014 it arises from evaporation of the oceans lakes and rivers which is then transported within the atmosphere condenses into clouds and finally precipitates to the ground before evaporating again generally precipitation originates from two sources local evaporation moisture precipitation recycling and external moisture transport advection brubaker et al 1993 burde and zangvil 2001 precipitation recycling is a key element of the water cycle linking the land surface and atmosphere and balancing the water and energy cycles dominguez and kumar 2008 guo and wang 2014 thus the proper understanding and accurate determination of the atmospheric water cycle associated processes is of critical importance for the prediction of changes in the regional hydro climate and water resources and for better adapting to these variations numerous studies have reported changes in the atmospheric water cycle at the global regional and basin scales brubaker et al 1993 fontaine et al 2003 bosilovich et al 2005 huntington 2006 trenberth et al 2007 dominguez and kumar 2008 bengtsson 2010 bengtsson et al 2011 guo and wang 2014 overall the global atmospheric water cycle is intensifying due to the increased evaporation and precipitation associated with a warmer climate however bosilovich et al 2005 stated that as the global precipitable water in the atmosphere increases with the temperature rise the residence time of water in the atmosphere also increases and therefore the global cycling rate decreases conversely huntington 2006 which gathered evidences of changes in hydrologic variables found that the global water cycle is continuously intensifying bengtsson 2010 skliris et al 2016 also suggested the acceleration of the global water cycle but with a cycling rate smaller than the one predicted by the clausius clapeyron equation changes of the atmospheric water cycle present different regional characteristics which have attracted attention over the past few years bengtsson et al 2011 investigated the present and future changes of the global water cycle over polar regions under a warmer climate while fontaine et al 2003 examined the atmospheric water cycle and water vapor fluxes over west africa zheng et al 2017 investigated the change of water budgets over xinjiang china and feng and wu 2016 determined that the hydrological cycle over xinjiang has been intensifying precipitation recycling is a primary process of precipitation especially in arid regions dominguez and kumar 2008 li et al 2018 its regional characteristics are affected by global warming the latter which may lead to changes in precipitation ipcc 2013 many studies were focused on the change of precipitation recycling in vast river basins and low altitude continental regions eltahir and bras 1994 kang et al 2004 2005 dominguez et al 2006 but comparatively few studies focused on arid regions li et al 2018 found that the precipitation recycling is more significant in arid regions than in wet regions and that the correlation with precipitation is different among different arid regions in the tibet plateau the change of precipitation recycling varies by regions showing a decreasing trend in the western arid region while other regions present more adverse changes guo and wang 2014 many precipitation recycling models have been proposed over the past few decades budyko 1974 brubaker et al 1993 eltahir and bras 1994 schär et al 1999 dominguez et al 2006 starting with the one dimensional model proposed by budyko 1974 and later improved and developed into a two dimensional model by brubaker et al 1993 the performance of this updated model has been thoroughly documented by trenberth 1998 and schär et al 1999 which found it to be more suitable to estimate the actual recycling conditions in this paper a systematic study of climate changes over the xinjiang region is provided the atmospheric water cycle processes and their variations from 1961 to 2010 were investigated and the brubaker et al 1993 and schär et al 1999 models were used to investigate the causes responsible for the changes in precipitation recycling and the relationship between precipitation recycling and climatic factors lastly a conceptual framework is presented to summarize these climatic variabilities and the effect they have on the atmospheric water cycle changes in xinjiang 2 data and methodology 2 1 study area the xinjiang region is located in the eastern part of central asia and is the largest province in china being a part of northwestern china it is divided into three sub regions by the tianshan mountain range northern xinjiang tianshan mountains and southern xinjiang fig 1 the climatic regime is controlled by a westerly circulation and the moisture condition is low due to the long distance separating this province from the ocean thus the local precipitation recycling is important to the region s water supply 2 2 data monthly observation data are obtained from 89 stations spread over xinjiang and provided by the china meteorological agency cma these data were collected from 1961 to 2010 and include a complete record of most meteorological factors such as air temperature precipitation water vapor pressure wind speed and sunshine duration monthly specific humidity and wind data were extracted from the ncep ncar reanalysis product with a horizontal resolution of 2 5 latitude longitude grid and 17 pressure levels in the vertical direction kalnay et al 1996 liu and yang 2010 investigated the applicability of the ncep ncar reanalysis data and found that the moisture transportation data was remarkable agreement with that derived from the sounding data in xinjiang china thus the ncep ncar reanalysis data for calculating water vapor transportation was accurate in xinjiang china 2 3 methodology 2 3 1 precipitation recycling model 2 3 1 1 basic scheme fig 2 describes the simplified regional atmospheric water cycle processcomposed of two parts advective moisture transport and local moisture recycling process for any land region x the atmospheric water budget relationship can be expressed as follows 1 δ w q in q out e t p where δ w is the change of water vapor content which is low and always negligible qin and qout represents the column integrated moisture transported into and out of the x area respectively et is the actual evaporation and p is the total precipitation made up of advective pa and evaporative pm sources pa is the fraction of precipitation coming from the advective moisture transport flux and pm is the fraction originating from local evaporation thus the total precipitation in the x region is considered as having two separate components advective and local evaporative and it expressed as 2 p p a p m the precipitation recycling ratio prr which was determined by both the brubaker and schär models is defined as 3 prr β p m p and the recycling precipitation rp expression is 4 rp p p r r 2 3 1 2 brubaker s model the pa pm and et are treated as constants equal to their mean values thus the local evaporated moisture or advected moisture of the air increases decreases linearly brubaker et al 1993 it follows that the horizontal flux of advected moisture qa over the region of area a km2 is 5 q a q in q in p a a 2 q in p a a 2 and the horizontal flux of evaporated moisture qm is 6 q m 0 e t p m a 2 e t p m a 2 as the atmosphere is fully mixed p a p m equals q a q m 7 p a p m q a q m q in p a a 2 e p m a 2 the prr can be therefore be calculated from eqs 2 7 as follows 8 β et a et a 2 q in 2 3 1 3 schär s model similar to equation 1 the individual budget relations were considered with regards to the two components of water that originate from evaporation within the region and from advection transported into the region for the moisture component that derives from within the region the qin disappears while the qout p and δ w are scaled with a factor β consistent with the assumption of a uniform recycling rate schär et al 1999 the two budgets are then given by 9 δ w β q out β e t p β 10 δ w 1 β q in q out 1 β p 1 β solving for β from 9 and 10 and substituting from 1 yields 11 β et et q in 2 3 2 estimation of et using the budyko theory et which is the land surface evaporation and plant transpiration thornthwaite 1948 is a key component in the atmospheric water cycle but is difficult to directly observe on a large scale gao et al 2012 the budyko theory is a widely recognized approach to estimate et budyko 1974 donohue et al 2011 roderick and farquhar 2011 whose analytical solution was proposed by fu 1981 and can be expressed as 17 et p 1 pet p 1 pet p w 1 w where w is a parameter dominated by the water energy partitioning and related to the land surface conditions yang et al 2006 li et al 2013 pet represents potential evapotranspiration several models have been developed to parameterize w fu 1981 choudhury 1999 zhang et al 2001 yang et al 2006 li et al 2013 cong et al 2015 among which that of yao et al 2017 an empirical and physically based model adapted for inland arid regions this model s expression is 18 w 1 81 513 s max pet 1 621 a 0 0233 e x p 2 218 t a n β where s max pet is the relative soil water storage a is the area of the modeled region and t a n β is the average slope of the study region derived from the dem data monthly pet was estimated by the pm equation 19 pet 0 408 δ r n g γ 900 t 273 u 2 e s e a δ γ 1 0 34 u 2 where rn is the net radiation mj m 2 d 1 g is the soil heat flux mj m 2 d 1 γ is the psychrometric constant kpa c 1 δ is the slope of vapor pressure curve kpa c 1 u2 is the wind speed at 2 m m s 1 es is the saturation vapor pressure kpa ea is the actual vapor pressure kpa and t is the mean air temperature at 2 m c 2 3 3 spatio temporal trends of atmospheric water cycle variables the nonparametric mann kendall method mann 1945 kendall 1975 was used to reveal the temporal trend of the climate and atmospheric water cycle variables from 1961 to 2010 this method is recommended by the wmo and used to uncover the significance of trends in climate and atmospheric water cycle variables the pearson s correlation method was employed to reveal the relationship between any two variables as xinjiang is china s largest province and has a wavy topography which impacts greatly on spatially interpolated results the gradient plus inverse distance squared gids method was employed to interpolate the spatial distribution of precipitation and climatic variables based on the dem data nalder and wein 1998 yao et al 2016 gids is a simple robust and accurate interpolation method and combines multiple linear regression and distance weighting this method provides cross validation accuracies and avoid the subjectivity involved in defining variogram models and neighborhoods nalder and wein 1998 annual precipitation and climatic variables were calculated from gridded daily data which was interpolated using gids from the data measured at the meteorological stations and the spatial resolution is 10 10 km yang et al 2014 shi 2014 the same multiple linear regressions developed for detrended kriging were used to define climatic gradients as x y and elevation coefficients these gradients were then used to predict each climate variable for each test site based on the remaining stations the values so obtained were averaged using inverse distance squared weighting nalder and wein 1998 20 z i 1 n z i x x i c x y y i c y e e i c e d i 2 i 1 n 1 d i 2 where z is the estimated climatic variable x and x i are the x coordinates of the test site and climate station i respectively y and y i are the y coordinates of the test site and climate station i respectively e and e i are the elevations of the test site and climate station i respectively and c x c y and c e and regression coefficients for x y and elevation respectively d is the distance from the site to climate station i and n is the number of climate stations used for the interpolation annual et and pet were also estimated using the equation 17 and equation 19 and interpolated using gids method which the spatial resolution is 10 10 km yao et al 2017 investigated the applicability of the equation 17 18 and found that the estimated annual et was remarkable agreement r2 0 918 rmse 23 36 mm with that derived from the long term water balance for 68 catchments in xinjiang china thus the method for estimating et was accurate in xinjiang china 3 results 3 1 effects of climate changes on the xinjiang fig 3 and fig 4 show the spatio temporal changes of various climatic indicators over the xinjiang province including the observed annual mean air temperature mat precipitation water vapor pressure wind speed and sunshine duration estimated from the individual stations data acquired between 1961 and 2010 a detailed description of these changes is provided for each variable in the following chapters 3 1 1 air temperature annual mean air temperature increased significantly between 1961 and 2010 with the elevated rate of 0 328 c decade 1 p 0 01 the mann kendall test revealed that an abrupt change in the mat trend occurred in 1990 with an acceleration of the warming trend after 1990 0 48 c decade 1 p 0 01 compared with the 1961 1989 period 0 10 c decade 1 p 0 05 fig 3a in terms of spatial tendency the whole region showed a rapid warming although spatial variability existed fig 4a 3 1 2 precipitation since the 1960s the xinjiang has experienced a significant increase in annual total precipitation with a wetting trend of 9 46 mm decade 1 p 0 01 and a turning point in 1987 p 0 01 fig 3b after which the annual precipitation increased by 29 6 mm compared with the 1961 1986 period spatially the largest increasing rate occured in the tma with 15 56 mm decade 1 p 0 05 followed by the nxj with a rate of 13 06 mm decade 1 p 0 05 and the sxj with the lowest rate of 5 60 mm decade 1 p 0 05 fig 4b generally elevation has a clear influence on the distribution and variability of climatic factors especially in the case of precipitations in terms of proportion of precipitation regions with total precipitations smaller than 50 mm account for 43 9 of the total areas in xinjiang while the regions where precipitations exceed more than 400 mm only cover 12 3 of the total areas fig 5 b moreover elevation also affects the wetting trend i e there is an elevation dependent wetting edwe in xinjiang yao et al 2016 the elevation dependence is then a crucial process for the evaluation of precipitation variability 3 1 3 water vapor water vapor pressure wvp is a critical climatic factor from which the atmospheric moisture condition is inferred the wvp in xinjiang sees a significant increasing trend from 1961 to 2010 with an abrupt change in 1986 p 0 01 it sharply increased in the late 1980s after which it became highly variable although a significant drop can be observed over the past decade fig 3c the water vapor in the mountainous region remained in a steady state and provided the moisture condition for the deposition of precipitation the wvp decreases significantly with elevation and the water vapor is mainly observed in the lower levels of the atmosphere yao et al 2016 3 1 4 surface wind speed surface wind speed sws in xinjiang underwent a significant decline of 0 19 m s 1 decade 1 p 0 01 from 1961 to 2010 fig 3d the sws first dropped significantly with a rate of 0 20 m s 1 decade 1 p 0 01 from 1961 to 1990 before reversing to increase at a rate of 0 06 m s 1 decade 1 p 0 05 li et al 2018 also noticed the recovery trend of sws since the early 1990s in northwestern china 3 1 5 sunshine duration sunshine duration is an important indicator of solar radiation changes the global solar radiation has experienced a transition from dimming to brightening since the late 1980s wild et al 2005 and xinjiang has also seen a similar transition the variations of sunshine duration occurred in three stages from 1961 to 2010 an upward trend during the 1960s followed by sustaining dimming until 1987 and then steady brightening since the beginning of the 1990s fig 3d the spatial tendency of sunshine duration exhibits large regional differences fig 4d 3 1 6 pet and et evaporation is a critical factor influencing the hydrological cycle and its control on water loss fig 6 displays the change of pet and actual et over xinjiang from 1961 to 2010 although a decrease in pet has been reported in the northern hemisphere roderick et al 2007 yang and yang 2011 pet in xinjiang exhibited a significant transition from decrease to increase in 1993 with a rate of 27 34 and 51 49 mm decade 1 p 0 01 respectively fig 6a actual measurements of et are limited and this variable is often estimated from other climatic factors and the land surface conditions we used the long term water balance for the 56 catchments in xinjiang and then compare feasibility with budyko model the mean annual actual et estimated by budyko model revealed conspicuous agreement with that calculated from the long term water balance in xinjiang fig 6c with the development of remote sensing global et can be estimated from the widely used modis et product mod16 deng et al 2017 we therefore used mod16 to compare the result of the estimated actual et over xinjiang and the comparison with the estimated actual et yields reasonable results fig 6d r 0 68 the actual et based on the budyko hypothesis showed an obvious increasing trend from 1961 to 2010 at the rate of 6 66 mm decade 1 p 0 05 fig 6b overall the climatic indicators in the xinjiang province experienced a dramatic change in the late 1980s or early 1990s we then split the study period into two stages before and after 1990 and analyzed the detailed changes during each of these periods the analysis also revealed that the air temperature precipitation wvp wind speed sunshine duration pet and actual et changed markedly after 1990 and the changed amount to 0 90 c 26 00 mm 0 43 hpa 0 60 m s 1 64 h 37 37 mm and 17 16 mm respectively 3 2 change of atmospheric water cycle over the xj 3 2 1 moisture flux and budget the background mean climatological moisture transport closely resembled the large scale westerly circulation in the mid latitudes of the northern hemisphere fig 7 a displays the mean state 1961 2010 of the vertically integrated moisture transport and a box covering 75 95 n 35 50 e was used to calculate the moisture budget across the four boundaries the moisture was mainly transported by the midlatitude westerlies yao et al 2016 huang et al 2015 as these flow from the north atlantic and the arctic oceans bringing moisture from these regions across the european continent the caspian and aral seas and central asia into western xinjiang water vapor from the western boundary enters into xinjiang through several zonally oriented valleys such as the yili river kizilsu river and irtysh river valleys which facilitate the moisture transport into the region in addition xinjiang is affected by the indian or southwest monsoon which is related to the occurrence of heavy rain days the monsoon transport of tropical moisture is done mainly among two branches first a southerly water vapor flow originates from the northern indian ocean passes over the tibetan plateau and along its eastern periphery at the low level before bending westward into xinjiang yatagai and yasunari 1998 huang et al 2015 2017 secondly the anomalous anticyclonic system over the arabian sea and central asia leads to the strong transport of water vapor from the arabian sea to central asia which then turns to the east into southern xinjiang yang et al 2018 the moisture inflow into xinjiang comes from the western southern and northern boundaries with respective ratios of 89 3 and 8 respectively the main moisture output occurs at the eastern boundary the north of moisture transport showed an abrupt change in 1976 fig 7d the atmosphere circulation occurred a global shift in 1976 and the mongolian high in winter and indian low in summer had obvious weakness zeng et al 2001 shi and sun 2008 shi 2014 showed that both mongolian high in winter and indian low in summer were closely related to precipitation in xinjiang the net budget of moisture transport displayed an increasing trend from 1961 to 2010 fig 7c which was attributed to the increase of moisture inflow at the southern and western boundaries the moisture transport associated with the precipitation variability in xinjiang was a secondary process as the correlation coefficient between the precipitation and the net moisture budget is 0 37 the correlation coefficient between the precipitation and the moisture transport from the western southern eastern and northern boundaries was 0 55 0 36 0 07 and 0 36 respectively 3 2 2 changes in precipitation recycling fig 8 shows the changes of prr and rp over xinjiang from 1961 to 2010 the average prr values were 6 48 and 7 79 with probable values ranging from 4 87 to 8 07 and from 5 87 to 9 67 for the brubaker and schär model respectively fig 8a the prr increased markedly during 1961 2010 the increasing trend was 0 44 decade 1 and 0 53 decade 1 at the 95 confidence level for each of the respective model fig 8a the annual mean value of rp was 10 37 mm and 12 4 6 mm with ranged of 5 65 mm to 18 49 mm and 6 82 mm to 22 17 mm for each model respectively fig 8b the rp was increasing at a rate of 1 63 mm decade 1 and 1 37 mm decade 1 at the 95 confidence level respectively fig 8b the increasing of prr implied that the regional precipitation recycling intensity had intensified over the past few decades in xinjiang the mann kendall test was conducted to assess changes in the trends of prr and rp the results of this test in fig 9 showed that the trend reversals for both prr and rp over xinjiang occurred in 1980 p 0 001 both of their values exhibited a steep upward trend from the early 1980s to the early 21st century compared with the 1961 1980 period the prr or rp increased by 1 34 or 4 06 mm during the period 1981 2010 which highlighted that the local precipitation recycling was accelerated after 1980 over xinjiang 3 2 3 relationship between prr and climatic factors as climate variability is known to affect the intensity of the global water cycle bosilovich et al 2005 the statistical relationships between the prr and seven climatic factors from 1961 to 2010 were estimated to evaluate their effects on the prr over xinjiang the results summarized in fig 10 showed that the et had a significant positive correlation with the prr and a relatively stronger negative correlation with the pet fig 10a b moreover the precipitation temperature and water vapor all had a significant positive correlation with the prr while prr was negatively correlated with the wind speeds and sunshine duration fig 10c g pet is primarily driven by radiative and aerodynamic components including air temperature mean maximum and minimum water vapor pressure wind speed and sunshine duration allen et al 1998 generally rp is the fraction of precipitation originating from local evaporation which implies that the et is the dominant variable controlling the recycling precipitation while pet is a secondary factor in arid regions et is controlled by changes of the water variables i e precipitation rather than by energy variables i e pet yang et al 2006 yao et al 2018 the strong positive correlation between et and precipitation r 0 97 p 0 001 fig 10h and negative correlation with pet r 0 67 p 0 01 fig 10i confirmed the above theory thus it can be concluded that the prr changes in xinjiang were eventually dominated by the moisture variables for example the precipitation amount and the water vapor condition 3 3 a conceptual framework for the atmospheric water cycle in xinjiang a conceptual framework is proposed here to summarize the climate variability and its associated atmospheric water cycle changes in xinjiang this framework is shown in fig 11 the warming enhances air moistening increases atmospheric water vapor and clouds causing the solar dimming meanwhile asymmetric warming increase surface pressure gradient variations causing the wind speed recovery the warming moistening and wind recovering enhance the pet and actual et trigger convective rainfall and enhance water cycle increase prr and therefore rainfall over the past three decades xinjiang has experienced rapid warming and increased precipitation under the influence of the global warming while the water vapor and wind speed have also increased asymmetric warming over the high and low latitudes gave rise to surface pressure gradient variations leading to a wind speed recovery at the mid latitudes li et al 2018 the pronounced change in pet is mainly attributed to the synchronized change in wind speed and the a synchronized in relative humidity in tarim basin a large oasis region in xinjiang han and hu 2012 based on the clausius clapeyron relation the warming should cause the increase in moisture in the atmosphere with warming by 1 c possibly leading to an increase in atmospheric water vapor by 6 7 bengtsson et al 2011 furthermore the air moistening raised the convective available potential energy which favored the generation of stronger clouds and hence the solar dimming the warming wind speed recovering and increase of vpd enhanced the pet over xinjiang li et al 2013 but in the meantime the solar dimming may weaken it et is a key factor in the water cycle which is related with water and energy balance yao et al 2017 according to budyko s theory the actual land et is essentially controlled by both water and energy variables which are estimated from the changes in precipitation and pet budyko 1974 donohue et al 2011 the long term mean and annual pet in the tarim basin were found to be complementary with actual et influenced by irrigation han and hu 2012 in arid regions however the actual et is controlled by precipitation rather than by pet yang et al 2006 yao et al 2017 the temperature rises and precipitations increase in response to the gain in surface actual et which increases the water holding capacity of the atmosphere houghton et al 2001 bosilovich et al 2005 thus the warming and moistening of the atmosphere have reinforced the local moisture cycle and increased the prr over xinjiang which may trigger more occurrences of convective precipitations an estimate of the annual mean regional atmospheric water cycle in xinjiang is shown in fig 12 the figure reveals that 2804 108 m3 of total precipitation were caused by moisture transport and local evaporation while about 217 108 m3 were recycled precipitations from the local land and vegetation evaporation a large heterogeneity between oasis and desert landscapes or low and high latitudes existed 4 summary and discussion most climatic indicators in xinjiang experienced a dramatic change during the late 1980s or early 1990s during the last two decades the xinjiang region has experienced rapid warming and increased precipitation under the effect of global warming the water vapor has increased and the wind speed has also recovered all these changes contributed to a growth of the pet while the increased precipitation has enhanced the actual surface et the warming and moistening of the atmosphere enhanced the local moisture cycle and increased precipitation recycling over xinjiang through the use of the brubaker model and the schär model the prr was found to increase remarkably from 1961 to 2010 at a rate of 0 44 per decade and 0 53 per decade respectively in particular the prr increased rapidly from the early 1980s to the early 21st century which implied that the local precipitation recycling was accelerated over the last three decades these changes in prr change were mainly dominated by the moisture variables e g actual et precipitation amount and water vapor conditions to summarize the various findings of this study a conceptual framework that explains the climatic variability and associated atmospheric water cycle changes in xinjiang was also proposed as well as an estimate of the regional atmospheric water cycle processes over the region the atmospheric water cycle in xinjiang is unique compared to wet regions or large river basins the xinjiang province is a typical arid region in which the precipitation recycling is a critical process however the estimation of one its essential parameter the prr presents a large uncertainty due to the reliance on estimation models and the lack of observational data such as et li et al 2018 to estimate the prr from the total precipitation amounts several recycling models have been developed on different time scales such as the climate scale budyko 1974 brubaker et al 1993 schär et al 1999 or the daily scale eltahir and bras 1994 dominguez et al 2006 besides the stable isotopes of precipitation are also of great use for understanding precipitation recycling processes as they provide important information about the water cycle in the atmosphere kurita and yamada 2008 zhang and wang 2016 zhang and wang 2018 these however only represent the synoptic scale kurita and yamada 2008 and their measurement from precipitation samples is arduous to estimate the prr in a reliable way a critical element is the precise estimation of the actual et li et al 2018 in most studies evaporation data from era interim and ncep ncar reanalysis data are used but these are grossly overestimated in arid regions furthermore the underlying surface condition such as vegetation irrigation region and land use cover have a direct effect on the change of prr via evaporation vervoort et al 2009 harding and snyder 2014 jomaa et al 2015 the fu s equation for the budyko theory has been widely used to estimate the actual et at different scale from the precipitation pet and landscape condition vegetation cover soil water and topography budyko 1974 fu 1981 zhang et al 2004 yang et al 2006 yao et al 2017 therefore we used the fu s equation for applying the budyko theory in order to estimate the actual et and verified the accuracy of the et based on the mod16 product in this paper the estimated average values of the prr are 6 48 and 7 79 based on the brubaker and the schär model respectively these figures are consistent with the results of li et al 2018 who estimated the change in the prr over four arid regions and found an average of 5 over the china mongolia arid regions the results in the present study are also close from those of kong et al 2013 who found an average value of prr of 8 in urumqi the largest city in central asia and located in the urumqi river vally xinjiang from stable isotope data wang et al 2016 also estimated the prr in xinjiang finding it to be less than 5 in shihezi and caijiahu located in the edge of the gurbantunggut desert xinjiang and up to 16 2 in urumqi oasis as a vital part in the arid ecosystem provides the human survival agricultural production and ecosystem services in arid regions xue et al 2019 in xinjiang the oases supporting more than 95 of the population and more than 90 of social wealth with only about 5 of the land area shi 2014 irrigation farming was commonly practised in most oasis and the large scale cropland irrigation was rapid developed over the past century in xinjiang zhao et al 2012 the large scale irrigation has significantly modified regional rainfall around the world stidd 1975 barnston and schickedanz 1984 deangelis et al 2010 lo and famiglietti 2013 wei et al 2013 im and eltahir 2014 alter et al 2015 however the influence of irrigation effect on rainfall is still disputed alter et al 2015 some studies have indicated that the irrigation can increases rainfall both locally and remotely stidd 1975 barnston and schickedanz 1984 deangelis et al 2010 lo and famiglietti 2013 wei et al 2013 alter et al 2015 but other have argued that no evidence of enhanced precipitation due to irrigation puma and cook 2010 qian et al 2013 im and eltahir 2014 numerical modelling has investigated that the farm irrigation can enhance soil moisture and increase in rainfall in xinjiang zhao et al 2012 in addition irrigation development can enhance near surface atmospheric moisture wetting in growing season in xinjiang han et al 2017 a mechanistic framework proposed by previous studies lee et al 2011 zhao et al 2012 lo and famiglietti 2013 im and eltahir 2014 alter et al 2015 that links irrigation to rainfall increase fig 13 a irrigation can increase soil moisture result in a surface cooling and a surface evaporation increasing enhance atmospheric moisture alter regional wind fields and strengthen convective ascending motion in the low troposphere which provided favorable moisture and dynamic conditions for the local rainfall enhancement xinjiang has a complex terrain that includes three mountain ranges that surrounded the two basins resulting in the mountain basin landscape yao et al 2018 the tianshan mountain is the geographical division between the tarim basin and junggar basin in these topographic conditions the effect of the mountain valley breeze circulation on rainfall is essential in the daytime the valley breeze blows from the oasis to the mountain can increase atmospheric moisture enhances upward vertical motion and rainfall enhancement in the mountainous region fig 13b inversely the mountain breeze blows from the mountain to the oasis in the nighttime and cause the increase in rainfall in the oasis region fig 13c the recycling precipitation accounted for less than 10 of the total precipitation in xinjiang while more than 90 of total precipitation was due to the transport of moisture from outside the region thus it is crucial to investigate moisture sources transport paths and the processes associated to these as the atmospheric water cycle is amplifying with rapid warming and moistening in xinjiang its influence may change the precipitation snow melting and glacier conditions in neighboring regions these changes should further influence the hydrological variability and availability of water resources in central asia credit authorship contribution statement junqiang yao conceptualization writing original draft formal analysis yaning chen conceptualization writing review editing validation yong zhao software validation writing review editing xuefeng guan methodology software formal analysis weiyi mao data curation investigation validation lianmei yang supervision visualization software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was funded by the national key research and development program of china 2018yfa0606403 national natural science foundation of china u1903208 u1903113 41975146 u1603113 open found of state key laboratory of desert and oasis ecology xinjiang institute of ecology and geography cas g2018 02 02 and tianshan youth talents xinjiang plan project 2017q092 
5572,in this study the climate variability and associated atmospheric water cycle changes in the xinjiang china over the past five decades 1961 2010 are investigated the brubaker model and the schär model were used to estimate the regional precipitation recycling on the climate scale while evaporation and transpiration et in the area were estimated via the budyko theory meanwhile we proposed a conceptual framework that delineates the climatic variability and associated atmospheric water cycle changes in xinjiang most of the climatic indicators in xinjiang experienced a dramatic change in the late 1980s or early 1990s rapid warming increased precipitation and water vapor as well as wind strengthening have all been observed over the last two decades all these changes have enhanced the potential evapotranspiration pet and the surface actual et the warming and moistening of the atmosphere reinforced the local moisture cycle and increased precipitation recycling the average values of the precipitation recycling ratio prr were 6 48 and 7 79 for the two models respectively the prr increased remarkably with a strong upward trend from the early 1980s to the early 21st century it implied that the local precipitation recycling had been accelerating over the last three decades the prr changes were dominated by the moisture variables e g actual et precipitation amount and water vapor conditions keywords climate change atmospheric water cycle moisture budget precipitation recycling xinjiang 1 introduction water cycle is a crucial component of earth s climate and environment system trenberth et al 2007 allan and liepert 2010 and has been reported to intensify on the global scale under the effects of global warming huntington 2006 ipcc 2013 as a critical process water cycle is most sensitive to climate warming in arid regions the latter which leads to significant environmental problems li et al 2018 numerous studies have also reported that consequences of changes in the global water cycle are profoundly affecting the environment allan and liepert 2010 the atmospheric water cycle awc is one of the branches of the water cycle process su and feng 2014 it arises from evaporation of the oceans lakes and rivers which is then transported within the atmosphere condenses into clouds and finally precipitates to the ground before evaporating again generally precipitation originates from two sources local evaporation moisture precipitation recycling and external moisture transport advection brubaker et al 1993 burde and zangvil 2001 precipitation recycling is a key element of the water cycle linking the land surface and atmosphere and balancing the water and energy cycles dominguez and kumar 2008 guo and wang 2014 thus the proper understanding and accurate determination of the atmospheric water cycle associated processes is of critical importance for the prediction of changes in the regional hydro climate and water resources and for better adapting to these variations numerous studies have reported changes in the atmospheric water cycle at the global regional and basin scales brubaker et al 1993 fontaine et al 2003 bosilovich et al 2005 huntington 2006 trenberth et al 2007 dominguez and kumar 2008 bengtsson 2010 bengtsson et al 2011 guo and wang 2014 overall the global atmospheric water cycle is intensifying due to the increased evaporation and precipitation associated with a warmer climate however bosilovich et al 2005 stated that as the global precipitable water in the atmosphere increases with the temperature rise the residence time of water in the atmosphere also increases and therefore the global cycling rate decreases conversely huntington 2006 which gathered evidences of changes in hydrologic variables found that the global water cycle is continuously intensifying bengtsson 2010 skliris et al 2016 also suggested the acceleration of the global water cycle but with a cycling rate smaller than the one predicted by the clausius clapeyron equation changes of the atmospheric water cycle present different regional characteristics which have attracted attention over the past few years bengtsson et al 2011 investigated the present and future changes of the global water cycle over polar regions under a warmer climate while fontaine et al 2003 examined the atmospheric water cycle and water vapor fluxes over west africa zheng et al 2017 investigated the change of water budgets over xinjiang china and feng and wu 2016 determined that the hydrological cycle over xinjiang has been intensifying precipitation recycling is a primary process of precipitation especially in arid regions dominguez and kumar 2008 li et al 2018 its regional characteristics are affected by global warming the latter which may lead to changes in precipitation ipcc 2013 many studies were focused on the change of precipitation recycling in vast river basins and low altitude continental regions eltahir and bras 1994 kang et al 2004 2005 dominguez et al 2006 but comparatively few studies focused on arid regions li et al 2018 found that the precipitation recycling is more significant in arid regions than in wet regions and that the correlation with precipitation is different among different arid regions in the tibet plateau the change of precipitation recycling varies by regions showing a decreasing trend in the western arid region while other regions present more adverse changes guo and wang 2014 many precipitation recycling models have been proposed over the past few decades budyko 1974 brubaker et al 1993 eltahir and bras 1994 schär et al 1999 dominguez et al 2006 starting with the one dimensional model proposed by budyko 1974 and later improved and developed into a two dimensional model by brubaker et al 1993 the performance of this updated model has been thoroughly documented by trenberth 1998 and schär et al 1999 which found it to be more suitable to estimate the actual recycling conditions in this paper a systematic study of climate changes over the xinjiang region is provided the atmospheric water cycle processes and their variations from 1961 to 2010 were investigated and the brubaker et al 1993 and schär et al 1999 models were used to investigate the causes responsible for the changes in precipitation recycling and the relationship between precipitation recycling and climatic factors lastly a conceptual framework is presented to summarize these climatic variabilities and the effect they have on the atmospheric water cycle changes in xinjiang 2 data and methodology 2 1 study area the xinjiang region is located in the eastern part of central asia and is the largest province in china being a part of northwestern china it is divided into three sub regions by the tianshan mountain range northern xinjiang tianshan mountains and southern xinjiang fig 1 the climatic regime is controlled by a westerly circulation and the moisture condition is low due to the long distance separating this province from the ocean thus the local precipitation recycling is important to the region s water supply 2 2 data monthly observation data are obtained from 89 stations spread over xinjiang and provided by the china meteorological agency cma these data were collected from 1961 to 2010 and include a complete record of most meteorological factors such as air temperature precipitation water vapor pressure wind speed and sunshine duration monthly specific humidity and wind data were extracted from the ncep ncar reanalysis product with a horizontal resolution of 2 5 latitude longitude grid and 17 pressure levels in the vertical direction kalnay et al 1996 liu and yang 2010 investigated the applicability of the ncep ncar reanalysis data and found that the moisture transportation data was remarkable agreement with that derived from the sounding data in xinjiang china thus the ncep ncar reanalysis data for calculating water vapor transportation was accurate in xinjiang china 2 3 methodology 2 3 1 precipitation recycling model 2 3 1 1 basic scheme fig 2 describes the simplified regional atmospheric water cycle processcomposed of two parts advective moisture transport and local moisture recycling process for any land region x the atmospheric water budget relationship can be expressed as follows 1 δ w q in q out e t p where δ w is the change of water vapor content which is low and always negligible qin and qout represents the column integrated moisture transported into and out of the x area respectively et is the actual evaporation and p is the total precipitation made up of advective pa and evaporative pm sources pa is the fraction of precipitation coming from the advective moisture transport flux and pm is the fraction originating from local evaporation thus the total precipitation in the x region is considered as having two separate components advective and local evaporative and it expressed as 2 p p a p m the precipitation recycling ratio prr which was determined by both the brubaker and schär models is defined as 3 prr β p m p and the recycling precipitation rp expression is 4 rp p p r r 2 3 1 2 brubaker s model the pa pm and et are treated as constants equal to their mean values thus the local evaporated moisture or advected moisture of the air increases decreases linearly brubaker et al 1993 it follows that the horizontal flux of advected moisture qa over the region of area a km2 is 5 q a q in q in p a a 2 q in p a a 2 and the horizontal flux of evaporated moisture qm is 6 q m 0 e t p m a 2 e t p m a 2 as the atmosphere is fully mixed p a p m equals q a q m 7 p a p m q a q m q in p a a 2 e p m a 2 the prr can be therefore be calculated from eqs 2 7 as follows 8 β et a et a 2 q in 2 3 1 3 schär s model similar to equation 1 the individual budget relations were considered with regards to the two components of water that originate from evaporation within the region and from advection transported into the region for the moisture component that derives from within the region the qin disappears while the qout p and δ w are scaled with a factor β consistent with the assumption of a uniform recycling rate schär et al 1999 the two budgets are then given by 9 δ w β q out β e t p β 10 δ w 1 β q in q out 1 β p 1 β solving for β from 9 and 10 and substituting from 1 yields 11 β et et q in 2 3 2 estimation of et using the budyko theory et which is the land surface evaporation and plant transpiration thornthwaite 1948 is a key component in the atmospheric water cycle but is difficult to directly observe on a large scale gao et al 2012 the budyko theory is a widely recognized approach to estimate et budyko 1974 donohue et al 2011 roderick and farquhar 2011 whose analytical solution was proposed by fu 1981 and can be expressed as 17 et p 1 pet p 1 pet p w 1 w where w is a parameter dominated by the water energy partitioning and related to the land surface conditions yang et al 2006 li et al 2013 pet represents potential evapotranspiration several models have been developed to parameterize w fu 1981 choudhury 1999 zhang et al 2001 yang et al 2006 li et al 2013 cong et al 2015 among which that of yao et al 2017 an empirical and physically based model adapted for inland arid regions this model s expression is 18 w 1 81 513 s max pet 1 621 a 0 0233 e x p 2 218 t a n β where s max pet is the relative soil water storage a is the area of the modeled region and t a n β is the average slope of the study region derived from the dem data monthly pet was estimated by the pm equation 19 pet 0 408 δ r n g γ 900 t 273 u 2 e s e a δ γ 1 0 34 u 2 where rn is the net radiation mj m 2 d 1 g is the soil heat flux mj m 2 d 1 γ is the psychrometric constant kpa c 1 δ is the slope of vapor pressure curve kpa c 1 u2 is the wind speed at 2 m m s 1 es is the saturation vapor pressure kpa ea is the actual vapor pressure kpa and t is the mean air temperature at 2 m c 2 3 3 spatio temporal trends of atmospheric water cycle variables the nonparametric mann kendall method mann 1945 kendall 1975 was used to reveal the temporal trend of the climate and atmospheric water cycle variables from 1961 to 2010 this method is recommended by the wmo and used to uncover the significance of trends in climate and atmospheric water cycle variables the pearson s correlation method was employed to reveal the relationship between any two variables as xinjiang is china s largest province and has a wavy topography which impacts greatly on spatially interpolated results the gradient plus inverse distance squared gids method was employed to interpolate the spatial distribution of precipitation and climatic variables based on the dem data nalder and wein 1998 yao et al 2016 gids is a simple robust and accurate interpolation method and combines multiple linear regression and distance weighting this method provides cross validation accuracies and avoid the subjectivity involved in defining variogram models and neighborhoods nalder and wein 1998 annual precipitation and climatic variables were calculated from gridded daily data which was interpolated using gids from the data measured at the meteorological stations and the spatial resolution is 10 10 km yang et al 2014 shi 2014 the same multiple linear regressions developed for detrended kriging were used to define climatic gradients as x y and elevation coefficients these gradients were then used to predict each climate variable for each test site based on the remaining stations the values so obtained were averaged using inverse distance squared weighting nalder and wein 1998 20 z i 1 n z i x x i c x y y i c y e e i c e d i 2 i 1 n 1 d i 2 where z is the estimated climatic variable x and x i are the x coordinates of the test site and climate station i respectively y and y i are the y coordinates of the test site and climate station i respectively e and e i are the elevations of the test site and climate station i respectively and c x c y and c e and regression coefficients for x y and elevation respectively d is the distance from the site to climate station i and n is the number of climate stations used for the interpolation annual et and pet were also estimated using the equation 17 and equation 19 and interpolated using gids method which the spatial resolution is 10 10 km yao et al 2017 investigated the applicability of the equation 17 18 and found that the estimated annual et was remarkable agreement r2 0 918 rmse 23 36 mm with that derived from the long term water balance for 68 catchments in xinjiang china thus the method for estimating et was accurate in xinjiang china 3 results 3 1 effects of climate changes on the xinjiang fig 3 and fig 4 show the spatio temporal changes of various climatic indicators over the xinjiang province including the observed annual mean air temperature mat precipitation water vapor pressure wind speed and sunshine duration estimated from the individual stations data acquired between 1961 and 2010 a detailed description of these changes is provided for each variable in the following chapters 3 1 1 air temperature annual mean air temperature increased significantly between 1961 and 2010 with the elevated rate of 0 328 c decade 1 p 0 01 the mann kendall test revealed that an abrupt change in the mat trend occurred in 1990 with an acceleration of the warming trend after 1990 0 48 c decade 1 p 0 01 compared with the 1961 1989 period 0 10 c decade 1 p 0 05 fig 3a in terms of spatial tendency the whole region showed a rapid warming although spatial variability existed fig 4a 3 1 2 precipitation since the 1960s the xinjiang has experienced a significant increase in annual total precipitation with a wetting trend of 9 46 mm decade 1 p 0 01 and a turning point in 1987 p 0 01 fig 3b after which the annual precipitation increased by 29 6 mm compared with the 1961 1986 period spatially the largest increasing rate occured in the tma with 15 56 mm decade 1 p 0 05 followed by the nxj with a rate of 13 06 mm decade 1 p 0 05 and the sxj with the lowest rate of 5 60 mm decade 1 p 0 05 fig 4b generally elevation has a clear influence on the distribution and variability of climatic factors especially in the case of precipitations in terms of proportion of precipitation regions with total precipitations smaller than 50 mm account for 43 9 of the total areas in xinjiang while the regions where precipitations exceed more than 400 mm only cover 12 3 of the total areas fig 5 b moreover elevation also affects the wetting trend i e there is an elevation dependent wetting edwe in xinjiang yao et al 2016 the elevation dependence is then a crucial process for the evaluation of precipitation variability 3 1 3 water vapor water vapor pressure wvp is a critical climatic factor from which the atmospheric moisture condition is inferred the wvp in xinjiang sees a significant increasing trend from 1961 to 2010 with an abrupt change in 1986 p 0 01 it sharply increased in the late 1980s after which it became highly variable although a significant drop can be observed over the past decade fig 3c the water vapor in the mountainous region remained in a steady state and provided the moisture condition for the deposition of precipitation the wvp decreases significantly with elevation and the water vapor is mainly observed in the lower levels of the atmosphere yao et al 2016 3 1 4 surface wind speed surface wind speed sws in xinjiang underwent a significant decline of 0 19 m s 1 decade 1 p 0 01 from 1961 to 2010 fig 3d the sws first dropped significantly with a rate of 0 20 m s 1 decade 1 p 0 01 from 1961 to 1990 before reversing to increase at a rate of 0 06 m s 1 decade 1 p 0 05 li et al 2018 also noticed the recovery trend of sws since the early 1990s in northwestern china 3 1 5 sunshine duration sunshine duration is an important indicator of solar radiation changes the global solar radiation has experienced a transition from dimming to brightening since the late 1980s wild et al 2005 and xinjiang has also seen a similar transition the variations of sunshine duration occurred in three stages from 1961 to 2010 an upward trend during the 1960s followed by sustaining dimming until 1987 and then steady brightening since the beginning of the 1990s fig 3d the spatial tendency of sunshine duration exhibits large regional differences fig 4d 3 1 6 pet and et evaporation is a critical factor influencing the hydrological cycle and its control on water loss fig 6 displays the change of pet and actual et over xinjiang from 1961 to 2010 although a decrease in pet has been reported in the northern hemisphere roderick et al 2007 yang and yang 2011 pet in xinjiang exhibited a significant transition from decrease to increase in 1993 with a rate of 27 34 and 51 49 mm decade 1 p 0 01 respectively fig 6a actual measurements of et are limited and this variable is often estimated from other climatic factors and the land surface conditions we used the long term water balance for the 56 catchments in xinjiang and then compare feasibility with budyko model the mean annual actual et estimated by budyko model revealed conspicuous agreement with that calculated from the long term water balance in xinjiang fig 6c with the development of remote sensing global et can be estimated from the widely used modis et product mod16 deng et al 2017 we therefore used mod16 to compare the result of the estimated actual et over xinjiang and the comparison with the estimated actual et yields reasonable results fig 6d r 0 68 the actual et based on the budyko hypothesis showed an obvious increasing trend from 1961 to 2010 at the rate of 6 66 mm decade 1 p 0 05 fig 6b overall the climatic indicators in the xinjiang province experienced a dramatic change in the late 1980s or early 1990s we then split the study period into two stages before and after 1990 and analyzed the detailed changes during each of these periods the analysis also revealed that the air temperature precipitation wvp wind speed sunshine duration pet and actual et changed markedly after 1990 and the changed amount to 0 90 c 26 00 mm 0 43 hpa 0 60 m s 1 64 h 37 37 mm and 17 16 mm respectively 3 2 change of atmospheric water cycle over the xj 3 2 1 moisture flux and budget the background mean climatological moisture transport closely resembled the large scale westerly circulation in the mid latitudes of the northern hemisphere fig 7 a displays the mean state 1961 2010 of the vertically integrated moisture transport and a box covering 75 95 n 35 50 e was used to calculate the moisture budget across the four boundaries the moisture was mainly transported by the midlatitude westerlies yao et al 2016 huang et al 2015 as these flow from the north atlantic and the arctic oceans bringing moisture from these regions across the european continent the caspian and aral seas and central asia into western xinjiang water vapor from the western boundary enters into xinjiang through several zonally oriented valleys such as the yili river kizilsu river and irtysh river valleys which facilitate the moisture transport into the region in addition xinjiang is affected by the indian or southwest monsoon which is related to the occurrence of heavy rain days the monsoon transport of tropical moisture is done mainly among two branches first a southerly water vapor flow originates from the northern indian ocean passes over the tibetan plateau and along its eastern periphery at the low level before bending westward into xinjiang yatagai and yasunari 1998 huang et al 2015 2017 secondly the anomalous anticyclonic system over the arabian sea and central asia leads to the strong transport of water vapor from the arabian sea to central asia which then turns to the east into southern xinjiang yang et al 2018 the moisture inflow into xinjiang comes from the western southern and northern boundaries with respective ratios of 89 3 and 8 respectively the main moisture output occurs at the eastern boundary the north of moisture transport showed an abrupt change in 1976 fig 7d the atmosphere circulation occurred a global shift in 1976 and the mongolian high in winter and indian low in summer had obvious weakness zeng et al 2001 shi and sun 2008 shi 2014 showed that both mongolian high in winter and indian low in summer were closely related to precipitation in xinjiang the net budget of moisture transport displayed an increasing trend from 1961 to 2010 fig 7c which was attributed to the increase of moisture inflow at the southern and western boundaries the moisture transport associated with the precipitation variability in xinjiang was a secondary process as the correlation coefficient between the precipitation and the net moisture budget is 0 37 the correlation coefficient between the precipitation and the moisture transport from the western southern eastern and northern boundaries was 0 55 0 36 0 07 and 0 36 respectively 3 2 2 changes in precipitation recycling fig 8 shows the changes of prr and rp over xinjiang from 1961 to 2010 the average prr values were 6 48 and 7 79 with probable values ranging from 4 87 to 8 07 and from 5 87 to 9 67 for the brubaker and schär model respectively fig 8a the prr increased markedly during 1961 2010 the increasing trend was 0 44 decade 1 and 0 53 decade 1 at the 95 confidence level for each of the respective model fig 8a the annual mean value of rp was 10 37 mm and 12 4 6 mm with ranged of 5 65 mm to 18 49 mm and 6 82 mm to 22 17 mm for each model respectively fig 8b the rp was increasing at a rate of 1 63 mm decade 1 and 1 37 mm decade 1 at the 95 confidence level respectively fig 8b the increasing of prr implied that the regional precipitation recycling intensity had intensified over the past few decades in xinjiang the mann kendall test was conducted to assess changes in the trends of prr and rp the results of this test in fig 9 showed that the trend reversals for both prr and rp over xinjiang occurred in 1980 p 0 001 both of their values exhibited a steep upward trend from the early 1980s to the early 21st century compared with the 1961 1980 period the prr or rp increased by 1 34 or 4 06 mm during the period 1981 2010 which highlighted that the local precipitation recycling was accelerated after 1980 over xinjiang 3 2 3 relationship between prr and climatic factors as climate variability is known to affect the intensity of the global water cycle bosilovich et al 2005 the statistical relationships between the prr and seven climatic factors from 1961 to 2010 were estimated to evaluate their effects on the prr over xinjiang the results summarized in fig 10 showed that the et had a significant positive correlation with the prr and a relatively stronger negative correlation with the pet fig 10a b moreover the precipitation temperature and water vapor all had a significant positive correlation with the prr while prr was negatively correlated with the wind speeds and sunshine duration fig 10c g pet is primarily driven by radiative and aerodynamic components including air temperature mean maximum and minimum water vapor pressure wind speed and sunshine duration allen et al 1998 generally rp is the fraction of precipitation originating from local evaporation which implies that the et is the dominant variable controlling the recycling precipitation while pet is a secondary factor in arid regions et is controlled by changes of the water variables i e precipitation rather than by energy variables i e pet yang et al 2006 yao et al 2018 the strong positive correlation between et and precipitation r 0 97 p 0 001 fig 10h and negative correlation with pet r 0 67 p 0 01 fig 10i confirmed the above theory thus it can be concluded that the prr changes in xinjiang were eventually dominated by the moisture variables for example the precipitation amount and the water vapor condition 3 3 a conceptual framework for the atmospheric water cycle in xinjiang a conceptual framework is proposed here to summarize the climate variability and its associated atmospheric water cycle changes in xinjiang this framework is shown in fig 11 the warming enhances air moistening increases atmospheric water vapor and clouds causing the solar dimming meanwhile asymmetric warming increase surface pressure gradient variations causing the wind speed recovery the warming moistening and wind recovering enhance the pet and actual et trigger convective rainfall and enhance water cycle increase prr and therefore rainfall over the past three decades xinjiang has experienced rapid warming and increased precipitation under the influence of the global warming while the water vapor and wind speed have also increased asymmetric warming over the high and low latitudes gave rise to surface pressure gradient variations leading to a wind speed recovery at the mid latitudes li et al 2018 the pronounced change in pet is mainly attributed to the synchronized change in wind speed and the a synchronized in relative humidity in tarim basin a large oasis region in xinjiang han and hu 2012 based on the clausius clapeyron relation the warming should cause the increase in moisture in the atmosphere with warming by 1 c possibly leading to an increase in atmospheric water vapor by 6 7 bengtsson et al 2011 furthermore the air moistening raised the convective available potential energy which favored the generation of stronger clouds and hence the solar dimming the warming wind speed recovering and increase of vpd enhanced the pet over xinjiang li et al 2013 but in the meantime the solar dimming may weaken it et is a key factor in the water cycle which is related with water and energy balance yao et al 2017 according to budyko s theory the actual land et is essentially controlled by both water and energy variables which are estimated from the changes in precipitation and pet budyko 1974 donohue et al 2011 the long term mean and annual pet in the tarim basin were found to be complementary with actual et influenced by irrigation han and hu 2012 in arid regions however the actual et is controlled by precipitation rather than by pet yang et al 2006 yao et al 2017 the temperature rises and precipitations increase in response to the gain in surface actual et which increases the water holding capacity of the atmosphere houghton et al 2001 bosilovich et al 2005 thus the warming and moistening of the atmosphere have reinforced the local moisture cycle and increased the prr over xinjiang which may trigger more occurrences of convective precipitations an estimate of the annual mean regional atmospheric water cycle in xinjiang is shown in fig 12 the figure reveals that 2804 108 m3 of total precipitation were caused by moisture transport and local evaporation while about 217 108 m3 were recycled precipitations from the local land and vegetation evaporation a large heterogeneity between oasis and desert landscapes or low and high latitudes existed 4 summary and discussion most climatic indicators in xinjiang experienced a dramatic change during the late 1980s or early 1990s during the last two decades the xinjiang region has experienced rapid warming and increased precipitation under the effect of global warming the water vapor has increased and the wind speed has also recovered all these changes contributed to a growth of the pet while the increased precipitation has enhanced the actual surface et the warming and moistening of the atmosphere enhanced the local moisture cycle and increased precipitation recycling over xinjiang through the use of the brubaker model and the schär model the prr was found to increase remarkably from 1961 to 2010 at a rate of 0 44 per decade and 0 53 per decade respectively in particular the prr increased rapidly from the early 1980s to the early 21st century which implied that the local precipitation recycling was accelerated over the last three decades these changes in prr change were mainly dominated by the moisture variables e g actual et precipitation amount and water vapor conditions to summarize the various findings of this study a conceptual framework that explains the climatic variability and associated atmospheric water cycle changes in xinjiang was also proposed as well as an estimate of the regional atmospheric water cycle processes over the region the atmospheric water cycle in xinjiang is unique compared to wet regions or large river basins the xinjiang province is a typical arid region in which the precipitation recycling is a critical process however the estimation of one its essential parameter the prr presents a large uncertainty due to the reliance on estimation models and the lack of observational data such as et li et al 2018 to estimate the prr from the total precipitation amounts several recycling models have been developed on different time scales such as the climate scale budyko 1974 brubaker et al 1993 schär et al 1999 or the daily scale eltahir and bras 1994 dominguez et al 2006 besides the stable isotopes of precipitation are also of great use for understanding precipitation recycling processes as they provide important information about the water cycle in the atmosphere kurita and yamada 2008 zhang and wang 2016 zhang and wang 2018 these however only represent the synoptic scale kurita and yamada 2008 and their measurement from precipitation samples is arduous to estimate the prr in a reliable way a critical element is the precise estimation of the actual et li et al 2018 in most studies evaporation data from era interim and ncep ncar reanalysis data are used but these are grossly overestimated in arid regions furthermore the underlying surface condition such as vegetation irrigation region and land use cover have a direct effect on the change of prr via evaporation vervoort et al 2009 harding and snyder 2014 jomaa et al 2015 the fu s equation for the budyko theory has been widely used to estimate the actual et at different scale from the precipitation pet and landscape condition vegetation cover soil water and topography budyko 1974 fu 1981 zhang et al 2004 yang et al 2006 yao et al 2017 therefore we used the fu s equation for applying the budyko theory in order to estimate the actual et and verified the accuracy of the et based on the mod16 product in this paper the estimated average values of the prr are 6 48 and 7 79 based on the brubaker and the schär model respectively these figures are consistent with the results of li et al 2018 who estimated the change in the prr over four arid regions and found an average of 5 over the china mongolia arid regions the results in the present study are also close from those of kong et al 2013 who found an average value of prr of 8 in urumqi the largest city in central asia and located in the urumqi river vally xinjiang from stable isotope data wang et al 2016 also estimated the prr in xinjiang finding it to be less than 5 in shihezi and caijiahu located in the edge of the gurbantunggut desert xinjiang and up to 16 2 in urumqi oasis as a vital part in the arid ecosystem provides the human survival agricultural production and ecosystem services in arid regions xue et al 2019 in xinjiang the oases supporting more than 95 of the population and more than 90 of social wealth with only about 5 of the land area shi 2014 irrigation farming was commonly practised in most oasis and the large scale cropland irrigation was rapid developed over the past century in xinjiang zhao et al 2012 the large scale irrigation has significantly modified regional rainfall around the world stidd 1975 barnston and schickedanz 1984 deangelis et al 2010 lo and famiglietti 2013 wei et al 2013 im and eltahir 2014 alter et al 2015 however the influence of irrigation effect on rainfall is still disputed alter et al 2015 some studies have indicated that the irrigation can increases rainfall both locally and remotely stidd 1975 barnston and schickedanz 1984 deangelis et al 2010 lo and famiglietti 2013 wei et al 2013 alter et al 2015 but other have argued that no evidence of enhanced precipitation due to irrigation puma and cook 2010 qian et al 2013 im and eltahir 2014 numerical modelling has investigated that the farm irrigation can enhance soil moisture and increase in rainfall in xinjiang zhao et al 2012 in addition irrigation development can enhance near surface atmospheric moisture wetting in growing season in xinjiang han et al 2017 a mechanistic framework proposed by previous studies lee et al 2011 zhao et al 2012 lo and famiglietti 2013 im and eltahir 2014 alter et al 2015 that links irrigation to rainfall increase fig 13 a irrigation can increase soil moisture result in a surface cooling and a surface evaporation increasing enhance atmospheric moisture alter regional wind fields and strengthen convective ascending motion in the low troposphere which provided favorable moisture and dynamic conditions for the local rainfall enhancement xinjiang has a complex terrain that includes three mountain ranges that surrounded the two basins resulting in the mountain basin landscape yao et al 2018 the tianshan mountain is the geographical division between the tarim basin and junggar basin in these topographic conditions the effect of the mountain valley breeze circulation on rainfall is essential in the daytime the valley breeze blows from the oasis to the mountain can increase atmospheric moisture enhances upward vertical motion and rainfall enhancement in the mountainous region fig 13b inversely the mountain breeze blows from the mountain to the oasis in the nighttime and cause the increase in rainfall in the oasis region fig 13c the recycling precipitation accounted for less than 10 of the total precipitation in xinjiang while more than 90 of total precipitation was due to the transport of moisture from outside the region thus it is crucial to investigate moisture sources transport paths and the processes associated to these as the atmospheric water cycle is amplifying with rapid warming and moistening in xinjiang its influence may change the precipitation snow melting and glacier conditions in neighboring regions these changes should further influence the hydrological variability and availability of water resources in central asia credit authorship contribution statement junqiang yao conceptualization writing original draft formal analysis yaning chen conceptualization writing review editing validation yong zhao software validation writing review editing xuefeng guan methodology software formal analysis weiyi mao data curation investigation validation lianmei yang supervision visualization software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was funded by the national key research and development program of china 2018yfa0606403 national natural science foundation of china u1903208 u1903113 41975146 u1603113 open found of state key laboratory of desert and oasis ecology xinjiang institute of ecology and geography cas g2018 02 02 and tianshan youth talents xinjiang plan project 2017q092 
5573,in this study a laboratory investigation was conducted to determine the co effect of heterogeneity and solute concentration on dense nonaqueous phase liquids dnapls migration regularity and corresponding representative elementary volume rev four experiments of perchloroethylene pce migration were performed in bench scale two dimensional 2d sandboxes to investigate the revs of pce saturation so pce water interfacial area aow experimental results of migration regularity indicated heterogeneity hindered pce infiltration while higher solute concentration enhance pce migration along horizontal and vertical directions moreover heterogeneity and high solute concentration led to larger values of the second moments and ganglia to pool ratio gtp of pce plume in experiments in comparison with solute concentration rev estimation suggested the heterogeneity has a larger impact on the revs of dnapl plume the heterogeneity of porous media has decreased the mean values of so rev sizes more than 0 79 mm and 1 80 mm under conditions of low and high solute concentrations respectively aow rev sizes due to the heterogeneity of the porous medium were decreased by 46 0 and 51 9 of the average rates under conditions of low and high solute concentrations respectively on the other hand high solute concentration led to a higher mean value of aow rev size while solute concentration had different influences on so rev under respective heterogeneous and homogeneous conditions these phenomena indicated aow rev size has the largest value under conditions of homogeneity and high solute concentration confidence intervals of aow rev sizes for experiment iii homogeneity low solute concentration and experiment iv homogeneity high solute concentration and confidence intervals for experiment i heterogeneity low solute concentration and experiment ii heterogeneity high solute concentration had no overlapping part these experimental results indicate the significant effect of heterogeneity and solute concentration on revs of dnapl plume in groundwater system which is essential to understand the characteristics of scale effect and corresponding migration behaviors of dnapl in a complex subsurface environment keywords migration regularity heterogeneity dense nonaqueous phase liquids dnapl solute concentration representative elementary volume rev 1 introduction due to extensive application of organic products more and more dense non aqueous phase liquids dnapls were released into subsurface environments and have caused groundwater contamination phelan et al 2004 stelzer et al 2009 molnar et al 2011 baldwin et al 2017 cianflone et al 2017 kim et al 2017 mo et al 2017 maire et al 2018 wu et al 2018a the density of dnapl is higher than water while its solubility is very low when dnapl is spilled into groundwater system it will migrate downward through the aquifer as a distinct liquid luciano et al 2010 at the same time dnapl can be trapped as residual ganglia and blobs in the aquifer and accumulated as contaminant pools at barriers and lenses with variation of medium permeability illangasekare et al 1995 these residual and contaminant pools have become persistently dissolved contaminant sources in aquifers which can lead to long term groundwater contamination erning et al 2012 maire and fatin rouge 2017 wu et al 2017 lin et al 2018 during the past decade the groundwater contamination occurs frequently and has brought more and more serious impacts on subsurface environment and groundwater resource c carroll et al 2015 di lorenzo et al 2015 huang et al 2015 liu et al 2016 weathers et al 2016 as a result human health and ecosystem are threatened by subsurface contamination persistently bob et al 2008 liang and lai 2008 liang and hsieh 2015 on the other hand dnapl migration in groundwater is affected by many factors which makes contamination prediction very difficult barranco et al 1997 gioia and urciuolo 2006 o carroll et al 2004 ryder and demond 2008 shi et al 2018 various factors including gravity viscosity capillary pressure interfacial tension contact angle contaminant chemistry background groundwater chemistry and the wettability of solid phase have significant impacts on dnapl transport and redistribution in groundwater barranco et al 1997 bradford et al 1999 lord et al 2000 o carroll et al 2004 gioia and urciuolo 2006 hsu and demond 2007 ryder and demond 2008 stelzer et al 2009 molnar et al 2011 shi et al 2018 it has been recognized that capillary pressure plays an important role in governing the migration and fate of dnapls the capillary force determined by the interfacial tension and contact angle is a measure of wettability of aquifer solid with respect to the dnapls strongly affecting the migration and distribution of dnapls lanhsu and demond 2007 further the wettability of a porous medium depends on dnapl chemistry pore geometry aquifer mineralogy and groundwater chemistry which also has obvious effect on dnapl migration in subsurface environment ramsburg and pennell 2002 o carroll et al 2004 totten et al 2007 molnar et al 2011 moreover the groundwater chemical conditions such as ph ionic strength and surface active agents determine the interfacial tension between solid phase and inner fluid phase and also have obvious influence on migration and distribution of dnapl barranco et al 1997 xing et al 2013 wu et al 2018a the representative elementary volume rev is a fundamental index characterizing the properties of materials and contaminants brown and hsieh 2000 costanza robinson et al 2011 singh 2017 the concept of rev can be expressed by fig 1 d in fig 1d the measured value of system parameter is changed as length scale increases the conceptual figure of rev can be divided into three regions by minimum rev size l min and maximum rev size l max only length scale between the left bound l min and right bound l max can achieve relatively constant values of system parameter as a result it is quite criterial and necessary to quantify the rev scales in region ii while minimum rev size l min and maximum rev size l max are very hard to be measured in reality brown and hsieh 2000 costanza robinson et al 2011 various studies have been conducted to investigate the revs of porous medium properties such as porosity permeability and thermal radiative properties brown and hsieh 2000 al raoush and papadopoulos 2010 costanza robinson et al 2011 al raoush 2012 singh 2017 however so far the impact of heterogeneity and solute concentration on revs of dnapl plume has not been studied in great detail this study was designed to address the effects of heterogeneity and solute concentration on revs of dnapl perchloroethylene pce was selected as characteristic contaminant in laboratory experiments four experiments of pce migration in two dimensional 2d sandboxes were conducted under various conditions of heterogeneity and solute concentration to investigate pce migration and associated revs the analytic solution about pce migration rate and regression analysis for pce plume were conducted to study the migration regularity of pce influenced by heterogeneous and solute concentration conditions associated revs of pce plume were estimated using the relative gradient error ε g i 2 methodology 2 1 laboratory experiment to investigate the effect of heterogeneity and solute concentration on revs of dnapl plume in groundwater system four pce transport experiments were conducted in 2d sandboxes fig 1a c the experimental conditions are illustrated in table 1 the sandboxes had the same dimensions of 60 cm length 45 cm height 1 4 cm thickness moreover each sandbox was composed of three aluminum frames and two pieces of tempered glass plates which facilitated light transmit through the translucent porous medium packed in the sandbox inlet and outlet wells were located on the right and left sides of 2d sandbox respectively fig 1c the porous media used to pack the sandbox were six kinds of commercial translucent silica sands with high purity low content of extraneous component and good translucent property the median grain sizes of f20 30 f30 40 f50 70 f40 50 f70 80 and f70 100 mesh sands were 0 71 mm 0 36 mm 0 26 mm 0 34 mm 0 21 mm and 0 15 mm respectively the porosities of these translucent silica sands were 0 331 0 304 0 249 0 277 0 221 and 0 201 respectively their uniformity indexes were 1 21 1 22 1 17 1 22 1 15 and 1 02 respectively before experiment all translucent silica sands were treated by clean method first translucent silica sands were washed and soaked with 0 25 m nitric acid hno3 solution for 24 h second translucent silica sands were soaked using 0 25 m sodium hydroxide naoh solution for another 24 h third translucent silica sands were washed by deionized water repeatedly to remove wispy residuals lastly silica sands were dried at 45 degrees celsius for 48 h after clean treatment the translucent silica sands were packed into sandboxes by stepwise packing ye et al 2009 2 3 cm dry translucent silica sands were packed into sandbox for the first step in the second step the packed silica sands were saturated with deionized water afterward the packed translucent silica sands were tapped continually with a hammer to achieve a compact pack the background media packed in sandboxes were f20 30 mesh commercial translucent silica sands five lenses with low permeability were set in the sandboxes of experiments i and ii fig 1b to create heterogeneity however the sandboxes of experiments iii and iv fig 1c were packed by only f20 30 mesh silica sand to create homogeneity the tops and bottoms of the sandboxes were packed by thin 70 80 mesh silica sand with low permeability to prevent dnapl and salt water releasing out of the sandboxes the solution used in this study was made from a commercial grade of nacl the two sandboxes used in experiments i and iii were saturated by nacl solution with concentration of 0 585 g l other two sandboxes used in experiments ii and iv were saturated by nacl solution with concentration of 32 g l before every experiment the flow rate of salt water through inlet and outlet wells was kept at a constant value of 1 5 m d afterward pce were injected into sandboxes to observe the pce migration performances affected by heterogeneity and solute concentration 40 ml dyed pce was injected into the sandboxes used in experiments i and ii at constant rate of 0 5 ml min for 80 min from the injection needle fig 1c 32 ml dyed pce was injected into the sandboxes used in experiments iii and iv for 64 min after injection the pce freely infiltrated and migrated in sandboxes for 24 h the liquid density of pce was 1 623 g ml and corresponding viscosity was 0 90 cp the surface tension and interfacial tension were 31 3 dyn cm and 44 4 dyn cm respectively porosity permeability tortuosity pce saturation and pce water interfacial area were measured using light transmission techniques niemet and selker 2001 weisbrod et al 2003 bob et al 2008 wu et al 2017 2 2 quantification of properties of a porous medium and inner dnapl content the light transmission techniques niemet and selker 2001 weisbrod et al 2003 bob et al 2008 wu et al 2017 were used to quantify the properties porosity permeability and tortuosity of a 2d translucent porous medium dnapl saturation and dnapl water interfacial area during an entire migration period fig 2 a 2d light source was placed in front of a sandbox and a thermoelectrically air cooled charged coupled device ccd camera ap2e apogee instruments auburn ca was used to collect the emergent light fig 2 the light source and the sandbox were placed in a dark chamber the temperature was maintained at 22 c 1 0 c during the entire experimental period when a sandbox was saturated with water before pce injection the relationship between porosity θ and emergent light intensity i s can be expressed according to light transmission micro tomography ltm method wu et al 2017 1 ln i s γ θ β where γ and β are constant parameters in ltm which are fitted according to experiment data based on the micro structure of translucent silica sand and the fractal characteristics the permeability and tortuosity were computed as wu et al 2018b 2 k φ θ η 3 τ τ 1 τ 2 2 4 τ 1 χ 1 χ 2 6 3 p 1 2 5 τ 2 1 π 2 χ 3 6 χ 1 1 6 3 2 p 1 2 5 8 p 1 2 p 1 2 2 a r c t a n 3 2 p 1 2 5 8 p 1 7 χ 2 1 4 6 3 p 1 2 1 3 2 p 1 2 2 1 4 2 3 p 1 2 2 2 a r c s i n 1 6 3 p 1 2 8 χ 3 4 π 3 1 θ 4 π 3 1 θ 1 3 2 4 π 3 1 θ 2 3 where τ is tortuosity of the porous medium k is the permeability of the porous medium φ π δ d f 128 4 d f 8 4 d f π δ d f 4 d f 2 d f η 4 d f 2 d f d f is the fractal dimension of the porous medium δ is a constant parameter determined by fractal characteristics of the porous medium p 1 2 2 π 5 1 θ 3 2 when dnapl pce was used as a typical dnapl in this study was injected into a sandbox the dnapl saturation so was estimated by light transmission visualization ltv method niemet and selker 2001 weisbrod et al 2003 bob et al 2008 9 s o ln i s l n i ln i s l n i oil where i s and i oil are the light intensities at each pixel when the sandbox is fully saturated by salt water or fully saturated by oil respectively i is the emergent light intensity after light transmit through the porous medium system including solid particles salt water and dnapl based on the quantification of porosity and dnapl saturation the dnapl water interfacial area aow were obtained costanza robinson et al 2011 wu et al 2017 total specific dnapl water interfacial area is normalized by the associated system volume cm2 cm3 cm 1 during the entire experimental period 0 1523 min samples were taken through four needles to measure pce concentrations which were used to check and correct the errors of ltv method spatial moments are important indexes to characterize the contaminant plume distribution and spatial behavior the definition of spatial moment m ij is expressed as zheng et al 2015 natarajan and kumar 2018 10 m ij x 0 x 1 z 0 z 1 θ x z s 0 x z t x i z j d x d z where i and j refer to the orders of moments θ x z is the porosity at coordinates x z so x z t is dnapl saturation x0 and x1 are the lower and upper limits along direction z0 and z1 are the lower and upper limits along z direction respectively the first order moments and the second order moments are defined as zheng et al 2015 natarajan and kumar 2018 11 x c m 10 m 00 12 z c m 01 m 00 13 σ xx m 20 m 00 x c 2 14 σ zz m 02 m 00 z c 2 where xc and zc are the first order moments of dnapl plume along x and z directions respectively σ xx and σ zz are the second order moments of dnapl plume along x and z directions respectively m00 m10 m01 m20 and m02 are calculated according to eq 10 for example if m10 is being calculated it means that the i index is 1 and j index is 0 ganglia to pool ratio gtp usually is used to suggest as an alternative source zone distribution metric a threshold saturation equal to maximum residual organic saturation is used to calculated gtp when gtp is being quantified the contaminant plume is divided into contaminant distributions dominated by pools and low saturation ganglia gtp is obtained by calculating the ratio of dnapl mass below the threshold saturation to the mass above the threshold saturation christ et al 2006 rev is essential to capture representative characteristics of materials and contaminants brown and hsieh 2000 al raoush and papadopoulos 2010 costanza robinson et al 2011 wu et al 2017 it is feasible to evaluate the effect of a measured scale at which the property of the system tends to be stable fig 1d when the measured scale is small there exist apparent oscillations in values of system property as sample volume fig 1d increases the fluctuation of a system property would decrease and minimize the system property approaches to an average level when measured scale increases further the reappearance of the oscillations of system property is caused by macroscale heterogeneity the relative gradient error ε g i can be used to identify the fluctuations of the system property varying with measured scale when a system property tends to its average level ε g i will decrease and approach zero the ε g i is defined as costanza robinson et al 2011 15 ε g i ϕ i 1 ϕ i 1 ϕ i 1 ϕ i 1 1 δ l where φ is the system property δl is the length increment of system volume 3 results and discussion 3 1 migration regularity when the 2d sandboxes were saturated by pure water corresponding emergent light intensity distributions captured by ccd camera are shown in fig 3 a using the ltm method the porosity of translucent silica sand fig 3a was calculated according to eq 1 it was very easy to distinguish the lenses from heterogeneous porosity distributions of experiments i and ii for experiments iii and iv the sandboxes were packed by only f20 30 mesh translucent silica sand and corresponding porosity distributions were homogeneous associated permeability distributions obtained according to eq 2 and tortuosity calculated according to eq 3 were also presented in fig 3a the distributions of permeability and tortuosity for experiments i and ii exhibited significant variability while the porous media packed in sandboxes of experiments iii and iv were homogeneous the lenses with low permeability and high tortuosity for experiments i and ii were obvious in fig 3a which corresponded to heterogeneous distribution of porous media packed in experiments i and ii the pce saturation profiles obtained from image analysis using ltv method for four experiments were shown in fig 3b the pce spread from the injecting point shaped like a drop of water for all experiments at t 5 min in 2d heterogeneous translucent silica sands experiments i and ii the pce infiltration paths and pce plumes were different from those observed in homogeneous translucent silica sands experiments iii and iv at t 18 min fig 3b the results were caused by the five lenses with low permeability and high tortuosity in experiments i and ii when the pce plume reached the lenses pce accumulated at the top of lenses and migrated laterally cascading over the sides of these lenses in comparison with experiments iii and iv the preferential flow paths and irregular plume were observed in experiments i and ii indicating the heterogeneity has significant impact on pce migration and distribution in porous media these results are consistent with the findings by fagerlund et al 2007 as the experiments progressed the gravitational force gradually became the major driving force and the downward infiltration became dominant mild inclines of pce plumes toward groundwater flow direction were also observed in four experiments fig 3b indicating that the lateral groundwater flow could make pce migration follow the flow direction when pce injection was ended pce then transported in sandbox for a long time until pce mass tended to relatively steady 2d distribution during this period pce plumes would not change with time anymore pennell et al 1996 to investigate the effect of solute concentration and heterogeneity on pce migration the results of moment analysis were illustrated in fig 4 heterogeneity and homogeneity had apparently different influence on all indexes related to pce plume in fig 4 heterogeneity reduced the first order moments of pce plume while the second order moments pce plume and gtp were increased in detail the first order moments of pce plume along horizontal axis for experiments i and ii heterogeneous condition were much lower than the first order moment along axis for experiments iii and iv homogeneous condition fig 4a moreover z c s values in experiments iii and iv were slightly higher than its values in experiments i and ii fig 4b simultaneously heterogeneity reduced the vertical infiltration rates of pce plume from the observation in experiments i and ii while pce mass vertically infiltrated at higher speed in experiments iii and iv fig 4b the second order moments of pce plume along the horizontal axis in experiment i and ii were larger than those in experiment iii and iv fig 4c and d reflecting that the porous media with high heterogeneity can expand the contaminated area the pce plume area results of the four experiments during 0 1523 min fig 4e suggested the heterogeneity has significant effect on pce migration and distribution pce plumes observed in experiments i and ii were larger than the pce plumes observed in experiments iii and iv in addition the gtps of pce plume for all experiments were presented in fig 4f gtp was defined as the ratio of ganglia residual pce to pool lemke et al 2004 christ et al 2006 according to gtp results the gtp of experiment iii was higher than that of experiment i and the gtp of experiment iv was higher than that of experiment ii fig 4f indicating that homogeneity can lead to the increase of gtp of pce plume on the other hand solute concentration also affected these indexes related to pce plume high solute concentration has increased the second order moments and gtp of pce plume in fig 4c and d the second order moments of pce plume along z axis and x axis for experiments ii and iv are higher than the second order moments of experiments i and iii indicating that high solute concentration can lead to larger contamination range when solute concentration was at low level 0 585 g l the contaminated area observed in experiment i heterogeneous porous media exceeded that observed in experiment iii homogeneous porous medium with average absolute error and average relative error of 1 64 10 2 m2 and 56 9 respectively when solute concentration was at high level 32 g l the contaminated area observed in experiment ii heterogeneous porous media was much larger than that observed in experiment iv homogeneous porous media with average absolute error of 2 14 10 2 m2 and relative error of 82 2 further high solute concentration also increased the gtp of the pce fig 4f when gtp increases the residual pce in groundwater system will be much easier to be cleaned efficiently using remediation techniques to analyze the regularity of pce infiltration selecting time dt during the pce infiltration the vertical velocity of pce is regarded as a constant value pce mass if affected by gravity force capillary force and resistance force where gravity capillary force and resistance cancellation in pce mass 16 ρ g h m ρ g h z a h z d h z dt where resistance is a h z d h z dt gravity is ρghz capillary force is ρghm hz is the infiltration depth hm is the height of capillary rise ρ is the density of pce g is the gravitational acceleration a is a coefficient integrating eq 16 yields 17 h z h m l n h z h m ρ g t a taking the derivative of t obtains 18 ν z d h z dt ρ g a 1 h m h z where v z is the infiltration rate of pce plume eq 18 suggested the vertical infiltration rate of pce plume will decrease as infiltration depth increases to find out the migration regularity of pce under different conditions the relationships between hz zc σxx σzz ap plume area gtp and vpce are achieved by regression analysis table 2 the coefficient of determination r2 and derivation were illustrated in table 2 the equation vpce 0 5 t between pce volume and time t can be substituted into the fitted equation between hz and vpce therefore the relationship between infiltration rate and time can be yielded from the infiltration depth equation table 2 the regression analysis and derivations of these parameters were presented in fig 5 a and b the relationship between infiltration depth and injected pce volume was fitted using power law in fig 5a the infiltration depth of pce plume for experiments iii and iv homogeneous condition was larger than hz for experiments i and ii heterogeneous condition the infiltration rate for experiments ii and iv were higher than infiltration rate for experiment i and iii respectively fig 5b the regression analysis for infiltration depth and rate of four experiments indicated heterogeneity will decrease the infiltration depth and rate of pce plume while higher solute concentration of groundwater can enhance pce plume infiltration in porous media in fig 5a zc of experiments iii and iv homogeneous condition was higher than zc of experiments i and ii heterogeneous condition corresponding derivation dzc dvpce displayed in the same way while the value of dzc dvpce decreased with increased pce volume for the change rate of second moment dσxx dvpce of experiments i and ii heterogeneous condition was larger than experiments iii and iv homogeneous condition respectively moreover dσxx dvpce of experiments ii and iv high solute concentration was higher than dσxx dvpce of experiments i and iiii low solute concentration respectively these results showed that heterogeneity and high solute concentration will improve the migration ability of pce along horizontal direction the derivation dσzz dvpce of experiments iii and iv had larger values compared with experiments i and ii indeed the dσzz dvpce of experiments iv exceeded the dσzz dvpce of experiments iii which reflected homogeneity and high solute concentration enhance vertical migration ability of pce plume for the plume area heterogeneity and high solute concentration lead to largest contaminated area of experiment ii fig 5a however the change rate of contaminated area dap dvpce for experiments i and ii are higher than change rate of contaminated area dap dvpce for experiments iii and iv under condition of vpce 15 ml as vpce exceeds 15 ml the change rates of contaminated area dap dvpce for experiment iv have larger value as a matter of fact gtp decreases as pce volume increases and heterogeneity increases gtp value of pce plume 3 2 the revs of dnapl plume the 2d porous media packed in sandboxes were numerically discretized into 40 30 cells with dimensions of 0 015 m 0 015 m five observation cells were selected from the pce plume for every experiment at t 1523 min si 1 si 5 fig 3b were selected from experiment i to observe the so values and ε g i as a function of the measured scale observation cells sii 1 sii 5 siii 1 siii 5 and siv 1 siv 5 were selected from experiments ii iv fig 3b respectively the so aow and corresponding ε g i were measured under different measured scale for all cells the obtained so aow and associated ε g i of observation cells for four experiments were shown in fig 6 a and b when the measured size was at low level erratic variations of measured values of so aow and associated ε g i were observed for incremental growth in measured size which was consistent with the heterogeneity characteristic of region i shown in fig 1d as measured size increases the values of so and aow fluctuate apparently but the rev region is not obvious as a matter of fact it is difficult to conduct rev estimation based on the direct values of so and aow however the ε g i representing the fluctuations of so and aow can be used as a criterion to estimate rev when the value of ε g i remains below 0 2 the measured scale could be regarded as the rev scale costanza robinson et al 2011 based on rev estimation by ε g i the revs of so and aow were obtained as seen from rev scales table 3 the revs of pce plume under heterogeneous condition were mostly lower than those of pce plume under homogeneous condition fig 7 a h showed the variation of revs of so and aow for all observation cells with time for the revs of so the si 1 si 5 and sii 1 sii 5 under heterogeneous condition showed the decreasing trends with some fluctuations over the entire period fig 7a and c while the so revs of siii 1 siii 5 and siv 1 siv 5 presented increasing trends in general fig 7e and g in addition the so revs of si 1 si 5 and sii 1 sii 5 mostly were lower than those of so revs of siii 1 siii 5 and siv 1 siv 5 nevertheless the revs of aow at observation cells si 1 si 5 and sii 1 sii 5 increased in the first few minutes and then kept steady over long time fig 7b and d indeed the aow revs of siii 1 siii 5 and siv 1 siv 5 presented decreasing trends while their average values are higher than those of si 1 si 5 and sii 1 sii 5 respectively the rev estimation results of observation cells suggested both heterogeneity and solution concentration have significant effect on the revs of pce of observation cells so it is necessary to analyze the influences of heterogeneity and solute concentration on revs of pce further the so rev and aow rev sizes of all cells contained in pce profile were estimated and statistically analyzed for four experiments the frequency and cumulative frequency of revs of so during entire experiment periods were shown in fig 8 a theoretical gaussian distributions were used to fit the frequency and cumulative frequency fig 8a at the beginning of the experiment procedure the frequency of so revs presented the shape similar to gaussian distribution with small mean value as pce migrates in 2d porous media the frequency of so rev for four experiments all tended to gaussian distributions with bigger mean values while the shapes of the frequency of so rev observed in experiments tended to be more and more smooth considering the mean value of so rev sizes derived from fitted theoretical gaussian distribution the average sizes of so rev for experiments i ii iii and iv were 6 13 mm 5 30 mm 6 19 mm and 5 82 mm t 1523 min respectively reflecting that high solute concentration experiments ii and iv would reduce the mean value of so rev and low solute concentration experiments i and iii would increase the mean value corresponding standard deviations of so revs of four experiments were 3 26 mm 3 40 mm 3 67 mm and 3 34 mm respectively the results indicated that the heterogeneity and solute concentration had no significant effect on standard deviation of so rev sizes moreover heterogeneity affected so rev since experiments i and ii had slightly lower values of mean of so rev sizes the values of average so rev size and standard deviation reflected that the mean of so rev are more sensitive to solute concentration the statistical analysis of aow revs for four experiments under different conditions of heterogeneity and solute concentration was illustrated in fig 8b from the results of aow rev sizes the shapes of frequency observed in experiments i and ii were very different from those observed in experiments iii and iv fig 8b as time went on the frequency was similar to gaussian distribution in 0 0 9 0 mm and 0 0 12 0 mm for experiments iii and iv respectively during t 21 689 min however the frequency continued to change with time for experiments iii and iv when the porous medium was heterogeneous the frequency of aow revs became very different during the entire t 0 1523 min the frequency shapes of aow revs observed in experiments i and ii were smooth compared to experiments iii and iv after t 80 min the shapes of frequency of aow revs observed in experiments i and ii tended to be steady and the frequency mostly distributed in 0 00 mm 10 00 mm the mean values of aow rev sizes of experiments i ii iii and iv were 3 31 mm 3 45 mm 5 56 mm and 6 79 mm respectively at t 1523 min moreover the standard deviations of aow rev sizes were 2 47 mm 2 28 mm 2 98 mm and 3 39 mm respectively at t 1523 min the results indicated the mean value and standard deviation were lower under heterogeneous condition experiments i and ii than those under homogeneous condition experiments iii and iv moreover the aow rev size was slightly increased when solute concentration became high the mean values of so rev sizes derived from fitted theoretical gaussian distributions were presented in table 3 associated confidence intervals of so rev and aow rev were illustrated in table 4 the confidence intervals of so rev and aow rev were obtained when confidence level is 95 and significance level is 0 05 α 0 05 the average values of so rev for experiments i ii iii and iv were 5 06 mm 4 43 mm 5 84 mm and 6 23 mm respectively for so rev sizes no matter solute concentration was low or high the mean values of so rev sizes observed under homogeneous condition experiments iii and iv are larger than those under heterogeneous condition experiments i and ii with average differences of 0 79 mm and 1 80 mm and relative decrease of 13 5 and 28 9 table 3 respectively the mean values of so rev sizes for four experiments were listed in table 3 as seen from table 3 the average values of so rev for experiments i ii iii and iv were 3 09 mm 3 24 mm 5 73 mm and 6 74 mm respectively the comparison of aow revs indicated that heterogeneity had the same effect on aow rev size heterogeneity reduced the mean value of aow rev sizes with the differences of 2 63 mm decrease by 46 0 and 3 50 mm decrease by 51 9 under the conditions of low and high solute concentrations respectively the mean values of so rev and aow rev sizes were analyzed to study the effect of solute concentration on rev of pce when the porous medium was heterogeneous the mean value of so rev sizes was smaller mean value is 4 43 mm caused by high solute concentration however high solute concentration led to a larger value of so rev sizes when the porous medium was homogeneous mean value is 6 23 mm for aow rev sizes the mean values of aow rev sizes under condition of high solute concentration experiments ii and iv were higher than those under condition of low solute concentration experiments i and iii indicating that high solute concentration could increase aow rev sizes table 3 results of the confidence intervals of so rev and aow rev suggested the upper limits of confidence intervals of so rev for experiments iii and iv are larger than the upper limits of confidence intervals of so rev for experiments i and ii respectively table 4 the lower limits of confidence intervals of so rev for experiments iii and iv are larger than the lower limits of confidence intervals of so rev for experiments i and ii respectively for aow rev confidence intervals for experiments iii and iv and confidence intervals for experiments i and ii have no overlapping part the lower limits of confidence intervals of aow rev for experiments iii and iv are higher than the upper limits of confidence intervals of aow rev for experiments i and ii table 4 in fact the change of rev sizes caused by heterogeneity was much higher than the that caused by solution concentration suggesting that the heterogeneity impose an even stronger impact on so rev and aow rev sizes 4 conclusions four pce transport experiments were conducted in 2d sandboxes to study the co effect of medium heterogeneity and solute concentration on revs of pce plume in subsurface environment results from migration regularity suggested heterogeneity would reduce the first order moments of pce plume while the second order moments of pce plume gtp and contaminated area were increased heterogeneity hindered pce infiltration in experiments while homogeneity enhanced pce infiltration besides higher solute concentration would enhance migration ability of pce plume along horizontal and vertical directions for the revs of pce plume results indicated that heterogeneity had significant influence on so rev and aow rev sizes compared with solute concentration from rev estimations heterogeneity reduced mean value of aow rev sizes by 46 0 and 51 9 under the conditions of low and high solute concentrations respectively simultaneously mean values of so rev sizes were decreased by heterogeneity with decreasing rates of 13 5 and 28 9 under the conditions of low and high solute concentrations respectively on the other hand experimental results reflected high solute concentration could increase the mean values of aow rev sizes while leading to smaller so rev sizes high solute concentration would lead to smaller values of so rev sizes under heterogeneous condition however so rev sizes had relatively larger values caused by high solute concentration under homogeneous condition these results are essential to understand pce transport characteristics in groundwater under complex conditions which helps to derive representative parameters of contamination and improve the efficiency of associated remediation for a contaminated aquifer credit authorship contribution statement ming wu conceptualization methodology yun yang conceptualization jin lin conceptualization jianfeng wu conceptualization methodology jichun wu conceptualization bill x hu conceptualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is financially supported by the national natural science foundation of china 41730856 41772254 and 41902246 and the china postdoctoral science foundation 2017m622905 the authors are also grateful to the editor dr corrado corradini the associate editor dr steve worthington and other three anonymous reviewers whose insightful comments and constructive suggestions have led to substantial improvement of this manuscript 
5573,in this study a laboratory investigation was conducted to determine the co effect of heterogeneity and solute concentration on dense nonaqueous phase liquids dnapls migration regularity and corresponding representative elementary volume rev four experiments of perchloroethylene pce migration were performed in bench scale two dimensional 2d sandboxes to investigate the revs of pce saturation so pce water interfacial area aow experimental results of migration regularity indicated heterogeneity hindered pce infiltration while higher solute concentration enhance pce migration along horizontal and vertical directions moreover heterogeneity and high solute concentration led to larger values of the second moments and ganglia to pool ratio gtp of pce plume in experiments in comparison with solute concentration rev estimation suggested the heterogeneity has a larger impact on the revs of dnapl plume the heterogeneity of porous media has decreased the mean values of so rev sizes more than 0 79 mm and 1 80 mm under conditions of low and high solute concentrations respectively aow rev sizes due to the heterogeneity of the porous medium were decreased by 46 0 and 51 9 of the average rates under conditions of low and high solute concentrations respectively on the other hand high solute concentration led to a higher mean value of aow rev size while solute concentration had different influences on so rev under respective heterogeneous and homogeneous conditions these phenomena indicated aow rev size has the largest value under conditions of homogeneity and high solute concentration confidence intervals of aow rev sizes for experiment iii homogeneity low solute concentration and experiment iv homogeneity high solute concentration and confidence intervals for experiment i heterogeneity low solute concentration and experiment ii heterogeneity high solute concentration had no overlapping part these experimental results indicate the significant effect of heterogeneity and solute concentration on revs of dnapl plume in groundwater system which is essential to understand the characteristics of scale effect and corresponding migration behaviors of dnapl in a complex subsurface environment keywords migration regularity heterogeneity dense nonaqueous phase liquids dnapl solute concentration representative elementary volume rev 1 introduction due to extensive application of organic products more and more dense non aqueous phase liquids dnapls were released into subsurface environments and have caused groundwater contamination phelan et al 2004 stelzer et al 2009 molnar et al 2011 baldwin et al 2017 cianflone et al 2017 kim et al 2017 mo et al 2017 maire et al 2018 wu et al 2018a the density of dnapl is higher than water while its solubility is very low when dnapl is spilled into groundwater system it will migrate downward through the aquifer as a distinct liquid luciano et al 2010 at the same time dnapl can be trapped as residual ganglia and blobs in the aquifer and accumulated as contaminant pools at barriers and lenses with variation of medium permeability illangasekare et al 1995 these residual and contaminant pools have become persistently dissolved contaminant sources in aquifers which can lead to long term groundwater contamination erning et al 2012 maire and fatin rouge 2017 wu et al 2017 lin et al 2018 during the past decade the groundwater contamination occurs frequently and has brought more and more serious impacts on subsurface environment and groundwater resource c carroll et al 2015 di lorenzo et al 2015 huang et al 2015 liu et al 2016 weathers et al 2016 as a result human health and ecosystem are threatened by subsurface contamination persistently bob et al 2008 liang and lai 2008 liang and hsieh 2015 on the other hand dnapl migration in groundwater is affected by many factors which makes contamination prediction very difficult barranco et al 1997 gioia and urciuolo 2006 o carroll et al 2004 ryder and demond 2008 shi et al 2018 various factors including gravity viscosity capillary pressure interfacial tension contact angle contaminant chemistry background groundwater chemistry and the wettability of solid phase have significant impacts on dnapl transport and redistribution in groundwater barranco et al 1997 bradford et al 1999 lord et al 2000 o carroll et al 2004 gioia and urciuolo 2006 hsu and demond 2007 ryder and demond 2008 stelzer et al 2009 molnar et al 2011 shi et al 2018 it has been recognized that capillary pressure plays an important role in governing the migration and fate of dnapls the capillary force determined by the interfacial tension and contact angle is a measure of wettability of aquifer solid with respect to the dnapls strongly affecting the migration and distribution of dnapls lanhsu and demond 2007 further the wettability of a porous medium depends on dnapl chemistry pore geometry aquifer mineralogy and groundwater chemistry which also has obvious effect on dnapl migration in subsurface environment ramsburg and pennell 2002 o carroll et al 2004 totten et al 2007 molnar et al 2011 moreover the groundwater chemical conditions such as ph ionic strength and surface active agents determine the interfacial tension between solid phase and inner fluid phase and also have obvious influence on migration and distribution of dnapl barranco et al 1997 xing et al 2013 wu et al 2018a the representative elementary volume rev is a fundamental index characterizing the properties of materials and contaminants brown and hsieh 2000 costanza robinson et al 2011 singh 2017 the concept of rev can be expressed by fig 1 d in fig 1d the measured value of system parameter is changed as length scale increases the conceptual figure of rev can be divided into three regions by minimum rev size l min and maximum rev size l max only length scale between the left bound l min and right bound l max can achieve relatively constant values of system parameter as a result it is quite criterial and necessary to quantify the rev scales in region ii while minimum rev size l min and maximum rev size l max are very hard to be measured in reality brown and hsieh 2000 costanza robinson et al 2011 various studies have been conducted to investigate the revs of porous medium properties such as porosity permeability and thermal radiative properties brown and hsieh 2000 al raoush and papadopoulos 2010 costanza robinson et al 2011 al raoush 2012 singh 2017 however so far the impact of heterogeneity and solute concentration on revs of dnapl plume has not been studied in great detail this study was designed to address the effects of heterogeneity and solute concentration on revs of dnapl perchloroethylene pce was selected as characteristic contaminant in laboratory experiments four experiments of pce migration in two dimensional 2d sandboxes were conducted under various conditions of heterogeneity and solute concentration to investigate pce migration and associated revs the analytic solution about pce migration rate and regression analysis for pce plume were conducted to study the migration regularity of pce influenced by heterogeneous and solute concentration conditions associated revs of pce plume were estimated using the relative gradient error ε g i 2 methodology 2 1 laboratory experiment to investigate the effect of heterogeneity and solute concentration on revs of dnapl plume in groundwater system four pce transport experiments were conducted in 2d sandboxes fig 1a c the experimental conditions are illustrated in table 1 the sandboxes had the same dimensions of 60 cm length 45 cm height 1 4 cm thickness moreover each sandbox was composed of three aluminum frames and two pieces of tempered glass plates which facilitated light transmit through the translucent porous medium packed in the sandbox inlet and outlet wells were located on the right and left sides of 2d sandbox respectively fig 1c the porous media used to pack the sandbox were six kinds of commercial translucent silica sands with high purity low content of extraneous component and good translucent property the median grain sizes of f20 30 f30 40 f50 70 f40 50 f70 80 and f70 100 mesh sands were 0 71 mm 0 36 mm 0 26 mm 0 34 mm 0 21 mm and 0 15 mm respectively the porosities of these translucent silica sands were 0 331 0 304 0 249 0 277 0 221 and 0 201 respectively their uniformity indexes were 1 21 1 22 1 17 1 22 1 15 and 1 02 respectively before experiment all translucent silica sands were treated by clean method first translucent silica sands were washed and soaked with 0 25 m nitric acid hno3 solution for 24 h second translucent silica sands were soaked using 0 25 m sodium hydroxide naoh solution for another 24 h third translucent silica sands were washed by deionized water repeatedly to remove wispy residuals lastly silica sands were dried at 45 degrees celsius for 48 h after clean treatment the translucent silica sands were packed into sandboxes by stepwise packing ye et al 2009 2 3 cm dry translucent silica sands were packed into sandbox for the first step in the second step the packed silica sands were saturated with deionized water afterward the packed translucent silica sands were tapped continually with a hammer to achieve a compact pack the background media packed in sandboxes were f20 30 mesh commercial translucent silica sands five lenses with low permeability were set in the sandboxes of experiments i and ii fig 1b to create heterogeneity however the sandboxes of experiments iii and iv fig 1c were packed by only f20 30 mesh silica sand to create homogeneity the tops and bottoms of the sandboxes were packed by thin 70 80 mesh silica sand with low permeability to prevent dnapl and salt water releasing out of the sandboxes the solution used in this study was made from a commercial grade of nacl the two sandboxes used in experiments i and iii were saturated by nacl solution with concentration of 0 585 g l other two sandboxes used in experiments ii and iv were saturated by nacl solution with concentration of 32 g l before every experiment the flow rate of salt water through inlet and outlet wells was kept at a constant value of 1 5 m d afterward pce were injected into sandboxes to observe the pce migration performances affected by heterogeneity and solute concentration 40 ml dyed pce was injected into the sandboxes used in experiments i and ii at constant rate of 0 5 ml min for 80 min from the injection needle fig 1c 32 ml dyed pce was injected into the sandboxes used in experiments iii and iv for 64 min after injection the pce freely infiltrated and migrated in sandboxes for 24 h the liquid density of pce was 1 623 g ml and corresponding viscosity was 0 90 cp the surface tension and interfacial tension were 31 3 dyn cm and 44 4 dyn cm respectively porosity permeability tortuosity pce saturation and pce water interfacial area were measured using light transmission techniques niemet and selker 2001 weisbrod et al 2003 bob et al 2008 wu et al 2017 2 2 quantification of properties of a porous medium and inner dnapl content the light transmission techniques niemet and selker 2001 weisbrod et al 2003 bob et al 2008 wu et al 2017 were used to quantify the properties porosity permeability and tortuosity of a 2d translucent porous medium dnapl saturation and dnapl water interfacial area during an entire migration period fig 2 a 2d light source was placed in front of a sandbox and a thermoelectrically air cooled charged coupled device ccd camera ap2e apogee instruments auburn ca was used to collect the emergent light fig 2 the light source and the sandbox were placed in a dark chamber the temperature was maintained at 22 c 1 0 c during the entire experimental period when a sandbox was saturated with water before pce injection the relationship between porosity θ and emergent light intensity i s can be expressed according to light transmission micro tomography ltm method wu et al 2017 1 ln i s γ θ β where γ and β are constant parameters in ltm which are fitted according to experiment data based on the micro structure of translucent silica sand and the fractal characteristics the permeability and tortuosity were computed as wu et al 2018b 2 k φ θ η 3 τ τ 1 τ 2 2 4 τ 1 χ 1 χ 2 6 3 p 1 2 5 τ 2 1 π 2 χ 3 6 χ 1 1 6 3 2 p 1 2 5 8 p 1 2 p 1 2 2 a r c t a n 3 2 p 1 2 5 8 p 1 7 χ 2 1 4 6 3 p 1 2 1 3 2 p 1 2 2 1 4 2 3 p 1 2 2 2 a r c s i n 1 6 3 p 1 2 8 χ 3 4 π 3 1 θ 4 π 3 1 θ 1 3 2 4 π 3 1 θ 2 3 where τ is tortuosity of the porous medium k is the permeability of the porous medium φ π δ d f 128 4 d f 8 4 d f π δ d f 4 d f 2 d f η 4 d f 2 d f d f is the fractal dimension of the porous medium δ is a constant parameter determined by fractal characteristics of the porous medium p 1 2 2 π 5 1 θ 3 2 when dnapl pce was used as a typical dnapl in this study was injected into a sandbox the dnapl saturation so was estimated by light transmission visualization ltv method niemet and selker 2001 weisbrod et al 2003 bob et al 2008 9 s o ln i s l n i ln i s l n i oil where i s and i oil are the light intensities at each pixel when the sandbox is fully saturated by salt water or fully saturated by oil respectively i is the emergent light intensity after light transmit through the porous medium system including solid particles salt water and dnapl based on the quantification of porosity and dnapl saturation the dnapl water interfacial area aow were obtained costanza robinson et al 2011 wu et al 2017 total specific dnapl water interfacial area is normalized by the associated system volume cm2 cm3 cm 1 during the entire experimental period 0 1523 min samples were taken through four needles to measure pce concentrations which were used to check and correct the errors of ltv method spatial moments are important indexes to characterize the contaminant plume distribution and spatial behavior the definition of spatial moment m ij is expressed as zheng et al 2015 natarajan and kumar 2018 10 m ij x 0 x 1 z 0 z 1 θ x z s 0 x z t x i z j d x d z where i and j refer to the orders of moments θ x z is the porosity at coordinates x z so x z t is dnapl saturation x0 and x1 are the lower and upper limits along direction z0 and z1 are the lower and upper limits along z direction respectively the first order moments and the second order moments are defined as zheng et al 2015 natarajan and kumar 2018 11 x c m 10 m 00 12 z c m 01 m 00 13 σ xx m 20 m 00 x c 2 14 σ zz m 02 m 00 z c 2 where xc and zc are the first order moments of dnapl plume along x and z directions respectively σ xx and σ zz are the second order moments of dnapl plume along x and z directions respectively m00 m10 m01 m20 and m02 are calculated according to eq 10 for example if m10 is being calculated it means that the i index is 1 and j index is 0 ganglia to pool ratio gtp usually is used to suggest as an alternative source zone distribution metric a threshold saturation equal to maximum residual organic saturation is used to calculated gtp when gtp is being quantified the contaminant plume is divided into contaminant distributions dominated by pools and low saturation ganglia gtp is obtained by calculating the ratio of dnapl mass below the threshold saturation to the mass above the threshold saturation christ et al 2006 rev is essential to capture representative characteristics of materials and contaminants brown and hsieh 2000 al raoush and papadopoulos 2010 costanza robinson et al 2011 wu et al 2017 it is feasible to evaluate the effect of a measured scale at which the property of the system tends to be stable fig 1d when the measured scale is small there exist apparent oscillations in values of system property as sample volume fig 1d increases the fluctuation of a system property would decrease and minimize the system property approaches to an average level when measured scale increases further the reappearance of the oscillations of system property is caused by macroscale heterogeneity the relative gradient error ε g i can be used to identify the fluctuations of the system property varying with measured scale when a system property tends to its average level ε g i will decrease and approach zero the ε g i is defined as costanza robinson et al 2011 15 ε g i ϕ i 1 ϕ i 1 ϕ i 1 ϕ i 1 1 δ l where φ is the system property δl is the length increment of system volume 3 results and discussion 3 1 migration regularity when the 2d sandboxes were saturated by pure water corresponding emergent light intensity distributions captured by ccd camera are shown in fig 3 a using the ltm method the porosity of translucent silica sand fig 3a was calculated according to eq 1 it was very easy to distinguish the lenses from heterogeneous porosity distributions of experiments i and ii for experiments iii and iv the sandboxes were packed by only f20 30 mesh translucent silica sand and corresponding porosity distributions were homogeneous associated permeability distributions obtained according to eq 2 and tortuosity calculated according to eq 3 were also presented in fig 3a the distributions of permeability and tortuosity for experiments i and ii exhibited significant variability while the porous media packed in sandboxes of experiments iii and iv were homogeneous the lenses with low permeability and high tortuosity for experiments i and ii were obvious in fig 3a which corresponded to heterogeneous distribution of porous media packed in experiments i and ii the pce saturation profiles obtained from image analysis using ltv method for four experiments were shown in fig 3b the pce spread from the injecting point shaped like a drop of water for all experiments at t 5 min in 2d heterogeneous translucent silica sands experiments i and ii the pce infiltration paths and pce plumes were different from those observed in homogeneous translucent silica sands experiments iii and iv at t 18 min fig 3b the results were caused by the five lenses with low permeability and high tortuosity in experiments i and ii when the pce plume reached the lenses pce accumulated at the top of lenses and migrated laterally cascading over the sides of these lenses in comparison with experiments iii and iv the preferential flow paths and irregular plume were observed in experiments i and ii indicating the heterogeneity has significant impact on pce migration and distribution in porous media these results are consistent with the findings by fagerlund et al 2007 as the experiments progressed the gravitational force gradually became the major driving force and the downward infiltration became dominant mild inclines of pce plumes toward groundwater flow direction were also observed in four experiments fig 3b indicating that the lateral groundwater flow could make pce migration follow the flow direction when pce injection was ended pce then transported in sandbox for a long time until pce mass tended to relatively steady 2d distribution during this period pce plumes would not change with time anymore pennell et al 1996 to investigate the effect of solute concentration and heterogeneity on pce migration the results of moment analysis were illustrated in fig 4 heterogeneity and homogeneity had apparently different influence on all indexes related to pce plume in fig 4 heterogeneity reduced the first order moments of pce plume while the second order moments pce plume and gtp were increased in detail the first order moments of pce plume along horizontal axis for experiments i and ii heterogeneous condition were much lower than the first order moment along axis for experiments iii and iv homogeneous condition fig 4a moreover z c s values in experiments iii and iv were slightly higher than its values in experiments i and ii fig 4b simultaneously heterogeneity reduced the vertical infiltration rates of pce plume from the observation in experiments i and ii while pce mass vertically infiltrated at higher speed in experiments iii and iv fig 4b the second order moments of pce plume along the horizontal axis in experiment i and ii were larger than those in experiment iii and iv fig 4c and d reflecting that the porous media with high heterogeneity can expand the contaminated area the pce plume area results of the four experiments during 0 1523 min fig 4e suggested the heterogeneity has significant effect on pce migration and distribution pce plumes observed in experiments i and ii were larger than the pce plumes observed in experiments iii and iv in addition the gtps of pce plume for all experiments were presented in fig 4f gtp was defined as the ratio of ganglia residual pce to pool lemke et al 2004 christ et al 2006 according to gtp results the gtp of experiment iii was higher than that of experiment i and the gtp of experiment iv was higher than that of experiment ii fig 4f indicating that homogeneity can lead to the increase of gtp of pce plume on the other hand solute concentration also affected these indexes related to pce plume high solute concentration has increased the second order moments and gtp of pce plume in fig 4c and d the second order moments of pce plume along z axis and x axis for experiments ii and iv are higher than the second order moments of experiments i and iii indicating that high solute concentration can lead to larger contamination range when solute concentration was at low level 0 585 g l the contaminated area observed in experiment i heterogeneous porous media exceeded that observed in experiment iii homogeneous porous medium with average absolute error and average relative error of 1 64 10 2 m2 and 56 9 respectively when solute concentration was at high level 32 g l the contaminated area observed in experiment ii heterogeneous porous media was much larger than that observed in experiment iv homogeneous porous media with average absolute error of 2 14 10 2 m2 and relative error of 82 2 further high solute concentration also increased the gtp of the pce fig 4f when gtp increases the residual pce in groundwater system will be much easier to be cleaned efficiently using remediation techniques to analyze the regularity of pce infiltration selecting time dt during the pce infiltration the vertical velocity of pce is regarded as a constant value pce mass if affected by gravity force capillary force and resistance force where gravity capillary force and resistance cancellation in pce mass 16 ρ g h m ρ g h z a h z d h z dt where resistance is a h z d h z dt gravity is ρghz capillary force is ρghm hz is the infiltration depth hm is the height of capillary rise ρ is the density of pce g is the gravitational acceleration a is a coefficient integrating eq 16 yields 17 h z h m l n h z h m ρ g t a taking the derivative of t obtains 18 ν z d h z dt ρ g a 1 h m h z where v z is the infiltration rate of pce plume eq 18 suggested the vertical infiltration rate of pce plume will decrease as infiltration depth increases to find out the migration regularity of pce under different conditions the relationships between hz zc σxx σzz ap plume area gtp and vpce are achieved by regression analysis table 2 the coefficient of determination r2 and derivation were illustrated in table 2 the equation vpce 0 5 t between pce volume and time t can be substituted into the fitted equation between hz and vpce therefore the relationship between infiltration rate and time can be yielded from the infiltration depth equation table 2 the regression analysis and derivations of these parameters were presented in fig 5 a and b the relationship between infiltration depth and injected pce volume was fitted using power law in fig 5a the infiltration depth of pce plume for experiments iii and iv homogeneous condition was larger than hz for experiments i and ii heterogeneous condition the infiltration rate for experiments ii and iv were higher than infiltration rate for experiment i and iii respectively fig 5b the regression analysis for infiltration depth and rate of four experiments indicated heterogeneity will decrease the infiltration depth and rate of pce plume while higher solute concentration of groundwater can enhance pce plume infiltration in porous media in fig 5a zc of experiments iii and iv homogeneous condition was higher than zc of experiments i and ii heterogeneous condition corresponding derivation dzc dvpce displayed in the same way while the value of dzc dvpce decreased with increased pce volume for the change rate of second moment dσxx dvpce of experiments i and ii heterogeneous condition was larger than experiments iii and iv homogeneous condition respectively moreover dσxx dvpce of experiments ii and iv high solute concentration was higher than dσxx dvpce of experiments i and iiii low solute concentration respectively these results showed that heterogeneity and high solute concentration will improve the migration ability of pce along horizontal direction the derivation dσzz dvpce of experiments iii and iv had larger values compared with experiments i and ii indeed the dσzz dvpce of experiments iv exceeded the dσzz dvpce of experiments iii which reflected homogeneity and high solute concentration enhance vertical migration ability of pce plume for the plume area heterogeneity and high solute concentration lead to largest contaminated area of experiment ii fig 5a however the change rate of contaminated area dap dvpce for experiments i and ii are higher than change rate of contaminated area dap dvpce for experiments iii and iv under condition of vpce 15 ml as vpce exceeds 15 ml the change rates of contaminated area dap dvpce for experiment iv have larger value as a matter of fact gtp decreases as pce volume increases and heterogeneity increases gtp value of pce plume 3 2 the revs of dnapl plume the 2d porous media packed in sandboxes were numerically discretized into 40 30 cells with dimensions of 0 015 m 0 015 m five observation cells were selected from the pce plume for every experiment at t 1523 min si 1 si 5 fig 3b were selected from experiment i to observe the so values and ε g i as a function of the measured scale observation cells sii 1 sii 5 siii 1 siii 5 and siv 1 siv 5 were selected from experiments ii iv fig 3b respectively the so aow and corresponding ε g i were measured under different measured scale for all cells the obtained so aow and associated ε g i of observation cells for four experiments were shown in fig 6 a and b when the measured size was at low level erratic variations of measured values of so aow and associated ε g i were observed for incremental growth in measured size which was consistent with the heterogeneity characteristic of region i shown in fig 1d as measured size increases the values of so and aow fluctuate apparently but the rev region is not obvious as a matter of fact it is difficult to conduct rev estimation based on the direct values of so and aow however the ε g i representing the fluctuations of so and aow can be used as a criterion to estimate rev when the value of ε g i remains below 0 2 the measured scale could be regarded as the rev scale costanza robinson et al 2011 based on rev estimation by ε g i the revs of so and aow were obtained as seen from rev scales table 3 the revs of pce plume under heterogeneous condition were mostly lower than those of pce plume under homogeneous condition fig 7 a h showed the variation of revs of so and aow for all observation cells with time for the revs of so the si 1 si 5 and sii 1 sii 5 under heterogeneous condition showed the decreasing trends with some fluctuations over the entire period fig 7a and c while the so revs of siii 1 siii 5 and siv 1 siv 5 presented increasing trends in general fig 7e and g in addition the so revs of si 1 si 5 and sii 1 sii 5 mostly were lower than those of so revs of siii 1 siii 5 and siv 1 siv 5 nevertheless the revs of aow at observation cells si 1 si 5 and sii 1 sii 5 increased in the first few minutes and then kept steady over long time fig 7b and d indeed the aow revs of siii 1 siii 5 and siv 1 siv 5 presented decreasing trends while their average values are higher than those of si 1 si 5 and sii 1 sii 5 respectively the rev estimation results of observation cells suggested both heterogeneity and solution concentration have significant effect on the revs of pce of observation cells so it is necessary to analyze the influences of heterogeneity and solute concentration on revs of pce further the so rev and aow rev sizes of all cells contained in pce profile were estimated and statistically analyzed for four experiments the frequency and cumulative frequency of revs of so during entire experiment periods were shown in fig 8 a theoretical gaussian distributions were used to fit the frequency and cumulative frequency fig 8a at the beginning of the experiment procedure the frequency of so revs presented the shape similar to gaussian distribution with small mean value as pce migrates in 2d porous media the frequency of so rev for four experiments all tended to gaussian distributions with bigger mean values while the shapes of the frequency of so rev observed in experiments tended to be more and more smooth considering the mean value of so rev sizes derived from fitted theoretical gaussian distribution the average sizes of so rev for experiments i ii iii and iv were 6 13 mm 5 30 mm 6 19 mm and 5 82 mm t 1523 min respectively reflecting that high solute concentration experiments ii and iv would reduce the mean value of so rev and low solute concentration experiments i and iii would increase the mean value corresponding standard deviations of so revs of four experiments were 3 26 mm 3 40 mm 3 67 mm and 3 34 mm respectively the results indicated that the heterogeneity and solute concentration had no significant effect on standard deviation of so rev sizes moreover heterogeneity affected so rev since experiments i and ii had slightly lower values of mean of so rev sizes the values of average so rev size and standard deviation reflected that the mean of so rev are more sensitive to solute concentration the statistical analysis of aow revs for four experiments under different conditions of heterogeneity and solute concentration was illustrated in fig 8b from the results of aow rev sizes the shapes of frequency observed in experiments i and ii were very different from those observed in experiments iii and iv fig 8b as time went on the frequency was similar to gaussian distribution in 0 0 9 0 mm and 0 0 12 0 mm for experiments iii and iv respectively during t 21 689 min however the frequency continued to change with time for experiments iii and iv when the porous medium was heterogeneous the frequency of aow revs became very different during the entire t 0 1523 min the frequency shapes of aow revs observed in experiments i and ii were smooth compared to experiments iii and iv after t 80 min the shapes of frequency of aow revs observed in experiments i and ii tended to be steady and the frequency mostly distributed in 0 00 mm 10 00 mm the mean values of aow rev sizes of experiments i ii iii and iv were 3 31 mm 3 45 mm 5 56 mm and 6 79 mm respectively at t 1523 min moreover the standard deviations of aow rev sizes were 2 47 mm 2 28 mm 2 98 mm and 3 39 mm respectively at t 1523 min the results indicated the mean value and standard deviation were lower under heterogeneous condition experiments i and ii than those under homogeneous condition experiments iii and iv moreover the aow rev size was slightly increased when solute concentration became high the mean values of so rev sizes derived from fitted theoretical gaussian distributions were presented in table 3 associated confidence intervals of so rev and aow rev were illustrated in table 4 the confidence intervals of so rev and aow rev were obtained when confidence level is 95 and significance level is 0 05 α 0 05 the average values of so rev for experiments i ii iii and iv were 5 06 mm 4 43 mm 5 84 mm and 6 23 mm respectively for so rev sizes no matter solute concentration was low or high the mean values of so rev sizes observed under homogeneous condition experiments iii and iv are larger than those under heterogeneous condition experiments i and ii with average differences of 0 79 mm and 1 80 mm and relative decrease of 13 5 and 28 9 table 3 respectively the mean values of so rev sizes for four experiments were listed in table 3 as seen from table 3 the average values of so rev for experiments i ii iii and iv were 3 09 mm 3 24 mm 5 73 mm and 6 74 mm respectively the comparison of aow revs indicated that heterogeneity had the same effect on aow rev size heterogeneity reduced the mean value of aow rev sizes with the differences of 2 63 mm decrease by 46 0 and 3 50 mm decrease by 51 9 under the conditions of low and high solute concentrations respectively the mean values of so rev and aow rev sizes were analyzed to study the effect of solute concentration on rev of pce when the porous medium was heterogeneous the mean value of so rev sizes was smaller mean value is 4 43 mm caused by high solute concentration however high solute concentration led to a larger value of so rev sizes when the porous medium was homogeneous mean value is 6 23 mm for aow rev sizes the mean values of aow rev sizes under condition of high solute concentration experiments ii and iv were higher than those under condition of low solute concentration experiments i and iii indicating that high solute concentration could increase aow rev sizes table 3 results of the confidence intervals of so rev and aow rev suggested the upper limits of confidence intervals of so rev for experiments iii and iv are larger than the upper limits of confidence intervals of so rev for experiments i and ii respectively table 4 the lower limits of confidence intervals of so rev for experiments iii and iv are larger than the lower limits of confidence intervals of so rev for experiments i and ii respectively for aow rev confidence intervals for experiments iii and iv and confidence intervals for experiments i and ii have no overlapping part the lower limits of confidence intervals of aow rev for experiments iii and iv are higher than the upper limits of confidence intervals of aow rev for experiments i and ii table 4 in fact the change of rev sizes caused by heterogeneity was much higher than the that caused by solution concentration suggesting that the heterogeneity impose an even stronger impact on so rev and aow rev sizes 4 conclusions four pce transport experiments were conducted in 2d sandboxes to study the co effect of medium heterogeneity and solute concentration on revs of pce plume in subsurface environment results from migration regularity suggested heterogeneity would reduce the first order moments of pce plume while the second order moments of pce plume gtp and contaminated area were increased heterogeneity hindered pce infiltration in experiments while homogeneity enhanced pce infiltration besides higher solute concentration would enhance migration ability of pce plume along horizontal and vertical directions for the revs of pce plume results indicated that heterogeneity had significant influence on so rev and aow rev sizes compared with solute concentration from rev estimations heterogeneity reduced mean value of aow rev sizes by 46 0 and 51 9 under the conditions of low and high solute concentrations respectively simultaneously mean values of so rev sizes were decreased by heterogeneity with decreasing rates of 13 5 and 28 9 under the conditions of low and high solute concentrations respectively on the other hand experimental results reflected high solute concentration could increase the mean values of aow rev sizes while leading to smaller so rev sizes high solute concentration would lead to smaller values of so rev sizes under heterogeneous condition however so rev sizes had relatively larger values caused by high solute concentration under homogeneous condition these results are essential to understand pce transport characteristics in groundwater under complex conditions which helps to derive representative parameters of contamination and improve the efficiency of associated remediation for a contaminated aquifer credit authorship contribution statement ming wu conceptualization methodology yun yang conceptualization jin lin conceptualization jianfeng wu conceptualization methodology jichun wu conceptualization bill x hu conceptualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is financially supported by the national natural science foundation of china 41730856 41772254 and 41902246 and the china postdoctoral science foundation 2017m622905 the authors are also grateful to the editor dr corrado corradini the associate editor dr steve worthington and other three anonymous reviewers whose insightful comments and constructive suggestions have led to substantial improvement of this manuscript 
5574,reservoir operation optimization is very important in water resource development and management this paper focuses on the bi objective optimization problems via proposing a novel bi objective algorithm called lion pride algorithm lpa based on the social structure of lion prides and the framework of nsga ii specifically lpa first divides the population into lion prides then classifies the individuals into lion kings and ordinary lions based on the prides and finally assign better fitness values to these lion kings compared to ordinary lions its performance in bi objective optimization is then tested by the benchmark problems and the reservoir operation problems results indicate that 1 lpa outperforms nsga ii in convergence and diversity and runs about 2 to 4 times faster than nsga ii for bi objective optimization 2 lpa has the good optimization ability for the complex problems with sharp peak and long tail pofs and 3 in the reservoir operation problems of this paper the optimization results of lpa weakly dominate 29 to 70 of those of nsga ii while the optimization results of nsga ii only weakly dominate 1 to 22 of those of lpa this study sheds a new idea for bi objective optimization keywords reservoir operation bi objective optimization lion pride algorithm lpa nsga ii 1 introduction reservoir operation optimization is widely used to support decision making in water resource development and management yakowitz 1982 rani and moreira 2009 bradshaw et al 2019 to meet the requirements of society and ecosystem the operations of many reservoir systems need to consider multiple objectives which often contradict each other so an important role of reservoir operation optimization is to balance the conflicting objectives and explore the possible tradeoffs among these objectives guariso et al 1986 labadie 2004 chang et al 2014 ming et al 2017 quinn et al 2019 this paper focuses on the bi objective optimization of reservoir operation the researches on bi objective optimization occupy the majority of all researches on multi objective optimization coello et al 2002 so it is very meaningful to study the reservoir bi objective operation to solve the bi objective problem we chose nsga ii as the main research object deb et al 2002 nsga ii uses three approach the fast nondominated sorting the elitist preserving and the crowding distance which make it faster more convergent and more diverse than nsga and the framework of nsga ii also has a profound impact on many subsequent evolutionary algorithms of course there are many popular and excellent multi objective evolutionary algorithms schaffer 1985 zitzler and thiele 1999 zitzler et al 2001 kim et al 2004 beume et al 2007 hadka and reed 2013 santiago et al 2018 two of state of the art algorithms among them are moea d and nsga iii which use the same crossover and mutation operators as nsga ii although moea d and nsga iii perform better on the optimization problems with more than 2 objectives nsga ii is more suitable for bi objective optimization than them for moea d it runs about twice as fast as nsga ii and has about the same performance as nsga ii in simple bi objective problems zhang and li 2007 however due to the evenly distributed weight vectors when the bi objective problem has a complex pareto optimal front pof e g pof may have a sharp peak or a long tail the performance of moea d will degrade significantly but the performance of nsga ii will not qi et al 2014 ho huu et al 2018 zhang et al 2018 as for nsga iii it follows the framework of nsga ii and performs better than nsga ii or even moea d in handling many objective problems but it runs slower than nsga ii because the reference point based approach of nsga iii needs more computational time than the crowding distance based approach of nsga ii does deb and jain 2014 in addition in bi objective problems nsga iii performs weaker than nsga ii and the complex pof also seriously affects nsga iii andersson et al 2015 jiang and yang 2016 xiao et al 2018 due to the high performance of nsga ii many researches on reservoir bi objective operation have been conducted around nsga ii for example chang and chang 2009 applied nsga ii to improving the joint operating strategies of a two parallel reservoir system for minimizing two conflicting water shortage indices liu et al 2018 used nsga ii for the water energy nexus optimization with the maximization of net energy production and the minimization of water shortages in a cascade reservoir system moreover many studies have focused on improving the performance of this algorithm but most of the new algorithms based on nsga ii framework have improved performance in some aspects compared with nsga ii while sacrificing performance in other aspects for example kourakos and mantoglou 2013 proposed three new criteria of offspring selection for nsga ii to improve the convergence and diversity of the surrogate model of an aquifer management system but did not consider the running speed of nsga ii itself gong et al 2016 replaced the crowding distance in nsga ii with the weighted crowding distance for making the algorithm focus on the nondominated region of the reference point without wasting valuable computational resources on the half dominated region in which decision makers may have no interest and zhang et al 2017 applied the weighted nsga ii wnsga ii to the optimization model of a large scale reservoir system and compared wnsga ii with nsga ii they concluded that the wnsga ii improved convergence but sacrificed diversity yeh 2019 focused on the bi objective optimization problem of the multi state electronic transaction network and proposed an improved nsga ii insga ii by integrating nsga ii and k means algorithm compared with nsga ii insga ii explored the search space more extensively but sacrificed running speed kong et al 2020 improved the crossover operator and the selection strategy of nsga ii based on the non uniform arithmetic crossover and phase out strategy and the improve nsga ii had better convergence and diversity but lower running speed compared with the original nsga ii however few new algorithms can improve convergence diversity and running speed at the same time while having the good ability to optimize the complex pofs even if only in bi objective optimization in this paper inspired by wild lion prides we propose a novel bi objective algorithm called lion pride algorithm lpa which refers to the framework of nsga ii but has a particular method for evaluating individuals specifically firstly lpa divides the population into lion prides secondly individuals are classified into lion kings and ordinary lions based on the lion prides and the slope index finally each lion is evaluated by the differentiated evaluation approach and all lion kings will have better fitness values than all ordinary lions to give the lion kings an advantage in selection in addition to that method the nondominated sorting crowding distance and elitist strategy of nsga ii are also applied to lpa in bi objective optimization compared with nsga ii the lion kings in lpa are more helpful for the algorithm s convergence and the existence of lion prides improves the algorithm s diversity moreover the differentiated evaluation approach greatly improves the running speed of the algorithm furthermore lpa has good optimization ability for the complex problems with sharp peak and long tail pofs in order to test the algorithm performance lpa was applied to the benchmark problems and the reservoir operation problems the optimization models of the reservoir operation problems contained a cascade reservoir model and a single reservoir model in the xijiang river china lpa can be generally applicable to other bi objective problems of reservoir operation the remainder of this paper is organized as follows section 2 details the novel components and the implementation of lpa and section 3 tests the performance of lpa using the benchmark problems next section 4 applies lpa to the reservoir operation problems finally conclusions are drawn in section 5 2 lion pride algorithm the modeling idea of lpa is inspired by the social structure of the wild lion pride most lions live in a social organization known as a pride it is a quite unique characteristic that differentiates lions from the other large cat species of the world and the social structure is reflected in the fact that a wild lion pride is often ruled by one or more male lions these dominant male lions are called lion kings and the rest lions of the pride obey the lion kings in lpa we simply think that there is only one lion king in a pride and the other lions in the pride are considered ordinary lions next we will go into the details of how to divide a population into lion prides and how to classify individuals into lion kings and ordinary lions 2 1 slope index nsga ii evaluates individuals through two indices nondominated rank and crowding distance which are very important to maintain the convergence and diversity of the algorithm deb et al 2002 however we find that these two indices cannot fully reflect the optimization degrees of individuals to a certain extent such as the situation shown in fig 1 in fig 1 a both objectives f 1 and f 2 are to be minimized a b and c are any three individuals adjacent to each other in the same nondominated front and a1 c1 b1 and b 2 c 2 a 2 next we only reduce the ordinate value of c by δ h 0 δ h c 2 b 2 to obtain c in fig 1 b while the maximum and minimum values of objectives in this nondominated front remain unchanged at this point c and c have the same nondominated rank and crowding distance if f 1 represents the ordinate and f 2 represents the abscissa the same can be obtained from c to c under the condition that the value of f 1 is constant the value of f 2 is reduced by δ h however the nondominated rank and crowding distance remain the same in this process it is disadvantageous to c in the individual competition and selection with the evolution of the population the proportion of nondominated individuals increasingly rises and the renewal rate of individuals gradually slows down then the frequency of such situations as shown in fig 1 will increase but the above two indices cannot well reflect the optimization degrees of individuals in these situations especially for nondominated individuals therefore we consider it necessary to introduce a third index to reflect this subtle optimization degree and use this index as the basis for selecting the lion kings in bi objective optimization we use the slope between two adjacent individuals as the third index adjacent means adjacent in the direction of the abscissa axis as shown in fig 2 when the abscissa value of individual m is greater than that of individual n the slope formula between m and n is as follows 1 k m n m 2 n 2 m 1 n 1 where k m n is the slope value between m and n m which has the larger abscissa value in the two individuals is assigned the slope value k m n m 1 and m 2 are the optimized values of m for f 1 and f 2 n 1 and n 2 are the optimized values of n for f 1 and f 2 according to eq 1 and fig 2 we can draw the following conclusions about the slope index 1 k m n represents the optimization decrease degree of m for f 2 when it increases the unit value on f 1 relative to n therefore the smaller the slope value k m n is the higher the optimization degree of m is for f 2 2 when k m n 0 m is not only inferior to n on f 1 but also worse than or equal to n on f 2 at this time m is dominated by n fig 2 a b 3 when k m n 0 m is inferior to n on f 1 but it is superior to n on f 2 so m and n do not dominate each other fig 2 c notice that if m 1 n 1 and m 2 n 2 then k m n 0 and m dominated n which contradicts the above conclusion 3 so the slope index cannot accurately judge the dominance relationship between adjacent individuals which have the same abscissa values in order to show the effect of this deficiency of the slope index on the proportion of nondominated solutions in final solutions we do not deal with this deficiency separately in this paper 2 2 population division and individual classification lpa first divides the population into lion prides and then classifies the individuals in each pride into a lion king and some ordinary lions based on the slope index a principle of population division is that individuals in the same pride should have similar objective values on the same objective so the pride will be disbanded if the objective values of individuals in this pride differ greatly on an objective dimension at the same time the slope index value is affected by the population shape for example as shown in fig 3 a the slope index values of the individuals in area a is generally less than those in area b therefore the pride size should be small otherwise the slope index will be meaningless the approach of population division used in this paper is as follows fig 3 b first the projection range of the population on the abscissa is divided into m equal parts then the population is divided into m lion prides according to the abscissa intervals corresponding to the m equal parts and the maximum length of the abscissa interval of each pride is l x finally the lion pride in which the ordinate values of the individuals differ greatly will be disbanded the method to judge the pride disbandment is as follows 1 the projection length of a pride i on the ordinate is l y i i 1 2 m 2 if l y i r l x r 1 then the ordinate values of at least two individuals in the pride i have a large difference which violates the above principle of the population division and the pride i will be disbanded 3 if l y i r l x then the ordinate values of all individuals in the pride i have a small difference so the pride i will not be disbanded of course it is possible that there is no individual in a pride such as the lion pride m 1 in fig 3 b we do not need to do anything for this kind of pride in this paper r is set to be 2 and m is set to be the size of the population which needs to be divided after the slope index and the population division the individual classification will start the detailed steps of individual classification are shown in fig 4 first to consider different objectives we let the two objectives take turns as the abscissa during the program iteration fig 4 a then all individuals with slopes greater than or equal to 0 in the population are eliminated fig 4 b next the population is divided into lion prides and the remaining individuals are classified into lion kings and ordinary lions based on prides while the two boundary individuals of the population are selected as lion kings fig 4 c finally in order to ensure that enough lions can participate in the following calculation we will randomly select a certain number of individuals from the eliminated individuals as ordinary lions if necessary fig 4 d 2 3 differentiated evaluation and implementation of lpa to protect lion kings we use the differentiated evaluation approach to evaluate lions this approach has two indices individual rank and crowding distance which refers to the individual evaluation method of nsga ii in the differentiated evaluation approach the individual rank of each ordinary lion is equal to the nondominated rank of this lion among all ordinary lions nondominated ranks are all non negative numbers and the individual ranks of all lion kings are equal to the same negative number e g 1 as for the calculation method of the crowding distance in lpa it is the same as that in nsga ii then we define the rule for lion comparisons the individual rank is compared preferentially and the smaller the individual rank is the better the lion is if the individual ranks are the same the lion with the larger crowding distance will be better this rule ensures that lion kings have an advantage over ordinary lions in lion comparisons finally the implementation of lpa is shown in fig 5 in lpa the object of individual classification is the whole individuals in the combined population and the threshold k is designed to control whether these individuals need to be classified because the low number of lion kings is not conducive to the extension of the nondominated front especially at an early stage of evolution if the number of all lion kings is greater than or equal to k lpa will use differentiated evaluation for all lions otherwise all individuals in combined population will be directly evaluated as ordinary lions by default k is set to be half the size of the parent population to have a fair comparison in the next section in both lpa and nsga ii the sizes of the parent population offspring population and new population are all n and the size of the combined population is 2 n and the operators of selection crossover and mutation are the tournament selection simulated binary crossover and polynomial mutation respectively 3 solving benchmark problems using lpa 3 1 zdt test problems as shown in table 1 five real coded zdt test problems are used for comparing lpa with nsga ii and the binary coded test problem zdt5 is excluded from the experiments zitzler et al 2000 because all algorithms in this paper are real coded all objective functions in these test problems are to be minimized these zdt problems can comprehensively test the performance of an algorithm zdt1 has a convex pof while zdt2 has a nonconvex one zdt3 s pof consists of several discontinuous convex parts and the two objectives are disparately scaled in the pof zdt4 contains 219 different local optimal fronts in the search space and the search space of zdt6 is nonuniform 3 2 performance metrics for multiobjective evolutionary algorithms we mainly analyze an algorithm and its nondominated front from the following four aspects 1 the convergence of the nondominated front 2 the diversity of the nondominated front 3 the proportion of nondominated solutions in final solutions 4 the running time of the algorithm many performance metrics have been used for measuring the performance of algorithms from different angles deb 2001 zitzler et al 2003 zhang and li 2007 in our tests we use the convergence metric ϒ and the diversity metric δ to evaluate the nondominated front obtained by an algorithm deb et al 2002 and record the proportion of nondominated solutions in final solutions and the running time of the algorithm the description of the above two metrics is as follows 1 convergence metric ϒ the convergence metric ϒ measures the average distance of the nondominated front to the pof where the nondominated front is the corresponding set of the objective vectors of all nondominated solutions obtained by an algorithm fig 6 a the detailed calculation of ϒ is as follows 2 γ 1 n i 1 n c i where n is the number of nondominated solutions c i is the minimum euclidean distance between the nondominated solution p i and the pof when the nondominated front is closer to pof the value of the convergence metric is smaller and the minimum value of this metric is 0 2 diversity metric δ the diversity metric δ considers both uniformity and extent of the distribution for the nondominated front fig 6 b the detailed calculation of δ is as follows 3 δ d f d l i 1 n 1 d i d d f d l n 1 d where d i is the euclidean distance between p i and p i 1 d is the average of all distances d i d f and d l are the euclidean distance between the boundary solutions of the nondominated front and the extreme solutions of the pof the best value of the diversity metric is equal to 0 which represents all distances d i are equal to d the most uniform distribution and d f d l 0 the largest distribution extent for any other distribution of the nondominated front the value of this metric is greater than 0 3 3 test results and discussion in this study we set some of the same parameters for lpa and nsga ii table 2 both algorithms are run until 30 000 function evaluations are done for each test problem we let each algorithm run independently 50 times in the same computer environment fig 7 shows the overall distribution of the values of the convergence and diversity metrics for lpa and nsga ii in zdt problems the smaller the two metrics are the better the corresponding performance of the algorithm is it is obvious that the convergence and diversity of lpa are better than those of nsga ii in all zdt problems fig 8 shows the nondominated front with the diversity metric median in each test problem the nondominated fronts of lpa can converge well to the pofs of all zdt problems table 3 presents the proportion of nondominated solutions and the running time of each algorithm for each test problem because of a deficiency of the slope index section 2 1 the proportion of nondominated solutions in lpa is slightly less than that in nsga ii but lpa runs about 2 to 4 times faster than nsga ii finally we test algorithms on the complex problems with sharp peak and long tail pofs we refer to zdt1 and zdt2 to construct complex problems the general form f k of zdt1 and zdt2 is as follows 4 f 1 x x 1 f 2 x g x 1 x 1 g x k g x 1 9 i 2 n x i n 1 where n is the number of variables and n 30 the bounds of variables are all 0 1 the optimal solutions are x 1 0 1 and x i 0 i 2 3 n k is a positive number when k is equal to 0 5 and 2 f 0 5 and f 2 are zdt1 and zdt2 respectively we take k equal to 0 1 and 10 respectively and test the optimization ability of different algorithms for complex problems f 0 1 and f 10 the pofs of f k under different k values are shown in fig 9 at the same time we also show the optimization results of nsga iii and moea d in complex problems the simulated binary crossover and polynomial mutation are the same in all algorithms and the neighborhood size of each weight vector in moea d is set to be 20 due to the complexity of f 0 1 and f 10 we set the population size and function evaluations of each algorithm to be 100 and 50000 respectively fig 10 shows the distributions of nondominated fronts of different algorithms for f 0 1 and f 10 for f 0 1 problem the nondominated fronts of nsga iii and moea d are not only poorly distributed in the upper left region of the pof but also sparsely distributed in the lower right region of the pof however the nondominated fronts of lpa and nsga ii are completely distributed around the whole pof of this problem for f 10 problem compared with nsga iii and moea d the distributions of nondominated fronts of lpa and nsga ii are better in the upper left region of the pof to sum up in bi objective optimization although lpa is at a slight disadvantage in the proportion of nondominated solutions lpa is superior to nsga ii in both convergence and diversity and runs about 2 to 4 times faster than nsga ii at the same time lpa also solves some complex problems with long tail and sharp peak pofs well 4 solving reservoir operation problems using lpa 4 1 optimization model of reservoir operation 4 1 1 cascade reservoir model the cascade reservoir system table 4 consisting of tianyi ty reservoir longtan lt reservoir and yantan yt reservoir located in the middle and upper reaches of the xijiang river in china was used for a case study in china the lt hydropower station is the second largest one after the three gorges hydropower station the other two reservoirs ty reservoir and yt reservoir are also national key projects this cascade reservoir system is mainly for power generation and plays an extremely important role in the national west east electricity transmission project for reservoir long term hydropower operation it is contradictory between the maximization of the annual hydropower generation and the maximization of the minimum monthly output in the reservoir system the pursuit of maximizing the annual hydropower generation will cause the water level fluctuations of reservoirs to become severe however increasing the minimum monthly output requires a relatively gentle water level change therefore we chose the maximization of the annual hydropower generation of the cascade system and the maximization of the minimum monthly output of the cascade system as the two operation objectives eq 5 to explore the trade offs between the two objectives and test the performance of algorithms in reservoir operation optimization the operation period of the optimization model is a hydrological year that ranges from may of the first year to april of the second year with a monthly time step and the time lags of water flow between different reservoirs are not considered based on a hydrological frequency analysis of the monthly inflow data of the ty reservoir three hydrological years were selected as the operation periods the wet normal and dry years the corresponding empirical probabilities of water volumes were nearly 25 50 and 75 respectively for each reservoir the initial and final water levels are equal to the multi year average water level at the beginning of may the decision variable of the model is the monthly average outflow of each reservoir since the final water level of each reservoir is known the average outflow of the reservoir in the last month can be uniquely determined by the water levels at the beginning and end of this month so there are 11 decision variables for each reservoir and 33 decision variables for the cascade system the operation objectives and constraints of the optimization model are as follows 1 operation objectives 5 maximize o b j e c t i v e 1 min t m 1 m n m t maximize o b j e c t i v e 2 t 1 t m 1 m e m t 2 water balance constraint between reservoirs 6 i m t o m 1 t q local m t q divert m t q loss m t 3 water balance constraint of a reservoir 7 v m t 1 v m t i m t o m t l m t δ t 4 reservoir outflow constraint 8 o min m t o m t o max m t 5 reservoir water level constraint 9 z dead m t z m t z normal f l o o d m t 6 output constraint of hydropower station 10 n firm m n m t n installed m 7 maximum overflow capacity constraint of hydropower station 11 q ele m t q e l e max m 8 variable non negative constraint in the above formulas m is the reservoir number and m 3 t is the month number and t 12 for the reservoir m in month t i m t o m t l m t o min m t and o max m t are respectively the average inflow the average outflow the water loss the minimum outflow and the maximum outflow m3 s q local m t q divert m t and q loss m t are respectively the average local inflow the water diversion and the water loss in the reach between the reservoir m 1 and reservoir m m3 s v m t is the storage 106m3 and z m t is the water level m of the reservoir m at the beginning of the month t z dead m t is the dead water level m and z normal f l o o d m t is the normal water level in non flood season or the flood control water level in flood season m e m t is the hydropower generation 108kwh n m t n firm m and n install m are respectively the average output the firm output and the installed capacity of the hydropower station mw q e l e max m is the maximum turbine flows allowed by the hydropower station m3 s for the operation objectives since both lpa and nsga ii in this paper are written for the minimization problems we multiply these two objectives in eq 5 by 1 to meet the requirement of algorithms for the objective type the exterior penalty function method joines and houck 1994 antczak 2017 is applied to punish solutions which violates any constraint thus transforming the constrained problem into an unconstrained problem as a result the constraints in eqs 6 7 the upper limits of the constraints in eqs 9 11 and the non negative constraint on variables can be automatically modified in the model besides the upper limit of constraint in eq 8 as well as the reservoir safety discharge can be ignored in long term reservoir operation then the penalty function p a b is constructed according to the lower limits of the constraints in eqs 8 10 12 d o m t max 0 o min m t o m t o min m t d z m t max 0 z dead m t z m t z dead m t d n m t max 0 n firm m n m t n firm m p α β α t 1 t m 1 m d o β m t t 1 t m 1 m d z β m t t 1 t m 1 m d n β m t where α is a big number to distinguish between feasible and infeasible solutions and α 0 β is used to widen the penalty gap between mild and severe constraint violations in infeasible solutions and β 1 so the final objective functions used for function evaluation in algorithms are as follows 13 minimize f 1 o b j e c t i v e 1 p α 1 β 1 minimize f 2 o b j e c t i v e 2 p α 2 β 2 by analyzing the preliminary results of the model we let α 1 1 10 9 and α 2 1 10 8 which are much larger than the objective values and let β 1 β 2 2 4 1 2 single reservoir model besides the cascade reservoir model we built a single reservoir model based on the lt reservoir this model is a simplified version of the cascade reservoir model in which the ty reservoir and yt reservoir do not participate in the optimization the single reservoir model has a total of 11 decision variables and its operation objectives are as follows 14 maximize o b j e c t i v e 1 min t n t maximize o b j e c t i v e 2 t 1 t e t the constraints penalty function and final objective functions in the single reservoir model are no longer listed in this paper because they are the same as the corresponding parts of the lt reservoir in the cascade reservoir model based on a hydrological frequency analysis of the monthly inflow data of the lt reservoir three hydrological years were selected as the operation periods the wet normal and dry years 4 2 performance metric the calculation of convergence and diversity metric requires the pareto optimal front of an optimization problem but pareto optimal front cannot be found in many practical engineering optimization problems therefore coverage metric is used in this paper to compare the optimization results of different algorithms for reservoir optimization operation coverage metric does not need any pareto optimal front or reference point but can directly compare two nondominated sets by computing the percentage of the solutions in one set that are weakly dominated by at least one solution in the other set zitzler and thiele 1999 zhang and li 2007 suppose that we have two nondominated sets obtained by different algorithms denoted as a and b the coverage metric value c a b is calculated as follows 15 c a b b b a a a b b where b is the number of elements in the set b is the symbol of weak domination and a b represents that a equals or dominates b c a b is not necessarily equal to 1 c b a c a b 1 means that all solutions in b are weakly dominated by some solutions in a while c a b 0 implies that no solution in b is weakly dominated by a solution in a so both c a b and c b a must be considered 4 3 operation results and discussion in addition to the optimization operation we also did the simulation operation for both cascade reservoirs and lt reservoir and used it as a reference the simulation operation considers both the actual plan of hydropower generation and the above constraints and the simulation operation for each reservoir has the same initial and final water levels as the optimization operation in the reservoir operation optimization both lpa and nsga ii have 5000 evolutionary generations and 500 000 function evaluations and the other parameter values are consistent with those in table 2 for each algorithm based on the nondominated rank and crowding distance we selected the best 100 nondominated solutions from the results of 20 model runs of each scenario as the optimization result of the corresponding scenario and compared the optimization results of different algorithms by the coverage metric fig 11 shows the optimization and simulation results of reservoir operation models all the solutions in the optimization results obtained by algorithms are feasible solutions which satisfy all the model constraints compared with simulation results the optimization results improve the minimum monthly output and annual hydropower generation of cascade reservoirs and single reservoir and provide a wealth of optimal schemes for reservoir operation table 5 presents the coverage metric values between the optimization results of lpa and nsga ii for each scenario if c a b c b a then the optimization results of lpa is better than that of nsga ii whether in cascade reservoir scenarios or single reservoir scenarios c a b is greater than c b a indicating that the optimization results of lpa are better than those of nsga ii in various scenarios in addition the minimum and maximum values of c a b are 0 29 and 0 70 respectively indicating that the optimization results of lpa can weakly dominate 29 to 70 of those of nsga ii while the optimization results of nsga ii only weakly dominate 1 to 22 of thoes of lpa table 6 shows the mean values of the proportion of nondominated solutions and the running time for each model run for the reservoir models in this paper although the proportion of nondominated solutions in lpa is slightly less than that in nsga ii the running time of the model based on lpa is about 10 to 28 shorter than that of the model based on nsga ii we can conclude from the above results that lpa outperforms nsga ii in the bi objective optimization of reservoir operation compared with nsga ii lpa can obtain better optimization results in a shorter time 5 conclusion in this paper a novel bi objective algorithm named lion pride algorithm lpa was proposed based on the social structure of lion prides and the framework of nsga ii its effectiveness in bi objective optimization was then evaluated by the benchmark problems and the reservoir operation problems in the xijiang river china we concluded as following 1 lpa was better than nsga ii in terms of convergence and diversity for bi objective optimization and it ran about 2 to 4 times faster than nsga ii 2 lpa had the good optimization ability for the complex problems with sharp peak and long tail pofs and 3 in the reservoir operation problems of this paper the optimization results of lpa weakly dominated 29 to 70 of those of nsga ii while the optimization results of nsga ii only weakly dominated 1 to 22 of those of lpa in our future work the deficiency of slope index which puts lpa at a disadvantage in the proportion of nondominated solutions will become a problem we need to solve and we may try to improve the optimization model of the reservoir system from multiple aspects such as search space constraint processing and function evaluation credit authorship contribution statement dong liu writing original draft formal analysis methodology software qiang huang supervision funding acquisition yuanyuan yang conceptualization validation writing review editing resources project administration dengfeng liu visualization investigation xiaoting wei data curation software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research was jointly funded by the china postdoctoral science foundation funded project grant number 2019m653882xb and the national key research and development program of china grant number 2017yfc0405900 
5574,reservoir operation optimization is very important in water resource development and management this paper focuses on the bi objective optimization problems via proposing a novel bi objective algorithm called lion pride algorithm lpa based on the social structure of lion prides and the framework of nsga ii specifically lpa first divides the population into lion prides then classifies the individuals into lion kings and ordinary lions based on the prides and finally assign better fitness values to these lion kings compared to ordinary lions its performance in bi objective optimization is then tested by the benchmark problems and the reservoir operation problems results indicate that 1 lpa outperforms nsga ii in convergence and diversity and runs about 2 to 4 times faster than nsga ii for bi objective optimization 2 lpa has the good optimization ability for the complex problems with sharp peak and long tail pofs and 3 in the reservoir operation problems of this paper the optimization results of lpa weakly dominate 29 to 70 of those of nsga ii while the optimization results of nsga ii only weakly dominate 1 to 22 of those of lpa this study sheds a new idea for bi objective optimization keywords reservoir operation bi objective optimization lion pride algorithm lpa nsga ii 1 introduction reservoir operation optimization is widely used to support decision making in water resource development and management yakowitz 1982 rani and moreira 2009 bradshaw et al 2019 to meet the requirements of society and ecosystem the operations of many reservoir systems need to consider multiple objectives which often contradict each other so an important role of reservoir operation optimization is to balance the conflicting objectives and explore the possible tradeoffs among these objectives guariso et al 1986 labadie 2004 chang et al 2014 ming et al 2017 quinn et al 2019 this paper focuses on the bi objective optimization of reservoir operation the researches on bi objective optimization occupy the majority of all researches on multi objective optimization coello et al 2002 so it is very meaningful to study the reservoir bi objective operation to solve the bi objective problem we chose nsga ii as the main research object deb et al 2002 nsga ii uses three approach the fast nondominated sorting the elitist preserving and the crowding distance which make it faster more convergent and more diverse than nsga and the framework of nsga ii also has a profound impact on many subsequent evolutionary algorithms of course there are many popular and excellent multi objective evolutionary algorithms schaffer 1985 zitzler and thiele 1999 zitzler et al 2001 kim et al 2004 beume et al 2007 hadka and reed 2013 santiago et al 2018 two of state of the art algorithms among them are moea d and nsga iii which use the same crossover and mutation operators as nsga ii although moea d and nsga iii perform better on the optimization problems with more than 2 objectives nsga ii is more suitable for bi objective optimization than them for moea d it runs about twice as fast as nsga ii and has about the same performance as nsga ii in simple bi objective problems zhang and li 2007 however due to the evenly distributed weight vectors when the bi objective problem has a complex pareto optimal front pof e g pof may have a sharp peak or a long tail the performance of moea d will degrade significantly but the performance of nsga ii will not qi et al 2014 ho huu et al 2018 zhang et al 2018 as for nsga iii it follows the framework of nsga ii and performs better than nsga ii or even moea d in handling many objective problems but it runs slower than nsga ii because the reference point based approach of nsga iii needs more computational time than the crowding distance based approach of nsga ii does deb and jain 2014 in addition in bi objective problems nsga iii performs weaker than nsga ii and the complex pof also seriously affects nsga iii andersson et al 2015 jiang and yang 2016 xiao et al 2018 due to the high performance of nsga ii many researches on reservoir bi objective operation have been conducted around nsga ii for example chang and chang 2009 applied nsga ii to improving the joint operating strategies of a two parallel reservoir system for minimizing two conflicting water shortage indices liu et al 2018 used nsga ii for the water energy nexus optimization with the maximization of net energy production and the minimization of water shortages in a cascade reservoir system moreover many studies have focused on improving the performance of this algorithm but most of the new algorithms based on nsga ii framework have improved performance in some aspects compared with nsga ii while sacrificing performance in other aspects for example kourakos and mantoglou 2013 proposed three new criteria of offspring selection for nsga ii to improve the convergence and diversity of the surrogate model of an aquifer management system but did not consider the running speed of nsga ii itself gong et al 2016 replaced the crowding distance in nsga ii with the weighted crowding distance for making the algorithm focus on the nondominated region of the reference point without wasting valuable computational resources on the half dominated region in which decision makers may have no interest and zhang et al 2017 applied the weighted nsga ii wnsga ii to the optimization model of a large scale reservoir system and compared wnsga ii with nsga ii they concluded that the wnsga ii improved convergence but sacrificed diversity yeh 2019 focused on the bi objective optimization problem of the multi state electronic transaction network and proposed an improved nsga ii insga ii by integrating nsga ii and k means algorithm compared with nsga ii insga ii explored the search space more extensively but sacrificed running speed kong et al 2020 improved the crossover operator and the selection strategy of nsga ii based on the non uniform arithmetic crossover and phase out strategy and the improve nsga ii had better convergence and diversity but lower running speed compared with the original nsga ii however few new algorithms can improve convergence diversity and running speed at the same time while having the good ability to optimize the complex pofs even if only in bi objective optimization in this paper inspired by wild lion prides we propose a novel bi objective algorithm called lion pride algorithm lpa which refers to the framework of nsga ii but has a particular method for evaluating individuals specifically firstly lpa divides the population into lion prides secondly individuals are classified into lion kings and ordinary lions based on the lion prides and the slope index finally each lion is evaluated by the differentiated evaluation approach and all lion kings will have better fitness values than all ordinary lions to give the lion kings an advantage in selection in addition to that method the nondominated sorting crowding distance and elitist strategy of nsga ii are also applied to lpa in bi objective optimization compared with nsga ii the lion kings in lpa are more helpful for the algorithm s convergence and the existence of lion prides improves the algorithm s diversity moreover the differentiated evaluation approach greatly improves the running speed of the algorithm furthermore lpa has good optimization ability for the complex problems with sharp peak and long tail pofs in order to test the algorithm performance lpa was applied to the benchmark problems and the reservoir operation problems the optimization models of the reservoir operation problems contained a cascade reservoir model and a single reservoir model in the xijiang river china lpa can be generally applicable to other bi objective problems of reservoir operation the remainder of this paper is organized as follows section 2 details the novel components and the implementation of lpa and section 3 tests the performance of lpa using the benchmark problems next section 4 applies lpa to the reservoir operation problems finally conclusions are drawn in section 5 2 lion pride algorithm the modeling idea of lpa is inspired by the social structure of the wild lion pride most lions live in a social organization known as a pride it is a quite unique characteristic that differentiates lions from the other large cat species of the world and the social structure is reflected in the fact that a wild lion pride is often ruled by one or more male lions these dominant male lions are called lion kings and the rest lions of the pride obey the lion kings in lpa we simply think that there is only one lion king in a pride and the other lions in the pride are considered ordinary lions next we will go into the details of how to divide a population into lion prides and how to classify individuals into lion kings and ordinary lions 2 1 slope index nsga ii evaluates individuals through two indices nondominated rank and crowding distance which are very important to maintain the convergence and diversity of the algorithm deb et al 2002 however we find that these two indices cannot fully reflect the optimization degrees of individuals to a certain extent such as the situation shown in fig 1 in fig 1 a both objectives f 1 and f 2 are to be minimized a b and c are any three individuals adjacent to each other in the same nondominated front and a1 c1 b1 and b 2 c 2 a 2 next we only reduce the ordinate value of c by δ h 0 δ h c 2 b 2 to obtain c in fig 1 b while the maximum and minimum values of objectives in this nondominated front remain unchanged at this point c and c have the same nondominated rank and crowding distance if f 1 represents the ordinate and f 2 represents the abscissa the same can be obtained from c to c under the condition that the value of f 1 is constant the value of f 2 is reduced by δ h however the nondominated rank and crowding distance remain the same in this process it is disadvantageous to c in the individual competition and selection with the evolution of the population the proportion of nondominated individuals increasingly rises and the renewal rate of individuals gradually slows down then the frequency of such situations as shown in fig 1 will increase but the above two indices cannot well reflect the optimization degrees of individuals in these situations especially for nondominated individuals therefore we consider it necessary to introduce a third index to reflect this subtle optimization degree and use this index as the basis for selecting the lion kings in bi objective optimization we use the slope between two adjacent individuals as the third index adjacent means adjacent in the direction of the abscissa axis as shown in fig 2 when the abscissa value of individual m is greater than that of individual n the slope formula between m and n is as follows 1 k m n m 2 n 2 m 1 n 1 where k m n is the slope value between m and n m which has the larger abscissa value in the two individuals is assigned the slope value k m n m 1 and m 2 are the optimized values of m for f 1 and f 2 n 1 and n 2 are the optimized values of n for f 1 and f 2 according to eq 1 and fig 2 we can draw the following conclusions about the slope index 1 k m n represents the optimization decrease degree of m for f 2 when it increases the unit value on f 1 relative to n therefore the smaller the slope value k m n is the higher the optimization degree of m is for f 2 2 when k m n 0 m is not only inferior to n on f 1 but also worse than or equal to n on f 2 at this time m is dominated by n fig 2 a b 3 when k m n 0 m is inferior to n on f 1 but it is superior to n on f 2 so m and n do not dominate each other fig 2 c notice that if m 1 n 1 and m 2 n 2 then k m n 0 and m dominated n which contradicts the above conclusion 3 so the slope index cannot accurately judge the dominance relationship between adjacent individuals which have the same abscissa values in order to show the effect of this deficiency of the slope index on the proportion of nondominated solutions in final solutions we do not deal with this deficiency separately in this paper 2 2 population division and individual classification lpa first divides the population into lion prides and then classifies the individuals in each pride into a lion king and some ordinary lions based on the slope index a principle of population division is that individuals in the same pride should have similar objective values on the same objective so the pride will be disbanded if the objective values of individuals in this pride differ greatly on an objective dimension at the same time the slope index value is affected by the population shape for example as shown in fig 3 a the slope index values of the individuals in area a is generally less than those in area b therefore the pride size should be small otherwise the slope index will be meaningless the approach of population division used in this paper is as follows fig 3 b first the projection range of the population on the abscissa is divided into m equal parts then the population is divided into m lion prides according to the abscissa intervals corresponding to the m equal parts and the maximum length of the abscissa interval of each pride is l x finally the lion pride in which the ordinate values of the individuals differ greatly will be disbanded the method to judge the pride disbandment is as follows 1 the projection length of a pride i on the ordinate is l y i i 1 2 m 2 if l y i r l x r 1 then the ordinate values of at least two individuals in the pride i have a large difference which violates the above principle of the population division and the pride i will be disbanded 3 if l y i r l x then the ordinate values of all individuals in the pride i have a small difference so the pride i will not be disbanded of course it is possible that there is no individual in a pride such as the lion pride m 1 in fig 3 b we do not need to do anything for this kind of pride in this paper r is set to be 2 and m is set to be the size of the population which needs to be divided after the slope index and the population division the individual classification will start the detailed steps of individual classification are shown in fig 4 first to consider different objectives we let the two objectives take turns as the abscissa during the program iteration fig 4 a then all individuals with slopes greater than or equal to 0 in the population are eliminated fig 4 b next the population is divided into lion prides and the remaining individuals are classified into lion kings and ordinary lions based on prides while the two boundary individuals of the population are selected as lion kings fig 4 c finally in order to ensure that enough lions can participate in the following calculation we will randomly select a certain number of individuals from the eliminated individuals as ordinary lions if necessary fig 4 d 2 3 differentiated evaluation and implementation of lpa to protect lion kings we use the differentiated evaluation approach to evaluate lions this approach has two indices individual rank and crowding distance which refers to the individual evaluation method of nsga ii in the differentiated evaluation approach the individual rank of each ordinary lion is equal to the nondominated rank of this lion among all ordinary lions nondominated ranks are all non negative numbers and the individual ranks of all lion kings are equal to the same negative number e g 1 as for the calculation method of the crowding distance in lpa it is the same as that in nsga ii then we define the rule for lion comparisons the individual rank is compared preferentially and the smaller the individual rank is the better the lion is if the individual ranks are the same the lion with the larger crowding distance will be better this rule ensures that lion kings have an advantage over ordinary lions in lion comparisons finally the implementation of lpa is shown in fig 5 in lpa the object of individual classification is the whole individuals in the combined population and the threshold k is designed to control whether these individuals need to be classified because the low number of lion kings is not conducive to the extension of the nondominated front especially at an early stage of evolution if the number of all lion kings is greater than or equal to k lpa will use differentiated evaluation for all lions otherwise all individuals in combined population will be directly evaluated as ordinary lions by default k is set to be half the size of the parent population to have a fair comparison in the next section in both lpa and nsga ii the sizes of the parent population offspring population and new population are all n and the size of the combined population is 2 n and the operators of selection crossover and mutation are the tournament selection simulated binary crossover and polynomial mutation respectively 3 solving benchmark problems using lpa 3 1 zdt test problems as shown in table 1 five real coded zdt test problems are used for comparing lpa with nsga ii and the binary coded test problem zdt5 is excluded from the experiments zitzler et al 2000 because all algorithms in this paper are real coded all objective functions in these test problems are to be minimized these zdt problems can comprehensively test the performance of an algorithm zdt1 has a convex pof while zdt2 has a nonconvex one zdt3 s pof consists of several discontinuous convex parts and the two objectives are disparately scaled in the pof zdt4 contains 219 different local optimal fronts in the search space and the search space of zdt6 is nonuniform 3 2 performance metrics for multiobjective evolutionary algorithms we mainly analyze an algorithm and its nondominated front from the following four aspects 1 the convergence of the nondominated front 2 the diversity of the nondominated front 3 the proportion of nondominated solutions in final solutions 4 the running time of the algorithm many performance metrics have been used for measuring the performance of algorithms from different angles deb 2001 zitzler et al 2003 zhang and li 2007 in our tests we use the convergence metric ϒ and the diversity metric δ to evaluate the nondominated front obtained by an algorithm deb et al 2002 and record the proportion of nondominated solutions in final solutions and the running time of the algorithm the description of the above two metrics is as follows 1 convergence metric ϒ the convergence metric ϒ measures the average distance of the nondominated front to the pof where the nondominated front is the corresponding set of the objective vectors of all nondominated solutions obtained by an algorithm fig 6 a the detailed calculation of ϒ is as follows 2 γ 1 n i 1 n c i where n is the number of nondominated solutions c i is the minimum euclidean distance between the nondominated solution p i and the pof when the nondominated front is closer to pof the value of the convergence metric is smaller and the minimum value of this metric is 0 2 diversity metric δ the diversity metric δ considers both uniformity and extent of the distribution for the nondominated front fig 6 b the detailed calculation of δ is as follows 3 δ d f d l i 1 n 1 d i d d f d l n 1 d where d i is the euclidean distance between p i and p i 1 d is the average of all distances d i d f and d l are the euclidean distance between the boundary solutions of the nondominated front and the extreme solutions of the pof the best value of the diversity metric is equal to 0 which represents all distances d i are equal to d the most uniform distribution and d f d l 0 the largest distribution extent for any other distribution of the nondominated front the value of this metric is greater than 0 3 3 test results and discussion in this study we set some of the same parameters for lpa and nsga ii table 2 both algorithms are run until 30 000 function evaluations are done for each test problem we let each algorithm run independently 50 times in the same computer environment fig 7 shows the overall distribution of the values of the convergence and diversity metrics for lpa and nsga ii in zdt problems the smaller the two metrics are the better the corresponding performance of the algorithm is it is obvious that the convergence and diversity of lpa are better than those of nsga ii in all zdt problems fig 8 shows the nondominated front with the diversity metric median in each test problem the nondominated fronts of lpa can converge well to the pofs of all zdt problems table 3 presents the proportion of nondominated solutions and the running time of each algorithm for each test problem because of a deficiency of the slope index section 2 1 the proportion of nondominated solutions in lpa is slightly less than that in nsga ii but lpa runs about 2 to 4 times faster than nsga ii finally we test algorithms on the complex problems with sharp peak and long tail pofs we refer to zdt1 and zdt2 to construct complex problems the general form f k of zdt1 and zdt2 is as follows 4 f 1 x x 1 f 2 x g x 1 x 1 g x k g x 1 9 i 2 n x i n 1 where n is the number of variables and n 30 the bounds of variables are all 0 1 the optimal solutions are x 1 0 1 and x i 0 i 2 3 n k is a positive number when k is equal to 0 5 and 2 f 0 5 and f 2 are zdt1 and zdt2 respectively we take k equal to 0 1 and 10 respectively and test the optimization ability of different algorithms for complex problems f 0 1 and f 10 the pofs of f k under different k values are shown in fig 9 at the same time we also show the optimization results of nsga iii and moea d in complex problems the simulated binary crossover and polynomial mutation are the same in all algorithms and the neighborhood size of each weight vector in moea d is set to be 20 due to the complexity of f 0 1 and f 10 we set the population size and function evaluations of each algorithm to be 100 and 50000 respectively fig 10 shows the distributions of nondominated fronts of different algorithms for f 0 1 and f 10 for f 0 1 problem the nondominated fronts of nsga iii and moea d are not only poorly distributed in the upper left region of the pof but also sparsely distributed in the lower right region of the pof however the nondominated fronts of lpa and nsga ii are completely distributed around the whole pof of this problem for f 10 problem compared with nsga iii and moea d the distributions of nondominated fronts of lpa and nsga ii are better in the upper left region of the pof to sum up in bi objective optimization although lpa is at a slight disadvantage in the proportion of nondominated solutions lpa is superior to nsga ii in both convergence and diversity and runs about 2 to 4 times faster than nsga ii at the same time lpa also solves some complex problems with long tail and sharp peak pofs well 4 solving reservoir operation problems using lpa 4 1 optimization model of reservoir operation 4 1 1 cascade reservoir model the cascade reservoir system table 4 consisting of tianyi ty reservoir longtan lt reservoir and yantan yt reservoir located in the middle and upper reaches of the xijiang river in china was used for a case study in china the lt hydropower station is the second largest one after the three gorges hydropower station the other two reservoirs ty reservoir and yt reservoir are also national key projects this cascade reservoir system is mainly for power generation and plays an extremely important role in the national west east electricity transmission project for reservoir long term hydropower operation it is contradictory between the maximization of the annual hydropower generation and the maximization of the minimum monthly output in the reservoir system the pursuit of maximizing the annual hydropower generation will cause the water level fluctuations of reservoirs to become severe however increasing the minimum monthly output requires a relatively gentle water level change therefore we chose the maximization of the annual hydropower generation of the cascade system and the maximization of the minimum monthly output of the cascade system as the two operation objectives eq 5 to explore the trade offs between the two objectives and test the performance of algorithms in reservoir operation optimization the operation period of the optimization model is a hydrological year that ranges from may of the first year to april of the second year with a monthly time step and the time lags of water flow between different reservoirs are not considered based on a hydrological frequency analysis of the monthly inflow data of the ty reservoir three hydrological years were selected as the operation periods the wet normal and dry years the corresponding empirical probabilities of water volumes were nearly 25 50 and 75 respectively for each reservoir the initial and final water levels are equal to the multi year average water level at the beginning of may the decision variable of the model is the monthly average outflow of each reservoir since the final water level of each reservoir is known the average outflow of the reservoir in the last month can be uniquely determined by the water levels at the beginning and end of this month so there are 11 decision variables for each reservoir and 33 decision variables for the cascade system the operation objectives and constraints of the optimization model are as follows 1 operation objectives 5 maximize o b j e c t i v e 1 min t m 1 m n m t maximize o b j e c t i v e 2 t 1 t m 1 m e m t 2 water balance constraint between reservoirs 6 i m t o m 1 t q local m t q divert m t q loss m t 3 water balance constraint of a reservoir 7 v m t 1 v m t i m t o m t l m t δ t 4 reservoir outflow constraint 8 o min m t o m t o max m t 5 reservoir water level constraint 9 z dead m t z m t z normal f l o o d m t 6 output constraint of hydropower station 10 n firm m n m t n installed m 7 maximum overflow capacity constraint of hydropower station 11 q ele m t q e l e max m 8 variable non negative constraint in the above formulas m is the reservoir number and m 3 t is the month number and t 12 for the reservoir m in month t i m t o m t l m t o min m t and o max m t are respectively the average inflow the average outflow the water loss the minimum outflow and the maximum outflow m3 s q local m t q divert m t and q loss m t are respectively the average local inflow the water diversion and the water loss in the reach between the reservoir m 1 and reservoir m m3 s v m t is the storage 106m3 and z m t is the water level m of the reservoir m at the beginning of the month t z dead m t is the dead water level m and z normal f l o o d m t is the normal water level in non flood season or the flood control water level in flood season m e m t is the hydropower generation 108kwh n m t n firm m and n install m are respectively the average output the firm output and the installed capacity of the hydropower station mw q e l e max m is the maximum turbine flows allowed by the hydropower station m3 s for the operation objectives since both lpa and nsga ii in this paper are written for the minimization problems we multiply these two objectives in eq 5 by 1 to meet the requirement of algorithms for the objective type the exterior penalty function method joines and houck 1994 antczak 2017 is applied to punish solutions which violates any constraint thus transforming the constrained problem into an unconstrained problem as a result the constraints in eqs 6 7 the upper limits of the constraints in eqs 9 11 and the non negative constraint on variables can be automatically modified in the model besides the upper limit of constraint in eq 8 as well as the reservoir safety discharge can be ignored in long term reservoir operation then the penalty function p a b is constructed according to the lower limits of the constraints in eqs 8 10 12 d o m t max 0 o min m t o m t o min m t d z m t max 0 z dead m t z m t z dead m t d n m t max 0 n firm m n m t n firm m p α β α t 1 t m 1 m d o β m t t 1 t m 1 m d z β m t t 1 t m 1 m d n β m t where α is a big number to distinguish between feasible and infeasible solutions and α 0 β is used to widen the penalty gap between mild and severe constraint violations in infeasible solutions and β 1 so the final objective functions used for function evaluation in algorithms are as follows 13 minimize f 1 o b j e c t i v e 1 p α 1 β 1 minimize f 2 o b j e c t i v e 2 p α 2 β 2 by analyzing the preliminary results of the model we let α 1 1 10 9 and α 2 1 10 8 which are much larger than the objective values and let β 1 β 2 2 4 1 2 single reservoir model besides the cascade reservoir model we built a single reservoir model based on the lt reservoir this model is a simplified version of the cascade reservoir model in which the ty reservoir and yt reservoir do not participate in the optimization the single reservoir model has a total of 11 decision variables and its operation objectives are as follows 14 maximize o b j e c t i v e 1 min t n t maximize o b j e c t i v e 2 t 1 t e t the constraints penalty function and final objective functions in the single reservoir model are no longer listed in this paper because they are the same as the corresponding parts of the lt reservoir in the cascade reservoir model based on a hydrological frequency analysis of the monthly inflow data of the lt reservoir three hydrological years were selected as the operation periods the wet normal and dry years 4 2 performance metric the calculation of convergence and diversity metric requires the pareto optimal front of an optimization problem but pareto optimal front cannot be found in many practical engineering optimization problems therefore coverage metric is used in this paper to compare the optimization results of different algorithms for reservoir optimization operation coverage metric does not need any pareto optimal front or reference point but can directly compare two nondominated sets by computing the percentage of the solutions in one set that are weakly dominated by at least one solution in the other set zitzler and thiele 1999 zhang and li 2007 suppose that we have two nondominated sets obtained by different algorithms denoted as a and b the coverage metric value c a b is calculated as follows 15 c a b b b a a a b b where b is the number of elements in the set b is the symbol of weak domination and a b represents that a equals or dominates b c a b is not necessarily equal to 1 c b a c a b 1 means that all solutions in b are weakly dominated by some solutions in a while c a b 0 implies that no solution in b is weakly dominated by a solution in a so both c a b and c b a must be considered 4 3 operation results and discussion in addition to the optimization operation we also did the simulation operation for both cascade reservoirs and lt reservoir and used it as a reference the simulation operation considers both the actual plan of hydropower generation and the above constraints and the simulation operation for each reservoir has the same initial and final water levels as the optimization operation in the reservoir operation optimization both lpa and nsga ii have 5000 evolutionary generations and 500 000 function evaluations and the other parameter values are consistent with those in table 2 for each algorithm based on the nondominated rank and crowding distance we selected the best 100 nondominated solutions from the results of 20 model runs of each scenario as the optimization result of the corresponding scenario and compared the optimization results of different algorithms by the coverage metric fig 11 shows the optimization and simulation results of reservoir operation models all the solutions in the optimization results obtained by algorithms are feasible solutions which satisfy all the model constraints compared with simulation results the optimization results improve the minimum monthly output and annual hydropower generation of cascade reservoirs and single reservoir and provide a wealth of optimal schemes for reservoir operation table 5 presents the coverage metric values between the optimization results of lpa and nsga ii for each scenario if c a b c b a then the optimization results of lpa is better than that of nsga ii whether in cascade reservoir scenarios or single reservoir scenarios c a b is greater than c b a indicating that the optimization results of lpa are better than those of nsga ii in various scenarios in addition the minimum and maximum values of c a b are 0 29 and 0 70 respectively indicating that the optimization results of lpa can weakly dominate 29 to 70 of those of nsga ii while the optimization results of nsga ii only weakly dominate 1 to 22 of thoes of lpa table 6 shows the mean values of the proportion of nondominated solutions and the running time for each model run for the reservoir models in this paper although the proportion of nondominated solutions in lpa is slightly less than that in nsga ii the running time of the model based on lpa is about 10 to 28 shorter than that of the model based on nsga ii we can conclude from the above results that lpa outperforms nsga ii in the bi objective optimization of reservoir operation compared with nsga ii lpa can obtain better optimization results in a shorter time 5 conclusion in this paper a novel bi objective algorithm named lion pride algorithm lpa was proposed based on the social structure of lion prides and the framework of nsga ii its effectiveness in bi objective optimization was then evaluated by the benchmark problems and the reservoir operation problems in the xijiang river china we concluded as following 1 lpa was better than nsga ii in terms of convergence and diversity for bi objective optimization and it ran about 2 to 4 times faster than nsga ii 2 lpa had the good optimization ability for the complex problems with sharp peak and long tail pofs and 3 in the reservoir operation problems of this paper the optimization results of lpa weakly dominated 29 to 70 of those of nsga ii while the optimization results of nsga ii only weakly dominated 1 to 22 of those of lpa in our future work the deficiency of slope index which puts lpa at a disadvantage in the proportion of nondominated solutions will become a problem we need to solve and we may try to improve the optimization model of the reservoir system from multiple aspects such as search space constraint processing and function evaluation credit authorship contribution statement dong liu writing original draft formal analysis methodology software qiang huang supervision funding acquisition yuanyuan yang conceptualization validation writing review editing resources project administration dengfeng liu visualization investigation xiaoting wei data curation software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research was jointly funded by the china postdoctoral science foundation funded project grant number 2019m653882xb and the national key research and development program of china grant number 2017yfc0405900 
