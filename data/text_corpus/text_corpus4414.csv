index,text
22070,analytical solutions for wave interaction with a vertical porous barrier are presented the analytical solutions are derived using two different methods for taking the depth average of the pressure drop across the porous barrier both solutions assume that the evanescent modes in the wave field can be neglected the results from the analytical models are compared to results from an iterative boundary element method bem model the bem model shows that neglecting evanescent modes is a reasonable assumption for long waves but that for short waves the velocity through the porous wall from the evanescent modes can be up to 25 of the velocity from the progressive modes at the free surface however the effect of neglecting the evanescent modes has only a small effect on the depth averaged velocity through porous wall and the analytical models derived using depth averaged assumptions are shown to give good agreement with the bem model for the reflection coefficient horizontal force and overturning moment on the porous barrier the analytical models are used to investigate the effects of the drag and inertia coefficients of the porous barrier on the behaviour of the solution it is shown that for fixed values of the drag coefficient wave frequency and amplitude the solutions for the reflection coefficient lie on approximately semicircular arcs on the complex plane with the position on the arc determined by the inertial coefficient this places bounds on the size of the phase change in the reflected and transmitted wave that are possible the analytical models are also used to derive the asymptotic behaviour of the solution in long and short waves the implications of the results for more general cases of wave interaction with porous structures are discussed keywords porous slotted perforated pile breakwater boundary element method 1 introduction porous or perforated structures are of interest in a wide range of applications in coastal and ocean engineering wave interaction with porous structures has been studied in contexts such as fixed and floating breakwaters e g huang et al 2011 dai et al 2018 motion damping of floating structures e g williams et al 2000 lee and ker 2002 molin 2011 vijay and sahoo 2018 wave absorbers in narrow flumes twu and lin 1991 molin and fourest 1992 cages used for aquaculture e g zhao et al 2010 dokken et al 2017 foundations for offshore wind turbines park et al 2014 or tuned liquid dampers faltinsen et al 2011 crowley and porter 2012 molin and remy 2013 2015 one of the simplest cases for wave porous structure interaction is the case of a vertical porous barrier occupying the full water column on a flat seabed this case arises as an idealisation of a wave absorber in a flume a slotted barrier in a harbour or closely spaced pile breakwater however the case is also of interest as a simple situation to investigate the characteristics of wave interaction with thin porous structures from which more general conclusions can be drawn in this context this case is often used in physical experiments for calibration of dissipation coefficients that are used in numerical modelling of porous structures in wider contexts see e g li et al 2006 suh et al 2011b liu and li 2016 and references therein various analytical and numerical solutions have been proposed for the wave interaction with a vertical porous barrier analytical solutions provide a useful insight into the mechanisms of wave interaction with thin porous structures the reflection and transmission coefficients and the forces on the structure can be related explicitly to the wave conditions and physical characteristics of the structure analytical solutions are also much quicker to implement and solve in comparison to numerical solutions which can be useful in the initial stages of design the disadvantage with analytical approaches is that simplifying assumptions are required to derive a solution in contrast numerical solutions require fewer assumptions but provide less insight into the behaviour of the solutions the purpose of this work is to compare analytical and numerical solutions and investigate the effect of the simplifying assumptions to model wave interaction with porous or perforated structures the effect of the openings on the flow can either be explicitly resolved or parametrised in some way explicit modelling of the openings has been undertaken by some authors for example crowley and porter 2012 consider the diffraction of waves through an infinitely thin slotted barrier in a potential flow context chen et al 2019 used a reynolds averaged navier stokes rans model to explicitly model the flow through a perforated wall mentzoni and kristiansen 2019 also used a navier stokes solver to explicitly model the flow through oscillating perforated plates a smooth particle hydrodynamics sph approach was investigated by meringolo et al 2015 and ren et al 2018 explicit modelling of the flow through the openings is computationally expensive and for many practical applications it is sufficient to treat the porous structure as a homogeneous area with a pressure drop across it where the pressure drop is a function of the physical properties of the structure and the flow velocity for large volume porous structures such as rubble mound breakwaters the energy dissipated within the structure can be approximated by darcy s law where the pressure drop across the structure is assumed to be linearly proportional to the flow through the porous structure chwang and chan 1998 for thin porous structures such as slotted screens or perforated sheets flow separation at the edges of the openings causes turbulence resulting in a force proportional to the flow velocity squared mei et al 1974 molin 2011 the pressure drop across a thin porous barrier in oscillatory flow can be written in terms of a quadratic drag term and an inertial term due to acceleration of the flow through the openings the solutions for wave interaction with a vertical porous wall that have been developed can be classified firstly by whether the quadratic drag is linearised or treated explicitly and secondly by whether inertial effects are considered or not yu 1995 presented a solution in which the energy loss is assumed to be linearly dependent on the flow velocity yu presented a simple closed form solution for the velocity potential forces and reflection coefficient in terms of the so called porous effect parameter defined by chwang 1983 the porous effect parameter involves a linearised dissipation coefficient which must be determined empirically as the dissipation is a function of the flow velocity through the porous barrier the linearised coefficient is dependent on both wave frequency and amplitude as well as the physical characteristics of the structure chakrabarti and sahoo 1996 considered a nearly vertical porous wall and used a green function technique to solve the boundary value problem using linearised dissipation manam and sivanesan 2016 2017 considered a porous barrier occupying a portion of the water column with linearised dissipation across the porous barrier sivanesan and manam 2019 extended this work to consider the case of a vertical porous barrier with two gaps kaligatla et al 2017 2018 used the mild slope equations to investigate the effects of bottom topography on linear wave dissipation by vertical porous barriers geng et al 2018 considered the use of multiple porous sheets used as a wave absorber in a wave tank assuming linear dissipation across each sheet various authors have developed solutions for wave interaction with a vertical porous barrier which treat the quadratic loss explicitly mei et al 1974 used shallow water theory where the flow velocity is assumed to be constant with depth to solve the quadratic loss problem including inertial effects hagiwara 1984 used an integral equation method to develop a solution for intermediate depth waves with quadratic loss bennett et al 1992 also solved the quadratic loss problem for a thin vertical barrier using an eigenfunction expansion method fugazza and natale 1992 considered the case of one or more vertical porous walls in front of a solid back wall representing a jarlan type breakwater and solved for the quadratic energy loss however their solution neglected the evanescent components of the wave field molin and fourest 1992 considered the problem of modelling a series of vertical porous plates used as wave absorbers in a flume they modelled the quadratic loss across the plates using an iterative eigenfunction expansion method kakuno and liu 1993 used the method of matched asymptotic expansion considering both the quadratic loss and inertia coefficient isaacson et al 1998 extended the work of bennett et al 1992 to the case of a vertical slotted barrier occupying a portion of the water column using an eigenfunction expansion method however isaacson et al linearised the energy loss term using the same porous effect parameter adopted by yu 1995 liu and li 2017 used an iterative boundary element method to provide a general solution for wave interaction with a thin porous structure in two dimensions the works mentioned above all require numerical solution various analytical solutions for wave interaction with a vertical porous barrier with quadratic loss have also been proposed hayashi et al 1966 presented a solution for shallow water waves but did not consider inertial effects kriebel 1992 extended the solution of hayashi et al to intermediate depth waves and also neglected inertial effects kim 1998 presented a solution for intermediate depth waves which accounts for inertial effects the same solution is also presented in suh et al 2011a and koraim 2011 huang 2007 gave a solution for two adjacent slotted walls which reduces to kim s formula for a single wall when the distance between the two walls is zero and inertial effects are neglected the analytical solutions mentioned above all make the simplifying assumption that evanescent components of the wave field are zero this is a valid assumption in the long wave limit where the velocity profile is constant with depth however for waves in intermediate and deep water the evanescent component of the wave field is non zero this point is discussed further in section 4 in this work we compare analytical and numerical solutions to assess the impact of neglecting the evanescent terms in the velocity potential we start by deriving analytical solutions in two slightly different ways the first approach extends that of kriebel 1992 to account for inertial effects in the second we derive a model that gives the same results as kim s solution kim 1998 but is solved in terms of a quadratic equation rather than the quartic polynomial used by kim the analytical solutions are used to explain the influence of the wave conditions and the porosity coefficients drag and inertial terms on the behaviour of the solution the analytical solutions are also used to provide bounds on the range of possible solutions in terms of the reflection and transmission coefficients and to examine the limiting behaviour of the solution in long and short waves secondly we assess the impact of neglecting the evanescent modes by comparing the analytical results to results from an iterative boundary element method bem model which does not require simplifying assumptions about the form of the velocity potential a bem model was chosen over an eigenfunction expansion method as it was found that the solution was quickly convergent for all parameter values investigated in this study the bem approach adopted in this study is similar to that proposed by liu and li 2017 an extensive validation of the iterative bem model against experimental data was presented in liu and li 2017 so the focus here is on the differences between the analytical and numerical solutions the paper is organised as follows a brief review of models for the pressure drop over a thin porous surface is presented in section 2 the mathematical formulation of the problem is presented in section 3 the analytical solutions are derived in section 4 together with a comparison between the two solutions and an investigation of the behaviour of the solution the bem model is presented in section 5 and the results of the analytical and bem models are compared in 6 finally conclusions are presented in section 7 2 pressure drop over a thin porous surface the pressure drop δ p across a thin porous surface can be modelled as sollitt and cross 1972 1 δ p ρ ν u n l c f 2 u n u n l u n t where ρ is the fluid density ν is the kinematic viscosity u n is the component of the velocity normal to the porous wall assumed to be the average velocity close to the wall rather than the flow speed through the gaps l is a length scale related to wall thickness hole size etc c f is a dimensionless friction or drag coefficient and l is an inertial coefficient with dimension of length the first term on the rhs of 1 is a viscous friction loss the second term is a turbulent dissipation loss the third term is due to phase difference in the flow across the boundary and does not dissipate energy sollitt and cross 1972 noted that the linear drag term is dominant at low reynolds number flow and the quadratic term is dominant at high reynolds number the reynolds numbers for wave interaction with thin porous structures are usually high enough that linear viscous forces can be neglected under the assumption that the openings in the porous structure are small relative to the wavelength the wakes will be quickly regularised and homogenised so that the flow away from the porous wall can be modelled using potential flow theory molin 2011 the potential flow in the outer region is assumed to be time harmonic with angular frequency ω and represented by a complex potential 2 φ re ϕ e i ω t where ϕ is the spatial component of the potential the flow velocity normal to the porous wall is given by 3 u n φ n re u n e i ω t the quadratic pressure loss term introduces higher harmonics into the flow however mei et al 1974 showed that the higher harmonics are effectively negligible compared to the fundamental harmonic and the time dependence can be linearised using lorenz s principle of equivalent work 4 u n u n 8 3 π u n u n the pressure is given by the linearised bernoulli equation 5 p ρ φ t ρ re i ω ϕ e i ω t substituting 2 5 into 1 and neglecting the viscous loss term gives the following boundary condition on the porous wall 6 ϕ n i σ ϕ 1 ϕ 2 where ϕ 1 and ϕ 2 are the potentials on either side of the porous boundary and σ is a coefficient defined as 7 σ 4 c f 3 π ω ϕ n i l 1 since σ is dependent the fluid velocity through the porous surface ϕ n it is dependent on wave amplitude and frequency and varies over the porous surface of the structure due to the spatial variation in the fluid velocity the drag and inertial terms are normally considered separately with the drag term quantified assuming steady viscous flow and the inertial term quantified assuming inviscid oscillatory flow models for the quadratic friction coefficient c f have been reviewed in molin 2011 and huang et al 2011 two commonly used models are those of mei et al 1974 and molin 2011 mei et al defined the friction coefficient as 8 c f 1 τ c c 1 2 where τ is the porosity of the surface defined as the open area ratio i e the ratio of the area of the openings to the total area of the surface and c c is the coefficient of contraction approximated by c c 0 6 0 4 τ 2 molin and fourest 1992 defined the friction coefficient as 9 c f 1 τ μ τ 2 where μ is an empirically determined discharge coefficient usually taking values in the range 0 4 0 5 the models 8 and 9 are compared in fig 1 where a value of μ 0 5 has been used in 9 mei s model gives higher values than molin s model for τ 0 4 with around 35 higher values for τ 0 1 and 15 higher values for τ 0 3 for τ 0 41 molin s model gives higher values mackay et al 2019 compared measurements of wave loads on thin porous sheets with numerical predictions from a bem model using molin s model for c f and showed that the model gives a good prediction of the variation of the force with porosity for 0 1 τ 0 4 hamelin et al 2013 examined the variation of c f for slotted barriers with the keulegan carpenter kc number defined as kc u n t d where t 2 π ω and d is the diameter of the slat hamelin et al estimated a relationship of c f c f s t e a d y 8 9 kc 0 9 1 where c f s t e a d y is the drag coefficient for steady flow for larger kc numbers corresponding to small perforation sizes or large flow velocities the influence of the kc number decreases and the drag coefficient tends to the value for steady flow in the present study the value of c f is assumed to be independent of kc number mei et al 1974 noted that for slotted screens the inertial coefficient can be calculated using a long wave approximation used in acoustics morse and ingard 1968 10 l s 2 π log sin π τ 2 where s is the distance between the centre of the slots mciver 1998 developed a model for the blockage coefficient of a circular hole in a rectangular duct also using a long wavelength approximation mciver compared the results to the expression of tuck 1975 developed under the assumption that the hole size is small compared to the duct width and developed a quadratic correction to tuck s formula which gives graphically indistinguishable results to the full solution reformulating equations 32 35 in mciver 1998 in terms of porosity τ and evaluating all the coefficients in the expressions gives 11 l s 0 3898 τ 0 03239 τ 1 2415 0 8862 τ where s is the length of the side of the square duct equivalent to the separation between adjacent hole centres molin and remy 2015 developed a similar model for the blockage coefficient of a circular hole in a circular duct which gives results that are almost identical to those from 11 eqs 10 and 11 assume that the porous barrier is infinitely thin kakuno and liu 1993 used a blockage coefficient derived in flagg and newman 1971 and taylor 1973 to model the inertial effect of waves passing through an array of cylinders of finite thickness δ given by 12 l s δ s 1 τ 1 2 π 1 log 4 τ 1 3 τ 2 281 180 τ 4 expressions 10 12 are compared in fig 2 for 0 τ 0 5 the inertial coefficients from 10 and 11 are similar for τ 0 2 but the difference increases for lower porosities expressions 10 and 12 agree well for δ 0 but 12 predicts a significant influence of the sheet thickness for δ 0 expressions 10 and 11 were developed under a long wavelength approximation crowley and porter 2012 solved the full diffraction problem for an infinitely thin slotted barrier and showed that the reflection and transmission coefficients are very similar to those calculated from 10 when k d 0 1 where k is the wavenumber and 2 d is the gap width in our notation 2 d τ s molin and remy 2015 found that 10 and 11 gave good agreement with measurements of added mass and damping coefficients for experiments of sloshing in a tank with a slotted or perforated screen 3 problem formulation the water is assumed to be of constant depth h a flat rigid vertical porous wall that extends throughout the water column is located at x 0 the thickness of the wall is assumed to be much less than the wavelength away from the porous wall the fluid is assumed to be inviscid and incompressible and its motion is irrotational so that a velocity potential can be used to describe the fluid motion regular linear waves of amplitude a and angular frequency ω propagating from the negative x direction are incident on the porous wall the fluid domain is divided into two regions with the potential in the region x 0 denoted φ 1 and the potential in the region x 0 denoted φ 2 a sketch of the problem definition is shown in fig 3 the fluid motion is assumed to be time harmonic so that the potentials in each domain can be written as 13 φ j x z t re ϕ j x z e i ω t j 1 2 where ϕ j is the spatial component of the potential in domain j the spatial potentials in each domain satisfy the laplace equation the linearised free surface condition and the no flow condition on the seabed 14 2 ϕ j 0 j 1 2 15 ϕ j z k ϕ j z 0 j 1 2 16 ϕ j z 0 z h j 1 2 where k ω 2 g is the infinite depth wavenumber and g is the acceleration due to gravity the porous wall is represented as a homogeneous region with infinitesimally small holes so that the flow through the porous wall in the normal direction is assumed to be continuous on either side of the boundary so that 17 ϕ 1 x ϕ 2 x x 0 the pressure drop across the porous wall results in the additional boundary condition given in 6 once the problem has been solved the horizontal force and moment about the seabed per unit width w on the porous wall are given by 18 f x w i ω ρ h 0 ϕ 1 0 z ϕ 2 0 z d z 19 m y w i ω ρ h 0 z h ϕ 1 0 z ϕ 2 0 z d z 4 analytic solutions the potentials in each domain can be expressed using the standard eigenfunction expansions as 20 ϕ 1 i g a ω z 0 z e i k x r e i k x n 1 z n z a n e k n x 21 ϕ 2 i g a ω z 0 z t e i k x n 1 z n z b n e k n x r and t are the unknown complex reflection and transmission coefficients corresponding to the progressive components of the wave field a n and b n are the unknown complex amplitudes of the evanescent components of the wave field k is the positive real solution of k k tanh k h and k n are the positive real solutions of k k n tan k n h ordered in increasing value the vertical eigenfunctions are given by 22 z n z cosh k z h cosh k h n 0 cos k n z h cos k n h n 1 substituting 20 and 21 into 17 multiplying by z 0 integrating over depth and using the orthogonality of the vertical eigenfunctions gives 23 1 r t similarly multiplying by z n and integrating over depth gives 24 a n b n n 1 2 it is instructive to rewrite the dynamic boundary condition 6 as 25 ϕ 1 ϕ 2 l ϕ 1 x 4 i c f 3 π ω ϕ 1 x ϕ 1 x suppose that evanescent terms a n are zero under this assumption the terms on the lhs of 25 have a vertical dependence on cosh k z h and terms on the rhs are proportional to cosh 2 k z h this condition is met in the long wave limit when k 0 or on the seabed when z h 0 however in general for positive frequencies and positive elevations above the seabed we have cosh k z h cosh 2 k z h therefore there must be some evanescent terms which are non zero so far no approximations other than those of linear wave theory have been made to derive an analytical solution we assume that the evanescent component of the wave field is negligible and solve the system using a depth averaged approximation solutions can be derived in two ways depending on the stage at which the depth averaging is applied the two methods of solution are outlined in sections 4 1 and 4 2 it will be shown in section 6 through comparison with results from the bem model that the depth average velocity from the evanescent components is close to zero and neglecting the evanescent components therefore results in a reasonable approximation for both solutions we will make the assumption that c f and l are constant with depth so that the physical characteristics do not change with depth and we assume that there is no dependence of c f and l on the amplitude of the oscillatory velocity i e kc number under the assumptions that the evanescent terms are zero substituting 20 and 21 into 18 and 19 gives the non dimensional force and moment on the porous wall as 26 f x ρ g a w h 2 r tanh k h k h 27 m y ρ g a w h 2 2 r k h tanh k h sech k h 1 k h 2 note that when r 1 these expressions give the linear force and moment on a solid wall therefore r is the ratio of both the force or moment on the porous wall to the force or moment on the solid wall 4 1 method 1 depth average of dynamic boundary condition substituting 20 and 21 into 6 neglecting the evanescent components and integrating both sides with respect to z gives a quadratic equation for the transmission coefficient 28 0 x 1 t t 2 i k l t 2 where 29 x 1 4 3 π c f k a f k h and 30 f k h 2 k h sinh 2 k h 4 sinh 2 k h a similar approach was taken by kriebel 1992 to solve the case where l 0 in this case t is real and 28 can be solved explicitly to give 31 r 1 1 2 x 1 1 x 1 32 t 1 2 x 1 1 x 1 in the case that l 0 an explicit solution of 28 can be obtained as explained in section 4 3 alternatively 28 can be solved numerically using standard algorithms in this work the matlab function fsolve with a first guess t 0 has been used 4 2 method 2 depth average linearised drag coefficient the quadratic drag term in the dynamic boundary condition 6 can be linearised using lorenz s principle of equivalent work to give a linear boundary condition 33 i ϕ 1 ϕ 2 β i l ϕ 1 x where 34 β 4 c f 3 π ω h 0 u n 2 u n d z h 0 u n 2 d z and 35 u n ϕ 1 x substituting 20 and 21 into 34 neglecting the evanescent components and evaluating the integrals gives 36 β 16 9 π c f a t 2 cosh 2 k h 2 k h sinh 2 k h substituting this back into the linearised dynamic boundary condition 33 together with the expressions for the potentials gives a quadratic equation for the transmission coefficient 37 0 x 2 t t 2 i k l t 2 where 38 x 2 4 3 π c f k a g k h and 39 g k h 4 3 2 cosh 2 k h 2 k h sinh 2 k h kim 1998 derived an analytical solution in a similar way by linearising the quadratic drag coefficient and neglecting the evanescent components in kim s method the equations were solved in a different way requiring the solution of quartic polynomial the derivation outlined above results in a quadratic rather than quartic equation to solve as noted in the preceding section the quadratic 37 can be either be solved numerically or explicitly as the root of a quartic polynomial as explained below 4 3 comparison of methods and explicit solution the two methods outlined above result in the same form of quadratic equation to be solved cf 28 and 37 with the coefficients x 1 and x 2 differing only in the form of the depth dependence terms f k h and g k h the functions f k h and g k h are illustrated in fig 4 the two functions tend to the same value for low k h i e long waves and tend to constant but different values for high k h the asymptotic values of the two functions for small and large values of k h are 40 f k h 1 k h as k h 0 41 f k h 1 2 as k h 42 g k h 1 k h as k h 0 43 g k h 2 3 as k h the two methods will therefore give the same results for long waves but will give a constant offset for short waves the agreement in long wave conditions is to be expected since the velocity potential is less variable with depth in long waves the method used to take the depth average will have less influence on the results the explicit solution to 28 and 37 for the case l 0 is given in 31 and 32 to obtain an explicit solution in the case l 0 we write the transmission coefficient using euler s formula as t t cos θ i sin θ where θ is the phase of t substituting this into 28 and separating the real and imaginary parts gives the following expressions 44 2 sec θ t x t 2 k l t tan θ 45 tan θ k l 2 x t where x is either x 1 or x 2 substituting 45 into 44 and using the identity sec x 1 tan 2 x gives a quartic equation for t 46 0 x 2 t 4 4 x t 3 4 k l 2 t 2 4 when k l 0 this reduces to the expression given in 32 the general solution for positive x and k l can be written down explicitly however the explicit solution involves a large number of terms and is not particularly instructive to look at the explicit solution is therefore not copied here but can easily be obtained by standard computer packages 4 4 behaviour of analytical solution from 28 and 37 it is apparent that the reflection coefficient and hence also the horizontal force and moment is a function of x either x 1 or x 2 depending on the method used and k l only the relationship between r t x and k l is shown in fig 5 the magnitude of the transmission coefficient is monotonically decreasing with increasing x corresponding to increasing c f decreasing porosity increasing wave steepness k a or decreasing k h longer waves an increase in the inertia coefficient leads to a reduction in the transmission coefficient and a negative shift in the phase of the transmitted wave the inertia coefficient has a proportionally larger effect at lower values of x as would be expected from inspection of 28 and 37 the reflection coefficient is related to the transmission coefficient by r 1 t this is true for the general solution including evanescent terms as explained at the start of this section when l 0 the phase of t is zero and r is monotonically increasing with x when l 0 the phase change in t leads to a non monotonic variation in r with x the variation of the magnitude and phase of the r and t with x and k l can be better understood by plotting the real and imaginary parts for fixed values of x as shown in fig 6 each coloured line on the plot corresponds to a solution for a fixed value of x and values of k l between 0 and when x 0 the solution to 28 and 37 is 47 t 2 2 i k l 1 2 1 2 4 k l 2 4 k l 2 i 4 k l 4 k l 2 in fact this is the exact solution since the evanescent terms are zero in the case x 0 making the substitution k l 2 tan α 2 we obtain 48 t 1 2 1 2 cos α i sin α this is the equation of a circle in the complex plane centred at t 1 2 and with radius 1 2 since 0 k l we have 0 α π and eq 48 describes a semicircle in the fourth quadrant of the complex plane the solutions for x 0 correspond to a purely inviscid interaction at the porous boundary the fluid is already assumed to be inviscid away from the porous wall where there is no energy loss due to turbulence and the pressure on the porous wall results from acceleration of the fluid through the gaps the range of values that r and t can take is bounded by semicircles in the first and fourth quadrants of the complex plane respectively representing the solutions for x 0 for x 0 the arcs representing the solutions for constant x are not quite a semicircle with the solutions lying slightly outside the semicircle defined by the two solutions on the real axis for k l 0 and k l for short waves the interaction with any structure with a vertical porous wall at the free surface will tend toward the present case where the porous wall occupies the full water column the bounds on the range of the reflection and transmission coefficients derived here would therefore be expected to apply for short waves in the more general case as well the results imply that for given values of k h k a and c f the maximum possible phase change in r is governed by solution for l 0 which is given by 31 and 32 if we denote the solution for l 0 as r 0 then the solutions for l 0 lie approximately on a semicircle centred at 1 r 0 2 with radius 1 r 0 2 in contrast the transmission coefficient can have a maximum phase lag of π 2 for any value of x as the solution arcs always intersect the imaginary axis as l however large phase lags are associated with small transmission coefficients fig 7 shows the magnitude and phase of r and t for fixed values of x and 0 k l it is evident that for a given value of r or t the maximum phase angle is bounded by the phase angle of the solution at x 0 from 47 we have r cos ψ and t cos θ when x 0 where ψ and θ are the phase angles of r and t respectively these relations provide an upper bound on the phase angles of r and t when x 0 it is interesting to consider the behaviour of the reflection coefficient in long and short waves the solution is dependent on the variable x which is a function of wave steepness if wave steepness is held constant then the amplitude tends to infinity as k h 0 conversely if amplitude is held constant then the steepness tends to infinity as k h so both cases lead to non physical results in one of the limits example solutions are shown in fig 8 for the cases of both constant steepness and constant amplitude assuming c f 100 and l 0 note that since l 0 r is real the solutions shown have been calculated using method 1 but the behaviour is the same for solutions from method 2 in the case of constant amplitude we have 49 x 1 2 4 3 π c f a h as k h 0 50 x 1 2 as k h in this case the reflection coefficient will tend to a constant value for long waves and tend to one for short waves in the case of long waves the horizontal velocity tends to a constant value a g h and hence the drag resistance of the porous wall will also tend to a constant value leading to a constant reflection coefficient the physical interpretation of the short wave limit is that since the velocity through the holes is proportional to ω a if a is constant then the velocity will tend to infinity in short waves causing the flow through the porous barrier to experience increasing drag in the limit the flow through the barrier will decrease to zero causing all energy to be reflected in reality the wave will break when the steepness exceeds the miche limit and other effects will become relevant before this limit is reached in particular the assumption that the porous wall can be modelled as a homogeneous surface will become less valid and diffraction effects will need to be accounted for see e g crowley and porter 2012 in the case of constant steepness we have 53 x 1 2 as k h 0 x 1 2 3 π c f k a as k h x 2 8 9 π c f k a as k h in this case the reflection coefficient tends to a constant value for short waves and tends to one for long waves for the short wave case maintaining a constant steepness makes the problem scale invariant and hence a constant reflection coefficient is expected under the assumption that the porous wall can be treated as a homogeneous surface the physical interpretation for the long wave limit is the same as that for the short wave limit in the constant amplitude case in the case of constant steepness waves the horizontal velocity tends to infinity as k h 0 so the drag resistance of the porous wall will also increase to infinity in fig 8 there appears to be a distinct change in the behaviour of the solution around k h 1 the convergence of the solutions toward their asymptotic values is dependent on the behaviour of the depth functions f k h and g k h from fig 4 it can be seen that for k h 1 both f k h and g k h are well approximated by 1 k h and for k h 3 both f k h and g k h are approximately constant in the case that l 0 the asymptotic behaviour of the reflection coefficient remains the same for long waves i e tending to a constant value for constant amplitude or tending to one for constant steepness but for short waves the reflection coefficient will tend to one for both cases of constant amplitude and constant steepness this can be seen from 28 and 37 since k l as k the only solution can be t 0 as before the assumption that the porous wall can be treated as a homogeneous barrier becomes less valid as the ratio of the wavelength to the size of the openings decreases and diffraction effects become more important 5 bem solution the multi domain bem approach used here is similar to that presented in liu and li 2017 to simplify the analysis we define dimensionless potentials as 54 ϕ j i g a ω ϕ j d j 1 2 where the superscript d indicates a dimensionless quantity two domains are defined to solve the bem problem the first domain located on the up wave side of the porous screen lhs in fig 3 is bounded by the porous wall the free surface the sea floor and a control surface at x c the second domain located on the down wave side of the wall rhs in fig 4 is the mirror of the first domain in the porous wall with the control surface at x c the normal vectors to the boundaries n are defined to point outward from each domain application of green s third identity to the two domains yields integral equations for ϕ 1 d and ϕ 2 d 55 1 2 ϕ j d γ j ϕ j d g n g ϕ j d n d s j 1 2 where γ j is the boundary of domain j and g is a green function satisfying the laplace equation defined as 56 g 1 2 π ln x ξ 2 z η 2 and ξ η are the coordinates of an arbitrary point on γ j the boundary conditions for the integral equations on the mean surface and sea bed are given by 15 and 16 respectively with ϕ j replaced by ϕ j d note that since the normal vectors to the boundaries in each domain are in opposite directions on the porous wall the continuity of velocity condition across the porous wall 17 is expressed as 57 ϕ 1 d n 1 ϕ 2 d n 2 x 0 the dynamic boundary condition on the porous wall is given by 6 and 54 as 58 ϕ 1 d n i k σ d ϕ 1 d ϕ 2 d x 0 59 σ d 4 3 π c f a ϕ 1 d n i k l 1 the boundary conditions on the control surfaces are derived as follows if c is sufficiently large then the evanescent components tend to zero so 60 ϕ 1 d c z z 0 z e i k c r e i k c c 61 ϕ 2 d c z z 0 z 1 r e i k c c assuming that c is sufficiently large for 60 and 61 to hold expressions for r in terms of ϕ 1 d and ϕ 2 d at x c are obtained by integrating both sides of 60 and 61 over z to give 62 r e i k c n 0 h 0 ϕ 1 d c z d z e 2 i k c x c 63 r 1 e i k c n 0 h 0 ϕ 2 d c z d z x c where 64 n 0 h 0 z 0 z d z tanh k h k substituting 62 and 63 into 60 and 61 and taking partial derivatives gives the boundary conditions on the control surfaces as 65 ϕ 1 d n i k z 0 z 2 e i k c 1 n 0 h 0 ϕ 1 d c z d z x c 66 ϕ 2 d n i k z 0 z n 0 h 0 ϕ 2 d c z d z x c the system is solved by discretising the boundary into discrete segments and assuming the potential is constant on each panel the boundary conditions are substituted into the discretised form of 55 giving a linear system of equations for the potential see appendix where the strength of the dissipation coefficient σ d z on each panel of the porous wall is an additional unknown note that σ d z varies with water depth the system is solved iteratively with a first guess of σ d z 1 0 5 corresponding to a high porosity after the system is solved the normalised velocity through the porous wall v m z ϕ 1 d 0 z n is recalculated from 58 and the new velocity is defined as v m 1 z v m z v m 1 z 2 where the superscripts denote the iteration number and v 0 z 0 the new velocity is then used to define a new value of σ d z on each panel using 59 and the system is resolved the iterations are terminated when max v m z v m 1 z z h 0 1 0 4 once the system has been solved the reflection coefficient can be calculated from 62 and the force and moment per unit width on the wall can be calculated from 18 and 19 a convergence study was conducted to determine an adequate discretisation length and position for the control surfaces for various values of c f k a k h and l it was found that using a constant discretisation length of h 200 and locating the control surfaces at c 5 h was sufficient to obtain a stable solution 6 comparison of bem and analytical solutions 6 1 velocities from evanescent components before comparing the bem and analytical solutions directly it is instructive to consider the size of the evanescent components of the potential relative to the progressive components the total dimensionless flow velocity through the porous screen is given by 67 v t 1 k ϕ 1 d x the dimensionless velocity through the porous screen associated with the progressive components of the potential is given by 68 v p i z 0 z r 1 the dimensionless velocity through the porous screen associated with the evanescent components is therefore given by 69 v e v t v p figs 9 and 11 show the ratio v e z v p 0 where v t and v p have both been calculated from the bem model the denominator in the ratio v e z v p 0 is the maximum value of the velocity from the progressive components of the wave field which occurs at the free surface the cases shown are for k a 0 1 c f 10 50 100 200 and l 0 0 5 results are shown for various values of k h with the colour of the line indicating the value of k h as mentioned in section 4 in the long wave limit when k h 0 the evanescent component of the wave field tends to zero figs 9 and 11 show that the relative size of the evanescent waves increases with k h the magnitude of the evanescent components also increases with the friction coefficient c f with a peak value of v e z v p 0 of around 25 at the free surface for the range of variables shown here the magnitude of the evanescent components decreases slightly with increasing inertial coefficient l the phase of the velocity from the evanescent components relative to the phase of the progressive component is shown in fig 10 for the cases corresponding to those in fig 9 for l 0 at the top of the water column the evanescent components have a phase lead over the progressive component whilst further down the water column the trend is reversed the pattern is similar for the cases with l 0 5 and is not shown here fig 12 compares the depth averaged values of v t and v p denoted v t and v p where both values have been calculated from the bem model the two values are in good agreement indicating that although the analytical model will not give the correct vertical distribution of flow velocity through the porous wall the approximation using the depth averaged velocity should be reasonable for the case l 0 v t is slightly larger than v p at higher k h and c f for the case l 0 5 there is slightly better agreement between v t and v p for the lower values of c f at higher k h v t is slightly lower than v p indicating that the phasing of the evanescent components serves to oppose the progressive components on average 6 2 reflection transmission and forces figs 13 and 14 present a comparison of the magnitude of the reflection coefficient and normalised surge force and moment from the bem and analytical models the force and moment on the porous wall have been normalised by the force and moment on a solid wall for the same wave conditions denoted f 0 and m 0 respectively for the two analytical models we have r f x f 0 m y m 0 however for the bem model the presence of the evanescent components of the wave field results in differences between these quantities so it is interesting to compare all three values in all cases the agreement is good in longer waves with k h 1 this is consistent with the observation that the relative size of the evanescent waves decreases with k h implying that neglecting the evanescent components is a reasonable approximation for the analytical models at higher values of k h the magnitude r from the bem model agrees better with the analytical model using method 2 with method 1 giving slightly lower values in the case l 0 in the case l 0 5 the agreement is closer between all three models which is consistent with the observation above that the evanescent waves are smaller in this case for the surge force the analytical solution using method 1 agrees better with the bem model for c f 10 but the force from the bem model is slightly lower than both analytical solutions for higher c f and l 0 with method 2 giving a larger discrepancy for the moment about the seabed the bem model gives a value in between the two analytical solutions for 1 k h 3 with method 1 giving better agreement at higher k h the increasing discrepancy at higher k h for larger values of c f is consistent with the larger relative size of the evanescent velocities since neglecting these components will result in a larger error in these cases the phase of r f x and m y is shown in fig 15 for the case l 0 5 the case l 0 is not shown as the phase is zero for all models in this case the phases are generally is good agreement for all three models but the agreement is marginally closer for method 1 6 3 effect of inertial coefficient in section 4 4 the it was shown that the analytic solutions fall on near semicircular arcs in the complex plane with the position on the arc determined by the value of k l runs with the bem model were conducted to verify this behaviour for the numerical solution the analysis presented in section 4 4 considered the behaviour of the solution for constant values of the coefficient x the coefficient x is a function of k h k a and c f but with the dependence on k h differing between methods 1 and 2 the runs with the bem model were conducted for k h 1 and k h 4 which represents solutions for long and short waves respectively for each value of k h runs were conducted for k a 0 1 c f 0 1 and k l 0 0 5 1 2 5 10 the results are shown in fig 16 for the long wave case with k h 1 the results from the bem model and analytic solutions agree very well there is negligible difference between the two analytic solutions since the functions f k h and g k h have the same asymptotic behaviour for low k h see fig 4 moreover as discussed above at low k h the evanescent component of the potential is smaller meaning that the analytic solutions will be good approximations for the short wave case with k h 4 there is a small difference between the two analytic solutions when c f 0 which is due to the difference in the functions f k h and g k h when c f 0 these functions are not part of the solution hence the two analytic solutions coincide the analytic solution for c f 0 is the exact solution to the linear potential flow problem so in theory the bem solution should exactly coincide in practice there are some small differences due to numerical effects related to discretisation of the problem however the agreement is good overall for the cases with c f 0 the bem solution lies somewhere between the two analytical solutions but again the agreement is good overall 7 conclusions two analytical solutions for wave interaction with a vertical porous barrier have been presented the first extends the solution of kriebel 1992 to include the inertial effects of the porous barrier and the second simplifies the solution of kim 1998 the two methods were shown to both be the solution of the same quadratic equation with the difference occurring in the depth dependence for the quadratic coefficient the analytical solutions provide a relationship between the behaviour of reflection and transmission coefficient and forces on the porous barrier with the wave conditions and porosity parameters it was shown that the range of values that the reflection and transmission coefficient can take is bounded by a semicircle in the complex plane of radius 1 2 centred on the real axis at r 1 2 with the semicircle lying in the first quadrant of the plane for the reflection coefficient and in the fourth quadrant for the transmission coefficient it was also shown that the maximum phase angle for a given value of r or t is bounded by the relations 0 ψ arccos r and arccos t θ 0 where ψ and θ are the phase angles of r and t respectively the analytical solution was also used to derive the asymptotic behaviour of the solution for long and short waves for the cases of constant amplitude and constant steepness for the case of constant amplitude waves the reflection and transmission coefficients tend to constant values for long waves similarly for constant steepness waves the reflection and transmission coefficients tend to constant values for short waves the cases of constant amplitude in the short wave limit and constant steepness in the long wave limit both correspond to non physical cases of either infinite steepness or infinite amplitude respectively the analytical solutions are approximate in that they both neglect the evanescent components in the wave field results from an iterative bem model demonstrate that for longer waves this assumption is well justified but for shorter waves the amplitude of the velocity through the porous wall from the evanescent modes can be up to 25 of the velocity from the progressive modes at the free surface despite neglecting the evanescent components of the wave field both analytical solutions agree well with the bem model in the prediction of the reflection and transmission coefficients and forces and moments on the porous wall for the reflection coefficient the solution based on kim s method has slightly better agreement with the bem model than the solution based on kriebel s method with kriebel s method leading to a small under prediction of the reflection coefficient at higher frequencies however the solution based on kriebel s method gives better agreement in terms of forces and moments credit authorship contribution statement ed mackay methodology software formal analysis writing original draft lars johanning writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was funded under epsrc uk grant ep r007519 1 appendix matrix equations for bem model the boundary of each domain is discretised with n p panels on the porous wall n s panels on the free surface n c panels on the control surface and n b panels on the seabed panels in the up wave domain are numbered sequentially in an anticlockwise direction starting from the seabed at the porous wall similarly panels in the down wave domain are numbered clockwise starting at the same point define matrices 70 d m n g x m x n n s n m n 1 2 m n 71 s m n g x m x n s n m n s n 2 π log s n 2 1 m n where x n and s n are the centre and length of panel n respectively after gathering terms the system of equations for the potentials in each domain can be written as 72 m 1 m 2 m 2 m 1 ϕ 1 ϕ 2 s 0 0 s w where 73 m 1 i k σ s p k s s γ 0 d 74 m 2 i k σ s p 0 0 0 the vector w is given by 75 w m 2 k z 0 z m e i k c π 2 m n p n s 1 n p n s n c 0 otherwise the matrices s p s s s c and s b are sub matrices of s corresponding to the terms multiplying the potentials on the porous surface control and bottom panels respectively so that s s p s s s c s b the notation x y denotes the hadamard product elementwise multiplication and σ is a matrix the same size as s p with rows corresponding to the porous parameter on each panel on the porous wall updated on each iteration with σ i j σ d x j the matrix γ is the same size as s c with terms given by 76 γ m n i k s n n 0 j 1 n c s c m j z 0 z j 
22070,analytical solutions for wave interaction with a vertical porous barrier are presented the analytical solutions are derived using two different methods for taking the depth average of the pressure drop across the porous barrier both solutions assume that the evanescent modes in the wave field can be neglected the results from the analytical models are compared to results from an iterative boundary element method bem model the bem model shows that neglecting evanescent modes is a reasonable assumption for long waves but that for short waves the velocity through the porous wall from the evanescent modes can be up to 25 of the velocity from the progressive modes at the free surface however the effect of neglecting the evanescent modes has only a small effect on the depth averaged velocity through porous wall and the analytical models derived using depth averaged assumptions are shown to give good agreement with the bem model for the reflection coefficient horizontal force and overturning moment on the porous barrier the analytical models are used to investigate the effects of the drag and inertia coefficients of the porous barrier on the behaviour of the solution it is shown that for fixed values of the drag coefficient wave frequency and amplitude the solutions for the reflection coefficient lie on approximately semicircular arcs on the complex plane with the position on the arc determined by the inertial coefficient this places bounds on the size of the phase change in the reflected and transmitted wave that are possible the analytical models are also used to derive the asymptotic behaviour of the solution in long and short waves the implications of the results for more general cases of wave interaction with porous structures are discussed keywords porous slotted perforated pile breakwater boundary element method 1 introduction porous or perforated structures are of interest in a wide range of applications in coastal and ocean engineering wave interaction with porous structures has been studied in contexts such as fixed and floating breakwaters e g huang et al 2011 dai et al 2018 motion damping of floating structures e g williams et al 2000 lee and ker 2002 molin 2011 vijay and sahoo 2018 wave absorbers in narrow flumes twu and lin 1991 molin and fourest 1992 cages used for aquaculture e g zhao et al 2010 dokken et al 2017 foundations for offshore wind turbines park et al 2014 or tuned liquid dampers faltinsen et al 2011 crowley and porter 2012 molin and remy 2013 2015 one of the simplest cases for wave porous structure interaction is the case of a vertical porous barrier occupying the full water column on a flat seabed this case arises as an idealisation of a wave absorber in a flume a slotted barrier in a harbour or closely spaced pile breakwater however the case is also of interest as a simple situation to investigate the characteristics of wave interaction with thin porous structures from which more general conclusions can be drawn in this context this case is often used in physical experiments for calibration of dissipation coefficients that are used in numerical modelling of porous structures in wider contexts see e g li et al 2006 suh et al 2011b liu and li 2016 and references therein various analytical and numerical solutions have been proposed for the wave interaction with a vertical porous barrier analytical solutions provide a useful insight into the mechanisms of wave interaction with thin porous structures the reflection and transmission coefficients and the forces on the structure can be related explicitly to the wave conditions and physical characteristics of the structure analytical solutions are also much quicker to implement and solve in comparison to numerical solutions which can be useful in the initial stages of design the disadvantage with analytical approaches is that simplifying assumptions are required to derive a solution in contrast numerical solutions require fewer assumptions but provide less insight into the behaviour of the solutions the purpose of this work is to compare analytical and numerical solutions and investigate the effect of the simplifying assumptions to model wave interaction with porous or perforated structures the effect of the openings on the flow can either be explicitly resolved or parametrised in some way explicit modelling of the openings has been undertaken by some authors for example crowley and porter 2012 consider the diffraction of waves through an infinitely thin slotted barrier in a potential flow context chen et al 2019 used a reynolds averaged navier stokes rans model to explicitly model the flow through a perforated wall mentzoni and kristiansen 2019 also used a navier stokes solver to explicitly model the flow through oscillating perforated plates a smooth particle hydrodynamics sph approach was investigated by meringolo et al 2015 and ren et al 2018 explicit modelling of the flow through the openings is computationally expensive and for many practical applications it is sufficient to treat the porous structure as a homogeneous area with a pressure drop across it where the pressure drop is a function of the physical properties of the structure and the flow velocity for large volume porous structures such as rubble mound breakwaters the energy dissipated within the structure can be approximated by darcy s law where the pressure drop across the structure is assumed to be linearly proportional to the flow through the porous structure chwang and chan 1998 for thin porous structures such as slotted screens or perforated sheets flow separation at the edges of the openings causes turbulence resulting in a force proportional to the flow velocity squared mei et al 1974 molin 2011 the pressure drop across a thin porous barrier in oscillatory flow can be written in terms of a quadratic drag term and an inertial term due to acceleration of the flow through the openings the solutions for wave interaction with a vertical porous wall that have been developed can be classified firstly by whether the quadratic drag is linearised or treated explicitly and secondly by whether inertial effects are considered or not yu 1995 presented a solution in which the energy loss is assumed to be linearly dependent on the flow velocity yu presented a simple closed form solution for the velocity potential forces and reflection coefficient in terms of the so called porous effect parameter defined by chwang 1983 the porous effect parameter involves a linearised dissipation coefficient which must be determined empirically as the dissipation is a function of the flow velocity through the porous barrier the linearised coefficient is dependent on both wave frequency and amplitude as well as the physical characteristics of the structure chakrabarti and sahoo 1996 considered a nearly vertical porous wall and used a green function technique to solve the boundary value problem using linearised dissipation manam and sivanesan 2016 2017 considered a porous barrier occupying a portion of the water column with linearised dissipation across the porous barrier sivanesan and manam 2019 extended this work to consider the case of a vertical porous barrier with two gaps kaligatla et al 2017 2018 used the mild slope equations to investigate the effects of bottom topography on linear wave dissipation by vertical porous barriers geng et al 2018 considered the use of multiple porous sheets used as a wave absorber in a wave tank assuming linear dissipation across each sheet various authors have developed solutions for wave interaction with a vertical porous barrier which treat the quadratic loss explicitly mei et al 1974 used shallow water theory where the flow velocity is assumed to be constant with depth to solve the quadratic loss problem including inertial effects hagiwara 1984 used an integral equation method to develop a solution for intermediate depth waves with quadratic loss bennett et al 1992 also solved the quadratic loss problem for a thin vertical barrier using an eigenfunction expansion method fugazza and natale 1992 considered the case of one or more vertical porous walls in front of a solid back wall representing a jarlan type breakwater and solved for the quadratic energy loss however their solution neglected the evanescent components of the wave field molin and fourest 1992 considered the problem of modelling a series of vertical porous plates used as wave absorbers in a flume they modelled the quadratic loss across the plates using an iterative eigenfunction expansion method kakuno and liu 1993 used the method of matched asymptotic expansion considering both the quadratic loss and inertia coefficient isaacson et al 1998 extended the work of bennett et al 1992 to the case of a vertical slotted barrier occupying a portion of the water column using an eigenfunction expansion method however isaacson et al linearised the energy loss term using the same porous effect parameter adopted by yu 1995 liu and li 2017 used an iterative boundary element method to provide a general solution for wave interaction with a thin porous structure in two dimensions the works mentioned above all require numerical solution various analytical solutions for wave interaction with a vertical porous barrier with quadratic loss have also been proposed hayashi et al 1966 presented a solution for shallow water waves but did not consider inertial effects kriebel 1992 extended the solution of hayashi et al to intermediate depth waves and also neglected inertial effects kim 1998 presented a solution for intermediate depth waves which accounts for inertial effects the same solution is also presented in suh et al 2011a and koraim 2011 huang 2007 gave a solution for two adjacent slotted walls which reduces to kim s formula for a single wall when the distance between the two walls is zero and inertial effects are neglected the analytical solutions mentioned above all make the simplifying assumption that evanescent components of the wave field are zero this is a valid assumption in the long wave limit where the velocity profile is constant with depth however for waves in intermediate and deep water the evanescent component of the wave field is non zero this point is discussed further in section 4 in this work we compare analytical and numerical solutions to assess the impact of neglecting the evanescent terms in the velocity potential we start by deriving analytical solutions in two slightly different ways the first approach extends that of kriebel 1992 to account for inertial effects in the second we derive a model that gives the same results as kim s solution kim 1998 but is solved in terms of a quadratic equation rather than the quartic polynomial used by kim the analytical solutions are used to explain the influence of the wave conditions and the porosity coefficients drag and inertial terms on the behaviour of the solution the analytical solutions are also used to provide bounds on the range of possible solutions in terms of the reflection and transmission coefficients and to examine the limiting behaviour of the solution in long and short waves secondly we assess the impact of neglecting the evanescent modes by comparing the analytical results to results from an iterative boundary element method bem model which does not require simplifying assumptions about the form of the velocity potential a bem model was chosen over an eigenfunction expansion method as it was found that the solution was quickly convergent for all parameter values investigated in this study the bem approach adopted in this study is similar to that proposed by liu and li 2017 an extensive validation of the iterative bem model against experimental data was presented in liu and li 2017 so the focus here is on the differences between the analytical and numerical solutions the paper is organised as follows a brief review of models for the pressure drop over a thin porous surface is presented in section 2 the mathematical formulation of the problem is presented in section 3 the analytical solutions are derived in section 4 together with a comparison between the two solutions and an investigation of the behaviour of the solution the bem model is presented in section 5 and the results of the analytical and bem models are compared in 6 finally conclusions are presented in section 7 2 pressure drop over a thin porous surface the pressure drop δ p across a thin porous surface can be modelled as sollitt and cross 1972 1 δ p ρ ν u n l c f 2 u n u n l u n t where ρ is the fluid density ν is the kinematic viscosity u n is the component of the velocity normal to the porous wall assumed to be the average velocity close to the wall rather than the flow speed through the gaps l is a length scale related to wall thickness hole size etc c f is a dimensionless friction or drag coefficient and l is an inertial coefficient with dimension of length the first term on the rhs of 1 is a viscous friction loss the second term is a turbulent dissipation loss the third term is due to phase difference in the flow across the boundary and does not dissipate energy sollitt and cross 1972 noted that the linear drag term is dominant at low reynolds number flow and the quadratic term is dominant at high reynolds number the reynolds numbers for wave interaction with thin porous structures are usually high enough that linear viscous forces can be neglected under the assumption that the openings in the porous structure are small relative to the wavelength the wakes will be quickly regularised and homogenised so that the flow away from the porous wall can be modelled using potential flow theory molin 2011 the potential flow in the outer region is assumed to be time harmonic with angular frequency ω and represented by a complex potential 2 φ re ϕ e i ω t where ϕ is the spatial component of the potential the flow velocity normal to the porous wall is given by 3 u n φ n re u n e i ω t the quadratic pressure loss term introduces higher harmonics into the flow however mei et al 1974 showed that the higher harmonics are effectively negligible compared to the fundamental harmonic and the time dependence can be linearised using lorenz s principle of equivalent work 4 u n u n 8 3 π u n u n the pressure is given by the linearised bernoulli equation 5 p ρ φ t ρ re i ω ϕ e i ω t substituting 2 5 into 1 and neglecting the viscous loss term gives the following boundary condition on the porous wall 6 ϕ n i σ ϕ 1 ϕ 2 where ϕ 1 and ϕ 2 are the potentials on either side of the porous boundary and σ is a coefficient defined as 7 σ 4 c f 3 π ω ϕ n i l 1 since σ is dependent the fluid velocity through the porous surface ϕ n it is dependent on wave amplitude and frequency and varies over the porous surface of the structure due to the spatial variation in the fluid velocity the drag and inertial terms are normally considered separately with the drag term quantified assuming steady viscous flow and the inertial term quantified assuming inviscid oscillatory flow models for the quadratic friction coefficient c f have been reviewed in molin 2011 and huang et al 2011 two commonly used models are those of mei et al 1974 and molin 2011 mei et al defined the friction coefficient as 8 c f 1 τ c c 1 2 where τ is the porosity of the surface defined as the open area ratio i e the ratio of the area of the openings to the total area of the surface and c c is the coefficient of contraction approximated by c c 0 6 0 4 τ 2 molin and fourest 1992 defined the friction coefficient as 9 c f 1 τ μ τ 2 where μ is an empirically determined discharge coefficient usually taking values in the range 0 4 0 5 the models 8 and 9 are compared in fig 1 where a value of μ 0 5 has been used in 9 mei s model gives higher values than molin s model for τ 0 4 with around 35 higher values for τ 0 1 and 15 higher values for τ 0 3 for τ 0 41 molin s model gives higher values mackay et al 2019 compared measurements of wave loads on thin porous sheets with numerical predictions from a bem model using molin s model for c f and showed that the model gives a good prediction of the variation of the force with porosity for 0 1 τ 0 4 hamelin et al 2013 examined the variation of c f for slotted barriers with the keulegan carpenter kc number defined as kc u n t d where t 2 π ω and d is the diameter of the slat hamelin et al estimated a relationship of c f c f s t e a d y 8 9 kc 0 9 1 where c f s t e a d y is the drag coefficient for steady flow for larger kc numbers corresponding to small perforation sizes or large flow velocities the influence of the kc number decreases and the drag coefficient tends to the value for steady flow in the present study the value of c f is assumed to be independent of kc number mei et al 1974 noted that for slotted screens the inertial coefficient can be calculated using a long wave approximation used in acoustics morse and ingard 1968 10 l s 2 π log sin π τ 2 where s is the distance between the centre of the slots mciver 1998 developed a model for the blockage coefficient of a circular hole in a rectangular duct also using a long wavelength approximation mciver compared the results to the expression of tuck 1975 developed under the assumption that the hole size is small compared to the duct width and developed a quadratic correction to tuck s formula which gives graphically indistinguishable results to the full solution reformulating equations 32 35 in mciver 1998 in terms of porosity τ and evaluating all the coefficients in the expressions gives 11 l s 0 3898 τ 0 03239 τ 1 2415 0 8862 τ where s is the length of the side of the square duct equivalent to the separation between adjacent hole centres molin and remy 2015 developed a similar model for the blockage coefficient of a circular hole in a circular duct which gives results that are almost identical to those from 11 eqs 10 and 11 assume that the porous barrier is infinitely thin kakuno and liu 1993 used a blockage coefficient derived in flagg and newman 1971 and taylor 1973 to model the inertial effect of waves passing through an array of cylinders of finite thickness δ given by 12 l s δ s 1 τ 1 2 π 1 log 4 τ 1 3 τ 2 281 180 τ 4 expressions 10 12 are compared in fig 2 for 0 τ 0 5 the inertial coefficients from 10 and 11 are similar for τ 0 2 but the difference increases for lower porosities expressions 10 and 12 agree well for δ 0 but 12 predicts a significant influence of the sheet thickness for δ 0 expressions 10 and 11 were developed under a long wavelength approximation crowley and porter 2012 solved the full diffraction problem for an infinitely thin slotted barrier and showed that the reflection and transmission coefficients are very similar to those calculated from 10 when k d 0 1 where k is the wavenumber and 2 d is the gap width in our notation 2 d τ s molin and remy 2015 found that 10 and 11 gave good agreement with measurements of added mass and damping coefficients for experiments of sloshing in a tank with a slotted or perforated screen 3 problem formulation the water is assumed to be of constant depth h a flat rigid vertical porous wall that extends throughout the water column is located at x 0 the thickness of the wall is assumed to be much less than the wavelength away from the porous wall the fluid is assumed to be inviscid and incompressible and its motion is irrotational so that a velocity potential can be used to describe the fluid motion regular linear waves of amplitude a and angular frequency ω propagating from the negative x direction are incident on the porous wall the fluid domain is divided into two regions with the potential in the region x 0 denoted φ 1 and the potential in the region x 0 denoted φ 2 a sketch of the problem definition is shown in fig 3 the fluid motion is assumed to be time harmonic so that the potentials in each domain can be written as 13 φ j x z t re ϕ j x z e i ω t j 1 2 where ϕ j is the spatial component of the potential in domain j the spatial potentials in each domain satisfy the laplace equation the linearised free surface condition and the no flow condition on the seabed 14 2 ϕ j 0 j 1 2 15 ϕ j z k ϕ j z 0 j 1 2 16 ϕ j z 0 z h j 1 2 where k ω 2 g is the infinite depth wavenumber and g is the acceleration due to gravity the porous wall is represented as a homogeneous region with infinitesimally small holes so that the flow through the porous wall in the normal direction is assumed to be continuous on either side of the boundary so that 17 ϕ 1 x ϕ 2 x x 0 the pressure drop across the porous wall results in the additional boundary condition given in 6 once the problem has been solved the horizontal force and moment about the seabed per unit width w on the porous wall are given by 18 f x w i ω ρ h 0 ϕ 1 0 z ϕ 2 0 z d z 19 m y w i ω ρ h 0 z h ϕ 1 0 z ϕ 2 0 z d z 4 analytic solutions the potentials in each domain can be expressed using the standard eigenfunction expansions as 20 ϕ 1 i g a ω z 0 z e i k x r e i k x n 1 z n z a n e k n x 21 ϕ 2 i g a ω z 0 z t e i k x n 1 z n z b n e k n x r and t are the unknown complex reflection and transmission coefficients corresponding to the progressive components of the wave field a n and b n are the unknown complex amplitudes of the evanescent components of the wave field k is the positive real solution of k k tanh k h and k n are the positive real solutions of k k n tan k n h ordered in increasing value the vertical eigenfunctions are given by 22 z n z cosh k z h cosh k h n 0 cos k n z h cos k n h n 1 substituting 20 and 21 into 17 multiplying by z 0 integrating over depth and using the orthogonality of the vertical eigenfunctions gives 23 1 r t similarly multiplying by z n and integrating over depth gives 24 a n b n n 1 2 it is instructive to rewrite the dynamic boundary condition 6 as 25 ϕ 1 ϕ 2 l ϕ 1 x 4 i c f 3 π ω ϕ 1 x ϕ 1 x suppose that evanescent terms a n are zero under this assumption the terms on the lhs of 25 have a vertical dependence on cosh k z h and terms on the rhs are proportional to cosh 2 k z h this condition is met in the long wave limit when k 0 or on the seabed when z h 0 however in general for positive frequencies and positive elevations above the seabed we have cosh k z h cosh 2 k z h therefore there must be some evanescent terms which are non zero so far no approximations other than those of linear wave theory have been made to derive an analytical solution we assume that the evanescent component of the wave field is negligible and solve the system using a depth averaged approximation solutions can be derived in two ways depending on the stage at which the depth averaging is applied the two methods of solution are outlined in sections 4 1 and 4 2 it will be shown in section 6 through comparison with results from the bem model that the depth average velocity from the evanescent components is close to zero and neglecting the evanescent components therefore results in a reasonable approximation for both solutions we will make the assumption that c f and l are constant with depth so that the physical characteristics do not change with depth and we assume that there is no dependence of c f and l on the amplitude of the oscillatory velocity i e kc number under the assumptions that the evanescent terms are zero substituting 20 and 21 into 18 and 19 gives the non dimensional force and moment on the porous wall as 26 f x ρ g a w h 2 r tanh k h k h 27 m y ρ g a w h 2 2 r k h tanh k h sech k h 1 k h 2 note that when r 1 these expressions give the linear force and moment on a solid wall therefore r is the ratio of both the force or moment on the porous wall to the force or moment on the solid wall 4 1 method 1 depth average of dynamic boundary condition substituting 20 and 21 into 6 neglecting the evanescent components and integrating both sides with respect to z gives a quadratic equation for the transmission coefficient 28 0 x 1 t t 2 i k l t 2 where 29 x 1 4 3 π c f k a f k h and 30 f k h 2 k h sinh 2 k h 4 sinh 2 k h a similar approach was taken by kriebel 1992 to solve the case where l 0 in this case t is real and 28 can be solved explicitly to give 31 r 1 1 2 x 1 1 x 1 32 t 1 2 x 1 1 x 1 in the case that l 0 an explicit solution of 28 can be obtained as explained in section 4 3 alternatively 28 can be solved numerically using standard algorithms in this work the matlab function fsolve with a first guess t 0 has been used 4 2 method 2 depth average linearised drag coefficient the quadratic drag term in the dynamic boundary condition 6 can be linearised using lorenz s principle of equivalent work to give a linear boundary condition 33 i ϕ 1 ϕ 2 β i l ϕ 1 x where 34 β 4 c f 3 π ω h 0 u n 2 u n d z h 0 u n 2 d z and 35 u n ϕ 1 x substituting 20 and 21 into 34 neglecting the evanescent components and evaluating the integrals gives 36 β 16 9 π c f a t 2 cosh 2 k h 2 k h sinh 2 k h substituting this back into the linearised dynamic boundary condition 33 together with the expressions for the potentials gives a quadratic equation for the transmission coefficient 37 0 x 2 t t 2 i k l t 2 where 38 x 2 4 3 π c f k a g k h and 39 g k h 4 3 2 cosh 2 k h 2 k h sinh 2 k h kim 1998 derived an analytical solution in a similar way by linearising the quadratic drag coefficient and neglecting the evanescent components in kim s method the equations were solved in a different way requiring the solution of quartic polynomial the derivation outlined above results in a quadratic rather than quartic equation to solve as noted in the preceding section the quadratic 37 can be either be solved numerically or explicitly as the root of a quartic polynomial as explained below 4 3 comparison of methods and explicit solution the two methods outlined above result in the same form of quadratic equation to be solved cf 28 and 37 with the coefficients x 1 and x 2 differing only in the form of the depth dependence terms f k h and g k h the functions f k h and g k h are illustrated in fig 4 the two functions tend to the same value for low k h i e long waves and tend to constant but different values for high k h the asymptotic values of the two functions for small and large values of k h are 40 f k h 1 k h as k h 0 41 f k h 1 2 as k h 42 g k h 1 k h as k h 0 43 g k h 2 3 as k h the two methods will therefore give the same results for long waves but will give a constant offset for short waves the agreement in long wave conditions is to be expected since the velocity potential is less variable with depth in long waves the method used to take the depth average will have less influence on the results the explicit solution to 28 and 37 for the case l 0 is given in 31 and 32 to obtain an explicit solution in the case l 0 we write the transmission coefficient using euler s formula as t t cos θ i sin θ where θ is the phase of t substituting this into 28 and separating the real and imaginary parts gives the following expressions 44 2 sec θ t x t 2 k l t tan θ 45 tan θ k l 2 x t where x is either x 1 or x 2 substituting 45 into 44 and using the identity sec x 1 tan 2 x gives a quartic equation for t 46 0 x 2 t 4 4 x t 3 4 k l 2 t 2 4 when k l 0 this reduces to the expression given in 32 the general solution for positive x and k l can be written down explicitly however the explicit solution involves a large number of terms and is not particularly instructive to look at the explicit solution is therefore not copied here but can easily be obtained by standard computer packages 4 4 behaviour of analytical solution from 28 and 37 it is apparent that the reflection coefficient and hence also the horizontal force and moment is a function of x either x 1 or x 2 depending on the method used and k l only the relationship between r t x and k l is shown in fig 5 the magnitude of the transmission coefficient is monotonically decreasing with increasing x corresponding to increasing c f decreasing porosity increasing wave steepness k a or decreasing k h longer waves an increase in the inertia coefficient leads to a reduction in the transmission coefficient and a negative shift in the phase of the transmitted wave the inertia coefficient has a proportionally larger effect at lower values of x as would be expected from inspection of 28 and 37 the reflection coefficient is related to the transmission coefficient by r 1 t this is true for the general solution including evanescent terms as explained at the start of this section when l 0 the phase of t is zero and r is monotonically increasing with x when l 0 the phase change in t leads to a non monotonic variation in r with x the variation of the magnitude and phase of the r and t with x and k l can be better understood by plotting the real and imaginary parts for fixed values of x as shown in fig 6 each coloured line on the plot corresponds to a solution for a fixed value of x and values of k l between 0 and when x 0 the solution to 28 and 37 is 47 t 2 2 i k l 1 2 1 2 4 k l 2 4 k l 2 i 4 k l 4 k l 2 in fact this is the exact solution since the evanescent terms are zero in the case x 0 making the substitution k l 2 tan α 2 we obtain 48 t 1 2 1 2 cos α i sin α this is the equation of a circle in the complex plane centred at t 1 2 and with radius 1 2 since 0 k l we have 0 α π and eq 48 describes a semicircle in the fourth quadrant of the complex plane the solutions for x 0 correspond to a purely inviscid interaction at the porous boundary the fluid is already assumed to be inviscid away from the porous wall where there is no energy loss due to turbulence and the pressure on the porous wall results from acceleration of the fluid through the gaps the range of values that r and t can take is bounded by semicircles in the first and fourth quadrants of the complex plane respectively representing the solutions for x 0 for x 0 the arcs representing the solutions for constant x are not quite a semicircle with the solutions lying slightly outside the semicircle defined by the two solutions on the real axis for k l 0 and k l for short waves the interaction with any structure with a vertical porous wall at the free surface will tend toward the present case where the porous wall occupies the full water column the bounds on the range of the reflection and transmission coefficients derived here would therefore be expected to apply for short waves in the more general case as well the results imply that for given values of k h k a and c f the maximum possible phase change in r is governed by solution for l 0 which is given by 31 and 32 if we denote the solution for l 0 as r 0 then the solutions for l 0 lie approximately on a semicircle centred at 1 r 0 2 with radius 1 r 0 2 in contrast the transmission coefficient can have a maximum phase lag of π 2 for any value of x as the solution arcs always intersect the imaginary axis as l however large phase lags are associated with small transmission coefficients fig 7 shows the magnitude and phase of r and t for fixed values of x and 0 k l it is evident that for a given value of r or t the maximum phase angle is bounded by the phase angle of the solution at x 0 from 47 we have r cos ψ and t cos θ when x 0 where ψ and θ are the phase angles of r and t respectively these relations provide an upper bound on the phase angles of r and t when x 0 it is interesting to consider the behaviour of the reflection coefficient in long and short waves the solution is dependent on the variable x which is a function of wave steepness if wave steepness is held constant then the amplitude tends to infinity as k h 0 conversely if amplitude is held constant then the steepness tends to infinity as k h so both cases lead to non physical results in one of the limits example solutions are shown in fig 8 for the cases of both constant steepness and constant amplitude assuming c f 100 and l 0 note that since l 0 r is real the solutions shown have been calculated using method 1 but the behaviour is the same for solutions from method 2 in the case of constant amplitude we have 49 x 1 2 4 3 π c f a h as k h 0 50 x 1 2 as k h in this case the reflection coefficient will tend to a constant value for long waves and tend to one for short waves in the case of long waves the horizontal velocity tends to a constant value a g h and hence the drag resistance of the porous wall will also tend to a constant value leading to a constant reflection coefficient the physical interpretation of the short wave limit is that since the velocity through the holes is proportional to ω a if a is constant then the velocity will tend to infinity in short waves causing the flow through the porous barrier to experience increasing drag in the limit the flow through the barrier will decrease to zero causing all energy to be reflected in reality the wave will break when the steepness exceeds the miche limit and other effects will become relevant before this limit is reached in particular the assumption that the porous wall can be modelled as a homogeneous surface will become less valid and diffraction effects will need to be accounted for see e g crowley and porter 2012 in the case of constant steepness we have 53 x 1 2 as k h 0 x 1 2 3 π c f k a as k h x 2 8 9 π c f k a as k h in this case the reflection coefficient tends to a constant value for short waves and tends to one for long waves for the short wave case maintaining a constant steepness makes the problem scale invariant and hence a constant reflection coefficient is expected under the assumption that the porous wall can be treated as a homogeneous surface the physical interpretation for the long wave limit is the same as that for the short wave limit in the constant amplitude case in the case of constant steepness waves the horizontal velocity tends to infinity as k h 0 so the drag resistance of the porous wall will also increase to infinity in fig 8 there appears to be a distinct change in the behaviour of the solution around k h 1 the convergence of the solutions toward their asymptotic values is dependent on the behaviour of the depth functions f k h and g k h from fig 4 it can be seen that for k h 1 both f k h and g k h are well approximated by 1 k h and for k h 3 both f k h and g k h are approximately constant in the case that l 0 the asymptotic behaviour of the reflection coefficient remains the same for long waves i e tending to a constant value for constant amplitude or tending to one for constant steepness but for short waves the reflection coefficient will tend to one for both cases of constant amplitude and constant steepness this can be seen from 28 and 37 since k l as k the only solution can be t 0 as before the assumption that the porous wall can be treated as a homogeneous barrier becomes less valid as the ratio of the wavelength to the size of the openings decreases and diffraction effects become more important 5 bem solution the multi domain bem approach used here is similar to that presented in liu and li 2017 to simplify the analysis we define dimensionless potentials as 54 ϕ j i g a ω ϕ j d j 1 2 where the superscript d indicates a dimensionless quantity two domains are defined to solve the bem problem the first domain located on the up wave side of the porous screen lhs in fig 3 is bounded by the porous wall the free surface the sea floor and a control surface at x c the second domain located on the down wave side of the wall rhs in fig 4 is the mirror of the first domain in the porous wall with the control surface at x c the normal vectors to the boundaries n are defined to point outward from each domain application of green s third identity to the two domains yields integral equations for ϕ 1 d and ϕ 2 d 55 1 2 ϕ j d γ j ϕ j d g n g ϕ j d n d s j 1 2 where γ j is the boundary of domain j and g is a green function satisfying the laplace equation defined as 56 g 1 2 π ln x ξ 2 z η 2 and ξ η are the coordinates of an arbitrary point on γ j the boundary conditions for the integral equations on the mean surface and sea bed are given by 15 and 16 respectively with ϕ j replaced by ϕ j d note that since the normal vectors to the boundaries in each domain are in opposite directions on the porous wall the continuity of velocity condition across the porous wall 17 is expressed as 57 ϕ 1 d n 1 ϕ 2 d n 2 x 0 the dynamic boundary condition on the porous wall is given by 6 and 54 as 58 ϕ 1 d n i k σ d ϕ 1 d ϕ 2 d x 0 59 σ d 4 3 π c f a ϕ 1 d n i k l 1 the boundary conditions on the control surfaces are derived as follows if c is sufficiently large then the evanescent components tend to zero so 60 ϕ 1 d c z z 0 z e i k c r e i k c c 61 ϕ 2 d c z z 0 z 1 r e i k c c assuming that c is sufficiently large for 60 and 61 to hold expressions for r in terms of ϕ 1 d and ϕ 2 d at x c are obtained by integrating both sides of 60 and 61 over z to give 62 r e i k c n 0 h 0 ϕ 1 d c z d z e 2 i k c x c 63 r 1 e i k c n 0 h 0 ϕ 2 d c z d z x c where 64 n 0 h 0 z 0 z d z tanh k h k substituting 62 and 63 into 60 and 61 and taking partial derivatives gives the boundary conditions on the control surfaces as 65 ϕ 1 d n i k z 0 z 2 e i k c 1 n 0 h 0 ϕ 1 d c z d z x c 66 ϕ 2 d n i k z 0 z n 0 h 0 ϕ 2 d c z d z x c the system is solved by discretising the boundary into discrete segments and assuming the potential is constant on each panel the boundary conditions are substituted into the discretised form of 55 giving a linear system of equations for the potential see appendix where the strength of the dissipation coefficient σ d z on each panel of the porous wall is an additional unknown note that σ d z varies with water depth the system is solved iteratively with a first guess of σ d z 1 0 5 corresponding to a high porosity after the system is solved the normalised velocity through the porous wall v m z ϕ 1 d 0 z n is recalculated from 58 and the new velocity is defined as v m 1 z v m z v m 1 z 2 where the superscripts denote the iteration number and v 0 z 0 the new velocity is then used to define a new value of σ d z on each panel using 59 and the system is resolved the iterations are terminated when max v m z v m 1 z z h 0 1 0 4 once the system has been solved the reflection coefficient can be calculated from 62 and the force and moment per unit width on the wall can be calculated from 18 and 19 a convergence study was conducted to determine an adequate discretisation length and position for the control surfaces for various values of c f k a k h and l it was found that using a constant discretisation length of h 200 and locating the control surfaces at c 5 h was sufficient to obtain a stable solution 6 comparison of bem and analytical solutions 6 1 velocities from evanescent components before comparing the bem and analytical solutions directly it is instructive to consider the size of the evanescent components of the potential relative to the progressive components the total dimensionless flow velocity through the porous screen is given by 67 v t 1 k ϕ 1 d x the dimensionless velocity through the porous screen associated with the progressive components of the potential is given by 68 v p i z 0 z r 1 the dimensionless velocity through the porous screen associated with the evanescent components is therefore given by 69 v e v t v p figs 9 and 11 show the ratio v e z v p 0 where v t and v p have both been calculated from the bem model the denominator in the ratio v e z v p 0 is the maximum value of the velocity from the progressive components of the wave field which occurs at the free surface the cases shown are for k a 0 1 c f 10 50 100 200 and l 0 0 5 results are shown for various values of k h with the colour of the line indicating the value of k h as mentioned in section 4 in the long wave limit when k h 0 the evanescent component of the wave field tends to zero figs 9 and 11 show that the relative size of the evanescent waves increases with k h the magnitude of the evanescent components also increases with the friction coefficient c f with a peak value of v e z v p 0 of around 25 at the free surface for the range of variables shown here the magnitude of the evanescent components decreases slightly with increasing inertial coefficient l the phase of the velocity from the evanescent components relative to the phase of the progressive component is shown in fig 10 for the cases corresponding to those in fig 9 for l 0 at the top of the water column the evanescent components have a phase lead over the progressive component whilst further down the water column the trend is reversed the pattern is similar for the cases with l 0 5 and is not shown here fig 12 compares the depth averaged values of v t and v p denoted v t and v p where both values have been calculated from the bem model the two values are in good agreement indicating that although the analytical model will not give the correct vertical distribution of flow velocity through the porous wall the approximation using the depth averaged velocity should be reasonable for the case l 0 v t is slightly larger than v p at higher k h and c f for the case l 0 5 there is slightly better agreement between v t and v p for the lower values of c f at higher k h v t is slightly lower than v p indicating that the phasing of the evanescent components serves to oppose the progressive components on average 6 2 reflection transmission and forces figs 13 and 14 present a comparison of the magnitude of the reflection coefficient and normalised surge force and moment from the bem and analytical models the force and moment on the porous wall have been normalised by the force and moment on a solid wall for the same wave conditions denoted f 0 and m 0 respectively for the two analytical models we have r f x f 0 m y m 0 however for the bem model the presence of the evanescent components of the wave field results in differences between these quantities so it is interesting to compare all three values in all cases the agreement is good in longer waves with k h 1 this is consistent with the observation that the relative size of the evanescent waves decreases with k h implying that neglecting the evanescent components is a reasonable approximation for the analytical models at higher values of k h the magnitude r from the bem model agrees better with the analytical model using method 2 with method 1 giving slightly lower values in the case l 0 in the case l 0 5 the agreement is closer between all three models which is consistent with the observation above that the evanescent waves are smaller in this case for the surge force the analytical solution using method 1 agrees better with the bem model for c f 10 but the force from the bem model is slightly lower than both analytical solutions for higher c f and l 0 with method 2 giving a larger discrepancy for the moment about the seabed the bem model gives a value in between the two analytical solutions for 1 k h 3 with method 1 giving better agreement at higher k h the increasing discrepancy at higher k h for larger values of c f is consistent with the larger relative size of the evanescent velocities since neglecting these components will result in a larger error in these cases the phase of r f x and m y is shown in fig 15 for the case l 0 5 the case l 0 is not shown as the phase is zero for all models in this case the phases are generally is good agreement for all three models but the agreement is marginally closer for method 1 6 3 effect of inertial coefficient in section 4 4 the it was shown that the analytic solutions fall on near semicircular arcs in the complex plane with the position on the arc determined by the value of k l runs with the bem model were conducted to verify this behaviour for the numerical solution the analysis presented in section 4 4 considered the behaviour of the solution for constant values of the coefficient x the coefficient x is a function of k h k a and c f but with the dependence on k h differing between methods 1 and 2 the runs with the bem model were conducted for k h 1 and k h 4 which represents solutions for long and short waves respectively for each value of k h runs were conducted for k a 0 1 c f 0 1 and k l 0 0 5 1 2 5 10 the results are shown in fig 16 for the long wave case with k h 1 the results from the bem model and analytic solutions agree very well there is negligible difference between the two analytic solutions since the functions f k h and g k h have the same asymptotic behaviour for low k h see fig 4 moreover as discussed above at low k h the evanescent component of the potential is smaller meaning that the analytic solutions will be good approximations for the short wave case with k h 4 there is a small difference between the two analytic solutions when c f 0 which is due to the difference in the functions f k h and g k h when c f 0 these functions are not part of the solution hence the two analytic solutions coincide the analytic solution for c f 0 is the exact solution to the linear potential flow problem so in theory the bem solution should exactly coincide in practice there are some small differences due to numerical effects related to discretisation of the problem however the agreement is good overall for the cases with c f 0 the bem solution lies somewhere between the two analytical solutions but again the agreement is good overall 7 conclusions two analytical solutions for wave interaction with a vertical porous barrier have been presented the first extends the solution of kriebel 1992 to include the inertial effects of the porous barrier and the second simplifies the solution of kim 1998 the two methods were shown to both be the solution of the same quadratic equation with the difference occurring in the depth dependence for the quadratic coefficient the analytical solutions provide a relationship between the behaviour of reflection and transmission coefficient and forces on the porous barrier with the wave conditions and porosity parameters it was shown that the range of values that the reflection and transmission coefficient can take is bounded by a semicircle in the complex plane of radius 1 2 centred on the real axis at r 1 2 with the semicircle lying in the first quadrant of the plane for the reflection coefficient and in the fourth quadrant for the transmission coefficient it was also shown that the maximum phase angle for a given value of r or t is bounded by the relations 0 ψ arccos r and arccos t θ 0 where ψ and θ are the phase angles of r and t respectively the analytical solution was also used to derive the asymptotic behaviour of the solution for long and short waves for the cases of constant amplitude and constant steepness for the case of constant amplitude waves the reflection and transmission coefficients tend to constant values for long waves similarly for constant steepness waves the reflection and transmission coefficients tend to constant values for short waves the cases of constant amplitude in the short wave limit and constant steepness in the long wave limit both correspond to non physical cases of either infinite steepness or infinite amplitude respectively the analytical solutions are approximate in that they both neglect the evanescent components in the wave field results from an iterative bem model demonstrate that for longer waves this assumption is well justified but for shorter waves the amplitude of the velocity through the porous wall from the evanescent modes can be up to 25 of the velocity from the progressive modes at the free surface despite neglecting the evanescent components of the wave field both analytical solutions agree well with the bem model in the prediction of the reflection and transmission coefficients and forces and moments on the porous wall for the reflection coefficient the solution based on kim s method has slightly better agreement with the bem model than the solution based on kriebel s method with kriebel s method leading to a small under prediction of the reflection coefficient at higher frequencies however the solution based on kriebel s method gives better agreement in terms of forces and moments credit authorship contribution statement ed mackay methodology software formal analysis writing original draft lars johanning writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was funded under epsrc uk grant ep r007519 1 appendix matrix equations for bem model the boundary of each domain is discretised with n p panels on the porous wall n s panels on the free surface n c panels on the control surface and n b panels on the seabed panels in the up wave domain are numbered sequentially in an anticlockwise direction starting from the seabed at the porous wall similarly panels in the down wave domain are numbered clockwise starting at the same point define matrices 70 d m n g x m x n n s n m n 1 2 m n 71 s m n g x m x n s n m n s n 2 π log s n 2 1 m n where x n and s n are the centre and length of panel n respectively after gathering terms the system of equations for the potentials in each domain can be written as 72 m 1 m 2 m 2 m 1 ϕ 1 ϕ 2 s 0 0 s w where 73 m 1 i k σ s p k s s γ 0 d 74 m 2 i k σ s p 0 0 0 the vector w is given by 75 w m 2 k z 0 z m e i k c π 2 m n p n s 1 n p n s n c 0 otherwise the matrices s p s s s c and s b are sub matrices of s corresponding to the terms multiplying the potentials on the porous surface control and bottom panels respectively so that s s p s s s c s b the notation x y denotes the hadamard product elementwise multiplication and σ is a matrix the same size as s p with rows corresponding to the porous parameter on each panel on the porous wall updated on each iteration with σ i j σ d x j the matrix γ is the same size as s c with terms given by 76 γ m n i k s n n 0 j 1 n c s c m j z 0 z j 
22071,this paper introduces distributed control laws to make all spherical underwater robots rendezvous in a three dimensional environment with many obstacles assume that every spherical robot is located in 3 d environments where gps is not available also each robot moves with a constant speed and is given different available power level initially the maneuver of every robot consumes its power which implies that all robots must rendezvous in such a way that they do not run out of power this paper proposes how to select the rendezvous points considering the power consumption then distributed control laws are developed to enable rendezvous of multiple spherical robots with limited power using matlab simulations we verify the effectiveness of our rendezvous approach in 3 d environments with many obstacles keywords networked robots mobile sensor networks power level distributed rendezvous control network connectedness obstacles spherical robot 1 introduction multi robot systems can be utilized in various tasks such as target chasing kim 2019a 2019b space exploration ajorlou et al 2010 dimarogonas and johansson 2008 or sensor networks kim 2018 2019a 2019b ando et al 1999a flocchinia et al 2005 coordinating multiple robots are used to perform many tasks such as rendezvous cortés et al 2006 lin et al 2003 ji and egerstedt 2007 roza et al 2014 park and hutchinson 2014 spacecraft docking muralidharan and emami 2017 environmental monitoring yu et al 2019 wei et al 2018 2019 or formation control ajorlou et al 2010 dimarogonas and johansson 2008 chen et al 2015 this paper handles the rendezvous problem of making multiple underwater robots meet at a common location once all robots meet then we recharge the robots or transfer the robots to deploy at a new environment the difficulty of rendezvous problem gets elevated once a robot is equipped with global positioning systems gps however this is not feasible in gps denied environments such as underwater environments in this paper we consider a spherical robot as presented in suarez fernandezparra et al 1906 the spherical robot is characterized by a manifold design thruster configuration for both locomotion and maneuvering as well as on a novel pendulum based passive pitch control mechanism by adopting a streamlined spherical shape design attitude motions can be made in place minimizing the number of moving parts and protruding elements while obtaining high stability and flexibility along with a zero degree turn radius for high maneuverability and lower drag forces in this paper a spherical robot does not know its location in the global coordinate system i e a robot is not localized using gps each robot can only sense nearby robots and every robot s maneuver is based on proximity sensor measurements under these assumptions a robot cannot move toward its designated rendezvous point directly this paper assumes that each spherical robot moves with a constant speed and is given different available power level initially the movement of every robot consumes its power which implies that all robots must rendezvous in such a way that they do not run out of power this paper proposes how to select the rendezvous points considering the power consumption of every robot then distributed control laws are applied to enable rendezvous of multiple robots with limited power here we say that a controller is distributed in the case where every robot s maneuver is based only on proximity sensors with finite range there are many papers to make multiple robots rendezvous under distributed controllers cortés et al 2006 lin et al 2003 roza et al 2014 park and hutchinson 2014 gulzar et al 2018 presented a review of consensus problems in multi agent coordination systems the authors of yu et al 2008 zheng and sun 2014 kriegleder et al 2015 zhao and zheng 2017 presented rendezvous controllers to achieve rendezvous of multiple robots based on bearings only measurements the authors of ando et al 1999b park and hutchinson 2016 jadbabaie et al 2003 presented the rendezvous controller based on proximity sensors providing bearing range measurements the rendezvous controller in ando et al 1999b works by making a robot move towards the center of the smallest circle enclosing the robots visible from the robot however ando et al 1999b considered a two dimensional environment and did not consider the power consumption of every robot hence a robot under power constraint cannot achieve rendezvous using ando et al 1999b the authors of de hoog et al 2010 used a tree structure for multi robot exploration while maintaining communication links between robots also mukherjee and ghose 2016 utilized a hierarchical tree structure to perform cyclic pursuit rendezvous of multiple robots this paper also uses a tree structure for efficient rendezvous of multiple underwater robots to the best of our knowledge this paper is novel in considering the power consumption of each robot during the distributed rendezvous task in this paper the rendezvous points are selected among the initial positions of spherical robots the rendezvous robots indicate spherical robots located at the rendezvous points this paper proposes how to select the rendezvous robots considering the power consumption of every robot then distributed control laws are developed to enable rendezvous of multiple spherical underwater robots with limited power we prove that under the proposed controllers every spherical robot is always connected to its associated rendezvous robot moreover each robot s path is generated to assure collision avoidance matlab simulations are utilized to demonstrate the effectiveness of our distributed rendezvous controller in 3 d cluttered environments section 2 introduces preliminary information of this paper section 3 3 introduces our distributed rendezvous control laws to make all underwater robots meet at rendezvous robots which are selected considering the power consumption of every robot section 4 demonstrates simulation results of our distributed controllers section 5 provides conclusions 2 background this section reviews background information that is needed for the proposed rendezvous control 2 1 rigid body dynamics we introduce several definitions which are utilized in rigid body dynamics fossen 1994 this manuscript utilizes two reference frames an inertial reference frame i and a body fixed reference frame b fossen 1994 the origin of i is an appropriate location with the axes pointing north east and down respectively the b frame is fixed to a robot and acts as the moving frame the origin of b frame is at the center of gravity of the robot the b frame has three orthogonal axes r o l l a x i s p i t c h a x i s and y a w a x i s these three axes are aligned along the principal directions for the body φ θ ψ denote euler roll angle euler pitch angle and euler yaw angle in b frame φ θ ψ are utilized to set a 3 d body in any orientation let c η denote cos η also let s η denote sin η let t η denote tan η the counterclockwise rotation of ψ euler yaw angle about y a w a x i s in b frame is represented by the following rotation matrix r ψ 1 r ψ c ψ s ψ 0 s ψ c ψ 0 0 0 1 the counterclockwise rotation of θ euler pitch angle about p i t c h a x i s in b frame is represented by the following rotation matrix r θ 2 r θ c θ 0 s θ 0 1 0 s θ 0 c θ the counterclockwise rotation of φ euler roll angle about r o l l a x i s in b frame is represented by the following rotation matrix r φ 3 r φ 1 0 0 0 c φ s φ 0 s φ c φ a rotation matrix can be formed by multiplying the yaw pitch and roll rotation matrices to obtain 4 r ψ θ φ r ψ r θ r φ 2 2 graph theory we introduce several concepts on graph theory a tree graph is rooted if one node has been set as the root in a rooted tree the parent of a node u is the node connected to it on the path to the root a child of a node u is a node of which u is the parent we use p u to represent the parent node of u also we use c u to represent a child node of u a descendant of a node u is any node which is either the child of u or is recursively the descendant of any of the children of u an ancestor of a node u is any node which is either the parent of u or is recursively the ancestor of the parent of u a leaf in a tree is a node with no child 2 3 assumptions and definitions we introduce assumptions and definitions in this paper there are n robots in total each robot u i where i 1 2 n has its associated power level thus can meet a rendezvous robot which is reachable while consuming its power let l i denote the power level of u i we further introduce the adjacency graph a v a e a in which every node in v a represents a robot a is an undirected graph and it is assumed that a is connected initially every edge say u i u j e a indicates that u i and u j can sense each other using local sensors such that the line of sight between the two robots is not blocked by an obstacle hence as a robot moves along an edge in a it does not collide with an obstacle u i u j e a implies that u i and u j are neighbors to each other u i u j is identical to u j u i since a is an undirected graph each edge say u i u j e a is weighted by w i j which is the distance between u i and u j the distance information between two neighboring robots is available using local sensors of the robots s r denotes the maximum sensing range of a robot thus w i j s r for all i j 1 2 n let d a denote the diameter of a which is defined as 5 d a m a x u v v a d u v here d u v is a hop distance between two nodes u and v in v a in other words a graph s diameter is the largest number of nodes which must be traversed in order to travel from one node to another let u i denote the location of a robot u i where i 1 2 n this paper considers a robot in 3 d environments u i represents the 3 d position of u i in the cartesian coordinate systems let u i k denote u i at time step k in discrete time systems the speed of u i is s this implies that we consider a robot maneuvering with a constant speed let h i k denote the heading vector of u i at time step k we have h i k 1 t denotes the sampling interval in discrete time systems as the motion model of a robot we use 6 u i k 1 u i k h i k t s this simple motion model is commonly used in the literature on robotics kim 2019a 2019c we next explain the power consumption of a robot moving with a constant speed consider the case where a robot moves along a path composed of multiple line segments after a robot moves along a line segment then it makes a turn followed by moving along the next line segment by adopting a streamlined spherical shape design in suarez fernandezparra et al 1906 attitude motions can be made in place while obtaining high stability along with a zero degree turn radius for high maneuverability we assume that the power consumption of a robot is proportional to the travel length of the robot this assumption is reasonable since a robot moves with a constant speed let u n i t p denote the power consumption as a robot moves along a unit length line also the robot consumes its power as it makes a turn at the end of a line segment we assume that a robot s power consumption while turning is less than a certain constant say t u r n p for instance consider the case where a robot u i moves along a path composed of d line segments moreover the total length of the path is l s then u i can move along the path without consuming all its power in the case where 7 l i l s u n i t p d 1 t u r n p is met let p a t h l e n a u i u j denote the shortest path length between two nodes u i v a and u j v a according to the definition of a graph diameter a shortest path between any two nodes in a graph a has less than d a nodes along its path this implies that the path is composed of multiple line segments such that the total number of line segments is less than d a using 7 u i can move along a shortest path to reach another node u j in the case where 8 l i p a t h l e n a u i u j u n i t p d a 1 t u r n p is met if 8 is met then we say that u i can reach u j while not consuming all its power if 8 is not met then we say that u i cannot reach u j due to power limits a depleted robot is a robot which does not have enough power to reach its neighbor in other words a depleted robot is a robot u i which satisfies that 9 l i m i n u j n i p a t h l e n a u i u j u n i t p here n i denotes the set of neighbors of u i that are sensed by u i every depleted robot must be set as a rendezvous robot as presented in algorithm 3 this is due to the fact that a depleted robot does not have enough power to reach any of its neighbor robot 3 distributed rendezvous controllers first the adjacency graph a is built in a distributed manner such that each robot shares information with its neighbor robots how to build a in a distributed manner is presented in section 3 1 then rendezvous robots are selected based on both a and l i where i 1 2 n thereafter rendezvous control in section 3 3 is applied to make all robots rendezvous at the selected rendezvous robots 3 1 build the adjacency graph in a distributed manner first the adjacency graph a is built in a distributed manner using algorithm 1 in algorithm 1 c indicates the iteration step which is initialized as 0 and increases by one at each loop let q i c be defined as the set of edges detected by u i at iteration step c of algorithm 1 at iteration step 0 u i builds q i 0 by sensing its neighbors n i using its local sensors as an example of algorithm1 one considers a graph with three edges u 1 u 2 u 2 u 3 and u 1 u 3 then each robot u i builds q i 0 as follows q 1 0 u 1 u 2 u 1 u 3 q 2 0 u 2 u 1 u 2 u 3 q 3 0 u 3 u 1 u 3 u 2 in algorithm 1 q i c q i c 1 is used here represents the set subtraction operator q i c q i c 1 is the set of edges which are in q i c but not in q i c 1 also q i c q j c is used in algorithm1 represents the set union operator q i c q j c is the set of edges which are in q i c or in q j c algorithm 1 was inspired by the consensus algorithms in alonso mora et al 2016 algorithm 1 distributed algorithm of u i for constructing the adjacency graph a image 1 we say that q i converges at an iteration step say c in the case where q i c q i c for all c c for any i 1 2 n q i converges in a maximum of d a iterations in other words c d a this convergence threshold is proved in the proposition 1 of alonso mora et al 2016 hence this work omits the proof 3 2 rendezvous robot selection once a is built in a distributed manner then rendezvous robots are selected based on both a and l i where i n we first consider the case of selecting only one rendezvous robot we propose how to select one rendezvous robot considering the power consumption of every robot algorithm 2 presents our selection method in detail algorithm 2 rendezvous robot selection image 2 we explain algorithm 2 in detail a robot with low power cannot move a long distance this implies that it is desirable to select the rendezvous robot as a robot with low power hence algorithm 2 selects the robot with the lowest power and checks if it is feasible to set the robot as the rendezvous robot in algorithm 2 suppose that l j is the smallest element in l s e t suppose that u k cannot reach u j due to the power limit of u k l k l j since l j is the smallest element in l s e t this case u j cannot reach u k since u k cannot reach u j and l k l j thus u k cannot be selected as a rendezvous robot hence u k is in r e m o v e s e t suppose that we cannot select a single rendezvous robot satisfying the power constraints under algorithm 2 in this case algorithm 3 is used to select multiple rendezvous robots satisfying the power constraints algorithm 3 multiple rendezvous robots selection image 3 algorithm 3 increases the number of rendezvous robots gradually until we find rendezvous robots satisfying the power constraints we explain algorithm 3 in detail a depleted robot cannot maneuver to reach its neighbor thus all depleted robots are set as rendezvous robots initially a robot with low power cannot move a long distance this implies that it is desirable to select the rendezvous robots as robots with low power hence algorithm 3 iteratively selects the set of robots with low power and checks if it is feasible to select the robots in the set as the rendezvous robots in algorithm 3 s e t d e p denotes a robot set composed of depleted robots let l s e t l 1 l 2 l n l d e p is the subset of l s e t such that each element in l d e p is associated to a robot in s e t d e p for instance if l d e p is l 3 l 5 then s e t d e p is u 3 u 5 in algorithm 3 l m o v e denotes the subset of l s e t such that each element in l m o v e is not associated to a robot in s e t d e p in algorithm 3 k is a integer variable which increases from 1 to l m o v e in this algorithm k combinations of l m o v e are formed in mathematics a combination is a selection of items from a collection such that the order of selection does not matter a k combination of l m o v e is a subset of k distinct elements of l m o v e the number of k combinations is equal to the binomial coefficient 10 c l m o v e k l m o v e l m o v e 1 l m o v e k 1 k k 1 1 in algorithm 3 l s u b s e t is a set of sets for instance consider the case where k 2 and s e t d e p is an empty set this case l s u b s e t is initialized as l 1 l 2 l 1 l 3 l n 1 l n there are c n 2 sets in this l s u b s e t suppose that k 2 and that s e t d e p is an empty set then s e t s in algorithm 3 has two elements if s e t s l 1 l n then s e t r u 1 d m since u i is associated to l i and s e t d e p is empty if every robot can reach a depleted robot while not consuming all its power then algorithm 3 is done in this algorithm s e t r e n d z is the set of rendezvous robots satisfying the power constraints the computational load of algorithm 3 is analyzed in the worst case algorithm 3 proceeds from k 1 to k l m o v e as k 1 algorithm 3 examines c l m o v e 1 cases also as k 2 algorithm 3 examines c l m o v e 2 cases by iterating this until k l m o v e algorithm 3 examines cases in total this implies that the computational load of algorithm 3 increases proportional to 2 l m o v e however as long as every robot has some power for its maneuver the rendezvous robots can be found before k reaches l m o v e 11 c l m o v e 1 c l m o v e 2 c l m o v e 3 c l m o v e l m o v e 3 3 distributed rendezvous control suppose that rendezvous robots s e t r e n d z are selected based on both a and l i where i n thereafter rendezvous control in this subsection is utilized to make all robots rendezvous at the selected rendezvous robots let s e t r e n d z denote the number of rendezvous robots in s e t r e n d z let d m where m 1 2 s e t r e n d z denote every robot in s e t r e n d z let r u i s e t r e n d z denote the rendezvous robot assigned to a robot u i since our goal is making all robots meet at rendezvous robots while considering limited power we assign each robot u i a rendezvous robot r u i s e t r e n d z as follows 12 r u i a r g m i n d m s e t r e n d z d a u i d m here d a u i u j presents the shortest path distance between u i and u j in a d a u i u j can be derived under dijkstra s algorithm lavalle 2006 all robots in v a are grouped to build s e t r e n d z sub graphs a m v m e m a in which every sub graph contains nodes which meet the following condition 13 u i v m r u i d m u i v a since a m is connected a shortest path tree t m a m whose root is d m can be constructed note that a m is constructed only at time step 0 under algorithm1 let p a t h 0 u i d m denote the shortest path from a robot u i v m to d m at time step 0 under this definition t m at time step 0 contains p a t h 0 u i d m note that a tree t m cannot intersect with another tree say t m on the contrary suppose that t m intersects t m at a node say u s this case 12 leads to 14 d a u s d m d a u s d m m i n d s e t r e n d z d a u s d this case rarely happens using numerical calculation of a shortest path distance since a shortest path distance is a real positive value with double type in c programming we can avoid this case by slightly perturbing the position of u s we next discuss a rendezvous control enabling every robot in t m to meet at d m algorithm 4 presents the process we explain algorithm 4 each robot in t m tracks the shortest path to d m in other words every robot in t m keeps visiting its ancestors in t m until meeting d m a non leaf robot u initiates heading towards p u only after u meets all its children after u meets p u u accesses the id of p p u thereafter u heads towards p p u we iterate this until u meets d m consider the case where u is a leaf with no children this case u initiates heading towards p u at time step 0 after u meets p u u accesses the id of p p u thereafter u heads towards p p u we iterate this until u meets d m algorithm 4 distributed rendezvous controllers for the shortest path tree t m image 4 in algorithm 4 every robot say u in t m stores the following data the id of its parent in t m and the id of its every child the id of p u in t m is utilized to make u follow p a t h 0 u d m see algorithm 4 the id of c u is utilized to make u detect a situation in which all c u have met u see algorithm 4 algorithm 4 can handle the faulty case where an interaction communication link is suddenly broken suppose that this faulty case occurs at time step k then we reset the time step to 0 and re run algorithm1 to build a new shortest path tree t then using algorithm 3 and 13 we build t m where m 1 2 s e t r e n d z we re run algorithm 4 based on the newly constructed t m we next prove that algorithm 4 is distributed moreover it is proved that a robot s path under algorithm 4 assures collision avoidance it is also proved that every robot is always connected to its associated root rendezvous robot this further implies that one can preserve the network connectedness during a maneuver theorem 1 algorithm 4 is distributed every robot is always connected to its associated root rendezvous robot moreover a robot s path under algorithm 4 assures collision avoidance proof suppose that d m is the root rendezvous robot associated to a robot u j consider the case where p a t h 0 u j d m consists of a sequence of robots p 1 p 2 p 3 p e n d d m we next prove that p l l 1 2 e n d 1 initiates following the shortest path to d m only after u j meets p l a non leaf robot initiates maneuvering only after meeting all its children in t m moreover p a t h 0 c u j d m contains p a t h 0 u j d m hence a robot tracks the path that was tracked by its child under deduction a robot tracks the path that was tracked by its descendant every robot on p a t h 0 u j d m is an ancestor of u j hence p l l 1 2 e n d 1 tracks the path that was already tracked by u j in other words p l initiates following the shortest path to d m only after p l meets u j in the case where u j just meets p l u j can sense p l 1 by utilizing local sensors since u j s maneuver is based on local sensors algorithm 4 is distributed we next prove that every robot is connected to its associated root rendezvous robot while it moves consider the case in which u j just meets p l l 1 2 e n d 1 and heads towards p l 1 this case u j can interact with p l 1 every robot in p l 1 p l 2 p l 3 p e n d d m does not move in this case this implies that p l 1 is connected to d m since u j is connected to p l 1 and p l 1 is connected to d m u j is also connected to d m hence every robot is connected to its associated root rendezvous robot we next prove that a robot s path under algorithm 4 assures collision avoidance p a t h 0 u j d m is a collision free path for u j since p a t h 0 u j d m t m a m a and a is a collision free graph according to its definition theorem 1 proved that a robot s path under algorithm 4 assures collision avoidance however we need to make a robot avoid colliding with another moving robot we can use local collision avoidance approach in kim 2019c to avoid collision between moving robots 3 4 local heading controller recall that under the rendezvous control a spherical robot tracks the shortest path until reaching its associated rendezvous robot suppose that the designated rendezvous robot of u i is d m let p denote the shortest path of u i to reach its associated rendezvous robot d m suppose that p consists of a sequence of robots p 1 p 2 p 3 p e n d d m let p j denote the location of p j for convenience suppose that u i visited p j and the next point to visit is p j 1 we present the local controller to make u i head towards p j 1 the heading direction of u i is controlled while maintaining its speed the heading of u i in 6 is controlled under 15 h i k p j 1 u i k p j 1 u i k this implies that u i maneuvers towards p j 1 we next search for the orientation of the body ψ θ and φ associated to h i k recall that ψ θ and φ appear in section 2 1 since we do not consider the rolling of the robot s body we set φ as zero let c i represent the i th element in a column matrix c for convenience we have h i k 1 c ψ c θ h i k 2 s ψ c θ 16 h i k 3 s θ thus we get 17 θ a t a n 2 h i k 3 q d here q d h i k 1 2 h i k 2 2 in the case where c θ 0 we get 18 ψ a t a n 2 h i k 2 h i k 1 in the case where c θ 0 we get 19 ψ a t a n 2 h i k 2 h i k 1 suarez fernandezparra et al 1906 presented how to control the pitch of a spherical robot so that it converges to a designated pitch θ also suarez fernandezparra et al 1906 presented how to control the yaw of a spherical robot so that it converges to a designated yaw ψ using the attitude control of suarez fernandezparra et al 1906 we can make the robot head towards p j 1 once u i meets p j 1 then u i maneuvers towards the next waypoint p j 2 this local control is feasible based on proximity sensors of u i we do not require global localization of a robot for this local control 4 simulation results this section presents the matlab simulation results to verify our distributed rendezvous control the simulation settings are as follows we use 50 robots in total the sampling interval is t 0 1 seconds moreover the speed of each robot is s 0 1 distance units per second the maximum sensing range is set as s r 5 distance units we set u n i t p 1 and t u r n p 0 01 4 1 scenario 1 fig 1 shows the maneuver of each robot under our distributed rendezvous control under algorithm 2 one rendezvous robot is set considering the power limit of every robot the initial position of every robot is marked with red asterisks each robot s trajectory is depicted with green circles 3 d obstacles are depicted with spheres fig 2 shows the final position of every robot under our distributed rendezvous control see that every robot converged to the rendezvous robot green circle all robots spend 234 s to rendezvous at the designated rendezvous robot whose coordinate is 28 4563 76 0727 79 3138 fig 3 shows the power consumption of each robot compared to the power limit l i of every robot the x axis presents the robot index the y axis presents the distance traveled by each robot u 41 is set as the rendezvous robot thus the travel distance of u 41 is zero see that the rendezvous robot is set considering the power limit of every robot 4 2 scenario 2 fig 4 shows the maneuver of each robot under our distributed rendezvous control the initial position of every robot is marked with red asterisks each robot s trajectory is depicted with green circles 3 d obstacles are depicted with spheres under algorithm 3 two rendezvous robots are set considering the power limit of every robot fig 5 shows the final position of every robot under our distributed rendezvous control see that every robot converged to one of two rendezvous robots two green circles in the figure all robots spend 174 s to rendezvous at two rendezvous robots whose coordinates are 69 7249 50 0149 69 0007 and 151 4546 109 3384 71 4776 respectively since two rendezvous robots are selected the rendezvous task is achieved faster than the case where only one rendezvous robot is selected fig 6 shows the power consumption of each robot compared to the power limit l i of every robot u 1 and u 29 are set as two rendezvous robots thus the travel distance of each of these two robots is zero see that the rendezvous robots are set considering the power limit of every robot 5 conclusions this paper considers a scenario where every underwater robot is initially distributed in 3 d gps denied environments with many obstacles we develop distributed rendezvous control laws for multiple constant speed robots considering power limits this paper proposes how to select the rendezvous robots considering the power consumption then multiple underwater robots meet at the selected rendezvous robots while maintaining network connectivity matlab simulations are utilized to verify the effectiveness of the proposed approach in 3 d cluttered environments the proposed approach can be applied in 2 d environments as well as in 3 d environments in 2 d environments the motion of every robot is constrained on a 2 d plane then we can build 2 d tree graphs rooted at rendezvous robots in the plane each robot traverses its associated tree graph until the rendezvous is achieved declaration of competing interest the author has no competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was funded by hongik university sejong city south korea 
22071,this paper introduces distributed control laws to make all spherical underwater robots rendezvous in a three dimensional environment with many obstacles assume that every spherical robot is located in 3 d environments where gps is not available also each robot moves with a constant speed and is given different available power level initially the maneuver of every robot consumes its power which implies that all robots must rendezvous in such a way that they do not run out of power this paper proposes how to select the rendezvous points considering the power consumption then distributed control laws are developed to enable rendezvous of multiple spherical robots with limited power using matlab simulations we verify the effectiveness of our rendezvous approach in 3 d environments with many obstacles keywords networked robots mobile sensor networks power level distributed rendezvous control network connectedness obstacles spherical robot 1 introduction multi robot systems can be utilized in various tasks such as target chasing kim 2019a 2019b space exploration ajorlou et al 2010 dimarogonas and johansson 2008 or sensor networks kim 2018 2019a 2019b ando et al 1999a flocchinia et al 2005 coordinating multiple robots are used to perform many tasks such as rendezvous cortés et al 2006 lin et al 2003 ji and egerstedt 2007 roza et al 2014 park and hutchinson 2014 spacecraft docking muralidharan and emami 2017 environmental monitoring yu et al 2019 wei et al 2018 2019 or formation control ajorlou et al 2010 dimarogonas and johansson 2008 chen et al 2015 this paper handles the rendezvous problem of making multiple underwater robots meet at a common location once all robots meet then we recharge the robots or transfer the robots to deploy at a new environment the difficulty of rendezvous problem gets elevated once a robot is equipped with global positioning systems gps however this is not feasible in gps denied environments such as underwater environments in this paper we consider a spherical robot as presented in suarez fernandezparra et al 1906 the spherical robot is characterized by a manifold design thruster configuration for both locomotion and maneuvering as well as on a novel pendulum based passive pitch control mechanism by adopting a streamlined spherical shape design attitude motions can be made in place minimizing the number of moving parts and protruding elements while obtaining high stability and flexibility along with a zero degree turn radius for high maneuverability and lower drag forces in this paper a spherical robot does not know its location in the global coordinate system i e a robot is not localized using gps each robot can only sense nearby robots and every robot s maneuver is based on proximity sensor measurements under these assumptions a robot cannot move toward its designated rendezvous point directly this paper assumes that each spherical robot moves with a constant speed and is given different available power level initially the movement of every robot consumes its power which implies that all robots must rendezvous in such a way that they do not run out of power this paper proposes how to select the rendezvous points considering the power consumption of every robot then distributed control laws are applied to enable rendezvous of multiple robots with limited power here we say that a controller is distributed in the case where every robot s maneuver is based only on proximity sensors with finite range there are many papers to make multiple robots rendezvous under distributed controllers cortés et al 2006 lin et al 2003 roza et al 2014 park and hutchinson 2014 gulzar et al 2018 presented a review of consensus problems in multi agent coordination systems the authors of yu et al 2008 zheng and sun 2014 kriegleder et al 2015 zhao and zheng 2017 presented rendezvous controllers to achieve rendezvous of multiple robots based on bearings only measurements the authors of ando et al 1999b park and hutchinson 2016 jadbabaie et al 2003 presented the rendezvous controller based on proximity sensors providing bearing range measurements the rendezvous controller in ando et al 1999b works by making a robot move towards the center of the smallest circle enclosing the robots visible from the robot however ando et al 1999b considered a two dimensional environment and did not consider the power consumption of every robot hence a robot under power constraint cannot achieve rendezvous using ando et al 1999b the authors of de hoog et al 2010 used a tree structure for multi robot exploration while maintaining communication links between robots also mukherjee and ghose 2016 utilized a hierarchical tree structure to perform cyclic pursuit rendezvous of multiple robots this paper also uses a tree structure for efficient rendezvous of multiple underwater robots to the best of our knowledge this paper is novel in considering the power consumption of each robot during the distributed rendezvous task in this paper the rendezvous points are selected among the initial positions of spherical robots the rendezvous robots indicate spherical robots located at the rendezvous points this paper proposes how to select the rendezvous robots considering the power consumption of every robot then distributed control laws are developed to enable rendezvous of multiple spherical underwater robots with limited power we prove that under the proposed controllers every spherical robot is always connected to its associated rendezvous robot moreover each robot s path is generated to assure collision avoidance matlab simulations are utilized to demonstrate the effectiveness of our distributed rendezvous controller in 3 d cluttered environments section 2 introduces preliminary information of this paper section 3 3 introduces our distributed rendezvous control laws to make all underwater robots meet at rendezvous robots which are selected considering the power consumption of every robot section 4 demonstrates simulation results of our distributed controllers section 5 provides conclusions 2 background this section reviews background information that is needed for the proposed rendezvous control 2 1 rigid body dynamics we introduce several definitions which are utilized in rigid body dynamics fossen 1994 this manuscript utilizes two reference frames an inertial reference frame i and a body fixed reference frame b fossen 1994 the origin of i is an appropriate location with the axes pointing north east and down respectively the b frame is fixed to a robot and acts as the moving frame the origin of b frame is at the center of gravity of the robot the b frame has three orthogonal axes r o l l a x i s p i t c h a x i s and y a w a x i s these three axes are aligned along the principal directions for the body φ θ ψ denote euler roll angle euler pitch angle and euler yaw angle in b frame φ θ ψ are utilized to set a 3 d body in any orientation let c η denote cos η also let s η denote sin η let t η denote tan η the counterclockwise rotation of ψ euler yaw angle about y a w a x i s in b frame is represented by the following rotation matrix r ψ 1 r ψ c ψ s ψ 0 s ψ c ψ 0 0 0 1 the counterclockwise rotation of θ euler pitch angle about p i t c h a x i s in b frame is represented by the following rotation matrix r θ 2 r θ c θ 0 s θ 0 1 0 s θ 0 c θ the counterclockwise rotation of φ euler roll angle about r o l l a x i s in b frame is represented by the following rotation matrix r φ 3 r φ 1 0 0 0 c φ s φ 0 s φ c φ a rotation matrix can be formed by multiplying the yaw pitch and roll rotation matrices to obtain 4 r ψ θ φ r ψ r θ r φ 2 2 graph theory we introduce several concepts on graph theory a tree graph is rooted if one node has been set as the root in a rooted tree the parent of a node u is the node connected to it on the path to the root a child of a node u is a node of which u is the parent we use p u to represent the parent node of u also we use c u to represent a child node of u a descendant of a node u is any node which is either the child of u or is recursively the descendant of any of the children of u an ancestor of a node u is any node which is either the parent of u or is recursively the ancestor of the parent of u a leaf in a tree is a node with no child 2 3 assumptions and definitions we introduce assumptions and definitions in this paper there are n robots in total each robot u i where i 1 2 n has its associated power level thus can meet a rendezvous robot which is reachable while consuming its power let l i denote the power level of u i we further introduce the adjacency graph a v a e a in which every node in v a represents a robot a is an undirected graph and it is assumed that a is connected initially every edge say u i u j e a indicates that u i and u j can sense each other using local sensors such that the line of sight between the two robots is not blocked by an obstacle hence as a robot moves along an edge in a it does not collide with an obstacle u i u j e a implies that u i and u j are neighbors to each other u i u j is identical to u j u i since a is an undirected graph each edge say u i u j e a is weighted by w i j which is the distance between u i and u j the distance information between two neighboring robots is available using local sensors of the robots s r denotes the maximum sensing range of a robot thus w i j s r for all i j 1 2 n let d a denote the diameter of a which is defined as 5 d a m a x u v v a d u v here d u v is a hop distance between two nodes u and v in v a in other words a graph s diameter is the largest number of nodes which must be traversed in order to travel from one node to another let u i denote the location of a robot u i where i 1 2 n this paper considers a robot in 3 d environments u i represents the 3 d position of u i in the cartesian coordinate systems let u i k denote u i at time step k in discrete time systems the speed of u i is s this implies that we consider a robot maneuvering with a constant speed let h i k denote the heading vector of u i at time step k we have h i k 1 t denotes the sampling interval in discrete time systems as the motion model of a robot we use 6 u i k 1 u i k h i k t s this simple motion model is commonly used in the literature on robotics kim 2019a 2019c we next explain the power consumption of a robot moving with a constant speed consider the case where a robot moves along a path composed of multiple line segments after a robot moves along a line segment then it makes a turn followed by moving along the next line segment by adopting a streamlined spherical shape design in suarez fernandezparra et al 1906 attitude motions can be made in place while obtaining high stability along with a zero degree turn radius for high maneuverability we assume that the power consumption of a robot is proportional to the travel length of the robot this assumption is reasonable since a robot moves with a constant speed let u n i t p denote the power consumption as a robot moves along a unit length line also the robot consumes its power as it makes a turn at the end of a line segment we assume that a robot s power consumption while turning is less than a certain constant say t u r n p for instance consider the case where a robot u i moves along a path composed of d line segments moreover the total length of the path is l s then u i can move along the path without consuming all its power in the case where 7 l i l s u n i t p d 1 t u r n p is met let p a t h l e n a u i u j denote the shortest path length between two nodes u i v a and u j v a according to the definition of a graph diameter a shortest path between any two nodes in a graph a has less than d a nodes along its path this implies that the path is composed of multiple line segments such that the total number of line segments is less than d a using 7 u i can move along a shortest path to reach another node u j in the case where 8 l i p a t h l e n a u i u j u n i t p d a 1 t u r n p is met if 8 is met then we say that u i can reach u j while not consuming all its power if 8 is not met then we say that u i cannot reach u j due to power limits a depleted robot is a robot which does not have enough power to reach its neighbor in other words a depleted robot is a robot u i which satisfies that 9 l i m i n u j n i p a t h l e n a u i u j u n i t p here n i denotes the set of neighbors of u i that are sensed by u i every depleted robot must be set as a rendezvous robot as presented in algorithm 3 this is due to the fact that a depleted robot does not have enough power to reach any of its neighbor robot 3 distributed rendezvous controllers first the adjacency graph a is built in a distributed manner such that each robot shares information with its neighbor robots how to build a in a distributed manner is presented in section 3 1 then rendezvous robots are selected based on both a and l i where i 1 2 n thereafter rendezvous control in section 3 3 is applied to make all robots rendezvous at the selected rendezvous robots 3 1 build the adjacency graph in a distributed manner first the adjacency graph a is built in a distributed manner using algorithm 1 in algorithm 1 c indicates the iteration step which is initialized as 0 and increases by one at each loop let q i c be defined as the set of edges detected by u i at iteration step c of algorithm 1 at iteration step 0 u i builds q i 0 by sensing its neighbors n i using its local sensors as an example of algorithm1 one considers a graph with three edges u 1 u 2 u 2 u 3 and u 1 u 3 then each robot u i builds q i 0 as follows q 1 0 u 1 u 2 u 1 u 3 q 2 0 u 2 u 1 u 2 u 3 q 3 0 u 3 u 1 u 3 u 2 in algorithm 1 q i c q i c 1 is used here represents the set subtraction operator q i c q i c 1 is the set of edges which are in q i c but not in q i c 1 also q i c q j c is used in algorithm1 represents the set union operator q i c q j c is the set of edges which are in q i c or in q j c algorithm 1 was inspired by the consensus algorithms in alonso mora et al 2016 algorithm 1 distributed algorithm of u i for constructing the adjacency graph a image 1 we say that q i converges at an iteration step say c in the case where q i c q i c for all c c for any i 1 2 n q i converges in a maximum of d a iterations in other words c d a this convergence threshold is proved in the proposition 1 of alonso mora et al 2016 hence this work omits the proof 3 2 rendezvous robot selection once a is built in a distributed manner then rendezvous robots are selected based on both a and l i where i n we first consider the case of selecting only one rendezvous robot we propose how to select one rendezvous robot considering the power consumption of every robot algorithm 2 presents our selection method in detail algorithm 2 rendezvous robot selection image 2 we explain algorithm 2 in detail a robot with low power cannot move a long distance this implies that it is desirable to select the rendezvous robot as a robot with low power hence algorithm 2 selects the robot with the lowest power and checks if it is feasible to set the robot as the rendezvous robot in algorithm 2 suppose that l j is the smallest element in l s e t suppose that u k cannot reach u j due to the power limit of u k l k l j since l j is the smallest element in l s e t this case u j cannot reach u k since u k cannot reach u j and l k l j thus u k cannot be selected as a rendezvous robot hence u k is in r e m o v e s e t suppose that we cannot select a single rendezvous robot satisfying the power constraints under algorithm 2 in this case algorithm 3 is used to select multiple rendezvous robots satisfying the power constraints algorithm 3 multiple rendezvous robots selection image 3 algorithm 3 increases the number of rendezvous robots gradually until we find rendezvous robots satisfying the power constraints we explain algorithm 3 in detail a depleted robot cannot maneuver to reach its neighbor thus all depleted robots are set as rendezvous robots initially a robot with low power cannot move a long distance this implies that it is desirable to select the rendezvous robots as robots with low power hence algorithm 3 iteratively selects the set of robots with low power and checks if it is feasible to select the robots in the set as the rendezvous robots in algorithm 3 s e t d e p denotes a robot set composed of depleted robots let l s e t l 1 l 2 l n l d e p is the subset of l s e t such that each element in l d e p is associated to a robot in s e t d e p for instance if l d e p is l 3 l 5 then s e t d e p is u 3 u 5 in algorithm 3 l m o v e denotes the subset of l s e t such that each element in l m o v e is not associated to a robot in s e t d e p in algorithm 3 k is a integer variable which increases from 1 to l m o v e in this algorithm k combinations of l m o v e are formed in mathematics a combination is a selection of items from a collection such that the order of selection does not matter a k combination of l m o v e is a subset of k distinct elements of l m o v e the number of k combinations is equal to the binomial coefficient 10 c l m o v e k l m o v e l m o v e 1 l m o v e k 1 k k 1 1 in algorithm 3 l s u b s e t is a set of sets for instance consider the case where k 2 and s e t d e p is an empty set this case l s u b s e t is initialized as l 1 l 2 l 1 l 3 l n 1 l n there are c n 2 sets in this l s u b s e t suppose that k 2 and that s e t d e p is an empty set then s e t s in algorithm 3 has two elements if s e t s l 1 l n then s e t r u 1 d m since u i is associated to l i and s e t d e p is empty if every robot can reach a depleted robot while not consuming all its power then algorithm 3 is done in this algorithm s e t r e n d z is the set of rendezvous robots satisfying the power constraints the computational load of algorithm 3 is analyzed in the worst case algorithm 3 proceeds from k 1 to k l m o v e as k 1 algorithm 3 examines c l m o v e 1 cases also as k 2 algorithm 3 examines c l m o v e 2 cases by iterating this until k l m o v e algorithm 3 examines cases in total this implies that the computational load of algorithm 3 increases proportional to 2 l m o v e however as long as every robot has some power for its maneuver the rendezvous robots can be found before k reaches l m o v e 11 c l m o v e 1 c l m o v e 2 c l m o v e 3 c l m o v e l m o v e 3 3 distributed rendezvous control suppose that rendezvous robots s e t r e n d z are selected based on both a and l i where i n thereafter rendezvous control in this subsection is utilized to make all robots rendezvous at the selected rendezvous robots let s e t r e n d z denote the number of rendezvous robots in s e t r e n d z let d m where m 1 2 s e t r e n d z denote every robot in s e t r e n d z let r u i s e t r e n d z denote the rendezvous robot assigned to a robot u i since our goal is making all robots meet at rendezvous robots while considering limited power we assign each robot u i a rendezvous robot r u i s e t r e n d z as follows 12 r u i a r g m i n d m s e t r e n d z d a u i d m here d a u i u j presents the shortest path distance between u i and u j in a d a u i u j can be derived under dijkstra s algorithm lavalle 2006 all robots in v a are grouped to build s e t r e n d z sub graphs a m v m e m a in which every sub graph contains nodes which meet the following condition 13 u i v m r u i d m u i v a since a m is connected a shortest path tree t m a m whose root is d m can be constructed note that a m is constructed only at time step 0 under algorithm1 let p a t h 0 u i d m denote the shortest path from a robot u i v m to d m at time step 0 under this definition t m at time step 0 contains p a t h 0 u i d m note that a tree t m cannot intersect with another tree say t m on the contrary suppose that t m intersects t m at a node say u s this case 12 leads to 14 d a u s d m d a u s d m m i n d s e t r e n d z d a u s d this case rarely happens using numerical calculation of a shortest path distance since a shortest path distance is a real positive value with double type in c programming we can avoid this case by slightly perturbing the position of u s we next discuss a rendezvous control enabling every robot in t m to meet at d m algorithm 4 presents the process we explain algorithm 4 each robot in t m tracks the shortest path to d m in other words every robot in t m keeps visiting its ancestors in t m until meeting d m a non leaf robot u initiates heading towards p u only after u meets all its children after u meets p u u accesses the id of p p u thereafter u heads towards p p u we iterate this until u meets d m consider the case where u is a leaf with no children this case u initiates heading towards p u at time step 0 after u meets p u u accesses the id of p p u thereafter u heads towards p p u we iterate this until u meets d m algorithm 4 distributed rendezvous controllers for the shortest path tree t m image 4 in algorithm 4 every robot say u in t m stores the following data the id of its parent in t m and the id of its every child the id of p u in t m is utilized to make u follow p a t h 0 u d m see algorithm 4 the id of c u is utilized to make u detect a situation in which all c u have met u see algorithm 4 algorithm 4 can handle the faulty case where an interaction communication link is suddenly broken suppose that this faulty case occurs at time step k then we reset the time step to 0 and re run algorithm1 to build a new shortest path tree t then using algorithm 3 and 13 we build t m where m 1 2 s e t r e n d z we re run algorithm 4 based on the newly constructed t m we next prove that algorithm 4 is distributed moreover it is proved that a robot s path under algorithm 4 assures collision avoidance it is also proved that every robot is always connected to its associated root rendezvous robot this further implies that one can preserve the network connectedness during a maneuver theorem 1 algorithm 4 is distributed every robot is always connected to its associated root rendezvous robot moreover a robot s path under algorithm 4 assures collision avoidance proof suppose that d m is the root rendezvous robot associated to a robot u j consider the case where p a t h 0 u j d m consists of a sequence of robots p 1 p 2 p 3 p e n d d m we next prove that p l l 1 2 e n d 1 initiates following the shortest path to d m only after u j meets p l a non leaf robot initiates maneuvering only after meeting all its children in t m moreover p a t h 0 c u j d m contains p a t h 0 u j d m hence a robot tracks the path that was tracked by its child under deduction a robot tracks the path that was tracked by its descendant every robot on p a t h 0 u j d m is an ancestor of u j hence p l l 1 2 e n d 1 tracks the path that was already tracked by u j in other words p l initiates following the shortest path to d m only after p l meets u j in the case where u j just meets p l u j can sense p l 1 by utilizing local sensors since u j s maneuver is based on local sensors algorithm 4 is distributed we next prove that every robot is connected to its associated root rendezvous robot while it moves consider the case in which u j just meets p l l 1 2 e n d 1 and heads towards p l 1 this case u j can interact with p l 1 every robot in p l 1 p l 2 p l 3 p e n d d m does not move in this case this implies that p l 1 is connected to d m since u j is connected to p l 1 and p l 1 is connected to d m u j is also connected to d m hence every robot is connected to its associated root rendezvous robot we next prove that a robot s path under algorithm 4 assures collision avoidance p a t h 0 u j d m is a collision free path for u j since p a t h 0 u j d m t m a m a and a is a collision free graph according to its definition theorem 1 proved that a robot s path under algorithm 4 assures collision avoidance however we need to make a robot avoid colliding with another moving robot we can use local collision avoidance approach in kim 2019c to avoid collision between moving robots 3 4 local heading controller recall that under the rendezvous control a spherical robot tracks the shortest path until reaching its associated rendezvous robot suppose that the designated rendezvous robot of u i is d m let p denote the shortest path of u i to reach its associated rendezvous robot d m suppose that p consists of a sequence of robots p 1 p 2 p 3 p e n d d m let p j denote the location of p j for convenience suppose that u i visited p j and the next point to visit is p j 1 we present the local controller to make u i head towards p j 1 the heading direction of u i is controlled while maintaining its speed the heading of u i in 6 is controlled under 15 h i k p j 1 u i k p j 1 u i k this implies that u i maneuvers towards p j 1 we next search for the orientation of the body ψ θ and φ associated to h i k recall that ψ θ and φ appear in section 2 1 since we do not consider the rolling of the robot s body we set φ as zero let c i represent the i th element in a column matrix c for convenience we have h i k 1 c ψ c θ h i k 2 s ψ c θ 16 h i k 3 s θ thus we get 17 θ a t a n 2 h i k 3 q d here q d h i k 1 2 h i k 2 2 in the case where c θ 0 we get 18 ψ a t a n 2 h i k 2 h i k 1 in the case where c θ 0 we get 19 ψ a t a n 2 h i k 2 h i k 1 suarez fernandezparra et al 1906 presented how to control the pitch of a spherical robot so that it converges to a designated pitch θ also suarez fernandezparra et al 1906 presented how to control the yaw of a spherical robot so that it converges to a designated yaw ψ using the attitude control of suarez fernandezparra et al 1906 we can make the robot head towards p j 1 once u i meets p j 1 then u i maneuvers towards the next waypoint p j 2 this local control is feasible based on proximity sensors of u i we do not require global localization of a robot for this local control 4 simulation results this section presents the matlab simulation results to verify our distributed rendezvous control the simulation settings are as follows we use 50 robots in total the sampling interval is t 0 1 seconds moreover the speed of each robot is s 0 1 distance units per second the maximum sensing range is set as s r 5 distance units we set u n i t p 1 and t u r n p 0 01 4 1 scenario 1 fig 1 shows the maneuver of each robot under our distributed rendezvous control under algorithm 2 one rendezvous robot is set considering the power limit of every robot the initial position of every robot is marked with red asterisks each robot s trajectory is depicted with green circles 3 d obstacles are depicted with spheres fig 2 shows the final position of every robot under our distributed rendezvous control see that every robot converged to the rendezvous robot green circle all robots spend 234 s to rendezvous at the designated rendezvous robot whose coordinate is 28 4563 76 0727 79 3138 fig 3 shows the power consumption of each robot compared to the power limit l i of every robot the x axis presents the robot index the y axis presents the distance traveled by each robot u 41 is set as the rendezvous robot thus the travel distance of u 41 is zero see that the rendezvous robot is set considering the power limit of every robot 4 2 scenario 2 fig 4 shows the maneuver of each robot under our distributed rendezvous control the initial position of every robot is marked with red asterisks each robot s trajectory is depicted with green circles 3 d obstacles are depicted with spheres under algorithm 3 two rendezvous robots are set considering the power limit of every robot fig 5 shows the final position of every robot under our distributed rendezvous control see that every robot converged to one of two rendezvous robots two green circles in the figure all robots spend 174 s to rendezvous at two rendezvous robots whose coordinates are 69 7249 50 0149 69 0007 and 151 4546 109 3384 71 4776 respectively since two rendezvous robots are selected the rendezvous task is achieved faster than the case where only one rendezvous robot is selected fig 6 shows the power consumption of each robot compared to the power limit l i of every robot u 1 and u 29 are set as two rendezvous robots thus the travel distance of each of these two robots is zero see that the rendezvous robots are set considering the power limit of every robot 5 conclusions this paper considers a scenario where every underwater robot is initially distributed in 3 d gps denied environments with many obstacles we develop distributed rendezvous control laws for multiple constant speed robots considering power limits this paper proposes how to select the rendezvous robots considering the power consumption then multiple underwater robots meet at the selected rendezvous robots while maintaining network connectivity matlab simulations are utilized to verify the effectiveness of the proposed approach in 3 d cluttered environments the proposed approach can be applied in 2 d environments as well as in 3 d environments in 2 d environments the motion of every robot is constrained on a 2 d plane then we can build 2 d tree graphs rooted at rendezvous robots in the plane each robot traverses its associated tree graph until the rendezvous is achieved declaration of competing interest the author has no competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was funded by hongik university sejong city south korea 
22072,a potential based boundary element method for the hydrodynamic analysis of a two dimensional 2 d steady surface flow passing over two foils is described a vortex sheet is placed within each foil to produce the desired circulations the total potential is decomposed into three parts consisting of the potential of the incoming flow the disturbed potential from sources and the disturbed potential caused by the vortex sheets the boundary integral equation and two complementary equations derived from the kutta condition at the trailing edge of each foil are placed in the same numerical matrix and solved together to obtain the potential on the foil as well as the vortex strengths extensive convergence studies are then performed the interactions between the foils are then discussed the free surface effect on the hydrodynamics are quantitatively reported the numerical results showed that the free surface greatly affected the lift and drag of the foils and at a proper relative location the wave excitation was diminished due to the interaction between the foils keywords foils potential flow theory boundary element method vortex sheet nomenclature u velocity of the uniform flow c chord length of foils d distance of foils in the direction of x d dimensionless form of d a length of vortex sheet f r froude number s the infinite boundary τ unit tangential vector of boundary ϕ potential disturbed by the sources v the induced velocity of vortex sheets η position of the free surface λ solid angle of the body surface n number of the elements on s n b number of the elements on s b r j position vector of the j th element f the shape function κ i j dirac function c l lifting coefficient ζ smallest size of all elements γ vortex strengths per unit length α angle of attack of foil l distance of foils in the direction of y l dimensionless form of l s b boundary of foils s f boundary of free surface n unit normal vector of boundary φ total potential φ potential disturbed by vortex sheets p pressure h submergence of the foils r p q distance between p and q n f number of the elements on s f c p pressure coefficient s length of element ε the local intrinsic coordinate w induced velocity of unit strength vortex sheet c i j intermediate variable in eq 13 b i j intermediate variable in eq 13 c d dragging coefficient μ scale for controlling element size 1 introduction the investigation of the steady potential flow past hydrofoils or aerofoils has been a classic problem in hydrodynamics and aerodynamics and has been the subject of many studies the potential flow past a single foil with a free surface effect has been adequately understood in this study the more challenging problem of the free surface effect on the interference between two foils is investigated a popular tool used to simulate the 2 d potential flow problem is the boundary element method which was first used in the work of hess and smith 1966 numerical computations of the 2 d potential flow around a single hydrofoil using the boundary element method have been well developed kinnas and fine 1993 as the calculation capability of computers has progressed there has been a trend toward the development of codes that can handle the problems of 3d geometries kerwin 1986 hess 1990 additionally a number of variations of the steady and unbounded flow problems of hydrofoils have attracted much attention such as the problems of a free surface bal 1998 karim et al 2013 cavitation li et al 2010 karim and ahmmed 2012 viscous effects agrawal and saxena 2013 oscillatory motion xu and wu 2013 and ground effects ahmed 2005 normally when using the boundary element method to solve a potential foil problem there is assumed to be a wake sheet that detaches from the trailing edge into infinity that follows the undisturbed flow the wake model causes no problem for a single foil because the shape of the wake actually does not affect the solution however for multiple foils it is very difficult to model the multiple wakes due to the interaction between the foils especially when one of the foils lies on the path of the wake sheet of the other one this makes effective modeling of the wakes using a time marching scheme too difficult to be applied in multi foils cases with free surface effect xu and wu 2013 in this study the circulations are represented by vortex sheets placed within the foil boundaries the modeling of the initial vortex shedding due to the foil advancing and the simulation of complicated vortex body interaction can be avoided thus the present problem is only time dependent on the wave formation and propagation these make the present method robust and time efficient while accounting for the hydrodynamic coupling that occurs between two arbitrarily shaped foils in this model the flow passes over two stationary foils furthermore proper boundary conditions are imposed on the infinite boundaries and the assumption is made that the steady flow is reached at the initial time step thus complicated and difficult vortex modeling due to the sudden start of the foils can be avoided when two foils are located near the free surface a strong free surface effect will affect their hydrodynamic interaction however a majority of the relevant studies are concerned with the free surface effect on a single foil green and street 1967 analyzed the performance of a 2 d hydrofoil with a free surface where the flow was assumed to be incompressible irrotational and linearized hough and moran 1969 studied 2 d hydrofoil flow with a free surface and discovered the effect of the froude number daskovsky 2000 presented a numerical simulation of a hydrofoil with a free surface based on the biplane image theory and the horseshoe vortex model recently faltinsen and semenov 2008 solved the nonlinear potential flow motion of a hydrofoil by employing the conformal mapping technique liang et al 2013 studied the hydrodynamic performance of a 3 d hydrofoil with winglets based on the lifting surface method they found that the hydrodynamic load and thickness of the hydrofoil were represented by horseshoe vortexes and sources respectively dawson 1977 studied double body flow under a free surface using dawson s method the free surface was simplified as linear and the free surface equation was discretized using a four point upstream finite difference scheme in this study vortex sheets are placed within the foil boundaries to produce the desired circulations the total potential is decomposed into the potential of the uniform flow the potential of the non circulation flow and the potential of the circulatory flow giesing and smith 1967 have talked about the idea of producing circulation using a point vortex and using the boundary element method to solve the potential flow problem of multiple bodies with free surfaces williams 1971 has also mentioned the idea and they used the conformal mapping technique to solve the potential problem of two circular foils the main difference between the present work and the work of giesing and smith 1967 and williams 1971 is that the vortex strengths are explicitly implanted into the boundary integral equations as part of the unknowns the vortex strengths together with the non circulation potential induced by the sources distributed on the foil boundaries are obtained in this manner in addition the forces and pressure distribution on the foils are obtained then the profiles of the free surface of the two submerged foils are simulated factors that affect the hydrodynamic performance are then discussed such as the relative positions and angles of attack on the foils 2 mathematical formulations consider a steady uniform flow with velocity u past two foils as shown in fig 1 in the configuration the foil on the upper or left side is defined as foil a and the other as foil b foil a and b have the same chord length a cartesian coordinate system o x y fixed in the space is defined where x is in the direction of u and y points upwards the origin o coincides with the chord center of foil a within each foil there is a vortex sheet along the chord line the vortex strengths per unit length are assumed to be uniform along the vortex sheets and are denoted as γ 1 and γ 2 respectively the chord length of foil a is denoted as c the angle of attack of foil a is denoted as α 1 and that of foil b as α 2 the distances between two foils are defined as d and l in the direction of x and y respectively d and l are normalized as d d c and l l c the length of the vortex sheet within foil a and foil b are normalized using c as a 1 and a 2 respectively the median centers of the vortex sheets coincide with the chord centers of the corresponding foils the boundaries of foils are denoted as s b the far field boundary as s and the free surface as s f the unit normal and tangential vector are denoted as n and τ 2 1 governing equation and boundary conditions the fluid is assumed to be incompressible and inviscid and the flow to be irrotational based on potential flow theory the non lifting bodies can be represented by a distribution of sources on their boundaries however for lifting foils there must be circulations in the numerical model to generate lifts as shown in fig 1 two vortex sheets are placed within the foil boundaries to produce the desired circulation thus the total potential φ can be decomposed as the potential u x of the uniform flow the potential ϕ of the non circulation flow disturbed by the sources and the potential φ of the circulatory flow disturbed by the vortex sheets therefore 1 φ u x ϕ φ φ γ 1 φ 1 γ 2 φ 2 where and are the potential caused by unit strength vortex sheets placed in foil a and b respectively φ 1 1 2 π a 1 2 a 1 2 arg r i r d l φ 2 1 2 π a 2 2 a 2 2 arg r i r d l as ϕ is continuous over the fluid domain it satisfies laplace s equation that is 2 2 ϕ 0 the impermeable body boundary condition should be satisfied on s b thus 3 φ n 0 substituting equation 1 into equation 3 we obtain 4 ϕ n u i φ n where i is the unit vector in the x direction and v φ is the induced velocity of the vortex sheets it is assumed that the velocity disturbed by the vortex sheet vanishes far away thus 5 φ 0 x 2 y 2 the kutta condition equation 6 should be satisfied at the trailing edge 6 p t e u p p p t e l o w where the superscripts u p p l o w are used to denote the wake s upper and lower side respectively the kinematic and dynamic boundary conditions should be satisfied on the instantaneous free surface y η x t such that 7 η t φ y φ x η x 8 φ t 1 2 φ φ g η h 1 2 u 2 2 2 boundary element method on the integral equation the governing equation 1 can be converted using green s identity into the following integral equation over the boundaries of the fluid domain 9 λ p ϕ p ϕ q n q ln r p q ln r p q ϕ q n q d s where λ p is the solid angle of the body surface at point p r p q is the distance between points p and q n q is the unit normal at point q and s represents the boundaries of the foils to solve equation 9 numerically the surfaces s s f and s b are discretized using n n f and n b line elements respectively in an anti clockwise direction the elements are arranged by utilizing a cosine spacing that concentrates more panels at the leading and trailing edges of the foils the coordinate of the j th node is denoted as r j x j y j the length and unit normal of the j th element are denoted as s j and n j respectively the continuous potential ϕ is assumed to be linearly distributed over each element the position vector and potential at any point on the j th element can be written as follows 10 r q f 1 ε r j f 2 ε r j 1 11 ϕ q f 1 ε ϕ j f 2 ε ϕ j 1 where ϕ j and ϕ j 1 are the potential at the nodes j and j 1 respectively and 1 ε 1 is the local intrinsic coordinate the shape functions f 1 and f 2 are defined as 12 f 1 ε 1 ε 2 f 2 ε 1 ε 2 selecting the node p i x i y i as the control points equation 9 can be discretized as follows 13 j 1 n b n n f κ i j c i j ϕ j j 1 n b n n f b i j ϕ j n i 1 n b n n f equation 13 can be transformed into 14 j 1 n b n κ i j c i j ϕ j j n b n 1 n b n n f b i j ϕ j n j 1 n b v j n j j n b n 1 n b n n f c i j κ i j ϕ j j n b 1 n b n b i j u i n j i 1 n b n n f where 15 v j w j a γ 1 w j b γ 2 16 κ i j λ i i j 0 i j 17 c i j s j 2 1 1 f 2 ε n j ln r i j d ε s j 1 2 1 1 f 1 ε n j 1 ln r i j 1 d ε and 18 b i j s j 2 1 1 f 2 ε ln r i j d ε s j 1 2 1 1 f 1 ε ln r i j 1 d ε in equations 17 and 18 19 r i j 1 ε 2 x j 1 ε 2 x j 1 x i 2 1 ε 2 y j 1 ε 2 y j 1 y i 2 in equation 15 w a is the induced velocity of the vortex sheet with unit strength in foil a and w b is the induced velocity of the vortex sheet in foil b with unit strength w a and w b can be expressed as follows 20 w j a 1 2 π r a r j d r a 21 w j b 1 2 π r b r j d r b where r a is the position vector of a point on foil a and r b is the position vector of a point on foil b using equation 14 a n f n b n th algebraic matrix equation is built obviously there are n f n b n equations but n f n b n 2 unknowns that are potentials ϕ at all the n f n b n nodes as well as the vortex strength γ 1 and γ 2 thus two additional equations are needed to enclose equation 14 2 3 the kutta condition and hydrodynamic force on the foils in this study the kutta condition is presented as the continuity of the tangential velocity at the trailing edges of the foils thus at the trailing edges the following equation holds 22 φ u τ u φ l τ l by combining equations 1 15 and 22 at the trailing edge of foil a the following equations are obtained 23 w 1 a τ 1 τ n b a γ 1 w 1 b τ 1 τ n b a γ 2 ϕ 1 1 s 1 1 s n b a ϕ 2 s 1 ϕ n b a s n b a u τ 1 τ n b a where n b a is the element number over foil a at the trailing edge of foil b the following equations are obtained 24 w n b a 1 a τ n b a 1 τ n b γ 1 w n b a 1 b τ n b a 1 τ n b γ 2 ϕ n b a 1 1 s n b a 1 1 s n b ϕ n b a 2 s n b a 1 ϕ n b s n b u τ n b a 1 τ n b by combining equations 14 23 and 24 an enclosed n f n b n 2 th algebraic matrix equation for the velocity potential and vortex strength is obtained by solving the integral equation the potentials and vortex sheet strengths are obtained then the kinetic free surface condition in equation 8 and dynamic free surface condition in equation 7 can be used to update the free surface with time marching 25 η t δ t η t φ y φ x η x δ t 26 φ t δ t u 2 2 1 2 φ 2 g η h φ y φ x η x φ y δ t φ t substituting the components of the total potential φ in equation 1 into equations 25 and 26 equations 27 and 28 can be obtained in which the wave elevation is directly correlated to the vortex sheet strengths and the disturbed potential 27 η t δ t η t ϕ y γ 1 φ 1 y γ 2 φ 2 y u ϕ x γ 1 φ 1 x γ 2 φ 2 x η x δ t 28 ϕ t δ t ϕ t u 2 2 1 2 u x ϕ γ 1 φ 1 γ 2 φ 2 2 g η h η t ϕ y γ 1 φ 1 y γ 2 φ 2 y δ t where η t can be obtained by equation 27 and φ 1 and φ 2 are the potentials caused by unit strength vortex sheets placed in foil a and b respectively by bernoulli s theorem the pressure coefficient c p over the foil boundaries can be calculated using 29 c p 1 φ τ 2 u 2 the total lifting coefficient of the foils is 30 c l c l 1 c l 2 31 c d c d 1 c d 2 where c l 1 and c l 2 are the lifting coefficients of foil a and foil b respectively and c d 1 and c d 2 are the dragging coefficients of foil a and foil b respectively c l 1 c l 2 c d 1 and c d 2 can be obtained by performing the following integrations 32 c l 1 1 c s a c p n y d l c l 2 1 c s b c p n y d l c d 1 1 c s a c p n x d l c d 2 1 c s b c p n x d l 3 discussion of the present method without the free surface the hydrodynamic performance of two arbitrarily arranged identical naca 0012 foils in the fluid domain were analyzed using the numerical procedure found in section 2 in this section convergence studies with respect to the element number and length of vortex sheet are performed the normalized coordinate of the chord center of foil b is d 0 4 and l 0 3 fig 2 shows the results of the lifting coefficients c l 1 c l 2 and c d 1 c d 2 at different element numbers the element number over foil a n b a is equal to the element number over foil b n b b it can be seen in fig 2 that the results gradually tend to be constant as the element number increases this implies that the present method is convergent with respect to the element number to accurately predict the forces and pressure distribution of the foils the element numbers were chosen to be n b a 260 and n b b 260 in the sections below in this method two vortex sheets were used to generate the desired circulations of the foils thus it was necessary to perform the convergence studies with respect to the lengths of the vortex sheets and these are presented in fig 3 in fig 3 h c is kept constant as 0 6 while c l 1 changes from 0 01 to 0 98 from fig 3 in can be seen that the pressure curves are nearly indistinguishable when the length of the vortex sheet is larger than 0 01 which implies that the model is convergent with respect to the sheet lengths however it should be noticed that when the vortex length decreases to 0 01 a local pressure peak emerges see the squared area in fig 3 a when sheet length increases to 0 98 the result slightly deviates from that at other sheet lengths see fig 3 a this indicates that the length of the vortex sheet should not be extremely short or long in the numerical model however the convergence scope is at least from 0 01 to 0 98 which is already rather extensive based on the convergence study regarding the length of the vortex sheet the lengths of the vortex sheets were chosen to be a 1 0 6 and a 2 0 6 4 validation of the model there is no experimental data available to validate the numerical results of the model for the steady surface flow passing two foils therefore some slightly simpler cases were used for model validation fig 4 a shows the non dimensional pressure distribution of naca0012 in open water this fig shows that the numerical results of this model agree very well with the experimental results additionally with regards to the free surface effect the pressure distribution agrees very well with that found by park et al 2009 which is shown in fig 4 b to optimize the element number on the free surface the elements size over the free surface increases gradually from the center to left and right boundary as demonstrated in equation 33 33 x i 1 x i ζ μ i k where x is the coordinate of the element the subscript i and i 1 are nodes of the element ζ is the smallest size of all the elements μ is the scale to control the element size and k is used to adjust the elements intensity along the free surface to validate the convergence of the numerical results of the model with respect to the element size simulations were performed as ζ changed from 0 03 to 0 07 while all the other factors were kept constant as α 1 α 2 5 o h c 1 2857 and f r 0 567 the normalized coordinate of the chord center of foil b was d 0 and l 0 2 the variation in wave heights and lengths with respect to ζ are shown in table 1 from which it can be seen the wave heights and lengths are very close to each other when ζ 0 05 and ζ 0 03 the pressure coefficients of the foils are shown in fig 5 from both fig 5 and table 1 the convergence of the numerical results of the model with respect to ζ can be validated the convergence histories of the lifting coefficients and vortex strengths with respect to time are shown in fig 6 in which the time step is set to be 0 0005s because the present simulation was performed in the time domain the forces and vortex strengths fluctuated with time all of the forces and vortex strengths tended to converge to stable values as time progressed the present problem is two dimensional thus the excited free surface wave will propagate infinitely downstream disturbed by the emergence and propagation of free surface wave the foil lift will be fluctuating infinitely as time marches but the fluctuation diminishes gradually it is defined the simulation is convergent as the relative difference of average lifts between last two periods is less than 1e10 4 the different fluctuations in the lifting coefficients and vortex strengths of the two foils resulted from the united effects of the angle of attack the hydrodynamic interference and the free surface effect according to submergence depth it should be noted that the reason the free surface deformation was tracked is because it is the only factor that could cause the fluctuation this is because in this model the vortex shedding from the trailing edge of the foils was avoided the numerical results for the hydrodynamic interaction without free surface between a main foil and a flap foil by williams 1971 are used to validate present method for multi foils interferences the pressure coefficients on the main foil and the flap are shown in fig 7 fig 7 a and b show the comparison of pressure distribution as angle of attack of flap foil α 2 10 o fig 7 c and d show pressure distribution α 2 30 it can be seen that the pressure distribution by present method agrees very well with that by williams 1971 the case with two circles is also used to verify the present numerical study in this case the two circles are non lifting bodies thus there is no vortex shedding by the circles and the vortex sheets were removed from the numerical model the comparison of pressure distribution is shown in fig 8 the verification of present method on free surface elevation disturbed by a single foil is given in fig 9 as u 80 cm s c 20 3 cm α 5 o and h 26 1 cm 23 0 cm and 21 0 cm respectively generally very good agreements can be obtained between the experimental results of duncan 1983 and present results however as submergence depth decreases the wave crests are sharper by numerical simulation because fully nonlinear free surface boundary conditions are used and the fluid viscosity is neglected the wave elevations under different angle of attack and inflow velocity as h 26 1 cm are shown in fig 10 and fig 11 respectively fig 10 shows the wave elevation at different angle of attack generally the wave height increases with angle of attack but the wave length is hardly affected fig 11 shows the wave elevation at different inflow velocity which is normalized as froude number fr it can be seen that the wave profiles are significantly affected by the inflow velocity the convergence history of lift c l of naca 0012 at f r 0 567 h c 1 2857 and α 5 o with respect to time are shown in fig 12 it can be seen that as time steps are 0 0005 and 0 001 the time history of the lifting coefficient can hardly be distinguished and the convergency of the present simulation is verified 5 hydrodynamic interference between the two foils 5 1 hydrodynamic interference at different angles of attack to evaluate the interference between the two foils at different angles of attack the results of the lifting and dragging coefficients when the angle of attack of one of the foils was kept constant while the other changed was observed the location of foil b was chosen as d 0 4 and l 0 3 the lifting coefficients c l 1 and c l 2 at different angles of attack α 1 or α 2 are given in fig 13 it is well known that the lifting coefficient of a single foil varies almost linearly with the angle of attack under the potential flow assumption however for the two foils it can see from fig 13 that the lifting coefficients of both foils vary in an obviously nonlinear way when the angle of attack of one foil is kept constant while that of the other foil changes this indicates a strong hydrodynamic interference between the foils due to the interference foil b generated a positive lift although its angle of attack α 2 was kept at a negative constant of 6 o similarly foil a generated a negative lift although its angle of attack α 1 was kept at a positive constant of 6 o because foil b was located lower than foil a the free surface had a weaker effect on foil b as shown in fig 13 to show the free surface effect on the two foils clearly the hydrodynamics of the two foils without the free surface were also simulated generally the lift with the free surface effect was larger than that in open water as shown in fig 13 5 2 the interference between two vertically aligned foils fig 14 shows the variations in the lifting and dragging coefficients at φ u x ϕ φ and ϕ and with relative vertical location l of d 0 f r and h c are 1 0 and 2 0 respectively when the free surface is considered it can be seen in this fig that the lifting coefficient of foil a c l 1 increases rapidly and then this increase slows down as l increases which means the interference between the foils diminish with an increase in l and c l 2 varies in the opposite trend it is very interesting to find from fig 14 that the lifting and dragging forces on foil a are negative while those on foil b are positive this indicates that the vertical forces and horizontal forces are actually pulling the bodies together wang 2004 which might lead to a collision of the two foils it can be seen from fig 14 a that the lifting coefficients of foil a are increased by the interaction of the free surface while the lifting coefficients of foil b are decreased in addition both the dragging coefficients of a and b increase with the free surface as shown in fig 14 b the pressure distributions of the two foils at different l are shown in fig 15 as expected both the pressure coefficients on the lower surface of foil a and the upper surface of foil b change significantly when l decreases this is reasonable as the lower surface of foil a and the upper surface of foil b are relatively close and thus the interaction will be stronger the pressure over the lower surface of foil a is most sensitive to the interference of one among the four foil surfaces to explicitly show the free surface effect on the foils the pressures with and without the free surface are shown in fig 16 when l 1 it can be seen that the free surface effect decreases the pressure on the foils 5 3 the interference between two horizontally aligned foils the lifting and dragging coefficients with and without the free surface at different d when l 0 f r 0 5 h c 1 5 and α 1 α 2 5 are compared in fig 17 generally at the given submergence depth the lifting coefficients greatly increase due to the effect of the free surface while the dragging coefficients are not affected as much due to the hydrodynamic interference between the foils the lifting and dragging coefficients vary oppositely with an increase in d when d is approximately 1 3 there is an inflection point on the curve of c l 1 in open water but this is eliminated when the free surface effect is considered the pressures on foil a and b with varying d are shown in fig 18 for foil a the pressure on the lower surface increases and the pressure on the upper surface decreases when d increases also the variation corresponds well with the lifting coefficient of foil a for foil b the area enclosed by the pressure curve increases gradually when d increases this increased area causes an increase in the lifting coefficient of foil b as shown in fig 16 furthermore the pressure distributions of the two foils when d 1 5 were compared with that in open water and the results are shown in fig 19 it can be seen that the influence of the free surface effects on the pressure is primarily concentrated on the upper surface of the foils the pressure on both of the foils upper surfaces decreases under the interference of the free surface causing an incremental rise in lifting coefficients this phenomenon agrees well with the results shown in fig 16 the profiles of the free surface at different d on the two foils are shown infig 20 it can be seen that the free surface is greatly affected by the distance between the foils the first trough of the wave trains following foil a obviously descend due to the existence of foil b and this effect lessens as d increases this can partly explain why in fig 17 a the free surface effect actually becomes weaker as d increases from 1 1 to 2 5 in addition the wave trough following foil b is ascended by foil a especially at d 1 1 the different d leads to different phase angles of the wave trains of foil a and foil b thus the resultant wave train can be made stronger or weaker than that generated by a single foil generally within d 1 1 and d 2 5 the phase angle disparity is not very obvious thus the wave trains generated by the two foils are superposed and the wave is higher than that generated by a single foil especially at d 2 0 although the simulation was not performed when d was larger than 2 5 it can be expected that the wave trains would be neutralized at a certain range as d increases 5 4 the effect of submerged depth h the effect of submerged depth h on the free surface was studied when fr 1 0 d 1 1 and l 0 while h c changed from 2 to 4 it can be seen from fig 21 that as h increases the wave heights gradually decrease this means the further the distance between the foils and the free surface the smaller the effect generated by the foils acting on the free surface as h increases from 2 to 4 the wave height decreases nonlinearly from 0 46 m to 0 07 m however the wave length is not affected by the submerged depth as much at a given froude number the lifting and dragging coefficients of foils a and b are shown in fig 22 it can be seen from fig 22 that all the coefficients tend to decrease with h except c l 1 the two foils are located at the same h but the lift and drag are significantly different due to the hydrodynamic interference furthermore it can be seen from the pressure comparison shown in fig 23 that the influence of foil a on foil b is much more significant because foil b is actually located in the wake of foil a 6 conclusions in this study a numerical model was presented to simulate the hydrodynamic performance of two foils in uniform incoming flow using the boundary integral method extensive convergence studies were performed to verify this method the main novelty of this model lies in the circumvention of the iterative procedure while considering the wake sheets using the employment of two vortex sheets along the chord line and the decomposition of the total potential based on the numerical simulation the free surface effect together with the hydrodynamic interference between the foils were discussed in detail in addition the effects of the relative location and submergence depth of the two foils were also analyzed one of the interesting findings of this study is that the interaction between the foils diminished the wave excitation and improved their hydrodynamics further study will provide more insight for the design and navigation of similar marine structures acknowledgments this work is supported by the national natural science foundation of china grant nos 51579052 51679045 and national defense pre research foundation of china grant nos 6142204180408 6142407180108 
22072,a potential based boundary element method for the hydrodynamic analysis of a two dimensional 2 d steady surface flow passing over two foils is described a vortex sheet is placed within each foil to produce the desired circulations the total potential is decomposed into three parts consisting of the potential of the incoming flow the disturbed potential from sources and the disturbed potential caused by the vortex sheets the boundary integral equation and two complementary equations derived from the kutta condition at the trailing edge of each foil are placed in the same numerical matrix and solved together to obtain the potential on the foil as well as the vortex strengths extensive convergence studies are then performed the interactions between the foils are then discussed the free surface effect on the hydrodynamics are quantitatively reported the numerical results showed that the free surface greatly affected the lift and drag of the foils and at a proper relative location the wave excitation was diminished due to the interaction between the foils keywords foils potential flow theory boundary element method vortex sheet nomenclature u velocity of the uniform flow c chord length of foils d distance of foils in the direction of x d dimensionless form of d a length of vortex sheet f r froude number s the infinite boundary τ unit tangential vector of boundary ϕ potential disturbed by the sources v the induced velocity of vortex sheets η position of the free surface λ solid angle of the body surface n number of the elements on s n b number of the elements on s b r j position vector of the j th element f the shape function κ i j dirac function c l lifting coefficient ζ smallest size of all elements γ vortex strengths per unit length α angle of attack of foil l distance of foils in the direction of y l dimensionless form of l s b boundary of foils s f boundary of free surface n unit normal vector of boundary φ total potential φ potential disturbed by vortex sheets p pressure h submergence of the foils r p q distance between p and q n f number of the elements on s f c p pressure coefficient s length of element ε the local intrinsic coordinate w induced velocity of unit strength vortex sheet c i j intermediate variable in eq 13 b i j intermediate variable in eq 13 c d dragging coefficient μ scale for controlling element size 1 introduction the investigation of the steady potential flow past hydrofoils or aerofoils has been a classic problem in hydrodynamics and aerodynamics and has been the subject of many studies the potential flow past a single foil with a free surface effect has been adequately understood in this study the more challenging problem of the free surface effect on the interference between two foils is investigated a popular tool used to simulate the 2 d potential flow problem is the boundary element method which was first used in the work of hess and smith 1966 numerical computations of the 2 d potential flow around a single hydrofoil using the boundary element method have been well developed kinnas and fine 1993 as the calculation capability of computers has progressed there has been a trend toward the development of codes that can handle the problems of 3d geometries kerwin 1986 hess 1990 additionally a number of variations of the steady and unbounded flow problems of hydrofoils have attracted much attention such as the problems of a free surface bal 1998 karim et al 2013 cavitation li et al 2010 karim and ahmmed 2012 viscous effects agrawal and saxena 2013 oscillatory motion xu and wu 2013 and ground effects ahmed 2005 normally when using the boundary element method to solve a potential foil problem there is assumed to be a wake sheet that detaches from the trailing edge into infinity that follows the undisturbed flow the wake model causes no problem for a single foil because the shape of the wake actually does not affect the solution however for multiple foils it is very difficult to model the multiple wakes due to the interaction between the foils especially when one of the foils lies on the path of the wake sheet of the other one this makes effective modeling of the wakes using a time marching scheme too difficult to be applied in multi foils cases with free surface effect xu and wu 2013 in this study the circulations are represented by vortex sheets placed within the foil boundaries the modeling of the initial vortex shedding due to the foil advancing and the simulation of complicated vortex body interaction can be avoided thus the present problem is only time dependent on the wave formation and propagation these make the present method robust and time efficient while accounting for the hydrodynamic coupling that occurs between two arbitrarily shaped foils in this model the flow passes over two stationary foils furthermore proper boundary conditions are imposed on the infinite boundaries and the assumption is made that the steady flow is reached at the initial time step thus complicated and difficult vortex modeling due to the sudden start of the foils can be avoided when two foils are located near the free surface a strong free surface effect will affect their hydrodynamic interaction however a majority of the relevant studies are concerned with the free surface effect on a single foil green and street 1967 analyzed the performance of a 2 d hydrofoil with a free surface where the flow was assumed to be incompressible irrotational and linearized hough and moran 1969 studied 2 d hydrofoil flow with a free surface and discovered the effect of the froude number daskovsky 2000 presented a numerical simulation of a hydrofoil with a free surface based on the biplane image theory and the horseshoe vortex model recently faltinsen and semenov 2008 solved the nonlinear potential flow motion of a hydrofoil by employing the conformal mapping technique liang et al 2013 studied the hydrodynamic performance of a 3 d hydrofoil with winglets based on the lifting surface method they found that the hydrodynamic load and thickness of the hydrofoil were represented by horseshoe vortexes and sources respectively dawson 1977 studied double body flow under a free surface using dawson s method the free surface was simplified as linear and the free surface equation was discretized using a four point upstream finite difference scheme in this study vortex sheets are placed within the foil boundaries to produce the desired circulations the total potential is decomposed into the potential of the uniform flow the potential of the non circulation flow and the potential of the circulatory flow giesing and smith 1967 have talked about the idea of producing circulation using a point vortex and using the boundary element method to solve the potential flow problem of multiple bodies with free surfaces williams 1971 has also mentioned the idea and they used the conformal mapping technique to solve the potential problem of two circular foils the main difference between the present work and the work of giesing and smith 1967 and williams 1971 is that the vortex strengths are explicitly implanted into the boundary integral equations as part of the unknowns the vortex strengths together with the non circulation potential induced by the sources distributed on the foil boundaries are obtained in this manner in addition the forces and pressure distribution on the foils are obtained then the profiles of the free surface of the two submerged foils are simulated factors that affect the hydrodynamic performance are then discussed such as the relative positions and angles of attack on the foils 2 mathematical formulations consider a steady uniform flow with velocity u past two foils as shown in fig 1 in the configuration the foil on the upper or left side is defined as foil a and the other as foil b foil a and b have the same chord length a cartesian coordinate system o x y fixed in the space is defined where x is in the direction of u and y points upwards the origin o coincides with the chord center of foil a within each foil there is a vortex sheet along the chord line the vortex strengths per unit length are assumed to be uniform along the vortex sheets and are denoted as γ 1 and γ 2 respectively the chord length of foil a is denoted as c the angle of attack of foil a is denoted as α 1 and that of foil b as α 2 the distances between two foils are defined as d and l in the direction of x and y respectively d and l are normalized as d d c and l l c the length of the vortex sheet within foil a and foil b are normalized using c as a 1 and a 2 respectively the median centers of the vortex sheets coincide with the chord centers of the corresponding foils the boundaries of foils are denoted as s b the far field boundary as s and the free surface as s f the unit normal and tangential vector are denoted as n and τ 2 1 governing equation and boundary conditions the fluid is assumed to be incompressible and inviscid and the flow to be irrotational based on potential flow theory the non lifting bodies can be represented by a distribution of sources on their boundaries however for lifting foils there must be circulations in the numerical model to generate lifts as shown in fig 1 two vortex sheets are placed within the foil boundaries to produce the desired circulation thus the total potential φ can be decomposed as the potential u x of the uniform flow the potential ϕ of the non circulation flow disturbed by the sources and the potential φ of the circulatory flow disturbed by the vortex sheets therefore 1 φ u x ϕ φ φ γ 1 φ 1 γ 2 φ 2 where and are the potential caused by unit strength vortex sheets placed in foil a and b respectively φ 1 1 2 π a 1 2 a 1 2 arg r i r d l φ 2 1 2 π a 2 2 a 2 2 arg r i r d l as ϕ is continuous over the fluid domain it satisfies laplace s equation that is 2 2 ϕ 0 the impermeable body boundary condition should be satisfied on s b thus 3 φ n 0 substituting equation 1 into equation 3 we obtain 4 ϕ n u i φ n where i is the unit vector in the x direction and v φ is the induced velocity of the vortex sheets it is assumed that the velocity disturbed by the vortex sheet vanishes far away thus 5 φ 0 x 2 y 2 the kutta condition equation 6 should be satisfied at the trailing edge 6 p t e u p p p t e l o w where the superscripts u p p l o w are used to denote the wake s upper and lower side respectively the kinematic and dynamic boundary conditions should be satisfied on the instantaneous free surface y η x t such that 7 η t φ y φ x η x 8 φ t 1 2 φ φ g η h 1 2 u 2 2 2 boundary element method on the integral equation the governing equation 1 can be converted using green s identity into the following integral equation over the boundaries of the fluid domain 9 λ p ϕ p ϕ q n q ln r p q ln r p q ϕ q n q d s where λ p is the solid angle of the body surface at point p r p q is the distance between points p and q n q is the unit normal at point q and s represents the boundaries of the foils to solve equation 9 numerically the surfaces s s f and s b are discretized using n n f and n b line elements respectively in an anti clockwise direction the elements are arranged by utilizing a cosine spacing that concentrates more panels at the leading and trailing edges of the foils the coordinate of the j th node is denoted as r j x j y j the length and unit normal of the j th element are denoted as s j and n j respectively the continuous potential ϕ is assumed to be linearly distributed over each element the position vector and potential at any point on the j th element can be written as follows 10 r q f 1 ε r j f 2 ε r j 1 11 ϕ q f 1 ε ϕ j f 2 ε ϕ j 1 where ϕ j and ϕ j 1 are the potential at the nodes j and j 1 respectively and 1 ε 1 is the local intrinsic coordinate the shape functions f 1 and f 2 are defined as 12 f 1 ε 1 ε 2 f 2 ε 1 ε 2 selecting the node p i x i y i as the control points equation 9 can be discretized as follows 13 j 1 n b n n f κ i j c i j ϕ j j 1 n b n n f b i j ϕ j n i 1 n b n n f equation 13 can be transformed into 14 j 1 n b n κ i j c i j ϕ j j n b n 1 n b n n f b i j ϕ j n j 1 n b v j n j j n b n 1 n b n n f c i j κ i j ϕ j j n b 1 n b n b i j u i n j i 1 n b n n f where 15 v j w j a γ 1 w j b γ 2 16 κ i j λ i i j 0 i j 17 c i j s j 2 1 1 f 2 ε n j ln r i j d ε s j 1 2 1 1 f 1 ε n j 1 ln r i j 1 d ε and 18 b i j s j 2 1 1 f 2 ε ln r i j d ε s j 1 2 1 1 f 1 ε ln r i j 1 d ε in equations 17 and 18 19 r i j 1 ε 2 x j 1 ε 2 x j 1 x i 2 1 ε 2 y j 1 ε 2 y j 1 y i 2 in equation 15 w a is the induced velocity of the vortex sheet with unit strength in foil a and w b is the induced velocity of the vortex sheet in foil b with unit strength w a and w b can be expressed as follows 20 w j a 1 2 π r a r j d r a 21 w j b 1 2 π r b r j d r b where r a is the position vector of a point on foil a and r b is the position vector of a point on foil b using equation 14 a n f n b n th algebraic matrix equation is built obviously there are n f n b n equations but n f n b n 2 unknowns that are potentials ϕ at all the n f n b n nodes as well as the vortex strength γ 1 and γ 2 thus two additional equations are needed to enclose equation 14 2 3 the kutta condition and hydrodynamic force on the foils in this study the kutta condition is presented as the continuity of the tangential velocity at the trailing edges of the foils thus at the trailing edges the following equation holds 22 φ u τ u φ l τ l by combining equations 1 15 and 22 at the trailing edge of foil a the following equations are obtained 23 w 1 a τ 1 τ n b a γ 1 w 1 b τ 1 τ n b a γ 2 ϕ 1 1 s 1 1 s n b a ϕ 2 s 1 ϕ n b a s n b a u τ 1 τ n b a where n b a is the element number over foil a at the trailing edge of foil b the following equations are obtained 24 w n b a 1 a τ n b a 1 τ n b γ 1 w n b a 1 b τ n b a 1 τ n b γ 2 ϕ n b a 1 1 s n b a 1 1 s n b ϕ n b a 2 s n b a 1 ϕ n b s n b u τ n b a 1 τ n b by combining equations 14 23 and 24 an enclosed n f n b n 2 th algebraic matrix equation for the velocity potential and vortex strength is obtained by solving the integral equation the potentials and vortex sheet strengths are obtained then the kinetic free surface condition in equation 8 and dynamic free surface condition in equation 7 can be used to update the free surface with time marching 25 η t δ t η t φ y φ x η x δ t 26 φ t δ t u 2 2 1 2 φ 2 g η h φ y φ x η x φ y δ t φ t substituting the components of the total potential φ in equation 1 into equations 25 and 26 equations 27 and 28 can be obtained in which the wave elevation is directly correlated to the vortex sheet strengths and the disturbed potential 27 η t δ t η t ϕ y γ 1 φ 1 y γ 2 φ 2 y u ϕ x γ 1 φ 1 x γ 2 φ 2 x η x δ t 28 ϕ t δ t ϕ t u 2 2 1 2 u x ϕ γ 1 φ 1 γ 2 φ 2 2 g η h η t ϕ y γ 1 φ 1 y γ 2 φ 2 y δ t where η t can be obtained by equation 27 and φ 1 and φ 2 are the potentials caused by unit strength vortex sheets placed in foil a and b respectively by bernoulli s theorem the pressure coefficient c p over the foil boundaries can be calculated using 29 c p 1 φ τ 2 u 2 the total lifting coefficient of the foils is 30 c l c l 1 c l 2 31 c d c d 1 c d 2 where c l 1 and c l 2 are the lifting coefficients of foil a and foil b respectively and c d 1 and c d 2 are the dragging coefficients of foil a and foil b respectively c l 1 c l 2 c d 1 and c d 2 can be obtained by performing the following integrations 32 c l 1 1 c s a c p n y d l c l 2 1 c s b c p n y d l c d 1 1 c s a c p n x d l c d 2 1 c s b c p n x d l 3 discussion of the present method without the free surface the hydrodynamic performance of two arbitrarily arranged identical naca 0012 foils in the fluid domain were analyzed using the numerical procedure found in section 2 in this section convergence studies with respect to the element number and length of vortex sheet are performed the normalized coordinate of the chord center of foil b is d 0 4 and l 0 3 fig 2 shows the results of the lifting coefficients c l 1 c l 2 and c d 1 c d 2 at different element numbers the element number over foil a n b a is equal to the element number over foil b n b b it can be seen in fig 2 that the results gradually tend to be constant as the element number increases this implies that the present method is convergent with respect to the element number to accurately predict the forces and pressure distribution of the foils the element numbers were chosen to be n b a 260 and n b b 260 in the sections below in this method two vortex sheets were used to generate the desired circulations of the foils thus it was necessary to perform the convergence studies with respect to the lengths of the vortex sheets and these are presented in fig 3 in fig 3 h c is kept constant as 0 6 while c l 1 changes from 0 01 to 0 98 from fig 3 in can be seen that the pressure curves are nearly indistinguishable when the length of the vortex sheet is larger than 0 01 which implies that the model is convergent with respect to the sheet lengths however it should be noticed that when the vortex length decreases to 0 01 a local pressure peak emerges see the squared area in fig 3 a when sheet length increases to 0 98 the result slightly deviates from that at other sheet lengths see fig 3 a this indicates that the length of the vortex sheet should not be extremely short or long in the numerical model however the convergence scope is at least from 0 01 to 0 98 which is already rather extensive based on the convergence study regarding the length of the vortex sheet the lengths of the vortex sheets were chosen to be a 1 0 6 and a 2 0 6 4 validation of the model there is no experimental data available to validate the numerical results of the model for the steady surface flow passing two foils therefore some slightly simpler cases were used for model validation fig 4 a shows the non dimensional pressure distribution of naca0012 in open water this fig shows that the numerical results of this model agree very well with the experimental results additionally with regards to the free surface effect the pressure distribution agrees very well with that found by park et al 2009 which is shown in fig 4 b to optimize the element number on the free surface the elements size over the free surface increases gradually from the center to left and right boundary as demonstrated in equation 33 33 x i 1 x i ζ μ i k where x is the coordinate of the element the subscript i and i 1 are nodes of the element ζ is the smallest size of all the elements μ is the scale to control the element size and k is used to adjust the elements intensity along the free surface to validate the convergence of the numerical results of the model with respect to the element size simulations were performed as ζ changed from 0 03 to 0 07 while all the other factors were kept constant as α 1 α 2 5 o h c 1 2857 and f r 0 567 the normalized coordinate of the chord center of foil b was d 0 and l 0 2 the variation in wave heights and lengths with respect to ζ are shown in table 1 from which it can be seen the wave heights and lengths are very close to each other when ζ 0 05 and ζ 0 03 the pressure coefficients of the foils are shown in fig 5 from both fig 5 and table 1 the convergence of the numerical results of the model with respect to ζ can be validated the convergence histories of the lifting coefficients and vortex strengths with respect to time are shown in fig 6 in which the time step is set to be 0 0005s because the present simulation was performed in the time domain the forces and vortex strengths fluctuated with time all of the forces and vortex strengths tended to converge to stable values as time progressed the present problem is two dimensional thus the excited free surface wave will propagate infinitely downstream disturbed by the emergence and propagation of free surface wave the foil lift will be fluctuating infinitely as time marches but the fluctuation diminishes gradually it is defined the simulation is convergent as the relative difference of average lifts between last two periods is less than 1e10 4 the different fluctuations in the lifting coefficients and vortex strengths of the two foils resulted from the united effects of the angle of attack the hydrodynamic interference and the free surface effect according to submergence depth it should be noted that the reason the free surface deformation was tracked is because it is the only factor that could cause the fluctuation this is because in this model the vortex shedding from the trailing edge of the foils was avoided the numerical results for the hydrodynamic interaction without free surface between a main foil and a flap foil by williams 1971 are used to validate present method for multi foils interferences the pressure coefficients on the main foil and the flap are shown in fig 7 fig 7 a and b show the comparison of pressure distribution as angle of attack of flap foil α 2 10 o fig 7 c and d show pressure distribution α 2 30 it can be seen that the pressure distribution by present method agrees very well with that by williams 1971 the case with two circles is also used to verify the present numerical study in this case the two circles are non lifting bodies thus there is no vortex shedding by the circles and the vortex sheets were removed from the numerical model the comparison of pressure distribution is shown in fig 8 the verification of present method on free surface elevation disturbed by a single foil is given in fig 9 as u 80 cm s c 20 3 cm α 5 o and h 26 1 cm 23 0 cm and 21 0 cm respectively generally very good agreements can be obtained between the experimental results of duncan 1983 and present results however as submergence depth decreases the wave crests are sharper by numerical simulation because fully nonlinear free surface boundary conditions are used and the fluid viscosity is neglected the wave elevations under different angle of attack and inflow velocity as h 26 1 cm are shown in fig 10 and fig 11 respectively fig 10 shows the wave elevation at different angle of attack generally the wave height increases with angle of attack but the wave length is hardly affected fig 11 shows the wave elevation at different inflow velocity which is normalized as froude number fr it can be seen that the wave profiles are significantly affected by the inflow velocity the convergence history of lift c l of naca 0012 at f r 0 567 h c 1 2857 and α 5 o with respect to time are shown in fig 12 it can be seen that as time steps are 0 0005 and 0 001 the time history of the lifting coefficient can hardly be distinguished and the convergency of the present simulation is verified 5 hydrodynamic interference between the two foils 5 1 hydrodynamic interference at different angles of attack to evaluate the interference between the two foils at different angles of attack the results of the lifting and dragging coefficients when the angle of attack of one of the foils was kept constant while the other changed was observed the location of foil b was chosen as d 0 4 and l 0 3 the lifting coefficients c l 1 and c l 2 at different angles of attack α 1 or α 2 are given in fig 13 it is well known that the lifting coefficient of a single foil varies almost linearly with the angle of attack under the potential flow assumption however for the two foils it can see from fig 13 that the lifting coefficients of both foils vary in an obviously nonlinear way when the angle of attack of one foil is kept constant while that of the other foil changes this indicates a strong hydrodynamic interference between the foils due to the interference foil b generated a positive lift although its angle of attack α 2 was kept at a negative constant of 6 o similarly foil a generated a negative lift although its angle of attack α 1 was kept at a positive constant of 6 o because foil b was located lower than foil a the free surface had a weaker effect on foil b as shown in fig 13 to show the free surface effect on the two foils clearly the hydrodynamics of the two foils without the free surface were also simulated generally the lift with the free surface effect was larger than that in open water as shown in fig 13 5 2 the interference between two vertically aligned foils fig 14 shows the variations in the lifting and dragging coefficients at φ u x ϕ φ and ϕ and with relative vertical location l of d 0 f r and h c are 1 0 and 2 0 respectively when the free surface is considered it can be seen in this fig that the lifting coefficient of foil a c l 1 increases rapidly and then this increase slows down as l increases which means the interference between the foils diminish with an increase in l and c l 2 varies in the opposite trend it is very interesting to find from fig 14 that the lifting and dragging forces on foil a are negative while those on foil b are positive this indicates that the vertical forces and horizontal forces are actually pulling the bodies together wang 2004 which might lead to a collision of the two foils it can be seen from fig 14 a that the lifting coefficients of foil a are increased by the interaction of the free surface while the lifting coefficients of foil b are decreased in addition both the dragging coefficients of a and b increase with the free surface as shown in fig 14 b the pressure distributions of the two foils at different l are shown in fig 15 as expected both the pressure coefficients on the lower surface of foil a and the upper surface of foil b change significantly when l decreases this is reasonable as the lower surface of foil a and the upper surface of foil b are relatively close and thus the interaction will be stronger the pressure over the lower surface of foil a is most sensitive to the interference of one among the four foil surfaces to explicitly show the free surface effect on the foils the pressures with and without the free surface are shown in fig 16 when l 1 it can be seen that the free surface effect decreases the pressure on the foils 5 3 the interference between two horizontally aligned foils the lifting and dragging coefficients with and without the free surface at different d when l 0 f r 0 5 h c 1 5 and α 1 α 2 5 are compared in fig 17 generally at the given submergence depth the lifting coefficients greatly increase due to the effect of the free surface while the dragging coefficients are not affected as much due to the hydrodynamic interference between the foils the lifting and dragging coefficients vary oppositely with an increase in d when d is approximately 1 3 there is an inflection point on the curve of c l 1 in open water but this is eliminated when the free surface effect is considered the pressures on foil a and b with varying d are shown in fig 18 for foil a the pressure on the lower surface increases and the pressure on the upper surface decreases when d increases also the variation corresponds well with the lifting coefficient of foil a for foil b the area enclosed by the pressure curve increases gradually when d increases this increased area causes an increase in the lifting coefficient of foil b as shown in fig 16 furthermore the pressure distributions of the two foils when d 1 5 were compared with that in open water and the results are shown in fig 19 it can be seen that the influence of the free surface effects on the pressure is primarily concentrated on the upper surface of the foils the pressure on both of the foils upper surfaces decreases under the interference of the free surface causing an incremental rise in lifting coefficients this phenomenon agrees well with the results shown in fig 16 the profiles of the free surface at different d on the two foils are shown infig 20 it can be seen that the free surface is greatly affected by the distance between the foils the first trough of the wave trains following foil a obviously descend due to the existence of foil b and this effect lessens as d increases this can partly explain why in fig 17 a the free surface effect actually becomes weaker as d increases from 1 1 to 2 5 in addition the wave trough following foil b is ascended by foil a especially at d 1 1 the different d leads to different phase angles of the wave trains of foil a and foil b thus the resultant wave train can be made stronger or weaker than that generated by a single foil generally within d 1 1 and d 2 5 the phase angle disparity is not very obvious thus the wave trains generated by the two foils are superposed and the wave is higher than that generated by a single foil especially at d 2 0 although the simulation was not performed when d was larger than 2 5 it can be expected that the wave trains would be neutralized at a certain range as d increases 5 4 the effect of submerged depth h the effect of submerged depth h on the free surface was studied when fr 1 0 d 1 1 and l 0 while h c changed from 2 to 4 it can be seen from fig 21 that as h increases the wave heights gradually decrease this means the further the distance between the foils and the free surface the smaller the effect generated by the foils acting on the free surface as h increases from 2 to 4 the wave height decreases nonlinearly from 0 46 m to 0 07 m however the wave length is not affected by the submerged depth as much at a given froude number the lifting and dragging coefficients of foils a and b are shown in fig 22 it can be seen from fig 22 that all the coefficients tend to decrease with h except c l 1 the two foils are located at the same h but the lift and drag are significantly different due to the hydrodynamic interference furthermore it can be seen from the pressure comparison shown in fig 23 that the influence of foil a on foil b is much more significant because foil b is actually located in the wake of foil a 6 conclusions in this study a numerical model was presented to simulate the hydrodynamic performance of two foils in uniform incoming flow using the boundary integral method extensive convergence studies were performed to verify this method the main novelty of this model lies in the circumvention of the iterative procedure while considering the wake sheets using the employment of two vortex sheets along the chord line and the decomposition of the total potential based on the numerical simulation the free surface effect together with the hydrodynamic interference between the foils were discussed in detail in addition the effects of the relative location and submergence depth of the two foils were also analyzed one of the interesting findings of this study is that the interaction between the foils diminished the wave excitation and improved their hydrodynamics further study will provide more insight for the design and navigation of similar marine structures acknowledgments this work is supported by the national natural science foundation of china grant nos 51579052 51679045 and national defense pre research foundation of china grant nos 6142204180408 6142407180108 
22073,in this paper we propose a blade loading sensing system for model tests of floating wind turbines fwts in the wave basin the sensing system is based on fiber bragg grating fbg sensors and a fiber optical rotary joint forj systematical model tests are conducted for the novel sjtu s4 fwt in the wave basin to reveal the characteristics of fwt blade loads under different environmental conditions results show that the developed fbg forj system performs well to capture the fwt blade loads while not smearing other fwt dynamics the fwt blade loading is determined by gravity centrifugal force aerodynamic loads as well as wave and current excitations the driving wind takes the lead in the fwt blade loads an increased driving wind corresponds to increased blade loads in magnitude and fluctuation as well as increased np n times per revolution harmonics the incident wave generates considerable responses at the wave frequency and introduces more loading fluctuations the current tends to eliminate the floater inclination generated by the driving wind and subsequently mitigates the unsteady blade loading despite the increased floater sway and roll fluctuations this work extends the knowledge of fwt aerodynamics and helps to investigate advanced fwt control strategies keywords floating wind turbine blade loads model test fiber bragg grating individual blade pitch 1 introduction the blade is one of the most critical components for a wind turbine wt system capturing energy from wind for electricity production the reliability of the blade determines the system feasibility and economic production as reported by ribrant and bertling 2007 failures induced by the blade and its affiliated pitch controller occupy 9 4 of the wt downtime in sweden between 2000 and 2004 as modern wts get larger in size and capacity with blades getting longer and more flexible the wt blade plays an even more essential role in the wt system according to the reports of oh et al 2011 the blade failure is the most dominating cause for wt downtime occupying a portion of 34 also the blade takes up 30 of the operating and maintenance costs more essential than any other causes therefore deepening the understanding of wt blade dynamics and then detecting the blade failure as early as possible is of considerable significance in the past decades efforts have been made to expand the understanding of large scale wt blade dynamics chou et al 2013 robertson et al 2019 freudenreich and argyriadis 2008 sathe et al 2013 kim et al 2019 jiang et al 2014 subsequently various online condition monitoring systems have been developed dedicatedly for wt blades schubel et al 2013 qiao and lu 2015 yang et al 2015 yang and sun 2013 garcía márquez et al 2012 herein the fiber bragg grating fbg sensor presents its unique advantages and gains pervasive applications in structural health monitoring of wts tian et al 2015 arsenault et al 2013 kim et al 2013 park et al 2011 nowadays the exploitation of offshore renewable energy is gaining more and more interests especially offshore wind energy wen et al 2017 2018 dai et al 2018 ren et al 2018 li et al 2019a wave energy li et al 2016 2018a zhang et al 2018 martin et al 2020 and the combination of both cheng et al 2019 li et al 2018b 2018c 2019b herein the floating wind turbine fwt technology is thought to be a promising alternative to exploit the abundant high quality offshore wind resources in september 2017 the world s first fwt wind farm hywind scotland pilot park began to generate electricity commercially validating the feasibility of fwt technology and significantly encouraging fwt researchers however there is still a huge margin to further optimize the fwt design and reduce the economic costs to reach such objectives a thorough understanding of the fwt dynamics is necessary compared with traditional onshore and fixed foundation wts fwts present more complicated coupling dynamics especially the unsteady aerodynamics on the one hand fwts are exposed to harsher environments suffering from constantly varying wind conditions experiencing temperature and humidity variations surviving random waves currents and even tsunami and seaquakes jonkman and buhl j 2007 butterfield et al 2007 on the other hand the structure of an fwt is more complex the introduction of a floating platform and its mooring system lead the fwt to experience more dominated couplings among structures and loads wen et al 2017 in the last decade several simulation tools have been developed for dynamics modelling and load analysis for fwts jonkman and buhl 2005 larsen and hansen 2007 notably a mass of numerical investigations has been conducted dedicatedly for fwt unsteady aerodynamics bayati et al 2016 jonkman 2007 liu et al 2019 tran and kim 2015 wen et al 2017 2019 all these studies significantly promote the understanding the fwt aerodynamics such as the unsteady blade loading characteristics however corresponding experimental data are relatively scarce to validate these numerical tools although the widely used tools such as fast jonkman and buhl 2005 have been validated at the level of system response such as the floater dynamic performance coulling et al 2013 jain et al 2012 their capacities to predict the performance of local critical components such as blade loads are still questionable on the other hand a timing and hot topic in the fwt community nowadays is to develop advanced controllers to reduce fwt loads and to stabilize the floating platform herein the individual blade pitch ibp control is among the most widely investigated control strategies namik and stol 2010 2014 although many numerical simulations have been carried out no dedicated experimental tests can be found in the existing literature to access the controller performance objectively especially with fwts in the wave basin tests in addition it was reported that the interaction of the pitch control system and platform motions will lead to instability or so called negative damping problem phenomenon jonkman 2008 larsen and hanson 2007 fleming et al 2019 although several simulations have been carried out on this topic corresponding experimental tests are still absent to evaluate the ibp performance and the controller floater interaction in model tests detecting the blade loading in real time is the most fundamental work because it serves as an important feedback signal therefore experimentally investigating the fwt blade loading is of essential significance and it needs to be realized urgently the work presented in this study is part of the efforts for such objectives a novel fwt system is designed and constructed for the wave basin tests a dedicated blade sensing system is developed to capture the blade loading based on fbg sensors and a fiber optical rotary joint forj systematic wave basin tests are carried out to reveal the fwt blade loading characteristics this paper contributes to the existing literature in two major aspects 1 a dedicated blade loading sensing system is developed for the fwt model which is among the first attempts to monitor blade loads in fwt wave basin model tests the sensing system is carefully designed and manufactured performing well and satisfyingly following the requirements of scaling laws meanwhile the sensing system design can be enlightening for researchers to optimize the model fwt and to develop fwt controllers at the model scale 2 the blade loading performance under different environmental and operational conditions are systematical provided which is among the first datasets of fwt blade loads it serves to expand the knowledge of fwt blade loading characteristics helping to validate and modify fwt numerical tools also the current study potentially serves as the preparatory work for further experimental study of ibp control strategy and the controller floater interactions in fwt wave basin tests the remainder of this paper is organized as follows the experimental apparatus is introduced in section 2 afterwards the fwt blade characteristics under different environmental and operational conditions are presented and discussed in section 3 finally some critical concluding remarks are provided in section 4 2 experimental setup it is a tough issue to design and deploy a blade loading sensing system for the fwt model which can be a potential reason for the absence of such a fwt model until now generally there are two major difficulties 1 the size mass and inertia of the fwt model are strictly required by the scaling laws when conducting a model test in the present study the theoretical mass of the rotor hub nacelle assembly is about 2 8 kg according to the froude scaling law at a ratio of 1 50 the target mass of a single blade is 140 1 g designing and manufacturing these fwt components especially the blades while not violating the scaling laws is a tough challenge much less deploying an additional blade loading sensing system 2 it is difficult to transmit the captured blade loading signal to the signal processing unit for further process and analysis the sensors should be attached with the rotating blades while the signal processing unit needs to locate on the stationary end the signal transmission between the rotator and stator should be carefully considered to overcome these two issues mentioned above a dedicated fbg forj sensing system is developed and will be introduced in this section besides the most basic principle for fbg sensors is provided at first 2 1 fbg principles the fbg sensor is suitable for the blade loading monitoring especially for the fwt model tests in the wave basin it presents a direct physical correlation between the measured bragg wavelength and strain and it is immune to lightning and electric shocks moreover it is small and lightweight which enables to limit the overall mass to the most significant extent for the fwt model in the present study the fbg sensor is selected to capture the blade loads the fbg sensor is featured with a bragg reflector that is composed of a segment of optical fiber when a broadband incident light reaches the grating segment the light with wavelength complying the bragg condition will be reflected while other wavelengths are transmitted as shown in fig 1 the bragg condition is expressed as 1 λ b 2 n eff λ where λ b n eff and λ are the bragg wavelength the effective refractive index and the period of the bragg grating respectively as indicated in eq 2 the reflected wavelength is dependent on the effective refractive index of the segmented fiber if the fiber is deformed due to the influence of mechanical strain or temperature change the characteristic wavelength will be changed 2 δ λ b λ b α ξ δ t 1 p e ε where δλ b is the change of bragg wavelength α is the thermal expansion coefficient and ξ is the thermo optic coefficient of the refractive index of the fiber δt is the temperature change p e is a constant that is dependent on the strain optic tensor p ij and poisson s ratio ν as shown in eq 4 p e is usually assumed as 0 21 0 22 ε is the strain that is defined as the length change normalized by the original length 3 p e n e 2 2 p 12 ν p 11 p 22 at the right hand side of in eq 3 the first item denotes the temperature effect and the second term represents the influence of mechanical strain if the temperature is negligible when compared with the mechanical strain effect eq 3 degrades to 4 ε 1 1 p e δ λ b λ b therefore the mechanical strain can be derived by measuring the wavelength shift of the reflected fbg signals 2 2 fbg forj sensing system to capture the accurate blade loading in real time we deployed three fbg sensors with adhesive yh t805 on the blade root blade mid span and blade tip regions respectively as shown in fig 2 the blades are made of carbon fiber with a specific manufacturing procedure to limit the blade mass while not smearing the scaling law requirements in modern commercial wind turbines the blades are usually made of composite materials chen et al 2019 li et al 2020 the current study only reproduces the geometry of the prototype turbine blade but cannot match the material and the mechanical property at present note that fbg 3 is thought to experience marginal mechanical strain because it locates at the blade tip consequently fbg3 only serves as a temperature compensator to provide reference information for fbg1 and fbg2 in this paper in the following context only results of fbg1 and fbg2 will be presented to solve the signal transmission problem a dedicated forj structure is deployed on the nacelle fig 3 shows a detailed depiction of the forj structure it mainly consists of a rotor and a stator the former can rotate about the rotor axis and the latter is fixed with the stationary nacelle and is further connected to the signal processing unit to preserve space for the forj deployment the nacelle is designed as a double axis configuration as shown in fig 4 the dc motor was moved from the rotor shaft axis and a gear pair was deployed to guarantee the transfer of the mechanical power in addition the hub and the rotor shaft were made hallow to provide a passage for the fiber cable it should be noted that strict mass control is focused during the design and manufacturing of the nacelle a more detailed introduction and the preliminary performance tests of the fbg forj blading loading monitoring system are accessible in ref wen et al 2020 when conducting the signal capture the fbg sensors are connected to the forj with a fiber through the fc apc jumper and further to an sm130 optical sensing interrogator module interrogator sm130 works upon swept wavelength laser based measurement technology it covers the wavelength between 1510 nm and 1590 nm a wideband optical laser is lunched by the interrogator and then reflected by the fbg sensors the interrogator demodulates the fbg strain signal based on the reflected wave subsequently the captured fbg signal is recorded and processed by the signal processing unit that is developed dedicatedly the sampling rate is 1000 hz in the present study 2 3 fwt model the monitored target in the present study is the novel sjtu s4 fwt consisting of a three bladed horizontal axis wind turbine and a novel sjtu s4 floating platform sjtu shanghai jiao tong university s4 stepped short spar for shallow water the model wind turbine is geometrically scaled down from the nrel 5 mw baseline wind turbine jonkman et al 2009 with a froude scaling ratio of 1 50 the rotor radius is 1 26 m with hub height 1 8 m with respect to the still water line a coned tower is designed with carbon fiber to reproduce the practical shape of the prototype it is able to reproduce the unsteady blade tower interaction such as tower shadow effect the overall description of the model wind turbine is shown in fig 5 the model wind turbine is located on the sjtu s4 floating platform sjtu s4 is specifically designed for shallow water depth regions with a depth of 50 m 1 m in the model scale the target water depth is 100 m in full scale the sjtu s4 fwt model is transferred into the wave basin and is moored with customized mooring system to the sea bed as shown in fig 6 a dedicated wind generation system wgs is deployed to generate controllable driving wind fields the effective wind field area is 3 m 3 m which is able to cover the whole rotor swept area the wgs is composed of 16 individually controllable axis wind turbines in a 4 4 configuration it is able to generate different wind fields with varied wind parameters the wave generator is able to produce different regular irregular waves with different wave parameters besides different sea currents can also be generated to model realistic offshore environments more detailed introduction about the experimental apparatus is available in refs wen et al 2019d based on the present experimental apparatus the fwt dynamics under different environmental and operational conditions can be systematically investigated the blade loading characteristics are especially focused in the present study 3 results and discussion the blade loading of an fwt in the offshore environment is rather complicated depending on the rotor operating conditions such as the rotor speed and the blade pitch the driving wind field and the gravity and centrifugal forces in addition the excessive excitations induced by the wave and current also play essential roles in the blade loads in this part the characteristics of the fwt blade loading under different conditions will be tested and analyzed based on the developed experimental apparatus note that the blade pitch angle is fixed at zero throughout the study 3 1 preliminary calibration firstly a static test was conducted for the fbg forj sensing system to evaluate the sensitivity of the fbg responses to the external loading the blade was fixed to the supporting structure with bolts to perform as a cantilever external weight was applied near the blade tip in the windward leeward direction to induce fbg strains as shown in fig 7 the fbg strain represents a linear relation with respect to the external loading different fbgs present different sensitivity to the external loads a more detailed discussion is accessible in wen et al 2020 also a series of hammer tests are conducted to obtain the natural frequencies of the blades impacts are applied from the windward leeward and lead lag directions orderly results show that the first flap wise and edge wise natural frequencies are 27 0 hz and 22 4 hz respectively which are much higher than those of the full scale blade jonkman et al 2009 this mismatch is mainly caused by the vastly different stiffness of the model blade the full scale prototype also the mismatched mass distribution also contributes to the frequency distortion fortunately this mismatch is acceptable because the major objective of the current study is to reveal the dependency of blade loading on environmental and operational conditions in addition the aero elastic behavior is thought to be more predominant in a tlp type fwt but is marginal in spar type fwt systems goupee et al 2014 it should be noted that the fbg sensors present significant advantages in detecting the natural frequencies of model blade and tower structures the lightweight fbg sensor is suitable to mounted on the targets and can successfully escape the loading effect as for traditional sensors such as accelerometers the transducer weight is considerable when compared with the target mass leading to significant loading effect to smear the captured signal bang et al 2010 the responses of fbg strain under different rotating speeds in still air still water are shown in fig 8 rotor speeds from 10 rpm to 70 rpm are tested 40 rpm case is absent with 1min time series displayed for each case clear cyclic oscillations are observed in the time domain responses generally the 1p once per rotor revolution component dominates the energy of fbg strain signal coinciding with that observed in the corresponding frequency responses in fig 9 the 1p response increases with the rotor speed indicated by the larger peak value at 1p frequency in addition a non negligible response at 2p twice per rotor revolution frequency and marginal np components are also observed the harmonic responses can be partly contributed to by the nonlinear characteristics of the dynamic system such as the quadric correlation between the aerodynamic load and the apparent wind speed seen by the blade airfoil also the unexpected structural defects can be another cause such as the unbalancing of the turbine shaft fbg2 locating at the mid span blade seems to present a more dominant 2p response than fbg1 at the blade root similar information can also be clearly observed in the time series e g 10 rpm case fbg1 strain signal performs well as a sinusoidal function while fbg2 presents the characteristics of a dual sinusoidal signal in the frequency domain e g 70 rpm case the peak value at 2p frequency in fbg1 is about 20 of 1p response as for fbg2 however the response at 2p frequency is about 50 of that at 1p frequency note that under these rotating only cases the fbg strain is mainly generated by the gravity the centrifugal force the aerodynamic drag and some unexpected system vibrations herein the gravity serves as one of the 1p sources because its effective component in the fbg strain varies periodically with the azimuthal angle both centrifugal force and aerodynamic drag are proportional to the square of the rotor speed this quadratic nature potentially contributes to the increased 2p responses at a higher rotor speed to have a general evaluation on the blade loading the statistical analysis of the fbg strains are concluded in the box diagrams in fig 10 in the box diagram the 25th and 75th percentiles are denoted by the lower and top limit of the box respectively the vertical range of the box represents the interquartile range the middle line in the box indicates the median of the data set the short whiskers locating 1 5 times the interquartile range from the box top or box bottom represent the boundary for the normal data measured data beyond this range composed by the upper and lower whiskers are treated as outliers denoted as red markers in the figure the averaged value is also exhibited represented by a black circle to serve as the averaged fbg strain level generally fbg1 and fbg2 share a similar statistic performance with a difference in the magnitude the fbg strains are relatively small in the rotating only cases because the gravity and centrifugal forces are marginal due to the light weight of the blade structure in addition the aerodynamic drag is small because the relative speed between blade airfoil and still air is not too high it is found that the blade rotating speed has a little influence on the blade loads with a variation of the averaged values being less than 2με for different rotor speed cases however the fluctuation range of the blade loading amplifies to some extent as the rotor speed increases indicating that the blade loading gradually gets unsteady with increasing rotor speed almost all of the observed data locate in the interquartile range with only a few outliers appear in fbg1 for 10 rpm and fbg2 for 70 rpm fbg1 strain represents a better symmetry than fbg2 as for fbg1 the median locates at the middle of the box and is nearly coincident with the average value as for fbg2 strain however it is observed that the median locates lower than the average value indicating that the observed data distributes with slight asymmetry 3 2 blade loads in driving wind the rotating only case in section 3 2 is rather simple where neither wind nor wave excitation is applied in the practical operating conditions however the wind loading performs as one of the most dominating external excitations especially for the fwt that is featured with stronger winds in offshore environments in this section the performance of the blade loading in driving wind is investigated and discussed the fwt operates in a driving wind speed of 1 88 m s with different rotor speeds the driving wind is generated by the dedicated wind generation system wgs as shown in fig 6 note that no wave is applied in this part to focus on the role of driving wind the responses of the fbg strain signals in driven wind are displayed in the time and frequency domains as shown in fig 11 and fig 12 respectively to focus on the influence of the wind loading these results should be analyzed compared with results under rotating only cases as shown in figs 8 and 9 again 1min time series are provided for each rotor speed in fig 11 once the driving wind is introduced the fbg strains are apparently increased in magnitude due to the amplified aerodynamic loading similar to the rotating only case clear np components are observed in the frequency spectra the 1p component occupies considerable energy in the fbg strains with the peak value at 1p increasing with the rotor speed it seems that the additional wind loading tends to excite more np response components especially at high rotor speeds in the rotating only cases only 1p and 2p responses can be clearly detected as shown in fig 9 in the driving wind however 3p and 4p components gradually appear especially at rotor speeds higher than 40 rpm in fact the np n 2 responses are not totally unexpected on the one hand due to the defects of the wind generation system the generated wind field is not ideally uniform in space or purely steady in the time domain according to our calibration tests the turbulence intensity of the generated wind field is about 10 wen et al 2019d as the blade rotates in such a turbulent wind filed the rotational sampling effect is non negligible consequently the effective wind velocity acting on the blade is inherently fluctuating with significant responses appearing at np frequencies murtagh et al 2005 chen et al 2020 on the other hand the np n 2 responses can also be partly induced by the nonlinearity of dynamic system and the undesirable structure defects the model wind turbine is a highly integrated coupling system and the dynamic system is inherently nonlinear the unexpected unbalancing of the transmission subsystem such as the turbine shaft unbalancing and the defective operating of the mechanical components such as the couplings and the gears can also contribute to the non stationary np harmonics according to the reports of field tests these np harmonic responses in blade loads are commonly observed in a practical wind turbine system for example in the field test of ennis et al 2018 apparent np harmonic responses especially 2p 6p components were found in the blade bending moments the energy of 2p component is about 1 2 of 1p response in the collinear flow case it should be noted that even higher harmonics can also be observed in the frequency domain but only the responses in 0 5 hz are displayed here for the sake of conciseness and the higher hormonics are mainly introduced by the defective mechanical system which is out of the scope of present study the statistical analysis of the fbg strains in driving wind under different rotor speeds is depicted in fig 13 when the wind loading is introduced an apparent fbg strain is generated as indicated by 0 rpm case limited influence of the rotor speed is detected on the blade loading significant outliers are found under the driving wind cases when compared with the rotating only cases even in the wind only case 0 rpm non negligible outliers are observed because of the unsteadiness and non uniformity of the driving wind further more outliers are found in fbg2 than fbg1 indicating that the mid span airfoils present more dynamic characteristics than the blade root slight asymmetry is observed in the fbg strains but the asymmetry has been partly improved by the driving wind when compared with the rotating only case in fig 10 in addition to gravity centrifugal force and aerodynamic drag revealed in the rotating only cases additional aerodynamic loads are introduced by the driving wind more specifically additional downwind force thrust and torque wise force generating aerodynamic torque also act on the blades based on the comparison of figs 10 and 13 it is concluded that the wind loading dominates other excitations further the wind loading introduces an inclination angle especially pitch to the floating platform the altered equilibrium position of the floater changes the gravity and centrifugal performances and consequently alters the blade loading performance actually a static floater pitch is equivalent to an inclination flow in complex terrain kress et al 2016 the inclination flow tends to introduce more unsteady disturbance and subsequently more fatigue damages to the wind turbine structures wen et al 2018 3 3 blade loads in regular waves in addition to the wind loading the wave excitation also plays an essential role in the fwt dynamics and it is one of the most critical external excitations for fwts the blade loading performance in regular waves is introduced in this part followed by the irregular wave cases in the next part to thoroughly reveal the impact of incident wave five different regular waves are generated as shown in table 1 the sea state gets relatively severer from rw1 to rw5 with wave height increasing and wave frequency decreasing it should be noted that the fwt operates in an intense driving wind of 4 40 m s with a rotor speed of 50 rpm in these cases the corresponding fbg strain responses in the time and frequency domains are displayed in fig 14 and fig 15 respectively with the statistics concluded in the box diagrams in fig 16 when the incident wave additionally acts on the fwt the floating platform will be forced to oscillate around its equilibrium position in six degrees of freedom dofs correspondingly the blades will be led to oscillate cyclically perplexing the blade loading from mainly three aspects wen et al 2017 2018 firstly the accessional oscillation tends to introduce an additional relative velocity between the incoming wind and the blade airfoils altering the aerodynamic loading and the flow states of local blade airfoils although the induced wind speed is symmetric a net dc offset in the blade loading will still be generated due to the nonlinear relationship between blade loading and effective wind speed secondly the blade is guided to advance into and then retreat from its own wake resulting in rather complicated blade wake interactions which further smearing the blade loading performance thirdly the changed floater orientation tends to transform the effective components of gravity and centrifugal forces on different directions of the fwt blade loads for example an increased platform pitch means a larger gravity component in the flap wise direction when the blade pointing upward 0 azimuth in addition it should be noted that the unexpected platform oscillation will introduce increased loading effect to traditional sensors resulting in reduced accuracy and reliability of the captured data however the fbg sensor is not smeared due to its extreme lightweight which is one of the most important advantages for the developed fbg forj blade load sensing system the driving wind speed significantly impacts the blade loading as the driving wind increases from moderate fig 11 to strong fig 14 the averaged fbg1 strain for 50 rpm increases from 20με to 35με as shown in the frequency domain responses in addition to the dominant 1p response and its harmonics an apparent response at the wave frequency is observed as denoted by 1w as the wave height increases the frequency of the incident wave moves towards the low frequency the np components seem to be insulative to the incident regular wave because they are majorly induced by the blade rotating and driving wind the box diagram in fig 16 indicates that the average blade loading presents an increasing trend as the sea state gets severer under the excitation of a regular wave the floater tends to experience cyclic oscillations which will introduce cyclical fluctuations to the relative wind speed and the resultant blade loading when averaging the blade loading in a time interval a dc offset will be derived due to the quadric relationship between the blade loading and the effective wind speed the larger the floater oscillation especially surge and pitch is the larger the dc offset will be in our prior numerical investigations it was found that the average rotor thrust and power output increase as the platform surge and pitch oscillations become severer wen et al 2017 2018 the reduced frequency was defined to quantitatively describe the influence of platform oscillation on the averaged rotor thrust and power output the increased average blade loading in a severer wave is coincident with our prior numerical results and both results verify each other qualitatively compared with the moderate wind still water cases in fig 13 much more outliers are observed in fig 16 the increased driving wind contributes more unsteadiness and uncertainty to the blade loading and the additional wave excitation further amplifies the dynamics resulting in more outliers in the blading loading it is anticipated from the increased unsteadiness and uncertainty that the fwt structures especially the blades are exposed to an increased risk of fatigue damages 3 4 blade loads in irregular waves in real offshore environments sea wave is usually irregular due to the randomness and unsteadiness of the sea state to complete the discussion the blade loading characteristics in irregular waves are introduced in this part two general irregular waves are included in this part as summarized in table 2 two sets of load cases are designed as shown in table 3 the first set lc1 lc2 lc3 lc4 is featured with different wind current rotor operating conditions in given irregular wave irw1 the second set lc2 lc5 is designed to reveal the influence of different irregular waves the power spectral density psd responses of the fbg strain signals in a given irregular wave but with different wind current and operating conditions are provided in fig 17 as for lc1 wave only parked an irregular wave with h s 14 0 cm and t p 1 56s is generated to serve as the sole external excitation a considerable portion of the response energy is occupied by the low frequency band which is associated with the low frequency floater oscillations especially a clear local peak is observed at the floater pitch natural frequency denoted as f p in the figure it is associated with the platform pitch resonance induced by the second order difference frequency wave loads the blade loading will feel the floater pitch resonance vibration through the altered relative wind speed and the distorted floater gesture in addition a response at the wave frequency is observed which is denoted as 1w in the figure it is mainly excited by the linear wave loads note that np harmonics at higher frequency that is caused by the imperfect mechnical system is not shown in the figures as the driving wind is introduced and the blade rotates in lc2 responses across almost the whole frequency band are amplified when compared with lc1 the only exception is at the natural frequency f p the additional aerodynamic excitation seems to suppress the pitch resonance vibrations indicating that the aerodynamic loading mainly serves as an equivalent damping in the floater pitch motion goupee et al 2014 although the aerodynamic loading increases the averaged floater pitch the corresponding dynamic oscillation is mitigated due to the aerodynamic damping effect the low frequency response except f p is increased which is partly contributed by the low frequency aerodynamic load significant np responses are observed due to the excitation of blade rotating and the system nonlinearity as the driving wind increases from lc2 to lc3 the wave frequency response is not clearly altered but the np components and high frequency responses are amplified these increased responses can be partly caused by the amplified aerodynamic loads and the increased asymmetrical floater deployment such as the floater pitch and yaw as the current is further acting on the fwt in lc4 the wave frequency is generally maintained with the no current case in lc3 however the np responses are partly suppressed when compared with lc3 it should be noted that the aerodynamic loading is imposed at a high elevation generating a pitch angle to the fwt oppositely the current load acts at a very low elevation which serves to push the fwt back to the vertically upright deployment consequently the non uniformity and asymmetry induced by the aerodynamic loading will be relatively mitigated by the current loads which majorly account for the reduced np responses in lc4 than lc3 from this point of view the current seems to protect the fwt structures from the unsteady uneven loads and the resultant fatigue damages induced by the wind loading however it should be noted that if the acting point of the current load is higher the platform pitch angle can be further amplified by the current loads also the current loads will generate significant sway and roll motions due to the apparent vortex induced motions especially as for the spar type fwts although the excessive sway and roll oscillations have marginal influences on the blade loads the fbg strain responses under two different irregular waves are exhibited in fig 18 the driving wind and rotor speed are maintained for these two cases as the wave height is increased from lc2 to lc5 the low frequency responses are amplified due to the increased low frequency floater oscillations also the wave frequency response 1w is increased and the characteristic frequency band transfers towards the low frequency direction the high frequency responses especially the np components are not clearly affected by the incident irregular wave generally the blade loading is increased in the severer irregular wave irw2 in both averaged blade loading and its corresponding load fluctuation the increased blade dynamic loads are detrimental to the structure safety increasing the risk of blade fatigue and failure to mitigate the blade dynamic loads novel fwt control strategies have been proposed herein the individual blade pitch control is among the most popular ones namik and stol 2010 bossanyi 2003 the frequency response of the blade loading provided here has the potential to help improve the controller performances for example it guides the designer to properly deploy the natural frequency of the controller which is of considerable significance because an incorrect controller frequency can result in unexpected fwt dynamics jonkman 2008 larsen and hanson 2007 4 conclusions knowledge about the blade loading characteristics is of considerable significance for a floating wind turbine fwt especially for the fwt optimization and advanced controller development in this study we developed a dedicated blade loading sensing system for a model fwt based on fiber brag grating fbg and fiber optical rotary joint forj focusing on the blade loading performance we conducted systematic experimental tests for the novel sjtu s4 fwt in the wave basin under different environmental and operational conditions from the experimental results and discussion in the previous sections the following conclusions are drawn 1 it is feasible to monitor the blade loads for fwts in wave basin model tests with an fbg forj sensing system as long as the sensing system and nacelle structure are carefully designed and manufactured the weight and inertia can satisfyingly meet the scaling laws equipping an forj on the nacelle can guarantee reliable signal transmission from the rotating blades to the stationary signal processing unit the fbg forj sensing system in the current study can be enlightening for researchers to optimize the model fwt and to develop fwt controllers at the model scale 2 gravity centrifugal force and aerodynamic loads play significant roles in the fwt blade loading 1p once per revolution component and its np harmonics appear in the blade loading signals the np harmonics are mainly introduced by the nonlinear nature of the fwt system and the undesired defects of the fwt model test system more np harmonics are exhibited at a higher rotor speed 3 the aerodynamic loading generated by the driving wind dominates the external excitations for an operating fwt as the driving wind increases the fwt blade loading amplifies significantly in both magnitude and fluctuation further the wind induced inclination of the floating platform alters the performance of gravity and centrifugal forces on the blade loads 4 the incident wave introduces an apparent response at the wave frequency in the blade loads as the sea state gets severe the fwt blade loading increases in both average and fluctuation which potentially introduce more fatigue damages to the fwt blades improving the floater stability is beneficial to mitigate the static and dynamic loads of fwt blades 5 if the acting point of the current load is low enough the sea current will perform to eliminate the floater inclination that is mainly induced by the driving wind and subsequently mitigates the unsteady blade loads however the current induced roll and sway motions of the floater is detrimental for the fwt system note that the current study is among the first attempts to reveal the fwt blade loading behaviors which is potential helpful for further fwt controller investigations with experimental tests the fwt blade loading is a rather complicated issue especially in the wave basin model test the fwt itself is a highly integrated complex system consisting of several subsystems the blade loads are significantly impacted by the external environmental excitations as well as the internal disturbances the current study only serves as an initial experimental assessment on the fwt blade loading characteristics the future work will focus on constructing higher accuracy test facility and conducting more extensive tests afterwards the fwt pitch controller dynamics and the controller floater interaction will be experimentally evaluated credit authorship contribution statement binrong wen conceptualization formal analysis validation writing original draft zhanwei li software writing review editing zhihao jiang resources data curation xinliang tian project administration methodology xingjian dong funding acquisition supervision zhike peng funding acquisition supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is financially supported by the national natural science foundation of china grant no 11632011 11572189 and 11872243 and natural science foundation of shanghai grant no 19zr1426300 
22073,in this paper we propose a blade loading sensing system for model tests of floating wind turbines fwts in the wave basin the sensing system is based on fiber bragg grating fbg sensors and a fiber optical rotary joint forj systematical model tests are conducted for the novel sjtu s4 fwt in the wave basin to reveal the characteristics of fwt blade loads under different environmental conditions results show that the developed fbg forj system performs well to capture the fwt blade loads while not smearing other fwt dynamics the fwt blade loading is determined by gravity centrifugal force aerodynamic loads as well as wave and current excitations the driving wind takes the lead in the fwt blade loads an increased driving wind corresponds to increased blade loads in magnitude and fluctuation as well as increased np n times per revolution harmonics the incident wave generates considerable responses at the wave frequency and introduces more loading fluctuations the current tends to eliminate the floater inclination generated by the driving wind and subsequently mitigates the unsteady blade loading despite the increased floater sway and roll fluctuations this work extends the knowledge of fwt aerodynamics and helps to investigate advanced fwt control strategies keywords floating wind turbine blade loads model test fiber bragg grating individual blade pitch 1 introduction the blade is one of the most critical components for a wind turbine wt system capturing energy from wind for electricity production the reliability of the blade determines the system feasibility and economic production as reported by ribrant and bertling 2007 failures induced by the blade and its affiliated pitch controller occupy 9 4 of the wt downtime in sweden between 2000 and 2004 as modern wts get larger in size and capacity with blades getting longer and more flexible the wt blade plays an even more essential role in the wt system according to the reports of oh et al 2011 the blade failure is the most dominating cause for wt downtime occupying a portion of 34 also the blade takes up 30 of the operating and maintenance costs more essential than any other causes therefore deepening the understanding of wt blade dynamics and then detecting the blade failure as early as possible is of considerable significance in the past decades efforts have been made to expand the understanding of large scale wt blade dynamics chou et al 2013 robertson et al 2019 freudenreich and argyriadis 2008 sathe et al 2013 kim et al 2019 jiang et al 2014 subsequently various online condition monitoring systems have been developed dedicatedly for wt blades schubel et al 2013 qiao and lu 2015 yang et al 2015 yang and sun 2013 garcía márquez et al 2012 herein the fiber bragg grating fbg sensor presents its unique advantages and gains pervasive applications in structural health monitoring of wts tian et al 2015 arsenault et al 2013 kim et al 2013 park et al 2011 nowadays the exploitation of offshore renewable energy is gaining more and more interests especially offshore wind energy wen et al 2017 2018 dai et al 2018 ren et al 2018 li et al 2019a wave energy li et al 2016 2018a zhang et al 2018 martin et al 2020 and the combination of both cheng et al 2019 li et al 2018b 2018c 2019b herein the floating wind turbine fwt technology is thought to be a promising alternative to exploit the abundant high quality offshore wind resources in september 2017 the world s first fwt wind farm hywind scotland pilot park began to generate electricity commercially validating the feasibility of fwt technology and significantly encouraging fwt researchers however there is still a huge margin to further optimize the fwt design and reduce the economic costs to reach such objectives a thorough understanding of the fwt dynamics is necessary compared with traditional onshore and fixed foundation wts fwts present more complicated coupling dynamics especially the unsteady aerodynamics on the one hand fwts are exposed to harsher environments suffering from constantly varying wind conditions experiencing temperature and humidity variations surviving random waves currents and even tsunami and seaquakes jonkman and buhl j 2007 butterfield et al 2007 on the other hand the structure of an fwt is more complex the introduction of a floating platform and its mooring system lead the fwt to experience more dominated couplings among structures and loads wen et al 2017 in the last decade several simulation tools have been developed for dynamics modelling and load analysis for fwts jonkman and buhl 2005 larsen and hansen 2007 notably a mass of numerical investigations has been conducted dedicatedly for fwt unsteady aerodynamics bayati et al 2016 jonkman 2007 liu et al 2019 tran and kim 2015 wen et al 2017 2019 all these studies significantly promote the understanding the fwt aerodynamics such as the unsteady blade loading characteristics however corresponding experimental data are relatively scarce to validate these numerical tools although the widely used tools such as fast jonkman and buhl 2005 have been validated at the level of system response such as the floater dynamic performance coulling et al 2013 jain et al 2012 their capacities to predict the performance of local critical components such as blade loads are still questionable on the other hand a timing and hot topic in the fwt community nowadays is to develop advanced controllers to reduce fwt loads and to stabilize the floating platform herein the individual blade pitch ibp control is among the most widely investigated control strategies namik and stol 2010 2014 although many numerical simulations have been carried out no dedicated experimental tests can be found in the existing literature to access the controller performance objectively especially with fwts in the wave basin tests in addition it was reported that the interaction of the pitch control system and platform motions will lead to instability or so called negative damping problem phenomenon jonkman 2008 larsen and hanson 2007 fleming et al 2019 although several simulations have been carried out on this topic corresponding experimental tests are still absent to evaluate the ibp performance and the controller floater interaction in model tests detecting the blade loading in real time is the most fundamental work because it serves as an important feedback signal therefore experimentally investigating the fwt blade loading is of essential significance and it needs to be realized urgently the work presented in this study is part of the efforts for such objectives a novel fwt system is designed and constructed for the wave basin tests a dedicated blade sensing system is developed to capture the blade loading based on fbg sensors and a fiber optical rotary joint forj systematic wave basin tests are carried out to reveal the fwt blade loading characteristics this paper contributes to the existing literature in two major aspects 1 a dedicated blade loading sensing system is developed for the fwt model which is among the first attempts to monitor blade loads in fwt wave basin model tests the sensing system is carefully designed and manufactured performing well and satisfyingly following the requirements of scaling laws meanwhile the sensing system design can be enlightening for researchers to optimize the model fwt and to develop fwt controllers at the model scale 2 the blade loading performance under different environmental and operational conditions are systematical provided which is among the first datasets of fwt blade loads it serves to expand the knowledge of fwt blade loading characteristics helping to validate and modify fwt numerical tools also the current study potentially serves as the preparatory work for further experimental study of ibp control strategy and the controller floater interactions in fwt wave basin tests the remainder of this paper is organized as follows the experimental apparatus is introduced in section 2 afterwards the fwt blade characteristics under different environmental and operational conditions are presented and discussed in section 3 finally some critical concluding remarks are provided in section 4 2 experimental setup it is a tough issue to design and deploy a blade loading sensing system for the fwt model which can be a potential reason for the absence of such a fwt model until now generally there are two major difficulties 1 the size mass and inertia of the fwt model are strictly required by the scaling laws when conducting a model test in the present study the theoretical mass of the rotor hub nacelle assembly is about 2 8 kg according to the froude scaling law at a ratio of 1 50 the target mass of a single blade is 140 1 g designing and manufacturing these fwt components especially the blades while not violating the scaling laws is a tough challenge much less deploying an additional blade loading sensing system 2 it is difficult to transmit the captured blade loading signal to the signal processing unit for further process and analysis the sensors should be attached with the rotating blades while the signal processing unit needs to locate on the stationary end the signal transmission between the rotator and stator should be carefully considered to overcome these two issues mentioned above a dedicated fbg forj sensing system is developed and will be introduced in this section besides the most basic principle for fbg sensors is provided at first 2 1 fbg principles the fbg sensor is suitable for the blade loading monitoring especially for the fwt model tests in the wave basin it presents a direct physical correlation between the measured bragg wavelength and strain and it is immune to lightning and electric shocks moreover it is small and lightweight which enables to limit the overall mass to the most significant extent for the fwt model in the present study the fbg sensor is selected to capture the blade loads the fbg sensor is featured with a bragg reflector that is composed of a segment of optical fiber when a broadband incident light reaches the grating segment the light with wavelength complying the bragg condition will be reflected while other wavelengths are transmitted as shown in fig 1 the bragg condition is expressed as 1 λ b 2 n eff λ where λ b n eff and λ are the bragg wavelength the effective refractive index and the period of the bragg grating respectively as indicated in eq 2 the reflected wavelength is dependent on the effective refractive index of the segmented fiber if the fiber is deformed due to the influence of mechanical strain or temperature change the characteristic wavelength will be changed 2 δ λ b λ b α ξ δ t 1 p e ε where δλ b is the change of bragg wavelength α is the thermal expansion coefficient and ξ is the thermo optic coefficient of the refractive index of the fiber δt is the temperature change p e is a constant that is dependent on the strain optic tensor p ij and poisson s ratio ν as shown in eq 4 p e is usually assumed as 0 21 0 22 ε is the strain that is defined as the length change normalized by the original length 3 p e n e 2 2 p 12 ν p 11 p 22 at the right hand side of in eq 3 the first item denotes the temperature effect and the second term represents the influence of mechanical strain if the temperature is negligible when compared with the mechanical strain effect eq 3 degrades to 4 ε 1 1 p e δ λ b λ b therefore the mechanical strain can be derived by measuring the wavelength shift of the reflected fbg signals 2 2 fbg forj sensing system to capture the accurate blade loading in real time we deployed three fbg sensors with adhesive yh t805 on the blade root blade mid span and blade tip regions respectively as shown in fig 2 the blades are made of carbon fiber with a specific manufacturing procedure to limit the blade mass while not smearing the scaling law requirements in modern commercial wind turbines the blades are usually made of composite materials chen et al 2019 li et al 2020 the current study only reproduces the geometry of the prototype turbine blade but cannot match the material and the mechanical property at present note that fbg 3 is thought to experience marginal mechanical strain because it locates at the blade tip consequently fbg3 only serves as a temperature compensator to provide reference information for fbg1 and fbg2 in this paper in the following context only results of fbg1 and fbg2 will be presented to solve the signal transmission problem a dedicated forj structure is deployed on the nacelle fig 3 shows a detailed depiction of the forj structure it mainly consists of a rotor and a stator the former can rotate about the rotor axis and the latter is fixed with the stationary nacelle and is further connected to the signal processing unit to preserve space for the forj deployment the nacelle is designed as a double axis configuration as shown in fig 4 the dc motor was moved from the rotor shaft axis and a gear pair was deployed to guarantee the transfer of the mechanical power in addition the hub and the rotor shaft were made hallow to provide a passage for the fiber cable it should be noted that strict mass control is focused during the design and manufacturing of the nacelle a more detailed introduction and the preliminary performance tests of the fbg forj blading loading monitoring system are accessible in ref wen et al 2020 when conducting the signal capture the fbg sensors are connected to the forj with a fiber through the fc apc jumper and further to an sm130 optical sensing interrogator module interrogator sm130 works upon swept wavelength laser based measurement technology it covers the wavelength between 1510 nm and 1590 nm a wideband optical laser is lunched by the interrogator and then reflected by the fbg sensors the interrogator demodulates the fbg strain signal based on the reflected wave subsequently the captured fbg signal is recorded and processed by the signal processing unit that is developed dedicatedly the sampling rate is 1000 hz in the present study 2 3 fwt model the monitored target in the present study is the novel sjtu s4 fwt consisting of a three bladed horizontal axis wind turbine and a novel sjtu s4 floating platform sjtu shanghai jiao tong university s4 stepped short spar for shallow water the model wind turbine is geometrically scaled down from the nrel 5 mw baseline wind turbine jonkman et al 2009 with a froude scaling ratio of 1 50 the rotor radius is 1 26 m with hub height 1 8 m with respect to the still water line a coned tower is designed with carbon fiber to reproduce the practical shape of the prototype it is able to reproduce the unsteady blade tower interaction such as tower shadow effect the overall description of the model wind turbine is shown in fig 5 the model wind turbine is located on the sjtu s4 floating platform sjtu s4 is specifically designed for shallow water depth regions with a depth of 50 m 1 m in the model scale the target water depth is 100 m in full scale the sjtu s4 fwt model is transferred into the wave basin and is moored with customized mooring system to the sea bed as shown in fig 6 a dedicated wind generation system wgs is deployed to generate controllable driving wind fields the effective wind field area is 3 m 3 m which is able to cover the whole rotor swept area the wgs is composed of 16 individually controllable axis wind turbines in a 4 4 configuration it is able to generate different wind fields with varied wind parameters the wave generator is able to produce different regular irregular waves with different wave parameters besides different sea currents can also be generated to model realistic offshore environments more detailed introduction about the experimental apparatus is available in refs wen et al 2019d based on the present experimental apparatus the fwt dynamics under different environmental and operational conditions can be systematically investigated the blade loading characteristics are especially focused in the present study 3 results and discussion the blade loading of an fwt in the offshore environment is rather complicated depending on the rotor operating conditions such as the rotor speed and the blade pitch the driving wind field and the gravity and centrifugal forces in addition the excessive excitations induced by the wave and current also play essential roles in the blade loads in this part the characteristics of the fwt blade loading under different conditions will be tested and analyzed based on the developed experimental apparatus note that the blade pitch angle is fixed at zero throughout the study 3 1 preliminary calibration firstly a static test was conducted for the fbg forj sensing system to evaluate the sensitivity of the fbg responses to the external loading the blade was fixed to the supporting structure with bolts to perform as a cantilever external weight was applied near the blade tip in the windward leeward direction to induce fbg strains as shown in fig 7 the fbg strain represents a linear relation with respect to the external loading different fbgs present different sensitivity to the external loads a more detailed discussion is accessible in wen et al 2020 also a series of hammer tests are conducted to obtain the natural frequencies of the blades impacts are applied from the windward leeward and lead lag directions orderly results show that the first flap wise and edge wise natural frequencies are 27 0 hz and 22 4 hz respectively which are much higher than those of the full scale blade jonkman et al 2009 this mismatch is mainly caused by the vastly different stiffness of the model blade the full scale prototype also the mismatched mass distribution also contributes to the frequency distortion fortunately this mismatch is acceptable because the major objective of the current study is to reveal the dependency of blade loading on environmental and operational conditions in addition the aero elastic behavior is thought to be more predominant in a tlp type fwt but is marginal in spar type fwt systems goupee et al 2014 it should be noted that the fbg sensors present significant advantages in detecting the natural frequencies of model blade and tower structures the lightweight fbg sensor is suitable to mounted on the targets and can successfully escape the loading effect as for traditional sensors such as accelerometers the transducer weight is considerable when compared with the target mass leading to significant loading effect to smear the captured signal bang et al 2010 the responses of fbg strain under different rotating speeds in still air still water are shown in fig 8 rotor speeds from 10 rpm to 70 rpm are tested 40 rpm case is absent with 1min time series displayed for each case clear cyclic oscillations are observed in the time domain responses generally the 1p once per rotor revolution component dominates the energy of fbg strain signal coinciding with that observed in the corresponding frequency responses in fig 9 the 1p response increases with the rotor speed indicated by the larger peak value at 1p frequency in addition a non negligible response at 2p twice per rotor revolution frequency and marginal np components are also observed the harmonic responses can be partly contributed to by the nonlinear characteristics of the dynamic system such as the quadric correlation between the aerodynamic load and the apparent wind speed seen by the blade airfoil also the unexpected structural defects can be another cause such as the unbalancing of the turbine shaft fbg2 locating at the mid span blade seems to present a more dominant 2p response than fbg1 at the blade root similar information can also be clearly observed in the time series e g 10 rpm case fbg1 strain signal performs well as a sinusoidal function while fbg2 presents the characteristics of a dual sinusoidal signal in the frequency domain e g 70 rpm case the peak value at 2p frequency in fbg1 is about 20 of 1p response as for fbg2 however the response at 2p frequency is about 50 of that at 1p frequency note that under these rotating only cases the fbg strain is mainly generated by the gravity the centrifugal force the aerodynamic drag and some unexpected system vibrations herein the gravity serves as one of the 1p sources because its effective component in the fbg strain varies periodically with the azimuthal angle both centrifugal force and aerodynamic drag are proportional to the square of the rotor speed this quadratic nature potentially contributes to the increased 2p responses at a higher rotor speed to have a general evaluation on the blade loading the statistical analysis of the fbg strains are concluded in the box diagrams in fig 10 in the box diagram the 25th and 75th percentiles are denoted by the lower and top limit of the box respectively the vertical range of the box represents the interquartile range the middle line in the box indicates the median of the data set the short whiskers locating 1 5 times the interquartile range from the box top or box bottom represent the boundary for the normal data measured data beyond this range composed by the upper and lower whiskers are treated as outliers denoted as red markers in the figure the averaged value is also exhibited represented by a black circle to serve as the averaged fbg strain level generally fbg1 and fbg2 share a similar statistic performance with a difference in the magnitude the fbg strains are relatively small in the rotating only cases because the gravity and centrifugal forces are marginal due to the light weight of the blade structure in addition the aerodynamic drag is small because the relative speed between blade airfoil and still air is not too high it is found that the blade rotating speed has a little influence on the blade loads with a variation of the averaged values being less than 2με for different rotor speed cases however the fluctuation range of the blade loading amplifies to some extent as the rotor speed increases indicating that the blade loading gradually gets unsteady with increasing rotor speed almost all of the observed data locate in the interquartile range with only a few outliers appear in fbg1 for 10 rpm and fbg2 for 70 rpm fbg1 strain represents a better symmetry than fbg2 as for fbg1 the median locates at the middle of the box and is nearly coincident with the average value as for fbg2 strain however it is observed that the median locates lower than the average value indicating that the observed data distributes with slight asymmetry 3 2 blade loads in driving wind the rotating only case in section 3 2 is rather simple where neither wind nor wave excitation is applied in the practical operating conditions however the wind loading performs as one of the most dominating external excitations especially for the fwt that is featured with stronger winds in offshore environments in this section the performance of the blade loading in driving wind is investigated and discussed the fwt operates in a driving wind speed of 1 88 m s with different rotor speeds the driving wind is generated by the dedicated wind generation system wgs as shown in fig 6 note that no wave is applied in this part to focus on the role of driving wind the responses of the fbg strain signals in driven wind are displayed in the time and frequency domains as shown in fig 11 and fig 12 respectively to focus on the influence of the wind loading these results should be analyzed compared with results under rotating only cases as shown in figs 8 and 9 again 1min time series are provided for each rotor speed in fig 11 once the driving wind is introduced the fbg strains are apparently increased in magnitude due to the amplified aerodynamic loading similar to the rotating only case clear np components are observed in the frequency spectra the 1p component occupies considerable energy in the fbg strains with the peak value at 1p increasing with the rotor speed it seems that the additional wind loading tends to excite more np response components especially at high rotor speeds in the rotating only cases only 1p and 2p responses can be clearly detected as shown in fig 9 in the driving wind however 3p and 4p components gradually appear especially at rotor speeds higher than 40 rpm in fact the np n 2 responses are not totally unexpected on the one hand due to the defects of the wind generation system the generated wind field is not ideally uniform in space or purely steady in the time domain according to our calibration tests the turbulence intensity of the generated wind field is about 10 wen et al 2019d as the blade rotates in such a turbulent wind filed the rotational sampling effect is non negligible consequently the effective wind velocity acting on the blade is inherently fluctuating with significant responses appearing at np frequencies murtagh et al 2005 chen et al 2020 on the other hand the np n 2 responses can also be partly induced by the nonlinearity of dynamic system and the undesirable structure defects the model wind turbine is a highly integrated coupling system and the dynamic system is inherently nonlinear the unexpected unbalancing of the transmission subsystem such as the turbine shaft unbalancing and the defective operating of the mechanical components such as the couplings and the gears can also contribute to the non stationary np harmonics according to the reports of field tests these np harmonic responses in blade loads are commonly observed in a practical wind turbine system for example in the field test of ennis et al 2018 apparent np harmonic responses especially 2p 6p components were found in the blade bending moments the energy of 2p component is about 1 2 of 1p response in the collinear flow case it should be noted that even higher harmonics can also be observed in the frequency domain but only the responses in 0 5 hz are displayed here for the sake of conciseness and the higher hormonics are mainly introduced by the defective mechanical system which is out of the scope of present study the statistical analysis of the fbg strains in driving wind under different rotor speeds is depicted in fig 13 when the wind loading is introduced an apparent fbg strain is generated as indicated by 0 rpm case limited influence of the rotor speed is detected on the blade loading significant outliers are found under the driving wind cases when compared with the rotating only cases even in the wind only case 0 rpm non negligible outliers are observed because of the unsteadiness and non uniformity of the driving wind further more outliers are found in fbg2 than fbg1 indicating that the mid span airfoils present more dynamic characteristics than the blade root slight asymmetry is observed in the fbg strains but the asymmetry has been partly improved by the driving wind when compared with the rotating only case in fig 10 in addition to gravity centrifugal force and aerodynamic drag revealed in the rotating only cases additional aerodynamic loads are introduced by the driving wind more specifically additional downwind force thrust and torque wise force generating aerodynamic torque also act on the blades based on the comparison of figs 10 and 13 it is concluded that the wind loading dominates other excitations further the wind loading introduces an inclination angle especially pitch to the floating platform the altered equilibrium position of the floater changes the gravity and centrifugal performances and consequently alters the blade loading performance actually a static floater pitch is equivalent to an inclination flow in complex terrain kress et al 2016 the inclination flow tends to introduce more unsteady disturbance and subsequently more fatigue damages to the wind turbine structures wen et al 2018 3 3 blade loads in regular waves in addition to the wind loading the wave excitation also plays an essential role in the fwt dynamics and it is one of the most critical external excitations for fwts the blade loading performance in regular waves is introduced in this part followed by the irregular wave cases in the next part to thoroughly reveal the impact of incident wave five different regular waves are generated as shown in table 1 the sea state gets relatively severer from rw1 to rw5 with wave height increasing and wave frequency decreasing it should be noted that the fwt operates in an intense driving wind of 4 40 m s with a rotor speed of 50 rpm in these cases the corresponding fbg strain responses in the time and frequency domains are displayed in fig 14 and fig 15 respectively with the statistics concluded in the box diagrams in fig 16 when the incident wave additionally acts on the fwt the floating platform will be forced to oscillate around its equilibrium position in six degrees of freedom dofs correspondingly the blades will be led to oscillate cyclically perplexing the blade loading from mainly three aspects wen et al 2017 2018 firstly the accessional oscillation tends to introduce an additional relative velocity between the incoming wind and the blade airfoils altering the aerodynamic loading and the flow states of local blade airfoils although the induced wind speed is symmetric a net dc offset in the blade loading will still be generated due to the nonlinear relationship between blade loading and effective wind speed secondly the blade is guided to advance into and then retreat from its own wake resulting in rather complicated blade wake interactions which further smearing the blade loading performance thirdly the changed floater orientation tends to transform the effective components of gravity and centrifugal forces on different directions of the fwt blade loads for example an increased platform pitch means a larger gravity component in the flap wise direction when the blade pointing upward 0 azimuth in addition it should be noted that the unexpected platform oscillation will introduce increased loading effect to traditional sensors resulting in reduced accuracy and reliability of the captured data however the fbg sensor is not smeared due to its extreme lightweight which is one of the most important advantages for the developed fbg forj blade load sensing system the driving wind speed significantly impacts the blade loading as the driving wind increases from moderate fig 11 to strong fig 14 the averaged fbg1 strain for 50 rpm increases from 20με to 35με as shown in the frequency domain responses in addition to the dominant 1p response and its harmonics an apparent response at the wave frequency is observed as denoted by 1w as the wave height increases the frequency of the incident wave moves towards the low frequency the np components seem to be insulative to the incident regular wave because they are majorly induced by the blade rotating and driving wind the box diagram in fig 16 indicates that the average blade loading presents an increasing trend as the sea state gets severer under the excitation of a regular wave the floater tends to experience cyclic oscillations which will introduce cyclical fluctuations to the relative wind speed and the resultant blade loading when averaging the blade loading in a time interval a dc offset will be derived due to the quadric relationship between the blade loading and the effective wind speed the larger the floater oscillation especially surge and pitch is the larger the dc offset will be in our prior numerical investigations it was found that the average rotor thrust and power output increase as the platform surge and pitch oscillations become severer wen et al 2017 2018 the reduced frequency was defined to quantitatively describe the influence of platform oscillation on the averaged rotor thrust and power output the increased average blade loading in a severer wave is coincident with our prior numerical results and both results verify each other qualitatively compared with the moderate wind still water cases in fig 13 much more outliers are observed in fig 16 the increased driving wind contributes more unsteadiness and uncertainty to the blade loading and the additional wave excitation further amplifies the dynamics resulting in more outliers in the blading loading it is anticipated from the increased unsteadiness and uncertainty that the fwt structures especially the blades are exposed to an increased risk of fatigue damages 3 4 blade loads in irregular waves in real offshore environments sea wave is usually irregular due to the randomness and unsteadiness of the sea state to complete the discussion the blade loading characteristics in irregular waves are introduced in this part two general irregular waves are included in this part as summarized in table 2 two sets of load cases are designed as shown in table 3 the first set lc1 lc2 lc3 lc4 is featured with different wind current rotor operating conditions in given irregular wave irw1 the second set lc2 lc5 is designed to reveal the influence of different irregular waves the power spectral density psd responses of the fbg strain signals in a given irregular wave but with different wind current and operating conditions are provided in fig 17 as for lc1 wave only parked an irregular wave with h s 14 0 cm and t p 1 56s is generated to serve as the sole external excitation a considerable portion of the response energy is occupied by the low frequency band which is associated with the low frequency floater oscillations especially a clear local peak is observed at the floater pitch natural frequency denoted as f p in the figure it is associated with the platform pitch resonance induced by the second order difference frequency wave loads the blade loading will feel the floater pitch resonance vibration through the altered relative wind speed and the distorted floater gesture in addition a response at the wave frequency is observed which is denoted as 1w in the figure it is mainly excited by the linear wave loads note that np harmonics at higher frequency that is caused by the imperfect mechnical system is not shown in the figures as the driving wind is introduced and the blade rotates in lc2 responses across almost the whole frequency band are amplified when compared with lc1 the only exception is at the natural frequency f p the additional aerodynamic excitation seems to suppress the pitch resonance vibrations indicating that the aerodynamic loading mainly serves as an equivalent damping in the floater pitch motion goupee et al 2014 although the aerodynamic loading increases the averaged floater pitch the corresponding dynamic oscillation is mitigated due to the aerodynamic damping effect the low frequency response except f p is increased which is partly contributed by the low frequency aerodynamic load significant np responses are observed due to the excitation of blade rotating and the system nonlinearity as the driving wind increases from lc2 to lc3 the wave frequency response is not clearly altered but the np components and high frequency responses are amplified these increased responses can be partly caused by the amplified aerodynamic loads and the increased asymmetrical floater deployment such as the floater pitch and yaw as the current is further acting on the fwt in lc4 the wave frequency is generally maintained with the no current case in lc3 however the np responses are partly suppressed when compared with lc3 it should be noted that the aerodynamic loading is imposed at a high elevation generating a pitch angle to the fwt oppositely the current load acts at a very low elevation which serves to push the fwt back to the vertically upright deployment consequently the non uniformity and asymmetry induced by the aerodynamic loading will be relatively mitigated by the current loads which majorly account for the reduced np responses in lc4 than lc3 from this point of view the current seems to protect the fwt structures from the unsteady uneven loads and the resultant fatigue damages induced by the wind loading however it should be noted that if the acting point of the current load is higher the platform pitch angle can be further amplified by the current loads also the current loads will generate significant sway and roll motions due to the apparent vortex induced motions especially as for the spar type fwts although the excessive sway and roll oscillations have marginal influences on the blade loads the fbg strain responses under two different irregular waves are exhibited in fig 18 the driving wind and rotor speed are maintained for these two cases as the wave height is increased from lc2 to lc5 the low frequency responses are amplified due to the increased low frequency floater oscillations also the wave frequency response 1w is increased and the characteristic frequency band transfers towards the low frequency direction the high frequency responses especially the np components are not clearly affected by the incident irregular wave generally the blade loading is increased in the severer irregular wave irw2 in both averaged blade loading and its corresponding load fluctuation the increased blade dynamic loads are detrimental to the structure safety increasing the risk of blade fatigue and failure to mitigate the blade dynamic loads novel fwt control strategies have been proposed herein the individual blade pitch control is among the most popular ones namik and stol 2010 bossanyi 2003 the frequency response of the blade loading provided here has the potential to help improve the controller performances for example it guides the designer to properly deploy the natural frequency of the controller which is of considerable significance because an incorrect controller frequency can result in unexpected fwt dynamics jonkman 2008 larsen and hanson 2007 4 conclusions knowledge about the blade loading characteristics is of considerable significance for a floating wind turbine fwt especially for the fwt optimization and advanced controller development in this study we developed a dedicated blade loading sensing system for a model fwt based on fiber brag grating fbg and fiber optical rotary joint forj focusing on the blade loading performance we conducted systematic experimental tests for the novel sjtu s4 fwt in the wave basin under different environmental and operational conditions from the experimental results and discussion in the previous sections the following conclusions are drawn 1 it is feasible to monitor the blade loads for fwts in wave basin model tests with an fbg forj sensing system as long as the sensing system and nacelle structure are carefully designed and manufactured the weight and inertia can satisfyingly meet the scaling laws equipping an forj on the nacelle can guarantee reliable signal transmission from the rotating blades to the stationary signal processing unit the fbg forj sensing system in the current study can be enlightening for researchers to optimize the model fwt and to develop fwt controllers at the model scale 2 gravity centrifugal force and aerodynamic loads play significant roles in the fwt blade loading 1p once per revolution component and its np harmonics appear in the blade loading signals the np harmonics are mainly introduced by the nonlinear nature of the fwt system and the undesired defects of the fwt model test system more np harmonics are exhibited at a higher rotor speed 3 the aerodynamic loading generated by the driving wind dominates the external excitations for an operating fwt as the driving wind increases the fwt blade loading amplifies significantly in both magnitude and fluctuation further the wind induced inclination of the floating platform alters the performance of gravity and centrifugal forces on the blade loads 4 the incident wave introduces an apparent response at the wave frequency in the blade loads as the sea state gets severe the fwt blade loading increases in both average and fluctuation which potentially introduce more fatigue damages to the fwt blades improving the floater stability is beneficial to mitigate the static and dynamic loads of fwt blades 5 if the acting point of the current load is low enough the sea current will perform to eliminate the floater inclination that is mainly induced by the driving wind and subsequently mitigates the unsteady blade loads however the current induced roll and sway motions of the floater is detrimental for the fwt system note that the current study is among the first attempts to reveal the fwt blade loading behaviors which is potential helpful for further fwt controller investigations with experimental tests the fwt blade loading is a rather complicated issue especially in the wave basin model test the fwt itself is a highly integrated complex system consisting of several subsystems the blade loads are significantly impacted by the external environmental excitations as well as the internal disturbances the current study only serves as an initial experimental assessment on the fwt blade loading characteristics the future work will focus on constructing higher accuracy test facility and conducting more extensive tests afterwards the fwt pitch controller dynamics and the controller floater interaction will be experimentally evaluated credit authorship contribution statement binrong wen conceptualization formal analysis validation writing original draft zhanwei li software writing review editing zhihao jiang resources data curation xinliang tian project administration methodology xingjian dong funding acquisition supervision zhike peng funding acquisition supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is financially supported by the national natural science foundation of china grant no 11632011 11572189 and 11872243 and natural science foundation of shanghai grant no 19zr1426300 
22074,in this paper we present a geometric parametric model that has been mainly designed to accommodate the need for an appropriate analysis model in the context of isogeometric analysis iga 1 but can be also employed as a universal tool for reconstructing and representing a wide range of different airfoils and or hydrofoils families this model is an extension of the parametric model employed in optimization of hydrofoils efficiency with the aid of an isogeometric boundary element method solver iga bem presented in 2 apart from its apparent use in design evaluation and optimization the parametric model can be further employed in a wider range of relevant applications specifically in this work we begin by demonstrating its use as an alternative approach in efficiently reconstructing airfoil and hydrofoil shapes from large sets of points appearing mainly in the context of reverse engineering applications this is further investigated and the parametric model s performance in accurately representing existing airfoils is extensively benchmarked against results from pertinent methods and approaches followed in the aeronautics and aerospace research community finally we demonstrate the use of the parametric model in a foil shape optimization problem we conclude this work with a discussion on future enhancements and possible research directions keywords parametric model nurbs airfoils shape optimization reconstruction inverse design 1 introduction the performance of various marine structures depends on the hydrodynamic properties of appendages operating as lifting devices as e g keels rudders stabilizers propellers water turbines etc as a general statement the performance of these lifting devices is greatly affected by their shape and even small variations may have a significant impact in this context the development of optimization strategies coupled with efficient computational fluid dynamics solvers and appropriate parametric geometric modeling techniques employed in the design optimization of lifting appendages and thrust generating devices is highly desirable a robust parametric geometric model plays a key role in the optimization process and many parametric models have been already developed in this context parametric models commonly employed in isogeometric analysis applications use b splines or nurbs for the geometry representation and their control points and weights are typically considered the model s parameters see e g nguyen et al 2012 nørtoft and gravesen 2013 li and qian 2011 lian et al 2013 however this approach is not very efficient and convenient from an engineering point of view since control point positions and weights have rarely any physical meaning in this connection there have been works e g kostas et al 2015 2017 kostas et al 2015 2017 and ginnis et al 2013 ginnis et al 2013 in which high level parameters with a direct design physical meaning have been introduced to relevant parametric models and employed for the generation of shape instances thus the control points of the underlying geometric representation and the inherent complexity of free form shapes are hidden from the user and are indirectly controlled by these high level parameters in general parametric models comprise a list of exposed external and internal parameters devised on the basis of the general shape that needs to be produced exposed parameters are accessible to the user of the parametric model and initiate the modeling process leading eventually to a corresponding shape instance on the contrary internal parameters are not accessible to the user and are kept for developer s use as means to internally control the shape construction process and retain the basic shape characteristics constraints of the instantiated object furthermore a domain of variation is assigned to each parameter assuring the modeling robustness while at the same time avoiding invalid geometrical models as e g self intersections in this context parametric models favor the use of non dimensional parameters where possible in order to avoid the interdependency between them exposed parameters are roughly categorized in two groups global and local according to whether their effect in shape design is of global nature e g object s main dimensions or of local nature in the sense that they affect locally limited shape s details in this way global variations induced by a small set of global parameters combined with local changes implied by local parameters typically applied in hydrodynamic optimization processes illustrate the applicability and powerfulness of the parametric design methodology the parametric model presented here was mainly built to accommodate the specific needs of design optimization with the aid of isogeometric analysis solvers hence apart from the common requirements posed for generic airfoil hydrofoil parametric models some additional constraints were considered in its development specifically we aimed at a model that satisfies the following set of criteria the developed parametric model uses a small number of parameters that limits the dimensions of the design space possesses parameters with physical meaning widths angles lengths etc which allow users to easily assign values to parameters uses a small number of control points for representing the foil this becomes even more significant when foils are used in the construction of higher level 3d entities such as blades or wings provides an accurate geometrical representation i e it can reconstruct existing airfoils with minimal deviation uses basis functions in its spline representation which are appropriate for the representation of physical quantities velocities pressures etc within the isogeometric analysis solvers developed in kostas et al 2017 and chouliaras et al 2017 2019 kaklis et al 2018 both solvers employ a nurbs representation of the body geometry and hence this constitutes an additional constraint for the development of the model generates shapes that do not exhibit undesirable oscillations self intersections superfluous inflections points or any other type of shape anomaly that would hinder its use with an isogeometric solver although the development of the presented model was performed under this special set of constraints we consider that it has reached a level of maturity that allows it to be also employed for reconstructing and representing accurately and robustly a wide range of airfoils and hydrofoils families while producing comparable results to the more general methods for airfols hydrofoils parametrization such as the ones examined in the comprehensive reviews by masters et al 2016 2017 the construction process for our parametric model is presented and discussed in section 2 the model is materialized both within rhinoceros programming environment robert mcneel associates and rhino 5 for windows 2018 and matlab the mathworks inc and matla 2016a and constitutes an extension of the parametric model developed in kostas et al 2017 which generated hydrofoils as closed cubic b spline curves via a set of eight parameters in this work we have increased the number of external parameters to eleven and later fifteen non dimensional ratios aiming at an increase of the model s approximation power and coverage of the foil design space note that the number of employed parameters can be reduced to just five or seven for the latter case when dealing with symmetric foils as we will discuss in 2 this set of parameters is employed in the generation of the two foil sides via four simple cubic bézier curves which are then merged in the construction of the final cubic b spline curve representing the complete foil shape in this work we initially demonstrate the parametric model s performance in shape reconstruction from large foil point sets followed by a more extensive investigation of its capabilities in efficiently representing existing families of airfoils and hydrofoils a foil shape constrained optimization example is used afterward to demonstrate the model s use in an optimization framework and its capacity to efficiently explore the design space specifically in section 3 1 the parametric model s approximating capacity is demonstrated by reconstructing the shape of common foils from given large and medium sized point sets the approximation process can be accomplished through the solution of a minimization problem which determines the parameter values for the corresponding parametric model instance the performance of the parametric model is then compared with other general purpose approaches namely two fitting algorithms of rhino robert mcneel associates and rhino 5 for windows 2018 rebuild and fitcrv and a general point set approximation method based on discrete curvature and knot insertion heuristics proposed by li et al 2005 li et al 2005 our parametric model can achieve one order of magnitude better approximating accuracy for the same number of control points when compared with rhino s rebuild command and li et al 2005 method for the case of rhino s fitcrv command our approximating accuracy is equivalent or slightly worse but fitcrv requires a significantly larger number of control points rhino among other more ship industry specific cad packages has been commonly used in naval architecture and marine engineering due to its flexible tools for generating free form curves and surfaces which justifies our selection as a benchmark tool in this context section 3 2 presents a more thorough examination of our model s representation capabilities and compare its performance against the more general airfoil parametrization approaches employed in pertinent literature specifically following the comprehensive reviews by masters et al 2016 2017 we compare our model against 7 different airfoil parametrization methods for 5 specific airfoils rae 2822 naca 4412 onera m6 nlr 7301 and naca 66 3 418 investigated therein our comparisons conclude by examining the model s capacity to represent an extended database of naca family airfoils within an appropriate geometric tolerance and how our results compare against the coverage achieved by the other methods for the same database the parametrization methods examined in masters et al 2016 2017 are categorized as either constructive when the airfoil shape is generated on the basis of the employed parameters or deformative when a reference airfoil shape is deformed to produce the sought for shape constructive methods include 1 b splines or nurbs fitting methods see e g braibant and fleury 1984 bisson and nadarajah 2015 sherar et al 2007 2 class shape function transformations cst kulfan and bussoletti 2006 kulfan 2008 3 singular value decomposition svd see e g toal et al 2010 ghoman et al 2012 poole et al 2015 and 4 parametrized sections parsec sobieczky et al 1999 deformative methods include 1 hicks henne bump functions hicks and henne 1978 2 bézier surface free form deformation ffd method sederberg and parry 1986 and 3 the radial basis function domain element rbf de approach rendall and allen 1519 morris et al 1002 all of these methods are further described in 3 2 and masters et al 2017 finally in section 4 the robustness design flexibility and design space exploration capacity of the parametric model is demonstrated in a series of foil shape optimization problems in our examples we aim in minimizing the ratio of drag over lift coefficients and constrain or minimize the deviation of foil s area from a reference area the lift and drag coefficients are calculated using the well known xfoil drela 2018 computational package while the optimization process is mainly driven by genetic algorithms we conclude this work by briefly presenting some future model extension possibilities and potential applications in the area of forward and inverse design problems 2 the airfoil hydrofoil parametric model construction the parametric model for a general hydrofoil and or airfoil presented in this work is an extension of the parametric model developed in kostas et al 2017 and employed in the shape optimization of hydrofoils with the aid of an isogeometric analysis boundary element method iga bem solver the model presented in kostas et al 2017 generates a closed cubic b spline curve via a set of 8 parameters the employed parameters were defined as appropriate non dimensional ratios lying always in 0 1 which allows the elimination of complex interdependent constraints and enhances the robustness of the model the same approach of non dimensional ratios employed as parameters is also followed in the present work along with the inclusion of some additional parameters which enrich the space of produced shapes apart from the different set of parameters employed in these two parametric models their major difference lies in the way the foil shape is generated in kostas et al 2017 the set of parameters was used for generating the foil s upper side suction side and its camber curve then the lower side pressure side was constructed by appropriately mirroring the upper side about the camber curve and finally the two sides were merged into a single cubic b spline curve representing the foil instance in the present work the parameters are directly employed in the generation of the two foil sides and no intermediate camber curve construction step is required this approach slightly increases the number of required parameters but has a twofold benefit since it enriches the design space covered by the parametric model and reduces the required number of control points in the final curve the parameters employed in the parametric model are presented in table 1 along with their definitions and ranges of their dimensional counterparts let us note here that the foil s chord length l is used for non dimensionalization the coordinate system s origin is considered at foil s leading edge point and the longitudinal axis coincides with the chord line having the positive direction towards the trailing edge hence the ordinates of foil s upper side are always non negative while the lower side values can be either negative or positive according to the foil s assumed camber a foil parametric model instance with l 1 and design vector parameter values v v i i 1 11 equal to v i 0 5 i 1 10 v 11 0 1 is depicted in fig 1 let us also note here that for the case of symmetric airfoils five parameters 1 1 upper or lower side parameters the angle at leading edge a will be fixed and equal to 0 see table 1 are sufficient for the representation since all the others can be directly derived through them the foil s contour is represented as a nurbs curve of order k degree equals k 1 defined as follows 1 c u v x u v y u v i 0 n b i v r i k u u t k 1 t n 1 0 1 where r i k u i 0 n is the rational b spline basis of order k defined over a knot sequence j t 0 t 1 t n k and possessing non negative weights w i i 0 n while b i v are the associated control points depending on the parameter vector v see e g piegl tiller piegl and tiller 1997 therefore b i v b i x v b i y v i 0 n are the functions mapping the design vector of parameter values v to the control points coordinate space in this work we assume that k 4 n 12 and all weights are equal to one which reduces the general nurbs representation see eq 1 above into a cubic b spline curve the parametric model s construction is based on the definition of four simple cubic bézier curves that are employed in the generation of the final cubic b spline curve each side of the foil upper and lower side comprises two segments one for the fore part and the other one for the remaining aft part see fig 1 for the fore part of the upper side the first control point b 0 is placed at 0 0 while the last one b 3 is at x u max u max the first interior point lies on the line segment defined by 0 0 and tan a u max u max while the second one on the segment defined by tan a u max u max and x u max u max the exact position of these points is controlled by the tip u shape parameter that dictates the shape fullness of the leading edge specifically 2 b 1 tan a u max u max tip u and 3 b 2 x u max tip u x u max tan a u max u max we may also visualize the construction of these two interior control points i e b 1 and b 2 through the introduction of point p see upper left part in fig 1 as the intersection of lines y u max and y tan a x in this case b 1 and b 2 can be defined as the convex combinations of b 0 p and b 3 p respectively i e b 1 b 0 tip u p and b 2 b 3 tip u p the aft part of the upper side is another cubic bézier segment adjacent to the fore part which stops at the trailing edge point i e at b 6 l 0 its interior control points are positioned as follows 4 b 4 x u max s u max u and 5 b 5 l max u tan a b u max u if l max u tan a b u x u max s u x u max s u tan a b u l x u max s u otherwise control point b 5 corresponds to the intersection of lines y u max and y l x tan a b u when the inequality described in eq 5 is true and the intersection of x x u max s u and y l x tan a b u if the inequality is not true the collinear placement of b 2 b 3 and b 4 ensures the geometric continuity between the two bézier segments and makes b 3 the upper side s maximum thickness 2 2 with respect to chord point see fig 1 the construction of the lower side follows a similar approach with the only differences pertaining to a different angle range for a b l a reverse sign for angle parameter a and an appropriately 3 3 two cases need to be considered when a b l is above or below the chord line modified eq 5 for the corresponding point at the lower side specifically 6 b 12 b 0 b 8 x l max s l l max 7 b 11 tan a l max l max tip l 8 b 10 x l max tip l x l max tan a l max l max 9 b 9 x l max l max and if a b l is below the chord line 4 4 negative value in table 1 10 b 7 l max l tan a b l max l if l max l tan a b l x l max s l x l max s l tan a b l l x l max s l otherwise else 11 b 7 l max u tan a b l max u if x u max s u x l max s l x l max s l tan a b l l x l max s l otherwise the 4 bézier curve segments can be finally merged into a single b spline curve with the introduction of k 1 coincident knots at segments joints specifically if we assume a clockwise traversal direction starting from the leading edge point the final b spline curve s control points will be ordered as shown in fig 1 i e b i i 0 12 and the corresponding knotvector can be then set to u 0 0 0 0 1 4 1 4 1 4 1 2 1 2 1 2 3 4 3 4 3 4 1 1 1 1 the foil parametric model described above has been implemented in both rhino3d robert mcneel associates and rhino 5 for windows 2018 with the aid of rhinoscripting and matlab the mathworks inc and matla 2016a programming environment model s implementation in rhino supports a gui that allows interactive manipulation of parameter values and an automatic update of model instances the user can easily acquire a good approximation of the foil in question by importing an input point set and manipulating the parameter values interactively in order to overlay the generated parametric model instance on the imported point set obviously if high accuracy in the approximation is required this can be accomplished through the solution of a corresponding optimization problem which is an already built in feature in both implementations the optimization problem comprises a minimization of the curve point set deviation and is defined as follows 12 min v i 1 m c u i v v p i 2 subject to 0 v i 1 i 1 11 where p i i 1 m are the m input points and u i are the b spline instance s parametric values that correspond to the perpendicular projections of p i on c u v this minimization problem can be easily solved with the aid of matlab s optimization toolbox the mathworks inc and matla 2016b and specifically a deterministic algorithm such as the interior point algorithm byrd et al 1999 implemented in matlab s fmincon function the running time 5 5 using an entry level pc is limited to few seconds when a good initial estimation of the parameter vector v is provided and will not generally exceed 60 s even for starting points far from the optimum in the context of an evaluation process the authors have systematically examined foils from uiuc airfoil database applied aerodynamics 2018 and national renewable energy laboratory website national renewable enery laboratory 2018 and generated a database 6 6 the web version of this database will soon become publicly available at http amrg nu edu kz soltiga comprising the parametric models of more than 1300 of the most common naca and nrel foils 3 the approximation power of the parametric model in this section we examine the approximation and representation capabilities of the developed parametric model we begin our discussion by examining its applicability in a more general setting where points commonly of large numbers are supplied as a result of scanning and or other similar measuring processes an existing body geometry and we are required to efficiently reconstruct the body geometry these point sets are commonly polluted with noise and generally deviate from the idealized airfoil shape descriptions specifically in 3 1 we test and compare the efficiency of our model against a general b spline curve approximation method employed in reconstruction applications along with some relevant commonly available tools within a typical cad package the next step in our examination deals with the model s capability in generating accurate curve representations for existing airfoil families defined by their corresponding equations and or accurately calculated point sets although our model was developed to mainly facilitate the requirements of some specific isogeometric analysis solvers see relevant discussion in 1 which may obviously hinder the development of a successful general purpose foil parametrization method we feel that the reader will be interested in comparing our model s performance against established methods used in airfoil design and parametrization literature in section 3 2 we attempt to accomplish this by benchmarking our model against 7 well studied airfoil parametrization methods appearing in masters et al 2017 3 1 shape reconstruction in reverse engineering applications shape reconstruction of a given body described by a large point set is one of the most common problems in most cases the provided point sets are usually polluted with measurement noise which hinders significantly the reconstruction process an additional burden appears in the case of bodies like turbine propeller blades hydrofoils airfoils and wings in which an accurate representation of the geometry is extremely important since their performance is very sensitive and strongly dependent on the underlying geometry in many cases researchers and practitioners attack the problem using a b spline approximation approach where the major question lies in the selection of the proper number of control points and parametrization i e knotvector this is a well known problem and researchers have applied several approaches including but not limited to knot insertion modifications hölzle 1983 exploitation of discrete curvature and heuristics li et al 2005 general non linear optimization dung and tjahjowidodo 1371 and machine learning laube et al 2018 moreover noise can be a significant problem and usually a smoothing approach is introduced where a low pass filter is employed to cut off data noise in this section we will provide examples demonstrating the successful usage of the parametric model in reconstructing efficiently and accurately foil shapes from large point sets the use of the parametric model guarantees a constant low number of control points in our case thirteen control points and eliminates the problem of determining an appropriate knotvector for the approximating b spline curve furthermore the determination of the parameter values is fast and robust in the sense that inappropriate behaviors such as self intersections and oscillations are excluded by design and the model is generally immune to noise on the other hand our proposed approach cannot be considered as a general shape approximation reconstruction method since it is obviously only applicable to foil looking shapes nevertheless as examples indicate it is a very promising approach for this particular area the presented examples correspond to four different common foil shapes nacas 4412 65a010 7 7 meanline type naca a 0 8 thickness type naca 65a010 and 6410 and eppler 335 which are used in aeronautical and marine applications point sets for nacas 4412 and 6410 were acquired using the standard equations for cambered 4 digit naca while points for naca 65a010 were extracted from openprop software package which is a free software used for the design and analysis of marine propellers and horizontal axis turbines see epps et al 2009 epps 2016 epps and kimball 2013a 2013b finally the point set for eppler 335 has been acquired from airfoiltools online database 8 8 http airfoiltools com airfoil details airfoil e335 il in this work we are interested in investigating the parametric model s approximating performance in comparison to other common reconstruction approximation approaches to this end we benchmark the parametric model s performance against three different approaches namely the implementation of an approximation method based on discrete curvature and a knot insertion heuristic presented in li et al 2005 and rhino s robert mcneel associates and rhino 5 for windows 2018 rebuild and fitcrv commands rebuild command reconstructs a curve or surface to a specified degree and control point number producing a generally uniform knotvector while fitcrv creates an approximation of a given curve to within a user specified tolerance in all examples rebuild and fitcrv where applied to the point set interpolant in the first example we generated and used a point set for naca 4412 comprising 495 points the approximation results obtained by the proposed parametric model and li et al s knot insertion method are depicted in fig 2 the corresponding numerical results for all approaches are presented in table 2 it is easy to see that the parametric model approach manages to achieve a very good shape approximation and a maximum distance of less than 10 3 length units with only 13 control points a slightly better accuracy level is only achieved by rhino s fitcrv command which however requires more than double the number of control points the method of li et al see upper graph in fig 2 does not perform well in this case and exhibits a high concentration of control points at the mid area of foil s lower side which is due to discrete curvature s oscillations about zero in this area this is a clear indication of this method s sensitivity to any type of noise in order to overcome these artificial oscillations we recomputed naca 4412 foil points with a higher numerical accuracy the new point set is denoted as naca4412f and the new approximating curve is depicted at the bottom part of fig 2 this time li et al s method performs significantly better as the number of required control points drops to 9 with no unnecessary concentrations but still the deviation is higher compared to the parametric model instance as a further improvement step for li s method we modified the employed heuristic by halving the critical angle used in characterizing small deflection locally now the employed control points increase to 13 but nevertheless the achieved deviation is still higher when compared to the parametric model s achieved accuracy level see table 2 4th row as a final note we can clearly see from table 2 that rhino s rebuild command is the worst performer with respect to the achieved deviation level the results for the remaining three examples nacas 65a010 and 6410 and eppler 335 follow more or less the same pattern fitcrv command achieves the best approximation but requires double the number of control points when compared to the other methods the proposed parametric model achieves the best approximation next to fitcrv command but uses a significantly lower number of control points the method of li et al requires slightly more control points 9 9 13 18 for the specific examples but the approximation accuracy is worse in all cases and finally rebuild is constantly achieving the worst results with respect to point set deviation the approximating curves for the two nacas foils are depicted in figs 3 and 4 and the corresponding numerical results are presented in table 2 rows 7 to 14 finally the approximating curves for eppler 335 are depicted in fig 5 and the numerical results once again in table 2 rows 15 to 18 the examples presented in this section show that the parametric model approach is a viable alternative when considering shape reconstruction of foil shaped bodies the obvious benefit of data reduction becomes even greater when this approach is employed in the reconstruction of 3d bodies such as propeller and turbine blades from foil sections additional benefits are gained when performing analysis following the isogeometric analysis iga paradigm hughes et al 2005 which allows accurate results from smooth analysis models with reduced number of degrees of freedom control points hence avoiding the unnecessary and time consuming use of meshes and geometrical representations with superfluous control points finally this gain in the analysis phase has a significant multiplicative effect on design shape optimization with iga solvers as it has been already demonstrated in kostas et al 2015 2017 and kostas et al 2018 3 2 comparison to other airfoil parametrizations as mentioned in the beginning of 3 we will demonstrate in this subsection the performance of the developed parametric model in comparison to the approaches examined in masters et al 2017 for comparison purposes we employ a modified version of the typical wind tunnel tolerance or kulfan tolerance defined in kulfan and bussoletti 2006 as 13 z e r r o r 4 10 4 if x c 0 2 8 10 4 if x c 0 2 where c denotes the airfoil s chord length and x the x coordinate of the corresponding point specifically we adopt the modification suggested in masters et al 2017 which involves an inflation of the computed error when x c 0 2 by doubling it hence eq 13 can be written as 14 z ˆ e r r o r 8 10 4 x which is the exact same typical bound used for measuring geometric accuracy in masters et al 2017 and throughout this paper the airfoil parametrizations and representation methods included in this comparison are as follows 1 b spline cos a least squares high order b spline fitting of points for each side of an airfoil with cosine spacing for the spline s control points in the longitudinal direction see masters et al 2017 this method belongs in a wider category of methods employing nurbs representations where the control points weights and knots are used as design variables see e g braibant and fleury 1984 bisson and nadarajah 2015 sherar et al 2007 2 cst class shape function transformation method developed and described in kulfan and bussoletti 2006 kulfan 2008 this approach mainly involves the modification of a foil like function via a shape function comprised by a linear combination of relatively high order bernstein polynomials see kulfan 2008 3 svd singular value decomposition method extracting orthogonal basis modes from an appropriately prepared set of training airfoil shapes an arbitrary airfoil is then generated as a linear combination of these modes see toal et al 2010 ghoman et al 2012 poole et al 2015 for the general approach and masters et al 2017 for the specific implementation used herein 4 parsec method introduced by sobieczky in sobieczky et al 1999 parsec utilizes a 6 th order polynomial for each airfoil side which is determined by satisfying a set of 12 geometric constraints that constitute the method s design variables a significant advantage in this approach is the physical meaning that can be given to these variables and thus allow a designer to assign meaningful values 5 hicks henne bump functions approach modifies a base airfoil shape by a number of parameterized basis functions bump functions see hicks and henne 1978 for the general approach and masters et al 2017 for the specific implementation used herein 6 bézier surface free form deformation this approach was introduced by sederberg and parry in sederberg and parry 1986 and deforms a prototype airfoil shape by embedding it in a planar bézier surface and modifying the surface s control points the number of control points rows determine the variants 3 and 4 row bézier surfaces presented in masters et al 2017 7 radial basis function domain elements rbf this is another shape modification approach like the bézier ffd above which is however based on a deformation field defined by radial basis interpolation contrary to previous case the positions of rbf control points are not constrained on a fixed lattice structure this provides some additional flexibility on the expense of an additional optimization procedure to determine their number and appropriate positions for the application at hand the rbf formulation employed in masters et al 2017 is according to rendall and allen rendall and allen 1519 and its use as a parametrization technique has been presented in morris et al 1002 we begin our comparison by testing our model s achieved accuracy for five airfoil shapes examined in detail in masters et al 2017 specifically these include rae 2822 naca 4412 onera m6 nlr 7301 and naca 66 3 418 our primary aim in this first step is to demonstrate that a representation with an accuracy less or equal to the modified kulfan tolerance see eq 14 above can be achieved the reconstructed shapes for these five case studies is depicted with dashed lines in fig 6 unfortunately as it can be observed in table 3 std model column only naca 4412 and onera m6 can be reconstructed within the set wind tunnel tolerance the same failure can be also observed for the cases of naca 65a010 and eppler 335 included in table 2 however as one can observe from fig 7 for the cases of naca 66 3 418 and rae 2822 none or very few of the compared approaches can achieve a corresponding representation within the set tolerance for only 11 design variables contrary to most of the compared approaches our model was initially designed to use a fixed number of variables and in that sense resembled the parsec approach see sobieczky et al 1999 luckily an extension of our model to support additional parameters without sacrificing any of our primary objectives described in 1 is easily achievable as one can observe in eqs 2 and 3 and fig 1 control points b 1 and b 2 are both controlled by tip u similarly tip l controls the two first interior points of the lower side hence a rather obvious extension would be to split tip u in two parameters and employ these say tip u 1 and tip u 2 in controlling b 1 and b 2 independently in a similar fashion two variables tip l 1 and tip l 2 can be also used for determining the corresponding control points b 11 b 12 at the lower side this approach can be also applied for the control point pairs b 4 b 5 and b 7 b 8 that are controlled by s u and s l respectively hence if we also replace s u and s l with two independent variables for each of them we can increase the number of model s parameters to 15 while maintaining the same number of control points and all the other required properties for using the instances with our isogeometric solvers the allowable ranges for these new parameters are included in table 4 while the effect of substituting tip u and s u with the corresponding parameter pairs is depicted in fig 8 specifically in fig 8 the upper sides of an airfoil generated by the standard solid thick line and the extended model dashed line are depicted in the standard model b 1 and b 2 are linked to each other via tip u if for example b 1 is at the midpoint of b 0 p b 2 will be also at the midpoint of b 3 p splitting tip u in tip u 1 and tip u 2 allows to independently control the position of b 1 and b 2 as is shown with b 2 in fig 8 similarly the position of b 5 and b 4 can vary independently along their respective line segments b 6 b 5 and b 3 b 4 on the basis of s u 1 and s u 2 parameter values if we now recompute the approximations for the five airfoil cases we can see that the required kulfan tolerance is satisfied for all of them these new parametric model instances are depicted with solid lines in fig 6 and the achieved deviation is included in table 3 column ext model furthermore for the case of naca 66 3 418 as one can see in fig 7 our extended parametric model manages to reach kulfan tolerance approximation with very few variables 15 and only svd requires less however this picture changes when we examine the case of rae 2822 see fig 7 again in which our model exhibits an average to low performance since 4 out of 7 examined approaches reach the set tolerance with fewer design variables as it is obviously not possible to reach any conclusive results by simply examining few airfoil shapes we employed both our standard and extended parametric models in approximating the shapes within a large database of airfoils specifically this database comprises the naca 4 digit airfoils the remaining naca airfoils included in the uiuc database applied aerodynamics 2018 the nrel airfoils national renewable enery laboratory 2018 and several joukowski and karman trefftz shapes the total number of airfoil shapes in the database exceeds 1300 and includes all the naca shapes examined in masters et al 2017 the results of this extensive study are depicted in fig 9 along with the results of the seven other airfoil parametrization approaches one can easily see that our standard model 11 parameters succeeds in approximating within the modified kulfan tolerance around 75 of the database shapes while the extended version 15 parameters achieves full coverage this result demonstrates that our parametric model is capable to accurately approximate a large number of shapes while at the same time satisfying the requirements for its use with the developed isogeometric solvers as a matter of fact as one can easily observe from fig 9 our results are better when compared to the remaining approaches and only the svd method built on the basis of either the naca or uiuc databases achieves a better coverage 4 foil shape optimization in this section we present a shape optimization example that demonstrates the ability of the parametric model to efficiently and robustly cover a wide design space and its use in obtaining an optimized foil shape under specific geometric constraints for this example we consider a 1 m long foil profile which operates at an angle of attack of 5 o degrees in a flow regime with a reynolds number equal to 10 6 our goal is to maximize the foil s lift coefficient c l and minimize the drag coefficient c d under the constraint of minimum deviation a a 0 of the profile area a from a reference area a 0 in our example a 0 corresponds to naca 4412 profile area we begin by setting this up as a single objective optimization problem with a non linear constraint on the airfoil s area specifically 15 min v c d v c l v subject to a v a 0 ε where a 0 0 0819997 0 v i 1 i 1 11 where ε the allowable deviation from naca 4412 profile area obviously in this optimization environment the parametric model is used for the generation of foil instances that are evaluated with respect to the drag over lift ratio and their area deviation from the original naca 4412 profile lift and drag coefficients are assessed with the aid of the well known xfoil drela 2018 computational package which is commonly used in assessing the performance of subsonic airfoils and is based on the combination of a fast panel method with fully coupled viscous inviscid interaction see also drela and giles 1987 drela and mueller 1989 for the optimization process we have used several algorithms included in matlab s standard and global optimization toolboxes as we will discuss subsequently initially gradient based methods were employed specifically matlab s fmincon function with interior point byrd et al 1999 and sequential quadratic programming sqp algorithms have been explored unfortunately starting from an initial design vector that corresponds to naca 4412 shape causes interior point to diverge or fail to satisfy the non linear area constraint the sqp option is more robust and although it converges to a solution that satisfies the area constraint it does not produce any significant improvement to the drag over lift ratio to this connection it was realized that there are large areas in the design space where the objective function i e c d c l as a function of the design vector v is highly oscillatory which leads gradient based algorithms to either fail or output sub optimal results this is demonstrated in fig 10 in which the design vector has been fixed to correspond to naca 4412 representation and parameters a b u and tip u were allowed to vary in their intervals of definition see table 1 this behavior is obviously also affected by xfoil s accuracy and robustness issues but we have made every effort to address these by optimizing the panels number and distribution and eliminate all non converging solutions as a second step we have employed a guided random search optimization method genetic algorithm goldberg 1989 conn et al 1997 to address this problem we have solved the optimization problem in eq 15 for varying values of ε specifically in fig 11 we present the optimization histories for ε 0 10 4 and 10 3 while the corresponding resulting shapes are depicted in fig 12 it is easy to see that in the first two cases ε 0 and ε 10 4 the algorithm opted mainly for a minimization of drag while the maximization of lift was preferred in the 3rd case however the resulting drag over lift ratios are relatively close to each other min c d c l ε 0 0 005381 min c d c l ε 10 4 0 005208 and min c d c l ε 10 3 0 00511 and significantly better to naca 4412 drag over lift ratio which is equal to 0 0076 approximately we need to also note here that since we have a guarantee of being close to the actual optimum we can slightly improve these solutions using a gradient based algorithm e g fmincon with sqp and the results of the genetic algorithm as initial points for the cases mentioned above an improvement ranging from 0 02 to 0 04 to the drag of lift ratio was observed obviously if we want to explore all different design possibilities along with a wide range of area deviations we may setup this problem as a multi objective minimization problem that minimizes both the drag over lift ratio and the area deviation from the original naca 4412 profile 16 min v c d v c l v min v a v a 0 where a 0 0 0819997 subject to 0 v i 1 i 1 11 this time the optimization process is driven by matlab s gamultiobj multi objective genetic algorithm implementation see the mathworks inc and matla 2016c the results of the optimization procedure are used to calculate the pareto front depicted in fig 13 the pareto front is defined to be the set of design points that are pareto efficient i e it is impossible to make any one of the objective function values better off without making at least one of the others worse off in this sense the optimum shapes lie on the pareto front see solid line depicted in fig 13b this is obviously an approximation of the actual pareto front which can be enhanced by fine tuning the parameters of the genetic algorithm or employing a gradient based algorithm to improve the identified designs for this particular optimization example 52 480 different foil instances have been assessed leading to a set of pareto optimum designs lying on the depicted pareto front three indicative pareto optimum points along with the corresponding foils and achieved objective function values are depicted in fig 14 the same points are marked with corresponding circled numbers in fig 13b as it can be easily observed in fig 14 the three pareto optimum designs share a similar shape which is significantly different from the original naca 4412 profile included also in the same figure assuming now that we aim for a solution that balances between the best drag over lift ratio and the minimum deviation from the initial foil we may pick the design nr 2 depicted in figs 14 and 13b for this particular design we achieve a drag over lift equal to 5 134 10 3 which is around 30 better than the naca 4412 ratio that equals to 7 6 10 3 at the same time the area deviation is limited to only 5 7 10 5 square units which corresponds to less than 0 1 difference additionally two of the three single objective optimized designs i e for ε 10 4 and ε 10 3 are also depicted in fig 13b with labels a and b respectively as a final note we would also like to mention that during the optimization examples included in this section more than 250 000 different airfoil designs have been generated by our parametric model and it never failed to produce a valid shape which clearly demonstrates its robustness 5 model extensions and future work this section is devoted to the discussion of some possible short term enhancements to our parametric model along with some ideas regarding the use of our model in forward and inverse design frameworks most of the parametrization approaches used in the comparison presented in 3 2 allow the employment of an increasing number of variables design parameters when requiring increased levels of representation accuracy this feature has been partially implemented in our model by allowing the increase of parameters from 11 to 15 see relevant discussion in 3 2 however this already implemented modification does not allow us to reach the significantly larger number of variables 20 100 supported by the compared parametrization approaches in this context we would like to discuss some possible extensions that will enable the developed parametric model to employ additional parameters without sacrificing the basic properties that render it appropriate for use in conjunction with the developed isogeometric solvers see relevant discussion in 1 one rather straightforward possibility would be to include the control point weights as additional design variables which would obviously provide some additional flexibility and enable the achievement of higher degrees of accuracy nevertheless the materialization of such an extension should be carefully planned and implemented so that the shape constraint requirements elimination of unwanted inflection points curvature smoothness leading and trailing edge points interpolation etc continue to be satisfied some initial experiments have shown that the achieved accuracy although better does not differ substantially from the one achieved by the 15 variable model and hence we have not pursued this any further a more promising approach involves the application of successive degree elevations for the four cubic spline segments comprising the foil profile combined with the introduction of an appropriate number of additional variables which will determine the position of the new control points along the resulting degree elevated control polygon segments this idea is depicted in fig 15 for one of the four cubic spline segments used in the parametric model definition our initial model uses one parameter tip u to specify both the positions of p 0 1 and p 0 2 as a convex combination of a b and c b respectively see fig 1 and the relevant discussion in 2 in our implemented extension tip u is split into two separate parameters tip u 1 and tip u 2 to independently control the aforementioned convex combinations see relevant discussion in 3 2 this procedure can lead to the inclusion of additional parameters if we also incorporate degree elevation specifically if we elevate once the degree of the cubic segment depicted in fig 15 we will get a quartic segment with the exact same shape however now the control points have increased by one which allows the introduction of three parameters two replacing tip u 1 and tip u 2 and a new one controlling the convex combinations between b p 0 1 p 0 1 p 0 2 and p 0 2 c respectively the parameter values can be obviously set independently with values between 0 and 1 and get modified curve shapes which however do not violate any of the geometric constraints embedded in our model tangent directions at endpoints maximum height value at c etc with each level of degree elevation an additional control point and model parameter can be added to the model this leads to an iterative process that permits a continuous increase of controlling parameters and levels of shape modification as it is also depicted in fig 15 with the next level of refinement i e the quintic segment dotted lines at the current level of development of our igabem solvers we do not need this increased level of accuracy but as has been reported in masters et al 2017 increased levels of accuracy around 5 10 5 i e one order of magnitude lower tolerance may be required to ensure accurate computation of lift and drag values one of our future research works utilizing the developed parametric model aims to address in a quick and relatively accurate manner the following two problems a forward design problem i e estimate the performance e g lift over drag ratios over a range of different angles of attack of a given foil and b inverse design problem i e estimate the foil shape exhibiting a given performance behavior e g lift over drag ratios or pressure distribution along the foil this can be potentially accomplished by utilizing artificial neural networks anns in conjunction with our parametric model the set of shape design parameters 10 10 for a sufficiently large number of different foil shapes can be used as the input training set in the ann while the foil s performance results may be used as the output set a well trained ann of this type can address the forward design problem and by reversing the input and output training sets we may also attack the considerably harder inverse design problem furthermore our future planned work also includes extensions allowing special features such as blade fixing and other specialized leading and trailing edge configurations to be captured for example in this work we have not considered foil profiles with blunt trailing edges since the employed isogeometric bem formulation requires the corner at the te but we can easily represent blunt trailing edges with an inclusion of one additional parameter that would correspond to the ordinate of the point at the te i e its thickness t in this case control point b 6 would need to change from l 0 to l t and eqs 5 10 and 11 would also need to be adjusted to include t if one requires additional flexibility the introduction of two parameters t 1 for the upper te point s ordinate and t 2 for the lower side could be also considered a final and obvious extension of this work deals with the employment of the current 2d parametric model in 3d parametric models of blades and wings as has been successfully demonstrated in arapakopoulos et al 2019 6 conclusions an efficient and robust parametric model for the generation and representation of airfoil hydrofoil shapes has been presented in this work its capacity in accurately approximating foil profiles with a low number of control points has been demonstrated for a number of considerably different shapes and a general approach for the determination of the parameter values has been proposed equation 12 which is used in their determination describes a non linear minimization problem in r 11 or r 15 for the extended model that seems definitely unattractive however this is just the most general case as in practice almost half of the parameter values can be directly derived from the given point set specifically it is easy to see that when points exist on or sufficiently near the upper and lower side s maximum thickness 11 11 with respect to chord line the values of x u max u max x l max and l max can be directly computed furthermore the same argument is true for the angle parameters corresponding to trailing edge point i e a b u and a b l where the angle can be estimated by the first and last pair of points in the point set these direct computations reduce significantly the design space and obviously the minimization problem s complexity from r 11 to r 5 based on this parametric model a series of applications ranging from shape reconstructions in reverse engineering to shape optimization and efficient spline representations of existing airfoil shapes has been discussed and demonstrated the results in all cases indicate a clear benefit gained from parametric model s employment and although our approach has been mainly designed to facilitate the needs of specific isogeometric analysis bem solvers it compares favorably to a wide range of airfoil parametrizations found in literature obviously there is still plenty of room for improvement and further investigation as it has been already discussed in the previous section authors contribution k v kostas mathematical modelling references manuscript preparation revisions implementation of the parametric model along with its variants and modifications a amiralin ann modelling and benchmark examples for naca database nrel databases s sagimbayev implementation of li et al method and relevant benchmark examples t massalov collection of data and preparation of point files y kalel ann modelling and benchmark examples for naca nrel databases c g politis manuscript preparation revisions declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work has received funding from nazarbayev university grant no 090118fd5328 shape optimization of lift and thrust generating surfaces with the aid of isogeometric analysis soltiga 
22074,in this paper we present a geometric parametric model that has been mainly designed to accommodate the need for an appropriate analysis model in the context of isogeometric analysis iga 1 but can be also employed as a universal tool for reconstructing and representing a wide range of different airfoils and or hydrofoils families this model is an extension of the parametric model employed in optimization of hydrofoils efficiency with the aid of an isogeometric boundary element method solver iga bem presented in 2 apart from its apparent use in design evaluation and optimization the parametric model can be further employed in a wider range of relevant applications specifically in this work we begin by demonstrating its use as an alternative approach in efficiently reconstructing airfoil and hydrofoil shapes from large sets of points appearing mainly in the context of reverse engineering applications this is further investigated and the parametric model s performance in accurately representing existing airfoils is extensively benchmarked against results from pertinent methods and approaches followed in the aeronautics and aerospace research community finally we demonstrate the use of the parametric model in a foil shape optimization problem we conclude this work with a discussion on future enhancements and possible research directions keywords parametric model nurbs airfoils shape optimization reconstruction inverse design 1 introduction the performance of various marine structures depends on the hydrodynamic properties of appendages operating as lifting devices as e g keels rudders stabilizers propellers water turbines etc as a general statement the performance of these lifting devices is greatly affected by their shape and even small variations may have a significant impact in this context the development of optimization strategies coupled with efficient computational fluid dynamics solvers and appropriate parametric geometric modeling techniques employed in the design optimization of lifting appendages and thrust generating devices is highly desirable a robust parametric geometric model plays a key role in the optimization process and many parametric models have been already developed in this context parametric models commonly employed in isogeometric analysis applications use b splines or nurbs for the geometry representation and their control points and weights are typically considered the model s parameters see e g nguyen et al 2012 nørtoft and gravesen 2013 li and qian 2011 lian et al 2013 however this approach is not very efficient and convenient from an engineering point of view since control point positions and weights have rarely any physical meaning in this connection there have been works e g kostas et al 2015 2017 kostas et al 2015 2017 and ginnis et al 2013 ginnis et al 2013 in which high level parameters with a direct design physical meaning have been introduced to relevant parametric models and employed for the generation of shape instances thus the control points of the underlying geometric representation and the inherent complexity of free form shapes are hidden from the user and are indirectly controlled by these high level parameters in general parametric models comprise a list of exposed external and internal parameters devised on the basis of the general shape that needs to be produced exposed parameters are accessible to the user of the parametric model and initiate the modeling process leading eventually to a corresponding shape instance on the contrary internal parameters are not accessible to the user and are kept for developer s use as means to internally control the shape construction process and retain the basic shape characteristics constraints of the instantiated object furthermore a domain of variation is assigned to each parameter assuring the modeling robustness while at the same time avoiding invalid geometrical models as e g self intersections in this context parametric models favor the use of non dimensional parameters where possible in order to avoid the interdependency between them exposed parameters are roughly categorized in two groups global and local according to whether their effect in shape design is of global nature e g object s main dimensions or of local nature in the sense that they affect locally limited shape s details in this way global variations induced by a small set of global parameters combined with local changes implied by local parameters typically applied in hydrodynamic optimization processes illustrate the applicability and powerfulness of the parametric design methodology the parametric model presented here was mainly built to accommodate the specific needs of design optimization with the aid of isogeometric analysis solvers hence apart from the common requirements posed for generic airfoil hydrofoil parametric models some additional constraints were considered in its development specifically we aimed at a model that satisfies the following set of criteria the developed parametric model uses a small number of parameters that limits the dimensions of the design space possesses parameters with physical meaning widths angles lengths etc which allow users to easily assign values to parameters uses a small number of control points for representing the foil this becomes even more significant when foils are used in the construction of higher level 3d entities such as blades or wings provides an accurate geometrical representation i e it can reconstruct existing airfoils with minimal deviation uses basis functions in its spline representation which are appropriate for the representation of physical quantities velocities pressures etc within the isogeometric analysis solvers developed in kostas et al 2017 and chouliaras et al 2017 2019 kaklis et al 2018 both solvers employ a nurbs representation of the body geometry and hence this constitutes an additional constraint for the development of the model generates shapes that do not exhibit undesirable oscillations self intersections superfluous inflections points or any other type of shape anomaly that would hinder its use with an isogeometric solver although the development of the presented model was performed under this special set of constraints we consider that it has reached a level of maturity that allows it to be also employed for reconstructing and representing accurately and robustly a wide range of airfoils and hydrofoils families while producing comparable results to the more general methods for airfols hydrofoils parametrization such as the ones examined in the comprehensive reviews by masters et al 2016 2017 the construction process for our parametric model is presented and discussed in section 2 the model is materialized both within rhinoceros programming environment robert mcneel associates and rhino 5 for windows 2018 and matlab the mathworks inc and matla 2016a and constitutes an extension of the parametric model developed in kostas et al 2017 which generated hydrofoils as closed cubic b spline curves via a set of eight parameters in this work we have increased the number of external parameters to eleven and later fifteen non dimensional ratios aiming at an increase of the model s approximation power and coverage of the foil design space note that the number of employed parameters can be reduced to just five or seven for the latter case when dealing with symmetric foils as we will discuss in 2 this set of parameters is employed in the generation of the two foil sides via four simple cubic bézier curves which are then merged in the construction of the final cubic b spline curve representing the complete foil shape in this work we initially demonstrate the parametric model s performance in shape reconstruction from large foil point sets followed by a more extensive investigation of its capabilities in efficiently representing existing families of airfoils and hydrofoils a foil shape constrained optimization example is used afterward to demonstrate the model s use in an optimization framework and its capacity to efficiently explore the design space specifically in section 3 1 the parametric model s approximating capacity is demonstrated by reconstructing the shape of common foils from given large and medium sized point sets the approximation process can be accomplished through the solution of a minimization problem which determines the parameter values for the corresponding parametric model instance the performance of the parametric model is then compared with other general purpose approaches namely two fitting algorithms of rhino robert mcneel associates and rhino 5 for windows 2018 rebuild and fitcrv and a general point set approximation method based on discrete curvature and knot insertion heuristics proposed by li et al 2005 li et al 2005 our parametric model can achieve one order of magnitude better approximating accuracy for the same number of control points when compared with rhino s rebuild command and li et al 2005 method for the case of rhino s fitcrv command our approximating accuracy is equivalent or slightly worse but fitcrv requires a significantly larger number of control points rhino among other more ship industry specific cad packages has been commonly used in naval architecture and marine engineering due to its flexible tools for generating free form curves and surfaces which justifies our selection as a benchmark tool in this context section 3 2 presents a more thorough examination of our model s representation capabilities and compare its performance against the more general airfoil parametrization approaches employed in pertinent literature specifically following the comprehensive reviews by masters et al 2016 2017 we compare our model against 7 different airfoil parametrization methods for 5 specific airfoils rae 2822 naca 4412 onera m6 nlr 7301 and naca 66 3 418 investigated therein our comparisons conclude by examining the model s capacity to represent an extended database of naca family airfoils within an appropriate geometric tolerance and how our results compare against the coverage achieved by the other methods for the same database the parametrization methods examined in masters et al 2016 2017 are categorized as either constructive when the airfoil shape is generated on the basis of the employed parameters or deformative when a reference airfoil shape is deformed to produce the sought for shape constructive methods include 1 b splines or nurbs fitting methods see e g braibant and fleury 1984 bisson and nadarajah 2015 sherar et al 2007 2 class shape function transformations cst kulfan and bussoletti 2006 kulfan 2008 3 singular value decomposition svd see e g toal et al 2010 ghoman et al 2012 poole et al 2015 and 4 parametrized sections parsec sobieczky et al 1999 deformative methods include 1 hicks henne bump functions hicks and henne 1978 2 bézier surface free form deformation ffd method sederberg and parry 1986 and 3 the radial basis function domain element rbf de approach rendall and allen 1519 morris et al 1002 all of these methods are further described in 3 2 and masters et al 2017 finally in section 4 the robustness design flexibility and design space exploration capacity of the parametric model is demonstrated in a series of foil shape optimization problems in our examples we aim in minimizing the ratio of drag over lift coefficients and constrain or minimize the deviation of foil s area from a reference area the lift and drag coefficients are calculated using the well known xfoil drela 2018 computational package while the optimization process is mainly driven by genetic algorithms we conclude this work by briefly presenting some future model extension possibilities and potential applications in the area of forward and inverse design problems 2 the airfoil hydrofoil parametric model construction the parametric model for a general hydrofoil and or airfoil presented in this work is an extension of the parametric model developed in kostas et al 2017 and employed in the shape optimization of hydrofoils with the aid of an isogeometric analysis boundary element method iga bem solver the model presented in kostas et al 2017 generates a closed cubic b spline curve via a set of 8 parameters the employed parameters were defined as appropriate non dimensional ratios lying always in 0 1 which allows the elimination of complex interdependent constraints and enhances the robustness of the model the same approach of non dimensional ratios employed as parameters is also followed in the present work along with the inclusion of some additional parameters which enrich the space of produced shapes apart from the different set of parameters employed in these two parametric models their major difference lies in the way the foil shape is generated in kostas et al 2017 the set of parameters was used for generating the foil s upper side suction side and its camber curve then the lower side pressure side was constructed by appropriately mirroring the upper side about the camber curve and finally the two sides were merged into a single cubic b spline curve representing the foil instance in the present work the parameters are directly employed in the generation of the two foil sides and no intermediate camber curve construction step is required this approach slightly increases the number of required parameters but has a twofold benefit since it enriches the design space covered by the parametric model and reduces the required number of control points in the final curve the parameters employed in the parametric model are presented in table 1 along with their definitions and ranges of their dimensional counterparts let us note here that the foil s chord length l is used for non dimensionalization the coordinate system s origin is considered at foil s leading edge point and the longitudinal axis coincides with the chord line having the positive direction towards the trailing edge hence the ordinates of foil s upper side are always non negative while the lower side values can be either negative or positive according to the foil s assumed camber a foil parametric model instance with l 1 and design vector parameter values v v i i 1 11 equal to v i 0 5 i 1 10 v 11 0 1 is depicted in fig 1 let us also note here that for the case of symmetric airfoils five parameters 1 1 upper or lower side parameters the angle at leading edge a will be fixed and equal to 0 see table 1 are sufficient for the representation since all the others can be directly derived through them the foil s contour is represented as a nurbs curve of order k degree equals k 1 defined as follows 1 c u v x u v y u v i 0 n b i v r i k u u t k 1 t n 1 0 1 where r i k u i 0 n is the rational b spline basis of order k defined over a knot sequence j t 0 t 1 t n k and possessing non negative weights w i i 0 n while b i v are the associated control points depending on the parameter vector v see e g piegl tiller piegl and tiller 1997 therefore b i v b i x v b i y v i 0 n are the functions mapping the design vector of parameter values v to the control points coordinate space in this work we assume that k 4 n 12 and all weights are equal to one which reduces the general nurbs representation see eq 1 above into a cubic b spline curve the parametric model s construction is based on the definition of four simple cubic bézier curves that are employed in the generation of the final cubic b spline curve each side of the foil upper and lower side comprises two segments one for the fore part and the other one for the remaining aft part see fig 1 for the fore part of the upper side the first control point b 0 is placed at 0 0 while the last one b 3 is at x u max u max the first interior point lies on the line segment defined by 0 0 and tan a u max u max while the second one on the segment defined by tan a u max u max and x u max u max the exact position of these points is controlled by the tip u shape parameter that dictates the shape fullness of the leading edge specifically 2 b 1 tan a u max u max tip u and 3 b 2 x u max tip u x u max tan a u max u max we may also visualize the construction of these two interior control points i e b 1 and b 2 through the introduction of point p see upper left part in fig 1 as the intersection of lines y u max and y tan a x in this case b 1 and b 2 can be defined as the convex combinations of b 0 p and b 3 p respectively i e b 1 b 0 tip u p and b 2 b 3 tip u p the aft part of the upper side is another cubic bézier segment adjacent to the fore part which stops at the trailing edge point i e at b 6 l 0 its interior control points are positioned as follows 4 b 4 x u max s u max u and 5 b 5 l max u tan a b u max u if l max u tan a b u x u max s u x u max s u tan a b u l x u max s u otherwise control point b 5 corresponds to the intersection of lines y u max and y l x tan a b u when the inequality described in eq 5 is true and the intersection of x x u max s u and y l x tan a b u if the inequality is not true the collinear placement of b 2 b 3 and b 4 ensures the geometric continuity between the two bézier segments and makes b 3 the upper side s maximum thickness 2 2 with respect to chord point see fig 1 the construction of the lower side follows a similar approach with the only differences pertaining to a different angle range for a b l a reverse sign for angle parameter a and an appropriately 3 3 two cases need to be considered when a b l is above or below the chord line modified eq 5 for the corresponding point at the lower side specifically 6 b 12 b 0 b 8 x l max s l l max 7 b 11 tan a l max l max tip l 8 b 10 x l max tip l x l max tan a l max l max 9 b 9 x l max l max and if a b l is below the chord line 4 4 negative value in table 1 10 b 7 l max l tan a b l max l if l max l tan a b l x l max s l x l max s l tan a b l l x l max s l otherwise else 11 b 7 l max u tan a b l max u if x u max s u x l max s l x l max s l tan a b l l x l max s l otherwise the 4 bézier curve segments can be finally merged into a single b spline curve with the introduction of k 1 coincident knots at segments joints specifically if we assume a clockwise traversal direction starting from the leading edge point the final b spline curve s control points will be ordered as shown in fig 1 i e b i i 0 12 and the corresponding knotvector can be then set to u 0 0 0 0 1 4 1 4 1 4 1 2 1 2 1 2 3 4 3 4 3 4 1 1 1 1 the foil parametric model described above has been implemented in both rhino3d robert mcneel associates and rhino 5 for windows 2018 with the aid of rhinoscripting and matlab the mathworks inc and matla 2016a programming environment model s implementation in rhino supports a gui that allows interactive manipulation of parameter values and an automatic update of model instances the user can easily acquire a good approximation of the foil in question by importing an input point set and manipulating the parameter values interactively in order to overlay the generated parametric model instance on the imported point set obviously if high accuracy in the approximation is required this can be accomplished through the solution of a corresponding optimization problem which is an already built in feature in both implementations the optimization problem comprises a minimization of the curve point set deviation and is defined as follows 12 min v i 1 m c u i v v p i 2 subject to 0 v i 1 i 1 11 where p i i 1 m are the m input points and u i are the b spline instance s parametric values that correspond to the perpendicular projections of p i on c u v this minimization problem can be easily solved with the aid of matlab s optimization toolbox the mathworks inc and matla 2016b and specifically a deterministic algorithm such as the interior point algorithm byrd et al 1999 implemented in matlab s fmincon function the running time 5 5 using an entry level pc is limited to few seconds when a good initial estimation of the parameter vector v is provided and will not generally exceed 60 s even for starting points far from the optimum in the context of an evaluation process the authors have systematically examined foils from uiuc airfoil database applied aerodynamics 2018 and national renewable energy laboratory website national renewable enery laboratory 2018 and generated a database 6 6 the web version of this database will soon become publicly available at http amrg nu edu kz soltiga comprising the parametric models of more than 1300 of the most common naca and nrel foils 3 the approximation power of the parametric model in this section we examine the approximation and representation capabilities of the developed parametric model we begin our discussion by examining its applicability in a more general setting where points commonly of large numbers are supplied as a result of scanning and or other similar measuring processes an existing body geometry and we are required to efficiently reconstruct the body geometry these point sets are commonly polluted with noise and generally deviate from the idealized airfoil shape descriptions specifically in 3 1 we test and compare the efficiency of our model against a general b spline curve approximation method employed in reconstruction applications along with some relevant commonly available tools within a typical cad package the next step in our examination deals with the model s capability in generating accurate curve representations for existing airfoil families defined by their corresponding equations and or accurately calculated point sets although our model was developed to mainly facilitate the requirements of some specific isogeometric analysis solvers see relevant discussion in 1 which may obviously hinder the development of a successful general purpose foil parametrization method we feel that the reader will be interested in comparing our model s performance against established methods used in airfoil design and parametrization literature in section 3 2 we attempt to accomplish this by benchmarking our model against 7 well studied airfoil parametrization methods appearing in masters et al 2017 3 1 shape reconstruction in reverse engineering applications shape reconstruction of a given body described by a large point set is one of the most common problems in most cases the provided point sets are usually polluted with measurement noise which hinders significantly the reconstruction process an additional burden appears in the case of bodies like turbine propeller blades hydrofoils airfoils and wings in which an accurate representation of the geometry is extremely important since their performance is very sensitive and strongly dependent on the underlying geometry in many cases researchers and practitioners attack the problem using a b spline approximation approach where the major question lies in the selection of the proper number of control points and parametrization i e knotvector this is a well known problem and researchers have applied several approaches including but not limited to knot insertion modifications hölzle 1983 exploitation of discrete curvature and heuristics li et al 2005 general non linear optimization dung and tjahjowidodo 1371 and machine learning laube et al 2018 moreover noise can be a significant problem and usually a smoothing approach is introduced where a low pass filter is employed to cut off data noise in this section we will provide examples demonstrating the successful usage of the parametric model in reconstructing efficiently and accurately foil shapes from large point sets the use of the parametric model guarantees a constant low number of control points in our case thirteen control points and eliminates the problem of determining an appropriate knotvector for the approximating b spline curve furthermore the determination of the parameter values is fast and robust in the sense that inappropriate behaviors such as self intersections and oscillations are excluded by design and the model is generally immune to noise on the other hand our proposed approach cannot be considered as a general shape approximation reconstruction method since it is obviously only applicable to foil looking shapes nevertheless as examples indicate it is a very promising approach for this particular area the presented examples correspond to four different common foil shapes nacas 4412 65a010 7 7 meanline type naca a 0 8 thickness type naca 65a010 and 6410 and eppler 335 which are used in aeronautical and marine applications point sets for nacas 4412 and 6410 were acquired using the standard equations for cambered 4 digit naca while points for naca 65a010 were extracted from openprop software package which is a free software used for the design and analysis of marine propellers and horizontal axis turbines see epps et al 2009 epps 2016 epps and kimball 2013a 2013b finally the point set for eppler 335 has been acquired from airfoiltools online database 8 8 http airfoiltools com airfoil details airfoil e335 il in this work we are interested in investigating the parametric model s approximating performance in comparison to other common reconstruction approximation approaches to this end we benchmark the parametric model s performance against three different approaches namely the implementation of an approximation method based on discrete curvature and a knot insertion heuristic presented in li et al 2005 and rhino s robert mcneel associates and rhino 5 for windows 2018 rebuild and fitcrv commands rebuild command reconstructs a curve or surface to a specified degree and control point number producing a generally uniform knotvector while fitcrv creates an approximation of a given curve to within a user specified tolerance in all examples rebuild and fitcrv where applied to the point set interpolant in the first example we generated and used a point set for naca 4412 comprising 495 points the approximation results obtained by the proposed parametric model and li et al s knot insertion method are depicted in fig 2 the corresponding numerical results for all approaches are presented in table 2 it is easy to see that the parametric model approach manages to achieve a very good shape approximation and a maximum distance of less than 10 3 length units with only 13 control points a slightly better accuracy level is only achieved by rhino s fitcrv command which however requires more than double the number of control points the method of li et al see upper graph in fig 2 does not perform well in this case and exhibits a high concentration of control points at the mid area of foil s lower side which is due to discrete curvature s oscillations about zero in this area this is a clear indication of this method s sensitivity to any type of noise in order to overcome these artificial oscillations we recomputed naca 4412 foil points with a higher numerical accuracy the new point set is denoted as naca4412f and the new approximating curve is depicted at the bottom part of fig 2 this time li et al s method performs significantly better as the number of required control points drops to 9 with no unnecessary concentrations but still the deviation is higher compared to the parametric model instance as a further improvement step for li s method we modified the employed heuristic by halving the critical angle used in characterizing small deflection locally now the employed control points increase to 13 but nevertheless the achieved deviation is still higher when compared to the parametric model s achieved accuracy level see table 2 4th row as a final note we can clearly see from table 2 that rhino s rebuild command is the worst performer with respect to the achieved deviation level the results for the remaining three examples nacas 65a010 and 6410 and eppler 335 follow more or less the same pattern fitcrv command achieves the best approximation but requires double the number of control points when compared to the other methods the proposed parametric model achieves the best approximation next to fitcrv command but uses a significantly lower number of control points the method of li et al requires slightly more control points 9 9 13 18 for the specific examples but the approximation accuracy is worse in all cases and finally rebuild is constantly achieving the worst results with respect to point set deviation the approximating curves for the two nacas foils are depicted in figs 3 and 4 and the corresponding numerical results are presented in table 2 rows 7 to 14 finally the approximating curves for eppler 335 are depicted in fig 5 and the numerical results once again in table 2 rows 15 to 18 the examples presented in this section show that the parametric model approach is a viable alternative when considering shape reconstruction of foil shaped bodies the obvious benefit of data reduction becomes even greater when this approach is employed in the reconstruction of 3d bodies such as propeller and turbine blades from foil sections additional benefits are gained when performing analysis following the isogeometric analysis iga paradigm hughes et al 2005 which allows accurate results from smooth analysis models with reduced number of degrees of freedom control points hence avoiding the unnecessary and time consuming use of meshes and geometrical representations with superfluous control points finally this gain in the analysis phase has a significant multiplicative effect on design shape optimization with iga solvers as it has been already demonstrated in kostas et al 2015 2017 and kostas et al 2018 3 2 comparison to other airfoil parametrizations as mentioned in the beginning of 3 we will demonstrate in this subsection the performance of the developed parametric model in comparison to the approaches examined in masters et al 2017 for comparison purposes we employ a modified version of the typical wind tunnel tolerance or kulfan tolerance defined in kulfan and bussoletti 2006 as 13 z e r r o r 4 10 4 if x c 0 2 8 10 4 if x c 0 2 where c denotes the airfoil s chord length and x the x coordinate of the corresponding point specifically we adopt the modification suggested in masters et al 2017 which involves an inflation of the computed error when x c 0 2 by doubling it hence eq 13 can be written as 14 z ˆ e r r o r 8 10 4 x which is the exact same typical bound used for measuring geometric accuracy in masters et al 2017 and throughout this paper the airfoil parametrizations and representation methods included in this comparison are as follows 1 b spline cos a least squares high order b spline fitting of points for each side of an airfoil with cosine spacing for the spline s control points in the longitudinal direction see masters et al 2017 this method belongs in a wider category of methods employing nurbs representations where the control points weights and knots are used as design variables see e g braibant and fleury 1984 bisson and nadarajah 2015 sherar et al 2007 2 cst class shape function transformation method developed and described in kulfan and bussoletti 2006 kulfan 2008 this approach mainly involves the modification of a foil like function via a shape function comprised by a linear combination of relatively high order bernstein polynomials see kulfan 2008 3 svd singular value decomposition method extracting orthogonal basis modes from an appropriately prepared set of training airfoil shapes an arbitrary airfoil is then generated as a linear combination of these modes see toal et al 2010 ghoman et al 2012 poole et al 2015 for the general approach and masters et al 2017 for the specific implementation used herein 4 parsec method introduced by sobieczky in sobieczky et al 1999 parsec utilizes a 6 th order polynomial for each airfoil side which is determined by satisfying a set of 12 geometric constraints that constitute the method s design variables a significant advantage in this approach is the physical meaning that can be given to these variables and thus allow a designer to assign meaningful values 5 hicks henne bump functions approach modifies a base airfoil shape by a number of parameterized basis functions bump functions see hicks and henne 1978 for the general approach and masters et al 2017 for the specific implementation used herein 6 bézier surface free form deformation this approach was introduced by sederberg and parry in sederberg and parry 1986 and deforms a prototype airfoil shape by embedding it in a planar bézier surface and modifying the surface s control points the number of control points rows determine the variants 3 and 4 row bézier surfaces presented in masters et al 2017 7 radial basis function domain elements rbf this is another shape modification approach like the bézier ffd above which is however based on a deformation field defined by radial basis interpolation contrary to previous case the positions of rbf control points are not constrained on a fixed lattice structure this provides some additional flexibility on the expense of an additional optimization procedure to determine their number and appropriate positions for the application at hand the rbf formulation employed in masters et al 2017 is according to rendall and allen rendall and allen 1519 and its use as a parametrization technique has been presented in morris et al 1002 we begin our comparison by testing our model s achieved accuracy for five airfoil shapes examined in detail in masters et al 2017 specifically these include rae 2822 naca 4412 onera m6 nlr 7301 and naca 66 3 418 our primary aim in this first step is to demonstrate that a representation with an accuracy less or equal to the modified kulfan tolerance see eq 14 above can be achieved the reconstructed shapes for these five case studies is depicted with dashed lines in fig 6 unfortunately as it can be observed in table 3 std model column only naca 4412 and onera m6 can be reconstructed within the set wind tunnel tolerance the same failure can be also observed for the cases of naca 65a010 and eppler 335 included in table 2 however as one can observe from fig 7 for the cases of naca 66 3 418 and rae 2822 none or very few of the compared approaches can achieve a corresponding representation within the set tolerance for only 11 design variables contrary to most of the compared approaches our model was initially designed to use a fixed number of variables and in that sense resembled the parsec approach see sobieczky et al 1999 luckily an extension of our model to support additional parameters without sacrificing any of our primary objectives described in 1 is easily achievable as one can observe in eqs 2 and 3 and fig 1 control points b 1 and b 2 are both controlled by tip u similarly tip l controls the two first interior points of the lower side hence a rather obvious extension would be to split tip u in two parameters and employ these say tip u 1 and tip u 2 in controlling b 1 and b 2 independently in a similar fashion two variables tip l 1 and tip l 2 can be also used for determining the corresponding control points b 11 b 12 at the lower side this approach can be also applied for the control point pairs b 4 b 5 and b 7 b 8 that are controlled by s u and s l respectively hence if we also replace s u and s l with two independent variables for each of them we can increase the number of model s parameters to 15 while maintaining the same number of control points and all the other required properties for using the instances with our isogeometric solvers the allowable ranges for these new parameters are included in table 4 while the effect of substituting tip u and s u with the corresponding parameter pairs is depicted in fig 8 specifically in fig 8 the upper sides of an airfoil generated by the standard solid thick line and the extended model dashed line are depicted in the standard model b 1 and b 2 are linked to each other via tip u if for example b 1 is at the midpoint of b 0 p b 2 will be also at the midpoint of b 3 p splitting tip u in tip u 1 and tip u 2 allows to independently control the position of b 1 and b 2 as is shown with b 2 in fig 8 similarly the position of b 5 and b 4 can vary independently along their respective line segments b 6 b 5 and b 3 b 4 on the basis of s u 1 and s u 2 parameter values if we now recompute the approximations for the five airfoil cases we can see that the required kulfan tolerance is satisfied for all of them these new parametric model instances are depicted with solid lines in fig 6 and the achieved deviation is included in table 3 column ext model furthermore for the case of naca 66 3 418 as one can see in fig 7 our extended parametric model manages to reach kulfan tolerance approximation with very few variables 15 and only svd requires less however this picture changes when we examine the case of rae 2822 see fig 7 again in which our model exhibits an average to low performance since 4 out of 7 examined approaches reach the set tolerance with fewer design variables as it is obviously not possible to reach any conclusive results by simply examining few airfoil shapes we employed both our standard and extended parametric models in approximating the shapes within a large database of airfoils specifically this database comprises the naca 4 digit airfoils the remaining naca airfoils included in the uiuc database applied aerodynamics 2018 the nrel airfoils national renewable enery laboratory 2018 and several joukowski and karman trefftz shapes the total number of airfoil shapes in the database exceeds 1300 and includes all the naca shapes examined in masters et al 2017 the results of this extensive study are depicted in fig 9 along with the results of the seven other airfoil parametrization approaches one can easily see that our standard model 11 parameters succeeds in approximating within the modified kulfan tolerance around 75 of the database shapes while the extended version 15 parameters achieves full coverage this result demonstrates that our parametric model is capable to accurately approximate a large number of shapes while at the same time satisfying the requirements for its use with the developed isogeometric solvers as a matter of fact as one can easily observe from fig 9 our results are better when compared to the remaining approaches and only the svd method built on the basis of either the naca or uiuc databases achieves a better coverage 4 foil shape optimization in this section we present a shape optimization example that demonstrates the ability of the parametric model to efficiently and robustly cover a wide design space and its use in obtaining an optimized foil shape under specific geometric constraints for this example we consider a 1 m long foil profile which operates at an angle of attack of 5 o degrees in a flow regime with a reynolds number equal to 10 6 our goal is to maximize the foil s lift coefficient c l and minimize the drag coefficient c d under the constraint of minimum deviation a a 0 of the profile area a from a reference area a 0 in our example a 0 corresponds to naca 4412 profile area we begin by setting this up as a single objective optimization problem with a non linear constraint on the airfoil s area specifically 15 min v c d v c l v subject to a v a 0 ε where a 0 0 0819997 0 v i 1 i 1 11 where ε the allowable deviation from naca 4412 profile area obviously in this optimization environment the parametric model is used for the generation of foil instances that are evaluated with respect to the drag over lift ratio and their area deviation from the original naca 4412 profile lift and drag coefficients are assessed with the aid of the well known xfoil drela 2018 computational package which is commonly used in assessing the performance of subsonic airfoils and is based on the combination of a fast panel method with fully coupled viscous inviscid interaction see also drela and giles 1987 drela and mueller 1989 for the optimization process we have used several algorithms included in matlab s standard and global optimization toolboxes as we will discuss subsequently initially gradient based methods were employed specifically matlab s fmincon function with interior point byrd et al 1999 and sequential quadratic programming sqp algorithms have been explored unfortunately starting from an initial design vector that corresponds to naca 4412 shape causes interior point to diverge or fail to satisfy the non linear area constraint the sqp option is more robust and although it converges to a solution that satisfies the area constraint it does not produce any significant improvement to the drag over lift ratio to this connection it was realized that there are large areas in the design space where the objective function i e c d c l as a function of the design vector v is highly oscillatory which leads gradient based algorithms to either fail or output sub optimal results this is demonstrated in fig 10 in which the design vector has been fixed to correspond to naca 4412 representation and parameters a b u and tip u were allowed to vary in their intervals of definition see table 1 this behavior is obviously also affected by xfoil s accuracy and robustness issues but we have made every effort to address these by optimizing the panels number and distribution and eliminate all non converging solutions as a second step we have employed a guided random search optimization method genetic algorithm goldberg 1989 conn et al 1997 to address this problem we have solved the optimization problem in eq 15 for varying values of ε specifically in fig 11 we present the optimization histories for ε 0 10 4 and 10 3 while the corresponding resulting shapes are depicted in fig 12 it is easy to see that in the first two cases ε 0 and ε 10 4 the algorithm opted mainly for a minimization of drag while the maximization of lift was preferred in the 3rd case however the resulting drag over lift ratios are relatively close to each other min c d c l ε 0 0 005381 min c d c l ε 10 4 0 005208 and min c d c l ε 10 3 0 00511 and significantly better to naca 4412 drag over lift ratio which is equal to 0 0076 approximately we need to also note here that since we have a guarantee of being close to the actual optimum we can slightly improve these solutions using a gradient based algorithm e g fmincon with sqp and the results of the genetic algorithm as initial points for the cases mentioned above an improvement ranging from 0 02 to 0 04 to the drag of lift ratio was observed obviously if we want to explore all different design possibilities along with a wide range of area deviations we may setup this problem as a multi objective minimization problem that minimizes both the drag over lift ratio and the area deviation from the original naca 4412 profile 16 min v c d v c l v min v a v a 0 where a 0 0 0819997 subject to 0 v i 1 i 1 11 this time the optimization process is driven by matlab s gamultiobj multi objective genetic algorithm implementation see the mathworks inc and matla 2016c the results of the optimization procedure are used to calculate the pareto front depicted in fig 13 the pareto front is defined to be the set of design points that are pareto efficient i e it is impossible to make any one of the objective function values better off without making at least one of the others worse off in this sense the optimum shapes lie on the pareto front see solid line depicted in fig 13b this is obviously an approximation of the actual pareto front which can be enhanced by fine tuning the parameters of the genetic algorithm or employing a gradient based algorithm to improve the identified designs for this particular optimization example 52 480 different foil instances have been assessed leading to a set of pareto optimum designs lying on the depicted pareto front three indicative pareto optimum points along with the corresponding foils and achieved objective function values are depicted in fig 14 the same points are marked with corresponding circled numbers in fig 13b as it can be easily observed in fig 14 the three pareto optimum designs share a similar shape which is significantly different from the original naca 4412 profile included also in the same figure assuming now that we aim for a solution that balances between the best drag over lift ratio and the minimum deviation from the initial foil we may pick the design nr 2 depicted in figs 14 and 13b for this particular design we achieve a drag over lift equal to 5 134 10 3 which is around 30 better than the naca 4412 ratio that equals to 7 6 10 3 at the same time the area deviation is limited to only 5 7 10 5 square units which corresponds to less than 0 1 difference additionally two of the three single objective optimized designs i e for ε 10 4 and ε 10 3 are also depicted in fig 13b with labels a and b respectively as a final note we would also like to mention that during the optimization examples included in this section more than 250 000 different airfoil designs have been generated by our parametric model and it never failed to produce a valid shape which clearly demonstrates its robustness 5 model extensions and future work this section is devoted to the discussion of some possible short term enhancements to our parametric model along with some ideas regarding the use of our model in forward and inverse design frameworks most of the parametrization approaches used in the comparison presented in 3 2 allow the employment of an increasing number of variables design parameters when requiring increased levels of representation accuracy this feature has been partially implemented in our model by allowing the increase of parameters from 11 to 15 see relevant discussion in 3 2 however this already implemented modification does not allow us to reach the significantly larger number of variables 20 100 supported by the compared parametrization approaches in this context we would like to discuss some possible extensions that will enable the developed parametric model to employ additional parameters without sacrificing the basic properties that render it appropriate for use in conjunction with the developed isogeometric solvers see relevant discussion in 1 one rather straightforward possibility would be to include the control point weights as additional design variables which would obviously provide some additional flexibility and enable the achievement of higher degrees of accuracy nevertheless the materialization of such an extension should be carefully planned and implemented so that the shape constraint requirements elimination of unwanted inflection points curvature smoothness leading and trailing edge points interpolation etc continue to be satisfied some initial experiments have shown that the achieved accuracy although better does not differ substantially from the one achieved by the 15 variable model and hence we have not pursued this any further a more promising approach involves the application of successive degree elevations for the four cubic spline segments comprising the foil profile combined with the introduction of an appropriate number of additional variables which will determine the position of the new control points along the resulting degree elevated control polygon segments this idea is depicted in fig 15 for one of the four cubic spline segments used in the parametric model definition our initial model uses one parameter tip u to specify both the positions of p 0 1 and p 0 2 as a convex combination of a b and c b respectively see fig 1 and the relevant discussion in 2 in our implemented extension tip u is split into two separate parameters tip u 1 and tip u 2 to independently control the aforementioned convex combinations see relevant discussion in 3 2 this procedure can lead to the inclusion of additional parameters if we also incorporate degree elevation specifically if we elevate once the degree of the cubic segment depicted in fig 15 we will get a quartic segment with the exact same shape however now the control points have increased by one which allows the introduction of three parameters two replacing tip u 1 and tip u 2 and a new one controlling the convex combinations between b p 0 1 p 0 1 p 0 2 and p 0 2 c respectively the parameter values can be obviously set independently with values between 0 and 1 and get modified curve shapes which however do not violate any of the geometric constraints embedded in our model tangent directions at endpoints maximum height value at c etc with each level of degree elevation an additional control point and model parameter can be added to the model this leads to an iterative process that permits a continuous increase of controlling parameters and levels of shape modification as it is also depicted in fig 15 with the next level of refinement i e the quintic segment dotted lines at the current level of development of our igabem solvers we do not need this increased level of accuracy but as has been reported in masters et al 2017 increased levels of accuracy around 5 10 5 i e one order of magnitude lower tolerance may be required to ensure accurate computation of lift and drag values one of our future research works utilizing the developed parametric model aims to address in a quick and relatively accurate manner the following two problems a forward design problem i e estimate the performance e g lift over drag ratios over a range of different angles of attack of a given foil and b inverse design problem i e estimate the foil shape exhibiting a given performance behavior e g lift over drag ratios or pressure distribution along the foil this can be potentially accomplished by utilizing artificial neural networks anns in conjunction with our parametric model the set of shape design parameters 10 10 for a sufficiently large number of different foil shapes can be used as the input training set in the ann while the foil s performance results may be used as the output set a well trained ann of this type can address the forward design problem and by reversing the input and output training sets we may also attack the considerably harder inverse design problem furthermore our future planned work also includes extensions allowing special features such as blade fixing and other specialized leading and trailing edge configurations to be captured for example in this work we have not considered foil profiles with blunt trailing edges since the employed isogeometric bem formulation requires the corner at the te but we can easily represent blunt trailing edges with an inclusion of one additional parameter that would correspond to the ordinate of the point at the te i e its thickness t in this case control point b 6 would need to change from l 0 to l t and eqs 5 10 and 11 would also need to be adjusted to include t if one requires additional flexibility the introduction of two parameters t 1 for the upper te point s ordinate and t 2 for the lower side could be also considered a final and obvious extension of this work deals with the employment of the current 2d parametric model in 3d parametric models of blades and wings as has been successfully demonstrated in arapakopoulos et al 2019 6 conclusions an efficient and robust parametric model for the generation and representation of airfoil hydrofoil shapes has been presented in this work its capacity in accurately approximating foil profiles with a low number of control points has been demonstrated for a number of considerably different shapes and a general approach for the determination of the parameter values has been proposed equation 12 which is used in their determination describes a non linear minimization problem in r 11 or r 15 for the extended model that seems definitely unattractive however this is just the most general case as in practice almost half of the parameter values can be directly derived from the given point set specifically it is easy to see that when points exist on or sufficiently near the upper and lower side s maximum thickness 11 11 with respect to chord line the values of x u max u max x l max and l max can be directly computed furthermore the same argument is true for the angle parameters corresponding to trailing edge point i e a b u and a b l where the angle can be estimated by the first and last pair of points in the point set these direct computations reduce significantly the design space and obviously the minimization problem s complexity from r 11 to r 5 based on this parametric model a series of applications ranging from shape reconstructions in reverse engineering to shape optimization and efficient spline representations of existing airfoil shapes has been discussed and demonstrated the results in all cases indicate a clear benefit gained from parametric model s employment and although our approach has been mainly designed to facilitate the needs of specific isogeometric analysis bem solvers it compares favorably to a wide range of airfoil parametrizations found in literature obviously there is still plenty of room for improvement and further investigation as it has been already discussed in the previous section authors contribution k v kostas mathematical modelling references manuscript preparation revisions implementation of the parametric model along with its variants and modifications a amiralin ann modelling and benchmark examples for naca database nrel databases s sagimbayev implementation of li et al method and relevant benchmark examples t massalov collection of data and preparation of point files y kalel ann modelling and benchmark examples for naca nrel databases c g politis manuscript preparation revisions declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work has received funding from nazarbayev university grant no 090118fd5328 shape optimization of lift and thrust generating surfaces with the aid of isogeometric analysis soltiga 
