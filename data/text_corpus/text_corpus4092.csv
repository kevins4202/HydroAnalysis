index,text
20460,an experiment was conducted in which a solid sphere with a density of 1 875 kg m3 and diameter of 24 8 mm was launched vertically upwards in water towards the air water interface by changing the reynolds number r e based on the launch velocity the motion of the sphere due to interference with the air water interface was investigated along with the behavior of the interface the experimental results of the sphere s vertical position in water agree with the theoretical values however in air the experimental results gave lower vertical positions than the theoretical values when the reynolds number where the sphere reaches the air water interface is r e w 1 0 2 1 0 3 the vertical trajectory of the sphere branches above and below the ensemble average immediately after passing the air water interface this difference in bifurcation does not depend on the reynolds number in water however no branching occurs when r e w 1 is large there is an inverse relationship between the asymmetry of the air water interface that occurs when the sphere passes through the interface and the sphere s maximum displacement it was shown that the energy loss of the sphere and the asymmetry of the air water interface have a linear relationship in all cases with different reynolds numbers this means that there is a invariant relationship between the energy lost by the sphere passing through the air water interface and the asymmetry of the interface keywords water exit gas liquid solid three phase flow air water interface visualization energy loss solid sphere 1 introduction the phenomenon of an object in water moving vertically toward the air water interface is called the water exit haohao et al 2019 tassin et al 2017 the water exit is often observed in marine vessels as well as in the behavior of marine organisms for example a protruding bulb attached to the bow of a large cargo ship commonly called bulbous bow is usually underwater but may push the bow up into the air when the bow is lifted it is known that a pressure loss occurs in such cases endo and yamada 2001 planktons also jump out of the water to escape predation kim et al 2015 chang et al 2019 dolphins and flying fish can jump to cover longer distances elucidation of the phenomenon of marine organisms rising to the water surface is an important topic in marine biology thus it is very important to understand the water exit problem in detail the water exit problem is very complicated because it causes nonlinear interference between the object and the air water interface bhalla et al 2020 in order to deal with such problems a sphere with excellent symmetry has been used in various studies in recent years quantitative evaluation of the energy loss due to a sphere passing through the air water interface has been tried wu et al 2017 carried out an experiment in which a sphere with density lower than that of water rose to the surface of water and floated freely in this study the drag coefficient increased stepwise when the sphere reached the air water interface and decreased abruptly after the sphere passed the interface this indicates that the kinetic energy of the sphere was rapidly transformed into deformation energy of the air water interface takamure and uchiyama 2020c conducted an experiment in which a sphere with a density of 2640 kg m 3 was launched vertically in water toward the air water interface they investigated the energy balance at several submergence depths and demonstrated that the energy loss at the air water interface was small when the submergence depth was shallow but reached an equilibrium state after a certain depth furthermore takamure and uchiyama 2020a investigated the relationship between the energy loss at the air water interface and the behavior of the interfacial water sheet it was clarified that the cross sectional shapes of the interfacial water sheets become self similar when the energy loss reaches the equilibrium state this implies that the energy loss of the sphere and the behavior of the air water interface are closely related the density and reynolds number of the sphere as it moves in water affect the sphere dynamics horowitz and williamson 2010 summarized the effect of sphere density and reynolds number on sphere dynamics in detail they showed that when the specific gravity m and reynolds number r e were m 0 6 and r e 1550 in water the sphere did not have a large periodic motion because of the generation of a wake vortex but did undergo a slight lateral fluctuation takamure and uchiyama 2020b explained that a slight lateral fluctuation of the sphere in water induces an asymmetric behavior of the water surface as it passes through the air water interface and the sphere dynamics themselves were also greatly modulated song et al 2019 demonstrated that the deformation of the free surface depends on the velocity of the object as it passes through the water surface and the spikes occurring behind the sphere can be classified into three scenarios a thin water spike a mixed air water lump followed by a wide water spike and an upside down goblet shaped spike this indicates that the reynolds number is the dominant parameter for the deformation of the free surface from these findings the behavior of the interfacial water sheet just before passing through the air water interface should be investigated in order to understand the relationship between the behavior of the air water interface and the dynamics of the sphere more accurately in this study a solid sphere with a higher density than water was launched vertically in water towards the air water interface a plastic sphere with a diameter of d 24 8 mm and a uniform density of ρ p 1875 kg m 3 was used to suppress fluctuations of the sphere caused by the wake vortex referring to the previous study takamure and uchiyama 2020b the reynolds number when the sphere passed through the water surface was changed by changing the sphere s launch velocity the higher the sphere s launch velocity was the faster it passed through the air water interface resulting in more deformation of the interface this led to a more complex fluid force being exerted on the sphere the interaction between the sphere and the air water interface water surface continued when they were in contact the movement of the sphere and the behavior of the air water interface due to this interaction are very complex and involve many physical events thus the results obtained from repeated experiments were ensemble averaged and evaluated using the obtained statistical values in this study experiments were conducted for three launch velocities reynolds numbers and the movement of the sphere and behavior of the air water interface interfacial water sheet were investigated in detail 2 experimental setup and method details of the experimental apparatus used in this study are mentioned in a paper by takamure and uchiyama 2020a fig 1 a shows the outline of the experimental apparatus water is stored in a cubic acrylic tank of 0 4 m on each side and a sphere launcher is installed in the center of its bottom side when the sphere is installed on the launcher the center of the sphere is defined as the origin x y z 0 0 0 the x y plane is the horizontal direction and the z axis is the vertical direction at this time the distance from the origin to the stationary air water interface is defined as h a cross sectional view of the launcher system is shown in fig 1 b at the center of the launcher a cylinder with a length of 67 mm and an inner diameter of 19 3 mm is placed a sphere of diameter d 24 8 mm is placed at the upper end of the cylinder a cylindrical iron rod with a diameter of 19 1 mm is inserted inside the cylinder and its lower end is connected in series with a coil spring with linear characteristics of compressive displacement of 17 n mm a hexagonal tip with a height of 4 mm and a width of 6 mm is attached to the top end of the iron rod the distance between the hexagonal tip and the bottom of the sphere is 16 6 mm when the sphere is on the launcher the iron rod is pressed down vertically to compress the coil spring and is fixed with a trigger when pulling the trigger to release the coil spring at time t 0 the iron rod moves upwards in the cylinder and strikes the sphere with its upper end and launches it through the water the launch speed of the sphere can be controlled by the compression displacement of the coil spring in this study a plastic sphere with a uniform density of ρ p 1875 kg m 3 was used the contact angle of the sphere used in this study was measured by the sessile drop method ellefson and taylor 1938 the average and standard deviation values of the contact angles of the spheres obtained by 10 measurements were θ 53 3 and θ 4 1 respectively the rising characteristics of the sphere after passing through the air water interface are expected to depend on the ratio ρ ρ p ρ w of the sphere density ρ p to the water density ρ w the archimedes number and the bond number the archimedes number and bond number are defined as a r ρ p ρ w ρ w g d 3 μ 2 and b o ρ p ρ w g d 2 σ respectively where μ is the dynamic viscosity g is the gravitational acceleration and σ is the surface tension the water temperature was approximately 20 c during the experiment therefore ρ w μ and σ were defined as ρ w 998 2 kg m 3 μ 1 002 1 0 3 kg m and σ 0 0728 n m respectively thus the density ratio was ρ 1 88 the archimedes number was a r 1 30 1 0 8 and the bond number was b o 72 6 the back light method takamure and uchiyama 2020a was used to photograph the experiment the inside of the acrylic tank was illuminated by surface emitting leds with a height of 0 34 m and a width of 0 34 m the motion of the sphere and the behavior of the air water interface were simultaneously photographed from the x and y directions the high speed camera nac mx 5 has an effective pixel count of 1920 1080 and a frame rate of 2000 fps the image processing was performed by the same method as takamure and uchiyama 2020a b the coordinates of the sphere were acquired by the hough transform chen and chung 2001 of the edge image obtained by binarizing the image taken in grayscale and executing the sobel operator gonzalez and woods 1992 the maximum measurement error of the sphere in this study is 0 28 mm in this study several reference points were set in the vertical direction as shown in fig 2 the vertical position of the center of the sphere is defined as z p and the vertical velocity at that time is defined as w p when w p takes the maximum value w 0 the time and vertical location of the sphere are defined as t t 0 and z 0 respectively when the bottom of the sphere coincides with the air water interface height z h 2 5 d at the initial time t 0 the position of the sphere the time and the vertical velocity are defined as z p z 1 3 0 t t 1 and w p w 1 respectively the maximum displacement position reached by the sphere in air is defined as z p z 2 and the corresponding time as t t 2 in the present work 120 trials were performed previous studies have shown that the fluid must be still for up to 30 min before the launch in order to obtain consistent and repeatable results takamure and uchiyama 2020c a b therefore a 30 min wait time was used throughout the study 3 equation of motion of the rising sphere the equation of motion of a sphere in water is based on the equation of bubble tracking presented by sommerfeld et al 2018 the contribution of each term is as follows 1 m d u p d t d a m t l f i g b w where m and u p are the mass and the velocity of the sphere respectively here d a m t l f i g b and w denote drag added mass transverse lift fluid inertia gravity buoyancy and wall force respectively among these transverse lift is negligible because the launch sphere has a very slight lateral motion the details are presented in fig 4 furthermore the launch sphere was in a stationary fluid thus the fluid inertia term was excluded in this study the contribution of wall force is ignored for simplicity considering the above the equation of motion of the sphere is expressed as follows 2 m d w p d t d a m g b where w p is the velocity of the sphere in the vertical direction z direction the motion of the sphere is assumed to be one dimensional in the z direction the effect of the added mass because of the movement of the sphere is considered as m a d w p d t here m a is the added mass when the sphere moves in translation it is known that the added mass of the body approaching the free surface is not constant but varying ni and wu 2017 but it was calculated by m a 2 π ρ w 3 d 2 3 using the density of water ρ w which is commonly used in this study drag d depends on the reynolds number it is general knowledge that newton s law expresses the drag being proportional to the square of the velocity and valid when r e 1 0 4 in this study it is assumed that d is proportional to the square of the velocity as the reynolds number is based on the initial velocity w 0 and the diameter of the sphere d is r e 1 0 4 based on the discussion above the equation of motion of the sphere in water is expressed as 3 m m a d w p d t ρ p ρ w v g 1 2 c d ρ w a w p t 2 here the volume of the sphere is v the projected area of the sphere is a the gravitational acceleration is g and the drag coefficient is c d introducing 4 e 2 c d ρ w a 2 ρ p ρ w v g and integrating using the intermediate e w p tan θ 2 π θ 0 eq 3 can be summarized as 5 w p t 1 e tan e ρ p ρ w m m a v g t t 0 c 0 here c 0 can be expressed as c 0 tan 1 w 0 e therefore the position of the sphere z p at time t is expressed by 6 z p t t 0 t 1 1 e tan e ρ p ρ w m m a v g t t 0 c 0 d t on the other hand the equation of motion of a sphere rising in air is expressed as 7 m d w p t d t m g 1 2 c d ρ a a w p t 2 where ρ a is the density of air at w p t 0 eq 7 can be rewritten as 8 w p t 2 m g c d ρ a a tan c d ρ a a g 2 m t t 1 c 1 here c 1 can be expressed as c 1 tan 1 w 1 c d ρ a a 2 m g from eq 8 the position z p of the sphere is expressed by 9 z p t t 1 t 2 2 m g c d ρ a a tan c d ρ a a g 2 m t t 1 c 1 d t it is known that the drag coefficient c d depends on the reynolds number and the flow fields walter 2019 brown and lawler 2003 chen et al 2006 in this study c d was calculated by the model formula proposed by morrison 2013 c d is expressed by 10 c d 24 r e 2 6 r e 5 0 1 r e 5 0 1 52 0 411 r e 2 63 1 0 5 7 94 1 r e 2 63 1 0 5 8 00 0 25 r e 1 0 6 1 r e 1 0 6 eq 10 is known to match well with other models of the sphere thus high accuracy is guaranteed tiwari et al 2019 4 results 4 1 characteristics of spheres launched at different velocities in this study the sphere was launched at three different velocities i e reynolds number cases i ii and iii are named in ascending order of launch velocity 40 repeat experiments were performed for each case table 1 shows the ensemble averaged properties of the sphere motion at several typical heights defined in fig 2 here the superscript bar e g z p and w p means the ensemble average the reynolds numbers at heights z 0 r e w 0 was calculated using the kinematic viscosity coefficient of water ν 1 003 1 0 6 m 2 s and the reynolds number at the height of z 1 r e w 1 was calculated using the kinematic viscosity coefficient of air ν 1 512 1 0 5 m 2 s f r 1 and w e 1 are the froude number and weber number at the height of z 1 respectively and they are calculated by 11 f r 1 w 1 d g 12 w e 1 ρ w d w 1 2 σ in order to get an idea of the experimental situation in this research fig 3 shows an example visualization image for case ii the air water interface remains horizontally stationary at immediately after launching the sphere but the interface is deformed upwards at z p d 1 65 fig 3 a after the sphere passes through the air water interface fig 3 b the interface behind the sphere is disturbed and entrained by the sphere after that the air water interface entrained by the sphere is complexly disturbed while forming a water mass as the sphere rises further the water mass spreads in an axisymmetric sheet form fig 3 c at this time the water column between the sphere and the air water interface is stretched and the width of the water column becomes narrower at the center at the time when the sphere reaches its maximum displacement fig 3 d the width of the water column becomes uniform in the vertical direction and its width becomes thinner with time in addition part of the water mass is scattered as spherical drops however the water column generated between the stationary interface z d 2 5 and the sphere continues to form until the sphere reaches maximum displacement position and most of the water mass entrained by the sphere remains attached to the sphere this series of tendencies is similar in other cases fig 4 shows the trajectories in the x z and y z planes from immediately after the sphere is launched t 0 to the time when the maximum displacement position is reached t t 2 here the horizontal and vertical axes are normalized by the diameter d of the sphere each graph shows six representative measurements from the 40 repeats the maximum displacement position z 2 of the sphere is lowest in case i and highest in case iii in all cases the trajectory of the sphere follows a nearly vertical line x y 0 for all positions from launch to its maximum displacement the deviation of the sphere position from the central axis x p 2 y p 2 d is less than 0 2 in all cases thus the sphere is regarded as having one dimensional movement in the vertical direction fig 5 shows the ensemble averaged value of the time variation of the vertical displacement z p until the sphere reaches maximum displacement z 2 the error bars in fig 5 indicate the standard error in the iterative experiment here z p is normalized by the diameter d of the sphere in addition the horizontal axis shows the time t t 0 after subtracting the time t 0 when the sphere reaches maximum velocity w 0 t 0 is approximately 0 02 s in all cases at t t 0 0 the sphere position z p d is 0 5 for case i 0 8 for case ii and 1 0 for case iii the larger the maximum velocity w 0 the faster the sphere passes through the air water interface and the higher the maximum displacement position z 2 fig 6 compare the experimental results and theoretical values of the time variation of z p until the sphere reaches z 2 the black solid line red broken line and blue alternate long and short dashed line in fig 6 are the ensemble averaged results of cases i ii and iii respectively fig 6 a compares the experimental results and the theoretical values obtained from eq 6 for a sphere rising in water here fig 6 a is shifted so that z 0 and t 0 are at the origin and the time t t 0 is normalized by t 0 d w 0 the arrows in fig 6 a indicate the position of the air water interface z d 2 5 and the color of the arrow corresponds to the color of the line and plot in the graph when the sphere is in water z p z 0 d 2 the experimental results and theoretical values agree well fig 6 b compares the experimental results and the theoretical values obtained from eq 9 for a sphere rising in air here fig 6 b is shifted so that z 1 and t 1 take the origin and the time t t 1 is normalized by t 1 d w 1 when the sphere is in air z p z 1 d 0 the experimental value is always smaller than the theoretical value this is because in the experiment although the sphere induces a water column and water masses after it passes through the air water interface eq 9 does not consider the effect of the interface on the sphere the ratio of z 2 between the experimental and theoretical values is 2 1 times for case i 1 9 times for case ii and 1 7 times for case iii therefore the smaller the w 0 of the sphere the smaller the reynolds number r e w 0 the larger the proportion of energy lost from the sphere fig 7 shows the time variation of z p for the six representative experimental results of the behavior of the sphere shown in fig 4 the solid line in fig 7 is the ensemble average z p shown in fig 5 in case i the results of the six experiments are consistent until the sphere passes through the air water interface z p d 2 5 however after the sphere passes through the air water interface z p d 2 5 the vertical trajectory branches above and below the ensemble averaged line when the experimental value is lower than the ensemble average at z p d 2 5 we refer to it as pattern α similarly when the experimental value is higher than the ensemble average it is called pattern β the results of 40 repeated experiments were classified as pattern α or pattern β in contrast the results of six experiments in case ii and case iii almost collapse with the result of the ensemble average at all times by taking the distribution of the vertical position of the sphere at the time of a i in fig 7 the dispersion of the distribution of each case in the repeated experiment is investigated fig 8 shows the probability density function of the vertical position z p of the sphere at times a to i correspond to the times indicated by a i in fig 7 the broken line shows the mean value of the z p d distribution here in fig 8 a to c corresponding to the result of case i the case that converges to pattern α is shown in red and the case that converges to pattern β is shown in blue in case i when the sphere is moving in water fig 8 a the probability density function of both patterns takes the mode value at z p d 1 8 at this time there is no difference in the tendency between pattern α and pattern β this indicates that the motion of the sphere in air does not depend on the reynolds number in water in other words the reynolds number in water is not the underlying factor affecting the sphere s branching into pattern α or pattern β when the sphere passes the air water interface fig 8 b pattern α is distributed in a region smaller than the mean value of z p d and pattern β is distributed in a region larger than the mean value of z p d this tendency becomes more prominent at the time when the sphere is rising in air fig 8 c and the distributions of pattern α and pattern β are completely independent the locations of the mode values of pattern α and pattern β are z p d 3 0 and 3 6 respectively in fig 8 d f which corresponds to case ii the mode value for the probability density function corresponds to the location of the mean value of z p d and the distribution decreases with increasing distance from the location of taking the mode value this tendency is the same in fig 8 g i corresponding to case iii 4 2 effect of the asymmetry of the air water interface on the motion of the sphere there was a clear difference in the maximum displacement position between pattern α and pattern β in case i despite the velocity reynolds number of the sphere at the time when the sphere passes the air water interface being almost equal the reason for this is though to be that the sphere loses energy because the kinetic energy of the sphere is transferred to the kinetic energy of the air water interface when the sphere passes through the interface to clarify the relationship between the interface shape and the energy consumption of the sphere we focused on the shape of the air water interface when the sphere passes through it and the maximum displacement position of the sphere after that in this section the relationship between the asymmetry of the interface at the time when the center of the sphere is at z p d 2 5 and the maximum displacement position of the sphere is investigated fig 9 a shows an example photograph of the sphere and air water interface at z p d 2 5 the binarized version of fig 9 a is fig 9 b which also includes an outline of some parameters defined to quantify the asymmetry of the interface the deformation starting position illustrated by point p of the stationary interface illustrated by red dashed line is detected in the x axis direction or y axis direction the distance between point p and the central axis is defined as d p x and d n x or d p y and d n y in the case of the y axis direction the asymmetry of the water surface air water interface is evaluated by eq 13 13 d p n d p x d n x 2 d p y d n y 2 fig 10 shows the probability density function of d p n the red and blue areas in case i correspond to pattern α and pattern β respectively from fig 10 a the distribution of the probability density function of d p n in case i is clearly divided into pattern α and pattern β the asymmetry of the interfaces of pattern α and pattern β are 0 12 d p n d 0 24 and 0 d p n d 0 16 respectively and therefore pattern β is less asymmetric than pattern α in case ii the mode value of the probability density function of d p n d is distributed in the range of 0 04 d p n d 0 12 and it decreases monotonously along both sides from the position of the mode value in case iii the mode value of the probability density function of d p n d is distributed in the range of 0 04 d p n d 0 08 which is smaller than the position of the mode value of d p n d in case ii fig 11 shows the relationship between the asymmetry d p n and the maximum displacement position z 2 there is an inverse relationship between z 2 and d p n for all cases that is the larger the asymmetry of the air water interface d p n when the sphere passes through the interface the lower the maximum displacement position of the sphere the broken line in fig 11 is an approximate line calculated by the least square method the results of approximate straight lines for case i r e w 1 0 2 1 0 3 case ii r e w 1 2 3 1 0 3 and case iii r e w 1 3 2 1 0 3 are z p 4 3 d p n z p 3 5 d p n and z p 3 5 d p n respectively the energy loss of the sphere is due to the nonlinear interference between the sphere and the water surface air water interface to clarify the relationship between such energy loss and the asymmetry of the air water interface d p n the ratio e p z 2 e k z 1 corresponding to the kinetic energy e k immediately after the sphere passes the air water interface z 1 to the potential energy e p at the maximum displacement position z 2 was investigated in particular this ratio indicated the amount of kinetic energy of the sphere converted to potential energy immediately after the sphere passed through the air water interface the dependence of e p z 2 e k z 1 on d p n is shown in fig 12 the kinetic energy is defined as e k z 1 1 2 m w p z 1 2 and the potential energy is defined as e p z 2 m g z 2 z 1 the larger the asymmetry of the air water interface the more kinetic energy the sphere loses the broken line in fig 12 is an approximate line calculated by the least square method the slope of the broken line in each case is different slopes of the approximate straight line for case i case ii and case iii are e p z 2 e k z 1 0 59 d p n e p z 2 e k z 1 0 29 d p n and e p z 2 e k z 1 0 22 d p n respectively to further clarify the relationship between the energy loss of the sphere and the asymmetry of the air water interface d p n is normalized by the width of the upwardly convex water surface d p here d p is given by the following equation 14 d p d p x d n x d p y d n y 2 the result is shown in fig 13 in all cases with different reynolds numbers e p z 2 e k z 1 is distributed on the straight line of e p z 2 e k z 1 0 84 d p n d p this means that there is a invariant relationship between the energy loss by the sphere passing through the air water interface and the asymmetry of the interface this result is an important finding for constructing the model formula of energy loss in water exit when dealing with the phenomenon of water entry we generally assume a symmetric water surface i e a symmetric interface is modeled however this is an ideal case in the real world the interface is often asymmetric e g a fish or plankton jumping onto the water surface and hence the motion characteristics of the object should change compared to the symmetric water surface interface asymmetry should be considered in the water exit model and the findings obtained in this study will help improve the model versatility 5 conclusion an experiment was conducted in which a solid sphere with a density of 1875 kg m 3 and diameter of 24 8 mm was launched vertically upwards in water towards the air water interface by changing the reynolds number based on the launch velocity the motion of the sphere due to interference with the air water interface was investigated along with the behavior of the interface the results are summarized as follows 1 the experimental results for the sphere s vertical position in water agree with the theoretical values however in air the experimental values give lower vertical positions than the theoretical ones 2 when the reynolds number where the sphere reaches the air water interface is r e w 1 0 2 1 0 3 the vertical trajectory of the sphere branches above and below the ensemble average immediately after passing the air water interface this difference in bifurcation does not depend on the reynolds number in water however no branching occurs when r e w 1 is large 3 there is an inverse relationship between the asymmetry of the air water interface that occurs when the sphere passes through the interface and the maximum displacement position of the sphere 4 in all cases with different reynolds numbers the energy loss of sphere e p z 2 e k z 1 is distributed on the straight line of e p z 2 e k z 1 0 84 d p n d p this means that there is a invariant relationship between the energy lost by the sphere passing through the air water interface and the asymmetry of the interface credit authorship contribution statement k takamure conception and design of study acquisition of data analysis and or interpretation of data writing original draft t uchiyama conception and design of study writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment all authors approved the version of the manuscript to be published appendix it is expected that the resistance of the air is much smaller when the sphere is in the air hence the term of air resistance in eq 7 is deleted to evaluate the contribution of air resistance when the air resistance term is deleted in eq 7 the position of z p of the sphere becomes as follows a 1 z p t 1 2 g t t 1 2 w 1 t t 1 z 1 fig a 1 compares the results obtained from eq 9 and eq a 1 according to fig a 1 these curves obtained by the graphs of eq 9 shown by the plot and eq a 1 shown by the solid line align confirming the resistance of the air is much smaller 
20460,an experiment was conducted in which a solid sphere with a density of 1 875 kg m3 and diameter of 24 8 mm was launched vertically upwards in water towards the air water interface by changing the reynolds number r e based on the launch velocity the motion of the sphere due to interference with the air water interface was investigated along with the behavior of the interface the experimental results of the sphere s vertical position in water agree with the theoretical values however in air the experimental results gave lower vertical positions than the theoretical values when the reynolds number where the sphere reaches the air water interface is r e w 1 0 2 1 0 3 the vertical trajectory of the sphere branches above and below the ensemble average immediately after passing the air water interface this difference in bifurcation does not depend on the reynolds number in water however no branching occurs when r e w 1 is large there is an inverse relationship between the asymmetry of the air water interface that occurs when the sphere passes through the interface and the sphere s maximum displacement it was shown that the energy loss of the sphere and the asymmetry of the air water interface have a linear relationship in all cases with different reynolds numbers this means that there is a invariant relationship between the energy lost by the sphere passing through the air water interface and the asymmetry of the interface keywords water exit gas liquid solid three phase flow air water interface visualization energy loss solid sphere 1 introduction the phenomenon of an object in water moving vertically toward the air water interface is called the water exit haohao et al 2019 tassin et al 2017 the water exit is often observed in marine vessels as well as in the behavior of marine organisms for example a protruding bulb attached to the bow of a large cargo ship commonly called bulbous bow is usually underwater but may push the bow up into the air when the bow is lifted it is known that a pressure loss occurs in such cases endo and yamada 2001 planktons also jump out of the water to escape predation kim et al 2015 chang et al 2019 dolphins and flying fish can jump to cover longer distances elucidation of the phenomenon of marine organisms rising to the water surface is an important topic in marine biology thus it is very important to understand the water exit problem in detail the water exit problem is very complicated because it causes nonlinear interference between the object and the air water interface bhalla et al 2020 in order to deal with such problems a sphere with excellent symmetry has been used in various studies in recent years quantitative evaluation of the energy loss due to a sphere passing through the air water interface has been tried wu et al 2017 carried out an experiment in which a sphere with density lower than that of water rose to the surface of water and floated freely in this study the drag coefficient increased stepwise when the sphere reached the air water interface and decreased abruptly after the sphere passed the interface this indicates that the kinetic energy of the sphere was rapidly transformed into deformation energy of the air water interface takamure and uchiyama 2020c conducted an experiment in which a sphere with a density of 2640 kg m 3 was launched vertically in water toward the air water interface they investigated the energy balance at several submergence depths and demonstrated that the energy loss at the air water interface was small when the submergence depth was shallow but reached an equilibrium state after a certain depth furthermore takamure and uchiyama 2020a investigated the relationship between the energy loss at the air water interface and the behavior of the interfacial water sheet it was clarified that the cross sectional shapes of the interfacial water sheets become self similar when the energy loss reaches the equilibrium state this implies that the energy loss of the sphere and the behavior of the air water interface are closely related the density and reynolds number of the sphere as it moves in water affect the sphere dynamics horowitz and williamson 2010 summarized the effect of sphere density and reynolds number on sphere dynamics in detail they showed that when the specific gravity m and reynolds number r e were m 0 6 and r e 1550 in water the sphere did not have a large periodic motion because of the generation of a wake vortex but did undergo a slight lateral fluctuation takamure and uchiyama 2020b explained that a slight lateral fluctuation of the sphere in water induces an asymmetric behavior of the water surface as it passes through the air water interface and the sphere dynamics themselves were also greatly modulated song et al 2019 demonstrated that the deformation of the free surface depends on the velocity of the object as it passes through the water surface and the spikes occurring behind the sphere can be classified into three scenarios a thin water spike a mixed air water lump followed by a wide water spike and an upside down goblet shaped spike this indicates that the reynolds number is the dominant parameter for the deformation of the free surface from these findings the behavior of the interfacial water sheet just before passing through the air water interface should be investigated in order to understand the relationship between the behavior of the air water interface and the dynamics of the sphere more accurately in this study a solid sphere with a higher density than water was launched vertically in water towards the air water interface a plastic sphere with a diameter of d 24 8 mm and a uniform density of ρ p 1875 kg m 3 was used to suppress fluctuations of the sphere caused by the wake vortex referring to the previous study takamure and uchiyama 2020b the reynolds number when the sphere passed through the water surface was changed by changing the sphere s launch velocity the higher the sphere s launch velocity was the faster it passed through the air water interface resulting in more deformation of the interface this led to a more complex fluid force being exerted on the sphere the interaction between the sphere and the air water interface water surface continued when they were in contact the movement of the sphere and the behavior of the air water interface due to this interaction are very complex and involve many physical events thus the results obtained from repeated experiments were ensemble averaged and evaluated using the obtained statistical values in this study experiments were conducted for three launch velocities reynolds numbers and the movement of the sphere and behavior of the air water interface interfacial water sheet were investigated in detail 2 experimental setup and method details of the experimental apparatus used in this study are mentioned in a paper by takamure and uchiyama 2020a fig 1 a shows the outline of the experimental apparatus water is stored in a cubic acrylic tank of 0 4 m on each side and a sphere launcher is installed in the center of its bottom side when the sphere is installed on the launcher the center of the sphere is defined as the origin x y z 0 0 0 the x y plane is the horizontal direction and the z axis is the vertical direction at this time the distance from the origin to the stationary air water interface is defined as h a cross sectional view of the launcher system is shown in fig 1 b at the center of the launcher a cylinder with a length of 67 mm and an inner diameter of 19 3 mm is placed a sphere of diameter d 24 8 mm is placed at the upper end of the cylinder a cylindrical iron rod with a diameter of 19 1 mm is inserted inside the cylinder and its lower end is connected in series with a coil spring with linear characteristics of compressive displacement of 17 n mm a hexagonal tip with a height of 4 mm and a width of 6 mm is attached to the top end of the iron rod the distance between the hexagonal tip and the bottom of the sphere is 16 6 mm when the sphere is on the launcher the iron rod is pressed down vertically to compress the coil spring and is fixed with a trigger when pulling the trigger to release the coil spring at time t 0 the iron rod moves upwards in the cylinder and strikes the sphere with its upper end and launches it through the water the launch speed of the sphere can be controlled by the compression displacement of the coil spring in this study a plastic sphere with a uniform density of ρ p 1875 kg m 3 was used the contact angle of the sphere used in this study was measured by the sessile drop method ellefson and taylor 1938 the average and standard deviation values of the contact angles of the spheres obtained by 10 measurements were θ 53 3 and θ 4 1 respectively the rising characteristics of the sphere after passing through the air water interface are expected to depend on the ratio ρ ρ p ρ w of the sphere density ρ p to the water density ρ w the archimedes number and the bond number the archimedes number and bond number are defined as a r ρ p ρ w ρ w g d 3 μ 2 and b o ρ p ρ w g d 2 σ respectively where μ is the dynamic viscosity g is the gravitational acceleration and σ is the surface tension the water temperature was approximately 20 c during the experiment therefore ρ w μ and σ were defined as ρ w 998 2 kg m 3 μ 1 002 1 0 3 kg m and σ 0 0728 n m respectively thus the density ratio was ρ 1 88 the archimedes number was a r 1 30 1 0 8 and the bond number was b o 72 6 the back light method takamure and uchiyama 2020a was used to photograph the experiment the inside of the acrylic tank was illuminated by surface emitting leds with a height of 0 34 m and a width of 0 34 m the motion of the sphere and the behavior of the air water interface were simultaneously photographed from the x and y directions the high speed camera nac mx 5 has an effective pixel count of 1920 1080 and a frame rate of 2000 fps the image processing was performed by the same method as takamure and uchiyama 2020a b the coordinates of the sphere were acquired by the hough transform chen and chung 2001 of the edge image obtained by binarizing the image taken in grayscale and executing the sobel operator gonzalez and woods 1992 the maximum measurement error of the sphere in this study is 0 28 mm in this study several reference points were set in the vertical direction as shown in fig 2 the vertical position of the center of the sphere is defined as z p and the vertical velocity at that time is defined as w p when w p takes the maximum value w 0 the time and vertical location of the sphere are defined as t t 0 and z 0 respectively when the bottom of the sphere coincides with the air water interface height z h 2 5 d at the initial time t 0 the position of the sphere the time and the vertical velocity are defined as z p z 1 3 0 t t 1 and w p w 1 respectively the maximum displacement position reached by the sphere in air is defined as z p z 2 and the corresponding time as t t 2 in the present work 120 trials were performed previous studies have shown that the fluid must be still for up to 30 min before the launch in order to obtain consistent and repeatable results takamure and uchiyama 2020c a b therefore a 30 min wait time was used throughout the study 3 equation of motion of the rising sphere the equation of motion of a sphere in water is based on the equation of bubble tracking presented by sommerfeld et al 2018 the contribution of each term is as follows 1 m d u p d t d a m t l f i g b w where m and u p are the mass and the velocity of the sphere respectively here d a m t l f i g b and w denote drag added mass transverse lift fluid inertia gravity buoyancy and wall force respectively among these transverse lift is negligible because the launch sphere has a very slight lateral motion the details are presented in fig 4 furthermore the launch sphere was in a stationary fluid thus the fluid inertia term was excluded in this study the contribution of wall force is ignored for simplicity considering the above the equation of motion of the sphere is expressed as follows 2 m d w p d t d a m g b where w p is the velocity of the sphere in the vertical direction z direction the motion of the sphere is assumed to be one dimensional in the z direction the effect of the added mass because of the movement of the sphere is considered as m a d w p d t here m a is the added mass when the sphere moves in translation it is known that the added mass of the body approaching the free surface is not constant but varying ni and wu 2017 but it was calculated by m a 2 π ρ w 3 d 2 3 using the density of water ρ w which is commonly used in this study drag d depends on the reynolds number it is general knowledge that newton s law expresses the drag being proportional to the square of the velocity and valid when r e 1 0 4 in this study it is assumed that d is proportional to the square of the velocity as the reynolds number is based on the initial velocity w 0 and the diameter of the sphere d is r e 1 0 4 based on the discussion above the equation of motion of the sphere in water is expressed as 3 m m a d w p d t ρ p ρ w v g 1 2 c d ρ w a w p t 2 here the volume of the sphere is v the projected area of the sphere is a the gravitational acceleration is g and the drag coefficient is c d introducing 4 e 2 c d ρ w a 2 ρ p ρ w v g and integrating using the intermediate e w p tan θ 2 π θ 0 eq 3 can be summarized as 5 w p t 1 e tan e ρ p ρ w m m a v g t t 0 c 0 here c 0 can be expressed as c 0 tan 1 w 0 e therefore the position of the sphere z p at time t is expressed by 6 z p t t 0 t 1 1 e tan e ρ p ρ w m m a v g t t 0 c 0 d t on the other hand the equation of motion of a sphere rising in air is expressed as 7 m d w p t d t m g 1 2 c d ρ a a w p t 2 where ρ a is the density of air at w p t 0 eq 7 can be rewritten as 8 w p t 2 m g c d ρ a a tan c d ρ a a g 2 m t t 1 c 1 here c 1 can be expressed as c 1 tan 1 w 1 c d ρ a a 2 m g from eq 8 the position z p of the sphere is expressed by 9 z p t t 1 t 2 2 m g c d ρ a a tan c d ρ a a g 2 m t t 1 c 1 d t it is known that the drag coefficient c d depends on the reynolds number and the flow fields walter 2019 brown and lawler 2003 chen et al 2006 in this study c d was calculated by the model formula proposed by morrison 2013 c d is expressed by 10 c d 24 r e 2 6 r e 5 0 1 r e 5 0 1 52 0 411 r e 2 63 1 0 5 7 94 1 r e 2 63 1 0 5 8 00 0 25 r e 1 0 6 1 r e 1 0 6 eq 10 is known to match well with other models of the sphere thus high accuracy is guaranteed tiwari et al 2019 4 results 4 1 characteristics of spheres launched at different velocities in this study the sphere was launched at three different velocities i e reynolds number cases i ii and iii are named in ascending order of launch velocity 40 repeat experiments were performed for each case table 1 shows the ensemble averaged properties of the sphere motion at several typical heights defined in fig 2 here the superscript bar e g z p and w p means the ensemble average the reynolds numbers at heights z 0 r e w 0 was calculated using the kinematic viscosity coefficient of water ν 1 003 1 0 6 m 2 s and the reynolds number at the height of z 1 r e w 1 was calculated using the kinematic viscosity coefficient of air ν 1 512 1 0 5 m 2 s f r 1 and w e 1 are the froude number and weber number at the height of z 1 respectively and they are calculated by 11 f r 1 w 1 d g 12 w e 1 ρ w d w 1 2 σ in order to get an idea of the experimental situation in this research fig 3 shows an example visualization image for case ii the air water interface remains horizontally stationary at immediately after launching the sphere but the interface is deformed upwards at z p d 1 65 fig 3 a after the sphere passes through the air water interface fig 3 b the interface behind the sphere is disturbed and entrained by the sphere after that the air water interface entrained by the sphere is complexly disturbed while forming a water mass as the sphere rises further the water mass spreads in an axisymmetric sheet form fig 3 c at this time the water column between the sphere and the air water interface is stretched and the width of the water column becomes narrower at the center at the time when the sphere reaches its maximum displacement fig 3 d the width of the water column becomes uniform in the vertical direction and its width becomes thinner with time in addition part of the water mass is scattered as spherical drops however the water column generated between the stationary interface z d 2 5 and the sphere continues to form until the sphere reaches maximum displacement position and most of the water mass entrained by the sphere remains attached to the sphere this series of tendencies is similar in other cases fig 4 shows the trajectories in the x z and y z planes from immediately after the sphere is launched t 0 to the time when the maximum displacement position is reached t t 2 here the horizontal and vertical axes are normalized by the diameter d of the sphere each graph shows six representative measurements from the 40 repeats the maximum displacement position z 2 of the sphere is lowest in case i and highest in case iii in all cases the trajectory of the sphere follows a nearly vertical line x y 0 for all positions from launch to its maximum displacement the deviation of the sphere position from the central axis x p 2 y p 2 d is less than 0 2 in all cases thus the sphere is regarded as having one dimensional movement in the vertical direction fig 5 shows the ensemble averaged value of the time variation of the vertical displacement z p until the sphere reaches maximum displacement z 2 the error bars in fig 5 indicate the standard error in the iterative experiment here z p is normalized by the diameter d of the sphere in addition the horizontal axis shows the time t t 0 after subtracting the time t 0 when the sphere reaches maximum velocity w 0 t 0 is approximately 0 02 s in all cases at t t 0 0 the sphere position z p d is 0 5 for case i 0 8 for case ii and 1 0 for case iii the larger the maximum velocity w 0 the faster the sphere passes through the air water interface and the higher the maximum displacement position z 2 fig 6 compare the experimental results and theoretical values of the time variation of z p until the sphere reaches z 2 the black solid line red broken line and blue alternate long and short dashed line in fig 6 are the ensemble averaged results of cases i ii and iii respectively fig 6 a compares the experimental results and the theoretical values obtained from eq 6 for a sphere rising in water here fig 6 a is shifted so that z 0 and t 0 are at the origin and the time t t 0 is normalized by t 0 d w 0 the arrows in fig 6 a indicate the position of the air water interface z d 2 5 and the color of the arrow corresponds to the color of the line and plot in the graph when the sphere is in water z p z 0 d 2 the experimental results and theoretical values agree well fig 6 b compares the experimental results and the theoretical values obtained from eq 9 for a sphere rising in air here fig 6 b is shifted so that z 1 and t 1 take the origin and the time t t 1 is normalized by t 1 d w 1 when the sphere is in air z p z 1 d 0 the experimental value is always smaller than the theoretical value this is because in the experiment although the sphere induces a water column and water masses after it passes through the air water interface eq 9 does not consider the effect of the interface on the sphere the ratio of z 2 between the experimental and theoretical values is 2 1 times for case i 1 9 times for case ii and 1 7 times for case iii therefore the smaller the w 0 of the sphere the smaller the reynolds number r e w 0 the larger the proportion of energy lost from the sphere fig 7 shows the time variation of z p for the six representative experimental results of the behavior of the sphere shown in fig 4 the solid line in fig 7 is the ensemble average z p shown in fig 5 in case i the results of the six experiments are consistent until the sphere passes through the air water interface z p d 2 5 however after the sphere passes through the air water interface z p d 2 5 the vertical trajectory branches above and below the ensemble averaged line when the experimental value is lower than the ensemble average at z p d 2 5 we refer to it as pattern α similarly when the experimental value is higher than the ensemble average it is called pattern β the results of 40 repeated experiments were classified as pattern α or pattern β in contrast the results of six experiments in case ii and case iii almost collapse with the result of the ensemble average at all times by taking the distribution of the vertical position of the sphere at the time of a i in fig 7 the dispersion of the distribution of each case in the repeated experiment is investigated fig 8 shows the probability density function of the vertical position z p of the sphere at times a to i correspond to the times indicated by a i in fig 7 the broken line shows the mean value of the z p d distribution here in fig 8 a to c corresponding to the result of case i the case that converges to pattern α is shown in red and the case that converges to pattern β is shown in blue in case i when the sphere is moving in water fig 8 a the probability density function of both patterns takes the mode value at z p d 1 8 at this time there is no difference in the tendency between pattern α and pattern β this indicates that the motion of the sphere in air does not depend on the reynolds number in water in other words the reynolds number in water is not the underlying factor affecting the sphere s branching into pattern α or pattern β when the sphere passes the air water interface fig 8 b pattern α is distributed in a region smaller than the mean value of z p d and pattern β is distributed in a region larger than the mean value of z p d this tendency becomes more prominent at the time when the sphere is rising in air fig 8 c and the distributions of pattern α and pattern β are completely independent the locations of the mode values of pattern α and pattern β are z p d 3 0 and 3 6 respectively in fig 8 d f which corresponds to case ii the mode value for the probability density function corresponds to the location of the mean value of z p d and the distribution decreases with increasing distance from the location of taking the mode value this tendency is the same in fig 8 g i corresponding to case iii 4 2 effect of the asymmetry of the air water interface on the motion of the sphere there was a clear difference in the maximum displacement position between pattern α and pattern β in case i despite the velocity reynolds number of the sphere at the time when the sphere passes the air water interface being almost equal the reason for this is though to be that the sphere loses energy because the kinetic energy of the sphere is transferred to the kinetic energy of the air water interface when the sphere passes through the interface to clarify the relationship between the interface shape and the energy consumption of the sphere we focused on the shape of the air water interface when the sphere passes through it and the maximum displacement position of the sphere after that in this section the relationship between the asymmetry of the interface at the time when the center of the sphere is at z p d 2 5 and the maximum displacement position of the sphere is investigated fig 9 a shows an example photograph of the sphere and air water interface at z p d 2 5 the binarized version of fig 9 a is fig 9 b which also includes an outline of some parameters defined to quantify the asymmetry of the interface the deformation starting position illustrated by point p of the stationary interface illustrated by red dashed line is detected in the x axis direction or y axis direction the distance between point p and the central axis is defined as d p x and d n x or d p y and d n y in the case of the y axis direction the asymmetry of the water surface air water interface is evaluated by eq 13 13 d p n d p x d n x 2 d p y d n y 2 fig 10 shows the probability density function of d p n the red and blue areas in case i correspond to pattern α and pattern β respectively from fig 10 a the distribution of the probability density function of d p n in case i is clearly divided into pattern α and pattern β the asymmetry of the interfaces of pattern α and pattern β are 0 12 d p n d 0 24 and 0 d p n d 0 16 respectively and therefore pattern β is less asymmetric than pattern α in case ii the mode value of the probability density function of d p n d is distributed in the range of 0 04 d p n d 0 12 and it decreases monotonously along both sides from the position of the mode value in case iii the mode value of the probability density function of d p n d is distributed in the range of 0 04 d p n d 0 08 which is smaller than the position of the mode value of d p n d in case ii fig 11 shows the relationship between the asymmetry d p n and the maximum displacement position z 2 there is an inverse relationship between z 2 and d p n for all cases that is the larger the asymmetry of the air water interface d p n when the sphere passes through the interface the lower the maximum displacement position of the sphere the broken line in fig 11 is an approximate line calculated by the least square method the results of approximate straight lines for case i r e w 1 0 2 1 0 3 case ii r e w 1 2 3 1 0 3 and case iii r e w 1 3 2 1 0 3 are z p 4 3 d p n z p 3 5 d p n and z p 3 5 d p n respectively the energy loss of the sphere is due to the nonlinear interference between the sphere and the water surface air water interface to clarify the relationship between such energy loss and the asymmetry of the air water interface d p n the ratio e p z 2 e k z 1 corresponding to the kinetic energy e k immediately after the sphere passes the air water interface z 1 to the potential energy e p at the maximum displacement position z 2 was investigated in particular this ratio indicated the amount of kinetic energy of the sphere converted to potential energy immediately after the sphere passed through the air water interface the dependence of e p z 2 e k z 1 on d p n is shown in fig 12 the kinetic energy is defined as e k z 1 1 2 m w p z 1 2 and the potential energy is defined as e p z 2 m g z 2 z 1 the larger the asymmetry of the air water interface the more kinetic energy the sphere loses the broken line in fig 12 is an approximate line calculated by the least square method the slope of the broken line in each case is different slopes of the approximate straight line for case i case ii and case iii are e p z 2 e k z 1 0 59 d p n e p z 2 e k z 1 0 29 d p n and e p z 2 e k z 1 0 22 d p n respectively to further clarify the relationship between the energy loss of the sphere and the asymmetry of the air water interface d p n is normalized by the width of the upwardly convex water surface d p here d p is given by the following equation 14 d p d p x d n x d p y d n y 2 the result is shown in fig 13 in all cases with different reynolds numbers e p z 2 e k z 1 is distributed on the straight line of e p z 2 e k z 1 0 84 d p n d p this means that there is a invariant relationship between the energy loss by the sphere passing through the air water interface and the asymmetry of the interface this result is an important finding for constructing the model formula of energy loss in water exit when dealing with the phenomenon of water entry we generally assume a symmetric water surface i e a symmetric interface is modeled however this is an ideal case in the real world the interface is often asymmetric e g a fish or plankton jumping onto the water surface and hence the motion characteristics of the object should change compared to the symmetric water surface interface asymmetry should be considered in the water exit model and the findings obtained in this study will help improve the model versatility 5 conclusion an experiment was conducted in which a solid sphere with a density of 1875 kg m 3 and diameter of 24 8 mm was launched vertically upwards in water towards the air water interface by changing the reynolds number based on the launch velocity the motion of the sphere due to interference with the air water interface was investigated along with the behavior of the interface the results are summarized as follows 1 the experimental results for the sphere s vertical position in water agree with the theoretical values however in air the experimental values give lower vertical positions than the theoretical ones 2 when the reynolds number where the sphere reaches the air water interface is r e w 1 0 2 1 0 3 the vertical trajectory of the sphere branches above and below the ensemble average immediately after passing the air water interface this difference in bifurcation does not depend on the reynolds number in water however no branching occurs when r e w 1 is large 3 there is an inverse relationship between the asymmetry of the air water interface that occurs when the sphere passes through the interface and the maximum displacement position of the sphere 4 in all cases with different reynolds numbers the energy loss of sphere e p z 2 e k z 1 is distributed on the straight line of e p z 2 e k z 1 0 84 d p n d p this means that there is a invariant relationship between the energy lost by the sphere passing through the air water interface and the asymmetry of the interface credit authorship contribution statement k takamure conception and design of study acquisition of data analysis and or interpretation of data writing original draft t uchiyama conception and design of study writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment all authors approved the version of the manuscript to be published appendix it is expected that the resistance of the air is much smaller when the sphere is in the air hence the term of air resistance in eq 7 is deleted to evaluate the contribution of air resistance when the air resistance term is deleted in eq 7 the position of z p of the sphere becomes as follows a 1 z p t 1 2 g t t 1 2 w 1 t t 1 z 1 fig a 1 compares the results obtained from eq 9 and eq a 1 according to fig a 1 these curves obtained by the graphs of eq 9 shown by the plot and eq a 1 shown by the solid line align confirming the resistance of the air is much smaller 
20461,this article presents a reasonable anti collision path planning algorithm with the properties of strong practicability and high degree of automation for unmanned surface vehicles usv or marine autonomous surface ships mass in dynamic environment situation based on the requirements of the international regulations for preventing collisions at sea colregs the qualitative provision about the apparent intention of anti collision maneuver is quantified in the algorithm meanwhile the boolean expression technology is adopted to help determine the type of encounter situation and action manner automatically which provides theoretical basis for the application of path planning algorithm in addition the modified velocity obstacle approach and artificial potential fields are combined to improve the practicality and rationality of the optimization solution finally simulation examples consisting different traffic scenarios are discussed to demonstrate the effectiveness and practicality of the proposed scheme keywords path planning velocity obstacle approach artificial potential fields colregs boolean expression 1 introduction with the development of the global economic integration and the demand for the transportation with characteristics of low carbon green high comprehensive social efficiency shipping transportation takes on more than 90 of the global commodities trade volumes thus the shipping industry is growing continuously and the maritime traffic is becoming denser in many navigable waters then the following questions come the collision accidents in maritime traffic engineering have drawn much attention owing to maritime safety and environment protection wang et al 2018 according to the statics 2011 2018 collected by the european maritime safety agency emsa 2019 the collision is the second leading cause of navigational casualties in addition 65 8 of the accident events were attributed to human actions category therefore the research on unmanned surface vehicle is considered as the most effective way to avoid the intervention of human actions imo 2018 when designing the anti collision decision algorithm the colregs is considered as the most important base which should be complied by all ships and helps to construct modules with different functions including the identification of encounter situation determination of action manner collision risk assessment etc therefore there needs to preferably transform the qualitative provisions of colregs into the quantitative constraints so as to further improve the practicality and rationality of the output solution in addition the searching capability and the realizability of optimization results also need to be further studied path planning is one of key points for the autonomous ship formulation which has been focused on by researchers for many years it can be divided into two fields global path planning based on prior environment information and local path planning based on sensor information u s navy 2007 as a part of local path planning ship collision avoidance through an environment containing static obstacles and moving target ships is a complicated task and can be viewed as a multi optimization nonlinear programming problem this optimization scheme should be executed by considering several aspects including safety economy precision and the colregs constraints this article mainly focuses on the local path planning for collision avoidance according to the form of the optimization results the study methods on path planning can be divided into heuristic approach and deterministic approach tam et al 2009 statheros et al 2008 the deterministic approach follows a set of rigorously defined steps in order to converge the single optimal solution characterized by low computational time for example an autonomous collision avoidance manoeuvring model using a knowledge based expert system was developed iijima and hagiwara 1991 both continuous and discrete methods were combined to generate evasive manoeuvres churkin and zhukov 1998 a line of sight los method by reversing the idea of traditional missile proportional navigation was adopted and recognizing that the goal was to avoid the strange ship wilson et al 2003 in addition the fuzzy set theory was employed to determine anti collision routes by many researchers hwang 2002 kao et al 2007 perera et al 2012 a maze routing method with additional turn penalties time dependent forbidden zone and speed reduction ability was propoesed to generate a corresponding evasive route szlapczynski 2006 zhang proposed a distributed collision avoidance decision making system for ships zhang et al 2015 the main idea of this method is to compute a collision free path for all ships one after another similarly a cooperative path planning algorithm for multi ship encounter was proposed tam and bucknall 2013 which determined the action sequence by comparing the ship manoeuvrability it should be mentioned that the artificial potential field apf method is considered to possess the ability to deal with static and or moving obstacles while obeying the colregs xue et al 2011 in order to avoid the apf falling into local minimum lv added new repulsion potential field and generated corresponding virtual forces lyu and yin 2018 recently velocity obstacle vo is also widely used in the field of anti collision path planning the non linear velocity obstacle region was constructed based on the predicted trajectories of other ships huang et al 2018 further the principle of generalized reciprocal velocity obstacle grvo was adopted to help establish the collision avoidacne decisions huang et al 2019 in addition vo was also used for collision risk detection and analysis chen et al 2018 2019 the heuristic approaches only search within a subspace of the search space to derive an acceptable solution with predefined constraints these approaches are characterized by high mathematical abstraction and global optimization and could deal with complex computations thus these approaches have received considerable attention from the researchers and practitioners in the field of maritime traffic engineering in recent years szlapczynski 2011 tam and bucknall 2010 2013 tsou et al 2010 tsou 2016 ni et al 2018 2019 2020 for example a system framework for a navigation decision support platform that used the received data of the ais and ecdis was established which could generate a safe route through designed evolutionary computation tsou 2016 a coordinated anti collision path planning algorithm was established based on the technology of multi layer genetic coding and the establishment of optimization echelon ni et al 2020 though the plenty of research work and progress have been devoted to the field of ant collision path planning there are still limitations need to be solved for example most studies pursue the robustness of the algorithm itself while less literature is devoted to developing a complete anti collision decision making system the noticeable shortage is that the process of automatic identification of encounter situation is not considered in fact there is only qualitative description on encounter type in colregs and the awareness of encounter situation is a comprehensive recognition of surrounding environment thus the quantified encounter characteristic parameters for specific encounter types and action manners should be analyzed based on the seafarers ordinary practice and good seamanship so that the action manner can resemble those of human pilots more closely in addition the decisions generated by the decision making system should satisfy the navigation practice in real navigation most evasive manoeuvres are carried out by single course or speed alteration even in multi ship encounter tam and bucknall 2013 however the outputs of some studies need to make frequent and minor course alterations which explicitly violates the rules for specific encounter more importantly the frequent small course alterations are inconvenient for the ship s manipulation and may cause a confusion to the other ships currently the execution of anti collision path planning is mainly made simultaneously in a centralized way with the assumption of using same anti collision algorithm or obtaining the predicted trajectories of other ships if there is a foreign ship that uses a different decision scheme to make a decision inconsistence or conflict situation may happen a worse situation may happen when some ships take unexpected course alteration or do not take any actions no matter there are give way or stand on vessels besides the anti collision is not a one time activity and the ships should make one decision at each time when necessary to avoid collision with ships nearby and make another one when they find new dangerous targets the apf and vo algorithms are capable to deal with such problems very well motivated by the above observations an application orientated anti collision path planning algorithm for unmanned surface vehicle is proposed in this article the proposed scheme should be fully suitable for real application at sea and considers various factors including ship maneuverability multi ship encounter navigation practice and unexpected actions by other ships during the avoidance process the coordinated ship domain collision risk index and boolean expression technology are adopted to quickly and accurately recognize different types of encounter situation and action manners and these judging results are the key elements for the proposed scheme s activation based on the quantified constraint of substantial and apparent action incorporated into the velocity obstacle algorithm the feasible course region fcr is defined and regarded as the navigation practice constraint for the anti collision algorithm in addition the parameter presupposed number of steps is proposed in the modified artificial potential field to solve the problems of heading angle vibration multi ship encounter and unexpected actions by other ships which greatly improves the practicality and rationality of the solution this article is then organized as follows section 1 introduces the motivation behind the work section 2 introduces the identification of encounter situation and action manner including establishing a coordinated ship domain model collision risk assessment and corresponding logical identification section 3 illustrates the principles of optimization algorithm to determine a suitable path section 4 outlines the test cases used to discuss the practicality and rationality of the proposed scheme section 5 concludes the article with a discussion of the achievements and limitations 2 identification of encounter type and action manner the identification of encounter type and action manner is a comprehensive recognition of surrounding environment which is also a precondition of the anti collision path planning scheme the authors proposed a quantitative model of an encounter situation which confirmed the judging component of encounter type based on sensibility analysis ni et al 2020 in order to realize the effective recognition of encounter type and action manner the coordinated ship domain model is adopted to objectively determine the degree of collision risk and the boolean expression technology is adopted to recognize the encounter type and action manner automatically 2 1 collision risk assessment the purpose of collision risk assessment is to provide safety criteria when executing anti collision decision making thus the space collision risk index and time collision risk index are calculated based on the scale factor considering the effect of the domain size on collision risk index the coordinated ship domain is established which takes consideration of the interaction effect between ships for a specific encounter type 2 1 1 coordinated ship domain model the concept of ship domain was first proposed by fuji fujii and tanaka 1971 through years of progress different shapes and sizes of ship domains taking into account different factors are presented including circular ship domains elliptical ship domains and polygonal ship domains however the shapes and sizes of the abovementioned ship domain models mainly depend on the own ship s characteristic such as length and velocity thus the sizes of the two encountering ships domains are different which further leads to different recognition on danger level this phenomenon is mainly resulted from insufficient consideration of interaction effect between the encountering ships which totally violates the theory of synergetic theory haken 2004 for example the initial configuration of own ship os targe ship ts and the relative moment curve of ts are shown in fig 1 from the point of os ts does not infringe the domain of os thus there is no collision risk but when t t2 os has entered the ts s domain thus the two ships form the crossover situation os is the give way vessel and ts is the stand on vessel in this case a close quarters situation may occur due to the disagreement on encounter type as a consequence this kind of domain models is not suitable for collision risk assessment applicated in anti collision decision for the application in the anti decision making a circular ship domain model is employed the turning ability of a ship plays an important role in determining the size of domain especially the advance shown in fig 2 the international maritime organization imo and american bureau of shipping abs provided the same minimum acceptable standard that is the advance less than 4 5 times of length ad l 4 5 in order to obtain universal advance data the authors collected the manoeuvrability data from 332 ship s turning circle test the distribution of advance is illustrated in fig 3 as can be seen from fig 3 most ships advances are less than four times of length thus the radius r c of a circular domain is calculated as follows 1 r c d c e n t e r d max 2 l max max l 1 l 2 l n n 1 2 n where d center is the distance between the center and bow of a ship and its length is set to 0 5l max d max l max are respectively the maximum advance and length among the encountering ships n is the number of encountering ships 2 1 2 collision risk index when two vessels in sight of each other are approaching with no change of compass bearing so that there is risk of collision and one of them is required to keep out of the way of the other by the colregs there are generally four stages relating to the permitted or required action for each vessel cockcroft and lameijer 2011 correspondingly the collision risk index cri can be divided into four parts as shown in fig 4 stage 1 at a long range the encounter situation is not formed and both vessels are free to take any action they wish stage 2 the encounter situation is formed when the risk of collision first begins to emerge then the give way vessel is required to take early and substantial action to achieve a safe passing distance and the other ship must maintain her course and velocity stage 3 the close quarters situation is formed when the give way vessel does not take an appropriate action in compliance with the rules the stand on vessel is required to give a warning signal and is permitted to take action to avoid a collision by her maneuver alone the give way ship is not relieved of her obligation to stay out of the way stage 4 the immediate danger situation is formed when a collision cannot be avoided by the give way vessel alone and the stand on vessel is required to take such actions that will best aid avoiding a collision generally the evasive action should be taken in stage ii to avoid the close quarters situation in stage iii based on the asymmetrical gaussian function a new collision risk measure including space collision risk scr and time collision risk tcr is proposed for a given position vector of own ship and target object the space scale factor and time scale factor at time t are calculated as follows 3 f s t d c p a r t 4 f t t t c p a r t f 0 5 t f 0 min t c p a r a 25 where r t is the distance between ships at time t tcpa r is the tcpa when the distance between ships is r tcpa ra corresponds to the tcpa when the distance is the applicable distance for a specific encounter type r a t f0 is a threshold value corresponding to the smaller value of tcpa ra and 25 min 6 r s t exp f s 2 ln 1 r 0 7 r t t exp f t ln 1 r 0 where r s 0 1 is used to indicate the danger level in space in the process of ships approaching each other r t 0 1 is adopted to indicate the danger level in time usually we set r s r 0 and r t r 0 as the threshold value to take actions borrowing from the concept of a ship domain r 0 0 5 is defined as the critical state by setting dcpa r c 2 2 logical identification of encounter type the determination of encounter situation is a precondition of path planning in order to improve the automation level of anti collision decision making scheme the boolean expression technology is adopted to realize the automatic identification of the encounter type and action manner based on the previous research ni et al 2020 the identifying model for types of ship encounters is illustrated in fig 5 the boundary values for different regions p 1 p 2 p 3 p 4 p 5 or p 6 are determined based the light s arc of horizon in the coloregs a detailed description of the possible encounter types is listed in table 1 the identification of a specific encounter type is a comprehensive evaluation of the relevant factors including collision risk index the relative bearing of os and ts the corresponding quantified criteria for specific encounter type are summarized in table 2 in order to realize automatic anti collision decision making the identification result of environment awareness should be taken as the input parameter of anti collision path planning algorithm therefore the boolean expression technology is employed in the recognition of encounter type and action manner the boolean algebra is expressed as follows 8 u u e u a 9 u e 1 2 3 4 5 ho cr 1 cr 2 ot 1 ot 2 where u e indicates the logical identification results of encounter types represented by different numbers u a indicates the logical identification results of action manner criterion i identification of collision risk the identification of collision risk is a prerequisite in the determiation of encounter type to judge whether the collision risk between ships reaches the threshold value the binary boolean expressions of the space collision risk and time collision risk of the target ship are established respectively 10 u r s 0 1 r s r 0 r s r 0 11 u r t 0 1 r t r 0 r t r 0 where u r s indicates the logical identification results of space collision risk u r t indicates the logical identification results of time collision risk only when u r s u r t 1 proceed to checking criterion ii criterion ii judgement of the location of ts a multivariate boolean expression of the location of ts with respect to os can be expressed as follows 12 k u θ t 1 2 3 4 5 6 θ t 0 π 8 15 π 8 2 π θ t π 8 π 2 θ t π 2 5 π 8 θ t 5 π 8 11 π 8 θ t 11 π 8 3 π 2 θ t 3 π 2 15 π 8 where k indicates the specific region shown in fig 5 u θ t indicates the logical identification results of relative bearing of ts θ t is the relative bearing of ts with respect to os criterion iii division of ts s bearing angle based on the logical judgement result in criterion ii the ts s bearing angle division in different region with respect to os can be shown as follows 13 u θ o k 1 2 3 5 θ o 0 π 8 15 π 8 2 π θ o π 8 5 π 8 θ o 11 π 8 15 π 8 θ o 5 π 8 11 π 8 k 1 u θ o k 3 5 θ o 11 π 8 15 π 8 θ o 5 π 8 11 π 8 k 2 u θ o k 3 θ o 11 π 8 15 π 8 k 3 u θ o k 4 θ o 0 2 3 π 2 2 π k 4 u θ o k 2 θ o π 8 5 π 8 k 5 u θ o k 2 5 θ o π 8 5 π 8 θ o 5 π 8 11 π 8 k 6 where u θ o k indicates the logical identification results of the location of os with respect to ts θ o is the relative bearing of os with respect to ts thus the encounter type is finally determined as follows 14 u e u θ o k k 1 2 3 4 5 6 2 3 logical identification of action manner in order to ensure the collision avoidance actions adopted are conforming to the navigation practice the action manners of vessels with the obligation of avoiding collision under different encounter situations are analyzed based on the colregs and requirements of good seamanship the key criteria for determining the action manner for different encounter type are heading crossing angle bearing angle of ts as well as the signal of dcpa similarly the corresponding boolean algebra of action manner is expressed as follows 15 u a 1 2 3 4 left right velocity stand on where left right velocity stand on respectively indicate course alteration to left course alteration to right changing speed and keeping the initial state for the head on situation paragraph a of rule 14 states when two power driven vessel are meeting on reciprocal or nearly reciprocal courses so as to involve risk of collision each shall alter her course to starboard so that each shall pass on the port side of the other thus the action manner is altering course to starboard illustrated in fig 6 for the crossing situation rule 15 states if the circumstances of the cases admit avoid crossing ahead of the other vessel thus the action manner can be altering course and or changing speed illustrated in fig 7 and the key criterion is heading crossing angle for the overtaking situation the overtaking vessel could overtake the overtaken vessel from port side or starboard side illustrated in fig 8 and the key criterion are the bearding angle of ts with respect to os and the signal of dcpa thus the boolean expression of heading crossing angle is determined as follows 16 u c t 2 3 c t 90 c t 90 where c t indicates the heading crossing angle correspondingly the boolean expressions of bearing angle of ts and signal of dcpa are calculated as follows 17 u θ t 1 2 θ t 5 π 8 7 π 6 θ t 7 π 6 11 π 8 18 u d c p a 1 2 d c p a 0 d c p a 0 where θ t indicates the bearing angle of ts with respect to os based on the logical identification result of encounter type the corresponding logical results of action manner can be displayed as follows 19 u e 1 u a 2 u e 2 u a 4 u e 3 u a u c t u e 4 u a 4 u e 5 u a u θ t φ o φ t u θ t u d c p a φ o φ t 3 optimization algorithm in order to improve the practicality of the usv anti collision path planning algorithm there needs to further modify the optimization algorithm under the framework of colregs in the following aspects first a virtual repulsion force perpendicular to the original repulsion force for the apf algorithm is constructed to help overcome the deficiency of convergence to local minimum and the direction of this repulsion force is determined by the logical identification result of action manner then the safety course region and feasible course region for vo algorithm are proposed to guarantee the avoidance action apparent and substantial to others finally a numerical algorithm is adopted to determine the presupposed number of steps which could help obtain the easy evasive maneuvers to manipulate 3 1 minimum allowable alteration of course to judge the dangerous encounters that have the potential for collision risk the collision risk index model based on dcpa and tcpa can reflect the spatial temporal proximity however the spatial temporal proximity is the result of unchanged current states of encountering ships in real applications there needs to determine the allowable alteration of course for collision avoidance thus vo approach is adopted to calculate the velocity obstacle region which could determine the sets of velocities where if the velocity of the chosen object falls into a set a certain spatiotemporal proximity situation will happen in the future wang et al 2020 suppose that os and ts are in an encounter type and their kinematic information e g heading position velocity etc are known the states of os and ts are expressed as o φ o t p o t v o t and t φ t t p t t v t t respectively where φ t p t v t are the heading position and velocity of each ship at time t now we define a ray from the position of os and moving in the direction of v ot v o t v o t v t t then the ray position can be calculated as follows illustrated in fig 9 20 λ p o t v o t t p o t v o t t t t 0 when λ p o t v o t t falls into the region between the two tangent rays l o 1 and l o 2 for the coordinated ship domain of p t t with a radius r c it can be assumed that the collision cannot be avoided the relative collision cone r c c o t representing the set of relative velocity v o t could be defined as 21 r c c o t v o t λ p o t v o t t p t t in real application there needs to convert relative velocity space to the usv s absolute velocity space thus the velocity obstacle region of os v o s t s is determined as 22 v o s t s r c c o t v o t v o t λ p o t v o t t p t t where is the minkowski operation which shifts r c c o t according to the velocity of ts os is not allowed to select any velocity vector in the region v o s t s considering the practical manipulation of give way ship variation of os heading should be less than π 3 the allowable course region acr is defined as 23 a c r φ o t φ o φ a c r 1 φ a c r 2 where φ a c r 1 and φ a c r 2 are the lower and upper limit of os s heading angle correspondingly the course obstacle region cor should be within acr and is defined as follows 24 c o r o t φ o t φ o t φ c o r 1 φ c o r 2 where φ c o r 1 and φ c o r 2 are the left and right course boundaries corresponding to the tangent rays l o 1 and l o 2 contrasting to c o r o t the safety course region scr ot is defined as follows 25 s c r o t φ o t φ o t φ a c r 1 φ c o r 1 φ c o r 2 φ a c r 2 considering ship s navigating in open sea usually operates at full speed ahead it is difficult for the main engine of the ship to reduce speed in a short time due to inertial impact thus an alteration of course is generally more effective than an alteration of speed since it is quick to take effect and is easily observed both visually and on radar from the other vessels paragraph b of rule 8 states any alteration of course and or speed to avoid collision shall if the circumstances of the case admit be large enough to be readily apparent to another vessel observing visually or by radar based on different recognition of this rule many researchers proposed different ranges for the alteration of course either from the starboard side or port side such as π 12 π 3 or π 6 π 2 and the object of give way vessel and direction of alteration could be determined based on the logical identification results however the purpose of taking substantial action is to display the avoidance intention and it is inappropriate to indicate this intention just by the give way vessel s alteration range thus the apparent relative motion could be defined by satisfying the requirement of direction variation of relative velocity larger than π 18 finally the feasible course region fcr os ts illustrated in fig 10 is calculated as 26 f c r o s t s φ o t φ o t φ o 1 φ o 2 φ o t t π 18 from the perspective of economy we define the minimum feasible course φ f is the minimum within the region of f c r o s t s then it is used as the course alteration constraint for the path planning algorithm the discretization method is adopted to help determine φ f and the schematic diagram is shown in fig 11 first according to the logical identification results u a u e in section 2 2 and 2 3 the responsibility direction of alteration and scope of acr could be determined afterwards the c o r o t is determined by traversing 1 intervals and comparing the dcpa with radius of coordinated ship domain r c thus we can get the refined scr based on the action manner similarly the f c r o s t s is determined by similar interval and comparing the direction of relative velocity with π 18 finally the minimum value of f c r o s t s is adopted as the course constraint for the path planning algorithm 3 2 improved artificial potential field algorithm the artificial potential field apf algorithm is first applied in the field of robot path planning proposed by khatib in 1985 subsequently it was adopted in usv path planning the apf method shows the potential to address the unpredictable changes of tss courses in the solution finding process and the corresponding computation time is very short lyu and yin 2018 the basic idea of the algorithm is to equate the movement of the ship in the actual environment to the movement in an abstract artificial potential energy field where the ship is subjected to two kinds of force illustrated in fig 12 the target point generates attraction to the ship which drives it to move toward the target point correspondingly the obstacle in the environment generates repulsion force which prevents the ship from colliding with the obstacle as a consequence the combined force controls the ship to approach the destination whilst avoiding the obstacles in the coordinate system the position of the ship can be expressed by z c x c i ˆ y c j ˆ the formula of the attractive potential field of the target point on the ship is defined as 27 u a t t z 1 2 k a t t d z c z g 2 28 d z c z g z c z g x c x g 2 y c y g 2 where k a t t is the attractive potential field coefficient and is inversely proportional to the square of the distance between the ship and the target point d c z c z g z c represents the position vector of the ship z g is the position vector of the target point thus the function formula of attractive force obtained by calculating the negative gradient of the attractive potential field is 29 f a u a t t z k a t t z c z g 2 n o a where n o a is a unit vector pointing to the target position from the ship based on collision risk assessment model established in section 2 1 the ship would proceed to the target point under the virtual attractive force if the collision between the ship and the obstacle is below the threshold value once the encounter type forms the repulsive potential field is computed automatically the repulsion force acts on the ship which pushes the ship away from the obstacle finally the ship is manipulated under the two kinds of force similar to the attractive potential field the magnitude of the repulsive potential field is inversely proportional to the distance between the ship and the obstacle the repulsive potential field generated by the obstacle is shown as follows 30 u r e p z 1 2 k r e p 1 d z c z o 1 l o 2 u r s u r t 1 0 u r s u r t 0 where d z c z o represents the euclidean distance between the obstacle and the ship k rep represents a non negative repulsion potential field coefficient l o is the influence radius of the obstacle considering the coordination on the perceived collision risk between the encounter ships a coordinated ship domain model is developed in the collision risk assessment the three dimension repulsive potential field is shown in fig 13 correspondingly the expression of the repulsion force is calculated as follows 31 f r u r e p z k r e p 1 z c z o 1 l o z c z o z c z o 2 n o t u r s u r t 1 0 u r s u r t 0 where n o t a unit vector pointing to any ts from the os it should be noted that the apf algorithm does not have versatility due to the nature of convergence to local minimum for example a head on situation occurs the existing resultant force cannot take the ship escape from the obstacle thus a virtual repulsion force perpendicular to the original repulsion force is added as shown in fig 12 and the magnitude is 32 f p k k l o s t n k r e p 1 z c z g 1 l o z c z g z c z g 2 n o t u r s u r t 1 0 u r s u r t 0 where k is the gain coefficient k lost is the attenuation coefficient n o t is unit vector perpendicular to n o t and the direction is determined based on the logical identification result of action manner as follows 33 φ n o t φ n o t π 2 u a 1 φ n o t π 2 u a 2 finally the total virtual force is obtained by 34 f t o t a l f p f a f r in real application it is desirable to obtain a smooth path with fewer times of course alterations in addition the colregs states that a succession of small alterations of course should be avoided therefore the concept of presupposed number of time step is proposed and applied in the apf algorithm which could divide a complete anti collision path into avoidance part and restoration part in order to avoid the vibration of small course alterations for the calculated path inconsistent with the navigation practice the course of the vessel gradually reaches and stabilizes at φ f during the number of steps specifically this number is calculated by numerical algorithm illustrated in fig 14 first the parameters of dcpa and tcpa when the course changes from are φ o to φ f then the basic number of steps n is determined by taking the integer part from the ratio of tcpa and step correspondingly the euclidean distance d 1 d 2 d 3 among target ship position p t relative position p os ts and destination point p oe is determined and the distance d between p t and segment from relative position p os ts to destination point p oe also can be determined based on law of cosines finally the presupposed number is obtained by comparing the distance with domain radius r c at one step interval considering the practical application a model of the ship s motion is simulated on the horizontal plane the dynamic properties of a ship taken into account by considering the time needed to execute the course alteration thus the configuration of the parameters maxturn and time step are used to reflect the dynamic properties of the ship this mainly depends on the available rudder angle less than 35 the velocity the loading condition and the delay of turning for a ship for some large vessels with worse manoeuvrability the maxturn by 5 could be reached as a consequence the maxturn is 5 and the maximum time step is 15s 4 simulation study in this section the performance of the proposed anti collision path planning algorithm is implemented and discussed the simulations considered colregs compliance practical application and a wide range of cases including static and moving targets single ts avoidance random course alterations of tss and multi ship avoidance etc throughout the simulations it was assumed that the usv was the own ship os and all the ships detected in the surroundings by the usv were the targets ships tss the matlab software platform is used to run the anti collision computation simulations after careful consideration of the traffic scenarios the relevant parameters of the algorithm are set as follows k a t t 90 k r e p 6 k 30 r c 0 97 nm r a 3 6 nm 3 nm for overtaking situation 6 nm for head on and crossing situation maxturn 5 and time step 10 15s these test cases primarily aim to evaluate the effectiveness and operability of the proposed scheme thus the simulation results including optimal trajectory of each ship the relative trajectories the distance variation the relative bearing angle and heading variation are illustrated in the following figures a two dimensional cartesian coordinate system represents the distance in nautical miles nm the vertical axis in the positive direction shows north and the horizontal axis in the positive direction is 090 the following symbols and color codes are applied to enhance the visualized results the starting point and destination point of os are represented by black filled circles and the target ships tss are numbered with a label starting from 1 the starting points of ts1 ts2 ts3 ts4 ts5 and ts6 are represented by brown red green blue cyan and magenta pentagram the trajectory and heading angle of os are represented by a black curve the relative trajectories of os with respect to ts are marked by dotted curves with different colors corresponding to the starting points of tss the non filled circles with different colors indicate the ship domain and the number on each position indicates the corresponding steps the illustration of relative bearing angle and the relative heading angle with different colors are used to demonstrate the apparent action to other vessels 4 1 scenario 1 head on situation in the initial configuration the initial heading angle of os and ts1 are 45 and 135 respectively the initial velocities of os and ts1 are same namely 15 kn the initial positions of os and ts are 1 1 and 10 10 and the destination point of os is set 10 10 considering the initial dcpa 0 0029 nm r s 0 5 tcpa 1527 s r t 0 5 the ships stay in the stage i and free to take any action when t 807 s the head on situation forms and each shall alter her course to starboard so that each shall pass on the port side of the other thus the turning point is the 54th step and in order to demonstrate the effectiveness of the proposed anti collision scheme it is supposed that the avoidance action is solely taken by the os in this section according to the vo algorithm the feasible minimum course is determined φ f 75 correspondingly the presupposed number of steps is also determined num 34 the simulation results are presented in fig 15 the trajectories of two ships and the os with respect to ts1 are presented in fig 15 a b at the turning point the os alters her course to starboard side by 30 and executes the restoration action to the destination point at the 89th step as can be seen from fig 15 b the os does not intrude the domain of ts1 all the time which is further verified by the distance variation curve in fig 15 c the minimum distance is 0 976 nm larger than r c the detailed heading angle of os is shown in fig 15 d compared with apf algorithm there is no vibration of small course alterations during the entire process of avoidance by the proposed scheme which greatly improves the practicality by reducing the difficulty of manipulation the relative heading angle variation is illustrated in fig 15 e is larger than π 18 and the relative bearing angle variation in fig 15 f is also obvious therefore the os s behaviour can be considered readily apparent to ts1 4 2 scenario 2 crossing situation in the initial configuration the initial heading angle of os and ts2 are 45 and 345 6 respectively the initial velocities of os and ts2 are same namely 13 kn the initial positions of os and ts2 are 1 1 and 10 0 8 and the destination point of os is set 10 10 considering the initial dcpa 0 16 nm r s 0 5 tcpa 1771 s r t 0 5 the ships stay in the stage i and free to take any action when t 591 s the crossing situation forms and os is the give way vessel and shall alter her course to starboard to keep out of the way of ts2 and avoid crossing ahead of ts2 correspondingly the turning point is calculated at the 40th step based on the vo algorithm and numerical algorithm the feasible minimum course and presupposed number of steps are determined φ f 70 and num 59 respectively all the simulation results for crossing situation are shown in fig 16 the trajectories of two ships and the os with respect to ts2 are presented in fig 16 a b the os alters her course to starboard side by 25 at the turning point and the restoration action to the destination point is executed at the 100th step it can be seen from fig 16 b that the relative trajectory of os with respect to ts2 is nearly tangent to the boundary of ts2 s domain the minimum distance is 0 974 nm larger than r c illustrated in fig 16 c which guarantees the safety requirement the detailed heading angle of os with respect to the avoidance action is shown in fig 16 d compared with optimization result by apf algorithm there is no vibration of small course alterations during the entire process of avoidance by the proposed scheme which conforms to the requirement of practicality and navigation practice finally the relative heading angle variation is illustrated in fig 16 e is larger than π 18 and the relative bearing angle variation in fig 16 f is also obvious therefore the os s behaviour could be considered as readily apparent to ts2 4 3 scenario 3 overtaking situation in the initial status the initial heading angle of os and ts3 are both 45 the initial velocity of os is 15 kn while initial velocity of ts3 is 5 kn the initial positions and destination points are 1 1 and 10 10 while the initial point of ts3 is 4 4 through calculation the initial dcpa 0 nm r s 0 5 tcpa 1527 s r t 0 5 are determined the ships stay in the stage i and free to take any action at the current status when t 447 s the criteria of overtaking situation is met the os shall keep out of the way of ts3 by altering course to starboard side judged by the logical identification in section 2 correspondingly the turning point is determined at the 30th step similarly the feasible minimum course and presupposed number of steps can be determined φ f 60 and num 35 respectively the simulation results for overtaking situation are shown in fig 17 the trajectories of two ships and the os with respect to ts3 are presented in fig 17 a b the os alters her course to starboard side by 15 at the turning point and the restoration action to the destination point is executed at the 73rd step the minimum distance of the distance variation is beyond the r c illustrated in fig 17 c which guarantees the safely navigation between each other compared with optimization result by apf algorithm there is no vibration of small course alterations in fig 17 d which is convenient for ship s manipulation finally the relative heading angle variation is illustrated in fig 17 e and the relative bearing angle variation in fig 17 f demonstrates the apparent actions to ts3 4 4 scenario 4 multi ship encounter situation in the initial status os and six ts form a multi ship encounter situation and the initial information of all these ships are shown in table 3 ts1 and ts2 are the static obstacles and do not have collision risk with os ts3 is located at the right of the figure and a crossing situation with os is developing ts4 is nearly located at the right ahead of os and a head on situation between them is developing ts5 and ts6 are respectively located at the starboard and port side of os and do not have collision risk with current state fig 18 a b indicate the trajectories of these ships and the os with respect to ts fig 18 c f illustrate the distance between any ts the heading angle of os at each time step the relative heading angle and relative bearing angle of os with respect to all tss as can be seen in fig 18 a os keeps on the initial heading as there is no collision risk between os and tss at the 30th step the criteria of crossing situation between os and ts3 is first met r s 0 5 r t 0 5 according to the identification results os is the give way vessel and needs to turn to the right and avoid crossing the bow of ts3 the feasible minimum course can be determined as φ f 75 in section 3 1 thus os alters course to starboard by 30 to keep out the way of ts3 the corresponding relative heading angle variation larger than π 18 and relative bearing angle variation of os with respect to ts3 illustrated in fig 18 e f demonstrate the apparent actions to ts1 and ts5 then os and ts5 form the crossing situation r s 0 5 r t 0 5 at the 83rd step considering the static obstacle ts1 located at the right side of os the feasible course region fcr for ts1 and ts5 is calculated simultaneously based on vo algorithm as a result os further alters course to starboard by 30 again to keep out the way of ts1 and ts5 similarly the corresponding relative heading angle variation and relative bearing angle variation with respect to ts1 and ts5 demonstrate the apparent avoidance intentions to ts1 and ts5 finally os alters course to the destination at the 174th step though the space collision risk between os with ts6 during the 83rd to 174 steps r s 0 5 but the time space collision risk is far less than the threshold value due to the large tcpa thus the ts6 does not generate repulsion force on os like other tss and os stands on and moves to the destination without any risk until reaching the destination at the 471th step it should be noted that the relative trajectories of os with respect to all tss do not violate any domain of tss shown in fig 18 b meanwhile the minimum distance of the distance variation is beyond the r c illustrated in fig 18 c as a consequence the safety of the optimal trajectory is guaranteed in addition there is no vibration of small course alterations in fig 18 d which satisfies the design of proposed scheme 4 5 scenario 5 uncoordinated multi ship encounter situation this scenario contains a more complex situation where tss have random changes in course the initial traffic configuration is shown in table 4 at the beginning ts1 can be considered as a static obstacle and do not have collision risk with os ts2 is located at the starboard side of os and a crossing situation is developing ts3 and ts4 are respectively located at the starboard and port side in the direction of os s and both have a tendency to form the head on situations ts5 is located at the port side in the direction of os s bow and a crossing situation is also developing it can be observed that os initially keeps on the original heading towards the destination point as there is no collision risk between os and any ts at the 15th step the criteria of crossing situation between os and ts2 is first met r s 0 5 r t 0 5 os is the give way vessel and alters course to starboard by 30 to keep out the way of ts2 at the 30th step ts2 ts4 and ts5 suddenly performed an uncoordinated course alterations by 30 the collision risk index between os and ts2 is beyond the safety threshold value thus os makes a further course change of 20 to starboard to avoid a collision with ts2 at the 40th step ts3 also performed an uncoordinated course alteration by 30 considering this action did not result in the collision risk between os and ts3 os does not take any action however this random course alteration by ts3 results the delay of os s restoration if restoration of os to destination is executed too early there is additional collision risk between os and ts3 thus the presupposed number is determined based on the numerical algorithm in section 3 2 112nd step after passing ts3 at a safe range illustrated in fig 19 c os and ts4 forms the crossing situation r s 0 5 r t 0 5 ts4 is the give way vessel and os should keep the course and velocity unchanged as the stand on vessel but at the 142nd step it is apparent that ts4 is not taking appropriate action in compliance with rules os is permitted to take action to avoid collision by her maneuver alone according to colregs os should alter course to port side to pass stern of ts4 but this action would lead to another collision risk between os and ts5 in addition the alteration angle to starboard should not be too large in order to avoid collision with ts1 thus os takes a further course change of 5 to avoid a collision with ts4 finally os alters course to port by 5 to approach the destination at the 225th step after passing ts4 at a safe range shown in fig 19 c since ts5 is approaching from port side and the dcpa is enough to pass clear os stands on and moves to the destination without any risk until reaching the destination at the 329th step similarly fig 19 b c indicates the relative trajectories and distance of os with respect to tss which could effectively demonstrate the safety of the optimal trajectory fig 19 d f illustrate the heading angle of os at each time step the relative heading angle and relative bearing angle of os with respect to all tss which reflect the maneuvering characteristic of os during the collision avoidance process more importantly there is no vibration of small course alterations in fig 19 d which demonstrates the practicality of this proposed scheme 4 6 discussions and analysis the proposed path planning algorithm is tested under simple conditions by scenario 1 to scenario 3 when tss always keep original state unchanged throughout the collision avoidance process in addition more complex conditions are also verified by scenario 4 to scenario 5 these scenarios take into account the random course alterations by tss no matter os is give way vessel or stand on vessel the simulation results show that the proposed scheme can safely and correctly avoid collision under several typical encounter situation and deal with a variety of extreme scenarios including tss taking actions as stand on vessel and tss not taking actions as give way vessel the collision risk index is established to help judge the action time as illustrated in figs 15 19 a which makes the avoidance action close to navigation practice and the boolean expression technology is adopted to help determine the encounter type and action manner which could improve the autonomy of the proposed scheme the relative trajectories and relative distance between os and tss for these scenarios are shown in figs 15 19 b c it is obvious that the dcpa is larger than the radius of ship domain r c which demonstrates the safety of the proposed algorithm furthermore no matter in term of colregs or in practice a substantial alteration of course is the most common and effective action for the give way vessel in an encounter situation the substantial and apparent action is quantified and incorporated into the vo algorithm which could help determine the feasible course region fcr significant variations are also observed for a certain substantial alteration of relative heading angle as shown in figs 15 19 e and relative bearing angle with respect os to tss as shown in figs 15 19 f for example when the alteration of heading angle is only 15 in overtaking situation but the relative heading angle variation is 24 larger than π 18 and the corresponding relative bearing angle is nearly to π besides it should be noted that the irregular and successive small course alterations are eliminated by introducing the parameter presupposed number of steps as shown in figs 15 19 d this modification does not make the avoidance actions compliance with navigation practice but also reduce the difficulty of ship manipulation which greatly improves the practicality and reliability of this proposed algorithm thus a relatively complete path planning algorithm is proposed and can be embed into the navigation aids such as ecdis 5 conclusions in this article an application orientated anti collision path planning algorithm for unmanned surface vehicles is presented borrowing the concept of coordinated ship domain a practical collision risk index model is established based on the boolean expression technology the automatic identification of encounter type and action manner is realized and makes the anti collision algorithm more complete meanwhile the substantial and apparent action is quantified and incorporated into vo algorithm to calculate the feasible course region for give way vessel in addition the introduction of virtual repulsion force and the parameter presupposed number of time step help to extend the scope of application and improve the practicality and rationality of the optimization solution by incorporating different traffic scenarios into the proposed scheme simulation examples including head on crossing overtaking multi ship encounter tss take random actions and tss do not take actions as give way vessel are applied to demonstrate the practicality and effectiveness of the proposed scheme the simulation results show that the proposed path planning algorithm could safely and correctly avoid collision even for complex encounter situations however this proposed scheme is not suitable for restricted water and takes inadequate consideration of the coordination among different ships actions and the unexpected trajectories of tss are known in advance therefore our future research will be concentrated on the anti collision decision in restricted water as well as the coordination among ships actions and the understanding of other ships intention is another future work direction in the field of emergency decision making for the unexpected changes of course the employment of coordinated optimization algorithm may be an effective method to guarantee the coordination among ships actions by evolving all the give way vessels actions simultaneously credit authorship contribution statement shengke ni writing original draft methodology software zhengjiang liu supervision funding acquisition dengjun huang formal analysis yao cai supervision funding acquisition xin wang validation supervision shang gao validation supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work is supported the national natural science foundation of china grant 51909022 
20461,this article presents a reasonable anti collision path planning algorithm with the properties of strong practicability and high degree of automation for unmanned surface vehicles usv or marine autonomous surface ships mass in dynamic environment situation based on the requirements of the international regulations for preventing collisions at sea colregs the qualitative provision about the apparent intention of anti collision maneuver is quantified in the algorithm meanwhile the boolean expression technology is adopted to help determine the type of encounter situation and action manner automatically which provides theoretical basis for the application of path planning algorithm in addition the modified velocity obstacle approach and artificial potential fields are combined to improve the practicality and rationality of the optimization solution finally simulation examples consisting different traffic scenarios are discussed to demonstrate the effectiveness and practicality of the proposed scheme keywords path planning velocity obstacle approach artificial potential fields colregs boolean expression 1 introduction with the development of the global economic integration and the demand for the transportation with characteristics of low carbon green high comprehensive social efficiency shipping transportation takes on more than 90 of the global commodities trade volumes thus the shipping industry is growing continuously and the maritime traffic is becoming denser in many navigable waters then the following questions come the collision accidents in maritime traffic engineering have drawn much attention owing to maritime safety and environment protection wang et al 2018 according to the statics 2011 2018 collected by the european maritime safety agency emsa 2019 the collision is the second leading cause of navigational casualties in addition 65 8 of the accident events were attributed to human actions category therefore the research on unmanned surface vehicle is considered as the most effective way to avoid the intervention of human actions imo 2018 when designing the anti collision decision algorithm the colregs is considered as the most important base which should be complied by all ships and helps to construct modules with different functions including the identification of encounter situation determination of action manner collision risk assessment etc therefore there needs to preferably transform the qualitative provisions of colregs into the quantitative constraints so as to further improve the practicality and rationality of the output solution in addition the searching capability and the realizability of optimization results also need to be further studied path planning is one of key points for the autonomous ship formulation which has been focused on by researchers for many years it can be divided into two fields global path planning based on prior environment information and local path planning based on sensor information u s navy 2007 as a part of local path planning ship collision avoidance through an environment containing static obstacles and moving target ships is a complicated task and can be viewed as a multi optimization nonlinear programming problem this optimization scheme should be executed by considering several aspects including safety economy precision and the colregs constraints this article mainly focuses on the local path planning for collision avoidance according to the form of the optimization results the study methods on path planning can be divided into heuristic approach and deterministic approach tam et al 2009 statheros et al 2008 the deterministic approach follows a set of rigorously defined steps in order to converge the single optimal solution characterized by low computational time for example an autonomous collision avoidance manoeuvring model using a knowledge based expert system was developed iijima and hagiwara 1991 both continuous and discrete methods were combined to generate evasive manoeuvres churkin and zhukov 1998 a line of sight los method by reversing the idea of traditional missile proportional navigation was adopted and recognizing that the goal was to avoid the strange ship wilson et al 2003 in addition the fuzzy set theory was employed to determine anti collision routes by many researchers hwang 2002 kao et al 2007 perera et al 2012 a maze routing method with additional turn penalties time dependent forbidden zone and speed reduction ability was propoesed to generate a corresponding evasive route szlapczynski 2006 zhang proposed a distributed collision avoidance decision making system for ships zhang et al 2015 the main idea of this method is to compute a collision free path for all ships one after another similarly a cooperative path planning algorithm for multi ship encounter was proposed tam and bucknall 2013 which determined the action sequence by comparing the ship manoeuvrability it should be mentioned that the artificial potential field apf method is considered to possess the ability to deal with static and or moving obstacles while obeying the colregs xue et al 2011 in order to avoid the apf falling into local minimum lv added new repulsion potential field and generated corresponding virtual forces lyu and yin 2018 recently velocity obstacle vo is also widely used in the field of anti collision path planning the non linear velocity obstacle region was constructed based on the predicted trajectories of other ships huang et al 2018 further the principle of generalized reciprocal velocity obstacle grvo was adopted to help establish the collision avoidacne decisions huang et al 2019 in addition vo was also used for collision risk detection and analysis chen et al 2018 2019 the heuristic approaches only search within a subspace of the search space to derive an acceptable solution with predefined constraints these approaches are characterized by high mathematical abstraction and global optimization and could deal with complex computations thus these approaches have received considerable attention from the researchers and practitioners in the field of maritime traffic engineering in recent years szlapczynski 2011 tam and bucknall 2010 2013 tsou et al 2010 tsou 2016 ni et al 2018 2019 2020 for example a system framework for a navigation decision support platform that used the received data of the ais and ecdis was established which could generate a safe route through designed evolutionary computation tsou 2016 a coordinated anti collision path planning algorithm was established based on the technology of multi layer genetic coding and the establishment of optimization echelon ni et al 2020 though the plenty of research work and progress have been devoted to the field of ant collision path planning there are still limitations need to be solved for example most studies pursue the robustness of the algorithm itself while less literature is devoted to developing a complete anti collision decision making system the noticeable shortage is that the process of automatic identification of encounter situation is not considered in fact there is only qualitative description on encounter type in colregs and the awareness of encounter situation is a comprehensive recognition of surrounding environment thus the quantified encounter characteristic parameters for specific encounter types and action manners should be analyzed based on the seafarers ordinary practice and good seamanship so that the action manner can resemble those of human pilots more closely in addition the decisions generated by the decision making system should satisfy the navigation practice in real navigation most evasive manoeuvres are carried out by single course or speed alteration even in multi ship encounter tam and bucknall 2013 however the outputs of some studies need to make frequent and minor course alterations which explicitly violates the rules for specific encounter more importantly the frequent small course alterations are inconvenient for the ship s manipulation and may cause a confusion to the other ships currently the execution of anti collision path planning is mainly made simultaneously in a centralized way with the assumption of using same anti collision algorithm or obtaining the predicted trajectories of other ships if there is a foreign ship that uses a different decision scheme to make a decision inconsistence or conflict situation may happen a worse situation may happen when some ships take unexpected course alteration or do not take any actions no matter there are give way or stand on vessels besides the anti collision is not a one time activity and the ships should make one decision at each time when necessary to avoid collision with ships nearby and make another one when they find new dangerous targets the apf and vo algorithms are capable to deal with such problems very well motivated by the above observations an application orientated anti collision path planning algorithm for unmanned surface vehicle is proposed in this article the proposed scheme should be fully suitable for real application at sea and considers various factors including ship maneuverability multi ship encounter navigation practice and unexpected actions by other ships during the avoidance process the coordinated ship domain collision risk index and boolean expression technology are adopted to quickly and accurately recognize different types of encounter situation and action manners and these judging results are the key elements for the proposed scheme s activation based on the quantified constraint of substantial and apparent action incorporated into the velocity obstacle algorithm the feasible course region fcr is defined and regarded as the navigation practice constraint for the anti collision algorithm in addition the parameter presupposed number of steps is proposed in the modified artificial potential field to solve the problems of heading angle vibration multi ship encounter and unexpected actions by other ships which greatly improves the practicality and rationality of the solution this article is then organized as follows section 1 introduces the motivation behind the work section 2 introduces the identification of encounter situation and action manner including establishing a coordinated ship domain model collision risk assessment and corresponding logical identification section 3 illustrates the principles of optimization algorithm to determine a suitable path section 4 outlines the test cases used to discuss the practicality and rationality of the proposed scheme section 5 concludes the article with a discussion of the achievements and limitations 2 identification of encounter type and action manner the identification of encounter type and action manner is a comprehensive recognition of surrounding environment which is also a precondition of the anti collision path planning scheme the authors proposed a quantitative model of an encounter situation which confirmed the judging component of encounter type based on sensibility analysis ni et al 2020 in order to realize the effective recognition of encounter type and action manner the coordinated ship domain model is adopted to objectively determine the degree of collision risk and the boolean expression technology is adopted to recognize the encounter type and action manner automatically 2 1 collision risk assessment the purpose of collision risk assessment is to provide safety criteria when executing anti collision decision making thus the space collision risk index and time collision risk index are calculated based on the scale factor considering the effect of the domain size on collision risk index the coordinated ship domain is established which takes consideration of the interaction effect between ships for a specific encounter type 2 1 1 coordinated ship domain model the concept of ship domain was first proposed by fuji fujii and tanaka 1971 through years of progress different shapes and sizes of ship domains taking into account different factors are presented including circular ship domains elliptical ship domains and polygonal ship domains however the shapes and sizes of the abovementioned ship domain models mainly depend on the own ship s characteristic such as length and velocity thus the sizes of the two encountering ships domains are different which further leads to different recognition on danger level this phenomenon is mainly resulted from insufficient consideration of interaction effect between the encountering ships which totally violates the theory of synergetic theory haken 2004 for example the initial configuration of own ship os targe ship ts and the relative moment curve of ts are shown in fig 1 from the point of os ts does not infringe the domain of os thus there is no collision risk but when t t2 os has entered the ts s domain thus the two ships form the crossover situation os is the give way vessel and ts is the stand on vessel in this case a close quarters situation may occur due to the disagreement on encounter type as a consequence this kind of domain models is not suitable for collision risk assessment applicated in anti collision decision for the application in the anti decision making a circular ship domain model is employed the turning ability of a ship plays an important role in determining the size of domain especially the advance shown in fig 2 the international maritime organization imo and american bureau of shipping abs provided the same minimum acceptable standard that is the advance less than 4 5 times of length ad l 4 5 in order to obtain universal advance data the authors collected the manoeuvrability data from 332 ship s turning circle test the distribution of advance is illustrated in fig 3 as can be seen from fig 3 most ships advances are less than four times of length thus the radius r c of a circular domain is calculated as follows 1 r c d c e n t e r d max 2 l max max l 1 l 2 l n n 1 2 n where d center is the distance between the center and bow of a ship and its length is set to 0 5l max d max l max are respectively the maximum advance and length among the encountering ships n is the number of encountering ships 2 1 2 collision risk index when two vessels in sight of each other are approaching with no change of compass bearing so that there is risk of collision and one of them is required to keep out of the way of the other by the colregs there are generally four stages relating to the permitted or required action for each vessel cockcroft and lameijer 2011 correspondingly the collision risk index cri can be divided into four parts as shown in fig 4 stage 1 at a long range the encounter situation is not formed and both vessels are free to take any action they wish stage 2 the encounter situation is formed when the risk of collision first begins to emerge then the give way vessel is required to take early and substantial action to achieve a safe passing distance and the other ship must maintain her course and velocity stage 3 the close quarters situation is formed when the give way vessel does not take an appropriate action in compliance with the rules the stand on vessel is required to give a warning signal and is permitted to take action to avoid a collision by her maneuver alone the give way ship is not relieved of her obligation to stay out of the way stage 4 the immediate danger situation is formed when a collision cannot be avoided by the give way vessel alone and the stand on vessel is required to take such actions that will best aid avoiding a collision generally the evasive action should be taken in stage ii to avoid the close quarters situation in stage iii based on the asymmetrical gaussian function a new collision risk measure including space collision risk scr and time collision risk tcr is proposed for a given position vector of own ship and target object the space scale factor and time scale factor at time t are calculated as follows 3 f s t d c p a r t 4 f t t t c p a r t f 0 5 t f 0 min t c p a r a 25 where r t is the distance between ships at time t tcpa r is the tcpa when the distance between ships is r tcpa ra corresponds to the tcpa when the distance is the applicable distance for a specific encounter type r a t f0 is a threshold value corresponding to the smaller value of tcpa ra and 25 min 6 r s t exp f s 2 ln 1 r 0 7 r t t exp f t ln 1 r 0 where r s 0 1 is used to indicate the danger level in space in the process of ships approaching each other r t 0 1 is adopted to indicate the danger level in time usually we set r s r 0 and r t r 0 as the threshold value to take actions borrowing from the concept of a ship domain r 0 0 5 is defined as the critical state by setting dcpa r c 2 2 logical identification of encounter type the determination of encounter situation is a precondition of path planning in order to improve the automation level of anti collision decision making scheme the boolean expression technology is adopted to realize the automatic identification of the encounter type and action manner based on the previous research ni et al 2020 the identifying model for types of ship encounters is illustrated in fig 5 the boundary values for different regions p 1 p 2 p 3 p 4 p 5 or p 6 are determined based the light s arc of horizon in the coloregs a detailed description of the possible encounter types is listed in table 1 the identification of a specific encounter type is a comprehensive evaluation of the relevant factors including collision risk index the relative bearing of os and ts the corresponding quantified criteria for specific encounter type are summarized in table 2 in order to realize automatic anti collision decision making the identification result of environment awareness should be taken as the input parameter of anti collision path planning algorithm therefore the boolean expression technology is employed in the recognition of encounter type and action manner the boolean algebra is expressed as follows 8 u u e u a 9 u e 1 2 3 4 5 ho cr 1 cr 2 ot 1 ot 2 where u e indicates the logical identification results of encounter types represented by different numbers u a indicates the logical identification results of action manner criterion i identification of collision risk the identification of collision risk is a prerequisite in the determiation of encounter type to judge whether the collision risk between ships reaches the threshold value the binary boolean expressions of the space collision risk and time collision risk of the target ship are established respectively 10 u r s 0 1 r s r 0 r s r 0 11 u r t 0 1 r t r 0 r t r 0 where u r s indicates the logical identification results of space collision risk u r t indicates the logical identification results of time collision risk only when u r s u r t 1 proceed to checking criterion ii criterion ii judgement of the location of ts a multivariate boolean expression of the location of ts with respect to os can be expressed as follows 12 k u θ t 1 2 3 4 5 6 θ t 0 π 8 15 π 8 2 π θ t π 8 π 2 θ t π 2 5 π 8 θ t 5 π 8 11 π 8 θ t 11 π 8 3 π 2 θ t 3 π 2 15 π 8 where k indicates the specific region shown in fig 5 u θ t indicates the logical identification results of relative bearing of ts θ t is the relative bearing of ts with respect to os criterion iii division of ts s bearing angle based on the logical judgement result in criterion ii the ts s bearing angle division in different region with respect to os can be shown as follows 13 u θ o k 1 2 3 5 θ o 0 π 8 15 π 8 2 π θ o π 8 5 π 8 θ o 11 π 8 15 π 8 θ o 5 π 8 11 π 8 k 1 u θ o k 3 5 θ o 11 π 8 15 π 8 θ o 5 π 8 11 π 8 k 2 u θ o k 3 θ o 11 π 8 15 π 8 k 3 u θ o k 4 θ o 0 2 3 π 2 2 π k 4 u θ o k 2 θ o π 8 5 π 8 k 5 u θ o k 2 5 θ o π 8 5 π 8 θ o 5 π 8 11 π 8 k 6 where u θ o k indicates the logical identification results of the location of os with respect to ts θ o is the relative bearing of os with respect to ts thus the encounter type is finally determined as follows 14 u e u θ o k k 1 2 3 4 5 6 2 3 logical identification of action manner in order to ensure the collision avoidance actions adopted are conforming to the navigation practice the action manners of vessels with the obligation of avoiding collision under different encounter situations are analyzed based on the colregs and requirements of good seamanship the key criteria for determining the action manner for different encounter type are heading crossing angle bearing angle of ts as well as the signal of dcpa similarly the corresponding boolean algebra of action manner is expressed as follows 15 u a 1 2 3 4 left right velocity stand on where left right velocity stand on respectively indicate course alteration to left course alteration to right changing speed and keeping the initial state for the head on situation paragraph a of rule 14 states when two power driven vessel are meeting on reciprocal or nearly reciprocal courses so as to involve risk of collision each shall alter her course to starboard so that each shall pass on the port side of the other thus the action manner is altering course to starboard illustrated in fig 6 for the crossing situation rule 15 states if the circumstances of the cases admit avoid crossing ahead of the other vessel thus the action manner can be altering course and or changing speed illustrated in fig 7 and the key criterion is heading crossing angle for the overtaking situation the overtaking vessel could overtake the overtaken vessel from port side or starboard side illustrated in fig 8 and the key criterion are the bearding angle of ts with respect to os and the signal of dcpa thus the boolean expression of heading crossing angle is determined as follows 16 u c t 2 3 c t 90 c t 90 where c t indicates the heading crossing angle correspondingly the boolean expressions of bearing angle of ts and signal of dcpa are calculated as follows 17 u θ t 1 2 θ t 5 π 8 7 π 6 θ t 7 π 6 11 π 8 18 u d c p a 1 2 d c p a 0 d c p a 0 where θ t indicates the bearing angle of ts with respect to os based on the logical identification result of encounter type the corresponding logical results of action manner can be displayed as follows 19 u e 1 u a 2 u e 2 u a 4 u e 3 u a u c t u e 4 u a 4 u e 5 u a u θ t φ o φ t u θ t u d c p a φ o φ t 3 optimization algorithm in order to improve the practicality of the usv anti collision path planning algorithm there needs to further modify the optimization algorithm under the framework of colregs in the following aspects first a virtual repulsion force perpendicular to the original repulsion force for the apf algorithm is constructed to help overcome the deficiency of convergence to local minimum and the direction of this repulsion force is determined by the logical identification result of action manner then the safety course region and feasible course region for vo algorithm are proposed to guarantee the avoidance action apparent and substantial to others finally a numerical algorithm is adopted to determine the presupposed number of steps which could help obtain the easy evasive maneuvers to manipulate 3 1 minimum allowable alteration of course to judge the dangerous encounters that have the potential for collision risk the collision risk index model based on dcpa and tcpa can reflect the spatial temporal proximity however the spatial temporal proximity is the result of unchanged current states of encountering ships in real applications there needs to determine the allowable alteration of course for collision avoidance thus vo approach is adopted to calculate the velocity obstacle region which could determine the sets of velocities where if the velocity of the chosen object falls into a set a certain spatiotemporal proximity situation will happen in the future wang et al 2020 suppose that os and ts are in an encounter type and their kinematic information e g heading position velocity etc are known the states of os and ts are expressed as o φ o t p o t v o t and t φ t t p t t v t t respectively where φ t p t v t are the heading position and velocity of each ship at time t now we define a ray from the position of os and moving in the direction of v ot v o t v o t v t t then the ray position can be calculated as follows illustrated in fig 9 20 λ p o t v o t t p o t v o t t t t 0 when λ p o t v o t t falls into the region between the two tangent rays l o 1 and l o 2 for the coordinated ship domain of p t t with a radius r c it can be assumed that the collision cannot be avoided the relative collision cone r c c o t representing the set of relative velocity v o t could be defined as 21 r c c o t v o t λ p o t v o t t p t t in real application there needs to convert relative velocity space to the usv s absolute velocity space thus the velocity obstacle region of os v o s t s is determined as 22 v o s t s r c c o t v o t v o t λ p o t v o t t p t t where is the minkowski operation which shifts r c c o t according to the velocity of ts os is not allowed to select any velocity vector in the region v o s t s considering the practical manipulation of give way ship variation of os heading should be less than π 3 the allowable course region acr is defined as 23 a c r φ o t φ o φ a c r 1 φ a c r 2 where φ a c r 1 and φ a c r 2 are the lower and upper limit of os s heading angle correspondingly the course obstacle region cor should be within acr and is defined as follows 24 c o r o t φ o t φ o t φ c o r 1 φ c o r 2 where φ c o r 1 and φ c o r 2 are the left and right course boundaries corresponding to the tangent rays l o 1 and l o 2 contrasting to c o r o t the safety course region scr ot is defined as follows 25 s c r o t φ o t φ o t φ a c r 1 φ c o r 1 φ c o r 2 φ a c r 2 considering ship s navigating in open sea usually operates at full speed ahead it is difficult for the main engine of the ship to reduce speed in a short time due to inertial impact thus an alteration of course is generally more effective than an alteration of speed since it is quick to take effect and is easily observed both visually and on radar from the other vessels paragraph b of rule 8 states any alteration of course and or speed to avoid collision shall if the circumstances of the case admit be large enough to be readily apparent to another vessel observing visually or by radar based on different recognition of this rule many researchers proposed different ranges for the alteration of course either from the starboard side or port side such as π 12 π 3 or π 6 π 2 and the object of give way vessel and direction of alteration could be determined based on the logical identification results however the purpose of taking substantial action is to display the avoidance intention and it is inappropriate to indicate this intention just by the give way vessel s alteration range thus the apparent relative motion could be defined by satisfying the requirement of direction variation of relative velocity larger than π 18 finally the feasible course region fcr os ts illustrated in fig 10 is calculated as 26 f c r o s t s φ o t φ o t φ o 1 φ o 2 φ o t t π 18 from the perspective of economy we define the minimum feasible course φ f is the minimum within the region of f c r o s t s then it is used as the course alteration constraint for the path planning algorithm the discretization method is adopted to help determine φ f and the schematic diagram is shown in fig 11 first according to the logical identification results u a u e in section 2 2 and 2 3 the responsibility direction of alteration and scope of acr could be determined afterwards the c o r o t is determined by traversing 1 intervals and comparing the dcpa with radius of coordinated ship domain r c thus we can get the refined scr based on the action manner similarly the f c r o s t s is determined by similar interval and comparing the direction of relative velocity with π 18 finally the minimum value of f c r o s t s is adopted as the course constraint for the path planning algorithm 3 2 improved artificial potential field algorithm the artificial potential field apf algorithm is first applied in the field of robot path planning proposed by khatib in 1985 subsequently it was adopted in usv path planning the apf method shows the potential to address the unpredictable changes of tss courses in the solution finding process and the corresponding computation time is very short lyu and yin 2018 the basic idea of the algorithm is to equate the movement of the ship in the actual environment to the movement in an abstract artificial potential energy field where the ship is subjected to two kinds of force illustrated in fig 12 the target point generates attraction to the ship which drives it to move toward the target point correspondingly the obstacle in the environment generates repulsion force which prevents the ship from colliding with the obstacle as a consequence the combined force controls the ship to approach the destination whilst avoiding the obstacles in the coordinate system the position of the ship can be expressed by z c x c i ˆ y c j ˆ the formula of the attractive potential field of the target point on the ship is defined as 27 u a t t z 1 2 k a t t d z c z g 2 28 d z c z g z c z g x c x g 2 y c y g 2 where k a t t is the attractive potential field coefficient and is inversely proportional to the square of the distance between the ship and the target point d c z c z g z c represents the position vector of the ship z g is the position vector of the target point thus the function formula of attractive force obtained by calculating the negative gradient of the attractive potential field is 29 f a u a t t z k a t t z c z g 2 n o a where n o a is a unit vector pointing to the target position from the ship based on collision risk assessment model established in section 2 1 the ship would proceed to the target point under the virtual attractive force if the collision between the ship and the obstacle is below the threshold value once the encounter type forms the repulsive potential field is computed automatically the repulsion force acts on the ship which pushes the ship away from the obstacle finally the ship is manipulated under the two kinds of force similar to the attractive potential field the magnitude of the repulsive potential field is inversely proportional to the distance between the ship and the obstacle the repulsive potential field generated by the obstacle is shown as follows 30 u r e p z 1 2 k r e p 1 d z c z o 1 l o 2 u r s u r t 1 0 u r s u r t 0 where d z c z o represents the euclidean distance between the obstacle and the ship k rep represents a non negative repulsion potential field coefficient l o is the influence radius of the obstacle considering the coordination on the perceived collision risk between the encounter ships a coordinated ship domain model is developed in the collision risk assessment the three dimension repulsive potential field is shown in fig 13 correspondingly the expression of the repulsion force is calculated as follows 31 f r u r e p z k r e p 1 z c z o 1 l o z c z o z c z o 2 n o t u r s u r t 1 0 u r s u r t 0 where n o t a unit vector pointing to any ts from the os it should be noted that the apf algorithm does not have versatility due to the nature of convergence to local minimum for example a head on situation occurs the existing resultant force cannot take the ship escape from the obstacle thus a virtual repulsion force perpendicular to the original repulsion force is added as shown in fig 12 and the magnitude is 32 f p k k l o s t n k r e p 1 z c z g 1 l o z c z g z c z g 2 n o t u r s u r t 1 0 u r s u r t 0 where k is the gain coefficient k lost is the attenuation coefficient n o t is unit vector perpendicular to n o t and the direction is determined based on the logical identification result of action manner as follows 33 φ n o t φ n o t π 2 u a 1 φ n o t π 2 u a 2 finally the total virtual force is obtained by 34 f t o t a l f p f a f r in real application it is desirable to obtain a smooth path with fewer times of course alterations in addition the colregs states that a succession of small alterations of course should be avoided therefore the concept of presupposed number of time step is proposed and applied in the apf algorithm which could divide a complete anti collision path into avoidance part and restoration part in order to avoid the vibration of small course alterations for the calculated path inconsistent with the navigation practice the course of the vessel gradually reaches and stabilizes at φ f during the number of steps specifically this number is calculated by numerical algorithm illustrated in fig 14 first the parameters of dcpa and tcpa when the course changes from are φ o to φ f then the basic number of steps n is determined by taking the integer part from the ratio of tcpa and step correspondingly the euclidean distance d 1 d 2 d 3 among target ship position p t relative position p os ts and destination point p oe is determined and the distance d between p t and segment from relative position p os ts to destination point p oe also can be determined based on law of cosines finally the presupposed number is obtained by comparing the distance with domain radius r c at one step interval considering the practical application a model of the ship s motion is simulated on the horizontal plane the dynamic properties of a ship taken into account by considering the time needed to execute the course alteration thus the configuration of the parameters maxturn and time step are used to reflect the dynamic properties of the ship this mainly depends on the available rudder angle less than 35 the velocity the loading condition and the delay of turning for a ship for some large vessels with worse manoeuvrability the maxturn by 5 could be reached as a consequence the maxturn is 5 and the maximum time step is 15s 4 simulation study in this section the performance of the proposed anti collision path planning algorithm is implemented and discussed the simulations considered colregs compliance practical application and a wide range of cases including static and moving targets single ts avoidance random course alterations of tss and multi ship avoidance etc throughout the simulations it was assumed that the usv was the own ship os and all the ships detected in the surroundings by the usv were the targets ships tss the matlab software platform is used to run the anti collision computation simulations after careful consideration of the traffic scenarios the relevant parameters of the algorithm are set as follows k a t t 90 k r e p 6 k 30 r c 0 97 nm r a 3 6 nm 3 nm for overtaking situation 6 nm for head on and crossing situation maxturn 5 and time step 10 15s these test cases primarily aim to evaluate the effectiveness and operability of the proposed scheme thus the simulation results including optimal trajectory of each ship the relative trajectories the distance variation the relative bearing angle and heading variation are illustrated in the following figures a two dimensional cartesian coordinate system represents the distance in nautical miles nm the vertical axis in the positive direction shows north and the horizontal axis in the positive direction is 090 the following symbols and color codes are applied to enhance the visualized results the starting point and destination point of os are represented by black filled circles and the target ships tss are numbered with a label starting from 1 the starting points of ts1 ts2 ts3 ts4 ts5 and ts6 are represented by brown red green blue cyan and magenta pentagram the trajectory and heading angle of os are represented by a black curve the relative trajectories of os with respect to ts are marked by dotted curves with different colors corresponding to the starting points of tss the non filled circles with different colors indicate the ship domain and the number on each position indicates the corresponding steps the illustration of relative bearing angle and the relative heading angle with different colors are used to demonstrate the apparent action to other vessels 4 1 scenario 1 head on situation in the initial configuration the initial heading angle of os and ts1 are 45 and 135 respectively the initial velocities of os and ts1 are same namely 15 kn the initial positions of os and ts are 1 1 and 10 10 and the destination point of os is set 10 10 considering the initial dcpa 0 0029 nm r s 0 5 tcpa 1527 s r t 0 5 the ships stay in the stage i and free to take any action when t 807 s the head on situation forms and each shall alter her course to starboard so that each shall pass on the port side of the other thus the turning point is the 54th step and in order to demonstrate the effectiveness of the proposed anti collision scheme it is supposed that the avoidance action is solely taken by the os in this section according to the vo algorithm the feasible minimum course is determined φ f 75 correspondingly the presupposed number of steps is also determined num 34 the simulation results are presented in fig 15 the trajectories of two ships and the os with respect to ts1 are presented in fig 15 a b at the turning point the os alters her course to starboard side by 30 and executes the restoration action to the destination point at the 89th step as can be seen from fig 15 b the os does not intrude the domain of ts1 all the time which is further verified by the distance variation curve in fig 15 c the minimum distance is 0 976 nm larger than r c the detailed heading angle of os is shown in fig 15 d compared with apf algorithm there is no vibration of small course alterations during the entire process of avoidance by the proposed scheme which greatly improves the practicality by reducing the difficulty of manipulation the relative heading angle variation is illustrated in fig 15 e is larger than π 18 and the relative bearing angle variation in fig 15 f is also obvious therefore the os s behaviour can be considered readily apparent to ts1 4 2 scenario 2 crossing situation in the initial configuration the initial heading angle of os and ts2 are 45 and 345 6 respectively the initial velocities of os and ts2 are same namely 13 kn the initial positions of os and ts2 are 1 1 and 10 0 8 and the destination point of os is set 10 10 considering the initial dcpa 0 16 nm r s 0 5 tcpa 1771 s r t 0 5 the ships stay in the stage i and free to take any action when t 591 s the crossing situation forms and os is the give way vessel and shall alter her course to starboard to keep out of the way of ts2 and avoid crossing ahead of ts2 correspondingly the turning point is calculated at the 40th step based on the vo algorithm and numerical algorithm the feasible minimum course and presupposed number of steps are determined φ f 70 and num 59 respectively all the simulation results for crossing situation are shown in fig 16 the trajectories of two ships and the os with respect to ts2 are presented in fig 16 a b the os alters her course to starboard side by 25 at the turning point and the restoration action to the destination point is executed at the 100th step it can be seen from fig 16 b that the relative trajectory of os with respect to ts2 is nearly tangent to the boundary of ts2 s domain the minimum distance is 0 974 nm larger than r c illustrated in fig 16 c which guarantees the safety requirement the detailed heading angle of os with respect to the avoidance action is shown in fig 16 d compared with optimization result by apf algorithm there is no vibration of small course alterations during the entire process of avoidance by the proposed scheme which conforms to the requirement of practicality and navigation practice finally the relative heading angle variation is illustrated in fig 16 e is larger than π 18 and the relative bearing angle variation in fig 16 f is also obvious therefore the os s behaviour could be considered as readily apparent to ts2 4 3 scenario 3 overtaking situation in the initial status the initial heading angle of os and ts3 are both 45 the initial velocity of os is 15 kn while initial velocity of ts3 is 5 kn the initial positions and destination points are 1 1 and 10 10 while the initial point of ts3 is 4 4 through calculation the initial dcpa 0 nm r s 0 5 tcpa 1527 s r t 0 5 are determined the ships stay in the stage i and free to take any action at the current status when t 447 s the criteria of overtaking situation is met the os shall keep out of the way of ts3 by altering course to starboard side judged by the logical identification in section 2 correspondingly the turning point is determined at the 30th step similarly the feasible minimum course and presupposed number of steps can be determined φ f 60 and num 35 respectively the simulation results for overtaking situation are shown in fig 17 the trajectories of two ships and the os with respect to ts3 are presented in fig 17 a b the os alters her course to starboard side by 15 at the turning point and the restoration action to the destination point is executed at the 73rd step the minimum distance of the distance variation is beyond the r c illustrated in fig 17 c which guarantees the safely navigation between each other compared with optimization result by apf algorithm there is no vibration of small course alterations in fig 17 d which is convenient for ship s manipulation finally the relative heading angle variation is illustrated in fig 17 e and the relative bearing angle variation in fig 17 f demonstrates the apparent actions to ts3 4 4 scenario 4 multi ship encounter situation in the initial status os and six ts form a multi ship encounter situation and the initial information of all these ships are shown in table 3 ts1 and ts2 are the static obstacles and do not have collision risk with os ts3 is located at the right of the figure and a crossing situation with os is developing ts4 is nearly located at the right ahead of os and a head on situation between them is developing ts5 and ts6 are respectively located at the starboard and port side of os and do not have collision risk with current state fig 18 a b indicate the trajectories of these ships and the os with respect to ts fig 18 c f illustrate the distance between any ts the heading angle of os at each time step the relative heading angle and relative bearing angle of os with respect to all tss as can be seen in fig 18 a os keeps on the initial heading as there is no collision risk between os and tss at the 30th step the criteria of crossing situation between os and ts3 is first met r s 0 5 r t 0 5 according to the identification results os is the give way vessel and needs to turn to the right and avoid crossing the bow of ts3 the feasible minimum course can be determined as φ f 75 in section 3 1 thus os alters course to starboard by 30 to keep out the way of ts3 the corresponding relative heading angle variation larger than π 18 and relative bearing angle variation of os with respect to ts3 illustrated in fig 18 e f demonstrate the apparent actions to ts1 and ts5 then os and ts5 form the crossing situation r s 0 5 r t 0 5 at the 83rd step considering the static obstacle ts1 located at the right side of os the feasible course region fcr for ts1 and ts5 is calculated simultaneously based on vo algorithm as a result os further alters course to starboard by 30 again to keep out the way of ts1 and ts5 similarly the corresponding relative heading angle variation and relative bearing angle variation with respect to ts1 and ts5 demonstrate the apparent avoidance intentions to ts1 and ts5 finally os alters course to the destination at the 174th step though the space collision risk between os with ts6 during the 83rd to 174 steps r s 0 5 but the time space collision risk is far less than the threshold value due to the large tcpa thus the ts6 does not generate repulsion force on os like other tss and os stands on and moves to the destination without any risk until reaching the destination at the 471th step it should be noted that the relative trajectories of os with respect to all tss do not violate any domain of tss shown in fig 18 b meanwhile the minimum distance of the distance variation is beyond the r c illustrated in fig 18 c as a consequence the safety of the optimal trajectory is guaranteed in addition there is no vibration of small course alterations in fig 18 d which satisfies the design of proposed scheme 4 5 scenario 5 uncoordinated multi ship encounter situation this scenario contains a more complex situation where tss have random changes in course the initial traffic configuration is shown in table 4 at the beginning ts1 can be considered as a static obstacle and do not have collision risk with os ts2 is located at the starboard side of os and a crossing situation is developing ts3 and ts4 are respectively located at the starboard and port side in the direction of os s and both have a tendency to form the head on situations ts5 is located at the port side in the direction of os s bow and a crossing situation is also developing it can be observed that os initially keeps on the original heading towards the destination point as there is no collision risk between os and any ts at the 15th step the criteria of crossing situation between os and ts2 is first met r s 0 5 r t 0 5 os is the give way vessel and alters course to starboard by 30 to keep out the way of ts2 at the 30th step ts2 ts4 and ts5 suddenly performed an uncoordinated course alterations by 30 the collision risk index between os and ts2 is beyond the safety threshold value thus os makes a further course change of 20 to starboard to avoid a collision with ts2 at the 40th step ts3 also performed an uncoordinated course alteration by 30 considering this action did not result in the collision risk between os and ts3 os does not take any action however this random course alteration by ts3 results the delay of os s restoration if restoration of os to destination is executed too early there is additional collision risk between os and ts3 thus the presupposed number is determined based on the numerical algorithm in section 3 2 112nd step after passing ts3 at a safe range illustrated in fig 19 c os and ts4 forms the crossing situation r s 0 5 r t 0 5 ts4 is the give way vessel and os should keep the course and velocity unchanged as the stand on vessel but at the 142nd step it is apparent that ts4 is not taking appropriate action in compliance with rules os is permitted to take action to avoid collision by her maneuver alone according to colregs os should alter course to port side to pass stern of ts4 but this action would lead to another collision risk between os and ts5 in addition the alteration angle to starboard should not be too large in order to avoid collision with ts1 thus os takes a further course change of 5 to avoid a collision with ts4 finally os alters course to port by 5 to approach the destination at the 225th step after passing ts4 at a safe range shown in fig 19 c since ts5 is approaching from port side and the dcpa is enough to pass clear os stands on and moves to the destination without any risk until reaching the destination at the 329th step similarly fig 19 b c indicates the relative trajectories and distance of os with respect to tss which could effectively demonstrate the safety of the optimal trajectory fig 19 d f illustrate the heading angle of os at each time step the relative heading angle and relative bearing angle of os with respect to all tss which reflect the maneuvering characteristic of os during the collision avoidance process more importantly there is no vibration of small course alterations in fig 19 d which demonstrates the practicality of this proposed scheme 4 6 discussions and analysis the proposed path planning algorithm is tested under simple conditions by scenario 1 to scenario 3 when tss always keep original state unchanged throughout the collision avoidance process in addition more complex conditions are also verified by scenario 4 to scenario 5 these scenarios take into account the random course alterations by tss no matter os is give way vessel or stand on vessel the simulation results show that the proposed scheme can safely and correctly avoid collision under several typical encounter situation and deal with a variety of extreme scenarios including tss taking actions as stand on vessel and tss not taking actions as give way vessel the collision risk index is established to help judge the action time as illustrated in figs 15 19 a which makes the avoidance action close to navigation practice and the boolean expression technology is adopted to help determine the encounter type and action manner which could improve the autonomy of the proposed scheme the relative trajectories and relative distance between os and tss for these scenarios are shown in figs 15 19 b c it is obvious that the dcpa is larger than the radius of ship domain r c which demonstrates the safety of the proposed algorithm furthermore no matter in term of colregs or in practice a substantial alteration of course is the most common and effective action for the give way vessel in an encounter situation the substantial and apparent action is quantified and incorporated into the vo algorithm which could help determine the feasible course region fcr significant variations are also observed for a certain substantial alteration of relative heading angle as shown in figs 15 19 e and relative bearing angle with respect os to tss as shown in figs 15 19 f for example when the alteration of heading angle is only 15 in overtaking situation but the relative heading angle variation is 24 larger than π 18 and the corresponding relative bearing angle is nearly to π besides it should be noted that the irregular and successive small course alterations are eliminated by introducing the parameter presupposed number of steps as shown in figs 15 19 d this modification does not make the avoidance actions compliance with navigation practice but also reduce the difficulty of ship manipulation which greatly improves the practicality and reliability of this proposed algorithm thus a relatively complete path planning algorithm is proposed and can be embed into the navigation aids such as ecdis 5 conclusions in this article an application orientated anti collision path planning algorithm for unmanned surface vehicles is presented borrowing the concept of coordinated ship domain a practical collision risk index model is established based on the boolean expression technology the automatic identification of encounter type and action manner is realized and makes the anti collision algorithm more complete meanwhile the substantial and apparent action is quantified and incorporated into vo algorithm to calculate the feasible course region for give way vessel in addition the introduction of virtual repulsion force and the parameter presupposed number of time step help to extend the scope of application and improve the practicality and rationality of the optimization solution by incorporating different traffic scenarios into the proposed scheme simulation examples including head on crossing overtaking multi ship encounter tss take random actions and tss do not take actions as give way vessel are applied to demonstrate the practicality and effectiveness of the proposed scheme the simulation results show that the proposed path planning algorithm could safely and correctly avoid collision even for complex encounter situations however this proposed scheme is not suitable for restricted water and takes inadequate consideration of the coordination among different ships actions and the unexpected trajectories of tss are known in advance therefore our future research will be concentrated on the anti collision decision in restricted water as well as the coordination among ships actions and the understanding of other ships intention is another future work direction in the field of emergency decision making for the unexpected changes of course the employment of coordinated optimization algorithm may be an effective method to guarantee the coordination among ships actions by evolving all the give way vessels actions simultaneously credit authorship contribution statement shengke ni writing original draft methodology software zhengjiang liu supervision funding acquisition dengjun huang formal analysis yao cai supervision funding acquisition xin wang validation supervision shang gao validation supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work is supported the national natural science foundation of china grant 51909022 
20462,a high resolution unstructured simulating waves nearshore swan model with a resolution of 200 m within 20 km of the coast was developed to provide a reliable setting for a long term wave energy characterization of the gulf of mexico puerto rico and the u s virgin islands a thorough model parameter sensitivity analysis as well as a calibration process for selecting the whitecapping dissipation formulation were conducted sensitivity analyses for the simulation timestep and number of iterations highlighted the less studied interplay between these parameters in swan which can substantially affect simulation accuracy and cost and is vital for the next step long term simulation of the wave energy resources for the present study a 3 min timestep and three iterations are optimum the garden sprinkling effect and the cut off frequency were also investigated using 36 directional bins and a larger cut off frequency 1 0 hz enable the best agreement between the model simulation and the in situ wave observations this subsequently leads to improved model skill and performance in resolving the observed international electrotechnical commission iec wave energy resource parameters that are highly non linear functions of wave spectral moments keywords wave energy swan gulf of mexico puerto rico virgin islands 1 introduction characterization and assessment of wave energy resources in u s coastal and offshore waters has been an important ongoing community effort for several years ahn et al 2020 2021 dallman and neary 2014 neary et al 2020 wu et al 2020 yang et al 2017 2020 due to the scarcity of historical data sparse coverage the limited number of in situ observations and the lack of high fidelity wave measurements e g spectral data long term wave hindcasts generated by carefully calibrated verified and validated numerical models are recommended for conducting such studies iec 2015 high resolution swan models with spatial resolutions of 200 m nearshore have been developed verified and validated for waters along the east coast allahdadi et al 2019a b the west coast wu et al 2020 yang et al 2017 alaska garcía medina et al 2021 and hawaii the high resolution swan wave model developed for the east coast was thoroughly calibrated for whitecapping after a detailed sensitivity analysis of numerical parameters allahdadi et al 2019a wave observations from 18 national data buoy center ndbc buoys were used for model calibration and verification based on the six iec standard parameters the present paper details efforts to prepare a similar calibrated and verified wave model that in the future will be used for the hindcast of wave energy resources in the gulf of mexico gom puerto rico pr and the u s virgin islands usvi the gom pr usvi gprvi region several studies address various aspects of the wave climate and modeling methodology for the gprvi region ex anselmi molina et al 2012 appendini et al 2012 2014 chaichitehrani et al 2019 moghimi et al 2020 siadatmousavi et al 2011 2012a b silander and garcía 2019 sorourian et al 2020 based on the hindcast outputs from a 30 year simulation using mike 21 model appendini et al 2014 studied the wave climate trend of the gom their modeling results showed that cold fronts are the main modulating force for mean wave climate in the gom while both hurricanes and cold fronts contribute to extreme wave heights for the pr and usvi region wave climate is mainly affected by atlantic swells wind generated waves under the caribbean low level jet cllj or both depending on the location and season appendini et al 2014 anselmi molina et al 2012 silander and garcía 2019 one key aspect of a successful wave model in the oceanic and shelf waters is selecting the most appropriate whitecapping formulations and their associated parameters using a proper calibration process allahdadi et al 2017a rusu 2011 whitecapping formulations for the gprvi region have been examined in several studies appendini et al 2012 anselmi molina et al 2012 siadatmousavi et al 2011 a detailed analysis of whitecapping parameterization in the gom based on wam cycle 3 and wam cycle 4 whitecapping formula almost equivalent to the komen and janssen formulation in the recent swan versions was presented by siadatmousavi et al 2011 they examined different parameters in the formulations and concluded that during the cold front and fair weather conditions wam cycle 4 generally performs better in the gom especially in wave period simulation similar results on successful simulations using the wam cycle 4 formulation were reported for the gom by appendini et al 2014 for pr and usvi regions several modeling studies reported the successful application of wam cycle 3 while wam cycle 4 was not included in the verification process anselmi molina et al 2012 silander and garcía 2019 moreover a high accuracy modeling of wave characteristics and thereby wave energy needs a thorough investigation of some numerical model parameters and determining the optimum values for simulation for the u s east coast allahdadi et al 2019a performed a detailed sensitivity analysis on different numerical input values they concluded that for the unstructured swan results could be significantly sensitive to the simulation timestep and number of computational iterations for the specific case of wave modeling with the goal of wave energy characterization following the iec standards additional parameters should be calculated as well as the regular bulk and spectral parameters these parameters could substantially be affected by spectral discretization parameters including the number of spectral frequencies the number of directional bins and maximum resolved frequency cutoff frequency before applying the diagnostic tail function dykes et al 2002 siadatmousavi et al 2012a b siadatmousavi et al 2012a b reported that wave simulation results for bulk parameters including wave height peak period and mean wave period can be sensitive to the cutoff frequency and the power of the diagnostic spectral tail depending on the wind input and whitecapping formulation used this sensitivity could be more pronounced for non linear parameters like spectral width which is one of the main wave energy resource parameters in numerical models another example of the importance of spectral discretization parameters on wave simulation accuracy is the adverse effect of low directional resolution on the propagation pattern of swells over the extensive regions like oceanic basins of thousands of kilometers in dimensions tolman 2002 rogers et al 2002 this effect causes a discontinuity in wave crests as they propagate over the basins and can substantially degrade the simulation accuracy while important for an extensive modeling area like gprvi region the previous studies have not appropriately addressed this issue we describe herein the preparation and evaluation of a high resolution wave model for the gprvi region with the final implication for the wave energy resource characterization it includes the steps for setup sensitivity analysis and calibration of a high resolution wave model for the gprvi region following the methodology that was successfully utilized for the u s east coast the present study makes several unique contributions 1 the computational mesh for both inner shelf and coastal regions is very high resolution which is unprecedented for these regions considering the total length of the refined coastal areas included in the computational mesh 2 thorough sensitivity analyses of model parameters are conducted to optimize model accuracy and computational costs 3 sensitivity analysis of a new parameter the cut off frequency is conducted to accommodate the non linear behavior of some iec parameters in the spectral space to the authors knowledge cut off frequency has not been examined in any of the previous wave energy resource characterization studies 4 the garden sprinkler effect gse is included along with the sensitivity analysis of the number of spectral directions to optimize model spectral directions 5 the interplay between computational timestep and the number of iterations that can optimize the model setup is examined both parameters can significantly contribute to decreasing the computational costs 6 the present study is the first detailed calibration of swan s whitecapping formulations for the study region specifically this research introduces two sets of calibration parameters for whitecapping corresponding to the hurricane and non hurricane seasons which has not been included in previous studies 7 the verification of the gprvi wave model for the six iec parameters highlights areas where the scientific engineering community can focus on the development of the next generation wave models for this study region and elsewhere 2 model setup and data the third generation phase averaged swan v 41 10 on an unstructured mesh was used for wave modeling of the study region the model uses adcirc s platform to accommodate the parallel processing option of the unstructured version without coupling with the hydrodynamics module of adcirc in solving the wave action conservation equation swan considers the main physical processes in the generation and propagation of waves in both deep and shallow waters in the present simulations source terms including wind input whitecapping dissipation non linear wave interaction bottom friction shallow water wave breaking and riad were considered more details about the governing equations and source terms quantification can be found in swan 2015 and allahdadi et al 2019b the simulation domain consists of the gom north atlantic ocean caribbean sea cs pr and usvi fig 1 the model open boundary was set at 52 8 w longitude to provide enough distance for wind generated waves and boundary condition swells to propagate toward the pr and usvi region an array of 18 buoys including 15 from national data buoy center ndbc two wavcis buoys managed by louisiana state university s coastal studies institute stone et al 2009 2010 2010 and one buoy from the coastal data information program mcwhorter et al 2016 was used for calibration and verification of the model see fig 1 for locations table a1 summarizes the list of buoys with their depth geographical coordinates and data availability information an unstructured mesh based on triangular elements was used for wave simulations the main feature of this mesh is the high 200 m resolution within 20 km of the coastline for the entire study area fig 1b mesh resolution for the inner shelf regions is 1 3 km decreases to 5 8 km in the outer shelf in the gom and in the entire caribbean sea and reaches to about 20 km along the open boundary in the north atlantic fig 1b and c such a high resolution mesh results in a huge number of computational grid points more than 5 7 millions that makes the use of parallel processing for simulation inevitable hence simulations for both sensitivity tests and calibration were run on the high performance computing resources of sandia national laboratories simulations were run on sandia s chama cluster which consists of almost 1232 nodes each with a 16 core 2 6 ghz intel processor and 64 gb of ram the simulation of a single month takes approximately 30 h of wall time on 640 of these cores 40 nodes the coastal relief model with spatial resolution of 3 arc seconds 80 90 m and etopo1 global relief model with a resolution of 1 arc minute 1600 1800 m provided water depth data for coastal inner shelf and offshore areas respectively these data were interpolated on the unstructured mesh to prepare the bathymetry of the model fig 1a inset following a similar approach as the east coast characterization study allahdadi et al 2019a b the model was forced by the climate forecast system reanalysis cfsr wind fields with a spatial resolution of 0 32 over the modeling area and a temporal resolution of 1 h this was found to be an appropriate wind field for the long term simulation of waves for both east and west coasts allahdadi et al 2019a b yang et al 2017 wu et al 2020 along the open boundary parametric wave characteristics from the wwiii global model chawla et al 2013 with a spatial resolution of 0 5 were prescribed the model numerical parameters and wind input whitecapping formulation were determined from thorough sensitivity analyses and calibration processes as described in sections 3 and 4 3 model sensitivity analysis swan and other state of the art phase averaged spectral models used for simulation of wave generation and propagation solve the governing equations by discretizing the equations in geographical space time and spectral space direction and frequency although model documentation and research studies suggest some default values for the time step and spectral resolution properties of models and the associated numerical metrics for maintaining numerical convergence they can be highly site specific and significantly change based on the bathymetry coastal geography and met ocean climate of the study regions allahdadi et al 2019a cavaleri and bertotti 1994 furthermore information about the frequency and directional distribution of waves along the open boundary is user defined and could be site specific a practical and effective way to select these parameters is by implementing sensitivity analyses on a reasonable range of values for each parameter then selecting appropriate values based on model accuracy and cost in the present study a thorough sensitivity analysis was performed on several model inputs seven parameters including simulation timestep number of iterations number of spectral frequencies number of spectral directions directional bins cutoff frequency directional spreading of boundary waves and frequency spectral shape of boundary waves were evaluated the appropriate range and values for sensitivity analyses of these parameters were based on recommendations in the swan documentation swan 2015 and previous studies of this region e g siadatmousavi et al 2011 2012a b allahdadi et al 2019a appendini et al 2012 it should be noted that the coastal resolution of 200 m used in the present modeling is based on the requirements to follow the iec standards for doing a feasibility to design level resource assessment iec 2015 therefore no sensitivity test on mesh resolution was considered compared to other short term and long term wave simulations in the study area this 200 m resolution is much finer the computational mesh used in the present study has also a higher resolution in offshore areas than almost all the previous successful wave models in the region the mesh was designed to create a smooth transition from coastal areas toward the inner and outer shelves and eventually offshore waters while limiting the resolution to a maximum of 5 km in the offshore regions in the gulf of mexico puerto rico virgin island and the caribbean sea to implement the sensitivity analysis simulations two 1 month time periods cal2 and cal3 that included major meteorological phenomena tropical storms winter cold fronts cllj and fair weather conditions of the study area were considered these two time periods are a part of four time slots cal1 cal2 cal3 and cal4 that are used for model calibration in section 4 sensitivity period cal2 mid august to mid september 2008 includes major hurricanes gustav and ike as well as fair weather conditions sensitivity period cal3 january 2008 includes two cold fronts and episodes of fair weather the final setup from the east coast high resolution simulation table 3 allahdadi et al 2019a was used as the basic model setup except that the computational timestep was 5 min herein the basic model setup sensitivity used 1 iteration 0 04 hz minimum frequency 0 52 hz maximum frequency 28 frequencies 24 directions and the janssen whitecapping formulation with cds 2 7 and delta 0 9 see section 4 for more details about these parameters model outputs for significant wave height and mean wave period t 02 at the location of each buoy were compared with buoy measurements fig 2 a d also the average values of model performance statistics mps including correlation coefficient r root mean square error rmse scatter index si and bias tehrani et al 2013 yang et al 2017 were calculated for each sensitivity run fig 2e h the values yielding the best mpss in both cal2 and cal3 were selected for each sensitivity parameter though values that increased computational cost without adding much to accuracy were not used table 1 although the sensitivity runs for different model parameters were conducted as if the parameters were independent changing any parameter may affect the optimum values for other parameters one important case where this dependency can substantially affect model accuracy and simulation cost is the interplay between simulation timestep and number of computational iterations the sensitivity analysis showed that for timesteps larger than 3 min significant delays and underestimations in wave height peaks were produced during the peak of storms especially during hurricanes fig 2a this inaccuracy corresponding to timesteps larger than 3 min is due to rapidly changing wave characteristics as a result of intense hurricane winds and the substantial spatial variations of wind speed and direction that cannot be resolved using larger computational timesteps for the default timestep of 5 min fixed for the sensitivity tests the smallest number of iterations that resulted in an appropriate comparative accuracy was 3 fig 2b and f which is larger than the default value of 1 specified by swan technical documents swan 2015 again this could be attributed to the abrupt changes in the hurricane wind and wave field requiring more iterations for the model transport equations to converge see section 5 1 for more details when considering timestep independently timesteps as small as 1 min may eventually be needed to maintain sufficient model accuracy however by considering the interplay between timestep and number of iterations a computational timestep of 3 min could be used instead of 1 min table 1 and fig 2 this will be elaborated more in the discussion examining different numbers of spectral frequencies nf showed that the results are not very sensitive to the number of frequencies fig 2c and g this means that the minimum number of frequencies nf 16 selected for the sensitivity test is almost enough to resolve the energy variations in the frequency space over the study region this can be attributed to the dominant wide single peaked shape of frequency spectra in the study region in the absence of major swell systems appendini et al 2012 however nf 28 showed relatively higher accuracy compared to smaller values and therefore it was selected for the final simulation sensitivity tests averaged over all buoys showed that for the number of spectral directions no significant increase in accuracy occurred when nd 18 fig 2h this could be due to the dominant effect of wind induced waves over the modeling area especially the gom which is associated with wider directional spectra to resolve such wide spectra using numerical models lower directional resolutions can be used holthuijsen and tolman 1991 even in the caribbean sea and pr usvi region the wave climate is substantially affected by the cllj appendini et al 2012 and the atlantic swells are significantly blocked by the chain of islands in the southeast caribbean sea the only exception is the northern and western coasts of pr which are directly affected by the north atlantic swells silander and garcía 2019 but the comparison between model results from different numbers of directional bins at ndbc station 41 043 located in the north of pr did not show a significant difference between fewer or more directional bins the examined values for the number of spectral directions 18 72 that are enough to resolve wind induced directional spectra correspond to the directional resolutions of 20 5 therefore results from all the examined directional resolutions are statistically similar based on the sensitivity test the number of directional bins was set at 24 consistent with previous studies however when wave propagation over the entire modeling region is simulated the garden sprinkling effect gse tolman 2002 must be considered propagation of swell waves over a large domain can cause the gse which is a numerical problem tied to using a limited number of directional bins to discretize the model in the directional space to mitigate this effect 36 directions were used instead of the 24 directions suggested by the sensitivity analysis see section 5 2 for details the rest of the sensitivity parameters were selected from the sensitivity run results as the study areas are generally dominated by wind sea exhibiting energy within high frequency band and regarding the fact that this study aims to characterize wave energy resources based on iec standards the sensitivity analysis for the maximum frequency was implemented the six iec parameters include significant wave height energy period omni directional wave power density spectral width direction of maximum power hereafter θmax and directionality coefficient some of these are non linear functions of spectral moments that make the role of cut off frequency more prominent in modeling accuracy see appendix b for detailed formulations sensitivity analysis on the maximum frequency cut off frequency was performed using three values 0 52 hz 1 0 hz and 1 5 hz the results from both cal2 and cal3 simulations showed that the effect of increasing cut off frequency from 0 52 hz to 1 0 and 1 5 hz on wave height energy period and omni directional wave energy is small at most buoys the simulation accuracy of spectral width directionally coefficient and θmax can be significantly improved especially at the shallow water buoys by increasing the maximum frequency this is because these three parameters are strong non linear functions of wave spectral moments the additional high frequency components by including higher values of cut off frequency can make a significant difference in calculating these spectral moments the relationships between the spectral moments and the other three iec parameters wave height energy period and omni directional wave energy are less non linear and thereby these three parameters are less sensitive to the cut off frequency the statistical comparison of these six iec parameters with those calculated from observations for three values of cut off frequency is presented in fig 3 for the coastal ndbc buoy 42 035 located in the northwest of the gom the comparison is for the cal3 period that likely included more high frequency energy components in the wave spectra regarding the dominant atmospheric events during this period the results from cut off frequencies of 1 0 and 1 5 hz are very similar although 1 0 hz results in slightly better accuracies therefore for the final simulations cut off frequency of 1 0 hz was used 4 model calibration and results in this section the calibration of the model for whitecapping parameters is described the model setup configuration from the sensitivity section was used for the calibration process quantifying the source terms in the wave action equation in swan and other state of the art phase averaged models is a critical part of the model among the source terms representing dissipation due to whitecapping is the most challenging one due to its complex mechanism and many uncertainties associated with its physics massel 1996 cavaleri et al 2007 formulating whitecapping dissipation based on the mean spectral properties including wave steepness and wavenumber has been the most popular approach based on the pulse based model of hasselmann 1974 two frequently used versions of this methodology are wam cycle 3 and cycle 4 in swan similar formulations are available as komen et al 1984 and janssen 1991 the whitecapping relationship in these two formulations is the same and the difference is in their wind input counterpart and scaling the whitecapping coefficients the rate of energy dissipation due to whitecapping s d s w σ θ in these formulations is represented as 1 s d s w σ θ c d s 1 δ δ k k s s p m p σ k k e σ θ 2 s k e t o t where c d s is the whitecapping coefficient and δ is a parameter that varies between 0 and 1 with the default of 1 in swan this parameter is used for partially adjusting wave period and may also affect the wave height one may need to change δ to accommodate different values of c d s rogers et al 2003 reported that by changing δ from 0 to 1 the accuracy for the prediction of wave energy corresponding to low frequencies increases power p is a constant k is wave number with average k σ is the angular wave frequency with average σ e t o t is the total energy of the wave spectrum s is the mean spectral steepness s p m 3 02 10 3 1 2 is the mean spectral steepness due to the pierson moskowitz spectrum and e σ θ is the spectral energy for a component with an angular frequency of σ and direction of θ average angular frequency and average wave number are calculated by integrating over the frequency directional spectrum as follows 3 σ e t o t σ 1 e σ θ d σ d θ 4 k e t o t k 1 2 e σ θ d σ d θ 2 the strong dependency of the whitecapping formulation on the mean spectral parameters is maintained through k σ and s depending on the formulation used for the wind input term two sets of values for c d s and p were found by komen at al 1984 and janssen 1991 by balancing the energy equation through fetch growth tests komen et al 1984 used a linear term for quantifying the exponential part of wind input while janssen 1991 calculated with a quadratic variation of wind input according to these estimations a value of 4 was recommended for p in swan another class of whitecapping dissipation formulation is the quantification based on the saturated based concept of the wave spectrum that potentially can distinguish between the dissipation of high frequency wind generated energy components and low frequency swells van der westhuysen et al 2007 all three formulations are options in swan komen s and janssen s formulations are two of the most frequently used approaches used in wave modeling siadatmousavi et al 2011 swan 2015 allahdadi et al 2017a the westhuysen approach was incorporated in swan to resolve the spurious behavior of these two approaches when sea state is dominated by low frequency swells however allahdadi et al 2019b showed that for the u s east coast in the absence of low frequency swells the westhuysen approach significantly underestimates both wave height and period presumably due to substantial spatial and temporal variations in the wind field that makes a fetch limited sea state less likely comparing the three whitecapping formulations of swan through a calibration process they concluded that the janssen formulation with c d s 2 7 and δ 0 9 results in the best match with observed wave height and period allahdadi et al 2019a a similar approach with more details and more comprehensive statistical results was followed to determine the most appropriate formulation and the associated coefficients for the wave climate of the gprvi model four 1 month calibration periods were selected to accommodate the most important atmospheric features of the study region the simulation periods are cal1 25 august 25 september 2005 cal2 20 august 20 september 2008 cal3 1 31 january 2008 and cal4 1 31 march 2009 tropical storms and hurricanes significantly affect wave climate in the gprvi region the official hurricane season in the northern atlantic including gom is 1 june 30 november each year landsea 1993 however an investigation on the monthly distribution of the storms from 1851 to 2017 showed that more than 80 of the tropical storms hurricanes in the region occurred in august through october landsea 2018 cal1 and cal2 include hurricane wave fields from major hurricanes katrina rita gustav and ike fig 4 in the gom cold fronts are the most prominent non hurricane atmospheric phenomena that substantially impact both extreme and average wave climate as well as other hydrodynamic parameters siadatmousavi et al 2012a b chaichitehrani et al 2019 allahdadi et al 2017b appendini et al 2012 cold fronts are northern fronts that outbreak in the gom especially in the northern gulf from october to may each year moeller et al 1993 each episode of cold front outbreak may take 12 24 h with 3 7 d intervals between consecutive cold fronts cal3 and cal4 specifically examine the effect of cold fronts in the calibration tests fig 4 in the caribbean region the caribbean low level jet cllj is a prominent atmospheric feature that substantially affects the mean wave climate of the region appendini et al 2012 the cllj with a general easterly direction is present through the year over the region with two maxima in february and july this atmospheric feature is included in cal3 and cal4 the impact of cllj on the pr usvi regions can be seen in cal3 fig 4 the rest of the atmospheric features of the study region are summer fair weather conditions in both gom and the north atlantic and winter storms in the north atlantic the setup obtained from the sensitivity section table 1 was used for calibration runs the first stage was determining the most appropriate whitecapping formulation in swan by comparing model results for simulations using the default configurations the average mpss at all buoys showed that for the default whitecapping parameters the janssen formulation results in the best match for both wave height and period fig 5 upper panels the calibration process was completed by narrowing the janssen formulation s parameters including the whitecapping coefficient c d s and parameter δ to determine the best parameter tune values from 2 to 4 5 for c d s and 0 5 1 for δ were examined see table 2 for 15 representative sets of calibration values that resulted higher accuracy among all values within the full range of examined values simulation id 0 is the base case corresponding to the calibration parameters in the east coast simulation c d s 2 7 and δ 0 9 for the calibration periods that include hurricanes cal1 and cal2 the combination of c d s 3 7 and δ 0 9 calibration case 3 resulted in the best match up while the best results for the non hurricane months cal3 and cal4 were for c d s 2 5 and δ 0 9 which is corresponding to calibration case 4 fig 5 mid and lower panels hence for the long term simulation two different sets of whitecapping parameters were advised depending on the season the hurricane season parameters are applied only for august through october for the rest of the year the non hurricane calibration coefficients are applied the accuracy of the calibrated model at individual buoys was also investigated to determine the spatial distribution of model accuracy for wave height and period fig 6 and 7 the highest correlation coefficients 0 95 for wave height were found at the buoys in the gom especially in the coastal areas fig 6 while the lowest values of bias were also obtained for the gom the buoy at virgin island cdip 431 showed the smallest values for the rmse and one of the lowest for si the higher accuracy for the simulation of wave height in the gom could be due to the fact that wave climate in the gom is mostly affected by locally generated waves rather than low frequency swells several studies showed that the whitecapping formulations that are based on the average spectral properties like janssen formulation used in this study best represent the total energy regarding the higher frequency part of a combined sea state which is corresponding to locally generated waves van der westhuysen et al 2007 mulligan et al 2008 allahdadi et al 2019b the spatial accuracy for the mean wave period fig 7 is generally consistent with that of wave height and shows the highest correlation coefficients and lowest bias in the gom model output using the final calibration parameters were compared to observation data from buoys fig 8 the model successfully simulated the peaks associated with hurricanes gustave and ike fig 8a as well as lower energy wave heights that shows the selected whitecapping coefficients based on the calibration process are efficient the correlation coefficient was high r 0 98 with rmse as low as 0 25 m fig 8b model performance in simulating directional spectra at ndbc stations 42 036 on the inner shelf of the northern gom where water depth is 49 m and 42 003 in the deep gom with a water depth of 3250 m shows good agreement with observation in both directional extension of the spectra and energy level which is consistent with previous studies ex allahdadi et al 2019a yang et al 2017 the differences between the peak directions of the modeled and observed spectra are most likely due to the discrepancy between the direction of the input wind cfsr and the observed wind that was reported before for the cfsr wind allahdadi et al 2019a b the consistency of the observed frequency spectra with simulation results has also been demonstrated for different cases of the wave energy level see section 5 3 5 discussion 5 1 interplay between computational timestep and number of iterations since swan uses an implicit numerical scheme the computational timestep is not limited by courant stability criterion i e the timestep is not coupled with the spatial step however as a very general criterion the timestep should appropriate to resolve temporal variations in both wind and wave fields swan 2015 our sensitivity analysis for the gprvi region showed degrading model accuracy with increasing computational timestep as mentioned in the sensitivity section this inaccuracy includes several hours of delays in reaching the peak of storm induced waves and significant underestimation of the peak wave height this was more pronounced for the coastal buoys although for deep water buoys was also significant numerical tests done by the coastal and hydraulic team at ncsu https ccht ccee ncsu edu swell propagation on fine meshes showed a similar problem when they switched from a coarse to a fine resolution computational mesh they argued that using a finer resolution mesh and keeping the timestep and iteration configuration of the coarse mesh run causes swell propagation to slow resulting in delay and underestimation in the peak of wave height to resolve this problem they increased the number of computational iterations to increase the model convergence in solving the transport equation swan s implicit scheme for discretizing the governing equation in the time domain includes sweeping over the computational mesh resulting in a large system of equations at each time step that is solved using the four direction gause sidel method with an iteration based approach zijlema 2009 2010 in the stationary or quasi stationary mode of swan since no timestep is used or large timestep in accordance to the forcing is used the system of equations needs a large number of iterations to converge conversely in the non stationary mode as used in the present modeling small timesteps are used usually 10 min based on the recommendation in swan technical manual and therefore model convergence in only one iteration is very likely swan 2015 this should however comply with other technical advice from the swan developers that the courant number should be 10 to maintain model accuracy if due to mesh refinement in the coastal area similar to the case of coastal and hydraulic team courant numbers are 10 the timestep should decrease and the number of iterations should increase to the level that enough model accuracy is obtained in this study the independent sensitivity tests resulted in a timestep of 1 min to get the most accurate wave height and period at all buoys the timestep of 1 min which is significantly smaller than the recommended timestep of 10 min can also be approximately determined based on the fact that the finest model resolution along the coast is 200 m considering the average water depth of 30 m for the coastal regions in the northern gom the maximum courant number 10 results in a required timestep between 1 and 2 min which is consistent with the sensitivity test results this small timestep however is associated with a very high computational cost a larger more affordable timestep could be used with a greater number of iterations than the default iteration of one that is advised by swan hence mpss and simulation time for different combinations of timestep and number of iterations were compared to select the optimum model parameters ex fig 9 although the simulation with 1 min timestep and three iterations resulted in the lowest rmse for both wave height and period it increases the simulation time by about 3 times compared to the simulations with timestep of 3 min choosing the simulation case with 3 min and 3 iterations decreases the simulation time from 120 h to 40 h while compromising the accuracy by only 2 5 for different model performance parameters therefore this combination was adopted as the optimum configuration for future model simulations 5 2 resolving the garden sprinkling effect gse in the model in the spectral wave models spectral space including frequency and the directional domain is discretized as well as the discretization in geographical and time space for an extensive modeling area over which swells propagate thousands of kilometers lack of enough spectral resolution especially directional resolution may cause swell disintegration that causes a discontinuous pattern of wave propagation this spurious disintegration of continuous swells is known as the garden sprinkling effect gse in wave simulation tolman 2002 two main solutions can be pursued to mitigate the gse in a spectral wave model one traditional solution is increasing the spectral resolution of the model especially the directional resolution to impose more continuity to the propagated swells tolman 2002 showed that this approach could successfully prevent the disintegration of swells propagated over a large modeling area one pitfall of this approach is that increasing the number of directional bins may significantly increase simulation time a potentially more cost effective approach that is also incorporated in swan is adding artificial diffusion terms to the governing equations to maintain swell continuity tolman 2002 rogers et al 2002 the modified wave action equation in the cartesian coordinates and without including source terms is 5 n t x c x n d x x n x y c y n d y y n y 2 d x y 2 n x y 0 where n is the wave action density the three terms with parameter d are the added diffusion terms parameter d defines the diffusion coefficient in different directions which is calculated based on the wave group velocity directional resolution and wave age the time that swells propagate over the modeling area it should be noted that this parameter is not directly dependent on the model spatial resolution regarding the relatively vast modeling region in the present study and the fact that gse is a large scale phenomenon it is likely that swells propagating within several hundred to thousands of kilometers cause the gse due to poor directional resolution therefore the initiation of gse is most likely in the offshore waters that can also affect the nearshore and coastal regions like the northern gulf of mexico west florida shelf and puerto rico virgin islands regions all these areas are parts of the main wave energy characterization regions to mitigate the gse in the model the added diffusion approach was activated by examining different values of wave age the first attempt was wave age of 9 h obtained by assuming traveling swell waves over a 1000 km distance and a large wave period of 15 20 s corresponding to the maximum period during hurricanes under this condition the model could not proceed due to instability in the first timesteps smaller values for the wave age were used to maintain the model stability even with wave ages as small as 2 h the model was still unstable fig 10 a c this instability was likely produced as a result of the very high resolution coastal mesh this result does not mean that the diffusion approach added in swan is not effective but that it may not be a warranted approach given the scale of the modeling area and the extensive 32 year hindcast simulation planned for such a high resolution mesh therefore to mitigate gse the number of directional bins was examined sensitivity analysis showed that in terms of simulated wave parameters at the buoys increasing the numbers of directional bins above 18 resulted in similar statistics we initially selected 24 directions to be consistent with the east coast simulations allahdadi et al 2019a b however considering the general wave propagation pattern over the study area the two dimensional maps of wave propagation showed that during the hurricane events and cold fronts and using 24 directional bins some relatively minor patterns of gse happen fig 10d this minor gse pattern was highly alleviated by increasing the number of spectral bins to 36 and 72 although the results from 36 to 72 directions are very similar fig 10e and f therefore to decrease the computational cost as much as possible 36 directional bins were selected for the final model setup the smooth simulated wave propagation pattern and direction vectors that were resulted by applying the final number of directional bins 36 have been examined at different times over the modeling area by considering the different atmospheric events examples for 12 h snapshots during the time that hurricane ike translated the gulf of mexico are presented in fig 11 5 3 effect of cut off frequency and high frequency prognostic tail the discretization of the spectrum in the frequency domain is one of the crucial steps in numerical wave simulation the appropriate selection of frequency parameters may have a significant effect on the accuracy and cost of wave simulation in the model setup three spectral parameters including minimum frequency the number of discrete frequencies and cutoff frequency maximum prognostic frequency are introduced the frequency spectrum generally includes a forward face one or two energy peaks and a rear face for a typical spectrum the forward face of the spectrum is very steep and it can be assumed that wave energy approaches zero if a small enough minimum frequency like 0 03 0 04 hz is adopted janssen 1991 conversely at the rear face of the spectrum wave energy decays slowly and the whole spectrum may extend toward much higher frequencies than the peak frequency by extending the frequency domain a larger number of discrete frequencies are needed which increases simulation cost while possibly not yielding a proportional increase in accuracy hence a prognostic cutoff frequency f h is used to specify the maximum frequency range used in the model discretization for frequencies beyond this prognostic value a diagnostic tail is usually added to save computational efforts this diagnostic tail is a function in the form of f n in which f is the frequency and n is a real number the spectral energy e f beyond f h is calculated as 6 e f e f h f f h n f o r f f h where e f h is the wave energy corresponding to the cutoff frequency as calculated by the model studies based on observations laboratory data and analytical approaches reported different values for n between 2 and 5 with n 4 and n 5 most common ex donelan et al 1985 kahma 1981 banner et al 1989 hwang et al 1997 this additional tail of the frequency spectrum is usually estimated so that it maintains the energy balance due to whitecapping and other source terms hence depending on the whitecapping and wind input formulation used n can vary in swan n 4 is recommended under the komen approach while under the janssen approach the approach used in the present modeling n 5 is advised cutoff frequency f h is especially important to calculate wave parameters like spectral width or directionality coefficient that are highly non linear functions of the spectral moments dykes 2002 akpinar et al 2012 as shown in the sensitivity section for most iec parameters using values for the cutoff frequency higher than 0 52 hz resulted in higher mpss this can be explained by examining the spectral energy resulting from extending the cutoff frequency and the corresponding energy from the diagnostic tail frequency spectra measured by ndbc buoys only include wave energy within the frequency band of 0 02 0 485 hz fig 12 a and b if the spectrum contains significant high frequency energy as in the coastal buoys this can cause inaccuracies in calculation of the iec parameters at the buoys which are calculated by integrating the measured spectra although the initial cutoff frequency of 0 52 hz is close to the maximum frequency resolved by the buoys using 1 0 hz resulted in greater accuracy examining simulated wave spectra and the corresponding diagnostic tail for different times during different simulation periods showed that in most cases when simulating using the cutoff frequency of 1 0 hz the diagnostic tail for the spectrum overestimated the energy beyond the cutoff frequency of 0 52 hz fig 12c and d this means that the lower the cutoff frequency is the higher would be the amount of energy added to the spectrum through the diagnostic tail when it is not even included in buoy data although this added amount of energy may be too small to cause substantial changes in wave height and period for iec parameters like spectral width and directionality coefficient that are highly non linear functions of the spectral moments the changes could be dramatic fig 3 6 summary and conclusion in this paper a high resolution computational mesh with triangular elements based on an unstructured swan was developed for the future wave energy characterization of the gulf of mexico puerto rico and the u s virgin islands the mesh spatial resolution was 200 m within 20 km of the coast and decreased to 1 3 km over the inner shelf and 5 20 km offshore a thorough sensitivity analysis of several model input parameters as well as a detailed calibration of the model for whitecapping formulations parameters were implemented both sensitivity analysis and calibration were supported by wave parameter observations from 18 ndbc wavcis and cdip buoys for establishing model performance statistics these parameters included computational time step number of iterations number of spectral frequencies number of spectral directions cut off frequency directional spreading of boundary waves and frequency spectral shape of boundary data a wide range of values was examined for sensitivity analysis of each parameter and the values corresponding to the best statistical match up with buoy measurements were used in simulations additional analyses were performed on the interplay of computational timestep and number of iterations to optimize the computational costs associated with very small computational timestep values also the number of directional bins was modified to mitigate the garden sprinkling effect the model parameters selected by the sensitivity analysis were used for a thorough calibration of the model for whitecapping dissipation parameters for calibration and sensitivity analysis multiple time periods were considered to accommodate all types of significant atmospheric phenomena that contribute to the wave climate of the study area four 1 month calibration periods that include hurricanes tropical storms cold fronts the caribbean low level jet and intermittent fair weather conditions were considered examining different whitecapping wind input formulations incorporated in swan komen janssen and westhuysen with default parameters showed that the janssen formulation results in the best match for wave height and parameter hence this formulation was selected for further tuning the whitecapping parameters that in this case were the whitecapping coefficient and parameter δ different combinations of these two parameters were used to run the model for all four calibration periods results showed that depending on the season two different values for c d s can result in the best match while the same parameter δ value is used all year examining the interplay between the computational timestep and the number of iterations and its relation with mesh resolution is one of the unique aspects of this study in most simulations using swan the default timestep of 10 min and one iteration are used while in cases using a fine resolution mesh this could compromise significant amounts of model accuracy by considering this interplay we were able to decrease the simulation cost threefold without compromising model accuracy therefore when using very fine resolution meshes sensitivity analysis of timestep and number of iterations the maximum courant number equals ten and the simulation cost should be used as the main criteria for selecting the timestep and the number of iterations precautions should be taken on selecting the cutoff frequency when the simulation involves calculating wave bulk parameters that are high order non linear functions of spectral moments like the iec parameters spectral width and directionality coefficient in this case using smaller cutoff frequencies close to the maximum frequency measured by buoys may result in larger discrepancies due to the overestimation of the spectral energy by the traditional diagnostic tail functions this calibrated model for the gprvi region is being used to generate a 32 year hindcast from which iec parameters and other wave statistics will be estimated for a comprehensive characterization and assessment of wave energy resources in this region the results will be reported in future correspondence the thorough sensitivity analysis and calibration conducted for this study region is unprecedented to the authors knowledge and can be used as a useful reference and benchmark for future wave modeling with engineering or operational purposes credit authorship contribution statement mohammad nabi allahdadi conceptualization methodology data curation writing original draft formal analysis investigation validation ruoying he conceptualization methodology formal analysis investigation supervision funding acquisition project administration writing review editing seongho ahn conceptualization methodology writing review editing chris chartrand data curation writing original draft formal analysis investigation validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements sandia national laboratories is a multi mission laboratory managed and operated by national technology and engineering solutions of sandia llc a wholly owned subsidiary of honeywell international inc for the us department of energy s national nuclear security administration under contract de na0003525 this paper describes objective technical results and analysis any subjective views or opinions that might be expressed in the paper do not necessarily represent the views of the us department of energy or the united states government the authors appreciate dr chunyan li and the wavcis lab from louisiana state university for providing wave data at stations in the northern gulf of mexico we thank jennifer warrillow for editorial assistance with the manuscript appendix a tables table a 1 list of buoys used for model calibration verification table a 1 buoy id lon lat water depth m general data time span type location 431 64 7193 17 7674 255 2008 2009 cdip christiansted st croix vi 41043 64 856 21 132 5271 2007 2009 ndbc ne puerto rico 170 nm nne of san juan pr 42001 89 668 25 897 3207 1980 2009 ndbc mid gulf 180 nm south of southwest pass la 42002 93 758 26 091 3125 1 1980 2009 ndbc west gulf 207 nm east of brownsville tx 42003 85 638 25 93 3250 1979 2009 ndbc east gulf 208 nm west of naples fl 42019 95 35 27 906 82 2 1990 2009 ndbc 60 nm south of freeport tx 42020 96 693 26 968 84 1 1990 2009 ndbc 60nm sse of corpus christi tx 42035 94 413 29 232 16 2 1993 2009 ndbc 22 nm east of galveston tx 42036 84 516 28 501 49 7 1994 2009 ndbc west tampa 112 nm wnw of tampa fl 42039 86 008 28 788 270 1996 2009 ndbc pensacola 42040 88 226 29 208 183 1996 2009 ndbc 63 nm south of dauphin 42056 84 938 19 918 4554 2005 2009 ndbc yucatan basin 120 nm ese of cozumel mx 42057 81 422 16 908 377 2005 2009 ndbc western caribbean 195 nm wsw of negril jamaica 42058 74 575 14 888 4158 2005 2009 ndbc central caribbean 210 nm sse of kingston jamaica 42059 67 51 15 252 4784 2007 2009 ndbc eastern caribbean sea 180 nm ssw of ponce pr 42060 63 35 16 387 1507 2009 ndbc caribbean valley 63 nm wsw of montserrat csi06 90 483 28 867 20 2008 2009 wavcis louisiana inner shelf csi09 89 978 29 101 18 2008 2009 wavcis louisiana inner shelf appendix b formulae for calculation of iec parameters based on spectral data based on iec 2015 standards the following six parameters derived from the frequency directional wave spectra are required for evaluation of the wave energy resources and design of wec facilities significant wave height h s 4 m 0 energy period t e m 1 m 0 omni directional wave power j ρ g i j c g i s i j δ f i δ θ j spectral width ε 0 m 0 m 2 m 1 2 1 direction of maximum wave power θ j m a x directionality coefficient of maximum wave power d j θ j m a x j where m n is the nth order spectral moment ρ is water density g is the acceleration due to gravity c g is the wave group velocity s i j is spectral energy corresponding to a spectral component with ith frequency and jth direction and δ θ j are spectral resolutions 
20462,a high resolution unstructured simulating waves nearshore swan model with a resolution of 200 m within 20 km of the coast was developed to provide a reliable setting for a long term wave energy characterization of the gulf of mexico puerto rico and the u s virgin islands a thorough model parameter sensitivity analysis as well as a calibration process for selecting the whitecapping dissipation formulation were conducted sensitivity analyses for the simulation timestep and number of iterations highlighted the less studied interplay between these parameters in swan which can substantially affect simulation accuracy and cost and is vital for the next step long term simulation of the wave energy resources for the present study a 3 min timestep and three iterations are optimum the garden sprinkling effect and the cut off frequency were also investigated using 36 directional bins and a larger cut off frequency 1 0 hz enable the best agreement between the model simulation and the in situ wave observations this subsequently leads to improved model skill and performance in resolving the observed international electrotechnical commission iec wave energy resource parameters that are highly non linear functions of wave spectral moments keywords wave energy swan gulf of mexico puerto rico virgin islands 1 introduction characterization and assessment of wave energy resources in u s coastal and offshore waters has been an important ongoing community effort for several years ahn et al 2020 2021 dallman and neary 2014 neary et al 2020 wu et al 2020 yang et al 2017 2020 due to the scarcity of historical data sparse coverage the limited number of in situ observations and the lack of high fidelity wave measurements e g spectral data long term wave hindcasts generated by carefully calibrated verified and validated numerical models are recommended for conducting such studies iec 2015 high resolution swan models with spatial resolutions of 200 m nearshore have been developed verified and validated for waters along the east coast allahdadi et al 2019a b the west coast wu et al 2020 yang et al 2017 alaska garcía medina et al 2021 and hawaii the high resolution swan wave model developed for the east coast was thoroughly calibrated for whitecapping after a detailed sensitivity analysis of numerical parameters allahdadi et al 2019a wave observations from 18 national data buoy center ndbc buoys were used for model calibration and verification based on the six iec standard parameters the present paper details efforts to prepare a similar calibrated and verified wave model that in the future will be used for the hindcast of wave energy resources in the gulf of mexico gom puerto rico pr and the u s virgin islands usvi the gom pr usvi gprvi region several studies address various aspects of the wave climate and modeling methodology for the gprvi region ex anselmi molina et al 2012 appendini et al 2012 2014 chaichitehrani et al 2019 moghimi et al 2020 siadatmousavi et al 2011 2012a b silander and garcía 2019 sorourian et al 2020 based on the hindcast outputs from a 30 year simulation using mike 21 model appendini et al 2014 studied the wave climate trend of the gom their modeling results showed that cold fronts are the main modulating force for mean wave climate in the gom while both hurricanes and cold fronts contribute to extreme wave heights for the pr and usvi region wave climate is mainly affected by atlantic swells wind generated waves under the caribbean low level jet cllj or both depending on the location and season appendini et al 2014 anselmi molina et al 2012 silander and garcía 2019 one key aspect of a successful wave model in the oceanic and shelf waters is selecting the most appropriate whitecapping formulations and their associated parameters using a proper calibration process allahdadi et al 2017a rusu 2011 whitecapping formulations for the gprvi region have been examined in several studies appendini et al 2012 anselmi molina et al 2012 siadatmousavi et al 2011 a detailed analysis of whitecapping parameterization in the gom based on wam cycle 3 and wam cycle 4 whitecapping formula almost equivalent to the komen and janssen formulation in the recent swan versions was presented by siadatmousavi et al 2011 they examined different parameters in the formulations and concluded that during the cold front and fair weather conditions wam cycle 4 generally performs better in the gom especially in wave period simulation similar results on successful simulations using the wam cycle 4 formulation were reported for the gom by appendini et al 2014 for pr and usvi regions several modeling studies reported the successful application of wam cycle 3 while wam cycle 4 was not included in the verification process anselmi molina et al 2012 silander and garcía 2019 moreover a high accuracy modeling of wave characteristics and thereby wave energy needs a thorough investigation of some numerical model parameters and determining the optimum values for simulation for the u s east coast allahdadi et al 2019a performed a detailed sensitivity analysis on different numerical input values they concluded that for the unstructured swan results could be significantly sensitive to the simulation timestep and number of computational iterations for the specific case of wave modeling with the goal of wave energy characterization following the iec standards additional parameters should be calculated as well as the regular bulk and spectral parameters these parameters could substantially be affected by spectral discretization parameters including the number of spectral frequencies the number of directional bins and maximum resolved frequency cutoff frequency before applying the diagnostic tail function dykes et al 2002 siadatmousavi et al 2012a b siadatmousavi et al 2012a b reported that wave simulation results for bulk parameters including wave height peak period and mean wave period can be sensitive to the cutoff frequency and the power of the diagnostic spectral tail depending on the wind input and whitecapping formulation used this sensitivity could be more pronounced for non linear parameters like spectral width which is one of the main wave energy resource parameters in numerical models another example of the importance of spectral discretization parameters on wave simulation accuracy is the adverse effect of low directional resolution on the propagation pattern of swells over the extensive regions like oceanic basins of thousands of kilometers in dimensions tolman 2002 rogers et al 2002 this effect causes a discontinuity in wave crests as they propagate over the basins and can substantially degrade the simulation accuracy while important for an extensive modeling area like gprvi region the previous studies have not appropriately addressed this issue we describe herein the preparation and evaluation of a high resolution wave model for the gprvi region with the final implication for the wave energy resource characterization it includes the steps for setup sensitivity analysis and calibration of a high resolution wave model for the gprvi region following the methodology that was successfully utilized for the u s east coast the present study makes several unique contributions 1 the computational mesh for both inner shelf and coastal regions is very high resolution which is unprecedented for these regions considering the total length of the refined coastal areas included in the computational mesh 2 thorough sensitivity analyses of model parameters are conducted to optimize model accuracy and computational costs 3 sensitivity analysis of a new parameter the cut off frequency is conducted to accommodate the non linear behavior of some iec parameters in the spectral space to the authors knowledge cut off frequency has not been examined in any of the previous wave energy resource characterization studies 4 the garden sprinkler effect gse is included along with the sensitivity analysis of the number of spectral directions to optimize model spectral directions 5 the interplay between computational timestep and the number of iterations that can optimize the model setup is examined both parameters can significantly contribute to decreasing the computational costs 6 the present study is the first detailed calibration of swan s whitecapping formulations for the study region specifically this research introduces two sets of calibration parameters for whitecapping corresponding to the hurricane and non hurricane seasons which has not been included in previous studies 7 the verification of the gprvi wave model for the six iec parameters highlights areas where the scientific engineering community can focus on the development of the next generation wave models for this study region and elsewhere 2 model setup and data the third generation phase averaged swan v 41 10 on an unstructured mesh was used for wave modeling of the study region the model uses adcirc s platform to accommodate the parallel processing option of the unstructured version without coupling with the hydrodynamics module of adcirc in solving the wave action conservation equation swan considers the main physical processes in the generation and propagation of waves in both deep and shallow waters in the present simulations source terms including wind input whitecapping dissipation non linear wave interaction bottom friction shallow water wave breaking and riad were considered more details about the governing equations and source terms quantification can be found in swan 2015 and allahdadi et al 2019b the simulation domain consists of the gom north atlantic ocean caribbean sea cs pr and usvi fig 1 the model open boundary was set at 52 8 w longitude to provide enough distance for wind generated waves and boundary condition swells to propagate toward the pr and usvi region an array of 18 buoys including 15 from national data buoy center ndbc two wavcis buoys managed by louisiana state university s coastal studies institute stone et al 2009 2010 2010 and one buoy from the coastal data information program mcwhorter et al 2016 was used for calibration and verification of the model see fig 1 for locations table a1 summarizes the list of buoys with their depth geographical coordinates and data availability information an unstructured mesh based on triangular elements was used for wave simulations the main feature of this mesh is the high 200 m resolution within 20 km of the coastline for the entire study area fig 1b mesh resolution for the inner shelf regions is 1 3 km decreases to 5 8 km in the outer shelf in the gom and in the entire caribbean sea and reaches to about 20 km along the open boundary in the north atlantic fig 1b and c such a high resolution mesh results in a huge number of computational grid points more than 5 7 millions that makes the use of parallel processing for simulation inevitable hence simulations for both sensitivity tests and calibration were run on the high performance computing resources of sandia national laboratories simulations were run on sandia s chama cluster which consists of almost 1232 nodes each with a 16 core 2 6 ghz intel processor and 64 gb of ram the simulation of a single month takes approximately 30 h of wall time on 640 of these cores 40 nodes the coastal relief model with spatial resolution of 3 arc seconds 80 90 m and etopo1 global relief model with a resolution of 1 arc minute 1600 1800 m provided water depth data for coastal inner shelf and offshore areas respectively these data were interpolated on the unstructured mesh to prepare the bathymetry of the model fig 1a inset following a similar approach as the east coast characterization study allahdadi et al 2019a b the model was forced by the climate forecast system reanalysis cfsr wind fields with a spatial resolution of 0 32 over the modeling area and a temporal resolution of 1 h this was found to be an appropriate wind field for the long term simulation of waves for both east and west coasts allahdadi et al 2019a b yang et al 2017 wu et al 2020 along the open boundary parametric wave characteristics from the wwiii global model chawla et al 2013 with a spatial resolution of 0 5 were prescribed the model numerical parameters and wind input whitecapping formulation were determined from thorough sensitivity analyses and calibration processes as described in sections 3 and 4 3 model sensitivity analysis swan and other state of the art phase averaged spectral models used for simulation of wave generation and propagation solve the governing equations by discretizing the equations in geographical space time and spectral space direction and frequency although model documentation and research studies suggest some default values for the time step and spectral resolution properties of models and the associated numerical metrics for maintaining numerical convergence they can be highly site specific and significantly change based on the bathymetry coastal geography and met ocean climate of the study regions allahdadi et al 2019a cavaleri and bertotti 1994 furthermore information about the frequency and directional distribution of waves along the open boundary is user defined and could be site specific a practical and effective way to select these parameters is by implementing sensitivity analyses on a reasonable range of values for each parameter then selecting appropriate values based on model accuracy and cost in the present study a thorough sensitivity analysis was performed on several model inputs seven parameters including simulation timestep number of iterations number of spectral frequencies number of spectral directions directional bins cutoff frequency directional spreading of boundary waves and frequency spectral shape of boundary waves were evaluated the appropriate range and values for sensitivity analyses of these parameters were based on recommendations in the swan documentation swan 2015 and previous studies of this region e g siadatmousavi et al 2011 2012a b allahdadi et al 2019a appendini et al 2012 it should be noted that the coastal resolution of 200 m used in the present modeling is based on the requirements to follow the iec standards for doing a feasibility to design level resource assessment iec 2015 therefore no sensitivity test on mesh resolution was considered compared to other short term and long term wave simulations in the study area this 200 m resolution is much finer the computational mesh used in the present study has also a higher resolution in offshore areas than almost all the previous successful wave models in the region the mesh was designed to create a smooth transition from coastal areas toward the inner and outer shelves and eventually offshore waters while limiting the resolution to a maximum of 5 km in the offshore regions in the gulf of mexico puerto rico virgin island and the caribbean sea to implement the sensitivity analysis simulations two 1 month time periods cal2 and cal3 that included major meteorological phenomena tropical storms winter cold fronts cllj and fair weather conditions of the study area were considered these two time periods are a part of four time slots cal1 cal2 cal3 and cal4 that are used for model calibration in section 4 sensitivity period cal2 mid august to mid september 2008 includes major hurricanes gustav and ike as well as fair weather conditions sensitivity period cal3 january 2008 includes two cold fronts and episodes of fair weather the final setup from the east coast high resolution simulation table 3 allahdadi et al 2019a was used as the basic model setup except that the computational timestep was 5 min herein the basic model setup sensitivity used 1 iteration 0 04 hz minimum frequency 0 52 hz maximum frequency 28 frequencies 24 directions and the janssen whitecapping formulation with cds 2 7 and delta 0 9 see section 4 for more details about these parameters model outputs for significant wave height and mean wave period t 02 at the location of each buoy were compared with buoy measurements fig 2 a d also the average values of model performance statistics mps including correlation coefficient r root mean square error rmse scatter index si and bias tehrani et al 2013 yang et al 2017 were calculated for each sensitivity run fig 2e h the values yielding the best mpss in both cal2 and cal3 were selected for each sensitivity parameter though values that increased computational cost without adding much to accuracy were not used table 1 although the sensitivity runs for different model parameters were conducted as if the parameters were independent changing any parameter may affect the optimum values for other parameters one important case where this dependency can substantially affect model accuracy and simulation cost is the interplay between simulation timestep and number of computational iterations the sensitivity analysis showed that for timesteps larger than 3 min significant delays and underestimations in wave height peaks were produced during the peak of storms especially during hurricanes fig 2a this inaccuracy corresponding to timesteps larger than 3 min is due to rapidly changing wave characteristics as a result of intense hurricane winds and the substantial spatial variations of wind speed and direction that cannot be resolved using larger computational timesteps for the default timestep of 5 min fixed for the sensitivity tests the smallest number of iterations that resulted in an appropriate comparative accuracy was 3 fig 2b and f which is larger than the default value of 1 specified by swan technical documents swan 2015 again this could be attributed to the abrupt changes in the hurricane wind and wave field requiring more iterations for the model transport equations to converge see section 5 1 for more details when considering timestep independently timesteps as small as 1 min may eventually be needed to maintain sufficient model accuracy however by considering the interplay between timestep and number of iterations a computational timestep of 3 min could be used instead of 1 min table 1 and fig 2 this will be elaborated more in the discussion examining different numbers of spectral frequencies nf showed that the results are not very sensitive to the number of frequencies fig 2c and g this means that the minimum number of frequencies nf 16 selected for the sensitivity test is almost enough to resolve the energy variations in the frequency space over the study region this can be attributed to the dominant wide single peaked shape of frequency spectra in the study region in the absence of major swell systems appendini et al 2012 however nf 28 showed relatively higher accuracy compared to smaller values and therefore it was selected for the final simulation sensitivity tests averaged over all buoys showed that for the number of spectral directions no significant increase in accuracy occurred when nd 18 fig 2h this could be due to the dominant effect of wind induced waves over the modeling area especially the gom which is associated with wider directional spectra to resolve such wide spectra using numerical models lower directional resolutions can be used holthuijsen and tolman 1991 even in the caribbean sea and pr usvi region the wave climate is substantially affected by the cllj appendini et al 2012 and the atlantic swells are significantly blocked by the chain of islands in the southeast caribbean sea the only exception is the northern and western coasts of pr which are directly affected by the north atlantic swells silander and garcía 2019 but the comparison between model results from different numbers of directional bins at ndbc station 41 043 located in the north of pr did not show a significant difference between fewer or more directional bins the examined values for the number of spectral directions 18 72 that are enough to resolve wind induced directional spectra correspond to the directional resolutions of 20 5 therefore results from all the examined directional resolutions are statistically similar based on the sensitivity test the number of directional bins was set at 24 consistent with previous studies however when wave propagation over the entire modeling region is simulated the garden sprinkling effect gse tolman 2002 must be considered propagation of swell waves over a large domain can cause the gse which is a numerical problem tied to using a limited number of directional bins to discretize the model in the directional space to mitigate this effect 36 directions were used instead of the 24 directions suggested by the sensitivity analysis see section 5 2 for details the rest of the sensitivity parameters were selected from the sensitivity run results as the study areas are generally dominated by wind sea exhibiting energy within high frequency band and regarding the fact that this study aims to characterize wave energy resources based on iec standards the sensitivity analysis for the maximum frequency was implemented the six iec parameters include significant wave height energy period omni directional wave power density spectral width direction of maximum power hereafter θmax and directionality coefficient some of these are non linear functions of spectral moments that make the role of cut off frequency more prominent in modeling accuracy see appendix b for detailed formulations sensitivity analysis on the maximum frequency cut off frequency was performed using three values 0 52 hz 1 0 hz and 1 5 hz the results from both cal2 and cal3 simulations showed that the effect of increasing cut off frequency from 0 52 hz to 1 0 and 1 5 hz on wave height energy period and omni directional wave energy is small at most buoys the simulation accuracy of spectral width directionally coefficient and θmax can be significantly improved especially at the shallow water buoys by increasing the maximum frequency this is because these three parameters are strong non linear functions of wave spectral moments the additional high frequency components by including higher values of cut off frequency can make a significant difference in calculating these spectral moments the relationships between the spectral moments and the other three iec parameters wave height energy period and omni directional wave energy are less non linear and thereby these three parameters are less sensitive to the cut off frequency the statistical comparison of these six iec parameters with those calculated from observations for three values of cut off frequency is presented in fig 3 for the coastal ndbc buoy 42 035 located in the northwest of the gom the comparison is for the cal3 period that likely included more high frequency energy components in the wave spectra regarding the dominant atmospheric events during this period the results from cut off frequencies of 1 0 and 1 5 hz are very similar although 1 0 hz results in slightly better accuracies therefore for the final simulations cut off frequency of 1 0 hz was used 4 model calibration and results in this section the calibration of the model for whitecapping parameters is described the model setup configuration from the sensitivity section was used for the calibration process quantifying the source terms in the wave action equation in swan and other state of the art phase averaged models is a critical part of the model among the source terms representing dissipation due to whitecapping is the most challenging one due to its complex mechanism and many uncertainties associated with its physics massel 1996 cavaleri et al 2007 formulating whitecapping dissipation based on the mean spectral properties including wave steepness and wavenumber has been the most popular approach based on the pulse based model of hasselmann 1974 two frequently used versions of this methodology are wam cycle 3 and cycle 4 in swan similar formulations are available as komen et al 1984 and janssen 1991 the whitecapping relationship in these two formulations is the same and the difference is in their wind input counterpart and scaling the whitecapping coefficients the rate of energy dissipation due to whitecapping s d s w σ θ in these formulations is represented as 1 s d s w σ θ c d s 1 δ δ k k s s p m p σ k k e σ θ 2 s k e t o t where c d s is the whitecapping coefficient and δ is a parameter that varies between 0 and 1 with the default of 1 in swan this parameter is used for partially adjusting wave period and may also affect the wave height one may need to change δ to accommodate different values of c d s rogers et al 2003 reported that by changing δ from 0 to 1 the accuracy for the prediction of wave energy corresponding to low frequencies increases power p is a constant k is wave number with average k σ is the angular wave frequency with average σ e t o t is the total energy of the wave spectrum s is the mean spectral steepness s p m 3 02 10 3 1 2 is the mean spectral steepness due to the pierson moskowitz spectrum and e σ θ is the spectral energy for a component with an angular frequency of σ and direction of θ average angular frequency and average wave number are calculated by integrating over the frequency directional spectrum as follows 3 σ e t o t σ 1 e σ θ d σ d θ 4 k e t o t k 1 2 e σ θ d σ d θ 2 the strong dependency of the whitecapping formulation on the mean spectral parameters is maintained through k σ and s depending on the formulation used for the wind input term two sets of values for c d s and p were found by komen at al 1984 and janssen 1991 by balancing the energy equation through fetch growth tests komen et al 1984 used a linear term for quantifying the exponential part of wind input while janssen 1991 calculated with a quadratic variation of wind input according to these estimations a value of 4 was recommended for p in swan another class of whitecapping dissipation formulation is the quantification based on the saturated based concept of the wave spectrum that potentially can distinguish between the dissipation of high frequency wind generated energy components and low frequency swells van der westhuysen et al 2007 all three formulations are options in swan komen s and janssen s formulations are two of the most frequently used approaches used in wave modeling siadatmousavi et al 2011 swan 2015 allahdadi et al 2017a the westhuysen approach was incorporated in swan to resolve the spurious behavior of these two approaches when sea state is dominated by low frequency swells however allahdadi et al 2019b showed that for the u s east coast in the absence of low frequency swells the westhuysen approach significantly underestimates both wave height and period presumably due to substantial spatial and temporal variations in the wind field that makes a fetch limited sea state less likely comparing the three whitecapping formulations of swan through a calibration process they concluded that the janssen formulation with c d s 2 7 and δ 0 9 results in the best match with observed wave height and period allahdadi et al 2019a a similar approach with more details and more comprehensive statistical results was followed to determine the most appropriate formulation and the associated coefficients for the wave climate of the gprvi model four 1 month calibration periods were selected to accommodate the most important atmospheric features of the study region the simulation periods are cal1 25 august 25 september 2005 cal2 20 august 20 september 2008 cal3 1 31 january 2008 and cal4 1 31 march 2009 tropical storms and hurricanes significantly affect wave climate in the gprvi region the official hurricane season in the northern atlantic including gom is 1 june 30 november each year landsea 1993 however an investigation on the monthly distribution of the storms from 1851 to 2017 showed that more than 80 of the tropical storms hurricanes in the region occurred in august through october landsea 2018 cal1 and cal2 include hurricane wave fields from major hurricanes katrina rita gustav and ike fig 4 in the gom cold fronts are the most prominent non hurricane atmospheric phenomena that substantially impact both extreme and average wave climate as well as other hydrodynamic parameters siadatmousavi et al 2012a b chaichitehrani et al 2019 allahdadi et al 2017b appendini et al 2012 cold fronts are northern fronts that outbreak in the gom especially in the northern gulf from october to may each year moeller et al 1993 each episode of cold front outbreak may take 12 24 h with 3 7 d intervals between consecutive cold fronts cal3 and cal4 specifically examine the effect of cold fronts in the calibration tests fig 4 in the caribbean region the caribbean low level jet cllj is a prominent atmospheric feature that substantially affects the mean wave climate of the region appendini et al 2012 the cllj with a general easterly direction is present through the year over the region with two maxima in february and july this atmospheric feature is included in cal3 and cal4 the impact of cllj on the pr usvi regions can be seen in cal3 fig 4 the rest of the atmospheric features of the study region are summer fair weather conditions in both gom and the north atlantic and winter storms in the north atlantic the setup obtained from the sensitivity section table 1 was used for calibration runs the first stage was determining the most appropriate whitecapping formulation in swan by comparing model results for simulations using the default configurations the average mpss at all buoys showed that for the default whitecapping parameters the janssen formulation results in the best match for both wave height and period fig 5 upper panels the calibration process was completed by narrowing the janssen formulation s parameters including the whitecapping coefficient c d s and parameter δ to determine the best parameter tune values from 2 to 4 5 for c d s and 0 5 1 for δ were examined see table 2 for 15 representative sets of calibration values that resulted higher accuracy among all values within the full range of examined values simulation id 0 is the base case corresponding to the calibration parameters in the east coast simulation c d s 2 7 and δ 0 9 for the calibration periods that include hurricanes cal1 and cal2 the combination of c d s 3 7 and δ 0 9 calibration case 3 resulted in the best match up while the best results for the non hurricane months cal3 and cal4 were for c d s 2 5 and δ 0 9 which is corresponding to calibration case 4 fig 5 mid and lower panels hence for the long term simulation two different sets of whitecapping parameters were advised depending on the season the hurricane season parameters are applied only for august through october for the rest of the year the non hurricane calibration coefficients are applied the accuracy of the calibrated model at individual buoys was also investigated to determine the spatial distribution of model accuracy for wave height and period fig 6 and 7 the highest correlation coefficients 0 95 for wave height were found at the buoys in the gom especially in the coastal areas fig 6 while the lowest values of bias were also obtained for the gom the buoy at virgin island cdip 431 showed the smallest values for the rmse and one of the lowest for si the higher accuracy for the simulation of wave height in the gom could be due to the fact that wave climate in the gom is mostly affected by locally generated waves rather than low frequency swells several studies showed that the whitecapping formulations that are based on the average spectral properties like janssen formulation used in this study best represent the total energy regarding the higher frequency part of a combined sea state which is corresponding to locally generated waves van der westhuysen et al 2007 mulligan et al 2008 allahdadi et al 2019b the spatial accuracy for the mean wave period fig 7 is generally consistent with that of wave height and shows the highest correlation coefficients and lowest bias in the gom model output using the final calibration parameters were compared to observation data from buoys fig 8 the model successfully simulated the peaks associated with hurricanes gustave and ike fig 8a as well as lower energy wave heights that shows the selected whitecapping coefficients based on the calibration process are efficient the correlation coefficient was high r 0 98 with rmse as low as 0 25 m fig 8b model performance in simulating directional spectra at ndbc stations 42 036 on the inner shelf of the northern gom where water depth is 49 m and 42 003 in the deep gom with a water depth of 3250 m shows good agreement with observation in both directional extension of the spectra and energy level which is consistent with previous studies ex allahdadi et al 2019a yang et al 2017 the differences between the peak directions of the modeled and observed spectra are most likely due to the discrepancy between the direction of the input wind cfsr and the observed wind that was reported before for the cfsr wind allahdadi et al 2019a b the consistency of the observed frequency spectra with simulation results has also been demonstrated for different cases of the wave energy level see section 5 3 5 discussion 5 1 interplay between computational timestep and number of iterations since swan uses an implicit numerical scheme the computational timestep is not limited by courant stability criterion i e the timestep is not coupled with the spatial step however as a very general criterion the timestep should appropriate to resolve temporal variations in both wind and wave fields swan 2015 our sensitivity analysis for the gprvi region showed degrading model accuracy with increasing computational timestep as mentioned in the sensitivity section this inaccuracy includes several hours of delays in reaching the peak of storm induced waves and significant underestimation of the peak wave height this was more pronounced for the coastal buoys although for deep water buoys was also significant numerical tests done by the coastal and hydraulic team at ncsu https ccht ccee ncsu edu swell propagation on fine meshes showed a similar problem when they switched from a coarse to a fine resolution computational mesh they argued that using a finer resolution mesh and keeping the timestep and iteration configuration of the coarse mesh run causes swell propagation to slow resulting in delay and underestimation in the peak of wave height to resolve this problem they increased the number of computational iterations to increase the model convergence in solving the transport equation swan s implicit scheme for discretizing the governing equation in the time domain includes sweeping over the computational mesh resulting in a large system of equations at each time step that is solved using the four direction gause sidel method with an iteration based approach zijlema 2009 2010 in the stationary or quasi stationary mode of swan since no timestep is used or large timestep in accordance to the forcing is used the system of equations needs a large number of iterations to converge conversely in the non stationary mode as used in the present modeling small timesteps are used usually 10 min based on the recommendation in swan technical manual and therefore model convergence in only one iteration is very likely swan 2015 this should however comply with other technical advice from the swan developers that the courant number should be 10 to maintain model accuracy if due to mesh refinement in the coastal area similar to the case of coastal and hydraulic team courant numbers are 10 the timestep should decrease and the number of iterations should increase to the level that enough model accuracy is obtained in this study the independent sensitivity tests resulted in a timestep of 1 min to get the most accurate wave height and period at all buoys the timestep of 1 min which is significantly smaller than the recommended timestep of 10 min can also be approximately determined based on the fact that the finest model resolution along the coast is 200 m considering the average water depth of 30 m for the coastal regions in the northern gom the maximum courant number 10 results in a required timestep between 1 and 2 min which is consistent with the sensitivity test results this small timestep however is associated with a very high computational cost a larger more affordable timestep could be used with a greater number of iterations than the default iteration of one that is advised by swan hence mpss and simulation time for different combinations of timestep and number of iterations were compared to select the optimum model parameters ex fig 9 although the simulation with 1 min timestep and three iterations resulted in the lowest rmse for both wave height and period it increases the simulation time by about 3 times compared to the simulations with timestep of 3 min choosing the simulation case with 3 min and 3 iterations decreases the simulation time from 120 h to 40 h while compromising the accuracy by only 2 5 for different model performance parameters therefore this combination was adopted as the optimum configuration for future model simulations 5 2 resolving the garden sprinkling effect gse in the model in the spectral wave models spectral space including frequency and the directional domain is discretized as well as the discretization in geographical and time space for an extensive modeling area over which swells propagate thousands of kilometers lack of enough spectral resolution especially directional resolution may cause swell disintegration that causes a discontinuous pattern of wave propagation this spurious disintegration of continuous swells is known as the garden sprinkling effect gse in wave simulation tolman 2002 two main solutions can be pursued to mitigate the gse in a spectral wave model one traditional solution is increasing the spectral resolution of the model especially the directional resolution to impose more continuity to the propagated swells tolman 2002 showed that this approach could successfully prevent the disintegration of swells propagated over a large modeling area one pitfall of this approach is that increasing the number of directional bins may significantly increase simulation time a potentially more cost effective approach that is also incorporated in swan is adding artificial diffusion terms to the governing equations to maintain swell continuity tolman 2002 rogers et al 2002 the modified wave action equation in the cartesian coordinates and without including source terms is 5 n t x c x n d x x n x y c y n d y y n y 2 d x y 2 n x y 0 where n is the wave action density the three terms with parameter d are the added diffusion terms parameter d defines the diffusion coefficient in different directions which is calculated based on the wave group velocity directional resolution and wave age the time that swells propagate over the modeling area it should be noted that this parameter is not directly dependent on the model spatial resolution regarding the relatively vast modeling region in the present study and the fact that gse is a large scale phenomenon it is likely that swells propagating within several hundred to thousands of kilometers cause the gse due to poor directional resolution therefore the initiation of gse is most likely in the offshore waters that can also affect the nearshore and coastal regions like the northern gulf of mexico west florida shelf and puerto rico virgin islands regions all these areas are parts of the main wave energy characterization regions to mitigate the gse in the model the added diffusion approach was activated by examining different values of wave age the first attempt was wave age of 9 h obtained by assuming traveling swell waves over a 1000 km distance and a large wave period of 15 20 s corresponding to the maximum period during hurricanes under this condition the model could not proceed due to instability in the first timesteps smaller values for the wave age were used to maintain the model stability even with wave ages as small as 2 h the model was still unstable fig 10 a c this instability was likely produced as a result of the very high resolution coastal mesh this result does not mean that the diffusion approach added in swan is not effective but that it may not be a warranted approach given the scale of the modeling area and the extensive 32 year hindcast simulation planned for such a high resolution mesh therefore to mitigate gse the number of directional bins was examined sensitivity analysis showed that in terms of simulated wave parameters at the buoys increasing the numbers of directional bins above 18 resulted in similar statistics we initially selected 24 directions to be consistent with the east coast simulations allahdadi et al 2019a b however considering the general wave propagation pattern over the study area the two dimensional maps of wave propagation showed that during the hurricane events and cold fronts and using 24 directional bins some relatively minor patterns of gse happen fig 10d this minor gse pattern was highly alleviated by increasing the number of spectral bins to 36 and 72 although the results from 36 to 72 directions are very similar fig 10e and f therefore to decrease the computational cost as much as possible 36 directional bins were selected for the final model setup the smooth simulated wave propagation pattern and direction vectors that were resulted by applying the final number of directional bins 36 have been examined at different times over the modeling area by considering the different atmospheric events examples for 12 h snapshots during the time that hurricane ike translated the gulf of mexico are presented in fig 11 5 3 effect of cut off frequency and high frequency prognostic tail the discretization of the spectrum in the frequency domain is one of the crucial steps in numerical wave simulation the appropriate selection of frequency parameters may have a significant effect on the accuracy and cost of wave simulation in the model setup three spectral parameters including minimum frequency the number of discrete frequencies and cutoff frequency maximum prognostic frequency are introduced the frequency spectrum generally includes a forward face one or two energy peaks and a rear face for a typical spectrum the forward face of the spectrum is very steep and it can be assumed that wave energy approaches zero if a small enough minimum frequency like 0 03 0 04 hz is adopted janssen 1991 conversely at the rear face of the spectrum wave energy decays slowly and the whole spectrum may extend toward much higher frequencies than the peak frequency by extending the frequency domain a larger number of discrete frequencies are needed which increases simulation cost while possibly not yielding a proportional increase in accuracy hence a prognostic cutoff frequency f h is used to specify the maximum frequency range used in the model discretization for frequencies beyond this prognostic value a diagnostic tail is usually added to save computational efforts this diagnostic tail is a function in the form of f n in which f is the frequency and n is a real number the spectral energy e f beyond f h is calculated as 6 e f e f h f f h n f o r f f h where e f h is the wave energy corresponding to the cutoff frequency as calculated by the model studies based on observations laboratory data and analytical approaches reported different values for n between 2 and 5 with n 4 and n 5 most common ex donelan et al 1985 kahma 1981 banner et al 1989 hwang et al 1997 this additional tail of the frequency spectrum is usually estimated so that it maintains the energy balance due to whitecapping and other source terms hence depending on the whitecapping and wind input formulation used n can vary in swan n 4 is recommended under the komen approach while under the janssen approach the approach used in the present modeling n 5 is advised cutoff frequency f h is especially important to calculate wave parameters like spectral width or directionality coefficient that are highly non linear functions of the spectral moments dykes 2002 akpinar et al 2012 as shown in the sensitivity section for most iec parameters using values for the cutoff frequency higher than 0 52 hz resulted in higher mpss this can be explained by examining the spectral energy resulting from extending the cutoff frequency and the corresponding energy from the diagnostic tail frequency spectra measured by ndbc buoys only include wave energy within the frequency band of 0 02 0 485 hz fig 12 a and b if the spectrum contains significant high frequency energy as in the coastal buoys this can cause inaccuracies in calculation of the iec parameters at the buoys which are calculated by integrating the measured spectra although the initial cutoff frequency of 0 52 hz is close to the maximum frequency resolved by the buoys using 1 0 hz resulted in greater accuracy examining simulated wave spectra and the corresponding diagnostic tail for different times during different simulation periods showed that in most cases when simulating using the cutoff frequency of 1 0 hz the diagnostic tail for the spectrum overestimated the energy beyond the cutoff frequency of 0 52 hz fig 12c and d this means that the lower the cutoff frequency is the higher would be the amount of energy added to the spectrum through the diagnostic tail when it is not even included in buoy data although this added amount of energy may be too small to cause substantial changes in wave height and period for iec parameters like spectral width and directionality coefficient that are highly non linear functions of the spectral moments the changes could be dramatic fig 3 6 summary and conclusion in this paper a high resolution computational mesh with triangular elements based on an unstructured swan was developed for the future wave energy characterization of the gulf of mexico puerto rico and the u s virgin islands the mesh spatial resolution was 200 m within 20 km of the coast and decreased to 1 3 km over the inner shelf and 5 20 km offshore a thorough sensitivity analysis of several model input parameters as well as a detailed calibration of the model for whitecapping formulations parameters were implemented both sensitivity analysis and calibration were supported by wave parameter observations from 18 ndbc wavcis and cdip buoys for establishing model performance statistics these parameters included computational time step number of iterations number of spectral frequencies number of spectral directions cut off frequency directional spreading of boundary waves and frequency spectral shape of boundary data a wide range of values was examined for sensitivity analysis of each parameter and the values corresponding to the best statistical match up with buoy measurements were used in simulations additional analyses were performed on the interplay of computational timestep and number of iterations to optimize the computational costs associated with very small computational timestep values also the number of directional bins was modified to mitigate the garden sprinkling effect the model parameters selected by the sensitivity analysis were used for a thorough calibration of the model for whitecapping dissipation parameters for calibration and sensitivity analysis multiple time periods were considered to accommodate all types of significant atmospheric phenomena that contribute to the wave climate of the study area four 1 month calibration periods that include hurricanes tropical storms cold fronts the caribbean low level jet and intermittent fair weather conditions were considered examining different whitecapping wind input formulations incorporated in swan komen janssen and westhuysen with default parameters showed that the janssen formulation results in the best match for wave height and parameter hence this formulation was selected for further tuning the whitecapping parameters that in this case were the whitecapping coefficient and parameter δ different combinations of these two parameters were used to run the model for all four calibration periods results showed that depending on the season two different values for c d s can result in the best match while the same parameter δ value is used all year examining the interplay between the computational timestep and the number of iterations and its relation with mesh resolution is one of the unique aspects of this study in most simulations using swan the default timestep of 10 min and one iteration are used while in cases using a fine resolution mesh this could compromise significant amounts of model accuracy by considering this interplay we were able to decrease the simulation cost threefold without compromising model accuracy therefore when using very fine resolution meshes sensitivity analysis of timestep and number of iterations the maximum courant number equals ten and the simulation cost should be used as the main criteria for selecting the timestep and the number of iterations precautions should be taken on selecting the cutoff frequency when the simulation involves calculating wave bulk parameters that are high order non linear functions of spectral moments like the iec parameters spectral width and directionality coefficient in this case using smaller cutoff frequencies close to the maximum frequency measured by buoys may result in larger discrepancies due to the overestimation of the spectral energy by the traditional diagnostic tail functions this calibrated model for the gprvi region is being used to generate a 32 year hindcast from which iec parameters and other wave statistics will be estimated for a comprehensive characterization and assessment of wave energy resources in this region the results will be reported in future correspondence the thorough sensitivity analysis and calibration conducted for this study region is unprecedented to the authors knowledge and can be used as a useful reference and benchmark for future wave modeling with engineering or operational purposes credit authorship contribution statement mohammad nabi allahdadi conceptualization methodology data curation writing original draft formal analysis investigation validation ruoying he conceptualization methodology formal analysis investigation supervision funding acquisition project administration writing review editing seongho ahn conceptualization methodology writing review editing chris chartrand data curation writing original draft formal analysis investigation validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements sandia national laboratories is a multi mission laboratory managed and operated by national technology and engineering solutions of sandia llc a wholly owned subsidiary of honeywell international inc for the us department of energy s national nuclear security administration under contract de na0003525 this paper describes objective technical results and analysis any subjective views or opinions that might be expressed in the paper do not necessarily represent the views of the us department of energy or the united states government the authors appreciate dr chunyan li and the wavcis lab from louisiana state university for providing wave data at stations in the northern gulf of mexico we thank jennifer warrillow for editorial assistance with the manuscript appendix a tables table a 1 list of buoys used for model calibration verification table a 1 buoy id lon lat water depth m general data time span type location 431 64 7193 17 7674 255 2008 2009 cdip christiansted st croix vi 41043 64 856 21 132 5271 2007 2009 ndbc ne puerto rico 170 nm nne of san juan pr 42001 89 668 25 897 3207 1980 2009 ndbc mid gulf 180 nm south of southwest pass la 42002 93 758 26 091 3125 1 1980 2009 ndbc west gulf 207 nm east of brownsville tx 42003 85 638 25 93 3250 1979 2009 ndbc east gulf 208 nm west of naples fl 42019 95 35 27 906 82 2 1990 2009 ndbc 60 nm south of freeport tx 42020 96 693 26 968 84 1 1990 2009 ndbc 60nm sse of corpus christi tx 42035 94 413 29 232 16 2 1993 2009 ndbc 22 nm east of galveston tx 42036 84 516 28 501 49 7 1994 2009 ndbc west tampa 112 nm wnw of tampa fl 42039 86 008 28 788 270 1996 2009 ndbc pensacola 42040 88 226 29 208 183 1996 2009 ndbc 63 nm south of dauphin 42056 84 938 19 918 4554 2005 2009 ndbc yucatan basin 120 nm ese of cozumel mx 42057 81 422 16 908 377 2005 2009 ndbc western caribbean 195 nm wsw of negril jamaica 42058 74 575 14 888 4158 2005 2009 ndbc central caribbean 210 nm sse of kingston jamaica 42059 67 51 15 252 4784 2007 2009 ndbc eastern caribbean sea 180 nm ssw of ponce pr 42060 63 35 16 387 1507 2009 ndbc caribbean valley 63 nm wsw of montserrat csi06 90 483 28 867 20 2008 2009 wavcis louisiana inner shelf csi09 89 978 29 101 18 2008 2009 wavcis louisiana inner shelf appendix b formulae for calculation of iec parameters based on spectral data based on iec 2015 standards the following six parameters derived from the frequency directional wave spectra are required for evaluation of the wave energy resources and design of wec facilities significant wave height h s 4 m 0 energy period t e m 1 m 0 omni directional wave power j ρ g i j c g i s i j δ f i δ θ j spectral width ε 0 m 0 m 2 m 1 2 1 direction of maximum wave power θ j m a x directionality coefficient of maximum wave power d j θ j m a x j where m n is the nth order spectral moment ρ is water density g is the acceleration due to gravity c g is the wave group velocity s i j is spectral energy corresponding to a spectral component with ith frequency and jth direction and δ θ j are spectral resolutions 
20463,the south china sea scs is an important channel which plays a significant role in global economic trade and in the maintenance of world energy security a series of artificial lands have been successfully built on the top of natural coral reefs in the scs by the way of reclamation in recent years in order to prevent those artificial lands from wave scouring and impacting a great number of revetments and breakwaters have been constructed along the margin of these artificial lands the revetment breakwaters have great significance and practical value to ensure the stability of these reclaimed lands and to guarantee their normal long term service performance in this study taking the reclamation project in the scs as the engineering background a computation model for the interaction between ocean waves revetment breakwater and its calcareous coral sand foundation is established by taking the cfd solver olaflow as the computation platform which was developed based on the open source library openfoam then this established computation model is verified by some laboratory testing data of wave profile and wave impact which have been measured in several wave flume physical model tests the comparison between the testing data and the computational results indicates that the computation model established adopting olaflow can reliably simulate the wave generation propagation the dissipation of wave energy as well as the complicated interaction between ocean wave the revetment breakwater and its calcareous coral sand foundation this verification work will be a solid basis for the subsequent investigation of the interaction between severe ocean waves and the revetment breakwaters in large scale as well as the quantitative evaluation of the stability of the revetment breakwater build on reclaimed coral sand foundation in the scs keywords wave breakwater interaction revetment breakwater reclaimed calcareous coral sand foundation the south china sea scs wave flume tests numerical verification olaflow 1 introduction the south china sea scs is rich in resources such as oil gas fishery mineral deposits etc the scs not only acts as an important channel for global economy trade and energy transportation but also an important strategic significance to the world economic development several artificial lands have been successfully built on the top of some natural coral reefs in the scs by reclamation recently for the purpose of conducting marine observation scientific research maritime rescue and land protection to defend these artificial lands from being scoured and impacted by severe waves a great number of revetments and breakwaters have been constructed in a combined form along the margins of these reclaimed lands however the marine loading condition in the scs is relatively harsh according to official statistics from 1949 to 1981 366 typhoons and 198 severe typhoons have occurred in the scs during the past 33 years an average of 11 1 typhoons and 6 severe ones have occurred in each year guan and xie 1984 in this case the issue that whether the revetment breakwater is capable of withstanding the impact of severe waves or not needs to be studied comprehensively therefore the investigation on the ability of the revetment breakwater when withstanding the impacting of severe ocean waves has important significance and practical value to ensure the stability of these reclaimed lands and guarantee their long term service performance in the scs the influences of wave impacting on a breakwater can be intuitively reflected by three indicators they are 1 the magnitude of the wave impact on breakwater 2 the displacement of breakwater and the deformation of its foundation caused by long term wave impacting and 3 the overtopping generated during the impacting process correspondingly the stability of breakwater can be evaluated by the three indicators synthetically at present there have been a number of works on the hydrodynamic characteristics of the interaction between ocean waves and breakwater in literature the wave flume physical model tests and numerical modelling are the main research methods at present most of physical model tests are carried out in wave flumes due to the fact that they could simulate various ocean waves which could be similar to that occurred at the sites of practical engineering besides the generated waves in wave flumes are intuitive to engineers and with high reliability physical model tests in wave flume generally are conducted based on the principle of froude number similarity under the condition of 1 g early tests were generally based on the assumption that seabed foundation could provide infinite bearing capacity and mainly focused their attention on the dynamics of waves and their interaction with structures according to a great number of previous instability cases it was found that seabed foundation actually does not have infinite bearing capacity instead they were easy to become soften and or liquefied resulting in the losing of bearing capacity under cyclic wave impacting ye et al 2015 zhao et al 2020 therefore the existence of seabed foundation has been generally taken into consideration in some wave flume tests in the past two decades tzang and ou 2006 ulker et al 2010 liu et al 2013 shen et al 2017 tong et al 2018 yan et al 2018 zhang et al 2020 ren et al 2020 the results obtained from these tests are more reliable for the judgment of the stability of offshore structures actually a great number of experimental investigation works have been conducted through water flume tests for the hydrodynamic performance of various types of offshore breakwater in the past such as the comparison for the effect of regular wave and random wave galland 1995 jensen et al 1997 günaydın and kabdaşl 2007 anastasios et al 2019 the measurement technology for breakwater damage andrea et al 2020 jeffrey 1999 the computation and mitigation of wave impacting kita et al 2018 mogridge and jamieson 1980 franco 1994 oumeraci 1994 the computation and influence factors screening for wave overtopping tofany et al 2016 salauddin and pearson 2019 2020 shankar and jayaratne 2003 etc however there also are some disadvantages such as complicated operation and high cost for the wave flume physical model tests therefore it is generally only conducted for some important projects with sufficient investment with the rapid development of computer technology numerical simulation has gradually become the main research method for the hydrodynamic interaction between wave and breakwater due to the advantages of simple operation and less requirement in time and laboratory space computational fluid dynamics cfd is currently the main method to simulate the hydrodynamic performance of breakwaters the widely used cfd numerical computation methods include finite difference method fdm finite element method fem smoothed particle hydrodynamics sph and finite volume method fvm the fdm is widely used in early computation models however the main drawback of fdm is that it is difficult to naturally deal with complex terrain and structural shape it is also hard to achieve parallelism which leads to the limitation of computation efficiency and scale this problem can be reflected in the program cobras hsu et al 2002 the fem has the advantage of high accuracy when high order elements are used but it also has many disadvantages e g the computation meshes may need to move along with the movement of the wave as a result the computation efficiency could be lower while the mesh size is small and demand for memory is huge therefore the fem is not widely used in the field of cfd while there are still some classic works zienkiewicz et al 2014 viré et al 2016 the sph method has great advantages in studying complex fluid motion like wave breaking additionally its parallel efficiency is very considerable crespo et al 2015 however due to the huge amount of computation it may involve it is quite difficult to apply the sph method into large scale actual marine and coastal engineering unless the users own a cluster with gpu nevertheless the fvm is currently widely used in the field of cfd due to its high parallel efficiency relatively simple mathematical discrete theory and programming process as the seabed foundation is a type of porous medium there is porous flow inside seabed foundation during the interaction between waves and structures unfortunately this porous flow cannot be taken into consideration in the rans equation in order to solve this problem hsu et al 2002 hsu et al 2002 proposed the volume average and reynold average navier stokes varans equation which incorporates the description of pore flow into the rans equation through the forcheimer equation i a u b u 2 c u t olaflow is a solver based on the openfoam open source library to solve the varans equation which has been widely used in the field of coastal engineering for example guler et al 2018 guler et al 2018 simulated the potential scenario of haydarpasa port attacked by a tsunami adopting openfoam park el al 2018 park et al 2018 simulated and compared the three types of state for wave during the interaction between waves and structures adopting openfoam and fluent however the varans equation cannot compute the displacement of structures and the deformation of seabed foundation in order to deal with this problem ye et al 2013a 2013b developed an integrated model fssi cas2d which couples the varans equation with the biot s equation to simulate the deformation of seabed foundation and the displacement of structure under wave impacting considering the safety and stability problem of the revetment breakwater built on reclaimed lands in the south china sea under extreme wave impacting fssi cas2d will be applied into this practical engineering to carry out this type of simulation in the future to guarantee the reliability of the computation results it must be ensured that the varans equation and related solvers can accurately simulate the interaction process between the ocean wave and the revetment breakwater in this study a computation model for the interaction between ocean waves the revetment breakwater and its calcareous coral sand foundation is established based on the open source cfd solver olaflow the experimental results of some wave flume physical model tests are adopted to verify the reliability of the computation model this verification work will be a solid basis for the subsequent investigation on the stability of the revetment breakwater under severe ocean wave in the scs 2 numerical model 2 1 governing equations the two phase flow solver interfoam based on the rans equation in openfoam is widely applied to study the dynamics of fluids however the porous flow in seabed foundation can t be considered in the rans equation to solve this problem hsu et al 2002 hsu et al 2002 has proposed the varans equation by introducing the drag force i a u b u 2 c u t resulting from porous flow into the rans equation then the program cobras was developed adopting fdm however the structures with complex outer shape and the seabed floor with complex terrain can t be handled in cobras higuera et al 2014 higuera et al 2014 developed the computation module ihfoam to solve the varans equation taking openfoam as the platform which was later evolved to olaflow higuera et al 2018 it has overcome the shortcomings of cobras and it is effective to handle the interaction between intricately shaped structures seabed foundation with complex terrain and various ocean waves considering the complexity of the revetment breakwater s shape and the terrain of natural reef islands olaflow is selected as the computation platform in this study its governing equations include the continuity equation and the momentum conservation equation 1 u i x i 0 2 1 c n ρ u i t 1 n x j 1 φ ρ u i u j p f x i g j x j ρ x i 1 n x j μ e u i x j f i s t α 1 n 3 n 3 μ d 50 2 u i β 1 7 5 k c 1 n n 3 ρ d 50 u j u j u i where u i is the velocity vector x i is the position vector n is the porosity is the dynamic viscosity coefficient of water μ e is the effective dynamic viscosity p is the pseudo dynamic pressure g i is the acceleration due to gravity g i 9 806 m s2 is the density of water the seepage drag force formula proposed by forchheimer 1901 forchheimer 1901 and polubarinova kochina 1952 polubarinova kocina 1952 is adopted in equation 2 to describe the contribution of porous flow to the equation of force balance there have been many studies on the quantitative determination of the coefficient a and b the current widely applied formulation was proposed by engelund 1953 engelund 1953 and revised by van gent 1995 van gent 1995 the specific expressions are as follow 3 a α 1 n 3 n 3 μ d 50 2 4 b β 1 7 5 k c 1 n n 3 ρ d 50 where d 50 is the average particle size of porous medium n is the porosity kc is the keulegan carpenter number which represents the additional friction force caused by the oscillation and instability of a flowing system it is defined as k c t 0 μ m d 50 n where μ m represents the maximum oscillation rate and t 0 is the oscillation period for a steady porous flow t 0 could be set as c in equation 2 is a parameter related to the acceleration of porous flow its value is generally calculated following the equation where is the an empirical parameter it is proposed by higuera et al 2014 higuera et al 2014 that c has little effect on the result previous researchers generally recommended the value of to be 0 34 higuera et al 2014 and this value keeps unchanged in computation it is better for α and β to be measured by physical experiments ye et al 2019 for the purpose of reliability in addition a series of formulations for the estimation of α and β have been recommended by some scholars as summarized in lin 2007 lin and karunarathna 2007 the vof method is adopted in olaflow to capture the interface between water and air this method introduces a phase fraction α vof to represent the volume fraction of water in each grid cell if α vof 1 it means that the mesh cell is full of water on the contrary α vof 0 indicates that the cell is filled with air if 0 α vof 1 it means that there is an interface between water and air namely 5 α v o f 0 a i r 0 α v o f 1 f r e e s u r f a c e α v o f 1 w a t e r the governing equation of α vof is 6 α v o f t u α v o f u c α v o f 1 α v o f once the phase fraction is determined all physical parameters in each grid cell can be determined based on an average idea for example the density ρ within each mesh cell is expressed as 7 ρ α v o f ρ w a t e r 1 α v o f ρ a i r where ρ w a t e r and ρ a i r are the density of water and air respectively 2 2 turbulence model there are a series of turbulence computation models available in openfoam at present the reynolds averaged rans turbulence model is selected in this study generally rans turbulence model includes k ε model and rng k ε model the rng k ε model has a better accuracy when the influence of turbulent vortices is considered according to the work by lu et al 2013 the rng k ε model can handle the flows with high strain rates and significant streamline bending more efficiently in this study the period of the simulated wave is small and the degree of streamline bending is relatively significant finally the rng k ε model is selected in the computation while the turbulence is considered in computation it is only necessary to change μ into μ μ μ t in equation 2 where μ t is the eddy viscosity coefficient formulated as 8 μ t c μ k 2 ε where k is turbulent kinetic energy ε is dissipation rate c μ is a dimensionless constant k and ε are generally determined from the following transport equations for the problem involving high reynolds number the following equations for k and ε are adopted 9 k t u j k x i x i μ t σ k k x j g k ε 10 ε t u j ε x j x j μ t σ σ ε x j c 1 ε ε k g k c 2 ε ρ ε 2 k where g k 2 μ t d i j d i j is the turbulent kinetic energy generation term and d i j μ i x j μ j x i 2 is the tensor of average strain rate c 1 ε c 1 ε η 1 η η 0 1 β η 3 where η s k ε s 2 d i j d i j 1 2 the coefficient values in the rng k ε model are listed in table 1 3 physical modelling the wave flume with a total length of 47 m a height of 1 3 m and a width of 1 m is adopted in the physical model tests the left side of the flume is equipped with a piston wave maker driven by a servo motor and there is a 7 m long inclined slope section for the purpose of wave absorption at the right end side the revetment breakwater and its foundation are installed in the flume in the way of full section as a result the incident waves are completely blocked and reflected by the physical model during testing the wave absorption section actually has no use in order to utilize the flume appropriately and let the physical model as far away from the wave maker as possible the right end of the physical model is set at the position where is 2 m away from the starting point of the wave absorption slope thus the actual effective length of the flume is 38 m in the test the physical model is made with a geometric similarity scale of 1 10 and it is also constructed according to the real size of structures and the layout at in site on the reclaimed coral reef islands the physical model designed for flume tests and its configuration are shown in fig 1 the revetment breakwater which is poured by concrete according to the geometric scale of 1 10 consists of a revetment and a caisson wall the foundation of the breakwater includes three kinds of materials gravels sand gravel mixture and calcareous coral sand gravels and sand gravel mixture are utilized to simulate the original stratum before the artificial land is reclaimed the gravels simulate the coral reef flat in front of the revetment breakwater the calcareous sand is utilized to simulate the reclaimed land on the top of natural coral reef all the materials are sampled from the engineering in site in the south china sea according to the field measurement data the dry density of the calcareous sand foundation is 1 51 g cm3 the total length of the calcareous sand foundation is 2 25 m and the height is 0 5 m the sand gravel mixture is laid below the calcareous sand foundation with a length of 2 65 m and a height of 0 45 m the gravels with a diameter of 1 cm 2cm is utilized to simulate the coral reef flat in front of the breakwater for the purpose of wave energy elimination the starting point of the coral reef flat is 29 95 m away from the wave maker its shape is a triangle whose length and height are 5 4 m and 0 45 m respectively the physical properties of three types of porous medium above determined through laboratory measurement are listed in table 2 the measurement method for α and β is available in ye et al 2019 ye et al 2019 a series of irregular rock blocks are piled up on the coral reef flat in front of the breakwater in physical testing they are utilized to simulate the stone ripraps that is piled up in front of the breakwater to achieve the purpose of wave energy dissipation at the real engineering sites of the reclaimed coral reef islands as demonstrated in fig 1 the average diameter of the rock blocks is about 10 cm and their installment length is about 1 m in order to further enhance the wave dissipation ability at the engineering sites a series of accropodes are installed on the revetment breakwater in a staggered way in the wave flume physical model tests a great number of accropodes are also installed in the same way in front of the revetment breakwater as shown in fig 2 b the length width and height of accropode model are all 0 1 m as demonstrated in fig 2 a in the wave flume physical model tests thirty two pressure sensors are installed on the revetment and caisson to record the impact pressure of wave on the revetment breakwater five wave profile gauges are installed along the longitudinal central line of the flume to record the variation of water level in tests the positions of the five wave profile gauges are shown in fig 1 according to the distance to the breakwater the wave profile gauges are numbered w1 to w5 from far to near position the distance of the wave profile gauges from the rightmost end of the physical model are listed in table 3 considering different water levels wave heights and periods more than 10 tests have been conducted in this study the test results of three typical wave conditions are selected to verify the reliability of the established computation model the wave parameters listed in table 4 are the target parameters of the generated regular waves which is generated by a piston wave maker 4 model verification without structure in order to build a foundation for the verification of the subsequent complex cases it is necessary to verify the numerical computation model adopting the results obtained in some simple water flume tests in this study totally 7 sets of wave flume tests without any structures have been conducted for this purpose the wave parameters of them are listed in table 5 it is noticed that the wave parameters listed in table 5 also are the target waves and the stokes wave theory of second order is adopted by the numerical wave maker the wave profile recorded by w3 is adopted to verify the numerical computation model the comparison between the test results recorded by w3 and the computational results of the numerical model under the 7 sets of experimental wave conditions is illustrated in fig 3 it is observed in fig 3 that the numerical computation model can accurately generate the waves required in the tests since the physical wave maker just started to work in the initial 10s the entire wave making system is a little unstable during this period as a result the agreement between the numerical simulation results and the experimental results is relatively poor in the initial 10s however the physical wave maker became stable to work after t 10s the numerical results can agree very well with the test results as demonstrated in fig 3 through the comparative analysis it is indicated that the wave maker in olaflow can reliably simulate various simple water waves furthermore there is no the requirement for olaflow that a period of time is necessary for the wave profiles become stable like that in the physical model tests after olaflow starting to generate wave the wave height can steadily reach its expected value in short period finally the phenomenon of wave height attenuation and wave interference are both not observed in the numerical wave flume it is indicated that olaflow has efficiently and successfully absorbed the incident wave at the end boundary of numerical wave tank by setting the active wave absorption boundary condition 5 model verification for wave revetment breakwater calcareous coral foundation interaction although the numerical wave maker of olaflow has been tested in the cases without structures whether the computational model established based on olaflow for the wave revetment breakwater calcareous coral sand foundation interaction could reliably simulates the complicated interaction process still requires further verification the results obtained from the three physical model tests listed in table 4 are adopted to verify the established computational model in this section in order to perform the numerical simulation efficiently a super cluster huawei kunlun9016 is utilized there are totally 256 cpu cores have been used in parallelization the cpu type is intel xeon e7 4850 v4 and its frequency is 2 10 ghz the memory demand for tests 1 to test 3 are 3 2 gb 3 9 gb and 11 7 gb there are 370806 547579 and 4171577 elements in test 1 test2 and test 3 respectively for each case presented in this section the time spend for computation are 6 4 h for test 1 7 5 h for test 2 and 115 6 h for test 3 respectively 5 1 mesh generation in order to simulate the wave propagation process and the interaction between the wave and the structure effectively non uniform mesh system is used during the mesh generation in the established numerical model as it is shown in fig 4 the meshes near to the water air interface and around the structure are relatively dense while they are relatively loose in the other zone the revetment breakwater is not meshed as it is impervious concrete material the foundation of the revetment breakwater is porous medium thus it needs to be meshed considering the internal porous flow in it as listed in table 4 accropodes are utilized to dissipate the wave energy in test 3 the number of meshes will be very great probably up to hundreds of millions if the meshes around the accropodes are generated based on the configuration in the physical model tests furthermore it is quite difficult to perform the mesh generation operation as these accropodes are mutually contacted with each other therefore in order to simplify the computation and improve the computation efficiency the accropodes in the computation model are installed in the way shown in fig 5 only one row of accropodes is placed on the revetment breakwater in the cases without accropodes only two dimensional mesh is required nevertheless for those cases with accropodes three dimensional meshes must be generated the mesh generation is performed adopting the meshing tool utilities available in the openfoam library the generated meshes in the case with accropodes are shown in fig 6 the detailed information about the mesh size of the computational cells for test 1 test 2 and test 3 are listed in tables 6 8 5 2 comparative analysis for wave surfaces the comparison for the wave profiles between the numerical results and the test results recorded in test 1 low water level without accropode is illustrated in fig 7 w4 and w5 are located in the middle part of the wave flume which mainly are utilized to measure the ability of wave maker the wave profiles at w4 and w5 reach the expected wave height at the time of 10s and 8s respectively and maintain a good stability thereafter w2 is located over the zone of the triangular coral reef flat w3 is located at the beginning of the reef flat the wave profiles recorded by them are basically the same as that recorded by w4 and w5 however the wave profile at w2 is a little different due to the effect of the wave climbing on the sloping reef flat at the same time the wave crests become significantly sharper and the wave troughs get a little flatter showing obvious nonlinearity due to the shallow water depth in test 1 and w1 is located in front of the revetment there is no wave profile that can be recorded because no wave has arrived at there it is demonstrated in fig 7 that the computation results of the numerical model are in good agreement with the physical model tests results under the low water level without accropodes it is indicated that the numerical computation model has good reliability the comparison of the wave profiles between the numerical model results and the test results recorded in test 2 high water level without accropodes is demonstrated in fig 8 it is shown by the wave profile at w1 that the period between two main crests maintains about 2 2s additionally there are a series of secondary crests between two main crests the reason for this phenomenon is that w1 is located above the rubble mounds in front of the revetment significant reflection and superposition with the incident waves and wave breaking always occur at the position of w1 which certainly lead to a very irregular wave profile at w1 as a consequence of the high water level in test 2 the climbing effect of the wave at w2 is not particularly significant however there is still the phenomenon that the wave crests become sharper and the troughs get flatten at the same time the wave height at this position w2 has the trend of increasing which can reach about 40 cm as shown in fig 8 the computed wave profiles at w2 to w5 are basically consistent with the testing data from the physical model test for the case with high water level and without accropode w1 is located at the left end of the revetment and meanwhile at the right end of the rubble mound due to the wave reflection superposition and the energy dissipation of the rubble mounds the evolution of the wave profile at w1 is very complicated although the influence of the rubble mound is considered in the computation model and only one row of accropodes are set this is quite different from the real installment of the accropodes in the physical model therefore it is normal that there are some differences between the computed wave profiles and the testing results at the position w1 but it still can be seen in fig 8 that the computed and recorded wave profiles are quite similar it is indicated that the established numerical calculation model is credible the comparison of wave profiles between the numerical model results and the test results in test 3 high water level with accropodes is demonstrated in fig 9 generally compared with that in test 2 the wave profile at w1 is more regular since the wave energy is dissipated by the accropodes the retreating of waves from the revetment breakwater has little effect on the incident wave as a result the reflected wave does not cause much interference to the next incident wave after the wave breaking and hitting the breakwater in each period finally only a little fluctuation appears at each trough even though the mesh is relatively more complicated after the accropodes are added in the numerical computation model olaflow can still handle the simulation of wave generation wave breaking and porous flow very well the simulation result at w1 with a crest height of 20 cm is more stable than that of experimental data it happens due to the following several factors firstly the number of accropodes has been greatly reduced comparing with that in the physical model tests and the installment way also has been simplified secondly the width of the flume is reduced and the surface roughness is out of consideration that is to say the simulation environment in the computation model is relatively simple and ideal in general the computational results of wave profile at w1 are basically consistent with the testing results the simulated results at w2 to w5 also fit well with the testing results therefore in the case of high water level with accropodes the established numerical computation model in this study also has good reliability 5 3 comparative analysis of wave impact pressure in the physical model tests thirty two pressure sensors are uniformly installed on the revetment breakwater to record the impact of wave six pressure sensors named ps1 to ps6 at typical positions are taken as the representative to verify the computation model the specific position and serial number of the six pressure sensors are shown in fig 10 the outer diameter of the pressure sensors is 5 mm the measuring range is 10 kpa with a measuring accuracy of 0 25 the sampling frequency is 50 hz during testing as the water level is low in test 1 the revetment breakwater is not attacked by the waves therefore the comparative analysis of the impact pressure is not studied for test 1 the time history comparison of the wave impact between the numerical simulation results and the test results at the six typical positions on the revetment breakwater in test 2 high water level without accropodes is shown in fig 12 except for that recorded by ps1 the wave impact recorded by the other five pressure sensors all show a good periodicity ps1 is located at the left end of the revetment where the incident wave and reflected wave are superimposed violently the wave profile is greatly affected by the superposition so the time history of wave impact has great fluctuation ps2 and ps3 are located on the slope of the revetment the wave impact recorded by ps2 and ps3 are quite similar besides there are a great number of high frequency fluctuations on the crest and trough zones in the time history of wave impact ps4 is located at the right end of the revetment the time history of wave impact recorded by ps4 is basically the same as that recorded by ps2 and ps3 ps5 and ps6 are installed on the lateral side of the caisson wall to directly record the time history of wave impact on it it can be found that there is no obvious wave breaking on the slope of the revetment when the incident wave crests reaching the revetment breakwater however the wave crests climb along the sloping upper surface of the revetment and finally impact the lateral side of the caisson wall fiercely resulting in the severe breaking and wave overtopping as that shown in fig 11 the wave impact on the caisson wall recorded by ps5 and ps6 have the typical characteristics of impacting the impact of wave reaches its peak value which is up to 5 kpa in a short time when the wave is colliding with the caisson wall then the wave impact quickly reduces to the magnitude of 1 2 to 1 3 of the peak value and maintains for a period of time it finally reduces rapidly after the wave retreating but it does not completely reduce to 0 because there is more or less water accumulated in the holes where the pressure sensors are installed it is a fact that the shape and the random layout of these rubbles in front of the revetment can t be exactly simulated in computation moreover the surfaces of the reef flat and the revetment breakwater are smooth in the numerical modelling however they are actually rough in the physical model tests as a result the wave impact predicted by the numerical simulation is slightly greater than the testing value at each position the agreement on the time history of wave impact at ps1 between the numerical result and the recorded value in testing is not very well because the wave characteristics at ps1 is greatly affected by the rubbles in the physical model tests however it is difficult for the numerical model to handle this effect accurately it should be noticed that the numerical results are just slightly different with the testing results such as the peak impact pressure and the wave period besides the numerical model is successful in capturing the secondary peak value of the wave impact which is caused by the wave retreating this secondary peak value of the wave impact pressure is basically consistent with the wave profiles recorded in the physical model tests the computation results of the wave impact at ps2 and ps3 are as same as the results recorded in the physical tests what is quite different from the physical test results is that the impacting and retreating of the wave are relatively smooth in the numerical simulated results additionally there is no the high frequency fluctuation in the crest and trough zones along the time history of the wave impact predicted by the computational model because the surface of the revetment breakwater is approximately smooth in the geometry model for numerical modelling the time history characteristics of the wave impact on the caisson wall at ps5 and ps6 are also well simulated by the numerical model the comparison of the wave impact between the time history and the numerical simulation results is shown in fig 12 it is observed that the computation model can reliably determine the magnitude and the time history of the wave impact acting on the revetment breakwater under the condition of high water level without accropode the time history comparison of the wave impact between the numerical simulation results and the test results in test 3 at the six typical positions on the revetment breakwater high water level with accropodes are illustrated in fig 13 after these accropodes are installed the time history of the wave impact at the six positions all showcase a good periodicity it is quite different from that in test 2 as shown in fig 12 since these accropodes can effectively dissipate some wave energy there is no significant wave superposition and wave breaking at ps1 comparing with that in test 2 the time history of the wave impact at ps1 has a better periodicity and there is no obvious secondary peak the time history of the wave impact recorded by ps5 and ps6 on the caisson wall indicates that the energy dissipation effect of these accropodes is effective and considerable the peak of the wave impact is only about 2 kpa which is reduced by 60 relative to that in test 2 it is demonstrated in fig 13 that the computational results of the numerical model and the testing results recorded in the physical model tests are in good consistency it is indicated that the established numerical computational model has good reliability under the conditions of high water level with accropodes through the comparative analysis between the numerical results and the physical model tests results it is found that the numerical computational model established in this study for the interaction between ocean waves revetment breakwater and its calcareous coral sand foundation can reliably simulate the wave propagation reflection superposition breaking overtopping and the physical process of wave impacting on the revetment breakwater it will be a solid basis for the subsequent investigation of the dynamics characteristics of the revetment breakwater and the deformation of its calcareous coral foundation as well as the evaluation of stability of the revetment breakwater in the scs 6 conclusion taking the reclamation project in the scs as the engineering background a numerical computational model for wave revetment breakwater calcareous coral sand foundation interaction is established in this study taking the open source cfd solver olaflow as the computational platform a series of physical model tests are also conducted in a large wave flume adopting a geometric scale of 1 10 through the comparative analysis on the wave profiles and the time history of the wave impact acting on the revetment breakwater between the numerical results and the testing results it is found that the numerical computational model established for the interaction between ocean waves revetment breakwater and its coral sand foundation has good reliability this numerical verification work will be a solid basis not only for the subsequent investigation on the interaction between extreme ocean waves revetment breakwaters in the scs and their coral sand foundation at the practical engineering scale but also for the quantitative evaluation of the stability of the revetment breakwater in extreme typhoon climate in the scs credit authorship contribution statement jianhong ye conceptualization methodology writing review editing supervision project administration funding acquisition jipeng shan investigation formal analysis validation haoran zhou writing original draft writing review editing naixiao yan visualization writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is grateful for the funding support from national natural science foundation of china grant no 51879257 as well as the funding support from strategic priority research program of the chinese academy of sciences grant no xda13010202 
20463,the south china sea scs is an important channel which plays a significant role in global economic trade and in the maintenance of world energy security a series of artificial lands have been successfully built on the top of natural coral reefs in the scs by the way of reclamation in recent years in order to prevent those artificial lands from wave scouring and impacting a great number of revetments and breakwaters have been constructed along the margin of these artificial lands the revetment breakwaters have great significance and practical value to ensure the stability of these reclaimed lands and to guarantee their normal long term service performance in this study taking the reclamation project in the scs as the engineering background a computation model for the interaction between ocean waves revetment breakwater and its calcareous coral sand foundation is established by taking the cfd solver olaflow as the computation platform which was developed based on the open source library openfoam then this established computation model is verified by some laboratory testing data of wave profile and wave impact which have been measured in several wave flume physical model tests the comparison between the testing data and the computational results indicates that the computation model established adopting olaflow can reliably simulate the wave generation propagation the dissipation of wave energy as well as the complicated interaction between ocean wave the revetment breakwater and its calcareous coral sand foundation this verification work will be a solid basis for the subsequent investigation of the interaction between severe ocean waves and the revetment breakwaters in large scale as well as the quantitative evaluation of the stability of the revetment breakwater build on reclaimed coral sand foundation in the scs keywords wave breakwater interaction revetment breakwater reclaimed calcareous coral sand foundation the south china sea scs wave flume tests numerical verification olaflow 1 introduction the south china sea scs is rich in resources such as oil gas fishery mineral deposits etc the scs not only acts as an important channel for global economy trade and energy transportation but also an important strategic significance to the world economic development several artificial lands have been successfully built on the top of some natural coral reefs in the scs by reclamation recently for the purpose of conducting marine observation scientific research maritime rescue and land protection to defend these artificial lands from being scoured and impacted by severe waves a great number of revetments and breakwaters have been constructed in a combined form along the margins of these reclaimed lands however the marine loading condition in the scs is relatively harsh according to official statistics from 1949 to 1981 366 typhoons and 198 severe typhoons have occurred in the scs during the past 33 years an average of 11 1 typhoons and 6 severe ones have occurred in each year guan and xie 1984 in this case the issue that whether the revetment breakwater is capable of withstanding the impact of severe waves or not needs to be studied comprehensively therefore the investigation on the ability of the revetment breakwater when withstanding the impacting of severe ocean waves has important significance and practical value to ensure the stability of these reclaimed lands and guarantee their long term service performance in the scs the influences of wave impacting on a breakwater can be intuitively reflected by three indicators they are 1 the magnitude of the wave impact on breakwater 2 the displacement of breakwater and the deformation of its foundation caused by long term wave impacting and 3 the overtopping generated during the impacting process correspondingly the stability of breakwater can be evaluated by the three indicators synthetically at present there have been a number of works on the hydrodynamic characteristics of the interaction between ocean waves and breakwater in literature the wave flume physical model tests and numerical modelling are the main research methods at present most of physical model tests are carried out in wave flumes due to the fact that they could simulate various ocean waves which could be similar to that occurred at the sites of practical engineering besides the generated waves in wave flumes are intuitive to engineers and with high reliability physical model tests in wave flume generally are conducted based on the principle of froude number similarity under the condition of 1 g early tests were generally based on the assumption that seabed foundation could provide infinite bearing capacity and mainly focused their attention on the dynamics of waves and their interaction with structures according to a great number of previous instability cases it was found that seabed foundation actually does not have infinite bearing capacity instead they were easy to become soften and or liquefied resulting in the losing of bearing capacity under cyclic wave impacting ye et al 2015 zhao et al 2020 therefore the existence of seabed foundation has been generally taken into consideration in some wave flume tests in the past two decades tzang and ou 2006 ulker et al 2010 liu et al 2013 shen et al 2017 tong et al 2018 yan et al 2018 zhang et al 2020 ren et al 2020 the results obtained from these tests are more reliable for the judgment of the stability of offshore structures actually a great number of experimental investigation works have been conducted through water flume tests for the hydrodynamic performance of various types of offshore breakwater in the past such as the comparison for the effect of regular wave and random wave galland 1995 jensen et al 1997 günaydın and kabdaşl 2007 anastasios et al 2019 the measurement technology for breakwater damage andrea et al 2020 jeffrey 1999 the computation and mitigation of wave impacting kita et al 2018 mogridge and jamieson 1980 franco 1994 oumeraci 1994 the computation and influence factors screening for wave overtopping tofany et al 2016 salauddin and pearson 2019 2020 shankar and jayaratne 2003 etc however there also are some disadvantages such as complicated operation and high cost for the wave flume physical model tests therefore it is generally only conducted for some important projects with sufficient investment with the rapid development of computer technology numerical simulation has gradually become the main research method for the hydrodynamic interaction between wave and breakwater due to the advantages of simple operation and less requirement in time and laboratory space computational fluid dynamics cfd is currently the main method to simulate the hydrodynamic performance of breakwaters the widely used cfd numerical computation methods include finite difference method fdm finite element method fem smoothed particle hydrodynamics sph and finite volume method fvm the fdm is widely used in early computation models however the main drawback of fdm is that it is difficult to naturally deal with complex terrain and structural shape it is also hard to achieve parallelism which leads to the limitation of computation efficiency and scale this problem can be reflected in the program cobras hsu et al 2002 the fem has the advantage of high accuracy when high order elements are used but it also has many disadvantages e g the computation meshes may need to move along with the movement of the wave as a result the computation efficiency could be lower while the mesh size is small and demand for memory is huge therefore the fem is not widely used in the field of cfd while there are still some classic works zienkiewicz et al 2014 viré et al 2016 the sph method has great advantages in studying complex fluid motion like wave breaking additionally its parallel efficiency is very considerable crespo et al 2015 however due to the huge amount of computation it may involve it is quite difficult to apply the sph method into large scale actual marine and coastal engineering unless the users own a cluster with gpu nevertheless the fvm is currently widely used in the field of cfd due to its high parallel efficiency relatively simple mathematical discrete theory and programming process as the seabed foundation is a type of porous medium there is porous flow inside seabed foundation during the interaction between waves and structures unfortunately this porous flow cannot be taken into consideration in the rans equation in order to solve this problem hsu et al 2002 hsu et al 2002 proposed the volume average and reynold average navier stokes varans equation which incorporates the description of pore flow into the rans equation through the forcheimer equation i a u b u 2 c u t olaflow is a solver based on the openfoam open source library to solve the varans equation which has been widely used in the field of coastal engineering for example guler et al 2018 guler et al 2018 simulated the potential scenario of haydarpasa port attacked by a tsunami adopting openfoam park el al 2018 park et al 2018 simulated and compared the three types of state for wave during the interaction between waves and structures adopting openfoam and fluent however the varans equation cannot compute the displacement of structures and the deformation of seabed foundation in order to deal with this problem ye et al 2013a 2013b developed an integrated model fssi cas2d which couples the varans equation with the biot s equation to simulate the deformation of seabed foundation and the displacement of structure under wave impacting considering the safety and stability problem of the revetment breakwater built on reclaimed lands in the south china sea under extreme wave impacting fssi cas2d will be applied into this practical engineering to carry out this type of simulation in the future to guarantee the reliability of the computation results it must be ensured that the varans equation and related solvers can accurately simulate the interaction process between the ocean wave and the revetment breakwater in this study a computation model for the interaction between ocean waves the revetment breakwater and its calcareous coral sand foundation is established based on the open source cfd solver olaflow the experimental results of some wave flume physical model tests are adopted to verify the reliability of the computation model this verification work will be a solid basis for the subsequent investigation on the stability of the revetment breakwater under severe ocean wave in the scs 2 numerical model 2 1 governing equations the two phase flow solver interfoam based on the rans equation in openfoam is widely applied to study the dynamics of fluids however the porous flow in seabed foundation can t be considered in the rans equation to solve this problem hsu et al 2002 hsu et al 2002 has proposed the varans equation by introducing the drag force i a u b u 2 c u t resulting from porous flow into the rans equation then the program cobras was developed adopting fdm however the structures with complex outer shape and the seabed floor with complex terrain can t be handled in cobras higuera et al 2014 higuera et al 2014 developed the computation module ihfoam to solve the varans equation taking openfoam as the platform which was later evolved to olaflow higuera et al 2018 it has overcome the shortcomings of cobras and it is effective to handle the interaction between intricately shaped structures seabed foundation with complex terrain and various ocean waves considering the complexity of the revetment breakwater s shape and the terrain of natural reef islands olaflow is selected as the computation platform in this study its governing equations include the continuity equation and the momentum conservation equation 1 u i x i 0 2 1 c n ρ u i t 1 n x j 1 φ ρ u i u j p f x i g j x j ρ x i 1 n x j μ e u i x j f i s t α 1 n 3 n 3 μ d 50 2 u i β 1 7 5 k c 1 n n 3 ρ d 50 u j u j u i where u i is the velocity vector x i is the position vector n is the porosity is the dynamic viscosity coefficient of water μ e is the effective dynamic viscosity p is the pseudo dynamic pressure g i is the acceleration due to gravity g i 9 806 m s2 is the density of water the seepage drag force formula proposed by forchheimer 1901 forchheimer 1901 and polubarinova kochina 1952 polubarinova kocina 1952 is adopted in equation 2 to describe the contribution of porous flow to the equation of force balance there have been many studies on the quantitative determination of the coefficient a and b the current widely applied formulation was proposed by engelund 1953 engelund 1953 and revised by van gent 1995 van gent 1995 the specific expressions are as follow 3 a α 1 n 3 n 3 μ d 50 2 4 b β 1 7 5 k c 1 n n 3 ρ d 50 where d 50 is the average particle size of porous medium n is the porosity kc is the keulegan carpenter number which represents the additional friction force caused by the oscillation and instability of a flowing system it is defined as k c t 0 μ m d 50 n where μ m represents the maximum oscillation rate and t 0 is the oscillation period for a steady porous flow t 0 could be set as c in equation 2 is a parameter related to the acceleration of porous flow its value is generally calculated following the equation where is the an empirical parameter it is proposed by higuera et al 2014 higuera et al 2014 that c has little effect on the result previous researchers generally recommended the value of to be 0 34 higuera et al 2014 and this value keeps unchanged in computation it is better for α and β to be measured by physical experiments ye et al 2019 for the purpose of reliability in addition a series of formulations for the estimation of α and β have been recommended by some scholars as summarized in lin 2007 lin and karunarathna 2007 the vof method is adopted in olaflow to capture the interface between water and air this method introduces a phase fraction α vof to represent the volume fraction of water in each grid cell if α vof 1 it means that the mesh cell is full of water on the contrary α vof 0 indicates that the cell is filled with air if 0 α vof 1 it means that there is an interface between water and air namely 5 α v o f 0 a i r 0 α v o f 1 f r e e s u r f a c e α v o f 1 w a t e r the governing equation of α vof is 6 α v o f t u α v o f u c α v o f 1 α v o f once the phase fraction is determined all physical parameters in each grid cell can be determined based on an average idea for example the density ρ within each mesh cell is expressed as 7 ρ α v o f ρ w a t e r 1 α v o f ρ a i r where ρ w a t e r and ρ a i r are the density of water and air respectively 2 2 turbulence model there are a series of turbulence computation models available in openfoam at present the reynolds averaged rans turbulence model is selected in this study generally rans turbulence model includes k ε model and rng k ε model the rng k ε model has a better accuracy when the influence of turbulent vortices is considered according to the work by lu et al 2013 the rng k ε model can handle the flows with high strain rates and significant streamline bending more efficiently in this study the period of the simulated wave is small and the degree of streamline bending is relatively significant finally the rng k ε model is selected in the computation while the turbulence is considered in computation it is only necessary to change μ into μ μ μ t in equation 2 where μ t is the eddy viscosity coefficient formulated as 8 μ t c μ k 2 ε where k is turbulent kinetic energy ε is dissipation rate c μ is a dimensionless constant k and ε are generally determined from the following transport equations for the problem involving high reynolds number the following equations for k and ε are adopted 9 k t u j k x i x i μ t σ k k x j g k ε 10 ε t u j ε x j x j μ t σ σ ε x j c 1 ε ε k g k c 2 ε ρ ε 2 k where g k 2 μ t d i j d i j is the turbulent kinetic energy generation term and d i j μ i x j μ j x i 2 is the tensor of average strain rate c 1 ε c 1 ε η 1 η η 0 1 β η 3 where η s k ε s 2 d i j d i j 1 2 the coefficient values in the rng k ε model are listed in table 1 3 physical modelling the wave flume with a total length of 47 m a height of 1 3 m and a width of 1 m is adopted in the physical model tests the left side of the flume is equipped with a piston wave maker driven by a servo motor and there is a 7 m long inclined slope section for the purpose of wave absorption at the right end side the revetment breakwater and its foundation are installed in the flume in the way of full section as a result the incident waves are completely blocked and reflected by the physical model during testing the wave absorption section actually has no use in order to utilize the flume appropriately and let the physical model as far away from the wave maker as possible the right end of the physical model is set at the position where is 2 m away from the starting point of the wave absorption slope thus the actual effective length of the flume is 38 m in the test the physical model is made with a geometric similarity scale of 1 10 and it is also constructed according to the real size of structures and the layout at in site on the reclaimed coral reef islands the physical model designed for flume tests and its configuration are shown in fig 1 the revetment breakwater which is poured by concrete according to the geometric scale of 1 10 consists of a revetment and a caisson wall the foundation of the breakwater includes three kinds of materials gravels sand gravel mixture and calcareous coral sand gravels and sand gravel mixture are utilized to simulate the original stratum before the artificial land is reclaimed the gravels simulate the coral reef flat in front of the revetment breakwater the calcareous sand is utilized to simulate the reclaimed land on the top of natural coral reef all the materials are sampled from the engineering in site in the south china sea according to the field measurement data the dry density of the calcareous sand foundation is 1 51 g cm3 the total length of the calcareous sand foundation is 2 25 m and the height is 0 5 m the sand gravel mixture is laid below the calcareous sand foundation with a length of 2 65 m and a height of 0 45 m the gravels with a diameter of 1 cm 2cm is utilized to simulate the coral reef flat in front of the breakwater for the purpose of wave energy elimination the starting point of the coral reef flat is 29 95 m away from the wave maker its shape is a triangle whose length and height are 5 4 m and 0 45 m respectively the physical properties of three types of porous medium above determined through laboratory measurement are listed in table 2 the measurement method for α and β is available in ye et al 2019 ye et al 2019 a series of irregular rock blocks are piled up on the coral reef flat in front of the breakwater in physical testing they are utilized to simulate the stone ripraps that is piled up in front of the breakwater to achieve the purpose of wave energy dissipation at the real engineering sites of the reclaimed coral reef islands as demonstrated in fig 1 the average diameter of the rock blocks is about 10 cm and their installment length is about 1 m in order to further enhance the wave dissipation ability at the engineering sites a series of accropodes are installed on the revetment breakwater in a staggered way in the wave flume physical model tests a great number of accropodes are also installed in the same way in front of the revetment breakwater as shown in fig 2 b the length width and height of accropode model are all 0 1 m as demonstrated in fig 2 a in the wave flume physical model tests thirty two pressure sensors are installed on the revetment and caisson to record the impact pressure of wave on the revetment breakwater five wave profile gauges are installed along the longitudinal central line of the flume to record the variation of water level in tests the positions of the five wave profile gauges are shown in fig 1 according to the distance to the breakwater the wave profile gauges are numbered w1 to w5 from far to near position the distance of the wave profile gauges from the rightmost end of the physical model are listed in table 3 considering different water levels wave heights and periods more than 10 tests have been conducted in this study the test results of three typical wave conditions are selected to verify the reliability of the established computation model the wave parameters listed in table 4 are the target parameters of the generated regular waves which is generated by a piston wave maker 4 model verification without structure in order to build a foundation for the verification of the subsequent complex cases it is necessary to verify the numerical computation model adopting the results obtained in some simple water flume tests in this study totally 7 sets of wave flume tests without any structures have been conducted for this purpose the wave parameters of them are listed in table 5 it is noticed that the wave parameters listed in table 5 also are the target waves and the stokes wave theory of second order is adopted by the numerical wave maker the wave profile recorded by w3 is adopted to verify the numerical computation model the comparison between the test results recorded by w3 and the computational results of the numerical model under the 7 sets of experimental wave conditions is illustrated in fig 3 it is observed in fig 3 that the numerical computation model can accurately generate the waves required in the tests since the physical wave maker just started to work in the initial 10s the entire wave making system is a little unstable during this period as a result the agreement between the numerical simulation results and the experimental results is relatively poor in the initial 10s however the physical wave maker became stable to work after t 10s the numerical results can agree very well with the test results as demonstrated in fig 3 through the comparative analysis it is indicated that the wave maker in olaflow can reliably simulate various simple water waves furthermore there is no the requirement for olaflow that a period of time is necessary for the wave profiles become stable like that in the physical model tests after olaflow starting to generate wave the wave height can steadily reach its expected value in short period finally the phenomenon of wave height attenuation and wave interference are both not observed in the numerical wave flume it is indicated that olaflow has efficiently and successfully absorbed the incident wave at the end boundary of numerical wave tank by setting the active wave absorption boundary condition 5 model verification for wave revetment breakwater calcareous coral foundation interaction although the numerical wave maker of olaflow has been tested in the cases without structures whether the computational model established based on olaflow for the wave revetment breakwater calcareous coral sand foundation interaction could reliably simulates the complicated interaction process still requires further verification the results obtained from the three physical model tests listed in table 4 are adopted to verify the established computational model in this section in order to perform the numerical simulation efficiently a super cluster huawei kunlun9016 is utilized there are totally 256 cpu cores have been used in parallelization the cpu type is intel xeon e7 4850 v4 and its frequency is 2 10 ghz the memory demand for tests 1 to test 3 are 3 2 gb 3 9 gb and 11 7 gb there are 370806 547579 and 4171577 elements in test 1 test2 and test 3 respectively for each case presented in this section the time spend for computation are 6 4 h for test 1 7 5 h for test 2 and 115 6 h for test 3 respectively 5 1 mesh generation in order to simulate the wave propagation process and the interaction between the wave and the structure effectively non uniform mesh system is used during the mesh generation in the established numerical model as it is shown in fig 4 the meshes near to the water air interface and around the structure are relatively dense while they are relatively loose in the other zone the revetment breakwater is not meshed as it is impervious concrete material the foundation of the revetment breakwater is porous medium thus it needs to be meshed considering the internal porous flow in it as listed in table 4 accropodes are utilized to dissipate the wave energy in test 3 the number of meshes will be very great probably up to hundreds of millions if the meshes around the accropodes are generated based on the configuration in the physical model tests furthermore it is quite difficult to perform the mesh generation operation as these accropodes are mutually contacted with each other therefore in order to simplify the computation and improve the computation efficiency the accropodes in the computation model are installed in the way shown in fig 5 only one row of accropodes is placed on the revetment breakwater in the cases without accropodes only two dimensional mesh is required nevertheless for those cases with accropodes three dimensional meshes must be generated the mesh generation is performed adopting the meshing tool utilities available in the openfoam library the generated meshes in the case with accropodes are shown in fig 6 the detailed information about the mesh size of the computational cells for test 1 test 2 and test 3 are listed in tables 6 8 5 2 comparative analysis for wave surfaces the comparison for the wave profiles between the numerical results and the test results recorded in test 1 low water level without accropode is illustrated in fig 7 w4 and w5 are located in the middle part of the wave flume which mainly are utilized to measure the ability of wave maker the wave profiles at w4 and w5 reach the expected wave height at the time of 10s and 8s respectively and maintain a good stability thereafter w2 is located over the zone of the triangular coral reef flat w3 is located at the beginning of the reef flat the wave profiles recorded by them are basically the same as that recorded by w4 and w5 however the wave profile at w2 is a little different due to the effect of the wave climbing on the sloping reef flat at the same time the wave crests become significantly sharper and the wave troughs get a little flatter showing obvious nonlinearity due to the shallow water depth in test 1 and w1 is located in front of the revetment there is no wave profile that can be recorded because no wave has arrived at there it is demonstrated in fig 7 that the computation results of the numerical model are in good agreement with the physical model tests results under the low water level without accropodes it is indicated that the numerical computation model has good reliability the comparison of the wave profiles between the numerical model results and the test results recorded in test 2 high water level without accropodes is demonstrated in fig 8 it is shown by the wave profile at w1 that the period between two main crests maintains about 2 2s additionally there are a series of secondary crests between two main crests the reason for this phenomenon is that w1 is located above the rubble mounds in front of the revetment significant reflection and superposition with the incident waves and wave breaking always occur at the position of w1 which certainly lead to a very irregular wave profile at w1 as a consequence of the high water level in test 2 the climbing effect of the wave at w2 is not particularly significant however there is still the phenomenon that the wave crests become sharper and the troughs get flatten at the same time the wave height at this position w2 has the trend of increasing which can reach about 40 cm as shown in fig 8 the computed wave profiles at w2 to w5 are basically consistent with the testing data from the physical model test for the case with high water level and without accropode w1 is located at the left end of the revetment and meanwhile at the right end of the rubble mound due to the wave reflection superposition and the energy dissipation of the rubble mounds the evolution of the wave profile at w1 is very complicated although the influence of the rubble mound is considered in the computation model and only one row of accropodes are set this is quite different from the real installment of the accropodes in the physical model therefore it is normal that there are some differences between the computed wave profiles and the testing results at the position w1 but it still can be seen in fig 8 that the computed and recorded wave profiles are quite similar it is indicated that the established numerical calculation model is credible the comparison of wave profiles between the numerical model results and the test results in test 3 high water level with accropodes is demonstrated in fig 9 generally compared with that in test 2 the wave profile at w1 is more regular since the wave energy is dissipated by the accropodes the retreating of waves from the revetment breakwater has little effect on the incident wave as a result the reflected wave does not cause much interference to the next incident wave after the wave breaking and hitting the breakwater in each period finally only a little fluctuation appears at each trough even though the mesh is relatively more complicated after the accropodes are added in the numerical computation model olaflow can still handle the simulation of wave generation wave breaking and porous flow very well the simulation result at w1 with a crest height of 20 cm is more stable than that of experimental data it happens due to the following several factors firstly the number of accropodes has been greatly reduced comparing with that in the physical model tests and the installment way also has been simplified secondly the width of the flume is reduced and the surface roughness is out of consideration that is to say the simulation environment in the computation model is relatively simple and ideal in general the computational results of wave profile at w1 are basically consistent with the testing results the simulated results at w2 to w5 also fit well with the testing results therefore in the case of high water level with accropodes the established numerical computation model in this study also has good reliability 5 3 comparative analysis of wave impact pressure in the physical model tests thirty two pressure sensors are uniformly installed on the revetment breakwater to record the impact of wave six pressure sensors named ps1 to ps6 at typical positions are taken as the representative to verify the computation model the specific position and serial number of the six pressure sensors are shown in fig 10 the outer diameter of the pressure sensors is 5 mm the measuring range is 10 kpa with a measuring accuracy of 0 25 the sampling frequency is 50 hz during testing as the water level is low in test 1 the revetment breakwater is not attacked by the waves therefore the comparative analysis of the impact pressure is not studied for test 1 the time history comparison of the wave impact between the numerical simulation results and the test results at the six typical positions on the revetment breakwater in test 2 high water level without accropodes is shown in fig 12 except for that recorded by ps1 the wave impact recorded by the other five pressure sensors all show a good periodicity ps1 is located at the left end of the revetment where the incident wave and reflected wave are superimposed violently the wave profile is greatly affected by the superposition so the time history of wave impact has great fluctuation ps2 and ps3 are located on the slope of the revetment the wave impact recorded by ps2 and ps3 are quite similar besides there are a great number of high frequency fluctuations on the crest and trough zones in the time history of wave impact ps4 is located at the right end of the revetment the time history of wave impact recorded by ps4 is basically the same as that recorded by ps2 and ps3 ps5 and ps6 are installed on the lateral side of the caisson wall to directly record the time history of wave impact on it it can be found that there is no obvious wave breaking on the slope of the revetment when the incident wave crests reaching the revetment breakwater however the wave crests climb along the sloping upper surface of the revetment and finally impact the lateral side of the caisson wall fiercely resulting in the severe breaking and wave overtopping as that shown in fig 11 the wave impact on the caisson wall recorded by ps5 and ps6 have the typical characteristics of impacting the impact of wave reaches its peak value which is up to 5 kpa in a short time when the wave is colliding with the caisson wall then the wave impact quickly reduces to the magnitude of 1 2 to 1 3 of the peak value and maintains for a period of time it finally reduces rapidly after the wave retreating but it does not completely reduce to 0 because there is more or less water accumulated in the holes where the pressure sensors are installed it is a fact that the shape and the random layout of these rubbles in front of the revetment can t be exactly simulated in computation moreover the surfaces of the reef flat and the revetment breakwater are smooth in the numerical modelling however they are actually rough in the physical model tests as a result the wave impact predicted by the numerical simulation is slightly greater than the testing value at each position the agreement on the time history of wave impact at ps1 between the numerical result and the recorded value in testing is not very well because the wave characteristics at ps1 is greatly affected by the rubbles in the physical model tests however it is difficult for the numerical model to handle this effect accurately it should be noticed that the numerical results are just slightly different with the testing results such as the peak impact pressure and the wave period besides the numerical model is successful in capturing the secondary peak value of the wave impact which is caused by the wave retreating this secondary peak value of the wave impact pressure is basically consistent with the wave profiles recorded in the physical model tests the computation results of the wave impact at ps2 and ps3 are as same as the results recorded in the physical tests what is quite different from the physical test results is that the impacting and retreating of the wave are relatively smooth in the numerical simulated results additionally there is no the high frequency fluctuation in the crest and trough zones along the time history of the wave impact predicted by the computational model because the surface of the revetment breakwater is approximately smooth in the geometry model for numerical modelling the time history characteristics of the wave impact on the caisson wall at ps5 and ps6 are also well simulated by the numerical model the comparison of the wave impact between the time history and the numerical simulation results is shown in fig 12 it is observed that the computation model can reliably determine the magnitude and the time history of the wave impact acting on the revetment breakwater under the condition of high water level without accropode the time history comparison of the wave impact between the numerical simulation results and the test results in test 3 at the six typical positions on the revetment breakwater high water level with accropodes are illustrated in fig 13 after these accropodes are installed the time history of the wave impact at the six positions all showcase a good periodicity it is quite different from that in test 2 as shown in fig 12 since these accropodes can effectively dissipate some wave energy there is no significant wave superposition and wave breaking at ps1 comparing with that in test 2 the time history of the wave impact at ps1 has a better periodicity and there is no obvious secondary peak the time history of the wave impact recorded by ps5 and ps6 on the caisson wall indicates that the energy dissipation effect of these accropodes is effective and considerable the peak of the wave impact is only about 2 kpa which is reduced by 60 relative to that in test 2 it is demonstrated in fig 13 that the computational results of the numerical model and the testing results recorded in the physical model tests are in good consistency it is indicated that the established numerical computational model has good reliability under the conditions of high water level with accropodes through the comparative analysis between the numerical results and the physical model tests results it is found that the numerical computational model established in this study for the interaction between ocean waves revetment breakwater and its calcareous coral sand foundation can reliably simulate the wave propagation reflection superposition breaking overtopping and the physical process of wave impacting on the revetment breakwater it will be a solid basis for the subsequent investigation of the dynamics characteristics of the revetment breakwater and the deformation of its calcareous coral foundation as well as the evaluation of stability of the revetment breakwater in the scs 6 conclusion taking the reclamation project in the scs as the engineering background a numerical computational model for wave revetment breakwater calcareous coral sand foundation interaction is established in this study taking the open source cfd solver olaflow as the computational platform a series of physical model tests are also conducted in a large wave flume adopting a geometric scale of 1 10 through the comparative analysis on the wave profiles and the time history of the wave impact acting on the revetment breakwater between the numerical results and the testing results it is found that the numerical computational model established for the interaction between ocean waves revetment breakwater and its coral sand foundation has good reliability this numerical verification work will be a solid basis not only for the subsequent investigation on the interaction between extreme ocean waves revetment breakwaters in the scs and their coral sand foundation at the practical engineering scale but also for the quantitative evaluation of the stability of the revetment breakwater in extreme typhoon climate in the scs credit authorship contribution statement jianhong ye conceptualization methodology writing review editing supervision project administration funding acquisition jipeng shan investigation formal analysis validation haoran zhou writing original draft writing review editing naixiao yan visualization writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is grateful for the funding support from national natural science foundation of china grant no 51879257 as well as the funding support from strategic priority research program of the chinese academy of sciences grant no xda13010202 
20464,the fluid structure interaction of a flexible plunging hydrofoil immersed in a current is solved numerically to analyze its propulsion enhancement due to flexibility at reynolds number 10 000 after validating with available experimental data the code is used to assess analytical predictions from a linear theory we consider large stiffness ratios with high thrust enhancement by flexibility and small mass ratios appropriate for underwater propulsion the maximum thrust enhancement is observed at the first natural frequency accurately predicted by the linear theory algebraically the magnitude of the maximum thrust is over predicted by the theory as the flapping amplitude increases for large strouhal numbers the flow becomes aperiodic which for large enough amplitudes happens at frequencies below the natural frequency but even at these strouhal numbers the linear theory predicts quite well the frequency of maximum thrust enhancement and optimal propulsive efficiency we conclude that the linear theory constitutes a reliable and useful guide for the design of underwater flexible flapping foil thrusters and we provide a practical chart to easily select the optimal flapping frequency as a function of the actuation point the stiffness and the mass ratios of the hydrofoil keywords flexible flapping foil propulsion fluid structure interaction nomenclature u nondimensional fluid velocity η propulsive efficiency ν poisson s ratio ω frequency ψ flexural deflection phase shift ρ fluid density ρ s solid density τ nondimensional stress tensor ε foil thickness a nondimensional pivot point location c chord length c l lift coefficient c m moment coefficient s thrust coefficient c l i input lift coefficient c m i input torque coefficient c p i input power coefficient d t nondimensional flexural deflection d m nondimensional flexural amplitude d t e nondimensional flexural amplitude at the trailing edge e elasticity modulus f frequency in hz h t nondimensional plunge motion h 0 nondimensional plunge amplitude i a nondimensional moment of inertia j a j d k d structural flexural coefficients k reduced frequency k r nondimensional natural frequency k r 0 nondimensional resonant frequency l i input lift m nondimensional foil mass m i input torque p nondimensional pressure r mass ratio r e reynolds number c t thrust coefficient s t stiffness ratio u freestream speed x 0 nondimensional center of mass z s x t nondimensional foil displacement 1 introduction the search for more efficient propellers for small underwater vehicles and more efficient energy harvesting devices based on flapping foils has accelerated in the last few years the interest in the study of the fluid structure interaction fsi of a flexible plate oscillating under water see e g anevlavi et al 2020 dagenais and aegerter 2020 goza et al 2020 manjunathan and bhardwaj 2020 wang et al 2020 demirer et al 2021 for very recent works and the recent review by wu et al 2020 the enhancement of the propulsive capabilities of passively deformable flapping foils over certain ranges of the structural and kinematic parameters has been analyzed and explained in a large number of works especially for the simplest configuration of a two dimensional 2d flapping foil with chordwise flexibility both theoretically and numerically for inviscid flows e g katz and weihs 1978 alben 2008 michelin and llewellyn smith 2009 moore 2014 paraz et al 2016 floryan and rowley 2018 and experimentally and numerically for viscous flows e g heathcote and gursul 2007 zhu 2007 shin et al 2009 dewey et al 2013 cleaver et al 2014 in most of these investigations the improvement in the propulsive performance has been related to resonance i e to peaks in the passive deflection amplitude when the forcing frequency of the oscillations is at or near the natural frequencies of the fluid foil system alben et al 2012 dewey et al 2013 quinn et al 2014 paraz et al 2016 floryan and rowley 2018 for relatively small forcing amplitudes the most relevant of these natural frequencies is the lowest one corresponding to the first mode flapping alben 2008 moore 2015 as the amplitude of the oscillations increases higher modes become more relevant or even resonance ceases to be the main enhancement mechanism in the propulsive performance of a deformable flapping foil ramananarivo et al 2011 alben et al 2012 quinn et al 2014 floryan and rowley 2018 goza et al 2020 for very small forcing amplitudes and high reynolds numbers one may solve approximately the 2d fsi problem combining the euler bernoulli beam equation with linear potential flow theory for a pitching and plunging foil with the passive flexural deflection approximated by a lower order polynomial fernandez feria and alaminos quesada 2021a only the first natural frequency is captured with this approximation but it is obtained analytically along with the thrust force and input power both peaking at or close to this natural frequency and hence the corresponding propulsive efficiency although it was shown in fernandez feria and alaminos quesada 2021a that these analytical results agree quite well with previous ones obtained numerically from a more complete linearized potential flow theory it remains to investigate to what extent the analytical results can be used to estimate the propulsive performance of actual flexible flapping foils as the flapping amplitude increases provided that the aspect ratio and the reynolds number are both large enough more particularly it is of great interest to know if the first natural frequency provided by the linear theory from just a simple algebraic equation can be used to predict the actuating frequency for optimal propulsive performance of a flexible plunging foil this is the problem analyzed in the present work for a 2d flexible plate undergoing a forced plunging motion at the leading edge at reynolds number 10 000 2 formulation of the problem we consider the fluid structure interaction of a two dimensional flexible foil immersed in a current of constant speed u along the x axis of an incompressible fluid and subjected to a prescribed heaving motion h t along the axis z perpendicular to the current u and imposed on an arbitrary pivot location a see sketch in fig 1 a tilde over any symbol means a dimensional quantity whose symbol is used later for its dimensionless counterpart without the tilde the chord length of the foil at rest is c the location of the foil centerline at any instant of time t is z s x t if s is the coordinate along it with c 2 s c 2 ρ s s ε s and e s i s are the hydrofoil density thickness and flexural rigidity respectively where e is young s elasticity modulus and i ε 3 12 the second moment of area this quantities are allowed to vary along the foil chord length so that for instance the foil center of mass x 0 does not necessarily coincide with its mid point s c 2 nor with the pivot axis s a however most of the numerical results reported below are for a uniform plate with constant density thickness and rigidity we assume a harmonic plunging motion of frequency ω and amplitude h 0 of the form h h 0 cos ω t this motion is produced by a force per unit length l i in the z direction which is computed as a part of the solution of the fsi problem in addition a torque m i per unit length has also to be applied at the pivot point to avoid rotation about this point through the fsi which is also computed as a part of the solution if needed it must be noted that although the location of the pivot point where the force l i is applied to generate the plunging motion is not relevant for a rigid foil it is for a flexible foil for the foil bending deflection would depend on the pivot point location and therefore the aerodynamic forces that the fluid exerts on the foil from this point on we use dimensionless variables and parameters most of them designated with the same letter but without the tilde by scaling all lengths with c 2 velocities with u so that time is scaled with c 2 u and forces per unit length with ρ u 2 c 2 where ρ is the fluid density thus the nondimensional plunging motion applied at s a 1 a 1 is 1 h t re h 0 e i k t k ω c 2 u where k is the standard reduced frequency and re means real part alternatively one may use the standard strouhal number 2 s t 2 h 0 f u h 0 k π where f is the frequency in hz in addition to h 0 a and k or s t other dimensionless parameters characterizing the problem are the mass ratio r the stiffness ratio s and the reynolds number r e defined as 3 r ρ s ε ρ c s e ε 3 ρ u 2 c 3 12 e i ρ u 2 c 3 r e ρ u c μ respectively where μ is the fluid viscosity note that r and s are in general functions of s once the fsi problem is solved as it will be described below one may compute the force f that the fluid exerts on the foil s surface which is decomposed in its thrust and lift components in dimensionless form 4 c t t f x 1 2 ρ u 2 c c l t f z 1 2 ρ u 2 c likewise one may compute the nondimensional input force l i applied at the pivot point to generate the prescribed heaving motion and therefore the input power coefficient 5 c l i t l i 1 2 ρ u 2 c c p i t c l i h where a dot means derivative with respect to the nondimensional time in the numerical simulations only the input power needed to overcome the fluid force on the foil i e c p i f c l h is computed which coincides with c p i for negligible inertia of the foil r 0 however both input powers are obtained from the linear theory analytically since the foil motion is periodic one is also interested in time averaged quantities over a nondimensional period t 2 π k which are denoted with an over bar e g 6 c t t t 2 π k c t t d t and similarly for c l c l i and c p i the propulsive froude efficiency is defined as 7 η c t c p i 3 numerical method the structural finite element analysis fea was performed with the cfd software fluent inside the ansys v20 2 package for multi physics applications specifically the fsi is performed by solving simultaneously the flow governing equation and the solid deformation by an intrinsic fsi algorithm thus the fluid and solid domains share a common interface with a conformal mesh i e each node of the interface is shared by the fluid and the structure and therefore it is not necessary to interpolate data the displacement of the solid domain results from the continuous forces generated by the fluid which are unknown a priori and are part of the computation in this two way fsi approach the fluid domain will deform in accordance with the displacements calculated on the solid domain of course the physics and the numerics involved on both sides of the fluid solid interface differ however it is necessary to ensure the continuity of the displacements and of the velocity as well as the equilibrium of stresses i e 8 u u s and τ n τ s n on s s x t where u and u s are the fluid and the solid nondimensional velocity fields respectively τ and τ s the corresponding stress tensors see below s s is the moving fluid solid interface with x and t the dimensionless position vector and time respectively and n the unit vector normal to this surface in the fluid side the code solves the incompressible navier stokes equations 9 u 0 u t u u τ τ p i 2 r e u u t where τ is the nondimensional stress tensor scaled with ρ u 2 with p the nondimensional pressure field and i the unit tensor for the structural equation of the solid but deformable body it is assumed linear isothermal and isotropic elasticity for the stress strain law e g long 1961 which in nondimensional form can be written as 10 ρ s ρ 2 χ t 2 τ s τ s s 1 2 χ χ t ν 1 2 ν χ i s e 1 ν ρ u 2 where χ s t x s t x s 0 is the displacement vector with x the position vector attached to the solid body defined in terms of the vector variable s that parametrizes the body ν is poisson s ratio and the time derivative is here a lagrangian derivative the nondimensional parameter s in cauchy s stress tensor τ s is related to the stiffness ratio s defined in 3 for a two dimensional thin foil in this last case one commonly simplifies the problem by using equations averaged across the small thickness of the foil ε so that s is reduced to just a scalar s that parametrizes the foil s centerline as described in section 2 above and the effect of poisson s ratio ν is negligible such bending beam approximation is used in section 5 below to derive analytical solutions of the euler bernoulli beam equation a linear approximation valid only for small displacements of the foil but it must be stressed that the numerical results obtained with eq 10 are valid for any arbitrary displacement of the foil provided that it behaves as an elastic solid governed by cauchy s stress law other nonlinear beam approximations to model the foil deflection can also be derived from eq 10 like for instance the nonlinear beam formulation used by olivier and dumas 2016 which is not limited to small deflections of the foil as the euler bernoulli beam equation eq 10 requires that boundary conditions be given in terms of displacement or in terms of force on the solid body surface s s in the present fsi simulation where the solid is in contact with a surrounding fluid continuous forces originating from the fluid are assigned as boundary conditions which must satisfy the conditions 8 to solve this equation numerically a finite element method is used where the structure is discretized as an assembly of discrete regions elements connected at a finite number of points or nodes in the present 2d case these elements are triangles or quadrilaterals with this discretization eq 10 is transformed into a system of linear algebraic equations for the displacements of the nodes χ i which can formally be written as 11 m χ t k χ t f t where m and k are the structural mass matrix and the stiffness matrix respectively while χ t and χ t are the vectors of nodal accelerations and displacements respectively f t is the applied load vector resulting from the external continuous or nodal forces applied on the boundary of the solid body in particular in the present fsi simulation they incorporate the forces originating from the fluid motion which are obtained by solving the flow eqs 9 simultaneously at each time step the additivity property allows the integration in eq 11 to be performed at the level of each individual element in order to obtain local mass and stiffness matrices which are subsequently assembled into the total mass and stiffness matrices of the linear system after this assembly is completed displacement boundary conditions such as those corresponding to the heaving motion at the pivot point are applied by removing the corresponding unknowns and equations from the system for numerically solving the finite element semi discrete equation of motion 11 the newmark method newmark 1959 available in fluent is used the method is unconditionally stable with any positive amplitude decay factor γ we use γ 0 2 we have enabled the implicit mesh update scheme during each time step with a motion relaxation parameter of 0 1 and residual criteria of 10 5 in both spatial directions to solve the incompressible and two dimensional flow around the body the governing eqs 9 are discretized and solved using also the finite volume based solver implemented in ansys fluent v20 2 transient pressure based coupled solver with absolute velocity formulation are the settings for the solution of all the numerical simulations the least squares cell based method is applied for calculating the gradients of the transport quantities on the faces of the cells the other spatial discretization methods in the simulations are second order for the pressure term and second order upwind for continuity and momentum equations the explicit relaxation factors of pressure and momentum are set at 0 75 to ensure the stability of the numerical method first order implicit formulation is applied for discretizing the temporal derivatives to ensure stability with coupling fsi at each time step the convergence was stopped once the absolute residuals values 10 3 and 10 5 for continuity and momentum quantities respectively were fulfilled the simulations are initialized with an unsteady solution with the body at rest the harmonic motion of the body at the pivot point was written in a user defined function udf which is a c program compiled in fluent for the dynamic mesh we used to smooth the mesh the boundary distance diffusion method with a diffusion parameter 1 75 the algebraic multi grid with the conjugate gradient for pre conditioning was used for stabilizing the dynamic mesh in parallel computing with 16 processors intel e5 2670 at 2 6 ghz 64 gb of ram memory and infiniband interconnection of 54 gbits per second each fsi case took around a week for the reynolds number 10 000 used in most of the computations reported in this work we find that the 2d flow remains laminar as also shown by olivier and dumas 2016 in a similar fsi problem solved numerically using the openfoam package see section 4 1 below for a comparison with some results from these authors 4 validation and grid convergence 4 1 validation with previous experimental numerical results to validate the numerical method developed for solving the fsi problem in ansys fluent we compare with experimental results by heathcote and gursul 2007 these authors used a teardrop flat plate design for the foil see fig 2 with chord c 90 mm and 300 mm span the plate was a sheet of steel of uniform thickness modulus of elasticity 2 05 1 0 11 n m 2 and length 2 c 3 the teardrop element with the remaining c 3 chord length was made of solid aluminum and a thickness of 10 mm so it behaved practically as a rigid body the flexibility of the plate was varied modifying its thickness ε in particular we consider here the case with ε c 0 56 1 0 3 the experiments were made in water at different reynolds numbers we select here the case r e 9 000 for which heathcote and gursul 2007 provide a larger variety of experimental results in our numerical simulations we select the same solid materials i e aluminum for the teardrop element and steel for the plate with thickness ε c 0 56 1 0 3 and chord length c 90 mm so it results u 0 1 m s and ε 0 25 mm see fig 3 a for a detail of the plate close to the teardrop junction the corresponding values of r and s for the flexible plate were r 0 0044 and s 3 57 finally an oscillatory heaving motion like 1 is imposed to the head of the foil with h 0 0 3889 i e h 0 17 5 mm and variable frequency the most detailed comparisons are made with a frequency corresponding to s t 0 34 the dimensions of the computational domain are see fig 2 h c 4 23 corresponding to the width of the water tunnel test section in heathcote and gursul 2007 l u 2 c upstream of the foil and l d 10 c downstream as shown by the grid convergence analysis described below these last two lengths are large enough to get very accurate results furthermore doubling these distances in the simulations did not show appreciable differences in the results but a computational time about 75 higher transient numerical simulations were made with three different structured grids of quadrilaterals cells mesh 0 coarse with 216 114 cells 150 in the tail and a time step δ t t 0 003 mesh 1 medium with 430 004 cells 212 in the tail see fig 3 and δ t t 0 0015 mesh 2 fine with 857 023 cells 300 in the tail and δ t t 0 00075 this grid refinement series has been constructed multiplying by 2 the number of cells in each spatial direction we kept the c f l number below 10 in all the numerical simulations the grid convergence study shows that with mesh 1 one already reaches mesh independency of the results see section 4 2 below it is worth noticing that the use of a fully structured mesh improves notably the convergence of the numerical results at each time step because the deformed grid remains structured as it can be observed in fig 3 b for t t 0 75 after a periodic solution has been reached as aforementioned the computations are started from the unsteady flow with the body at rest fig 4 compares our numerical results for the relative displacement between leading and trailing edges with the experimental results of heathcote and gursul 2007 the discrepancies with the experimental data is always smaller than 5 the figure also plots numerical results obtained by olivier and dumas 2016 for the same case using the openfoam package the deflection reaches a strictly periodic state with maximum deflection at t t 0 25 when the leading edge of the foil is at its lowest position and at t t 0 75 with the leading edge at the highest position shown in fig 3 b the corresponding flow is also periodic as shown by the computed pressure fields at these two instants of time within a cycle plotted in fig 5 finally fig 6 compares the time averaged thrust coefficients computed numerically with the present fsi numerical method for several values of the strouhal number for the same r e and h 0 but for a larger thickness and therefore stiffness of the plate ε c 4 23 1 0 3 with the experimental data by heathcote and gursul 2007 all the numerical results agree quite well with the experimental ones within the experimental uncertainty for reference sake we also include in fig 6 some results for a rigid plate at r e 10 000 se section 4 2 below for small strouhal numbers the results practically coincide with those of the flexible plate but as s t increases the thrust of the flexible plate becomes larger as expected 4 2 grid convergence analysis for a flexible flat plate the present numerical study about the fsi of a heaving hydrofoil is performed with a 2d flexible flat plate pivoting at the leading edge to that end we select a plate of chord length c 90 mm and thickness ε 0 4 mm for the prescribed heaving motion at the leading edge we include there a small circular head of radius 0 9 mm of the same material as the thin plate but with a hollow square region inside where the harmonic motion 1 is imposed through a udf in ansys fluent see fig 7 the size of the square size is 0 65 mm and the pivot point location is actually at a 0 98 instead of 1 we select the solid material properties such that r 0 05 and s 50 and the flow velocity and fluid properties for r e 10 000 since the chord length is the same as in the example considered above we use the same computational domain see fig 2 the grid convergence analysis is made with h 0 0 05 and two sufficiently high reduced frequencies k 5 and k 10 corresponding to s t 0 08 and s t 0 16 respectively we follow a similar procedure to that described above selecting three different structured grids of quadrilaterals cells mesh 0 coarse with 237 164 cells 300 in the plate with two cells across its thickness and a time step δ t t 0 002 mesh 1 medium with 470 298 cells 450 in the plate with three cells across its thickness see fig 7 and δ t t 0 001 mesh 2 fine with 952 646 cells 637 in the plate with four cells across its thickness and δ t t 0 0005 the c f l was less than 10 in all the numerical simulations fig 8 shows the position of the trailing edge as a function of time obtained numerically using the three different meshes for both values of k representing also the leading edge position for reference sake for the larger frequency k 10 the results are practically the same with the three different grids for k 5 which as it will be seen in section 6 below is close to the natural frequency of the fsi system for the present values of r s and a the results with the coarse grid mesh 0 present small discrepancies in relation to those from the finer grids but the results with meshes 1 and 2 are practically the same it must be noted that the trailing edge amplitude for k 5 is about three times that of the prescribed motion at the leading edge while for k 10 it is just slightly larger consequently with this grid convergence analysis we shall use mesh 1 for all the numerical computations reported below 5 analytical solution in the inviscid linear limit for a solid body of very small thickness ε if the amplitude of the prescribed heaving motion is small compared to the chord length h 0 1 and the stiffness of the foil is sufficiently large so that the chordwise deflection amplitude in relation to the rigid foil is also very small compared to c the thin foil may be considered to be on the plane z 0 in first approximation i e with the parameter s along the foil centerline coinciding with the coordinate x which extends from x 1 to x 1 if the effect of poisson s ratio is neglected thus the solid motion is just governed by the euler bernoulli beam equation which in the present dimensionless variables and for an inviscid fluid can be written as e g moore 2017 fernandez feria and alaminos quesada 2021a 12 2 r 2 z s t 2 2 3 2 x 2 s 2 z s x 2 δ p c l i δ x a 2 c m i δ x a where z s x t is the displacement in the z direction of the centerline of the foil δ p x t p x t p x t is the pressure difference between the lower and upper sides of the foil scaled with ρ u 2 as before to this distributed pressure force exerted on the foil by the moving fluid we have added to eq 12 a punctual force and a punctual moment actuating locally at the pivot point x a thus c l i t δ x a is the dimensionless force per unit span scaled with ρ u 2 c 2 that generates the prescribed heaving motion 1 where c l i has to be computed as a part of the solution of the present problem and where δ x a is dirac s delta function centered at x a on the other hand 2 c m i t δ x a is the torque per unit span scaled with ρ u 2 c 2 2 actuating locally at x a to avoid generating any pitching motion of the foil about the pivot point by the application of the punctual force c l i t δ x a where c m i has also to be computed as a part of the solution of the present problem and where δ x a is the derivative of dirac s delta function at x a note that the torque thus defined is positive when counterclockwise the dimensionless quantities r and s defined in 3 are in general functions of x through ρ s x ε x and e x we proceed as in fernandez feria and alaminos quesada 2021a by assuming the simplest flexural deflection z s x t that allows to relate it to the stiffness s of the foil which for constant s and in absence of pitching motion is given by a quartic polynomial such as 13 z s x t h t x a 2 d t x a 3 2 d t 3 1 a x a 4 d t 6 1 a 2 this displacement of the foil represents a heaving motion h t here prescribed at x a combined with a flexural deflection d t also about x a and with a free tailing edge 2 z s x 2 3 z s x 3 0 at x 1 with this minimal expression for the deflection of the foil one can obtain d t by just taking the first three moments of the euler bernoulli equation 12 which is obtained together with the force and torque c l i and c m i necessary to generate the forced heaving motion h t and to suppress any pitching motion about x a respectively for given r and s as shown in fernandez feria and alaminos quesada 2021a and obtained analytically below this lowest order approach for the flexural deflection of the foil captures almost exactly the first resonant frequency of the system but not the subsequent ones so that it is limited to frequencies below the second natural frequency of the system however as shown by alben 2008 the maximum possible thrust is always achieved by the flexible foil operating at or near the first natural mode so that it is the most relevant one from the point of view of the propulsive performance to capture higher resonant modes requires more terms in 13 than those considered here and the solution has to be obtained numerically e g paraz et al 2016 moore 2017 floryan and rowley 2018 tzezana and breuer 2019 thus substituting 13 into 12 and integrating between x 1 and x 1 and then integrating that equation multiplied by x a and by x a 2 one obtains the following three equations 14 m h j a d 16 3 1 a 2 s d c l c l i 15 m x 0 a h j d d 16 a 3 1 a 2 s d 2 c m c m i 16 i a h k d d 16 3 a 2 1 3 1 a 2 s d c f where the dots represent time derivatives in these expressions 17 c l t 1 1 δ p x t d x c m t 1 2 1 1 x a δ p x t d x c f t 1 1 x a 2 δ p x t d x are the dimensionless lift moment and flexural torque respectively exerted on the foil by the pressure forces of the surrounding fluid the location of the foil s center of mass x 0 the dimensionless mass m the dimensionless moment of inertia about x a i a and all the other dimensionless moments about the pivot point are defined as follows 18 m 2 1 1 r d x 4 r 19 m x 0 a 2 1 1 x a r d x 4 a r x 0 2 1 1 x r d x 20 i a 2 1 1 x a 2 r d x 4 r 1 3 a 2 21 j a 2 1 1 x a 2 2 3 x a 3 1 a x a 4 6 1 a 2 r d x 2 r a 2 2 3 a 1 3 16 15 1 a 2 22 i d 2 1 1 x a 3 r d x 4 r a 1 a 2 23 j d 2 1 1 x a 3 2 3 x a 4 1 a x a 5 6 1 a 2 r d x 2 r 12 93 a 60 a 2 110 a 3 120 a 4 45 a 5 45 1 a 2 24 k d 2 1 1 x a 4 2 3 x a 5 1 a x a 6 6 1 a 2 r d x 2 r 141 168 a 1281 a 2 1120 a 3 1015 a 4 840 a 5 315 a 6 315 1 a 2 where the expressions on the right most hand sides correspond to constant r i e when the center of mass coincides with the center of the foil x 0 0 for an harmonic motion of the foil like 1 applied at x a one may assume 25 d t re d m e i k t ψ where d m and ψ are the flexural deflection amplitude and phase shift in relation to the heaving motion respectively using these expressions of h t and d t in the motion of the foil 13 the coefficients c l t c m t and c f t have been obtained analytically in the linear inviscid limit for arbitrary values of h 0 d m ψ a and k in fernandez feria and alaminos quesada 2021b see also alaminos quesada and fernandez feria 2020 for a more complete description of the vortex impulse theory on which the derivation is based but using a quadratic polynomial for z s instead of 13 these expressions are summarized in appendix a for easy reference eq 16 together with the expression a 3 for c f and the kinematics given by 1 and 25 constitutes an algebraic equation for the flexural deflection amplitude d m and the phase shift ψ these quantities are obtained in terms of the heave amplitude h 0 the reduced frequency k the pivot and center of mass locations a and x 0 the stiffness and mass ratio of the foil s and r x once the flexural deflection has been obtained eqs 14 15 together with a 1 for c l and a 2 for c m yield the input lift c l i necessary to generate the prescribed heaving motion and therefore to compute the input power and the corresponding efficiency of the system and the input torque c m i necessary to avoid any pitching motion about x a from eq 16 the solution for the flexural deflection can formally be written as 26 d m h 0 b a ψ arg b a with 27 a k d k 2 16 3 a 2 1 3 1 a 2 s a f b i a k 2 b f where the superscript f refers to the contributions from the fluid structure interaction i e from c f using the expression a 3 for c f these contributions can be written as 28 a f π a f 2 k 2 a f 1 i k a f 0 c k 2 a 2 2 a 1 a g 1 i k a g 0 29 b f π a 2 1 4 k 2 π c k 2 a 2 2 a 1 i k where a f 0 a f 1 a f 2 a g 0 and a g 1 are functions of a defined in eqs a 8 a 10 in appendix a in absence of fluid structure interaction fsi i e assuming c f 0 30 d m h 0 i a k 2 16 a 2 1 3 3 1 a 2 s k d k 2 thus the corresponding first resonant frequency is 31 k r 0 16 a 2 1 3 s 3 1 a 2 k d 280 1 3 a 2 s 141 168 a 1281 a 2 1120 a 3 1015 a 4 840 a 5 315 a 6 r with the last expression valid for constant mass ratio r recovering the well known result that the dimensionless natural frequency of a flexible plate is proportional to s r e g floryan and rowley 2018 but now with an analytical expression for its dependence on the pivot point location in the present approximation for a pivot at the leading edge a 1 k r 0 35 s 142 r 0 496 s r recovering almost exactly the result for the first resonant frequency obtained numerically from a more general inviscid theory by floryan and rowley 2018 for a 1 when the fsi is taken into account the denominator a of 26 is not longer real and there is no proper resonant frequency at which d m becomes singular but there exists a frequency that maximizes the flexural deflection amplitude d m and therefore the thrust force see section 6 below for each set of dimensionless parameters since at this frequency k k r say which corresponds to the minimum value of a the maximum of d m is quite large it may still be called the first resonant or natural frequency of the system obviously this frequency tends to the resonant frequency k r 0 given above for r when the fsi becomes negligible this is shown in fig 9 where k r r s is plotted as a function of a for two values of s and three of r for r 10 k r that minimizes a almost coincide with k r 0 particularly for large s once d t d m e i k t ψ is obtained eq 14 yields the required input lift c l i and hence the input power coefficient 32 c p i t h t c l i t one can also obtain the propulsion coefficient c t t from the resulting flexural deflection motion and the prescribed heaving kinematics alaminos quesada and fernandez feria 2020 fernandez feria and alaminos quesada 2021b its time averaged value defined in eq 6 can be written as 33 c t k h 0 2 t h k k h 0 d m t d h k a ψ d m 2 t d k a with the functions t h k t d h k a ψ and t d k a obtained in fernandez feria and alaminos quesada 2021b and reproduced in appendix b for easy reference for d m 0 one recovers the mean thrust coefficient c t 0 of an otherwise identical rigid foil with the same plunging motion fernandez feria 2016 2017 finally to compute the propulsive froude efficiency 7 one also needs the time averaged input power coefficient which can be written as the sum of different contributions 34 c p i h c l i c p i 0 c p i d c p i m c p i s c p i 0 is the fsi contribution from the terms in c l associated to the heaving motion of the foil as a rigid solid 35 c p i 0 π k h 0 2 f k this contribution obviously coincides with theodorsen s power coefficient for a purely heaving motion of a rigid foil theodorsen 1935 garrick 1936 where f is the real and imaginary parts of theodorsen s function c given in eq a 5 the other contribution from the fsi associated to the flexural deflection motion of the foil i e from terms in c l containing d is 36 c p i d π k h 0 d m a l 2 k 2 2 a g 1 k g a g 0 f sin ψ a l 1 k 2 a g 1 k f a g 0 g cos ψ where a l 1 a l 2 a g 0 and a g 1 are functions of a defined in eqs a 6 a 10 in appendix a the term c p i m is the contribution from the inertia of the foil 37 c p i m k 3 h 0 2 j a d m sin ψ note that j a given by eq 21 depends on r and therefore on m while c p i s is the contribution from the stiffness of the foil 38 c p i s 8 s 3 1 a 2 k h 0 d m sin ψ 6 comparison between numerical and theoretical results one of the main objectives of this work is to compare the above analytical expressions with accurate numerical solutions of the full fsi problem to find out to what extent one can use the analytical predictions to characterize the propulsive performance of a heaving flexible foil numerical solutions are very expensive in computational time so that we consider only selected values of s r a and r e for a plate of uniform thickness and density and vary the frequency k and the heave amplitude h 0 or the strouhal number s t in particular the reported numerical results are for r e 10 000 and we select a relatively high value of the stiffness s 50 because the thrust amplification due to flexibility at or near the natural frequencies are more important when the stiffness is large enough alben 2008 dewey et al 2013 moore 2015 the selected value of the mass ratio is small r 0 05 of greater interest in swimming rather than in flying problems floryan and rowley 2018 the natural frequencies corresponding to these values of r and s are plotted in fig 10 as a function of the pivot point location a finally we force the heaving motion at the leading edge a 1 so that we use the foil configuration for which the grid convergence analysis has been made in section 4 2 for these values of r s and a the natural frequency k r 4 4 is well below the resonant frequency in vacuo k r 0 15 7 see fig 10 due to the smallness of the mass ratio r first we consider the trailing edge deflection which in the linear theory is given by 39 z t e t z s 1 t h t 1 a 2 2 d t fig 11 compares the maximum of the flexural deflection amplitude at the trailing edge in relation to the heaving motion at the leading edge i e 40 d t e m a x z t e t h t h 0 obtained from the linear theory with numerical results as the reduced frequency k is varied note that this quantity is obviously zero for a rigid foil from the linear theory d t e 1 a 2 d m h 0 and it is independent of the heave amplitude h 0 the numerical results are obtained for h 0 0 05 0 1 and 0 25 for sufficiently small amplitude h 0 this figure shows that the linear theory predicts quite accurately the frequency for the maximum deflection amplitude which roughly coincides with the natural frequency k r that minimizes a however the theory over predicts this maximum of d t e the more so the larger h 0 which was to be expected given its linearity note that the linear theory without fsi predicts a singularity of the flexural deflection amplitude at the resonant frequency see equation 30 fsi damps the singularity at this frequency but not enough since the theory is based on inviscid flow but it is remarkable that even for a high heave amplitude as h 0 0 25 the frequency for the first local maximum of d t e is still well predicted by the linear theory this is even more surprising considering that the flow ceases to remain periodic and becomes chaotic above a threshold frequency that decreases rapidly as h 0 increases this transition is characterized in fig 11 by a change in the symbols used for plotting the numerical results circles for periodic solutions and stars for chaotic solutions for the lower amplitudes h 0 0 05 and 0 1 this transition occurs at k larger than the natural frequency k r but for the largest amplitude h 0 0 25 the transition takes place at a value of k well below k r if one plots the results of fig 11 in terms of the strouhal number 2 see fig 12 all the transitions to chaotic solutions take place in a narrow range of s t between 0 15 and 0 25 approximately independently of the heave amplitude to better appreciate how the foil motion changes after these transitions fig 13 shows the temporal evolutions of the relative trailing edge amplitude z t e t h 0 for h 0 0 05 and four values of k 5 and 11 s t 0 08 and 0 175 yielding periodic oscillations and 12 and 17 s t 0 19 and 0 27 corresponding to chaotic solutions when the temporal evolutions are aperiodic the time averaged quantities represented in figs 11 and 12 and in all the other similar results reported below in this section are computed over the last ten cycles note in fig 13 that the trailing edge amplitude for k 5 is much larger than the rest since this frequency is very close to the natural frequency see fig 11 the different temporal evolutions in fig 13 are of course a consequence of the different flow patterns as depicted in fig 14 for k 5 and k 17 at selected instants of time the first case shows a spatiotemporal periodic structure associated to a mostly attached flow while in the second case the flow is no longer attached to the foil and becomes chaotic peaks in trailing edge deflection amplitude at roughly the natural frequencies produce maxima in the time averaged thrust coefficient as shown in fig 15 for the same cases considered in figs 11 and 12 the theoretical results are computed from 33 but subtracting a constant quasistatic drag c d 0 0 035 that corrects the inviscid results to account for viscous effects in a quite simple way see e g mackowski and williamson 2017 fernandez feria 2017 this viscous effect is relatively more relevant as k 0 where the theoretical c t vanishes without considering this quasistatic drag c t h 0 2 from the linear inviscid theory is independent of k shown as a dashed and dotted line in fig 15 a which practically coincide with the curve for h 0 0 25 since at that large amplitude the effect of c d 0 is negligible as c t scales as h o 2 similarly to the trailing edge deflection amplitude when h 0 is sufficiently small i e for h 0 0 05 and 0 1 in the present results the linear theory predicts remarkably well the natural frequency k r at which c t reaches the first local maximum but over predicting its magnitude the more so the larger the amplitude h 0 note also that the linear theory for c t fails for large k once the first resonant peak is passed since it only recovers the first natural mode the numerical results show that for these high values of k the flow becomes chaotic but even when h 0 is large enough so that this transition to an aperiodic flow occurs at lower frequencies than the first natural mode as in the present case with h 0 0 25 good theoretical predictions are found for k k r also shown in fig 15 a with dotted lines are the theoretical results for an otherwise identical rigid foil and marked with a diamond the numerical result for a rigid foil actually s 5 1 0 11 when h 0 0 05 and k 5 very close to the resonant frequency k r they are included to show the huge thrust enhancement due to flexibility at the natural frequency compare for instance the diamond with the gray circle for the same k actually the rigid foil at these flapping conditions h 0 0 05 and k 5 does not produce net thrust just drag this is more clearly appreciated with the temporal evolutions of c t shown in fig 16 a similar behavior is obtained for the time averaged input power coefficient fig 17 now numerical results only consider the input power associated to the fluid structure interaction while the theoretical expression 34 also includes the components of the input power associated to the inertia and stiffness of the foil thus in addition to the linear theory results given by eq 34 which are plotted in fig 17 as thin continuous lines we also plot the components associated only to the fsi i e 41 c p i f c p i 0 c p i d as dashed lines these last curves agree quite well with the numerical results up to the natural frequency even for the highest amplitude h 0 0 25 in spite of the fact that as aforementioned the flow becomes chaotic at much lower frequencies note however that the numerical results only present a clear maximum of the input power around the natural frequency for the lowest amplitude considered since the maxima in the thrust and input power are both roughly reached at the natural frequency it is not clear whether the froude efficiency 7 would present a maximum at this frequency or at some other frequency or indeed no distinguished local maximum at all fig 18 where we plot the propulsive efficiency corresponding to the thrust coefficients given in fig 15 and the input power coefficients given in figure 17 shows that the numerical results for η actually do present local maxima roughly at the natural frequency k 5 corresponding to s t 0 08 0 15 and 0 4 for h 0 0 05 0 1 and 0 25 respectively while the results from the linear theory do not except for the lowest amplitude h 0 0 05 for this h 0 the agreement between the linear theory considering only the part c p i f due to fsi as in the numerical computations and the numerical results for η is quite remarkable indeed however for the higher values of h 0 considered the linear theory provides just a good estimate of the maximum propulsive efficiency the maximum computed efficiency for h 0 0 05 is about 28 at s t 0 08 which practically coincide with the prediction from the linear theory it must be noted that for these flapping conditions the otherwise identical rigid foil does not produce net thrust and its efficiency is therefore negative shown in fig 18 with a diamond 7 conclusion accurate numerical results for the propulsive performance of a flexible plunging hydrofoil have been compared to the analytical predictions of linear theory both considering the fluid structure interaction in particular the theory yields the first natural frequency of the fluid foil system from just a simple algebraic equation the optimal propulsive performance obtained numerically both in terms of thrust enhancement in relation to an otherwise identical rigid foil and of propulsive efficiency occurs when the foil is operated at a frequency which is quite accurately predicted by the theoretical natural frequency even for plunging amplitudes which are not so small however the magnitude of the thrust force and efficiency are well predicted by the linear theory only for very small amplitudes as expected over estimating them as the amplitude increases therefore the natural frequency k r from the linear theory constitutes a simple and reliable estimation of the optimal frequency for underwater propellers based on flexible plunging hydrofoils a prediction that may reduce the number of costly numerical computations or expensive experiments k r is obtained by just minimizing a with a given by eq 27 from this equation fig 19 provides for instance a convenient chart to select the optimal actuating flapping frequency for a foil of any stiffness ratio s and mass ratio r actuated at the leading edge a 1 or for a foil with pivot point locations between the leading edge and the mid chord for a wide range of mass ratios and a given stiffness ratio credit authorship contribution statement e sanmiguel rojas data curation formal analysis funding acquisition investigation methodology project administration resources software validation visualization writing review editing r fernandez feria conceptualization formal analysis funding acquisition investigation methodology project administration software supervision validation visualization writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research has been supported by the junta de andalucía spain grants uma18 feder ja 047 and p18 fr 1532 and by the ministerio de ciencia e innovación of spain grant pid2019 104938rb i00 funding for open access charge universidad de málaga cbua the computations were performed in the picasso supercomputer at the university of málaga a node of the spanish supercomputing network appendix a lift moment and flexural coefficients from linear potential theory the following expressions for the coefficients corresponding to the quartic foil s deflection 13 are taken from fernandez feria and alaminos quesada 2021a but without passive pitching motion a 0 0 a 1 c l t π h a l 2 a d a l 1 a d c k γ 0 t a 2 c m t π 2 a h a m 2 a d a m 1 a d a m 0 a d 1 2 1 2 a c k γ 0 t a 3 c f t π a 2 1 4 h a f 2 a d a f 1 a d a f 0 a d 1 2 a a 2 c k γ 0 t where a 4 γ 0 t 2 π h a g 1 a d a g 0 a d is the quasi steady nondimensional circulation a 5 c k h 1 2 k i h 0 2 k h 1 2 k f k i g k is theodorsen s function theodorsen 1935 and h n 2 z j n z i y n z n 0 1 hankel s function of the second kind and order n related to the bessel functions of the first and second kind j n z and y n z olver et al 2010 and where the following functions of a have been defined a 6 a l 2 13 48 a 2 64 a 3 24 a 4 48 1 a 2 a l 1 3 12 a 12 a 2 4 a 3 6 1 a 2 a 7 a m 2 2 25 a 12 a 2 52 a 3 64 a 4 24 a 5 48 1 a 2 a m 1 9 12 a 72 a 2 56 a 3 16 a 4 24 1 a 2 a 8 a m 0 3 4 1 a 2 a f 2 35 32 a 392 a 2 320 a 3 496 a 4 512 a 5 192 a 6 384 1 a 2 a 9 a f 1 1 8 a 18 a 2 48 a 3 32 a 4 8 a 5 12 1 a 2 a f 0 7 18 a 12 1 a 2 a 10 a g 1 15 48 a 96 a 2 80 a 3 24 a 4 48 1 a 2 a g 0 3 24 a 24 a 2 8 a 3 12 1 a 2 appendix b functions for the theoretical time averaged thrust coefficient the functions t h k t d h k a ψ and t d k a appearing in the time averaged thrust coefficient 33 can be written as fernandez feria and alaminos quesada 2021b b 1 t h 2 g 1 b 2 t d h π a d 0 i k a d 1 r d g 2 a g 1 k 3 2 e j π g g 1 k 2 q f 1 g 1 k 2 π g 2 cos ψ π a d 0 r k a d 1 i d f 2 a f 1 k 3 2 e j f 1 k 2 π f q f 1 k 2 π f 2 g 1 sin ψ b 3 t d π 4 q k a d 0 i 2 a d 0 r 2 k a d 1 i k 2 a d 1 r 2 a g k d g k 2 f e j 3 f 9 g k 4 k 4 a 3 e 2 3 j 2 a d 0 i k a d 1 r g d 3 e 2 3 j 2 q 2 g k 2 f the following functions of the pivot point location a and the reduced frequency k are used b 4 q a 2 b a 2 d a 3 e a 3 j a b 5 a a a 2 1 2 a 3 1 a a 2 6 1 a 2 b a 2 a 1 a 1 a a 2 3 1 a 2 b 6 d a 1 2 a 1 a a 2 1 a 2 e a 2 3 1 a 1 a 1 a j a 1 6 1 a 2 f k and g k are the real and imaginary parts of theodorsen s function a 5 and likewise f 1 k and g 1 k in relation to the complex function b 7 c 1 k 1 k e i k i h 0 2 k h 1 2 k a d j r k a and a d j i k a j 0 1 are the real and imaginary parts of the functions b 8 a d 0 k a b g 0 d 1 2 g 1 k c k e 1 2 3 g 2 c 2 j 4 g 3 c 2 c 3 k b 9 a d 1 k a a g 0 b g 1 d g 2 e g 3 i 2 k c j g 4 c 2 2 k with b 10 c 2 k h 2 2 k i h 0 2 h 1 2 k c 3 k y 0 k i j 2 k i h 1 1 k i h 0 2 h 1 2 k b 11 g 0 k 2 i π c 1 k g 1 k 2 π k 1 i k c 1 k i k c k g 2 k 1 k c 2 k 2 i k 2 2 i k k c 1 k b 12 g 3 k 3 y 2 k k y 1 k i j 3 k i j 2 k k 2 i h 0 2 h 1 2 k 6 π k 1 i k 2 k 2 1 c 1 k b 13 g 4 k 1 i h 0 2 h 1 2 k 1 k 2 k j 4 k 3 j 3 k i k 4 g 1 3 2 0 k 2 4 3 2 3 0 1 2 2 π 24 k 4 k i 4 k 2 k 3 i i c 1 k where j ν and y ν are the bessel functions of the first and second kind respectively of order ν and g p q m n z a p b q the meijer g function olver et al 2010 
20464,the fluid structure interaction of a flexible plunging hydrofoil immersed in a current is solved numerically to analyze its propulsion enhancement due to flexibility at reynolds number 10 000 after validating with available experimental data the code is used to assess analytical predictions from a linear theory we consider large stiffness ratios with high thrust enhancement by flexibility and small mass ratios appropriate for underwater propulsion the maximum thrust enhancement is observed at the first natural frequency accurately predicted by the linear theory algebraically the magnitude of the maximum thrust is over predicted by the theory as the flapping amplitude increases for large strouhal numbers the flow becomes aperiodic which for large enough amplitudes happens at frequencies below the natural frequency but even at these strouhal numbers the linear theory predicts quite well the frequency of maximum thrust enhancement and optimal propulsive efficiency we conclude that the linear theory constitutes a reliable and useful guide for the design of underwater flexible flapping foil thrusters and we provide a practical chart to easily select the optimal flapping frequency as a function of the actuation point the stiffness and the mass ratios of the hydrofoil keywords flexible flapping foil propulsion fluid structure interaction nomenclature u nondimensional fluid velocity η propulsive efficiency ν poisson s ratio ω frequency ψ flexural deflection phase shift ρ fluid density ρ s solid density τ nondimensional stress tensor ε foil thickness a nondimensional pivot point location c chord length c l lift coefficient c m moment coefficient s thrust coefficient c l i input lift coefficient c m i input torque coefficient c p i input power coefficient d t nondimensional flexural deflection d m nondimensional flexural amplitude d t e nondimensional flexural amplitude at the trailing edge e elasticity modulus f frequency in hz h t nondimensional plunge motion h 0 nondimensional plunge amplitude i a nondimensional moment of inertia j a j d k d structural flexural coefficients k reduced frequency k r nondimensional natural frequency k r 0 nondimensional resonant frequency l i input lift m nondimensional foil mass m i input torque p nondimensional pressure r mass ratio r e reynolds number c t thrust coefficient s t stiffness ratio u freestream speed x 0 nondimensional center of mass z s x t nondimensional foil displacement 1 introduction the search for more efficient propellers for small underwater vehicles and more efficient energy harvesting devices based on flapping foils has accelerated in the last few years the interest in the study of the fluid structure interaction fsi of a flexible plate oscillating under water see e g anevlavi et al 2020 dagenais and aegerter 2020 goza et al 2020 manjunathan and bhardwaj 2020 wang et al 2020 demirer et al 2021 for very recent works and the recent review by wu et al 2020 the enhancement of the propulsive capabilities of passively deformable flapping foils over certain ranges of the structural and kinematic parameters has been analyzed and explained in a large number of works especially for the simplest configuration of a two dimensional 2d flapping foil with chordwise flexibility both theoretically and numerically for inviscid flows e g katz and weihs 1978 alben 2008 michelin and llewellyn smith 2009 moore 2014 paraz et al 2016 floryan and rowley 2018 and experimentally and numerically for viscous flows e g heathcote and gursul 2007 zhu 2007 shin et al 2009 dewey et al 2013 cleaver et al 2014 in most of these investigations the improvement in the propulsive performance has been related to resonance i e to peaks in the passive deflection amplitude when the forcing frequency of the oscillations is at or near the natural frequencies of the fluid foil system alben et al 2012 dewey et al 2013 quinn et al 2014 paraz et al 2016 floryan and rowley 2018 for relatively small forcing amplitudes the most relevant of these natural frequencies is the lowest one corresponding to the first mode flapping alben 2008 moore 2015 as the amplitude of the oscillations increases higher modes become more relevant or even resonance ceases to be the main enhancement mechanism in the propulsive performance of a deformable flapping foil ramananarivo et al 2011 alben et al 2012 quinn et al 2014 floryan and rowley 2018 goza et al 2020 for very small forcing amplitudes and high reynolds numbers one may solve approximately the 2d fsi problem combining the euler bernoulli beam equation with linear potential flow theory for a pitching and plunging foil with the passive flexural deflection approximated by a lower order polynomial fernandez feria and alaminos quesada 2021a only the first natural frequency is captured with this approximation but it is obtained analytically along with the thrust force and input power both peaking at or close to this natural frequency and hence the corresponding propulsive efficiency although it was shown in fernandez feria and alaminos quesada 2021a that these analytical results agree quite well with previous ones obtained numerically from a more complete linearized potential flow theory it remains to investigate to what extent the analytical results can be used to estimate the propulsive performance of actual flexible flapping foils as the flapping amplitude increases provided that the aspect ratio and the reynolds number are both large enough more particularly it is of great interest to know if the first natural frequency provided by the linear theory from just a simple algebraic equation can be used to predict the actuating frequency for optimal propulsive performance of a flexible plunging foil this is the problem analyzed in the present work for a 2d flexible plate undergoing a forced plunging motion at the leading edge at reynolds number 10 000 2 formulation of the problem we consider the fluid structure interaction of a two dimensional flexible foil immersed in a current of constant speed u along the x axis of an incompressible fluid and subjected to a prescribed heaving motion h t along the axis z perpendicular to the current u and imposed on an arbitrary pivot location a see sketch in fig 1 a tilde over any symbol means a dimensional quantity whose symbol is used later for its dimensionless counterpart without the tilde the chord length of the foil at rest is c the location of the foil centerline at any instant of time t is z s x t if s is the coordinate along it with c 2 s c 2 ρ s s ε s and e s i s are the hydrofoil density thickness and flexural rigidity respectively where e is young s elasticity modulus and i ε 3 12 the second moment of area this quantities are allowed to vary along the foil chord length so that for instance the foil center of mass x 0 does not necessarily coincide with its mid point s c 2 nor with the pivot axis s a however most of the numerical results reported below are for a uniform plate with constant density thickness and rigidity we assume a harmonic plunging motion of frequency ω and amplitude h 0 of the form h h 0 cos ω t this motion is produced by a force per unit length l i in the z direction which is computed as a part of the solution of the fsi problem in addition a torque m i per unit length has also to be applied at the pivot point to avoid rotation about this point through the fsi which is also computed as a part of the solution if needed it must be noted that although the location of the pivot point where the force l i is applied to generate the plunging motion is not relevant for a rigid foil it is for a flexible foil for the foil bending deflection would depend on the pivot point location and therefore the aerodynamic forces that the fluid exerts on the foil from this point on we use dimensionless variables and parameters most of them designated with the same letter but without the tilde by scaling all lengths with c 2 velocities with u so that time is scaled with c 2 u and forces per unit length with ρ u 2 c 2 where ρ is the fluid density thus the nondimensional plunging motion applied at s a 1 a 1 is 1 h t re h 0 e i k t k ω c 2 u where k is the standard reduced frequency and re means real part alternatively one may use the standard strouhal number 2 s t 2 h 0 f u h 0 k π where f is the frequency in hz in addition to h 0 a and k or s t other dimensionless parameters characterizing the problem are the mass ratio r the stiffness ratio s and the reynolds number r e defined as 3 r ρ s ε ρ c s e ε 3 ρ u 2 c 3 12 e i ρ u 2 c 3 r e ρ u c μ respectively where μ is the fluid viscosity note that r and s are in general functions of s once the fsi problem is solved as it will be described below one may compute the force f that the fluid exerts on the foil s surface which is decomposed in its thrust and lift components in dimensionless form 4 c t t f x 1 2 ρ u 2 c c l t f z 1 2 ρ u 2 c likewise one may compute the nondimensional input force l i applied at the pivot point to generate the prescribed heaving motion and therefore the input power coefficient 5 c l i t l i 1 2 ρ u 2 c c p i t c l i h where a dot means derivative with respect to the nondimensional time in the numerical simulations only the input power needed to overcome the fluid force on the foil i e c p i f c l h is computed which coincides with c p i for negligible inertia of the foil r 0 however both input powers are obtained from the linear theory analytically since the foil motion is periodic one is also interested in time averaged quantities over a nondimensional period t 2 π k which are denoted with an over bar e g 6 c t t t 2 π k c t t d t and similarly for c l c l i and c p i the propulsive froude efficiency is defined as 7 η c t c p i 3 numerical method the structural finite element analysis fea was performed with the cfd software fluent inside the ansys v20 2 package for multi physics applications specifically the fsi is performed by solving simultaneously the flow governing equation and the solid deformation by an intrinsic fsi algorithm thus the fluid and solid domains share a common interface with a conformal mesh i e each node of the interface is shared by the fluid and the structure and therefore it is not necessary to interpolate data the displacement of the solid domain results from the continuous forces generated by the fluid which are unknown a priori and are part of the computation in this two way fsi approach the fluid domain will deform in accordance with the displacements calculated on the solid domain of course the physics and the numerics involved on both sides of the fluid solid interface differ however it is necessary to ensure the continuity of the displacements and of the velocity as well as the equilibrium of stresses i e 8 u u s and τ n τ s n on s s x t where u and u s are the fluid and the solid nondimensional velocity fields respectively τ and τ s the corresponding stress tensors see below s s is the moving fluid solid interface with x and t the dimensionless position vector and time respectively and n the unit vector normal to this surface in the fluid side the code solves the incompressible navier stokes equations 9 u 0 u t u u τ τ p i 2 r e u u t where τ is the nondimensional stress tensor scaled with ρ u 2 with p the nondimensional pressure field and i the unit tensor for the structural equation of the solid but deformable body it is assumed linear isothermal and isotropic elasticity for the stress strain law e g long 1961 which in nondimensional form can be written as 10 ρ s ρ 2 χ t 2 τ s τ s s 1 2 χ χ t ν 1 2 ν χ i s e 1 ν ρ u 2 where χ s t x s t x s 0 is the displacement vector with x the position vector attached to the solid body defined in terms of the vector variable s that parametrizes the body ν is poisson s ratio and the time derivative is here a lagrangian derivative the nondimensional parameter s in cauchy s stress tensor τ s is related to the stiffness ratio s defined in 3 for a two dimensional thin foil in this last case one commonly simplifies the problem by using equations averaged across the small thickness of the foil ε so that s is reduced to just a scalar s that parametrizes the foil s centerline as described in section 2 above and the effect of poisson s ratio ν is negligible such bending beam approximation is used in section 5 below to derive analytical solutions of the euler bernoulli beam equation a linear approximation valid only for small displacements of the foil but it must be stressed that the numerical results obtained with eq 10 are valid for any arbitrary displacement of the foil provided that it behaves as an elastic solid governed by cauchy s stress law other nonlinear beam approximations to model the foil deflection can also be derived from eq 10 like for instance the nonlinear beam formulation used by olivier and dumas 2016 which is not limited to small deflections of the foil as the euler bernoulli beam equation eq 10 requires that boundary conditions be given in terms of displacement or in terms of force on the solid body surface s s in the present fsi simulation where the solid is in contact with a surrounding fluid continuous forces originating from the fluid are assigned as boundary conditions which must satisfy the conditions 8 to solve this equation numerically a finite element method is used where the structure is discretized as an assembly of discrete regions elements connected at a finite number of points or nodes in the present 2d case these elements are triangles or quadrilaterals with this discretization eq 10 is transformed into a system of linear algebraic equations for the displacements of the nodes χ i which can formally be written as 11 m χ t k χ t f t where m and k are the structural mass matrix and the stiffness matrix respectively while χ t and χ t are the vectors of nodal accelerations and displacements respectively f t is the applied load vector resulting from the external continuous or nodal forces applied on the boundary of the solid body in particular in the present fsi simulation they incorporate the forces originating from the fluid motion which are obtained by solving the flow eqs 9 simultaneously at each time step the additivity property allows the integration in eq 11 to be performed at the level of each individual element in order to obtain local mass and stiffness matrices which are subsequently assembled into the total mass and stiffness matrices of the linear system after this assembly is completed displacement boundary conditions such as those corresponding to the heaving motion at the pivot point are applied by removing the corresponding unknowns and equations from the system for numerically solving the finite element semi discrete equation of motion 11 the newmark method newmark 1959 available in fluent is used the method is unconditionally stable with any positive amplitude decay factor γ we use γ 0 2 we have enabled the implicit mesh update scheme during each time step with a motion relaxation parameter of 0 1 and residual criteria of 10 5 in both spatial directions to solve the incompressible and two dimensional flow around the body the governing eqs 9 are discretized and solved using also the finite volume based solver implemented in ansys fluent v20 2 transient pressure based coupled solver with absolute velocity formulation are the settings for the solution of all the numerical simulations the least squares cell based method is applied for calculating the gradients of the transport quantities on the faces of the cells the other spatial discretization methods in the simulations are second order for the pressure term and second order upwind for continuity and momentum equations the explicit relaxation factors of pressure and momentum are set at 0 75 to ensure the stability of the numerical method first order implicit formulation is applied for discretizing the temporal derivatives to ensure stability with coupling fsi at each time step the convergence was stopped once the absolute residuals values 10 3 and 10 5 for continuity and momentum quantities respectively were fulfilled the simulations are initialized with an unsteady solution with the body at rest the harmonic motion of the body at the pivot point was written in a user defined function udf which is a c program compiled in fluent for the dynamic mesh we used to smooth the mesh the boundary distance diffusion method with a diffusion parameter 1 75 the algebraic multi grid with the conjugate gradient for pre conditioning was used for stabilizing the dynamic mesh in parallel computing with 16 processors intel e5 2670 at 2 6 ghz 64 gb of ram memory and infiniband interconnection of 54 gbits per second each fsi case took around a week for the reynolds number 10 000 used in most of the computations reported in this work we find that the 2d flow remains laminar as also shown by olivier and dumas 2016 in a similar fsi problem solved numerically using the openfoam package see section 4 1 below for a comparison with some results from these authors 4 validation and grid convergence 4 1 validation with previous experimental numerical results to validate the numerical method developed for solving the fsi problem in ansys fluent we compare with experimental results by heathcote and gursul 2007 these authors used a teardrop flat plate design for the foil see fig 2 with chord c 90 mm and 300 mm span the plate was a sheet of steel of uniform thickness modulus of elasticity 2 05 1 0 11 n m 2 and length 2 c 3 the teardrop element with the remaining c 3 chord length was made of solid aluminum and a thickness of 10 mm so it behaved practically as a rigid body the flexibility of the plate was varied modifying its thickness ε in particular we consider here the case with ε c 0 56 1 0 3 the experiments were made in water at different reynolds numbers we select here the case r e 9 000 for which heathcote and gursul 2007 provide a larger variety of experimental results in our numerical simulations we select the same solid materials i e aluminum for the teardrop element and steel for the plate with thickness ε c 0 56 1 0 3 and chord length c 90 mm so it results u 0 1 m s and ε 0 25 mm see fig 3 a for a detail of the plate close to the teardrop junction the corresponding values of r and s for the flexible plate were r 0 0044 and s 3 57 finally an oscillatory heaving motion like 1 is imposed to the head of the foil with h 0 0 3889 i e h 0 17 5 mm and variable frequency the most detailed comparisons are made with a frequency corresponding to s t 0 34 the dimensions of the computational domain are see fig 2 h c 4 23 corresponding to the width of the water tunnel test section in heathcote and gursul 2007 l u 2 c upstream of the foil and l d 10 c downstream as shown by the grid convergence analysis described below these last two lengths are large enough to get very accurate results furthermore doubling these distances in the simulations did not show appreciable differences in the results but a computational time about 75 higher transient numerical simulations were made with three different structured grids of quadrilaterals cells mesh 0 coarse with 216 114 cells 150 in the tail and a time step δ t t 0 003 mesh 1 medium with 430 004 cells 212 in the tail see fig 3 and δ t t 0 0015 mesh 2 fine with 857 023 cells 300 in the tail and δ t t 0 00075 this grid refinement series has been constructed multiplying by 2 the number of cells in each spatial direction we kept the c f l number below 10 in all the numerical simulations the grid convergence study shows that with mesh 1 one already reaches mesh independency of the results see section 4 2 below it is worth noticing that the use of a fully structured mesh improves notably the convergence of the numerical results at each time step because the deformed grid remains structured as it can be observed in fig 3 b for t t 0 75 after a periodic solution has been reached as aforementioned the computations are started from the unsteady flow with the body at rest fig 4 compares our numerical results for the relative displacement between leading and trailing edges with the experimental results of heathcote and gursul 2007 the discrepancies with the experimental data is always smaller than 5 the figure also plots numerical results obtained by olivier and dumas 2016 for the same case using the openfoam package the deflection reaches a strictly periodic state with maximum deflection at t t 0 25 when the leading edge of the foil is at its lowest position and at t t 0 75 with the leading edge at the highest position shown in fig 3 b the corresponding flow is also periodic as shown by the computed pressure fields at these two instants of time within a cycle plotted in fig 5 finally fig 6 compares the time averaged thrust coefficients computed numerically with the present fsi numerical method for several values of the strouhal number for the same r e and h 0 but for a larger thickness and therefore stiffness of the plate ε c 4 23 1 0 3 with the experimental data by heathcote and gursul 2007 all the numerical results agree quite well with the experimental ones within the experimental uncertainty for reference sake we also include in fig 6 some results for a rigid plate at r e 10 000 se section 4 2 below for small strouhal numbers the results practically coincide with those of the flexible plate but as s t increases the thrust of the flexible plate becomes larger as expected 4 2 grid convergence analysis for a flexible flat plate the present numerical study about the fsi of a heaving hydrofoil is performed with a 2d flexible flat plate pivoting at the leading edge to that end we select a plate of chord length c 90 mm and thickness ε 0 4 mm for the prescribed heaving motion at the leading edge we include there a small circular head of radius 0 9 mm of the same material as the thin plate but with a hollow square region inside where the harmonic motion 1 is imposed through a udf in ansys fluent see fig 7 the size of the square size is 0 65 mm and the pivot point location is actually at a 0 98 instead of 1 we select the solid material properties such that r 0 05 and s 50 and the flow velocity and fluid properties for r e 10 000 since the chord length is the same as in the example considered above we use the same computational domain see fig 2 the grid convergence analysis is made with h 0 0 05 and two sufficiently high reduced frequencies k 5 and k 10 corresponding to s t 0 08 and s t 0 16 respectively we follow a similar procedure to that described above selecting three different structured grids of quadrilaterals cells mesh 0 coarse with 237 164 cells 300 in the plate with two cells across its thickness and a time step δ t t 0 002 mesh 1 medium with 470 298 cells 450 in the plate with three cells across its thickness see fig 7 and δ t t 0 001 mesh 2 fine with 952 646 cells 637 in the plate with four cells across its thickness and δ t t 0 0005 the c f l was less than 10 in all the numerical simulations fig 8 shows the position of the trailing edge as a function of time obtained numerically using the three different meshes for both values of k representing also the leading edge position for reference sake for the larger frequency k 10 the results are practically the same with the three different grids for k 5 which as it will be seen in section 6 below is close to the natural frequency of the fsi system for the present values of r s and a the results with the coarse grid mesh 0 present small discrepancies in relation to those from the finer grids but the results with meshes 1 and 2 are practically the same it must be noted that the trailing edge amplitude for k 5 is about three times that of the prescribed motion at the leading edge while for k 10 it is just slightly larger consequently with this grid convergence analysis we shall use mesh 1 for all the numerical computations reported below 5 analytical solution in the inviscid linear limit for a solid body of very small thickness ε if the amplitude of the prescribed heaving motion is small compared to the chord length h 0 1 and the stiffness of the foil is sufficiently large so that the chordwise deflection amplitude in relation to the rigid foil is also very small compared to c the thin foil may be considered to be on the plane z 0 in first approximation i e with the parameter s along the foil centerline coinciding with the coordinate x which extends from x 1 to x 1 if the effect of poisson s ratio is neglected thus the solid motion is just governed by the euler bernoulli beam equation which in the present dimensionless variables and for an inviscid fluid can be written as e g moore 2017 fernandez feria and alaminos quesada 2021a 12 2 r 2 z s t 2 2 3 2 x 2 s 2 z s x 2 δ p c l i δ x a 2 c m i δ x a where z s x t is the displacement in the z direction of the centerline of the foil δ p x t p x t p x t is the pressure difference between the lower and upper sides of the foil scaled with ρ u 2 as before to this distributed pressure force exerted on the foil by the moving fluid we have added to eq 12 a punctual force and a punctual moment actuating locally at the pivot point x a thus c l i t δ x a is the dimensionless force per unit span scaled with ρ u 2 c 2 that generates the prescribed heaving motion 1 where c l i has to be computed as a part of the solution of the present problem and where δ x a is dirac s delta function centered at x a on the other hand 2 c m i t δ x a is the torque per unit span scaled with ρ u 2 c 2 2 actuating locally at x a to avoid generating any pitching motion of the foil about the pivot point by the application of the punctual force c l i t δ x a where c m i has also to be computed as a part of the solution of the present problem and where δ x a is the derivative of dirac s delta function at x a note that the torque thus defined is positive when counterclockwise the dimensionless quantities r and s defined in 3 are in general functions of x through ρ s x ε x and e x we proceed as in fernandez feria and alaminos quesada 2021a by assuming the simplest flexural deflection z s x t that allows to relate it to the stiffness s of the foil which for constant s and in absence of pitching motion is given by a quartic polynomial such as 13 z s x t h t x a 2 d t x a 3 2 d t 3 1 a x a 4 d t 6 1 a 2 this displacement of the foil represents a heaving motion h t here prescribed at x a combined with a flexural deflection d t also about x a and with a free tailing edge 2 z s x 2 3 z s x 3 0 at x 1 with this minimal expression for the deflection of the foil one can obtain d t by just taking the first three moments of the euler bernoulli equation 12 which is obtained together with the force and torque c l i and c m i necessary to generate the forced heaving motion h t and to suppress any pitching motion about x a respectively for given r and s as shown in fernandez feria and alaminos quesada 2021a and obtained analytically below this lowest order approach for the flexural deflection of the foil captures almost exactly the first resonant frequency of the system but not the subsequent ones so that it is limited to frequencies below the second natural frequency of the system however as shown by alben 2008 the maximum possible thrust is always achieved by the flexible foil operating at or near the first natural mode so that it is the most relevant one from the point of view of the propulsive performance to capture higher resonant modes requires more terms in 13 than those considered here and the solution has to be obtained numerically e g paraz et al 2016 moore 2017 floryan and rowley 2018 tzezana and breuer 2019 thus substituting 13 into 12 and integrating between x 1 and x 1 and then integrating that equation multiplied by x a and by x a 2 one obtains the following three equations 14 m h j a d 16 3 1 a 2 s d c l c l i 15 m x 0 a h j d d 16 a 3 1 a 2 s d 2 c m c m i 16 i a h k d d 16 3 a 2 1 3 1 a 2 s d c f where the dots represent time derivatives in these expressions 17 c l t 1 1 δ p x t d x c m t 1 2 1 1 x a δ p x t d x c f t 1 1 x a 2 δ p x t d x are the dimensionless lift moment and flexural torque respectively exerted on the foil by the pressure forces of the surrounding fluid the location of the foil s center of mass x 0 the dimensionless mass m the dimensionless moment of inertia about x a i a and all the other dimensionless moments about the pivot point are defined as follows 18 m 2 1 1 r d x 4 r 19 m x 0 a 2 1 1 x a r d x 4 a r x 0 2 1 1 x r d x 20 i a 2 1 1 x a 2 r d x 4 r 1 3 a 2 21 j a 2 1 1 x a 2 2 3 x a 3 1 a x a 4 6 1 a 2 r d x 2 r a 2 2 3 a 1 3 16 15 1 a 2 22 i d 2 1 1 x a 3 r d x 4 r a 1 a 2 23 j d 2 1 1 x a 3 2 3 x a 4 1 a x a 5 6 1 a 2 r d x 2 r 12 93 a 60 a 2 110 a 3 120 a 4 45 a 5 45 1 a 2 24 k d 2 1 1 x a 4 2 3 x a 5 1 a x a 6 6 1 a 2 r d x 2 r 141 168 a 1281 a 2 1120 a 3 1015 a 4 840 a 5 315 a 6 315 1 a 2 where the expressions on the right most hand sides correspond to constant r i e when the center of mass coincides with the center of the foil x 0 0 for an harmonic motion of the foil like 1 applied at x a one may assume 25 d t re d m e i k t ψ where d m and ψ are the flexural deflection amplitude and phase shift in relation to the heaving motion respectively using these expressions of h t and d t in the motion of the foil 13 the coefficients c l t c m t and c f t have been obtained analytically in the linear inviscid limit for arbitrary values of h 0 d m ψ a and k in fernandez feria and alaminos quesada 2021b see also alaminos quesada and fernandez feria 2020 for a more complete description of the vortex impulse theory on which the derivation is based but using a quadratic polynomial for z s instead of 13 these expressions are summarized in appendix a for easy reference eq 16 together with the expression a 3 for c f and the kinematics given by 1 and 25 constitutes an algebraic equation for the flexural deflection amplitude d m and the phase shift ψ these quantities are obtained in terms of the heave amplitude h 0 the reduced frequency k the pivot and center of mass locations a and x 0 the stiffness and mass ratio of the foil s and r x once the flexural deflection has been obtained eqs 14 15 together with a 1 for c l and a 2 for c m yield the input lift c l i necessary to generate the prescribed heaving motion and therefore to compute the input power and the corresponding efficiency of the system and the input torque c m i necessary to avoid any pitching motion about x a from eq 16 the solution for the flexural deflection can formally be written as 26 d m h 0 b a ψ arg b a with 27 a k d k 2 16 3 a 2 1 3 1 a 2 s a f b i a k 2 b f where the superscript f refers to the contributions from the fluid structure interaction i e from c f using the expression a 3 for c f these contributions can be written as 28 a f π a f 2 k 2 a f 1 i k a f 0 c k 2 a 2 2 a 1 a g 1 i k a g 0 29 b f π a 2 1 4 k 2 π c k 2 a 2 2 a 1 i k where a f 0 a f 1 a f 2 a g 0 and a g 1 are functions of a defined in eqs a 8 a 10 in appendix a in absence of fluid structure interaction fsi i e assuming c f 0 30 d m h 0 i a k 2 16 a 2 1 3 3 1 a 2 s k d k 2 thus the corresponding first resonant frequency is 31 k r 0 16 a 2 1 3 s 3 1 a 2 k d 280 1 3 a 2 s 141 168 a 1281 a 2 1120 a 3 1015 a 4 840 a 5 315 a 6 r with the last expression valid for constant mass ratio r recovering the well known result that the dimensionless natural frequency of a flexible plate is proportional to s r e g floryan and rowley 2018 but now with an analytical expression for its dependence on the pivot point location in the present approximation for a pivot at the leading edge a 1 k r 0 35 s 142 r 0 496 s r recovering almost exactly the result for the first resonant frequency obtained numerically from a more general inviscid theory by floryan and rowley 2018 for a 1 when the fsi is taken into account the denominator a of 26 is not longer real and there is no proper resonant frequency at which d m becomes singular but there exists a frequency that maximizes the flexural deflection amplitude d m and therefore the thrust force see section 6 below for each set of dimensionless parameters since at this frequency k k r say which corresponds to the minimum value of a the maximum of d m is quite large it may still be called the first resonant or natural frequency of the system obviously this frequency tends to the resonant frequency k r 0 given above for r when the fsi becomes negligible this is shown in fig 9 where k r r s is plotted as a function of a for two values of s and three of r for r 10 k r that minimizes a almost coincide with k r 0 particularly for large s once d t d m e i k t ψ is obtained eq 14 yields the required input lift c l i and hence the input power coefficient 32 c p i t h t c l i t one can also obtain the propulsion coefficient c t t from the resulting flexural deflection motion and the prescribed heaving kinematics alaminos quesada and fernandez feria 2020 fernandez feria and alaminos quesada 2021b its time averaged value defined in eq 6 can be written as 33 c t k h 0 2 t h k k h 0 d m t d h k a ψ d m 2 t d k a with the functions t h k t d h k a ψ and t d k a obtained in fernandez feria and alaminos quesada 2021b and reproduced in appendix b for easy reference for d m 0 one recovers the mean thrust coefficient c t 0 of an otherwise identical rigid foil with the same plunging motion fernandez feria 2016 2017 finally to compute the propulsive froude efficiency 7 one also needs the time averaged input power coefficient which can be written as the sum of different contributions 34 c p i h c l i c p i 0 c p i d c p i m c p i s c p i 0 is the fsi contribution from the terms in c l associated to the heaving motion of the foil as a rigid solid 35 c p i 0 π k h 0 2 f k this contribution obviously coincides with theodorsen s power coefficient for a purely heaving motion of a rigid foil theodorsen 1935 garrick 1936 where f is the real and imaginary parts of theodorsen s function c given in eq a 5 the other contribution from the fsi associated to the flexural deflection motion of the foil i e from terms in c l containing d is 36 c p i d π k h 0 d m a l 2 k 2 2 a g 1 k g a g 0 f sin ψ a l 1 k 2 a g 1 k f a g 0 g cos ψ where a l 1 a l 2 a g 0 and a g 1 are functions of a defined in eqs a 6 a 10 in appendix a the term c p i m is the contribution from the inertia of the foil 37 c p i m k 3 h 0 2 j a d m sin ψ note that j a given by eq 21 depends on r and therefore on m while c p i s is the contribution from the stiffness of the foil 38 c p i s 8 s 3 1 a 2 k h 0 d m sin ψ 6 comparison between numerical and theoretical results one of the main objectives of this work is to compare the above analytical expressions with accurate numerical solutions of the full fsi problem to find out to what extent one can use the analytical predictions to characterize the propulsive performance of a heaving flexible foil numerical solutions are very expensive in computational time so that we consider only selected values of s r a and r e for a plate of uniform thickness and density and vary the frequency k and the heave amplitude h 0 or the strouhal number s t in particular the reported numerical results are for r e 10 000 and we select a relatively high value of the stiffness s 50 because the thrust amplification due to flexibility at or near the natural frequencies are more important when the stiffness is large enough alben 2008 dewey et al 2013 moore 2015 the selected value of the mass ratio is small r 0 05 of greater interest in swimming rather than in flying problems floryan and rowley 2018 the natural frequencies corresponding to these values of r and s are plotted in fig 10 as a function of the pivot point location a finally we force the heaving motion at the leading edge a 1 so that we use the foil configuration for which the grid convergence analysis has been made in section 4 2 for these values of r s and a the natural frequency k r 4 4 is well below the resonant frequency in vacuo k r 0 15 7 see fig 10 due to the smallness of the mass ratio r first we consider the trailing edge deflection which in the linear theory is given by 39 z t e t z s 1 t h t 1 a 2 2 d t fig 11 compares the maximum of the flexural deflection amplitude at the trailing edge in relation to the heaving motion at the leading edge i e 40 d t e m a x z t e t h t h 0 obtained from the linear theory with numerical results as the reduced frequency k is varied note that this quantity is obviously zero for a rigid foil from the linear theory d t e 1 a 2 d m h 0 and it is independent of the heave amplitude h 0 the numerical results are obtained for h 0 0 05 0 1 and 0 25 for sufficiently small amplitude h 0 this figure shows that the linear theory predicts quite accurately the frequency for the maximum deflection amplitude which roughly coincides with the natural frequency k r that minimizes a however the theory over predicts this maximum of d t e the more so the larger h 0 which was to be expected given its linearity note that the linear theory without fsi predicts a singularity of the flexural deflection amplitude at the resonant frequency see equation 30 fsi damps the singularity at this frequency but not enough since the theory is based on inviscid flow but it is remarkable that even for a high heave amplitude as h 0 0 25 the frequency for the first local maximum of d t e is still well predicted by the linear theory this is even more surprising considering that the flow ceases to remain periodic and becomes chaotic above a threshold frequency that decreases rapidly as h 0 increases this transition is characterized in fig 11 by a change in the symbols used for plotting the numerical results circles for periodic solutions and stars for chaotic solutions for the lower amplitudes h 0 0 05 and 0 1 this transition occurs at k larger than the natural frequency k r but for the largest amplitude h 0 0 25 the transition takes place at a value of k well below k r if one plots the results of fig 11 in terms of the strouhal number 2 see fig 12 all the transitions to chaotic solutions take place in a narrow range of s t between 0 15 and 0 25 approximately independently of the heave amplitude to better appreciate how the foil motion changes after these transitions fig 13 shows the temporal evolutions of the relative trailing edge amplitude z t e t h 0 for h 0 0 05 and four values of k 5 and 11 s t 0 08 and 0 175 yielding periodic oscillations and 12 and 17 s t 0 19 and 0 27 corresponding to chaotic solutions when the temporal evolutions are aperiodic the time averaged quantities represented in figs 11 and 12 and in all the other similar results reported below in this section are computed over the last ten cycles note in fig 13 that the trailing edge amplitude for k 5 is much larger than the rest since this frequency is very close to the natural frequency see fig 11 the different temporal evolutions in fig 13 are of course a consequence of the different flow patterns as depicted in fig 14 for k 5 and k 17 at selected instants of time the first case shows a spatiotemporal periodic structure associated to a mostly attached flow while in the second case the flow is no longer attached to the foil and becomes chaotic peaks in trailing edge deflection amplitude at roughly the natural frequencies produce maxima in the time averaged thrust coefficient as shown in fig 15 for the same cases considered in figs 11 and 12 the theoretical results are computed from 33 but subtracting a constant quasistatic drag c d 0 0 035 that corrects the inviscid results to account for viscous effects in a quite simple way see e g mackowski and williamson 2017 fernandez feria 2017 this viscous effect is relatively more relevant as k 0 where the theoretical c t vanishes without considering this quasistatic drag c t h 0 2 from the linear inviscid theory is independent of k shown as a dashed and dotted line in fig 15 a which practically coincide with the curve for h 0 0 25 since at that large amplitude the effect of c d 0 is negligible as c t scales as h o 2 similarly to the trailing edge deflection amplitude when h 0 is sufficiently small i e for h 0 0 05 and 0 1 in the present results the linear theory predicts remarkably well the natural frequency k r at which c t reaches the first local maximum but over predicting its magnitude the more so the larger the amplitude h 0 note also that the linear theory for c t fails for large k once the first resonant peak is passed since it only recovers the first natural mode the numerical results show that for these high values of k the flow becomes chaotic but even when h 0 is large enough so that this transition to an aperiodic flow occurs at lower frequencies than the first natural mode as in the present case with h 0 0 25 good theoretical predictions are found for k k r also shown in fig 15 a with dotted lines are the theoretical results for an otherwise identical rigid foil and marked with a diamond the numerical result for a rigid foil actually s 5 1 0 11 when h 0 0 05 and k 5 very close to the resonant frequency k r they are included to show the huge thrust enhancement due to flexibility at the natural frequency compare for instance the diamond with the gray circle for the same k actually the rigid foil at these flapping conditions h 0 0 05 and k 5 does not produce net thrust just drag this is more clearly appreciated with the temporal evolutions of c t shown in fig 16 a similar behavior is obtained for the time averaged input power coefficient fig 17 now numerical results only consider the input power associated to the fluid structure interaction while the theoretical expression 34 also includes the components of the input power associated to the inertia and stiffness of the foil thus in addition to the linear theory results given by eq 34 which are plotted in fig 17 as thin continuous lines we also plot the components associated only to the fsi i e 41 c p i f c p i 0 c p i d as dashed lines these last curves agree quite well with the numerical results up to the natural frequency even for the highest amplitude h 0 0 25 in spite of the fact that as aforementioned the flow becomes chaotic at much lower frequencies note however that the numerical results only present a clear maximum of the input power around the natural frequency for the lowest amplitude considered since the maxima in the thrust and input power are both roughly reached at the natural frequency it is not clear whether the froude efficiency 7 would present a maximum at this frequency or at some other frequency or indeed no distinguished local maximum at all fig 18 where we plot the propulsive efficiency corresponding to the thrust coefficients given in fig 15 and the input power coefficients given in figure 17 shows that the numerical results for η actually do present local maxima roughly at the natural frequency k 5 corresponding to s t 0 08 0 15 and 0 4 for h 0 0 05 0 1 and 0 25 respectively while the results from the linear theory do not except for the lowest amplitude h 0 0 05 for this h 0 the agreement between the linear theory considering only the part c p i f due to fsi as in the numerical computations and the numerical results for η is quite remarkable indeed however for the higher values of h 0 considered the linear theory provides just a good estimate of the maximum propulsive efficiency the maximum computed efficiency for h 0 0 05 is about 28 at s t 0 08 which practically coincide with the prediction from the linear theory it must be noted that for these flapping conditions the otherwise identical rigid foil does not produce net thrust and its efficiency is therefore negative shown in fig 18 with a diamond 7 conclusion accurate numerical results for the propulsive performance of a flexible plunging hydrofoil have been compared to the analytical predictions of linear theory both considering the fluid structure interaction in particular the theory yields the first natural frequency of the fluid foil system from just a simple algebraic equation the optimal propulsive performance obtained numerically both in terms of thrust enhancement in relation to an otherwise identical rigid foil and of propulsive efficiency occurs when the foil is operated at a frequency which is quite accurately predicted by the theoretical natural frequency even for plunging amplitudes which are not so small however the magnitude of the thrust force and efficiency are well predicted by the linear theory only for very small amplitudes as expected over estimating them as the amplitude increases therefore the natural frequency k r from the linear theory constitutes a simple and reliable estimation of the optimal frequency for underwater propellers based on flexible plunging hydrofoils a prediction that may reduce the number of costly numerical computations or expensive experiments k r is obtained by just minimizing a with a given by eq 27 from this equation fig 19 provides for instance a convenient chart to select the optimal actuating flapping frequency for a foil of any stiffness ratio s and mass ratio r actuated at the leading edge a 1 or for a foil with pivot point locations between the leading edge and the mid chord for a wide range of mass ratios and a given stiffness ratio credit authorship contribution statement e sanmiguel rojas data curation formal analysis funding acquisition investigation methodology project administration resources software validation visualization writing review editing r fernandez feria conceptualization formal analysis funding acquisition investigation methodology project administration software supervision validation visualization writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research has been supported by the junta de andalucía spain grants uma18 feder ja 047 and p18 fr 1532 and by the ministerio de ciencia e innovación of spain grant pid2019 104938rb i00 funding for open access charge universidad de málaga cbua the computations were performed in the picasso supercomputer at the university of málaga a node of the spanish supercomputing network appendix a lift moment and flexural coefficients from linear potential theory the following expressions for the coefficients corresponding to the quartic foil s deflection 13 are taken from fernandez feria and alaminos quesada 2021a but without passive pitching motion a 0 0 a 1 c l t π h a l 2 a d a l 1 a d c k γ 0 t a 2 c m t π 2 a h a m 2 a d a m 1 a d a m 0 a d 1 2 1 2 a c k γ 0 t a 3 c f t π a 2 1 4 h a f 2 a d a f 1 a d a f 0 a d 1 2 a a 2 c k γ 0 t where a 4 γ 0 t 2 π h a g 1 a d a g 0 a d is the quasi steady nondimensional circulation a 5 c k h 1 2 k i h 0 2 k h 1 2 k f k i g k is theodorsen s function theodorsen 1935 and h n 2 z j n z i y n z n 0 1 hankel s function of the second kind and order n related to the bessel functions of the first and second kind j n z and y n z olver et al 2010 and where the following functions of a have been defined a 6 a l 2 13 48 a 2 64 a 3 24 a 4 48 1 a 2 a l 1 3 12 a 12 a 2 4 a 3 6 1 a 2 a 7 a m 2 2 25 a 12 a 2 52 a 3 64 a 4 24 a 5 48 1 a 2 a m 1 9 12 a 72 a 2 56 a 3 16 a 4 24 1 a 2 a 8 a m 0 3 4 1 a 2 a f 2 35 32 a 392 a 2 320 a 3 496 a 4 512 a 5 192 a 6 384 1 a 2 a 9 a f 1 1 8 a 18 a 2 48 a 3 32 a 4 8 a 5 12 1 a 2 a f 0 7 18 a 12 1 a 2 a 10 a g 1 15 48 a 96 a 2 80 a 3 24 a 4 48 1 a 2 a g 0 3 24 a 24 a 2 8 a 3 12 1 a 2 appendix b functions for the theoretical time averaged thrust coefficient the functions t h k t d h k a ψ and t d k a appearing in the time averaged thrust coefficient 33 can be written as fernandez feria and alaminos quesada 2021b b 1 t h 2 g 1 b 2 t d h π a d 0 i k a d 1 r d g 2 a g 1 k 3 2 e j π g g 1 k 2 q f 1 g 1 k 2 π g 2 cos ψ π a d 0 r k a d 1 i d f 2 a f 1 k 3 2 e j f 1 k 2 π f q f 1 k 2 π f 2 g 1 sin ψ b 3 t d π 4 q k a d 0 i 2 a d 0 r 2 k a d 1 i k 2 a d 1 r 2 a g k d g k 2 f e j 3 f 9 g k 4 k 4 a 3 e 2 3 j 2 a d 0 i k a d 1 r g d 3 e 2 3 j 2 q 2 g k 2 f the following functions of the pivot point location a and the reduced frequency k are used b 4 q a 2 b a 2 d a 3 e a 3 j a b 5 a a a 2 1 2 a 3 1 a a 2 6 1 a 2 b a 2 a 1 a 1 a a 2 3 1 a 2 b 6 d a 1 2 a 1 a a 2 1 a 2 e a 2 3 1 a 1 a 1 a j a 1 6 1 a 2 f k and g k are the real and imaginary parts of theodorsen s function a 5 and likewise f 1 k and g 1 k in relation to the complex function b 7 c 1 k 1 k e i k i h 0 2 k h 1 2 k a d j r k a and a d j i k a j 0 1 are the real and imaginary parts of the functions b 8 a d 0 k a b g 0 d 1 2 g 1 k c k e 1 2 3 g 2 c 2 j 4 g 3 c 2 c 3 k b 9 a d 1 k a a g 0 b g 1 d g 2 e g 3 i 2 k c j g 4 c 2 2 k with b 10 c 2 k h 2 2 k i h 0 2 h 1 2 k c 3 k y 0 k i j 2 k i h 1 1 k i h 0 2 h 1 2 k b 11 g 0 k 2 i π c 1 k g 1 k 2 π k 1 i k c 1 k i k c k g 2 k 1 k c 2 k 2 i k 2 2 i k k c 1 k b 12 g 3 k 3 y 2 k k y 1 k i j 3 k i j 2 k k 2 i h 0 2 h 1 2 k 6 π k 1 i k 2 k 2 1 c 1 k b 13 g 4 k 1 i h 0 2 h 1 2 k 1 k 2 k j 4 k 3 j 3 k i k 4 g 1 3 2 0 k 2 4 3 2 3 0 1 2 2 π 24 k 4 k i 4 k 2 k 3 i i c 1 k where j ν and y ν are the bessel functions of the first and second kind respectively of order ν and g p q m n z a p b q the meijer g function olver et al 2010 
