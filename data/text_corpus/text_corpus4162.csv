index,text
20810,in this paper feasibility of applying moving baffles linked to a spring system as a mitigation device to suppress liquid sloshing of a container undergoing a harmonic and seismic excitation is investigated numerically using the coupled eulerian lagrangian cel technique the interaction between the eulerian fluid domain where the material can pass through the mesh and the lagrangian tank domain where the material is supposed to be fixed to the mesh is modelled using the cel capability of abaqus software firstly free sloshing of a rigid deformable tank is achieved and the numerical results are compared with those of the experiment to validate the numerical simulation quantitatively secondly liquid sloshing of a moving container in absence presence of moving baffles is simulated and compared with those of the experimental cases qualitatively furthermore the effects of various parameters namely excitation amplitude and frequency filling ratio spring stiffness and damping coefficient on both the sloshing kinetic energy and normal forces exerted on the tank wall are investigated separately the results show that the spring stiffness effects on the kinetic energy of liquid sloshing is minor while the normal force exerted on the left wall can be highly influenced by the spring stiffness keywords free surface flows liquid sloshing moving baffle spring system two phase flows 1 introduction collision of the liquid with the inner surface of a containing tank due to the relative motion between them is called liquid sloshing studying liquid sloshing is of great importance since the internal structures of a tank can be subjected to structural failure due to the repeated impact loads exerted on them these impact loads become even more severe when the tank is excited with a frequency which is equal to natural frequency of the liquid within the tank therefore mitigating liquid sloshing of a container is highly interested in the field of marine engineering and naval architecture due to its pivotal role especially in transportation of natural gas oil and liquids faltinsen and timokha 2009 ibrahim 2005 so many researches have been achieved on liquid sloshing in rectangular and cylindrical tanks so far using theoretical and experimental approaches due to complexity and non linearity of this phenomenon experimental studies are highly preferred to be accomplished instead of analytical and numerical methods an analytical solution for 2d liquid sloshing of rectangular tanks was introduced by faltinsen 1978 this analytical model was used by so many researchers to validate the numerical models chiba 1995 and dutta and laha 2000 proposed baffles to suppress liquid sloshing of a moving container since the liquid viscosity had a minor effect on increasing the hydrodynamic damping rate choun and yun 1996 1999 applied the small amplitude wave theory to study liquid sloshing of rectangular tanks in presence of a bottom mounted rectangular block liu and lin 2008 introduced a second order volume of fluid vof scheme to capture break up in free surfaces during nonlinear liquid sloshing the turbulence effects were also studied via the large eddy simulation les approach in the research tippmann et al 2009 applied the cel approach to simulate a two dimensional liquid sloshing in a rectangular tank using abaqus software the authors improved the solution time via decreasing the sound wave speed for the equation of state material model the authors also assumed the tank geometry to be deformable to analyze the deformation and stresses in the tank due to the liquid sloshing it was concluded that the cel technique had a high capability to simulate the fluid structure interaction for a special type of problems liu and lin 2009 applied the virtual boundary force method to simulate the liquid sloshing in presence of the vertical baffles within the tank in a later research maleki and ziyaeifar 2008 examined the feasibility of applying ring baffles to suppress liquid sloshing of circular cylindrical tanks via conducting some experiments during the test the excitation amplitudes were 0 4 and 1 5 mm while the amounts of relative depth water depth to the height of the tank were supposed to be 0 17 0 25 0 42 0 63 and 0 83 during the experiment it was reported that using ring baffles were an efficient way to mitigate the sloshing waves eswaran et al 2009 applied the vof technique with arbitrary lagrangian eulerian ale formulation to study liquid sloshing for baffled and un baffled tanks the adina software was used to obtain the response of the coupled system the results showed that sloshing effects for the baffled tank could be diminished efficiently panigrahy et al 2009 accomplished some experiments on the liquid sloshing set up to estimate efficacy of baffles in mitigating the liquid sloshing waves the excitation frequency and water depth in the square tank were varied and the free surface elevation of water from the mean static level and the pressure variations on the tank walls were studied experimentally the experiments were achieved for the baffled and unbaffled tanks and the results were analyzed thiagarajan et al 2011 simulated liquid sloshing in a 2d rectangular tank subjected to the sway excitation the vof technique was applied to track the air water interface while a finite volume approximation was used to model the fluid domain the effects of various parameters namely the fill levels and excitation time periods on the liquid sloshing dynamics were studied and the numerical results were compared with those of theoretical predictions available in the literature wang et al 2013 investigated the feasibility of applying multiple annular rigid baffles as a mitigation device to suppress liquid sloshing in a rigid cylindrical tank experiencing lateral excitation the authors finally discussed various parameters namely the hydrodynamic pressure distribution height of surface wave and hydrodynamic momentum and force of a tank under harmonic and seismic excitations in their research koh et al 2013 applied a constrained floating baffle to suppress liquid sloshing in a rectangular container using the improved consistent particle method cpm the authors validated the introduced algorithm by free sloshing and hydrostatic cases having less spurious fluctuations the authors also conducted some experiments to validate the numerical results obtained hwang et al 2016 modelled liquid sloshing in rolling rectangular tanks with elastic baffles using a modified particle based fluid structure interaction fsi solver the authors supposed the rolling amplitude to be 4 while the period of rolling motion was assumed to be 85 of natural period of the container the results of sloshing with various configurations including sloshing without any baffle with a rigid baffle and a set of flexible baffles were analyzed and compared with each other in the research iranmanesh and passandideh fard 2017 investigated the feasibility of using a submerged cylinder as a mitigation device to suppress liquid sloshing in a rectangular container the sloshing tank was moved with both a constant acceleration and single oscillatory excitation the free surface deformation was reconstructed using the vof approach the authors compared the results of liquid sloshing in presence of a submerged cylinder with those obtained from the experiments of free sloshing with no cylinder it was finally concluded that a submerged cylinder had an outstanding role in mitigating liquid sloshing when the sloshing tank was excited with the single oscillatory excitation kim et al 2018 conducted some experiments to restrain violent liquid sloshing in a rectangular tank using moving baffles coupled to a spring system the experimental results for free liquid sloshing were compared with those obtained from liquid sloshing of a container with moving baffles the experimental results showed that the sloshing phenomenon was suppressed effectively using the spring connected horizontal baffles zhang et al 2019 examined an anti sloshing technique to suppress liquid sloshing of a container undergoing a harmonic excitation the authors studied the experimental observations using an analytical potential flow solution the wave profiles and dynamic pressure histories for various layers of floating foams were obtained and analyzed it was deduced that the sloshing amplitude would decrease even by applying a single layer of floating foams ünal et al 2019 studied the effects of using t shaped baffles on suppressing liquid sloshing of a rectangular tank the authors varied various parameters including filling depths baffle heights and the rotation angle to investigate the effects of these parameters on the free surface elevations and hydrodynamic loads on the tank wall it was finally concluded that the baffle height had a major role on the wave damping and pressure when its height was supposed to be larger than 80 of the liquid depth nasar and sannasiraj 2019 studied the behavior of porous baffle arrangements in a barge carrying liquid container on the sloshing dynamics experimentally the sloshing container was subjected to regular beam sea waves while the filling ratio of the tank was assumed to be 75 the excitation frequencies of the generated wave were varied between 0 45 hz and 1 54 hz while the wave height was supposed to be 0 1 m the authors also discussed the effects of the baffle position on the sloshing dynamics zhang 2020 applied finite difference method to study the sloshing modal properties including sloshing mode shapes and sloshing frequencies of sloped bottom tuned liquid dampers tld it was found the sloshing mode shapes of the shallow water sloped bottom tld were not similar to those of the deep water sloped bottom tld jin et al 2020 conducted some experiments to investigate the viscous influence on the liquid sloshing of a container under resonant and off resonant condition the authors chose tap water and glycerin at various temperatures as the experimental fluids the authors obtained a viscosity threshold where the sloshing slowly shifted from the resonant steady state to the harmonic state das et al 2020 accomplished some experiments to estimate the capability of using u shaped containers as liquid dampers in tall buildings the tall buildings were subjected to free and forced vibration tests and liquid sloshing effects on the response control of tall buildings were analyzed they also applied both 2d and 3d numerical models to simulate liquid sloshing in u shaped containers the numerical results were in good agreement with those of the experiments zheng et al 2020 developed a numerical model to investigate the effects of a porous bottom layer on sloshing dynamics in a rectangular tank with single and multi layered fluids the authors analyzed the effects of excitation frequency permeability and porosity values of the bottom layer on the dynamics of sloshing the results showed that damping capability increased as porosity ratios and permeability values of the porous bottom layer were decreased ma et al 2021 investigated the feasibility of applying single and double vertical baffles to suppress violent transient sloshing numerically the damping effects of single and double vertical baffles were evaluated via measuring the liquid elevation energy dissipation and total impact pressure it was reported that arrangement of multiple baffles had a determinant role on damping effects liu et al 2021 developed a multi layered vof method to simulate two layered liquid sloshing in a rectangular tank subjected to horizontal excitations the authors applied experimental data and linear analytical solution to evaluate the accuracy of numerical results the numerical results were in good agreement with those of analytical solution when nonlinearity was supposed to be weak furthermore two natural frequencies were observed for two layered liquid sloshing while the larger frequency was associated with the upper layer feasibility of using porous and non porous baffles to suppress liquid sloshing of both rectangular and cylindrical containers have been investigated comprehensively by many researchers in the literature while the baffles are supposed to be fixed during the analysis however capability of using moving baffles in suppressing liquid sloshing of a moving container has not been studied by the researchers numerically so far therefore feasibility of using moving baffles as a mitigation device to suppress liquid sloshing of a rectangular container undergoing harmonic and seismic excitations is investigated numerically in this paper firstly liquid sloshing of a rigid deformable container is achieved using the cel technique and the numerical results are compared with the results available in the literature to validate the cel technique quantitatively secondly liquid sloshing of a moving container in absence presence of moving baffles is modelled and numerical results are compared with those of the experiment qualitatively in order to confirm that liquid sloshing of a moving container can be suppressed efficiently via using moving baffles the effects of various parameters namely excitation amplitude and frequency filling ratio spring stiffness and damping coefficient on both the suppression rate of kinetic energy and normal forces exerted on the left wall of a moving container are studied separately 2 computational model and governing equations 2 1 the cel approach in this paper liquid sloshing in a rectangular container with without moving baffles are simulated using the cel technique presented in the commercial software abaqus it is not possible to model the flow problems using the lagrangian elements due to violent mesh distortion it is proposed to simulate fluid flow problems using the eulerian elements since the eulerian mesh does not have any deformation the lagrangian element is applied to simulate the tank wall while the eulerian element is used to simulate the liquid in the cel approach stresses and computed pressures in the eulerian mesh are enforced on the lagrangian cells as external loads in the cel approach in other words the lagrangian mesh operates like a boundary condition applied on the flow of material in the eulerian meshes qiu et al 2011 the computational nodes are supposed to be fixed within the material in a lagrangian analysis while both the material and the elements can have deformation together in a lagrangian approach the element boundary is the same as the material boundary since the lagrangian elements are always filled with a material the computational nodes in an eulerian analysis are assumed to be fixed in space while they do not have any deformation when the material moves through them unlike the lagrangian analysis the eulerian elements may be void and partially filled in an eulerian analysis and the material does not always occupy total volume of eulerian elements therefore it is necessary to calculate the eulerian material boundary at each time step since an element boundary does not coincide with the eulerian material boundary to provide enough space for the material to flow and deform the domain of eulerian is supposed to be large enough to cover the eulerian material boundaries in the cel technique the liquid and the tank wall interactions are simulated using the general contact algorithm in which hard contact interaction is defined in the normal and tangential directions it should be mentioned that it is not needed to define extra solvers for simulating the liquid region singly in the cel approach the flowchart of finite element procedure achieved in the cel approach is shown in fig 1 it should be mentioned that the commercial software abaqus applies the vof technique to track free surface deformation in the eulerian implementation by defining a separate volume fraction tool in each eulerian element the free surface deformation is tracked when the liquid moves through the mesh the eulerian volume fraction evf is denoted by a scalar field f which varies between zero 0 and one 1 f 1 refers to the case when the total volume of the element is occupied by the liquid while the completely void elements are shown by f 0 when the amount of the evf varies between 0 and 1 it is interpreted that the elements are partially filled with the liquid therefore the evf is defined as follows 1 f x y t i f f 0 e m p t y i f 0 f 1 p a r t i a l l y f i l l e d i f f 1 f i l l e d during the analysis it is necessary to update the amount of f while the mesh is restored in every incremental step an eulerian lagrangian contact algorithm is applied to enforce the interaction between an eulerian and a lagrangian continuum in the cel approach it should be noted that an eulerian lagrangian contact algorithm is ignored at the nodes with a material volume fraction lower than 0 5 by using the central difference operator along with the lagrange plus remap formulation the eulerian time integration is accomplished in the explicit method in the explicit method the numerical approach is conditionally stable in other words the solution diverges and becomes unstable if the time increment is too big the stable time increment can be estimated by 2 δ t min l e c d where l e stands for the characteristic element length and the dilatational wave speed of the material is shown by c d c d can be obtained for a linear elastic material by 3 c d λ 2 μ ρ where lame s constants are denoted by λ and μ and ρ stands for the material density if a finite element mesh of a single material is considered the stable time increment will be determined by the smallest element in the mesh 2 2 material properties 2 2 1 hugoniot curve and energy equation the rate of exchanged heat and the rate at which work is being done by the stresses determine the increase rate of internal energy per unit mass em by solving the energy equation if the heat conduction term is being neglected in the energy equation the equation for conservation of energy can be simplified as follows abaqus 6 11 documentation 2011 4 ρ e m t p p b v 1 ρ ρ t s e ρ q where ρ and p stand for the density and pressure stress respectively while the pressure stress is supposed to be positive in compression the pressure stress due to the bulk viscosity is denoted by p b v the deviatoric stress tensor deviatoric part of strain rate and rate of heat per unit mass are shown by s e and q respectively the relationship among the pressure p density ρ and internal energy per unit mass e m can be determined using a mathematical function known as equation of state h defined as follows 5 p h ρ e m all the equilibrium states in a material can be characterized using eq 5 to obtain a relationship between p and 1 ρ or p and v v stands for current volume the term of internal energy in eq 5 should be eliminated the unique equation determining the relationship between p and 1 ρ is known as the hugoniot curve this curve shows the locus of p v states behind a shock the hugoniot curve is illustrated in fig 2 isbell et al 1968 it should be mentioned that the hugoniot pressure ph depends only on the density and this factor can be specified using fitting experimental data the equation of state is linear in energy when it is written as follows 6 p f g e m the equation of state model determines f ρ and g ρ and these parameters f and g are only mathematical functions of the density 2 2 2 mie grüneisen equation of state the most common form of mie grüneisen equation of state which is linear in energy can be written as follows 7 p p h γ ρ e m e h where the hugoniot pressure and specific internal energy are shown by p h and e h respectively the grüneisen ratio is denoted by γ which is defined as follows 8 γ γ 0 ρ 0 ρ the reference density and material constant are shown by ρ 0 and γ 0 respectively the relationship between the hugoniot pressure p h and hugoniot energy e h can be determined using the following equation 9 e h p h η 2 ρ 0 10 η 1 ρ 0 ρ the nominal volumetric compressive strain is denoted by η after substituting the amounts of γ and e h into eq 7 its final form is simplified to eq 11 11 p p h 1 γ 0 η 2 γ 0 ρ 0 e m it should be mentioned that the energy equation and equation of state should be solved simultaneously in commercial software abaqus since they are coupled together via pressure and internal energy 2 2 3 linear us up hugoniot form by accomplishing a common fit to the hugoniot data one can write 12 p h ρ 0 c 0 2 η 1 s η 2 by defining c 0 and s the linear relationship between the shock velocity u s and particle velocity u p can be determined using eq 13 13 u s c 0 s u p by substituting eq 12 into eq 11 the linear linear us up hugoniot form can be written as follows abaqus 6 11 documentation 2011 14 p ρ 0 c 0 2 η 1 s η 2 1 γ 0 η 2 γ 0 ρ 0 e m by calculating the amount of ρ 0 c 0 2 the elastic bulk modulus at small nominal strains can be evaluated in this research the incompressible viscous flow can be simulated using a linear us up equation of state model the equation of state governs the volumetric response and the bulk modulus is considered to be a penalty parameter for the incompressible constraint the linear us up hugoniot form of the mie grüneisen equation of state is applied to simulate the water the amounts of density and bulk modulus for water are 998 kg m3 and 2 094 gpa material properties considered for water in this research are presented in table 1 3 results and discussion 3 1 mesh refinement study and validation 3 1 1 free liquid sloshing of a rigid tank in this paper the results of liquid sloshing in a rectangular container were compared with those of cfd simulation star ccm to evaluate the accuracy of the cel technique the fundamental sloshing frequency of the liquid inside a rectangular tank f n can be predicted using the linear wave theory love et al 2020 15 f n 1 2 π π g l tanh π d l where l d and g stand for the length of tank water depth and gravity acceleration respectively it should be mentioned that liquid motion was assumed to be irrotational inviscid and incompressible to derive eq 15 wave motions were also supposed to be linear while the walls of tank were assumed to be vertical furthermore the liquid sloshing in a tank was considered to be the superposition of a progressing wave and its reflection wave in order to have natural frequency of 1 hz the length of tank l and water depth d were supposed to be 0 61 m and 0 20 m respectively the schematic diagram of the oscillating tank is illustrated in fig 3 the simulated tank was composed of the tank wall and water in the cel technique the tank wall was modelled using lagrangian elements while eulerian elements were applied to simulate water it should be noted that tank walls were modelled using shell elements with a very small thickness since the tank was supposed to be rigid in order to determine the initial region occupied by water the eulerian part was partitioned the void material option was attributed to all other partitions during the step of material assignment in this research linear us up hugoniot form was used as a governing equation to simulate water the sound wave speed of water was supposed to be 1483 m s in this research the water tank was supposed to be excited using the following equation 16 x a sin 2 π f d t where a and f d stand for the amplitude and frequency of excitation respectively the amount of excitation amplitude was supposed to be 0 0054 m while driving frequency of the water tank f d was assumed to be 1 09 f n in this simulation 3d eight node eulerian continuum element with reduced integration ec3d8r was applied to simulate the water while the rigid container was modelled using a three dimensional four node bi linear quadrilateral discrete rigid element r3d4 as illustrated in fig 4 in order to validate the cel approach achieved in abaqus the free surface elevation on the left side of the tank was compared with those obtained from a cfd approach free surface elevation on the left side of the moving tank was calculated via multiplying the element height by summation of all of water volume fraction values for the vertical column of elements in order to investigate the mesh refinement study the number of cells per the tank length cpl was defined the cpl was increased until no remarkable changes in the kinetic energy of liquid sloshing were observed the results of mesh refinement study for the rectangular rigid tank are illustrated in fig 5 based on fig 5 the amount of cpl was finally selected to be 240 to simulate the liquid sloshing of a rectangular container using the cel technique at initial stages the wave amplitude was considerable low while sudden changes in the kinetic energy of liquid sloshing were observed until t 0 8 s these sudden changes can be attributed to the inertia effects after the transient stage the wave amplitude varied uniformly between t 0 8 s and t 3 0 s and sudden oscillations in the amounts of the kinetic energy were removed it should be mentioned that the amplitude of kinetic energy of the liquid sloshing would increase as the time passed between t 0 8 s and t 3 0 s the results of free surface elevation on the left side of the rigid tank obtained from the cel approach are compared with those of a cfd method tippmann et al 2009 in fig 6 based on fig 6 the numerical results computed by the cel approach for the rigid tank were in good agreement with those of the cfd method in terms of the wave amplitude and frequency furthermore amplitude of the wave height would increase from t 0 0 s to t 5 0 s as the time passed 3 1 2 free liquid sloshing of a flexible tank in this section liquid sloshing in a flexible container is simulated using the same model presented for the rigid container analysis to validate the numerical approach for the liquid sloshing of a flexible tank the results of free surface elevation on the left side of a moving container were compared with those of the numerical approach achieved by tippmann et al 2009 as shown in fig 6 the tank walls were supposed to be composed of generic steel while the wall thickness was supposed to be 0 01 m the amount of driving frequency for the flexible case was supposed to be 0 9 f n furthermore the results of liquid sloshing in a rigid tank were compared with those of the flexible tank in fig 6 to study the effects of flexibility and driving frequency on the wave height simultaneously as shown in fig 6 at initial times from t 0 0 s to t 1 0 s the effect of flexibility on the wave height is higher than that of the driving frequency as the time passed from t 1 0 s to t 5 0 s the effects of driving frequency on the wave height became major compared to those of flexibility as can be seen from fig 6 a decrease in the amount of the wave height is observed for the flexible tank compared with that of the rigid tank due to the flexibility effects it should be mentioned the frequency of the wave is not affected by the flexibility effects while driving frequency can change the frequency and amplitude of the wave as shown in fig 6 3 2 investigating the feasibility of applying moving baffles in suppressing the kinetic energy of liquid sloshing under a harmonic excitation in this section the results of liquid sloshing in a rectangular tank in absence presence of moving baffles are compared with those of the experiments available in the literature kim et al 2018 in other words the mechanism of using moving baffles coupled to a spring system are studied and investigated in detail the tank with a size of l b h of 0 874 0 07 0 535 m was simulated and analyzed in this paper as shown in fig 7 the tank was supposed to be made of transparent acrylic since it was possible to capture the flow motion furthermore the time step size value was supposed to be 3 48 10 6 s the top of the rectangular tank was closed and the value of pressure on the liquid free surface was equal to atmospheric pressure initially furthermore the top box was fixed to the rectangular tank and its material was supposed to be the same as that of the tank the mechanism and dimension of spring linked baffles are illustrated in fig 8 based on fig 8 two springs were arranged and fixed between the top box and moving baffles on the left and right sides of the simulated tank the moving baffles coupled to a spring system were supposed to have only 1 dof motion in the downward and upward directions this assumption was made to eliminate any jig generated in each spring in order to guarantee the smooth motion of the moving baffles a space of 1 mm in the widthwise and lengthwise directions was considered to eliminate unwanted friction generated between the moving tank and baffles the springs were free to move in the upward direction while they were constrained in the downward direction at their initial positions furthermore both springs were supposed to be in the free length condition at their initial states the material of the moving baffles was selected to be the same transparent acrylic as the material of the tank while the lengths of moving baffles were assumed to be 20 of that of the moving tank to study the characteristics of moving baffles coupled to a spring system the numerical results of free sloshing and sloshing in presence of moving baffles were obtained and compared with each other in this research the baffle size l b h was supposed to be 0 174 0 068 0 008 m and the mass of the spring system was 0 39 kg totally material properties considered for water in the numerical simulation are presented in table 1 furthermore the spring system applied in this paper to suppress the liquid sloshing in a rectangular tank are demonstrated in fig 8 while more detailed data on the dimension of the spring system are presented in table 2 the sloshing tank was supposed to be moved in the sway direction while eq 16 was applied to enforce the 1 dof motion of the tank in this section the excitation amplitude of the moving tank was supposed to be 0 075 m while the period of the motion was set to 1 35 s using eq 15 the water depth of the sloshing tank was assumed to be 37 of the tank height in order to facilitate definition of cases with various conditions some parameters were defined in the following order to show the case concisely filling ratio f excitation amplitude a absence and presence of the spring system s and period of excitation t for example a case with the filling ratio of 37 d h amplitude of 0 075 m in absence of the spring system s00 and excitation period of 1 35 s was denoted by f37a75s00t135 liquid sloshing results of a moving container in absence presence of moving baffles are compared with those of the experiments achieved by kim et al 2018 in figs 9 and 10 furthermore contours of velocity magnitude are also shown for better analysis based on figs 9 and 10 contours of velocity magnitude for liquid sloshing in absence presence of moving baffles are approximately the same at t 0 168 s and t 0 904 s since the waves are not collided with the baffles at t 0 168 s velocity magnitude on the left and right sides of the container are the highest while the arrangement of the velocity magnitude is reversed at t 0 904 s at t 1 328 s the flow rises after impacting with the tank walls in absence of moving baffles while the impact velocity is increased in comparison with that of free sloshing case as the flow collides with the spring baffles instead of the tank ceiling as can be seen from figs 9 and 10 the region on the left side of the tank has the lowest velocity magnitude in absence presence of moving baffles based on fig 10 velocity magnitude on the right side of the moving baffle has the highest value since the wall effects are decreased as the distance from the side walls increases as the time passes velocity magnitude throughout the body of the liquid for both cases decrease at t 1 456 s after collision of the flow with the moving baffle kinetic energy of the flow is decreased considerably at t 1 688 s in comparison with that of the flow in absence of moving baffles it should be mentioned that wall effects on the velocity magnitude are more pronounced in the second scenario where the flow is obstructed by the spring baffle at t 1 688 s at t 1 912 s the flow is collided with the tank ceiling again in the free sloshing case while a free jet flow in a horizontal direction is generated due to the impact of the waves with the spring baffle as shown in fig 10 velocity magnitude in the body of the liquid decreases for both cases at t 2 032 s although velocity magnitudes on the bottom of the flow for the two cases are considerably low at t 2 616 s but a horizontal free jet generated by impacting the flow with the tank ceiling has a higher velocity in comparison with that of the flow generated in presence of moving baffles it should be mentioned that maximum velocity magnitude at t 2 616 s for the free sloshing case is about 5 m s while the value of velocity magnitude in the region of generated free jet in presence of moving baffles are approximately 3 m s as the time passes the region occupied by the generated free jet spreads for the free sloshing case while the free jet in presence of moving baffles is suppressed at t 2 776 s as shown in both the experimental and numerical results fig 10 to study the effects of moving baffles on suppressing the kinetic energy of the liquid kinetic energy variations of the liquid sloshing undergoing a harmonic excitation in absence presence of moving baffles versus time are shown in fig 11 a based on fig 11a the difference between kinetic energy of liquid sloshing in absence and presence of moving baffles show that the flow collides with the moving baffles at t 1 2 s approximately it should be mentioned that maximum of kinetic energy of the liquid sloshing occurs at t 2 35 s approximately for both cases based on fig 11a maximum of kinetic energies of the liquid sloshing in absence presence of moving baffles are about 7 8 and 4 82 j in other words the moving baffle can decrease the maximum of kinetic energy of the liquid sloshing undergoing a harmonic excitation by 38 21 variations of kinetic energy amplitude versus its frequency for the liquid sloshing undergoing a harmonic excitation in presence absence of moving baffles are shown in fig 11b using fast fourier transform fft as shown in fig 11b maximum of kinetic energy amplitude occurs at low frequencies 0 33 hz for both cases f37a75s00t135 f37a75s01t135 and applying moving baffles can decrease the maximum of kinetic energy amplitude by 35 42 while its frequency remains approximately constant furthermore peak values of kinetic energy amplitude will decrease as the frequency is increased based on fig 11b as explained previously colliding the flow with the moving baffles can cause the impact velocity to increase and consequently kinetic energy of the liquid sloshing is increased to investigate the effects of moving baffles on suppressing the kinetic energy of the liquid sloshing more precisely the suppression rate of the kinetic energy is calculated as follows iranmanesh and passandideh fard 2017 17 suppression rate of kinetic energy t k e a v e f r e e t k e a v e b a f f l e t k e a v e f r e e 100 where the average of total kinetic energy for the free sloshing case and sloshing case with moving baffles are denoted by t k e a v e f r e e and t k e a v e b a f f l e respectively the results show that using moving baffles as a mitigation device of the liquid sloshing can decrease the total kinetic energy by nearly 20 5 to show the mechanism of the moving baffles in reducing the kinetic energy of liquid sloshing undergoing a harmonic excitation the velocity fields of the flow in absence presence of moving baffles are shown in fig 12 as can be seen from fig 12 the moving baffles mitigate the kinetic energy of liquid sloshing via two ways absorbing the kinetic energy of the liquid sloshing via the spring baffles and the recirculation zones generated in the liquid domain which dissipate the kinetic energy of the liquid as shown in fig 12 as can be seen from fig 12 no recirculation zone is generated in the liquid zone for the free sloshing case while a recirculation zone can be observed in presence of moving baffles it should be mentioned that these two parameters are considered implicitly in calculating the kinetic energy of the liquid to investigate the effects of moving baffles on reducing the normal forces exerted on the tank walls quantitatively the results of normal forces exerted on the left wall in absence of moving baffles are compared with those of numerical results calculated in presence of moving baffles in fig 13 at initial times a sudden increase in the amount of normal force exerted on the left wall is observed in presence of moving baffles the initial increase in the normal force values can be attributed to the impact of the spring baffle structure as well as the liquid body with the tank walls at most times the amplitudes of normal forces exerted on the tank walls are decreased as the flow collides with the moving baffles furthermore the highest decrease of the normal force value occurs at t 2 2 s approximately it should be mentioned that maximum forces exerted on the left wall in absence presence of moving baffles are about 109 and 78 n respectively showing that moving baffles can decrease the maximum of unwanted forces exerted on the tank walls by 28 44 3 3 the effects of various parameters on the liquid sloshing of a moving container in presence of moving baffles in this section the effects of various parameters namely the amplitude and frequency of excitation the filling ratio of the moving tank the spring stiffness and damping coefficient on the characteristics of liquid sloshing undergoing a harmonic excitation are investigated furthermore the efficiency of moving baffles in suppressing the liquid sloshing of a rectangular tank subjected to the seismic excitation is evaluated to investigate the effects of each parameter on the behavior of liquid sloshing more precisely only one favorite parameter is varied while the rest of factors are supposed to be constant for each case 3 3 1 harmonic excitation 3 3 1 1 the amplitude and frequency of excitation the effects of excitation amplitudes on the kinetic energy of liquid sloshing undergoing a harmonic excitation in absence presence of moving baffles are investigated in fig 14 a as can be seen from fig 14a the impact time of the flow with the moving baffle is decreased as the excitation amplitude increases furthermore the kinetic energy of the liquid sloshing at the initial times are approximately the same for the cases investigated from t 0 s to t 0 8 s based on fig 14a the highest decrease of the kinetic energy value due to presence of moving baffles occurs at peak points and the decrease rate of the kinetic energy value is increased as the excitation amplitude increases furthermore the time at which the peak points occur in fig 14a remain approximately constant for all cases investigated showing that the excitation amplitude has a minor effect on shifting the times at which peak points occur variations of kinetic energy amplitude versus its frequency for various excitation amplitudes are shown in figs 11b 14b and 14c applying moving baffles can decrease maximum of kinetic energy amplitudes for various excitation amplitudes investigated in figs 11b 14b and 14c furthermore the differences between maximum of kinetic energy amplitudes in presence and absence of moving baffles for amplitudes of 50 75 and 100 mm are 0 294 0 808 and 1 088 j respectively while the frequencies of these peak values will remain approximately constant as the excitation amplitude is increased in other words reduction rate of kinetic energy amplitudes due to using moving baffles will increase as the excitation amplitude is increased to study the effects of moving baffles on reducing the kinetic energy of liquid sloshing quantitatively suppression rate of liquid sloshing for three excitation amplitudes are calculated and compared with each other in table 3 although the highest decrease of the peak point value occurs at the highest amplitude but suppression rate of the average kinetic energy for the intermediate value of excitation amplitude is the highest among the cases investigated the effects of the excitation amplitude on the normal forces exerted on the left wall of a moving container undergoing a harmonic excitation are investigated in figs 13 15 and 16 based on these figures moving baffles can decrease the maximum force exerted on the tank walls efficiently for the three amplitudes investigated furthermore the maximum force exerted on the tank wall at initial times is increased as the excitation amplitude increases it should be mentioned that the case with the highest amplitude will also exert the highest normal force on the left wall as expected variations of normal force amplitude exerted on the left wall of moving container versus frequency are illustrated for excitation amplitudes of 50 75 and 100 mm in figs 17 19 respectively based on these figures moving baffles can decrease maximum of normal force amplitude exerted on the left wall of moving container for all cases furthermore maximum of normal force amplitude impacted on the left wall of the container increases as the excitation amplitude is increased the differences between maximum of normal force exerted on the left wall in presence and absence of moving baffles for excitation amplitudes of 50 75 and 100 mm are 3 613 2 26 and 0 854 n respectively in other words the container subjected to the lowest excitation amplitude will experience the highest decrease of normal force amplitude the effects of excitation periods on the kinetic energy of liquid sloshing undergoing a harmonic excitation are illustrated in fig 20 a excitation periods have a minor effect on the kinetic energy of liquid sloshing from t 0 s to t 0 5 s as the time passes the excitation period role becomes more prominent similar to the excitation amplitude the highest decrease of the kinetic energy value occurs at peak points when the excitation period equals the resonance period t 1 35 s the peak points in fig 20a experiences the highest decrease among the cases investigated it should be mentioned that the impact time of the flow with moving baffles is decreased as the excitation period decreases variations of kinetic energy amplitude versus its frequency for various excitation periods are illustrated in figs 11b 20b and 20c the differences between maximum of kinetic energy amplitudes in presence and absence of moving baffles for excitation periods of 1 5 1 35 and 1 23 s are 0 703 0 808 and 0 733 j respectively in other words maximum of kinetic energy amplitude will experience the highest decrease as the excitation period equals the resonance period t 1 35 s it should be mentioned that maximum of kinetic energy amplitude occurs at low frequencies for all excitation periods investigated in this research to analyze the behavior of the excitation period more precisely suppression rates of kinetic energy due to using moving baffles as a mitigation device are shown in table 4 as expected the highest decrease of the kinetic energy of liquid sloshing occurs when the tank is excited with the resonance period iranmanesh and passandideh fard 2017 also applied a submerged cylinder as a suppression device to mitigate the liquid sloshing undergoing a harmonic excitation and it was concluded that the highest suppression rate occurred when the tank was excited with the resonance period the effects of excitation periods on the normal forces exerted on the left wall of a moving container in absence presence of moving baffles are presented in figs 13 21 and 22 based on these figures the case with the lowest excitation period exerts the highest initial force on the left wall of the moving tank at initial times for all cases investigated maximum of force exerted on the tank wall can be decreased well using the moving baffles in comparison with that of the free sloshing case variations of normal force amplitude exerted on the left wall of a moving container versus frequency are presented for various excitation periods in figs 18 23 and 24 based on these figures applying moving baffles can decrease maximum of normal force amplitude for excitation periods of 1 50 1 35 and 1 23 s the differences between maximum of normal force amplitude in presence and absence of moving baffles for excitation periods of 1 50 1 35 and 1 23 s are 1 301 2 26 and 1 20 n respectively in other words maximum of normal force amplitude will experience the highest decrease as the excitation period equals the resonance period t 1 35 s 3 3 1 2 the filling ratio the effects of filling ratio on the kinetic energy of liquid sloshing and forces exerted on the left and right moving baffles are studied numerically in this section the filling ratio is supposed to be 20 25 32 37 and 44 50 and 60 while the rest of parameters are assumed to be constant the effects of filling ratio on the kinetic energy of a moving container undergoing a harmonic excitation are illustrated in fig 25 a based on fig 25a kinetic energy deviations of liquid sloshing in absence presence of moving baffles are minor before t 0 5 s for all cases investigated as the time passes suppression rate of kinetic energy at peak points increases as filling ratio increases as can be seen from fig 25a the case with the filling ratio of 60 experiences the most suppression rate of kinetic energy at peak points variations of kinetic energy amplitude versus frequency for various filling ratios of 20 37 and 50 are illustrated in figs 25b 11b and 25c the differences between maximum of kinetic energy amplitudes in presence and absence of moving baffles for filling ratios of 20 37 and 50 are 0 116 0 808 and 1 693 j respectively in other words reduction rate of kinetic energy amplitudes due to using moving baffles increases as the filling ratio is increased to analyze the effects of filling ratio on the kinetic energy of liquid sloshing quantitatively the suppression rate of kinetic energy for various filling ratios are calculated and compared with each other in table 5 based on table 5 capability of moving baffles in reducing the kinetic energy of liquid sloshing will increase as the filling ratio increases the amounts of forces exerted on the left and right moving baffles are illustrated in figs 26 and 27 for various filling ratios based on figs 26 and 27 the forces exerted on the left and right moving baffles are minor for low filing ratios 20 and 25 while the amounts of forces exerted on the left moving baffle become major for intermediate filling ratios 32 37 and 44 for high filling ratios 50 and 60 the amounts of forces acting on the right moving baffle are the highest as observed in fig 27 it should be mentioned that the highest impact forces on the left and right moving baffles occur for filling ratio of 50 3 3 1 3 the spring stiffness in this section the effects of the spring stiffness on both the kinetic energy of liquid sloshing undergoing a harmonic excitation and normal forces exerted on the tank wall are studied fig 28 the value of the spring stiffness is supposed to be 1000 2000 and 3000 n m while other parameters are kept constant as shown in fig 28 the effect of the spring stiffness on peak values of kinetic energy chart is minimum from t 0 s to t 1 8 s while the amount of kinetic energy for the case with k 1000 n m increases slightly between t 1 8 s and 2 2 s this time period is exactly the moment that the flow collides with the right moving baffle as the time passes deviation between the values of kinetic energy for the three cases k 1000 2000 and 3000 n m decreases to investigate the spring stiffness influence on the kinetic energy of liquid sloshing more exactly suppression rates of kinetic energy for the cases studied are calculated and presented in table 6 as expected suppression rates of kinetic energy for the cases studied are rarely influenced by the spring stiffness the normal force values for the cases with various spring stiffnesses are calculated and compared in fig 29 based on fig 29 normal force values exerted on the tank wall are highly influenced by the spring stiffness some peak values in the normal force for the case with k 1000 n m are observed between t 0 25 s and 0 85 s in fig 29 the increase of the normal force values can be attributed to the structure oscillations induced by the sloshing excitation since these oscillations are mostly decreased as the spring stiffness increases although the spring stiffness effect on the kinetic energy of liquid sloshing is minor but the normal force exerted on the left wall can be highly influenced by the spring stiffness as can be seen from fig 29 the case with the lowest spring stiffness k 1000 n m experiences the highest normal force exerted on the left wall at t 2 4 s since the fluid flow impacts with the left moving baffle the normal force on the left wall will decrease as the spring stiffness is increased at t 2 4 s based on fig 29 in order to dampen these oscillations it is recommended to arrange a damper in parallel with the spring of moving baffles feasibility of reducing the normal force oscillations induced by the liquid sloshing via arranging a damper in a parallel configuration with the spring is investigated in section 3 3 1 4 the effects of spring stiffness on the non dimensional pressure at points p1 and p2 shown in fig 7 are investigated in fig 30 based on fig 30 non dimensional pressure at point p1 is highly influenced by spring stiffness compared to that at point p2 as the spring stiffness increases non dimensional pressure decreases while the normal force impacting on the moving baffle increases in other words the velocity of horizontal jet induced by the moving baffle will increase as the spring stiffness increases kim et al 2018 therefore the dynamic pressure will also increase since the dynamic pressure is proportional to the velocity magnitude furthermore the amounts of non dimensional pressure at points p1 and p2 for k 1000 and 3000 n m are the highest at t 2 4 s based on fig 30 since the fluid flow impacts with the left moving baffle as can be seen from fig 30 the amount of non dimensional pressure at points p1 and p2 will decrease as the spring stiffness is increased it should be mentioned that reduction rate of non dimensional pressure at point p1 will be higher than that of point p2 at t 2 4 s because of its proximity to the left moving baffle 3 3 1 4 the effects of damping coefficient on the suppression rate of liquid sloshing for various spring stiffnesses as stated in section 3 3 1 3 the effect of the spring stiffness on the kinetic energy of liquid sloshing was minor while the amount of normal force exerted on the left wall increased for the case with low spring stiffness k 1000 n m therefore feasibility of using a damper in a parallel configuration with the spring is investigated numerically in this section the amounts of normal forces exerted on the left wall of a moving container for the cases with various damping coefficients are compared with each other in fig 31 as shown in fig 31 the normal force oscillations generated via liquid sloshing are dampened between t 0 25 s and t 0 85 s well via applying a damper furthermore the amounts of normal force exerted on the left wall decrease as the damping coefficient increases based on fig 31 3 3 2 seismic excitation in this section the performance of moving baffles of a rectangular tank subjected to a seismic excitation 2018 sarpol e zahab earthquake is investigated numerically it should be mentioned that only the excitation type is varied in this section and the rest of parameters are the same as those presented in section 3 3 1 time variations of the acceleration in the x direction enforced to the moving tank are presented in fig 32 kinetic energy of liquid sloshing in a rectangular tank subjected to the seismic excitation in presence absence of moving baffles are compared in fig 33 based on fig 33 maximum of kinetic energy can be diminished using moving baffles to analyze the efficiency of moving baffles in reducing kinetic energy of liquid sloshing quantitatively suppression rate of kinetic energy of the rectangular tank due to using moving baffles are presented in table 7 based on table 7 using moving baffles can suppress the kinetic energy of liquid sloshing by 10 the amounts of normal forces exerted on the left wall of a rectangular container in presence absence of moving baffles are shown in fig 34 based on fig 34 moving baffles approximately decrease the maximum force exerted on the left wall of the container by 62 it should be mentioned that the role of moving baffles in decreasing the maximum of normal forces exerted on the left wall is more prominent that that of moving baffles in suppressing the kinetic energy of liquid sloshing of a rectangular tank subjected to the seismic excitation 4 conclusions in this paper feasibility of using moving baffles as a mitigation device to decrease the kinetic energy of liquid sloshing was investigated using the cel technique firstly the cel approach was validated quantitatively via calculating and comparing the free surface elevation on the left side of the tank with those obtained from a cfd approach secondly liquid sloshing of a moving container undergoing harmonic and seismic excitations in absence presence of moving baffles were simulated using the cel technique the top of the rectangular tank was closed and the value of pressure on the liquid free surface was equal to atmospheric pressure initially furthermore the position of the spring system was supposed to be fixed in this research next the effects of various parameters namely amplitude and frequency of excitation filling ratio spring stiffness and damping coefficient on both the kinetic energy of liquid sloshing and normal force exerted on the tank wall were studied comprehensively experimental results on suppressing liquid sloshing of cylindrical and spherical containers using moving baffles were not available in the literature therefore it is recommended to investigate the feasibility of moving baffles in suppressing liquid sloshing of cylindrical and spherical tanks under various excitations experimentally and numerically as future works the following conclusions were finally obtained in the research briefly 1 the impact velocity for the sloshing case with moving baffles was increased as the flow collided with the moving baffles initially in comparison with that of the free sloshing case 2 the moving baffles suppressed the kinetic energy of liquid sloshing via two ways absorbing the kinetic energy of the liquid sloshing via the spring baffles and the recirculation zones generated in the liquid domain which dissipated the kinetic energy of the liquid 3 the impact time of the flow with the moving baffle was decreased as the excitation amplitude increased 4 capability of moving baffles in reducing the kinetic energy of liquid sloshing would increase as the filling ratio increased 5 the spring stiffness of moving baffles had a minor effect on the suppression rate of sloshing kinetic energy 6 the normal force oscillations generated via liquid sloshing were dampened well via applying a damper for the sloshing case with low spring stiffness credit authorship contribution statement a iranmanesh conceptualization methodology software visualization writing original draft preparation writing review editing project administration r nikbakhti investigation data curation validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20810,in this paper feasibility of applying moving baffles linked to a spring system as a mitigation device to suppress liquid sloshing of a container undergoing a harmonic and seismic excitation is investigated numerically using the coupled eulerian lagrangian cel technique the interaction between the eulerian fluid domain where the material can pass through the mesh and the lagrangian tank domain where the material is supposed to be fixed to the mesh is modelled using the cel capability of abaqus software firstly free sloshing of a rigid deformable tank is achieved and the numerical results are compared with those of the experiment to validate the numerical simulation quantitatively secondly liquid sloshing of a moving container in absence presence of moving baffles is simulated and compared with those of the experimental cases qualitatively furthermore the effects of various parameters namely excitation amplitude and frequency filling ratio spring stiffness and damping coefficient on both the sloshing kinetic energy and normal forces exerted on the tank wall are investigated separately the results show that the spring stiffness effects on the kinetic energy of liquid sloshing is minor while the normal force exerted on the left wall can be highly influenced by the spring stiffness keywords free surface flows liquid sloshing moving baffle spring system two phase flows 1 introduction collision of the liquid with the inner surface of a containing tank due to the relative motion between them is called liquid sloshing studying liquid sloshing is of great importance since the internal structures of a tank can be subjected to structural failure due to the repeated impact loads exerted on them these impact loads become even more severe when the tank is excited with a frequency which is equal to natural frequency of the liquid within the tank therefore mitigating liquid sloshing of a container is highly interested in the field of marine engineering and naval architecture due to its pivotal role especially in transportation of natural gas oil and liquids faltinsen and timokha 2009 ibrahim 2005 so many researches have been achieved on liquid sloshing in rectangular and cylindrical tanks so far using theoretical and experimental approaches due to complexity and non linearity of this phenomenon experimental studies are highly preferred to be accomplished instead of analytical and numerical methods an analytical solution for 2d liquid sloshing of rectangular tanks was introduced by faltinsen 1978 this analytical model was used by so many researchers to validate the numerical models chiba 1995 and dutta and laha 2000 proposed baffles to suppress liquid sloshing of a moving container since the liquid viscosity had a minor effect on increasing the hydrodynamic damping rate choun and yun 1996 1999 applied the small amplitude wave theory to study liquid sloshing of rectangular tanks in presence of a bottom mounted rectangular block liu and lin 2008 introduced a second order volume of fluid vof scheme to capture break up in free surfaces during nonlinear liquid sloshing the turbulence effects were also studied via the large eddy simulation les approach in the research tippmann et al 2009 applied the cel approach to simulate a two dimensional liquid sloshing in a rectangular tank using abaqus software the authors improved the solution time via decreasing the sound wave speed for the equation of state material model the authors also assumed the tank geometry to be deformable to analyze the deformation and stresses in the tank due to the liquid sloshing it was concluded that the cel technique had a high capability to simulate the fluid structure interaction for a special type of problems liu and lin 2009 applied the virtual boundary force method to simulate the liquid sloshing in presence of the vertical baffles within the tank in a later research maleki and ziyaeifar 2008 examined the feasibility of applying ring baffles to suppress liquid sloshing of circular cylindrical tanks via conducting some experiments during the test the excitation amplitudes were 0 4 and 1 5 mm while the amounts of relative depth water depth to the height of the tank were supposed to be 0 17 0 25 0 42 0 63 and 0 83 during the experiment it was reported that using ring baffles were an efficient way to mitigate the sloshing waves eswaran et al 2009 applied the vof technique with arbitrary lagrangian eulerian ale formulation to study liquid sloshing for baffled and un baffled tanks the adina software was used to obtain the response of the coupled system the results showed that sloshing effects for the baffled tank could be diminished efficiently panigrahy et al 2009 accomplished some experiments on the liquid sloshing set up to estimate efficacy of baffles in mitigating the liquid sloshing waves the excitation frequency and water depth in the square tank were varied and the free surface elevation of water from the mean static level and the pressure variations on the tank walls were studied experimentally the experiments were achieved for the baffled and unbaffled tanks and the results were analyzed thiagarajan et al 2011 simulated liquid sloshing in a 2d rectangular tank subjected to the sway excitation the vof technique was applied to track the air water interface while a finite volume approximation was used to model the fluid domain the effects of various parameters namely the fill levels and excitation time periods on the liquid sloshing dynamics were studied and the numerical results were compared with those of theoretical predictions available in the literature wang et al 2013 investigated the feasibility of applying multiple annular rigid baffles as a mitigation device to suppress liquid sloshing in a rigid cylindrical tank experiencing lateral excitation the authors finally discussed various parameters namely the hydrodynamic pressure distribution height of surface wave and hydrodynamic momentum and force of a tank under harmonic and seismic excitations in their research koh et al 2013 applied a constrained floating baffle to suppress liquid sloshing in a rectangular container using the improved consistent particle method cpm the authors validated the introduced algorithm by free sloshing and hydrostatic cases having less spurious fluctuations the authors also conducted some experiments to validate the numerical results obtained hwang et al 2016 modelled liquid sloshing in rolling rectangular tanks with elastic baffles using a modified particle based fluid structure interaction fsi solver the authors supposed the rolling amplitude to be 4 while the period of rolling motion was assumed to be 85 of natural period of the container the results of sloshing with various configurations including sloshing without any baffle with a rigid baffle and a set of flexible baffles were analyzed and compared with each other in the research iranmanesh and passandideh fard 2017 investigated the feasibility of using a submerged cylinder as a mitigation device to suppress liquid sloshing in a rectangular container the sloshing tank was moved with both a constant acceleration and single oscillatory excitation the free surface deformation was reconstructed using the vof approach the authors compared the results of liquid sloshing in presence of a submerged cylinder with those obtained from the experiments of free sloshing with no cylinder it was finally concluded that a submerged cylinder had an outstanding role in mitigating liquid sloshing when the sloshing tank was excited with the single oscillatory excitation kim et al 2018 conducted some experiments to restrain violent liquid sloshing in a rectangular tank using moving baffles coupled to a spring system the experimental results for free liquid sloshing were compared with those obtained from liquid sloshing of a container with moving baffles the experimental results showed that the sloshing phenomenon was suppressed effectively using the spring connected horizontal baffles zhang et al 2019 examined an anti sloshing technique to suppress liquid sloshing of a container undergoing a harmonic excitation the authors studied the experimental observations using an analytical potential flow solution the wave profiles and dynamic pressure histories for various layers of floating foams were obtained and analyzed it was deduced that the sloshing amplitude would decrease even by applying a single layer of floating foams ünal et al 2019 studied the effects of using t shaped baffles on suppressing liquid sloshing of a rectangular tank the authors varied various parameters including filling depths baffle heights and the rotation angle to investigate the effects of these parameters on the free surface elevations and hydrodynamic loads on the tank wall it was finally concluded that the baffle height had a major role on the wave damping and pressure when its height was supposed to be larger than 80 of the liquid depth nasar and sannasiraj 2019 studied the behavior of porous baffle arrangements in a barge carrying liquid container on the sloshing dynamics experimentally the sloshing container was subjected to regular beam sea waves while the filling ratio of the tank was assumed to be 75 the excitation frequencies of the generated wave were varied between 0 45 hz and 1 54 hz while the wave height was supposed to be 0 1 m the authors also discussed the effects of the baffle position on the sloshing dynamics zhang 2020 applied finite difference method to study the sloshing modal properties including sloshing mode shapes and sloshing frequencies of sloped bottom tuned liquid dampers tld it was found the sloshing mode shapes of the shallow water sloped bottom tld were not similar to those of the deep water sloped bottom tld jin et al 2020 conducted some experiments to investigate the viscous influence on the liquid sloshing of a container under resonant and off resonant condition the authors chose tap water and glycerin at various temperatures as the experimental fluids the authors obtained a viscosity threshold where the sloshing slowly shifted from the resonant steady state to the harmonic state das et al 2020 accomplished some experiments to estimate the capability of using u shaped containers as liquid dampers in tall buildings the tall buildings were subjected to free and forced vibration tests and liquid sloshing effects on the response control of tall buildings were analyzed they also applied both 2d and 3d numerical models to simulate liquid sloshing in u shaped containers the numerical results were in good agreement with those of the experiments zheng et al 2020 developed a numerical model to investigate the effects of a porous bottom layer on sloshing dynamics in a rectangular tank with single and multi layered fluids the authors analyzed the effects of excitation frequency permeability and porosity values of the bottom layer on the dynamics of sloshing the results showed that damping capability increased as porosity ratios and permeability values of the porous bottom layer were decreased ma et al 2021 investigated the feasibility of applying single and double vertical baffles to suppress violent transient sloshing numerically the damping effects of single and double vertical baffles were evaluated via measuring the liquid elevation energy dissipation and total impact pressure it was reported that arrangement of multiple baffles had a determinant role on damping effects liu et al 2021 developed a multi layered vof method to simulate two layered liquid sloshing in a rectangular tank subjected to horizontal excitations the authors applied experimental data and linear analytical solution to evaluate the accuracy of numerical results the numerical results were in good agreement with those of analytical solution when nonlinearity was supposed to be weak furthermore two natural frequencies were observed for two layered liquid sloshing while the larger frequency was associated with the upper layer feasibility of using porous and non porous baffles to suppress liquid sloshing of both rectangular and cylindrical containers have been investigated comprehensively by many researchers in the literature while the baffles are supposed to be fixed during the analysis however capability of using moving baffles in suppressing liquid sloshing of a moving container has not been studied by the researchers numerically so far therefore feasibility of using moving baffles as a mitigation device to suppress liquid sloshing of a rectangular container undergoing harmonic and seismic excitations is investigated numerically in this paper firstly liquid sloshing of a rigid deformable container is achieved using the cel technique and the numerical results are compared with the results available in the literature to validate the cel technique quantitatively secondly liquid sloshing of a moving container in absence presence of moving baffles is modelled and numerical results are compared with those of the experiment qualitatively in order to confirm that liquid sloshing of a moving container can be suppressed efficiently via using moving baffles the effects of various parameters namely excitation amplitude and frequency filling ratio spring stiffness and damping coefficient on both the suppression rate of kinetic energy and normal forces exerted on the left wall of a moving container are studied separately 2 computational model and governing equations 2 1 the cel approach in this paper liquid sloshing in a rectangular container with without moving baffles are simulated using the cel technique presented in the commercial software abaqus it is not possible to model the flow problems using the lagrangian elements due to violent mesh distortion it is proposed to simulate fluid flow problems using the eulerian elements since the eulerian mesh does not have any deformation the lagrangian element is applied to simulate the tank wall while the eulerian element is used to simulate the liquid in the cel approach stresses and computed pressures in the eulerian mesh are enforced on the lagrangian cells as external loads in the cel approach in other words the lagrangian mesh operates like a boundary condition applied on the flow of material in the eulerian meshes qiu et al 2011 the computational nodes are supposed to be fixed within the material in a lagrangian analysis while both the material and the elements can have deformation together in a lagrangian approach the element boundary is the same as the material boundary since the lagrangian elements are always filled with a material the computational nodes in an eulerian analysis are assumed to be fixed in space while they do not have any deformation when the material moves through them unlike the lagrangian analysis the eulerian elements may be void and partially filled in an eulerian analysis and the material does not always occupy total volume of eulerian elements therefore it is necessary to calculate the eulerian material boundary at each time step since an element boundary does not coincide with the eulerian material boundary to provide enough space for the material to flow and deform the domain of eulerian is supposed to be large enough to cover the eulerian material boundaries in the cel technique the liquid and the tank wall interactions are simulated using the general contact algorithm in which hard contact interaction is defined in the normal and tangential directions it should be mentioned that it is not needed to define extra solvers for simulating the liquid region singly in the cel approach the flowchart of finite element procedure achieved in the cel approach is shown in fig 1 it should be mentioned that the commercial software abaqus applies the vof technique to track free surface deformation in the eulerian implementation by defining a separate volume fraction tool in each eulerian element the free surface deformation is tracked when the liquid moves through the mesh the eulerian volume fraction evf is denoted by a scalar field f which varies between zero 0 and one 1 f 1 refers to the case when the total volume of the element is occupied by the liquid while the completely void elements are shown by f 0 when the amount of the evf varies between 0 and 1 it is interpreted that the elements are partially filled with the liquid therefore the evf is defined as follows 1 f x y t i f f 0 e m p t y i f 0 f 1 p a r t i a l l y f i l l e d i f f 1 f i l l e d during the analysis it is necessary to update the amount of f while the mesh is restored in every incremental step an eulerian lagrangian contact algorithm is applied to enforce the interaction between an eulerian and a lagrangian continuum in the cel approach it should be noted that an eulerian lagrangian contact algorithm is ignored at the nodes with a material volume fraction lower than 0 5 by using the central difference operator along with the lagrange plus remap formulation the eulerian time integration is accomplished in the explicit method in the explicit method the numerical approach is conditionally stable in other words the solution diverges and becomes unstable if the time increment is too big the stable time increment can be estimated by 2 δ t min l e c d where l e stands for the characteristic element length and the dilatational wave speed of the material is shown by c d c d can be obtained for a linear elastic material by 3 c d λ 2 μ ρ where lame s constants are denoted by λ and μ and ρ stands for the material density if a finite element mesh of a single material is considered the stable time increment will be determined by the smallest element in the mesh 2 2 material properties 2 2 1 hugoniot curve and energy equation the rate of exchanged heat and the rate at which work is being done by the stresses determine the increase rate of internal energy per unit mass em by solving the energy equation if the heat conduction term is being neglected in the energy equation the equation for conservation of energy can be simplified as follows abaqus 6 11 documentation 2011 4 ρ e m t p p b v 1 ρ ρ t s e ρ q where ρ and p stand for the density and pressure stress respectively while the pressure stress is supposed to be positive in compression the pressure stress due to the bulk viscosity is denoted by p b v the deviatoric stress tensor deviatoric part of strain rate and rate of heat per unit mass are shown by s e and q respectively the relationship among the pressure p density ρ and internal energy per unit mass e m can be determined using a mathematical function known as equation of state h defined as follows 5 p h ρ e m all the equilibrium states in a material can be characterized using eq 5 to obtain a relationship between p and 1 ρ or p and v v stands for current volume the term of internal energy in eq 5 should be eliminated the unique equation determining the relationship between p and 1 ρ is known as the hugoniot curve this curve shows the locus of p v states behind a shock the hugoniot curve is illustrated in fig 2 isbell et al 1968 it should be mentioned that the hugoniot pressure ph depends only on the density and this factor can be specified using fitting experimental data the equation of state is linear in energy when it is written as follows 6 p f g e m the equation of state model determines f ρ and g ρ and these parameters f and g are only mathematical functions of the density 2 2 2 mie grüneisen equation of state the most common form of mie grüneisen equation of state which is linear in energy can be written as follows 7 p p h γ ρ e m e h where the hugoniot pressure and specific internal energy are shown by p h and e h respectively the grüneisen ratio is denoted by γ which is defined as follows 8 γ γ 0 ρ 0 ρ the reference density and material constant are shown by ρ 0 and γ 0 respectively the relationship between the hugoniot pressure p h and hugoniot energy e h can be determined using the following equation 9 e h p h η 2 ρ 0 10 η 1 ρ 0 ρ the nominal volumetric compressive strain is denoted by η after substituting the amounts of γ and e h into eq 7 its final form is simplified to eq 11 11 p p h 1 γ 0 η 2 γ 0 ρ 0 e m it should be mentioned that the energy equation and equation of state should be solved simultaneously in commercial software abaqus since they are coupled together via pressure and internal energy 2 2 3 linear us up hugoniot form by accomplishing a common fit to the hugoniot data one can write 12 p h ρ 0 c 0 2 η 1 s η 2 by defining c 0 and s the linear relationship between the shock velocity u s and particle velocity u p can be determined using eq 13 13 u s c 0 s u p by substituting eq 12 into eq 11 the linear linear us up hugoniot form can be written as follows abaqus 6 11 documentation 2011 14 p ρ 0 c 0 2 η 1 s η 2 1 γ 0 η 2 γ 0 ρ 0 e m by calculating the amount of ρ 0 c 0 2 the elastic bulk modulus at small nominal strains can be evaluated in this research the incompressible viscous flow can be simulated using a linear us up equation of state model the equation of state governs the volumetric response and the bulk modulus is considered to be a penalty parameter for the incompressible constraint the linear us up hugoniot form of the mie grüneisen equation of state is applied to simulate the water the amounts of density and bulk modulus for water are 998 kg m3 and 2 094 gpa material properties considered for water in this research are presented in table 1 3 results and discussion 3 1 mesh refinement study and validation 3 1 1 free liquid sloshing of a rigid tank in this paper the results of liquid sloshing in a rectangular container were compared with those of cfd simulation star ccm to evaluate the accuracy of the cel technique the fundamental sloshing frequency of the liquid inside a rectangular tank f n can be predicted using the linear wave theory love et al 2020 15 f n 1 2 π π g l tanh π d l where l d and g stand for the length of tank water depth and gravity acceleration respectively it should be mentioned that liquid motion was assumed to be irrotational inviscid and incompressible to derive eq 15 wave motions were also supposed to be linear while the walls of tank were assumed to be vertical furthermore the liquid sloshing in a tank was considered to be the superposition of a progressing wave and its reflection wave in order to have natural frequency of 1 hz the length of tank l and water depth d were supposed to be 0 61 m and 0 20 m respectively the schematic diagram of the oscillating tank is illustrated in fig 3 the simulated tank was composed of the tank wall and water in the cel technique the tank wall was modelled using lagrangian elements while eulerian elements were applied to simulate water it should be noted that tank walls were modelled using shell elements with a very small thickness since the tank was supposed to be rigid in order to determine the initial region occupied by water the eulerian part was partitioned the void material option was attributed to all other partitions during the step of material assignment in this research linear us up hugoniot form was used as a governing equation to simulate water the sound wave speed of water was supposed to be 1483 m s in this research the water tank was supposed to be excited using the following equation 16 x a sin 2 π f d t where a and f d stand for the amplitude and frequency of excitation respectively the amount of excitation amplitude was supposed to be 0 0054 m while driving frequency of the water tank f d was assumed to be 1 09 f n in this simulation 3d eight node eulerian continuum element with reduced integration ec3d8r was applied to simulate the water while the rigid container was modelled using a three dimensional four node bi linear quadrilateral discrete rigid element r3d4 as illustrated in fig 4 in order to validate the cel approach achieved in abaqus the free surface elevation on the left side of the tank was compared with those obtained from a cfd approach free surface elevation on the left side of the moving tank was calculated via multiplying the element height by summation of all of water volume fraction values for the vertical column of elements in order to investigate the mesh refinement study the number of cells per the tank length cpl was defined the cpl was increased until no remarkable changes in the kinetic energy of liquid sloshing were observed the results of mesh refinement study for the rectangular rigid tank are illustrated in fig 5 based on fig 5 the amount of cpl was finally selected to be 240 to simulate the liquid sloshing of a rectangular container using the cel technique at initial stages the wave amplitude was considerable low while sudden changes in the kinetic energy of liquid sloshing were observed until t 0 8 s these sudden changes can be attributed to the inertia effects after the transient stage the wave amplitude varied uniformly between t 0 8 s and t 3 0 s and sudden oscillations in the amounts of the kinetic energy were removed it should be mentioned that the amplitude of kinetic energy of the liquid sloshing would increase as the time passed between t 0 8 s and t 3 0 s the results of free surface elevation on the left side of the rigid tank obtained from the cel approach are compared with those of a cfd method tippmann et al 2009 in fig 6 based on fig 6 the numerical results computed by the cel approach for the rigid tank were in good agreement with those of the cfd method in terms of the wave amplitude and frequency furthermore amplitude of the wave height would increase from t 0 0 s to t 5 0 s as the time passed 3 1 2 free liquid sloshing of a flexible tank in this section liquid sloshing in a flexible container is simulated using the same model presented for the rigid container analysis to validate the numerical approach for the liquid sloshing of a flexible tank the results of free surface elevation on the left side of a moving container were compared with those of the numerical approach achieved by tippmann et al 2009 as shown in fig 6 the tank walls were supposed to be composed of generic steel while the wall thickness was supposed to be 0 01 m the amount of driving frequency for the flexible case was supposed to be 0 9 f n furthermore the results of liquid sloshing in a rigid tank were compared with those of the flexible tank in fig 6 to study the effects of flexibility and driving frequency on the wave height simultaneously as shown in fig 6 at initial times from t 0 0 s to t 1 0 s the effect of flexibility on the wave height is higher than that of the driving frequency as the time passed from t 1 0 s to t 5 0 s the effects of driving frequency on the wave height became major compared to those of flexibility as can be seen from fig 6 a decrease in the amount of the wave height is observed for the flexible tank compared with that of the rigid tank due to the flexibility effects it should be mentioned the frequency of the wave is not affected by the flexibility effects while driving frequency can change the frequency and amplitude of the wave as shown in fig 6 3 2 investigating the feasibility of applying moving baffles in suppressing the kinetic energy of liquid sloshing under a harmonic excitation in this section the results of liquid sloshing in a rectangular tank in absence presence of moving baffles are compared with those of the experiments available in the literature kim et al 2018 in other words the mechanism of using moving baffles coupled to a spring system are studied and investigated in detail the tank with a size of l b h of 0 874 0 07 0 535 m was simulated and analyzed in this paper as shown in fig 7 the tank was supposed to be made of transparent acrylic since it was possible to capture the flow motion furthermore the time step size value was supposed to be 3 48 10 6 s the top of the rectangular tank was closed and the value of pressure on the liquid free surface was equal to atmospheric pressure initially furthermore the top box was fixed to the rectangular tank and its material was supposed to be the same as that of the tank the mechanism and dimension of spring linked baffles are illustrated in fig 8 based on fig 8 two springs were arranged and fixed between the top box and moving baffles on the left and right sides of the simulated tank the moving baffles coupled to a spring system were supposed to have only 1 dof motion in the downward and upward directions this assumption was made to eliminate any jig generated in each spring in order to guarantee the smooth motion of the moving baffles a space of 1 mm in the widthwise and lengthwise directions was considered to eliminate unwanted friction generated between the moving tank and baffles the springs were free to move in the upward direction while they were constrained in the downward direction at their initial positions furthermore both springs were supposed to be in the free length condition at their initial states the material of the moving baffles was selected to be the same transparent acrylic as the material of the tank while the lengths of moving baffles were assumed to be 20 of that of the moving tank to study the characteristics of moving baffles coupled to a spring system the numerical results of free sloshing and sloshing in presence of moving baffles were obtained and compared with each other in this research the baffle size l b h was supposed to be 0 174 0 068 0 008 m and the mass of the spring system was 0 39 kg totally material properties considered for water in the numerical simulation are presented in table 1 furthermore the spring system applied in this paper to suppress the liquid sloshing in a rectangular tank are demonstrated in fig 8 while more detailed data on the dimension of the spring system are presented in table 2 the sloshing tank was supposed to be moved in the sway direction while eq 16 was applied to enforce the 1 dof motion of the tank in this section the excitation amplitude of the moving tank was supposed to be 0 075 m while the period of the motion was set to 1 35 s using eq 15 the water depth of the sloshing tank was assumed to be 37 of the tank height in order to facilitate definition of cases with various conditions some parameters were defined in the following order to show the case concisely filling ratio f excitation amplitude a absence and presence of the spring system s and period of excitation t for example a case with the filling ratio of 37 d h amplitude of 0 075 m in absence of the spring system s00 and excitation period of 1 35 s was denoted by f37a75s00t135 liquid sloshing results of a moving container in absence presence of moving baffles are compared with those of the experiments achieved by kim et al 2018 in figs 9 and 10 furthermore contours of velocity magnitude are also shown for better analysis based on figs 9 and 10 contours of velocity magnitude for liquid sloshing in absence presence of moving baffles are approximately the same at t 0 168 s and t 0 904 s since the waves are not collided with the baffles at t 0 168 s velocity magnitude on the left and right sides of the container are the highest while the arrangement of the velocity magnitude is reversed at t 0 904 s at t 1 328 s the flow rises after impacting with the tank walls in absence of moving baffles while the impact velocity is increased in comparison with that of free sloshing case as the flow collides with the spring baffles instead of the tank ceiling as can be seen from figs 9 and 10 the region on the left side of the tank has the lowest velocity magnitude in absence presence of moving baffles based on fig 10 velocity magnitude on the right side of the moving baffle has the highest value since the wall effects are decreased as the distance from the side walls increases as the time passes velocity magnitude throughout the body of the liquid for both cases decrease at t 1 456 s after collision of the flow with the moving baffle kinetic energy of the flow is decreased considerably at t 1 688 s in comparison with that of the flow in absence of moving baffles it should be mentioned that wall effects on the velocity magnitude are more pronounced in the second scenario where the flow is obstructed by the spring baffle at t 1 688 s at t 1 912 s the flow is collided with the tank ceiling again in the free sloshing case while a free jet flow in a horizontal direction is generated due to the impact of the waves with the spring baffle as shown in fig 10 velocity magnitude in the body of the liquid decreases for both cases at t 2 032 s although velocity magnitudes on the bottom of the flow for the two cases are considerably low at t 2 616 s but a horizontal free jet generated by impacting the flow with the tank ceiling has a higher velocity in comparison with that of the flow generated in presence of moving baffles it should be mentioned that maximum velocity magnitude at t 2 616 s for the free sloshing case is about 5 m s while the value of velocity magnitude in the region of generated free jet in presence of moving baffles are approximately 3 m s as the time passes the region occupied by the generated free jet spreads for the free sloshing case while the free jet in presence of moving baffles is suppressed at t 2 776 s as shown in both the experimental and numerical results fig 10 to study the effects of moving baffles on suppressing the kinetic energy of the liquid kinetic energy variations of the liquid sloshing undergoing a harmonic excitation in absence presence of moving baffles versus time are shown in fig 11 a based on fig 11a the difference between kinetic energy of liquid sloshing in absence and presence of moving baffles show that the flow collides with the moving baffles at t 1 2 s approximately it should be mentioned that maximum of kinetic energy of the liquid sloshing occurs at t 2 35 s approximately for both cases based on fig 11a maximum of kinetic energies of the liquid sloshing in absence presence of moving baffles are about 7 8 and 4 82 j in other words the moving baffle can decrease the maximum of kinetic energy of the liquid sloshing undergoing a harmonic excitation by 38 21 variations of kinetic energy amplitude versus its frequency for the liquid sloshing undergoing a harmonic excitation in presence absence of moving baffles are shown in fig 11b using fast fourier transform fft as shown in fig 11b maximum of kinetic energy amplitude occurs at low frequencies 0 33 hz for both cases f37a75s00t135 f37a75s01t135 and applying moving baffles can decrease the maximum of kinetic energy amplitude by 35 42 while its frequency remains approximately constant furthermore peak values of kinetic energy amplitude will decrease as the frequency is increased based on fig 11b as explained previously colliding the flow with the moving baffles can cause the impact velocity to increase and consequently kinetic energy of the liquid sloshing is increased to investigate the effects of moving baffles on suppressing the kinetic energy of the liquid sloshing more precisely the suppression rate of the kinetic energy is calculated as follows iranmanesh and passandideh fard 2017 17 suppression rate of kinetic energy t k e a v e f r e e t k e a v e b a f f l e t k e a v e f r e e 100 where the average of total kinetic energy for the free sloshing case and sloshing case with moving baffles are denoted by t k e a v e f r e e and t k e a v e b a f f l e respectively the results show that using moving baffles as a mitigation device of the liquid sloshing can decrease the total kinetic energy by nearly 20 5 to show the mechanism of the moving baffles in reducing the kinetic energy of liquid sloshing undergoing a harmonic excitation the velocity fields of the flow in absence presence of moving baffles are shown in fig 12 as can be seen from fig 12 the moving baffles mitigate the kinetic energy of liquid sloshing via two ways absorbing the kinetic energy of the liquid sloshing via the spring baffles and the recirculation zones generated in the liquid domain which dissipate the kinetic energy of the liquid as shown in fig 12 as can be seen from fig 12 no recirculation zone is generated in the liquid zone for the free sloshing case while a recirculation zone can be observed in presence of moving baffles it should be mentioned that these two parameters are considered implicitly in calculating the kinetic energy of the liquid to investigate the effects of moving baffles on reducing the normal forces exerted on the tank walls quantitatively the results of normal forces exerted on the left wall in absence of moving baffles are compared with those of numerical results calculated in presence of moving baffles in fig 13 at initial times a sudden increase in the amount of normal force exerted on the left wall is observed in presence of moving baffles the initial increase in the normal force values can be attributed to the impact of the spring baffle structure as well as the liquid body with the tank walls at most times the amplitudes of normal forces exerted on the tank walls are decreased as the flow collides with the moving baffles furthermore the highest decrease of the normal force value occurs at t 2 2 s approximately it should be mentioned that maximum forces exerted on the left wall in absence presence of moving baffles are about 109 and 78 n respectively showing that moving baffles can decrease the maximum of unwanted forces exerted on the tank walls by 28 44 3 3 the effects of various parameters on the liquid sloshing of a moving container in presence of moving baffles in this section the effects of various parameters namely the amplitude and frequency of excitation the filling ratio of the moving tank the spring stiffness and damping coefficient on the characteristics of liquid sloshing undergoing a harmonic excitation are investigated furthermore the efficiency of moving baffles in suppressing the liquid sloshing of a rectangular tank subjected to the seismic excitation is evaluated to investigate the effects of each parameter on the behavior of liquid sloshing more precisely only one favorite parameter is varied while the rest of factors are supposed to be constant for each case 3 3 1 harmonic excitation 3 3 1 1 the amplitude and frequency of excitation the effects of excitation amplitudes on the kinetic energy of liquid sloshing undergoing a harmonic excitation in absence presence of moving baffles are investigated in fig 14 a as can be seen from fig 14a the impact time of the flow with the moving baffle is decreased as the excitation amplitude increases furthermore the kinetic energy of the liquid sloshing at the initial times are approximately the same for the cases investigated from t 0 s to t 0 8 s based on fig 14a the highest decrease of the kinetic energy value due to presence of moving baffles occurs at peak points and the decrease rate of the kinetic energy value is increased as the excitation amplitude increases furthermore the time at which the peak points occur in fig 14a remain approximately constant for all cases investigated showing that the excitation amplitude has a minor effect on shifting the times at which peak points occur variations of kinetic energy amplitude versus its frequency for various excitation amplitudes are shown in figs 11b 14b and 14c applying moving baffles can decrease maximum of kinetic energy amplitudes for various excitation amplitudes investigated in figs 11b 14b and 14c furthermore the differences between maximum of kinetic energy amplitudes in presence and absence of moving baffles for amplitudes of 50 75 and 100 mm are 0 294 0 808 and 1 088 j respectively while the frequencies of these peak values will remain approximately constant as the excitation amplitude is increased in other words reduction rate of kinetic energy amplitudes due to using moving baffles will increase as the excitation amplitude is increased to study the effects of moving baffles on reducing the kinetic energy of liquid sloshing quantitatively suppression rate of liquid sloshing for three excitation amplitudes are calculated and compared with each other in table 3 although the highest decrease of the peak point value occurs at the highest amplitude but suppression rate of the average kinetic energy for the intermediate value of excitation amplitude is the highest among the cases investigated the effects of the excitation amplitude on the normal forces exerted on the left wall of a moving container undergoing a harmonic excitation are investigated in figs 13 15 and 16 based on these figures moving baffles can decrease the maximum force exerted on the tank walls efficiently for the three amplitudes investigated furthermore the maximum force exerted on the tank wall at initial times is increased as the excitation amplitude increases it should be mentioned that the case with the highest amplitude will also exert the highest normal force on the left wall as expected variations of normal force amplitude exerted on the left wall of moving container versus frequency are illustrated for excitation amplitudes of 50 75 and 100 mm in figs 17 19 respectively based on these figures moving baffles can decrease maximum of normal force amplitude exerted on the left wall of moving container for all cases furthermore maximum of normal force amplitude impacted on the left wall of the container increases as the excitation amplitude is increased the differences between maximum of normal force exerted on the left wall in presence and absence of moving baffles for excitation amplitudes of 50 75 and 100 mm are 3 613 2 26 and 0 854 n respectively in other words the container subjected to the lowest excitation amplitude will experience the highest decrease of normal force amplitude the effects of excitation periods on the kinetic energy of liquid sloshing undergoing a harmonic excitation are illustrated in fig 20 a excitation periods have a minor effect on the kinetic energy of liquid sloshing from t 0 s to t 0 5 s as the time passes the excitation period role becomes more prominent similar to the excitation amplitude the highest decrease of the kinetic energy value occurs at peak points when the excitation period equals the resonance period t 1 35 s the peak points in fig 20a experiences the highest decrease among the cases investigated it should be mentioned that the impact time of the flow with moving baffles is decreased as the excitation period decreases variations of kinetic energy amplitude versus its frequency for various excitation periods are illustrated in figs 11b 20b and 20c the differences between maximum of kinetic energy amplitudes in presence and absence of moving baffles for excitation periods of 1 5 1 35 and 1 23 s are 0 703 0 808 and 0 733 j respectively in other words maximum of kinetic energy amplitude will experience the highest decrease as the excitation period equals the resonance period t 1 35 s it should be mentioned that maximum of kinetic energy amplitude occurs at low frequencies for all excitation periods investigated in this research to analyze the behavior of the excitation period more precisely suppression rates of kinetic energy due to using moving baffles as a mitigation device are shown in table 4 as expected the highest decrease of the kinetic energy of liquid sloshing occurs when the tank is excited with the resonance period iranmanesh and passandideh fard 2017 also applied a submerged cylinder as a suppression device to mitigate the liquid sloshing undergoing a harmonic excitation and it was concluded that the highest suppression rate occurred when the tank was excited with the resonance period the effects of excitation periods on the normal forces exerted on the left wall of a moving container in absence presence of moving baffles are presented in figs 13 21 and 22 based on these figures the case with the lowest excitation period exerts the highest initial force on the left wall of the moving tank at initial times for all cases investigated maximum of force exerted on the tank wall can be decreased well using the moving baffles in comparison with that of the free sloshing case variations of normal force amplitude exerted on the left wall of a moving container versus frequency are presented for various excitation periods in figs 18 23 and 24 based on these figures applying moving baffles can decrease maximum of normal force amplitude for excitation periods of 1 50 1 35 and 1 23 s the differences between maximum of normal force amplitude in presence and absence of moving baffles for excitation periods of 1 50 1 35 and 1 23 s are 1 301 2 26 and 1 20 n respectively in other words maximum of normal force amplitude will experience the highest decrease as the excitation period equals the resonance period t 1 35 s 3 3 1 2 the filling ratio the effects of filling ratio on the kinetic energy of liquid sloshing and forces exerted on the left and right moving baffles are studied numerically in this section the filling ratio is supposed to be 20 25 32 37 and 44 50 and 60 while the rest of parameters are assumed to be constant the effects of filling ratio on the kinetic energy of a moving container undergoing a harmonic excitation are illustrated in fig 25 a based on fig 25a kinetic energy deviations of liquid sloshing in absence presence of moving baffles are minor before t 0 5 s for all cases investigated as the time passes suppression rate of kinetic energy at peak points increases as filling ratio increases as can be seen from fig 25a the case with the filling ratio of 60 experiences the most suppression rate of kinetic energy at peak points variations of kinetic energy amplitude versus frequency for various filling ratios of 20 37 and 50 are illustrated in figs 25b 11b and 25c the differences between maximum of kinetic energy amplitudes in presence and absence of moving baffles for filling ratios of 20 37 and 50 are 0 116 0 808 and 1 693 j respectively in other words reduction rate of kinetic energy amplitudes due to using moving baffles increases as the filling ratio is increased to analyze the effects of filling ratio on the kinetic energy of liquid sloshing quantitatively the suppression rate of kinetic energy for various filling ratios are calculated and compared with each other in table 5 based on table 5 capability of moving baffles in reducing the kinetic energy of liquid sloshing will increase as the filling ratio increases the amounts of forces exerted on the left and right moving baffles are illustrated in figs 26 and 27 for various filling ratios based on figs 26 and 27 the forces exerted on the left and right moving baffles are minor for low filing ratios 20 and 25 while the amounts of forces exerted on the left moving baffle become major for intermediate filling ratios 32 37 and 44 for high filling ratios 50 and 60 the amounts of forces acting on the right moving baffle are the highest as observed in fig 27 it should be mentioned that the highest impact forces on the left and right moving baffles occur for filling ratio of 50 3 3 1 3 the spring stiffness in this section the effects of the spring stiffness on both the kinetic energy of liquid sloshing undergoing a harmonic excitation and normal forces exerted on the tank wall are studied fig 28 the value of the spring stiffness is supposed to be 1000 2000 and 3000 n m while other parameters are kept constant as shown in fig 28 the effect of the spring stiffness on peak values of kinetic energy chart is minimum from t 0 s to t 1 8 s while the amount of kinetic energy for the case with k 1000 n m increases slightly between t 1 8 s and 2 2 s this time period is exactly the moment that the flow collides with the right moving baffle as the time passes deviation between the values of kinetic energy for the three cases k 1000 2000 and 3000 n m decreases to investigate the spring stiffness influence on the kinetic energy of liquid sloshing more exactly suppression rates of kinetic energy for the cases studied are calculated and presented in table 6 as expected suppression rates of kinetic energy for the cases studied are rarely influenced by the spring stiffness the normal force values for the cases with various spring stiffnesses are calculated and compared in fig 29 based on fig 29 normal force values exerted on the tank wall are highly influenced by the spring stiffness some peak values in the normal force for the case with k 1000 n m are observed between t 0 25 s and 0 85 s in fig 29 the increase of the normal force values can be attributed to the structure oscillations induced by the sloshing excitation since these oscillations are mostly decreased as the spring stiffness increases although the spring stiffness effect on the kinetic energy of liquid sloshing is minor but the normal force exerted on the left wall can be highly influenced by the spring stiffness as can be seen from fig 29 the case with the lowest spring stiffness k 1000 n m experiences the highest normal force exerted on the left wall at t 2 4 s since the fluid flow impacts with the left moving baffle the normal force on the left wall will decrease as the spring stiffness is increased at t 2 4 s based on fig 29 in order to dampen these oscillations it is recommended to arrange a damper in parallel with the spring of moving baffles feasibility of reducing the normal force oscillations induced by the liquid sloshing via arranging a damper in a parallel configuration with the spring is investigated in section 3 3 1 4 the effects of spring stiffness on the non dimensional pressure at points p1 and p2 shown in fig 7 are investigated in fig 30 based on fig 30 non dimensional pressure at point p1 is highly influenced by spring stiffness compared to that at point p2 as the spring stiffness increases non dimensional pressure decreases while the normal force impacting on the moving baffle increases in other words the velocity of horizontal jet induced by the moving baffle will increase as the spring stiffness increases kim et al 2018 therefore the dynamic pressure will also increase since the dynamic pressure is proportional to the velocity magnitude furthermore the amounts of non dimensional pressure at points p1 and p2 for k 1000 and 3000 n m are the highest at t 2 4 s based on fig 30 since the fluid flow impacts with the left moving baffle as can be seen from fig 30 the amount of non dimensional pressure at points p1 and p2 will decrease as the spring stiffness is increased it should be mentioned that reduction rate of non dimensional pressure at point p1 will be higher than that of point p2 at t 2 4 s because of its proximity to the left moving baffle 3 3 1 4 the effects of damping coefficient on the suppression rate of liquid sloshing for various spring stiffnesses as stated in section 3 3 1 3 the effect of the spring stiffness on the kinetic energy of liquid sloshing was minor while the amount of normal force exerted on the left wall increased for the case with low spring stiffness k 1000 n m therefore feasibility of using a damper in a parallel configuration with the spring is investigated numerically in this section the amounts of normal forces exerted on the left wall of a moving container for the cases with various damping coefficients are compared with each other in fig 31 as shown in fig 31 the normal force oscillations generated via liquid sloshing are dampened between t 0 25 s and t 0 85 s well via applying a damper furthermore the amounts of normal force exerted on the left wall decrease as the damping coefficient increases based on fig 31 3 3 2 seismic excitation in this section the performance of moving baffles of a rectangular tank subjected to a seismic excitation 2018 sarpol e zahab earthquake is investigated numerically it should be mentioned that only the excitation type is varied in this section and the rest of parameters are the same as those presented in section 3 3 1 time variations of the acceleration in the x direction enforced to the moving tank are presented in fig 32 kinetic energy of liquid sloshing in a rectangular tank subjected to the seismic excitation in presence absence of moving baffles are compared in fig 33 based on fig 33 maximum of kinetic energy can be diminished using moving baffles to analyze the efficiency of moving baffles in reducing kinetic energy of liquid sloshing quantitatively suppression rate of kinetic energy of the rectangular tank due to using moving baffles are presented in table 7 based on table 7 using moving baffles can suppress the kinetic energy of liquid sloshing by 10 the amounts of normal forces exerted on the left wall of a rectangular container in presence absence of moving baffles are shown in fig 34 based on fig 34 moving baffles approximately decrease the maximum force exerted on the left wall of the container by 62 it should be mentioned that the role of moving baffles in decreasing the maximum of normal forces exerted on the left wall is more prominent that that of moving baffles in suppressing the kinetic energy of liquid sloshing of a rectangular tank subjected to the seismic excitation 4 conclusions in this paper feasibility of using moving baffles as a mitigation device to decrease the kinetic energy of liquid sloshing was investigated using the cel technique firstly the cel approach was validated quantitatively via calculating and comparing the free surface elevation on the left side of the tank with those obtained from a cfd approach secondly liquid sloshing of a moving container undergoing harmonic and seismic excitations in absence presence of moving baffles were simulated using the cel technique the top of the rectangular tank was closed and the value of pressure on the liquid free surface was equal to atmospheric pressure initially furthermore the position of the spring system was supposed to be fixed in this research next the effects of various parameters namely amplitude and frequency of excitation filling ratio spring stiffness and damping coefficient on both the kinetic energy of liquid sloshing and normal force exerted on the tank wall were studied comprehensively experimental results on suppressing liquid sloshing of cylindrical and spherical containers using moving baffles were not available in the literature therefore it is recommended to investigate the feasibility of moving baffles in suppressing liquid sloshing of cylindrical and spherical tanks under various excitations experimentally and numerically as future works the following conclusions were finally obtained in the research briefly 1 the impact velocity for the sloshing case with moving baffles was increased as the flow collided with the moving baffles initially in comparison with that of the free sloshing case 2 the moving baffles suppressed the kinetic energy of liquid sloshing via two ways absorbing the kinetic energy of the liquid sloshing via the spring baffles and the recirculation zones generated in the liquid domain which dissipated the kinetic energy of the liquid 3 the impact time of the flow with the moving baffle was decreased as the excitation amplitude increased 4 capability of moving baffles in reducing the kinetic energy of liquid sloshing would increase as the filling ratio increased 5 the spring stiffness of moving baffles had a minor effect on the suppression rate of sloshing kinetic energy 6 the normal force oscillations generated via liquid sloshing were dampened well via applying a damper for the sloshing case with low spring stiffness credit authorship contribution statement a iranmanesh conceptualization methodology software visualization writing original draft preparation writing review editing project administration r nikbakhti investigation data curation validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20811,excellent seakeeping performance is the basis of safe ship operation an anti rolling device employing swinging rotating cylinders based on the magnus effect can provide anti rolling measures at any ship speed in this study the operating principle of a magnus anti rolling device was examined by studying its hydrodynamic performance using large eddy simulation method a dimensionless parameter the rotation to swing ratio i e the ratio of the rotational speed to the swing speed of the cylinder was proposed for use in the hydrodynamic analysis the changes in lift drag characteristics and wake flow field of the magnus anti rolling device were observed at zero and low ship speeds according to the swing angle angular velocity and rotation to swing ratio the influence of the relative incoming flow velocity on the hydrodynamic characteristics of the magnus anti rolling device when swinging upstream and downstream was also studied at a low ship speed the results show that an optimal rotation to swing ratio can be obtained at zero speed and that the differential swing method can provide a large and consistent lift at low speeds this analysis of the hydrodynamic characteristics of the magnus anti rolling device contributes to the study of ship seakeeping strategies keywords magnus anti rolling device swinging rotating cylinder lift drag characteristics wake flow field large eddy simulation les 1 introduction owing to the influence of wind waves and currents seagoing ships are constantly subjected to movement with six degrees of freedom su et al 2020b the impact of rolling motion on the safety comfort and operational stability of ships is particularly important given their slender structures therefore the seakeeping performance of ships must be improved using anti rolling methods in addition to profile optimisation the use of active or passive anti rolling devices offers an effective method to restrain the rolling motion of ships commonly used anti rolling devices mainly include bilge keels kristiansen et al 2014 yasukawa et al 2018 anti rolling tanks gu et al 2015 anti rolling fins mao et al 2019 wang et al 2009 2016 taylan 2007 and gyro stabilisers takeuchi et al 2011 talha et al 2017 traditional anti rolling devices possess several limitations specifically a large installation space requirements which limit the loading volume b sensitivity to ship speed which limits applications to certain speeds and c high costs which limit widespread usage in this study a ship anti rolling device based on the magnus effect was evaluated owing to its small installation space requirements suitability at all speeds and low cost the anti rolling principle of this device is as follows when subjected to an incoming flow the flow velocities at the upper and lower surfaces of a rotating cylinder generate a speed difference owing to the cylinder rotation according to bernoulli s principle the upper and lower surfaces of the rotating cylinder therefore experience different pressures resulting in a lift force on the cylinder in the direction perpendicular to the incoming flow by changing the rotational direction and speed of rotation of the cylinder the direction and magnitude of the lift can be adjusted to offset the rolling motion of the ship thereby achieving stability isiam and raghavan 2006 kang 2006 mittal and kumar 2003 padrino and joseph 2006 when the flow velocity is zero the cylinder must swing to generate the relative incoming flow under these conditions the magnitude of the resulting lift force is related to the cylinder swing speed swing angle and rotational speed the direction of the lift force depends on the rotational direction of the cylinder as well as the swing direction the magnus effect has been applied to prevent ship rolling since the early 1970s however it has not been extensively developed owing to the constraints of the structure waterproofness difficulty of automatic control and other technologies a ship can achieve a considerable anti rolling effect at zero speed using swing control the magnus anti rolling device has a simple structure and requires only a small cabin capacity for installation furthermore the device can be retracted into the ship cabin when not needed reducing hull resistance the low costs of fabrication installation and maintenance as well as the potential for providing all speed anti rolling effects could lead to widespread application of magnus anti rolling devices dallinga and papuc 2008 with advances in electromechanical sealing and automation technologies extensive research on magnus anti rolling devices were conducted rotorswing the netherlands was the first company to design and manufacture a retractable magnus anti rolling device liang et al 2017 in 2009 quantum us launched the maglift rotor stabiliser which employs an electro hydraulic servo system in the swing system of a magnus anti rolling device to improve its output performance substantially the hydrodynamic analysis of the swinging rotating cylinder is crucial for the efficient design of the magnus anti rolling device as the cylinder rotates while swinging around one end the flow field near the cylinder becomes quite complicated accurate simulation of this field is crucial when analysing the hydrodynamic characteristics of the device computational fluid dynamics cfd simulations have been widely used to study the flow around rotating cylinders the simulation of turbulence is crucial in this application researchers have accordingly developed various turbulence models for use in engineering applications however turbulence models based on the reynolds averaged navier stokes equations reflect only the time averaging effect and ignore the minute details of the turbulence motion making these models unsuitable for simulation of complex and fine turbulence structures such as flow separation and the kármán vortex street kim et al 2016 wang et al 2017 in recent times rapid progress in computing has facilitated the realisation of detached eddy simulation large eddy simulation les and direct numerical simulation models these methods provide effective analytical tools for flow field simulations with a high reynolds number re the les method has been widely used to simulate flows with a high re mobini and niazi 2014 adopted les to perform a numerical simulation of unsteady turbulent flows around a rotating cylinder they observed that with an increase in the spin ratio i e the ratio of the cylinder rotational speed to the incoming flow speed or a decrease in re both the front stagnation and top separation points dislocate upwards along the cylinder resulting in a decrease in the average drag and an increase in the average lift they also noted the size of the rear vortex of the cylinder to increase with increasing re karabelas et al 2012 studied a rotating cylinder with an re of 1 4 105 observing that the les enables a high level of accuracy in flow simulations with a large re rodriguez et al 2017 studied the impact of surface roughness on the flow around a cylinder from subcritical up to transcritical values of re using les wu et al 2020 used les to study the influence of the spacing ratio and stagger angle on the flow around two stationary staggered cylinders by applying the subcritical re several studies have been reported wherein numerical simulations and theoretical calculations were performed to investigate the influence of the re and spin ratio on the flow around a rotating cylinder the magnus anti rolling device has been successfully applied to full scale ships nevertheless few studies have been conducted on the hydrodynamic performance of a swinging rotating cylinder to quantify the anti rolling effect of such a device the hydrodynamic performance of a ship anti rolling device based on the magnus effect was investigated in this study via numerical simulations the hydrodynamic characteristics of a swinging rotating cylinder were investigated at zero and low speeds the influences of the swing angle angular velocity and rotation to swing ratio on the hydrodynamic performance of the swinging rotating cylinder at zero flow velocity were analysed based on the flow field variations around the cylinder the lift and drag performances of a swinging rotating cylinder were then compared under different relative incoming flow velocities swing angles angular velocities and rotation to swing ratios at low speeds the lift drag and flow field changes were analysed when the cylinder swung downstream and upstream the remainder of this paper is organised as follows section 2 introduces the numerical model and approach adopted in this study section 3 presents an analysis of the numerical results and section 4 summarises the findings and provides suggestions for future research 2 methods 2 1 governing equations and turbulence model flows are described by the general conservation laws for energy mass and momentum which are collectively called the navier stokes equations su et al 2020a wang et al 2018 the corresponding equations for the cfd analysis are as follows guo et al 2020 lin et al 2020b wang et al 2019 1 u i x i 0 2 u i t x j u i u j u j u i 1 ρ p x i 1 ρ s j i x j 3 s j i μ u i x j u j x i where u i and u j i j 1 2 3 are the velocity components of the incoming flow x i and x j are the position vectors in tensor notation u j u i are reynolds stresses t is the time p is the pressure ρ is the fluid density μ is the dynamic viscosity and s j i denotes the average viscous stress tensor any study of the hydrodynamic performance of a swinging rotating cylinder must solve the complex turbulence problem at high re values thus multi scale vortex and quasi ordered structure analyses are required for unsteady dynamic equilibrium processes a method based on the reynolds averaged navier stokes equations cannot accurately and effectively reveal the flow field variations under these conditions gong et al 2019 in contrast les offers a reliable numerical simulation method for the study of the flow field of a swinging rotating cylinder it essentially calculates large scale vortices and decomposes a certain variable ϕ into ϕ and ϕ where ϕ is the filtered component and ϕ is the subgrid scale component the spatially filtered incompressible navier stokes equation is thus converted into the following form rodriguez et al 2017 4 u i x i 0 5 u i t u i u j x j 1 ρ p x i v 2 u i x j x j τ i j x j 6 τ i j 1 3 τ k k δ i j 2 v s g s s i j 7 s i j 1 2 u i x j u j x i where v is the kinematic viscosity of the fluid τ i j is the subgrid scale stress tensor s i j represents the large scale rate of strain tensor δ i j denotes the kronecker delta and v s g s is the subgrid scale viscosity the rotation to swing ratio is a dimensionless parameter suitable for the hydrodynamic analysis of the swinging rotating cylinders evaluated herein and can be calculated according to flow state as follows 8 β 0 ω r d ω s l 9 β u ω r d ω s l 2 u where β 0 is the rotation to swing ratio of the cylinder without incoming flow β u is the rotation to swing ratio of the cylinder with incoming flow u is the incoming flow velocity l and d are the span length and diameter of the cylinder respectively and ω r and ω s are the rotation and swing angular velocities of the cylinder respectively 2 2 working principle of the magnus anti rolling device the working principle of the magnus anti rolling device investigated in this study at zero and low speeds is illustrated in fig 1 a pair of such anti rolling devices has previously been installed on both sides of the bilge of an ore carrier lin et al 2020a there is a unified rule that defines the direction of cylinder rotation when observed facing from the port side towards the starboard side of the ship notably the cylinder swings in the direction opposite to the relative direction of the incoming flow to generate lift thus when the ship tilts to the port side the magnus anti rolling device on this side generates an upward lift by swinging upstream against the incoming flow while rotating clockwise and swinging downstream along the incoming flow while rotating counterclockwise see fig 1 inversely when the ship tilts to the starboard side the magnus anti rolling device on the port side generates a downward lift by swinging upstream while rotating counterclockwise and swinging downstream while rotating clockwise the opposite is true for the device on the starboard side thus the two cylinders always swing in the same direction while rotating in opposite directions 2 3 computational domain and mesh generation as shown in fig 2 the origin of the cartesian coordinate system used in the simulations was located at the end of the cylinder the negative x axis was defined in the flow direction the positive y axis in the upward direction and the positive z axis in the axial direction of the cylinder the aspect ratio of the cylinder was 7 that is l 7d 0 252 m the rectangular computational domain had a length of 44d a width of 10d and a height of 23d along the x y and z axes respectively the distance between the origin and the velocity inlet of the fluid domain was 16d and that between the origin and the pressure outlet of the fluid domain was 28d the boundary conditions of the four sides were set as symmetric planes to reduce the influence of the wall effect on the cylinder the water around the cylinder was assumed to be in single phase flow and the gravitational effect was ignored the temperature was 20 c the density of the water was 998 10 kg m3 and the kinematic viscosity coefficient was 1 0037 10 6 m2 s the wall adapting local eddy viscosity model yielded good results in the simulations of the cylinder at critical and supercritical values of re lehmkuhl et al 2014 the implicit unsteady method was adopted owing to the transient characteristics the large motion space of the cylinder swing necessitates the use of an overset mesh to improve the efficiency of the iterative calculations as shown in fig 3 the transition interval from the outermost boundary to the rotation domain was encrypted to provide a smooth mesh size transition the cylinder self rotated around the z axis and swung around the y axis the grid was refined in the near wall region of the cylinder owing to the rotational motion a wall function was adopted with a y of approximately 1 the independence of the swinging rotating cylinder grid was verified as shown in table 1 using coarse medium and fine grid resolutions consisting of 4 8 and 12 million elements respectively to evaluate the solution stability the grid independence study was performed without swinging at re 1 4 105 the compared parameters were the drag coefficient c d and the strouhal number s t as a result of the relatively close agreement of the medium and fine grids with experimental values from cantwell and coles 1983 a medium grid resolution of 8 million elements was selected for this study in consideration of the solution time and the large number of simulation cases to be evaluated 3 results and discussion in the case of no incoming flow the cylinder cannot produce lift by only self rotation therefore a relative flow velocity must be generated by the cylinder swing the effects of the swing angular velocity ω s rotation to swing ratio β and maximum swing angle θ s on the hydrodynamic performance of the cylinder were accordingly studied at zero speed at low flow velocities the lift induced by the self rotation of the cylinder is small and cannot meet the ship anti rolling requirements therefore the relative flow velocity owing to the swing of the cylinder must be increased to provide sufficient lift thus generating a recovery torque that results in an anti rolling effect the influence of the inflow velocity u on the hydrodynamic performance of the cylinder must then be considered table 2 summarises the calculation conditions of the hydrodynamic numerical simulations of the swinging rotating cylinder fig 4 shows the time history curve of the lift and drag over one swing period t when the cylinder swung to the set maximum angle the swing and rotational motions changed direction simultaneously but the concomitant flow around the cylinder remained in the original direction owing to inertia this resulted in the cylinder remaining in the flow area formed by the previous swing direction when swinging in the opposite direction as shown in fig 5 b and c in this case owing to the large velocity of the wake the cylinder produced a lift in the direction opposite to the design direction reverse lift as the cylinder continued to swing the residual wake gradually weakened until it completely disappeared fig 5a and the reverse lift gradually decreased finally a stable forward lift region was induced which is defined in this paper as a stable section fig 4 hence in this study to investigate the lift and drag characteristics of a swinging rotating cylinder it was necessary to simultaneously analyse the average lift f l and drag f d in one swing period as well as the lift f l and drag f d in the stable section 3 1 simulation results at zero speed fig 6 shows the effects of different ω s and β 0 values on the lift drag characteristics of the cylinder when θ s was 150 it can be observed in fig 6a that when ω s was greater than 40 rpm the peak value of f l occurred at a β 0 value of approximately 2 and increased with increasing ω s as shown in fig 6b f d gradually increased with increasing β 0 for all values of ω s until reaching a stable value in fig 6c and d it can be seen that when ω s was greater than 53 rpm the peak values of f l and f d occurred at a β 0 value of approximately 2 and again increased with increasing ω s thus the effect of β 0 on the lift drag characteristics of the cylinder was essentially the same under different ω s values and the maximum lift was produced when β 0 was approximately 2 it can also be seen in fig 6 that f l and f d were larger than f l and f d respectively because the components of reverse lift and reverse drag existed in f l and f d as shown in fig 4 fig 7 shows the flow field diagram under different β 0 values when θ s 150 and ω s 40 rpm when β 0 was 1 the wake flow formed by the cylinder swing was dominated by dispersed and small vortices when β 0 increased to 2 the main vortex began to appear with more energy finally when β 0 was 3 a strong negative pressure in the main vortex was produced at the trailing edge of the cylinder additionally a few scattered vortices and a strong negative pressure area were produced on the cylinder surface therefore a large lift can be produced which is consistent with the trend of the lift curves in fig 6 by comparing figs 5 and 7b it can be observed that when θ s and β 0 were equal an increase in ω s led to an earlier appearance of a high intensity negative pressure in the main vortex of the cylinder wake field thus the peaks of each curve in fig 6a shifted towards the smaller values of β 0 as depicted in fig 8 under the same β 0 values the lift and drag of the cylinder increased as ω s increased this can be explained by the fact that the relative inflow velocity of the cylinder increased with increasing ω s the increased rotational motion increased the velocity difference between the upper and lower surfaces of the cylinder thereby increasing the pressure difference and thus increasing the lift when β 0 was approximately 2 the cylinder produced the maximum lift in the stable section the drag was similar to that when β 0 was 3 when the cylinder reached its maximum lift drag ratio it can also be seen that f l and f d reflected the actual components of the anti rolling effect of the cylinder better than f l and f d from fig 9 when ω s was constant θ s had nearly no effect on f l and f d however f l gradually increased and f d decreased as θ s increased this was because f l and f d were unaffected by the reverse swing of the cylinder therefore they were also unaffected by θ s in combination with the analysis of fig 4 it can be observed that when θ s increased the proportion of the non stable section relative to the entire swing period remained unchanged simultaneously the proportion of the stable section with a large lift increased relative to the entire swing period hence f l always increased with increasing θ s in contrast the change in f d was opposite to that of f l because the proportion of the stable section with less drag increased relative to the entire swing period thus f d decreased as θ s increased the simulation results obtained at zero speed provide guidance for the analysis of the hydrodynamic characteristics of the magnus anti rolling device during ship mooring 3 2 simulation results at low speed subsequently the numerical simulation results of the swinging rotating cylinder were analysed at low speeds the angle between the swinging cylinder and direction of incoming flow will always vary and thus the relative velocity of the cylinder will constantly change this is because the stable section of the cylinder lift and drag cannot be maintained under these conditions therefore only the average lift and drag were analysed in this section of the study the downstream swing speed of the cylinder was greater than that of the upstream swing as the velocity relative to the fluid was maintained at the same value whether the cylinder was swinging downstream or upstream it can be observed from fig 10 that the lift generated by the upstream swing of the cylinder was greater than that generated by the downstream swing when u 0 25 m s θ s 150 and ω s 40 rpm the lift generated by both the upstream and downstream swings increased initially and then stabilised with increasing β u however the drag of the upstream swing of the cylinder which first increased to its peak and then tended to stabilise with increasing β u was lower than that of the downstream swing which initially increased and then decreased with increasing β u the reason for this phenomenon was that when β u was less than 2 5 the velocity difference between the upper and lower surfaces of the cylinder increased with increasing cylinder rotational speed owing to the viscous action of the fluid when β u exceeded 2 5 the friction between the surface of the cylinder and the fluid no longer increased thus the difference in velocity between the upper and lower surfaces of the cylinder no longer changed that is the lift of the cylinder remained constant fig 11 shows the flow field vorticity of the cylinder swinging upstream and downstream under different β u values when the cylinder swung downstream the angle between the wake vortex trajectory and the incoming flow direction was smaller than when it swung upstream and the change with the increase in β u was not apparent in contrast when the cylinder swung upstream the angle between the wake vortex trajectory and incoming flow direction increased gradually with increasing β u a larger deflection angle of the wake vortex led to a greater lift of the cylinder this also explains why the lift of the cylinder was greater when the cylinder swung upstream than when it swung downstream fig 12 a and b show the impact of different inflow velocities on the lift and drag characteristics respectively of the cylinder when swinging upstream and downstream it is evident that the average lift and drag of the swinging cylinder increased with increasing u when u was less than 0 27 m s the f l of the cylinder swinging upstream was larger than that of the cylinder swinging downstream whereas when u was greater than 0 27 m s the f l of the cylinder swinging upstream was smaller than that of the cylinder swinging downstream in contrast the f d of the cylinder swinging downstream was always larger than that of the cylinder swinging upstream it can be observed in fig 13 that when β u 1 75 θ s 150 and u 0 40 m s the lift and drag of the cylinder increased with increasing ω s this is the same as the effect of ω s on the lift and drag at zero velocity it can be seen in fig 14 that that the wake flow field of the cylinder was different when β u 1 75 θ s 150 and u 0 25 m s owing to the influence of the incoming flow the falling vortex produced by the cylinder swinging downstream formed a u shaped vortex with a large negative pressure which reduced the pressure on the barotropic surface of the cylinder thus reducing the cylinder lift this also explains why the lift of the cylinder swinging upstream was greater than that of the cylinder swinging downstream fig 15 shows the effect of θ s on the lift drag characteristics of the cylinder swinging upstream and downstream it can be observed that the f l of the swinging cylinder increased gradually with increasing θ s and the f d of the swinging cylinder decreased with increasing θ s for the same reason that the average cylinder lift and drag varied with θ s at zero speed 4 conclusions generally the study of the hydrodynamic performance of a swinging rotating cylinder is highly significant for the study of ship seakeeping using a magnus anti rolling device at various speeds in this study the lift drag characteristics and wake flow field of a swinging rotating cylinder at zero and low ship speeds were accordingly investigated using les through a comparative analysis of the simulation results we first conclude that at zero speed a relative inflow velocity could be obtained by swinging the cylinder resulting in a lift when the cylinder swung and rotated the lift initially increased to a peak value and then tended to stabilise or decrease slowly with increasing rotation to swing ratio the rotation to swing ratio corresponding to the maximum lift was approximately 2 0 the lift of the cylinder consistently increased with the increasing swing angle or angular velocity these results are relevant to ensuring ship stability under mooring conditions at low speeds the cylinder balanced the relative inflow velocity by swinging upstream and downstream at different speeds resulting in a relatively consistent lift in both directions this solves the problem of insufficient lift provided by the magnus anti rolling device at low flow velocities it was determined that the lift of the cylinder first increased to a peak value and then tended to stabilise with an increasing rotation to swing ratio the lift due to the upstream swing of the cylinder was greater than that due to the downstream swing both the lift and drag of the cylinder when swinging upstream or downstream increased with the increasing incoming flow velocity in summary the swinging rotating cylinder evaluated in this study was shown to produce lift at zero and low ship speeds using the relative flow velocity provided by the swinging motion to achieve the anti rolling effect associated with the magnus anti rolling device furthermore the best anti rolling effect was achieved by adjusting the rotational speed and swing speed of the cylinder according to the flow velocity further investigations are required to evaluate the hydrodynamic performance of the magnus anti rolling device at higher speeds critically the influence of the hull on the hydrodynamic performance of the magnus anti rolling device was not considered in the numerical simulations conducted in this study as a result the hydrodynamic characteristics of the magnus anti rolling device when coupled with the hull need to be considered in future research another issue that warrants further study is the impact of the cylinder surface shape and roughness on the hydrodynamic performance of the magnus anti rolling device credit authorship contribution statement jian feng lin investigation formal analysis writing original draft preparation yang han methodology investigation writing review editing yu min su supervision resources project administration yu wang data curation validation conceptualization zuo tian zhang conceptualization investigation rui qi jiang data curation investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements funding this work was supported by the national natural science foundation of china grant number 52001090 
20811,excellent seakeeping performance is the basis of safe ship operation an anti rolling device employing swinging rotating cylinders based on the magnus effect can provide anti rolling measures at any ship speed in this study the operating principle of a magnus anti rolling device was examined by studying its hydrodynamic performance using large eddy simulation method a dimensionless parameter the rotation to swing ratio i e the ratio of the rotational speed to the swing speed of the cylinder was proposed for use in the hydrodynamic analysis the changes in lift drag characteristics and wake flow field of the magnus anti rolling device were observed at zero and low ship speeds according to the swing angle angular velocity and rotation to swing ratio the influence of the relative incoming flow velocity on the hydrodynamic characteristics of the magnus anti rolling device when swinging upstream and downstream was also studied at a low ship speed the results show that an optimal rotation to swing ratio can be obtained at zero speed and that the differential swing method can provide a large and consistent lift at low speeds this analysis of the hydrodynamic characteristics of the magnus anti rolling device contributes to the study of ship seakeeping strategies keywords magnus anti rolling device swinging rotating cylinder lift drag characteristics wake flow field large eddy simulation les 1 introduction owing to the influence of wind waves and currents seagoing ships are constantly subjected to movement with six degrees of freedom su et al 2020b the impact of rolling motion on the safety comfort and operational stability of ships is particularly important given their slender structures therefore the seakeeping performance of ships must be improved using anti rolling methods in addition to profile optimisation the use of active or passive anti rolling devices offers an effective method to restrain the rolling motion of ships commonly used anti rolling devices mainly include bilge keels kristiansen et al 2014 yasukawa et al 2018 anti rolling tanks gu et al 2015 anti rolling fins mao et al 2019 wang et al 2009 2016 taylan 2007 and gyro stabilisers takeuchi et al 2011 talha et al 2017 traditional anti rolling devices possess several limitations specifically a large installation space requirements which limit the loading volume b sensitivity to ship speed which limits applications to certain speeds and c high costs which limit widespread usage in this study a ship anti rolling device based on the magnus effect was evaluated owing to its small installation space requirements suitability at all speeds and low cost the anti rolling principle of this device is as follows when subjected to an incoming flow the flow velocities at the upper and lower surfaces of a rotating cylinder generate a speed difference owing to the cylinder rotation according to bernoulli s principle the upper and lower surfaces of the rotating cylinder therefore experience different pressures resulting in a lift force on the cylinder in the direction perpendicular to the incoming flow by changing the rotational direction and speed of rotation of the cylinder the direction and magnitude of the lift can be adjusted to offset the rolling motion of the ship thereby achieving stability isiam and raghavan 2006 kang 2006 mittal and kumar 2003 padrino and joseph 2006 when the flow velocity is zero the cylinder must swing to generate the relative incoming flow under these conditions the magnitude of the resulting lift force is related to the cylinder swing speed swing angle and rotational speed the direction of the lift force depends on the rotational direction of the cylinder as well as the swing direction the magnus effect has been applied to prevent ship rolling since the early 1970s however it has not been extensively developed owing to the constraints of the structure waterproofness difficulty of automatic control and other technologies a ship can achieve a considerable anti rolling effect at zero speed using swing control the magnus anti rolling device has a simple structure and requires only a small cabin capacity for installation furthermore the device can be retracted into the ship cabin when not needed reducing hull resistance the low costs of fabrication installation and maintenance as well as the potential for providing all speed anti rolling effects could lead to widespread application of magnus anti rolling devices dallinga and papuc 2008 with advances in electromechanical sealing and automation technologies extensive research on magnus anti rolling devices were conducted rotorswing the netherlands was the first company to design and manufacture a retractable magnus anti rolling device liang et al 2017 in 2009 quantum us launched the maglift rotor stabiliser which employs an electro hydraulic servo system in the swing system of a magnus anti rolling device to improve its output performance substantially the hydrodynamic analysis of the swinging rotating cylinder is crucial for the efficient design of the magnus anti rolling device as the cylinder rotates while swinging around one end the flow field near the cylinder becomes quite complicated accurate simulation of this field is crucial when analysing the hydrodynamic characteristics of the device computational fluid dynamics cfd simulations have been widely used to study the flow around rotating cylinders the simulation of turbulence is crucial in this application researchers have accordingly developed various turbulence models for use in engineering applications however turbulence models based on the reynolds averaged navier stokes equations reflect only the time averaging effect and ignore the minute details of the turbulence motion making these models unsuitable for simulation of complex and fine turbulence structures such as flow separation and the kármán vortex street kim et al 2016 wang et al 2017 in recent times rapid progress in computing has facilitated the realisation of detached eddy simulation large eddy simulation les and direct numerical simulation models these methods provide effective analytical tools for flow field simulations with a high reynolds number re the les method has been widely used to simulate flows with a high re mobini and niazi 2014 adopted les to perform a numerical simulation of unsteady turbulent flows around a rotating cylinder they observed that with an increase in the spin ratio i e the ratio of the cylinder rotational speed to the incoming flow speed or a decrease in re both the front stagnation and top separation points dislocate upwards along the cylinder resulting in a decrease in the average drag and an increase in the average lift they also noted the size of the rear vortex of the cylinder to increase with increasing re karabelas et al 2012 studied a rotating cylinder with an re of 1 4 105 observing that the les enables a high level of accuracy in flow simulations with a large re rodriguez et al 2017 studied the impact of surface roughness on the flow around a cylinder from subcritical up to transcritical values of re using les wu et al 2020 used les to study the influence of the spacing ratio and stagger angle on the flow around two stationary staggered cylinders by applying the subcritical re several studies have been reported wherein numerical simulations and theoretical calculations were performed to investigate the influence of the re and spin ratio on the flow around a rotating cylinder the magnus anti rolling device has been successfully applied to full scale ships nevertheless few studies have been conducted on the hydrodynamic performance of a swinging rotating cylinder to quantify the anti rolling effect of such a device the hydrodynamic performance of a ship anti rolling device based on the magnus effect was investigated in this study via numerical simulations the hydrodynamic characteristics of a swinging rotating cylinder were investigated at zero and low speeds the influences of the swing angle angular velocity and rotation to swing ratio on the hydrodynamic performance of the swinging rotating cylinder at zero flow velocity were analysed based on the flow field variations around the cylinder the lift and drag performances of a swinging rotating cylinder were then compared under different relative incoming flow velocities swing angles angular velocities and rotation to swing ratios at low speeds the lift drag and flow field changes were analysed when the cylinder swung downstream and upstream the remainder of this paper is organised as follows section 2 introduces the numerical model and approach adopted in this study section 3 presents an analysis of the numerical results and section 4 summarises the findings and provides suggestions for future research 2 methods 2 1 governing equations and turbulence model flows are described by the general conservation laws for energy mass and momentum which are collectively called the navier stokes equations su et al 2020a wang et al 2018 the corresponding equations for the cfd analysis are as follows guo et al 2020 lin et al 2020b wang et al 2019 1 u i x i 0 2 u i t x j u i u j u j u i 1 ρ p x i 1 ρ s j i x j 3 s j i μ u i x j u j x i where u i and u j i j 1 2 3 are the velocity components of the incoming flow x i and x j are the position vectors in tensor notation u j u i are reynolds stresses t is the time p is the pressure ρ is the fluid density μ is the dynamic viscosity and s j i denotes the average viscous stress tensor any study of the hydrodynamic performance of a swinging rotating cylinder must solve the complex turbulence problem at high re values thus multi scale vortex and quasi ordered structure analyses are required for unsteady dynamic equilibrium processes a method based on the reynolds averaged navier stokes equations cannot accurately and effectively reveal the flow field variations under these conditions gong et al 2019 in contrast les offers a reliable numerical simulation method for the study of the flow field of a swinging rotating cylinder it essentially calculates large scale vortices and decomposes a certain variable ϕ into ϕ and ϕ where ϕ is the filtered component and ϕ is the subgrid scale component the spatially filtered incompressible navier stokes equation is thus converted into the following form rodriguez et al 2017 4 u i x i 0 5 u i t u i u j x j 1 ρ p x i v 2 u i x j x j τ i j x j 6 τ i j 1 3 τ k k δ i j 2 v s g s s i j 7 s i j 1 2 u i x j u j x i where v is the kinematic viscosity of the fluid τ i j is the subgrid scale stress tensor s i j represents the large scale rate of strain tensor δ i j denotes the kronecker delta and v s g s is the subgrid scale viscosity the rotation to swing ratio is a dimensionless parameter suitable for the hydrodynamic analysis of the swinging rotating cylinders evaluated herein and can be calculated according to flow state as follows 8 β 0 ω r d ω s l 9 β u ω r d ω s l 2 u where β 0 is the rotation to swing ratio of the cylinder without incoming flow β u is the rotation to swing ratio of the cylinder with incoming flow u is the incoming flow velocity l and d are the span length and diameter of the cylinder respectively and ω r and ω s are the rotation and swing angular velocities of the cylinder respectively 2 2 working principle of the magnus anti rolling device the working principle of the magnus anti rolling device investigated in this study at zero and low speeds is illustrated in fig 1 a pair of such anti rolling devices has previously been installed on both sides of the bilge of an ore carrier lin et al 2020a there is a unified rule that defines the direction of cylinder rotation when observed facing from the port side towards the starboard side of the ship notably the cylinder swings in the direction opposite to the relative direction of the incoming flow to generate lift thus when the ship tilts to the port side the magnus anti rolling device on this side generates an upward lift by swinging upstream against the incoming flow while rotating clockwise and swinging downstream along the incoming flow while rotating counterclockwise see fig 1 inversely when the ship tilts to the starboard side the magnus anti rolling device on the port side generates a downward lift by swinging upstream while rotating counterclockwise and swinging downstream while rotating clockwise the opposite is true for the device on the starboard side thus the two cylinders always swing in the same direction while rotating in opposite directions 2 3 computational domain and mesh generation as shown in fig 2 the origin of the cartesian coordinate system used in the simulations was located at the end of the cylinder the negative x axis was defined in the flow direction the positive y axis in the upward direction and the positive z axis in the axial direction of the cylinder the aspect ratio of the cylinder was 7 that is l 7d 0 252 m the rectangular computational domain had a length of 44d a width of 10d and a height of 23d along the x y and z axes respectively the distance between the origin and the velocity inlet of the fluid domain was 16d and that between the origin and the pressure outlet of the fluid domain was 28d the boundary conditions of the four sides were set as symmetric planes to reduce the influence of the wall effect on the cylinder the water around the cylinder was assumed to be in single phase flow and the gravitational effect was ignored the temperature was 20 c the density of the water was 998 10 kg m3 and the kinematic viscosity coefficient was 1 0037 10 6 m2 s the wall adapting local eddy viscosity model yielded good results in the simulations of the cylinder at critical and supercritical values of re lehmkuhl et al 2014 the implicit unsteady method was adopted owing to the transient characteristics the large motion space of the cylinder swing necessitates the use of an overset mesh to improve the efficiency of the iterative calculations as shown in fig 3 the transition interval from the outermost boundary to the rotation domain was encrypted to provide a smooth mesh size transition the cylinder self rotated around the z axis and swung around the y axis the grid was refined in the near wall region of the cylinder owing to the rotational motion a wall function was adopted with a y of approximately 1 the independence of the swinging rotating cylinder grid was verified as shown in table 1 using coarse medium and fine grid resolutions consisting of 4 8 and 12 million elements respectively to evaluate the solution stability the grid independence study was performed without swinging at re 1 4 105 the compared parameters were the drag coefficient c d and the strouhal number s t as a result of the relatively close agreement of the medium and fine grids with experimental values from cantwell and coles 1983 a medium grid resolution of 8 million elements was selected for this study in consideration of the solution time and the large number of simulation cases to be evaluated 3 results and discussion in the case of no incoming flow the cylinder cannot produce lift by only self rotation therefore a relative flow velocity must be generated by the cylinder swing the effects of the swing angular velocity ω s rotation to swing ratio β and maximum swing angle θ s on the hydrodynamic performance of the cylinder were accordingly studied at zero speed at low flow velocities the lift induced by the self rotation of the cylinder is small and cannot meet the ship anti rolling requirements therefore the relative flow velocity owing to the swing of the cylinder must be increased to provide sufficient lift thus generating a recovery torque that results in an anti rolling effect the influence of the inflow velocity u on the hydrodynamic performance of the cylinder must then be considered table 2 summarises the calculation conditions of the hydrodynamic numerical simulations of the swinging rotating cylinder fig 4 shows the time history curve of the lift and drag over one swing period t when the cylinder swung to the set maximum angle the swing and rotational motions changed direction simultaneously but the concomitant flow around the cylinder remained in the original direction owing to inertia this resulted in the cylinder remaining in the flow area formed by the previous swing direction when swinging in the opposite direction as shown in fig 5 b and c in this case owing to the large velocity of the wake the cylinder produced a lift in the direction opposite to the design direction reverse lift as the cylinder continued to swing the residual wake gradually weakened until it completely disappeared fig 5a and the reverse lift gradually decreased finally a stable forward lift region was induced which is defined in this paper as a stable section fig 4 hence in this study to investigate the lift and drag characteristics of a swinging rotating cylinder it was necessary to simultaneously analyse the average lift f l and drag f d in one swing period as well as the lift f l and drag f d in the stable section 3 1 simulation results at zero speed fig 6 shows the effects of different ω s and β 0 values on the lift drag characteristics of the cylinder when θ s was 150 it can be observed in fig 6a that when ω s was greater than 40 rpm the peak value of f l occurred at a β 0 value of approximately 2 and increased with increasing ω s as shown in fig 6b f d gradually increased with increasing β 0 for all values of ω s until reaching a stable value in fig 6c and d it can be seen that when ω s was greater than 53 rpm the peak values of f l and f d occurred at a β 0 value of approximately 2 and again increased with increasing ω s thus the effect of β 0 on the lift drag characteristics of the cylinder was essentially the same under different ω s values and the maximum lift was produced when β 0 was approximately 2 it can also be seen in fig 6 that f l and f d were larger than f l and f d respectively because the components of reverse lift and reverse drag existed in f l and f d as shown in fig 4 fig 7 shows the flow field diagram under different β 0 values when θ s 150 and ω s 40 rpm when β 0 was 1 the wake flow formed by the cylinder swing was dominated by dispersed and small vortices when β 0 increased to 2 the main vortex began to appear with more energy finally when β 0 was 3 a strong negative pressure in the main vortex was produced at the trailing edge of the cylinder additionally a few scattered vortices and a strong negative pressure area were produced on the cylinder surface therefore a large lift can be produced which is consistent with the trend of the lift curves in fig 6 by comparing figs 5 and 7b it can be observed that when θ s and β 0 were equal an increase in ω s led to an earlier appearance of a high intensity negative pressure in the main vortex of the cylinder wake field thus the peaks of each curve in fig 6a shifted towards the smaller values of β 0 as depicted in fig 8 under the same β 0 values the lift and drag of the cylinder increased as ω s increased this can be explained by the fact that the relative inflow velocity of the cylinder increased with increasing ω s the increased rotational motion increased the velocity difference between the upper and lower surfaces of the cylinder thereby increasing the pressure difference and thus increasing the lift when β 0 was approximately 2 the cylinder produced the maximum lift in the stable section the drag was similar to that when β 0 was 3 when the cylinder reached its maximum lift drag ratio it can also be seen that f l and f d reflected the actual components of the anti rolling effect of the cylinder better than f l and f d from fig 9 when ω s was constant θ s had nearly no effect on f l and f d however f l gradually increased and f d decreased as θ s increased this was because f l and f d were unaffected by the reverse swing of the cylinder therefore they were also unaffected by θ s in combination with the analysis of fig 4 it can be observed that when θ s increased the proportion of the non stable section relative to the entire swing period remained unchanged simultaneously the proportion of the stable section with a large lift increased relative to the entire swing period hence f l always increased with increasing θ s in contrast the change in f d was opposite to that of f l because the proportion of the stable section with less drag increased relative to the entire swing period thus f d decreased as θ s increased the simulation results obtained at zero speed provide guidance for the analysis of the hydrodynamic characteristics of the magnus anti rolling device during ship mooring 3 2 simulation results at low speed subsequently the numerical simulation results of the swinging rotating cylinder were analysed at low speeds the angle between the swinging cylinder and direction of incoming flow will always vary and thus the relative velocity of the cylinder will constantly change this is because the stable section of the cylinder lift and drag cannot be maintained under these conditions therefore only the average lift and drag were analysed in this section of the study the downstream swing speed of the cylinder was greater than that of the upstream swing as the velocity relative to the fluid was maintained at the same value whether the cylinder was swinging downstream or upstream it can be observed from fig 10 that the lift generated by the upstream swing of the cylinder was greater than that generated by the downstream swing when u 0 25 m s θ s 150 and ω s 40 rpm the lift generated by both the upstream and downstream swings increased initially and then stabilised with increasing β u however the drag of the upstream swing of the cylinder which first increased to its peak and then tended to stabilise with increasing β u was lower than that of the downstream swing which initially increased and then decreased with increasing β u the reason for this phenomenon was that when β u was less than 2 5 the velocity difference between the upper and lower surfaces of the cylinder increased with increasing cylinder rotational speed owing to the viscous action of the fluid when β u exceeded 2 5 the friction between the surface of the cylinder and the fluid no longer increased thus the difference in velocity between the upper and lower surfaces of the cylinder no longer changed that is the lift of the cylinder remained constant fig 11 shows the flow field vorticity of the cylinder swinging upstream and downstream under different β u values when the cylinder swung downstream the angle between the wake vortex trajectory and the incoming flow direction was smaller than when it swung upstream and the change with the increase in β u was not apparent in contrast when the cylinder swung upstream the angle between the wake vortex trajectory and incoming flow direction increased gradually with increasing β u a larger deflection angle of the wake vortex led to a greater lift of the cylinder this also explains why the lift of the cylinder was greater when the cylinder swung upstream than when it swung downstream fig 12 a and b show the impact of different inflow velocities on the lift and drag characteristics respectively of the cylinder when swinging upstream and downstream it is evident that the average lift and drag of the swinging cylinder increased with increasing u when u was less than 0 27 m s the f l of the cylinder swinging upstream was larger than that of the cylinder swinging downstream whereas when u was greater than 0 27 m s the f l of the cylinder swinging upstream was smaller than that of the cylinder swinging downstream in contrast the f d of the cylinder swinging downstream was always larger than that of the cylinder swinging upstream it can be observed in fig 13 that when β u 1 75 θ s 150 and u 0 40 m s the lift and drag of the cylinder increased with increasing ω s this is the same as the effect of ω s on the lift and drag at zero velocity it can be seen in fig 14 that that the wake flow field of the cylinder was different when β u 1 75 θ s 150 and u 0 25 m s owing to the influence of the incoming flow the falling vortex produced by the cylinder swinging downstream formed a u shaped vortex with a large negative pressure which reduced the pressure on the barotropic surface of the cylinder thus reducing the cylinder lift this also explains why the lift of the cylinder swinging upstream was greater than that of the cylinder swinging downstream fig 15 shows the effect of θ s on the lift drag characteristics of the cylinder swinging upstream and downstream it can be observed that the f l of the swinging cylinder increased gradually with increasing θ s and the f d of the swinging cylinder decreased with increasing θ s for the same reason that the average cylinder lift and drag varied with θ s at zero speed 4 conclusions generally the study of the hydrodynamic performance of a swinging rotating cylinder is highly significant for the study of ship seakeeping using a magnus anti rolling device at various speeds in this study the lift drag characteristics and wake flow field of a swinging rotating cylinder at zero and low ship speeds were accordingly investigated using les through a comparative analysis of the simulation results we first conclude that at zero speed a relative inflow velocity could be obtained by swinging the cylinder resulting in a lift when the cylinder swung and rotated the lift initially increased to a peak value and then tended to stabilise or decrease slowly with increasing rotation to swing ratio the rotation to swing ratio corresponding to the maximum lift was approximately 2 0 the lift of the cylinder consistently increased with the increasing swing angle or angular velocity these results are relevant to ensuring ship stability under mooring conditions at low speeds the cylinder balanced the relative inflow velocity by swinging upstream and downstream at different speeds resulting in a relatively consistent lift in both directions this solves the problem of insufficient lift provided by the magnus anti rolling device at low flow velocities it was determined that the lift of the cylinder first increased to a peak value and then tended to stabilise with an increasing rotation to swing ratio the lift due to the upstream swing of the cylinder was greater than that due to the downstream swing both the lift and drag of the cylinder when swinging upstream or downstream increased with the increasing incoming flow velocity in summary the swinging rotating cylinder evaluated in this study was shown to produce lift at zero and low ship speeds using the relative flow velocity provided by the swinging motion to achieve the anti rolling effect associated with the magnus anti rolling device furthermore the best anti rolling effect was achieved by adjusting the rotational speed and swing speed of the cylinder according to the flow velocity further investigations are required to evaluate the hydrodynamic performance of the magnus anti rolling device at higher speeds critically the influence of the hull on the hydrodynamic performance of the magnus anti rolling device was not considered in the numerical simulations conducted in this study as a result the hydrodynamic characteristics of the magnus anti rolling device when coupled with the hull need to be considered in future research another issue that warrants further study is the impact of the cylinder surface shape and roughness on the hydrodynamic performance of the magnus anti rolling device credit authorship contribution statement jian feng lin investigation formal analysis writing original draft preparation yang han methodology investigation writing review editing yu min su supervision resources project administration yu wang data curation validation conceptualization zuo tian zhang conceptualization investigation rui qi jiang data curation investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements funding this work was supported by the national natural science foundation of china grant number 52001090 
20812,this paper presents a novel adaptive neural event triggered formation control strategy for underactuated surface vehicles usvs in the presence of marine practical constraints i e the waypoints based planned path and actuator failures the proposed strategy is composed of the guidance model and the control one for the guidance part the logic virtual ship lvs guidance principle is developed to implement the reference path programming for the formation pattern for merit of the adaptive virtual ship the smooth reference can be produced for followers without using the velocity information of leader furthermore the proposed adaptive neural fault tolerant control algorithm is to guarantee that the followers can maintain their pattern and converge to the corresponding reference path in the algorithm the neural networks nns based observer is designed to estimate the unmeasurable velocities of followers online with the input event triggered mechanism two adaptive parameters are derived to compensate for the gain uncertainty and actuator failure and that could effectively reduce the communication burden for the channel from controller to actuator the derived closed loop system has been proved to be with the semi global uniform ultimate bounded sguub stability finally the superiority of the proposed strategy can be verified by the simulation experiments keywords underactuated surface vehicle formation control fault tolerant event triggered control lvs guidance 1 introduction in the past decades as the development of the ship motion control theory and application the research around underactuated surface vehicle usv has attracted intensive attention in the field of marine cybernetics typically the interested topics can be listed as the path following control the formation control the dynamic positioning control etc it is noted that the formation control of usvs has been widely studied in the existing literatures peng et al 2013 shojaei 2016 park and yoo 2019 which is an important and significant issue for the practical engineering and some practical constraints may cause instability of the closed loop system and even lead to invalidation of the conventional theoretical algorithm e g the limited communication resource and the possible actuator failure thus the investigation of the formation control of usvs with consideration of practical constraints requires more attentions to be attracted to obtain the predefined formation many useful formation methods have been investigated including behavior based balch and arkin 1998 virtual structure dong et al 2016 leader follower cui et al 2010 xu 2016 topology based control huang et al 2019a liu et al 2020 and so on among these approaches the leader follower strategy is preferred in practice on account of its simplicity and scalability in order to solve the line of sight los range and angle constraints a novel fault tolerant finite time formation control strategy is developed for usvs in xu 2016 considering usvs with the actuator saturation and limited torque the corresponding leader follower formation controller is provided in shojaei 2016 in huang et al 2020 a leader follower consensus technique is designed for a class of nonlinear systems wherein both leader follower and leaderless cases are considered in a unified framework normally the formation navigation system can be divided into the guidance module and the control one zhang and zhang 2013 it is well known that the los guidance principle has been widely studied in recent years tian et al 2020 liu et al 2017 wan et al 2020 however a major drawback of the los principle is that there exists a jump in the desired yaw rate during transition from the straight line to the pivoting waypoint fossen 2011 to eliminate this limitation in lu et al 2018 a virtual vessel strategy is developed for followers navigating along the curved path with a good tracking performance although the above problem has been solved yet another non negligible problem has emerged i e current literatures rarely consider marine practical constraints existing theoretical researches on formation control of usvs mainly take a simple trajectory and keep a fixed formation configuration to prove the effectiveness of the algorithm nevertheless in ocean going operation most ocean vessels navigate along the waypoints based planned route set by the ship s pilot in advance which means that the formation needs to keep track in the straight section and automatically turn when approaching the next waypoint meanwhile in some special circumstances the fixed formation configuration of the usvs does not meet the requirements of certain missions for example when a group of usvs sail from a wide waterway to a narrow waterway their formation prefers to be adjustable therefore the further research on formation control strategy for usvs considering marine practical constraints is needed as for the control part by fusing of the dynamic surface control dsc technique li et al 2019 peng et al 2017 and radial basis function neural network rbf nn xu et al 2020 xu and shou 2018 the problems of both the so called explosion of complexity and structure uncertain terms are addressed in the traditional backstepping framework however in the aforementioned works these schemes suffered from three major problems the first one is about unknown actuator faults fortunately the fault tolerant control is an effective tool to handle this problem li et al 2020b a zhou et al 2019 cui et al 2020 in lu et al 2020 by utilizing an improved variable separation method the fault problems of both sensor and actuator are solved simultaneously in the context of multiagent systems with communication delay and actuator faults li and ren 2021 addresses the constrained consensus problem by deriving a novel delay dependent fault tolerant controller second the problem is induced by the assumption that the velocities of usvs can be obtained directly it is well known that the position and heading angle of marine vessels can be measured directly by gps and gyro compass respectively however the velocity of usvs may not be easily obtained fortunately the nns based observer is an effective technique such that the real time velocity estimation can be provided for the closed loop system zhang and yang 2020 the third problem is the limited transmission resource for the formation control system of underactuated ships the control orders are generated from the controller and should be real time transmitted to the actuators i e the rudder and the propeller that could cause the large communication burden and the excess wear even leading to the actuators faults to overcome this constraint the event triggered control is an effective method to reduce the occupation of the transmission channel li and yang 2018 huang et al 2019b hu et al 2018 motivated by the aforementioned discussion a novel adaptive neural event triggered formation control strategy is proposed for usvs to achieve the waypoints based formation navigation in the presence of actuator failures the main contributions of this paper can be summarized as twofold 1 different from lu et al 2018 the proposed lvs guidance principle takes the marine practice into consideration i e the usvs navigate along the waypoints based reference path in the leader guidance part a logic virtual ship is developed to generate the waypoints based smooth reference as for the follower one the adaptive virtual ship avs is derived with the estimated velocity variables that could solve the problem that the leader s velocities are immeasurable furthermore through tuning the pattern parameter the proposed guidance law can generate the adjustable formation pattern that is meaningful and significant for usvs navigating in the narrow waters 2 an adaptive neural fault tolerant control algorithm is proposed for usvs subject to actuator failures and the environment disturbance in the algorithm the velocity states of usvs are estimated effectively by the nns based observer the event triggered input is designed to reduce the communication burden from the controller to the actuator besides for merits of the adaptive law the gain uncertainty and the actuator failure can be compensated together unlike the existing results the proposed algorithm is derived with the rudder angle δ and the main engine speed n as control input which is more in accordance with the requirement of the engineering practice 2 problem formulation and preliminaries throughout this paper denotes the absolute operator value of a scalar denotes the euclidean norm of a vector λ min is minimum eigenvalue of the matrix ˆ where ˆ denotes the estimation value of 2 1 ship dynamics referencing to the newtonian or lagrangian mechanics fossen 2011 the three degree of freedoms 3dofs of underactuated surface vehicles can be established as eq 1 1 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r u f u v t u m u a n d w u v f v v d w v r f r v f r m r a δ d w r with f u v m v m u v r d u 1 m u u d u 2 m u u u d u 3 m u u 3 f v v m u m v u r d v 1 m v v d v 2 m v v v d v 3 m v v 3 f r v m u m v m r u v d r 1 m r r d r 2 m r r r d r 3 m r r 3 as we can see from fig 1 o x 0 y 0 z 0 is earth fixed frame o always represents the position of the ship s gravity center o x 0 and o y 0 point to north and east respectively o z 0 is perpendicular to the still water surface and points toward the center of the earth o x b y b z b represents the body fixed frame o x b points to the bow and o y b points to the ship s starboard side o z b points toward bilge keel the position vector x y ψ t r 3 of the marine ship denotes the surge sway displacement and yaw angle in the earth fixed frame respectively v u v r t r 3 denotes the surge sway and yaw velocities in the body fixed frame f u v f v v f r v are employed to indicate the uncertain functions in the mathematical model m u m v m r are the unknown parameters to represent the added mass and d i 1 d i 2 d i 3 i u v r denote the unknown nonlinear damping terms d w i i u v r are employed to denote the time vary environment disturbance forces or moment caused by the sea wind sea current and sea waves a n n a n a a δ δ a o n n o n o o δ δ o a n and a δ are actual control inputs and n o and δ o are orders of the actuators t u f r are the unknown gain function due to the consideration of actuators and can be written as eq 2 since the power generated by the propeller and rudder is certainly limited there must be existing unknown upper and lower bounds t u 0 f r 0 t u m f r m satisfying t u 0 t u t u m f r 0 f r f r m 2 t u 1 t p ρ d p 4 k t j p f r x r α h x h 6 13 λ λ 2 25 a r l 2 u r 2 v r 2 cos δ where ρ is the water density t p and α h are used to denote the interference extents around the propeller and the rudder d p represents the propeller diameter and j p is employed to denote the progress coefficient of the propeller k t is the thrust coefficient a r describes the rudder area l is the length between perpendiculars x r x h are the dimension parameters and u r v r are used to denote the relative surge and sway velocities of the rudder respectively the fault model of the actuators can be described as eq 3 3 a j 1 s j o j o j j n δ t t j h s t j h e where s j is the unknown loss of the actuators and satisfies 0 s j 1 j n δ and o n o δ represent the basic faults t j h s t j h e are utilized to present the start time and finish time of the actuator fault respectively it is worth noting that model 3 can be described as the following four fault modes 1 s j 0 and o j 0 the actuator works normally 2 0 s j 1 and o j 0 this indicates the partial loss of the effectiveness ploe 3 s j 0 and o j 0 in this case the actuator is with the bias fault 4 0 s j 1 and o j 0 the actuator is with both the bias fault and ploe assumption 1 in marine practice the external disturbance terms are bounded in this paper we assume that the external disturbance terms d w i i u v r exist an unknown upper bound d w i m satisfying d w i d w i m i u v r assumption 2 according to the description in li et al 2008 and zhang et al 2015 the sway motion velocity v is passive bounded for the usvs remark 1 the passive boundedness theory has been presented in assumption 2 and the detailed analysis considering different cases can be seen in li et al 2008 and this assumption can be satisfied easily in the marine navigation practice lemma 1 zhang and yang 2020 for any ϵ 0 and ϱ r the following inequality can obtained as eq 4 4 0 ϱ ϱ tanh ϱ ϵ 0 2785 ϵ the objective of this paper is to design an adaptive neural fault tolerant formation control law for underactuated vehicles such that 1 the waypoints based reference path can be tracked with a desired formation pattern subject to actuator failures and marine disturbances 2 all signals in the closed loop system can be guaranteed to be semi global uniformly ultimately bounded sguub 2 2 nn based nonlinear function approximation the nns approximation technique provides an effective tool to deal with the system uncertainty specially the radial basis function rbf nns are always employed to tackle unstructured uncertainties owing to its good approximation performance the following lemma is useful for the control design in the next following sections lemma 2 zhang and zhang 2013 for any given unknown continuous function f x with f 0 0 defined on a compact set ω x r m by using rbf nns techniques the nonlinear function f x can be described as eq 5 5 f x θ t φ x ε x x ω x in eq 5 θ θ 1 θ 2 θ ℓ t is the weight matrix and the random approximation error ε x is with an unknown upper bound ε and φ x φ 1 x φ 2 x φ ℓ x is a vector of radial basis functions with the form of gaussian function as eq 6 6 φ i x 1 2 π ζ i exp x μ i t x μ i 2 ζ i 2 where μ i is the center of receptive field and ζ i is the width of gaussian function i 1 2 ℓ ℓ is the node number of nns 3 design of the lvs formation guidance in marine practice almost all underactuated surface vehicles carry out the path following missions according to the waypoints based route however the existing formation researches rarely consider this problem so the waypoints based formation navigation is worthy of more attention and research in this section we aim to develop a novel lvs guidance principle which is consists of two parts i e the reference path programming for the leader and adaptive programming of avs 3 1 reference path programming for the leader benefiting from zhang and zhang 2013 the lvs is introduced without inertial and damping terms which can be described as eq 7 note that lvs acts as the role of leader ship in our algorithm 7 x l u l cos ψ l y l u l sin ψ l ψ l r l referring to fig 2 the navigation route of usvs can be split into the straight path and curve one by employing the lvs the waypoints based reference route can be generated with the surge velocity u l and heading angular velocity r l in general u l is a positive constant selected by user while r l is a changing value which can be calculated in the straight paths w i 1 p in w i and p out w i w i 1 r l 0 in the smooth arcs p in w i p out w i r l is a nonzero constant which can be calculated with r l u l r i the bearing angle of w i 1 w i and w i w i 1 can be expressed as eq 8 and the angle error δ ϕ i is defined as δ ϕ i ϕ i i 1 ϕ i 1 i then the turning radius r i depending on the ship maneuverability rest with δ ϕ i in π 2 π 2 given by eq 9 by repeating a similar procedure the waypoint based reference route can be obtained 8 ψ i 1 i arctan y i y i 1 x i x i 1 9 r i r m a x δ ϕ i π 2 r m a x r m i n δ ϕ i s g n δ ϕ i π 2 δ ϕ i π 2 3 2 adaptive programming of avs in this subsection we aim to develop an avs to generate the reference trajectory for follower only with the position and yaw angle of the leader see fig 3 for this purpose we programme the velocity vector of the avs and develop an adaptive law to update the velocity input online before programming the avs one introduce the formation filtered model as eq 10 to adjust the configuration of usvs during formation scaling 10 ρ d f ρ d ρ d f t ρ d λ d f λ d λ d f t λ d where ρ d and λ d are the distance and related bearing angle from lvs to avs respectively ρ d f and λ d f are filtered desired distance and filtered bearing angle t ρ d t λ d are positive time constants in the earth fixed framework the reference signals of followers can be obtained as eq 11 with the filtered desired distance ρ d f and filtered related bearing angle λ d f 11 η r η l r ψ l ι where η r x r y r ψ r t η l x l y l ψ l t are the position vector of the followers and leader respectively ι ρ d f cos λ d f ρ d f sin λ d f 0 t the derivation of η r can be calculated as eq 12 r ψ l has the form as eq 13 12 η r r ψ l v r 13 r ψ l cos ψ l sin ψ l 0 sin ψ l cos ψ l 0 0 0 1 where v r u l r l ρ d f sin λ d f v l r l ρ d f cos λ d f r l t here v r includes velocity information of the leader which may be unavailable in practical application according to assumption 2 there exists a positive constant v m satisfying v r v m then the dynamics of the avs can be written as eq 14 14 η v r ψ v v v we defined the tracking error of avs can be defined as e η r η v subsequently the velocity vector of the avs is programmed as eq 15 15 v v r t ψ v k e e v ˆ m tanh e ϵ e where k e is the control parameter matrix determined by user and ϵ e is a small positive constant v ˆ m is the estimation of v m and updates online by the following adaptive law as eq 16 16 v ˆ m γ v e t tanh e ϵ e σ v v ˆ m v ˆ m 0 to stabilized the tracking error e one choose the lyapunov candidate as eq 17 17 v 0 1 2 e t e 1 2 γ v v m 2 due to the kinematic model eqs 12 14 and r ψ l 1 thus the derivative of v 0 can be described as eq 18 18 v 0 e t r ψ l v r r ψ v v v γ v 1 v m v ˆ m e v r e t r ψ v v v γ v 1 v m v ˆ m according to lemma 1 the following inequality eq 19 is useful for next analysis 19 e 0 2785 n ϵ e e t tanh e ϵ e substituting eqs 15 16 and 19 into eq 18 we can get eq 20 as follows 20 v 0 0 2785 n ϵ e e t tanh e ϵ e v m e t k e e v ˆ m tanh e ϵ e γ v 1 v m v ˆ m e t k e e e t tanh e ϵ e v m 0 2785 n ϵ e v m v m e t tanh e ϵ e σ v v ˆ m v ˆ m 0 e t k e e 0 2785 n ϵ e v m σ v 2 v m 2 σ v 2 v m v ˆ m 0 2 remark 2 through designing the lyapunov function eq 17 the avs can guaranteed to follow the reference trajectory of the follower only with the leader s position and orientation information by choosing the ϵ e σ v appropriately the bound of e and v m can be arbitrary small k e and γ v determine the transient performance of the close loop formation system according to eq 20 it is apparent that all the signals in the close loop system are sguub 4 controller design 4 1 nns based observer design taking eqs 3 and 5 into consideration the ship dynamics 1 can be rewritten as eq 21 21 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r u g u o n t θ u t φ u v ε u v d w u v θ v t φ v v ε v v d w v r g r o δ t θ r t φ r v ε r v d w r where g u t u m u 1 s n and g r f r m r 1 s δ are the unknown gains consisted of the actuators gain and the failure gain remark 3 different from results in wang et al 2019 and xing et al 2017 it can be seen that it is not straightforward to design the control laws with both actuator failures and the unknown control gain the proposed algorithm is designed to estimate the product of the loss of control effectiveness and gain uncertainty instead of separately estimating them which can simplify the complexity of control design then the nns based observer can be obtained as eq 22 22 x ˆ u ˆ cos ψ ˆ k 1 x x ˆ y ˆ u ˆ sin ψ ˆ k 2 y y ˆ ψ ˆ r ˆ k 3 ψ ψ ˆ u ˆ g ˆ u o n t θ ˆ u t φ u v ˆ k 4 x x ˆ v ˆ θ ˆ v t φ v v ˆ k 5 y y ˆ r ˆ g ˆ r o δ t θ ˆ r t φ r v ˆ k 6 ψ ψ ˆ where g ˆ u g ˆ r and θ ˆ i are the estimations of g u g r and θ i i u v r respectively the observer parameters k i i 1 2 3 4 5 6 are selected such that eq 23 are hurwitz 23 a u k 1 1 k 4 0 a v k 2 1 k 5 0 a r k 3 1 k 6 0 then we define the observer errors as χ u x x ˆ u u ˆ t χ v y y ˆ v v ˆ t χ r ψ ψ ˆ r r ˆ t considering eqs 21 and 22 the following equation eq 24 can be obtained 24 χ i a i χ i ε i v d w i π n i g i υ j t where n u n r 0 1 t n v 0 0 t d w i 0 d w i t ε i v 0 ε i t π 0 θ i t φ v ˆ t then for any given q t q 0 there is a positive definite symmetric matrix w satisfying a t w w a q the following lyapunov function is chosen as eq 25 25 v 1 i u v r χ i t w χ i by calculating the derivative of v 1 and combining with eq 24 one can get eq 26 as follows 26 v 1 i u v r χ i t w a i χ i ε i v d w i π n i g i υ i t i u v r 1 2 χ i t q χ i χ i t w ϵ i v d w i π n i g i υ j t based on young s inequality one has the following equations which are useful for the next analysis 27 χ i t w ϵ i d w i χ i 2 w 2 ϵ i m 2 d w i m 2 28 χ i t w π χ i 2 w 2 θ i 2 submitting eqs 27 and 28 into eq 26 we can obtain the eq 29 29 v 1 i u v r λ m i n q 2 χ i 2 w 2 θ i 2 w 2 ϵ i m 2 d w i m 2 χ i t wn i g i υ j t 4 2 adaptive neural fault tolerant formation control design step 1 at this step the goal is to design the kinematic control for the follower to derive the virtual control laws of u r we define the error variables as eq 30 30 x e x v x ˆ y e y v y ˆ ψ e ψ r ψ ˆ z e x e 2 y e 2 where ψ r is the azimuth angle defined from follower to virtual ship and it can be calculated by eq 31 31 ψ r 1 2 1 sgn x e sgn y e π arctan y e x e z e 0 ψ v z e 0 according to eqs 22 and 30 we have the following virtual control laws as eq 32 32 α u cos ψ e 1 k z e z e δ x y x v cos ψ r y v sin ψ v v ˆ sin ψ e α r k ψ e ψ e r ˆ k 3 ψ ψ ˆ where k z e k ψ e are positive control parameters and δ x y is a small positive constant to avoid the so called explosion of complexity the dsc technique is employed by introducing two first order filters β u and β r let the virtual controllers pass through them with time constants τ u and τ r respectively 33 τ i β i β i α i β i 0 α i 0 i u r let dsc errors q i α i β i i u r then the derivative of q i can be described as eq 34 34 q u α u β u q u τ u e u x v x v y v y v ψ r ψ r ψ e ψ e z e z e v ˆ v ˆ q r α r β r q r τ r e r ψ r ψ r ψ e ψ e where e i i u r are the continuous bounded functions step 2 to facilitate analysis the kinetics error variables u e and r e can be obtained as eq 35 35 u e β u u ˆ r e β r r ˆ taking the derivative of u e and r e one has eq 36 36 u e β u g ˆ u o n t θ ˆ u t φ u v ˆ k 4 x x ˆ r e β r g ˆ r o δ t θ ˆ r t φ r v ˆ k 6 ψ ψ ˆ next to reduce the communication burden for the channel from controller to actuator we begin to introduce the event triggered rule as eq 37 with a time varying threshold which makes the event sampling more flexible and the control signals for the actuators can be defined as eq 38 37 t k 1 inf t t k e j t β j o j t η j 38 o j t ω j t k t k t k 1 j n δ where ω j t k is the event triggered controller of the closed loop system t k is the updating time and e j ω j t k o j t is the measurement errors 0 β j 1 and 0 η j 1 are design parameters if the condition eq 37 is triggered the control order o j t will be updated to ω j t k 1 when t t k t k 1 o j t will remains as the current control signal ω j t k according to eq 37 the eq 39 can be derived apparently 39 ω j t k o j t β j o j t η j t r j n δ therefore it is not difficulty to find that there exit 0 λ j 1 1 and 0 λ j 2 1 such that eqs 40 and 41 is true 40 ω t 1 λ j 1 t β j o j λ j 2 t η j 41 o j t ω j t k 1 λ j 1 t β j λ j 2 t η j 1 λ j 1 β j then by submitting eq 41 into eq 36 we can get eq 42 42 u e β u g ˆ u ω n t k 1 λ n 1 t β n g ˆ u λ n 2 t η n 1 λ n 1 t β n θ ˆ u t φ u v ˆ k 4 x x ˆ r e β r g ˆ r ω δ t k 1 λ δ 1 t β δ g ˆ u λ δ 2 t η δ 1 λ δ 1 t β δ θ ˆ r t φ r v ˆ k 6 ψ ψ ˆ for the convenience of calculation we define g u g ˆ u 1 λ n 1 β n and g r g ˆ r 1 λ δ 1 β δ the adaptive parameters p ˆ u p ˆ r are defined as the estimation of the p u 1 g u p r 1 g r which are consist of the unknown actuator s gain and actuator failure gain the intermediate control laws α n α δ and the event triggered controllers ω n t and ω δ t can be obtained in eq 43 moreover the adaptive laws p ˆ u p ˆ r and the nns weights updating laws θ ˆ u θ ˆ r are designed as eq 44 43 n o sign o n t o n t ω n t p ˆ u α n δ o o δ t ω δ t p ˆ r α δ α n k u e u e β u g ˆ u η u tanh u e η n ϵ u θ ˆ u t φ u v ˆ k 4 x x ˆ α δ k r e r e β r g ˆ r η δ tanh r e η δ ϵ r θ ˆ r t φ r v ˆ k 6 ψ ψ ˆ 44 p ˆ u γ p u α n u e σ p u p ˆ u p ˆ u 0 p ˆ r γ p r α δ r e σ p r p ˆ r p ˆ r 0 θ ˆ u γ θ u u e φ u v ˆ σ θ u θ ˆ u θ ˆ u 0 θ ˆ r γ θ r r e φ r v ˆ σ θ r θ ˆ r θ ˆ r 0 in eqs 43 and 44 k u e k r e ϵ u ϵ r γ p u γ p r σ p u σ p r γ θ u γ θ r σ θ u σ θ r are the positive design parameters p ˆ i 0 and θ ˆ i 0 denote the initial value of p ˆ i and θ ˆ i respectively 4 3 stability analysis in this subsection the stability analysis of the closed loop system is carried out through the lyapunov analysis the main result is summarized as theorem 1 theorem 1 consider the closed loop system consisting of the error dynamic system 1 and 36 satisfying assumptions 1 2 under the nns based observer 22 the event triggered control law 43 and adaptive law 44 for all initial conditions satisfying z e 0 δ x t 2 ψ e 2 0 q u 2 0 q r 2 0 u e 2 0 r e 2 0 e 2 0 χ i 2 0 p u 2 0 p r 2 0 θ u 2 0 θ r 2 0 v m 2 0 2 ξ with any ξ 0 one can tune the parameters k z e k ψ e k u e k r e λ m i n k e λ m i n χ i γ p u γ p r γ θ u γ θ r γ v σ p u σ p r σ θ u σ θ r σ v appropriately such that all the immediate state variables are semi global uniformly ultimately bounded sguub proof firstly one choose the following lyapunov candidate function as eq 45 45 v v 0 v 1 1 2 z e δ x y 2 1 2 ψ e 2 1 2 u e 2 1 2 r e 2 1 2 q u 2 1 2 q r 2 1 2 γ θ u θ u t θ u 1 2 γ θ r θ r t θ r g u 2 γ p u p u 2 g r 2 γ p r p r 2 substituting eqs 32 and 42 into the derivative of eq 45 one has eq 46 46 v v 0 v 1 z e δ x y z e ψ e ψ e u e u e r e r e i u r q i q i i u r 1 γ θ i θ i t θ i i u r g i γ p i p i p i v 0 v 1 k z e z e δ x y 2 k ψ e ψ e 2 z e δ x y q u ψ e q r z e δ x y u e ψ e r e k 4 x x ˆ u e k 6 ψ ψ ˆ r e i u r j n δ i e β i g ˆ i ω j t k 1 λ j 1 β j g ˆ i λ j 2 η j 1 λ j 1 β j θ ˆ i t φ i v ˆ i u r q i q i i u r 1 γ θ i θ i t θ i i u r g i γ p i p i p i to facilitate the stability analysis the following young s inequalities eqs 47 and 48 can be employed 47 ψ e r e ψ e 2 4 r e 2 ψ e q r ψ e 2 4 q r 2 z e δ x y u e z e δ x y 2 4 u e 2 z e δ x y q u z e δ x y 2 4 q u 2 48 q i q i q i e i q i 2 τ i q i 2 τ i q i 2 e i 2 m i 2 2 a m i 2 a 1 τ i m i 2 2 a q i 2 a where m i is the upper bound value of the e i i u r using lemma 1 one can obtain the eq 49 49 i e g ˆ i λ j 2 t η j 1 λ j 1 t β j i e g ˆ i η j tanh i e η j ϵ i 0 2785 ϵ i since 50 g ˆ i λ j 2 t η j 1 λ j 1 t β j g ˆ i λ j 2 t η j g ˆ i η j substituting eqs 43 44 and 47 50 into eq 46 we can obtain eq 51 51 v v 0 v 1 k z e 1 2 z e δ x y 2 k ψ e 1 2 ψ e 2 i u r 1 τ i m i 2 2 a 1 q i 2 2 a i u r i e 2 i u r θ i t φ i v ˆ i e i u r j n δ i e β i α j p i g i α j g ˆ i λ j 2 η j 1 λ j 1 β j θ ˆ i t φ i v ˆ k 4 x x ˆ u e k 6 ψ ψ ˆ r e i u r 1 γ θ i θ i θ ˆ i φ i v ˆ i e i u r g i γ p i p i p ˆ i v 0 v 1 k z e 1 2 z e δ x y 2 k ψ e 1 2 ψ e 2 i u r 1 τ i m i 2 2 a 1 q i 2 2 a i u r k i e 3 2 i e 2 i u r θ i 2 2 i u r 0 2785 ϵ i i u r σ θ i θ i θ ˆ i θ ˆ i 0 i u r g i σ p i p i p ˆ i p ˆ i 0 adding v 0 in eq 20 with v 1 in eq 29 the derivative of overall lyapunov candidate function can be inferred as eq 52 52 v k z e 1 2 z e δ x y 2 k ψ e 1 2 ψ e 2 k u e 3 2 u e 2 k r e 3 2 r e 2 i u r 1 τ i m i 2 2 a 1 q i 2 g i σ p i 2 i u r p i 2 i u r 1 2 σ θ i 2 w 2 θ i 2 e t k e e σ v 2 v m 2 i u r λ m i n q 2 χ i 2 i u r w 2 ϵ i m 2 d w i m 2 i u r χ i t w g i υ j t 2 a i u r 0 2785 ϵ i σ θ i 2 i u r θ i θ ˆ i 0 2 σ p i 2 i u r p i p ˆ i 0 2 0 2785 n v m ϵ e σ v 2 v m v ˆ m 0 2 let γ min k z e 1 2 k ψ e 1 2 k u e 3 2 k r e 3 2 1 τ i m i 2 2 a 1 λ m i n q 2 λ m i n k e 1 γ θ i σ θ i w 2 2 γ p i σ p i 2 γ v σ v 2 we further have the following inequality eq 53 53 v 2 γ v δ where δ σ i u r w 2 ϵ i m 2 d w i m 2 σ i u r χ i t w g i υ j t 2 a σ i u r 0 2785 ϵ i σ p i 2 i u r p i p ˆ i 0 2 σ θ i 2 i u r θ i θ ˆ i 0 2 0 2785 n v m ϵ e σ v 2 v m v ˆ m 0 2 integrate it the trajectory of v can be bounded by 54 v t δ 2 γ v 0 δ 2 γ exp 2 γ t obviously lim t v t δ 2 γ which indicates that all signals of the closed loop formation control system are sguub and the measurement errors are small enough which could be converge to zero by selecting the designed parameters appropriately the proof is finished then we demonstrate that there exists t 0 such that the inter sampling intervals t k 1 t k t k z with e j t ω j t o j t t t k t k 1 we can know the eq 55 as follows 55 d d t e j d d t e j e j 1 2 sign e j e j ω j considering eq 43 we know that ω j is differentiable and ω j is bounded therefore there exists a positive constant ϖ satisfying ω j ϖ since e j t k 0 and lim t t k 1 e j t η j it is easy to know that the lower bound of the inter sampling intervals t must satisfy t η j ϖ 0 based on the analysis above the zeno behavior is ruled out 5 numerical experiment in this section two simulation experiments are introduced to verify the effectiveness and superiority of the proposed control algorithm including the experiment under the narrow waterway and marine environment and the comparative experiment both numerical experiments are quoted from the underactuated ship used in zhang and zhang 2013 and li et al 2008 length of 38 m mass of 118 1 0 3 kg 5 1 experiment under the narrow waterway and marine environment in this experiment the reference route is generated by employing five waypoints w 1 0 m 0 m w 2 0 m 1000 m w 3 2000 m 1500 m w 4 2000 m 3500 m w 5 3500 m 4000 m and one shrinking point s 2000 m 1950 m the shrinking point s is set behind the third waypoint w 3 once the leader arrive at the shrinking point the distances ρ d between leader and followers reduce from 200 m to 120 m automatically note that this formation scaling is smooth enough without possible abrupt pattern change which benefits from the formation filtered model to show the robustness of the algorithm jonswap joint north sea wave project wave spectrum fossen 2011 is introduced to generated the time varying wind generated waves spectrums with sixth level sea state the mean wind speed is v w i n d 12 25 m s and the mean wind direction is set as ψ w i n d 45 deg the jonswap wave spectrums and 3d view of the irregular wind generated waves are shown in fig 4 for the guidance principle part the surge speed of the leader is chosen as u l 5 m s initial states of the leader are selected as x 0 y 0 ψ 0 leader 0 m 0 m 9 0 as for the followers the initial states are chosen as x 0 y 0 ψ 0 u 0 v 0 r 0 follower1 220 m 30 m 10 0 4 5 m s 0 m s 0 rad s x 0 y 0 ψ 0 u 0 v 0 r 0 follower2 210 m 30 m 8 0 5 5 m s 0 m s 0 rad s eq 56 gives the detailed control parameters of the follower1 and follower2 as for the actuator fault model we choose the failures of both propeller and rudder occurring at 450 s for the follower1 s n 0 1 o n 3 s δ 0 2 o δ 3 for the follower2 the propeller fault is set to s n 0 15 o n 1 while the rudder fault is set as s δ 0 o δ 5 56 k z e 1 2 1 k z e 2 0 9 k ψ e 1 1 2 k ψ e 2 1 2 k u e 1 0 9 k u e 2 3 1 k r e 1 0 35 k r e 2 0 35 γ p u γ p r 3 5 γ θ u γ θ r 3 ϵ u ϵ r 0 1 σ p u σ p r 0 5 σ θ u σ θ r 1 3 τ u τ r 0 1 remark 4 in the simulation experiments the related design parameters are tuned by using the trial and error strategy take the control parameters as an example it is known that the gain parameters should be large enough to ensure the control performance and another consideration is that the large parameter setting would lead to unexpected large control signals therefore in general one first sets large value for the gain parameters e g k z e 1 k z e 2 γ θ r then the parameters should be reduced properly by testing the simulation runs that could guarantee that the parameter setting is effective in the practical engineering the formation navigation simulation results can be seen in figs 5 11 with a desired formation pattern the waypoints based formation navigation under the narrow waterway can be achieved from fig 5 fig 6 presents the tracking error curves of position and orientation it can be seen that the position errors appear to fluctuate during the manipulation of ship turning and configuration scaling however this fluctuation is smooth enough see local magnifying detail for the clear purpose one only gives the results of follower1 in the following presentation the control order n o δ o and the actual input n a δ a under actuator failures are shown in fig 7 though the experiment was designed under the actuator failures the proposed algorithm is with a reasonable control order and actual input fig 8 describes the estimate velocities and actual velocities of follower1 it can be observed that the estimation performance of the nns based observer is good figs 9 and 10 give the corresponding adaptive control laws p ˆ u p ˆ r and the norm of weight estimations θ ˆ u θ ˆ r of follower1 as for fig 11 it is clearly that there exist a strictly positive minimum inter sample time to guarantee that the triggering instants are not accumulated that means the zeno behavior can be avoided 5 2 comparative experiment in this subsection the proposed adaptive neural fault tolerant formation control algorithm will be compared with the results in lu et al 2018 without loss of generality two underactuated ships i e the leader and follower1 are introduced in the comparative experiment the surge speed of the leader is set as u l 5 0 m s and the angular velocity r l is described in eq 57 57 r l 0 0 s t 40 s π 50 40 s t 80 s in this experiment the initial states of leader and follower1 are set as x 0 y 0 ψ 0 leader 0 m 0 m 0 rad x 0 y 0 ψ 0 u 0 v 0 r 0 follower1 10 m 40 m π 6 rad 0 m s 0 m s 0 rad s and the nonzero time varying disturbances are adopted in the plant as eq 58 58 d w u 11 12 1 0 35 sin 0 2 t 0 15 cos 0 5 t d w v 26 17 79 1 0 3 cos 0 4 t 0 2 sin 0 1 t d w r 950 636 1 0 3 cos 0 3 t 0 1 sin 0 5 t therefore the main comparative results are presented in figs 12 14 fig 12 indicates the formation tracking trajectories under two control algorithms although both control approaches can achieve the effective tracking for the reference route the proposed algorithm is with higher tracking accuracy from local details in fig 13 the convergence result of position and orientation errors is proposed apparently both errors are stabilized within a small range as for the fig 14 it can be found that the proposed algorithm owns the better stable performance which is benefited from the adaptive neural fault tolerant formation controller 59 m a e 1 t f t 0 t 0 t f e t d t m a i 1 t f t 0 t 0 t f τ t d t m t i 1 t f t 0 t 0 t f τ t 1 τ t d t for the purpose of the further quantitative comparison some useful performance indicators i e the mean absolute error m a e the mean absolute control input m a i and the mean total input variation m t i are introduced to estimate control performance with the following function expressed as eq 59 m a e is used to denote the stabilization ability of the closed loop system while m a i and m t i are the indicators to compute the energy consumption the detailed evaluation data is listed in table 1 as we can see from the comparison result though the item value ψ e underlined marked in the proposed algorithm is bit larger than ψ e in lu et al 2018 the values of the proposed algorithm are less than the related values in lu et al 2018 on the whole therefore the quantitative comparison can prove that the proposed algorithm is with great advantages of higher tracking accuracy and lower energy consumption furthermore one introduce table 2 to summarize the functional comparison of both control algorithms it is apparent that in terms of both control part and guidance one the proposed formation algorithm owns many advantages over the algorithm in lu et al 2018 which may contribute to future formation control research 6 conclusion a novel adaptive neural fault tolerant formation control algorithm and the lvs guidance principle have been proposed in this paper unlike existing formation researches the proposed guidance principle takes the marine practical constraint into consideration and allows the formation configuration to be adjustable by employing the avss the smooth reference paths can be generated for the followers without using the unknown velocity information of the leader for the control innovation benefiting from the nns based observer the unmeasured velocities of usvs can be estimated accurately moreover the input event triggered mechanism is introduced to reduce the communication burden from the controller to actuators and two adaptive parameters are designed to compensate for the gain uncertainty and unknown actuator failures the simulated experiment results under the sixth level sea state have illustrated the superiority and effectiveness of the proposed control algorithm even though this work cannot attend to every detail of the control task e g the algorithm may not targetly account for the unnecessary communication burden in the channel of sensor to controller that would be the further problem to be solved in the following works credit authorship contribution statement guoqing zhang methodology software formal analysis writing original draft project administration shang liu conceptualization software validation writing review editing jiqiang li validation formal analysis writing review editing xianku zhang project administration funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this paper is partially supported by the national natural science foundation of china no 51909018 51679024 the natural science foundation of liaoning province china no 20170520189 20180520039 the science and technology innovation foundation of dalian city china no 2019j12gx026 the fundamental research funds for the central universities in china no 3132020124 the authors would like to express our gratitude to anonymous reviewers for their valuable comments 
20812,this paper presents a novel adaptive neural event triggered formation control strategy for underactuated surface vehicles usvs in the presence of marine practical constraints i e the waypoints based planned path and actuator failures the proposed strategy is composed of the guidance model and the control one for the guidance part the logic virtual ship lvs guidance principle is developed to implement the reference path programming for the formation pattern for merit of the adaptive virtual ship the smooth reference can be produced for followers without using the velocity information of leader furthermore the proposed adaptive neural fault tolerant control algorithm is to guarantee that the followers can maintain their pattern and converge to the corresponding reference path in the algorithm the neural networks nns based observer is designed to estimate the unmeasurable velocities of followers online with the input event triggered mechanism two adaptive parameters are derived to compensate for the gain uncertainty and actuator failure and that could effectively reduce the communication burden for the channel from controller to actuator the derived closed loop system has been proved to be with the semi global uniform ultimate bounded sguub stability finally the superiority of the proposed strategy can be verified by the simulation experiments keywords underactuated surface vehicle formation control fault tolerant event triggered control lvs guidance 1 introduction in the past decades as the development of the ship motion control theory and application the research around underactuated surface vehicle usv has attracted intensive attention in the field of marine cybernetics typically the interested topics can be listed as the path following control the formation control the dynamic positioning control etc it is noted that the formation control of usvs has been widely studied in the existing literatures peng et al 2013 shojaei 2016 park and yoo 2019 which is an important and significant issue for the practical engineering and some practical constraints may cause instability of the closed loop system and even lead to invalidation of the conventional theoretical algorithm e g the limited communication resource and the possible actuator failure thus the investigation of the formation control of usvs with consideration of practical constraints requires more attentions to be attracted to obtain the predefined formation many useful formation methods have been investigated including behavior based balch and arkin 1998 virtual structure dong et al 2016 leader follower cui et al 2010 xu 2016 topology based control huang et al 2019a liu et al 2020 and so on among these approaches the leader follower strategy is preferred in practice on account of its simplicity and scalability in order to solve the line of sight los range and angle constraints a novel fault tolerant finite time formation control strategy is developed for usvs in xu 2016 considering usvs with the actuator saturation and limited torque the corresponding leader follower formation controller is provided in shojaei 2016 in huang et al 2020 a leader follower consensus technique is designed for a class of nonlinear systems wherein both leader follower and leaderless cases are considered in a unified framework normally the formation navigation system can be divided into the guidance module and the control one zhang and zhang 2013 it is well known that the los guidance principle has been widely studied in recent years tian et al 2020 liu et al 2017 wan et al 2020 however a major drawback of the los principle is that there exists a jump in the desired yaw rate during transition from the straight line to the pivoting waypoint fossen 2011 to eliminate this limitation in lu et al 2018 a virtual vessel strategy is developed for followers navigating along the curved path with a good tracking performance although the above problem has been solved yet another non negligible problem has emerged i e current literatures rarely consider marine practical constraints existing theoretical researches on formation control of usvs mainly take a simple trajectory and keep a fixed formation configuration to prove the effectiveness of the algorithm nevertheless in ocean going operation most ocean vessels navigate along the waypoints based planned route set by the ship s pilot in advance which means that the formation needs to keep track in the straight section and automatically turn when approaching the next waypoint meanwhile in some special circumstances the fixed formation configuration of the usvs does not meet the requirements of certain missions for example when a group of usvs sail from a wide waterway to a narrow waterway their formation prefers to be adjustable therefore the further research on formation control strategy for usvs considering marine practical constraints is needed as for the control part by fusing of the dynamic surface control dsc technique li et al 2019 peng et al 2017 and radial basis function neural network rbf nn xu et al 2020 xu and shou 2018 the problems of both the so called explosion of complexity and structure uncertain terms are addressed in the traditional backstepping framework however in the aforementioned works these schemes suffered from three major problems the first one is about unknown actuator faults fortunately the fault tolerant control is an effective tool to handle this problem li et al 2020b a zhou et al 2019 cui et al 2020 in lu et al 2020 by utilizing an improved variable separation method the fault problems of both sensor and actuator are solved simultaneously in the context of multiagent systems with communication delay and actuator faults li and ren 2021 addresses the constrained consensus problem by deriving a novel delay dependent fault tolerant controller second the problem is induced by the assumption that the velocities of usvs can be obtained directly it is well known that the position and heading angle of marine vessels can be measured directly by gps and gyro compass respectively however the velocity of usvs may not be easily obtained fortunately the nns based observer is an effective technique such that the real time velocity estimation can be provided for the closed loop system zhang and yang 2020 the third problem is the limited transmission resource for the formation control system of underactuated ships the control orders are generated from the controller and should be real time transmitted to the actuators i e the rudder and the propeller that could cause the large communication burden and the excess wear even leading to the actuators faults to overcome this constraint the event triggered control is an effective method to reduce the occupation of the transmission channel li and yang 2018 huang et al 2019b hu et al 2018 motivated by the aforementioned discussion a novel adaptive neural event triggered formation control strategy is proposed for usvs to achieve the waypoints based formation navigation in the presence of actuator failures the main contributions of this paper can be summarized as twofold 1 different from lu et al 2018 the proposed lvs guidance principle takes the marine practice into consideration i e the usvs navigate along the waypoints based reference path in the leader guidance part a logic virtual ship is developed to generate the waypoints based smooth reference as for the follower one the adaptive virtual ship avs is derived with the estimated velocity variables that could solve the problem that the leader s velocities are immeasurable furthermore through tuning the pattern parameter the proposed guidance law can generate the adjustable formation pattern that is meaningful and significant for usvs navigating in the narrow waters 2 an adaptive neural fault tolerant control algorithm is proposed for usvs subject to actuator failures and the environment disturbance in the algorithm the velocity states of usvs are estimated effectively by the nns based observer the event triggered input is designed to reduce the communication burden from the controller to the actuator besides for merits of the adaptive law the gain uncertainty and the actuator failure can be compensated together unlike the existing results the proposed algorithm is derived with the rudder angle δ and the main engine speed n as control input which is more in accordance with the requirement of the engineering practice 2 problem formulation and preliminaries throughout this paper denotes the absolute operator value of a scalar denotes the euclidean norm of a vector λ min is minimum eigenvalue of the matrix ˆ where ˆ denotes the estimation value of 2 1 ship dynamics referencing to the newtonian or lagrangian mechanics fossen 2011 the three degree of freedoms 3dofs of underactuated surface vehicles can be established as eq 1 1 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r u f u v t u m u a n d w u v f v v d w v r f r v f r m r a δ d w r with f u v m v m u v r d u 1 m u u d u 2 m u u u d u 3 m u u 3 f v v m u m v u r d v 1 m v v d v 2 m v v v d v 3 m v v 3 f r v m u m v m r u v d r 1 m r r d r 2 m r r r d r 3 m r r 3 as we can see from fig 1 o x 0 y 0 z 0 is earth fixed frame o always represents the position of the ship s gravity center o x 0 and o y 0 point to north and east respectively o z 0 is perpendicular to the still water surface and points toward the center of the earth o x b y b z b represents the body fixed frame o x b points to the bow and o y b points to the ship s starboard side o z b points toward bilge keel the position vector x y ψ t r 3 of the marine ship denotes the surge sway displacement and yaw angle in the earth fixed frame respectively v u v r t r 3 denotes the surge sway and yaw velocities in the body fixed frame f u v f v v f r v are employed to indicate the uncertain functions in the mathematical model m u m v m r are the unknown parameters to represent the added mass and d i 1 d i 2 d i 3 i u v r denote the unknown nonlinear damping terms d w i i u v r are employed to denote the time vary environment disturbance forces or moment caused by the sea wind sea current and sea waves a n n a n a a δ δ a o n n o n o o δ δ o a n and a δ are actual control inputs and n o and δ o are orders of the actuators t u f r are the unknown gain function due to the consideration of actuators and can be written as eq 2 since the power generated by the propeller and rudder is certainly limited there must be existing unknown upper and lower bounds t u 0 f r 0 t u m f r m satisfying t u 0 t u t u m f r 0 f r f r m 2 t u 1 t p ρ d p 4 k t j p f r x r α h x h 6 13 λ λ 2 25 a r l 2 u r 2 v r 2 cos δ where ρ is the water density t p and α h are used to denote the interference extents around the propeller and the rudder d p represents the propeller diameter and j p is employed to denote the progress coefficient of the propeller k t is the thrust coefficient a r describes the rudder area l is the length between perpendiculars x r x h are the dimension parameters and u r v r are used to denote the relative surge and sway velocities of the rudder respectively the fault model of the actuators can be described as eq 3 3 a j 1 s j o j o j j n δ t t j h s t j h e where s j is the unknown loss of the actuators and satisfies 0 s j 1 j n δ and o n o δ represent the basic faults t j h s t j h e are utilized to present the start time and finish time of the actuator fault respectively it is worth noting that model 3 can be described as the following four fault modes 1 s j 0 and o j 0 the actuator works normally 2 0 s j 1 and o j 0 this indicates the partial loss of the effectiveness ploe 3 s j 0 and o j 0 in this case the actuator is with the bias fault 4 0 s j 1 and o j 0 the actuator is with both the bias fault and ploe assumption 1 in marine practice the external disturbance terms are bounded in this paper we assume that the external disturbance terms d w i i u v r exist an unknown upper bound d w i m satisfying d w i d w i m i u v r assumption 2 according to the description in li et al 2008 and zhang et al 2015 the sway motion velocity v is passive bounded for the usvs remark 1 the passive boundedness theory has been presented in assumption 2 and the detailed analysis considering different cases can be seen in li et al 2008 and this assumption can be satisfied easily in the marine navigation practice lemma 1 zhang and yang 2020 for any ϵ 0 and ϱ r the following inequality can obtained as eq 4 4 0 ϱ ϱ tanh ϱ ϵ 0 2785 ϵ the objective of this paper is to design an adaptive neural fault tolerant formation control law for underactuated vehicles such that 1 the waypoints based reference path can be tracked with a desired formation pattern subject to actuator failures and marine disturbances 2 all signals in the closed loop system can be guaranteed to be semi global uniformly ultimately bounded sguub 2 2 nn based nonlinear function approximation the nns approximation technique provides an effective tool to deal with the system uncertainty specially the radial basis function rbf nns are always employed to tackle unstructured uncertainties owing to its good approximation performance the following lemma is useful for the control design in the next following sections lemma 2 zhang and zhang 2013 for any given unknown continuous function f x with f 0 0 defined on a compact set ω x r m by using rbf nns techniques the nonlinear function f x can be described as eq 5 5 f x θ t φ x ε x x ω x in eq 5 θ θ 1 θ 2 θ ℓ t is the weight matrix and the random approximation error ε x is with an unknown upper bound ε and φ x φ 1 x φ 2 x φ ℓ x is a vector of radial basis functions with the form of gaussian function as eq 6 6 φ i x 1 2 π ζ i exp x μ i t x μ i 2 ζ i 2 where μ i is the center of receptive field and ζ i is the width of gaussian function i 1 2 ℓ ℓ is the node number of nns 3 design of the lvs formation guidance in marine practice almost all underactuated surface vehicles carry out the path following missions according to the waypoints based route however the existing formation researches rarely consider this problem so the waypoints based formation navigation is worthy of more attention and research in this section we aim to develop a novel lvs guidance principle which is consists of two parts i e the reference path programming for the leader and adaptive programming of avs 3 1 reference path programming for the leader benefiting from zhang and zhang 2013 the lvs is introduced without inertial and damping terms which can be described as eq 7 note that lvs acts as the role of leader ship in our algorithm 7 x l u l cos ψ l y l u l sin ψ l ψ l r l referring to fig 2 the navigation route of usvs can be split into the straight path and curve one by employing the lvs the waypoints based reference route can be generated with the surge velocity u l and heading angular velocity r l in general u l is a positive constant selected by user while r l is a changing value which can be calculated in the straight paths w i 1 p in w i and p out w i w i 1 r l 0 in the smooth arcs p in w i p out w i r l is a nonzero constant which can be calculated with r l u l r i the bearing angle of w i 1 w i and w i w i 1 can be expressed as eq 8 and the angle error δ ϕ i is defined as δ ϕ i ϕ i i 1 ϕ i 1 i then the turning radius r i depending on the ship maneuverability rest with δ ϕ i in π 2 π 2 given by eq 9 by repeating a similar procedure the waypoint based reference route can be obtained 8 ψ i 1 i arctan y i y i 1 x i x i 1 9 r i r m a x δ ϕ i π 2 r m a x r m i n δ ϕ i s g n δ ϕ i π 2 δ ϕ i π 2 3 2 adaptive programming of avs in this subsection we aim to develop an avs to generate the reference trajectory for follower only with the position and yaw angle of the leader see fig 3 for this purpose we programme the velocity vector of the avs and develop an adaptive law to update the velocity input online before programming the avs one introduce the formation filtered model as eq 10 to adjust the configuration of usvs during formation scaling 10 ρ d f ρ d ρ d f t ρ d λ d f λ d λ d f t λ d where ρ d and λ d are the distance and related bearing angle from lvs to avs respectively ρ d f and λ d f are filtered desired distance and filtered bearing angle t ρ d t λ d are positive time constants in the earth fixed framework the reference signals of followers can be obtained as eq 11 with the filtered desired distance ρ d f and filtered related bearing angle λ d f 11 η r η l r ψ l ι where η r x r y r ψ r t η l x l y l ψ l t are the position vector of the followers and leader respectively ι ρ d f cos λ d f ρ d f sin λ d f 0 t the derivation of η r can be calculated as eq 12 r ψ l has the form as eq 13 12 η r r ψ l v r 13 r ψ l cos ψ l sin ψ l 0 sin ψ l cos ψ l 0 0 0 1 where v r u l r l ρ d f sin λ d f v l r l ρ d f cos λ d f r l t here v r includes velocity information of the leader which may be unavailable in practical application according to assumption 2 there exists a positive constant v m satisfying v r v m then the dynamics of the avs can be written as eq 14 14 η v r ψ v v v we defined the tracking error of avs can be defined as e η r η v subsequently the velocity vector of the avs is programmed as eq 15 15 v v r t ψ v k e e v ˆ m tanh e ϵ e where k e is the control parameter matrix determined by user and ϵ e is a small positive constant v ˆ m is the estimation of v m and updates online by the following adaptive law as eq 16 16 v ˆ m γ v e t tanh e ϵ e σ v v ˆ m v ˆ m 0 to stabilized the tracking error e one choose the lyapunov candidate as eq 17 17 v 0 1 2 e t e 1 2 γ v v m 2 due to the kinematic model eqs 12 14 and r ψ l 1 thus the derivative of v 0 can be described as eq 18 18 v 0 e t r ψ l v r r ψ v v v γ v 1 v m v ˆ m e v r e t r ψ v v v γ v 1 v m v ˆ m according to lemma 1 the following inequality eq 19 is useful for next analysis 19 e 0 2785 n ϵ e e t tanh e ϵ e substituting eqs 15 16 and 19 into eq 18 we can get eq 20 as follows 20 v 0 0 2785 n ϵ e e t tanh e ϵ e v m e t k e e v ˆ m tanh e ϵ e γ v 1 v m v ˆ m e t k e e e t tanh e ϵ e v m 0 2785 n ϵ e v m v m e t tanh e ϵ e σ v v ˆ m v ˆ m 0 e t k e e 0 2785 n ϵ e v m σ v 2 v m 2 σ v 2 v m v ˆ m 0 2 remark 2 through designing the lyapunov function eq 17 the avs can guaranteed to follow the reference trajectory of the follower only with the leader s position and orientation information by choosing the ϵ e σ v appropriately the bound of e and v m can be arbitrary small k e and γ v determine the transient performance of the close loop formation system according to eq 20 it is apparent that all the signals in the close loop system are sguub 4 controller design 4 1 nns based observer design taking eqs 3 and 5 into consideration the ship dynamics 1 can be rewritten as eq 21 21 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r u g u o n t θ u t φ u v ε u v d w u v θ v t φ v v ε v v d w v r g r o δ t θ r t φ r v ε r v d w r where g u t u m u 1 s n and g r f r m r 1 s δ are the unknown gains consisted of the actuators gain and the failure gain remark 3 different from results in wang et al 2019 and xing et al 2017 it can be seen that it is not straightforward to design the control laws with both actuator failures and the unknown control gain the proposed algorithm is designed to estimate the product of the loss of control effectiveness and gain uncertainty instead of separately estimating them which can simplify the complexity of control design then the nns based observer can be obtained as eq 22 22 x ˆ u ˆ cos ψ ˆ k 1 x x ˆ y ˆ u ˆ sin ψ ˆ k 2 y y ˆ ψ ˆ r ˆ k 3 ψ ψ ˆ u ˆ g ˆ u o n t θ ˆ u t φ u v ˆ k 4 x x ˆ v ˆ θ ˆ v t φ v v ˆ k 5 y y ˆ r ˆ g ˆ r o δ t θ ˆ r t φ r v ˆ k 6 ψ ψ ˆ where g ˆ u g ˆ r and θ ˆ i are the estimations of g u g r and θ i i u v r respectively the observer parameters k i i 1 2 3 4 5 6 are selected such that eq 23 are hurwitz 23 a u k 1 1 k 4 0 a v k 2 1 k 5 0 a r k 3 1 k 6 0 then we define the observer errors as χ u x x ˆ u u ˆ t χ v y y ˆ v v ˆ t χ r ψ ψ ˆ r r ˆ t considering eqs 21 and 22 the following equation eq 24 can be obtained 24 χ i a i χ i ε i v d w i π n i g i υ j t where n u n r 0 1 t n v 0 0 t d w i 0 d w i t ε i v 0 ε i t π 0 θ i t φ v ˆ t then for any given q t q 0 there is a positive definite symmetric matrix w satisfying a t w w a q the following lyapunov function is chosen as eq 25 25 v 1 i u v r χ i t w χ i by calculating the derivative of v 1 and combining with eq 24 one can get eq 26 as follows 26 v 1 i u v r χ i t w a i χ i ε i v d w i π n i g i υ i t i u v r 1 2 χ i t q χ i χ i t w ϵ i v d w i π n i g i υ j t based on young s inequality one has the following equations which are useful for the next analysis 27 χ i t w ϵ i d w i χ i 2 w 2 ϵ i m 2 d w i m 2 28 χ i t w π χ i 2 w 2 θ i 2 submitting eqs 27 and 28 into eq 26 we can obtain the eq 29 29 v 1 i u v r λ m i n q 2 χ i 2 w 2 θ i 2 w 2 ϵ i m 2 d w i m 2 χ i t wn i g i υ j t 4 2 adaptive neural fault tolerant formation control design step 1 at this step the goal is to design the kinematic control for the follower to derive the virtual control laws of u r we define the error variables as eq 30 30 x e x v x ˆ y e y v y ˆ ψ e ψ r ψ ˆ z e x e 2 y e 2 where ψ r is the azimuth angle defined from follower to virtual ship and it can be calculated by eq 31 31 ψ r 1 2 1 sgn x e sgn y e π arctan y e x e z e 0 ψ v z e 0 according to eqs 22 and 30 we have the following virtual control laws as eq 32 32 α u cos ψ e 1 k z e z e δ x y x v cos ψ r y v sin ψ v v ˆ sin ψ e α r k ψ e ψ e r ˆ k 3 ψ ψ ˆ where k z e k ψ e are positive control parameters and δ x y is a small positive constant to avoid the so called explosion of complexity the dsc technique is employed by introducing two first order filters β u and β r let the virtual controllers pass through them with time constants τ u and τ r respectively 33 τ i β i β i α i β i 0 α i 0 i u r let dsc errors q i α i β i i u r then the derivative of q i can be described as eq 34 34 q u α u β u q u τ u e u x v x v y v y v ψ r ψ r ψ e ψ e z e z e v ˆ v ˆ q r α r β r q r τ r e r ψ r ψ r ψ e ψ e where e i i u r are the continuous bounded functions step 2 to facilitate analysis the kinetics error variables u e and r e can be obtained as eq 35 35 u e β u u ˆ r e β r r ˆ taking the derivative of u e and r e one has eq 36 36 u e β u g ˆ u o n t θ ˆ u t φ u v ˆ k 4 x x ˆ r e β r g ˆ r o δ t θ ˆ r t φ r v ˆ k 6 ψ ψ ˆ next to reduce the communication burden for the channel from controller to actuator we begin to introduce the event triggered rule as eq 37 with a time varying threshold which makes the event sampling more flexible and the control signals for the actuators can be defined as eq 38 37 t k 1 inf t t k e j t β j o j t η j 38 o j t ω j t k t k t k 1 j n δ where ω j t k is the event triggered controller of the closed loop system t k is the updating time and e j ω j t k o j t is the measurement errors 0 β j 1 and 0 η j 1 are design parameters if the condition eq 37 is triggered the control order o j t will be updated to ω j t k 1 when t t k t k 1 o j t will remains as the current control signal ω j t k according to eq 37 the eq 39 can be derived apparently 39 ω j t k o j t β j o j t η j t r j n δ therefore it is not difficulty to find that there exit 0 λ j 1 1 and 0 λ j 2 1 such that eqs 40 and 41 is true 40 ω t 1 λ j 1 t β j o j λ j 2 t η j 41 o j t ω j t k 1 λ j 1 t β j λ j 2 t η j 1 λ j 1 β j then by submitting eq 41 into eq 36 we can get eq 42 42 u e β u g ˆ u ω n t k 1 λ n 1 t β n g ˆ u λ n 2 t η n 1 λ n 1 t β n θ ˆ u t φ u v ˆ k 4 x x ˆ r e β r g ˆ r ω δ t k 1 λ δ 1 t β δ g ˆ u λ δ 2 t η δ 1 λ δ 1 t β δ θ ˆ r t φ r v ˆ k 6 ψ ψ ˆ for the convenience of calculation we define g u g ˆ u 1 λ n 1 β n and g r g ˆ r 1 λ δ 1 β δ the adaptive parameters p ˆ u p ˆ r are defined as the estimation of the p u 1 g u p r 1 g r which are consist of the unknown actuator s gain and actuator failure gain the intermediate control laws α n α δ and the event triggered controllers ω n t and ω δ t can be obtained in eq 43 moreover the adaptive laws p ˆ u p ˆ r and the nns weights updating laws θ ˆ u θ ˆ r are designed as eq 44 43 n o sign o n t o n t ω n t p ˆ u α n δ o o δ t ω δ t p ˆ r α δ α n k u e u e β u g ˆ u η u tanh u e η n ϵ u θ ˆ u t φ u v ˆ k 4 x x ˆ α δ k r e r e β r g ˆ r η δ tanh r e η δ ϵ r θ ˆ r t φ r v ˆ k 6 ψ ψ ˆ 44 p ˆ u γ p u α n u e σ p u p ˆ u p ˆ u 0 p ˆ r γ p r α δ r e σ p r p ˆ r p ˆ r 0 θ ˆ u γ θ u u e φ u v ˆ σ θ u θ ˆ u θ ˆ u 0 θ ˆ r γ θ r r e φ r v ˆ σ θ r θ ˆ r θ ˆ r 0 in eqs 43 and 44 k u e k r e ϵ u ϵ r γ p u γ p r σ p u σ p r γ θ u γ θ r σ θ u σ θ r are the positive design parameters p ˆ i 0 and θ ˆ i 0 denote the initial value of p ˆ i and θ ˆ i respectively 4 3 stability analysis in this subsection the stability analysis of the closed loop system is carried out through the lyapunov analysis the main result is summarized as theorem 1 theorem 1 consider the closed loop system consisting of the error dynamic system 1 and 36 satisfying assumptions 1 2 under the nns based observer 22 the event triggered control law 43 and adaptive law 44 for all initial conditions satisfying z e 0 δ x t 2 ψ e 2 0 q u 2 0 q r 2 0 u e 2 0 r e 2 0 e 2 0 χ i 2 0 p u 2 0 p r 2 0 θ u 2 0 θ r 2 0 v m 2 0 2 ξ with any ξ 0 one can tune the parameters k z e k ψ e k u e k r e λ m i n k e λ m i n χ i γ p u γ p r γ θ u γ θ r γ v σ p u σ p r σ θ u σ θ r σ v appropriately such that all the immediate state variables are semi global uniformly ultimately bounded sguub proof firstly one choose the following lyapunov candidate function as eq 45 45 v v 0 v 1 1 2 z e δ x y 2 1 2 ψ e 2 1 2 u e 2 1 2 r e 2 1 2 q u 2 1 2 q r 2 1 2 γ θ u θ u t θ u 1 2 γ θ r θ r t θ r g u 2 γ p u p u 2 g r 2 γ p r p r 2 substituting eqs 32 and 42 into the derivative of eq 45 one has eq 46 46 v v 0 v 1 z e δ x y z e ψ e ψ e u e u e r e r e i u r q i q i i u r 1 γ θ i θ i t θ i i u r g i γ p i p i p i v 0 v 1 k z e z e δ x y 2 k ψ e ψ e 2 z e δ x y q u ψ e q r z e δ x y u e ψ e r e k 4 x x ˆ u e k 6 ψ ψ ˆ r e i u r j n δ i e β i g ˆ i ω j t k 1 λ j 1 β j g ˆ i λ j 2 η j 1 λ j 1 β j θ ˆ i t φ i v ˆ i u r q i q i i u r 1 γ θ i θ i t θ i i u r g i γ p i p i p i to facilitate the stability analysis the following young s inequalities eqs 47 and 48 can be employed 47 ψ e r e ψ e 2 4 r e 2 ψ e q r ψ e 2 4 q r 2 z e δ x y u e z e δ x y 2 4 u e 2 z e δ x y q u z e δ x y 2 4 q u 2 48 q i q i q i e i q i 2 τ i q i 2 τ i q i 2 e i 2 m i 2 2 a m i 2 a 1 τ i m i 2 2 a q i 2 a where m i is the upper bound value of the e i i u r using lemma 1 one can obtain the eq 49 49 i e g ˆ i λ j 2 t η j 1 λ j 1 t β j i e g ˆ i η j tanh i e η j ϵ i 0 2785 ϵ i since 50 g ˆ i λ j 2 t η j 1 λ j 1 t β j g ˆ i λ j 2 t η j g ˆ i η j substituting eqs 43 44 and 47 50 into eq 46 we can obtain eq 51 51 v v 0 v 1 k z e 1 2 z e δ x y 2 k ψ e 1 2 ψ e 2 i u r 1 τ i m i 2 2 a 1 q i 2 2 a i u r i e 2 i u r θ i t φ i v ˆ i e i u r j n δ i e β i α j p i g i α j g ˆ i λ j 2 η j 1 λ j 1 β j θ ˆ i t φ i v ˆ k 4 x x ˆ u e k 6 ψ ψ ˆ r e i u r 1 γ θ i θ i θ ˆ i φ i v ˆ i e i u r g i γ p i p i p ˆ i v 0 v 1 k z e 1 2 z e δ x y 2 k ψ e 1 2 ψ e 2 i u r 1 τ i m i 2 2 a 1 q i 2 2 a i u r k i e 3 2 i e 2 i u r θ i 2 2 i u r 0 2785 ϵ i i u r σ θ i θ i θ ˆ i θ ˆ i 0 i u r g i σ p i p i p ˆ i p ˆ i 0 adding v 0 in eq 20 with v 1 in eq 29 the derivative of overall lyapunov candidate function can be inferred as eq 52 52 v k z e 1 2 z e δ x y 2 k ψ e 1 2 ψ e 2 k u e 3 2 u e 2 k r e 3 2 r e 2 i u r 1 τ i m i 2 2 a 1 q i 2 g i σ p i 2 i u r p i 2 i u r 1 2 σ θ i 2 w 2 θ i 2 e t k e e σ v 2 v m 2 i u r λ m i n q 2 χ i 2 i u r w 2 ϵ i m 2 d w i m 2 i u r χ i t w g i υ j t 2 a i u r 0 2785 ϵ i σ θ i 2 i u r θ i θ ˆ i 0 2 σ p i 2 i u r p i p ˆ i 0 2 0 2785 n v m ϵ e σ v 2 v m v ˆ m 0 2 let γ min k z e 1 2 k ψ e 1 2 k u e 3 2 k r e 3 2 1 τ i m i 2 2 a 1 λ m i n q 2 λ m i n k e 1 γ θ i σ θ i w 2 2 γ p i σ p i 2 γ v σ v 2 we further have the following inequality eq 53 53 v 2 γ v δ where δ σ i u r w 2 ϵ i m 2 d w i m 2 σ i u r χ i t w g i υ j t 2 a σ i u r 0 2785 ϵ i σ p i 2 i u r p i p ˆ i 0 2 σ θ i 2 i u r θ i θ ˆ i 0 2 0 2785 n v m ϵ e σ v 2 v m v ˆ m 0 2 integrate it the trajectory of v can be bounded by 54 v t δ 2 γ v 0 δ 2 γ exp 2 γ t obviously lim t v t δ 2 γ which indicates that all signals of the closed loop formation control system are sguub and the measurement errors are small enough which could be converge to zero by selecting the designed parameters appropriately the proof is finished then we demonstrate that there exists t 0 such that the inter sampling intervals t k 1 t k t k z with e j t ω j t o j t t t k t k 1 we can know the eq 55 as follows 55 d d t e j d d t e j e j 1 2 sign e j e j ω j considering eq 43 we know that ω j is differentiable and ω j is bounded therefore there exists a positive constant ϖ satisfying ω j ϖ since e j t k 0 and lim t t k 1 e j t η j it is easy to know that the lower bound of the inter sampling intervals t must satisfy t η j ϖ 0 based on the analysis above the zeno behavior is ruled out 5 numerical experiment in this section two simulation experiments are introduced to verify the effectiveness and superiority of the proposed control algorithm including the experiment under the narrow waterway and marine environment and the comparative experiment both numerical experiments are quoted from the underactuated ship used in zhang and zhang 2013 and li et al 2008 length of 38 m mass of 118 1 0 3 kg 5 1 experiment under the narrow waterway and marine environment in this experiment the reference route is generated by employing five waypoints w 1 0 m 0 m w 2 0 m 1000 m w 3 2000 m 1500 m w 4 2000 m 3500 m w 5 3500 m 4000 m and one shrinking point s 2000 m 1950 m the shrinking point s is set behind the third waypoint w 3 once the leader arrive at the shrinking point the distances ρ d between leader and followers reduce from 200 m to 120 m automatically note that this formation scaling is smooth enough without possible abrupt pattern change which benefits from the formation filtered model to show the robustness of the algorithm jonswap joint north sea wave project wave spectrum fossen 2011 is introduced to generated the time varying wind generated waves spectrums with sixth level sea state the mean wind speed is v w i n d 12 25 m s and the mean wind direction is set as ψ w i n d 45 deg the jonswap wave spectrums and 3d view of the irregular wind generated waves are shown in fig 4 for the guidance principle part the surge speed of the leader is chosen as u l 5 m s initial states of the leader are selected as x 0 y 0 ψ 0 leader 0 m 0 m 9 0 as for the followers the initial states are chosen as x 0 y 0 ψ 0 u 0 v 0 r 0 follower1 220 m 30 m 10 0 4 5 m s 0 m s 0 rad s x 0 y 0 ψ 0 u 0 v 0 r 0 follower2 210 m 30 m 8 0 5 5 m s 0 m s 0 rad s eq 56 gives the detailed control parameters of the follower1 and follower2 as for the actuator fault model we choose the failures of both propeller and rudder occurring at 450 s for the follower1 s n 0 1 o n 3 s δ 0 2 o δ 3 for the follower2 the propeller fault is set to s n 0 15 o n 1 while the rudder fault is set as s δ 0 o δ 5 56 k z e 1 2 1 k z e 2 0 9 k ψ e 1 1 2 k ψ e 2 1 2 k u e 1 0 9 k u e 2 3 1 k r e 1 0 35 k r e 2 0 35 γ p u γ p r 3 5 γ θ u γ θ r 3 ϵ u ϵ r 0 1 σ p u σ p r 0 5 σ θ u σ θ r 1 3 τ u τ r 0 1 remark 4 in the simulation experiments the related design parameters are tuned by using the trial and error strategy take the control parameters as an example it is known that the gain parameters should be large enough to ensure the control performance and another consideration is that the large parameter setting would lead to unexpected large control signals therefore in general one first sets large value for the gain parameters e g k z e 1 k z e 2 γ θ r then the parameters should be reduced properly by testing the simulation runs that could guarantee that the parameter setting is effective in the practical engineering the formation navigation simulation results can be seen in figs 5 11 with a desired formation pattern the waypoints based formation navigation under the narrow waterway can be achieved from fig 5 fig 6 presents the tracking error curves of position and orientation it can be seen that the position errors appear to fluctuate during the manipulation of ship turning and configuration scaling however this fluctuation is smooth enough see local magnifying detail for the clear purpose one only gives the results of follower1 in the following presentation the control order n o δ o and the actual input n a δ a under actuator failures are shown in fig 7 though the experiment was designed under the actuator failures the proposed algorithm is with a reasonable control order and actual input fig 8 describes the estimate velocities and actual velocities of follower1 it can be observed that the estimation performance of the nns based observer is good figs 9 and 10 give the corresponding adaptive control laws p ˆ u p ˆ r and the norm of weight estimations θ ˆ u θ ˆ r of follower1 as for fig 11 it is clearly that there exist a strictly positive minimum inter sample time to guarantee that the triggering instants are not accumulated that means the zeno behavior can be avoided 5 2 comparative experiment in this subsection the proposed adaptive neural fault tolerant formation control algorithm will be compared with the results in lu et al 2018 without loss of generality two underactuated ships i e the leader and follower1 are introduced in the comparative experiment the surge speed of the leader is set as u l 5 0 m s and the angular velocity r l is described in eq 57 57 r l 0 0 s t 40 s π 50 40 s t 80 s in this experiment the initial states of leader and follower1 are set as x 0 y 0 ψ 0 leader 0 m 0 m 0 rad x 0 y 0 ψ 0 u 0 v 0 r 0 follower1 10 m 40 m π 6 rad 0 m s 0 m s 0 rad s and the nonzero time varying disturbances are adopted in the plant as eq 58 58 d w u 11 12 1 0 35 sin 0 2 t 0 15 cos 0 5 t d w v 26 17 79 1 0 3 cos 0 4 t 0 2 sin 0 1 t d w r 950 636 1 0 3 cos 0 3 t 0 1 sin 0 5 t therefore the main comparative results are presented in figs 12 14 fig 12 indicates the formation tracking trajectories under two control algorithms although both control approaches can achieve the effective tracking for the reference route the proposed algorithm is with higher tracking accuracy from local details in fig 13 the convergence result of position and orientation errors is proposed apparently both errors are stabilized within a small range as for the fig 14 it can be found that the proposed algorithm owns the better stable performance which is benefited from the adaptive neural fault tolerant formation controller 59 m a e 1 t f t 0 t 0 t f e t d t m a i 1 t f t 0 t 0 t f τ t d t m t i 1 t f t 0 t 0 t f τ t 1 τ t d t for the purpose of the further quantitative comparison some useful performance indicators i e the mean absolute error m a e the mean absolute control input m a i and the mean total input variation m t i are introduced to estimate control performance with the following function expressed as eq 59 m a e is used to denote the stabilization ability of the closed loop system while m a i and m t i are the indicators to compute the energy consumption the detailed evaluation data is listed in table 1 as we can see from the comparison result though the item value ψ e underlined marked in the proposed algorithm is bit larger than ψ e in lu et al 2018 the values of the proposed algorithm are less than the related values in lu et al 2018 on the whole therefore the quantitative comparison can prove that the proposed algorithm is with great advantages of higher tracking accuracy and lower energy consumption furthermore one introduce table 2 to summarize the functional comparison of both control algorithms it is apparent that in terms of both control part and guidance one the proposed formation algorithm owns many advantages over the algorithm in lu et al 2018 which may contribute to future formation control research 6 conclusion a novel adaptive neural fault tolerant formation control algorithm and the lvs guidance principle have been proposed in this paper unlike existing formation researches the proposed guidance principle takes the marine practical constraint into consideration and allows the formation configuration to be adjustable by employing the avss the smooth reference paths can be generated for the followers without using the unknown velocity information of the leader for the control innovation benefiting from the nns based observer the unmeasured velocities of usvs can be estimated accurately moreover the input event triggered mechanism is introduced to reduce the communication burden from the controller to actuators and two adaptive parameters are designed to compensate for the gain uncertainty and unknown actuator failures the simulated experiment results under the sixth level sea state have illustrated the superiority and effectiveness of the proposed control algorithm even though this work cannot attend to every detail of the control task e g the algorithm may not targetly account for the unnecessary communication burden in the channel of sensor to controller that would be the further problem to be solved in the following works credit authorship contribution statement guoqing zhang methodology software formal analysis writing original draft project administration shang liu conceptualization software validation writing review editing jiqiang li validation formal analysis writing review editing xianku zhang project administration funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this paper is partially supported by the national natural science foundation of china no 51909018 51679024 the natural science foundation of liaoning province china no 20170520189 20180520039 the science and technology innovation foundation of dalian city china no 2019j12gx026 the fundamental research funds for the central universities in china no 3132020124 the authors would like to express our gratitude to anonymous reviewers for their valuable comments 
20813,the objective of this work is to experimentally investigate the dynamic evolution of flow structure and pressure distribution on the water entry of a bulbous bow we focus on the water entry of an arbitrary bow based on the 18 5 station line of the kriso container ship with a typical bulbous bow time resolved particle image velocimetry tr piv is utilized to capture the transient flow information during the bow slamming the instantaneous pressure is estimated by solving the incompressible navier stokes equation using the lagrangian approach our findings demonstrate the formation and migration of a saddle point the generation of a strong shear layer near the concave zone at a low initial velocity and the deformation of an air pocket at a high initial velocity furthermore we offer insight into the reconstructed pressure field over the entire duration of the slamming especially the dramatic slamming pressure during the secondary impact it is interesting that the peak value locates on the critical point of the upward and downward flow caused by the pressing of the bow flare in addition the pressure close to the flare continuously keeps the global maximum keywords tr piv water entry bulbous bow secondary impact instantaneous pressure 1 introduction slamming research near the free surface has been investigated for many decades in that it is very important in the design of naval and aeronautical structures hughes et al 2013 truscott et al 2014 the key of slamming problems is how to accurately predict the hydrodynamic loading von karman 1929 proposed an analytical solution that can predict the impact pressure of a flat wedge during water entry considered as a seminal study subsequently taking into account the water pile up and the added mass considerable studies was dedicated to more precise solution dobrovol skaya 1969 wu 1998 mei et al 1999 scolan and korobkin 2001 in addition there are many works based on numerical schemes zhao and faltinsen 1993 xu et al 2008 and experimental studies tveitnes et al 2008 panciroli et al 2015 kim et al 2019 in general when focusing on water entry problems researchers usually choose regular objects as their study models such as wedges tveitnes et al 2008 wu et al 2004 russo et al 2018 cylinders lin and shieh 1997 van nuffel et al 2014 and spheres abraham et al 2014 however in naval engineering the slamming phenomenon frequently occurs in the ship stem stern with irregular shapes zong et al 2020 xie et al 2020a due to the dramatic change of surface curvature the slamming would induce complex gas liquid flow and fluid structure interaction during the water entry abrate 2011 therefore it is a technique challenge to accurately predict the hydrodynamic loading of irregular geometries the hydrodynamic loading of bow flare sections has been discussed by some researchers aarsnes 1996 performed experiments of a bow section in a free fall motion and pointed out that the secondary impact was caused by the slamming of separated flow sun and faltinsen 2009 applied a boundary element method to study the two dimensional water entry of a bow flare section wang and soares 2016 discussed ship motions slamming occurrence probability and slamming loads on the bow in irregular waves later kim et al 2019 performed experimental investigations on bow flare slamming loads which considered regular and irregular waves recently xie et al 2018 2020b presented detailed and valuable studies on the water entry of a 3d bow flare model and 2d bulbous bow sections despite the expanding experimental studies pressure gauges generally have priority to perform the direct measurement of hydrodynamic pressure tveitnes et al 2008 kim et al 2019 aarsnes 1996 xie et al 2018 while this methodology can only provide pressure information at a single point for a pressure gauge if more pressure distribution is needed it is practically cumbersome to install numerous pressure gauges with rapid advancements in high speed cameras and lasers it is available to indirectly measure the pressure fluctuation based on flow governing equations which need temporal velocity as the input that can be diagnosed by time resolved particle image velocimetry tr piv in contrast to conventional measurements this technique can non intrusively provide full field pressure and have the great potential for improvement van oudheusden 2013 multiple methods have been proposed for deriving the pressure from piv measurements gurka et al 1999 obtained the time averaged pressure of a pipe and jet flow by solving the poisson equation liu and katz 2006 innovatively presented an omni directional virtual integration scheme which can effectively reduce the cumulative errors along the direction of integration later de kat and van oudheusden 2012 systematically discussed the performance of the eulerian and the lagrangian approaches the art of methods to calculate the pressure based on piv has attracted the interest of plenty of researchers over the years van oudheusden 2013 wang et al 2016 2017 ragni et al 2019 nevertheless the optimal methodology has not yet been determined for various flow scenarios there are some contradicting results that solving the poisson equation may have more accurate results murai et al 2007 but the second order derivatives of the velocity may cause substantial uncertainties de kat and van oudheusden 2012 on the other hand an eulerian approach may lead to better agreement with the experiments jakobsen et al 1997 but a lagrangian approach may be less sensitive to measurement noise ghaemi et al 2012 for water entry problem several studies have verified the accuracy of indirect estimating slamming loads from piv measurement nila et al 2013 panciroli and porfiri 2013 shams et al 2015 jalalisendi et al 2015 2017 russo et al 2018 nila et al 2013 and shams et al 2015 estimated the slamming pressure of wedge section using a poisson based solver another method of slamming pressure prediction solving navier stokes equations was discussed by panciroli and porfiri 2013 jalalisendi et al 2015 2017 and russo et al 2018 they all dealt with the flow governing equations through the eulerian approach however the lagrangian approach was superior to the eulerian for dealing with advection motion such as plate flow and free surface impact flow de kat and van oudheusden 2012 although the early stages of water entry problem have been extensively investigated based on tr piv the kinematic and dynamic characterization of a bow flare slamming has not been reported in literature in this study although simplistic we perform a delicate experimental analysis of the secondary impact effect for an bulbous bow which may refer to this work as a prelude to describe the behaviors of hydrodynamic loads of a full scale ship bow during the experiments the time tracing kinematic information of the bow section i e acceleration displacement and velocity were monitored at two different drop heights which were respectively 5 and 50 cm indicating the absence and presence of an air pocket correspondingly subsequently piv results provided the instantaneous flow patterns during the bow slamming furthermore according to the incompressible navier stokes equation the slamming pressure was reconstructed based on piv data in the lagrange framework our primary interest the characteristic of secondary impact was analyzed in detail 2 experimental apparatus and methods 2 1 experimental setup referring to the previous work and opinions panciroli and porfiri 2013 shams et al 2015 jalalisendi et al 2015 the experimental setup is made of a custom built aluminum frame and a transparent tank for the bow slamming which allows free fall impact at a maximum drop height of 800 mm schematically drawn in fig 1 the water tank is 800 mm long 500 mm large and 500 mm deep then the tank is filled with water to 300 mm depth which could ignore the bottom wall effect jalalisendi et al 2017 in addition two long aluminum rails are rigidly mounted in the center of the frame for ensuring the vertical motion powered by a continuous 12 v supply an electric magnet is mounted in the middle of the sledge and used to control the free fall of the model in this work an arbitrary bow section are studied we choose the 18 5 station line of the kriso container ship kcs see fig 2 a which has a typical bulbous bow feature stretching the station line in spanwise the two dimensional bow model was made with a 1 200 scale ratio due to the limited measurement domain of the tr piv system it is obviously seen from fig 2 b that the bow section studied by aarsnes 1996 shows a straight shaped bulb at the bottom whereas the bow section of kcs exists a convex shaped bulb below the concave part the bow is divided into three zones convex zone concave zone and flare zone as shown in fig 2 c the model is fabricated of polylactic acid pla plastic manufactured in a hori z500 3d printing machine the model surface is delicately polished and smoothed matte black treatment is later performed to minimize laser sheet reflection in piv measurement the model is 125 1 mm long 117 5 mm high and 160 mm deep and it is connected to a sledge the mass of the whole falling body is 0 57 kg note that the mass does not follow the scale ratio because of the material properties and the aluminum sledge furthermore several marks are depicted on the front side of the model for monitoring the motion in slamming experiments are performed on the arbitrary bow section falling from 5 and 50 cm the initial velocities v 0 are 0 990 and 3 130 m s respectively indicating the absence and presence of an air pocket during water entry the reynolds number r e of the experimental conditions is approximately on the order of 1 0 6 the froude number f r is on the order of 1 and the gravitational acceleration g is 9 8 m s 2 viscosity effect is neglected in the study nila et al 2013 panciroli and porfiri 2013 and we wait for sufficient time 10 min to calm the water in between slamming experiments 2 2 measurement system a time resolved planar piv system is utilized to measure two dimensional flow velocity at the middle span of the falling bow where the three dimensional phenomena is negligible jalalisendi et al 2015 xie et al 2020a the tr piv system consists of a 10 w nd yag ray power laser source and a photron fastcam mini ux100 high speed cmos camera the spatial resolution of the camera is adjusted to 1280 1000 pixels by means of dantec studio v 6 2 and the acquisition frequency is 5 khz corresponding to a 0 2 ms time step a flat target with grid size of 10 10 mm 2 is used for the piv calibration with the field of view of 200 159 mm 2 corresponding to 7 63 pixels mm polymide seeding particles with a density of 1 03 g mm 3 and a mean diameter of 20 μ m are used as tracer particles the laser sheet is approximately 2 mm thick the piv measurement of slamming is ceased when the bow bottom arrives the bottom boundary of the camera view the recording times during each trial for the two drop heights of 5 and 50 cm are respectively 90 and 38 ms corresponding to 450 and 180 image frames besides the piv measurement the motion information is monitored as well including the entry depth and the bow velocity via high speed imaging and the acceleration via an accelerometer it should be noted that the motion measurement is independent of the piv test we utilize the high speed camera in the piv system to track the marks on the front side of the model carried out in laboratory illumination the spatial and temporal resolution of the camera remain unchanged meanwhile an accelerometer type cf0320 500 with a range of 500 g supported by dh5902 data acquisition system is installed in the middle of the sledge to measure the slamming acceleration at a data acquisition frequency of 4 khz for the two independent conditions with drop heights of 5 and 50 cm we performed three times piv measurements and three times motion information measurements to determine the repeatability of the experiments during the drop tests the entry depth ξ and the bow velocity ξ t are calculated from the average of the vertical transition and speed of the marks these marks on the front side of the bow section are tracked and analyzed by the software photon fastcam analysis when the bow bottom initially touches the free surface the time t is set to zero and the ξ t is zero as well 3 piv images and data analysis 3 1 piv analysis fig 3 displays a representative piv image with air pocket which caused by the high initial velocity of the bow section as the bow continuously penetrates the free surface the water piles up on the flare of the bow forming the water jet and a clear air pocket appears in the concave zone only half of the slamming domain is focused due to the symmetry of flow when executing cross correlation analysis of piv images it is necessary to improve the accuracy of the piv results at the fluid domain boundary due to the field of camera view includes water air and the arbitrary bow section see fig 3 a therefore moving masks the image pixel value is zero are applied to remove unnecessary information of the piv images the fidelity of the piv results in the vicinity of the bow and the free surface could be enhanced nila et al 2013 for the first piv measurement the masks are generated in batch process using the dantec studio v 6 2 function phase boundary detection and pre processing algorithms which are composed of gaussian smooth intensity normalization and wiener denoise filter specifically the processed image is present in fig 3 b further the same masks are used for the other two repeated piv measurements after acquiring the region of interest in the piv images an available open source software in matlab pivlab thielicke and stamhuis 2014 is used for post processing the sequence of image a fast fourier transform cross correlation algorithm and a multi grid interrogation scheme are adopted in the piv analysis it consists of decreasing interrogation windows of 64 64 32 32 and 16 16 pixels with 50 overlap a 2 3 point gaussian fit is utilized for sub pixel peak fitting and a multidimensional spline smoothing algorithm garcia 2010 is adopted to reduce the noise of piv measurements eventually the valid vectors across the slamming process are always larger than 96 3 2 piv based pressure reconstruction and motion analysis after obtained the velocity field all piv results are transferred to matlab workspace a custom made code is developed for reconstructing the impact pressure it is divided into two steps firstly the pressure gradient is calculated through the navier stokes equation secondly the pressure is extracted by integrating the pressure gradient for water entry problem we assume the fluid is incompressible and inviscid panciroli and porfiri 2013 shams et al 2015 jalalisendi et al 2015 based on the obtained velocity field the pressure gradient can be indirectly estimated from the instantaneous velocity vector u by solving the incompressible navier stokes equation 1 p ρ d u d t υ 2 u where p is the pressure ρ is the fluid density υ is the kinematic viscosity and d d t is the material derivative which can be determined in different approaches van oudheusden 2013 due to the main characteristics of free surface impact flow i e the inviscid and irrotational flow the material acceleration is evaluated by the lagrangian approach tracing fluid particles which is given by 2 d u d t lim δ x 0 δ t 0 u x δ x t δ t u x t δ t where δ x is the displacement of the particle in time δ t the fluid particle trajectory of the flow field is reconstructedthrough a pseudo lagrangian approach de kat and van oudheusden 2012 the trajectory of pseudo particles in fixed grid points of piv analysis are obtained by taylor s formula therefore the material acceleration is estimated using an iterative second order pseudo particle path given by 3 x p k t τ x u x t τ 1 2 d u d t k x t τ 2 4 d u d t k 1 x t u x p k t t t t u x p k t t t t 2 t where the superscript k is the number of iterations x p is the pseudo particle location t is the time separation between consecutive velocity fields and the τ is the relative time at time instance t this explicit expression requires typically two iterations to acquire the material acceleration with sufficient accuracy de kat and van oudheusden 2012 consequently the instantaneous pressure gradient can be determined using the formulation in eq 1 the final step of pressure reconstruction is performing the integration of the pressure gradient with a custom integration scheme due to the motion of the free surface and the bow boundary especially the air pocket it is hardly to accurately determine the boundary condition the neumann and dirichlet boundary conditions which plays a key role in the integration of the poisson equation gurka et al 1999 van oudheusden 2013 thus based on the direct integration of the pressure gradient in the eq 1 the pressure field is calculated utilizing the spatial eroding scheme panciroli and porfiri 2013 jalalisendi et al 2017 fig 4 clearly evidences the principle of the pressure integration scheme the hydrodynamic pressure at the point a of the free surface boundary is assumed to be zero accordingly the pressure on the fluid domain boundary ab and bc are calculated using a simple forward integration for the pressure in the domain it is solved through the spatial eroding scheme 4 experimental results and discussion 4 1 slamming motion analysis and repeatability of the drop tests in order to present the slamming dynamics and ascertain the repeatability of the drop tests we compare the results of three repeated tests at different initial velocity fig 5 shows the results of the direct acceleration test during water entry for the initial velocity of 0 990 and 3 130 m s we provide the time trace results of the first 90 and 38 ms during slamming fig 5 indicates good agreements between the repetitions of the acceleration measurements as evidenced in fig 5 when the initial velocity is small at 0 990 m s the acceleration during the entire slamming process is not high and the change is gentle the maximum value is about 12 m s 2 at the beginning of the slamming there is a negative acceleration indicating that the bow has a tendency to accelerate fall and then decelerate labeled a however when the initial velocity is high at 3 130 m s the acceleration has a dramatic change at the beginning the convex zone of the bow section slams into water at a high velocity and the initial impact occurs with a moderate acceleration later the water jet separates from the concave zone that causes a decrease of the acceleration finally the separated water flow interacts with the bow section again at the flare zone which causes the severe secondary impact accompanied with the large acceleration labeled b the peak value of acceleration is about 63 m s 2 the entry depth of the bow is shown in fig 6 when the initial velocity is low at 0 990 m s the results of the three repetitions present good consistency however when the velocity is high at 3 130 m s the consistency is discounted which may be caused by the instability of the movement at a high speed fig 7 reports the velocity of the bow section it is consistent with the evolution of the acceleration on the one hand the low initial velocity of the bow section first increases at the beginning and then decreases slowly on the other hand the high initial velocity increases slowly as well and rapid decline subsequently caused by the secondary impact to quantify the repeatability and the uncertainty of the same experimental condition panciroli et al 2015 we calculate the average initial velocity v a v e the standard deviation σ v and the maximum error ε m a x between the repetitions that are given by 5 v a v e 1 n i 1 n v i 6 σ v 1 n 1 i 1 n v i v a v e 2 7 ε max max 1 n i 1 n ξ m t i ξ k t i ξ m t i m k 1 2 1 3 2 3 where n is equal to 3 that is the number of trials n is the number of samples t i is the sampling time and the superscript m and k represent the specific trial as reported in table 1 the average initial velocities obtained by the experiments are 0 956 and 2 967 m s indicating that the influence of friction and air resistance during the slamming are negligible the maximum error between the repetitions is always less than 7 which implies a good stability of the experiments 4 2 analysis of velocity field the transient flow field during the bow water entry was accurately resolved by the high speed tr piv as shown in fig 8 when the secondary impact has not occurred the instantaneous flow information of the entry depth ξ gradually increasing from 16 mm to 48 mm which is the initial impact stage is given at the beginning fig 8 a b the velocity distribution with the low initial velocity 0 990 m s is bipolar indicating the maximum velocity appears at the bow bottom and the top of the pile up this flow characteristic is similar to that at the high initial velocity the bow section continues to fall see fig 8 c d at the low initial velocity the velocity at the bottom of the bow is still large while the velocity at the top of pile up is significantly reduced because of the induction by the concave zone the pile up region cannot directly obtain kinetic energy from the bow consequently the further outward development of the pile up is suppressed and it gradually flows to the concave zone forming a low speed reflux however at the high initial velocity there is a flow separation at the junction of the convex and concave surface and the water jet detaches from the bow section maintaining the original outward and upward trend this discrepancy is due to the different velocity in the pile up region the flow velocity in this region is about 0 3 m s and 1 4 m s respectively with the different initial velocities when the entry depth is 32 mm as the further falling of the bow section see fig 8 e the flare zone starts to interact with the pile up region and its downward movement presses the contiguous liquid causing the upper region of the pile up to move upward along the bow flare surface with increasing velocity simultaneously the lower region of the pile up moves downward along the bow concave surface and merges with the upward flow from the bottom which generate a saddle point near the concave zone the velocity is close to zero labeled red dotted line in fig 8 e in addition see fig 8 f the top of the water jet initially contacts the flare surface that results the air between the separated jet and the concave zone is captured forming an apparent closed air pocket fig 9 sequentially gives the transient flow field of the entry depth increasing from 64 mm to 96 mm which is the stage of the secondary impact and gradually approaches the end of the bow water entry at the low initial velocity see fig 9 a c and e the bow flare continues to interact with the liquid and the velocity of the pile up region keeps increasing moreover the downward flow near the concave zone is induced by the shear effect of the no slip wall which promotes the generation of a strong shear layer with a high velocity gradient labeled red dotted line affected by the thickening of the shear layer the lateral position of the previously formed saddle point expands outward and its longitudinal position is stable at the junction of the convex and concave zone of the bow section at the high initial velocity see fig 9 b d and f the pile up region is pushed down by the bow flare resulting in the formation of a saddle point as well located at the top of the air pocket in addition the air pocket moves downwards under the entrainment of the bow and the surrounding liquid the position is stable near the concave zone meanwhile the shape is squeezed by the downward flow at the saddle point and the elliptical air pocket gradually develops into a circle fig 10 shows the fluid domain boundaries at different entry depth and the corresponding velocity distributions of the bow boundary with the initial velocity 0 990 m s in order to present a clear display the bow model is traced in the lagrangian frame and the coordinate origin is fixed at the bow bottom in general a higher velocity appears at the bottom of the bow however the velocity gradually decreases monotonously upwards along the bow boundary until the concave area in the concave zone the velocity at the boundary are always on the rise in accordance with the result of fig 9 which is very similar to the flow characteristics of a no slip plate flow subsequently we put the attention on the flare zone the flared profile constantly presses the fluid causing the velocity to keep climbing in addition it is worth noting that there is an evident speed drop close to the deck side line about 0 085 m at y direction due to the sudden disappearance of flare constraint when the initial velocity is 3 130 m s the fluid domain boundaries and the corresponding velocity distributions of the left boundaries are shown in fig 11 note that the velocity given in fig 11 is merely located on the left side boundary of the liquid domain instead of the bow boundary because of the existence of a closed air pocket by comparison with fig 10 there are significant similarities between the velocity profiles at the high initial velocity and that at the low initial velocity except for the velocity around the air pocket when the air pocket is closed i e the entry depth is larger than 64 mm the velocity around the air pocket appear a bottom up descending tendency and it reaches the minimum at the top of the air pocket further the minimum velocity is always in decline with the increment of the entry depth furthermore the distribution of velocity components u and v are provided in fig 12 when the severe secondary impact occurs i e the entry depth is 64 mm in this stage see fig 12 a and b the bow flare squeezes out the pile up region that flows upwards so that it has a high velocity in the x direction and there is a high density of the contour lines indicating a massive velocity gradient for the velocity component v as shown in fig 12 c and d the bow flare promotes the flow separation the liquid near the top of the air pocket flows downward and the liquid at the top of the pile up flows upward the contour lines here have an obvious and high density as well according to eq 1 and 4 it can be inferred that the slamming pressure at the bow flare would be enormous which will be discussed in the next subsection 4 3 reconstructed pressure field and hydrodynamic loading in the light of the pressure reconstruction method proposed in section 3 the instantaneous pressure information during the water entry is evaluated based on the tr piv results fig 13 displays the indirectly measured pressure field for the 5 cm falling height at several entry depth during the slamming where the pressure coefficient c p is normalized as 2 p ρ ξ 2 therein the left side of subfigures is the pressure curve of the liquid boundary and the right side is the pressure contour superimposed with the bow profile as sketched in fig 13 a the peak pressure appears at the bow bottom and rapidly decreases upwards along the wall surface meeting a minimum in the pile up region with the development of slamming see fig 13 b the peak pressure is still at the bottom however the pressure in the low speed reflux region near the convex zone is negative when the pile up region touches the bow flare see fig 13 c it engenders a tremendous change a sharp increase of the pressure in this region causing the previous low pressure area to shrink immediately with the full development of secondary impact the pressure near the flare have a robust growth illustrated in fig 13 d generating the peak pressure value throughout the whole slamming process when the deck side line is immersed in the pile up region see fig 13 e a large area of low pressure is displayed the peak pressure has a reduction little by little it is interesting that the peak pressure is not located in the pile up region which is quite different from the pressure distribution of the wedge water entry tveitnes et al 2008 nila et al 2013 panciroli and porfiri 2013 but it still appears in the region close to the flare besides the impact pressure at the bottom is also relatively large at the epilogue of the slamming the peak pressure is further declined it is worth noting that there is a low pressure region in the strong shear layer near the concave surface and in the area close to the deck side line mainly resulted from the increase of local velocity moreover the global peak pressure appears in the flow field above the saddle point instead of the bow boundary referring to the piv results in fig 9 which is caused by the local high velocity gradient the same phenomenon is observed at the high initial velocity see fig 15 to further investigate the actual slamming pressure during the water entry fig 14 reports the hydrodynamic pressure of the liquid boundary close to the bow model for the 5 cm drop height the x axis is the height of the bow model the bottom is set at zero point the y axis represents the actual hydrodynamic pressure the thick black line is the bow boundary rotated to horizontal in order to facilitate the data dispalying before the secondary impact the peak pressure is always located at the bottom with a declined tendency after that there has been a surge of the pressure in the flare about 0 06 0 08 m at x direction and it exceeds the bottom pressure to turn into the global peak value about 1200 pa the c p is about 1 7 which maintains the maximum during the remaining water entry process in addition when the entry depth is 80 and 96 mm the pile up region crosses the deck side line about 0 085 m at x direction the pressure first drops to the minimum and then gradually rises in the water jet in the bow water entry problem the effect of secondary impact due to flow separation at high initial velocity is the top priority fig 15 shows the indirectly measured pressure field for the initial velocity 3 130 m s compared with the reconstruction result at the low initial velocity reported in fig 13 the pressure distributions are quite similar in the preliminary stage of slamming as shown in fig 15 a c the peak pressure is stable at the bottom and negative pressure appears near the convex zone afterwards right following the interaction between the separated flow and the bow flare i e the appearance of secondary impact see fig 15 d dramatic slamming pressure is generated instantaneously at the flare which is reasonably foreseen relied on the massive velocity gradient in fig 12 attentively in the high pressure distribution the peak value is neither at the top of the pile up region nor the top of the closed air pocket instead at the critical point of the upward and downward flow as the passage of the severest secondary impact see fig 15 e f a significant pressure drop at the flare is recognized note that the pressure around the air pocket is unstable the pressure fluctuation and the higher pressure above the air pocket imply the dynamic evolution of the shape fig 16 reports the hydrodynamic pressure of the liquid boundary close to the bow model for the 50 cm falling height except for the pressure of the air pocket boundary the pressure distribution is roughly consistent with the result at the low initial velocity it is particularly outstanding that the peak pressure arrives about 6600 pa at the entry depth 64 mm the c p is about 1 7 as well after the secondary impact occurred the pressure close to the flare continuously keep the global maximum which signifies the structural strength of bow flare should be extra cautious in the ship design 5 conclusions in this paper the dynamic evolution of flow structure and pressure distribution of water entry of a bulbous bow was investigated experimentally with emphasis on the secondary impact effect compared with the bow model studied by aarsnes 1996 the arbitrary bow in this study that is based on the 18 5 station line of the kcs has a typical bulbous bow which can be clearly divided into convex zone concave zone and flare zone high frequency tr piv was used to capture the transient flow information during the bow slamming subsequently according to the incompressible n s equation in the lagrangian framework a pressure reconstruction method was proposed to indirectly measure the slamming pressure the main conclusions are as follows 1 for the slamming dynamics the results of acceleration entry depth and velocity between the three drop tests are in good agreement implying the high repeatability of the experimental setup and the severe secondary impact is accompanied with a large acceleration at the high initial velocity 2 at the low initial velocity 0 990 m s the development of the pile up region is limited by the small kinetic energy of the bow forming a low speed reflux at the concave zone it generates a saddle point moreover the downward flow near the concave zone is induced by the shear effect of the no slip wall which promotes the generation of a strong shear layer with a high velocity gradient 3 at the high initial velocity 3 130 m s there is a flow separation at the junction of the convex and concave surface and the water jet detaches from the bow section while the top of the water jet initially contacts the flare surface the secondary impact occurs an apparent closed air pocket is formed the pile up region is pushed down by the bow flare resulting in a saddle point as well located at the top of the air pocket meanwhile the shape of air pocket is squeezed and the elliptical air pocket gradually develops into a circle 4 whether the initial velocity is low or high as the interaction between the pile up region and the bow flare dramatic slamming pressure is generated instantaneously it is interesting that in the high pressure distribution the peak value is neither at the top of the pile up region nor the top of the closed air pocket instead at the critical point of the upward and downward flow furthermore the pressure close to the flare continuously keep the global maximum credit authorship contribution statement wenxuan she performed the experiments data analysis writing original draft guangli zhou conceptualization supervision project administration chunyu guo supervision funding acquisition writing review editing tiecheng wu data curation acquisition kewei song data acquisition validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national science foundation of china grant nos 5170090227 52071101 and the natural science foundation of heilongjiang province of china grant nos e2018026 in addition the authors would like to appreciate the editor in chief and the reviewers for constructive comments improving the paper significantly appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j oceaneng 2021 108977 appendix a supplementary data the following is the supplementary material related to this article video s1 the bow water entry falling from 5 cm without air pocket video s2 the bow water entry falling from 50 cm with air pocket 
20813,the objective of this work is to experimentally investigate the dynamic evolution of flow structure and pressure distribution on the water entry of a bulbous bow we focus on the water entry of an arbitrary bow based on the 18 5 station line of the kriso container ship with a typical bulbous bow time resolved particle image velocimetry tr piv is utilized to capture the transient flow information during the bow slamming the instantaneous pressure is estimated by solving the incompressible navier stokes equation using the lagrangian approach our findings demonstrate the formation and migration of a saddle point the generation of a strong shear layer near the concave zone at a low initial velocity and the deformation of an air pocket at a high initial velocity furthermore we offer insight into the reconstructed pressure field over the entire duration of the slamming especially the dramatic slamming pressure during the secondary impact it is interesting that the peak value locates on the critical point of the upward and downward flow caused by the pressing of the bow flare in addition the pressure close to the flare continuously keeps the global maximum keywords tr piv water entry bulbous bow secondary impact instantaneous pressure 1 introduction slamming research near the free surface has been investigated for many decades in that it is very important in the design of naval and aeronautical structures hughes et al 2013 truscott et al 2014 the key of slamming problems is how to accurately predict the hydrodynamic loading von karman 1929 proposed an analytical solution that can predict the impact pressure of a flat wedge during water entry considered as a seminal study subsequently taking into account the water pile up and the added mass considerable studies was dedicated to more precise solution dobrovol skaya 1969 wu 1998 mei et al 1999 scolan and korobkin 2001 in addition there are many works based on numerical schemes zhao and faltinsen 1993 xu et al 2008 and experimental studies tveitnes et al 2008 panciroli et al 2015 kim et al 2019 in general when focusing on water entry problems researchers usually choose regular objects as their study models such as wedges tveitnes et al 2008 wu et al 2004 russo et al 2018 cylinders lin and shieh 1997 van nuffel et al 2014 and spheres abraham et al 2014 however in naval engineering the slamming phenomenon frequently occurs in the ship stem stern with irregular shapes zong et al 2020 xie et al 2020a due to the dramatic change of surface curvature the slamming would induce complex gas liquid flow and fluid structure interaction during the water entry abrate 2011 therefore it is a technique challenge to accurately predict the hydrodynamic loading of irregular geometries the hydrodynamic loading of bow flare sections has been discussed by some researchers aarsnes 1996 performed experiments of a bow section in a free fall motion and pointed out that the secondary impact was caused by the slamming of separated flow sun and faltinsen 2009 applied a boundary element method to study the two dimensional water entry of a bow flare section wang and soares 2016 discussed ship motions slamming occurrence probability and slamming loads on the bow in irregular waves later kim et al 2019 performed experimental investigations on bow flare slamming loads which considered regular and irregular waves recently xie et al 2018 2020b presented detailed and valuable studies on the water entry of a 3d bow flare model and 2d bulbous bow sections despite the expanding experimental studies pressure gauges generally have priority to perform the direct measurement of hydrodynamic pressure tveitnes et al 2008 kim et al 2019 aarsnes 1996 xie et al 2018 while this methodology can only provide pressure information at a single point for a pressure gauge if more pressure distribution is needed it is practically cumbersome to install numerous pressure gauges with rapid advancements in high speed cameras and lasers it is available to indirectly measure the pressure fluctuation based on flow governing equations which need temporal velocity as the input that can be diagnosed by time resolved particle image velocimetry tr piv in contrast to conventional measurements this technique can non intrusively provide full field pressure and have the great potential for improvement van oudheusden 2013 multiple methods have been proposed for deriving the pressure from piv measurements gurka et al 1999 obtained the time averaged pressure of a pipe and jet flow by solving the poisson equation liu and katz 2006 innovatively presented an omni directional virtual integration scheme which can effectively reduce the cumulative errors along the direction of integration later de kat and van oudheusden 2012 systematically discussed the performance of the eulerian and the lagrangian approaches the art of methods to calculate the pressure based on piv has attracted the interest of plenty of researchers over the years van oudheusden 2013 wang et al 2016 2017 ragni et al 2019 nevertheless the optimal methodology has not yet been determined for various flow scenarios there are some contradicting results that solving the poisson equation may have more accurate results murai et al 2007 but the second order derivatives of the velocity may cause substantial uncertainties de kat and van oudheusden 2012 on the other hand an eulerian approach may lead to better agreement with the experiments jakobsen et al 1997 but a lagrangian approach may be less sensitive to measurement noise ghaemi et al 2012 for water entry problem several studies have verified the accuracy of indirect estimating slamming loads from piv measurement nila et al 2013 panciroli and porfiri 2013 shams et al 2015 jalalisendi et al 2015 2017 russo et al 2018 nila et al 2013 and shams et al 2015 estimated the slamming pressure of wedge section using a poisson based solver another method of slamming pressure prediction solving navier stokes equations was discussed by panciroli and porfiri 2013 jalalisendi et al 2015 2017 and russo et al 2018 they all dealt with the flow governing equations through the eulerian approach however the lagrangian approach was superior to the eulerian for dealing with advection motion such as plate flow and free surface impact flow de kat and van oudheusden 2012 although the early stages of water entry problem have been extensively investigated based on tr piv the kinematic and dynamic characterization of a bow flare slamming has not been reported in literature in this study although simplistic we perform a delicate experimental analysis of the secondary impact effect for an bulbous bow which may refer to this work as a prelude to describe the behaviors of hydrodynamic loads of a full scale ship bow during the experiments the time tracing kinematic information of the bow section i e acceleration displacement and velocity were monitored at two different drop heights which were respectively 5 and 50 cm indicating the absence and presence of an air pocket correspondingly subsequently piv results provided the instantaneous flow patterns during the bow slamming furthermore according to the incompressible navier stokes equation the slamming pressure was reconstructed based on piv data in the lagrange framework our primary interest the characteristic of secondary impact was analyzed in detail 2 experimental apparatus and methods 2 1 experimental setup referring to the previous work and opinions panciroli and porfiri 2013 shams et al 2015 jalalisendi et al 2015 the experimental setup is made of a custom built aluminum frame and a transparent tank for the bow slamming which allows free fall impact at a maximum drop height of 800 mm schematically drawn in fig 1 the water tank is 800 mm long 500 mm large and 500 mm deep then the tank is filled with water to 300 mm depth which could ignore the bottom wall effect jalalisendi et al 2017 in addition two long aluminum rails are rigidly mounted in the center of the frame for ensuring the vertical motion powered by a continuous 12 v supply an electric magnet is mounted in the middle of the sledge and used to control the free fall of the model in this work an arbitrary bow section are studied we choose the 18 5 station line of the kriso container ship kcs see fig 2 a which has a typical bulbous bow feature stretching the station line in spanwise the two dimensional bow model was made with a 1 200 scale ratio due to the limited measurement domain of the tr piv system it is obviously seen from fig 2 b that the bow section studied by aarsnes 1996 shows a straight shaped bulb at the bottom whereas the bow section of kcs exists a convex shaped bulb below the concave part the bow is divided into three zones convex zone concave zone and flare zone as shown in fig 2 c the model is fabricated of polylactic acid pla plastic manufactured in a hori z500 3d printing machine the model surface is delicately polished and smoothed matte black treatment is later performed to minimize laser sheet reflection in piv measurement the model is 125 1 mm long 117 5 mm high and 160 mm deep and it is connected to a sledge the mass of the whole falling body is 0 57 kg note that the mass does not follow the scale ratio because of the material properties and the aluminum sledge furthermore several marks are depicted on the front side of the model for monitoring the motion in slamming experiments are performed on the arbitrary bow section falling from 5 and 50 cm the initial velocities v 0 are 0 990 and 3 130 m s respectively indicating the absence and presence of an air pocket during water entry the reynolds number r e of the experimental conditions is approximately on the order of 1 0 6 the froude number f r is on the order of 1 and the gravitational acceleration g is 9 8 m s 2 viscosity effect is neglected in the study nila et al 2013 panciroli and porfiri 2013 and we wait for sufficient time 10 min to calm the water in between slamming experiments 2 2 measurement system a time resolved planar piv system is utilized to measure two dimensional flow velocity at the middle span of the falling bow where the three dimensional phenomena is negligible jalalisendi et al 2015 xie et al 2020a the tr piv system consists of a 10 w nd yag ray power laser source and a photron fastcam mini ux100 high speed cmos camera the spatial resolution of the camera is adjusted to 1280 1000 pixels by means of dantec studio v 6 2 and the acquisition frequency is 5 khz corresponding to a 0 2 ms time step a flat target with grid size of 10 10 mm 2 is used for the piv calibration with the field of view of 200 159 mm 2 corresponding to 7 63 pixels mm polymide seeding particles with a density of 1 03 g mm 3 and a mean diameter of 20 μ m are used as tracer particles the laser sheet is approximately 2 mm thick the piv measurement of slamming is ceased when the bow bottom arrives the bottom boundary of the camera view the recording times during each trial for the two drop heights of 5 and 50 cm are respectively 90 and 38 ms corresponding to 450 and 180 image frames besides the piv measurement the motion information is monitored as well including the entry depth and the bow velocity via high speed imaging and the acceleration via an accelerometer it should be noted that the motion measurement is independent of the piv test we utilize the high speed camera in the piv system to track the marks on the front side of the model carried out in laboratory illumination the spatial and temporal resolution of the camera remain unchanged meanwhile an accelerometer type cf0320 500 with a range of 500 g supported by dh5902 data acquisition system is installed in the middle of the sledge to measure the slamming acceleration at a data acquisition frequency of 4 khz for the two independent conditions with drop heights of 5 and 50 cm we performed three times piv measurements and three times motion information measurements to determine the repeatability of the experiments during the drop tests the entry depth ξ and the bow velocity ξ t are calculated from the average of the vertical transition and speed of the marks these marks on the front side of the bow section are tracked and analyzed by the software photon fastcam analysis when the bow bottom initially touches the free surface the time t is set to zero and the ξ t is zero as well 3 piv images and data analysis 3 1 piv analysis fig 3 displays a representative piv image with air pocket which caused by the high initial velocity of the bow section as the bow continuously penetrates the free surface the water piles up on the flare of the bow forming the water jet and a clear air pocket appears in the concave zone only half of the slamming domain is focused due to the symmetry of flow when executing cross correlation analysis of piv images it is necessary to improve the accuracy of the piv results at the fluid domain boundary due to the field of camera view includes water air and the arbitrary bow section see fig 3 a therefore moving masks the image pixel value is zero are applied to remove unnecessary information of the piv images the fidelity of the piv results in the vicinity of the bow and the free surface could be enhanced nila et al 2013 for the first piv measurement the masks are generated in batch process using the dantec studio v 6 2 function phase boundary detection and pre processing algorithms which are composed of gaussian smooth intensity normalization and wiener denoise filter specifically the processed image is present in fig 3 b further the same masks are used for the other two repeated piv measurements after acquiring the region of interest in the piv images an available open source software in matlab pivlab thielicke and stamhuis 2014 is used for post processing the sequence of image a fast fourier transform cross correlation algorithm and a multi grid interrogation scheme are adopted in the piv analysis it consists of decreasing interrogation windows of 64 64 32 32 and 16 16 pixels with 50 overlap a 2 3 point gaussian fit is utilized for sub pixel peak fitting and a multidimensional spline smoothing algorithm garcia 2010 is adopted to reduce the noise of piv measurements eventually the valid vectors across the slamming process are always larger than 96 3 2 piv based pressure reconstruction and motion analysis after obtained the velocity field all piv results are transferred to matlab workspace a custom made code is developed for reconstructing the impact pressure it is divided into two steps firstly the pressure gradient is calculated through the navier stokes equation secondly the pressure is extracted by integrating the pressure gradient for water entry problem we assume the fluid is incompressible and inviscid panciroli and porfiri 2013 shams et al 2015 jalalisendi et al 2015 based on the obtained velocity field the pressure gradient can be indirectly estimated from the instantaneous velocity vector u by solving the incompressible navier stokes equation 1 p ρ d u d t υ 2 u where p is the pressure ρ is the fluid density υ is the kinematic viscosity and d d t is the material derivative which can be determined in different approaches van oudheusden 2013 due to the main characteristics of free surface impact flow i e the inviscid and irrotational flow the material acceleration is evaluated by the lagrangian approach tracing fluid particles which is given by 2 d u d t lim δ x 0 δ t 0 u x δ x t δ t u x t δ t where δ x is the displacement of the particle in time δ t the fluid particle trajectory of the flow field is reconstructedthrough a pseudo lagrangian approach de kat and van oudheusden 2012 the trajectory of pseudo particles in fixed grid points of piv analysis are obtained by taylor s formula therefore the material acceleration is estimated using an iterative second order pseudo particle path given by 3 x p k t τ x u x t τ 1 2 d u d t k x t τ 2 4 d u d t k 1 x t u x p k t t t t u x p k t t t t 2 t where the superscript k is the number of iterations x p is the pseudo particle location t is the time separation between consecutive velocity fields and the τ is the relative time at time instance t this explicit expression requires typically two iterations to acquire the material acceleration with sufficient accuracy de kat and van oudheusden 2012 consequently the instantaneous pressure gradient can be determined using the formulation in eq 1 the final step of pressure reconstruction is performing the integration of the pressure gradient with a custom integration scheme due to the motion of the free surface and the bow boundary especially the air pocket it is hardly to accurately determine the boundary condition the neumann and dirichlet boundary conditions which plays a key role in the integration of the poisson equation gurka et al 1999 van oudheusden 2013 thus based on the direct integration of the pressure gradient in the eq 1 the pressure field is calculated utilizing the spatial eroding scheme panciroli and porfiri 2013 jalalisendi et al 2017 fig 4 clearly evidences the principle of the pressure integration scheme the hydrodynamic pressure at the point a of the free surface boundary is assumed to be zero accordingly the pressure on the fluid domain boundary ab and bc are calculated using a simple forward integration for the pressure in the domain it is solved through the spatial eroding scheme 4 experimental results and discussion 4 1 slamming motion analysis and repeatability of the drop tests in order to present the slamming dynamics and ascertain the repeatability of the drop tests we compare the results of three repeated tests at different initial velocity fig 5 shows the results of the direct acceleration test during water entry for the initial velocity of 0 990 and 3 130 m s we provide the time trace results of the first 90 and 38 ms during slamming fig 5 indicates good agreements between the repetitions of the acceleration measurements as evidenced in fig 5 when the initial velocity is small at 0 990 m s the acceleration during the entire slamming process is not high and the change is gentle the maximum value is about 12 m s 2 at the beginning of the slamming there is a negative acceleration indicating that the bow has a tendency to accelerate fall and then decelerate labeled a however when the initial velocity is high at 3 130 m s the acceleration has a dramatic change at the beginning the convex zone of the bow section slams into water at a high velocity and the initial impact occurs with a moderate acceleration later the water jet separates from the concave zone that causes a decrease of the acceleration finally the separated water flow interacts with the bow section again at the flare zone which causes the severe secondary impact accompanied with the large acceleration labeled b the peak value of acceleration is about 63 m s 2 the entry depth of the bow is shown in fig 6 when the initial velocity is low at 0 990 m s the results of the three repetitions present good consistency however when the velocity is high at 3 130 m s the consistency is discounted which may be caused by the instability of the movement at a high speed fig 7 reports the velocity of the bow section it is consistent with the evolution of the acceleration on the one hand the low initial velocity of the bow section first increases at the beginning and then decreases slowly on the other hand the high initial velocity increases slowly as well and rapid decline subsequently caused by the secondary impact to quantify the repeatability and the uncertainty of the same experimental condition panciroli et al 2015 we calculate the average initial velocity v a v e the standard deviation σ v and the maximum error ε m a x between the repetitions that are given by 5 v a v e 1 n i 1 n v i 6 σ v 1 n 1 i 1 n v i v a v e 2 7 ε max max 1 n i 1 n ξ m t i ξ k t i ξ m t i m k 1 2 1 3 2 3 where n is equal to 3 that is the number of trials n is the number of samples t i is the sampling time and the superscript m and k represent the specific trial as reported in table 1 the average initial velocities obtained by the experiments are 0 956 and 2 967 m s indicating that the influence of friction and air resistance during the slamming are negligible the maximum error between the repetitions is always less than 7 which implies a good stability of the experiments 4 2 analysis of velocity field the transient flow field during the bow water entry was accurately resolved by the high speed tr piv as shown in fig 8 when the secondary impact has not occurred the instantaneous flow information of the entry depth ξ gradually increasing from 16 mm to 48 mm which is the initial impact stage is given at the beginning fig 8 a b the velocity distribution with the low initial velocity 0 990 m s is bipolar indicating the maximum velocity appears at the bow bottom and the top of the pile up this flow characteristic is similar to that at the high initial velocity the bow section continues to fall see fig 8 c d at the low initial velocity the velocity at the bottom of the bow is still large while the velocity at the top of pile up is significantly reduced because of the induction by the concave zone the pile up region cannot directly obtain kinetic energy from the bow consequently the further outward development of the pile up is suppressed and it gradually flows to the concave zone forming a low speed reflux however at the high initial velocity there is a flow separation at the junction of the convex and concave surface and the water jet detaches from the bow section maintaining the original outward and upward trend this discrepancy is due to the different velocity in the pile up region the flow velocity in this region is about 0 3 m s and 1 4 m s respectively with the different initial velocities when the entry depth is 32 mm as the further falling of the bow section see fig 8 e the flare zone starts to interact with the pile up region and its downward movement presses the contiguous liquid causing the upper region of the pile up to move upward along the bow flare surface with increasing velocity simultaneously the lower region of the pile up moves downward along the bow concave surface and merges with the upward flow from the bottom which generate a saddle point near the concave zone the velocity is close to zero labeled red dotted line in fig 8 e in addition see fig 8 f the top of the water jet initially contacts the flare surface that results the air between the separated jet and the concave zone is captured forming an apparent closed air pocket fig 9 sequentially gives the transient flow field of the entry depth increasing from 64 mm to 96 mm which is the stage of the secondary impact and gradually approaches the end of the bow water entry at the low initial velocity see fig 9 a c and e the bow flare continues to interact with the liquid and the velocity of the pile up region keeps increasing moreover the downward flow near the concave zone is induced by the shear effect of the no slip wall which promotes the generation of a strong shear layer with a high velocity gradient labeled red dotted line affected by the thickening of the shear layer the lateral position of the previously formed saddle point expands outward and its longitudinal position is stable at the junction of the convex and concave zone of the bow section at the high initial velocity see fig 9 b d and f the pile up region is pushed down by the bow flare resulting in the formation of a saddle point as well located at the top of the air pocket in addition the air pocket moves downwards under the entrainment of the bow and the surrounding liquid the position is stable near the concave zone meanwhile the shape is squeezed by the downward flow at the saddle point and the elliptical air pocket gradually develops into a circle fig 10 shows the fluid domain boundaries at different entry depth and the corresponding velocity distributions of the bow boundary with the initial velocity 0 990 m s in order to present a clear display the bow model is traced in the lagrangian frame and the coordinate origin is fixed at the bow bottom in general a higher velocity appears at the bottom of the bow however the velocity gradually decreases monotonously upwards along the bow boundary until the concave area in the concave zone the velocity at the boundary are always on the rise in accordance with the result of fig 9 which is very similar to the flow characteristics of a no slip plate flow subsequently we put the attention on the flare zone the flared profile constantly presses the fluid causing the velocity to keep climbing in addition it is worth noting that there is an evident speed drop close to the deck side line about 0 085 m at y direction due to the sudden disappearance of flare constraint when the initial velocity is 3 130 m s the fluid domain boundaries and the corresponding velocity distributions of the left boundaries are shown in fig 11 note that the velocity given in fig 11 is merely located on the left side boundary of the liquid domain instead of the bow boundary because of the existence of a closed air pocket by comparison with fig 10 there are significant similarities between the velocity profiles at the high initial velocity and that at the low initial velocity except for the velocity around the air pocket when the air pocket is closed i e the entry depth is larger than 64 mm the velocity around the air pocket appear a bottom up descending tendency and it reaches the minimum at the top of the air pocket further the minimum velocity is always in decline with the increment of the entry depth furthermore the distribution of velocity components u and v are provided in fig 12 when the severe secondary impact occurs i e the entry depth is 64 mm in this stage see fig 12 a and b the bow flare squeezes out the pile up region that flows upwards so that it has a high velocity in the x direction and there is a high density of the contour lines indicating a massive velocity gradient for the velocity component v as shown in fig 12 c and d the bow flare promotes the flow separation the liquid near the top of the air pocket flows downward and the liquid at the top of the pile up flows upward the contour lines here have an obvious and high density as well according to eq 1 and 4 it can be inferred that the slamming pressure at the bow flare would be enormous which will be discussed in the next subsection 4 3 reconstructed pressure field and hydrodynamic loading in the light of the pressure reconstruction method proposed in section 3 the instantaneous pressure information during the water entry is evaluated based on the tr piv results fig 13 displays the indirectly measured pressure field for the 5 cm falling height at several entry depth during the slamming where the pressure coefficient c p is normalized as 2 p ρ ξ 2 therein the left side of subfigures is the pressure curve of the liquid boundary and the right side is the pressure contour superimposed with the bow profile as sketched in fig 13 a the peak pressure appears at the bow bottom and rapidly decreases upwards along the wall surface meeting a minimum in the pile up region with the development of slamming see fig 13 b the peak pressure is still at the bottom however the pressure in the low speed reflux region near the convex zone is negative when the pile up region touches the bow flare see fig 13 c it engenders a tremendous change a sharp increase of the pressure in this region causing the previous low pressure area to shrink immediately with the full development of secondary impact the pressure near the flare have a robust growth illustrated in fig 13 d generating the peak pressure value throughout the whole slamming process when the deck side line is immersed in the pile up region see fig 13 e a large area of low pressure is displayed the peak pressure has a reduction little by little it is interesting that the peak pressure is not located in the pile up region which is quite different from the pressure distribution of the wedge water entry tveitnes et al 2008 nila et al 2013 panciroli and porfiri 2013 but it still appears in the region close to the flare besides the impact pressure at the bottom is also relatively large at the epilogue of the slamming the peak pressure is further declined it is worth noting that there is a low pressure region in the strong shear layer near the concave surface and in the area close to the deck side line mainly resulted from the increase of local velocity moreover the global peak pressure appears in the flow field above the saddle point instead of the bow boundary referring to the piv results in fig 9 which is caused by the local high velocity gradient the same phenomenon is observed at the high initial velocity see fig 15 to further investigate the actual slamming pressure during the water entry fig 14 reports the hydrodynamic pressure of the liquid boundary close to the bow model for the 5 cm drop height the x axis is the height of the bow model the bottom is set at zero point the y axis represents the actual hydrodynamic pressure the thick black line is the bow boundary rotated to horizontal in order to facilitate the data dispalying before the secondary impact the peak pressure is always located at the bottom with a declined tendency after that there has been a surge of the pressure in the flare about 0 06 0 08 m at x direction and it exceeds the bottom pressure to turn into the global peak value about 1200 pa the c p is about 1 7 which maintains the maximum during the remaining water entry process in addition when the entry depth is 80 and 96 mm the pile up region crosses the deck side line about 0 085 m at x direction the pressure first drops to the minimum and then gradually rises in the water jet in the bow water entry problem the effect of secondary impact due to flow separation at high initial velocity is the top priority fig 15 shows the indirectly measured pressure field for the initial velocity 3 130 m s compared with the reconstruction result at the low initial velocity reported in fig 13 the pressure distributions are quite similar in the preliminary stage of slamming as shown in fig 15 a c the peak pressure is stable at the bottom and negative pressure appears near the convex zone afterwards right following the interaction between the separated flow and the bow flare i e the appearance of secondary impact see fig 15 d dramatic slamming pressure is generated instantaneously at the flare which is reasonably foreseen relied on the massive velocity gradient in fig 12 attentively in the high pressure distribution the peak value is neither at the top of the pile up region nor the top of the closed air pocket instead at the critical point of the upward and downward flow as the passage of the severest secondary impact see fig 15 e f a significant pressure drop at the flare is recognized note that the pressure around the air pocket is unstable the pressure fluctuation and the higher pressure above the air pocket imply the dynamic evolution of the shape fig 16 reports the hydrodynamic pressure of the liquid boundary close to the bow model for the 50 cm falling height except for the pressure of the air pocket boundary the pressure distribution is roughly consistent with the result at the low initial velocity it is particularly outstanding that the peak pressure arrives about 6600 pa at the entry depth 64 mm the c p is about 1 7 as well after the secondary impact occurred the pressure close to the flare continuously keep the global maximum which signifies the structural strength of bow flare should be extra cautious in the ship design 5 conclusions in this paper the dynamic evolution of flow structure and pressure distribution of water entry of a bulbous bow was investigated experimentally with emphasis on the secondary impact effect compared with the bow model studied by aarsnes 1996 the arbitrary bow in this study that is based on the 18 5 station line of the kcs has a typical bulbous bow which can be clearly divided into convex zone concave zone and flare zone high frequency tr piv was used to capture the transient flow information during the bow slamming subsequently according to the incompressible n s equation in the lagrangian framework a pressure reconstruction method was proposed to indirectly measure the slamming pressure the main conclusions are as follows 1 for the slamming dynamics the results of acceleration entry depth and velocity between the three drop tests are in good agreement implying the high repeatability of the experimental setup and the severe secondary impact is accompanied with a large acceleration at the high initial velocity 2 at the low initial velocity 0 990 m s the development of the pile up region is limited by the small kinetic energy of the bow forming a low speed reflux at the concave zone it generates a saddle point moreover the downward flow near the concave zone is induced by the shear effect of the no slip wall which promotes the generation of a strong shear layer with a high velocity gradient 3 at the high initial velocity 3 130 m s there is a flow separation at the junction of the convex and concave surface and the water jet detaches from the bow section while the top of the water jet initially contacts the flare surface the secondary impact occurs an apparent closed air pocket is formed the pile up region is pushed down by the bow flare resulting in a saddle point as well located at the top of the air pocket meanwhile the shape of air pocket is squeezed and the elliptical air pocket gradually develops into a circle 4 whether the initial velocity is low or high as the interaction between the pile up region and the bow flare dramatic slamming pressure is generated instantaneously it is interesting that in the high pressure distribution the peak value is neither at the top of the pile up region nor the top of the closed air pocket instead at the critical point of the upward and downward flow furthermore the pressure close to the flare continuously keep the global maximum credit authorship contribution statement wenxuan she performed the experiments data analysis writing original draft guangli zhou conceptualization supervision project administration chunyu guo supervision funding acquisition writing review editing tiecheng wu data curation acquisition kewei song data acquisition validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national science foundation of china grant nos 5170090227 52071101 and the natural science foundation of heilongjiang province of china grant nos e2018026 in addition the authors would like to appreciate the editor in chief and the reviewers for constructive comments improving the paper significantly appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j oceaneng 2021 108977 appendix a supplementary data the following is the supplementary material related to this article video s1 the bow water entry falling from 5 cm without air pocket video s2 the bow water entry falling from 50 cm with air pocket 
20814,dams are an important part of a country s infrastructure after the dam breaks the collision force of the water column if severe enough would incur a great deal of destruction and damage and needs to be concerned specially in this work 3d dam break flows against various forms of the obstacle are numerically simulated by the smoothed particle hydrodynamics sph method in order to tackle boundaries of irregular or curved shapes involved in the obstacle both wall particles and dummy particles are adopted in sph in which dummy particles are arranged by a particle packing algorithm which allows the attainment of a regular particle distribution to validate the sph method 3d dam break flow against a vertical wall is first simulated and the sph results are compared with the experiment and those obtained by other numerical methods then we extend the method to 3d dam break flows against various forms of the obstacle a number of challenging numerical examples including 3d dam break flows against a right angled obstacle a sloping obstacle with the angle of inclination α 60 45 and 30 and an arc obstacle with the arc angle β 90 60 and 45 are simulated the time evolutions of the pressure on the obstacle surface are shown in details it is demonstrated that the proposed sph method can handle 3d large deformation flows with any complex boundaries accurately the arc obstacle with β 60 may be selected as one of the optimal forms of the obstacle for reducing the collision force of the fluid after the dam breaks the maximum pressure on this obstacle surface is less than 40 of a right angled obstacle keywords sph 3d dam break flow collision force complex boundaries large deformation 1 introduction dams are an important part of a country s infrastructure as they can provide flood protection water storage irrigation and generation of electricity although many efforts have gone into strengthening dams dam breaks often occur due to various factors such as flooding earthquakes and ice dam breaks are considered catastrophic events that can lead to many casualties property damage and environmental problems after the dam breaks the collision force of the water column if severe enough would incur a great deal of destruction and damage and thus needs to be concerned specially studies of dam break flow entail theoretical experimental and numerical investigations for the theoretical investigation dressler 1954 obtained the theoretical curves for the hydraulic dam break wave fraccarollo and capart 2002 examined sudden erosional flow initiated by the release of a dam break wave over a loose sediment bed peng and zhang 2013 presented a risk based theoretical framework of dynamic decision making for dam break emergency management hosseinpoor et al 2019 evaluated the applicability of dam break theory to analytically solve the flow profile of self consolidating concrete in a modified l box set up with regard to the experiments stansby et al 1998 undertook experiments to investigate dam break flows where a thin plate was withdrawn suddenly in a vertically upward direction hu and kashiwagi 2004 described a constrained interpolation profile cip based method on a fixed cartesian grid system to solve dam break flow and then compared the numerical results with those obtained from the experiment lobovský et al 2014 performed the experimental measurements for a dam break flow over a horizontal dry bed with the aim of providing insight into the dynamics of a dam break wave fent et al 2019 conducted experiments on dam break flows over a bed made of coarse sand and obtained the detailed velocity measurements in the clear water layer and the moving sediment layer in recent decades the numerical simulation technique has been an effective choice for measuring dam break flows because of the rapid development of computer technology although grid based numerical methods can be used to deal with dam break flows they require additional numerical technique such as volume of fluid vof marker and cell mac or level set to track the moving free surface in vof tracking of dynamical interface is accomplished by solving a transport equation for the volume fraction of the fluid while marker particles are specially employed in mac the level set method is used to locate the moving surface by utilizing an additional implicit level set function in 2002 brufau et al 2002 presented a cell centered finite volume method to model the shallow water flow in one and two dimensions kleefsman et al 2005 simulated 2d dam break flow using a vof based method and compared the results to the experimental measurements marsooli and wu 2014 proposed a 3d numerical model to study dam break flows over uneven beds the free surface was captured by vof and the advection equation was solved by the compressive interface capturing scheme for arbitrary meshes issakhov and imanberdiyeva 2019 applied vof to study the movement of the water surface when a dam is broken the mathematical model was based on the navier stokes equations and the large eddy simulation les mathematical model for turbulence was specifically used recently zhang and wan 2019 proposed a method that combined the moving particle semi implicit method and the finite element method to simulate 3d dam break flow over the last four decades there have also been a number of attempts to develop mesh free methods as alternatives to grid based numerical methods one of the most successful meshfree methods is smoothed particle hydrodynamics sph which was originally proposed by lucy 1977 and gingold and monaghan 1977 for astrophysical computations actually sph is a lagrangian particle method in which the fluid is discretized by a set of particles the particles can be moving according to the solutions of relevant governing equations when compared to grid based methods the sph method has the following advantages for simulating free surface flows liu and liu 2010 1 the free surface can be naturally modeled without the need of any form of explicit interface tracking 2 the advection and transport of the system can be solved very well because of its lagrangian and adaptive nature and 3 numerical procedure for complex problems is comparatively simple in 1994 monaghan 1994 applied sph for the first time to deal with free surface flows in recent years the sph method has been extended to various scientific and engineering problems including free surface flows xu et al 2014a xu 2016 wang et al 2019 yang et al 2020 lin et al 2019 fürstenau et al 2020 explosion liu et al 2003 2017 multi phase flows zhang et al 2019 rezavand et al 2020 ji et al 2020 meng et al 2020 injection molding xu and yu 2017 2019 heat transfer rook et al 2007 xiong et al 2019 ng et al 2020 abdoh et al 2020 and viscoelastic fluid flows xu et al 2012 2014b xu and ouyang 2013 xu and yu 2016 for sph simulations of dam break flow dalrymple and knio 2001 presented an sph approach to a numerical wave tank which was capable of studying several types of waves impinging on structures and walls shao and lo 2003 developed an incompressible sph method to simulate 2d non newtonian dam break flow crespo et al 2008 extended sph to simulate dam break flows over dry and wet beds and the obtained results match the experimental dam break profiles moulinec moulinec et al 2008 designed an efficient parallel sph algorithm and assessed the speeding up of the code by simulating 3d dam break flows yang et al 2016 developed a method that combined sph and element bending group modeling to simulate the impact of a 2d dam break flow on flexible structures sun et al 2015 used a multiphase sph method to study fluid structure dam break flow problems all the works mentioned above nicely show the advantage of sph over grid based numerical methods in simulating dam break flows however to the best of the authors knowledge there has not yet been any research that has used the mesh free particle methods and specifically the sph method to study the collision force of the fluid after the dam breaks as stated before after the dam breaks the collision force of the fluid need to be concerned specially because a large force would incur a great deal of destruction and damage thus it would be a good way to design some new forms of the obstacle at the downstream for decreasing the collision force of the fluid with the obstacle to solve dam break flows against various forms of the obstacle one major difficulty for sph is how to flexibly model boundaries of irregular or curved shapes involved in the obstacle in general sph formulations are valid for all interior particles but are not accurate for particles close to the solid boundary as the kernel function has been truncated by the solid boundary from this point of view the direct application of boundary conditions is problematic in sph at present several techniques e g repulsive force method monaghan and kajtar 2009 ghost particle method morris et al 1997 dummy particle method adami et al 2012 and multiple boundary tangent method yildiz et al 2009 shadloo et al 2011 have been proposed these techniques were able to model boundaries accurately nevertheless the procedure for modeling irregular or curved boundaries especially in three space dimensions is still awkward in this paper we develop a robust sph method which can tackle boundaries of irregular or curved shapes flexibly specifically we employ both wall particles and dummy particles to model the wall boundaries in which dummy particles are arranged by a particle packing algorithm which allows the attainment of a regular particle distribution we extend the method to 3d dam break flows against various forms of the obstacle with the aim of designing an optimal form for reducing the collision force of the fluid after the dam breaks a number of numerical examples including 3d dam break flows against a right angled obstacle a sloping obstacle with the angle of inclination α 60 45 and 30 and an arc obstacle with the arc angle β 90 60 and 45 are simulated the changes in the pressure on the obstacle surface as time passes are shown in detail the rest of this paper is organized as follows section 2 describes the mathematical model as well as the sph method implemented in section 3 the method is first validated by solving 3d dam break flow against a vertical wall and comparing the sph results with the available literature data then the method is extended to 3d dam break flows against various forms of the obstacle section 4 presents our conclusions and some final remarks 2 mathematical formulations 2 1 governing equations in a lagrangian frame the governing equations for the motion of an incompressible fluid flow are the conservation equations of mass and momentum 1 d ρ d t ρ u 2 d u d t 1 ρ p η ρ 2 u g where ρ is the density t is the time u is the velocity p is the pressure η is the dynamic viscosity and g is the acceleration of gravity 2 1 1 turbulent closure the turbulence closure is important for the simulation of dam breaking it plays a significant role in improving the accuracy of predicting the free surface near the solid wall or the obstacle it is acknowledged that the flow physics near the solid wall or the obstacle could be reproduced more satisfactorily with the usage of the turbulence closure park et al 2012 larocque et al 2013 therefore we adopt the turbulence model in the present work similar to the previous works xu 2016 park et al 2012 larocque et al 2013 in the les framework the mass and momentum equations of particle scale flow can be derived from the navier stokes equations by a spatial filter and are represented as shao and ji 2006 3 d ρ d t ρ u 4 d u d t 1 ρ p η ρ 2 u 1 ρ ρ r g where the hat refers to the filtered variables and r is the sub particle scale stress tensor that is modeled using an appropriate turbulent closure in this work the eddy viscosity assumption shao and ji 2006 arai et al 2013 boussinesq s hypothesis is adopted to model the sub particle scale stress tensor as 5 r 2 υ t s 1 3 i tr r where υ t is the turbulence eddy viscosity s is the mean rate of strain tensor i is the identity matrix and the symbol tr denotes the trace of matrix for the eddy viscosity υ t the model proposed by smagorinsky 1963 is used which has the form 6 υ t c s d x 2 2 s s where c s is the smagorinsky constant with the value 0 12 smagorinsky 1963 and δx is the initial particle spacing moreover it should be noted that the widely used log law distribution arai et al 2013 is adopted for the turbulence conditions near the solid wall since the turbulence eddy viscosity should reduce to zero in the vicinity of a solid wall 2 1 2 incompressibility constraint the most frequently used method of implementing the incompressibility constraint in sph is the usage of a weakly compressible formulation with weakly compressible sph formulation the governing equations are closed by a suitably chosen artificial equation of state p p ρ since the pressure is an explicit function of density the density gradient exerts an influence on the particle motion in sph one of the most common equations of state is written as monaghan 1994 7 p ρ ρ 0 c 0 2 γ ρ ρ 0 γ 1 where ρ 0 is the initial density of the fluid γ 7 is a constant and c 0 is the speed of sound to ensure that the flow physics of the pseudo compressible fluid are sufficiently close to those of a truly incompressible fluid the sound speed c 0 should be at least 10 times higher than the maximal fluid velocity 2 2 smoothed particle hydrodynamics 2 2 1 sph discretization in the sph method each particle represents a macroscopic volume of fluid each fluid particle a carries physical information such as mass m a density ρ a pressure p a velocity u a position r a and other physical quantities depending on the nature of fluid the mass remains unchanged during the simulations while the pressure density velocity position and other physical quantities are updated at each time step at present there are many different discretizations of governing equations in the sph context for the continuity equation 3 we follow the approach described by monaghan 1992 in which the density is directly evaluated by solving the continuity equation rather than by a sum over particles as a consequence the following discretization for the continuity equation is obtained as 8 d ρ a d t b m b u a b a w a b where u a b u a u b a w a b w a b r a and w is an interpolation kernel function in the present study the quintic spline kernel liu and liu 2010 is adopted as its continuous second derivative affords better accuracy and stability 9 w r h w 0 3 q 5 6 2 q 5 15 1 q 5 0 q 1 3 q 5 6 2 q 5 1 q 2 3 q 5 2 q 3 0 q 3 where the normalization factor w 0 takes the value of 3 359 π h 3 in 3d space q r h and r r r is the distance between two particles the smoothing length h defines the supporting domain of the kernel which should be larger than the mean inter particle distance to guarantee the interpolation accuracy for the momentum equation 4 the sph formulation depends on the discretizations of the pressure gradient laplacian operator and reynolds strain tensor according to hu and adams 2006 the acceleration of particle a due to a pressure gradient can be approximated as 10 1 ρ p a 1 m a b v a 2 v b 2 p a b a w a b where p a b denotes the density weighted inter particle averaged pressure hu and adams 2007 i e 11 p a b ρ b p a ρ a p b ρ a ρ b and v a is the volume of particle a which is calculated by v a m a ρ a this form conserves linear and angular momentum exactly as the force between particles a and b is symmetric along the line of centers of the two particles as for the laplacian operator it involves the second derivative of the kernel which is very sensitive to the particle disorder and will easily lead to pressure instability and decoupling in the computation due to the co location of the velocity and pressure therefore the discretization of the viscosity term in equation 4 is identical to that suggested by violeau et al violeau and issa 2007 12 η ρ 2 u a 1 m a b η a b v a 2 v b 2 u a b r a b r a b 2 a w a b where r a b r a r b and η a b 2 η a η b η a η b is the inter particle averaged dynamic viscosity between particles a and b for the reynolds strain tensor we adopt the following sph discretization suggested in xu et al 2012 13 1 ρ ρ r a b m b ρ r a ρ a 2 ρ r b ρ b 2 a w a b b m b r a ρ a r b ρ b a w a b this formulation has been successfully applied in non newtonian free surface flows xu et al 2012 one of the good features for the above discretization is that the field function r appears pairwisely and involves symmetric formulation the symmetric formulation is helpful in improving the numerical stability in sph simulations liu and liu 2010 finally by combining equation 10 13 the sph discretization of the momentum equation 4 can be written as 14 d u d t a 1 m a b v a 2 v b 2 p a b a w a b 1 m a b η a b v a 2 v b 2 u a b r a b r a b 2 a w a b b m b r a ρ a r b ρ b a w a b g a it should be noted that the system of equations 8 and 14 has the drawbacks of low computational accuracy and large and random pressure oscillations for the former it is in nature caused by the kernel and particle approximations adopted in sph to restore the sph consistency several corrected sph versions liu et al 1996 2005 bonet and lok 1999 zhang and batra 2004 batra and zhang 2007 liu and liu 2006 fang et al 2009 xu and deng 2016 have been proposed including those derived by bonet et al bonet and lok 1999 zhang and batra zhang and batra 2004 batra and zhang 2007 liu et al liu et al 2005 liu and liu 2006 and fang et al 2009 in this paper in order to improve the computational accuracy of sph we modify the kernel gradient a w a b as liu et al 1996 15 a w a b l a 1 a w a b where l a is the correction matrix defined by 16 l a b v b a w a b r b a by substituting the corrected kernel gradient into the governing equations we obtain the following corrected sph discretizations of equations 8 and 14 17 d ρ a d t b m b u a b a w a b 18 d u d t a 1 m a b v a 2 v b 2 p a b a w a b 1 m a b η a b v a 2 v b 2 u a b r a b r a b 2 a w a b b m b r a ρ a r b ρ b a w a b g a respectively it should be noted that the corrected kernel gradient requires the inversion of matrix l which might be singular for a highly irregular particle distribution in the present work if such a singularity problem exists for a given particle the correction of sph discretization on that particle would not be imposed by setting l equal to the identity matrix accordingly it leads to the utilization of the standard sph discretization scheme moreover for alleviating large and random pressure oscillations we introduce a rusanov flux xu and deng 2016 ferrari et al 2009 into the continuity equation to intrinsically accounts for diffusion thereupon the new sph discretization of equation 17 is rewritten as xu and deng 2016 19 d ρ a d t b m b u a b n a b c a b ρ b ρ b ρ a a w a b where n a b is the unitary vector of the distance between particles a and b 20 n a b r a b r a b c a b is the maximum numerical speed of sound between particles a and b which is defined as 21 c a b max c a c b and 22 c a p a ρ a c 0 ρ a ρ 0 γ 1 2 for more details on sph discretization we refer the reader to our previous work xu and deng 2016 2 2 2 the technique of wall particles and dummy particles in this work we adopt two types of virtual particles i e wall particles and dummy particles to model the wall boundaries in sph for the straight solid wall the wall particles are regularly placed on the wall boundary with an initial particle spacing δx therefore there is only one layer of wall particles the wall particles do not exert a repulsive force to prevent fluid particles from penetrating the wall boundary instead they contribute to the sph calculations for the velocity density and pressure the densities of wall particles are set to the initial density of the fluid and are not evolved during the simulation which is found to be important for predicting the shape of the free surface near the solid walls the positions of wall particles always remain unchanged during the simulation the pressure of wall particle is calculated according to the following normalized interpolation 23 p a b v b p b w a b b v b w a b where a denotes the index of wall particle and b denotes its neighboring fluid particles the dummy particles are placed off the wall boundary with an initial particle spacing δx in principle the dummy particles should cover a domain with a range of depth comparable with the supporting domain of the kernel therefore there are three layers of dummy particles employed in this work the dummy particles also have fixed density and positions moreover it should be noted that in this work each dummy particle is specially associated with a wall particle in the normal direction of the wall boundary also special treatment is required for the outer and inner corners where two straight solid walls meet i e the dummy particles located within the outer corner and placed on the diagonal line of inner corner are associated with the wall particle located right on the corner to enforce no slip boundary condition along the solid walls the velocities of both wall particles and dummy particles are set to be zero since all solid walls involved in this work are motionless of course it is acknowledged that the present treatment is not an exact no slip boundary condition but introduces a slight slip on the wall boundary however as demonstrated by section 3 1 as well as our previous work xu 2016 the present treatment can provide sufficiently accurate numerical results it is worth noting that in this method there is no need to place an interpolation point inside the wall boundary for each dummy particle the normalized sph interpolation for calculating the velocity of the interpolation point is avoided therefore the present treatment greatly saves the computational time and is much more easy to implement especially for 3d problems on the other hand in the case of a moving solid wall as those exhibited in adami et al 2012 the velocities of both wall particles and dummy particles are not set to be zero specifically if the solid walls move with a velocity v the velocities of both wall particles and dummy particles are set to be v accordingly for what concerns about the pressure the homogeneous neumann boundary condition can be enforced as follows the pressure of wall particle is first calculated according to eq 23 and then the pressure of dummy particle is set to be that of its associated wall particle furthermore for boundaries of irregular or curved shapes involved in the obstacle e g a sloping obstacle with α 60 45 and 30 and an arc obstacle with β 90 and 60 the existing methods shadloo et al 2011 are awkward to use especially in three space dimensions in this work we model them using both wall particles and dummy particles in a flexible manner to be more specific the wall particles are still placed on the wall boundary with an approximate initial particle spacing δx however the dummy particles are technically arranged by a particle packing algorithm colagrossi et al 2012 which allows the attainment of a regular particle distribution with the static solution initially the particles are regularly placed inside the obstacle and the domain boundary is closed we then utilize this algorithm to move the particles toward a static solution when the system is sufficiently close to the steady state the algorithm is stopped once the regular particle configuration is generated the dummy particles adopted can be easily identified as they should only cover a domain with a range of depth comparable with the supporting domain of the kernel as illustrated in fig 1 after both wall particles and dummy particles are positioned the no slip boundary condition and the homogeneous neumann boundary condition for the pressure may be enforced by the identical treatment with those of the straight wall boundary specifically there is also a connected relation between dummy particles and wall particles i e a dummy particle is associated with a wall particle closest to it to enforce the no slip boundary condition along the wall boundary the velocities of both wall particles and dummy particles are set to be zero while the homogeneous neumann boundary condition for the pressure can be enforced by setting the pressure of dummy particle equal to that of its associated wall particle the main advantages of the present boundary treatment lie in 1 it provides us an enhanced treatment to prevent the fluid particles from penetrating the solid walls even for boundaries of irregular or curved shapes 2 both wall particles and dummy particles are only positioned in the initialization process and do not need to be generated at every time step which saves the computational time 3 the present boundary treatment is quite benefit for 3d parallel programming 4 the dummy particles generated by the particle packing algorithm are regular which is helpful in enhancing the stability of the sph algorithm 2 3 solution procedure to integrate the system of equations 18 and 19 along the particle paths a runge kutta 4th order algorithm liu and liu 2010 which offers a 4th order accuracy in time is adopted let q denote density ρ and velocity u and the system of equations 18 and 19 is simplified as 24 d q d t f q where f q represents the right hand sides of the differential equations the solution procedure of the runge kutta 4th order method can now be formulated as 25 q 0 q n q 1 q 0 f q 0 δ t 2 q 2 q 0 f q 1 δ t 2 q 3 q 0 f q 2 δ t q 4 q 0 f q 0 2 f q 1 2 f q 2 f q 3 δ t 6 q n 1 q 4 where q 1 4 denotes the four times update of the field values at each time step and q n and q n 1 denote the generic quantities at the nth and n 1st time step respectively to ensure numerical stability the time step is restricted by the courant friedrichs lewy cfl condition and the mass and viscous force conditions as liu and liu 2010 26 δ t min h c 0 0 25 h a 0 125 h 2 υ 0 where a is the force per unit mass which is equivalent to the magnitude of particle acceleration and υ 0 η ρ is the kinematic viscosity 3 numerical examples in this section we first used one laboratory experiment of 3d dam break flows to validate the sph method then we extended the method to simulate challenging 3d dam break flows against various forms of the obstacle in all numerical examples no slip boundary condition is enforced along the solid walls while homogeneous neumann boundary condition is applied for the pressure as presented in section 2 2 2 3 1 verification and validation in this section the laboratory experiment of hu and kashiwagi 2004 i e 3d dam break flow against a vertical wall is taken to validate the sph method in solving 3d large deformation free surface flows this problem has also been studied by li et al ji et al 2013 from a numerical perspective using a cip based method fig 2 depicts the initial setup for this problem from both a side and a top views as sketched in fig 2 the water column is initially confined by a bottom solid wall and four vertical solid walls then the gate of dam is instantaneously removed and the water flows out along the dry horizontal bed the height of the water column is h 0 12 m while the length and the width are l w 0 68 m the distance between the front and back vertical solid walls is d 1 18 m there is one pressure sensor p1 located at the centerline of the front vertical wall with respect to the width the height of sensor p1 to the bottom wall is 0 01 m which is the same as that of hu and kashiwagi 2004 the fluid has the density ρ 0 1000 kg m 3 and the viscosity η 10 3 pa s the gravity acts in the downward direction with g 9 81 m s 2 according to monaghan 1994 an approximation of the maximum fluid velocity v max is estimated as 27 v max 2 g h therefore the sound speed could be chosen as c 0 10 v max for the sph computations the space resolution is set to be h δx 30 with an initial particle spacing δx 0 004 m the total number of particles involved in this simulation is equal to 1 358 316 which consists of 861 900 fluid particles 120 366 wall particles and 376 050 dummy particles a time step of δ t 1 0 10 4 s is used to ensure numerical stability the smoothing length is h 1 3 δ x the parallel algorithm of sph xu et al 2013 is used to ensure an acceptable computational time we have simulated 10 000 time steps in about 13 3 h on an hp rx2600 workstation using 64 cores fig 3 shows the sph results for this problem at times t 0 1 s 0 3 s 0 6 s and 0 8 s as can be seen the water column collapses under the gravity and propagates along the dry horizontal bed in this period the rear area of water column has a strong pressure gradient as time passes the water column reaches the front vertical wall after that a vertical jet appears along the front vertical wall growing pressure between the fluid and the front vertical wall is rapidly generated because of the collision of the water column to the solid wall the vertical jet grows and overturns backward soon the retroflection phenomenon of the jet appears with the elapse of time the retroflection fluid eventually meets with the underlying fluid because of gravity again there is strong pressure at the intersection of the retroflection and underlying fluids fig 4 depicts and compares the time histories of the pressure recorded at point p1 from 3d sph solution the experiment hu and kashiwagi 2004 and the cip based solution ji et al 2013 it shows reasonable agreement among the results the maximum collision force of the fluid occurs at t 0 35 s just as the water column collides with the front vertical wall at this moment the pressure recorded at p1 is at its highest the maximum pressure at p1 predicted by the sph method is 1552 pa while those of the experimental and cip based measurements are 1577 pa and 1496 pa respectively furthermore in order to check the convergence of the method we have performed two additional runs with the space resolution h δx 20 and 40 respectively the total number of particles involved in these two runs is equal to 676 560 and 2 906 800 respectively the time step adopted for all runs is set to be δ t 1 0 10 4 s the computational costs in terms of the consumed time for simulating 10 000 time steps on an hp rx2600 workstation using 64 cores are 8 1 h for the coarser resolution and 41 6 h for the finer resolution respectively as illustrated in fig 4 there are no observable differences among three sph solutions which show the good convergence of the sph method in simulating 3d large deformation free surface flows 3 2 3d dam break flow against various forms of the obstacle 3 2 1 case of a right angled obstacle in this section the proposed sph method is employed to simulate 3d dam break flow against various forms of the obstacle considered first is a right angled obstacle a problem that has been experimentally studied by koshizuka et al 1995 fig 5 depicts the initial setup for this problem from a side view and a top view with the same as that in koshizuka et al 1995 the height of the water column is h 0 292 m the length l 0 1461 m and the width w 0 1461 m the distance between the front and the back vertical walls is d 0 584 m the right angled obstacle fills the width of the dry horizontal bed and thus has a length of 0 1461 m the width of the right angled obstacle is 0 024 m and the height is 0 048 m the distances of the right angled obstacle to the front and the back vertical walls are 0 268 m and 0 292 m respectively the fluid density is ρ 0 1000 kg m 3 and the viscosity η 10 3 pa s the gravity acts in the downward direction with g 9 81 m s 2 the maximum fluid velocity is approximated as v max 2 g h hence the speed of sound can be taken as c 0 10 v max for the sph computations the space resolution is chosen to be h δx 146 so that we have the initial particle spacing δx 0 002 m the total number of particles involved in this simulation is equal to 1 619 056 which consists of 767 376 fluid particles 206 338 wall particles and 645 342 dummy particles the smoothing length is h 1 3 δ x the time step is taken as δ t 2 0 10 5 s to ensure numerical stability we have simulated 25 000 time steps within about 36 h on an hp rx2600 workstation using 64 cores fig 6 a shows the sph results of 3d dam break flow against a right angled obstacle at t 0 1 s 0 2 s 0 3 s and 0 4 s the corresponding experimental photos are further displayed in fig 6b for comparison because of the presence of the right angled obstacle the flow physics after the dam breaks are quite complex in the beginning the water column collapses under the action of gravity and propagates along the dry horizontal bed the rear area of the water column has a strong pressure gradient as time passes the water column collides with the right angled obstacle there is a large amount of and rapidly increasing pressure at the left vertical wall of the right angled obstacle which is caused by the collision of the water column with the obstacle the water column flows upstream along the left vertical wall of the obstacle and eventually jumps over the obstacle soon the jumping fluid reaches the front vertical wall of the water reservoir again there is a large amount of pressure at the intersection of the jumping fluid and the front vertical wall the sph results are in reasonable agreement with the experiment koshizuka et al 1995 in order to study the collision force of the water column after the dam breaks we place four pressure sensors p1 p2 p3 and p4 on the left vertical wall of the right angled obstacle as shown in fig 7 specifically these sensors are arranged along the centerline of the dry horizontal bed with respect to the width their heights to the bottom solid wall are 0 m 0 012 m 0 024 m and 0 036 m respectively fig 7 depicts the changes in pressure at points p1 p2 p3 and p4 for this problem it is seen that the pressure at p1 p2 p3 and p4 first rapidly increases and then gradually decreases over time the lower the position of the pressure sensor the stronger the collision force of the water column to it therefore the maximum collision force definitely occurs at point p1 when the fluid front impacts on the obstacle at t 0 128 s the maximum pressure at point p1 is 6719 pa while at points p2 p3 and p4 it is 5341 pa 4069 pa and 2952 pa respectively actually this conclusion is easily understandable as the collision of the fluid front with the obstacle surface first occurs at the lowest point of the left vertical wall in addition as the water column flows upstream along the left vertical wall of the obstacle the energy is dissipated the kinetic energy of the water column is also decreased due to gravity therefore the maximum pressure at points p2 p3 and p4 is smaller than that of point p1 3 2 2 cases of a sloping obstacle after the dam breaks the strongest collision force of the water column occurs at the lowest point of the left vertical wall of the obstacle therefore a key factor in reducing the amount of destruction and damage is determining how to reduce the pressure of the water column at the lowest point p1 to do this we simulate 3d dam break flows against a sloping obstacle with three different inclination angles α 60 45 and 30 in these cases boundaries of irregular shapes are involved as introduced in section 2 2 2 both wall particles and dummy particles are adopted also dummy particles are technically arranged by the particle packing algorithm which allows the attainment of a regular particle distribution moreover four pressure sensors p1 p2 p3 and p4 are specially placed on the left sloping wall of the obstacle as shown in fig 8 these sensors are arranged along the centerline of the dry horizontal bed with respect to the width their heights to the bottom solid wall are respectively 0 m 0 012 m 0 024 m and 0 036 m which are the same as those of a right angled obstacle first we investigate the case of a sloping obstacle with the angle of inclination α 60 the time histories of the pressure at points p1 p2 p3 and p4 are depicted in fig 8a similar to that of a right angled obstacle the pressure at points p1 p2 p3 and p4 also exhibits an increasing and then gradually decreasing time history the maximum collision force of the fluid still occurs at point p1 just as the water column reaches the obstacle 0 115 s however because of the adoption of the sloping obstacle the maximal pressure at point p1 has been decreased to 62 4171 pa of a right angled obstacle as listed in table 1 the maximum pressures at points p2 p3 and p4 are also decreased to 2896 pa 2460 pa and 2021 pa respectively indeed when the right angled obstacle is substituted by the sloping obstacle the left sloping wall of the obstacle would have a good buffering effect on the impact of the water column with the obstacle this significantly decreases the pressure on the obstacle surface undoubtedly decreasing the pressure on the obstacle surface will help reducing the amount of destruction and damage incurred after the dam breaks to analyze the effect of the angle of inclination α on the collision force we further simulate 3d dam break flows against a sloping obstacle with two additional angles of inclination α 45 and 30 the pressure evolutions of these two cases at points p1 p2 p3 and p4 are depicted in fig 8b and c respectively the maximum pressures at points p1 p2 p3 and p4 are extracted and summarized in table 1 it can be seen that the maximum pressure on the obstacle surface still occurs at the lowest point of the left sloping wall of the obstacle specifically the maximum pressures at points p1 for the cases of α 45 and 30 have respectively decreased to 45 5 3055 pa and 42 0 2819 pa of a right angled obstacle the maximum pressures at points p2 p3 and p4 are also decreased actually the smaller the sloping angle α of the obstacle the larger the buffering effect on the collision of the water column with the obstacle therefore the maximum pressure on these two obstacle surfaces is lower than that of α 60 moreover it is observed for the cases of α 45 and 30 that there is no rapidly increasing time history of the pressure at the moment when the water column reaches the obstacle instead the pressure on the obstacle surface increases slowly with time and takes a longer time to reach its maximum value to be more specific for the case of α 45 the water column collides with the obstacle at t 0 1 s while the pressure at p1 reaches its maximum value at t 0 162 s a similar conclusion is drawn for the case of α 30 actually for these two cases there is no effective collision of the fluid front with the obstacle surface since their sloping angles are smaller than those of figs 7 and 8a therefore there is no rapidly increasing pressure generated at the moment when the fluid front collides with the obstacle 3 2 3 cases of an arc obstacle although the pressure for a sloping obstacle with α 30 is lower than that of α 45 such a decrease is not obvious also the cross sectional area s see table 1 of the obstacle with α 30 is larger than that of α 45 which implies that more materials need to be taken for the sloping obstacle with α 30 therefore it would be a good way to design a new obstacle so that not only is the pressure decreased on the obstacle surface but also the costs of the materials are reduced to do so 3d dam break flows against an arc obstacle are simulated for this class of the obstacle boundaries of curved shapes are involved as presented in section 2 2 2 both wall particles and dummy particles are adopted dummy particles are technically arranged by the particle packing algorithm which allows the attainment of a regular particle distribution moreover similar to what we did with a right angled and a sloping obstacle we place four pressure sensors p1 p2 p3 and p4 on the left arc wall of the obstacle their heights to the bottom solid wall are 0 m 0 012 m 0 024 m and 0 036 m as shown in fig 9 we first consider 3d dam break flow against the arc obstacle with an arc angle β 90 the pressure evolutions at points p1 p2 p3 and p4 are depicted in fig 9a while the maximum pressure values at points p1 p2 p3 and p4 are extracted in table 1 it is seen that the pressures on the obstacle surface increase slowly as time passes hence it takes a longer time for the pressures to reach their maximum values than in the case of a right angled obstacle however in the same way as the sloping obstacle the arc obstacle also buffers the collision of the water column with the obstacle accordingly the collision force of the water column with the obstacle is also decreased to be more specific the maximum pressure of the fluid at points p1 p2 p3 and p4 is decreased to 2936 pa 3108 pa 2926 pa and 2760 pa respectively for these values it is interestingly found that the maximum collision force for this case occurs at point p2 not at the lowest point p1 this phenomenon can be explained as follows the arc obstacle would have a very good buffer on the collision of the water column to low points e g point p1 but would have a bad buffer to high points such as p2 p3 and p4 indeed after the dam breaks the fluid front does not make an effective impact on point p1 also the height of point p2 is lower than that of points p3 and p4 as time goes on the fluid flows obliquely upward along the obstacles and the energy is dissipated the kinetic energy of the water column is also decreased due to gravity therefore the maximum collision force of the water column to the obstacle occurs at point p2 but not at points p1 p3 and p4 furthermore when compared with the case of a sloping obstacle with α 45 there is little difference with respect to the maximum pressure of the fluid on the obstacle surface however the materials cost for fig 9a has been reduced to 71 4 of fig 8b as illustrated in table 1 from this point of view the case of the obstacle with the arc design is more competitive unfortunately the overall pressure for the arc obstacle with β 90 is higher than that of a sloping obstacle with α 45 therefore we still need to optimize the shape of the obstacle in what follows 3d dam break flow against an arc obstacle with a smaller arc angle β 60 is further simulated as shown in fig 9b and table 1 the arc obstacle with β 60 results in a better buffer on the collision of the water column with the obstacle the maximum pressure of the fluid occurs at the lowest point p1 and decreases to 37 1 2491 pa of a right angled obstacle the maximum pressures at points p2 p3 and p4 are also decreased on the other hand for what concerns about the material cost we highlight that the materials consumed for figs 8b and 9b are almost the same as illustrated in table 1 however the overall pressure for the arc obstacle with β 60 is obviously decreased when compared with fig 8b therefore we conclude that the arc obstacle with β 60 may be selected as one of the optimal forms of the obstacle for reducing the collision force of the fluid after the dam breaks besides we also simulate an arc obstacle with an intermediate arc angle β 75 and find that the maximum collision force of the fluid is still larger than that of β 60 the overall performance of this obstacle is actually intermediate between those of β 90 and β 60 therefore we do not display the corresponding results in this paper to investigate whether a better overall performance can be obtained by further reducing the arc angle β the case of the arc obstacle with β 45 is simulated from fig 9c and table 1 it is observed that the maximum collision force of the fluid still occurs at the lowest point p1 but does not further decrease when compared to that of β 60 at the same time the material cost for the arc obstacle with β 45 is increased by 24 8 therefore to balance the collision force of the fluid and the material cost the design of an arc obstacle with β 60 may be in the end chosen as one of the optimal forms of the obstacle in this scenario the maximum collision force is less than 40 of that for a right angled obstacle 3 3 a further numerical experiment in this section we consider another initial size of the water column to further prove that the arc obstacle with β 60 can be chosen as the optimal form of the obstacle for reducing the collision force of the fluid specifically 3d dam break flow against a cuboid obstacle which has been experimentally studied by kleefsman et al 2005 is simulated fig 10 depicts the side and top views of the initial setup for this problem where the height of the water column is h 0 55 m while the length l 1 228 m and the width w 1 0 m the distance between front and back vertical walls is d 3 221 m the cuboid obstacle is located at the centerline of dry horizontal bed with respect to the width w and has the length 0 161 m the width 0 403 m and the height 0 161 m the distances of cuboid obstacle to the front and the back vertical walls are 0 664 m and 2 396 m respectively the fluid density is ρ 0 1000 kg m 3 and the viscosity η 10 3 pa s the gravity acts in the downward direction with g 9 81 m s 2 the maximum fluid velocity is approximated as v max 2 g h hence the speed of sound can be taken as c 0 10 v max for this problem we place an extra pressure sensor p0 on the lowest central point of the left wall of the obstacle see fig 11 as this is where the maximum collision force of the fluid occurs meanwhile in order to compare the collision force of the fluid with the obstacle we simulate 3d dam break flow against a sloping obstacle with α 45 and an arc obstacle with β 60 the pressure sensor p0 on these two obstacles is also placed at the lowest central point of the left wall of the obstacle which has the same situation as that described in section 3 2 for the sph computations the space resolution is chosen to be h δ x 55 with an initial particle spacing δ x 0 01 m the smoothing length is h 1 3 δ x a time step of δ t 1 0 10 4 s is used to ensure the numerical stability fig 12 displays a visible comparison of the sph results for the cases of a cuboid obstacle a sloping obstacle with α 45 and an arc obstacle with β 60 at two different times t 0 34 s and 0 58 s it is observed that the flow physics of these three cases are the same at the early stages the flow front at t 0 34 s has touched the arc obstacle but not the cuboid and the sloping obstacles then as time passes the fluid fronts reach the obstacle after that the flow patterns after the fluid impacts the obstacle are widely different in the three cases as illustrated at t 0 58 s to be more specific after the fluid impacts on the cuboid obstacle the fluid flows upward along the obstacle soon several tiny droplets are generated because of the collision of the water column with the obstacle conversely after the fluid impacts on the sloping and the arc obstacles the fluid flows obliquely upward along the obstacles therefore the height of the splashing water column for these two cases is lower than that of a cuboid obstacle furthermore there are no tiny droplets observed in the cases of a sloping obstacle with α 45 and an arc obstacle with β 60 as the collision force is decreased because of the good buffer of the obstacles in fig 13 we further depict a direct comparison of the pressure evolutions at point p0 for the cases of a cuboid obstacle a sloping obstacle with α 45 and an arc obstacle with β 60 it is clear that after the fluid impacts the obstacle there is a sudden rise of the pressure in the case of a cuboid obstacle here the maximum value of pressure at point p0 is 15 252 pa while for the sloping and the arc obstacles the maximum pressure at point p0 is decreased to 54 1 8247 pa and 32 5 4962 pa of a cuboid obstacle respectively this again confirms that the arc obstacle with β 60 may be chosen as one of the optimal forms of the obstacle in this scenario the maximum collision force is also less than 40 of that for a right angled obstacle 4 conclusions in this paper the sph method is employed to study the collision force of the water column after the dam deconstructs in order to tackle boundaries of irregular or curved shapes involved in the obstacle both wall particles and dummy particles are adopted dummy particles are technically arranged by a particle packing algorithm which allows the attainment of a regular particle distribution a series of challenging dam break flow problems are simulated and the following conclusions are drawn from the results 1 by simulating 3d dam break flow against a vertical wall and comparing the sph results with the experimental and the cip based solutions we have established the accuracy and convergence of the sph method in solving 3d free surface flows 2 boundaries of complex shapes can be modeled using the technique of wall particles and dummy particles the dummy particles arranged by the particle packing algorithm are regular which is helpful in enhancing the stability of the sph algorithm 3 to balance the collision force and the costs of the materials the arc obstacle with β 60 may be selected as one of the optimal forms of the obstacle for reducing the collision force of the water column in this scenario the maximum collision force on this obstacle surface was less than 40 of that for a right angled obstacle in summary the proposed sph method can handle 3d large deformation flow problems with irregular or curved boundaries accurately the present work is helpful in providing references to reduce the amount of destruction and damage after the dam breaks in future works we anticipate applications of the method to an array of more complicated problems such as dam break flows on wet horizontal beds and dam break flows against movable obstacles credit author statement xiaoyang xu conceptualization methodology writing original draft preparation yao lin jiang validation supervision peng yu reviewing and revision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is financially supported by the national natural science foundation of china no 12071367 11502132 the key project of the international science and technology cooperation program of shaanxi research development plan no 2019kwz 08 the shaanxi youth top notch talent program no 289890259 the shaanxi youth new star program of science and technology no 2019kjxx 012 shenzhen science and technology innovation commission grant no jcyj20170817110214213 and guangdong provincial key laboratory of turbulence research and applications grant no 2019b21203001 
20814,dams are an important part of a country s infrastructure after the dam breaks the collision force of the water column if severe enough would incur a great deal of destruction and damage and needs to be concerned specially in this work 3d dam break flows against various forms of the obstacle are numerically simulated by the smoothed particle hydrodynamics sph method in order to tackle boundaries of irregular or curved shapes involved in the obstacle both wall particles and dummy particles are adopted in sph in which dummy particles are arranged by a particle packing algorithm which allows the attainment of a regular particle distribution to validate the sph method 3d dam break flow against a vertical wall is first simulated and the sph results are compared with the experiment and those obtained by other numerical methods then we extend the method to 3d dam break flows against various forms of the obstacle a number of challenging numerical examples including 3d dam break flows against a right angled obstacle a sloping obstacle with the angle of inclination α 60 45 and 30 and an arc obstacle with the arc angle β 90 60 and 45 are simulated the time evolutions of the pressure on the obstacle surface are shown in details it is demonstrated that the proposed sph method can handle 3d large deformation flows with any complex boundaries accurately the arc obstacle with β 60 may be selected as one of the optimal forms of the obstacle for reducing the collision force of the fluid after the dam breaks the maximum pressure on this obstacle surface is less than 40 of a right angled obstacle keywords sph 3d dam break flow collision force complex boundaries large deformation 1 introduction dams are an important part of a country s infrastructure as they can provide flood protection water storage irrigation and generation of electricity although many efforts have gone into strengthening dams dam breaks often occur due to various factors such as flooding earthquakes and ice dam breaks are considered catastrophic events that can lead to many casualties property damage and environmental problems after the dam breaks the collision force of the water column if severe enough would incur a great deal of destruction and damage and thus needs to be concerned specially studies of dam break flow entail theoretical experimental and numerical investigations for the theoretical investigation dressler 1954 obtained the theoretical curves for the hydraulic dam break wave fraccarollo and capart 2002 examined sudden erosional flow initiated by the release of a dam break wave over a loose sediment bed peng and zhang 2013 presented a risk based theoretical framework of dynamic decision making for dam break emergency management hosseinpoor et al 2019 evaluated the applicability of dam break theory to analytically solve the flow profile of self consolidating concrete in a modified l box set up with regard to the experiments stansby et al 1998 undertook experiments to investigate dam break flows where a thin plate was withdrawn suddenly in a vertically upward direction hu and kashiwagi 2004 described a constrained interpolation profile cip based method on a fixed cartesian grid system to solve dam break flow and then compared the numerical results with those obtained from the experiment lobovský et al 2014 performed the experimental measurements for a dam break flow over a horizontal dry bed with the aim of providing insight into the dynamics of a dam break wave fent et al 2019 conducted experiments on dam break flows over a bed made of coarse sand and obtained the detailed velocity measurements in the clear water layer and the moving sediment layer in recent decades the numerical simulation technique has been an effective choice for measuring dam break flows because of the rapid development of computer technology although grid based numerical methods can be used to deal with dam break flows they require additional numerical technique such as volume of fluid vof marker and cell mac or level set to track the moving free surface in vof tracking of dynamical interface is accomplished by solving a transport equation for the volume fraction of the fluid while marker particles are specially employed in mac the level set method is used to locate the moving surface by utilizing an additional implicit level set function in 2002 brufau et al 2002 presented a cell centered finite volume method to model the shallow water flow in one and two dimensions kleefsman et al 2005 simulated 2d dam break flow using a vof based method and compared the results to the experimental measurements marsooli and wu 2014 proposed a 3d numerical model to study dam break flows over uneven beds the free surface was captured by vof and the advection equation was solved by the compressive interface capturing scheme for arbitrary meshes issakhov and imanberdiyeva 2019 applied vof to study the movement of the water surface when a dam is broken the mathematical model was based on the navier stokes equations and the large eddy simulation les mathematical model for turbulence was specifically used recently zhang and wan 2019 proposed a method that combined the moving particle semi implicit method and the finite element method to simulate 3d dam break flow over the last four decades there have also been a number of attempts to develop mesh free methods as alternatives to grid based numerical methods one of the most successful meshfree methods is smoothed particle hydrodynamics sph which was originally proposed by lucy 1977 and gingold and monaghan 1977 for astrophysical computations actually sph is a lagrangian particle method in which the fluid is discretized by a set of particles the particles can be moving according to the solutions of relevant governing equations when compared to grid based methods the sph method has the following advantages for simulating free surface flows liu and liu 2010 1 the free surface can be naturally modeled without the need of any form of explicit interface tracking 2 the advection and transport of the system can be solved very well because of its lagrangian and adaptive nature and 3 numerical procedure for complex problems is comparatively simple in 1994 monaghan 1994 applied sph for the first time to deal with free surface flows in recent years the sph method has been extended to various scientific and engineering problems including free surface flows xu et al 2014a xu 2016 wang et al 2019 yang et al 2020 lin et al 2019 fürstenau et al 2020 explosion liu et al 2003 2017 multi phase flows zhang et al 2019 rezavand et al 2020 ji et al 2020 meng et al 2020 injection molding xu and yu 2017 2019 heat transfer rook et al 2007 xiong et al 2019 ng et al 2020 abdoh et al 2020 and viscoelastic fluid flows xu et al 2012 2014b xu and ouyang 2013 xu and yu 2016 for sph simulations of dam break flow dalrymple and knio 2001 presented an sph approach to a numerical wave tank which was capable of studying several types of waves impinging on structures and walls shao and lo 2003 developed an incompressible sph method to simulate 2d non newtonian dam break flow crespo et al 2008 extended sph to simulate dam break flows over dry and wet beds and the obtained results match the experimental dam break profiles moulinec moulinec et al 2008 designed an efficient parallel sph algorithm and assessed the speeding up of the code by simulating 3d dam break flows yang et al 2016 developed a method that combined sph and element bending group modeling to simulate the impact of a 2d dam break flow on flexible structures sun et al 2015 used a multiphase sph method to study fluid structure dam break flow problems all the works mentioned above nicely show the advantage of sph over grid based numerical methods in simulating dam break flows however to the best of the authors knowledge there has not yet been any research that has used the mesh free particle methods and specifically the sph method to study the collision force of the fluid after the dam breaks as stated before after the dam breaks the collision force of the fluid need to be concerned specially because a large force would incur a great deal of destruction and damage thus it would be a good way to design some new forms of the obstacle at the downstream for decreasing the collision force of the fluid with the obstacle to solve dam break flows against various forms of the obstacle one major difficulty for sph is how to flexibly model boundaries of irregular or curved shapes involved in the obstacle in general sph formulations are valid for all interior particles but are not accurate for particles close to the solid boundary as the kernel function has been truncated by the solid boundary from this point of view the direct application of boundary conditions is problematic in sph at present several techniques e g repulsive force method monaghan and kajtar 2009 ghost particle method morris et al 1997 dummy particle method adami et al 2012 and multiple boundary tangent method yildiz et al 2009 shadloo et al 2011 have been proposed these techniques were able to model boundaries accurately nevertheless the procedure for modeling irregular or curved boundaries especially in three space dimensions is still awkward in this paper we develop a robust sph method which can tackle boundaries of irregular or curved shapes flexibly specifically we employ both wall particles and dummy particles to model the wall boundaries in which dummy particles are arranged by a particle packing algorithm which allows the attainment of a regular particle distribution we extend the method to 3d dam break flows against various forms of the obstacle with the aim of designing an optimal form for reducing the collision force of the fluid after the dam breaks a number of numerical examples including 3d dam break flows against a right angled obstacle a sloping obstacle with the angle of inclination α 60 45 and 30 and an arc obstacle with the arc angle β 90 60 and 45 are simulated the changes in the pressure on the obstacle surface as time passes are shown in detail the rest of this paper is organized as follows section 2 describes the mathematical model as well as the sph method implemented in section 3 the method is first validated by solving 3d dam break flow against a vertical wall and comparing the sph results with the available literature data then the method is extended to 3d dam break flows against various forms of the obstacle section 4 presents our conclusions and some final remarks 2 mathematical formulations 2 1 governing equations in a lagrangian frame the governing equations for the motion of an incompressible fluid flow are the conservation equations of mass and momentum 1 d ρ d t ρ u 2 d u d t 1 ρ p η ρ 2 u g where ρ is the density t is the time u is the velocity p is the pressure η is the dynamic viscosity and g is the acceleration of gravity 2 1 1 turbulent closure the turbulence closure is important for the simulation of dam breaking it plays a significant role in improving the accuracy of predicting the free surface near the solid wall or the obstacle it is acknowledged that the flow physics near the solid wall or the obstacle could be reproduced more satisfactorily with the usage of the turbulence closure park et al 2012 larocque et al 2013 therefore we adopt the turbulence model in the present work similar to the previous works xu 2016 park et al 2012 larocque et al 2013 in the les framework the mass and momentum equations of particle scale flow can be derived from the navier stokes equations by a spatial filter and are represented as shao and ji 2006 3 d ρ d t ρ u 4 d u d t 1 ρ p η ρ 2 u 1 ρ ρ r g where the hat refers to the filtered variables and r is the sub particle scale stress tensor that is modeled using an appropriate turbulent closure in this work the eddy viscosity assumption shao and ji 2006 arai et al 2013 boussinesq s hypothesis is adopted to model the sub particle scale stress tensor as 5 r 2 υ t s 1 3 i tr r where υ t is the turbulence eddy viscosity s is the mean rate of strain tensor i is the identity matrix and the symbol tr denotes the trace of matrix for the eddy viscosity υ t the model proposed by smagorinsky 1963 is used which has the form 6 υ t c s d x 2 2 s s where c s is the smagorinsky constant with the value 0 12 smagorinsky 1963 and δx is the initial particle spacing moreover it should be noted that the widely used log law distribution arai et al 2013 is adopted for the turbulence conditions near the solid wall since the turbulence eddy viscosity should reduce to zero in the vicinity of a solid wall 2 1 2 incompressibility constraint the most frequently used method of implementing the incompressibility constraint in sph is the usage of a weakly compressible formulation with weakly compressible sph formulation the governing equations are closed by a suitably chosen artificial equation of state p p ρ since the pressure is an explicit function of density the density gradient exerts an influence on the particle motion in sph one of the most common equations of state is written as monaghan 1994 7 p ρ ρ 0 c 0 2 γ ρ ρ 0 γ 1 where ρ 0 is the initial density of the fluid γ 7 is a constant and c 0 is the speed of sound to ensure that the flow physics of the pseudo compressible fluid are sufficiently close to those of a truly incompressible fluid the sound speed c 0 should be at least 10 times higher than the maximal fluid velocity 2 2 smoothed particle hydrodynamics 2 2 1 sph discretization in the sph method each particle represents a macroscopic volume of fluid each fluid particle a carries physical information such as mass m a density ρ a pressure p a velocity u a position r a and other physical quantities depending on the nature of fluid the mass remains unchanged during the simulations while the pressure density velocity position and other physical quantities are updated at each time step at present there are many different discretizations of governing equations in the sph context for the continuity equation 3 we follow the approach described by monaghan 1992 in which the density is directly evaluated by solving the continuity equation rather than by a sum over particles as a consequence the following discretization for the continuity equation is obtained as 8 d ρ a d t b m b u a b a w a b where u a b u a u b a w a b w a b r a and w is an interpolation kernel function in the present study the quintic spline kernel liu and liu 2010 is adopted as its continuous second derivative affords better accuracy and stability 9 w r h w 0 3 q 5 6 2 q 5 15 1 q 5 0 q 1 3 q 5 6 2 q 5 1 q 2 3 q 5 2 q 3 0 q 3 where the normalization factor w 0 takes the value of 3 359 π h 3 in 3d space q r h and r r r is the distance between two particles the smoothing length h defines the supporting domain of the kernel which should be larger than the mean inter particle distance to guarantee the interpolation accuracy for the momentum equation 4 the sph formulation depends on the discretizations of the pressure gradient laplacian operator and reynolds strain tensor according to hu and adams 2006 the acceleration of particle a due to a pressure gradient can be approximated as 10 1 ρ p a 1 m a b v a 2 v b 2 p a b a w a b where p a b denotes the density weighted inter particle averaged pressure hu and adams 2007 i e 11 p a b ρ b p a ρ a p b ρ a ρ b and v a is the volume of particle a which is calculated by v a m a ρ a this form conserves linear and angular momentum exactly as the force between particles a and b is symmetric along the line of centers of the two particles as for the laplacian operator it involves the second derivative of the kernel which is very sensitive to the particle disorder and will easily lead to pressure instability and decoupling in the computation due to the co location of the velocity and pressure therefore the discretization of the viscosity term in equation 4 is identical to that suggested by violeau et al violeau and issa 2007 12 η ρ 2 u a 1 m a b η a b v a 2 v b 2 u a b r a b r a b 2 a w a b where r a b r a r b and η a b 2 η a η b η a η b is the inter particle averaged dynamic viscosity between particles a and b for the reynolds strain tensor we adopt the following sph discretization suggested in xu et al 2012 13 1 ρ ρ r a b m b ρ r a ρ a 2 ρ r b ρ b 2 a w a b b m b r a ρ a r b ρ b a w a b this formulation has been successfully applied in non newtonian free surface flows xu et al 2012 one of the good features for the above discretization is that the field function r appears pairwisely and involves symmetric formulation the symmetric formulation is helpful in improving the numerical stability in sph simulations liu and liu 2010 finally by combining equation 10 13 the sph discretization of the momentum equation 4 can be written as 14 d u d t a 1 m a b v a 2 v b 2 p a b a w a b 1 m a b η a b v a 2 v b 2 u a b r a b r a b 2 a w a b b m b r a ρ a r b ρ b a w a b g a it should be noted that the system of equations 8 and 14 has the drawbacks of low computational accuracy and large and random pressure oscillations for the former it is in nature caused by the kernel and particle approximations adopted in sph to restore the sph consistency several corrected sph versions liu et al 1996 2005 bonet and lok 1999 zhang and batra 2004 batra and zhang 2007 liu and liu 2006 fang et al 2009 xu and deng 2016 have been proposed including those derived by bonet et al bonet and lok 1999 zhang and batra zhang and batra 2004 batra and zhang 2007 liu et al liu et al 2005 liu and liu 2006 and fang et al 2009 in this paper in order to improve the computational accuracy of sph we modify the kernel gradient a w a b as liu et al 1996 15 a w a b l a 1 a w a b where l a is the correction matrix defined by 16 l a b v b a w a b r b a by substituting the corrected kernel gradient into the governing equations we obtain the following corrected sph discretizations of equations 8 and 14 17 d ρ a d t b m b u a b a w a b 18 d u d t a 1 m a b v a 2 v b 2 p a b a w a b 1 m a b η a b v a 2 v b 2 u a b r a b r a b 2 a w a b b m b r a ρ a r b ρ b a w a b g a respectively it should be noted that the corrected kernel gradient requires the inversion of matrix l which might be singular for a highly irregular particle distribution in the present work if such a singularity problem exists for a given particle the correction of sph discretization on that particle would not be imposed by setting l equal to the identity matrix accordingly it leads to the utilization of the standard sph discretization scheme moreover for alleviating large and random pressure oscillations we introduce a rusanov flux xu and deng 2016 ferrari et al 2009 into the continuity equation to intrinsically accounts for diffusion thereupon the new sph discretization of equation 17 is rewritten as xu and deng 2016 19 d ρ a d t b m b u a b n a b c a b ρ b ρ b ρ a a w a b where n a b is the unitary vector of the distance between particles a and b 20 n a b r a b r a b c a b is the maximum numerical speed of sound between particles a and b which is defined as 21 c a b max c a c b and 22 c a p a ρ a c 0 ρ a ρ 0 γ 1 2 for more details on sph discretization we refer the reader to our previous work xu and deng 2016 2 2 2 the technique of wall particles and dummy particles in this work we adopt two types of virtual particles i e wall particles and dummy particles to model the wall boundaries in sph for the straight solid wall the wall particles are regularly placed on the wall boundary with an initial particle spacing δx therefore there is only one layer of wall particles the wall particles do not exert a repulsive force to prevent fluid particles from penetrating the wall boundary instead they contribute to the sph calculations for the velocity density and pressure the densities of wall particles are set to the initial density of the fluid and are not evolved during the simulation which is found to be important for predicting the shape of the free surface near the solid walls the positions of wall particles always remain unchanged during the simulation the pressure of wall particle is calculated according to the following normalized interpolation 23 p a b v b p b w a b b v b w a b where a denotes the index of wall particle and b denotes its neighboring fluid particles the dummy particles are placed off the wall boundary with an initial particle spacing δx in principle the dummy particles should cover a domain with a range of depth comparable with the supporting domain of the kernel therefore there are three layers of dummy particles employed in this work the dummy particles also have fixed density and positions moreover it should be noted that in this work each dummy particle is specially associated with a wall particle in the normal direction of the wall boundary also special treatment is required for the outer and inner corners where two straight solid walls meet i e the dummy particles located within the outer corner and placed on the diagonal line of inner corner are associated with the wall particle located right on the corner to enforce no slip boundary condition along the solid walls the velocities of both wall particles and dummy particles are set to be zero since all solid walls involved in this work are motionless of course it is acknowledged that the present treatment is not an exact no slip boundary condition but introduces a slight slip on the wall boundary however as demonstrated by section 3 1 as well as our previous work xu 2016 the present treatment can provide sufficiently accurate numerical results it is worth noting that in this method there is no need to place an interpolation point inside the wall boundary for each dummy particle the normalized sph interpolation for calculating the velocity of the interpolation point is avoided therefore the present treatment greatly saves the computational time and is much more easy to implement especially for 3d problems on the other hand in the case of a moving solid wall as those exhibited in adami et al 2012 the velocities of both wall particles and dummy particles are not set to be zero specifically if the solid walls move with a velocity v the velocities of both wall particles and dummy particles are set to be v accordingly for what concerns about the pressure the homogeneous neumann boundary condition can be enforced as follows the pressure of wall particle is first calculated according to eq 23 and then the pressure of dummy particle is set to be that of its associated wall particle furthermore for boundaries of irregular or curved shapes involved in the obstacle e g a sloping obstacle with α 60 45 and 30 and an arc obstacle with β 90 and 60 the existing methods shadloo et al 2011 are awkward to use especially in three space dimensions in this work we model them using both wall particles and dummy particles in a flexible manner to be more specific the wall particles are still placed on the wall boundary with an approximate initial particle spacing δx however the dummy particles are technically arranged by a particle packing algorithm colagrossi et al 2012 which allows the attainment of a regular particle distribution with the static solution initially the particles are regularly placed inside the obstacle and the domain boundary is closed we then utilize this algorithm to move the particles toward a static solution when the system is sufficiently close to the steady state the algorithm is stopped once the regular particle configuration is generated the dummy particles adopted can be easily identified as they should only cover a domain with a range of depth comparable with the supporting domain of the kernel as illustrated in fig 1 after both wall particles and dummy particles are positioned the no slip boundary condition and the homogeneous neumann boundary condition for the pressure may be enforced by the identical treatment with those of the straight wall boundary specifically there is also a connected relation between dummy particles and wall particles i e a dummy particle is associated with a wall particle closest to it to enforce the no slip boundary condition along the wall boundary the velocities of both wall particles and dummy particles are set to be zero while the homogeneous neumann boundary condition for the pressure can be enforced by setting the pressure of dummy particle equal to that of its associated wall particle the main advantages of the present boundary treatment lie in 1 it provides us an enhanced treatment to prevent the fluid particles from penetrating the solid walls even for boundaries of irregular or curved shapes 2 both wall particles and dummy particles are only positioned in the initialization process and do not need to be generated at every time step which saves the computational time 3 the present boundary treatment is quite benefit for 3d parallel programming 4 the dummy particles generated by the particle packing algorithm are regular which is helpful in enhancing the stability of the sph algorithm 2 3 solution procedure to integrate the system of equations 18 and 19 along the particle paths a runge kutta 4th order algorithm liu and liu 2010 which offers a 4th order accuracy in time is adopted let q denote density ρ and velocity u and the system of equations 18 and 19 is simplified as 24 d q d t f q where f q represents the right hand sides of the differential equations the solution procedure of the runge kutta 4th order method can now be formulated as 25 q 0 q n q 1 q 0 f q 0 δ t 2 q 2 q 0 f q 1 δ t 2 q 3 q 0 f q 2 δ t q 4 q 0 f q 0 2 f q 1 2 f q 2 f q 3 δ t 6 q n 1 q 4 where q 1 4 denotes the four times update of the field values at each time step and q n and q n 1 denote the generic quantities at the nth and n 1st time step respectively to ensure numerical stability the time step is restricted by the courant friedrichs lewy cfl condition and the mass and viscous force conditions as liu and liu 2010 26 δ t min h c 0 0 25 h a 0 125 h 2 υ 0 where a is the force per unit mass which is equivalent to the magnitude of particle acceleration and υ 0 η ρ is the kinematic viscosity 3 numerical examples in this section we first used one laboratory experiment of 3d dam break flows to validate the sph method then we extended the method to simulate challenging 3d dam break flows against various forms of the obstacle in all numerical examples no slip boundary condition is enforced along the solid walls while homogeneous neumann boundary condition is applied for the pressure as presented in section 2 2 2 3 1 verification and validation in this section the laboratory experiment of hu and kashiwagi 2004 i e 3d dam break flow against a vertical wall is taken to validate the sph method in solving 3d large deformation free surface flows this problem has also been studied by li et al ji et al 2013 from a numerical perspective using a cip based method fig 2 depicts the initial setup for this problem from both a side and a top views as sketched in fig 2 the water column is initially confined by a bottom solid wall and four vertical solid walls then the gate of dam is instantaneously removed and the water flows out along the dry horizontal bed the height of the water column is h 0 12 m while the length and the width are l w 0 68 m the distance between the front and back vertical solid walls is d 1 18 m there is one pressure sensor p1 located at the centerline of the front vertical wall with respect to the width the height of sensor p1 to the bottom wall is 0 01 m which is the same as that of hu and kashiwagi 2004 the fluid has the density ρ 0 1000 kg m 3 and the viscosity η 10 3 pa s the gravity acts in the downward direction with g 9 81 m s 2 according to monaghan 1994 an approximation of the maximum fluid velocity v max is estimated as 27 v max 2 g h therefore the sound speed could be chosen as c 0 10 v max for the sph computations the space resolution is set to be h δx 30 with an initial particle spacing δx 0 004 m the total number of particles involved in this simulation is equal to 1 358 316 which consists of 861 900 fluid particles 120 366 wall particles and 376 050 dummy particles a time step of δ t 1 0 10 4 s is used to ensure numerical stability the smoothing length is h 1 3 δ x the parallel algorithm of sph xu et al 2013 is used to ensure an acceptable computational time we have simulated 10 000 time steps in about 13 3 h on an hp rx2600 workstation using 64 cores fig 3 shows the sph results for this problem at times t 0 1 s 0 3 s 0 6 s and 0 8 s as can be seen the water column collapses under the gravity and propagates along the dry horizontal bed in this period the rear area of water column has a strong pressure gradient as time passes the water column reaches the front vertical wall after that a vertical jet appears along the front vertical wall growing pressure between the fluid and the front vertical wall is rapidly generated because of the collision of the water column to the solid wall the vertical jet grows and overturns backward soon the retroflection phenomenon of the jet appears with the elapse of time the retroflection fluid eventually meets with the underlying fluid because of gravity again there is strong pressure at the intersection of the retroflection and underlying fluids fig 4 depicts and compares the time histories of the pressure recorded at point p1 from 3d sph solution the experiment hu and kashiwagi 2004 and the cip based solution ji et al 2013 it shows reasonable agreement among the results the maximum collision force of the fluid occurs at t 0 35 s just as the water column collides with the front vertical wall at this moment the pressure recorded at p1 is at its highest the maximum pressure at p1 predicted by the sph method is 1552 pa while those of the experimental and cip based measurements are 1577 pa and 1496 pa respectively furthermore in order to check the convergence of the method we have performed two additional runs with the space resolution h δx 20 and 40 respectively the total number of particles involved in these two runs is equal to 676 560 and 2 906 800 respectively the time step adopted for all runs is set to be δ t 1 0 10 4 s the computational costs in terms of the consumed time for simulating 10 000 time steps on an hp rx2600 workstation using 64 cores are 8 1 h for the coarser resolution and 41 6 h for the finer resolution respectively as illustrated in fig 4 there are no observable differences among three sph solutions which show the good convergence of the sph method in simulating 3d large deformation free surface flows 3 2 3d dam break flow against various forms of the obstacle 3 2 1 case of a right angled obstacle in this section the proposed sph method is employed to simulate 3d dam break flow against various forms of the obstacle considered first is a right angled obstacle a problem that has been experimentally studied by koshizuka et al 1995 fig 5 depicts the initial setup for this problem from a side view and a top view with the same as that in koshizuka et al 1995 the height of the water column is h 0 292 m the length l 0 1461 m and the width w 0 1461 m the distance between the front and the back vertical walls is d 0 584 m the right angled obstacle fills the width of the dry horizontal bed and thus has a length of 0 1461 m the width of the right angled obstacle is 0 024 m and the height is 0 048 m the distances of the right angled obstacle to the front and the back vertical walls are 0 268 m and 0 292 m respectively the fluid density is ρ 0 1000 kg m 3 and the viscosity η 10 3 pa s the gravity acts in the downward direction with g 9 81 m s 2 the maximum fluid velocity is approximated as v max 2 g h hence the speed of sound can be taken as c 0 10 v max for the sph computations the space resolution is chosen to be h δx 146 so that we have the initial particle spacing δx 0 002 m the total number of particles involved in this simulation is equal to 1 619 056 which consists of 767 376 fluid particles 206 338 wall particles and 645 342 dummy particles the smoothing length is h 1 3 δ x the time step is taken as δ t 2 0 10 5 s to ensure numerical stability we have simulated 25 000 time steps within about 36 h on an hp rx2600 workstation using 64 cores fig 6 a shows the sph results of 3d dam break flow against a right angled obstacle at t 0 1 s 0 2 s 0 3 s and 0 4 s the corresponding experimental photos are further displayed in fig 6b for comparison because of the presence of the right angled obstacle the flow physics after the dam breaks are quite complex in the beginning the water column collapses under the action of gravity and propagates along the dry horizontal bed the rear area of the water column has a strong pressure gradient as time passes the water column collides with the right angled obstacle there is a large amount of and rapidly increasing pressure at the left vertical wall of the right angled obstacle which is caused by the collision of the water column with the obstacle the water column flows upstream along the left vertical wall of the obstacle and eventually jumps over the obstacle soon the jumping fluid reaches the front vertical wall of the water reservoir again there is a large amount of pressure at the intersection of the jumping fluid and the front vertical wall the sph results are in reasonable agreement with the experiment koshizuka et al 1995 in order to study the collision force of the water column after the dam breaks we place four pressure sensors p1 p2 p3 and p4 on the left vertical wall of the right angled obstacle as shown in fig 7 specifically these sensors are arranged along the centerline of the dry horizontal bed with respect to the width their heights to the bottom solid wall are 0 m 0 012 m 0 024 m and 0 036 m respectively fig 7 depicts the changes in pressure at points p1 p2 p3 and p4 for this problem it is seen that the pressure at p1 p2 p3 and p4 first rapidly increases and then gradually decreases over time the lower the position of the pressure sensor the stronger the collision force of the water column to it therefore the maximum collision force definitely occurs at point p1 when the fluid front impacts on the obstacle at t 0 128 s the maximum pressure at point p1 is 6719 pa while at points p2 p3 and p4 it is 5341 pa 4069 pa and 2952 pa respectively actually this conclusion is easily understandable as the collision of the fluid front with the obstacle surface first occurs at the lowest point of the left vertical wall in addition as the water column flows upstream along the left vertical wall of the obstacle the energy is dissipated the kinetic energy of the water column is also decreased due to gravity therefore the maximum pressure at points p2 p3 and p4 is smaller than that of point p1 3 2 2 cases of a sloping obstacle after the dam breaks the strongest collision force of the water column occurs at the lowest point of the left vertical wall of the obstacle therefore a key factor in reducing the amount of destruction and damage is determining how to reduce the pressure of the water column at the lowest point p1 to do this we simulate 3d dam break flows against a sloping obstacle with three different inclination angles α 60 45 and 30 in these cases boundaries of irregular shapes are involved as introduced in section 2 2 2 both wall particles and dummy particles are adopted also dummy particles are technically arranged by the particle packing algorithm which allows the attainment of a regular particle distribution moreover four pressure sensors p1 p2 p3 and p4 are specially placed on the left sloping wall of the obstacle as shown in fig 8 these sensors are arranged along the centerline of the dry horizontal bed with respect to the width their heights to the bottom solid wall are respectively 0 m 0 012 m 0 024 m and 0 036 m which are the same as those of a right angled obstacle first we investigate the case of a sloping obstacle with the angle of inclination α 60 the time histories of the pressure at points p1 p2 p3 and p4 are depicted in fig 8a similar to that of a right angled obstacle the pressure at points p1 p2 p3 and p4 also exhibits an increasing and then gradually decreasing time history the maximum collision force of the fluid still occurs at point p1 just as the water column reaches the obstacle 0 115 s however because of the adoption of the sloping obstacle the maximal pressure at point p1 has been decreased to 62 4171 pa of a right angled obstacle as listed in table 1 the maximum pressures at points p2 p3 and p4 are also decreased to 2896 pa 2460 pa and 2021 pa respectively indeed when the right angled obstacle is substituted by the sloping obstacle the left sloping wall of the obstacle would have a good buffering effect on the impact of the water column with the obstacle this significantly decreases the pressure on the obstacle surface undoubtedly decreasing the pressure on the obstacle surface will help reducing the amount of destruction and damage incurred after the dam breaks to analyze the effect of the angle of inclination α on the collision force we further simulate 3d dam break flows against a sloping obstacle with two additional angles of inclination α 45 and 30 the pressure evolutions of these two cases at points p1 p2 p3 and p4 are depicted in fig 8b and c respectively the maximum pressures at points p1 p2 p3 and p4 are extracted and summarized in table 1 it can be seen that the maximum pressure on the obstacle surface still occurs at the lowest point of the left sloping wall of the obstacle specifically the maximum pressures at points p1 for the cases of α 45 and 30 have respectively decreased to 45 5 3055 pa and 42 0 2819 pa of a right angled obstacle the maximum pressures at points p2 p3 and p4 are also decreased actually the smaller the sloping angle α of the obstacle the larger the buffering effect on the collision of the water column with the obstacle therefore the maximum pressure on these two obstacle surfaces is lower than that of α 60 moreover it is observed for the cases of α 45 and 30 that there is no rapidly increasing time history of the pressure at the moment when the water column reaches the obstacle instead the pressure on the obstacle surface increases slowly with time and takes a longer time to reach its maximum value to be more specific for the case of α 45 the water column collides with the obstacle at t 0 1 s while the pressure at p1 reaches its maximum value at t 0 162 s a similar conclusion is drawn for the case of α 30 actually for these two cases there is no effective collision of the fluid front with the obstacle surface since their sloping angles are smaller than those of figs 7 and 8a therefore there is no rapidly increasing pressure generated at the moment when the fluid front collides with the obstacle 3 2 3 cases of an arc obstacle although the pressure for a sloping obstacle with α 30 is lower than that of α 45 such a decrease is not obvious also the cross sectional area s see table 1 of the obstacle with α 30 is larger than that of α 45 which implies that more materials need to be taken for the sloping obstacle with α 30 therefore it would be a good way to design a new obstacle so that not only is the pressure decreased on the obstacle surface but also the costs of the materials are reduced to do so 3d dam break flows against an arc obstacle are simulated for this class of the obstacle boundaries of curved shapes are involved as presented in section 2 2 2 both wall particles and dummy particles are adopted dummy particles are technically arranged by the particle packing algorithm which allows the attainment of a regular particle distribution moreover similar to what we did with a right angled and a sloping obstacle we place four pressure sensors p1 p2 p3 and p4 on the left arc wall of the obstacle their heights to the bottom solid wall are 0 m 0 012 m 0 024 m and 0 036 m as shown in fig 9 we first consider 3d dam break flow against the arc obstacle with an arc angle β 90 the pressure evolutions at points p1 p2 p3 and p4 are depicted in fig 9a while the maximum pressure values at points p1 p2 p3 and p4 are extracted in table 1 it is seen that the pressures on the obstacle surface increase slowly as time passes hence it takes a longer time for the pressures to reach their maximum values than in the case of a right angled obstacle however in the same way as the sloping obstacle the arc obstacle also buffers the collision of the water column with the obstacle accordingly the collision force of the water column with the obstacle is also decreased to be more specific the maximum pressure of the fluid at points p1 p2 p3 and p4 is decreased to 2936 pa 3108 pa 2926 pa and 2760 pa respectively for these values it is interestingly found that the maximum collision force for this case occurs at point p2 not at the lowest point p1 this phenomenon can be explained as follows the arc obstacle would have a very good buffer on the collision of the water column to low points e g point p1 but would have a bad buffer to high points such as p2 p3 and p4 indeed after the dam breaks the fluid front does not make an effective impact on point p1 also the height of point p2 is lower than that of points p3 and p4 as time goes on the fluid flows obliquely upward along the obstacles and the energy is dissipated the kinetic energy of the water column is also decreased due to gravity therefore the maximum collision force of the water column to the obstacle occurs at point p2 but not at points p1 p3 and p4 furthermore when compared with the case of a sloping obstacle with α 45 there is little difference with respect to the maximum pressure of the fluid on the obstacle surface however the materials cost for fig 9a has been reduced to 71 4 of fig 8b as illustrated in table 1 from this point of view the case of the obstacle with the arc design is more competitive unfortunately the overall pressure for the arc obstacle with β 90 is higher than that of a sloping obstacle with α 45 therefore we still need to optimize the shape of the obstacle in what follows 3d dam break flow against an arc obstacle with a smaller arc angle β 60 is further simulated as shown in fig 9b and table 1 the arc obstacle with β 60 results in a better buffer on the collision of the water column with the obstacle the maximum pressure of the fluid occurs at the lowest point p1 and decreases to 37 1 2491 pa of a right angled obstacle the maximum pressures at points p2 p3 and p4 are also decreased on the other hand for what concerns about the material cost we highlight that the materials consumed for figs 8b and 9b are almost the same as illustrated in table 1 however the overall pressure for the arc obstacle with β 60 is obviously decreased when compared with fig 8b therefore we conclude that the arc obstacle with β 60 may be selected as one of the optimal forms of the obstacle for reducing the collision force of the fluid after the dam breaks besides we also simulate an arc obstacle with an intermediate arc angle β 75 and find that the maximum collision force of the fluid is still larger than that of β 60 the overall performance of this obstacle is actually intermediate between those of β 90 and β 60 therefore we do not display the corresponding results in this paper to investigate whether a better overall performance can be obtained by further reducing the arc angle β the case of the arc obstacle with β 45 is simulated from fig 9c and table 1 it is observed that the maximum collision force of the fluid still occurs at the lowest point p1 but does not further decrease when compared to that of β 60 at the same time the material cost for the arc obstacle with β 45 is increased by 24 8 therefore to balance the collision force of the fluid and the material cost the design of an arc obstacle with β 60 may be in the end chosen as one of the optimal forms of the obstacle in this scenario the maximum collision force is less than 40 of that for a right angled obstacle 3 3 a further numerical experiment in this section we consider another initial size of the water column to further prove that the arc obstacle with β 60 can be chosen as the optimal form of the obstacle for reducing the collision force of the fluid specifically 3d dam break flow against a cuboid obstacle which has been experimentally studied by kleefsman et al 2005 is simulated fig 10 depicts the side and top views of the initial setup for this problem where the height of the water column is h 0 55 m while the length l 1 228 m and the width w 1 0 m the distance between front and back vertical walls is d 3 221 m the cuboid obstacle is located at the centerline of dry horizontal bed with respect to the width w and has the length 0 161 m the width 0 403 m and the height 0 161 m the distances of cuboid obstacle to the front and the back vertical walls are 0 664 m and 2 396 m respectively the fluid density is ρ 0 1000 kg m 3 and the viscosity η 10 3 pa s the gravity acts in the downward direction with g 9 81 m s 2 the maximum fluid velocity is approximated as v max 2 g h hence the speed of sound can be taken as c 0 10 v max for this problem we place an extra pressure sensor p0 on the lowest central point of the left wall of the obstacle see fig 11 as this is where the maximum collision force of the fluid occurs meanwhile in order to compare the collision force of the fluid with the obstacle we simulate 3d dam break flow against a sloping obstacle with α 45 and an arc obstacle with β 60 the pressure sensor p0 on these two obstacles is also placed at the lowest central point of the left wall of the obstacle which has the same situation as that described in section 3 2 for the sph computations the space resolution is chosen to be h δ x 55 with an initial particle spacing δ x 0 01 m the smoothing length is h 1 3 δ x a time step of δ t 1 0 10 4 s is used to ensure the numerical stability fig 12 displays a visible comparison of the sph results for the cases of a cuboid obstacle a sloping obstacle with α 45 and an arc obstacle with β 60 at two different times t 0 34 s and 0 58 s it is observed that the flow physics of these three cases are the same at the early stages the flow front at t 0 34 s has touched the arc obstacle but not the cuboid and the sloping obstacles then as time passes the fluid fronts reach the obstacle after that the flow patterns after the fluid impacts the obstacle are widely different in the three cases as illustrated at t 0 58 s to be more specific after the fluid impacts on the cuboid obstacle the fluid flows upward along the obstacle soon several tiny droplets are generated because of the collision of the water column with the obstacle conversely after the fluid impacts on the sloping and the arc obstacles the fluid flows obliquely upward along the obstacles therefore the height of the splashing water column for these two cases is lower than that of a cuboid obstacle furthermore there are no tiny droplets observed in the cases of a sloping obstacle with α 45 and an arc obstacle with β 60 as the collision force is decreased because of the good buffer of the obstacles in fig 13 we further depict a direct comparison of the pressure evolutions at point p0 for the cases of a cuboid obstacle a sloping obstacle with α 45 and an arc obstacle with β 60 it is clear that after the fluid impacts the obstacle there is a sudden rise of the pressure in the case of a cuboid obstacle here the maximum value of pressure at point p0 is 15 252 pa while for the sloping and the arc obstacles the maximum pressure at point p0 is decreased to 54 1 8247 pa and 32 5 4962 pa of a cuboid obstacle respectively this again confirms that the arc obstacle with β 60 may be chosen as one of the optimal forms of the obstacle in this scenario the maximum collision force is also less than 40 of that for a right angled obstacle 4 conclusions in this paper the sph method is employed to study the collision force of the water column after the dam deconstructs in order to tackle boundaries of irregular or curved shapes involved in the obstacle both wall particles and dummy particles are adopted dummy particles are technically arranged by a particle packing algorithm which allows the attainment of a regular particle distribution a series of challenging dam break flow problems are simulated and the following conclusions are drawn from the results 1 by simulating 3d dam break flow against a vertical wall and comparing the sph results with the experimental and the cip based solutions we have established the accuracy and convergence of the sph method in solving 3d free surface flows 2 boundaries of complex shapes can be modeled using the technique of wall particles and dummy particles the dummy particles arranged by the particle packing algorithm are regular which is helpful in enhancing the stability of the sph algorithm 3 to balance the collision force and the costs of the materials the arc obstacle with β 60 may be selected as one of the optimal forms of the obstacle for reducing the collision force of the water column in this scenario the maximum collision force on this obstacle surface was less than 40 of that for a right angled obstacle in summary the proposed sph method can handle 3d large deformation flow problems with irregular or curved boundaries accurately the present work is helpful in providing references to reduce the amount of destruction and damage after the dam breaks in future works we anticipate applications of the method to an array of more complicated problems such as dam break flows on wet horizontal beds and dam break flows against movable obstacles credit author statement xiaoyang xu conceptualization methodology writing original draft preparation yao lin jiang validation supervision peng yu reviewing and revision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is financially supported by the national natural science foundation of china no 12071367 11502132 the key project of the international science and technology cooperation program of shaanxi research development plan no 2019kwz 08 the shaanxi youth top notch talent program no 289890259 the shaanxi youth new star program of science and technology no 2019kjxx 012 shenzhen science and technology innovation commission grant no jcyj20170817110214213 and guangdong provincial key laboratory of turbulence research and applications grant no 2019b21203001 
