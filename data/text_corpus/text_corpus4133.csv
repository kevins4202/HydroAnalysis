index,text
20665,the panel method is widely used in the design and analysis of marine propellers however this method cannot handle propellers with a blunt trailing edge due to a lack of proper models for the flow separation downstream in this study a numerical scheme i e the three dimensional flow separation model is proposed to enable the panel method to be applied to propellers with a blunt trailing edge in this model the flow separation zone is represented as an extension of the trailing edge the criteria of zero local lifts and zero local moments over the extension of all blade sections are used to establish the equations that determine the shape of the flow separation zone those equations are solved either by the newton raphson method or as an optimization problem a low order panel method coupled with a boundary layer solver the viscous inviscid interaction method is used to predict the pressure distributions and forces for the extended geometry to validate this model the pressure distributions of the propeller blade are compared with those from solving the reynolds averaged navier stokes equations the predicted open water characteristics of a controllable pitch propeller are compared with the experimental measurements at a wide range of advance ratios with different pitches this model requires much less computational effort while preserving high accuracy and thus can be used reliably in designing and analyzing propellers with a blunt trailing edge graphical abstract keywords the boundary element method bem panel method propellers with blunt trailing edge flow separation controllable pitch propeller cpp numerical method 1 introduction the boundary element method bem or more commonly known as the panel method has been widely used to predict flows around propellers due to its high efficiency and acceptable accuracy moulijn 2015 the effect of viscosity can be taken into account either via empirical skin frictions known as the viscous pitch correction kerwin and lee 1978 or via coupling the panel method with boundary layer solvers known as the viscous inviscid interaction vii method drela 1989 milewski 1997 hufford et al 1994 sun and kinnas 2008 kinnas et al 2012 while both of these two methods improve the correlation of predicted open water characteristics with experimental measurements the pressure distributions from vii method are more accurate especially near the trailing edge kim et al 2018 du and kinnas 2019b one disadvantage of the panel method and the vii method is that they cannot handle the blunt trailing edge t e sections due to a lack of proper models for the flow separation downstream propellers with a blunt t e are commonly seen either due to structural reasons or to reduce the high pitched noise often referred to as the singing edges one way to apply the panel method in sections with a blunt t e is to reduce the thickness near the t e without changing the camber as shown in fig 1 however this approximation brings in several problems first where to start reducing the thickness is totally empirical in fig 1 the location is selected as 90 of the chord length whether this value affects the predicted propeller forces and pressure distributions or not requires further justification second it is hard to find the exact location of the t e if it is not sharp and because of that the modified geometry might end up with an unsmooth shape near the t e between sections after the thickness is reduced third modifying the geometry might affect the accuracy of the boundary element method since the panels are changed physically a more rational approach is to represent the flow separation downstream of the blunt t e by an extension du and kinnas 2019a developed a flow separation model for hydrofoils and propeller ducts with blunt t e sections this model can be summarized as it is assumed that the pressure in the boundary layer separation region is constant as indicated by rans simulations this assumption is enforced by the conditions of zero lift and zero moment over the extension zone the location of the last point of the extension is determined by the conditions above via a numerical scheme solved by the newton raphson method the starting points of the extension on both sides are determined in an iterative manner by requiring the friction coefficients to be equal to zero at those points it was found that the pressure distributions and skin frictions along the hydrofoils and ducts correlate well with those from solving the reynolds averaged navier stokes rans equations and the thrust and torque of the ducted propeller agree much better with the experimental measurements when the extension is determined from this model compared to the case where the t e section is extended to a randomly selected location in this paper du and kinnas s 2019a model is extended from two dimensional 2d to three dimensional 3d and applied to a 4 blade open propeller with a blunt trailing edge the flow is assumed to be incompressible fully wetted and steady i e without any cavitation or vortex shedding only the mean flow is considered to make conclusions from the presented method applicable to full scale propellers the flow is assumed to be fully turbulent in the vii method the laminar to turbulent flow transition points are forced at locations 1 of the chord length from the leading edge and correspondingly results are compared with those from rans simulations of fully turbulent flow the propeller is cut into strips with constant radii and a series of hydrofoils with blunt t e s are obtained on the cylindrical surfaces each hydrofoil is extended to a sharp t e section on the cylindrical surface and the extended hydrofoil sections are used to create a propeller geometry with a sharp trailing edge a numerical scheme is established in this study to find the shape of the flow separation zone in this scheme it is assumed that there is no net force or moment in the extension zone i e the criteria of zero local lifts and zero local moments over the extension the local lifts and local moments are based on the inviscid pressure distributions predicted by a low order panel method with a fast wake alignment scheme i e the psf 2 type alignment greeley and kerwin 1982 the shape of the flow separation zone is controlled by a few parameters which are the unknowns to be solved in the presented model either by a newton raphson method or as an optimization problem after the extension is found within a certain tolerance the propeller with a sharp t e is solved in the panel method using a pseudo unsteady wake alignment scheme full wake alignment scheme or fwa tian and kinnas 2012 coupled with a boundary layer solver to obtain the viscous pressure distributions and forces it should be noted that the presented method is only applicable to propellers working under a moderate loading condition where the boundary layer separation is expected to be locally downstream of the blunt trailing edge the unsteadiness caused by propellers working under extreme off design conditions where the leading edge separation occurs is beyond the scope of this method however as shown later in the paper the predicted open water characteristics from the presented method agree well with the experimental measurements over a large range of advance ratios in the case of a controllable pitch propeller cpp with three different pitches the pressure distributions of different blade sections predicted from this model are compared with those from the rans simulations with very fine meshes downstream of the blunt t e to capture the flow separation the open water characteristics are validated with the experimental measurements and the computational efficiency of this method is summarized 2 methodology 2 1 the reynolds averaged navier stokes method in the rans method the velocity field u i is decomposed into its mean u i and the fluctuation u i reynolds 1894 as 1 u i u i u i the governing equations in the rans method are the continuity equation and the momentum equations as 2 u 0 and 3 u i t u j u i x j p x i x j ν u i x j u i u j where p is the pressure ν the kinematic viscosity and u i u j the reynolds stress in this study the pressure distributions from the flow separation model are compared with those from the rans simulations by using the commercial computational fluid dynamics cfd software star ccm siemens 2018 the flow is assumed to be steady incompressible and fully turbulent in the rans simulations the spalart allmaras turbulence model is used spalart and allmaras 1992 and the residuals for the continuity and momentum equations are set as 1 0 1 0 6 the far field boundary conditions are velocity inlet and pressure outlet as shown in fig 2 uniform inflow is used in the rans simulation and the periodic boundary condition is used so that only one blade needs to be modeled the radius of the computational domain is 5 r where r is the propeller radius the distance from the upstream velocity inlet to the propeller plane is 5 4 r and the distance from the propeller plane to the downstream pressure outlet is 10 4 r in the rans simulation polyhedral meshes are used with 30 prism layers to model the boundary layer region a grid independence study is shown in table 1 with different numbers of cells used the advance ratio in this grid independent study is 0 579 and the pitch to diameter ratio p d of this cpp is 0 87 in this paper all the pitch to diameter ratios are defined by the pitch at 70 of the blade radius the advance ratio is defined as 4 j s v s n d where v s is the ship speed n the propeller rotational frequency and d the propeller diameter the propeller thrust coefficient is defined as 5 k t t ρ n 2 d 4 and the torque coefficient is defined as 6 k q q ρ n 2 d 5 where t is the propeller thrust q the propeller torque and ρ the fluid density the differences between the predicted forces in case 1 and case 2 are within 0 5 which shows that the number of cells used in case 2 is large enough in this paper all the results predicted from the rans simulations are from using the meshes in case 2 to model the flow separation in the rans method very fine grids are needed near the blade surface and in the wake region as shown in fig 3 however o grids must be used for blade sections with a blunt t e which means that only a short part of the trailing wake can be modeled with fine enough grids as opposed to blade sections with a sharp t e where c grids can be used which allow for a longer part of the trailing wake to be modeled with fine grids 2 2 the viscous inviscid interaction vii method in the panel method the total flow velocity q is decomposed into an incoming flow q i n and a propeller induced flow u i n v the perturbation velocity 7 q q i n u i n v u i n v can be treated as the potential flow which is governed by the laplace s equation 8 u i n v ϕ and 2 ϕ 0 where ϕ is the perturbation potential the kutta condition is required which means the velocity must remain finite 9 ϕ at the trailing edge by using the green s identity 8 can be written in the boundary integral form 10 2 π ϕ p s h ϕ p g p p n p g p p ϕ p n p d s s w δ ϕ w g p p n p d s where s h is the surface of the propeller blade s w the surface of the trailing wake g the green s function which is defined as 1 r p p with r being the distance between the two points p and p the viscous effect can be considered by coupling the panel method with a boundary layer solver xfoil drela 1989 milewski 1997 hufford et al 1994 sun and kinnas 2008 kinnas et al 2012 known as the viscous inviscid interaction method in 2d the viscous velocity on the i th panel is obtained by 11 u i v i s u i i n v j 1 n n w c i j σ j where u i i n v is the edge velocity on the i th panel n and n w the number of panels on s h and s w respectively c i j the source influence coefficient matrix and σ j the boundary layer source strength on the j th panel in 3d propellers flows it is assumed that the boundary layer growth in the spanwise direction is negligible compared with that in the chordwise direction so the 2d boundary layer equations are solved strip by strip the 3d influence coefficients are used and the effects of the boundary layer sources from other strips and blades are considered as given in kinnas et al 2012 applying the vii in a five blade propeller with a sharp t e propeller 5168 can be seen in du and kinnas 2019b where the vii method greatly improves the correlation of the predicted thrust and torque with the experimental data compared with the pure panel method without the boundary layer corrections 2 3 the 3d flow separation model 2 3 1 generating the extension from the original geometry in this paper the 3d flow separation model is applied to a 4 blade open propeller with a blunt t e as shown in fig 4 the x y z cartesian coordinate system in this study is shown in fig 5 a the origin of the coordinate system is placed on the propeller rotational axis the vii method cannot be applied directly to this propeller since it has a blunt t e so an extension is needed first m m cylindrical cuts are made from the blade root to the blade tip when i 1 the radius of the cut equals the hub radius and when i m m the radius of the cut equals the blade radius m r panels in the spanwise direction are generated and used in the panel method where m r m m 1 half cosine spacing is used so that more panels are concentrated near the blade tip where the gradient of the propeller loading with respect to the radius is expected to be high as shown in fig 5 b the intersection of a cylinder with a constant radius r and the blade surface is a hydrofoil with a blunt t e in the x r θ plane where x x r y 2 z 2 and θ t a n 1 y z on the cylindrical surface the hydrofoil is extended to a section with a sharp t e as shown in fig 6 define a local x y coordinate system in the x r θ plane with the origin placed at the hydrofoil leading edge and the y axis aligned with the hydrofoil s nose tail line the lengths in each section are non dimensionalized based on the chord length of this section so that the blunt t e hydrofoils are placed between 0 0 and 1 0 in the x y coordinate system the trailing edge of the extended section point c is located at x c y c where x c 1 0 shows how much the chord length is extended and y c is how far point c is moved in the direction perpendicular to the nose tail line of the original section as shown in fig 6 b full cosine spacing is used in the chordwise direction to concentrate more panels near the leading edge and trailing edge locations of point c in all sections are to be determined by the 3d flow separation model similar to the 2d flow separation model in du and kinnas 2019a the extension is built by 2nd order polynomials to ensure that both the geometry and the slope are continuous at point a and b it should be noted that the use of 2nd order polynomials is a numerical constraint on solving the location of point c if larger order polynomials were used the shape of the flow separation region zone would be more flexible and different chordwise locations for point c would be expected discussion of the unicity of the flow separation model s solution will be summarized in later sections after the results of solving the flow separation model are presented if the coordinates of points a b and c are given the extension is uniquely determined by solving the equation set 12 y c a 1 x c 2 b 1 x c c 1 y a a 1 x a 2 b 1 x a c 1 s l o p e a 2 a 1 x a b 1 y c a 2 x c 2 b 2 x c c 2 y b a 2 x b 2 b 2 x b c 2 s l o p e b 2 a 2 x b b 2 where x a y a x b y b x c and y c are coordinates of points a b and c and s l o p e a and s l o p e b are known from the original section the other parameters are the coefficients of the quadratic function and need to be solved in the 2d flow separation model du and kinnas 2019a point c is moved in both the horizontal and vertical direction by using the newton raphson method until both criteria of zero lift and zero moment are satisfied which is the inner loop of the scheme in the outer loop point a and b are moved along the surface of the foil until they overlap with the flow separation points where the skin friction c f is equal to zero with a certain tolerance ideally in the 3d flow separation model locations of point a b and c of all strips need to be determined in a similar way however this will introduce too many unknowns and more importantly the smoothness of the new t e cannot be guaranteed if the hydrofoils are extended independently section by section based on the experience from the 2d flow separation model locations of point a and b have a much weaker effect on the predicted pressure distribution and forces than the location of point c on the other hand as shown in fig 6 a the shape of the extension is almost unaffected by the location of point a and b unless they are very close to the t e of the original section which is unphysical in this study the location of point a and b are fixed at 93 of the chord length to guarantee the smoothness of the extended t e the x c and y c distributions are constructed using polynomials 13 x c r α 0 α 1 r α 2 r 2 α m r m y c r β 0 β 1 r β 2 r 2 β n r n where α 0 α 1 α m β 0 β 1 β n are coefficients in the least square method let l m n 2 these l parameters can uniquely determine the shape of the extension and are unknowns to be solved for in the 3d flow separation model the initial guess of the extension is obtained by assuming that curve ac and bc in all the sections in fig 6 are straight lines as shown in fig 7 2 3 2 model establishment define a vector x α 0 α 1 α m β 0 β 1 β n t with l elements given an initial propeller geometry with a blunt t e and a vector x a propeller with a sharp t e can be uniquely determined using eqs 12 and 13 similar to the 2d flow separation model it is assumed that there is no net force or moment in the extension zone i e the zero local lifts and zero local moments criteria the local lift and local moment over the extension in j th section is defined as 14 δ f j p r e s s u r e s u c t i o n i c p i δ x i p r e s s u r e s u c t i o n i δ x i δ r j δ m j p r e s s u r e s u c t i o n i c p i δ x i x i p r e s s u r e s u c t i o n i δ x i x i δ r j where δ r j is the length of the panel in the spanwise direction and c p the pressure coefficient defined as 15 c p i p i p 1 2 ρ n 2 d 2 where p is the pressure at far upstream and p i the pressure at the control point of the panel δ f and δ m represent the local lift and local moment but they are dimensionless quantities as δ x is nondimensionalized by the chord length of the section and δ r is nondimensionalized by the propeller radius r in the definition of δ f and δ m c p is multiplied by the panel length in both the chordwise direction and the spanwise direction because in this paper the full cosine spacing is used in the chordwise direction and the half cosine spacing is used in the spanwise direction as shown in figs 6 a and 7 a thus more panels are concentrated near the trailing edge and the blade tip to improve the accuracy of the panel method δ f and δ m are being normalized by setting the pressure coefficient equal to unity because in each section shorter extensions will intrinsically make the force and moment differences between the two sides smaller so if δ f and δ m are not being divided by the panel length in the chordwise direction the flow separation model tends to converge to smaller x c by using a low order panel method the pressure distribution at each strip is found since there are m r panels there are 2 m r local lifts and local moments for each extension define a vector g as g δ f 1 δ f 2 δ f m r δ m 1 δ m 2 δ m m r t the 3d flow separation model can be stated as find vector x so that all the elements in vector g are zero in this study two types of methods are proposed to find vector x that satisfies the criteria of zero local lifts and zero local moments over the extensions 2 3 3 newton raphson method to find the solution of the 3d flow separation model the 2d newton raphson method is first applied section by section to find x c i and y c i where i is the section index the derivatives are evaluated numerically using the finite difference method in this study an entire loop to find the extension of all sections is called one sweep at the end of each sweep the extension is smoothed using eq 13 a gauss seidel like scheme is used which means that the new values x c k 1 i and y c k 1 i are used as soon as they are known where k is the sweep index for example once we have found x c k 1 1 and y c k 1 1 these values are used in generating the extended geometry to find x c k 1 2 and y c k 1 2 in this study this scheme is applied from the blade tip section to the hub section the first sweep then from the hub section to the tip section the second sweep etc until all the values of x c and y c converge with a certain tolerance at the same time at the end of each sweep the extension is smoothed using eq 13 the newton raphson method described above was used in this study and successfully found the solution that satisfies the criteria of zero local lifts and zero local moments there were also some failed attempts of trying the newton raphson method to solve the 3d flow separation models as in du 2019 2 3 4 optimization methods the solution of the 3d flow separation model can also be found by regarding it as an optimization problem 16 m i n i m i z e g 0 x where g 0 g g is the norm of vector g and in this study the infinity norm is used i e g 0 g there are various approaches to find the solution to this optimization problem in later sections a brute force search method referred to as optimization method 1 brute force and a derivative free and unconstrained optimization solver newuoa powell 2006 referred to as optimization method 2 newuoa are used and their computational efficiencies are summarized in this paper the 3d flow separation model consists of two stages the first stage is to find the extension of the propeller that satisfies the zero local lifts and zero local moments criteria either by using the newton raphson method or solving as an optimization problem in this stage each propeller with a sharp t e is solved by the panel method with a fast wake alignment scheme the psf 2 type of alignment the boundary layer equations are not solved in this stage and the inviscid pressure is used to calculate the local lifts and local moments which greatly reduces the computational time and improves the stability of the numerical scheme after the extension is found the propeller is solved using the full wake alignment scheme more accurate but more time consuming coupled with the boundary layer solver as the second stage of the 3d flow separation model 3 results and discussions 3 1 the reynolds averaged navier stokes method the relative velocity magnitude contour plots at two sections with constant radii from the rans simulation are shown in fig 8 in this simulation j s 0 579 and the pitch to diameter ratio is 0 87 the velocity downstream of the blunt t e is low due to the flow separation the wall distance y for this simulation is shown in fig 9 the pressure distributions and the computational efficiency number of cpus and the computing time will be shown in later sections together with results from the 3d flow separation model 3 2 the 3d flow separation model 3 2 1 solving by the newton raphson method in fig 10 the x c and y c distributions of the extension found by the 3d flow separation model and solved by the newton raphson method are shown together with those from an arbitrary extension and the initial guess in the newton raphson method at the end of each sweep the x c and y c distributions are smoothed using the second and fifth order polynomials respectively as given in eq 13 the newton raphson method generally needs three to four sweeps to convergence in the arbitrary extension the x c distributions are the same as in the initial guess and the y c is set as zero in all sections as shown in fig 11 the local lifts and local moments in the arbitrary extension and in the initial guess are much larger than those in the extensions found by the 3d flow separation models as shown in table 2 the variations of the predicted thrust and torque from extensions found using different methods to solve the 3d flow separation model are within 1 while the initial guess over predicts both the thrust and torque by over 4 and the arbitrary extension under predicts both the thrust and torque by over 14 compared with the average k t and 10 k q of those found in the 3d flow separation model in table 2 the values of g 0 in the arbitrary extension the initial guess and the extensions found by the presented methods are listed the arbitrary extension and the initial guess have much higher g 0 values which shows that the criteria of zero local lifts and zero local moments are violated in these extensions and consequently the difference in the predicted forces are large compared with the average forces of the extensions found by the presented method which have significantly smaller g 0 values it is worth mentioning that because of the smoothing of the locations of point c it is not possible to find an extension of the t e that produces zero local lifts and zero local moments over the extension in all sections at the same time however as the local lifts and local moments become close to zero the predicted thrust and torque of the propeller will both converge as will be clearly shown in the results from solving the flow separation model using the brute force method 3 2 2 solving by the optimization methods optimization method 1 brute force the brute force search method is by no means an efficient algorithm and there are infinite number of extensions even if x c and y c distributions are approximated by eq 13 however some useful conclusions can be drawn in this method when testing a large number of extended geometries and correlating the predicted forces with the g 0 values in this study a second order polynomial 3 coefficients is used to approximate the x c distributions and a fifth order polynomial 6 coefficients is used for the y c distributions according to eq 13 these 9 coefficients are used as the input to generate the extensions in the brute force search method at the end of each round of the brute force search the coefficients corresponding to the smallest g 0 are used as the center point in the computing domain to generate extensions for the next round of search and the increments in these coefficients are reduced by half in each round of search each propeller geometry with a sharp trailing edge is solved independently in parallel using multiple cpus the brute force search ends when the k t and 10 k q converge to the same value with a small tolerance between two rounds of searches in total 40739 extensions are tested the k t and 10 k q values of all these extensions are shown in fig 12 plotted as a function of g 0 where one pair of points represent one extended geometry as shown in fig 12 the location of the t e has a strong effect on the forces of the propeller the converged k t i e the k t corresponding to the smallest g 0 is about 0 20 but the k t s of all extensions are in the range of 0 06 to 0 40 the converged 10 k q is about 0 29 but the 10 k q s of all extensions are in the range of 0 04 to 0 70 more importantly the differences between the forces of an extension and the converged forces almost increase linearly as g 0 becomes larger in most extensions at this advance ratio the largest g 0 is about 100 times bigger than the smallest g 0 for all the searched extensions to conclude it is critical to find the extension that the local lifts and local moments are as close to zero as possible otherwise the predicted forces can be very wrong the smallest g 0 in the extension found by the brute force method is shown in table 2 at such a small g 0 value it is found that the variations in k t and 10 k q are both within 1 the x c and y c distributions of the extension found by the brute force method are shown in fig 10 and the local lift and local moment distributions are shown in fig 11 optimization method 2 newuoa a derivative free and unconstrained optimization solver newuoa powell 2006 is used to solve the 3d flow separation model at j s 0 579 the x c and y c distributions are approximated by second and fifth order polynomial respectively so the number of unknowns is 9 in the solver the stopping criterion in the optimization method is that the maximum change in these unknowns are smaller than a predefined tolerance 10 4 between two iterations i e the shape of the flow separation zone converges only 90 extensions are tested before the stopping criterion is satisfied a significant reduction compared with the brute force search method optimization method 2 newuoa cannot be applied in parallel not like the brute force search method however the cpu time is greatly reduced as shown in table 3 the x c and y c distributions of the extension found in this method are shown in fig 10 and the local lift and local moment distributions are shown in fig 11 the propellers loadings in the arbitrary extension the initial guess and the extensions found by different methods in the 3d flow separation models are shown in fig 13 the x c and y c distributions and the propeller loadings of the extensions found by different methods show a lot of similarities compared with those in the arbitrary extension and the initial guess the local lifts and local moments distributions from the extensions found by the presented method are much closer to zero and consequently the predicted thrust and torque are very close as indicated by table 2 and fig 12 3 2 3 the pressure distributions and open water characteristics after the extension is found by the 3d flow separation model using the optimization solver newuoa the propeller is solved using the full wake alignment scheme tian and kinnas 2012 coupled with the boundary layer solver xfoil drela 1989 milewski 1997 hufford et al 1994 sun and kinnas 2008 kinnas et al 2012 to find the viscous pressure distributions at j s 0 579 as shown in fig 14 in these simulations the pitch to diameter ratio of this cpp is 0 87 compared with results from the 2d flow separation model in du and kinnas 2019a the correlation with the rans method is not as good that is because predicting the three dimensional flow separations for propellers with a blunt t e is much more challenging than predicting the flow separations in two dimensional for hydrofoils and propeller ducts with an increased number of unknowns and more complexity in the model the open water characteristics of the blunt t e controllable pitch propeller from the presented method are compared with the experimental measurements at three different pitch to diameter ratios 0 6 0 75 and 0 9 as shown in fig 15 at each advance ratio the reynolds number in the vii method are calculated based on advance speed and the temperature in the experiment for all these propeller pitches a good agreement with the experiment at all advance ratios are observed which shows the robustness of the present method 3 2 4 summary of the computational efficiency compared with the rans method the 3d flow separation model in general does not require as many computational resources and takes a much shorter time in the calculation not to mention the time for pre processing and post processing the only exception is solving the 3d flow separation model by using the brute force method which is not recommended an overall comparison of the computational efficiency of different methods is shown in table 3 all the simulations were done on the clusters of the texas advanced computing center using an intel xeon e5 2680 2 7 ghz processor in the rans method only the simulation time was counted in the 3d flow separation model the first stage is labeled as sweep if the newton raphson method was used and labeled as search if the optimization method was used the second stage is labeled as fwa bl full wake alignment with boundary layer corrections 3 2 5 the unicity of the solution the solution for the point c locations is not unique this can be explained in a simplified manner as follows consider the two dimensional potential flow over a camber line including the streamline going downstream from the stagnation point at the t e if we try to extend the camber line behind the t e with zero lifts and moments we have for each possible chordwise x c location a y c solution that is precisely the y c located just on the stagnation streamline at x c the shape for the solution of the extended camber line would be then that of the initial stagnation streamline up to x c however the solution of the camber line problem will not depend on the x c value chosen since the boundary conditions are untouched with that choice of extension in a three dimensional propeller problem as shown in fig 10 the solution of the flow separation model is not unique neither even with some approximations in this study these approximations include i in each section shapes of curve ac and bc shown in fig 6 are approximated by 2nd order polynomials to ensure that both the geometry and the slope are continuous where the extension merges with the original sections ii when the flow separation model is solved by the newton raphson method at the end of each sweep the x c and y c distributions are smoothed using the second and fifth order polynomials respectively and in the optimization methods the same polynomial orders are used to approximate the x c and y c distributions these approximations constrain the shape of the flow separation region but also greatly reduce the number of unknowns to be solved an improvement of the model using higher orders of polynomials for curve ac and bc and the x c and y c distributions can be a future work of this study as shown in fig 13 and table 2 different numerical schemes in this study predict the extensions of the t e that have very similar propeller loading and forces even though the solutions are not the same fig 12 further proves that under the constraints in this study if the local lifts and local moments become closer to zero both the predicted thrust and torque will converge to finite values more importantly propeller forces from the extensions found by the presented schemes correlate well with the experimental data under a large range of advance ratios with different propeller pitches the authors fully acknowledge that there might exist some extension shapes with smaller local lifts and local moments that the presented schemes fail to find however the variations in the predicted propeller forces are within about 0 5 if the shape of the extension is found by the proposed schemes much smaller than the case that the extension shapes are determined arbitrarily as shown in table 2 to conclude with our proposed schemes and the approximations of the polynomials we try to solve the flow problem for propellers with blunt t e by reaching one possible solution for the shape of the extension that the local lifts and local moments are equal to zero with a certain tolerance not to find all the possible solutions 4 conclusions in this paper a 3d flow separation model is proposed so that the viscous inviscid interaction method can be applied to predict the flows around open propellers with a blunt t e it is assumed that there is no net force or moment in the extension zone and the criteria of zero local lifts and zero local moments over the extension in all blade sections are established different methods are proposed to solve this model including a newton raphson method and two optimization methods after the extension is found the propeller is solved in the viscous inviscid interaction method which couples a panel method with a boundary layer solver and the full wake alignment scheme is used to more accurately predict the location of the trailing wake the flow separation zones found by different methods proposed in this study show lot of similarities and the predicted propeller circulation distributions and forces are very close with each other even though the solutions are not unique from this study it is also found that when the local lifts and local moments over the extension are close to zero i e when the criteria in the 3d flow separation model are satisfied the predicted thrust and torque converge to the same value even the extensions are found using completely different methods however when the criteria are not satisfied the predicted forces might be very different in other words it is critical to find the extensions that satisfy the zero local lifts and zero local moments criteria and different methods in the 3d flow separation model in this paper can effectively achieve this goal compared with the rans method the 3d flow separation model requires much shorter computational time and significantly fewer computational resources not to mention the time for pre processing and post processing pressure distributions from the presented method correlate well with those from the rans simulations open water characteristics from the presented method agree well with the experimental measurements of a controllable pitch propeller at a wide range of advance ratios and with three different pitches to conclude the 3d flow separation model is robust and reliable and thus can be a useful tool in designing and analyzing open propellers with blunt trailing edge credit authorship contribution statement weikang du conceptualization methodology software validation writing original draft writing review editing visualization spyros a kinnas supervision resources writing review editing project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments support for this research was provided by the us office of naval research grant number n00014 14 1 0303 and n00014 18 1 2276 dr ki han kim partly by phase viii of the consortium on cavitation performance of high speed propulsors 
20665,the panel method is widely used in the design and analysis of marine propellers however this method cannot handle propellers with a blunt trailing edge due to a lack of proper models for the flow separation downstream in this study a numerical scheme i e the three dimensional flow separation model is proposed to enable the panel method to be applied to propellers with a blunt trailing edge in this model the flow separation zone is represented as an extension of the trailing edge the criteria of zero local lifts and zero local moments over the extension of all blade sections are used to establish the equations that determine the shape of the flow separation zone those equations are solved either by the newton raphson method or as an optimization problem a low order panel method coupled with a boundary layer solver the viscous inviscid interaction method is used to predict the pressure distributions and forces for the extended geometry to validate this model the pressure distributions of the propeller blade are compared with those from solving the reynolds averaged navier stokes equations the predicted open water characteristics of a controllable pitch propeller are compared with the experimental measurements at a wide range of advance ratios with different pitches this model requires much less computational effort while preserving high accuracy and thus can be used reliably in designing and analyzing propellers with a blunt trailing edge graphical abstract keywords the boundary element method bem panel method propellers with blunt trailing edge flow separation controllable pitch propeller cpp numerical method 1 introduction the boundary element method bem or more commonly known as the panel method has been widely used to predict flows around propellers due to its high efficiency and acceptable accuracy moulijn 2015 the effect of viscosity can be taken into account either via empirical skin frictions known as the viscous pitch correction kerwin and lee 1978 or via coupling the panel method with boundary layer solvers known as the viscous inviscid interaction vii method drela 1989 milewski 1997 hufford et al 1994 sun and kinnas 2008 kinnas et al 2012 while both of these two methods improve the correlation of predicted open water characteristics with experimental measurements the pressure distributions from vii method are more accurate especially near the trailing edge kim et al 2018 du and kinnas 2019b one disadvantage of the panel method and the vii method is that they cannot handle the blunt trailing edge t e sections due to a lack of proper models for the flow separation downstream propellers with a blunt t e are commonly seen either due to structural reasons or to reduce the high pitched noise often referred to as the singing edges one way to apply the panel method in sections with a blunt t e is to reduce the thickness near the t e without changing the camber as shown in fig 1 however this approximation brings in several problems first where to start reducing the thickness is totally empirical in fig 1 the location is selected as 90 of the chord length whether this value affects the predicted propeller forces and pressure distributions or not requires further justification second it is hard to find the exact location of the t e if it is not sharp and because of that the modified geometry might end up with an unsmooth shape near the t e between sections after the thickness is reduced third modifying the geometry might affect the accuracy of the boundary element method since the panels are changed physically a more rational approach is to represent the flow separation downstream of the blunt t e by an extension du and kinnas 2019a developed a flow separation model for hydrofoils and propeller ducts with blunt t e sections this model can be summarized as it is assumed that the pressure in the boundary layer separation region is constant as indicated by rans simulations this assumption is enforced by the conditions of zero lift and zero moment over the extension zone the location of the last point of the extension is determined by the conditions above via a numerical scheme solved by the newton raphson method the starting points of the extension on both sides are determined in an iterative manner by requiring the friction coefficients to be equal to zero at those points it was found that the pressure distributions and skin frictions along the hydrofoils and ducts correlate well with those from solving the reynolds averaged navier stokes rans equations and the thrust and torque of the ducted propeller agree much better with the experimental measurements when the extension is determined from this model compared to the case where the t e section is extended to a randomly selected location in this paper du and kinnas s 2019a model is extended from two dimensional 2d to three dimensional 3d and applied to a 4 blade open propeller with a blunt trailing edge the flow is assumed to be incompressible fully wetted and steady i e without any cavitation or vortex shedding only the mean flow is considered to make conclusions from the presented method applicable to full scale propellers the flow is assumed to be fully turbulent in the vii method the laminar to turbulent flow transition points are forced at locations 1 of the chord length from the leading edge and correspondingly results are compared with those from rans simulations of fully turbulent flow the propeller is cut into strips with constant radii and a series of hydrofoils with blunt t e s are obtained on the cylindrical surfaces each hydrofoil is extended to a sharp t e section on the cylindrical surface and the extended hydrofoil sections are used to create a propeller geometry with a sharp trailing edge a numerical scheme is established in this study to find the shape of the flow separation zone in this scheme it is assumed that there is no net force or moment in the extension zone i e the criteria of zero local lifts and zero local moments over the extension the local lifts and local moments are based on the inviscid pressure distributions predicted by a low order panel method with a fast wake alignment scheme i e the psf 2 type alignment greeley and kerwin 1982 the shape of the flow separation zone is controlled by a few parameters which are the unknowns to be solved in the presented model either by a newton raphson method or as an optimization problem after the extension is found within a certain tolerance the propeller with a sharp t e is solved in the panel method using a pseudo unsteady wake alignment scheme full wake alignment scheme or fwa tian and kinnas 2012 coupled with a boundary layer solver to obtain the viscous pressure distributions and forces it should be noted that the presented method is only applicable to propellers working under a moderate loading condition where the boundary layer separation is expected to be locally downstream of the blunt trailing edge the unsteadiness caused by propellers working under extreme off design conditions where the leading edge separation occurs is beyond the scope of this method however as shown later in the paper the predicted open water characteristics from the presented method agree well with the experimental measurements over a large range of advance ratios in the case of a controllable pitch propeller cpp with three different pitches the pressure distributions of different blade sections predicted from this model are compared with those from the rans simulations with very fine meshes downstream of the blunt t e to capture the flow separation the open water characteristics are validated with the experimental measurements and the computational efficiency of this method is summarized 2 methodology 2 1 the reynolds averaged navier stokes method in the rans method the velocity field u i is decomposed into its mean u i and the fluctuation u i reynolds 1894 as 1 u i u i u i the governing equations in the rans method are the continuity equation and the momentum equations as 2 u 0 and 3 u i t u j u i x j p x i x j ν u i x j u i u j where p is the pressure ν the kinematic viscosity and u i u j the reynolds stress in this study the pressure distributions from the flow separation model are compared with those from the rans simulations by using the commercial computational fluid dynamics cfd software star ccm siemens 2018 the flow is assumed to be steady incompressible and fully turbulent in the rans simulations the spalart allmaras turbulence model is used spalart and allmaras 1992 and the residuals for the continuity and momentum equations are set as 1 0 1 0 6 the far field boundary conditions are velocity inlet and pressure outlet as shown in fig 2 uniform inflow is used in the rans simulation and the periodic boundary condition is used so that only one blade needs to be modeled the radius of the computational domain is 5 r where r is the propeller radius the distance from the upstream velocity inlet to the propeller plane is 5 4 r and the distance from the propeller plane to the downstream pressure outlet is 10 4 r in the rans simulation polyhedral meshes are used with 30 prism layers to model the boundary layer region a grid independence study is shown in table 1 with different numbers of cells used the advance ratio in this grid independent study is 0 579 and the pitch to diameter ratio p d of this cpp is 0 87 in this paper all the pitch to diameter ratios are defined by the pitch at 70 of the blade radius the advance ratio is defined as 4 j s v s n d where v s is the ship speed n the propeller rotational frequency and d the propeller diameter the propeller thrust coefficient is defined as 5 k t t ρ n 2 d 4 and the torque coefficient is defined as 6 k q q ρ n 2 d 5 where t is the propeller thrust q the propeller torque and ρ the fluid density the differences between the predicted forces in case 1 and case 2 are within 0 5 which shows that the number of cells used in case 2 is large enough in this paper all the results predicted from the rans simulations are from using the meshes in case 2 to model the flow separation in the rans method very fine grids are needed near the blade surface and in the wake region as shown in fig 3 however o grids must be used for blade sections with a blunt t e which means that only a short part of the trailing wake can be modeled with fine enough grids as opposed to blade sections with a sharp t e where c grids can be used which allow for a longer part of the trailing wake to be modeled with fine grids 2 2 the viscous inviscid interaction vii method in the panel method the total flow velocity q is decomposed into an incoming flow q i n and a propeller induced flow u i n v the perturbation velocity 7 q q i n u i n v u i n v can be treated as the potential flow which is governed by the laplace s equation 8 u i n v ϕ and 2 ϕ 0 where ϕ is the perturbation potential the kutta condition is required which means the velocity must remain finite 9 ϕ at the trailing edge by using the green s identity 8 can be written in the boundary integral form 10 2 π ϕ p s h ϕ p g p p n p g p p ϕ p n p d s s w δ ϕ w g p p n p d s where s h is the surface of the propeller blade s w the surface of the trailing wake g the green s function which is defined as 1 r p p with r being the distance between the two points p and p the viscous effect can be considered by coupling the panel method with a boundary layer solver xfoil drela 1989 milewski 1997 hufford et al 1994 sun and kinnas 2008 kinnas et al 2012 known as the viscous inviscid interaction method in 2d the viscous velocity on the i th panel is obtained by 11 u i v i s u i i n v j 1 n n w c i j σ j where u i i n v is the edge velocity on the i th panel n and n w the number of panels on s h and s w respectively c i j the source influence coefficient matrix and σ j the boundary layer source strength on the j th panel in 3d propellers flows it is assumed that the boundary layer growth in the spanwise direction is negligible compared with that in the chordwise direction so the 2d boundary layer equations are solved strip by strip the 3d influence coefficients are used and the effects of the boundary layer sources from other strips and blades are considered as given in kinnas et al 2012 applying the vii in a five blade propeller with a sharp t e propeller 5168 can be seen in du and kinnas 2019b where the vii method greatly improves the correlation of the predicted thrust and torque with the experimental data compared with the pure panel method without the boundary layer corrections 2 3 the 3d flow separation model 2 3 1 generating the extension from the original geometry in this paper the 3d flow separation model is applied to a 4 blade open propeller with a blunt t e as shown in fig 4 the x y z cartesian coordinate system in this study is shown in fig 5 a the origin of the coordinate system is placed on the propeller rotational axis the vii method cannot be applied directly to this propeller since it has a blunt t e so an extension is needed first m m cylindrical cuts are made from the blade root to the blade tip when i 1 the radius of the cut equals the hub radius and when i m m the radius of the cut equals the blade radius m r panels in the spanwise direction are generated and used in the panel method where m r m m 1 half cosine spacing is used so that more panels are concentrated near the blade tip where the gradient of the propeller loading with respect to the radius is expected to be high as shown in fig 5 b the intersection of a cylinder with a constant radius r and the blade surface is a hydrofoil with a blunt t e in the x r θ plane where x x r y 2 z 2 and θ t a n 1 y z on the cylindrical surface the hydrofoil is extended to a section with a sharp t e as shown in fig 6 define a local x y coordinate system in the x r θ plane with the origin placed at the hydrofoil leading edge and the y axis aligned with the hydrofoil s nose tail line the lengths in each section are non dimensionalized based on the chord length of this section so that the blunt t e hydrofoils are placed between 0 0 and 1 0 in the x y coordinate system the trailing edge of the extended section point c is located at x c y c where x c 1 0 shows how much the chord length is extended and y c is how far point c is moved in the direction perpendicular to the nose tail line of the original section as shown in fig 6 b full cosine spacing is used in the chordwise direction to concentrate more panels near the leading edge and trailing edge locations of point c in all sections are to be determined by the 3d flow separation model similar to the 2d flow separation model in du and kinnas 2019a the extension is built by 2nd order polynomials to ensure that both the geometry and the slope are continuous at point a and b it should be noted that the use of 2nd order polynomials is a numerical constraint on solving the location of point c if larger order polynomials were used the shape of the flow separation region zone would be more flexible and different chordwise locations for point c would be expected discussion of the unicity of the flow separation model s solution will be summarized in later sections after the results of solving the flow separation model are presented if the coordinates of points a b and c are given the extension is uniquely determined by solving the equation set 12 y c a 1 x c 2 b 1 x c c 1 y a a 1 x a 2 b 1 x a c 1 s l o p e a 2 a 1 x a b 1 y c a 2 x c 2 b 2 x c c 2 y b a 2 x b 2 b 2 x b c 2 s l o p e b 2 a 2 x b b 2 where x a y a x b y b x c and y c are coordinates of points a b and c and s l o p e a and s l o p e b are known from the original section the other parameters are the coefficients of the quadratic function and need to be solved in the 2d flow separation model du and kinnas 2019a point c is moved in both the horizontal and vertical direction by using the newton raphson method until both criteria of zero lift and zero moment are satisfied which is the inner loop of the scheme in the outer loop point a and b are moved along the surface of the foil until they overlap with the flow separation points where the skin friction c f is equal to zero with a certain tolerance ideally in the 3d flow separation model locations of point a b and c of all strips need to be determined in a similar way however this will introduce too many unknowns and more importantly the smoothness of the new t e cannot be guaranteed if the hydrofoils are extended independently section by section based on the experience from the 2d flow separation model locations of point a and b have a much weaker effect on the predicted pressure distribution and forces than the location of point c on the other hand as shown in fig 6 a the shape of the extension is almost unaffected by the location of point a and b unless they are very close to the t e of the original section which is unphysical in this study the location of point a and b are fixed at 93 of the chord length to guarantee the smoothness of the extended t e the x c and y c distributions are constructed using polynomials 13 x c r α 0 α 1 r α 2 r 2 α m r m y c r β 0 β 1 r β 2 r 2 β n r n where α 0 α 1 α m β 0 β 1 β n are coefficients in the least square method let l m n 2 these l parameters can uniquely determine the shape of the extension and are unknowns to be solved for in the 3d flow separation model the initial guess of the extension is obtained by assuming that curve ac and bc in all the sections in fig 6 are straight lines as shown in fig 7 2 3 2 model establishment define a vector x α 0 α 1 α m β 0 β 1 β n t with l elements given an initial propeller geometry with a blunt t e and a vector x a propeller with a sharp t e can be uniquely determined using eqs 12 and 13 similar to the 2d flow separation model it is assumed that there is no net force or moment in the extension zone i e the zero local lifts and zero local moments criteria the local lift and local moment over the extension in j th section is defined as 14 δ f j p r e s s u r e s u c t i o n i c p i δ x i p r e s s u r e s u c t i o n i δ x i δ r j δ m j p r e s s u r e s u c t i o n i c p i δ x i x i p r e s s u r e s u c t i o n i δ x i x i δ r j where δ r j is the length of the panel in the spanwise direction and c p the pressure coefficient defined as 15 c p i p i p 1 2 ρ n 2 d 2 where p is the pressure at far upstream and p i the pressure at the control point of the panel δ f and δ m represent the local lift and local moment but they are dimensionless quantities as δ x is nondimensionalized by the chord length of the section and δ r is nondimensionalized by the propeller radius r in the definition of δ f and δ m c p is multiplied by the panel length in both the chordwise direction and the spanwise direction because in this paper the full cosine spacing is used in the chordwise direction and the half cosine spacing is used in the spanwise direction as shown in figs 6 a and 7 a thus more panels are concentrated near the trailing edge and the blade tip to improve the accuracy of the panel method δ f and δ m are being normalized by setting the pressure coefficient equal to unity because in each section shorter extensions will intrinsically make the force and moment differences between the two sides smaller so if δ f and δ m are not being divided by the panel length in the chordwise direction the flow separation model tends to converge to smaller x c by using a low order panel method the pressure distribution at each strip is found since there are m r panels there are 2 m r local lifts and local moments for each extension define a vector g as g δ f 1 δ f 2 δ f m r δ m 1 δ m 2 δ m m r t the 3d flow separation model can be stated as find vector x so that all the elements in vector g are zero in this study two types of methods are proposed to find vector x that satisfies the criteria of zero local lifts and zero local moments over the extensions 2 3 3 newton raphson method to find the solution of the 3d flow separation model the 2d newton raphson method is first applied section by section to find x c i and y c i where i is the section index the derivatives are evaluated numerically using the finite difference method in this study an entire loop to find the extension of all sections is called one sweep at the end of each sweep the extension is smoothed using eq 13 a gauss seidel like scheme is used which means that the new values x c k 1 i and y c k 1 i are used as soon as they are known where k is the sweep index for example once we have found x c k 1 1 and y c k 1 1 these values are used in generating the extended geometry to find x c k 1 2 and y c k 1 2 in this study this scheme is applied from the blade tip section to the hub section the first sweep then from the hub section to the tip section the second sweep etc until all the values of x c and y c converge with a certain tolerance at the same time at the end of each sweep the extension is smoothed using eq 13 the newton raphson method described above was used in this study and successfully found the solution that satisfies the criteria of zero local lifts and zero local moments there were also some failed attempts of trying the newton raphson method to solve the 3d flow separation models as in du 2019 2 3 4 optimization methods the solution of the 3d flow separation model can also be found by regarding it as an optimization problem 16 m i n i m i z e g 0 x where g 0 g g is the norm of vector g and in this study the infinity norm is used i e g 0 g there are various approaches to find the solution to this optimization problem in later sections a brute force search method referred to as optimization method 1 brute force and a derivative free and unconstrained optimization solver newuoa powell 2006 referred to as optimization method 2 newuoa are used and their computational efficiencies are summarized in this paper the 3d flow separation model consists of two stages the first stage is to find the extension of the propeller that satisfies the zero local lifts and zero local moments criteria either by using the newton raphson method or solving as an optimization problem in this stage each propeller with a sharp t e is solved by the panel method with a fast wake alignment scheme the psf 2 type of alignment the boundary layer equations are not solved in this stage and the inviscid pressure is used to calculate the local lifts and local moments which greatly reduces the computational time and improves the stability of the numerical scheme after the extension is found the propeller is solved using the full wake alignment scheme more accurate but more time consuming coupled with the boundary layer solver as the second stage of the 3d flow separation model 3 results and discussions 3 1 the reynolds averaged navier stokes method the relative velocity magnitude contour plots at two sections with constant radii from the rans simulation are shown in fig 8 in this simulation j s 0 579 and the pitch to diameter ratio is 0 87 the velocity downstream of the blunt t e is low due to the flow separation the wall distance y for this simulation is shown in fig 9 the pressure distributions and the computational efficiency number of cpus and the computing time will be shown in later sections together with results from the 3d flow separation model 3 2 the 3d flow separation model 3 2 1 solving by the newton raphson method in fig 10 the x c and y c distributions of the extension found by the 3d flow separation model and solved by the newton raphson method are shown together with those from an arbitrary extension and the initial guess in the newton raphson method at the end of each sweep the x c and y c distributions are smoothed using the second and fifth order polynomials respectively as given in eq 13 the newton raphson method generally needs three to four sweeps to convergence in the arbitrary extension the x c distributions are the same as in the initial guess and the y c is set as zero in all sections as shown in fig 11 the local lifts and local moments in the arbitrary extension and in the initial guess are much larger than those in the extensions found by the 3d flow separation models as shown in table 2 the variations of the predicted thrust and torque from extensions found using different methods to solve the 3d flow separation model are within 1 while the initial guess over predicts both the thrust and torque by over 4 and the arbitrary extension under predicts both the thrust and torque by over 14 compared with the average k t and 10 k q of those found in the 3d flow separation model in table 2 the values of g 0 in the arbitrary extension the initial guess and the extensions found by the presented methods are listed the arbitrary extension and the initial guess have much higher g 0 values which shows that the criteria of zero local lifts and zero local moments are violated in these extensions and consequently the difference in the predicted forces are large compared with the average forces of the extensions found by the presented method which have significantly smaller g 0 values it is worth mentioning that because of the smoothing of the locations of point c it is not possible to find an extension of the t e that produces zero local lifts and zero local moments over the extension in all sections at the same time however as the local lifts and local moments become close to zero the predicted thrust and torque of the propeller will both converge as will be clearly shown in the results from solving the flow separation model using the brute force method 3 2 2 solving by the optimization methods optimization method 1 brute force the brute force search method is by no means an efficient algorithm and there are infinite number of extensions even if x c and y c distributions are approximated by eq 13 however some useful conclusions can be drawn in this method when testing a large number of extended geometries and correlating the predicted forces with the g 0 values in this study a second order polynomial 3 coefficients is used to approximate the x c distributions and a fifth order polynomial 6 coefficients is used for the y c distributions according to eq 13 these 9 coefficients are used as the input to generate the extensions in the brute force search method at the end of each round of the brute force search the coefficients corresponding to the smallest g 0 are used as the center point in the computing domain to generate extensions for the next round of search and the increments in these coefficients are reduced by half in each round of search each propeller geometry with a sharp trailing edge is solved independently in parallel using multiple cpus the brute force search ends when the k t and 10 k q converge to the same value with a small tolerance between two rounds of searches in total 40739 extensions are tested the k t and 10 k q values of all these extensions are shown in fig 12 plotted as a function of g 0 where one pair of points represent one extended geometry as shown in fig 12 the location of the t e has a strong effect on the forces of the propeller the converged k t i e the k t corresponding to the smallest g 0 is about 0 20 but the k t s of all extensions are in the range of 0 06 to 0 40 the converged 10 k q is about 0 29 but the 10 k q s of all extensions are in the range of 0 04 to 0 70 more importantly the differences between the forces of an extension and the converged forces almost increase linearly as g 0 becomes larger in most extensions at this advance ratio the largest g 0 is about 100 times bigger than the smallest g 0 for all the searched extensions to conclude it is critical to find the extension that the local lifts and local moments are as close to zero as possible otherwise the predicted forces can be very wrong the smallest g 0 in the extension found by the brute force method is shown in table 2 at such a small g 0 value it is found that the variations in k t and 10 k q are both within 1 the x c and y c distributions of the extension found by the brute force method are shown in fig 10 and the local lift and local moment distributions are shown in fig 11 optimization method 2 newuoa a derivative free and unconstrained optimization solver newuoa powell 2006 is used to solve the 3d flow separation model at j s 0 579 the x c and y c distributions are approximated by second and fifth order polynomial respectively so the number of unknowns is 9 in the solver the stopping criterion in the optimization method is that the maximum change in these unknowns are smaller than a predefined tolerance 10 4 between two iterations i e the shape of the flow separation zone converges only 90 extensions are tested before the stopping criterion is satisfied a significant reduction compared with the brute force search method optimization method 2 newuoa cannot be applied in parallel not like the brute force search method however the cpu time is greatly reduced as shown in table 3 the x c and y c distributions of the extension found in this method are shown in fig 10 and the local lift and local moment distributions are shown in fig 11 the propellers loadings in the arbitrary extension the initial guess and the extensions found by different methods in the 3d flow separation models are shown in fig 13 the x c and y c distributions and the propeller loadings of the extensions found by different methods show a lot of similarities compared with those in the arbitrary extension and the initial guess the local lifts and local moments distributions from the extensions found by the presented method are much closer to zero and consequently the predicted thrust and torque are very close as indicated by table 2 and fig 12 3 2 3 the pressure distributions and open water characteristics after the extension is found by the 3d flow separation model using the optimization solver newuoa the propeller is solved using the full wake alignment scheme tian and kinnas 2012 coupled with the boundary layer solver xfoil drela 1989 milewski 1997 hufford et al 1994 sun and kinnas 2008 kinnas et al 2012 to find the viscous pressure distributions at j s 0 579 as shown in fig 14 in these simulations the pitch to diameter ratio of this cpp is 0 87 compared with results from the 2d flow separation model in du and kinnas 2019a the correlation with the rans method is not as good that is because predicting the three dimensional flow separations for propellers with a blunt t e is much more challenging than predicting the flow separations in two dimensional for hydrofoils and propeller ducts with an increased number of unknowns and more complexity in the model the open water characteristics of the blunt t e controllable pitch propeller from the presented method are compared with the experimental measurements at three different pitch to diameter ratios 0 6 0 75 and 0 9 as shown in fig 15 at each advance ratio the reynolds number in the vii method are calculated based on advance speed and the temperature in the experiment for all these propeller pitches a good agreement with the experiment at all advance ratios are observed which shows the robustness of the present method 3 2 4 summary of the computational efficiency compared with the rans method the 3d flow separation model in general does not require as many computational resources and takes a much shorter time in the calculation not to mention the time for pre processing and post processing the only exception is solving the 3d flow separation model by using the brute force method which is not recommended an overall comparison of the computational efficiency of different methods is shown in table 3 all the simulations were done on the clusters of the texas advanced computing center using an intel xeon e5 2680 2 7 ghz processor in the rans method only the simulation time was counted in the 3d flow separation model the first stage is labeled as sweep if the newton raphson method was used and labeled as search if the optimization method was used the second stage is labeled as fwa bl full wake alignment with boundary layer corrections 3 2 5 the unicity of the solution the solution for the point c locations is not unique this can be explained in a simplified manner as follows consider the two dimensional potential flow over a camber line including the streamline going downstream from the stagnation point at the t e if we try to extend the camber line behind the t e with zero lifts and moments we have for each possible chordwise x c location a y c solution that is precisely the y c located just on the stagnation streamline at x c the shape for the solution of the extended camber line would be then that of the initial stagnation streamline up to x c however the solution of the camber line problem will not depend on the x c value chosen since the boundary conditions are untouched with that choice of extension in a three dimensional propeller problem as shown in fig 10 the solution of the flow separation model is not unique neither even with some approximations in this study these approximations include i in each section shapes of curve ac and bc shown in fig 6 are approximated by 2nd order polynomials to ensure that both the geometry and the slope are continuous where the extension merges with the original sections ii when the flow separation model is solved by the newton raphson method at the end of each sweep the x c and y c distributions are smoothed using the second and fifth order polynomials respectively and in the optimization methods the same polynomial orders are used to approximate the x c and y c distributions these approximations constrain the shape of the flow separation region but also greatly reduce the number of unknowns to be solved an improvement of the model using higher orders of polynomials for curve ac and bc and the x c and y c distributions can be a future work of this study as shown in fig 13 and table 2 different numerical schemes in this study predict the extensions of the t e that have very similar propeller loading and forces even though the solutions are not the same fig 12 further proves that under the constraints in this study if the local lifts and local moments become closer to zero both the predicted thrust and torque will converge to finite values more importantly propeller forces from the extensions found by the presented schemes correlate well with the experimental data under a large range of advance ratios with different propeller pitches the authors fully acknowledge that there might exist some extension shapes with smaller local lifts and local moments that the presented schemes fail to find however the variations in the predicted propeller forces are within about 0 5 if the shape of the extension is found by the proposed schemes much smaller than the case that the extension shapes are determined arbitrarily as shown in table 2 to conclude with our proposed schemes and the approximations of the polynomials we try to solve the flow problem for propellers with blunt t e by reaching one possible solution for the shape of the extension that the local lifts and local moments are equal to zero with a certain tolerance not to find all the possible solutions 4 conclusions in this paper a 3d flow separation model is proposed so that the viscous inviscid interaction method can be applied to predict the flows around open propellers with a blunt t e it is assumed that there is no net force or moment in the extension zone and the criteria of zero local lifts and zero local moments over the extension in all blade sections are established different methods are proposed to solve this model including a newton raphson method and two optimization methods after the extension is found the propeller is solved in the viscous inviscid interaction method which couples a panel method with a boundary layer solver and the full wake alignment scheme is used to more accurately predict the location of the trailing wake the flow separation zones found by different methods proposed in this study show lot of similarities and the predicted propeller circulation distributions and forces are very close with each other even though the solutions are not unique from this study it is also found that when the local lifts and local moments over the extension are close to zero i e when the criteria in the 3d flow separation model are satisfied the predicted thrust and torque converge to the same value even the extensions are found using completely different methods however when the criteria are not satisfied the predicted forces might be very different in other words it is critical to find the extensions that satisfy the zero local lifts and zero local moments criteria and different methods in the 3d flow separation model in this paper can effectively achieve this goal compared with the rans method the 3d flow separation model requires much shorter computational time and significantly fewer computational resources not to mention the time for pre processing and post processing pressure distributions from the presented method correlate well with those from the rans simulations open water characteristics from the presented method agree well with the experimental measurements of a controllable pitch propeller at a wide range of advance ratios and with three different pitches to conclude the 3d flow separation model is robust and reliable and thus can be a useful tool in designing and analyzing open propellers with blunt trailing edge credit authorship contribution statement weikang du conceptualization methodology software validation writing original draft writing review editing visualization spyros a kinnas supervision resources writing review editing project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments support for this research was provided by the us office of naval research grant number n00014 14 1 0303 and n00014 18 1 2276 dr ki han kim partly by phase viii of the consortium on cavitation performance of high speed propulsors 
20666,this paper presents a distributed event driven adaptive formation control strategy for networked uncertain nonlinear autonomous underwater vehicles auvs in three dimensional space it is assumed that the leader information is only transmitted to a subset of auv followers under a directed graph and the nonlinearities of the auv dynamics are unknown a distributed error transformation method is presented to address the distributed formation tracking problem of auv followers in three dimensional space then a distributed event driven adaptive control method using neural networks and stabilizing auxiliary signals is developed to ensure the stability of the event driven closed loop system and accomplish three dimensional formation tracking in the lyapunov stability sense additionally it is shown that zeno behavior does not occur in the resulting event triggering strategy a simulation demonstrates the effectiveness of the proposed theoretical methodology keywords event driven tracking distributed formation three dimensional space neural networks autonomous underwater vehicles auvs 1 introduction the motion control of nonlinear autonomous underwater vehicles auvs has been widely studied because of the underactuated dynamics and practical applications of these vehicles such as search exploration reconnaissance ocean floor surveying geological sampling and oceanographic mapping see yuh 2000 bellingham and rajan 2007 farrell et al 2003 peymani and fossen 2015 sahoo et al 2019 gao et al 2021 braginsky et al 2020 and the references therein in cho et al 2020 taha and mohamed 2017 shen et al 2018 li et al 2019b and lapierre and soetanto 2017 auv models with three degrees of freedom dof corresponding to surge sway and yaw motions were only considered for motion control in two dimensional space some motion control problems of auvs in three dimensional space have been investigated in rezazadegan et al 2015 an adaptive trajectory tracking controller was designed for auvs with model uncertainties fuzzy based path following for uncertain auvs with unknown environmental disturbances was considered in yu et al 2017 in elhaki and shojaei 2018 a neural network based prescribed performance control approach was presented for 5 dof auvs a current observer based control method was developed for trajectory tracking of 5 dof auvs in the presence of ocean currents liang et al 2018 in wang et al 2018 a path following control design using neural networks was presented for uncertain auvs with external disturbances in shojaei 2019 a three dimensional neural network tracking control method was presented for target tracking of uncertain auvs however in rezazadegan et al 2015 elhaki and shojaei 2018 yu et al 2017 liang et al 2018 wang et al 2018 shojaei 2019 roll motion was ignored and 5 dof auv models were considered for 6 dof auvs with roll motion a nonlinear trajectory tracker using the desired body fixed velocities was developed in li et al 2015 where model uncertainties were not considered an adaptive control strategy with prescribed performance was established for uncertain 6 dof auvs kim and yoo 2021 in yan et al 2019 an adaptive fuzzy sliding mode control design was developed for uncertain 6 dof auvs based on these motion control methods for single auvs formation control approaches were recently proposed for multiple auvs in three dimensional space in cao and guo 2019 a leader follower formation control scheme was designed for a target hunting problem of multiple auvs at the kinematic level a fixed time leader follower formation control problem using the triggered leader signal was investigated for multiple auvs without uncertainties gao and guo 2018 in bian and xiang 2019 a leader follower formation tracker using the sliding mode and backstepping techniques was designed for the three dimensional coordination control of multiple auvs an impulsive design approach for formation control of networked auvs was studied in hu et al 2015 despite these theoretical advances previous formation control methods cao and guo 2019 gao and guo 2018 bian and xiang 2019 hu et al 2015 have the following restrictions for more theoretical improvement r1 in the previous formation approaches cao and guo 2019 gao and guo 2018 bian and xiang 2019 hu et al 2015 the model uncertainties of multiple auvs were not considered all nonlinear functions of the auv dynamics were assumed to be known for more practical applications model uncertainties in the nonlinear dynamics of multiple underactuated auvs should be considered for the formation controller design r2 in the leader follower formation methods cao and guo 2019 gao and guo 2018 bian and xiang 2019 all followers should obtain the leader position information in hu et al 2015 a graph theoretic distributed formation control design was presented but the conditions for selecting stable local control gains depend on the laplacian matrix that is global information thus the aforementioned results cao and guo 2019 gao and guo 2018 bian and xiang 2019 hu et al 2015 cannot be applied to the distributed three dimensional formation control problem of multiple auvs with leader follower communication limitations r3 although triggered leader communication information was used in gao and guo 2018 the formation control laws in cao and guo 2019 gao and guo 2018 bian and xiang 2019 and hu et al 2015 should be continuously updated every sampling time therefore the distributed formation control problem under limited network bandwidths cannot be solved via the previous results cao and guo 2019 gao and guo 2018 bian and xiang 2019 hu et al 2015 it is significant to establish a graph theoretic distributed event driven control strategy for the three dimensional formation control of multiple underactuated auvs with model uncertainties and limited network resources motivated by these observations the aim of this paper is to present a distributed adaptive event driven formation tracking methodology for multiple uncertain nonlinear auvs in three dimensional space the 6 dof kinematics and dynamics of the auv followers are considered in a directed communication network a distributed recursive design strategy using stabilizing auxiliary signals and neural networks is developed to deal with the underactuated dynamics in the three dimensional formation tracker design furthermore a local triggering condition for the local tracker of each auv follower is constructed to intermittently transmit the local control input the stability of the overall closed loop system and the existence of minimum inter event time are mathematically analyzed to the best of our knowledge this is the first study in the three dimensional formation control field of multiple auvs the remainder of this paper is organized as follows in section 2 the 6 dof kinematics and dynamics of networked uncertain auvs are introduced and the three dimensional formation tracking problem is formulated a distributed event driven three dimensional formation tracking strategy is derived in section 3 1 and the stability of the overall closed loop signals is analyzed in section 3 2 in section 4 simulation results are given finally conclusions are provided in section 5 2 problem formulation a group consisting of n networked auv followers and a leader is considered in this paper fig 1 illustrates the distributed formation tracking problem of the networked multiple auvs under a directed communication graph and the detailed structure of the neutrally buoyant i th auv where the followers are labeled as agents 1 n and the leader is labeled as agent 0 each auv model is composed of a rigid body a single propeller and moment actuators for adjusting pitch and yaw the motion of each auv is described by an inertial reference and a body fixed frame where the origin b i of the body fixed frame is placed at the center of gravity of the vehicle the network communication of the n auv followers and the leader auv is depicted by a directed graph g a u with the set a 0 1 n of vertices and the set u a a of edges the neighbor set of vertex i is represented by n i j j i u that is the set of vertices with edges incoming to vertex i for network communication among the n auv followers the subgraph g a u is defined with a 1 n and u a a h h i j r n n is the adjacent matrix for g where h i j 0 when j i u h i j 0 otherwise and h i i 0 the degree matrix is represented by a diagonal matrix b diag b 1 b n with b i j 1 j i n h i j i 1 n the non symmetric laplacian matrix m for g is m 0 0 1 n s m s where s s 1 s n m b h r n n and s diag s 1 s n here s i 0 if leader 0 n i and s i 0 otherwise more details on graph theory can be found in wei and beard 2008 the kinematics of the i th auv follower is given by prestero 2001 and fossen 2011 1 η i ζ i r i 1 ζ i 0 3 3 0 3 3 r i 2 ζ i υ i ω i where i 1 n η i x i y i z i x i y i and z i denote the inertial positions of the center of gravity of the i th auv ζ i ϕ i θ i ψ i ϕ i θ i and ψ i are roll pitch and yaw angles respectively denoting the attitude of the i th auv υ i u i v i w i u i v i and w i denote the surge sway and heave velocities respectively ω i p i q i r i p i q i and r i represent the roll pitch and yaw angular velocities of the i th auv in the body fixed frame respectively 0 3 3 denote the 3 3 matrix with zero elements and the rotation matrices r i 1 ζ i and r i 2 ζ i are defined as r i 1 ζ i c θ i c ψ i s θ i c ψ i s ϕ i s ψ i c ϕ i s θ i c ψ i c ϕ i s ψ i s ϕ i c θ i s ψ i s θ i s ψ i s ϕ i c ψ i c ϕ i s θ i s ψ i c ϕ i c ψ i s ϕ i s θ i c θ i s ϕ i c θ i c ϕ i r i 2 ζ i 1 t θ i s ϕ i t θ i c ϕ i 0 c ϕ i s ϕ i 0 s ϕ i c θ i c ϕ i c θ i here s c and t denote sin cos and tan respectively the dynamics of the i th auv is represented by 2 m i υ i ω i c i υ i ω i g i ζ i τ i where m i m i 1 m i 2 m i 1 r 6 6 is the rigid body mass matrix of the i th auv m i 2 r 6 6 stands for the added mass matrix of the i th auv c i υ i ω i r 6 denotes a vector denoting the damping and coriolis terms of the i th auv g i ζ i r 6 is the function vector consisting of moments and forces using the buoyancy and the gravitation of the i th auv and τ i τ i x τ i y τ i z τ i k τ i m τ i n denotes a control input vector of the i th auv without loss of generality torpedo shape auvs models are selected for the multiple coordination control problem from the moving property using a thruster and rudders in the torpedo shape auvs the control input vector can be defined as τ i τ i x 0 0 0 τ i m τ i n bian and xiang 2019 in addition m i c i and g i are defined in appendix problem 1 for the multiple auv models 1 and 2 under a directed network our problem is to design distributed adaptive event driven formation controllers τ i for auv followers and their event triggering conditions so that the positions η i of the auv followers achieve the desired formation in three dimensional space assumption 1 the nonlinear function vectors c i υ i ω i and g i ζ i i 1 n are assumed to be unknown assumption 2 the position signal η 0 r 3 of the leader and its derivatives η 0 r 3 and η 0 r 3 are bounded and can be accessed by only a group of auv followers satisfying 0 n i i 1 n remark 1 in the previous three dimensional formation approaches using continuously updated control laws cao and guo 2019 gao and guo 2018 bian and xiang 2019 hu et al 2015 all nonlinearities in the auv dynamics were assumed to be known namely model uncertainties were not considered however this study considers unknown dynamic nonlinearities as stated in assumption 1 besides the distributed event triggered tracking problem under a directed graph is addressed for the desired three dimensional formation as stated in problem 1 3 distributed event driven three dimensional formation tracking strategy 3 1 distributed event driven tracker design in this section we develop a distributed event driven three dimensional formation tracker design using the error transformation and stabilizing auxiliary signals the recursive design procedure using the distributed dynamic surface technique yoo 2013 is derived as follows step 1 we define the following distributed three dimensional formation error surface 3 z i 1 j 1 n h i j η i η j o i j s i η i η 0 o i 0 where i 1 n and o i j and o i 0 denote the spacing offsets between the i th and j th auvs and between the i th auv and the leader auv respectively for the desired formation then the distributed error surface z i 1 for dealing with the underactuated dynamic property in the three dimensional space is transformed to 4 β i r i 1 1 ζ i z i 1 ρ i where ρ i ϱ i 0 0 is the radius of the error surface here ϱ i is a design constant that can be selected arbitrarily small and is relatively smaller than the length of the i th auv the derivative of β i is given by 5 β i r i 1 1 ζ i z i 1 r i 1 1 ζ i z i 1 r i 1 1 r i 1 β i ρ i r i 1 1 j 1 n h i j η i η j s i η i η 0 0 r i 2 3 1 ζ i ζ i r i 2 2 1 ζ i ζ i r i 2 3 1 ζ i ζ i 0 r i 2 1 1 ζ i ζ i r i 2 2 1 ζ i ζ i r i 2 1 1 ζ i ζ i 0 β i ρ i r i 1 1 j 1 n h i j η i η j s i η i η 0 where i 1 n and r i 2 l 1 is the l th row vector of the matrix r i 2 1 l 1 2 3 then by defining t i 0 r i 2 3 1 ζ i ζ i r i 2 2 1 ζ i ζ i r i 2 3 1 ζ i ζ i 0 r i 2 1 1 ζ i ζ i r i 2 2 1 ζ i ζ i r i 2 1 1 ζ i ζ i 0 0 r i q i r i 0 p i q i p i 0 5 becomes β i t i β i t i ρ i b i s i r i 1 1 η i r i 1 1 s i η 0 j 1 n h i j η j t i β i 0 r i q i r i 0 p i q i p i 0 ϱ i 0 0 b i s i u i v i w i 6 r i 1 1 s i η 0 j 1 n h i j η j t i β i χ i 0 0 0 0 ϱ i 0 ϱ i 0 u i q i r i χ i 0 v i w i r i 1 1 s i η 0 j 1 n h i j η j where i 1 n and χ i b i s i define the error surfaces u i e u i u i d q i e q i q i d and r i e r i r i d and the boundary layer error c i ν i ν i where ν i u i d q i d r i d with filtered virtual control laws u i d q i d and r i d and ν i u i d q i d r i d with virtual control laws u i d q i d and r i d here ν i is defined as the output of the first order low pass filter 7 ξ i ν i ν i ν i ν i 0 ν i 0 where ξ i is a small positive constant then we have 8 β i t i β i q i u i e q i e r i e u i d q i d r i d c i χ i 0 v i w i r i 1 1 s i η 0 j 1 n h i j η j where i 1 n and q i χ i 0 0 0 0 ϱ i 0 ϱ i 0 then to stabilize 8 the virtual control laws u i d q i d and r i d are selected as 9 u i d q i d r i d q i 1 κ i 1 β i χ i 0 v i w i r i 1 1 s i η 0 j 1 n h i j η j where i 1 n and κ i 1 diag κ i 1 1 κ i 1 2 κ i 1 3 with positive constants κ i 1 l l 1 3 here diag means the diagonal matrix by applying 9 to 8 β i 1 is given by 10 β i 1 t i β i κ i 1 β i q i u i e q i e r i e c i let us consider the lyapunov function v i 1 1 2 β i β i with i 1 n then owing to the skew symmetric property of t i the time derivative of v i 1 is obtained as 11 v i 1 β i κ i 1 β i β i q i u i e q i e r i e c i with i 1 n step 2 let us consider the dynamic equation 2 and the error surfaces z i 2 z i 2 1 z i 2 6 ϖ i d i where ϖ i υ i ω i and d i u i d α i 1 α i 2 α i 3 q i d r i d here α i 1 α i 2 and α i 3 are the stabilizing auxiliary signals designed in 21 using the dynamic equation 2 z i 2 is represented by 12 z i 2 m i 1 g i τ i d i where i 1 n and g i c i υ i ω i g i ζ i the nonlinear function vector g i is approximated by the function approximation technique using radial basis function neural networks rbfnns polycarpou 1996 then g i is given by 13 g i x i φ i φ i x i ϵ i where x i ϖ i ζ i ϒ is an input vector ϒ r 6 is a compact set φ i φ i 1 φ i n i is a gaussian function vector with node number n i φ i φ i 1 φ i 6 indicates the optimal weight matrix satisfying φ i f φ i with an unknown constant φ i 0 φ i l φ i l 1 φ i l n i l 1 6 f means the frobenius norm and ϵ i denotes a reconstruction error vector satisfying ϵ i ϵ i with an unknown constant ϵ i 0 the local event driven adaptive tracker τ i and its triggering condition are designed as 14 τ i t τ i t i a t t i a t i a 1 15 t i a 1 inf t t i a e i t a i 1 z i 2 t a i 2 where i 1 n t i a denotes the update time of the i th auv tracker with a z e i t τ i t τ i t z i 2 z i 2 1 z i 2 5 z i 2 6 u i e q i e r i e and a i 1 and a i 2 are positive design constants here 14 and 15 imply that the tracking laws τ i are set to τ i t i a for all t t i a t i a 1 and are updated at t i a 1 when e i a i 1 z i 2 a i 2 here the adaptive signals τ i τ i 1 0 0 0 τ i 5 τ i 6 are selected as 16 τ i 1 τ i 5 τ i 6 diag κ i 2 1 κ i 2 5 κ i 2 6 z i 2 d i 1 d i 5 d i 6 φ ˆ i 1 φ ˆ i 5 φ ˆ i 6 φ i ϵ ˆ i a i 2 tanh z i 2 ϑ i a i 1 z i 2 17 φ ˆ i ς i φ i z i 2 σ i 1 φ ˆ i 18 ϵ ˆ i ι i z i 2 tanh z i 2 ϑ i σ i 2 ϵ ˆ i where i 1 n κ i 2 1 0 κ i 2 5 0 and κ i 2 6 0 are design parameters d i d i 1 d i 6 m i d i φ ˆ i φ ˆ i 1 φ ˆ i 6 φ ˆ i f are estimates of φ i f f 1 6 tanh z i 2 ϑ i tanh z i 2 1 ϑ i tanh z i 2 6 ϑ i tanh z i 2 ϑ i tanh z i 2 1 ϑ i tanh z i 2 5 ϑ i tanh z i 2 6 ϑ i with positive constants ϑ i ϵ ˆ i are estimates of ϵ i ς i diag ς i 1 ς i n i ς i l 0 are constants with l 1 n i and ι i 0 σ i 1 0 and σ i 2 0 are design constants choose the second lyapunov function v i 2 as 19 v i 2 v i 1 1 2 z i 2 m i z i 2 1 2 t r φ i ς i 1 φ i 1 2 ι i ϵ 2 where i 1 n ϵ i ϵ i ϵ ˆ i t r indicates the trace of the matrix and φ i φ i φ ˆ i due to e i t i a 0 for a z the time derivative of v i 2 along 11 15 is obtained as 20 v i 2 β i κ i 1 β i β i q i z i 2 c i z i 2 φ i φ i ϵ i τ i z i 2 d i t r φ i ς i 1 φ ˆ i 1 ι i ϵ i ϵ ˆ i z i 2 a i 1 z i 2 a i 2 β i κ i 1 β i β i q i z i 2 c i z i 2 φ i φ i ϵ i τ i t r φ i ς i 1 φ ˆ i 1 ι i ϵ i ϵ ˆ i a i 1 z i 2 z i 2 z i 2 a i 2 z i 2 d i 1 0 0 0 d i 5 d i 6 z i 2 0 m i 1 u i d q i d r i d m i 2 α i 1 α i 2 α i 3 0 0 where m i 1 0 0 m i x i g y i r 0 m i x i g z i q 0 0 0 0 and m i 2 m i y i v 0 m i z i g 0 m i z i w m i y i g m i z i g m i y i g i i x x k i p here the stabilizing auxiliary signals α i 1 α i 2 and α i 3 are designed as α i 1 α i 2 α i 3 m i 2 1 diag κ i 2 2 κ i 2 3 κ i 2 4 z i 2 2 z i 2 3 z i 2 4 m i 1 u i d u i d ξ i q i d q i d ξ i r i d r i d ξ i 21 φ ˆ i 2 φ ˆ i 3 φ ˆ i 4 φ i ϵ ˆ i tanh z i 2 2 ϑ i tanh z i 2 3 ϑ i tanh z i 2 4 ϑ i where i 1 n and κ i 2 2 0 κ i 2 3 0 and κ i 2 4 0 are design parameters applying 16 and 21 into 20 yields 22 v i 2 β i κ i 1 β i z i 2 κ i 2 z i 2 β i q i z i 2 c i z i 2 φ i φ i t r φ i ς i 1 φ ˆ i z i 2 ϵ i ϵ ˆ i z i 2 tanh z i 2 ϑ i 1 ι i ϵ i ϵ ˆ i a i 2 z i 2 a i 2 z i 2 tanh z i 2 ϑ i where κ i 2 diag κ i 2 1 κ i 2 6 lemma 1 polycarpou 1996 0 z z tanh z ϑ 0 2785 ϑ is satisfied where any positive constant ϑ and z r from lemma 1 substituting 17 and 18 to 22 yields 23 v i 2 β i κ i 1 β i β i q i z i 2 c i z i 2 κ i 2 z i 2 σ i 1 t r φ i φ ˆ i σ i 2 ϵ i ϵ ˆ i 1 671 ϵ i 1 ϑ i 0 8355 a i 2 ϑ i remark 2 to deal with the underactuated dynamics 2 the local stabilizing auxiliary signals α i 1 α i 2 and α i 3 are designed as 21 owing to these stabilizing reference signals the 6 dof dynamics 2 can be controlled by τ i x τ i m and τ i n furthermore different from cao and guo 2019 gao and guo 2018 bian and xiang 2019 and hu et al 2015 the event triggering conditions 15 for the distributed formation tracker are derived for the intermittent update of the local control inputs 14 3 2 stability analysis the main result of this study is presented as follows theorem 1 let us consider the model i e 1 and 2 of the networked multiple auv followers and assume that the leader has directed paths to all auv followers for initial conditions satisfying v 0 δ with a constant δ 0 the adaptive event driven formation tracker 14 with local triggering laws 15 ensures that i all signals of the closed loop system are semi globally uniformly ultimately bounded ii lim t η 1 n η 0 o ε iii the inter event times satisfy t i a 1 t i a t i where i 1 n η η 1 η n the kronecker product is defined as o o 1 0 o n 0 1 n is an n vector of all ones ε 0 is a small constant that can be reduced arbitrarily and t i is the minimum inter execution time proof we define the lyapunov function v i 1 n v i 2 c i c i 2 substituting 23 into v gives v i 1 n β i κ i 1 β i z i 2 κ i 2 z i 2 1 ξ i c i c i β i q i z i 2 c i 24 c i λ i σ i 1 t r φ i φ ˆ i σ i 2 ϵ i 2 σ i 2 ϵ i ϵ i 1 671 ϵ i 1 ϑ i 0 8355 a i 2 ϑ i where λ i z i 1 z i 2 c i z j 1 z j 2 c j φ ˆ j ϵ ˆ j ω 0 q i 1 κ i 1 β i χ i 0 v i w i r i 1 1 s i η 0 j 1 n h i j η j r i 1 1 s i η 0 j 1 n h i j η j with ω 0 η 0 η 0 η 0 using the following inequalities β i q i z i 2 c i β i 2 q i 2 2 z i 2 2 c i 2 t r φ i φ ˆ i φ i f 2 2 φ i 2 2 ϵ i ϵ i ϵ i 2 2 ϵ i 2 2 and c i λ i c i 2 λ i 2 2 λ i λ i 2 with constants λ i 0 and owing to z i 2 2 z i 2 2 we obtain 25 v i 1 n β i κ i 1 β i z i 2 κ i 2 z i 2 c i 2 ξ i c i 2 z i 2 2 β i 2 q i 2 2 c i 2 λ i 2 2 λ i σ i 1 2 φ i f 2 σ i 2 2 ϵ i 2 u where u i 1 n σ i 1 2 φ i 2 σ i 2 2 ϵ i 2 λ i 2 1 671 ϵ i 1 ϑ i 0 8355 a i 2 ϑ i by defining compact sets π i β i β i z i 2 m i z i 2 c i c i l n i β l β l z l 2 m l z l 2 c l c l t r φ l ς l 1 φ l 1 ι l ε l 2 2 δ i 1 n and ξ η 0 η 0 η 0 η 0 η 0 η 0 ω 0 with a constants ω 0 0 we know that there exists a constant λ i such that λ i λ i on π i ξ then by selecting the design parameters as κ i 1 q i 2 2 κ i 1 i 3 3 κ i 2 1 κ i 2 i 6 6 and 1 ξ i ξ i λ i 2 2 λ i 1 with constants κ i 1 0 κ i 2 0 ξ i 0 and identity matrices i 3 3 and i 6 6 25 is represented by 26 v γ v i 1 n 1 λ i 2 λ i 2 c i λ i 2 2 λ i u where γ min i 1 n 2 κ i 1 2 κ i 2 2 ξ i σ i 1 ς i m i n σ i 2 ι i here ς i m i n represent the minimum eigenvalues of ς i owing to λ i λ i on v δ we have v γ v u on v δ then v 0 on v δ when γ u δ and thus v δ is an invariant set the semi global uniform ultimate boundedness of all closed loop signals is guaranteed theorem 1 i furthermore v t e γ t v 0 u γ 1 e γ t and 1 2 β 2 v t imply that lim t β 2 u γ here β is represented by β r i m s i η 1 n η 0 o ρ where r i diag r 1 1 r n 1 and ρ ρ 1 ρ n since m s is invertible it is ensured that lim t η 1 n η 0 o ε where ε 2 u γ ρ m s i 1 r i 1 as 2 u γ and ρ can be kept arbitrarily small by adjusting the design parameters ε can also be reduced arbitrarily small theorem 1 ii to prevent zeno behavior let us show that there exists a minimum inter event time t i such that t i a 1 t i a t i for a z for all t t i a t i a 1 e i t is d d t e i d d t e i e i 1 2 e i e i e i d d t τ i where d d t τ i τ i 1 0 0 0 τ i 5 τ i 6 τ i 1 τ i 5 and τ i 6 are represented by 27 τ i 1 τ i 5 τ i 6 diag κ i 2 1 κ i 2 5 κ i 2 6 z i 2 d i 1 d i 5 d i 6 φ ˆ i 1 φ ˆ i 5 φ ˆ i 6 φ i φ ˆ i 1 φ ˆ i 5 φ ˆ i 6 φ i ϵ ˆ i a i 2 1 tanh 2 z i 2 ϑ i z i 2 ϑ i ϵ ˆ i tanh z i 2 ϑ i a i 1 z i 2 as all the signals of the closed loop system are bounded there exists a constant γ i 0 such that d d t τ i γ i then by integrating d d t e i γ i during t t i a t i a 1 and using the triggering condition 15 we obtain t i a 1 t i a a i 1 z i 2 t a i 2 γ i a i 2 γ i t i theorem 1 iii 4 simulation examples as shown in fig 2 let us consider a group of auvs composed of a leader i e l and four auv followers i e f 1 f 4 represented by systems 1 and 2 under the directed network topology the system parameters are taken from prestero 2001 the leader signal is η 0 t 30 cos 0 15 t 30 sin 0 15 t 2 t and the initial positions of auv followers are η 1 0 45 5 5 η 2 0 60 10 10 η 3 0 41 1 6 and η 4 0 58 3 5 regarding the directed graph the connection parameters are selected as h 2 1 h 3 2 h 4 2 1 h 1 2 h 1 3 h 1 4 h 2 3 h 2 4 h 3 1 h 3 4 h 4 1 h 4 3 0 s 1 1 and s 2 s 3 s 4 0 the offsets for the desired formation are defined as o 1 0 3 3 0 o 2 1 6 6 0 o 3 2 3 3 0 and o 4 2 6 6 0 the control parameters of auv followers are selected as κ 1 1 diag 0 8 0 8 0 8 κ 2 1 diag 0 5 0 5 0 5 κ 3 1 diag 0 9 0 9 0 9 κ 4 1 diag 0 8 0 8 0 8 κ 1 2 diag 70 40 40 40 70 70 κ 2 2 diag 80 40 40 40 80 80 κ 3 2 diag 60 40 40 40 60 60 κ 4 2 diag 150 40 40 40 150 150 ς i l 10 σ 1 1 σ 2 1 σ 3 1 0 04 σ 4 1 0 03 σ 1 2 σ 2 2 σ 3 2 0 4 σ 4 2 0 05 ι i 10 ξ i 5 1 0 2 ϑ 1 1 0 3 ϑ 2 1 0 2 ϑ 3 0 0135 ϑ 4 0 0135 λ i 1 a 1 1 a 2 1 a 3 1 500 a 4 1 150 a 1 2 a 2 2 a 3 2 a 4 2 1 and ϱ 1 ϱ 2 ϱ 3 ϱ 4 0 1 where i 1 4 and l 1 n i the triggering law 15 is checked every the sampling time 0 005 s fig 3 shows the three dimensional formation control result fig 4 displays the formation tracking errors of each auv follower where z i 1 z i 1 1 z i 1 3 with i 1 4 in figs 3 and 4 the proposed distributed formation controller can achieve three dimensional formation tracking of networked 6 dof auvs the outputs of the rbfnns used in auv followers are shown in fig 5 in fig 5 the rbfnn outputs φ ˆ i φ i i 1 4 of auv followers are provided to compensate for the effects of the unknown nonlinear functions g i of the dynamics of auv followers the control inputs for each auv follower are shown in figs 6 9 in figs 6 9 we can see that the underactuated control inputs τ i x τ i m and τ i n i 1 4 of auv followers are intermittently and asynchronously updated by the local event triggering conditions 15 the inter event times for each local event triggered tracker are depicted in fig 10 the number of total events for each local event triggered tracker is 2981 for f 1 2873 for f 2 2858 for f 3 and 3002 for f 4 thus the required data for implementing each local tracker are 24 84 23 94 23 81 and 25 01 of the total sampled data 12000 in 60 sec it can be concluded that the intermittently updated local control laws lead to successful three dimensional formation tracking in the presence of unknown nonlinearities of networked 6 dof auvs 5 conclusion we have presented a distributed event driven adaptive three dimensional formation tracking strategy for networked uncertain 6 dof auvs with unknown nonlinearities the distributed nonlinear error surface using the rotation matrix has been defined to deal with the underactuated dynamic property of multiple auvs under a directed network the distributed recursive design using stabilizing auxiliary signals and neural networks has been developed to achieve adaptive event driven formation tracking while ensuring the stability of the overall closed loop system in the formation tracking scheme event triggering conditions for the distributed formation tracker have been derived for the intermittent update of the local underactuated control inputs furthermore the exclusion of zeno behavior in the proposed event triggering mechanism has been analyzed finally a simulation result has been provided to verify the effectiveness of the proposed control strategy further extensions to the output feedback formation tracking problem and the practical implementation of the proposed approach and applications such as biomimetic flexible fishtail robots li et al 2019a are conceivable they remain to be meaningful subjects for future research credit authorship contribution statement jin hoe kim software writing original draft sung jin yoo conceptualization methodology software validation investigation supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research was supported by the national research foundation of korea nrf grant funded by the korea government nrf 2019r1a2c1004898 all authors have seen and approved the final version of the manuscript being submitted appendix the matrices m i 1 and m i 2 and the vectors g i ζ i and c i v i ω i of the dynamics 2 are defined as prestero 2001 m i 1 m i 0 0 0 m i z i g m i y i g 0 m i 0 m i z i g 0 m i x i g 0 0 m i m i y i g m i x i g 0 0 m i z i g m i y i g i i x x 0 0 m i z i g 0 m i x i g 0 i i y y 0 m i y i g m i x i g 0 0 0 i i z z m i 2 x i u 0 0 0 0 0 0 y i v 0 0 0 y i r 0 0 z i w 0 z i q 0 0 0 0 k i p 0 0 0 0 m i w 0 m i q 0 0 n i v 0 0 0 n i r g i ζ i w i f i s θ i w i f i c θ i s ϕ i w i f i c θ i c ϕ i y i g w i y i b f i c θ i c ϕ i z i g w i z i b f i c θ i s ϕ i z i g w i z i b f i s θ i x i g w i x i b f i c θ i c ϕ i x i g w i x i b f i c θ i s ϕ i y i g w i y i b f i s θ i c i υ i ω i c i 1 c i 6 c i 1 x i u u u i u i x i w q m i w i q i x i q q m i x i g q i 2 x i v r m i v i r i x i r r m i x i g r i 2 m i y i g p i q i m i z i g p i r i c i 2 y i v v v i v i y i r r r i r i m i y i g r i 2 y i u r m i u i r i y i u v u i v i y i w p m i w i p i y i p q m i x i g p i q i m i y i g p i 2 m i z i g q i r i c i 3 z i w w w i w i z i q q q i q i z i u q m i u i q i z i v p m i v i p i z i r p m i x i g r i p i z i u w u i w i m i z i g p i 2 q i 2 m i y i g r i q i c i 4 k i p p p i p i i i z z i i y y q i r i m i y i g u i q i v i p i m i z i g w i p i u i r i c i 5 m i w w w i w i m i q q q i q i m i u q m i x i g u i q i m i v p m i x i g v i p i m i r p i i x x i i z z r i p i m i z i g v i r i w i q i m i u w u i w i c i 6 n i v v v i v i n i r r r i r i n i u r m i x i g u i r i n i w p m i x i g w i p i n i p q i i y y i i x x p i q i m i y i g v i r i w i q i n i u v u i v i where x i g y i g and z i g denote the center of gravity of the i th auv m i indicates the mass of the i th auv i i x x i i y y and i i z z denote the inertia tensors of the i th auv w i and f i are the vehicle weight and buoyancy of the i th auv respectively x i b y i b and z i b denotes the buoyancy center of the i th auv and x i y i z i m i and n i are the hydrodynamic coefficients of the i th auv for the detailed definitions see prestero 2001 and kim and yoo 2021 
20666,this paper presents a distributed event driven adaptive formation control strategy for networked uncertain nonlinear autonomous underwater vehicles auvs in three dimensional space it is assumed that the leader information is only transmitted to a subset of auv followers under a directed graph and the nonlinearities of the auv dynamics are unknown a distributed error transformation method is presented to address the distributed formation tracking problem of auv followers in three dimensional space then a distributed event driven adaptive control method using neural networks and stabilizing auxiliary signals is developed to ensure the stability of the event driven closed loop system and accomplish three dimensional formation tracking in the lyapunov stability sense additionally it is shown that zeno behavior does not occur in the resulting event triggering strategy a simulation demonstrates the effectiveness of the proposed theoretical methodology keywords event driven tracking distributed formation three dimensional space neural networks autonomous underwater vehicles auvs 1 introduction the motion control of nonlinear autonomous underwater vehicles auvs has been widely studied because of the underactuated dynamics and practical applications of these vehicles such as search exploration reconnaissance ocean floor surveying geological sampling and oceanographic mapping see yuh 2000 bellingham and rajan 2007 farrell et al 2003 peymani and fossen 2015 sahoo et al 2019 gao et al 2021 braginsky et al 2020 and the references therein in cho et al 2020 taha and mohamed 2017 shen et al 2018 li et al 2019b and lapierre and soetanto 2017 auv models with three degrees of freedom dof corresponding to surge sway and yaw motions were only considered for motion control in two dimensional space some motion control problems of auvs in three dimensional space have been investigated in rezazadegan et al 2015 an adaptive trajectory tracking controller was designed for auvs with model uncertainties fuzzy based path following for uncertain auvs with unknown environmental disturbances was considered in yu et al 2017 in elhaki and shojaei 2018 a neural network based prescribed performance control approach was presented for 5 dof auvs a current observer based control method was developed for trajectory tracking of 5 dof auvs in the presence of ocean currents liang et al 2018 in wang et al 2018 a path following control design using neural networks was presented for uncertain auvs with external disturbances in shojaei 2019 a three dimensional neural network tracking control method was presented for target tracking of uncertain auvs however in rezazadegan et al 2015 elhaki and shojaei 2018 yu et al 2017 liang et al 2018 wang et al 2018 shojaei 2019 roll motion was ignored and 5 dof auv models were considered for 6 dof auvs with roll motion a nonlinear trajectory tracker using the desired body fixed velocities was developed in li et al 2015 where model uncertainties were not considered an adaptive control strategy with prescribed performance was established for uncertain 6 dof auvs kim and yoo 2021 in yan et al 2019 an adaptive fuzzy sliding mode control design was developed for uncertain 6 dof auvs based on these motion control methods for single auvs formation control approaches were recently proposed for multiple auvs in three dimensional space in cao and guo 2019 a leader follower formation control scheme was designed for a target hunting problem of multiple auvs at the kinematic level a fixed time leader follower formation control problem using the triggered leader signal was investigated for multiple auvs without uncertainties gao and guo 2018 in bian and xiang 2019 a leader follower formation tracker using the sliding mode and backstepping techniques was designed for the three dimensional coordination control of multiple auvs an impulsive design approach for formation control of networked auvs was studied in hu et al 2015 despite these theoretical advances previous formation control methods cao and guo 2019 gao and guo 2018 bian and xiang 2019 hu et al 2015 have the following restrictions for more theoretical improvement r1 in the previous formation approaches cao and guo 2019 gao and guo 2018 bian and xiang 2019 hu et al 2015 the model uncertainties of multiple auvs were not considered all nonlinear functions of the auv dynamics were assumed to be known for more practical applications model uncertainties in the nonlinear dynamics of multiple underactuated auvs should be considered for the formation controller design r2 in the leader follower formation methods cao and guo 2019 gao and guo 2018 bian and xiang 2019 all followers should obtain the leader position information in hu et al 2015 a graph theoretic distributed formation control design was presented but the conditions for selecting stable local control gains depend on the laplacian matrix that is global information thus the aforementioned results cao and guo 2019 gao and guo 2018 bian and xiang 2019 hu et al 2015 cannot be applied to the distributed three dimensional formation control problem of multiple auvs with leader follower communication limitations r3 although triggered leader communication information was used in gao and guo 2018 the formation control laws in cao and guo 2019 gao and guo 2018 bian and xiang 2019 and hu et al 2015 should be continuously updated every sampling time therefore the distributed formation control problem under limited network bandwidths cannot be solved via the previous results cao and guo 2019 gao and guo 2018 bian and xiang 2019 hu et al 2015 it is significant to establish a graph theoretic distributed event driven control strategy for the three dimensional formation control of multiple underactuated auvs with model uncertainties and limited network resources motivated by these observations the aim of this paper is to present a distributed adaptive event driven formation tracking methodology for multiple uncertain nonlinear auvs in three dimensional space the 6 dof kinematics and dynamics of the auv followers are considered in a directed communication network a distributed recursive design strategy using stabilizing auxiliary signals and neural networks is developed to deal with the underactuated dynamics in the three dimensional formation tracker design furthermore a local triggering condition for the local tracker of each auv follower is constructed to intermittently transmit the local control input the stability of the overall closed loop system and the existence of minimum inter event time are mathematically analyzed to the best of our knowledge this is the first study in the three dimensional formation control field of multiple auvs the remainder of this paper is organized as follows in section 2 the 6 dof kinematics and dynamics of networked uncertain auvs are introduced and the three dimensional formation tracking problem is formulated a distributed event driven three dimensional formation tracking strategy is derived in section 3 1 and the stability of the overall closed loop signals is analyzed in section 3 2 in section 4 simulation results are given finally conclusions are provided in section 5 2 problem formulation a group consisting of n networked auv followers and a leader is considered in this paper fig 1 illustrates the distributed formation tracking problem of the networked multiple auvs under a directed communication graph and the detailed structure of the neutrally buoyant i th auv where the followers are labeled as agents 1 n and the leader is labeled as agent 0 each auv model is composed of a rigid body a single propeller and moment actuators for adjusting pitch and yaw the motion of each auv is described by an inertial reference and a body fixed frame where the origin b i of the body fixed frame is placed at the center of gravity of the vehicle the network communication of the n auv followers and the leader auv is depicted by a directed graph g a u with the set a 0 1 n of vertices and the set u a a of edges the neighbor set of vertex i is represented by n i j j i u that is the set of vertices with edges incoming to vertex i for network communication among the n auv followers the subgraph g a u is defined with a 1 n and u a a h h i j r n n is the adjacent matrix for g where h i j 0 when j i u h i j 0 otherwise and h i i 0 the degree matrix is represented by a diagonal matrix b diag b 1 b n with b i j 1 j i n h i j i 1 n the non symmetric laplacian matrix m for g is m 0 0 1 n s m s where s s 1 s n m b h r n n and s diag s 1 s n here s i 0 if leader 0 n i and s i 0 otherwise more details on graph theory can be found in wei and beard 2008 the kinematics of the i th auv follower is given by prestero 2001 and fossen 2011 1 η i ζ i r i 1 ζ i 0 3 3 0 3 3 r i 2 ζ i υ i ω i where i 1 n η i x i y i z i x i y i and z i denote the inertial positions of the center of gravity of the i th auv ζ i ϕ i θ i ψ i ϕ i θ i and ψ i are roll pitch and yaw angles respectively denoting the attitude of the i th auv υ i u i v i w i u i v i and w i denote the surge sway and heave velocities respectively ω i p i q i r i p i q i and r i represent the roll pitch and yaw angular velocities of the i th auv in the body fixed frame respectively 0 3 3 denote the 3 3 matrix with zero elements and the rotation matrices r i 1 ζ i and r i 2 ζ i are defined as r i 1 ζ i c θ i c ψ i s θ i c ψ i s ϕ i s ψ i c ϕ i s θ i c ψ i c ϕ i s ψ i s ϕ i c θ i s ψ i s θ i s ψ i s ϕ i c ψ i c ϕ i s θ i s ψ i c ϕ i c ψ i s ϕ i s θ i c θ i s ϕ i c θ i c ϕ i r i 2 ζ i 1 t θ i s ϕ i t θ i c ϕ i 0 c ϕ i s ϕ i 0 s ϕ i c θ i c ϕ i c θ i here s c and t denote sin cos and tan respectively the dynamics of the i th auv is represented by 2 m i υ i ω i c i υ i ω i g i ζ i τ i where m i m i 1 m i 2 m i 1 r 6 6 is the rigid body mass matrix of the i th auv m i 2 r 6 6 stands for the added mass matrix of the i th auv c i υ i ω i r 6 denotes a vector denoting the damping and coriolis terms of the i th auv g i ζ i r 6 is the function vector consisting of moments and forces using the buoyancy and the gravitation of the i th auv and τ i τ i x τ i y τ i z τ i k τ i m τ i n denotes a control input vector of the i th auv without loss of generality torpedo shape auvs models are selected for the multiple coordination control problem from the moving property using a thruster and rudders in the torpedo shape auvs the control input vector can be defined as τ i τ i x 0 0 0 τ i m τ i n bian and xiang 2019 in addition m i c i and g i are defined in appendix problem 1 for the multiple auv models 1 and 2 under a directed network our problem is to design distributed adaptive event driven formation controllers τ i for auv followers and their event triggering conditions so that the positions η i of the auv followers achieve the desired formation in three dimensional space assumption 1 the nonlinear function vectors c i υ i ω i and g i ζ i i 1 n are assumed to be unknown assumption 2 the position signal η 0 r 3 of the leader and its derivatives η 0 r 3 and η 0 r 3 are bounded and can be accessed by only a group of auv followers satisfying 0 n i i 1 n remark 1 in the previous three dimensional formation approaches using continuously updated control laws cao and guo 2019 gao and guo 2018 bian and xiang 2019 hu et al 2015 all nonlinearities in the auv dynamics were assumed to be known namely model uncertainties were not considered however this study considers unknown dynamic nonlinearities as stated in assumption 1 besides the distributed event triggered tracking problem under a directed graph is addressed for the desired three dimensional formation as stated in problem 1 3 distributed event driven three dimensional formation tracking strategy 3 1 distributed event driven tracker design in this section we develop a distributed event driven three dimensional formation tracker design using the error transformation and stabilizing auxiliary signals the recursive design procedure using the distributed dynamic surface technique yoo 2013 is derived as follows step 1 we define the following distributed three dimensional formation error surface 3 z i 1 j 1 n h i j η i η j o i j s i η i η 0 o i 0 where i 1 n and o i j and o i 0 denote the spacing offsets between the i th and j th auvs and between the i th auv and the leader auv respectively for the desired formation then the distributed error surface z i 1 for dealing with the underactuated dynamic property in the three dimensional space is transformed to 4 β i r i 1 1 ζ i z i 1 ρ i where ρ i ϱ i 0 0 is the radius of the error surface here ϱ i is a design constant that can be selected arbitrarily small and is relatively smaller than the length of the i th auv the derivative of β i is given by 5 β i r i 1 1 ζ i z i 1 r i 1 1 ζ i z i 1 r i 1 1 r i 1 β i ρ i r i 1 1 j 1 n h i j η i η j s i η i η 0 0 r i 2 3 1 ζ i ζ i r i 2 2 1 ζ i ζ i r i 2 3 1 ζ i ζ i 0 r i 2 1 1 ζ i ζ i r i 2 2 1 ζ i ζ i r i 2 1 1 ζ i ζ i 0 β i ρ i r i 1 1 j 1 n h i j η i η j s i η i η 0 where i 1 n and r i 2 l 1 is the l th row vector of the matrix r i 2 1 l 1 2 3 then by defining t i 0 r i 2 3 1 ζ i ζ i r i 2 2 1 ζ i ζ i r i 2 3 1 ζ i ζ i 0 r i 2 1 1 ζ i ζ i r i 2 2 1 ζ i ζ i r i 2 1 1 ζ i ζ i 0 0 r i q i r i 0 p i q i p i 0 5 becomes β i t i β i t i ρ i b i s i r i 1 1 η i r i 1 1 s i η 0 j 1 n h i j η j t i β i 0 r i q i r i 0 p i q i p i 0 ϱ i 0 0 b i s i u i v i w i 6 r i 1 1 s i η 0 j 1 n h i j η j t i β i χ i 0 0 0 0 ϱ i 0 ϱ i 0 u i q i r i χ i 0 v i w i r i 1 1 s i η 0 j 1 n h i j η j where i 1 n and χ i b i s i define the error surfaces u i e u i u i d q i e q i q i d and r i e r i r i d and the boundary layer error c i ν i ν i where ν i u i d q i d r i d with filtered virtual control laws u i d q i d and r i d and ν i u i d q i d r i d with virtual control laws u i d q i d and r i d here ν i is defined as the output of the first order low pass filter 7 ξ i ν i ν i ν i ν i 0 ν i 0 where ξ i is a small positive constant then we have 8 β i t i β i q i u i e q i e r i e u i d q i d r i d c i χ i 0 v i w i r i 1 1 s i η 0 j 1 n h i j η j where i 1 n and q i χ i 0 0 0 0 ϱ i 0 ϱ i 0 then to stabilize 8 the virtual control laws u i d q i d and r i d are selected as 9 u i d q i d r i d q i 1 κ i 1 β i χ i 0 v i w i r i 1 1 s i η 0 j 1 n h i j η j where i 1 n and κ i 1 diag κ i 1 1 κ i 1 2 κ i 1 3 with positive constants κ i 1 l l 1 3 here diag means the diagonal matrix by applying 9 to 8 β i 1 is given by 10 β i 1 t i β i κ i 1 β i q i u i e q i e r i e c i let us consider the lyapunov function v i 1 1 2 β i β i with i 1 n then owing to the skew symmetric property of t i the time derivative of v i 1 is obtained as 11 v i 1 β i κ i 1 β i β i q i u i e q i e r i e c i with i 1 n step 2 let us consider the dynamic equation 2 and the error surfaces z i 2 z i 2 1 z i 2 6 ϖ i d i where ϖ i υ i ω i and d i u i d α i 1 α i 2 α i 3 q i d r i d here α i 1 α i 2 and α i 3 are the stabilizing auxiliary signals designed in 21 using the dynamic equation 2 z i 2 is represented by 12 z i 2 m i 1 g i τ i d i where i 1 n and g i c i υ i ω i g i ζ i the nonlinear function vector g i is approximated by the function approximation technique using radial basis function neural networks rbfnns polycarpou 1996 then g i is given by 13 g i x i φ i φ i x i ϵ i where x i ϖ i ζ i ϒ is an input vector ϒ r 6 is a compact set φ i φ i 1 φ i n i is a gaussian function vector with node number n i φ i φ i 1 φ i 6 indicates the optimal weight matrix satisfying φ i f φ i with an unknown constant φ i 0 φ i l φ i l 1 φ i l n i l 1 6 f means the frobenius norm and ϵ i denotes a reconstruction error vector satisfying ϵ i ϵ i with an unknown constant ϵ i 0 the local event driven adaptive tracker τ i and its triggering condition are designed as 14 τ i t τ i t i a t t i a t i a 1 15 t i a 1 inf t t i a e i t a i 1 z i 2 t a i 2 where i 1 n t i a denotes the update time of the i th auv tracker with a z e i t τ i t τ i t z i 2 z i 2 1 z i 2 5 z i 2 6 u i e q i e r i e and a i 1 and a i 2 are positive design constants here 14 and 15 imply that the tracking laws τ i are set to τ i t i a for all t t i a t i a 1 and are updated at t i a 1 when e i a i 1 z i 2 a i 2 here the adaptive signals τ i τ i 1 0 0 0 τ i 5 τ i 6 are selected as 16 τ i 1 τ i 5 τ i 6 diag κ i 2 1 κ i 2 5 κ i 2 6 z i 2 d i 1 d i 5 d i 6 φ ˆ i 1 φ ˆ i 5 φ ˆ i 6 φ i ϵ ˆ i a i 2 tanh z i 2 ϑ i a i 1 z i 2 17 φ ˆ i ς i φ i z i 2 σ i 1 φ ˆ i 18 ϵ ˆ i ι i z i 2 tanh z i 2 ϑ i σ i 2 ϵ ˆ i where i 1 n κ i 2 1 0 κ i 2 5 0 and κ i 2 6 0 are design parameters d i d i 1 d i 6 m i d i φ ˆ i φ ˆ i 1 φ ˆ i 6 φ ˆ i f are estimates of φ i f f 1 6 tanh z i 2 ϑ i tanh z i 2 1 ϑ i tanh z i 2 6 ϑ i tanh z i 2 ϑ i tanh z i 2 1 ϑ i tanh z i 2 5 ϑ i tanh z i 2 6 ϑ i with positive constants ϑ i ϵ ˆ i are estimates of ϵ i ς i diag ς i 1 ς i n i ς i l 0 are constants with l 1 n i and ι i 0 σ i 1 0 and σ i 2 0 are design constants choose the second lyapunov function v i 2 as 19 v i 2 v i 1 1 2 z i 2 m i z i 2 1 2 t r φ i ς i 1 φ i 1 2 ι i ϵ 2 where i 1 n ϵ i ϵ i ϵ ˆ i t r indicates the trace of the matrix and φ i φ i φ ˆ i due to e i t i a 0 for a z the time derivative of v i 2 along 11 15 is obtained as 20 v i 2 β i κ i 1 β i β i q i z i 2 c i z i 2 φ i φ i ϵ i τ i z i 2 d i t r φ i ς i 1 φ ˆ i 1 ι i ϵ i ϵ ˆ i z i 2 a i 1 z i 2 a i 2 β i κ i 1 β i β i q i z i 2 c i z i 2 φ i φ i ϵ i τ i t r φ i ς i 1 φ ˆ i 1 ι i ϵ i ϵ ˆ i a i 1 z i 2 z i 2 z i 2 a i 2 z i 2 d i 1 0 0 0 d i 5 d i 6 z i 2 0 m i 1 u i d q i d r i d m i 2 α i 1 α i 2 α i 3 0 0 where m i 1 0 0 m i x i g y i r 0 m i x i g z i q 0 0 0 0 and m i 2 m i y i v 0 m i z i g 0 m i z i w m i y i g m i z i g m i y i g i i x x k i p here the stabilizing auxiliary signals α i 1 α i 2 and α i 3 are designed as α i 1 α i 2 α i 3 m i 2 1 diag κ i 2 2 κ i 2 3 κ i 2 4 z i 2 2 z i 2 3 z i 2 4 m i 1 u i d u i d ξ i q i d q i d ξ i r i d r i d ξ i 21 φ ˆ i 2 φ ˆ i 3 φ ˆ i 4 φ i ϵ ˆ i tanh z i 2 2 ϑ i tanh z i 2 3 ϑ i tanh z i 2 4 ϑ i where i 1 n and κ i 2 2 0 κ i 2 3 0 and κ i 2 4 0 are design parameters applying 16 and 21 into 20 yields 22 v i 2 β i κ i 1 β i z i 2 κ i 2 z i 2 β i q i z i 2 c i z i 2 φ i φ i t r φ i ς i 1 φ ˆ i z i 2 ϵ i ϵ ˆ i z i 2 tanh z i 2 ϑ i 1 ι i ϵ i ϵ ˆ i a i 2 z i 2 a i 2 z i 2 tanh z i 2 ϑ i where κ i 2 diag κ i 2 1 κ i 2 6 lemma 1 polycarpou 1996 0 z z tanh z ϑ 0 2785 ϑ is satisfied where any positive constant ϑ and z r from lemma 1 substituting 17 and 18 to 22 yields 23 v i 2 β i κ i 1 β i β i q i z i 2 c i z i 2 κ i 2 z i 2 σ i 1 t r φ i φ ˆ i σ i 2 ϵ i ϵ ˆ i 1 671 ϵ i 1 ϑ i 0 8355 a i 2 ϑ i remark 2 to deal with the underactuated dynamics 2 the local stabilizing auxiliary signals α i 1 α i 2 and α i 3 are designed as 21 owing to these stabilizing reference signals the 6 dof dynamics 2 can be controlled by τ i x τ i m and τ i n furthermore different from cao and guo 2019 gao and guo 2018 bian and xiang 2019 and hu et al 2015 the event triggering conditions 15 for the distributed formation tracker are derived for the intermittent update of the local control inputs 14 3 2 stability analysis the main result of this study is presented as follows theorem 1 let us consider the model i e 1 and 2 of the networked multiple auv followers and assume that the leader has directed paths to all auv followers for initial conditions satisfying v 0 δ with a constant δ 0 the adaptive event driven formation tracker 14 with local triggering laws 15 ensures that i all signals of the closed loop system are semi globally uniformly ultimately bounded ii lim t η 1 n η 0 o ε iii the inter event times satisfy t i a 1 t i a t i where i 1 n η η 1 η n the kronecker product is defined as o o 1 0 o n 0 1 n is an n vector of all ones ε 0 is a small constant that can be reduced arbitrarily and t i is the minimum inter execution time proof we define the lyapunov function v i 1 n v i 2 c i c i 2 substituting 23 into v gives v i 1 n β i κ i 1 β i z i 2 κ i 2 z i 2 1 ξ i c i c i β i q i z i 2 c i 24 c i λ i σ i 1 t r φ i φ ˆ i σ i 2 ϵ i 2 σ i 2 ϵ i ϵ i 1 671 ϵ i 1 ϑ i 0 8355 a i 2 ϑ i where λ i z i 1 z i 2 c i z j 1 z j 2 c j φ ˆ j ϵ ˆ j ω 0 q i 1 κ i 1 β i χ i 0 v i w i r i 1 1 s i η 0 j 1 n h i j η j r i 1 1 s i η 0 j 1 n h i j η j with ω 0 η 0 η 0 η 0 using the following inequalities β i q i z i 2 c i β i 2 q i 2 2 z i 2 2 c i 2 t r φ i φ ˆ i φ i f 2 2 φ i 2 2 ϵ i ϵ i ϵ i 2 2 ϵ i 2 2 and c i λ i c i 2 λ i 2 2 λ i λ i 2 with constants λ i 0 and owing to z i 2 2 z i 2 2 we obtain 25 v i 1 n β i κ i 1 β i z i 2 κ i 2 z i 2 c i 2 ξ i c i 2 z i 2 2 β i 2 q i 2 2 c i 2 λ i 2 2 λ i σ i 1 2 φ i f 2 σ i 2 2 ϵ i 2 u where u i 1 n σ i 1 2 φ i 2 σ i 2 2 ϵ i 2 λ i 2 1 671 ϵ i 1 ϑ i 0 8355 a i 2 ϑ i by defining compact sets π i β i β i z i 2 m i z i 2 c i c i l n i β l β l z l 2 m l z l 2 c l c l t r φ l ς l 1 φ l 1 ι l ε l 2 2 δ i 1 n and ξ η 0 η 0 η 0 η 0 η 0 η 0 ω 0 with a constants ω 0 0 we know that there exists a constant λ i such that λ i λ i on π i ξ then by selecting the design parameters as κ i 1 q i 2 2 κ i 1 i 3 3 κ i 2 1 κ i 2 i 6 6 and 1 ξ i ξ i λ i 2 2 λ i 1 with constants κ i 1 0 κ i 2 0 ξ i 0 and identity matrices i 3 3 and i 6 6 25 is represented by 26 v γ v i 1 n 1 λ i 2 λ i 2 c i λ i 2 2 λ i u where γ min i 1 n 2 κ i 1 2 κ i 2 2 ξ i σ i 1 ς i m i n σ i 2 ι i here ς i m i n represent the minimum eigenvalues of ς i owing to λ i λ i on v δ we have v γ v u on v δ then v 0 on v δ when γ u δ and thus v δ is an invariant set the semi global uniform ultimate boundedness of all closed loop signals is guaranteed theorem 1 i furthermore v t e γ t v 0 u γ 1 e γ t and 1 2 β 2 v t imply that lim t β 2 u γ here β is represented by β r i m s i η 1 n η 0 o ρ where r i diag r 1 1 r n 1 and ρ ρ 1 ρ n since m s is invertible it is ensured that lim t η 1 n η 0 o ε where ε 2 u γ ρ m s i 1 r i 1 as 2 u γ and ρ can be kept arbitrarily small by adjusting the design parameters ε can also be reduced arbitrarily small theorem 1 ii to prevent zeno behavior let us show that there exists a minimum inter event time t i such that t i a 1 t i a t i for a z for all t t i a t i a 1 e i t is d d t e i d d t e i e i 1 2 e i e i e i d d t τ i where d d t τ i τ i 1 0 0 0 τ i 5 τ i 6 τ i 1 τ i 5 and τ i 6 are represented by 27 τ i 1 τ i 5 τ i 6 diag κ i 2 1 κ i 2 5 κ i 2 6 z i 2 d i 1 d i 5 d i 6 φ ˆ i 1 φ ˆ i 5 φ ˆ i 6 φ i φ ˆ i 1 φ ˆ i 5 φ ˆ i 6 φ i ϵ ˆ i a i 2 1 tanh 2 z i 2 ϑ i z i 2 ϑ i ϵ ˆ i tanh z i 2 ϑ i a i 1 z i 2 as all the signals of the closed loop system are bounded there exists a constant γ i 0 such that d d t τ i γ i then by integrating d d t e i γ i during t t i a t i a 1 and using the triggering condition 15 we obtain t i a 1 t i a a i 1 z i 2 t a i 2 γ i a i 2 γ i t i theorem 1 iii 4 simulation examples as shown in fig 2 let us consider a group of auvs composed of a leader i e l and four auv followers i e f 1 f 4 represented by systems 1 and 2 under the directed network topology the system parameters are taken from prestero 2001 the leader signal is η 0 t 30 cos 0 15 t 30 sin 0 15 t 2 t and the initial positions of auv followers are η 1 0 45 5 5 η 2 0 60 10 10 η 3 0 41 1 6 and η 4 0 58 3 5 regarding the directed graph the connection parameters are selected as h 2 1 h 3 2 h 4 2 1 h 1 2 h 1 3 h 1 4 h 2 3 h 2 4 h 3 1 h 3 4 h 4 1 h 4 3 0 s 1 1 and s 2 s 3 s 4 0 the offsets for the desired formation are defined as o 1 0 3 3 0 o 2 1 6 6 0 o 3 2 3 3 0 and o 4 2 6 6 0 the control parameters of auv followers are selected as κ 1 1 diag 0 8 0 8 0 8 κ 2 1 diag 0 5 0 5 0 5 κ 3 1 diag 0 9 0 9 0 9 κ 4 1 diag 0 8 0 8 0 8 κ 1 2 diag 70 40 40 40 70 70 κ 2 2 diag 80 40 40 40 80 80 κ 3 2 diag 60 40 40 40 60 60 κ 4 2 diag 150 40 40 40 150 150 ς i l 10 σ 1 1 σ 2 1 σ 3 1 0 04 σ 4 1 0 03 σ 1 2 σ 2 2 σ 3 2 0 4 σ 4 2 0 05 ι i 10 ξ i 5 1 0 2 ϑ 1 1 0 3 ϑ 2 1 0 2 ϑ 3 0 0135 ϑ 4 0 0135 λ i 1 a 1 1 a 2 1 a 3 1 500 a 4 1 150 a 1 2 a 2 2 a 3 2 a 4 2 1 and ϱ 1 ϱ 2 ϱ 3 ϱ 4 0 1 where i 1 4 and l 1 n i the triggering law 15 is checked every the sampling time 0 005 s fig 3 shows the three dimensional formation control result fig 4 displays the formation tracking errors of each auv follower where z i 1 z i 1 1 z i 1 3 with i 1 4 in figs 3 and 4 the proposed distributed formation controller can achieve three dimensional formation tracking of networked 6 dof auvs the outputs of the rbfnns used in auv followers are shown in fig 5 in fig 5 the rbfnn outputs φ ˆ i φ i i 1 4 of auv followers are provided to compensate for the effects of the unknown nonlinear functions g i of the dynamics of auv followers the control inputs for each auv follower are shown in figs 6 9 in figs 6 9 we can see that the underactuated control inputs τ i x τ i m and τ i n i 1 4 of auv followers are intermittently and asynchronously updated by the local event triggering conditions 15 the inter event times for each local event triggered tracker are depicted in fig 10 the number of total events for each local event triggered tracker is 2981 for f 1 2873 for f 2 2858 for f 3 and 3002 for f 4 thus the required data for implementing each local tracker are 24 84 23 94 23 81 and 25 01 of the total sampled data 12000 in 60 sec it can be concluded that the intermittently updated local control laws lead to successful three dimensional formation tracking in the presence of unknown nonlinearities of networked 6 dof auvs 5 conclusion we have presented a distributed event driven adaptive three dimensional formation tracking strategy for networked uncertain 6 dof auvs with unknown nonlinearities the distributed nonlinear error surface using the rotation matrix has been defined to deal with the underactuated dynamic property of multiple auvs under a directed network the distributed recursive design using stabilizing auxiliary signals and neural networks has been developed to achieve adaptive event driven formation tracking while ensuring the stability of the overall closed loop system in the formation tracking scheme event triggering conditions for the distributed formation tracker have been derived for the intermittent update of the local underactuated control inputs furthermore the exclusion of zeno behavior in the proposed event triggering mechanism has been analyzed finally a simulation result has been provided to verify the effectiveness of the proposed control strategy further extensions to the output feedback formation tracking problem and the practical implementation of the proposed approach and applications such as biomimetic flexible fishtail robots li et al 2019a are conceivable they remain to be meaningful subjects for future research credit authorship contribution statement jin hoe kim software writing original draft sung jin yoo conceptualization methodology software validation investigation supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research was supported by the national research foundation of korea nrf grant funded by the korea government nrf 2019r1a2c1004898 all authors have seen and approved the final version of the manuscript being submitted appendix the matrices m i 1 and m i 2 and the vectors g i ζ i and c i v i ω i of the dynamics 2 are defined as prestero 2001 m i 1 m i 0 0 0 m i z i g m i y i g 0 m i 0 m i z i g 0 m i x i g 0 0 m i m i y i g m i x i g 0 0 m i z i g m i y i g i i x x 0 0 m i z i g 0 m i x i g 0 i i y y 0 m i y i g m i x i g 0 0 0 i i z z m i 2 x i u 0 0 0 0 0 0 y i v 0 0 0 y i r 0 0 z i w 0 z i q 0 0 0 0 k i p 0 0 0 0 m i w 0 m i q 0 0 n i v 0 0 0 n i r g i ζ i w i f i s θ i w i f i c θ i s ϕ i w i f i c θ i c ϕ i y i g w i y i b f i c θ i c ϕ i z i g w i z i b f i c θ i s ϕ i z i g w i z i b f i s θ i x i g w i x i b f i c θ i c ϕ i x i g w i x i b f i c θ i s ϕ i y i g w i y i b f i s θ i c i υ i ω i c i 1 c i 6 c i 1 x i u u u i u i x i w q m i w i q i x i q q m i x i g q i 2 x i v r m i v i r i x i r r m i x i g r i 2 m i y i g p i q i m i z i g p i r i c i 2 y i v v v i v i y i r r r i r i m i y i g r i 2 y i u r m i u i r i y i u v u i v i y i w p m i w i p i y i p q m i x i g p i q i m i y i g p i 2 m i z i g q i r i c i 3 z i w w w i w i z i q q q i q i z i u q m i u i q i z i v p m i v i p i z i r p m i x i g r i p i z i u w u i w i m i z i g p i 2 q i 2 m i y i g r i q i c i 4 k i p p p i p i i i z z i i y y q i r i m i y i g u i q i v i p i m i z i g w i p i u i r i c i 5 m i w w w i w i m i q q q i q i m i u q m i x i g u i q i m i v p m i x i g v i p i m i r p i i x x i i z z r i p i m i z i g v i r i w i q i m i u w u i w i c i 6 n i v v v i v i n i r r r i r i n i u r m i x i g u i r i n i w p m i x i g w i p i n i p q i i y y i i x x p i q i m i y i g v i r i w i q i n i u v u i v i where x i g y i g and z i g denote the center of gravity of the i th auv m i indicates the mass of the i th auv i i x x i i y y and i i z z denote the inertia tensors of the i th auv w i and f i are the vehicle weight and buoyancy of the i th auv respectively x i b y i b and z i b denotes the buoyancy center of the i th auv and x i y i z i m i and n i are the hydrodynamic coefficients of the i th auv for the detailed definitions see prestero 2001 and kim and yoo 2021 
20667,an optimal sliding mode control smc with state observer is presented for trajectory tracking of under actuated ships with the model uncertainties environmental disturbances input constraints and optimization firstly two backstepping virtual control laws are designed by the kinematic model to convert trajectory tracking into heading control and surge velocity control then according to the norrbin model and the correlation coefficient between surge velocity and propeller revolution a heading model and a surge velocity model are established respectively meanwhile two extended state observers are built based on the hyperbolic tangent function with clear bounded meaning which estimate model uncertainties and disturbances the nonlinear smc is used to control heading and surge velocity which embeds the control laws namely rudder angle and propeller revolution in a cost function this cost function is solved with input limits to address the input optimization amplitude and increment constraints finally the stability analysis is provided and the simulations show that the ship can track trajectory successfully in case of the disturbances and constraints these results demonstrate the feasibility and effectiveness of this method graphical abstract this paper combines an optimal sliding mode control smc with state observer for trajectory tracking of under actuated ships with the model uncertainties environmental disturbances input constraints and optimization firstly two backstepping virtual control laws are designed by kinematic model to convert trajectory tracking into the heading control and surge velocity control then according to the norrbin model and the correlation coefficient between surge velocity and propeller revolution a heading model and a surge velocity model are established respectively meanwhile two extended state observers esos are built based on the hyperbolic tangent function with clear bounded meaning which compensate for the external disturbance and the difference between the established model and actual system and the nonlinear smc is exploited to control the heading and surge velocity the smc laws namely rudder angle and propeller revolution are embedded in a cost function so that the input optimization amplitude and increment constraints are addressed finally the stability analysis is provided and the simulations show that the ship can track straight or curve trajectory successfully in case of the disturbances and constraints these results demonstrate the feasibility and effectiveness of this method image 1 keywords trajectory tracking sliding mode control backstepping extended state observer 1 introduction with the increasing application in transportation under actuated ships have played an important role in many marine fields jia et al 2019 hence the motion control of under actuated ships has attracted a great deal of attention from the control and ocean engineering communities over the past years padideh et al 2016 the important motion control problem is the trajectory tracking which forces ships to track a time varying trajectory on time and is more difficult to compare with path following the challenges of achieving the trajectory tracking are not only the under actuation that ships only have two control actuators propeller and rudder but others problems such as environmental disturbances model uncertainties as well as input constraints and optimization according to those problems some previous control approaches for trajectory tracking of under actuated ships have been presented in order to compensate for the unstructured modelling inaccuracies and external disturbances a robust and adaptive control was used in huang et al 2011 chen et al 2018 liu 2019 the radial basis function neural network rbfnn was introduced in shen et al 2018 liu et al 2010 to approximate the model uncertainties and external disturbances to simplify the neural network structure both the tracking errors and prediction errors were used in zeng et al 2018 to update the rbf weight then in order to reduce the computational burdens of the rbfnn a minimum learning parameter neural network mlpnn was exploited in yu et al 2018 zhang et al 2014 to tackle the uncertain dynamics and external disturbances effectively mlpnn was also applied in mu et al 2018 shen and wang 2018 to address the system uncertainties and environmental disturbances a neural extended state observer eso was exploited in wan et al 2019 differing with the adaptive control or neural network technology the eso can estimate not only the unknowns but the higher order states used in the controller design the eso needs less parameters that are only one more than the number of system states in order to estimate the current disturbances a finite time observer was built in fan et al 2019 a linear eso leso was employed in liu et al 2020 to estimate the sideslip caused by the disturbances such as wind and current the leso was also designed to tackle both the uncertain dynamics and external disturbances in li et al 2013 a leso was used in li et al 2018 which could promote the robustness of controller to the wave disturbances then the nonlinear eso was proposed in zheng and feroskhan 2017 where the external disturbances can be estimated better in addition to aforementioned problems it is also significant to obtain a constrained or optimal control input to deal with the input saturation the auxiliary dynamic system was presented in qiu et al 2019 wang et al 2019 in recent years the mpc algorithm has become the standard optimization method for constrained systems lee and chang 2018 the input amplitude and increment constraints were considered in liu et al 2015 where a linear mpc was introduced and both the linear mpc and nonlinear mpc were designed in zheng et al 2014 to cope with the input constraints however the computation of mpc is always intensive then the iterative sliding mode control smc with smaller computation was presented in liu et al 2018 bu et al 2007 where a nonlinear function was introduced to tackle state constraints in order to restrain the chattering phenomenon of smc the control parameters were optimized online in shen et al 2017 via rbfnn it is noted that the used ship control system for trajectory tracking in the most works are the fossen s model its control inputs are the surge force and yaw moment which can t be applied directly to the actual under actuated ship motion system equipped with single propeller and single rudder shen and dai 2017 hence in bu et al 2007 shen et al 2017 the manoeuvring mathematical model group mmg model was employed as the control system its control inputs are propeller revolution and rudder angle that can be directly applied to the actual under actuated ship system in this paper motivated by bu et al 2007 shen et al 2017 we use the mmg model as ship control system to design controller simply two virtual control laws are designed by the backstepping method to convert trajectory tracking into the heading control and surge velocity control then according to the norrbin model and the correlation coefficients between surge velocity and propeller revolution a heading system model and a surge velocity system model are established respectively motivated by wan et al 2019 li et al 2013 zheng and feroskhan 2017 two esos are built based on the hyperbolic tangent function with clear bounded meaning the first eso compensates for the total unknowns including the model uncertainties and external disturbances in the heading model another eso compensates for the total unknowns in the surge velocity model meanwhile two smc controllers are designed to force the heading and surge velocity to follow the virtual reference values the smc laws namely rudder angle and propeller revolution are embedded in a cost function which is solved under the limits so that the input optimization input amplitude and increment constraints are addressed finally stability analysis illustrates the feasibility of the presented algorithm the simulation results demonstrate the effectiveness to address the input constraints and environmental disturbances such as wind current and wave this paper is organized as follows after this introduction section 2 presents the problem formulation and preliminaries in section 3 the kinematic virtual control is designed by the backstepping method section 4 builds the dynamic control including the smc eso and input optimization then section 5 provides the global structure and stability analysis section 6 gives the simulation analysis finally the conclusions are given in section 7 2 problem formulation and preliminaries 2 1 problem formulation the under actuated ship position in the horizontal plane and the motion parameters are shown in fig 1 where u is the surge velocity v is the sway velocity r is the yaw rate ϕ is the heading angle u u 2 v 2 1 2 is the ground velocity β arctan v u is the drift angle δ is the rudder angle δ δ max and δδ δδ max are the rudder amplitude and increment constraints n is the propeller revolution n min n n max and δn δn max are the propeller amplitude and increment constraints in this paper the ship motion system that used for the final simulation is replaced by the mmg model the mmg model was proposed by ship manoeuvring mathematical model group in 1970s and could be expressed as zhang et al 2017 1 x u cos ϕ v sin ϕ u 2 v 2 cos ϕ β y u sin ϕ v cos ϕ u 2 v 2 sin ϕ β ϕ r u m m y v r x h x p x r x w x w a v e m x m y v c sin ϕ c ϕ r m m x v m m x u r y h y r y w y w a v e m x m y v c cos ϕ c ϕ r m m y r n h n r n w n w a v e i z z j z z where m is the ship mass m x and m y are the additional masses x h y h and n h are the bare hull forces moment x w y w and n w are the wind forces moment x wave y wave and n wave are the wave forces moment ϕ c and v c are the current direction and speed respectively i zz is the moment of inertia of the ship around the vertical axis j zz is the additional moment of inertia x p is the propeller force x r y r and n r are the rudder forces moment the propeller force x p in mmg 1 is given by 2 x p 1 t p ρ n 2 d p 4 k t j p j p u 1 w p n d p where n is the propeller revolution t p is the thrust deduction fraction ρ is the water density d p is the propeller diameter k t is the thrust coefficient and is approximately expressed as 2nd polynomial function of propeller advance ratio j p j p is the propeller advance ratio w p is the wake fraction changing with maneuvering motions in general the rudder forces moment x r y r and n r are given by 3 x r 1 t r f n sin δ y r 1 a h f n cos δ n r x r a h x h f n cos δ where t r is the number of rudder resistance deductions f n is the rudder positive pressure α h is the ratio of the hull s additional lateral force to the rudder lateral force caused by steering x r is the longitudinal position of the rudder x h is the distance from the steering induced hull lateral force center to the ship s center of gravity the control inputs of the mmg are the propeller revolution n and rudder angle δ the process of tracking the trajectory is shown in fig 2 where x e is the along track error and is controlled directly by shen et al 2017 n y e is the cross track error and is controlled indirectly by δ which uses ϕ as the virtual control objective pd x d y d is the reference trajectory θ arctan ẏ d ẋ d is the angle of l 1 l 1 is the reference trajectory tangent line and k 1 tan θ b 1 y d k 1 x d l 2 is the reference trajectory normal line and k 2 1 k 1 b 2 y d k 2 x d in this paper the objective is to design the control inputs n and δ to let x e and y e tend to 0 respectively 2 2 preliminaries in this paper to design the heading controller and surge velocity controller simply a heading system is established based on the norrbin model a surge velocity system is established based on the correlation coefficient between the surge velocity u and propeller revolution n firstly the heading model is given by li et al 2020a 4 ϕ r r r t a t r 3 k t δ f r where k and t are the maneuverability index of ship a is the positive coefficient f r are the total unknowns including the model uncertainties and external disturbances compensated by the eso in section 4 then to built the surge velocity model this paper analyses the relationship correlation coefficient between n and u by simulation experiment which uses the mmg model as ship motion system the dalian maritime university yulong fig 3 is taken for example in this experiment its main parameters draft 8 0 m full load displacement 14635t ship length 126 m width 20 8 m the simulation time is 1500s the propeller revolution is shown in fig 4 where n 1 and n 2 are the different propeller revolutions the expression to compute the correlation coefficients is given by 5 ρ r 1 r 2 cov r 1 r 2 var r 1 var r 2 where r 1 and r 2 are the variables cov is the covariance var is the variance the correlation coefficient ρ r 1 r 2 is used to measure the linear relationship between two variables the larger the absolute value ρ r 1 r 2 closer to 1 the closer the linear relationship between two variables r 1 and r 2 namely the closer the linear function r 1 k r r 2 b r or r 2 k r r 1 b r then selecting different δ the corresponding correlation coefficients ρ n between n and u are shown in tables 1 and 2 respectively where u is the surge acceleration ṅ and ü are the derivatives of n and u with respect to time respectively we can see that ρ n between ṅ and ü ρ ṅ ü are larger more than 0 9 so the linear relationship between ṅ and ü is closer a linear function between ṅ and ü namely the surge velocity model could be built 6 u u u b u n f u f u b u b u n w u d u where b u is the estimated control gain b u is the actual control gain w u are the uncertain parts between this surge velocity model and actual system namely the mmg model in this paper d u are the environmental disturbances f u are the total unknowns estimated by the eso in section 4 assumption i the total unknowns fr and fu are bounded namely f r f rmax ḟ r ḟ rmax f u f umax and ḟ u ḟ umax in this paper the hyperbolic tangent function tanh z e z e z e z e z is used in many places such as virtual controller smc and eso so to illustrate some parameters clearly its characteristic is shown in fig 5 where c 1 and c 2 are the positive parameters we can see that the hyperbolic tangent function is a bounded odd function and c 1 could adjust the amplitude limit range c 2 can adjust the amplitude variation range 3 kinematic virtual control in this section the backstepping algorithm is used to design the virtual control laws so that trajectory tracking is converted into the heading control and surge velocity control firstly according to fig 2 and the distance theorem from a point to a line the track errors x e and y e are computed 7 x e a 2 x b 2 y c 2 a 2 2 b 2 2 y e a 1 x b 1 y c 1 a 1 2 b 1 2 where x e is computed by the ship position p x y and line l 2 in fig 2 a 2 k 2 b 2 1 c 2 b 2 are the parameters of l 2 y e is computed by p x y and line l 1 a 1 k 1 b 2 1 c 1 b 1 are the parameters of l 1 substituting k 1 tan θ into above equation and transforming the trigonometric function we have 8 x e x cos θ y sin θ x d cos θ y d sin θ y e x sin θ y cos θ x d sin θ y d cos θ differentiating x e and y e with respect to time we have 9 x e u 2 v 2 cos ϕ β θ h x y e u 2 v 2 sin ϕ β θ h y h x θ x sin θ y cos θ x d sin θ y d cos θ x d cos θ y d sin θ h y θ x cos θ y sin θ x d cos θ y d sin θ x d sin θ y d cos θ finally the virtual reference surge velocity u d and virtual reference heading ϕ d will be designed by letting ẋ e k x1tanh k x2 x e and ẏ e k y1tanh k y2 y e 10 u d k x 1 tanh k x 2 x e h x cos ϕ β θ 2 v 2 ϕ d arcsin k y 1 tanh k y 2 y e h y u 2 v 2 θ β where the positive parameters k x1 and k y1 are used to adjust the ranges of u d and ϕ d their value ranges are in 0 5 1 5 larger values k x1 k y1 could promote the tracking speed but will increase the control input values the positive parameters k x2 and k y2 are used to adjust the feedback ranges of x e and y e their value ranges are in 0 0 1 larger values k x2 k y2 could promote the control accuracy but will introduce oscillation phenomenon the lyapunov function is chosen as v 1 x e 2 2 y e 2 2 then differentiating v 1 with respect to time and substituting u d and ϕ d we have 11 v 1 x e x e y e y e k x 1 x e tanh k x 2 x e k y 1 y e tanh k y 2 y e then we have x e tanh x e 0 and y e tanh y e 0 because the hyperbolic tangent function is an odd function hence we have v 1 0 which satisfies the lyapunov stability theorem so u d and ϕ d can let x e 0 and y e 0 4 dynamic control 4 1 heading smc controller in this section the smc method with a eso is exploited for the heading control firstly a sliding surface s r which is bounded by the hyperbolic tangent function is selected 12 s r ϕ e k ϕ 1 tanh k ϕ 2 ϕ e where ϕ e ϕ ϕ d is the heading error the positive parameter k ϕ1 in 0 05 0 2 is used to adjust the range of s r the positive parameter k ϕ2 in 0 05 0 2 is used to adjust the feedback range of ϕ e larger values of k ϕ1 and k ϕ2 could promote the control accuracy but will introduce oscillation phenomenon differentiating s r with respect to time and substituting the heading model 4 we have 13 s r ϕ e k ϕ 1 k ϕ 2 ϕ e 1 tanh 2 k ϕ 2 ϕ e r t a t r 3 k t δ f r ϕ d g r g r k ϕ 1 k ϕ 2 ϕ e 1 tanh 2 k ϕ 2 ϕ e hence the control input δ will be designed by letting ṡ r k ϕ3 s r as follows 14 δ t k r t a t r 3 f ˆ r ϕ d g r k ϕ 3 s r where k ϕ3 is the positive parameter f ˆ r is the estimation of f r by the eso then considering the heading model and the characteristic of the hyperbolic tangent function a eso is designed as follows 15 ϕ ˆ r ˆ l 1 tanh ϕ ˆ ϕ r ˆ r ˆ t a t r ˆ 3 k t δ f ˆ r l 2 tanh ϕ ˆ ϕ f ˆ r l 3 tanh ϕ ˆ ϕ where l 1 l 2 and l 3 are the positive parameters which could adjust the feedback range of estimation errors their value ranges are in 0 05 1 2 larger values l 1 l 2 l 3 could promote the estimated accuracy but will introduce oscillation phenomenon the observer estimation errors are computed as follows 16 ϕ r l 1 tanh ϕ r r t a t r ˆ 3 r 3 f r l 2 tanh ϕ f r l 3 tanh ϕ f r where for the convenience of defining the special symbols and saving space a transition variable a r is used to represent ϕ r and f r ã r â r a r are the estimation errors assumption ii the estimation error f r is bounded because both the hyperbolic tangent function and ḟ r are bounded assumption i namely f r f r max then the lyapunov function v 2 is chosen by 17 v 2 1 2 s r 2 1 2 γ ϕ 2 1 2 μ r 2 1 2 η f r 2 where η μ γ 1 are the positive coefficients according to the designed δ and estimation errors and differentiating v 2 with respect to time we have 18 v 2 s r s r γ ϕ ϕ μ r r η f r f r s r k ϕ 3 s r f r γ ϕ r l 1 tanh ϕ μ r a t r ˆ 3 r 3 r t f r l 2 tanh ϕ η f r l 3 tanh ϕ f r k ϕ 3 s r 2 l 1 γ ϕ tanh ϕ μ t r 2 a μ t r r ˆ 3 r 3 r γ ϕ l 2 μ tanh ϕ f r μ ϕ l 1 μ l 3 η tanh ϕ s r η f r selecting the parameters l 2 γ ϕ μ tanh ϕ and l 3 l 1 μ η the above equation is rewritten as follows 19 v 2 z 1 z 2 z 3 z 1 k ϕ 3 s r 2 l 1 γ ϕ tanh ϕ μ t r 2 a μ t r r ˆ 3 r 3 k ϕ 3 s r 2 l 1 γ ϕ tanh ϕ μ t r 2 a μ t r 2 r ˆ r 2 2 3 r 2 4 z 2 μ f r z 3 ϕ η f r s r μ where z 1 3 are the variables we can see that z 1 0 because the hyperbolic tangent function is an odd function considering s r and ḟ r are bounded assumption ii ηḟ r s r μ is also bounded namely ηḟ r s r μ λ 1max hence we have 20 z 3 0 ϕ λ 1 max z 3 0 ϕ λ 1 max z 3 2 λ 1 max ϕ λ 1 max in this paper we introduce a theorem that if the derivative of a function with respect to time is more or less than 0 the value of this function will increase or decrease monotonically with time respectively if the derivative of ϕ with respect to time namely ϕ is more than λ 1max we have z 3 0 the ranges of hyperbolic tangent function 1 1 and ϕ π π are more than f r 10 5 10 3 so ϕ can increase to l 3 tanh ϕ f r max then the derivative of f r will be less than 0 by considering the estimation errors function 16 f r will decrease to f r 0 and z 2 0 hence we have z 2 z 3 0 meanwhile if the derivative of ϕ is less than λ 1max we have z 3 0 ϕ can decrease to l 3 tanh ϕ f r max then the derivative of f r will be more than 0 f r will increase to f r 0 and z 2 0 hence we have z 2 z 3 0 if ϕ λ 1 max we have z 3 2λ 1max and z 2 z 3 2 μ f r max λ 1 max thus there is a small positive σ 1 that could let z 2 z 3 σ 1 4 2 surge velocity smc controller in this section the smc method with a eso is exploited for the surge velocity firstly a sliding surface s u which is bounded by the hyperbolic tangent function is selected 21 s u u e k u 1 tanh k u 2 u e where u e u u d is the surge velocity error the positive parameter k u1 in 0 1 0 2 is used to adjust the range of s u the positive parameter k u2 in 0 05 0 15 is used to adjust the feedback range of u e larger values of k u1 and k u2 could promote the control accuracy but will introduce oscillation phenomenon differentiating s u with respect to time and substituting the surge velocity model 6 we have 22 s u u e k u 1 k u 2 u e 1 tanh 2 k u 2 u e b u n f u u d g u g u k u 1 k u 2 u e 1 tanh 2 k u 2 u e hence the control input n will be designed by letting ṡ u k u3 s u as follows 23 n f ˆ u u d g u k u 3 s u b u n n d t where k u3 is the positive parameter f ˆ u is the estimation of f u by the eso then according to the surge velocity model another eso is designed as follows 24 u ˆ u l 4 tanh u ˆ u u b u n f ˆ u l 5 tanh u ˆ u f ˆ u l 6 tanh u ˆ u where l 4 l 5 and l 6 are the positive parameters which could adjust the feedback range of estimation errors their value ranges are in 0 05 1 2 larger values l 4 l 5 l 6 could promote the estimated accuracy but will introduce oscillation phenomenon the observer estimation errors are computed as follows 25 u u l 4 tanh u u f u l 5 tanh u f u l 6 tanh u f u where for the convenience of defining the special symbols and saving space a transition variable a u is used to represent u u and f u ã u â u a u are the estimation errors assumption iii the estimation error f u is bounded because both the hyperbolic tangent function and ḟ u are bounded assumption i namely f u f u max then the lyapunov function v 3 is chosen by 26 v 3 1 2 s u 2 1 2 ε u 2 1 2 χ u 2 1 2 ζ f u 2 where ζ χ ε 1 are the positive coefficients according to the designed n and estimation errors and differentiating v 3 with respect to time we have 27 v 3 s u s u ε u u χ u u ζ f u f u s u k u 3 s u f u ε u u l 4 tanh u χ u f u l 5 tanh u ζ f u l 6 tanh u f u k u 3 s u 2 l 4 ε u tanh u u ε u l 5 χ tanh u f u χ u l 4 χ l 6 ζ tanh u ζ f u s u selecting the parameters l 5 εũ χtanhũ and l 6 l 4 ζ χ the above equation is rewritten as follows 28 v 3 z 4 z 5 z 6 z 4 k u 3 s u 2 l 4 ε u tanh u z 5 χ f u z 6 u ζ f u s u χ where z 4 6 are the variables we can see that z 4 0 because the hyperbolic tangent function is an odd function considering s u and ḟ u are bounded assumption iii ζḟ u s u χ is also bounded namely ζḟ u s u χ λ 2max hence we have 29 z 6 0 u λ 2 max z 6 0 u λ 2 max z 6 2 λ 2 max u λ 2 max if the derivative of ũ with respect to time namely u is more than λ 2max we have z 6 0 the ranges of hyperbolic tangent function and u are more than f u so ũ can increase to l 6 tanh u f u max then the derivative of f u will be less than 0 by considering the estimation errors function 25 f u will decrease to f u 0 and z 5 0 hence we have z 5 z 6 0 meanwhile if the derivative of ũ is less than λ 2max we have z 6 0 ũ will decrease to l 6 tanh u f u max then the derivative of f u will be more than 0 f u will increase to f u 0 and z 5 0 hence we also have z 5 z 6 0 if u λ 2 max we will have z 6 2λ 2max and z 5 z 6 2 χ f u max λ 2 max thus there is a small positive σ 2 that could let z 5 z 6 σ 2 4 3 input optimization in this paper to address the input constraints and chattering phenomenon a cost function including both the current and last control inputs is built as follows 30 j j 1 j 2 j 1 p 1 δ δ k 2 p 2 δ δ k 1 2 p 3 δ 2 j 2 q 1 n n k 2 q 2 n n k 1 2 q 3 n 2 where δ k and n k are the current inputs designed by 14 and 23 δ k 1 and n k 1 are the last inputs p 1 3 and q 1 3 in 0 01 1 are the positive parameters which could adjust the balance between control performance and input performance then by solving a quadratic programming qp problem namely the function j δ n 0 with the constraints δ δ max δδ δδ max n min n n max and δn δn max the qp smc control laws optimal inputs δ and n will be obtained differentiating j with respect to δ and n respectively we have 31 j δ 2 p 1 p 2 p 3 δ 2 p 1 δ k p 2 δ k 1 j n 2 q 1 q 2 q 3 n 2 q 1 n k q 2 n k 1 then letting j δ n 0 the optimal control inputs will be computed as follows 32 δ p 1 δ k p 2 δ k 1 p 1 p 2 p 3 n q 1 n k q 2 n k 1 q 1 q 2 q 3 hence by adjusting the parameters p 1 p 2 p 3 and q 1 q 2 q 3 the stability of δ and n could be the same as δ k and n k 5 global structure and stability analysis in this section the global structure and stability analysis are provided the global design structure is shown in fig 6 then the lyapunov function v is chosen by 33 v v 1 v 2 v 3 1 2 x e 2 1 2 y e 2 1 2 s r 2 1 2 γ ϕ 2 1 2 μ r 2 1 2 η f r 2 1 2 s u 2 1 2 ε u 2 1 2 χ u 2 1 2 ζ f u 2 according to 11 19 and 28 and differentiating v with respect to time we have 34 v k x 1 x e tanh k x 2 x e k y 1 y e tanh k y 2 y e z 1 z 2 z 3 z 4 z 5 z 6 f e σ f e k x 1 x e tanh k x 2 x e k y 1 y e tanh k y 2 y e k ϕ 3 s r 2 l 1 γ ϕ tanh ϕ μ t r 2 a μ t r 2 r ˆ r 2 2 3 r 2 4 k u 3 s u 2 l 4 ε u tanh u where σ σ 1 σ 2 is a small positive variable f e is a variable and we have f e 0 then if f e σ 0 we have v 0 meanwhile if f e σ 0 namely σ f e 0 and f e σ the errors such as x e y e s r will be bounded because all the parts in f e k x1 x e tanh k x2 x e ẏ e k y1 y e tanh k y2 y e are positive hence the stability could be satisfied 6 simulation analysis in this section the simulations are carried out to demonstrate the effectiveness of the designed controller the dalian maritime university yulong is taken for example in this experiment its main parameters are draft 8 0 m length 126 m width 20 8 m full load displacement 14635t the limits are selected as n max 120r min δ max 35 δn max 10r min δδ max 6 the mmg 1 is used as the control system the wind forces moment such as x w y w and n w in 1 are given li et al 2020b 35 x w 0 5 ρ a a f u r 2 c w x α r y w 0 5 ρ a a s u r 2 c w y α r n w 0 5 ρ a a s l o a u r 2 c w n α r where ρ α is the air density α r is the wind angle of attack u r is the relative wind speed a f and a s are the frontal and lateral projected areas respectively l oα is the length overall c wx α r c wy α r and c wn α r are the nondimensional wind coefficients respectively the wave forces moment such as x wave y wave and n wave are given li et al 2021 36 x w a v e 0 5 ρ l α 2 cos χ c x w λ y w a v e 0 5 ρ l α 2 sin χ c y w λ n w a v e 0 5 ρ l α 2 sin χ c n w λ where χ is the encounter angle ρ is the seawater density λ is the wavelength α is the wave amplitude c xw λ c yw λ and c nw λ are coefficients related to wavelength case1 straight trajectory initial states x y ϕ 0 200 m 0 u v r 6 m s 0 0 control parameters k x1 1 2 k x2 0 005 k y1 0 62 k y2 0 05 k ϕ1 0 08 k ϕ2 0 08 k ϕ3 0 08 k u1 0 15 k u2 0 1 k u3 0 1 l 1 0 9 l 2 0 6 l 3 0 15 l 4 0 6 l 5 0 8 l 6 0 1 p 1 1 p 2 0 35 p 3 0 15 q 1 1 q 2 0 5 q 3 0 3 external disturbances wind speed 10 m s wind direction 20 sin 0 015t 45 current velocity 1 m s current set 10 sin 0 002t 45 wave length 83m encounter angle ϕ 135 20 sin 0 015t wave height 3m the simulation results are shown in figs 7 12 in figs 7 12 the subscripts smc and qpsmc denote the common smc 14 23 and the optimal smc 30 in fig 7 we can see that two control schemes could force ship to tracking straight reference trajectory successfully in fig 8 the track errors are larger at the beginning or turning points because of the initial errors or the large inertia of under actuated ship but can decrease to 0 quickly in fig 9 ϕ and u have variable values due to the time varying disturbances such as wind current and wave they could converge to the designed virtual heading ϕ d and surge velocity u d accurately the above results can illustrate the effectiveness of the proposed controller to address the uncertain parameters and external disturbances in fig 10 control inputs δ and n are also variable owning to the environmental disturbances they are always limited within the constrains δ max and n max respectively meanwhile δ qpsmc and n qpsmc are smoother at the turning points fig 11 shows the information of input increments δδ and δn which are also limited within the constrains δδ max and δn max fig 12 describes the ability of the designed esos which can estimate f r and f u accurately although there are a few oscillations at the turning points f reso and f ueso could approximate f r and f u in a short time case2 curve trajectory initial states x y ϕ 0 100m 0 u v r 6 m s 0 0 control parameters k x1 1 2 k x2 0 005 k y1 0 62 k y2 0 05 k ϕ1 0 08 k ϕ2 0 08 k ϕ3 0 08 k u1 0 15 k u2 0 1 k u3 0 1 p 1 1 p 2 0 5 p 3 0 1 q 1 1 q 2 0 2 q 3 0 1 others parameters are the same as the case 1 the simulation results are shown in figs 13 18 in figs 13 to 18 the subscripts are the same as the case 1 in fig 13 we can see that two control schemes could force ship to tracking the curve reference trajectory successfully in fig 14 the track errors are larger at the beginning due to the initial errors but can decrease to 0 in a short time about 400s in fig 15 ϕ and u have variable values two reasons may contribute to this phenomenon one is the influences of the time varying disturbance another reason is that ship heading need to follow the tangent variable direction of the curve trajectory ϕ and u could converge to virtual heading ϕ d and surge velocity u d accurately in fig 16 the control inputs δ and n are also variable the reasons are the same as ϕ and u furthermore δ and n are always limited within the constrains δ max and n max respectively meanwhile δ qpsmc and n qpsmc are smooth at the beginning fig 17 shows the information of the input increments δδ and δn which are also limited within the constrains δδ max and δn max fig 18 describes the ability of the designed esos which can estimate f r and f u accurately although there are a few oscillations at the beginning f reso and f ueso could approximate f r and f u quickly 7 conclusions this paper proposes an optimal smc algorithm with the eso for trajectory tracking of under actuated ship firstly two virtual control laws are designed by the backstepping method and kinematic model which can convert trajectory tracking into the heading control and surge velocity control then a heading model and a surge velocity model are built respectively two esos are built to estimate total unknowns in the heading model and surge velocity model meanwhile the smc method is used to achieve the heading control and surge velocity control the designed rudder angle and propeller revolution are embedded in a cost function which is solved under the constraints finally the stability analysis illustrates the feasibility of the presented algorithm the simulations show that the controller can force ship to track the straight or curve trajectory successfully in case of the time varying disturbances the control inputs are also abounded and smooth these results could demonstrate the effectiveness of the presented method author contribution zongxuan li methodology resources writing original draft renxiang bu conceptualization writing review editing funding acquisition funding this work is supported in part by the national natural science foundation of china 51939001 61976033 51679216 the fundamental research funds for the cornell university 3132019345 3132020137 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20667,an optimal sliding mode control smc with state observer is presented for trajectory tracking of under actuated ships with the model uncertainties environmental disturbances input constraints and optimization firstly two backstepping virtual control laws are designed by the kinematic model to convert trajectory tracking into heading control and surge velocity control then according to the norrbin model and the correlation coefficient between surge velocity and propeller revolution a heading model and a surge velocity model are established respectively meanwhile two extended state observers are built based on the hyperbolic tangent function with clear bounded meaning which estimate model uncertainties and disturbances the nonlinear smc is used to control heading and surge velocity which embeds the control laws namely rudder angle and propeller revolution in a cost function this cost function is solved with input limits to address the input optimization amplitude and increment constraints finally the stability analysis is provided and the simulations show that the ship can track trajectory successfully in case of the disturbances and constraints these results demonstrate the feasibility and effectiveness of this method graphical abstract this paper combines an optimal sliding mode control smc with state observer for trajectory tracking of under actuated ships with the model uncertainties environmental disturbances input constraints and optimization firstly two backstepping virtual control laws are designed by kinematic model to convert trajectory tracking into the heading control and surge velocity control then according to the norrbin model and the correlation coefficient between surge velocity and propeller revolution a heading model and a surge velocity model are established respectively meanwhile two extended state observers esos are built based on the hyperbolic tangent function with clear bounded meaning which compensate for the external disturbance and the difference between the established model and actual system and the nonlinear smc is exploited to control the heading and surge velocity the smc laws namely rudder angle and propeller revolution are embedded in a cost function so that the input optimization amplitude and increment constraints are addressed finally the stability analysis is provided and the simulations show that the ship can track straight or curve trajectory successfully in case of the disturbances and constraints these results demonstrate the feasibility and effectiveness of this method image 1 keywords trajectory tracking sliding mode control backstepping extended state observer 1 introduction with the increasing application in transportation under actuated ships have played an important role in many marine fields jia et al 2019 hence the motion control of under actuated ships has attracted a great deal of attention from the control and ocean engineering communities over the past years padideh et al 2016 the important motion control problem is the trajectory tracking which forces ships to track a time varying trajectory on time and is more difficult to compare with path following the challenges of achieving the trajectory tracking are not only the under actuation that ships only have two control actuators propeller and rudder but others problems such as environmental disturbances model uncertainties as well as input constraints and optimization according to those problems some previous control approaches for trajectory tracking of under actuated ships have been presented in order to compensate for the unstructured modelling inaccuracies and external disturbances a robust and adaptive control was used in huang et al 2011 chen et al 2018 liu 2019 the radial basis function neural network rbfnn was introduced in shen et al 2018 liu et al 2010 to approximate the model uncertainties and external disturbances to simplify the neural network structure both the tracking errors and prediction errors were used in zeng et al 2018 to update the rbf weight then in order to reduce the computational burdens of the rbfnn a minimum learning parameter neural network mlpnn was exploited in yu et al 2018 zhang et al 2014 to tackle the uncertain dynamics and external disturbances effectively mlpnn was also applied in mu et al 2018 shen and wang 2018 to address the system uncertainties and environmental disturbances a neural extended state observer eso was exploited in wan et al 2019 differing with the adaptive control or neural network technology the eso can estimate not only the unknowns but the higher order states used in the controller design the eso needs less parameters that are only one more than the number of system states in order to estimate the current disturbances a finite time observer was built in fan et al 2019 a linear eso leso was employed in liu et al 2020 to estimate the sideslip caused by the disturbances such as wind and current the leso was also designed to tackle both the uncertain dynamics and external disturbances in li et al 2013 a leso was used in li et al 2018 which could promote the robustness of controller to the wave disturbances then the nonlinear eso was proposed in zheng and feroskhan 2017 where the external disturbances can be estimated better in addition to aforementioned problems it is also significant to obtain a constrained or optimal control input to deal with the input saturation the auxiliary dynamic system was presented in qiu et al 2019 wang et al 2019 in recent years the mpc algorithm has become the standard optimization method for constrained systems lee and chang 2018 the input amplitude and increment constraints were considered in liu et al 2015 where a linear mpc was introduced and both the linear mpc and nonlinear mpc were designed in zheng et al 2014 to cope with the input constraints however the computation of mpc is always intensive then the iterative sliding mode control smc with smaller computation was presented in liu et al 2018 bu et al 2007 where a nonlinear function was introduced to tackle state constraints in order to restrain the chattering phenomenon of smc the control parameters were optimized online in shen et al 2017 via rbfnn it is noted that the used ship control system for trajectory tracking in the most works are the fossen s model its control inputs are the surge force and yaw moment which can t be applied directly to the actual under actuated ship motion system equipped with single propeller and single rudder shen and dai 2017 hence in bu et al 2007 shen et al 2017 the manoeuvring mathematical model group mmg model was employed as the control system its control inputs are propeller revolution and rudder angle that can be directly applied to the actual under actuated ship system in this paper motivated by bu et al 2007 shen et al 2017 we use the mmg model as ship control system to design controller simply two virtual control laws are designed by the backstepping method to convert trajectory tracking into the heading control and surge velocity control then according to the norrbin model and the correlation coefficients between surge velocity and propeller revolution a heading system model and a surge velocity system model are established respectively motivated by wan et al 2019 li et al 2013 zheng and feroskhan 2017 two esos are built based on the hyperbolic tangent function with clear bounded meaning the first eso compensates for the total unknowns including the model uncertainties and external disturbances in the heading model another eso compensates for the total unknowns in the surge velocity model meanwhile two smc controllers are designed to force the heading and surge velocity to follow the virtual reference values the smc laws namely rudder angle and propeller revolution are embedded in a cost function which is solved under the limits so that the input optimization input amplitude and increment constraints are addressed finally stability analysis illustrates the feasibility of the presented algorithm the simulation results demonstrate the effectiveness to address the input constraints and environmental disturbances such as wind current and wave this paper is organized as follows after this introduction section 2 presents the problem formulation and preliminaries in section 3 the kinematic virtual control is designed by the backstepping method section 4 builds the dynamic control including the smc eso and input optimization then section 5 provides the global structure and stability analysis section 6 gives the simulation analysis finally the conclusions are given in section 7 2 problem formulation and preliminaries 2 1 problem formulation the under actuated ship position in the horizontal plane and the motion parameters are shown in fig 1 where u is the surge velocity v is the sway velocity r is the yaw rate ϕ is the heading angle u u 2 v 2 1 2 is the ground velocity β arctan v u is the drift angle δ is the rudder angle δ δ max and δδ δδ max are the rudder amplitude and increment constraints n is the propeller revolution n min n n max and δn δn max are the propeller amplitude and increment constraints in this paper the ship motion system that used for the final simulation is replaced by the mmg model the mmg model was proposed by ship manoeuvring mathematical model group in 1970s and could be expressed as zhang et al 2017 1 x u cos ϕ v sin ϕ u 2 v 2 cos ϕ β y u sin ϕ v cos ϕ u 2 v 2 sin ϕ β ϕ r u m m y v r x h x p x r x w x w a v e m x m y v c sin ϕ c ϕ r m m x v m m x u r y h y r y w y w a v e m x m y v c cos ϕ c ϕ r m m y r n h n r n w n w a v e i z z j z z where m is the ship mass m x and m y are the additional masses x h y h and n h are the bare hull forces moment x w y w and n w are the wind forces moment x wave y wave and n wave are the wave forces moment ϕ c and v c are the current direction and speed respectively i zz is the moment of inertia of the ship around the vertical axis j zz is the additional moment of inertia x p is the propeller force x r y r and n r are the rudder forces moment the propeller force x p in mmg 1 is given by 2 x p 1 t p ρ n 2 d p 4 k t j p j p u 1 w p n d p where n is the propeller revolution t p is the thrust deduction fraction ρ is the water density d p is the propeller diameter k t is the thrust coefficient and is approximately expressed as 2nd polynomial function of propeller advance ratio j p j p is the propeller advance ratio w p is the wake fraction changing with maneuvering motions in general the rudder forces moment x r y r and n r are given by 3 x r 1 t r f n sin δ y r 1 a h f n cos δ n r x r a h x h f n cos δ where t r is the number of rudder resistance deductions f n is the rudder positive pressure α h is the ratio of the hull s additional lateral force to the rudder lateral force caused by steering x r is the longitudinal position of the rudder x h is the distance from the steering induced hull lateral force center to the ship s center of gravity the control inputs of the mmg are the propeller revolution n and rudder angle δ the process of tracking the trajectory is shown in fig 2 where x e is the along track error and is controlled directly by shen et al 2017 n y e is the cross track error and is controlled indirectly by δ which uses ϕ as the virtual control objective pd x d y d is the reference trajectory θ arctan ẏ d ẋ d is the angle of l 1 l 1 is the reference trajectory tangent line and k 1 tan θ b 1 y d k 1 x d l 2 is the reference trajectory normal line and k 2 1 k 1 b 2 y d k 2 x d in this paper the objective is to design the control inputs n and δ to let x e and y e tend to 0 respectively 2 2 preliminaries in this paper to design the heading controller and surge velocity controller simply a heading system is established based on the norrbin model a surge velocity system is established based on the correlation coefficient between the surge velocity u and propeller revolution n firstly the heading model is given by li et al 2020a 4 ϕ r r r t a t r 3 k t δ f r where k and t are the maneuverability index of ship a is the positive coefficient f r are the total unknowns including the model uncertainties and external disturbances compensated by the eso in section 4 then to built the surge velocity model this paper analyses the relationship correlation coefficient between n and u by simulation experiment which uses the mmg model as ship motion system the dalian maritime university yulong fig 3 is taken for example in this experiment its main parameters draft 8 0 m full load displacement 14635t ship length 126 m width 20 8 m the simulation time is 1500s the propeller revolution is shown in fig 4 where n 1 and n 2 are the different propeller revolutions the expression to compute the correlation coefficients is given by 5 ρ r 1 r 2 cov r 1 r 2 var r 1 var r 2 where r 1 and r 2 are the variables cov is the covariance var is the variance the correlation coefficient ρ r 1 r 2 is used to measure the linear relationship between two variables the larger the absolute value ρ r 1 r 2 closer to 1 the closer the linear relationship between two variables r 1 and r 2 namely the closer the linear function r 1 k r r 2 b r or r 2 k r r 1 b r then selecting different δ the corresponding correlation coefficients ρ n between n and u are shown in tables 1 and 2 respectively where u is the surge acceleration ṅ and ü are the derivatives of n and u with respect to time respectively we can see that ρ n between ṅ and ü ρ ṅ ü are larger more than 0 9 so the linear relationship between ṅ and ü is closer a linear function between ṅ and ü namely the surge velocity model could be built 6 u u u b u n f u f u b u b u n w u d u where b u is the estimated control gain b u is the actual control gain w u are the uncertain parts between this surge velocity model and actual system namely the mmg model in this paper d u are the environmental disturbances f u are the total unknowns estimated by the eso in section 4 assumption i the total unknowns fr and fu are bounded namely f r f rmax ḟ r ḟ rmax f u f umax and ḟ u ḟ umax in this paper the hyperbolic tangent function tanh z e z e z e z e z is used in many places such as virtual controller smc and eso so to illustrate some parameters clearly its characteristic is shown in fig 5 where c 1 and c 2 are the positive parameters we can see that the hyperbolic tangent function is a bounded odd function and c 1 could adjust the amplitude limit range c 2 can adjust the amplitude variation range 3 kinematic virtual control in this section the backstepping algorithm is used to design the virtual control laws so that trajectory tracking is converted into the heading control and surge velocity control firstly according to fig 2 and the distance theorem from a point to a line the track errors x e and y e are computed 7 x e a 2 x b 2 y c 2 a 2 2 b 2 2 y e a 1 x b 1 y c 1 a 1 2 b 1 2 where x e is computed by the ship position p x y and line l 2 in fig 2 a 2 k 2 b 2 1 c 2 b 2 are the parameters of l 2 y e is computed by p x y and line l 1 a 1 k 1 b 2 1 c 1 b 1 are the parameters of l 1 substituting k 1 tan θ into above equation and transforming the trigonometric function we have 8 x e x cos θ y sin θ x d cos θ y d sin θ y e x sin θ y cos θ x d sin θ y d cos θ differentiating x e and y e with respect to time we have 9 x e u 2 v 2 cos ϕ β θ h x y e u 2 v 2 sin ϕ β θ h y h x θ x sin θ y cos θ x d sin θ y d cos θ x d cos θ y d sin θ h y θ x cos θ y sin θ x d cos θ y d sin θ x d sin θ y d cos θ finally the virtual reference surge velocity u d and virtual reference heading ϕ d will be designed by letting ẋ e k x1tanh k x2 x e and ẏ e k y1tanh k y2 y e 10 u d k x 1 tanh k x 2 x e h x cos ϕ β θ 2 v 2 ϕ d arcsin k y 1 tanh k y 2 y e h y u 2 v 2 θ β where the positive parameters k x1 and k y1 are used to adjust the ranges of u d and ϕ d their value ranges are in 0 5 1 5 larger values k x1 k y1 could promote the tracking speed but will increase the control input values the positive parameters k x2 and k y2 are used to adjust the feedback ranges of x e and y e their value ranges are in 0 0 1 larger values k x2 k y2 could promote the control accuracy but will introduce oscillation phenomenon the lyapunov function is chosen as v 1 x e 2 2 y e 2 2 then differentiating v 1 with respect to time and substituting u d and ϕ d we have 11 v 1 x e x e y e y e k x 1 x e tanh k x 2 x e k y 1 y e tanh k y 2 y e then we have x e tanh x e 0 and y e tanh y e 0 because the hyperbolic tangent function is an odd function hence we have v 1 0 which satisfies the lyapunov stability theorem so u d and ϕ d can let x e 0 and y e 0 4 dynamic control 4 1 heading smc controller in this section the smc method with a eso is exploited for the heading control firstly a sliding surface s r which is bounded by the hyperbolic tangent function is selected 12 s r ϕ e k ϕ 1 tanh k ϕ 2 ϕ e where ϕ e ϕ ϕ d is the heading error the positive parameter k ϕ1 in 0 05 0 2 is used to adjust the range of s r the positive parameter k ϕ2 in 0 05 0 2 is used to adjust the feedback range of ϕ e larger values of k ϕ1 and k ϕ2 could promote the control accuracy but will introduce oscillation phenomenon differentiating s r with respect to time and substituting the heading model 4 we have 13 s r ϕ e k ϕ 1 k ϕ 2 ϕ e 1 tanh 2 k ϕ 2 ϕ e r t a t r 3 k t δ f r ϕ d g r g r k ϕ 1 k ϕ 2 ϕ e 1 tanh 2 k ϕ 2 ϕ e hence the control input δ will be designed by letting ṡ r k ϕ3 s r as follows 14 δ t k r t a t r 3 f ˆ r ϕ d g r k ϕ 3 s r where k ϕ3 is the positive parameter f ˆ r is the estimation of f r by the eso then considering the heading model and the characteristic of the hyperbolic tangent function a eso is designed as follows 15 ϕ ˆ r ˆ l 1 tanh ϕ ˆ ϕ r ˆ r ˆ t a t r ˆ 3 k t δ f ˆ r l 2 tanh ϕ ˆ ϕ f ˆ r l 3 tanh ϕ ˆ ϕ where l 1 l 2 and l 3 are the positive parameters which could adjust the feedback range of estimation errors their value ranges are in 0 05 1 2 larger values l 1 l 2 l 3 could promote the estimated accuracy but will introduce oscillation phenomenon the observer estimation errors are computed as follows 16 ϕ r l 1 tanh ϕ r r t a t r ˆ 3 r 3 f r l 2 tanh ϕ f r l 3 tanh ϕ f r where for the convenience of defining the special symbols and saving space a transition variable a r is used to represent ϕ r and f r ã r â r a r are the estimation errors assumption ii the estimation error f r is bounded because both the hyperbolic tangent function and ḟ r are bounded assumption i namely f r f r max then the lyapunov function v 2 is chosen by 17 v 2 1 2 s r 2 1 2 γ ϕ 2 1 2 μ r 2 1 2 η f r 2 where η μ γ 1 are the positive coefficients according to the designed δ and estimation errors and differentiating v 2 with respect to time we have 18 v 2 s r s r γ ϕ ϕ μ r r η f r f r s r k ϕ 3 s r f r γ ϕ r l 1 tanh ϕ μ r a t r ˆ 3 r 3 r t f r l 2 tanh ϕ η f r l 3 tanh ϕ f r k ϕ 3 s r 2 l 1 γ ϕ tanh ϕ μ t r 2 a μ t r r ˆ 3 r 3 r γ ϕ l 2 μ tanh ϕ f r μ ϕ l 1 μ l 3 η tanh ϕ s r η f r selecting the parameters l 2 γ ϕ μ tanh ϕ and l 3 l 1 μ η the above equation is rewritten as follows 19 v 2 z 1 z 2 z 3 z 1 k ϕ 3 s r 2 l 1 γ ϕ tanh ϕ μ t r 2 a μ t r r ˆ 3 r 3 k ϕ 3 s r 2 l 1 γ ϕ tanh ϕ μ t r 2 a μ t r 2 r ˆ r 2 2 3 r 2 4 z 2 μ f r z 3 ϕ η f r s r μ where z 1 3 are the variables we can see that z 1 0 because the hyperbolic tangent function is an odd function considering s r and ḟ r are bounded assumption ii ηḟ r s r μ is also bounded namely ηḟ r s r μ λ 1max hence we have 20 z 3 0 ϕ λ 1 max z 3 0 ϕ λ 1 max z 3 2 λ 1 max ϕ λ 1 max in this paper we introduce a theorem that if the derivative of a function with respect to time is more or less than 0 the value of this function will increase or decrease monotonically with time respectively if the derivative of ϕ with respect to time namely ϕ is more than λ 1max we have z 3 0 the ranges of hyperbolic tangent function 1 1 and ϕ π π are more than f r 10 5 10 3 so ϕ can increase to l 3 tanh ϕ f r max then the derivative of f r will be less than 0 by considering the estimation errors function 16 f r will decrease to f r 0 and z 2 0 hence we have z 2 z 3 0 meanwhile if the derivative of ϕ is less than λ 1max we have z 3 0 ϕ can decrease to l 3 tanh ϕ f r max then the derivative of f r will be more than 0 f r will increase to f r 0 and z 2 0 hence we have z 2 z 3 0 if ϕ λ 1 max we have z 3 2λ 1max and z 2 z 3 2 μ f r max λ 1 max thus there is a small positive σ 1 that could let z 2 z 3 σ 1 4 2 surge velocity smc controller in this section the smc method with a eso is exploited for the surge velocity firstly a sliding surface s u which is bounded by the hyperbolic tangent function is selected 21 s u u e k u 1 tanh k u 2 u e where u e u u d is the surge velocity error the positive parameter k u1 in 0 1 0 2 is used to adjust the range of s u the positive parameter k u2 in 0 05 0 15 is used to adjust the feedback range of u e larger values of k u1 and k u2 could promote the control accuracy but will introduce oscillation phenomenon differentiating s u with respect to time and substituting the surge velocity model 6 we have 22 s u u e k u 1 k u 2 u e 1 tanh 2 k u 2 u e b u n f u u d g u g u k u 1 k u 2 u e 1 tanh 2 k u 2 u e hence the control input n will be designed by letting ṡ u k u3 s u as follows 23 n f ˆ u u d g u k u 3 s u b u n n d t where k u3 is the positive parameter f ˆ u is the estimation of f u by the eso then according to the surge velocity model another eso is designed as follows 24 u ˆ u l 4 tanh u ˆ u u b u n f ˆ u l 5 tanh u ˆ u f ˆ u l 6 tanh u ˆ u where l 4 l 5 and l 6 are the positive parameters which could adjust the feedback range of estimation errors their value ranges are in 0 05 1 2 larger values l 4 l 5 l 6 could promote the estimated accuracy but will introduce oscillation phenomenon the observer estimation errors are computed as follows 25 u u l 4 tanh u u f u l 5 tanh u f u l 6 tanh u f u where for the convenience of defining the special symbols and saving space a transition variable a u is used to represent u u and f u ã u â u a u are the estimation errors assumption iii the estimation error f u is bounded because both the hyperbolic tangent function and ḟ u are bounded assumption i namely f u f u max then the lyapunov function v 3 is chosen by 26 v 3 1 2 s u 2 1 2 ε u 2 1 2 χ u 2 1 2 ζ f u 2 where ζ χ ε 1 are the positive coefficients according to the designed n and estimation errors and differentiating v 3 with respect to time we have 27 v 3 s u s u ε u u χ u u ζ f u f u s u k u 3 s u f u ε u u l 4 tanh u χ u f u l 5 tanh u ζ f u l 6 tanh u f u k u 3 s u 2 l 4 ε u tanh u u ε u l 5 χ tanh u f u χ u l 4 χ l 6 ζ tanh u ζ f u s u selecting the parameters l 5 εũ χtanhũ and l 6 l 4 ζ χ the above equation is rewritten as follows 28 v 3 z 4 z 5 z 6 z 4 k u 3 s u 2 l 4 ε u tanh u z 5 χ f u z 6 u ζ f u s u χ where z 4 6 are the variables we can see that z 4 0 because the hyperbolic tangent function is an odd function considering s u and ḟ u are bounded assumption iii ζḟ u s u χ is also bounded namely ζḟ u s u χ λ 2max hence we have 29 z 6 0 u λ 2 max z 6 0 u λ 2 max z 6 2 λ 2 max u λ 2 max if the derivative of ũ with respect to time namely u is more than λ 2max we have z 6 0 the ranges of hyperbolic tangent function and u are more than f u so ũ can increase to l 6 tanh u f u max then the derivative of f u will be less than 0 by considering the estimation errors function 25 f u will decrease to f u 0 and z 5 0 hence we have z 5 z 6 0 meanwhile if the derivative of ũ is less than λ 2max we have z 6 0 ũ will decrease to l 6 tanh u f u max then the derivative of f u will be more than 0 f u will increase to f u 0 and z 5 0 hence we also have z 5 z 6 0 if u λ 2 max we will have z 6 2λ 2max and z 5 z 6 2 χ f u max λ 2 max thus there is a small positive σ 2 that could let z 5 z 6 σ 2 4 3 input optimization in this paper to address the input constraints and chattering phenomenon a cost function including both the current and last control inputs is built as follows 30 j j 1 j 2 j 1 p 1 δ δ k 2 p 2 δ δ k 1 2 p 3 δ 2 j 2 q 1 n n k 2 q 2 n n k 1 2 q 3 n 2 where δ k and n k are the current inputs designed by 14 and 23 δ k 1 and n k 1 are the last inputs p 1 3 and q 1 3 in 0 01 1 are the positive parameters which could adjust the balance between control performance and input performance then by solving a quadratic programming qp problem namely the function j δ n 0 with the constraints δ δ max δδ δδ max n min n n max and δn δn max the qp smc control laws optimal inputs δ and n will be obtained differentiating j with respect to δ and n respectively we have 31 j δ 2 p 1 p 2 p 3 δ 2 p 1 δ k p 2 δ k 1 j n 2 q 1 q 2 q 3 n 2 q 1 n k q 2 n k 1 then letting j δ n 0 the optimal control inputs will be computed as follows 32 δ p 1 δ k p 2 δ k 1 p 1 p 2 p 3 n q 1 n k q 2 n k 1 q 1 q 2 q 3 hence by adjusting the parameters p 1 p 2 p 3 and q 1 q 2 q 3 the stability of δ and n could be the same as δ k and n k 5 global structure and stability analysis in this section the global structure and stability analysis are provided the global design structure is shown in fig 6 then the lyapunov function v is chosen by 33 v v 1 v 2 v 3 1 2 x e 2 1 2 y e 2 1 2 s r 2 1 2 γ ϕ 2 1 2 μ r 2 1 2 η f r 2 1 2 s u 2 1 2 ε u 2 1 2 χ u 2 1 2 ζ f u 2 according to 11 19 and 28 and differentiating v with respect to time we have 34 v k x 1 x e tanh k x 2 x e k y 1 y e tanh k y 2 y e z 1 z 2 z 3 z 4 z 5 z 6 f e σ f e k x 1 x e tanh k x 2 x e k y 1 y e tanh k y 2 y e k ϕ 3 s r 2 l 1 γ ϕ tanh ϕ μ t r 2 a μ t r 2 r ˆ r 2 2 3 r 2 4 k u 3 s u 2 l 4 ε u tanh u where σ σ 1 σ 2 is a small positive variable f e is a variable and we have f e 0 then if f e σ 0 we have v 0 meanwhile if f e σ 0 namely σ f e 0 and f e σ the errors such as x e y e s r will be bounded because all the parts in f e k x1 x e tanh k x2 x e ẏ e k y1 y e tanh k y2 y e are positive hence the stability could be satisfied 6 simulation analysis in this section the simulations are carried out to demonstrate the effectiveness of the designed controller the dalian maritime university yulong is taken for example in this experiment its main parameters are draft 8 0 m length 126 m width 20 8 m full load displacement 14635t the limits are selected as n max 120r min δ max 35 δn max 10r min δδ max 6 the mmg 1 is used as the control system the wind forces moment such as x w y w and n w in 1 are given li et al 2020b 35 x w 0 5 ρ a a f u r 2 c w x α r y w 0 5 ρ a a s u r 2 c w y α r n w 0 5 ρ a a s l o a u r 2 c w n α r where ρ α is the air density α r is the wind angle of attack u r is the relative wind speed a f and a s are the frontal and lateral projected areas respectively l oα is the length overall c wx α r c wy α r and c wn α r are the nondimensional wind coefficients respectively the wave forces moment such as x wave y wave and n wave are given li et al 2021 36 x w a v e 0 5 ρ l α 2 cos χ c x w λ y w a v e 0 5 ρ l α 2 sin χ c y w λ n w a v e 0 5 ρ l α 2 sin χ c n w λ where χ is the encounter angle ρ is the seawater density λ is the wavelength α is the wave amplitude c xw λ c yw λ and c nw λ are coefficients related to wavelength case1 straight trajectory initial states x y ϕ 0 200 m 0 u v r 6 m s 0 0 control parameters k x1 1 2 k x2 0 005 k y1 0 62 k y2 0 05 k ϕ1 0 08 k ϕ2 0 08 k ϕ3 0 08 k u1 0 15 k u2 0 1 k u3 0 1 l 1 0 9 l 2 0 6 l 3 0 15 l 4 0 6 l 5 0 8 l 6 0 1 p 1 1 p 2 0 35 p 3 0 15 q 1 1 q 2 0 5 q 3 0 3 external disturbances wind speed 10 m s wind direction 20 sin 0 015t 45 current velocity 1 m s current set 10 sin 0 002t 45 wave length 83m encounter angle ϕ 135 20 sin 0 015t wave height 3m the simulation results are shown in figs 7 12 in figs 7 12 the subscripts smc and qpsmc denote the common smc 14 23 and the optimal smc 30 in fig 7 we can see that two control schemes could force ship to tracking straight reference trajectory successfully in fig 8 the track errors are larger at the beginning or turning points because of the initial errors or the large inertia of under actuated ship but can decrease to 0 quickly in fig 9 ϕ and u have variable values due to the time varying disturbances such as wind current and wave they could converge to the designed virtual heading ϕ d and surge velocity u d accurately the above results can illustrate the effectiveness of the proposed controller to address the uncertain parameters and external disturbances in fig 10 control inputs δ and n are also variable owning to the environmental disturbances they are always limited within the constrains δ max and n max respectively meanwhile δ qpsmc and n qpsmc are smoother at the turning points fig 11 shows the information of input increments δδ and δn which are also limited within the constrains δδ max and δn max fig 12 describes the ability of the designed esos which can estimate f r and f u accurately although there are a few oscillations at the turning points f reso and f ueso could approximate f r and f u in a short time case2 curve trajectory initial states x y ϕ 0 100m 0 u v r 6 m s 0 0 control parameters k x1 1 2 k x2 0 005 k y1 0 62 k y2 0 05 k ϕ1 0 08 k ϕ2 0 08 k ϕ3 0 08 k u1 0 15 k u2 0 1 k u3 0 1 p 1 1 p 2 0 5 p 3 0 1 q 1 1 q 2 0 2 q 3 0 1 others parameters are the same as the case 1 the simulation results are shown in figs 13 18 in figs 13 to 18 the subscripts are the same as the case 1 in fig 13 we can see that two control schemes could force ship to tracking the curve reference trajectory successfully in fig 14 the track errors are larger at the beginning due to the initial errors but can decrease to 0 in a short time about 400s in fig 15 ϕ and u have variable values two reasons may contribute to this phenomenon one is the influences of the time varying disturbance another reason is that ship heading need to follow the tangent variable direction of the curve trajectory ϕ and u could converge to virtual heading ϕ d and surge velocity u d accurately in fig 16 the control inputs δ and n are also variable the reasons are the same as ϕ and u furthermore δ and n are always limited within the constrains δ max and n max respectively meanwhile δ qpsmc and n qpsmc are smooth at the beginning fig 17 shows the information of the input increments δδ and δn which are also limited within the constrains δδ max and δn max fig 18 describes the ability of the designed esos which can estimate f r and f u accurately although there are a few oscillations at the beginning f reso and f ueso could approximate f r and f u quickly 7 conclusions this paper proposes an optimal smc algorithm with the eso for trajectory tracking of under actuated ship firstly two virtual control laws are designed by the backstepping method and kinematic model which can convert trajectory tracking into the heading control and surge velocity control then a heading model and a surge velocity model are built respectively two esos are built to estimate total unknowns in the heading model and surge velocity model meanwhile the smc method is used to achieve the heading control and surge velocity control the designed rudder angle and propeller revolution are embedded in a cost function which is solved under the constraints finally the stability analysis illustrates the feasibility of the presented algorithm the simulations show that the controller can force ship to track the straight or curve trajectory successfully in case of the time varying disturbances the control inputs are also abounded and smooth these results could demonstrate the effectiveness of the presented method author contribution zongxuan li methodology resources writing original draft renxiang bu conceptualization writing review editing funding acquisition funding this work is supported in part by the national natural science foundation of china 51939001 61976033 51679216 the fundamental research funds for the cornell university 3132019345 3132020137 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20668,with the growth of global warming the scope and the thickness of sea ice decrease drastically in order to monitor this trend polar geophysical vessels travel to the polar region frequently the resistance of the geophysical exploration ships in polar areas will increase due to the change of the environments and the towing operation of those ships will also be affected thus it is of great significance to carry out ice load analysis and parameter sensitivity research on the geophysical exploration ship in ice floe environments in the present paper the numerical curve of the ice load over time has been obtained via fem simulation the influence of sensitivity parameters speeds and ice sizes on the towing cables has been analyzed on the basis of the calculation results an empirical formula suitable for the collision between towing cables and ice has been summarized and verified keywords towing cables ice breaking area collision between cables and ice time history curve of ice load fluid structure interaction 1 introduction in the arctic human development report einarsson et al 2015 signed by arctic countries it has pointed out that the development and transportation of polar oil and gas in the future will play a decisive role in the economic development of the adjacent arctic region and the sustainable development of the world economy and society according to the assessment report issued by united states geological survey usgs 2008 the arctic region occupies 13 of the world s unproved oil reserves and the reserves of undeveloped natural gas and coal resources account for 30 and 9 of the world s total reserves respectively according to the report of the national snow and ice data center nsidc from 2007 to 2020 arctic sea ice extent has a downward trend of 4 0 percent per decade the reduction of sea ice area provides many favorable conditions for oil exploitation so increasing number of ships in the ice area enter the arctic sea area however the natural environment in the arctic area is still undesirable and ships are greatly affected by the ice load because polar geophysical exploration ships need to enter re enter and withdraw from the polar area and other open sea areas every year the floating ice environment and different ice conditions under the ice conditioning environment in polar sea area will greatly impact on ship resistance resistance will affect the towing capacity of polar geophysical exploration ship which has a significantly effect on the economy and efficiency of such vessels the geophysical exploration ship is a special kind of vessels for marine physical exploration which is applied constantly in the process of offshore oil or gas exploration and development offshore oil development can be divided into three major stages which includes exploration development and production as a key equipment in the exploration stage geophysical exploration ship can operate on large sea area providing geological data support for subsequent ship operation the working schematic diagram of geophysical exploration ship is shown in fig 1 therefore the design and construction capacity of a national geophysical exploration ship represents the ability to independently explore and develop offshore oil the research on ship collision began in 1958 minorsky considered the extent of penetrations in ship collisions particularly the collisions of nuclear powered ships the earlier study of ice load was in 1994 phillips and tanaka of the university of ottawa described a method for time domain simulation of hullgirder stresses in icebreaking ships during collisions with multi year ice lebedev and tripol nikov 2012 considered a potential risk for the marine structures caused by the collision with drifting ice formations icebergs stamukhas and pack ice and gave the information analysis of the risk category for the marine structures of the barents sea water area caused by the collision with icebergs in recent years many researchers have begun to pay attention to the numerical calculation of ice load on structures in the floating ice area focusing on the influence of ice thickness ice size density and relative velocity on ice load toyota et al 2016 indicated that one role of wave ice interaction was to modulate the fsd floe size distribution that already existed in the interior ice region rather than directly determined it wang and derradjiaouat 2010 used one of the standard icebreaker models a model for the canadian icebreaker terry fox in the numerical simulations in two different concentrations 80 and 60 of pack ice conditions comparisons between numerical and experimental results are shown and main conclusions are pointed out nguyen et al 2009 established a mathematical model for simulating the behavior of a dynamic positioned vessel operating in level ice alawneh et al 2015 regarded ice as a group of discrete objects with very simple properties and simulated system mechanics as a group of discrete contact and failure events this method was called ice event mechanics modeling iemm method gagnon 2011 based on the experimental phenomena of floating ice acting on ship model a method of simulating sea ice constitutive model by using foam material was put forward this material had certain advantages in explaining the mutual transformation of high and low pressure zones observed in the experiment and the melting of sea ice on the surface of high pressure area marnix et al 2019 studied the interaction between the vertical shape structure and the floating ice field by the method of numerical calculation and experimental research it was found that the shape of the floating ice had a great influence on the average value and the standard deviation of the ice load in the direction of the structure movement tsarau et al 2014 established the hydrodynamic numerical model of floating structure and ice floe based on the discrete element and boundary element the model ignored the influence of waves on the motion of ice floe assuming the hull as a rigid body the potential flow theory was used to analyze the flow field characteristics of the ship in the ice floe environment the present paper is focusing on the ice load exerted on the towing cables on the geophysical exploration vessels specifically in the ice breaking area due to collision the influence of various parameters on the ice load has been investigated the existing theoretical methods and formulas for calculating ice load have been summarized the fe program has been applied to calculate the ice load on single cable and single ice the effects of ice shape size and angle of towing cables ice and etc have been considered in the modeling of multi cables and ice breaking area the ice breaking area model has been established the ice breaking area programming with random position and without overlap has been presented according to the existing coordinates all cables models have been provided to simulate the process of cables going through the ice breaking area 2 research progress of ice load there are three kinds of ice load calculation methods including theoretical calculation numerical simulation and experimental method this part focuses on the research progress of ice load theoretical calculation theoretical calculation requires that the physical model should be determined first according to the calculation object the corresponding theory should be selected and then the empirical formula should be used for calculation the source of the empirical formula is not only theoretical derivation but also experimental data recursion 2 1 ice induced vibration ice induced vibration theory is generally used to calculate the fatigue life of structures under complex environmental loads ice current wave etc according to different research methods objects conditions and focus of researchers the theoretical models used are different here are some representative vibration theories models 2 1 1 forced vibration theory ice induced vibration theory is generally used to calculate the fatigue life of structures under complex environmental loads ice current wave etc according to different research methods objects conditions and focus of researchers the theoretical models used are different here are some representative vibration theories models 1 m x c x kx f t where x x x are the displacement velocity and acceleration vectors of the structure and m c and k are the mass damping and stiffness matrices of the structure 2 1 2 matlock model as shown in fig 2 ice floe is regarded as elastic brittle beam with equal space and the space is the crushing length when the ice sheet moves the front edge of the ice sheet contacts with the structure and the sea ice has elastic deformation when the deformation exceeds a certain value the ice sheet breaks and the ice sheet is separated from the structure the ice sheet continues to move until the next contact the ice force formula of this model is as follows 2 f t f max δ t δ max in eq 2 fmax is the maximum static ice force which can be calculated by korzhavin afanasev formula δ max is the maximum deformation before breaking δ t is the sea ice deformation and it is a function of speed time and structural displacement 2 1 3 self excited vibration theory the natural vibration system relies on the external energy as supplement and takes itself as regulator to control the energy input according to the theory of self excited vibration the ice force does not have periodicity but there is a functional relationship between the sea ice strength and the change of loading speed when the loading speed changes it may produce negative damping which makes the ice force show periodicity the negative damping is mainly aimed at the relationship between uniaxial compressive strength and loading rate in the range of high loading rate the ice strength decreases with the increase of velocity resulting in the reduction of damping and the formation of negative damping instead of considering the original frequency of ice force the dynamic ice force is only expressed as a function of the structural speed response the model considers the response of ice breaking frequency and ice strength to loading rate the model has the following properties 1 self excitation with stable limit cycle 2 periodicity which can generate dynamic response with linear structure system 3 sawtooth ice force time history curve the equation of ice force oscillator is as follows 3 c ω 0 α r c β c 2 c ω 0 2 c b v 0 in the formula c is the dimensionless ice force coefficient as the basic variable c σ σ b σ is the instantaneous ice stress σ b is the ultimate stress of ice v 0 is the ice speed ω 0 is the original frequency of ice α β γ and b are all undetermined parameters which depend on the nature of ice there is a unique solution when there is a certain proportion between them it can be seen from the above theories that although the factors considered in the model are different they are all used to solve the fatigue life of structures in complex environment through the vibration theory and the purpose of this model is to solve cables ice collision which is not in line with the purpose of the vibration related theory so these theories are not suitable for this model 2 2 continuous ice breaking model the model is suitable for the icebreaker to break the ice and move forward steadily under the thrust of propeller based on the principle of energy conservation the model calculates the ice load analytically firstly it is assumed that the kinetic energy of the ship is converted into the energy loss when the ship is squeezed and the potential energy increased when the ship is climbing on the ice the squeezing pressure is determined by the product of the contact area and the squeezing strength of the basic formula then it is discussed in two cases one is that only the upper surface of the ice layer is extruded that is the contact surface is triangular the other is extruded to the lower surface of the ice layer and the contact surface is trapezoid the expression of the contact surface is solved respectively and the maximum extrusion displacement is obtained to obtain the extrusion pressure of ice floes it is verified by numerical simulation that the theoretical calculation value is larger than the simulation result in the numerical simulation a part of kinetic energy of the ship is converted into friction energy so the ice force value is smaller it can be seen from fig 3 there are two main elements of continuous ice breaking one is continuous the other is ice breaking cables ice model does not involve ice breaking and the design process of the towing cables will not require ice breaking capacity moreover the ice area of cables movement can only be the ice breaking area if it meets a complete ice floe it will lead to the failure of the towing cables therefore the continuous ice breaking model is not suitable for the calculation of ice load on towing cables 2 3 squeeze ice load static ice force generally speaking the squeeze ice force acting on the flexible structure is called static ice force here are three representative formulas 2 3 1 korzhavin afanasev formula this is a semi empirical and theoretical formula recommended by api rp2n which is also one of the most widely used formulas in engineering at present the expression is as follows 4 f im k d h σ c where i is the local extrusion coefficient m is the coefficient considering the shape of the contact surface between the structure and ice generally 0 9 for the cylinder k is the contact condition coefficient σ c is the compressive strength of sea ice d is the width or diameter of the structure and h is the ice thickness the general formula of the complete empirical formula is as follows 5 f β d 0 5 h γ σ c where β and γ are correction coefficients the complete empirical formula is generally based on the data fitting obtained in a certain environment and its application range is relatively limited similar korzhavin afanasev formula hirayama schwarz is another squeeze equation it is 6 f s 3 57 d 0 5 h 1 1 σ c here if d 0 8 m h 0 06 m m 0 9 k 0 1 σ c 1 10 6 p a then the ice load will be calculated in eqs 5 and 6 which are shown in eq 7 the results will be used to verify the simulation results 7 f s k a 0 4 10 5 n f s h s 6 8 10 5 n 2 3 2 q hsn 3000 standard according to q hsn 3000 2002 standard china sea ice conditions and application regulations the main ice load form of vertical pile leg offshore structure is extrusion ice load the expression of ice force on isolated structure is consistent with korzhavin afanasev formula but the standard points out that the determination method of i and k is the product of the two is determined by empirical formula 8 i k 3 57 h 0 1 d 0 5 where d and h are the diameter and ice thickness of the structure respectively although the principle of cables ice collision is similar to that of extrusion this model can be used theoretically because it is used to calculate the towing cables behind the polar geophysical exploration ship however the extrusion model is mainly applicable to the ice sheet intact ice rather than the ice breaking area from the formula it can be seen that the ice load is only related to the ice thickness and the compressive strength of ice the peak value of the ice load in the extrusion formula occurs at the time before the ice sheet breaks it can be roughly considered that the ice size is the breaking length at this time when the ice thickness and compressive strength are fixed the breaking strength is determined in the actual ice crushing area both the density and the size of crushed ice will affect the ice load it can be seen that the theoretical ice used to calculate the ice load at present is not suitable for the calculation of ice load of towing cables so it can only rely on the method of numerical simulation 3 numerical simulation analysis of cables and ice collision 3 1 collision of single cable and single ice by using the finite element software ls dyna the impact of single cable and ice is calculated the influence of different sensitivity parameters on the final results is studied 3 1 1 towing cables model the model is established by beam element the material parameters are shown in table 1 3 1 2 parameters of contrast conditions for single cable single ice collision the effects of three variables on ice load are mainly studied which are the angle between towing cables and ice the shape and size of ice for the angle between towing cables and ice there are mainly two different types the first is that cable is inclined to the ice block with an angle of 45 with the horizontal plane as shown in fig 4 the second type is parallel to the contact surface of the ice and cables is vertical as shown in fig 5 for the shape of ice two different shapes are compared the first is regular hexahedron the second is pentahedron the collision position is an angle of pentahedron as shown in fig 6 in order to ensure the rationality of the results the volume of pentahedron is consistent with that of hexahedron for the size of ice the ice blocks of 1 m 1 m 0 8 m and 10 m 10 m 0 8 m are set respectively in order to make the comparison more obvious a small section of the same size is selected for the towing cables the model is shown in fig 7 the overall design conditions are shown in table 2 3 1 3 analysis of grid convergence in order to verify the convergence of the grid three different kinds of grid generation are carried out for case 1 as shown in fig 8 each piece of ice in fig a is equally divided into 125 units the grid of the same size as fig a is used for subsequent calculation in fig b each piece of ice is equally divided into 64 units in fig c each piece of ice is equally divided into 216 units the results of the three models are shown in fig 9 it can be seen from the results that although the grid division is different the results are basically consistent and the peak value is about 100 n so the numerical results are convinced and the adopted grid of 125 units is reasonable 3 1 4 calculation results the output force impact force time history curve is the ice load time history curve since the motion direction of some cables is set along the positive direction of the coordinate axis the resultant force is along the negative direction of the coordinate axis finally the magnitude of the force is used to compare with each other ignoring its positive and negative values from the results of table 3 we can find that the three variables have an impact on the ice load from the comparison of condition 1 and condition 2 condition 3 and condition 4 condition 5 and condition 6 it can be found that the force of cables in inclined state is less than that in vertical state from the comparison of condition 1 and condition 3 condition 2 and condition 4 it is found that the ice load from the collision between cables and the pentahedron is larger than that from the hexahedron from the comparison of condition 1 and condition 5 condition 2 and condition 6 it is found that the larger the volume of ice the greater the ice load in the later calculation different sizes and shapes of ice will be considered in the collision between multi cables and ice breaking zone 3 2 model establishment and parameter setting of multi cables and ice breaking zone the numerical simulation of cables ice collision includes cables broken ice air and water the ideal elastic plastic model is selected for cables material and the isotropic elastic fracture model is selected for the ice breaking material the state equation needs to be set up for the air and water area the details are described in the following 3 2 1 towing cables model the geometric coordinates of the towing cables are provided by the supporting project development of polar 18 cables geophysical exploration ship type since the eighteen cables are symmetrically distributed on the port and starboard sides in order to simplify the calculation process only 9 cables are built on one side of the model the specific distribution is shown in fig 10 3 2 2 ice breaking model according to the data the number of ice fragments of different sizes in the arctic channel conforms to the lognormal distribution therefore according to the probability of ice breaking of different sizes a square with a side length of 1 m 1 m is preliminarily selected and the thickness is selected as 0 8 m according to the data given in the project in order to reduce the error the distribution of ice fragments is completely random in order to facilitate the modeling a simulation software for ice breaking area is developed the software can generate a certain number and size of broken ice in the specified area with random location and no contact with each other in order to make the nine cables pass through the ice breaking area smoothly the y direction length of the ice area is slightly larger than the maximum value of cables and the x direction length needs to ensure that cables move in the ice area within a certain period of time in order to reduce the influence of contingency and get the accurate ice load the movement time should not be too short the size of the ice breaking area is set as 900 m 100 m and the ice crushing density the ratio of the total area of crushed ice to the total area of the area is temporarily taken as 0 6 the arrangement of the ice area and the location coordinates of the broken ice are obtained in the software as shown in fig 11 extract the location coordinates of broken ice edit it into block command and generate the specified ice breaking area in ansys the model of towing cables and ice area is shown in fig 12 3 2 3 fluid model when ls dyna carries out fluid structure coupling analysis there are generally two algorithms one is lagrange eulerian method the other is common node method the latter is equivalent to the application of solid boundary conditions which cannot solve the interaction in this paper ice water and cables water coupling analysis are simulated so the former is used ice and cables are defined as lagrange entities while air and water are eulerian entities fluid structure coupling is the core algorithm of numerical simulation of cables ice collision so the size of fluid mesh size and parameter setting are the key factors affecting the results of numerical simulation the water area is larger than the ice breaking area to ensure the normal collision of cables ice and reduce the pool wall effect the length and width of air area and water area are consistent the whole fluid finite element model is shown in fig 13 3 2 4 overall model of cables ice collision the entire finite element model is shown in fig 14 the air area is not shown there are 413338 elements 8320 beam cells 405018 solid cells and 889763 nodes in the whole model in the process of numerical simulation there is collision between cables and broken ice the principal and secondary surfaces in the collision of cables and ice are cables part and ice breaking part respectively and the main and secondary surfaces of collision between broken ice are all ice breaking parts in this model the ice breaking state is still according to the project report the working speed of the geophysical exploration ship is 5 knots 2 572 m s 3 3 working condition design in this model through numerical simulation method the ice load caused by the collision of towing cables passing through the ice breaking area is explored the effects of various factors on the ice load are discussed with the relative velocity size and density of ice as variables the specific working conditions are designed as follows firstly the relative velocity is determined to be 5 knots 2 572 m s and the ice size is 0 5 m 0 5 m 1 m 1 m 1 5 m 1 5 m 2 m 2 m 2 5 m 2 5 m 3 m 3 m 3 5 m 3 5 m 4 m 4 m respectively the ice thickness remains unchanged at 0 8 m then keep the ice size of 1 m 1 m unchanged set the speed of 3 5 knots 4 5 knots 5 knots 5 5 knots 6 5 knots 7 5 knots respectively and the converted into international units are 1 801 m s 2 315 m s 2 572 m s 2 829 m s 3 344 m s 3 858 m s 5 144 m s respectively considering the different speed and the same sailing distance the physical time of each setting is different two different crushing densities were considered 0 6 and 0 4 respectively the parameters are shown in table 4 3 4 working conditions and results 3 4 1 analysis of collision results as shown in fig 15 the figure shows the instantaneous collision result of the towing cable in the ice breaking area at a certain moment it can be seen from the figure that with the movement of the towing cable the collision between the cable and the broken ice occurs continuously the towing cable pushed a lot of broken ice together under the action of towing cable ice fragments accumulated destroyed and rotated as shown in fig 16 fig 17 and fig 18 the 16 working conditions mentioned above and some phenomena in collision have been analyzed the results have been shown in figs 19 34 from the two diagrams in condition 2 it can be seen that the time and magnitude of the force on each cable are different when multiple cables pass through the ice breaking zone according to the time history curves of ice load with different sizes of broken ice it can be seen that the curves are completely random the numerical value has no obvious regularity and no specific period the curve is composed of innumerable single collisions so the curve is not continuous but is composed of discrete broken line graph due to the short collision time it looks like a lot of straight lines visually when comparing the ice load with different ice breaking size the peak value of each working condition is selected and the influence of parameters on ice load is observed it can be seen from the sixteen pictures that the curve is still random without obvious period or size rule with the increase of relative velocity the ice load also increases and the number of collisions increases obviously with the increase of velocity in the condition of low speed the number of collisions is also relatively small the change of broken ice density has no effect on the ice load 3 4 2 effect of ice size on ice load according to the design condition the relative speed is 5kn 2 572 m s the length and width are from 0 5 m 0 5 m 4 m 4 m the following analysis is based on the ice load time history curve of working conditions 1 8 the maximum ice load of condition 1 8 is shown in table 5 according to the time history curve of ice load it can be seen that the ice load is random the curve is pulsating waveform and the size and period of ice load are not regular the extremum points of the ordinate are extracted and the ice size is taken as the abscissa and the ice load as the ordinate the scatter diagram of the extreme value of ice load and the size of broken ice is drawn and the relationship is studied by fitting the trend line the relationship between the extreme value of ice load and the size of broken ice is drawn through the calculation results it can be seen that the relationship between the extreme value of ice load and the size of broken ice is proportional to each other if the extreme value of ice load increases with the increase of the size of crushed ice the extreme value of ice load can be written as y 112147x2 2395 3 4 3 effect of relative velocity on ice load figs 23 29 shows the time history curves of ice load under condition 9 15 with different relative speeds condition 15 is used to verify the calculated formula which is based on condition 9 14 according to the relative velocity the maximum ice load of condition 9 14 is shown in table 6 the extreme coordinates of each working condition are extracted and the scatter diagram of ice load extreme value and relative velocity is given and the relationship curve is obtained by fitting as shown in fig 36 it can be seen that with the increase of relative velocity the extreme value of ice load gradually increases from the perspective of momentum the faster the speed is the greater the momentum is and the collision force will be greater in the short action time of collision expressed by function relation we can write the relation of power function y 42747x1 3154 3 4 4 fitting ice load equation and its verification here it is considered that the ice load of towing cables in the ice breaking area is only related to the relative velocity and the size of broken ice 9 f k l 2 2395 v 1 3154 where k is the parameter obtained by data fitting taken as 3 9 104 l is the side length of broken ice and v is the relative velocity of cables ice in order to verify the formula the relative speed is taken as 10 kn 5 144 m s the numerical simulation results are shown in fig 29 and the value is 3 41e5n from eq 8 the calculated result is 3 5e5n the comparison results are shown in table 7 it is found that there is little difference between the results of the ice load equation and that of the numerical simulation in addition according to korzhavin afanasev and hirayama schwarz formula the result is between these two equations it is proved that the simulation results are credible 4 conclusions the research progress of ice load theory is introduced through comparison it is found that the commonly used theoretical formula of ice load is not suitable for cables and ice collision model and the calculation results cannot be obtained through the theory therefore a simulation method is established to analysis the ice load firstly the ice load of single ice and single cable collision model is preliminarily calculated to explore the influence of ice shape ice size and cables shape on the force during collision the results show that the change of the three will lead to the change of the final results the ice load of the towing cables in the inclined state is less than that in the vertical state the ice load from the collision between cables and the pentahedron is greater than that from the hexahedron the larger the ice volume the greater the ice load in the present paper an ice breaking area is built up by programming the size and density of broken ice can be set in the program for multiple cables collision with ice broken area it is found that both the size of ice fragments and the relative velocity of cables ice have a great influence on the ice load of towed cables the larger the length of ice breaking size and the greater the relative velocity of cables ice the greater the ice load the empirical formula for calculating the ice load of cables is obtained by fitting the data the research in this article provides technical supports for exploring polar resources credit authorship contribution statement wei wang methodology analysis formal analysis writing review editing zhonghao ren computation analysis formal analysis writing gang ma rwriting review editing yang liu writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors are grateful to high tech ship project ship type development of polar eighteen cables geophysical exploration ship for funding this research 
20668,with the growth of global warming the scope and the thickness of sea ice decrease drastically in order to monitor this trend polar geophysical vessels travel to the polar region frequently the resistance of the geophysical exploration ships in polar areas will increase due to the change of the environments and the towing operation of those ships will also be affected thus it is of great significance to carry out ice load analysis and parameter sensitivity research on the geophysical exploration ship in ice floe environments in the present paper the numerical curve of the ice load over time has been obtained via fem simulation the influence of sensitivity parameters speeds and ice sizes on the towing cables has been analyzed on the basis of the calculation results an empirical formula suitable for the collision between towing cables and ice has been summarized and verified keywords towing cables ice breaking area collision between cables and ice time history curve of ice load fluid structure interaction 1 introduction in the arctic human development report einarsson et al 2015 signed by arctic countries it has pointed out that the development and transportation of polar oil and gas in the future will play a decisive role in the economic development of the adjacent arctic region and the sustainable development of the world economy and society according to the assessment report issued by united states geological survey usgs 2008 the arctic region occupies 13 of the world s unproved oil reserves and the reserves of undeveloped natural gas and coal resources account for 30 and 9 of the world s total reserves respectively according to the report of the national snow and ice data center nsidc from 2007 to 2020 arctic sea ice extent has a downward trend of 4 0 percent per decade the reduction of sea ice area provides many favorable conditions for oil exploitation so increasing number of ships in the ice area enter the arctic sea area however the natural environment in the arctic area is still undesirable and ships are greatly affected by the ice load because polar geophysical exploration ships need to enter re enter and withdraw from the polar area and other open sea areas every year the floating ice environment and different ice conditions under the ice conditioning environment in polar sea area will greatly impact on ship resistance resistance will affect the towing capacity of polar geophysical exploration ship which has a significantly effect on the economy and efficiency of such vessels the geophysical exploration ship is a special kind of vessels for marine physical exploration which is applied constantly in the process of offshore oil or gas exploration and development offshore oil development can be divided into three major stages which includes exploration development and production as a key equipment in the exploration stage geophysical exploration ship can operate on large sea area providing geological data support for subsequent ship operation the working schematic diagram of geophysical exploration ship is shown in fig 1 therefore the design and construction capacity of a national geophysical exploration ship represents the ability to independently explore and develop offshore oil the research on ship collision began in 1958 minorsky considered the extent of penetrations in ship collisions particularly the collisions of nuclear powered ships the earlier study of ice load was in 1994 phillips and tanaka of the university of ottawa described a method for time domain simulation of hullgirder stresses in icebreaking ships during collisions with multi year ice lebedev and tripol nikov 2012 considered a potential risk for the marine structures caused by the collision with drifting ice formations icebergs stamukhas and pack ice and gave the information analysis of the risk category for the marine structures of the barents sea water area caused by the collision with icebergs in recent years many researchers have begun to pay attention to the numerical calculation of ice load on structures in the floating ice area focusing on the influence of ice thickness ice size density and relative velocity on ice load toyota et al 2016 indicated that one role of wave ice interaction was to modulate the fsd floe size distribution that already existed in the interior ice region rather than directly determined it wang and derradjiaouat 2010 used one of the standard icebreaker models a model for the canadian icebreaker terry fox in the numerical simulations in two different concentrations 80 and 60 of pack ice conditions comparisons between numerical and experimental results are shown and main conclusions are pointed out nguyen et al 2009 established a mathematical model for simulating the behavior of a dynamic positioned vessel operating in level ice alawneh et al 2015 regarded ice as a group of discrete objects with very simple properties and simulated system mechanics as a group of discrete contact and failure events this method was called ice event mechanics modeling iemm method gagnon 2011 based on the experimental phenomena of floating ice acting on ship model a method of simulating sea ice constitutive model by using foam material was put forward this material had certain advantages in explaining the mutual transformation of high and low pressure zones observed in the experiment and the melting of sea ice on the surface of high pressure area marnix et al 2019 studied the interaction between the vertical shape structure and the floating ice field by the method of numerical calculation and experimental research it was found that the shape of the floating ice had a great influence on the average value and the standard deviation of the ice load in the direction of the structure movement tsarau et al 2014 established the hydrodynamic numerical model of floating structure and ice floe based on the discrete element and boundary element the model ignored the influence of waves on the motion of ice floe assuming the hull as a rigid body the potential flow theory was used to analyze the flow field characteristics of the ship in the ice floe environment the present paper is focusing on the ice load exerted on the towing cables on the geophysical exploration vessels specifically in the ice breaking area due to collision the influence of various parameters on the ice load has been investigated the existing theoretical methods and formulas for calculating ice load have been summarized the fe program has been applied to calculate the ice load on single cable and single ice the effects of ice shape size and angle of towing cables ice and etc have been considered in the modeling of multi cables and ice breaking area the ice breaking area model has been established the ice breaking area programming with random position and without overlap has been presented according to the existing coordinates all cables models have been provided to simulate the process of cables going through the ice breaking area 2 research progress of ice load there are three kinds of ice load calculation methods including theoretical calculation numerical simulation and experimental method this part focuses on the research progress of ice load theoretical calculation theoretical calculation requires that the physical model should be determined first according to the calculation object the corresponding theory should be selected and then the empirical formula should be used for calculation the source of the empirical formula is not only theoretical derivation but also experimental data recursion 2 1 ice induced vibration ice induced vibration theory is generally used to calculate the fatigue life of structures under complex environmental loads ice current wave etc according to different research methods objects conditions and focus of researchers the theoretical models used are different here are some representative vibration theories models 2 1 1 forced vibration theory ice induced vibration theory is generally used to calculate the fatigue life of structures under complex environmental loads ice current wave etc according to different research methods objects conditions and focus of researchers the theoretical models used are different here are some representative vibration theories models 1 m x c x kx f t where x x x are the displacement velocity and acceleration vectors of the structure and m c and k are the mass damping and stiffness matrices of the structure 2 1 2 matlock model as shown in fig 2 ice floe is regarded as elastic brittle beam with equal space and the space is the crushing length when the ice sheet moves the front edge of the ice sheet contacts with the structure and the sea ice has elastic deformation when the deformation exceeds a certain value the ice sheet breaks and the ice sheet is separated from the structure the ice sheet continues to move until the next contact the ice force formula of this model is as follows 2 f t f max δ t δ max in eq 2 fmax is the maximum static ice force which can be calculated by korzhavin afanasev formula δ max is the maximum deformation before breaking δ t is the sea ice deformation and it is a function of speed time and structural displacement 2 1 3 self excited vibration theory the natural vibration system relies on the external energy as supplement and takes itself as regulator to control the energy input according to the theory of self excited vibration the ice force does not have periodicity but there is a functional relationship between the sea ice strength and the change of loading speed when the loading speed changes it may produce negative damping which makes the ice force show periodicity the negative damping is mainly aimed at the relationship between uniaxial compressive strength and loading rate in the range of high loading rate the ice strength decreases with the increase of velocity resulting in the reduction of damping and the formation of negative damping instead of considering the original frequency of ice force the dynamic ice force is only expressed as a function of the structural speed response the model considers the response of ice breaking frequency and ice strength to loading rate the model has the following properties 1 self excitation with stable limit cycle 2 periodicity which can generate dynamic response with linear structure system 3 sawtooth ice force time history curve the equation of ice force oscillator is as follows 3 c ω 0 α r c β c 2 c ω 0 2 c b v 0 in the formula c is the dimensionless ice force coefficient as the basic variable c σ σ b σ is the instantaneous ice stress σ b is the ultimate stress of ice v 0 is the ice speed ω 0 is the original frequency of ice α β γ and b are all undetermined parameters which depend on the nature of ice there is a unique solution when there is a certain proportion between them it can be seen from the above theories that although the factors considered in the model are different they are all used to solve the fatigue life of structures in complex environment through the vibration theory and the purpose of this model is to solve cables ice collision which is not in line with the purpose of the vibration related theory so these theories are not suitable for this model 2 2 continuous ice breaking model the model is suitable for the icebreaker to break the ice and move forward steadily under the thrust of propeller based on the principle of energy conservation the model calculates the ice load analytically firstly it is assumed that the kinetic energy of the ship is converted into the energy loss when the ship is squeezed and the potential energy increased when the ship is climbing on the ice the squeezing pressure is determined by the product of the contact area and the squeezing strength of the basic formula then it is discussed in two cases one is that only the upper surface of the ice layer is extruded that is the contact surface is triangular the other is extruded to the lower surface of the ice layer and the contact surface is trapezoid the expression of the contact surface is solved respectively and the maximum extrusion displacement is obtained to obtain the extrusion pressure of ice floes it is verified by numerical simulation that the theoretical calculation value is larger than the simulation result in the numerical simulation a part of kinetic energy of the ship is converted into friction energy so the ice force value is smaller it can be seen from fig 3 there are two main elements of continuous ice breaking one is continuous the other is ice breaking cables ice model does not involve ice breaking and the design process of the towing cables will not require ice breaking capacity moreover the ice area of cables movement can only be the ice breaking area if it meets a complete ice floe it will lead to the failure of the towing cables therefore the continuous ice breaking model is not suitable for the calculation of ice load on towing cables 2 3 squeeze ice load static ice force generally speaking the squeeze ice force acting on the flexible structure is called static ice force here are three representative formulas 2 3 1 korzhavin afanasev formula this is a semi empirical and theoretical formula recommended by api rp2n which is also one of the most widely used formulas in engineering at present the expression is as follows 4 f im k d h σ c where i is the local extrusion coefficient m is the coefficient considering the shape of the contact surface between the structure and ice generally 0 9 for the cylinder k is the contact condition coefficient σ c is the compressive strength of sea ice d is the width or diameter of the structure and h is the ice thickness the general formula of the complete empirical formula is as follows 5 f β d 0 5 h γ σ c where β and γ are correction coefficients the complete empirical formula is generally based on the data fitting obtained in a certain environment and its application range is relatively limited similar korzhavin afanasev formula hirayama schwarz is another squeeze equation it is 6 f s 3 57 d 0 5 h 1 1 σ c here if d 0 8 m h 0 06 m m 0 9 k 0 1 σ c 1 10 6 p a then the ice load will be calculated in eqs 5 and 6 which are shown in eq 7 the results will be used to verify the simulation results 7 f s k a 0 4 10 5 n f s h s 6 8 10 5 n 2 3 2 q hsn 3000 standard according to q hsn 3000 2002 standard china sea ice conditions and application regulations the main ice load form of vertical pile leg offshore structure is extrusion ice load the expression of ice force on isolated structure is consistent with korzhavin afanasev formula but the standard points out that the determination method of i and k is the product of the two is determined by empirical formula 8 i k 3 57 h 0 1 d 0 5 where d and h are the diameter and ice thickness of the structure respectively although the principle of cables ice collision is similar to that of extrusion this model can be used theoretically because it is used to calculate the towing cables behind the polar geophysical exploration ship however the extrusion model is mainly applicable to the ice sheet intact ice rather than the ice breaking area from the formula it can be seen that the ice load is only related to the ice thickness and the compressive strength of ice the peak value of the ice load in the extrusion formula occurs at the time before the ice sheet breaks it can be roughly considered that the ice size is the breaking length at this time when the ice thickness and compressive strength are fixed the breaking strength is determined in the actual ice crushing area both the density and the size of crushed ice will affect the ice load it can be seen that the theoretical ice used to calculate the ice load at present is not suitable for the calculation of ice load of towing cables so it can only rely on the method of numerical simulation 3 numerical simulation analysis of cables and ice collision 3 1 collision of single cable and single ice by using the finite element software ls dyna the impact of single cable and ice is calculated the influence of different sensitivity parameters on the final results is studied 3 1 1 towing cables model the model is established by beam element the material parameters are shown in table 1 3 1 2 parameters of contrast conditions for single cable single ice collision the effects of three variables on ice load are mainly studied which are the angle between towing cables and ice the shape and size of ice for the angle between towing cables and ice there are mainly two different types the first is that cable is inclined to the ice block with an angle of 45 with the horizontal plane as shown in fig 4 the second type is parallel to the contact surface of the ice and cables is vertical as shown in fig 5 for the shape of ice two different shapes are compared the first is regular hexahedron the second is pentahedron the collision position is an angle of pentahedron as shown in fig 6 in order to ensure the rationality of the results the volume of pentahedron is consistent with that of hexahedron for the size of ice the ice blocks of 1 m 1 m 0 8 m and 10 m 10 m 0 8 m are set respectively in order to make the comparison more obvious a small section of the same size is selected for the towing cables the model is shown in fig 7 the overall design conditions are shown in table 2 3 1 3 analysis of grid convergence in order to verify the convergence of the grid three different kinds of grid generation are carried out for case 1 as shown in fig 8 each piece of ice in fig a is equally divided into 125 units the grid of the same size as fig a is used for subsequent calculation in fig b each piece of ice is equally divided into 64 units in fig c each piece of ice is equally divided into 216 units the results of the three models are shown in fig 9 it can be seen from the results that although the grid division is different the results are basically consistent and the peak value is about 100 n so the numerical results are convinced and the adopted grid of 125 units is reasonable 3 1 4 calculation results the output force impact force time history curve is the ice load time history curve since the motion direction of some cables is set along the positive direction of the coordinate axis the resultant force is along the negative direction of the coordinate axis finally the magnitude of the force is used to compare with each other ignoring its positive and negative values from the results of table 3 we can find that the three variables have an impact on the ice load from the comparison of condition 1 and condition 2 condition 3 and condition 4 condition 5 and condition 6 it can be found that the force of cables in inclined state is less than that in vertical state from the comparison of condition 1 and condition 3 condition 2 and condition 4 it is found that the ice load from the collision between cables and the pentahedron is larger than that from the hexahedron from the comparison of condition 1 and condition 5 condition 2 and condition 6 it is found that the larger the volume of ice the greater the ice load in the later calculation different sizes and shapes of ice will be considered in the collision between multi cables and ice breaking zone 3 2 model establishment and parameter setting of multi cables and ice breaking zone the numerical simulation of cables ice collision includes cables broken ice air and water the ideal elastic plastic model is selected for cables material and the isotropic elastic fracture model is selected for the ice breaking material the state equation needs to be set up for the air and water area the details are described in the following 3 2 1 towing cables model the geometric coordinates of the towing cables are provided by the supporting project development of polar 18 cables geophysical exploration ship type since the eighteen cables are symmetrically distributed on the port and starboard sides in order to simplify the calculation process only 9 cables are built on one side of the model the specific distribution is shown in fig 10 3 2 2 ice breaking model according to the data the number of ice fragments of different sizes in the arctic channel conforms to the lognormal distribution therefore according to the probability of ice breaking of different sizes a square with a side length of 1 m 1 m is preliminarily selected and the thickness is selected as 0 8 m according to the data given in the project in order to reduce the error the distribution of ice fragments is completely random in order to facilitate the modeling a simulation software for ice breaking area is developed the software can generate a certain number and size of broken ice in the specified area with random location and no contact with each other in order to make the nine cables pass through the ice breaking area smoothly the y direction length of the ice area is slightly larger than the maximum value of cables and the x direction length needs to ensure that cables move in the ice area within a certain period of time in order to reduce the influence of contingency and get the accurate ice load the movement time should not be too short the size of the ice breaking area is set as 900 m 100 m and the ice crushing density the ratio of the total area of crushed ice to the total area of the area is temporarily taken as 0 6 the arrangement of the ice area and the location coordinates of the broken ice are obtained in the software as shown in fig 11 extract the location coordinates of broken ice edit it into block command and generate the specified ice breaking area in ansys the model of towing cables and ice area is shown in fig 12 3 2 3 fluid model when ls dyna carries out fluid structure coupling analysis there are generally two algorithms one is lagrange eulerian method the other is common node method the latter is equivalent to the application of solid boundary conditions which cannot solve the interaction in this paper ice water and cables water coupling analysis are simulated so the former is used ice and cables are defined as lagrange entities while air and water are eulerian entities fluid structure coupling is the core algorithm of numerical simulation of cables ice collision so the size of fluid mesh size and parameter setting are the key factors affecting the results of numerical simulation the water area is larger than the ice breaking area to ensure the normal collision of cables ice and reduce the pool wall effect the length and width of air area and water area are consistent the whole fluid finite element model is shown in fig 13 3 2 4 overall model of cables ice collision the entire finite element model is shown in fig 14 the air area is not shown there are 413338 elements 8320 beam cells 405018 solid cells and 889763 nodes in the whole model in the process of numerical simulation there is collision between cables and broken ice the principal and secondary surfaces in the collision of cables and ice are cables part and ice breaking part respectively and the main and secondary surfaces of collision between broken ice are all ice breaking parts in this model the ice breaking state is still according to the project report the working speed of the geophysical exploration ship is 5 knots 2 572 m s 3 3 working condition design in this model through numerical simulation method the ice load caused by the collision of towing cables passing through the ice breaking area is explored the effects of various factors on the ice load are discussed with the relative velocity size and density of ice as variables the specific working conditions are designed as follows firstly the relative velocity is determined to be 5 knots 2 572 m s and the ice size is 0 5 m 0 5 m 1 m 1 m 1 5 m 1 5 m 2 m 2 m 2 5 m 2 5 m 3 m 3 m 3 5 m 3 5 m 4 m 4 m respectively the ice thickness remains unchanged at 0 8 m then keep the ice size of 1 m 1 m unchanged set the speed of 3 5 knots 4 5 knots 5 knots 5 5 knots 6 5 knots 7 5 knots respectively and the converted into international units are 1 801 m s 2 315 m s 2 572 m s 2 829 m s 3 344 m s 3 858 m s 5 144 m s respectively considering the different speed and the same sailing distance the physical time of each setting is different two different crushing densities were considered 0 6 and 0 4 respectively the parameters are shown in table 4 3 4 working conditions and results 3 4 1 analysis of collision results as shown in fig 15 the figure shows the instantaneous collision result of the towing cable in the ice breaking area at a certain moment it can be seen from the figure that with the movement of the towing cable the collision between the cable and the broken ice occurs continuously the towing cable pushed a lot of broken ice together under the action of towing cable ice fragments accumulated destroyed and rotated as shown in fig 16 fig 17 and fig 18 the 16 working conditions mentioned above and some phenomena in collision have been analyzed the results have been shown in figs 19 34 from the two diagrams in condition 2 it can be seen that the time and magnitude of the force on each cable are different when multiple cables pass through the ice breaking zone according to the time history curves of ice load with different sizes of broken ice it can be seen that the curves are completely random the numerical value has no obvious regularity and no specific period the curve is composed of innumerable single collisions so the curve is not continuous but is composed of discrete broken line graph due to the short collision time it looks like a lot of straight lines visually when comparing the ice load with different ice breaking size the peak value of each working condition is selected and the influence of parameters on ice load is observed it can be seen from the sixteen pictures that the curve is still random without obvious period or size rule with the increase of relative velocity the ice load also increases and the number of collisions increases obviously with the increase of velocity in the condition of low speed the number of collisions is also relatively small the change of broken ice density has no effect on the ice load 3 4 2 effect of ice size on ice load according to the design condition the relative speed is 5kn 2 572 m s the length and width are from 0 5 m 0 5 m 4 m 4 m the following analysis is based on the ice load time history curve of working conditions 1 8 the maximum ice load of condition 1 8 is shown in table 5 according to the time history curve of ice load it can be seen that the ice load is random the curve is pulsating waveform and the size and period of ice load are not regular the extremum points of the ordinate are extracted and the ice size is taken as the abscissa and the ice load as the ordinate the scatter diagram of the extreme value of ice load and the size of broken ice is drawn and the relationship is studied by fitting the trend line the relationship between the extreme value of ice load and the size of broken ice is drawn through the calculation results it can be seen that the relationship between the extreme value of ice load and the size of broken ice is proportional to each other if the extreme value of ice load increases with the increase of the size of crushed ice the extreme value of ice load can be written as y 112147x2 2395 3 4 3 effect of relative velocity on ice load figs 23 29 shows the time history curves of ice load under condition 9 15 with different relative speeds condition 15 is used to verify the calculated formula which is based on condition 9 14 according to the relative velocity the maximum ice load of condition 9 14 is shown in table 6 the extreme coordinates of each working condition are extracted and the scatter diagram of ice load extreme value and relative velocity is given and the relationship curve is obtained by fitting as shown in fig 36 it can be seen that with the increase of relative velocity the extreme value of ice load gradually increases from the perspective of momentum the faster the speed is the greater the momentum is and the collision force will be greater in the short action time of collision expressed by function relation we can write the relation of power function y 42747x1 3154 3 4 4 fitting ice load equation and its verification here it is considered that the ice load of towing cables in the ice breaking area is only related to the relative velocity and the size of broken ice 9 f k l 2 2395 v 1 3154 where k is the parameter obtained by data fitting taken as 3 9 104 l is the side length of broken ice and v is the relative velocity of cables ice in order to verify the formula the relative speed is taken as 10 kn 5 144 m s the numerical simulation results are shown in fig 29 and the value is 3 41e5n from eq 8 the calculated result is 3 5e5n the comparison results are shown in table 7 it is found that there is little difference between the results of the ice load equation and that of the numerical simulation in addition according to korzhavin afanasev and hirayama schwarz formula the result is between these two equations it is proved that the simulation results are credible 4 conclusions the research progress of ice load theory is introduced through comparison it is found that the commonly used theoretical formula of ice load is not suitable for cables and ice collision model and the calculation results cannot be obtained through the theory therefore a simulation method is established to analysis the ice load firstly the ice load of single ice and single cable collision model is preliminarily calculated to explore the influence of ice shape ice size and cables shape on the force during collision the results show that the change of the three will lead to the change of the final results the ice load of the towing cables in the inclined state is less than that in the vertical state the ice load from the collision between cables and the pentahedron is greater than that from the hexahedron the larger the ice volume the greater the ice load in the present paper an ice breaking area is built up by programming the size and density of broken ice can be set in the program for multiple cables collision with ice broken area it is found that both the size of ice fragments and the relative velocity of cables ice have a great influence on the ice load of towed cables the larger the length of ice breaking size and the greater the relative velocity of cables ice the greater the ice load the empirical formula for calculating the ice load of cables is obtained by fitting the data the research in this article provides technical supports for exploring polar resources credit authorship contribution statement wei wang methodology analysis formal analysis writing review editing zhonghao ren computation analysis formal analysis writing gang ma rwriting review editing yang liu writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors are grateful to high tech ship project ship type development of polar eighteen cables geophysical exploration ship for funding this research 
20669,this paper addresses the method for estimating maneuvering mathematical models in waves and uses captive model tests to verify it to obtain the wave force and moment two kinds of captive model tests are performed one is straight towing tests with different towing directions to consider various incident wave angles while the other is circular motion tests at different regular wave frequency these captive model tests provide added resistance and wave induced steady force considering both different wave direction and ship speed and different wave drift angles the wave drift forces and moment obtained are validated by performing the maneuvering simulation in waves and comparison with the results of free running model tests this paper introduces the application of the estimation before modeling ebm approach one of the system identification methods to estimate mathematical models for ship maneuverability targeting kriso very large crude oil carrier kvlcc2 the most important force component for the prediction of the maneuverability of a ship is the accuracy of the wave induced steady force acting on the ship here the ebm approach is divided into two steps first the motion variables and forces are estimated by extended kalman filter and modified bryson frazier smoother second the wave induced steady forces are determined by removing the hydrodynamic force acting on the ship during motion also during the second step of the ebm approach the database consisting of wave length and incident wave angles is constructed all estimated variables are based on data obtained by free running model tests in regular waves finally the estimated wave induced steady force is interpolated added to the hydrodynamic force component of the 3 dof equations of motion and the turning simulation of the ship in waves is then performed comparison of the results with the results of free running model tests confirms the validity of the established model keywords maneuvering in waves wave induced steady force system identification model tests numerical analysis nomenclature g gravitational acceleration m s 2 ρ water density k g m 3 u v surge and sway acceleration m s 2 r yaw angular acceleration s 2 u v surge and sway velocity m s r yaw rate s u ship speed m s l length between perpendicular of a subject ship m b beam of a subjected ship m t draft of a subjected ship m v volume of a subjected ship m 3 c b block coefficient of a subjected ship k ii radius of gyration with respect to ii axis m gm t transverse metacentric height m χ 0 absolute wave angle χ incident wave direction during maneuvering λ wave length m h a wave amplitude m fn froude number u g l ω e encountering wave frequency rad s abbreviations si system identification kvlcc2 kriso very large crude oil carrier 2 ebm estimation before modeling frmt free running model test ekf extended kalman filter mbfs modified bryson frazier smoother dof degrees of freedom mmg maneuvering modeling group rps revolutions per second cwnu changwon national university stt straight towing test cmt circular motion test 1 introduction research on ship efficiency has been actively conducted by introducing the energy efficiency design index eedi to regulate a ship s greenhouse gas emissions since the introduction of eedi there has been concern about the possibility of satisfying eedi by lowering the maximum continuous rating mcr of the main engine if the mcr is too low it may be difficult to maintain the ship speed required to maneuver the ship in adverse conditions which can be a great risk for safe navigation to prevent this risk in 2013 the maritime environment protection committee mepc proposed guidelines for minimum propulsion power to maintain the maneuvering of ships in adverse conditions imo mepc 2013 the guidelines state that it should be possible to maintain the heading of a ship at a minimum speed of 4 knots for wind and wave conditions therefore there is a need for analytic methods that can predict ship maneuverability in waves yasukawa 2006 has developed maneuvering equations of motion in waves for the sr108 containership the 4 degrees of freedom equations of motion including wave induced steady forces are considered and 6 degrees of freedom wave exciting forces high frequency problems are considered wave induced steady forces for various incident wave directions were measured for the ship moving straight ahead and used for the verification of numerical analysis yasukawa 2006 proposed a practical simulation method considering wave drift forces only for the sr108 containership and carried out captive model tests to measure the wave drift forces yasukawa 2018 carried out captive model tests to measure wave induced steady forces for four different speeds of the s cb84 model for various regular wave incidence angles in the european union eu s joint study the energy efficient safe ship operation shopera project four research institutes performed various experiments to estimate the added resistance and wave drift forces on the duisburg test case dtc containership and the kriso very large crude oil carrier 2 kvlcc2 tanker model and released the results of free running model tests of the dtc model ships sprenger et al 2017 that paper suggests a method of captive model tests in waves the role of si in ship dynamics has been studied to identify the hydrodynamic coefficients in the hydrodynamic force model abkowitz 1980 and hwang 1980 applied the si method for the first time to estimate the hydrodynamic coefficients of a ship the si method was used for the estimation of coefficients using ekf in this case the hydrodynamic coefficients were augmented in the state variables and were simultaneously estimated together with other state variables however the magnitude of covariance matrix was large and the assumption of the initial values affected the convergence the ebm approach one of the si methods has been mainly used to estimate aircraft parameters hoff and cook 1996 sri jayantha and stengel 1985 yoon and rhee 2003 first applied the ebm approach to resolve the problems detected in the previous study yoon et al 2007 applied the ebm to develop a roll hydrodynamic moment model the main purposes of the abkowitz 1980 hwang 1980 yoon and rhee 2003 and yoon et al 2007 studies are similar in terms of estimating hydrodynamic coefficients however the ebm is divided into two steps first it estimates state variables including motion variables and hydrodynamic force and moments second it estimates the hydrodynamic coefficients using correlation and regression analysis the purpose of this present study is to estimate the wave force and to construct a database instead of estimating the coefficients the ebm approach which uses ekf and mbfs as dynamic state estimators without considering the coefficients as state variables is employed as the si method as the mathematical models that include wave force for the prediction of ship maneuvering in waves yasukawa 2006a developed a practical simulation method that takes only wave drift forces into account in the usual maneuvering simulation model and mentioned its feasibility of predicting maneuverability in waves yasukawa 2006b introduced a practical method for the simulations of both ship maneuvering and wave induced motions and separated the equations of motions into the high frequency wave induced motion problem and the low frequency maneuvering problem in 2013 mepc raised the minimum power guidelines to maintain the stability and the maneuverability of a ship in adverse condition imo mepc 2013 seo et al 2018 for this reason there has recently been growing interest in predicting ship maneuverability in waves seo and kim 2011 and seo et al 2018 calculated wave drift force based on potential theory and validated it by performing maneuvering simulations and by comparison with experimental results this study represents fundamental research into the estimation of wave force including wave drift force using the si method and the development of a mathematical model kim et al 2019 carried out frmts of kvlcc2 in regular waves of various wave lengths all measured values used in this study were derived from the frmts the remainder of this paper is structured as follows chapter 2 introduces mathematical models regarding ship maneuvering in waves while chapter 3 discusses the concepts of ebm and the 1st and 2nd steps of ebm chapter 4 finally performs the maneuvering simulation of a ship in waves using the estimated wave force and compares the results with the trajectory drift index of frmts kim et al 2019 this study also proposes a test technique to estimate the wave induced steady force the stt is a typical test to measure the wave induced steady force by towing a model ship in various directions in a wave basin the cmt is a challenging test that measures wave induced steady force with a minimum number of captive model tests by comparing the results of stt and cmt we want to show the effectiveness of measuring wave induced steady force using the cmt additionally calculation of the wave induced steady force is performed using the potential based numerical analysis program ansys aqwa to check the tendency of the force in regular waves 2 mathematical model considering wave induced steady force 2 1 coordinate system there are two kinds of coordinate systems that describe a ship s horizontal motion the first is the earth fixed coordinate system o x y to express a ship s trajectory the other system is a ship fixed coordinate system o x b y b to define the equations of motion and express the external force acting on a ship both use a right handed orthogonal coordinate system as shown in fig 1 although in the earth fixed coordinate system the absolute wave direction is constant in the ship centered coordinate system when the ship turns the wave incident angle is always altered 2 2 equations of motion equation 1 expresses the 3 dof equations of motion based on newton s 2nd law the right side of the equations describes the external force on a ship maneuvered by steering in waves 1 m u v r x g r 2 x m a n x w a v e m v u r x g r y m a n y w a v e i z z r m x g v u r n m a n n w a v e the subscripts man and wave represent the force due to maneuvering motion and wave respectively this external force can be divided into specific components as shown in eq 2 the following models are based on the mmg model including hydrodynamic hull force thrust and rudder force yasukawa and yoshimura 2015 2 x m a n x u u x v v v 2 x v v v v v 4 x v r v r x r r r 0 1 t p ρ n 2 d 4 k t 1 t r f n sin δ r y m a n y v v y r r y v v y r r y v v v v 3 y v v r v 2 r y v r r v r 2 y r r r r 3 1 a h f n cos δ r n m a n n v v n r r n v v n r r n v v v v 3 n v v r v 2 r n v r r v r 2 n r r r r 3 x r a h x h f n cos δ r it is assumed that the total external force and moment acting on a maneuvering ship in waves can be divided into two components as in eq 1 therefore it is necessary to accurately predict the force and moment in calm water we assumed that the mathematical model parameters regarding external forces in still water are accurate and known values all parameters including hydrodynamic coefficients and interaction coefficients between hull propeller and rudder that are presented in yasukawa and yoshimura 2015 were used in this study the non dimensional expressions of force and moment are defined as eqs 3 and 4 respectively yasukawa and yoshimura 2015 yasukawa 2006a 3 f m a n f m a n 0 5 ρ l d u 2 m m a n m m a n 0 5 ρ l 2 d u 2 4 f w a v e f w a v e ρ g h a 2 b 2 l m w a v e m w a v e ρ g h a 2 b 2 3 estimation of wave induced steady force using the ebm approach 3 1 the concepts of the emb approach the estimation of hydrodynamic coefficients of a ship in still water was adequately explained by yoon and rhee 2003 and yoon et al 2007 fig 2 shows that the ebm approach is divided into two steps the first step is to construct state equations and estimate state variables including motion variables and external force ekf and mbfs are used as the dynamic state estimators the first step in this study is similar to that of the previous study the second step is to determine the wave force based on the external force estimated in the first step by removing the force and moment in calm water expressed in eq 2 3 2 first step of the ebm approach in order to estimate the motion variables and external force and moment the state space model incorporates state and measurement equations the components of the state vector represent the final estimated variables in this step and are defined as in eq 5 5 x x 1 x 2 x 3 t where 6 x 1 u v r t 7 x 2 x y ψ t 8 x 3 x m a n x w a v e x m a n x w a v e x m a n x w a v e y m a n y w a v e y m a n y w a v e y m a n y w a v e n m a n n w a v e n m a n n w a v e n m a n n w a v e the vectors x 1 and x 2 represent motion variables including velocity and displacement respectively while x 3 is the external force and moment since the external force and moment are assumed as third order gauss markov processes the state variable vector includes those first and second order time derivatives yoon and rhee 2003 yoon et al 2007 in order to estimate the state variable vector the state equation which is the dynamic model of the state variable vector is necessary as follows 9 x m f t 1 x w t 10 m t m 0 3 12 0 12 3 i 12 12 11 m m x u 0 0 0 m y v m x g y r 0 m x g n v i z z n r 12 f x m v r x g r 2 x m a n x w a v e m u r y m a n y w a v e m x g u r n m a n n w a v e u cos ψ v sin ψ u sin ψ v cos ψ r x m a n x w a v e x m a n x w a v e 0 y m a n y w a v e y m a n y w a v e 0 n m a n n w a v e n m a n n w a v e 0 matrix 0 3 12 and i 12 12 written in eq 10 represent the zero matrix and identity matrix respectively the vector f x includes coriolis and centrifugal force terms which are known values before solving eq 9 also since it is assumed that the added mass coefficients are known in advance those values are included in the inertia matrix m because the acceleration is not a state variable vector element it is convenient to subtract the force associated with acceleration when estimating force another equation consisting of state space model is the measurement equation kim et al 2019 performed the frmts of kvlcc2 and described its details in this study all measurement data were obtained from frmts the types of measured data include trajectory yaw angle speed yaw rate propeller rps and rudder angle propeller rps and rudder angle are only necessary at the second step of the ebm approach therefore the measurement equation is defined as in eq 13 13 z h x t x y ψ u r t the motion variables and external force and moment are estimated by state estimator there are three kinds of estimators predictor filter and smoother in this study ekf and mbfs were used as the estimators both ekf and mbfs can be used to estimate state variables however mbfs estimates state variables using all the data including past present and future therefore mbfs is more accurate and it is used as the final state estimator yoon and rhee 2003 although mbfs is the final state estimator it needs filtered state variables kalman gain matrix and error covariance matrix calculated by ekf therefore both ekf and mbfs are considered state estimators in the first step of ebm approach fig 3 shows the procedures of ekf and mbfs yoon and rhee 2003 introduced the procedure for estimating the state variables through ekf and mbfs in detail and this paper provides a brief introduction first of all ekf is divided into two steps state prediction and measurement update the state prediction step predicts the present value using the previous estimated value the predicted state variables and error covariance matrix are defined as eqs 14 and 15 14 x k k 1 x k 1 k 1 t k 1 t k x t d t 15 p k k 1 p k 1 k 1 t k 1 t k p t d t where x t can be obtained by solving eq 9 the matrix riccati differential equation to obtain p t includes the jacobian matrix of state equation f x t and is defined as eq 16 16 p t f x t p t p t f t x t q t where 17 f x t f x t x x t x t the measurement update step requires the predicted state variables error covariance matrix measured data jacobian matrix of eq 13 and kalman gain matrix to obtain the estimated state variables equations 18 and 19 are the estimated state variables and error covariance matrix and these values are reused in eqs 14 and 15 to obtain the predicted value at the next step 18 x k k x k k 1 k k δ z k k 1 19 p k k i k k h k p k k 1 i k k h k t k k r k k t k where 20 δ z k k 1 z k z ˆ k k 1 21 z ˆ k k 1 h x ˆ k k 1 t k 22 k k p k k 1 h t k h k p k k 1 h t k r k 1 23 h k h x t k t k x t k the residual δ z k k 1 the so called innovation process is the difference between the measured and predicted values when estimating the state variables x k k kalman gain k k compensates for this difference r k is the measurement noise matrix which is determined by the noise characteristics of measurement sensors h k is the jacobian matrix of measurement equation eq 13 the state variable error covariance matrix is obtained through ekf however all variables obtained from ekf are stored only for mbfs as a more accurate estimator the variables to be stored in order to estimate the final state variables and error covariance through mbfs are x k k k k p k k 1 p k k δ z k k 1 f x t and h k mbfs estimates the values at t t k 1 with the state variables estimated by ekf at the final measurement time t t k as the initial values the initial conditions for the adjoint variable vector and matrix are expressed by 24 λ n 1 n h t n d 1 n δ z n 1 n 25 λ n 1 n h t n d 1 n h n where 26 d n h n p n 1 n h t n r n the time propagation equations of adjoint vector variables and matrix can be expressed as follows using the jacobian matrix of state equations 27 λ t f t x ˆ t λ t 28 λ t f t x ˆ t λ t λ t t f x ˆ t the above differential equations should be solved in the backwards direction of time the solutions obtained by solving eqs 27 and 28 are λ k k and λ k k which are used as variables to solve eqs 29 and 30 which are used for iterative calculations 29 λ k 1 k λ k h t n d 1 n δ z k 1 k d k k t k λ k k 30 λ k 1 k i k k h k t λ k k i k k h k h t k d 1 k h k the final estimated state variables and error covariance matrix using all measurement data can be obtained using eqs 31 and 32 31 x k n x k k p k k λ k k 1 32 p k n p k k p k k λ k k p k k all motion variables force and moment are expressed in full scale dimensions the state variables are estimated based on the first step of the ebm approach first figs 4 and 5 show the estimated motion variables and external forces respectively using the data measured by frmts in still water condition since the speed and yaw rate were measured by frmt they were compared with the estimated values fig 6 shows that the estimated values adequately coincide with the measured values except for the sway velocity force and moment exclusively exist as estimated values fig 5 represents the time series of the forces estimated and calculated using eq 2 to accurately identify the wave force the differences between the results of simulation and estimation should be small therefore in this study the parameters constituting eq 2 were slightly adjusted using the results of frmts fig 5 highlights that the difference between the calculated values using eq 2 and the estimated force is not large figs 6 and 7 show the estimated state variables in waves when the wave length to ship length ratio is equal to 1 0 as in the case of calm water the estimated and measured motion variables coincide well while the total external and wave forces are also consistent the conditions of regular waves were applied to the frmts in this paper we introduce the estimated state variables in calm water and in wave length to ship length ratio 1 0 and absolute wave direction 180 case only as an example the estimated motion variables are used for validation of the wave force model while the estimated force and moment are used for validation and estimation of the wave induced steady force there are two kinds of wave induced motion the measured motion variables include 1st order wave induced motion caused by high frequency oscillatory motions depending on wave encountering frequency and wave induced steady motion caused by wave induced steady force fig 8 shows an example of the measured and estimated wave induced motion when the wave length ratio is 1 0 fig 8 shows that when the estimated motion is subtracted from the measured data the time average is approximately zero this means that the smoothed motion variable and force estimated by mbfs are wave induced steady motion and force respectively 3 3 second step of the ebm approach the second step of the ebm approach involves the estimation of wave force and database construction for wave force fig 9 shows the time series for each force component the total external force f m a n f w a v e is included in the components of state variable vectors written in eq 5 this can be obtained by mbfs in the first step of the ebm approach the force due to maneuvering f m a n is obtained using eq 2 when using eq 2 to calculate f m a n the estimated motion variables written in eq 5 should be substituted into eq 2 at every time step finally the wave force is obtained by subtracting the force due to maneuvering from the total external force when the wave force is obtained using the above calculation procedure it is represented as a function of the encountered wave direction and wave length database construction for the wave force entails tabulation of the results of the force and moment with respect to the encountered wave direction and wave length the details are provided in the next chapter fig 10 shows the dimensionless wave force and moment with respect to incident wave angle during the turning of the ship and the wave length to ship length ratio these forces and moments are obtained by the procedure described in the second step of the ebm approach which triggers drifting trajectory these results are validated by performing simulation and comparison with frmts the distributions of dimensionless wave force and moment shown in fig 8 constitute the database as the components of external force in the mathematical models in eq 1 when performing maneuvering simulation in waves the force and moment are interpolated at every time interval 3 4 validation of the wave induced steady force all types of simulation results shown in fig 11 through 16 are compared with the results of frmts and the estimated ones by mbfs as previously noted accuracy of the maneuvering mathematical model in calm water is required because it significantly affects the estimation process fig 11 shows the simulation results in calm water without considering wave force these are in good agreement with the frmts results except for the initial turning trajectory however it seems that the error in the initial turning in calm water has overall effects on the error in initial turning trajectory in the waves shown in figs 12 16 therefore it is necessary to further improve the accuracy of the mathematical model in terms of the initial trajectory written in eq 2 in the case of trajectory the speed and yaw rate are considered as actual values to be compared otherwise the estimated values are considered the conditions of regular waves include various wave length ratios of 0 5 0 7 1 0 1 2 and 1 5 the wave height and initial wave incident angles are 0 02 l and 180 respectively most of the results exhibit similar trends between the frmts and simulation however the trajectory shifts due to the initial errors involving motion variables and forces in the cases of λ l 0 5 0 7 and 1 5 these are the reasons for the differences between the force estimated by mbfs and that calculated by eq 2 in transient time the transient time refers to the time during steering rudder the force obtained during these intervals represents the wave forces near 180 incident wave angle in figs 12 13 and 16 improvement in the force during transient time enhances the accuracy of the motion variables in particular the error of surge velocity is relatively large because when the ship turns straight motion without lateral and yawing motion is rare therefore it is recommended to perform straightforward tests in various wave length conditions due to the acquisition of accurate axial wave force x w a v e kim et al 2019 summarized the drifting distance and angle at different turning maneuvers in waves it is appropriate that the trajectory drift and angles are defined as the magnitude and direction of a vector between two positions with the headings 360 and 720 expressed as d d r 360 720 and a d r 360 720 respectively fig 17 shows the main indices d d r 360 720 and a d r 360 720 between the frmts and the present simulation in the case of the drifting angle a d r 360 720 the error is within 10 which is similar to that of the frmts 4 estimation of wave induced steady force through model tests and numerical analysis 4 1 test facility and set up captive model tests were performed in the 3 dimensional wave basin at cwnu fig 18 shows the exterior of the wave basin while table 1 describes the main specification as the xy carriage installed in the wave basin moves the yaw table can be rotated at the same time so it is able to implement diagonal towing motions and captive circular motions the kvlcc2 model scaled with 1 223 scale ratio is used as the subject ship for captive model tests the model ship was made of fiber reinforced plastic frp material to maximize the space inside the hull to allow proper matching of the longitudinal and transverse mass distribution with the real ship s condition a sandpaper type turbulence stimulator is attached to the bulbous bow and a rudder is attached to the stern without a propeller yasukawa et al 2018 table 2 lists the principal particulars of the model ship fig 19 describes the configuration of the installed model ship and measurement devices the wave induced steady forces and moment are measured by installing 2 component load cells in front of and behind the origin surge sway and yaw are fixed while heave pitch and roll are free heave pitch and roll motion are measured by potentiometers a resistance type wave probe is used to measure the incident wave height the radius of gyration and transverse metacentric height can be similar by an inertia test and incline test respectively the measured value of transverse metacentric height g m t and radius of gyration k y y l p p measured by performing the incline test and inertia test shown in fig 20 are 2 58 cm and 0 248 respectively the target and measured radius of gyration are roll natural period can be similar by performing a free roll decay test as shown in fig 21 the target roll natural period for the model ship is 1 30 s while the measured roll natural period is 1 24 s and the error is within 5 4 2 test condition and measured data processing captive model tests are divided into the stt and cmt the wave maker in the cwnu wave basin generates waves in one direction so it is a test to measure wave force according to regular wave incidence angle while changing towing direction in the forward diagonal and transverse directions table 3 lists the test conditions of the stt and cmt the stt should be performed with various incident wave directions for one regular wave condition on the other hand in the case of the cmt since the incident wave direction continuously changes during captive turning of the ship there is the advantage that it is not necessary to tow under each wave direction fig 22 shows an example in which the incident wave direction continuously changes while the model ship turns in the wave basin both stt and cmt are performed at froude numbers of 0 142 0 078 0 114 and 0 000 in consideration of the added resistance in waves and speed reduction due to turning starting from 0 142 which is the design froude number of the subject ship the measured force in regular waves is processed using fourier analysis in the form of the fourth order harmonic function as in eq 33 sprenger et al 2017 among the components of the total force f f 0 means wave induced steady force while f 1 f 2 f 3 and f 4 mean 1st 2nd 3rd and 4th order wave force amplitude respectively ω e is the encountering wave frequency ε 1 ε 2 ε 3 and ε 4 mean the phase of 1st 2nd 3rd and 4th order wave force respectively all components written in eq 33 can be obtained by the fourier analysis c x w c y w and c n w written in figs 25 27 are measured dimensionless wave induced steady force and moment defined by eq 34 yasukawa et al 2019 equation 34 is the same expression as eq 4 fig 23 shows an example of measured signal processing in case of regular head wave 33 f f 0 f 1 cos ω e t ε 1 f 2 cos 2 ω e t ε 2 f 3 cos 3 ω e t ε 3 f 4 cos 4 ω e t ε 4 34 c x w r 0 u x w a v e ρ g h a 2 b 2 l c y w y w a v e ρ g h a 2 b 2 l c n w n w a v e ρ g h a 2 b 2 4 3 wave induced steady force measured by stt to verify the experimental method and setting the results of added resistance in head waves are compared with the results of kim et al 2017 and shown in fig 24 it can be seen that the overall tendency of added resistance in waves agrees well with the results of kim et al 2017 figs 25 27 show the comparison results of added resistance lateral wave induced steady force and yaw wave induced steady moment experiments and numerical calculation for typical wave directions numerical calculation is performed based on the quadratic transfer function qtf matrix provided in the ansys aqwa ver 20 1 program in the zero speed case f n 0 000 the experiments and numerical calculations for c x w c y w and c n w agree relatively well in the forward speed case f n 0 078 f n 0 114 f n 0 142 the hydrodynamic coefficients are corrected in terms of the zero speed coefficients forward speed and wave encountering frequency so when the forward speed increases the peak value of added resistance in waves is shifted to low frequency the overall tendency is similar between the experiments and numerical calculation but in terms of accuracy when there is forward speed the accuracy of numerical calculation is insufficient 4 4 wave induced steady force measured by cmt when the model ship is forcibly turned 1st order wave induced force caused by the incident wave frequency and wave induced steady force variation with long period are measured together moving average filter is used to eliminate the first order wave induced force and obtain the wave induced steady force expressing function of λ and χ in the zero speed case of the cmt as the model ship turns in place the dimensionless yaw rate r l u becomes infinite figs 28 30 show the comparison results of the cmt and stt for λ l of 0 5 0 7 and 1 0 respectively looking at the overall trends of wave induced steady force with respect to the incident wave angles forward speeds and wave frequency the cmt shows a tendency to agree better with the stt in both the zero speed and non zero speed cases than the numerical calculations shown in figs 25 27 4 5 validation of the wave induced steady force all wave induced forces and moments obtained by experimental and numerical approaches should be validated by performing maneuvering simulations in waves and comparing with the results of frmts figs 31 33 show comparisons of the turning simulation results using the wave induced steady force estimated by the stt cmt and numerical calculations the accuracy of the simulation is evaluated by comparison with drifting distance and angles measured by the frmts fig 34 shows the comparison results of drifting distance and angles the stt cmt and numerical approaches accurately estimate drifting angles on the other hand accuracy is classified in the order of the stt cmt and numerical approach the fact that the drifting angle is in good agreement with the frmt s but the error in the drifting distance is large can be explained by the fact that the overall trends of wave induced steady force according to incident wave angles agree well but there is an error in the accuracy of its values although the stt shows the best results in terms of accuracy considering the shortening of the experiment time of the cmt estimation of the wave induced steady force using the cmt can be sufficiently considered in this study the numerical approach is shown to be less accurate in speed reduction due to the added resistance in waves in contrast to the sway velocity and yaw rate the speed reduction due to added resistance has been studied as the most sensitive motion variables to the drifting distance when a ship turns seo et al 2018 it is considered that a sufficiently proven numerical approach to estimate the correct added resistance should be applied 5 concluding remarks in the present study we tried to estimate the wave induced steady force through system identification model tests and numerical analysis and evaluated the estimated wave induced steady force we verified all estimation methods through the results of the frmts and comparative review when it comes to the ebm approach one of the si methods both the estimated states expressing the motion variables and external forces and moments in the 1st step and the wave induced steady force identified in the 2nd step show accurate results however accurate identification of the wave induced steady force is possible only when an accurate mathematical model for maneuvering in calm water is known while in calm water the drift angle does not exceed 20 during turning it can be seen that in waves a relatively large drift angle occurs therefore in order to accurately predict the maneuvering motion in waves development of the mathematical model considering large drift angles should first be conducted this is considered one of the reasons for the slight difference between the simulation results and the frmts shown in figs 11 16 in the future this study can be used as a basic research foundation to develop a dynamics model using the operational data obtained from a ship sailing in rough seas in real time when it comes to the stt and cmt although many cases of testing must be performed these methods are efficient ways to predict maneuvering motion and develop mathematical models in waves without performing frmts performing the stt is advantageous in terms of the accuracy of wave induced steady force but it consumes a lot of time since experiments should be performed for all wave directions on the other hand the cmt can capture wave induced steady force for all wave directions with one captive turn so not only can the experiment time be shortened but also the accuracy of the wave induced steady force is relatively good the simulation results using stt and cmt confirmed that the drift angle is relatively well matched with the frmt s but a slight error of the drifting distance occurs this is inferred because the trend of wave induced steady force agrees well but the error in drifting distance is caused by an error in the accuracy of its magnitude the estimation of wave induced steady force using the potential based numerical analysis program ansys aqwa shows a decrease in accuracy under the condition of forward speed and the largest error in simulation results in particular since the error of speed reduction due to added resistance in waves is relatively large efforts to improve the accuracy of the estimation of added resistance in waves in various wave directions are considered necessary in the future it is planned to evaluate the maneuverability in waves for irregular waves corresponding to actual sea conditions by using the wave induced force for the estimated regular wave declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national research foundation of korea nrf grant funded by the korea government msit no 2019r1f1a1057551 
20669,this paper addresses the method for estimating maneuvering mathematical models in waves and uses captive model tests to verify it to obtain the wave force and moment two kinds of captive model tests are performed one is straight towing tests with different towing directions to consider various incident wave angles while the other is circular motion tests at different regular wave frequency these captive model tests provide added resistance and wave induced steady force considering both different wave direction and ship speed and different wave drift angles the wave drift forces and moment obtained are validated by performing the maneuvering simulation in waves and comparison with the results of free running model tests this paper introduces the application of the estimation before modeling ebm approach one of the system identification methods to estimate mathematical models for ship maneuverability targeting kriso very large crude oil carrier kvlcc2 the most important force component for the prediction of the maneuverability of a ship is the accuracy of the wave induced steady force acting on the ship here the ebm approach is divided into two steps first the motion variables and forces are estimated by extended kalman filter and modified bryson frazier smoother second the wave induced steady forces are determined by removing the hydrodynamic force acting on the ship during motion also during the second step of the ebm approach the database consisting of wave length and incident wave angles is constructed all estimated variables are based on data obtained by free running model tests in regular waves finally the estimated wave induced steady force is interpolated added to the hydrodynamic force component of the 3 dof equations of motion and the turning simulation of the ship in waves is then performed comparison of the results with the results of free running model tests confirms the validity of the established model keywords maneuvering in waves wave induced steady force system identification model tests numerical analysis nomenclature g gravitational acceleration m s 2 ρ water density k g m 3 u v surge and sway acceleration m s 2 r yaw angular acceleration s 2 u v surge and sway velocity m s r yaw rate s u ship speed m s l length between perpendicular of a subject ship m b beam of a subjected ship m t draft of a subjected ship m v volume of a subjected ship m 3 c b block coefficient of a subjected ship k ii radius of gyration with respect to ii axis m gm t transverse metacentric height m χ 0 absolute wave angle χ incident wave direction during maneuvering λ wave length m h a wave amplitude m fn froude number u g l ω e encountering wave frequency rad s abbreviations si system identification kvlcc2 kriso very large crude oil carrier 2 ebm estimation before modeling frmt free running model test ekf extended kalman filter mbfs modified bryson frazier smoother dof degrees of freedom mmg maneuvering modeling group rps revolutions per second cwnu changwon national university stt straight towing test cmt circular motion test 1 introduction research on ship efficiency has been actively conducted by introducing the energy efficiency design index eedi to regulate a ship s greenhouse gas emissions since the introduction of eedi there has been concern about the possibility of satisfying eedi by lowering the maximum continuous rating mcr of the main engine if the mcr is too low it may be difficult to maintain the ship speed required to maneuver the ship in adverse conditions which can be a great risk for safe navigation to prevent this risk in 2013 the maritime environment protection committee mepc proposed guidelines for minimum propulsion power to maintain the maneuvering of ships in adverse conditions imo mepc 2013 the guidelines state that it should be possible to maintain the heading of a ship at a minimum speed of 4 knots for wind and wave conditions therefore there is a need for analytic methods that can predict ship maneuverability in waves yasukawa 2006 has developed maneuvering equations of motion in waves for the sr108 containership the 4 degrees of freedom equations of motion including wave induced steady forces are considered and 6 degrees of freedom wave exciting forces high frequency problems are considered wave induced steady forces for various incident wave directions were measured for the ship moving straight ahead and used for the verification of numerical analysis yasukawa 2006 proposed a practical simulation method considering wave drift forces only for the sr108 containership and carried out captive model tests to measure the wave drift forces yasukawa 2018 carried out captive model tests to measure wave induced steady forces for four different speeds of the s cb84 model for various regular wave incidence angles in the european union eu s joint study the energy efficient safe ship operation shopera project four research institutes performed various experiments to estimate the added resistance and wave drift forces on the duisburg test case dtc containership and the kriso very large crude oil carrier 2 kvlcc2 tanker model and released the results of free running model tests of the dtc model ships sprenger et al 2017 that paper suggests a method of captive model tests in waves the role of si in ship dynamics has been studied to identify the hydrodynamic coefficients in the hydrodynamic force model abkowitz 1980 and hwang 1980 applied the si method for the first time to estimate the hydrodynamic coefficients of a ship the si method was used for the estimation of coefficients using ekf in this case the hydrodynamic coefficients were augmented in the state variables and were simultaneously estimated together with other state variables however the magnitude of covariance matrix was large and the assumption of the initial values affected the convergence the ebm approach one of the si methods has been mainly used to estimate aircraft parameters hoff and cook 1996 sri jayantha and stengel 1985 yoon and rhee 2003 first applied the ebm approach to resolve the problems detected in the previous study yoon et al 2007 applied the ebm to develop a roll hydrodynamic moment model the main purposes of the abkowitz 1980 hwang 1980 yoon and rhee 2003 and yoon et al 2007 studies are similar in terms of estimating hydrodynamic coefficients however the ebm is divided into two steps first it estimates state variables including motion variables and hydrodynamic force and moments second it estimates the hydrodynamic coefficients using correlation and regression analysis the purpose of this present study is to estimate the wave force and to construct a database instead of estimating the coefficients the ebm approach which uses ekf and mbfs as dynamic state estimators without considering the coefficients as state variables is employed as the si method as the mathematical models that include wave force for the prediction of ship maneuvering in waves yasukawa 2006a developed a practical simulation method that takes only wave drift forces into account in the usual maneuvering simulation model and mentioned its feasibility of predicting maneuverability in waves yasukawa 2006b introduced a practical method for the simulations of both ship maneuvering and wave induced motions and separated the equations of motions into the high frequency wave induced motion problem and the low frequency maneuvering problem in 2013 mepc raised the minimum power guidelines to maintain the stability and the maneuverability of a ship in adverse condition imo mepc 2013 seo et al 2018 for this reason there has recently been growing interest in predicting ship maneuverability in waves seo and kim 2011 and seo et al 2018 calculated wave drift force based on potential theory and validated it by performing maneuvering simulations and by comparison with experimental results this study represents fundamental research into the estimation of wave force including wave drift force using the si method and the development of a mathematical model kim et al 2019 carried out frmts of kvlcc2 in regular waves of various wave lengths all measured values used in this study were derived from the frmts the remainder of this paper is structured as follows chapter 2 introduces mathematical models regarding ship maneuvering in waves while chapter 3 discusses the concepts of ebm and the 1st and 2nd steps of ebm chapter 4 finally performs the maneuvering simulation of a ship in waves using the estimated wave force and compares the results with the trajectory drift index of frmts kim et al 2019 this study also proposes a test technique to estimate the wave induced steady force the stt is a typical test to measure the wave induced steady force by towing a model ship in various directions in a wave basin the cmt is a challenging test that measures wave induced steady force with a minimum number of captive model tests by comparing the results of stt and cmt we want to show the effectiveness of measuring wave induced steady force using the cmt additionally calculation of the wave induced steady force is performed using the potential based numerical analysis program ansys aqwa to check the tendency of the force in regular waves 2 mathematical model considering wave induced steady force 2 1 coordinate system there are two kinds of coordinate systems that describe a ship s horizontal motion the first is the earth fixed coordinate system o x y to express a ship s trajectory the other system is a ship fixed coordinate system o x b y b to define the equations of motion and express the external force acting on a ship both use a right handed orthogonal coordinate system as shown in fig 1 although in the earth fixed coordinate system the absolute wave direction is constant in the ship centered coordinate system when the ship turns the wave incident angle is always altered 2 2 equations of motion equation 1 expresses the 3 dof equations of motion based on newton s 2nd law the right side of the equations describes the external force on a ship maneuvered by steering in waves 1 m u v r x g r 2 x m a n x w a v e m v u r x g r y m a n y w a v e i z z r m x g v u r n m a n n w a v e the subscripts man and wave represent the force due to maneuvering motion and wave respectively this external force can be divided into specific components as shown in eq 2 the following models are based on the mmg model including hydrodynamic hull force thrust and rudder force yasukawa and yoshimura 2015 2 x m a n x u u x v v v 2 x v v v v v 4 x v r v r x r r r 0 1 t p ρ n 2 d 4 k t 1 t r f n sin δ r y m a n y v v y r r y v v y r r y v v v v 3 y v v r v 2 r y v r r v r 2 y r r r r 3 1 a h f n cos δ r n m a n n v v n r r n v v n r r n v v v v 3 n v v r v 2 r n v r r v r 2 n r r r r 3 x r a h x h f n cos δ r it is assumed that the total external force and moment acting on a maneuvering ship in waves can be divided into two components as in eq 1 therefore it is necessary to accurately predict the force and moment in calm water we assumed that the mathematical model parameters regarding external forces in still water are accurate and known values all parameters including hydrodynamic coefficients and interaction coefficients between hull propeller and rudder that are presented in yasukawa and yoshimura 2015 were used in this study the non dimensional expressions of force and moment are defined as eqs 3 and 4 respectively yasukawa and yoshimura 2015 yasukawa 2006a 3 f m a n f m a n 0 5 ρ l d u 2 m m a n m m a n 0 5 ρ l 2 d u 2 4 f w a v e f w a v e ρ g h a 2 b 2 l m w a v e m w a v e ρ g h a 2 b 2 3 estimation of wave induced steady force using the ebm approach 3 1 the concepts of the emb approach the estimation of hydrodynamic coefficients of a ship in still water was adequately explained by yoon and rhee 2003 and yoon et al 2007 fig 2 shows that the ebm approach is divided into two steps the first step is to construct state equations and estimate state variables including motion variables and external force ekf and mbfs are used as the dynamic state estimators the first step in this study is similar to that of the previous study the second step is to determine the wave force based on the external force estimated in the first step by removing the force and moment in calm water expressed in eq 2 3 2 first step of the ebm approach in order to estimate the motion variables and external force and moment the state space model incorporates state and measurement equations the components of the state vector represent the final estimated variables in this step and are defined as in eq 5 5 x x 1 x 2 x 3 t where 6 x 1 u v r t 7 x 2 x y ψ t 8 x 3 x m a n x w a v e x m a n x w a v e x m a n x w a v e y m a n y w a v e y m a n y w a v e y m a n y w a v e n m a n n w a v e n m a n n w a v e n m a n n w a v e the vectors x 1 and x 2 represent motion variables including velocity and displacement respectively while x 3 is the external force and moment since the external force and moment are assumed as third order gauss markov processes the state variable vector includes those first and second order time derivatives yoon and rhee 2003 yoon et al 2007 in order to estimate the state variable vector the state equation which is the dynamic model of the state variable vector is necessary as follows 9 x m f t 1 x w t 10 m t m 0 3 12 0 12 3 i 12 12 11 m m x u 0 0 0 m y v m x g y r 0 m x g n v i z z n r 12 f x m v r x g r 2 x m a n x w a v e m u r y m a n y w a v e m x g u r n m a n n w a v e u cos ψ v sin ψ u sin ψ v cos ψ r x m a n x w a v e x m a n x w a v e 0 y m a n y w a v e y m a n y w a v e 0 n m a n n w a v e n m a n n w a v e 0 matrix 0 3 12 and i 12 12 written in eq 10 represent the zero matrix and identity matrix respectively the vector f x includes coriolis and centrifugal force terms which are known values before solving eq 9 also since it is assumed that the added mass coefficients are known in advance those values are included in the inertia matrix m because the acceleration is not a state variable vector element it is convenient to subtract the force associated with acceleration when estimating force another equation consisting of state space model is the measurement equation kim et al 2019 performed the frmts of kvlcc2 and described its details in this study all measurement data were obtained from frmts the types of measured data include trajectory yaw angle speed yaw rate propeller rps and rudder angle propeller rps and rudder angle are only necessary at the second step of the ebm approach therefore the measurement equation is defined as in eq 13 13 z h x t x y ψ u r t the motion variables and external force and moment are estimated by state estimator there are three kinds of estimators predictor filter and smoother in this study ekf and mbfs were used as the estimators both ekf and mbfs can be used to estimate state variables however mbfs estimates state variables using all the data including past present and future therefore mbfs is more accurate and it is used as the final state estimator yoon and rhee 2003 although mbfs is the final state estimator it needs filtered state variables kalman gain matrix and error covariance matrix calculated by ekf therefore both ekf and mbfs are considered state estimators in the first step of ebm approach fig 3 shows the procedures of ekf and mbfs yoon and rhee 2003 introduced the procedure for estimating the state variables through ekf and mbfs in detail and this paper provides a brief introduction first of all ekf is divided into two steps state prediction and measurement update the state prediction step predicts the present value using the previous estimated value the predicted state variables and error covariance matrix are defined as eqs 14 and 15 14 x k k 1 x k 1 k 1 t k 1 t k x t d t 15 p k k 1 p k 1 k 1 t k 1 t k p t d t where x t can be obtained by solving eq 9 the matrix riccati differential equation to obtain p t includes the jacobian matrix of state equation f x t and is defined as eq 16 16 p t f x t p t p t f t x t q t where 17 f x t f x t x x t x t the measurement update step requires the predicted state variables error covariance matrix measured data jacobian matrix of eq 13 and kalman gain matrix to obtain the estimated state variables equations 18 and 19 are the estimated state variables and error covariance matrix and these values are reused in eqs 14 and 15 to obtain the predicted value at the next step 18 x k k x k k 1 k k δ z k k 1 19 p k k i k k h k p k k 1 i k k h k t k k r k k t k where 20 δ z k k 1 z k z ˆ k k 1 21 z ˆ k k 1 h x ˆ k k 1 t k 22 k k p k k 1 h t k h k p k k 1 h t k r k 1 23 h k h x t k t k x t k the residual δ z k k 1 the so called innovation process is the difference between the measured and predicted values when estimating the state variables x k k kalman gain k k compensates for this difference r k is the measurement noise matrix which is determined by the noise characteristics of measurement sensors h k is the jacobian matrix of measurement equation eq 13 the state variable error covariance matrix is obtained through ekf however all variables obtained from ekf are stored only for mbfs as a more accurate estimator the variables to be stored in order to estimate the final state variables and error covariance through mbfs are x k k k k p k k 1 p k k δ z k k 1 f x t and h k mbfs estimates the values at t t k 1 with the state variables estimated by ekf at the final measurement time t t k as the initial values the initial conditions for the adjoint variable vector and matrix are expressed by 24 λ n 1 n h t n d 1 n δ z n 1 n 25 λ n 1 n h t n d 1 n h n where 26 d n h n p n 1 n h t n r n the time propagation equations of adjoint vector variables and matrix can be expressed as follows using the jacobian matrix of state equations 27 λ t f t x ˆ t λ t 28 λ t f t x ˆ t λ t λ t t f x ˆ t the above differential equations should be solved in the backwards direction of time the solutions obtained by solving eqs 27 and 28 are λ k k and λ k k which are used as variables to solve eqs 29 and 30 which are used for iterative calculations 29 λ k 1 k λ k h t n d 1 n δ z k 1 k d k k t k λ k k 30 λ k 1 k i k k h k t λ k k i k k h k h t k d 1 k h k the final estimated state variables and error covariance matrix using all measurement data can be obtained using eqs 31 and 32 31 x k n x k k p k k λ k k 1 32 p k n p k k p k k λ k k p k k all motion variables force and moment are expressed in full scale dimensions the state variables are estimated based on the first step of the ebm approach first figs 4 and 5 show the estimated motion variables and external forces respectively using the data measured by frmts in still water condition since the speed and yaw rate were measured by frmt they were compared with the estimated values fig 6 shows that the estimated values adequately coincide with the measured values except for the sway velocity force and moment exclusively exist as estimated values fig 5 represents the time series of the forces estimated and calculated using eq 2 to accurately identify the wave force the differences between the results of simulation and estimation should be small therefore in this study the parameters constituting eq 2 were slightly adjusted using the results of frmts fig 5 highlights that the difference between the calculated values using eq 2 and the estimated force is not large figs 6 and 7 show the estimated state variables in waves when the wave length to ship length ratio is equal to 1 0 as in the case of calm water the estimated and measured motion variables coincide well while the total external and wave forces are also consistent the conditions of regular waves were applied to the frmts in this paper we introduce the estimated state variables in calm water and in wave length to ship length ratio 1 0 and absolute wave direction 180 case only as an example the estimated motion variables are used for validation of the wave force model while the estimated force and moment are used for validation and estimation of the wave induced steady force there are two kinds of wave induced motion the measured motion variables include 1st order wave induced motion caused by high frequency oscillatory motions depending on wave encountering frequency and wave induced steady motion caused by wave induced steady force fig 8 shows an example of the measured and estimated wave induced motion when the wave length ratio is 1 0 fig 8 shows that when the estimated motion is subtracted from the measured data the time average is approximately zero this means that the smoothed motion variable and force estimated by mbfs are wave induced steady motion and force respectively 3 3 second step of the ebm approach the second step of the ebm approach involves the estimation of wave force and database construction for wave force fig 9 shows the time series for each force component the total external force f m a n f w a v e is included in the components of state variable vectors written in eq 5 this can be obtained by mbfs in the first step of the ebm approach the force due to maneuvering f m a n is obtained using eq 2 when using eq 2 to calculate f m a n the estimated motion variables written in eq 5 should be substituted into eq 2 at every time step finally the wave force is obtained by subtracting the force due to maneuvering from the total external force when the wave force is obtained using the above calculation procedure it is represented as a function of the encountered wave direction and wave length database construction for the wave force entails tabulation of the results of the force and moment with respect to the encountered wave direction and wave length the details are provided in the next chapter fig 10 shows the dimensionless wave force and moment with respect to incident wave angle during the turning of the ship and the wave length to ship length ratio these forces and moments are obtained by the procedure described in the second step of the ebm approach which triggers drifting trajectory these results are validated by performing simulation and comparison with frmts the distributions of dimensionless wave force and moment shown in fig 8 constitute the database as the components of external force in the mathematical models in eq 1 when performing maneuvering simulation in waves the force and moment are interpolated at every time interval 3 4 validation of the wave induced steady force all types of simulation results shown in fig 11 through 16 are compared with the results of frmts and the estimated ones by mbfs as previously noted accuracy of the maneuvering mathematical model in calm water is required because it significantly affects the estimation process fig 11 shows the simulation results in calm water without considering wave force these are in good agreement with the frmts results except for the initial turning trajectory however it seems that the error in the initial turning in calm water has overall effects on the error in initial turning trajectory in the waves shown in figs 12 16 therefore it is necessary to further improve the accuracy of the mathematical model in terms of the initial trajectory written in eq 2 in the case of trajectory the speed and yaw rate are considered as actual values to be compared otherwise the estimated values are considered the conditions of regular waves include various wave length ratios of 0 5 0 7 1 0 1 2 and 1 5 the wave height and initial wave incident angles are 0 02 l and 180 respectively most of the results exhibit similar trends between the frmts and simulation however the trajectory shifts due to the initial errors involving motion variables and forces in the cases of λ l 0 5 0 7 and 1 5 these are the reasons for the differences between the force estimated by mbfs and that calculated by eq 2 in transient time the transient time refers to the time during steering rudder the force obtained during these intervals represents the wave forces near 180 incident wave angle in figs 12 13 and 16 improvement in the force during transient time enhances the accuracy of the motion variables in particular the error of surge velocity is relatively large because when the ship turns straight motion without lateral and yawing motion is rare therefore it is recommended to perform straightforward tests in various wave length conditions due to the acquisition of accurate axial wave force x w a v e kim et al 2019 summarized the drifting distance and angle at different turning maneuvers in waves it is appropriate that the trajectory drift and angles are defined as the magnitude and direction of a vector between two positions with the headings 360 and 720 expressed as d d r 360 720 and a d r 360 720 respectively fig 17 shows the main indices d d r 360 720 and a d r 360 720 between the frmts and the present simulation in the case of the drifting angle a d r 360 720 the error is within 10 which is similar to that of the frmts 4 estimation of wave induced steady force through model tests and numerical analysis 4 1 test facility and set up captive model tests were performed in the 3 dimensional wave basin at cwnu fig 18 shows the exterior of the wave basin while table 1 describes the main specification as the xy carriage installed in the wave basin moves the yaw table can be rotated at the same time so it is able to implement diagonal towing motions and captive circular motions the kvlcc2 model scaled with 1 223 scale ratio is used as the subject ship for captive model tests the model ship was made of fiber reinforced plastic frp material to maximize the space inside the hull to allow proper matching of the longitudinal and transverse mass distribution with the real ship s condition a sandpaper type turbulence stimulator is attached to the bulbous bow and a rudder is attached to the stern without a propeller yasukawa et al 2018 table 2 lists the principal particulars of the model ship fig 19 describes the configuration of the installed model ship and measurement devices the wave induced steady forces and moment are measured by installing 2 component load cells in front of and behind the origin surge sway and yaw are fixed while heave pitch and roll are free heave pitch and roll motion are measured by potentiometers a resistance type wave probe is used to measure the incident wave height the radius of gyration and transverse metacentric height can be similar by an inertia test and incline test respectively the measured value of transverse metacentric height g m t and radius of gyration k y y l p p measured by performing the incline test and inertia test shown in fig 20 are 2 58 cm and 0 248 respectively the target and measured radius of gyration are roll natural period can be similar by performing a free roll decay test as shown in fig 21 the target roll natural period for the model ship is 1 30 s while the measured roll natural period is 1 24 s and the error is within 5 4 2 test condition and measured data processing captive model tests are divided into the stt and cmt the wave maker in the cwnu wave basin generates waves in one direction so it is a test to measure wave force according to regular wave incidence angle while changing towing direction in the forward diagonal and transverse directions table 3 lists the test conditions of the stt and cmt the stt should be performed with various incident wave directions for one regular wave condition on the other hand in the case of the cmt since the incident wave direction continuously changes during captive turning of the ship there is the advantage that it is not necessary to tow under each wave direction fig 22 shows an example in which the incident wave direction continuously changes while the model ship turns in the wave basin both stt and cmt are performed at froude numbers of 0 142 0 078 0 114 and 0 000 in consideration of the added resistance in waves and speed reduction due to turning starting from 0 142 which is the design froude number of the subject ship the measured force in regular waves is processed using fourier analysis in the form of the fourth order harmonic function as in eq 33 sprenger et al 2017 among the components of the total force f f 0 means wave induced steady force while f 1 f 2 f 3 and f 4 mean 1st 2nd 3rd and 4th order wave force amplitude respectively ω e is the encountering wave frequency ε 1 ε 2 ε 3 and ε 4 mean the phase of 1st 2nd 3rd and 4th order wave force respectively all components written in eq 33 can be obtained by the fourier analysis c x w c y w and c n w written in figs 25 27 are measured dimensionless wave induced steady force and moment defined by eq 34 yasukawa et al 2019 equation 34 is the same expression as eq 4 fig 23 shows an example of measured signal processing in case of regular head wave 33 f f 0 f 1 cos ω e t ε 1 f 2 cos 2 ω e t ε 2 f 3 cos 3 ω e t ε 3 f 4 cos 4 ω e t ε 4 34 c x w r 0 u x w a v e ρ g h a 2 b 2 l c y w y w a v e ρ g h a 2 b 2 l c n w n w a v e ρ g h a 2 b 2 4 3 wave induced steady force measured by stt to verify the experimental method and setting the results of added resistance in head waves are compared with the results of kim et al 2017 and shown in fig 24 it can be seen that the overall tendency of added resistance in waves agrees well with the results of kim et al 2017 figs 25 27 show the comparison results of added resistance lateral wave induced steady force and yaw wave induced steady moment experiments and numerical calculation for typical wave directions numerical calculation is performed based on the quadratic transfer function qtf matrix provided in the ansys aqwa ver 20 1 program in the zero speed case f n 0 000 the experiments and numerical calculations for c x w c y w and c n w agree relatively well in the forward speed case f n 0 078 f n 0 114 f n 0 142 the hydrodynamic coefficients are corrected in terms of the zero speed coefficients forward speed and wave encountering frequency so when the forward speed increases the peak value of added resistance in waves is shifted to low frequency the overall tendency is similar between the experiments and numerical calculation but in terms of accuracy when there is forward speed the accuracy of numerical calculation is insufficient 4 4 wave induced steady force measured by cmt when the model ship is forcibly turned 1st order wave induced force caused by the incident wave frequency and wave induced steady force variation with long period are measured together moving average filter is used to eliminate the first order wave induced force and obtain the wave induced steady force expressing function of λ and χ in the zero speed case of the cmt as the model ship turns in place the dimensionless yaw rate r l u becomes infinite figs 28 30 show the comparison results of the cmt and stt for λ l of 0 5 0 7 and 1 0 respectively looking at the overall trends of wave induced steady force with respect to the incident wave angles forward speeds and wave frequency the cmt shows a tendency to agree better with the stt in both the zero speed and non zero speed cases than the numerical calculations shown in figs 25 27 4 5 validation of the wave induced steady force all wave induced forces and moments obtained by experimental and numerical approaches should be validated by performing maneuvering simulations in waves and comparing with the results of frmts figs 31 33 show comparisons of the turning simulation results using the wave induced steady force estimated by the stt cmt and numerical calculations the accuracy of the simulation is evaluated by comparison with drifting distance and angles measured by the frmts fig 34 shows the comparison results of drifting distance and angles the stt cmt and numerical approaches accurately estimate drifting angles on the other hand accuracy is classified in the order of the stt cmt and numerical approach the fact that the drifting angle is in good agreement with the frmt s but the error in the drifting distance is large can be explained by the fact that the overall trends of wave induced steady force according to incident wave angles agree well but there is an error in the accuracy of its values although the stt shows the best results in terms of accuracy considering the shortening of the experiment time of the cmt estimation of the wave induced steady force using the cmt can be sufficiently considered in this study the numerical approach is shown to be less accurate in speed reduction due to the added resistance in waves in contrast to the sway velocity and yaw rate the speed reduction due to added resistance has been studied as the most sensitive motion variables to the drifting distance when a ship turns seo et al 2018 it is considered that a sufficiently proven numerical approach to estimate the correct added resistance should be applied 5 concluding remarks in the present study we tried to estimate the wave induced steady force through system identification model tests and numerical analysis and evaluated the estimated wave induced steady force we verified all estimation methods through the results of the frmts and comparative review when it comes to the ebm approach one of the si methods both the estimated states expressing the motion variables and external forces and moments in the 1st step and the wave induced steady force identified in the 2nd step show accurate results however accurate identification of the wave induced steady force is possible only when an accurate mathematical model for maneuvering in calm water is known while in calm water the drift angle does not exceed 20 during turning it can be seen that in waves a relatively large drift angle occurs therefore in order to accurately predict the maneuvering motion in waves development of the mathematical model considering large drift angles should first be conducted this is considered one of the reasons for the slight difference between the simulation results and the frmts shown in figs 11 16 in the future this study can be used as a basic research foundation to develop a dynamics model using the operational data obtained from a ship sailing in rough seas in real time when it comes to the stt and cmt although many cases of testing must be performed these methods are efficient ways to predict maneuvering motion and develop mathematical models in waves without performing frmts performing the stt is advantageous in terms of the accuracy of wave induced steady force but it consumes a lot of time since experiments should be performed for all wave directions on the other hand the cmt can capture wave induced steady force for all wave directions with one captive turn so not only can the experiment time be shortened but also the accuracy of the wave induced steady force is relatively good the simulation results using stt and cmt confirmed that the drift angle is relatively well matched with the frmt s but a slight error of the drifting distance occurs this is inferred because the trend of wave induced steady force agrees well but the error in drifting distance is caused by an error in the accuracy of its magnitude the estimation of wave induced steady force using the potential based numerical analysis program ansys aqwa shows a decrease in accuracy under the condition of forward speed and the largest error in simulation results in particular since the error of speed reduction due to added resistance in waves is relatively large efforts to improve the accuracy of the estimation of added resistance in waves in various wave directions are considered necessary in the future it is planned to evaluate the maneuverability in waves for irregular waves corresponding to actual sea conditions by using the wave induced force for the estimated regular wave declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national research foundation of korea nrf grant funded by the korea government msit no 2019r1f1a1057551 
