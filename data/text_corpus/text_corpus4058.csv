index,text
20290,an automatic route design algorithm for intelligent ships based on a novel environment modeling method wei pan software conceptualization methodology data curation writing original draft writing review editing visualization a xin lian xie conceptualization methodology writing original draft writing review editing supervision project administration funding acquisition a ping he formal analysis investigation validation b tian tian bao formal analysis investigation validation c meng li formal analysis methodology resources a a integrated transport institute dalian maritime university dalian 116026 china integrated transport institute dalian maritime university dalian 116026 china integrated transport institute dalian maritime university dalian 116026 china b school of naval architecture ocean and civil engineering shanghai jiao tong university shanghai 200240 china school of naval architecture ocean and civil engineering shanghai jiao tong university shanghai 200240 china school of naval architecture ocean and civil engineering shanghai jiao tong university shanghai 200240 china c faculty of maritime and transportation ningbo university ningbo 315211 china faculty of maritime and transportation ningbo university ningbo 315211 china faculty of maritime and transportation ningbo university ningbo 315211 china corresponding author an automatic route design algorithm for intelligent ships considering environmental factors impact and navigation safety is proposed the delaunay triangulation method is used to model chart data safe water depth of ship navigation calculation model is proposed whose result is used to search the forbidden navigation areas in delaunay chart model the navigation network is created by the tangent based method based on the delaunay chart model the speed of ship under environmental factors impact is recalculated which is used to modify path weight of the navigable network the route design scheme is obtained by solving the modified network with the dijkstra algorithm the experimental results show that the algorithm can provide the adaptive route scheme via ship size and tide height moreover the environmental factors are used as variables to prove that the algorithm can consider the environmental factors and provide an economical navigation scheme keywords intelligent ships hydrodynamics delaunay triangulation method tangent based method dijkstra algorithm 1 introduction with the continuous development of economic globalization the maritime transport has achieved unprecedented development the number of ships in china s coastal waters is unprecedented under the background of vigorous development of shipbuilding industry ships are developing towards large scale high speed and intelligent the intelligent ship research is the future development direction of shipbuilding industry and has broad application prospects the development of intelligent ship related theories can vigorously promote the rapid development of intelligent ship industry and even strengthen the construction of maritime intelligent transportation the navigation safety of intelligent ships is an important prerequisite to ensure the green and rapid development of intelligent ships the complexity of navigation environment on water increases the risk of navigation of intelligent ships an economical and safe route for intelligent ships is needed therefore this paper proposed an automatic route design algorithm for intelligent ships based on electronic chart in early research of ship route design the shortest distance scheme is usually regarded as the goal with the deepening of the research meteorological factors are gradually considered which is mainly aimed at the design of global routes in addition ship route design generally adopts experience method however when navigation situation changed such as construction new sinking ships etc the route designed originally is no longer applicable at this time rerouting will cause heavy workload to the ship pilot especially when the ship pilot is not familiar with the situation of the water which may cause the ship sailing into a dangerous situation therefore ship route planned by computer can not only reduce pilot s burden but also make the route scientifically and effectively an automatic route design algorithm for intelligent ships which can consider as many factors as possible is urgently needed the process of ship route design algorithm can be divided into two stages macroscopically environment modeling and path planning to make the route planned by algorithm as scientific and reasonable as possible the accuracy of environment modeling is particularly important among the current ship communication and navigation equipment the application of electronic chart is quite popular compared with paper chart electronic chart shows great advantages in many aspects the electronic chart display and information system ecdis derived from electronic chart is regarded as another great technological revolution in the field of ship navigation after the automatic radar plotting aid arpa therefore create environment model via electronic chart is an effective and scientific method in the electronic chart file water depth obstacles and other elements are saved then water depth model can be established which is used to search for areas that satisfy water depth requirements dynamically when ship is sailing except for the special circumstances such as traffic separation schemes network of ship s navigation is not fixed therefore it is necessary to create navigation network with the range of obstacles or the boundary of forbidden navigation areas in this paper the tangent based method is used to construct navigation network a reasonable navigable network can be constructed with the data of areas which water depth is unsatisfied in route designing stage the network generated in environment modeling stage is need to be solved in the previous stage safety of ship navigation has been considered in environment modeling stage the classical path algorithm can provide a shortest path for ships however the shortest route is not necessarily the most economical lots of factors affect the economy of ship navigation only providing the shortest route for ship is not able to satisfy the needs of ship navigation therefore the speed calculation method is applied to the weight correction of ship navigation network then the route scheme of economical can be available the remainder of this paper is organized as follows in section 2 a brief literature review of environment modeling and relevant research results of ship route design algorithm are given in section 3 navigation environment modeling and navigation network creating model based on chart data are proposed in section 4 ship mechanics analysis considering the influence of environmental factors is given and then the calculation method of ship speed is given in section 5 the solution method of calculation model proposed in this paper is introduced the speed problem which is difficult to be solved directly is described in detail finally the method of modifying the weight of navigation network is given in section 6 three groups of simulation experiments are carried out the algorithm proposed in this paper is fully verified the conclusions and discussed in section 7 2 related work according to the references on route design algorithm of ships and other surface equipment the basic steps of route design algorithm can be divided into two main modes which expressed as fig 1 the ship route design algorithm of mode i is implemented in two stages the navigation network is created by environment modeling and the navigable route can be obtained the ship route design algorithm of mode ii is implemented in three stages firstly the navigation network is created by environment modeling then the initial solution of route is obtained with initial path planning algorithm the optimization algorithm is used to optimize the initial path to get the final solution 2 1 theory of environmental modeling when a ship is sailing on the water its route can be freely chosen on the premise of safety the uncertainty of navigation area leads to the necessity of environment modeling before ship route designing the classical environment modeling algorithms are divided into two main branches the signpost methods and the grid methods the signpost method is an intuitive environmental modeling method its principle is to build a network suitable for ship navigation via basic environment data directly after years of development there have been several mature algorithms for signpost method visibility graph method voronoi diagram method maklink graph method and tangent based method etc the visibility graph method was proposed by lozano perez 1983 several methods have been proposed to optimize the visibility graph method which make it more practical in application lozano perez 1983 c h chung and g n saridis 1989 the basic principle of visibility graph method is to connect the starting point terminal point and obstacles with straight lines all connecting lines shall not cross obstacles the voronoi diagram method was proposed by georgy voronoi the voronoi diagram is composed of a group of continuous polygons which are composed of vertical bisectors connecting two adjacent straight lines as a classical algorithm of environment modeling it is widely used in different fields wang used the voronoi diagram method to model the scene when designing the integrated design scheme of virtual museum roaming system wang et al 2006 mauro proposed a rapid and dynamic path planning system candeloro et al 2017 liu used the voronoi diagram method to model the crushed stone in the navigation simulation of ship navigation in ice rubble liu et al 2018 mauro proposed a two dimensional curvature continuous path planning algorithm based on the voronoi diagram method and fermat s spiral segments candeloro et al 2013 the maklink graph method was proposed by habib 1991 the basic principle of maklink graph method is using the midpoints of common free links between free convex areas as passing points these points correspond to nodes in a graph and the connection between them within each convex area as arcs in this graph qin used the maklink graph method to describe the working space of mobile robot qin et al 2005 zhao used the maklink graph method to construct free space when he presented a novel approach to search and optimize path points for anti ship missile path planning zhao and fan 2009 shen proposed a polyclonal particle swarm optimization algorithm and built an experimental environment of mobile robot using the maklink graph method to test the proposed algorithm shen and yuan 2010 in the process of the designing of iot based intelligent logistics dispatching system wang used the maklink graph method to model the operation environment of picking robot wang et al 2020 the tangent based method is proposed by doyle the basic principle of tangent based method is based on polygonal obstacle model obstacles with different shape are replaced by approximate polygon the tangent graph is constructed in free space and common tangent between obstacles is constructed to form final network zhang proposed the shortest tangent risk aversion algorithm in the anti ship missile route design algorithm which is realized by the tangent based method zhang et al 2008 mao proposed a path planning algorithm whose navigation environment is created by the tangent based method mao et al 2009 after comparing various signpost methods different methods have different pertinence when modeling environment the visibility graph method is to connect points in the whole obstacle area which makes the creation of network more sufficient when the voronoi diagram method and maklink graph method are used to model the environment the calculated path is far away from obstacles which maybe ensure the safety however in some cases a long distance path will be given which cannot fully reflect the advantages of path planning the principle of the tangent based method is to make the path close to obstacles as much as possible which is the opposite of the voronoi diagram method and maklink graph method in some modeling scenarios this method will reduce the safety of path but if other aspects of safety are considered and constrained the path given by tangent graph method can be shorter than that given by other methods 2 2 theory of path planning algorithm the path planning algorithm and path optimization algorithm adopt similar algorithm the algorithm can be divided into following branches from the perspective of research methods analytic method heuristic algorithm intelligent algorithm and heuristic and intelligent combination algorithm the analytic method is to solve the network after environment modeling by data structure and graph theory directly however there are few studies on obtaining the final results through analytical method directly for the complex situation of ships sailing on the water the results of analytic method are mostly used as initial solution liu obtained the initial solution of path planning with dijkstra algorithm and completed the path optimization with particle swarm optimization algorithm yujie et al 2018 the heuristic algorithm is a main method to solve path planning problem which has ability to solve complex network effectively the a algorithm is a typical heuristic algorithm which is widely used in ship route planning on the basis of environment modeling part scholars obtained final solution of ship route designing by a algorithm li et al 2017 and wang et al 2017 in addition part scholars use particle swarm optimization to solve the model established in route planning section liu et al 2018 and shenet al 2019 the artificial potential field method is another effective algorithm in dealing with robot obstacle avoidance and ship collision avoidance path planning its original is to abstract ship to navigate in a force field the target point has a gravitational effect on ship and obstacles have repulsive effects on ship then guide ship to navigate in a safe route through resultant force xie et al 2019 and lazarowska 2018 the intelligent algorithm is a new algorithm rising in the development of artificial intelligence and big data theory it has the ability of mining and analyzing historical data which can guide the operation through knowledge provided by historical data data mining analysis and learning based on trajectory history data can provide a safe route for ships in the process of route designing lazarowska et al 2016 gkerekos et al 2020 wen et al 2020 the heuristic and intelligent combination algorithm is combine the advantages of heuristic algorithm and intelligent algorithm which make full use of the advantages of two algorithms when applied to ship route designing chen et al 2019 and zha et al 2019 scholars have made a lot of achievements in ship route designing and other equipment path planning algorithms while in the environment modeling section scholars mainly based on the abstract mathematical model and few directly modeling via the chart or field map which leads to the algorithm in practical application will face some problems in the aspect of path planning algorithm the algorithms proposed by scholars are quite effective which can solve the problems under different conditions 3 creation of navigable water network 3 1 the safe water depth of ship navigation to ensure the navigation safety of ship the area with water depth exceeding draft of ship and certain safety margin shall be selected for navigation the water depth have to satisfy as 1 h s h c h t h a d m where h s is the safe water depth of ship navigation h a is the minimum safety margin water depth d m is the draft of ship h c is the water depth of chart which indicating the theoretical lowest tide surface water depth at this point h t is the height of tide the navigable area of ship shall satisfy the safe water depth of ship the value of navigable water depth is greater or equal to the sum of the ship draft and the minimum safe surplus water depth after different factors of ship safety are considered 10 of the ship draft is taken as the minimum safety margin water depth eq 1 can be converted into eq 2 2 h s h c h t d m 110 3 2 the delaunay model of chart data determine navigable area with numerical value of water depth is the most direct and effective method the electronic chart stores and displays real world entities in the form of data as shown in fig 2 a it contains water depth data which is stored as coordinate water depth value in electronic chart file the value of water depth can be displayed in the form of discrete points in chart the set of water depth data of chart can be expressed as k i k i k i 1 n the data structure of k i is x i y i h i the delaunay triangulation method can create the delaunay chart model via discrete coordinate data the model can be represented by set which can be expressed as t j t j m j 1 m m is the set of triangles the data structure of t j is l 1 l 2 l 3 the data structure of l h is k u k v according to the comparative analysis results of lozano perez 1983 tomá and lozano pé 1979 the incremental algorithm based on delaunay cavity property proposed by marcum is used to create the delaunay chart model of water depth data via the chart data the water depth data is retained and the island data is removed the pseudo code of the algorithm is expressed as table 1 when the delaunay chart model is prepare to established the appropriate chart range should be selected satisfying the requirement to ensure that the shortest path will not cross the boundary when the algorithm is solved when the solution result refer to the boundary edge it is essential to expand the scope of the chart to remodel the delaunay chart model in the process of collecting chart data if the data of the point represented land boundary the water depth of the point is recorded as 0 if the data of the point is land with certain altitude data the water depth of the point is recorded as 1 after the completion of delaunay modeling the available delaunay chart model can be obtained by eliminating the edges whose endpoints are 0 or 1 the result of the delaunay chart model via the data shown in fig 2 a is shown in fig 2 b 3 3 determine the scope of forbidden navigation area the delaunay chart model is used to triangulate the discrete water depth data of the chart except for land and island the area where water depth does not satisfy the requirements of ship navigation safety is also regarded as prohibited area all the regional triangles are searched to obtain boundary of area which does not satisfy h s in the delaunay chart model the pseudo code of the algorithm for searching forbidden navigation areas is shown in table 2 the endpoint coordinates of l i can be obtained by eq 3 the coordinate can be expressed as k i x y h i 1 or 2 3 x s x 1 h s h 1 x 2 x 1 h 2 h 1 y s y 1 h s h 1 y 2 y 1 h 2 h 1 the shape of forbidden navigation areas are not all convex polygons in the delaunay chart model however according to the actual requirements of ship navigation concave part of concave polygon is the area where ship will not pass therefore the concave polygon after searching is need to transform into convex polygon before route designing there are different types of classical algorithms to check convexity and convexity of polygons and transform concave polygon to convex polygon feito et al 1995 such as the angle method the left and right point method and the appropriate area method in this paper angle method is used to check convexity of polygons and convert concave polygons to convex polygons the algorithm flow of polygon inspection and processing is shown in table 3 the set of points p v is connected in order and the combined polygon is convex polygon all forbidden navigation areas of convex polygon insert p a 3 4 creation of undirected map of navigable waters to realize ship route design it is necessary to construct undirected map doyle proposed the tangent based method for shortest path planning of robot in two dimensional plane and proved that the shortest path is composed of common tangent between convex polygon boundary and convex polygon doyle 1994 the algorithm flow of the tangent based method is shown in table 4 4 calculation model of ship speed considering environmental impact factors 4 1 calculation model of ship resistance when the ship is sailing in still water the resistance r of hull will advance under the action of the thrust t t can be calculated by the effective power of main engine r can be calculated by the estimating formula the resistance of ship sailing in still water r t can be expressed as 4 r t 1 2 ρ s c t v 2 where s is the wet surface area of the ship ρ is the current water density v is the ship speed c t is the total resistance coefficient which can be expressed as 5 c t c f c r δ c a r where c f is the coefficient of friction resistance which can be estimated by eq 6 c r is the coefficient of residual resistance which can be estimated by the lap and auf m keller chart provided in appendix δ c a r is the roughness allowance coefficient which can be selected in table 5 6 c f 0 4631 lg r n 2 6 r n is the reynolds number which can be expressed as eq 7 ν is the viscosity coefficient of fluid motion which can be selected from table provide in appendix 7 r n v l ν 4 2 calculation model of environmental disturbance when the influence of environmental factors on ship route designing is considered in addition to considering the ship s power and the water purification resistance the impact of environmental factors on the ship s speed is also need to be calculated in this paper the impact of wind wave and current were mainly considered and calculated 4 2 1 the wind force on hull when the ship is sailing the part of above waterline is affected by wind zhong and shi 1982 the component force along the fore and aft direction is x w i n d and the lateral component is y w i n d which can be expressed as 8 x w i n d 1 2 ρ α a f v r w 2 c w i n d x α r y w i n d 1 2 ρ α a s v r w 2 c w i n d y α r where ρ α is the density of air a f and a s are the positive projection area and side projection area above the waterline of ship respectively c w i n d x α r and c w i n d y α r are the longitudinal wind pressure coefficients and the transverse wind pressure coefficients respectively which can be calculated by reference 3 α r is the wind angle 4 2 2 the wave force on hull the existence of waves on the surface of water will exert similar force on hull as wind le 1999 the component force along fore and aft direction is x w a v e and the lateral component is y w a v e which can be expressed as 9 x w a v e 1 2 ρ g l o a ξ w 2 c w a v e x cos π θ w ψ y w a v e 1 2 ρ g l o a ξ w 2 c w a v e y sin π θ w ψ where l o a is the ship length ξ w is the average wave amplitude c w a v e x and c w a v e y are the longitudinal and transverse wave drift force coefficients respectively which can be calculated by the method proposed in candeloro et al 2017 θ w is the wave direction 4 2 3 the effect of water flow on ship speed the influence of uniform flow on ship motion is only kinematic when the ship is sailing on the water surface its relative speed is v the flow velocity is v c the flow direction is ψ c the ship speed to the ground is v r the relationship of above parameters can be shown in fig 3 4 3 force model of ship hull the thrust of engine the resistance of hull the disturbance factors of environment and the correction of flow to the ship speed are considered the force analysis of hull can be carried out and then the ship speed to the ground can be corrected with the flow velocity to obtain the actual speed of ship under the effect of environmental impact factors the force in x axis direction under coordinate system of ship appendage is considered only the schematic diagram of the hull force analysis is shown in fig 4 the force model of hull is shown as follow 10 t r t v x w i n d v x w a v e 5 the automatic route design algorithm for intelligent ships and its solution method 5 1 the automatic route design algorithm for intelligent ships when the scheme of shortest sailing time is required the impact of environmental factors on ship speed should be considered the shortest distance scheme may be not satisfy the requirement therefore it is necessary to modify the weight of the undirected map according to the impact of environmental factors on ship speed the dijkstra algorithm is used to solve the undirected map after weight correction the schematic diagram of algorithm flow is shown in fig 5 5 2 the solution method of the automatic route design algorithm 5 2 1 creation of the total resistance speed chart as expressed in eq 10 when ship sailing with constant thrust ship speed is directly affected by environmental factors the value of speed is closely related to the environmental data of ship location as a result the ship is sailing at a non uniform speed in navigable waters it can be seen from eq 4 and eq 5 that eq 10 cannot be solved directly and the ship speed cannot be obtained therefore the ship speed is need to be solved indirectly when ship is free from environmental impact factors the force relationship satisfy eq 11 11 t r t v according to section 4 1 total resistance of ship can be obtained by employing function expression constructed with ship parameters and its implicit expression is expressed as 12 r t f ρ s v l o a ν a m c p where ν is the viscosity coefficient of fluid motion a m is the mid section area c p is the prismatic coefficient v is the independent variable r t is the dependent variable and other ship parameters are constant therefore the speed calculation accuracy δ v is determined calculate the value of eq 10 with the increment of δ v in the speed range 0 v m a x the total resistance speed chart of v and r t is obtained 5 2 2 solution of environmental disturbance the rectangular environment area is divided into area grid structure each element is a square with accuracy μ in the direction of longitude and latitude the regional environment data is saved as a matrix d the matrix element is expressed as v α ψ t ξ w θ w v c ψ c the environment data corresponding to a cell in the environment grid the value and direction of wind are expressed as v α ψ t the value and direction of wave are expressed as ξ w θ w and the value and direction of flow are expressed as v c ψ c the track segments track a and track b in grid area are shown in fig 6 a among them the cells which the track passes through is represented by shadow the track segment is divided into sub segments with different lengths by grid each gray area cell contains a sub segment to reduce the difficulty of calculation take track b as an example to simplify calculation method of the environmental force the heading angle of track b is ψ b in x axis direction the track is divided into several sections with equal length via boundary of grid the length of each section can be expressed as follow except for the first and last sections 13 l t μ sin ψ b 0 5 π as shown in fig 6 b b1 b9 there are two types of sections can be found case 1 one segment passes only one grid cell for example b3 and grid 4 case 2 one segment passes two grid cells for example b2 and grid 2 grid 3 the calculation of the environmental forces follows following principles case 1 the data matrix of the grid cell can be utilized for directly calculate environmental force x w i n d x w a v e case 2 two grid cells are fused and the data of grid cells is processed as follows 14 u n e w 0 5 μ y 0 y m i d u i 0 5 μ y 0 y m i d u i 1 μ 1 when the corresponding matrix data of two grids are identical the data of these grid cells is directly utilized for calculation 2 when the corresponding matrix data of two grids are different calculate the data of fused cell for calculation of environmental force the coordinate of the mid point of the segment is x 0 y 0 the y axis coordinate value of the common edge of two grid cells is y m i d the data of two grid cells are u i and u i 1 respectively then the data of fused cell is represented by u n e w which can be expressed as follow for track a if the track is subdivided in x axis direction one segment will pass three grid cells for example grid 12 grid 13 grid 14 however if track a is subdivided in y axis direction the problem of passing three or more units can be avoided and the fusion algorithm can adopt the method of processing track b therefore judgment option is set as eq 15 ψ is the track direction 15 s e g m e n t i n y axis d i r e c t i o n ψ 0 ψ π 4 o r 3 π 4 ψ 5 π 4 o r 7 π 4 ψ 2 π s e g m e n t i n x axis d i r e c t i o n ψ π 4 ψ 3 π 4 o r 5 π 4 ψ 7 π 4 5 2 3 the dynamic correction algorithm for grid weights the environmental force of track segment can be expressed as x w i n d i x w a v e i substituting eq 10 to obtain the total resistance of ship combined with the total resistance speed chart of ship generated in 5 2 1 the speed of ship v i in each section is obtained and put them into the set which is expressed as v i i 1 q q is the number of sections according to the conclusion of section 4 2 3 the longitudinal component of current velocity in the matrix data corresponding to each section is calculated as v c x i i 1 q the length of sections are expressed as w i i 1 q the navigation time set of track is t i t i w i v i v c x i i 1 q the path weight of track is converted from length weight to time weight the time weight can be calculated as follow 16 t w i 1 q t i 6 experiments and analysis 6 1 experimental scheme to verify the effectiveness of the proposed algorithm three groups of experiments were carried out which can be expressed as table 6 experiment 1 four different size of ships are employed to verify the necessity of safe water depth of ship navigation four different size of ships are calculated at same tide height to verify that the proposed algorithm can provide safe navigation routes for ships of different size experiment 2 based on the tide values of the qushan island an experimental ship is employed to carry out simulation calculation under different tide heights the results of ship route design algorithm under different value of tide height are analyzed experiment 3 by comparing the proposed algorithm with the algorithm without considering environmental factors the effectiveness of the algorithm is verified when the ship is disturbed by environmental forces experiment 4 the proposed algorithm and the simple route design algorithm are employed to design the route for a real ship at the same time the design results are compared with the actual ais trajectory of the ship and the effectiveness and practical application value of the proposed algorithm are verified the experiments are carried out with the software named as shiproutedesigningsystem exe which is developed by the first author of this paper with c independently the configuration of experimental computer is windows 7 i7 5700hq 32 gb 6 2 experimental data the northern area of the qushan island is employed as experimental water area for example analysis the islands are densely distributed in this water area and the natural water depth satisfies the navigation requirements of small sized ships and medium sized ships the chart of experimental area is expressed as fig 2 a the parameters of the selected ships are shown in table 7 which is employed to calculate the total resistance and the total resistance speed chart is expressed as fig 7 the water density of 15 c 1025 91 kg m3 is selected as environmental data which is given by the 10th international towing tank conference ittc the table is provide in appendix the air density is 1 29 kg m3 the value of tide height is selected from the tide table of the qushan area which can be expressed as fig 8 the ais trajectory data of a ship in the experimental area are collected to verify the practicability of the proposed algorithm the data are shown in table 8 6 3 experimental results and analysis 6 3 1 verify the effectiveness of the algorithm for ship draft requirement the safe water depth of ship navigation of experimental ships are 3 96 m 7 7 m 11 55 m and 15 18 m respectively in the process of ship route designing for the four experimental ships the forbidden navigation areas are expressed as fig 9 the delaunay chart model is obtained by delaunay triangulation of the chart the delaunay chart model can express water depth data via triangular mesh model the original delaunay chart model of the chart is a fixed data set and the navigable area of the ships can be searched in the delaunay chart model via the value of the safe navigation water depth the start point and end point of the required design are set up the undirected graph is solved by the dijkstra algorithm the designing results of four experimental ships are expressed as fig 10 the safe navigation water depth of the four experimental ships changed from shallow to deep and the area of forbidden navigation areas increased from small to large the ship 1 needs the minimum safe depth for navigating and it can navigate in area a and b are expressed as fig 10 a the safe navigation depth of ship 2 is slightly larger than that of ship 1 after searching in the delaunay chart model ship 2 cannot navigate in area b but it can navigate in area a as shown in fig 10 b the safe navigation depth of ship 3 and ship 4 are required to be deeper than ship 2 so the area a and area b cannot satisfy sailing macroscopically the designing results of ship 3 and ship 4 are similar however from the perspective of details there is a certain difference between the two routes in fig 10 c and fig 10 d in the part pointed by the arrow these differences are caused by the difference of the safe navigation water depth between ship 3 and ship 4 according to the above experimental results the proposed algorithm can obtain navigable waters that satisfy the navigation requirements via the ship draft and provide safe navigation routes for ships based on the environmental model the experimental results can prove the effectiveness of the proposed algorithm 6 3 2 verify the effectiveness of the algorithm to satisfy the tide height the water depth of the experimental water area has great difference under different tidal high values after the superposition of different tidal high water levels and water depth on the chart the environmental modeling results when the tidal heights are 60 110 160 210 260 and 310 cm are expressed as fig 11 different tidal heights directly determine the overall water depth therefore there will have differences when designing the routes to verify the impact of tidal height on ship route designing ship 3 is employed to design routes under different tidal heights and the results are expressed as fig 12 the water depth changes greatly when the different tidal height and the chart water depth are superposed when the safe navigation depth of experimental ship remains unchanged there are certain differences in the forbidden navigation areas generated by the delaunay chart model which makes the designing results different the calculation range of tidal height is from 60 cm to 340 cm the calculation results can be divided into two groups via path trend the range of tidal height of group 1 is between 200 cm and 340 cm add 20 cm each time the range of tide height of group 2 is between 60 cm and 180 cm add 30 cm each time the tangent graph method is used to construct the navigable network undirected graph after environment modeling and the dijkstra algorithm is employed to solve the undirected graph when the tidal height is between 60 cm and 180 cm the ship cannot navigate in the area a and have to navigate pass area b when the tidal height is between 200 cm and 340 cm the water depth of the area a can satisfy the safe navigation depth of the ship 3 the experimental results show that the proposed algorithm has good applicability to the consideration of the tidal height factor and the algorithm can design a safe navigation route for the same ship under different tidal height values 6 3 3 verify the effectiveness of the algorithm to deal with the impact of environment factors on ship navigation to prove that the proposed algorithm can solve the problem of considering environment factors in route designing the area near the huangze island is employed as experimental area two sets of environmental data were designed and set as experimental parameters as shown in fig 13 the wind force in wind field is constant the flow velocity is constant the wave direction and amplitude are constant the differences of environmental data are as follows the wind direction and the flow direction of experiment 3 1 are not fixed the wind direction and the flow direction of experiment 3 2 are fixed two groups of sub experiments were carried out under the environment data of experiment 1 which are as follow 1 implementation of route design algorithm considering environmental factors impact the dijkstra algorithm is employed to solve the undirected graph the result is the route b expressed as fig 14 a 2 implementation of route design algorithm without considering environmental factors impact as a comparative experiment the dijkstra algorithm is employed to solve the undirected graph the result is the route b expressed as fig 14 b the experimental results of experiment 3 1 are obtained the starting point inflection point and end point of the experimental path were retained the original two routes were carried out by route c and route d respectively under the environment of experiment 3 2 as shown in fig 14 b the sailing time and average sailing speed of the two routes were calculated the statistics results of the routes of the two groups of experiments are shown in table 9 the route a and route c the route b and route d have the same route form and the same route length there are great differences in environmental data experiment 3 1 was carried out in a non directional environmental data the ship sailing along the route b was carried out under the condition of following the wind and the current in this experiment following the wind does not mean following the wind completely but the component of wind force and flow direction in the route direction is positive corresponding to route b 66 18 of route a is sailing in adverse wind and current which leads to the fact that although the length of route b is longer than that of route a the time of sailing on route b is relatively less in experiment 3 2 both route c and route d are following the wind and the current and route c is shorter and faster than route d in all aspects experiments show that the proposed algorithm can effectively deal with the changing environment data and can provide the results of route designing based on environmental factors impact for ships 6 3 4 application experiment and analysis to further verify the effectiveness and practicability of the proposed algorithm the proposed algorithm and simple route design algorithm are employed to design the route for a real ship respectively the environment modeling of the simple route design algorithm only relies on the extraction of the land in the chart as an obstacle without considering the water depth the tangent based method is employed to solve the route this simple algorithm is extensively applied in robot route design without considering environmental factors the real time data of collecting ship ais trajectory data is selected for meteorological environment data and the solution results are shown in fig 15 the design result a in the figure is the design result of the proposed algorithm the design result b is the design result of simple algorithm to better reflect the ability of the proposed algorithm in environmental modeling and influencing factors processing a section of ais trajectory data of the ship sailing through the waters between the island a and the island b is selected as the reference the ais trajectory data are shown in table 8 there is a great difference between the two algorithms in the ability to process environmental data according to the fig 15 although a route from the start point to the end point can be obtained by the simple algorithm whether the water depth satisfied the requirements of ship navigation is not considered and the designed route is also close to the boundary of obstacles which will bring great risks to the navigation of the ship p 1 and p 4 are the intersection points of the designed route and obstacles as expressed in fig 15 which verified that the result cannot be put into practical application there is also a big deviation compared with the real ais trajectory the application of part traditional robot route design algorithms is not suitable for the ship route design is verified the proposed algorithm considered the safe water depth and other environmental factors for the navigation the inflection points of the designed route are p 2 and p 3 the depth of which satisfied the requirements of ship navigation by observation compared with the real ais trajectory of the ship navigation p 2 and p 3 are in line with the actual trajectory of the ship which verified the rationality and practicability of the algorithm the reasons for the deviation between the result of the proposed algorithm and the actual ais trajectory are analyzed the algorithm took into account the requirements of navigation depth and the influence of meteorological environment on the route the consideration of safe water depth directly affects the ship s ability to pass through a certain area of water the other meteorological environmental factors are considered in the timeliness and economy of the designed route according to the trend of ais trajectory the deviation from p 3 to the end point is due to the ship needs to make a large range of steering and the reverse steering before steering is carried out in advance the experimental results showed that the algorithm proposed in this paper is reasonable and practical based on the above analysis it reflects a future optimization direction of the algorithm proposed in this paper the route design algorithm needs to consider the smoothness of the trajectory when ship steering the results of the experiments showed that the proposed algorithm has practical application value under certain conditions it can provide a route with advantages in sailing time for ships which is different from the route without considering the environmental factors impact therefore the algorithm proposed in this paper is different from other ship route design algorithms which are dedicated to reducing the distance of navigation it is verified that the current popular robot path planning algorithm cannot be directly applied to the ship route designing 7 conclusion in this paper a novel automatic route design algorithm for intelligent ships based on electronic chart data is proposed the algorithm fully considered the ship navigation safety and influence of environment on ship navigation the advantages of novel algorithm as follows 1 in this paper the chart data is used to create environment model directly which can not only obtain the most accurate navigation environment data but also has a high adaptability under the background of comprehensive popularization of electronic chart 2 when dealing with the influence of environment on ship it is found that there is a complex interdependence among ship s power resistance environmental interference and speed therefore it is impossible to solve the ship speed directly by analytical method with real time data when designing route considering the influence of environment factors impact in this paper the ship parameters are used to make a simulation experiment in advance the ship total resistance speed chart is proposed to solve ship s speed 3 the advantage of the proposed algorithm is that it can solve the problem based on the chart data ship draft hull parameters and environmental parameters the calculation methods of each section of the algorithm are integrated into the algorithm to realize the automatic calculation of the algorithm in the whole process of calculation according to the experimental results the proposed algorithm can automatically provide an economical and safe route for the intelligent ship via the data that the algorithm depends on the proposed automatic route design algorithm provides a practical method for ship route designing of medium and short distance routes especially for the intelligent ships in special circumstances the route is needed to be modified temporarily the proposed algorithm can effectively design a temporary route the algorithm can fully consider both water depth and influence of environment which is the point of causing mistakes in artificial routes designing the proposed algorithm provided a safe and effective route for ship but some limitations appeared after several rounds of experiments in this paper the delaunay triangulation method is employed for environment modeling and the modeling speed still needs to be further optimized the experimental results showed that the smooth degree of the designing results at the inflection point of the route needs to be further considered compared with the ais trajectory in addition the proposed algorithm has a close demand for ship parameters it is essential to optimize the estimation method of ship dynamic resistance before the algorithm is put into practical application to better calculate the influence of environmental factors on ship navigation this paper proposed a novel automatic route design algorithm however its efficiency and application effect still have limitations the algorithm will be further improved in efficiency in the future research process and the calculation of various environmental factors will be further optimized and integrated with the popularization of ships routing and reporting systems the design of intelligent ship automatic route design needs to combine the factor of the ships routing and reporting systems the algorithm of automatic route design for medium and short distance is a branch of ship route design domain it will be the focus of future research to extend the advantages of the proposed algorithm to the route design algorithm of open sea and to complete the organic combination of short distance algorithm and long distance algorithm with the rapid development of maritime intelligent transportation and intelligent ships automatic route design algorithm for intelligent ships considering navigation safety and influence of environment has a wide range of application prospects with the rise of unmanned ships the proposed algorithm provides a new development direction for ship route designing in the case of unmanned operation self identification of navigation environment is of great value in addition the influence of external environment on ship speed needs quantitative analysis and the algorithm proposed in this paper can provide certain research basis in this field credit authorship contribution statement wei pan software conceptualization methodology data curation writing original draft writing review editing visualization xin lian xie conceptualization methodology writing original draft writing review editing supervision project administration funding acquisition ping he formal analysis investigation validation tian tian bao formal analysis investigation validation meng li formal analysis methodology resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the the national key research and development program of china 2017yfc0805309 the fundamental research funds for the central universities 3132019303 and the natural science foundation of zhejiang province lq20g020011 appendix lap and auf m keller chart index map image 5 chart of group a image 6 chart of group b image 7 chart of group c image 8 chart of group d image 9 chart of group e image 10 viscosity coefficient of water and density of water 10th ittc freshwater temperature seawater freshwater temperature seawater 106 ν m2 s ρ kg m3 t c 106 ν m2 s ρ kg m3 106 ν m2 s ρ kg m3 t c 106 ν m2 s ρ kg m3 1 78667 999 82 0 1 82844 1028 07 1 12902 999 04 15 1 18831 1025 91 1 72701 999 82 1 1 76915 1027 97 1 10966 998 94 16 1 15916 1025 71 1 67040 999 92 2 1 71306 1027 87 1 08155 998 74 17 1 13125 1025 42 1 61665 999 92 3 1 65988 1027 87 1 05456 998 55 18 1 10438 1025 22 1 56557 999 92 4 1 60940 1027 77 1 02865 998 35 19 1 07854 1025 03 1 51698 999 92 5 1 56142 1027 68 1 00374 998 16 20 1 05372 1024 73 1 47070 999 92 6 1 51584 1027 48 0 97984 997 96 21 1 02981 1024 44 1 42667 999 82 7 1 47242 1027 38 0 95682 997 76 22 1 00678 1024 15 1 38471 999 82 8 1 43102 1027 19 0 93471 997 47 23 0 98457 1023 85 1 34463 999 73 9 1 39152 1027 09 0 91340 997 27 24 0 96315 1023 56 1 30641 999 63 10 1 35383 1026 89 0 89292 996 98 25 0 94252 1023 26 1 26988 999 53 11 1 31773 1026 69 0 87313 996 78 26 0 92255 1022 97 1 23495 999 43 12 1 28324 1026 60 0 85409 996 49 27 0 90331 1022 67 1 20159 999 33 13 1 25028 1026 30 0 83572 996 20 28 0 88470 1022 28 1 16964 999 14 14 1 21862 1026 11 0 81798 995 90 29 0 86671 1021 98 0 80092 995 61 30 0 84931 1021 69 
20290,an automatic route design algorithm for intelligent ships based on a novel environment modeling method wei pan software conceptualization methodology data curation writing original draft writing review editing visualization a xin lian xie conceptualization methodology writing original draft writing review editing supervision project administration funding acquisition a ping he formal analysis investigation validation b tian tian bao formal analysis investigation validation c meng li formal analysis methodology resources a a integrated transport institute dalian maritime university dalian 116026 china integrated transport institute dalian maritime university dalian 116026 china integrated transport institute dalian maritime university dalian 116026 china b school of naval architecture ocean and civil engineering shanghai jiao tong university shanghai 200240 china school of naval architecture ocean and civil engineering shanghai jiao tong university shanghai 200240 china school of naval architecture ocean and civil engineering shanghai jiao tong university shanghai 200240 china c faculty of maritime and transportation ningbo university ningbo 315211 china faculty of maritime and transportation ningbo university ningbo 315211 china faculty of maritime and transportation ningbo university ningbo 315211 china corresponding author an automatic route design algorithm for intelligent ships considering environmental factors impact and navigation safety is proposed the delaunay triangulation method is used to model chart data safe water depth of ship navigation calculation model is proposed whose result is used to search the forbidden navigation areas in delaunay chart model the navigation network is created by the tangent based method based on the delaunay chart model the speed of ship under environmental factors impact is recalculated which is used to modify path weight of the navigable network the route design scheme is obtained by solving the modified network with the dijkstra algorithm the experimental results show that the algorithm can provide the adaptive route scheme via ship size and tide height moreover the environmental factors are used as variables to prove that the algorithm can consider the environmental factors and provide an economical navigation scheme keywords intelligent ships hydrodynamics delaunay triangulation method tangent based method dijkstra algorithm 1 introduction with the continuous development of economic globalization the maritime transport has achieved unprecedented development the number of ships in china s coastal waters is unprecedented under the background of vigorous development of shipbuilding industry ships are developing towards large scale high speed and intelligent the intelligent ship research is the future development direction of shipbuilding industry and has broad application prospects the development of intelligent ship related theories can vigorously promote the rapid development of intelligent ship industry and even strengthen the construction of maritime intelligent transportation the navigation safety of intelligent ships is an important prerequisite to ensure the green and rapid development of intelligent ships the complexity of navigation environment on water increases the risk of navigation of intelligent ships an economical and safe route for intelligent ships is needed therefore this paper proposed an automatic route design algorithm for intelligent ships based on electronic chart in early research of ship route design the shortest distance scheme is usually regarded as the goal with the deepening of the research meteorological factors are gradually considered which is mainly aimed at the design of global routes in addition ship route design generally adopts experience method however when navigation situation changed such as construction new sinking ships etc the route designed originally is no longer applicable at this time rerouting will cause heavy workload to the ship pilot especially when the ship pilot is not familiar with the situation of the water which may cause the ship sailing into a dangerous situation therefore ship route planned by computer can not only reduce pilot s burden but also make the route scientifically and effectively an automatic route design algorithm for intelligent ships which can consider as many factors as possible is urgently needed the process of ship route design algorithm can be divided into two stages macroscopically environment modeling and path planning to make the route planned by algorithm as scientific and reasonable as possible the accuracy of environment modeling is particularly important among the current ship communication and navigation equipment the application of electronic chart is quite popular compared with paper chart electronic chart shows great advantages in many aspects the electronic chart display and information system ecdis derived from electronic chart is regarded as another great technological revolution in the field of ship navigation after the automatic radar plotting aid arpa therefore create environment model via electronic chart is an effective and scientific method in the electronic chart file water depth obstacles and other elements are saved then water depth model can be established which is used to search for areas that satisfy water depth requirements dynamically when ship is sailing except for the special circumstances such as traffic separation schemes network of ship s navigation is not fixed therefore it is necessary to create navigation network with the range of obstacles or the boundary of forbidden navigation areas in this paper the tangent based method is used to construct navigation network a reasonable navigable network can be constructed with the data of areas which water depth is unsatisfied in route designing stage the network generated in environment modeling stage is need to be solved in the previous stage safety of ship navigation has been considered in environment modeling stage the classical path algorithm can provide a shortest path for ships however the shortest route is not necessarily the most economical lots of factors affect the economy of ship navigation only providing the shortest route for ship is not able to satisfy the needs of ship navigation therefore the speed calculation method is applied to the weight correction of ship navigation network then the route scheme of economical can be available the remainder of this paper is organized as follows in section 2 a brief literature review of environment modeling and relevant research results of ship route design algorithm are given in section 3 navigation environment modeling and navigation network creating model based on chart data are proposed in section 4 ship mechanics analysis considering the influence of environmental factors is given and then the calculation method of ship speed is given in section 5 the solution method of calculation model proposed in this paper is introduced the speed problem which is difficult to be solved directly is described in detail finally the method of modifying the weight of navigation network is given in section 6 three groups of simulation experiments are carried out the algorithm proposed in this paper is fully verified the conclusions and discussed in section 7 2 related work according to the references on route design algorithm of ships and other surface equipment the basic steps of route design algorithm can be divided into two main modes which expressed as fig 1 the ship route design algorithm of mode i is implemented in two stages the navigation network is created by environment modeling and the navigable route can be obtained the ship route design algorithm of mode ii is implemented in three stages firstly the navigation network is created by environment modeling then the initial solution of route is obtained with initial path planning algorithm the optimization algorithm is used to optimize the initial path to get the final solution 2 1 theory of environmental modeling when a ship is sailing on the water its route can be freely chosen on the premise of safety the uncertainty of navigation area leads to the necessity of environment modeling before ship route designing the classical environment modeling algorithms are divided into two main branches the signpost methods and the grid methods the signpost method is an intuitive environmental modeling method its principle is to build a network suitable for ship navigation via basic environment data directly after years of development there have been several mature algorithms for signpost method visibility graph method voronoi diagram method maklink graph method and tangent based method etc the visibility graph method was proposed by lozano perez 1983 several methods have been proposed to optimize the visibility graph method which make it more practical in application lozano perez 1983 c h chung and g n saridis 1989 the basic principle of visibility graph method is to connect the starting point terminal point and obstacles with straight lines all connecting lines shall not cross obstacles the voronoi diagram method was proposed by georgy voronoi the voronoi diagram is composed of a group of continuous polygons which are composed of vertical bisectors connecting two adjacent straight lines as a classical algorithm of environment modeling it is widely used in different fields wang used the voronoi diagram method to model the scene when designing the integrated design scheme of virtual museum roaming system wang et al 2006 mauro proposed a rapid and dynamic path planning system candeloro et al 2017 liu used the voronoi diagram method to model the crushed stone in the navigation simulation of ship navigation in ice rubble liu et al 2018 mauro proposed a two dimensional curvature continuous path planning algorithm based on the voronoi diagram method and fermat s spiral segments candeloro et al 2013 the maklink graph method was proposed by habib 1991 the basic principle of maklink graph method is using the midpoints of common free links between free convex areas as passing points these points correspond to nodes in a graph and the connection between them within each convex area as arcs in this graph qin used the maklink graph method to describe the working space of mobile robot qin et al 2005 zhao used the maklink graph method to construct free space when he presented a novel approach to search and optimize path points for anti ship missile path planning zhao and fan 2009 shen proposed a polyclonal particle swarm optimization algorithm and built an experimental environment of mobile robot using the maklink graph method to test the proposed algorithm shen and yuan 2010 in the process of the designing of iot based intelligent logistics dispatching system wang used the maklink graph method to model the operation environment of picking robot wang et al 2020 the tangent based method is proposed by doyle the basic principle of tangent based method is based on polygonal obstacle model obstacles with different shape are replaced by approximate polygon the tangent graph is constructed in free space and common tangent between obstacles is constructed to form final network zhang proposed the shortest tangent risk aversion algorithm in the anti ship missile route design algorithm which is realized by the tangent based method zhang et al 2008 mao proposed a path planning algorithm whose navigation environment is created by the tangent based method mao et al 2009 after comparing various signpost methods different methods have different pertinence when modeling environment the visibility graph method is to connect points in the whole obstacle area which makes the creation of network more sufficient when the voronoi diagram method and maklink graph method are used to model the environment the calculated path is far away from obstacles which maybe ensure the safety however in some cases a long distance path will be given which cannot fully reflect the advantages of path planning the principle of the tangent based method is to make the path close to obstacles as much as possible which is the opposite of the voronoi diagram method and maklink graph method in some modeling scenarios this method will reduce the safety of path but if other aspects of safety are considered and constrained the path given by tangent graph method can be shorter than that given by other methods 2 2 theory of path planning algorithm the path planning algorithm and path optimization algorithm adopt similar algorithm the algorithm can be divided into following branches from the perspective of research methods analytic method heuristic algorithm intelligent algorithm and heuristic and intelligent combination algorithm the analytic method is to solve the network after environment modeling by data structure and graph theory directly however there are few studies on obtaining the final results through analytical method directly for the complex situation of ships sailing on the water the results of analytic method are mostly used as initial solution liu obtained the initial solution of path planning with dijkstra algorithm and completed the path optimization with particle swarm optimization algorithm yujie et al 2018 the heuristic algorithm is a main method to solve path planning problem which has ability to solve complex network effectively the a algorithm is a typical heuristic algorithm which is widely used in ship route planning on the basis of environment modeling part scholars obtained final solution of ship route designing by a algorithm li et al 2017 and wang et al 2017 in addition part scholars use particle swarm optimization to solve the model established in route planning section liu et al 2018 and shenet al 2019 the artificial potential field method is another effective algorithm in dealing with robot obstacle avoidance and ship collision avoidance path planning its original is to abstract ship to navigate in a force field the target point has a gravitational effect on ship and obstacles have repulsive effects on ship then guide ship to navigate in a safe route through resultant force xie et al 2019 and lazarowska 2018 the intelligent algorithm is a new algorithm rising in the development of artificial intelligence and big data theory it has the ability of mining and analyzing historical data which can guide the operation through knowledge provided by historical data data mining analysis and learning based on trajectory history data can provide a safe route for ships in the process of route designing lazarowska et al 2016 gkerekos et al 2020 wen et al 2020 the heuristic and intelligent combination algorithm is combine the advantages of heuristic algorithm and intelligent algorithm which make full use of the advantages of two algorithms when applied to ship route designing chen et al 2019 and zha et al 2019 scholars have made a lot of achievements in ship route designing and other equipment path planning algorithms while in the environment modeling section scholars mainly based on the abstract mathematical model and few directly modeling via the chart or field map which leads to the algorithm in practical application will face some problems in the aspect of path planning algorithm the algorithms proposed by scholars are quite effective which can solve the problems under different conditions 3 creation of navigable water network 3 1 the safe water depth of ship navigation to ensure the navigation safety of ship the area with water depth exceeding draft of ship and certain safety margin shall be selected for navigation the water depth have to satisfy as 1 h s h c h t h a d m where h s is the safe water depth of ship navigation h a is the minimum safety margin water depth d m is the draft of ship h c is the water depth of chart which indicating the theoretical lowest tide surface water depth at this point h t is the height of tide the navigable area of ship shall satisfy the safe water depth of ship the value of navigable water depth is greater or equal to the sum of the ship draft and the minimum safe surplus water depth after different factors of ship safety are considered 10 of the ship draft is taken as the minimum safety margin water depth eq 1 can be converted into eq 2 2 h s h c h t d m 110 3 2 the delaunay model of chart data determine navigable area with numerical value of water depth is the most direct and effective method the electronic chart stores and displays real world entities in the form of data as shown in fig 2 a it contains water depth data which is stored as coordinate water depth value in electronic chart file the value of water depth can be displayed in the form of discrete points in chart the set of water depth data of chart can be expressed as k i k i k i 1 n the data structure of k i is x i y i h i the delaunay triangulation method can create the delaunay chart model via discrete coordinate data the model can be represented by set which can be expressed as t j t j m j 1 m m is the set of triangles the data structure of t j is l 1 l 2 l 3 the data structure of l h is k u k v according to the comparative analysis results of lozano perez 1983 tomá and lozano pé 1979 the incremental algorithm based on delaunay cavity property proposed by marcum is used to create the delaunay chart model of water depth data via the chart data the water depth data is retained and the island data is removed the pseudo code of the algorithm is expressed as table 1 when the delaunay chart model is prepare to established the appropriate chart range should be selected satisfying the requirement to ensure that the shortest path will not cross the boundary when the algorithm is solved when the solution result refer to the boundary edge it is essential to expand the scope of the chart to remodel the delaunay chart model in the process of collecting chart data if the data of the point represented land boundary the water depth of the point is recorded as 0 if the data of the point is land with certain altitude data the water depth of the point is recorded as 1 after the completion of delaunay modeling the available delaunay chart model can be obtained by eliminating the edges whose endpoints are 0 or 1 the result of the delaunay chart model via the data shown in fig 2 a is shown in fig 2 b 3 3 determine the scope of forbidden navigation area the delaunay chart model is used to triangulate the discrete water depth data of the chart except for land and island the area where water depth does not satisfy the requirements of ship navigation safety is also regarded as prohibited area all the regional triangles are searched to obtain boundary of area which does not satisfy h s in the delaunay chart model the pseudo code of the algorithm for searching forbidden navigation areas is shown in table 2 the endpoint coordinates of l i can be obtained by eq 3 the coordinate can be expressed as k i x y h i 1 or 2 3 x s x 1 h s h 1 x 2 x 1 h 2 h 1 y s y 1 h s h 1 y 2 y 1 h 2 h 1 the shape of forbidden navigation areas are not all convex polygons in the delaunay chart model however according to the actual requirements of ship navigation concave part of concave polygon is the area where ship will not pass therefore the concave polygon after searching is need to transform into convex polygon before route designing there are different types of classical algorithms to check convexity and convexity of polygons and transform concave polygon to convex polygon feito et al 1995 such as the angle method the left and right point method and the appropriate area method in this paper angle method is used to check convexity of polygons and convert concave polygons to convex polygons the algorithm flow of polygon inspection and processing is shown in table 3 the set of points p v is connected in order and the combined polygon is convex polygon all forbidden navigation areas of convex polygon insert p a 3 4 creation of undirected map of navigable waters to realize ship route design it is necessary to construct undirected map doyle proposed the tangent based method for shortest path planning of robot in two dimensional plane and proved that the shortest path is composed of common tangent between convex polygon boundary and convex polygon doyle 1994 the algorithm flow of the tangent based method is shown in table 4 4 calculation model of ship speed considering environmental impact factors 4 1 calculation model of ship resistance when the ship is sailing in still water the resistance r of hull will advance under the action of the thrust t t can be calculated by the effective power of main engine r can be calculated by the estimating formula the resistance of ship sailing in still water r t can be expressed as 4 r t 1 2 ρ s c t v 2 where s is the wet surface area of the ship ρ is the current water density v is the ship speed c t is the total resistance coefficient which can be expressed as 5 c t c f c r δ c a r where c f is the coefficient of friction resistance which can be estimated by eq 6 c r is the coefficient of residual resistance which can be estimated by the lap and auf m keller chart provided in appendix δ c a r is the roughness allowance coefficient which can be selected in table 5 6 c f 0 4631 lg r n 2 6 r n is the reynolds number which can be expressed as eq 7 ν is the viscosity coefficient of fluid motion which can be selected from table provide in appendix 7 r n v l ν 4 2 calculation model of environmental disturbance when the influence of environmental factors on ship route designing is considered in addition to considering the ship s power and the water purification resistance the impact of environmental factors on the ship s speed is also need to be calculated in this paper the impact of wind wave and current were mainly considered and calculated 4 2 1 the wind force on hull when the ship is sailing the part of above waterline is affected by wind zhong and shi 1982 the component force along the fore and aft direction is x w i n d and the lateral component is y w i n d which can be expressed as 8 x w i n d 1 2 ρ α a f v r w 2 c w i n d x α r y w i n d 1 2 ρ α a s v r w 2 c w i n d y α r where ρ α is the density of air a f and a s are the positive projection area and side projection area above the waterline of ship respectively c w i n d x α r and c w i n d y α r are the longitudinal wind pressure coefficients and the transverse wind pressure coefficients respectively which can be calculated by reference 3 α r is the wind angle 4 2 2 the wave force on hull the existence of waves on the surface of water will exert similar force on hull as wind le 1999 the component force along fore and aft direction is x w a v e and the lateral component is y w a v e which can be expressed as 9 x w a v e 1 2 ρ g l o a ξ w 2 c w a v e x cos π θ w ψ y w a v e 1 2 ρ g l o a ξ w 2 c w a v e y sin π θ w ψ where l o a is the ship length ξ w is the average wave amplitude c w a v e x and c w a v e y are the longitudinal and transverse wave drift force coefficients respectively which can be calculated by the method proposed in candeloro et al 2017 θ w is the wave direction 4 2 3 the effect of water flow on ship speed the influence of uniform flow on ship motion is only kinematic when the ship is sailing on the water surface its relative speed is v the flow velocity is v c the flow direction is ψ c the ship speed to the ground is v r the relationship of above parameters can be shown in fig 3 4 3 force model of ship hull the thrust of engine the resistance of hull the disturbance factors of environment and the correction of flow to the ship speed are considered the force analysis of hull can be carried out and then the ship speed to the ground can be corrected with the flow velocity to obtain the actual speed of ship under the effect of environmental impact factors the force in x axis direction under coordinate system of ship appendage is considered only the schematic diagram of the hull force analysis is shown in fig 4 the force model of hull is shown as follow 10 t r t v x w i n d v x w a v e 5 the automatic route design algorithm for intelligent ships and its solution method 5 1 the automatic route design algorithm for intelligent ships when the scheme of shortest sailing time is required the impact of environmental factors on ship speed should be considered the shortest distance scheme may be not satisfy the requirement therefore it is necessary to modify the weight of the undirected map according to the impact of environmental factors on ship speed the dijkstra algorithm is used to solve the undirected map after weight correction the schematic diagram of algorithm flow is shown in fig 5 5 2 the solution method of the automatic route design algorithm 5 2 1 creation of the total resistance speed chart as expressed in eq 10 when ship sailing with constant thrust ship speed is directly affected by environmental factors the value of speed is closely related to the environmental data of ship location as a result the ship is sailing at a non uniform speed in navigable waters it can be seen from eq 4 and eq 5 that eq 10 cannot be solved directly and the ship speed cannot be obtained therefore the ship speed is need to be solved indirectly when ship is free from environmental impact factors the force relationship satisfy eq 11 11 t r t v according to section 4 1 total resistance of ship can be obtained by employing function expression constructed with ship parameters and its implicit expression is expressed as 12 r t f ρ s v l o a ν a m c p where ν is the viscosity coefficient of fluid motion a m is the mid section area c p is the prismatic coefficient v is the independent variable r t is the dependent variable and other ship parameters are constant therefore the speed calculation accuracy δ v is determined calculate the value of eq 10 with the increment of δ v in the speed range 0 v m a x the total resistance speed chart of v and r t is obtained 5 2 2 solution of environmental disturbance the rectangular environment area is divided into area grid structure each element is a square with accuracy μ in the direction of longitude and latitude the regional environment data is saved as a matrix d the matrix element is expressed as v α ψ t ξ w θ w v c ψ c the environment data corresponding to a cell in the environment grid the value and direction of wind are expressed as v α ψ t the value and direction of wave are expressed as ξ w θ w and the value and direction of flow are expressed as v c ψ c the track segments track a and track b in grid area are shown in fig 6 a among them the cells which the track passes through is represented by shadow the track segment is divided into sub segments with different lengths by grid each gray area cell contains a sub segment to reduce the difficulty of calculation take track b as an example to simplify calculation method of the environmental force the heading angle of track b is ψ b in x axis direction the track is divided into several sections with equal length via boundary of grid the length of each section can be expressed as follow except for the first and last sections 13 l t μ sin ψ b 0 5 π as shown in fig 6 b b1 b9 there are two types of sections can be found case 1 one segment passes only one grid cell for example b3 and grid 4 case 2 one segment passes two grid cells for example b2 and grid 2 grid 3 the calculation of the environmental forces follows following principles case 1 the data matrix of the grid cell can be utilized for directly calculate environmental force x w i n d x w a v e case 2 two grid cells are fused and the data of grid cells is processed as follows 14 u n e w 0 5 μ y 0 y m i d u i 0 5 μ y 0 y m i d u i 1 μ 1 when the corresponding matrix data of two grids are identical the data of these grid cells is directly utilized for calculation 2 when the corresponding matrix data of two grids are different calculate the data of fused cell for calculation of environmental force the coordinate of the mid point of the segment is x 0 y 0 the y axis coordinate value of the common edge of two grid cells is y m i d the data of two grid cells are u i and u i 1 respectively then the data of fused cell is represented by u n e w which can be expressed as follow for track a if the track is subdivided in x axis direction one segment will pass three grid cells for example grid 12 grid 13 grid 14 however if track a is subdivided in y axis direction the problem of passing three or more units can be avoided and the fusion algorithm can adopt the method of processing track b therefore judgment option is set as eq 15 ψ is the track direction 15 s e g m e n t i n y axis d i r e c t i o n ψ 0 ψ π 4 o r 3 π 4 ψ 5 π 4 o r 7 π 4 ψ 2 π s e g m e n t i n x axis d i r e c t i o n ψ π 4 ψ 3 π 4 o r 5 π 4 ψ 7 π 4 5 2 3 the dynamic correction algorithm for grid weights the environmental force of track segment can be expressed as x w i n d i x w a v e i substituting eq 10 to obtain the total resistance of ship combined with the total resistance speed chart of ship generated in 5 2 1 the speed of ship v i in each section is obtained and put them into the set which is expressed as v i i 1 q q is the number of sections according to the conclusion of section 4 2 3 the longitudinal component of current velocity in the matrix data corresponding to each section is calculated as v c x i i 1 q the length of sections are expressed as w i i 1 q the navigation time set of track is t i t i w i v i v c x i i 1 q the path weight of track is converted from length weight to time weight the time weight can be calculated as follow 16 t w i 1 q t i 6 experiments and analysis 6 1 experimental scheme to verify the effectiveness of the proposed algorithm three groups of experiments were carried out which can be expressed as table 6 experiment 1 four different size of ships are employed to verify the necessity of safe water depth of ship navigation four different size of ships are calculated at same tide height to verify that the proposed algorithm can provide safe navigation routes for ships of different size experiment 2 based on the tide values of the qushan island an experimental ship is employed to carry out simulation calculation under different tide heights the results of ship route design algorithm under different value of tide height are analyzed experiment 3 by comparing the proposed algorithm with the algorithm without considering environmental factors the effectiveness of the algorithm is verified when the ship is disturbed by environmental forces experiment 4 the proposed algorithm and the simple route design algorithm are employed to design the route for a real ship at the same time the design results are compared with the actual ais trajectory of the ship and the effectiveness and practical application value of the proposed algorithm are verified the experiments are carried out with the software named as shiproutedesigningsystem exe which is developed by the first author of this paper with c independently the configuration of experimental computer is windows 7 i7 5700hq 32 gb 6 2 experimental data the northern area of the qushan island is employed as experimental water area for example analysis the islands are densely distributed in this water area and the natural water depth satisfies the navigation requirements of small sized ships and medium sized ships the chart of experimental area is expressed as fig 2 a the parameters of the selected ships are shown in table 7 which is employed to calculate the total resistance and the total resistance speed chart is expressed as fig 7 the water density of 15 c 1025 91 kg m3 is selected as environmental data which is given by the 10th international towing tank conference ittc the table is provide in appendix the air density is 1 29 kg m3 the value of tide height is selected from the tide table of the qushan area which can be expressed as fig 8 the ais trajectory data of a ship in the experimental area are collected to verify the practicability of the proposed algorithm the data are shown in table 8 6 3 experimental results and analysis 6 3 1 verify the effectiveness of the algorithm for ship draft requirement the safe water depth of ship navigation of experimental ships are 3 96 m 7 7 m 11 55 m and 15 18 m respectively in the process of ship route designing for the four experimental ships the forbidden navigation areas are expressed as fig 9 the delaunay chart model is obtained by delaunay triangulation of the chart the delaunay chart model can express water depth data via triangular mesh model the original delaunay chart model of the chart is a fixed data set and the navigable area of the ships can be searched in the delaunay chart model via the value of the safe navigation water depth the start point and end point of the required design are set up the undirected graph is solved by the dijkstra algorithm the designing results of four experimental ships are expressed as fig 10 the safe navigation water depth of the four experimental ships changed from shallow to deep and the area of forbidden navigation areas increased from small to large the ship 1 needs the minimum safe depth for navigating and it can navigate in area a and b are expressed as fig 10 a the safe navigation depth of ship 2 is slightly larger than that of ship 1 after searching in the delaunay chart model ship 2 cannot navigate in area b but it can navigate in area a as shown in fig 10 b the safe navigation depth of ship 3 and ship 4 are required to be deeper than ship 2 so the area a and area b cannot satisfy sailing macroscopically the designing results of ship 3 and ship 4 are similar however from the perspective of details there is a certain difference between the two routes in fig 10 c and fig 10 d in the part pointed by the arrow these differences are caused by the difference of the safe navigation water depth between ship 3 and ship 4 according to the above experimental results the proposed algorithm can obtain navigable waters that satisfy the navigation requirements via the ship draft and provide safe navigation routes for ships based on the environmental model the experimental results can prove the effectiveness of the proposed algorithm 6 3 2 verify the effectiveness of the algorithm to satisfy the tide height the water depth of the experimental water area has great difference under different tidal high values after the superposition of different tidal high water levels and water depth on the chart the environmental modeling results when the tidal heights are 60 110 160 210 260 and 310 cm are expressed as fig 11 different tidal heights directly determine the overall water depth therefore there will have differences when designing the routes to verify the impact of tidal height on ship route designing ship 3 is employed to design routes under different tidal heights and the results are expressed as fig 12 the water depth changes greatly when the different tidal height and the chart water depth are superposed when the safe navigation depth of experimental ship remains unchanged there are certain differences in the forbidden navigation areas generated by the delaunay chart model which makes the designing results different the calculation range of tidal height is from 60 cm to 340 cm the calculation results can be divided into two groups via path trend the range of tidal height of group 1 is between 200 cm and 340 cm add 20 cm each time the range of tide height of group 2 is between 60 cm and 180 cm add 30 cm each time the tangent graph method is used to construct the navigable network undirected graph after environment modeling and the dijkstra algorithm is employed to solve the undirected graph when the tidal height is between 60 cm and 180 cm the ship cannot navigate in the area a and have to navigate pass area b when the tidal height is between 200 cm and 340 cm the water depth of the area a can satisfy the safe navigation depth of the ship 3 the experimental results show that the proposed algorithm has good applicability to the consideration of the tidal height factor and the algorithm can design a safe navigation route for the same ship under different tidal height values 6 3 3 verify the effectiveness of the algorithm to deal with the impact of environment factors on ship navigation to prove that the proposed algorithm can solve the problem of considering environment factors in route designing the area near the huangze island is employed as experimental area two sets of environmental data were designed and set as experimental parameters as shown in fig 13 the wind force in wind field is constant the flow velocity is constant the wave direction and amplitude are constant the differences of environmental data are as follows the wind direction and the flow direction of experiment 3 1 are not fixed the wind direction and the flow direction of experiment 3 2 are fixed two groups of sub experiments were carried out under the environment data of experiment 1 which are as follow 1 implementation of route design algorithm considering environmental factors impact the dijkstra algorithm is employed to solve the undirected graph the result is the route b expressed as fig 14 a 2 implementation of route design algorithm without considering environmental factors impact as a comparative experiment the dijkstra algorithm is employed to solve the undirected graph the result is the route b expressed as fig 14 b the experimental results of experiment 3 1 are obtained the starting point inflection point and end point of the experimental path were retained the original two routes were carried out by route c and route d respectively under the environment of experiment 3 2 as shown in fig 14 b the sailing time and average sailing speed of the two routes were calculated the statistics results of the routes of the two groups of experiments are shown in table 9 the route a and route c the route b and route d have the same route form and the same route length there are great differences in environmental data experiment 3 1 was carried out in a non directional environmental data the ship sailing along the route b was carried out under the condition of following the wind and the current in this experiment following the wind does not mean following the wind completely but the component of wind force and flow direction in the route direction is positive corresponding to route b 66 18 of route a is sailing in adverse wind and current which leads to the fact that although the length of route b is longer than that of route a the time of sailing on route b is relatively less in experiment 3 2 both route c and route d are following the wind and the current and route c is shorter and faster than route d in all aspects experiments show that the proposed algorithm can effectively deal with the changing environment data and can provide the results of route designing based on environmental factors impact for ships 6 3 4 application experiment and analysis to further verify the effectiveness and practicability of the proposed algorithm the proposed algorithm and simple route design algorithm are employed to design the route for a real ship respectively the environment modeling of the simple route design algorithm only relies on the extraction of the land in the chart as an obstacle without considering the water depth the tangent based method is employed to solve the route this simple algorithm is extensively applied in robot route design without considering environmental factors the real time data of collecting ship ais trajectory data is selected for meteorological environment data and the solution results are shown in fig 15 the design result a in the figure is the design result of the proposed algorithm the design result b is the design result of simple algorithm to better reflect the ability of the proposed algorithm in environmental modeling and influencing factors processing a section of ais trajectory data of the ship sailing through the waters between the island a and the island b is selected as the reference the ais trajectory data are shown in table 8 there is a great difference between the two algorithms in the ability to process environmental data according to the fig 15 although a route from the start point to the end point can be obtained by the simple algorithm whether the water depth satisfied the requirements of ship navigation is not considered and the designed route is also close to the boundary of obstacles which will bring great risks to the navigation of the ship p 1 and p 4 are the intersection points of the designed route and obstacles as expressed in fig 15 which verified that the result cannot be put into practical application there is also a big deviation compared with the real ais trajectory the application of part traditional robot route design algorithms is not suitable for the ship route design is verified the proposed algorithm considered the safe water depth and other environmental factors for the navigation the inflection points of the designed route are p 2 and p 3 the depth of which satisfied the requirements of ship navigation by observation compared with the real ais trajectory of the ship navigation p 2 and p 3 are in line with the actual trajectory of the ship which verified the rationality and practicability of the algorithm the reasons for the deviation between the result of the proposed algorithm and the actual ais trajectory are analyzed the algorithm took into account the requirements of navigation depth and the influence of meteorological environment on the route the consideration of safe water depth directly affects the ship s ability to pass through a certain area of water the other meteorological environmental factors are considered in the timeliness and economy of the designed route according to the trend of ais trajectory the deviation from p 3 to the end point is due to the ship needs to make a large range of steering and the reverse steering before steering is carried out in advance the experimental results showed that the algorithm proposed in this paper is reasonable and practical based on the above analysis it reflects a future optimization direction of the algorithm proposed in this paper the route design algorithm needs to consider the smoothness of the trajectory when ship steering the results of the experiments showed that the proposed algorithm has practical application value under certain conditions it can provide a route with advantages in sailing time for ships which is different from the route without considering the environmental factors impact therefore the algorithm proposed in this paper is different from other ship route design algorithms which are dedicated to reducing the distance of navigation it is verified that the current popular robot path planning algorithm cannot be directly applied to the ship route designing 7 conclusion in this paper a novel automatic route design algorithm for intelligent ships based on electronic chart data is proposed the algorithm fully considered the ship navigation safety and influence of environment on ship navigation the advantages of novel algorithm as follows 1 in this paper the chart data is used to create environment model directly which can not only obtain the most accurate navigation environment data but also has a high adaptability under the background of comprehensive popularization of electronic chart 2 when dealing with the influence of environment on ship it is found that there is a complex interdependence among ship s power resistance environmental interference and speed therefore it is impossible to solve the ship speed directly by analytical method with real time data when designing route considering the influence of environment factors impact in this paper the ship parameters are used to make a simulation experiment in advance the ship total resistance speed chart is proposed to solve ship s speed 3 the advantage of the proposed algorithm is that it can solve the problem based on the chart data ship draft hull parameters and environmental parameters the calculation methods of each section of the algorithm are integrated into the algorithm to realize the automatic calculation of the algorithm in the whole process of calculation according to the experimental results the proposed algorithm can automatically provide an economical and safe route for the intelligent ship via the data that the algorithm depends on the proposed automatic route design algorithm provides a practical method for ship route designing of medium and short distance routes especially for the intelligent ships in special circumstances the route is needed to be modified temporarily the proposed algorithm can effectively design a temporary route the algorithm can fully consider both water depth and influence of environment which is the point of causing mistakes in artificial routes designing the proposed algorithm provided a safe and effective route for ship but some limitations appeared after several rounds of experiments in this paper the delaunay triangulation method is employed for environment modeling and the modeling speed still needs to be further optimized the experimental results showed that the smooth degree of the designing results at the inflection point of the route needs to be further considered compared with the ais trajectory in addition the proposed algorithm has a close demand for ship parameters it is essential to optimize the estimation method of ship dynamic resistance before the algorithm is put into practical application to better calculate the influence of environmental factors on ship navigation this paper proposed a novel automatic route design algorithm however its efficiency and application effect still have limitations the algorithm will be further improved in efficiency in the future research process and the calculation of various environmental factors will be further optimized and integrated with the popularization of ships routing and reporting systems the design of intelligent ship automatic route design needs to combine the factor of the ships routing and reporting systems the algorithm of automatic route design for medium and short distance is a branch of ship route design domain it will be the focus of future research to extend the advantages of the proposed algorithm to the route design algorithm of open sea and to complete the organic combination of short distance algorithm and long distance algorithm with the rapid development of maritime intelligent transportation and intelligent ships automatic route design algorithm for intelligent ships considering navigation safety and influence of environment has a wide range of application prospects with the rise of unmanned ships the proposed algorithm provides a new development direction for ship route designing in the case of unmanned operation self identification of navigation environment is of great value in addition the influence of external environment on ship speed needs quantitative analysis and the algorithm proposed in this paper can provide certain research basis in this field credit authorship contribution statement wei pan software conceptualization methodology data curation writing original draft writing review editing visualization xin lian xie conceptualization methodology writing original draft writing review editing supervision project administration funding acquisition ping he formal analysis investigation validation tian tian bao formal analysis investigation validation meng li formal analysis methodology resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the the national key research and development program of china 2017yfc0805309 the fundamental research funds for the central universities 3132019303 and the natural science foundation of zhejiang province lq20g020011 appendix lap and auf m keller chart index map image 5 chart of group a image 6 chart of group b image 7 chart of group c image 8 chart of group d image 9 chart of group e image 10 viscosity coefficient of water and density of water 10th ittc freshwater temperature seawater freshwater temperature seawater 106 ν m2 s ρ kg m3 t c 106 ν m2 s ρ kg m3 106 ν m2 s ρ kg m3 t c 106 ν m2 s ρ kg m3 1 78667 999 82 0 1 82844 1028 07 1 12902 999 04 15 1 18831 1025 91 1 72701 999 82 1 1 76915 1027 97 1 10966 998 94 16 1 15916 1025 71 1 67040 999 92 2 1 71306 1027 87 1 08155 998 74 17 1 13125 1025 42 1 61665 999 92 3 1 65988 1027 87 1 05456 998 55 18 1 10438 1025 22 1 56557 999 92 4 1 60940 1027 77 1 02865 998 35 19 1 07854 1025 03 1 51698 999 92 5 1 56142 1027 68 1 00374 998 16 20 1 05372 1024 73 1 47070 999 92 6 1 51584 1027 48 0 97984 997 96 21 1 02981 1024 44 1 42667 999 82 7 1 47242 1027 38 0 95682 997 76 22 1 00678 1024 15 1 38471 999 82 8 1 43102 1027 19 0 93471 997 47 23 0 98457 1023 85 1 34463 999 73 9 1 39152 1027 09 0 91340 997 27 24 0 96315 1023 56 1 30641 999 63 10 1 35383 1026 89 0 89292 996 98 25 0 94252 1023 26 1 26988 999 53 11 1 31773 1026 69 0 87313 996 78 26 0 92255 1022 97 1 23495 999 43 12 1 28324 1026 60 0 85409 996 49 27 0 90331 1022 67 1 20159 999 33 13 1 25028 1026 30 0 83572 996 20 28 0 88470 1022 28 1 16964 999 14 14 1 21862 1026 11 0 81798 995 90 29 0 86671 1021 98 0 80092 995 61 30 0 84931 1021 69 
20291,collision accidents may lead to significant asset damage and human casualties this paper introduces a direct analysis methodology that makes use of automatic identification system ais data to estimate collision probability and generate scenarios for use in ship damage stability assessment potential collision scenarios are detected from ais data by an avoidance behaviour based collision detection model abcd m and the probability of collision is estimated in various routes pertaining to a specific area of operation damage extents are idealised by the super element se method accounting for the influence of surrounding water in way of contact results are presented for a ro pax ship operating from 2018 to 2019 in the gulf of finland it is confirmed that collision probability is extremely diverse among voyages and the damages obtained correlate well with those adopted by the un imo regulatory instrument solas 2020 it is concluded that the method is by nature sensitive to traffic features in the selected case study area yet it is useful for the evaluation of flooding risk for ships operating in real hydro meteorological conditions keywords big data analytics passenger ships collisions damage stability super element method flooding risk nomenclature roman letters a attained index abcd m avoidance behavior based collision detection model ais automatic identification system b b ref ship width reference ship width bns bayesian networks colregs convention on the international regulations for preventing collisions at sea cvro vessel conflict ranking operator eta event tree analysis fta fault tree analysis hcl hybrid causal logical imo international maritime organization rcos risk control options solas international convention for the safety of life at sea sos system of system un united nations vo velocity obstacle β relative bearing angle c cluster d ship depth tcpa t cpa time to the closest point of approach dcpa d cpa distance to the closest point of approach d p j p j 1 dist ij the distance between the point p j and p j 1 obtained from ais st t r ship trajectory r rot rate of turn flare flooding accident response f the survivability function ind side damage side port side 1 or starboard side 1 k t n m the timestamp l l ref ship length reference ship length lpp length between perpendicular l x longitudinal extent of the damage damage length m l y transversal extent of the damage penetration m p k the probability of occurrence of each individual damage k p 1 p n the departures destinations of ship trajectory p j i a point of ship trajectory t r i at the j t h timestamp t r o w n s h i p t r t a r g e t s h i p ship trajectories of the struck and striking ship when evasive actions are taken t timestamp of ais data p r o p a x k the causation probability involving ro pax ship as struck ship n a k the number of the detected the collision scenarios t t a coefficient to calculate the collision probability or collision frequency per year n r o p a x the number of marine traffic of ro pax ships n a l l s h i p all the number of marine traffic p c k the causation probability of ship collision in gulf of finland a l l t i m e p e r i o d s the time period of traffic observation super element se s k the survivability factor for damage k st t r ship trajectory dr ship draft u 0 striking ship initial surge velocity x 0 impact longitudinal position x c longitudinal position of the centre of the damage m z ul damage vertical position upper limit m z ll damage vertical position lower limit m greek letters α collision angle β relative bearing angle ship displacement λ h scaling factor 1 introduction ships are systems of systems sos operating in complex traffic situations and extreme environmental conditions ship ship collision accidental events may result in devastating consequences such as ship capsizing sinking leading to oil spills and human fatalities the latter is of particular relevance to passenger shipping operations and the mitigation of risks associated with ship damage stability following serious flooding events kim et al 2021 to mitigate risks in real traffic scenarios and environmental conditions it is necessary to develop rapid maritime risk assessment tools to date the evaluation of collision probability of occurrence and associated consequences have been based on historical records of accidents and expert judgment e g huang et al 2020a fan et al 2020 examples of methods used are fault tree analysis fta and event tree analysis eta e g zhang et al 2019 martins and maturana 2010 bayesian networks bns e g kelangath et al 2012 zhang et al 2020a montewka et al 2014 hybrid method by combining fault tree analysis and bayesian networks namely hybrid causal logical hcl e g ramos et al 2020 wang et al 2020 and maritime traffic simulation e g goerlandt and kujala 2014 rawson and brito 2020 jiang et al 2021 these studies illustrate the factors that influence collision risk and may help identify the probability of occurrence of extreme events that may influence ship safety during operations however they do not account for traffic complexity and collision based probabilistic damages in real operations thus they are not reliable in terms of estimating the collision risk level and possible consequences to crew during operations to assess the risk of collision in real conditions it is useful to idealize complex traffic scenarios using automatic identification system ais data methods to evaluate collision probability utilising big data are ship domain e g zhang et al 2015a szlapczynski and szlapczynska 2017 vessel conflict ranking operator cvro e g fang et al 2018 zhang et al 2015b dcpa and tcpa e g lopez santander and lawry 2017 zhao et al 2016 velocity obstacle vo chen et al 2020 du et al 2020a huang and van gelder 2020 collision risk is defined as the consequence of a damage and the probability of occurrence goerlandt and montewka 2014 2015 results from these approaches illustrate the collision risk probability frequency in a specific area but underestimate accidental risk indices i e indices linked to the occurrence of an accident this is because they do not consider collision consequences i e possible damage breach and the damage stability following serious flooding events during real traffic operations to explore collision risk after the potential collision scenarios are detected and in real conditions a rapid direct method is necessary such method could be used to assess both collision probability possible damage distributions and provide a convincing justification for risk control options rcos to date solas 2020 damage stability assessment is based on a probabilistic distributions of damage characteristics that originate from pooled analysis of collision accidents on all types of ships available from accident statistics imo 2018 these damage distributions do not explicitly consider the differences in structural design of each ship and ignore the influence of real traffic situations to assess the consequences of ship ship collision nonlinear structural analysis by finite element analysis methods is essential e g amdahl 1982 wierzbicki and abramowicz 1983 simonsen and ocakli 1999 liu et al 2018 this approach provides accurate results and allows for a refined investigation of the impact process e g le sourne et al 2021 however the models should be sufficiently refined to accurately capture the crushing mechanisms as a result numerical simulations become exceptionally time demanding to overcome these challenges simplified approaches empirical or analytical have been developed e g pedersen 2010 liu et al 2018 kim et al 2021 another idea has been to model vessels with very large size structural units the so called superelements se and to derive closed form analytical formulations of the resistance of each unit buldgen et al 2012 2013 2013 le sourne et al 2021 conti et al 2021 then by combining properly the individual resistances it is possible to rapidly calculate the dimensions of the breach on the struck ship s hull the se method opens the way toward the development of direct assessment methods for the evaluation of ship collision probability as well as collision damage reflecting traffic situations such methods can explicitly consider the influence of the ship structural design on collision damage distributions to be used within the context of damage stability analyses this paper proposes a method that brings together knowledge from big data analytics for the estimation of collision probability and the assessment of ship damage stability following a collision event possibly leading to serious flooding under real operating conditions see section 2 in section 3 a set of realistic collision scenarios are identified via processing ais data for all ships operating in the gulf of finland from 2018 to 2019 then the ship to ro pax ship collision probability is estimated in various routes considering traffic uncertainty and structural crashworthiness is accounted for by fully coupling the external dynamics and the internal mechanics of the struck ship via the se method damage stability analysis focuses for the case of floodstand ship b luhmann 2009 operating in the gulf of finland the description of damage breaches obtained via simulation of real traffic situations differs from those embedded in imo solas imo 2006 in which the damage distributions result from accident statistics mainly related to cargo ships this allows better insight into the nature of collision risk from both probability and consequence perspectives it also provides information to support the decision making of the crew during operations and strengthen ship resilience under off design conditions and throughout ship lifecycle 2 methodology the high level framework for ship to ship collision detection collision probability evaluation and structural damage breach simulation in real operational conditions using ais data is shown in fig 1 detailed discussion on the methodology associated with the collision scenario detection is presented in zhang et al 2021 the collision risk estimation process fig 1 comprises three steps step i where ship trajectories sts are reconstructed using ais data that contain static voyage and dynamic navigation details the process is used to cluster ship trajectories of the struck ships by using k means for static voyage clustering and db scan for dynamic navigation features clustering step ii cluster collision scenarios are identified using the proposed avoidance behaviour based collision detection model abcd m the collision probability is estimated with the focus on the ship to ro pax ship collision step iii for each collision scenarios collision breaches are evaluated using the struck ship sharp model in the method presented potential collision scenarios evasive actions and crash scenarios are defined as follows potential collision scenario is a critical situation that triggers the ship to take evasive action when a collision accident may occur if no evasive action is taken evasive action is an operational routine that encompasses changes in speed course or their combination should be carried to avoid collision event crash scenario is a critical situation which reflects the eventuality of a potential collision event when the evasive action is underestimated in a crash scenario the parameters for crash analysis are defined based on ais data describing the navigation patterns of the ships involved i e striking ship type striking ship initial surge velocity etc based on the above collision damages and flooding risk are illustrated and quantified in real conditions 2 1 step i clustering of ship trajectories to estimate ship collision probability in various routes the ship trajectories should be clustered by similarity measurements at first this section demonstrates the use of methods for ship trajectories clustering using ais traffic data 2 1 1 ais traffic data the automatic identification system ais is an automatic tracking system that uses transceivers on ships and is used by vessel traffic services vts use of the ais systems has been required by the international maritime organization imo since december 31 2004 the regulation requires ais to be fitted aboard all ships of 300 gross tonnage and upwards engaged on international voyages cargo ships of 500 gross tonnage and upwards not engaged on international voyages and all passenger ships irrespective of size automatic tracking systems may be used to identify and locate ships through data exchange with nearby ships ais base stations and satellites ais big data streams contain multiple parameters related to static voyage features e g departures destinations voyage length and dynamic navigation features e g speed course motion parameter variation and ship trajectory spatial distance availability of ais data is of course critical factor fig 2 and table 1 in an ais data stream trajectory paths are defined as follows 1 t r i p 1 i p 2 i p 3 i p j i p n i 1 j n 2 for p j i i m o m m s i t j l o n l a t s o g c o g r o t h s s l w d where i stands for a trajectory number j is the number of timestamp of ship trajectory t r i also is the number of point of ship trajectory t r i t j is the j t h timestamp p j i denotes a point of ship trajectory t r i in multi dimension space that contains imo number mmsi of the ship timestamp geographical position speed course heading ship type ship length ship width and draft n is the total number of the points in the trajectories t r i and p 1 i p n i represent ship departure and destination points of ship trajectory t r i 2 1 2 ship trajectories clustering methods ships navigating in various routes will encounter complex traffic to explore collision probability ship trajectories should be clustered based on similarity measurements accounting for static voyage features e g departures destinations voyage length and dynamic navigation features e g speed course motion parameter variation and ship trajectory spatial distance see appendix b although imo number call signs can be used as labels to separate ship trajectories sts of various ships existing methods do not offer automatic means for ship trajectories clustering in various voyages this is because it is difficult to derive available labels to fully explore both static and dynamic navigation features of sts in complex traffic scenarios thus when using information directly from historical ais data i e mmsi imo number call signs ship voyages cannot be separated automatically big data clustering may be useful in terms of grouping sts by measuring the similarity between available data streams rong et al 2020 in this work k means and db scan are selected and employed to cluster sts see appendix a k means algorithm is a distance partition method e g see zhen et al 2017 zhang et al 2020a cai et al 2020 used to evaluate static voyage features density based spatial clustering of applications with noise db scan is a density based clustering non parametric algorithm e g see zhao et al 2017 rong et al 2020 used for clustering dynamic navigation features the method comprises of three steps namely a re construction of sts b grouping of static data by k means and c clustering of dynamic data by db scan fig 3 demonstrates an example of the st clustering process for one ship with 6 sts voyages sailing in a given area st1 is opposite to st2 and likewise st3 4 are opposite to st5 6 despite the fact that st3 4 describe trajectories of ships navigating between the same departure and destination points they are different similarly st 5 6 head in the same direction however ships on st5 are faster than those on st6 separation of the sts and exploration of the collision risk is achieved as follows k means algorithm is used to classify sts into 4 clusters using static voyage features departure destination voyage length in this way st1 st2 st3 4 and st5 6 are split in different clusters db scan algorithm is employed to re cluster results using dynamic navigation data ship speed course motion parameter variation and trajectory spatial distance in this way st3 and st4 st5 and st6 are split in different sub clusters 2 2 step ii collision detection and probability estimation this section demonstrates the use of methods for potential collision scenarios detection and collision probability estimation for the clustered ship trajectories of ro pax ships outlined in section 2 1 2 2 1 ship to ro pax ship collision scenarios detection the model developed to detect potential collision scenarios using ais traffic data in real operational conditions is shown in fig 4 ship evasive actions take place when ship manoeuvres result in motion changes in fig 4 ship trajectories t r i and t r i γ relate to struck own ship and striking ship target ship a struck ship may encounter the target ship over four stages shown on the top of fig 4 namely a unconstrained navigation b encounter c collision avoidance d clearance during stages a and d there is no collision likelihood between the two ships because there are no ships within 6 nm radius or ship trajectories diverge at stage b when the rate of change of bearing angle δ β relative to struck ship falls within 2 00 to 2 00 0 a collision accident may occur if no evasive action is taken as the distance between ships keeps shrinking the rate of change of bearing angle δ β exceeds the range of 2 00 to 2 00 0 thus indicating that the give way ship changes her course to avoid collision stage c at the collision avoidance stage c the minimum distance between striking and struck ships is below 3 nm the minimum dcpa is below 1 nm and the minimum tcpa is located within 0 30 mins the endpoint of the collision avoidance stage is defined as the point where tcpa becomes 0 if tcpa is below 0 there is no collision risk stage stage d the collision detection method comprises part a where we determine the minimum distance between two ship trajectories this requires that ship trajectories of potential striking ships keep clear of the struck ship to ensure no encounter or collision the minimum ship distance d min is defined at timestamp t j n corresponding to ship trajectories t r i j j m t r i γ j j m where t j t j m denotes the timestamp interval of the two series part b during which ship encounters are determined based on ship course bearing angles tcpa dcpa rate of turn rot and the difference between the headings fig 4 part c where we classify collision scenarios as per colregs zhang et al 2021 an encounter stage defined during the time interval t j t j m threshold conditions of dcpa tcpa distance δ β 2 00 to 2 00 within the observation time of 6 nm are dist 6 nm goerlandt and montewka 2014 d m i n p j n t s 3 nm du et al 2020b δ β 2 2 at the time interval t j t j t montewka et al 2010 min d c p a p j t j t 1 t s 1 nm during collision avoidance stage and for the time interval t j t t j t 1 langard et al 2015 0 min t c p a p j t j t 1 t s 30 mins during collision avoidance stage and for the time interval t j t t j t 1 langard et al 2015 t c p a p j n 1 t s 0 mins at clearance stage wang et al 2013 to analyse the collision avoidance behaviours the ship trajectories t r t a r g e t s h i p and t r o w n s h i p during evasive action were defined as follows 3 t r t a r g e t s h i p p j t t s p j t 1 t s p j t 2 t s p j n t s 4 t r o w n s h i p p j t o s p j t 1 o s p j t 2 o s p j n o s 2 2 2 ship to ro pax ship collision probability estimation the objective of collision risk analysis is to find out what might happen how probable it is and what are the consequences in the research domain of probabilistic risk analysis pra and probabilistic safety analysis psa collision risk entails the product between the probability of the unexpected event and the consequences if it occurred the collision probability is often defined as the probability of the number of collisions per year or the number of years per accident collision scenarios are determined according to the international regulations for the prevention of collisions at sea colregs convention johansen et al 2016 the analysis accounts for the relative speed position heading bearing angle and course of ships see fig 5 the probability of a collision between two ships is estimated according to fujii and macduff model fujii and shiobara 1971 macduff 1974 gil et al 2020 as 5 f k 1 3 n a k p c k where n a k is the geometrical probability or the probability of being on a collision course for three encounter types crossing overtaking and head on p c k is the causation probability or the probability of failing to avoid the accident while being on a collision the causation probability can be estimated on the basis of different scenarios or by the so called synthesis approach the former is sensitive to available accident data e g pedersen 2002 this is the reason why most methods use the synthesis approach according to this method probability of error is found by application of a bbns e g kelangath et al 2012 martins and maturana 2013 or by the use of fault tree analysis e g zhang et al 2019 as shown in table 2 in the gulf of finland the causation probability was studied using the synthesis approach by kujala et al 2009 goerlandt and kujala 2011 and montewka et al 2014 the results indicate that a causation probability of 1 3 10 4 for crossing ships and 4 9 10 5 for head on and overtaken is derived 2 3 step iii sharp modelling of collision scenarios the estimation of potential collision scenarios assumed that the evasive action is underestimated by making ships fall into the eventualities a collision accident happens along the route this is used to determine the collision parameters based on the ais information of the ships involved this section demonstrates the methodology developed to determine collision parameters and crash analysis using sharp besnard and buannic 2014 2 3 1 collision scenarios analysis a ship ship encounter comprises four stages namely a unconstrained navigation b encounter c collision avoidance d clearance in such scenarios an accident would occur if no evasive manoeuvres were made based on ais data streams the mass can be roughly inferred from the ship size and ship specification which may be related to the consequences of a collision montewka et al 2014 as shown in fig 6 the collision and possible relative striking positions are classified as a front side b head head c frontal d front side e rear end consequently the anticipated relative collision location along a ship hull can be estimated for use in crashworthiness analysis 2 3 2 collision crash analysis using the se method the se method is used to model the ship into very large sized structural units the so called super elements for which closed form analytical formulations have been derived see e g amdahl 1982 wierzbicki and abramowicz 1983 or simonsen and ocakli 1999 these formulations based on plastic limit analysis and experimental data characterise the resistance energy dissipation of the se depending on its type and deformation mechanism as the impacting vessel is moving forward into the struck structure the super elements are successively activated and their contribution to the total collision force is evaluated the force f leading to the collapse of a given structural component is obtained by the so called upper bound theorem jones 1989 6 f δ v σ i j ε i j d v where δ is the striking ship surge velocity σ i j is the stress tensor of the component ε i j is the strain rate tensor of the component v is the component volume to derive the force f analytically the following assumptions are made the constitutive material is assumed to be perfectly rigid plastic shear effects near the plate edges are neglected so that the total internal energy rate is obtained by summing the contribution of bending and membrane effects which are assumed to be completely uncoupled for example for a plate in a plane stress state assuming that bending effects are confined inside m plastic hinges the bending e b and membrane energy rates e m can be calculated by using the following two expressions 7 e b m 0 k 1 m θ k l k 8 e m 2 σ 0 t p 3 a ε 11 2 ε 22 2 ε 12 2 ε 11 ε 22 d a where m 0 is the fully plastic bending moment σ 0 is the flow stress a and t p are respectively the area and the thickness of the plate θ k and l k are the rotation and the length of the hinge number k the se method is implemented in the software sharp as illustrated in figs 7 and 4 types of super elements allow to model the struck ship hull and longitudinal bulkheads vertical frames and transverse bulkheads secondary stiffeners stringers decks and bottom within sharp the resistance of each se has been derived by buldgen et al 2012 2013 for ship oblique collisions then by combining the individual resistances it is possible to obtain a global evaluation of the ability of both the striking and struck ships to withstand a collision event the sharp internal mechanic s solver has been coupled by le sourne 2007 with an external dynamics program named mcol able to idealize global ship motions taking into account the forces exerted by the surrounding water the first version of mcol was developed and included in ls dyna fea software by mitsubishi lstc 2018 the current version has been entirely rewritten to take into account large rotational movements driven by the crushing force and hydrodynamic forces water added mass wave radiation damping and restoring forces and to introduce drag damping effects ferry et al 2002 implemented in ls dyna in 2001 this new version was used to simulate the large rotational movement of submarines impacted by surface ships le sourne et al 2001 and to study surface ship collisions le sourne et al 2003 some practical applications of sharp mcol tool can be found in le sourne et al 2012 and paboeuf et al 2015 2016 to consolidate the reliability of this approach a benchmark study has been recently carried out in which sharp mcol calculations have been compared to finite element results le sourne et al 2021 in sharp a collision scenario such as the one presented in fig 8 is defined by the following parameters striking ship type striking ship initial surge velocity struck ship initial surge velocity impact longitudinal position collision angle striking ship draft struck ship draft after solving the collision problem sharp provides an estimate of the damage bounding box based on the computed penetration as well as the shape of the striking ship s bow 3 case study in this section considering all large roro passenger ships ro pax 46 124 gt gross tonnage 10 000 gt 218 8 m length 120 m as struck ships a case study is carried out by using ais data covering a 13 month ice free period year 2018 and 2019 in the gulf of finland see fig 9 the types of ships operating in the gulf of finland during this period are shown in fig 10 notably 9 8 of the sts involve ro pax ships 3 1 collision scenarios modelling in this section ship trajectories of ro pax ships in the gulf of finland are clustered and probabilities are estimated in various routes the results are validated using historical collision accidents 3 1 1 ship trajectories clustering to analyse the ship to ro pax ship collision risk in various voyages the k means algorithm and db scan were used to cluster voyage details of ship trajectories of potential struck ships ro pax ships according to the sts clustering procedure outlined in fig 3 the sts of ro pax ships were extracted from ais database the 12 214 ship voyages of struck ships were divided into 17 clusters 16 complete clusters and 1 incomplete cluster see fig 11 3 1 2 potential collision detection for each cluster for each of the clusters outlined in fig 11 potential collision scenarios were identified fig 12 demonstrates the locations of ro pax ships during a 13 months ice free period the year 2018 2019 it was found that 50 of the potential collisions occur in cluster 13 i e after leaving the port of tallinn and towards helsinki the probability of potential collisions per journey was calculated as 9 f i n potential n ship trajectorie s i i 1 2 3 16 fig 13 shows that the number of potential collisions per journey is at its highest in cluster 11 3 03 potential collisions per journey this indicates that collision risk estimates may be extremely diverse among voyages clusters 6 and 13 are located in the same route however the voyage is reversed between helsinki and tallinn in cluster 6 0 25 potential collisions per journey or one potential collision per 4 0 ro pax journeys occur however 1 13 potential collisions per journey in cluster 13 are 4 52 times that those observed in cluster 6 3 1 3 probability of collision to estimate ship to ro pax ship probability of collision scenarios n a and causation probability p c k should be taken under consideration along the lines of the method presented in section 2 2 9240 potential collision scenarios crossing 6213 overtaking 125 head on 2902 were detected see fig 12 consequently p c k could be evaluated for all ship types using the synthesis approach of section 2 3 if we assumed tss traffic separation scheme for all ship types the causation probability for head on collisions p c h and overtaking cases p c o could be 4 9 10 5 leading to p c c 1 3 10 4 however the aim of this study has been to evaluate ship to ro pax ship collision only during a 13 month ice free period thus the evaluation of causation probabilities considered the following factors the ratio of ro pax ships to the number of other ships navigating in the gof is 0 098 see figs 9 and 10 so the causation probability p s h i p r o p a x k between ship and ro pax ship equals to 9 8 p c k if we assume 50 chances to scenarios idealising a ro pax ship as a struck or striking ship montewka et al 2014 the causation probabilities p r o p a x k involving ro pax ship as struck ship are 9 8 0 5 p c k to evaluate the collision probability or frequency per year 12 months a calibration coefficient t t should be considered accordingly collision probability involving ro pax as struck ship was estimated by equation 10 12 10 p p r o p a x k n a k t t 11 p r o p a x k n r o p a x n a l l s h i p 0 5 12 t t 12 a l l t i m e p e r i o d s where p r o p a x k denotes the causation probabilities involving ro pax ship as struck ship n a k represents the number of the detected the collision scenarios t t denotes a coefficient to calculate the collision probability or collision frequency per year n r o p a x denotes the number of marine traffic of ro pax ships n a l l s h i p denotes all the number of marine traffic p c k denotes the causation probability of ship collision in gulf of finland a l l t i m e p e r i o d s denotes the time period of traffic observation accordingly 13 p c o l r o p a x h 9 8 0 5 4 9 10 5 2902 12 13 6 43 10 3 p c o l r o p a x o 9 8 0 5 4 9 10 5 125 12 13 2 70 10 4 p c o l r o p a x c 9 8 0 5 1 3 10 4 6213 12 13 3 65 10 2 thus the model gave 4 32 10 2 accidents per year or a collision per 23 1 years including 2 70 10 3 for overtaking 6 43 10 4 accidents per year for heading on and 3 65 10 2 accidents per year for crossing encounter type this observation leads to the conclusion that potential scenarios can be evaluated focusing on various clusters voyages in more detail the conditional probability is evaluated according to 14 p i n potential n total potential collisions p c o l r o p a x o p c o l r o p a x h p c o l r o p a x c i 1 2 3 16 the probability of collision was estimated for 16 clusters see fig 13 this resulted in 0 021 accidents per year for cluster 13 see table 3 to validate the results of probability estimates historical collision accidents in the gulf of finland were reviewed see fig 14 based on the casualty reports of fma bmepc and helcom over 21 years only one ro pax ship accident took place during ice free period this corresponds to 4 76 10 2 accidents per year this value is in good agreement with the results of collision probability estimation 4 32 10 2 accidents per year 3 2 damage breach simulation this section runs all the potential collision scenarios identified on the reference ship as struck ship using the crash analysis software sharp 3 2 1 description of collision scenarios results confirm that if a struck ship s course falls into the detected potential collision scenarios eventualities outlined in section 2 2 action should be taken to avoid the collision fig 15 demonstrates the manoeuvres of the give way ship along a red track with the aim to avoid collision accident give way ships may ignore evasive actions along the initial trajectory and in turn this may result in damages following a collision event if the evasive action is underestimated for each of the potential collision scenarios detected in section 3 1 2 ships may fall into eventualities and the collision accident will happen along the original routine for the case study presented in this paper potential collisions during evasive actions were accounted for see p j t t s on fig 15 and the motion features of involved ships were used to feed in crash analysis in doing so possible collision consequences were used to support risk mitigation in advance the results outlined may strengthen ship resilience under off design conditions and throughout the lifecycle after collision scenarios detections fig 13 shows that the 9240 potential collision scenarios are detected using the proposed abcd model covering a 13 month ice free period year 2018 and midterm 2019 in the gulf of finland among them 9012 potential collision scenarios are determined into 16 clusters according to the results of sts clustering in this section 3491 potential collision scenarios among them during year 2019 periods of the selected large ro pax ships 46 124 gt gross tonnage 10 000 gt 218 8 m length 120 m as struck ship were used to feed in real complex data in the direct approach the objective of the direct approach is to obtain a probabilistic description of the damage breach for a specific ship in specific operational conditions within the current solas framework imo 2018 the underlying damage distributions correspond to the distributions of damage knowing that a breach had occurred following a collision event therefore the collision probabilities identified in table 3 do not need to be considered as such instead the relevant information to be used for crash analysis relates to the parameters defining each potential collision assuming that this collision happened given the way the potential scenarios are obtained they are assumed to be equiprobable i e p 1 n c from ais data analysis the following data was made available for the description of each collision scenario the probability of the event assumed to be equal to 1 n c the length and width of the striking ship the surge velocity and draft of the struck and striking ships the displacement of the striking ships the collision angle the type of collision head on overtaking crossing and the type of striking ships group 1 tankers group 2 passenger ships group 3 bulk carriers group 4 container ships group 5 general cargo ships group 6 other ships such as tug boats trawlers research vessels see table 4 from sharp analysis the outcome of a low energy collision event with such small striking ships will be a low penetration however it is difficult to estimate with accuracy if this low penetration corresponds to a hull breach rather than a dent i e no breach in the hull furthermore type of minor collisions with small ships and no hull breach are believed to be under reported in damage statistics therefore filtering has been applied and all the striking ships with lengths lower than 50 m have been removed 90 of which are l 33 m b 10 m displacement 850 tons the data has been further filtered by excluding head on and overtaking scenarios thus keeping crossing collision scenarios after filtering 2124 collision scenarios remained available for crash analysis the distributions of striking ship type length width speed and displacement obtained after filtering are shown in fig 16 and fig 17 in fig 18 the distributions of initial surge velocities for struck and striking ship are plotted regarding the distribution of the struck ship surge velocity at the onset of the collision event it is observed to be significantly different than the one considered by lützen 2001 based on collision accidents statistics indeed it assumed a triangular decreasing distribution with a most likely value equal to zero speed whereas the present distribution entails a large majority of collision scenarios with struck ship having an initial surge velocity between 14 and 25 knots in this work lützen 2001 regarding the distribution of the striking ships surge velocity at the onset of the collision event three peaks emerge at approximately 10 knots 17 knots 22 knots also it can be observed that the scenarios corresponding to the collision at high striking ship velocity correspond to group 2 striking ships passengers ships see blue bars on the right of fig 18 3 2 2 sharp modelling based on the detected collision scenarios realistic striking ship models are to be built in the definition of all the potential collision scenarios the striking ships are defined based on their length width type displacement and draft however when it comes to striking ship modelling in sharp the actual bow shape as well as hydrodynamic properties shall be defined in order to build realistic striking ship models in sharp the already built models from the sharp striking ships database see fig 19 and table 5 are reused and scaled according to the required striking ship properties for each potential collision scenario accordingly for each striking ship to be modelled the reference ship with the closest properties was selected and an average scaling factor was defined as per equation 15 in order to check that the striking ships to be modelled can satisfactorily be defined using the above approach based on homothetic scaling the real length and breadth ratios l l ref and b b ref have been compared with the averaged ratio λ h in average for all the modelled striking ships the difference is about 10 which is deemed acceptable an example of scaled bow shape of striking ship is shown in fig 20 since the striking ships scantling is not known the striking ships have been considered to be structurally rigid during the collision which provides a conservative estimate of the computed damages on the struck ship since no energy can be absorbed by deformation of the striking ship s bow 15 λ h 1 2 l l ref b b ref where l b length and breadth of the striking ship to be modelled by scaling l ref b ref length and breadth of the reference ship the reference ship design was then scaled to the striking ship to be modelled both in terms of geometrical bow shape and in terms of hydrodynamic properties the scaling factor is used as length scale for froude scaling in this case regarding the definition of the hydrodynamic properties of the striking ships to be modelled it appeared from multiple testing with sharp mcol that for the striking ship the inertia matrix is by far the most influential hydrodynamic parameter on the outcome of the collision analysis based on the known length breadth and displacement of the striking ship as well as the use of some correlations providing the ship gyration radii the inertia matrix can be completely defined with no need for scaling from a reference ship as equation 16 16 m 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 r x x ² 0 0 0 0 0 0 r y y ² 0 0 0 0 0 0 r y y ² where striking ship displacement r x x 0 35 b striking ship gyration radius in roll r y y 0 25 l striking ship gyration radius in pitch r z z 0 25 l striking ship gyration radius in yaw the remaining hydrodynamic properties to be defined in mcol position of centre of gravity and centre of buoyancy added inertia matrix stiffness matrix and damping matrixes are specified by scaling of the hydrodynamic properties of the reference ship attached to the striking ship to be modelled since multiple physical units are involved froude scaling laws are used considering λ h as the length scale each potential collision scenario has been modelled based on struck and striking ships initial surge velocities drafts and collision angle to idealize the longitudinal position of the impact a section of 100 m length representing the parallel ship body was modelled in sharp and the longitudinal impact position was defined randomly according to a uniform law over a reduced 32 m length such approach yields a conservative estimate of the damage as little energy can be dissipated through the yaw motion of the struck ship 3 2 3 sharp struck ship modelling for the case study all the calculations have been carried out considering a struck ship with the main particulars of table 6 the super elements structural description has been modelled for 100 m long centred on the mid ship section se have been defined for side shell decks transverse bulkheads and longitudinal bulkheads in order to keep a workable model for intensive computations decks were modelled as continuous i e no holes with a homogeneous thickness floors girders within the double bottom were not modelled and secondary rooms were omitted all materials have been modelled as rigid perfectly plastic with s 235 mild steel properties see table 7 in the se approach the membrane strain is calculated for the impacted se subjected to membrane tension e g side shell longitudinal bulkheads and compared to the material failure strain the value of 10 was initially proposed for mild steel by lützen 2001 regarding the se representing decks and bulkheads they are supposed to deform first by concertina splitting then by tearing along the edges for these se normal and tangential components of the resistant forces are calculated at element edges and compared to empirical threshold values determined from weld beads thickness and length expressions of the threshold forces are given in sharp user s manual besnard and buannic 2014 the sharp se model of the struck ship is illustrated in fig 21 her hydrodynamic properties inertia added inertia restoring and damping matrixes as required by mcol have been obtained using bv hydrostar 2019 in infinite water depth with no forward speed the input data considered for the hydrodynamic calculations are summarised in table 8 3 2 4 damage breach characterisation before presenting the damages obtained from crash analysis the framework for damage characterisation shall be defined geometrically collision type damage breach is represented as a box with two faces parallel to the waterplane two faces parallel to the ship transversal plane and two faces following the hull longitudinal shape at the waterline furthermore the damage box crosses the waterline as well as one side of the ship in the general case the damage is modelled using the following 6 geometrical parameters ind side x c l x l y z ul z ll see fig 22 in solas framework imo 2006 the damage lower vertical limit z ll is not considered as a random variable instead a worst case approach is used for the computation of the s factor in case of horizontal subdivision below the waterline as an extension of the solas framework bulian et al 2019a introduced a probabilistic description of this variable the present paper considers this extended framework with a probabilistic description of the damage parameter z ll 3 3 crash simulation results in this section the results of crash simulation from the case study are presented an a index is applied to assess the impact of damage breaches obtained from direct simulations 3 3 1 simulated damage breaches after simulating the detected collision scenarios in section 3 2 data filtering has been applied before deriving damage distributions indeed it was observed that for more than 30 of the scenarios the damage vertical position lower limit is above the waterline this is typically due to scenarios with collision angles close to 0 or 180 with limited penetration to maintain relevancy with the framework defined by solas imo 2006 and extension by bulian et al 2019a regarding the damage vertical limits the scenarios leading to these damages were discarded after filtering 1284 damages were made available for post processing and analysis 3 3 2 a index calculation example to assess the impact of damage breaches obtained from direct simulations damage stability analysis was carried out using the non zonal monte carlo method for the design draft condition this method allows the calculation of the a index based on each of the individual simulated damages i e 1 damage for monte carlo analysis corresponds to 1 crash analysis result keeping all the potential correlation between the damage parameters the use of this non zonal framework has been for instance described by bulian et al 2016 bulian et al 2019b krüger and dankowski 2019 for a given ship draft the calculation of the damage stability attained index using non zonal monte carlo method relies on the generation of a list of n individual breaches ind side x c l x l y z ul z ll k 1 k n sampled according to the desired probabilistic distributions using for instance inverse transform sampling from the cumulative distribution functions generation of damages corresponding to the rooms broken by the breaches the calculation using dedicated software of the survivability factor s k associated to each individual sampled damage mathematically the calculation of the partial attained index a for a given draft on the reference ship can be written as 17 a k 1 n p k s k 18 s k f ind side x c l x l y z ul z ll k where p k 1 n is the probability of occurrence of each individual damage s k is the survivability factor associated to an individual damage f is the survivability function computed by damage stability software for the damage stability analysis two calculations have been performed using napa software in these calculations the s factor from solas imo 2018 was used to measure the survivability of each damage a reference calculation considering damages sampled from solas underlying distributions extended by bulian et al 2019a probabilistic description of the damage vertical lower limit a calculation for which each damage directly results from the crash analyses in this case the longitudinal position of the damage centre has been resampled assuming this random variable to be uniformly distributed along the ship length in accordance with solas underlying assumption 4 discussion this paper proposes a method that brings together knowledge from big data analytics for the estimation of the ship ship collision detection and scenario analysis with structural damage simulations using the se method the results and findings from the case study are concluded together with discussions ro pax ship collision scenarios were detected in various routes using ais data the number of occurrences of potential collisions per voyage during the period that is collision frequency collision probability was calculated fig 13 and table 3 this has shown that the voyage may be the key influential factor contributing to collision risk which is ignored in the traditional models therefore it may be pointed out that the proposed collision risk analysis model can determine the effectiveness of the navigational safety strategy in more detail when it is further embedded with ship traffic in various routes which could be a possible strategy to enhance navigational safety in the gulf of finland ro pax ship collision probability was evaluated by the abcd m model see table 3 for the purposes of validating results accident statistics from various previous studies were considered see table 10 the collision probability obtained from the abcd m model was close to those presented by otto et al 2002 however the ship to ro pax ship collision probability value delivered by the study is a bit higher than the one obtained by montewka et al 2014 differences against the results of goerlandt and kujala 2011 could be attributed to the fact that their study evaluate the collision probability based on all ship types whereas the present study considered only ro pax ship collision figs 23 24 illustrate damages simulated from crash analyses both in terms of scatter plots and distributions collision scenarios and damages were obtained by simulation rather than real damages from collision accidents the damages obtained using the simulation method introduced in this paper show distributions that are globally relevant with solas even if more severe notwithstanding this contrary to solas distributions the simulated damage distributions are generally not strictly decreasing this could be explained by the fact that the collision scenarios include a significant part of group 2 striking ships passenger ships which lead to severe damages due to high kinetic energy the distribution of damage vertical position lower limit somewhat differs from the description proposed by bulian et al 2019a based on analysis of accident statistics this is due to a large proportion of group 2 striking ships see section 3 2 1 in table 4 which entail severe damages down to the bottom of the struck ship in table 9 the partial a index obtained from the directly simulated damage breaches is compared with the one obtained considering damage distributions from accident statistics it is seen that the a index resulting from simulated damages is significantly lower than the partial a index computed with conventional damages from accident statistics such a decrease of the a index was expected since the damage distributions obtained by direct simulations are more severe than the ones processed from accident statistics see figs 24 and 25 this difference may be attributed to the severity of the collision scenarios considered i e half of the potential striking ships considered were passenger ships sailing at full speed thus leading to high energy collisions 5 conclusions this paper proposed a big data analytics framework for ship to ship collision detection collision scenario analysis damage breach simulation and damage stability assessment reflecting the influence of traffic complexity in real hydrometeorological conditions a method for modelling collision scenarios using avoidance behaviour based collision detection model abcd m followed by collision probability evaluation and crash analysis using the se method sharp software has been developed and tested for the case study presented it is confirmed that collision probability is extremely diverse among voyages as this is ignored by traditional models it may be concluded that safety in navigation practice and standards would benefit from the method proposed it is assumed that evasive actions are underestimated ship damage distributions are then evaluated the results outlined may present important support for risk mitigation in advance during shipping the a indices obtained from the proposed method appear to be more conservative compared to those obtained when using solas 2020 this could be attributed to the collision scenario distribution used is for a specific area i e the fact that the damage breaches originate from simulations of ro pax ships in gulf of finland this is different compared to current solas regulations that are based on global statistics of historical accidents involving mainly cargo ships the interpretation of damage stability results should be treated with care because the method presented is purely based on damage breach simulations that reflect traffic situations in a specific area since the proposed method is by nature sensitive to traffic patterns and hydrometeorological conditions it would better suit the evaluation of flooding risk under ship and operation specific scenarios this logic is aligned with that of the safety case used by the offshore industry future research could focus more on the estimation of ship collision damage and flooding risk by integrating some manoeuvre based prediction techniques into the proposed approach gil et al 2019 2020a b in addition it would be insightful to explore the global ship collision damage and flooding risk of multiple ship types to assist surveillance operators in improving their cognitive abilities in dangerous traffic situations the principles of the method proposed could be suitably adapted for the direct assessment of grounding events zhang et al 2020b or for the development of decision management systems for use in remote operations of autonomous ships janne lahtinen et al 2020 banda et al 2021 credit authorship contribution statement mingyang zhang methodology software investigation data curation writing original draft fabien conti methodology validation investigation data curation writing review editing hervé le sourne methodology software writing review editing dracos vassalos writing review editing funding acquisition pentti kujala writing review editing funding acquisition daniel lindroth validation data curation validation writing review editing spyros hirdaris conceptualization methodology writing review editing supervision funding acquisition project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the research presented in this paper has received funding from european union project flooding accident response flare number 814753 under h2020 program the authors express their gratitude for this support the views set out in this paper are those of the authors and do not necessarily reflect the views of their respective organisations appendix a the ship trajectories clustering methods k means algorithm k means is a clustering algorithm based on euclidean distances that is easy to understand implement and can handle large datasets however the k means clustering test shows that if it considers more than three parameters for sts clustering the performance is not worked well this is because the k means algorithm is difficult to handle both static voyage features and dynamic navigation features of complex ship trajectories thus to explore the difference of ship trajectories in more detail dynamic navigation features of sts are mined after k means clustering for db scan clustering table 11 k means algorithm for sts clustering table 11 db scan algorithm in contrast to the k means method that applies to static points datasets db scan is an algorithm that helps to form data clusters based on regular and irregular dense data as presented in table 11 but db scan algorithms may not work well with static voyage features distance points datasets of sts this is the reason why the both k means algorithm and db scan algorithm are used to cluster sts in the paper table 12 db scan algorithm for sts clustering table 12 appendix b ship trajectories similarity measurement 1 for voyage features the similarity parameter s d d p denotes the similarity of sts between the same departure destination points as equation b 1 b 1 s d d p d i s t p 1 i l o n 1 l a t 1 p 1 i j l o n 1 l a t 1 d i s t p n i l o n n l a t n p n i j l o n n l a t n the similarity parameter s d d s t denotes the similarity set that uses the sum of distances of the same departure and destination points t r i and t r i y as equation b 2 b 2 s d d s t t r i t r i y d i s t l o n 1 i l a t 1 i l o n 1 i y l a t 1 i y d i s t l o n n i l a t n i l o n n i y l a t n i y where l o n 1 l a t 1 and l o n n l a t n denote locations of the departure and destination points respectively s d d p is a set including the distance between ship departure p 1 i p 1 i y and destination points p n i p n i y n is the number of the waypoints of the st i voyage length is defined as equation b 3 b 3 d p j p j 1 d i s t l o n j l a t j l o n j 1 l a t j 1 b 4 t l e n g t h j 1 n 1 d p j p j 1 the similarity parameter s l denotes the difference in the voyage length of different sts defined by equations b 3 and b 4 b 5 s l t r i t r i y t l e n g t h i t l e n g t h i y consequently similarity parameter s l and similarity parameters s d d p and s d d s t are used to represent the similarity of sts for k mean clustering 2 for navigation features to explore the difference of ship trajectories in more detail dynamic navigation features of sts are mined after k means clustering for db scan clustering sog speed over ground cog course over ground and variations of those e g average value median value and variance are considered for ship trajectories similarity measurement the similarity parameters s s o g s c o g and s m p v t r i t r i y are defined as b 6 s c o g t r i t r i y c o g m e a n i c o g m e a n i y b 7 s s o g t r i t r i y s o g m e a n i s o g m e a n i y b 8 s m p v t r i t r i y s o g i n t e r a l i s o g i n t e r a l i y s o g s t d i s o g s t d i y c o g i n t e r a l i c o g i n t e r a l i y c o g s t d i c o g s t d i y where the s o g m e a n and s o g m e d i a n denote the average and median values of sog respectively the c o g m e a n and c o g m e d i a n denote the average and median values of cog respectively the s o g i n t e r v a l s o g s t d c o g i n t e r v a l and c o g s t d represent variable interval and standard deviation of sog and cog t r i and t r i y denote different sts 3 for spatial distance features of sts the spatial similarity parameter of two different sts is defined as equation b 9 calculated using the hausdorff distance algorithm kumar et al 2020 by equation b 10 and b 11 b 9 s h max h t r i t r i y h t r i y t r i b 10 h t r i t r i y max p j i t r i min p j i y t r i y d p j i p j i y b 11 h t r i y t r i max p j i y t r i y min p j i t r i d p j i y p j i where h t r i t r i y denotes the hausdorff distance of trajectory t r i to t r i y and the h t r i y t r i denotes the hausdorff distance of st t r i y and t r i s h is the spatial similarity parameter of different sts see fig b 1 fig b1 illustration of the hausdorff distance algorithm for the spatial similarity calculation of sts zhang et al 2021 fig b1 the similarity of voyage features navigation features and spatial distance of trajectories are measured for dbscan clustering 
20291,collision accidents may lead to significant asset damage and human casualties this paper introduces a direct analysis methodology that makes use of automatic identification system ais data to estimate collision probability and generate scenarios for use in ship damage stability assessment potential collision scenarios are detected from ais data by an avoidance behaviour based collision detection model abcd m and the probability of collision is estimated in various routes pertaining to a specific area of operation damage extents are idealised by the super element se method accounting for the influence of surrounding water in way of contact results are presented for a ro pax ship operating from 2018 to 2019 in the gulf of finland it is confirmed that collision probability is extremely diverse among voyages and the damages obtained correlate well with those adopted by the un imo regulatory instrument solas 2020 it is concluded that the method is by nature sensitive to traffic features in the selected case study area yet it is useful for the evaluation of flooding risk for ships operating in real hydro meteorological conditions keywords big data analytics passenger ships collisions damage stability super element method flooding risk nomenclature roman letters a attained index abcd m avoidance behavior based collision detection model ais automatic identification system b b ref ship width reference ship width bns bayesian networks colregs convention on the international regulations for preventing collisions at sea cvro vessel conflict ranking operator eta event tree analysis fta fault tree analysis hcl hybrid causal logical imo international maritime organization rcos risk control options solas international convention for the safety of life at sea sos system of system un united nations vo velocity obstacle β relative bearing angle c cluster d ship depth tcpa t cpa time to the closest point of approach dcpa d cpa distance to the closest point of approach d p j p j 1 dist ij the distance between the point p j and p j 1 obtained from ais st t r ship trajectory r rot rate of turn flare flooding accident response f the survivability function ind side damage side port side 1 or starboard side 1 k t n m the timestamp l l ref ship length reference ship length lpp length between perpendicular l x longitudinal extent of the damage damage length m l y transversal extent of the damage penetration m p k the probability of occurrence of each individual damage k p 1 p n the departures destinations of ship trajectory p j i a point of ship trajectory t r i at the j t h timestamp t r o w n s h i p t r t a r g e t s h i p ship trajectories of the struck and striking ship when evasive actions are taken t timestamp of ais data p r o p a x k the causation probability involving ro pax ship as struck ship n a k the number of the detected the collision scenarios t t a coefficient to calculate the collision probability or collision frequency per year n r o p a x the number of marine traffic of ro pax ships n a l l s h i p all the number of marine traffic p c k the causation probability of ship collision in gulf of finland a l l t i m e p e r i o d s the time period of traffic observation super element se s k the survivability factor for damage k st t r ship trajectory dr ship draft u 0 striking ship initial surge velocity x 0 impact longitudinal position x c longitudinal position of the centre of the damage m z ul damage vertical position upper limit m z ll damage vertical position lower limit m greek letters α collision angle β relative bearing angle ship displacement λ h scaling factor 1 introduction ships are systems of systems sos operating in complex traffic situations and extreme environmental conditions ship ship collision accidental events may result in devastating consequences such as ship capsizing sinking leading to oil spills and human fatalities the latter is of particular relevance to passenger shipping operations and the mitigation of risks associated with ship damage stability following serious flooding events kim et al 2021 to mitigate risks in real traffic scenarios and environmental conditions it is necessary to develop rapid maritime risk assessment tools to date the evaluation of collision probability of occurrence and associated consequences have been based on historical records of accidents and expert judgment e g huang et al 2020a fan et al 2020 examples of methods used are fault tree analysis fta and event tree analysis eta e g zhang et al 2019 martins and maturana 2010 bayesian networks bns e g kelangath et al 2012 zhang et al 2020a montewka et al 2014 hybrid method by combining fault tree analysis and bayesian networks namely hybrid causal logical hcl e g ramos et al 2020 wang et al 2020 and maritime traffic simulation e g goerlandt and kujala 2014 rawson and brito 2020 jiang et al 2021 these studies illustrate the factors that influence collision risk and may help identify the probability of occurrence of extreme events that may influence ship safety during operations however they do not account for traffic complexity and collision based probabilistic damages in real operations thus they are not reliable in terms of estimating the collision risk level and possible consequences to crew during operations to assess the risk of collision in real conditions it is useful to idealize complex traffic scenarios using automatic identification system ais data methods to evaluate collision probability utilising big data are ship domain e g zhang et al 2015a szlapczynski and szlapczynska 2017 vessel conflict ranking operator cvro e g fang et al 2018 zhang et al 2015b dcpa and tcpa e g lopez santander and lawry 2017 zhao et al 2016 velocity obstacle vo chen et al 2020 du et al 2020a huang and van gelder 2020 collision risk is defined as the consequence of a damage and the probability of occurrence goerlandt and montewka 2014 2015 results from these approaches illustrate the collision risk probability frequency in a specific area but underestimate accidental risk indices i e indices linked to the occurrence of an accident this is because they do not consider collision consequences i e possible damage breach and the damage stability following serious flooding events during real traffic operations to explore collision risk after the potential collision scenarios are detected and in real conditions a rapid direct method is necessary such method could be used to assess both collision probability possible damage distributions and provide a convincing justification for risk control options rcos to date solas 2020 damage stability assessment is based on a probabilistic distributions of damage characteristics that originate from pooled analysis of collision accidents on all types of ships available from accident statistics imo 2018 these damage distributions do not explicitly consider the differences in structural design of each ship and ignore the influence of real traffic situations to assess the consequences of ship ship collision nonlinear structural analysis by finite element analysis methods is essential e g amdahl 1982 wierzbicki and abramowicz 1983 simonsen and ocakli 1999 liu et al 2018 this approach provides accurate results and allows for a refined investigation of the impact process e g le sourne et al 2021 however the models should be sufficiently refined to accurately capture the crushing mechanisms as a result numerical simulations become exceptionally time demanding to overcome these challenges simplified approaches empirical or analytical have been developed e g pedersen 2010 liu et al 2018 kim et al 2021 another idea has been to model vessels with very large size structural units the so called superelements se and to derive closed form analytical formulations of the resistance of each unit buldgen et al 2012 2013 2013 le sourne et al 2021 conti et al 2021 then by combining properly the individual resistances it is possible to rapidly calculate the dimensions of the breach on the struck ship s hull the se method opens the way toward the development of direct assessment methods for the evaluation of ship collision probability as well as collision damage reflecting traffic situations such methods can explicitly consider the influence of the ship structural design on collision damage distributions to be used within the context of damage stability analyses this paper proposes a method that brings together knowledge from big data analytics for the estimation of collision probability and the assessment of ship damage stability following a collision event possibly leading to serious flooding under real operating conditions see section 2 in section 3 a set of realistic collision scenarios are identified via processing ais data for all ships operating in the gulf of finland from 2018 to 2019 then the ship to ro pax ship collision probability is estimated in various routes considering traffic uncertainty and structural crashworthiness is accounted for by fully coupling the external dynamics and the internal mechanics of the struck ship via the se method damage stability analysis focuses for the case of floodstand ship b luhmann 2009 operating in the gulf of finland the description of damage breaches obtained via simulation of real traffic situations differs from those embedded in imo solas imo 2006 in which the damage distributions result from accident statistics mainly related to cargo ships this allows better insight into the nature of collision risk from both probability and consequence perspectives it also provides information to support the decision making of the crew during operations and strengthen ship resilience under off design conditions and throughout ship lifecycle 2 methodology the high level framework for ship to ship collision detection collision probability evaluation and structural damage breach simulation in real operational conditions using ais data is shown in fig 1 detailed discussion on the methodology associated with the collision scenario detection is presented in zhang et al 2021 the collision risk estimation process fig 1 comprises three steps step i where ship trajectories sts are reconstructed using ais data that contain static voyage and dynamic navigation details the process is used to cluster ship trajectories of the struck ships by using k means for static voyage clustering and db scan for dynamic navigation features clustering step ii cluster collision scenarios are identified using the proposed avoidance behaviour based collision detection model abcd m the collision probability is estimated with the focus on the ship to ro pax ship collision step iii for each collision scenarios collision breaches are evaluated using the struck ship sharp model in the method presented potential collision scenarios evasive actions and crash scenarios are defined as follows potential collision scenario is a critical situation that triggers the ship to take evasive action when a collision accident may occur if no evasive action is taken evasive action is an operational routine that encompasses changes in speed course or their combination should be carried to avoid collision event crash scenario is a critical situation which reflects the eventuality of a potential collision event when the evasive action is underestimated in a crash scenario the parameters for crash analysis are defined based on ais data describing the navigation patterns of the ships involved i e striking ship type striking ship initial surge velocity etc based on the above collision damages and flooding risk are illustrated and quantified in real conditions 2 1 step i clustering of ship trajectories to estimate ship collision probability in various routes the ship trajectories should be clustered by similarity measurements at first this section demonstrates the use of methods for ship trajectories clustering using ais traffic data 2 1 1 ais traffic data the automatic identification system ais is an automatic tracking system that uses transceivers on ships and is used by vessel traffic services vts use of the ais systems has been required by the international maritime organization imo since december 31 2004 the regulation requires ais to be fitted aboard all ships of 300 gross tonnage and upwards engaged on international voyages cargo ships of 500 gross tonnage and upwards not engaged on international voyages and all passenger ships irrespective of size automatic tracking systems may be used to identify and locate ships through data exchange with nearby ships ais base stations and satellites ais big data streams contain multiple parameters related to static voyage features e g departures destinations voyage length and dynamic navigation features e g speed course motion parameter variation and ship trajectory spatial distance availability of ais data is of course critical factor fig 2 and table 1 in an ais data stream trajectory paths are defined as follows 1 t r i p 1 i p 2 i p 3 i p j i p n i 1 j n 2 for p j i i m o m m s i t j l o n l a t s o g c o g r o t h s s l w d where i stands for a trajectory number j is the number of timestamp of ship trajectory t r i also is the number of point of ship trajectory t r i t j is the j t h timestamp p j i denotes a point of ship trajectory t r i in multi dimension space that contains imo number mmsi of the ship timestamp geographical position speed course heading ship type ship length ship width and draft n is the total number of the points in the trajectories t r i and p 1 i p n i represent ship departure and destination points of ship trajectory t r i 2 1 2 ship trajectories clustering methods ships navigating in various routes will encounter complex traffic to explore collision probability ship trajectories should be clustered based on similarity measurements accounting for static voyage features e g departures destinations voyage length and dynamic navigation features e g speed course motion parameter variation and ship trajectory spatial distance see appendix b although imo number call signs can be used as labels to separate ship trajectories sts of various ships existing methods do not offer automatic means for ship trajectories clustering in various voyages this is because it is difficult to derive available labels to fully explore both static and dynamic navigation features of sts in complex traffic scenarios thus when using information directly from historical ais data i e mmsi imo number call signs ship voyages cannot be separated automatically big data clustering may be useful in terms of grouping sts by measuring the similarity between available data streams rong et al 2020 in this work k means and db scan are selected and employed to cluster sts see appendix a k means algorithm is a distance partition method e g see zhen et al 2017 zhang et al 2020a cai et al 2020 used to evaluate static voyage features density based spatial clustering of applications with noise db scan is a density based clustering non parametric algorithm e g see zhao et al 2017 rong et al 2020 used for clustering dynamic navigation features the method comprises of three steps namely a re construction of sts b grouping of static data by k means and c clustering of dynamic data by db scan fig 3 demonstrates an example of the st clustering process for one ship with 6 sts voyages sailing in a given area st1 is opposite to st2 and likewise st3 4 are opposite to st5 6 despite the fact that st3 4 describe trajectories of ships navigating between the same departure and destination points they are different similarly st 5 6 head in the same direction however ships on st5 are faster than those on st6 separation of the sts and exploration of the collision risk is achieved as follows k means algorithm is used to classify sts into 4 clusters using static voyage features departure destination voyage length in this way st1 st2 st3 4 and st5 6 are split in different clusters db scan algorithm is employed to re cluster results using dynamic navigation data ship speed course motion parameter variation and trajectory spatial distance in this way st3 and st4 st5 and st6 are split in different sub clusters 2 2 step ii collision detection and probability estimation this section demonstrates the use of methods for potential collision scenarios detection and collision probability estimation for the clustered ship trajectories of ro pax ships outlined in section 2 1 2 2 1 ship to ro pax ship collision scenarios detection the model developed to detect potential collision scenarios using ais traffic data in real operational conditions is shown in fig 4 ship evasive actions take place when ship manoeuvres result in motion changes in fig 4 ship trajectories t r i and t r i γ relate to struck own ship and striking ship target ship a struck ship may encounter the target ship over four stages shown on the top of fig 4 namely a unconstrained navigation b encounter c collision avoidance d clearance during stages a and d there is no collision likelihood between the two ships because there are no ships within 6 nm radius or ship trajectories diverge at stage b when the rate of change of bearing angle δ β relative to struck ship falls within 2 00 to 2 00 0 a collision accident may occur if no evasive action is taken as the distance between ships keeps shrinking the rate of change of bearing angle δ β exceeds the range of 2 00 to 2 00 0 thus indicating that the give way ship changes her course to avoid collision stage c at the collision avoidance stage c the minimum distance between striking and struck ships is below 3 nm the minimum dcpa is below 1 nm and the minimum tcpa is located within 0 30 mins the endpoint of the collision avoidance stage is defined as the point where tcpa becomes 0 if tcpa is below 0 there is no collision risk stage stage d the collision detection method comprises part a where we determine the minimum distance between two ship trajectories this requires that ship trajectories of potential striking ships keep clear of the struck ship to ensure no encounter or collision the minimum ship distance d min is defined at timestamp t j n corresponding to ship trajectories t r i j j m t r i γ j j m where t j t j m denotes the timestamp interval of the two series part b during which ship encounters are determined based on ship course bearing angles tcpa dcpa rate of turn rot and the difference between the headings fig 4 part c where we classify collision scenarios as per colregs zhang et al 2021 an encounter stage defined during the time interval t j t j m threshold conditions of dcpa tcpa distance δ β 2 00 to 2 00 within the observation time of 6 nm are dist 6 nm goerlandt and montewka 2014 d m i n p j n t s 3 nm du et al 2020b δ β 2 2 at the time interval t j t j t montewka et al 2010 min d c p a p j t j t 1 t s 1 nm during collision avoidance stage and for the time interval t j t t j t 1 langard et al 2015 0 min t c p a p j t j t 1 t s 30 mins during collision avoidance stage and for the time interval t j t t j t 1 langard et al 2015 t c p a p j n 1 t s 0 mins at clearance stage wang et al 2013 to analyse the collision avoidance behaviours the ship trajectories t r t a r g e t s h i p and t r o w n s h i p during evasive action were defined as follows 3 t r t a r g e t s h i p p j t t s p j t 1 t s p j t 2 t s p j n t s 4 t r o w n s h i p p j t o s p j t 1 o s p j t 2 o s p j n o s 2 2 2 ship to ro pax ship collision probability estimation the objective of collision risk analysis is to find out what might happen how probable it is and what are the consequences in the research domain of probabilistic risk analysis pra and probabilistic safety analysis psa collision risk entails the product between the probability of the unexpected event and the consequences if it occurred the collision probability is often defined as the probability of the number of collisions per year or the number of years per accident collision scenarios are determined according to the international regulations for the prevention of collisions at sea colregs convention johansen et al 2016 the analysis accounts for the relative speed position heading bearing angle and course of ships see fig 5 the probability of a collision between two ships is estimated according to fujii and macduff model fujii and shiobara 1971 macduff 1974 gil et al 2020 as 5 f k 1 3 n a k p c k where n a k is the geometrical probability or the probability of being on a collision course for three encounter types crossing overtaking and head on p c k is the causation probability or the probability of failing to avoid the accident while being on a collision the causation probability can be estimated on the basis of different scenarios or by the so called synthesis approach the former is sensitive to available accident data e g pedersen 2002 this is the reason why most methods use the synthesis approach according to this method probability of error is found by application of a bbns e g kelangath et al 2012 martins and maturana 2013 or by the use of fault tree analysis e g zhang et al 2019 as shown in table 2 in the gulf of finland the causation probability was studied using the synthesis approach by kujala et al 2009 goerlandt and kujala 2011 and montewka et al 2014 the results indicate that a causation probability of 1 3 10 4 for crossing ships and 4 9 10 5 for head on and overtaken is derived 2 3 step iii sharp modelling of collision scenarios the estimation of potential collision scenarios assumed that the evasive action is underestimated by making ships fall into the eventualities a collision accident happens along the route this is used to determine the collision parameters based on the ais information of the ships involved this section demonstrates the methodology developed to determine collision parameters and crash analysis using sharp besnard and buannic 2014 2 3 1 collision scenarios analysis a ship ship encounter comprises four stages namely a unconstrained navigation b encounter c collision avoidance d clearance in such scenarios an accident would occur if no evasive manoeuvres were made based on ais data streams the mass can be roughly inferred from the ship size and ship specification which may be related to the consequences of a collision montewka et al 2014 as shown in fig 6 the collision and possible relative striking positions are classified as a front side b head head c frontal d front side e rear end consequently the anticipated relative collision location along a ship hull can be estimated for use in crashworthiness analysis 2 3 2 collision crash analysis using the se method the se method is used to model the ship into very large sized structural units the so called super elements for which closed form analytical formulations have been derived see e g amdahl 1982 wierzbicki and abramowicz 1983 or simonsen and ocakli 1999 these formulations based on plastic limit analysis and experimental data characterise the resistance energy dissipation of the se depending on its type and deformation mechanism as the impacting vessel is moving forward into the struck structure the super elements are successively activated and their contribution to the total collision force is evaluated the force f leading to the collapse of a given structural component is obtained by the so called upper bound theorem jones 1989 6 f δ v σ i j ε i j d v where δ is the striking ship surge velocity σ i j is the stress tensor of the component ε i j is the strain rate tensor of the component v is the component volume to derive the force f analytically the following assumptions are made the constitutive material is assumed to be perfectly rigid plastic shear effects near the plate edges are neglected so that the total internal energy rate is obtained by summing the contribution of bending and membrane effects which are assumed to be completely uncoupled for example for a plate in a plane stress state assuming that bending effects are confined inside m plastic hinges the bending e b and membrane energy rates e m can be calculated by using the following two expressions 7 e b m 0 k 1 m θ k l k 8 e m 2 σ 0 t p 3 a ε 11 2 ε 22 2 ε 12 2 ε 11 ε 22 d a where m 0 is the fully plastic bending moment σ 0 is the flow stress a and t p are respectively the area and the thickness of the plate θ k and l k are the rotation and the length of the hinge number k the se method is implemented in the software sharp as illustrated in figs 7 and 4 types of super elements allow to model the struck ship hull and longitudinal bulkheads vertical frames and transverse bulkheads secondary stiffeners stringers decks and bottom within sharp the resistance of each se has been derived by buldgen et al 2012 2013 for ship oblique collisions then by combining the individual resistances it is possible to obtain a global evaluation of the ability of both the striking and struck ships to withstand a collision event the sharp internal mechanic s solver has been coupled by le sourne 2007 with an external dynamics program named mcol able to idealize global ship motions taking into account the forces exerted by the surrounding water the first version of mcol was developed and included in ls dyna fea software by mitsubishi lstc 2018 the current version has been entirely rewritten to take into account large rotational movements driven by the crushing force and hydrodynamic forces water added mass wave radiation damping and restoring forces and to introduce drag damping effects ferry et al 2002 implemented in ls dyna in 2001 this new version was used to simulate the large rotational movement of submarines impacted by surface ships le sourne et al 2001 and to study surface ship collisions le sourne et al 2003 some practical applications of sharp mcol tool can be found in le sourne et al 2012 and paboeuf et al 2015 2016 to consolidate the reliability of this approach a benchmark study has been recently carried out in which sharp mcol calculations have been compared to finite element results le sourne et al 2021 in sharp a collision scenario such as the one presented in fig 8 is defined by the following parameters striking ship type striking ship initial surge velocity struck ship initial surge velocity impact longitudinal position collision angle striking ship draft struck ship draft after solving the collision problem sharp provides an estimate of the damage bounding box based on the computed penetration as well as the shape of the striking ship s bow 3 case study in this section considering all large roro passenger ships ro pax 46 124 gt gross tonnage 10 000 gt 218 8 m length 120 m as struck ships a case study is carried out by using ais data covering a 13 month ice free period year 2018 and 2019 in the gulf of finland see fig 9 the types of ships operating in the gulf of finland during this period are shown in fig 10 notably 9 8 of the sts involve ro pax ships 3 1 collision scenarios modelling in this section ship trajectories of ro pax ships in the gulf of finland are clustered and probabilities are estimated in various routes the results are validated using historical collision accidents 3 1 1 ship trajectories clustering to analyse the ship to ro pax ship collision risk in various voyages the k means algorithm and db scan were used to cluster voyage details of ship trajectories of potential struck ships ro pax ships according to the sts clustering procedure outlined in fig 3 the sts of ro pax ships were extracted from ais database the 12 214 ship voyages of struck ships were divided into 17 clusters 16 complete clusters and 1 incomplete cluster see fig 11 3 1 2 potential collision detection for each cluster for each of the clusters outlined in fig 11 potential collision scenarios were identified fig 12 demonstrates the locations of ro pax ships during a 13 months ice free period the year 2018 2019 it was found that 50 of the potential collisions occur in cluster 13 i e after leaving the port of tallinn and towards helsinki the probability of potential collisions per journey was calculated as 9 f i n potential n ship trajectorie s i i 1 2 3 16 fig 13 shows that the number of potential collisions per journey is at its highest in cluster 11 3 03 potential collisions per journey this indicates that collision risk estimates may be extremely diverse among voyages clusters 6 and 13 are located in the same route however the voyage is reversed between helsinki and tallinn in cluster 6 0 25 potential collisions per journey or one potential collision per 4 0 ro pax journeys occur however 1 13 potential collisions per journey in cluster 13 are 4 52 times that those observed in cluster 6 3 1 3 probability of collision to estimate ship to ro pax ship probability of collision scenarios n a and causation probability p c k should be taken under consideration along the lines of the method presented in section 2 2 9240 potential collision scenarios crossing 6213 overtaking 125 head on 2902 were detected see fig 12 consequently p c k could be evaluated for all ship types using the synthesis approach of section 2 3 if we assumed tss traffic separation scheme for all ship types the causation probability for head on collisions p c h and overtaking cases p c o could be 4 9 10 5 leading to p c c 1 3 10 4 however the aim of this study has been to evaluate ship to ro pax ship collision only during a 13 month ice free period thus the evaluation of causation probabilities considered the following factors the ratio of ro pax ships to the number of other ships navigating in the gof is 0 098 see figs 9 and 10 so the causation probability p s h i p r o p a x k between ship and ro pax ship equals to 9 8 p c k if we assume 50 chances to scenarios idealising a ro pax ship as a struck or striking ship montewka et al 2014 the causation probabilities p r o p a x k involving ro pax ship as struck ship are 9 8 0 5 p c k to evaluate the collision probability or frequency per year 12 months a calibration coefficient t t should be considered accordingly collision probability involving ro pax as struck ship was estimated by equation 10 12 10 p p r o p a x k n a k t t 11 p r o p a x k n r o p a x n a l l s h i p 0 5 12 t t 12 a l l t i m e p e r i o d s where p r o p a x k denotes the causation probabilities involving ro pax ship as struck ship n a k represents the number of the detected the collision scenarios t t denotes a coefficient to calculate the collision probability or collision frequency per year n r o p a x denotes the number of marine traffic of ro pax ships n a l l s h i p denotes all the number of marine traffic p c k denotes the causation probability of ship collision in gulf of finland a l l t i m e p e r i o d s denotes the time period of traffic observation accordingly 13 p c o l r o p a x h 9 8 0 5 4 9 10 5 2902 12 13 6 43 10 3 p c o l r o p a x o 9 8 0 5 4 9 10 5 125 12 13 2 70 10 4 p c o l r o p a x c 9 8 0 5 1 3 10 4 6213 12 13 3 65 10 2 thus the model gave 4 32 10 2 accidents per year or a collision per 23 1 years including 2 70 10 3 for overtaking 6 43 10 4 accidents per year for heading on and 3 65 10 2 accidents per year for crossing encounter type this observation leads to the conclusion that potential scenarios can be evaluated focusing on various clusters voyages in more detail the conditional probability is evaluated according to 14 p i n potential n total potential collisions p c o l r o p a x o p c o l r o p a x h p c o l r o p a x c i 1 2 3 16 the probability of collision was estimated for 16 clusters see fig 13 this resulted in 0 021 accidents per year for cluster 13 see table 3 to validate the results of probability estimates historical collision accidents in the gulf of finland were reviewed see fig 14 based on the casualty reports of fma bmepc and helcom over 21 years only one ro pax ship accident took place during ice free period this corresponds to 4 76 10 2 accidents per year this value is in good agreement with the results of collision probability estimation 4 32 10 2 accidents per year 3 2 damage breach simulation this section runs all the potential collision scenarios identified on the reference ship as struck ship using the crash analysis software sharp 3 2 1 description of collision scenarios results confirm that if a struck ship s course falls into the detected potential collision scenarios eventualities outlined in section 2 2 action should be taken to avoid the collision fig 15 demonstrates the manoeuvres of the give way ship along a red track with the aim to avoid collision accident give way ships may ignore evasive actions along the initial trajectory and in turn this may result in damages following a collision event if the evasive action is underestimated for each of the potential collision scenarios detected in section 3 1 2 ships may fall into eventualities and the collision accident will happen along the original routine for the case study presented in this paper potential collisions during evasive actions were accounted for see p j t t s on fig 15 and the motion features of involved ships were used to feed in crash analysis in doing so possible collision consequences were used to support risk mitigation in advance the results outlined may strengthen ship resilience under off design conditions and throughout the lifecycle after collision scenarios detections fig 13 shows that the 9240 potential collision scenarios are detected using the proposed abcd model covering a 13 month ice free period year 2018 and midterm 2019 in the gulf of finland among them 9012 potential collision scenarios are determined into 16 clusters according to the results of sts clustering in this section 3491 potential collision scenarios among them during year 2019 periods of the selected large ro pax ships 46 124 gt gross tonnage 10 000 gt 218 8 m length 120 m as struck ship were used to feed in real complex data in the direct approach the objective of the direct approach is to obtain a probabilistic description of the damage breach for a specific ship in specific operational conditions within the current solas framework imo 2018 the underlying damage distributions correspond to the distributions of damage knowing that a breach had occurred following a collision event therefore the collision probabilities identified in table 3 do not need to be considered as such instead the relevant information to be used for crash analysis relates to the parameters defining each potential collision assuming that this collision happened given the way the potential scenarios are obtained they are assumed to be equiprobable i e p 1 n c from ais data analysis the following data was made available for the description of each collision scenario the probability of the event assumed to be equal to 1 n c the length and width of the striking ship the surge velocity and draft of the struck and striking ships the displacement of the striking ships the collision angle the type of collision head on overtaking crossing and the type of striking ships group 1 tankers group 2 passenger ships group 3 bulk carriers group 4 container ships group 5 general cargo ships group 6 other ships such as tug boats trawlers research vessels see table 4 from sharp analysis the outcome of a low energy collision event with such small striking ships will be a low penetration however it is difficult to estimate with accuracy if this low penetration corresponds to a hull breach rather than a dent i e no breach in the hull furthermore type of minor collisions with small ships and no hull breach are believed to be under reported in damage statistics therefore filtering has been applied and all the striking ships with lengths lower than 50 m have been removed 90 of which are l 33 m b 10 m displacement 850 tons the data has been further filtered by excluding head on and overtaking scenarios thus keeping crossing collision scenarios after filtering 2124 collision scenarios remained available for crash analysis the distributions of striking ship type length width speed and displacement obtained after filtering are shown in fig 16 and fig 17 in fig 18 the distributions of initial surge velocities for struck and striking ship are plotted regarding the distribution of the struck ship surge velocity at the onset of the collision event it is observed to be significantly different than the one considered by lützen 2001 based on collision accidents statistics indeed it assumed a triangular decreasing distribution with a most likely value equal to zero speed whereas the present distribution entails a large majority of collision scenarios with struck ship having an initial surge velocity between 14 and 25 knots in this work lützen 2001 regarding the distribution of the striking ships surge velocity at the onset of the collision event three peaks emerge at approximately 10 knots 17 knots 22 knots also it can be observed that the scenarios corresponding to the collision at high striking ship velocity correspond to group 2 striking ships passengers ships see blue bars on the right of fig 18 3 2 2 sharp modelling based on the detected collision scenarios realistic striking ship models are to be built in the definition of all the potential collision scenarios the striking ships are defined based on their length width type displacement and draft however when it comes to striking ship modelling in sharp the actual bow shape as well as hydrodynamic properties shall be defined in order to build realistic striking ship models in sharp the already built models from the sharp striking ships database see fig 19 and table 5 are reused and scaled according to the required striking ship properties for each potential collision scenario accordingly for each striking ship to be modelled the reference ship with the closest properties was selected and an average scaling factor was defined as per equation 15 in order to check that the striking ships to be modelled can satisfactorily be defined using the above approach based on homothetic scaling the real length and breadth ratios l l ref and b b ref have been compared with the averaged ratio λ h in average for all the modelled striking ships the difference is about 10 which is deemed acceptable an example of scaled bow shape of striking ship is shown in fig 20 since the striking ships scantling is not known the striking ships have been considered to be structurally rigid during the collision which provides a conservative estimate of the computed damages on the struck ship since no energy can be absorbed by deformation of the striking ship s bow 15 λ h 1 2 l l ref b b ref where l b length and breadth of the striking ship to be modelled by scaling l ref b ref length and breadth of the reference ship the reference ship design was then scaled to the striking ship to be modelled both in terms of geometrical bow shape and in terms of hydrodynamic properties the scaling factor is used as length scale for froude scaling in this case regarding the definition of the hydrodynamic properties of the striking ships to be modelled it appeared from multiple testing with sharp mcol that for the striking ship the inertia matrix is by far the most influential hydrodynamic parameter on the outcome of the collision analysis based on the known length breadth and displacement of the striking ship as well as the use of some correlations providing the ship gyration radii the inertia matrix can be completely defined with no need for scaling from a reference ship as equation 16 16 m 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 r x x ² 0 0 0 0 0 0 r y y ² 0 0 0 0 0 0 r y y ² where striking ship displacement r x x 0 35 b striking ship gyration radius in roll r y y 0 25 l striking ship gyration radius in pitch r z z 0 25 l striking ship gyration radius in yaw the remaining hydrodynamic properties to be defined in mcol position of centre of gravity and centre of buoyancy added inertia matrix stiffness matrix and damping matrixes are specified by scaling of the hydrodynamic properties of the reference ship attached to the striking ship to be modelled since multiple physical units are involved froude scaling laws are used considering λ h as the length scale each potential collision scenario has been modelled based on struck and striking ships initial surge velocities drafts and collision angle to idealize the longitudinal position of the impact a section of 100 m length representing the parallel ship body was modelled in sharp and the longitudinal impact position was defined randomly according to a uniform law over a reduced 32 m length such approach yields a conservative estimate of the damage as little energy can be dissipated through the yaw motion of the struck ship 3 2 3 sharp struck ship modelling for the case study all the calculations have been carried out considering a struck ship with the main particulars of table 6 the super elements structural description has been modelled for 100 m long centred on the mid ship section se have been defined for side shell decks transverse bulkheads and longitudinal bulkheads in order to keep a workable model for intensive computations decks were modelled as continuous i e no holes with a homogeneous thickness floors girders within the double bottom were not modelled and secondary rooms were omitted all materials have been modelled as rigid perfectly plastic with s 235 mild steel properties see table 7 in the se approach the membrane strain is calculated for the impacted se subjected to membrane tension e g side shell longitudinal bulkheads and compared to the material failure strain the value of 10 was initially proposed for mild steel by lützen 2001 regarding the se representing decks and bulkheads they are supposed to deform first by concertina splitting then by tearing along the edges for these se normal and tangential components of the resistant forces are calculated at element edges and compared to empirical threshold values determined from weld beads thickness and length expressions of the threshold forces are given in sharp user s manual besnard and buannic 2014 the sharp se model of the struck ship is illustrated in fig 21 her hydrodynamic properties inertia added inertia restoring and damping matrixes as required by mcol have been obtained using bv hydrostar 2019 in infinite water depth with no forward speed the input data considered for the hydrodynamic calculations are summarised in table 8 3 2 4 damage breach characterisation before presenting the damages obtained from crash analysis the framework for damage characterisation shall be defined geometrically collision type damage breach is represented as a box with two faces parallel to the waterplane two faces parallel to the ship transversal plane and two faces following the hull longitudinal shape at the waterline furthermore the damage box crosses the waterline as well as one side of the ship in the general case the damage is modelled using the following 6 geometrical parameters ind side x c l x l y z ul z ll see fig 22 in solas framework imo 2006 the damage lower vertical limit z ll is not considered as a random variable instead a worst case approach is used for the computation of the s factor in case of horizontal subdivision below the waterline as an extension of the solas framework bulian et al 2019a introduced a probabilistic description of this variable the present paper considers this extended framework with a probabilistic description of the damage parameter z ll 3 3 crash simulation results in this section the results of crash simulation from the case study are presented an a index is applied to assess the impact of damage breaches obtained from direct simulations 3 3 1 simulated damage breaches after simulating the detected collision scenarios in section 3 2 data filtering has been applied before deriving damage distributions indeed it was observed that for more than 30 of the scenarios the damage vertical position lower limit is above the waterline this is typically due to scenarios with collision angles close to 0 or 180 with limited penetration to maintain relevancy with the framework defined by solas imo 2006 and extension by bulian et al 2019a regarding the damage vertical limits the scenarios leading to these damages were discarded after filtering 1284 damages were made available for post processing and analysis 3 3 2 a index calculation example to assess the impact of damage breaches obtained from direct simulations damage stability analysis was carried out using the non zonal monte carlo method for the design draft condition this method allows the calculation of the a index based on each of the individual simulated damages i e 1 damage for monte carlo analysis corresponds to 1 crash analysis result keeping all the potential correlation between the damage parameters the use of this non zonal framework has been for instance described by bulian et al 2016 bulian et al 2019b krüger and dankowski 2019 for a given ship draft the calculation of the damage stability attained index using non zonal monte carlo method relies on the generation of a list of n individual breaches ind side x c l x l y z ul z ll k 1 k n sampled according to the desired probabilistic distributions using for instance inverse transform sampling from the cumulative distribution functions generation of damages corresponding to the rooms broken by the breaches the calculation using dedicated software of the survivability factor s k associated to each individual sampled damage mathematically the calculation of the partial attained index a for a given draft on the reference ship can be written as 17 a k 1 n p k s k 18 s k f ind side x c l x l y z ul z ll k where p k 1 n is the probability of occurrence of each individual damage s k is the survivability factor associated to an individual damage f is the survivability function computed by damage stability software for the damage stability analysis two calculations have been performed using napa software in these calculations the s factor from solas imo 2018 was used to measure the survivability of each damage a reference calculation considering damages sampled from solas underlying distributions extended by bulian et al 2019a probabilistic description of the damage vertical lower limit a calculation for which each damage directly results from the crash analyses in this case the longitudinal position of the damage centre has been resampled assuming this random variable to be uniformly distributed along the ship length in accordance with solas underlying assumption 4 discussion this paper proposes a method that brings together knowledge from big data analytics for the estimation of the ship ship collision detection and scenario analysis with structural damage simulations using the se method the results and findings from the case study are concluded together with discussions ro pax ship collision scenarios were detected in various routes using ais data the number of occurrences of potential collisions per voyage during the period that is collision frequency collision probability was calculated fig 13 and table 3 this has shown that the voyage may be the key influential factor contributing to collision risk which is ignored in the traditional models therefore it may be pointed out that the proposed collision risk analysis model can determine the effectiveness of the navigational safety strategy in more detail when it is further embedded with ship traffic in various routes which could be a possible strategy to enhance navigational safety in the gulf of finland ro pax ship collision probability was evaluated by the abcd m model see table 3 for the purposes of validating results accident statistics from various previous studies were considered see table 10 the collision probability obtained from the abcd m model was close to those presented by otto et al 2002 however the ship to ro pax ship collision probability value delivered by the study is a bit higher than the one obtained by montewka et al 2014 differences against the results of goerlandt and kujala 2011 could be attributed to the fact that their study evaluate the collision probability based on all ship types whereas the present study considered only ro pax ship collision figs 23 24 illustrate damages simulated from crash analyses both in terms of scatter plots and distributions collision scenarios and damages were obtained by simulation rather than real damages from collision accidents the damages obtained using the simulation method introduced in this paper show distributions that are globally relevant with solas even if more severe notwithstanding this contrary to solas distributions the simulated damage distributions are generally not strictly decreasing this could be explained by the fact that the collision scenarios include a significant part of group 2 striking ships passenger ships which lead to severe damages due to high kinetic energy the distribution of damage vertical position lower limit somewhat differs from the description proposed by bulian et al 2019a based on analysis of accident statistics this is due to a large proportion of group 2 striking ships see section 3 2 1 in table 4 which entail severe damages down to the bottom of the struck ship in table 9 the partial a index obtained from the directly simulated damage breaches is compared with the one obtained considering damage distributions from accident statistics it is seen that the a index resulting from simulated damages is significantly lower than the partial a index computed with conventional damages from accident statistics such a decrease of the a index was expected since the damage distributions obtained by direct simulations are more severe than the ones processed from accident statistics see figs 24 and 25 this difference may be attributed to the severity of the collision scenarios considered i e half of the potential striking ships considered were passenger ships sailing at full speed thus leading to high energy collisions 5 conclusions this paper proposed a big data analytics framework for ship to ship collision detection collision scenario analysis damage breach simulation and damage stability assessment reflecting the influence of traffic complexity in real hydrometeorological conditions a method for modelling collision scenarios using avoidance behaviour based collision detection model abcd m followed by collision probability evaluation and crash analysis using the se method sharp software has been developed and tested for the case study presented it is confirmed that collision probability is extremely diverse among voyages as this is ignored by traditional models it may be concluded that safety in navigation practice and standards would benefit from the method proposed it is assumed that evasive actions are underestimated ship damage distributions are then evaluated the results outlined may present important support for risk mitigation in advance during shipping the a indices obtained from the proposed method appear to be more conservative compared to those obtained when using solas 2020 this could be attributed to the collision scenario distribution used is for a specific area i e the fact that the damage breaches originate from simulations of ro pax ships in gulf of finland this is different compared to current solas regulations that are based on global statistics of historical accidents involving mainly cargo ships the interpretation of damage stability results should be treated with care because the method presented is purely based on damage breach simulations that reflect traffic situations in a specific area since the proposed method is by nature sensitive to traffic patterns and hydrometeorological conditions it would better suit the evaluation of flooding risk under ship and operation specific scenarios this logic is aligned with that of the safety case used by the offshore industry future research could focus more on the estimation of ship collision damage and flooding risk by integrating some manoeuvre based prediction techniques into the proposed approach gil et al 2019 2020a b in addition it would be insightful to explore the global ship collision damage and flooding risk of multiple ship types to assist surveillance operators in improving their cognitive abilities in dangerous traffic situations the principles of the method proposed could be suitably adapted for the direct assessment of grounding events zhang et al 2020b or for the development of decision management systems for use in remote operations of autonomous ships janne lahtinen et al 2020 banda et al 2021 credit authorship contribution statement mingyang zhang methodology software investigation data curation writing original draft fabien conti methodology validation investigation data curation writing review editing hervé le sourne methodology software writing review editing dracos vassalos writing review editing funding acquisition pentti kujala writing review editing funding acquisition daniel lindroth validation data curation validation writing review editing spyros hirdaris conceptualization methodology writing review editing supervision funding acquisition project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the research presented in this paper has received funding from european union project flooding accident response flare number 814753 under h2020 program the authors express their gratitude for this support the views set out in this paper are those of the authors and do not necessarily reflect the views of their respective organisations appendix a the ship trajectories clustering methods k means algorithm k means is a clustering algorithm based on euclidean distances that is easy to understand implement and can handle large datasets however the k means clustering test shows that if it considers more than three parameters for sts clustering the performance is not worked well this is because the k means algorithm is difficult to handle both static voyage features and dynamic navigation features of complex ship trajectories thus to explore the difference of ship trajectories in more detail dynamic navigation features of sts are mined after k means clustering for db scan clustering table 11 k means algorithm for sts clustering table 11 db scan algorithm in contrast to the k means method that applies to static points datasets db scan is an algorithm that helps to form data clusters based on regular and irregular dense data as presented in table 11 but db scan algorithms may not work well with static voyage features distance points datasets of sts this is the reason why the both k means algorithm and db scan algorithm are used to cluster sts in the paper table 12 db scan algorithm for sts clustering table 12 appendix b ship trajectories similarity measurement 1 for voyage features the similarity parameter s d d p denotes the similarity of sts between the same departure destination points as equation b 1 b 1 s d d p d i s t p 1 i l o n 1 l a t 1 p 1 i j l o n 1 l a t 1 d i s t p n i l o n n l a t n p n i j l o n n l a t n the similarity parameter s d d s t denotes the similarity set that uses the sum of distances of the same departure and destination points t r i and t r i y as equation b 2 b 2 s d d s t t r i t r i y d i s t l o n 1 i l a t 1 i l o n 1 i y l a t 1 i y d i s t l o n n i l a t n i l o n n i y l a t n i y where l o n 1 l a t 1 and l o n n l a t n denote locations of the departure and destination points respectively s d d p is a set including the distance between ship departure p 1 i p 1 i y and destination points p n i p n i y n is the number of the waypoints of the st i voyage length is defined as equation b 3 b 3 d p j p j 1 d i s t l o n j l a t j l o n j 1 l a t j 1 b 4 t l e n g t h j 1 n 1 d p j p j 1 the similarity parameter s l denotes the difference in the voyage length of different sts defined by equations b 3 and b 4 b 5 s l t r i t r i y t l e n g t h i t l e n g t h i y consequently similarity parameter s l and similarity parameters s d d p and s d d s t are used to represent the similarity of sts for k mean clustering 2 for navigation features to explore the difference of ship trajectories in more detail dynamic navigation features of sts are mined after k means clustering for db scan clustering sog speed over ground cog course over ground and variations of those e g average value median value and variance are considered for ship trajectories similarity measurement the similarity parameters s s o g s c o g and s m p v t r i t r i y are defined as b 6 s c o g t r i t r i y c o g m e a n i c o g m e a n i y b 7 s s o g t r i t r i y s o g m e a n i s o g m e a n i y b 8 s m p v t r i t r i y s o g i n t e r a l i s o g i n t e r a l i y s o g s t d i s o g s t d i y c o g i n t e r a l i c o g i n t e r a l i y c o g s t d i c o g s t d i y where the s o g m e a n and s o g m e d i a n denote the average and median values of sog respectively the c o g m e a n and c o g m e d i a n denote the average and median values of cog respectively the s o g i n t e r v a l s o g s t d c o g i n t e r v a l and c o g s t d represent variable interval and standard deviation of sog and cog t r i and t r i y denote different sts 3 for spatial distance features of sts the spatial similarity parameter of two different sts is defined as equation b 9 calculated using the hausdorff distance algorithm kumar et al 2020 by equation b 10 and b 11 b 9 s h max h t r i t r i y h t r i y t r i b 10 h t r i t r i y max p j i t r i min p j i y t r i y d p j i p j i y b 11 h t r i y t r i max p j i y t r i y min p j i t r i d p j i y p j i where h t r i t r i y denotes the hausdorff distance of trajectory t r i to t r i y and the h t r i y t r i denotes the hausdorff distance of st t r i y and t r i s h is the spatial similarity parameter of different sts see fig b 1 fig b1 illustration of the hausdorff distance algorithm for the spatial similarity calculation of sts zhang et al 2021 fig b1 the similarity of voyage features navigation features and spatial distance of trajectories are measured for dbscan clustering 
20292,due to the shortage of offshore seismic records and inhere difficulty in simulating artificial offshore ground motions numerous existing works have been performed to investigate the seismic responses of free spanning submarine pipelines not only using onshore seismic records as inputs but also adopting uniform seismic excitations these analytical schemes may result in severe misestimates of the seismic responses in this content this paper numerically investigates the seismic behaviors of a free spanning submarine pipeline by using multi support earthquake motions within offshore sites memoss as inputs the soil pipe and water pipe interactions are modeled using the nonlinear soil spring and added mass methods respectively the effects of spatially varying and overlying seawater are explicitly taken into account in the simulation of memoss the seismic behavior law of the free spanning submarine pipeline under the synthesized memoss is analyzed and summarized moreover the impacts of the seismic excitation type offshore seismic motion coherence loss local site condition and free span length on the mises stress vertical displacement and failure pga of the submarine pipeline are examined and discussed comprehensively numerical results show that the middle and ends of free span are the dangerous regions and the memoss coherence loss local site condition and free span length have significant influences on the seismic responses and operational capacity of the pipeline based on the obtained results some meaningful advices are recommended to the pipeline designers that 1 more attentions should be paid to the middle and ends of free span in the pipeline design 2 the memoss should be adopted as seismic inputs to accurately predict the seismic behaviors of pipelines 3 the construction of submarine pipelines in soft clay and formation of large dimensional free span are adverse for the safe operation of pipelines under earthquake actions which should be avoided in engineering practice keywords submarine pipelines free spans seawater memoss seismic behavior 1 introduction as an important offshore infrastructure submarine pipelines play an irreplaceable role in the long distance transportation of raw hydrocarbon fluids e g oil and gas from the subsea fields to offshore floating platforms due to scouring or unevenness of the seafloor submarine pipelines whether buried in or directly laid on the seafloor will inevitably traverse areas with the irregular seafloor topography in that scenario there may exist suspend segments in the pipeline out of contact with the seafloor and such a distance between two suspension points is generally called free spanning pipeline moe et al 1986 as described in fig 1 free spans may cause extremely unfavorable operating conditions in complex subsea environment and are usually considered as the essential ingredient in the universal design practice of submarine pipelines shabani et al 2017 as recommended by the governing codes e g det norske veritas dnv dnv rp f105 2006 vortex induced vibration viv is treated as the primary design loading for the dynamic analysis of free spanning submarine pipelines as a catastrophic disaster earthquakes can however indeed pose an unpredictable threat to the safe operation of free spanning pipelines especially those installed in strong seismically active areas zhang et al 2019 additionally once submarine pipelines are damaged during earthquakes the leakage of hydrocarbon fluids will cause nasty ocean environmental pollution costly seabed restoration and tremendous economic losses following the above premises it is of significant importance to investigate the seismic responses of free spanning submarine pipelines for the sensible design and effective operation of pipeline systems against earthquakes so far viv is still recognized as the common concern in the response analysis of free spanning submarine pipelines and has attracted increasing attention from researchers over the past few decades numerous valuable works e g furnes and berntsen 2003 yang et al 2008 huang et al 2010 song et al 2011 dai et al 2013 choi 2001 shabani et al 2017 have been completed to explore the viv behavior of free spanning pipelines these researches indicated the free spans are susceptible to viv thereby resulting in the pipeline fatigue damage especially in the case where the vortex shedding frequency is in proximity to the fundamental vibration frequency of pipeline it is noteworthy that due to different frequency content incentive mechanism and action duration the dynamic behaviors of free spanning pipelines under seismic excitations may considerably differ from those under vivs however the available literature addressing the seismic responses of free spanning submarine pipelines is relatively limited nath and soh 1978 theoretically analyzed the harmonic and seismic responses of subsea pipelines in proximity to the seabed based on the finite element fe method using the frequency domain spectral method the transverse responses of free spanning offshore pipelines subjected to random seismic motions were investigated by datta and mashaly 2010 kalliontzis 1998 numerically examined the dynamic behaviors of submarine pipelines connected to a moving seabed under vertical seismic motions based on fe analysis zhou et al 2008 performed nonlinear seismic analysis for free spanning submarine pipelines under spatially variable seismic excitations with inclusion of soil pipe interaction zeinoddini et al 2012 investigated the dynamic responses of free spanning submarine pipelines subjected to severe seismic excitations by different simplified methods including the added mass and acoustic approaches the research on vibration control of free spanning submarine pipelines is carried out by bi and hao 2016 by designing the pipe in pipe system as a structure tuned mass damper system on the basis of underwater shaking table tests li et al 2002 2013 and zhou et al 2005 experimentally investigated the responses of free spanning subsea pipelines under dynamic excitations these investigations show that severe seismic motions can cause devastating damage to free spanning submarine pipelines which should not be neglected in the dynamic analysis and original design it should be noted that all the aforementioned investigations were implemented by adopting the onshore ground motions as seismic inputs to the best knowledge of the authors the seismic responses of free spanning submarine pipelines under offshore seismic excitations have not been reported this is mainly attributed to the extreme shortage of offshore earthquake records and inherent difficulty in generating the artificial offshore seismic motions boore and smith 1999 due to different wave propagation characteristics previous studies bi et al 2017 li et al 2018a zuo et al 2019 have demonstrated that the structural seismic responses subjected to offshore earthquake motions may significantly differ from those under onshore seismic excitations specifically the seawater layer can directly suppress the seafloor vertical motions near the p wave resonant frequencies of the overlying seawater crouse and quilter 1991 li et al 2016 while it can also indirectly affect the p wave propagation in the offshore sites by altering the water saturation condition and poisson s ratio of seabed soils boore and smith 1999 chen et al 2015 these direct and indirect impacts of overlying seawater naturally result in very variant frequency and amplification contents between offshore and onshore seismic motions therefore to obtain accurate seismic response predictions of free spanning submarine pipelines the seismic motions at offshore sites should be used as seismic inputs instead of arbitrarily adopting onshore earthquake records another critical issue in seismic response studies on the submarine pipelines is the significant effect of spatial variations of earthquake excitations in practice the seismic motion experiences at different locations of large span structures may considerably differ from each other due to the wave passage incoherence and local site effects hao et al 1989 bi and hao 2012 kiureghian 2015 although the effect of spatially varying ground motions on the seismic responses of some typical large span structures has been highlighted in previous studies ates et al 2005 yu et al 2013 tarinejad et al 2013 li et al 2018a 2018b 2018b yan et al 2018 very limited research works report the seismic behaviors of submarine pipelines under multi support earthquake excitations only zhang et al 2019 investigated the random vibration of free spanning subsea pipelines subjected to spatially varying ground motions however their research placed main focus on addressing the modeling uncertainty of subsea pipelines and failed to well clarify how the spatial variations of ground motions affect the seismic responses more importantly their research adopted the simulated onshore spatially varying motions as inputs and the influences of seawater layer and subsea soils on the ground motion amplification were ignored therefore there still exist large research gaps in investigating the seismic behaviors of free spanning submarine pipelines under multi support earthquake motions within offshore sites memoss to fill up these research gaps this paper develops a seismic response analysis method for the free spanning submarine pipelines by using the generated memoss as inputs to achieve this purpose the remainder of this paper is organized as follows in section 2 a typical free spanning submarine natural gas pipeline is described and the corresponding 3d fe numerical modeling is established in abaqus where the soil pipe and water pipe interactions are modeled using the nonlinear soil springs and added mass methods respectively in section 3 an approach for stochastically synthesizing memoss is introduced in section 4 the seismic behavior law of the free spanning submarine pipeline subjected to memoss is analyzed and the impacts of the seismic excitation type offshore seismic motion coherence loss local site condition and free span length are discussed the conclusions drawn from the analysis results are finally summarized in section 5 2 pipeline description and numerical modeling 2 1 overview of the free spanning pipeline as shown in fig 2 a typical free spanning natural gas pipeline of api x70 buried in seafloor is selected as the research object the straight pipeline is characterized by a single layer steel pipe with outer concrete coating and is full with flowing natural gas specifically the steel pipe owns a circular hollow cross section with an outer diameter d s of 480 mm and a wall thickness t s of 12 mm the thickness of the concrete coating t c is 60 mm note that the effect of concrete coating is limited to increasing the structural mass while the positive effect on the structural stiffness is disregarded herein kalliontzis 1998 more detailed information concerning the material properties of the steel pipe is tabulated in table 1 the length of the free span l p is 40 m since the focus of this investigation is placed on the seismic behaviors of free span it is of prominent importance to select a legitimate shoulder length l s to balance the analytical accuracy and computational efficiency the previous study by vedeld et al 2013 has indicated that the influence of boundary conditions on dynamic responses of the free span could be basically eliminated by choosing the shoulder length with three times of the free span length i e l s 3 l p 120 m moreover a total of four different subsea soil layers are involved for the exemplar offshore site i e the fine sand medium sand soft rock and base rock from top to bottom and the pipeline is embedded in the layer of fine sand with a buried depth a distance from seafloor surface to the center line of the pipeline cross section of 1 5 m not to complicate the analysis problem it is assumed that the pipeline within the shoulder length is embedded with an identical buried depth and without regard for the undulation of seafloor surface the geometric thickness and property parameters of each soil layer as well as the seawater are also described in fig 2 in which k and v bulk modulus and poisson s ratio of seawater g v n s r ϕ and c shear modulus poisson s ratio porosity saturation degree internal friction angle and cohesion of soil ρ and ξ density and damping ratio respectively 2 2 soil pipe and water pipe interactions it is widely acknowledged that the dynamic response of buried free spanning submarine pipelines see fig 2 is typical of a general class of soil structure fluid interaction problem hence it is of paramount importance to rationally deal with the displacement constraint of subsea soil on the pipeline shoulders contact zones i e soil pipeline interaction and the reaction force exerted by seawater on the suspend pipelines i e water pipeline interaction it has been demonstrated that nonlinear soil springs in association with equivalent dashpots have the capacity of describing the soil pipe interaction larsen et al 2016 c li et al 2017a liu et al 2019 which are adopted in the current study as for the water pipeline interaction the added mass method zou et al 2005 zhu et al 2008 bi and hao 2016 is a feasible way to address this issue 2 2 1 soil pipeline interaction modeling the surrounding soil domain of the pipeline is discretized into a host of three mutually perpendicular i e in the directions of axial transverse and vertical directions nonlinear soil springs bilinear type curves with the corresponding equivalent dashpots as shown in fig 3 for generality the shaft friction resistance inflicted by the soil to pipeline is represented by the nonlinear springs in the direction parallel to the pipeline while the nonlinear springs in two directions perpendicular to the pipeline are used to describe the lateral constraints of the soil against pipeline deformation the mechanical behaviors force displacement relation of these nonlinear springs heavily relies on the soil properties and pipeline dimension and generally are defined by the elastic perfectly plastic curves which are mainly governed by the maximum soil spring forces and associated relative displacements as plotted in fig 4 specifically the elastic perfectly plastic curves blue dashed lines in fig 4 are a simplification of those generic load displacement relation red solid lines in fig 4 summarized based on extensive laboratory and field experimental investigations both the required parameters can be obtained according to the calculation guidelines provided by american lifeline alliance ala 2001 due to the constraints of space the descriptions with respect to those calculation guidelines are not given and concerned readers can find out more detailed information by referring to ala 2001 note that the force displacement curves of the nonlinear springs are exactly symmetric in axial and transverse directions whereas they are asymmetric in the vertical direction the obvious difference of vertical upward and downward soil spring stiffness is derived from the asymmetric nature of the soil thickness above and beneath pipeline for the equivalent dashpots the damping coefficients in axial and lateral vibrations of the pipeline can be determined by 1 c s a g s w r l v s 2 c s l g s u r l v s in which g shear modulus of soil r radius of the pipeline l length of the element v s shear wave velocity of soil and s w and s u dimensionless soil damping parameters which can be referenced from hindy and novak 2010 table 2 tabulates the basic backbone parameters of nonlinear springs and equivalent dashpots corresponding to the soil condition in fig 2 2 2 2 water pipeline interaction modeling under seismic excitations the movement of pipeline relative to the surrounding seawater will impose accelerations to the seawater and the vibration of seawater can in turn induce the inertia force to the pipeline this water pipeline interaction can be equivalent to attach an added mass of seawater to the pipeline i e the added mass method also referred to as morison equation method morison et al 1950 in view of this the effective mass per unit length of free span can be determined by 3 m e m p m a where m p physical mass per unit length of free span and m a added mass per unit length of free span note that m a can be calculated by 4 m a c a π 4 ρ d 2 where c a added mass coefficient ρ seawater mass density which is equal to 1025 kg m³ and d outside diameter of pipeline generally c a can vary in a wide range between 0 and 1 29 bi and hao 2016 since it correlates with a variety of influencing factors such as the distance from pipeline free span to the seafloor surface roughness of pipeline and reynolds number dnv rp c205 2010 etc hence it is rather difficult to acquire the precise value of c a except by means of complex experimental tests and prototype observations not to complicate this problem c a is considered as unity with a constant of 1 0 in the present study it should be noticed that the use of the added mass method may result in slightly biased response prediction for the free spanning pipeline since this simplified method cannot precisely take into account the dynamic pressure of seawater especially under vertical seismic excitation chatterjee et al 2000 to obtain more accurate structural response estimations more elaborate analytical models e g the acoustic finite element numerical models proposed by zeinoddini et al 2012 might be good choices however it is worth noting that the added mass method may typically present relatively conservative seismic analysis results zeinoddini et al 2008 2012 which seems to be admissible for ensuring the design security of pipeline on the other hand since the main aim of the present study is to expound the influence of memoss on the seismic responses of free spanning submarine pipelines instead of water pipeline interaction the simplified added mass method is employed here to avoid complicating this problem 2 3 numerical modeling the seismic responses of free spanning submarine pipelines can be investigated numerically by using the advanced finite element code abaqus 2015 given that it is somewhat difficult to clearly present the entire fe model screening from abaqus due to the large geometric length the diagrammatic sketch of the developed 3d fe model of the exemplar pipeline is therefore illustrated in fig 5 in the numerical model the pipeline is described into two node three dimensional linear beam elements with six degrees of freedom at each node pipe31 in abaqus this kind of beam element is preferred to the analytical problems of thin walled structures with a large slenderness ratio which has been widely applied to the oil and gas pipelines e g lee et al 2009 joshi et al 2011 zhang et al 2019 to minimize the effect of the element size an element length of 0 5 m is employed herein along the axial direction of pipeline according to the guidance that the element length should be in approximation of the outer diameter of the pipeline dnv rp f105 2006 the free spanning pipeline model is therefore divided into 560 elements with 561 pipe nodes the soil spring dashpots representing the spi are modeled by means of the zero length connector elements conn3d2 in abaqus which can couple the pipe nodes with the corresponding offshore site nodes in particular these connector elements are generally defined by the cartesian type of connector sections comprising three components associated with the force behaviors and damping coefficients representing the spi abaqus 2015 which can be achieved based on the calculation parameters given in table 2 to consider the added mass the point mass element consisting of three translational degrees of freedom in abaqus is adopted and each pipe node at the free span is attached with the calculated added mass i e the pink points in fig 5 as declared above a shoulder length of three times of the free span length has been determined to ensure that the dynamic response is not affected by the boundary conditions hence the pipeline is conveniently assumed to be simply supported at the pipeline edges as suggested in design codes dnv rp f105 2006 and previous studies sollund et al 2014 larsen et al 2016 the mass density of steel ρ s is 7850 kg m³ due to the existence of the seawater concrete coating and natural gas an equivalent mass density ρ s e is assigned to the steel pipe section 5 ρ s e ρ s ρ g d s 2 t c 2 ρ c d s 2 t c 2 d s 2 ρ d s 2 t c 2 d s 2 d s 2 t s 2 where ρ c and ρ g mass density of concrete coating 2350 kg m³ and natural gas 200 kg m³ respectively considering a safety factor of 0 72 asme b31 8 2007 the internal pressure p i of natural gas inside the pipeline is immediately determined by the following formula 6 p i 0 72 2 σ y t d p e in which p e external pressure of pipeline caused by the surrounding seawater the geometrical non linearity problem i e large deformation of the pipeline can be addressed by turning on the nlgeom option in abaqus normally the bilinear isotropic hardening plasticity backbone model shi et al 2011 is a feasible option to capture the expected nonlinear behaviors of pipe elements additionally the backbone constitutive model i e the nonlinear true stress vs strain curve of the x70 pipe steel can be obtained based on the corresponding parameter values given in table 1 the overall damping of the free spanning submarine pipelines is primarily composed of structural damping and hydrodynamic damping given that the pipeline is typically fabricated by a composite material i e the inner steel pipe and outer concrete coating the structural damping is assumed to be 3 in the present study according to the recommendation in the reference kalliontzis 1998 moreover the hydrodynamic damping of seawater is assumed to be 1 5 following li et al 2015 and zuo et al 2019 summing up these two values the overall damping ratio is taken as 4 5 finally the damping of the pipeline is characterized by applying the assumed damping ratio to the material properties with the aid of rayleigh damping model as suggested by mina et al 2020 the mass proportional and stiffness proportional rayleigh damping coefficients are calculated using the first and third circular vibration frequencies of the pipeline an eigenvalue analysis is subsequently performed following the developed numerical model using the lanczos algorithm in abaqus the first seven vibration frequencies and the corresponding vibration modes are tabulated in table 3 3 simulation approach of memoss to realistically predict the seismic behaviors of free spanning submarine pipelines the three dimensional multi support earthquake motions within offshore sites memoss are statistically simulated and severed as seismic inputs at the free ends of soil springs considering the differences between offshore and onshore seismic motions it may be unsound to performed the seismic analysis of submarine pipeline using the synthetic onshore ground motions based on the classical simulation approaches e g bi and hao 2012 li et al 2015 recently li et al 2016 2017a b proposed an effective method concerning the simulation of seafloor seismic motions by considering the influence of seawater layer and subsea soil on the ground motion transfer functions gmtfs of offshore sites in the present study this simulation method is employed and further extended to generate the memoss which will be briefly introduced next 3 1 power spectral density function model in general the frequency and amplitude contents of seismic motions can be represented by the power spectral density psd function here it is assumed that the seismic motions at different positions of base rock have the identical intensity and frequency contents and the corresponding psd is characterized by the filtered tajimi kanai psd function with the following form 7 s g ω h p ω s 0 ω ω 4 ω f 2 ω 2 2 4 ξ f 2 ω f 2 ω 2 ω g 4 4 ξ g 2 ω g 2 ω 2 ω g 2 ω 2 2 4 ξ g 2 ω g 2 ω 2 s 0 where h p ω high pass filter function s 0 ω tajimi kanai psd function ω f ξ f and ω g ξ g central frequencies and damping rations of the tajimi kanai psd and high pass filter functions respectively s 0 scaling factor here the above parameters are assigned to be ω f 0 5π rad s ξ f 0 6 ω g 10π rad s ξ g 0 6 and s 0 0 0034 m2 s3 using which the generated ground motion time histories will possess a peak ground acceleration pga of 0 2 g and duration of t 20 s following the standard random vibration method der kiureghian 1980 it should be noted that the same psd function is applied to simulate the horizontal and vertical seismic motions of the base rock whereas the amplitude of vertical seismic motions is set to be 1 2 of horizontal seismic motions api 1993 3 2 coherency loss function model the empirical coherence model proposed by hao et al 1989 is selected to consider the coherency loss of seismic motions at the base rock in this model the coherency loss function between any two points is expressed by 8 γ a b i ω d a b e x p β d a b exp α ω d a b ω 2 π 2 e x p i ω d a b v a p p 9 α ω 2 π a ω b ω 2 π c 0 134 r a d ω 62 83 r a d 0 1 a 10 b c ω 62 83 r a d 10 v a p p v s c o s θ g b ρ b c o s θ in which d a b projected distance between any two points a and b aligning with the wave propagation direction a b c and β coherency loss coefficients v a p p apparent wave velocity v s g b and ρ b shear wave velocity shear modulus and density of the base rock respectively and θ incident angle of the seismic waves into the site the coherence loss function model presented by hao et al 1989 is achieved by analyzing the earthquake motions recorded by the strong motion array taiwan smart 1 specifically the parameters of a b c and β in the model that representing the highly coherency loss are obtained by the least square fitting approach using the recorded data during event 45 at the smart 1 array as listed in table 4 to model the different coherence degrees of spatial seismic motions the parameter values for intermediately and weakly coherency loss levels are further suggested by hao 1989 which are also given in table 4 here the three levels of coherency loss are employed to assess its impact on the seismic behavior of free spanning pipelines 3 3 ground motion amplification of offshore sites as assumed in the 1d wave propagation theory wolf 1985 the seismic waves are composed of out of plane shear horizontal sh wave and in plane coupled pressure p and shear vertical sv waves these seismic waves incident from the base rock into the overlying soil with an incident angle and then propagate upwards through different soil layers for a site with multi layered soils the dynamic equilibrium equations in the frequency domain can be expressed by 11 k s h u s h p s h and k p s v u p s v p p s v where k s h and k p s v out of plane and in plane dynamic stiffness matrices of the site respectively u s h p s h and u p s v p p s v displacements and load vectors subjected to out of plane and in plane waves respectively it should be noted that the classic 1d wave propagation theory is focused on the ground motion amplification of onshore sites by exploring the relationships between the displacement amplitudes at the surfaces of various layers while it is not applicable for the offshore sites recently the authors li et al 2016 2017a b conducted a series of investigation on the ground motion amplification of offshore sites on the theoretical basis of the traditional 1d wave propagation theory by considering the impacts of seawater on the seismic p wave propagation in offshore sites the dynamic stiffness matrices of seawater and subsea soil layers were derived and the detailed process is referred to li et al 2016 to incorporate the effect of water saturation in porous soil layers the p wave velocity v p and poisson s ratio ν of offshore soils can be estimated by yang and sato 2000 12 v p λ 2 g α 2 m ρ 13 ν α 2 m g 2 ν 1 2 ν 2 α 2 m g 1 1 2 ν where ρ density of porous soils g and ν shear modulus and poisson s ratio of the soil skeleton λ lame constant and α and m coefficients depending on the soil properties for a multi layered offshore site i e the combination of a base rock multiple offshore soil layers and a seawater layer the total dynamic stiffness matrix can be acquired by assembling the element stiffness matrix of each layer thus the dynamic equilibrium equations of an offshore site are obtained using the same form of eq 11 furthermore the gmtfs denoted by h x i ω h y i ω and h z i ω in the three directions at different positions within the offshore site can be computed by solving eq 11 at discrete frequencies based on the common assumption that seismic s wave cannot be transmitted in water the gmtfs determined by the out of plane sh waves i e h y i ω will not be affected by seawater or pore fluids li et al 2016 3 4 ground motion simulation and numerical cases by multiplying the defined base rock psd function with the computed gmtfs at discrete frequencies the psd functions of seismic motions within a layered offshore site can be calculated the matrix for cross psd functions of memoss at multiple positions can be assembled by further introducing the selected coherence function it should be noted that the generated cross psd function matrix for the memoss is hermitian and positive definite thus it can be decomposed by the choleskey method and the memoss can be finally generated using the classical spectral representation method hao et al 1989 bi and hao 2012 it should be noted that the simulation approach proposed in hao et al 1989 and bi and hao 2012 is only applicable for generating spatial ground motions on base rock sites or multiple layered onshore sites but neglects the influences of offshore site on the propagation of seismic waves in this study the synthesized memoss can not only take full consideration of the wave passage and coherency loss effects through the coherence function but also include the local site amplification effect at any position within an offshore site via the theoretically computed gmtfs thereby with such generated memoss the seismic responses of pipelines can be more reasonably and accurately assessed compared with the traditional pipeline seismic analysis methods using the uniform onshore motions as inputs to examine the influences of spatial variability parameters of ground motion and free span length on the seismic behaviors of free spanning submarine pipelines a total of 11 different analytical cases are designed for the nonlinear time history analyses as presented in table 5 note that the outer diameter wall thickness and buried depth are considered as the basic parameters of pipeline and remained the same in all analytical cases specifically case 1 is regarded as a benchmark case that using the generated intermediately correlated memoss within the offshore site illustrated in fig 2 while the other 10 analytical cases are taken as comparative cases to identify the authentic role of different variables in the dynamic behaviors of the pipelines case 2 represents the uniform excitation case in which the offshore motions generated at the first node of the pipeline i e the leftmost point in fig 5 are employed as inputs at all of the free ends of soil springs along the entire model in case 3 an onshore site is developed by removing the seawater layer replacing the 20 medium sand layer by a 20m soft rock layer and reducing the saturation degrees of the porous soils on the basis of the offshore site defined in case 1 in cases 4 and 5 the coherency loss extents of the memoss are changed to highly and weakly respectively in cases 6 7 and 8 the fine sand layer of the offshore site in case 1 are respectively replaced by the silty clay clay and heterogeneous fine sand and clay while the thickness of the soil layer 30m is maintained finally the free span lengths of cases 9 10 and 11 are adjusted to 30 50 and 60 m with the lengths of shoulder remaining three times of the corresponding free span lengths table 6 provides additional comparison of the properties between different soil layers it should be pointed out that it will be fairly time consuming to consider the spatial variation of seismic motions at each free end of soil springs along the pipeline model to balance the computational cost and analytical accuracy these soil springs are divided into 10 groups and an array of representative points rps are assigned to these groups to conveniently characterize the spatial seismic motions as schematically shown in fig 6 it is assumed that all of the soil spring free ends in a same group have the same seismic motion characteristics with the corresponding rp while the spatial variations between ground motions at different rps are considered in addition convergence test is performed to study the influence of distance between rps on the pipeline responses it is found that the seismic responses are basically unchanged when the rp spacing is less than 30m the resulting differences in terms of stress and displacement response at the free span are less than 3 when the rp spacing decreases from 30m to 2m hence it is reasonable to use 30m rp spacing in the numerical simulation which is employed in all of the cases to generate memoss and perform the seismic response analyses of the exemplar pipeline taking the rp 5 as an example figs 7 and 8 display the comparison of the three dimensional gmtfs between the offshore case 1 and onshore case 3 sites and among different offshore site conditions cases 1 6 and 7 respectively all of the gmtfs are computed for the underground locations of the pipeline namely 1 5 m beneath the seafloor it can be observed from fig 7 that the seismic motions at base rock free surface are magnified by the offshore and onshore sites at the corresponding site vibration frequencies in the horizontal directions two transfer functions i e h x i ω and h y i ω of the softer offshore site are slightly higher than those of the onshore site in the vertical direction the transfer function h z i ω of the onshore site is evidently higher than that of the offshore this is because the vertical seismic motions are dominated by the p wave which are considerably suppressed by the overlying seawater especially near the p wave resonant frequency of the seawater layer of 13 6 hz as shown in fig 8 all of the three offshore sites amplify the base rock motions at the corresponding site vibration frequencies moreover an interesting observation can be made that the transfer functions in three directions gradually increase with the decrease of the soil stiffness considering the randomness of seismic motions without losing generality a total of 7 sets of memoss in each analytical case are simulated to calculate the average seismic responses of the pipeline to better understand the simulation results the generated three dimensional acceleration time histories of different rps in case 8 for example are displayed in fig 9 it is observed that the acceleration time histories of different rps along the pipeline are obviously different in the three directions which indicates that the spatial variations of seismic motions have been considered adequately additionally the peak ground accelerations pgas of seismic motions at rps 1 and 10 i e firm soil condition are much lower than those at rps 5 and 6 i e softer soil condition this may be explained by the distinct gmtfs of different soil conditions as shown in fig 8 this simulation approach of memoss has been validated by identifying the desired agreements between the psds of the generated seismic motions and the corresponding target psd however the comparisons are not presented here because of space limitations 4 numerical results and discussions for the developed numerical model of the pipeline a series of nonlinear time history analyses are carried out for different analytical cases by adopting the corresponding generated memoss as seismic inputs based on the accessible simulation techniques in abaqus the material model of the pipeline is realized by the von mises isotropic hardening model and the implicit dynamic solver is employed to estimate the structural seismic behaviors the horizontal x component ax y component ay and vertical z component az of seismic motions are respectively used as inputs aligning with the axial transverse and vertical directions of the pipeline with a scaled pga of 0 2 g for the ax to obtain a preliminary understanding of the seismic responses of the pipeline the numerical results of the benchmark case i e case 1 are preferentially analyzed and summarized fig 10 presents the time evolution of the seismic responses of the pipeline along the axial direction under a typical set of memoss in case 1 as stated above the dynamic behaviors of the free span is the principal concern in this research and only the seismic responses of the free span and its adjacent area are thus depicted and investigated for simplicity specifically the locations of 0 m and 40 m represent the origin and end of the free span it can be seen clearly from fig 10 a that three maximum mises stresses appear throughout at the origin middle and end of the free span within the duration of 20 s and even larger at the ends this is because both the ends of the free span are situated in the junction between the suspended portion and buried portion of the pipeline which results in the contact mutation in these two positions this observation indicates that the middle and ends of the free span are the relatively weak regions of the free span pipeline more attentions should be paid to these regions once the free spans emerge in submarine pipelines as for the vertical displacement in fig 10 b an obvious variation trend is captured that during the whole seismic excitations the displacement response has the maximum value at the middle of the free span and gradually decreases towards to the two ends and finally remains stable at the pipeline shoulders this may be expected since the deformation of the pipeline shoulders is violently restricted by the soil springs and the restrain effect of soil springs on the free span is weakened progressively from both the ends to the middle in fig 11 the envelope and average curves of the peak seismic responses of the pipeline under 7 sets of memoss are plotted it is easy to find that for both the stress and displacement responses there exist substantial gaps between upper and lower envelope curves which indicate that the seismic responses of the pipeline are significantly sensitive to the input seismic motions thus it is reasonable and necessary to consider the uncertainty of seismic motions and take three to four sets of seismic motions to acquire structural average responses which is also in accordance with most seismic codes e g the chinese seismic design code gb50011 2010 the distributions of peak mises stress and vertical displacement respectively present the forms of crown and inverted ω along the pipeline length and they are asymmetric on both sides of the middle of the free span with slight difference this can be explained that the seismic inputs of both the pipeline shoulders are different when considering the spatial variations of seismic motions as described in section 3 note that those peak mises stresses are much lower than the yield stress i e 485 mpa showing that the pipeline remains elastic under the pga of 0 2g the primary design pursuit for submarine pipelines is the safe and reliable operation currently there are two types of main design criteria in majority of pipeline design codes stress based design and strain based design triantafyllaki et al 2020 notably the stress based design has been employed in most existing pipelines operating around the world in this design criterion the equivalent von mises stress in pipelines is required not to exceed the specified minimum yield stress smys to ensure the efficient operation of pipelines the smys is equal to 485 mpa for the api x70 pipeline which is adopted as the failure threshold of the free spanning submarine pipeline in the present study to further estimate the seismic performance of the pipeline in case 1 the ida analyses are then performed with the increments of 0 1g at low pga values and 0 01g when achieving the failure pga fig 12 displays the ida analysis results in terms of the pga and maximum peak mises stress the failure pga is defined as the pga corresponding to the onset of the mises stress exceeding smys first it is illustrated from this figure that the failure pgas vary over a wide range 0 45g 0 77g which highlights the significant impact of the uncertainty of seismic motions on the seismic performance of the pipelines again the average failure pga is 0 67g which is determined as the critical bearing capacity of the pipeline in case 1 4 1 influences of multi support excitation and offshore motions it is well acknowledged that the non uniform seismic excitation and offshore seismic motions are two critical influence factors with regard to the seismic responses of large span offshore structures to clarify the impact of memoss on the seismic behaviors of the free spanning pipeline cases 1 2 and 3 are therefore investigated respectively it should be noted that the only difference among the three cases is the seismic excitation type i e the non uniform offshore seismic excitation for case 1 uniform offshore seismic excitation for case 2 and non uniform onshore seismic excitation for case 3 the average peak seismic responses of cases 1 2 and 3 are compared in fig 13 clearly the peak seismic responses of the free span have the same variation trend along the pipeline length in these three cases but obviously highest in case 3 and lowest in case 2 compared to case 1 the maximum peak mises stress and vertical displacement reduce to 246 17 mpa and 0 54 m with the percentage decreases of 14 81 and 16 92 in case 2 while they increase to 315 33 mpa and 0 71 m with the percentage increases of 9 12 and 9 23 in case 3 respectively notably the response differences between cases 1 and 2 can be expected since the superposition effect of wave passage and coherency loss along the pipeline length may amplify the structural dynamic responses as for the response differences between cases 1 and 3 it is easy to understand because the transfer function h z i ω of the onshore site is fairly higher than that of the offshore site as presented in fig 7 c moreover the higher site amplification factor would result in the strong seismic intensities thereby yielding larger dynamic responses furthermore the comparative average ida curves of the pipeline in cases 1 2 and 3 are plotted in fig 14 as shown the response difference of the pipeline subjected to offshore and onshore seismic motions exhibits more obvious under higher pga values compared to case 1 the failure pga of the pipeline becomes 0 81g with the percentage increase of 20 89 in case 2 and 0 54g with the percentage reduce of 20 63 in case 3 respectively these observations reveal that the non uniform offshore seismic excitation can significantly affect the seismic behaviors of the free spanning pipelines both adopting the uniform and onshore seismic excitation can lead to misestimates of the seismic responses and thus erroneous guidelines for the seismic design of pipelines consequently to obtain actual seismic behaviors the memoss synthesized based on the simulation approach described in section 3 should be given priority in seismic analysis of the free spanning submarine pipelines 4 2 influence of coherence loss since the coherence loss effect plays an important role in the simulation of memoss its influence on the dynamic responses and critical bearing capacity of the pipeline are investigated illustrated in figs 15 and 16 as shown in fig 15 a and b the peak seismic responses have a similar variation trend that the minimum and maximum response values at different locations always occur in cases 4 and 5 respectively notably compared to case 1 the maximum peak mises stress and vertical displacement corresponding to the highly coherence loss case 4 are respectively 272 79 mpa and 0 61 m with the percentage reduces of 5 60 and 6 15 and they become 319 91 mpa and 0 72 m with the percentage increases of 10 70 and 10 05 when the weakly coherence loss case 5 is considered this implies that the seismic responses of the pipeline decrease in general with the increase of coherency loss level by observing the ida analysis result shown in fig 16 it is found that obvious gaps exist among these average ida curves and the differences of the failure pga between different cases are considerably pronounced the failure pgas for cases 4 and 5 are 8 95 higher and 28 89 lower than that for case 1 respectively these numerical results indicate that the coherence loss effect has a significant influence on the seismic behaviors on the free spanning pipeline and the lower the coherency loss level is the higher the probability of the pipeline undergoing seismic damage accordingly to reliably predict the seismic performance of the pipeline the appropriate coherency loss effect should be defined based on the practical field data to generate the reasonable memoss 4 3 influence of local site conditions in the offshore site the submarine pipeline may be buried in different types of homogeneous site or a heterogeneous site including different soil conditions to study the influence of local site conditions on the dynamic responses of the pipeline the peak mises stress and vertical displacement for cases 1 6 7 and 8 are compared in fig 17 a and b respectively as expected for the homogeneous site conditions both the mises stress and vertical displacement at any location of the pipeline increase with the decrease of soil stiffness i e the softer the site conditions are the higher the seismic responses specifically compared to case 1 firm fine sand the maximum peak mises stress and vertical displacement of the pipeline increase to 309 17 mpa and 0 81 m in case 6 softer silty clay and they continue to increase to 350 08 mpa and 1 08 m in case 7 softest clay respectively three reasons may result in these increases the first one is that a softer soil condition leads to the higher amplitudes of the gmtfs of the site see fig 8 and thus the severer seismic inputs which would eventually cause larger seismic responses of the pipeline the second reason is that softer soil conditions have smaller soil spring stiffness with the weaker restrain effect which may thus lead to the more violent seismic responses of the pipeline the third reason is that softer soil conditions have lower fundamental frequencies and they are closer to the fundamental frequencies of the pipeline which may amplify the structural responses more significantly due to the resonance effect as for case 8 the heterogeneous site it is found that the seismic response of the free span are extremely close to those in case 7 this is easy to understand because the site condition of the pipeline shoulders near the free span is the same in cases 7 and 8 moreover the slight gaps of the response curves in these two cases may be attributed to the differences of the site condition of the pipeline shoulders far from the free span to further discuss the influence of local site conditions on the critical bearing capacity of the pipeline the average ida results for different analytical cases are presented in fig 18 it is obvious to see that the failure pga of the pipeline reduces gradually with the site condition becoming soft with respect to the fine sand the failure pga for the silty clay and clay are 0 56g and 0 47g with the percentage decreases of 16 41 and 29 85 respectively similar to the seismic responses only tiny difference exists for the failure pgas between cases 7 and 8 this analysis suggests that the free spanning pipeline becomes comparatively more vulnerable to the memoss when buried in softer soil conditions in summary the local site conditions have prominent influence on the dynamic behaviors of the pipeline subjected to the seafloor seismic loads additionally to minimize the risk of pipeline failure during earthquake events it should avoid to installing submarine pipelines in soft soil as much as possible in practical engineering 4 4 influence of free span lengths due to the scouring effect of seafloor the free span length of the pipeline may change with time it is of extreme importance to study the influence of the free span length on the dynamic responses of the pipeline fig 19 a and b display the comparisons of the peak mises stress and vertical displacement for four different analytical cases i e l p 30 40 50 and 60 m respectively it should be noted that to more conveniently show the response differences between different cases the normalized x axis is used here to represent the relative positions along the pipeline despite of different free span lengths the dangerous regions of the pipeline always occur at the middle and ends of the free span it can be also found from this figure that the seismic responses of the pipeline are enlarged with increasing the free span length the peak vertical displacement for instance corresponding to the length from 30 m to 60 m are 0 28 m 0 65 m 1 01 m and 1 40 m with an almost linear increase these results can be derived from the following reasons that 1 the increase of the free span length directly boosts the initial responses of the pipeline under gravity load 2 the increase of the free span length reduces the coherency loss level between both the pipeline shoulder thereby amplifying the seismic response of the pipeline and 3 the increase of the free span length raises the inertia force i e added mass of to the pipeline exerted by seawater and thus cause the larger seismic response of the pipeline in fig 19 a it is clear to see that as the free span length increases the maximum peak mises stress rapidly approaches the allowable stress value in additional when the free span length reaches 60 m the corresponding maximum peak mises stress i e 493 24 mpa has been slightly higher than the smys of 485 mpa these results imply that the development of the free span length may account for higher failure hazards of the pipeline and once the free span length reaches or exceeds a specific value the free spanning pipeline may be damaged by the offshore seismic motions even under a relatively small pga as a result design engineers need to take the influences of the free span length on the seismic performance of submarine pipelines in their design moreover to protect the pipeline from earthquake damage it is recommended 1 to install submarine pipelines in the flat seafloor regions to avoid the emergence of free spans and 2 to take effective measures for the existing free spans to prevent their arbitrary development 5 conclusions this investigation presents comprehensive numerical results concerning the seismic behaviors of free spanning submarine pipelines subjected to memoss the nonlinear soil springs and added mass methods are employed to consider the soil pipe and water pipe interactions respectively the influences of multi support excitation offshore motions coherency loss local site conditions as well as free span length of pipeline are explicitly considered some significant conclusions can be drawn from the numerical results 1 the middle and ends of the free span are the relatively weak regions of the free spanning submarine pipeline under seismic actions 2 the uncertainty of the seismic motion inputs has a significant influence on the seismic behaviors and should be taken into account in seismic analysis of the submarine pipelines 3 the non uniform seismic excitations can significantly affect the seismic behaviors of free spanning submarine pipelines compared to the non uniform seismic excitations adopting the uniform seismic excitations may underestimate the seismic responses up to 16 92 and overestimate the critical bearing capacity as much as 20 89 of the pipeline respectively 4 in contrast to the offshore seismic motions adopting the onshore seismic motions may overestimate the seismic responses with a maximum of 9 23 and underestimate the critical bearing capacity up to 20 63 of the pipeline respectively 5 both the coherence loss and local site conditions has a significant effect on the seismic behaviors of free spanning submarine pipelines the lower the coherence loss level and soil stiffness are the higher the seismic responses and the lower the critical bearing capacity are 6 the free span length plays an important role in the seismic design of submarine pipelines the development of the free span length can increase the seismic responses and weaken the critical bearing capacity of free spanning submarine pipelines credit authorship contribution statement haiyang pan formal analysis investigation writing original draft hong nan li supervision writing review editing chao li conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research was financially supported by the national natural science foundation of china under awards no 51808099 no 52078106 and the fundamental research funds for the central universities grant no dut20rc 3 005 
20292,due to the shortage of offshore seismic records and inhere difficulty in simulating artificial offshore ground motions numerous existing works have been performed to investigate the seismic responses of free spanning submarine pipelines not only using onshore seismic records as inputs but also adopting uniform seismic excitations these analytical schemes may result in severe misestimates of the seismic responses in this content this paper numerically investigates the seismic behaviors of a free spanning submarine pipeline by using multi support earthquake motions within offshore sites memoss as inputs the soil pipe and water pipe interactions are modeled using the nonlinear soil spring and added mass methods respectively the effects of spatially varying and overlying seawater are explicitly taken into account in the simulation of memoss the seismic behavior law of the free spanning submarine pipeline under the synthesized memoss is analyzed and summarized moreover the impacts of the seismic excitation type offshore seismic motion coherence loss local site condition and free span length on the mises stress vertical displacement and failure pga of the submarine pipeline are examined and discussed comprehensively numerical results show that the middle and ends of free span are the dangerous regions and the memoss coherence loss local site condition and free span length have significant influences on the seismic responses and operational capacity of the pipeline based on the obtained results some meaningful advices are recommended to the pipeline designers that 1 more attentions should be paid to the middle and ends of free span in the pipeline design 2 the memoss should be adopted as seismic inputs to accurately predict the seismic behaviors of pipelines 3 the construction of submarine pipelines in soft clay and formation of large dimensional free span are adverse for the safe operation of pipelines under earthquake actions which should be avoided in engineering practice keywords submarine pipelines free spans seawater memoss seismic behavior 1 introduction as an important offshore infrastructure submarine pipelines play an irreplaceable role in the long distance transportation of raw hydrocarbon fluids e g oil and gas from the subsea fields to offshore floating platforms due to scouring or unevenness of the seafloor submarine pipelines whether buried in or directly laid on the seafloor will inevitably traverse areas with the irregular seafloor topography in that scenario there may exist suspend segments in the pipeline out of contact with the seafloor and such a distance between two suspension points is generally called free spanning pipeline moe et al 1986 as described in fig 1 free spans may cause extremely unfavorable operating conditions in complex subsea environment and are usually considered as the essential ingredient in the universal design practice of submarine pipelines shabani et al 2017 as recommended by the governing codes e g det norske veritas dnv dnv rp f105 2006 vortex induced vibration viv is treated as the primary design loading for the dynamic analysis of free spanning submarine pipelines as a catastrophic disaster earthquakes can however indeed pose an unpredictable threat to the safe operation of free spanning pipelines especially those installed in strong seismically active areas zhang et al 2019 additionally once submarine pipelines are damaged during earthquakes the leakage of hydrocarbon fluids will cause nasty ocean environmental pollution costly seabed restoration and tremendous economic losses following the above premises it is of significant importance to investigate the seismic responses of free spanning submarine pipelines for the sensible design and effective operation of pipeline systems against earthquakes so far viv is still recognized as the common concern in the response analysis of free spanning submarine pipelines and has attracted increasing attention from researchers over the past few decades numerous valuable works e g furnes and berntsen 2003 yang et al 2008 huang et al 2010 song et al 2011 dai et al 2013 choi 2001 shabani et al 2017 have been completed to explore the viv behavior of free spanning pipelines these researches indicated the free spans are susceptible to viv thereby resulting in the pipeline fatigue damage especially in the case where the vortex shedding frequency is in proximity to the fundamental vibration frequency of pipeline it is noteworthy that due to different frequency content incentive mechanism and action duration the dynamic behaviors of free spanning pipelines under seismic excitations may considerably differ from those under vivs however the available literature addressing the seismic responses of free spanning submarine pipelines is relatively limited nath and soh 1978 theoretically analyzed the harmonic and seismic responses of subsea pipelines in proximity to the seabed based on the finite element fe method using the frequency domain spectral method the transverse responses of free spanning offshore pipelines subjected to random seismic motions were investigated by datta and mashaly 2010 kalliontzis 1998 numerically examined the dynamic behaviors of submarine pipelines connected to a moving seabed under vertical seismic motions based on fe analysis zhou et al 2008 performed nonlinear seismic analysis for free spanning submarine pipelines under spatially variable seismic excitations with inclusion of soil pipe interaction zeinoddini et al 2012 investigated the dynamic responses of free spanning submarine pipelines subjected to severe seismic excitations by different simplified methods including the added mass and acoustic approaches the research on vibration control of free spanning submarine pipelines is carried out by bi and hao 2016 by designing the pipe in pipe system as a structure tuned mass damper system on the basis of underwater shaking table tests li et al 2002 2013 and zhou et al 2005 experimentally investigated the responses of free spanning subsea pipelines under dynamic excitations these investigations show that severe seismic motions can cause devastating damage to free spanning submarine pipelines which should not be neglected in the dynamic analysis and original design it should be noted that all the aforementioned investigations were implemented by adopting the onshore ground motions as seismic inputs to the best knowledge of the authors the seismic responses of free spanning submarine pipelines under offshore seismic excitations have not been reported this is mainly attributed to the extreme shortage of offshore earthquake records and inherent difficulty in generating the artificial offshore seismic motions boore and smith 1999 due to different wave propagation characteristics previous studies bi et al 2017 li et al 2018a zuo et al 2019 have demonstrated that the structural seismic responses subjected to offshore earthquake motions may significantly differ from those under onshore seismic excitations specifically the seawater layer can directly suppress the seafloor vertical motions near the p wave resonant frequencies of the overlying seawater crouse and quilter 1991 li et al 2016 while it can also indirectly affect the p wave propagation in the offshore sites by altering the water saturation condition and poisson s ratio of seabed soils boore and smith 1999 chen et al 2015 these direct and indirect impacts of overlying seawater naturally result in very variant frequency and amplification contents between offshore and onshore seismic motions therefore to obtain accurate seismic response predictions of free spanning submarine pipelines the seismic motions at offshore sites should be used as seismic inputs instead of arbitrarily adopting onshore earthquake records another critical issue in seismic response studies on the submarine pipelines is the significant effect of spatial variations of earthquake excitations in practice the seismic motion experiences at different locations of large span structures may considerably differ from each other due to the wave passage incoherence and local site effects hao et al 1989 bi and hao 2012 kiureghian 2015 although the effect of spatially varying ground motions on the seismic responses of some typical large span structures has been highlighted in previous studies ates et al 2005 yu et al 2013 tarinejad et al 2013 li et al 2018a 2018b 2018b yan et al 2018 very limited research works report the seismic behaviors of submarine pipelines under multi support earthquake excitations only zhang et al 2019 investigated the random vibration of free spanning subsea pipelines subjected to spatially varying ground motions however their research placed main focus on addressing the modeling uncertainty of subsea pipelines and failed to well clarify how the spatial variations of ground motions affect the seismic responses more importantly their research adopted the simulated onshore spatially varying motions as inputs and the influences of seawater layer and subsea soils on the ground motion amplification were ignored therefore there still exist large research gaps in investigating the seismic behaviors of free spanning submarine pipelines under multi support earthquake motions within offshore sites memoss to fill up these research gaps this paper develops a seismic response analysis method for the free spanning submarine pipelines by using the generated memoss as inputs to achieve this purpose the remainder of this paper is organized as follows in section 2 a typical free spanning submarine natural gas pipeline is described and the corresponding 3d fe numerical modeling is established in abaqus where the soil pipe and water pipe interactions are modeled using the nonlinear soil springs and added mass methods respectively in section 3 an approach for stochastically synthesizing memoss is introduced in section 4 the seismic behavior law of the free spanning submarine pipeline subjected to memoss is analyzed and the impacts of the seismic excitation type offshore seismic motion coherence loss local site condition and free span length are discussed the conclusions drawn from the analysis results are finally summarized in section 5 2 pipeline description and numerical modeling 2 1 overview of the free spanning pipeline as shown in fig 2 a typical free spanning natural gas pipeline of api x70 buried in seafloor is selected as the research object the straight pipeline is characterized by a single layer steel pipe with outer concrete coating and is full with flowing natural gas specifically the steel pipe owns a circular hollow cross section with an outer diameter d s of 480 mm and a wall thickness t s of 12 mm the thickness of the concrete coating t c is 60 mm note that the effect of concrete coating is limited to increasing the structural mass while the positive effect on the structural stiffness is disregarded herein kalliontzis 1998 more detailed information concerning the material properties of the steel pipe is tabulated in table 1 the length of the free span l p is 40 m since the focus of this investigation is placed on the seismic behaviors of free span it is of prominent importance to select a legitimate shoulder length l s to balance the analytical accuracy and computational efficiency the previous study by vedeld et al 2013 has indicated that the influence of boundary conditions on dynamic responses of the free span could be basically eliminated by choosing the shoulder length with three times of the free span length i e l s 3 l p 120 m moreover a total of four different subsea soil layers are involved for the exemplar offshore site i e the fine sand medium sand soft rock and base rock from top to bottom and the pipeline is embedded in the layer of fine sand with a buried depth a distance from seafloor surface to the center line of the pipeline cross section of 1 5 m not to complicate the analysis problem it is assumed that the pipeline within the shoulder length is embedded with an identical buried depth and without regard for the undulation of seafloor surface the geometric thickness and property parameters of each soil layer as well as the seawater are also described in fig 2 in which k and v bulk modulus and poisson s ratio of seawater g v n s r ϕ and c shear modulus poisson s ratio porosity saturation degree internal friction angle and cohesion of soil ρ and ξ density and damping ratio respectively 2 2 soil pipe and water pipe interactions it is widely acknowledged that the dynamic response of buried free spanning submarine pipelines see fig 2 is typical of a general class of soil structure fluid interaction problem hence it is of paramount importance to rationally deal with the displacement constraint of subsea soil on the pipeline shoulders contact zones i e soil pipeline interaction and the reaction force exerted by seawater on the suspend pipelines i e water pipeline interaction it has been demonstrated that nonlinear soil springs in association with equivalent dashpots have the capacity of describing the soil pipe interaction larsen et al 2016 c li et al 2017a liu et al 2019 which are adopted in the current study as for the water pipeline interaction the added mass method zou et al 2005 zhu et al 2008 bi and hao 2016 is a feasible way to address this issue 2 2 1 soil pipeline interaction modeling the surrounding soil domain of the pipeline is discretized into a host of three mutually perpendicular i e in the directions of axial transverse and vertical directions nonlinear soil springs bilinear type curves with the corresponding equivalent dashpots as shown in fig 3 for generality the shaft friction resistance inflicted by the soil to pipeline is represented by the nonlinear springs in the direction parallel to the pipeline while the nonlinear springs in two directions perpendicular to the pipeline are used to describe the lateral constraints of the soil against pipeline deformation the mechanical behaviors force displacement relation of these nonlinear springs heavily relies on the soil properties and pipeline dimension and generally are defined by the elastic perfectly plastic curves which are mainly governed by the maximum soil spring forces and associated relative displacements as plotted in fig 4 specifically the elastic perfectly plastic curves blue dashed lines in fig 4 are a simplification of those generic load displacement relation red solid lines in fig 4 summarized based on extensive laboratory and field experimental investigations both the required parameters can be obtained according to the calculation guidelines provided by american lifeline alliance ala 2001 due to the constraints of space the descriptions with respect to those calculation guidelines are not given and concerned readers can find out more detailed information by referring to ala 2001 note that the force displacement curves of the nonlinear springs are exactly symmetric in axial and transverse directions whereas they are asymmetric in the vertical direction the obvious difference of vertical upward and downward soil spring stiffness is derived from the asymmetric nature of the soil thickness above and beneath pipeline for the equivalent dashpots the damping coefficients in axial and lateral vibrations of the pipeline can be determined by 1 c s a g s w r l v s 2 c s l g s u r l v s in which g shear modulus of soil r radius of the pipeline l length of the element v s shear wave velocity of soil and s w and s u dimensionless soil damping parameters which can be referenced from hindy and novak 2010 table 2 tabulates the basic backbone parameters of nonlinear springs and equivalent dashpots corresponding to the soil condition in fig 2 2 2 2 water pipeline interaction modeling under seismic excitations the movement of pipeline relative to the surrounding seawater will impose accelerations to the seawater and the vibration of seawater can in turn induce the inertia force to the pipeline this water pipeline interaction can be equivalent to attach an added mass of seawater to the pipeline i e the added mass method also referred to as morison equation method morison et al 1950 in view of this the effective mass per unit length of free span can be determined by 3 m e m p m a where m p physical mass per unit length of free span and m a added mass per unit length of free span note that m a can be calculated by 4 m a c a π 4 ρ d 2 where c a added mass coefficient ρ seawater mass density which is equal to 1025 kg m³ and d outside diameter of pipeline generally c a can vary in a wide range between 0 and 1 29 bi and hao 2016 since it correlates with a variety of influencing factors such as the distance from pipeline free span to the seafloor surface roughness of pipeline and reynolds number dnv rp c205 2010 etc hence it is rather difficult to acquire the precise value of c a except by means of complex experimental tests and prototype observations not to complicate this problem c a is considered as unity with a constant of 1 0 in the present study it should be noticed that the use of the added mass method may result in slightly biased response prediction for the free spanning pipeline since this simplified method cannot precisely take into account the dynamic pressure of seawater especially under vertical seismic excitation chatterjee et al 2000 to obtain more accurate structural response estimations more elaborate analytical models e g the acoustic finite element numerical models proposed by zeinoddini et al 2012 might be good choices however it is worth noting that the added mass method may typically present relatively conservative seismic analysis results zeinoddini et al 2008 2012 which seems to be admissible for ensuring the design security of pipeline on the other hand since the main aim of the present study is to expound the influence of memoss on the seismic responses of free spanning submarine pipelines instead of water pipeline interaction the simplified added mass method is employed here to avoid complicating this problem 2 3 numerical modeling the seismic responses of free spanning submarine pipelines can be investigated numerically by using the advanced finite element code abaqus 2015 given that it is somewhat difficult to clearly present the entire fe model screening from abaqus due to the large geometric length the diagrammatic sketch of the developed 3d fe model of the exemplar pipeline is therefore illustrated in fig 5 in the numerical model the pipeline is described into two node three dimensional linear beam elements with six degrees of freedom at each node pipe31 in abaqus this kind of beam element is preferred to the analytical problems of thin walled structures with a large slenderness ratio which has been widely applied to the oil and gas pipelines e g lee et al 2009 joshi et al 2011 zhang et al 2019 to minimize the effect of the element size an element length of 0 5 m is employed herein along the axial direction of pipeline according to the guidance that the element length should be in approximation of the outer diameter of the pipeline dnv rp f105 2006 the free spanning pipeline model is therefore divided into 560 elements with 561 pipe nodes the soil spring dashpots representing the spi are modeled by means of the zero length connector elements conn3d2 in abaqus which can couple the pipe nodes with the corresponding offshore site nodes in particular these connector elements are generally defined by the cartesian type of connector sections comprising three components associated with the force behaviors and damping coefficients representing the spi abaqus 2015 which can be achieved based on the calculation parameters given in table 2 to consider the added mass the point mass element consisting of three translational degrees of freedom in abaqus is adopted and each pipe node at the free span is attached with the calculated added mass i e the pink points in fig 5 as declared above a shoulder length of three times of the free span length has been determined to ensure that the dynamic response is not affected by the boundary conditions hence the pipeline is conveniently assumed to be simply supported at the pipeline edges as suggested in design codes dnv rp f105 2006 and previous studies sollund et al 2014 larsen et al 2016 the mass density of steel ρ s is 7850 kg m³ due to the existence of the seawater concrete coating and natural gas an equivalent mass density ρ s e is assigned to the steel pipe section 5 ρ s e ρ s ρ g d s 2 t c 2 ρ c d s 2 t c 2 d s 2 ρ d s 2 t c 2 d s 2 d s 2 t s 2 where ρ c and ρ g mass density of concrete coating 2350 kg m³ and natural gas 200 kg m³ respectively considering a safety factor of 0 72 asme b31 8 2007 the internal pressure p i of natural gas inside the pipeline is immediately determined by the following formula 6 p i 0 72 2 σ y t d p e in which p e external pressure of pipeline caused by the surrounding seawater the geometrical non linearity problem i e large deformation of the pipeline can be addressed by turning on the nlgeom option in abaqus normally the bilinear isotropic hardening plasticity backbone model shi et al 2011 is a feasible option to capture the expected nonlinear behaviors of pipe elements additionally the backbone constitutive model i e the nonlinear true stress vs strain curve of the x70 pipe steel can be obtained based on the corresponding parameter values given in table 1 the overall damping of the free spanning submarine pipelines is primarily composed of structural damping and hydrodynamic damping given that the pipeline is typically fabricated by a composite material i e the inner steel pipe and outer concrete coating the structural damping is assumed to be 3 in the present study according to the recommendation in the reference kalliontzis 1998 moreover the hydrodynamic damping of seawater is assumed to be 1 5 following li et al 2015 and zuo et al 2019 summing up these two values the overall damping ratio is taken as 4 5 finally the damping of the pipeline is characterized by applying the assumed damping ratio to the material properties with the aid of rayleigh damping model as suggested by mina et al 2020 the mass proportional and stiffness proportional rayleigh damping coefficients are calculated using the first and third circular vibration frequencies of the pipeline an eigenvalue analysis is subsequently performed following the developed numerical model using the lanczos algorithm in abaqus the first seven vibration frequencies and the corresponding vibration modes are tabulated in table 3 3 simulation approach of memoss to realistically predict the seismic behaviors of free spanning submarine pipelines the three dimensional multi support earthquake motions within offshore sites memoss are statistically simulated and severed as seismic inputs at the free ends of soil springs considering the differences between offshore and onshore seismic motions it may be unsound to performed the seismic analysis of submarine pipeline using the synthetic onshore ground motions based on the classical simulation approaches e g bi and hao 2012 li et al 2015 recently li et al 2016 2017a b proposed an effective method concerning the simulation of seafloor seismic motions by considering the influence of seawater layer and subsea soil on the ground motion transfer functions gmtfs of offshore sites in the present study this simulation method is employed and further extended to generate the memoss which will be briefly introduced next 3 1 power spectral density function model in general the frequency and amplitude contents of seismic motions can be represented by the power spectral density psd function here it is assumed that the seismic motions at different positions of base rock have the identical intensity and frequency contents and the corresponding psd is characterized by the filtered tajimi kanai psd function with the following form 7 s g ω h p ω s 0 ω ω 4 ω f 2 ω 2 2 4 ξ f 2 ω f 2 ω 2 ω g 4 4 ξ g 2 ω g 2 ω 2 ω g 2 ω 2 2 4 ξ g 2 ω g 2 ω 2 s 0 where h p ω high pass filter function s 0 ω tajimi kanai psd function ω f ξ f and ω g ξ g central frequencies and damping rations of the tajimi kanai psd and high pass filter functions respectively s 0 scaling factor here the above parameters are assigned to be ω f 0 5π rad s ξ f 0 6 ω g 10π rad s ξ g 0 6 and s 0 0 0034 m2 s3 using which the generated ground motion time histories will possess a peak ground acceleration pga of 0 2 g and duration of t 20 s following the standard random vibration method der kiureghian 1980 it should be noted that the same psd function is applied to simulate the horizontal and vertical seismic motions of the base rock whereas the amplitude of vertical seismic motions is set to be 1 2 of horizontal seismic motions api 1993 3 2 coherency loss function model the empirical coherence model proposed by hao et al 1989 is selected to consider the coherency loss of seismic motions at the base rock in this model the coherency loss function between any two points is expressed by 8 γ a b i ω d a b e x p β d a b exp α ω d a b ω 2 π 2 e x p i ω d a b v a p p 9 α ω 2 π a ω b ω 2 π c 0 134 r a d ω 62 83 r a d 0 1 a 10 b c ω 62 83 r a d 10 v a p p v s c o s θ g b ρ b c o s θ in which d a b projected distance between any two points a and b aligning with the wave propagation direction a b c and β coherency loss coefficients v a p p apparent wave velocity v s g b and ρ b shear wave velocity shear modulus and density of the base rock respectively and θ incident angle of the seismic waves into the site the coherence loss function model presented by hao et al 1989 is achieved by analyzing the earthquake motions recorded by the strong motion array taiwan smart 1 specifically the parameters of a b c and β in the model that representing the highly coherency loss are obtained by the least square fitting approach using the recorded data during event 45 at the smart 1 array as listed in table 4 to model the different coherence degrees of spatial seismic motions the parameter values for intermediately and weakly coherency loss levels are further suggested by hao 1989 which are also given in table 4 here the three levels of coherency loss are employed to assess its impact on the seismic behavior of free spanning pipelines 3 3 ground motion amplification of offshore sites as assumed in the 1d wave propagation theory wolf 1985 the seismic waves are composed of out of plane shear horizontal sh wave and in plane coupled pressure p and shear vertical sv waves these seismic waves incident from the base rock into the overlying soil with an incident angle and then propagate upwards through different soil layers for a site with multi layered soils the dynamic equilibrium equations in the frequency domain can be expressed by 11 k s h u s h p s h and k p s v u p s v p p s v where k s h and k p s v out of plane and in plane dynamic stiffness matrices of the site respectively u s h p s h and u p s v p p s v displacements and load vectors subjected to out of plane and in plane waves respectively it should be noted that the classic 1d wave propagation theory is focused on the ground motion amplification of onshore sites by exploring the relationships between the displacement amplitudes at the surfaces of various layers while it is not applicable for the offshore sites recently the authors li et al 2016 2017a b conducted a series of investigation on the ground motion amplification of offshore sites on the theoretical basis of the traditional 1d wave propagation theory by considering the impacts of seawater on the seismic p wave propagation in offshore sites the dynamic stiffness matrices of seawater and subsea soil layers were derived and the detailed process is referred to li et al 2016 to incorporate the effect of water saturation in porous soil layers the p wave velocity v p and poisson s ratio ν of offshore soils can be estimated by yang and sato 2000 12 v p λ 2 g α 2 m ρ 13 ν α 2 m g 2 ν 1 2 ν 2 α 2 m g 1 1 2 ν where ρ density of porous soils g and ν shear modulus and poisson s ratio of the soil skeleton λ lame constant and α and m coefficients depending on the soil properties for a multi layered offshore site i e the combination of a base rock multiple offshore soil layers and a seawater layer the total dynamic stiffness matrix can be acquired by assembling the element stiffness matrix of each layer thus the dynamic equilibrium equations of an offshore site are obtained using the same form of eq 11 furthermore the gmtfs denoted by h x i ω h y i ω and h z i ω in the three directions at different positions within the offshore site can be computed by solving eq 11 at discrete frequencies based on the common assumption that seismic s wave cannot be transmitted in water the gmtfs determined by the out of plane sh waves i e h y i ω will not be affected by seawater or pore fluids li et al 2016 3 4 ground motion simulation and numerical cases by multiplying the defined base rock psd function with the computed gmtfs at discrete frequencies the psd functions of seismic motions within a layered offshore site can be calculated the matrix for cross psd functions of memoss at multiple positions can be assembled by further introducing the selected coherence function it should be noted that the generated cross psd function matrix for the memoss is hermitian and positive definite thus it can be decomposed by the choleskey method and the memoss can be finally generated using the classical spectral representation method hao et al 1989 bi and hao 2012 it should be noted that the simulation approach proposed in hao et al 1989 and bi and hao 2012 is only applicable for generating spatial ground motions on base rock sites or multiple layered onshore sites but neglects the influences of offshore site on the propagation of seismic waves in this study the synthesized memoss can not only take full consideration of the wave passage and coherency loss effects through the coherence function but also include the local site amplification effect at any position within an offshore site via the theoretically computed gmtfs thereby with such generated memoss the seismic responses of pipelines can be more reasonably and accurately assessed compared with the traditional pipeline seismic analysis methods using the uniform onshore motions as inputs to examine the influences of spatial variability parameters of ground motion and free span length on the seismic behaviors of free spanning submarine pipelines a total of 11 different analytical cases are designed for the nonlinear time history analyses as presented in table 5 note that the outer diameter wall thickness and buried depth are considered as the basic parameters of pipeline and remained the same in all analytical cases specifically case 1 is regarded as a benchmark case that using the generated intermediately correlated memoss within the offshore site illustrated in fig 2 while the other 10 analytical cases are taken as comparative cases to identify the authentic role of different variables in the dynamic behaviors of the pipelines case 2 represents the uniform excitation case in which the offshore motions generated at the first node of the pipeline i e the leftmost point in fig 5 are employed as inputs at all of the free ends of soil springs along the entire model in case 3 an onshore site is developed by removing the seawater layer replacing the 20 medium sand layer by a 20m soft rock layer and reducing the saturation degrees of the porous soils on the basis of the offshore site defined in case 1 in cases 4 and 5 the coherency loss extents of the memoss are changed to highly and weakly respectively in cases 6 7 and 8 the fine sand layer of the offshore site in case 1 are respectively replaced by the silty clay clay and heterogeneous fine sand and clay while the thickness of the soil layer 30m is maintained finally the free span lengths of cases 9 10 and 11 are adjusted to 30 50 and 60 m with the lengths of shoulder remaining three times of the corresponding free span lengths table 6 provides additional comparison of the properties between different soil layers it should be pointed out that it will be fairly time consuming to consider the spatial variation of seismic motions at each free end of soil springs along the pipeline model to balance the computational cost and analytical accuracy these soil springs are divided into 10 groups and an array of representative points rps are assigned to these groups to conveniently characterize the spatial seismic motions as schematically shown in fig 6 it is assumed that all of the soil spring free ends in a same group have the same seismic motion characteristics with the corresponding rp while the spatial variations between ground motions at different rps are considered in addition convergence test is performed to study the influence of distance between rps on the pipeline responses it is found that the seismic responses are basically unchanged when the rp spacing is less than 30m the resulting differences in terms of stress and displacement response at the free span are less than 3 when the rp spacing decreases from 30m to 2m hence it is reasonable to use 30m rp spacing in the numerical simulation which is employed in all of the cases to generate memoss and perform the seismic response analyses of the exemplar pipeline taking the rp 5 as an example figs 7 and 8 display the comparison of the three dimensional gmtfs between the offshore case 1 and onshore case 3 sites and among different offshore site conditions cases 1 6 and 7 respectively all of the gmtfs are computed for the underground locations of the pipeline namely 1 5 m beneath the seafloor it can be observed from fig 7 that the seismic motions at base rock free surface are magnified by the offshore and onshore sites at the corresponding site vibration frequencies in the horizontal directions two transfer functions i e h x i ω and h y i ω of the softer offshore site are slightly higher than those of the onshore site in the vertical direction the transfer function h z i ω of the onshore site is evidently higher than that of the offshore this is because the vertical seismic motions are dominated by the p wave which are considerably suppressed by the overlying seawater especially near the p wave resonant frequency of the seawater layer of 13 6 hz as shown in fig 8 all of the three offshore sites amplify the base rock motions at the corresponding site vibration frequencies moreover an interesting observation can be made that the transfer functions in three directions gradually increase with the decrease of the soil stiffness considering the randomness of seismic motions without losing generality a total of 7 sets of memoss in each analytical case are simulated to calculate the average seismic responses of the pipeline to better understand the simulation results the generated three dimensional acceleration time histories of different rps in case 8 for example are displayed in fig 9 it is observed that the acceleration time histories of different rps along the pipeline are obviously different in the three directions which indicates that the spatial variations of seismic motions have been considered adequately additionally the peak ground accelerations pgas of seismic motions at rps 1 and 10 i e firm soil condition are much lower than those at rps 5 and 6 i e softer soil condition this may be explained by the distinct gmtfs of different soil conditions as shown in fig 8 this simulation approach of memoss has been validated by identifying the desired agreements between the psds of the generated seismic motions and the corresponding target psd however the comparisons are not presented here because of space limitations 4 numerical results and discussions for the developed numerical model of the pipeline a series of nonlinear time history analyses are carried out for different analytical cases by adopting the corresponding generated memoss as seismic inputs based on the accessible simulation techniques in abaqus the material model of the pipeline is realized by the von mises isotropic hardening model and the implicit dynamic solver is employed to estimate the structural seismic behaviors the horizontal x component ax y component ay and vertical z component az of seismic motions are respectively used as inputs aligning with the axial transverse and vertical directions of the pipeline with a scaled pga of 0 2 g for the ax to obtain a preliminary understanding of the seismic responses of the pipeline the numerical results of the benchmark case i e case 1 are preferentially analyzed and summarized fig 10 presents the time evolution of the seismic responses of the pipeline along the axial direction under a typical set of memoss in case 1 as stated above the dynamic behaviors of the free span is the principal concern in this research and only the seismic responses of the free span and its adjacent area are thus depicted and investigated for simplicity specifically the locations of 0 m and 40 m represent the origin and end of the free span it can be seen clearly from fig 10 a that three maximum mises stresses appear throughout at the origin middle and end of the free span within the duration of 20 s and even larger at the ends this is because both the ends of the free span are situated in the junction between the suspended portion and buried portion of the pipeline which results in the contact mutation in these two positions this observation indicates that the middle and ends of the free span are the relatively weak regions of the free span pipeline more attentions should be paid to these regions once the free spans emerge in submarine pipelines as for the vertical displacement in fig 10 b an obvious variation trend is captured that during the whole seismic excitations the displacement response has the maximum value at the middle of the free span and gradually decreases towards to the two ends and finally remains stable at the pipeline shoulders this may be expected since the deformation of the pipeline shoulders is violently restricted by the soil springs and the restrain effect of soil springs on the free span is weakened progressively from both the ends to the middle in fig 11 the envelope and average curves of the peak seismic responses of the pipeline under 7 sets of memoss are plotted it is easy to find that for both the stress and displacement responses there exist substantial gaps between upper and lower envelope curves which indicate that the seismic responses of the pipeline are significantly sensitive to the input seismic motions thus it is reasonable and necessary to consider the uncertainty of seismic motions and take three to four sets of seismic motions to acquire structural average responses which is also in accordance with most seismic codes e g the chinese seismic design code gb50011 2010 the distributions of peak mises stress and vertical displacement respectively present the forms of crown and inverted ω along the pipeline length and they are asymmetric on both sides of the middle of the free span with slight difference this can be explained that the seismic inputs of both the pipeline shoulders are different when considering the spatial variations of seismic motions as described in section 3 note that those peak mises stresses are much lower than the yield stress i e 485 mpa showing that the pipeline remains elastic under the pga of 0 2g the primary design pursuit for submarine pipelines is the safe and reliable operation currently there are two types of main design criteria in majority of pipeline design codes stress based design and strain based design triantafyllaki et al 2020 notably the stress based design has been employed in most existing pipelines operating around the world in this design criterion the equivalent von mises stress in pipelines is required not to exceed the specified minimum yield stress smys to ensure the efficient operation of pipelines the smys is equal to 485 mpa for the api x70 pipeline which is adopted as the failure threshold of the free spanning submarine pipeline in the present study to further estimate the seismic performance of the pipeline in case 1 the ida analyses are then performed with the increments of 0 1g at low pga values and 0 01g when achieving the failure pga fig 12 displays the ida analysis results in terms of the pga and maximum peak mises stress the failure pga is defined as the pga corresponding to the onset of the mises stress exceeding smys first it is illustrated from this figure that the failure pgas vary over a wide range 0 45g 0 77g which highlights the significant impact of the uncertainty of seismic motions on the seismic performance of the pipelines again the average failure pga is 0 67g which is determined as the critical bearing capacity of the pipeline in case 1 4 1 influences of multi support excitation and offshore motions it is well acknowledged that the non uniform seismic excitation and offshore seismic motions are two critical influence factors with regard to the seismic responses of large span offshore structures to clarify the impact of memoss on the seismic behaviors of the free spanning pipeline cases 1 2 and 3 are therefore investigated respectively it should be noted that the only difference among the three cases is the seismic excitation type i e the non uniform offshore seismic excitation for case 1 uniform offshore seismic excitation for case 2 and non uniform onshore seismic excitation for case 3 the average peak seismic responses of cases 1 2 and 3 are compared in fig 13 clearly the peak seismic responses of the free span have the same variation trend along the pipeline length in these three cases but obviously highest in case 3 and lowest in case 2 compared to case 1 the maximum peak mises stress and vertical displacement reduce to 246 17 mpa and 0 54 m with the percentage decreases of 14 81 and 16 92 in case 2 while they increase to 315 33 mpa and 0 71 m with the percentage increases of 9 12 and 9 23 in case 3 respectively notably the response differences between cases 1 and 2 can be expected since the superposition effect of wave passage and coherency loss along the pipeline length may amplify the structural dynamic responses as for the response differences between cases 1 and 3 it is easy to understand because the transfer function h z i ω of the onshore site is fairly higher than that of the offshore site as presented in fig 7 c moreover the higher site amplification factor would result in the strong seismic intensities thereby yielding larger dynamic responses furthermore the comparative average ida curves of the pipeline in cases 1 2 and 3 are plotted in fig 14 as shown the response difference of the pipeline subjected to offshore and onshore seismic motions exhibits more obvious under higher pga values compared to case 1 the failure pga of the pipeline becomes 0 81g with the percentage increase of 20 89 in case 2 and 0 54g with the percentage reduce of 20 63 in case 3 respectively these observations reveal that the non uniform offshore seismic excitation can significantly affect the seismic behaviors of the free spanning pipelines both adopting the uniform and onshore seismic excitation can lead to misestimates of the seismic responses and thus erroneous guidelines for the seismic design of pipelines consequently to obtain actual seismic behaviors the memoss synthesized based on the simulation approach described in section 3 should be given priority in seismic analysis of the free spanning submarine pipelines 4 2 influence of coherence loss since the coherence loss effect plays an important role in the simulation of memoss its influence on the dynamic responses and critical bearing capacity of the pipeline are investigated illustrated in figs 15 and 16 as shown in fig 15 a and b the peak seismic responses have a similar variation trend that the minimum and maximum response values at different locations always occur in cases 4 and 5 respectively notably compared to case 1 the maximum peak mises stress and vertical displacement corresponding to the highly coherence loss case 4 are respectively 272 79 mpa and 0 61 m with the percentage reduces of 5 60 and 6 15 and they become 319 91 mpa and 0 72 m with the percentage increases of 10 70 and 10 05 when the weakly coherence loss case 5 is considered this implies that the seismic responses of the pipeline decrease in general with the increase of coherency loss level by observing the ida analysis result shown in fig 16 it is found that obvious gaps exist among these average ida curves and the differences of the failure pga between different cases are considerably pronounced the failure pgas for cases 4 and 5 are 8 95 higher and 28 89 lower than that for case 1 respectively these numerical results indicate that the coherence loss effect has a significant influence on the seismic behaviors on the free spanning pipeline and the lower the coherency loss level is the higher the probability of the pipeline undergoing seismic damage accordingly to reliably predict the seismic performance of the pipeline the appropriate coherency loss effect should be defined based on the practical field data to generate the reasonable memoss 4 3 influence of local site conditions in the offshore site the submarine pipeline may be buried in different types of homogeneous site or a heterogeneous site including different soil conditions to study the influence of local site conditions on the dynamic responses of the pipeline the peak mises stress and vertical displacement for cases 1 6 7 and 8 are compared in fig 17 a and b respectively as expected for the homogeneous site conditions both the mises stress and vertical displacement at any location of the pipeline increase with the decrease of soil stiffness i e the softer the site conditions are the higher the seismic responses specifically compared to case 1 firm fine sand the maximum peak mises stress and vertical displacement of the pipeline increase to 309 17 mpa and 0 81 m in case 6 softer silty clay and they continue to increase to 350 08 mpa and 1 08 m in case 7 softest clay respectively three reasons may result in these increases the first one is that a softer soil condition leads to the higher amplitudes of the gmtfs of the site see fig 8 and thus the severer seismic inputs which would eventually cause larger seismic responses of the pipeline the second reason is that softer soil conditions have smaller soil spring stiffness with the weaker restrain effect which may thus lead to the more violent seismic responses of the pipeline the third reason is that softer soil conditions have lower fundamental frequencies and they are closer to the fundamental frequencies of the pipeline which may amplify the structural responses more significantly due to the resonance effect as for case 8 the heterogeneous site it is found that the seismic response of the free span are extremely close to those in case 7 this is easy to understand because the site condition of the pipeline shoulders near the free span is the same in cases 7 and 8 moreover the slight gaps of the response curves in these two cases may be attributed to the differences of the site condition of the pipeline shoulders far from the free span to further discuss the influence of local site conditions on the critical bearing capacity of the pipeline the average ida results for different analytical cases are presented in fig 18 it is obvious to see that the failure pga of the pipeline reduces gradually with the site condition becoming soft with respect to the fine sand the failure pga for the silty clay and clay are 0 56g and 0 47g with the percentage decreases of 16 41 and 29 85 respectively similar to the seismic responses only tiny difference exists for the failure pgas between cases 7 and 8 this analysis suggests that the free spanning pipeline becomes comparatively more vulnerable to the memoss when buried in softer soil conditions in summary the local site conditions have prominent influence on the dynamic behaviors of the pipeline subjected to the seafloor seismic loads additionally to minimize the risk of pipeline failure during earthquake events it should avoid to installing submarine pipelines in soft soil as much as possible in practical engineering 4 4 influence of free span lengths due to the scouring effect of seafloor the free span length of the pipeline may change with time it is of extreme importance to study the influence of the free span length on the dynamic responses of the pipeline fig 19 a and b display the comparisons of the peak mises stress and vertical displacement for four different analytical cases i e l p 30 40 50 and 60 m respectively it should be noted that to more conveniently show the response differences between different cases the normalized x axis is used here to represent the relative positions along the pipeline despite of different free span lengths the dangerous regions of the pipeline always occur at the middle and ends of the free span it can be also found from this figure that the seismic responses of the pipeline are enlarged with increasing the free span length the peak vertical displacement for instance corresponding to the length from 30 m to 60 m are 0 28 m 0 65 m 1 01 m and 1 40 m with an almost linear increase these results can be derived from the following reasons that 1 the increase of the free span length directly boosts the initial responses of the pipeline under gravity load 2 the increase of the free span length reduces the coherency loss level between both the pipeline shoulder thereby amplifying the seismic response of the pipeline and 3 the increase of the free span length raises the inertia force i e added mass of to the pipeline exerted by seawater and thus cause the larger seismic response of the pipeline in fig 19 a it is clear to see that as the free span length increases the maximum peak mises stress rapidly approaches the allowable stress value in additional when the free span length reaches 60 m the corresponding maximum peak mises stress i e 493 24 mpa has been slightly higher than the smys of 485 mpa these results imply that the development of the free span length may account for higher failure hazards of the pipeline and once the free span length reaches or exceeds a specific value the free spanning pipeline may be damaged by the offshore seismic motions even under a relatively small pga as a result design engineers need to take the influences of the free span length on the seismic performance of submarine pipelines in their design moreover to protect the pipeline from earthquake damage it is recommended 1 to install submarine pipelines in the flat seafloor regions to avoid the emergence of free spans and 2 to take effective measures for the existing free spans to prevent their arbitrary development 5 conclusions this investigation presents comprehensive numerical results concerning the seismic behaviors of free spanning submarine pipelines subjected to memoss the nonlinear soil springs and added mass methods are employed to consider the soil pipe and water pipe interactions respectively the influences of multi support excitation offshore motions coherency loss local site conditions as well as free span length of pipeline are explicitly considered some significant conclusions can be drawn from the numerical results 1 the middle and ends of the free span are the relatively weak regions of the free spanning submarine pipeline under seismic actions 2 the uncertainty of the seismic motion inputs has a significant influence on the seismic behaviors and should be taken into account in seismic analysis of the submarine pipelines 3 the non uniform seismic excitations can significantly affect the seismic behaviors of free spanning submarine pipelines compared to the non uniform seismic excitations adopting the uniform seismic excitations may underestimate the seismic responses up to 16 92 and overestimate the critical bearing capacity as much as 20 89 of the pipeline respectively 4 in contrast to the offshore seismic motions adopting the onshore seismic motions may overestimate the seismic responses with a maximum of 9 23 and underestimate the critical bearing capacity up to 20 63 of the pipeline respectively 5 both the coherence loss and local site conditions has a significant effect on the seismic behaviors of free spanning submarine pipelines the lower the coherence loss level and soil stiffness are the higher the seismic responses and the lower the critical bearing capacity are 6 the free span length plays an important role in the seismic design of submarine pipelines the development of the free span length can increase the seismic responses and weaken the critical bearing capacity of free spanning submarine pipelines credit authorship contribution statement haiyang pan formal analysis investigation writing original draft hong nan li supervision writing review editing chao li conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research was financially supported by the national natural science foundation of china under awards no 51808099 no 52078106 and the fundamental research funds for the central universities grant no dut20rc 3 005 
20293,in this research work a water jet catamaran huster 30 is used as a case study to investigate the modeling and system identification of water jet vessels there is a natural phenomenon of the water jet vessels which is that the vessel cannot go straight with zero steering angle even under absolutely calm water conditions identifying the parameters of the water jet vessel model and guaranteeing the identified parameters cover a wide range of maneuvering is investigated in this paper the nonlinear asymmetric 3 degree of freedom dof model considering water jet system assembly error and the external force generated by the effect of outlet water flows is established moreover a constrained multi step prediction cmsp method is proposed in this paper to identify parameters of the nonlinear model a series of experiments are conducted to identify the parameters and the prediction results demonstrate that the asymmetric model has better performance than the symmetric model also the identified results demonstrate that the parameters identified by the cmsp method have a more accurate prediction than the ls method in a wide range of maneuvering the future work will focus on optimizing the proposed method and using the identified model for controller design and simulation study keywords water jet vessels system identification nonlinear asymmetric model 1 introduction unmanned surface vessels usv have attracted more and more attention from academia and industry in recent years usvs can be deployed for a wide range of potential applications including scientific research environmental missions ocean resource exploration military use and so on guidance techniques navigation techniques and control techniques are all essential techniques for a high performance usv most algorithms and application cases of these techniques such as speed and heading control multiple vessels control liu et al 2019 dynamic positioning control jiang et al 2020 and path following trajectory tracking zheng et al 2014 are based on the mathematical model of usv a sufficient accuracy model is imperative for control methodology design and simulation study liu et al 2016 how to get a simple but accurate enough model is still an open question to be discussed the dynamic model of usv is a highly nonlinear time varying 6 dof model how to build a model that can describe all dynamic details and how to identify the parameters of the nonlinear model are the most important problems in modeling the mathematics model of usv the 6 dof model is too difficult to build in researches and applications transfer function models and 3 dof state space models are commonly used the first order nomoto model was proposed in 1957 and is easy to identify the cifer software banazadeh et al 2017 backstepping procedure casado and ferreiro 2005 extended kalman filter ekf perera et al 2015 were used to identify the parameters of nomoto model however the demand for a high performance vessel motion controller requires a more complex model therefore the nonlinear state space model has been considered for high performance control and simulation due to the complex structure of the nonlinear model it is much more difficult to identify all the parameters many research focuses on the method of parameter identification the least squares ls method is a widely used method in system identification zhang et al 2015 support vector machines methods are used to identify the hydrodynamic derivatives of vessels in wang et al 2019 there are also some other methods to identify the model parameters the approach to model identification is iterative identification procedure sonnenburg et al 2010 a two step identification procedure was proposed in herrero and gonzalez 2012 the first step was to determine the structure of the nonlinear model the second step to use the unscented kalman filter to identify the parameters in klinger et al 2013 the parameters were identified by using a curve fitting method a particle swarm optimization method was proposed to identify the linear usv dynamic model in shin et al 2017 sensitivity analysis and sequential quadratic programming sqp method were used to identify the hydrodynamic coefficients of esso bernicia tanker in du et al 2017 in klinger et al 2016 the parameters were modeled by using a polynomial curve fit and the parameters were manually adjusted until the simulation results matched the experimental data in ertogan et al 2017 an artificial neural network was used to model a high speed craft it is difficult to cover the whole vessel maneuvers in the training set the model identified through these proposed methods has good fitting results on the training set and tested on a limited number of validation sets which can only cover a small range of vessel maneuvers how to guarantee the model identified based on the training set has good prediction results on both training set and validation sets is a very practical problem some approaches are proposed to guarantee that the identified model can cover a wide range of vessel maneuvers the system identification procedure of cybership ii was performed by using a towing carriage in skjetne et al 2004 the requirement of specific equipment limits its promotion in araki et al 2012 the extended kalman filter and constrained least squares ls method were proposed to estimate the maneuvering parameters with the help of experimental fluid dynamics efd and computational fluid dynamics cfd techniques to ensure that the identified model covered a wide range of vessel maneuvers the value of some hydrodynamic derivatives was used as constraints in paper eriksen and breivik 2017 a series of damping terms and inertia terms of the linear model at different working conditions were identified by using the curve fitting method then the linear regression method was used to identify the model parameters as a polynomial model the proposed method in eriksen and breivik 2017 needs many experiments and it is difficult to choose appropriate terms of a polynomial to have a good regression result data driven modeling of ship motion is a promising method however the method based on data driven needs huge raw data of ship motion which is a very long term process for a full scale vessel a flexible system structure was presented to analyze and model for the potential use of huge ship sensor data to generate an efficient ship motion prediction model but the training data were collected for three years from different sensors kawan et al 2017 in this paper first a nonlinear asymmetric 3 dof usv model considering water jet propulsion system assembly error and the rotation of outlet flows is built so that the established model can describe a natural phenomenon of the water jet vessel which is that the vessel cannot go straight with zero steering angle even under calm water condition then a cmsp method is proposed to identify the parameters of the established nonlinear model the cmsp method treats the identification process as a constrained optimization problem under the given model structure the steady states of different fixed motor speeds and steering angles which represent different vessel maneuvers are the inequality constraints the transient states generated by time varying motor speed and steering angle are used as training data the solution of the cmsp method guarantees that the identified parameters satisfy the constraints therefore the identified model has good prediction results in a wide range of vessel maneuvers the organization of this paper is as follows in the second section the nonlinear symmetric and the asymmetric model of the water jet vessel is given then the discrete form of the nonlinear model is derived the third section discusses the experiment procedure and derives the solution of the cmsp method the fourth section illustrates and analyzes the identification results the fifth section summarizes the conclusions 2 vessel mathematical model in this section huster 30 usv is used as a case study to investigate the modeling of water jet vessels huster 30 is a 3 0 m long catamaran equipped with two water jet propulsion systems which consists of a 7 5 kw brushless motor and two 5n m steering gear see fig 1 the integrated navigation equipment is used to measure vessel state which has a heading measurement accuracy of 0 1 a speed measurement accuracy of 0 1 m s and a measurement frequency of 10 hz the vessel controller is a pc104 computer and sends the expected motor speed and steering angle through the can bus at a frequency of 10 hz and the real time steering angle and motor speed are feedback to the vessel controller through the can bus at a frequency of 100 hz normally to counteract the sway force generated by the water jet propulsion system one of the propellers rotates clockwise and the other propeller rotates counterclockwise however in this paper to model the sway force generated by water jet propulsion the propellers of the experiment vessel rotate in the same direction the basic parameters of huster 30 are provided in table 1 the 3 dof nonlinear symmetric discrete state space model is established first then the nonlinear 3 dof asymmetric discrete state space model considering water jet system assembly error and the external force generated by the effect of outlet flows is established 2 1 3 dof nonlinear symmetric model of water jet vessel in this subsection the 3 dof nonlinear symmetric model is established by neglecting the heave roll and pitch motion we consider the maneuvering models proposed by fossen 2011 and sonnenburg et al 2010 1 m ν c ν ν d ν ν τ τ wind τ wave vector ν u v r denoting vessel surge velocity sway velocity and yaw angular velocity respectively matrix m accounting for inertial effects m m x u 0 0 0 m y v m x g y r 0 m x g y r i z n r matrix c ν accounting for centrifugal and coriolis effects c ν 0 0 c 13 0 0 c 23 c 13 c 23 0 where c 13 m x g r v y v v y r r c 23 m u x u u matrix d ν accounting for viscous and dissipative effects d ν d 11 0 0 0 d 22 d 23 0 d 32 d 33 where d 11 x u x u u u d 22 y v y v v v y r v r d 23 y r y v r v y r r r d 32 n v n v v v n r r r d 33 n r n v r v n r r r in order to match the experiment results the d 11 is modified as d 11 x u x u u u x u v v x u r r vector τ f x f y m z denoting external force and torques τ wind denoting force and torques caused by wind τ wave denoting force and torques caused by wave the water jet propulsion system provide surge force sway force and torque the relationship between force torque and steering angle is given in han et al 2016 2 f x t c o s δ f y t s i n δ m z t x δ s i n δ where t is the water jet propulsion force δ is the steering angle x δ is the distance from the water jet nozzle to the gravity center c g han et al 2016 in allotta et al 2018 and fossen 2011 the water jet propulsion force t can be calculated by rotation speed n and surge velocity u in the water jet propulsion system the direction of the propeller rotation remains the same during the work process assuming that n 0 corresponding to the direction of propeller rotation thus the water jet propulsion force t can be written as 3 t k 1 n 2 k 2 n u substituting eq 3 into eq 2 we have 4 τ k 1 k 2 n 2 n u c o s δ s i n δ x δ s i n δ there are many coupling and time varying terms in 3 dof nonlinear model ignoring the forces and torques caused by wind and wave eq 1 be rewritten as follows 5 ν f ν u g ν where f ν m 1 c ν ν m 1 d ν ν and u g ν m 1 τ assuming that during every sample interval the motor speed n and water jet propulsion steering angle δ is under zero order hold zoh then from kazantzis and kravaris 1999 we know the nonlinear system represented by eq 5 can be discretized in a uniformly convergent taylor series as eq 6 and the resulting coefficients can be easily computed by taking successive partial derivatives of the right hand side of eq 5 6 ν k 1 ν k l 1 a l ν k u k t l l where ν k is the value of vessel state vector ν at time t t k k t and a l ν u are determined recursively by 7a a 1 ν u f ν u g ν 7b a l 1 ν u a 1 ν f ν u g ν with l 1 2 3 considering the inertia of the vessel in this paper is large yet the sampling time of the sensor is very short we use an approximate representation to discrete eq 5 by retaining the first order of taylor series the discrete form of eq 5 is 8 ν k 1 ν k m 1 c ν k ν k t s m 1 d ν k ν k t s m 1 τ t s with t s 0 1 s ν k u k v k r k the discrete nonlinear state space model of water jet vessel is as follows 9 u k 1 a 1 u k a 2 u k u k a 3 v k r k a 4 r k 2 a 5 u k v k a 6 u k r k a 7 n k 2 a 8 n k u k c o s δ k 10 v k 1 b 1 u k δ ψ k b 2 u k v k b 3 v k b 4 δ ψ k b 5 v k v k b 6 v k δ ψ k b 7 δ ψ k v k b 8 δ ψ k δ ψ k b 9 n k 2 b 10 n k u k c o s δ k 11 r k 1 c 1 u k r k c 2 u k v k c 3 v k c 4 r k c 5 v k v k c 6 v k r k c 7 r k v k c 8 r k r k c 9 n k 2 c 10 n k u k c o s δ k the parameters a 1 a 8 in eq 9 b 1 b 10 in eq 10 and c 1 c 10 in eq 11 are the parameters that need to be identified 2 2 3 dof nonlinear asymmetric model of water jet vessel in this paper the steering dynamics bias is considering as a time varying moment assembly error is inevitable during the ship assembly process the thrust generated by the water jet propulsion system does not go strictly through the gravity center therefore an external yaw moment due to the assembly error is generated besides due to the rotation of the propeller in the water jet propulsion system the outlet water flow has rotation velocity which has the same direction as the propeller and another force is generated due to the rotation of outlet flows considering water jet system assembly error the real position of water jet propulsion is showed in fig 2 a the external yaw moment m 1 is 12 m 1 t l s i n δ β where l x δ 2 d 2 is the distance from water jet nozzle to the c g and d is the lateral distance between the water jet and the gravity center c g β is the force angle shown in fig 2 β t a n 1 d x δ the force t 2 is generated by rotation outlet flows as shown in fig 2 b so the surge force f x sway force f y is different from eq 2 the surge force equation is 13 f x t c o s δ t 2 s i n δ the sway force equation is 14 f y t s i n δ t 2 c o s δ the external yaw moment generated by outlet flows is 15 m 2 t 2 l s i n δ β π 2 t 2 l c o s δ β by adding eqs 12 and 15 the yaw moment generated by water jet propulsion system is 16 m z t l s i n δ β t 2 l c o s δ β similarly the force t 2 generated by rotation outlet flows of water jet propulsion can be calculated by rotation speed n and surge velocity u as 17 t 2 k 3 n 2 k 4 n u substituting eqs 3 and 17 into eqs 13 14 and 16 we have 18 τ c o s δ s i n δ s i n δ c o s δ l s i n δ β l c o s δ β k 1 k 2 k 3 k 4 n 2 n u substituting eq 18 into eq 8 we have the asymmetric model of water jet vessel as 19 u k 1 a 1 u k a 2 u k u k a 3 v k r k a 4 r k 2 a 5 u k v k a 6 u k r k a 7 n k 2 a 8 n k u k c o s δ k a 9 n k 2 a 10 n k u k s i n δ k 20 v k 1 b 1 u k r k b 2 u k v k b 3 v k b 4 r k b 5 v k v k b 6 v k r k b 7 r k v k b 8 r k r k b 9 n k 2 b 10 n k u k c o s δ k b 11 n k 2 b 12 n k u k s i n δ k 21 r k 1 c 1 u k r k c 2 u k v k c 3 v k c 4 r k c 5 v k v k c 6 v k r k c 7 r k v k c 8 r k r k c 9 n k 2 c 10 n k u k c o s δ k c 11 n k 2 c 12 n k u k s i n δ k comparing the asymmetric model and the symmetric model of the water jet vessel we can see the parameters a 1 a 6 b 1 b 8 and c 1 c 8 are the same due to the assembly error and the effect of outlet flows the asymmetric model has more terms representing the sway force of the water jet propulsion than the symmetric model 3 constrained multi step prediction cmsp method in the identification process two groups of experiments are designed to identify the parameters of the asymmetric model and the symmetric model in the first group of experiments parameters related to surge motion are identified in the second group of experiments the remaining parameters related to sway and yaw motion are identified 3 1 identification problem formulation in the first group of experiments to identify the parameters related to surge velocity and thrust force some control strategy is used to control ship go in a straight line so that the sway velocity and yaw angular velocity are near zero the max steering angle during the experiments is limited at 4 to reduce the impact on thrust due to that the steering angle δ is small we assume that 22a a 7 a 7 c o s δ a 9 s i n δ 22b a 8 a 8 c o s δ a 10 s i n δ considering the sway velocity v and yaw angular velocity r are approximately equal to 0 in the whole surge motion experiments eq 9 can be simplified as eq 23 subscript is used to denote the present time such as u k is used instead of u k to denote the surge velocity at time k x 1 a 1 a 2 a 7 a 8 denotes the parameters will be identified in experiments 23 u k 1 a 1 u k a 2 u k u k a 7 n k 2 a 8 n k u k g 1 x 1 u k n k two kinds of data are collected in the experiments to identify the surge motion model the steady state is collected first by driven vessel in straight line with different revolutions per minute rpm of motor speed n 1 n 2 n m so that the surge velocity can reach a corresponding surge velocity u 1 u 2 u m then the inequality constraints can be established based on steady state data for a given fixed motor speed n i when the velocity u i is larger than the corresponding u i then the surge velocity will decelerate to a velocity that matches the motor speed when the velocity u i is smaller than the corresponding u i then the surge velocity will accelerate to a velocity that matches the motor speed the λ u i and β u i are used to denote the u i and u i respectively then the inequality constraints are construct based on the monotonic increase and decrease characteristics between surge velocity and motor speed the inequality constraints can be written as eq 24 24 g 1 x 1 λ u j n j λ u j λ 1 j 1 m g 1 x 1 β u j n j β u j 0 β 1 j 1 m when the inequality constraints are satisfied in the identification process then the identified parameters guarantee the predicted steady state surge velocity between the upper boundary u i and the lower boundaries u i next to collect the transient state data the vessel is driven in a straight line with a series of pseudo random binary sequence prbs rpm to get a series of transient surge velocity as training data set u n u 1 n denotes the first data of u n and it is used as initial data to predict surge velocity by using the multi step prediction method in eq 25 25 u ˆ 1 u 1 n u ˆ 2 g 1 x 1 u ˆ 1 n i u ˆ k 1 g 1 x 1 u ˆ k n i k 1 n 1 then by combining the eq 24 and the eq 25 the surge motion model identification problem can be described as a nonlinear constrained optimization problem as eq 26 26 m i n f 1 x 1 1 2 k 1 n u ˆ k u k n s t g 1 x 1 λ u j n j λ u j g 1 x 1 β u j n j β u j where λ and β are the ratios in solving the optimization problem in the first group experiments the parameters a 1 a 2 a 7 and a 8 are identified the purpose of the second group of experiments is to identify the remaining parameters of vessel model which are related to sway and yaw motion also the steady state data and transient state data are collected in the second group experiments first the vessel is driven with fixed rpm and fixed steering angle δ 1 δ 2 δ m so that the surge velocity u 1 u 2 u m sway velocity v 1 v 2 v m and yaw angle differential δ ψ 1 δ ψ 2 δ ψ m reach the steady state ν 1 ν 2 ν m next the vessel is driven with fixed rpm and a series of steering angle generated by zig zag movement to get a series of training data set ν n depends on the identified model is the symmetric model or asymmetric model a series of estimated value ν ˆ can be calculated by using eqs 9 10 11 or eqs 19 20 21 based on ν 1 n x 2 x 21 x 22 x 23 denotes the remaining parameters of the vessel model 27a x 21 a 3 a 4 a 5 a 6 a 9 a 10 0 0 27b x 22 b 1 b 2 b 3 a 4 b 5 b 6 b 11 b 12 27c x 23 c 1 c 2 c 3 c 4 c 5 c 6 c 11 c 12 g u x 2 u v δ ψ n δ and g r x 2 u v δ ψ n δ are used to predicted the surge speed and yaw angular velocity respectively 28 g u x 22 u v δ ψ n δ a 1 u k a 2 u k u k a 3 v k r k a 4 r k 2 a 5 u k v k a 6 u k r k a 7 n k 2 a 8 n k u k c o s δ k a 9 n k 2 a 10 n k u k s i n δ k 29 g r x 23 u v δ ψ n δ c 1 u k r k c 2 u k v k c 3 v k c 4 r k c 5 v k v k c 6 v k r k c 7 r k v k c 8 r k r k c 9 n k 2 c 10 n k u k c o s δ k c 11 n k 2 c 12 n k u k s i n δ k so as the surge motion when the motor speed is fixed the greater the steering angle is the greater the yaw angular velocity is and the lower the surge speed is when the motor speed and steering angle are fixed the surge speed the sway speed and yaw angular velocity will converge to a stable value based on the monotonic increase and decrease characteristics among steering angle yaw angular velocity and surge speed we can use parameters λ u and β u to construct inequality constraints between surge speed and steering angle we can use parameters λ ψ and β ψ to construct inequality constraints between yaw angular velocity and steering angle then the remaining parameters identification problem can also be treated as a nonlinear constrained optimization problem as eq 30 30 m i n f 2 x 2 1 2 k 1 n ν ˆ k ν k n s t g u x 2 λ u u i v j δ ψ j n j δ j λ u u j g u x 2 β u u j v j δ ψ j n j δ j β u u j g r x 2 u j v j λ ψ δ ψ j n j δ j λ ψ δ ψ j g r x 2 u j v j β ψ δ ψ j n j δ j β ψ δ ψ j where λ u 1 0 β u 1 λ ψ 1 0 β ψ 1 j 1 m 3 2 optimization method as the above objective eqs 26 and 30 are nonlinear the minimum value of the above equations cannot be derived analytically which has to be found by iterative numerical techniques the eq 30 is used here to illustrate how to use iterative methods to identify parameters due to the constraints the iterative numerical techniques cannot be used directly to find the minimum value therefore we rewrite the constraints of the eq 30 as an objective function f 3 x 2 as follows 31 f 3 x 2 e α g u x 2 λ u u j v j δ ψ j n j δ j λ u u j e α g u x 2 β u u j v j δ ψ j n j δ j β u u j e α g r x 2 u j v j λ ψ δ ψ j n j δ j λ ψ δ ψ j e α g r x 2 u j v j β ψ δ ψ j n j δ j β ψ δ ψ j j 1 m gain parameter α is a large constant and usually set to 100 when the constraint is not satisfied the objective function value f 3 will become very large however when the constraints are satisfied the objective function value f 3 is the sum of several negative power exponents or zero power exponents of e which is a very small value the problem of finding the minimum of eq 30 is equivalent to find the minimum value as the following equation 32 m i n f x 2 f 2 x 2 f 3 x 2 the nonlinear constraints optimization problem turns into an unconstrained nonlinear optimization problem as eq 32 several iterative numerical algorithms dennis jr and schnabel 1996 madsen et al 1999 and some software such as matlab or ceres solver are available for the nonlinear unconstrained optimization problem 4 identification results in this section the parameters of the asymmetric model are identified by the ls method and cmsp method respectively it is difficult to construct the inequality equations for the symmetric model due to the same port and starboard steering angle causes the different velocity and yaw angular velocity therefore the parameters of the symmetric model are only identified by the ls method the prediction results of different methods and models are compared to illustrate the effectiveness of the cmsp method and the better performance of the symmetric model all the experiments are conducted on songshan lake dongguan 4 1 surge motion model parameters identification in the experiments of identifying surge motion parameters to cover a wide range of surge velocity the range of motor speed of the water jet motor is from 1000 rpm to 3500 rpm the chosen motor speed covers a surge velocity range from 0 72 m s to 1 98 m s the max steering angle of heading controller in surge velocity identification experiments is restricted to 4 the steady states of the set rpm and constraint parameters of steady states are given in table 2 then the motor changes speed randomly in a certain range with 3500 rpm as upper bound and 1000 rpm as the lower bound the transient sets of surge velocity are used as training data to identify the parameters the parameters identified by the ls method cmsp method are shown in table 3 r square is used as an index function to quantitatively compare identification results as eq 33 the closer the r square to 1 the better the identified results x i ˆ x i and x i denote the prediction results experiment results and the mean value of the experiment results respectively 33 j e r r o r 1 i 1 n x i ˆ x i i 1 n x i ˆ x i fig 3 shows identification results of training sets the r square of ls method is 0 9903 and the r square of cmsp method is 0 9655 the results show that the ls method has better fitting results however the performance of different methods should consider the prediction results on both training sets and validation sets to further validate the effectiveness of the cmsp method another two validation sets are used to compare the prediction results fig 4 shows predicted results of parameters identified by different methods the r square value of the different models is 0 9598 parameters identified by ls method and 0 9954 parameters identified by cmsp method the yellow and green solid lines are corresponding to the upper and lower boundary of the inequality constraints due to the inequality constraints fixed motor speed prediction results such as 1000 rpm 2000 rpm and 3000 rpm are finally steady in the constraints zone however in the slow motor speed 1000 rpm and 1500 rpm situation the prediction results of the ls method are inaccurate fig 5 shows the prediction results in the transient state set different from the training set the r square value of the different model is 0 9640 parameters identified by ls method cmsp method and 0 9706 parameters identified by cmsp method in the identification process of the surge mode parameters the ls method has better performance than the cmsp method in the training set because the ls method aims to reduce the whole prediction error in the training set however the cmsp method has to guarantee the inequality constraints being satisfied in reducing the error of the prediction results in the training set thus the ls method may have better performance in the training set however inequality constraints are constructed from low motor speed 1000 rpm to high motor speed 3000 rpm which can guarantee the model parameters prediction results under the constrained zones from low motor speed to high motor speed the ls method can only reduce the whole prediction error but cannot guarantee to reduce local prediction error in conclusion the cmsp method has better performance in surge model parameters identification 4 2 sway and yaw model parameters identification the zigzag test to generate training data see fig 6 the upper parameters λ u and λ ψ are setting to 1 05 the lower parameter β u and β ψ are setting to 0 95 the gain parameter α is setting to 100 the value of the identified parameters is shown in table 4 the r square value of the identified model is shown in table 5 parameters ls bm represent the parameters identified by the ls method based on the symmetric model parameters ls represent the parameters identified by ls method based on the asymmetric model and parameters cmsp represent the parameters identified by the cmsp method based on the asymmetric model fig 6 shows the identified results in the training set from the perspective of the identification results the asymmetric model has a much better prediction performance than the symmetric model as for the identified results of the symmetric model the cmsp method has better prediction performance than the ls method by comparing the r square value the performance of different methods should consider the prediction results of the training set and validation sets another three different validation sets are used to validate the effectiveness of the cmsp method further in the validation set shown as fig 7 the motor is fixed at 1000 rpm initially then change to 2000 rpm at 172 s and finally change to 3000 rpm at 285 s a pseudo random binary sequence prbs excitation signal generates the steering angle all the time apparently the asymmetric model has better prediction performance than the symmetric model in all motions as for the ls method and the cmsp method the surge model prediction results are very close but cmsp has a much better prediction performance than the ls method in the sway model and yaw model from the perspective of the r square value in the validation set shown as fig 8 the motor speed is fixed at 2000 rpm the steering angle is set at 20 initially and changed to 20 at 428 s the yellow and black dashed lines are corresponding to the upper and lower boundary of the inequality constraints we can see from the prediction results that the asymmetric model has better performance than the symmetric model the prediction surge velocity and yaw angular velocity of the cmsp method are both in the constrained zone from the perspective of the r square value the prediction results of the sway model and yaw model are very close but the cmsp method has better performance than the ls method in the surge model in the validation set shown as fig 9 the motor speed is fixed at 3000 rpm the steering angle is set at 20 initially and changed to 20 at 428 s the yellow and black dashed lines are corresponding to the upper and lower boundary of the inequality constraints we can see from the prediction results that the asymmetric model has better performance than the symmetric model the prediction surge velocity and yaw angular velocity of the cmsp method are both in the constrained zone from the perspective of the r square value the cmsp method has better performance than the ls method in the surge model lateral model and yaw model in predicting the velocity and angular velocity at fixed motor speed and steering angle the predicted absolute value of the symmetric model is the same no matter the sign of the input steering angle is positive or negative however due to the characteristic of the water jet propulsion system even the steering angle has a different sign but the same absolute value the surge velocity lateral velocity and yaw angular velocity do not have the same absolute value the symmetric model is not enough for this situation and therefore has worse prediction performance than the asymmetric model as for the parameter identified in the asymmetric model the ls method aims to reduce the whole prediction error in the training set but the cmsp method has to guarantee the inequality constraints being satisfied in reducing the error of the prediction results in the training set so the parameters identified by different methods have a close performance in predicting the transient data but the parameters identified by the cmsp method have better performance in predicting the results of fixed input 5 analysis and conclusion in this paper a parameter identification method is proposed to identify the parameters of the vessel model base on the experiment data during the experiments the unknown time varying force generated by the wind wave and current work at the vessel and the force and moment generated by the propulsion system so the experiment data corresponding to a model that combines the vessel dynamics model and time varying disturbance dynamics model usually it is hard to build the model of the time varying disturbance and only the vessel dynamics model is considered in the parameter identification therefore the experiment data and the model to be identified do not match identification methods such as the least square method aim to reduce the error between the prediction results and training data overall however due to the training data not matching the model to be identified the identified parameters can have a good prediction result in the training set but cannot guarantee a good prediction result in the validation sets the purpose of the cmsp method is not to identify the real parameters of the vessel model instead it is to make the prediction results of the identified parameters match the experiment data in a wide range of the maneuvering in the cmsp method the identification problem becomes a nonlinear constraints optimization problem to solve it is difficult to tell if the nonlinear constraints optimization problem is a convex optimization problem or not most of the solving methods are based on the gradient descent method thus the identified parameters may be a suboptimal solution to the nonlinear constraints optimization problem also there could be no feasible solution to the nonlinear constraints optimization problem in some situations such as have lots of constraints how to solve the nonlinear constraints optimization problem is challenge work and needs further research furthermore the identified model will be used for controller design and simulation study purposes credit authorship contribution statement xudong wang conceptualization methodology formal analysis software data curation writing original draft writing review editing jin zhao supervision conceptualization writing review editing songjie liu software data curation visualization writing review editing tao geng software validation project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20293,in this research work a water jet catamaran huster 30 is used as a case study to investigate the modeling and system identification of water jet vessels there is a natural phenomenon of the water jet vessels which is that the vessel cannot go straight with zero steering angle even under absolutely calm water conditions identifying the parameters of the water jet vessel model and guaranteeing the identified parameters cover a wide range of maneuvering is investigated in this paper the nonlinear asymmetric 3 degree of freedom dof model considering water jet system assembly error and the external force generated by the effect of outlet water flows is established moreover a constrained multi step prediction cmsp method is proposed in this paper to identify parameters of the nonlinear model a series of experiments are conducted to identify the parameters and the prediction results demonstrate that the asymmetric model has better performance than the symmetric model also the identified results demonstrate that the parameters identified by the cmsp method have a more accurate prediction than the ls method in a wide range of maneuvering the future work will focus on optimizing the proposed method and using the identified model for controller design and simulation study keywords water jet vessels system identification nonlinear asymmetric model 1 introduction unmanned surface vessels usv have attracted more and more attention from academia and industry in recent years usvs can be deployed for a wide range of potential applications including scientific research environmental missions ocean resource exploration military use and so on guidance techniques navigation techniques and control techniques are all essential techniques for a high performance usv most algorithms and application cases of these techniques such as speed and heading control multiple vessels control liu et al 2019 dynamic positioning control jiang et al 2020 and path following trajectory tracking zheng et al 2014 are based on the mathematical model of usv a sufficient accuracy model is imperative for control methodology design and simulation study liu et al 2016 how to get a simple but accurate enough model is still an open question to be discussed the dynamic model of usv is a highly nonlinear time varying 6 dof model how to build a model that can describe all dynamic details and how to identify the parameters of the nonlinear model are the most important problems in modeling the mathematics model of usv the 6 dof model is too difficult to build in researches and applications transfer function models and 3 dof state space models are commonly used the first order nomoto model was proposed in 1957 and is easy to identify the cifer software banazadeh et al 2017 backstepping procedure casado and ferreiro 2005 extended kalman filter ekf perera et al 2015 were used to identify the parameters of nomoto model however the demand for a high performance vessel motion controller requires a more complex model therefore the nonlinear state space model has been considered for high performance control and simulation due to the complex structure of the nonlinear model it is much more difficult to identify all the parameters many research focuses on the method of parameter identification the least squares ls method is a widely used method in system identification zhang et al 2015 support vector machines methods are used to identify the hydrodynamic derivatives of vessels in wang et al 2019 there are also some other methods to identify the model parameters the approach to model identification is iterative identification procedure sonnenburg et al 2010 a two step identification procedure was proposed in herrero and gonzalez 2012 the first step was to determine the structure of the nonlinear model the second step to use the unscented kalman filter to identify the parameters in klinger et al 2013 the parameters were identified by using a curve fitting method a particle swarm optimization method was proposed to identify the linear usv dynamic model in shin et al 2017 sensitivity analysis and sequential quadratic programming sqp method were used to identify the hydrodynamic coefficients of esso bernicia tanker in du et al 2017 in klinger et al 2016 the parameters were modeled by using a polynomial curve fit and the parameters were manually adjusted until the simulation results matched the experimental data in ertogan et al 2017 an artificial neural network was used to model a high speed craft it is difficult to cover the whole vessel maneuvers in the training set the model identified through these proposed methods has good fitting results on the training set and tested on a limited number of validation sets which can only cover a small range of vessel maneuvers how to guarantee the model identified based on the training set has good prediction results on both training set and validation sets is a very practical problem some approaches are proposed to guarantee that the identified model can cover a wide range of vessel maneuvers the system identification procedure of cybership ii was performed by using a towing carriage in skjetne et al 2004 the requirement of specific equipment limits its promotion in araki et al 2012 the extended kalman filter and constrained least squares ls method were proposed to estimate the maneuvering parameters with the help of experimental fluid dynamics efd and computational fluid dynamics cfd techniques to ensure that the identified model covered a wide range of vessel maneuvers the value of some hydrodynamic derivatives was used as constraints in paper eriksen and breivik 2017 a series of damping terms and inertia terms of the linear model at different working conditions were identified by using the curve fitting method then the linear regression method was used to identify the model parameters as a polynomial model the proposed method in eriksen and breivik 2017 needs many experiments and it is difficult to choose appropriate terms of a polynomial to have a good regression result data driven modeling of ship motion is a promising method however the method based on data driven needs huge raw data of ship motion which is a very long term process for a full scale vessel a flexible system structure was presented to analyze and model for the potential use of huge ship sensor data to generate an efficient ship motion prediction model but the training data were collected for three years from different sensors kawan et al 2017 in this paper first a nonlinear asymmetric 3 dof usv model considering water jet propulsion system assembly error and the rotation of outlet flows is built so that the established model can describe a natural phenomenon of the water jet vessel which is that the vessel cannot go straight with zero steering angle even under calm water condition then a cmsp method is proposed to identify the parameters of the established nonlinear model the cmsp method treats the identification process as a constrained optimization problem under the given model structure the steady states of different fixed motor speeds and steering angles which represent different vessel maneuvers are the inequality constraints the transient states generated by time varying motor speed and steering angle are used as training data the solution of the cmsp method guarantees that the identified parameters satisfy the constraints therefore the identified model has good prediction results in a wide range of vessel maneuvers the organization of this paper is as follows in the second section the nonlinear symmetric and the asymmetric model of the water jet vessel is given then the discrete form of the nonlinear model is derived the third section discusses the experiment procedure and derives the solution of the cmsp method the fourth section illustrates and analyzes the identification results the fifth section summarizes the conclusions 2 vessel mathematical model in this section huster 30 usv is used as a case study to investigate the modeling of water jet vessels huster 30 is a 3 0 m long catamaran equipped with two water jet propulsion systems which consists of a 7 5 kw brushless motor and two 5n m steering gear see fig 1 the integrated navigation equipment is used to measure vessel state which has a heading measurement accuracy of 0 1 a speed measurement accuracy of 0 1 m s and a measurement frequency of 10 hz the vessel controller is a pc104 computer and sends the expected motor speed and steering angle through the can bus at a frequency of 10 hz and the real time steering angle and motor speed are feedback to the vessel controller through the can bus at a frequency of 100 hz normally to counteract the sway force generated by the water jet propulsion system one of the propellers rotates clockwise and the other propeller rotates counterclockwise however in this paper to model the sway force generated by water jet propulsion the propellers of the experiment vessel rotate in the same direction the basic parameters of huster 30 are provided in table 1 the 3 dof nonlinear symmetric discrete state space model is established first then the nonlinear 3 dof asymmetric discrete state space model considering water jet system assembly error and the external force generated by the effect of outlet flows is established 2 1 3 dof nonlinear symmetric model of water jet vessel in this subsection the 3 dof nonlinear symmetric model is established by neglecting the heave roll and pitch motion we consider the maneuvering models proposed by fossen 2011 and sonnenburg et al 2010 1 m ν c ν ν d ν ν τ τ wind τ wave vector ν u v r denoting vessel surge velocity sway velocity and yaw angular velocity respectively matrix m accounting for inertial effects m m x u 0 0 0 m y v m x g y r 0 m x g y r i z n r matrix c ν accounting for centrifugal and coriolis effects c ν 0 0 c 13 0 0 c 23 c 13 c 23 0 where c 13 m x g r v y v v y r r c 23 m u x u u matrix d ν accounting for viscous and dissipative effects d ν d 11 0 0 0 d 22 d 23 0 d 32 d 33 where d 11 x u x u u u d 22 y v y v v v y r v r d 23 y r y v r v y r r r d 32 n v n v v v n r r r d 33 n r n v r v n r r r in order to match the experiment results the d 11 is modified as d 11 x u x u u u x u v v x u r r vector τ f x f y m z denoting external force and torques τ wind denoting force and torques caused by wind τ wave denoting force and torques caused by wave the water jet propulsion system provide surge force sway force and torque the relationship between force torque and steering angle is given in han et al 2016 2 f x t c o s δ f y t s i n δ m z t x δ s i n δ where t is the water jet propulsion force δ is the steering angle x δ is the distance from the water jet nozzle to the gravity center c g han et al 2016 in allotta et al 2018 and fossen 2011 the water jet propulsion force t can be calculated by rotation speed n and surge velocity u in the water jet propulsion system the direction of the propeller rotation remains the same during the work process assuming that n 0 corresponding to the direction of propeller rotation thus the water jet propulsion force t can be written as 3 t k 1 n 2 k 2 n u substituting eq 3 into eq 2 we have 4 τ k 1 k 2 n 2 n u c o s δ s i n δ x δ s i n δ there are many coupling and time varying terms in 3 dof nonlinear model ignoring the forces and torques caused by wind and wave eq 1 be rewritten as follows 5 ν f ν u g ν where f ν m 1 c ν ν m 1 d ν ν and u g ν m 1 τ assuming that during every sample interval the motor speed n and water jet propulsion steering angle δ is under zero order hold zoh then from kazantzis and kravaris 1999 we know the nonlinear system represented by eq 5 can be discretized in a uniformly convergent taylor series as eq 6 and the resulting coefficients can be easily computed by taking successive partial derivatives of the right hand side of eq 5 6 ν k 1 ν k l 1 a l ν k u k t l l where ν k is the value of vessel state vector ν at time t t k k t and a l ν u are determined recursively by 7a a 1 ν u f ν u g ν 7b a l 1 ν u a 1 ν f ν u g ν with l 1 2 3 considering the inertia of the vessel in this paper is large yet the sampling time of the sensor is very short we use an approximate representation to discrete eq 5 by retaining the first order of taylor series the discrete form of eq 5 is 8 ν k 1 ν k m 1 c ν k ν k t s m 1 d ν k ν k t s m 1 τ t s with t s 0 1 s ν k u k v k r k the discrete nonlinear state space model of water jet vessel is as follows 9 u k 1 a 1 u k a 2 u k u k a 3 v k r k a 4 r k 2 a 5 u k v k a 6 u k r k a 7 n k 2 a 8 n k u k c o s δ k 10 v k 1 b 1 u k δ ψ k b 2 u k v k b 3 v k b 4 δ ψ k b 5 v k v k b 6 v k δ ψ k b 7 δ ψ k v k b 8 δ ψ k δ ψ k b 9 n k 2 b 10 n k u k c o s δ k 11 r k 1 c 1 u k r k c 2 u k v k c 3 v k c 4 r k c 5 v k v k c 6 v k r k c 7 r k v k c 8 r k r k c 9 n k 2 c 10 n k u k c o s δ k the parameters a 1 a 8 in eq 9 b 1 b 10 in eq 10 and c 1 c 10 in eq 11 are the parameters that need to be identified 2 2 3 dof nonlinear asymmetric model of water jet vessel in this paper the steering dynamics bias is considering as a time varying moment assembly error is inevitable during the ship assembly process the thrust generated by the water jet propulsion system does not go strictly through the gravity center therefore an external yaw moment due to the assembly error is generated besides due to the rotation of the propeller in the water jet propulsion system the outlet water flow has rotation velocity which has the same direction as the propeller and another force is generated due to the rotation of outlet flows considering water jet system assembly error the real position of water jet propulsion is showed in fig 2 a the external yaw moment m 1 is 12 m 1 t l s i n δ β where l x δ 2 d 2 is the distance from water jet nozzle to the c g and d is the lateral distance between the water jet and the gravity center c g β is the force angle shown in fig 2 β t a n 1 d x δ the force t 2 is generated by rotation outlet flows as shown in fig 2 b so the surge force f x sway force f y is different from eq 2 the surge force equation is 13 f x t c o s δ t 2 s i n δ the sway force equation is 14 f y t s i n δ t 2 c o s δ the external yaw moment generated by outlet flows is 15 m 2 t 2 l s i n δ β π 2 t 2 l c o s δ β by adding eqs 12 and 15 the yaw moment generated by water jet propulsion system is 16 m z t l s i n δ β t 2 l c o s δ β similarly the force t 2 generated by rotation outlet flows of water jet propulsion can be calculated by rotation speed n and surge velocity u as 17 t 2 k 3 n 2 k 4 n u substituting eqs 3 and 17 into eqs 13 14 and 16 we have 18 τ c o s δ s i n δ s i n δ c o s δ l s i n δ β l c o s δ β k 1 k 2 k 3 k 4 n 2 n u substituting eq 18 into eq 8 we have the asymmetric model of water jet vessel as 19 u k 1 a 1 u k a 2 u k u k a 3 v k r k a 4 r k 2 a 5 u k v k a 6 u k r k a 7 n k 2 a 8 n k u k c o s δ k a 9 n k 2 a 10 n k u k s i n δ k 20 v k 1 b 1 u k r k b 2 u k v k b 3 v k b 4 r k b 5 v k v k b 6 v k r k b 7 r k v k b 8 r k r k b 9 n k 2 b 10 n k u k c o s δ k b 11 n k 2 b 12 n k u k s i n δ k 21 r k 1 c 1 u k r k c 2 u k v k c 3 v k c 4 r k c 5 v k v k c 6 v k r k c 7 r k v k c 8 r k r k c 9 n k 2 c 10 n k u k c o s δ k c 11 n k 2 c 12 n k u k s i n δ k comparing the asymmetric model and the symmetric model of the water jet vessel we can see the parameters a 1 a 6 b 1 b 8 and c 1 c 8 are the same due to the assembly error and the effect of outlet flows the asymmetric model has more terms representing the sway force of the water jet propulsion than the symmetric model 3 constrained multi step prediction cmsp method in the identification process two groups of experiments are designed to identify the parameters of the asymmetric model and the symmetric model in the first group of experiments parameters related to surge motion are identified in the second group of experiments the remaining parameters related to sway and yaw motion are identified 3 1 identification problem formulation in the first group of experiments to identify the parameters related to surge velocity and thrust force some control strategy is used to control ship go in a straight line so that the sway velocity and yaw angular velocity are near zero the max steering angle during the experiments is limited at 4 to reduce the impact on thrust due to that the steering angle δ is small we assume that 22a a 7 a 7 c o s δ a 9 s i n δ 22b a 8 a 8 c o s δ a 10 s i n δ considering the sway velocity v and yaw angular velocity r are approximately equal to 0 in the whole surge motion experiments eq 9 can be simplified as eq 23 subscript is used to denote the present time such as u k is used instead of u k to denote the surge velocity at time k x 1 a 1 a 2 a 7 a 8 denotes the parameters will be identified in experiments 23 u k 1 a 1 u k a 2 u k u k a 7 n k 2 a 8 n k u k g 1 x 1 u k n k two kinds of data are collected in the experiments to identify the surge motion model the steady state is collected first by driven vessel in straight line with different revolutions per minute rpm of motor speed n 1 n 2 n m so that the surge velocity can reach a corresponding surge velocity u 1 u 2 u m then the inequality constraints can be established based on steady state data for a given fixed motor speed n i when the velocity u i is larger than the corresponding u i then the surge velocity will decelerate to a velocity that matches the motor speed when the velocity u i is smaller than the corresponding u i then the surge velocity will accelerate to a velocity that matches the motor speed the λ u i and β u i are used to denote the u i and u i respectively then the inequality constraints are construct based on the monotonic increase and decrease characteristics between surge velocity and motor speed the inequality constraints can be written as eq 24 24 g 1 x 1 λ u j n j λ u j λ 1 j 1 m g 1 x 1 β u j n j β u j 0 β 1 j 1 m when the inequality constraints are satisfied in the identification process then the identified parameters guarantee the predicted steady state surge velocity between the upper boundary u i and the lower boundaries u i next to collect the transient state data the vessel is driven in a straight line with a series of pseudo random binary sequence prbs rpm to get a series of transient surge velocity as training data set u n u 1 n denotes the first data of u n and it is used as initial data to predict surge velocity by using the multi step prediction method in eq 25 25 u ˆ 1 u 1 n u ˆ 2 g 1 x 1 u ˆ 1 n i u ˆ k 1 g 1 x 1 u ˆ k n i k 1 n 1 then by combining the eq 24 and the eq 25 the surge motion model identification problem can be described as a nonlinear constrained optimization problem as eq 26 26 m i n f 1 x 1 1 2 k 1 n u ˆ k u k n s t g 1 x 1 λ u j n j λ u j g 1 x 1 β u j n j β u j where λ and β are the ratios in solving the optimization problem in the first group experiments the parameters a 1 a 2 a 7 and a 8 are identified the purpose of the second group of experiments is to identify the remaining parameters of vessel model which are related to sway and yaw motion also the steady state data and transient state data are collected in the second group experiments first the vessel is driven with fixed rpm and fixed steering angle δ 1 δ 2 δ m so that the surge velocity u 1 u 2 u m sway velocity v 1 v 2 v m and yaw angle differential δ ψ 1 δ ψ 2 δ ψ m reach the steady state ν 1 ν 2 ν m next the vessel is driven with fixed rpm and a series of steering angle generated by zig zag movement to get a series of training data set ν n depends on the identified model is the symmetric model or asymmetric model a series of estimated value ν ˆ can be calculated by using eqs 9 10 11 or eqs 19 20 21 based on ν 1 n x 2 x 21 x 22 x 23 denotes the remaining parameters of the vessel model 27a x 21 a 3 a 4 a 5 a 6 a 9 a 10 0 0 27b x 22 b 1 b 2 b 3 a 4 b 5 b 6 b 11 b 12 27c x 23 c 1 c 2 c 3 c 4 c 5 c 6 c 11 c 12 g u x 2 u v δ ψ n δ and g r x 2 u v δ ψ n δ are used to predicted the surge speed and yaw angular velocity respectively 28 g u x 22 u v δ ψ n δ a 1 u k a 2 u k u k a 3 v k r k a 4 r k 2 a 5 u k v k a 6 u k r k a 7 n k 2 a 8 n k u k c o s δ k a 9 n k 2 a 10 n k u k s i n δ k 29 g r x 23 u v δ ψ n δ c 1 u k r k c 2 u k v k c 3 v k c 4 r k c 5 v k v k c 6 v k r k c 7 r k v k c 8 r k r k c 9 n k 2 c 10 n k u k c o s δ k c 11 n k 2 c 12 n k u k s i n δ k so as the surge motion when the motor speed is fixed the greater the steering angle is the greater the yaw angular velocity is and the lower the surge speed is when the motor speed and steering angle are fixed the surge speed the sway speed and yaw angular velocity will converge to a stable value based on the monotonic increase and decrease characteristics among steering angle yaw angular velocity and surge speed we can use parameters λ u and β u to construct inequality constraints between surge speed and steering angle we can use parameters λ ψ and β ψ to construct inequality constraints between yaw angular velocity and steering angle then the remaining parameters identification problem can also be treated as a nonlinear constrained optimization problem as eq 30 30 m i n f 2 x 2 1 2 k 1 n ν ˆ k ν k n s t g u x 2 λ u u i v j δ ψ j n j δ j λ u u j g u x 2 β u u j v j δ ψ j n j δ j β u u j g r x 2 u j v j λ ψ δ ψ j n j δ j λ ψ δ ψ j g r x 2 u j v j β ψ δ ψ j n j δ j β ψ δ ψ j where λ u 1 0 β u 1 λ ψ 1 0 β ψ 1 j 1 m 3 2 optimization method as the above objective eqs 26 and 30 are nonlinear the minimum value of the above equations cannot be derived analytically which has to be found by iterative numerical techniques the eq 30 is used here to illustrate how to use iterative methods to identify parameters due to the constraints the iterative numerical techniques cannot be used directly to find the minimum value therefore we rewrite the constraints of the eq 30 as an objective function f 3 x 2 as follows 31 f 3 x 2 e α g u x 2 λ u u j v j δ ψ j n j δ j λ u u j e α g u x 2 β u u j v j δ ψ j n j δ j β u u j e α g r x 2 u j v j λ ψ δ ψ j n j δ j λ ψ δ ψ j e α g r x 2 u j v j β ψ δ ψ j n j δ j β ψ δ ψ j j 1 m gain parameter α is a large constant and usually set to 100 when the constraint is not satisfied the objective function value f 3 will become very large however when the constraints are satisfied the objective function value f 3 is the sum of several negative power exponents or zero power exponents of e which is a very small value the problem of finding the minimum of eq 30 is equivalent to find the minimum value as the following equation 32 m i n f x 2 f 2 x 2 f 3 x 2 the nonlinear constraints optimization problem turns into an unconstrained nonlinear optimization problem as eq 32 several iterative numerical algorithms dennis jr and schnabel 1996 madsen et al 1999 and some software such as matlab or ceres solver are available for the nonlinear unconstrained optimization problem 4 identification results in this section the parameters of the asymmetric model are identified by the ls method and cmsp method respectively it is difficult to construct the inequality equations for the symmetric model due to the same port and starboard steering angle causes the different velocity and yaw angular velocity therefore the parameters of the symmetric model are only identified by the ls method the prediction results of different methods and models are compared to illustrate the effectiveness of the cmsp method and the better performance of the symmetric model all the experiments are conducted on songshan lake dongguan 4 1 surge motion model parameters identification in the experiments of identifying surge motion parameters to cover a wide range of surge velocity the range of motor speed of the water jet motor is from 1000 rpm to 3500 rpm the chosen motor speed covers a surge velocity range from 0 72 m s to 1 98 m s the max steering angle of heading controller in surge velocity identification experiments is restricted to 4 the steady states of the set rpm and constraint parameters of steady states are given in table 2 then the motor changes speed randomly in a certain range with 3500 rpm as upper bound and 1000 rpm as the lower bound the transient sets of surge velocity are used as training data to identify the parameters the parameters identified by the ls method cmsp method are shown in table 3 r square is used as an index function to quantitatively compare identification results as eq 33 the closer the r square to 1 the better the identified results x i ˆ x i and x i denote the prediction results experiment results and the mean value of the experiment results respectively 33 j e r r o r 1 i 1 n x i ˆ x i i 1 n x i ˆ x i fig 3 shows identification results of training sets the r square of ls method is 0 9903 and the r square of cmsp method is 0 9655 the results show that the ls method has better fitting results however the performance of different methods should consider the prediction results on both training sets and validation sets to further validate the effectiveness of the cmsp method another two validation sets are used to compare the prediction results fig 4 shows predicted results of parameters identified by different methods the r square value of the different models is 0 9598 parameters identified by ls method and 0 9954 parameters identified by cmsp method the yellow and green solid lines are corresponding to the upper and lower boundary of the inequality constraints due to the inequality constraints fixed motor speed prediction results such as 1000 rpm 2000 rpm and 3000 rpm are finally steady in the constraints zone however in the slow motor speed 1000 rpm and 1500 rpm situation the prediction results of the ls method are inaccurate fig 5 shows the prediction results in the transient state set different from the training set the r square value of the different model is 0 9640 parameters identified by ls method cmsp method and 0 9706 parameters identified by cmsp method in the identification process of the surge mode parameters the ls method has better performance than the cmsp method in the training set because the ls method aims to reduce the whole prediction error in the training set however the cmsp method has to guarantee the inequality constraints being satisfied in reducing the error of the prediction results in the training set thus the ls method may have better performance in the training set however inequality constraints are constructed from low motor speed 1000 rpm to high motor speed 3000 rpm which can guarantee the model parameters prediction results under the constrained zones from low motor speed to high motor speed the ls method can only reduce the whole prediction error but cannot guarantee to reduce local prediction error in conclusion the cmsp method has better performance in surge model parameters identification 4 2 sway and yaw model parameters identification the zigzag test to generate training data see fig 6 the upper parameters λ u and λ ψ are setting to 1 05 the lower parameter β u and β ψ are setting to 0 95 the gain parameter α is setting to 100 the value of the identified parameters is shown in table 4 the r square value of the identified model is shown in table 5 parameters ls bm represent the parameters identified by the ls method based on the symmetric model parameters ls represent the parameters identified by ls method based on the asymmetric model and parameters cmsp represent the parameters identified by the cmsp method based on the asymmetric model fig 6 shows the identified results in the training set from the perspective of the identification results the asymmetric model has a much better prediction performance than the symmetric model as for the identified results of the symmetric model the cmsp method has better prediction performance than the ls method by comparing the r square value the performance of different methods should consider the prediction results of the training set and validation sets another three different validation sets are used to validate the effectiveness of the cmsp method further in the validation set shown as fig 7 the motor is fixed at 1000 rpm initially then change to 2000 rpm at 172 s and finally change to 3000 rpm at 285 s a pseudo random binary sequence prbs excitation signal generates the steering angle all the time apparently the asymmetric model has better prediction performance than the symmetric model in all motions as for the ls method and the cmsp method the surge model prediction results are very close but cmsp has a much better prediction performance than the ls method in the sway model and yaw model from the perspective of the r square value in the validation set shown as fig 8 the motor speed is fixed at 2000 rpm the steering angle is set at 20 initially and changed to 20 at 428 s the yellow and black dashed lines are corresponding to the upper and lower boundary of the inequality constraints we can see from the prediction results that the asymmetric model has better performance than the symmetric model the prediction surge velocity and yaw angular velocity of the cmsp method are both in the constrained zone from the perspective of the r square value the prediction results of the sway model and yaw model are very close but the cmsp method has better performance than the ls method in the surge model in the validation set shown as fig 9 the motor speed is fixed at 3000 rpm the steering angle is set at 20 initially and changed to 20 at 428 s the yellow and black dashed lines are corresponding to the upper and lower boundary of the inequality constraints we can see from the prediction results that the asymmetric model has better performance than the symmetric model the prediction surge velocity and yaw angular velocity of the cmsp method are both in the constrained zone from the perspective of the r square value the cmsp method has better performance than the ls method in the surge model lateral model and yaw model in predicting the velocity and angular velocity at fixed motor speed and steering angle the predicted absolute value of the symmetric model is the same no matter the sign of the input steering angle is positive or negative however due to the characteristic of the water jet propulsion system even the steering angle has a different sign but the same absolute value the surge velocity lateral velocity and yaw angular velocity do not have the same absolute value the symmetric model is not enough for this situation and therefore has worse prediction performance than the asymmetric model as for the parameter identified in the asymmetric model the ls method aims to reduce the whole prediction error in the training set but the cmsp method has to guarantee the inequality constraints being satisfied in reducing the error of the prediction results in the training set so the parameters identified by different methods have a close performance in predicting the transient data but the parameters identified by the cmsp method have better performance in predicting the results of fixed input 5 analysis and conclusion in this paper a parameter identification method is proposed to identify the parameters of the vessel model base on the experiment data during the experiments the unknown time varying force generated by the wind wave and current work at the vessel and the force and moment generated by the propulsion system so the experiment data corresponding to a model that combines the vessel dynamics model and time varying disturbance dynamics model usually it is hard to build the model of the time varying disturbance and only the vessel dynamics model is considered in the parameter identification therefore the experiment data and the model to be identified do not match identification methods such as the least square method aim to reduce the error between the prediction results and training data overall however due to the training data not matching the model to be identified the identified parameters can have a good prediction result in the training set but cannot guarantee a good prediction result in the validation sets the purpose of the cmsp method is not to identify the real parameters of the vessel model instead it is to make the prediction results of the identified parameters match the experiment data in a wide range of the maneuvering in the cmsp method the identification problem becomes a nonlinear constraints optimization problem to solve it is difficult to tell if the nonlinear constraints optimization problem is a convex optimization problem or not most of the solving methods are based on the gradient descent method thus the identified parameters may be a suboptimal solution to the nonlinear constraints optimization problem also there could be no feasible solution to the nonlinear constraints optimization problem in some situations such as have lots of constraints how to solve the nonlinear constraints optimization problem is challenge work and needs further research furthermore the identified model will be used for controller design and simulation study purposes credit authorship contribution statement xudong wang conceptualization methodology formal analysis software data curation writing original draft writing review editing jin zhao supervision conceptualization writing review editing songjie liu software data curation visualization writing review editing tao geng software validation project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20294,a spatio temporal noise robust filtering method for separation of 2d incident and reflected irregular waves gustavo e coelho a b maria graça neves a antónio pascoal b álvaro ribeiro a peter frigaard c a laboratório nacional de engenharia civil lnec 1700 066 lisbon portugal laboratório nacional de engenharia civil lnec lisbon 1700 066 portugal laboratorio nacional de engenharia civil lnec 1700 066 lisbon portugal b instituto superior técnico ist universidade de lisboa ul 1049 001 lisbon portugal instituto superior técnico ist universidade de lisboa ul lisbon 1049 001 portugal instituto superior tecnico ist universidade de lisboa ul 1049 001 lisbon portugal c dept of civil eng aalborg university denmark dk 9220 aalborg ø denmark dept of civil eng aalborg university denmark aalborg ø dk 9220 denmark dept of civil eng aalborg university denmark dk 9220 aalborg oe denmark corresponding author laboratório nacional de engenharia civil lnec 1700 066 lisbon portugal laboratório nacional de engenharia civil lnec lisbon 1700 066 portugal a spatio temporal noise robust filtering method is proposed to separate 2d linear wave fields into incident and reflected irregular waves using water surface elevation gauges the method is based on phased array methodologies using delay and sum beamforming techniques with optimal noise attenuation the method is developed for an arbitrary number of gauges and can be applied in real time to surface elevation signals corrupted with measurement noise the impact of the number of gauges and the distance between them on the performance achievable with the method is thoroughly analysed and a methodology to choose their optimum values is proposed the robustness of the proposed method with respect to measurement noise is compared with the real time method proposed by frigaard and brorsen and is shown to be adequate for noise levels higher than 1 separation errors smaller than 3 and 7 are obtained for simulated signals without noise and with 10 added noise respectively keywords wave separation spatial filtering noise attenuation phased arrays beamforming 1 introduction physical and numerical modelling of wave induced processes involving wave generation with waves reflecting from a structure and reaching the generation zone rely heavily on the use of methods to separate incident from reflected waves through adequate processing of water surface elevation obtained with gauges however gauge signals can be corrupted with noise the intensity of which varies according to the experimental set up adopted electrical interferences are the main source of added noise especially in the cases where the experimental set up requires that wave surface elevation measurements be performed with multiple gauges placed at considerable distance from the signal acquisition equipment noise corrupted measurements could in principle be dealt with by processing them with analogue filters however this processing will unavoidably introduce unknown delays and or phase distortion in the gauge measurements thus precluding their use in real time applications of which hydrodynamic feedback for active wave absorption is a compelling example additionally active wave absorption is also sensitive to cumulative phase errors schäffer and klopman 2000 requiring thus appropriate real time wave separation methods robust to noise and phase distortions several methods for incident and reflected wave separation based on linear wave theory have been described in the literature in the frequency domain using 2 wave gauges goda and suzuki 1976 3 gauges mansard and funke 1980 and an arbitrary number of gauges zelt and skjelbreia 1992 in the time domain using 2 gauges frigaard and brorsen 1995 and in the time frequency domain using 2 gauges ma et al 2010 among these methods the one described in frigaard and brorsen 1995 was the first to be used for real time wave separation by applying digital finite impulse response fir filters directly to wave gauge measurements the method is widely use in active wave absorption systems frigaard and christensen 1995 the aforementioned methods are adequate for wave separation and yield good results albeit in ideal to low noise conditions as reported by goda and mansard the main sources of inaccuracy in the separation process arise from deviations from the linear wave theory assumption and the occurrence of noise on signal measurements in order to reduce these inaccuracies mansard and funke 1980 proposed a separation method using 3 gauges even though the authors did not present the analysis of the effect of noise on the results they concluded that this method lead to errors under low signal to noise ratio conditions the work in zelt and skjelbreia 1992 presents results for simulated wave gauge measurements with 2 of added noise the authors suggest that increasing the number of wave gauges improves separation accuracy and broadens the frequency band of interest of the study they also conclude that the main source of inaccuracy in the separation process is due to the presence of added noise in the simulated data even when using 8 gauges however no analysis of the influence of the percentage of noise into the results is presented lin and huang 2004 were the first to conduct a noise sensitive analysis revealing that their method is sensitive to noise and proposed a pre filtering process of the gauge data measurements to reduce noise levels in an extension of this work andersen et al 2017 analysed the performance of their separation method with respect to different signal to noise levels concluding that the method is noise robust up to 1 of noise added to test signals however in harsh physical laboratory environments noise up to 10 may occur moreover existing separation methods do not generally address the issues of robustness against measurement noise explicitly from a signal analysis perspective the main difficulty with incident and reflected waves separation resides in the fact that the incident and reflected signals have the same frequency content therefore classical filtering methodologies fail to adequately separate the waves fields and other signals such as noise that share the same bandwidth however there is a spatial temporal aspect that distinguishes these waves fields the incident and reflected waves propagate in opposite directions making it possible to use methods that exploit the spatio temporal domain using phased array methodologies the spatio temporal domain enables spatial filtering of signals whereby signals having different directions of propagation are separated even when they share the same bandwidth narrow band spatial filtering methods are widely used in radio transmission and broadcasting enhancement and in radar and sonar for tracking and detection in the last decades these methods have been implemented in the acoustics field for wide band applications and in the development of microphone arrays for noise cancellation and sound source tracking brandstein et al 2001 however to best of the authors knowledge these methods have never been applied to the separation of incident and reflected surface water waves this paper presents a spatio temporal noise robust filtering method for the separation of regular and irregular incident and reflected waves based on linear wave theory that exploits the use of beamforming techniques the proposed method is derived from a new perspective departs considerably from existing methods and avoids the gauge spacing singularities noise robustness is addressed and the number of gauges and their spacing are analysed the performance of the separation method is analysed qualitatively and quantitatively as a function of two physical phased array parameters the number of gauges and gauge spacing the paper is organised as follows section 2 presents the principles of phased array methods and describes their application to waves flumes along with a parametric analysis of the proposed method for separating incident and reflected waves section 3 assesses the performance of the proposed method using numerical simulations and discusses its robustness against data noise finally the conclusions and discussion of topics that warrant further research work are given in section 4 2 methodology the methodology hereby proposed to separate signals in real time is based on phased array techniques johnson and dudgeon 1993 van trees 2002 frequently used for interference separation in antennas narrow band and microphones wide band and not yet applied to water wave signals usually in electromagnetic and acoustics fields dispersion phenomena are negligible and thus the wave propagation speed or celerity is assumed constant for water waves the celerity is frequency dependent and is computed according to the well known linear dispersion relation a phased array model steers electronically an array of sensors towards a target direction or desired angle defined as θ θ t this process is normally referred as beamforming where a beam is formed in the direction of the target angle the beamforming technique implements the spatial filtering methods described in van trees 2002 whereby signals coming from the target direction are accepted and signals from other directions are strongly attenuated thus enhancing the signal in the desired direction 2 1 phased array signal model a phased array signal model uses water surface elevation data from an array of m gauges to filter signals in a space time domain consider a signal s t that propagates along a certain direction and is measured by an array of m gauges this method uses a uniform linear array ula i e all gauges are co linearly placed and equally spaced the signal propagation angle θ is defined as the angle between s t and the gauge array axis is in an anti clockwise direction see fig 1 the signal at each gauge i 1 m is a delayed version of s t corrupted by noise the noise at each gauge v i t is modelled as a random process that is uncorrelated with that of the other gauges spatially uncorrelated noise therefore the signal η i t is defined as having the same characteristics as s t but with an individual time delay τ i in vector form the signal η t is given by 1 η t s t τ v t η 1 t η 2 t η m t s t τ 1 s t τ 2 s t τ m v 1 t v 2 t v m t each time delay τᵢ dependents on the propagation angle θ the distance between gauges δ and the signal propagation speed c adopting the m th gauge as the reference the delay τᵢ is defined as follows 2 τ i θ m i δ c cosθ using the shifting property η t can be equivalently described in the frequency domain as 3 e ω s m m ω p ω θ v ω e 1 ω e 2 ω e m ω s ω e j ω τ 1 θ s ω e j ω τ 2 θ s ω e j ω τ m θ v 1 ω v 2 ω v m ω where ω denotes angular frequency 2π f with f the temporal frequency and s ω and v ω are the fourier transforms of s t and v t respectively in the above e ω is the fourier transform of the gauge signal with added noise η t as defined in 1 the diagonal matrix s mxm ω is defined as s mxm ω s ω i mxm where i mxm denotes the m by m identity matrix the vector p ω θ is defined for an arbitrary signal with propagation angle θ as 4 p ω θ e j ω τ 1 θ e j ω τ 2 θ e j ω τ m θ t the vector p defines the array manifold written in complex exponential form where j is the imaginary number 1 the array manifold incorporates all of the spatial characteristics of the array and is defined for 0 θ π and for each frequency ω in the above isotropic sensors are assumed i e wave gauges exhibiting the same gain for all frequencies and directions are considered each individual delay τᵢ can be described relative to an arbitrary reference the choice of the reference gauge only affects the sign of the delay τᵢ given the signal propagation angle θ however in the case of real time spatio temporal filtering implementation it is useful to keep the sign of the delay τᵢ in 2 positive since it avoids adding common delays in each gauge in this particular application in order to preserve the causality of the filtering process the m th gauge is adopted as the reference gauge this enables performing the spatial filtering with physically realizable impulses responses h i t see 5 without additional delays to steer the array towards a particular direction or angle θ t the surface elevation signals η i t are individually delayed and then summed this process is referred to as delay and sum beamforming the individual time delays τᵢ are chosen with the aim of achieving selective directional sensitivity in a specific direction therefore in the time domain the output from the phased array y t is defined as the sum of all surface elevation signals η i t convolved with the respective impulse response filter h i t that implements the delay τᵢ process for each ith gauge as in 5 formally 5 y t 1 m i 1 m h i t τ i η i t where is the convolution operator and 1 m normalises the output amplitude by the number of gauges the time shifting process in 5 implements the spatial filtering method in the time domain this objective is met by adjusting the time delays in such a way that signals propagating from a particular angle θ t the steered direction will be aligned in time before they are summed conversely signals propagating from other directions will not be aligned before the summation and therefore they will not add up coherently in the frequency domain this filtering is done by combining inputs of the array with pure imaginary gains and thus affecting only the phases of the input signals these imaginary gains in turn depends on the desired steered direction therefore the spatial filtering process enhances or rejects the signals according to their angles of propagation intuitively the steering process reverses the delays in the array manifold for a specific angle θ t only as follows 6 h ω p ω θ t where h defines the steering vector in the frequency domain for the target angle θ t and p is the conjugate symmetric of the array manifold p the latter plays an important role in the method and establishes a relationship between the free variables ω and θ and the array parameters m and δ the steering vector h is obtained from the array manifold p and implements the array steering to the desired angle θ t the impulse response filter in 5 is obtained by computing the inverse fourier transform ift of h the phased array performance for an arbitrary steering vector h is defined as the beam pattern response b ω θ given by 7 b ω θ 1 m h t ω p ω θ in the direction of the steered angle θ t the array should allow all signals to go through this implies that any signal arriving along the steered angle θ t will pass through the beamformer undistorted therefore in this case b ω θ t 1 for all frequencies this is normally referred as the distortionless constraint and is given as follows 8 1 m h t ω p ω θ t 1 the filter coefficients in h are scaled with a factor of 1 m as a consequence of the steering vector euclidean norm h m this factor also appears in time domain expression 5 and is a consequence of the generalization of the uniformly weighted phased array in other directions the array should ideally bock all signals in order to get a perfect spatial separation to investigate how much leakage as a function of frequency from signals in other directions affect our ideal separation the beam pattern response can be computed for different directions typically the beam pattern response absolute value b ω θ that defines the magnitude of amplification of signals with frequency ω propagating in the direction θ is evaluated since the array manifold p depends only on the array geometry it is possible to evaluate the influence of m and δ on the method s performance one of the purposes of the phased array is to improve the signal to noise ratio by adding signals coherently and noise incoherently since signals and noise are linearly superimposed the signal to noise ratio of the phased array can be calculated independently assuming spatially uncorrelated noise with similar noise spectrum s v ω at each gauge the spectrum to noise ratio denoted snr is given as follows 9 s n r i n ω s s ω s v ω where s s ω and s v ω denote the power spectra of the signal and noise at a generic gauge respectively considering the case of the presence of only noise the spectrum s y ω of the output y of the array due to noise is given by 10 s y ω 1 m h h s v ω h where h is the hermitian transpose and s v ω is the spectral matrix m by m of the input vector noise process v consisting of all v i s stacked together the notation ω in h is dropped in this section for the sake of expressions clarity for the case of spatially uncorrelated noise with similar noise power density spectrum at each gauge the output spectrum of the phase array is simplified as follows 11 s y ω 1 m 2 h 2 s v ω in the absence of noise the spectral output of the array s y ω is equal the signal spectrum s s ω as consequence of the distortionless constraint in 8 consequently at the output of the phased array the spectrum to noise ratio is given by 12 s n r o u t ω 1 1 m 2 h 2 s s ω s v ω the array noise gain a ng reflects the improvement in snr obtained by using the phased array it is defined as the ratio of the snr at the output of the array versus the snr at the input gauge that is 13 a n g s n r o u t ω s n r i n ω 1 m 2 h 2 1 therefore if we are trying to maximize the array noise gain in the presence of spatially uncorrelated noise a uniformly weighted array is optimum van trees 2002 in this case the array noise gain in 13 is simplified obtaining 14 a n g 1 m 2 h 2 1 i 1 m 1 m h i 2 1 m where h i represents the filter coefficients of vector h thus the array noise gain a ng dependents directly on the number of gauges used in the phased array 2 2 phased array implementation in wave flumes the phased array method is here applied to separate incident and reflected waves in a 2d flume the goal is to implement the beamforming techniques presented in 2 1 to perform spatial filtering in the incident wave direction the surface elevation for a progressive incident and reflected wave η i t x and η r t x respectively are given according to the general definition dean and dalrymple 1991 as follows 15 η i t x sin ω t k x φ i η r t x sin ω t k x φ r where φ is the initial phase with indices i and r denoting incident and reflected respectively consider a wave flume with an arbitrary number of m wave gauges positioned uniformly along the x axis with inter element distance δ fig 2 in the flume the surface elevation η t x is the superposition of the incident wave η i t x the reflected wave η r t x and the additive noise v t as follows 16 η t x η i t x η r t x v t the direction of the incident and reflected waves according to fig 1 are fixed at θ inc 0 and θ ref π respectively to obtain the incident wave field η i t from the surface elevation signals η i t the array is steered towards the incident direction θ t 0 therefore the output of the array in 5 gives the calculated incident surface elevation given by 17 η i c a l t 1 m i 1 m h i t τ i η i t the impulse response filter h i t for each i th gauge as a delay of τ i m i δ c defined according to 2 the impulse response filter in 17 is obtained by computing the ift of the array steering vector h as stated before in this case considering θ 0 and according to 6 the frequency domain steering vector h is given by 18 h ω e j k δ m 1 e j k δ m 2 1 t the presented method can be applied in both the time and frequency domains the results present in section 3 are implement in the time domain however since the beam pattern response b ω θ 7 is defined only in the frequency domain the spatio temporal filtering performance evaluation will be presented in the frequency domain to evaluate the wave separation performance based on an array of gauges the absolute value of the array beam pattern response b ω θ is analysed in the reflected wave s direction θ π as follows 19 b ω π 1 m h t ω p ω π in the reflected direction θ π ideally b ω π is close to zero to achieve complete separation of incident and reflected waves and consequently no leakage of the reflected waves into η i cal t is observed consequently the absolute value of 19 measures the amount of signal in the reflected direction that leaks to the incident direction for all frequencies ω in the incident direction θ 0 corresponds to the steered direction of h and therefore the beam pattern response is b ω 0 1 as already mention in expression 8 considering the surface elevation wave field in 16 with zero initial phase the corresponding surface elevation in the frequency domain is given by 20 e ω x a i ω e j k x a r ω e j k x v ω where e ω x and v ω are the fourier transforms of η t x and v t respectively and a i and a r are respectively the incident and reflected wave amplitudes at frequency ω given the linear superposition of the signals the following analysis of the calculated incident wave signal is done in the absence of noise signal in this case the calculated incident wave amplitude domain is given by 21 a i c a l ω b ω 0 a i ω b ω π a r ω since b ω 0 1 the expression in 21 can be further simplified to yield 22 a i c a l ω a i ω b ω π a r ω therefore the leakage of the reflected waves depends on the beam pattern response in the reflected direction as stated before as previously mentioned the array noise gain a ng is a function of the number of gauges m and independent of the gauge spacing δ and can be computed from the ratio between the array output and input power spectral density here the array noise robustness is presented as noise attenuation 1 a ng or noise rejection factor considering now the case of the presence of noise only and assuming spatially uncorrelated noise with similar noise power density spectrum at each gauge from expressions 9 12 and 13 simple manipulation show that 23 s y ω s v ω 1 a n g 1 m therefore the noise attenuation at the array output is expected to be proportional to the number of gauges in the case of a stochastic signals s y and s v in view of the fact that the power spectra at all the gauges are identical the noise attenuation factor defined in 23 can be computed directly from the variance of the array signal output y t and the input noise signal v t using the relation of instantaneous power and power spectral density of a stochastic signal oppenheim and verghese 2010 as follows 24 σ 2 y t σ 2 v t 1 m where σ 2 denotes de variance of the respective signal 2 3 parametric analysis the number of gauges and the spacing between them have direct effect on the performance of the separation and consequently on the range of frequencies or wavelengths that can be correctly separated by this method in this section the effect of the parameters on the efficacy of the proposed method is analysed and some guidelines for the choice of the parameters are given according to 23 it is clear that increasing the number of gauges m the noise rejection increases asymptotically from expression 22 the leakage of the reflected wave into the η i cal t directly depends on the beam pattern response in the reflection direction b ω π the beam pattern response in the reflection direction given in 19 may be expressed as follows 25 b ω π 1 m sin 2 m π δ λ sin 2 π δ λ the beam pattern response has a sinc like shape that depends on the number of gauges m and their spacing δ ideally b ω π 0 but this would require an unpractical large number of gauges however with suitable parameters m and δ is possible to obtain a feasible beam pattern response that enables performing wave field separation for a given range of frequencies or wavelengths the zeros of the beam pattern response b ω π 0 occur when the numerator of 25 is zero and the denominator is non zero thus the zeros are obtained for 26 λ 2 m δ n λ 2 δ n for n 1 m 1 this expression gives the wavelengths that the array can totally separate however the number of zeros in 26 are limited to the range of n 1 m 1 the grating lobes b ω π 1 occur when both the numerator and denominator of 25 are equal to zero and are obtained for 27 λ 2 δ n for n 1 2 the first grating lobe occurs for n 1 and determines the minimum effective wavelength therefore the gauge spacing δ determines the minimum wavelength that the array can resolve as follows 28 λ m i n 2 δ the sidelobes of b ω π 1 occur approximately when the numerator of 25 is maximum and are obtained for 29 λ s d l o b e 4 m 2 n 1 δ for n 1 m 2 substituting in 25 the sidelobe amplitude is given as 30 b λ s d l o b e π 1 m 1 sin 1 m π 2 2 n 1 1 m therefore the sidelobe amplitude is approximately inversely proportional to the number of gauges m and quantifies the leakage of the reflected signal into the incident direction 2 3 1 beam pattern response analysis as referred the gauge spacing δ and the number of gauges m influence the beam pattern results in general the gauge spacing δ contributes to the spatial resolution while the number of gauges m contributes to the frequency range this fact is related to the array aperture l that in practice reflects the capacity of the phased array to separate reflected longer waves this quantity is directly related to the distance between the 1st and the last gauge given by 31 l m δ therefore the optimal gauge number and spacing is ultimately achieved by the compromise between the minimum number of gauges and the required spatial resolution one outlined aspect of phased arrays is related to the gauge spacing δ λ 2 also present in previous separations methods and responsible for their singularity problems the solution presented before was narrowing the available frequency range of separation capabilities based in heuristic reasoning to avoid frequencies in the vicinity of the singularities nevertheless these singularities can also result in numerical instabilities as singularities are directly related to the divergence of the frequency filtering coefficients as already mentioned in the presented separation method the critical gauge spacing of δ λ 2 manifests itself as spatial aliasing where the beam pattern response achieves its maximum of magnitude normally referred as the grating lobes b ω π 1 thus one of the outline aspect in the proposed method is avoiding the singularity problem and the associated numerical instabilities moreover phased arrays methods enable to analyse the influence of m and δ parameters in the wave separation and forecasting the spatial filtering the beam pattern response b ω π plays an important role is this aspect as it delivers a framework for the performance analysis of the separation method as shown in fig 3 where the normalized beam pattern response is presented as a function of kδ for different number of gauges m as shown in this figure by increasing the number of gauges m the spatial sampling range increases this range is 1 m π kδ m 1 m π and determines the effective separation bandwidth this is in agreement with expression 26 where the number of zeros in b ω π increases with m moreover increasing m sidelobes amplitude decreases according to 30 increasing the attenuation of the reflected wave however independently of the number of gauges the array is not able to separate wave lengths shorter than 2δ k δ π as a consequence of spatial aliasing manifested as a periodic grating lobes with period π in this particular application the spatial aliasing effects contribute to a severe leakage of the signal in the reflected direction into the incident direction decreasing δ the same performance is achieve by increasing m this is as consequence of the constant array aperture in 31 the optimal spacing with the fewer number of gauges is achieved with kδ π δ λ 2 since spatial aliasing occurs for kδ π consequently while increasing δ will lead to aliasing phenomena decreasing δ will not substantially increase the attenuation performance this result is expected and is related to the sampling theorem where decreasing the spacing below δ λ min 2 corresponds to oversampling in the spatial domain therefore the number of gauges should be chosen by taking explicitly into account the frequency content of the wave signals 3 results the efficiency of the proposed method is here presented for irregular waves signals with known incident and reflected waves first the irregular waves are generated numerically in the absence of noise second only noise signals are generated to evaluate the method s noise robustness third irregular waves with noise signals are generated and finally the present method is compared with the method of frigaard and brorsen 1995 for different noise levels the waves are generated as the sum of two regular waves with frequencies f 1 0 4 hz and f 2 0 7 hz the amplitude of the incident wave is a i 0 01 m and the reflected wave is a r 0 005 m corresponding to 50 of the incident amplitude the surface elevation at each i th gauge η i is numerically generated as follows 32 η i t η i i t x i η r i t x i v i t η i i t x i a i sin 2 π f 1 t k 1 x i φ i a i sin 2 π f 2 t k 2 x i φ i η r i t x i a r sin 2 π f 1 t k 1 x i φ r a r sin 2 π f 2 t k 2 x i φ r in matrix form 33 η t η i t x η r t x v t η 1 t η 2 t η m t η i 1 t x 1 η i 2 t x 2 η i m t x m η r 1 t x 1 η r 2 t x 2 η r m t x m v 1 t v 2 t v m t where φ is the initial phase with indices i and r denoting incident and reflected respectively and k is the wave number related with ω through the linear dispersion relation the position x i is relative to the gauge spacing δ as follows 34 x i δ i 1 for i 1 2 m the noise signals v i t i 1 m are generated as samples of mutually uncorrelated gaussian random processes given by 35 v i t μ a i n where μ is the amount of noise in relative to the incident wave amplitude a i and n is the t dimensional random vector with uncorrelated components and n t n 0 1 in physical modelling wave measurements are corrupted by noise with an amplitude that can vary from 2 to 10 of the incident wave amplitude thus to conclude about noise robustness equivalent values of μ and higher were employed the signals are sampled with a frequency of 6 4 hz with n 64 discrete frequencies the numerically generated data is filtered with the steering vector h as described in the last section to apply this spatial filtering method in the time domain the corresponding steering vector impulse response h is obtained by computing the ift of the discrete h with n taps the result of the proposed method is the calculated incident wave η i cal t obtain by convolving the steering vector impulse responses h with the generated signals η t given in 17 the water depth was considered constant with h 0 5 m for signals without noise η i cal t is calculated for 3 different array parameters pairs m 2 δ 0 9 m m 3 δ 0 9 m m 5 δ 0 5 m the error obtained during the filter n taps length 10 s referred by some authors as the warm up time frigaard and brorsen 1995 is due the convolution transient and only affects the initial filtering process after n samples the transient at the output of the filter has subsided the relative error η i η i cal η i in percentage is calculated as 36 η i η i c a l η i r m s η i m η i c a l r m s η i m 100 where η im is the incident free surface elevation at the m th gauge the reference gauge since the efficiency of this method depends on the chosen values of m and δ fig 4 presents η i η i cal and the corresponding error for different pairs of parameters m and δ for signals without noise even though it is recommended to use more than 2 gauges the results for m 2 δ 0 9 m are here presented for comparison purpose for δ 0 9 m for 3 and 5 gauges δ was 0 9 and 0 5 respectively the normalized beam pattern response is presented in fig 5 the vertical lines correspond to kδ values computed for frequencies f 1 0 4 hz and f 2 0 7 hz and gauges spacing δ 0 9 m and δ 0 5 m represented as k1δ9 k2δ9 k1δ5 k2δ5 respectively for m 2 δ 0 9 m the relative error is as expected considerable high 25 2 for m 3 δ 0 9 m the gauge number and spacing chosen covers the frequency range of interest since k1δ9 from 0 4 hz and k2δ9 from 0 7 hz are the vicinity of the beam pattern response nulls and relative errors of 2 3 is achieve for m 5 δ 0 5 m the same reasoning applies for k1δ5 and k2δ5 and relative error of 3 1 are obtained m 5 enables to separate higher frequencies up to 1 1 hz than m 3 since gauge spacing was reduced while the array aperture was maintained approximately constant summarizing low relative errors less than 3 are obtained if m and δ correctly chosen to evaluate the robustness of the method in dealing with noise one of the goals of the present method noise signals v t are applied in the absence of incident and reflected waves η i t v i t with μ 100 according to expressions 24 the relative noise attenuation of the array in is computed as 37 n o i s e a t t e n u a t i o n 1 σ o u t 2 σ i n 2 100 where σ2 out represents the noise variance at the output of the phased array the calculated signal and σ2 in is the noise variance at the reference gauge m since the noise signals are random processes each signal results in a different attenuation in order to evaluate the influence of the randomness on the results 100 uncorrelated noise were generated for the same m fig 6 presents the relative noise attenuation for m varying from 1 to 10 the solid line represents the theoretical relative noise attenuation given by 1 1 m 100 the results obtained for each m are presented together with their average the results show that the noise attenuation is consistent and follows the theoretical value they also show the influence of the number of gauges on the attenuation with the noise output mean variance being reduced for higher m in summary the proposed method can adequately attenuate the noise signals and the magnitude of attenuation increases with the number of gauges m for m 3 a noise attenuation of 66 and 80 is obtained for m 5 to evaluate the response of the proposed method for signals with noise the spatial uncorrelated noise signal is added to the simulated incident and reflected waves presented before the case without noise noise signals v i t are generated with μ 30 corresponding to 30 of the incident wave amplitude fig 7 this is an extreme case for noise robustness analysis simulation for the purpose of visualization other values of noise and array parameters where also employed a table summarizing the method s relative errors obtained for different phased array parameters m and δ and noise μ is given in table 1 even though there is an increase in the error obtained by the method when noise is added to the signal with a correct choice of m and δ the method attenuates the noise and can lead to errors up to 6 1 for added noise μ up to 10 fig 7 present η i η i cal and the corresponding relative error for each pair of parameters m and δ tested as expected the relative error is higher than the obtained for the same signal without noise for m 3 δ 0 9 m the relative error increases from 2 3 without noise to 6 1 with noise μ 10 for phased array parameters m 2 δ 0 9 m the relative error is 26 1 reducing to 5 4 for m 5 δ 0 5 m fig 8 presents a comparison for the data presented before between frigaard and brorsen s method frigaard and brorsen 1995 and the present method for an added noise μ from 0 to 5 to evaluate the influence of the randomness on the results 100 spatial uncorrelated noise signals were generated for the same μ frigaard and brorsen s method f b uses 2 gauges m 2 and therefore only gauge spacing is change δ 0 2 m δ0 2 and δ 0 9 m δ0 9 for the present method pm three array parameters combinations are used m 3 and δ 0 9 m m3δ0 9 m 5 and δ 0 5 m m5δ0 5 and m 2 and δ 0 9 m m2δ0 9 the figure shows that frigaard and brorsen s method is very effective in wave separation in low noise conditions μ 0 4 the proposed method is very effective for higher noise levels μ 0 6 if an adequate choice of m and δ is made for the presented case the proposed method achieves noise robustness for larger noise levels with m 5 and δ 0 5 m with m 2 and δ 0 9 m as expected only achieves better performance than frigaard and brorsen s method for noise levels above 4 5 with undesirable average relative error greater than 25 in general the proposed method presents low dispersion in the relative errors but needs more than 2 gauges to achieve acceptable relative errors in the wave separation therefore the proposed method should be applied with more than 2 gauges and is recommended for noise levels higher than 0 4 when signal pre filtering is not possible or viable 4 conclusions a spatial temporal filtering method using phased arrays with an arbitrary number of gauges was proposed to separate 2d linear wave fields into incident and reflected irregular waves based on surface elevation signals with noise this spatial temporal filtering is done directly to the surface elevation wave gauge data and can be implemented in both the time domain using h or the frequency domain using h the steering vector is obtained for the incident wave propagation direction and is a function of the number of gauges m and their uniform spacing δ the steering vector accuracy in separating wave fields is measured directly thorough the beam pattern response the accuracy of the method depends on the adequate choice of m and δ and can be tailored for the specific range frequencies of the waves and also the noise amplitude in general the larger the number of gauges used the better noise and reflected wave rejection is achieved however for practical use is possible to define wavelengths where total rejection of reflected waves is achieved by using 26 it is also possible to estimate the secondary lobe amplitudes by using 30 and thus the expected rejection of the reflected waves in an irregular wave scenario for surface elevation signals without noise separation errors less than 3 can be obtained with just a 3 gauge array for surface elevation signals with 10 of noise separation errors less than 6 can be obtain with a 5 gauge array in what concerns noise attenuation this method achieves suitable noise attenuation and the magnitude of the attenuation increases with the number of gauges used the uncorrelated noise can be attenuated 66 in average with a 3 gauge array and 80 in average with a 5 gauge array the method is a conceptually simple application of efficient phased array techniques with optimal noise attenuation and thus especially suited for gauge measurements with uncorrelated noise to the best of the authors knowledge this type of method was never applied to the separation of incident and reflected waves although the proposed method is sensitive to gauge spacing it is very robust to noise therefore the proposed method is recommended in gauge measurements with noise greater than 1 where pre filtering is not viable or possible additionally the beam pattern response enables to chose the gauge number and spacing between them that optimizes the method s performance one of the advantages of increasing the number of gauges is to broaden the effective frequency range with good performance moreover this method avoids the gauge spacing singularities and the associated numerical instabilities however spatial aliasing occurs meaning that separation of waves is not feasible for wavelength shorter than 2 times the gauge spacing 2δ this approach also enables to implement an arbitrary number of gauges without the need to use approximations such as the least squares methods that can lead to erroneous estimates under low signal to noise ratio conditions the proposed method also enables to directly apply a fir filtering procedure to measured wave field and thus appropriate to real time applications such as active wave absorption systems however the proposed method is sensitive to gauge spacing and 3 or more gauges are required to achieve adequate wave separation there is however room for improvement in the phased array approach exploring other array spacing e g non uniform spacing such as log spacing or nested arrays has the potential to improve wave field separation accuracy without compromising gauge noise attenuation the presented method can be adapted and improved in order to be applied to directional wave fields separation and 3d wave absorption systems declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author acknowledges the support of fundação para a ciência e tecnologia fct through the grant no srfh bd 136899 2018 appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 multimedia component 4 multimedia component 4 multimedia component 5 multimedia component 5 multimedia component 6 multimedia component 6 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2021 109544 
20294,a spatio temporal noise robust filtering method for separation of 2d incident and reflected irregular waves gustavo e coelho a b maria graça neves a antónio pascoal b álvaro ribeiro a peter frigaard c a laboratório nacional de engenharia civil lnec 1700 066 lisbon portugal laboratório nacional de engenharia civil lnec lisbon 1700 066 portugal laboratorio nacional de engenharia civil lnec 1700 066 lisbon portugal b instituto superior técnico ist universidade de lisboa ul 1049 001 lisbon portugal instituto superior técnico ist universidade de lisboa ul lisbon 1049 001 portugal instituto superior tecnico ist universidade de lisboa ul 1049 001 lisbon portugal c dept of civil eng aalborg university denmark dk 9220 aalborg ø denmark dept of civil eng aalborg university denmark aalborg ø dk 9220 denmark dept of civil eng aalborg university denmark dk 9220 aalborg oe denmark corresponding author laboratório nacional de engenharia civil lnec 1700 066 lisbon portugal laboratório nacional de engenharia civil lnec lisbon 1700 066 portugal a spatio temporal noise robust filtering method is proposed to separate 2d linear wave fields into incident and reflected irregular waves using water surface elevation gauges the method is based on phased array methodologies using delay and sum beamforming techniques with optimal noise attenuation the method is developed for an arbitrary number of gauges and can be applied in real time to surface elevation signals corrupted with measurement noise the impact of the number of gauges and the distance between them on the performance achievable with the method is thoroughly analysed and a methodology to choose their optimum values is proposed the robustness of the proposed method with respect to measurement noise is compared with the real time method proposed by frigaard and brorsen and is shown to be adequate for noise levels higher than 1 separation errors smaller than 3 and 7 are obtained for simulated signals without noise and with 10 added noise respectively keywords wave separation spatial filtering noise attenuation phased arrays beamforming 1 introduction physical and numerical modelling of wave induced processes involving wave generation with waves reflecting from a structure and reaching the generation zone rely heavily on the use of methods to separate incident from reflected waves through adequate processing of water surface elevation obtained with gauges however gauge signals can be corrupted with noise the intensity of which varies according to the experimental set up adopted electrical interferences are the main source of added noise especially in the cases where the experimental set up requires that wave surface elevation measurements be performed with multiple gauges placed at considerable distance from the signal acquisition equipment noise corrupted measurements could in principle be dealt with by processing them with analogue filters however this processing will unavoidably introduce unknown delays and or phase distortion in the gauge measurements thus precluding their use in real time applications of which hydrodynamic feedback for active wave absorption is a compelling example additionally active wave absorption is also sensitive to cumulative phase errors schäffer and klopman 2000 requiring thus appropriate real time wave separation methods robust to noise and phase distortions several methods for incident and reflected wave separation based on linear wave theory have been described in the literature in the frequency domain using 2 wave gauges goda and suzuki 1976 3 gauges mansard and funke 1980 and an arbitrary number of gauges zelt and skjelbreia 1992 in the time domain using 2 gauges frigaard and brorsen 1995 and in the time frequency domain using 2 gauges ma et al 2010 among these methods the one described in frigaard and brorsen 1995 was the first to be used for real time wave separation by applying digital finite impulse response fir filters directly to wave gauge measurements the method is widely use in active wave absorption systems frigaard and christensen 1995 the aforementioned methods are adequate for wave separation and yield good results albeit in ideal to low noise conditions as reported by goda and mansard the main sources of inaccuracy in the separation process arise from deviations from the linear wave theory assumption and the occurrence of noise on signal measurements in order to reduce these inaccuracies mansard and funke 1980 proposed a separation method using 3 gauges even though the authors did not present the analysis of the effect of noise on the results they concluded that this method lead to errors under low signal to noise ratio conditions the work in zelt and skjelbreia 1992 presents results for simulated wave gauge measurements with 2 of added noise the authors suggest that increasing the number of wave gauges improves separation accuracy and broadens the frequency band of interest of the study they also conclude that the main source of inaccuracy in the separation process is due to the presence of added noise in the simulated data even when using 8 gauges however no analysis of the influence of the percentage of noise into the results is presented lin and huang 2004 were the first to conduct a noise sensitive analysis revealing that their method is sensitive to noise and proposed a pre filtering process of the gauge data measurements to reduce noise levels in an extension of this work andersen et al 2017 analysed the performance of their separation method with respect to different signal to noise levels concluding that the method is noise robust up to 1 of noise added to test signals however in harsh physical laboratory environments noise up to 10 may occur moreover existing separation methods do not generally address the issues of robustness against measurement noise explicitly from a signal analysis perspective the main difficulty with incident and reflected waves separation resides in the fact that the incident and reflected signals have the same frequency content therefore classical filtering methodologies fail to adequately separate the waves fields and other signals such as noise that share the same bandwidth however there is a spatial temporal aspect that distinguishes these waves fields the incident and reflected waves propagate in opposite directions making it possible to use methods that exploit the spatio temporal domain using phased array methodologies the spatio temporal domain enables spatial filtering of signals whereby signals having different directions of propagation are separated even when they share the same bandwidth narrow band spatial filtering methods are widely used in radio transmission and broadcasting enhancement and in radar and sonar for tracking and detection in the last decades these methods have been implemented in the acoustics field for wide band applications and in the development of microphone arrays for noise cancellation and sound source tracking brandstein et al 2001 however to best of the authors knowledge these methods have never been applied to the separation of incident and reflected surface water waves this paper presents a spatio temporal noise robust filtering method for the separation of regular and irregular incident and reflected waves based on linear wave theory that exploits the use of beamforming techniques the proposed method is derived from a new perspective departs considerably from existing methods and avoids the gauge spacing singularities noise robustness is addressed and the number of gauges and their spacing are analysed the performance of the separation method is analysed qualitatively and quantitatively as a function of two physical phased array parameters the number of gauges and gauge spacing the paper is organised as follows section 2 presents the principles of phased array methods and describes their application to waves flumes along with a parametric analysis of the proposed method for separating incident and reflected waves section 3 assesses the performance of the proposed method using numerical simulations and discusses its robustness against data noise finally the conclusions and discussion of topics that warrant further research work are given in section 4 2 methodology the methodology hereby proposed to separate signals in real time is based on phased array techniques johnson and dudgeon 1993 van trees 2002 frequently used for interference separation in antennas narrow band and microphones wide band and not yet applied to water wave signals usually in electromagnetic and acoustics fields dispersion phenomena are negligible and thus the wave propagation speed or celerity is assumed constant for water waves the celerity is frequency dependent and is computed according to the well known linear dispersion relation a phased array model steers electronically an array of sensors towards a target direction or desired angle defined as θ θ t this process is normally referred as beamforming where a beam is formed in the direction of the target angle the beamforming technique implements the spatial filtering methods described in van trees 2002 whereby signals coming from the target direction are accepted and signals from other directions are strongly attenuated thus enhancing the signal in the desired direction 2 1 phased array signal model a phased array signal model uses water surface elevation data from an array of m gauges to filter signals in a space time domain consider a signal s t that propagates along a certain direction and is measured by an array of m gauges this method uses a uniform linear array ula i e all gauges are co linearly placed and equally spaced the signal propagation angle θ is defined as the angle between s t and the gauge array axis is in an anti clockwise direction see fig 1 the signal at each gauge i 1 m is a delayed version of s t corrupted by noise the noise at each gauge v i t is modelled as a random process that is uncorrelated with that of the other gauges spatially uncorrelated noise therefore the signal η i t is defined as having the same characteristics as s t but with an individual time delay τ i in vector form the signal η t is given by 1 η t s t τ v t η 1 t η 2 t η m t s t τ 1 s t τ 2 s t τ m v 1 t v 2 t v m t each time delay τᵢ dependents on the propagation angle θ the distance between gauges δ and the signal propagation speed c adopting the m th gauge as the reference the delay τᵢ is defined as follows 2 τ i θ m i δ c cosθ using the shifting property η t can be equivalently described in the frequency domain as 3 e ω s m m ω p ω θ v ω e 1 ω e 2 ω e m ω s ω e j ω τ 1 θ s ω e j ω τ 2 θ s ω e j ω τ m θ v 1 ω v 2 ω v m ω where ω denotes angular frequency 2π f with f the temporal frequency and s ω and v ω are the fourier transforms of s t and v t respectively in the above e ω is the fourier transform of the gauge signal with added noise η t as defined in 1 the diagonal matrix s mxm ω is defined as s mxm ω s ω i mxm where i mxm denotes the m by m identity matrix the vector p ω θ is defined for an arbitrary signal with propagation angle θ as 4 p ω θ e j ω τ 1 θ e j ω τ 2 θ e j ω τ m θ t the vector p defines the array manifold written in complex exponential form where j is the imaginary number 1 the array manifold incorporates all of the spatial characteristics of the array and is defined for 0 θ π and for each frequency ω in the above isotropic sensors are assumed i e wave gauges exhibiting the same gain for all frequencies and directions are considered each individual delay τᵢ can be described relative to an arbitrary reference the choice of the reference gauge only affects the sign of the delay τᵢ given the signal propagation angle θ however in the case of real time spatio temporal filtering implementation it is useful to keep the sign of the delay τᵢ in 2 positive since it avoids adding common delays in each gauge in this particular application in order to preserve the causality of the filtering process the m th gauge is adopted as the reference gauge this enables performing the spatial filtering with physically realizable impulses responses h i t see 5 without additional delays to steer the array towards a particular direction or angle θ t the surface elevation signals η i t are individually delayed and then summed this process is referred to as delay and sum beamforming the individual time delays τᵢ are chosen with the aim of achieving selective directional sensitivity in a specific direction therefore in the time domain the output from the phased array y t is defined as the sum of all surface elevation signals η i t convolved with the respective impulse response filter h i t that implements the delay τᵢ process for each ith gauge as in 5 formally 5 y t 1 m i 1 m h i t τ i η i t where is the convolution operator and 1 m normalises the output amplitude by the number of gauges the time shifting process in 5 implements the spatial filtering method in the time domain this objective is met by adjusting the time delays in such a way that signals propagating from a particular angle θ t the steered direction will be aligned in time before they are summed conversely signals propagating from other directions will not be aligned before the summation and therefore they will not add up coherently in the frequency domain this filtering is done by combining inputs of the array with pure imaginary gains and thus affecting only the phases of the input signals these imaginary gains in turn depends on the desired steered direction therefore the spatial filtering process enhances or rejects the signals according to their angles of propagation intuitively the steering process reverses the delays in the array manifold for a specific angle θ t only as follows 6 h ω p ω θ t where h defines the steering vector in the frequency domain for the target angle θ t and p is the conjugate symmetric of the array manifold p the latter plays an important role in the method and establishes a relationship between the free variables ω and θ and the array parameters m and δ the steering vector h is obtained from the array manifold p and implements the array steering to the desired angle θ t the impulse response filter in 5 is obtained by computing the inverse fourier transform ift of h the phased array performance for an arbitrary steering vector h is defined as the beam pattern response b ω θ given by 7 b ω θ 1 m h t ω p ω θ in the direction of the steered angle θ t the array should allow all signals to go through this implies that any signal arriving along the steered angle θ t will pass through the beamformer undistorted therefore in this case b ω θ t 1 for all frequencies this is normally referred as the distortionless constraint and is given as follows 8 1 m h t ω p ω θ t 1 the filter coefficients in h are scaled with a factor of 1 m as a consequence of the steering vector euclidean norm h m this factor also appears in time domain expression 5 and is a consequence of the generalization of the uniformly weighted phased array in other directions the array should ideally bock all signals in order to get a perfect spatial separation to investigate how much leakage as a function of frequency from signals in other directions affect our ideal separation the beam pattern response can be computed for different directions typically the beam pattern response absolute value b ω θ that defines the magnitude of amplification of signals with frequency ω propagating in the direction θ is evaluated since the array manifold p depends only on the array geometry it is possible to evaluate the influence of m and δ on the method s performance one of the purposes of the phased array is to improve the signal to noise ratio by adding signals coherently and noise incoherently since signals and noise are linearly superimposed the signal to noise ratio of the phased array can be calculated independently assuming spatially uncorrelated noise with similar noise spectrum s v ω at each gauge the spectrum to noise ratio denoted snr is given as follows 9 s n r i n ω s s ω s v ω where s s ω and s v ω denote the power spectra of the signal and noise at a generic gauge respectively considering the case of the presence of only noise the spectrum s y ω of the output y of the array due to noise is given by 10 s y ω 1 m h h s v ω h where h is the hermitian transpose and s v ω is the spectral matrix m by m of the input vector noise process v consisting of all v i s stacked together the notation ω in h is dropped in this section for the sake of expressions clarity for the case of spatially uncorrelated noise with similar noise power density spectrum at each gauge the output spectrum of the phase array is simplified as follows 11 s y ω 1 m 2 h 2 s v ω in the absence of noise the spectral output of the array s y ω is equal the signal spectrum s s ω as consequence of the distortionless constraint in 8 consequently at the output of the phased array the spectrum to noise ratio is given by 12 s n r o u t ω 1 1 m 2 h 2 s s ω s v ω the array noise gain a ng reflects the improvement in snr obtained by using the phased array it is defined as the ratio of the snr at the output of the array versus the snr at the input gauge that is 13 a n g s n r o u t ω s n r i n ω 1 m 2 h 2 1 therefore if we are trying to maximize the array noise gain in the presence of spatially uncorrelated noise a uniformly weighted array is optimum van trees 2002 in this case the array noise gain in 13 is simplified obtaining 14 a n g 1 m 2 h 2 1 i 1 m 1 m h i 2 1 m where h i represents the filter coefficients of vector h thus the array noise gain a ng dependents directly on the number of gauges used in the phased array 2 2 phased array implementation in wave flumes the phased array method is here applied to separate incident and reflected waves in a 2d flume the goal is to implement the beamforming techniques presented in 2 1 to perform spatial filtering in the incident wave direction the surface elevation for a progressive incident and reflected wave η i t x and η r t x respectively are given according to the general definition dean and dalrymple 1991 as follows 15 η i t x sin ω t k x φ i η r t x sin ω t k x φ r where φ is the initial phase with indices i and r denoting incident and reflected respectively consider a wave flume with an arbitrary number of m wave gauges positioned uniformly along the x axis with inter element distance δ fig 2 in the flume the surface elevation η t x is the superposition of the incident wave η i t x the reflected wave η r t x and the additive noise v t as follows 16 η t x η i t x η r t x v t the direction of the incident and reflected waves according to fig 1 are fixed at θ inc 0 and θ ref π respectively to obtain the incident wave field η i t from the surface elevation signals η i t the array is steered towards the incident direction θ t 0 therefore the output of the array in 5 gives the calculated incident surface elevation given by 17 η i c a l t 1 m i 1 m h i t τ i η i t the impulse response filter h i t for each i th gauge as a delay of τ i m i δ c defined according to 2 the impulse response filter in 17 is obtained by computing the ift of the array steering vector h as stated before in this case considering θ 0 and according to 6 the frequency domain steering vector h is given by 18 h ω e j k δ m 1 e j k δ m 2 1 t the presented method can be applied in both the time and frequency domains the results present in section 3 are implement in the time domain however since the beam pattern response b ω θ 7 is defined only in the frequency domain the spatio temporal filtering performance evaluation will be presented in the frequency domain to evaluate the wave separation performance based on an array of gauges the absolute value of the array beam pattern response b ω θ is analysed in the reflected wave s direction θ π as follows 19 b ω π 1 m h t ω p ω π in the reflected direction θ π ideally b ω π is close to zero to achieve complete separation of incident and reflected waves and consequently no leakage of the reflected waves into η i cal t is observed consequently the absolute value of 19 measures the amount of signal in the reflected direction that leaks to the incident direction for all frequencies ω in the incident direction θ 0 corresponds to the steered direction of h and therefore the beam pattern response is b ω 0 1 as already mention in expression 8 considering the surface elevation wave field in 16 with zero initial phase the corresponding surface elevation in the frequency domain is given by 20 e ω x a i ω e j k x a r ω e j k x v ω where e ω x and v ω are the fourier transforms of η t x and v t respectively and a i and a r are respectively the incident and reflected wave amplitudes at frequency ω given the linear superposition of the signals the following analysis of the calculated incident wave signal is done in the absence of noise signal in this case the calculated incident wave amplitude domain is given by 21 a i c a l ω b ω 0 a i ω b ω π a r ω since b ω 0 1 the expression in 21 can be further simplified to yield 22 a i c a l ω a i ω b ω π a r ω therefore the leakage of the reflected waves depends on the beam pattern response in the reflected direction as stated before as previously mentioned the array noise gain a ng is a function of the number of gauges m and independent of the gauge spacing δ and can be computed from the ratio between the array output and input power spectral density here the array noise robustness is presented as noise attenuation 1 a ng or noise rejection factor considering now the case of the presence of noise only and assuming spatially uncorrelated noise with similar noise power density spectrum at each gauge from expressions 9 12 and 13 simple manipulation show that 23 s y ω s v ω 1 a n g 1 m therefore the noise attenuation at the array output is expected to be proportional to the number of gauges in the case of a stochastic signals s y and s v in view of the fact that the power spectra at all the gauges are identical the noise attenuation factor defined in 23 can be computed directly from the variance of the array signal output y t and the input noise signal v t using the relation of instantaneous power and power spectral density of a stochastic signal oppenheim and verghese 2010 as follows 24 σ 2 y t σ 2 v t 1 m where σ 2 denotes de variance of the respective signal 2 3 parametric analysis the number of gauges and the spacing between them have direct effect on the performance of the separation and consequently on the range of frequencies or wavelengths that can be correctly separated by this method in this section the effect of the parameters on the efficacy of the proposed method is analysed and some guidelines for the choice of the parameters are given according to 23 it is clear that increasing the number of gauges m the noise rejection increases asymptotically from expression 22 the leakage of the reflected wave into the η i cal t directly depends on the beam pattern response in the reflection direction b ω π the beam pattern response in the reflection direction given in 19 may be expressed as follows 25 b ω π 1 m sin 2 m π δ λ sin 2 π δ λ the beam pattern response has a sinc like shape that depends on the number of gauges m and their spacing δ ideally b ω π 0 but this would require an unpractical large number of gauges however with suitable parameters m and δ is possible to obtain a feasible beam pattern response that enables performing wave field separation for a given range of frequencies or wavelengths the zeros of the beam pattern response b ω π 0 occur when the numerator of 25 is zero and the denominator is non zero thus the zeros are obtained for 26 λ 2 m δ n λ 2 δ n for n 1 m 1 this expression gives the wavelengths that the array can totally separate however the number of zeros in 26 are limited to the range of n 1 m 1 the grating lobes b ω π 1 occur when both the numerator and denominator of 25 are equal to zero and are obtained for 27 λ 2 δ n for n 1 2 the first grating lobe occurs for n 1 and determines the minimum effective wavelength therefore the gauge spacing δ determines the minimum wavelength that the array can resolve as follows 28 λ m i n 2 δ the sidelobes of b ω π 1 occur approximately when the numerator of 25 is maximum and are obtained for 29 λ s d l o b e 4 m 2 n 1 δ for n 1 m 2 substituting in 25 the sidelobe amplitude is given as 30 b λ s d l o b e π 1 m 1 sin 1 m π 2 2 n 1 1 m therefore the sidelobe amplitude is approximately inversely proportional to the number of gauges m and quantifies the leakage of the reflected signal into the incident direction 2 3 1 beam pattern response analysis as referred the gauge spacing δ and the number of gauges m influence the beam pattern results in general the gauge spacing δ contributes to the spatial resolution while the number of gauges m contributes to the frequency range this fact is related to the array aperture l that in practice reflects the capacity of the phased array to separate reflected longer waves this quantity is directly related to the distance between the 1st and the last gauge given by 31 l m δ therefore the optimal gauge number and spacing is ultimately achieved by the compromise between the minimum number of gauges and the required spatial resolution one outlined aspect of phased arrays is related to the gauge spacing δ λ 2 also present in previous separations methods and responsible for their singularity problems the solution presented before was narrowing the available frequency range of separation capabilities based in heuristic reasoning to avoid frequencies in the vicinity of the singularities nevertheless these singularities can also result in numerical instabilities as singularities are directly related to the divergence of the frequency filtering coefficients as already mentioned in the presented separation method the critical gauge spacing of δ λ 2 manifests itself as spatial aliasing where the beam pattern response achieves its maximum of magnitude normally referred as the grating lobes b ω π 1 thus one of the outline aspect in the proposed method is avoiding the singularity problem and the associated numerical instabilities moreover phased arrays methods enable to analyse the influence of m and δ parameters in the wave separation and forecasting the spatial filtering the beam pattern response b ω π plays an important role is this aspect as it delivers a framework for the performance analysis of the separation method as shown in fig 3 where the normalized beam pattern response is presented as a function of kδ for different number of gauges m as shown in this figure by increasing the number of gauges m the spatial sampling range increases this range is 1 m π kδ m 1 m π and determines the effective separation bandwidth this is in agreement with expression 26 where the number of zeros in b ω π increases with m moreover increasing m sidelobes amplitude decreases according to 30 increasing the attenuation of the reflected wave however independently of the number of gauges the array is not able to separate wave lengths shorter than 2δ k δ π as a consequence of spatial aliasing manifested as a periodic grating lobes with period π in this particular application the spatial aliasing effects contribute to a severe leakage of the signal in the reflected direction into the incident direction decreasing δ the same performance is achieve by increasing m this is as consequence of the constant array aperture in 31 the optimal spacing with the fewer number of gauges is achieved with kδ π δ λ 2 since spatial aliasing occurs for kδ π consequently while increasing δ will lead to aliasing phenomena decreasing δ will not substantially increase the attenuation performance this result is expected and is related to the sampling theorem where decreasing the spacing below δ λ min 2 corresponds to oversampling in the spatial domain therefore the number of gauges should be chosen by taking explicitly into account the frequency content of the wave signals 3 results the efficiency of the proposed method is here presented for irregular waves signals with known incident and reflected waves first the irregular waves are generated numerically in the absence of noise second only noise signals are generated to evaluate the method s noise robustness third irregular waves with noise signals are generated and finally the present method is compared with the method of frigaard and brorsen 1995 for different noise levels the waves are generated as the sum of two regular waves with frequencies f 1 0 4 hz and f 2 0 7 hz the amplitude of the incident wave is a i 0 01 m and the reflected wave is a r 0 005 m corresponding to 50 of the incident amplitude the surface elevation at each i th gauge η i is numerically generated as follows 32 η i t η i i t x i η r i t x i v i t η i i t x i a i sin 2 π f 1 t k 1 x i φ i a i sin 2 π f 2 t k 2 x i φ i η r i t x i a r sin 2 π f 1 t k 1 x i φ r a r sin 2 π f 2 t k 2 x i φ r in matrix form 33 η t η i t x η r t x v t η 1 t η 2 t η m t η i 1 t x 1 η i 2 t x 2 η i m t x m η r 1 t x 1 η r 2 t x 2 η r m t x m v 1 t v 2 t v m t where φ is the initial phase with indices i and r denoting incident and reflected respectively and k is the wave number related with ω through the linear dispersion relation the position x i is relative to the gauge spacing δ as follows 34 x i δ i 1 for i 1 2 m the noise signals v i t i 1 m are generated as samples of mutually uncorrelated gaussian random processes given by 35 v i t μ a i n where μ is the amount of noise in relative to the incident wave amplitude a i and n is the t dimensional random vector with uncorrelated components and n t n 0 1 in physical modelling wave measurements are corrupted by noise with an amplitude that can vary from 2 to 10 of the incident wave amplitude thus to conclude about noise robustness equivalent values of μ and higher were employed the signals are sampled with a frequency of 6 4 hz with n 64 discrete frequencies the numerically generated data is filtered with the steering vector h as described in the last section to apply this spatial filtering method in the time domain the corresponding steering vector impulse response h is obtained by computing the ift of the discrete h with n taps the result of the proposed method is the calculated incident wave η i cal t obtain by convolving the steering vector impulse responses h with the generated signals η t given in 17 the water depth was considered constant with h 0 5 m for signals without noise η i cal t is calculated for 3 different array parameters pairs m 2 δ 0 9 m m 3 δ 0 9 m m 5 δ 0 5 m the error obtained during the filter n taps length 10 s referred by some authors as the warm up time frigaard and brorsen 1995 is due the convolution transient and only affects the initial filtering process after n samples the transient at the output of the filter has subsided the relative error η i η i cal η i in percentage is calculated as 36 η i η i c a l η i r m s η i m η i c a l r m s η i m 100 where η im is the incident free surface elevation at the m th gauge the reference gauge since the efficiency of this method depends on the chosen values of m and δ fig 4 presents η i η i cal and the corresponding error for different pairs of parameters m and δ for signals without noise even though it is recommended to use more than 2 gauges the results for m 2 δ 0 9 m are here presented for comparison purpose for δ 0 9 m for 3 and 5 gauges δ was 0 9 and 0 5 respectively the normalized beam pattern response is presented in fig 5 the vertical lines correspond to kδ values computed for frequencies f 1 0 4 hz and f 2 0 7 hz and gauges spacing δ 0 9 m and δ 0 5 m represented as k1δ9 k2δ9 k1δ5 k2δ5 respectively for m 2 δ 0 9 m the relative error is as expected considerable high 25 2 for m 3 δ 0 9 m the gauge number and spacing chosen covers the frequency range of interest since k1δ9 from 0 4 hz and k2δ9 from 0 7 hz are the vicinity of the beam pattern response nulls and relative errors of 2 3 is achieve for m 5 δ 0 5 m the same reasoning applies for k1δ5 and k2δ5 and relative error of 3 1 are obtained m 5 enables to separate higher frequencies up to 1 1 hz than m 3 since gauge spacing was reduced while the array aperture was maintained approximately constant summarizing low relative errors less than 3 are obtained if m and δ correctly chosen to evaluate the robustness of the method in dealing with noise one of the goals of the present method noise signals v t are applied in the absence of incident and reflected waves η i t v i t with μ 100 according to expressions 24 the relative noise attenuation of the array in is computed as 37 n o i s e a t t e n u a t i o n 1 σ o u t 2 σ i n 2 100 where σ2 out represents the noise variance at the output of the phased array the calculated signal and σ2 in is the noise variance at the reference gauge m since the noise signals are random processes each signal results in a different attenuation in order to evaluate the influence of the randomness on the results 100 uncorrelated noise were generated for the same m fig 6 presents the relative noise attenuation for m varying from 1 to 10 the solid line represents the theoretical relative noise attenuation given by 1 1 m 100 the results obtained for each m are presented together with their average the results show that the noise attenuation is consistent and follows the theoretical value they also show the influence of the number of gauges on the attenuation with the noise output mean variance being reduced for higher m in summary the proposed method can adequately attenuate the noise signals and the magnitude of attenuation increases with the number of gauges m for m 3 a noise attenuation of 66 and 80 is obtained for m 5 to evaluate the response of the proposed method for signals with noise the spatial uncorrelated noise signal is added to the simulated incident and reflected waves presented before the case without noise noise signals v i t are generated with μ 30 corresponding to 30 of the incident wave amplitude fig 7 this is an extreme case for noise robustness analysis simulation for the purpose of visualization other values of noise and array parameters where also employed a table summarizing the method s relative errors obtained for different phased array parameters m and δ and noise μ is given in table 1 even though there is an increase in the error obtained by the method when noise is added to the signal with a correct choice of m and δ the method attenuates the noise and can lead to errors up to 6 1 for added noise μ up to 10 fig 7 present η i η i cal and the corresponding relative error for each pair of parameters m and δ tested as expected the relative error is higher than the obtained for the same signal without noise for m 3 δ 0 9 m the relative error increases from 2 3 without noise to 6 1 with noise μ 10 for phased array parameters m 2 δ 0 9 m the relative error is 26 1 reducing to 5 4 for m 5 δ 0 5 m fig 8 presents a comparison for the data presented before between frigaard and brorsen s method frigaard and brorsen 1995 and the present method for an added noise μ from 0 to 5 to evaluate the influence of the randomness on the results 100 spatial uncorrelated noise signals were generated for the same μ frigaard and brorsen s method f b uses 2 gauges m 2 and therefore only gauge spacing is change δ 0 2 m δ0 2 and δ 0 9 m δ0 9 for the present method pm three array parameters combinations are used m 3 and δ 0 9 m m3δ0 9 m 5 and δ 0 5 m m5δ0 5 and m 2 and δ 0 9 m m2δ0 9 the figure shows that frigaard and brorsen s method is very effective in wave separation in low noise conditions μ 0 4 the proposed method is very effective for higher noise levels μ 0 6 if an adequate choice of m and δ is made for the presented case the proposed method achieves noise robustness for larger noise levels with m 5 and δ 0 5 m with m 2 and δ 0 9 m as expected only achieves better performance than frigaard and brorsen s method for noise levels above 4 5 with undesirable average relative error greater than 25 in general the proposed method presents low dispersion in the relative errors but needs more than 2 gauges to achieve acceptable relative errors in the wave separation therefore the proposed method should be applied with more than 2 gauges and is recommended for noise levels higher than 0 4 when signal pre filtering is not possible or viable 4 conclusions a spatial temporal filtering method using phased arrays with an arbitrary number of gauges was proposed to separate 2d linear wave fields into incident and reflected irregular waves based on surface elevation signals with noise this spatial temporal filtering is done directly to the surface elevation wave gauge data and can be implemented in both the time domain using h or the frequency domain using h the steering vector is obtained for the incident wave propagation direction and is a function of the number of gauges m and their uniform spacing δ the steering vector accuracy in separating wave fields is measured directly thorough the beam pattern response the accuracy of the method depends on the adequate choice of m and δ and can be tailored for the specific range frequencies of the waves and also the noise amplitude in general the larger the number of gauges used the better noise and reflected wave rejection is achieved however for practical use is possible to define wavelengths where total rejection of reflected waves is achieved by using 26 it is also possible to estimate the secondary lobe amplitudes by using 30 and thus the expected rejection of the reflected waves in an irregular wave scenario for surface elevation signals without noise separation errors less than 3 can be obtained with just a 3 gauge array for surface elevation signals with 10 of noise separation errors less than 6 can be obtain with a 5 gauge array in what concerns noise attenuation this method achieves suitable noise attenuation and the magnitude of the attenuation increases with the number of gauges used the uncorrelated noise can be attenuated 66 in average with a 3 gauge array and 80 in average with a 5 gauge array the method is a conceptually simple application of efficient phased array techniques with optimal noise attenuation and thus especially suited for gauge measurements with uncorrelated noise to the best of the authors knowledge this type of method was never applied to the separation of incident and reflected waves although the proposed method is sensitive to gauge spacing it is very robust to noise therefore the proposed method is recommended in gauge measurements with noise greater than 1 where pre filtering is not viable or possible additionally the beam pattern response enables to chose the gauge number and spacing between them that optimizes the method s performance one of the advantages of increasing the number of gauges is to broaden the effective frequency range with good performance moreover this method avoids the gauge spacing singularities and the associated numerical instabilities however spatial aliasing occurs meaning that separation of waves is not feasible for wavelength shorter than 2 times the gauge spacing 2δ this approach also enables to implement an arbitrary number of gauges without the need to use approximations such as the least squares methods that can lead to erroneous estimates under low signal to noise ratio conditions the proposed method also enables to directly apply a fir filtering procedure to measured wave field and thus appropriate to real time applications such as active wave absorption systems however the proposed method is sensitive to gauge spacing and 3 or more gauges are required to achieve adequate wave separation there is however room for improvement in the phased array approach exploring other array spacing e g non uniform spacing such as log spacing or nested arrays has the potential to improve wave field separation accuracy without compromising gauge noise attenuation the presented method can be adapted and improved in order to be applied to directional wave fields separation and 3d wave absorption systems declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author acknowledges the support of fundação para a ciência e tecnologia fct through the grant no srfh bd 136899 2018 appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 multimedia component 4 multimedia component 4 multimedia component 5 multimedia component 5 multimedia component 6 multimedia component 6 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2021 109544 
