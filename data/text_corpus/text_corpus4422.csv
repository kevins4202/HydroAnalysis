index,text
22110,to the underwater vehicle its self excited vibration induced by friction in the stern bearing is the non ignorable component of the propeller vibration and noise this paper describes how to solve the self excited vibration and discuss the effects on the self excited vibration and its stick slip phenomenon after making the analysis about the supporting characteristics between shaft and hull substructures this paper takes the shaft hull coupled system as the analysis object and constructs the fem finite element method model of the system based on the fem model validated by the experiment the required modal frequencies and the shapes of the shaft and the hull are calculated then the friction force between shaft and water lubricated rubber bearing is calculated according to the stribeck friction curve hereafter through the friction force the modal shapes of the shaft and the hull are combined to establish the nonlinear differential governing equations of the shaft hull coupled system by employing the modal synthesis method of substructures subsequently the self excited vibration responses induced by the friction can be obtained by solving the nonlinear differential governing equations by runge kutta method on this basis the discussions about the effects of friction coefficient damping ratio rotation speed and support stiffness on the self excited vibration of the shaft hull coupled system are conducted the results show that the larger the damping is or the faster the rotation of shaft is or the stronger the supporting stiffness is the more difficultly the shaft hull coupled system s self excited vibration will happen the works on how to solve the self excited vibration induced by friction in the stern bearing will be of great significance to accurately predict the propeller vibration and noise and optimize the acoustic design of the underwater vehicle keywords underwater vehicle shaft hull coupled system water lubricated rubber bearing self excited vibration stick slip 1 introduction the self excited vibration induced by friction in the stern bearing is the important component of the propeller vibration and noise of the underwater vehicle yu et al 2015 a majority of the research on the vehicle s propeller vibration and noise has ignored the self excited vibration induced by friction in the stern bearing and only considers vibration excited by the loads that include the unsteady transverse and longitudinal exciting loads located in the propeller kang et al 2019 c li et al 2019 h li et al 2019a 2019b 2019c moreover many researchers focus on the free vibration characteristics of the underwater vehicle lee and kwak 2015 explored the vibration behaviors of the cylindrical shell and compared of different shell theories for solving related problems poultangari and nikkhah 2017 developed victorial wave approach to research the vibration issue of the cylindrical shell wu and pang 2018 proposed the precise integration transfer matrix method pitmm to research free vibration behaviors of the conical shells pang et al 2018 2019 and li et al 2019 employed the semi analytical method and flügge thin shell theory to solve the free vibration behaviors for spherical cylindrical spherical shell with arbitrary boundary conditions but none of them took into account that the vibration response induced by friction in the stern bearing of the underwater vehicle however in the real engineering due to the propeller cantilever arrangement the hull uneven deformation resulted from water pressure the shaft inaccurate alignment conditions difficultly forming the condition of the liquid dynamic lubrication and so on litwin 2015 at this time the bearing directly contacts with the journal subsequently the friction force between shaft and water lubricated rubber bearings arises which induces the self excited vibration of the shaft hull coupled system the self excited vibration therefore is the component of the shaft hull coupled system vibration even sometimes play a leading role therefore it is necessary to devote efforts to research the underwater vehicle self excited vibration induced by friction in the stern bearing which will be of great significance to accurately predict the propeller vibration and noise and optimize the acoustic design of the underwater vehicle krauter 1981 constructed a multi layer bearing model simulated the couple of the shaft neck torsion vibration and interface friction pointed out the self excited vibration resulted from the mode instability simpson and ibrahim 1996 analyzed the dynamic behavior of shaft bearing system excited by friction revealed the influence of physical parameters such as hardness and length on system stability he et al 2012 researched on the rubber hardness and friction property of low noise water lubricated bearing however they merely studied on itself structure of the rubber bearing and did not put it into the whole underwater vehicle system thus the oversimplified model cannot reveal the influence of the friction excitation on the vibration of the overall shaft hull coupled system in detail moreover the water lubricated stern bearing and shaft system regarded as research object jin 2014 studied on the stability of transverse and friction coupling vibration the motion law of the coupling system the tribological properties and friction vibration recognition method zhang et al 2014 investigated the friction induced vibration of a propeller shaft system supported by the water lubricated rubber bearing they found that the negative damping was a key parameter through a series of analysis on the stability and vibration response of the system and the bearing vibration played a dominant role in the present system in order to ensure the good lubrication for water lubricated stern tube bearings under low speed working conditions guo et al 2017 designed and produced a biomimetic materials based on the properties of lignum vita the analysis results showed that there were significant differences in the tribological properties of the rubbing pairs in different concentration of guaiacum laboratory tests are performed to ascertain the friction induced vibration characteristics of a stern rubber bearing by the peng and tan 2018 the pressure temperature and speed of the rubber bearing are adjusted until friction phenomena occurs and the time domain spectrum frequency domain spectrum and shaft orbit test technology are then utilized to obtaining the vibration characteristics of the stern rubber bearing which provided an supporting technology for the identification of the abnormal friction in the stern bearings and low noise design of the stern bearings lin et al 2019 proposed a 3 dof mode coupling model of the water lubricated rubber bearing and journal coupled system considering perturbations of the stochastic rough surface based on the model a new phenomenon is found that the magnification of vibration will occur when two mode frequencies get close to each other yet their researches focused on the performance of the rubber material friction and the lubrication experiment of bearing not involved in the vibration of shaft hull coupled system and related influencing factors therefore to the underwater vehicle self excited vibration induced by friction in the stern bearing this paper takes the shaft hull couple system as the analysis object establishes the fem model of the shaft hull couple system after making the analysis about the supporting characteristics between shaft and hull substructures based on the fem model validated by the experiment the required modal frequencies and the shapes of the shaft and the hull are calculated then according to the stribeck friction curve zhang et al 2019 the friction force between shaft and water lubricated rubber bearings is calculated through the friction force the modal shapes of the shaft and the hull are combined to establish the nonlinear differential governing equations of the shaft hull coupled system by employing the modal synthesis method of substructures subsequently the self excited vibration responses induced by the friction can be obtained by solving the nonlinear differential governing equations by the fourth order runge kutta method finally the effects on the shaft hull coupled system s self excited vibration induced by friction are discussed 2 the shaft hull coupled system of the underwater vehicle the shaft system and the hull system are the main constituent structures of the underwater vehicle the shaft system includes propeller shaft segments thrust plate and bearing housings propeller produces thrust force and unsteady excitation the shaft system is the part that connects the main engine to the propeller and is also the main transferring channel in which the force and the vibration of the propeller are passed on to the whole hull the hull system contains the hull shell bearing bases coupling active part and engine unit the excitation caused by the propeller rotation is transmitted to the hull system through the shaft and bearings which results in the hull s complex vibration and noise in the previous study the shaft and the hull were studied separately however in the recent research it has been found the coupled effects of the shaft hull on their respective dynamic characteristics can t be neglected hence it is necessary to construct the shaft hull coupled system to research on the vehicle self excited vibration induced by friction in the stern bearing due to the complexity of the underwater vehicle and the limitation of the theoretical analysis the theoretical analysis on the model of the underwater vehicle can t satisfy the requirements of the analysis as a result this paper establishes the 1 4 large scale simplified shaft hull coupled system according to one actual underwater vehicle as shown in fig 1 2 1 the fem model establishment of the shaft hull coupled system using the fem software named abaqus6 11 the fem models of the shaft subsystem and the shaft hull coupled system are established in turn subsequently the mode analysis of the shaft hull coupled system is conducted by the software 2 1 1 the fem model establishment of the shaft subsystem the shaft subsystem includes the shaft segments thrust plate propeller the stern intermediate and thrust bearing and bearing housings the shaft segments can be regarded as equal straight beam with uniform cross section the mass effect of thrust plate and propeller is used as the concentrated mass and the moment of inertia in their positions the shaft system is constrained by the stern intermediate and thrust bearings the stern and intermediate bearing have a radial support to the shaft which can be simplified to both the horizontal and vertical direction each direction is made up of three spring damping elements which are different in position stiffness and damping parameters the main thrust bearings constrain both the radial and axial movement of the shaft so the radial and axial constraints of the main thrust bearing are simulated by the spring damping element respectively the equivalent shaft system is shown in fig 2 the shaft length and the location of the bearing are shown in fig 3 and the bearing related parameters in the shaft system are shown in table 1 the shaft segments are simulated by beam element the type and quantity of the element respectively are b31 and 6568 the size of the beam element is 0 02 m the stern intermediate and thrust bearing can be simplified as the spring damping element the quantity of the element is 21 the thrust plate are simulated by solid element the type and quantity of the element respectively are c3d8r and 1839 the propeller is simplified as mass point and given concentrated mass and concentrated moment of inertia the stern intermediate and thrust bearing housing can be simplified as rigid body and given concentrated mass and concentrated moment of inertia the type and quantity of the element respectively are r3d4 and 687 2 1 2 the fem model establishment of the shaft hull coupled system the hull system contains the hull shell bearing bases coupling active part and motor unit the excitation caused by the propeller rotation is transmitted to the hull system through the shaft and bearings which results in the hull s complex vibration and generates the noise the main body of the hull is a combination of the cylinder and conical shell which are simulated by the shell element the type and quantity of the element respectively are s4r and 43347 the size of the shell element is 0 1 m the thrust bearing bases are also simulated by the shell element the type and quantity of the element respectively are s4r and 15624 the motor housing are simplified as rigid body and given concentrated mass and concentrated moment of inertia the type and quantity of the element respectively are r3d4 and 295 besides the isolations between the motor block and the base are simulated by the spring damping element the quantity of the element is 4 according to the dimension of shaft hull coupled system and the above selection law of element type the fem model of the shaft hull coupled system is completely established the stern finite element model of the shaft hull couple system is shown in fig 4 the corresponding element types and quantity are shown in table 2 when vehicle sails underwater the water does not limit its any degree of freedom so its boundary constraint is free after making the modal analysis five overall modes of the fem model are selected and shown in fig 5 with the purpose of facilitating to describe and analyze the dominant deformation mode in bending direction is named as the bend mode and the dominant deformation mode in longitudinal direction is named as the longitudinal mode so the first order to the third order bend mode the first order torsional and the first order longitudinal mode are shown in fig 5 2 2 the experimental validation of fem model of the shaft hull coupled system the shaft hull coupled system is a complex structure and there are many factors influencing the vibration response of the system if the accuracy of the fem model of the shaft hull coupled system can t be ensured the research conclusion will not reflect the actual vibration characteristics of the vehicle therefore in order to verify the accuracy of the fem model the vibration experiment on the shaft hull coupled system has been carried out when tested the exciting force generated from the vibration exciter acts on the location of the propeller then the accelerometers located in the thrust bearing housing the stern middle and bow of the vehicle send acceleration signals to the acquisition and analysis device with 64 channels at the same time force sensor also send force signal to the acquisition and analysis device fig 6 shows the connection diagram of the experiment devices fig 7 shows the measuring points arrangement of the experiment model in the mode test in addition every measuring point is placed by a tri axial accelerometer when the experiment finishes the all cross sectional vibration data are integrated into the whole vibration and then the modal frequency of the experiment model are obtained the modal frequency contrast of the experiment and calculation from fem model of the shaft hull coupled system is shown in table 3 it can be seen that the error of their modal frequency is less than 5 which demonstrates that the fem model established in this paper is enough accurate the thrust bearing is the most important path where vibration is transmitted from the shaft system to the hull system so the vibration verification of thrust bearing can better illustrate the accuracy of fem model of the shaft hull coupled system and the bearing s simplified method the bearings are simplified to the spring damping element in order to excite the vibration of the system the vibration exciter is installed in the position where the propeller is located the points which are outside the thrust bearing housing and located in the stern and bow of the vehicle are arranged to be measuring points at the point outside the thrust bearing housing the vibration acceleration responses from the fem model and the experiment are compared in fig 8 at the points located in the stern and bow of the vehicle the vibration acceleration responses from the fem model and the experiment are compared in fig 9 two reasons result in the deviation between experimental and calculation especially at high frequency one is that the fem model is just simplified from the practical shaft hull coupled system which leads that the mode number of the fem model is less than that of the practical system the other is that the fem is difficult to exactly calculate the high frequency vibration limited by the mesh size the decreasing of the mesh size will merely improve the calculation frequency slightly however cause the sharply increasing of the computational efforts after the modal frequency and vibration responses contrast of the experiment and the fem model it can be seen that the modal frequency and vibration responses of the fem model agree well with that of the experiment therefore the fem model of the shaft hull coupled system this paper constructs is enough accurate 3 solutions to the self excited vibration of the shaft hull coupled system induced by the friction the required modal frequencies and modal shapes can be calculated based on the fem model of the shaft hull coupled system constructed in section 2 and validated by the experiment then through the friction force model on the interface of the shaft and the stern bearing the modal shapes c li et al 2019 h li et al 2019a 2019b 2019c of the shaft and the hull are combined to establish the nonlinear differential governing equations of the shaft hull coupled system in modal coordinate by employing the modal synthesis method of substructures subsequently the self excited vibration responses in modal coordinates induced by the friction of the shaft hull coupled system can be obtained by solving the nonlinear differential governing equations in the modal coordinate by the means of fourth order runge kutta method after converting the responses into physics coordinates the self excited vibration responses in physics coordinates can be obtained the above calculation process has been written as code which can be implemented in matlab 3 1 the friction model of the water lubricated rubber bearing when the vehicle sails underwater the stern bearing separates the inner structure from the outer water therefore the water lubricated rubber stern bearing is required to ensure the shaft normally working fig 10 shows the water lubricated rubber bearing the external copper bush can ensure the overall bearing strength and the internal slab rubber with the diversion trench can enhance the lubrication in the case of low rotation speed and heavy duty the lubrication condition between the journal and the bearing loses in the state of boundary lubrication or mixed lubrication on the assumption that the rotation speed of the shaft is ω the support force f n that is generated in the interface of the shaft and the bearing points to the axis the friction force f is proportional to the support force and it can be equivalent to a friction force f f through the axis and a friction moment m f the forces diagram of the journal and the bearing are seen in fig 11 the friction moment m f will hinder the rotation of the shaft and cause the torsional vibration and the friction force f f will induce the cyclotron vibration the friction force and moment are the function of the system s parameters and friction coefficient which will cause the transverse and torsional vibration of the shaft through the coupling in all directions in addition the coupling in all directions make the shaft hull coupled system to be a self vibration system with both force feedback and motion feedback with the liquid dynamic lubrication conditions the friction coefficient of the sliding bearing is related to relative sliding speed of which the behavior can be described by the stribeck curve in fig 12 where η represents the lubricant viscosity u represents the sliding speed w represents the support load moreover the stribeck curve has been confirmed by a lot of experiments because the water lubricated rubber bearing possesses the diversion trench its lubrication state should be in the state of the mixed lubrication which satisfies the following equations 1 f f μ d v f n 2 μ d v sgn v μ 0 μ 1 exp β 0 v 3 v r 0 ω φ x x 1 t where v is the relative speed on the interface between the shaft and the bearing ω is the constant speed of the shaft φ x is the shaft s torsion angle induced by the torsional vibration φ x x 1 t the torsional vibration angle speed f n is the support force on the interface when the friction parameters zhang et al 2014 are respectively μ 0 0 05 μ 1 0 34 β 0 3 the relationship of friction coefficient and relative speed is shown in fig 13 in the shaft hull coupled system the support forces f n are supplied by the spring damping element in the y and z directions it can be described by the following equation f n k y y 1 y 2 2 k z z 1 z 2 2 which can be broken into the transverse and vertical support force as follows 4 f n y k y y 1 y 2 f n z k z z 1 z 2 the equivalent frication force f f and moment m f can also be broken into the y and z direction written as the following equations 5 f f y μ d v k z z 1 z 2 f f z μ d v k z y 1 y 2 m f μ d v r 0 f n 3 2 the differential governing equations establishment based on the modal synthesis method of substructures and its solution to a time invariant system of n degrees of freedom with an external excitation its behavior equation is described by 6 m x c x k x f x t x is the displacement response vector f t is the excitation vector m and k are respectively the mass and stiffness matrixes that have symmetric real element fu 1990 the mode matrix consists of the mode vectors as follows 7 φ ϕ 1 ϕ 2 ϕ n where n is the quantity of degrees of freedom each mode vector reflects the vibration shape of the corresponding mode in order to guarantee the accuracy and improve the calculation speed the modal reduced method is applied then the former n order general modes of the structure are intercepted as follows 8 φ m ϕ 1 ϕ 2 ϕ m any displacement component x can be approximately written as 9 x q 1 ϕ 1 q 2 ϕ 2 q m ϕ m base on eqs 8 and 9 represent equation 8 and equation 9 the response vector of the structure satisfies the following equation 10 x φ m q m where q m is the modal coordinate vector after substituting eq 10 into eq 6 and both sides are multiplied by φ m t the structure behavior equation in the modal coordinate can be described as 11 m q c q k q r q t where m is the modal mass matrix and k is the modal stiffness matrix 12 m φ m t m φ m 13 k φ m t k φ m 14 r q t φ m t f x t assuming the system damping is proportional damping then 15 c α m β k eq 15 is converted to modal coordinates it is given by 16 c α m β k to the multi system coupling problem the coupling problem can be transformed into the differential equation of motion the underwater vehicle mainly consists of the shaft system and the hull system using subscript 1 to indicate the parameters of the shaft system and subscript 2 to indicate the parameters of the hull system two subsystems are combined into the coupling system the nonlinear differential governing equations described by its blocks in modal coordinate satisfy the following equations 17 m 1 0 0 m 2 q 1 q 2 c 1 0 0 c 2 q 1 q 2 k 1 0 0 k 2 q 1 q 2 r 1 r 2 18 r 1 φ m 1 t f 1 19 r 2 φ m 2 t f 2 where f 1 f 2 are the external excitation vectors of two subsystems their vector elements are non zero only in the interface position and any subsystem excitation vector contains the motion parameters of another subsystem specifically speaking under the supporting of the bearing the excitations on interface position of the shaft and bearing are the functions of the displacement on the interface in the friction force area of the stern bearing the relationship of the friction force and the displacement is described by eq 5 through defining the parameters of eq 5 in the calculation program the two subsystems are combined into the coupled model this paper solves the nonlinear differential governing equations eq 17 by the fourth order runge kutta method after the response q in modal coordinates be solve converting the response to physics coordinates by eq 20 the self excited vibration responses of the shaft hull coupled system in physics coordinates can be obtained 20 x φ q 4 the effects on the self excited vibration induced by the friction of the shaft hull coupled system and its stick slip phenomenon 4 1 the effects of the system parameters on self excited vibration through the calculation it can be known that when the fore middle and after support stiffness of the stern bearing are respectively 1 5 106 n m 3 106 n m 1 5 106 n m and the rotation speed and the modal damping are respectively 20 r min and ζ 0 001 the self excited vibration of the shaft hull coupled system does not happen until the friction coefficient raises to be μ 0 0 03 its response in time domain is depicted in fig 14 this date set is used as a reference data set both the theoretical analysis and experimental results indicate that many factors and system parameters influence the happen of the self excited vibration induced by friction obviously the self excited vibration induced by friction is directly related to the friction coefficient when the shaft hull coupled system is in the same condition the larger the friction coefficient is the larger the friction force is and the more easily the system self excited vibration will happen in addition the causes of the self excited vibration are also related to other factors such as modal damping ratio rotation speed and support stiffness subsequently these factors are respectively discussed 4 1 1 friction coefficient the self excited vibration induced by friction can be divided into different instability mechanisms to the system with time invariant support force the happening condition of self excited vibration is that the derivative of the friction coefficient versus the speed is negative like as follows 21 d μ d v d v 0 seen from fig 13 when the relative speed is small the derivative of the friction coefficient versus the speed keeps negative which satisfies the happening condition of system self excited vibration however the support force is the transverse torsion coupled time variant force in this paper in this condition although the friction coefficient is constant the stability of steady state slid of the system is also probably broken which will lead to the happen of the self excited vibration in order to investigate the happening condition of the self excited vibration defining the friction coefficient as the product of the sign function and the constant then the transverse vibration response of the shaft hull coupled system is shown in fig 15 obviously the self excited vibration also happens which indicates that the happening condition of the self excited vibration of the shaft hull coupled system is that the derivative of the time variant support force versus the speed becomes negative therefore although the friction coefficient is constant the self excited vibration also probably happens 4 1 2 damping ratio damping consumes the energy of the system and the larger the damping is the more stable the system will be so the modal damping ratio has a direct effect on the convergence of the self excited vibration in addition it can be expected that as the modal damping ratio increases the energy consumption of the system will increase and the self excited vibration will be less likely to generate in order to verify the effect of damping ratio on the self excited vibration the rotation speed is kept as 20 rpm choose the multiple sets of damping ratio then change the friction coefficient from small to large until the shaft hull coupled system produces self excited vibration and define the friction coefficient where the self excited vibration just occurs as the critical friction coefficient thus the critical friction coefficient can measure the difficulty level of the happening of the self excited vibration and the smaller the critical friction coefficient is the more easily the self excited vibration happen after calculation when the modal damping ratio is ζ 0 the critical friction coefficient is μ 0 0 01 where the self excited vibration just occurs seen in fig 16 a when the modal damping ratio is ζ 0 001 the critical friction coefficient is μ 0 0 03 when the modal damping ratio is ζ 0 01 the critical friction coefficient is μ 0 0 5 shown in fig 16 b the results show that the modal damping ratio increases the critical friction coefficient will increase the self excited vibration of the shaft hull coupled system will be more difficult to form seen in fig 17 the conclusion agrees well with our prediction 4 1 3 rotation speed the rotation speed of shaft has a multiple effect on the self excited vibration on the one hand when the shaft slowly rotates the friction coefficient will get large and the negative slope of the friction speed curve will becomes more obvious on the another hands the low rotation speed makes the bearing liquid dynamic lubrication more difficult to form which will result in that the lubrication condition of shaft hull coupled system drops into the state of mixed lubrication in addition whether the bearing is in the state of mixed lubrication or not has a great influence on the appearance of the self excited vibration so it can be predicted that the lower the rotation speed is the more easily the friction self excited vibration will happen to verify our prediction the critical friction coefficient is used to assess the difficulty level of the happening of the system self excited vibration the modal damping ratio is controlled to be ζ 0 001 when rotation speed is 20 rpm the critical friction coefficient is μ 0 0 03 when the rotation speed is up to 50 rpm the critical friction coefficient is μ 0 0 1 and the self excited vibration is shown in fig 18 a when the rotation speed rises to be 100 rpm the critical friction coefficient increase to be μ 0 1 2 seen in fig 18 b obviously the lower the rotation speed is the more easily the friction self excited vibration will happen which is consistent with the prediction as shown in fig 19 4 1 4 support stiffness it is difficult to predict the effect of bearing support stiffness on the friction self excited vibration because the bearing support stiffness has an effect on both the support force and the natural frequency this paper only change the support stiffness of the stern bearing respectively set the after ending middle ending fore ending of the stern bearing stiffness to be 6 106 n m 1 2 107 n m 6 106 n m and 1 5 107 n m 3 107 n m 1 5 107 n m at the previous set the critical friction coefficient is 0 02 seen in fig 20 a at the last set the critical friction coefficient is up to 0 08 shown in fig 20 b adding the reference data set of fig 14 the conclusion can be drawn that the support stiffness of the bearing decreases the self excited vibration will be easier to form as seen in fig 21 4 2 the stick slip phenomenon of the self excited vibration of the shaft hull coupled system in the case of poor lubrication the stick slip phenomenon will appear in the self excited vibration of the shaft hull coupled system in the stick phase as the movement continues the elastic deformation of the rubber bearing increases the stick phase will not finish until the elastic force is greater than the static friction force between the shaft and the bearing when the moving pair is separated by elastic force the system enters into the sliding phase at the phase the adhesive point produces a rebound in the opposite direction and gradually forms a new adhesive movement due to the above mechanism in the case of poor lubrication the discontinuous friction vibration is generated in the shaft hull coupled system this paper analyzes the stick slip phenomenon from the aspects of the vibration displacement response the relative speed and interaction force between the shaft and the bearing the relative speed v r of the friction pairs is synthesized by the rigid body movement of the shaft the vibration responses of the shaft and the bearing shown as eq 26 26 v r v s r φ x x 1 t v b in the case of good shafting alignment the relative speed of the friction pairs is shown in fig 22 a the relative speed is clearly divided into two parts the unsteady state and the steady state in time domain because the shaft itself has a rigid body rotation 20 rpm which is 2 09 rad s the relative speed in the figure is biases to the positive axis direction at the beginning of the vibration system is in the unsteady state and the relative speed is always positive after the vibrations step into the steady state the system appears the periodic vibration shown in fig 22 b the relative speed shortly maintains at the stage of zero and the shaft and the bearing vibrate as the same direction and speed which means stick phenomenon appears in the steady state stage the relationship between the relative speed displacement and the force is shown in fig 23 5 conclusions after making the analysis about the supporting characteristics between shaft and hull substructures the shaft hull coupled system of the underwater vehicle is established then fem model of the shaft hull coupled system is constructed and validated by the experiment the required modal frequencies and the shapes of the shaft and the hull are calculated by the fem model through the friction force model in the interface of the shaft and the stern bearing the modal shapes of the shaft and the hull are combined to establish the nonlinear differential governing equations of the shaft hull coupled system by employing the modal synthesis method of substructures subsequently the self excited vibration responses induced by the friction can be obtained by solving the nonlinear differential governing equations by the means of fourth order runge kutta method on this basis the effects of friction coefficient damping ratio rotation speed and supporting stiffness on the shaft hull coupled system s self excited vibration induced by friction are discussed the conclusions are drawn as follows 1 the coupling of the system substructures can be implemented by the coupling of the parameters of the substructures which include the force displacement and velocity on the interface of the two substructures after inputting the main modes of the subsystems into the matlab it is convenient to establish the nonlinear differential equations of the coupled system by the modal synthesis method of the substructures 2 while the derivative of the friction coefficient or the time variant supporting force versus the speed is negative the friction will induce the happening of the self excited vibration 3 after discussing the effects on self excited vibration induced by the friction of the shaft hull coupled system it can be found that the larger the damping is or the faster the rotation of shaft is or the stronger the supporting stiffness is the more difficultly the self excited vibration will happen 4 after the vibration responses step into the steady state the relative speed shortly maintains at the stage of zero and the shaft and the bearing vibrate as the same direction and speed which means stick phenomenon appears in addition the propeller vibration and noise of the underwater vehicle generally involve three aspects the direct vibration and noise from propeller the vibration of the hull excited by the vibration source which is transferred from the propeller by the shaft the self excited vibration induced by friction between the stern bearing and shaft so far the first two aspects have been familiar to the ship engineers and have been included into the prediction of the propeller vibration and noise however the third aspect that is the self excited vibration investigated by this paper only stays in the stage of the theoretical research and has not been taken into account the prediction of the propeller vibration and noise the omitting of the self excited vibration will result in the inaccurate prediction of the propeller vibration and noise as has a bad effect on acoustic design of the underwater vehicle therefore verifying the self excited vibration by the practical underwater vehicle experiment and considering it into the prediction of the propeller vibration and noise is the future works credit authorship contribution statement chuang wu writing original draft investigation software methodology conceptualization feng chen formal analysis visualization validation xinhua long resources writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the paper is supported by marine low speed engine project phase 1 
22110,to the underwater vehicle its self excited vibration induced by friction in the stern bearing is the non ignorable component of the propeller vibration and noise this paper describes how to solve the self excited vibration and discuss the effects on the self excited vibration and its stick slip phenomenon after making the analysis about the supporting characteristics between shaft and hull substructures this paper takes the shaft hull coupled system as the analysis object and constructs the fem finite element method model of the system based on the fem model validated by the experiment the required modal frequencies and the shapes of the shaft and the hull are calculated then the friction force between shaft and water lubricated rubber bearing is calculated according to the stribeck friction curve hereafter through the friction force the modal shapes of the shaft and the hull are combined to establish the nonlinear differential governing equations of the shaft hull coupled system by employing the modal synthesis method of substructures subsequently the self excited vibration responses induced by the friction can be obtained by solving the nonlinear differential governing equations by runge kutta method on this basis the discussions about the effects of friction coefficient damping ratio rotation speed and support stiffness on the self excited vibration of the shaft hull coupled system are conducted the results show that the larger the damping is or the faster the rotation of shaft is or the stronger the supporting stiffness is the more difficultly the shaft hull coupled system s self excited vibration will happen the works on how to solve the self excited vibration induced by friction in the stern bearing will be of great significance to accurately predict the propeller vibration and noise and optimize the acoustic design of the underwater vehicle keywords underwater vehicle shaft hull coupled system water lubricated rubber bearing self excited vibration stick slip 1 introduction the self excited vibration induced by friction in the stern bearing is the important component of the propeller vibration and noise of the underwater vehicle yu et al 2015 a majority of the research on the vehicle s propeller vibration and noise has ignored the self excited vibration induced by friction in the stern bearing and only considers vibration excited by the loads that include the unsteady transverse and longitudinal exciting loads located in the propeller kang et al 2019 c li et al 2019 h li et al 2019a 2019b 2019c moreover many researchers focus on the free vibration characteristics of the underwater vehicle lee and kwak 2015 explored the vibration behaviors of the cylindrical shell and compared of different shell theories for solving related problems poultangari and nikkhah 2017 developed victorial wave approach to research the vibration issue of the cylindrical shell wu and pang 2018 proposed the precise integration transfer matrix method pitmm to research free vibration behaviors of the conical shells pang et al 2018 2019 and li et al 2019 employed the semi analytical method and flügge thin shell theory to solve the free vibration behaviors for spherical cylindrical spherical shell with arbitrary boundary conditions but none of them took into account that the vibration response induced by friction in the stern bearing of the underwater vehicle however in the real engineering due to the propeller cantilever arrangement the hull uneven deformation resulted from water pressure the shaft inaccurate alignment conditions difficultly forming the condition of the liquid dynamic lubrication and so on litwin 2015 at this time the bearing directly contacts with the journal subsequently the friction force between shaft and water lubricated rubber bearings arises which induces the self excited vibration of the shaft hull coupled system the self excited vibration therefore is the component of the shaft hull coupled system vibration even sometimes play a leading role therefore it is necessary to devote efforts to research the underwater vehicle self excited vibration induced by friction in the stern bearing which will be of great significance to accurately predict the propeller vibration and noise and optimize the acoustic design of the underwater vehicle krauter 1981 constructed a multi layer bearing model simulated the couple of the shaft neck torsion vibration and interface friction pointed out the self excited vibration resulted from the mode instability simpson and ibrahim 1996 analyzed the dynamic behavior of shaft bearing system excited by friction revealed the influence of physical parameters such as hardness and length on system stability he et al 2012 researched on the rubber hardness and friction property of low noise water lubricated bearing however they merely studied on itself structure of the rubber bearing and did not put it into the whole underwater vehicle system thus the oversimplified model cannot reveal the influence of the friction excitation on the vibration of the overall shaft hull coupled system in detail moreover the water lubricated stern bearing and shaft system regarded as research object jin 2014 studied on the stability of transverse and friction coupling vibration the motion law of the coupling system the tribological properties and friction vibration recognition method zhang et al 2014 investigated the friction induced vibration of a propeller shaft system supported by the water lubricated rubber bearing they found that the negative damping was a key parameter through a series of analysis on the stability and vibration response of the system and the bearing vibration played a dominant role in the present system in order to ensure the good lubrication for water lubricated stern tube bearings under low speed working conditions guo et al 2017 designed and produced a biomimetic materials based on the properties of lignum vita the analysis results showed that there were significant differences in the tribological properties of the rubbing pairs in different concentration of guaiacum laboratory tests are performed to ascertain the friction induced vibration characteristics of a stern rubber bearing by the peng and tan 2018 the pressure temperature and speed of the rubber bearing are adjusted until friction phenomena occurs and the time domain spectrum frequency domain spectrum and shaft orbit test technology are then utilized to obtaining the vibration characteristics of the stern rubber bearing which provided an supporting technology for the identification of the abnormal friction in the stern bearings and low noise design of the stern bearings lin et al 2019 proposed a 3 dof mode coupling model of the water lubricated rubber bearing and journal coupled system considering perturbations of the stochastic rough surface based on the model a new phenomenon is found that the magnification of vibration will occur when two mode frequencies get close to each other yet their researches focused on the performance of the rubber material friction and the lubrication experiment of bearing not involved in the vibration of shaft hull coupled system and related influencing factors therefore to the underwater vehicle self excited vibration induced by friction in the stern bearing this paper takes the shaft hull couple system as the analysis object establishes the fem model of the shaft hull couple system after making the analysis about the supporting characteristics between shaft and hull substructures based on the fem model validated by the experiment the required modal frequencies and the shapes of the shaft and the hull are calculated then according to the stribeck friction curve zhang et al 2019 the friction force between shaft and water lubricated rubber bearings is calculated through the friction force the modal shapes of the shaft and the hull are combined to establish the nonlinear differential governing equations of the shaft hull coupled system by employing the modal synthesis method of substructures subsequently the self excited vibration responses induced by the friction can be obtained by solving the nonlinear differential governing equations by the fourth order runge kutta method finally the effects on the shaft hull coupled system s self excited vibration induced by friction are discussed 2 the shaft hull coupled system of the underwater vehicle the shaft system and the hull system are the main constituent structures of the underwater vehicle the shaft system includes propeller shaft segments thrust plate and bearing housings propeller produces thrust force and unsteady excitation the shaft system is the part that connects the main engine to the propeller and is also the main transferring channel in which the force and the vibration of the propeller are passed on to the whole hull the hull system contains the hull shell bearing bases coupling active part and engine unit the excitation caused by the propeller rotation is transmitted to the hull system through the shaft and bearings which results in the hull s complex vibration and noise in the previous study the shaft and the hull were studied separately however in the recent research it has been found the coupled effects of the shaft hull on their respective dynamic characteristics can t be neglected hence it is necessary to construct the shaft hull coupled system to research on the vehicle self excited vibration induced by friction in the stern bearing due to the complexity of the underwater vehicle and the limitation of the theoretical analysis the theoretical analysis on the model of the underwater vehicle can t satisfy the requirements of the analysis as a result this paper establishes the 1 4 large scale simplified shaft hull coupled system according to one actual underwater vehicle as shown in fig 1 2 1 the fem model establishment of the shaft hull coupled system using the fem software named abaqus6 11 the fem models of the shaft subsystem and the shaft hull coupled system are established in turn subsequently the mode analysis of the shaft hull coupled system is conducted by the software 2 1 1 the fem model establishment of the shaft subsystem the shaft subsystem includes the shaft segments thrust plate propeller the stern intermediate and thrust bearing and bearing housings the shaft segments can be regarded as equal straight beam with uniform cross section the mass effect of thrust plate and propeller is used as the concentrated mass and the moment of inertia in their positions the shaft system is constrained by the stern intermediate and thrust bearings the stern and intermediate bearing have a radial support to the shaft which can be simplified to both the horizontal and vertical direction each direction is made up of three spring damping elements which are different in position stiffness and damping parameters the main thrust bearings constrain both the radial and axial movement of the shaft so the radial and axial constraints of the main thrust bearing are simulated by the spring damping element respectively the equivalent shaft system is shown in fig 2 the shaft length and the location of the bearing are shown in fig 3 and the bearing related parameters in the shaft system are shown in table 1 the shaft segments are simulated by beam element the type and quantity of the element respectively are b31 and 6568 the size of the beam element is 0 02 m the stern intermediate and thrust bearing can be simplified as the spring damping element the quantity of the element is 21 the thrust plate are simulated by solid element the type and quantity of the element respectively are c3d8r and 1839 the propeller is simplified as mass point and given concentrated mass and concentrated moment of inertia the stern intermediate and thrust bearing housing can be simplified as rigid body and given concentrated mass and concentrated moment of inertia the type and quantity of the element respectively are r3d4 and 687 2 1 2 the fem model establishment of the shaft hull coupled system the hull system contains the hull shell bearing bases coupling active part and motor unit the excitation caused by the propeller rotation is transmitted to the hull system through the shaft and bearings which results in the hull s complex vibration and generates the noise the main body of the hull is a combination of the cylinder and conical shell which are simulated by the shell element the type and quantity of the element respectively are s4r and 43347 the size of the shell element is 0 1 m the thrust bearing bases are also simulated by the shell element the type and quantity of the element respectively are s4r and 15624 the motor housing are simplified as rigid body and given concentrated mass and concentrated moment of inertia the type and quantity of the element respectively are r3d4 and 295 besides the isolations between the motor block and the base are simulated by the spring damping element the quantity of the element is 4 according to the dimension of shaft hull coupled system and the above selection law of element type the fem model of the shaft hull coupled system is completely established the stern finite element model of the shaft hull couple system is shown in fig 4 the corresponding element types and quantity are shown in table 2 when vehicle sails underwater the water does not limit its any degree of freedom so its boundary constraint is free after making the modal analysis five overall modes of the fem model are selected and shown in fig 5 with the purpose of facilitating to describe and analyze the dominant deformation mode in bending direction is named as the bend mode and the dominant deformation mode in longitudinal direction is named as the longitudinal mode so the first order to the third order bend mode the first order torsional and the first order longitudinal mode are shown in fig 5 2 2 the experimental validation of fem model of the shaft hull coupled system the shaft hull coupled system is a complex structure and there are many factors influencing the vibration response of the system if the accuracy of the fem model of the shaft hull coupled system can t be ensured the research conclusion will not reflect the actual vibration characteristics of the vehicle therefore in order to verify the accuracy of the fem model the vibration experiment on the shaft hull coupled system has been carried out when tested the exciting force generated from the vibration exciter acts on the location of the propeller then the accelerometers located in the thrust bearing housing the stern middle and bow of the vehicle send acceleration signals to the acquisition and analysis device with 64 channels at the same time force sensor also send force signal to the acquisition and analysis device fig 6 shows the connection diagram of the experiment devices fig 7 shows the measuring points arrangement of the experiment model in the mode test in addition every measuring point is placed by a tri axial accelerometer when the experiment finishes the all cross sectional vibration data are integrated into the whole vibration and then the modal frequency of the experiment model are obtained the modal frequency contrast of the experiment and calculation from fem model of the shaft hull coupled system is shown in table 3 it can be seen that the error of their modal frequency is less than 5 which demonstrates that the fem model established in this paper is enough accurate the thrust bearing is the most important path where vibration is transmitted from the shaft system to the hull system so the vibration verification of thrust bearing can better illustrate the accuracy of fem model of the shaft hull coupled system and the bearing s simplified method the bearings are simplified to the spring damping element in order to excite the vibration of the system the vibration exciter is installed in the position where the propeller is located the points which are outside the thrust bearing housing and located in the stern and bow of the vehicle are arranged to be measuring points at the point outside the thrust bearing housing the vibration acceleration responses from the fem model and the experiment are compared in fig 8 at the points located in the stern and bow of the vehicle the vibration acceleration responses from the fem model and the experiment are compared in fig 9 two reasons result in the deviation between experimental and calculation especially at high frequency one is that the fem model is just simplified from the practical shaft hull coupled system which leads that the mode number of the fem model is less than that of the practical system the other is that the fem is difficult to exactly calculate the high frequency vibration limited by the mesh size the decreasing of the mesh size will merely improve the calculation frequency slightly however cause the sharply increasing of the computational efforts after the modal frequency and vibration responses contrast of the experiment and the fem model it can be seen that the modal frequency and vibration responses of the fem model agree well with that of the experiment therefore the fem model of the shaft hull coupled system this paper constructs is enough accurate 3 solutions to the self excited vibration of the shaft hull coupled system induced by the friction the required modal frequencies and modal shapes can be calculated based on the fem model of the shaft hull coupled system constructed in section 2 and validated by the experiment then through the friction force model on the interface of the shaft and the stern bearing the modal shapes c li et al 2019 h li et al 2019a 2019b 2019c of the shaft and the hull are combined to establish the nonlinear differential governing equations of the shaft hull coupled system in modal coordinate by employing the modal synthesis method of substructures subsequently the self excited vibration responses in modal coordinates induced by the friction of the shaft hull coupled system can be obtained by solving the nonlinear differential governing equations in the modal coordinate by the means of fourth order runge kutta method after converting the responses into physics coordinates the self excited vibration responses in physics coordinates can be obtained the above calculation process has been written as code which can be implemented in matlab 3 1 the friction model of the water lubricated rubber bearing when the vehicle sails underwater the stern bearing separates the inner structure from the outer water therefore the water lubricated rubber stern bearing is required to ensure the shaft normally working fig 10 shows the water lubricated rubber bearing the external copper bush can ensure the overall bearing strength and the internal slab rubber with the diversion trench can enhance the lubrication in the case of low rotation speed and heavy duty the lubrication condition between the journal and the bearing loses in the state of boundary lubrication or mixed lubrication on the assumption that the rotation speed of the shaft is ω the support force f n that is generated in the interface of the shaft and the bearing points to the axis the friction force f is proportional to the support force and it can be equivalent to a friction force f f through the axis and a friction moment m f the forces diagram of the journal and the bearing are seen in fig 11 the friction moment m f will hinder the rotation of the shaft and cause the torsional vibration and the friction force f f will induce the cyclotron vibration the friction force and moment are the function of the system s parameters and friction coefficient which will cause the transverse and torsional vibration of the shaft through the coupling in all directions in addition the coupling in all directions make the shaft hull coupled system to be a self vibration system with both force feedback and motion feedback with the liquid dynamic lubrication conditions the friction coefficient of the sliding bearing is related to relative sliding speed of which the behavior can be described by the stribeck curve in fig 12 where η represents the lubricant viscosity u represents the sliding speed w represents the support load moreover the stribeck curve has been confirmed by a lot of experiments because the water lubricated rubber bearing possesses the diversion trench its lubrication state should be in the state of the mixed lubrication which satisfies the following equations 1 f f μ d v f n 2 μ d v sgn v μ 0 μ 1 exp β 0 v 3 v r 0 ω φ x x 1 t where v is the relative speed on the interface between the shaft and the bearing ω is the constant speed of the shaft φ x is the shaft s torsion angle induced by the torsional vibration φ x x 1 t the torsional vibration angle speed f n is the support force on the interface when the friction parameters zhang et al 2014 are respectively μ 0 0 05 μ 1 0 34 β 0 3 the relationship of friction coefficient and relative speed is shown in fig 13 in the shaft hull coupled system the support forces f n are supplied by the spring damping element in the y and z directions it can be described by the following equation f n k y y 1 y 2 2 k z z 1 z 2 2 which can be broken into the transverse and vertical support force as follows 4 f n y k y y 1 y 2 f n z k z z 1 z 2 the equivalent frication force f f and moment m f can also be broken into the y and z direction written as the following equations 5 f f y μ d v k z z 1 z 2 f f z μ d v k z y 1 y 2 m f μ d v r 0 f n 3 2 the differential governing equations establishment based on the modal synthesis method of substructures and its solution to a time invariant system of n degrees of freedom with an external excitation its behavior equation is described by 6 m x c x k x f x t x is the displacement response vector f t is the excitation vector m and k are respectively the mass and stiffness matrixes that have symmetric real element fu 1990 the mode matrix consists of the mode vectors as follows 7 φ ϕ 1 ϕ 2 ϕ n where n is the quantity of degrees of freedom each mode vector reflects the vibration shape of the corresponding mode in order to guarantee the accuracy and improve the calculation speed the modal reduced method is applied then the former n order general modes of the structure are intercepted as follows 8 φ m ϕ 1 ϕ 2 ϕ m any displacement component x can be approximately written as 9 x q 1 ϕ 1 q 2 ϕ 2 q m ϕ m base on eqs 8 and 9 represent equation 8 and equation 9 the response vector of the structure satisfies the following equation 10 x φ m q m where q m is the modal coordinate vector after substituting eq 10 into eq 6 and both sides are multiplied by φ m t the structure behavior equation in the modal coordinate can be described as 11 m q c q k q r q t where m is the modal mass matrix and k is the modal stiffness matrix 12 m φ m t m φ m 13 k φ m t k φ m 14 r q t φ m t f x t assuming the system damping is proportional damping then 15 c α m β k eq 15 is converted to modal coordinates it is given by 16 c α m β k to the multi system coupling problem the coupling problem can be transformed into the differential equation of motion the underwater vehicle mainly consists of the shaft system and the hull system using subscript 1 to indicate the parameters of the shaft system and subscript 2 to indicate the parameters of the hull system two subsystems are combined into the coupling system the nonlinear differential governing equations described by its blocks in modal coordinate satisfy the following equations 17 m 1 0 0 m 2 q 1 q 2 c 1 0 0 c 2 q 1 q 2 k 1 0 0 k 2 q 1 q 2 r 1 r 2 18 r 1 φ m 1 t f 1 19 r 2 φ m 2 t f 2 where f 1 f 2 are the external excitation vectors of two subsystems their vector elements are non zero only in the interface position and any subsystem excitation vector contains the motion parameters of another subsystem specifically speaking under the supporting of the bearing the excitations on interface position of the shaft and bearing are the functions of the displacement on the interface in the friction force area of the stern bearing the relationship of the friction force and the displacement is described by eq 5 through defining the parameters of eq 5 in the calculation program the two subsystems are combined into the coupled model this paper solves the nonlinear differential governing equations eq 17 by the fourth order runge kutta method after the response q in modal coordinates be solve converting the response to physics coordinates by eq 20 the self excited vibration responses of the shaft hull coupled system in physics coordinates can be obtained 20 x φ q 4 the effects on the self excited vibration induced by the friction of the shaft hull coupled system and its stick slip phenomenon 4 1 the effects of the system parameters on self excited vibration through the calculation it can be known that when the fore middle and after support stiffness of the stern bearing are respectively 1 5 106 n m 3 106 n m 1 5 106 n m and the rotation speed and the modal damping are respectively 20 r min and ζ 0 001 the self excited vibration of the shaft hull coupled system does not happen until the friction coefficient raises to be μ 0 0 03 its response in time domain is depicted in fig 14 this date set is used as a reference data set both the theoretical analysis and experimental results indicate that many factors and system parameters influence the happen of the self excited vibration induced by friction obviously the self excited vibration induced by friction is directly related to the friction coefficient when the shaft hull coupled system is in the same condition the larger the friction coefficient is the larger the friction force is and the more easily the system self excited vibration will happen in addition the causes of the self excited vibration are also related to other factors such as modal damping ratio rotation speed and support stiffness subsequently these factors are respectively discussed 4 1 1 friction coefficient the self excited vibration induced by friction can be divided into different instability mechanisms to the system with time invariant support force the happening condition of self excited vibration is that the derivative of the friction coefficient versus the speed is negative like as follows 21 d μ d v d v 0 seen from fig 13 when the relative speed is small the derivative of the friction coefficient versus the speed keeps negative which satisfies the happening condition of system self excited vibration however the support force is the transverse torsion coupled time variant force in this paper in this condition although the friction coefficient is constant the stability of steady state slid of the system is also probably broken which will lead to the happen of the self excited vibration in order to investigate the happening condition of the self excited vibration defining the friction coefficient as the product of the sign function and the constant then the transverse vibration response of the shaft hull coupled system is shown in fig 15 obviously the self excited vibration also happens which indicates that the happening condition of the self excited vibration of the shaft hull coupled system is that the derivative of the time variant support force versus the speed becomes negative therefore although the friction coefficient is constant the self excited vibration also probably happens 4 1 2 damping ratio damping consumes the energy of the system and the larger the damping is the more stable the system will be so the modal damping ratio has a direct effect on the convergence of the self excited vibration in addition it can be expected that as the modal damping ratio increases the energy consumption of the system will increase and the self excited vibration will be less likely to generate in order to verify the effect of damping ratio on the self excited vibration the rotation speed is kept as 20 rpm choose the multiple sets of damping ratio then change the friction coefficient from small to large until the shaft hull coupled system produces self excited vibration and define the friction coefficient where the self excited vibration just occurs as the critical friction coefficient thus the critical friction coefficient can measure the difficulty level of the happening of the self excited vibration and the smaller the critical friction coefficient is the more easily the self excited vibration happen after calculation when the modal damping ratio is ζ 0 the critical friction coefficient is μ 0 0 01 where the self excited vibration just occurs seen in fig 16 a when the modal damping ratio is ζ 0 001 the critical friction coefficient is μ 0 0 03 when the modal damping ratio is ζ 0 01 the critical friction coefficient is μ 0 0 5 shown in fig 16 b the results show that the modal damping ratio increases the critical friction coefficient will increase the self excited vibration of the shaft hull coupled system will be more difficult to form seen in fig 17 the conclusion agrees well with our prediction 4 1 3 rotation speed the rotation speed of shaft has a multiple effect on the self excited vibration on the one hand when the shaft slowly rotates the friction coefficient will get large and the negative slope of the friction speed curve will becomes more obvious on the another hands the low rotation speed makes the bearing liquid dynamic lubrication more difficult to form which will result in that the lubrication condition of shaft hull coupled system drops into the state of mixed lubrication in addition whether the bearing is in the state of mixed lubrication or not has a great influence on the appearance of the self excited vibration so it can be predicted that the lower the rotation speed is the more easily the friction self excited vibration will happen to verify our prediction the critical friction coefficient is used to assess the difficulty level of the happening of the system self excited vibration the modal damping ratio is controlled to be ζ 0 001 when rotation speed is 20 rpm the critical friction coefficient is μ 0 0 03 when the rotation speed is up to 50 rpm the critical friction coefficient is μ 0 0 1 and the self excited vibration is shown in fig 18 a when the rotation speed rises to be 100 rpm the critical friction coefficient increase to be μ 0 1 2 seen in fig 18 b obviously the lower the rotation speed is the more easily the friction self excited vibration will happen which is consistent with the prediction as shown in fig 19 4 1 4 support stiffness it is difficult to predict the effect of bearing support stiffness on the friction self excited vibration because the bearing support stiffness has an effect on both the support force and the natural frequency this paper only change the support stiffness of the stern bearing respectively set the after ending middle ending fore ending of the stern bearing stiffness to be 6 106 n m 1 2 107 n m 6 106 n m and 1 5 107 n m 3 107 n m 1 5 107 n m at the previous set the critical friction coefficient is 0 02 seen in fig 20 a at the last set the critical friction coefficient is up to 0 08 shown in fig 20 b adding the reference data set of fig 14 the conclusion can be drawn that the support stiffness of the bearing decreases the self excited vibration will be easier to form as seen in fig 21 4 2 the stick slip phenomenon of the self excited vibration of the shaft hull coupled system in the case of poor lubrication the stick slip phenomenon will appear in the self excited vibration of the shaft hull coupled system in the stick phase as the movement continues the elastic deformation of the rubber bearing increases the stick phase will not finish until the elastic force is greater than the static friction force between the shaft and the bearing when the moving pair is separated by elastic force the system enters into the sliding phase at the phase the adhesive point produces a rebound in the opposite direction and gradually forms a new adhesive movement due to the above mechanism in the case of poor lubrication the discontinuous friction vibration is generated in the shaft hull coupled system this paper analyzes the stick slip phenomenon from the aspects of the vibration displacement response the relative speed and interaction force between the shaft and the bearing the relative speed v r of the friction pairs is synthesized by the rigid body movement of the shaft the vibration responses of the shaft and the bearing shown as eq 26 26 v r v s r φ x x 1 t v b in the case of good shafting alignment the relative speed of the friction pairs is shown in fig 22 a the relative speed is clearly divided into two parts the unsteady state and the steady state in time domain because the shaft itself has a rigid body rotation 20 rpm which is 2 09 rad s the relative speed in the figure is biases to the positive axis direction at the beginning of the vibration system is in the unsteady state and the relative speed is always positive after the vibrations step into the steady state the system appears the periodic vibration shown in fig 22 b the relative speed shortly maintains at the stage of zero and the shaft and the bearing vibrate as the same direction and speed which means stick phenomenon appears in the steady state stage the relationship between the relative speed displacement and the force is shown in fig 23 5 conclusions after making the analysis about the supporting characteristics between shaft and hull substructures the shaft hull coupled system of the underwater vehicle is established then fem model of the shaft hull coupled system is constructed and validated by the experiment the required modal frequencies and the shapes of the shaft and the hull are calculated by the fem model through the friction force model in the interface of the shaft and the stern bearing the modal shapes of the shaft and the hull are combined to establish the nonlinear differential governing equations of the shaft hull coupled system by employing the modal synthesis method of substructures subsequently the self excited vibration responses induced by the friction can be obtained by solving the nonlinear differential governing equations by the means of fourth order runge kutta method on this basis the effects of friction coefficient damping ratio rotation speed and supporting stiffness on the shaft hull coupled system s self excited vibration induced by friction are discussed the conclusions are drawn as follows 1 the coupling of the system substructures can be implemented by the coupling of the parameters of the substructures which include the force displacement and velocity on the interface of the two substructures after inputting the main modes of the subsystems into the matlab it is convenient to establish the nonlinear differential equations of the coupled system by the modal synthesis method of the substructures 2 while the derivative of the friction coefficient or the time variant supporting force versus the speed is negative the friction will induce the happening of the self excited vibration 3 after discussing the effects on self excited vibration induced by the friction of the shaft hull coupled system it can be found that the larger the damping is or the faster the rotation of shaft is or the stronger the supporting stiffness is the more difficultly the self excited vibration will happen 4 after the vibration responses step into the steady state the relative speed shortly maintains at the stage of zero and the shaft and the bearing vibrate as the same direction and speed which means stick phenomenon appears in addition the propeller vibration and noise of the underwater vehicle generally involve three aspects the direct vibration and noise from propeller the vibration of the hull excited by the vibration source which is transferred from the propeller by the shaft the self excited vibration induced by friction between the stern bearing and shaft so far the first two aspects have been familiar to the ship engineers and have been included into the prediction of the propeller vibration and noise however the third aspect that is the self excited vibration investigated by this paper only stays in the stage of the theoretical research and has not been taken into account the prediction of the propeller vibration and noise the omitting of the self excited vibration will result in the inaccurate prediction of the propeller vibration and noise as has a bad effect on acoustic design of the underwater vehicle therefore verifying the self excited vibration by the practical underwater vehicle experiment and considering it into the prediction of the propeller vibration and noise is the future works credit authorship contribution statement chuang wu writing original draft investigation software methodology conceptualization feng chen formal analysis visualization validation xinhua long resources writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the paper is supported by marine low speed engine project phase 1 
22111,in this paper a strong robust nonlinear controller is proposed for an underwater vehicle based on lyapunov theory which is able to bypass the local and moving obstacles using potential field approach underwater vehicles are nowadays widely applicable for performing both of inspectional and operational tasks under the surface of oceans considering the fact that in these environments additional external forces such as drag force of the fluid flow and many other disturbances can affect the performance of the robot providing the stability and controlling the system in a robust way is extremely desirable on the other hand bypassing the local obstacles that are inevitable under the surface of oceans is another challenge that needs to be studied in this paper a strong robust controller is designed and implemented on the nonlinear dynamic model of the underwater robot based on lyapunov method which is also equipped by obstacle avoidance feature as a result not only the stability of the system is guaranteed and the robustness of the robot is provided against the external fluid forces and other exerted disturbances but also the trajectory can be improved in order to bypass the stationary and moving obstacles model of the robot is first extracted afterwards the proposed lyapunov based controller is designed and implemented on the robot obstacle avoidance algorithm is then designed using analytic approach of potential field method in order to bypass the local obstacles the correctness of the robot modeling and the efficiency of the designed controller is verified by the aid of some analytic and comparative simulation scenarios in matlab it is shown that by the aid of the presented model of underwater robot and its related proposed control the system can successfully perform any mission with a high accuracy and robustness even in the presence of obstacles keywords lyapounov based control robust control underwater vehicle obstacle avoidance potential field 1 introduction nowadays auvs are widely applicable in marine industries and its dependent affairs its application consists both of inspectional and operational tasks through the ocean and under the surface of water of any kind of fluid channels karimi and hasanzadeh ghasemi 2017 considering the complicated dynamics and behavior of this kind of robots in presence of drag forces and different external disturbances especially in its 6 dofs mode an acceptable control of the robot needs exact nonlinear modeling of the robot and also designing a strong controller with a high robustness and stability as a results a vast variety of nonlinear controllers are proposed so far the first step to design an efficient analytic controller is to extract the model of the system kinematics and dynamics of auvs which are extremely and heavily nonlinear and complicated is derived by fossen 1994 the first beneficent of extracting the model of the robot is providing the possibility of stability analysis of such under water systems the planar stabilization problem of auvs in a regulation process is studied in some researches aguiar and pascoal 2002 wichlund et al 1995 reyhanoglou 1997 pettersen and egeland 1999 pettersen and fossen 2000 mazenc et al 2002 in these studied it has been shown that such under water vehicles cannot be asymptotically stable using time invariant feedback controllers the next autonomous generation of auvs are equipped by tracking controller through which any desired trajectory can be passed employing proper nonlinear controllers recently in order to increase the smartness of these kind of vehicles for covering the tracking missions some researchers have suggested numerical controllers such as neural networks wang and lee 2003 yuh 1990 or fuzzy based controllers liang et al 2016 although these numerical methods have a lot of advantages and increases the flexibility of the system controllers they are usually offline which restricts their usage for online and real time applications in order to compensate the mentioned disadvantages of numerical controllers some nonlinear analytic controllers have been proposed so far for example ordinary sliding mode controller smc is proposed for robust control of such systems in ashrafiuon et al 2008 wang et al 2012 while higher order sliding mode is implemented in delavari and heydarinejad 2017 and terminal sliding mode is employed in nikoo et al 2016 although these mentioned sliding mode based controllers are robust enough to be applicable in presence of external disturbances but they can t cancel the destructive effects of parametric uncertainties arises from the complicated dynamics of these vehicle in order to cover the mentioned challenge different adaptive controllers are designed and proposed in the literatures gu and hu 2008 gu and wang 2009 khalaji and moosavian 2014 khatib 1986 sahu and subudhi 2017 are other sliding mode based controllers for these kind of systems in which the stability of the system is provided by calculating the proper controlling gains also optimization feature is considered in some studies by proposing closed loop optimal controllers through which not only the robustness of the system can be guaranteed but also a desired objective function can be minimized the best analytic optimal controller for such systems is state dependent riccati equation sdre which is implemented for auvs in geranmehrand and nekoo 2015 although this controller is feedback based and optimal but it cannot handle the robot in presence of the possible obstacles located in the seas another challenge of these kind of underwater vehicles is to satisfy the stability of the system in presence of environmental situations and uncertainties the previous theoretical and experimental researches show that the best solution to cover the mentioned consideration is to employ lyapunov based techniques this technique is used experimentally in pettersen and nijmeijer 2001 for a model surface ship in lefeber et al 2003 this controller is employed for a surface vessel however in the mentioned studies controlling the yaw dof of auv s is ignored on the other hand the main objective of controlling the underwater vehicles is to guide them along any desired trajectory within the oceans trough which a lot of potential obstacles might be presented thus integrating a proper obstacle avoidance controller together with a robust and stable tracker could be highly appreciable for such underwater vehicles most of the employed obstacle avoidance techniques are based on numerical approaches such as fuzzy or neural network methods for example xu and feng 2009 lee et al 2004 use fuzzy algorithms for bypassing the obstacles while demuth and springsteen 1990 employs neural network for this purpose although these methods do not need the model of the system but they are not suitable for online and real time applications such as bypassing the local or moving obstacles since their algorithms are based on offline strategies the best analytic obstacle avoidance technique is based on potential field method the main idea of obstacle avoidance control using potential field method was firstly proposed by khatib lee et al 2004 in this research the obstacles are stationary and avoiding from collision is provided by developing a complimentary force calculated by gradient of a proper potential function this idea was then employed in demuth and springsteen 1990 khatib 1986b for avoiding the collision with the underwater obstacles for auv systems however in the mentioned researches the robust and stable tracking of the system is ignored and the robot is sensitive in presence of external disturbances and parametric uncertainties it can be seen through the mentioned literature that developing a general controller by which all of the objective items including robustness full state controllability stability and obstacle avoidance capability can be met simultaneously has been ignored so far therefore in this paper in order to cover the mentioned deficiency a stable and nonlinear lyapounov based controller is designed and implemented for an underwater vehicle with six spatial nonlinear dofs which is highly robust against the external disturbances and adaptive against the parametric uncertainties moreover obstacle avoidance is also included in the mentioned proposed controller employing potential field method this method is more applicable for local and moving obstacles since the numerical methods are mostly offline and are not suitable for such real time performances as a result not only the robust and stable tracking of the mentioned spatial underwater vehicle is realized but also its smartness is increased by adding the feature of obstacle avoidance capability in the next section the nonlinear model of a well known spatial underwater vehicle with six dofs is represented afterwards in section three the mentioned nonlinear and robust lyapounov based controller is designed and implemented on the robot dynamics and the required improvements are conducted to increase its adaptability and robustness in section four in order to provide the ability of rounding the local obstacles an obstacle avoidance controller is developed and added to the main tracker controller finally in section five all of the claimed advantages of the proposed controller is verified by simulating the dynamics of the mentioned underwater vehicle in matlab and conducting a series of analytic and comparative simulation scenarios it is shown that using the proposed controller both of tracking and obstacle avoidance of such underwater systems can be realized successfully in presence of drag forces and other external disturbances of underwater environments 2 modeling of the auv in this section kinematic and kinetic models of the considered auv robot are represented the schematic view of the robot and the considered global and local coordinates are shown in fig 1 the auv has three degrees of freedom x y ψ t which can be controlled by the aid of the system inputs including longitudinal and lateral forces f u f v t the mathematical models are prerequisite formulation for extracting the proposed controlling commands 2 1 kinematic modeling the generalized coordinates of the robot and its corresponding workspace velocities are defined as follow 1 q x y ψ w u v r here the generalized coordinates are defined in inertial coordinates system and its related workspace velocities are defined respect to the local coordinate system attached to the robot the corresponding jacobian matrix can be extracted as 2 x y ψ cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 u v r 2 2 kinetic modeling implementing the lagrange method for extracting the dynamic model of the auv results in the following workspace dynamic equations 3 u m 22 m 11 v r x u m 11 u x u u m 11 u u f u m 11 v m 11 m 22 u r x u m 22 v y v v m 22 v v f v m 22 r m 11 m 22 m 33 v u n r m 33 r n r r m 33 r r where f u f v are longitudinal and lateral forces of auv respectively m 11 and m 22 are the combined rigid body and added mass terms while m 33 is the combined and added moment about z b also x u y u n r x u u y v v and n r r are the linear and quadratic drag terms coefficients respectively gu and hu 2008b 3 proposed control scheme in this paper a nonlinear lyapunov based controller is proposed which is robust against the external disturbances associated to the drag and lifting forces of the flowing fluid and also parametric uncertainties of the system the mentioned controller also has the capability of obstacle avoidance by which the possible local obstacles of the oceans can be avoided in an online way 3 1 tracking controller in this section the auv robot is supposed to track a desired trajectory and its workspace states should follow the reference trajectory in a robust and stable way the target is to track the reference trajectory as follow 4 ξ x y ξ s x s y s the kinematic inputs η u v should be calculated in a way that the above tracking problem can be realized in a stable way the index s denotes the reference trajectory considering the kinematic model of equation 2 we have 5 ξ r ψ η where r cos ψ sin ψ sin ψ cos ψ is the rotation matrix mapping the local coordinate into the global one in order to cover the mentioned tracking problem the position error is defined as follow 6 e ξ ξ s thus the error dynamic of the system will be 7 e ξ ξ s substituting equation 5 in the above equation one can conclude 8 e r ψ η ξ s now we consider the desired stable error dynamic as follow 9 e k e thus it can be concluded that 10 r ψ η ξ s k e η r t ψ k e ξ s therefore the kinematic inputs of equation 10 can stabilize the error dynamic of equation 9 and ensure the objective ξ ξ s now we suppose that the modeling of the system is not perfect and some uncertainties are involved in the extracted model of the system these uncertainties are considered together with the related kinematic constraints along x y as follow 11 ξ s r ψ η δ where δ is the corresponding kinematic constraints along x and y thus considering equation 10 results in 12 ξ r ψ r t ψ k e ξ s δ δ r t ψ ξ s r t ψ k e ξ s r t ψ ξ k e ξ s since the closed loop system is supposed to be stable and considering the fact that the determinant of r is equal to one the uncertainty is bounded as follow 13 δ e α 1 e δ α 0 α 1 e where α 0 α 1 are the upper bound uncertainty parameters of the lumped parameter system now in order to compensate the uncertainty δ the control input η is modified as follow 14 η r t ψ k e ξ s α ˆ 0 α ˆ 1 e where α ˆ 0 α ˆ 1 are the estimation of the parameters α 0 α 1 substituting the above control input in equation 8 we have 15 e k e α ˆ 0 α ˆ 1 e δ the estimation error of the parameters α 0 α 1 are shown by α 0 α 1 and can be defined as 16 α i α ˆ i α i i 1 2 3 2 stability analysis in order to guarantee the stability of the designed controller the lyapunov stability theory should be satisfied the following lyapunov function candidate is considered to check the stability of the closed loop system 17 v 1 2 e t e 1 2 α 0 2 σ 0 1 2 α 1 2 σ 1 where σ 0 σ 1 are positive real numbers that will be later used as the adaptive gains the derivation of this function with respect to time can be calculated as follow 18 v e t e α 0 α 0 σ 0 α 1 α 1 σ 1 considering the fact that the variations of the system uncertainties and consequently their related α i are smooth we can write equation 18 as bellow 19 v e t e α 0 α ˆ ˆ 0 σ 0 α 1 α ˆ ˆ 1 σ 1 now by substituting equation 15 in the above function one can conclude that 20 v e t k e α ˆ 0 α ˆ 1 e δ α 0 α ˆ ˆ 0 σ 0 α 1 α ˆ ˆ 1 σ 1 considering equation 13 it can be concluded that 21 v e t k e e α ˆ 0 α ˆ 1 e α 0 α 1 e α 0 α ˆ ˆ 0 σ 0 α 1 α ˆ ˆ 1 σ 1 and finally considering equation 16 we have 22 v e t k e e α 0 α 1 e α 0 α ˆ ˆ 0 σ 0 α 1 α ˆ ˆ 1 σ 1 v e t k e α 0 α ˆ ˆ 0 σ 0 e α 1 α ˆ ˆ 1 σ 1 e 2 the following adaptive rules are considered 23 α ˆ ˆ 0 σ 0 e α ˆ ˆ 1 σ 1 e 2 then it can be concluded that the derivative of the lyapunov function can be summarized as follow 24 v e t k e as can be seen the above function is negative definite with respect to the error and therefore it can be concluded that the error converges to zero while the considered adaptive parameters remain bounded simultaneously 3 3 sliding mode dynamic control in order to strengthen the robustness of the control algorithm in presence of disturbances and uncertainties a sliding mode algorithm is used to control the system in the dynamic level the kinematic control inputs η which were previously determined can be considered as the reference dynamic control inputs the index c shows that the related signal is a command signal therefore the following error vector can be defined as the dynamic of the controlling error 25 ε η c η the goal is to design the dynamic inputs in a way that the above mentioned error vector be stable about the origin to meet this goal a filtered error as the sliding surface is defined as 26 s ε ω ε d t where ω is the positive definite gain matrix consider f f u f v as the control input vector of the system the following control input for the auv is proposed here 27 f m 1 η c c u v ω ε k sgn s here k is the diagonal controlling gain matrix and m c should be calculated as follow 28 c u v m 22 m 11 v r x u m 11 u x u u m 11 u u m 11 m 22 u r y v m 22 v y v v m 22 v v m m 11 0 0 m 22 dynamic equation 3 can be rewritten now as bellow 29 u v r c u v m 11 m 22 m 33 v u n r m 33 r n r r m 33 r r m 0 2 1 0 1 2 0 f 0 the sliding condition is considered as follow 30 1 2 v π t s π π 1 π 2 where π is an adjustable positive gain vector the positive definite function v is considered as 31 v 1 2 s t s where s defines the distance from the sliding surface the derivative of this function with respect to the time will be 32 v s t s s t ε π ε s t η c η ω ε s t η c c m f ω ε considering equation 27 this derivation can be written as follow 33 v s t η c c m m 1 η c c ω ε k sgn s ω ε k s considering k π the sliding condition is satisfied and the stability is guaranteed in order to avoid the chattering phenomenon and inappropriate control signals the following approximation is employed 34 sgn s s s δ in order to check the internal dynamics of the system the boundedness of the response of the third equation needs to be checked in the third equation of the system the following terms n r m 33 r n r r m 33 r r are stabilizing terms and according to the designed controller the parameters u v converge to u c v c and these terms are bounded thus it can be concluded that according to the above equation r also is convergent and bounded 3 4 obstacle avoidance capability in order to provide the capability of local obstacle avoidance for the designed auv an obstacle avoidance controlling signal is designed and added to the main controller to meet this goal potential field method is employed this analytic method is preferable compared to numerical methods while the numerical methods have some disadvantages including offline entity and local minimization syndrome which results in the lack of ability of bypassing the moving and local obstacles the repulsive potential function is defined as 35 ϕ r e p 1 r o b s d 2 log r o b s d 2 where d is the diameter of the encompassed sphere of the obstacle and r is the instantaneous shortest distance between the robot and the obstacle center now according to f r e p β ϕ r e p we have 36 f r e p x β x x o b s r o b s 2 d 2 r o b s 6 f r e p y β y y o b s r o b s 2 d 2 r o b s 6 where β is an adjustable avoidance gain of obstacles thus the final controlling input considering the designed obstacle avoidance feature can be improved as the following formula 37 f m 1 η c c u v ω ε k sgn δ f r e p the overall scheme of the proposed adaptive feedback linearizing controller aflc equipped by the designed obstacle avoidance feature can be depicted as the following flowchart see fig 2 4 obtained results in order to prove the efficiency stability and robustness of the proposed controller for controlling the auv some simulation scenarios are conducted in order to show the efficiency of the proposed robust controller for tracking the performance of the proposed controller is compared with ordinary feedback linearization method and robust controller of sliding mode in presence of disturbances and uncertainties the considered parameters of the studied auv for the following simulation are as table 1 the controlling gains are tuned by trial and error to achieve the best performance with the least amount of error overshoot and settling time also we have 38 m 11 m x u 215 k g m 22 m y v 265 k g m 33 i z n r 80 k g m 2 reference trajectory of the robot is supposed as follow 39 x s 5 r cos 36 t t cos 6 t t y s 5 r cos 36 t t sin 6 t t where r 20 and t 50 system initial condition is also set as q 0 0 2 0 t moreover the following disturbance is considered to be implemented on the robot in order to check the robustness of the proposed control algorithm d 2 s i n t 0 3 s i n t 0 3 s i n t t h t 20 h t 30 where h t is the unit step function also the system mass parameter is considered to have a deviation from its nominal value in 20th second according to m 1 0 5 u t 20 m as the parametric uncertainty of the system in order to show the superiority of the proposed controlling strategy the response of the robot for tracking the desired path in presence of the mentioned disturbance and uncertainties is compared between three different controllers a simple traditional nonlinear controller of feedback linearization a conventional robust controller of smc proposed in gu and wang 2009b and the nonlinear robust and adaptive controller which is proposed in this paper the comparison of the desired and actual trajectories using the mentioned controllers is depicted in fig 3 as can be seen the regulation part of the movement for the system in which is controlled by the aid of the proposed adaptive controller and smc are over damped while the one which is controlled by simple fl is under damped besides in the tracking part the oscillatory response of the robot about its reference trajectory as a result of the mentioned disturbance and uncertainties is significantly more severe for the conventional methods of fl and smc while the deviation of the system controlled by the proposed controller is essentially decreased the workspace errors are also compared in fig 4 here it can be seen that the integral of the root mean square rms of the errors related to fl is 0 56 this value is decreased for the system controlled by smc to about 0 52 while the best score is related to the robot equipped by the proposed controller which is 0 46 the related comparison of the required generalized force of the system is shown in fig 5 it can be seen that using the proposed adaptive controller not only provides a more accurate and stable tracking for the auv robot but also requires lower amount of inputs which shows the efficiency of the proposed controller in presence of disturbances here it can be observed that the rms of the control inputs is 243 85 for flc while this value is decreased to 232 46 for the robust controller of smc again here this score is reduced to its minimum value of 194 48 using the proposed aflc it can be seen that the robust controller of smc suffers from chattering phenomenon especially during the regulation moments which is extremely unwanted and destructive for the engaged equipment of the robot required adaptive controller gains need to be changed during the movement as shown in fig 6 to improve the accuracy and controlling input it can be concluded that the proposed adaptive controller can successfully increase the stability and accuracy of the auv tracking by online tuning the adaptive gains 4 1 obstacle avoidance capability in order to show the capability of the designed system and controller to bypass the local obstacles two scenarios are considered in the first simulation two stationary obstacles are located within the trajectory of the auv while in the second one a moving obstacle is supposed to be bypassed in the first scenario the auv is supposed to track the same trajectory of the previous case while two obstacles are placed within its movement in the positions x o b s 1 0 y o b s 1 5 x o b s 2 4 y o b s 2 3 again here the performances of the proposed controller and flc are compared for the workspace response of the robot in fig 7 as can be seen both of the controllers have passed the obstacles successfully however for the system which is controlled using the proposed adaptive controller not only the obstacle is bypassed but also its deviation with respect to the reference trajectory is considerably less compared to the simple fl approach which shows the efficiency of the proposed controller the error profile of these two controllers with respect to the reference trajectory is also depicted in fig 8 here it is obvious that the amplitude of the error signals during the obstacle rounding is less for the proposed controller which is also enough for bypassing the considered obstacles here it can be seen that the integral of the root mean square rms of the errors related to fl is 0 58 while this value is decreased to 0 47 for the proposed aflc algorithm in the presence of uncertainties of the system the corresponding generalized forces for these two controllers are also compared in fig 9 it can be concluded through the above figure that the designed adaptive controller adjusts its controlling gains in a way that it could be able to bypass the obstacle with the minimum deviation with respect to the reference trajectory which needs larger amount of control effort during the bypassing process and this increase is detected and implemented by the designed adaptive controller automatically however the rms of the control inputs is 218 61 for flc and it is decreased to 212 10 for the aflc this improvement in the control inputs of the system is realized by the aid of the automatic tuning of the adaptive gains as shown in fig 10 in fig 11 it is shown that this convergence to the reference trajectory and obstacle avoidance capability is possible through every initial point in the workspace of the system with the same advantages here it can be seen that using the proposed aflc not only all of the obstacles can be bypassed successfully from any initial point but also its deviation respect to the reference trajectory is minimum and less than ordinary flc in the second scenario a moving obstacle is disturbing the tracking of the auv with the previous desired trajectory the path of the moving obstacle is the same as the desired path of the robot and it appears during the time period of 49 5 and 53 5 as can be seen the obstacle interferes the tracking of the robot within the time period between 49 5 s and 53 5 s the actual trajectory of the system equipped by obstacle avoidance in presence of this moving obstacle is depicted in fig 12 and its performance is compared with simple fl controller as can be seen both of aflc and flc can successfully bypass the mentioned moving obstacle however again the proposed adaptive controller has accomplished this mission with lower overshoot and less deviation respect to the desired trajectory the comparison of the related errors between these two controllers are depicted in fig 13 comparison of the error profiles confirms the mentioned claim based on better efficiency of the designed controller corresponding comparison of the required generalized forces of the system can also be seen in fig 14 it is obvious that the designed controller needs lower amount of controlling effort for tracking the desired path in presence of obstacle while its related path is nearer to the desired one also it can be seen that during the time period in which the moving obstacle is located at the desire path both of controlling inputs have an oscillatory behavior which is contributed to rounding the obstacle the profile of changing the adaptive controlling gain of the proposed controller can be observed as follow see fig 15 it can be seen that the gain is increased at the moments of bypassing the obstacle to provide the required torque and force for rounding the moving obstacle 5 conclusion a new lyapunov based controller was designed and implemented for underwater vehicles in this paper which is capable of bypassing the local and moving obstacles since the proposed controller is model based the kinematic and kinetic model of the studied auv were first extracted afterwards a new nonlinear controller was proposed and implemented on the extracted model of the robot which is based on lyapunov stability the robustness of the designed controller was provided using sliding mode approach while the related controlling gains can be tuned automatically using an adaptive strategy it was explained that since these kind of vehicles are usually faced to external drag disturbances and probable obstacle collisions under the ocean waters obstacle avoidance capability needs also to be added to the designed robust controller installed on these robots this capability was covered employing potential field method which is analytic and suitable for real time performances such as bypassing the local and moving obstacles the efficiency of the proposed controller was then verified by the aid of some simulation scenarios conducted in matlab it was seen that the accuracy of the proposed controller is improved about 18 compared to a simple fl controller and about 11 compared to robust controller of smc in presence of uncertainties and disturbances this improvement is realized while the required torque of the motors is also less more smooth and do not suffer from chattering phenomenon this superiority was also proved in presence of obstacles since both of the stationary and moving local obstacles were bypassed successfully with the least amount of deviation respect to the reference trajectory from any initial condition about 19 improvement was observed in accuracy of tracking for the proposed controller compared to flc it was also seen that this improvement of performance is due to automatic tuning of the controlling gains and the related time dependent gains were extracted which result in the best accuracy of the system respect to simple controller of fl as a result by the aid of the proposed controller not only the stability and accuracy of the auvs can be guaranteed in a robust way but also any kind of local and moving obstacles can be rounded successfully and in an adaptive way acknowledgments the authors would like to thank vice chancellor for research and technology of kharazmi university for their financial support 
22111,in this paper a strong robust nonlinear controller is proposed for an underwater vehicle based on lyapunov theory which is able to bypass the local and moving obstacles using potential field approach underwater vehicles are nowadays widely applicable for performing both of inspectional and operational tasks under the surface of oceans considering the fact that in these environments additional external forces such as drag force of the fluid flow and many other disturbances can affect the performance of the robot providing the stability and controlling the system in a robust way is extremely desirable on the other hand bypassing the local obstacles that are inevitable under the surface of oceans is another challenge that needs to be studied in this paper a strong robust controller is designed and implemented on the nonlinear dynamic model of the underwater robot based on lyapunov method which is also equipped by obstacle avoidance feature as a result not only the stability of the system is guaranteed and the robustness of the robot is provided against the external fluid forces and other exerted disturbances but also the trajectory can be improved in order to bypass the stationary and moving obstacles model of the robot is first extracted afterwards the proposed lyapunov based controller is designed and implemented on the robot obstacle avoidance algorithm is then designed using analytic approach of potential field method in order to bypass the local obstacles the correctness of the robot modeling and the efficiency of the designed controller is verified by the aid of some analytic and comparative simulation scenarios in matlab it is shown that by the aid of the presented model of underwater robot and its related proposed control the system can successfully perform any mission with a high accuracy and robustness even in the presence of obstacles keywords lyapounov based control robust control underwater vehicle obstacle avoidance potential field 1 introduction nowadays auvs are widely applicable in marine industries and its dependent affairs its application consists both of inspectional and operational tasks through the ocean and under the surface of water of any kind of fluid channels karimi and hasanzadeh ghasemi 2017 considering the complicated dynamics and behavior of this kind of robots in presence of drag forces and different external disturbances especially in its 6 dofs mode an acceptable control of the robot needs exact nonlinear modeling of the robot and also designing a strong controller with a high robustness and stability as a results a vast variety of nonlinear controllers are proposed so far the first step to design an efficient analytic controller is to extract the model of the system kinematics and dynamics of auvs which are extremely and heavily nonlinear and complicated is derived by fossen 1994 the first beneficent of extracting the model of the robot is providing the possibility of stability analysis of such under water systems the planar stabilization problem of auvs in a regulation process is studied in some researches aguiar and pascoal 2002 wichlund et al 1995 reyhanoglou 1997 pettersen and egeland 1999 pettersen and fossen 2000 mazenc et al 2002 in these studied it has been shown that such under water vehicles cannot be asymptotically stable using time invariant feedback controllers the next autonomous generation of auvs are equipped by tracking controller through which any desired trajectory can be passed employing proper nonlinear controllers recently in order to increase the smartness of these kind of vehicles for covering the tracking missions some researchers have suggested numerical controllers such as neural networks wang and lee 2003 yuh 1990 or fuzzy based controllers liang et al 2016 although these numerical methods have a lot of advantages and increases the flexibility of the system controllers they are usually offline which restricts their usage for online and real time applications in order to compensate the mentioned disadvantages of numerical controllers some nonlinear analytic controllers have been proposed so far for example ordinary sliding mode controller smc is proposed for robust control of such systems in ashrafiuon et al 2008 wang et al 2012 while higher order sliding mode is implemented in delavari and heydarinejad 2017 and terminal sliding mode is employed in nikoo et al 2016 although these mentioned sliding mode based controllers are robust enough to be applicable in presence of external disturbances but they can t cancel the destructive effects of parametric uncertainties arises from the complicated dynamics of these vehicle in order to cover the mentioned challenge different adaptive controllers are designed and proposed in the literatures gu and hu 2008 gu and wang 2009 khalaji and moosavian 2014 khatib 1986 sahu and subudhi 2017 are other sliding mode based controllers for these kind of systems in which the stability of the system is provided by calculating the proper controlling gains also optimization feature is considered in some studies by proposing closed loop optimal controllers through which not only the robustness of the system can be guaranteed but also a desired objective function can be minimized the best analytic optimal controller for such systems is state dependent riccati equation sdre which is implemented for auvs in geranmehrand and nekoo 2015 although this controller is feedback based and optimal but it cannot handle the robot in presence of the possible obstacles located in the seas another challenge of these kind of underwater vehicles is to satisfy the stability of the system in presence of environmental situations and uncertainties the previous theoretical and experimental researches show that the best solution to cover the mentioned consideration is to employ lyapunov based techniques this technique is used experimentally in pettersen and nijmeijer 2001 for a model surface ship in lefeber et al 2003 this controller is employed for a surface vessel however in the mentioned studies controlling the yaw dof of auv s is ignored on the other hand the main objective of controlling the underwater vehicles is to guide them along any desired trajectory within the oceans trough which a lot of potential obstacles might be presented thus integrating a proper obstacle avoidance controller together with a robust and stable tracker could be highly appreciable for such underwater vehicles most of the employed obstacle avoidance techniques are based on numerical approaches such as fuzzy or neural network methods for example xu and feng 2009 lee et al 2004 use fuzzy algorithms for bypassing the obstacles while demuth and springsteen 1990 employs neural network for this purpose although these methods do not need the model of the system but they are not suitable for online and real time applications such as bypassing the local or moving obstacles since their algorithms are based on offline strategies the best analytic obstacle avoidance technique is based on potential field method the main idea of obstacle avoidance control using potential field method was firstly proposed by khatib lee et al 2004 in this research the obstacles are stationary and avoiding from collision is provided by developing a complimentary force calculated by gradient of a proper potential function this idea was then employed in demuth and springsteen 1990 khatib 1986b for avoiding the collision with the underwater obstacles for auv systems however in the mentioned researches the robust and stable tracking of the system is ignored and the robot is sensitive in presence of external disturbances and parametric uncertainties it can be seen through the mentioned literature that developing a general controller by which all of the objective items including robustness full state controllability stability and obstacle avoidance capability can be met simultaneously has been ignored so far therefore in this paper in order to cover the mentioned deficiency a stable and nonlinear lyapounov based controller is designed and implemented for an underwater vehicle with six spatial nonlinear dofs which is highly robust against the external disturbances and adaptive against the parametric uncertainties moreover obstacle avoidance is also included in the mentioned proposed controller employing potential field method this method is more applicable for local and moving obstacles since the numerical methods are mostly offline and are not suitable for such real time performances as a result not only the robust and stable tracking of the mentioned spatial underwater vehicle is realized but also its smartness is increased by adding the feature of obstacle avoidance capability in the next section the nonlinear model of a well known spatial underwater vehicle with six dofs is represented afterwards in section three the mentioned nonlinear and robust lyapounov based controller is designed and implemented on the robot dynamics and the required improvements are conducted to increase its adaptability and robustness in section four in order to provide the ability of rounding the local obstacles an obstacle avoidance controller is developed and added to the main tracker controller finally in section five all of the claimed advantages of the proposed controller is verified by simulating the dynamics of the mentioned underwater vehicle in matlab and conducting a series of analytic and comparative simulation scenarios it is shown that using the proposed controller both of tracking and obstacle avoidance of such underwater systems can be realized successfully in presence of drag forces and other external disturbances of underwater environments 2 modeling of the auv in this section kinematic and kinetic models of the considered auv robot are represented the schematic view of the robot and the considered global and local coordinates are shown in fig 1 the auv has three degrees of freedom x y ψ t which can be controlled by the aid of the system inputs including longitudinal and lateral forces f u f v t the mathematical models are prerequisite formulation for extracting the proposed controlling commands 2 1 kinematic modeling the generalized coordinates of the robot and its corresponding workspace velocities are defined as follow 1 q x y ψ w u v r here the generalized coordinates are defined in inertial coordinates system and its related workspace velocities are defined respect to the local coordinate system attached to the robot the corresponding jacobian matrix can be extracted as 2 x y ψ cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 u v r 2 2 kinetic modeling implementing the lagrange method for extracting the dynamic model of the auv results in the following workspace dynamic equations 3 u m 22 m 11 v r x u m 11 u x u u m 11 u u f u m 11 v m 11 m 22 u r x u m 22 v y v v m 22 v v f v m 22 r m 11 m 22 m 33 v u n r m 33 r n r r m 33 r r where f u f v are longitudinal and lateral forces of auv respectively m 11 and m 22 are the combined rigid body and added mass terms while m 33 is the combined and added moment about z b also x u y u n r x u u y v v and n r r are the linear and quadratic drag terms coefficients respectively gu and hu 2008b 3 proposed control scheme in this paper a nonlinear lyapunov based controller is proposed which is robust against the external disturbances associated to the drag and lifting forces of the flowing fluid and also parametric uncertainties of the system the mentioned controller also has the capability of obstacle avoidance by which the possible local obstacles of the oceans can be avoided in an online way 3 1 tracking controller in this section the auv robot is supposed to track a desired trajectory and its workspace states should follow the reference trajectory in a robust and stable way the target is to track the reference trajectory as follow 4 ξ x y ξ s x s y s the kinematic inputs η u v should be calculated in a way that the above tracking problem can be realized in a stable way the index s denotes the reference trajectory considering the kinematic model of equation 2 we have 5 ξ r ψ η where r cos ψ sin ψ sin ψ cos ψ is the rotation matrix mapping the local coordinate into the global one in order to cover the mentioned tracking problem the position error is defined as follow 6 e ξ ξ s thus the error dynamic of the system will be 7 e ξ ξ s substituting equation 5 in the above equation one can conclude 8 e r ψ η ξ s now we consider the desired stable error dynamic as follow 9 e k e thus it can be concluded that 10 r ψ η ξ s k e η r t ψ k e ξ s therefore the kinematic inputs of equation 10 can stabilize the error dynamic of equation 9 and ensure the objective ξ ξ s now we suppose that the modeling of the system is not perfect and some uncertainties are involved in the extracted model of the system these uncertainties are considered together with the related kinematic constraints along x y as follow 11 ξ s r ψ η δ where δ is the corresponding kinematic constraints along x and y thus considering equation 10 results in 12 ξ r ψ r t ψ k e ξ s δ δ r t ψ ξ s r t ψ k e ξ s r t ψ ξ k e ξ s since the closed loop system is supposed to be stable and considering the fact that the determinant of r is equal to one the uncertainty is bounded as follow 13 δ e α 1 e δ α 0 α 1 e where α 0 α 1 are the upper bound uncertainty parameters of the lumped parameter system now in order to compensate the uncertainty δ the control input η is modified as follow 14 η r t ψ k e ξ s α ˆ 0 α ˆ 1 e where α ˆ 0 α ˆ 1 are the estimation of the parameters α 0 α 1 substituting the above control input in equation 8 we have 15 e k e α ˆ 0 α ˆ 1 e δ the estimation error of the parameters α 0 α 1 are shown by α 0 α 1 and can be defined as 16 α i α ˆ i α i i 1 2 3 2 stability analysis in order to guarantee the stability of the designed controller the lyapunov stability theory should be satisfied the following lyapunov function candidate is considered to check the stability of the closed loop system 17 v 1 2 e t e 1 2 α 0 2 σ 0 1 2 α 1 2 σ 1 where σ 0 σ 1 are positive real numbers that will be later used as the adaptive gains the derivation of this function with respect to time can be calculated as follow 18 v e t e α 0 α 0 σ 0 α 1 α 1 σ 1 considering the fact that the variations of the system uncertainties and consequently their related α i are smooth we can write equation 18 as bellow 19 v e t e α 0 α ˆ ˆ 0 σ 0 α 1 α ˆ ˆ 1 σ 1 now by substituting equation 15 in the above function one can conclude that 20 v e t k e α ˆ 0 α ˆ 1 e δ α 0 α ˆ ˆ 0 σ 0 α 1 α ˆ ˆ 1 σ 1 considering equation 13 it can be concluded that 21 v e t k e e α ˆ 0 α ˆ 1 e α 0 α 1 e α 0 α ˆ ˆ 0 σ 0 α 1 α ˆ ˆ 1 σ 1 and finally considering equation 16 we have 22 v e t k e e α 0 α 1 e α 0 α ˆ ˆ 0 σ 0 α 1 α ˆ ˆ 1 σ 1 v e t k e α 0 α ˆ ˆ 0 σ 0 e α 1 α ˆ ˆ 1 σ 1 e 2 the following adaptive rules are considered 23 α ˆ ˆ 0 σ 0 e α ˆ ˆ 1 σ 1 e 2 then it can be concluded that the derivative of the lyapunov function can be summarized as follow 24 v e t k e as can be seen the above function is negative definite with respect to the error and therefore it can be concluded that the error converges to zero while the considered adaptive parameters remain bounded simultaneously 3 3 sliding mode dynamic control in order to strengthen the robustness of the control algorithm in presence of disturbances and uncertainties a sliding mode algorithm is used to control the system in the dynamic level the kinematic control inputs η which were previously determined can be considered as the reference dynamic control inputs the index c shows that the related signal is a command signal therefore the following error vector can be defined as the dynamic of the controlling error 25 ε η c η the goal is to design the dynamic inputs in a way that the above mentioned error vector be stable about the origin to meet this goal a filtered error as the sliding surface is defined as 26 s ε ω ε d t where ω is the positive definite gain matrix consider f f u f v as the control input vector of the system the following control input for the auv is proposed here 27 f m 1 η c c u v ω ε k sgn s here k is the diagonal controlling gain matrix and m c should be calculated as follow 28 c u v m 22 m 11 v r x u m 11 u x u u m 11 u u m 11 m 22 u r y v m 22 v y v v m 22 v v m m 11 0 0 m 22 dynamic equation 3 can be rewritten now as bellow 29 u v r c u v m 11 m 22 m 33 v u n r m 33 r n r r m 33 r r m 0 2 1 0 1 2 0 f 0 the sliding condition is considered as follow 30 1 2 v π t s π π 1 π 2 where π is an adjustable positive gain vector the positive definite function v is considered as 31 v 1 2 s t s where s defines the distance from the sliding surface the derivative of this function with respect to the time will be 32 v s t s s t ε π ε s t η c η ω ε s t η c c m f ω ε considering equation 27 this derivation can be written as follow 33 v s t η c c m m 1 η c c ω ε k sgn s ω ε k s considering k π the sliding condition is satisfied and the stability is guaranteed in order to avoid the chattering phenomenon and inappropriate control signals the following approximation is employed 34 sgn s s s δ in order to check the internal dynamics of the system the boundedness of the response of the third equation needs to be checked in the third equation of the system the following terms n r m 33 r n r r m 33 r r are stabilizing terms and according to the designed controller the parameters u v converge to u c v c and these terms are bounded thus it can be concluded that according to the above equation r also is convergent and bounded 3 4 obstacle avoidance capability in order to provide the capability of local obstacle avoidance for the designed auv an obstacle avoidance controlling signal is designed and added to the main controller to meet this goal potential field method is employed this analytic method is preferable compared to numerical methods while the numerical methods have some disadvantages including offline entity and local minimization syndrome which results in the lack of ability of bypassing the moving and local obstacles the repulsive potential function is defined as 35 ϕ r e p 1 r o b s d 2 log r o b s d 2 where d is the diameter of the encompassed sphere of the obstacle and r is the instantaneous shortest distance between the robot and the obstacle center now according to f r e p β ϕ r e p we have 36 f r e p x β x x o b s r o b s 2 d 2 r o b s 6 f r e p y β y y o b s r o b s 2 d 2 r o b s 6 where β is an adjustable avoidance gain of obstacles thus the final controlling input considering the designed obstacle avoidance feature can be improved as the following formula 37 f m 1 η c c u v ω ε k sgn δ f r e p the overall scheme of the proposed adaptive feedback linearizing controller aflc equipped by the designed obstacle avoidance feature can be depicted as the following flowchart see fig 2 4 obtained results in order to prove the efficiency stability and robustness of the proposed controller for controlling the auv some simulation scenarios are conducted in order to show the efficiency of the proposed robust controller for tracking the performance of the proposed controller is compared with ordinary feedback linearization method and robust controller of sliding mode in presence of disturbances and uncertainties the considered parameters of the studied auv for the following simulation are as table 1 the controlling gains are tuned by trial and error to achieve the best performance with the least amount of error overshoot and settling time also we have 38 m 11 m x u 215 k g m 22 m y v 265 k g m 33 i z n r 80 k g m 2 reference trajectory of the robot is supposed as follow 39 x s 5 r cos 36 t t cos 6 t t y s 5 r cos 36 t t sin 6 t t where r 20 and t 50 system initial condition is also set as q 0 0 2 0 t moreover the following disturbance is considered to be implemented on the robot in order to check the robustness of the proposed control algorithm d 2 s i n t 0 3 s i n t 0 3 s i n t t h t 20 h t 30 where h t is the unit step function also the system mass parameter is considered to have a deviation from its nominal value in 20th second according to m 1 0 5 u t 20 m as the parametric uncertainty of the system in order to show the superiority of the proposed controlling strategy the response of the robot for tracking the desired path in presence of the mentioned disturbance and uncertainties is compared between three different controllers a simple traditional nonlinear controller of feedback linearization a conventional robust controller of smc proposed in gu and wang 2009b and the nonlinear robust and adaptive controller which is proposed in this paper the comparison of the desired and actual trajectories using the mentioned controllers is depicted in fig 3 as can be seen the regulation part of the movement for the system in which is controlled by the aid of the proposed adaptive controller and smc are over damped while the one which is controlled by simple fl is under damped besides in the tracking part the oscillatory response of the robot about its reference trajectory as a result of the mentioned disturbance and uncertainties is significantly more severe for the conventional methods of fl and smc while the deviation of the system controlled by the proposed controller is essentially decreased the workspace errors are also compared in fig 4 here it can be seen that the integral of the root mean square rms of the errors related to fl is 0 56 this value is decreased for the system controlled by smc to about 0 52 while the best score is related to the robot equipped by the proposed controller which is 0 46 the related comparison of the required generalized force of the system is shown in fig 5 it can be seen that using the proposed adaptive controller not only provides a more accurate and stable tracking for the auv robot but also requires lower amount of inputs which shows the efficiency of the proposed controller in presence of disturbances here it can be observed that the rms of the control inputs is 243 85 for flc while this value is decreased to 232 46 for the robust controller of smc again here this score is reduced to its minimum value of 194 48 using the proposed aflc it can be seen that the robust controller of smc suffers from chattering phenomenon especially during the regulation moments which is extremely unwanted and destructive for the engaged equipment of the robot required adaptive controller gains need to be changed during the movement as shown in fig 6 to improve the accuracy and controlling input it can be concluded that the proposed adaptive controller can successfully increase the stability and accuracy of the auv tracking by online tuning the adaptive gains 4 1 obstacle avoidance capability in order to show the capability of the designed system and controller to bypass the local obstacles two scenarios are considered in the first simulation two stationary obstacles are located within the trajectory of the auv while in the second one a moving obstacle is supposed to be bypassed in the first scenario the auv is supposed to track the same trajectory of the previous case while two obstacles are placed within its movement in the positions x o b s 1 0 y o b s 1 5 x o b s 2 4 y o b s 2 3 again here the performances of the proposed controller and flc are compared for the workspace response of the robot in fig 7 as can be seen both of the controllers have passed the obstacles successfully however for the system which is controlled using the proposed adaptive controller not only the obstacle is bypassed but also its deviation with respect to the reference trajectory is considerably less compared to the simple fl approach which shows the efficiency of the proposed controller the error profile of these two controllers with respect to the reference trajectory is also depicted in fig 8 here it is obvious that the amplitude of the error signals during the obstacle rounding is less for the proposed controller which is also enough for bypassing the considered obstacles here it can be seen that the integral of the root mean square rms of the errors related to fl is 0 58 while this value is decreased to 0 47 for the proposed aflc algorithm in the presence of uncertainties of the system the corresponding generalized forces for these two controllers are also compared in fig 9 it can be concluded through the above figure that the designed adaptive controller adjusts its controlling gains in a way that it could be able to bypass the obstacle with the minimum deviation with respect to the reference trajectory which needs larger amount of control effort during the bypassing process and this increase is detected and implemented by the designed adaptive controller automatically however the rms of the control inputs is 218 61 for flc and it is decreased to 212 10 for the aflc this improvement in the control inputs of the system is realized by the aid of the automatic tuning of the adaptive gains as shown in fig 10 in fig 11 it is shown that this convergence to the reference trajectory and obstacle avoidance capability is possible through every initial point in the workspace of the system with the same advantages here it can be seen that using the proposed aflc not only all of the obstacles can be bypassed successfully from any initial point but also its deviation respect to the reference trajectory is minimum and less than ordinary flc in the second scenario a moving obstacle is disturbing the tracking of the auv with the previous desired trajectory the path of the moving obstacle is the same as the desired path of the robot and it appears during the time period of 49 5 and 53 5 as can be seen the obstacle interferes the tracking of the robot within the time period between 49 5 s and 53 5 s the actual trajectory of the system equipped by obstacle avoidance in presence of this moving obstacle is depicted in fig 12 and its performance is compared with simple fl controller as can be seen both of aflc and flc can successfully bypass the mentioned moving obstacle however again the proposed adaptive controller has accomplished this mission with lower overshoot and less deviation respect to the desired trajectory the comparison of the related errors between these two controllers are depicted in fig 13 comparison of the error profiles confirms the mentioned claim based on better efficiency of the designed controller corresponding comparison of the required generalized forces of the system can also be seen in fig 14 it is obvious that the designed controller needs lower amount of controlling effort for tracking the desired path in presence of obstacle while its related path is nearer to the desired one also it can be seen that during the time period in which the moving obstacle is located at the desire path both of controlling inputs have an oscillatory behavior which is contributed to rounding the obstacle the profile of changing the adaptive controlling gain of the proposed controller can be observed as follow see fig 15 it can be seen that the gain is increased at the moments of bypassing the obstacle to provide the required torque and force for rounding the moving obstacle 5 conclusion a new lyapunov based controller was designed and implemented for underwater vehicles in this paper which is capable of bypassing the local and moving obstacles since the proposed controller is model based the kinematic and kinetic model of the studied auv were first extracted afterwards a new nonlinear controller was proposed and implemented on the extracted model of the robot which is based on lyapunov stability the robustness of the designed controller was provided using sliding mode approach while the related controlling gains can be tuned automatically using an adaptive strategy it was explained that since these kind of vehicles are usually faced to external drag disturbances and probable obstacle collisions under the ocean waters obstacle avoidance capability needs also to be added to the designed robust controller installed on these robots this capability was covered employing potential field method which is analytic and suitable for real time performances such as bypassing the local and moving obstacles the efficiency of the proposed controller was then verified by the aid of some simulation scenarios conducted in matlab it was seen that the accuracy of the proposed controller is improved about 18 compared to a simple fl controller and about 11 compared to robust controller of smc in presence of uncertainties and disturbances this improvement is realized while the required torque of the motors is also less more smooth and do not suffer from chattering phenomenon this superiority was also proved in presence of obstacles since both of the stationary and moving local obstacles were bypassed successfully with the least amount of deviation respect to the reference trajectory from any initial condition about 19 improvement was observed in accuracy of tracking for the proposed controller compared to flc it was also seen that this improvement of performance is due to automatic tuning of the controlling gains and the related time dependent gains were extracted which result in the best accuracy of the system respect to simple controller of fl as a result by the aid of the proposed controller not only the stability and accuracy of the auvs can be guaranteed in a robust way but also any kind of local and moving obstacles can be rounded successfully and in an adaptive way acknowledgments the authors would like to thank vice chancellor for research and technology of kharazmi university for their financial support 
22112,liquid overflow accident during pigging operation in offshore oil and gas field inevitably leads to production loss and deferment which could be effectively addressed by applying bypass pigging technology aiming to analyze amelioration effects of pigging induced liquid flow through bypass pigging the paper first conducted a gas liquid two phase bypass pigging experiment then developed a cfd bypass pigging model to investigate the downstream liquid slug dissipation mechanism furthermore a surge liquid volume analytical model was established to conduct parametric analysis the results show that bypass pigging could ameliorate pigging induced liquid accumulation achieving a much smaller terminal pressure oscillation attributed to the gas liquid carrying effect the increase in bypass fraction from 0 to 2 reduces liquid outflow rate up to 75 achieving a more manageable liquid arrival profile downstream liquid slug dissipation hinges on the balance between force of the pig exerting on the liquid and gas carrying effects which could be effectively enhanced by an increased gas liquid relative velocity pig velocity dominates the surge volume by combining bypass pigging technology and increasing liquid drain rate the liquid overflow accident could be potentially avoided the study lays a solid foundation for the advancement of bypass pigging technology in offshore oil and gas fields keywords bypass pigging pigging induced liquid flow cfd model surge volume parametric analysis 1 introduction in the middle and late stages of oil and gas fields especially for natural gas condensate pipelines operational problems such as serious liquid loading increased gas liquid frictional resistance and complicated gas liquid flow issues are frequently encountered ayala and adewumi 2003 davoudi et al 2014 jamshidi and sarkari 2016 onuoha et al 2018 xu and gong 2005 zhu et al 2018 which seriously affect the normal production to this end it is necessary to carry out pigging operations on a regular basis which is an important flow assurance strategy for pipeline maintenance so as to safeguard and improve its transportation capacities as well as production efficiencies groote et al 2015 olaniyan and larrey 2014 van spronsen et al 2013 wu and van spronsen 2005 with oil and gas exploration moving towards deep water areas the corresponding high pressure and low temperature environment as well as increasingly complex underwater pipeline system tend to produce more liquid loading which may even develop into natural gas hydrate deposited in pipes joshi et al 2013 pedersen et al 2017 xing et al 2014 xing et al 2013a b zerpa et al 2012 therefore higher pigging requirements are entailed to secure a safe operation pig velocity basically determines the achievable effects of pigging operation groote et al 2015 thereby velocity control strategy is of great significance to ensure an efficient pigging operation mirshamsi and rafeeyan 2012 money et al 2012 nguyen et al 2001a 2001b zhu et al 2014 the optimal pigging effect can be achieved by maintaining a constant pig velocity in the range of 2 m s to 7 m s for natural gas pipeline money et al 2012 nguyen et al 2001b the traditional pigging operation remains the same pig velocity as the rear driving gas flow rate which often exerts excessive force on the downstream liquid loading inducing the liquid accumulation in front of the pig the gradually accumulated liquid may develop into an unmanageable liquid slug upon its arrival at terminals thus causing overflow accidents due to the limited size of slug catchers in comparison to traditional pigging process bypass pigging operation fig 1 could possibly reduce the liquid accumulation by gas liquid carrying effects through a bypass port thus eliminating pig generated slugs due to the existence of the bypass structure pig velocity can be significantly reduced which may be of great benefits to the oil and gas production van spronsen et al 2013 the research in bypass pigging has aroused increasing attentions in recent years with its positive benefits being broadly reported on engineering applications entaban et al 2013 groote et al 2015 lee et al 2012 money et al 2012 olaniyan and larrey 2014 park et al 2016 van spronsen et al 2013 wu and van spronsen 2005 detailed indoor bypass pigging experiments were conducted by chen et al 2018 2020 to illustrate the bypass pig movement characteristics with a focus on pig velocity reduction hendrix et al azpiroz et al 2015 hendrix et al 2017 singh and henkes 2012 studied the pressure drop coefficient through bypass pigs based on a cfd model which is an important structural parameter governing the pig movement a simplified 1d model has been recently proposed and validated to describe the oscillatory pig movements in order for designing a controller to minimize pig oscillations hendrix et al 2018 by and large there is still a deficiency of detailed research on the flow characteristics of downstream liquid slug dissipation mechanism and pigging induced liquid outflow profile that is required to be temporarily stored in terminal slug catchers therefore to fill the gap the paper firstly conducted a gas liquid two phase bypass pigging experiment based on a transparent horizontal pipe system to characterize the pressure variations and terminal pigging induced liquid outflow rates then a cfd bypass pigging model was developed to simulate the downstream liquid distribution patterns and liquid volume fractions furthermore a surge liquid volume analytical model was established to conduct parametric analysis the study elucidates in detail the mechanism of bypass pigging technology in amelioration of pigging induced liquid flow which is of great significance to promote bypass pigging application 2 research methodology 2 1 experimental system 2 1 1 horizontal pipeline system the experimental system with transparent horizontal pigging segment is shown in fig 2 with its physical map illustrated in fig 3 in order to visualize the entire process of the pig movement the pipeline was made of transparent plexiglass tube with an inner diameter of 64 mm and a total length of 15 814 m of which the measurement segment between pressure sensors of p1 and p8 is 15 164 m nine pressure sensors of keller pr25y with an accuracy of 0 25 to record the pigging induced pressure variations were placed along the pipeline three high speed video cameras were used to film pigs movement in the terminal a liquid receiver equipped with a differential pressure sensor with an accuracy of 0 25 and a liquidometer with an accuracy of 5 mm was placed to record the liquid outflow profile since the differential pressure sensor turned out to be more sensitive to the varying outflow liquid rates the corresponding data were used for following analyses and the arriving liquid information from the liquidometer was also utilized as an important reference so as to guarantee more accurate results the operational procedures include the gas adjustment and measurement the preparation of bypass pig prototype the liquid injection pigging operation and data acquisition the air which was adopted as the gas medium was pressurized through a compressor and then stored in a buffer tank to achieve pressure stabilization then the stabilized and filtered air entered into the pipeline system after a precise gas flow rates adjustment and measurement by a vortex flow meter with a maximum error of 1 a pressure and a temperature sensor were placed beside the vortex flow meter to record the real time data which would be used for gas flow rate conversion to the position of the pipeline starting point after the completion of gas flow rates adjustment the bypass pig prototype with the selected bypass fraction was put into the pig launcher for pigging preparation then the measured liquid volume was injected into the pipeline through the liquid inlet port which was followed by introducing the driving gas into the pipeline system for pigging operation the national instruments corporation based labview program was utilized as the data acquisition system 2 1 2 bypass pig prototype the structure of the experimental bypass pig prototype is shown in fig 4 with the physical map presented in fig 5 the newly developed bypass pig prototype is equipped with an internal spring based regulating valve which can adjust the size of bypass port and thereby control the volume of bypass gas to regulate the pig velocity acting in tandem with the regulating unit the bypass nozzle is used to control the bypass fraction which is defined as the ratio of the minimum sectional area of the bypass port to the pipeline sectional area the adopted bypass fraction and corresponding bypass port diameter are illustrated in table 1 the dimensions of sealing and spacing discs table 2 are responsible for comprising pig interference and clamping rate respectively the parameters of which are highly related to the pig friction now that all the mechanical components of the pig prototype can be easily assembled multiple pig prototypes can be obtained for instance the prototypes under different bypass fractions with or without internal spring based regulating unit in this paper we mainly focus on the effects of bypass fraction on the pigging induced liquid outflow profile therefore the internal regulating units were removed from the bypass pig prototype leaving only the bypass nozzle to adjust the bypass fraction 2 2 bypass pigging cfd model development 2 2 1 geometric model and mesh generation the gas liquid two phase bypass pigging geometric model was developed based on the same type of the experimental bypass pig prototype without inner regulating units as presented in fig 6 where the three dimensional structural grids were utilized for mesh generation figs 6 and 7 the development of this model is based on the assumption that forces acting on the pig are well balanced and thus the pig moves at a constant speed under an equilibrium state for the purpose of focusing on the downstream liquid movement the pig is considered as a reference system that remains stationary whilst the pipe walls and liquid loading move in opposite directions relative to the pig velocity liang 2015 singh and henkes 2012 in order to make the fluid flow around the pig fully developed the length of the pipeline in front of the pig was set as 30d meanwhile for saving computing resources the inlet gas flow rate distribution was defined by udf to obtain a fully distributed gas velocity thereby the length of the inlet section was reduced to 5d 2 2 2 boundary condition regarding the adopted medium in the model water and air were defined as the liquid and gas respectively the boundary of velocity inlet and pressure outlet were considered for the air phase simulation where the pressure outlet was set as 0 with reference to the local atmospheric pressure in terms of the water phase the actual liquid outlet boundary as illustrated in fig 6 was assumed to be the liquid velocity inlet with respect to the stationary pig reference system the specific parameters taken relatively to the stationary pig velocity are presented as follows ① inlet gas velocity v g v pig ② pipe wall velocity v pig ③ liquid flow velocity v l v pig regarding the option of calculation models the vof model was employed due to the focus on the gas liquid interface additionally the realizable k ε model and standard wall function were set as the turbulence model and wall condition respectively the effectiveness of which were verified by singh et al singh and henkes 2012 meanwhile the third order quick algorithm was used for the calculation of momentum equation so as to achieve high accurate results 2 2 3 model independence evaluation in order to ensure that the simulation results are independent of the modelling mesh size and time step the mesh numbers of 1141140 mesh 1 and 2114562 mesh 2 and time steps of 0 0001 s and 0 001 s were comparatively investigated with the results presented in fig 8 where the variations of water phase fraction along the central axis were employed for analysis since only gas exists in the rear of the bypass pig the water phase fraction begins from 0 and then abruptly increases to 1 as the axis distance increases the liquid phase is being carried away by the gas exceeding the center height at the position downstream the pig the distances with the water phase fraction returning to 0 correspond to the zones where liquid is not yet affected by the gas phase the comparative results generally exhibit a good agreement between two adopted dimensions which indicate that the simulation results are independent of the selected mesh size and time step thus the eventual mesh number and time step were adopted as 1141140 and 0 001 s respectively 2 3 surge liquid volume analytical model establishment in the oil and gas field the pigging operational efficiency and size design of terminal slug catcher are highly related to the liquid outflow profile during pigging operation hence in order to analyze the pigging induced liquid volume which is required to be temporarily stored in the terminal slug catcher denoted as surge volume v surge based on the equilibrium of total liquid volume flowing into stored in and out of the slug catcher the amount of surge volume v surge can be calculated by groote et al 2015 1 v s u r g e α s a p i p e l s l u g t p i g t s l u g q d r a i n here α s is the liquid volume fraction in the pigging induced liquid slug a pipe is the pipeline sectional area m2 l slug is the length of the pigging induced liquid slug m t pig is the pig running time through the whole pipeline s t slug is the time when the front of pigging induced liquid slug arrives at the end of the pipeline s q drain is the liquid drain rate in the terminal slug catcher m3 s the total liquid loading v liquid before pigging operation is 2 v l i q u i d t s l u g q l α s a p i p e l s l u g here q l is the liquid outflow rate from the pipeline into the slug catcher before the front of pigging induced liquid slug reaches the end of pipeline m3 s the length of pigging induced liquid slug l slug can be calculated as 3 l s l u g l p i p e v p i g t s l u g where l pipe is the length of pipeline m based on equations 2 and 3 the time of t slug can be expressed as 4 t s l u g α s l p i p e a p i p e v l i q u i d α s v p i g a p i p e q l pig running time t pig is 5 t p i g l p i p e v p i g combining equations 3 5 into equation 1 the surge volume v surge can be obtained as 6 v s u r g e v l i q u i d v p i g l p i p e q l q d r a i n a p i p e α s v p i g q l a p i p e α s v p i g v p i g according to equation 6 for a specific oil and gas field if the parameters of total liquid loading v liquid length of pipeline l pipe liquid outflow rate q l pipeline sectional area a pipe are obtained the surge volume v surge is dependent on the liquid volume fraction α s pig velocity v pig and the terminal drain rate q drain bypass pigging operation could effectively reduce the liquid volume fraction α s and pig velocity v pig thereby exerting significant impacts on the surge volume 3 results and discussion 3 1 pressure variations along pipeline large pressure oscillations threaten the safety of pigging operations therefore understanding the pressure variations along the pipeline will be necessary for assessing pigging performance fig 9 shows the experimental results of pressure variations caused by traditional pigging without bypass fraction along the pipeline as the pig passes through the pipeline the pressure at each point rises in turn since the pressure drop of the gas behind the pig is negligible each pressure curve almost overlaps with the back one until the pig is suddenly released after reaching the end now that the downstream liquid flow contacts the corresponding positions ahead of the pig the pressure curves from p2 to p7 are shown with multi stage rising distributions owing to the absence of the bypass structure and the lack of gas carrying effects the downstream liquid gradually accumulates at the end of the pipeline hindering the pig movement and causing p8 to oscillate back and forth until all the liquid loading is eliminated pressure fluctuations of p8 at various liquid volumes are illustrated in fig 10 in the absence of a bypass fraction fig 10 a as the liquid volume increases the oscillatory phenomena of p8 significantly become more obvious especially for the liquid volume of 14 0 l 17 5 l and 20 9 l this indicates that traditional pigging is not suitable for pipes with high liquid loading profile when a greater driving force is applied to the system by increasing the gas flow rates fig 10 b the terminal oscillatory phenomena of p8 are ameliorated but the system average pressures are increased accordingly with positive pressure differences as shown in fig 10 d when the bypass fraction is increased to 2 fig 10 c the terminal pressure oscillation amplitudes are significantly reduced and compared with the case without bypass fraction the related average pressure values are relatively small causing negative pressure differences between bypass fractions of 2 and 0 fig 10 d the results elucidate that bypass pigging is capable of eliminating the accumulation of downstream liquid through bypass gas carrying effects and thus is more conducive to the pipeline conditions with high liquid loading profile if the bypass fraction is appropriately increased a smoother pressure variation can be achieved during the pigging operation 3 2 characteristics of liquid outflow profile the profile of the liquid reaching the receiving device is essential for assessing the safety and effectiveness of the pigging operation which requires that the outflow liquid caused by pigging must be fully controlled within the capacity of the existing liquid receiver to this end detailed analysis of the characteristics of liquid outflow prolife was conducted by considering different operating and pig structural parameters so as to demonstrate the potential of bypass pigging in terms of improving the liquid profile and addressing overflow accidents that may occur during pigging operations the terminal liquid outflow profiles at three bypass fractions are presented in fig 11 under the same volume of liquid loading of 14 l as bypass fraction increases more time is entailed to reach the same liquid level thus the increase in bypass fraction mainly contributes to the extension of outflow liquid which is caused by the prolonged pigging time specifically when bypass fraction is increased from 0 to 2 at the gas flow rate of 8 m s the reduction of the liquid outflow rate is as high as 75 decreasing from 4 8 cm s to 1 2 cm s which turns out to be 56 7 at the gas flow rate of 9 m s fig 11 c therefore due to the gas liquid carrying effects and the extended liquid outflow time the increase in bypass fraction can significantly reduce the liquid outflow rate and thus obtaining a more manageable liquid profile the outflow liquid variations under several volumes of liquid loading are illustrated in fig 12 where a larger liquid volume corresponds to a higher liquid level and a greater liquid outflow rate arriving at the terminal liquid receiver in comparison to the pig without bypass fraction the pig with bypass fraction of 1 promisingly reduces the liquid outflow rates by 47 6 38 4 43 5 45 1 and 40 4 for conditions with liquid loading of 6 3 l 10 4 l 14 0 l 17 5 l and 20 9 l respectively such great reduction amplitudes could significantly contribute to a safer and more efficient engineering operation the benefits of bypass pigging in handling the liquid loading are projected to be possibly larger under a higher bypass fraction the results exhibit a good adaptability of bypass pigging to variations of liquid loading in the pipeline system therefore a great potential of bypass pigging in controlling the terminal liquid volume could be achieved 3 3 pigging induced liquid movement the effect of bypass pigging depends on the relative velocity between the rear driving gas and the pig when the pig velocity keeps the same as the rear driving gas flow rate it is equivalent to traditional pigging with no bypass gas passing through the pig in this case a large amount of downstream liquid may accumulate in front of the pig as the relative velocity between the gas and the pig increases more gas can enter into the downstream pipe through the bypass port thereby further dispersing the downstream liquid and reducing the accumulation of liquid in front of the pig this pigging situation corresponds to the bypass pigging process higher relative velocities equal to larger bypass fractions therefore the modelling approach mainly considered the different relative velocities between the gas and the pig to represent various bypass pigging conditions the details of which are shown in table 3 3 3 1 liquid distribution pattern fig 13 shows the distribution patterns of the liquid loading in front of the bypass pig at three different gas pig relative velocities with a focus on the longitudinal and cross sections of the pipeline the liquid loading distribution during the pigging process has the following characteristics as the pig moves forward with pigging time increasing from fig 13 a to d the liquid gradually accumulates in front of the pig the cross sectional view at 20 mm downstream the pig exhibits that the distribution of the gas liquid interface gradually approaches the top of the pipe losing symmetry and becoming complicated under the same instant with the gas pig relative velocity v gr increasing from 0 5 m s to 2 0 m s attributed to the gas carrying effects on the downstream liquid phase the accumulation of the pigging induced liquid slug in front of the pig obviously slows down since the actual pig velocity of 5 m s in the model is larger than the downstream liquid movement speed of 3 m s under the circumstance when the gas pig relative velocity v gr remains small the force that the pig exerts on the liquid exceeds the gas carrying effects thereby the downstream fluid gradually accumulates in front of the pig causing the liquid holdup continues to increase however at a larger relative velocity v gr the gas carrying effect dominates over the pigging process which causes the downstream liquid to be distributed over longer distances in the pipeline therefore the liquid distribution pattern hinges on the balance between the force exerted by the pig on the liquid and the gas carrying effects on the downstream liquid when the two effects are equal the downstream liquid maintains a certain distribution pattern moving toward the end if the pig velocity is large enough to weaken the gas carrying effect the liquid will gradually accumulate the existence of the bypass structure in the pig reduces the force generated by the pig and meanwhile enhances the gas carrying effects thereby significantly reducing the liquid accumulation and promoting the dissipation of pig induced liquid slug 3 3 2 liquid volume fraction the variations of liquid volume fraction from 0 to 0 5 m downstream the pig are presented in fig 14 under the three gas pig relative velocities the liquid volume fractions still turn out to be increasing which indicates the accumulation of liquid slug in front of the pig while as the relative velocity v gr increases the growth trend slows down for instance when the v gr increases from 0 5 m s to 2 m s the corresponding liquid volume fraction at 1 2 s is reduced by 22 from 0 74 to 0 58 therefore more liquid loading can enter the terminal slug catcher in advance so as not to form the liquid slug reaching the terminal shortly with the pig which may cause overflow accidents the increase rate of liquid phase volume in each time interval shown in fig 15 is defined as the ratio of the liquid volume fraction difference to the corresponding time interval though the increase rate of liquid volume fraction slows down under a higher relative velocity v gr for each time interval the liquid volume fraction still increases with pigging time increasing which indicates that under the current condition pigging induced liquid slug is growing during the pigging operation hence to fully eliminate the pigging liquid slug it is necessary to continue increasing the relative velocity v gr between the gas and the pig for instance by increasing the gas flow rate or reducing the pig velocity by performing momentum balance analysis on the bypass pigging and ignoring the acceleration item the theoretical calculation of relative velocity can be obtained chen et al 2018 7 v g r v g v p i g φ f f r i c π 8 ρ b p k d 2 where v g is the gas flow rate m s v pig is the pig velocity m s φ is the bypass fraction f fric is the friction between pipe wall and pig disc n k is the pressure drop coefficient ρ bp is the gas density in the bypass port kg m3 d is the pipeline inner diameter m based on equation 7 the relative velocity v gr mainy depends on the pig structural parameters such as bypass fraction φ and friction force f fric or the pressure drop coefficient k thereby the increment of the parameters like the bypass fraction can serve the purpose of increasing the gas pig relative velocity thus further reducing pigging induced liquid slug now that the bypass fraction determines the driving force of the pig while the friction force constitutes the main movement resistance the key to the bypass pigging operation is to seek a balance between the bypass fraction and the friction force by changing the relative velocity various pigging scenarios in terms of different combinations of the bypass fraction and frictional force can be characterized therefore the cfd simulation study in this paper can promote the understanding of the dissipation mechanism regarding the pigging induced liquid slug 3 4 analysis of surge liquid volume 3 4 1 parametric analysis based on the surge liquid volume analytical model the parameters of liquid volume fraction α s pig velocity v pig and terminal liquid drain rate q drain will be thoroughly investigated regarding their influence on the surge liquid volume v surge 1 analysis of liquid volume fraction α s and liquid drain rate q drain take the derivative of equation 6 with respect to α s 8 v s u r g e α s a p i p e l p i p e q l v l i q u i d v p i g q l q d r a i n q l a p i p e α s v p i g 2 according to equation 8 when the liquid drain rate q drain in the slug catcher equals to the pipeline liquid outflow rate q l then v surge α s 0 indicating that the change in the liquid volume fraction exerts no effect on the surge volume which only depends on the pig velocity under the circumstance partly according to the practical pipeline and operating parameters of a natural gas field where l pipe 81500 m a pipe 0 203 m2 v liquid 829 5 m3 q l 0 021 m3 s equation 6 can be transformed to 9 v s u r g e 609 α s v p i g 3000 q d r a i n 79 v p i g 163 2 v p i g 29 α s v p i g 3 based on equation 9 with assuming the pig velocity v pig is maintained at 5 m s the effects of liquid volume fraction α s on surge volume v surge at different liquid drain rates q drain are illustrated in fig 16 with the liquid drain rate of q drain q l 0 021 m3 s as the dividing boundary the impacts of liquid volume fraction α s on surge volume exhibit two totally different variation trends when the q drain is smaller than 0 021 which corresponds to the pipeline liquid outflow rate q l the increase in α s reduces the amount of surge volume whereas if q drain is equal to q l the change of α s does not affect the surge volume however if q drain is greater than q l the increase in α s steps up the eventual surge liquid volume basically under the same liquid volume fraction a larger drain rate corresponds to a lower surge volume and the influence of drain rate is prominent under a low liquid volume fraction whilst becomes unnoticeable when α s approaches 1 the reasons for the aforementioned variations are presented in fig 17 which comprises three components in equation 1 namely pigging induced liquid slug volume α s a pipe l slug liquid drainage volume from the slug catcher t pig t slug q drain and the surge volume v surge the two parameters of α s a pipe l slug and t pig t slug q drain generally decrease with the liquid volume faction increasing while their decreasing rates are different at various drain rates when q drain q l the reduction of α s a pipe l slug dominates over the variations of surge volume causing the reduction of v surge fig 17 a while if q drain q l the impact of t pig t slug q drain overwhelms the reduction in α s a pipe l slug inducing an increase trend of surge volume fig 17 c under the circumstance of q drain q l the impacts of two parameters are sufficiently balanced leading to a constant v surge for varying liquid volume fractions fig 17 b by and large for traditional pigging the liquid volume fraction is approximate to 1 which leads to the limited effects for controlling the surge volume by the adjustment of liquid drain rate by contrast bypass pigging technology could effectively reduce the liquid volume fraction α s thereby the increase of drain rate by controlling the opening valves in the slug catcher will obviously decrease the surge volume and thus improve the liquid management ability during pigging operation 2 analysis of pig velocity v pig assuming the liquid volume fraction α s is maintained at 0 6 the influence of pig velocity on the surge volume at three different drain rates is illustrated in fig 18 which shows the surge volume decreases rapidly with the reduction of pig velocity since pig velocity reduction can significantly reduce the force of the pig exerted on the downstream liquid loading more liquid is capable of flowing out of the pipeline at the flow rate of q l before developing into the pigging induced liquid slug thereby the surge volume that needs to be temporarily stored at the terminal slug catcher is decreased accordingly the differences of surge volume at three drain rates are relatively slight in comparison to the effects of pig velocity which indicates that reducing pig velocity is the key strategy for controlling the terminal surge volume now that the pig velocity plays a dominant role in the terminal arriving liquid profile its controlling strategies in accordance with practical gas production rates are of great significance for the overall flow assurance of oil and gas fields in regard to practical bypass pigging operations the decision makings for pig velocity control and bypass structural optimization are governed by the equations 6 and 7 the relationship of which could be illustrated by the flowchart in fig 19 in order to secure a manageable liquid surge volume so as to avoid overflow accidents by considering the size of terminal liquid receivers together with the specific production information which includes the pipeline profiles and operational parameters the appropriate pig velocity could be theoretically determined based on equation 6 for a pigging operation according to the obtained proper pig velocity combined with the gas production rates the optimal bypass fraction of a pig can be technically decided by equation 7 to optimize the pig structure based on the optimized bypass pig prototype the arrival pigging induced liquid profile can be under effective management 3 4 2 liquid control strategy based on the aforementioned analyses on the surge liquid volume during pigging operation the liquid control strategies were proposed accordingly as follows 1 adopt bypass pigging technology with an appropriate bypass fraction the above analysis shows that the pig velocity is the main factor affecting the surge volume fig 18 thereby reducing the pig velocity can significantly decrease the amount of surge volume thus avoiding the overflow accident of the terminal slug catcher on the premise of not reducing the production output by using the bypass pigging technology with the optimal bypass fraction and meanwhile considering the size of terminal slug catcher the pig velocity can be reduced to the appropriate range to keep the surge volume within the processing capacity however a high bypass fraction may cause pig stagnation thereby the principle of bypass fraction optimization is to ensure that there is no risk of pig blockage and the surge liquid volume is well below the processing capacity 2 increase the terminal liquid drain rate the increase of liquid drain rate in the terminal slug catcher can reduce the surge volume fig 16 the effectiveness of which is more prominent under a small range of liquid volume fractions therefore the surge volume can be effectively reduced by combining bypass pigging technology to reduce the liquid volume fraction and meanwhile appropriately increasing the valve opening degree in terminal slug catchers the above two methods may act in tandem for effective control of outflow liquid during pigging operation 3 reduce the volume of liquid loading before pigging operation according to equation 6 decreasing the volume of liquid loading in the pipeline before pigging operation could also help reduce the surge volume to a certain extent hence appropriately increasing gas flow rates to discharge more liquid out of the pipeline is conducive to the control of pigging induced outflow liquid 4 conclusion the paper firstly conducted an indoor gas liquid two phase bypass pigging experiment to investigate the characteristics of the pigging induced liquid flow and analyze the effects of bypass fractions on the amelioration of liquid outflow profile then a cfd model was developed to simulate the liquid distribution pattern during bypass pigging process and meanwhile the downstream liquid volume fraction was analyzed to illustrate the mechanism of bypass pigging in eliminating the pigging induced liquid volume furthermore a surge liquid volume analytical model was established to conduct parametric analysis on factors that exert impacts on terminal surge volume based on which liquid control strategies were proposed accordingly the main conclusions are drawn as below 1 experimental pressure analyses show that for pigging operation without bypass structure the terminal pipeline pressure shows an obviously repetitive oscillation phenomenon due to the accumulation of liquid loading in front of the pig while after introducing the bypass fraction the pressure oscillation amplitude is significantly lowered therefore a suitable bypass fraction is advantageous for eliminating the pressure fluctuation and thus achieving a smoother pigging operation 2 analyses on experimental pigging induced liquid outflow rates indicate that the increase in bypass fraction can significantly reduce the outflow liquid rates by decreasing the force of pig exerting on the downstream liquid loading for instance the reduction rate of over 40 could be potentially achieved by using a pig with the bypass fraction of 1 under varying liquid loading existing in the pipe such great reduction amplitudes could significantly contribute to a safer and more efficient engineering operation combined with the enhanced gas carrying effect a more manageable arrival liquid profile could be achieved 3 the cfd simulation shows that the liquid distribution pattern downstream the pig hinges on the balance between the force of the pig exerting on the liquid and the gas carrying effects when the two effects are equivalent the front liquid maintains a certain distribution pattern moving toward the terminal the existence of the bypass structure in the pig reduces the force generated by the pig and meanwhile enhances the gas carrying effects thereby significantly reducing the liquid accumulation and promoting the dissipation of pig induced liquid slug 4 the parametric analyses based on the surge volume analytical model show that the effect of the liquid volume fraction on surge volume is highly related to the liquid drain rate in the terminal slug catcher now that the influence of drain rate is prominent under a low liquid volume fraction increasing drain rate of the slug catcher can effectively act in tandem with bypass pigging operation for the liquid management by contrast pig velocity plays a dominant role in the reduction of pigging induced surge volume the liquid outflow during pigging operation could be effectively controlled by combining bypass pigging technology with optimal bypass fraction and meanwhile appropriately increasing the terminal liquid drain rate 5 the study combined experiments and modelling to shed light on the promising prospects of utilizing bypass pigging technology in oil and gas fields to ameliorate the pigging induced pressure oscillation and the liquid outflow profile towards a more easily manageable level the results exhibit the fact that the utilization of bypass pig is capable of significantly improving the flow assurance during pigging operation for instance the terminal liquid outflow rate is reduced by 75 when bypass fraction increases from 0 to 2 achieving a more manageable and controllable liquid arrival profile additionally now that the pig velocity was found to be the dominant factor from the parametric study for the control of surge liquid volume the corresponding method for determining the appropriate pig velocity was proposed based on the surge volume analytical model to this end the pig structural optimization in terms of the bypass fraction was also discussed to satisfy the need for pig velocity control and thus liquid management the relevant results could provide solid guidance for the oil and gas industry to guarantee a safe and efficient flow assurance during pigging operation credit authorship contribution statement jianheng chen conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing limin he conceptualization resources supervision project administration visualization funding acquisition xiaoming luo conceptualization resources supervision project administration visualization lin lu writing review editing formal analysis hailong zhang investigation formal analysis xiaowei li validation investigation haixiao liu validation investigation songtao he validation investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national science and technology major project of the ministry of science and technology of china grant number 2016zx05028 004 003 nomenclature d inner diameter of pipeline m l pig length m d 1 inner diameter 1 of bypass port m d 2 inner diameter 2 of bypass port m δt time step s t running time in the cfd model v g gas flow rate m s v pig pig velocity m s v pipe pipe wall velocity m s v l downstream liquid velocity m s v gr relative velocity between gas flow rate and pig velocity m s p outlet pressure pa v surge surge liquid volume m3 v liquid total liquid loading in the pipeline m3 α s liquid volume fraction in the pigging induced liquid slug a pipe pipeline sectional area m2 l slug length of pigging induced liquid slug m l pipe length of pipeline m t pig pig running time s t slug time when the front of pigging induced slug arrives at the end of the pipeline s q drain liquid drain rate in the terminal slug catcher m3 s q l pipeline liquid outflow rate before the front of pigging induced slug reaches the end m3 s φ bypass fraction f fric friction between pipe wall and pig disc n k pressure drop coefficient ρ bp gas density in the bypass port kg m3 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 106974 
22112,liquid overflow accident during pigging operation in offshore oil and gas field inevitably leads to production loss and deferment which could be effectively addressed by applying bypass pigging technology aiming to analyze amelioration effects of pigging induced liquid flow through bypass pigging the paper first conducted a gas liquid two phase bypass pigging experiment then developed a cfd bypass pigging model to investigate the downstream liquid slug dissipation mechanism furthermore a surge liquid volume analytical model was established to conduct parametric analysis the results show that bypass pigging could ameliorate pigging induced liquid accumulation achieving a much smaller terminal pressure oscillation attributed to the gas liquid carrying effect the increase in bypass fraction from 0 to 2 reduces liquid outflow rate up to 75 achieving a more manageable liquid arrival profile downstream liquid slug dissipation hinges on the balance between force of the pig exerting on the liquid and gas carrying effects which could be effectively enhanced by an increased gas liquid relative velocity pig velocity dominates the surge volume by combining bypass pigging technology and increasing liquid drain rate the liquid overflow accident could be potentially avoided the study lays a solid foundation for the advancement of bypass pigging technology in offshore oil and gas fields keywords bypass pigging pigging induced liquid flow cfd model surge volume parametric analysis 1 introduction in the middle and late stages of oil and gas fields especially for natural gas condensate pipelines operational problems such as serious liquid loading increased gas liquid frictional resistance and complicated gas liquid flow issues are frequently encountered ayala and adewumi 2003 davoudi et al 2014 jamshidi and sarkari 2016 onuoha et al 2018 xu and gong 2005 zhu et al 2018 which seriously affect the normal production to this end it is necessary to carry out pigging operations on a regular basis which is an important flow assurance strategy for pipeline maintenance so as to safeguard and improve its transportation capacities as well as production efficiencies groote et al 2015 olaniyan and larrey 2014 van spronsen et al 2013 wu and van spronsen 2005 with oil and gas exploration moving towards deep water areas the corresponding high pressure and low temperature environment as well as increasingly complex underwater pipeline system tend to produce more liquid loading which may even develop into natural gas hydrate deposited in pipes joshi et al 2013 pedersen et al 2017 xing et al 2014 xing et al 2013a b zerpa et al 2012 therefore higher pigging requirements are entailed to secure a safe operation pig velocity basically determines the achievable effects of pigging operation groote et al 2015 thereby velocity control strategy is of great significance to ensure an efficient pigging operation mirshamsi and rafeeyan 2012 money et al 2012 nguyen et al 2001a 2001b zhu et al 2014 the optimal pigging effect can be achieved by maintaining a constant pig velocity in the range of 2 m s to 7 m s for natural gas pipeline money et al 2012 nguyen et al 2001b the traditional pigging operation remains the same pig velocity as the rear driving gas flow rate which often exerts excessive force on the downstream liquid loading inducing the liquid accumulation in front of the pig the gradually accumulated liquid may develop into an unmanageable liquid slug upon its arrival at terminals thus causing overflow accidents due to the limited size of slug catchers in comparison to traditional pigging process bypass pigging operation fig 1 could possibly reduce the liquid accumulation by gas liquid carrying effects through a bypass port thus eliminating pig generated slugs due to the existence of the bypass structure pig velocity can be significantly reduced which may be of great benefits to the oil and gas production van spronsen et al 2013 the research in bypass pigging has aroused increasing attentions in recent years with its positive benefits being broadly reported on engineering applications entaban et al 2013 groote et al 2015 lee et al 2012 money et al 2012 olaniyan and larrey 2014 park et al 2016 van spronsen et al 2013 wu and van spronsen 2005 detailed indoor bypass pigging experiments were conducted by chen et al 2018 2020 to illustrate the bypass pig movement characteristics with a focus on pig velocity reduction hendrix et al azpiroz et al 2015 hendrix et al 2017 singh and henkes 2012 studied the pressure drop coefficient through bypass pigs based on a cfd model which is an important structural parameter governing the pig movement a simplified 1d model has been recently proposed and validated to describe the oscillatory pig movements in order for designing a controller to minimize pig oscillations hendrix et al 2018 by and large there is still a deficiency of detailed research on the flow characteristics of downstream liquid slug dissipation mechanism and pigging induced liquid outflow profile that is required to be temporarily stored in terminal slug catchers therefore to fill the gap the paper firstly conducted a gas liquid two phase bypass pigging experiment based on a transparent horizontal pipe system to characterize the pressure variations and terminal pigging induced liquid outflow rates then a cfd bypass pigging model was developed to simulate the downstream liquid distribution patterns and liquid volume fractions furthermore a surge liquid volume analytical model was established to conduct parametric analysis the study elucidates in detail the mechanism of bypass pigging technology in amelioration of pigging induced liquid flow which is of great significance to promote bypass pigging application 2 research methodology 2 1 experimental system 2 1 1 horizontal pipeline system the experimental system with transparent horizontal pigging segment is shown in fig 2 with its physical map illustrated in fig 3 in order to visualize the entire process of the pig movement the pipeline was made of transparent plexiglass tube with an inner diameter of 64 mm and a total length of 15 814 m of which the measurement segment between pressure sensors of p1 and p8 is 15 164 m nine pressure sensors of keller pr25y with an accuracy of 0 25 to record the pigging induced pressure variations were placed along the pipeline three high speed video cameras were used to film pigs movement in the terminal a liquid receiver equipped with a differential pressure sensor with an accuracy of 0 25 and a liquidometer with an accuracy of 5 mm was placed to record the liquid outflow profile since the differential pressure sensor turned out to be more sensitive to the varying outflow liquid rates the corresponding data were used for following analyses and the arriving liquid information from the liquidometer was also utilized as an important reference so as to guarantee more accurate results the operational procedures include the gas adjustment and measurement the preparation of bypass pig prototype the liquid injection pigging operation and data acquisition the air which was adopted as the gas medium was pressurized through a compressor and then stored in a buffer tank to achieve pressure stabilization then the stabilized and filtered air entered into the pipeline system after a precise gas flow rates adjustment and measurement by a vortex flow meter with a maximum error of 1 a pressure and a temperature sensor were placed beside the vortex flow meter to record the real time data which would be used for gas flow rate conversion to the position of the pipeline starting point after the completion of gas flow rates adjustment the bypass pig prototype with the selected bypass fraction was put into the pig launcher for pigging preparation then the measured liquid volume was injected into the pipeline through the liquid inlet port which was followed by introducing the driving gas into the pipeline system for pigging operation the national instruments corporation based labview program was utilized as the data acquisition system 2 1 2 bypass pig prototype the structure of the experimental bypass pig prototype is shown in fig 4 with the physical map presented in fig 5 the newly developed bypass pig prototype is equipped with an internal spring based regulating valve which can adjust the size of bypass port and thereby control the volume of bypass gas to regulate the pig velocity acting in tandem with the regulating unit the bypass nozzle is used to control the bypass fraction which is defined as the ratio of the minimum sectional area of the bypass port to the pipeline sectional area the adopted bypass fraction and corresponding bypass port diameter are illustrated in table 1 the dimensions of sealing and spacing discs table 2 are responsible for comprising pig interference and clamping rate respectively the parameters of which are highly related to the pig friction now that all the mechanical components of the pig prototype can be easily assembled multiple pig prototypes can be obtained for instance the prototypes under different bypass fractions with or without internal spring based regulating unit in this paper we mainly focus on the effects of bypass fraction on the pigging induced liquid outflow profile therefore the internal regulating units were removed from the bypass pig prototype leaving only the bypass nozzle to adjust the bypass fraction 2 2 bypass pigging cfd model development 2 2 1 geometric model and mesh generation the gas liquid two phase bypass pigging geometric model was developed based on the same type of the experimental bypass pig prototype without inner regulating units as presented in fig 6 where the three dimensional structural grids were utilized for mesh generation figs 6 and 7 the development of this model is based on the assumption that forces acting on the pig are well balanced and thus the pig moves at a constant speed under an equilibrium state for the purpose of focusing on the downstream liquid movement the pig is considered as a reference system that remains stationary whilst the pipe walls and liquid loading move in opposite directions relative to the pig velocity liang 2015 singh and henkes 2012 in order to make the fluid flow around the pig fully developed the length of the pipeline in front of the pig was set as 30d meanwhile for saving computing resources the inlet gas flow rate distribution was defined by udf to obtain a fully distributed gas velocity thereby the length of the inlet section was reduced to 5d 2 2 2 boundary condition regarding the adopted medium in the model water and air were defined as the liquid and gas respectively the boundary of velocity inlet and pressure outlet were considered for the air phase simulation where the pressure outlet was set as 0 with reference to the local atmospheric pressure in terms of the water phase the actual liquid outlet boundary as illustrated in fig 6 was assumed to be the liquid velocity inlet with respect to the stationary pig reference system the specific parameters taken relatively to the stationary pig velocity are presented as follows ① inlet gas velocity v g v pig ② pipe wall velocity v pig ③ liquid flow velocity v l v pig regarding the option of calculation models the vof model was employed due to the focus on the gas liquid interface additionally the realizable k ε model and standard wall function were set as the turbulence model and wall condition respectively the effectiveness of which were verified by singh et al singh and henkes 2012 meanwhile the third order quick algorithm was used for the calculation of momentum equation so as to achieve high accurate results 2 2 3 model independence evaluation in order to ensure that the simulation results are independent of the modelling mesh size and time step the mesh numbers of 1141140 mesh 1 and 2114562 mesh 2 and time steps of 0 0001 s and 0 001 s were comparatively investigated with the results presented in fig 8 where the variations of water phase fraction along the central axis were employed for analysis since only gas exists in the rear of the bypass pig the water phase fraction begins from 0 and then abruptly increases to 1 as the axis distance increases the liquid phase is being carried away by the gas exceeding the center height at the position downstream the pig the distances with the water phase fraction returning to 0 correspond to the zones where liquid is not yet affected by the gas phase the comparative results generally exhibit a good agreement between two adopted dimensions which indicate that the simulation results are independent of the selected mesh size and time step thus the eventual mesh number and time step were adopted as 1141140 and 0 001 s respectively 2 3 surge liquid volume analytical model establishment in the oil and gas field the pigging operational efficiency and size design of terminal slug catcher are highly related to the liquid outflow profile during pigging operation hence in order to analyze the pigging induced liquid volume which is required to be temporarily stored in the terminal slug catcher denoted as surge volume v surge based on the equilibrium of total liquid volume flowing into stored in and out of the slug catcher the amount of surge volume v surge can be calculated by groote et al 2015 1 v s u r g e α s a p i p e l s l u g t p i g t s l u g q d r a i n here α s is the liquid volume fraction in the pigging induced liquid slug a pipe is the pipeline sectional area m2 l slug is the length of the pigging induced liquid slug m t pig is the pig running time through the whole pipeline s t slug is the time when the front of pigging induced liquid slug arrives at the end of the pipeline s q drain is the liquid drain rate in the terminal slug catcher m3 s the total liquid loading v liquid before pigging operation is 2 v l i q u i d t s l u g q l α s a p i p e l s l u g here q l is the liquid outflow rate from the pipeline into the slug catcher before the front of pigging induced liquid slug reaches the end of pipeline m3 s the length of pigging induced liquid slug l slug can be calculated as 3 l s l u g l p i p e v p i g t s l u g where l pipe is the length of pipeline m based on equations 2 and 3 the time of t slug can be expressed as 4 t s l u g α s l p i p e a p i p e v l i q u i d α s v p i g a p i p e q l pig running time t pig is 5 t p i g l p i p e v p i g combining equations 3 5 into equation 1 the surge volume v surge can be obtained as 6 v s u r g e v l i q u i d v p i g l p i p e q l q d r a i n a p i p e α s v p i g q l a p i p e α s v p i g v p i g according to equation 6 for a specific oil and gas field if the parameters of total liquid loading v liquid length of pipeline l pipe liquid outflow rate q l pipeline sectional area a pipe are obtained the surge volume v surge is dependent on the liquid volume fraction α s pig velocity v pig and the terminal drain rate q drain bypass pigging operation could effectively reduce the liquid volume fraction α s and pig velocity v pig thereby exerting significant impacts on the surge volume 3 results and discussion 3 1 pressure variations along pipeline large pressure oscillations threaten the safety of pigging operations therefore understanding the pressure variations along the pipeline will be necessary for assessing pigging performance fig 9 shows the experimental results of pressure variations caused by traditional pigging without bypass fraction along the pipeline as the pig passes through the pipeline the pressure at each point rises in turn since the pressure drop of the gas behind the pig is negligible each pressure curve almost overlaps with the back one until the pig is suddenly released after reaching the end now that the downstream liquid flow contacts the corresponding positions ahead of the pig the pressure curves from p2 to p7 are shown with multi stage rising distributions owing to the absence of the bypass structure and the lack of gas carrying effects the downstream liquid gradually accumulates at the end of the pipeline hindering the pig movement and causing p8 to oscillate back and forth until all the liquid loading is eliminated pressure fluctuations of p8 at various liquid volumes are illustrated in fig 10 in the absence of a bypass fraction fig 10 a as the liquid volume increases the oscillatory phenomena of p8 significantly become more obvious especially for the liquid volume of 14 0 l 17 5 l and 20 9 l this indicates that traditional pigging is not suitable for pipes with high liquid loading profile when a greater driving force is applied to the system by increasing the gas flow rates fig 10 b the terminal oscillatory phenomena of p8 are ameliorated but the system average pressures are increased accordingly with positive pressure differences as shown in fig 10 d when the bypass fraction is increased to 2 fig 10 c the terminal pressure oscillation amplitudes are significantly reduced and compared with the case without bypass fraction the related average pressure values are relatively small causing negative pressure differences between bypass fractions of 2 and 0 fig 10 d the results elucidate that bypass pigging is capable of eliminating the accumulation of downstream liquid through bypass gas carrying effects and thus is more conducive to the pipeline conditions with high liquid loading profile if the bypass fraction is appropriately increased a smoother pressure variation can be achieved during the pigging operation 3 2 characteristics of liquid outflow profile the profile of the liquid reaching the receiving device is essential for assessing the safety and effectiveness of the pigging operation which requires that the outflow liquid caused by pigging must be fully controlled within the capacity of the existing liquid receiver to this end detailed analysis of the characteristics of liquid outflow prolife was conducted by considering different operating and pig structural parameters so as to demonstrate the potential of bypass pigging in terms of improving the liquid profile and addressing overflow accidents that may occur during pigging operations the terminal liquid outflow profiles at three bypass fractions are presented in fig 11 under the same volume of liquid loading of 14 l as bypass fraction increases more time is entailed to reach the same liquid level thus the increase in bypass fraction mainly contributes to the extension of outflow liquid which is caused by the prolonged pigging time specifically when bypass fraction is increased from 0 to 2 at the gas flow rate of 8 m s the reduction of the liquid outflow rate is as high as 75 decreasing from 4 8 cm s to 1 2 cm s which turns out to be 56 7 at the gas flow rate of 9 m s fig 11 c therefore due to the gas liquid carrying effects and the extended liquid outflow time the increase in bypass fraction can significantly reduce the liquid outflow rate and thus obtaining a more manageable liquid profile the outflow liquid variations under several volumes of liquid loading are illustrated in fig 12 where a larger liquid volume corresponds to a higher liquid level and a greater liquid outflow rate arriving at the terminal liquid receiver in comparison to the pig without bypass fraction the pig with bypass fraction of 1 promisingly reduces the liquid outflow rates by 47 6 38 4 43 5 45 1 and 40 4 for conditions with liquid loading of 6 3 l 10 4 l 14 0 l 17 5 l and 20 9 l respectively such great reduction amplitudes could significantly contribute to a safer and more efficient engineering operation the benefits of bypass pigging in handling the liquid loading are projected to be possibly larger under a higher bypass fraction the results exhibit a good adaptability of bypass pigging to variations of liquid loading in the pipeline system therefore a great potential of bypass pigging in controlling the terminal liquid volume could be achieved 3 3 pigging induced liquid movement the effect of bypass pigging depends on the relative velocity between the rear driving gas and the pig when the pig velocity keeps the same as the rear driving gas flow rate it is equivalent to traditional pigging with no bypass gas passing through the pig in this case a large amount of downstream liquid may accumulate in front of the pig as the relative velocity between the gas and the pig increases more gas can enter into the downstream pipe through the bypass port thereby further dispersing the downstream liquid and reducing the accumulation of liquid in front of the pig this pigging situation corresponds to the bypass pigging process higher relative velocities equal to larger bypass fractions therefore the modelling approach mainly considered the different relative velocities between the gas and the pig to represent various bypass pigging conditions the details of which are shown in table 3 3 3 1 liquid distribution pattern fig 13 shows the distribution patterns of the liquid loading in front of the bypass pig at three different gas pig relative velocities with a focus on the longitudinal and cross sections of the pipeline the liquid loading distribution during the pigging process has the following characteristics as the pig moves forward with pigging time increasing from fig 13 a to d the liquid gradually accumulates in front of the pig the cross sectional view at 20 mm downstream the pig exhibits that the distribution of the gas liquid interface gradually approaches the top of the pipe losing symmetry and becoming complicated under the same instant with the gas pig relative velocity v gr increasing from 0 5 m s to 2 0 m s attributed to the gas carrying effects on the downstream liquid phase the accumulation of the pigging induced liquid slug in front of the pig obviously slows down since the actual pig velocity of 5 m s in the model is larger than the downstream liquid movement speed of 3 m s under the circumstance when the gas pig relative velocity v gr remains small the force that the pig exerts on the liquid exceeds the gas carrying effects thereby the downstream fluid gradually accumulates in front of the pig causing the liquid holdup continues to increase however at a larger relative velocity v gr the gas carrying effect dominates over the pigging process which causes the downstream liquid to be distributed over longer distances in the pipeline therefore the liquid distribution pattern hinges on the balance between the force exerted by the pig on the liquid and the gas carrying effects on the downstream liquid when the two effects are equal the downstream liquid maintains a certain distribution pattern moving toward the end if the pig velocity is large enough to weaken the gas carrying effect the liquid will gradually accumulate the existence of the bypass structure in the pig reduces the force generated by the pig and meanwhile enhances the gas carrying effects thereby significantly reducing the liquid accumulation and promoting the dissipation of pig induced liquid slug 3 3 2 liquid volume fraction the variations of liquid volume fraction from 0 to 0 5 m downstream the pig are presented in fig 14 under the three gas pig relative velocities the liquid volume fractions still turn out to be increasing which indicates the accumulation of liquid slug in front of the pig while as the relative velocity v gr increases the growth trend slows down for instance when the v gr increases from 0 5 m s to 2 m s the corresponding liquid volume fraction at 1 2 s is reduced by 22 from 0 74 to 0 58 therefore more liquid loading can enter the terminal slug catcher in advance so as not to form the liquid slug reaching the terminal shortly with the pig which may cause overflow accidents the increase rate of liquid phase volume in each time interval shown in fig 15 is defined as the ratio of the liquid volume fraction difference to the corresponding time interval though the increase rate of liquid volume fraction slows down under a higher relative velocity v gr for each time interval the liquid volume fraction still increases with pigging time increasing which indicates that under the current condition pigging induced liquid slug is growing during the pigging operation hence to fully eliminate the pigging liquid slug it is necessary to continue increasing the relative velocity v gr between the gas and the pig for instance by increasing the gas flow rate or reducing the pig velocity by performing momentum balance analysis on the bypass pigging and ignoring the acceleration item the theoretical calculation of relative velocity can be obtained chen et al 2018 7 v g r v g v p i g φ f f r i c π 8 ρ b p k d 2 where v g is the gas flow rate m s v pig is the pig velocity m s φ is the bypass fraction f fric is the friction between pipe wall and pig disc n k is the pressure drop coefficient ρ bp is the gas density in the bypass port kg m3 d is the pipeline inner diameter m based on equation 7 the relative velocity v gr mainy depends on the pig structural parameters such as bypass fraction φ and friction force f fric or the pressure drop coefficient k thereby the increment of the parameters like the bypass fraction can serve the purpose of increasing the gas pig relative velocity thus further reducing pigging induced liquid slug now that the bypass fraction determines the driving force of the pig while the friction force constitutes the main movement resistance the key to the bypass pigging operation is to seek a balance between the bypass fraction and the friction force by changing the relative velocity various pigging scenarios in terms of different combinations of the bypass fraction and frictional force can be characterized therefore the cfd simulation study in this paper can promote the understanding of the dissipation mechanism regarding the pigging induced liquid slug 3 4 analysis of surge liquid volume 3 4 1 parametric analysis based on the surge liquid volume analytical model the parameters of liquid volume fraction α s pig velocity v pig and terminal liquid drain rate q drain will be thoroughly investigated regarding their influence on the surge liquid volume v surge 1 analysis of liquid volume fraction α s and liquid drain rate q drain take the derivative of equation 6 with respect to α s 8 v s u r g e α s a p i p e l p i p e q l v l i q u i d v p i g q l q d r a i n q l a p i p e α s v p i g 2 according to equation 8 when the liquid drain rate q drain in the slug catcher equals to the pipeline liquid outflow rate q l then v surge α s 0 indicating that the change in the liquid volume fraction exerts no effect on the surge volume which only depends on the pig velocity under the circumstance partly according to the practical pipeline and operating parameters of a natural gas field where l pipe 81500 m a pipe 0 203 m2 v liquid 829 5 m3 q l 0 021 m3 s equation 6 can be transformed to 9 v s u r g e 609 α s v p i g 3000 q d r a i n 79 v p i g 163 2 v p i g 29 α s v p i g 3 based on equation 9 with assuming the pig velocity v pig is maintained at 5 m s the effects of liquid volume fraction α s on surge volume v surge at different liquid drain rates q drain are illustrated in fig 16 with the liquid drain rate of q drain q l 0 021 m3 s as the dividing boundary the impacts of liquid volume fraction α s on surge volume exhibit two totally different variation trends when the q drain is smaller than 0 021 which corresponds to the pipeline liquid outflow rate q l the increase in α s reduces the amount of surge volume whereas if q drain is equal to q l the change of α s does not affect the surge volume however if q drain is greater than q l the increase in α s steps up the eventual surge liquid volume basically under the same liquid volume fraction a larger drain rate corresponds to a lower surge volume and the influence of drain rate is prominent under a low liquid volume fraction whilst becomes unnoticeable when α s approaches 1 the reasons for the aforementioned variations are presented in fig 17 which comprises three components in equation 1 namely pigging induced liquid slug volume α s a pipe l slug liquid drainage volume from the slug catcher t pig t slug q drain and the surge volume v surge the two parameters of α s a pipe l slug and t pig t slug q drain generally decrease with the liquid volume faction increasing while their decreasing rates are different at various drain rates when q drain q l the reduction of α s a pipe l slug dominates over the variations of surge volume causing the reduction of v surge fig 17 a while if q drain q l the impact of t pig t slug q drain overwhelms the reduction in α s a pipe l slug inducing an increase trend of surge volume fig 17 c under the circumstance of q drain q l the impacts of two parameters are sufficiently balanced leading to a constant v surge for varying liquid volume fractions fig 17 b by and large for traditional pigging the liquid volume fraction is approximate to 1 which leads to the limited effects for controlling the surge volume by the adjustment of liquid drain rate by contrast bypass pigging technology could effectively reduce the liquid volume fraction α s thereby the increase of drain rate by controlling the opening valves in the slug catcher will obviously decrease the surge volume and thus improve the liquid management ability during pigging operation 2 analysis of pig velocity v pig assuming the liquid volume fraction α s is maintained at 0 6 the influence of pig velocity on the surge volume at three different drain rates is illustrated in fig 18 which shows the surge volume decreases rapidly with the reduction of pig velocity since pig velocity reduction can significantly reduce the force of the pig exerted on the downstream liquid loading more liquid is capable of flowing out of the pipeline at the flow rate of q l before developing into the pigging induced liquid slug thereby the surge volume that needs to be temporarily stored at the terminal slug catcher is decreased accordingly the differences of surge volume at three drain rates are relatively slight in comparison to the effects of pig velocity which indicates that reducing pig velocity is the key strategy for controlling the terminal surge volume now that the pig velocity plays a dominant role in the terminal arriving liquid profile its controlling strategies in accordance with practical gas production rates are of great significance for the overall flow assurance of oil and gas fields in regard to practical bypass pigging operations the decision makings for pig velocity control and bypass structural optimization are governed by the equations 6 and 7 the relationship of which could be illustrated by the flowchart in fig 19 in order to secure a manageable liquid surge volume so as to avoid overflow accidents by considering the size of terminal liquid receivers together with the specific production information which includes the pipeline profiles and operational parameters the appropriate pig velocity could be theoretically determined based on equation 6 for a pigging operation according to the obtained proper pig velocity combined with the gas production rates the optimal bypass fraction of a pig can be technically decided by equation 7 to optimize the pig structure based on the optimized bypass pig prototype the arrival pigging induced liquid profile can be under effective management 3 4 2 liquid control strategy based on the aforementioned analyses on the surge liquid volume during pigging operation the liquid control strategies were proposed accordingly as follows 1 adopt bypass pigging technology with an appropriate bypass fraction the above analysis shows that the pig velocity is the main factor affecting the surge volume fig 18 thereby reducing the pig velocity can significantly decrease the amount of surge volume thus avoiding the overflow accident of the terminal slug catcher on the premise of not reducing the production output by using the bypass pigging technology with the optimal bypass fraction and meanwhile considering the size of terminal slug catcher the pig velocity can be reduced to the appropriate range to keep the surge volume within the processing capacity however a high bypass fraction may cause pig stagnation thereby the principle of bypass fraction optimization is to ensure that there is no risk of pig blockage and the surge liquid volume is well below the processing capacity 2 increase the terminal liquid drain rate the increase of liquid drain rate in the terminal slug catcher can reduce the surge volume fig 16 the effectiveness of which is more prominent under a small range of liquid volume fractions therefore the surge volume can be effectively reduced by combining bypass pigging technology to reduce the liquid volume fraction and meanwhile appropriately increasing the valve opening degree in terminal slug catchers the above two methods may act in tandem for effective control of outflow liquid during pigging operation 3 reduce the volume of liquid loading before pigging operation according to equation 6 decreasing the volume of liquid loading in the pipeline before pigging operation could also help reduce the surge volume to a certain extent hence appropriately increasing gas flow rates to discharge more liquid out of the pipeline is conducive to the control of pigging induced outflow liquid 4 conclusion the paper firstly conducted an indoor gas liquid two phase bypass pigging experiment to investigate the characteristics of the pigging induced liquid flow and analyze the effects of bypass fractions on the amelioration of liquid outflow profile then a cfd model was developed to simulate the liquid distribution pattern during bypass pigging process and meanwhile the downstream liquid volume fraction was analyzed to illustrate the mechanism of bypass pigging in eliminating the pigging induced liquid volume furthermore a surge liquid volume analytical model was established to conduct parametric analysis on factors that exert impacts on terminal surge volume based on which liquid control strategies were proposed accordingly the main conclusions are drawn as below 1 experimental pressure analyses show that for pigging operation without bypass structure the terminal pipeline pressure shows an obviously repetitive oscillation phenomenon due to the accumulation of liquid loading in front of the pig while after introducing the bypass fraction the pressure oscillation amplitude is significantly lowered therefore a suitable bypass fraction is advantageous for eliminating the pressure fluctuation and thus achieving a smoother pigging operation 2 analyses on experimental pigging induced liquid outflow rates indicate that the increase in bypass fraction can significantly reduce the outflow liquid rates by decreasing the force of pig exerting on the downstream liquid loading for instance the reduction rate of over 40 could be potentially achieved by using a pig with the bypass fraction of 1 under varying liquid loading existing in the pipe such great reduction amplitudes could significantly contribute to a safer and more efficient engineering operation combined with the enhanced gas carrying effect a more manageable arrival liquid profile could be achieved 3 the cfd simulation shows that the liquid distribution pattern downstream the pig hinges on the balance between the force of the pig exerting on the liquid and the gas carrying effects when the two effects are equivalent the front liquid maintains a certain distribution pattern moving toward the terminal the existence of the bypass structure in the pig reduces the force generated by the pig and meanwhile enhances the gas carrying effects thereby significantly reducing the liquid accumulation and promoting the dissipation of pig induced liquid slug 4 the parametric analyses based on the surge volume analytical model show that the effect of the liquid volume fraction on surge volume is highly related to the liquid drain rate in the terminal slug catcher now that the influence of drain rate is prominent under a low liquid volume fraction increasing drain rate of the slug catcher can effectively act in tandem with bypass pigging operation for the liquid management by contrast pig velocity plays a dominant role in the reduction of pigging induced surge volume the liquid outflow during pigging operation could be effectively controlled by combining bypass pigging technology with optimal bypass fraction and meanwhile appropriately increasing the terminal liquid drain rate 5 the study combined experiments and modelling to shed light on the promising prospects of utilizing bypass pigging technology in oil and gas fields to ameliorate the pigging induced pressure oscillation and the liquid outflow profile towards a more easily manageable level the results exhibit the fact that the utilization of bypass pig is capable of significantly improving the flow assurance during pigging operation for instance the terminal liquid outflow rate is reduced by 75 when bypass fraction increases from 0 to 2 achieving a more manageable and controllable liquid arrival profile additionally now that the pig velocity was found to be the dominant factor from the parametric study for the control of surge liquid volume the corresponding method for determining the appropriate pig velocity was proposed based on the surge volume analytical model to this end the pig structural optimization in terms of the bypass fraction was also discussed to satisfy the need for pig velocity control and thus liquid management the relevant results could provide solid guidance for the oil and gas industry to guarantee a safe and efficient flow assurance during pigging operation credit authorship contribution statement jianheng chen conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing limin he conceptualization resources supervision project administration visualization funding acquisition xiaoming luo conceptualization resources supervision project administration visualization lin lu writing review editing formal analysis hailong zhang investigation formal analysis xiaowei li validation investigation haixiao liu validation investigation songtao he validation investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national science and technology major project of the ministry of science and technology of china grant number 2016zx05028 004 003 nomenclature d inner diameter of pipeline m l pig length m d 1 inner diameter 1 of bypass port m d 2 inner diameter 2 of bypass port m δt time step s t running time in the cfd model v g gas flow rate m s v pig pig velocity m s v pipe pipe wall velocity m s v l downstream liquid velocity m s v gr relative velocity between gas flow rate and pig velocity m s p outlet pressure pa v surge surge liquid volume m3 v liquid total liquid loading in the pipeline m3 α s liquid volume fraction in the pigging induced liquid slug a pipe pipeline sectional area m2 l slug length of pigging induced liquid slug m l pipe length of pipeline m t pig pig running time s t slug time when the front of pigging induced slug arrives at the end of the pipeline s q drain liquid drain rate in the terminal slug catcher m3 s q l pipeline liquid outflow rate before the front of pigging induced slug reaches the end m3 s φ bypass fraction f fric friction between pipe wall and pig disc n k pressure drop coefficient ρ bp gas density in the bypass port kg m3 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 106974 
22113,based on potential fluid theory and soil model theory this paper derived a simplified mechanical model for horizontal storage tanks considering soil tank liquid interaction stli which can be used for seismic design of horizontal storage tanks then the paper studied the ground motion response of stli and non stli under different shear wave velocity we find the seismic response of the horizontal storage tank is more severe after considering the stli and the main control targets such as the base shear force overturning bending moment and sloshing wave height increase by 25 58 moreover the effects of soft and medium soft fields are more significant keywords soil tank liquid interaction horizontal storage tank potential fluid theory soil model simplified mechanical model 1 introduction horizontal storage tanks are important storage equipment in the petrochemical industry and are commonly used to store flammable and explosive chemical products once the horizontal storage tank encounters an earthquake and is damaged it may cause serious secondary disasters such as fires and explosions for example on june 16 1964 a magnitude 7 4 earthquake occurred in niigata japan which damaged storage tanks in a local refinery and caused a fire the fire of the oil storage tank quickly spread to the entire oil tank area and adjacent factories new fires and explosions occurred in the factory becoming the second source of fire which in turn triggered a larger fire the entire site of the niigata refinery was in ruins more than 80 tanks were scrapped killing more than 500 people and destroying 75 of gas pipelines and 11 substations therefore it is especially important to study the dynamic response of horizontal storage tanks under ground motion and the seismic design method the dynamic response of horizontal storage tanks is mainly represented by liquid tank interaction and tank foundation interaction at this stage researchers are more focused on the former the liquid sloshing of horizontal storage tank was firstly studied by budiansky 1960 and abramson 1966 and the expression of sloshing force during lateral seismic action was derived kobayashi 1989 used experimental and numerical methods to study the sloshing frequency of horizontal storage tanks under lateral and longitudinal horizontal seismic excitation and obtained a semi analytical solution of sloshing frequency platyrrachos and karamanos 2005 proposed a finite element calculation formula for liquid sloshing based on ideal state no spin no stickiness small sloshing karamanos and patkas 2006 studied the effect of liquid sloshing on the seismic design of horizontal storage tanks a simplified method for calculating seismic force is proposed aus der wiesche 2008 studied the sloshing shape and sloshing frequency of the viscous liquid in horizontal cylindrical storage tanks and obtained the axial and lateral sloshing frequency with different liquid storage height and liquid storage viscosity karamanos et al 2009 assumed the liquid as the ideal fluid and solved the liquid velocity potential by the finite element method an effective method for calculating sloshing frequency and sloshing equivalent mass was proposed by decomposing the storage tank liquid motion omar badran 2012 proposed a three dimensional quasi static concentrated mass model of horizontal tanks and studied its dynamic performance under acceleration amir kolaei 2015 proposed the bem integrating the multimodal method and studied the three dimensional sloshing problem of the lateral and longitudinal acceleration excitation of the tanker oil storage during braking and turning and further discussed its applicability wenyuan wang 2016 based on the linear velocity potential theory deduced the new variational principle formula and the semi analytical scaled boundary finite element method for solving the sloshing problem of the liquid seyyed m hasheminejad 2017 derived an analytical solution for the sloshing of horizontal storage tanks based on the linear velocity potential theory and the cylindrical bessel function alessandra fiore 2018 carried out horizontal tank dynamic analysis and safety verification and established a single degree of freedom simplified mechanical model based on the finite element model at present research on the sloshing problem of horizontal storage tanks has been greatly developed design codes for horizontal tanks considering liquid impulsive pressure and sloshing effects had been published such as eurocode 8 2006 however most studies have assumed that horizontal storage tanks are rigid foundations ignoring the effects of soil tank liquid interactions on ground motion response in the past 50 years scholars have extensively studied the effects of soil structure interaction ssi on the ground motion response of various structural systems lysmer and kuhlemeyer 1969 veletsos 1971 1974 luco 1974 1976 gazetas 1978 1983 wolf 1985 veletsos and tang 1987 in particular atc 3 06 1978 first incorporated the influence of ssi soil structure interaction on ground motion response into structural seismic design although many studies in literature shows that ssi should be considered in seismic design codes ssi provisions are still optional in seismic design codes asce 7 2010 asce 41 13 2013 moreover recent studies such as khosravikia et al 2018 showed that even practicing the optional ssi provisions of seismic design codes could cause unsafe or overly conservative designs which necessitates revisiting those provisions this shows that the effect of ssi on structural systems has gradually received attention due to the fluidity of the liquid the effect of ssi the tank structure will translate into a more complex soil tank liquid interaction stli haroun and abou lzzeddine 1992 studied the ground motion response of vertical tanks considering soil storage interactions they found that the soil storage interaction amplifies the hydrodynamic pressure and the tank overturning moment during horizontal ground motion sun jiangang 2018 used numerical methods to study the ground motion response of large vertical floating roof tanks considering soil tank interactions the study shows that the soil swing effect has a great influence on the base shear force and liquid wave height especially when the site condition is soft soil therefore we have reason to believe that the effect of stli on the ground motion response of tank structure cannot be ignored however published references only refer to the study of soil tank interactions in vertical cylindrical tanks and have not yet involved horizontal tanks and the horizontal storage tank is greatly different from the vertical cylindrical storage tank in view of this this paper derives a simplified mechanical model for horizontal storage tanks considering stli which can be used for seismic design of horizontal storage tanks then the paper studied the ground motion response of stli and non stli under different shear wave velocity and discusses the necessity of stli 2 soil model according to the literatures wolf 1994 khosravikia et al 2017 2018 it simplify the soil into a three degree of freedom system including a sway dof x h a rocking dof x α and an additional dof x φ the soil structure model is shown in fig 1 where m i k c respectively represent the mass mass moment of inertia stiffness and damping coefficient of the superstructure m f i f are the mass mass moment of inertia of foundation the foundation radius is r and embedment depth is e the sway stiffness and damping coefficients read equations 1 and 2 1 k h 8 ρ v s 2 r 2 v 1 e r 2 c h r v s 0 68 0 57 e r k h rocking stiffness and damping coefficients read equations 3 and 4 3 k α 8 ρ v s 2 r 3 3 1 v 1 2 3 e r 0 58 e r 3 4 c α r v s 0 15631 e r 0 08906 e r 2 0 00874 e r 3 k h where ρ is density of soil v is poisson s ratio of soil v s is equivalent shear wave velocity of foundation soil the additional dof consist of a mass moment of inertia and damping system refer to equations 5 and 6 5 c φ r ν s 0 4 0 03 e r 2 k α 6 i φ r ν s 2 0 33 0 1 e r 2 k α different from general building structures the dynamic response of storage tank structures includes complex dynamic processes such as liquid sloshing and liquid solid coupling at present the most commonly used is the potential fluid theory proposed by housner et al 1957 to solve these complex dynamic responses therefore we deduced that the simplified mechanical model of horizontal storage tank considering soil structure interaction is actually an organic combination of soil model and potential fluid theory there is a detailed derivation process in section 3 3 horizontal storage tank considering stli simplified mechanical model due to the fluidity of the liquid the key issue in deriving a simplified mechanical model is to solve the m and i of liquid and tank in this paper the potential fluid theory is used and the fluid motion conforms to the laplace equation 7 2 φ r θ t 0 the total velocity potential can be decomposed into a rigid velocity potential and a sloshing velocity potential φ r θ t φ r r θ t φ s r θ t housner 1957 and both of φ r φ s satisfy the equation 7 the rigid velocity potential and the sloshing velocity potential are discussed separately 3 1 rigid velocity potential the rigid velocity potential satisfies the following boundary conditions equations 8 and 9 8 φ r r θ t φ r r θ 2 π t 9 φ r r r r x t sin θ x g t x 0 t x h t r h y x α t sin θ where r is the reservoir radius h is the support height x g t is the ground motion speed and x 0 t is the tank motion speed where x h t x α t are sway speed and rocking speed of soil model according to the boundary conditions 8 9 we can derive the expression of the rigid velocity potential 10 φ r r x g t x 0 t x h t r h y x α t sin θ 3 2 convective sloshing velocity potential the general expression of the sloshing velocity potential can be obtained by solving the laplace equation in the polar coordinate system 11 φ s n 1 f n t r n sin n θ the sloshing velocity potential satisfies the following boundary conditions 12 φ s r r r 0 boundary conditions on liquid free surface is shown in equations 13 to 15 13 2 φ s t 2 g φ s y 2 φ r t 2 g x α t r sin θ 14 φ s y cos θ φ s r sin θ r φ s θ 15 r h r cos θ substituting equations 10 and 11 into equation 13 both sides of the equation are multiplied by the harmonic function φ r θ and integrated in the liquid free surface s2 16 s 2 2 φ s t 2 g cos θ φ s r g sin θ r φ s θ φ d s s 2 2 φ r t 2 g x α t r sin θ φ d s substituting equation 11 into equation 12 and multiplying by the harmonic function φ r θ integrating in the liquid solid coupling surface s 1 r r the following equation can be obtained 17 θ 1 θ 1 n 1 φ f n t n l r n sin n θ d θ 0 formulas 16 and 17 are added together and written into matrix expressions equation 18 18 0 θ 1 φ n 1 t f d θ 0 θ 1 φ n 2 t n 3 t n 4 t f d θ 0 θ 1 2 l φ x t d θ according to galerkin s discretization principle the harmonic function can be discretized into an n order column vector φ r θ l 1 n r l sin l θ which is recorded as n r l sin l θ n 1 then equation 18 can be written as equation 19 19 m f k f x t according to the superposition principle of structural dynamic mode we can decouple equation 19 and find out its various modes and corresponding sloshing frequencies writable equation 21 20 k ω n 2 m ψ n 0 among them ω n is the n order sloshing frequency ψ n is the corresponding n order sloshing vibration mode since the liquid sloshing is mainly based on the first order modal shape only i 1 is the main research object the expression equation 21 of the sloshing velocity potential can be obtained by the equivalent transformation 21 φ s r θ t x c t ψ 1 t n m 1 where m 1 ψ 1 t m ψ 1 ψ 1 t χ x c t is the liquid sloshing component dof χ 0 θ 1 2 l sin l θ sin θ r h 2 l g cos 3 l θ d θ l 1 3 3 simplify mechanical models and motion control equations so the total velocity potential expression can be written as equation 22 22 φ r x g t x 0 t x h t r h y α t sin θ x c t ψ 1 t n m 1 according to the velocity potential equation the vibration form of free liquid surface under gravity field and the hydrodynamic force of liquid storage on tank wall can be deduced as equations 23 and 24 23 h v 1 g φ t 24 p r θ t ρ φ t the horizontal base shear force expression equations 26 and 27 can be obtained by integrating the hydrodynamic pressure 25 q 1 t ρ s 1 φ t sin θ d s m l a l t 2 l r ρ θ 1 π ψ 1 t n m 1 sin θ d θ x c t ϕ x α t 26 a l t x g t x 0 t x h t r h x α t 27 ϕ 2 l r 3 ρ sin 3 θ 3 where m l π θ 1 sin 2 θ 2 r 2 l ρ is the total volume of the liquid storage l is the length of the horizontal tank θ 1 arccos h r r equation 25 can be written as follows 28 q 1 t m r a r t m c a c t η x α t where 29 η m l h r m r h 0 m c h c ϕ 30 a r t x g t x 0 t x h t h 0 x α t 31 a c t x g t x 0 t x h t h c x α t x c t 32 m c 2 l r ρ θ 1 π ψ 1 t n m 1 sin θ d θ m r m l m c m c m r equation 32 are the sloshing component and the rigid component respectively h c h 0 are the equivalent height of sloshing component and rigid component respectively equations 30 and 31 are the absolute acceleration of the rigid component and the absolute acceleration of the sloshing component respectively the overturning moment generated by the inertial force of the liquid storage can also be obtained by the formula 24 33 m 1 t ρ s 1 φ t r 1 cos θ h sin θ d s m l r h 2 ρ r 3 l sin 3 θ 1 3 m l a l t m c h r ϑ m c x c t 2 ρ r 2 l κ x α t 34 κ r 4 π 4 θ 1 sin 4 θ 1 32 r h sin 3 θ 3 35 ϑ 2 ρ r 2 l θ 1 π ψ 1 t n m 1 sin θ cos θ d θ equations 34 and 35a are bending moment formula parameters equation 33 can be abbreviated as equation 36 36 m 1 t m r h 0 a r t m c h c a c t i x α t where i 2 ρ r 2 l κ m r h r h 0 h 0 m c h r h c h c and the equivalent height expression of sloshing component and rigid component can be derived 37 h 0 r h 2 ρ r 3 l sin 3 θ 1 3 ϑ 3 m r 38 h c r h ϑ m c substituting equations 37 and 38 into equation 29 and get η 0 equation 28 is transformed into equation 39 39 q 1 t m r a r t m c a c t in the event of earthquake the total shear force and total bending moment shall also include the shearing force and bending moment generated by the horizontal tank body m1 the supporting mass m2 the tank accessories m3 etc in order to facilitate engineering design m1 0 5m2 m3 etc can also be integrated into one concentrated mass and the equivalent height is h r which is recorded as equation 40 40 m s m 1 0 5 m 2 m 3 m n then the total base shear force is 41 q t m r a r t m c a c t m s a s t 42 a s t x g t x 0 t x h t h r x α t equation 42 is the absolute acceleration of the tank wall therefore the expression of the overturning moment generated by the tank the support system and the accessories can be written as equation 43 43 m 2 t m s h h a s t then the total overturning moment is 44 m t m r h 0 a r t m c h c a c t m s h h a s t i x α t according to formula 41 and formula 44 the simplified mechanical model of horizontal tank considering stli can be constructed the simplified mechanical model is shown in fig 2 where k c c c equations 45 and 46 are stiffness and damping coefficient of sloshing component ω is sloshing frequency ξ is sloshing damping ratio 45 k c m c ω 2 46 c c 2 ξ ω m c k 0 c 0 are the stiffness and damping of the support structure respectively according to the hamilton principle the motion control equation of fig 3 can be derived 47 m x c x k x f where c c c c 0 c h c α c φ c φ c φ c φ k k c k 0 k h k α 0 x x c x 0 x h x α x φ f m c m c m r m s m c m r m s m f m c h c m r h 0 m s h r 0 x g m m c m c m c m c h c 0 m c m c m r m s m c m r m s m c h c m r h 0 m s h r 0 m c m c m r m s m c m r m s m f m c h c m r h 0 m s h r 0 m c h c m c h c m r h 0 m s h r m c h c m r h 0 m s h r m c h c 2 m r h 0 2 m s h r 2 i i f 0 0 0 0 0 i φ 4 case analysis a lng horizontal storage tank project is selected as an example to study the seismic response the e r 0 horizontal tank parameters are shown in tables 1 and 2 4 1 effect of stli on ground motion response according to the literature china academy of building research 2010 the site soil can be roughly divided into four categories ι ⅱ ⅲ and ⅳ which are mainly divided according to the equivalent shear wave velocity and the cover thickness of the soil layer see appendix a for specific classification principles based on the requirements of the design code china academy of building research 2010 for each site we selected five actual recorded seismic waves and two artificially synthesized seismic waves as the ground motion input taking the mean value of the dynamic response of the seven seismic waves as the analysis object it is more representative of the site the seismic response spectrum curve of the earthquake records is shown in fig 4 the target spectrum is shown in fig 8 in appendix a earthquake records provided by the pkpm seismic library and pacific earthquake engineering research center we adjusted the peak acceleration pga of all seismic waves whether actual recorded or synthetic to 0 2 g site classification from ι to ⅳ are essentially transitions from hard soil sites to soft soil sites of course the type of site is also related to the thickness of the soil china academy of building research 2010 however since the soil structure model khosravikia et al 2017 2018 only involves equivalent shear wave velocity this study only selects different equivalent shear wave velocity to characterize different site soils as shown in table 3 the calculation results of stli and non stli are shown in tables 4 7 from the data in tables 4 7 we can find the seismic response of the horizontal storage tank is more severe after considering the stli and the main control targets such as the base shear force overturning bending moment and sloshing wave height increase by 25 58 moreover the effects of soft and medium soft fields are more significant we can explain this phenomenon from the perspective of the relationship between the natural frequency of the structure and the characteristic frequency of the site table 8 shows the model natural vibration periods and feature period of sites according to table 8 the natural period of the rigid foundation can be calculated as t 0 0186s t 0 1s according to fig 8 appendix a t is at the rising section of the response spectrum curve the horizontal vibration tank stli model can be used to calculate the natural vibration period of the horizontal tank stli system under different equivalent shear wave velocities the calculation results are shown in table 8 from the data in table 8 we can know that considering the ssi effect the natural vibration period of the horizontal storage tank will also be prolonged and the softer the site soil the longer the natural vibration period of the structural system but different from the general structure when the equivalent shear wave velocity is 650 m s and 380 m s t s 0 1s t s is in the rising section of the response spectrum the longer the natural vibration period the more severe the ground motion response when the equivalent shear wave velocities are 200 m s and 100 m s 0 1s t s t g t s is in the platform section of the response spectrum and the ground motion response is the most severe at this stage this is consistent with the calculation results of time history analysis 5 conclusion 1 based on potential fluid theory and soil model theory this paper deduces the simplified mechanical model for considering the soil tank liquid interaction of horizontal storage tanks 2 the seismic response of the horizontal storage tank is more severe after considering the stli and the main control targets such as the base shear force overturning bending moment and sloshing wave height increase by 25 58 moreover the effects of soft and medium soft fields are more significant the effects of soil tank liquid interactions credit authorship contribution statement yuan lyu conceptualization methodology writing review editing jiangang sun conceptualization resources zongguang sun resources lifu cui data curation zhen wang supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements financial support was provided by the national natural science foundation of china nos 51878124 in addition liaoning provincial natural science fund guidance plan 20180550073 2015020620 through its funding of scientific research projects is gratefully acknowledged appendix a 1 verification of simplified mechanical model we will verify the simplified mechanical model from two aspects first through comparative analysis with published papers and second through comparative with finite element numerical simulation models 1 1 comparative with published papers mciver p 1989 and lazaros a patkas 2007 proposed simplified mechanical models of horizontal storage tanks based on rigid foundations in 1989 and 2007 respectively taking the horizontal storage tank in this paper as an example we select important parameters in the simplified mechanical model sloshing frequency of liquid ω c liquid sloshing component coefficient s m c m l and liquid rigidity component coefficient r m r m l for comparative analysis h is the distance from the liquid surface to the bottom of the tank r is the radius of the tank fig 5 comparative with published papers fig 5 it can be seen from fig 5 that the calculation results of the model in this paper are very close to the values in the reference which can verify the correctness of the derivation of the tank in the simplified mechanical model the soil part of the simplified mechanical model is directly quoted from the soil model proposed by khosravikia et al 2017 2018 1 2 comparative with finite element numerical simulation models 1 2 1 finite element numerical simulation model taking the lng horizontal storage tank in this paper as an example we investigated the actual geological conditions of the storage tank location and established a finite element numerical simulation model of the horizontal storage tank considering the influence of site soil table 9 shows the actual geological conditions and corresponding physical parameters of the storage tank location the finite element model is shown in fig 6 table 9 physical parameters of soil layer table 9 soil layer coverage thickness m density kg m 3 elastic modulus mpa poisson s ratio internal friction angle cohesion kpa shear wave velocity plain fill 2 6 1600 48 44 0 4 12 8 125 mucky clay 6 1590 28 04 0 45 10 8 120 silty clay 5 4 1840 296 52 0 4 16 20 156 coarse sand 3 1850 577 42 0 35 28 0 265 fig 6 finite element model and physical object of horizontal storage tank fig 6 in the finite element model steel tank walls and saddles use shell elements of bilinear plastic material liquids use a non spin non viscous incompressible potential fluid model and soils use a common mohr coulomb material model the mohr coulomb model is based on a linearly elastic and perfectly plastic yield behavior a yield function defined by the mohr coulomb criterion a potential function defined by the drucker prager criterion a piecewise tension cut off analysis and a non associative flow rule chen and mizuno 1990 crisfield 1997 adina r d inc 2010 it is a common mathematical model used to calculate the mechanical behavior of soil fig 7 is the shapes of the mohr coulomb yield and potential surfaces in the π plane fig 7 shapes of the mohr coulomb yield and potential surfaces in the π plane fig 7 for the soil model we choose fixed boundary conditions according to the literature chen and yang 2011 when d h 10 the influence of soil boundary effects can be basically eliminated according to the actual situation the total thickness of the soil layer h 17 m so we choose the soil model with a diameter of d 210 m d h 12 35 10 which meets the requirements 1 2 2 equivalent shear wave velocity according to the data in table 10 the equivalent shear wave velocity ν under the site conditions can be calculated china academy of building research 2010 48 v d 0 t 49 t i 1 n d i v i v equivalent shear wave velocity d 0 soil cover thickness take the smaller of the cover thickness and 20 m t shear wave propagation time equation 49 d i layer i soil thickness v i layer i shear wave velocity n layers of soil according to formula 48 and 47 the equivalent shear wave velocity is ν 146 29 m s 1 2 3 site soil classification and seismic wave selection according to the literature china academy of building research 2010 the site soil can be roughly divided into four categories ι ⅱ ⅲ and ⅳ which are mainly divided according to the equivalent shear wave velocity and the cover thickness of the soil layer as shown in table 10 table 10 site classification table 10 equivalent shear wave velocity m s site classification ι ⅱ ⅲ ⅳ 800 v 500 d 0 500 v 250 d 5 d 5 250 v 150 d 3 3 d 50 d 50 v 150 d 3 3 d 15 15 d 80 d 80 note d thickness of cover soil according to the above calculation the equivalent shear wave velocity is ν 146 29 m s the cover thickness of the soil layer h 17 m which belongs to the class ⅲ site therefore the selected seismic wave must meet the characteristics of the ⅲ site the standard acceleration response spectrum is shown in fig 8 table 11is the characteristic period of the four types of sites china academy of building research 2010 fig 8 standard acceleration response spectrum fig 8 where α earthquake influence coefficient α max maximum earthquake influence coefficient η 1 0 02 0 05 ζ 4 32 ζ falling slope adjustment factor for straight down segments γ 0 9 0 05 ζ 0 3 6 ζ attenuation index η 2 1 0 05 ζ 0 08 1 6 ζ damping adjustment factor ζ damping ratio t structural natural vibration period t g site feature period table 11 feature period of four type sites table 11 feature period site ι site ⅱ site ⅲ site ⅳ t g s 0 25 0 35 0 35 0 45 0 45 0 65 0 65 0 90 according to the requirements of the design code china academy of building research 2010 we selected five actual recorded seismic waves and two artificially synthesized seismic waves as the ground motion input the seismic response spectrum curve of the earthquake records is shown in fig 9 earthquake records provided by the pkpm seismic library and pacific earthquake engineering research center we adjusted the peak acceleration pga of all seismic waves whether actual recorded or synthetic to 0 2 g fig 9 seismic response spectrum curve of the earthquake records fig 9 1 2 4 comparative analysis of calculation results table 12 shows the peak values of ground motion response calculated by the finite element numerical simulation model and theoretical model fig 10 is the time history curve of sloshing wave height base shear force and overturning bending moment under the action of el centro wave from the data in table 4 it can be seen that the peak values of the ground motion response of the finite element and the theoretical model are very close the sloshing wave height the mean difference rate of the base shear force and the overturning bending moment are within 5 table 12 comparison of theoretical model and finite element model table 12 emc cpc lwd pel el centro artificial wave 1 artificial wave 2 mean mean difference date h v m theoretical model 0 579 0 602 0 603 0 477 0 381 0 421 0 400 0 495 4 64 finite element 0 478 0 513 0 544 0 503 0 409 0 397 0 456 0 472 q kn theoretical model 631 9 536 5 721 1 496 7 462 1 491 4 496 3 548 0 2 21 finite element 554 1 527 8 693 5 505 6 455 6 501 7 513 0 535 9 m kn m theoretical model 1866 1578 2107 1473 1342 1214 1401 1568 2 66 finite element 1683 1493 2009 1532 1326 1137 1509 1527 fig 10 ground motion response time history curve fig 10 in summary through the above comparative analysis we believe that the simplified mechanical model of the horizontal storage tank considering stli proposed in this paper is reliable 
22113,based on potential fluid theory and soil model theory this paper derived a simplified mechanical model for horizontal storage tanks considering soil tank liquid interaction stli which can be used for seismic design of horizontal storage tanks then the paper studied the ground motion response of stli and non stli under different shear wave velocity we find the seismic response of the horizontal storage tank is more severe after considering the stli and the main control targets such as the base shear force overturning bending moment and sloshing wave height increase by 25 58 moreover the effects of soft and medium soft fields are more significant keywords soil tank liquid interaction horizontal storage tank potential fluid theory soil model simplified mechanical model 1 introduction horizontal storage tanks are important storage equipment in the petrochemical industry and are commonly used to store flammable and explosive chemical products once the horizontal storage tank encounters an earthquake and is damaged it may cause serious secondary disasters such as fires and explosions for example on june 16 1964 a magnitude 7 4 earthquake occurred in niigata japan which damaged storage tanks in a local refinery and caused a fire the fire of the oil storage tank quickly spread to the entire oil tank area and adjacent factories new fires and explosions occurred in the factory becoming the second source of fire which in turn triggered a larger fire the entire site of the niigata refinery was in ruins more than 80 tanks were scrapped killing more than 500 people and destroying 75 of gas pipelines and 11 substations therefore it is especially important to study the dynamic response of horizontal storage tanks under ground motion and the seismic design method the dynamic response of horizontal storage tanks is mainly represented by liquid tank interaction and tank foundation interaction at this stage researchers are more focused on the former the liquid sloshing of horizontal storage tank was firstly studied by budiansky 1960 and abramson 1966 and the expression of sloshing force during lateral seismic action was derived kobayashi 1989 used experimental and numerical methods to study the sloshing frequency of horizontal storage tanks under lateral and longitudinal horizontal seismic excitation and obtained a semi analytical solution of sloshing frequency platyrrachos and karamanos 2005 proposed a finite element calculation formula for liquid sloshing based on ideal state no spin no stickiness small sloshing karamanos and patkas 2006 studied the effect of liquid sloshing on the seismic design of horizontal storage tanks a simplified method for calculating seismic force is proposed aus der wiesche 2008 studied the sloshing shape and sloshing frequency of the viscous liquid in horizontal cylindrical storage tanks and obtained the axial and lateral sloshing frequency with different liquid storage height and liquid storage viscosity karamanos et al 2009 assumed the liquid as the ideal fluid and solved the liquid velocity potential by the finite element method an effective method for calculating sloshing frequency and sloshing equivalent mass was proposed by decomposing the storage tank liquid motion omar badran 2012 proposed a three dimensional quasi static concentrated mass model of horizontal tanks and studied its dynamic performance under acceleration amir kolaei 2015 proposed the bem integrating the multimodal method and studied the three dimensional sloshing problem of the lateral and longitudinal acceleration excitation of the tanker oil storage during braking and turning and further discussed its applicability wenyuan wang 2016 based on the linear velocity potential theory deduced the new variational principle formula and the semi analytical scaled boundary finite element method for solving the sloshing problem of the liquid seyyed m hasheminejad 2017 derived an analytical solution for the sloshing of horizontal storage tanks based on the linear velocity potential theory and the cylindrical bessel function alessandra fiore 2018 carried out horizontal tank dynamic analysis and safety verification and established a single degree of freedom simplified mechanical model based on the finite element model at present research on the sloshing problem of horizontal storage tanks has been greatly developed design codes for horizontal tanks considering liquid impulsive pressure and sloshing effects had been published such as eurocode 8 2006 however most studies have assumed that horizontal storage tanks are rigid foundations ignoring the effects of soil tank liquid interactions on ground motion response in the past 50 years scholars have extensively studied the effects of soil structure interaction ssi on the ground motion response of various structural systems lysmer and kuhlemeyer 1969 veletsos 1971 1974 luco 1974 1976 gazetas 1978 1983 wolf 1985 veletsos and tang 1987 in particular atc 3 06 1978 first incorporated the influence of ssi soil structure interaction on ground motion response into structural seismic design although many studies in literature shows that ssi should be considered in seismic design codes ssi provisions are still optional in seismic design codes asce 7 2010 asce 41 13 2013 moreover recent studies such as khosravikia et al 2018 showed that even practicing the optional ssi provisions of seismic design codes could cause unsafe or overly conservative designs which necessitates revisiting those provisions this shows that the effect of ssi on structural systems has gradually received attention due to the fluidity of the liquid the effect of ssi the tank structure will translate into a more complex soil tank liquid interaction stli haroun and abou lzzeddine 1992 studied the ground motion response of vertical tanks considering soil storage interactions they found that the soil storage interaction amplifies the hydrodynamic pressure and the tank overturning moment during horizontal ground motion sun jiangang 2018 used numerical methods to study the ground motion response of large vertical floating roof tanks considering soil tank interactions the study shows that the soil swing effect has a great influence on the base shear force and liquid wave height especially when the site condition is soft soil therefore we have reason to believe that the effect of stli on the ground motion response of tank structure cannot be ignored however published references only refer to the study of soil tank interactions in vertical cylindrical tanks and have not yet involved horizontal tanks and the horizontal storage tank is greatly different from the vertical cylindrical storage tank in view of this this paper derives a simplified mechanical model for horizontal storage tanks considering stli which can be used for seismic design of horizontal storage tanks then the paper studied the ground motion response of stli and non stli under different shear wave velocity and discusses the necessity of stli 2 soil model according to the literatures wolf 1994 khosravikia et al 2017 2018 it simplify the soil into a three degree of freedom system including a sway dof x h a rocking dof x α and an additional dof x φ the soil structure model is shown in fig 1 where m i k c respectively represent the mass mass moment of inertia stiffness and damping coefficient of the superstructure m f i f are the mass mass moment of inertia of foundation the foundation radius is r and embedment depth is e the sway stiffness and damping coefficients read equations 1 and 2 1 k h 8 ρ v s 2 r 2 v 1 e r 2 c h r v s 0 68 0 57 e r k h rocking stiffness and damping coefficients read equations 3 and 4 3 k α 8 ρ v s 2 r 3 3 1 v 1 2 3 e r 0 58 e r 3 4 c α r v s 0 15631 e r 0 08906 e r 2 0 00874 e r 3 k h where ρ is density of soil v is poisson s ratio of soil v s is equivalent shear wave velocity of foundation soil the additional dof consist of a mass moment of inertia and damping system refer to equations 5 and 6 5 c φ r ν s 0 4 0 03 e r 2 k α 6 i φ r ν s 2 0 33 0 1 e r 2 k α different from general building structures the dynamic response of storage tank structures includes complex dynamic processes such as liquid sloshing and liquid solid coupling at present the most commonly used is the potential fluid theory proposed by housner et al 1957 to solve these complex dynamic responses therefore we deduced that the simplified mechanical model of horizontal storage tank considering soil structure interaction is actually an organic combination of soil model and potential fluid theory there is a detailed derivation process in section 3 3 horizontal storage tank considering stli simplified mechanical model due to the fluidity of the liquid the key issue in deriving a simplified mechanical model is to solve the m and i of liquid and tank in this paper the potential fluid theory is used and the fluid motion conforms to the laplace equation 7 2 φ r θ t 0 the total velocity potential can be decomposed into a rigid velocity potential and a sloshing velocity potential φ r θ t φ r r θ t φ s r θ t housner 1957 and both of φ r φ s satisfy the equation 7 the rigid velocity potential and the sloshing velocity potential are discussed separately 3 1 rigid velocity potential the rigid velocity potential satisfies the following boundary conditions equations 8 and 9 8 φ r r θ t φ r r θ 2 π t 9 φ r r r r x t sin θ x g t x 0 t x h t r h y x α t sin θ where r is the reservoir radius h is the support height x g t is the ground motion speed and x 0 t is the tank motion speed where x h t x α t are sway speed and rocking speed of soil model according to the boundary conditions 8 9 we can derive the expression of the rigid velocity potential 10 φ r r x g t x 0 t x h t r h y x α t sin θ 3 2 convective sloshing velocity potential the general expression of the sloshing velocity potential can be obtained by solving the laplace equation in the polar coordinate system 11 φ s n 1 f n t r n sin n θ the sloshing velocity potential satisfies the following boundary conditions 12 φ s r r r 0 boundary conditions on liquid free surface is shown in equations 13 to 15 13 2 φ s t 2 g φ s y 2 φ r t 2 g x α t r sin θ 14 φ s y cos θ φ s r sin θ r φ s θ 15 r h r cos θ substituting equations 10 and 11 into equation 13 both sides of the equation are multiplied by the harmonic function φ r θ and integrated in the liquid free surface s2 16 s 2 2 φ s t 2 g cos θ φ s r g sin θ r φ s θ φ d s s 2 2 φ r t 2 g x α t r sin θ φ d s substituting equation 11 into equation 12 and multiplying by the harmonic function φ r θ integrating in the liquid solid coupling surface s 1 r r the following equation can be obtained 17 θ 1 θ 1 n 1 φ f n t n l r n sin n θ d θ 0 formulas 16 and 17 are added together and written into matrix expressions equation 18 18 0 θ 1 φ n 1 t f d θ 0 θ 1 φ n 2 t n 3 t n 4 t f d θ 0 θ 1 2 l φ x t d θ according to galerkin s discretization principle the harmonic function can be discretized into an n order column vector φ r θ l 1 n r l sin l θ which is recorded as n r l sin l θ n 1 then equation 18 can be written as equation 19 19 m f k f x t according to the superposition principle of structural dynamic mode we can decouple equation 19 and find out its various modes and corresponding sloshing frequencies writable equation 21 20 k ω n 2 m ψ n 0 among them ω n is the n order sloshing frequency ψ n is the corresponding n order sloshing vibration mode since the liquid sloshing is mainly based on the first order modal shape only i 1 is the main research object the expression equation 21 of the sloshing velocity potential can be obtained by the equivalent transformation 21 φ s r θ t x c t ψ 1 t n m 1 where m 1 ψ 1 t m ψ 1 ψ 1 t χ x c t is the liquid sloshing component dof χ 0 θ 1 2 l sin l θ sin θ r h 2 l g cos 3 l θ d θ l 1 3 3 simplify mechanical models and motion control equations so the total velocity potential expression can be written as equation 22 22 φ r x g t x 0 t x h t r h y α t sin θ x c t ψ 1 t n m 1 according to the velocity potential equation the vibration form of free liquid surface under gravity field and the hydrodynamic force of liquid storage on tank wall can be deduced as equations 23 and 24 23 h v 1 g φ t 24 p r θ t ρ φ t the horizontal base shear force expression equations 26 and 27 can be obtained by integrating the hydrodynamic pressure 25 q 1 t ρ s 1 φ t sin θ d s m l a l t 2 l r ρ θ 1 π ψ 1 t n m 1 sin θ d θ x c t ϕ x α t 26 a l t x g t x 0 t x h t r h x α t 27 ϕ 2 l r 3 ρ sin 3 θ 3 where m l π θ 1 sin 2 θ 2 r 2 l ρ is the total volume of the liquid storage l is the length of the horizontal tank θ 1 arccos h r r equation 25 can be written as follows 28 q 1 t m r a r t m c a c t η x α t where 29 η m l h r m r h 0 m c h c ϕ 30 a r t x g t x 0 t x h t h 0 x α t 31 a c t x g t x 0 t x h t h c x α t x c t 32 m c 2 l r ρ θ 1 π ψ 1 t n m 1 sin θ d θ m r m l m c m c m r equation 32 are the sloshing component and the rigid component respectively h c h 0 are the equivalent height of sloshing component and rigid component respectively equations 30 and 31 are the absolute acceleration of the rigid component and the absolute acceleration of the sloshing component respectively the overturning moment generated by the inertial force of the liquid storage can also be obtained by the formula 24 33 m 1 t ρ s 1 φ t r 1 cos θ h sin θ d s m l r h 2 ρ r 3 l sin 3 θ 1 3 m l a l t m c h r ϑ m c x c t 2 ρ r 2 l κ x α t 34 κ r 4 π 4 θ 1 sin 4 θ 1 32 r h sin 3 θ 3 35 ϑ 2 ρ r 2 l θ 1 π ψ 1 t n m 1 sin θ cos θ d θ equations 34 and 35a are bending moment formula parameters equation 33 can be abbreviated as equation 36 36 m 1 t m r h 0 a r t m c h c a c t i x α t where i 2 ρ r 2 l κ m r h r h 0 h 0 m c h r h c h c and the equivalent height expression of sloshing component and rigid component can be derived 37 h 0 r h 2 ρ r 3 l sin 3 θ 1 3 ϑ 3 m r 38 h c r h ϑ m c substituting equations 37 and 38 into equation 29 and get η 0 equation 28 is transformed into equation 39 39 q 1 t m r a r t m c a c t in the event of earthquake the total shear force and total bending moment shall also include the shearing force and bending moment generated by the horizontal tank body m1 the supporting mass m2 the tank accessories m3 etc in order to facilitate engineering design m1 0 5m2 m3 etc can also be integrated into one concentrated mass and the equivalent height is h r which is recorded as equation 40 40 m s m 1 0 5 m 2 m 3 m n then the total base shear force is 41 q t m r a r t m c a c t m s a s t 42 a s t x g t x 0 t x h t h r x α t equation 42 is the absolute acceleration of the tank wall therefore the expression of the overturning moment generated by the tank the support system and the accessories can be written as equation 43 43 m 2 t m s h h a s t then the total overturning moment is 44 m t m r h 0 a r t m c h c a c t m s h h a s t i x α t according to formula 41 and formula 44 the simplified mechanical model of horizontal tank considering stli can be constructed the simplified mechanical model is shown in fig 2 where k c c c equations 45 and 46 are stiffness and damping coefficient of sloshing component ω is sloshing frequency ξ is sloshing damping ratio 45 k c m c ω 2 46 c c 2 ξ ω m c k 0 c 0 are the stiffness and damping of the support structure respectively according to the hamilton principle the motion control equation of fig 3 can be derived 47 m x c x k x f where c c c c 0 c h c α c φ c φ c φ c φ k k c k 0 k h k α 0 x x c x 0 x h x α x φ f m c m c m r m s m c m r m s m f m c h c m r h 0 m s h r 0 x g m m c m c m c m c h c 0 m c m c m r m s m c m r m s m c h c m r h 0 m s h r 0 m c m c m r m s m c m r m s m f m c h c m r h 0 m s h r 0 m c h c m c h c m r h 0 m s h r m c h c m r h 0 m s h r m c h c 2 m r h 0 2 m s h r 2 i i f 0 0 0 0 0 i φ 4 case analysis a lng horizontal storage tank project is selected as an example to study the seismic response the e r 0 horizontal tank parameters are shown in tables 1 and 2 4 1 effect of stli on ground motion response according to the literature china academy of building research 2010 the site soil can be roughly divided into four categories ι ⅱ ⅲ and ⅳ which are mainly divided according to the equivalent shear wave velocity and the cover thickness of the soil layer see appendix a for specific classification principles based on the requirements of the design code china academy of building research 2010 for each site we selected five actual recorded seismic waves and two artificially synthesized seismic waves as the ground motion input taking the mean value of the dynamic response of the seven seismic waves as the analysis object it is more representative of the site the seismic response spectrum curve of the earthquake records is shown in fig 4 the target spectrum is shown in fig 8 in appendix a earthquake records provided by the pkpm seismic library and pacific earthquake engineering research center we adjusted the peak acceleration pga of all seismic waves whether actual recorded or synthetic to 0 2 g site classification from ι to ⅳ are essentially transitions from hard soil sites to soft soil sites of course the type of site is also related to the thickness of the soil china academy of building research 2010 however since the soil structure model khosravikia et al 2017 2018 only involves equivalent shear wave velocity this study only selects different equivalent shear wave velocity to characterize different site soils as shown in table 3 the calculation results of stli and non stli are shown in tables 4 7 from the data in tables 4 7 we can find the seismic response of the horizontal storage tank is more severe after considering the stli and the main control targets such as the base shear force overturning bending moment and sloshing wave height increase by 25 58 moreover the effects of soft and medium soft fields are more significant we can explain this phenomenon from the perspective of the relationship between the natural frequency of the structure and the characteristic frequency of the site table 8 shows the model natural vibration periods and feature period of sites according to table 8 the natural period of the rigid foundation can be calculated as t 0 0186s t 0 1s according to fig 8 appendix a t is at the rising section of the response spectrum curve the horizontal vibration tank stli model can be used to calculate the natural vibration period of the horizontal tank stli system under different equivalent shear wave velocities the calculation results are shown in table 8 from the data in table 8 we can know that considering the ssi effect the natural vibration period of the horizontal storage tank will also be prolonged and the softer the site soil the longer the natural vibration period of the structural system but different from the general structure when the equivalent shear wave velocity is 650 m s and 380 m s t s 0 1s t s is in the rising section of the response spectrum the longer the natural vibration period the more severe the ground motion response when the equivalent shear wave velocities are 200 m s and 100 m s 0 1s t s t g t s is in the platform section of the response spectrum and the ground motion response is the most severe at this stage this is consistent with the calculation results of time history analysis 5 conclusion 1 based on potential fluid theory and soil model theory this paper deduces the simplified mechanical model for considering the soil tank liquid interaction of horizontal storage tanks 2 the seismic response of the horizontal storage tank is more severe after considering the stli and the main control targets such as the base shear force overturning bending moment and sloshing wave height increase by 25 58 moreover the effects of soft and medium soft fields are more significant the effects of soil tank liquid interactions credit authorship contribution statement yuan lyu conceptualization methodology writing review editing jiangang sun conceptualization resources zongguang sun resources lifu cui data curation zhen wang supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements financial support was provided by the national natural science foundation of china nos 51878124 in addition liaoning provincial natural science fund guidance plan 20180550073 2015020620 through its funding of scientific research projects is gratefully acknowledged appendix a 1 verification of simplified mechanical model we will verify the simplified mechanical model from two aspects first through comparative analysis with published papers and second through comparative with finite element numerical simulation models 1 1 comparative with published papers mciver p 1989 and lazaros a patkas 2007 proposed simplified mechanical models of horizontal storage tanks based on rigid foundations in 1989 and 2007 respectively taking the horizontal storage tank in this paper as an example we select important parameters in the simplified mechanical model sloshing frequency of liquid ω c liquid sloshing component coefficient s m c m l and liquid rigidity component coefficient r m r m l for comparative analysis h is the distance from the liquid surface to the bottom of the tank r is the radius of the tank fig 5 comparative with published papers fig 5 it can be seen from fig 5 that the calculation results of the model in this paper are very close to the values in the reference which can verify the correctness of the derivation of the tank in the simplified mechanical model the soil part of the simplified mechanical model is directly quoted from the soil model proposed by khosravikia et al 2017 2018 1 2 comparative with finite element numerical simulation models 1 2 1 finite element numerical simulation model taking the lng horizontal storage tank in this paper as an example we investigated the actual geological conditions of the storage tank location and established a finite element numerical simulation model of the horizontal storage tank considering the influence of site soil table 9 shows the actual geological conditions and corresponding physical parameters of the storage tank location the finite element model is shown in fig 6 table 9 physical parameters of soil layer table 9 soil layer coverage thickness m density kg m 3 elastic modulus mpa poisson s ratio internal friction angle cohesion kpa shear wave velocity plain fill 2 6 1600 48 44 0 4 12 8 125 mucky clay 6 1590 28 04 0 45 10 8 120 silty clay 5 4 1840 296 52 0 4 16 20 156 coarse sand 3 1850 577 42 0 35 28 0 265 fig 6 finite element model and physical object of horizontal storage tank fig 6 in the finite element model steel tank walls and saddles use shell elements of bilinear plastic material liquids use a non spin non viscous incompressible potential fluid model and soils use a common mohr coulomb material model the mohr coulomb model is based on a linearly elastic and perfectly plastic yield behavior a yield function defined by the mohr coulomb criterion a potential function defined by the drucker prager criterion a piecewise tension cut off analysis and a non associative flow rule chen and mizuno 1990 crisfield 1997 adina r d inc 2010 it is a common mathematical model used to calculate the mechanical behavior of soil fig 7 is the shapes of the mohr coulomb yield and potential surfaces in the π plane fig 7 shapes of the mohr coulomb yield and potential surfaces in the π plane fig 7 for the soil model we choose fixed boundary conditions according to the literature chen and yang 2011 when d h 10 the influence of soil boundary effects can be basically eliminated according to the actual situation the total thickness of the soil layer h 17 m so we choose the soil model with a diameter of d 210 m d h 12 35 10 which meets the requirements 1 2 2 equivalent shear wave velocity according to the data in table 10 the equivalent shear wave velocity ν under the site conditions can be calculated china academy of building research 2010 48 v d 0 t 49 t i 1 n d i v i v equivalent shear wave velocity d 0 soil cover thickness take the smaller of the cover thickness and 20 m t shear wave propagation time equation 49 d i layer i soil thickness v i layer i shear wave velocity n layers of soil according to formula 48 and 47 the equivalent shear wave velocity is ν 146 29 m s 1 2 3 site soil classification and seismic wave selection according to the literature china academy of building research 2010 the site soil can be roughly divided into four categories ι ⅱ ⅲ and ⅳ which are mainly divided according to the equivalent shear wave velocity and the cover thickness of the soil layer as shown in table 10 table 10 site classification table 10 equivalent shear wave velocity m s site classification ι ⅱ ⅲ ⅳ 800 v 500 d 0 500 v 250 d 5 d 5 250 v 150 d 3 3 d 50 d 50 v 150 d 3 3 d 15 15 d 80 d 80 note d thickness of cover soil according to the above calculation the equivalent shear wave velocity is ν 146 29 m s the cover thickness of the soil layer h 17 m which belongs to the class ⅲ site therefore the selected seismic wave must meet the characteristics of the ⅲ site the standard acceleration response spectrum is shown in fig 8 table 11is the characteristic period of the four types of sites china academy of building research 2010 fig 8 standard acceleration response spectrum fig 8 where α earthquake influence coefficient α max maximum earthquake influence coefficient η 1 0 02 0 05 ζ 4 32 ζ falling slope adjustment factor for straight down segments γ 0 9 0 05 ζ 0 3 6 ζ attenuation index η 2 1 0 05 ζ 0 08 1 6 ζ damping adjustment factor ζ damping ratio t structural natural vibration period t g site feature period table 11 feature period of four type sites table 11 feature period site ι site ⅱ site ⅲ site ⅳ t g s 0 25 0 35 0 35 0 45 0 45 0 65 0 65 0 90 according to the requirements of the design code china academy of building research 2010 we selected five actual recorded seismic waves and two artificially synthesized seismic waves as the ground motion input the seismic response spectrum curve of the earthquake records is shown in fig 9 earthquake records provided by the pkpm seismic library and pacific earthquake engineering research center we adjusted the peak acceleration pga of all seismic waves whether actual recorded or synthetic to 0 2 g fig 9 seismic response spectrum curve of the earthquake records fig 9 1 2 4 comparative analysis of calculation results table 12 shows the peak values of ground motion response calculated by the finite element numerical simulation model and theoretical model fig 10 is the time history curve of sloshing wave height base shear force and overturning bending moment under the action of el centro wave from the data in table 4 it can be seen that the peak values of the ground motion response of the finite element and the theoretical model are very close the sloshing wave height the mean difference rate of the base shear force and the overturning bending moment are within 5 table 12 comparison of theoretical model and finite element model table 12 emc cpc lwd pel el centro artificial wave 1 artificial wave 2 mean mean difference date h v m theoretical model 0 579 0 602 0 603 0 477 0 381 0 421 0 400 0 495 4 64 finite element 0 478 0 513 0 544 0 503 0 409 0 397 0 456 0 472 q kn theoretical model 631 9 536 5 721 1 496 7 462 1 491 4 496 3 548 0 2 21 finite element 554 1 527 8 693 5 505 6 455 6 501 7 513 0 535 9 m kn m theoretical model 1866 1578 2107 1473 1342 1214 1401 1568 2 66 finite element 1683 1493 2009 1532 1326 1137 1509 1527 fig 10 ground motion response time history curve fig 10 in summary through the above comparative analysis we believe that the simplified mechanical model of the horizontal storage tank considering stli proposed in this paper is reliable 
22114,the current field induced by internal solitary wave can be quite large and it can cause destruction to marine structures in recent years the forces induced by internal solitary wave on circular cylinder have been studied extensively and morison equation is commonly used to estimate the forces however the applicability of morison equation to force estimation induced by internal solitary wave has not been validated two sets of numerical simulations are used to check the validity of morison equation in predicting forces induced by internal solitary wave one for directly calculating the forces on the cylinder another for deriving the velocity field at the cylinder location which is required by the morison equation the comparison of directly calculated forces and those estimated from the morison equation reveals that the morison equation fails to predict the temporal evolution of the forces a modified morison equation incorporating the total derivative is put forward and it proves to predict the forces reasonably well with appropriately determined inertial and drag coefficients further experiments and numerical simulations are necessary to determine the dependence of the inertial and drag coefficients on the cylinder configuration and wave parameters keywords internal wave force morison equation cylinder 1 introduction internal solitary waves occur between two layers of fluids with different densities the wave induced velocity can be quite large and induce destruction to marine engineering structures such as oil drilling rigs and pipeline in recent years the forces induced by internal solitary wave on circular structure have been studied from different aspects the force calculation can be generally divided into two steps first the velocity field induced by the internal solitary wave is deduced then the forces are estimated with morison equation and corresponding empirical coefficients different theories and numerical models are used to calculate the velocity field induced by the internal solitary wave cai et al 2003 utilized modal separation and regression analyses to estimate the forces and torques by internal solitary wave on cylindrical piles later cai et al 2006 showed that the forces by the first mode internal wave dominate the global force and a simple estimation method was put forward the forces could be estimated by the local density data and the amplitude of internal solitary wave cai et al 2008 further analyzed the influence of shear flows on the forces and torques on cylindrical piles with observational data near dongsha islands xie et al 2010 compared the validity of mcc theory choi and camassa 1999 and korteweg de vries kdv theory for larger amplitude nonlinear internal solitary wave in two layer fluids and estimated the forces and torques on a small cylinder the results showed that for strongly nonlinear large amplitude internal solitary wave the mcc theory was more effective than the kdv theory xie et al 2011 employed a continuously stratified nonlinear model to simulate the generation of internal solitary wave and calculated the forces and torques on a supposed small diameter vertical cylindrical pile si et al 2012 used the generalized kdv model for continuous stratified ocean in the south china sea to evaluate the velocity field and analyzed its influence on a cylindrical structure zha et al 2012 retrieved the velocities induced by internal solitary wave based on the use of the radon transform technique applied to the radar images and calculated the forces on a circular cylinder lü et al 2016 computed the velocity field induced by internal solitary wave based on a two dimensional nonlinear numerical model and analyzed the influence of background parabolic current on the forces and torques on cylindrical tendon leg morison et al 1950 analyzed the forces by unbroken surface waves on a cylindrical pile and showed that the forces exerted on a differential section of cylindrical pile can be decomposed into two components a virtual mass force proportional to the horizontal local acceleration and a drag force proportional to the square of the velocity 1 d f ρ c m π d 2 4 u t ρ c d d 2 u u d z where ρ is the density of the fluid d the diameter of the cylinder u the horizontal velocity component c m and c d are the coefficients of the inertial and drag components the total force exerted on the structure can be calculated by integrating 1 along z axis this equation is expected to be valid if the diameter of the pile d is much less than the wave length l d l 0 15 so the incident wave field is not disturbed and the existence of the pile can be neglected the value of the coefficients c m and c d are determined by experimental studies sarpkaya 1976 systematically studied the forces on smooth cylinder in harmonic flow and concluded that the inertial and drag coefficients were functions of the reynolds and keulegan carpenter numbers in the studies mentioned above the coefficients were generally set to constant values though there was no consensus on the values the coefficients should be set to e g c m 2 0 c d 1 2 see cai et al 2003 2006 xie et al 2010 zha et al 2012 c m 1 8 c d 0 6 see cai et al 2008 xie et al 2011 c m 1 8 c d 0 8 see si et al 2012 lü et al 2016 the previous studies are helpful to evaluate the forces exerted by internal solitary wave on cylinder pile however it should be noted that the morison equation was originally developed for surface waves of small amplitude morison et al 1950 and the experimental studies by sarpkaya 1976 were expected to be valid only for harmonic flow with zero mean velocity the applicability of morison equation 1 to estimate the forces induced by internal solitary wave on cylindrical pile has not been verified and is the focus of the present study the paper is organized as follows numerical configurations are given in section 2 in section 3 the applicability of the morison equation to estimate forces induced by internal solitary wave on a circular cylinder is examined and a modified empirical equation is put forward the major conclusions are drawn in section 4 2 numerical configurations numerical method is used to check the applicability of morison equation for forces estimation induced by internal solitary wave on cylindrical pile two sets of numerical simulations are configured in this study the first set of simulations are three dimensional cylinder resolved high resolution computations which aim to compute the forces exerted on the cylindrical pile directly by integrating the pressure and viscous force the cylindrical pile is neglected in the second set of simulations and a two dimensional numerical study can be utilized the velocity data at the cylinder location are then used to evaluate the forces by the morison equation openfoam open source field operation and manipulation is used for the computations in this study openfoam is an open source software for computational fluid dynamics the solver based on boussinesq approximation for incompressible fluid is used in the numerical simulation the computation domain and the initial configuration are shown in fig 1 the computational domain is a closed section of 10 m width 30 m length and of 5 m height a circular cylinder with 1 m diameter and 5 m height is placed in the center of domain for the first set of simulations the grid structure is shown in fig 2 the computational domain is primarily composed with cube grids with side length 0 1 m and boundary layers are added around the cylinder to calculate the forces by the fluid the densities of the upper and lower layer are initialized as 1000 kg m3 and 1030 kg m3 respectively the initial velocity field is set to zero and a density step h closed to the left boundary is used to trigger the internal solitary wave this internal wave generation method is easy to configure and widely used in laboratory and numerical experiments lin and song 2012 in this study three different values of density step are used h 1 m 1 5 m and 2 m all numerical simulations are integrated 50 s when the generated internal solitary wave has passed the location of the cylinder the calculated forces on the cylinder and the velocity field at the cylinder location are saved at 0 1 s interval the forces on the cylinder are calculated as the sum of normal pressure and tangential viscous contributions 2 f f p f v i s f i p i n i i μ s f i u s i τ i where ρ is the density s f the face area p the pressure μ the dynamic viscosity u s the velocity shear at the cylinder surface n the unit surface normal around the cylinder and τ the unit tangential vector along the velocity direction a thin boundary layer is required to accurately calculate the forces on the cylinder all the cases shown are validated in terms of grid convergence e g for the density step height h 1 m the influences of different boundary layer thickness on the temporal evolution of the forces have been tested as shown in fig 3 it can be seen that the differences between those sensitivity studies are negligibly small and the calculated forces can be reliably used for later discussions 3 results 3 1 comparison between calculated forces and predictions by morison equation the numerical results are examined to verify the predictions by morison equation the temporal evolution of the density interfaces at the cylinder location are shown in fig 4 it can be seen that depression type and asymmetrical internal solitary waves are generated and propagate in the computational domain the wave amplitudes are approximately one half of the corresponding initial density step heights the leading wave is followed by small scale high frequency trailing waves lin and song 2012 which is beyond the discussion of this study the temporal variation of the forces calculated directly on the cylinder and those computed by the morison equation with different drag coefficients for h 1 m are shown in fig 5 the influence of the inertial coefficient c m can be neglected as the integrated inertial force is zero cai et al 2003 3 0 h ρ c m π d 2 4 u t d z ρ c m π d 2 4 t 0 h u d z 0 where h is the depth of the computational domain the total force on the cylinder can be simplified as 4 f ρ c d d 2 0 h u u d z two different values for c d 0 6 and 1 2 widely used in previous studies are adopted to estimate the forces on the cylinder from figs 4 and 5 it can be seen that the forces estimated by morison equation are generally along the wave propagation direction and the maximum force occurs when the density interface reaches the maximum excursion however from fig 5 it shows that the differences between the forces calculated directly on the cylinder and those estimated with the morison equation are quite large no matter what value is chosen for c d the forces calculated by integrating the pressure and viscous force around the cylinder exhibit at first negative values then gradually increase to its maximum positive value and later drop again there exists a time shift between the maximum interface excursion and the maximum force exerted on the cylinder the traditional morison equation fails to estimate the temporal variation of forces qualitatively 3 2 alternative empirical equation to estimate the forces on the cylinder from the results shown above it can be affirmed that the morison equation cannot predict the forces exerted by internal solitary wave on circular cylinder it is still interested to know whether there exists one simple empirical equation that can estimate the forces reasonably well since the empirical formula is computational efficient and is of practical use for engineering purpose let us recheck the morison equation 1 and it is a linear combination of inertial force and drag force with the coefficients determined by the experiments it should be noted that the convective acceleration is neglected in the morison equation this assumption is plausible for small amplitude surface waves morison et al 1950 but it does not hold for internal solitary wave for which the nonlinearity cannot be neglected an intuitive way is to recover the total derivative in the morison equation and check whether it improves the predictability of the empirical formula significantly the modified morison equation is written as 5 d f ρ c m π d 2 4 d u d t ρ c d d 2 u u d z the total force can be derived by integrating eq 5 along the z axis as 6 f ρ c m π d 2 4 0 h d u d t d z ρ c d d 2 0 h u u d z 7 ρ c m π d 2 4 0 h u u x w u z d z ρ c d d 2 0 h u u d z where w is the vertical velocity component the integration of local derivative is zero as derived in eq 3 and the velocity component normal to the propagation plane is zero as the internal solitary wave can be treated as a two dimensional wave when the cylinder is neglected the continuity equation simplifies as 8 u x w z 0 9 0 h u u x d z 0 h u w z d z 0 h u w z w u z d z 0 h w u z d z the rigid top and bottom boundary conditions are used in eq 9 the total force eq 7 can be further simplified as 10 f ρ c m π d 2 2 0 h u u x d z ρ c d d 2 0 h u u d z 11 ρ c m π d 2 2 0 h w u z d z ρ c d d 2 0 h u u d z before choosing appropriate coefficients for eq 10 or 11 unit values for the inertial and drag coefficients are adopted to examine the temporal evolution of the inertial and drag forces as shown in fig 6 the temporal evolution of the inertial forces exhibit a sinusoidal shape as the internal solitary wave passes the circular cylinder from the temporal evolution of the inertial and drag components shown in fig 6 it seems the total forces can be derived by a linear combination of the inertial and drag forces two equations are required to determine the appropriate values for the two unknown coefficients c m and c d here the locations for the maximum and minimum forces are chosen to solve the coefficients the fixed coefficients are then substituted into eq 10 or 11 to estimate the temporal evolution of forces exerted on the cylinder the temporal evolution of the forces directly calculated and those estimated by the modified morison equation for different density step heights are shown in fig 7 and the related key parameters are shown in table 1 a comparison of figs 5 and 7 reveals that the modified morison equation with appropriate coefficients could predict the forces exerted by internal solitary wave on cylinder reasonably well though there still exists some gap between the directly calculated forces and those estimated by the empirical formula further data analysis are shown in table 1 it shows that for case with initial larger density step height the case related reynolds number is larger for these three cases the cylinder diameter and the fluid kinematic viscosity are exactly identical the reynolds number is determined by the maximum velocity caused by the internal solitary wave for all cases the ratios of cylinder diameter to the wave length are in the range between 0 056 and 0 069 which are significantly lower than 0 15 the influence of the cylinder on the wave can be neglected and the existence of an empirical formula is verified from the derived inertial and drag coefficients the results show that both coefficients decrease with increasing reynolds number the coefficients derived above are also compared with the coefficients inferred by sarpkaya 1976 since those are widely used in morison equation sarpkaya 1976 studied the force on smooth cylinders in harmonic flow and concluded that the inertial and drag coefficients are functions of the reynolds and keulegan carpenter numbers for the reynolds number in this study 2 1 0 5 3 1 0 5 the inferred coefficients by sarpkaya 1976 are around c m 1 8 c d 0 6 which are quite different from those derived in this study it is interesting to note that although distinct flow scenarios are studied and different empirical formulas are employed the coefficients derived in this study fall in the range inferred by sarpkaya 1976 the inertial coefficient c m is in the range from about 0 65 to 1 95 and the drag coefficient c d is in the range from about 0 5 to 2 0 finally the correlation coefficients for the calculated and estimated forces and the standard deviations for their differences between 20 s and 40 s are used to evaluate the quality of the predicted forces by the modified morison equation as shown in table 1 this range is chosen as the internal solitary wave has not arrived at the cylinder location before 15 s the forces are close to zero and after 45 s the trailing short scale waves follows the criteria d l 0 15 cannot be satisfied it can be seen that with appropriate derived inertial and drag coefficients the directly calculated forces and those estimated by the modified morison equation are highly correlated 4 conclusions in this study numerical simulations are used to validate the applicability of morison equation to force estimation induced by internal solitary wave on circular cylinder two sets of numerical configurations are used the first set of simulations are three dimensional high resolution modeling the forces on the cylinder are directly calculated by integrating the pressure and viscous forces while for the second set of simulations the existence of cylinder is neglected and relatively lower computational resources are demanded the velocity field data at the cylinder location in the second set of simulations are used in the morison equation as the influence of the cylinder on the wave is assumed to be neglected a comparison between the directly calculated forces and those estimated by the morison equation reveals that the morison equation fails to predict the forces exerted by the internal solitary wave on the cylinder no matter what values the coefficients are set to as the nonlinearity cannot be neglected for internal solitary wave a modified morison equation is put forward which accounts for the total derivative in the inertial force component the inertial and drag coefficients are then fixed by using the data at the time of maximum and minimum forces the modified morison equation and the approximately determined coefficients could predict the temporal evolution of the forces exerted by the internal solitary wave reasonably well the coefficients derived in this study are different from those inferred by sarpkaya 1976 as distinct case scenarios and different empirical formula are adopted another key difference between this study and the studies by morison et al 1950 and sarpkaya 1976 is the calculation method of partial or the total derivative in the inertial term and the velocity in the drag term in previous studies theoretical formulation of velocity is used e g the velocity and local acceleration is derived based on the sinusoidal wave theory for surface waves of small amplitude morison et al 1950 or the flow is assumed to be an oscillating flow represented by u u m c o s 2 π t t sarpkaya 1976 where u m is the maximum velocity t the time and t the period of the oscillation these assumptions simplify the computation but could potentially introduce some error in the determination of the inertial and drag coefficients in this study two independent sets of model simulations are run one with cylinder in the center of the domain and the cylinder is neglected in another the velocity field and its derivative can be calculated directly from the numerical results and no theoretical formulation of the velocity field is required the downside is that the internal solitary wave generated by gravity collapse exhibits an asymmetrical shape which hinders the studies on the dependence of inertial and drag coefficients on the wave parameters this study shows that the original morison equation cannot predict the forces induced by the internal solitary wave on circular cylinder after modifying the morison equation by incorporating the total acceleration in the inertial term it is still possible to estimate the forces by a linear combination of the inertial and drag components further experimental and numerical studies are necessary to investigate the dependence of the inertial and drag coefficients on the cylinder configuration and wave parameters credit authorship contribution statement xiaoxiao zan formal analysis writing original draft zhenhua lin conceptualization methodology software writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by grant klocw1602 from open fund of the key laboratory of ocean circulation and waves chinese academy of sciences and by shandong provincial natural science foundation china zr2019mf005 
22114,the current field induced by internal solitary wave can be quite large and it can cause destruction to marine structures in recent years the forces induced by internal solitary wave on circular cylinder have been studied extensively and morison equation is commonly used to estimate the forces however the applicability of morison equation to force estimation induced by internal solitary wave has not been validated two sets of numerical simulations are used to check the validity of morison equation in predicting forces induced by internal solitary wave one for directly calculating the forces on the cylinder another for deriving the velocity field at the cylinder location which is required by the morison equation the comparison of directly calculated forces and those estimated from the morison equation reveals that the morison equation fails to predict the temporal evolution of the forces a modified morison equation incorporating the total derivative is put forward and it proves to predict the forces reasonably well with appropriately determined inertial and drag coefficients further experiments and numerical simulations are necessary to determine the dependence of the inertial and drag coefficients on the cylinder configuration and wave parameters keywords internal wave force morison equation cylinder 1 introduction internal solitary waves occur between two layers of fluids with different densities the wave induced velocity can be quite large and induce destruction to marine engineering structures such as oil drilling rigs and pipeline in recent years the forces induced by internal solitary wave on circular structure have been studied from different aspects the force calculation can be generally divided into two steps first the velocity field induced by the internal solitary wave is deduced then the forces are estimated with morison equation and corresponding empirical coefficients different theories and numerical models are used to calculate the velocity field induced by the internal solitary wave cai et al 2003 utilized modal separation and regression analyses to estimate the forces and torques by internal solitary wave on cylindrical piles later cai et al 2006 showed that the forces by the first mode internal wave dominate the global force and a simple estimation method was put forward the forces could be estimated by the local density data and the amplitude of internal solitary wave cai et al 2008 further analyzed the influence of shear flows on the forces and torques on cylindrical piles with observational data near dongsha islands xie et al 2010 compared the validity of mcc theory choi and camassa 1999 and korteweg de vries kdv theory for larger amplitude nonlinear internal solitary wave in two layer fluids and estimated the forces and torques on a small cylinder the results showed that for strongly nonlinear large amplitude internal solitary wave the mcc theory was more effective than the kdv theory xie et al 2011 employed a continuously stratified nonlinear model to simulate the generation of internal solitary wave and calculated the forces and torques on a supposed small diameter vertical cylindrical pile si et al 2012 used the generalized kdv model for continuous stratified ocean in the south china sea to evaluate the velocity field and analyzed its influence on a cylindrical structure zha et al 2012 retrieved the velocities induced by internal solitary wave based on the use of the radon transform technique applied to the radar images and calculated the forces on a circular cylinder lü et al 2016 computed the velocity field induced by internal solitary wave based on a two dimensional nonlinear numerical model and analyzed the influence of background parabolic current on the forces and torques on cylindrical tendon leg morison et al 1950 analyzed the forces by unbroken surface waves on a cylindrical pile and showed that the forces exerted on a differential section of cylindrical pile can be decomposed into two components a virtual mass force proportional to the horizontal local acceleration and a drag force proportional to the square of the velocity 1 d f ρ c m π d 2 4 u t ρ c d d 2 u u d z where ρ is the density of the fluid d the diameter of the cylinder u the horizontal velocity component c m and c d are the coefficients of the inertial and drag components the total force exerted on the structure can be calculated by integrating 1 along z axis this equation is expected to be valid if the diameter of the pile d is much less than the wave length l d l 0 15 so the incident wave field is not disturbed and the existence of the pile can be neglected the value of the coefficients c m and c d are determined by experimental studies sarpkaya 1976 systematically studied the forces on smooth cylinder in harmonic flow and concluded that the inertial and drag coefficients were functions of the reynolds and keulegan carpenter numbers in the studies mentioned above the coefficients were generally set to constant values though there was no consensus on the values the coefficients should be set to e g c m 2 0 c d 1 2 see cai et al 2003 2006 xie et al 2010 zha et al 2012 c m 1 8 c d 0 6 see cai et al 2008 xie et al 2011 c m 1 8 c d 0 8 see si et al 2012 lü et al 2016 the previous studies are helpful to evaluate the forces exerted by internal solitary wave on cylinder pile however it should be noted that the morison equation was originally developed for surface waves of small amplitude morison et al 1950 and the experimental studies by sarpkaya 1976 were expected to be valid only for harmonic flow with zero mean velocity the applicability of morison equation 1 to estimate the forces induced by internal solitary wave on cylindrical pile has not been verified and is the focus of the present study the paper is organized as follows numerical configurations are given in section 2 in section 3 the applicability of the morison equation to estimate forces induced by internal solitary wave on a circular cylinder is examined and a modified empirical equation is put forward the major conclusions are drawn in section 4 2 numerical configurations numerical method is used to check the applicability of morison equation for forces estimation induced by internal solitary wave on cylindrical pile two sets of numerical simulations are configured in this study the first set of simulations are three dimensional cylinder resolved high resolution computations which aim to compute the forces exerted on the cylindrical pile directly by integrating the pressure and viscous force the cylindrical pile is neglected in the second set of simulations and a two dimensional numerical study can be utilized the velocity data at the cylinder location are then used to evaluate the forces by the morison equation openfoam open source field operation and manipulation is used for the computations in this study openfoam is an open source software for computational fluid dynamics the solver based on boussinesq approximation for incompressible fluid is used in the numerical simulation the computation domain and the initial configuration are shown in fig 1 the computational domain is a closed section of 10 m width 30 m length and of 5 m height a circular cylinder with 1 m diameter and 5 m height is placed in the center of domain for the first set of simulations the grid structure is shown in fig 2 the computational domain is primarily composed with cube grids with side length 0 1 m and boundary layers are added around the cylinder to calculate the forces by the fluid the densities of the upper and lower layer are initialized as 1000 kg m3 and 1030 kg m3 respectively the initial velocity field is set to zero and a density step h closed to the left boundary is used to trigger the internal solitary wave this internal wave generation method is easy to configure and widely used in laboratory and numerical experiments lin and song 2012 in this study three different values of density step are used h 1 m 1 5 m and 2 m all numerical simulations are integrated 50 s when the generated internal solitary wave has passed the location of the cylinder the calculated forces on the cylinder and the velocity field at the cylinder location are saved at 0 1 s interval the forces on the cylinder are calculated as the sum of normal pressure and tangential viscous contributions 2 f f p f v i s f i p i n i i μ s f i u s i τ i where ρ is the density s f the face area p the pressure μ the dynamic viscosity u s the velocity shear at the cylinder surface n the unit surface normal around the cylinder and τ the unit tangential vector along the velocity direction a thin boundary layer is required to accurately calculate the forces on the cylinder all the cases shown are validated in terms of grid convergence e g for the density step height h 1 m the influences of different boundary layer thickness on the temporal evolution of the forces have been tested as shown in fig 3 it can be seen that the differences between those sensitivity studies are negligibly small and the calculated forces can be reliably used for later discussions 3 results 3 1 comparison between calculated forces and predictions by morison equation the numerical results are examined to verify the predictions by morison equation the temporal evolution of the density interfaces at the cylinder location are shown in fig 4 it can be seen that depression type and asymmetrical internal solitary waves are generated and propagate in the computational domain the wave amplitudes are approximately one half of the corresponding initial density step heights the leading wave is followed by small scale high frequency trailing waves lin and song 2012 which is beyond the discussion of this study the temporal variation of the forces calculated directly on the cylinder and those computed by the morison equation with different drag coefficients for h 1 m are shown in fig 5 the influence of the inertial coefficient c m can be neglected as the integrated inertial force is zero cai et al 2003 3 0 h ρ c m π d 2 4 u t d z ρ c m π d 2 4 t 0 h u d z 0 where h is the depth of the computational domain the total force on the cylinder can be simplified as 4 f ρ c d d 2 0 h u u d z two different values for c d 0 6 and 1 2 widely used in previous studies are adopted to estimate the forces on the cylinder from figs 4 and 5 it can be seen that the forces estimated by morison equation are generally along the wave propagation direction and the maximum force occurs when the density interface reaches the maximum excursion however from fig 5 it shows that the differences between the forces calculated directly on the cylinder and those estimated with the morison equation are quite large no matter what value is chosen for c d the forces calculated by integrating the pressure and viscous force around the cylinder exhibit at first negative values then gradually increase to its maximum positive value and later drop again there exists a time shift between the maximum interface excursion and the maximum force exerted on the cylinder the traditional morison equation fails to estimate the temporal variation of forces qualitatively 3 2 alternative empirical equation to estimate the forces on the cylinder from the results shown above it can be affirmed that the morison equation cannot predict the forces exerted by internal solitary wave on circular cylinder it is still interested to know whether there exists one simple empirical equation that can estimate the forces reasonably well since the empirical formula is computational efficient and is of practical use for engineering purpose let us recheck the morison equation 1 and it is a linear combination of inertial force and drag force with the coefficients determined by the experiments it should be noted that the convective acceleration is neglected in the morison equation this assumption is plausible for small amplitude surface waves morison et al 1950 but it does not hold for internal solitary wave for which the nonlinearity cannot be neglected an intuitive way is to recover the total derivative in the morison equation and check whether it improves the predictability of the empirical formula significantly the modified morison equation is written as 5 d f ρ c m π d 2 4 d u d t ρ c d d 2 u u d z the total force can be derived by integrating eq 5 along the z axis as 6 f ρ c m π d 2 4 0 h d u d t d z ρ c d d 2 0 h u u d z 7 ρ c m π d 2 4 0 h u u x w u z d z ρ c d d 2 0 h u u d z where w is the vertical velocity component the integration of local derivative is zero as derived in eq 3 and the velocity component normal to the propagation plane is zero as the internal solitary wave can be treated as a two dimensional wave when the cylinder is neglected the continuity equation simplifies as 8 u x w z 0 9 0 h u u x d z 0 h u w z d z 0 h u w z w u z d z 0 h w u z d z the rigid top and bottom boundary conditions are used in eq 9 the total force eq 7 can be further simplified as 10 f ρ c m π d 2 2 0 h u u x d z ρ c d d 2 0 h u u d z 11 ρ c m π d 2 2 0 h w u z d z ρ c d d 2 0 h u u d z before choosing appropriate coefficients for eq 10 or 11 unit values for the inertial and drag coefficients are adopted to examine the temporal evolution of the inertial and drag forces as shown in fig 6 the temporal evolution of the inertial forces exhibit a sinusoidal shape as the internal solitary wave passes the circular cylinder from the temporal evolution of the inertial and drag components shown in fig 6 it seems the total forces can be derived by a linear combination of the inertial and drag forces two equations are required to determine the appropriate values for the two unknown coefficients c m and c d here the locations for the maximum and minimum forces are chosen to solve the coefficients the fixed coefficients are then substituted into eq 10 or 11 to estimate the temporal evolution of forces exerted on the cylinder the temporal evolution of the forces directly calculated and those estimated by the modified morison equation for different density step heights are shown in fig 7 and the related key parameters are shown in table 1 a comparison of figs 5 and 7 reveals that the modified morison equation with appropriate coefficients could predict the forces exerted by internal solitary wave on cylinder reasonably well though there still exists some gap between the directly calculated forces and those estimated by the empirical formula further data analysis are shown in table 1 it shows that for case with initial larger density step height the case related reynolds number is larger for these three cases the cylinder diameter and the fluid kinematic viscosity are exactly identical the reynolds number is determined by the maximum velocity caused by the internal solitary wave for all cases the ratios of cylinder diameter to the wave length are in the range between 0 056 and 0 069 which are significantly lower than 0 15 the influence of the cylinder on the wave can be neglected and the existence of an empirical formula is verified from the derived inertial and drag coefficients the results show that both coefficients decrease with increasing reynolds number the coefficients derived above are also compared with the coefficients inferred by sarpkaya 1976 since those are widely used in morison equation sarpkaya 1976 studied the force on smooth cylinders in harmonic flow and concluded that the inertial and drag coefficients are functions of the reynolds and keulegan carpenter numbers for the reynolds number in this study 2 1 0 5 3 1 0 5 the inferred coefficients by sarpkaya 1976 are around c m 1 8 c d 0 6 which are quite different from those derived in this study it is interesting to note that although distinct flow scenarios are studied and different empirical formulas are employed the coefficients derived in this study fall in the range inferred by sarpkaya 1976 the inertial coefficient c m is in the range from about 0 65 to 1 95 and the drag coefficient c d is in the range from about 0 5 to 2 0 finally the correlation coefficients for the calculated and estimated forces and the standard deviations for their differences between 20 s and 40 s are used to evaluate the quality of the predicted forces by the modified morison equation as shown in table 1 this range is chosen as the internal solitary wave has not arrived at the cylinder location before 15 s the forces are close to zero and after 45 s the trailing short scale waves follows the criteria d l 0 15 cannot be satisfied it can be seen that with appropriate derived inertial and drag coefficients the directly calculated forces and those estimated by the modified morison equation are highly correlated 4 conclusions in this study numerical simulations are used to validate the applicability of morison equation to force estimation induced by internal solitary wave on circular cylinder two sets of numerical configurations are used the first set of simulations are three dimensional high resolution modeling the forces on the cylinder are directly calculated by integrating the pressure and viscous forces while for the second set of simulations the existence of cylinder is neglected and relatively lower computational resources are demanded the velocity field data at the cylinder location in the second set of simulations are used in the morison equation as the influence of the cylinder on the wave is assumed to be neglected a comparison between the directly calculated forces and those estimated by the morison equation reveals that the morison equation fails to predict the forces exerted by the internal solitary wave on the cylinder no matter what values the coefficients are set to as the nonlinearity cannot be neglected for internal solitary wave a modified morison equation is put forward which accounts for the total derivative in the inertial force component the inertial and drag coefficients are then fixed by using the data at the time of maximum and minimum forces the modified morison equation and the approximately determined coefficients could predict the temporal evolution of the forces exerted by the internal solitary wave reasonably well the coefficients derived in this study are different from those inferred by sarpkaya 1976 as distinct case scenarios and different empirical formula are adopted another key difference between this study and the studies by morison et al 1950 and sarpkaya 1976 is the calculation method of partial or the total derivative in the inertial term and the velocity in the drag term in previous studies theoretical formulation of velocity is used e g the velocity and local acceleration is derived based on the sinusoidal wave theory for surface waves of small amplitude morison et al 1950 or the flow is assumed to be an oscillating flow represented by u u m c o s 2 π t t sarpkaya 1976 where u m is the maximum velocity t the time and t the period of the oscillation these assumptions simplify the computation but could potentially introduce some error in the determination of the inertial and drag coefficients in this study two independent sets of model simulations are run one with cylinder in the center of the domain and the cylinder is neglected in another the velocity field and its derivative can be calculated directly from the numerical results and no theoretical formulation of the velocity field is required the downside is that the internal solitary wave generated by gravity collapse exhibits an asymmetrical shape which hinders the studies on the dependence of inertial and drag coefficients on the wave parameters this study shows that the original morison equation cannot predict the forces induced by the internal solitary wave on circular cylinder after modifying the morison equation by incorporating the total acceleration in the inertial term it is still possible to estimate the forces by a linear combination of the inertial and drag components further experimental and numerical studies are necessary to investigate the dependence of the inertial and drag coefficients on the cylinder configuration and wave parameters credit authorship contribution statement xiaoxiao zan formal analysis writing original draft zhenhua lin conceptualization methodology software writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by grant klocw1602 from open fund of the key laboratory of ocean circulation and waves chinese academy of sciences and by shandong provincial natural science foundation china zr2019mf005 
